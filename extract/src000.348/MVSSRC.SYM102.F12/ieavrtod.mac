         TITLE 'TOD CLOCK MANAGER--MODULE IEAVRTOD                     *
                        '
IEAVRTOD CSECT ,                                                   0001
IEAVRINT DS    0H                                                  0001
         ENTRY IEAVRINT
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP00001-@MAINENT)
         DC    AL1(16)                                             0001
         DC    C'IEAVRTOD  78.156'                                 0001
IEAVRSSC DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP00251-IEAVRSSC)
         ENTRY IEAVRSSC
IEAVRNOT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP00827-IEAVRNOT)
         ENTRY IEAVRNOT
IEAVRCAN DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP00899-IEAVRCAN)
         ENTRY IEAVRCAN
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @09,0                                               0001
@PSTART  LA    @10,4095(,@09)                                      0001
         USING @PSTART,@09                                         0001
         USING @PSTART+4095,@10                                    0001
         L     @00,@SIZDATD                                        0001
         GETMAIN  R,LV=(0)
         LR    @08,@01                                             0001
         USING @DATD,@08                                           0001
         ST    @13,@SA00001+4                                      0001
         LM    @15,@01,16(@13)                                     0001
         ST    @08,8(,@13)                                         0001
         LR    @13,@08                                             0001
         AH    @15,4(,@15)                                         0001
         BR    @15                                                 0001
@EP00001 DS    0H                                                  0002
*                                                                  0132
*/********************************************************************/
*/*                                                                  */
*/* SAVE THE ADDRESS OF THE SAVEAREA, AND RE-BASE THE CVT FOR MORE   */
*/* EFFICIENT CODE GENERATION.                                       */
*/*                                                                  */
*/********************************************************************/
*                                                                  0133
*BEGTOD:                                                           0133
*   R13SAV=REG13;                                                  0133
BEGTOD   ST    REG13,R13SAV                                        0133
*   LCVTPTR=CVTPTR;                                                0134
         L     LCVTPTR,CVTPTR                                      0134
*   RESPECIFY                                                      0135
*     CVTMAP BASED(LCVTPTR);                                       0135
*                                                                  0135
*/********************************************************************/
*/*                                                                  */
*/* GET THE NUMBER OF CPU'S CURRENTLY ONLINE, AND CALCULATE THE      */
*/* NUMBER OF BYTES REQUIRED FOR THE TOD CLOCK WORKAREA AND ONE TOD  */
*/* CLOCK WORKAREA ENTRY PER CPU.  THEN, GET THE AMOUNT OF STORAGE   */
*/* JUST CALCULATED FROM SUBPOOL 245.                                */
*/*                                                                  */
*/********************************************************************/
*                                                                  0136
*   REG0=LENGTH(TCWA)+(LENGTH(TCENTRY)*CSDCPUOL);                  0136
         L     @07,CVTCSD(,LCVTPTR)                                0136
         LH    REG0,CSDCPUOL(,@07)                                 0136
         SLA   REG0,4                                              0136
         AH    REG0,@CH01364                                       0136
*   GENERATE CODE                                                  0137
*       (GETMAIN RU,LV=(0),SP=245      OBTAIN WORKAREA FROM SP 245);
*                                                                  0137
         GETMAIN RU,LV=(0),SP=245      OBTAIN WORKAREA FROM SP 245
*/********************************************************************/
*/*                                                                  */
*/* USE A COMPARE AND SWAP LOOP IN ORDER TO SERIALIZE MANIPULATION   */
*/* OF THE TOD CLOCKS.  IF THE POINTER TO THE TOD CLOCK WORKAREA IS  */
*/* 0, THEN THE CLOCKS ARE NOT CURRENTLY BEING MANIPULATED.          */
*/*                                                                  */
*/********************************************************************/
*                                                                  0138
*LOOP1:                                                            0138
*   REG11=0;                        /* CLEAR REG 11 FOR COMPARE AND
*                                      SWAP                          */
LOOP1    SLR   REG11,REG11                                         0138
*   CS(REG11,REG1,TPCTCWA);         /* TEST FOR CODE IN EXECUTION    */
         L     @07,TPCPTR(,LCVTPTR)                                0139
         CS    REG11,@01,TPCTCWA(@07)                              0139
*   BC(7,LOOP1);                    /* BRANCH IF CODE IN EXECUTION   */
         BC    7,LOOP1                                             0140
*/********************************************************************/
*/*                                                                  */
*/* SAVE THE IPL-TIME TIME ZONE CONSTANT IN THE TPC FOR POTENTIAL    */
*/* LATER USE IN A SET COMMAND WITH THE RESET PARAMETER.             */
*/*                                                                  */
*/********************************************************************/
*                                                                  0141
*   TPCTZORG=CVTTZ;                                                0141
*                                                                  0141
         L     @07,TPCPTR(,LCVTPTR)                                0141
         MVC   TPCTZORG(4,@07),CVTTZ(LCVTPTR)                      0141
*/********************************************************************/
*/*                                                                  */
*/* ESTABLISH ADDRESSABILITY FOR THE TOD CLOCK WORKAREA, SAVE THE    */
*/* COUNT OF ONLINE CPU'S, CLEAR THE FLAGS IN THE WORKAREA, AND SAVE */
*/* ITS LENGTH FOR THE FREEMAIN TO COME.                             */
*/*                                                                  */
*/********************************************************************/
*                                                                  0142
*   TCWAPTR=REG1;                                                  0142
         LR    TCWAPTR,REG1                                        0142
*   RESPECIFY                                                      0143
*     TCWA BASED(TCWAPTR);                                         0143
*   TCCPUCNT=CSDCPUOL;                                             0144
         L     @07,CVTCSD(,LCVTPTR)                                0144
         LH    @06,CSDCPUOL(,@07)                                  0144
         STH   @06,TCCPUCNT(,TCWAPTR)                              0144
*   CSDGDTOD=CSDCPUOL;              /* COUNT OF GOOD TOD CLOCKS TO 0145
*                                      CSD                           */
         ST    @06,CSDGDTOD(,@07)                                  0145
*   CSDGDCC=CSDCPUOL;               /* COUNT OF GOOD CLK COMP TO CSD */
         ST    @06,CSDGDCC(,@07)                                   0146
*   CSDGDINT=CSDCPUOL;              /* COUNT OF GOOD CPU TIMERS TO 0147
*                                      CSD                           */
         ST    @06,CSDGDINT(,@07)                                  0147
*   TCWAGFLG='00'X;                                                0148
         MVI   TCWAGFLG(TCWAPTR),X'00'                             0148
*   TCWALN=REG0;                                                   0149
*                                                                  0149
         STH   REG0,TCWALN                                         0149
*/********************************************************************/
*/*                                                                  */
*/* SET UP THE INTERFACE FOR GETTING A PAGE FIXED, AND ISSUE THE     */
*/* PGFIX SVC TO FIX THIS MODULE.                                    */
*/*                                                                  */
*/********************************************************************/
*                                                                  0150
*   REG1=ADDR(BEGTOD);              /* GET POINTER TO START OF MODULE*/
         LA    REG1,BEGTOD                                         0150
*   REG15=ADDR(ENDTOD);             /* GET POINTER TO END OF MODULE  */
         LA    REG15,ENDTOD                                        0151
*   REG0=ADDR(TODECB);              /* GET POINTER TO ECB            */
         LA    REG0,TODECB                                         0152
*   TODECB=0;                       /* CLEAR ECB                     */
         SLR   @07,@07                                             0153
         ST    @07,TODECB                                          0153
*   GENERATE CODE(PGFIX R,A=(1),EA=(15),ECB=(0),LONG=N);           0154
         PGFIX R,A=(1),EA=(15),ECB=(0),LONG=N
*                                                                  0155
*/********************************************************************/
*/*                                                                  */
*/* THIS CODE INITIALIZES A WORKAREA ENTRY FOR EVERY CPU ONLINE.     */
*/*                                                                  */
*/********************************************************************/
*                                                                  0155
*   PTREBEG=TCWAPTR+LENGTH(TCWA);   /* SAVE PTR TO FIRST TCWA ENTRY  */
         LA    @07,112                                             0155
         ALR   @07,TCWAPTR                                         0155
         ST    @07,PTREBEG                                         0155
*   PTREEND=PTREBEG+TCCPUCNT*LENGTH(TCENTRY)-1;/* SAVE PTR TO END OF
*                                      TCWA ENTRIES                  */
         LH    @06,TCCPUCNT(,TCWAPTR)                              0156
         SLA   @06,4                                               0156
         ALR   @06,@07                                             0156
         BCTR  @06,0                                               0156
         ST    @06,PTREEND                                         0156
*   REG12=CVTPCCAT+LENGTH(PCCAVT)-LENGTH(PCCAT00P);/* GET PTR TO LAST
*                                      PCCAVT ENTRY                  */
         L     REG12,CVTPCCAT(,LCVTPTR)                            0157
         SH    REG12,@CH02779                                      0157
*   RESPECIFY                                                      0158
*     PCCAVT BASED(REG12);                                         0158
*   RESPECIFY                                                      0159
*     PCCA BASED(PTRPCCA);                                         0159
*   REG11=PTREBEG;                  /* GET PTR TO FIRST TCWA ENTRY   */
         LR    REG11,@07                                           0160
*   RESPECIFY                                                      0161
*     TCENTRY BASED(REG11);                                        0161
*   MASKHLDR=CSDCPUAL;              /* GET MASK OF ALIVE CPU'S       */
         L     @07,CVTCSD(,LCVTPTR)                                0162
         SLR   MASKHLDR,MASKHLDR                                   0162
         ICM   MASKHLDR,3,CSDCPUAL(@07)                            0162
*/********************************************************************/
*/*                                                                  */
*/* THIS LOOP DECREMENTS THE INDEX THROUGH THE MASK OF ONLINE CPU'S  */
*/* AS LONG AS THE MASK BIT FOR THE CPU IS OFF, INDICATING THAT THE  */
*/* CPU IS NOT ONLINE.                                               */
*/*                                                                  */
*/********************************************************************/
*                                                                  0163
*   DO REG1=LENGTH(CSDCPUAL) TO 1 BY-1;                            0163
         LA    REG1,16                                             0163
@DL00163 DS    0H                                                  0164
*     IF MASKHLDR//2^=0             /* SEE IF THE NEXT BIT IS ON     */
*       THEN                                                       0164
*                                                                  0164
         LR    @07,MASKHLDR                                        0164
         N     @07,@CF00096                                        0164
         LTR   @07,@07                                             0164
         BZ    @RF00164                                            0164
*/********************************************************************/
*/*                                                                  */
*/* WHEN A BIT IN THE MASK IS FOUND TO BE ON, INDICATING THAT THE CPU*/
*/* IS ONLINE, FILL IN THE PCCA ADDRESS FIELD AND THE CPU ADDRESS    */
*/* FIELD IN THE NEXT AVAILABLE TOD CLOCK WORKAREA ENTRY.            */
*/*                                                                  */
*/********************************************************************/
*                                                                  0165
*       DO;                                                        0165
*         TCWAPCCA=PTRPCCA;                                        0166
         L     @07,PTRPCCA(,REG12)                                 0166
         ST    @07,TCWAPCCA(,REG11)                                0166
*         TCWAIADD=PCCACPUA;                                       0167
         MVC   TCWAIADD(2,REG11),PCCACPUA(@07)                     0167
*         REG11=REG11+LENGTH(TCENTRY);                             0168
         AH    REG11,@CH00045                                      0168
*       END;                                                       0169
*     MASKHLDR=MASKHLDR/2;          /* SHIFT OFF BIT JUST PROCESSED  */
@RF00164 SRL   MASKHLDR,1                                          0170
*     REG12=REG12-LENGTH(PCCAT00P); /* POINT TO NEXT PCCAVT ENTRY    */
         SH    REG12,@CH00108                                      0171
*   END;                                                           0172
*                                                                  0172
         BCTR  REG1,0                                              0172
         LTR   REG1,REG1                                           0172
         BP    @DL00163                                            0172
*/********************************************************************/
*/*                                                                  */
*/* AFTER INITIALIZING THE TOD CLOCK WORKAREA ENTRIES, WAIT FOR      */
*/* COMPLETION OF THE PAGE FIXING OPERATION.                         */
*/*                                                                  */
*/********************************************************************/
*                                                                  0173
*   REG1=ADDR(TODECB);                                             0173
         LA    REG1,TODECB                                         0173
*   GENERATE CODE(WAIT  1,ECB=(1));                                0174
*                                                                  0174
         WAIT  1,ECB=(1)
*/********************************************************************/
*/*                                                                  */
*/* INITIALIZE THE RETURN CODE SO THAT THE FOLLOWING LOOP WILL BE    */
*/* EXECUTED AT LEAST ONE TIME.                                      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0175
*   RETCODE=4;                                                     0175
*                                                                  0175
         LA    RETCODE,4                                           0175
*/********************************************************************/
*/*                                                                  */
*/* STARTING WITH THE FIRST TOD CLOCK WORKAREA ENTRY, CALL           */
*/* THE SYNCHRONIZATION TESTING ROUTINE TO TEST THE SYNCHRONIZATION  */
*/* OF ALL OTHER CLOCKS AGAINST THIS ONE.  DO THIS AS LONG AS THERE  */
*/* ARE ENTRIES TO PROCESS AND THE TESTING ROUTINE INDICATES THAT    */
*/* EITHER THE SUBJECT CLOCK WAS NOT SET (RETURN CODE=4),            */
*/* OR THAT THE TESTING PROCEDURE COULD NOT BE COMPLETED IN LESS     */
*/* THAN 2**20 MICROSECONDS (RETURN CODE=16).                        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0176
*   REG11=PTREBEG;                  /* GET PTR TO FIRST TCWA ENTRY   */
         L     REG11,PTREBEG                                       0176
*   DO REG1=TCCPUCNT TO 1 BY-1 WHILE RETCODE=4×RETCODE=16;         0177
*                                                                  0177
         LH    REG1,TCCPUCNT(,TCWAPTR)                             0177
         B     @DE00177                                            0177
@DL00177 CH    RETCODE,@CH00108                                    0177
         BE    @DB00177                                            0177
         CH    RETCODE,@CH00045                                    0177
         BNE   @DC00177                                            0177
@DB00177 DS    0H                                                  0178
*/********************************************************************/
*/*                                                                  */
*/* MAKE SURE THAT THE ENTRY FOR THE SUBJECT CLOCK IS THE            */
*/* FIRST, BY INTERCHANGING THE FIRST AND SUBJECT ENTRIES.           */
*/*                                                                  */
*/********************************************************************/
*                                                                  0178
*     TCWAWRK=PTREBEG->TCENTRY;     /* SAVE FIRST ENTRY              */
         L     @07,PTREBEG                                         0178
         MVC   TCWAWRK(16,TCWAPTR),TCENTRY(@07)                    0178
*     PTREBEG->TCENTRY=TCENTRY;     /* NEXT ENTRY TO FIRST           */
         MVC   TCENTRY(16,@07),TCENTRY(REG11)                      0179
*     TCENTRY=TCWAWRK;              /* FIRST ENTRY TO NEXT           */
         MVC   TCENTRY(16,REG11),TCWAWRK(TCWAPTR)                  0180
*/********************************************************************/
*/*                                                                  */
*/* CALL THE SYNCHRONIZATION TESTING ROUTINE.                        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0181
*     CALL IEAVRTST;                                               0181
*                                                                  0181
         BAL   @14,IEAVRTST                                        0181
*/********************************************************************/
*/*                                                                  */
*/* TEST FOR A RETURN CODE OF 0.                                     */
*/*                                                                  */
*/********************************************************************/
*                                                                  0182
*     IF RETCODE=0 THEN                                            0182
*                                                                  0182
         LTR   RETCODE,RETCODE                                     0182
         BNZ   @RF00182                                            0182
*/********************************************************************/
*/*                                                                  */
*/* IF THE RETURN CODE IS 0, INDICATING THAT ALL CLOCKS ARE IN       */
*/* SYNCHRONISM OR THAT THE ONLY CLOCK IS SET, TURN ON THE FLAG WHICH*/
*/* INDICATES THAT MESSAGE IEA888A SHOULD BE ISSUED.                 */
*/*                                                                  */
*/********************************************************************/
*                                                                  0183
*       TCGXXX='1'B;                                               0183
         OI    TCGXXX(TCWAPTR),B'10000000'                         0183
*     ELSE                                                         0184
*                                                                  0184
*/********************************************************************/
*/*                                                                  */
*/* IF THE RETURN CODE WAS NOT 0, INDICATE THAT PROMPTING MUST       */
*/* BE DONE, AND THEN TEST FOR A RETURN CODE OF 8 OR 12.             */
*/*                                                                  */
*/********************************************************************/
*                                                                  0184
*       DO;                                                        0184
         B     @RC00182                                            0184
@RF00182 DS    0H                                                  0185
*         MSTODWTO='0'B;            /*                        @Y02675*/
         L     @07,CVTMSER(,LCVTPTR)                               0185
         NI    MSTODWTO(@07),B'10111111'                           0185
*         IF RETCODE=8×RETCODE=12 THEN                             0186
*                                                                  0186
         CH    RETCODE,@CH00038                                    0186
         BE    @RT00186                                            0186
         CH    RETCODE,@CH01265                                    0186
         BNE   @RF00186                                            0186
@RT00186 DS    0H                                                  0187
*/********************************************************************/
*/*                                                                  */
*/* IF THE RETURN CODE WAS 8 OR 12, INDICATING THAT THE THE CLOCKS   */
*/* WERE OUT OF LOW ORDER OR HIGH ORDER SYNCHRONIZATION RESPECTIVELY,*/
*/* THEN LOOP THROUGH THE TOD CLOCK WORKAREA ENTRIES EXAMINING THE   */
*/* CONDITION CODE FIELD, TO DETERMINE IF MORE THAN ONE SET CLOCK    */
*/* WAS FOUND.  NOTE: IF MORE THAN ONE SET CLOCK WAS FOUND, THE      */
*/* VALUES OF ALL SET CLOCKS MUST BE DISPLAYED TO THE OPERATOR.      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0187
*           DO;                                                    0187
*             REG12=PTREBEG;        /* GET PTR TO FIRST TCWA ENTRY   */
         L     REG12,PTREBEG                                       0188
*             REG15=1;              /* INITIALIZE COUNTER FOR SET  0189
*                                      CLOCKS                        */
         LA    REG15,1                                             0189
*/********************************************************************/
*/*                                                                  */
*/* TEST EACH ENTRY FOR A SET CLOCK UNTIL ALL ENTRIES ARE CHECKED,   */
*/* OR MORE THAN 1 SET CLOCK HAS BEEN FOUND.                         */
*/*                                                                  */
*/********************************************************************/
*                                                                  0190
*             RESPECIFY                                            0190
*              (REG0) RESTRICTED;                                  0190
*             DO REG0=TCCPUCNT TO 1 BY-1 WHILE REG15=>0;           0191
         LH    REG0,TCCPUCNT(,TCWAPTR)                             0191
         B     @DE00191                                            0191
@DL00191 LTR   REG15,REG15                                         0191
         BM    @DC00191                                            0191
*               IF REG12->TCLCC='00'B/* TEST FOR CC=0                */
*                 THEN                                             0192
         TM    TCLCC(REG12),B'00110000'                            0192
         BNZ   @RF00192                                            0192
*                 REG15=REG15-1;                                   0193
         BCTR  REG15,0                                             0193
*               REG12=REG12+LENGTH(TCENTRY);/* POINT TO NEXT TCWA  0194
*                                      ENTRY                         */
@RF00192 AH    REG12,@CH00045                                      0194
*             END;                                                 0195
         BCTR  REG0,0                                              0195
@DE00191 LTR   REG0,REG0                                           0195
         BP    @DL00191                                            0195
@DC00191 DS    0H                                                  0196
*             RESPECIFY                                            0196
*              (REG0) UNRESTRICTED;                                0196
*                                                                  0196
*/********************************************************************/
*/*                                                                  */
*/* TEST FOR ONLY ONE SET CLOCK FOUND.                               */
*/*                                                                  */
*/********************************************************************/
*                                                                  0197
*             IF REG15=0 THEN                                      0197
*                                                                  0197
         LTR   REG15,REG15                                         0197
         BNZ   @RF00197                                            0197
*/********************************************************************/
*/*                                                                  */
*/* IF ONLY ONE SET CLOCK WAS FOUND, TURN ON THE FLAG WHICH INDI-    */
*/* CATES THAT MESSAGE IEA888A SHOULD BE ISSUED.                     */
*/*                                                                  */
*/********************************************************************/
*                                                                  0198
*               TCGXXX='1'B;                                       0198
         OI    TCGXXX(TCWAPTR),B'10000000'                         0198
*             ELSE                                                 0199
*                                                                  0199
*/********************************************************************/
*/*                                                                  */
*/* IF MORE THAN ONE SET CLOCK WAS FOUND, TURN ON THE FLAG WHICH IN- */
*/* DICATES THAT MESSAGE IEA887A SHOULD BE ISSUED.                   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0199
*               TCGZZZ='1'B;                                       0199
         B     @RC00197                                            0199
@RF00197 OI    TCGZZZ(TCWAPTR),B'00100000'                         0199
*           END;                                                   0200
*         ELSE                                                     0201
*                                                                  0201
*/********************************************************************/
*/*                                                                  */
*/* IF THE RETURN CODE WAS NOT 0, 8, OR 12, IT MUST BE 4 OR 16.      */
*/* THEREFORE, TEST REG1 FOR A VALUE OF 1, INDICATING THAT THE       */
*/* SUBJECT ENTRY WAS THE LAST ENTRY.                                */
*/*                                                                  */
*/********************************************************************/
*                                                                  0201
*           IF REG1=1 THEN                                         0201
*                                                                  0201
         B     @RC00186                                            0201
@RF00186 CH    REG1,@CH00096                                       0201
         BNE   @RF00201                                            0201
*/********************************************************************/
*/*                                                                  */
*/* IF THE VALUE IS 1, TURN ON THE FLAG WHICH INDICATES THAT MESSAGE */
*/* IEA886A SHOULD BE ISSUED. (NOTE: IF THE VALUE IS NOT 1, THE LOOP */
*/* WILL BE EXECUTED AGAIN BECAUSE THE RETURN CODE IS 4 OR 16.)      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0202
*             TCGYYY='1'B;                                         0202
         OI    TCGYYY(TCWAPTR),B'01000000'                         0202
*       END;                                                       0203
@RF00201 DS    0H                                                  0203
@RC00186 DS    0H                                                  0204
*     REG11=REG11+LENGTH(TCENTRY);  /* POINT TO NEXT TCWA ENTRY      */
@RC00182 AH    REG11,@CH00045                                      0204
*   END;                                                           0205
         BCTR  REG1,0                                              0205
@DE00177 LTR   REG1,REG1                                           0205
         BP    @DL00177                                            0205
@DC00177 DS    0H                                                  0206
*                                                                  0206
*/********************************************************************/
*/*                                                                  */
*/* CALL THE COMMUNICATIONS ROUTINE TO WRITE MESSAGES TO THE         */
*/* OPERATOR CONCERNING TOD CLOCK AND LOCAL TIME VALUES, AND TO PRO- */
*/* CESS HIS REPLIES TO THESE MESSAGES.  THE MESSAGES TO BE WRITTEN  */
*/* ARE INDICATED BY THE FLAGS JUST SET IN THE TCWAGFLG FIELD OF THE */
*/* TOD CLOCK WORKAREA.                                              */
*/*                                                                  */
*/********************************************************************/
*                                                                  0206
*   CALL IEAVRCOM;                                                 0206
*                                                                  0206
         BAL   @14,IEAVRCOM                                        0206
*/********************************************************************/
*/*                                                                  */
*/* CALL THE SYNCHRONIZATION TESTING ROUTINE TO DETERMINE IF THE     */
*/* CLOCKS NOW REQUIRE SYNCHRONIZING, SINCE THE OPERATOR MAY HAVE    */
*/* MADE CHANGES.                                                    */
*/*                                                                  */
*/********************************************************************/
*                                                                  0207
*   CALL IEAVRTST;                                                 0207
*                                                                  0207
         BAL   @14,IEAVRTST                                        0207
*/********************************************************************/
*/*                                                                  */
*/* TEST FOR A RETURN CODE OF 0.                                     */
*/*                                                                  */
*/********************************************************************/
*                                                                  0208
*   IF RETCODE^=0 THEN                                             0208
*                                                                  0208
         LTR   RETCODE,RETCODE                                     0208
         BZ    @RF00208                                            0208
*/********************************************************************/
*/*                                                                  */
*/* IF THE RETURN WAS 0, THERE IS ONLY ONE CPU IN THE CONFIGURATION  */
*/* AND ITS CLOCK IS NOW SET,  OR ALL CLOCKS ARE SET AND IN          */
*/* SYNCHRONISM.  IF THE RETURN CODE IS NOT 0, TEST FOR A RETURN     */
*/* CODE OF 8 OR 12.                                                 */
*/*                                                                  */
*/********************************************************************/
*                                                                  0209
*     IF RETCODE=8×RETCODE=12 THEN                                 0209
*                                                                  0209
         CH    RETCODE,@CH00038                                    0209
         BE    @RT00209                                            0209
         CH    RETCODE,@CH01265                                    0209
         BNE   @RF00209                                            0209
@RT00209 DS    0H                                                  0210
*/********************************************************************/
*/*                                                                  */
*/* IF THE RETURN CODE IS 8 OR 12, THE TOD CLOCKS REQUIRE SYN-       */
*/* CHRONIZING.  THEREFORE, CALL THE SYNCHRONIZING ROUTINE TO AT-    */
*/* TEMPT SYNCHRONIZATION OF THE CLOCKS, AND THEN CALL THE SYNCHRONI-*/
*/* ZATION TESTING ROUTINE TO ENSURE THAT THE CLOCKS WERE ACTUALLY   */
*/* SYNCHRONIZED.  (NOTE: THE RETURN CODE NOW SET BY THE TESTING     */
*/* ROUTINE WILL BE PASSED BACK TO THE CALLER TO INDICATE THE SUCCESS*/
*/* OR FAILURE OF THE SYNCHRONIZING OPERATION.)                      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0210
*       DO;                                                        0210
*         CALL IEAVRSYN;                                           0211
         BAL   @14,IEAVRSYN                                        0211
*         CALL IEAVRTST;                                           0212
         BAL   @14,IEAVRTST                                        0212
*       END;                                                       0213
*   RCSAVE=REG15;                   /* SAVE THE RETURN CODE FROM   0214
*                                      IEAVRTST                      */
@RF00209 DS    0H                                                  0214
@RF00208 ST    REG15,RCSAVE                                        0214
*/********************************************************************/
*/*                                                                  */
*/* SAVE THE ADDRESS OF THE ASYNCHRONOUS RECOVERY ROUTINE (IEAVRCLA) */
*/* IN THE TPC SO THAT IT CAN BE SCHEDULED BY THE SYNCHRONOUS        */
*/* ROUTINE (IEAVRCLS).                                              */
*/*                                                                  */
*/********************************************************************/
*                                                                  0215
*   TPCCLA=ADDR(IEAVRCLA);                                         0215
*                                                                  0215
         L     @07,TPCPTR(,LCVTPTR)                                0215
         LA    @06,IEAVRCLA                                        0215
         ST    @06,TPCCLA(,@07)                                    0215
*/********************************************************************/
*/*                                                                  */
*/* SEARCH THE LOGICAL CCA VECTOR TABLE.  WHEN A NON-ZERO ENTRY      */
*/* IS FOUND, SET THE WAIT TIME FIELD IN THE LCCA TO 0, AND SET      */
*/* THE TIME AT DISPATCH FIELD TO THE CURRENT TOD CLOCK VALUE.       */
*/*                                                                  */
*/********************************************************************/
*                                                                  0216
*   REG12=CVTLCCAT;                 /* GET PTR TO LCCAVT             */
         L     REG12,CVTLCCAT(,LCVTPTR)                            0216
*   RESPECIFY                                                      0217
*     LCCAVT BASED(REG12);                                         0217
*   DO REG1=DIM(LCCAT00P) TO 1 BY-1;                               0218
         LA    REG1,16                                             0218
@DL00218 DS    0H                                                  0219
*     IF PTRLCCA^=0                 /* TEST FOR NON-ZERO ENTRY       */
*       THEN                                                       0219
         L     @07,PTRLCCA(,REG12)                                 0219
         LTR   @07,@07                                             0219
         BZ    @RF00219                                            0219
*       DO;                                                        0220
*         LCCAPTR=PTRLCCA;                                         0221
         LR    LCCAPTR,@07                                         0221
*         LCCAWTIM='0000000000000000'X;                            0222
         MVC   LCCAWTIM(8,LCCAPTR),@CB02630                        0222
*         GENERATE CODE REFS(LCCADTOD,LCCAPTR)(STCK  LCCADTOD(LCCAPTR))
*             ;                                                    0223
         STCK  LCCADTOD(LCCAPTR)
*       END;                                                       0224
*     REG12=REG12+LENGTH(LCCAT00P); /* POINT TO NEXT LCCAVT ENTRY    */
@RF00219 AH    REG12,@CH00108                                      0225
*   END;                                                           0226
*                                                                  0226
         BCTR  REG1,0                                              0226
         LTR   REG1,REG1                                           0226
         BP    @DL00218                                            0226
*/********************************************************************/
*/*                                                                  */
*/* ZERO OUT THE ACCUMULATED JOB STEP TIME FIELD FOR ALL MEMORIES.   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0227
*   REG12=CVTASVT;                  /* GET POINTER TO ASVT           */
         L     REG12,CVTASVT(,LCVTPTR)                             0227
*   RESPECIFY                                                      0228
*     ASVT BASED(REG12);                                           0228
*   RESPECIFY                                                      0229
*     ASCB BASED(ASVTENTY);                                        0229
*   DO REG1=ASVTMAXU TO 1 BY-1;                                    0230
         L     REG1,ASVTMAXU(,REG12)                               0230
         B     @DE00230                                            0230
@DL00230 DS    0H                                                  0231
*     IF ASVTAVAL='0'B THEN         /* TEST FOR IN-USE ASVT ENTRY    */
         TM    ASVTAVAL(REG12),B'10000000'                         0231
         BNZ   @RF00231                                            0231
*       ASCBEJST='0000000000000000'X;                              0232
         L     @07,ASVTENTY(,REG12)                                0232
         MVC   ASCBEJST(8,@07),@CB02630                            0232
*     REG12=REG12+LENGTH(ASVTENTY); /* POINT TO NEXT ASVT ENTRY      */
@RF00231 AH    REG12,@CH00108                                      0233
*   END;                                                           0234
*                                                                  0234
         BCTR  REG1,0                                              0234
@DE00230 LTR   REG1,REG1                                           0234
         BP    @DL00230                                            0234
*/********************************************************************/
*/*                                                                  */
*/* CALL THE ROUTINE WHICH ENQUEUES THE JOBSTEP TIMING TQE AND THE   */
*/* MIDNIGHT TQE, AND NOTIFIES THE SRM THAT INITIALIZATION OF THE    */
*/* TOD CLOCKS IS COMPLETE.                                          */
*/*                                                                  */
*/********************************************************************/
*                                                                  0235
*   CALL TQEINIT;                                                  0235
*                                                                  0235
         LA    @15,TQEINIT                                         0235
         BALR  @14,@15                                             0235
*/********************************************************************/
*/*                                                                  */
*/* INITIALIZE THE TIMER STATUS BYTES IN THE PCCA OF EACH ONLINE CPU */
*/*                                                                  */
*/********************************************************************/
*                                                                  0236
*   REG11=PTREBEG;                  /* GET PTR TO FIRST TCWA ENTRY   */
         L     REG11,PTREBEG                                       0236
*   DO REG1=TCCPUCNT TO 1 BY-1;                                    0237
         LH    REG1,TCCPUCNT(,TCWAPTR)                             0237
         B     @DE00237                                            0237
@DL00237 DS    0H                                                  0238
*     TCWAPCCA->PCCATMST=TMSTINIT;                                 0238
         L     @07,TCWAPCCA(,REG11)                                0238
         MVC   PCCATMST(4,@07),TMSTINIT                            0238
*     REG11=REG11+LENGTH(TCENTRY);  /* POINT TO NEXT TCWA ENTRY      */
         AH    REG11,@CH00045                                      0239
*   END;                                                           0240
*                                                                  0240
         BCTR  REG1,0                                              0240
@DE00237 LTR   REG1,REG1                                           0240
         BP    @DL00237                                            0240
*/********************************************************************/
*/*                                                                  */
*/* FREE THE TOD CLOCK WORKAREA AND THE FIXED PAGE.                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0241
*   REG0=TCWALN;                    /* GET LENGTH OF TCWA            */
         LH    REG0,TCWALN                                         0241
*   REG1=TCWAPTR;                   /* GET ADDRESS OF TCWA           */
         LR    REG1,TCWAPTR                                        0242
*   GENERATE CODE(FREEMAIN RU,LV=(0),A=(1),SP=245);                0243
         FREEMAIN RU,LV=(0),A=(1),SP=245
*   REG1=ADDR(BEGTOD);              /* GET POINTER TO START OF MODULE*/
         LA    REG1,BEGTOD                                         0244
*   REG15=ADDR(ENDTOD);             /* GET PTR TO END OF MODULE      */
         LA    REG15,ENDTOD                                        0245
*   GENERATE CODE(PGFREE R,A=(1),EA=(15));                         0246
*                                                                  0246
         PGFREE R,A=(1),EA=(15)
*/********************************************************************/
*/*                                                                  */
*/* INDICATE THAT PROMPTING IS REQUIRED FROM NOW ON, AND ZERO THE    */
*/* POINTER TO THE TOD CLOCK WORKAREA IN THE TPC TO INDICATE THAT    */
*/* MANIPULATION OF THE TOD CLOCKS HAS CEASED.                       */
*/*                                                                  */
*/********************************************************************/
*                                                                  0247
*   MSTODWTO='0'B;                  /*                        @Y02675*/
         L     @07,CVTMSER(,LCVTPTR)                               0247
         NI    MSTODWTO(@07),B'10111111'                           0247
*   TPCTCWA=0;                                                     0248
*                                                                  0248
         L     @07,TPCPTR(,LCVTPTR)                                0248
         SLR   @06,@06                                             0248
         ST    @06,TPCTCWA(,@07)                                   0248
*/********************************************************************/
*/*                                                                  */
*/* RESTORE THE SAVEAREA ADDRESS, AND RETURN TO THE CALLER WITH A    */
*/* RETURN CODE IN REGISTER 15.                                      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0249
*   REG13=R13SAV;                                                  0249
         L     REG13,R13SAV                                        0249
*   RETURN CODE(RCSAVE);                                           0250
         L     @07,RCSAVE                                          0250
         L     @13,4(,@13)                                         0250
         L     @00,@SIZDATD                                        0250
         LR    @01,@08                                             0250
         FREEMAIN R,LV=(0),A=(1)
         LR    @15,@07                                             0250
         L     @14,12(,@13)                                        0250
         LM    @00,@12,20(@13)                                     0250
         BR    @14                                                 0250
*                                                                  0251
*/********************************************************************/
*/*                                                                  */
*/*          IEAVRSSC--TOD SET SPECIFIC CLOCK ROUTINE                */
*/*                                                                  */
*/* THIS ROUTINE RECEIVES CONTROL FROM IEAVRCLA AND THE VARY CPU     */
*/* COMMAND PROCESSOR.  IT BUILDS A WORKAREA CONTAINING A LIST OF 2  */
*/* CPU'S, ONE REPRESENTING THE CPU WHOSE CLOCK IS TO BE SET/SYNCHED */
*/* AND THE OTHER REPRESENTING THE CPU TO WHICH THE "SPECIFIC" CLOCK */
*/* WILL BE SYNCHRONIZED.  IT THEN USES ROUTINES IEAVRTST,IEAVRCOM,  */
*/* AND IEAVRSYN TO SET/SYNCH THE "SPECIFIC" CLOCK.                  */
*/*                                                                  */
*/* FIRST, USING IEAVRTST, AN ATTEMPT IS MADE TO FIND AN ONLINE CPU  */
*/* WHOSE CLOCK IS SET.  IF FOUND, IEAVRSYN IS INVOKED TO SYNCHRO-   */
*/* NIZE THE "SPECIFIC" CLOCK.  IF NO SET CLOCK CAN BE FOUND, USING  */
*/* THE RETURN CODE FROM IEAVRTST, A FLAG IS SET IN THE WORKAREA TO  */
*/* INDICATE WHICH MESSAGE SHOULD BE DISPLAYED TO THE OPERATOR.      */
*/* THEN IEAVRCOM IS INVOKED TO COMMUNICATE WITH THE OPERATOR, AND   */
*/* THE "SPECIFIC" CLOCK IS ULTIMATELY SET.                          */
*/*                                                                  */
*/* TIMER SUPERVISION RELATED FIELDS IN VARIOUS CONTROL BLOCKS ARE   */
*/* UPDATED OR INITIALIZED, DEPENDING ON THE SUCCESS OR FAILURE OF   */
*/* THE SETTING/SYNCHRONIZING OPERATION.  CONTROL IS RETURNED TO THE */
*/* CALLER WITH A RETURN CODE IN REGISTER 15.                        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0251
*IEAVRSSC:                                                         0251
*   ENTRY(NEWPCCA);                                                0251
*                                                                  0251
@EP00251 MVC   @PC00001(4),0(@01)                                  0251
*/********************************************************************/
*/*                                                                  */
*/* SAVE THE CALLER'S ID, AND THE ADDRESS OF THE SAVEAREA.           */
*/*                                                                  */
*/********************************************************************/
*                                                                  0252
*   CALLERID=REG0;                                                 0252
         STH   REG0,CALLERID                                       0252
*   R13SAV=REG13;                                                  0253
*                                                                  0253
         ST    REG13,R13SAV                                        0253
*/********************************************************************/
*/*                                                                  */
*/* SAVE THE CODE AND DATA REGISTERS FOR USE IN RECOVERY EXIT.       */
*/*                                                                  */
*/********************************************************************/
*                                                                  0254
*   STM(REG8,REG10,SSCBASE);                                       0254
*                                                                  0254
         STM   REG8,REG10,SSCBASE                                  0254
*/********************************************************************/
*/*                                                                  */
*/* ESTABLISH ERROR EXIT FOR UNLOCKED CODE.                          */
*/*                                                                  */
*/********************************************************************/
*                                                                  0255
*   REG1=ADDR(ESTAEL);              /* GET ADDR OF MACRO PARM LIST   */
         LA    REG1,ESTAEL                                         0255
*   REG2=ADDR(SSCESTAE);            /* GET EXIT ADDRESS              */
         LA    REG2,SSCESTAE                                       0256
*   REG3=ADDR(SSCRPARM);            /* GET EXIT PARMLIST ADDRESS     */
         LA    REG3,SSCRPARM                                       0257
*   GEN CODE REFS(REG1,REG2,REG3)                                  0258
*       (ESTAE (2),CT,PARAM=(3),PURGE=NONE,RECORD=YES,MF=(E,(1))); 0258
*                                                                  0258
         ESTAE (2),CT,PARAM=(3),PURGE=NONE,RECORD=YES,MF=(E,(1))
*/********************************************************************/
*/*                                                                  */
*/* RE-BASE THE CVT FOR MORE EFFICIENT CODE GENERATION.              */
*/*                                                                  */
*/********************************************************************/
*                                                                  0259
*   LCVTPTR=CVTPTR;                                                0259
*                                                                  0259
         L     LCVTPTR,CVTPTR                                      0259
*/********************************************************************/
*/*                                                                  */
*/* GET A TOD CLOCK WORKAREA WITH 2 ENTRIES.                         */
*/*                                                                  */
*/********************************************************************/
*                                                                  0260
*   REG0=LENGTH(TCWA)+(2*LENGTH(TCENTRY));                         0260
         LA    REG0,144                                            0260
*   GENERATE CODE(GETMAIN RC,LV=(0),SP=245     GET TOD CLOCK WORKAREA);
*                                                                  0261
         GETMAIN RC,LV=(0),SP=245     GET TOD CLOCK WORKAREA
*/********************************************************************/
*/*                                                                  */
*/* TEST FOR A SUCCESSFUL GETMAIN.                                   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0262
*   IF RETCODE=0 THEN                                              0262
*                                                                  0262
         LTR   RETCODE,RETCODE                                     0262
         BNZ   @RF00262                                            0262
*/********************************************************************/
*/*                                                                  */
*/* IF THE GETMAIN WAS SUCCESSFUL, SERIALIZE THE EXECUTION OF THIS   */
*/* CODE.                                                            */
*/*                                                                  */
*/********************************************************************/
*                                                                  0263
*     DO;                                                          0263
*LOOP2:                                                            0264
*       REG11=0;                    /* CLEAR REG11 FOR COMPARE AND 0264
*                                      SWAP                          */
LOOP2    SLR   REG11,REG11                                         0264
*       CS(REG11,REG1,TPCTCWA);     /* TEST FOR CODE IN EXECUTION    */
         L     @07,TPCPTR(,LCVTPTR)                                0265
         CS    REG11,@01,TPCTCWA(@07)                              0265
*       BC(7,LOOP2);                /* BRANCH IF CODE IN EXECUTION   */
         BC    7,LOOP2                                             0266
*/********************************************************************/
*/*                                                                  */
*/* ESTABLISH ADDRESSABILITY TO THE TOD CLOCK WORKAREA, SAVE THE     */
*/* NUMBER OF TOD CLOCK WORKAREA ENTRIES, AND SET THE WORKAREA FLAGS */
*/* TO ZEROES.                                                       */
*/*                                                                  */
*/********************************************************************/
*                                                                  0267
*       TCWAPTR=REG1;                                              0267
         LR    TCWAPTR,REG1                                        0267
*       TCCPUCNT=2;                                                0268
         MVC   TCCPUCNT(2,TCWAPTR),@CH00119                        0268
*       TCWAGFLG='00'X;             /*                       @YM08621*/
         MVI   TCWAGFLG(TCWAPTR),X'00'                             0269
*/********************************************************************/
*/*                                                                  */
*/* SET UP THE INTERFACE TO GET A PAGE FIXED, AND FIX THIS MODULE    */
*/*                                                                  */
*/********************************************************************/
*                                                                  0270
*       REG1=ADDR(BEGTOD);          /* GET POINTER TO START OF MODULE*/
         LA    REG1,BEGTOD                                         0270
*       REG15=ADDR(ENDTOD);         /* GET POINTER TO END OF MODULE  */
         LA    REG15,ENDTOD                                        0271
*       REG0=ADDR(TODECB);          /* GET POINTER TO ECB            */
         LA    REG0,TODECB                                         0272
*       TODECB=0;                   /* CLEAR ECB                     */
         SLR   @07,@07                                             0273
         ST    @07,TODECB                                          0273
*       GENERATE CODE(PGFIX R,A=(1),EA=(15),ECB=(0),LONG=N);       0274
*                                                                  0274
         PGFIX R,A=(1),EA=(15),ECB=(0),LONG=N
*/********************************************************************/
*/*                                                                  */
*/* WAIT FOR COMPLETION OF THE PAGE FIXING OPERATION.                */
*/*                                                                  */
*/********************************************************************/
*                                                                  0275
*       REG1=ADDR(TODECB);          /* GET ECB ADDRESS               */
         LA    REG1,TODECB                                         0275
*       GENERATE CODE(WAIT  1,ECB=(1));                            0276
*                                                                  0276
         WAIT  1,ECB=(1)
*/********************************************************************/
*/*                                                                  */
*/* SET THE RETURN CODE TO 4 SO THAT THE LOOP WILL BE EXECUTED AT    */
*/* AT LEAST ONCE.                                                   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0277
*       RETCODE=4;                                                 0277
         LA    RETCODE,4                                           0277
*                                                                  0278
*/********************************************************************/
*/*                                                                  */
*/* PERFORM THE FOLLOWING UNTIL A SET CLOCK IS FOUND, OR UNTIL ALL   */
*/* OSTENSIBLY GOOD CLOCKS HAVE BEEN TESTED AND HAVE BEEN FOUND NOT  */
*/* TO BE SET.  THE SET CLOCK WILL BE USED TO SYNCHRONIZE THE NEW    */
*/* CLOCK TO.                                                        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0278
*       PTREBEG=TCWAPTR+LENGTH(TCWA);/* SAVE PTR TO FIRST TCWA ENTRY */
         LA    @07,112                                             0278
         ALR   @07,TCWAPTR                                         0278
         ST    @07,PTREBEG                                         0278
*       REG12=CVTPCCAT+LENGTH(PCCAVT)-LENGTH(PCCAT00P);/* GET PTR TO
*                                      LAST PCCAVT ENTRY             */
         L     REG12,CVTPCCAT(,LCVTPTR)                            0279
         SH    REG12,@CH02779                                      0279
*       MASKHLDR=CSDCPUAL;          /* GET MASK OF ALIVE CPU'S       */
         L     @07,CVTCSD(,LCVTPTR)                                0280
         SLR   MASKHLDR,MASKHLDR                                   0280
         ICM   MASKHLDR,3,CSDCPUAL(@07)                            0280
*       CPUSLEFT=LENGTH(CSDCPUAL);  /* SAVE THE NUMBER OF BITS IN THE
*                                      MASK STILL TO BE TESTED       */
         MVC   CPUSLEFT(2),@CH00045                                0281
*       DO WHILE RETCODE=4;                                        0282
*                                                                  0282
         B     @DE00282                                            0282
@DL00282 DS    0H                                                  0283
*/********************************************************************/
*/*                                                                  */
*/* SEARCH THE CPU-ALIVE MASK FOR A BIT ON INDICATING AN ONLINE CPU. */
*/* WHEN ONE IS FOUND, TEST THE TOD CLOCK STATUS BYTE IN THE PCCA FOR*/
*/* THAT CPU TO DETERMINE IF THE CLOCK IS GOOD.                      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0283
*         DO REG1=CPUSLEFT TO 1 BY-1;                              0283
         LH    REG1,CPUSLEFT                                       0283
         B     @DE00283                                            0283
@DL00283 DS    0H                                                  0284
*           IF MASKHLDR//2^=0&PCCANUTD='0'B THEN                   0284
*                                                                  0284
         LR    @07,MASKHLDR                                        0284
         N     @07,@CF00096                                        0284
         LTR   @07,@07                                             0284
         BZ    @RF00284                                            0284
         L     @07,PTRPCCA(,REG12)                                 0284
         TM    PCCANUTD(@07),B'10000000'                           0284
         BNZ   @RF00284                                            0284
*/********************************************************************/
*/*                                                                  */
*/* IF THE CPU IS ONLINE AND ITS CLOCK IS GOOD, INITIALIZE THE TWO   */
*/* TOD CLOCK WORKAREA ENTRIES WITH THE THE PCCA ADDRESSES AND THE   */
*/* CPU ADDRESSES FOR THE CPU BEING VARY'ED ONLINE, AND FOR THE      */
*/* CPU WITH THE GOOD CLOCK.                                         */
*/*                                                                  */
*/********************************************************************/
*                                                                  0285
*             DO;                                                  0285
*               REG11=PTREBEG;      /* GET PTR TO FIRST TCWA ENTRY   */
         L     REG11,PTREBEG                                       0286
*               TCWAPCCA=PTRPCCA;                                  0287
         ST    @07,TCWAPCCA(,REG11)                                0287
*               TCWAIADD=PCCACPUA;                                 0288
         MVC   TCWAIADD(2,REG11),PCCACPUA(@07)                     0288
*               REG11=REG11+LENGTH(TCENTRY);/* POINT TO 2ND TCWA   0289
*                                      ENTRY                         */
         AH    REG11,@CH00045                                      0289
*               TCWAPCCA=ADDR(NEWPCCA);                            0290
         L     @07,@PC00001                                        0290
         ST    @07,TCWAPCCA(,REG11)                                0290
*               TCWAIADD=ADDR(NEWPCCA)->PCCACPUA;                  0291
*                                                                  0291
         MVC   TCWAIADD(2,REG11),PCCACPUA(@07)                     0291
*/********************************************************************/
*/*                                                                  */
*/* SET THE RETURN CODE AND LOOP CONTROL TO 0 SO THAT AN EXIT FROM   */
*/* THE LOOP WILL OCCUR. THEN,                                       */
*/* DECREMENT AND SAVE THE INDEX THROUGH THE CPU-ALIVE MASK SO       */
*/* THAT IF THE APPARENTLY GOOD CLOCK TURNS OUT NOT TO BE SET, THE   */
*/* THE SEARCH THROUGH THE MASK WILL BEGIN WITH THE NEXT BIT.        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0292
*               CPUSLEFT=REG1-1;                                   0292
         LR    @07,REG1                                            0292
         BCTR  @07,0                                               0292
         STH   @07,CPUSLEFT                                        0292
*               REG1=0;                                            0293
         SLR   REG1,REG1                                           0293
*               RETCODE=0;                                         0294
         SLR   RETCODE,RETCODE                                     0294
*             END;                                                 0295
*           MASKHLDR=MASKHLDR/2;    /* GET NEXT BIT TO TEST          */
@RF00284 SRL   MASKHLDR,1                                          0296
*           REG12=REG12-LENGTH(PCCAT00P);/* POINT TO NEXT PCCAVT   0297
*                                      ENTRY                         */
         SH    REG12,@CH00108                                      0297
*         END;                                                     0298
         BCTR  REG1,0                                              0298
@DE00283 LTR   REG1,REG1                                           0298
         BP    @DL00283                                            0298
*                                                                  0299
*/********************************************************************/
*/*                                                                  */
*/* TEST FOR GOOD TOD CLOCK FOUND.                                   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0299
*         IF RETCODE=0 THEN                                        0299
*                                                                  0299
         LTR   RETCODE,RETCODE                                     0299
         BNZ   @RF00299                                            0299
*/********************************************************************/
*/*                                                                  */
*/* IF IT IS 0, CALL THE SYNCHRONIZATION TESTING ROUTINE.            */
*/*                                                                  */
*/********************************************************************/
*                                                                  0300
*           DO;                                                    0300
*             CALL IEAVRTST;                                       0301
*                                                                  0301
         BAL   @14,IEAVRTST                                        0301
*/********************************************************************/
*/*                                                                  */
*/* TEST THE RETURN CODE FROM THE SYNCHRONIZATION TESTING ROUTINE    */
*/* FOR A VALUE OF 0 OR 4 INDICATING A SET OR NOT SET SUBJECT CLOCK, */
*/* OR A RETURN CODE OF 20 INDICATING A FAILURE TO SIGNAL SOME       */
*/* PROCESSOR OTHER THAN THE SUBJECT.                        @ZA15781*/
*/*                                                                  */
*/********************************************************************/
*                                                                  0302
*             IF RETCODE^=0&RETCODE^=4&RETCODE^=20 THEN/*    @ZA15781*/
         LTR   RETCODE,RETCODE                                     0302
         BZ    @RF00302                                            0302
         CH    RETCODE,@CH00108                                    0302
         BE    @RF00302                                            0302
         CH    RETCODE,@CH00507                                    0302
         BE    @RF00302                                            0302
*               DO;                                                0303
*                                                                  0303
*/********************************************************************/
*/*                                                                  */
*/* IF THE RETURN CODE ISN'T 0 OR 4, SEE IF IT IS 16, INDICATING THAT*/
*/* THE TESTING COULD NOT BE PERFORMED WITHIN 2**20 MICROSECONDS.    */
*/*                                                                  */
*/********************************************************************/
*                                                                  0304
*                 IF RETCODE=16 THEN                               0304
*                                                                  0304
         CH    RETCODE,@CH00045                                    0304
         BNE   @RF00304                                            0304
*/********************************************************************/
*/*                                                                  */
*/* IF IT IS 16, INDICATE THAT THE NEW CPU REQUIRES SYNCHRONIZING.   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0305
*                   ADDR(NEWPCCA)->PCCASYNC='1'B;                  0305
*                                                                  0305
         L     @07,@PC00001                                        0305
         OI    PCCASYNC(@07),B'01000000'                           0305
*/********************************************************************/
*/*                                                                  */
*/* IF IT WAS 8, 12, OR 16, CALL THE SYNCHRONIZING ROUTINE TO PERFORM*/
*/* THE SYNCHING OPERATION, AND THEN CALL THE TESTING ROUTINE TO     */
*/* TEST FOR SUCCESSFUL PERFORMANCE.                                 */
*/*                                                                  */
*/********************************************************************/
*                                                                  0306
*                 CALL IEAVRSYN;                                   0306
@RF00304 BAL   @14,IEAVRSYN                                        0306
*                 CALL IEAVRTST;                                   0307
         BAL   @14,IEAVRTST                                        0307
*               END;                                               0308
*           END;                                                   0309
*         ELSE                                                     0310
*                                                                  0310
*/********************************************************************/
*/*                                                                  */
*/* IF NO GOOD CLOCK WAS FOUND TO WHICH TO SYNCHRONIZE THE NEW CLOCK,*/
*/* SET BAIN TO 0 TO DISALLOW EXTERNAL SET COMMANDS, AND THEN DEQUEUE*/
*/* THE MIDNIGHT AND JOBSTEP TIMING TQES.                            */
*/*                                                                  */
*/********************************************************************/
*                                                                  0310
*           DO;                                                    0310
         B     @RC00299                                            0310
@RF00299 DS    0H                                                  0311
*             BAIN='0'B;                                           0311
         L     @07,CVTMSER(,LCVTPTR)                               0311
         NI    BAIN(@07),B'01111111'                               0311
*             REG1=ADDR(TPCMNTQE);  /* GET ADDR OF MIDNIGHT TQE      */
         L     REG1,TPCPTR(,LCVTPTR)                               0312
         LA    REG1,TPCMNTQE(,REG1)                                0312
*             REG15=ADDR(DEQTQE);   /* GET ADDR OF DEQ ROUTINE       */
         L     REG15,CVTQTD00(,LCVTPTR)                            0313
*             GENERATE CODE REFS(REG15,PSALITA) SETS(REG2);        0314
         SETLOCK OBTAIN,TYPE=DISP,MODE=UNCOND,                        **
               RELATED=('REQUIRED BY TQE DEQ',(IEAVRTOD,(NOLABEL)))
         BALR  REG2,REG15     DEQUEUE THE MIDNIGHT TQE
*             REG1->TQEVALLH=0;     /* SET TQEVAL OF MIDNIGHT = 0...
*                                                            @YM06393*/
         SLR   @07,@07                                             0315
         ST    @07,TQEVALLH(,REG1)                                 0315
*             REG1->TQEVALRH=0;     /* ...TO NOP TIME SVC    @YM06393*/
         ST    @07,TQEVALRH(,REG1)                                 0316
*             LCVTPTR=CVTPTR;       /* RESTORE CVT ADDRESSABILITY    */
         L     LCVTPTR,CVTPTR                                      0317
*             REG1=ADDR(TPCLMTQE);  /* GET ADDR OF JOB STEP TIMING 0318
*                                      TQE                           */
         L     REG1,TPCPTR(,LCVTPTR)                               0318
         LA    REG1,TPCLMTQE(,REG1)                                0318
*             REG15=ADDR(DEQTQE);   /* GET ADDR OF DEQ ROUTINE       */
         L     REG15,CVTQTD00(,LCVTPTR)                            0319
*             GENERATE CODE REFS(REG15,PSALITA) SETS(REG2);        0320
         BALR  REG2,REG15     DEQUEUE THE JOB STEP TIMING TQE
         SETLOCK RELEASE,TYPE=DISP,                                   **
               RELATED=('REQUIRED BY TQE DEQ',(IEAVRTOD,(NOLABEL)))
*             LCVTPTR=CVTPTR;       /* RESTORE CVT ADDRESSABILITY    */
         L     LCVTPTR,CVTPTR                                      0321
*             REG13=R13SAV;         /* RESTORE SAVE AREA POINTER     */
         L     REG13,R13SAV                                        0322
*/********************************************************************/
*/*                                                                  */
*/* INITIALIZE THE FIRST TOD CLOCK WORKAREA ENTRY FOR THE NEW CPU,   */
*/* SET THE COUNT OF CPU'S TO 1, AND CALL THE TESTING ROUTINE TO     */
*/* TEST THE STATUS OF THE NEW CLOCK BY ITSELF.                      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0323
*             REG11=PTREBEG;        /* GET PTR TO FIRST ENTRY        */
         L     REG11,PTREBEG                                       0323
*             TCWAPCCA=ADDR(NEWPCCA);/* FILL IN PCCA ADDRESS         */
         L     @07,@PC00001                                        0324
         ST    @07,TCWAPCCA(,REG11)                                0324
*             TCWAIADD=ADDR(NEWPCCA)->PCCACPUA;/* FILL IN CPU ADDRESS*/
         MVC   TCWAIADD(2,REG11),PCCACPUA(@07)                     0325
*             TCCPUCNT=1;                                          0326
         MVC   TCCPUCNT(2,TCWAPTR),@CH00096                        0326
*             CALL IEAVRTST;        /* CALL SYNCHRONIZATION TESTING
*                                      ROUTINE                       */
         BAL   @14,IEAVRTST                                        0327
*/********************************************************************/
*/*                                                                  */
*/* TEST FOR A RETURN CODE OF 0 INDICATING THAT THE CLOCK IS SET.    */
*/*                                                                  */
*/********************************************************************/
*                                                                  0328
*             IF RETCODE=0 THEN                                    0328
*                                                                  0328
         LTR   RETCODE,RETCODE                                     0328
         BNZ   @RF00328                                            0328
*/********************************************************************/
*/*                                                                  */
*/* IF THE RETURN CODE IS 0, INDICATE THAT MESSAGE IEA888A SHOULD    */
*/* BE ISSUED.                                                       */
*/*                                                                  */
*/********************************************************************/
*                                                                  0329
*               TCGXXX='1'B;                                       0329
         OI    TCGXXX(TCWAPTR),B'10000000'                         0329
*             ELSE                                                 0330
*                                                                  0330
*/********************************************************************/
*/*                                                                  */
*/* IF THE RETURN CODE IS NOT 0, INDICATE THAT MESSAGE IEA886A       */
*/* SHOULD BE ISSUED.                                                */
*/*                                                                  */
*/********************************************************************/
*                                                                  0330
*               TCGYYY='1'B;                                       0330
*                                                                  0330
         B     @RC00328                                            0330
@RF00328 OI    TCGYYY(TCWAPTR),B'01000000'                         0330
*/********************************************************************/
*/*                                                                  */
*/* CALL THE COMMUNICATIONS ROUTINE TO ISSUE THE INDICATED MESSAGE.  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0331
*             CALL IEAVRCOM;                                       0331
*                                                                  0331
@RC00328 BAL   @14,IEAVRCOM                                        0331
*/********************************************************************/
*/*                                                                  */
*/* CALL THE SYNCHRONIZATION TESTING ROUTINE TO ENSURE THAT THE CLOCK*/
*/* IS STILL SET, SINCE THE OPERATOR MAY HAVE CHANGED IT.  (NOTE:    */
*/* THE RETURN CODE FROM THIS TEST CAN ONLY BE 0 OR 4.)              */
*/*                                                                  */
*/********************************************************************/
*                                                                  0332
*             CALL IEAVRTST;                                       0332
*                                                                  0332
         BAL   @14,IEAVRTST                                        0332
*/********************************************************************/
*/*                                                                  */
*/* SEE IF THE RETURN CODE IS NON-0, AND IF IT IS SET IT TO 16.      */
*/* (NOTE: THE ONLY POSSIBLE NON-0 RETURN CODE AT THIS POINT IS 4,   */
*/* WHICH WILL CAUSE RE-CHECKING FOR ANOTHER ONLINE CPU HAVING A     */
*/* CLOCK THAT MAY BE SYNCHRONIZED TO.  THIS MUST BE AVOIDED BECAUSE */
*/* THE PRESENT PATH WAS TAKEN WHEN IT WAS FOUND THAT THERE WERE     */
*/* NO MORE ONLINE CPU'S.)                                           */
*/*                                                                  */
*/********************************************************************/
*                                                                  0333
*             IF RETCODE^=0 THEN                                   0333
         LTR   RETCODE,RETCODE                                     0333
         BZ    @RF00333                                            0333
*               RETCODE=16;                                        0334
         LA    RETCODE,16                                          0334
*             ELSE                                                 0335
*                                                                  0335
*/********************************************************************/
*/*                                                                  */
*/* IF THE RETURN CODE IS 0, THE NEW CLOCK IS ALL RIGHT, SO TURN ON  */
*/* THE FLAG WHICH INDICATES THAT THE MIDNIGHT AND JOB STEP TIMING   */
*/* TQES SHOULD BE RE-ENQUEUED, AND THAT THE SRM SHOULD BE NOTIFIED. */
*/*                                                                  */
*/********************************************************************/
*                                                                  0335
*               TCGTQE='1'B;                                       0335
         B     @RC00333                                            0335
@RF00333 OI    TCGTQE(TCWAPTR),B'00000001'                         0335
*           END;                                                   0336
@RC00333 DS    0H                                                  0337
*       END;                                                       0337
@RC00299 DS    0H                                                  0337
@DE00282 CH    RETCODE,@CH00108                                    0337
         BE    @DL00282                                            0337
*                                                                  0338
*/********************************************************************/
*/*                                                                  */
*/* IF AN APPARENTLY GOOD CLOCK WAS FOUND, SEE IF THE TESTING ROUTINE*/
*/* SENT BACK A RETURN CODE OF 8, INDICATING THAT A SYNC CHECK OC-   */
*/* CURED.                                                           */
*/*                                                                  */
*/********************************************************************/
*                                                                  0338
*       IF RETCODE=8 THEN                                          0338
*                                                                  0338
         CH    RETCODE,@CH00038                                    0338
         BNE   @RF00338                                            0338
*/********************************************************************/
*/*                                                                  */
*/* IF THAT IS THE CASE, SEARCH ALL ONLINE CPU'S FOR ONE WHICH IS NOT*/
*/* THE NEW CPU, AND WHOSE CLOCK IS MARKED AS NOT USEABLE.           */
*/*                                                                  */
*/********************************************************************/
*                                                                  0339
*         DO;                                                      0339
*           MASKHLDR=CSDCPUAL;      /* GET THE MASK OF ALIVE CPU'S   */
         L     @07,CVTCSD(,LCVTPTR)                                0340
         SLR   MASKHLDR,MASKHLDR                                   0340
         ICM   MASKHLDR,3,CSDCPUAL(@07)                            0340
*           REG12=CVTPCCAT+LENGTH(PCCAVT)-LENGTH(PCCAT00P);/* GET PTR
*                                      TO LAST PCCAVT ENTRY          */
         L     REG12,CVTPCCAT(,LCVTPTR)                            0341
         SH    REG12,@CH02779                                      0341
*           DO REG1=LENGTH(CSDCPUAL) TO 1 BY-1;                    0342
         LA    REG1,16                                             0342
@DL00342 DS    0H                                                  0343
*             IF MASKHLDR//2^=0&PTRPCCA^=ADDR(NEWPCCA)&PCCANUTD='1'B
*               THEN                                               0343
*                                                                  0343
         LR    @07,MASKHLDR                                        0343
         N     @07,@CF00096                                        0343
         LTR   @07,@07                                             0343
         BZ    @RF00343                                            0343
         L     @07,PTRPCCA(,REG12)                                 0343
         L     @06,@PC00001                                        0343
         CR    @07,@06                                             0343
         BE    @RF00343                                            0343
         TM    PCCANUTD(@07),B'10000000'                           0343
         BNO   @RF00343                                            0343
*/********************************************************************/
*/*                                                                  */
*/* IF ONE IS FOUND, ASSUME THAT IT CAUSED THE SYNC CHECK.  ZERO THE */
*/* LOOP CONTROL TO EXIT FROM THE LOOP, AND SET THE RETURN CODE FOR  */
*/* THE CALLER TO 0 TO INDICATE SUCCESS.                             */
*/*                                                                  */
*/********************************************************************/
*                                                                  0344
*               DO;                                                0344
*                 REG1=0;                                          0345
         SLR   REG1,REG1                                           0345
*                 RETCODE=0;                                       0346
         SLR   RETCODE,RETCODE                                     0346
*               END;                                               0347
*             MASKHLDR=MASKHLDR/2;  /* GET NEXT BIT TO TEST          */
@RF00343 SRL   MASKHLDR,1                                          0348
*             REG12=REG12-LENGTH(PCCAT00P);/* POINT TO NEXT PCCAVT 0349
*                                      ENTRY                         */
         SH    REG12,@CH00108                                      0349
*           END;                                                   0350
         BCTR  REG1,0                                              0350
         LTR   REG1,REG1                                           0350
         BP    @DL00342                                            0350
*         END;                                                     0351
*                                                                  0351
*/********************************************************************/
*/*                                                                  */
*/* SAVE THE RETURN CODE TO PASS BACK TO THE CALLER.  THEN GET THE   */
*/* ADDRESS OF THE ESTAE PARAMETER LIST FOR COMPATABILITY WITH AN    */
*/* ENTRY FROM THE ESTAE EXIT AT SSCRETRY.                           */
*/*                                                                  */
*/********************************************************************/
*                                                                  0352
*       RCSAVE=RETCODE;                                            0352
@RF00338 ST    RETCODE,RCSAVE                                      0352
*       REG1=ADDR(SSCRPARM);                                       0353
*                                                                  0353
         LA    REG1,SSCRPARM                                       0353
*/********************************************************************/
*/*                                                                  */
*/* RESTORE BASE REGS, DATA REG, AND CVT POINTER FOR POSSIBLE ENTRY  */
*/* FROM THE ESTAE EXIT.                                             */
*/*                                                                  */
*/********************************************************************/
*                                                                  0354
*SSCRETRY:                                                         0354
*       GEN CODE REFS(REG1) SETS(REG8,REG9,REG10)                  0354
*           (LM    REG8,REG10,0(REG1));                            0354
SSCRETRY LM    REG8,REG10,0(REG1)
*       LCVTPTR=CVTPTR;                                            0355
*                                                                  0355
         L     LCVTPTR,CVTPTR                                      0355
*/********************************************************************/
*/*                                                                  */
*/* TEST THE CONTENTS OF THE RETURN CODE FOR 0.  IT WILL BE 0 IF     */
*/* THE NEW CLOCK WAS SUCCESSFULLY SET OR SYNCHRONIZED, AND NON 0 IF */
*/* IT WAS NOT, OR IF ENTRY HERE IS FROM THE ESTAE EXIT.             */
*/*                                                                  */
*/********************************************************************/
*                                                                  0356
*       IF RCSAVE^=0 THEN                                          0356
*                                                                  0356
         SLR   @07,@07                                             0356
         C     @07,RCSAVE                                          0356
         BE    @RF00356                                            0356
*/********************************************************************/
*/*                                                                  */
*/* IF THE RETURN CODE IS NOT 0, SEE IF THE CALLER WAS THE VARY      */
*/* COMMAND PROCESSOR.                                               */
*/*                                                                  */
*/********************************************************************/
*                                                                  0357
*         DO;                                                      0357
*           IF CALLERID=0 THEN                                     0358
*                                                                  0358
         CH    @07,CALLERID                                        0358
         BNE   @RF00358                                            0358
*/********************************************************************/
*/*                                                                  */
*/* IF THE CALLER IS VARY, INDICATE THAT THE VARY PROCESS SHOULD BE  */
*/* STOPPED, AND RELEASE THE NEW CPU FROM ITS SPIN.                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0359
*             DO;                                                  0359
*               ADDR(NEWPCCA)->PCCAVKIL='1'B;                      0360
         L     @07,@PC00001                                        0360
         OI    PCCAVKIL(@07),B'00100000'                           0360
*               ADDR(NEWPCCA)->PCCAPSAV->PSALCCAV->LCCATIMR='0'B;  0361
         L     @07,PCCAPSAV(,@07)                                  0361
         L     @07,PSALCCAV(,@07)                                  0361
         NI    LCCATIMR(@07),B'11101111'                           0361
*             END;                                                 0362
*                                                                  0362
*/********************************************************************/
*/*                                                                  */
*/* IF THE CALLER IS HARDWARE RECOVERY, SEE IF THE MIDNIGHT AND      */
*/* JOBSTEP TIMING TQE'S WERE DEQUEUED BECAUSE THERE WERE NO GOOD    */
*/* TOD CLOCKS IN THE CONFIGURATION.  IF SO, SET THE VAULE OF THE    */
*/* MIDNIGHT TQEVAL FIELD TO 1.048576 SECONDS SO THAT THE TIME SVC   */
*/* ROUTINE WILL NOT NOP.                                            */
*/*                                                                  */
*/********************************************************************/
*                                                                  0363
*           ELSE                    /*                       @YM06393*/
*             DO;                   /*                       @YM06393*/
         B     @RC00358                                            0363
@RF00358 DS    0H                                                  0364
*               IF TCGTQE='1'B THEN /* IF TQE'S DEQUEUED...  @YM06393*/
         TM    TCGTQE(TCWAPTR),B'00000001'                         0364
         BNO   @RF00364                                            0364
*                 MNIGHTLH=1;       /* ...SET MIDNIGHT TQEVAL TO   0365
*                                      NON-0                 @YM06393*/
         L     @07,TPCPTR(,LCVTPTR)                                0365
         MVC   MNIGHTLH(4,@07),@CF00096                            0365
*             END;                  /*                       @YM06393*/
*         END;                                                     0367
*       ELSE                                                       0368
*                                                                  0368
*/********************************************************************/
*/*                                                                  */
*/* IF THE RETURN CODE WAS 0, SEE IF THE JOB STEP TIMING AND MIDNIGHT*/
*/* TQES NEED TO BE RE-ENQUEUED, AND THE SRM NOTIFIED THAT THERE IS  */
*/* ONCE AGAIN A GOOD TOD CLOCK AND CLOCK COMPARATOR. IF SO, CALL THE*/
*/* ROUTINE TO PERFORM THESE ACTIONS.                                */
*/*                                                                  */
*/********************************************************************/
*                                                                  0368
*         DO;                                                      0368
         B     @RC00356                                            0368
@RF00356 DS    0H                                                  0369
*           IF TCGTQE='1'B THEN                                    0369
         TM    TCGTQE(TCWAPTR),B'00000001'                         0369
         BNO   @RF00369                                            0369
*             CALL TQEINIT;                                        0370
*                                                                  0370
         LA    @15,TQEINIT                                         0370
         BALR  @14,@15                                             0370
*/********************************************************************/
*/*                                                                  */
*/* GET THE DISPATCHER LOCK FOR SETTING THE TPCABND FLAG, AND        */
*/* INVOKING THE SET CC ROUTINE.                                     */
*/*                                                                  */
*/********************************************************************/
*                                                                  0371
*           GENERATE CODE REFS(PSALITA);                           0371
*                                                                  0371
@RF00369 DS    0H                                                  0371
*                                    /*
         SETLOCK  OBTAIN,TYPE=DISP,MODE=UNCOND,                       **
               RELATED=('REAL TQE QUEUE',(IEAVRTOD,(NOLABEL)))  */
*/********************************************************************/
*/*                                                                  */
*/* SEE IF THE CALLER WAS VARY.                                      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0372
*           IF CALLERID=0 THEN                                     0372
*                                                                  0372
         ICM   @07,3,CALLERID                                      0372
         BNZ   @RF00372                                            0372
*/********************************************************************/
*/*                                                                  */
*/* IF THE CALLER IS VARY, INITIALIZE THE TIMER STATUS BYTES IN THE  */
*/* PCCA FOR THE NEW CPU.                                            */
*/*                                                                  */
*/********************************************************************/
*                                                                  0373
*             DO;                                                  0373
*               ADDR(NEWPCCA)->PCCATMST=TMSTINIT;                  0374
*                                                                  0374
         L     @07,@PC00001                                        0374
         MVC   PCCATMST(4,@07),TMSTINIT                            0374
*/********************************************************************/
*/*                                                                  */
*/* ADD 1 TO THE COUNT OF GOOD TOD CLOCKS IN THE CSD.                */
*/*                                                                  */
*/********************************************************************/
*                                                                  0375
*               CURRENT=CSDGDTOD;                                  0375
         L     @07,CVTCSD(,LCVTPTR)                                0375
         L     CURRENT,CSDGDTOD(,@07)                              0375
*ADD1:                                                             0376
*               NEW=CURRENT+1;      /* SET UP FOR COMPARE AND SWAP   */
ADD1     LA    NEW,1                                               0376
         ALR   NEW,CURRENT                                         0376
*               CS(CURRENT,NEW,CSDGDTOD);                          0377
         L     @07,CVTCSD(,LCVTPTR)                                0377
         CS    CURRENT,@01,CSDGDTOD(@07)                           0377
*               BC(7,ADD1);                                        0378
*                                                                  0378
         BC    7,ADD1                                              0378
*/********************************************************************/
*/*                                                                  */
*/* ADD 1 TO THE COUNT OF GOOD CLOCK COMPARATORS IN THE CSD.         */
*/*                                                                  */
*/********************************************************************/
*                                                                  0379
*               CURRENT=CSDGDCC;                                   0379
         L     @07,CVTCSD(,LCVTPTR)                                0379
         L     CURRENT,CSDGDCC(,@07)                               0379
*ADD7:                                                             0380
*               NEW=CURRENT+1;      /* SET UP FOR COMPARE AND SWAP   */
ADD7     LA    NEW,1                                               0380
         ALR   NEW,CURRENT                                         0380
*               CS(CURRENT,NEW,CSDGDCC);                           0381
         L     @07,CVTCSD(,LCVTPTR)                                0381
         CS    CURRENT,@01,CSDGDCC(@07)                            0381
*               BC(7,ADD7);                                        0382
*                                                                  0382
         BC    7,ADD7                                              0382
*/********************************************************************/
*/*                                                                  */
*/* ADD 1 TO THE COUNT OF GOOD CPU TIMERS IN THE CSD.                */
*/*                                                                  */
*/********************************************************************/
*                                                                  0383
*               CURRENT=CSDGDINT;                                  0383
         L     @07,CVTCSD(,LCVTPTR)                                0383
         L     CURRENT,CSDGDINT(,@07)                              0383
*ADD8:                                                             0384
*               NEW=CURRENT+1;      /* SET UP FOR COMPARE AND SWAP   */
ADD8     LA    NEW,1                                               0384
         ALR   NEW,CURRENT                                         0384
*               CS(CURRENT,NEW,CSDGDINT);                          0385
         L     @07,CVTCSD(,LCVTPTR)                                0385
         CS    CURRENT,@01,CSDGDINT(@07)                           0385
*               BC(7,ADD8);                                        0386
*                                                                  0386
         BC    7,ADD8                                              0386
*/********************************************************************/
*/*                                                                  */
*/* INDICATE THAT TASKS WITH REAL TQE'S NO LONGER NEED BE ABEND'ED   */
*/* SINCE THERE IS NOW A GOOD TOD CLOCK AND CLOCK COMPARATOR IN THE  */
*/* SYSTEM.  (NOTE: UNLIKE RELEASE 2, THE NEW CPU IS NOT RELEASED    */
*/* FROM ITS SPIN WHEN THE SETTING/SYNCHRONIZING PROCEDURE IS SUC-   */
*/* CESSFUL.  THE RELEASE WILL BE PERFORMED BY THE VARY CPU COMMAND  */
*/* PROCESSOR.)                                                      */
*/*                                                                  */
*/********************************************************************/
*/* D207820                                                  @Y30CQYA*/
*                                                                  0387
*               TPCABND='0'B;                                      0387
         L     @07,TPCPTR(,LCVTPTR)                                0387
         NI    TPCABND(@07),B'01111111'                            0387
*             END;                                                 0388
*                                                                  0388
*/********************************************************************/
*/*                                                                  */
*/* MAKE SURE THAT THE QUEUE OF REAL TIME TQE'S IS KEPT ALIVE.       */
*/*                                                                  */
*/********************************************************************/
*                                                                  0389
*           REG12=TPCCKQ;                                          0389
@RF00372 L     @07,TPCPTR(,LCVTPTR)                                0389
         L     REG12,TPCCKQ(,@07)                                  0389
*           GENERATE CODE REFS(REG12) SETS(REG2)(BALR  REG2,REG12);
         BALR  REG2,REG12
*           LCVTPTR=CVTPTR;         /* RESTORE THE CVT BASE          */
         L     LCVTPTR,CVTPTR                                      0391
*/********************************************************************/
*/*                                                                  */
*/* RELEASE THE DISPATCHER LOCK.                                     */
*/*                                                                  */
*/********************************************************************/
*                                                                  0392
*           GENERATE CODE REFS(PSALITA);                           0392
*                                   /*
         SETLOCK RELEASE,TYPE=DISP,                                   **
               RELATED=('REAL TQE QUEUE',(IEAVRTOD,(NOLABEL)))  */
*         END;                                                     0393
*                                                                  0394
*/********************************************************************/
*/*                                                                  */
*/* ENSURE THAT EXTERNAL SET COMMANDS ARE NOW ALLOWED.               */
*/*                                                                  */
*/********************************************************************/
*                                                                  0394
*       BAIN='1'B;                                                 0394
*                                                                  0394
@RC00356 L     @07,CVTMSER(,LCVTPTR)                               0394
         OI    BAIN(@07),B'10000000'                               0394
*/********************************************************************/
*/*                                                                  */
*/* UNCONDITIONALLY FREE THE TIME OF DAY CLOCK WORKAREA.             */
*/*                                                                  */
*/********************************************************************/
*                                                                  0395
*       REG0=LENGTH(TCWA)+(2*LENGTH(TCENTRY));/* GET LENGTH OF TCWA  */
         LA    REG0,144                                            0395
*       REG1=TCWAPTR;               /* GET ADDRESS OF TCWA           */
         LR    REG1,TCWAPTR                                        0396
*       GENERATE CODE                                              0397
*           (FREEMAIN RU,LV=(0),A=(1),SP=245       FREE WORKAREA); 0397
*                                                                  0397
         FREEMAIN RU,LV=(0),A=(1),SP=245       FREE WORKAREA
*/********************************************************************/
*/*                                                                  */
*/* FREE THE PAGE WITH THE MODULE AND ZERO THE POINTER IN THE TPC TO */
*/* THE TOD CLOCK WORKAREA.                                          */
*/*                                                                  */
*/********************************************************************/
*                                                                  0398
*       REG1=ADDR(BEGTOD);          /* GET POINTER TO START OF MODULE*/
         LA    REG1,BEGTOD                                         0398
*       REG15=ADDR(ENDTOD);         /* GET POINTER TO END OF MODULE  */
         LA    REG15,ENDTOD                                        0399
*       GENERATE CODE(PGFREE R,A=(1),EA=(15));                     0400
         PGFREE R,A=(1),EA=(15)
*       TPCTCWA=0;                                                 0401
         L     @07,TPCPTR(,LCVTPTR)                                0401
         SLR   @06,@06                                             0401
         ST    @06,TPCTCWA(,@07)                                   0401
*     END;                                                         0402
*   ELSE                                                           0403
*                                                                  0403
*/********************************************************************/
*/*                                                                  */
*/* IF THE GETMAIN FOR THE WORKAREA WAS UNSUCCESSFUL, SAVE THE RE-   */
*/* TURN CODE AS A FAILURE INDICATOR TO THE CALLER.                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0403
*     DO;                                                          0403
         B     @RC00262                                            0403
@RF00262 DS    0H                                                  0404
*       RCSAVE=RETCODE;                                            0404
*                                                                  0404
         ST    RETCODE,RCSAVE                                      0404
*/********************************************************************/
*/*                                                                  */
*/* SEE IF THE CALLER IS VARY.                                       */
*/*                                                                  */
*/********************************************************************/
*                                                                  0405
*       IF CALLERID=0 THEN                                         0405
*                                                                  0405
         ICM   @07,3,CALLERID                                      0405
         BNZ   @RF00405                                            0405
*/********************************************************************/
*/*                                                                  */
*/* IF THE CALLER IS VARY, INDICATE THAT THE PROCESS SHOULD BE       */
*/* KILLED, AND RELEASE THE NEW CPU FROM ITS SPIN.                   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0406
*         DO;                                                      0406
*           ADDR(NEWPCCA)->PCCAVKIL='1'B;                          0407
         L     @07,@PC00001                                        0407
         OI    PCCAVKIL(@07),B'00100000'                           0407
*           ADDR(NEWPCCA)->PCCAPSAV->PSALCCAV->LCCATIMR='0'B;      0408
         L     @07,PCCAPSAV(,@07)                                  0408
         L     @07,PSALCCAV(,@07)                                  0408
         NI    LCCATIMR(@07),B'11101111'                           0408
*         END;                                                     0409
*     END;                                                         0410
*                                                                  0410
@RF00405 DS    0H                                                  0411
*/********************************************************************/
*/*                                                                  */
*/* DELETE ERROR EXIT FOR UNLOCKED CODE.                             */
*/*                                                                  */
*/********************************************************************/
*                                                                  0411
*   GEN CODE(ESTAE 0);                                             0411
*                                                                  0411
@RC00262 DS    0H                                                  0411
         ESTAE 0
*/********************************************************************/
*/*                                                                  */
*/* RESTORE THE SAVEAREA ADDRESS, AND RETURN TO THE CALLER WITH A    */
*/* RETURN CODE IN REGISTER 15.                                      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0412
*   REG13=R13SAV;                                                  0412
         L     REG13,R13SAV                                        0412
*   RETURN CODE(RCSAVE);                                           0413
         L     @07,RCSAVE                                          0413
         L     @13,4(,@13)                                         0413
         L     @00,@SIZDATD                                        0413
         LR    @01,@08                                             0413
         FREEMAIN R,LV=(0),A=(1)
         LR    @15,@07                                             0413
         L     @14,12(,@13)                                        0413
         LM    @00,@12,20(@13)                                     0413
         BR    @14                                                 0413
*                                                                  0414
*/********************************************************************/
*/*                                                                  */
*/*             TQEINIT--TQE INITIALIZATION ROUTINE                  */
*/*                                                                  */
*/* THIS ROUTINE RECEIVES CONTROL FROM IEAVRINT AFTER THE TOD        */
*/* CLOCK(S) HAVE BEEN INITIALIZED, AND FROM IEAVRSSC WHEN THE CLOCK */
*/* IN THE CPU BEING VARY'ED ONLINE OR IN THE CPU WITH THE FAILING   */
*/* CLOCK HAD TO BE SET BECAUSE THERE WAS NO OTHER CLOCK ALREADY IN  */
*/* THE CONFIGURATION WITH WHICH TO SYNCHRONIZE IT.  THE DISPATCHER  */
*/* LOCK IS HELD UPON ENTRY.                                         */
*/*                                                                  */
*/* IT CALCULATES THE INITIAL VALUES FOR THE MIDNIGHT AND JOB STEP   */
*/* TIMING TQES AND ENQUEUES THEM, AND THEN NOTIFIES THE SRM.        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0414
*TQEINIT:                                                          0414
*   PROCEDURE OPTIONS(NOSAVE,NOSAVEAREA,ENTREG,RETREG,NOPARMREG);  0414
*                                                                  0414
TQEINIT  DS    0H                                                  0415
*/********************************************************************/
*/*                                                                  */
*/* GET THE NUMBER OF DAYS (LOCAL) ELAPSED SINCE THE EPOCH PLUS 1.   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0415
*   RETSAVE=REG14;                  /* SAVE RETURN ADDRESS           */
         ST    REG14,RETSAVE                                       0415
*   TMICSECR=TCELDAYS;                                             0416
*                                                                  0416
         L     TMICSECR,TCELDAYS(,TCWAPTR)                         0416
*/********************************************************************/
*/*                                                                  */
*/* CALCULATE THE VALUE FOR THE MIDNIGHT TQE.                        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0417
*   GENERATE CODE REFS(MINSDAY,MICSMIN) SETS(TMICSECL,TMICSECR);   0417
*                                                                  0417
          MH    TMICSECR,MINSDAY    CONVERT DAYS TO MINUTES
          M     TMICSECL,MICSMIN    CONVERT MINUTES TO MICROSECONDS
          SLDL  TMICSECL,12         SHIFT MICROSECONDS TO BIT 51
*/********************************************************************/
*/*                                                                  */
*/* ADJUST CALCULATED VALUE BY TIME ZONE CONSTANT AND PUT INTO TQE.  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0418
*   TMICSECL=TMICSECL-CVTTZ;                                       0418
         SL    TMICSECL,CVTTZ(,LCVTPTR)                            0418
*   REG15=ADDR(TPCMNTQE);                                          0419
         L     REG15,TPCPTR(,LCVTPTR)                              0419
         LA    REG15,TPCMNTQE(,REG15)                              0419
*   STM(TMICSECL,TMICSECR,REG15->TQEVAL);                          0420
*                                                                  0420
         STM   TMICSECL,TMICSECR,TQEVAL(REG15)                     0420
*/********************************************************************/
*/*                                                                  */
*/* OBTAIN THE DISPATCHER LOCK FOR ENQUEING THE JOBTEP TIMING AND    */
*/* MIDNIGHT TQES.                                                   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0421
*   GENERATE CODE REFS(PSALITA);                                   0421
*                                                                  0421
*                                 /*
         SETLOCK OBTAIN,TYPE=DISP,MODE=UNCOND,                        **
               RELATED=('REQUIRED BY TQE ENQ',(IEAVRTOD,(NOLABEL))) */
*/********************************************************************/
*/*                                                                  */
*/* SET REGISTER 1 TO ADDRESS OF MIDNIGHT TQE, AND ENQUEUE THE TQE.  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0422
*   TQEPTR=REG15;                                                  0422
         LR    TQEPTR,REG15                                        0422
*   REG15=ADDR(ENQTQE);                                            0423
         L     REG15,CVTQTE00(,LCVTPTR)                            0423
*   GENERATE CODE REFS(REG15) SETS(REG2)(BALR  REG2,REG15);        0424
         BALR  REG2,REG15
*   LCVTPTR=CVTPTR;                 /* RE-ESTABLISH ADDRESSABILITY TO
*                                      THE CVT                       */
         L     LCVTPTR,CVTPTR                                      0425
*/********************************************************************/
*/*                                                                  */
*/* GET THE ADDRESS OF THE JOBSTEP TIMING TQE, AND THEN TEST TO SEE  */
*/* IF THIS IS EITHER A MULTIPROCESSOR OR HALF DUPLEX CONFIGURATION. */
*/* IF SO, SIGNAL THE CPU REPRESENTED BY THE FIRST TCWA ENTRY TO     */
*/* STORE ITS CLOCK INTO THE JOB STEP TIMING TQE.  (NOTE: THE CPU    */
*/* REPRESENTED BY THE FIRST TCWA ENTRY IS SIGNALLED BECAUSE IF THE  */
*/* THE ENTRY WAS FROM IEAVRSSC, THAT ENTRY REPRESENTS THE ONLY      */
*/* VALID CLOCK IN THE SYSTEM.)                                      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0426
*   TQEPTR=ADDR(TPCLMTQE);                                         0426
         L     TQEPTR,TPCPTR(,LCVTPTR)                             0426
         LA    TQEPTR,TPCLMTQE(,TQEPTR)                            0426
*   IF CSDMP='1'B THEN                                             0427
         L     @07,CVTCSD(,LCVTPTR)                                0427
         TM    CSDMP(@07),B'10000000'                              0427
         BNO   @RF00427                                            0427
*     DO;                           /* IF NOT STRICTLY A           0428
*                                      UNIPROCESSOR,                 */
*       REG11=ADDR(TQEVAL);         /* POINT PARMREG TO TQEVAL OF JST
*                                      TQE                           */
         LA    REG11,TQEVAL(,TQEPTR)                               0429
*       REG12=ADDR(DELTA3);         /* GET ADDR OF ROUTINE TO STCK   */
         LA    REG12,DELTA3                                        0430
*       REG1=PTREBEG->TCWAPCCA;     /* GET PCCA ADDR OF CPU TO SIGNAL*/
         L     @07,PTREBEG                                         0431
         L     REG1,TCWAPCCA(,@07)                                 0431
*       GENERATE CODE REFS(CVTIPCRI,CVT)                           0432
*           (RISGNL SERIAL,CPU=(1),EP=(12),PARM=(11));             0432
         RISGNL SERIAL,CPU=(1),EP=(12),PARM=(11)
*       TQEPTR=ADDR(TPCLMTQE);      /* RESTORE TQE POINTER           */
         L     TQEPTR,TPCPTR(,LCVTPTR)                             0433
         LA    TQEPTR,TPCLMTQE(,TQEPTR)                            0433
*     END;                                                         0434
*   ELSE                                                           0435
*                                                                  0435
*/********************************************************************/
*/*                                                                  */
*/* IF STRICTLY UNIPROCESSOR, STCK INTO JOB STEP TIMING TQE.         */
*/*                                                                  */
*/********************************************************************/
*                                                                  0435
*     DO;                                                          0435
         B     @RC00427                                            0435
@RF00427 DS    0H                                                  0436
*       GENERATE CODE REFS(TQEPTR) SETS(TQEVAL)(STCK  TQEVAL(TQEPTR));
         STCK  TQEVAL(TQEPTR)
*     END;                                                         0437
*                                                                  0437
*/********************************************************************/
*/*                                                                  */
*/* ADD 1 TO STORED VALUE  AND ENQUEUE THE TQE SO THAT JOB STEP      */
*/* TIMING TQE WILL START INTERRUPTING.                              */
*/*                                                                  */
*/********************************************************************/
*                                                                  0438
*   TQEVALLH=TQEVALLH+1;                                           0438
@RC00427 LA    @07,1                                               0438
         AL    @07,TQEVALLH(,TQEPTR)                               0438
         ST    @07,TQEVALLH(,TQEPTR)                               0438
*   REG15=ADDR(ENQTQE);                                            0439
         L     REG15,CVTQTE00(,LCVTPTR)                            0439
*   GENERATE CODE REFS(REG15) SETS(REG2)                           0440
*       (BALR  REG2,REG15     ENQUEUE THE JST TQE);                0440
         BALR  REG2,REG15     ENQUEUE THE JST TQE
*   LCVTPTR=CVTPTR;                 /* RE-ESTABLISH CVT            0441
*                                      ADDRESSABILITY                */
         L     LCVTPTR,CVTPTR                                      0441
*/********************************************************************/
*/*                                                                  */
*/* RELEASE THE DISPATCHER LOCK.                                     */
*/*                                                                  */
*/********************************************************************/
*                                                                  0442
*   GENERATE CODE REFS(PSALITA);                                   0442
*                                                                  0442
*                                  /*
         SETLOCK RELEASE,TYPE=DISP,                                   **
               RELATED=('REQUIRED BY TQE ENQ',(IEAVRTOD,(NOLABEL))) */
*/********************************************************************/
*/*                                                                  */
*/* GET THE ENTRY CODE, AND NOTIFY THE SRM THAT THE CLOCKS HAVE BEEN */
*/* BEEN INITIALIZED/CHANGED.                                        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0443
*   REG1=1;                                                        0443
         LA    REG1,1                                              0443
*   GENERATE CODE(SYSEVENT TIMEREXP);                              0444
*                                                                  0444
         SYSEVENT TIMEREXP
*/********************************************************************/
*/*                                                                  */
*/* RESTORE RETURN ADDRESS AND RETURN TO CALLER.                     */
*/*                                                                  */
*/********************************************************************/
*                                                                  0445
*   REG14=RETSAVE;                                                 0445
         L     REG14,RETSAVE                                       0445
*   END TQEINIT;                                                   0446
@EL00002 DS    0H                                                  0446
@EF00002 DS    0H                                                  0446
@ER00002 BR    @14                                                 0446
*   RESPECIFY                                                      0447
*    (LCVTPTR) UNRESTRICTED;                                       0447
*                                                                  0448
*/********************************************************************/
*/*                                                                  */
*/*        SSCESTAE--IEAVRSSC RECOVERY FOR UNLOCKED CODE             */
*/*                                                                  */
*/* THIS ROUTINE RECEIVES CONTROL WHEN AN ERROR OCCURS IN UNLOCKED   */
*/* TOD SET SPECIFIC CLOCK CODE, OR WHEN PERCOLATED TO FROM AN       */
*/* ERROR EXIT FOR CODE INVOKED BY TOD SET SPECIFIC CLOCK.  AFTER    */
*/* ESTABLISHING ADDRESSABILITY, IT DETERMINES WHO IT WAS CALLED     */
*/* BY, AND IF THE CALLER WAS IEEVCPU (FOR VARYING A CPU ONLINE) IT  */
*/* SETS INDICATORS THAT WILL RELEASE THE CPU BEING VARY'ED ONLINE   */
*/* FROM THE LOOP IT IS SPINNING IN, AND TERMINATE THE VARY PROCESS. */
*/*                                                                  */
*/********************************************************************/
*                                                                  0448
*SSCESTAE:                                                         0448
*   PROC OPTIONS(NOSAVE,NOSAVEAREA,NOENTREG,RETREG);               0448
SSCESTAE DS    0H                                                  0449
*   RESPECIFY                                                      0449
*    (REG2) RESTRICTED;                                            0449
*   RESPECIFY                                                      0450
*     CVTMAP BASED(CVTPTR);                                        0450
*                                                                  0450
*/********************************************************************/
*/*                                                                  */
*/* ESTABLISH TEMPORARY ADDRESSABILITY.                              */
*/*                                                                  */
*/********************************************************************/
*                                                                  0451
*   GEN CODE SETS(REG12) REFS(REG8,REG9,REG10);                    0451
*                                                                  0451
         BALR  REG12,0
         USING *,REG12
         DROP  REG8,REG9,REG10
*/********************************************************************/
*/*                                                                  */
*/* SEE IF AN SDWA IS SUPPLIED.                                      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0452
*   IF REG0^=12 THEN                                               0452
*                                                                  0452
         CH    REG0,@CH01265                                       0452
         BE    @RF00452                                            0452
*/********************************************************************/
*/*                                                                  */
*/* IF SO, PUT POINTER TO PARAMETER AREA INTO REG 2.  (NOTE: IF NOT, */
*/* THE POINTER IS ALREADY IN REG 2.)  ISSUE SETRP TO ESTABLISH      */
*/* INTERFACE BACK TO RTM.                                           */
*/*                                                                  */
*/********************************************************************/
*                                                                  0453
*     DO;                                                          0453
*       REG2=SDWAPARM;                                             0454
         L     REG2,SDWAPARM(,SDWAPTR)                             0454
*       DO;                         /* SETRP RECPARM(SSCID)RC(4)FRESD
*                                      WA(YES)RETADDR(RETRYSSC)DUMP(N
*                                      O)                            */
*         RESPECIFY                                                0456
*          (GPR00P,                                                0456
*           GPR01P,                                                0456
*           GPR14P,                                                0456
*           GPR15P) RSTD;                                          0456
*         GPR01P->SDWARCDE=4;       /* STORE RC INTO SDWA            */
         MVI   SDWARCDE(GPR01P),X'04'                              0457
*         GPR01P->SDWARTYA=ADDR(RETRYSSC);/* SAVE RETRY ADDRESS      */
         MVC   SDWARTYA(4,GPR01P),SSCRTYA                          0458
*         GPR01P->SDWAFREE='1'B;    /* SET FLAG TO FREE SDWA         */
         OI    SDWAFREE(GPR01P),B'00000100'                        0459
*         GPR15P=ADDR(SSCID);       /* ACCESS RECORD PARAMETER LIST  */
         LA    GPR15P,SSCID                                        0460
*         GPR01P->SDWARECP=GPR15P->I256C(1:24);/* COPY RECORD      0461
*                                      PARAMETERS                    */
         MVC   SDWARECP(24,GPR01P),I256C(GPR15P)                   0461
*         GPR01P->SDWAREQ='0'B;     /* TURN OFF DUMP INDICATOR       */
         NI    SDWAREQ(GPR01P),B'01111111'                         0462
*         RESPECIFY                                                0463
*          (GPR00P,                                                0463
*           GPR01P,                                                0463
*           GPR14P,                                                0463
*           GPR15P) UNRSTD;                                        0463
*       END;                                                       0464
*     END;                                                         0465
*                                                                  0465
*/********************************************************************/
*/*                                                                  */
*/* IF NOT, PUT RETRY ADDRESS IN REG 0, AND SET REG 15 TO 4 TO       */
*/* INDICATE RETRY.                                                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0466
*   ELSE                                                           0466
*     DO;                                                          0466
         B     @RC00452                                            0466
@RF00452 DS    0H                                                  0467
*       REG0=SSCRTYA;                                              0467
         L     REG0,SSCRTYA                                        0467
*       RETCODE=4;                                                 0468
         LA    RETCODE,4                                           0468
*     END;                                                         0469
*                                                                  0469
*/********************************************************************/
*/*                                                                  */
*/* ESTABLISH PERMANENT ADDRESSABILITY TO DATA BY RESTORING DATA     */
*/* REGISTER SAVED BY IEAVRSSC.                                      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0470
*   GEN CODE REFS(@DATD) SETS(REG8);                               0470
*                                                                  0470
@RC00452 DS    0H                                                  0470
         L     REG8,0(REG2)
         USING @DATD,REG8
*/********************************************************************/
*/*                                                                  */
*/* SET RETURN CODE TO NON-ZERO TO INDICATE FAILURE.                 */
*/*                                                                  */
*/********************************************************************/
*                                                                  0471
*   RCSAVE=16;                                                     0471
*                                                                  0471
         MVC   RCSAVE(4),@CF00045                                  0471
*/********************************************************************/
*/*                                                                  */
*/* RETURN TO RTM.                                                   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0472
*   END SSCESTAE;                                                  0472
@EL00003 DS    0H                                                  0472
@EF00003 DS    0H                                                  0472
@ER00003 BR    @14                                                 0472
*   RESPECIFY                                                      0473
*    (REG2) UNRESTRICTED;                                          0473
*   GENERATE CODE REFS(REG9,REG10,REG12,@PSTART);                  0474
         USING @PSTART,REG9
         USING @PSTART+4095,REG10
         DROP  REG12
*                                                                  0475
*/********************************************************************/
*/*                                                                  */
*/*          IEAVRTST--TOD CLOCK STATUS TESTING ROUTINE              */
*/*                                                                  */
*/* THIS ROUTINE RECEIVES CONTROL FROM ROUTINES IEAVRINT AND         */
*/* IEAVRSSC, AND IS PASSED A LIST OF CPU'S WHOSE CLOCK STATUS IS TO */
*/* BE TESTED.  ALL OTHER CLOCKS ARE TESTED FOR SYNCHRONISM AGAINST  */
*/* THE FIRST CLOCK IN THE LIST.  (NOTE: IF THERE IS ONLY ONE CLOCK  */
*/* IN THE LIST, IT IS ONLY TESTED TO SEE IF IT IS SET.)  BEFORE RE- */
*/* TURNING, A CODE IS SET IN REGISTER 15 TO INDICATE THE RESULTS OF */
*/* THE TEST.  THE RETURN CODES ARE DEFINED AS FOLLOWS:              */
*/*                                                                  */
*/*          0   ALL CLOCKS SET AND IN SYNCHRONISM, OR THE ONLY      */
*/*              CLOCK IS SET                                        */
*/*          4   FIRST OR ONLY CLOCK IN LIST NOT SET, OR SIGP TO     */
*/*              IT'S CPU FAILED                                     */
*/*          8   CLOCKS OUT OF LOW ORDER SYNCHHRONISM                */
*/*         12   CLOCKS OUT OF HIGH ORDER SYNCHRONISM                */
*/*         16   TRIED 5 TIMES BUT COULD NOT COMPLETE TESTING        */
*/*              PROCEDURE IN ALLOTTED TIME, STATUS UNKNOWN          */
*/*         20   SIGP FAILED TRYING TO SIGNAL SOME CPU OTHER THAN    */
*/*              THE FIRST IN THE LIST                               */
*/*                                                                  */
*/********************************************************************/
*                                                                  0475
*IEAVRTST:                                                         0475
*   PROCEDURE OPTIONS(NOSAVEAREA,NOSAVE(15));                      0475
*                                                                  0475
         B     @PB00004                                            0475
IEAVRTST ST    @14,12(,@13)                                        0475
         STM   @00,@12,20(@13)                                     0475
*/********************************************************************/
*/*                                                                  */
*/* SET THE RETURN CODE TO 16 SO THAT THE LOOP WILL BE EXECUTED AT   */
*/* LEAST ONCE, AND THEN PERFORM THE LOOP A MAXIMUM OF 5 TIMES.      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0476
*   RESPECIFY                                                      0476
*     CVTMAP BASED(CVTPTR);                                        0476
*   RETCODE=16;                                                    0477
         LA    RETCODE,16                                          0477
*   DO LOOPCTR=5 TO 1 BY-1 WHILE RETCODE=16;                       0478
         LA    @02,5                                               0478
         ST    @02,LOOPCTR                                         0478
@DL00478 CH    RETCODE,@CH00045                                    0478
         BNE   @DC00478                                            0478
*     REG11=PTREBEG;                /* GET PTR TO FIRST TCWA ENTRY 0479
*                                                            @YM01705*/
         L     @02,PTREBEG                                         0479
         LR    REG11,@02                                           0479
*/********************************************************************/
*/*                                                                  */
*/* TEST FOR STRICTLY UNI-PROCESSOR CONFIGURATION.  IF SO, INVOKE    */
*/* ROUTINE TO STORE TOD CLOCK VIA BRANCH AND LINK.  IF NOT, INVOKE  */
*/* THE ROUITNE VIA THE IPC.                                         */
*/*                                                                  */
*/********************************************************************/
*                                                                  0480
*     IF CSDMP='0'B THEN                                           0480
         L     @07,CVTPTR                                          0480
         L     @07,CVTCSD(,@07)                                    0480
         TM    CSDMP(@07),B'10000000'                              0480
         BNZ   @RF00480                                            0480
*       DO;                                                        0481
*         REG15=ADDR(DELTA1);       /* GET ENTRY POINT ADDRESS       */
         LA    REG15,DELTA1                                        0482
*         REG1=PTREBEG;             /* GET ADDRESS OF FIRST TCWA   0483
*                                      ENTRY                         */
         LR    REG1,@02                                            0483
*         GENERATE CODE REFS(REG15) SETS(REG14)(BALR  REG14,REG15);/*
*                                      BALR TO ROUTINE               */
         BALR  REG14,REG15
*       END;                                                       0485
*     ELSE                                                         0486
*                                                                  0486
*/********************************************************************/
*/*                                                                  */
*/* SET UP THE IPC INTERFACE AND THEN SIGNAL THE CPU REPRESENTED BY  */
*/* THE FIRST TOD CLOCK WORKAREA ENTRY TO STORE ITS CLOCK            */
*/* AND THE CONDITION CODE RESULTING FROM THE STCK INSTRUCTION INTO  */
*/* ITS WORKAREA ENTRY.  (NOTE: BEFORE ACTUALLY INVOKING IPC, THE    */
*/* CONDITION CODE BITS IN THE ENTRY ARE SET TO NON-ZERO, SO THAT A  */
*/* FAILURE TO GET THROUGH TO THE OTHER CPU WILL BE TREATED AS IF THE*/
*/* CLOCK WAS NOT SET.)                                              */
*/*                                                                  */
*/********************************************************************/
*                                                                  0486
*       DO;                                                        0486
         B     @RC00480                                            0486
@RF00480 DS    0H                                                  0487
*         TCLCC='11'B;              /* DEFAULT COND CODE TO NON-ZERO */
         OI    TCLCC(REG11),B'00110000'                            0487
*         REG1=TCWAPCCA;            /* GET PCCA POINTER              */
         L     REG1,TCWAPCCA(,REG11)                               0488
*         REG12=ADDR(DELTA1);       /* GET ROUTINE ADDRESS           */
         LA    REG12,DELTA1                                        0489
*         GENERATE CODE REFS(CVTIPCRI,CVT)                         0490
*             (RISGNL SERIAL,CPU=(1),EP=(12),PARM=(11));           0490
         RISGNL SERIAL,CPU=(1),EP=(12),PARM=(11)
*       END;                                                       0491
*                                                                  0491
*/********************************************************************/
*/*                                                                  */
*/* TEST THE RESULTING CONDITION CODE FOR 0, INDICATING THE CLOCK IS */
*/* SET.                                                             */
*/********************************************************************/
*                                                                  0492
*     IF TCLCC='00'B THEN                                          0492
*                                                                  0492
@RC00480 TM    TCLCC(REG11),B'00110000'                            0492
         BNZ   @RF00492                                            0492
*/********************************************************************/
*/*                                                                  */
*/* IF THE CLOCK IS SET, THEN SEE IF THERE IS ONLY ONE CPU IN THE    */
*/* CONFIGURATION.                                                   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0493
*       DO;                                                        0493
*         IF TCCPUCNT=1 THEN                                       0494
*                                                                  0494
         CLC   TCCPUCNT(2,TCWAPTR),@CH00096                        0494
         BNE   @RF00494                                            0494
*/********************************************************************/
*/*                                                                  */
*/* IF THERE IS ONLY ONE CPU, SET THE RETURN CODE TO 0 TO INDICATE   */
*/* THAT ITS CLOCK IS SET.                                           */
*/*                                                                  */
*/********************************************************************/
*                                                                  0495
*           RETCODE=0;                                             0495
         SLR   RETCODE,RETCODE                                     0495
*         ELSE                                                     0496
*                                                                  0496
*/********************************************************************/
*/*                                                                  */
*/* IF THERE IS MORE THAN ONE CPU, SET UP THE IPC INTERFACE, AND     */
*/* SIGNAL THE CPU WITH THE SET CLOCK TO PERFORM A ROUTINE WHICH WHEN*/
*/* DONE TWICE WILL CAUSE A DELAY OF A MINIMUM OF 1 SECOND.  THIS IS */
*/* TO SATISFY THE REQUIREMENT OF THE SYNC CHECK DEFINITION.  (NOTE: */
*/* THE LAST VALUE STORED BY THIS ROUTINE WILL BE USED TO BEGIN      */
*/* TIMING A 2**20 MICROSECOND INTERVAL.)                            */
*/*                                                                  */
*/********************************************************************/
*                                                                  0496
*           DO;                                                    0496
         B     @RC00494                                            0496
@RF00494 DS    0H                                                  0497
*             REG12=ADDR(DELTA4);   /* GET ROUTINE ADDRESS           */
         LA    REG12,DELTA4                                        0497
*             REG11=ADDR(TCWA);     /* GET PARAMETER ADDRESS         */
         LR    REG11,TCWAPTR                                       0498
*             RESPECIFY                                            0499
*              (REG2) RESTRICTED;                                  0499
*             DO REG2=2 TO 1 BY-1;                                 0500
         LA    REG2,2                                              0500
@DL00500 DS    0H                                                  0501
*               REG1=PTREBEG->TCWAPCCA;/* GET PCCA PTR FROM FIRST  0501
*                                      TCWA ENTRY                    */
         L     @07,PTREBEG                                         0501
         L     REG1,TCWAPCCA(,@07)                                 0501
*               GENERATE CODE REFS(CVTIPCRI,CVT)                   0502
*                   (RISGNL SERIAL,CPU=(1),EP=(12),PARM=(11));     0502
         RISGNL SERIAL,CPU=(1),EP=(12),PARM=(11)
*             END;                                                 0503
         BCTR  REG2,0                                              0503
         LTR   REG2,REG2                                           0503
         BP    @DL00500                                            0503
*             RESPECIFY                                            0504
*              (REG2) UNRESTRICTED;                                0504
*                                                                  0504
*/********************************************************************/
*/*                                                                  */
*/* BEGINNING WITH THE LAST TOD CLOCK WORKAREA ENTRY, USE THE IPC TO */
*/* SIGNAL EACH CPU TO STORE ITS TOD CLOCK AND THE RESULTING CONDI-  */
*/* TION CODE, AND TO TURN OFF THE SYNC CHECK INDICATOR IN ITS PCCA. */
*/*                                                                  */
*/* (NOTE1: BEFORE ACTUALLY INVOKING IPC, THE CONDITION CODE BITS IN */
*/* THE ENTRY ARE SET TO NON-ZERO, SO THAT A FAILURE TO GET THROUGH  */
*/* TO THE OTHER CPU WILL BE TREATED AS IF THE CLOCK WAS NOT SET.)   */
*/*                                                                  */
*/* (NOTE2: THE SUBJECT CPU STORES ITS CLOCK LAST.  THIS IS THE      */
*/* ENDING VALUE FOR THE 2**20 MICROSECOND INTERVAL.)                */
*/*                                                                  */
*/********************************************************************/
*                                                                  0505
*             REG11=PTREBEG+(TCCPUCNT-1)*LENGTH(TCENTRY);/* GET PTR
*                                      TO LAST TCWA ENTRY            */
         LH    @02,TCCPUCNT(,TCWAPTR)                              0505
         LR    REG11,@02                                           0505
         BCTR  REG11,0                                             0505
         SLA   REG11,4                                             0505
         AL    REG11,PTREBEG                                       0505
*             REG12=ADDR(DELTA1);   /* GET ROUTINE ADDRESS           */
         LA    REG12,DELTA1                                        0506
*             RESPECIFY                                            0507
*              (REG2) RESTRICTED;                                  0507
*             DO REG2=TCCPUCNT TO 1 BY-1;                          0508
         LH    @07,TCCPUCNT(,TCWAPTR)                              0508
         LR    REG2,@07                                            0508
         B     @DE00508                                            0508
@DL00508 DS    0H                                                  0509
*               TCLCC='11'B;        /* DEFAULT STCK CC TO NON-ZERO   */
         OI    TCLCC(REG11),B'00110000'                            0509
*               REG1=TCWAPCCA;      /* GET ADDRESS PCCA              */
         L     REG1,TCWAPCCA(,REG11)                               0510
*               GENERATE CODE REFS(CVTIPCRI,CVT)                   0511
*                   (RISGNL SERIAL,CPU=(1),EP=(12),PARM=(11));     0511
         RISGNL SERIAL,CPU=(1),EP=(12),PARM=(11)
*               REG11=REG11-LENGTH(TCENTRY);/* POINT TO NEXT TCWA  0512
*                                      ENTRY                         */
         SL    REG11,@CF00045                                      0512
*               IF RETCODE^=0 THEN  /* DID SIGP FAIL?        @ZA15781*/
         LTR   RETCODE,RETCODE                                     0513
         BZ    @RF00513                                            0513
*                 DO;               /* YES                   @ZA15781*/
*                   IF REG2=1 THEN  /* SUBJECT CPU?          @ZA15781*/
         CH    REG2,@CH00096                                       0515
         BNE   @RF00515                                            0515
*                     RETCODE=4;    /* IEAVRTST R. C. = 4    @ZA15781*/
         LA    RETCODE,4                                           0516
*                   ELSE            /* SOME OTHER CPU        @ZA15781*/
*                     DO;           /*                       @ZA15781*/
         B     @RC00515                                            0517
@RF00515 DS    0H                                                  0518
*                       RETCODE=20; /* IEAVRTST R. C. = 20   @ZA15781*/
         LA    RETCODE,20                                          0518
*                       REG2=1;     /* FORCE LOOP EXIT       @ZA15781*/
         LA    REG2,1                                              0519
*                     END;          /*                       @ZA15781*/
*                 END;              /* END SIGP FAILED       @ZA15781*/
*               ELSE                /* SIGP DID NOT FAIL     @ZA15781*/
*                 RETCODE=16;       /* IEAVRTST R. C. = 16   @ZA15781*/
         B     @RC00513                                            0522
@RF00513 LA    RETCODE,16                                          0522
*             END;                                                 0523
@RC00513 BCTR  REG2,0                                              0523
@DE00508 LTR   REG2,REG2                                           0523
         BP    @DL00508                                            0523
*             RESPECIFY                                            0524
*              (REG2) UNRESTRICTED;                                0524
*           END;                                                   0525
*       END;                                                       0526
*     ELSE                                                         0527
*                                                                  0527
*/********************************************************************/
*/*                                                                  */
*/* IF THE SUBJECT CLOCK WAS NOT SET, SET THE RETURN CODE TO 4.      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0527
*       RETCODE=4;                                                 0527
*                                                                  0527
         B     @RC00492                                            0527
@RF00492 LA    RETCODE,4                                           0527
*/********************************************************************/
*/*                                                                  */
*/* SEE IF THE RETURN CODE IS 16, ITS INITIAL VALUE.                 */
*/*                                                                  */
*/********************************************************************/
*                                                                  0528
*     IF RETCODE=16 THEN                                           0528
*                                                                  0528
@RC00492 CH    RETCODE,@CH00045                                    0528
         BNE   @RF00528                                            0528
*/********************************************************************/
*/*                                                                  */
*/* IF IT IS 16, SEE IF ALL CLOCKS WERE STORED WITHIN 2**20          */
*/* MICROSECONDS.  (NOTE: IF THEY WERE, THE HIGH ORDER 32 BITS OF THE*/
*/* BEGINNING AND ENDING VALUES WILL BE EQUAL.)                      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0529
*       DO;                                                        0529
*         IF PTREBEG->TCWACLKL=TCWAA2L THEN                        0530
*                                                                  0530
         L     @02,PTREBEG                                         0530
         CLC   TCWACLKL(4,@02),TCWAA2L(TCWAPTR)                    0530
         BNE   @RF00530                                            0530
*/********************************************************************/
*/*                                                                  */
*/* IF SO, ENABLE FOR SYNC CHECKS.  (NOTE: IF A SYNC CHECK OCCURS,   */
*/* THE TIMER SLIH WILL FIELD THE INTERRUPT, AND THEN DISABLE        */
*/* FURTHER SYNC CHECKS.)                                            */
*/*                                                                  */
*/********************************************************************/
*                                                                  0531
*           DO;                                                    0531
*             GENERATE CODE REFS(TCWAPTR) SETS(TCWACTL)            0532
*                 (STCTL 0,0,TCWACTL(TCWAPTR)  SAVE CONTROL REG 0);
         STCTL 0,0,TCWACTL(TCWAPTR)  SAVE CONTROL REG 0
*             TCSYNCK='1'B;         /* TURN ON SYNC CK BIT IN CTL REG
*                                      0                             */
         OI    TCSYNCK(TCWAPTR),B'00010000'                        0533
*             GENERATE CODE REFS(TCWAPTR,TCWACTL)                  0534
*                 (LCTL  0,0,TCWACTL(TCWAPTR)  ENABLE SYNC CHECKS);
         LCTL  0,0,TCWACTL(TCWAPTR)  ENABLE SYNC CHECKS
*                                                                  0535
*/********************************************************************/
*/*                                                                  */
*/* IF THE TPCSYNC FLAG IS NOT ON, NO SYNC CHECK OCCURRED, AND       */
*/* SYNC CHECK INTERRUPTS ARE STILL ENABLED, SO DISABLE THEM.        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0535
*             IF TPCSYNC='0'B THEN                                 0535
         L     @02,CVTPTR                                          0535
         L     @02,TPCPTR(,@02)                                    0535
         TM    TPCSYNC(@02),B'01000000'                            0535
         BNZ   @RF00535                                            0535
*               DO;                                                0536
*                 GENERATE CODE REFS(TCWAPTR) SETS(TCWACTL)        0537
*                     (STCTL 0,0,TCWACTL(TCWAPTR)  SAVE CONTROL REG 0);
         STCTL 0,0,TCWACTL(TCWAPTR)  SAVE CONTROL REG 0
*                 TCSYNCK='0'B;     /* TURN OFF SYNC CK BIT IN CTL 0538
*                                      REG 0                         */
         NI    TCSYNCK(TCWAPTR),B'11101111'                        0538
*                 GENERATE CODE REFS(TCWAPTR,TCWACTL)              0539
*                     (LCTL  0,0,TCWACTL(TCWAPTR)  DISABLE SYNC CHECKS)
*                     ;                                            0539
         LCTL  0,0,TCWACTL(TCWAPTR)  DISABLE SYNC CHECKS
*               END;                                               0540
*             ELSE                                                 0541
*                                                                  0541
*/********************************************************************/
*/*                                                                  */
*/* IF THE TPCSYNC FLAG IS ON INDICATING THAT A SYNC CHECK OCCURRED. */
*/* SET THE RETURN CODE TO 8 TO INDICATE AN OUT OF LOW ORDER SYNC    */
*/* CONDITION, AND THEN SET THE PCCASYNC FLAG FOR                    */
*/* ALL OTHER CPU'S (EXCEPTING THE SUBJECT) TO INDICATE              */
*/* THAT THEIR CLOCKS ARE OUT OF SYNC. (NOTE: THE PCCASYNC FLAG NOW  */
*/* SERVES TO INDICATE WHICH CLOCKS REQUIRE SYNCHRONIZING.)          */
*/*                                                                  */
*/********************************************************************/
*                                                                  0541
*               DO;                                                0541
         B     @RC00535                                            0541
@RF00535 DS    0H                                                  0542
*                 REG11=PTREBEG+LENGTH(TCENTRY);/* POINT TO 2ND TCWA
*                                      ENTRY                         */
         LA    REG11,16                                            0542
         AL    REG11,PTREBEG                                       0542
*                 RETCODE=8;        /* SET RETURN CODE TO 8          */
         LA    RETCODE,8                                           0543
*                 TPCSYNC='0'B;     /* TURN OFF SYNC CK INDICATOR IN
*                                      TPC                           */
         L     @02,CVTPTR                                          0544
         L     @02,TPCPTR(,@02)                                    0544
         NI    TPCSYNC(@02),B'10111111'                            0544
*                 RESPECIFY                                        0545
*                  (REG2) RESTRICTED;                              0545
*                 DO REG2=TCCPUCNT-1 TO 1 BY-1;                    0546
         LH    REG2,TCCPUCNT(,TCWAPTR)                             0546
         BCTR  REG2,0                                              0546
         B     @DE00546                                            0546
@DL00546 DS    0H                                                  0547
*                   TCWAPCCA->PCCASYNC='1'B;                       0547
         L     @07,TCWAPCCA(,REG11)                                0547
         OI    PCCASYNC(@07),B'01000000'                           0547
*                   REG11=REG11+LENGTH(TCENTRY);/* POINT TO NEXT TCWA
*                                      ENTRY                         */
         AL    REG11,@CF00045                                      0548
*                 END;                                             0549
         BCTR  REG2,0                                              0549
@DE00546 LTR   REG2,REG2                                           0549
         BP    @DL00546                                            0549
*                 RESPECIFY                                        0550
*                  (REG2) UNRESTRICTED;                            0550
*               END;                                               0551
*             RESPECIFY                                            0552
*               TPC BASED(TPCPTR);                                 0552
*                                                                  0552
@RC00535 DS    0H                                                  0553
*/********************************************************************/
*/*                                                                  */
*/* SEE IF THE RETURN CODE IS STILL SET TO 16.                       */
*/*                                                                  */
*/********************************************************************/
*                                                                  0553
*             IF RETCODE=16 THEN                                   0553
*                                                                  0553
         LA    @02,16                                              0553
         CR    RETCODE,@02                                         0553
         BNE   @RF00553                                            0553
*/********************************************************************/
*/*                                                                  */
*/* IF IT IS, THERE IS MORE THAN ONE CPU IN THE CONFIGURATION, THE   */
*/* CLOCKS WERE STORED WITHIN 2**20 MICROSECONDS, AND THEY ARE IN LOW*/
*/* ORDER SYNCHRONISM.  NOW, CHECK TO SEE IF ALL CLOCKS ARE SET      */
*/* AND IN HIGH ORDER SYNCHRONISM.                                   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0554
*               DO;                                                0554
*                 REG11=PTREBEG+LENGTH(TCENTRY);                   0555
         AL    @02,PTREBEG                                         0555
         LR    REG11,@02                                           0555
*                 RESPECIFY                                        0556
*                  (REG2) RESTRICTED;                              0556
*                 DO REG2=TCCPUCNT-1 TO 1 BY-1;                    0557
*                                                                  0557
         LH    REG2,TCCPUCNT(,TCWAPTR)                             0557
         BCTR  REG2,0                                              0557
         B     @DE00557                                            0557
@DL00557 DS    0H                                                  0558
*/********************************************************************/
*/*                                                                  */
*/* SEE IF THE CLOCK FOR THE ENTRY IS SET, AND IF ITS VALUE FALLS    */
*/* BETWEEN THE SUBJECT'S BEGINNING AND ENDING VALUES.               */
*/*                                                                  */
*/********************************************************************/
*                                                                  0558
*                   IF TCLCC^='00'B×TCWACLKL^=TCWAA2L×TCWACLKR<=TCWAA2R
*                       ×TCWACLKR>=PTREBEG->TCWACLKR THEN          0558
*                                                                  0558
         TM    TCLCC(REG11),B'00110000'                            0558
         BNZ   @RT00558                                            0558
         CLC   TCWACLKL(4,REG11),TCWAA2L(TCWAPTR)                  0558
         BNE   @RT00558                                            0558
         L     @07,TCWACLKR(,REG11)                                0558
         CL    @07,TCWAA2R(,TCWAPTR)                               0558
         BNH   @RT00558                                            0558
         L     @06,PTREBEG                                         0558
         CL    @07,TCWACLKR(,@06)                                  0558
         BL    @RF00558                                            0558
@RT00558 DS    0H                                                  0559
*/********************************************************************/
*/*                                                                  */
*/* FOR EVERY ONE THAT DOES NOT MEET THESE CRITERIA, SET THE OUT OF  */
*/* SYNC INDICATOR IN ITS PCCA, AND SET THE RETURN CODE TO 12        */
*/* INDICATING AN OUT OF HIGH ORDER SYNC CONDITION.                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0559
*                     DO;                                          0559
*                       TCWAPCCA->PCCASYNC='1'B;                   0560
         L     @07,TCWAPCCA(,REG11)                                0560
         OI    PCCASYNC(@07),B'01000000'                           0560
*                       RETCODE=12;                                0561
         LA    RETCODE,12                                          0561
*                     END;                                         0562
*                   REG11=REG11+LENGTH(TCENTRY);/* POINT TO NEXT TCWA
*                                      ENTRY                         */
@RF00558 AL    REG11,@CF00045                                      0563
*                 END;                                             0564
         BCTR  REG2,0                                              0564
@DE00557 LTR   REG2,REG2                                           0564
         BP    @DL00557                                            0564
*                 RESPECIFY                                        0565
*                  (REG2) UNRESTRICTED;                            0565
*                                                                  0565
*/********************************************************************/
*/*                                                                  */
*/* AGAIN, SEE IF THE RETURN CODE IS STILL 16.                       */
*/*                                                                  */
*/********************************************************************/
*                                                                  0566
*                 IF RETCODE=16 THEN                               0566
*                                                                  0566
         CH    RETCODE,@CH00045                                    0566
         BNE   @RF00566                                            0566
*/********************************************************************/
*/*                                                                  */
*/* IF IT STILL IS, ALL CLOCKS ARE SET AND IN SYNCHRONISM, SO SET    */
*/* THE RETURN CODE TO 0 TO INDICATE THIS FACT TO THE CALLER.        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0567
*                   RETCODE=0;                                     0567
         SLR   RETCODE,RETCODE                                     0567
*               END;                                               0568
@RF00566 DS    0H                                                  0569
*           END;                                                   0569
@RF00553 DS    0H                                                  0570
*       END;                                                       0570
@RF00530 DS    0H                                                  0571
*   END;                                                           0571
*                                                                  0571
@RF00528 SLR   @02,@02                                             0571
         BCTR  @02,0                                               0571
         AL    @02,LOOPCTR                                         0571
         ST    @02,LOOPCTR                                         0571
         LTR   @02,@02                                             0571
         BP    @DL00478                                            0571
@DC00478 DS    0H                                                  0572
*/********************************************************************/
*/*                                                                  */
*/* RETURN TO THE CALLER.                                            */
*/*                                                                  */
*/********************************************************************/
*                                                                  0572
*   END IEAVRTST;                                                  0572
@EL00004 DS    0H                                                  0572
@EF00004 DS    0H                                                  0572
@ER00004 L     @14,12(,@13)                                        0572
         LM    @00,@12,20(@13)                                     0572
         BR    @14                                                 0572
*                                                                  0573
*/********************************************************************/
*/*                                                                  */
*/*            IEAVRCOM--OPERATOR COMMUNICATIONS ROUTINE             */
*/*                                                                  */
*/* THIS ROUTINE RECEIVES CONTROL FROM ROUTINES IEAVRINT AND         */
*/* IEAVRSSC.  IT TESTS FLAGS IN THE TOD CLOCK WORKAREA TO DETERMINE */
*/* WHICH MESSAGE TO ISSUE, AND THEN ISSUES THE MESSAGE.  (NOTE: IF  */
*/* THE INSTALLATION HAS CHOSEN THE IMPROVED IPL OPTION, AND ALL     */
*/* CLOCKS ARE SET AND IN SYNCHRONISM, NO MESSAGES ARE ISSUED.)  IT  */
*/* THEN ACCEPTS THE OPERATOR'S REPLY AND ISSUES AN INTERNAL SET     */
*/* COMMAND TO PROCESS THE REPLY.  IF THE REPLY IS NOT SUCCESSFULLY  */
*/* PROCESSED, THE MESSAGE IS REPEATED.  OTHERWISE, THE NEXT MESSAGE */
*/* IS ISSUED, IF REQUIRED, AND ULTIMATELY, RETURN IS MADE TO THE    */
*/* CALLER.                                                          */
*/*                                                                  */
*/********************************************************************/
*                                                                  0573
*IEAVRCOM:                                                         0573
*   PROCEDURE OPTIONS(NOSAVEAREA);                                 0573
*                                                                  0573
IEAVRCOM STM   @14,@12,12(@13)                                     0573
*/********************************************************************/
*/*                                                                  */
*/* SET UP THE COMMAND LENGTH AND NAME FOR THE INTERNAL SET COMMAND. */
*/*                                                                  */
*/********************************************************************/
*                                                                  0574
*   RESPECIFY                                                      0574
*    (LCVTPTR) RESTRICTED;                                         0574
*   RESPECIFY                                                      0575
*     CVTMAP BASED(LCVTPTR);                                       0575
*   TCWARLEN=LENGTH(TCWARPLY);      /* LENGTH TO TCWA                */
         MVC   TCWARLEN(2,TCWAPTR),@CH00707                        0576
*   TCWASET=CHARSET;                /* NAME TO TCWA                  */
         MVC   TCWASET(4,TCWAPTR),CHARSET                          0577
*/********************************************************************/
*/*                                                                  */
*/* TURN ON THE TOD CLOCK NOT SET INDICATOR SO THAT THE LOOP WILL BE */
*/* EXECUTED AT LEAST ONCE.                                          */
*/*                                                                  */
*/********************************************************************/
*                                                                  0578
*   TCGNSET='1'B;                                                  0578
*                                                                  0578
         OI    TCGNSET(TCWAPTR),B'00001000'                        0578
*/********************************************************************/
*/*                                                                  */
*/* SEE IF MESSAGE IEA886A SHOULD BE ISSUED.                         */
*/*                                                                  */
*/********************************************************************/
*                                                                  0579
*   IF TCGYYY='1'B THEN                                            0579
*                                                                  0579
         TM    TCGYYY(TCWAPTR),B'01000000'                         0579
         BNO   @RF00579                                            0579
*/********************************************************************/
*/*                                                                  */
*/* IF SO, SET UP THE PARAMETER LIST FOR THE MESSAGE.                */
*/*                                                                  */
*/********************************************************************/
*                                                                  0580
*     DO;                                                          0580
*       WPLPTR=ADDR(MSGYYY);        /* ADDRESSABILITY FOR PARMLIST   */
         LA    WPLPTR,MSGYYY                                       0581
*       WPLRPTRA=ADDR(TCWATXT);     /* REPLY ADDRESS TO PARMLIST     */
         LA    @07,TCWATXT(,TCWAPTR)                               0582
         STCM  @07,7,WPLRPTRA(WPLPTR)                              0582
*       WPLRECB=ADDR(TODECB);       /* ECB ADDRESS TO PARMLIST       */
         LA    @07,TODECB                                          0583
         ST    @07,WPLRECB(,WPLPTR)                                0583
*/********************************************************************/
*/*                                                                  */
*/* KEEP ISSUING THE MESSAGE UNTIL THE OPERATOR'S REPLY IS           */
*/* SYNTACTICALLY CORRECT (AS DETERMINED BY THE SET COMMAND PROCES-  */
*/* SOR--MODULE IEE0603D) AND A TOD CLOCK HAS BEEN SET.              */
*/*                                                                  */
*/********************************************************************/
*                                                                  0584
*       DO WHILE BAIPLCC^='00'X×TCGNSET='1'B;                      0584
         B     @DE00584                                            0584
@DL00584 DS    0H                                                  0585
*         TODECB=0;                 /* ZERO THE REPLY ECB            */
         SLR   @07,@07                                             0585
         ST    @07,TODECB                                          0585
*         TCWATXT='';               /* CLEAR THE REPLY AREA          */
         MVI   TCWATXT(TCWAPTR),C' '                               0586
         MVC   TCWATXT+1(39,TCWAPTR),TCWATXT(TCWAPTR)              0586
*         WPLPTR=ADDR(MSGYYY);                                     0587
         LA    WPLPTR,MSGYYY                                       0587
*         GENERATE CODE(WTOR  MF=(E,(1)));                         0588
*                                                                  0588
         WTOR  MF=(E,(1))
*/********************************************************************/
*/*                                                                  */
*/* WAIT FOR REPLY.                                                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0589
*         REG1=ADDR(TODECB);                                       0589
         LA    REG1,TODECB                                         0589
*         GENERATE CODE(WAIT  1,ECB=(1));                          0590
*                                                                  0590
         WAIT  1,ECB=(1)
*/********************************************************************/
*/*                                                                  */
*/* AFTER RECEIVING THE OPERATOR'S REPLY, INDICATE THAT THIS IS AN   */
*/* INTERNAL SET COMMAND AND ISSUE SVC 34 TO EXECUTE IT.             */
*/*                                                                  */
*/********************************************************************/
*                                                                  0591
*         BAIPLCC='00'X;            /* CLEAR ERROR BYTE IN BASEA     */
         L     @07,CVTMSER(,LCVTPTR)                               0591
         MVI   BAIPLCC(@07),X'00'                                  0591
*         REG0=0;                                                  0592
         SLR   REG0,REG0                                           0592
*         REG1=ADDR(TCWARPLY);                                     0593
         LA    REG1,TCWARPLY(,TCWAPTR)                             0593
*         BAINTSET='1'B;            /* INDICATE INTERNAL SET COMMAND */
         OI    BAINTSET(@07),B'00100000'                           0594
*         GENERATE CODE(MGCR  (1));                                0595
         MGCR  (1)
*         BAINTSET='0'B;                                           0596
         L     @07,CVTMSER(,LCVTPTR)                               0596
         NI    BAINTSET(@07),B'11011111'                           0596
*       END;                                                       0597
@DE00584 L     @07,CVTMSER(,LCVTPTR)                               0597
         CLI   BAIPLCC(@07),X'00'                                  0597
         BNE   @DL00584                                            0597
         TM    TCGNSET(TCWAPTR),B'00001000'                        0597
         BO    @DL00584                                            0597
*     END;                                                         0598
*   ELSE                                                           0599
*                                                                  0599
*/********************************************************************/
*/*                                                                  */
*/* IF MESSAGE IEA886A SHOULD NOT BE ISSUED, SEE IF MESSAGE IEA887A  */
*/* SHOULD BE.                                                       */
*/*                                                                  */
*/********************************************************************/
*                                                                  0599
*     IF TCGZZZ='1'B THEN                                          0599
*                                                                  0599
         B     @RC00579                                            0599
@RF00579 TM    TCGZZZ(TCWAPTR),B'00100000'                         0599
         BNO   @RF00599                                            0599
*/********************************************************************/
*/*                                                                  */
*/* IF SO, SET UP THE PARAMETER LIST FOR THE MESSAGE.                */
*/*                                                                  */
*/********************************************************************/
*                                                                  0600
*       DO;                                                        0600
*         WPLPTR=ADDR(MSGZZZ2);     /* ADDRESSABILITY FOR PARMLIST   */
         LA    WPLPTR,MSGZZZ2                                      0601
*         WPLRPTRA=ADDR(TCWATXT);   /* REPLY ADDRESS TO PARMLIST     */
         LA    @07,TCWATXT(,TCWAPTR)                               0602
         STCM  @07,7,WPLRPTRA(WPLPTR)                              0602
*         WPLRECB=ADDR(TODECB);     /* ECB ADDRESS TO PARMLIST       */
         LA    @07,TODECB                                          0603
         ST    @07,WPLRECB(,WPLPTR)                                0603
*/********************************************************************/
*/*                                                                  */
*/* KEEP ISSUING THIS MESSAGE USING THE SAME CRITERIA AS ABOVE.      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0604
*         DO WHILE BAIPLCC^='00'X×TCGNSET='1'B;                    0604
*                                                                  0604
         B     @DE00604                                            0604
@DL00604 DS    0H                                                  0605
*/********************************************************************/
*/*                                                                  */
*/* SEARCH THE TOD CLOCK WORKAREA ENTRIES FOR CLOCKS THAT ARE SET.   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0605
*           DO REG11=PTREBEG TO PTREEND BY LENGTH(TCENTRY);        0605
         L     REG11,PTREBEG                                       0605
         B     @DE00605                                            0605
@DL00605 DS    0H                                                  0606
*             IF TCLCC='00'B THEN                                  0606
*                                                                  0606
         TM    TCLCC(REG11),B'00110000'                            0606
         BNZ   @RF00606                                            0606
*/********************************************************************/
*/*                                                                  */
*/* IF THE CLOCK IS SET (AS DETERMINED BY THE CONDITION CODE FIELD   */
*/* OF THE ENTRY), STORE THE CURRENT CLOCK VALUE.  THEN,             */
*/* CALCULATE THE LOCAL TIME AND DATE ACCORDING TO THE CLOCK VALUE   */
*/* JUST STORED, AND WRITE THE FIRST LINE OF MESSAGE IEA887A FOR     */
*/* THAT CPU.                                                        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0607
*               DO;                                                0607
*                 REG12=ADDR(DELTA3);                              0608
         LA    REG12,DELTA3                                        0608
*                 REG1=TCWAPCCA;                                   0609
         L     REG1,TCWAPCCA(,REG11)                               0609
*                 GENERATE CODE REFS(CVTIPCRI,CVT)                 0610
*                     (RISGNL SERIAL,CPU=(1),EP=(12),PARM=(11));   0610
         RISGNL SERIAL,CPU=(1),EP=(12),PARM=(11)
*                 TCWAA2L=TCWACLKL+CVTTZ;/* CALCULATE LOCAL CLOCK  0611
*                                      VALUE                         */
         L     @07,TCWACLKL(,REG11)                                0611
         AL    @07,CVTTZ(,LCVTPTR)                                 0611
         ST    @07,TCWAA2L(,TCWAPTR)                               0611
*                 TCWAA2R=TCWACLKR; /* USE L. O. BITS        @ZA10129*/
         MVC   TCWAA2R(4,TCWAPTR),TCWACLKR(REG11)                  0612
*                 TCWAPTP=ADDR(TCWAPLT);                           0613
         LA    @07,TCWAPLT(,TCWAPTR)                               0613
         ST    @07,TCWAPTP(,TCWAPTR)                               0613
*                 TCWAPDP=ADDR(TCWAPLD);                           0614
         LA    @07,TCWAPLD(,TCWAPTR)                               0614
         ST    @07,TCWAPDP(,TCWAPTR)                               0614
*                 TCWACVP=ADDR(TCWAA2);                            0615
         LA    @07,TCWAA2(,TCWAPTR)                                0615
         ST    @07,TCWACVP(,TCWAPTR)                               0615
*                 REG1=ADDR(TCWAPTP);                              0616
         LA    REG1,TCWAPTP(,TCWAPTR)                              0616
*                 CALL CUTODATE;    /* CALL CONVERSION ROUTINE       */
         BAL   @14,CUTODATE                                        0617
*/********************************************************************/
*/*                                                                  */
*/* ASSEMBLE THE VARIABLE TEXT INTO THE MESSAGE AND DISPLAY THE LOCAL*/
*/* TIME AND DATE FOR THIS CPU'S CLOCK.                              */
*/*                                                                  */
*/********************************************************************/
*                                                                  0618
*                 WPLPTR=ADDR(MSGZZZ1);                            0618
         LA    WPLPTR,MSGZZZ1                                      0618
*                 DATEZ=DTEPATRN;   /* EDITING PATTERN TO MSG        */
         MVC   DATEZ(7,WPLPTR),DTEPATRN                            0619
*                 ED(DATEZ,TCWAPLD(2:4));/* EDIT DATE INTO MSG       */
         ED    DATEZ(7,WPLPTR),TCWAPLD+1(TCWAPTR)                  0620
*                 DATEZ(1)='=';     /* PUT = SIGN AFTER DATE         */
         MVI   DATEZ(WPLPTR),C'='                                  0621
*                 CLOCKZ=CLKPATRN;  /* EDITING PATTERN TO MSG        */
         MVC   CLOCKZ(9,WPLPTR),CLKPATRN                           0622
*                 ED(CLOCKZ,TCWAPLT);/* EDIT CLOCK INTO MSG          */
         ED    CLOCKZ(9,WPLPTR),TCWAPLT(TCWAPTR)                   0623
*                 CLOCKZ(1)='=';    /* PUT = SIGN AFTER CLOCK        */
         MVI   CLOCKZ(WPLPTR),C'='                                 0624
*                 CVD(TCWAIADD,TCWAWRK1);                          0625
         SLR   @07,@07                                             0625
         ICM   @07,3,TCWAIADD(REG11)                               0625
         CVD   @07,TCWAWRK1(,TCWAPTR)                              0625
*                 UNPK(CPUADDRZ,TCWAWRK1(7:8));                    0626
         UNPK  CPUADDRZ(2,WPLPTR),TCWAWRK1+6(2,TCWAPTR)            0626
*                 CPUADDRZ(2)=CPUADDRZ(2)×'F0'X;                   0627
         OI    CPUADDRZ+1(WPLPTR),X'F0'                            0627
*                 GENERATE CODE(WTO   MF=(E,(1)));                 0628
         WTO   MF=(E,(1))
*               END;                                               0629
*           END;                                                   0630
@RF00606 AL    REG11,@CF00045                                      0630
@DE00605 C     REG11,PTREEND                                       0630
         BNH   @DL00605                                            0630
*           TODECB=0;               /* ZERO REPLY ECB                */
         SLR   @07,@07                                             0631
         ST    @07,TODECB                                          0631
*           TCWATXT='';             /* CLEAR REPLY AREA              */
         MVI   TCWATXT(TCWAPTR),C' '                               0632
         MVC   TCWATXT+1(39,TCWAPTR),TCWATXT(TCWAPTR)              0632
*           WPLPTR=ADDR(MSGZZZ2);                                  0633
*                                                                  0633
         LA    WPLPTR,MSGZZZ2                                      0633
*/********************************************************************/
*/*                                                                  */
*/* THEN ISSUE THE SECOND LINE OF MESSAGE IEA887A TO PROMPT THE      */
*/* OPERATOR FOR A REPLY.                                            */
*/*                                                                  */
*/********************************************************************/
*                                                                  0634
*           GENERATE CODE;                                         0634
*                                                                  0634
*                            /*
         WTOR  MF=(E,(1))                                          */
*/********************************************************************/
*/*                                                                  */
*/* WAIT FOR REPLY.                                                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0635
*           REG1=ADDR(TODECB);                                     0635
         LA    REG1,TODECB                                         0635
*           GENERATE CODE(WAIT  1,ECB=(1));                        0636
*                                                                  0636
         WAIT  1,ECB=(1)
*/********************************************************************/
*/*                                                                  */
*/* INDICATE AN INTERNAL SET COMMAND AND ISSUE SVC 34 USING THE OPER-*/
*/* ATOR'S REPLY AS THE COMMAND OPERAND.                             */
*/*                                                                  */
*/********************************************************************/
*                                                                  0637
*           BAIPLCC='00'X;          /* CLEAR ERROR BYTE IN BASEA     */
         L     @07,CVTMSER(,LCVTPTR)                               0637
         MVI   BAIPLCC(@07),X'00'                                  0637
*           REG0=0;                                                0638
         SLR   REG0,REG0                                           0638
*           REG1=ADDR(TCWARPLY);                                   0639
         LA    REG1,TCWARPLY(,TCWAPTR)                             0639
*           BAINTSET='1'B;          /* INDICATE AN INTERNAL SET    0640
*                                      COMMAND                       */
         OI    BAINTSET(@07),B'00100000'                           0640
*           GENERATE CODE(MGCR  (1));                              0641
         MGCR  (1)
*           BAINTSET='0'B;                                         0642
         L     @07,CVTMSER(,LCVTPTR)                               0642
         NI    BAINTSET(@07),B'11011111'                           0642
*         END;                                                     0643
@DE00604 L     @07,CVTMSER(,LCVTPTR)                               0643
         CLI   BAIPLCC(@07),X'00'                                  0643
         BNE   @DL00604                                            0643
         TM    TCGNSET(TCWAPTR),B'00001000'                        0643
         BO    @DL00604                                            0643
*       END;                                                       0644
*                                                                  0644
*/********************************************************************/
*/*                                                                  */
*/* AFTER MESSAGE IEA886A OR MESSAGE IEA887A IS ISSUED, OR IF        */
*/* NEITHER WAS TO BE ISSUED, ISSUE MESSAGE IEA888A UNTIL THE OPERA- */
*/* TOR'S SYNTAX IS CORRECT AND A CLOCK HAS BEEN SET.                */
*/*                                                                  */
*/* FIRST, INDICATE THAT NEITHER MESSAGE IEA886A NOR IEA887A IS OUT- */
*/* STANDING AND THAT THE CONVERSION ROUTINE SHOULD NOT SAVE ELAPSED */
*/* DAYS.                                                            */
*/*                                                                  */
*/* THEN INDICATE THAT MESSAGE IEA888A IS OUTSTANDING, AND THAT THE  */
*/* CVTDATE MUST BE SET.  TURN ON THE CLOCK NOT SET INDICATOR TO     */
*/* ENSURE THAT THE LOOP WILL BE EXECUTED AT LEAST ONCE.             */
*/*                                                                  */
*/********************************************************************/
*                                                                  0645
*   DO;                                                            0645
@RF00599 DS    0H                                                  0645
@RC00579 DS    0H                                                  0646
*     TCGYYY='0'B;                  /* NOT MSG IEA886A       @YM08621*/
*     TCGZZZ='0'B;                  /* NOT MSG IEA887A       @YM08621*/
*     TCGLELD='0'B;                 /* DO NOT SAVE DAYS      @YM08621*/
*     TCGXXX='1'B;                  /* MSG IEA888A           @YM08621*/
*     TCGCVTD='1'B;                 /* SET CVTDATE           @YM08621*/
*     TCGNSET='1'B;                 /* CLOCK NOT SET         @YM08621*/
         OI    TCGXXX(TCWAPTR),B'10001010'                         0651
         NI    TCGYYY(TCWAPTR),B'10011011'                         0651
*/********************************************************************/
*/*                                                                  */
*/* SET UP THE INTERFACE TO HAVE THE CPU REPRESENTED BY THE          */
*/* FIRST TOD CLOCK WORKAREA ENTRY STORE ITS CLOCK IN ORDER TO GET   */
*/* A CURRENT VALUE.                                                 */
*/*                                                                  */
*/********************************************************************/
*                                                                  0652
*     DO WHILE BAIPLCC^='00'X×TCGNSET='1'B;                        0652
*                                                                  0652
         B     @DE00652                                            0652
@DL00652 DS    0H                                                  0653
*/********************************************************************/
*/*                                                                  */
*/* TEST FOR STRICTLY UNI-PROCESSOR CONFIGURATION.  IF SO, INVOKE    */
*/* ROUTINE TO STORE TOD CLOCK VIA BRANCH AND LINK.  IF NOT, INVOKE  */
*/* THE ROUITNE VIA THE IPC.                                         */
*/*                                                                  */
*/********************************************************************/
*                                                                  0653
*       IF CSDMP='0'B THEN                                         0653
         L     @07,CVTCSD(,LCVTPTR)                                0653
         TM    CSDMP(@07),B'10000000'                              0653
         BNZ   @RF00653                                            0653
*         DO;                                                      0654
*           REG15=ADDR(DELTA3);     /* GET ENTRY POINT ADDRESS       */
         LA    REG15,DELTA3                                        0655
*           REG1=ADDR(TCWAA1);      /* GET ADDRESS OF STCK AREA      */
         LA    REG1,TCWAA1(,TCWAPTR)                               0656
*           GENERATE CODE REFS(REG15) SETS(REG14)(BALR  REG14,REG15);
         BALR  REG14,REG15
*                                   /* BALR TO ROUTINE               */
*         END;                                                     0658
*       ELSE                                                       0659
*                                                                  0659
*/********************************************************************/
*/*                                                                  */
*/* SET UP IPC INTERFACE.                                            */
*/*                                                                  */
*/********************************************************************/
*                                                                  0659
*         DO;                                                      0659
         B     @RC00653                                            0659
@RF00653 DS    0H                                                  0660
*           REG11=ADDR(TCWAA1);     /* GET PARAMETER ADDRESS         */
         LA    REG11,TCWAA1(,TCWAPTR)                              0660
*           REG12=ADDR(DELTA3);     /* GET ROUTINE ADDRESS           */
         LA    REG12,DELTA3                                        0661
*           REG1=PTREBEG->TCWAPCCA; /* GET ADDRESS PCCA              */
         L     @07,PTREBEG                                         0662
         L     REG1,TCWAPCCA(,@07)                                 0662
*           GENERATE CODE REFS(CVTIPCRI,CVT)                       0663
*               (RISGNL SERIAL,CPU=(1),EP=(12),PARM=(11));         0663
         RISGNL SERIAL,CPU=(1),EP=(12),PARM=(11)
*         END;                                                     0664
*                                                                  0664
*/********************************************************************/
*/*                                                                  */
*/* ADD THE TIME ZONE CONSTANT TO THE STORED VALUE TO GET THE LOCAL  */
*/* CLOCK VALUE, AND SET UP THE PARAMETER LIST POINTERS FOR THE TIME */
*/* VALUE TO BE CONVERTED.                                           */
*/*                                                                  */
*/********************************************************************/
*                                                                  0665
*       TCWAA2L=TCWAA1L+CVTTZ;                                     0665
@RC00653 L     @07,TCWAA1L(,TCWAPTR)                               0665
         AL    @07,CVTTZ(,LCVTPTR)                                 0665
         ST    @07,TCWAA2L(,TCWAPTR)                               0665
*       TCWAA2R=TCWAA1R;            /* USE LOW ORDER BITS TOO      0666
*                                                            @ZA10129*/
         MVC   TCWAA2R(4,TCWAPTR),TCWAA1R(TCWAPTR)                 0666
*       TCWAPTP=ADDR(TCWAPLT);                                     0667
         LA    @07,TCWAPLT(,TCWAPTR)                               0667
         ST    @07,TCWAPTP(,TCWAPTR)                               0667
*       TCWACVP=ADDR(TCWAA2);                                      0668
*                                                                  0668
         LA    @07,TCWAA2(,TCWAPTR)                                0668
         ST    @07,TCWACVP(,TCWAPTR)                               0668
*/********************************************************************/
*/*                                                                  */
*/* THEN SEE IF THE CVTDATE REQUIRES INITIALIZING.                   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0669
*       IF TCGCVTD='1'B THEN                                       0669
*                                                                  0669
         TM    TCGCVTD(TCWAPTR),B'00000010'                        0669
         BNO   @RF00669                                            0669
*/********************************************************************/
*/*                                                                  */
*/* IF SO, SET UP THE DATE PARAMETER POINTER SO THAT THE CONVERSION  */
*/* ROUTINE WILL STORE THE DATE INTO  THE CVT.  THEN INDICATE THAT   */
*/* IT HAS BEEN INITIALIZED.                                         */
*/*                                                                  */
*/********************************************************************/
*                                                                  0670
*         DO;                                                      0670
*           TCWAPDP=ADDR(CVTDATE);                                 0671
         LA    @07,CVTDATE(,LCVTPTR)                               0671
         ST    @07,TCWAPDP(,TCWAPTR)                               0671
*           TCGCVTD='0'B;                                          0672
         NI    TCGCVTD(TCWAPTR),B'11111101'                        0672
*         END;                                                     0673
*       ELSE                                                       0674
*                                                                  0674
*/********************************************************************/
*/*                                                                  */
*/* IF CVTDATE HAS BEEN INITIALIZED, HAVE THE CONVERSION ROUTINE     */
*/* STORE THE DATE INTO THE TOD CLOCK WORKAREA.                      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0674
*         TCWAPDP=ADDR(TCWAPLD);                                   0674
*                                                                  0674
         B     @RC00669                                            0674
@RF00669 LA    @07,TCWAPLD(,TCWAPTR)                               0674
         ST    @07,TCWAPDP(,TCWAPTR)                               0674
*/********************************************************************/
*/*                                                                  */
*/* POINT THE PARAMETER REGISTER TO THE PARAMETER LIST AND CALL THE  */
*/* ROUTINE THAT CONVERTS A TOD CLOCK VALUE TO PACKED DATE AND TIME. */
*/* INDICATE TO THE CONVERSION ROUTINE TO SAVE DAYS ELAPSED PLUS 1   */
*/* FOR LATER USE IN CALCULATING THE VALUE OF THE MIDNIGHT TQE.      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0675
*       REG1=ADDR(TCWAPTP);                                        0675
@RC00669 LA    REG1,TCWAPTP(,TCWAPTR)                              0675
*       TCGLELD='1'B;                                              0676
         OI    TCGLELD(TCWAPTR),B'00000100'                        0676
*       CALL CUTODATE;                                             0677
         BAL   @14,CUTODATE                                        0677
*       TCGLELD='0'B;                                              0678
*                                                                  0678
         NI    TCGLELD(TCWAPTR),B'11111011'                        0678
*/********************************************************************/
*/*                                                                  */
*/* SEE IF THE OPERATOR IS TO BE PROMPTED.                           */
*/*                                                                  */
*/********************************************************************/
*                                                                  0679
*       IF MSTODWTO='0'B            /*                        @Y02675*/
*/********************************************************************/
*/*                                                                  */
*/* IF SO, SET UP THE INTERFACE TO GET THE TOD CLOCK VALUE JUST      */
*/* STORED INTO PACKED GREENWICH MEAN TIME AND DATE, AND CALL THE    */
*/* CONVERSION ROUTINE.                                              */
*/*                                                                  */
*/********************************************************************/
*                                                                  0679
*         THEN                                                     0679
         L     @07,CVTMSER(,LCVTPTR)                               0679
         TM    MSTODWTO(@07),B'01000000'                           0679
         BNZ   @RF00679                                            0679
*         DO;                                                      0680
*           TCWAPTP=ADDR(TCWAPGT);                                 0681
         LA    @07,TCWAPGT(,TCWAPTR)                               0681
         ST    @07,TCWAPTP(,TCWAPTR)                               0681
*           TCWAPDP=ADDR(TCWAPGD);                                 0682
         LA    @07,TCWAPGD(,TCWAPTR)                               0682
         ST    @07,TCWAPDP(,TCWAPTR)                               0682
*           TCWACVP=ADDR(TCWAA1);                                  0683
         LA    @07,TCWAA1(,TCWAPTR)                                0683
         ST    @07,TCWACVP(,TCWAPTR)                               0683
*           REG1=ADDR(TCWAPTP);                                    0684
         LA    REG1,TCWAPTP(,TCWAPTR)                              0684
*           CALL CUTODATE;                                         0685
*                                                                  0685
         BAL   @14,CUTODATE                                        0685
*/********************************************************************/
*/*                                                                  */
*/* ASSEMBLE THE MESSAGE FOR DISPLAYING THE GREENWICH MEAN TIME AND  */
*/* DATE, AND WRITE THE MESSAGE.                                     */
*/*                                                                  */
*/********************************************************************/
*                                                                  0686
*           WPLPTR=ADDR(MSGXXX1);                                  0686
*                                                                  0686
         LA    WPLPTR,MSGXXX1                                      0686
*/* C271100-271500                                           @YM04380*/
*                                                                  0687
*           DATEX1=DTEPATRN;        /* EDITING PATTERN TO MSG        */
         MVC   DATEX1(7,WPLPTR),DTEPATRN                           0687
*           ED(DATEX1,TCWAPGD(2:4));/* EDIT DATE INTO MSG            */
         ED    DATEX1(7,WPLPTR),TCWAPGD+1(TCWAPTR)                 0688
*           DATEX1(1)='=';          /* PUT = SIGN AFTER DATE         */
         MVI   DATEX1(WPLPTR),C'='                                 0689
*           CLOCKX1=CLKPATRN;       /* EDITING PATTERN TO MSG        */
         MVC   CLOCKX1(9,WPLPTR),CLKPATRN                          0690
*           ED(CLOCKX1,TCWAPGT);    /* EDIT CLOCK INTO MSG           */
         ED    CLOCKX1(9,WPLPTR),TCWAPGT(TCWAPTR)                  0691
*           CLOCKX1(1)='=';         /* PUT = SIGN AFTER CLOCK        */
         MVI   CLOCKX1(WPLPTR),C'='                                0692
*           GENERATE CODE(WTO    MF=(E,(1)));                      0693
*                                                                  0693
         WTO    MF=(E,(1))
*/********************************************************************/
*/*                                                                  */
*/* ASSEMBLE THE MESSAGE FOR DISPLAYING THE LOCAL TIME AND DATE,     */
*/* AND WRITE THE MESSAGE.                                           */
*/*                                                                  */
*/********************************************************************/
*                                                                  0694
*           WPLPTR=ADDR(MSGXXX2)+LENGTH(WPLRF);                    0694
*                                                                  0694
         LA    @07,MSGXXX2                                         0694
         LA    WPLPTR,8                                            0694
         ALR   WPLPTR,@07                                          0694
*/* C272600-273000                                           @YM04380*/
*                                                                  0695
*           DATEX2=DTEPATRN;        /* EDITING PATTERN TO MSG        */
         MVC   DATEX2(7,WPLPTR),DTEPATRN                           0695
*           ED(DATEX2,CVTDATE(2:4));/* EDIT DATE INTO MSG            */
         ED    DATEX2(7,WPLPTR),CVTDATE+1(LCVTPTR)                 0696
*           DATEX2(1)='=';          /* PUT = SIGN AFTER DATE         */
         MVI   DATEX2(WPLPTR),C'='                                 0697
*           CLOCKX2=CLKPATRN;       /* EDITING PATTERN TO MSG        */
         MVC   CLOCKX2(9,WPLPTR),CLKPATRN                          0698
*           ED(CLOCKX2,TCWAPLT);    /* EDIT CLOCK INTO MSG           */
         ED    CLOCKX2(9,WPLPTR),TCWAPLT(TCWAPTR)                  0699
*           CLOCKX2(1)='=';         /* PUT = SIGN AFTER CLOCK        */
         MVI   CLOCKX2(WPLPTR),C'='                                0700
*           WPLPTR=ADDR(MSGXXX2);   /* MSG ADDR TO WPL               */
         LR    WPLPTR,@07                                          0701
*           WPLRPTRA=ADDR(TCWATXT); /* REPLY ADDR TO WPL             */
         LA    @07,TCWATXT(,TCWAPTR)                               0702
         STCM  @07,7,WPLRPTRA(WPLPTR)                              0702
*           WPLRECB=ADDR(TODECB);   /* ECB ADDR TO WPL               */
         LA    @07,TODECB                                          0703
         ST    @07,WPLRECB(,WPLPTR)                                0703
*           TODECB=0;                                              0704
         SLR   @07,@07                                             0704
         ST    @07,TODECB                                          0704
*           TCWATXT='';                                            0705
         MVI   TCWATXT(TCWAPTR),C' '                               0705
         MVC   TCWATXT+1(39,TCWAPTR),TCWATXT(TCWAPTR)              0705
*           GENERATE CODE;                                         0706
*                                                                  0706
*                                /*
         WTOR  MF=(E,(1))                                         */
*/********************************************************************/
*/*                                                                  */
*/* WAIT FOR REPLY.                                                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0707
*           REG1=ADDR(TODECB);                                     0707
         LA    REG1,TODECB                                         0707
*           GENERATE CODE(WAIT  1,ECB=(1));                        0708
         WAIT  1,ECB=(1)
*         END;                                                     0709
*       ELSE                                                       0710
*                                                                  0710
*/********************************************************************/
*/*                                                                  */
*/* IF NO PROMPTING IS REQUIRED, SIMULATE THE OPERATORS ACCEPTANCE   */
*/* OF THE CLOCK VALUE BY PLACING A CAPITAL U IN THE REPLY BUFFER.   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0710
*         TCWATXT(1:2)=CAPU;                                       0710
*                                                                  0710
         B     @RC00679                                            0710
@RF00679 MVC   TCWATXT(2,TCWAPTR),CAPU                             0710
*/********************************************************************/
*/*                                                                  */
*/* SEE IF THE OPERATOR HAS ACCEPTED THE CLOCK VALUES.               */
*/*                                                                  */
*/********************************************************************/
*                                                                  0711
*       BAIPLCC='00'X;              /* CLEAR ERROR BYTE IN BASEA     */
@RC00679 L     @07,CVTMSER(,LCVTPTR)                               0711
         MVI   BAIPLCC(@07),X'00'                                  0711
*       TCGNSET='0'B;               /* TURN OFF CLOCK NOT SET      0712
*                                      INDICATOR                     */
         NI    TCGNSET(TCWAPTR),B'11110111'                        0712
*       IF TCWATXT(1:2)^=CAPU&TCWATXT(1:2)^=SMALLU THEN            0713
*                                                                  0713
         CLC   TCWATXT(2,TCWAPTR),CAPU                             0713
         BE    @RF00713                                            0713
         CLC   TCWATXT(2,TCWAPTR),SMALLU                           0713
         BE    @RF00713                                            0713
*/********************************************************************/
*/*                                                                  */
*/* IF NOT, INDICATE AN INTERNAL SET COMMAND, AND ISSUE SVC 34 USING */
*/* THE OPERATOR'S REPLY AS THE COMMAND OPERAND(S).                  */
*/* UPON RETURN, TURN OFF THE INTERNAL SET INDICATOR, AND TURN ON    */
*/* THE CLOCK NOT SET INDICATOR.  THE LATTER ENSURES THAT MESSAGE    */
*/* IEA888A  WILL BE ISSUED AGAIN, DISPLAYING THE NEW VALUES TO THE  */
*/* OPERATOR.                                                        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0714
*         DO;                                                      0714
*           REG0=0;                                                0715
         SLR   REG0,REG0                                           0715
*           REG1=ADDR(TCWARPLY);                                   0716
         LA    REG1,TCWARPLY(,TCWAPTR)                             0716
*           BAINTSET='1'B;          /* INDICATE INTERNAL SET COMMAND */
         OI    BAINTSET(@07),B'00100000'                           0717
*           GENERATE CODE(MGCR  (1));                              0718
         MGCR  (1)
*           BAINTSET='0'B;                                         0719
         L     @07,CVTMSER(,LCVTPTR)                               0719
         NI    BAINTSET(@07),B'11011111'                           0719
*           TCGNSET='1'B;                                          0720
         OI    TCGNSET(TCWAPTR),B'00001000'                        0720
*         END;                                                     0721
*     END;                                                         0722
@RF00713 DS    0H                                                  0722
@DE00652 L     @07,CVTMSER(,LCVTPTR)                               0722
         CLI   BAIPLCC(@07),X'00'                                  0722
         BNE   @DL00652                                            0722
         TM    TCGNSET(TCWAPTR),B'00001000'                        0722
         BO    @DL00652                                            0722
*   END;                                                           0723
*                                                                  0723
*/********************************************************************/
*/*                                                                  */
*/* RETURN TO THE CALLER.                                            */
*/*                                                                  */
*/********************************************************************/
*                                                                  0724
*   RESPECIFY                                                      0724
*     CVTMAP BASED(CVTPTR);                                        0724
*                                                                  0725
*/********************************************************************/
*/*                                                                  */
*/* THIS PROCEDURE CONVERTS TOD CLOCK VALUES TO PACKED DATE AND TIME.*/
*/* IT USES A 2 STEP PROCESS.  THE FIRST STEP FACTORS COMPLETE DAYS  */
*/* ELAPSED SINCE THE EPOCH OUT OF THE HIGH ORDER 39 BITS OF THE TOD */
*/* CLOCK VALUE, AND THEN CONVERTS TO YEAR AND DAY OF YEAR.  THE     */
*/* SECOND STEP TAKES THE REMAINDER OF THE FIRST STEP, CONCATENATES  */
*/* IT TO THE LOW ORDER 13 BITS OF THE TOD CLOCK, AND CONVERTS TO    */
*/* HOURS, MINUTES, AND SECONDS ELAPSED SINCE THE LAST MIDNIGHT.     */
*/*                                                                  */
*/********************************************************************/
*                                                                  0725
*CUTODATE:                                                         0725
*   PROCEDURE(PARMTIME,PARMDATE,CONVALUE) OPTIONS(NOSAVE,NOSAVEAREA);
         B     @PB00006                                            0725
CUTODATE MVC   @PC00006(12),0(@01)                                 0725
*   DECLARE                                                        0726
*     PARMTIME CHAR(4);             /* CONVERTED PACKED TIME         */
*   DECLARE                                                        0727
*     PARMDATE CHAR(4);             /* CONVERTED PACKED DATE         */
*   DECLARE                                                        0728
*     1 CONVALUE BIT(64) BDY(WORD), /* 64 BIT TOD CLOCK VALUE TO BE
*                                      CONVERTED             @ZA10129*/
*       3 HO32BITS FIXED(32) UNSIGNED,/* H. O. TOD CLOCK     @ZA10129*/
*       3 LO32BITS FIXED(32) UNSIGNED;/* L. O. TOD CLOCK     @ZA10129*/
*/********************************************************************/
*/*                                                                  */
*/* SAVE THE RETURN REGISTER ACROSS THE ROUTINE.                     */
*/*                                                                  */
*/********************************************************************/
*                                                                  0729
*   RETSAVE=REG14;                                                 0729
*                                                                  0729
         ST    REG14,RETSAVE                                       0729
*/********************************************************************/
*/*                                                                  */
*/* SAVE THE LOW ORDER PART OF THE TOD CLOCK FOR LATER USE.  PUT THE */
*/* TOD CLOCK VALUE TO BE CONVERTED INTO REGISTERS 14 AND 15.  NOTE  */
*/* THAT BIT 19 OF REGISTER 15 (BIT 51 OF THE TOD CLOCK) REPRESENTS  */
*/* 1 MICROSECOND.                                                   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0730
*   REG1=LO32BITS;                  /*                       @ZA10129*/
         L     @07,@PC00006+8                                      0730
         L     REG1,LO32BITS(,@07)                                 0730
*   LM(REG14,REG15,CONVALUE);       /*                       @ZA10129*/
         LM    REG14,REG15,CONVALUE(@07)                           0731
*/********************************************************************/
*/*                                                                  */
*/* THE NEXT 2 INSTRUCTIONS EFFECTIVELY SHIFT BIT 51 OF THE TOD CLOCK*/
*/* VALUE TO BIT 63 OF THE DIVIDEND, AND THEN DIVIDE THE RESULTANT   */
*/* MICROSECOND VALUE BY 86,400,000,000, THE NUMBER OF MICROSECONDS  */
*/* IN 1 DAY.  THIS DIVISION PROVIDES DAYS ELAPSED SINCE THE EPOCH   */
*/* IN REGISTER 15, AND THE NUMBER OF 8192 (2**13) MICROSECOND UNITS */
*/* ELAPSED SINCE THE LAST MIDNIGHT IN REGISTER 14.                  */
*/*                                                                  */
*/* NOTE THAT 86,400,000,000 IS EQUAL TO (86,400)*(1,000,000), OR    */
*/* THE NUMBER OF SECONDS IN A DAY TIMES THE NUMBER OF MICROSECONDS  */
*/* IN A SECOND.                                                     */
*/*              86,400 = (2**7)*(5**2)*(3**3)                       */
*/*           1,000,000 = (2**6)*(5**6)                              */
*/*      86,400,000,000 = (2**13)*(5**8)*(3**3)                      */
*/*                                                                  */
*/* SINCE A SHIFT OF 12 BITS TO THE RIGHT IS THE EQUIVALENT OF       */
*/* 1/(2**12), THE SHIFT AND DIVISION INSTRUCTIONS ARE THE SAME AS   */
*/* 1/((2**25)*(5**8)*(3**3)).  THE SHIFT DOES 1/(2**25) AND THE     */
*/* DIVISION DOES 1/((5**8)*(3**3)).                                 */
*/*                                                                  */
*/********************************************************************/
*                                                                  0732
*   SRDL(REG14,25);                 /* SHIFT 12 RIGHT AND DIVIDE BY
*                                      2**13                 @ZA10129*/
         SRDL  REG14,25                                            0732
*   GENERATE CODE REFS(DAYSFACT) SETS(REG14,REG15)                 0733
*       (D     REG14,DAYSFACT);     /* DIVIDE BY (5**8)*(3**3)       */
         D     REG14,DAYSFACT
*/********************************************************************/
*/*                                                                  */
*/* ADD 1 DAY.  (NOTE: ADDING 1 MAKES UP FOR THE FACT THAT DATE IS   */
*/* ONE-ORIGINED.)                                                   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0734
*   REG15=REG15+1;                                                 0734
*                                                                  0734
         AL    REG15,@CF00096                                      0734
*/********************************************************************/
*/*                                                                  */
*/* SEE IF A LOCAL VALUE IS BEING CALCULATED, AND IF SO, SAVE THE    */
*/* NUMBER OF DAYS THAT WILL HAVE ELAPSED AT LOCAL MIDNIGHT IN THE   */
*/* TOD CLOCK WORKAREA.                                              */
*/*                                                                  */
*/********************************************************************/
*                                                                  0735
*   IF TCGLELD='1'B THEN                                           0735
         TM    TCGLELD(TCWAPTR),B'00000100'                        0735
         BNO   @RF00735                                            0735
*     TCELDAYS=REG15;                                              0736
         ST    REG15,TCELDAYS(,TCWAPTR)                            0736
*   REG15=4*REG15;                  /* MULTIPLY DAYS ELAPSED BY 4    */
@RF00735 SLL   REG15,2                                             0737
*/********************************************************************/
*/*                                                                  */
*/* SAVE REGISTER 14 FOR LATER USE.  THEN CLEAR IT FOR DIVISION.     */
*/* (NOTE:  REGISTER 14 CONTAINS THE NUMBER OF 2**13 MICROSECOND     */
*/* UNITS ELAPSED SINCE THE LAST MIDNIGHT.)                          */
*/*                                                                  */
*/********************************************************************/
*                                                                  0738
*   REG0=REG14;                                                    0738
         LR    REG0,REG14                                          0738
*   REG14=0;                                                       0739
*                                                                  0739
         SLR   REG14,REG14                                         0739
*/********************************************************************/
*/*                                                                  */
*/* DIVIDE BY THE NUMBER OF DAYS IN A "NORMAL" 4 YEAR PERIOD GIVING  */
*/* YEAR OF THE CENTURY IN REGISTER 15.  DIVIDE THE REMAINDER BY 4   */
*/* GIVING DAYS ELAPSED SINCE THE BEGINNING OF THE YEAR  (EXCEPT     */
*/* 1900) IN REGISTER 14.                                            */
*/*                                                                  */
*/********************************************************************/
*                                                                  0740
*   GENERATE CODE REFS(DAYS4YRS) SETS(REG14,REG15)                 0740
*       (D     REG14,DAYS4YRS);                                    0740
         D     REG14,DAYS4YRS
*   SRL(REG14,2);                                                  0741
*                                                                  0741
         SRL   REG14,2                                             0741
*/********************************************************************/
*/*                                                                  */
*/* TEST FOR A YEAR NOT 1900.                                        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0742
*   IF REG15^=0 THEN                                               0742
*                                                                  0742
         LTR   REG15,REG15                                         0742
         BZ    @RF00742                                            0742
*/********************************************************************/
*/*                                                                  */
*/* IF THE YEAR IS NOT 1900, ADD 1 DAY TO MAKE IT ONE-ORIGIN.  THEN  */
*/* SHIFT YEARS FOR CORRECT ALIGNMENT WITH DAYS.                     */
*/*                                                                  */
*/********************************************************************/
*                                                                  0743
*     DO;                                                          0743
*       REG14=REG14+1;                                             0744
         AL    REG14,@CF00096                                      0744
*       REG15=REG15*K1000;                                         0745
         LR    @07,REG15                                           0745
         MH    @07,K1000                                           0745
         LR    REG15,@07                                           0745
*     END;                                                         0746
*                                                                  0746
*/********************************************************************/
*/*                                                                  */
*/* ADD DAYS TO YEARS.                                               */
*/*                                                                  */
*/********************************************************************/
*                                                                  0747
*   REG15=REG15+REG14;                                             0747
*                                                                  0747
@RF00742 ALR   REG15,REG14                                         0747
*/********************************************************************/
*/*                                                                  */
*/* CONVERT TO PACKED DECIMAL AND PLACE IN THE PARAMETER AREA.       */
*/* THEN, MAKE THE SIGN A HEX F SO THAT THE VALUE CAN BE UNPACKED.   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0748
*   CVD(REG15,PARMDATE);                                           0748
         L     @07,@PC00006+4                                      0748
         CVD   REG15,@TS00001                                      0748
         MVC   PARMDATE(4,@07),@TS00001+4                          0748
*   PARMDATE(4)=PARMDATE(4)×'0F'X;  /*                       @OY02031*/
         OI    PARMDATE+3(@07),X'0F'                               0749
*/********************************************************************/
*/*                                                                  */
*/* CONCATENATE THE LOW ORDER 13 BITS OF THE TOD CLOCK TO THE        */
*/* REMAINDER FROM THE PREVIOUS DIVISION AND SHIFT THE CONCATENATED  */
*/* VALUE SO THAT TOD CLOCK BIT 51 (1 MICROSECOND) IS IN THE UNITS   */
*/* POSITION OF THE DIVIDEND, BIT 63. THEN DIVIDE BY 1 MILLION TO    */
*/* GIVE THE NUMBER OF SECONDS ELAPSED SINCE THE LAST MIDNIGHT IN    */
*/* REGISTER 1.                                                      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0750
*   SLL(REG1,7);                    /* THROW AWAY TOD CLOCK BITS   0750
*                                      33-39 THAT WERE USED IN THE 0750
*                                      INITIAL CALCULATIONS  @ZA10129*/
         SLL   REG1,7                                              0750
*   SRDL(REG0,19);                  /* TOD CLOCK BIT 51 TO DIVIDEND
*                                      BIT 63                @ZA10129*/
         SRDL  REG0,19                                             0751
*   GENERATE CODE REFS(MICSSEC) SETS(REG0,REG1)(D     REG0,MICSSEC);
*                                                                  0752
         D     REG0,MICSSEC
*/********************************************************************/
*/*                                                                  */
*/* DIVIDE SECONDS ELAPSED SINCE THE LAST MIDNIGHT BY 60 GIVING SEC- */
*/* ONDS ELAPSED SINCE THE LAST MINUTE IN REGISTER 0, AND MINUTES    */
*/* ELAPSED SINCE THE LAST MIDNIGHT IN REGISTER 1.                   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0753
*   REG0=0;                                                        0753
         SLR   REG0,REG0                                           0753
*   GENERATE CODE REFS(REG0,SECSMIN)(D     REG0,SECSMIN);          0754
*                                                                  0754
         D     REG0,SECSMIN
*/********************************************************************/
*/*                                                                  */
*/* SAVE THE SECONDS AND CLEAR REGISTER 0 FOR DIVISION.              */
*/*                                                                  */
*/********************************************************************/
*                                                                  0755
*   REG14=REG0;                                                    0755
         LR    REG14,REG0                                          0755
*   REG0=0;                                                        0756
*                                                                  0756
         SLR   REG0,REG0                                           0756
*/********************************************************************/
*/*                                                                  */
*/* DIVIDE MINUTES ELAPSED SINCE MIDNIGHT BY 60 GIVING MINUTES ELAP- */
*/* SED SINCE THE LAST HOUR IN REGISTER 0, AND HOURS ELAPSED SINCE   */
*/* THE LAST MIDNIGHT IN REGISTER 1.                                 */
*/*                                                                  */
*/********************************************************************/
*                                                                  0757
*   GENERATE CODE REFS(REG0,MINSHOUR)(D     REG0,MINSHOUR);        0757
*                                                                  0757
         D     REG0,MINSHOUR
*/********************************************************************/
*/*                                                                  */
*/* SHIFT HOURS AND MINUTES FOR CORRECT ALIGNMENT AND ADD TO SECONDS.*/
*/* CONVERT TO PACKED DECIMAL AND PLACE IN THE PARAMETER AREA.       */
*/*                                                                  */
*/********************************************************************/
*                                                                  0758
*   REG14=REG14+(REG0*K100)+(REG1*K10000);                         0758
         LR    @07,REG0                                            0758
         MH    @07,K100                                            0758
         ALR   @07,REG14                                           0758
         LR    @06,REG1                                            0758
         MH    @06,K10000                                          0758
         ALR   @07,@06                                             0758
         LR    REG14,@07                                           0758
*   CVD(REG14,PARMTIME);                                           0759
*                                                                  0759
         L     @07,@PC00006                                        0759
         CVD   REG14,@TS00001                                      0759
         MVC   PARMTIME(4,@07),@TS00001+4                          0759
*/********************************************************************/
*/*                                                                  */
*/* RETRIEVE THE CALLER'S RETURN ADDRESS.                            */
*/*                                                                  */
*/********************************************************************/
*                                                                  0760
*   REG14=RETSAVE;                                                 0760
*                                                                  0760
         L     REG14,RETSAVE                                       0760
*/********************************************************************/
*/*                                                                  */
*/* RETURN TO THE CALLER                                             */
*/*                                                                  */
*/********************************************************************/
*                                                                  0761
*   END CUTODATE;                                                  0761
@EL00006 DS    0H                                                  0761
@EF00006 DS    0H                                                  0761
@ER00006 BR    @14                                                 0761
*   END IEAVRCOM;                                                  0762
@EL00005 DS    0H                                                  0762
@EF00005 DS    0H                                                  0762
@ER00005 LM    @14,@12,12(@13)                                     0762
         BR    @14                                                 0762
*   RESPECIFY                                                      0763
*     CVTMAP BASED(CVTPTR);                                        0763
*   RESPECIFY                                                      0764
*    (LCVTPTR) UNRESTRICTED;                                       0764
*                                                                  0765
*/********************************************************************/
*/*                                                                  */
*/*            IEAVRSYN--TOD CLOCK SYNCHRONIZING ROUTINE             */
*/*                                                                  */
*/* THIS ROUTINE RECEIVES CONTROL FROM IEAVRINT AND IEAVRSSC WHEN IT */
*/* HAS BEEN DETERMINED THAT THE TOD CLOCKS NEED TO BE SYNCHRONIZED. */
*/* IT IS PASSED A LIST OF CLOCKS, THE FIRST ONE BEING THE ONE TO    */
*/* WHICH THE OTHERS WILL BE SYNCHRONIZED.                           */
*/*                                                                  */
*/* WHEN THE CLOCKS HAVE APPARENTLY BEEN SYNCHRONIZED, OR IF THEY    */
*/* CANNOT BE SYNCHRONIZED AFTER 5 ATTEMPTS, CONTROL IS RETURNED TO  */
*/* THE CALLER.                                                      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0765
*IEAVRSYN:                                                         0765
*   PROCEDURE OPTIONS(NOSAVEAREA);                                 0765
*                                                                  0765
IEAVRSYN STM   @14,@12,12(@13)                                     0765
*/********************************************************************/
*/*                                                                  */
*/* INITIALIZE THE SECURITY SWITCH RELEASED INDICATOR IN THE TOD     */
*/* CLOCK WORKAREA SO THE LOOP WILL BE EXECUTED AT LEAST ONCE.       */
*/*                                                                  */
*/********************************************************************/
*                                                                  0766
*   TCGNSET='1'B;                                                  0766
         OI    TCGNSET(TCWAPTR),B'00001000'                        0766
*   DO WHILE TCGNSET='1'B;                                         0767
*                                                                  0767
         B     @DE00767                                            0767
@DL00767 DS    0H                                                  0768
*/********************************************************************/
*/*                                                                  */
*/* SEARCH THE TCWA ENTRIES UNTIL A CLOCK REQUIRING SYNCHRONIZATION  */
*/* IS FOUND. START WITH THE SECOND ENTRY SINCE THE FIRST REPRESENTS */
*/* THE CLOCK BEING SYNCHRONIZED TO (HEREAFTER CALLED THE MASTER),   */
*/* AND SO CANNOT REQUIRE SYNCHRONIZING.                             */
*/*                                                                  */
*/********************************************************************/
*                                                                  0768
*     REG11=PTREBEG+LENGTH(TCENTRY);/* GET POINTER TO 2ND TCWA ENTRY */
         LA    REG11,16                                            0768
         AL    REG11,PTREBEG                                       0768
*     RESPECIFY                                                    0769
*      (REG2) RESTRICTED;                                          0769
*     DO REG2=TCCPUCNT-1 TO 1 BY-1 WHILE TCWAPCCA->PCCASYNC='0'B;  0770
         LH    REG2,TCCPUCNT(,TCWAPTR)                             0770
         BCTR  REG2,0                                              0770
         B     @DE00770                                            0770
@DL00770 L     @07,TCWAPCCA(,REG11)                                0770
         TM    PCCASYNC(@07),B'01000000'                           0770
         BNZ   @DC00770                                            0770
*       REG11=REG11+LENGTH(TCENTRY);/* POINT TO NEXT TCWA ENTRY      */
         AL    REG11,@CF00045                                      0771
*     END;                                                         0772
         BCTR  REG2,0                                              0772
@DE00770 LTR   REG2,REG2                                           0772
         BP    @DL00770                                            0772
@DC00770 DS    0H                                                  0773
*     REG2=REG11;                   /* SAVE POINTER TO SELECTED ENTRY*/
         LR    REG2,REG11                                          0773
*/********************************************************************/
*/*                                                                  */
*/* SET UP WTOR PARAMETER LIST FOR MESSAGE IEA889A.                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0774
*     WPLPTR=ADDR(MSGDEPSS);        /* ADDRESSABILITY FOR PARMLIST   */
         LA    WPLPTR,MSGDEPSS                                     0774
*     WPLRPTRA=ADDR(TCWATXT);       /* REPLY ADDRESS TO PARMLIST     */
         LA    @07,TCWATXT(,TCWAPTR)                               0775
         STCM  @07,7,WPLRPTRA(WPLPTR)                              0775
*     WPLRECB=ADDR(TODECB);         /* ECB ADDRESS TO PARMLIST       */
         LA    @07,TODECB                                          0776
         ST    @07,WPLRECB(,WPLPTR)                                0776
*/********************************************************************/
*/*                                                                  */
*/* TELL THE OPERATOR TO DEPRESS THE TOD CLOCK SECURITY SWITCH SO    */
*/* THAT THE CLOCKS CAN BE SET.  GIVE HIM 30 SECONDS TO DO SO.  IF HE*/
*/* DOES NOT COMPLY WITHIN THAT PERIOD, REPEAT THE MESSAGE AND BEGIN */
*/* A NEW TIME PERIOD. REPEAT THIS PROCESS UNTIL HE COMPLIES.        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0777
*     DO WHILE TCGNSET='1'B;                                       0777
*                                                                  0777
         B     @DE00777                                            0777
@DL00777 DS    0H                                                  0778
*/********************************************************************/
*/*                                                                  */
*/* MOVE THE HIGH ORDER 32 BITS OF THE CURRENT VALUE OF THE "MASTER" */
*/* CLOCK TO THE AREA FROM WHICH A CLOCK TO BE SYNCHRONIZED WILL     */
*/* RETRIEVE A TEMPORARY CLOCK SETTING VALUE, AND SET THE LOW ORDER  */
*/* 32 BITS TO ZERO.                                                 */
*/*                                                                  */
*/* (NOTE:  THIS VALUE IS THE VALUE WITH WHICH SOME CLOCK REQUIRING  */
*/* SYNCHRONIZATION WILL BE INITIALLY SET SO THAT IT CAN BE DETER-   */
*/* MINED IF THE OPERATOR HAS DEPRESSED THE SECURITY SWITCH.  THIS   */
*/* APPROXIMATE VALUE MUST BE USED IN ORDER TO PREVENT A POTENTIAL   */
*/* LOOP IN THE TIME SVC (SVC 11), WHILE THE LOW ORDER MUST BE ZERO  */
*/* TO ACOMMODATE THE SYSTEM STATUS RECORDER OF THE MODEL 158.       */
*/*                                                                  */
*/********************************************************************/
*                                                                  0778
*       TCWACVL=PTREBEG->TCWACLKL;                                 0778
         L     @07,PTREBEG                                         0778
         MVC   TCWACVL(4,TCWAPTR),TCWACLKL(@07)                    0778
*       TCWACVR=0;                                                 0779
*                                                                  0779
         SLR   @07,@07                                             0779
         ST    @07,TCWACVR(,TCWAPTR)                               0779
*/********************************************************************/
*/*                                                                  */
*/* CLEAR THE ECB, AND TELL THE OPERATOR TO DEPRESS THE TOD CLOCK    */
*/* SECURITY SWITCH.                                                 */
*/*                                                                  */
*/********************************************************************/
*                                                                  0780
*       TODECB=0;                   /* CLEAR ECB                     */
         ST    @07,TODECB                                          0780
*       WPLPTR=ADDR(MSGDEPSS);      /* GET PARMLIST ADDR     @YM06228*/
         LA    WPLPTR,MSGDEPSS                                     0781
*       GENERATE CODE(WTOR  MF=(E,(1)));                           0782
*                                                                  0782
         WTOR  MF=(E,(1))
*/********************************************************************/
*/*                                                                  */
*/* WAIT FOR THE OPERATOR TO REPLY BEFORE TRYING TO SET THE CLOCK.   */
*/* (NOTE:  WTOR/WAIT IS USED HERE RATHER THAN WTO, EVEN THOUGH NO   */
*/* PARTICULAR REPLY IS REQUIRED.  THE PURPOSE IS TO ALLOW THE       */
*/* SYSTEM TO DISPATCH THE COMMUNICATIONS TASK IN ORDER TO GET THE   */
*/* MESSAGE TO THE OPERATOR BEFORE THE 30 SECOND LOOP ATTEMPTING TO  */
*/* SET THE CLOCK BEGINS.  IF WTO WAS USED, THE COMMUNICATIONS TASK  */
*/* MIGHT NOT BE DISPATCHED, AND THE LOOP WOULD BE EXECUTED WITHOUT  */
*/* TELLING THE OPERATOR WHAT TO DO.)                                */
*/*                                                                  */
*/********************************************************************/
*                                                                  0783
*       REG1=ADDR(TODECB);          /* GET ECB ADDRESS               */
         LA    REG1,TODECB                                         0783
*       GENERATE CODE(WAIT  1,ECB=(1));                            0784
*                                                                  0784
         WAIT  1,ECB=(1)
*/********************************************************************/
*/*                                                                  */
*/* SET UP THE INTERFACE TO IPC SO THAT THE CLOCK REQUIRING SYN-     */
*/* CHRONIZATION WILL ATTEMPT TO SET ITS CLOCK AND SET THE SECURITY  */
*/* SWITCH RELEASED INDICATOR.  (NOTE: REGISTER 2 CONTAINS A POINTER */
*/* TO THE TCWA ENTRY FOR A CPU WHOSE CLOCK REQUIRES SYNCHRONIZING.) */
*/*                                                                  */
*/********************************************************************/
*                                                                  0785
*       REG1=REG2->TCWAPCCA;        /* GET PCCA ADDRESS              */
         L     REG1,TCWAPCCA(,REG2)                                0785
*       REG12=ADDR(DELTA7);         /* GET ROUTINE ADDRESS           */
         LA    REG12,DELTA7                                        0786
*       REG11=ADDR(TCWA);           /* GET PARAMETER ADDRESS         */
         LR    REG11,TCWAPTR                                       0787
*       GENERATE CODE REFS(CVTIPCRI,CVT)                           0788
*           (RISGNL SERIAL,CPU=(1),EP=(12),PARM=(11));             0788
         RISGNL SERIAL,CPU=(1),EP=(12),PARM=(11)
*     END;                                                         0789
@DE00777 TM    TCGNSET(TCWAPTR),B'00001000'                        0789
         BO    @DL00777                                            0789
*     RESPECIFY                                                    0790
*      (REG2) UNRESTRICTED;                                        0790
*                                                                  0790
*/********************************************************************/
*/*                                                                  */
*/* PERFORM THE SYNCHRONIZING PROCEDURE UNTIL ONE OR MORE OF THE     */
*/* FOLLOWING EVENTS OCCUR:                                          */
*/*   (1) THE PROCEDURE IS COMPLETED IN LESS THAT 2**20 MICROSECONDS */
*/*   (2) THE PROCEDURE IS PERFORMED 5 TIMES                         */
*/*   (3) THE OPERATOR PREMATURELY RELEASES THE TOD CLOCK SECURITY   */
*/*       SWITCH                                                     */
*/* THE PROCEDURE CONSISTS OF THE FOLLOWING:                         */
*/*  (1) OBTAINING A VALUE WITH WHICH ALL CLOCKS REQUIRING SYNCHRON- */
*/*      IZATION ARE TO BE SET                                       */
*/*  (2) SIGNALING  ALL CPU'S WITH SUCH CLOCKS TO SET THE TOD SYNC   */
*/*      BIT TO ONE, AND TO SET THEIR CLOCKS TO THE GIVEN VALUE.     */
*/*      NOTE:  SETTING THE TOD SYNC BIT CAUSES THE CLOCK TO ENTER   */
*/*      THE STOPPED STATE WHEN IT IS SET.  SUBSEQUENTLY, WHEN BIT 31*/
*/*      OF A RUNNING CLOCK CHANGES, THE STOPPED CLOCKS WILL START.  */
*/*  (3) AGAIN SIGNALING ALL CPU'S WITH CLOCKS REQUIRING SYNCHRONI-  */
*/*      ZATION TO SET THEIR CLOCKS TO THE GIVEN VALUE.  NOTE: THIS  */
*/*      STEP IS REQUIRED WHERE MORE THAN 2 CLOCKS EXIST IN ORDER TO */
*/*      GET ALL CLOCKS REQUIRING SYNCHRONIZATION STOPPED.  OTHER-   */
*/*      WISE, A CLOCK WHICH HAD NOT YET BEEN STOPPED COULD CHANGE   */
*/*      IN BIT 31 AND CAUSE THE ALREADY STOPPED CLOCKS TO START.    */
*/*  (4) TESTING TO MAKE SURE THAT THE PROCEDURE HAS BEEN PERFORMED  */
*/*      IN LESS THAN 2*20 MICROSECONDS.                             */
*/*                                                                  */
*/********************************************************************/
*                                                                  0791
*     PTREBEG->TCWACLKL=0;          /* INITIALIZE THE MASTER'S CLOCK
*                                      VALUE IN HIS TCWA ENTRY       */
         L     @02,PTREBEG                                         0791
         SLR   @07,@07                                             0791
         ST    @07,TCWACLKL(,@02)                                  0791
*/********************************************************************/
*/*                                                                  */
*/* PERFORM THE LOOP 5 TIMES AS LONG AS IT HAS NOT BEEN COMPLETED IN */
*/* IN LESS THAN 2**20 MICROSECONDS.  (NOTE: THE FIRST TIME THRU THIS*/
*/* LOOP, TCWAA2 WILL NOT EQUAL TCWACLKL BECAUSE THE LATTER WILL BE  */
*/* 0, AND THE FORMER WILL CONTAIN THE LAST CPU TIMER VALUE STORED   */
*/* ABOVE.)                                                          */
*/*                                                                  */
*/********************************************************************/
*                                                                  0792
*     DO LOOPCTR=5 TO 1 BY-1 WHILE PTREBEG->TCWACLKL^=TCWAA2L;     0792
*                                                                  0792
         LA    @02,5                                               0792
         ST    @02,LOOPCTR                                         0792
@DL00792 L     @02,PTREBEG                                         0792
         CLC   TCWACLKL(4,@02),TCWAA2L(TCWAPTR)                    0792
         BE    @DC00792                                            0792
*/********************************************************************/
*/*                                                                  */
*/* SET UP THE INTERFACE TO IPC FOR OBTAINING THE CLOCK-SETTING      */
*/* VALUE, AND THE BEGINNING VALUE.                                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0793
*       REG1=PTREBEG->TCWAPCCA;     /* GET PCCA ADDRESS              */
         L     REG1,TCWAPCCA(,@02)                                 0793
*       REG12=ADDR(DELTA4);         /* GET ROUTINE ADDRESS           */
         LA    REG12,DELTA4                                        0794
*       REG11=ADDR(TCWA);           /* GET PARAMETER ADDRESS         */
         LR    REG11,TCWAPTR                                       0795
*       GENERATE CODE REFS(CVTIPCRI,CVT)                           0796
*           (RISGNL SERIAL,CPU=(1),EP=(12),PARM=(11));             0796
*                                                                  0796
         RISGNL SERIAL,CPU=(1),EP=(12),PARM=(11)
*/********************************************************************/
*/*                                                                  */
*/* CALCULATE THE VALUE BY SETTING THE LOW ORDER 32 BITS TO 0, AND   */
*/* HIGH ORDER 32 BITS TO THE CURRENT VALUE OF THE HIGH ORDER 32     */
*/* BITS PLUS 2**20 MICROSECONDS.  (NOTE: THE CLOCK SETTING VALUE    */
*/* (TCWACVAL) WILL BE APPROXIMATELY 2**20 MICROSECONDS GREATER      */
*/* THAN THE BEGIN VALUE(TCWAA2), BUT CAN NEVER BE MORE THAN 2**20   */
*/* MICROSECONDS GREATER.)                                           */
*/*                                                                  */
*/********************************************************************/
*                                                                  0797
*       TCWACVR=0;                                                 0797
         SLR   @02,@02                                             0797
         ST    @02,TCWACVR(,TCWAPTR)                               0797
*       TCWACVL=TCWAA2L+1;                                         0798
*                                                                  0798
         LA    @02,1                                               0798
         AL    @02,TCWAA2L(,TCWAPTR)                               0798
         ST    @02,TCWACVL(,TCWAPTR)                               0798
*/********************************************************************/
*/*                                                                  */
*/* LOOP THRU TWICE, FOR THE REASONS EXPLAINED ABOVE.                */
*/*                                                                  */
*/********************************************************************/
*                                                                  0799
*       RESPECIFY                                                  0799
*        (REG2) RESTRICTED;                                        0799
*       DO SETLOOP=2 TO 1 BY-1;                                    0800
         LA    @07,2                                               0800
         ST    @07,SETLOOP                                         0800
@DL00800 DS    0H                                                  0801
*         REG2=PTREBEG+LENGTH(TCENTRY);/* GET PTR TO 2ND TCWA ENTRY  */
         LA    REG2,16                                             0801
         AL    REG2,PTREBEG                                        0801
*/********************************************************************/
*/*                                                                  */
*/* BEGINNING WITH THE SECOND ONE, PROCESS ALL TCWA ENTRIES.         */
*/* NOTE: THE FIRST ENTRY REPRESENTS THE CLOCK BEING SYNCHRONIZED TO.*/
*/*                                                                  */
*/********************************************************************/
*                                                                  0802
*         DO I5=TCCPUCNT-1 TO 1 BY-1;                              0802
*                                                                  0802
         LH    @07,TCCPUCNT(,TCWAPTR)                              0802
         BCTR  @07,0                                               0802
         ST    @07,I5                                              0802
         B     @DE00802                                            0802
@DL00802 DS    0H                                                  0803
*/********************************************************************/
*/*                                                                  */
*/* TEST TO SEE IF THE CLOCK REPRESENTED BY THIS ENTRY REQUIRES SYN- */
*/* CHRONIZING.                                                      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0803
*           IF REG2->TCWAPCCA->PCCASYNC='1'B THEN                  0803
*                                                                  0803
         L     @07,TCWAPCCA(,REG2)                                 0803
         TM    PCCASYNC(@07),B'01000000'                           0803
         BNO   @RF00803                                            0803
*/********************************************************************/
*/*                                                                  */
*/* IF IT DOES, SET UP THE IPC INTERFACE TO HAVE THE CLOCK SET.      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0804
*             DO;                                                  0804
*               REG1=REG2->TCWAPCCA;/* GET PCCA ADDRESS              */
         LR    REG1,@07                                            0805
*               REG12=ADDR(DELTA2); /* GET ROUTINE ADDRESS           */
         LA    REG12,DELTA2                                        0806
*               REG11=ADDR(TCWA);   /* GET PARAMETER ADDRESS         */
         LR    REG11,TCWAPTR                                       0807
*               GENERATE CODE REFS(CVTIPCRI,CVT)                   0808
*                   (RISGNL SERIAL,CPU=(1),EP=(12),PARM=(11));     0808
*                                                                  0808
         RISGNL SERIAL,CPU=(1),EP=(12),PARM=(11)
*/********************************************************************/
*/*                                                                  */
*/* SEE IF THE CLOCK WAS SUCCESSFULLY SET. (IE. THE OPERATOR HAS NOT */
*/* PREMATURELY RELEASED THE TOD CLOCK SECURITY SWITCH.)             */
*/*                                                                  */
*/********************************************************************/
*                                                                  0809
*               IF TCGNSET='1'B THEN                               0809
*                                                                  0809
         TM    TCGNSET(TCWAPTR),B'00001000'                        0809
         BNO   @RF00809                                            0809
*/********************************************************************/
*/*                                                                  */
*/* IF THE SWITCH WAS RELEASED, SET THE LOOP COUNTS OF ALL 3 LOOPS SO*/
*/* THAT AN EXIT FROM THEM WILL OCCUR.                               */
*/*                                                                  */
*/********************************************************************/
*                                                                  0810
*                 DO;                                              0810
*                   I5=1;                                          0811
         LA    @07,1                                               0811
         ST    @07,I5                                              0811
*                   SETLOOP=1;                                     0812
         ST    @07,SETLOOP                                         0812
*                   LOOPCTR=1;                                     0813
         ST    @07,LOOPCTR                                         0813
*                 END;                                             0814
*             END;                                                 0815
@RF00809 DS    0H                                                  0816
*           REG2=REG2+LENGTH(TCENTRY);/* POINT TO NEXT TCWA ENTRY    */
@RF00803 AL    REG2,@CF00045                                       0816
*         END;                                                     0817
         SLR   @07,@07                                             0817
         BCTR  @07,0                                               0817
         AL    @07,I5                                              0817
         ST    @07,I5                                              0817
@DE00802 LTR   @07,@07                                             0817
         BP    @DL00802                                            0817
*       END;                                                       0818
         SLR   @07,@07                                             0818
         BCTR  @07,0                                               0818
         AL    @07,SETLOOP                                         0818
         ST    @07,SETLOOP                                         0818
         LTR   @07,@07                                             0818
         BP    @DL00800                                            0818
*       RESPECIFY                                                  0819
*        (REG2) UNRESTRICTED;                                      0819
*                                                                  0819
*/********************************************************************/
*/*                                                                  */
*/* SET UP THE INTERFACE TO IPC SO THAT THE CLOCK BEING SYNCHRONIZED */
*/* TO WILL STORE AN ENDING VALUE.  (NOTE: THE ENDING VALUE IS STORED*/
*/* IN THE MASTER'S TCWA ENTRY.  IF ITS HIGH ORDER 32 BITS ARE EQUAL */
*/* TO THE HIGH ORDER 32 BITS OF THE BEGIN VALUE(TCWAA2), THE LOOP   */
*/* HAS BEEN COMPLETED WITHIN 2**20 MICROSECONDS.)                   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0820
*       REG1=PTREBEG->TCWAPCCA;     /* GET PCCA ADDRESS              */
         L     @02,PTREBEG                                         0820
         L     REG1,TCWAPCCA(,@02)                                 0820
*       REG12=ADDR(DELTA3);         /* GET ROUTINE ADDRESS           */
         LA    REG12,DELTA3                                        0821
*       REG11=PTREBEG;              /* GET PARAMETER ADDRESS         */
         LR    REG11,@02                                           0822
*       GENERATE CODE REFS(CVTIPCRI,CVT)                           0823
*           (RISGNL SERIAL,CPU=(1),EP=(12),PARM=(11));             0823
         RISGNL SERIAL,CPU=(1),EP=(12),PARM=(11)
*     END;                                                         0824
         SLR   @02,@02                                             0824
         BCTR  @02,0                                               0824
         AL    @02,LOOPCTR                                         0824
         ST    @02,LOOPCTR                                         0824
         LTR   @02,@02                                             0824
         BP    @DL00792                                            0824
@DC00792 DS    0H                                                  0825
*   END;                                                           0825
*                                                                  0825
@DE00767 TM    TCGNSET(TCWAPTR),B'00001000'                        0825
         BO    @DL00767                                            0825
*/********************************************************************/
*/*                                                                  */
*/* RETURN TO THE CALLER.                                            */
*/*                                                                  */
*/********************************************************************/
*                                                                  0826
*   END IEAVRSYN;                                                  0826
@EL00007 DS    0H                                                  0826
@EF00007 DS    0H                                                  0826
@ER00007 LM    @14,@12,12(@13)                                     0826
         BR    @14                                                 0826
*                                                                  0827
*/********************************************************************/
*/*                                                                  */
*/*             IEAVRNOT--VARY CPU OFFLINE NOTIFICATION              */
*/*                                                                  */
*/* THIS ROUTINE IS ENTERED FROM IEEVCPU WHENVER A CPU IS BEING      */
*/* VARY'ED OFFLINE.  IT CHECKS TO MAKE SURE THAT THE REMOVAL OF THE */
*/* SUBJECT CPU WILL NOT CAUSE THE LAST TOD CLOCK, CLOCK COMPARATOR, */
*/* OR CPU TIMER TO BE REMOVED FROM THE CONFIGURATION. IF REMOVAL OF */
*/* THE CPU WOULD CREATE SUCH A SITUATION, THE RETURN CODE IS SET TO */
*/* 4 TO INDICATE THAT THE VARY PROCESS SHOULD BE CANCELLED.  IF NOT,*/
*/* THE CPU CAN BE TAKEN OFFLINE.                                    */
*/*                                                                  */
*/* IF THE CPU BEING TAKEN OFFLINE IS TIMING A REAL TIME TQE, IT     */
*/* MUST BE ENSURED THE THE TQE WILL CONTINUE TO BE TIMED ON SOME    */
*/* CPU REMAINING ONLINE.                                            */
*/*                                                                  */
*/********************************************************************/
*                                                                  0827
*IEAVRNOT:                                                         0827
*   ENTRY(OLDPCCA);                                                0827
         B     @EC00827                                            0827
@EP00827 MVC   @PC00001+4(4),0(@01)                                0827
@EC00827 DS    0H                                                  0828
*   RESPECIFY                                                      0828
*     CVTMAP BASED(CVTPTR);                                        0828
*   R13SAV=REG13;                   /* SAVE THE SAVEAREA ADDRESS     */
         ST    REG13,R13SAV                                        0829
*/********************************************************************/
*/*                                                                  */
*/* SET UP THE INTERFACE TO FIX THE PAGE CONTAINING THE EXECUTING    */
*/* CODE AND ISSUE THE PAGE FIX SVC.                                 */
*/*                                                                  */
*/********************************************************************/
*                                                                  0830
*   REG1=ADDR(BEGNOT);              /* GET PTR TO START OF CODE      */
         LA    REG1,BEGNOT                                         0830
*   REG15=ADDR(ENDTOD);             /* GET PTR TO END OF MODULE      */
         LA    REG15,ENDTOD                                        0831
*   REG0=ADDR(TODECB);              /* GET ECB ADDRESS               */
         LA    REG0,TODECB                                         0832
*   TODECB=0;                       /* CLEAR ECB                     */
         SLR   @02,@02                                             0833
         ST    @02,TODECB                                          0833
*   GENERATE CODE(PGFIX R,A=(1),EA=(15),ECB=(0),LONG=N);           0834
*                                                                  0834
         PGFIX R,A=(1),EA=(15),ECB=(0),LONG=N
*/********************************************************************/
*/*                                                                  */
*/* WAIT FOR PAGE FIX.                                               */
*/*                                                                  */
*/********************************************************************/
*                                                                  0835
*   REG1=ADDR(TODECB);              /* GET ECB ADDRESS               */
         LA    REG1,TODECB                                         0835
*   GENERATE CODE(WAIT  1,ECB=(1));                                0836
*                                                                  0836
         WAIT  1,ECB=(1)
*/********************************************************************/
*/*                                                                  */
*/* GET DISPATCHER LOCK TO PROTECT REAL TQE AND FOR INVOKING SETCC   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0837
*   GENERATE CODE REFS(PSALITA);                                   0837
*                                                                  0837
*                            /*
         SETLOCK OBTAIN,TYPE=DISP,MODE=UNCOND,                        **
               RELATED=('REQUIRED BY SETCC',(IEAVRTOD,(NOLABEL))) */
*/********************************************************************/
*/*                                                                  */
*/* GET ADDRESSABILITY TO CSD, AND TO PCCA OF CPU GOING OFFLINE.     */
*/*                                                                  */
*/********************************************************************/
*                                                                  0838
*BEGNOT:                                                           0838
*   REG12=CVTCSD;                   /* ADDRESSABILITY TO CSD         */
BEGNOT   L     @02,CVTPTR                                          0838
         L     REG12,CVTCSD(,@02)                                  0838
*   RESPECIFY                                                      0839
*     CSD BASED(REG12);                                            0839
*   REG11=ADDR(OLDPCCA);            /* ADDRESSABILITY TO PCCA        */
         L     REG11,@PC00001+4                                    0840
*   RESPECIFY                                                      0841
*     PCCA BASED(REG11);                                           0841
*   RETCODE=0;                      /* INITIALIZE RETURN CODE        */
         SLR   RETCODE,RETCODE                                     0842
*/********************************************************************/
*/*                                                                  */
*/* SEE IF THE TOD CLOCK IN THE CPU GOING OFFLINE IS PERMANENTLY     */
*/* DAMAGED.                                                         */
*/*                                                                  */
*/********************************************************************/
*                                                                  0843
*   IF PCCANFTD='0'B THEN                                          0843
*                                                                  0843
         TM    PCCANFTD(REG11),B'01000000'                         0843
         BNZ   @RF00843                                            0843
*/********************************************************************/
*/*                                                                  */
*/* IF NOT, SEE IF IT IS THE LAST GOOD TOD CLOCK IN THE CONFIGURATION*/
*/*                                                                  */
*/********************************************************************/
*                                                                  0844
*     DO;                                                          0844
*LASTTODC:                                                         0845
*       IF CSDGDTOD=1 THEN          /* IF LAST GOOD TOD CLOCK,       */
LASTTODC CLC   CSDGDTOD(4,REG12),@CF00096                          0845
         BNE   @RF00845                                            0845
*         RETCODE=4;                /* INDICATE TO CANCEL THE VARY   */
         LA    RETCODE,4                                           0846
*       ELSE                                                       0847
*         DO;                       /* IF NOT LAST GOOD TOD CLOCK,   */
         B     @RC00845                                            0847
@RF00845 DS    0H                                                  0848
*           CURRENT=CSDGDTOD;       /* GET CURRENT COUNT             */
         L     CURRENT,CSDGDTOD(,REG12)                            0848
*           NEW=CURRENT-1;                                         0849
         LR    NEW,CURRENT                                         0849
         BCTR  NEW,0                                               0849
*           CS(CURRENT,NEW,CSDGDTOD);/* DECREMENT BY 1               */
         CS    CURRENT,@01,CSDGDTOD(REG12)                         0850
*           BC(7,LASTTODC);                                        0851
         BC    7,LASTTODC                                          0851
*           PCCATODE='FF'X;         /* INDICATE ERROR COUNT CHANGED  */
         MVI   PCCATODE(REG11),X'FF'                               0852
*         END;                                                     0853
*     END;                                                         0854
*                                                                  0854
@RC00845 DS    0H                                                  0855
*/********************************************************************/
*/*                                                                  */
*/* TEST FOR THE VARY PROCESS NOT YET HAVING BEEN CANCELLED.         */
*/*                                                                  */
*/********************************************************************/
*                                                                  0855
*   IF RETCODE=0 THEN                                              0855
*                                                                  0855
@RF00843 LTR   RETCODE,RETCODE                                     0855
         BNZ   @RF00855                                            0855
*/********************************************************************/
*/*                                                                  */
*/* IF NOT YET CANCELLED, CHECK THE CLOCK COMPARATOR FOR PERMANENT   */
*/* DAMAGE.                                                          */
*/*                                                                  */
*/********************************************************************/
*                                                                  0856
*     DO;                                                          0856
*       IF PCCANFCC='0'B THEN                                      0857
*                                                                  0857
         TM    PCCANFCC(REG11),B'01000000'                         0857
         BNZ   @RF00857                                            0857
*/********************************************************************/
*/*                                                                  */
*/* IF O.K., SEE IF IT IS THE LAST GOOD CLOCK COMPARATOR IN THE      */
*/* CONFIGURATION.                                                   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0858
*         DO;                                                      0858
*LASTCC:                                                           0859
*           IF CSDGDCC=1 THEN       /* IF LAST GOOD CLOCK COMPARATOR */
LASTCC   CLC   CSDGDCC(4,REG12),@CF00096                           0859
         BNE   @RF00859                                            0859
*             RETCODE=4;            /* INDICATE TO CANCEL THE VARY   */
         LA    RETCODE,4                                           0860
*           ELSE                                                   0861
*             DO;                   /* IF NOT LAST GOOD CLOCK      0861
*                                      COMPARATOR,                   */
         B     @RC00859                                            0861
@RF00859 DS    0H                                                  0862
*               CURRENT=CSDGDCC;    /* GET CURRENT COUNT             */
         L     CURRENT,CSDGDCC(,REG12)                             0862
*               NEW=CURRENT-1;                                     0863
         LR    NEW,CURRENT                                         0863
         BCTR  NEW,0                                               0863
*               CS(CURRENT,NEW,CSDGDCC);/* DECREMENT BY 1            */
         CS    CURRENT,@01,CSDGDCC(REG12)                          0864
*               BC(7,LASTCC);                                      0865
         BC    7,LASTCC                                            0865
*               PCCACCE='FF'X;      /* INDICATE ERROR COUNT CHANGED  */
         MVI   PCCACCE(REG11),X'FF'                                0866
*             END;                                                 0867
*         END;                                                     0868
*                                                                  0868
@RC00859 DS    0H                                                  0869
*/********************************************************************/
*/*                                                                  */
*/* TEST FOR VARY PROCESS NOT YET HAVING BEEN CANCELLED.             */
*/*                                                                  */
*/********************************************************************/
*                                                                  0869
*       IF RETCODE=0 THEN                                          0869
*                                                                  0869
@RF00857 LTR   RETCODE,RETCODE                                     0869
         BNZ   @RF00869                                            0869
*/********************************************************************/
*/*                                                                  */
*/* IF NOT YET CANCELLED, CHECK CPU TIMER FOR PERMANENT DAMAGE.      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0870
*         DO;                                                      0870
*           IF PCCANFIN='0'B THEN                                  0871
*                                                                  0871
         TM    PCCANFIN(REG11),B'01000000'                         0871
         BNZ   @RF00871                                            0871
*/********************************************************************/
*/*                                                                  */
*/* IF O.K., SEE IF IT IS THE LAST CPU TIMER IN THE CONFIGURATION.   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0872
*             DO;                                                  0872
*LASTCPUT:                                                         0873
*               IF CSDGDINT=1 THEN  /* IF LAST GOOD CPU TIMER,       */
LASTCPUT CLC   CSDGDINT(4,REG12),@CF00096                          0873
         BNE   @RF00873                                            0873
*                 RETCODE=4;        /* INDICATE TO CANCEL THE VARY   */
         LA    RETCODE,4                                           0874
*               ELSE                                               0875
*                 DO;               /* IF NOT LAST GOOD CPU TIMER,   */
         B     @RC00873                                            0875
@RF00873 DS    0H                                                  0876
*                   CURRENT=CSDGDINT;/* GET CURRENT COUNT            */
         L     CURRENT,CSDGDINT(,REG12)                            0876
*                   NEW=CURRENT-1;                                 0877
         LR    NEW,CURRENT                                         0877
         BCTR  NEW,0                                               0877
*                   CS(CURRENT,NEW,CSDGDINT);/* DECREMENT BY 1       */
         CS    CURRENT,@01,CSDGDINT(REG12)                         0878
*                   BC(7,LASTCPUT);                                0879
         BC    7,LASTCPUT                                          0879
*                   PCCAINTE='FF'X; /* INDICATE ERROR COUNT CHANGED  */
         MVI   PCCAINTE(REG11),X'FF'                               0880
*                 END;                                             0881
*             END;                                                 0882
@RC00873 DS    0H                                                  0883
*         END;                                                     0883
@RF00871 DS    0H                                                  0884
*     END;                                                         0884
*                                                                  0884
@RF00869 DS    0H                                                  0885
*/********************************************************************/
*/*                                                                  */
*/* SAVE THE RETURN CODE ACROSS POTENTIAL DESTRUCTIVE INTERFACES.    */
*/* IF THE CPU IS GOING OFFLINE AND IT IS TIMING A REAL TIME TQE,    */
*/* ENSURE THAT THE TQE WILL BE TIMED ON SOME OTHER CPU REMAINING    */
*/* ONLINE.                                                          */
*/*                                                                  */
*/********************************************************************/
*                                                                  0885
*   REG3=RETCODE;                   /*                       @YM04766*/
@RF00855 LR    REG3,RETCODE                                        0885
*   IF RETCODE=0&PCCATQEP^=0 THEN                                  0886
         SLR   @02,@02                                             0886
         CR    RETCODE,@02                                         0886
         BNE   @RF00886                                            0886
         L     @07,PCCATQEP(,REG11)                                0886
         CR    @07,@02                                             0886
         BE    @RF00886                                            0886
*     DO;                                                          0887
*       PCCATQEP->TQECOMP='0'B;     /* INDICATE TQE NOT BEING TIMED  */
         NI    TQECOMP(@07),B'01111111'                            0888
*       PCCATQEP=0;                 /* INDICATE THIS CPU NOT TIMING A
*                                      TQE                           */
         ST    @02,PCCATQEP(,REG11)                                0889
*       REG15=TPCCKQ;               /* GET ADRESS OF SETCC           */
         L     @02,CVTPTR                                          0890
         L     @02,TPCPTR(,@02)                                    0890
         L     REG15,TPCCKQ(,@02)                                  0890
*       GENERATE CODE REFS(REG15) SETS(REG2)(BALR  REG2,REG15);    0891
         BALR  REG2,REG15
*     END;                                                         0892
*                                                                  0892
*/********************************************************************/
*/*                                                                  */
*/* RELEASE DISPATCHER LOCK.                                         */
*/*                                                                  */
*/********************************************************************/
*                                                                  0893
*   GENERATE CODE REFS(PSALITA);                                   0893
*                                                                  0893
@RF00886 DS    0H                                                  0893
*                              /*
         SETLOCK RELEASE,TYPE=DISP,                                   **
               RELATED=('REQUIRED BY SETCC',(IEAVRTOD,(NOLABEL)))  */
*/********************************************************************/
*/*                                                                  */
*/* RELEASE FIXED PAGE.                                              */
*/*                                                                  */
*/********************************************************************/
*                                                                  0894
*   REG1=ADDR(BEGNOT);              /* GET PTR TO BEGINNING OF CODE  */
         LA    REG1,BEGNOT                                         0894
*   REG15=ADDR(ENDTOD);             /* GET PTR TO END OF MODULE      */
         LA    REG15,ENDTOD                                        0895
*   GENERATE CODE(PGFREE R,A=(1),EA=(15));                         0896
*                                                                  0896
         PGFREE R,A=(1),EA=(15)
*/********************************************************************/
*/*                                                                  */
*/* RESTORE THE SAVEAREA ADDRESS, AND RETURN TO IEEVCPU.             */
*/*                                                                  */
*/********************************************************************/
*                                                                  0897
*   REG13=R13SAV;                                                  0897
         L     REG13,R13SAV                                        0897
*   RETURN CODE(REG3);              /*                       @YM04766*/
         L     @13,4(,@13)                                         0898
         L     @00,@SIZDATD                                        0898
         LR    @01,@08                                             0898
         FREEMAIN R,LV=(0),A=(1)
         LR    @15,@03                                             0898
         L     @14,12(,@13)                                        0898
         LM    @00,@12,20(@13)                                     0898
         BR    @14                                                 0898
*                                                                  0899
*/********************************************************************/
*/*                                                                  */
*/*             IEAVRCAN--VARY CPU OFFLINE CANCELLATION              */
*/*                                                                  */
*/* THIS ROUTINE IS ENTERED FROM IEEVCPU WHENEVER A VARY CPU OFFLINE */
*/* COMMAND HAS BEEN INTERNALLY CANCELLED, AND ROUTINE IEAVRNOT HAS  */
*/* PREVIOUSLY RECEIVED CONTROL.  IT RESETS THE COUNTS IN THE CSD    */
*/* AND THE ERROR COUNTS IN THE PCCA FOR ANY TIMING COMPONENTS WHICH */
*/* HAD THESE FIELDS CHANGED BY ROUTINE IEAVRNOT.                    */
*/*                                                                  */
*/********************************************************************/
*                                                                  0899
*IEAVRCAN:                                                         0899
*   ENTRY(OLDPCCA);                                                0899
@EP00899 MVC   @PC00001+4(4),0(@01)                                0899
*   REG12=CVTCSD;                   /* ADDRESSABILITY TO CSD         */
         L     @02,CVTPTR                                          0900
         L     REG12,CVTCSD(,@02)                                  0900
*   REG11=ADDR(OLDPCCA);            /* ADDRESSABILITY TO PCCA        */
         L     REG11,@PC00001+4                                    0901
*/********************************************************************/
*/*                                                                  */
*/* SEE IF THE TOD CLOCK ERROR COUNT WAS CHANGED BY IEAVRNOT.        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0902
*   IF PCCATODE='FF'X THEN                                         0902
         CLI   PCCATODE(REG11),255                                 0902
         BNE   @RF00902                                            0902
*     DO;                           /* IF SO,                        */
*       PCCATODE='00'X;             /* RESET ERROR COUNT             */
         MVI   PCCATODE(REG11),X'00'                               0904
*CURRTODC:                                                         0905
*       CURRENT=CSDGDTOD;           /* GET COUNT OF GOOD TOD CLOCKS  */
CURRTODC L     CURRENT,CSDGDTOD(,REG12)                            0905
*       NEW=CURRENT+1;                                             0906
         LA    NEW,1                                               0906
         ALR   NEW,CURRENT                                         0906
*       CS(CURRENT,NEW,CSDGDTOD);   /* INCREMENT COUNT BY 1          */
         CS    CURRENT,@01,CSDGDTOD(REG12)                         0907
*       BC(7,CURRTODC);                                            0908
         BC    7,CURRTODC                                          0908
*     END;                                                         0909
*                                                                  0909
*/********************************************************************/
*/*                                                                  */
*/* SEE IF THE CLOCK COMPARATOR ERROR COUNT WAS CHANGED BY IEAVRNOT. */
*/*                                                                  */
*/********************************************************************/
*                                                                  0910
*   IF PCCACCE='FF'X THEN                                          0910
@RF00902 CLI   PCCACCE(REG11),255                                  0910
         BNE   @RF00910                                            0910
*     DO;                           /* IF SO,                        */
*       PCCACCE='00'X;              /* RESET ERROR COUNT             */
         MVI   PCCACCE(REG11),X'00'                                0912
*CURRCC:                                                           0913
*       CURRENT=CSDGDCC;            /* GET COUNT OF GOOD CLOCK     0913
*                                      COMPARATORS                   */
CURRCC   L     CURRENT,CSDGDCC(,REG12)                             0913
*       NEW=CURRENT+1;                                             0914
         LA    NEW,1                                               0914
         ALR   NEW,CURRENT                                         0914
*       CS(CURRENT,NEW,CSDGDCC);    /* INCREMENT COUNT BY 1          */
         CS    CURRENT,@01,CSDGDCC(REG12)                          0915
*       BC(7,CURRCC);                                              0916
         BC    7,CURRCC                                            0916
*     END;                                                         0917
*                                                                  0917
*/********************************************************************/
*/*                                                                  */
*/* SEE IF THE CPU TIMER ERROR COUNT WAS CHANGED BY IEAVRNOT.        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0918
*   IF PCCAINTE='FF'X THEN                                         0918
@RF00910 CLI   PCCAINTE(REG11),255                                 0918
         BNE   @RF00918                                            0918
*     DO;                                                          0919
*       PCCAINTE='00'X;             /* RESET ERROR COUNT             */
         MVI   PCCAINTE(REG11),X'00'                               0920
*CURRCPUT:                                                         0921
*       CURRENT=CSDGDINT;           /* GET COUNT OF GOOD CPU TIMERS  */
CURRCPUT L     CURRENT,CSDGDINT(,REG12)                            0921
*       NEW=CURRENT+1;                                             0922
         LA    NEW,1                                               0922
         ALR   NEW,CURRENT                                         0922
*       CS(CURRENT,NEW,CSDGDINT);   /* INCREMENT COUNT BY 1          */
         CS    CURRENT,@01,CSDGDINT(REG12)                         0923
*       BC(7,CURRCPUT);                                            0924
         BC    7,CURRCPUT                                          0924
*     END;                                                         0925
*   RETURN;                                                        0926
@EL00001 L     @13,4(,@13)                                         0926
@EF00001 L     @00,@SIZDATD                                        0926
         LR    @01,@08                                             0926
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0926
         BR    @14                                                 0926
*   RESPECIFY                                                      0927
*     CSD BASED(CVTCSD);                                           0927
*                                                                  0928
*/********************************************************************/
*/*                                                                  */
*/*          IEAVRCLA--TIMING COMPONENT HARDWARE RECOVERY            */
*/*                                                                  */
*/* THIS ROUTINE IS SCHEDULED INTO THE MASTER MEMORY BY AN SRB THAT  */
*/* IS SCHEDULED BY ROUTINE IEAVRCLS, AND IS SUBSEQUENTLY GIVEN      */
*/* CONTROL BY THE DISPATCHER.                                       */
*/*                                                                  */
*/* AFTER SAVING THE RETURN ADDRESS, IT BEGINS A SCAN OF THE PCCA    */
*/* VECTOR TABLE SEARCHING FOR NON-ZERO ENTRIES.  WHEN ONE IS FOUND, */
*/* IT DETERMINES IF ANY OF THE 3 TIMING COMPONENTS FOR THE CPU REP- */
*/* RESENTED BY THAT PCCA REQUIRES RECOVERY, AND IF SO, TAKES APPRO- */
*/* PRIATE RECOVERY MEASURES.                                        */
*/*                                                                  */
*/* WHEN ALL PCCAVT ENTRIES HAVE BEEN SCANNED, IT GOES TO THE SET    */
*/* CLOCK COMPARATOR ROUTINE TO ENSURE THAT THE TOP REAL TIME TQE IS */
*/* BEING TIMED.  THEN, USING COMPARE AND SWAP ON THE PARAMETER      */
*/* FIELD IN THE SRB THAT WAS USED TO SCHEDULE IT, A TEST IS MADE TO */
*/* DETERMINE IF FURTHER ERRORS HAVE OCCURRED WHILE IT WAS PROCESS-  */
*/* ING.  IF THEY HAVE, IEAVRCLA BEGINS A NEW SCAN OF THE PCCAVT.    */
*/* IF NO NEW ERRORS OCCURRED, IT RETURNS TO THE DISPATCHER.         */
*/*                                                                  */
*/********************************************************************/
*                                                                  0928
*IEAVRCLA:                                                         0928
*   RESPECIFY                                                      0928
*    (PCCAPTR,                                                     0928
*     SLOTCNT,                                                     0928
*     REG2,                                                        0928
*     REG9) RESTRICTED;                                            0928
IEAVRCLA DS    0H                                                  0929
*   GENERATE CODE REFS(REG8,REG10) SETS(REG9);                     0929
*                                                                  0929
         DROP  REG9                 DROP FIRST CODEREG
         BALR  REG9,0               ESTABLISH ADDRESSABILITY
         USING *,REG9
         DROP  REG8                 DROP DATAREG
         DROP  REG10                DROP SECOND CODEREG
*/********************************************************************/
*/*                                                                  */
*/* SET UP THE INTERFACE TO GET THE PAGE CONTAINING IEAVRCLA FIXED.  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0930
*CLABSLBL:                                                         0930
*   REG1=ADDR(SETTC);               /* GET POINTER TO START OF     0930
*                                      IEAVRCLA                      */
CLABSLBL LA    REG1,SETTC                                          0930
*   REG15=ADDR(ENDTOD);             /* GET POINTER TO END OF IEAVRTOD*/
         LA    REG15,ENDTOD                                        0931
*   REG0=ADDR(CLAECB);              /* GET ADDRESS OF ECB            */
         LA    REG0,CLAECB                                         0932
*   CLAECB=0;                       /* INITIALIZE ECB                */
         SLR   @07,@07                                             0933
         ST    @07,CLAECB                                          0933
*/********************************************************************/
*/*                                                                  */
*/* ISSUE THE PAGE FIX SVC.                                          */
*/*                                                                  */
*/********************************************************************/
*                                                                  0934
*   GENERATE CODE(PGFIX R,A=(1),EA=(15),ECB=(0),LONG=N);           0934
*                                                                  0934
         PGFIX R,A=(1),EA=(15),ECB=(0),LONG=N
*/********************************************************************/
*/*                                                                  */
*/* WAIT ON PAGE FIX.                                                */
*/*                                                                  */
*/********************************************************************/
*                                                                  0935
*   GENERATE CODE SETS(CLAECB)(WAIT  1,ECB=CLAECB);                0935
*                                                                  0935
         WAIT  1,ECB=CLAECB
*/********************************************************************/
*/*                                                                  */
*/* ESTABLISH ERROR EXIT FOR UNLOCKED CODE.                          */
*/*                                                                  */
*/********************************************************************/
*                                                                  0936
*   REG2=ADDR(CLAESTAE);            /* GET EXIT ADDRESS              */
         LA    REG2,CLAESTAE                                       0936
*   GEN CODE REFS(REG2,REG3)(ESTAE (2),CT,PURGE=NONE,RECORD=YES);  0937
*                                                                  0937
         ESTAE (2),CT,PURGE=NONE,RECORD=YES
*/********************************************************************/
*/*                                                                  */
*/* RE-BASE THE CVT AND CSD FOR MORE EFFICIENT CODE GENERATION.      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0938
*   CLACVTP=CVTPTR;                 /* GET POINTER TO CVT            */
         L     CLACVTP,CVTPTR                                      0938
*   RESPECIFY                                                      0939
*     CVTMAP BASED(CLACVTP);                                       0939
*   REG3=CVTCSD;                    /* GET POINTER TO CSD            */
         L     REG3,CVTCSD(,CLACVTP)                               0940
*   RESPECIFY                                                      0941
*     CSD BASED(REG3);                                             0941
*                                                                  0941
*/********************************************************************/
*/*                                                                  */
*/* INDICATE THAT THE SEARCH CYCLE HAS BEGUN                         */
*/*                                                                  */
*/********************************************************************/
*                                                                  0942
*SETTC:                                                            0942
*   SRBPTR=ADDR(TPCRSRB);           /* GET ADDRESSABILITY TO RECOVERY
*                                      SRB                           */
SETTC    L     SRBPTR,TPCPTR(,CLACVTP)                             0942
         LA    SRBPTR,TPCRSRB(,SRBPTR)                             0942
*   CLATC='0'B;                                                    0943
         NI    CLATC(SRBPTR),B'11111110'                           0943
*   CLABND='0'B;                    /* INITIALIZE ABEND-REAL-TQE'S 0944
*                                      INDICATOR                     */
         NI    CLABND,B'01111111'                                  0944
*/********************************************************************/
*/*                                                                  */
*/* SEARCH THE TIMER STATUS BYTES OF ALL PHYSICAL CCA'S LOOKING FOR  */
*/* THOSE WHICH INDICATE THAT AN ERROR HAS OCCURRED FOR WHICH RECOV- */
*/* ERY HAS NOT YET BEEN ATTEMPTED.                                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0945
*   REG2=CVTPCCAT;                  /* GET PTR TO PCCAVT             */
         L     REG2,CVTPCCAT(,CLACVTP)                             0945
*   RESPECIFY                                                      0946
*     PTRPCCA BASED(REG2);                                         0946
*   DO SLOTCNT=DIM(PCCAT00P) TO 1 BY-1;                            0947
*                                                                  0947
         LA    SLOTCNT,16                                          0947
@DL00947 DS    0H                                                  0948
*/********************************************************************/
*/*                                                                  */
*/* SEE IF THE NEXT PCCA VECTOR TABLE SLOT IS NON-ZERO, INDICATING   */
*/* THAT THE PCCA EXISTS.                                            */
*/*                                                                  */
*/********************************************************************/
*                                                                  0948
*     IF PTRPCCA^=0 THEN                                           0948
         L     @07,PTRPCCA(,REG2)                                  0948
         LTR   @07,@07                                             0948
         BZ    @RF00948                                            0948
*       DO;                                                        0949
*                                                                  0949
*/********************************************************************/
*/*                                                                  */
*/* IF SO, ESTABLISH ADDRESSABILTIY TO THE PCCA.                     */
*/*                                                                  */
*/********************************************************************/
*                                                                  0950
*         PCCAPTR=PTRPCCA;                                         0950
         LR    PCCAPTR,@07                                         0950
*         RESPECIFY                                                0951
*           PCCA BASED(PCCAPTR);                                   0951
*                                                                  0951
*/********************************************************************/
*/*                                                                  */
*/* CHECK THE TOD CLOCK STATUS BITS TO DETERMINE IF THE CLOCK RE-    */
*/* QUIRES RECOVERY.                                                 */
*/*                                                                  */
*/********************************************************************/
*                                                                  0952
*         IF PCCANUTD='1'B&PCCANFTD='0'B THEN                      0952
*                                                                  0952
         TM    PCCANUTD(PCCAPTR),B'10000000'                       0952
         BNO   @RF00952                                            0952
         TM    PCCANFTD(PCCAPTR),B'01000000'                       0952
         BNZ   @RF00952                                            0952
*/********************************************************************/
*/*                                                                  */
*/* IF SO, INDICATE THAT NO FURTHER ATTEMPTS SHOULD BE MADE TO FIX   */
*/* THE CLOCK AND SUBTRACT ONE FROM THE NUMBER OF GOOD TOD CLOCKS    */
*/* IN THE CONFIGURATION.                                            */
*/*                                                                  */
*/********************************************************************/
*                                                                  0953
*           DO;                                                    0953
*             PCCANFTD='1'B;        /* INDICATE NOT TO FIX THE CLOCK */
         OI    PCCANFTD(PCCAPTR),B'01000000'                       0954
*             CURRENT=CSDGDTOD;                                    0955
         L     CURRENT,CSDGDTOD(,REG3)                             0955
*SUB2:                                                             0956
*             NEW=CURRENT-1;                                       0956
SUB2     LR    NEW,CURRENT                                         0956
         BCTR  NEW,0                                               0956
*             CS(CURRENT,NEW,CSDGDTOD);                            0957
         CS    CURRENT,@01,CSDGDTOD(REG3)                          0957
*             BC(7,SUB2);                                          0958
*                                                                  0958
         BC    7,SUB2                                              0958
*/********************************************************************/
*/*                                                                  */
*/* SET REGISTER 13 TO THE ADDRESS OF                                */
*/* THE SAVEAREA, REGISTER 1 TO THE ADDRESS OF THE OF A FULL WORD    */
*/* CONTAINING A POINTER TO THE PCCA, AND REGISTER 0 TO 1 TO INDI-   */
*/* CATE THAT THE CALLER IS ASYNCHRONOUS RECOVERY.  THEN CALL THE    */
*/* ROUTINE TO RESET OR RE-SYNCHRONIZE THE CLOCK.                    */
*/*                                                                  */
*/********************************************************************/
*                                                                  0959
*             REG13=ADDR(CLASAV);                                  0959
         LA    REG13,CLASAV                                        0959
*             REG1=REG2;                                           0960
         LR    REG1,REG2                                           0960
*             REG0=1;                                              0961
         LA    REG0,1                                              0961
*             CALL IEAVRSSC;                                       0962
*                                                                  0962
         L     @15,@CA02635                                        0962
         BALR  @14,@15                                             0962
*/********************************************************************/
*/*                                                                  */
*/* SEE IF THE CLOCK WAS SUCCESSFULLY RECOVERED.                     */
*/*                                                                  */
*/********************************************************************/
*                                                                  0963
*             IF RETCODE=0 THEN                                    0963
*                                                                  0963
         LTR   RETCODE,RETCODE                                     0963
         BNZ   @RF00963                                            0963
*/********************************************************************/
*/*                                                                  */
*/* IF IT WAS RECOVERED, INDICATE THAT IT IS NOW ALL RIGHT TO ATTEMPT*/
*/* TO RECOVER THE CLOCK IF IT FAILS AGAIN, AND ADD ONE TO THE COUNT */
*/* OF ERRORS FOR THIS CLOCK.                                        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0964
*               DO;                                                0964
*                 PCCANFTD='0'B;    /* INDICATE CLOCK CAN BE FIXED   */
         NI    PCCANFTD(PCCAPTR),B'10111111'                       0965
*                 PCCATODE=PCCATODE+ERRINCR;/* BUMP TOD CLOCK ERR  0966
*                                      COUNT                         */
         LA    @07,32                                              0966
         SLR   @06,@06                                             0966
         IC    @06,PCCATODE(,PCCAPTR)                              0966
         ALR   @07,@06                                             0966
         STC   @07,PCCATODE(,PCCAPTR)                              0966
*               END;                                               0967
*             CLACVTP=CVTPTR;       /* RESTORE BASE FOR CVT          */
@RF00963 L     CLACVTP,CVTPTR                                      0968
*/********************************************************************/
*/*                                                                  */
*/* SEE IF THE NO-FIX BIT IS ON. (NOTE: THIS BIT MAY HAVE BEEN TURNED*/
*/* BACK ON AS A RESULT OF BUMPING THE ERROR COUNT.)                 */
*/*                                                                  */
*/********************************************************************/
*                                                                  0969
*             IF PCCANFTD='1'B THEN                                0969
*                                                                  0969
         TM    PCCANFTD(PCCAPTR),B'01000000'                       0969
         BNO   @RF00969                                            0969
*/********************************************************************/
*/*                                                                  */
*/* IF IT IS ON, SEE IF THE COMPARABLE BIT FOR THE CLOCK COMPARATOR  */
*/* IS OFF.  (NOTE: IF THE CLOCK WAS NOT RECOVERED, OR THIS WAS THE  */
*/* NTH FAILURE ON IT, THE CLOCK IS CONSIDERED TO BE PERMANENTLY     */
*/* DAMAGED, AND WILL NOT BE USED ANY MORE.  IF IT CANNOT BE USED,   */
*/* THE CLOCK COMPARATOR MUST ALSO NOT BE USED, AND THE COUNT OF     */
*/* GOOD CLOCK COMPARATORS IN THE CONFIGURATION MUST BE DECREMENTED, */
*/* UNLESS THE CLOCK COMPARATOR WAS ALREADY PERMANENTLY DAMAGED.)    */
*/*                                                                  */
*/********************************************************************/
*                                                                  0970
*               DO;                                                0970
*                 IF PCCANFCC='0'B THEN                            0971
*                                                                  0971
         TM    PCCANFCC(PCCAPTR),B'01000000'                       0971
         BNZ   @RF00971                                            0971
*/********************************************************************/
*/*                                                                  */
*/* INDICATE THAT THE CLOCK COMPARATOR SHOULD NOT BE RECOVERED, AND  */
*/* DECREMENT THE COUNT OF GOOD CLOCK COMPARATORS.                   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0972
*                   DO;                                            0972
*                     PCCANFCC='1'B;                               0973
         OI    PCCANFCC(PCCAPTR),B'01000000'                       0973
*                     CURRENT=CSDGDCC;                             0974
         L     CURRENT,CSDGDCC(,REG3)                              0974
*SUB3:                                                             0975
*                     NEW=CURRENT-1;                               0975
SUB3     LR    NEW,CURRENT                                         0975
         BCTR  NEW,0                                               0975
*                     CS(CURRENT,NEW,CSDGDCC);                     0976
         CS    CURRENT,@01,CSDGDCC(REG3)                           0976
*                     BC(7,SUB3);                                  0977
         BC    7,SUB3                                              0977
*                   END;                                           0978
*                                                                  0978
*/********************************************************************/
*/*                                                                  */
*/* ASSEMBLE THE ERROR MSG, AND TELL THE OPERATOR THAT THE TOD CLOCK */
*/* IS PERMANENTLY DAMAGED.                                          */
*/*                                                                  */
*/********************************************************************/
*                                                                  0979
*                 CVD(PCCACPUA,CVRTAREA);                          0979
@RF00971 LH    @07,PCCACPUA(,PCCAPTR)                              0979
         CVD   @07,CVRTAREA                                        0979
*                 WPLPTR=ADDR(EMSGTOD);                            0980
         LA    WPLPTR,EMSGTOD                                      0980
*                 UNPK(CPUADDRE,CVRTAREA(7:8));                    0981
         UNPK  CPUADDRE(2,WPLPTR),CVRTAREA+6(2)                    0981
*                 CPUADDRE(2)=CPUADDRE(2)×'F0'X;                   0982
         OI    CPUADDRE+1(WPLPTR),X'F0'                            0982
*                 GENERATE CODE(WTO MF=(E,(1)));                   0983
         WTO MF=(E,(1))
*               END;                                               0984
*             ELSE                                                 0985
*                                                                  0985
*/********************************************************************/
*/*                                                                  */
*/* IF THE NO-FIX BIT IS STILL OFF, INDICATING THAT THE CLOCK IS     */
*/* USEABLE, TURN OFF THE NO-USE BIT TO INDICATE SO, AND INCREMENT   */
*/* THE COUNT OF GOOD TOD CLOCKS.                                    */
*/*                                                                  */
*/********************************************************************/
*                                                                  0985
*               DO;                                                0985
         B     @RC00969                                            0985
@RF00969 DS    0H                                                  0986
*                 PCCANUTD='0'B;                                   0986
         NI    PCCANUTD(PCCAPTR),B'01111111'                       0986
*                 CURRENT=CSDGDTOD;                                0987
         L     CURRENT,CSDGDTOD(,REG3)                             0987
*ADD6:                                                             0988
*                 NEW=CURRENT+1;                                   0988
ADD6     LA    NEW,1                                               0988
         ALR   NEW,CURRENT                                         0988
*                 CS(CURRENT,NEW,CSDGDTOD);                        0989
         CS    CURRENT,@01,CSDGDTOD(REG3)                          0989
*                 BC(7,ADD6);                                      0990
*                                                                  0990
         BC    7,ADD6                                              0990
*/********************************************************************/
*/*                                                                  */
*/* NOW SEE IF THE CLOCK COMPARATOR WAS PERMANENTLY DAMAGED.         */
*/*                                                                  */
*/********************************************************************/
*                                                                  0991
*                 IF PCCANFCC='0'B THEN                            0991
*                                                                  0991
         TM    PCCANFCC(PCCAPTR),B'01000000'                       0991
         BNZ   @RF00991                                            0991
*/********************************************************************/
*/*                                                                  */
*/* IF NOT, INDICATE THAT THE CLOCK COMPARATOR IS NOW USEABLE, AND   */
*/* THAT TASKS WITH REAL TQE'S NO LONGER NEED BE ABEND'ED SINCE THERE*/
*/* IS NOW A GOOD TOD CLOCK AND CLOCK COMPARATOR IN THE SYSTEM.      */
*/* (NOTE: THE CLOCK COMPARATOR WAS MARKED UNUSEABLE BY IEAVRCLS     */
*/* WHEN THE TOD CLOCK FAILED.)                                      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0992
*                   DO;                                            0992
*                     PCCANUCC='0'B;                               0993
         NI    PCCANUCC(PCCAPTR),B'01111111'                       0993
*                     CLABND='1'B;                                 0994
         OI    CLABND,B'10000000'                                  0994
*                   END;                                           0995
*               END;                                               0996
@RF00991 DS    0H                                                  0997
*           END;                                                   0997
@RC00969 DS    0H                                                  0998
*                                                                  0998
*/********************************************************************/
*/*                                                                  */
*/* NOW CHECK THE CLOCK COMPARATOR STATUS BITS TO DETERMINE IF THE   */
*/* CLOCK COMPARATOR REQUIRES RECOVERY.                              */
*/*                                                                  */
*/********************************************************************/
*                                                                  0998
*         IF PCCANUCC='1'B&PCCANFCC='0'B THEN                      0998
*                                                                  0998
@RF00952 TM    PCCANUCC(PCCAPTR),B'10000000'                       0998
         BNO   @RF00998                                            0998
         TM    PCCANFCC(PCCAPTR),B'01000000'                       0998
         BNZ   @RF00998                                            0998
*/********************************************************************/
*/*                                                                  */
*/* IF S0, TEST TO SEE IF SYNCHRONOUS RECOVERY HAS BEEN UNABLE TO    */
*/* RECOVER THE ERROR.                                               */
*/*                                                                  */
*/********************************************************************/
*                                                                  0999
*           DO;                                                    0999
*             IF PCCAMCC='1'B THEN                                 1000
*                                                                  1000
         TM    PCCAMCC(PCCAPTR),B'00010000'                        1000
         BNO   @RF01000                                            1000
*/********************************************************************/
*/*                                                                  */
*/* IF SO, INDICATE THAT NO FURTHER ATTEMPTS SHOULD BE MADE TO RE-   */
*/* COVER THE CLOCK COMPARATOR.  THEN, DECREMENT THE COUNT OF GOOD   */
*/* CLOCK COMPARATORS BY 1.                                          */
*/*                                                                  */
*/********************************************************************/
*                                                                  1001
*               DO;                                                1001
*                 PCCANFCC='1'B;                                   1002
         OI    PCCANFCC(PCCAPTR),B'01000000'                       1002
*                 CURRENT=CSDGDCC;                                 1003
         L     CURRENT,CSDGDCC(,REG3)                              1003
*SUB4:                                                             1004
*                 NEW=CURRENT-1;                                   1004
SUB4     LR    NEW,CURRENT                                         1004
         BCTR  NEW,0                                               1004
*                 CS(CURRENT,NEW,CSDGDCC);                         1005
         CS    CURRENT,@01,CSDGDCC(REG3)                           1005
*                 BC(7,SUB4);                                      1006
         BC    7,SUB4                                              1006
*                 PCCAMCC='0'B;                                    1007
*                                                                  1007
         NI    PCCAMCC(PCCAPTR),B'11101111'                        1007
*/********************************************************************/
*/*                                                                  */
*/* ASSEMBLE THE ERROR MSG, AND TELL THE OPERATOR THAT THE CLOCK     */
*/* COMPARATOR IS PERMANENTLY DAMAGED.                               */
*/*                                                                  */
*/********************************************************************/
*                                                                  1008
*                 CVD(PCCACPUA,CVRTAREA);                          1008
         LH    @07,PCCACPUA(,PCCAPTR)                              1008
         CVD   @07,CVRTAREA                                        1008
*                 WPLPTR=ADDR(EMSGCC);                             1009
         LA    WPLPTR,EMSGCC                                       1009
*                 UNPK(CPUADDRE,CVRTAREA(7:8));                    1010
         UNPK  CPUADDRE(2,WPLPTR),CVRTAREA+6(2)                    1010
*                 CPUADDRE(2)=CPUADDRE(2)×'F0'X;                   1011
         OI    CPUADDRE+1(WPLPTR),X'F0'                            1011
*                 GENERATE CODE(WTO   MF=(E,(1)));                 1012
         WTO   MF=(E,(1))
*               END;                                               1013
*           END;                                                   1014
@RF01000 DS    0H                                                  1015
*                                                                  1015
*/********************************************************************/
*/*                                                                  */
*/* NOW CHECK THE CPU TIMER STATUS BITS TO DETERMINE IF THE CPU TIMER*/
*/* REQUIRES RECOVERY.                                               */
*/*                                                                  */
*/********************************************************************/
*                                                                  1015
*         IF PCCANUIN='1'B&PCCANFIN='0'B THEN                      1015
*                                                                  1015
@RF00998 TM    PCCANUIN(PCCAPTR),B'10000000'                       1015
         BNO   @RF01015                                            1015
         TM    PCCANFIN(PCCAPTR),B'01000000'                       1015
         BNZ   @RF01015                                            1015
*/********************************************************************/
*/*                                                                  */
*/* IF SO, TEST TO SEE IF SYNCHRONOUS RECOVERY HAS BEEN UNABLE TO    */
*/* RECOVER THE ERROR.                                               */
*/*                                                                  */
*/********************************************************************/
*                                                                  1016
*           DO;                                                    1016
*             IF PCCAMINT='1'B THEN                                1017
*                                                                  1017
         TM    PCCAMINT(PCCAPTR),B'00001000'                       1017
         BNO   @RF01017                                            1017
*/********************************************************************/
*/*                                                                  */
*/* IF SO, INDICATE THAT NO ATTEMPTS SHOULD BE MADE TO RECOVER THE   */
*/* CPU TIMER.  THEN, DECREMENT THE COUNT OF GOOD CPU TIMERS BY 1.   */
*/*                                                                  */
*/********************************************************************/
*                                                                  1018
*               DO;                                                1018
*                 PCCANFIN='1'B;                                   1019
         OI    PCCANFIN(PCCAPTR),B'01000000'                       1019
*                 CURRENT=CSDGDINT;                                1020
         L     CURRENT,CSDGDINT(,REG3)                             1020
*SUB5:                                                             1021
*                 NEW=CURRENT-1;                                   1021
SUB5     LR    NEW,CURRENT                                         1021
         BCTR  NEW,0                                               1021
*                 CS(CURRENT,NEW,CSDGDINT);                        1022
         CS    CURRENT,@01,CSDGDINT(REG3)                          1022
*                 BC(7,SUB5);                                      1023
         BC    7,SUB5                                              1023
*                 PCCAMINT='0'B;                                   1024
*                                                                  1024
         NI    PCCAMINT(PCCAPTR),B'11110111'                       1024
*/********************************************************************/
*/*                                                                  */
*/* ASSEMBLE THE ERROR MSG, AND TELL THE OPERATOR THAT THE CPU TIMER */
*/* IS PERMANENTLY DAMAGED.                                          */
*/*                                                                  */
*/********************************************************************/
*                                                                  1025
*                 CVD(PCCACPUA,CVRTAREA);                          1025
         LH    @07,PCCACPUA(,PCCAPTR)                              1025
         CVD   @07,CVRTAREA                                        1025
*                 WPLPTR=ADDR(EMSGCPUT);                           1026
         LA    WPLPTR,EMSGCPUT                                     1026
*                 UNPK(CPUADDRE,CVRTAREA(7:8));                    1027
         UNPK  CPUADDRE(2,WPLPTR),CVRTAREA+6(2)                    1027
*                 CPUADDRE(2)=CPUADDRE(2)×'F0'X;                   1028
         OI    CPUADDRE+1(WPLPTR),X'F0'                            1028
*                 GENERATE CODE(WTO   MF=(E,(1)));                 1029
         WTO   MF=(E,(1))
*               END;                                               1030
*           END;                                                   1031
@RF01017 DS    0H                                                  1032
*       END;                                                       1032
@RF01015 DS    0H                                                  1033
*     REG2=REG2+LENGTH(PCCAT00P);   /* POINT TO NEXT PCCAVT ENTRY    */
@RF00948 AH    REG2,@CH00108                                       1033
*   END;                                                           1034
         BCTR  SLOTCNT,0                                           1034
         LTR   SLOTCNT,SLOTCNT                                     1034
         BP    @DL00947                                            1034
*                                                                  1035
*/********************************************************************/
*/*                                                                  */
*/* THIS IS THE RETRY POINT FROM THE ESTAE EXIT.  REGISTER 15 MUST   */
*/* BE USED FOR TEMPORARY ADDRESSABILITY IN THE MAINLINE BECAUSE IT  */
*/* WILL CONTAIN THE RETRY ENTRY POINT ADDRESS IN A RETRY SITUATION. */
*/*                                                                  */
*/********************************************************************/
*                                                                  1035
*   GENERATE CODE REFS(CLABASE) SETS(REG9,REG15) DEFS(CLARETRY);   1035
*                                                                  1035
*                                                              /*
         BALR  REG15,0            ESTABLISH ADDRESSABILITY FOR
         USING *,REG15               RETRY POINT COMPATABILITY
CLARETRY L     REG9,CLABASE       GET ORIGINAL BASE ADDRESS
         USING CLABSLBL,REG9
         DROP  REG15
*/********************************************************************/
*/*                                                                  */
*/* MAKE SURE THAT THE REAL TIME TQE QUEUE IS KEPT ALIVE.            */
*/*                                                                  */
*/********************************************************************/
*                                                                  1036
*   GENERATE CODE REFS(PSALITA);                                   1036
*                             /*
         SETLOCK  OBTAIN,TYPE=DISP,MODE=UNCOND,                       **
               RELATED=('REAL TQE QUEUE',(IEAVRTOD,(NOLABEL))) */
*   CLACVTP=CVTPTR;                 /* RESTORE POINTER TO CVT        */
         L     CLACVTP,CVTPTR                                      1037
*   REG12=TPCCKQ;                   /* GET ADDRESS OF REAL TIME Q  1038
*                                      CHECKING ROUTINE              */
         L     @07,TPCPTR(,CLACVTP)                                1038
         L     REG12,TPCCKQ(,@07)                                  1038
*   IF CLABND='1'B THEN             /* IF THERE IS NOW A GOOD CLOCK
*                                      COMP/TODC,                    */
         TM    CLABND,B'10000000'                                  1039
         BNO   @RF01039                                            1039
*     TPCABND='0'B;                 /* INDICATE IT TO SET CC         */
         NI    TPCABND(@07),B'01111111'                            1040
*/********************************************************************/
*/*                                                                  */
*/* GO TO SET CC ROUTINE.  THEN RESTORE POINTER TO CVT AND RELEASE   */
*/* THE DISPATCHER LOCK.                                             */
*/*                                                                  */
*/********************************************************************/
*                                                                  1041
*   GENERATE CODE REFS(REG12) SETS(REG2)(BALR  REG2,REG12);        1041
@RF01039 DS    0H                                                  1041
         BALR  REG2,REG12
*   CLACVTP=CVTPTR;                 /* RESTORE POINTER TO CVT        */
         L     CLACVTP,CVTPTR                                      1042
*   GENERATE CODE REFS(PSALITA);                                   1043
*                                                                  1043
*                              /*
         SETLOCK RELEASE,TYPE=DISP,                                   **
               RELATED=('REAL TQE QUEUE',(IEAVRTOD,(NOLABEL)))  */
*/********************************************************************/
*/*                                                                  */
*/* SEE IF IEAVRCLA HAS BEEN SCHEDULED AGAIN TO RECOVER AN ERROR     */
*/* THAT OCCURRED WHILE IT WAS IN THE PROCESS OF RECOVERING OTHER    */
*/* ERRORS.  IT IT HAS, ANOTHER PASS WILL BE MADE THROUGH THE PCCA'S */
*/* TO FIND THE NEW ERROR.  (NOTE:  THE COMBINATION OF THE TEST CYCLE*/
*/* BIT(CLATC) = 0 AND THE IN-USE BIT(CLASIU) = 1 INDICATES THAT NO  */
*/* FURTHER ERROR HAS OCCURRED.)  IF IT HAS NOT BEEN SCHEDULED AGAIN,*/
*/* SET BOTH BITS TO 0.                                              */
*/*                                                                  */
*/********************************************************************/
*                                                                  1044
*   CURRENT=2;                                                     1044
         LA    CURRENT,2                                           1044
*   NEW=0;                                                         1045
         SLR   NEW,NEW                                             1045
*   REG12=ADDR(TPCRSRB);            /* GET ADDRESSABILITY TO SRB     */
         L     REG12,TPCPTR(,CLACVTP)                              1046
         LA    REG12,TPCRSRB(,REG12)                               1046
*   CS(CURRENT,NEW,REG12->SRBPARM);                                1047
         CS    CURRENT,@01,SRBPARM(REG12)                          1047
*   BC(7,SETTC);                    /* BRANCH IF MORE TO RECOVER     */
         BC    7,SETTC                                             1048
*/********************************************************************/
*/*                                                                  */
*/* FREE THE PAGE CONTAINING IEAVRCLA.                               */
*/*                                                                  */
*/********************************************************************/
*                                                                  1049
*   RESPECIFY                                                      1049
*     CVTMAP BASED(CVTPTR);         /*                       @ZA20300*/
*   REG1=ADDR(SETTC);               /* GET POINTER TO START OF     1050
*                                      IEAVRCLA                      */
         LA    REG1,SETTC                                          1050
*   REG15=ADDR(ENDTOD);             /* GET POINTER TO END OF IEAVRTOD*/
         LA    REG15,ENDTOD                                        1051
*   GENERATE CODE(PGFREE R,A=(1),EA=(15));                         1052
*                                                                  1052
         PGFREE R,A=(1),EA=(15)
*/********************************************************************/
*/*                                                                  */
*/* GET RETURN ADDRESS.                                      @ZA20300*/
*/*                                                                  */
*/********************************************************************/
*                                                                  1053
*   REG14=ADDR(CVTEXIT);            /*                       @ZA20300*/
         L     REG14,CVTPTR                                        1053
         LA    REG14,CVTEXIT(,REG14)                               1053
*/********************************************************************/
*/*                                                                  */
*/* DELETE ERROR EXIT FOR UNLOCKED CODE, AND RETURN TO DISPATCHER.   */
*/*                                                                  */
*/********************************************************************/
*                                                                  1054
*   GEN CODE(ESTAE 0);                                             1054
         ESTAE 0
*   GENERATE CODE REFS(REG14)(BR    REG14);                        1055
         BR    REG14
*   RESPECIFY                                                      1056
*    (PCCAPTR) UNRESTRICTED;                                       1056
*   RESPECIFY                                                      1057
*     CSD BASED(CVTCSD);                                           1057
*                                                                  1058
*/********************************************************************/
*/*                                                                  */
*/*         CLAESTAE--IEAVRCLA RECOVERY FOR UNLOCKED CODE            */
*/*                                                                  */
*/********************************************************************/
*                                                                  1058
*CLAESTAE:                                                         1058
*   PROC OPTIONS(NOSAVE,NOSAVEAREA,NOENTREG,RETREG);               1058
*                                                                  1058
         B     @PB00008                                            1058
CLAESTAE DS    0H                                                  1059
*/********************************************************************/
*/*                                                                  */
*/* ESTABLISH TEMPORARY ADDRESSABILITY.                              */
*/*                                                                  */
*/********************************************************************/
*                                                                  1059
*   GEN CODE SETS(REG12) REFS(REG9);                               1059
*                                                                  1059
         BALR  REG12,0
         USING *,REG12
         DROP  REG9
*/********************************************************************/
*/*                                                                  */
*/* SEE IF SDWA WAS SUPPLIED                                         */
*/*                                                                  */
*/********************************************************************/
*                                                                  1060
*   IF REG0=12 THEN                                                1060
*                                                                  1060
         CH    REG0,@CH01265                                       1060
         BNE   @RF01060                                            1060
*/********************************************************************/
*/*                                                                  */
*/* IF THE SDWA WAS NOT SUPPLIED, PUT RETRY ADDRESS IN REG 0 AND A   */
*/* RETURN CODE OF 4 INTO REG 15 TO INDICATE RETRY.                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  1061
*     DO;                                                          1061
*       REG0=CLARTYA;               /* PUT RETRY ADDRESS INTO REG 0  */
         L     REG0,CLARTYA                                        1062
*       RETCODE=4;                                                 1063
         LA    RETCODE,4                                           1063
*     END;                                                         1064
*                                                                  1064
*/********************************************************************/
*/*                                                                  */
*/* IF SUPPLIED, ISSUE SETRP TO ESTABLISH INTERFACE BACK TO RTM.     */
*/*                                                                  */
*/********************************************************************/
*                                                                  1065
*   ELSE                                                           1065
*     DO;                           /* SETRP RECPARM(CLAID)RC(4)RETAD
*                                      DR(RETRYCLA)FRESDWA(YES)DUMP(N
*                                      O)                            */
         B     @RC01060                                            1065
@RF01060 DS    0H                                                  1066
*       RESPECIFY                                                  1066
*        (GPR00P,                                                  1066
*         GPR01P,                                                  1066
*         GPR14P,                                                  1066
*         GPR15P) RSTD;                                            1066
*       GPR01P->SDWARCDE=4;         /* STORE RC INTO SDWA            */
         MVI   SDWARCDE(GPR01P),X'04'                              1067
*       GPR01P->SDWARTYA=ADDR(RETRYCLA);/* SAVE RETRY ADDRESS        */
         MVC   SDWARTYA(4,GPR01P),CLARTYA                          1068
*       GPR01P->SDWAFREE='1'B;      /* SET FLAG TO FREE SDWA         */
         OI    SDWAFREE(GPR01P),B'00000100'                        1069
*       GPR15P=ADDR(CLAID);         /* ACCESS RECORD PARAMETER LIST  */
         LA    GPR15P,CLAID                                        1070
*       GPR01P->SDWARECP=GPR15P->I256C(1:24);/* COPY RECORD        1071
*                                      PARAMETERS                    */
         MVC   SDWARECP(24,GPR01P),I256C(GPR15P)                   1071
*       GPR01P->SDWAREQ='0'B;       /* TURN OFF DUMP INDICATOR       */
         NI    SDWAREQ(GPR01P),B'01111111'                         1072
*       RESPECIFY                                                  1073
*        (GPR00P,                                                  1073
*         GPR01P,                                                  1073
*         GPR14P,                                                  1073
*         GPR15P) UNRSTD;                                          1073
*     END;                                                         1074
*                                                                  1074
*/********************************************************************/
*/*                                                                  */
*/* RETURN TO RTM.                                                   */
*/*                                                                  */
*/********************************************************************/
*                                                                  1075
*   END CLAESTAE;                                                  1075
@EL00008 DS    0H                                                  1075
@EF00008 DS    0H                                                  1075
@ER00008 BR    @14                                                 1075
@PB00008 DS    0H                                                  1076
*                                                                  1076
*/********************************************************************/
*/*                                                                  */
*/* THIS ROUTINE GAINS CONTROL WHEN IT IS NECESSARY TO GET THE CUR-  */
*/* RENT VALUE OF THE TOD CLOCK ON A GIVEN CPU, AND ALSO TO DETERMINE*/
*/* ITS STATE.  IN AN MP CONFIGURATION, IT RECEIVES CONTROL VIA THE  */
*/* IPC, WHILE ON A STRICTLY UP SYSTEM IT RECEIVES CONTROL VIA BALR. */
*/*                                                                  */
*/********************************************************************/
*                                                                  1076
*DELTA1:                                                           1076
*   GENERATE CODE REFS(REG1,REG14,REG15,TCENTRY,TCWAPCCA) SETS(TCWACLKE
*       ,REG12,TCWALFLG,PCCASYNC);                                 1076
DELTA1   DS    0H                                                  1076
         USING *,REG15                  ADDRESSABILITY FOR ROUTINE
         USING TCENTRY,REG1             ADDRESSABILITY FOR TCWA
         STCK  TCWACLKE                 STORE CLOCK INTO TCWA ENTRY
         BALR  REG12,0                  GET CC FROM STCK INSTRUCTION
         STCM  REG12,8,TCWALFLG         STORE IT INTO TCWA ENTRY
         L     REG12,TCWAPCCA           GET PCCA ADDRESS
         NI    PCCASYNC(REG12),X'BF'    TURN OFF SYNC FALG IN PCCA
         BR    REG14                    RETURN
         DROP  REG15
         DROP  REG1
*                                                                  1077
*/********************************************************************/
*/*                                                                  */
*/* THIS ROUTINE GAINS CONTROL WHEN IT IS NECESSARY TO SET THE TOD   */
*/* CLOCK ON A GIVEN CPU.  IN AN MP CONFIGURATION, IT RECEIVES CON-  */
*/* TROL VIA THE IPC, WHILE ON A STRICTLY UP SYSTEM IT RECEIVES CON- */
*/* TROL VIA BALR.                                                   */
*/*                                                                  */
*/********************************************************************/
*                                                                  1077
*   GENERATE CODE REFS(REG15)(USING *,REG15);                      1077
         USING *,REG15
*DELTA2:                                                           1078
*   GENERATE CODE REFS(REG1) SETS(TCWACTL)                         1078
*       (STCTL 0,0,TCWACTL(REG1)  STORE CONTROL REG 0);            1078
DELTA2   STCTL 0,0,TCWACTL(REG1)  STORE CONTROL REG 0
*   REG1->TCSTOP='1'B;              /* TURN ON BIT TO STOP TOD CLOCK */
         OI    TCSTOP(REG1),B'00100000'                            1079
*   GENERATE CODE REFS(REG1,TCWACTL)                               1080
*       (LCTL  0,0,TCWACTL(REG1)  LOAD CONTROL REG 0);             1080
         LCTL  0,0,TCWACTL(REG1)  LOAD CONTROL REG 0
*   REG1->TCGNSET='0'B;             /* INDICATE SECURITY SW DEPRESSED*/
         NI    TCGNSET(REG1),B'11110111'                           1081
*   GENERATE CODE REFS(TCWACVAL)(SCK   TCWACVAL(REG1)  SET THE CLOCK);
         SCK   TCWACVAL(REG1)  SET THE CLOCK
*   GENERATE CODE REFS(REG14)(BCR   8,REG14     RETURN IF SWITCH DOWN);
         BCR   8,REG14     RETURN IF SWITCH DOWN
*   REG1->TCGNSET='1'B;             /* ELSE, INDICATE SW RELEASED    */
         OI    TCGNSET(REG1),B'00001000'                           1084
*   GENERATE CODE REFS(REG14)(BR    REG14         RETURN);         1085
         BR    REG14         RETURN
*   GENERATE CODE REFS(REG15)(DROP  REG15);                        1086
         DROP  REG15
*                                                                  1087
*/********************************************************************/
*/*                                                                  */
*/* THIS ROUTINE GAINS CONTROL WHEN IT IS NECESSARY TO GET THE CUR-  */
*/* VALUE OF THE TOD CLOCK ON A GIVEN CPU.  IN AN MP CONFIGURATION,  */
*/* IT RECEIVES CONTROL VIA THE IPC, WHILE IN A STRICTLY UP SYSTEM   */
*/* IT RECEIVES CONTROL VIA BALR.                                    */
*/*                                                                  */
*/********************************************************************/
*                                                                  1087
*DELTA3:                                                           1087
*   GENERATE CODE REFS(REG1,REG14,REG15);                          1087
DELTA3   DS    0H                                                  1087
         USING *,REG15                 ADDRESSABILITY FOR ROUTINE
         STCK  0(REG1)                 STORE CURRENT CLOCK VALUE
         BR    REG14                   RETURN
         DROP  REG15
*                                                                  1088
*/********************************************************************/
*/*                                                                  */
*/* THIS ROUTINE STORES THE TOD CLOCK ON A GIVEN CPU UNTIL BIT 31    */
*/* CHANGES IN ORDER TO ALLOW A MAXIMUM INTERVAL (UNTIL BIT 31       */
*/* CHANGES AGAIN) FOR SYNCHRONIZING THE TOD CLOCKS.  IT ALWAYS      */
*/* RECEIVES CONTROL VIA THE IPC.                                    */
*/*                                                                  */
*/********************************************************************/
*                                                                  1088
*DELTA4:                                                           1088
*   GENERATE CODE REFS(REG15,REG1,TCWA);                           1088
*                                                                  1088
DELTA4   DS    0H                                                  1088
         USING *,REG15                ADDRESSABILITY FOR ROUTINE
         USING TCWA,REG1              ADDRESSABILITY FOR TCWA
*/********************************************************************/
*/*                                                                  */
*/* INITIALIZE STARTING AND ENDING CLOCK VALUES.                     */
*/*                                                                  */
*/********************************************************************/
*                                                                  1089
*   RESPECIFY                                                      1089
*     TCWA BASED(REG1);                                            1089
*   GENERATE CODE SETS(TCWAA1,TCWAA2);                             1090
*                                                                  1090
*                                                         /*@ZA28478*/
         STCK  TCWAA1                                        @ZA28478
         STCK  TCWAA2                                        @ZA28478
*/********************************************************************/
*/*                                                                  */
*/* STORE THE TOD CLOCK SUCCESSIVELY INTO TCWAA2 UNTIL BIT           */
*/* 31 CHANGES.  (NOTE: THIS CHANGE IS INDICATED BY THE HIGH ORDER   */
*/* 32 BITS OF THE 2 VALUES NOT BEING EQUAL.)                        */
*/*                                                                  */
*/********************************************************************/
*                                                                  1091
*   DO WHILE TCWAA2L=TCWAA1L;                                      1091
         B     @DE01091                                            1091
@DL01091 DS    0H                                                  1092
*     GENERATE CODE SETS(TCWAA2)(STCK  TCWAA2);/*            @ZA28478*/
         STCK  TCWAA2
*   END;                                                           1093
@DE01091 CLC   TCWAA2L(4,REG1),TCWAA1L(REG1)                       1093
         BE    @DL01091                                            1093
*   GENERATE CODE REFS(REG14)(BR    REG14                 RETURN); 1094
         BR    REG14                 RETURN
*                                                                  1095
*/********************************************************************/
*/*                                                                  */
*/* THIS ROUTINE GAINS CONTROL WHEN IT IS NECESSARY FOR THE OPERATOR */
*/* TO PLACE THE TOD CLOCK SECURITY SWITCH IN THE ENABLED POSITION   */
*/* SO THAT THE CLOCKS CAN BE SYNCHRONIZED.  IT ATTEMPTS FOR 30      */
*/* SECONDS TO SET THE CLOCK, THE PURPOSE BEING TO DETERMINE IF THE  */
*/* SECURITY SWITCH HAS BEEN ENABLED.  IT EXITS EITHER AFTER 30      */
*/* SECONDS HAS ELAPSED, OR WHEN THE SWITCH HAS BEEN ENABLED.        */
*/*                                                                  */
*/********************************************************************/
*                                                                  1095
*DELTA7:                                                           1095
*   RESPECIFY                                                      1095
*     TCWA BASED(REG1);                                            1095
DELTA7   DS    0H                                                  1096
*   GENERATE CODE REFS(REG1,REG15,TCWA) SETS(TCWAA1,TCWAA2);       1096
*                                                                  1096
         USING *,REG15
         USING TCWA,REG1
         STPT  TCWAA1               STORE INTERVAL START VALUE
         STPT  TCWAA2               STORE INTERVAL END VALUE
*/********************************************************************/
*/*                                                                  */
*/* LOOP ON A SET CLOCK INSTRUCTION UNTIL THE OPERATOR DEPRESSES THE */
*/* SECURITY SWITCH, OR THE ALLOTTED INTERVAL EXPIRES.               */
*/*                                                                  */
*/********************************************************************/
*                                                                  1097
*   DO WHILE TCWAA1L-TCWAA2L<30&TCGNSET='1'B;                      1097
         B     @DE01097                                            1097
@DL01097 DS    0H                                                  1098
*     GENERATE CODE REFS(TCWACVAL)(SCK   TCWACVAL);                1098
*                                                                  1098
         SCK   TCWACVAL
*/********************************************************************/
*/*                                                                  */
*/* TEST FOR SUCCESSFUL EXECUTION OF THE SET CLOCK INSTRUCTION.      */
*/*                                                                  */
*/********************************************************************/
*                                                                  1099
*     BC(7,STCPUT);                                                1099
*                                                                  1099
         BC    7,STCPUT                                            1099
*/********************************************************************/
*/*                                                                  */
*/* IF SUCCESSFUL, INDICATE IN TCWA THAT SWITCH IS ENABLED.  THEN,   */
*/* WHETHER ENABLED OR NOT, STORE AN INTERVAL ENDING VALUE.          */
*/*                                                                  */
*/********************************************************************/
*                                                                  1100
*     TCGNSET='0'B;                                                1100
         NI    TCGNSET(REG1),B'11110111'                           1100
*STCPUT:                                                           1101
*     GENERATE CODE SETS(TCWAA2)(STPT  TCWAA2);                    1101
STCPUT   STPT  TCWAA2
*   END;                                                           1102
*                                                                  1102
@DE01097 L     @07,TCWAA1L(,REG1)                                  1102
         SL    @07,TCWAA2L(,REG1)                                  1102
         CL    @07,@CF00189                                        1102
         BNL   @DC01097                                            1102
         TM    TCGNSET(REG1),B'00001000'                           1102
         BO    @DL01097                                            1102
@DC01097 DS    0H                                                  1103
*/********************************************************************/
*/*                                                                  */
*/* RETURN TO EXTERNAL SECOND LEVEL INTERRUPT HANDLER.               */
*/*                                                                  */
*/********************************************************************/
*                                                                  1103
*   GENERATE CODE REFS(REG9,REG10,REG14);                          1103
         BR    REG14
         USING @PSTART,REG9
         USING @PSTART+4095,REG10
*   DECLARE                         /* GENERAL PURPOSE REGISTERS     */
*     GPR00P PTR(31) REG(0),                                       1104
*     GPR01P PTR(31) REG(1),                                       1104
*     GPR14P PTR(31) REG(14),                                      1104
*     GPR15P PTR(31) REG(15);                                      1104
*   DECLARE                         /* COMMON VARIABLES              */
*     I256C CHAR(256) BASED,                                       1105
*     I031F FIXED(31) BASED,                                       1105
*     I031P PTR(31) BASED,                                         1105
*     I015F FIXED(15) BASED,                                       1105
*     I015P PTR(15) BASED,                                         1105
*     I008P PTR(8) BASED,                                          1105
*     I001C CHAR(1) BASED;                                         1105
*   END IEAVRTOD                                                   1106
*                                                                  1106
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (IEAVVTPC)                                       */
*/*%INCLUDE SYSLIB  (IEZWPL  )                                       */
*/*%INCLUDE SYSLIB  (IEEBASEA)                                       */
*/*%INCLUDE SYSLIB  (IHALCCAT)                                       */
*/*%INCLUDE SYSLIB  (IHALCCA )                                       */
*/*%INCLUDE SYSLIB  (IHAASVT )                                       */
*/*%INCLUDE SYSLIB  (IHAPSA  )                                       */
*/*%INCLUDE SYSLIB  (IHASRB  )                                       */
*/*%INCLUDE SYSLIB  (IHAASCB )                                       */
*/*%INCLUDE SYSLIB  (IHACSD  )                                       */
*/*%INCLUDE SYSLIB  (IHAPCCA )                                       */
*/*%INCLUDE SYSLIB  (IHAPCCAT)                                       */
*/*%INCLUDE SYSLIB  (IHATQE  )                                       */
*/*%INCLUDE SYSLIB  (CVT     )                                       */
*/*%INCLUDE SYSLIB  (IHASDWA )                                       */
*                                                                  1106
*       ;                                                          1106
         B     @EL00001                                            1106
@DATA    DS    0H
@CH00119 DC    H'2'
@CH00108 DC    H'4'
@CH00038 DC    H'8'
@CH01265 DC    H'12'
@CH00507 DC    H'20'
@CH00707 DC    H'48'
@CH01364 DC    H'112'
@CH02779 DC    H'-60'
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    2F
@PC00006 DS    3F
IEAVRTOD CSECT
         DS    0F
@CF00096 DC    F'1'
@CH00096 EQU   @CF00096+2
@CF00045 DC    F'16'
@CH00045 EQU   @CF00045+2
@CF00189 DC    F'30'
@DATD    DSECT
         DS    0D
PTREBEG  DS    A
PTREEND  DS    A
RCSAVE   DS    F
I5       DS    F
LOOPCTR  DS    F
SETLOOP  DS    F
TODECB   DS    F
TCWALN   DS    H
CALLERID DS    H
CPUSLEFT DS    H
         DS    0D
@TS00001 DS    CL8
R1314SAV DS    CL8
         ORG   R1314SAV
R13SAV   DS    AL4
RETSAVE  DS    AL4
         ORG   R1314SAV+8
SSCRPARM DS    CL12
         ORG   SSCRPARM
SSCBASE  DS    CL12
         ORG   SSCBASE
SSCREG8  DS    AL4
SSCREG9  DS    AL4
SSCREG10 DS    AL4
         ORG   SSCRPARM+12
IEAVRTOD CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CA02635 DC    A(IEAVRSSC)
         DS    0D
CLAECB   DS    F
CLABASE  DC    AL4(CLABSLBL)
CLARTYA  DC    AL4(CLARETRY)
SSCRTYA  DC    AL4(SSCRETRY)
MICSMIN  DC    F'60000000'
MINSHOUR DC    F'60'
DAYS4YRS DC    F'1461'
DAYSFACT DC    F'10546875'
MICSSEC  DC    F'1000000'
K100     DC    H'100'
K1000    DC    H'1000'
K10000   DC    H'10000'
MINSDAY  DC    H'1440'
@CB02630 DC    X'0000000000000000'
CLAFLGS  DC    X'00'
         ORG   CLAFLGS
CLABND   DS    BL1
@NM00001 EQU   CLAFLGS+0
         ORG   CLAFLGS+1
CLAID    DS    CL24
         ORG   CLAID
CLAMODNM DC    CL8'IEAVRTOD'
CLACSECT DC    CL8'IEAVRTOD'
CLAFRRID DC    CL8'CLAESTAE'
         ORG   CLAID+24
IDVRSSC  DC    X'03808000'
SSCID    DS    CL24
         ORG   SSCID
SSCMODNM DC    CL8'IEAVRTOD'
SSCCSECT DC    CL8'IEAVRTOD'
SSCFRRID DC    CL8'SSCESTAE'
         ORG   SSCID+24
         DS    CL7
CVRTAREA DS    CL8
TMSTINIT DC    X'80000000'
CAPU     DC    CL2'U '
SMALLU   DC    X'A440'
CHARSET  DC    CL4'SET '
DTEPATRN DC    X'F021204B202020'
CLKPATRN DC    X'2120204B20204B2020'
PATCHTOD DC    CL250' '
         DS    CL2
CLASAV   DS    18F
@DATD    DSECT
*                           /*
*
ESTAEL   ESTAE ,MF=L
*                                                            */
IEAVRTOD CSECT
*                                                /*
*
* c117500                                                    @YM04380
MSGXXX1  WTO   '   IEA888A GMT   DATE=YY.DDD,CLOCK=HH.MM.SS',         **
               ROUTCDE=(1),DESC=(3),MCSFLAG=(NOTIME),MF=L
*
* c117800-117900                                             @YM04380
* C117900                                                    @YM08124
MSGXXX2  WTOR  'IEA888A LOCAL DATE=YY.DDD,CLOCK=HH.MM.SS  REPLY U, OR GG
               MT/LOCAL TIME',,40,ROUTCDE=(1),DESC=(2),               **
               MCSFLAG=(NOTIME),MF=L
*
MSGYYY   WTOR  'IEA886A TOD CLOCK(S) MUST BE SET',,40,                **
               ROUTCDE=(1),DESC=(2),MCSFLAG=(NOTIME),MF=L
*
* c118500                                                    @YM04380
MSGZZZ1  WTO   '   IEA887A CPU XX LOCAL DATE=YY.DDD,CLOCK=HH.MM.SS',  **
               ROUTCDE=(1),DESC=(3),MCSFLAG=(NOTIME),MF=L
*
MSGZZZ2  WTOR  'IEA887A TOD CLOCKS MUST BE SET, OR SELECT ADDRESS',,  **
               40,ROUTCDE=(1),DESC=(2),MCSFLAG=(NOTIME),MF=L
*
MSGDEPSS WTOR  'IEA889A DEPRESS TOD CLOCK SECURITY SWITCH',,40,       **
               ROUTCDE=(1),DESC=(2),MCSFLAG=(NOTIME),MF=L
*
EMSGTOD  WTO   'IEA898I CPU XX HAS PERMANENTLY DAMAGED TOD CLOCK',    **
               ROUTCDE=(2,10),DESC=(4),MCSFLAG=(NOTIME),MF=L
*
EMSGCC   WTO   'IEA898I CPU XX HAS PERMANENTLY DAMAGED CLOCK COMPARATORR
               ',ROUTCDE=(2,10),DESC=(4),MCSFLAG=(NOTIME),MF=L
*
EMSGCPUT WTO   'IEA898I CPU XX HAS PERMANENTLY DAMAGED CPU TIMER',    XX
               ROUTCDE=(2,10),DESC=(4),MCSFLAG=(NOTIME),MF=L
*
ENDTOD   EQU   *                      END OF IEAVRTOD
*                                                                  */
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IEAVRTOD CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
REG0     EQU   @00
TMICSECL EQU   @00
CURRENT  EQU   @00
MASKHLDR EQU   @00
REG1     EQU   @01
TMICSECR EQU   @01
NEW      EQU   @01
SDWAPTR  EQU   @01
TQEPTR   EQU   @01
WPLPTR   EQU   @01
SRBPTR   EQU   @01
REG2     EQU   @02
LCVTPTR  EQU   @02
TCWAPTR  EQU   @03
REG3     EQU   @03
REG8     EQU   @08
SLOTCNT  EQU   @08
REG9     EQU   @09
REG10    EQU   @10
PCCAPTR  EQU   @10
REG11    EQU   @11
REG12    EQU   @12
REG13    EQU   @13
REG14    EQU   @14
LCCAPTR  EQU   @14
REG15    EQU   @15
RETCODE  EQU   @15
CLACVTP  EQU   @15
GPR00P   EQU   @00
GPR01P   EQU   @01
GPR14P   EQU   @14
GPR15P   EQU   @15
CVTPTR   EQU   16
RETRYCLA EQU   0
RETRYSSC EQU   0
ENQTQE   EQU   0
DEQTQE   EQU   0
PTRPCCA  EQU   0
PTRLCCA  EQU   0
TPC      EQU   0
IEATPC   EQU   TPC
TPCFLGS1 EQU   IEATPC+4
TPCABND  EQU   TPCFLGS1
TPCSYNC  EQU   TPCFLGS1
TPCTZORG EQU   IEATPC+8
TPCHDCCQ EQU   IEATPC+12
TPCDMTQE EQU   IEATPC+16
DFD      EQU   TPCDMTQE+4
TPCMNTQE EQU   IEATPC+40
MNIGHT   EQU   TPCMNTQE+16
MNIGHTLH EQU   MNIGHT
TPCMFTQE EQU   IEATPC+64
IEATSELM EQU   IEATPC+88
TPCLMTQE EQU   IEATPC+112
TPCWORK  EQU   IEATPC+264
TPCTCWA  EQU   IEATPC+356
TPCRSRB  EQU   IEATPC+360
TPCCKQ   EQU   IEATPC+404
TPCCLA   EQU   IEATPC+408
WPLRF    EQU   0
WPLRPTR  EQU   WPLRF
WPLRPTRA EQU   WPLRPTR+1
WPLRECB  EQU   WPLRF+4
WPL      EQU   0
WPLMCSF  EQU   WPL+2
WPLMCSF1 EQU   WPLMCSF
WPLMCSF2 EQU   WPLMCSF+1
WPLTXT   EQU   WPL+4
WPLFLGS  EQU   0
WPLDESC  EQU   WPLFLGS
WPLDESC1 EQU   WPLDESC
WPLDESC2 EQU   WPLDESC+1
WPLROUT  EQU   WPLFLGS+2
WPLROUT1 EQU   WPLROUT
WPLROUT2 EQU   WPLROUT+1
WPLMSGTY EQU   WPLFLGS+4
WPLMSGT1 EQU   WPLMSGTY
WPLMSGT2 EQU   WPLMSGTY+1
WPLLS01  EQU   0
WPLLTF   EQU   WPLLS01
WPLLTF1  EQU   WPLLTF
WPLML    EQU   0
WPLMLLTF EQU   WPLML+2
WPLMLLT1 EQU   WPLMLLTF
BASE     EQU   0
@NM00039 EQU   BASE+13
BAIPLCC  EQU   @NM00039+2
BALGSTAT EQU   BASE+24
BALOG    EQU   BALGSTAT+4
BASFL    EQU   BASE+36
BARSW    EQU   BASFL
BAIN     EQU   BARSW
MSTODWTO EQU   BARSW
BAINTSET EQU   BARSW
MSLOGST  EQU   BASE+46
BASPBYTE EQU   BASE+47
BAMONITR EQU   BASE+56
@NM00061 EQU   BASE+104
MSLGCLOZ EQU   BASE+108
MSCLOSSW EQU   MSLGCLOZ
MSLGWLOG EQU   BASE+112
MSWLOGSW EQU   MSLGWLOG
MSLGWTR  EQU   BASE+116
MSWTRSW  EQU   MSLGWTR
MSLGSTRT EQU   BASE+120
MSSTRTSW EQU   MSLGSTRT
MS1BASEX EQU   BASE+136
BASES01  EQU   0
MSNTAL   EQU   BASES01
MSSSB    EQU   BASES01+1
MSBTN    EQU   MSSSB
MSPFG    EQU   BASES01+2
MSECBFL  EQU   BASES01+3
MSTUS    EQU   BASES01+4
MSSSA    EQU   MSTUS
MSINLSW  EQU   MSSSA
MSREOF   EQU   MSSSA
MSNWP    EQU   MSSSA
MSFHF    EQU   BASES01+5
LCCAVT   EQU   0
LCCAT00P EQU   LCCAVT
LCCA     EQU   0
LCCAIHRC EQU   LCCA+520
LCCAIHR1 EQU   LCCAIHRC
LCCAIHR2 EQU   LCCAIHRC+1
LCCAIHR3 EQU   LCCAIHRC+2
LCCAIHR4 EQU   LCCAIHRC+3
LCCASPIN EQU   LCCA+524
LCCASPN1 EQU   LCCASPIN
LCCASPN2 EQU   LCCASPIN+1
LCCASPN3 EQU   LCCASPIN+2
LCCASPN4 EQU   LCCASPIN+3
LCCADSF1 EQU   LCCA+540
LCCATIMR EQU   LCCADSF1
LCCADSF2 EQU   LCCA+541
LCCASPSA EQU   LCCA+544
LCCADTOD EQU   LCCA+600
LCCAWTIM EQU   LCCA+616
LCCACRFL EQU   LCCA+692
LCCACREX EQU   LCCA+693
LCCALKFG EQU   LCCA+694
LCCASRBF EQU   LCCA+720
ASVT     EQU   0
ASVTMAXU EQU   ASVT+516
ASVTFRST EQU   ASVT+524
ASVTENTY EQU   ASVT+528
ASVTAVAL EQU   ASVTENTY
PSA      EQU   0
FLCRNPSW EQU   PSA
FLCROPSW EQU   PSA+8
FLCICCW2 EQU   PSA+16
PSAEEPSW EQU   PSA+132
PSAESPSW EQU   PSA+136
FLCSVILC EQU   PSAESPSW+1
PSAEPPSW EQU   PSA+140
FLCPIILC EQU   PSAEPPSW+1
FLCPICOD EQU   PSAEPPSW+2
PSAPICOD EQU   FLCPICOD+1
FLCTEA   EQU   PSAEPPSW+4
FLCPER   EQU   PSA+152
FLCMCLA  EQU   PSA+168
FLCIOEL  EQU   FLCMCLA+4
FLCIOA   EQU   FLCMCLA+16
FLCFSA   EQU   FLCMCLA+80
PSALCCAV EQU   PSA+528
PSASUPER EQU   PSA+552
PSASUP1  EQU   PSASUPER
PSASUP2  EQU   PSASUPER+1
PSASUP3  EQU   PSASUPER+2
PSASUP4  EQU   PSASUPER+3
PSACLHT  EQU   PSA+640
PSALKSA  EQU   PSA+696
PSAHLHI  EQU   PSA+760
PSALITA  EQU   PSA+764
PSADSSFL EQU   PSA+836
PSADSSF1 EQU   PSADSSFL
PSADSSF3 EQU   PSADSSFL+2
PSADSSF4 EQU   PSADSSFL+3
PSARSVT  EQU   PSA+896
SRBSECT  EQU   0
SRB      EQU   SRBSECT
SRBFLC   EQU   SRB+12
SRBPARM  EQU   SRB+28
ASCB     EQU   0
ASCBEJST EQU   ASCB+64
ASCBFW1  EQU   ASCB+100
ASCBRCTF EQU   ASCBFW1+2
ASCBFLG1 EQU   ASCBFW1+3
ASCBDSP1 EQU   ASCB+114
ASCBFLG2 EQU   ASCB+115
CSD      EQU   0
CSDCPUAL EQU   CSD+8
CSDCPUOL EQU   CSD+10
CSDSCWRD EQU   CSD+12
CSDSCFL1 EQU   CSDSCWRD
CSDSCFL2 EQU   CSDSCWRD+1
CSDSCFL3 EQU   CSDSCWRD+2
CSDSCFL4 EQU   CSDSCWRD+3
CSDFLAGS EQU   CSD+23
CSDMP    EQU   CSDFLAGS
CSDGDCC  EQU   CSD+108
CSDGDINT EQU   CSD+112
CSDGDTOD EQU   CSD+116
PCCA     EQU   0
PCCACPUA EQU   PCCA+16
PCCATQEP EQU   PCCA+20
PCCAPSAV EQU   PCCA+24
PCCATMST EQU   PCCA+128
PCCATMFL EQU   PCCATMST
PCCASYNC EQU   PCCATMFL
PCCAVKIL EQU   PCCATMFL
PCCAMCC  EQU   PCCATMFL
PCCAMINT EQU   PCCATMFL
PCCATODE EQU   PCCATMST+1
PCCANUTD EQU   PCCATODE
PCCANFTD EQU   PCCATODE
PCCACCE  EQU   PCCATMST+2
PCCANUCC EQU   PCCACCE
PCCANFCC EQU   PCCACCE
PCCAINTE EQU   PCCATMST+3
PCCANUIN EQU   PCCAINTE
PCCANFIN EQU   PCCAINTE
PCCAEMSB EQU   PCCA+136
PCCAEMSI EQU   PCCAEMSB
PCCARISP EQU   PCCAEMSI
PCCAEMS2 EQU   PCCAEMSI+1
PCCAEMS3 EQU   PCCAEMSI+2
PCCARMSB EQU   PCCAEMSI+3
PCCAWERP EQU   PCCA+280
PCCACHPF EQU   PCCAWERP+4
PCCACHBL EQU   PCCAWERP+5
PCCACHVA EQU   PCCAWERP+6
PCCACHTS EQU   PCCAWERP+7
PCCACHS1 EQU   PCCA+288
PCCACHS2 EQU   PCCA+289
PCCACHRB EQU   PCCA+290
PCCACHF1 EQU   PCCA+308
PCCACHF2 EQU   PCCA+309
PCCACHF3 EQU   PCCA+310
PCCACHF4 EQU   PCCA+311
PCCAVT   EQU   0
PCCAT00P EQU   PCCAVT
TQE      EQU   0
TQEFLGS  EQU   TQE+14
TQEFLGS2 EQU   TQE+15
TQECOMP  EQU   TQEFLGS2
TQEVAL   EQU   TQE+16
TQEVALLH EQU   TQEVAL
TQEVALRH EQU   TQEVAL+4
TQEEXIT  EQU   TQE+28
CVTMAP   EQU   0
CVT      EQU   CVTMAP
CVTDATE  EQU   CVTMAP+56
CVTDAR   EQU   CVTMAP+72
CVTFLGS1 EQU   CVTDAR
CVTEXIT  EQU   CVTMAP+80
CVTTPC   EQU   CVTMAP+88
CVTQTE00 EQU   CVTMAP+104
CVTQTD00 EQU   CVTMAP+108
CVTDCB   EQU   CVTMAP+116
CVTIOQET EQU   CVTMAP+120
CVTIERLC EQU   CVTMAP+144
CVTMSER  EQU   CVTMAP+148
CVTHEAD  EQU   CVTMAP+160
CVTSV76C EQU   CVTHEAD
CVTOPTA  EQU   CVTMAP+182
CVTOPTB  EQU   CVTMAP+183
CVTGTF   EQU   CVTMAP+236
CVTGTFST EQU   CVTGTF
CVTGTFS  EQU   CVTGTFST
CVTSTATE EQU   CVTGTFST
CVTTMODE EQU   CVTGTFST
CVTFORM  EQU   CVTGTFST
CVTAQAVT EQU   CVTMAP+240
CVTTCMFG EQU   CVTAQAVT
CVTVOLM2 EQU   CVTMAP+244
CVTTATA  EQU   CVTVOLM2
CVTTSKS  EQU   CVTTATA
CVTVOLF2 EQU   CVTTSKS
CVTTAT   EQU   CVTTATA+1
CVTATER  EQU   CVTMAP+248
CVTEXT1  EQU   CVTMAP+252
CVTPURG  EQU   CVTMAP+260
CVTQMSG  EQU   CVTMAP+268
CVTDMSR  EQU   CVTMAP+272
CVTRSV37 EQU   CVTDMSR
CVTDMSRF EQU   CVTRSV37
CVTTZ    EQU   CVTMAP+304
CVTERPV  EQU   CVTMAP+316
CVTINTLA EQU   CVTMAP+320
CVTAPF   EQU   CVTMAP+324
CVTEXT2  EQU   CVTMAP+328
CVTHJES  EQU   CVTMAP+332
CVTPGSIA EQU   CVTMAP+348
CVTA1F1  EQU   CVTMAP+356
CVTSYSK  EQU   CVTMAP+357
CVTVOLM1 EQU   CVTMAP+380
CVTVOLF1 EQU   CVTVOLM1
CVTATMCT EQU   CVTMAP+388
CVTXTNT1 EQU   0
CVTXTNT2 EQU   0
CVTDSSV  EQU   CVTXTNT2
CVTFLGBT EQU   CVTXTNT2+5
CVTQID   EQU   CVTXTNT2+24
CVTRV400 EQU   CVTXTNT2+52
CVTRV409 EQU   CVTXTNT2+53
CVTATCVT EQU   CVTXTNT2+64
CVTRV429 EQU   CVTXTNT2+84
CVTRV438 EQU   CVTXTNT2+85
CVTRV457 EQU   CVTXTNT2+112
CVTRV466 EQU   CVTXTNT2+113
CVTFIX   EQU   0
CVTRELNO EQU   CVTFIX+252
SDWA     EQU   0
SDWAPARM EQU   SDWA
SDWAFIOB EQU   SDWA+4
SDWAABCC EQU   SDWAFIOB
SDWACMPF EQU   SDWAABCC
SDWAREQ  EQU   SDWACMPF
SDWACTL1 EQU   SDWA+8
SDWACMKA EQU   SDWACTL1
SDWAMWPA EQU   SDWACTL1+1
SDWAPMKA EQU   SDWACTL1+4
SDWACTL2 EQU   SDWA+16
SDWACMKP EQU   SDWACTL2
SDWAMWPP EQU   SDWACTL2+1
SDWAPMKP EQU   SDWACTL2+4
SDWAGRSV EQU   SDWA+24
SDWANAME EQU   SDWA+88
SDWAEC1  EQU   SDWA+104
SDWAEMK1 EQU   SDWAEC1
SDWAMWP1 EQU   SDWAEC1+1
SDWAINT1 EQU   SDWAEC1+2
SDWANXT1 EQU   SDWAEC1+4
SDWAAEC1 EQU   SDWA+112
SDWAILC1 EQU   SDWAAEC1+1
SDWAINC1 EQU   SDWAAEC1+2
SDWAICD1 EQU   SDWAINC1+1
SDWAEC2  EQU   SDWA+120
SDWAEMK2 EQU   SDWAEC2
SDWAMWP2 EQU   SDWAEC2+1
SDWAINT2 EQU   SDWAEC2+2
SDWANXT2 EQU   SDWAEC2+4
SDWAAEC2 EQU   SDWA+128
SDWAILC2 EQU   SDWAAEC2+1
SDWAINC2 EQU   SDWAAEC2+2
SDWAICD2 EQU   SDWAINC2+1
SDWASRSV EQU   SDWA+136
SDWAIDNT EQU   SDWA+200
SDWAMCH  EQU   SDWA+204
SDWASTCK EQU   SDWAMCH
SDWAMCHI EQU   SDWAMCH+8
SDWAMCHS EQU   SDWAMCHI
SDWAMCHD EQU   SDWAMCHI+1
SDWARSR1 EQU   SDWAMCH+12
SDWARSR2 EQU   SDWAMCH+13
SDWAFLGS EQU   SDWA+232
SDWAERRA EQU   SDWAFLGS
SDWAERRB EQU   SDWAFLGS+1
SDWAERRC EQU   SDWAFLGS+2
SDWAERRD EQU   SDWAFLGS+3
SDWAIOFS EQU   SDWA+238
SDWARTYA EQU   SDWA+240
SDWACPUA EQU   SDWA+248
SDWAPARQ EQU   SDWA+252
SDWARCDE EQU   SDWAPARQ
SDWAACF2 EQU   SDWAPARQ+1
SDWAFREE EQU   SDWAACF2
SDWAACF3 EQU   SDWAPARQ+2
SDWAACF4 EQU   SDWAPARQ+3
SDWALKWA EQU   SDWA+256
SDWALKWS EQU   SDWALKWA
SDWARECP EQU   SDWA+292
SDWASNPA EQU   SDWA+320
SDWADUMP EQU   SDWASNPA
SDWADPFS EQU   SDWADUMP+1
SDWADDAT EQU   SDWASNPA+4
SDWASDAT EQU   SDWADDAT
SDWAPDAT EQU   SDWADDAT+2
SDWADPSA EQU   SDWA+328
SDWADPSL EQU   SDWADPSA
SDWARA   EQU   SDWA+400
SDWADPVA EQU   SDWARA+2
TCWA     EQU   0
TCWACVAL EQU   TCWA
TCWACVL  EQU   TCWACVAL
TCWACVR  EQU   TCWACVAL+4
TCWAWRK  EQU   TCWA+8
TCWAWRK1 EQU   TCWAWRK
TCWAA1   EQU   TCWAWRK1
TCWAA1L  EQU   TCWAA1
TCWAA1R  EQU   TCWAA1+4
TCWAWRK2 EQU   TCWAWRK+8
TCWAA2   EQU   TCWAWRK2
TCWAA2L  EQU   TCWAA2
TCWAA2R  EQU   TCWAA2+4
TCWAPGT  EQU   TCWA+24
TCWAPGD  EQU   TCWA+28
TCWAPLT  EQU   TCWA+32
TCWAPLD  EQU   TCWA+36
TCWAPTP  EQU   TCWA+40
TCWAPDP  EQU   TCWA+44
TCWACVP  EQU   TCWA+48
TCWAGFLG EQU   TCWA+52
TCGXXX   EQU   TCWAGFLG
TCGYYY   EQU   TCWAGFLG
TCGZZZ   EQU   TCWAGFLG
TCGNSET  EQU   TCWAGFLG
TCGLELD  EQU   TCWAGFLG
TCGCVTD  EQU   TCWAGFLG
TCGTQE   EQU   TCWAGFLG
TCCPUCNT EQU   TCWA+54
TCWARPLY EQU   TCWA+56
TCWARLEN EQU   TCWARPLY
TCWASET  EQU   TCWARPLY+4
TCWATXT  EQU   TCWARPLY+8
TCWACTL  EQU   TCWA+104
TCSTOP   EQU   TCWACTL
TCSYNCK  EQU   TCWACTL+2
TCELDAYS EQU   TCWA+108
TCENTRY  EQU   0
TCWACLKE EQU   TCENTRY
TCWACLKL EQU   TCWACLKE
TCWACLKR EQU   TCWACLKE+4
TCWAPCCA EQU   TCENTRY+8
TCWAIADD EQU   TCENTRY+12
TCWALFLG EQU   TCENTRY+15
TCLCC    EQU   TCWALFLG
I256C    EQU   0
I001C    EQU   0
I008P    EQU   0
I015F    EQU   0
I015P    EQU   0
I031F    EQU   0
I031P    EQU   0
NEWPCCA  EQU   0
PARMTIME EQU   0
PARMDATE EQU   0
CONVALUE EQU   0
LO32BITS EQU   CONVALUE+4
OLDPCCA  EQU   0
SECSMIN  EQU   MINSHOUR
ASCBPTR  EQU   ASVTENTY
TPCPTR   EQU   CVTTPC
CVTS01   EQU   CVTPGSIA
CVTLPDIA EQU   CVTS01+12
CVTDIRST EQU   CVTLPDIA
CVTSLIDA EQU   CVTS01+24
CVTCTLFG EQU   CVTS01+50
CVTASVT  EQU   CVTS01+208
CVTCSD   EQU   CVTS01+312
CVTIPCRI EQU   CVTS01+408
CVTPCCAT EQU   CVTS01+416
CVTLCCAT EQU   CVTS01+420
CVTRV210 EQU   CVTS01+424
CVTRV219 EQU   CVTS01+425
CVTRV228 EQU   CVTS01+426
CVTRV237 EQU   CVTS01+427
CVTMFRTR EQU   CVTS01+452
CVTRV262 EQU   CVTS01+468
CVTRV271 EQU   CVTS01+469
CVTRV280 EQU   CVTS01+470
CVTRV289 EQU   CVTS01+471
CVTGSDA  EQU   CVTS01+600
ASVTPTR  EQU   CVTASVT
CLASIUTC EQU   SRBPARM
CLATC    EQU   CLASIUTC+3
PSARSVTE EQU   PSARSVT
TEXTZZZ  EQU   WPLTXT
CPUADDRZ EQU   TEXTZZZ+15
DATEZ    EQU   TEXTZZZ+28
CLOCKZ   EQU   TEXTZZZ+41
TEXTXXX1 EQU   WPLTXT
DATEX1   EQU   TEXTXXX1+21
CLOCKX1  EQU   TEXTXXX1+34
TEXTXXX2 EQU   WPLTXT
DATEX2   EQU   TEXTXXX2+18
CLOCKX2  EQU   TEXTXXX2+31
TEXTERR  EQU   WPLTXT
CPUADDRE EQU   TEXTERR+12
FLC      EQU   PSA
TQEECB   EQU   TQEEXIT
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00175 EQU   TEXTERR
@NM00174 EQU   TEXTXXX2+25
@NM00173 EQU   TEXTXXX2
@NM00172 EQU   TEXTXXX1+28
@NM00171 EQU   TEXTXXX1
@NM00170 EQU   TEXTZZZ+35
@NM00169 EQU   TEXTZZZ+17
@NM00168 EQU   TEXTZZZ
PSARSAV  EQU   PSARSVTE+60
PSARSTK  EQU   PSARSVTE+56
PSAESAV3 EQU   PSARSVTE+52
PSAESTK3 EQU   PSARSVTE+48
PSAESAV2 EQU   PSARSVTE+44
PSAESTK2 EQU   PSARSVTE+40
PSAESAV1 EQU   PSARSVTE+36
PSAESTK1 EQU   PSARSVTE+32
PSAPSAV  EQU   PSARSVTE+28
PSAPSTK  EQU   PSARSVTE+24
PSAMSAV  EQU   PSARSVTE+20
PSAMSTK  EQU   PSARSVTE+16
PSASSAV  EQU   PSARSVTE+12
PSASSTK  EQU   PSARSVTE+8
PSANSTK  EQU   PSARSVTE+4
PSACSTK  EQU   PSARSVTE
CLASIU   EQU   CLASIUTC+3
@NM00002 EQU   CLASIUTC
CVTRV628 EQU   CVTS01+728
CVTRV627 EQU   CVTS01+724
CVTRV626 EQU   CVTS01+720
CVTRV625 EQU   CVTS01+716
CVTRV624 EQU   CVTS01+712
CVTRV623 EQU   CVTS01+708
CVTRV622 EQU   CVTS01+704
CVTRV621 EQU   CVTS01+700
CVTIHASU EQU   CVTS01+696
CVTRV619 EQU   CVTS01+692
CVTRV618 EQU   CVTS01+688
CVTRV617 EQU   CVTS01+684
CVTRV616 EQU   CVTS01+680
CVTRV615 EQU   CVTS01+676
CVTRV614 EQU   CVTS01+672
CVTRV613 EQU   CVTS01+668
CVTTCASP EQU   CVTS01+664
CVT0PT03 EQU   CVTS01+660
CVT0PT0E EQU   CVTS01+656
CVTRV609 EQU   CVTS01+652
CVTCGK   EQU   CVTS01+648
CVTRAC   EQU   CVTS01+644
CVTHSM   EQU   CVTS01+640
CVTRV605 EQU   CVTS01+636
CVTRV604 EQU   CVTS01+632
CVTEFF02 EQU   CVTS01+628
CVTCBBR  EQU   CVTS01+624
CVTSSCR  EQU   CVTS01+620
CVTEVENT EQU   CVTS01+616
CVTCRCA  EQU   CVTS01+612
CVTTPIO  EQU   CVTS01+608
CVTADV   EQU   CVTS01+604
CVTGSDAB EQU   CVTGSDA
CVTQV3   EQU   CVTS01+596
CVTQV2   EQU   CVTS01+592
CVTQV1   EQU   CVTS01+588
CVTRPT   EQU   CVTS01+584
CVTSSRB  EQU   CVTS01+580
CVTCSDRL EQU   CVTS01+576
CVTEXP1  EQU   CVTS01+572
CVTRMPMT EQU   CVTS01+568
CVTRMPTT EQU   CVTS01+564
CVTVPSA  EQU   CVTS01+560
CVTVSTOP EQU   CVTS01+556
CVTGTFR8 EQU   CVTS01+552
CVTQUIT  EQU   CVTS01+548
CVTVACR  EQU   CVTS01+544
CVTWTCB  EQU   CVTS01+540
CVTSTPRS EQU   CVTS01+536
CVT0PT02 EQU   CVTS01+532
CVTDARCM EQU   CVTS01+528
CVTIRECM EQU   CVTS01+524
CVTJRECM EQU   CVTS01+520
CVTVEMS0 EQU   CVTS01+516
CVTSPFRR EQU   CVTS01+512
CVTRLSTG EQU   CVTS01+508
CVT0TC0A EQU   CVTS01+504
CVTGMBR  EQU   CVTS01+500
CVTLFRM  EQU   CVTS01+496
CVTRMBR  EQU   CVTS01+492
CVTVIOP  EQU   CVTS01+488
CVTRV307 EQU   CVTS01+486
CVTRV306 EQU   CVTS01+484
CVTRV305 EQU   CVTS01+482
CVTRV304 EQU   CVTS01+480
CVTRV303 EQU   CVTS01+478
CVTRV302 EQU   CVTS01+476
CVTTRCA  EQU   CVTS01+472
CVTRV297 EQU   CVTRV289
CVTRV296 EQU   CVTRV289
CVTRV295 EQU   CVTRV289
CVTRV294 EQU   CVTRV289
CVTRV293 EQU   CVTRV289
CVTRV292 EQU   CVTRV289
CVTRV291 EQU   CVTRV289
CVTRV290 EQU   CVTRV289
CVTRV288 EQU   CVTRV280
CVTRV287 EQU   CVTRV280
CVTRV286 EQU   CVTRV280
CVTRV285 EQU   CVTRV280
CVTRV284 EQU   CVTRV280
CVTRV283 EQU   CVTRV280
CVTRV282 EQU   CVTRV280
CVTRV281 EQU   CVTRV280
CVTRV279 EQU   CVTRV271
CVTRV278 EQU   CVTRV271
CVTRV277 EQU   CVTRV271
CVTRV276 EQU   CVTRV271
CVTRV275 EQU   CVTRV271
CVTRV274 EQU   CVTRV271
CVTRV273 EQU   CVTRV271
CVTRV272 EQU   CVTRV271
CVTRV270 EQU   CVTRV262
CVTRV269 EQU   CVTRV262
CVTRV268 EQU   CVTRV262
CVTRV267 EQU   CVTRV262
CVTRV266 EQU   CVTRV262
CVTRV265 EQU   CVTRV262
CVTRV264 EQU   CVTRV262
CVTRV263 EQU   CVTRV262
CVTVFP   EQU   CVTS01+464
CVTVSI   EQU   CVTS01+460
CVTVPSIB EQU   CVTS01+456
CVTMFACT EQU   CVTMFRTR
CVTMFCTL EQU   CVTS01+448
CVTPVBP  EQU   CVTS01+444
CVTPWI   EQU   CVTS01+440
CVTRV254 EQU   CVTS01+438
CVTRV253 EQU   CVTS01+436
CVTRV252 EQU   CVTS01+434
CVTRV251 EQU   CVTS01+433
CVTRV250 EQU   CVTS01+432
CVTRV249 EQU   CVTS01+431
CVTRV248 EQU   CVTS01+430
CVTRV247 EQU   CVTS01+429
CVTRV246 EQU   CVTS01+428
CVTRV245 EQU   CVTRV237
CVTRV244 EQU   CVTRV237
CVTRV243 EQU   CVTRV237
CVTRV242 EQU   CVTRV237
CVTRV241 EQU   CVTRV237
CVTRV240 EQU   CVTRV237
CVTRV239 EQU   CVTRV237
CVTRV238 EQU   CVTRV237
CVTRV236 EQU   CVTRV228
CVTRV235 EQU   CVTRV228
CVTRV234 EQU   CVTRV228
CVTRV233 EQU   CVTRV228
CVTRV232 EQU   CVTRV228
CVTRV231 EQU   CVTRV228
CVTRV230 EQU   CVTRV228
CVTRV229 EQU   CVTRV228
CVTRV227 EQU   CVTRV219
CVTRV226 EQU   CVTRV219
CVTRV225 EQU   CVTRV219
CVTRV224 EQU   CVTRV219
CVTRV223 EQU   CVTRV219
CVTRV222 EQU   CVTRV219
CVTRV221 EQU   CVTRV219
CVTRV220 EQU   CVTRV219
CVTRV218 EQU   CVTRV210
CVTRV217 EQU   CVTRV210
CVTRV216 EQU   CVTRV210
CVTRV215 EQU   CVTRV210
CVTRV214 EQU   CVTRV210
CVTRV213 EQU   CVTRV210
CVTRV212 EQU   CVTRV210
CVTRV211 EQU   CVTRV210
CVTIPCRP EQU   CVTS01+412
CVTIPCDS EQU   CVTS01+404
CVTAIDVT EQU   CVTS01+400
CVTSSAP  EQU   CVTS01+396
CVTEHCIR EQU   CVTS01+392
CVTEHDEF EQU   CVTS01+388
CVTDAIR  EQU   CVTS01+384
CVTPERFM EQU   CVTS01+380
CVT044R2 EQU   CVTS01+376
CVTFETCH EQU   CVTS01+372
CVTRSTWD EQU   CVTS01+368
CVTSPOST EQU   CVTS01+364
CVTIOBP  EQU   CVTS01+360
CVTASMVT EQU   CVTS01+356
CVTRECRQ EQU   CVTS01+352
CVTWSAC  EQU   CVTS01+348
CVTRV149 EQU   CVTS01+344
CVTWSAL  EQU   CVTS01+340
CVTSPSA  EQU   CVTS01+336
CVTGLMN  EQU   CVTS01+332
CVTVEAC0 EQU   CVTS01+328
CVT062R1 EQU   CVTS01+324
CVTRPOST EQU   CVTS01+320
CVTDQIQE EQU   CVTS01+316
CVTLKRMA EQU   CVTS01+308
CVTRSPIE EQU   CVTS01+304
CVTRENQ  EQU   CVTS01+300
CVTLQCB  EQU   CVTS01+296
CVTFQCB  EQU   CVTS01+292
CVTQCS01 EQU   CVTS01+288
CVTAPFT  EQU   CVTS01+284
CVTPARRL EQU   CVTS01+280
CVTVWAIT EQU   CVTS01+276
CVTGSPL  EQU   CVTS01+272
CVTLSMQ  EQU   CVTS01+268
CVTGSMQ  EQU   CVTS01+264
CVTEXPRO EQU   CVTS01+260
CVTOPCTP EQU   CVTS01+256
CVTSIC   EQU   CVTS01+252
CVTTPIOS EQU   CVTS01+248
CVTRTMS  EQU   CVTS01+244
CVTSDBF  EQU   CVTS01+240
CVTSCBP  EQU   CVTS01+236
CVTSDMP  EQU   CVTS01+232
CVTSV60  EQU   CVTS01+228
CVTRTMCT EQU   CVTS01+224
CVTASCBL EQU   CVTS01+220
CVTASCBH EQU   CVTS01+216
CVTGDA   EQU   CVTS01+212
CVTVVMDI EQU   CVTS01+204
CVTAQTOP EQU   CVTS01+200
CVTIOSCS EQU   CVTS01+196
CVTSDRM  EQU   CVTS01+192
CVTOPTE  EQU   CVTS01+188
CVTSTXU  EQU   CVTS01+184
CVTQUIS  EQU   CVTS01+180
CVTPARS  EQU   CVTS01+176
CVTS1EE  EQU   CVTS01+172
CVTFRAS  EQU   CVTS01+168
CVTQSAS  EQU   CVTS01+164
CVTCRAS  EQU   CVTS01+160
CVTCRMN  EQU   CVTS01+156
CVTDELCP EQU   CVTS01+152
CVTFRECL EQU   CVTS01+148
CVTGETCL EQU   CVTS01+144
CVTBLDCP EQU   CVTS01+140
CVTAUTHL EQU   CVTS01+136
CVTSCAN  EQU   CVTS01+132
CVTRV144 EQU   CVTS01+130
CVTMAXMP EQU   CVTS01+128
CVTSTCK  EQU   CVTS01+124
CVTRV139 EQU   CVTS01+123
CVTDSSAC EQU   CVTS01+122
CVTRV513 EQU   CVTS01+121
CVTIOSPL EQU   CVTS01+120
CVTPTGT  EQU   CVTS01+116
CVTCSPIE EQU   CVTS01+112
CVTSMFEX EQU   CVTS01+108
CVTOLT0A EQU   CVTS01+104
CVTSRBRT EQU   CVTS01+100
CVTPUTL  EQU   CVTS01+96
CVTASCRL EQU   CVTS01+92
CVTASCRF EQU   CVTS01+88
CVTRV326 EQU   CVTS01+84
CVTRV325 EQU   CVTS01+80
CVTRV324 EQU   CVTS01+76
CVT0VL01 EQU   CVTS01+72
CVTSHRVM EQU   CVTS01+68
CVTRV332 EQU   CVTS01+64
CVTTAS   EQU   CVTS01+60
CVTRSCN  EQU   CVTS01+56
CVTTRAC2 EQU   CVTS01+54
CVTTRACE EQU   CVTS01+52
CVTAPG   EQU   CVTS01+51
CVTSDTRC EQU   CVTCTLFG
CVTGTRCE EQU   CVTCTLFG
CVTNOMP  EQU   CVTCTLFG
CVTRSV79 EQU   CVTCTLFG
CVTDSTAT EQU   CVTCTLFG
CVTRSV78 EQU   CVTCTLFG
CVTRV333 EQU   CVTCTLFG
CVTRV323 EQU   CVTCTLFG
CVTSPVLK EQU   CVTS01+49
CVTRSV77 EQU   CVTS01+48
CVTRV331 EQU   CVTS01+44
CVTRV330 EQU   CVTS01+40
CVTRV329 EQU   CVTS01+36
CVTRV328 EQU   CVTS01+32
CVTRV322 EQU   CVTS01+28
CVTSLID  EQU   CVTSLIDA+1
CVTSYLK  EQU   CVTSLIDA
CVTRV321 EQU   CVTS01+20
CVTRV320 EQU   CVTS01+16
CVTLPDIR EQU   CVTLPDIA+1
CVTRSV69 EQU   CVTDIRST
CVTRSV68 EQU   CVTDIRST
CVTRSV67 EQU   CVTDIRST
CVTRSV66 EQU   CVTDIRST
CVTRSV65 EQU   CVTDIRST
CVTRSV64 EQU   CVTDIRST
CVTRSV63 EQU   CVTDIRST
CVTDICOM EQU   CVTDIRST
CVTPVTP  EQU   CVTS01+8
CVTLPDSR EQU   CVTS01+4
CVTGETL  EQU   CVTS01
HO32BITS EQU   CONVALUE
@NM00167 EQU   TCWALFLG
@NM00166 EQU   TCWALFLG
@NM00165 EQU   TCENTRY+14
@NM00164 EQU   TCWACTL+2
@NM00163 EQU   TCWACTL
@NM00162 EQU   TCWACTL
@NM00161 EQU   TCWARPLY+2
@NM00160 EQU   TCWA+53
@NM00159 EQU   TCWAGFLG
@NM00158 EQU   SDWA+512
SDWAVRA  EQU   SDWARA+4
SDWAURAL EQU   SDWARA+3
@NM00157 EQU   SDWADPVA
SDWAEBC  EQU   SDWADPVA
SDWAHEX  EQU   SDWADPVA
SDWAVRAL EQU   SDWARA
@NM00156 EQU   SDWA+396
SDWACOMP EQU   SDWA+392
SDWARCPL EQU   SDWA+364
@NM00155 EQU   SDWADPSA+32
SDWATO4  EQU   SDWADPSL+28
SDWAFRM4 EQU   SDWADPSL+24
SDWATO3  EQU   SDWADPSL+20
SDWAFRM3 EQU   SDWADPSL+16
SDWATO2  EQU   SDWADPSL+12
SDWAFRM2 EQU   SDWADPSL+8
SDWATO1  EQU   SDWADPSL+4
SDWAFRM1 EQU   SDWADPSL
@NM00154 EQU   SDWADDAT+3
@NM00153 EQU   SDWAPDAT
SDWAUSPL EQU   SDWAPDAT
SDWADPSW EQU   SDWAPDAT
SDWATJPA EQU   SDWAPDAT
SDWATLPA EQU   SDWAPDAT
SDWADREG EQU   SDWAPDAT
SDWADSAH EQU   SDWAPDAT
SDWADSAS EQU   SDWAPDAT
@NM00152 EQU   SDWADDAT+1
@NM00151 EQU   SDWASDAT
SDWAQQS  EQU   SDWASDAT
SDWACBS  EQU   SDWASDAT
SDWAGTF  EQU   SDWASDAT
SDWASWA  EQU   SDWASDAT
SDWALSQA EQU   SDWASDAT
SDWASQA  EQU   SDWASDAT
SDWANUC  EQU   SDWASDAT
@NM00150 EQU   SDWADUMP+2
@NM00149 EQU   SDWADPFS
SDWASLST EQU   SDWADPFS
@NM00148 EQU   SDWADPFS
SDWADLST EQU   SDWADPFS
SDWADPT  EQU   SDWADPFS
SDWADPID EQU   SDWADUMP
SDWADPLA EQU   SDWA+316
SDWAREXN EQU   SDWARECP+16
SDWACSCT EQU   SDWARECP+8
SDWAMODN EQU   SDWARECP
@NM00147 EQU   SDWA+290
SDWAASID EQU   SDWA+288
SDWATALW EQU   SDWALKWS+28
SDWATDLW EQU   SDWALKWS+24
SDWATNLW EQU   SDWALKWS+20
SDWAAPLW EQU   SDWALKWS+16
SDWAIPLW EQU   SDWALKWS+12
SDWAILLW EQU   SDWALKWS+8
SDWAIULW EQU   SDWALKWS+4
SDWAICLW EQU   SDWALKWS
SDWAFLLK EQU   SDWAACF4
SDWACMS  EQU   SDWAACF4
SDWAOPTM EQU   SDWAACF4
SDWATADB EQU   SDWAACF4
SDWATDNB EQU   SDWAACF4
SDWATNCB EQU   SDWAACF4
SDWAILCH EQU   SDWAACF4
SDWAIUCB EQU   SDWAACF4
SDWAICAT EQU   SDWAACF3
SDWAIPRG EQU   SDWAACF3
SDWASALL EQU   SDWAACF3
SDWAASMP EQU   SDWAACF3
SDWADISP EQU   SDWAACF3
@NM00146 EQU   SDWAACF3
@NM00145 EQU   SDWAACF2
SDWAUPRG EQU   SDWAACF2
@NM00144 EQU   SDWAACF2
SDWASPIN EQU   SDWAACF2
@NM00143 EQU   SDWAACF2
SDWARCRD EQU   SDWAACF2
SDWALCPU EQU   SDWACPUA+2
@NM00142 EQU   SDWACPUA
SDWARECA EQU   SDWA+244
@NM00141 EQU   SDWA+239
@NM00140 EQU   SDWAIOFS
SDWANIOP EQU   SDWAIOFS
SDWANOIO EQU   SDWAIOFS
SDWAIOHT EQU   SDWAIOFS
SDWAIOQR EQU   SDWAIOFS
SDWAFMID EQU   SDWA+236
@NM00139 EQU   SDWAERRD
SDWAMCIV EQU   SDWAERRD
SDWARPIV EQU   SDWAERRD
SDWAMABD EQU   SDWAERRD
SDWACTS  EQU   SDWAERRD
SDWASTAE EQU   SDWAERRD
SDWANRBE EQU   SDWAERRD
SDWACLUP EQU   SDWAERRD
@NM00138 EQU   SDWAERRC
SDWAEAS  EQU   SDWAERRC
SDWAPERC EQU   SDWAERRC
SDWAIRB  EQU   SDWAERRC
SDWASTAI EQU   SDWAERRC
SDWASTAF EQU   SDWAERRC
SDWASRBM EQU   SDWAERRB
SDWALDIS EQU   SDWAERRB
SDWAENRB EQU   SDWAERRB
SDWATYP1 EQU   SDWAERRB
@NM00137 EQU   SDWAERRB
SDWAPGIO EQU   SDWAERRA
SDWATEXC EQU   SDWAERRA
SDWASVCE EQU   SDWAERRA
SDWAABTM EQU   SDWAERRA
SDWASVCD EQU   SDWAERRA
SDWARKEY EQU   SDWAERRA
SDWAPCHK EQU   SDWAERRA
SDWAMCHK EQU   SDWAERRA
SDWATIME EQU   SDWAMCH+20
SDWARFSA EQU   SDWAMCH+16
@NM00136 EQU   SDWAMCH+14
SDWAVEQR EQU   SDWARSR2
SDWAPGFX EQU   SDWARSR2
SDWAFLSQ EQU   SDWARSR2
SDWAFSQA EQU   SDWARSR2
SDWANUCL EQU   SDWARSR2
SDWASPER EQU   SDWARSR2
SDWAINTC EQU   SDWARSR2
SDWAOFLN EQU   SDWARSR2
SDWACHNG EQU   SDWARSR1
SDWAMSER EQU   SDWARSR1
@NM00135 EQU   SDWARSR1
SDWACPID EQU   SDWAMCH+10
SDWATERR EQU   SDWAMCHD
SDWAFPRX EQU   SDWAMCHD
SDWAINSF EQU   SDWAMCHD
SDWAACR  EQU   SDWAMCHD
SDWASCK  EQU   SDWAMCHD
SDWAPSWU EQU   SDWAMCHD
SDWAREGU EQU   SDWAMCHD
SDWASKYF EQU   SDWAMCHD
@NM00134 EQU   SDWAMCHS
SDWARSRF EQU   SDWAMCHS
SDWARSRC EQU   SDWAMCHS
SDWAINVP EQU   SDWAMCHS
SDWATSVL EQU   SDWAMCHS
SDWARCDF EQU   SDWAMCHS
SDWASRVL EQU   SDWAMCHS
SDWASCKE EQU   SDWASTCK+4
SDWASCKB EQU   SDWASTCK
SDWALNTH EQU   SDWAIDNT+1
SDWASPID EQU   SDWAIDNT
SDWASR15 EQU   SDWASRSV+60
SDWASR14 EQU   SDWASRSV+56
SDWASR13 EQU   SDWASRSV+52
SDWASR12 EQU   SDWASRSV+48
SDWASR11 EQU   SDWASRSV+44
SDWASR10 EQU   SDWASRSV+40
SDWASR09 EQU   SDWASRSV+36
SDWASR08 EQU   SDWASRSV+32
SDWASR07 EQU   SDWASRSV+28
SDWASR06 EQU   SDWASRSV+24
SDWASR05 EQU   SDWASRSV+20
SDWASR04 EQU   SDWASRSV+16
SDWASR03 EQU   SDWASRSV+12
SDWASR02 EQU   SDWASRSV+8
SDWASR01 EQU   SDWASRSV+4
SDWASR00 EQU   SDWASRSV
SDWATRN2 EQU   SDWAAEC2+4
SDWAIPC2 EQU   SDWAICD2
SDWAIMC2 EQU   SDWAICD2
SDWAIPR2 EQU   SDWAICD2
@NM00133 EQU   SDWAINC2
@NM00132 EQU   SDWAILC2
SDWAIL2  EQU   SDWAILC2
@NM00131 EQU   SDWAILC2
@NM00130 EQU   SDWAAEC2
SDWAADD2 EQU   SDWANXT2+1
@NM00129 EQU   SDWANXT2
@NM00128 EQU   SDWAEC2+3
SDWASGN2 EQU   SDWAINT2
SDWAEXP2 EQU   SDWAINT2
SDWADEC2 EQU   SDWAINT2
SDWAFPO2 EQU   SDWAINT2
SDWACC2  EQU   SDWAINT2
@NM00127 EQU   SDWAINT2
SDWAPGM2 EQU   SDWAMWP2
SDWAWAT2 EQU   SDWAMWP2
SDWAMCK2 EQU   SDWAMWP2
SDWAECT2 EQU   SDWAMWP2
SDWAKEY2 EQU   SDWAMWP2
SDWAEXT2 EQU   SDWAEMK2
SDWAIO2  EQU   SDWAEMK2
SDWATRM2 EQU   SDWAEMK2
@NM00126 EQU   SDWAEMK2
SDWAPER2 EQU   SDWAEMK2
@NM00125 EQU   SDWAEMK2
SDWATRAN EQU   SDWAAEC1+4
SDWAIPC1 EQU   SDWAICD1
SDWAIMC1 EQU   SDWAICD1
SDWAIPR1 EQU   SDWAICD1
@NM00124 EQU   SDWAINC1
@NM00123 EQU   SDWAILC1
SDWAIL1  EQU   SDWAILC1
@NM00122 EQU   SDWAILC1
@NM00121 EQU   SDWAAEC1
SDWAADD1 EQU   SDWANXT1+1
@NM00120 EQU   SDWANXT1
@NM00119 EQU   SDWAEC1+3
SDWASGN1 EQU   SDWAINT1
SDWAEXP1 EQU   SDWAINT1
SDWADEC1 EQU   SDWAINT1
SDWAFPO1 EQU   SDWAINT1
SDWACC1  EQU   SDWAINT1
@NM00118 EQU   SDWAINT1
SDWAPGM1 EQU   SDWAMWP1
SDWAWAT1 EQU   SDWAMWP1
SDWAMCK1 EQU   SDWAMWP1
SDWAECT1 EQU   SDWAMWP1
SDWAKEY1 EQU   SDWAMWP1
SDWAEXT1 EQU   SDWAEMK1
SDWAIO1  EQU   SDWAEMK1
SDWATRM1 EQU   SDWAEMK1
@NM00117 EQU   SDWAEMK1
SDWAPER1 EQU   SDWAEMK1
@NM00116 EQU   SDWAEMK1
SDWAIOBR EQU   SDWA+100
SDWAEPA  EQU   SDWA+96
@NM00115 EQU   SDWANAME+4
SDWARBAD EQU   SDWANAME
SDWAGR15 EQU   SDWAGRSV+60
SDWAGR14 EQU   SDWAGRSV+56
SDWAGR13 EQU   SDWAGRSV+52
SDWAGR12 EQU   SDWAGRSV+48
SDWAGR11 EQU   SDWAGRSV+44
SDWAGR10 EQU   SDWAGRSV+40
SDWAGR09 EQU   SDWAGRSV+36
SDWAGR08 EQU   SDWAGRSV+32
SDWAGR07 EQU   SDWAGRSV+28
SDWAGR06 EQU   SDWAGRSV+24
SDWAGR05 EQU   SDWAGRSV+20
SDWAGR04 EQU   SDWAGRSV+16
SDWAGR03 EQU   SDWAGRSV+12
SDWAGR02 EQU   SDWAGRSV+8
SDWAGR01 EQU   SDWAGRSV+4
SDWAGR00 EQU   SDWAGRSV
SDWANXTP EQU   SDWACTL2+5
SDWASGP  EQU   SDWAPMKP
SDWAEUP  EQU   SDWAPMKP
SDWADOP  EQU   SDWAPMKP
SDWAFPP  EQU   SDWAPMKP
SDWACCP  EQU   SDWAPMKP
SDWAILP  EQU   SDWAPMKP
SDWAINTP EQU   SDWACTL2+2
SDWASPVP EQU   SDWAMWPP
SDWAWATP EQU   SDWAMWPP
SDWAMCKP EQU   SDWAMWPP
@NM00114 EQU   SDWAMWPP
SDWAKEYP EQU   SDWAMWPP
SDWAEXTP EQU   SDWACMKP
SDWAIOP  EQU   SDWACMKP
SDWANXTA EQU   SDWACTL1+5
SDWASGA  EQU   SDWAPMKA
SDWAEUA  EQU   SDWAPMKA
SDWADOA  EQU   SDWAPMKA
SDWAFPA  EQU   SDWAPMKA
SDWACCA  EQU   SDWAPMKA
SDWAILA  EQU   SDWAPMKA
SDWAINTA EQU   SDWACTL1+2
SDWASPVA EQU   SDWAMWPA
SDWAWATA EQU   SDWAMWPA
SDWAMCKA EQU   SDWAMWPA
@NM00113 EQU   SDWAMWPA
SDWAKEYA EQU   SDWAMWPA
SDWAEXTA EQU   SDWACMKA
SDWAIOA  EQU   SDWACMKA
SDWACMPC EQU   SDWAABCC+1
@NM00112 EQU   SDWACMPF
SDWASTCC EQU   SDWACMPF
@NM00111 EQU   SDWACMPF
SDWASTEP EQU   SDWACMPF
CVTLEVL  EQU   CVTRELNO+2
CVTNUMB  EQU   CVTRELNO
CVTMDL   EQU   CVTFIX+250
@NM00110 EQU   CVTFIX+248
@NM00109 EQU   CVTFIX
CVTRV482 EQU   CVTXTNT2+128
CVTRV481 EQU   CVTXTNT2+124
CVTRV480 EQU   CVTXTNT2+120
CVTRV479 EQU   CVTXTNT2+118
CVTRV478 EQU   CVTXTNT2+117
CVTRV477 EQU   CVTXTNT2+116
CVTRV476 EQU   CVTXTNT2+115
CVTRV475 EQU   CVTXTNT2+114
CVTRV474 EQU   CVTRV466
CVTRV473 EQU   CVTRV466
CVTRV472 EQU   CVTRV466
CVTRV471 EQU   CVTRV466
CVTRV470 EQU   CVTRV466
CVTRV469 EQU   CVTRV466
CVTRV468 EQU   CVTRV466
CVTRV467 EQU   CVTRV466
CVTRV465 EQU   CVTRV457
CVTRV464 EQU   CVTRV457
CVTRV463 EQU   CVTRV457
CVTRV462 EQU   CVTRV457
CVTRV461 EQU   CVTRV457
CVTRV460 EQU   CVTRV457
CVTRV459 EQU   CVTRV457
CVTRV458 EQU   CVTRV457
CVTRV456 EQU   CVTXTNT2+108
CVTRV455 EQU   CVTXTNT2+104
CVTRV454 EQU   CVTXTNT2+100
CVTRV453 EQU   CVTXTNT2+96
CVTRV452 EQU   CVTXTNT2+94
CVTRV451 EQU   CVTXTNT2+92
CVTRV450 EQU   CVTXTNT2+90
CVTRV449 EQU   CVTXTNT2+88
CVTRV448 EQU   CVTXTNT2+87
CVTRV447 EQU   CVTXTNT2+86
CVTRV446 EQU   CVTRV438
CVTRV445 EQU   CVTRV438
CVTRV444 EQU   CVTRV438
CVTRV443 EQU   CVTRV438
CVTRV442 EQU   CVTRV438
CVTRV441 EQU   CVTRV438
CVTRV440 EQU   CVTRV438
CVTRV439 EQU   CVTRV438
CVTRV437 EQU   CVTRV429
CVTRV436 EQU   CVTRV429
CVTRV435 EQU   CVTRV429
CVTRV434 EQU   CVTRV429
CVTRV433 EQU   CVTRV429
CVTRV432 EQU   CVTRV429
CVTRV431 EQU   CVTRV429
CVTRV430 EQU   CVTRV429
CVTRV428 EQU   CVTXTNT2+80
CVTRV427 EQU   CVTXTNT2+76
CVTRV426 EQU   CVTXTNT2+72
CVTRV425 EQU   CVTXTNT2+68
CVTATACT EQU   CVTATCVT
CVTRV423 EQU   CVTXTNT2+62
CVTRV422 EQU   CVTXTNT2+60
CVTRV421 EQU   CVTXTNT2+58
CVTRV420 EQU   CVTXTNT2+56
CVTRV419 EQU   CVTXTNT2+55
CVTRV418 EQU   CVTXTNT2+54
CVTRV417 EQU   CVTRV409
CVTRV416 EQU   CVTRV409
CVTRV415 EQU   CVTRV409
CVTRV414 EQU   CVTRV409
CVTRV413 EQU   CVTRV409
CVTRV412 EQU   CVTRV409
CVTRV411 EQU   CVTRV409
CVTRV410 EQU   CVTRV409
CVTRV408 EQU   CVTRV400
CVTRV407 EQU   CVTRV400
CVTRV406 EQU   CVTRV400
CVTRV405 EQU   CVTRV400
CVTRV404 EQU   CVTRV400
CVTRV403 EQU   CVTRV400
CVTRV402 EQU   CVTRV400
CVTRV401 EQU   CVTRV400
CVTICB   EQU   CVTXTNT2+48
CVTSKTA  EQU   CVTXTNT2+44
CVTCCVT  EQU   CVTXTNT2+40
CVTRSV98 EQU   CVTXTNT2+36
CVTRSV97 EQU   CVTXTNT2+34
CVTRSV96 EQU   CVTXTNT2+32
CVTOLTEP EQU   CVTXTNT2+28
CVTQIDA  EQU   CVTQID+1
CVTRSV95 EQU   CVTQID
CVTRSV94 EQU   CVTXTNT2+20
CVTRSV93 EQU   CVTXTNT2+16
CVTRSV92 EQU   CVTXTNT2+12
CVTDEBVR EQU   CVTXTNT2+8
CVTRSV91 EQU   CVTXTNT2+6
CVTRSV9H EQU   CVTFLGBT
CVTRSV9G EQU   CVTFLGBT
CVTRSV9F EQU   CVTFLGBT
CVTRSV9E EQU   CVTFLGBT
CVTRSV9D EQU   CVTFLGBT
CVTRSV9C EQU   CVTFLGBT
CVTVME   EQU   CVTFLGBT
CVTNPE   EQU   CVTFLGBT
CVTNUCLS EQU   CVTXTNT2+4
CVTDSSVA EQU   CVTDSSV+1
CVTRSV89 EQU   CVTDSSV
CVTRSV88 EQU   CVTXTNT1+8
CVTRSV87 EQU   CVTXTNT1+4
CVTFACHN EQU   CVTXTNT1
CVTRV488 EQU   CVTMAP+412
CVTRV487 EQU   CVTMAP+408
CVTRV486 EQU   CVTMAP+404
CVTRV485 EQU   CVTMAP+400
CVTACTAP EQU   CVTMAP+396
CVTAUTH  EQU   CVTMAP+392
CVTATMCA EQU   CVTATMCT+1
CVTATMST EQU   CVTATMCT
CVTRSV61 EQU   CVTMAP+384
CVTVOLT1 EQU   CVTVOLM1+1
CVTVOLI1 EQU   CVTVOLF1
CVTSTOA  EQU   CVTMAP+376
CVTRSV58 EQU   CVTMAP+374
CVTRSV57 EQU   CVTMAP+372
CVTDDCE  EQU   CVTMAP+368
CVTPNWFR EQU   CVTMAP+364
CVTSMF   EQU   CVTMAP+360
CVTSULK  EQU   CVTMAP+358
CVTSLKO  EQU   CVTSYSK
CVTSLKP  EQU   CVTSYSK
CVTSLKQ  EQU   CVTSYSK
CVTSLKR  EQU   CVTSYSK
CVTRSV56 EQU   CVTSYSK
CVTRSV55 EQU   CVTSYSK
CVTRSV54 EQU   CVTSYSK
CVTRSV53 EQU   CVTSYSK
CVTRSV52 EQU   CVTA1F1
CVTRSV51 EQU   CVTA1F1
CVTRSV50 EQU   CVTA1F1
CVTRSV49 EQU   CVTA1F1
CVTRSV48 EQU   CVTA1F1
CVTRSV47 EQU   CVTA1F1
CVTSRSW  EQU   CVTA1F1
CVTPFSW  EQU   CVTA1F1
CVTPCVT  EQU   CVTMAP+352
CVTRSV46 EQU   CVTMAP+344
CVTRSV45 EQU   CVTMAP+340
CVTRSV44 EQU   CVTMAP+338
CVTRSV43 EQU   CVTMAP+336
CVTHJESA EQU   CVTHJES+1
CVTRSV42 EQU   CVTHJES
CVTEXT2A EQU   CVTEXT2+1
CVTRSV41 EQU   CVTEXT2
CVTAPFA  EQU   CVTAPF+1
CVTRSV40 EQU   CVTAPF
CVTRV518 EQU   CVTINTLA
CVTRV517 EQU   CVTERPV
CVTEORM  EQU   CVTMAP+312
CVTMCHPR EQU   CVTMAP+308
CVTJEPS  EQU   CVTMAP+300
CVTJESCT EQU   CVTMAP+296
CVTMODE  EQU   CVTMAP+292
CVTPTRV  EQU   CVTMAP+288
CVTREAL  EQU   CVTMAP+284
CVTRSV39 EQU   CVTMAP+280
CVTRSV38 EQU   CVTMAP+276
CVTDMSRA EQU   CVTDMSR+1
CVTRV634 EQU   CVTDMSRF
CVTRV633 EQU   CVTDMSRF
CVTRV632 EQU   CVTDMSRF
CVTRV631 EQU   CVTDMSRF
CVTRV630 EQU   CVTDMSRF
CVTRV629 EQU   CVTDMSRF
CVTUDUMP EQU   CVTDMSRF
CVTSDUMP EQU   CVTDMSRF
CVTQMSGA EQU   CVTQMSG+1
CVTRSV36 EQU   CVTQMSG
CVTAMFF  EQU   CVTMAP+264
CVTPURGA EQU   CVTPURG+1
CVTRSV35 EQU   CVTPURG
CVTCBSP  EQU   CVTMAP+256
CVTATERA EQU   CVTATER+1
CVTSYST  EQU   CVTATER
CVTVOLT2 EQU   CVTTAT
CVTVOLI2 EQU   CVTVOLF2
CVTAQAVB EQU   CVTAQAVT+1
CVTRSV34 EQU   CVTTCMFG
CVTRSV33 EQU   CVTTCMFG
CVTRSV32 EQU   CVTTCMFG
CVTRSV31 EQU   CVTTCMFG
CVTRSV30 EQU   CVTTCMFG
CVTRSV29 EQU   CVTTCMFG
CVTRSV28 EQU   CVTTCMFG
CVTTCRDY EQU   CVTTCMFG
CVTGTFA  EQU   CVTGTF+1
CVTRSV27 EQU   CVTGTFST
CVTRNIO  EQU   CVTGTFST
CVTUSR   EQU   CVTGTFST
CVTRV318 EQU   CVTFORM
CVTRV317 EQU   CVTTMODE
CVTRV316 EQU   CVTSTATE
CVTRV315 EQU   CVTGTFS
CVTGTFAV EQU   CVTGTFS
CVT0SCR1 EQU   CVTMAP+232
CVTRV515 EQU   CVTMAP+228
CVTRMS   EQU   CVTMAP+224
CVTPATCH EQU   CVTMAP+220
CVTTSCE  EQU   CVTMAP+216
CVTLNKSC EQU   CVTMAP+214
CVTQABST EQU   CVTMAP+212
CVTMDLDS EQU   CVTMAP+208
CVTUSER  EQU   CVTMAP+204
CVTABEND EQU   CVTMAP+200
CVTSMCA  EQU   CVTMAP+196
CVTRSV18 EQU   CVTMAP+192
CVTQLPAQ EQU   CVTMAP+188
CVTQCDSR EQU   CVTMAP+184
CVTRSV17 EQU   CVTOPTB
CVTRSV16 EQU   CVTOPTB
CVTFP    EQU   CVTOPTB
CVTAPTHR EQU   CVTOPTB
CVTNLOG  EQU   CVTOPTB
CVTTOD   EQU   CVTOPTB
CVTCTIMS EQU   CVTOPTB
CVTPROT  EQU   CVTOPTB
CVTXPFP  EQU   CVTOPTA
CVTASCII EQU   CVTOPTA
CVTRSV13 EQU   CVTOPTA
CVTRSV12 EQU   CVTOPTA
CVTNIP   EQU   CVTOPTA
CVTDDR   EQU   CVTOPTA
CVTAPR   EQU   CVTOPTA
CVTCCH   EQU   CVTOPTA
CVTSNCTR EQU   CVTMAP+180
CVTQMWR  EQU   CVTMAP+176
CVTQOCR  EQU   CVTMAP+172
CVT1EF00 EQU   CVTMAP+168
CVTMZ00  EQU   CVTMAP+164
CVTSV76Q EQU   CVTSV76C
CVTRSV11 EQU   CVTMAP+156
CVT0PT01 EQU   CVTMAP+152
CVTRV516 EQU   CVTIERLC
CVTILCH  EQU   CVTMAP+140
CVT0DS   EQU   CVTMAP+136
CVTFBOSV EQU   CVTMAP+132
CVTNUCB  EQU   CVTMAP+128
CVTIXAVL EQU   CVTMAP+124
CVTSV76M EQU   CVTIOQET
CVTDCBA  EQU   CVTMAP+117
CVTMVS2  EQU   CVTDCB
CVT6DAT  EQU   CVTDCB
CVT4MPS  EQU   CVTDCB
CVTRSV09 EQU   CVTDCB
CVT4MS1  EQU   CVTDCB
CVT2SPS  EQU   CVTDCB
CVT1SSS  EQU   CVTDCB
CVTRSV08 EQU   CVTDCB
CVTSTB   EQU   CVTMAP+112
CVTCUCB  EQU   CVTMAP+100
CVTSJQ   EQU   CVTMAP+96
CVTPBLDL EQU   CVTMAP+92
CVTSVDCB EQU   CVTMAP+84
CVTBRET  EQU   CVTMAP+82
CVT0FN00 EQU   CVTMAP+76
CVTDARA  EQU   CVTDAR+1
CVTRSV07 EQU   CVTFLGS1
CVTRSV06 EQU   CVTFLGS1
CVTRSV05 EQU   CVTFLGS1
CVTRSV04 EQU   CVTFLGS1
CVTRSV03 EQU   CVTFLGS1
CVTRSV02 EQU   CVTFLGS1
CVTRSV01 EQU   CVTFLGS1
CVTDMPLK EQU   CVTFLGS1
CVTXITP  EQU   CVTMAP+68
CVTZDTAB EQU   CVTMAP+64
CVTMSLT  EQU   CVTMAP+60
CVTBTERM EQU   CVTMAP+52
CVTSYSAD EQU   CVTMAP+48
CVTXTLER EQU   CVTMAP+44
CVTILK2  EQU   CVTMAP+40
CVTILK1  EQU   CVTMAP+36
CVTPRLTV EQU   CVTMAP+32
CVTPCNVT EQU   CVTMAP+28
CVT0VL00 EQU   CVTMAP+24
CVTXAPG  EQU   CVTMAP+20
CVTBUF   EQU   CVTMAP+16
CVTJOB   EQU   CVTMAP+12
CVTLINK  EQU   CVTMAP+8
CVT0EF00 EQU   CVTMAP+4
CVTTCBP  EQU   CVTMAP
@NM00108 EQU   TQE+88
TQESRB   EQU   TQE+44
TQELHPSW EQU   TQE+40
TQEASCB  EQU   TQE+36
TQETCB   EQU   TQE+32
TQESADDR EQU   TQE+24
TQEMIDN  EQU   TQEFLGS2
TQEMF1   EQU   TQEFLGS2
TQEOPT   EQU   TQEFLGS2
TQELM    EQU   TQEFLGS2
TQEDUM   EQU   TQEFLGS2
TQECRH   EQU   TQEFLGS2
TQEUSER  EQU   TQEFLGS2
TQETYPE  EQU   TQEFLGS
TQEXITSP EQU   TQEFLGS
TQEINCOM EQU   TQEFLGS
TQEWLIM  EQU   TQEFLGS
@NM00107 EQU   TQEFLGS
TQETOD   EQU   TQEFLGS
TQEOFF   EQU   TQEFLGS
TQEAID   EQU   TQE+12
TQEBLNK  EQU   TQE+8
TQEFLNK  EQU   TQE+4
TQETQE   EQU   TQE
@NM00106 EQU   PCCA+512
PCCACAT  EQU   PCCA+384
PCCARV36 EQU   PCCA+380
PCCARV35 EQU   PCCA+378
PCCARV01 EQU   PCCA+377
PCCACPUM EQU   PCCA+376
PCCARV63 EQU   PCCA+372
PCCARV62 EQU   PCCA+368
PCCARV61 EQU   PCCA+364
PCCARV60 EQU   PCCA+360
PCCARV59 EQU   PCCA+356
PCCARV58 EQU   PCCA+352
PCCARV57 EQU   PCCA+348
PCCARV56 EQU   PCCA+344
PCCARV55 EQU   PCCA+340
PCCARV54 EQU   PCCA+336
PCCALOGA EQU   PCCA+332
PCCACHID EQU   PCCA+324
PCCACHSV EQU   PCCA+312
PCCARV79 EQU   PCCACHF4
PCCARV78 EQU   PCCACHF4
PCCARV77 EQU   PCCACHF4
PCCARV76 EQU   PCCACHF4
PCCARV75 EQU   PCCACHF4
PCCARV74 EQU   PCCACHF4
PCCARV73 EQU   PCCACHF4
PCCARV72 EQU   PCCACHF4
PCCARV71 EQU   PCCACHF3
PCCARV70 EQU   PCCACHF3
PCCARV69 EQU   PCCACHF3
PCCARV68 EQU   PCCACHF3
PCCARV67 EQU   PCCACHF3
PCCARV66 EQU   PCCACHF3
PCCARV65 EQU   PCCACHF3
PCCARV64 EQU   PCCACHF3
PCCACF28 EQU   PCCACHF2
PCCACF27 EQU   PCCACHF2
PCCACF26 EQU   PCCACHF2
PCCACF25 EQU   PCCACHF2
PCCACF24 EQU   PCCACHF2
PCCACF23 EQU   PCCACHF2
PCCACF22 EQU   PCCACHF2
PCCACF21 EQU   PCCACHF2
PCCACF18 EQU   PCCACHF1
PCCACF17 EQU   PCCACHF1
PCCACF16 EQU   PCCACHF1
PCCACF15 EQU   PCCACHF1
PCCACF14 EQU   PCCACHF1
PCCACF13 EQU   PCCACHF1
PCCACF12 EQU   PCCACHF1
PCCACF11 EQU   PCCACHF1
PCCARV05 EQU   PCCA+306
PCCACHPB EQU   PCCA+305
PCCALGP2 EQU   PCCA+304
PCCALGP1 EQU   PCCA+303
PCCALOGL EQU   PCCA+302
PCCARV80 EQU   PCCA+300
PCCACHW2 EQU   PCCA+296
PCCACHW1 EQU   PCCA+292
PCCAIOSI EQU   PCCA+291
PCCACNRB EQU   PCCACHRB
PCCACCVB EQU   PCCACHRB
PCCACSNB EQU   PCCACHRB
PCCARV52 EQU   PCCACHRB
PCCACHIB EQU   PCCACHRB
PCCACTIB EQU   PCCACHRB
PCCACINB EQU   PCCACHRB
PCCACSIB EQU   PCCACHRB
PCCARV51 EQU   PCCACHS2
PCCARV50 EQU   PCCACHS2
PCCACCRA EQU   PCCACHS2
PCCACURC EQU   PCCACHS2
PCCACNLG EQU   PCCACHS2
PCCACMOD EQU   PCCACHS2
PCCACALT EQU   PCCACHS2
PCCACIOR EQU   PCCACHS2
PCCARV47 EQU   PCCACHS1
PCCACUCB EQU   PCCACHS1
PCCACIBC EQU   PCCACHS1
PCCACAND EQU   PCCACHS1
PCCACNLS EQU   PCCACHS1
PCCACFRR EQU   PCCACHS1
PCCACNRE EQU   PCCACHS1
PCCACCMP EQU   PCCACHS1
PCCACSEQ EQU   PCCACHTS
PCCACDIN EQU   PCCACHTS
PCCARV44 EQU   PCCACHTS
PCCARV43 EQU   PCCACHTS
PCCACTEC EQU   PCCACHTS
PCCACDAV EQU   PCCACHVA
PCCACCHV EQU   PCCACHVA
PCCACCMD EQU   PCCACHVA
PCCACUNS EQU   PCCACHVA
PCCACSQV EQU   PCCACHVA
PCCARV42 EQU   PCCACHVA
PCCARV41 EQU   PCCACHVA
PCCACITF EQU   PCCACHVA
PCCARV40 EQU   PCCACHBL
PCCARV39 EQU   PCCACHBL
PCCARV38 EQU   PCCACHBL
PCCACCUE EQU   PCCACHBL
PCCACSTG EQU   PCCACHBL
PCCACSCU EQU   PCCACHBL
PCCACCHA EQU   PCCACHBL
PCCACCPU EQU   PCCACHBL
PCCACNOR EQU   PCCACHPF
PCCACCNT EQU   PCCACHPF
PCCACSNS EQU   PCCACHPF
PCCARV37 EQU   PCCACHPF
PCCACHIO EQU   PCCACHPF
PCCACTIO EQU   PCCACHPF
PCCACINT EQU   PCCACHPF
PCCACSIO EQU   PCCACHPF
PCCACHUB EQU   PCCAWERP
PCCACHEL EQU   PCCA+168
PCCALRBR EQU   PCCA+164
PCCALRBV EQU   PCCA+160
PCCAPWAR EQU   PCCA+156
PCCAPWAV EQU   PCCA+152
PCCAEMSA EQU   PCCAEMSB+12
PCCAEMSE EQU   PCCAEMSB+8
PCCAEMSP EQU   PCCAEMSB+4
PCCARMS  EQU   PCCARMSB
PCCARV34 EQU   PCCARMSB
PCCARV33 EQU   PCCARMSB
PCCARV32 EQU   PCCARMSB
PCCARV31 EQU   PCCARMSB
PCCARV30 EQU   PCCARMSB
PCCARV29 EQU   PCCARMSB
PCCARV28 EQU   PCCARMSB
PCCARV27 EQU   PCCAEMS3
PCCARV26 EQU   PCCAEMS3
PCCARV25 EQU   PCCAEMS3
PCCARV24 EQU   PCCAEMS3
PCCARV23 EQU   PCCAEMS3
PCCARV22 EQU   PCCAEMS3
PCCARV21 EQU   PCCAEMS3
PCCARV20 EQU   PCCAEMS3
PCCARV19 EQU   PCCAEMS2
PCCARV18 EQU   PCCAEMS2
PCCARV17 EQU   PCCAEMS2
PCCARV16 EQU   PCCAEMS2
PCCARV15 EQU   PCCAEMS2
PCCARV14 EQU   PCCAEMS2
PCCARV13 EQU   PCCAEMS2
PCCARV12 EQU   PCCAEMS2
PCCARV11 EQU   PCCARISP
PCCARV10 EQU   PCCARISP
PCCARV09 EQU   PCCARISP
PCCARV08 EQU   PCCARISP
PCCARV07 EQU   PCCARISP
PCCARV06 EQU   PCCARISP
PCCASERL EQU   PCCARISP
PCCAPARL EQU   PCCARISP
PCCARPB  EQU   PCCA+132
PCCACTIN EQU   PCCAINTE
PCCACTCC EQU   PCCACCE
PCCACTTD EQU   PCCATODE
PCCARV04 EQU   PCCATMFL
PCCARV03 EQU   PCCATMFL
PCCARV02 EQU   PCCATMFL
PCCAINIT EQU   PCCATMFL
PCCARV9E EQU   PCCA+124
PCCARV9D EQU   PCCA+120
PCCARV9C EQU   PCCA+116
PCCARV9B EQU   PCCA+112
PCCARV9A EQU   PCCA+108
PCCARV99 EQU   PCCA+104
PCCARV98 EQU   PCCA+100
PCCARV97 EQU   PCCA+96
PCCARV96 EQU   PCCA+92
PCCARV95 EQU   PCCA+88
PCCARV94 EQU   PCCA+84
PCCARV93 EQU   PCCA+80
PCCARV92 EQU   PCCA+76
PCCARV91 EQU   PCCA+72
PCCARV90 EQU   PCCA+68
PCCARV89 EQU   PCCA+64
PCCARV88 EQU   PCCA+60
PCCARV87 EQU   PCCA+56
PCCARV86 EQU   PCCA+52
PCCARV85 EQU   PCCA+48
PCCARV84 EQU   PCCA+44
PCCARV83 EQU   PCCA+40
PCCARV82 EQU   PCCA+36
PCCARV81 EQU   PCCA+32
PCCAPSAR EQU   PCCA+28
PCCACAFM EQU   PCCA+18
PCCACPID EQU   PCCA+4
PCCAPCCA EQU   PCCA
@NM00105 EQU   CSD+160
CSDMASK  EQU   CSD+128
CSDUCNT  EQU   CSD+124
CSDTCNT  EQU   CSD+120
CSDDDRCT EQU   CSD+106
CSDRV044 EQU   CSD+104
CSDMAFF  EQU   CSD+24
CSDRV038 EQU   CSDFLAGS
CSDRV037 EQU   CSDFLAGS
CSDRV036 EQU   CSDFLAGS
CSDRV035 EQU   CSDFLAGS
CSDRV034 EQU   CSDFLAGS
CSDRV033 EQU   CSDFLAGS
CSDRV032 EQU   CSDFLAGS
CSDACR   EQU   CSD+22
CSDMF1CP EQU   CSD+20
CSDRV043 EQU   CSD+16
CSDRV030 EQU   CSDSCFL4
CSDRV029 EQU   CSDSCFL4
CSDRV028 EQU   CSDSCFL4
CSDRV027 EQU   CSDSCFL4
CSDRV026 EQU   CSDSCFL4
CSDRV025 EQU   CSDSCFL4
CSDRV024 EQU   CSDSCFL4
CSDRV023 EQU   CSDSCFL4
CSDRV022 EQU   CSDSCFL3
CSDRV021 EQU   CSDSCFL3
CSDRV020 EQU   CSDSCFL3
CSDRV019 EQU   CSDSCFL3
CSDRV018 EQU   CSDSCFL3
CSDRV017 EQU   CSDSCFL3
CSDRV016 EQU   CSDSCFL3
CSDRV015 EQU   CSDSCFL3
CSDRV014 EQU   CSDSCFL2
CSDRV013 EQU   CSDSCFL2
CSDRV012 EQU   CSDSCFL2
CSDRV011 EQU   CSDSCFL2
CSDRV010 EQU   CSDSCFL2
CSDRV009 EQU   CSDSCFL2
CSDRV008 EQU   CSDSCFL2
CSDRV007 EQU   CSDSCFL2
CSDRV006 EQU   CSDSCFL1
CSDRV005 EQU   CSDSCFL1
CSDRV004 EQU   CSDSCFL1
CSDRV003 EQU   CSDSCFL1
CSDRV002 EQU   CSDSCFL1
CSDRV001 EQU   CSDSCFL1
CSDSYSND EQU   CSDSCFL1
CSDRV042 EQU   CSDSCFL1
CSDSAFF  EQU   CSDCPUAL
CSDCHAD  EQU   CSD+6
CSDCPUJS EQU   CSD+4
CSDCSD   EQU   CSD
ASCBEND  EQU   ASCB+208
ASCBSRBT EQU   ASCB+200
ASCBSWTL EQU   ASCB+196
ASCBRS14 EQU   ASCB+195
ASCBSMCT EQU   ASCB+194
ASCBRS12 EQU   ASCB+192
ASCBPCTT EQU   ASCB+188
ASCBVGTT EQU   ASCB+184
ASCBLGCB EQU   ASCB+180
ASCBJBNS EQU   ASCB+176
ASCBJBNI EQU   ASCB+172
ASCBMCC  EQU   ASCB+168
ASCBRTWA EQU   ASCB+164
ASCBIQEA EQU   ASCB+160
ASCBXMPQ EQU   ASCB+156
ASCBRS01 EQU   ASCB+154
ASCBFMCT EQU   ASCB+152
ASCBOUXB EQU   ASCB+148
ASCBOUCB EQU   ASCB+144
ASCBMECB EQU   ASCB+140
ASCBQECB EQU   ASCB+136
ASCBCMSB EQU   ASCB+132
ASCBCMSF EQU   ASCB+128
ASCBTCBS EQU   ASCB+124
ASCBNVSC EQU   ASCB+122
ASCBVSC  EQU   ASCB+120
ASCBSRBS EQU   ASCB+118
ASCBSSRB EQU   ASCB+116
ASCBRV06 EQU   ASCBFLG2
ASCBRV05 EQU   ASCBFLG2
ASCBRV04 EQU   ASCBFLG2
ASCBSNQS EQU   ASCBFLG2
ASCBS2S  EQU   ASCBFLG2
ASCBCEXT EQU   ASCBFLG2
ASCBPXMT EQU   ASCBFLG2
ASCBXMPT EQU   ASCBFLG2
ASCBRF07 EQU   ASCBDSP1
ASCBRF06 EQU   ASCBDSP1
ASCBRF05 EQU   ASCBDSP1
ASCBRF04 EQU   ASCBDSP1
ASCBRF03 EQU   ASCBDSP1
ASCBRF02 EQU   ASCBDSP1
ASCBFAIL EQU   ASCBDSP1
ASCBNOQ  EQU   ASCBDSP1
ASCBSWCT EQU   ASCB+112
ASCBASXB EQU   ASCB+108
ASCBTMCH EQU   ASCB+104
ASCBNSWP EQU   ASCBFLG1
ASCBTYP1 EQU   ASCBFLG1
ASCBSTND EQU   ASCBFLG1
ASCBABNT EQU   ASCBFLG1
ASCBTERM EQU   ASCBFLG1
ASCBS3S  EQU   ASCBFLG1
ASCBCMSH EQU   ASCBFLG1
ASCBTOFF EQU   ASCBFLG1
ASCBRF01 EQU   ASCBRCTF
ASCBTMLW EQU   ASCBRCTF
ASCBOUT  EQU   ASCBRCTF
ASCBWAIT EQU   ASCBRCTF
ASCBRV08 EQU   ASCBRCTF
ASCBFQU  EQU   ASCBRCTF
ASCBFRS  EQU   ASCBRCTF
ASCBTMNO EQU   ASCBRCTF
ASCBAFFN EQU   ASCBFW1
ASCBDUMP EQU   ASCB+96
ASCBQSVC EQU   ASCB+92
ASCBUBET EQU   ASCB+88
ASCBECB  EQU   ASCB+84
ASCBJSTL EQU   ASCB+80
ASCBEWST EQU   ASCB+72
ASCBTSB  EQU   ASCB+60
ASCBCSCB EQU   ASCB+56
ASCBRSM  EQU   ASCB+52
ASCBLDA  EQU   ASCB+48
ASCBSTOR EQU   ASCB+44
ASCBDP   EQU   ASCB+43
ASCBRV07 EQU   ASCB+42
ASCBIOSM EQU   ASCB+40
ASCBSEQN EQU   ASCB+38
ASCBASID EQU   ASCB+36
ASCBCPUS EQU   ASCB+32
ASCBSPL  EQU   ASCB+28
ASCBLSLQ EQU   ASCB+24
ASCBFSLQ EQU   ASCB+20
ASCBIOSP EQU   ASCB+16
ASCBLOCK EQU   ASCB+12
ASCBBWDP EQU   ASCB+8
ASCBFWDP EQU   ASCB+4
ASCBASCB EQU   ASCB
ASCBEGIN EQU   ASCB
@NM00104 EQU   SRB+40
@NM00103 EQU   SRB+38
SRBPRIOR EQU   SRB+37
SRBPKF   EQU   SRB+36
SRBSAVE  EQU   SRB+32
SRBRMTR  EQU   SRB+24
SRBEP    EQU   SRB+20
SRBPTCB  EQU   SRBFLC+4
SRBPASID EQU   SRBFLC+2
SRBCPAFF EQU   SRBFLC
SRBASCB  EQU   SRB+8
SRBFLNK  EQU   SRB+4
SRBID    EQU   SRB
@NM00102 EQU   PSA+3668
PSASTAK  EQU   PSA+3072
@NM00101 EQU   PSA+1048
PSAUSEND EQU   PSA+1048
PSARV062 EQU   PSA+1044
PSACDAL  EQU   PSA+1040
PSAWTCOD EQU   PSA+1036
PSAATCVT EQU   PSA+1032
PSAPCPSW EQU   PSA+1024
PSAPIR2  EQU   PSA+1020
PSARV059 EQU   PSA+1018
PSASVC13 EQU   PSA+1016
PSALSFCC EQU   PSA+1012
PSASFACC EQU   PSA+1008
PSASTOP  EQU   PSA+992
PSASTART EQU   PSA+976
PSARSPSW EQU   PSA+968
PSASRPSW EQU   PSA+960
PSARV045 EQU   PSA+892
PSARV044 EQU   PSA+888
PSARV043 EQU   PSA+884
PSARV042 EQU   PSA+880
PSARV041 EQU   PSA+876
PSARV040 EQU   PSA+872
PSARV025 EQU   PSA+868
PSADSSED EQU   PSA+868
PSADSSPR EQU   PSA+864
PSADSSFW EQU   PSA+860
PSADSS14 EQU   PSA+856
PSADSSPP EQU   PSA+848
PSADSSRP EQU   PSA+840
PSADSS05 EQU   PSADSSF4
PSADSS10 EQU   PSADSSF4
PSADSSVE EQU   PSADSSF4
PSADSSDE EQU   PSADSSF4
PSADSSC0 EQU   PSADSSF4
PSADSSIE EQU   PSADSSF4
PSADSS12 EQU   PSADSSF4
PSADSSRC EQU   PSADSSF4
PSARV057 EQU   PSADSSF3
PSARV056 EQU   PSADSSF3
PSARV055 EQU   PSADSSF3
PSADSSMC EQU   PSADSSF3
PSADSSRW EQU   PSADSSF3
PSADSSNM EQU   PSADSSF3
PSADSSES EQU   PSADSSF3
PSADSSGP EQU   PSADSSF3
PSADSSF2 EQU   PSADSSFL+1
PSADSSPI EQU   PSADSSF1
PSADSSOI EQU   PSADSSF1
PSADSSSP EQU   PSADSSF1
PSADSSTP EQU   PSADSSF1
PSADSSDW EQU   PSADSSF1
PSADSSDD EQU   PSADSSF1
PSADSSDM EQU   PSADSSF1
PSADSSMV EQU   PSADSSF1
PSADSSTS EQU   PSA+816
PSADSSWK EQU   PSA+812
PSADSSR3 EQU   PSA+808
PSADSSR2 EQU   PSA+804
PSADSSRS EQU   PSA+800
PSASTOR  EQU   PSA+796
PSACPUSA EQU   PSA+794
PSAVSTAP EQU   PSA+792
PSAWKVAP EQU   PSA+788
PSAWKRAP EQU   PSA+784
PSAMCHIC EQU   PSA+783
PSARV061 EQU   PSA+782
PSASYMSK EQU   PSA+781
PSAMCHFL EQU   PSA+780
PSACR0   EQU   PSA+776
PSAPSWSV EQU   PSA+768
PSACLHS  EQU   PSAHLHI
PSALKR15 EQU   PSALKSA+60
PSALKR14 EQU   PSALKSA+56
PSALKR13 EQU   PSALKSA+52
PSALKR12 EQU   PSALKSA+48
PSALKR11 EQU   PSALKSA+44
PSALKR10 EQU   PSALKSA+40
PSALKR9  EQU   PSALKSA+36
PSALKR8  EQU   PSALKSA+32
PSALKR7  EQU   PSALKSA+28
PSALKR6  EQU   PSALKSA+24
PSALKR5  EQU   PSALKSA+20
PSALKR4  EQU   PSALKSA+16
PSALKR3  EQU   PSALKSA+12
PSALKR2  EQU   PSALKSA+8
PSALKR1  EQU   PSALKSA+4
PSALKR0  EQU   PSALKSA
PSARV023 EQU   PSACLHT+52
PSALOCAL EQU   PSACLHT+48
PSACMSL  EQU   PSACLHT+44
PSAOPTL  EQU   PSACLHT+40
PSATPACL EQU   PSACLHT+36
PSATPDNL EQU   PSACLHT+32
PSATPNCL EQU   PSACLHT+28
PSAIOSLL EQU   PSACLHT+24
PSAIOSUL EQU   PSACLHT+20
PSAIOSCL EQU   PSACLHT+16
PSAIOSSL EQU   PSACLHT+12
PSASALCL EQU   PSACLHT+8
PSAASML  EQU   PSACLHT+4
PSADISPL EQU   PSACLHT
PSASRSA  EQU   PSA+636
PSARV050 EQU   PSA+634
PSADSSGO EQU   PSA+633
PSARECUR EQU   PSA+632
PSAHLHIS EQU   PSA+628
PSAIPCSA EQU   PSA+624
@NM00100 EQU   PSA+621
PSAIPCDM EQU   PSA+620
PSAIPCD  EQU   PSA+616
@NM00099 EQU   PSA+613
PSAIPCRM EQU   PSA+612
PSAIPCR  EQU   PSA+608
PSAMCHEX EQU   PSA+600
PSAMPSW  EQU   PSA+592
PSAEXPS2 EQU   PSA+584
PSAEXPS1 EQU   PSA+576
PSAPIREG EQU   PSA+572
PSARSREG EQU   PSA+568
PSAGPREG EQU   PSA+556
PSARV022 EQU   PSASUP4
PSARV021 EQU   PSASUP4
PSARV020 EQU   PSASUP4
PSARV019 EQU   PSASUP4
PSARV018 EQU   PSASUP4
PSARV017 EQU   PSASUP4
PSARV016 EQU   PSASUP4
PSARV015 EQU   PSASUP4
PSARV014 EQU   PSASUP3
PSAULCMS EQU   PSASUP3
PSARV012 EQU   PSASUP3
PSAESTA  EQU   PSASUP3
PSASPR   EQU   PSASUP3
PSAPSREG EQU   PSASUP3
PSAPI2   EQU   PSASUP3
PSAIOSUP EQU   PSASUP3
PSALCR   EQU   PSASUP2
PSARTM   EQU   PSASUP2
PSAACR   EQU   PSASUP2
PSAIPCE2 EQU   PSASUP2
PSAIPCES EQU   PSASUP2
PSAIPCEC EQU   PSASUP2
PSAGTF   EQU   PSASUP2
PSAIPCRI EQU   PSASUP2
PSATYPE6 EQU   PSASUP1
PSATCTL  EQU   PSASUP1
PSADISP  EQU   PSASUP1
PSALOCK  EQU   PSASUP1
PSAPI    EQU   PSASUP1
PSAEXT   EQU   PSASUP1
PSASVC   EQU   PSASUP1
PSAIO    EQU   PSASUP1
PSAAOLD  EQU   PSA+548
PSAANEW  EQU   PSA+544
PSATOLD  EQU   PSA+540
PSATNEW  EQU   PSA+536
PSALCCAR EQU   PSA+532
PSAPCCAR EQU   PSA+524
PSAPCCAV EQU   PSA+520
PSACPULA EQU   PSA+518
PSACPUPA EQU   PSA+516
PSAPSA   EQU   PSA+512
FLCHDEND EQU   PSA+512
FLCCRSAV EQU   FLCMCLA+280
FLCGRSAV EQU   FLCMCLA+216
FLCFPSAV EQU   FLCMCLA+184
FLCFLA   EQU   FLCMCLA+88
FLCRGNCD EQU   FLCMCLA+84
FLCFSAA  EQU   FLCFSA+1
@NM00098 EQU   FLCFSA
@NM00097 EQU   FLCMCLA+72
FLCMCIC  EQU   FLCMCLA+64
@NM00096 EQU   FLCMCLA+20
FLCIOAA  EQU   FLCIOA+1
@NM00095 EQU   FLCIOA
@NM00094 EQU   FLCMCLA+15
@NM00093 EQU   FLCMCLA+14
@NM00092 EQU   FLCMCLA+12
FLCLCL   EQU   FLCMCLA+8
FLCIOELA EQU   FLCIOEL+1
@NM00091 EQU   FLCIOEL
FLCCHNID EQU   FLCMCLA
@NM00090 EQU   PSA+160
FLCMTRCD EQU   PSA+157
@NM00089 EQU   PSA+156
FLCPERA  EQU   FLCPER+1
@NM00088 EQU   FLCPER
@NM00087 EQU   PSA+151
FLCPERCD EQU   PSA+150
FLCMCNUM EQU   PSA+149
@NM00086 EQU   PSA+148
FLCTEAA  EQU   FLCTEA+1
@NM00085 EQU   FLCTEA
PSAPIPC  EQU   PSAPICOD
PSAPIMC  EQU   PSAPICOD
PSAPIPER EQU   PSAPICOD
PSARV049 EQU   FLCPICOD
FLCPILCB EQU   FLCPIILC
@NM00084 EQU   FLCPIILC
@NM00083 EQU   PSAEPPSW
FLCSVCN  EQU   PSAESPSW+2
FLCSILCB EQU   FLCSVILC
@NM00082 EQU   FLCSVILC
@NM00081 EQU   PSAESPSW
FLCEICOD EQU   PSAEEPSW+2
PSASPAD  EQU   PSAEEPSW
@NM00080 EQU   PSA+128
FLCINPSW EQU   PSA+120
FLCMNPSW EQU   PSA+112
FLCPNPSW EQU   PSA+104
FLCSNPSW EQU   PSA+96
FLCENPSW EQU   PSA+88
FLCTRACE EQU   PSA+84
FLCTIMER EQU   PSA+80
FLCCVT2  EQU   PSA+76
FLCCAW   EQU   PSA+72
FLCCSW   EQU   PSA+64
FLCIOPSW EQU   PSA+56
FLCMOPSW EQU   PSA+48
FLCPOPSW EQU   PSA+40
FLCSOPSW EQU   PSA+32
FLCEOPSW EQU   PSA+24
@NM00079 EQU   FLCICCW2+4
FLCCVT   EQU   FLCICCW2
FLCICCW1 EQU   FLCROPSW
FLCIPPSW EQU   FLCRNPSW
ASVTEND  EQU   ASVT+528
ASVTAVAI EQU   ASVTFRST
ASVTRS00 EQU   ASVT+520
ASVTASVT EQU   ASVT+512
ASVTBEGN EQU   ASVT+512
@NM00078 EQU   ASVT
LCCAR125 EQU   LCCA+964
LCCAR124 EQU   LCCA+960
LCCASGPR EQU   LCCA+896
LCCADRT2 EQU   LCCA+888
LCCADRT1 EQU   LCCA+880
LCCAR103 EQU   LCCA+876
LCCAESS2 EQU   LCCA+872
LCCASPLJ EQU   LCCA+868
LCCASMQJ EQU   LCCA+864
LCCAIRT  EQU   LCCA+736
LCCAASID EQU   LCCA+732
LCCARV89 EQU   LCCA+728
LCCAPGTA EQU   LCCASRBF+2
LCCASAFN EQU   LCCASRBF
LCCAECSA EQU   LCCA+716
LCCAICR0 EQU   LCCA+712
LCCALWTM EQU   LCCA+704
LCCARV78 EQU   LCCA+700
LCCAPINV EQU   LCCA+696
LCCARV88 EQU   LCCA+695
LCCARV87 EQU   LCCALKFG
LCCARV86 EQU   LCCALKFG
LCCARV85 EQU   LCCALKFG
LCCARV84 EQU   LCCALKFG
LCCALKRD EQU   LCCALKFG
LCCALKAQ EQU   LCCALKFG
LCCALKSA EQU   LCCALKFG
LCCALKDP EQU   LCCALKFG
LCCACRST EQU   LCCACREX
LCCACRDP EQU   LCCACREX
LCCACRLM EQU   LCCACREX
LCCACRIN EQU   LCCACREX
LCCACRRT EQU   LCCACREX
LCCACRLE EQU   LCCACREX
LCCACRRM EQU   LCCACREX
LCCACREF EQU   LCCACREX
LCCAVARY EQU   LCCACRFL
LCCARV73 EQU   LCCACRFL
LCCARV72 EQU   LCCACRFL
LCCARV71 EQU   LCCACRFL
LCCARV70 EQU   LCCACRFL
LCCARV69 EQU   LCCACRFL
LCCACLMS EQU   LCCACRFL
LCCACRTM EQU   LCCACRFL
LCCALCR0 EQU   LCCA+688
LCCACRLC EQU   LCCA+684
LCCARCPU EQU   LCCA+680
LCCADCPU EQU   LCCA+676
LCCASRBJ EQU   LCCA+672
LCCADSSR EQU   LCCA+668
LCCADSSC EQU   LCCA+660
LCCADSS3 EQU   LCCA+648
LCCADSS2 EQU   LCCA+636
LCCADSS1 EQU   LCCA+624
LCCAITOD EQU   LCCA+608
LCCASTOD EQU   LCCA+592
LCCARIR5 EQU   LCCASPSA+44
LCCARIR4 EQU   LCCASPSA+40
LCCARIR3 EQU   LCCASPSA+36
LCCARIR2 EQU   LCCASPSA+32
LCCARPR5 EQU   LCCASPSA+28
LCCARPR4 EQU   LCCASPSA+24
LCCARPR3 EQU   LCCASPSA+20
LCCARPR2 EQU   LCCASPSA+16
LCCADSR5 EQU   LCCASPSA+12
LCCADSR4 EQU   LCCASPSA+8
LCCADSR3 EQU   LCCASPSA+4
LCCADSR2 EQU   LCCASPSA
LCCARV68 EQU   LCCA+543
LCCAPSMK EQU   LCCA+542
LCCARV67 EQU   LCCADSF2
LCCARV66 EQU   LCCADSF2
LCCARV65 EQU   LCCADSF2
LCCARV64 EQU   LCCADSF2
LCCADSRW EQU   LCCADSF2
LCCADSPL EQU   LCCADSF2
LCCAGSRB EQU   LCCADSF2
LCCASRBM EQU   LCCADSF2
LCCARV61 EQU   LCCADSF1
LCCARV60 EQU   LCCADSF1
LCCARV59 EQU   LCCADSF1
LCCARV58 EQU   LCCADSF1
LCCADSS  EQU   LCCADSF1
LCCAVCPU EQU   LCCADSF1
LCCAACR  EQU   LCCADSF1
LCCACPUS EQU   LCCA+536
LCCAASCP EQU   LCCA+532
LCCAESSA EQU   LCCA+528
LCCARV55 EQU   LCCASPN4
LCCARV54 EQU   LCCASPN4
LCCARV53 EQU   LCCASPN4
LCCARV52 EQU   LCCASPN4
LCCARV51 EQU   LCCASPN4
LCCARV50 EQU   LCCASPN4
LCCARV49 EQU   LCCASPN4
LCCARV48 EQU   LCCASPN4
LCCARV47 EQU   LCCASPN3
LCCARV46 EQU   LCCASPN3
LCCARV45 EQU   LCCASPN3
LCCARV44 EQU   LCCASPN3
LCCARV43 EQU   LCCASPN3
LCCARV42 EQU   LCCASPN3
LCCARV41 EQU   LCCASPN3
LCCARV40 EQU   LCCASPN3
LCCARV39 EQU   LCCASPN2
LCCARV38 EQU   LCCASPN2
LCCARV37 EQU   LCCASPN2
LCCARV36 EQU   LCCASPN2
LCCARV35 EQU   LCCASPN2
LCCARV34 EQU   LCCASPN2
LCCARV33 EQU   LCCASPN2
LCCARV32 EQU   LCCASPN2
LCCARV31 EQU   LCCASPN1
LCCARV30 EQU   LCCASPN1
LCCAMFIO EQU   LCCASPN1
LCCARSTR EQU   LCCASPN1
LCCATSPN EQU   LCCASPN1
LCCALOCK EQU   LCCASPN1
LCCASIGP EQU   LCCASPN1
LCCAPTLB EQU   LCCASPN1
LCCARV27 EQU   LCCAIHR4
LCCARV26 EQU   LCCAIHR4
LCCARV25 EQU   LCCAIHR4
LCCARV24 EQU   LCCAIHR4
LCCARV23 EQU   LCCAIHR4
LCCARV22 EQU   LCCAIHR4
LCCARV21 EQU   LCCAIHR4
LCCARV20 EQU   LCCAIHR4
LCCARV19 EQU   LCCAIHR3
LCCARV18 EQU   LCCAIHR3
LCCARV17 EQU   LCCAIHR3
LCCARV16 EQU   LCCAIHR3
LCCARV15 EQU   LCCAIHR3
LCCARV14 EQU   LCCAIHR3
LCCARV13 EQU   LCCAIHR3
LCCARV12 EQU   LCCAIHR3
LCCARV11 EQU   LCCAIHR2
LCCARV10 EQU   LCCAIHR2
LCCARV09 EQU   LCCAIHR2
LCCARV08 EQU   LCCAIHR2
LCCARV07 EQU   LCCAIHR2
LCCARV06 EQU   LCCAIHR2
LCCARV05 EQU   LCCAIHR2
LCCARV04 EQU   LCCAIHR2
LCCARV03 EQU   LCCAIHR1
LCCARV02 EQU   LCCAIHR1
LCCARV01 EQU   LCCAIHR1
LCCAPPIE EQU   LCCAIHR1
LCCAPSG1 EQU   LCCAIHR1
LCCAPDAT EQU   LCCAIHR1
LCCAXRC2 EQU   LCCAIHR1
LCCAXRC1 EQU   LCCAIHR1
LCCAIOPS EQU   LCCA+512
LCCAGPGR EQU   LCCA+448
LCCAR133 EQU   LCCA+444
LCCAR132 EQU   LCCA+440
LCCAR131 EQU   LCCA+436
LCCAR130 EQU   LCCA+432
LCCAR129 EQU   LCCA+428
LCCAR128 EQU   LCCA+424
LCCAR127 EQU   LCCA+420
LCCAR126 EQU   LCCA+416
LCCARSGR EQU   LCCA+352
LCCAXGR3 EQU   LCCA+288
LCCAXGR2 EQU   LCCA+224
LCCAXGR1 EQU   LCCA+160
LCCACR0  EQU   LCCA+156
LCCAMCR1 EQU   LCCA+152
LCCAPVAD EQU   LCCA+148
LCCAPINT EQU   LCCA+144
LCCAPPSW EQU   LCCA+136
LCCAPGR2 EQU   LCCA+72
LCCAPGR1 EQU   LCCA+8
LCCARV77 EQU   LCCA+6
LCCACPUA EQU   LCCA+4
LCCALCCA EQU   LCCA
MSSPARE  EQU   BASES01+48
MSUCBAL  EQU   BASES01+44
MSUCBPR  EQU   BASES01+40
MSBOBECB EQU   BASES01+36
MSSJQ    EQU   BASES01+32
MSECB    EQU   BASES01+28
MSPBP    EQU   BASES01+24
MSERM    EQU   BASES01+22
MSPASS   EQU   BASES01+14
MSVRB    EQU   BASES01+6
MSQHR    EQU   MSFHF
@NM00077 EQU   MSFHF
MSPSDT   EQU   MSFHF
MSREPLYB EQU   MSFHF
MSFAX    EQU   MSFHF
MSTTT    EQU   MSFHF
MSCSD    EQU   MSFHF
MSNMF    EQU   MSFHF
MSJNF    EQU   MSSSA
MSYOUT   EQU   MSNWP
MSNRP    EQU   MSSSA
MSSRDR   EQU   MSREOF
MSWRLOG  EQU   MSSSA
MSNUPSW  EQU   MSSSA
MSWRPEN  EQU   MSSSA
MSSSSIPL EQU   MSINLSW
MSSUM    EQU   MSECBFL
MSMCR    EQU   MSECBFL
MSYSOUT  EQU   MSECBFL
MSYSIN   EQU   MSECBFL
MSATTN   EQU   MSECBFL
MSWTL    EQU   MSECBFL
MSWTO    EQU   MSECBFL
MSEXT    EQU   MSECBFL
MSCCS    EQU   MSPFG
MSBSP    EQU   MSPFG
MSSYT    EQU   MSPFG
MSSYN    EQU   MSPFG
MSICR    EQU   MSPFG
MSCMC    EQU   MSPFG
MSPNB    EQU   MSPFG
MSDATE   EQU   MSPFG
@NM00076 EQU   MSBTN
MSTN     EQU   MSBTN
@NM00075 EQU   MSBTN
@NM00074 EQU   MSBTN
MSSO     EQU   MSBTN
MSROLFLG EQU   MSBTN
MSCANFLG EQU   MSBTN
MSCONFLG EQU   MSBTN
MSPNIP   EQU   MSNTAL
MSQNIP   EQU   MSNTAL
MSCURE34 EQU   MSNTAL
@NM00073 EQU   MSNTAL
@NM00072 EQU   MSNTAL
@NM00071 EQU   MSNTAL
@NM00070 EQU   MSNTAL
MSNIP    EQU   MSNTAL
@NM00069 EQU   MS1BASEX+40
@NM00068 EQU   MS1BASEX+20
@NM00067 EQU   MS1BASEX
@NM00066 EQU   BASE+128
MSLGJSCB EQU   BASE+124
@NM00065 EQU   MSSTRTSW
MSSTRTP  EQU   MSSTRTSW
MSSTRTW  EQU   MSSTRTSW
@NM00064 EQU   MSWTRSW
MSWTRP   EQU   MSWTRSW
MSWTRW   EQU   MSWTRSW
@NM00063 EQU   MSWLOGSW
MSWLOGP  EQU   MSWLOGSW
MSWLOGW  EQU   MSWLOGSW
@NM00062 EQU   MSCLOSSW
MSCLOSP  EQU   MSCLOSSW
MSCLOSW  EQU   MSCLOSSW
MSLOGLMT EQU   @NM00061+1
MSLOGCLS EQU   @NM00061
BAASCB   EQU   BASE+100
MSSMFPRM EQU   BASE+96
MSCOMMND EQU   BASE+92
BASP12   EQU   BASE+90
BASTCNT  EQU   BASE+88
BASESCT  EQU   BASE+86
BAJNCNT  EQU   BASE+84
BASUBECB EQU   BASE+80
BALOGCOM EQU   BASE+76
BADACNT  EQU   BASE+74
BATACNT  EQU   BASE+72
BAJBNR   EQU   BASE+64
BASP11   EQU   BASE+62
BALCCNT  EQU   BASE+61
BADUMPID EQU   BASE+60
BABCMAX  EQU   BASE+58
BAMONTR2 EQU   BASE+57
@NM00060 EQU   BAMONITR
BAMACTVE EQU   BAMONITR
@NM00059 EQU   BAMONITR
@NM00058 EQU   BAMONITR
@NM00057 EQU   BAMONITR
@NM00056 EQU   BAMONITR
BASPACE  EQU   BAMONITR
BADSN    EQU   BAMONITR
BADSO    EQU   BASE+52
BALOGECB EQU   BASE+48
@NM00055 EQU   BASPBYTE
@NM00054 EQU   BASPBYTE
@NM00053 EQU   BASPBYTE
@NM00052 EQU   BASPBYTE
@NM00051 EQU   BASPBYTE
BAMASCH  EQU   BASPBYTE
BATRACE  EQU   BASPBYTE
BAMSSTAR EQU   BASPBYTE
@NM00050 EQU   MSLOGST
@NM00049 EQU   MSLOGST
MSLOGSTA EQU   MSLOGST
MSLOGIPL EQU   MSLOGST
MSLOGDAR EQU   MSLOGST
MSLOGCOM EQU   MSLOGST
MSLOGTHD EQU   MSLOGST
MSLOGENQ EQU   MSLOGST
BAMIPAR2 EQU   BASE+44
BAMINPAR EQU   BASE+42
BAPKES   EQU   BASE+40
BAICTR   EQU   BASE+38
@NM00048 EQU   BASE+37
BADSET   EQU   BARSW
BANOSET  EQU   BARSW
BAMIDNT  EQU   BARSW
BAHR     EQU   BARSW
BAVU     EQU   BARSW
BACV     EQU   BASE+32
@NM00047 EQU   BALOG
@NM00046 EQU   BALOG
@NM00045 EQU   BALOG
@NM00044 EQU   BALOG
@NM00043 EQU   BALOG
@NM00042 EQU   BALOG
@NM00041 EQU   BALOG
BALOGINT EQU   BALOG
MSLOGSVC EQU   BALGSTAT
BAPRC    EQU   BASE+20
BAQ      EQU   BASE+16
@NM00040 EQU   @NM00039
BAIPL    EQU   BASE+12
BALAD    EQU   BASE+8
BATRM    EQU   BASE+4
BACHN    EQU   BASE
WPLMLTXT EQU   WPLML+4
WPLMLLT2 EQU   WPLMLLTF+1
WPLRSV24 EQU   WPLMLLT1
WPLRSV23 EQU   WPLMLLT1
WPLRSV22 EQU   WPLMLLT1
WPLRSV21 EQU   WPLMLLT1
WPLMLLTD EQU   WPLMLLT1
WPLMLLTC EQU   WPLMLLT1
WPLMLLTB EQU   WPLMLLT1
WPLMLLTA EQU   WPLMLLT1
WPLMLLEN EQU   WPLML+1
WPLML0   EQU   WPLML
WPLLINES EQU   WPLLS01+3
WPLAREA  EQU   WPLLS01+2
WPLLTF2  EQU   WPLLTF+1
WPLRSV20 EQU   WPLLTF1
WPLRSV19 EQU   WPLLTF1
WPLRSV18 EQU   WPLLTF1
WPLRSV17 EQU   WPLLTF1
WPLLTFD  EQU   WPLLTF1
WPLLTFC  EQU   WPLLTF1
WPLLTFB  EQU   WPLLTF1
WPLLTFA  EQU   WPLLTF1
WPLQID   EQU   WPLFLGS+6
WPLRSV32 EQU   WPLMSGT2
WPLRSV31 EQU   WPLMSGT2
WPLRSV30 EQU   WPLMSGT2
WPLRSV29 EQU   WPLMSGT2
WPLRSV28 EQU   WPLMSGT2
WPLRSV27 EQU   WPLMSGT2
WPLRSV26 EQU   WPLMSGT2
WPLRSV25 EQU   WPLMSGT2
WPLRSV16 EQU   WPLMSGT1
WPLRSV15 EQU   WPLMSGT1
WPLMSGTF EQU   WPLMSGT1
WPLRSV14 EQU   WPLMSGT1
WPLMSGTD EQU   WPLMSGT1
WPLMSGTC EQU   WPLMSGT1
WPLMSGTB EQU   WPLMSGT1
WPLMSGTA EQU   WPLMSGT1
WPLRSV13 EQU   WPLROUT2
WPLROUTO EQU   WPLROUT2
WPLROUTN EQU   WPLROUT2
WPLROUTM EQU   WPLROUT2
WPLROUTL EQU   WPLROUT2
WPLROUTK EQU   WPLROUT2
WPLROUTJ EQU   WPLROUT2
WPLROUTI EQU   WPLROUT2
WPLROUTH EQU   WPLROUT1
WPLROUTG EQU   WPLROUT1
WPLROUTF EQU   WPLROUT1
WPLROUTE EQU   WPLROUT1
WPLROUTD EQU   WPLROUT1
WPLROUTC EQU   WPLROUT1
WPLROUTB EQU   WPLROUT1
WPLROUTA EQU   WPLROUT1
WPLRSV12 EQU   WPLDESC2
WPLRSV11 EQU   WPLDESC2
WPLRSV10 EQU   WPLDESC2
WPLRSV09 EQU   WPLDESC2
WPLRSV08 EQU   WPLDESC2
WPLRSV07 EQU   WPLDESC2
WPLDESCJ EQU   WPLDESC2
WPLDESCI EQU   WPLDESC2
WPLDESCH EQU   WPLDESC1
WPLDESCG EQU   WPLDESC1
WPLDESCF EQU   WPLDESC1
WPLDESCE EQU   WPLDESC1
WPLDESCD EQU   WPLDESC1
WPLDESCC EQU   WPLDESC1
WPLDESCB EQU   WPLDESC1
WPLDESCA EQU   WPLDESC1
WPLTXTL  EQU   WPLTXT+125
@NM00038 EQU   WPLTXT
WPLRSV05 EQU   WPLMCSF2
WPLRSV04 EQU   WPLMCSF2
WPLMCSFN EQU   WPLMCSF2
WPLRSV03 EQU   WPLMCSF2
WPLNOWTP EQU   WPLMCSF2
WPLMCSFK EQU   WPLMCSF2
WPLMCSFJ EQU   WPLMCSF2
WPLMCSFI EQU   WPLMCSF2
WPLMCSFH EQU   WPLMCSF1
WPLMCSFG EQU   WPLMCSF1
WPLMCSFF EQU   WPLMCSF1
WPLMCSFE EQU   WPLMCSF1
WPLMCSFD EQU   WPLMCSF1
WPLMCSFC EQU   WPLMCSF1
WPLMCSFB EQU   WPLMCSF1
WPLMCSFA EQU   WPLMCSF1
WPLLGH   EQU   WPL
WPLRLN   EQU   WPLRPTR
TPCCRSAV EQU   IEATPC+352
TPCFRRP  EQU   IEATPC+348
TPCVPTR  EQU   IEATPC+344
TPCMISC  EQU   IEATPC+272
TPCWORKR EQU   TPCWORK+4
TPCWORKL EQU   TPCWORK
TPCSAVE2 EQU   IEATPC+200
TPCSAVE1 EQU   IEATPC+136
@NM00037 EQU   TPCLMTQE+16
@NM00036 EQU   TPCLMTQE+15
@NM00035 EQU   TPCLMTQE+14
@NM00034 EQU   TPCLMTQE+12
@NM00033 EQU   TPCLMTQE+8
@NM00032 EQU   TPCLMTQE+4
@NM00031 EQU   TPCLMTQE
@NM00030 EQU   IEATSELM+16
@NM00029 EQU   IEATSELM+15
@NM00028 EQU   IEATSELM+14
@NM00027 EQU   IEATSELM+12
@NM00026 EQU   IEATSELM+8
@NM00025 EQU   IEATSELM+4
@NM00024 EQU   IEATSELM
@NM00023 EQU   TPCMFTQE+16
@NM00022 EQU   TPCMFTQE+15
@NM00021 EQU   TPCMFTQE+14
@NM00020 EQU   TPCMFTQE+12
@NM00019 EQU   TPCMFTQE+8
@NM00018 EQU   TPCMFTQE+4
@NM00017 EQU   TPCMFTQE
MNIGHTRH EQU   MNIGHT+4
@NM00016 EQU   TPCMNTQE+15
@NM00015 EQU   TPCMNTQE+14
@NM00014 EQU   TPCMNTQE+12
@NM00013 EQU   TPCMNTQE+8
@NM00012 EQU   TPCMNTQE+4
@NM00011 EQU   TPCMNTQE
@NM00010 EQU   TPCDMTQE+16
@NM00009 EQU   TPCDMTQE+15
@NM00008 EQU   TPCDMTQE+14
@NM00007 EQU   TPCDMTQE+12
@NM00006 EQU   TPCDMTQE+8
@NM00005 EQU   TPCDMTQE
TPCCC    EQU   IEATPC+7
@NM00004 EQU   IEATPC+5
@NM00003 EQU   TPCFLGS1
TPCTPCA  EQU   IEATPC
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00197 EQU   @RC00186
@RF00302 EQU   @RC00299
@RC00358 EQU   @RC00356
@RF00364 EQU   @RC00356
@RC00515 EQU   @RC00513
@RC00494 EQU   @RC00492
@PB00006 EQU   @EL00005
@PB00007 EQU   @EC00827
@RF00918 EQU   @EL00001
@RC01060 EQU   @EL00008
@PB00005 EQU   @PB00007
@PB00004 EQU   @PB00005
@ENDDATA EQU   *
         END   IEAVRTOD,(C'PLS1200',0701,78156)

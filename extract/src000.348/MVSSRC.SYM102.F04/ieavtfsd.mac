TFSD     TITLE 'IEAVTFSD SUMDUMP FORMATTER                             *
                        '
IEAVTFSD CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(22)                                             0001
         DC    C'IEAVTFSD UZ14566 77280'                           0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@12                                         0001
         L     @00,@SIZDATD                                        0001
         GETMAIN  R,LV=(0)
         LR    @11,@01                                             0001
         USING @DATD,@11                                           0001
         ST    @13,@SA00001+4                                      0001
         LM    @00,@01,20(@13)                                     0001
         ST    @11,8(,@13)                                         0001
         LR    @13,@11                                             0001
         MVC   @PC00001(4),0(@01)                                  0001
*                                      EACH RECORD BASED ON THE ID 0024
*                                      FOR THAT RECORD               */
*   ABDPLPTR=R1;                    /* SAVE AMDPRDMP PARMLIST BASE   */
         LR    ABDPLPTR,R1                                         0025
*   RFY                                                            0026
*     R1 UNRSTD;                                                   0026
*   CONDCODE=GOODCODE;              /* INIT RETURN CODE ASSUMING ALL
*                                      WILL WORK                     */
         SLR   CONDCODE,CONDCODE                                   0027
*   PARMSAVE=0;                     /* INIT AMDPRDMP PARMLIST EIGHTH
*                                      SAVE AREA                     */
*                                                                  0028
         SLR   PARMSAVE,PARMSAVE                                   0028
*   /*****************************************************************/
*   /*                                                               */
*   /* PRINT OUT THE MAIN SUMMARY DUMP TITLE                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0029
*   RFY                                                            0029
*     R1 RSTD;                                                     0029
*   R1=ADDR(ABDPL);                 /* RESTORE AMDPRDMP PARMLIST PTR */
         LR    R1,ABDPLPTR                                         0030
*   DO I=1 TO 60;                   /* LOOP TO PUT OUT 60 BLANK    0031
*                                      LINES. THIS WILL INSURE THAT
*                                      THE SUMDUMP OUTPUT WILL BEGINN
*                                      AT THE TOP OF THE NEXT NEW  0031
*                                      PAGE. HOW YOU ASK? AMDPRDMP 0031
*                                      WILL DISCARD ALL BLANK LINES
*                                      PASSED TO IT TO BE WRITTEN IF
*                                      THEY WOULD BE AT THE TOP OF A
*                                      NEW PAGE BEFORE ANY NONBLANK
*                                      LINES.                        */
         LA    I,1                                                 0031
@DL00031 DS    0H                                                  0032
*     CALL LINEPRNT;                /* PRINT OUTPUT BUFFER WHICH   0032
*                                      AMDPRDMP INITS TO BLANKS      */
         L     @15,ADPLPRNT(,ABDPLPTR)                             0032
         BALR  @14,@15                                             0032
*   END;                                                           0033
         AH    I,@CH00053                                          0033
         CH    I,@CH00167                                          0033
         BNH   @DL00031                                            0033
*   TXTPTR=ADDR(MAINTITL);                                         0034
         L     TXTPTR,@CA00216                                     0034
*   OUTBUF(1:TXTLEN)=TXT(1:TXTLEN);                                0035
         L     @10,ADPLBUF(,ABDPLPTR)                              0035
         SLR   @07,@07                                             0035
         IC    @07,TXTLEN(,TXTPTR)                                 0035
         BCTR  @07,0                                               0035
         EX    @07,@SM00264                                        0035
*   CALL LINEPRNT;                  /* PRINT THE OUTPUT BUFFER       */
         L     @15,ADPLPRNT(,ABDPLPTR)                             0036
         BALR  @14,@15                                             0036
*   RFY                                                            0037
*     R1 UNRSTD;                                                   0037
*                                                                  0038
*   /*****************************************************************/
*   /*                                                               */
*   /* THE REMAINING FUNCTION OF THIS MODULE IS CONTAINED IN THE LOOP*/
*   /* WHICH BEGINS HERE. THIS LOOP WILL PROCESS ONE SUMDUMP RECORD  */
*   /* PER INTERATION, AND WILL TERMINATE IF ANY ERROR OCCURRS       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0038
*   DO WHILE CONDCODE=GOODCODE;     /* LOOP READING SUM DUMP LOGICAL
*                                      RECORDS AND CALLING THE     0038
*                                      SPECIFIC FORMAT RTN FOR EACH
*                                      RECORD                        */
         B     @DE00038                                            0038
@DL00038 DS    0H                                                  0039
*     RFY                                                          0039
*       R1 RSTD;                                                   0039
*     R1=ADDR(ABDPL);               /* RESTORE AMDPRDMP PARMLIST PTR */
         LR    R1,ABDPLPTR                                         0040
*     DO I=1 TO 5;                  /* LOOP TO PUT OUT 5 BLANK LINES */
         LA    I,1                                                 0041
@DL00041 DS    0H                                                  0042
*       CALL LINEPRNT;              /* PRINT OUTPUT BUFFER WHICH   0042
*                                      AMDPRDMP INITS TO BLANKS      */
         L     @15,ADPLPRNT(,ABDPLPTR)                             0042
         BALR  @14,@15                                             0042
*     END;                                                         0043
         AH    I,@CH00053                                          0043
         CH    I,@CH00065                                          0043
         BNH   @DL00041                                            0043
*     RFY                                                          0044
*      (R0,                                                        0044
*       RETCODE) RSTD;                                             0044
*GETNEXT:                           /* IF THE RECORD READ IS NOT TO
*                                      BE FORMATTED IEAVTFSD BRANCHES
*                                      BACK TO HERE TO READ ANOTHER  */
*     R1=ADDR(ABDPL);               /* RESTORE THE AMPRDMP PARMLIST
*                                      PTR                           */
GETNEXT  LR    R1,ABDPLPTR                                         0045
*     ADPLCOM1=PARMSAVE;            /* RESTORE THE VALUE OF THE    0046
*                                      EIGHTH WORD OF THE PARM LIST
*                                      IN CASE IT GOT CHANGED        */
         ST    PARMSAVE,ADPLCOM1(,ABDPLPTR)                        0046
*     CALL IEAVTFRD;                /* READ THE NEXT LOGICAL SD REC  */
         L     @15,@CV00205                                        0047
         BALR  @14,@15                                             0047
*     PARMSAVE=ADPLCOM1;            /* SAVE THE EIGHTH WORD OF THE 0048
*                                      PARMLIST IN CASE IT GETS    0048
*                                      CHANGED BY A SPECIFIC FORMAT
*                                      SUBROUTINE                    */
         L     PARMSAVE,ADPLCOM1(,ABDPLPTR)                        0048
*     IF RETCODE>DATARET            /* CHECK THE RETURN CODE FOR DATA
*                                      RETURNED                      */
*       THEN                        /* IF NO DATA IS RETURNED        */
         CH    RETCODE,@CH00061                                    0049
         BNH   @RF00049                                            0049
*       CONDCODE=NODATA;            /* FORWARD THE RETURN CODE       */
         LA    CONDCODE,8                                          0050
*     ELSE                                                         0051
*       DO;                         /* IF DATA WAS RETURNED          */
         B     @RC00049                                            0051
@RF00049 DS    0H                                                  0052
*         SMDLRPTR=R0;                                             0052
         ST    R0,SMDLRPTR                                         0052
*         RFY                                                      0053
*          (R0,                                                    0053
*           R1,                                                    0053
*           RETCODE) UNRSTD;                                       0053
*         IF SMDLRID=SMDNULL        /* IS THIS RECORD ONE WITH NO  0054
*                                      MEANINGFUL DATA IT?           */
*           THEN                    /* YES                           */
         L     @10,SMDLRPTR                                        0054
         CLC   SMDLRID(2,@10),@CH00165                             0054
         BE    @RT00054                                            0054
*           GO TO GETNEXT;          /* GO BACK AND GET THE NEXT    0055
*                                      RECORD                        */
*         IF 0<SMDLRID&SMDLRID<FTLSTENT/* DOES THIS RECORD ID HAVE AN
*                                      ENTRY IN THE TABLE    @ZM44938*/
*           THEN                    /* YES                           */
         SLR   @07,@07                                             0056
         ICM   @07,3,SMDLRID(@10)                                  0056
         LTR   @07,@07                                             0056
         BNP   @RF00056                                            0056
         L     @10,@CA00230                                        0056
         C     @07,FTLSTENT-FMTTABLE(,@10)                         0056
         BNL   @RF00056                                            0056
*           INDEX=SMDLRID;          /* USE THE RECORD AS THE INDEX 0057
*                                      INTO THE TABLE                */
         L     @10,SMDLRPTR                                        0057
         SLR   @15,@15                                             0057
         ICM   @15,3,SMDLRID(@10)                                  0057
         LR    INDEX,@15                                           0057
*         ELSE                      /* IF THIS RECORD ID IS NOT IN 0058
*                                      THE TABLE                     */
*           INDEX=FTLSTENT;         /* USE THE LAST ENTRY IN THE   0058
*                                      TABLE, WHICH IS FOR UNKNOWN 0058
*                                      RECORD IDS                    */
         B     @RC00056                                            0058
@RF00056 L     @10,@CA00230                                        0058
         L     INDEX,FTLSTENT-FMTTABLE(,@10)                       0058
*                                                                  0059
*         /***********************************************************/
*         /*                                                         */
*         /* PUT OUT THE RECORD TITLE LINE                           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0059
*         IF FTINSERT(INDEX)='                '/* IS THE TITLE INSERT
*                                      ALL BLANKS?                   */
*           THEN                    /* YES                           */
@RC00056 LR    @10,INDEX                                           0059
         MH    @10,@CH00120                                        0059
         L     @15,@CA00230                                        0059
         ST    @10,@TF00001                                        0059
         ALR   @10,@15                                             0059
         AL    @10,@CF00266                                        0059
         CLC   FTINSERT-FMTTABLE-24(16,@10),@CC00244               0059
         BE    @RT00059                                            0059
*           GO TO SKIPTITL;         /* SO SKIP PRINTING THE TITLE FOR
*                                      THIS RECORD                   */
*         TXTPTR=ADDR(RECTITLE);    /* LINE UP THE BASIC TEXT FOR THE
*                                      RECORD TITLE                  */
         L     TXTPTR,@CA00217                                     0061
*         OUTBUF(1:TXTLEN)=TXT(1:TXTLEN);/* MOVE IN THE BULK OF THE
*                                      TEXT                          */
         L     @10,ADPLBUF(,ABDPLPTR)                              0062
         SLR   @08,@08                                             0062
         IC    @08,TXTLEN(,TXTPTR)                                 0062
         BCTR  @08,0                                               0062
         EX    @08,@SM00264                                        0062
*         ADPLFMT1=ADDR(FTINSERT(INDEX));/* ADD THE PROSE VERSION OF
*                                      THE ID                        */
         L     @10,@TF00001                                        0063
         AL    @15,@CF00266                                        0063
         LA    @10,FTINSERT-FMTTABLE-24(@10,@15)                   0063
         ST    @10,ADPLFMT1(,ABDPLPTR)                             0063
*         ADPLFMT2=ADDR(SMDLRHDR);  /* POINT TO THE HEADER TO GET  0064
*                                      AMDPRDMP TO CONVERT IT INTO 0064
*                                      THE TITLE LINE IN THE OUTPUT
*                                      BUFFER                        */
         MVC   ADPLFMT2(4,ABDPLPTR),SMDLRPTR                       0064
*         RFY                                                      0065
*          (R0,                                                    0065
*           R1,                                                    0065
*           RETCODE) RSTD;                                         0065
*         R1=ADDR(ABDPL);                                          0066
         LR    R1,ABDPLPTR                                         0066
*         R0=ADDR(RECTITFP);        /* USE THE FORMAT PATTERN IN   0067
*                                      IEAVTFTM TO FILL IN THE BLANKS
*                                      IN RECTITLE                   */
         L     R0,@CA00218                                         0067
         LR    @14,R0                                              0067
         LR    R0,@14                                              0067
*         CALL FMTSERV;                                            0068
         L     @15,ADPLFRMT(,ABDPLPTR)                             0068
         BALR  @14,@15                                             0068
*         CONDCODE=RETCODE;                                        0069
         LR    CONDCODE,RETCODE                                    0069
*         RFY                                                      0070
*          (R0,                                                    0070
*           R1,                                                    0070
*           RETCODE) UNRSTD;                                       0070
*         IF CONDCODE=GOODCODE THEN                                0071
         LTR   CONDCODE,CONDCODE                                   0071
         BNZ   @RF00071                                            0071
*           DO;                                                    0072
*             RFY                                                  0073
*               R1 RSTD;                                           0073
*             R1=ADDR(ABDPL);       /* RESTORE AMDPRDMP PARMLIST PTR */
         LR    R1,ABDPLPTR                                         0074
*             DO I=1 TO 3;          /* LOOP TO PRINT THE TITLE LINE
*                                      AND 2 BLANK LINES             */
         LA    I,1                                                 0075
@DL00075 DS    0H                                                  0076
*               CALL LINEPRNT;      /* PRINT OUTPUT BUFFER WHICH   0076
*                                      AMDPRDMP INITS TO BLANKS      */
         L     @15,ADPLPRNT(,ABDPLPTR)                             0076
         BALR  @14,@15                                             0076
*             END;                                                 0077
         AH    I,@CH00053                                          0077
         CH    I,@CH00059                                          0077
         BNH   @DL00075                                            0077
*             RFY                                                  0078
*               R1 UNRSTD;                                         0078
*SKIPTITL:                                                         0079
*             ;                     /* IF THE TITLE INSERT WAS BLANK
*                                      PRINTING OF THE TITLE WAS   0079
*                                      SKIPPED BY BRANCHING HERE     */
SKIPTITL DS    0H                                                  0080
*                                                                  0080
*             /*******************************************************/
*             /*                                                     */
*             /* LOAD CALL AND DELETE THE SPECIFIC FORMAT SUBROUTINE.*/
*             /* CSECT IEAVTFTM CONTAINS AN EXPLANATION OF HOW TO    */
*             /* WRITE AND INSTALL A SPECIFIC FORMAT SUBROUTINE      */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0080
*             SAVEPL=ABDPL;         /* MAKE A COPY OF THE AMDPRDMP 0080
*                                      PARM LIST FOR USE BY THE    0080
*                                      SPECIFIC FMT SUBRTN TO PREVENT
*                                      ALTERATION OF THE ORIGINAL    */
         MVC   SAVEPL(60),ABDPL(ABDPLPTR)                          0080
*             IF FTRTNAME(INDEX)^=BLNKNAME/* CHECK FOR AN EXTERNAL 0081
*                                      FORMAT RTN TO BE LOADED       */
*               THEN                /* IF THERE IS ONE               */
         LR    @10,INDEX                                           0081
         MH    @10,@CH00120                                        0081
         L     @15,@CA00230                                        0081
         ST    @10,@TF00001                                        0081
         ALR   @10,@15                                             0081
         AL    @10,@CF00267                                        0081
         CLC   FTRTNAME-FMTTABLE-12(8,@10),@CC00239                0081
         BE    @RF00081                                            0081
*               DO;                                                0082
*                 RFY                                              0083
*                  (R0,                                            0083
*                   R1) RSTD;                                      0083
*                 DO;               /* LOAD EP(FTRTNAME(INDEX))    0084
*                                      ERRET(NOLOAD)                 */
*                   RESPECIFY                                      0085
*                    (GPR00P,                                      0085
*                     GPR01P,                                      0085
*                     GPR15F) RESTRICTED;                          0085
*                   GPR00P=ADDR(FTRTNAME(INDEX));/* LOAD ENTRY POINT
*                                      NAME ADDRESS                  */
         L     GPR00P,@CA00230                                     0086
         LR    @14,GPR00P                                          0086
         L     @10,@TF00001                                        0086
         AL    @14,@CF00267                                        0086
         LA    GPR00P,FTRTNAME-FMTTABLE-12(@10,@14)                0086
*                   GPR01P=0;       /* JOBLIB OR LINKLIB DCB         */
         SLR   GPR01P,GPR01P                                       0087
*                   GPR01P=GPR01P×'80000000'X;/* ERROR RETURN LABEL
*                                      SPECIFIED                     */
         O     GPR01P,@CF00251                                     0088
*                   SVC(8);         /* ISSUE LOAD SVC                */
         SVC   8                                                   0089
*                   IF GPR15F^=0 THEN/* LOAD WAS UNSUCCESSFUL        */
         LTR   GPR15F,GPR15F                                       0090
         BNZ   @RT00090                                            0090
*                     GOTO NOLOAD;  /* BRANCH TO ERROR LOCATION      */
*                   RESPECIFY                                      0092
*                    (GPR00P,                                      0092
*                     GPR01P,                                      0092
*                     GPR15F) UNRESTRICTED;                        0092
*                 END;              /* LOAD EP(FTRTNAME(INDEX))    0093
*                                      ERRET(NOLOAD) LOADING THE   0093
*                                      INDICATED EXTERNAL FORMAT RTN */
*                 RFY                                              0094
*                   R1 UNRSTD;                                     0094
*                 RFY                                              0095
*                   RETCODE RSTD;                                  0095
*                 CALL SPECFMT(ADDR(SAVEPL),SMDLRPTR,SMDLRADR);/*  0096
*                                      CALL TO HAVE THIS RECORD    0096
*                                      FORMATTED AND PRINTED         */
         LA    @14,SAVEPL                                          0096
         ST    @14,@AFTEMPS                                        0096
         LA    @14,@AFTEMPS                                        0096
         ST    @14,@AL00001                                        0096
         LA    @14,SMDLRPTR                                        0096
         ST    @14,@AL00001+4                                      0096
         L     @14,SMDLRPTR                                        0096
         LA    @14,SMDLRADR(,@14)                                  0096
         ST    @14,@AL00001+8                                      0096
         LR    @15,R0                                              0096
         LA    @01,@AL00001                                        0096
         BALR  @14,@15                                             0096
*                 IF RETCODE^=0     /* CHECK THE RETURN CODE         */
*                   THEN            /* IF IT IS NOT 0                */
         LTR   RETCODE,RETCODE                                     0097
         BZ    @RF00097                                            0097
*                   CALL FTDEFRTN(INDEX)->SPECFMT(ADDR(SAVEPL),SMDLRPTR
*                       ,SMDLRADR); /* USE THE DEFAULT FORMAT RTN TO
*                                      DO THIS RECORD                */
         LA    @14,SAVEPL                                          0098
         ST    @14,@AFTEMPS                                        0098
         LA    @14,@AFTEMPS                                        0098
         ST    @14,@AL00001                                        0098
         LA    @14,SMDLRPTR                                        0098
         ST    @14,@AL00001+4                                      0098
         L     @14,SMDLRPTR                                        0098
         LA    @14,SMDLRADR(,@14)                                  0098
         ST    @14,@AL00001+8                                      0098
         LR    @10,INDEX                                           0098
         MH    @10,@CH00120                                        0098
         L     @01,@CA00230                                        0098
         AL    @01,@CF00268                                        0098
         L     @15,FTDEFRTN-FMTTABLE-20(@10,@01)                   0098
         LA    @01,@AL00001                                        0098
         BALR  @14,@15                                             0098
*                 RFY                                              0099
*                  (R0,                                            0099
*                   RETCODE) UNRSTD;                               0099
@RF00097 DS    0H                                                  0100
*                 DO;               /* DELETE EP(FTRTNAME(INDEX))    */
*                   RESPECIFY                                      0101
*                    (GPR00P) RESTRICTED;                          0101
*                   GPR00P=ADDR(FTRTNAME(INDEX));/* ->ENTRY NAME     */
         LR    @10,INDEX                                           0102
         MH    @10,@CH00120                                        0102
         L     GPR00P,@CA00230                                     0102
         LR    @01,GPR00P                                          0102
         AL    @01,@CF00267                                        0102
         LA    GPR00P,FTRTNAME-FMTTABLE-12(@10,@01)                0102
*                   SVC(9);         /* DELETE SVC                    */
         SVC   9                                                   0103
*                   RESPECIFY                                      0104
*                    (GPR00P) UNRESTRICTED;                        0104
*                 END;              /* DELETE EP(FTRTNAME(INDEX))    */
*               END;                                               0106
*                                                                  0107
*             /*******************************************************/
*             /*                                                     */
*             /* IF THERE WAS NO NAME OF A SPECIFIC FORMAT SUBROUTINE*/
*             /* TO BE LOADED OR THE LOAD FAILED THE CODE BRANCHES   */
*             /* HERE                                                */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0107
*             ELSE                  /* IF THERE WAS NO EXTERNAL FMT
*                                      RTN NAME                      */
*               DO;                                                0107
         B     @RC00081                                            0107
@RF00081 DS    0H                                                  0108
*                 GO TO PASTMSG;    /* IF CONTROL CAME HERE BECAUSE
*                                      WAS NO NAME TO BE LOADED SKIP
*                                      PAST THE LOAD ERROR MSG       */
         B     PASTMSG                                             0108
*NOLOAD:                            /* IF LOAD FAILS IT BRANCHES HERE*/
*                 TXTPTR=ADDR(NLDMSG);/* LOCATE THE PROPER ERROR MSG */
NOLOAD   L     TXTPTR,@CA00215                                     0109
*                 OUTBUF(1:TXTLEN)=TXT(1:TXTLEN);/* MOVE IN THE BULK
*                                      OF THE MSG                    */
         L     @10,ADPLBUF(,ABDPLPTR)                              0110
         SLR   @03,@03                                             0110
         IC    @03,TXTLEN(,TXTPTR)                                 0110
         BCTR  @03,0                                               0110
         EX    @03,@SM00264                                        0110
*                 OUTBUF(10:17)=FTRTNAME(INDEX);/* PERSONALIZE THE 0111
*                                      MSG                           */
         LR    @15,INDEX                                           0111
         MH    @15,@CH00120                                        0111
         L     @14,@CA00230                                        0111
         ALR   @14,@15                                             0111
         AL    @14,@CF00267                                        0111
         MVC   OUTBUF+9(8,@10),FTRTNAME-FMTTABLE-12(@14)           0111
*                 RFY                                              0112
*                   R1 RSTD;                                       0112
*                 R1=ADDR(ABDPL);   /* RESTORE AMDPRDMP PARMLIST PTR */
         LR    R1,ABDPLPTR                                         0113
*                 DO I=1 TO 2;      /* LOOP TO PRINT THE MSG LINE AND
*                                      A BLANK LINE                  */
         LA    I,1                                                 0114
@DL00114 DS    0H                                                  0115
*                   CALL LINEPRNT;  /* PRINT OUTPUT BUFFER WHICH   0115
*                                      AMDPRDMP INITS TO BLANKS      */
         L     @15,ADPLPRNT(,ABDPLPTR)                             0115
         BALR  @14,@15                                             0115
*                 END;                                             0116
         AH    I,@CH00053                                          0116
         CH    I,@CH00055                                          0116
         BNH   @DL00114                                            0116
*                 RFY                                              0117
*                   R1 UNRSTD;                                     0117
*PASTMSG:                                                          0118
*                 ;                 /* NORMAL ENTRY TO THIS DO GROUP
*                                      DID NOT TRY THE LOAD HENCE  0118
*                                      DOES NOT NEED THE MSG         */
PASTMSG  DS    0H                                                  0119
*                 RFY                                              0119
*                  (RETCODE) RSTD;                                 0119
*                 CALL FTDEFRTN(INDEX)->SPECFMT(ADDR(SAVEPL),SMDLRPTR,
*                     SMDLRADR);    /* USE THE DEFAULT FORMAT RTN TO
*                                      DO THIS RECORD                */
         LA    @14,SAVEPL                                          0120
         ST    @14,@AFTEMPS                                        0120
         LA    @14,@AFTEMPS                                        0120
         ST    @14,@AL00001                                        0120
         LA    @14,SMDLRPTR                                        0120
         ST    @14,@AL00001+4                                      0120
         L     @14,SMDLRPTR                                        0120
         LA    @14,SMDLRADR(,@14)                                  0120
         ST    @14,@AL00001+8                                      0120
         LR    @10,INDEX                                           0120
         MH    @10,@CH00120                                        0120
         L     @14,@CA00230                                        0120
         AL    @14,@CF00268                                        0120
         L     @15,FTDEFRTN-FMTTABLE-20(@10,@14)                   0120
         LA    @01,@AL00001                                        0120
         BALR  @14,@15                                             0120
*                 RFY                                              0121
*                  (RETCODE) UNRSTD;/* RETURN CODES FROM DEFAULT   0121
*                                      FORMAT SUBRTNS ARE IGNORED    */
*               END;                /* OF NO EXT FMT RTN             */
*           END;                    /* OF TITLE FORMATTED OK         */
@RC00081 DS    0H                                                  0124
*       END;                                                       0124
@RF00071 DS    0H                                                  0125
*   END;                                                           0125
@RC00049 DS    0H                                                  0125
@DE00038 LTR   CONDCODE,CONDCODE                                   0125
         BZ    @DL00038                                            0125
*   RETURN CODE(0);                 /* ALWAYS GIVE AMDPRDMP A GOOD 0126
*                                      RETURN CODE                   */
         L     @13,4(,@13)                                         0126
         L     @00,@SIZDATD                                        0126
         LR    @01,@11                                             0126
         FREEMAIN R,LV=(0),A=(1)
         SLR   @15,@15                                             0126
         L     @14,12(,@13)                                        0126
         LM    @00,@12,20(@13)                                     0126
         BR    @14                                                 0126
*   DECLARE                         /* GENERAL PURPOSE REGISTERS     */
*     GPR15F FIXED(31) REG(15),                                    0127
*     GPR00P PTR(31) REG(0),                                       0127
*     GPR01P PTR(31) REG(1);                                       0127
*   DECLARE                         /* COMMON VARIABLES              */
*     I256C CHAR(256) BASED,                                       0128
*     I031F FIXED(31) BASED,                                       0128
*     I031P PTR(31) BASED,                                         0128
*     I015F FIXED(15) BASED,                                       0128
*     I015P PTR(15) BASED,                                         0128
*     I008P PTR(8) BASED,                                          0128
*     I001C CHAR(1) BASED;                                         0128
*   END IEAVTFSD                                                   0129
*                                                                  0129
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (IHASMDLR)                                       */
*/*%INCLUDE SYSLIB  (IHAABDPL)                                       */
*                                                                  0129
*       ;                                                          0129
@DATA    DS    0H
@CH00053 DC    H'1'
@CH00055 DC    H'2'
@CH00059 DC    H'3'
@CH00061 DC    H'4'
@CH00065 DC    H'5'
@CH00120 DC    H'28'
@CH00165 DC    H'59'
@CH00167 DC    H'60'
@SM00264 MVC   OUTBUF(0,@10),TXT(TXTPTR)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    1F
@AL00001 DS    3A
@TF00001 DS    F
@AFTEMPS DS    1F
IEAVTFSD CSECT
         DS    0F
@CF00267 DC    F'-16'
@CF00268 DC    F'-8'
@CF00266 DC    F'-4'
@CF00251 DC    XL4'80000000'
@DATD    DSECT
         DS    0D
SMDLRPTR DS    A
SAVEPL   DS    CL60
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IEAVTFSD CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CV00205 DC    V(IEAVTFRD)
@CA00215 DC    A(NLDMSG)
@CA00216 DC    A(MAINTITL)
@CA00217 DC    A(RECTITLE)
@CA00218 DC    A(RECTITFP)
@CA00230 DC    A(FMTTABLE)
         DS    0D
@CC00244 DC    C'                '
@CC00239 EQU   @CC00244
PATCHLOC DC    CL256'PATCH AREA FOR IEAVTFSD. LENGTH 256 BYTES'
SMDWSAG  DC    AL2(6)
         DC    AL2(7)
         DC    AL2(8)
         DC    AL2(9)
         DC    AL2(10)
         DC    AL2(11)
         DC    AL2(12)
         DC    AL2(13)
         DC    AL2(14)
         DC    AL2(15)
         DC    AL2(16)
SMDWSAC  DC    AL2(17)
         DC    AL2(18)
         DC    AL2(19)
         DC    AL2(20)
         DC    AL2(21)
         DC    AL2(22)
         DC    AL2(23)
         DC    AL2(24)
         DC    AL2(25)
         DC    AL2(26)
         DC    AL2(27)
         DC    AL2(28)
         DC    AL2(29)
         DC    AL2(30)
         DC    AL2(54)
         DC    AL2(55)
SMDWSAL  DC    AL2(31)
         DC    AL2(32)
         DC    AL2(33)
         DC    AL2(34)
         DC    AL2(35)
         DC    AL2(36)
         DC    AL2(37)
         DC    AL2(38)
         DC    AL2(39)
         DC    AL2(40)
         DC    AL2(41)
         DC    AL2(42)
         DC    AL2(43)
         DC    AL2(44)
         DC    AL2(45)
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
INDEX    EQU   @07
TXTPTR   EQU   @02
I        EQU   @02
CONDCODE EQU   @08
PARMSAVE EQU   @09
ABDPLPTR EQU   @06
R1       EQU   @01
R0       EQU   @00
RETCODE  EQU   @15
GPR00P   EQU   @00
GPR01P   EQU   @01
GPR15F   EQU   @15
         EXTRN NLDMSG
         EXTRN MAINTITL
         EXTRN RECTITLE
         EXTRN RECTITFP
         EXTRN FMTTABLE
SMDLR    EQU   0
SMDLRHDR EQU   SMDLR
SMDLRID  EQU   SMDLRHDR
SMDLRADR EQU   SMDLRHDR+8
ABDPL    EQU   0
ADPLFLAG EQU   ABDPL+7
ADPLBUF  EQU   ABDPL+8
ADPLPRNT EQU   ABDPL+12
ADPLFRMT EQU   ABDPL+24
ADPLCOM1 EQU   ABDPL+28
ADPLFMT1 EQU   ABDPL+44
ADPLFMT2 EQU   ABDPL+48
OUTBUF   EQU   0
LINEPRNT EQU   0
FMTSERV  EQU   0
MSGTXT   EQU   0
TXTLEN   EQU   MSGTXT
TXT      EQU   MSGTXT+1
SPECFMT  EQU   0
I001C    EQU   0
I008P    EQU   0
I015F    EQU   0
I015P    EQU   0
I031F    EQU   0
I031P    EQU   0
I256C    EQU   0
FTLSTENT EQU   FMTTABLE
FTTABLE  EQU   FMTTABLE+12
FTRTNAME EQU   FTTABLE
FTDEFRTN EQU   FTTABLE+8
FTINSERT EQU   FTTABLE+12
X        EQU   0
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
FTTBLID  EQU   FMTTABLE+4
ADPLABDA EQU   ABDPL+56
ADPLEXT  EQU   ABDPL+52
ADPLCOM4 EQU   ABDPL+40
ADPLCOM3 EQU   ABDPL+36
ADPLCOM2 EQU   ABDPL+32
ADPLMEMA EQU   ABDPL+20
ADPLCVT  EQU   ABDPL+16
@NM00003 EQU   ADPLFLAG
ADPLDMGT EQU   ADPLFLAG
ADPLSYTM EQU   ADPLFLAG
ADPLSNPR EQU   ADPLFLAG
ADPLSBPL EQU   ABDPL+6
ADPLASID EQU   ABDPL+4
ADPLTCB  EQU   ABDPL
SMDLRDAT EQU   SMDLR+20
@NM00002 EQU   SMDLRHDR+17
SMDLRMSG EQU   SMDLRHDR+16
SMDLRPL  EQU   SMDLRHDR+12
SMDLRLEN EQU   SMDLRHDR+4
@NM00001 EQU   SMDLRHDR+2
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RT00054 EQU   GETNEXT
@RT00059 EQU   SKIPTITL
@RT00090 EQU   NOLOAD
@ENDDATA EQU   *
         END   IEAVTFSD,(C'PLS1951',0701,77280)

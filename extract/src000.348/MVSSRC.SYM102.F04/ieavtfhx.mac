TFHX     TITLE 'IEAVTFHX HEX DUMP RTN FOR IEAVTFSD                     *
                        '
IEAVTFHX CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP00001-@MAINENT)
         DC    AL1(22)                                             0001
         DC    C'IEAVTFHX UZ14566 77287'                           0001
IEAVTT3C DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP00195-IEAVTT3C)
         ENTRY IEAVTT3C
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@12                                         0001
         L     @00,@SIZDATD                                        0001
         GETMAIN  R,LV=(0)
         LR    @11,@01                                             0001
         USING @DATD,@11                                           0001
         ST    @13,@SA00001+4                                      0001
         LM    @15,@01,16(@13)                                     0001
         ST    @11,8(,@13)                                         0001
         LR    @13,@11                                             0001
         AH    @15,4(,@15)                                         0001
         BR    @15                                                 0001
@EP00001 MVC   @PC00001(12),0(@01)                                 0001
*                                                                  0037
*   /*****************************************************************/
*   /*                                                               */
*   /* INIT                                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0037
*   COMPRESS=OFF;                                                  0037
         NI    COMPRESS,B'01111111'                                0037
*   LASTLINE='';                                                   0038
         MVI   LASTLINE,C' '                                       0038
         MVC   LASTLINE+1(119),LASTLINE                            0038
*   MIAINDEX=1;                     /* START AT THE FIRST ENTRY OF 0039
*                                      THE TABLE OF DATA MISSING IN
*                                      ACTION                        */
         LA    MIAINDEX,1                                          0039
*   MIAPTR=ADDR(SMDLRDAT)+SMDLRLEN; /* LOCATE THE MIATABLE           */
         L     @15,@PC00001+4                                      0040
         L     @15,SMDLRPTR(,@15)                                  0040
         LA    @14,SMDLRDAT(,@15)                                  0040
         L     @15,SMDLRLEN(,@15)                                  0040
         LR    MIAPTR,@14                                          0040
         ALR   MIAPTR,@15                                          0040
*   DATAPTR=ADDR(SMDLRDAT);         /* INIT DATA TO BE FMT PTR       */
         LR    DATAPTR,@14                                         0041
*   LENLEFT=SMDLRLEN;               /* KEEP TRACK OF THE LENGTH OF 0042
*                                      DATA LEFT TO BE FORMATED      */
         LR    LENLEFT,@15                                         0042
*   CONDCODE=GOODCODE;              /* INIT RETURN CODE              */
*                                                                  0043
         SLR   @08,@08                                             0043
         ST    @08,CONDCODE                                        0043
*   /*****************************************************************/
*   /*                                                               */
*   /* LOOP PRINTING EITHER DATA OR A MSG SAYING THAT THE DATA IS    */
*   /* MISSING                                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0044
*   DO WHILE LENLEFT>0;             /* LOOP AS LONG AS THERE IS DATA
*                                      LEFT TO BE PRINTED            */
         B     @DE00044                                            0044
@DL00044 DS    0H                                                  0045
*     IF MIALAST(MIAINDEX)=OFF      /* CHECK FOR THE LAST ENTRY IN 0045
*                                      THE TABLE                     */
*       THEN                        /* IF IT IS NOT THE LAST ENTRY   */
         LR    @08,MIAINDEX                                        0045
         SLA   @08,3                                               0045
         ST    @08,@TF00001                                        0045
         ALR   @08,MIAPTR                                          0045
         AL    @08,@CF00393                                        0045
         TM    MIALAST(@08),B'10000000'                            0045
         BNZ   @RF00045                                            0045
*       IF MIABEGIN(MIAINDEX)=DATAPTR-ADDR(SMDLRDAT)/* CHECK TO SEE
*                                      IF THE NEXT DATA TO BE FMT IS
*                                      MISSING                       */
*         THEN                      /* YES IT IS MISSING             */
         L     @08,@TF00001                                        0046
         AL    @08,@CF00393                                        0046
         L     @08,MIABEGIN(@08,MIAPTR)                            0046
         L     @15,@PC00001+4                                      0046
         L     @01,SMDLRPTR(,@15)                                  0046
         LA    @15,SMDLRDAT(,@01)                                  0046
         LCR   @15,@15                                             0046
         ALR   @15,DATAPTR                                         0046
         CR    @08,@15                                             0046
         BNE   @RF00046                                            0046
*         DO;                                                      0047
*           FROMLABL=MIABEGIN(MIAINDEX)+BEGLABEL;/* CALC ADDRESSES 0048
*                                      FROM OFFSETS FOR THE MISSING
*                                      DATA                          */
         L     @15,@PC00001+8                                      0048
         L     @15,BEGLABEL(,@15)                                  0048
         ALR   @08,@15                                             0048
         ST    @08,FROMLABL                                        0048
*           TOLABL=MIAEND(MIAINDEX)+BEGLABEL;                      0049
         L     @08,@TF00001                                        0049
         AL    @08,@CF00394                                        0049
         AL    @15,MIAEND-4(@08,MIAPTR)                            0049
         ST    @15,TOLABL                                          0049
*           ADPLFMT2=ADDR(MIALABEL);/* PASS THE ADDRESSES OF THE   0050
*                                      MISSING TO THE FORMAT SERVICE
*                                      FOR INCLUSION INTO THE MSG    */
         L     @08,@PC00001                                        0050
         L     @08,ABDPLPTR(,@08)                                  0050
         LA    @15,MIALABEL                                        0050
         ST    @15,ADPLFMT2(,@08)                                  0050
*           RFY                                                    0051
*            (R0,                                                  0051
*             R1) RSTD;                                            0051
*           R1=ADDR(ABDPL);         /* POINT TO AMDPRDMP PARM LIST   */
         LR    R1,@08                                              0052
*           CALL LINEPRNT;          /* PRINT BLANK LINE              */
         L     @15,ADPLPRNT(,@08)                                  0053
         BALR  @14,@15                                             0053
*           R0=ADDR(MIAFP);         /* POINT TO THE FORMAT PATTERN 0054
*                                      FOR THE MISSING DATA LINE     */
         L     R0,@CA00335                                         0054
         LR    @08,R0                                              0054
         LR    R0,@08                                              0054
*           CALL FMTSERV;           /* CALL FORMAT SERVICE           */
         L     @08,@PC00001                                        0055
         L     @08,ABDPLPTR(,@08)                                  0055
         L     @15,ADPLFRMT(,@08)                                  0055
         BALR  @14,@15                                             0055
*           CALL LINEPRNT;          /* PRINT THE FORMATTED LINE      */
         L     @08,@PC00001                                        0056
         L     @08,ABDPLPTR(,@08)                                  0056
         L     @15,ADPLPRNT(,@08)                                  0056
         BALR  @14,@15                                             0056
*           CALL LINEPRNT;          /* BLANK LINE                    */
         L     @08,@PC00001                                        0057
         L     @08,ABDPLPTR(,@08)                                  0057
         L     @15,ADPLPRNT(,@08)                                  0057
         BALR  @14,@15                                             0057
*           RFY                                                    0058
*            (R0,                                                  0058
*             R1) UNRSTD;                                          0058
*           DATAPTR=DATAPTR+(MIAEND(MIAINDEX)-MIABEGIN(MIAINDEX)+1);
         LA    @08,1                                               0059
         LR    @04,MIAINDEX                                        0059
         SLA   @04,3                                               0059
         LR    @01,MIAPTR                                          0059
         AL    @01,@CF00394                                        0059
         L     @15,MIAEND-4(@04,@01)                               0059
         AL    @04,@CF00393                                        0059
         SL    @15,MIABEGIN(@04,MIAPTR)                            0059
         ALR   @15,@08                                             0059
         ALR   DATAPTR,@15                                         0059
*                                   /* MOVE THE PTR TO THE NEX DATA
*                                      TO BE FMT PAST THE MISSING  0060
*                                      DATA WHICH HAS BEEN REPLACED
*                                      WITH PADDING                  */
*           LENLEFT=LENLEFT-(MIAEND(MIAINDEX)-MIABEGIN(MIAINDEX)+1);
         SLR   LENLEFT,@15                                         0060
*                                   /* DECREMENT THE LENGTH LEFT TO
*                                      FMT                           */
*           MIAINDEX=MIAINDEX+1;    /* NOW THAT THIS ENTRY HAS BEEN
*                                      USED MOVE TO THE NEXT ONE     */
         ALR   MIAINDEX,@08                                        0061
*           REMAINS=0;              /* INDICATE NOTHING REMAINS TO BE
*                                      FORMATTED OF THIS PART        */
         SLR   REMAINS,REMAINS                                     0062
*         END;                                                     0063
*       ELSE                        /* THIS IS NOT THE BEGINNING OF A
*                                      MISSING PART OF THE DATA      */
*         DO;                                                      0064
         B     @RC00046                                            0064
@RF00046 DS    0H                                                  0065
*           REMAINS=(MIABEGIN(MIAINDEX)+ADDR(SMDLRDAT))-DATAPTR;/* 0065
*                                      CALC THE AMOUNT TO BE PRINTED
*                                      UP TO THE NEXT PIECE OF     0065
*                                      MISSING DATA                  */
         LR    @08,MIAINDEX                                        0065
         SLA   @08,3                                               0065
         L     @15,@PC00001+4                                      0065
         L     REMAINS,SMDLRPTR(,@15)                              0065
         LA    REMAINS,SMDLRDAT(,REMAINS)                          0065
         AL    @08,@CF00393                                        0065
         AL    REMAINS,MIABEGIN(@08,MIAPTR)                        0065
         SLR   REMAINS,DATAPTR                                     0065
*           LENLEFT=LENLEFT-REMAINS;/* REDUCE THE AMOUNT LEFT BY THE
*                                      AMOUNT ABOUT TO BE DONE       */
         SLR   LENLEFT,REMAINS                                     0066
*         END;                                                     0067
*     ELSE                          /* IF THE LAST MIA ENTRY HAS BEEN
*                                      REACHED                       */
*       DO;                                                        0068
         B     @RC00045                                            0068
@RF00045 DS    0H                                                  0069
*         REMAINS=LENLEFT;          /* THEN PRINT ALL THE DATA LEFT  */
         LR    REMAINS,LENLEFT                                     0069
*         LENLEFT=0;                /* INDICATE NO DATA LEFT UNFMT   */
         SLR   LENLEFT,LENLEFT                                     0070
*       END;                                                       0071
*                                                                  0072
*     /***************************************************************/
*     /*                                                             */
*     /* PRINT OUT THE AMOUNT OF DATA INDICATED BY REMAINS BEGINNING */
*     /* AT DATAPTR                                                  */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0072
*     BYTEONE=BEGLABEL+DATAPTR-ADDR(SMDLRDAT);/* CALC THE          0072
*                                      OFFSET/ADDRESS OF THE FIRST 0072
*                                      BYTE OF THIS PART TO BE     0072
*                                      FORMATTED                     */
@RC00045 L     @08,@PC00001+8                                      0072
         LR    @04,DATAPTR                                         0072
         AL    @04,BEGLABEL(,@08)                                  0072
         L     @08,@PC00001+4                                      0072
         L     @08,SMDLRPTR(,@08)                                  0072
         LA    @08,SMDLRDAT(,@08)                                  0072
         SLR   @04,@08                                             0072
         ST    @04,BYTEONE                                         0072
*     CURRLABL=BYTEONE&ROUNDED;     /* CALC THE INITIAL LABEL BY   0073
*                                      ROUNDING DOWN TO A MULTIPLE OF
*                                      '20'X                         */
         N     @04,@CF00319                                        0073
         ST    @04,CURRLABL                                        0073
*     DO WHILE REMAINS>0;           /* PRINT OUT ALL THE DATA LINE BY
*                                      LINE                          */
*                                                                  0074
         B     @DE00074                                            0074
@DL00074 DS    0H                                                  0075
*       /*************************************************************/
*       /*                                                           */
*       /* BUILD PARTIAL BEGINNING OR ENDING LINE IF NECESSARY       */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0075
*       IF CURRLABL<BYTEONE         /* CHECK THIS LINE FOR NOT     0075
*                                      BEGINNING AT THE LEFT MARGIN  */
*           ×REMAINS<BOL            /* OR FOR NOT ENDING AT THE RIGHT
*                                      MARGIN                        */
*         THEN                      /* IF THE EITHER OF THESE      0075
*                                      CONDITIONS EXIST A PARTIAL  0075
*                                      LINE WILL HAVE TO BE PRINTED  */
         CLC   CURRLABL(4),BYTEONE                                 0075
         BL    @RT00075                                            0075
         CH    REMAINS,@CH00137                                    0075
         BNL   @RF00075                                            0075
@RT00075 DS    0H                                                  0076
*         DO;                                                      0076
*                                                                  0076
*/* BUILD A DYNAMIC FORMAT PATTERN FOR THE AMDPRDMP FORMAT SERVICE   */
*                                                                  0077
*           FP=''B;                                                0077
         XC    FP(8),FP                                            0077
*           ADPLFMT2=ADDR(CURRLABL);/* POINT TO THE LABEL ADDRESS  0078
*                                      VALUE AS THE LABEL DATA       */
         L     @08,@PC00001                                        0078
         L     @08,ABDPLPTR(,@08)                                  0078
         LA    @04,CURRLABL                                        0078
         ST    @04,ADPLFMT2(,@08)                                  0078
*           FPDATIUS=ON;            /* INDICATE DATA TO BE FORMATTED
*                                      IS NOT IN THE DUMP            */
*           FPDATBUF=ON;            /* INDICATE DATA TO BE PROCESSED */
         OI    FPDATIUS,B'00010100'                                0080
*           FPLEN=LENGTH(CURRLABL)-1;/* GIVE THE DATA LENGTH         */
         MVI   FPLEN,X'03'                                         0081
*           FPDATOFF=0;             /* GIVE THE OFFSET IN THE BUFFER
*                                      WHERE THE DATA IS TO BE PUT   */
         MVI   FPDATOFF,X'00'                                      0082
*           RFY                                                    0083
*            (R1,                                                  0083
*             R0,                                                  0083
*             RETCODE) RSTD;        /* AMDPRDMP FMT SERV PARMS       */
*           R1=ADDR(ABDPL);         /* RESTORE AMDPRDMP PARMLIST PTR */
         LR    R1,@08                                              0084
*           R0=ADDR(FP);            /* FORMAT PATTERN PTR            */
         LA    R0,FP                                               0085
*           CALL FMTSERV;           /* AMDPRDMP FORMAT SERVICE       */
         L     @15,ADPLFRMT(,@08)                                  0086
         BALR  @14,@15                                             0086
*           IF RETCODE^=0           /* CHECK FOR AN AMDPRDMP SERVICE
*                                      ERROR                         */
*             THEN                  /* IF THERE WAS AN ERROR         */
         LTR   RETCODE,RETCODE                                     0087
         BZ    @RF00087                                            0087
*             DO;                                                  0088
*               CONDCODE=FMTERR;    /* CHANGE THE RETURN CODE        */
         MVC   CONDCODE(4),@CF00065                                0089
*               GO TO EXITCODE;     /* RETURN                        */
         B     EXITCODE                                            0090
*             END;                                                 0091
*           RFY                                                    0092
*            (R1,                                                  0092
*             R0,                                                  0092
*             RETCODE) UNRSTD;      /* FORMAT THE LINE LABEL         */
@RF00087 DS    0H                                                  0093
*                                                                  0093
*           /*********************************************************/
*           /*                                                       */
*           /* ADD THE DATA CONVERTED TO PRINTABLE HEX TO THE PARTIAL*/
*           /* LINE                                                  */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0093
*           ADPLFMT2=ADDR(NEXTDATA);/* POINT TO THE NEXT DATA TO BE
*                                      FORMATTED                     */
         L     @08,@PC00001                                        0093
         L     @08,ABDPLPTR(,@08)                                  0093
         ST    DATAPTR,ADPLFMT2(,@08)                              0093
*           IF CURRLABL<BYTEONE     /* CHECK TO SEE IF THIS IS THE 0094
*                                      FIRST LINE OF THIS PART       */
*             THEN                  /* IF IT IS THEN IT MIGHT NOT BE
*                                      STARTING AT THE LEFT MARGIN   */
         L     @08,CURRLABL                                        0094
         L     @04,BYTEONE                                         0094
         CR    @08,@04                                             0094
         BNL   @RF00094                                            0094
*             FIRST=BYTEONE-CURRLABL;/* CALCULATE THE DISPLACEMENT TO
*                                      THE FIRST BYTE FROM THE LEFT
*                                      MARGIN ADDRESS (MULTIPLE OF 0095
*                                      '20'X)                        */
         L     @15,CURRLABL                                        0095
         SLR   @04,@15                                             0095
         LR    FIRST,@04                                           0095
*           ELSE                    /* IF THIS IS NOT THE FIRST LINE */
*             FIRST=0;              /* START THE LINE AT THE LEFT  0096
*                                      MARGIN                        */
         B     @RC00094                                            0096
@RF00094 SLR   FIRST,FIRST                                         0096
*           IF FIRST+REMAINS>=BOL   /* COMPARE THE REMAINING DATA  0097
*                                      WITH THE CAPACITY OF THIS LINE*/
*             THEN                  /* IF THE REMAINS ARE GREATER  0097
*                                      THAN OR EQUAL                 */
@RC00094 LA    @04,32                                              0097
         LR    @15,FIRST                                           0097
         ALR   @15,REMAINS                                         0097
         CR    @15,@04                                             0097
         BL    @RF00097                                            0097
*             LAST=BOL;             /* FORMAT TO CAPACITY            */
         ST    @04,LAST                                            0098
*           ELSE                    /* IF THE CAPACITY IS GREATER    */
*             LAST=FIRST+REMAINS;   /* FORMAT ALL THE DATA           */
         B     @RC00097                                            0099
@RF00097 LR    @04,FIRST                                           0099
         ALR   @04,REMAINS                                         0099
         ST    @04,LAST                                            0099
*           GRPNUM=(FIRST/4)+1;     /* CALCULATE WHICH GROUP THE   0100
*                                      BEGINNING OF THE FORMATTED  0100
*                                      DATA WILL FALL INTO ON THE  0100
*                                      PRINTED LINE                  */
@RC00097 LR    @04,FIRST                                           0100
         SRL   @04,2                                               0100
         AH    @04,@CH00057                                        0100
         ST    @04,GRPNUM                                          0100
*           BYTEPOS=FIRST//4;       /* ALSO CALCULATE THE BYTE     0101
*                                      POSITION WITHIN THE GROUP   0101
*                                      WHERE THE DATA BEGINNING WILL
*                                      FALL                          */
         LR    @00,FIRST                                           0101
         SRDA  @00,32                                              0101
         D     @00,@CF00065                                        0101
         ST    @00,BYTEPOS                                         0101
*                                                                  0102
*           /*********************************************************/
*           /*                                                       */
*           /* FORMAT 4 BYTE GROUPS TO THE END OF THE LINE           */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0102
*           DO GRPNUM BY 1 WHILE(GRPNUM<=8&REMAINS>0);/* LOOP      0102
*                                      FORMATTING DATA INTO EACH   0102
*                                      GROUP UNTIL THE END OF THE  0102
*                                      LINE OR THE END OF THE DATA   */
         B     @DE00102                                            0102
@DL00102 DS    0H                                                  0103
*             IF REMAINS>=4-BYTEPOS /* CHECK THE AMOUNT OF DATA THAT
*                                      REMAINS AGAINST THE CAPACITY
*                                      OF THE GROUP ABOUT TO BE    0103
*                                      FORMATTED                     */
*               THEN                /* IF THERE IS MORE DATA THAN  0103
*                                      WILL FIT IN THIS GROUP        */
         L     @04,BYTEPOS                                         0103
         LA    @15,4                                               0103
         SLR   @15,@04                                             0103
         CR    REMAINS,@15                                         0103
         BL    @RF00103                                            0103
*               FPLEN=3-BYTEPOS;    /* FORMAT THE MAXIMUM            */
         LCR   @04,@04                                             0104
         AH    @04,@CH00063                                        0104
         STC   @04,FPLEN                                           0104
*             ELSE                  /* IF THE AMOUNT OF DATA IS LESS */
*               FPLEN=REMAINS-1;    /* FORMAT WHAT DATA IS LEFT      */
         B     @RC00103                                            0105
@RF00103 LR    @04,REMAINS                                         0105
         BCTR  @04,0                                               0105
         STC   @04,FPLEN                                           0105
*             FPDATOFF=GRPOFF(GRPNUM)+(BYTEPOS*2);/* CALCULATE THE 0106
*                                      OFFSET ON THE PRINTED LINE    */
@RC00103 L     @04,GRPNUM                                          0106
         SLA   @04,2                                               0106
         L     @15,BYTEPOS                                         0106
         ALR   @15,@15                                             0106
         AL    @15,GRPOFF-4(@04)                                   0106
         STC   @15,FPDATOFF                                        0106
*             RFY                                                  0107
*              (R1,                                                0107
*               R0,                                                0107
*               RETCODE) RSTD;      /* AMDPRDMP FMT SERV PARMS       */
*             R1=ADDR(ABDPL);       /* RESTORE AMDPRDMP PARMLIST PTR */
         L     @14,@PC00001                                        0108
         L     @14,ABDPLPTR(,@14)                                  0108
         LR    R1,@14                                              0108
*             R0=ADDR(FP);          /* FORMAT PATTERN PTR            */
         LA    R0,FP                                               0109
*             CALL FMTSERV;         /* AMDPRDMP FORMAT SERVICE       */
         L     @15,ADPLFRMT(,@14)                                  0110
         BALR  @14,@15                                             0110
*             IF RETCODE^=0         /* CHECK FOR AN AMDPRDMP SERVICE
*                                      ERROR                         */
*               THEN                /* IF THERE WAS AN ERROR         */
         LTR   RETCODE,RETCODE                                     0111
         BZ    @RF00111                                            0111
*               DO;                                                0112
*                 CONDCODE=FMTERR;  /* CHANGE THE RETURN CODE        */
         MVC   CONDCODE(4),@CF00065                                0113
*                 GO TO EXITCODE;   /* RETURN                        */
         B     EXITCODE                                            0114
*               END;                                               0115
*             RFY                                                  0116
*              (R1,                                                0116
*               R0,                                                0116
*               RETCODE) UNRSTD;                                   0116
@RF00111 DS    0H                                                  0117
*             BYTEPOS=0;            /* ONCE THE FIRST GROUP IS     0117
*                                      FORMATTED ALL THE REST WILL 0117
*                                      BEGIN AT THE LEFT POSITION OF
*                                      THE GROUP                     */
         SLR   @04,@04                                             0117
         ST    @04,BYTEPOS                                         0117
*             REMAINS=REMAINS-(FPLEN+1);/* DECREMENT THE COUNT OF  0118
*                                      REMAINING DATA TO BE FORMATTED*/
         LA    @04,1                                               0118
         SLR   @15,@15                                             0118
         IC    @15,FPLEN                                           0118
         ALR   @04,@15                                             0118
         SLR   REMAINS,@04                                         0118
*           END;                                                   0119
         LA    @04,1                                               0119
         AL    @04,GRPNUM                                          0119
         ST    @04,GRPNUM                                          0119
@DE00102 L     @04,GRPNUM                                          0119
         CH    @04,@CH00050                                        0119
         BH    @DC00102                                            0119
         LTR   REMAINS,REMAINS                                     0119
         BP    @DL00102                                            0119
@DC00102 DS    0H                                                  0120
*           BORDERL=ASTERISK;       /* PUT IN THE UNFORMATTED SECTION*/
         L     @04,@PC00001                                        0120
         L     @04,ABDPLPTR(,@04)                                  0120
         L     @15,ADPLBUF(,@04)                                   0120
         MVC   BORDERL(1,@15),ASTERISK                             0120
*           BORDERR=ASTERISK;       /* BORDERS                       */
         MVC   BORDERR(1,@15),ASTERISK                             0121
*           UNFMTSEC(FIRST+1:LAST)=NEXTDATA(1:LAST-FIRST);/* MOVE THE
*                                      PARTIAL LINE DATA INTO THE  0122
*                                      UNFORMATTED PART OF THE LINE  */
         LR    @14,@15                                             0122
         ALR   @14,FIRST                                           0122
         L     @03,LAST                                            0122
         SLR   @03,FIRST                                           0122
         BCTR  @03,0                                               0122
         EX    @03,@SM00395                                        0122
*           TR(UNFMTSEC,TRTABLE);   /* CHANGE ALL THE UNPRINTABLE  0123
*                                      EBCDIC CODES INTO PERIODS     */
         L     @14,@CA00326                                        0123
         TR    UNFMTSEC(32,@15),TRTABLE-TRTABLE(@14)               0123
*                                                                  0124
*           /*********************************************************/
*           /*                                                       */
*           /* PRINT THE PARTIAL LINE JUST FORMATTED                 */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0124
*           RFY                                                    0124
*             R1 RSTD;                                             0124
*           R1=ADDR(ABDPL);         /* RESTORE AMDPRDMP PARMLIST PTR */
         LR    R1,@04                                              0125
*           CALL LINEPRNT;          /* PRINT THE OUTPUT BUFFER       */
         L     @15,ADPLPRNT(,@04)                                  0126
         BALR  @14,@15                                             0126
*           RFY                                                    0127
*             R1 UNRSTD;                                           0127
*           CURRLABL=CURRLABL+BOL;  /* CALC NEXT OFFSET LABEL        */
         LA    @04,32                                              0128
         AL    @04,CURRLABL                                        0128
         ST    @04,CURRLABL                                        0128
*           DATAPTR=DATAPTR+LAST-FIRST;/* INCREMENT THE ADDRESS OF 0129
*                                      THE NEXT DATA TO BE FORMATTED
*                                      BY THE AMOUNT JUST DONE       */
         LR    @04,DATAPTR                                         0129
         AL    @04,LAST                                            0129
         SLR   @04,FIRST                                           0129
         LR    DATAPTR,@04                                         0129
*         END;                      /* OF INDENTED LINE              */
*                                                                  0131
*       /*************************************************************/
*       /*                                                           */
*       /* FORMAT AND PRINT OUT ALL THE FULL LINES                   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0131
*       LINEFP=STANLINE;            /* COPY THE STANDARD LINE FORMAT
*                                      PATTERN INTO DYNAMIC STORAGE  */
@RF00075 MVC   LINEFP(60),STANLINE                                 0131
*       LFP1=ADDR(CURRLABL);        /* FILL IN THE ADDR OF THE LABEL
*                                      VALUE                         */
         LA    @08,CURRLABL                                        0132
         ST    @08,LFP1                                            0132
*       DO WHILE(REMAINS>=BOL);     /* PRINT WHOLE LINES UNTIL THE 0133
*                                      DATA LEFT IS LESS THAN A WHOLE
*                                      LINE                          */
         B     @DE00133                                            0133
@DL00133 DS    0H                                                  0134
*         LFP2=ADDR(NEXTDATA);      /* FILL IN THE ADDR OF THE DATA  */
         ST    DATAPTR,LFP2                                        0134
*         LFP3=ADDR(NEXTDATA);                                     0135
         ST    DATAPTR,LFP3                                        0135
*         RFY                                                      0136
*          (R1,                                                    0136
*           R0,                                                    0136
*           RETCODE) RSTD;          /* AMDPRDMP FMT SERV PARMS       */
*         R1=ADDR(ABDPL);           /* RESTORE AMDPRDMP PARMLIST PTR */
         L     @14,@PC00001                                        0137
         L     @14,ABDPLPTR(,@14)                                  0137
         LR    R1,@14                                              0137
*         R0=ADDR(LINEFP);          /* FORMAT PATTERN PTR            */
         LA    R0,LINEFP                                           0138
*         CALL FMTSERV;             /* AMDPRDMP FORMAT SERVICE       */
         L     @15,ADPLFRMT(,@14)                                  0139
         BALR  @14,@15                                             0139
*         IF RETCODE^=0             /* CHECK FOR AN AMDPRDMP SERVICE
*                                      ERROR                         */
*           THEN                    /* IF THERE WAS AN ERROR         */
         LTR   RETCODE,RETCODE                                     0140
         BZ    @RF00140                                            0140
*           DO;                                                    0141
*             CONDCODE=FMTERR;      /* CHANGE THE RETURN CODE        */
         MVC   CONDCODE(4),@CF00065                                0142
*             GO TO EXITCODE;       /* RETURN                        */
         B     EXITCODE                                            0143
*           END;                                                   0144
*         RFY                                                      0145
*          (R1,                                                    0145
*           R0,                                                    0145
*           RETCODE) UNRSTD;                                       0145
@RF00140 DS    0H                                                  0146
*         TR(UNFMTSEC,TRTABLE);     /* CHANGE ALL THE UNPRINTABLE  0146
*                                      EBCDIC CODES INTO PERIODS     */
         L     @08,@PC00001                                        0146
         L     @08,ABDPLPTR(,@08)                                  0146
         L     @08,ADPLBUF(,@08)                                   0146
         L     @04,@CA00326                                        0146
         TR    UNFMTSEC(32,@08),TRTABLE-TRTABLE(@04)               0146
*         CURRLABL=CURRLABL+BOL;    /* CALC NEXT OFFSET LABEL        */
         LA    @04,32                                              0147
         L     @15,CURRLABL                                        0147
         ALR   @15,@04                                             0147
         ST    @15,CURRLABL                                        0147
*         DATAPTR=DATAPTR+BOL;      /* INCREMENT THE ADDRESS OF THE
*                                      NEXT DATA TO BE FORMATTED BY
*                                      THE AMOUNT JUST DONE          */
         ALR   DATAPTR,@04                                         0148
*         REMAINS=REMAINS-BOL;      /* CALC HOW MUCH DATA REMAINS TO
*                                      BE FORMATTED                  */
*                                                                  0149
         SLR   REMAINS,@04                                         0149
*         /***********************************************************/
*         /*                                                         */
*         /* THIS CODE SUPRESSES DUPLICATE LINES                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0150
*         IF THISDATA=LASTDATA&REMAINS>=BOL THEN                   0150
         CLC   THISDATA(112,@08),LASTDATA                          0150
         BNE   @RF00150                                            0150
         CR    REMAINS,@04                                         0150
         BL    @RF00150                                            0150
*           IF COMPRESS=OFF THEN                                   0151
         TM    COMPRESS,B'10000000'                                0151
         BNZ   @RF00151                                            0151
*             DO;                                                  0152
*               COMPRESS=ON;                                       0153
         OI    COMPRESS,B'10000000'                                0153
*               CMADDR1=THISLBL;                                   0154
         MVC   CMADDR1(8),THISLBL(@08)                             0154
*             END;                                                 0155
*           ELSE                                                   0156
*             ;                                                    0156
@RF00151 DS    0H                                                  0157
*         ELSE                                                     0157
*           DO;                                                    0157
         B     @RC00150                                            0157
@RF00150 DS    0H                                                  0158
*             LASTLINE=THISLINE;                                   0158
         L     @08,@PC00001                                        0158
         L     @08,ABDPLPTR(,@08)                                  0158
         L     @04,ADPLBUF(,@08)                                   0158
         MVC   LASTLINE(120),THISLINE(@04)                         0158
*             IF COMPRESS=ON THEN                                  0159
         TM    COMPRESS,B'10000000'                                0159
         BNO   @RF00159                                            0159
*               DO;                                                0160
*                 COMPRESS=OFF;                                    0161
         NI    COMPRESS,B'01111111'                                0161
*                 THISLINE=CMPRSMSG;                               0162
         MVC   THISLINE(120,@04),CMPRSMSG                          0162
*                 CMADDR2=LASTLBL;                                 0163
         MVC   CMADDR2(8,@04),LASTLBL                              0163
*                 CMADDR3=CMADDR1;                                 0164
         MVC   CMADDR3(8,@04),CMADDR1                              0164
*                 RFY                                              0165
*                   R1 RSTD;                                       0165
*                 R1=ADDR(ABDPL);   /* RESTORE AMDPRDMP PARMLIST PTR */
         LR    R1,@08                                              0166
*                 CALL LINEPRNT;    /* PRINT THE OUTPUT BUFFER       */
         L     @15,ADPLPRNT(,@08)                                  0167
         BALR  @14,@15                                             0167
*                 RFY                                              0168
*                   R1 UNRSTD;                                     0168
*                 THISLINE=LASTLINE;                               0169
         L     @08,@PC00001                                        0169
         L     @08,ABDPLPTR(,@08)                                  0169
         L     @08,ADPLBUF(,@08)                                   0169
         MVC   THISLINE(120,@08),LASTLINE                          0169
*               END;                                               0170
*             RFY                                                  0171
*               R1 RSTD;                                           0171
@RF00159 DS    0H                                                  0172
*             R1=ADDR(ABDPL);       /* RESTORE AMDPRDMP PARMLIST PTR */
         L     @08,@PC00001                                        0172
         L     @08,ABDPLPTR(,@08)                                  0172
         LR    R1,@08                                              0172
*             CALL LINEPRNT;        /* PRINT THE OUTPUT BUFFER       */
         L     @15,ADPLPRNT(,@08)                                  0173
         BALR  @14,@15                                             0173
*             RFY                                                  0174
*               R1 UNRSTD;                                         0174
*           END;                                                   0175
*       END;                        /* OF PRINT EACH FULL LINE       */
@RC00150 DS    0H                                                  0176
@DE00133 CH    REMAINS,@CH00137                                    0176
         BNL   @DL00133                                            0176
*     END;                          /* OF PRINT EACH LINE            */
@DE00074 LTR   REMAINS,REMAINS                                     0177
         BP    @DL00074                                            0177
*   END;                            /* OF DO WHILE LENLEFT>0         */
@DE00044 LTR   LENLEFT,LENLEFT                                     0178
         BP    @DL00044                                            0178
*                                                                  0179
*   /*****************************************************************/
*   /*                                                               */
*   /* COMMON EXIT CODE IF AT ANY TIME A TERMINATING CONDITION SHOULD*/
*   /* ARRISE THE CONDITION CODE IS SET AND THE CODE BRANCHES HERE   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0179
*EXITCODE:                                                         0179
*   IF CONDCODE^=GOODCODE           /* CHECK FOR AN ERROR            */
*     THEN                          /* IF AN ERROR OCCURRED          */
EXITCODE ICM   @10,15,CONDCODE                                     0179
         BZ    @RF00179                                            0179
*     DO;                           /* PRINT OUT AN ERROR MSG        */
*       DO INDEX=1 TO 2;            /* BLANK LINES                   */
         LA    INDEX,1                                             0181
@DL00181 DS    0H                                                  0182
*         RFY                                                      0182
*           R1 RSTD;                                               0182
*         R1=ADDR(ABDPL);           /* RESTORE AMDPRDMP PARMLIST PTR */
         L     @10,@PC00001                                        0183
         L     @10,ABDPLPTR(,@10)                                  0183
         LR    R1,@10                                              0183
*         CALL LINEPRNT;            /* PRINT THE OUTPUT BUFFER       */
         L     @15,ADPLPRNT(,@10)                                  0184
         BALR  @14,@15                                             0184
*         RFY                                                      0185
*           R1 UNRSTD;                                             0185
*       END;                                                       0186
         AH    INDEX,@CH00057                                      0186
         CH    INDEX,@CH00059                                      0186
         BNH   @DL00181                                            0186
*       MSGPTR=FHXMSG(CONDCODE/4);  /* LOCATE THE PROPER MSG         */
         L     @00,CONDCODE                                        0187
         SRDA  @00,32                                              0187
         D     @00,@CF00065                                        0187
         SLA   @01,2                                               0187
         L     @10,@CA00309                                        0187
         AL    @10,@CF00394                                        0187
         L     MSGPTR,FHXMSG-FHXMSG(@01,@10)                       0187
*       OUTBUF(1:MSGLEN)=MSGTXT(1:MSGLEN);/* COPY THE TEXT           */
         L     @10,@PC00001                                        0188
         L     @10,ABDPLPTR(,@10)                                  0188
         L     @03,ADPLBUF(,@10)                                   0188
         SLR   @15,@15                                             0188
         IC    @15,MSGLEN(,MSGPTR)                                 0188
         BCTR  @15,0                                               0188
         EX    @15,@SM00398                                        0188
*       RFY                                                        0189
*         R1 RSTD;                                                 0189
*       R1=ADDR(ABDPL);             /* RESTORE AMDPRDMP PARMLIST PTR */
         LR    R1,@10                                              0190
*       CALL LINEPRNT;              /* PRINT THE OUTPUT BUFFER       */
         L     @15,ADPLPRNT(,@10)                                  0191
         BALR  @14,@15                                             0191
*       RFY                                                        0192
*         R1 UNRSTD;                                               0192
*     END;                          /* OF ERROR MSG                  */
*   RETURN CODE(CONDCODE);                                         0194
@RF00179 L     @10,CONDCODE                                        0194
         L     @13,4(,@13)                                         0194
         L     @00,@SIZDATD                                        0194
         LR    @01,@11                                             0194
         FREEMAIN R,LV=(0),A=(1)
         LR    @15,@10                                             0194
         L     @14,12(,@13)                                        0194
         LM    @00,@12,20(@13)                                     0194
         BR    @14                                                 0194
*                                                                  0195
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ENTRY POINT IS THE DEFAULT FORMAT ROUTINE FOR THE SUMMARY*/
*   /* DUMP RECORD WHICH CONTAINS AS DATA THE ASID JOBNAME PROCSTEP  */
*   /* NAME AND STEPNAME FOR THE RECORDS THAT FOLLOW. ID=3C OR       */
*   /* SMDASIDR                                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0195
*IEAVTT3C:                                                         0195
*   ENTRY(ABDPLPTR,SMDLRPTR,BEGLABEL);                             0195
@EP00195 MVC   @PC00001(12),0(@01)                                 0195
*   DCL                                                            0196
*     1 T3CREC DEFINED(SMDLRDAT),   /* MAPPING OF THE DATA PORTION OF
*                                      THE RECORD FORMATTED BY THIS
*                                      RTN                           */
*      2 T3CASID CHAR(2),                                          0196
*      2 T3CJOBN CHAR(8),                                          0196
*      2 T3CPSN CHAR(8),                                           0196
*      2 T3CSN CHAR(8);                                            0196
*   DCL                                                            0197
*    (T3CFP1,                                                      0197
*     T3CFP2,                                                      0197
*     T3CFP3,                                                      0197
*     T3CFP4) CHAR(*) GEND STATIC;  /* THESE ARE THE FORMAT PATTERNS
*                                      USED TO FORMAT THE DATA IN THE
*                                      RECORD                        */
*   GEN DATA DEFS(T3CFP1,T3CFP2,T3CFP3,T3CFP4);                    0198
*   RFY                                                            0199
*    (R0,                                                          0199
*     R1) RSTD;                                                    0199
*   R1=ADDR(ABDPL);                                                0200
         L     @10,@PC00001                                        0200
         L     R1,ABDPLPTR(,@10)                                   0200
*   DO INDEX=1 TO 60;               /* PRINT ENOUGH BLANK LINES TO 0201
*                                      PUT THIS HEADER AT THE TOP OF
*                                      THE NEXT PAGE                 */
         LA    INDEX,1                                             0201
@DL00201 DS    0H                                                  0202
*     CALL LINEPRNT;                                               0202
         L     @10,@PC00001                                        0202
         L     @10,ABDPLPTR(,@10)                                  0202
         L     @15,ADPLPRNT(,@10)                                  0202
         BALR  @14,@15                                             0202
*   END;                                                           0203
         AH    INDEX,@CH00057                                      0203
         CH    INDEX,@CH00171                                      0203
         BNH   @DL00201                                            0203
*   R0=ADDR(T3CFP1);                /* FORMAT PATTERN FOR FIRST PART
*                                      OF DATA                       */
         LA    R0,T3CFP1                                           0204
*   ADPLFMT2=ADDR(SMDLRDAT);        /* DATA TO BE FORMATTED          */
         L     @10,@PC00001                                        0205
         L     @10,ABDPLPTR(,@10)                                  0205
         L     @15,@PC00001+4                                      0205
         L     @15,SMDLRPTR(,@15)                                  0205
         LA    @15,SMDLRDAT(,@15)                                  0205
         ST    @15,ADPLFMT2(,@10)                                  0205
*   CALL FMTSERV;                                                  0206
         L     @15,ADPLFRMT(,@10)                                  0206
         BALR  @14,@15                                             0206
*   IF SMDLRLEN>4                   /* CHECK FOR THE LONG FORM OF  0207
*                                      THIS RECORD                   */
*     THEN                                                         0207
         L     @10,@PC00001+4                                      0207
         L     @10,SMDLRPTR(,@10)                                  0207
         L     @10,SMDLRLEN(,@10)                                  0207
         CH    @10,@CH00065                                        0207
         BNH   @RF00207                                            0207
*     DO;                                                          0208
*       R0=ADDR(T3CFP2);                                           0209
         LA    R0,T3CFP2                                           0209
*       R1=ADDR(ABDPL);                                            0210
         L     @10,@PC00001                                        0210
         L     @10,ABDPLPTR(,@10)                                  0210
         LR    R1,@10                                              0210
*       CALL FMTSERV;                                              0211
         L     @15,ADPLFRMT(,@10)                                  0211
         BALR  @14,@15                                             0211
*       IF T3CSN='        '         /* IS THE STEPNAME FIELD IS BLANK*/
*         THEN                      /* YES, SO THE PROC/STEPNAME   0212
*                                      FIELD IS ONLY A STEPNAME AND
*                                      THE PROC/STEPNAME LABEL SHOULD
*                                      BE SKIPPED                    */
         L     @10,@PC00001+4                                      0212
         L     @10,SMDLRPTR(,@10)                                  0212
         CLC   T3CSN(8,@10),@CC00390                               0212
         BNE   @RF00212                                            0212
*         R0=ADDR(T3CFP4);                                         0213
         LA    R0,T3CFP4                                           0213
*       ELSE                        /* THE STEPNAME FIELD HAS A VALUE
*                                      SO FORMAT THE WHOLE RECORD    */
*         R0=ADDR(T3CFP3);                                         0214
         B     @RC00212                                            0214
@RF00212 LA    R0,T3CFP3                                           0214
*       R1=ADDR(ABDPL);                                            0215
@RC00212 L     @10,@PC00001                                        0215
         L     @10,ABDPLPTR(,@10)                                  0215
         LR    R1,@10                                              0215
*       CALL FMTSERV;                                              0216
         L     @15,ADPLFRMT(,@10)                                  0216
         BALR  @14,@15                                             0216
*     END;                                                         0217
*   CALL LINEPRNT;                                                 0218
@RF00207 L     @10,@PC00001                                        0218
         L     @10,ABDPLPTR(,@10)                                  0218
         L     @15,ADPLPRNT(,@10)                                  0218
         BALR  @14,@15                                             0218
*   RFY                                                            0219
*    (R0,                                                          0219
*     R1) UNRSTD;                                                  0219
*   RETURN CODE(0);                                                0220
         L     @13,4(,@13)                                         0220
         L     @00,@SIZDATD                                        0220
         LR    @01,@11                                             0220
         FREEMAIN R,LV=(0),A=(1)
         SLR   @15,@15                                             0220
         L     @14,12(,@13)                                        0220
         LM    @00,@12,20(@13)                                     0220
         BR    @14                                                 0220
*   END IEAVTFHX                                                   0221
*                                                                  0221
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (IHASMDLR)                                       */
*/*%INCLUDE SYSLIB  (IHAABDPL)                                       */
*                                                                  0221
*       ;                                                          0221
@DATA    DS    0H
@CH00057 DC    H'1'
@CH00059 DC    H'2'
@CH00063 DC    H'3'
@CH00050 DC    H'8'
@CH00137 DC    H'32'
@CH00171 DC    H'60'
@SM00395 MVC   UNFMTSEC(0,@14),NEXTDATA(DATAPTR)
@SM00398 MVC   OUTBUF(0,@03),MSGTXT(MSGPTR)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    3F
@TF00001 DS    F
IEAVTFHX CSECT
         DS    0F
@CF00065 DC    F'4'
@CH00065 EQU   @CF00065+2
@CF00319 DC    F'-32'
@CF00393 DC    F'-8'
@CF00394 DC    F'-4'
@DATD    DSECT
         DS    0D
GRPNUM   DS    F
BYTEPOS  DS    A
CONDCODE DS    F
LAST     DS    A
BYTEONE  DS    A
CURRLABL DS    A
LINEFP   DS    CL60
         ORG   LINEFP
@NM00047 DS    CL8
LFP1     DS    AL4
@NM00048 DS    CL8
LFP2     DS    AL4
@NM00049 DS    CL4
LFP3     DS    AL4
         ORG   LINEFP+60
FP       DS    CL8
         ORG   FP
FPCODE   DS    BL1
         ORG   FPCODE
@NM00050 DS    BL1
FPDATNOC EQU   FPCODE+0
FPDATIUS EQU   FPCODE+0
FPDPHER  EQU   FPCODE+0
FPDATBUF EQU   FPCODE+0
FPLABBUF EQU   FPCODE+0
         ORG   FP+1
FPLEN    DS    AL1
FPLABOFF DS    AL1
FPDATOFF DS    AL1
FPEND    DS    AL4
         ORG   FP+8
MIALABEL DS    CL8
         ORG   MIALABEL
FROMLABL DS    AL4
TOLABL   DS    AL4
         ORG   MIALABEL+8
LASTLINE DS    CL120
         ORG   LASTLINE
LASTLBL  DS    CL8
LASTDATA DS    CL112
         ORG   LASTLINE+120
COMPRESS DS    BL1
CMADDR1  DS    CL8
IEAVTFHX CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CA00309 DC    A(FHXMSG)
@CA00326 DC    A(TRTABLE)
@CA00335 DC    A(MIAFP)
         DS    0D
@CC00390 DC    C'        '
STANLINE DS    CL60
         ORG   STANLINE
FPLABEL  DS    CL12
         ORG   FPLABEL
@NM00005 DC    B'00011111'
@NM00006 DC    XL1'03'
@NM00007 DC    AL1(86)
@NM00008 DC    AL1(0)
@NM00009 DC    AL4(ASTERISK)
@NM00010 DC    A(0)
         ORG   STANLINE+12
FPHXL1   DS    CL12
         ORG   FPHXL1
@NM00011 DC    B'00011111'
@NM00012 DC    XL1'03'
@NM00013 DC    AL1(119)
@NM00014 DC    AL1(11)
@NM00015 DC    AL4(ASTERISK)
@NM00016 DC    A(0)
         ORG   STANLINE+24
FPHXL2   DS    CL8
         ORG   FPHXL2
@NM00017 DC    B'00010111'
@NM00018 DC    XL1'F3'
@NM00019 DC    AL1(87)
@NM00020 DC    AL1(20)
@NM00021 DC    A(0)
         ORG   STANLINE+32
FPHXL3   DS    CL4
         ORG   FPHXL3
@NM00022 DC    B'00010101'
@NM00023 DC    XL1'F3'
@NM00024 DC    AL1(103)
@NM00025 DC    AL1(29)
         ORG   STANLINE+36
FPHXL4   DS    CL4
         ORG   FPHXL4
@NM00026 DC    B'00010100'
@NM00027 DC    XL1'03'
@NM00028 DC    AL1(0)
@NM00029 DC    AL1(38)
         ORG   STANLINE+40
FPHXL5   DS    CL4
         ORG   FPHXL5
@NM00030 DC    B'00010100'
@NM00031 DC    XL1'03'
@NM00032 DC    AL1(0)
@NM00033 DC    AL1(49)
         ORG   STANLINE+44
FPHXL6   DS    CL4
         ORG   FPHXL6
@NM00034 DC    B'00010100'
@NM00035 DC    XL1'03'
@NM00036 DC    AL1(0)
@NM00037 DC    AL1(58)
         ORG   STANLINE+48
FPHXL7   DS    CL4
         ORG   FPHXL7
@NM00038 DC    B'00010100'
@NM00039 DC    XL1'03'
@NM00040 DC    AL1(0)
@NM00041 DC    AL1(67)
         ORG   STANLINE+52
FPHXL8   DS    CL4
         ORG   FPHXL8
@NM00042 DC    B'00010100'
@NM00043 DC    XL1'03'
@NM00044 DC    AL1(0)
@NM00045 DC    AL1(76)
         ORG   STANLINE+56
@NM00046 DC    A(0)
         ORG   STANLINE+60
ASTERISK DC    CL1'*'
CMPRSMSG DC    CL120'********   LINES FROM XXHEREXX TO XTHEREXX ARE THEC
                SAME AS THE ABOVE LINE'
PATCHLOC DC    CL100'IEAVTFHX PATCH AREA. 100 BYTES LONG'
         DS    CL1
SMDWSAG  DC    AL2(6)
         DC    AL2(7)
         DC    AL2(8)
         DC    AL2(9)
         DC    AL2(10)
         DC    AL2(11)
         DC    AL2(12)
         DC    AL2(13)
         DC    AL2(14)
         DC    AL2(15)
         DC    AL2(16)
SMDWSAC  DC    AL2(17)
         DC    AL2(18)
         DC    AL2(19)
         DC    AL2(20)
         DC    AL2(21)
         DC    AL2(22)
         DC    AL2(23)
         DC    AL2(24)
         DC    AL2(25)
         DC    AL2(26)
         DC    AL2(27)
         DC    AL2(28)
         DC    AL2(29)
         DC    AL2(30)
         DC    AL2(54)
         DC    AL2(55)
SMDWSAL  DC    AL2(31)
         DC    AL2(32)
         DC    AL2(33)
         DC    AL2(34)
         DC    AL2(35)
         DC    AL2(36)
         DC    AL2(37)
         DC    AL2(38)
         DC    AL2(39)
         DC    AL2(40)
         DC    AL2(41)
         DC    AL2(42)
         DC    AL2(43)
         DC    AL2(44)
         DC    AL2(45)
         DS    CL2
GRPOFF   DC    A(11)
         DC    A(20)
         DC    A(29)
         DC    A(38)
         DC    A(49)
         DC    A(58)
         DC    A(67)
         DC    A(76)
IEAVTFHX CSECT
T3CFP1 DC X'03F00000'             TEXT
       DC AL4(T3CTXT1)
       DC X'01F01000'             TEXT
       DC X'15C1202E'             TEXT & ASID
       DC AL4(0)
T3CFP2 DC X'3577333C'             TEXT & JOBNAME
       DC AL4(0)
T3CFP3 DC X'35D74554'             TEXT & PROC STEPNAME
       DC X'35875D67'             TEXT & STEPNAME
       DC AL4(0)
T3CFP4 DC X'3787454F'             TEXT & STEPNAME
       DC AL4(T3CTXT2)
       DC AL4(0)
* NOTE T3CFP3 USES T3CTXT1 & T3CTXT2 AND ASSUMES THEY ARE CONSECUTIVE
T3CTXT1 DC C'---------------- SUMMARY DUMP OUTPUT FOR ASIDJOBNAME=PROC S
               STEPNAME='
T3CTXT2 DC C'STEPNAME='
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IEAVTFHX CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
MIAINDEX EQU   @07
MIAPTR   EQU   @09
LENLEFT  EQU   @10
REMAINS  EQU   @05
DATAPTR  EQU   @06
INDEX    EQU   @03
FIRST    EQU   @08
MSGPTR   EQU   @02
R0       EQU   @00
RETCODE  EQU   @15
R1       EQU   @01
         EXTRN FHXMSG
         EXTRN TRTABLE
         EXTRN MIAFP
SMDLR    EQU   0
SMDLRHDR EQU   SMDLR
SMDLRLEN EQU   SMDLRHDR+4
SMDLRDAT EQU   SMDLR+20
ABDPL    EQU   0
ADPLFLAG EQU   ABDPL+7
ADPLBUF  EQU   ABDPL+8
ADPLPRNT EQU   ABDPL+12
ADPLFRMT EQU   ABDPL+24
ADPLFMT2 EQU   ABDPL+48
FMTSERV  EQU   0
LINEPRNT EQU   0
OUTBUF   EQU   0
BORDERL  EQU   OUTBUF+86
UNFMTSEC EQU   OUTBUF+87
BORDERR  EQU   OUTBUF+119
MSG      EQU   0
MSGLEN   EQU   MSG
MSGTXT   EQU   MSG+1
NEXTDATA EQU   0
MIATABLE EQU   0
MIABEGIN EQU   MIATABLE
MIALAST  EQU   MIABEGIN
MIAEND   EQU   MIATABLE+4
ABDPLPTR EQU   0
SMDLRPTR EQU   0
BEGLABEL EQU   0
THISLINE EQU   OUTBUF
THISLBL  EQU   THISLINE
THISDATA EQU   THISLINE+8
CMMAP    EQU   OUTBUF
CMADDR3  EQU   CMMAP+22
CMADDR2  EQU   CMMAP+34
T3CREC   EQU   SMDLRDAT
T3CSN    EQU   T3CREC+18
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
T3CPSN   EQU   T3CREC+10
T3CJOBN  EQU   T3CREC+2
T3CASID  EQU   T3CREC
@NM00052 EQU   CMMAP+30
@NM00051 EQU   CMMAP
MIAPAD   EQU   MIAEND
@NM00004 EQU   OUTBUF
ADPLABDA EQU   ABDPL+56
ADPLEXT  EQU   ABDPL+52
ADPLFMT1 EQU   ABDPL+44
ADPLCOM4 EQU   ABDPL+40
ADPLCOM3 EQU   ABDPL+36
ADPLCOM2 EQU   ABDPL+32
ADPLCOM1 EQU   ABDPL+28
ADPLMEMA EQU   ABDPL+20
ADPLCVT  EQU   ABDPL+16
@NM00003 EQU   ADPLFLAG
ADPLDMGT EQU   ADPLFLAG
ADPLSYTM EQU   ADPLFLAG
ADPLSNPR EQU   ADPLFLAG
ADPLSBPL EQU   ABDPL+6
ADPLASID EQU   ABDPL+4
ADPLTCB  EQU   ABDPL
@NM00002 EQU   SMDLRHDR+17
SMDLRMSG EQU   SMDLRHDR+16
SMDLRPL  EQU   SMDLRHDR+12
SMDLRADR EQU   SMDLRHDR+8
@NM00001 EQU   SMDLRHDR+2
SMDLRID  EQU   SMDLRHDR
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00046 EQU   @RC00045
@ENDDATA EQU   *
         END   IEAVTFHX,(C'PLS2115',0701,77287)

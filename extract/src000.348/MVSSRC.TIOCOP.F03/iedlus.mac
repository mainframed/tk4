         TITLE 'IEDLUS, LOGICAL UNIT SERVICES                          *
                        '
IEDLUS   CSECT ,                                                   0001
@PROLOG  DS    0H                                                  0002
         USING *,RBASE1,RBASE2
         DC    XL2'0400'            STCB FOR THIS MODULE
*
         LR    RBASE1,RSTCB         SET UP BASE REGISTERS 1 & 2
         LA    RBASE2,X'FFF'(RBASE1)
         LA    RBASE2,1(RBASE2)
*
         LA    RPARM,0(RPARM)       CLEAR HIGH-ORDER BYTE
*
IEDLUS   IEDHJN  START
         EJECT
*                                                                  0547
*/********************************************************************/
*/*                                                                  */
*/*      M A I N   S E G M E N T                                     */
*/*                                                                  */
*/********************************************************************/
*                                                                  0547
*   BYPASSSW=OFF;                   /* INITIALIZE FOR NORMAL EXIT    */
         NI    BYPASSSW,B'01111111'                                0547
*                                   /* DETERMINE INPUT ELEMENT TYPE  */
*   IF RECBPRI=PRILUSQB THEN        /* DESTINATION QCB?              */
         CLI   RECBPRI(RPARM),226                                  0548
         BNE   @RF00548                                            0548
*     CALL QCBRTN;                  /* YES                           */
         BAL   @14,QCBRTN                                          0549
*   ELSE                                                           0550
*     IF RECBPRI=PRILNFRE THEN      /* PLCB?                         */
         B     @RC00548                                            0550
@RF00548 CLI   RECBPRI(RPARM),224                                  0550
         BNE   @RF00550                                            0550
*       CALL PLCBRTN;               /* YES                           */
         BAL   @14,PLCBRTN                                         0551
*     ELSE                                                         0552
*       IF RECBPRI=PRIACTIV THEN    /* ERB?                          */
         B     @RC00550                                            0552
@RF00550 CLI   RECBPRI(RPARM),228                                  0552
         BNE   @RF00552                                            0552
*         CALL ERBRTN;              /* YES                           */
         BAL   @14,ERBRTN                                          0553
*       ELSE                                                       0554
*         IF RECBPRI=PRISSPIU THEN  /* PIU BUFFER?                   */
         B     @RC00552                                            0554
@RF00552 CLI   RECBPRI(RPARM),229                                  0554
         BNE   @RF00554                                            0554
*           CALL PIURTN;            /* YES                           */
         BAL   @14,PIURTN                                          0555
*         ELSE                                                     0556
*           IF RECBPRI=PRILUSR THEN /* DEACTIVATE REQUEST ELEMENT?   */
         B     @RC00554                                            0556
@RF00554 CLI   RECBPRI(RPARM),218                                  0556
         BNE   @RF00556                                            0556
*             CALL DACTRTN;         /* YES                           */
         BAL   @14,DACTRTN                                         0557
*   IF BYPASSSW=OFF THEN            /* NORMAL EXIT?                  */
@RF00556 DS    0H                                                  0558
@RC00554 DS    0H                                                  0558
@RC00552 DS    0H                                                  0558
@RC00550 DS    0H                                                  0558
@RC00548 TM    BYPASSSW,B'10000000'                                0558
         BNZ   @RF00558                                            0558
*     CALL DSPDISP;                 /* YES, EXIT TO DISPATCHER       */
         LA    @15,DSPDISP(,RDISP)                                 0559
         BALR  @14,@15                                             0559
*   ELSE                            /* NO                            */
*     DO;                           /* BYPASS TO QEVENT WITH PLCB    */
         B     @RC00558                                            0560
@RF00558 DS    0H                                                  0561
*       RPARM=RLCB;                 /* ELEMENT ADDRESS               */
         LR    RPARM,RLCB                                          0561
*       RSTCB=LCBRSLNK;             /* STCB ADDRESS                  */
         L     RSTCB,LCBRSLNK-1(,RLCB)                             0562
         LA    RSTCB,0(,RSTCB)                                     0562
*       RQCB=RLCB;                  /* QCB ADDRESS                   */
         LR    RQCB,RLCB                                           0563
*       CALL DSPBYPAS;              /* BYPASS TO QEVENT              */
         LA    @15,DSPBYPAS(,RDISP)                                0564
         BALR  @14,@15                                             0564
*     END;                                                         0565
*                                                                  0566
*/**************  E N D   O F   M A I N   S E G M E N T  *************/
*                                                                  0566
         EJECT
*BINDFAIL:                                                         0566
*   PROC OPTIONS(SAVE(R14));                                       0566
*                                                                  0566
@EL00001 DS    0H                                                  0566
@EF00001 DS    0H                                                  0566
@ER00001 BR    @14                                                 0566
BINDFAIL ST    @14,@SA00002                                        0566
*/********************************************************************/
*/*                                                                  */
*/*      B I N D F A I L   SUBROUTINE                                */
*/*                                                                  */
*/********************************************************************/
*/*                                                                  */
*/*      THIS SUBROUTINE FINISHES BIND-FAILURE PROCESSING AFTER      */
*/*      ALL TCAM MH ERROR PROCESSING CONNECTED WITH THE FAILURE     */
*/*      HAS ENDED.  THE ROUTINE IS ENTERED TWICE.                   */
*/*                                                                  */
*/*      1ST ENTRY (CALLED BY PLCBRTN):                              */
*/*         THE PLCB'S ERB IS TPOSTED TO REQUEST A BUFFER.           */
*/*                                                                  */
*/*      2ND ENTRY (CALLED BY ERBRTNX):                              */
*/*         .  A BIND-FAILED PIU IS BUILT & SENT TO THE SSCP.        */
*/*         .  END-OF-SESSION CLEAN-UP IS DONE.              @YM08450*/
*/*                                                                  */
*/********************************************************************/
*                                                                  0567
*   IF LCBERBCH=0 THEN              /* NEED TO REQUEST A BUFFER?     */
         L     @09,LCBERBCH-1(,RLCB)                               0567
         LA    @09,0(,@09)                                         0567
         LTR   @09,@09                                             0567
         BNZ   @RF00567                                            0567
*     DO;                           /* YES                           */
*       LCBRBCT2=1;                 /* NUMBER OF UNITS NEEDED        */
         MVI   LCBRBCT2(RLCB),X'01'                                0569
*       CALL TPOSTERB;              /* REQUEST A BUFFER              */
         BAL   @14,TPOSTERB                                        0570
*     END;                                                         0571
*   ELSE                            /* WE ALREADY HAVE A BUFFER      */
*     DO;                           /* SEND BIND-FAILED PIU TO SSCP  */
         B     @RC00567                                            0572
@RF00567 DS    0H                                                  0573
*       RPRF=LCBERBCH;              /* BUFFER ADDRESS                */
         L     RPRF,LCBERBCH-1(,RLCB)                              0573
         LA    RPRF,0(,RPRF)                                       0573
*       LCBERBCH=0;                 /* CLEAR ERB'S BUFFER POINTER    */
         SLR   @09,@09                                             0574
         STCM  @09,7,LCBERBCH(RLCB)                                0574
*       RPARM=CD1XBFL;              /* BIND-FAILED REQUEST CODE      */
         L     RPARM,@CF00759                                      0575
*       CALL BLDMULTI;              /* BUILD & TPOST PIU             */
         BAL   @14,BLDMULTI                                        0576
*       CALL SECLNUP;               /* DO END-OF-SESSION CTL BLOCK 0577
*                                      CLEAN-UP              @YM08450*/
         BAL   @14,SECLNUP                                         0577
*     END;                                                         0578
*   END BINDFAIL;                   /* RETURN TO CALLER              */
@EL00002 DS    0H                                                  0579
@EF00002 DS    0H                                                  0579
@ER00002 L     @14,@SA00002                                        0579
         BR    @14                                                 0579
         EJECT
*BLDINITS:                                                         0580
*   PROC OPTIONS(SAVE(R14));                                       0580
*                                                                  0580
BLDINITS ST    @14,@SA00003                                        0580
*/********************************************************************/
*/*                                                                  */
*/*      B L D I N I T S   SUBROUTINE                                */
*/*                                                                  */
*/********************************************************************/
*/*                                                                  */
*/*      THIS SUBROUTINE BUILDS AN INIT-SELF PIU AND TPOSTS IT       */
*/*      TO THE SSCP.                                                */
*/*                                                                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0581
*   PRFPIUO=1;                      /* OFFSET TO START OF PIU        */
         LA    @09,1                                               0581
         STC   @09,PRFPIUO(,RPRF)                                  0581
*   RPIU=ADDR(PRFPIUO)+PRFPIUO;     /* PIU ADDRESS                   */
         LA    RPIU,PRFPIUO(,RPRF)                                 0582
         ALR   RPIU,@09                                            0582
*   CALL THINITS;                   /* BUILD THE TH                  */
         BAL   @14,THINITS                                         0583
*   PIURH=INITSRH;                  /* MOVE IN THE RH                */
         MVC   PIURH(3,RPIU),@CB03121                              0584
*   CALL RUINITS;                   /* BUILD THE RU                  */
         BAL   @14,RUINITS                                         0585
*   CALL TPOSTPIU;                  /* TPOST THE PIU BUFFER TO SSCP  */
         BAL   @14,TPOSTPIU                                        0586
*   END BLDINITS;                   /* RETURN TO CALLER              */
@EL00003 DS    0H                                                  0587
@EF00003 DS    0H                                                  0587
@ER00003 L     @14,@SA00003                                        0587
         BR    @14                                                 0587
         EJECT
*BLDMULTI:                                                         0588
*   PROC OPTIONS(SAVE(R14));                                       0588
*                                                                  0588
BLDMULTI ST    @14,@SA00004                                        0588
*/********************************************************************/
*/*                                                                  */
*/*      B L D M U L T I   SUBROUTINE                                */
*/*                                                                  */
*/********************************************************************/
*/*                                                                  */
*/*      THIS SUBROUTINE BUILDS A SESSION-STARTED, SESSION-ENDED,    */
*/*      OR BIND-FAILED PIU AND TPOSTS IT TO THE SSCP.               */
*/*                                                                  */
*/********************************************************************/
*                                                                  0589
*   PRFPIUO=1;                      /* OFFSET TO START OF PIU        */
         LA    @09,1                                               0589
         STC   @09,PRFPIUO(,RPRF)                                  0589
*   RPIU=ADDR(PRFPIUO)+PRFPIUO;     /* PIU ADDRESS                   */
         LA    RPIU,PRFPIUO(,RPRF)                                 0590
         ALR   RPIU,@09                                            0590
*                                   /* FIELDS COMMON TO ALL PIU TYPES*/
*   TTHBYTE0=NRMFLOTH;              /* NORMAL-FLOW TH                */
         MVI   TTHBYTE0(RPIU),X'1C'                                0591
*   TTHBYTE1=0;                     /*                               */
         MVI   TTHBYTE1(RPIU),X'00'                                0592
*   TTHDAF=SAVTSCPT;                /* SSCP'S TNT INDEX              */
         L     @09,AVTSAVTP(,RAVT)                                 0593
         MVC   TTHDAF(2,RPIU),SAVTSCPT(@09)                        0593
*   TTHOAF=SIBINDEX;                /* PLU'S TNT INDEX               */
         L     @03,SIBPTR                                          0594
         LH    @03,SIBINDEX(,@03)                                  0594
         N     @03,@CF03378                                        0594
         STCM  @03,3,TTHOAF(RPIU)                                  0594
*   TTHTAG=TNTSLU;                  /* SLU'S TNT INDEX               */
         MVC   TTHTAG(2,RPIU),TNTSLU                               0595
*   PIURH=MULTIRH;                  /* MOVE IN RH CONSTANT           */
         MVC   PIURH(3,RPIU),@CB03123                              0596
*   PIURU(1:3)=RPARM;               /* RU REQUEST CODE               */
         STCM  RPARM,7,PIURU(RPIU)                                 0597
*                                   /* GET NETWORK ADDRESSES         */
*   RPARM=SIBINDEX;                 /* PLU'S TNT INDEX               */
         LR    RPARM,@03                                           0598
*   CALL IEDIAP04;                  /* CONVERT IT                    */
         L     @15,SAVTTNTX(,@09)                                  0599
         BALR  @14,@15                                             0599
*   PLUNA=R15;                      /* SAVE PLU'S NETWORK ADDRESS    */
         LR    PLUNA,R15                                           0600
*   RPARM=TNTSLU;                   /* SLU'S TNT INDEX               */
         LH    RPARM,TNTSLU                                        0601
         N     RPARM,@CF03378                                      0601
*   CALL IEDIAP04;                  /* CONVERT IT                    */
         L     @09,AVTSAVTP(,RAVT)                                 0602
         L     @15,SAVTTNTX(,@09)                                  0602
         BALR  @14,@15                                             0602
*   SLUNA=R15;                      /* SAVE SLU'S NETWORK ADDRESS    */
         LR    SLUNA,R15                                           0603
*   IF PIURU(1:3)=CD1XBFL THEN      /* BIND-FAILED PIU?              */
         CLC   PIURU(3,RPIU),@CB00759                              0604
         BNE   @RF00604                                            0604
*     DO;                           /* YES                           */
*       TTHDCF=LENGTH(IEDXBFL)+LENGTH(PIURH);/* TH DATA COUNT FIELD  */
         MVC   TTHDCF(2,RPIU),@CH00174                             0606
*       XBFLSNS=LCBBFSNS;           /* SENSE VALUE FROM BIND RESPONSE*/
         LA    @09,13                                              0607
         ALR   @09,RPIU                                            0607
         MVC   XBFLSNS(4,@09),LCBBFSNS(RLCB)                       0607
*       XBFLRSN=BFLRSN;             /* REASON CODE                   */
         MVI   XBFLRSN(@09),X'20'                                  0608
*       XBFLKEY=BFLKEY;             /* KEY                           */
         MVI   XBFLKEY(@09),X'07'                                  0609
*       XBFLPNA=PLUNA;              /* PLU'S NETWORK ADDRESS         */
         STCM  PLUNA,3,XBFLPNA(@09)                                0610
*       XBFLSNA=SLUNA;              /* SLU'S NETWORK ADDRESS         */
         STCM  SLUNA,3,XBFLSNA(@09)                                0611
*     END;                                                         0612
*   ELSE                            /* SESSN-STARTED OR SESSN-ENDED  */
*     DO;                           /* (BOTH HAVE SAME FORMAT)       */
         B     @RC00604                                            0613
@RF00604 DS    0H                                                  0614
*       TTHDCF=LENGTH(IEDXSST)+LENGTH(PIURH);/* TH DATA COUNT FIELD  */
         MVC   TTHDCF(2,RPIU),@CH03367                             0614
*       XSSTKEY=SSTKEY;             /* KEY                           */
         LA    @09,13                                              0615
         ALR   @09,RPIU                                            0615
         MVI   XSSTKEY(@09),X'07'                                  0615
*       XSSTPNA=PLUNA;              /* PLU'S NETWORK ADDRESS         */
         STCM  PLUNA,3,XSSTPNA(@09)                                0616
*       XSSTSNA=SLUNA;              /* SLU'S NETWORK ADDRESS         */
         STCM  SLUNA,3,XSSTSNA(@09)                                0617
*     END;                                                         0618
*   CALL TPOSTPIU;                  /* TPOST PIU BUFFER TO SSCP      */
@RC00604 BAL   @14,TPOSTPIU                                        0619
*   END BLDMULTI;                   /* RETURN TO CALLER              */
@EL00004 DS    0H                                                  0620
@EF00004 DS    0H                                                  0620
@ER00004 L     @14,@SA00004                                        0620
         BR    @14                                                 0620
         EJECT
*BLDSHUT:                                                          0621
*   PROC OPTIONS(SAVE(R14));                                       0621
*                                                                  0621
BLDSHUT  ST    @14,@SA00005                                        0621
*/********************************************************************/
*/*                                                                  */
*/*      B L D S H U T   SUBROUTINE                                  */
*/*                                                                  */
*/********************************************************************/
*/*                                                                  */
*/*      THIS SUBROUTINE BUILDS A SHUTDOWN PIU AND TPOSTS IT         */
*/*      TO IEDDFOUT TO BE SENT TO THE SLU.                          */
*/*                                                                  */
*/********************************************************************/
*                                                                  0622
*   PRFPIUO=1;                      /* OFFSET TO START OF PIU        */
         LA    @09,1                                               0622
         STC   @09,PRFPIUO(,RPRF)                                  0622
*   RPIU=ADDR(PRFPIUO)+PRFPIUO;     /* START-OF-PIU ADDRESS          */
         LA    RPIU,PRFPIUO(,RPRF)                                 0623
         ALR   RPIU,@09                                            0623
*                                   /* BUILD THE PIU                 */
*   TTHBYTE0=EXPFLOTH;              /* EXPEDITED-FLOW TH             */
         MVI   TTHBYTE0(RPIU),X'1D'                                0624
*   TTHBYTE1=0;                     /*                               */
         MVI   TTHBYTE1(RPIU),X'00'                                0625
*   TTHDAF=TNTSLU;                  /* SLU'S TNT INDEX               */
         MVC   TTHDAF(2,RPIU),TNTSLU                               0626
*   TTHOAF=SIBINDEX;                /* PLU'S TNT INDEX               */
         L     @09,SIBPTR                                          0627
         MVC   TTHOAF(2,RPIU),SIBINDEX(@09)                        0627
*   TTHDCF=LENGTH(PIURH)+1;         /* DATA COUNT                    */
         MVC   TTHDCF(2,RPIU),@CH00255                             0628
*   PIURH=SHUTDRH;                  /* SET UP RH                     */
         MVC   PIURH(3,RPIU),@CB03125                              0629
*   PIURU(1:1)=CD1SHUTD;            /* RU REQUEST CODE               */
         MVI   PIURU(RPIU),X'C0'                                   0630
*   PRF2TNTI=ON;                    /* INDICATE OAF & DAF ARE TNT  0631
*                                      OFFSETS               @YM08039
*                                      TPOST PIU BUFFER TO IEDDFOUT  */
         LR    @09,RPRF                                            0631
         AL    @09,@CF03379                                        0631
         OI    PRF2TNTI(@09),B'10000000'                           0631
*   PRFQCBA=SAVTDFCO;               /* QCB ADDRESS                   */
         L     @09,AVTSAVTP(,RAVT)                                 0632
         MVC   PRFQCBA(3,RPRF),SAVTDFCO+1(@09)                     0632
*   PRFPRI=PRIOUTBD;                /* PRIORITY                      */
         MVI   PRFPRI(RPRF),X'E4'                                  0633
*   RPARM=RPRF;                     /* ELEMENT ADDRESS FOR TPOST     */
         LR    RPARM,RPRF                                          0634
*   CALL DSPPOSTR;                  /* TPOST                         */
         LA    @15,DSPPOSTR(,RDISP)                                0635
         BALR  @14,@15                                             0635
*   END BLDSHUT;                    /* RETURN TO CALLER              */
@EL00005 DS    0H                                                  0636
@EF00005 DS    0H                                                  0636
@ER00005 L     @14,@SA00005                                        0636
         BR    @14                                                 0636
         EJECT
*CHKSEND:                                                          0637
*   PROC OPTIONS(SAVE(R14));                                       0637
*                                                                  0637
CHKSEND  ST    @14,12(,@13)                                        0637
*/********************************************************************/
*/*                                                                  */
*/*      C H K S E N D   SUBROUTINE                                  */
*/*                                                                  */
*/********************************************************************/
*/*                                                                  */
*/*      THIS SUBROUTINE DETERMINES THE ANSWER TO ONE        @YM08450*/
*/*      QUESTION:  "IF THE PLCB IS TPOSTED TO ITSELF,       @YM08450*/
*/*      WILL THE SEND SCHEDULER TRY TO SEND A MESSAGE?".            */
*/*      SENDSW IS SET TO INDICATE THE ANSWER (ON = YES).            */
*/*                                                                  */
*/********************************************************************/
*                                                                  0638
*   NCPTTE=LCBNCPPT-LENGTH(IEDNTRM);/* GET NCP'S TTE ADDRESS         */
         L     @09,LCBNCPPT-1(,RLCB)                               0638
         LA    @09,0(,@09)                                         0638
         SL    @09,@CF02842                                        0638
         ST    @09,NCPTTE                                          0638
*   IF(NCPTTE->TRMNCPCL=ON&NCPTTE->TRMQUCKN=ON)×/* NCP CLOSING?      */
*       (AVTCLOSN=ON&AVTQUCKN=ON)×  /* ... OR TCAM CLOSING DOWN?     */
*       QCBTRMHO=ON THEN            /* ... OR TERMINAL HELD?         */
         TM    TRMNCPCL(@09),B'01001000'                           0639
         BO    @RT00639                                            0639
         TM    AVTCLOSN(RAVT),B'00000110'                          0639
         BO    @RT00639                                            0639
         L     @09,IEDQQPTR                                        0639
         TM    QCBTRMHO(@09),B'01000000'                           0639
         BO    @RT00639                                            0639
*     ;                             /* YES. LEAVE SEND SWITCH OFF    */
*   ELSE                                                           0641
*     IF QCBTSQ=OFF&                /* IS THERE AN INITIATE-MODE     */
*         QCBINSRC^=QCBPTR THEN     /* ... MESSAGE TO BE SENT?       */
         L     @09,IEDQQPTR                                        0641
         TM    QCBTSQ(@09),B'10000000'                             0641
         BNZ   @RF00641                                            0641
         L     @09,QCBINSRC-1(,@09)                                0641
         LA    @09,0(,@09)                                         0641
         C     @09,QCBPTR                                          0641
         BE    @RF00641                                            0641
*       SENDSW=ON;                  /* YES, TURN ON SEND SWITCH      */
         OI    SENDSW,B'00001000'                                  0642
*     ELSE                                                         0643
*       IF QCBHELD=ON THEN          /* REUS IN PROGRESS?             */
         B     @RC00641                                            0643
@RF00641 L     @09,IEDQQPTR                                        0643
         TM    QCBHELD(@09),B'00000001'                            0643
         BO    @RT00643                                            0643
*         ;                         /* YES, LEAVE SEND SWITCH OFF    */
*       ELSE                        /* SEE IF THERE ARE ANY MESSAGES */
*         DO;                       /* ... QUEUED TO BE SENT         */
*           EXITSW=OFF;             /* INITIALIZE FOR                */
         NI    EXITSW,B'11011111'                                  0646
*           RPARM=ADDR(IEDQPQCB);   /* ... LOOP                      */
         LA    RPARM,40                                            0647
         AL    RPARM,IEDQQPTR                                      0647
*           DO UNTIL(EXITSW=ON);    /* LOOP THRU PRIORITY QCBS       */
@DL00648 DS    0H                                                  0649
*             IF RPARM->QCBFFEFO>0 THEN/* ANY MESSAGES TO BE SENT?   */
         ICM   @09,7,QCBFFEFO(RPARM)                               0649
         BZ    @RF00649                                            0649
*               DO;                 /* YES                           */
*                 SENDSW=ON;        /* TURN ON SEND SWITCH           */
*                 EXITSW=ON;        /* PREPARE TO EXIT FROM LOOP     */
         OI    SENDSW,B'00101000'                                  0652
*               END;                                               0653
*             ELSE                                                 0654
*               IF RPARM->QCBPRIPQ=0 THEN/* LAST PRI QCB?            */
         B     @RC00649                                            0654
@RF00649 CLI   QCBPRIPQ(RPARM),0                                   0654
         BNE   @RF00654                                            0654
*                 EXITSW=ON;        /* YES, SET UP TO EXIT FROM LOOP */
         OI    EXITSW,B'00100000'                                  0655
*               ELSE                                               0656
*                 RPARM=RPARM+LENGTH(IEDQPQCB);/* NO, GET NEXT ONE   */
         B     @RC00654                                            0656
@RF00654 AL    RPARM,@CF02302                                      0656
*           END;                                                   0657
@RC00654 DS    0H                                                  0657
@RC00649 DS    0H                                                  0657
@DE00648 TM    EXITSW,B'00100000'                                  0657
         BNO   @DL00648                                            0657
*         END;                                                     0658
*   END CHKSEND;                    /* RETURN TO CALLER              */
@EL00006 DS    0H                                                  0659
@EF00006 DS    0H                                                  0659
@ER00006 L     @14,12(,@13)                                        0659
         BR    @14                                                 0659
         EJECT
*CINITRTN:                                                         0660
*   PROC OPTIONS(SAVE(R14));                                       0660
*                                                                  0660
CINITRTN ST    @14,@SA00007                                        0660
*/********************************************************************/
*/*                                                                  */
*/*      C I N I T R T N   SUBROUTINE                                */
*/*                                                                  */
*/********************************************************************/
*/*                                                                  */
*/*      THIS SUBROUTINE PROCESSES A CINIT PIU RECEIVED FROM THE     */
*/*      SSCP.  THE SUBROUTINE ---                                   */
*/*                                                                  */
*/*         .  OBTAINS A PLCB.                                       */
*/*                                                                  */
*/*         .  (IF THERE IS LOGON DATA) GETS AN EMPTY BUFFER,        */
*/*            AND SAVES THE LOGON DATA.                             */
*/*                                                                  */
*/*         .  TPOSTS THE CINIT PIU'S BUFFER TO IEDSCLU AS A         */
*/*            SIGNAL TO SEND BIND AND SDT PIUS TO THE SLU.          */
*/*                                                                  */
*/*      AS MANY AS 3 SEPARATE ENTRIES TO THIS SUBROUTINE MAY BE     */
*/*      NEEDED TO ACCOMPLISH THESE JOBS.  CALLS MAY OCCUR FROM      */
*/*      PIURTN, PLCBRTN AND ERBRTNX.                                */
*/*                                                                  */
*/********************************************************************/
*                                                                  0661
*   IF QCBPLCBN=OFF THEN            /* DO WE NEED A PLCB?            */
         L     @09,IEDQQPTR                                        0661
         SL    @09,@CF00044                                        0661
         TM    QCBPLCBN(@09),B'10000000'                           0661
         BNZ   @RF00661                                            0661
*     DO;                           /* YES                           */
*       QCBNDXRQ=ON;                /* SPECIAL INDEXED REQUEST       */
         OI    QCBNDXRQ(@09),B'00000100'                           0663
*       CALL RQSTPLCB;              /* REQUEST A PLCB                */
         BAL   @14,RQSTPLCB                                        0664
*     END;                                                         0665
*   IF QCBPLCBN=OFF THEN            /* WAS OUR PLCB REQUEST QUEUED?  */
@RF00661 L     @09,IEDQQPTR                                        0666
         AL    @09,@CF03385                                        0666
         TM    QCBPLCBN-4(@09),B'10000000'                         0666
         BNZ   @RF00666                                            0666
*     DO;                           /* YES, WE'LL GET PLCB LATER     */
*       PRFLINK=SAVTLUSP;           /* INSERT THE CINIT'S BUFFER     */
         L     @09,AVTSAVTP(,RAVT)                                 0668
         MVC   PRFLINK(3,RPRF),SAVTLUSP+1(@09)                     0668
*       SAVTLUSP=RPRF;              /* ... ON TOP OF CHAIN           */
         ST    RPRF,SAVTLUSP(,@09)                                 0669
*     END;                                                         0670
         EJECT
*   ELSE                            /* WE HAVE A PLCB ASSIGNED       */
*     DO;                                                          0671
         B     @RC00666                                            0671
@RF00666 DS    0H                                                  0672
*       QCBNDXRQ=OFF;               /* RESET INDEXED-REQUEST FLAG    */
         L     @09,IEDQQPTR                                        0672
         AL    @09,@CF03385                                        0672
         NI    QCBNDXRQ-4(@09),B'11111011'                         0672
*       LCBBFRSV=0;                 /* CLEAR POINTER SAVE AREA       */
         SLR   @09,@09                                             0673
         STCM  @09,7,LCBBFRSV(RLCB)                                0673
*       IF TRMLUREQ=ON THEN         /* EXTERNAL CINIT?               */
         TM    TRMLUREQ(RTRM),B'00000100'                          0674
         BNO   @RF00674                                            0674
*         DO;                       /* YES                           */
*           IF LCBERBCH=0 THEN      /* DO WE HAVE A BUFFER?          */
         L     @09,LCBERBCH-1(,RLCB)                               0676
         LA    @09,0(,@09)                                         0676
         LTR   @09,@09                                             0676
         BNZ   @RF00676                                            0676
*             DO;                   /* NO                            */
*               CALL FNDLGDTA;      /* LOCATE LOGON DATA (THE USER-
*                                      DATA FIELD) IN THE CINIT PIU  */
         BAL   @14,FNDLGDTA                                        0678
*               IF DATAPTR->VARLNGTH>0 THEN/* IS THERE ANY DATA?     */
         L     @09,DATAPTR                                         0679
         CLI   VARLNGTH(@09),0                                     0679
         BNH   @RF00679                                            0679
*                 DO;               /* YES                           */
*                                   /* CALC NUMBER OF UNITS NEEDED   */
*                   RPARMF=AVTHDRSZ+DATAPTR->VARLNGTH;/* BYTE COUNT  */
         LA    RPARMF,30                                           0681
         SLR   @07,@07                                             0681
         IC    @07,VARLNGTH(,@09)                                  0681
         ALR   RPARMF,@07                                          0681
*                   CALL UNITCNT;   /* CONVERT BYTE COUNT TO UNITS   */
         BAL   @14,UNITCNT                                         0682
*                   LCBRBCT2=R0;    /* UNIT COUNT                    */
         STC   R0,LCBRBCT2(,RLCB)                                  0683
*                   CALL TPOSTERB;  /* REQUEST A BUFFER              */
         BAL   @14,TPOSTERB                                        0684
*                   LCBBFRSV=RPRF;  /* SAVE PIU'S BUFFER ADDRESS FOR
*                                      LATER USE BY ERBRTNX          */
         STCM  RPRF,7,LCBBFRSV(RLCB)                               0685
*                 END;                                             0686
*               IF TRMSESRQ=ON THEN /* INTERNAL INIT IN PROGRESS?    */
@RF00679 TM    TRMSESRQ(RTRM),B'00001000'                          0687
         BNO   @RF00687                                            0687
*                 CALL DEQUEQCB;    /* YES, STOP THE QCB FROM      0688
*                                      GENERATING AN INIT-SELF (IF IT
*                                      HASN'T ALREADY DONE SO)       */
         BAL   @14,DEQUEQCB                                        0688
*             END;                                                 0689
*           ELSE                    /* WE ALREADY HAVE A BUFFER      */
*             DO;                                                  0690
         B     @RC00676                                            0690
@RF00676 DS    0H                                                  0691
*               CALL FNDLGDTA;      /* LOCATE THE LOGON DATA         */
         BAL   @14,FNDLGDTA                                        0691
*               CALL SAVLGDTA;      /* MOVE THE LOGON DATA INTO THE
*                                      BUFFER & SAVE BUFFER ADDRESS  */
         BAL   @14,SAVLGDTA                                        0692
*             END;                                                 0693
*         END;                                                     0694
@RC00676 DS    0H                                                  0695
*       IF LCBBFRSV=0 THEN          /* READY TO BIND?                */
@RF00674 L     @09,LCBBFRSV-1(,RLCB)                               0695
         LA    @09,0(,@09)                                         0695
         LTR   @09,@09                                             0695
         BNZ   @RF00695                                            0695
*         DO;                       /* YES, TPOST CINIT TO IEDSCLU   */
*           PRFQCBA=SAVTSCLU;       /* QCB ADDRESS                   */
         L     @09,AVTSAVTP(,RAVT)                                 0697
         MVC   PRFQCBA(3,RPRF),SAVTSCLU+1(@09)                     0697
*           PRFPRI=PRISCPIN;        /* PRIORITY                      */
         MVI   PRFPRI(RPRF),X'E5'                                  0698
*           RPARM=RPRF;             /* ELEMENT ADDRESSS              */
         LR    RPARM,RPRF                                          0699
*           CALL DSPPOSTR;          /* TPOST THE ELEMENT             */
         LA    @15,DSPPOSTR(,RDISP)                                0700
         BALR  @14,@15                                             0700
*         END;                                                     0701
*     END;                                                         0702
*   END CINITRTN;                   /* RETURN TO CALLER              */
@EL00007 DS    0H                                                  0703
@EF00007 DS    0H                                                  0703
@ER00007 L     @14,@SA00007                                        0703
         BR    @14                                                 0703
         EJECT
*CTERMRTN:                                                         0704
*   PROC OPTIONS(SAVE(R14));                                       0704
*                                                                  0704
CTERMRTN ST    @14,@SA00008                                        0704
*/********************************************************************/
*/*                                                                  */
*/*      C T E R M R T N   SUBROUTINE                                */
*/*                                                                  */
*/********************************************************************/
*/*                                                                  */
*/*      THIS SUBROUTINE PROCESSES A CTERM PIU RECEIVED FROM THE     */
*/*      SSCP.  NOTE THAT THERE ARE TWO TYPES OF TERMINATION @YM08991*/
*/*      WHICH MAY BE REQUESTED --- ORDERLY AND FORCED.      @YM08991*/
*/*                                                          @YM08991*/
*/*      ORDERLY TERMINATION:  IF THE LU IS CURRENTLY        @YM08991*/
*/*      INVOLVED IN ANY MESSAGE TRAFFIC, WE CAN ALLOW THE   @YM08991*/
*/*      CURRENT MESSAGE TO END NORMALLY BEFORE BEGINNING    @YM08991*/
*/*      SESSION TERMINATION.                                @YM08991*/
*/*                                                          @YM08991*/
*/*      FORCED TERMINATION:  WE MUST FORCE THE CLEANING UP  @YM08991*/
*/*      OF ANY IN-PROCESS MESSAGE TRAFFIC IMMEDIATELY       @YM08991*/
*/*      WITHOUT WAITING FOR ANY CURRENT MESSAGE TO END.     @YM08991*/
*/*                                                                  */
*/********************************************************************/
*                                                                  0705
*   IF XCTMTERM=XCTMTRMO THEN       /* ORDERLY TERMINATE?    @YM08991*/
         TM    XCTMTERM+13(RPIU),B'00010000'                       0705
         BNO   @RF00705                                            0705
         TM    XCTMTERM+13(RPIU),B'11100000'                       0705
         BNZ   @RF00705                                            0705
*     DO;                           /* YES                   @YM08991
*                                      FREE CTERM PIU'S BUFFER       */
*       RPARM=RPRF;                 /* BUFFER ADDRESS                */
         LR    RPARM,RPRF                                          0707
*       CALL FREEBUF;               /* FREE THE BUFFER               */
         BAL   @14,FREEBUF                                         0708
*       IF SIBPTR>0&                /* LU-LU SIB ASSIGNED? &         */
*           SIBSSTAT=SIBSACTV THEN  /* ... SESSION STATE = 'ACTIVE'? */
         L     @09,SIBPTR                                          0709
         LTR   @09,@09                                             0709
         BNP   @RF00709                                            0709
         TM    SIBSSTAT(@09),B'00011100'                           0709
         BNO   @RF00709                                            0709
*         DO;                       /* YES, PRIME LOGOFF     @YM09036*/
*           SIBLGOFF=ON;            /* SET LOGOFF BIT        @YM09036*/
         OI    SIBLGOFF(@09),B'10000000'                           0711
*           CALL PRMLGOFF;          /* CALL PRIMING ROUTINE  @YM09036*/
         BAL   @14,PRMLGOFF                                        0712
*         END;                      /* END PRIME PROCESSING  @YM09036*/
*     END;                          /*                       @YM08991*/
*   ELSE                            /* FORCED TERMINATE      @YM08991*/
*     DO;                           /*                       @YM08991*/
         B     @RC00705                                            0715
@RF00705 DS    0H                                                  0716
*       BUSYSW=OFF;                 /* INITIALIZE SWITCH     @YM08991*/
         NI    BUSYSW,B'11101111'                                  0716
*       IF SIBPTR>0 THEN            /* LU-LU SIB ASSIGNED?   @YM08991*/
         L     @09,SIBPTR                                          0717
         LTR   @09,@09                                             0717
         BNP   @RF00717                                            0717
*         DO;                       /* YES                   @YM08991*/
*           SIBFTERM=ON;            /* SET FORCED TERMINATE IN     0719
*                                      PROGRESS              @YM08991*/
         OI    SIBFTERM(@09),B'00100000'                           0719
*           IF SIBSSTAT=SIBSACTV&   /* SESSION ACTIVE? &     @YM08991*/
*               SIBDSTAT=SIBDACTV THEN/* DATA TRAFFIC ACTIVE?      0720
*                                                            @YM08991*/
         TM    SIBSSTAT(@09),B'00011100'                           0720
         BNO   @RF00720                                            0720
         TM    SIBDSTAT(@09),B'00000011'                           0720
         BNO   @RF00720                                            0720
*             DO;                   /* YES                   @YM08991*/
*               SIBLGOFF=ON;        /* SET LOGOFF FLAG       @YM08991*/
         OI    SIBLGOFF(@09),B'10000000'                           0722
*               CALL PRMLGOFF;      /* PRIME LOGOFF PROCESS  @YM08991*/
         BAL   @14,PRMLGOFF                                        0723
*             END;                  /*                       @YM08991*/
*         END;                      /*                       @YM08991*/
@RF00720 DS    0H                                                  0726
*       IF BUSYSW=ON THEN           /* PLCB-BUSY CONDITION FOUND BY
*                                      PRMLGOFF SUBOURTINE   @YM08991*/
@RF00717 TM    BUSYSW,B'00010000'                                  0726
         BNO   @RF00726                                            0726
*         DO;                       /* YES, REQUEST IEDNCU TO CHECK
*                                      STATES & CLEAN UP     @YM08991
*                                      BLD CLEAN-UP ELEMENT  @YM08991*/
*           IEDCUREQ=''B;           /* CLEAR THE BUFFER      @YM08991*/
         XC    IEDCUREQ(44,RPRF),IEDCUREQ(RPRF)                    0728
*           CURQCB=SAVTCLUP;        /* NCU QCB ADDR          @YM08991*/
         L     @09,AVTSAVTP(,RAVT)                                 0729
         MVC   CURQCB(3,RPRF),SAVTCLUP+1(@09)                      0729
*           CURPRI=PRICUREQ;        /* CLEANUP PRIORITY      @YM08991*/
         MVI   CURPRI(RPRF),X'C4'                                  0730
*           CURLINK=PRFINTIC;       /* INCALID TIC           @YM08991*/
         MVC   CURLINK(4,RPRF),@CF02080                            0731
*           CURTERM=ON;             /* SET TERMINATE FLAG    @YM08991*/
         OI    CURTERM(RPRF),B'00000001'                           0732
*           CURTTCIN=TNTSLU;        /* SLU'S TNT INDEX       @YM08991*/
         LH    @09,TNTSLU                                          0733
         N     @09,@CF03378                                        0733
         STH   @09,CURTTCIN(,RPRF)                                 0733
*           CURTRM=ADDR(IEDQTRM);   /* SLU'S TTE ADDR        @YM08991*/
         LA    @09,IEDQTRM(,RTRM)                                  0734
         ST    @09,CURTRM(,RPRF)                                   0734
*           RPARM=RPRF;             /* TPOST THE REQUEST     @YM08991*/
         LR    RPARM,RPRF                                          0735
*           CALL DSPPOSTR;          /* ELEMENT TO IEDNCU     @YM08991*/
         LA    @15,DSPPOSTR(,RDISP)                                0736
         BALR  @14,@15                                             0736
*         END;                      /*                       @YM08991*/
*       ELSE                        /*                       @YM08991*/
*         DO;                       /*                       @YM08991*/
         B     @RC00726                                            0738
@RF00726 DS    0H                                                  0739
*           RPARM=RPRF;             /* FREE THE CTERM'S      @YM08991*/
         LR    RPARM,RPRF                                          0739
*           CALL FREEBUF;           /* ... BUFFER            @YM08991*/
         BAL   @14,FREEBUF                                         0740
*         END;                      /*                       @YM08991*/
*     END;                          /*                       @YM08991*/
*   END CTERMRTN;                   /* RETURN TO CALLER              */
@EL00008 DS    0H                                                  0743
@EF00008 DS    0H                                                  0743
@ER00008 L     @14,@SA00008                                        0743
         BR    @14                                                 0743
         EJECT
*CTLBLKS:                                                          0744
*   PROC OPTIONS(SAVE(R14));                                       0744
*                                                                  0744
CTLBLKS  ST    @14,@SA00009                                        0744
*/********************************************************************/
*/*                                                                  */
*/*      C T L B L K S   SUBROUTINE                                  */
*/*                                                                  */
*/********************************************************************/
*/*                                                                  */
*/*      THIS SUBROUTINE INITIALIZES CONTROL BLOCK POINTERS FOR      */
*/*      THE SLU WHOSE TNT INDEX IS IN TNTSLU.                       */
*/*                                                                  */
*/********************************************************************/
*                                                                  0745
*                                   /* GET TERMINAL ENTRY ADDRESS    */
*   RPARM=TNTSLU;                   /* TNT INDEX                     */
         LH    RPARM,TNTSLU                                        0745
         N     RPARM,@CF03378                                      0745
*   CALL IEDQTNT;                   /* CONVERT TNT INDEX TO A        */
         L     @15,AVTRNMPT(,RAVT)                                 0746
         BALR  @14,@15                                             0746
*   RTRM=RPARM;                     /* ... TERMINAL ENTRY ADDRESS    */
         LR    RTRM,RPARM                                          0747
*   RTRM=RTRM-LENGTH(IEDNTRM);      /* BACK UP TO TERM ENTRY PREFIX  */
         SL    RTRM,@CF02842                                       0748
*                                   /* SET UP SIB POINTER            */
*   IF TRMSIBPT>0&                  /* DO WE HAVE AN LU-LU SIB?      */
*       TRMSIBPT->SIBINDEX^=SAVTSCPT THEN                          0749
         SLR   @09,@09                                             0749
         ICM   @09,7,TRMSIBPT(RTRM)                                0749
         LTR   @09,@09                                             0749
         BNP   @RF00749                                            0749
         L     @07,AVTSAVTP(,RAVT)                                 0749
         CLC   SIBINDEX(2,@09),SAVTSCPT(@07)                       0749
         BE    @RF00749                                            0749
*     SIBPTR=TRMSIBPT;              /* YES, GET ITS ADDRESS          */
         ST    @09,SIBPTR                                          0750
*   ELSE                                                           0751
*     SIBPTR=0;                     /* NO, CLEAR SIB POINTER         */
         B     @RC00749                                            0751
@RF00749 SLR   @09,@09                                             0751
         ST    @09,SIBPTR                                          0751
*   QCBPTR=TRMDESTQ;                /* GET DESTINATION QCB ADDRESS   */
@RC00749 SLR   @09,@09                                             0752
         ICM   @09,7,TRMDESTQ(RTRM)                                0752
         ST    @09,QCBPTR                                          0752
*   IF QCBPLCBN=ON THEN             /* IS PLCB ASSIGNED?             */
         L     @09,IEDQQPTR                                        0753
         SL    @09,@CF00044                                        0753
         TM    QCBPLCBN(@09),B'10000000'                           0753
         BNO   @RF00753                                            0753
*     RLCB=QCBPLCBA;                /* YES, GET ITS ADDRESS          */
         L     RLCB,QCBPLCBA-1(,@09)                               0754
         LA    RLCB,0(,RLCB)                                       0754
*   END CTLBLKS;                    /* RETURN TO CALLER              */
@EL00009 DS    0H                                                  0755
@EF00009 DS    0H                                                  0755
@ER00009 L     @14,@SA00009                                        0755
         BR    @14                                                 0755
         EJECT
*DACTLOOP:                                                         0756
*   PROC OPTIONS(SAVE(R14));                                       0756
*                                                                  0756
DACTLOOP ST    @14,@SA00010                                        0756
*/********************************************************************/
*/*                                                                  */
*/*      D A C T L O O P   SUBROUTINE                                */
*/*                                                                  */
*/********************************************************************/
*/*                                                                  */
*/*      THIS SUBROUTINE SEARCHES THE CHAIN OF DEACTIVATE REQUEST    */
*/*      ELEMENTS.  ALL SUCH ELEMENTS FOR A GIVEN SLU ARE REMOVED    */
*/*      AND TPOSTED BACK TO THEIR ORIGINATORS.                      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0757
*   PREVIOUS=ADDR(SAVTLUSR)-LINKOFFS;/* INITIALIZE POINTERS          */
         L     @09,AVTSAVTP(,RAVT)                                 0757
         LA    @07,SAVTLUSR(,@09)                                  0757
         SLR   @05,@05                                             0757
         IC    @05,LINKOFFS                                        0757
         SLR   @07,@05                                             0757
         ST    @07,PREVIOUS                                        0757
*   CURRENT=SAVTLUSR;               /* ... FOR SEARCH                */
         L     @09,SAVTLUSR(,@09)                                  0758
         ST    @09,CURRENT                                         0758
*   DO WHILE(CURRENT>0);                                           0759
         B     @DE00759                                            0759
@DL00759 DS    0H                                                  0760
*     IF CURRENT->REQLTNT=TNTSLU THEN/* ELEMENT FOR THIS SLU?        */
         L     @09,CURRENT                                         0760
         CLC   REQLTNT(2,@09),TNTSLU                               0760
         BNE   @RF00760                                            0760
*       DO;                         /* YES                           */
*         DACTPTR=CURRENT;          /* SAVE ELEMENT ADDRESS          */
         ST    @09,DACTPTR                                         0762
*         PREVIOUS->REQLINK=CURRENT->REQLINK;/* DELINK THE ELEMENT   */
         L     @07,PREVIOUS                                        0763
         MVC   REQLINK(3,@07),REQLINK(@09)                         0763
*         CALL DACTPOST;            /* RETURN ELEMENT TO REQUESTOR   */
         BAL   @14,DACTPOST                                        0764
*       END;                                                       0765
*     ELSE                          /* NOT ELEMENT FOR THIS SLU      */
*       PREVIOUS=CURRENT;           /* BUMP TO NEXT ELEMENT          */
         B     @RC00760                                            0766
@RF00760 L     @09,CURRENT                                         0766
         ST    @09,PREVIOUS                                        0766
*     CURRENT=PREVIOUS->REQLINK;    /* BUMP TO NEXT ELEMENT          */
@RC00760 L     @09,PREVIOUS                                        0767
         L     @09,REQLINK-1(,@09)                                 0767
         LA    @09,0(,@09)                                         0767
         ST    @09,CURRENT                                         0767
*   END;                                                           0768
@DE00759 L     @09,CURRENT                                         0768
         LTR   @09,@09                                             0768
         BP    @DL00759                                            0768
*   END DACTLOOP;                   /* RETURN TO CALLER              */
@EL00010 DS    0H                                                  0769
@EF00010 DS    0H                                                  0769
@ER00010 L     @14,@SA00010                                        0769
         BR    @14                                                 0769
         EJECT
*DACTPOST:                                                         0770
*   PROC OPTIONS(SAVE(R14));                                       0770
*                                                                  0770
DACTPOST ST    @14,@SA00011                                        0770
*/********************************************************************/
*/*                                                                  */
*/*      D A C T P O S T   SUBROUTINE                                */
*/*                                                                  */
*/********************************************************************/
*/*                                                                  */
*/*      THIS SUBROUTINE TPOSTS A DEACTIVATE REQUEST ELEMENT         */
*/*      BACK TO ITS ORIGINATOR.                                     */
*/*                                                                  */
*/********************************************************************/
*                                                                  0771
*                                   /* SET UP THE REQUEST ELEMENT    */
*   REQQCBA=REQRQCBA;               /* RETURN QCB ADDRESS            */
         L     @09,DACTPTR                                         0771
         MVC   REQQCBA(3,@09),REQRQCBA(@09)                        0771
*   REQPRI=REQRPRI;                 /* RETURN PRIORITY               */
         MVC   REQPRI(1,@09),REQRPRI(@09)                          0772
*   REQRCDS=0;                      /* SET GOOD RETURN CODE          */
         SLR   @07,@07                                             0773
         STH   @07,REQRCDS(,@09)                                   0773
*   RPARM=DACTPTR;                  /* ELEMENT ADDRESS FOR TPOST     */
         LR    RPARM,@09                                           0774
*   CALL DSPPOSTR;                  /* TPOST THE ELEMENT             */
         LA    @15,DSPPOSTR(,RDISP)                                0775
         BALR  @14,@15                                             0775
*   END DACTPOST;                   /* RETURN TO CALLER              */
@EL00011 DS    0H                                                  0776
@EF00011 DS    0H                                                  0776
@ER00011 L     @14,@SA00011                                        0776
         BR    @14                                                 0776
         EJECT
*DACTRTN:                                                          0777
*   PROC OPTIONS(SAVE(R14));                                       0777
*                                                                  0777
DACTRTN  ST    @14,@SA00012                                        0777
*/********************************************************************/
*/*                                                                  */
*/*      D A C T R T N   SUBROUTINE                                  */
*/*                                                                  */
*/********************************************************************/
*/*                                                                  */
*/*      THIS SUBROUTINE PROCESSES DEACTIVATE REQUEST ELEMENTS.      */
*/*      SOME SET-UP COMMON TO BOTH TYPES OF REQUESTS IS DONE.       */
*/*      THE SPECIFIC REQUEST TYPE IS THEN IDENTIFIED, AND THE       */
*/*      PROPER SUBROUTINE IS CALLED TO PROCESS IT.                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0778
*   DACTPTR=RPARM;                  /* SAVE ELEMENT ADDRESS          */
         ST    RPARM,DACTPTR                                       0778
*   TNTSLU=REQLTNT;                 /* TNT INDEX FOR SLU             */
         L     @09,DACTPTR                                         0779
         LH    @09,REQLTNT(,@09)                                   0779
         N     @09,@CF03378                                        0779
         STH   @09,TNTSLU                                          0779
*   CALL CTLBLKS;                   /* SET UP CONTROL BLOCK POINTERS */
         BAL   @14,CTLBLKS                                         0780
*   IF REQTYPE=REQLSHTD THEN        /* DETERMINE REQUEST TYPE        */
         L     @09,DACTPTR                                         0781
         CLI   REQTYPE(@09),X'02'                                  0781
         BNE   @RF00781                                            0781
*     CALL DACTSHTD;                /* SHUTDOWN REQUEST              */
         BAL   @14,DACTSHTD                                        0782
*   ELSE                                                           0783
*     CALL DACTSESS;                /* END-SESSION REQUEST           */
         B     @RC00781                                            0783
@RF00781 BAL   @14,DACTSESS                                        0783
*   END DACTRTN;                    /* RETURN TO CALLER              */
@EL00012 DS    0H                                                  0784
@EF00012 DS    0H                                                  0784
@ER00012 L     @14,@SA00012                                        0784
         BR    @14                                                 0784
         EJECT
*DACTSESS:                                                         0785
*   PROC OPTIONS(SAVE(R14));                                       0785
*                                                                  0785
DACTSESS ST    @14,@SA00013                                        0785
*/********************************************************************/
*/*                                                                  */
*/*      D A C T S E S S   SUBROUTINE                                */
*/*                                                                  */
*/********************************************************************/
*/*                                                                  */
*/*      THIS SUBROUTINE HANDLES DEACTIVATE END-SESSION REQUESTS.    */
*/*                                                                  */
*/*      .  IF THE SESSION IS CURRENTLY ACTIVE, THE REQUEST          */
*/*         ELEMENT IS ENQUEUED, AND LOGOFF PROCESSING IS STARTED.   */
*/*                                                                  */
*/*      .  IF SESSION INITIATION IS STILL IN PROGRESS, THE REQUEST  */
*/*         ELEMENT IS SIMPLY ENQUEUED.  LOGOFF PROCESSING WILL BE   */
*/*         STARTED LATER WHEN THE SESSION FINALLY BECOMES ACTIVE.   */
*/*                                                                  */
*/*      .  IF TCAM-TASK SESSION-TERMINATION PROCESSING IS IN        */
*/*         PROGRESS, THE ELEMENT IS ENQUEUED.  IT WILL BE RETURNED  */
*/*         WHEN TCAM-TASK PROCESSING IS FINISHED.                   */
*/*                                                                  */
*/*      .  IF ALL TCAM-TASK SESSION-TERMINATION PROCESSING HAS      */
*/*         ENDED, THE ELEMENT IS RETURNED IMMEDIATELY.              */
*/*                                                                  */
*/********************************************************************/
*                                                                  0786
*   IF SIBPTR>0 THEN                /* DO WE HAVE AN LU-LU SIB?      */
         L     @09,SIBPTR                                          0786
         LTR   @09,@09                                             0786
         BNP   @RF00786                                            0786
*     DO;                           /* YES                           */
*       IF SIBSSTAT=SIBSFINL THEN   /* SESSION STATE = 'FINAL'?      */
         TM    SIBSSTAT(@09),B'00010000'                           0788
         BNO   @RF00788                                            0788
         TM    SIBSSTAT(@09),B'00001100'                           0788
         BNZ   @RF00788                                            0788
*         CALL DACTPOST;            /* YES, RETURN ELEMENT TO REQST'R*/
         BAL   @14,DACTPOST                                        0789
*       ELSE                        /* NO, TCAM STILL PROCESSING     */
*         DO;                       /* KEEP TIL SESSION STATE='FINAL'*/
         B     @RC00788                                            0790
@RF00788 DS    0H                                                  0791
*           SIBRQEND=ON;            /* MARK REQUEST ENQUEUED         */
         L     @09,SIBPTR                                          0791
         OI    SIBRQEND(@09),B'01000000'                           0791
*           REQLINK=SAVTLUSR;       /* INSERT REQUEST ELEMENT .      */
         L     @07,DACTPTR                                         0792
         L     @05,AVTSAVTP(,RAVT)                                 0792
         MVC   REQLINK(3,@07),SAVTLUSR+1(@05)                      0792
*           SAVTLUSR=DACTPTR;       /* ... AT TOP OF CHAIN           */
         ST    @07,SAVTLUSR(,@05)                                  0793
*           IF SIBSSTAT=SIBSACTV THEN/* SESSION STATE = 'ACTIVE'?    */
         TM    SIBSSTAT(@09),B'00011100'                           0794
         BNO   @RF00794                                            0794
*             DO;                   /* YES, PRIME LOGOFF     @YM09036*/
*               SIBLGOFF=ON;        /* SET LOGOFF BIT        @YM09036*/
         OI    SIBLGOFF(@09),B'10000000'                           0796
*               CALL PRMLGOFF;      /* CALL PRIMING ROUTINE  @YM09036*/
         BAL   @14,PRMLGOFF                                        0797
*             END;                  /* END PRIME PROCESSING  @YM09036*/
*         END;                                                     0799
*     END;                                                         0800
*   ELSE                            /* NO SIB ASSIGNED               */
*     DO;                                                          0801
         B     @RC00786                                            0801
@RF00786 DS    0H                                                  0802
*       IF TRMINERR=OFF THEN        /* TCAM ERROR PROCESSING ENDED?  */
         TM    TRMINERR(RTRM),B'00000010'                          0802
         BNZ   @RF00802                                            0802
*         CALL DACTPOST;            /* YES, RETURN ELEMENT TO REQST'R*/
         BAL   @14,DACTPOST                                        0803
*       ELSE                        /* NO, TCAM IS STILL PROCESSING  */
*         DO;                       /* KEEP ELEMENT UNTIL DONE       */
         B     @RC00802                                            0804
@RF00802 DS    0H                                                  0805
*           REQLINK=SAVTLUSR;       /* INSERT REQUEST ELEMENT        */
         L     @09,DACTPTR                                         0805
         L     @07,AVTSAVTP(,RAVT)                                 0805
         MVC   REQLINK(3,@09),SAVTLUSR+1(@07)                      0805
*           SAVTLUSR=DACTPTR;       /* ... AT TOP OF CHAIN           */
         ST    @09,SAVTLUSR(,@07)                                  0806
*         END;                                                     0807
*     END;                                                         0808
*   END DACTSESS;                   /* RETURN TO CALLER              */
@EL00013 DS    0H                                                  0809
@EF00013 DS    0H                                                  0809
@ER00013 L     @14,@SA00013                                        0809
         BR    @14                                                 0809
         EJECT
*DACTSHTD:                                                         0810
*   PROC OPTIONS(SAVE(R14));                                       0810
*                                                                  0810
DACTSHTD ST    @14,@SA00014                                        0810
*/********************************************************************/
*/*                                                                  */
*/*      D A C T S H T D   SUBROUTINE                                */
*/*                                                                  */
*/********************************************************************/
*/*                                                                  */
*/*      THIS SUBROUTINE PROCESSES SHUTDOWN REQUEST ELEMENTS FROM    */
*/*      DEACTIVATE.  IN THE 'NORMAL' CASE (WHEN THE REQUEST ELEMENT */
*/*      IS RECEIVED WHILE THE SESSION IS ACTIVE) THE SUBROUTINE     */
*/*      IS ENTERED TWICE.                                           */
*/*                                                                  */
*/*      1ST ENTRY (CALLED FROM DACTRTN):                            */
*/*         .  REQUESTS A BUFFER.                                    */
*/*                                                                  */
*/*      2ND ENTRY (CALLED FROM ERBRTNI):                            */
*/*         .  BUILDS A SHUTDOWN PIU IN THE BUFFER, AND TPOSTS IT    */
*/*            TO BE SENT TO THE SLU.                                */
*/*         .  ENQUEUES THE REQUEST ELEMENT TO BE RETURNED TO        */
*/*            ITS ORIGINATOR AFTER THE SHUTDOWN AND LOGOFF          */
*/*            PROCESSING IS COMPLETE.                               */
*/*                                                                  */
*/*      A SPECIAL CASE OF 'NORMAL' PROCESSING OCCURS IF THE @YM09036*/
*/*      THE FM PROFILE OF THE SESSION IS ONE WHICH DOES NOT @YM09036*/
*/*      ALLOW THE SENDING OF SHUTDOWN.  IN THIS CASE, THE   @YM09036*/
*/*      SHUTDOWN PIU IS NOT BUILT OR SENT, THE RECEIPT OF   @YM09036*/
*/*      SHUTDOWN COMPLETE IS SIMULATED BY SETTING ITS SIB   @YM09036*/
*/*      INDICATOR, AND IF NECESSARY PRIMING IS DONE TO      @YM09036*/
*/*      CAUSE NORMAL SHUTDOWN COMPLETE PROCESSING TO OCCUR. @YM09036*/
*/*                                                                  */
*/*      'ABNORMAL' PROCESSING OCCURS IF THE REQUEST ELEMENT         */
*/*      ARRIVES WHEN SESSION INITIATION, TERMINATION OR ERROR       */
*/*      PROCESSING IS IN PROGRESS, OR AFTER THE SESSION HAS         */
*/*      ENDED.                                                      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0811
*                                   /* TEST FOR 'NORMAL' PROCESSING  */
*   IF SIBPTR>0&                    /* LU-LU SIB ASSIGNED? &         */
*       SIBDSTAT=SIBDACTV&          /* ... DATA TRAFFIC STAT       0811
*                                      'ACTIVE'?             @ZM46786*/
*       SIBLGOFF=OFF THEN           /* ... NO LOGOFF IN PROGRESS?    */
         L     @09,SIBPTR                                          0811
         LTR   @09,@09                                             0811
         BNP   @RF00811                                            0811
         TM    SIBDSTAT(@09),B'00000011'                           0811
         BNO   @RF00811                                            0811
         TM    SIBLGOFF(@09),B'10000000'                           0811
         BNZ   @RF00811                                            0811
*     DO;                           /* YES                           */
*       IF SIBFMPRO=3×SIBFMPRO=4 THEN/* IF FM PROFILE OF LU  @YM09036*/
         CLI   SIBFMPRO(@09),3                                     0813
         BE    @RT00813                                            0813
         CLI   SIBFMPRO(@09),4                                     0813
         BNE   @RF00813                                            0813
@RT00813 DS    0H                                                  0814
*         DO;                       /* ... CAN HANDLE DFC PROTOCOLS
*                                      FOR SHUTDOWN/SHTDN-CMPLT... 0814
*                                                            @YM09036*/
*           IF BUFPTR=0 THEN        /* DO WE NEED A BUFFER?          */
         L     @09,BUFPTR                                          0815
         LTR   @09,@09                                             0815
         BNZ   @RF00815                                            0815
*             DO;                   /* YES, REQUEST ONE              */
*               R0=1;               /* NUMBER OF UNITS NEEDED        */
         LA    R0,1                                                0817
*               RPARM=DACTPTR;      /* ADDR OF ELEMENT NEEDING BUFFER*/
         L     RPARM,DACTPTR                                       0818
*               CALL GETBUFI;       /* REQUEST A BUFFER              */
         BAL   @14,GETBUFI                                         0819
*             END;                                                 0820
*           ELSE                    /* WE ALREADY HAVE A BUFFER      */
*             DO;                   /* SEND SHUTDOWN PIU TO SLU      */
         B     @RC00815                                            0821
@RF00815 DS    0H                                                  0822
*               RPRF=BUFPTR;        /* GET BUFFER ADDRESS            */
         L     RPRF,BUFPTR                                         0822
*               BUFPTR=0;           /* CLEAR LOCAL BUFFER POINTER    */
         SLR   @09,@09                                             0823
         ST    @09,BUFPTR                                          0823
*               CALL BLDSHUT;       /* BUILD & TPOST SHUTDOWN PIU    */
         BAL   @14,BLDSHUT                                         0824
*               SIBRQSHT=ON;        /* MARK ELEMENT ENQUEUED         */
         L     @09,SIBPTR                                          0825
         OI    SIBRQSHT(@09),B'10000000'                           0825
*               REQLINK=SAVTLUSR;   /* INSERT REQUEST ELEMENT        */
         L     @09,DACTPTR                                         0826
         L     @07,AVTSAVTP(,RAVT)                                 0826
         MVC   REQLINK(3,@09),SAVTLUSR+1(@07)                      0826
*               SAVTLUSR=DACTPTR;   /* ... AT TOP OF CHAIN           */
         ST    @09,SAVTLUSR(,@07)                                  0827
*             END;                                                 0828
*         END;                      /* END SEND SHUTDOWN PIU @YM09036*/
*       ELSE                        /* LU DOES CAN'T HANDLE  @YM09036*/
*         DO;                       /* .. SHUTDOWN, SIMULATE @YM09036*/
         B     @RC00813                                            0830
@RF00813 DS    0H                                                  0831
*           SIBRQSHT=ON;            /* MARK ELEMENT ENQUEUED @YM09036*/
         L     @09,SIBPTR                                          0831
         OI    SIBRQSHT(@09),B'10000000'                           0831
*           REQLINK=SAVTLUSR;       /* INSERT REQUEST ELEMNT @YM09036*/
         L     @07,DACTPTR                                         0832
         L     @05,AVTSAVTP(,RAVT)                                 0832
         MVC   REQLINK(3,@07),SAVTLUSR+1(@05)                      0832
*           SAVTLUSR=DACTPTR;       /* ... AT TOP OF CHAIN   @YM09036*/
         ST    @07,SAVTLUSR(,@05)                                  0833
*           SIBSHUTC=ON;            /* INDICATE SHUTDN CMPLT @YM09036*/
         OI    SIBSHUTC(@09),B'01000000'                           0834
*           CALL PRMLGOFF;          /* PRIME SCHEDULERS      @YM09036*/
         BAL   @14,PRMLGOFF                                        0835
*         END;                      /* END SIMULAT SHUTC RCV @YM09036*/
*     END;                                                         0837
         EJECT
*   ELSE                            /* DO 'ABNORMAL' PROCESSING      */
*     DO;                           /* ... OF THIS REQUEST ELEMENT   */
         B     @RC00811                                            0838
@RF00811 DS    0H                                                  0839
*       IF BUFPTR>0 THEN            /* DO WE HAVE A BUFFER?          */
         L     @09,BUFPTR                                          0839
         SLR   @07,@07                                             0839
         CR    @09,@07                                             0839
         BNH   @RF00839                                            0839
*         DO;                       /* YES, FREE IT (SITUATION HAS 0840
*                                      CHANGED SINCE WE REQUESTED IT)*/
*           RPRF=BUFPTR;            /* GET BUFFER ADDRESS            */
         LR    RPRF,@09                                            0841
*           BUFPTR=0;               /* CLEAR LOCAL BUFFER POINTER    */
         ST    @07,BUFPTR                                          0842
*           CALL FREEBUF;           /* FREE THE BUFFER               */
         BAL   @14,FREEBUF                                         0843
*         END;                                                     0844
*       IF SIBPTR>0 THEN            /* LU-LU SIB ASSIGNED?           */
@RF00839 L     @09,SIBPTR                                          0845
         LTR   @09,@09                                             0845
         BNP   @RF00845                                            0845
*         DO;                       /* YES, CHECK SESSION STATE      */
*           IF SIBSSTAT=SIBSFINL THEN/* SESSION STATE = 'FINAL'?     */
         TM    SIBSSTAT(@09),B'00010000'                           0847
         BNO   @RF00847                                            0847
         TM    SIBSSTAT(@09),B'00001100'                           0847
         BNZ   @RF00847                                            0847
*             CALL DACTPOST;        /* YES, RETURN ELEMENT TO REQST'R*/
         BAL   @14,DACTPOST                                        0848
*           ELSE                    /* NO, TCAM IS STILL PROCESSING  */
*             DO;                   /* KEEP ELEMENT TIL SESSION ENDS */
         B     @RC00847                                            0849
@RF00847 DS    0H                                                  0850
*               SIBRQSHT=ON;        /* MARK ELEMENT ENQUEUED         */
         L     @09,SIBPTR                                          0850
         OI    SIBRQSHT(@09),B'10000000'                           0850
*               REQLINK=SAVTLUSR;   /* ADD REQUEST ELEMENT           */
         L     @09,DACTPTR                                         0851
         L     @07,AVTSAVTP(,RAVT)                                 0851
         MVC   REQLINK(3,@09),SAVTLUSR+1(@07)                      0851
*               SAVTLUSR=DACTPTR;   /* ... TO TOP OF CHAIN           */
         ST    @09,SAVTLUSR(,@07)                                  0852
*             END;                                                 0853
*         END;                                                     0854
*       ELSE                        /* NO LU-LU SIB IS ASSIGNED      */
*         DO;                                                      0855
         B     @RC00845                                            0855
@RF00845 DS    0H                                                  0856
*           IF TRMINERR=OFF THEN    /* TCAM ERROR PROCESSING ENDED?  */
         TM    TRMINERR(RTRM),B'00000010'                          0856
         BNZ   @RF00856                                            0856
*             CALL DACTPOST;        /* YES, RETURN ELEMENT TO REQST'R*/
         BAL   @14,DACTPOST                                        0857
*           ELSE                    /* NO, TCAM IS STILL PROCESSING  */
*             DO;                   /* KEEP ELEMENT UNTIL DONE       */
         B     @RC00856                                            0858
@RF00856 DS    0H                                                  0859
*               REQLINK=SAVTLUSR;   /* INSERT REQUEST ELEMENT        */
         L     @09,DACTPTR                                         0859
         L     @07,AVTSAVTP(,RAVT)                                 0859
         MVC   REQLINK(3,@09),SAVTLUSR+1(@07)                      0859
*               SAVTLUSR=DACTPTR;   /* ... AT TOP OF CHAIN           */
         ST    @09,SAVTLUSR(,@07)                                  0860
*             END;                                                 0861
*         END;                                                     0862
*     END;                                                         0863
*   END DACTSHTD;                   /* RETURN TO CALLER              */
@EL00014 DS    0H                                                  0864
@EF00014 DS    0H                                                  0864
@ER00014 L     @14,@SA00014                                        0864
         BR    @14                                                 0864
         EJECT
*DEQUEQCB:                                                         0865
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0865
DEQUEQCB DS    0H                                                  0866
*   RFY                                                            0866
*     R14 RSTD;                                                    0866
*                                                                  0866
*/********************************************************************/
*/*                                                                  */
*/*      D E Q U E Q C B   SUBROUTINE                                */
*/*                                                                  */
*/********************************************************************/
*/*                                                                  */
*/*      THIS SUBROUTINE SEARCHES THE WAITING-FOR-BUFFER CHAIN       */
*/*      (SAVTLUSB) TO SEE IF THE DESTINATION QCB FOR THE CURRENT    */
*/*      SLU IS THERE.  IF THE QCB IS FOUND IT IS DEQUEUED.          */
*/*                                                                  */
*/*      THIS FUNCTION PREVENTS TIMING PROBLEMS WHEN A CINIT FOR     */
*/*      AN EXTERNALLY-REQUESTED SESSION COMES IN WHILE TCAM IS      */
*/*      PREPARING TO REQUEST A SESSION WITH THE SAME SLU.           */
*/*                                                                  */
*/********************************************************************/
*                                                                  0867
*   PREVIOUS=ADDR(SAVTLUSB)-LINKOFFS;/* INITIALIZE FOR               */
         L     @15,AVTSAVTP(,RAVT)                                 0867
         LA    @09,SAVTLUSB(,@15)                                  0867
         SLR   @07,@07                                             0867
         IC    @07,LINKOFFS                                        0867
         SLR   @09,@07                                             0867
         ST    @09,PREVIOUS                                        0867
*   CURRENT=SAVTLUSB;               /* ... SEARCH                    */
         L     @15,SAVTLUSB(,@15)                                  0868
         ST    @15,CURRENT                                         0868
*   FOUNDSW=OFF;                    /* ... LOOP                      */
         NI    FOUNDSW,B'10111111'                                 0869
*   DO WHILE(FOUNDSW=OFF&CURRENT>0);                               0870
         B     @DE00870                                            0870
@DL00870 DS    0H                                                  0871
*     IF CURRENT=QCBPTR THEN        /* IS THIS THE QCB?              */
         L     @15,CURRENT                                         0871
         C     @15,QCBPTR                                          0871
         BNE   @RF00871                                            0871
*       DO;                         /* YES, DELINK IT & EXIT LOOP    */
*         PREVIOUS->QCBLINK=CURRENT->QCBLINK;                      0873
         L     @09,PREVIOUS                                        0873
         MVC   QCBLINK(3,@09),QCBLINK(@15)                         0873
*         FOUNDSW=ON;                                              0874
         OI    FOUNDSW,B'01000000'                                 0874
*       END;                                                       0875
*     ELSE                                                         0876
*       DO;                         /* NO, BUMP TO NEXT ELEMENT      */
         B     @RC00871                                            0876
@RF00871 DS    0H                                                  0877
*         PREVIOUS=CURRENT;                                        0877
         L     @15,CURRENT                                         0877
         ST    @15,PREVIOUS                                        0877
*         CURRENT=PREVIOUS->QCBLINK;                               0878
         L     @15,QCBLINK-1(,@15)                                 0878
         LA    @15,0(,@15)                                         0878
         ST    @15,CURRENT                                         0878
*       END;                                                       0879
*   END;                                                           0880
@RC00871 DS    0H                                                  0880
@DE00870 TM    FOUNDSW,B'01000000'                                 0880
         BNZ   @DC00870                                            0880
         L     @15,CURRENT                                         0880
         LTR   @15,@15                                             0880
         BP    @DL00870                                            0880
@DC00870 DS    0H                                                  0881
*   END DEQUEQCB;                   /* RETURN TO CALLER              */
@EL00015 DS    0H                                                  0881
@EF00015 DS    0H                                                  0881
@ER00015 BR    @14                                                 0881
*   RFY                                                            0882
*     R14 UNRSTD;                                                  0882
         EJECT
*DFRDTERM:                                                         0883
*   PROC OPTIONS(SAVE(R14));                                       0883
*                                                                  0883
DFRDTERM ST    @14,@SA00016                                        0883
*/********************************************************************/
*/*                                                                  */
*/*      D F R D T E R M   SUBROUTINE                                */
*/*                                                                  */
*/********************************************************************/
*/*                                                                  */
*/*      THIS SUBROUTINE DOES DEFERRED PROCESSING OF SESSION-        */
*/*      TERMINATION REQUESTS THAT CAME IN WHILE SESSION-            */
*/*      INITIATION WAS STILL IN PROGRESS.                           */
*/*                                                                  */
*/********************************************************************/
*                                                                  0884
*   IF SIBRQEND=ON×                 /* SHOULD SESSION BE ENDED?      */
*       SIBTERM=ON THEN                                            0884
         L     @09,SIBPTR                                          0884
         TM    SIBRQEND(@09),B'01000000'                           0884
         BO    @RT00884                                            0884
         TM    SIBTERM(@09),B'01000000'                            0884
         BNO   @RF00884                                            0884
@RT00884 DS    0H                                                  0885
*     SIBLGOFF=ON;                  /* YES, SET LOGOFF BIT           */
         L     @09,SIBPTR                                          0885
         OI    SIBLGOFF(@09),B'10000000'                           0885
*   ELSE                                                           0886
*     IF SIBRQSHT=ON THEN           /* SHOULD SESSION BE SHUT DOWN?  */
         B     @RC00884                                            0886
@RF00884 L     @09,SIBPTR                                          0886
         TM    SIBRQSHT(@09),B'10000000'                           0886
         BNO   @RF00886                                            0886
*       DO;                         /* YES, FIND & RE-PROCESS THE  0887
*                                      SHUTDOWN REQUEST FOR THIS SLU */
*         PREVIOUS=ADDR(SAVTLUSR)-LINKOFFS;/* INITIALIZE FOR         */
         L     @09,AVTSAVTP(,RAVT)                                 0888
         LA    @07,SAVTLUSR(,@09)                                  0888
         SLR   @05,@05                                             0888
         IC    @05,LINKOFFS                                        0888
         SLR   @07,@05                                             0888
         ST    @07,PREVIOUS                                        0888
*         CURRENT=SAVTLUSR;         /* ... SEARCH                    */
         L     @09,SAVTLUSR(,@09)                                  0889
         ST    @09,CURRENT                                         0889
*         FOUNDSW=OFF;              /* ... LOOP                      */
         NI    FOUNDSW,B'10111111'                                 0890
*         DO UNTIL(FOUNDSW=ON);     /* FIND THE ENQUEUED ELEMENT     */
@DL00891 DS    0H                                                  0892
*           IF CURRENT->REQLTNT=TNTSLU&CURRENT->REQTYPE=REQLSHTD THEN
         L     @09,CURRENT                                         0892
         CLC   REQLTNT(2,@09),TNTSLU                               0892
         BNE   @RF00892                                            0892
         CLI   REQTYPE(@09),X'02'                                  0892
         BNE   @RF00892                                            0892
*             FOUNDSW=ON;           /* ELEMENT FOUND                 */
         OI    FOUNDSW,B'01000000'                                 0893
*           ELSE                                                   0894
*             DO;                   /* KEEP LOOKING                  */
         B     @RC00892                                            0894
@RF00892 DS    0H                                                  0895
*               PREVIOUS=CURRENT;                                  0895
         L     @09,CURRENT                                         0895
         ST    @09,PREVIOUS                                        0895
*               CURRENT=PREVIOUS->REQLINK;                         0896
         L     @09,REQLINK-1(,@09)                                 0896
         LA    @09,0(,@09)                                         0896
         ST    @09,CURRENT                                         0896
*             END;                                                 0897
*         END;                                                     0898
@RC00892 DS    0H                                                  0898
@DE00891 TM    FOUNDSW,B'01000000'                                 0898
         BNO   @DL00891                                            0898
*                                   /* DELINK THE REQUEST ELEMENT    */
*         PREVIOUS->REQLINK=CURRENT->REQLINK;                      0899
         L     @09,CURRENT                                         0899
         L     @07,PREVIOUS                                        0899
         MVC   REQLINK(3,@07),REQLINK(@09)                         0899
*         RPARM=CURRENT;            /* GET ELEMENT ADDRESS           */
         LR    RPARM,@09                                           0900
*         SIBRQSHT=OFF;             /* RESET ELEMENT-ENQUEUED BIT    */
         L     @09,SIBPTR                                          0901
         NI    SIBRQSHT(@09),B'01111111'                           0901
*         CALL DACTRTN;             /* RE-PROCESS THE REQUEST ELEMENT*/
         BAL   @14,DACTRTN                                         0902
*       END;                                                       0903
*   END DFRDTERM;                   /* RETURN TO CALLER              */
@EL00016 DS    0H                                                  0904
@EF00016 DS    0H                                                  0904
@ER00016 L     @14,@SA00016                                        0904
         BR    @14                                                 0904
         EJECT
*ENDLGOFF:                                                         0905
*   PROC OPTIONS(SAVE(R14));                                       0905
*                                                                  0905
ENDLGOFF ST    @14,@SA00017                                        0905
*/********************************************************************/
*/*                                                                  */
*/*      E N D L G O F F   SUBROUTINE                                */
*/*                                                                  */
*/********************************************************************/
*/*                                                                  */
*/*      THIS SUBROUTINE COMPLETES NORMAL TCAM-TASK SESSION  @YM08450*/
*/*      TERMINATION PROCESSING FOR AN SLU AFTER A CLEAR     @YM08450*/
*/*      RESPONSE PIU IS RECEIVED FROM IEDSCLU.              @YM08450*/
*/*                                                                  */
*/********************************************************************/
*                                                                  0906
*                                   /* SEND SESSION-ENDED PIU TO SSCP*/
*   RPARM=CD1XSND;                  /* SESSION-ENDED REQUEST CODE    */
         L     RPARM,@CF00751                                      0906
*   CALL BLDMULTI;                  /* BUILD PIU & TPOST IT TO SSCP  */
         BAL   @14,BLDMULTI                                        0907
*   CALL SECLNUP;                   /* DO END-OF-SESSION CTL BLOCK 0908
*                                      CLEAN-UP              @YM08450*/
         BAL   @14,SECLNUP                                         0908
*   END ENDLGOFF;                   /* RETURN TO CALLER              */
@EL00017 DS    0H                                                  0909
@EF00017 DS    0H                                                  0909
@ER00017 L     @14,@SA00017                                        0909
         BR    @14                                                 0909
         EJECT
*ENDLGON:                                                          0910
*   PROC OPTIONS(SAVE(R14));                                       0910
*                                                                  0910
ENDLGON  ST    @14,@SA00018                                        0910
*/********************************************************************/
*/*                                                                  */
*/*      E N D L G O N   SUBROUTINE                                  */
*/*                                                                  */
*/********************************************************************/
*/*                                                                  */
*/*      THIS SUBROUTINE IS CALLED FROM PIURTN WHEN A        @YM08450*/
*/*      BIND OR SDT RESPONSE PIU IS RECEIVED FROM IEDSCLU.          */
*/*                                                                  */
*/*      IF THE RESPONSE IS GOOD:                                    */
*/*      .  A SESSION-STARTED PIU IS BUILT AND TPOSTED TO THE SSCP.  */
*/*      .  NORMAL SCHEDULING IS BEGUN BY EITHER TPOSTING A LOGON    */
*/*         DATA BUFFER TO THE INPUT MH, OR TPOSTING THE PLCB TO     */
*/*         ITSELF TO PRIME THE SCHEDULERS.                          */
*/*      .  LOGOFF PROCESSING IS STARTED IF THERE WAS A PREVIOUSLY   */
*/*         PROCESSED CTERM PIU OR DEACTIVATE REQUEST.               */
*/*                                                                  */
*/*      IF THE RESPONSE SHOWS AN ERROR:                             */
*/*      .  ERROR PROCESSING THROUGH THE MH IS BEGUN BY TPOSTING     */
*/*         AN ERROR BUFFER TO THE INPUT MH OR BY TPOSTING THE       */
*/*         PLCB TO ITSELF TO DRIVE SCHEDULING OF A SEND OPERATION.  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0911
*   IF TRHSDI=OFF THEN              /* GOOD RESPONSE?                */
         TM    TRHSDI+10(RPIU),B'00000100'                         0911
         BNZ   @RF00911                                            0911
*     DO;                           /* YES                           */
*       RPARM=CD1XSST;              /* SESSION-STARTED REQUEST CODE  */
         L     RPARM,@CF00761                                      0913
*       CALL BLDMULTI;              /* BLD & TPOST SESSION-STARTD PIU*/
         BAL   @14,BLDMULTI                                        0914
*       IF LCBWAITC>0&              /* IS THERE LOGON DATA SAVED?    */
*           LCBWAITC->PRFPRI='FF'X THEN                            0915
         L     @09,LCBWAITC-1(,RLCB)                               0915
         LA    @09,0(,@09)                                         0915
         LTR   @09,@09                                             0915
         BNP   @RF00915                                            0915
         CLI   PRFPRI(@09),X'FF'                                   0915
         BNE   @RF00915                                            0915
*         DO;                       /* YES, TPOST IT TO MH           */
*           RPRF=LCBWAITC;          /* LOGON DATA'S BUFFER ADDRESS   */
         LR    RPRF,@09                                            0917
*           LCBWAITC=PRFLINK;       /* DELINK IT FROM WAIT CHAIN     */
         MVC   LCBWAITC(3,RLCB),PRFLINK(RPRF)                      0918
*           PRFPRI=PRIMHBFR;        /* SET NO-ERROR PRIORITY         */
         MVI   PRFPRI(RPRF),X'E4'                                  0919
*           CALL MHBUF;             /* FINISH BUILDING BFR & TPOST IT*/
         BAL   @14,MHBUF                                           0920
*         END;                                                     0921
*       ELSE                        /* NO LOGON DATA                 */
*         DO;                       /* TPOST PLCB TO ITSELF          */
         B     @RC00915                                            0922
@RF00915 DS    0H                                                  0923
*           LCBQCBA=RLCB;           /* QCB ADDRESS                   */
         STCM  RLCB,7,LCBQCBA(RLCB)                                0923
*           LCBPRI=PRILNFRE;        /* PRIORITY                      */
         MVI   LCBPRI(RLCB),X'E0'                                  0924
*           RPARM=RLCB;             /* ELEMENT ADDRESS               */
         LR    RPARM,RLCB                                          0925
*           CALL DSPPOSTR;          /* TPOST THE PLCB                */
         LA    @15,DSPPOSTR(,RDISP)                                0926
         BALR  @14,@15                                             0926
*         END;                                                     0927
*       IF SIBTERM=ON×              /* ANY PREVIOUSLY-RECEIVED       */
*           SIBRQEND=ON×            /* ... SESSION-TERMINATION       */
*           SIBRQSHT=ON THEN        /* ... REQUESTS WAITING?         */
@RC00915 L     @09,SIBPTR                                          0928
         TM    SIBTERM(@09),B'01000000'                            0928
         BO    @RT00928                                            0928
         TM    SIBRQEND(@09),B'11000000'                           0928
         BZ    @RF00928                                            0928
@RT00928 DS    0H                                                  0929
*         CALL DFRDTERM;            /* YES, GO PROCESS THEM          */
         BAL   @14,DFRDTERM                                        0929
*     END;                                                         0930
         EJECT
*   ELSE                            /* BAD RESPONSE                  */
*     CALL ERRORPST;                /* CAUSE ERROR BUFFER TPOST TO 0931
*                                      USER'S MH             @YM08450*/
         B     @RC00911                                            0931
@RF00911 BAL   @14,ERRORPST                                        0931
*   END ENDLGON;                    /* RETURN TO CALLER              */
@EL00018 DS    0H                                                  0932
@EF00018 DS    0H                                                  0932
@ER00018 L     @14,@SA00018                                        0932
         BR    @14                                                 0932
         EJECT
*ENDNOSIB:                                                         0933
*   PROC OPTIONS(SAVE(R14));                                       0933
*                                                                  0933
ENDNOSIB ST    @14,@SA00019                                        0933
*/********************************************************************/
*/*                                                                  */
*/*      E N D N O S I B   SUBROUTINE                                */
*/*                                                                  */
*/********************************************************************/
*/*                                                                  */
*/*      THIS SUBROUTINE FINISHES THE TCAM ERROR PROCESSING FOR      */
*/*      A SESSION-INITIATION ATTEMPT WHICH FAILED BECAUSE THE       */
*/*      SSCP COULD NOT GET A SIB.                           @YM08450*/
*/*                                                                  */
*/********************************************************************/
*                                                                  0934
*   TRMINERR=OFF;                   /* INITIATION-ERROR BIT. TURNING
*                                      OFF THIS BIT ALLOWS IGCA210D
*                                      TO PROCESS NEW SESSION-     0934
*                                      INITIATION REQUESTS   @YM08450*/
         LA    @05,TRMINERR(,RTRM)                                 0934
         LR    @03,@05                                             0934
         LA    @09,3                                               0934
         NR    @03,@09                                             0934
         LCR   @03,@03                                             0934
         ALR   @05,@03                                             0934
         L     @09,0(,@05)                                         0934
@GL00015 LR    @07,@09                                             0934
         N     @07,@CB03391+3(@03)                                 0934
         CS    @09,@07,0(@05)                                      0934
         BNE   @GL00015                                            0934
*   CALL SECLNUP;                   /* DO END-OF-SESSION CTL BLOCK 0935
*                                      CLEAN-UP              @YM08450*/
         BAL   @14,SECLNUP                                         0935
*   END ENDNOSIB;                   /* RETURN TO CALLER              */
@EL00019 DS    0H                                                  0936
@EF00019 DS    0H                                                  0936
@ER00019 L     @14,@SA00019                                        0936
         BR    @14                                                 0936
         EJECT
*ERBRTN:                                                           0937
*   PROC OPTIONS(SAVE(R14));                                       0937
*                                                                  0937
ERBRTN   ST    @14,@SA00020                                        0937
*/********************************************************************/
*/*                                                                  */
*/*      E R B R T N   SUBROUTINE                                    */
*/*                                                                  */
*/********************************************************************/
*/*                                                                  */
*/*      THIS SUBROUTINE PROCESSES ERBS TPOSTED TO THIS MODULE       */
*/*      WITH EMPTY BUFFERS ATTACHED.  SOME SET-UP COMMON TO BOTH    */
*/*      TYPES OF ERB (INTERNAL AND EXTERNAL) IS DONE.  THE          */
*/*      SPECIFIC ERB TYPE IS THEN IDENTIFIED, AND THE PROPER        */
*/*      SUBROUTINE IS CALLED TO PROCESS IT.                         */
*/*                                                                  */
*/********************************************************************/
*                                                                  0938
*   RLCB=RPARM-LCBERBFS;            /* BACK UP TO START OF PLCB      */
         LR    RLCB,RPARM                                          0938
         SL    RLCB,@CF01909                                       0938
*   IF RPARM=ADDR(LUSERB) THEN      /* DETERMINE ERB TYPE            */
         LA    @09,LUSERB                                          0939
         CR    RPARM,@09                                           0939
         BNE   @RF00939                                            0939
*     CALL ERBRTNI;                 /* INTERNAL ERB                  */
         BAL   @14,ERBRTNI                                         0940
*   ELSE                                                           0941
*     CALL ERBRTNX;                 /* EXTERNAL (WITHIN A PLCB) ERB  */
         B     @RC00939                                            0941
@RF00939 BAL   @14,ERBRTNX                                         0941
*   END ERBRTN;                     /* RETURN TO CALLER              */
@EL00020 DS    0H                                                  0942
@EF00020 DS    0H                                                  0942
@ER00020 L     @14,@SA00020                                        0942
         BR    @14                                                 0942
         EJECT
*ERBRTNI:                                                          0943
*   PROC OPTIONS(SAVE(R14));                                       0943
*                                                                  0943
ERBRTNI  ST    @14,@SA00021                                        0943
*/********************************************************************/
*/*                                                                  */
*/*      E R B R T N I   SUBROUTINE                                  */
*/*                                                                  */
*/********************************************************************/
*/*                                                                  */
*/*      THIS SUBROUTINE PROCESSES THE INTERNAL ERB, HARD-CODED      */
*/*      WITHIN THIS MODULE, WHEN IT RETURNS FROM IEDQGA WITH AN     */
*/*      EMPTY BUFFER.  THREE PROCESSING STEPS ARE INVOLVED:         */
*/*                                                                  */
*/*      .  THE EMPTY BUFFER IS REMOVED FROM THE ERB AND ITS         */
*/*         ADDRESS STORED IN A LOCAL POINTER.                       */
*/*                                                                  */
*/*      .  THE ELEMENT WHICH WAS WAITING FOR THE BUFFER IS          */
*/*         REPROCESSED THROUGH THE SAME SUBROUTINE WHICH ISSUED     */
*/*         THE ORIGINAL BUFFER REQUEST.                             */
*/*                                                                  */
*/*      .  THE FIRST ELEMENT WAITING IN LINE FOR THE ERB TO BECOME  */
*/*         AVAILABLE IS REMOVED FROM THE CHAIN, AND THE ERB IS      */
*/*         TPOSTED TO IEDQGA TO HONOR THAT NEW ELEMENT'S REQUEST.   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0944
*   BUFPTR=LCBERBCH;                /* SAVE BUFFER ADDR IN LOCAL PTR */
         L     @09,LCBERBCH-1(,RLCB)                               0944
         LA    @09,0(,@09)                                         0944
         ST    @09,BUFPTR                                          0944
*   LCBERBCH=0;                     /* CLEAR ERB'S BUFFER PTR        */
         SLR   @09,@09                                             0945
         STCM  @09,7,LCBERBCH(RLCB)                                0945
*   RPARM=LCBBFRSV;                 /* ADDR OF ELEMENT NEEDING BUFFER*/
         L     RPARM,LCBBFRSV-1(,RLCB)                             0946
         LA    RPARM,0(,RPARM)                                     0946
*                                   /* IDENTIFY THE ELEMENT TYPE & 0947
*                                      CALL PROPER SUBROUTINE        */
*   IF RECBPRI=PRILUSQB THEN                                       0947
         CLI   RECBPRI(RPARM),226                                  0947
         BNE   @RF00947                                            0947
*     CALL QCBRTN;                  /* DESTINATION QCB               */
         BAL   @14,QCBRTN                                          0948
*   ELSE                                                           0949
*     CALL DACTRTN;                 /* SHUTDOWN REQUEST FROM DEACT   */
         B     @RC00947                                            0949
@RF00947 BAL   @14,DACTRTN                                         0949
*   RLCB=ADDR(LUSLCB);              /* ADDR OF LOCALLY DECLARED PLCB */
@RC00947 LA    RLCB,LUSLCB                                         0950
*   LCBDLNKN=ON;                    /* MARK THE ERB AVAILABLE FOR USE*/
         OI    LCBDLNKN(RLCB),B'00000001'                          0951
*   IF SAVTLUSB>0 THEN              /* ANY ELEMENTS WAITING FOR ERB? */
         L     @09,AVTSAVTP(,RAVT)                                 0952
         L     @07,SAVTLUSB(,@09)                                  0952
         LTR   @07,@07                                             0952
         BNP   @RF00952                                            0952
*     DO;                           /* YES                           */
*       RPARM=SAVTLUSB;             /* ADDR OF 1ST WAITING ELEMENT   */
         LR    RPARM,@07                                           0954
*       SAVTLUSB=RECBLINK;          /* DELINK IT                     */
         L     @07,RECBLINK-1(,RPARM)                              0955
         LA    @07,0(,@07)                                         0955
         ST    @07,SAVTLUSB(,@09)                                  0955
*       R0=RECBUNCT;                /* UNIT COUNT (SAVED IN 1ST WORD
*                                      OF ELEMENT)                   */
         SLR   R0,R0                                               0956
         IC    R0,RECBUNCT(,RPARM)                                 0956
*       CALL GETBUFI;               /* REQUEST A BUFFER              */
         BAL   @14,GETBUFI                                         0957
*     END;                                                         0958
*   END ERBRTNI;                    /* RETURN TO CALLER              */
@EL00021 DS    0H                                                  0959
@EF00021 DS    0H                                                  0959
@ER00021 L     @14,@SA00021                                        0959
         BR    @14                                                 0959
         EJECT
*ERBRTNX:                                                          0960
*   PROC OPTIONS(SAVE(R14));                                       0960
*                                                                  0960
ERBRTNX  ST    @14,@SA00022                                        0960
*/********************************************************************/
*/*                                                                  */
*/*      E R B R T N X   SUBROUTINE                                  */
*/*                                                                  */
*/********************************************************************/
*/*                                                                  */
*/*      THIS SUBROUTINE PROCESSES AN EXTERNAL ERB (A NORMAL ERB     */
*/*      WITHIN A PLCB) WHEN IT RETURNS FROM IEDQGA WITH AN EMPTY    */
*/*      BUFFER.  THE PROCESSING CONSISTS OF REDRIVING THE           */
*/*      SUBROUTINE WHICH ORIGINALLY REQUESTED THE BUFFER.  THAT     */
*/*      IS DETERMINED BY CHECKING THE CURRENT SESSION STATE.        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0961
*   TNTSLU=LCBTTCIN;                /* SLU'S TNT INDEX               */
         LH    @09,LCBTTCIN(,RLCB)                                 0961
         N     @09,@CF03378                                        0961
         STH   @09,TNTSLU                                          0961
*   CALL CTLBLKS;                   /* SET UP CONTROL BLOCK POINTERS */
         BAL   @14,CTLBLKS                                         0962
*   LCBDLNKN=ON;                    /* MARK ERB AVAILABLE            */
         OI    LCBDLNKN(RLCB),B'00000001'                          0963
*                                   /* DETERMINE PROCESSING BASED ON
*                                      CURRENT SESSION STATE         */
*   IF SIBSSTAT=SIBSINIT THEN       /* SESSION STATE = 'INITIAL'?    */
         L     @09,SIBPTR                                          0964
         TM    SIBSSTAT(@09),B'00011100'                           0964
         BNZ   @RF00964                                            0964
*     DO;                           /* YES                           */
*       RPRF=LCBBFRSV;              /* ADDR OF SAVED CINIT PIU'S BFR */
         L     RPRF,LCBBFRSV-1(,RLCB)                              0966
         LA    RPRF,0(,RPRF)                                       0966
*       INPUTBUF=RPRF;              /* SAVE ADDRESS IN LOCAL POINTER */
         ST    RPRF,INPUTBUF                                       0967
*       RPIU=ADDR(PRFPIUO)+PRFPIUO; /* START-OF-PIU ADDRESS          */
         LA    RPIU,PRFPIUO(,RPRF)                                 0968
         SLR   @09,@09                                             0968
         IC    @09,PRFPIUO(,RPRF)                                  0968
         ALR   RPIU,@09                                            0968
*       INPUTPIU=RPIU;              /* SAVE ADDRESS IN LOCAL POINTER */
         ST    RPIU,INPUTPIU                                       0969
*       CALL CINITRTN;              /* RESUME CINIT PIU PROCESSING   */
         BAL   @14,CINITRTN                                        0970
*     END;                                                         0971
*   ELSE                                                           0972
*     IF SIBSSTAT=SIBSACTV THEN     /* SESSION STATE = 'ACTIVE'?     */
         B     @RC00964                                            0972
@RF00964 L     @09,SIBPTR                                          0972
         TM    SIBSSTAT(@09),B'00011100'                           0972
         BNO   @RF00972                                            0972
*       CALL LGOFF;                 /* YES, RESUME LOGOFF PROCESSING */
         BAL   @14,LGOFF                                           0973
*     ELSE                          /* SESSION STATE = 'RESET'       */
*       CALL BINDFAIL;              /* RESUME BIND-FAILED PROCESSING */
         B     @RC00972                                            0974
@RF00972 BAL   @14,BINDFAIL                                        0974
*   END ERBRTNX;                    /* RETURN TO CALLER              */
@EL00022 DS    0H                                                  0975
@EF00022 DS    0H                                                  0975
@ER00022 L     @14,@SA00022                                        0975
         BR    @14                                                 0975
         EJECT
*ERRORPST:                                                         0976
*   PROC OPTIONS(SAVE(R14));        /*                       @YM08450*/
ERRORPST ST    @14,@SA00023                                        0976
*/********************************************************** @YM08450*/
*/*                                                          @YM08450*/
*/*      E R R O R P S T   SUBROUTINE                        @YM08450*/
*/*                                                          @YM08450*/
*/********************************************************** @YM08450*/
*/*                                                          @YM08450*/
*/*      THIS SUBROUTINE DOES THE PROCESSING NEEDED TO       @YM08450*/
*/*      NOTIFY THE USER'S MH OF A SESSION-INITIATION        @YM08450*/
*/*      ERROR.  THERE ARE TWO POSSIBILITIES:                @YM08450*/
*/*                                                          @YM08450*/
*/*      1. IF THIS IS A TCAM-INITIATED SESSION AND          @YM08450*/
*/*         CONDITIONS ARE SUCH THAT THE SEND SCHEDULER      @YM08450*/
*/*         WILL ATTEMPT A SEND OPERATION IF GIVEN CONTROL,  @YM08450*/
*/*         THEN WE TPOST THE PLCB TO ITSELF.  THIS WILL     @YM08450*/
*/*         ULTIMATELY CAUSE AN ERROR BUFFER TO BE PASSED    @YM08450*/
*/*         THRU THE USER'S OUTPUT MH.                       @YM08450*/
*/*                                                          @YM08450*/
*/*      2. IF THE ABOVE CONDITIONS ARE NOT TRUE, THEN WE    @YM08450*/
*/*         TPOST AN ERROR BUFFER TO THE USER'S INPUT MH.    @YM08450*/
*/*         A SAVED LOGON-DATA BUFFER IS USED IF AVAILABLE.  @YM08450*/
*/*         OTHERWISE, A ZERO-LENGTH BUFFER IS USED.         @YM08450*/
*/*                                                          @YM08450*/
*/********************************************************** @YM08450*/
*                                                                  0977
*   LCBLUS=ON;                      /* SET BIT TO CAUSE PLCB TO BE 0977
*                                      RETURNED TO THIS MODULE WHEN
*                                      MH ERROR PROCESSING ENDS    0977
*                                                            @YM08450*/
         OI    LCBLUS(RLCB),B'00100000'                            0977
*   LCBBFSNS=PIURU(1:4);            /* SAVE SENSE DATA FROM RESPONSE
*                                                            @YM08450*/
         MVC   LCBBFSNS(4,RLCB),PIURU(RPIU)                        0978
*   SENDSW=OFF;                     /* INIT SEND SWITCH      @YM08450*/
         NI    SENDSW,B'11110111'                                  0979
*   IF TRMLUREQ=OFF THEN            /* TCAM-INITIATED LOGON? @YM08450*/
         TM    TRMLUREQ(RTRM),B'00000100'                          0980
         BNZ   @RF00980                                            0980
*     CALL CHKSEND;                 /* YES, SET SENDSW IF MSGS TO BE
*                                      SENT                  @YM08450*/
         BAL   @14,CHKSEND                                         0981
*   IF SENDSW=ON THEN               /* SHOULD WE TRY A SEND? @YM08450*/
@RF00980 TM    SENDSW,B'00001000'                                  0982
         BNO   @RF00982                                            0982
*     DO;                           /* YES                   @YM08450*/
*       RPARM=RPRF;                 /* FREE THE              @YM08450*/
         LR    RPARM,RPRF                                          0984
*       CALL FREEBUF;               /* ... RESPONSE BUFFER   @YM08450*/
         BAL   @14,FREEBUF                                         0985
*       LCBQCBA=RLCB;               /* TPOST THE PLCB TO     @YM08450*/
         STCM  RLCB,7,LCBQCBA(RLCB)                                0986
*       LCBPRI=PRILNFRE;            /* ... ITSELF TO DRIVE   @YM08450*/
         MVI   LCBPRI(RLCB),X'E0'                                  0987
*       RPARM=RLCB;                 /* ... SEND SCHEDULER    @YM08450*/
         LR    RPARM,RLCB                                          0988
*       CALL DSPPOSTR;              /* ... ROUTINE           @YM08450*/
         LA    @15,DSPPOSTR(,RDISP)                                0989
         BALR  @14,@15                                             0989
*     END;                          /*                       @YM08450*/
*   ELSE                            /* SENDSW IS OFF         @YM08450*/
*     DO;                           /* TPOST TO INPUT MH     @YM08450*/
         B     @RC00982                                            0991
@RF00982 DS    0H                                                  0992
*       IF LCBWAITC>0&              /* LOGON DATA SAVED?     @YM08450*/
*           LCBWAITC->PRFPRI='FF'X THEN/*                    @YM08450*/
         L     @09,LCBWAITC-1(,RLCB)                               0992
         LA    @09,0(,@09)                                         0992
         LTR   @09,@09                                             0992
         BNP   @RF00992                                            0992
         CLI   PRFPRI(@09),X'FF'                                   0992
         BNE   @RF00992                                            0992
*         DO;                       /* YES                   @YM08450*/
*           RPARM=RPRF;             /* FREE THE RESPONSE     @YM08450*/
         LR    RPARM,RPRF                                          0994
*           CALL FREEBUF;           /* ... BUFFER            @YM08450*/
         BAL   @14,FREEBUF                                         0995
*           RPRF=LCBWAITC;          /* DELINK THE LOGON DATA @YM08450*/
         L     RPRF,LCBWAITC-1(,RLCB)                              0996
         LA    RPRF,0(,RPRF)                                       0996
*           LCBWAITC=PRFLINK;       /* ... FROM WAIT CHAIN   @YM08450*/
         MVC   LCBWAITC(3,RLCB),PRFLINK(RPRF)                      0997
*         END;                      /*                       @YM08450*/
*       ELSE                        /* NO LOGON DATA         @YM08450*/
*         DO;                       /* INIT 0-LENGTH BUFFER  @YM08450*/
         B     @RC00992                                            0999
@RF00992 DS    0H                                                  1000
*           PRFNBUNT=1;             /* NUMBER OF UNITS       @YM08450*/
         MVI   PRFNBUNT(RPRF),X'01'                                1000
*           PRFSIZE=0;              /* SIZE                  @YM08450*/
         SLR   @09,@09                                             1001
         STH   @09,PRFSIZE(,RPRF)                                  1001
*           PRF1FLG1=0;             /* CLEAR FLAG BYTE       @YM08450*/
         LR    @09,RPRF                                            1002
         AL    @09,@CF03396                                        1002
         MVI   PRF1FLG1-3(@09),X'00'                               1002
*           PRFDEST=SIBINDEX;       /* DESTINATION = PLU     @YM08450*/
         L     @09,SIBPTR                                          1003
         LH    @09,SIBINDEX(,@09)                                  1003
         N     @09,@CF03378                                        1003
         STH   @09,PRFDEST(,RPRF)                                  1003
*         END;                      /*                       @YM08450*/
*       PRFPRI=PRIERBFR;            /* SET ERROR PRIORITY    @YM08450*/
@RC00992 MVI   PRFPRI(RPRF),X'E3'                                  1005
*       SCBSLCTN=ON;                /* SET SELECTION         @OX21004*/
*       SCBCONNN=ON;                /* CONNECTION ERRORS     @OX21004*/
         L     @09,LCBSCBA-1(,RLCB)                                1007
         OI    SCBSLCTN(@09),B'10100000'                           1007
*       LCBLUSNS=LCBBFSNS;          /* SET SENSE             @OX21004*/
         MVC   LCBLUSNS(4,RLCB),LCBBFSNS(RLCB)                     1008
*       CALL MHBUF;                 /* TPOST ERROR BFR TO MH @YM08450*/
         BAL   @14,MHBUF                                           1009
*     END;                          /*                       @YM08450*/
*   END ERRORPST;                   /* RETURN TO CALLER      @YM08450*/
@EL00023 DS    0H                                                  1011
@EF00023 DS    0H                                                  1011
@ER00023 L     @14,@SA00023                                        1011
         BR    @14                                                 1011
         EJECT
*FNDLGDTA:                                                         1012
*   PROC OPTIONS(SAVE(R14));                                       1012
*                                                                  1012
FNDLGDTA ST    @14,@SA00024                                        1012
*/********************************************************************/
*/*                                                                  */
*/*      F N D L G D T A   SUBROUTINE                                */
*/*                                                                  */
*/********************************************************************/
*/*                                                                  */
*/*      THIS SUBROUTINE LOCATES THE USER-DATA FIELD WITHIN A        */
*/*      CINIT PIU AND STORES ITS ADDRESS IN THE LOCAL POINTER,      */
*/*      DATAPTR.                                                    */
*/*                                                                  */
*/*      (NOTE THAT THIS SUBROUTINE USES IEDMVBFR IN AN UNUSUAL      */
*/*      WAY BY SETTING THE TARGET AND SOURCE ADDRESSES EQUAL.       */
*/*      THIS CAUSES IEDMVBFR TO SKIP THE POINTERS PAST VARIABLE-    */
*/*      LENGTH FIELDS WITHOUT DOING ANY ACTUAL DATA MOVING.)        */
*/*                                                                  */
*/********************************************************************/
*                                                                  1013
*   RPARM=ADDR(PLMVPARM);           /* ADDRESS OF PARAMETER LIST     */
         LA    RPARM,PLMVPARM                                      1013
*   PLMVTU=RPRF;                    /* TARGET UNIT ADDRESS           */
         ST    RPRF,PLMVTU(,RPARM)                                 1014
*   PLMVTD=ADDR(XCINBLEN);          /* TARGET DATA ADDRESS           */
         LA    @09,13                                              1015
         ALR   @09,RPIU                                            1015
         LA    @07,XCINBLEN(,@09)                                  1015
         ST    @07,PLMVTD(,RPARM)                                  1015
*   PLMVSU=PLMVTU;                  /* SOURCE UNIT ADDRESS           */
         L     @05,PLMVTU(,RPARM)                                  1016
         ST    @05,PLMVSU(,RPARM)                                  1016
*   PLMVSD=PLMVTD;                  /* SOURCE DATA ADDRESS           */
         ST    @07,PLMVSD(,RPARM)                                  1017
*   PLMVLNTH=XCINBLEN+LENGTH(XCINBLEN)+LENGTH(XCINNTYP);/* LENGTH    */
         LA    @07,3                                               1018
         SLR   @05,@05                                             1018
         ICM   @05,3,XCINBLEN(@09)                                 1018
         ALR   @07,@05                                             1018
         STH   @07,PLMVLNTH(,RPARM)                                1018
*   PLMVFLG1=0;                     /* CLEAR FLAG BYTE               */
         MVI   PLMVFLG1(RPARM),X'00'                               1019
*   CALL IEDMVBFR;                  /* SKIP TO NETWORK NAME LENGTH 1020
*                                      BYTE (XCINNLEN)               */
         L     @09,AVTSAVTP(,RAVT)                                 1020
         L     @15,SAVTMVBF(,@09)                                  1020
         BALR  @14,@15                                             1020
*                                   /* LOOP TO SKIP OVER 3 VARIABLE-
*                                      LENGTH FIELDS (NETWORK NAME,
*                                      REQUESTOR ID, AND PASSWORD)   */
*   R0=3;                           /* LOOP COUNTER                  */
         LA    R0,3                                                1021
*   DO UNTIL(R0=0);                                                1022
@DL01022 DS    0H                                                  1023
*     PLMVLNTH=PLMVSD->VARLNGTH+LENGTH(VARLNGTH);/* BYTES TO SKIP    */
         L     @09,PLMVSD(,RPARM)                                  1023
         LA    @07,1                                               1023
         SLR   @05,@05                                             1023
         IC    @05,VARLNGTH(,@09)                                  1023
         ALR   @07,@05                                             1023
         STH   @07,PLMVLNTH(,RPARM)                                1023
*     CALL IEDMVBFR;                /* SKIP TO NEXT FIELD            */
         L     @09,AVTSAVTP(,RAVT)                                 1024
         L     @15,SAVTMVBF(,@09)                                  1024
         BALR  @14,@15                                             1024
*     R0=R0-1;                      /* DECREMENT LOOP COUNT          */
         BCTR  R0,0                                                1025
*   END;                                                           1026
@DE01022 LTR   R0,R0                                               1026
         BNZ   @DL01022                                            1026
*   DATAPTR=PLMVSD;                 /* ADDRESS OF LOGON DATA FIELD   */
         L     @09,PLMVSD(,RPARM)                                  1027
         ST    @09,DATAPTR                                         1027
*   END FNDLGDTA;                   /* RETURN TO CALLER              */
@EL00024 DS    0H                                                  1028
@EF00024 DS    0H                                                  1028
@ER00024 L     @14,@SA00024                                        1028
         BR    @14                                                 1028
         EJECT
*FREEBUF:                                                          1029
*   PROC OPTIONS(SAVE(R14));                                       1029
*                                                                  1029
FREEBUF  ST    @14,@SA00025                                        1029
*/********************************************************************/
*/*                                                                  */
*/*      F R E E B U F   SUBROUTINE                                  */
*/*                                                                  */
*/********************************************************************/
*/*                                                                  */
*/*      THIS SUBROUTINE FREES A BUFFER BY TPOSTING IT TO THE        */
*/*      BUFFER-RETURN QCB.                                          */
*/*                                                                  */
*/********************************************************************/
*                                                                  1030
*   RPARM->PRFQCBA=ADDR(AVTBFRTB);  /* BUFFER-RETURN QCB             */
         LA    @09,AVTBFRTB(,RAVT)                                 1030
         STCM  @09,7,PRFQCBA(RPARM)                                1030
*   RPARM->PRFPRI=PRIBFRTB;         /* PRIORITY                      */
         MVI   PRFPRI(RPARM),X'E0'                                 1031
*   RPARM->PRFNBUNT=0;              /* SET TO LET IEDQGA DETERMINE 1032
*                                      NUMBER OF UNITS               */
         MVI   PRFNBUNT(RPARM),X'00'                               1032
*   CALL DSPPOSTR;                  /* TPOST THE BUFFER              */
         LA    @15,DSPPOSTR(,RDISP)                                1033
         BALR  @14,@15                                             1033
*   END FREEBUF;                    /* RETURN TO CALLER              */
@EL00025 DS    0H                                                  1034
@EF00025 DS    0H                                                  1034
@ER00025 L     @14,@SA00025                                        1034
         BR    @14                                                 1034
         EJECT
*GETBUFI:                                                          1035
*   PROC OPTIONS(SAVE(R14));                                       1035
*                                                                  1035
GETBUFI  ST    @14,@SA00026                                        1035
*/********************************************************************/
*/*                                                                  */
*/*      G E T B U F I   SUBROUTINE                                  */
*/*                                                                  */
*/********************************************************************/
*/*                                                                  */
*/*      THIS SUBROUTINE IS CALLED BY THE QCBRTN AND DACTSHTD        */
*/*      SUBROUTINES WHEN A BUFFER IS NEEDED BUT THERE IS NO PLCB    */
*/*      AVAILABLE WHOSE ERB CAN BE USED.  THE CALLER PROVIDES THE   */
*/*      ADDRESS OF THE ELEMENT NEEDING THE BUFFER AND THE NUMBER    */
*/*      OF UNITS NEEDED.   PROCESSING DEPENDS ON WHETHER THE        */
*/*      SINGLE INTERNAL ERB IS AVAILABLE:                           */
*/*                                                                  */
*/*      .  IF THE ERB IS AVAILABLE IT IS TPOSTED IMMEDIATELY TO     */
*/*         IEDQGA TO REQUEST A BUFFER.  THE ADDRESS OF THE ELEMENT  */
*/*         NEEDING THE BUFFER IS SAVED FOR LATER USE BY THE         */
*/*         ERBRTNI SUBROUTINE.                                      */
*/*                                                                  */
*/*      .  IF THE ERB IS BUSY, THE ELEMENT IS PLACED ON A CHAIN.    */
*/*         WHEN THE ERB LATER BECOMES AVAILABLE, AND THE ELEMENT    */
*/*         REACHES THE TOP OF THE CHAIN, THE BUFFER REQUEST WILL    */
*/*         BE MADE AT THAT TIME.                                    */
*/*                                                                  */
*/********************************************************************/
*                                                                  1036
*   RLCB=ADDR(LUSLCB);              /* ADDR OF LOCALLY-DECLARED PLCB */
         LA    RLCB,LUSLCB                                         1036
*   IF LCBDLNKN=ON THEN             /* IS INTERNAL ERB AVAILABLE?    */
         TM    LCBDLNKN(RLCB),B'00000001'                          1037
         BNO   @RF01037                                            1037
*     DO;                           /* YES                           */
*       LCBRBCT2=R0;                /* SET UNIT COUNT                */
         STC   R0,LCBRBCT2(,RLCB)                                  1039
*       LCBBFRSV=RPARM;             /* ADDR OF ELEMENT NEEDING BUFFER*/
         STCM  RPARM,7,LCBBFRSV(RLCB)                              1040
*       CALL TPOSTERB;              /* REQUEST A BUFFER              */
         BAL   @14,TPOSTERB                                        1041
*     END;                                                         1042
*   ELSE                            /* INTERNAL ERB IS BUSY          */
*     DO;                           /* ELEMENT MUST WAIT UNTIL LATER */
         B     @RC01037                                            1043
@RF01037 DS    0H                                                  1044
*       RECBUNCT=R0;                /* SAVE UNIT COUNT IN 1ST WORD OF
*                                      ELEMENT                       */
         STC   R0,RECBUNCT(,RPARM)                                 1044
*       CURRENT=ADDR(SAVTLUSB)-LINKOFFS;/* INITIALIZE FOR SEARCH     */
         L     @09,AVTSAVTP(,RAVT)                                 1045
         LA    @09,SAVTLUSB(,@09)                                  1045
         SLR   @07,@07                                             1045
         IC    @07,LINKOFFS                                        1045
         SLR   @09,@07                                             1045
         ST    @09,CURRENT                                         1045
*       DO WHILE(CURRENT->RECBLINK>0);/* FIND END OF CHAIN           */
         B     @DE01046                                            1046
@DL01046 DS    0H                                                  1047
*         CURRENT=CURRENT->RECBLINK;                               1047
         L     @09,CURRENT                                         1047
         L     @09,RECBLINK-1(,@09)                                1047
         LA    @09,0(,@09)                                         1047
         ST    @09,CURRENT                                         1047
*       END;                                                       1048
@DE01046 L     @09,CURRENT                                         1048
         L     @07,RECBLINK-1(,@09)                                1048
         LA    @07,0(,@07)                                         1048
         LTR   @07,@07                                             1048
         BP    @DL01046                                            1048
*       CURRENT->RECBLINK=RPARM;    /* ADD NEW ELEMENT AT END        */
         STCM  RPARM,7,RECBLINK(@09)                               1049
*       RECBLINK=0;                 /* MARK IT AS LAST               */
         SLR   @09,@09                                             1050
         STCM  @09,7,RECBLINK(RPARM)                               1050
*     END;                                                         1051
*   END GETBUFI;                    /* RETURN TO CALLER              */
@EL00026 DS    0H                                                  1052
@EF00026 DS    0H                                                  1052
@ER00026 L     @14,@SA00026                                        1052
         BR    @14                                                 1052
         EJECT
*LGOFF:                                                            1053
*   PROC OPTIONS(SAVE(R14));                                       1053
*                                                                  1053
LGOFF    ST    @14,@SA00027                                        1053
*/********************************************************************/
*/*                                                                  */
*/*      L G O F F   SUBROUTINE                                      */
*/*                                                                  */
*/********************************************************************/
*/*                                                                  */
*/*      THIS SUBROUTINE TPOSTS A PLCB TO IEDSCLU AS THE SIGNAL      */
*/*      TO SEND CLEAR AND UNBIND PIUS TO A SLU.  SOME PRELIMINARY   */
*/*      OPERATIONS MAY NEED TO BE DONE FIRST, HOWEVER:              */
*/*                                                                  */
*/*      .  IF THE SLU IS CURRENTLY IN MIDDLE-OF-MESSAGE IT IS       */
*/*         FORCED OUT OF THAT STATE BY MEANS OF A 0-LENGTH ERROR    */
*/*         BUFFER TPOSTED TO THE MH.                                */
*/*                                                                  */
*/*      .  THE SLU IS REMOVED FROM LOCK MODE, IF NECESSARY.         */
*/*                                                                  */
*/*      .  AN EMPTY BUFFER IS OBTAINED FOR USE BY IEDSCLU.  THIS    */
*/*         AVOIDS THE NEED FOR BUFFER-REQUEST LOGIC IN IEDSCLU.     */
*/*                                                                  */
*/********************************************************************/
*                                                                  1054
*   IF LCBERBCH=0 THEN              /* NEED TO REQUEST A BUFFER?     */
         L     @09,LCBERBCH-1(,RLCB)                               1054
         LA    @09,0(,@09)                                         1054
         LTR   @09,@09                                             1054
         BNZ   @RF01054                                            1054
*     DO;                           /* YES                           */
*       LCBRBCT2=1;                 /* SET NUMBER OF UNITS NEEDED    */
         MVI   LCBRBCT2(RLCB),X'01'                                1056
*       CALL TPOSTERB;              /* REQUEST A BUFFER              */
         BAL   @14,TPOSTERB                                        1057
*     END;                                                         1058
*   ELSE                            /* BUFFER ALREADY OBTAINED       */
*     DO;                                                          1059
         B     @RC01054                                            1059
@RF01054 DS    0H                                                  1060
*       IF SCBBFMM=ON THEN          /* IS SLU IN MIDDLE-OF-MSG?      */
         L     @09,LCBSCBA-1(,RLCB)                                1060
         LA    @09,0(,@09)                                         1060
         TM    SCBBFMM(@09),B'00000001'                            1060
         BNO   @RF01060                                            1060
*         DO;                       /* YES, SEND ERROR BUFFER TO MH  */
*           RPRF=LCBERBCH;          /* GET BUFFER ADDRESS            */
         L     RPRF,LCBERBCH-1(,RLCB)                              1062
         LA    RPRF,0(,RPRF)                                       1062
*           LCBERBCH=0;             /* CLEAR ERB'S BUFFER POINTER  1063
*                                      PARTIALLY SET UP BUFFER       */
         SLR   @07,@07                                             1063
         STCM  @07,7,LCBERBCH(RLCB)                                1063
*           PRFPRI=PRIERBFR;        /* ERROR PRIORITY                */
         MVI   PRFPRI(RPRF),X'E3'                                  1064
*           PRFNBUNT=1;             /* NUMBER OF UNITS               */
         MVI   PRFNBUNT(RPRF),X'01'                                1065
*           PRF1FLG1=0;             /* CLEAR FLAG BYTE               */
         LR    @05,RPRF                                            1066
         AL    @05,@CF03396                                        1066
         MVI   PRF1FLG1-3(@05),X'00'                               1066
*           PRFDEST=SIBINDEX;       /* DESTINATION = PLU             */
         L     @05,SIBPTR                                          1067
         LH    @05,SIBINDEX(,@05)                                  1067
         N     @05,@CF03378                                        1067
         STH   @05,PRFDEST(,RPRF)                                  1067
*           PRFSIZE=0;              /* SIZE                          */
         STH   @07,PRFSIZE(,RPRF)                                  1068
*           SCBTXTTN=ON;            /* SET TEXT ERROR        @OX21004*/
         OI    SCBTXTTN(@09),B'01000000'                           1069
*           CALL MHBUF;             /* TPOST ERROR BUFFER TO MH      */
         BAL   @14,MHBUF                                           1070
*         END;                                                     1071
*       ELSE                        /* NOT IN MIDDLE-OF-MSG          */
*         DO;                                                      1072
         B     @RC01060                                            1072
@RF01060 DS    0H                                                  1073
*           SCBLCK1N=OFF;           /* TAKE SLU OUT OF LOCK MODE (IF
*                                      IT IS IN THAT STATE)          */
         L     @09,LCBSCBA-1(,RLCB)                                1073
         NI    SCBLCK1N(@09),B'11011111'                           1073
*           LCBQCBA=SAVTSCLU;       /* QCB ADDRESS                   */
         L     @09,AVTSAVTP(,RAVT)                                 1074
         MVC   LCBQCBA(3,RLCB),SAVTSCLU+1(@09)                     1074
*           LCBPRI=PRILNFRE;        /* PRIORITY                      */
         MVI   LCBPRI(RLCB),X'E0'                                  1075
*           RPARM=RLCB;             /* PLCB ADDRESS                  */
         LR    RPARM,RLCB                                          1076
*           CALL DSPPOSTR;          /* TPOST PLCB TO SESSION CONTROL */
         LA    @15,DSPPOSTR(,RDISP)                                1077
         BALR  @14,@15                                             1077
*         END;                                                     1078
*     END;                                                         1079
*   END LGOFF;                      /* RETURN TO CALLER              */
@EL00027 DS    0H                                                  1080
@EF00027 DS    0H                                                  1080
@ER00027 L     @14,@SA00027                                        1080
         BR    @14                                                 1080
         EJECT
*MHBUF:                                                            1081
*   PROC OPTIONS(SAVE(R14));                                       1081
*                                                                  1081
MHBUF    ST    @14,@SA00028                                        1081
*/********************************************************************/
*/*                                                                  */
*/*      M H B U F   SUBROUTINE                                      */
*/*                                                                  */
*/********************************************************************/
*/*                                                                  */
*/*      THIS SUBROUTINE FINISHES BUILDING THE HEADER PREFIX FOR     */
*/*      A BUFFER, SETS STATUS BITS AS NEEDED, AND TPOSTS THE        */
*/*      BUFFER TO THE PROPER MH.                                    */
*/*                                                                  */
*/*      THE CALLER SUPPLIES A PARTIALLY-BUILT BUFFER WITH THE       */
*/*      FOLLOWING FIELDS INITIALIZED:                               */
*/*      .  PRFPRI           .  PRFNBUNT          .  PRFSIZE         */
*/*      .  PRFDEST          .  PRF1LOGD                             */
*/*                                                                  */
*/********************************************************************/
*                                                                  1082
*                                   /* SET UP BFR'S NEGATIVE PREFIX  */
*   PRF1RH=DUMMYRH;                 /* SET UP RH IN NEG. PREFIX      */
         LR    @09,RPRF                                            1082
         SL    @09,@CF00044                                        1082
         MVC   PRF1RH(3,@09),@CB03127                              1082
*   PRF1FIDI=ON;                    /* SET FID-1 INDICATOR           */
         OI    PRF1FIDI(@09),B'10000000'                           1083
*   PRF1SEQP=0;                     /* SEQUENCE POINTER              */
         SLR   @07,@07                                             1084
         ST    @07,PRF1SEQP(,@09)                                  1084
*                                   /* SET UP QCB ADDRESS FOR TPOST  */
*   PRFQCBA=LCBMHA;                 /* ASSUME LCB POINTS TO PROPER 1085
*                                      MESSAGE HANDLER QCB   @YM06085*/
         MVC   PRFQCBA(3,RPRF),LCBMHA(RLCB)                        1085
*                                   /* SET UP REST OF BUFFER PREFIX  */
*   PRFLCB=RLCB;                    /* PLCB ADDRESS                  */
         STCM  RLCB,7,PRFLCB(RPRF)                                 1086
*   PRFSRCE=TNTSLU;                 /* SOURCE TNT INDEX              */
         LH    @09,TNTSLU                                          1087
         N     @09,@CF03378                                        1087
         STH   @09,PRFSRCE(,RPRF)                                  1087
*   PRFSTAT1=0;                     /* MARK AS HEADER, LAST          */
         MVI   PRFSTAT1(RPRF),X'00'                                1088
*                                   /* CLEAR UNUSED HEADER FIELDS    */
*   PRFXTRA=0;                      /*                               */
         STCM  @07,7,PRFXTRA(RPRF)                                 1089
*   PRFSCAN=0;                      /*                               */
         STH   @07,PRFSCAN(,RPRF)                                  1090
*   PRFNTXT=0;                      /*                               */
         STCM  @07,7,PRFNTXT(RPRF)                                 1091
*   PRFCRCD=0;                      /*                               */
         STCM  @07,7,PRFCRCD(RPRF)                                 1092
*   PRFNHDR=0;                      /*                               */
         STCM  @07,7,PRFNHDR(RPRF)                                 1093
*   PRFHQBCK=0;                     /*                               */
         STCM  @07,7,PRFHQBCK(RPRF)                                1094
*   PRFISEQ=0;                      /*                               */
         STH   @07,PRFISEQ(,RPRF)                                  1095
*   PRFDEST=0;                      /*                               */
         STH   @07,PRFDEST(,RPRF)                                  1096
*                                   /* SET ERROR STATUS BITS         */
*                                   /* SET UP PLCB FOR INPUT MH      */
*   LCBUSUE=ON;                     /* SET UNIT EXCEPTION            */
         OI    LCBUSUE(RLCB),B'00000001'                           1097
*   LCBSENDN=OFF;                   /* MARK THE PLCB                 */
*   LCBRECVN=ON;                    /* ... RECEIVING                 */
         OI    LCBRECVN(RLCB),B'00000010'                          1099
         NI    LCBSENDN(RLCB),B'11111110'                          1099
*   RPARM=RPRF;                     /* BUFFER ADDRESS FOR TPOST      */
         LR    RPARM,RPRF                                          1100
*   CALL DSPPOSTR;                  /* TPOST BUFFER TO MH            */
         LA    @15,DSPPOSTR(,RDISP)                                1101
         BALR  @14,@15                                             1101
*   END MHBUF;                      /* RETURN TO CALLER              */
@EL00028 DS    0H                                                  1102
@EF00028 DS    0H                                                  1102
@ER00028 L     @14,@SA00028                                        1102
         BR    @14                                                 1102
         EJECT
*NAMESRCH:                                                         1103
*   PROC OPTIONS(SAVE(R14));                                       1103
NAMESRCH ST    @14,@SA00029                                        1103
*   RFY                                                            1104
*     R15 RSTD;                                                    1104
*                                                                  1104
*/********************************************************************/
*/*                                                                  */
*/*      N A M E S R C H   SUBROUTINE                                */
*/*                                                                  */
*/********************************************************************/
*/*                                                                  */
*/*      THIS SUBROUTINE TAKES A PRIMARY LU (PLU) NAME AND           */
*/*      ATTEMPTS TO CONVERT IT INTO A TNT INDEX VALUE.  SINCE       */
*/*      THE PLU NAME MAY REPRESENT EITHER TCAM, A PARTICULAR MH,    */
*/*      OR A TPROCESS ENTRY, BOTH THE MH TABLE AND THE TERMINAL     */
*/*      NAME TABLE MAY HAVE TO BE SEARCHED.                         */
*/*                                                                  */
*/********************************************************************/
*                                                                  1105
*                                   /* LOOK FOR NAME IN MH TABLE     */
*   TNTCTR=SAVTMHDX;                /* TNT INDEX FOR 1ST MH TBL ENTRY*/
         L     @14,AVTSAVTP(,RAVT)                                 1105
         LH    @09,SAVTMHDX(,@14)                                  1105
         N     @09,@CF03378                                        1105
         STH   @09,TNTCTR                                          1105
*   CURRENT=SAVTMHTB;               /* ADDR OF 1ST MH TABLE ENTRY    */
         L     @14,SAVTMHTB(,@14)                                  1106
         ST    @14,CURRENT                                         1106
*   FOUNDSW=OFF;                                                   1107
         NI    FOUNDSW,B'10111111'                                 1107
*   DO WHILE(FOUNDSW=OFF&MHNAME(1:1)<MHFLGE);                      1108
         B     @DE01108                                            1108
@DL01108 DS    0H                                                  1109
*     IF MHNAME=NAMECON THEN        /* NAME MATCH FOUND              */
         L     @14,CURRENT                                         1109
         CLC   MHNAME(8,@14),NAMECON                               1109
         BNE   @RF01109                                            1109
*       FOUNDSW=ON;                 /* YES, MARK FOR EXIT FROM LOOP  */
         OI    FOUNDSW,B'01000000'                                 1110
*     ELSE                                                         1111
*       DO;                         /* NO, KEEP LOOKING              */
         B     @RC01109                                            1111
@RF01109 DS    0H                                                  1112
*         CURRENT=CURRENT+LENGTH(IEDMHTD);/* BUMP TO NEXT ENTRY      */
         LA    @14,12                                              1112
         AL    @14,CURRENT                                         1112
         ST    @14,CURRENT                                         1112
*         TNTCTR=TNTCTR+1;          /* INCREMENT TNT VALUE           */
         LH    @14,TNTCTR                                          1113
         LA    @14,1(,@14)                                         1113
         STH   @14,TNTCTR                                          1113
*       END;                                                       1114
*   END;                                                           1115
@RC01109 DS    0H                                                  1115
@DE01108 TM    FOUNDSW,B'01000000'                                 1115
         BNZ   @DC01108                                            1115
         L     @14,CURRENT                                         1115
         CLI   MHNAME(@14),X'FF'                                   1115
         BL    @DL01108                                            1115
@DC01108 DS    0H                                                  1116
*   IF FOUNDSW=OFF THEN             /* NO MATCH FOUND?               */
         TM    FOUNDSW,B'01000000'                                 1116
         BNZ   @RF01116                                            1116
*     DO;                           /* TRUE, SEARCH THE TRM NAME TBL */
*                                   /* SET UP PARAMETERS FOR IEDQA1  */
*       R0=TNTENLEN;                /* NAME LENGTH                   */
         L     @14,AVTRNMPT(,RAVT)                                 1118
         SLR   R0,R0                                               1118
         IC    R0,TNTENLEN(,@14)                                   1118
*       RPARM=ADDR(NAMECON);        /* ADDRESS OF NAME               */
         LA    RPARM,NAMECON                                       1119
*       R15=A1VCON;                 /* TNT-SEARCH RTN (IEDQA1) ADDR  */
         L     @09,AVTMSGS-1(,RAVT)                                1120
         L     R15,A1VCON(,@09)                                    1120
*       GEN(BAL  R14,4(R15));       /* SEARCH TERMINAL NAME TABLE    */
         BAL  R14,4(R15)
*       IF R15>0 THEN               /* WAS A MATCH FOUND?            */
         LTR   R15,R15                                             1122
         BNP   @RF01122                                            1122
*         DO;                       /* YES                           */
*           TNTCTR=R15;             /* SAVE TNT VALUE IN LOCAL FIELD */
         STH   R15,TNTCTR                                          1124
*           RPARM=R15;              /* TNT VALUE FOR PLU             */
         LR    RPARM,R15                                           1125
*           CALL IEDQTNT;           /* CONVERT IT TO TTE ADDRESS     */
         L     @15,AVTRNMPT(,RAVT)                                 1126
         BALR  @14,@15                                             1126
*           R0=TRMTPINM;            /* MASK FOR DEVICE DEPENDNT FIELD*/
         LA    R0,4                                                1127
*           CALL IEDQTL;            /* GET DEVICE DEPENDNT FIELD ADDR*/
         L     @15,AVTDDFT(,RAVT)                                  1128
         BALR  @14,@15                                             1128
*           IF R15>0&               /* FIELD FOUND? &                */
*               R15->PROLU=ON THEN  /* ... LU=YES SPEC'D ON TPROCESS?*/
         LTR   R15,R15                                             1129
         BNP   @RF01129                                            1129
         TM    PROLU(R15),B'01000000'                              1129
         BNO   @RF01129                                            1129
*             FOUNDSW=ON;           /* SET 'FOUND' INDICATOR         */
         OI    FOUNDSW,B'01000000'                                 1130
*         END;                                                     1131
*     END;                                                         1132
*   END NAMESRCH;                   /* RETURN TO CALLER              */
@EL00029 DS    0H                                                  1133
@EF00029 DS    0H                                                  1133
@ER00029 L     @14,@SA00029                                        1133
         BR    @14                                                 1133
*   RFY                                                            1134
*     R15 UNRSTD;                                                  1134
         EJECT
*NOSIBRTN:                                                         1135
*   PROC OPTIONS(SAVE(R14));                                       1135
*                                                                  1135
NOSIBRTN ST    @14,@SA00030                                        1135
*/********************************************************************/
*/*                                                                  */
*/*      N O S I B R T N   SUBROUTINE                                */
*/*                                                                  */
*/********************************************************************/
*/*                                                                  */
*/*      THIS SUBROUTINE PROCESSES AN INIT-SELF ERROR RESPONSE       */
*/*      PIU RECEIVED FROM THE SSCP.  SUCH A RESPONSE IS SENT        */
*/*      WHEN THE SSCP WAS UNABLE TO OBTAIN A SIB FOR AN             */
*/*      INTERNALLY-GENERATED INIT-SELF PIU.                         */
*/*                                                                  */
*/*      AFTER OBTAINING A PLCB THE SUBROUTINE CAUSES        @YM08450*/
*/*      AN ERROR BUFFER TO BE TPOSTED TO THE USER'S MH.     @YM08450*/
*/*                                                                  */
*/********************************************************************/
*                                                                  1136
*   IF QCBPLCBN=OFF THEN            /* DO WE NEED A PLCB?            */
         L     @09,IEDQQPTR                                        1136
         SL    @09,@CF00044                                        1136
         TM    QCBPLCBN(@09),B'10000000'                           1136
         BNZ   @RF01136                                            1136
*     DO;                           /* YES                           */
*       QCBNDXRQ=ON;                /* SPECIAL INDEXED REQUEST       */
         OI    QCBNDXRQ(@09),B'00000100'                           1138
*       CALL RQSTPLCB;              /* REQUEST A PLCB                */
         BAL   @14,RQSTPLCB                                        1139
*     END;                                                         1140
*   IF QCBPLCBN=OFF THEN            /* WAS OUR PLCB REQUEST QUEUED?  */
@RF01136 L     @09,IEDQQPTR                                        1141
         AL    @09,@CF03385                                        1141
         TM    QCBPLCBN-4(@09),B'10000000'                         1141
         BNZ   @RF01141                                            1141
*     DO;                           /* YES, WE'LL GET PLCB LATER     */
*       PRFLINK=SAVTLUSP;           /* ADD INIT-SELF PIU'S           */
         L     @09,AVTSAVTP(,RAVT)                                 1143
         MVC   PRFLINK(3,RPRF),SAVTLUSP+1(@09)                     1143
*       SAVTLUSP=RPRF;              /* ... AT TOP OF CHAIN           */
         ST    RPRF,SAVTLUSP(,@09)                                 1144
*     END;                                                         1145
*   ELSE                            /* WE HAVE A PLCB ASSIGNED       */
*     DO;                                                          1146
         B     @RC01141                                            1146
@RF01141 DS    0H                                                  1147
*       QCBNDXRQ=OFF;               /* RESET INDEXED-REQUEST FLAG    */
         L     @09,IEDQQPTR                                        1147
         AL    @09,@CF03385                                        1147
         NI    QCBNDXRQ-4(@09),B'11111011'                         1147
*       IF TTHDAF>SAVTMHDX THEN     /* IF IN SESSION WITH A MESSAGE
*                                      HANDLER, GET MH QCB   @YM06085*/
         L     @09,AVTSAVTP(,RAVT)                                 1148
         CLC   TTHDAF(2,RPIU),SAVTMHDX(@09)                        1148
         BNH   @RF01148                                            1148
*         DO;                       /*                       @YM06085*/
*           RPARM=((TTHDAF-SAVTMHDX)*LENGTH(IEDMHTD))+SAVTMHTB;/* GET
*                                      MH TABLE ENTRY        @YM06085*/
         SLR   RPARM,RPARM                                         1150
         ICM   RPARM,3,TTHDAF(RPIU)                                1150
         LH    @07,SAVTMHDX(,@09)                                  1150
         N     @07,@CF03378                                        1150
         SLR   RPARM,@07                                           1150
         MH    RPARM,@CH00244                                      1150
         AL    RPARM,SAVTMHTB(,@09)                                1150
*           LCBMHA=RPARM->MHENTRY;  /* SET MH QCB ADDRESS    @YM06085*/
         MVC   LCBMHA(3,RLCB),MHENTRY+1(RPARM)                     1151
*         END;                      /*                       @YM06085*/
*       CALL ERRORPST;              /* CAUSE ERROR BUFFER TPOST TO 1153
*                                      USER'S MH             @YM08450*/
@RF01148 BAL   @14,ERRORPST                                        1153
*     END;                                                         1154
*   END NOSIBRTN;                   /* RETURN TO CALLER              */
@EL00030 DS    0H                                                  1155
@EF00030 DS    0H                                                  1155
@ER00030 L     @14,@SA00030                                        1155
         BR    @14                                                 1155
         EJECT
*PIURTN:                                                           1156
*   PROC OPTIONS(SAVE(R14));                                       1156
*                                                                  1156
PIURTN   ST    @14,@SA00031                                        1156
*/********************************************************************/
*/*                                                                  */
*/*      P I U R T N   SUBROUTINE                                    */
*/*                                                                  */
*/********************************************************************/
*/*                                                                  */
*/*      THIS SUBROUTINE DOES PRELIMINARY PROCESSING OF ALL          */
*/*      INPUT PIUS.                                                 */
*/*                                                                  */
*/********************************************************************/
*                                                                  1157
*                                   /* SET UP BUFFER & PIU REGISTERS */
*   RPRF=RPARM;                     /* BUFFER ADDRESS                */
         LR    RPRF,RPARM                                          1157
*   RPIU=ADDR(PRFPIUO)+PRFPIUO;     /* PIU ADDRESS                   */
         LA    RPIU,PRFPIUO(,RPRF)                                 1158
         SLR   @09,@09                                             1158
         IC    @09,PRFPIUO(,RPRF)                                  1158
         ALR   RPIU,@09                                            1158
*                                   /* SAVE IN CORE POINTERS         */
*   INPUTBUF=RPRF;                  /* BUFFER ADDRESS                */
         ST    RPRF,INPUTBUF                                       1159
*   INPUTPIU=RPIU;                  /* PIU ADDRESS                   */
         ST    RPIU,INPUTPIU                                       1160
*                                   /* SET UP ADDRESS OF REQUEST CODE*/
*   DATAPTR=ADDR(PIURU);            /* ADDR OF 1ST BYTE OF RU        */
         LA    @09,PIURU(,RPIU)                                    1161
         ST    @09,DATAPTR                                         1161
*   IF TRHSDI=ON THEN               /* IS SENSE DATA INCLUDED?       */
         TM    TRHSDI+10(RPIU),B'00000100'                         1162
         BNO   @RF01162                                            1162
*     DATAPTR=DATAPTR+LENGTH(IEDSNSD);/* YES, BUMP PAST SENSE DATA   */
         AL    @09,@CF00255                                        1163
         ST    @09,DATAPTR                                         1163
*                                   /* DETERMINE PIU TYPE            */
*   IF TRHRUCAT=TRHSC THEN          /* SESSION CONTROL RU?           */
@RF01162 TM    TRHRUCAT+10(RPIU),B'01100000'                       1164
         BNO   @RF01164                                            1164
*     DO;                           /* YES                           */
*       TNTSLU=TTHOAF;              /* GET SLU'S TNT INDEX           */
         MVC   TNTSLU(2),TTHOAF(RPIU)                              1166
*       CALL CTLBLKS;               /* SET UP CONTROL BLOCK POINTERS */
         BAL   @14,CTLBLKS                                         1167
*       IF DATAPTR->CHAR1=CD1BIND×  /* BIND? OR                      */
*           DATAPTR->CHAR1=CD1SDT THEN/* ... SDT?                    */
         L     @09,DATAPTR                                         1168
         CLI   CHAR1(@09),X'31'                                    1168
         BE    @RT01168                                            1168
         CLI   CHAR1(@09),X'A0'                                    1168
         BNE   @RF01168                                            1168
@RT01168 DS    0H                                                  1169
*         CALL ENDLGON;             /* YES, FINISH LOGON PROCESSING  */
         BAL   @14,ENDLGON                                         1169
*       ELSE                        /* NO, MUST BE UNBIND RESPONSE   */
*         CALL ENDLGOFF;            /* FINISH LOGOFF PROCESSING      */
         B     @RC01168                                            1170
@RF01168 BAL   @14,ENDLGOFF                                        1170
*     END;                                                         1171
*   ELSE                            /* NETWORK SERVICES RU           */
*     DO;                                                          1172
         B     @RC01164                                            1172
@RF01164 DS    0H                                                  1173
*       TNTSLU=TTHTAG;              /* GET SLU'S TNT INDEX           */
         MVC   TNTSLU(2),TTHTAG(RPIU)                              1173
*       CALL CTLBLKS;               /* SET UP CONTROL BLOCK POINTERS */
         BAL   @14,CTLBLKS                                         1174
*       IF DATAPTR->CHAR3=CD1XCIN THEN                             1175
         L     @09,DATAPTR                                         1175
         CLC   CHAR3(3,@09),@CB00753                               1175
         BNE   @RF01175                                            1175
*         CALL CINITRTN;            /* CINIT (REQUEST)               */
         BAL   @14,CINITRTN                                        1176
*       ELSE                                                       1177
*         IF DATAPTR->CHAR3=CD1XCTM THEN                           1177
         B     @RC01175                                            1177
@RF01175 L     @09,DATAPTR                                         1177
         CLC   CHAR3(3,@09),@CB00755                               1177
         BNE   @RF01177                                            1177
*           CALL CTERMRTN;          /* CTERM (REQUEST)               */
         BAL   @14,CTERMRTN                                        1178
*         ELSE                                                     1179
*           CALL NOSIBRTN;          /* INIT-SELF (RESPONSE)          */
         B     @RC01177                                            1179
@RF01177 BAL   @14,NOSIBRTN                                        1179
*     END;                                                         1180
*   END PIURTN;                     /* RETURN TO CALLER              */
@EL00031 DS    0H                                                  1181
@EF00031 DS    0H                                                  1181
@ER00031 L     @14,@SA00031                                        1181
         BR    @14                                                 1181
         EJECT
*PLCBRTN:                                                          1182
*   PROC OPTIONS(SAVE(R14));                                       1182
*                                                                  1182
PLCBRTN  ST    @14,@SA00032                                        1182
*/********************************************************************/
*/*                                                                  */
*/*      P L C B R T N   SUBROUTINE                                  */
*/*                                                                  */
*/********************************************************************/
*/*                                                                  */
*/*      THIS SUBROUTINE PROCESSES INPUT PLCBS.                      */
*/*                                                                  */
*/*      IF NO ELEMENT IS ENQUEUED WAITING FOR THIS PLCB, THE        */
*/*      PROCESSING IS DETERMINED BY CHECKING THE SESSION STATE.     */
*/*                                                                  */
*/*      IF A PIU'S BUFFER IS ENQUEUED WAITING FOR THE PLCB,         */
*/*      DEQUEUE THE WAITING PIU BUFFER, AND CALL THE SAME           */
*/*      SUBROUTINE WHICH ORIGINALLY REQUESTED THE PLCB.             */
*/*                                                                  */
*/********************************************************************/
*                                                                  1183
*   RLCB=RPARM;                     /* PLCB ADDRESS                  */
         LR    RLCB,RPARM                                          1183
*   TNTSLU=LCBTTCIN;                /* SLU'S TNT INDEX               */
         LH    @09,LCBTTCIN(,RLCB)                                 1184
         N     @09,@CF03378                                        1184
         STH   @09,TNTSLU                                          1184
*   CALL CTLBLKS;                   /* SET UP CONTROL BLOCK POINTERS */
         BAL   @14,CTLBLKS                                         1185
*                                   /* SEE IF A PIU IS ENQUEUED    1186
*                                      WAITING FOR THIS PLCB         */
*   IF QCBNDXRQ=OFF THEN            /* NO PIU ENQUEUED?              */
         L     @09,IEDQQPTR                                        1186
         AL    @09,@CF03385                                        1186
         TM    QCBNDXRQ-4(@09),B'00000100'                         1186
         BNZ   @RF01186                                            1186
*     DO;                           /* TRUE, CHECK SESSION STATE     */
*       IF SIBPTR>0 THEN            /* DO WE HAVE AN LU-LU SIB?      */
         L     @09,SIBPTR                                          1188
         LTR   @09,@09                                             1188
         BNP   @RF01188                                            1188
*         DO;                       /* YES                           */
*           IF SIBSSTAT=SIBSACTV THEN/* SESSION STATE = 'ACTIVE'?    */
         TM    SIBSSTAT(@09),B'00011100'                           1190
         BNO   @RF01190                                            1190
*             DO;                   /* YES                           */
*               IF SIBLGOFF=ON THEN /* LOGOFF BIT SET?               */
         TM    SIBLGOFF(@09),B'10000000'                           1192
         BNO   @RF01192                                            1192
*                 CALL LGOFF;       /* YES, BEGIN LOGOFF PROCESSING  */
         BAL   @14,LGOFF                                           1193
*               ELSE                                               1194
*                 DO;               /* NO                            */
         B     @RC01192                                            1194
@RF01192 DS    0H                                                  1195
*                   SIBLGOFF=ON;    /* SET LOGOFF BIT                */
         L     @09,SIBPTR                                          1195
         OI    SIBLGOFF(@09),B'10000000'                           1195
*                   LCBQCBA=RLCB;   /* TPOST PLCB TO ITSELF          */
         STCM  RLCB,7,LCBQCBA(RLCB)                                1196
*                   LCBPRI=PRILNFRE;/* ... TO LET SCHEDULERS 'SEE'   */
         MVI   LCBPRI(RLCB),X'E0'                                  1197
*                   RPARM=RLCB;     /* ... THE LOGOFF BIT (THIS LETS */
         LR    RPARM,RLCB                                          1198
*                   CALL DSPPOSTR;  /* ... TSO SESSIONS BE ENDED     */
         LA    @15,DSPPOSTR(,RDISP)                                1199
         BALR  @14,@15                                             1199
*                 END;              /* ... PROPERLY BEFORE LOGOFF)   */
*             END;                                                 1201
*           ELSE                    /* NO                            */
*             CALL BINDFAIL;        /* FINISH BIND-FAILED PROCESSING */
         B     @RC01190                                            1202
@RF01190 BAL   @14,BINDFAIL                                        1202
*         END;                                                     1203
*       ELSE                        /* NO LU-LU SIB FOR THIS SLU     */
*         CALL ENDNOSIB;            /* FINISH NO-SIB ERROR PROCESSING*/
         B     @RC01188                                            1204
@RF01188 BAL   @14,ENDNOSIB                                        1204
*     END;                                                         1205
         EJECT
*   ELSE                            /* PIU WAITING FOR THIS PLCB     */
*     DO;                                                          1206
         B     @RC01186                                            1206
@RF01186 DS    0H                                                  1207
*       QCBNDXRQ=OFF;               /* TURN OFF INDEXED-REQUEST FLAG */
         L     @09,IEDQQPTR                                        1207
         AL    @09,@CF03385                                        1207
         NI    QCBNDXRQ-4(@09),B'11111011'                         1207
*       PREVIOUS=ADDR(SAVTLUSP)-LINKOFFS;/* INITIALIZE FOR           */
         L     @09,AVTSAVTP(,RAVT)                                 1208
         LA    @07,SAVTLUSP(,@09)                                  1208
         SLR   @05,@05                                             1208
         IC    @05,LINKOFFS                                        1208
         SLR   @07,@05                                             1208
         ST    @07,PREVIOUS                                        1208
*       RPRF=SAVTLUSP;              /* ... SEARCH                    */
         L     RPRF,SAVTLUSP(,@09)                                 1209
*       FOUNDSW=OFF;                /* ... LOOP                      */
         NI    FOUNDSW,B'10111111'                                 1210
*       DO UNTIL(FOUNDSW=ON);       /* FIND & DELINK THE WAITING PIU */
@DL01211 DS    0H                                                  1212
*         RPIU=ADDR(PRFPIUO)+PRFPIUO;/* CURRENT PIU IN CHAIN         */
         LA    RPIU,PRFPIUO(,RPRF)                                 1212
         SLR   @09,@09                                             1212
         IC    @09,PRFPIUO(,RPRF)                                  1212
         ALR   RPIU,@09                                            1212
*         IF TTHTAG=TNTSLU THEN     /* IS PIU FOR THIS SLU?          */
         CLC   TTHTAG(2,RPIU),TNTSLU                               1213
         BNE   @RF01213                                            1213
*           DO;                     /* YES, DELINK & SET FOUND SWITCH*/
*             FOUNDSW=ON;                                          1215
         OI    FOUNDSW,B'01000000'                                 1215
*             PREVIOUS->PRFLINK=PRFLINK;                           1216
         L     @09,PREVIOUS                                        1216
         MVC   PRFLINK(3,@09),PRFLINK(RPRF)                        1216
*           END;                                                   1217
*         ELSE                      /* NO MATCH FOUND YET            */
*           DO;                     /* BUMP TO NEXT ELEMENT ON CHAIN */
         B     @RC01213                                            1218
@RF01213 DS    0H                                                  1219
*             PREVIOUS=RPRF;                                       1219
         ST    RPRF,PREVIOUS                                       1219
*             RPRF=PRFLINK;                                        1220
         L     @09,PRFLINK-1(,RPRF)                                1220
         LA    @09,0(,@09)                                         1220
         LR    RPRF,@09                                            1220
*           END;                                                   1221
*       END;                                                       1222
@RC01213 DS    0H                                                  1222
@DE01211 TM    FOUNDSW,B'01000000'                                 1222
         BNO   @DL01211                                            1222
*       INPUTBUF=RPRF;              /* PIU'S BUFFER ADDRESS          */
         ST    RPRF,INPUTBUF                                       1223
*       INPUTPIU=RPIU;              /* START OF PIU                  */
         ST    RPIU,INPUTPIU                                       1224
*                                   /* REPROCESS THE WAITING PIU     */
*       IF TRHTYPE=OFF THEN         /* IS PIU A REQUEST?             */
         TM    TRHTYPE+10(RPIU),B'10000000'                        1225
         BNZ   @RF01225                                            1225
*         CALL CINITRTN;            /* YES, MUST BE A CINIT          */
         BAL   @14,CINITRTN                                        1226
*       ELSE                        /* NO, IT'S A RESPONSE           */
*         CALL NOSIBRTN;            /* MUST BE AN INIT-SELF          */
         B     @RC01225                                            1227
@RF01225 BAL   @14,NOSIBRTN                                        1227
*     END;                                                         1228
*   END PLCBRTN;                    /* RETURN TO CALLER              */
@EL00032 DS    0H                                                  1229
@EF00032 DS    0H                                                  1229
@ER00032 L     @14,@SA00032                                        1229
         BR    @14                                                 1229
         EJECT
*PRMLGOFF:                                                         1230
*   PROC OPTIONS(SAVE(R14));                                       1230
*                                                                  1230
PRMLGOFF ST    @14,@SA00033                                        1230
*/********************************************************************/
*/*                                                                  */
*/*      P R M L G O F F   SUBROUTINE                                */
*/*                                                                  */
*/********************************************************************/
*/*                                                                  */
*/*      THIS SUBROUTINE 'PRIMES' LOGOFF PROCESSING FOR AN LU-LU     */
*/*      SESSION.  THE LOGOFF BIT OR THE SHUTDOWN COMPLETE   @YM09036*/
*/*      BIT HAS ALREADY BEEN SET, AND THE CURRENT STATE OF  @YM09036*/
*/*      THE PLCB WILL BE DETERMINED.                        @YM09036*/
*/*                                                                  */
*/*      .  IF THE PLCB IS BUSY, NO FURTHER PROCESSING TAKES PLACE   */
*/*         NOW.  THE LOGOFF OR SHUTDOWN-COMPLETE BIT WILL   @YM09036*/
*/*         CAUSE THE PLCB TO BE TPOSTED TO THIS MODULE LATER WHEN   */
*/*         CURRENT OPERATIONS ARE COMPLETE.                         */
*/*                                                                  */
*/*      .  IF A NON-BUSY PLCB CAN BE OBTAINED IMMEDIATELY, THE      */
*/*         LOGOFF SUBROUTINE IS CALLED.                             */
*/*                                                                  */
*/*      .  OTHERWISE A PLCB IS REQUESTED.  WHEN THE REQUEST IS      */
*/*         SATISFIED THE LOGOFF OR SHUTDOWN-COMPLETE BIT    @YM09036*/
*/*         WILL CAUSE THE PLCB TO BE TPOSTED TO THIS MODULE.        */
*/*                                                                  */
*/********************************************************************/
*                                                                  1231
*   IF QCBPLCBN=ON THEN             /* IS A PLCB ASSIGNED TO SLU?    */
         L     @09,IEDQQPTR                                        1231
         AL    @09,@CF03385                                        1231
         TM    QCBPLCBN-4(@09),B'10000000'                         1231
         BNO   @RF01231                                            1231
*     DO;                           /* YES                           */
*       IF TRMINPTP=ON THEN         /* IS IT WAITING FOR INPUT?      */
         TM    TRMINPTP(RTRM),B'01000000'                          1233
         BNO   @RF01233                                            1233
*         DO;                       /* YES                           */
*           TRMINPTP=OFF;           /* TURN OFF INPUT-PENDING BIT    */
         NI    TRMINPTP(RTRM),B'10111111'                          1235
*           CALL LGOFF;             /* BEGIN LOGOFF PROCESSING       */
         BAL   @14,LGOFF                                           1236
*         END;                                                     1237
*       ELSE                        /* NO                    @YM08991*/
*         BUSYSW=ON;                /* INDICATE PLCB IS BUSY @YM08991*/
         B     @RC01233                                            1238
@RF01233 OI    BUSYSW,B'00010000'                                  1238
*     END;                                                         1239
*   ELSE                            /* NO PLCB CURRENTLY ASSIGNED    */
*     DO;                                                          1240
         B     @RC01231                                            1240
@RF01231 DS    0H                                                  1241
*       IF QCBRCVRQ=OFF THEN        /* HAS A PLCB BEEN REQUESTED?    */
         L     @09,IEDQQPTR                                        1241
         AL    @09,@CF03385                                        1241
         TM    QCBRCVRQ-4(@09),B'00010000'                         1241
         BNZ   @RF01241                                            1241
*         DO;                       /* NO                            */
*           CALL RQSTPLCB;          /* REQUEST A PLCB                */
         BAL   @14,RQSTPLCB                                        1243
*           IF R15>0 THEN           /* DID WE GET ONE?       @YM05705*/
         LTR   R15,R15                                             1244
         BNP   @RF01244                                            1244
*             DO;                   /* YES                           */
*               LCBQCBA=RLCB;       /* TPOST THE PLCB TO ITSELF      */
         STCM  RLCB,7,LCBQCBA(RLCB)                                1246
*               LCBPRI=PRILNFRE;    /* ... TO DRIVE THE              */
         MVI   LCBPRI(RLCB),X'E0'                                  1247
*               RPARM=RLCB;         /* ... RECEIVE                   */
         LR    RPARM,RLCB                                          1248
*               CALL DSPPOSTR;      /* ... SCHEDULER                 */
         LA    @15,DSPPOSTR(,RDISP)                                1249
         BALR  @14,@15                                             1249
*             END;                                                 1250
*         END;                                                     1251
*     END;                                                         1252
*   END PRMLGOFF;                   /* RETURN TO CALLER              */
@EL00033 DS    0H                                                  1253
@EF00033 DS    0H                                                  1253
@ER00033 L     @14,@SA00033                                        1253
         BR    @14                                                 1253
         EJECT
*QCBRTN:                                                           1254
*   PROC OPTIONS(SAVE(R14));                                       1254
*                                                                  1254
QCBRTN   ST    @14,@SA00034                                        1254
*/********************************************************************/
*/*                                                                  */
*/*      Q C B R T N   SUBROUTINE                                    */
*/*                                                                  */
*/********************************************************************/
*/*                                                                  */
*/*      THIS SUBROUTINE PROCESSES A DESTINATION QCB TPOSTED TO      */
*/*      IEDLUS AS INPUT.  THE SUBROUTINE IS ENTERED TWICE.          */
*/*                                                                  */
*/*      1ST ENTRY (CALLED FROM MAIN SEGMENT):                       */
*/*         .  REQUESTS A BUFFER.                                    */
*/*                                                                  */
*/*      2ND ENTRY (CALLED FROM ERBRTNI):                            */
*/*         .  BUILDS AN INIT-SELF PIU & TPOSTS IT TO THE SSCP       */
*/*            TO REQUEST THE STARTING OF AN LU-LU SESSION.          */
*/*                                                                  */
*/********************************************************************/
*                                                                  1255
*   QCBPTR=RPARM;                   /* QCB ADDRESS                   */
         ST    RPARM,QCBPTR                                        1255
*   IF QCBPLCBN=ON THEN             /* IF PLCB ADDRESS THEN  @XM05703*/
         L     @09,IEDQQPTR                                        1256
         SL    @09,@CF00044                                        1256
         TM    QCBPLCBN(@09),B'10000000'                           1256
         BNO   @RF01256                                            1256
*     TNTSLU=QCBPLCBA->LCBTTCIN;    /* GET SLU TNT FROM LCB  @XM05703*/
         L     @09,QCBPLCBA-1(,@09)                                1257
         LH    @09,LCBTTCIN(,@09)                                  1257
         N     @09,@CF03378                                        1257
         STH   @09,TNTSLU                                          1257
*   ELSE                                                           1258
*     IF QCBWAITC=ON THEN           /* IF CHAIN OF PIUS THEN @XM05703*/
         B     @RC01256                                            1258
@RF01256 L     @09,IEDQQPTR                                        1258
         SL    @09,@CF00044                                        1258
         TM    QCBWAITC(@09),B'01000000'                           1258
         BNO   @RF01258                                            1258
*       DO;                         /*                       @XM05703*/
*         RPARM=QCBPLCBA;           /* GET FIRST PIU         @XM05703*/
         L     RPARM,QCBPLCBA-1(,@09)                              1260
         LA    RPARM,0(,RPARM)                                     1260
*         RFY                                                      1261
*           IEDQPRF BASED(RPARM);   /*                       @XM05703*/
*         RPARM=ADDR(PRFPIUO)+PRFPIUO;/* GET TH              @XM05703*/
         LA    @09,PRFPIUO(,RPARM)                                 1262
         SLR   @07,@07                                             1262
         IC    @07,PRFPIUO(,RPARM)                                 1262
         ALR   @09,@07                                             1262
         LR    RPARM,@09                                           1262
*         TNTSLU=RPARM->TTHOAF;     /* GET SLU TNT FROM PIU  @XM05703*/
         MVC   TNTSLU(2),TTHOAF(RPARM)                             1263
*         RFY                                                      1264
*           IEDQPRF BASED(RPRF);    /*                       @XM05703*/
*       END;                        /*                       @XM05703*/
*     ELSE                                                         1266
*       TNTSLU=QCBTTCIN;            /* ELSE QCB HAS SLU TNT  @XM05703*/
         B     @RC01258                                            1266
@RF01258 L     @09,IEDQQPTR                                        1266
         BCTR  @09,0                                               1266
         BCTR  @09,0                                               1266
         LH    @09,QCBTTCIN-6(,@09)                                1266
         STH   @09,TNTSLU                                          1266
*   CALL CTLBLKS;                   /* SET UP CONTROL BLOCK POINTERS */
@RC01258 DS    0H                                                  1267
@RC01256 BAL   @14,CTLBLKS                                         1267
*   IF BUFPTR=0 THEN                /* DO WE NEED TO GET A BUFFER?   */
         L     @09,BUFPTR                                          1268
         LTR   @09,@09                                             1268
         BNZ   @RF01268                                            1268
*     DO;                           /* YES                           */
*       RPARMF=LENGTH(PIUTH)+LENGTH(PIURH)+LENGTH(IEDXINSD)+LENGTH(
*           PRFPIUO);               /* CALC NUMBER OF BYTES IN PIU   */
         LA    RPARMF,39                                           1270
*       CALL UNITCNT;               /* CONVERT TO UNIT COUNT (IN R0) */
         BAL   @14,UNITCNT                                         1271
*       RPARM=QCBPTR;               /* ADDR OF ELEMENT NEEDING BUFFER*/
         L     RPARM,QCBPTR                                        1272
*       CALL GETBUFI;               /* REQUEST A BUFFER              */
         BAL   @14,GETBUFI                                         1273
*     END;                                                         1274
*   ELSE                            /* WE ALREADY HAVE A BUFFER      */
*     DO;                                                          1275
         B     @RC01268                                            1275
@RF01268 DS    0H                                                  1276
*       RPRF=BUFPTR;                /* GET BUFFER ADDRESS            */
         L     RPRF,BUFPTR                                         1276
*       BUFPTR=0;                   /* CLEAR THE POINTER             */
         SLR   @09,@09                                             1277
         ST    @09,BUFPTR                                          1277
*       CALL BLDINITS;              /* BUILD & TPOST INIT-SELF PIU   */
         BAL   @14,BLDINITS                                        1278
*     END;                                                         1279
*   END QCBRTN;                     /* RETURN TO CALLER              */
@EL00034 DS    0H                                                  1280
@EF00034 DS    0H                                                  1280
@ER00034 L     @14,@SA00034                                        1280
         BR    @14                                                 1280
         EJECT
*RQSTPLCB:                                                         1281
*   PROC OPTIONS(SAVE(R14));                                       1281
*                                                                  1281
RQSTPLCB ST    @14,@SA00035                                        1281
*/********************************************************************/
*/*                                                                  */
*/*      R Q S T P L C B   SUBROUTINE                                */
*/*                                                                  */
*/********************************************************************/
*/*                                                                  */
*/*      THIS SUBROUTINE REQUESTS A PLCB FROM THE PLCB-POOL          */
*/*      MANAGER.                                                    */
*/*                                                                  */
*/********************************************************************/
*                                                                  1282
*   QCBRCVRQ=ON;                    /* PLCB-REQUESTED BIT            */
         L     @09,IEDQQPTR                                        1282
         SL    @09,@CF00044                                        1282
         OI    QCBRCVRQ(@09),B'00010000'                           1282
*                                   /* SET PARAMETERS FOR POOL MGR   */
*   RPARM=QCBPTR;                   /* REQUEST ELEMENT ADDRESS       */
         L     RPARM,QCBPTR                                        1283
*   IF QCBNDXRQ=ON THEN             /* SPECIAL INDEXED REQUEST       */
         TM    QCBNDXRQ(@09),B'00000100'                           1284
         BNO   @RF01284                                            1284
*     R0=LUSNDX;                    /* YES, SET INDEX FOR POOL MGR 1285
*                                      (CAUSES PLCB TPOST TO IEDLUS) */
         LA    R0,1                                                1285
*   CALL IEDIAP01;                  /* REQUEST A PLCB                */
@RF01284 L     @09,AVTSAVTP(,RAVT)                                 1286
         L     @15,SAVTPREQ(,@09)                                  1286
         BALR  @14,@15                                             1286
*   IF R15>0 THEN                   /* GOOD RETURN CODE?             */
         LTR   R15,R15                                             1287
         BNP   @RF01287                                            1287
*     DO;                           /* YES, PLCB HAS BEEN ASSIGNED   */
*       RLCB=R15;                   /* SET UP PLCB ADDRESS POINTER   */
         LR    RLCB,R15                                            1289
*       TRMINPTP=OFF;               /* TURN OFF INPUT-PENDING FLAG   */
         NI    TRMINPTP(RTRM),B'10111111'                          1290
*     END;                                                         1291
*   END RQSTPLCB;                   /* RETURN TO CALLER              */
@EL00035 DS    0H                                                  1292
@EF00035 DS    0H                                                  1292
@ER00035 L     @14,@SA00035                                        1292
         BR    @14                                                 1292
         EJECT
*RUINITS:                                                          1293
*   PROC OPTIONS(SAVE(R14));                                       1293
*                                                                  1293
RUINITS  ST    @14,@SA00036                                        1293
*/********************************************************************/
*/*                                                                  */
*/*      R U I N I T S   SUBROUTINE                                  */
*/*                                                                  */
*/********************************************************************/
*/*                                                                  */
*/*      THIS SUBROUTINE BUILDS THE RU FOR AN INIT-SELF PIU.         */
*/*      THE RU IS BUILT IN A CONTIGUOUS CORE AREA, THEN MOVED       */
*/*      INTO THE PIU'S BUFFER.                                      */
*/*                                                                  */
*/********************************************************************/
*                                                                  1294
*   XINSMODE=BLANKS;                /* DEFAULT MODE NAME             */
         MVC   XINSMODE(8),@CC03119                                1294
*   TCXPTR=CVTAQAVT;                /* GET TCX ADDRESS       @YM08096*/
         L     @09,CVTPTR                                          1295
         L     TCXPTR,CVTAQAVT(,@09)                               1295
*   IF(QCBTTCIN>TNTLEN)&            /* CHECK FOR TOTE ENTRY  @YM08096*/
*       (QCBTTCIN=<TNTLEN+TCXTOTE) THEN                            1296
         L     @09,IEDQQPTR                                        1296
         BCTR  @09,0                                               1296
         BCTR  @09,0                                               1296
         LH    @09,QCBTTCIN-6(,@09)                                1296
         L     @07,AVTRNMPT(,RAVT)                                 1296
         LH    @07,TNTLEN(,@07)                                    1296
         N     @07,@CF03378                                        1296
         CR    @09,@07                                             1296
         BNH   @RF01296                                            1296
         SLR   @03,@03                                             1296
         IC    @03,TCXTOTE(,TCXPTR)                                1296
         ALR   @07,@03                                             1296
         CR    @09,@07                                             1296
         BH    @RF01296                                            1296
*     DO;                           /*                       @YM08096*/
*       RPARM=AVTCSTCS+(TRMCHCIN-1)*AVTDCTLN;/* DCT ADDRESS  @YM08096*/
         SLR   @15,@15                                             1298
         IC    @15,TRMCHCIN(,RTRM)                                 1298
         BCTR  @15,0                                               1298
         MH    @15,AVTDCTLN(,RAVT)                                 1298
         AL    @15,AVTCSTCS(,RAVT)                                 1298
         LR    RPARM,@15                                           1298
*       RFY                                                        1299
*         IEDDCT BASED(RPARM);                                     1299
*       IF DCTL3270=ON THEN         /* CHECK FOR 3270 LUNT   @YM08096*/
         TM    DCTL3270(RPARM),B'01000000'                         1300
         BNO   @RF01300                                            1300
*         XINSMODE=IEDTOTB2;        /* SET MODE NAME FOR 3270@YM08096*/
         MVC   XINSMODE(8),@CC03117                                1301
*       ELSE                                                       1302
*         XINSMODE=IEDTOTB1;        /* SET ^3270 MODE NAME   @YM08096*/
         B     @RC01300                                            1302
@RF01300 MVC   XINSMODE(8),@CC03115                                1302
*     END;                          /* END TOTE CHECK        @YM08096*/
*   ELSE                                                           1304
*     DO;                           /* DO NORMAL PROCESSING  @YM08096*/
         B     @RC01296                                            1304
@RF01296 DS    0H                                                  1305
*       R0=ADDR(LMODECON);          /* ADDR OF 'IEDLMODE' CONSTANT   */
         LA    R0,@CC03113                                         1305
*       RPARM=ADDR(IEDQTRM);        /* SLU'S TERMINAL ENTRY ADDRESS  */
         LA    RPARM,IEDQTRM(,RTRM)                                1306
*       CALL IEDOPTN;               /* FIND IEDLMODE OPTION FIELD    */
         L     @15,AVTOPTN(,RAVT)                                  1307
         BALR  @14,@15                                             1307
*       IF R15=0 THEN               /* OPTION FIELD FOUND?           */
         LTR   R15,R15                                             1308
         BNZ   @RF01308                                            1308
*         DO;                       /* YES                           */
*           IF R0>LENGTH(XINSMODE) THEN/* OPTION FIELD TOO LONG?     */
         LA    @09,8                                               1310
         CR    R0,@09                                              1310
         BNH   @RF01310                                            1310
*             R0=LENGTH(XINSMODE);  /* YES, TRUNCATE IT              */
         LR    R0,@09                                              1311
*           XINSMODE(1:R0)=RPARM->CHAR8(1:R0);/* GET MODE NAME       */
@RF01310 LR    @09,R0                                              1312
         BCTR  @09,0                                               1312
         EX    @09,@SM03398                                        1312
*         END;                                                     1313
*                                   /* GET SLU'S NETWORK NAME        */
*       TNTCTR=TNTSLU-1;            /* NO. OF ENTRIES FROM TBL START */
@RF01308 LH    @09,TNTSLU                                          1314
         N     @09,@CF03378                                        1314
         BCTR  @09,0                                               1314
         STH   @09,TNTCTR                                          1314
*       ENTRYSZ=TNTENLEN+3;         /* SIZE OF EACH TABLE ENTRY      */
         L     @07,AVTRNMPT(,RAVT)                                 1315
         SLR   @05,@05                                             1315
         IC    @05,TNTENLEN(,@07)                                  1315
         LA    ENTRYSZ,3(,@05)                                     1315
*       CURRENT=ADDR(TNTFIRST);     /* ADDRESS OF START OF TABLE     */
         AL    @07,@CF03369                                        1316
         ST    @07,CURRENT                                         1316
*       RPARM=CURRENT+(TNTCTR*ENTRYSZ);/* CALULATE ENTRY ADDRESS     */
         LR    @15,@09                                             1317
         MR    @14,ENTRYSZ                                         1317
         ALR   @07,@15                                             1317
         LR    RPARM,@07                                           1317
*       XINSNAME=BLANKS;            /* SET UP SLU-NAME FIELD         */
         MVC   XINSNAME(8),@CC03119                                1318
*       XINSNAME(1:TNTENLEN)=RPARM->CHAR8(1:TNTENLEN);             1319
         BCTR  @05,0                                               1319
         EX    @05,@SM03400                                        1319
*                                   /* MOVE IN INIT-SELF RU DATA     */
*     END;                          /*                       @YM08096*/
*   RPARM=ADDR(PLMVPARM);           /* PARAMETER LIST ADDRESS        */
@RC01296 LA    RPARM,PLMVPARM                                      1321
*   PLMVTU=RPRF;                    /* TARGET UNIT ADDR              */
         ST    RPRF,PLMVTU(,RPARM)                                 1322
*   PLMVTD=ADDR(PIURU);             /* TARGET DATA ADDR              */
         LA    @09,PIURU(,RPIU)                                    1323
         ST    @09,PLMVTD(,RPARM)                                  1323
*   PLMVSU=ADDR(IEDXINSD);          /* SOURCE 'UNIT' ADDR            */
         LA    @09,IEDXINSD                                        1324
         ST    @09,PLMVSU(,RPARM)                                  1324
*   PLMVSD=ADDR(IEDXINSD);          /* SOURCE DATA ADDR              */
         ST    @09,PLMVSD(,RPARM)                                  1325
*   PLMVLNTH=LENGTH(IEDXINSD);      /* NUMBER OF BYTES TO BE MOVED   */
         MVC   PLMVLNTH(2,RPARM),@CH01521                          1326
*   PLMVFLG1=0;                     /* CLEAR FLAG BYTE               */
         MVI   PLMVFLG1(RPARM),X'00'                               1327
*   PLMVSCTG=ON;                    /* INDICATE THAT SOURCE DATA IS
*                                      IN A CONTIGUOUS-CORE AREA     */
         OI    PLMVSCTG(RPARM),B'01000000'                         1328
*   CALL IEDMVBFR;                  /* MOVE THE DATA                 */
         L     @09,AVTSAVTP(,RAVT)                                 1329
         L     @15,SAVTMVBF(,@09)                                  1329
         BALR  @14,@15                                             1329
*   END RUINITS;                    /* RETURN TO CALLER              */
@EL00036 DS    0H                                                  1330
@EF00036 DS    0H                                                  1330
@ER00036 L     @14,@SA00036                                        1330
         BR    @14                                                 1330
         EJECT
*SAVLGDTA:                                                         1331
*   PROC OPTIONS(SAVE(R14));                                       1331
*                                                                  1331
SAVLGDTA ST    @14,@SA00037                                        1331
*/********************************************************************/
*/*                                                                  */
*/*      S A V L G D T A   SUBROUTINE                                */
*/*                                                                  */
*/********************************************************************/
*/*                                                                  */
*/*      THIS SUBROUTINE MOVES THE LOGON DATA (THE USER-DATA FIELD)  */
*/*      OUT OF A CINIT PIU AND SAVES IT IN AN EMPTY BUFFER.         */
*/*      A PARTIAL HEADER PREFIX IS BUILT, AND THE BUFFER IS         */
*/*      IS SAVED FOR A LATER TPOST TO MH.                           */
*/*                                                                  */
*/*      (NOTE THAT THE DATA MOVE DEPENDS ON SOURCE UNIT & SOURCE    */
*/*      DATA POINTERS SET UP BY THE FNDLGDTA SUBROUTINE.)           */
*/*                                                                  */
*/********************************************************************/
*                                                                  1332
*   RPRF=LCBERBCH;                  /* BUFFER ADDRESS                */
         L     RPRF,LCBERBCH-1(,RLCB)                              1332
         LA    RPRF,0(,RPRF)                                       1332
*   LCBERBCH=0;                     /* CLEAR ERB'S BUFFER POINTER    */
         SLR   @09,@09                                             1333
         STCM  @09,7,LCBERBCH(RLCB)                                1333
*                                   /* MOVE LOGON DATA INTO EMPTY BFR*/
*   RPARM=ADDR(PLMVPARM);           /* PARAMETER LIST ADDRESS        */
         LA    RPARM,PLMVPARM                                      1334
*   PLMVTU=RPRF;                    /* TARGET UNIT ADDRESS           */
         ST    RPRF,PLMVTU(,RPARM)                                 1335
*   PLMVTD=ADDR(PRFSHDR)-1;         /* TARGET DATA ADDRESS           */
         LA    @09,PRFSHDR(,RPRF)                                  1336
         BCTR  @09,0                                               1336
         ST    @09,PLMVTD(,RPARM)                                  1336
*   PLMVLNTH=DATAPTR->VARLNGTH+LENGTH(VARLNGTH);/* NUMBER OF BYTES   */
         LA    @09,1                                               1337
         L     @07,DATAPTR                                         1337
         SLR   @05,@05                                             1337
         IC    @05,VARLNGTH(,@07)                                  1337
         ALR   @09,@05                                             1337
         STH   @09,PLMVLNTH(,RPARM)                                1337
*   CALL IEDMVBFR;                  /* MOVE THE DATA                 */
         L     @09,AVTSAVTP(,RAVT)                                 1338
         L     @15,SAVTMVBF(,@09)                                  1338
         BALR  @14,@15                                             1338
*                                   /* BUILD A PARTIAL HEADER PREFIX */
*   PRF1FLG1=0;                     /* INITIALIZE FLAG BYTE          */
         LR    @09,RPRF                                            1339
         SL    @09,@CF00044                                        1339
         MVI   PRF1FLG1(@09),X'00'                                 1339
*   PRF1LOGD=ON;                    /* MARK AS LOGON DATA            */
         OI    PRF1LOGD(@09),B'00000100'                           1340
*   PRFDEST=TTHDAF;                 /* PLU'S TNT INDEX               */
         MVC   PRFDEST(2,RPRF),TTHDAF(RPIU)                        1341
*   PRFSIZE=DATAPTR->VARLNGTH+AVTHDRSZ;/* SIZE                       */
         LA    @09,30                                              1342
         L     @07,DATAPTR                                         1342
         SLR   @05,@05                                             1342
         IC    @05,VARLNGTH(,@07)                                  1342
         ALR   @09,@05                                             1342
         STH   @09,PRFSIZE(,RPRF)                                  1342
*                                   /* SAVE LOGON-DATA BUFFER ON WAIT
*                                      CHAIN WITH HIGHEST PRIORITY   */
*   PRFPRI='FF'X;                   /* PRIORITY                      */
         MVI   PRFPRI(RPRF),X'FF'                                  1343
*   PRFLINK=0;                      /* END-OF-CHAIN                  */
         SLR   @09,@09                                             1344
         STCM  @09,7,PRFLINK(RPRF)                                 1344
*   LCBWAITC=RPRF;                  /* PUT BUFFER ON WAIT CHAIN      */
         STCM  RPRF,7,LCBWAITC(RLCB)                               1345
*   RPRF=INPUTBUF;                  /* RESTORE ORIGINAL REG VALUE    */
         L     RPRF,INPUTBUF                                       1346
*   END SAVLGDTA;                   /* RETURN TO CALLER              */
@EL00037 DS    0H                                                  1347
@EF00037 DS    0H                                                  1347
@ER00037 L     @14,@SA00037                                        1347
         BR    @14                                                 1347
         EJECT
*SECLNUP:                                                          1348
*   PROC OPTIONS(SAVE(R14));        /*                       @YM08450*/
SECLNUP  ST    @14,@SA00038                                        1348
*/********************************************************** @YM08450*/
*/*                                                          @YM08450*/
*/*      S E C L N U P   SUBROUTINE                          @YM08450*/
*/*                                                          @YM08450*/
*/********************************************************** @YM08450*/
*/*                                                          @YM08450*/
*/*      THIS SUBROUTINE TAKES CARE OF END-OF-SESSION        @YM08450*/
*/*      CLEAN-UP FUNCTIONS COMMON TO BOTH NORMAL AND        @YM08450*/
*/*      ERROR SITUATIONS.                                   @YM08450*/
*/*                                                          @YM08450*/
*/********************************************************** @YM08450*/
*                                                                  1349
*   TRMSESRQ=OFF;                   /* ALLOW TCAM TO REQUEST NEW   1349
*                                      SESSION               @YM08450*/
         LA    @05,TRMSESRQ(,RTRM)                                 1349
         LR    @03,@05                                             1349
         LA    @09,3                                               1349
         NR    @03,@09                                             1349
         LCR   @03,@03                                             1349
         ALR   @05,@03                                             1349
         L     @09,0(,@05)                                         1349
@GL00021 LR    @07,@09                                             1349
         N     @07,@CB03402+3(@03)                                 1349
         CS    @09,@07,0(@05)                                      1349
         BNE   @GL00021                                            1349
*   LCBLUS=OFF;                     /* RESET LUS BIT SO QEVENT WON'T
*                                      RETURN PLCB TO IEDLUS @YM08450*/
         NI    LCBLUS(RLCB),B'11011111'                            1350
*   IF SIBPTR>0 THEN                /* LU-LU SIB ASSIGNED?   @YM08450*/
         L     @09,SIBPTR                                          1351
         LTR   @09,@09                                             1351
         BNP   @RF01351                                            1351
*     DO;                           /* YES, CLEAN UP SIB     @YM08450*/
*       SIBSSTAT=SIBSFINL;          /* SESSION STATE = FINAL @YM08450*/
         NI    SIBSSTAT(@09),B'11110011'                           1353
         OI    SIBSSTAT(@09),B'00010000'                           1353
*       SIBLGOFF=OFF;               /* LOGOFF BIT            @YM08450*/
*       SIBSHUTC=OFF;               /* SHUTDOWN-COMPLETE BIT @YM08450*/
         NI    SIBLGOFF(@09),B'00111111'                           1355
*       IF SIBRQEND=ON×             /* ANY DEACT REQUESTS    @YM08450*/
*           SIBRQSHT=ON THEN        /* ... ENQUEUED FOR LU?  @YM08450*/
         TM    SIBRQEND(@09),B'11000000'                           1356
         BZ    @RF01356                                            1356
*         CALL DACTLOOP;            /* YES, DELINK & RETURN  @YM08450*/
         BAL   @14,DACTLOOP                                        1357
*     END;                          /*                       @YM08450*/
*   ELSE                            /* NO LU-LU SIB          @YM08450*/
*     CALL DACTLOOP;                /* IF ANY DEACT REQUESTS ARE   1359
*                                      ENQUEUED FOR THIS LU DELINK &
*                                      RETURN THEM           @YM08450*/
         B     @RC01351                                            1359
@RF01351 BAL   @14,DACTLOOP                                        1359
*   SENDSW=OFF;                     /* INIT SEND SWITCH      @YM08450*/
@RC01351 NI    SENDSW,B'11110111'                                  1360
*   CALL CHKSEND;                   /* SEE IF THERE ARE ANY MSGS   1361
*                                      WHICH CAN BE SENT NOW @YM08450*/
         BAL   @14,CHKSEND                                         1361
*   IF SENDSW=ON&                   /* MESSAGES TO BE SENT   @YM08450*/
*       QCBSTPRI^=QCBCLK THEN       /* ... & NOT CLOCK?      @YM08450*/
         TM    SENDSW,B'00001000'                                  1362
         BNO   @RF01362                                            1362
         L     @09,IEDQQPTR                                        1362
         CLI   QCBSTPRI(@09),X'80'                                 1362
         BE    @RF01362                                            1362
*     DO;                           /* TRUE                  @YM08450*/
*       QCBSNDRQ=ON;                /* BIT TO CAUSE QEVENT TO REQUEST
*                                      A NEW SESSION         @YM08450*/
         LR    @07,@09                                             1364
         AL    @07,@CF03385                                        1364
         OI    QCBSNDRQ-4(@07),B'00100000'                         1364
*       IF LCBSTCBA=ADDR(QCBSTVTO) THEN/* SND SCHED IN PLCB? @YM08450*/
         LA    @07,QCBSTVTO(,@09)                                  1365
         L     @05,LCBSTCBA-1(,RLCB)                               1365
         LA    @05,0(,@05)                                         1365
         CR    @07,@05                                             1365
         BNE   @RF01365                                            1365
*         DO;                       /* YES                   @YM08450*/
*           LCBSTCBA=QCBSLINK;      /* REMOVE SEND SCHEDULER @YM08450*/
         MVC   LCBSTCBA(3,RLCB),QCBSLINK(@09)                      1367
*           QCBSLINK=QCBSTCHN;      /* ... STCB FROM PLCB &  @YM08450*/
         MVC   QCBSLINK(3,@09),QCBSTCHN(@09)                       1368
*           QCBSTCHN=ADDR(QCBSTVTO);/* ... PUT IT BACK INTO  @YM08450*/
         STCM  @07,7,QCBSTCHN(@09)                                 1369
*         END;                      /* ... QCB'S CHAIN       @YM08450*/
*     END;                          /*                       @YM08450*/
@RF01365 DS    0H                                                  1372
*   BYPASSSW=ON;                    /* CAUSE PLCB TO BE PASSED TO  1372
*                                      QEVENT VIA DSPBYPAS   @YM08450*/
@RF01362 OI    BYPASSSW,B'10000000'                                1372
*   END SECLNUP;                    /* RETURN TO CALLER      @YM08450*/
@EL00038 DS    0H                                                  1373
@EF00038 DS    0H                                                  1373
@ER00038 L     @14,@SA00038                                        1373
         BR    @14                                                 1373
         EJECT
*THINITS:                                                          1374
*   PROC OPTIONS(SAVE(R14));                                       1374
*                                                                  1374
THINITS  ST    @14,@SA00039                                        1374
*/********************************************************************/
*/*                                                                  */
*/*      T H I N I T S   SUBROUTINE                                  */
*/*                                                                  */
*/********************************************************************/
*/*                                                                  */
*/*      THIS SUBROUTINE BUILDS THE TH FOR AN INIT-SELF REQUEST.     */
*/*                                                                  */
*/********************************************************************/
*                                                                  1375
*                                   /* INITIALIZE THE TH             */
*   TTHBYTE0=NRMFLOTH;              /* NORMAL-FLOW TH                */
         MVI   TTHBYTE0(RPIU),X'1C'                                1375
*   TTHBYTE1=0;                                                    1376
         MVI   TTHBYTE1(RPIU),X'00'                                1376
*   TTHDAF=SAVTSCPT;                /* SSCP'S TNT INDEX              */
         L     @09,AVTSAVTP(,RAVT)                                 1377
         MVC   TTHDAF(2,RPIU),SAVTSCPT(@09)                        1377
*   TCXPTR=CVTAQAVT;                /* GET TCX ADDRESS       @YM08096*/
         L     @09,CVTPTR                                          1378
         L     TCXPTR,CVTAQAVT(,@09)                               1378
*   IF(QCBTTCIN>TNTLEN)&            /* IF THIS IS A TOTE ENTRY       */
*       (QCBTTCIN=<TNTLEN+TCXTOTE) THEN                            1379
         L     @09,IEDQQPTR                                        1379
         BCTR  @09,0                                               1379
         BCTR  @09,0                                               1379
         LH    @09,QCBTTCIN-6(,@09)                                1379
         L     @07,AVTRNMPT(,RAVT)                                 1379
         LH    @07,TNTLEN(,@07)                                    1379
         N     @07,@CF03378                                        1379
         CR    @09,@07                                             1379
         BNH   @RF01379                                            1379
         SLR   @03,@03                                             1379
         IC    @03,TCXTOTE(,TCXPTR)                                1379
         ALR   @07,@03                                             1379
         CR    @09,@07                                             1379
         BH    @RF01379                                            1379
*     DO;                           /*                       @YM08096*/
*       RPARM=AVTCWTOT;             /* RESIDENT TOTE CTL BLK @YM08096*/
         L     RPARM,AVTCWTOT(,RAVT)                               1381
*       TTHOAF=RPARM->RESMHSRC;     /* TOTE MH TTCIN         @YM08096*/
         MVC   TTHOAF(2,RPIU),RESMHSRC(RPARM)                      1382
*     END;                          /* END OF TOTE CHECK     @YM08096*/
*   ELSE                                                           1384
*     DO;                           /* CONTINUE NORMAL PROC  @YM08096*/
         B     @RC01379                                            1384
@RF01379 DS    0H                                                  1385
*                                   /* GET THE PLU'S TNT INDEX       */
*       R0=ADDR(LUNAMCON);          /* ADDR OF 'IEDLUNAM' CONSTANT   */
         LA    R0,@CC03111                                         1385
*       RPARM=ADDR(IEDQTRM);        /* TTE ADDRESS FOR SLU           */
         LA    RPARM,IEDQTRM(,RTRM)                                1386
*       CALL IEDOPTN;               /* GET ADDRESS OF SLU'S IEDLUNAM
*                                      OPTION FIELD                  */
         L     @15,AVTOPTN(,RAVT)                                  1387
         BALR  @14,@15                                             1387
*       IF R15=0 THEN               /* GOOD RETURN CODE?             */
         LTR   R15,R15                                             1388
         BNZ   @RF01388                                            1388
*         DO;                       /* YES, OPTION FIELD WAS FOUND   */
*           IF R0>LENGTH(NAMECON) THEN/* OPTION FIELD TOO LONG?      */
         LA    @09,8                                               1390
         CR    R0,@09                                              1390
         BNH   @RF01390                                            1390
*             R0=LENGTH(NAMECON);   /* YES, TRUNCATE IT              */
         LR    R0,@09                                              1391
*           NAMECON=BLANKS;         /* GET PLU NAME FROM OPTION FIELD*/
@RF01390 MVC   NAMECON(8),@CC03119                                 1392
*           NAMECON(1:R0)=RPARM->CHAR8(1:R0);                      1393
         LR    @09,R0                                              1393
         BCTR  @09,0                                               1393
         EX    @09,@SM03407                                        1393
*           CALL NAMESRCH;          /* FIND TNT INDEX FOR PLU NAME   */
         BAL   @14,NAMESRCH                                        1394
*         END;                                                     1395
*       ELSE                        /* BAD RETURN CODE               */
*         FOUNDSW=OFF;              /* INDICATE DEFAULT PLU          */
         B     @RC01388                                            1396
@RF01388 NI    FOUNDSW,B'10111111'                                 1396
*                                   /* FINISH BUILDING TH            */
*       IF FOUNDSW=ON THEN          /* DID WE FIND A MATCH?          */
@RC01388 TM    FOUNDSW,B'01000000'                                 1397
         BNO   @RF01397                                            1397
*         TTHOAF=TNTCTR;            /* YES, USE THE TNT VALUE FOUND  */
         MVC   TTHOAF(2,RPIU),TNTCTR                               1398
*       ELSE                                                       1399
*         TTHOAF=SAVTMHDX;          /* NO, USE THE DEFAULT TNT VALUE */
         B     @RC01397                                            1399
@RF01397 L     @09,AVTSAVTP(,RAVT)                                 1399
         MVC   TTHOAF(2,RPIU),SAVTMHDX(@09)                        1399
*     END;                          /* END NORMAL PATH       @YM08096*/
@RC01397 DS    0H                                                  1401
*   TTHTAG=TNTSLU;                  /* SLU'S TNT INDEX               */
@RC01379 MVC   TTHTAG(2,RPIU),TNTSLU                               1401
*   TTHDCF=LENGTH(IEDRH)+LENGTH(IEDXINSD);/* DATA COUNT FIELD        */
         MVC   TTHDCF(2,RPIU),@CH02302                             1402
*   END THINITS;                    /* RETURN TO CALLER              */
@EL00039 DS    0H                                                  1403
@EF00039 DS    0H                                                  1403
@ER00039 L     @14,@SA00039                                        1403
         BR    @14                                                 1403
         EJECT
*TPOSTERB:                                                         1404
*   PROC OPTIONS(SAVE(R14));                                       1404
*                                                                  1404
TPOSTERB ST    @14,@SA00040                                        1404
*/********************************************************************/
*/*                                                                  */
*/*      T P O S T E R B   SUBROUTINE                                */
*/*                                                                  */
*/********************************************************************/
*/*                                                                  */
*/*      THIS SUBROUTINE COMPLETES THE SETTING UP OF AN ERB AND      */
*/*      TPOSTS THE ERB TO REQUEST A BUFFER.                         */
*/*                                                                  */
*/********************************************************************/
*                                                                  1405
*   LCBERBQB=ADDR(AVTBFREB);        /* QCB ADDRESS                   */
         LA    @09,AVTBFREB(,RAVT)                                 1405
         STCM  @09,7,LCBERBQB(RLCB)                                1405
*   LCBERBPY=PRIINTRQ;              /* PRIORITY                      */
         MVI   LCBERBPY(RLCB),X'E4'                                1406
*   LCBRBCT1=1;                     /* NUMBER OF BUFFERS REQUESTED   */
         MVI   LCBRBCT1(RLCB),X'01'                                1407
*   LCBPRCPG=ON;                    /* SET UP ERB TO BE TPOSTED      */
         OI    LCBPRCPG(RLCB),B'00000010'                          1408
*   LCBRCQCB=ADDR(SAVTLUSQ);        /* ... BACK TO THIS MODULE       */
         L     @09,AVTSAVTP(,RAVT)                                 1409
         LA    @09,SAVTLUSQ(,@09)                                  1409
         ST    @09,LCBRCQCB(,RLCB)                                 1409
*   LCBDLNKN=OFF;                   /* MARK THE ERB IN USE           */
         NI    LCBDLNKN(RLCB),B'11111110'                          1410
*   RPARM=ADDR(LCBERB);             /* ELEMENT ADDRESS FOR TPOST     */
         LA    RPARM,LCBERB(,RLCB)                                 1411
*   CALL DSPPOSTR;                  /* TPOST THE ERB                 */
         LA    @15,DSPPOSTR(,RDISP)                                1412
         BALR  @14,@15                                             1412
*   END TPOSTERB;                   /* RETURN TO CALLER              */
@EL00040 DS    0H                                                  1413
@EF00040 DS    0H                                                  1413
@ER00040 L     @14,@SA00040                                        1413
         BR    @14                                                 1413
         EJECT
*TPOSTPIU:                                                         1414
*   PROC OPTIONS(SAVE(R14));                                       1414
*                                                                  1414
TPOSTPIU ST    @14,@SA00041                                        1414
*/********************************************************************/
*/*                                                                  */
*/*      T P O S T P I U   SUBROUTINE                                */
*/*                                                                  */
*/********************************************************************/
*/*                                                                  */
*/*      THIS SUBROUTINE TPOSTS A PIU BUFFER TO THE SSCP.            */
*/*                                                                  */
*/********************************************************************/
*                                                                  1415
*   PRFQCBA=ADDR(AVTOPCOB);         /* OP CONTROL QCB ADDRESS        */
         LA    @09,AVTOPCOB(,RAVT)                                 1415
         STCM  @09,7,PRFQCBA(RPRF)                                 1415
*   PRFPRI=PRISSPIU;                /* PRIORITY                      */
         MVI   PRFPRI(RPRF),X'E5'                                  1416
*   RPARM=RPRF;                     /* ELEMENT ADDRESS FOR TPOST     */
         LR    RPARM,RPRF                                          1417
*   CALL DSPPOSTR;                  /* TPOST THE PIU BUFFER          */
         LA    @15,DSPPOSTR(,RDISP)                                1418
         BALR  @14,@15                                             1418
*   END TPOSTPIU;                   /* RETURN TO CALLER              */
@EL00041 DS    0H                                                  1419
@EF00041 DS    0H                                                  1419
@ER00041 L     @14,@SA00041                                        1419
         BR    @14                                                 1419
         EJECT
*UNITCNT:                                                          1420
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               1420
UNITCNT  DS    0H                                                  1421
*   RFY                                                            1421
*     R14 RSTD;                                                    1421
*                                                                  1421
*/********************************************************************/
*/*                                                                  */
*/*      U N I T C N T   SUBROUTINE                                  */
*/*                                                                  */
*/********************************************************************/
*/*                                                                  */
*/*     THIS SUBROUTINE CONVERTS NUMBER OF DATA BYTES (IN RPARMF)    */
*/*     INTO NUMBER OF UNITS NEEDED (IN R0).                         */
*/*                                                                  */
*/********************************************************************/
*                                                                  1422
*   R0=0;                           /* INITIALIZE UNIT COUNT         */
         SLR   R0,R0                                               1422
*   DO UNTIL(RPARMF<=0);                                           1423
@DL01423 DS    0H                                                  1424
*     RPARMF=RPARMF-AVTKEYLE;       /* SUBTRACT SIZE OF 1 UNIT       */
         SH    RPARMF,AVTKEYLE(,RAVT)                              1424
*     R0=R0+1;                      /* BUMP UNIT COUNT               */
         AL    R0,@CF00060                                         1425
*   END;                                                           1426
@DE01423 LTR   RPARMF,RPARMF                                       1426
         BP    @DL01423                                            1426
*   END UNITCNT;                    /* RETURN TO CALLER              */
@EL00042 DS    0H                                                  1427
@EF00042 DS    0H                                                  1427
@ER00042 BR    @14                                                 1427
*   RFY                                                            1428
*     R14 UNRSTD;                                                  1428
         EJECT
*   END IEDLUS                                                     1429
*                                                                  1429
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (TAVTD   )                                       */
*/*%INCLUDE SYSLIB  (TCD1D   )                                       */
*/*%INCLUDE SYSLIB  (TCURD   )                                       */
*/*%INCLUDE SYSLIB  (CVT     )                                       */
*/*%INCLUDE SYSLIB  (TDCTD   )                                       */
*/*%INCLUDE SYSLIB  (TDISPD  )                                       */
*/*%INCLUDE SYSLIB  (TLCBD   )                                       */
*/*%INCLUDE SYSLIB  (TLGBD   )                                       */
*/*%INCLUDE SYSLIB  (TMHTABD )                                       */
*/*%INCLUDE SYSLIB  (TPIUD   )                                       */
*/*%INCLUDE SYSLIB  (TPLMVD  )                                       */
*/*%INCLUDE SYSLIB  (TPRFD   )                                       */
*/*%INCLUDE SYSLIB  (TPRIOR  )                                       */
*/*%INCLUDE SYSLIB  (TPROCD  )                                       */
*/*%INCLUDE SYSLIB  (TQCBD   )                                       */
*/*%INCLUDE SYSLIB  (TRECBD  )                                       */
*/*%INCLUDE SYSLIB  (TREQD   )                                       */
*/*%INCLUDE SYSLIB  (RESPL   )                                       */
*/*%INCLUDE SYSLIB  (TSCBD   )                                       */
*/*%INCLUDE SYSLIB  (TSIBD   )                                       */
*/*%INCLUDE SYSLIB  (TSNSD   )                                       */
*/*%INCLUDE SYSLIB  (TRHD    )                                       */
*/*%INCLUDE SYSLIB  (TTCXD   )                                       */
*/*%INCLUDE SYSLIB  (TTHD    )                                       */
*/*%INCLUDE SYSLIB  (TTNTD   )                                       */
*/*%INCLUDE SYSLIB  (TTRMD   )                                       */
*/*%INCLUDE SYSLIB  (TXCTMD  )                                       */
*                                                                  1429
*       ;                                                          1429
@DATA    DS    0H
@CH03367 DC    H'11'
@CH00244 DC    H'12'
@CH00174 DC    H'16'
@CH01521 DC    H'25'
@SM03398 MVC   XINSMODE(0),CHAR8(RPARM)
@SM03400 MVC   XINSNAME(0),CHAR8(RPARM)
@SM03407 MVC   NAMECON(0),CHAR8(RPARM)
         DS    0F
@SA00034 DS    1F
@SA00032 DS    1F
@SA00020 DS    1F
@SA00031 DS    1F
@SA00012 DS    1F
@SA00002 DS    1F
@SA00040 DS    1F
@SA00004 DS    1F
@SA00038 DS    1F
@SA00003 DS    1F
@SA00039 DS    1F
@SA00036 DS    1F
@SA00041 DS    1F
@SA00005 DS    1F
@SA00007 DS    1F
@SA00035 DS    1F
@SA00024 DS    1F
@SA00037 DS    1F
@SA00008 DS    1F
@SA00025 DS    1F
@SA00033 DS    1F
@SA00009 DS    1F
@SA00010 DS    1F
@SA00011 DS    1F
@SA00014 DS    1F
@SA00013 DS    1F
@SA00026 DS    1F
@SA00016 DS    1F
@SA00017 DS    1F
@SA00018 DS    1F
@SA00028 DS    1F
@SA00023 DS    1F
@SA00019 DS    1F
@SA00021 DS    1F
@SA00022 DS    1F
@SA00027 DS    1F
@SA00029 DS    1F
@SA00030 DS    1F
         DS    0F
@CF00060 DC    F'1'
@CF00255 DC    F'4'
@CH00255 EQU   @CF00255+2
@CF00044 DC    F'8'
@CF02842 DC    F'14'
@CF02302 DC    F'28'
@CH02302 EQU   @CF02302+2
@CF03369 DC    F'82'
@CF03379 DC    F'-8'
@CF03396 DC    F'-5'
@CF03385 DC    F'-4'
@CF02080 DC    XL4'08000002'
@CF03378 DC    XL4'0000FFFF'
@CF00751 DC    XL4'010688'
@CF00759 DC    XL4'010685'
@CF00761 DC    XL4'010686'
@CF01909 DC    XL4'4C'
         DS    0D
CURRENT  DC    A(0)
DACTPTR  DC    A(0)
SIBPTR   DC    A(0)
BUFPTR   DC    A(0)
DATAPTR  DC    A(0)
INPUTBUF DC    A(0)
INPUTPIU DC    A(0)
NCPTTE   DC    A(0)
PREVIOUS DC    A(0)
QCBPTR   DC    A(0)
TNTCTR   DC    AL2(0)
TNTSLU   DC    AL2(0)
LINKOFFS DC    AL1(RECBLINK-1-IEDQRECB)
@CC03111 DC    C'IEDLUNAM'
@CC03113 DC    C'IEDLMODE'
@CC03115 DC    C'IEDTOTB1'
@CC03117 DC    C'IEDTOTB2'
@CC03119 DC    C'        '
@CB00753 DC    X'010601'
@CB00755 DC    X'010602'
@CB00759 DC    X'010685'
@CB03121 DC    X'0B9000'
@CB03123 DC    X'0B0000'
@CB03125 DC    X'4B8000'
@CB03127 DC    X'030000'
@CB03391 DC    B'111111111111111111111111111111011111111111111111111111C
               11'
@CB03402 DC    B'111111111111111111111111111101111111111111111111111111C
               11'
LUSLCB   DS    CL224
         ORG   LUSLCB
@NM00224 DC    XL76'0'
LUSERB   DS    CL14
         ORG   LUSERB
@NM00225 DC    XL8'0'
LUSERBST DC    X'01'
         ORG   LUSERBST
@NM00226 DS    BL1
LUSDLNKN EQU   LUSERBST+0
         ORG   LUSERB+9
@NM00227 DC    XL5'0'
         ORG   LUSLCB+90
@NM00228 DC    XL134'0'
         ORG   LUSLCB+224
SWITCHES DS    CL1
         ORG   SWITCHES
BYPASSSW DS    BL1
FOUNDSW  EQU   SWITCHES+0
EXITSW   EQU   SWITCHES+0
BUSYSW   EQU   SWITCHES+0
SENDSW   EQU   SWITCHES+0
         ORG   SWITCHES+1
IEDXINSD DS    CL25
         ORG   IEDXINSD
XINSCODE DC    X'010681'
XINSFMTP DC    X'02'
         ORG   XINSFMTP
XINSFMT  DS    BL1
XINSTYPE EQU   XINSFMTP+0
         ORG   IEDXINSD+4
XINSMODE DS    CL8
XINSNTNM DS    CL10
         ORG   XINSNTNM
XINSNTYP DC    X'F3'
XINSNLEN DC    AL1(8)
XINSNAME DS    CL8
         ORG   IEDXINSD+22
XINSRQID DS    CL1
         ORG   XINSRQID
XINSRLEN DC    AL1(0)
XINSRID  DS    0C
         ORG   IEDXINSD+23
XINSPWRD DS    CL1
         ORG   XINSPWRD
XINSPLEN DC    AL1(0)
XINSPSWD DS    0C
         ORG   IEDXINSD+24
XINSUFLD DS    CL1
         ORG   XINSUFLD
XINSULEN DC    AL1(0)
XINSUSFD DS    0C
         ORG   IEDXINSD+25
NAMECON  DS    CL8
PLMVPARM DS    CL24
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
SLUNA    EQU   @07
PLUNA    EQU   @05
ENTRYSZ  EQU   @03
RDISP    EQU   @11
LCBXPTR  EQU   @05
TCXPTR   EQU   @05
RTRM     EQU   @08
RAVT     EQU   @13
RPRF     EQU   @06
RLCB     EQU   @04
RPIU     EQU   @02
RPARM    EQU   @01
R0       EQU   @00
RPARMF   EQU   @01
RSTCB    EQU   @03
RQCB     EQU   @07
RBASE2   EQU   @10
RBASE1   EQU   @12
R14      EQU   @14
R15      EQU   @15
CVTPTR   EQU   16
IEDQAVTD EQU   0
AVTSAVEX EQU   IEDQAVTD+216
AVTCSTCS EQU   IEDQAVTD+256
AVTREADD EQU   IEDQAVTD+308
AVTBUFSW EQU   IEDQAVTD+312
@NM00004 EQU   IEDQAVTD+316
AVTCKFLG EQU   @NM00004
AVTBASE  EQU   IEDQAVTD+340
AVTPKF   EQU   AVTBASE
AVTRNMPT EQU   IEDQAVTD+352
AVTOSECB EQU   IEDQAVTD+420
AVTECB1  EQU   AVTOSECB
AVTHG02  EQU   IEDQAVTD+456
AVTDISP  EQU   IEDQAVTD+480
AVTHD    EQU   IEDQAVTD+484
AVTSCOPT EQU   AVTHD
AVTSAVTP EQU   IEDQAVTD+540
AVTSAVTF EQU   AVTSAVTP
AVTCKPEL EQU   IEDQAVTD+580
AVTCKRMV EQU   AVTCKPEL
AVTCKELF EQU   IEDQAVTD+608
AVTCKBYT EQU   IEDQAVTD+619
AVTHG01  EQU   IEDQAVTD+620
AVTCKLNK EQU   IEDQAVTD+624
AVTCRELE EQU   IEDQAVTD+636
AVTCCELE EQU   AVTCRELE
AVTCLRHI EQU   IEDQAVTD+644
AVTADBUF EQU   IEDQAVTD+648
AVTSYSER EQU   IEDQAVTD+656
AVTMSGS  EQU   IEDQAVTD+657
AVTBFREB EQU   IEDQAVTD+708
AVTBFRFG EQU   IEDQAVTD+712
AVTBFRTB EQU   IEDQAVTD+720
AVTCKPQB EQU   IEDQAVTD+732
AVTCKPTB EQU   AVTCKPQB
AVTCKPEC EQU   AVTCKPQB+4
AVTCKPCC EQU   AVTCKPEC
AVTOPCQB EQU   IEDQAVTD+744
AVTOPCOB EQU   AVTOPCQB
AVTOPCEC EQU   AVTOPCQB+4
AVTOPCCC EQU   AVTOPCEC
AVTOLTQB EQU   IEDQAVTD+756
AVTCWFL1 EQU   IEDQAVTD+852
AVTCWFL2 EQU   IEDQAVTD+853
AVTSUBT  EQU   IEDQAVTD+876
AVTIOTR  EQU   IEDQAVTD+877
AVTCWTOT EQU   IEDQAVTD+936
AVTKEYLE EQU   IEDQAVTD+960
AVTBIT1  EQU   IEDQAVTD+978
AVTCLOSN EQU   AVTBIT1
AVTQUCKN EQU   AVTBIT1
AVTBIT2  EQU   IEDQAVTD+979
AVTBIT3  EQU   IEDQAVTD+980
AVTOPTN  EQU   IEDQAVTD+984
AVTDDFT  EQU   IEDQAVTD+992
AVTDCTLN EQU   IEDQAVTD+1000
AVTBIT4  EQU   IEDQAVTD+1064
@NM00086 EQU   IEDQAVTD+1160
IEDQAPTR EQU   0
IEDNSVTD EQU   0
SAVTDIAG EQU   IEDNSVTD
SAVTDIAF EQU   SAVTDIAG
SAVTPREQ EQU   IEDNSVTD+16
SAVTCLUP EQU   IEDNSVTD+72
SAVTLUSQ EQU   IEDNSVTD+88
SAVTLUSB EQU   SAVTLUSQ
SAVTLUSP EQU   SAVTLUSQ+4
SAVTLUSR EQU   IEDNSVTD+100
SAVTMVBF EQU   IEDNSVTD+160
SAVTSCLU EQU   IEDNSVTD+168
SAVTDFCO EQU   IEDNSVTD+200
SAVTMHTB EQU   IEDNSVTD+216
SAVTTCPU EQU   IEDNSVTD+238
SAVTSCPT EQU   SAVTTCPU
SAVTTNTX EQU   IEDNSVTD+252
SAVTMHDX EQU   IEDNSVTD+268
SAVTZELM EQU   IEDNSVTD+270
SAVTRDRV EQU   IEDNSVTD+284
SAVTCKQB EQU   IEDNSVTD+300
SAVTCKTB EQU   SAVTCKQB
SAVTCKEC EQU   SAVTCKQB+4
SAVTCKCC EQU   SAVTCKEC
IEDCUREQ EQU   0
CURQCB   EQU   IEDCUREQ+1
CURPRI   EQU   IEDCUREQ+4
CURLINK  EQU   IEDCUREQ+8
CURTOTIN EQU   IEDCUREQ+12
CURFLG2  EQU   IEDCUREQ+14
CURTERM  EQU   CURFLG2
CURFLG3  EQU   IEDCUREQ+15
CURTTCIN EQU   IEDCUREQ+20
CURTRM   EQU   IEDCUREQ+40
RCUR     EQU   0
CVTMAP   EQU   0
CVTDAR   EQU   CVTMAP+72
CVTFLGS1 EQU   CVTDAR
CVTDCB   EQU   CVTMAP+116
CVTIERLC EQU   CVTMAP+144
CVTOPTA  EQU   CVTMAP+182
CVTOPTB  EQU   CVTMAP+183
CVTGTF   EQU   CVTMAP+236
CVTGTFST EQU   CVTGTF
CVTGTFS  EQU   CVTGTFST
CVTSTATE EQU   CVTGTFST
CVTTMODE EQU   CVTGTFST
CVTFORM  EQU   CVTGTFST
CVTAQAVT EQU   CVTMAP+240
CVTTCMFG EQU   CVTAQAVT
CVTVOLM2 EQU   CVTMAP+244
CVTTATA  EQU   CVTVOLM2
CVTTSKS  EQU   CVTTATA
CVTVOLF2 EQU   CVTTSKS
CVTTAT   EQU   CVTTATA+1
CVTATER  EQU   CVTMAP+248
CVTEXT1  EQU   CVTMAP+252
CVTPURG  EQU   CVTMAP+260
CVTQMSG  EQU   CVTMAP+268
CVTDMSR  EQU   CVTMAP+272
CVTRSV37 EQU   CVTDMSR
CVTDMSRF EQU   CVTRSV37
CVTERPV  EQU   CVTMAP+316
CVTINTLA EQU   CVTMAP+320
CVTAPF   EQU   CVTMAP+324
CVTEXT2  EQU   CVTMAP+328
CVTHJES  EQU   CVTMAP+332
CVTPGSIA EQU   CVTMAP+348
CVTA1F1  EQU   CVTMAP+356
CVTSYSK  EQU   CVTMAP+357
CVTVOLM1 EQU   CVTMAP+380
CVTVOLF1 EQU   CVTVOLM1
CVTATMCT EQU   CVTMAP+388
CVTXTNT1 EQU   0
CVTXTNT2 EQU   0
CVTDSSV  EQU   CVTXTNT2
CVTFLGBT EQU   CVTXTNT2+5
CVTQID   EQU   CVTXTNT2+24
CVTSHS   EQU   CVTXTNT2+40
CVTRV400 EQU   CVTXTNT2+52
CVTRV409 EQU   CVTXTNT2+53
CVTATCVT EQU   CVTXTNT2+64
CVTRV429 EQU   CVTXTNT2+84
CVTRV438 EQU   CVTXTNT2+85
CVTRV457 EQU   CVTXTNT2+112
CVTRV466 EQU   CVTXTNT2+113
CVTFIX   EQU   0
CVTRELNO EQU   CVTFIX+252
IEDDCT   EQU   0
DCTBYTE1 EQU   IEDDCT+1
DCTBYTE2 EQU   IEDDCT+2
DCTBYTE3 EQU   IEDDCT+3
DCTBYTE4 EQU   IEDDCT+4
DCTBYTE5 EQU   IEDDCT+5
DCTL3270 EQU   DCTBYTE5
IEDQDISP EQU   0
DSPDISP  EQU   4
DSPBYPAS EQU   20
DSPPOSTR EQU   28
IEDQLCB  EQU   0
LCBRCB   EQU   IEDQLCB
LCBQCBA  EQU   LCBRCB+1
LCBPRI   EQU   LCBRCB+4
LCBSTCBA EQU   IEDQLCB+9
LCBRSLNK EQU   IEDQLCB+13
LCBTSOB  EQU   IEDQLCB+19
LCBCHAIN EQU   IEDQLCB+20
LCBSCRNN EQU   LCBCHAIN
LCBTETEN EQU   LCBCHAIN
LCBINSRC EQU   IEDQLCB+21
LCBLKMDE EQU   LCBINSRC+2
LCBNTXT  EQU   IEDQLCB+24
LCBSTAT4 EQU   LCBNTXT
LCBPHASE EQU   LCBSTAT4
LCBSCBDA EQU   IEDQLCB+25
LCBMHA   EQU   IEDQLCB+29
LCBFLAG1 EQU   IEDQLCB+32
LCBIOBSN EQU   IEDQLCB+33
LCBSNS   EQU   LCBIOBSN+1
LCBSENS0 EQU   LCBSNS
LCBLOSDT EQU   LCBSENS0
LCBTMOUT EQU   LCBSENS0
LCBFLAG3 EQU   LCBIOBSN+7
LCBCSW   EQU   LCBIOBSN+8
LCBCSWST EQU   LCBCSW+3
LCBCSWUS EQU   LCBCSWST
LCBUSUE  EQU   LCBCSWUS
LCBCSWCS EQU   LCBCSWST+1
LCBSIOCC EQU   LCBIOBSN+15
LCBDCBPT EQU   IEDQLCB+52
LCBRCQCB EQU   IEDQLCB+56
LCBRESTR EQU   LCBRCQCB
LCBTHSQ  EQU   IEDQLCB+60
LCBINCAM EQU   LCBTHSQ
LCBERRCT EQU   IEDQLCB+62
LCBLSPCI EQU   IEDQLCB+65
LCBRCBFR EQU   LCBLSPCI
LCBSTATE EQU   IEDQLCB+70
LCBSTAT1 EQU   LCBSTATE
LCBRECVN EQU   LCBSTAT1
LCBSENDN EQU   LCBSTAT1
LCBSTAT2 EQU   LCBSTATE+1
LCBBEOTN EQU   LCBSTAT2
LCBSYNC  EQU   LCBSTAT2
LCBDIAL  EQU   LCBSTAT2
LCBTSTSW EQU   IEDQLCB+72
LCBERB   EQU   IEDQLCB+76
LCBERBQB EQU   LCBERB+1
LCBERBPY EQU   IEDQLCB+80
LCBERBST EQU   IEDQLCB+84
LCBPRCPG EQU   LCBERBST
LCBDLNKN EQU   LCBERBST
LCBERBCH EQU   IEDQLCB+85
LCBERBCT EQU   IEDQLCB+88
LCBRBCT1 EQU   LCBERBCT
LCBRBCT2 EQU   LCBERBCT+1
LCBTTCIN EQU   IEDQLCB+90
LCBMSGFM EQU   IEDQLCB+92
LCBSCBA  EQU   IEDQLCB+93
LCBOBRCH EQU   IEDQLCB+96
LCBINVPT EQU   LCBOBRCH+1
LCBBFRW  EQU   LCBINVPT
LCBTPCD  EQU   IEDQLCB+100
LCBSTAT5 EQU   LCBTPCD
LCBLUS   EQU   LCBSTAT5
LCBBFRSV EQU   LCBTPCD+1
LCBSTAT6 EQU   LCBTPCD+4
LCBWAITC EQU   LCBTPCD+5
LCBRSPSV EQU   LCBTPCD+8
LCBBFSNS EQU   LCBRSPSV
LCBSAVSN EQU   IEDQLCB+112
LCBERCCW EQU   IEDQLCB+120
LCBCPA   EQU   IEDQLCB+144
LCBCCW5  EQU   LCBCPA+32
LCBATTEL EQU   LCBCCW5
LCBQEBPL EQU   LCBATTEL
IEDQLPTR EQU   0
IEDQLCBX EQU   0
LCBXCON  EQU   IEDQLCBX
LCBXFLAG EQU   LCBXCON
LCBXDCT  EQU   LCBXCON+1
LCBXRADR EQU   LCBXCON+4
IEDNLGB  EQU   0
LGBBUFOU EQU   IEDNLGB+20
LGBPCI   EQU   IEDNLGB+25
LGBBYTE  EQU   IEDNLGB+29
LGBOFLGS EQU   IEDNLGB+48
LGBRESER EQU   IEDNLGB+56
IEDNLPTR EQU   0
IEDMHTD  EQU   0
MHNAME   EQU   IEDMHTD
MHENTRY  EQU   IEDMHTD+8
IEDQMHTP EQU   0
IEDPIU   EQU   0
PIUTH    EQU   IEDPIU
PIURH    EQU   IEDPIU+10
PIURU    EQU   IEDPIU+13
IEDPLMV  EQU   0
PLMVTU   EQU   IEDPLMV
PLMVTD   EQU   IEDPLMV+4
PLMVSU   EQU   IEDPLMV+8
PLMVSD   EQU   IEDPLMV+12
PLMVLNTH EQU   IEDPLMV+16
PLMVFLG1 EQU   IEDPLMV+18
PLMVSCTG EQU   PLMVFLG1
IEDPLMVP EQU   0
IEDQPRF  EQU   0
PRFRCB   EQU   IEDQPRF
PRFKEY   EQU   PRFRCB
PRFQCBA  EQU   PRFRCB+1
PRFPRI   EQU   PRFRCB+4
PRFLINK  EQU   PRFRCB+5
PRFTIC   EQU   IEDQPRF+8
PRFTICC  EQU   PRFTIC
PRFNBUNT EQU   IEDQPRF+12
PRFSUNIT EQU   PRFNBUNT
PRFPLQCB EQU   PRFSUNIT
PRFPIUO  EQU   PRFPLQCB
PRFLCB   EQU   IEDQPRF+13
@NM00177 EQU   IEDQPRF+16
PRFSVFFO EQU   @NM00177
PRFSRCE  EQU   PRFSVFFO
PRFSIZE  EQU   PRFSVFFO+2
PRFSTAT1 EQU   IEDQPRF+20
PRFEOFN  EQU   PRFSTAT1
PRFCORE  EQU   IEDQPRF+21
PRFXTRA  EQU   PRFCORE
PRFSCAN  EQU   IEDQPRF+24
PRFTQBCK EQU   IEDQPRF+26
PRFNTXT  EQU   PRFTQBCK
PRFEOBOF EQU   PRFNTXT
PRFCRCD  EQU   IEDQPRF+29
PRFCHDR  EQU   IEDQPRF+32
PRFNHDR  EQU   PRFCHDR
PRFHQBCK EQU   IEDQPRF+35
PRFISEQ  EQU   IEDQPRF+38
PRFDEST  EQU   IEDQPRF+40
IEDQPPTR EQU   0
IEDPF1   EQU   0
PRF1RH   EQU   IEDPF1
PRF1FLG1 EQU   IEDPF1+3
PRF1FIDI EQU   PRF1FLG1
PRF1LOGD EQU   PRF1FLG1
PRF1WD2  EQU   IEDPF1+4
PRF1SEQP EQU   PRF1WD2
PRF1SQID EQU   PRF1SEQP
PRF1TAG1 EQU   PRF1SQID
IEDPF2   EQU   0
PRF2FLG2 EQU   IEDPF2
PRF2TNTI EQU   PRF2FLG2
PRF2WD2  EQU   IEDPF2+4
IEDPROC  EQU   0
PROFLAG  EQU   IEDPROC+1
PROLU    EQU   PROFLAG
IEDQQCB  EQU   0
QCBDSFLG EQU   IEDQQCB
QCBTSQ   EQU   QCBDSFLG
QCBDISK  EQU   QCBDSFLG
QCBHELD  EQU   QCBDSFLG
QCBELCHN EQU   IEDQQCB+1
QCBLINK  EQU   IEDQQCB+5
QCBSTVTO EQU   IEDQQCB+8
QCBSTCHN EQU   IEDQQCB+9
QCBSTPRI EQU   IEDQQCB+12
QCBSLINK EQU   IEDQQCB+13
QCBEOLDT EQU   IEDQQCB+16
QCBBYTE1 EQU   QCBEOLDT+1
QCBLKRLN EQU   IEDQQCB+18
QCBRETCT EQU   QCBLKRLN
QCBSTAT  EQU   IEDQQCB+19
QCBTRMHO EQU   QCBSTAT
QCBINSRC EQU   IEDQQCB+21
@NM00188 EQU   QCBINSRC
QCBTSOF2 EQU   @NM00188+1
QCBTSOF1 EQU   @NM00188+2
QCBINTVL EQU   IEDQQCB+24
QCBPREN  EQU   IEDQQCB+28
QCBLKRRN EQU   QCBPREN+1
QCBDCBAD EQU   IEDQQCB+33
QCBLGBAD EQU   QCBDCBAD
QCBFLAG  EQU   IEDQQCB+36
IEDQPQCB EQU   0
QCBFHDLZ EQU   IEDQPQCB+3
QCBPFEFO EQU   QCBFHDLZ+1
QCBFHDTZ EQU   IEDQPQCB+6
QCBINTLF EQU   IEDQPQCB+12
QCBFFEFO EQU   IEDQPQCB+15
QCBPRIPQ EQU   IEDQPQCB+24
IEDNQCB  EQU   0
QCBSTAT1 EQU   IEDNQCB+4
QCBPLCBN EQU   QCBSTAT1
QCBWAITC EQU   QCBSTAT1
QCBSNDRQ EQU   QCBSTAT1
QCBRCVRQ EQU   QCBSTAT1
QCBNDXRQ EQU   QCBSTAT1
QCBPLCBA EQU   IEDNQCB+5
QCBTTCIN EQU   QCBPLCBA+1
IEDQRECB EQU   0
RECBQCBA EQU   IEDQRECB+1
RECBPRI  EQU   IEDQRECB+4
RECBLINK EQU   IEDQRECB+5
IEDREQD  EQU   0
REQTYPE  EQU   IEDREQD
REQQCBA  EQU   IEDREQD+1
REQPRI   EQU   IEDREQD+4
REQLINK  EQU   IEDREQD+5
REQRPRI  EQU   IEDREQD+8
REQRQCBA EQU   IEDREQD+9
REQROUTE EQU   IEDREQD+12
REQRCDS  EQU   IEDREQD+14
REQDATA  EQU   IEDREQD+16
IEDRESPL EQU   0
RESOBQCB EQU   IEDRESPL+12
RESFLAGS EQU   IEDRESPL+49
RESQHBL  EQU   IEDRESPL+60
RESMHSRC EQU   IEDRESPL+88
RESPLADR EQU   IEDRESPL+96
RESPLAC  EQU   RESPLADR+44
RESPL42  EQU   RESPLADR+56
IEDQSCB  EQU   0
SCBSTATE EQU   IEDQSCB
SCBSEQIN EQU   SCBSTATE
SCBLCK1N EQU   SCBSTATE
SCBRCVCT EQU   IEDQSCB+4
SCBMBHEN EQU   IEDQSCB+5
SCBBKFCT EQU   IEDQSCB+9
SCBEOBSZ EQU   SCBBKFCT+1
SCBSALEV EQU   IEDQSCB+12
SCBQTYPE EQU   SCBSALEV
SCBBFMM  EQU   SCBQTYPE
SCBERRST EQU   IEDQSCB+16
SCBERR1  EQU   SCBERRST
SCBHDRRN EQU   SCBERR1
SCBORIGN EQU   SCBERR1
SCBNOTRM EQU   SCBERR1
SCBSEQHN EQU   SCBERR1
SCBSEQLN EQU   SCBERR1
SCBCUTFN EQU   SCBERR1
SCBERR2  EQU   SCBERRST+1
SCBABRTN EQU   SCBERR2
SCBERR3  EQU   SCBERRST+2
SCBLOSTN EQU   SCBERR3
SCBTMIDN EQU   SCBERR3
SCBFORMN EQU   SCBERR3
SCBATTN  EQU   SCBERR3
SCBXCEPN EQU   SCBERR3
SCBERR4  EQU   SCBERRST+3
SCBSLCTN EQU   SCBERR4
SCBTXTTN EQU   SCBERR4
SCBCONNN EQU   SCBERR4
SCBCTLUN EQU   SCBERR4
SCBCHANN EQU   SCBERR4
SCBDLPTR EQU   IEDQSCB+22
SCBEOBAC EQU   SCBDLPTR
SCBCTBAC EQU   SCBEOBAC
SCBBSCFM EQU   IEDQSCB+24
SCBDATEN EQU   SCBBSCFM
SCBITBSZ EQU   IEDQSCB+40
SCBCTBSV EQU   SCBITBSZ
SCBDNSEG EQU   IEDQSCB+41
SCBCLSEG EQU   IEDQSCB+45
SCBITBAC EQU   IEDQSCB+48
SCBCTBFL EQU   SCBITBAC
SCBBLKCT EQU   SCBCTBFL
SCBDCSEG EQU   IEDQSCB+49
SCBSTAT1 EQU   IEDQSCB+60
SCBCORE  EQU   IEDQSCB+61
SCBSCAN  EQU   IEDQSCB+64
SCBNTXT  EQU   IEDQSCB+66
SCBCHDR  EQU   IEDQSCB+72
SCBCCSEG EQU   IEDQSCB+75
SCBEND   EQU   IEDQSCB+84
IEDQSPTR EQU   0
IEDSIBD  EQU   0
SIBINDEX EQU   IEDSIBD+8
SIBSESSN EQU   IEDSIBD+10
SIBLGOFF EQU   SIBSESSN
SIBSHUTC EQU   SIBSESSN
SIBSSTAT EQU   SIBSESSN
SIBDSTAT EQU   SIBSESSN
SIBPACIN EQU   IEDSIBD+11
SIBSEQN  EQU   IEDSIBD+12
SIBSTAT1 EQU   IEDSIBD+16
SIBRQSHT EQU   SIBSTAT1
SIBRQEND EQU   SIBSTAT1
SIBFTERM EQU   SIBSTAT1
SIBSTAT2 EQU   IEDSIBD+17
SIBTERM  EQU   SIBSTAT2
SIBFMPRO EQU   IEDSIBD+19
SIBBIND  EQU   IEDSIBD+20
SIBBIND1 EQU   SIBBIND
SIBBIND2 EQU   SIBBIND+1
SIBBIND3 EQU   SIBBIND+2
SIBSTAT0 EQU   IEDSIBD+23
IEDSNSD  EQU   0
SNSSYSTM EQU   IEDSNSD
SNSUSER  EQU   IEDSNSD+2
SNSPTR   EQU   0
IEDRH    EQU   0
TRHBYTE0 EQU   IEDRH
TRHTYPE  EQU   TRHBYTE0
TRHRUCAT EQU   TRHBYTE0
TRHSDI   EQU   TRHBYTE0
TRHBYTE1 EQU   IEDRH+1
TRHBYTE2 EQU   IEDRH+2
IEDQTCXD EQU   0
TCXATTEN EQU   IEDQTCXD+4
TCXFLAG1 EQU   IEDQTCXD+34
TCXBUFA  EQU   IEDQTCXD+80
TCXTOTE  EQU   TCXBUFA
TCXDSAVE EQU   IEDQTCXD+104
TCXQE8   EQU   IEDQTCXD+216
IEDTH    EQU   0
TTHBYTE0 EQU   IEDTH
TTHBYTE1 EQU   IEDTH+1
TTHDAF   EQU   IEDTH+2
TTHOAF   EQU   IEDTH+4
TTHSNF   EQU   IEDTH+6
TTHTAG   EQU   TTHSNF
TTHTAG1  EQU   TTHTAG
TTHDCF   EQU   IEDTH+8
IEDQTNTD EQU   0
IEDQTCDE EQU   IEDQTNTD
TNTENLEN EQU   IEDQTNTD+40
TNTLEN   EQU   IEDQTNTD+44
IEDQTDCE EQU   IEDQTNTD+46
IEDQNPTR EQU   0
TNTFIRST EQU   0
IEDTNTA  EQU   0
IEDTRM   EQU   0
IEDNTRM  EQU   IEDTRM
TRMBYTE4 EQU   IEDNTRM
TRMBYTE3 EQU   IEDNTRM+1
TRMBYTE2 EQU   IEDNTRM+2
TRMINPG  EQU   TRMBYTE2
TRMBYTE1 EQU   IEDNTRM+3
TRMSCPRQ EQU   TRMBYTE1
TRMINPTP EQU   TRMBYTE1
TRMBYTE0 EQU   IEDNTRM+6
TRMSIBPT EQU   IEDNTRM+7
IEDQTRM  EQU   IEDTRM+14
TRMSTATE EQU   IEDQTRM
TRMLOG   EQU   TRMSTATE
TRMDESTQ EQU   IEDQTRM+1
TRMINSEQ EQU   IEDQTRM+4
TLISTCNT EQU   TRMINSEQ
TRMOUTSQ EQU   IEDQTRM+6
TLISTEN  EQU   TRMOUTSQ
TRMDSORG EQU   TLISTEN
TRMALTD  EQU   IEDQTRM+8
TRMDEVFL EQU   IEDQTRM+10
TRMSTAT  EQU   IEDQTRM+12
TRMCHCIN EQU   IEDQTRM+16
IEDXCTMD EQU   0
XCTMCMD  EQU   IEDXCTMD
XCTMCODE EQU   XCTMCMD
XCTMTYPE EQU   XCTMCMD+4
XCTMTERM EQU   XCTMTYPE
XCTMRQID EQU   XCTMCMD+8
XCTMPWRD EQU   XCTMCMD+9
XCTMPTR  EQU   0
IEDXBFL  EQU   0
XBFLSNS  EQU   IEDXBFL+3
XBFLRSN  EQU   IEDXBFL+7
XBFLKEY  EQU   IEDXBFL+8
XBFLPNA  EQU   IEDXBFL+9
XBFLSNA  EQU   IEDXBFL+11
XBFLPTR  EQU   0
IEDXCIND EQU   0
XCINBLEN EQU   IEDXCIND+7
XCINNTNM EQU   IEDXCIND+9
XCINNTYP EQU   XCINNTNM
XCINRQID EQU   IEDXCIND+11
XCINPWRD EQU   IEDXCIND+12
XCINUFLD EQU   IEDXCIND+13
IEDXSST  EQU   0
XSSTKEY  EQU   IEDXSST+3
XSSTPNA  EQU   IEDXSST+4
XSSTSNA  EQU   IEDXSST+6
XSSTPTR  EQU   0
IEDIAP01 EQU   0
IEDIAP04 EQU   0
IEDMVBFR EQU   0
IEDQTL   EQU   0
IEDQTNT  EQU   0
IEDOPTN  EQU   0
CHAR8    EQU   0
CHAR3    EQU   CHAR8
CHAR1    EQU   CHAR3
VARFIELD EQU   0
VARLNGTH EQU   VARFIELD
VCONTBL  EQU   0
A1VCON   EQU   VCONTBL+8
DSPCHAIN EQU   12
DSPLIFO  EQU   56
DSPLIFOR EQU   60
DSPLIST  EQU   8
DSPPOST  EQU   24
DSPPRIO  EQU   48
DSPPRIOR EQU   52
DSPTRACE EQU   64
DSPTSTQ  EQU   32
DSPTSTQR EQU   36
DSPUNAV  EQU   40
DSPUNAVR EQU   44
DSPWAIT  EQU   16
QCBLDCB  EQU   0
TNTCODE  EQU   0
TNTDCODE EQU   0
XCINPTR  EQU   0
XINSPTR  EQU   0
XSNDPTR  EQU   0
CVTS01   EQU   CVTPGSIA
CVTLPDIA EQU   CVTS01+12
CVTDIRST EQU   CVTLPDIA
CVTSLIDA EQU   CVTS01+24
CVTCTLFG EQU   CVTS01+50
CVTRV210 EQU   CVTS01+424
CVTRV219 EQU   CVTS01+425
CVTRV228 EQU   CVTS01+426
CVTRV237 EQU   CVTS01+427
CVTMFRTR EQU   CVTS01+452
CVTRV262 EQU   CVTS01+468
CVTRV271 EQU   CVTS01+469
CVTRV280 EQU   CVTS01+470
CVTRV289 EQU   CVTS01+471
CVTGSDA  EQU   CVTS01+600
LCBRSPIN EQU   LCBIOBSN
LCBLUSNS EQU   LCBRSPIN+5
LCBSCPRS EQU   LCBRSPIN+9
LCBCSWU1 EQU   LCBSCPRS+2
LCBRSPFG EQU   LCBRSPIN+15
LCBCOREQ EQU   LCBTPCD
@NM00139 EQU   LCBCPA+40
LCBNCPPT EQU   @NM00139+1
LCBQNX   EQU   LCBERCCW
LCBQNXMN EQU   LCBQNX
LCBCANCL EQU   LCBSAVSN
LCBCANFG EQU   LCBCANCL
PRFSHDR  EQU   IEDQPRF+42
IEDQQPTR EQU   QCBPTR
REQLDATA EQU   REQDATA
REQLTNT  EQU   REQLDATA
REQSDATA EQU   REQDATA
TRMPRE1  EQU   TRMBYTE4
TRMNCP1  EQU   TRMBYTE4
TRMPRE   EQU   TRMBYTE3
TRMNCP   EQU   TRMBYTE3
TRMNCPCL EQU   TRMNCP
TRMQUCKN EQU   TRMNCP
TRMPU    EQU   TRMBYTE3
TRMLU    EQU   TRMBYTE3
TRMSESRQ EQU   TRMLU
TRMLUREQ EQU   TRMLU
TRMINERR EQU   TRMLU
TRMLINK  EQU   TRMBYTE3
RECBUNCT EQU   RECBQCBA
SCBRGSAV EQU   SCBEND
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00222 EQU   TRMLINK
TRMLSTAT EQU   TRMLINK
TRMLINT  EQU   TRMLINK
TRMEPMOD EQU   TRMLINK
TRMLULOG EQU   TRMLU
TRMTDIFF EQU   TRMLU
TRMLUTM  EQU   TRMLU
TRMLUIT  EQU   TRMLU
TRMAUTO  EQU   TRMLU
TRMPCONT EQU   TRMPU
@NM00221 EQU   TRMPU
TRMNCONT EQU   TRMNCP
TRMSLOWN EQU   TRMNCP
TRMSYGEN EQU   TRMNCP
TRMIPLDM EQU   TRMNCP
TRMINOUT EQU   TRMPRE
TRMRDOUT EQU   TRMPRE
TRMNLOUT EQU   TRMPRE
TRMWROUT EQU   TRMPRE
TRMASNXI EQU   TRMPRE
TRMSTMM  EQU   TRMPRE
TRMCMODE EQU   TRMPRE
TRMSTPND EQU   TRMPRE
@NM00220 EQU   TRMNCP1
TRMINOP  EQU   TRMNCP1
TRMLYNCH EQU   TRMPRE1
TRMSPOUT EQU   TRMPRE1
TRMERLCK EQU   TRMPRE1
TRMQNPL  EQU   TRMPRE1
TRMSPACT EQU   TRMPRE1
TRMOCNI  EQU   TRMPRE1
TRMSESSN EQU   TRMPRE1
TRMCONT  EQU   TRMPRE1
REQSTNT  EQU   REQSDATA+4
REQSTTE  EQU   REQSDATA
@NM00147 EQU   LCBCANCL+3
LCBCANTH EQU   LCBCANCL+1
@NM00146 EQU   LCBCANFG
LCBCANCD EQU   LCBCANFG
@NM00145 EQU   LCBCANFG
LCBCANEB EQU   LCBCANFG
LCBCANXT EQU   LCBCANFG
LCBUNADD EQU   LCBQNX+21
LCBUASZE EQU   LCBQNX+20
LCBDSTEA EQU   LCBQNX+16
@NM00144 EQU   LCBQNX+8
LCBIOSBS EQU   LCBQNX+5
@NM00143 EQU   LCBQNX+4
LCBSTSAV EQU   LCBQNX+1
@NM00142 EQU   LCBQNXMN
LCBNX509 EQU   LCBQNXMN
LCBNX162 EQU   LCBQNXMN
LCBNX142 EQU   LCBQNXMN
LCBNX064 EQU   LCBQNXMN
@NM00141 EQU   @NM00139+4
@NM00140 EQU   @NM00139
LCBWRSCH EQU   LCBCOREQ+8
LCBCQLNK EQU   LCBCOREQ+4
LCBCQELE EQU   LCBCOREQ
LCBPAKCH EQU   LCBRSPIN+16
@NM00138 EQU   LCBRSPFG
LCBRSRH  EQU   LCBRSPFG
LCBEXPI  EQU   LCBRSPFG
@NM00137 EQU   LCBRSPIN+12
LCBUSUE1 EQU   LCBCSWU1
@NM00136 EQU   LCBCSWU1
@NM00135 EQU   LCBSCPRS+1
LCBDFCMD EQU   LCBSCPRS
LCBUSER  EQU   LCBLUSNS+2
LCBSMIN  EQU   LCBLUSNS+1
LCBSMAJ  EQU   LCBLUSNS
LCBRHSV  EQU   LCBRSPIN+2
LCBSNS0  EQU   LCBRSPIN+1
@NM00134 EQU   LCBRSPIN
CVTRV628 EQU   CVTS01+728
CVTRV627 EQU   CVTS01+724
CVTRV626 EQU   CVTS01+720
CVTRV625 EQU   CVTS01+716
CVTRV624 EQU   CVTS01+712
CVTRV623 EQU   CVTS01+708
CVTRV622 EQU   CVTS01+704
CVTRV621 EQU   CVTS01+700
CVTRV620 EQU   CVTS01+696
CVTRV619 EQU   CVTS01+692
CVTRV618 EQU   CVTS01+688
CVTRV617 EQU   CVTS01+684
CVTRV616 EQU   CVTS01+680
CVTRV615 EQU   CVTS01+676
CVTRV614 EQU   CVTS01+672
CVTRV613 EQU   CVTS01+668
CVTTCASP EQU   CVTS01+664
CVT0PT03 EQU   CVTS01+660
CVT0PT0E EQU   CVTS01+656
CVTIRM   EQU   CVTS01+652
CVTCGK   EQU   CVTS01+648
CVTRV607 EQU   CVTS01+644
CVTRV606 EQU   CVTS01+640
CVTRV605 EQU   CVTS01+636
CVTRV604 EQU   CVTS01+632
CVTEFF02 EQU   CVTS01+628
CVTCBBR  EQU   CVTS01+624
CVTSSCR  EQU   CVTS01+620
CVTEVENT EQU   CVTS01+616
CVTCRCA  EQU   CVTS01+612
CVTTPIO  EQU   CVTS01+608
CVTADV   EQU   CVTS01+604
CVTGSDAB EQU   CVTGSDA
CVTQV3   EQU   CVTS01+596
CVTQV2   EQU   CVTS01+592
CVTQV1   EQU   CVTS01+588
CVTRPT   EQU   CVTS01+584
CVTSSRB  EQU   CVTS01+580
CVTCSDRL EQU   CVTS01+576
CVTEXP1  EQU   CVTS01+572
CVTRMPMT EQU   CVTS01+568
CVTRMPTT EQU   CVTS01+564
CVTVPSA  EQU   CVTS01+560
CVTVSTOP EQU   CVTS01+556
CVTGTFR8 EQU   CVTS01+552
CVTQUIT  EQU   CVTS01+548
CVTVACR  EQU   CVTS01+544
CVTWTCB  EQU   CVTS01+540
CVTSTPRS EQU   CVTS01+536
CVT0PT02 EQU   CVTS01+532
CVTDARCM EQU   CVTS01+528
CVTIRECM EQU   CVTS01+524
CVTJRECM EQU   CVTS01+520
CVTVEMS0 EQU   CVTS01+516
CVTSPFRR EQU   CVTS01+512
CVTRLSTG EQU   CVTS01+508
CVT0TC0A EQU   CVTS01+504
CVTGMBR  EQU   CVTS01+500
CVTLFRM  EQU   CVTS01+496
CVTRMBR  EQU   CVTS01+492
CVTVIOP  EQU   CVTS01+488
CVTRV307 EQU   CVTS01+486
CVTRV306 EQU   CVTS01+484
CVTRV305 EQU   CVTS01+482
CVTRV304 EQU   CVTS01+480
CVTRV303 EQU   CVTS01+478
CVTRV302 EQU   CVTS01+476
CVTTRCA  EQU   CVTS01+472
CVTRV297 EQU   CVTRV289
CVTRV296 EQU   CVTRV289
CVTRV295 EQU   CVTRV289
CVTRV294 EQU   CVTRV289
CVTRV293 EQU   CVTRV289
CVTRV292 EQU   CVTRV289
CVTRV291 EQU   CVTRV289
CVTRV290 EQU   CVTRV289
CVTRV288 EQU   CVTRV280
CVTRV287 EQU   CVTRV280
CVTRV286 EQU   CVTRV280
CVTRV285 EQU   CVTRV280
CVTRV284 EQU   CVTRV280
CVTRV283 EQU   CVTRV280
CVTRV282 EQU   CVTRV280
CVTRV281 EQU   CVTRV280
CVTRV279 EQU   CVTRV271
CVTRV278 EQU   CVTRV271
CVTRV277 EQU   CVTRV271
CVTRV276 EQU   CVTRV271
CVTRV275 EQU   CVTRV271
CVTRV274 EQU   CVTRV271
CVTRV273 EQU   CVTRV271
CVTRV272 EQU   CVTRV271
CVTRV270 EQU   CVTRV262
CVTRV269 EQU   CVTRV262
CVTRV268 EQU   CVTRV262
CVTRV267 EQU   CVTRV262
CVTRV266 EQU   CVTRV262
CVTRV265 EQU   CVTRV262
CVTRV264 EQU   CVTRV262
CVTRV263 EQU   CVTRV262
CVTVFP   EQU   CVTS01+464
CVTVSI   EQU   CVTS01+460
CVTVPSIB EQU   CVTS01+456
CVTMFACT EQU   CVTMFRTR
CVTMFCTL EQU   CVTS01+448
CVTPVBP  EQU   CVTS01+444
CVTPWI   EQU   CVTS01+440
CVTRV254 EQU   CVTS01+438
CVTRV253 EQU   CVTS01+436
CVTRV252 EQU   CVTS01+434
CVTRV251 EQU   CVTS01+433
CVTRV250 EQU   CVTS01+432
CVTRV249 EQU   CVTS01+431
CVTRV248 EQU   CVTS01+430
CVTRV247 EQU   CVTS01+429
CVTRV246 EQU   CVTS01+428
CVTRV245 EQU   CVTRV237
CVTRV244 EQU   CVTRV237
CVTRV243 EQU   CVTRV237
CVTRV242 EQU   CVTRV237
CVTRV241 EQU   CVTRV237
CVTRV240 EQU   CVTRV237
CVTRV239 EQU   CVTRV237
CVTRV238 EQU   CVTRV237
CVTRV236 EQU   CVTRV228
CVTRV235 EQU   CVTRV228
CVTRV234 EQU   CVTRV228
CVTRV233 EQU   CVTRV228
CVTRV232 EQU   CVTRV228
CVTRV231 EQU   CVTRV228
CVTRV230 EQU   CVTRV228
CVTRV229 EQU   CVTRV228
CVTRV227 EQU   CVTRV219
CVTRV226 EQU   CVTRV219
CVTRV225 EQU   CVTRV219
CVTRV224 EQU   CVTRV219
CVTRV223 EQU   CVTRV219
CVTRV222 EQU   CVTRV219
CVTRV221 EQU   CVTRV219
CVTRV220 EQU   CVTRV219
CVTRV218 EQU   CVTRV210
CVTRV217 EQU   CVTRV210
CVTRV216 EQU   CVTRV210
CVTRV215 EQU   CVTRV210
CVTRV214 EQU   CVTRV210
CVTRV213 EQU   CVTRV210
CVTRV212 EQU   CVTRV210
CVTRV211 EQU   CVTRV210
CVTLCCAT EQU   CVTS01+420
CVTPCCAT EQU   CVTS01+416
CVTIPCRP EQU   CVTS01+412
CVTIPCRI EQU   CVTS01+408
CVTIPCDS EQU   CVTS01+404
CVTAIDVT EQU   CVTS01+400
CVTSSAP  EQU   CVTS01+396
CVTEHCIR EQU   CVTS01+392
CVTEHDEF EQU   CVTS01+388
CVTDAIR  EQU   CVTS01+384
CVTPERFM EQU   CVTS01+380
CVT044R2 EQU   CVTS01+376
CVTFETCH EQU   CVTS01+372
CVTRSTWD EQU   CVTS01+368
CVTSPOST EQU   CVTS01+364
CVTIOBP  EQU   CVTS01+360
CVTASMVT EQU   CVTS01+356
CVTRECRQ EQU   CVTS01+352
CVTWSAC  EQU   CVTS01+348
CVTRV149 EQU   CVTS01+344
CVTWSAL  EQU   CVTS01+340
CVTSPSA  EQU   CVTS01+336
CVTGLMN  EQU   CVTS01+332
CVTVEAC0 EQU   CVTS01+328
CVT062R1 EQU   CVTS01+324
CVTRPOST EQU   CVTS01+320
CVTDQIQE EQU   CVTS01+316
CVTCSD   EQU   CVTS01+312
CVTLKRMA EQU   CVTS01+308
CVTRSPIE EQU   CVTS01+304
CVTRENQ  EQU   CVTS01+300
CVTLQCB  EQU   CVTS01+296
CVTFQCB  EQU   CVTS01+292
CVTQCS01 EQU   CVTS01+288
CVTAPFT  EQU   CVTS01+284
CVTPARRL EQU   CVTS01+280
CVTVWAIT EQU   CVTS01+276
CVTGSPL  EQU   CVTS01+272
CVTLSMQ  EQU   CVTS01+268
CVTGSMQ  EQU   CVTS01+264
CVTEXPRO EQU   CVTS01+260
CVTOPCTP EQU   CVTS01+256
CVTSIC   EQU   CVTS01+252
CVTTPIOS EQU   CVTS01+248
CVTRTMS  EQU   CVTS01+244
CVTSDBF  EQU   CVTS01+240
CVTSCBP  EQU   CVTS01+236
CVTSDMP  EQU   CVTS01+232
CVTSV60  EQU   CVTS01+228
CVTRTMCT EQU   CVTS01+224
CVTASCBL EQU   CVTS01+220
CVTASCBH EQU   CVTS01+216
CVTGDA   EQU   CVTS01+212
CVTASVT  EQU   CVTS01+208
CVTVVMDI EQU   CVTS01+204
CVTAQTOP EQU   CVTS01+200
CVTIOSCS EQU   CVTS01+196
CVTSDRM  EQU   CVTS01+192
CVTOPTE  EQU   CVTS01+188
CVTSTXU  EQU   CVTS01+184
CVTQUIS  EQU   CVTS01+180
CVTPARS  EQU   CVTS01+176
CVTS1EE  EQU   CVTS01+172
CVTFRAS  EQU   CVTS01+168
CVTQSAS  EQU   CVTS01+164
CVTCRAS  EQU   CVTS01+160
CVTCRMN  EQU   CVTS01+156
CVTDELCP EQU   CVTS01+152
CVTFRECL EQU   CVTS01+148
CVTGETCL EQU   CVTS01+144
CVTBLDCP EQU   CVTS01+140
CVTAUTHL EQU   CVTS01+136
CVTSCAN  EQU   CVTS01+132
CVTRV144 EQU   CVTS01+130
CVTMAXMP EQU   CVTS01+128
CVTSTCK  EQU   CVTS01+124
CVTRV139 EQU   CVTS01+123
CVTDSSAC EQU   CVTS01+122
CVTRV513 EQU   CVTS01+121
CVTIOSPL EQU   CVTS01+120
CVTPTGT  EQU   CVTS01+116
CVTCSPIE EQU   CVTS01+112
CVTSMFEX EQU   CVTS01+108
CVTOLT0A EQU   CVTS01+104
CVTSRBRT EQU   CVTS01+100
CVTPUTL  EQU   CVTS01+96
CVTASCRL EQU   CVTS01+92
CVTASCRF EQU   CVTS01+88
CVTRV326 EQU   CVTS01+84
CVTRV325 EQU   CVTS01+80
CVTRV324 EQU   CVTS01+76
CVT0VL01 EQU   CVTS01+72
CVTSHRVM EQU   CVTS01+68
CVTRV332 EQU   CVTS01+64
CVTTAS   EQU   CVTS01+60
CVTRSCN  EQU   CVTS01+56
CVTTRAC2 EQU   CVTS01+54
CVTTRACE EQU   CVTS01+52
CVTAPG   EQU   CVTS01+51
CVTSDTRC EQU   CVTCTLFG
CVTGTRCE EQU   CVTCTLFG
CVTNOMP  EQU   CVTCTLFG
CVTRSV79 EQU   CVTCTLFG
CVTDSTAT EQU   CVTCTLFG
CVTRSV78 EQU   CVTCTLFG
CVTRV333 EQU   CVTCTLFG
CVTRV323 EQU   CVTCTLFG
CVTSPVLK EQU   CVTS01+49
CVTRSV77 EQU   CVTS01+48
CVTRV331 EQU   CVTS01+44
CVTRV330 EQU   CVTS01+40
CVTRV329 EQU   CVTS01+36
CVTRV328 EQU   CVTS01+32
CVTRV322 EQU   CVTS01+28
CVTSLID  EQU   CVTSLIDA+1
CVTSYLK  EQU   CVTSLIDA
CVTRV321 EQU   CVTS01+20
CVTRV320 EQU   CVTS01+16
CVTLPDIR EQU   CVTLPDIA+1
CVTRSV69 EQU   CVTDIRST
CVTRSV68 EQU   CVTDIRST
CVTRSV67 EQU   CVTDIRST
CVTRSV66 EQU   CVTDIRST
CVTRSV65 EQU   CVTDIRST
CVTRSV64 EQU   CVTDIRST
CVTRSV63 EQU   CVTDIRST
CVTDICOM EQU   CVTDIRST
CVTPVTP  EQU   CVTS01+8
CVTLPDSR EQU   CVTS01+4
CVTGETL  EQU   CVTS01
@NM00231 EQU   VCONTBL
VARDATA  EQU   VARFIELD+1
@NM00230 EQU   CHAR8+3
@NM00229 EQU   CHAR3+1
XSSTCODE EQU   IEDXSST
XCINUSFD EQU   XCINUFLD+1
XCINULEN EQU   XCINUFLD
XCINPSWD EQU   XCINPWRD+1
XCINPLEN EQU   XCINPWRD
XCINRID  EQU   XCINRQID+1
XCINRLEN EQU   XCINRQID
XCINNAME EQU   XCINNTNM+2
XCINNLEN EQU   XCINNTNM+1
XCINBIMG EQU   IEDXCIND+9
XCINADDR EQU   IEDXCIND+5
XCINORG  EQU   IEDXCIND+4
XCINFMT  EQU   IEDXCIND+3
XCINCODE EQU   IEDXCIND
XBFLCODE EQU   IEDXBFL
XCTMPSWD EQU   XCTMPWRD+1
XCTMPLEN EQU   XCTMPWRD
XCTMRID  EQU   XCTMRQID+1
XCTMRLEN EQU   XCTMRQID
XCTMRSN  EQU   XCTMCMD+7
XCTMSNA  EQU   XCTMCMD+5
@NM00223 EQU   XCTMTYPE
XCTMFMT  EQU   XCTMCMD+3
XCTMREQ  EQU   XCTMCODE+2
XCTMSESS EQU   XCTMCODE+1
XCTMNETS EQU   XCTMCODE
TRMOPT   EQU   IEDTRM+34
TRMOPTBL EQU   IEDQTRM+18
TRMOPNO  EQU   IEDQTRM+17
TRMSENSE EQU   TRMSTAT+3
TRMTEMPR EQU   TRMSTAT+2
TRMSIO   EQU   TRMSTAT
@NM00219 EQU   TRMDEVFL+1
TRMTPIN  EQU   TRMDEVFL+1
TRMNCPI  EQU   TRMDEVFL+1
TRMRNTRM EQU   TRMDEVFL+1
@NM00218 EQU   TRMDEVFL+1
TRMLMD   EQU   TRMDEVFL+1
TRMCONC  EQU   TRMDEVFL+1
TRMTSOB  EQU   TRMDEVFL
TRMBFDY  EQU   TRMDEVFL
TRMTBLK  EQU   TRMDEVFL
TRMSBLK  EQU   TRMDEVFL
TRMBLKS  EQU   TRMDEVFL
TRMADDC  EQU   TRMDEVFL
TRMDDIG  EQU   TRMDEVFL
TRMBUFS  EQU   TRMDEVFL
TRMPRILK EQU   TRMALTD
TRMLGB   EQU   TRMDSORG
TRMUTERM EQU   TLISTCNT
TRMSCNYN EQU   TRMSTATE
TRMOPTFN EQU   TRMSTATE
TRMHELDN EQU   TRMSTATE
TRMACPTN EQU   TRMSTATE
TRMPREF  EQU   TRMSTATE
TRMPROC  EQU   TRMLOG
TRMLIST  EQU   TRMLOG
TRMLINE  EQU   TRMSTATE
TRMSUBST EQU   IEDNTRM+12
TRMTYPE  EQU   IEDNTRM+11
TRMRLMCT EQU   IEDNTRM+10
TRMCOHTG EQU   TRMSIBPT+1
TRMGPCNT EQU   TRMSIBPT
TRMBUFRD EQU   TRMBYTE0
TRMSNA   EQU   TRMBYTE0
TRMGP    EQU   TRMBYTE0
TRMDIAL  EQU   TRMBYTE0
@NM00217 EQU   TRMBYTE0
TRMOUTPT EQU   TRMBYTE0
TRMINPUT EQU   TRMBYTE0
TRMUDEF  EQU   TRMBYTE0
TRMCOHRT EQU   IEDNTRM+4
TRMSTOTE EQU   TRMBYTE1
TRMCKPRN EQU   TRMBYTE1
TRMTSATN EQU   TRMBYTE1
TRMTRACE EQU   TRMBYTE1
TRMSWBCK EQU   TRMBYTE1
TRMAUTOC EQU   TRMBYTE1
TRMWTNEG EQU   TRMSCPRQ
TRMWRBRK EQU   TRMBYTE2
TRMNOSND EQU   TRMBYTE2
TRMPREP  EQU   TRMBYTE2
TRMGPACT EQU   TRMBYTE2
TRMANDL  EQU   TRMBYTE2
TRMCLOSN EQU   TRMINPG
TRMREMB  EQU   TRMBYTE2
TRMRSACT EQU   TRMBYTE2
TNTTRMAD EQU   IEDTNTA
TNTMIDEN EQU   IEDQTNTD+41
TNTSRCHX EQU   IEDQTNTD+38
TTHTAG2  EQU   TTHTAG+1
@NM00216 EQU   TTHTAG1
TTHTAGS  EQU   TTHTAG1
TTHEFI   EQU   TTHBYTE0
@NM00215 EQU   TTHBYTE0
TTHEBIU  EQU   TTHBYTE0
TTHBBIU  EQU   TTHBYTE0
TTHFTYPE EQU   TTHBYTE0
TCXEND   EQU   IEDQTCXD+224
TCXNCPIO EQU   IEDQTCXD+220
TCXACTE8 EQU   TCXQE8
TCXABEPL EQU   IEDQTCXD+212
TCXSRBS  EQU   IEDQTCXD+208
TCXSIOSB EQU   IEDQTCXD+204
TCXESAVE EQU   IEDQTCXD+132
TCXERPPM EQU   IEDQTCXD+128
TCXERPSV EQU   IEDQTCXD+116
TCXSATTN EQU   IEDQTCXD+112
@NM00214 EQU   TCXDSAVE+4
@NM00213 EQU   TCXDSAVE
TCXPLCB  EQU   IEDQTCXD+100
TCXBITS  EQU   IEDQTCXD+98
TCXSCBSZ EQU   IEDQTCXD+97
TCXBIT1  EQU   IEDQTCXD+96
TCXCOMPT EQU   IEDQTCXD+92
TCXAVAIL EQU   IEDQTCXD+88
TCXBUFL  EQU   IEDQTCXD+84
TCXCKPM  EQU   IEDQTCXD+79
TCXNCKPR EQU   IEDQTCXD+78
TCXSZAIB EQU   IEDQTCXD+76
TCXAIBC  EQU   IEDQTCXD+72
TCXPEBC  EQU   IEDQTCXD+68
TCXPEWAC EQU   IEDQTCXD+64
TCXQRQ   EQU   IEDQTCXD+60
TCXOCQ   EQU   IEDQTCXD+56
TCXPNTQ  EQU   IEDQTCXD+52
TCXPUTQ  EQU   IEDQTCXD+48
TCXGETQ  EQU   IEDQTCXD+44
TCXTSI   EQU   IEDQTCXD+40
TCXRPT   EQU   IEDQTCXD+36
TCXCC3TS EQU   IEDQTCXD+35
TCXAPDMP EQU   TCXFLAG1
TCXAPPL  EQU   TCXFLAG1
TCXRTM   EQU   TCXFLAG1
TCXMCPCD EQU   TCXFLAG1
TCXAUTH  EQU   TCXFLAG1
TCXASID  EQU   IEDQTCXD+32
TCXASCB  EQU   IEDQTCXD+28
TCXREADY EQU   IEDQTCXD+24
TCXPASWD EQU   IEDQTCXD+16
TCXDISP  EQU   IEDQTCXD+12
TCXTCB   EQU   IEDQTCXD+8
TCXATTLN EQU   TCXATTEN
TCXAVT   EQU   IEDQTCXD
@NM00212 EQU   TRHBYTE2
@NM00211 EQU   TRHBYTE2
@NM00210 EQU   TRHBYTE2
TRHCSI   EQU   TRHBYTE2
@NM00209 EQU   TRHBYTE2
TRHCDI   EQU   TRHBYTE2
TRHEB    EQU   TRHBYTE2
TRHBB    EQU   TRHBYTE2
TRHPI    EQU   TRHBYTE1
@NM00208 EQU   TRHBYTE1
@NM00207 EQU   TRHBYTE1
@NM00206 EQU   TRHBYTE1
TRHER    EQU   TRHBYTE1
TRHDR2   EQU   TRHBYTE1
@NM00205 EQU   TRHBYTE1
TRHDR1   EQU   TRHBYTE1
TRHEC    EQU   TRHBYTE0
TRHBC    EQU   TRHBYTE0
TRHFI    EQU   TRHBYTE0
@NM00204 EQU   TRHBYTE0
SNSUSR2  EQU   SNSUSER+1
SNSUSR1  EQU   SNSUSER
SNSMIN   EQU   SNSSYSTM+1
SNSMAJ   EQU   SNSSYSTM
SIBLUTYP EQU   SIBSTAT0
SIBCD    EQU   SIBSTAT0
@NM00203 EQU   SIBBIND3
SIBCRES  EQU   SIBBIND3
SIBSPKR  EQU   SIBBIND3
SIBRECOV EQU   SIBBIND3
SIBFMODE EQU   SIBBIND3
SIBALT   EQU   SIBBIND2
SIBBTERM EQU   SIBBIND2
SIBBRACK EQU   SIBBIND2
SIBFMUSE EQU   SIBBIND2
SIBSEBI  EQU   SIBBIND2
SIBSCMP  EQU   SIBBIND2
SIBSEXC  EQU   SIBBIND2
SIBSDEF  EQU   SIBBIND2
SIBSRQM  EQU   SIBBIND1
SIBSCHNG EQU   SIBBIND1
SIBPEBI  EQU   SIBBIND1
SIBPCMP  EQU   SIBBIND1
SIBPEXC  EQU   SIBBIND1
SIBPDEF  EQU   SIBBIND1
SIBPRQM  EQU   SIBBIND1
SIBPCHN  EQU   SIBBIND1
SIBTSPRO EQU   IEDSIBD+18
@NM00202 EQU   SIBSTAT2
SIBDACLU EQU   SIBSTAT2
SIBRDSCN EQU   SIBSTAT2
SIBUSS   EQU   SIBSTAT2
SIBBSTAT EQU   SIBSTAT1
SIBRTRP  EQU   SIBSTAT1
SIBSEQO  EQU   SIBSEQN+2
SIBSEQI  EQU   SIBSEQN
SIBNCNT  EQU   SIBPACIN
SIBMCNT  EQU   SIBPACIN
SIBINBIU EQU   SIBSESSN
SIBCHAIN EQU   IEDSIBD+4
SIBRUSEG EQU   IEDSIBD
SCBTRANS EQU   IEDQSCB+81
SCBUNTCT EQU   IEDQSCB+80
SCBEOB   EQU   IEDQSCB+78
SCBNXCPB EQU   SCBCCSEG
SCBNHDR  EQU   SCBCHDR
SCBCRCD  EQU   IEDQSCB+69
SCBTQBCK EQU   SCBNTXT
SCBOSEQ  EQU   SCBSCAN
SCBXTRA  EQU   SCBCORE
SCBNOPST EQU   SCBSTAT1
SCBNIDLE EQU   SCBSTAT1
SCBCEND  EQU   SCBSTAT1
SCBCBGN  EQU   SCBSTAT1
SCBSIZE  EQU   IEDQSCB+58
SCBSRCE  EQU   IEDQSCB+56
SCBDEOB  EQU   IEDQSCB+52
SCBFEFO  EQU   SCBDCSEG
SCBCTBND EQU   SCBBLKCT
SCBSCHDR EQU   SCBCLSEG
SCBHBFNO EQU   IEDQSCB+44
SCBSCSEG EQU   SCBDNSEG
SCBBCTR  EQU   SCBCTBSV
SCBCCHDR EQU   IEDQSCB+37
SCBDESTL EQU   IEDQSCB+36
SCBDCHDR EQU   IEDQSCB+33
SCBCPBNO EQU   IEDQSCB+32
SCBMBSSA EQU   IEDQSCB+25
SCBMLMTN EQU   SCBBSCFM
SCBNOEOT EQU   SCBBSCFM
@NM00201 EQU   SCBBSCFM
SCBNPDTR EQU   SCBDATEN
SCBCNTEN EQU   SCBBSCFM
SCBRCVTX EQU   SCBBSCFM
SCBNONTR EQU   SCBBSCFM
SCBTRNSP EQU   SCBBSCFM
SCBENDCR EQU   SCBCTBAC+1
SCBCRLEN EQU   SCBCTBAC
SCBMRFSD EQU   IEDQSCB+20
SCBUNDFN EQU   SCBERR4
SCBSTERN EQU   SCBCHANN
SCBCPMEN EQU   SCBCTLUN
@NM00200 EQU   SCBERR4
SCBTRMLN EQU   SCBERR4
SCBAPERR EQU   SCBTXTTN
SCBPERRN EQU   SCBXCEPN
SCBTHRSN EQU   SCBATTN
SCBFIERN EQU   SCBFORMN
SCBUSERN EQU   SCBERR3
SCBSATTN EQU   SCBERR3
SCBTMINN EQU   SCBERR3
SCBXPD   EQU   SCBTMIDN
SCBXPI   EQU   SCBLOSTN
SCBSOHE  EQU   SCBERR2
SCBFRWDN EQU   SCBERR2
SCBRRJN  EQU   SCBABRTN
SCBOLTR  EQU   SCBERR2
SCBALN   EQU   SCBERR2
SCBCODER EQU   SCBERR2
SCBCRMAX EQU   SCBERR2
SCBCRMIN EQU   SCBERR2
SCBRVISL EQU   SCBCUTFN
SCBNOBFN EQU   SCBERR1
@NM00199 EQU   SCBERR1
SCBNOVAC EQU   SCBSEQLN
SCBNOTSO EQU   SCBSEQHN
SCBRVITX EQU   SCBNOTRM
SCBHANG  EQU   SCBORIGN
SCBNOLOG EQU   SCBHDRRN
SCBMRFPL EQU   IEDQSCB+13
SCBBBFTM EQU   SCBQTYPE
SCBNOFF  EQU   SCBQTYPE
SCBCONC  EQU   SCBQTYPE
SCBNREUS EQU   SCBQTYPE
SCBREUS  EQU   SCBQTYPE
SCBCOREQ EQU   SCBQTYPE
SCBNORCL EQU   SCBQTYPE
SCBCTBSZ EQU   SCBEOBSZ
@NM00198 EQU   SCBBKFCT
SCBPRI   EQU   IEDQSCB+8
SCBMACR  EQU   SCBMBHEN
SCBSNDCT EQU   SCBRCVCT
SCBDESTQ EQU   IEDQSCB+1
SCBCODE  EQU   SCBSTATE
SCBPRER  EQU   SCBSTATE
SCBCKPT  EQU   SCBSTATE
SCBMSGLN EQU   SCBSTATE
SCBERSDS EQU   SCBSTATE
SCBMGFMN EQU   SCBSEQIN
SCBTRANP EQU   SCBSTATE
RESAPDCB EQU   IEDRESPL+180
RESTLIB  EQU   IEDRESPL+176
RESPL33  EQU   RESPLADR+76
RESPL25  EQU   RESPLADR+72
RESPLM2  EQU   RESPLADR+68
RESPL47  EQU   RESPLADR+64
RESPL44  EQU   RESPLADR+60
RESPL43  EQU   RESPL42
RESPL16  EQU   RESPLADR+52
RESPL41  EQU   RESPLADR+48
RESPL21  EQU   RESPLAC
RESPL36  EQU   RESPLADR+40
RESPL28  EQU   RESPLADR+36
RESPL37  EQU   RESPLADR+32
RESPLP2  EQU   RESPLADR+28
RESPLP1  EQU   RESPLADR+24
RESPL39  EQU   RESPLADR+20
RESPLAA  EQU   RESPLADR+16
RESPL35  EQU   RESPLADR+12
RESPLAJ  EQU   RESPLADR+8
RESPLAB  EQU   RESPLADR+4
RESPLWO  EQU   RESPLADR
RESTOTMH EQU   IEDRESPL+92
RESMHNAT EQU   IEDRESPL+90
RESFBUF  EQU   IEDRESPL+84
RESABUF  EQU   IEDRESPL+80
RESPLRVT EQU   IEDRESPL+76
RESADDAF EQU   RESQHBL+12
RESADDND EQU   RESQHBL+8
RESREMEL EQU   RESQHBL+4
RESREMFR EQU   RESQHBL
RESTNTPT EQU   IEDRESPL+57
@NM00197 EQU   IEDRESPL+56
RESTRMQ  EQU   IEDRESPL+52
@NM00196 EQU   IEDRESPL+50
@NM00195 EQU   RESFLAGS
RESFIRST EQU   RESFLAGS
RESINIT  EQU   RESFLAGS
RESWBFNC EQU   IEDRESPL+48
RESSMGRA EQU   IEDRESPL+44
RESSTAEA EQU   IEDRESPL+40
RESETXRA EQU   IEDRESPL+36
RESDMTTE EQU   IEDRESPL+33
RESTNTCT EQU   IEDRESPL+32
RESEFQCB EQU   IEDRESPL+28
RESBKAVL EQU   IEDRESPL+26
RESBKTOT EQU   IEDRESPL+24
RESTTLST EQU   IEDRESPL+20
RESOBBKW EQU   RESOBQCB+4
RESOBFWD EQU   RESOBQCB
RESTECB1 EQU   IEDRESPL+8
@NM00194 EQU   IEDRESPL+5
@NM00193 EQU   IEDRESPL+4
RESTECBS EQU   IEDRESPL
REQRCD2  EQU   REQRCDS+1
REQRCD1  EQU   REQRCDS
REQSWTCH EQU   REQROUTE+1
REQFLAG  EQU   REQROUTE
RECBKEY  EQU   IEDQRECB
@NM00192 EQU   QCBPLCBA
@NM00191 EQU   QCBSTAT1
QCBFLUSH EQU   QCBSTAT1
QCBESIG  EQU   QCBSTAT1
QCBCHAIN EQU   IEDNQCB
QCBPQBCK EQU   IEDQPQCB+25
QCBCFHDR EQU   IEDQPQCB+21
QCBLFEFO EQU   IEDQPQCB+18
QCBPREVF EQU   QCBINTLF
QCBINTFF EQU   IEDQPQCB+9
QCBDATSQ EQU   QCBFHDTZ+1
@NM00190 EQU   QCBFHDTZ
@NM00189 EQU   QCBPFEFO
QCBDATFL EQU   QCBFHDLZ
QCBDNHDR EQU   IEDQPQCB
QCBQBACK EQU   IEDQQCB+37
QCBCKPT  EQU   QCBFLAG
QCBPROC  EQU   QCBFLAG
QCBSDFFO EQU   QCBFLAG
QCBTERMQ EQU   QCBFLAG
QCBRSRV  EQU   QCBFLAG
QCBREAD  EQU   QCBFLAG
QCBNOBRK EQU   QCBFLAG
QCBTSSES EQU   QCBFLAG
QCBRELLN EQU   IEDQQCB+32
QCBTJID  EQU   QCBLKRRN+1
QCBCARCT EQU   QCBLKRRN
QCBPRLVL EQU   QCBPREN
QCBMSGCT EQU   IEDQQCB+26
QCBEXTO  EQU   QCBINTVL
QCBDISC  EQU   QCBTSOF1
QCBDELAY EQU   QCBTSOF1
QCBPARTO EQU   QCBTSOF1
QCBSATRD EQU   QCBTSOF1
QCBNOBUF EQU   QCBTSOF1
QCBTPUT  EQU   QCBTSOF1
QCBTGET  EQU   QCBTSOF1
QCBWRBRK EQU   QCBTSOF1
QCBSATLC EQU   QCBTSOF2
QCBSATTI EQU   QCBTSOF2
QCBSATCH EQU   QCBTSOF2
QCBSIMRD EQU   QCBTSOF2
QCBDSSMI EQU   QCBTSOF2
QCBPOSTO EQU   QCBTSOF2
QCBBUFQ  EQU   QCBTSOF2
QCBINHBN EQU   QCBTSOF2
QCBSATCT EQU   @NM00188
QCBSCBOF EQU   IEDQQCB+20
QCBTIME  EQU   QCBSTAT
QCBCLOCK EQU   QCBSTAT
QCBSCHDL EQU   QCBSTAT
QCBSMODE EQU   QCBSTAT
QCBSEND  EQU   QCBSTAT
QCBBUFRD EQU   QCBSTAT
QCBEOM   EQU   QCBSTAT
QCBHUCT  EQU   QCBRETCT
QCBIEND  EQU   QCBRETCT
QCBEND   EQU   QCBRETCT
QCBNL    EQU   QCBRETCT
QCBLOGCT EQU   QCBRETCT
@NM00187 EQU   QCBBYTE1
QCBRITRM EQU   QCBBYTE1
@NM00186 EQU   QCBEOLDT
QCBPRI   EQU   IEDQQCB+4
QCBCNTEN EQU   QCBELCHN+2
@NM00185 EQU   QCBELCHN+2
@NM00184 EQU   QCBELCHN
QCBFQCB  EQU   QCBDSFLG
QCBDRQQ  EQU   QCBDSFLG
QCBALTMH EQU   QCBDSFLG
QCBREUS  EQU   QCBDISK
QCBNREUS EQU   QCBDISK
QCBCORE  EQU   QCBDSFLG
@NM00183 EQU   PROFLAG
PRODATE  EQU   PROFLAG
PROSECQ  EQU   PROFLAG
PROLEN   EQU   IEDPROC
PRF2SEQP EQU   PRF2WD2
@NM00182 EQU   IEDPF2+1
@NM00181 EQU   PRF2FLG2
PRF2TERM EQU   PRF2FLG2
PRF2SMI  EQU   PRF2FLG2
PRF2FORM EQU   PRF2FLG2
PRF1RULN EQU   PRF1SEQP+2
PRF1TAG2 EQU   PRF1SQID+1
@NM00180 EQU   PRF1TAG1
PRF1TAGS EQU   PRF1TAG1
@NM00179 EQU   PRF1FLG1
PRF1USS  EQU   PRF1FLG1
PRF1FORM EQU   PRF1FLG1
PRF1EXPI EQU   PRF1FLG1
PRFSTXT  EQU   PRFHQBCK
PRFSVSEQ EQU   PRFNTXT+1
PRFSVPRI EQU   PRFEOBOF
PRFISIZE EQU   PRFSCAN+1
@NM00178 EQU   PRFSCAN
PRFEOB   EQU   PRFXTRA+1
PRFSTSO  EQU   PRFXTRA
PRFNHDRN EQU   PRFSTAT1
PRFNLSTN EQU   PRFSTAT1
PRFLOCK  EQU   PRFEOFN
PRFDUPLN EQU   PRFSTAT1
PRFTSMSG EQU   PRFSTAT1
PRFITCPN EQU   PRFSTAT1
PRFERMGN EQU   PRFSTAT1
PRFCNCLN EQU   PRFSTAT1
PRFSVFLG EQU   @NM00177+3
PRFTI0   EQU   PRFTIC+1
@NM00176 EQU   PRFTICC
@NM00175 EQU   PRFTICC
@NM00174 EQU   PRFTICC
PRFTICON EQU   PRFTICC
@NM00173 EQU   PRFTICC
@NM00172 EQU   PRFTICC
PRFBFMM  EQU   PRFTICC
PRFEOMSG EQU   PRFTICC
PRFCOUNT EQU   PRFLINK+1
@NM00171 EQU   PRFLINK
PRFFLAGS EQU   PRFPRI
PRFIOADR EQU   PRFQCBA
PRFOPCDE EQU   PRFKEY
PLMVUNCA EQU   IEDPLMV+20
PLMVFLG2 EQU   IEDPLMV+19
@NM00170 EQU   PLMVFLG1
PLMVTCTG EQU   PLMVFLG1
PLMVUNCF EQU   PLMVFLG1
MHTABEND EQU   MHNAME
LGBIVLST EQU   IEDNLGB+60
LGBRESV4 EQU   LGBRESER+3
LGBRESV3 EQU   LGBRESER+2
LGBRESV2 EQU   LGBRESER+1
LGBRESV1 EQU   LGBRESER
LGBBUFSI EQU   IEDNLGB+54
@NM00169 EQU   IEDNLGB+53
LGBILCT  EQU   IEDNLGB+52
LGBSCTAD EQU   IEDNLGB+49
@NM00168 EQU   LGBOFLGS
LGBOPEN  EQU   LGBOFLGS
@NM00167 EQU   LGBOFLGS
LGBNAME  EQU   IEDNLGB+40
@NM00166 EQU   IEDNLGB+36
LGBTRANS EQU   IEDNLGB+33
@NM00165 EQU   IEDNLGB+32
@NM00164 EQU   IEDNLGB+31
LGBOPACE EQU   IEDNLGB+30
@NM00163 EQU   LGBBYTE
LGBPACK  EQU   LGBBYTE
LGBBUFMA EQU   IEDNLGB+28
LGBDSORG EQU   IEDNLGB+26
@NM00162 EQU   LGBPCI
@NM00161 EQU   LGBPCI
LGBPCINO EQU   LGBPCI
@NM00160 EQU   LGBPCI
LGBPCIAO EQU   LGBPCI
@NM00159 EQU   LGBPCI
@NM00158 EQU   LGBPCI
@NM00157 EQU   LGBPCI
@NM00156 EQU   IEDNLGB+24
LGBMHA   EQU   IEDNLGB+21
@NM00155 EQU   LGBBUFOU
LGBPREF  EQU   LGBBUFOU
@NM00154 EQU   LGBBUFOU
LGBSUBST EQU   IEDNLGB+18
LGBTYPE  EQU   IEDNLGB+17
@NM00153 EQU   IEDNLGB
LCBERADR EQU   LCBXRADR+1
LCBPCIRC EQU   LCBXRADR
LCBDCT3  EQU   LCBXDCT+2
LCBDCT2  EQU   LCBXDCT+1
LCBDCT1  EQU   LCBXDCT
@NM00152 EQU   LCBXFLAG
LCBERPND EQU   LCBXFLAG
LCBSRCPF EQU   LCBXFLAG
LCBGPCTV EQU   LCBXFLAG
@NM00151 EQU   LCBXFLAG
@NM00150 EQU   LCBXFLAG
@NM00149 EQU   LCBXFLAG
@NM00148 EQU   LCBXFLAG
LCBCCW10 EQU   LCBCPA+72
LCBCCW9  EQU   LCBCPA+64
LCBCCW8  EQU   LCBCPA+56
LCBCCW7  EQU   LCBCPA+48
LCBCCW6  EQU   LCBCPA+40
LCBCP    EQU   LCBQEBPL+4
LCBIOSB  EQU   LCBQEBPL+1
LCBSIO   EQU   LCBQEBPL
LCBCCW4  EQU   LCBCPA+24
LCBCCW3  EQU   LCBCPA+16
LCBCCW2  EQU   LCBCPA+8
LCBCCW1  EQU   LCBCPA
@NM00133 EQU   LCBERCCW+16
LCBATL05 EQU   LCBERCCW+8
@NM00132 EQU   LCBERCCW
LCBCSWSV EQU   LCBSAVSN+1
LCBSNSV  EQU   LCBSAVSN
LCBINPAK EQU   LCBSTAT6
LCBMHBID EQU   LCBSTAT6
LCBRTRRO EQU   LCBSTAT6
LCBHDRPD EQU   LCBSTAT6
LCBCHN   EQU   LCBSTAT6
@NM00131 EQU   LCBSTAT5
LCBLUNIT EQU   LCBSTAT5
LCBPERM  EQU   LCBSTAT5
LCBNXCMD EQU   LCBBFRW
LCBERMSK EQU   LCBOBRCH
LCBOLT   EQU   LCBMSGFM
LCBEOT   EQU   LCBMSGFM
LCBENQ   EQU   LCBMSGFM
LCBTTD   EQU   LCBMSGFM
LCBRSTRT EQU   LCBMSGFM
LCBVSTRT EQU   LCBMSGFM
LCBACKI  EQU   LCBMSGFM
LCBNAK   EQU   LCBMSGFM
@NM00130 EQU   LCBRBCT2
LCBDCNT  EQU   LCBRBCT2
LCBCOMPL EQU   LCBDLNKN
LCBERROR EQU   LCBERBST
@NM00129 EQU   LCBERBST
LCBINQ   EQU   LCBERBST
LCBRDERR EQU   LCBERBST
LCBEOMSG EQU   LCBERBST
LCBMSG   EQU   LCBERBST
LCBERBLK EQU   IEDQLCB+81
LCBERBKY EQU   LCBERB
LCBRECAD EQU   IEDQLCB+73
@NM00128 EQU   LCBTSTSW
@NM00127 EQU   LCBTSTSW
@NM00126 EQU   LCBTSTSW
@NM00125 EQU   LCBTSTSW
@NM00124 EQU   LCBTSTSW
@NM00123 EQU   LCBTSTSW
@NM00122 EQU   LCBTSTSW
LCBCONCT EQU   LCBTSTSW
LCBRESP  EQU   LCBSTAT2
LCBBFRAV EQU   LCBDIAL
LCBATTN  EQU   LCBSYNC
LCBNEGRP EQU   LCBSTAT2
LCBSNDPR EQU   LCBSTAT2
LCBCONNN EQU   LCBBEOTN
LCBMSGNN EQU   LCBSTAT2
LCBTRACE EQU   LCBSTAT2
LCBFREEN EQU   LCBSTAT1
LCBCONT  EQU   LCBSTAT1
LCBINITN EQU   LCBSTAT1
LCBOCNI  EQU   LCBSTAT1
LCBOCWTN EQU   LCBSTAT1
LCBRCLLN EQU   LCBSTAT1
LCBRECOF EQU   IEDQLCB+68
LCBRDBFR EQU   LCBRCBFR
LCBUCBX  EQU   IEDQLCB+64
LCBTTBIN EQU   LCBERRCT
@NM00121 EQU   LCBINCAM
LCBGETMN EQU   LCBINCAM
@NM00120 EQU   LCBRESTR+1
LCBCMDSV EQU   LCBRESTR
LCBPCILK EQU   LCBDCBPT
LCBSTART EQU   LCBIOBSN+16
LCBAP4OL EQU   LCBSIOCC
LCBAP3OL EQU   LCBSIOCC
LCBAP2OL EQU   LCBSIOCC
LCBAP1OL EQU   LCBSIOCC
LCBSIOC2 EQU   LCBSIOCC
LCBSIOC1 EQU   LCBSIOCC
@NM00119 EQU   LCBSIOCC
LCBCSWRC EQU   LCBCSW+5
LCBCSCHC EQU   LCBCSWCS
LCBCSICC EQU   LCBCSWCS
LCBCSCCC EQU   LCBCSWCS
LCBCSCDC EQU   LCBCSWCS
LCBCSPTC EQU   LCBCSWCS
LCBCSPGC EQU   LCBCSWCS
LCBCSIL  EQU   LCBCSWCS
LCBCSPCI EQU   LCBCSWCS
LCBUSUC  EQU   LCBCSWUS
LCBUSDE  EQU   LCBCSWUS
LCBUSCE  EQU   LCBCSWUS
LCBUSBSY EQU   LCBCSWUS
LCBUSCUE EQU   LCBCSWUS
LCBUSSM  EQU   LCBCSWUS
LCBUSAT  EQU   LCBCSWUS
LCBCSWCA EQU   LCBCSW
LCBOBR   EQU   LCBFLAG3
LCBOBRRD EQU   LCBFLAG3
LCBIOMSG EQU   LCBFLAG3
LCBSOHC  EQU   LCBFLAG3
LCBRLAD  EQU   LCBFLAG3
LCBSOHR  EQU   LCBFLAG3
@NM00118 EQU   LCBFLAG3
LCBECBPT EQU   LCBIOBSN+4
LCBECBCC EQU   LCBIOBSN+3
LCBSENS1 EQU   LCBSNS+1
LCBABORT EQU   LCBTMOUT
LCBNOTIN EQU   LCBLOSDT
LCBOVRUN EQU   LCBSENS0
LCBDATCK EQU   LCBSENS0
LCBEQUCK EQU   LCBSENS0
LCBBUSCK EQU   LCBSENS0
LCBINTRQ EQU   LCBSENS0
LCBCMDRJ EQU   LCBSENS0
LCBFLAG2 EQU   LCBIOBSN
@NM00117 EQU   LCBFLAG1
LCBUNREL EQU   LCBFLAG1
LCBEXCPN EQU   LCBFLAG1
@NM00116 EQU   LCBFLAG1
LCBERPIN EQU   LCBFLAG1
@NM00115 EQU   LCBFLAG1
LCBFSBFR EQU   LCBMHA
LCBISZE  EQU   IEDQLCB+28
LCBLNENT EQU   LCBSCBDA+1
@NM00114 EQU   LCBSCBDA
LCBCPGMH EQU   LCBSTAT4
LCBREAL  EQU   LCBPHASE
@NM00113 EQU   LCBSTAT4
LCBACTRQ EQU   LCBSTAT4
LCBIPLRQ EQU   LCBSTAT4
LCBDACRQ EQU   LCBSTAT4
LCBDMPRQ EQU   LCBSTAT4
@NM00112 EQU   LCBLKMDE
LCBLOCKI EQU   LCBLKMDE
LCBLOCKR EQU   LCBLKMDE
LCBHMFLG EQU   LCBLKMDE
LCBBDFLG EQU   LCBLKMDE
@NM00111 EQU   LCBINSRC
LCBABRTN EQU   LCBCHAIN
LCBCTLMD EQU   LCBTETEN
LCBBFRSZ EQU   LCBCHAIN
LCBUREQN EQU   LCBCHAIN
LCBNORTY EQU   LCBCHAIN
LCBERMSG EQU   LCBCHAIN
LCBEXCP  EQU   LCBCHAIN
LCBINVRQ EQU   LCBSCRNN
LCB2741N EQU   LCBTSOB
LCBINHBN EQU   LCBTSOB
LCBCIRCD EQU   LCBTSOB
LCBPREP  EQU   LCBTSOB
LCBSOPL  EQU   LCBTSOB
LCBSATRD EQU   LCBTSOB
LCBTSBUF EQU   LCBTSOB
LCBWRBRK EQU   LCBTSOB
LCBTDL   EQU   IEDQLCB+18
LCBEOLTD EQU   IEDQLCB+16
LCBRSPRI EQU   IEDQLCB+12
LCBRSKEY EQU   IEDQLCB+8
LCBLINK  EQU   LCBRCB+5
LCBKEY   EQU   LCBRCB
@NM00110 EQU   DCTBYTE5
DCTSCS   EQU   DCTBYTE5
DCTTSPRF EQU   DCTBYTE4
DCTFMPRF EQU   DCTBYTE4
DCT2760  EQU   DCTBYTE3
DCTNOIDL EQU   DCTBYTE3
DCTCONTN EQU   DCTBYTE3
DCTBUFF  EQU   DCTBYTE3
DCTCHECK EQU   DCTBYTE3
DCTENCTL EQU   DCTBYTE3
DCTWTTA  EQU   DCTBYTE3
DCT1050  EQU   DCTBYTE3
DCTAUDIO EQU   DCTBYTE2
DCTLOCAL EQU   DCTBYTE2
DCTCONT  EQU   DCTBYTE2
DCTXMIT  EQU   DCTBYTE2
DCTSTCTL EQU   DCTBYTE2
DCTTWX   EQU   DCTBYTE2
DCTBRDST EQU   DCTBYTE2
DCTBISYN EQU   DCTBYTE2
DCTUMASK EQU   DCTBYTE1
DCTSADEV EQU   DCTBYTE1
DCT3270  EQU   DCTBYTE1
DCT2741  EQU   DCTBYTE1
DCT5041  EQU   DCTBYTE1
DCTATTEN EQU   DCTBYTE1
DCTBREAK EQU   DCTBYTE1
DCTINHIB EQU   DCTBYTE1
DCTBYTE0 EQU   IEDDCT
CVTLEVL  EQU   CVTRELNO+2
CVTNUMB  EQU   CVTRELNO
CVTMDL   EQU   CVTFIX+250
@NM00109 EQU   CVTFIX+248
@NM00108 EQU   CVTFIX
CVTRV482 EQU   CVTXTNT2+128
CVTRV481 EQU   CVTXTNT2+124
CVTRV480 EQU   CVTXTNT2+120
CVTRV479 EQU   CVTXTNT2+118
CVTRV478 EQU   CVTXTNT2+117
CVTRV477 EQU   CVTXTNT2+116
CVTRV476 EQU   CVTXTNT2+115
CVTRV475 EQU   CVTXTNT2+114
CVTRV474 EQU   CVTRV466
CVTRV473 EQU   CVTRV466
CVTRV472 EQU   CVTRV466
CVTRV471 EQU   CVTRV466
CVTRV470 EQU   CVTRV466
CVTRV469 EQU   CVTRV466
CVTRV468 EQU   CVTRV466
CVTRV467 EQU   CVTRV466
CVTRV465 EQU   CVTRV457
CVTRV464 EQU   CVTRV457
CVTRV463 EQU   CVTRV457
CVTRV462 EQU   CVTRV457
CVTRV461 EQU   CVTRV457
CVTRV460 EQU   CVTRV457
CVTRV459 EQU   CVTRV457
CVTRV458 EQU   CVTRV457
CVTRV456 EQU   CVTXTNT2+108
CVTRV455 EQU   CVTXTNT2+104
CVTRV454 EQU   CVTXTNT2+100
CVTRV453 EQU   CVTXTNT2+96
CVTRV452 EQU   CVTXTNT2+94
CVTRV451 EQU   CVTXTNT2+92
CVTRV450 EQU   CVTXTNT2+90
CVTRV449 EQU   CVTXTNT2+88
CVTRV448 EQU   CVTXTNT2+87
CVTRV447 EQU   CVTXTNT2+86
CVTRV446 EQU   CVTRV438
CVTRV445 EQU   CVTRV438
CVTRV444 EQU   CVTRV438
CVTRV443 EQU   CVTRV438
CVTRV442 EQU   CVTRV438
CVTRV441 EQU   CVTRV438
CVTRV440 EQU   CVTRV438
CVTRV439 EQU   CVTRV438
CVTRV437 EQU   CVTRV429
CVTRV436 EQU   CVTRV429
CVTRV435 EQU   CVTRV429
CVTRV434 EQU   CVTRV429
CVTRV433 EQU   CVTRV429
CVTRV432 EQU   CVTRV429
CVTRV431 EQU   CVTRV429
CVTRV430 EQU   CVTRV429
CVTRV428 EQU   CVTXTNT2+80
CVTRV427 EQU   CVTXTNT2+76
CVTRV426 EQU   CVTXTNT2+72
CVTRV425 EQU   CVTXTNT2+68
CVTATACT EQU   CVTATCVT
CVTRV423 EQU   CVTXTNT2+62
CVTRV422 EQU   CVTXTNT2+60
CVTRV421 EQU   CVTXTNT2+58
CVTRV420 EQU   CVTXTNT2+56
CVTRV419 EQU   CVTXTNT2+55
CVTRV418 EQU   CVTXTNT2+54
CVTRV417 EQU   CVTRV409
CVTRV416 EQU   CVTRV409
CVTRV415 EQU   CVTRV409
CVTRV414 EQU   CVTRV409
CVTRV413 EQU   CVTRV409
CVTRV412 EQU   CVTRV409
CVTRV411 EQU   CVTRV409
CVTRV410 EQU   CVTRV409
CVTRV408 EQU   CVTRV400
CVTRV407 EQU   CVTRV400
CVTRV406 EQU   CVTRV400
CVTRV405 EQU   CVTRV400
CVTRV404 EQU   CVTRV400
CVTRV403 EQU   CVTRV400
CVTRV402 EQU   CVTRV400
CVTRV401 EQU   CVTRV400
CVTICB   EQU   CVTXTNT2+48
CVTSKTA  EQU   CVTXTNT2+44
CVTSHSB  EQU   CVTSHS
CVTRSV98 EQU   CVTXTNT2+36
CVTRSV97 EQU   CVTXTNT2+34
CVTRSV96 EQU   CVTXTNT2+32
CVTOLTEP EQU   CVTXTNT2+28
CVTQIDA  EQU   CVTQID+1
CVTRSV95 EQU   CVTQID
CVTRSV94 EQU   CVTXTNT2+20
CVTRSV93 EQU   CVTXTNT2+16
CVTRSV92 EQU   CVTXTNT2+12
CVTDEBVR EQU   CVTXTNT2+8
CVTRSV91 EQU   CVTXTNT2+6
CVTRSV9H EQU   CVTFLGBT
CVTRSV9G EQU   CVTFLGBT
CVTRSV9F EQU   CVTFLGBT
CVTRSV9E EQU   CVTFLGBT
CVTRSV9D EQU   CVTFLGBT
CVTRSV9C EQU   CVTFLGBT
CVTVME   EQU   CVTFLGBT
CVTNPE   EQU   CVTFLGBT
CVTNUCLS EQU   CVTXTNT2+4
CVTDSSVA EQU   CVTDSSV+1
CVTRSV89 EQU   CVTDSSV
CVTRSV88 EQU   CVTXTNT1+8
CVTRSV87 EQU   CVTXTNT1+4
CVTFACHN EQU   CVTXTNT1
CVTRV488 EQU   CVTMAP+412
CVTRV487 EQU   CVTMAP+408
CVTRV486 EQU   CVTMAP+404
CVTRV485 EQU   CVTMAP+400
CVTACTAP EQU   CVTMAP+396
CVTAUTH  EQU   CVTMAP+392
CVTATMCA EQU   CVTATMCT+1
CVTATMST EQU   CVTATMCT
CVTRSV61 EQU   CVTMAP+384
CVTVOLT1 EQU   CVTVOLM1+1
CVTVOLI1 EQU   CVTVOLF1
CVTSTOA  EQU   CVTMAP+376
CVTRSV58 EQU   CVTMAP+374
CVTRSV57 EQU   CVTMAP+372
CVTDDCE  EQU   CVTMAP+368
CVTPNWFR EQU   CVTMAP+364
CVTSMF   EQU   CVTMAP+360
CVTSULK  EQU   CVTMAP+358
CVTSLKO  EQU   CVTSYSK
CVTSLKP  EQU   CVTSYSK
CVTSLKQ  EQU   CVTSYSK
CVTSLKR  EQU   CVTSYSK
CVTRSV56 EQU   CVTSYSK
CVTRSV55 EQU   CVTSYSK
CVTRSV54 EQU   CVTSYSK
CVTRSV53 EQU   CVTSYSK
CVTRSV52 EQU   CVTA1F1
CVTRSV51 EQU   CVTA1F1
CVTRSV50 EQU   CVTA1F1
CVTRSV49 EQU   CVTA1F1
CVTRSV48 EQU   CVTA1F1
CVTRSV47 EQU   CVTA1F1
CVTSRSW  EQU   CVTA1F1
CVTPFSW  EQU   CVTA1F1
CVTPCVT  EQU   CVTMAP+352
CVTRSV46 EQU   CVTMAP+344
CVTRSV45 EQU   CVTMAP+340
CVTRSV44 EQU   CVTMAP+338
CVTRSV43 EQU   CVTMAP+336
CVTHJESA EQU   CVTHJES+1
CVTRSV42 EQU   CVTHJES
CVTEXT2A EQU   CVTEXT2+1
CVTRSV41 EQU   CVTEXT2
CVTAPFA  EQU   CVTAPF+1
CVTRSV40 EQU   CVTAPF
CVTRV518 EQU   CVTINTLA
CVTRV517 EQU   CVTERPV
CVTEORM  EQU   CVTMAP+312
CVTMCHPR EQU   CVTMAP+308
CVTTZ    EQU   CVTMAP+304
CVTJEPS  EQU   CVTMAP+300
CVTJESCT EQU   CVTMAP+296
CVTMODE  EQU   CVTMAP+292
CVTPTRV  EQU   CVTMAP+288
CVTREAL  EQU   CVTMAP+284
CVTRSV39 EQU   CVTMAP+280
CVTRSV38 EQU   CVTMAP+276
CVTDMSRA EQU   CVTDMSR+1
CVTRV634 EQU   CVTDMSRF
CVTRV633 EQU   CVTDMSRF
CVTRV632 EQU   CVTDMSRF
CVTRV631 EQU   CVTDMSRF
CVTRV630 EQU   CVTDMSRF
CVTRV629 EQU   CVTDMSRF
CVTUDUMP EQU   CVTDMSRF
CVTSDUMP EQU   CVTDMSRF
CVTQMSGA EQU   CVTQMSG+1
CVTRSV36 EQU   CVTQMSG
CVTAMFF  EQU   CVTMAP+264
CVTPURGA EQU   CVTPURG+1
CVTRSV35 EQU   CVTPURG
CVTCBSP  EQU   CVTMAP+256
CVTATERA EQU   CVTATER+1
CVTSYST  EQU   CVTATER
CVTVOLT2 EQU   CVTTAT
CVTVOLI2 EQU   CVTVOLF2
CVTAQAVB EQU   CVTAQAVT+1
CVTRSV34 EQU   CVTTCMFG
CVTRSV33 EQU   CVTTCMFG
CVTRSV32 EQU   CVTTCMFG
CVTRSV31 EQU   CVTTCMFG
CVTRSV30 EQU   CVTTCMFG
CVTRSV29 EQU   CVTTCMFG
CVTRSV28 EQU   CVTTCMFG
CVTTCRDY EQU   CVTTCMFG
CVTGTFA  EQU   CVTGTF+1
CVTRSV27 EQU   CVTGTFST
CVTRNIO  EQU   CVTGTFST
CVTUSR   EQU   CVTGTFST
CVTRV318 EQU   CVTFORM
CVTRV317 EQU   CVTTMODE
CVTRV316 EQU   CVTSTATE
CVTRV315 EQU   CVTGTFS
CVTGTFAV EQU   CVTGTFS
CVT0SCR1 EQU   CVTMAP+232
CVTRV515 EQU   CVTMAP+228
CVTRMS   EQU   CVTMAP+224
CVTPATCH EQU   CVTMAP+220
CVTTSCE  EQU   CVTMAP+216
CVTLNKSC EQU   CVTMAP+214
CVTQABST EQU   CVTMAP+212
CVTMDLDS EQU   CVTMAP+208
CVTUSER  EQU   CVTMAP+204
CVTABEND EQU   CVTMAP+200
CVTSMCA  EQU   CVTMAP+196
CVTRSV18 EQU   CVTMAP+192
CVTQLPAQ EQU   CVTMAP+188
CVTQCDSR EQU   CVTMAP+184
CVTRSV17 EQU   CVTOPTB
CVTRSV16 EQU   CVTOPTB
CVTFP    EQU   CVTOPTB
CVTAPTHR EQU   CVTOPTB
CVTNLOG  EQU   CVTOPTB
CVTTOD   EQU   CVTOPTB
CVTCTIMS EQU   CVTOPTB
CVTPROT  EQU   CVTOPTB
CVTXPFP  EQU   CVTOPTA
CVTASCII EQU   CVTOPTA
CVTRSV13 EQU   CVTOPTA
CVTRSV12 EQU   CVTOPTA
CVTNIP   EQU   CVTOPTA
CVTDDR   EQU   CVTOPTA
CVTAPR   EQU   CVTOPTA
CVTCCH   EQU   CVTOPTA
CVTSNCTR EQU   CVTMAP+180
CVTQMWR  EQU   CVTMAP+176
CVTQOCR  EQU   CVTMAP+172
CVT1EF00 EQU   CVTMAP+168
CVTMZ00  EQU   CVTMAP+164
CVTHEAD  EQU   CVTMAP+160
CVTRSV11 EQU   CVTMAP+156
CVT0PT01 EQU   CVTMAP+152
CVTMSER  EQU   CVTMAP+148
CVTRV516 EQU   CVTIERLC
CVTILCH  EQU   CVTMAP+140
CVT0DS   EQU   CVTMAP+136
CVTFBOSV EQU   CVTMAP+132
CVTNUCB  EQU   CVTMAP+128
CVTIXAVL EQU   CVTMAP+124
CVTIOQET EQU   CVTMAP+120
CVTDCBA  EQU   CVTMAP+117
CVTMVS2  EQU   CVTDCB
CVT6DAT  EQU   CVTDCB
CVT4MPS  EQU   CVTDCB
CVTRSV09 EQU   CVTDCB
CVT4MS1  EQU   CVTDCB
CVT2SPS  EQU   CVTDCB
CVT1SSS  EQU   CVTDCB
CVTRSV08 EQU   CVTDCB
CVTSTB   EQU   CVTMAP+112
CVTQTD00 EQU   CVTMAP+108
CVTQTE00 EQU   CVTMAP+104
CVTCUCB  EQU   CVTMAP+100
CVTSJQ   EQU   CVTMAP+96
CVTPBLDL EQU   CVTMAP+92
CVTTPC   EQU   CVTMAP+88
CVTSVDCB EQU   CVTMAP+84
CVTBRET  EQU   CVTMAP+82
CVTEXIT  EQU   CVTMAP+80
CVT0FN00 EQU   CVTMAP+76
CVTDARA  EQU   CVTDAR+1
CVTRSV07 EQU   CVTFLGS1
CVTRSV06 EQU   CVTFLGS1
CVTRSV05 EQU   CVTFLGS1
CVTRSV04 EQU   CVTFLGS1
CVTRSV03 EQU   CVTFLGS1
CVTRSV02 EQU   CVTFLGS1
CVTRSV01 EQU   CVTFLGS1
CVTDMPLK EQU   CVTFLGS1
CVTXITP  EQU   CVTMAP+68
CVTZDTAB EQU   CVTMAP+64
CVTMSLT  EQU   CVTMAP+60
CVTDATE  EQU   CVTMAP+56
CVTBTERM EQU   CVTMAP+52
CVTSYSAD EQU   CVTMAP+48
CVTXTLER EQU   CVTMAP+44
CVTILK2  EQU   CVTMAP+40
CVTILK1  EQU   CVTMAP+36
CVTPRLTV EQU   CVTMAP+32
CVTPCNVT EQU   CVTMAP+28
CVT0VL00 EQU   CVTMAP+24
CVTXAPG  EQU   CVTMAP+20
CVTBUF   EQU   CVTMAP+16
CVTJOB   EQU   CVTMAP+12
CVTLINK  EQU   CVTMAP+8
CVT0EF00 EQU   CVTMAP+4
CVTTCBP  EQU   CVTMAP
CVT      EQU   CVTMAP
CUROPCE  EQU   IEDCUREQ+36
CURPIUPC EQU   IEDCUREQ+32
CURTOTBF EQU   IEDCUREQ+28
CURNEWBF EQU   IEDCUREQ+24
CURNXTRC EQU   IEDCUREQ+22
CURFAILT EQU   IEDCUREQ+18
CURPIUCT EQU   IEDCUREQ+16
@NM00107 EQU   CURFLG3
CURDIAL  EQU   CURFLG3
CURNCURE EQU   CURFLG3
CURFIRST EQU   CURFLG3
CURTOTEP EQU   CURFLG3
CUREPOST EQU   CURFLG3
CURATTCH EQU   CURFLG2
@NM00106 EQU   CURFLG2
CURENDCH EQU   CURFLG2
CURF1ID  EQU   CURFLG2
CURF1SEQ EQU   CURFLG2
CURF0FIN EQU   CURFLG2
CURSWCH  EQU   CURTOTIN+1
CURFLG1  EQU   CURTOTIN
CURELEM  EQU   IEDCUREQ+5
CURKEY   EQU   IEDCUREQ
SAVTLLCB EQU   IEDNSVTD+316
SAVTBITN EQU   IEDNSVTD+312
@NM00105 EQU   SAVTCKQB+8
@NM00104 EQU   SAVTCKEC+1
@NM00103 EQU   SAVTCKCC
SAVTCKPO EQU   SAVTCKCC
SAVTCKWA EQU   SAVTCKCC
SAVTCKCH EQU   SAVTCKTB+1
SAVTCKVT EQU   SAVTCKTB
@NM00102 EQU   IEDNSVTD+297
SAVTRDFG EQU   SAVTRDRV+12
@NM00101 EQU   SAVTRDRV+5
SAVTRDPY EQU   SAVTRDRV+4
SAVTRDQB EQU   SAVTRDRV+1
SAVTRDKY EQU   SAVTRDRV
SAVTNID  EQU   IEDNSVTD+280
SAVTDVAS EQU   IEDNSVTD+276
SAVTPLSZ EQU   IEDNSVTD+274
@NM00100 EQU   IEDNSVTD+273
SAVTSUBL EQU   IEDNSVTD+272
@NM00099 EQU   SAVTZELM+1
SAVTSUBM EQU   SAVTZELM
SAVTNAT1 EQU   IEDNSVTD+266
SAVTSH20 EQU   IEDNSVTD+264
SAVTLCBS EQU   IEDNSVTD+260
SAVTRNMP EQU   IEDNSVTD+256
SAVTNAX  EQU   IEDNSVTD+248
SAVTSUBV EQU   IEDNSVTD+247
SAVTSUBA EQU   IEDNSVTD+246
SAVTSIBC EQU   IEDNSVTD+244
SAVTBSM  EQU   IEDNSVTD+240
SAVTRQTG EQU   IEDNSVTD+236
SAVTRQCH EQU   IEDNSVTD+232
SAVTMAND EQU   IEDNSVTD+228
SAVTSPLN EQU   IEDNSVTD+224
SAVTNADL EQU   IEDNSVTD+222
SAVTNATL EQU   IEDNSVTD+220
SAVTSSMH EQU   IEDNSVTD+212
SAVTQRS  EQU   IEDNSVTD+208
SAVTRQIN EQU   IEDNSVTD+204
SAVTSAO  EQU   IEDNSVTD+196
SAVTSARI EQU   IEDNSVTD+192
SAVTSAC  EQU   IEDNSVTD+188
SAVTSAI  EQU   IEDNSVTD+184
SAVTCSCI EQU   IEDNSVTD+180
SAVTSSRP EQU   IEDNSVTD+176
SAVTSSRQ EQU   IEDNSVTD+172
SAVTXTRQ EQU   IEDNSVTD+164
@NM00098 EQU   IEDNSVTD+148
SAVTIPCQ EQU   IEDNSVTD+144
@NM00097 EQU   IEDNSVTD+136
SAVTXFMI EQU   IEDNSVTD+132
@NM00096 EQU   IEDNSVTD+124
SAVTXFMO EQU   IEDNSVTD+120
@NM00095 EQU   IEDNSVTD+116
SAVTSSSR EQU   IEDNSVTD+112
SAVTSCPQ EQU   IEDNSVTD+108
SAVTSLCB EQU   IEDNSVTD+104
@NM00094 EQU   SAVTLUSQ+8
@NM00093 EQU   IEDNSVTD+84
SAVTSAT  EQU   IEDNSVTD+80
SAVTNAT  EQU   IEDNSVTD+76
SAVTPIUT EQU   IEDNSVTD+68
SAVTRNTA EQU   IEDNSVTD+64
SAVTDNIR EQU   IEDNSVTD+60
SAVTCNIR EQU   IEDNSVTD+56
SAVTFLDH EQU   IEDNSVTD+52
SAVTSRTN EQU   IEDNSVTD+48
SAVTSREQ EQU   IEDNSVTD+44
SAVTFAIL EQU   IEDNSVTD+42
SAVTSUSE EQU   IEDNSVTD+40
SAVTSIB  EQU   IEDNSVTD+36
SAVTPRTN EQU   IEDNSVTD+32
@NM00092 EQU   IEDNSVTD+28
SAVTWH20 EQU   IEDNSVTD+26
SAVTPWT  EQU   IEDNSVTD+24
SAVTPRTQ EQU   IEDNSVTD+20
SAVTPH20 EQU   IEDNSVTD+14
SAVTPUSE EQU   IEDNSVTD+12
SAVTPLCB EQU   IEDNSVTD+8
SAVTPOOL EQU   IEDNSVTD+4
SAVTPRMT EQU   SAVTDIAF
SAVTVIRT EQU   SAVTDIAF
AVTCPBNO EQU   IEDQAVTD+1172
AVTHRESS EQU   IEDQAVTD+1171
@NM00091 EQU   IEDQAVTD+1170
@NM00090 EQU   IEDQAVTD+1169
@NM00089 EQU   IEDQAVTD+1168
@NM00088 EQU   IEDQAVTD+1165
@NM00087 EQU   IEDQAVTD+1164
AVTHRESE EQU   @NM00086
AVTRADDR EQU   IEDQAVTD+1156
AVTNADDR EQU   IEDQAVTD+1152
AVTHRESN EQU   IEDQAVTD+1148
AVTVOLRN EQU   IEDQAVTD+1144
AVTTOTNN EQU   IEDQAVTD+1140
AVTTRCYN EQU   IEDQAVTD+1136
AVTRCTRN EQU   IEDQAVTD+1132
AVTNOVON EQU   IEDQAVTD+1128
AVTADEBN EQU   IEDQAVTD+1124
AVTVOLRR EQU   IEDQAVTD+1120
AVTTOTNR EQU   IEDQAVTD+1116
AVTTRCYR EQU   IEDQAVTD+1112
AVTRCTRR EQU   IEDQAVTD+1108
AVTNOVOR EQU   IEDQAVTD+1104
AVTADEBR EQU   IEDQAVTD+1100
AVTLODPT EQU   IEDQAVTD+1096
AVTIOBN  EQU   IEDQAVTD+1092
AVTIOBR  EQU   IEDQAVTD+1088
AVTCPBPT EQU   IEDQAVTD+1084
AVTFCPB  EQU   IEDQAVTD+1080
@NM00085 EQU   IEDQAVTD+1076
AVTINCPQ EQU   IEDQAVTD+1072
@NM00084 EQU   IEDQAVTD+1068
@NM00083 EQU   IEDQAVTD+1065
@NM00082 EQU   AVTBIT4
@NM00081 EQU   AVTBIT4
@NM00080 EQU   AVTBIT4
@NM00079 EQU   AVTBIT4
@NM00078 EQU   AVTBIT4
@NM00077 EQU   AVTBIT4
@NM00076 EQU   AVTBIT4
AVTRUFTN EQU   AVTBIT4
@NM00075 EQU   IEDQAVTD+1060
AVTNOBFQ EQU   IEDQAVTD+1056
@NM00074 EQU   IEDQAVTD+1052
AVTDKENQ EQU   IEDQAVTD+1048
@NM00073 EQU   IEDQAVTD+1044
AVTDKAPQ EQU   IEDQAVTD+1040
AVTCOPY  EQU   IEDQAVTD+1036
AVTIA    EQU   IEDQAVTD+1032
AVTFL    EQU   IEDQAVTD+1028
@NM00072 EQU   IEDQAVTD+1024
AVTNCPBQ EQU   IEDQAVTD+1020
AVTTOTNC EQU   IEDQAVTD+1016
AVTCMAX  EQU   IEDQAVTD+1012
AVTCMIN  EQU   IEDQAVTD+1008
AVTHM02  EQU   IEDQAVTD+1004
AVTOPCIN EQU   IEDQAVTD+1002
AVTOPMSK EQU   IEDQAVTD+996
AVTSTEAL EQU   IEDQAVTD+988
AVTDSKCT EQU   IEDQAVTD+982
AVTCKRST EQU   IEDQAVTD+981
AVTSTAN  EQU   AVTBIT3
AVTSTACN EQU   AVTBIT3
AVTSTAIN EQU   AVTBIT3
AVTSTAYN EQU   AVTBIT3
AVTOLTBN EQU   AVTBIT3
AVTTSAB  EQU   AVTBIT3
AVTRFULN EQU   AVTBIT3
AVTRECVN EQU   AVTBIT3
@NM00071 EQU   AVTBIT2
@NM00070 EQU   AVTBIT2
AVTOPEIN EQU   AVTBIT2
AVTSTRTN EQU   AVTBIT2
AVTTOPOL EQU   AVTBIT2
AVTCOPYN EQU   AVTBIT2
AVTREUSN EQU   AVTBIT2
AVTEXTSC EQU   AVTBIT2
AVTDISKN EQU   AVTBIT1
AVTREADN EQU   AVTBIT1
AVTDLAYN EQU   AVTBIT1
AVTAQTAN EQU   AVTBIT1
AVTTSON  EQU   AVTBIT1
AVTAPLKN EQU   AVTBIT1
AVTDUMBR EQU   IEDQAVTD+976
AVTDLQX  EQU   IEDQAVTD+974
AVTINTLV EQU   IEDQAVTD+972
AVTSMCNT EQU   IEDQAVTD+970
AVTAVFCT EQU   IEDQAVTD+968
AVTOPCON EQU   IEDQAVTD+966
AVTOPCNT EQU   IEDQAVTD+964
AVTLNCNT EQU   IEDQAVTD+962
AVTHA16  EQU   IEDQAVTD+958
AVTHA7   EQU   IEDQAVTD+956
AVTHA4   EQU   IEDQAVTD+954
AVTHA3   EQU   IEDQAVTD+952
AVTHA2   EQU   IEDQAVTD+950
AVTGETMS EQU   IEDQAVTD+949
@NM00069 EQU   IEDQAVTD+948
AVTGETMD EQU   IEDQAVTD+944
AVTGETMN EQU   IEDQAVTD+940
AVTCWINT EQU   IEDQAVTD+884
AVTDTRAP EQU   IEDQAVTD+880
@NM00068 EQU   IEDQAVTD+878
@NM00067 EQU   AVTIOTR
AVTIOTRH EQU   AVTIOTR
AVTIOTRE EQU   AVTIOTR
@NM00066 EQU   AVTSUBT
AVTSUBPT EQU   AVTSUBT
AVTSUBON EQU   AVTSUBT
AVTAFE30 EQU   IEDQAVTD+872
AVTAFE20 EQU   IEDQAVTD+868
AVTAFE10 EQU   IEDQAVTD+864
AVTCWEC2 EQU   IEDQAVTD+860
AVTCWPM2 EQU   IEDQAVTD+856
AVTCWTS2 EQU   IEDQAVTD+855
AVTCWTS1 EQU   IEDQAVTD+854
AVTCWCLD EQU   AVTCWFL2
AVTCWRAP EQU   AVTCWFL2
@NM00065 EQU   AVTCWFL2
@NM00064 EQU   AVTCWFL2
@NM00063 EQU   AVTCWFL2
@NM00062 EQU   AVTCWFL2
@NM00061 EQU   AVTCWFL2
AVTCWACT EQU   AVTCWFL2
@NM00060 EQU   AVTCWFL1
@NM00059 EQU   AVTCWFL1
@NM00058 EQU   AVTCWFL1
@NM00057 EQU   AVTCWFL1
@NM00056 EQU   AVTCWFL1
@NM00055 EQU   AVTCWFL1
@NM00054 EQU   AVTCWFL1
AVTCOMWN EQU   AVTCWFL1
AVTCWEC1 EQU   IEDQAVTD+848
AVTCWPM1 EQU   IEDQAVTD+844
AVTCAREA EQU   IEDQAVTD+840
AVTFZERO EQU   IEDQAVTD+836
AVTCADDR EQU   IEDQAVTD+832
AVTCOREC EQU   IEDQAVTD+828
@NM00053 EQU   IEDQAVTD+820
AVTCPBCB EQU   IEDQAVTD+816
@NM00052 EQU   IEDQAVTD+808
AVTDSIOB EQU   IEDQAVTD+804
@NM00051 EQU   IEDQAVTD+796
AVTCPRMB EQU   IEDQAVTD+792
@NM00050 EQU   IEDQAVTD+784
AVTCLOSB EQU   IEDQAVTD+780
@NM00049 EQU   IEDQAVTD+772
AVTACTIB EQU   IEDQAVTD+768
@NM00048 EQU   IEDQAVTD+764
AVTOLTEB EQU   IEDQAVTD+760
AVTOLTCH EQU   AVTOLTQB+1
AVTOLTVT EQU   AVTOLTQB
@NM00047 EQU   AVTOPCQB+8
@NM00046 EQU   AVTOPCEC+1
@NM00045 EQU   AVTOPCCC
AVTOPCPO EQU   AVTOPCCC
AVTOPCWA EQU   AVTOPCCC
AVTOPCCH EQU   AVTOPCOB+1
AVTOPCVT EQU   AVTOPCOB
@NM00044 EQU   AVTCKPQB+9
AVTCKPTS EQU   AVTCKPQB+8
@NM00043 EQU   AVTCKPEC+1
@NM00042 EQU   AVTCKPCC
AVTCKPPO EQU   AVTCKPCC
AVTCKPWA EQU   AVTCKPCC
AVTCKPCH EQU   AVTCKPTB+1
AVTCKPVT EQU   AVTCKPTB
@NM00041 EQU   IEDQAVTD+724
@NM00040 EQU   IEDQAVTD+716
AVTSELCH EQU   IEDQAVTD+713
AVTBFRTN EQU   AVTBFRFG
AVTTIMQ  EQU   IEDQAVTD+704
@NM00039 EQU   IEDQAVTD+700
AVTIMQPS EQU   IEDQAVTD+696
AVTINOUT EQU   IEDQAVTD+694
AVTREFTM EQU   IEDQAVTD+692
@NM00038 EQU   IEDQAVTD+680
AVTDELYB EQU   IEDQAVTD+676
AVTOCQPT EQU   IEDQAVTD+672
AVTTSOPT EQU   IEDQAVTD+668
AVTSUPPT EQU   IEDQAVTD+664
AVTCBQCB EQU   IEDQAVTD+660
@NM00037 EQU   AVTSYSER
@NM00036 EQU   AVTSYSER
@NM00035 EQU   AVTSYSER
@NM00034 EQU   AVTSYSER
@NM00033 EQU   AVTSYSER
@NM00032 EQU   AVTSYSER
AVTCMAXN EQU   AVTSYSER
AVTCMINN EQU   AVTSYSER
AVT2260L EQU   IEDQAVTD+652
AVTABEPL EQU   AVTADBUF
AVTHFF   EQU   AVTCLRHI+2
@NM00031 EQU   AVTCLRHI
AVTCCLNK EQU   AVTCRELE+5
AVTCCPRI EQU   AVTCRELE+4
AVTCCQCB EQU   AVTCCELE+1
AVTCCKEY EQU   AVTCCELE
AVTDELAD EQU   IEDQAVTD+632
AVTDELEM EQU   IEDQAVTD+628
AVTBSX   EQU   AVTCKLNK
AVTOPETR EQU   AVTHG01
@NM00030 EQU   AVTCKBYT
AVTCKONQ EQU   AVTCKBYT
@NM00029 EQU   AVTCKBYT
@NM00028 EQU   AVTCKBYT
@NM00027 EQU   AVTCKBYT
@NM00026 EQU   AVTCKBYT
@NM00025 EQU   AVTCKBYT
@NM00024 EQU   AVTCKBYT
AVTOPERT EQU   IEDQAVTD+618
AVTOPXCL EQU   IEDQAVTD+616
AVTOPERL EQU   IEDQAVTD+615
@NM00023 EQU   IEDQAVTD+614
AVTCKTIM EQU   IEDQAVTD+612
AVTCKELV EQU   IEDQAVTD+610
AVTCPRCD EQU   IEDQAVTD+609
AVTWARMN EQU   AVTCKELF
AVTCRTLN EQU   AVTCKELF
AVTCPIPN EQU   AVTCKELF
AVTCCLCN EQU   AVTCKELF
AVTCINCN EQU   AVTCKELF
@NM00022 EQU   AVTCKELF
AVTCMCPN EQU   AVTCKELF
AVTNQBCK EQU   AVTCKELF
AVTCKQAD EQU   IEDQAVTD+605
AVTSCBSZ EQU   IEDQAVTD+604
@NM00021 EQU   IEDQAVTD+600
AVTCKELE EQU   IEDQAVTD+596
@NM00020 EQU   AVTCKPEL+8
AVTCKRLK EQU   AVTCKPEL+5
AVTCKRPR EQU   AVTCKPEL+4
AVTCKRMQ EQU   AVTCKRMV+1
AVTCKRKY EQU   AVTCKRMV
AVTHK    EQU   IEDQAVTD+576
AVTHI    EQU   IEDQAVTD+572
AVTIOT   EQU   IEDQAVTD+568
AVTNX    EQU   IEDQAVTD+564
AVTTONE  EQU   IEDQAVTD+560
AVTA3TL  EQU   IEDQAVTD+556
AVTDMECB EQU   IEDQAVTD+552
AVTABEND EQU   IEDQAVTD+546
AVTPLCBN EQU   IEDQAVTD+544
@NM00019 EQU   AVTSAVTP+1
@NM00018 EQU   AVTSAVTF
AVTSNA   EQU   AVTSAVTF
AVTONSNA EQU   AVTSAVTF
AVTVTMCP EQU   AVTSAVTF
@NM00017 EQU   IEDQAVTD+536
AVTCMBSS EQU   IEDQAVTD+532
AVTRCV   EQU   IEDQAVTD+528
AVTSEND  EQU   IEDQAVTD+524
AVTCSCH  EQU   IEDQAVTD+520
AVTQ1    EQU   IEDQAVTD+516
AVTE7    EQU   IEDQAVTD+512
AVTHB    EQU   IEDQAVTD+508
AVTR1    EQU   IEDQAVTD+504
AVTBZ    EQU   IEDQAVTD+500
AVTEZ    EQU   IEDQAVTD+496
AVTEC    EQU   IEDQAVTD+492
AVTEW    EQU   IEDQAVTD+488
AVTNDIAL EQU   AVTSCOPT
AVTN2741 EQU   AVTSCOPT
AVTCONCO EQU   AVTSCOPT
AVTCONC  EQU   AVTSCOPT
AVTCMBUF EQU   AVTSCOPT
AVTAPDMP EQU   AVTSCOPT
@NM00016 EQU   AVTSCOPT
AVTHA    EQU   AVTDISP
AVTEA    EQU   IEDQAVTD+476
AVTAX    EQU   IEDQAVTD+472
AVTA3    EQU   IEDQAVTD+468
AVTGD    EQU   IEDQAVTD+464
AVTAL    EQU   IEDQAVTD+460
AVTOLTST EQU   AVTHG02
AVTE8    EQU   IEDQAVTD+452
AVTUI    EQU   IEDQAVTD+448
AVTCOMPT EQU   IEDQAVTD+444
AVTCRSRF EQU   IEDQAVTD+440
@NM00015 EQU   IEDQAVTD+436
AVTKA02  EQU   IEDQAVTD+432
AVTOPTPT EQU   IEDQAVTD+428
AVTPCBPT EQU   IEDQAVTD+424
@NM00014 EQU   AVTECB1
AVTCOMP  EQU   AVTECB1
@NM00013 EQU   AVTECB1
AVTOPECA EQU   IEDQAVTD+416
AVTOLECA EQU   IEDQAVTD+412
AVTCKECA EQU   IEDQAVTD+408
AVTCWECA EQU   IEDQAVTD+404
AVTCWTCB EQU   IEDQAVTD+400
AVTOLTCB EQU   IEDQAVTD+396
AVTOCTCB EQU   IEDQAVTD+392
AVTCKTCB EQU   IEDQAVTD+388
AVTAS    EQU   IEDQAVTD+384
AVTNOLBF EQU   IEDQAVTD+382
AVTNCKPR EQU   IEDQAVTD+381
AVTCIB   EQU   IEDQAVTD+380
AVTSPLPT EQU   IEDQAVTD+376
AVTMVBFR EQU   IEDQAVTD+372
AVTSBTA  EQU   IEDQAVTD+368
AVTRARTN EQU   IEDQAVTD+364
AVTBSCAN EQU   IEDQAVTD+360
AVTRDYA  EQU   IEDQAVTD+356
AVTDISTR EQU   IEDQAVTD+348
AVTPARM3 EQU   IEDQAVTD+344
@NM00012 EQU   AVTPKF
@NM00011 EQU   AVTPKF
@NM00010 EQU   AVTPKF
AVTFTCHF EQU   AVTPKF
@NM00009 EQU   AVTPKF
@NM00008 EQU   AVTPKF
@NM00007 EQU   AVTPKF
@NM00006 EQU   AVTPKF
AVTPARM  EQU   IEDQAVTD+336
AVTEXS2A EQU   IEDQAVTD+330
AVTEXA2S EQU   IEDQAVTD+324
AVTOCGET EQU   IEDQAVTD+320
AVTCKAVT EQU   @NM00004+1
@NM00005 EQU   AVTCKFLG
AVTCKHLT EQU   AVTCKFLG
AVTCKREQ EQU   AVTCKFLG
AVTCKENV EQU   AVTCKFLG
AVTCKNAC EQU   AVTCKFLG
AVTCKTAC EQU   AVTCKFLG
AVTBUENT EQU   IEDQAVTD+314
@NM00003 EQU   IEDQAVTD+313
AVTFULLT EQU   AVTBUFSW
AVTUNCON EQU   AVTBUFSW
@NM00002 EQU   AVTBUFSW
AVTBUFTR EQU   AVTREADD
AVTREADY EQU   IEDQAVTD+304
AVTRACE  EQU   IEDQAVTD+300
AVTTCB   EQU   IEDQAVTD+296
AVTPASWD EQU   IEDQAVTD+288
AVTCTLCH EQU   IEDQAVTD+280
AVTDOUBL EQU   IEDQAVTD+272
AVTDOUBX EQU   IEDQAVTD+264
AVTDPARM EQU   IEDQAVTD+260
AVTDLQ   EQU   AVTSAVEX+32
@NM00001 EQU   AVTSAVEX
AVTSAVE4 EQU   IEDQAVTD+144
AVTSAVE3 EQU   IEDQAVTD+72
AVTSAVE2 EQU   IEDQAVTD
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00567 EQU   @EL00002
@RT00643 EQU   @EL00006
@RC00641 EQU   @EL00006
@RT00639 EQU   @EL00006
@RF00687 EQU   @RC00676
@RC00666 EQU   @EL00007
@RF00695 EQU   @EL00007
@RC00705 EQU   @EL00008
@RC00726 EQU   @EL00008
@RF00753 EQU   @EL00009
@RC00781 EQU   @EL00012
@RC00786 EQU   @EL00013
@RC00802 EQU   @EL00013
@RC00811 EQU   @EL00014
@RC00845 EQU   @EL00014
@RC00856 EQU   @EL00014
@RF00886 EQU   @EL00016
@RC00884 EQU   @EL00016
@RC00911 EQU   @EL00018
@RC00939 EQU   @EL00020
@RF00952 EQU   @EL00021
@RC00972 EQU   @EL00022
@RC00964 EQU   @EL00022
@RC00982 EQU   @EL00023
@RC01037 EQU   @EL00026
@RC01054 EQU   @EL00027
@RC01060 EQU   @EL00027
@RF01116 EQU   @EL00029
@RF01122 EQU   @EL00029
@RF01129 EQU   @EL00029
@RC01141 EQU   @EL00030
@RC01164 EQU   @EL00031
@RC01177 EQU   @EL00031
@RC01175 EQU   @EL00031
@RC01186 EQU   @EL00032
@RC01225 EQU   @EL00032
@RC01231 EQU   @EL00033
@RF01241 EQU   @EL00033
@RF01244 EQU   @EL00033
@RC01268 EQU   @EL00034
@RF01287 EQU   @EL00035
@RC01300 EQU   @RC01296
@RF01356 EQU   @RC01351
@PB00042 EQU   @EL00001
@RF00709 EQU   @RC00705
@RC00788 EQU   @RC00786
@RF00794 EQU   @RC00786
@RC00813 EQU   @RC00811
@RC00847 EQU   @RC00845
@RF00928 EQU   @RC00911
@RC01168 EQU   @RC01164
@RC01188 EQU   @RC01186
@RC01233 EQU   @RC01231
@PB00041 EQU   @PB00042
@RC00815 EQU   @RC00813
@RC01190 EQU   @RC01188
@PB00040 EQU   @PB00041
@RC01192 EQU   @RC01190
@PB00039 EQU   @PB00040
@PB00038 EQU   @PB00039
@PB00037 EQU   @PB00038
@PB00036 EQU   @PB00037
@PB00035 EQU   @PB00036
@PB00034 EQU   @PB00035
@PB00033 EQU   @PB00034
@PB00032 EQU   @PB00033
@PB00031 EQU   @PB00032
@PB00030 EQU   @PB00031
@PB00029 EQU   @PB00030
@PB00028 EQU   @PB00029
@PB00027 EQU   @PB00028
@PB00026 EQU   @PB00027
@PB00025 EQU   @PB00026
@PB00024 EQU   @PB00025
@PB00023 EQU   @PB00024
@PB00022 EQU   @PB00023
@PB00021 EQU   @PB00022
@PB00020 EQU   @PB00021
@PB00019 EQU   @PB00020
@PB00018 EQU   @PB00019
@PB00017 EQU   @PB00018
@PB00016 EQU   @PB00017
@PB00015 EQU   @PB00016
@PB00014 EQU   @PB00015
@PB00013 EQU   @PB00014
@PB00012 EQU   @PB00013
@PB00011 EQU   @PB00012
@PB00010 EQU   @PB00011
@PB00009 EQU   @PB00010
@PB00008 EQU   @PB00009
@PB00007 EQU   @PB00008
@PB00006 EQU   @PB00007
@PB00005 EQU   @PB00006
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@RC00558 EQU   @PB00002
@ENDDATA EQU   *
         END   IEDLUS,(C'PLS2028',0701,78068)

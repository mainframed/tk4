         TITLE 'ISTINCPH - PARAMETER HANDLER ROUTINE'
*REGS(0,1,2,3,4,15)LINKREGS(5,6,7,12)INCLUDES(ISTPHROA)*/          0001
ISTINCPH CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'ISTINCPH  79.061'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @11,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@11                                         0001
*    DO;                                                           0002
*/* ATBUILD (ISTPHROA)  */                                         0003
*GEN (PRINT OFF);                                                  0003
         PRINT OFF
*/*       VTAM  PARAMETER HANDLER (ISTINCPH) OUTPUT AREA              *
*/*  INITIAL LEVEL                                     001 08/02/74  */
*DECLARE 1 ISTPHROA BASED BDY(WORD),                               0004
*         2 PHROALEN FIXED(31),        /* TOTAL LENGTH OF PHR OUTPUT
*                                         AREA                        *
*         2 PHROADTA CHAR(*) BDY(WORD); /* PHR OUTPUT AREA DATA       *
*                                                                  0004
*DECLARE 1 PHRFN1OA DEFINED(PHROADTA),   /* FUNCTION 1 OUTPUT      0005
*                                          AREA                       *
*         2 PHRF1SAD PTR(31),            /* POINTER TO SUB-PARAMETER  *
*         2 PHRF1SLN FIXED(31);          /* LENGTH OF SUB-PARAMETER   *
*                                                                  0005
*DECLARE 1 PHRFN2OA DEFINED(PHROADTA),   /* FUNCTION 2 OUTPUT AREA    *
*         2 PHRF2NVL FIXED(31),          /* NUMBER OF OUTPUT VALUES   *
*         2 PHRF2VAL(*) FIXED(31),       /* ARRAY OF OUTPUT VALUES    *
*          3 PHRF2OFS FIXED(15),         /* OFFSET INTO SIFT AREA     *
*          3 PHRF2FLG BIT(8),            /* FLAG BYTE                 *
*           4 PHRF2GP BIT(1),            /* USE MLCPTR0 AS BASE       *
*           4 PHRF2LN BIT(1),            /* USE MLCPTR1 AS BASE       *
*           4 PHRF2CL BIT(1),            /* USE MLCPTR2 AS BASE       *
*           4 PHRF2TR BIT(1),            /* USE MLCPTR3 AS BASE       *
*           4 *       BIT(1),            /* RESERVED                  *
*           4 PHRF2ON BIT(1),            /* SET ON UNDER PHRF2MSK     *
*           4 PHRF2OFF BIT(1),           /* SET OFF UNDER PHRF2MSK    *
*           4 PHRF2MV BIT(1),            /* MOVE PHRF2MSK TO AREA     *
*          3 PHRF2MSK BIT(8);            /* BIT PATTERN TO PROCESS    *
*                                                                  0006
*DECLARE 1 PHRF34OA DEFINED(PHROADTA),   /* FUNCTIONS 3+4 OUTPUT AREA *
*         2 PHRF34NS FIXED(31),          /* NUMBER OF SUB-PARAMETERS  *
*         2 PHRF34EN(*),                 /* OUTPUT AREA ARRAY ENTRY   *
*          3 PHRF34VF BIT(8),            /* VALIDITY FLAGS            *
*          3 * BIT(8),                   /* RESERVED                  *
*          3 PHRF34SL FIXED(15),         /* LENGTH OF SUBPARAMETER    *
*          3 PHRF34SP CHAR(8);           /* SUBPARAMETER STRING       *
*                                                                  0007
*DECLARE 1 PHRFN5OA DEFINED(PHROADTA),   /* FUNCTION 5 OUTPUT AREA    *
*         2 PHRF5NSP FIXED(31),          /* NUMBER OF SUB-PARAMETERS  *
*         2 PHRF5ENT(*),                 /* OUTPUT AREA ARRAY ENTRY   *
*          3 PHRF5VF BIT(8),             /* VALIDITY FLAGS            *
*          3 * BIT(8),                   /* RESERVED                  *
*          3 PHRF5SL FIXED(15),          /* LENGTH OF SUB-PARAMETER   *
*          3 PHRF5SPT PTR(31);           /* POINTER TO SUB-PARAMETER  *
*                                                                  0008
*DECLARE 1 PHRFN7OA DEFINED(PHROADTA),   /* FUNCTION 7 OUTPUT AREA    *
*         2 PHRF7NSP FIXED(31),          /* NUMBER OF SUB-PARAMETERS  *
*         2 PHRF7NUM(*) BIN(8);         /* ARRAY OF ONE-BYTE VALUES  */
*                                                                  0009
*DECLARE 1 PHRFN8OA DEFINED(PHROADTA),   /* FUNCTION 8 OUTPUT AREA    *
*          2 PHRF8NSP FIXED(31),         /* NUMBER OF SUB PARAMETERS  *
*          2 PHRF8ENT(*),                /* OUTPUT AREA ARRAY ENTRY   *
*            3 PHRF8FLG BIT(8),          /* FLAG BYTE                 *
*              4 PHRF8DFT BIT(1),        /* SUB-PARM DEFAULTED        *
*              4 *        BIT(7),        /* RESERVED                  *
*            3 PHRF8NUM BIN(8);          /* ONE-BYTE VALUE            *
*                                                                  0010
*/*       VALIDITY ERROR FLAGS SET BY FUNCTIONS IN OUTPUT AREA        *
*DECLARE PHRVFAOK BIT(8) CONSTANT('00'X);/* NO ERRORS IN SUB-PARAMETER*
*DECLARE PHRVFNA1 BIT(8) CONSTANT('10'X);/* FIRST CHAR. NOT ALPHABETIC*
*DECLARE PHRVFNAN BIT(8) CONSTANT('20'X);/* ALL CHARS. NOT ALPHANUM   *
*DECLARE PHRVFNNN BIT(8) CONSTANT('40'X);/* ALL CHARS. NOT NUMERIC    *
*GEN (PRINT ON);                                                   0015
         PRINT ON
*                                                                  0016
*/* END OF ATBUILD */                                              0016
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15) RESTRICT */          0016
*   RFY (GPR00P,GPR01P,GPR02P,GPR03P,GPR04P,GPR05P,GPR06P,GPR07P,GPR12P
*GPR14P,GPR15P) RSTD;                                              0017
*                                                                  0017
*   END;/* CMZMREG */                                              0018
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15)  */                  0019
*                                                                  0020
*   END;/* CMZMREG */                                              0020
*   END ;                                                          0021
*/*A-000000-999999                                           @DL29HBN*/
*   RFY                                                            0022
*     ISTPHROA BASED(GPR02P);                                      0022
*                                                                  0023
*/*      KEYWORD TABLE INPUT FORMAT                                  */
*                                                                  0023
*                                                                  0023
*   DCL                                                            0023
*     1 CPHKWDTB BDY(BYTE)BASED(CPHTABAD),                         0023
*     (2 CPHENTNO,                  /* NUMBER OF ENTRIES             */
*      2 CPHENTLN)                  /* LENGTH OF 1 ENTRY             */
*            FIXED(15)BDY(BYTE),                                   0023
*      2 CPHTABEN(*),               /* TABLE ENTRY FORMAT            */
*       3 CPHKEYWD CHAR(8),         /* KEYWORD NAME                  */
*       3 CPHFUNBT CHAR(5);         /* FUNCTION BYTE/VALUE           */
*   DCL                                                            0024
*     1 CPHSUBVL CHAR(5)BDY(BYTE),  /* SUB-TABLE VALUE               */
*      2 CPHVALBT BIT(8),           /* VALIDITY FLAGS & FUNCT. NO    */
*       3 * BIT(1),                 /* RESERVED                      */
*       3 CPHFUNNU BIT(1),          /* CHECK NUMERIC CHAR            */
*       3 CPHFUNAN BIT(1),          /* CHECK ALPHANUM CHS            */
*       3 CPHFUNFC BIT(1),          /* CHECK ALPHA 1ST CH            */
*       3 CPHFUNNO BIT(4),          /* FUNCTION NUMBER               */
*      2 CPHVALUE PTR(31)BDY(BYTE); /* VALUE                         */
*                                                                  0024
*   DCL CPHF2VAL (*) BIT(32) DEFINED(PHRF2VAL);  /*TO ALLOW MVC  */
*   DCL CPHSBVL1 BIT(32) DEFINED(CPHSUBVL);  /*ALSO TO ALLOW MVC*/ 0026
*                                                                  0026
*/*      FUNCTION NUMBER VALUES                                      */
*                                                                  0027
*   DCL                                                            0027
*    (CPHFUN01 CONSTANT('0001'B),   /* FUNCTION NO. 1                */
*     CPHFUN02 CONSTANT('0010'B),   /* FUNCTION NO. 2                */
*     CPHFUN03 CONSTANT('0011'B),   /* FUNCTION NO. 3                */
*     CPHFUN04 CONSTANT('0100'B),   /* FUNCTION NO. 4                */
*     CPHFUN05 CONSTANT('0101'B),   /* FUNCTION NO. 5                */
*     CPHFUN06 CONSTANT('0110'B),   /* FUNCTION NO. 6                */
*     CPHFUN07 CONSTANT('0111'B),   /* FUNCTION NO. 7                */
*     CPHFUN08 CONSTANT('1000'B))  /*FUNCTION 8              @D32CKKA*/
*         BIT(4);                                                  0027
*                                                                  0027
*/*         TRANSLATE-AND-TEST TABLE USED TO SCAN FOR DELIMITERS     */
*                                                                  0028
*   DCL                                                            0028
*     CPHTRTB STATIC LOCAL CHAR(256)GENERATED;             /*@DM39361*/
*   GEN DATA DEFS(CPHTRTB);                                        0029
*                                                                  0029
*/*         TRT TABLE FOR VALIDITY CHECK SUBROUTINE                  */
*                                                                  0030
*   DCL                                                            0030
*     CPHVTRTB STATIC LOCAL CHAR(256)GENERATED;            /*@DM39361*/
*   GEN DATA DEFS(CPHVTRTB);                                       0031
*                                                                  0031
*/*      TRANSITION MATRIX FOR CONTEXT SUB-PROCESSORS                */
*                                                                  0032
*   DCL                                                            0032
*     CPHSCNTB(7,7)PTR(31) STATIC LOCAL /*TABLE STORAGE      @DM39361*/
*         INIT                      /* SEE DESCRIPTION OF TABLE IN 0032
*                                      CHARTS                        */
*         (ADDR(CPHCSP13),ADDR(CPHCSP01),ADDR(CPHCSP01),ADDR(CPHCSP01),
*         ADDR(CPHCSP12),ADDR(CPHCSP12),ADDR(CPHCSP01),ADDR(CPHCSP02),
*         ADDR(CPHCSP12),ADDR(CPHCSP12),ADDR(CPHCSP12),ADDR(CPHCSP12),
*         ADDR(CPHCSP12),ADDR(CPHCSP12),ADDR(CPHCSP10),ADDR(CPHCSP10),
*         ADDR(CPHCSP04),ADDR(CPHCSP04),ADDR(CPHCSP05),ADDR(CPHCSP13),
*         ADDR(CPHCSP12),ADDR(CPHCSP12),ADDR(CPHCSP06),ADDR(CPHCSP06),
*         ADDR(CPHCSP06),ADDR(CPHCSP12),ADDR(CPHCSP12),ADDR(CPHCSP12),
*         ADDR(CPHCSP07),ADDR(CPHCSP12),ADDR(CPHCSP07),ADDR(CPHCSP12),
*         ADDR(CPHCSP08),ADDR(CPHCSP08),ADDR(CPHCSP12),ADDR(CPHCSP12),
*         ADDR(CPHCSP09),ADDR(CPHCSP09),ADDR(CPHCSP09),ADDR(CPHCSP12),
*         ADDR(CPHCSP12),ADDR(CPHCSP12),ADDR(CPHCSP10),ADDR(CPHCSP10),
*         ADDR(CPHCSP10),ADDR(CPHCSP12),ADDR(CPHCSP14),ADDR(CPHCSP10),
*         ADDR(CPHCSP13));                                         0032
*                                                                  0032
*/*   SUB-PARAMTER POINTER BLOCK FOR FUNCTION 2                      */
*                                                                  0033
*   DCL                                                            0033
*     1 CPHPNTBK BASED(CPHVALUE)BDY(BYTE),                         0033
*      2 CPHSBVAL FIXED(31)BDY(BYTE),/* KWD RTN. ADDRESS             */
*      2 CPHSBTAB PTR(31)BDY(BYTE); /* SUBPARM TBL                   */
*                                                                  0033
*/*      INLINE DATA AREA AND LOCK                           @DM39361*/
*   DCL                                                            0034
*     CPHLOCK BIT(8) INIT(0) STATIC LOCAL;                 /*@DM39361*/
*   DCL                                                            0035
*     STATICFD BDY(WORD) CHAR(116) STATIC LOCAL;           /*@DM30483*/
*                                                                  0035
*                                                                  0035
*/*      SUB-PROCESSOR ENTRY POINT LOCATOR                           */
*                                                                  0036
*   DCL                                                            0036
*     CPHSCNPT PTR(31);                                            0036
*                                                                  0036
*/*     LOCAL POINTERS USED FOR WORKING STORAGE                      */
*                                                                  0037
*                                                                  0037
*   DCL                                                            0037
*    (CPHOANDX,                     /* OUTPUT AREA ENTRY INDEX       */
*     CPHOALIM)FIXED(31);           /* MAX NO. OF OUTPUT AREA ENT    */
*   DCL CPHINSVA PTR(31);           /* SVA FOR INPUT SVADDR  @DM39361*/
*   DCL CPHSCN00 PTR(31);           /* CPHSUBSC R00 SVA      @DM30483*/
*   DCL CPHSCN02 PTR(31);           /* CPHSUBSC R02 SVA      @DM30483*/
*   DCL CPHVCK01 PTR(31);           /* CPHVALCK R01 SVA      @DM30483*/
*   DCL CPHVCK02 PTR(31);           /* CPHVALCK R02 SVA      @DM30483*/
*   DCL                                                            0043
*    (CPHTCHAR,                     /* TRT CODE FOR LAST CHAR.       */
*     CPHLCHAR)FIXED(8);            /* TRT CODE FOR PREVIOUS CHAR    */
*   DCL                                                            0044
*    (CPHSPLEN,                     /* SUB-PARAMETER LENGTH          */
*     CPHKWLEN,                     /* KEYWORD LENGTH                */
*     CPHPARCT,                     /* PARENTHESES COUNT             */
*     CPHSBPAR,                     /* SUBPARM START PARENS. COUNT   */
*     CPHENCTR)FIXED(15);           /* TABLE SEARCH ENTRY COUNT      */
*   DCL                                                            0045
*     CPHSBYTE CHAR(*)BASED;        /* (A) BYTE(S) IN SCANNED STR    */
*   DCL                                                            0046
*     CPHARGUM CHAR(8);             /* SEARCH ARGUMENT (CPHTBLSC)    */
*   DCL                                                            0047
*     CPHDECHX CHAR(3);             /*HOLD AREA FOR CPHSUB07 @DM39361*/
*   DCL                                                            0048
*     1 CPHVALFG BIT(8),            /* VALIDITY ERROR FLAGS          */
*      2 * BIT(1),                  /* RESERVED                      */
*      2 CPHVALNU BIT(1),           /* CHARACTERS NOT NUMERIC        */
*      2 CPHVALAN BIT(1),           /* CHARS. NOT ALPHANUMERIC       */
*      2 CPHVALFC BIT(1),           /* 1ST CHAR. NOT ALPHANUMERIC    */
*      2 * BIT(4);                  /* RESERVED                      */
*   DCL                                                            0049
*    (CPHTABAD,                     /* POINTER TO KWD TABLE ENTRY    */
*     CPHTABSV)PTR(31);             /* POINTER TO KWD TABLE START    */
*   DCL                                                            0050
*    (CPHKWPTR,                     /* POINTER TO START OF KEYWD     */
*     CPHTRTSV,                     /* POINTER TO START OF    SUBPARM*/
*     CPHVALPS,                     /* VALCHK SAVE AREA FOR PTR      */
*     CPHSPPTR)PTR(31);             /* SUB-PARAMETER POINTER         */
*   DCL                                                            0051
*     1 CPHFLAGS BIT(8),            /* ** PHR LOGIC CONTROL FLAGS*   */
*      2 * BIT(1),                  /* RESERVED                      */
*      2 CPHCONT BIT(1),            /* TRT CONTINUE FLAG             */
*      2 CPHKWSCN BIT(1),           /* SCANNING STRING FOR KWD       */
*      2 CPHENDST BIT(1),           /* END OF STRING WAS HIT         */
*      2 CPHENDSP BIT(1),           /* END OF SUB-PARM WAS HIT       */
*      2 CPHLSTSP BIT(1),           /* LAST SUB-PARAMETER WAS HIT    */
*      2 CPHSLIST BIT(1),           /* SUB PARM LIST ENCOUNTERED     */
*      2 CPHSYNER BIT(1);           /* SYNTAX ERROR HAS OCCURRED     */
*   DCL                                                            0052
*     1 CPHFLAG2 BIT(8),            /* ADDITIONAL CONTROL FLAGS      */
*      2 CPHOFLOW BIT(1),           /* OUTPUT AREA OVERFLOW          */
*      2 CPHFUNER BIT(1),           /* FUNCTION ERROR                */
*      2 CPHARGNF BIT(1),           /* ARGUMENT NOT FOUND-TBL SCH    */
*      2 * BIT(5);                  /* RESERVED                      */
*   DCL R4 PTR(24)   REG(04);          /* DECLARE REGS       @DA20388*/
*   DCL R5 FIXED(31) REG(05);          /*                    @DA20388*/
*   DCL R6 PTR(24)   REG(06);          /*                    @DA20388*/
*   DCL R7 FIXED(31) REG(07);          /*                    @DA20388*/
*                                                                  0057
*/*         EXECUTABLE CODE SECTION                                  */
*         GPR03P=GPR13P;                 /*SAVE CALLER'S SVA @DM30219*/
         LR    GPR03P,GPR13P                                       0057
*         GPR13P=ADDR(STATICFD);         /*USE INLINE SVA    @DM39361*/
         LA    GPR13P,STATICFD                                     0058
*         GEN REFS(CPHLOCK)(TS CPHLOCK); /*INLINE DATA AREA IN     0059
*                                          USE ?             @DM39361*/
         TS CPHLOCK
*         BC(8,USEINLIN);                /* NO-USE INLINE AREA     0060
*                                                            @DM39361*/
         BC    8,USEINLIN                                          0060
*GEN SETS(GPR00P,GPR01P,GPR04P,GPR15F,GPR05P,GPR06P,GPR07P)        0061
*    REFS(GPR03P);                                         /*@VS45824*/
          LM   4,7,36(3)
          L    0,@SIZDATD
          LA   1,48(3)
          ST   1,40(3)
          LA   1,36(3)
          GETMAIN EC,LV=(0),SP=0,MF=(E,(1))
*        IF GPR15F=0                                               0062
*              THEN DO;                                    /*@DM39361*/
         LTR   GPR15F,GPR15F                                       0062
         BNZ   @RF00062                                            0062
*        GEN SETS(GPR13P,GPR00P,GPR01P)                            0064
*            REFS(GPR04P,GPR05P,GPR06P,GPR07P,GPR03P);     /*@VS45113*/
          LM   0,1,20(3)
          L   13,48(3)
          STM 4,7,36(3)
          USING @DATD,13
*USEINLIN:                                                         0065
*CPHINSVA=GPR03P;                   /* SAVE INPUT SAVE AREA  @DM39361*/
USEINLIN ST    GPR03P,CPHINSVA                                     0065
*RFY (R4,R5,R6,R7) RSTD;            /* RESTRICT MVCL REGS    @DA20388*/
*R4=ADDR(PHROADTA);                 /* 'TO' FIELD            @DA20388*/
         LA    R4,PHROADTA(,GPR02P)                                0067
*R5=PHROALEN-LENGTH(PHROALEN);      /* SIZE OF 'TO' FIELD    @DA20388*/
         L     R5,PHROALEN(,GPR02P)                                0068
         SL    R5,@CF00117                                         0068
*R6=R4;                             /* 'FROM' FIELD          @DA20388*/
         LR    R6,R4                                               0069
*R7=0;                              /* PAD+SIZE OF 'FROM'    @DA20388*/
         SLR   R7,R7                                               0070
*MVCL (R4,R6);                      /* CLEAR OUTPUT AREA     @DA20388*/
         MVCL  R4,R6                                               0071
*RFY (R4,R5,R6,R7) UNRSTD;          /*                       @DA20388*/
*                                                                  0072
*CPHPARCT=0;         /*INIT. PARENS. COUNT (CPHPARCT) TO 0        */
         SLR   @10,@10                                             0073
         STH   @10,CPHPARCT                                        0073
*/*   R0=TABLE ADDR R1=KEYWORD ADDR R2=OUTPUT AREA ADDR              */
*CPHFLAGS='00'X;            /*  RESET CPHFLAGS*/                   0074
         MVI   CPHFLAGS,X'00'                                      0074
*CPHFLAG2='00'X;                                                   0075
         MVI   CPHFLAG2,X'00'                                      0075
*CPHKWSCN='1'B;             /*   SET CPHKWSCN = 1*/                0076
         OI    CPHKWSCN,B'00100000'                                0076
*CPHLCHAR='06'X;            /*   CPHLCHAR = X'06' (START OF KWD)*/ 0077
         MVI   CPHLCHAR,X'06'                                      0077
* /*ICALL(CPHSUBSC)*/                                              0078
*  DO;                                                             0078
* CALL CPHSUBSC;                                                   0079
*                                                                  0079
         BAL   @14,CPHSUBSC                                        0079
* END ;           /*   GO TO LOCATE KEYWORD */                     0080
*                   /* KWD ADD IN CPHKWPTR, KWD LENGTH IN CPHKWLEN   */
*IF CPHSYNER='1'B            /*SYNTAX ERR */                       0081
*   THEN                        /*YES */                           0081
         TM    CPHSYNER,B'00000001'                                0081
         BNO   @RF00081                                            0081
*     GPR01P=GPR01P+1;           /*UPDATE REG1*/                   0082
         AL    GPR01P,@CF00048                                     0082
*   ELSE DO;                     /*NOT SYNTAX ERR */               0083
         B     @RC00081                                            0083
@RF00081 DS    0H                                                  0084
*     IF CPHENDST='1'B       /*END OF STRING*/                     0084
*        THEN;               /*YES END OF STRING*/                 0084
         TM    CPHENDST,B'00010000'                                0084
         BO    @RT00084                                            0084
*        ELSE DO;            /*NOT END OF STRING*/                 0086
*         IF CPHKWLEN>8           /*KWD LONGER THAN 8*/            0087
*          THEN                  /*YES */                          0087
         LH    @10,CPHKWLEN                                        0087
         C     @10,@CF00046                                        0087
         BNH   @RF00087                                            0087
*             CPHARGNF='1'B;         /*  SET ARGUMENT NOT FOUND*/  0088
         OI    CPHARGNF,B'00100000'                                0088
*          ELSE DO;                  /*NOT LONGER THAN 8*/         0089
         B     @RC00087                                            0089
@RF00087 DS    0H                                                  0090
*             CPHARGUM=' ';         /*CLEAR SEARCH ARG*/           0090
         MVI   CPHARGUM+1,C' '                                     0090
         MVC   CPHARGUM+2(6),CPHARGUM+1                            0090
         MVI   CPHARGUM,C' '                                       0090
*                               /* MOVE KWD TO CPHARGUM (SEARCH ARG)*/
*             CPHARGUM(1:CPHKWLEN)=CPHKWPTR->CPHSBYTE(1:CPHKWLEN); 0091
         LH    @10,CPHKWLEN                                        0091
         BCTR  @10,0                                               0091
         L     @09,CPHKWPTR                                        0091
         EX    @10,@SM00442                                        0091
*             CPHTABAD=GPR00P;  /*GET ADDR OF KWD TABLE*/          0092
         ST    GPR00P,CPHTABAD                                     0092
*              /*ICALL(CPHTBLSC)*/                                 0093
*               DO;                                                0093
*              CALL CPHTBLSC;                                      0094
*                                                                  0094
         BAL   @14,CPHTBLSC                                        0094
*              END ;  /* SEARCH KWD TABLE FOR KWD */               0095
*             IF CPHARGNF='0'B    /*WAS ARG FOUND*/                0096
*                THEN DO;         /*YES */                         0096
         TM    CPHARGNF,B'00100000'                                0096
         BNZ   @RF00096                                            0096
*                                 /* WAS IT  FUNCT. 0 WITH PARMS*/ 0098
*                  IF CPHFUNNO='0000'B&CPHTCHAR='01'X              0098
*                     THEN       /*YES*/                           0098
         TM    CPHFUNNO,B'00001111'                                0098
         BNZ   @RF00098                                            0098
         CLI   CPHTCHAR,1                                          0098
         BNE   @RF00098                                            0098
*                        CPHFUNER='1'B;    /* SET FUNCTION ERROR FLAG*/
         OI    CPHFUNER,B'01000000'                                0099
*                     ELSE DO;       /*NOT FUNC 0 WITH PARMS*/     0100
         B     @RC00098                                            0100
@RF00098 DS    0H                                                  0101
*                             /* NOT FUNCT. 0 AND POSITIONAL KEYWD   */
*                        IF CPHFUNNO^='0000'B&CPHTCHAR^='01'X      0101
*                           THEN      /*YES*/                      0101
         TM    CPHFUNNO,B'00001111'                                0101
         BZ    @RF00101                                            0101
         CLI   CPHTCHAR,1                                          0101
         BE    @RF00101                                            0101
*                             CPHSYNER='1'B; /* SET SYNTAX ERROR */
         OI    CPHSYNER,B'00000001'                                0102
*                           ELSE DO;/*NOT SYNTAX ERROR*/           0103
         B     @RC00101                                            0103
@RF00101 DS    0H                                                  0104
*                            GPR00F=CPHVALUE; /*GET ENT VALUE*/    0104
         ICM   GPR00F,15,CPHVALUE                                  0104
*                            IF CPHFUNNO=CPHFUN01 /*FUNCT 1*/      0105
*                               THEN   /*YES FUNC 1*/              0105
         TM    CPHFUNNO,B'00000001'                                0105
         BNO   @RF00105                                            0105
         TM    CPHFUNNO,B'00001110'                                0105
         BNZ   @RF00105                                            0105
*                                  /*ICALL(CPHSUB01)*/             0106
*                                   DO;                            0106
*                                  CALL CPHSUB01;                  0107
*                                                                  0107
         BAL   @14,CPHSUB01                                        0107
*                                  END ;/*CALL FUNCT 1 RTN*/       0108
*                               ELSE DO;   /*NOT FUNCT 1*/         0109
         B     @RC00105                                            0109
@RF00105 DS    0H                                                  0110
*                                 IF CPHFUNNO=CPHFUN02 /*FUNCT 2*/ 0110
*                                  THEN  /*YES FUNC2*/             0110
         TM    CPHFUNNO,B'00000010'                                0110
         BNO   @RF00110                                            0110
         TM    CPHFUNNO,B'00001101'                                0110
         BNZ   @RF00110                                            0110
*                                    /*ICALL(CPHSUB02)*/           0111
*                                     DO;                          0111
*                                    CALL CPHSUB02;                0112
*                                                                  0112
         BAL   @14,CPHSUB02                                        0112
*                                    END ;/*CALL FUNCT2 */         0113
*                                  ELSE DO;  /*NOT FUNCT 2*/       0114
         B     @RC00110                                            0114
@RF00110 DS    0H                                                  0115
*                                    IF CPHFUNNO=CPHFUN03 × /*FUNCT 3*/
*                                       CPHFUNNO=CPHFUN04   /*OR 4*/
*                                     THEN     /*YES 3 OR 4*/      0115
         TM    CPHFUNNO,B'00000011'                                0115
         BNO   @GL00003                                            0115
         TM    CPHFUNNO,B'00001100'                                0115
         BZ    @RT00115                                            0115
@GL00003 TM    CPHFUNNO,B'00000100'                                0115
         BNO   @RF00115                                            0115
         TM    CPHFUNNO,B'00001011'                                0115
         BNZ   @RF00115                                            0115
@RT00115 DS    0H                                                  0116
*                                            /*CALL FUNCT 3/4 RTN*/
*                                         /*ICALL(CPHSUB34)*/      0116
*                                          DO;                     0116
*                                         CALL CPHSUB34;           0117
*                                                                  0117
         BAL   @14,CPHSUB34                                        0117
*                                         END ;                    0118
*                                     ELSE DO;  /*NOT 3/4*/        0119
         B     @RC00115                                            0119
@RF00115 DS    0H                                                  0120
*                                        IF CPHFUNNO=CPHFUN05/*FUNC 5*/
*                                           THEN  /*YES CALL FUNC 5*/
         TM    CPHFUNNO,B'00000101'                                0120
         BNO   @RF00120                                            0120
         TM    CPHFUNNO,B'00001010'                                0120
         BNZ   @RF00120                                            0120
*                                               /*ICALL(CPHSUB05)*/
*                                                DO;               0121
*                                               CALL CPHSUB05;     0122
*                                                                  0122
         BAL   @14,CPHSUB05                                        0122
*                                               END ;              0123
*                                           ELSE DO;/*NOT FUNC5*/  0124
         B     @RC00120                                            0124
@RF00120 DS    0H                                                  0125
*                                           /*IF IT FUNC6*/        0125
*                                              IF CPHFUNNO=CPHFUN06
*                                                 THEN /*YES*/     0125
         TM    CPHFUNNO,B'00000110'                                0125
         BNO   @RF00125                                            0125
         TM    CPHFUNNO,B'00001001'                                0125
         BNZ   @RF00125                                            0125
*                                         /*CALL FUNCT 6 RTN*/     0126
*                                                     /*ICALL(CPHSUB06)
*/                                                                 0126
*                                                      DO;         0126
*                                                     CALL CPHSUB06;
*                                                                  0127
         BAL   @14,CPHSUB06                                        0127
*                                                     END ;        0128
*                                                 ELSE DO; /*NOT 6*/
         B     @RC00125                                            0129
@RF00125 DS    0H                                                  0130
*                                                 /*IS IT FUNC 7 OR 8*/
*                                                 IF CPHFUNNO=CPHFUN07
*                                                 × CPHFUNNO=CPHFUN08
*                                                          /*@D32CKKA*/
*                                                    THEN /*YES*/  0130
         TM    CPHFUNNO,B'00000111'                                0130
         BNO   @GL00004                                            0130
         TM    CPHFUNNO,B'00001000'                                0130
         BZ    @RT00130                                            0130
@GL00004 TM    CPHFUNNO,B'00001000'                                0130
         BNO   @RF00130                                            0130
         TM    CPHFUNNO,B'00000111'                                0130
         BNZ   @RF00130                                            0130
@RT00130 DS    0H                                                  0131
*                                                /*CALL FUNC 7/8 */
*                                                      /*ICALL(CPHSUB07
**/                                                                0131
*                                                       DO;        0131
*                                                      CALL CPHSUB07;
*                                                                  0132
         BAL   @14,CPHSUB07                                        0132
*                                                      END ;       0133
*                                                     ELSE;/*NOT 7,8*/
@RF00130 DS    0H                                                  0135
*                                                 END; /*END NOT 6*/
*                                           END;  /*END NOT FUNC 5*/
*                                     END;  /*END NOT FUNCT 3/4*/  0137
*                                 END;      /*END NOT FUNCT2*/     0138
*                                END;       /*END NOT FUNCT 1*/    0139
*                            END;          /*END NOT SYNTAX ERROR*/
*                     END;                 /*END NOT FUNCT ERROR*/ 0141
*                END;                      /*END ARG FOUND*/       0142
*                ELSE;                     /*ARG NOT FOUND*/       0143
@RF00096 DS    0H                                                  0144
*          END;              /*END NOT LONGER THAN 8*/             0144
@RC00096 DS    0H                                                  0145
*        END;                /*END NOT END OF STRING*/             0145
@RC00087 DS    0H                                                  0146
*    END;                  /*END NOT SYNTAX ERROR */               0146
@RT00084 DS    0H                                                  0147
*   IF CPHARGNF='1'B×CPHFUNER='1'B×CPHOFLOW='1'B /*NON-TERM ERRORS*/
*     THEN DO;               /*YES NON TERMINATING ERRORS*/        0147
@RC00081 TM    CPHARGNF,B'11100000'                                0147
         BZ    @RF00147                                            0147
*                              /* DO WHILE ERROR AND END NOT HIT     */
*       DO WHILE(CPHLSTSP='0'B&CPHSYNER='0'B&CPHENDST='0'B);       0149
         B     @DE00149                                            0149
@DL00149 DS    0H                                                  0150
*          /*ICALL(CPHSUBSC)*/                                     0150
*           DO;                                                    0150
*          CALL CPHSUBSC;                                          0151
*                                                                  0151
         BAL   @14,CPHSUBSC                                        0151
*          END ;   /* SCAN OVER PARAMETER LIST            */       0152
*       END;                  /*END DO WHILE */                    0153
@DE00149 TM    CPHLSTSP,B'00010101'                                0153
         BZ    @DL00149                                            0153
*     END;                    /*END ERRORS CODE*/                  0154
*     ELSE;                   /*NO NON-TERMINATING ERRORS*/        0155
@RF00147 DS    0H                                                  0156
*   IF CPHSYNER='1'B          /*SYNTAX ERROR*/                     0156
*     THEN                     /*YES */                            0156
         TM    CPHSYNER,B'00000001'                                0156
         BNO   @RF00156                                            0156
*        GPR15F=12;            /*SET RTN CODE */                   0157
         LA    GPR15F,12                                           0157
*     ELSE DO;                 /*NOT SYNTAX ERROR*/                0158
         B     @RC00156                                            0158
@RF00156 DS    0H                                                  0159
*       IF CPHARGNF='1'B       /*ARG NOT FOUND ERROR*/             0159
*          THEN                /*YES */                            0159
         TM    CPHARGNF,B'00100000'                                0159
         BNO   @RF00159                                            0159
*             GPR15F=4;        /*SET RETURN CODE*/                 0160
         LA    GPR15F,4                                            0160
*          ELSE DO;            /*NOT ARG NOT FOUND ERROR*/         0161
         B     @RC00159                                            0161
@RF00159 DS    0H                                                  0162
*             IF CPHFUNER='1'B /*FUNCT ERROR*/                     0162
*                THEN          /*YES*/                             0162
         TM    CPHFUNER,B'01000000'                                0162
         BNO   @RF00162                                            0162
*                   GPR15F=16;  /*SET RETURN CODE*/                0163
         LA    GPR15F,16                                           0163
*                ELSE DO;      /*NOT FUNCT ERROR*/                 0164
         B     @RC00162                                            0164
@RF00162 DS    0H                                                  0165
*                   IF CPHOFLOW='1'B /*OVERFLOW*/                  0165
*                      THEN    /*YES*/                             0165
         TM    CPHOFLOW,B'10000000'                                0165
         BNO   @RF00165                                            0165
*                         GPR15F=20;  /*SET RETURN CODE*/          0166
         LA    GPR15F,20                                           0166
*                      ELSE DO;  /*NOT OVER FLOW*/                 0167
         B     @RC00165                                            0167
@RF00165 DS    0H                                                  0168
*                         IF CPHENDST='1'B /*END OF STRING*/       0168
*                            THEN   /*YES*/                        0168
         TM    CPHENDST,B'00010000'                                0168
         BNO   @RF00168                                            0168
*                               GPR15F=8; /*SET RETURN CODE*/      0169
         LA    GPR15F,8                                            0169
*                            ELSE   /*NO ERRORS*/                  0170
*                               GPR15F=0; /*SET RETURN CODE*/      0170
         B     @RC00168                                            0170
@RF00168 SLR   GPR15F,GPR15F                                       0170
*                      END;   /*END NOT OVERFLOW*/                 0171
@RC00168 DS    0H                                                  0172
*                END;    /*END NOT FUNCTION ERROR*/                0172
@RC00165 DS    0H                                                  0173
*          END;          /*END NOT ARG NOT FOUND ERROR*/           0173
@RC00162 DS    0H                                                  0174
*     END;               /*END NOT SYNTAX ERROR*/                  0174
@RC00159 DS    0H                                                  0175
*        GPR03P=CPHINSVA;  /*PICK UP CALLER'S SVA ADDRESS    @DM39361*/
@RC00156 L     GPR03P,CPHINSVA                                     0175
*   GEN REFS(GPR15F,GPR00P,GPR01P,GPR13P)                          0176
*       (STM  15,1,16(3));  /*STORE OUTPUT REGS FOR CALLER   @DM39361*/
         STM  15,1,16(3)
*        IF GPR13P=ADDR(STATICFD)                                  0177
*          THEN CPHLOCK='00'X; /*RESET INLINE DATA LOCK      @DM39361*/
         LA    @10,STATICFD                                        0177
         CR    GPR13P,@10                                          0177
         BNE   @RF00177                                            0177
         MVI   CPHLOCK,X'00'                                       0178
*          ELSE DO;            /*ELSE RELEASE DYN DATA AREA  @DM39361*/
         B     @RC00177                                            0179
@RF00177 DS    0H                                                  0180
*        GEN SETS(GPR00P) SETS(GPR13P);                    /*@DM39361*/
         L    0,@SIZDATD
         FREEMAIN  R,LV=(0),A=(13)
*          END;                                            /*@DM39361*/
*        GPR13P=GPR03P;    /*PUT CALLER'S SVA ADDR IN R13    @DM39361*/
@RC00177 LR    GPR13P,GPR03P                                       0182
* END;                   /*SAVE AREA GOTTEN OK               @DM39361*/
* ELSE DO;               /*SAVE AREA NOT OBTAINED            @DM39361*/
         B     @RC00062                                            0184
@RF00062 DS    0H                                                  0185
*   GPR15F=20;           /* OVERFLOW RETURN CODE             @DM39361*/
         LA    GPR15F,20                                           0185
*   GPR13P=GPR03P;       /*RESTORE CALLER'S SVA ADDR         @DM39361*/
         LR    GPR13P,GPR03P                                       0186
* GEN REFS(GPR15P,GPR13P)                                          0187
*     (ST 15,16(13));    /*SAVE RETURN CODE FOR CALLER       @DM39361*/
         ST 15,16(13)
* GEN REFS(GPR04P,GPR05P,GPR13P,GPR06P,GPR07P);            /*@VS45113*/
         STM 4,7,36(13)
* END;                   /*SAVE AREA NOT OBTAINED            @DM39361*/
*/*CPHSUB01:03A2 E                                 */              0190
*/*******************************************************************/
*/*                                                                 */
*/*   CPHSUB01: FUNCTION 1 ROUTINE                                  */
*/*                                                                 */
*/*******************************************************************/
*   CPHSUB01: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0190
         B     @PB00002                                            0190
CPHSUB01 DS    0H                                                  0191
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0191
*    DO;                                                           0191
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15) RESTRICT */          0192
*                                                                  0193
*   END;/* CMZMREG */                                              0193
*   CMZX9904 = GPR14P;                                             0194
         LR    CMZX9904,GPR14P                                     0194
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15)  */                  0195
*                                                                  0196
*   END;/* CMZMREG */                                              0196
*   END ;                                                          0197
*      /*   R1=PARM STRING POINTER R2=OUTPUT AREA ADDRESS       */ 0198
*    /*ICALL(CPHSUBSC)*/                                           0198
*     DO;                                                          0198
*    CALL CPHSUBSC;                                                0199
*                                                                  0199
         BAL   @14,CPHSUBSC                                        0199
*    END ;     /*LOCATE NEXT SUBPARAMETER*/                        0200
*          /* CPHSPPTR= SUBPARAM PTR CPHSPLEN= SUBPARAM LENGTH*/   0201
*   IF CPHSYNER='1'B      /*SYNTAX ERROR */                        0201
*      THEN;              /*YES */                                 0201
         TM    CPHSYNER,B'00000001'                                0201
         BO    @RT00201                                            0201
*      ELSE DO;           /*NOT SYNTAX ERROR*/                     0203
*         PHRF1SAD=CPHSPPTR;/*SUBPARM PTR IN OUTPUT AREA*/         0204
         L     @10,CPHSPPTR                                        0204
         ST    @10,PHRF1SAD(,GPR02P)                               0204
*         PHRF1SLN=CPHSPLEN;/*SUBPARM LENGTH IN OUTPUT AREA*/      0205
         LH    @09,CPHSPLEN                                        0205
         ST    @09,PHRF1SLN(,GPR02P)                               0205
*         IF EVAL(CPHSPPTR-1)->CPHSBYTE(1)='(' /*LAST CHAR '('*/   0206
*            THEN DO;          /*YES LEFT PAREN*/                  0206
         LR    @09,@10                                             0206
         BCTR  @09,0                                               0206
         CLI   CPHSBYTE(@09),C'('                                  0206
         BNE   @RF00206                                            0206
*                /* GET ADDRESS OF LAST CHAR (CPHSPPTR MINUS 1)*/  0208
*               EVAL(CPHSPPTR-1)->CPHSBYTE(1)=' ';/*SET TO BLANK*/ 0208
         BCTR  @10,0                                               0208
         MVI   CPHSBYTE(@10),C' '                                  0208
*            END;            /*END LEFT PAREN CODE*/               0209
*            ELSE;           /*NOT LEFT PAREN*/                    0210
@RF00206 DS    0H                                                  0211
*FUN1LOOP:                                                         0211
*         DO WHILE(CPHSYNER='0'B&CPHLSTSP='0'B);/*LOOK FOR ','*/   0211
FUN1LOOP B     @DE00211                                            0211
@DL00211 DS    0H                                                  0212
*            IF GPR01P->CPHSBYTE(1) = ','   /* COMMA FOUND? */     0212
*               THEN   /* YES */                                   0212
         CLI   CPHSBYTE(GPR01P),C','                               0212
         BNE   @RF00212                                            0212
*                  PHRF1SLN = PHRF1SLN + 1;  /*ACCOUNT FOR COMMA */
         LA    @10,1                                               0213
         AL    @10,PHRF1SLN(,GPR02P)                               0213
         ST    @10,PHRF1SLN(,GPR02P)                               0213
*               ELSE;           /* NO STRING COUNT UPDATE */       0214
@RF00212 DS    0H                                                  0215
*             /*ICALL(CPHSUBSC)*/                                  0215
*              DO;                                                 0215
*             CALL CPHSUBSC;                                       0216
*                                                                  0216
         BAL   @14,CPHSUBSC                                        0216
*             END ;    /* LOCATE NEXT SUBPARAMETER*/               0217
*            PHRF1SLN=PHRF1SLN+CPHSPLEN; /*ADD SUBPARM LENGTH*/    0218
         LH    @10,CPHSPLEN                                        0218
         AL    @10,PHRF1SLN(,GPR02P)                               0218
         ST    @10,PHRF1SLN(,GPR02P)                               0218
*            CPHSPLEN = 0; /* ZAP COUNT TO AVOID DOUBLE UPDATES */ 0219
         SLR   @10,@10                                             0219
         STH   @10,CPHSPLEN                                        0219
*         END FUN1LOOP;                                            0220
@DE00211 TM    CPHSYNER,B'00000101'                                0220
         BZ    @DL00211                                            0220
*         IF CPHSYNER='1'B /*SYNTAX ERROR*/                        0221
*            THEN;         /*YES*/                                 0221
         TM    CPHSYNER,B'00000001'                                0221
         BO    @RT00221                                            0221
*            ELSE DO;      /*NOT SYNTAX ERROR*/                    0223
*                       /* CHECK LAST BYTE OF PARM LIST SCANNED */ 0224
*              IF EVAL(PHRF1SAD+PHRF1SLN)->CPHSBYTE(1)=')'/*LAST ')'*/
*                 THEN DO;      /*YES LAST CAHR IS RT PAREN*/      0224
         L     @10,PHRF1SAD(,GPR02P)                               0224
         L     @09,PHRF1SLN(,GPR02P)                               0224
         LR    @08,@10                                             0224
         ALR   @08,@09                                             0224
         CLI   CPHSBYTE(@08),C')'                                  0224
         BNE   @RF00224                                            0224
*            /*GET ADDRESS OF LAST CHAR (SUBPARM PTR PLUS STRING LEN)*/
*                     /*   MOVE 'BLANK' INTO THAT CHAR OF PARM STRING*/
*                    EVAL(PHRF1SAD+PHRF1SLN)->CPHSBYTE(1)=' ';     0226
         ALR   @10,@09                                             0226
         MVI   CPHSBYTE(@10),C' '                                  0226
*                 END;    /*END RT PAREN CODE*/                    0227
*                 ELSE;   /*NOT RT PAREN*/                         0228
@RF00224 DS    0H                                                  0229
*            END;         /*END NOT SYNTAX ERROR FROM COMMA SCAN*/ 0229
*      END;               /*END NOT SYNTAX ERROR FROM NXT PARM*/   0230
@RT00221 DS    0H                                                  0231
*    /*CMZPEND*/                                                   0231
*     DO;                                                          0231
@RT00201 DS    0H                                                  0232
*    DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15)  */                 0232
*                                                                  0233
*    END;/* CMZMREG */                                             0233
*    GPR14P = CMZX9904;                                            0234
         LR    GPR14P,CMZX9904                                     0234
*    DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15) RELEASE */          0235
*                                                                  0236
*    END;/* CMZMREG */                                             0236
*    END ;                                                         0237
*    END CPHSUB01;                                                 0238
@EL00002 DS    0H                                                  0238
@EF00002 DS    0H                                                  0238
@ER00002 BR    @14                                                 0238
*/********************************************************************/
*/*                                                                  */
*/*      CPHSUB02: FUNCTION 2 ROUTINE                                */
*/*                                                                  */
*/********************************************************************/
*   CPHSUB02: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0239
CPHSUB02 DS    0H                                                  0240
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0240
*    DO;                                                           0240
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15) RESTRICT */          0241
*                                                                  0242
*   END;/* CMZMREG */                                              0242
*   CMZX9905 = GPR14P;                                             0243
         LR    CMZX9905,GPR14P                                     0243
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15)  */                  0244
*                                                                  0245
*   END;/* CMZMREG */                                              0245
*   END ;                                                          0246
*  /* R0=PTR BLK ADDRESS R1=PARM STRING POINTER R2=OUTPUT AREA PTR*/
*   PHRF2NVL=0;                 /* RESET COUNT FIELD  */           0247
         SLR   @10,@10                                             0247
         ST    @10,PHRF2NVL(,GPR02P)                               0247
*                               /* RESET COUNT LIMIT  */           0248
*   CPHOALIM=(PHROALEN-(ADDR(PHRF2VAL(1))-GPR02P))/LENGTH(PHRF2VAL(1));
         LA    @10,PHRF2VAL(,GPR02P)                               0248
         SLR   @10,GPR02P                                          0248
         LR    @08,@10                                             0248
         LCR   @08,@08                                             0248
         AL    @08,PHROALEN(,GPR02P)                               0248
         SRDA  @08,32                                              0248
         D     @08,@CF00117                                        0248
         ST    @09,CPHOALIM                                        0248
*LOOP2:                                                            0249
*   DO CPHOANDX=1 TO CPHOALIM WHILE(CPHLSTSP='0'B&CPHSYNER='0'B&   0249
*         CPHFUNER='0'B);    /*GET ALL SUBPARMS WHILE NOT A SYNTAX*/
LOOP2    LA    @10,1                                               0249
         B     @DE00249                                            0249
@DL00249 TM    CPHLSTSP,B'00000101'                                0249
         BNZ   @DC00249                                            0249
         TM    CPHFUNER,B'01000000'                                0249
         BNZ   @DC00249                                            0249
*                                       /*ERROR AND NOT END OF STRING*/
*      /*ICALL(CPHSUBSC)*/                                         0250
*      F2LOOP: DO;                                                 0250
F2LOOP   DS    0H                                                  0251
*      CALL CPHSUBSC;                                              0251
*                                                                  0251
         BAL   @14,CPHSUBSC                                        0251
*      END F2LOOP;           /*LOCATE NEXT SUBPARAM */             0252
*                 /* CPHSPPTR= SUBPARAM PTR, CPHSPLEN= SUBPARAM LNGTH*/
*      IF CPHSYNER='1'B           /*SYNTAX ERROR*/                 0253
*          THEN;                  /*YES*/                          0253
         TM    CPHSYNER,B'00000001'                                0253
         BO    @RT00253                                            0253
*          ELSE DO;               /*NOT SYNTAX ERROR*/             0255
*             CPHTABAD=GPR00P->CPHSBTAB;  /*GET TABLE ADDR*/       0256
         LR    @10,GPR00P                                          0256
         MVC   CPHTABAD(4),CPHSBTAB(@10)                           0256
*             IF CPHSPLEN>8 /*SUB PARM TOO LONG*/                  0257
*                THEN        /*YES*/                               0257
         LH    @10,CPHSPLEN                                        0257
         C     @10,@CF00046                                        0257
         BNH   @RF00257                                            0257
*                   CPHFUNER='1'B;    /*SET FUNCTION ERROR*/       0258
         OI    CPHFUNER,B'01000000'                                0258
*                ELSE DO;         /*NOT TOO LONG*/                 0259
         B     @RC00257                                            0259
@RF00257 DS    0H                                                  0260
*                   IF CPHSPLEN=0   /*WAS SUB PARM DEFAULTED*/     0260
*                      THEN       /*YES*/                          0260
         SLR   @10,@10                                             0260
         CH    @10,CPHSPLEN                                        0260
         BNE   @RF00260                                            0260
*                         PHRF2VAL(CPHOANDX)=0;/*NEXT ENTRY EQUAL ZERO*
         L     @09,CPHOANDX                                        0261
         SLA   @09,2                                               0261
         ST    @10,PHRF2VAL-4(@09,GPR02P)                          0261
*                       ELSE DO;   /*NOT DEFAULTED*/               0262
         B     @RC00260                                            0262
@RF00260 DS    0H                                                  0263
*                                      /*PUT PARM IN SEARCH ARG*/  0263
*                          CPHARGUM=CPHSPPTR->CPHSBYTE(1:CPHSPLEN);
         MVI   CPHARGUM+1,C' '                                     0263
         MVC   CPHARGUM+2(6),CPHARGUM+1                            0263
         LH    @10,CPHSPLEN                                        0263
         BCTR  @10,0                                               0263
         L     @09,CPHSPPTR                                        0263
         EX    @10,@SM00442                                        0263
*                           /*ICALL(CPHTBLSC)*/                    0264
*                            DO;                                   0264
*                           CALL CPHTBLSC;                         0265
*                                                                  0265
         BAL   @14,CPHTBLSC                                        0265
*                           END ;  /*SEARCH SUBPARM TABLE*/        0266
*                          IF CPHARGNF='0'B     /*WAS ARG FOUND*/  0267
*                             THEN          /*YES*/                0267
         TM    CPHARGNF,B'00100000'                                0267
         BNZ   @RF00267                                            0267
*                                /* STORE TABLE ENTRY INTO OUTPUT AREA*
*                                MVC(CPHF2VAL(CPHOANDX),CPHSBVL1); 0268
         L     @10,CPHOANDX                                        0268
         SLA   @10,2                                               0268
         ALR   @10,GPR02P                                          0268
         MVC   CPHF2VAL-4(4,@10),CPHSBVL1                          0268
*                             ELSE DO;   /*ARG NOT FOUND*/         0269
         B     @RC00267                                            0269
@RF00267 DS    0H                                                  0270
*                          /*  STORE 'FF'S IN NEXT WORD OF OUTPUT AREA*
*                                PHRF2VAL(CPHOANDX)=-1;            0270
         L     @10,CPHOANDX                                        0270
         SLA   @10,2                                               0270
         SLR   @09,@09                                             0270
         BCTR  @09,0                                               0270
         ST    @09,PHRF2VAL-4(@10,GPR02P)                          0270
*                                CPHARGNF='0'B; /*RESET ARG NOT FOUND*/
         NI    CPHARGNF,B'11011111'                                0271
*                             END;       /*END ARG NOT FOUND*/     0272
*                       END;             /*END NOT DEFAULTED*/     0273
@RC00267 DS    0H                                                  0274
*                   PHRF2NVL=PHRF2NVL+1;/*INCR COUNT*/             0274
@RC00260 LA    @10,1                                               0274
         AL    @10,PHRF2NVL(,GPR02P)                               0274
         ST    @10,PHRF2NVL(,GPR02P)                               0274
*                END;             /*END NOT TOO LONG*/             0275
*          END;                   /*END NOT SYNTAX ERROR*/         0276
@RC00257 DS    0H                                                  0277
*   END LOOP2;                    /*END DO WHILE*/                 0277
@RT00253 LA    @10,1                                               0277
         AL    @10,CPHOANDX                                        0277
@DE00249 ST    @10,CPHOANDX                                        0277
         C     @10,CPHOALIM                                        0277
         BNH   @DL00249                                            0277
@DC00249 DS    0H                                                  0278
*   IF CPHOANDX>CPHOALIM&CPHLSTSP='0'B /*OVER FLOW AND NOT END*/   0278
*      THEN                                     /*YES*/            0278
         L     @10,CPHOANDX                                        0278
         C     @10,CPHOALIM                                        0278
         BNH   @RF00278                                            0278
         TM    CPHLSTSP,B'00000100'                                0278
         BNZ   @RF00278                                            0278
*         CPHOFLOW='1'B;           /*SET OVERFLOW */               0279
         OI    CPHOFLOW,B'10000000'                                0279
*      ELSE DO;                    /*NOT OVERFLOW*/                0280
         B     @RC00278                                            0280
@RF00278 DS    0H                                                  0281
*         IF CPHSYNER='0'B&CPHFUNER='0'B /*SYNTAX OR FUNCT ERR*/   0281
*            THEN                  /*NO*/                          0281
         TM    CPHSYNER,B'00000001'                                0281
         BNZ   @RF00281                                            0281
         TM    CPHFUNER,B'01000000'                                0281
         BNZ   @RF00281                                            0281
*               GPR00P=GPR00P->CPHSBVAL; /*SET R0 =ADDR OF RTN*/   0282
         LR    @10,GPR00P                                          0282
         ICM   GPR00P,15,CPHSBVAL(@10)                             0282
*            ELSE;                 /*YES SYNTAX OR FUNCT ERR*/     0283
@RF00281 DS    0H                                                  0284
*      END;                         /*END NOT OVERFLOW*/           0284
*    /*CMZPEND*/                                                   0285
*     DO;                                                          0285
@RC00278 DS    0H                                                  0286
*    DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15)  */                 0286
*                                                                  0287
*    END;/* CMZMREG */                                             0287
*    GPR14P = CMZX9905;                                            0288
         LR    GPR14P,CMZX9905                                     0288
*    DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15) RELEASE */          0289
*                                                                  0290
*    END;/* CMZMREG */                                             0290
*    END ;                                                         0291
*    END CPHSUB02;                                                 0292
@EL00003 DS    0H                                                  0292
@EF00003 DS    0H                                                  0292
@ER00003 BR    @14                                                 0292
*/********************************************************************/
*/*                                                                  */
*/*      CPHSUB34: FUNCTION 3, 4 ROUTINE                             */
*/*                                                                  */
*/********************************************************************/
*                                                                  0293
*   CPHSUB34: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0293
CPHSUB34 DS    0H                                                  0294
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0294
*    DO;                                                           0294
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15) RESTRICT */          0295
*                                                                  0296
*   END;/* CMZMREG */                                              0296
*   CMZX9906 = GPR14P;                                             0297
         LR    CMZX9906,GPR14P                                     0297
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15)  */                  0298
*                                                                  0299
*   END;/* CMZMREG */                                              0299
*   END ;                                                          0300
*                   /*  R1=PARM STRING PTR R2=OUTPUT AREA PTR*/    0301
*            /*RESET COUNT FIELD AND LIMIT OF OUTPUT AREA AND CPHOALIM*
*   PHRF34NS=0;                                                    0301
         SLR   @10,@10                                             0301
         ST    @10,PHRF34NS(,GPR02P)                               0301
*   CPHOALIM=(PHROALEN-(ADDR(PHRF34EN(1))-GPR02P))/LENGTH(PHRF34EN);
         LA    @10,PHRF34EN(,GPR02P)                               0302
         SLR   @10,GPR02P                                          0302
         LR    @08,@10                                             0302
         LCR   @08,@08                                             0302
         AL    @08,PHROALEN(,GPR02P)                               0302
         SRDA  @08,32                                              0302
         D     @08,@CF00235                                        0302
         ST    @09,CPHOALIM                                        0302
*             /*PROCESS ENTRIES WHILE NO ERRORS*/                  0303
*LOOP34:                                                           0303
*   DO CPHOANDX=1 TO CPHOALIM WHILE(CPHLSTSP='0'B&CPHFUNER='0'B&   0303
*         CPHSYNER='0'B);                                          0303
LOOP34   LA    @10,1                                               0303
         B     @DE00303                                            0303
@DL00303 TM    CPHLSTSP,B'00000100'                                0303
         BNZ   @DC00303                                            0303
         TM    CPHFUNER,B'01000000'                                0303
         BNZ   @DC00303                                            0303
         TM    CPHSYNER,B'00000001'                                0303
         BNZ   @DC00303                                            0303
*      /*ICALL(CPHSUBSC)*/                                         0304
*      F34LOOP: DO;                                                0304
F34LOOP  DS    0H                                                  0305
*      CALL CPHSUBSC;                                              0305
*                                                                  0305
         BAL   @14,CPHSUBSC                                        0305
*      END F34LOOP;            /*  LOCATE NEXT SUBPARAM*/          0306
*      IF CPHSYNER='1'B         /* SYNTAX ERROR*/                  0307
*         THEN;                   /*YES*/                          0307
         TM    CPHSYNER,B'00000001'                                0307
         BO    @RT00307                                            0307
*         ELSE DO;                 /*NOT SYNTAX ERROR*/            0309
*            IF CPHSPLEN>8         /*PARM TOO LONG*/               0310
*               THEN               /*YES*/                         0310
         LH    @10,CPHSPLEN                                        0310
         C     @10,@CF00046                                        0310
         BNH   @RF00310                                            0310
*                  CPHFUNER='1'B;  /*SET FUNCTION ERROR*/          0311
         OI    CPHFUNER,B'01000000'                                0311
*               ELSE DO;           /*NOT TOO LONG*/                0312
         B     @RC00310                                            0312
@RF00310 DS    0H                                                  0313
*                  IF CPHSPLEN=0   /*WAS PARM DEFAULTED*/          0313
*                     THEN DO;     /*YES*/                         0313
         LH    @10,CPHSPLEN                                        0313
         LTR   @10,@10                                             0313
         BNZ   @RF00313                                            0313
*                        IF CPHFUNNO=CPHFUN03 /*FUNCT 3*/          0315
*                           THEN    /*YES*/                        0315
         TM    CPHFUNNO,B'00000011'                                0315
         BNO   @RF00315                                            0315
         TM    CPHFUNNO,B'00001100'                                0315
         BNZ   @RF00315                                            0315
*                              PHRF34SP(CPHOANDX)=' ';/*SET TO BLANKS*/
         L     @10,CPHOANDX                                        0316
         MH    @10,@CH00235                                        0316
         ALR   @10,GPR02P                                          0316
         MVI   PHRF34SP-11(@10),C' '                               0316
         MVC   PHRF34SP-10(6,@10),PHRF34SP-11(@10)                 0316
         MVI   PHRF34SP-12(@10),C' '                               0316
*                           ELSE    /*NO NOT FUNCT 3*/             0317
*                              PHRF34SP(CPHOANDX)='00000000';/*ST TO 0*
         B     @RC00315                                            0317
@RF00315 L     @10,CPHOANDX                                        0317
         MH    @10,@CH00235                                        0317
         ALR   @10,GPR02P                                          0317
         MVC   PHRF34SP-12(8,@10),@CC00266                         0317
*                     END;    /*END DEFAULTED*/                    0318
*                     ELSE DO;     /*NOT DEFAULTED*/               0319
         B     @RC00313                                            0319
@RF00313 DS    0H                                                  0320
*                         /*ICALL(CPHVALCK)*/                      0320
*                          DO;                                     0320
*                         CALL CPHVALCK;                           0321
*                                                                  0321
         BAL   @14,CPHVALCK                                        0321
*                         END ; /*CK VALIDITY OF PARM*/            0322
*                        PHRF34VF(CPHOANDX)=CPHVALFG;/*SET VAL FLG*/
         L     @10,CPHOANDX                                        0323
         MH    @10,@CH00235                                        0323
         ST    @10,@TF00001                                        0323
         ALR   @10,GPR02P                                          0323
         AL    @10,@CF00448                                        0323
         MVC   PHRF34VF-8(1,@10),CPHVALFG                          0323
*                        IF CPHFUNNO=CPHFUN03 /*FUNCT 3*/          0324
*                           THEN DO;          /*YES*/              0324
         TM    CPHFUNNO,B'00000011'                                0324
         BNO   @RF00324                                            0324
         TM    CPHFUNNO,B'00001100'                                0324
         BNZ   @RF00324                                            0324
*                              PHRF34SP(CPHOANDX)=' ';/*INIT TO BLANK*/
         LR    @10,GPR02P                                          0326
         AL    @10,@TF00001                                        0326
         MVI   PHRF34SP-11(@10),C' '                               0326
         MVC   PHRF34SP-10(6,@10),PHRF34SP-11(@10)                 0326
         MVI   PHRF34SP-12(@10),C' '                               0326
*                    /* MOVE SUBPARAM TO PHRF34SP(*) LEFT JUSTIFIED*/
*                                     /*PADDED WITH BLANKS (8 CHAR) */
*                              PHRF34SP(CPHOANDX,1:CPHSPLEN)=      0327
*                                CPHSPPTR->CPHSBYTE(1:CPHSPLEN);   0327
         LR    @10,GPR02P                                          0327
         AL    @10,@TF00001                                        0327
         LH    @09,CPHSPLEN                                        0327
         BCTR  @09,0                                               0327
         L     @08,CPHSPPTR                                        0327
         EX    @09,@SM00449                                        0327
*                           END;              /*END FUNCT 3*/      0328
*                           ELSE DO;   /*NOT FUNCT 3*/             0329
         B     @RC00324                                            0329
@RF00324 DS    0H                                                  0330
*                              /*  INIT PHRF34SP(*) TO EBCDIC ZEROS*/
*                              PHRF34SP(CPHOANDX)='00000000';      0330
         L     @10,CPHOANDX                                        0330
         MH    @10,@CH00235                                        0330
         ST    @10,@TF00001                                        0330
         ALR   @10,GPR02P                                          0330
         MVC   PHRF34SP-12(8,@10),@CC00266                         0330
*               /* MOVE SUBPARAM TO PHRF34SP(*) RIGHT JUSTIFIED PADDED*
*                                        /*WITH ZEROS (8 CHARS)*/  0331
*                              PHRF34SP(CPHOANDX,9-CPHSPLEN:8)=    0331
*                              CPHSPPTR->CPHSBYTE(1:CPHSPLEN);     0331
         LA    @10,9                                               0331
         SH    @10,CPHSPLEN                                        0331
         L     @09,@TF00001                                        0331
         ALR   @09,@10                                             0331
         ALR   @09,GPR02P                                          0331
         BCTR  @09,0                                               0331
         LCR   @10,@10                                             0331
         AL    @10,@CF00046                                        0331
         L     @08,CPHSPPTR                                        0331
         EX    @10,@SM00451                                        0331
*                           END;        /*END NOT FUNCT 3*/        0332
*                     END;              /*END NOT DEFAULTED*/      0333
@RC00324 DS    0H                                                  0334
*                  PHRF34SL(CPHOANDX)=CPHSPLEN;/*PUT LEN IN OUT AREA*/
@RC00313 L     @10,CPHOANDX                                        0334
         MH    @10,@CH00235                                        0334
         LH    @09,CPHSPLEN                                        0334
         BCTR  @10,0                                               0334
         BCTR  @10,0                                               0334
         STH   @09,PHRF34SL-10(@10,GPR02P)                         0334
*                  PHRF34NS=PHRF34NS+1;       /*INC NO. SUBPARM*/  0335
         LA    @10,1                                               0335
         AL    @10,PHRF34NS(,GPR02P)                               0335
         ST    @10,PHRF34NS(,GPR02P)                               0335
*               END;           /*END NOT TOO LONG*/                0336
*         END;                 /*END NOT SYNTAX ERROR*/            0337
@RC00310 DS    0H                                                  0338
*   END LOOP34;                /*END DO WHILE*/                    0338
@RT00307 LA    @10,1                                               0338
         AL    @10,CPHOANDX                                        0338
@DE00303 ST    @10,CPHOANDX                                        0338
         C     @10,CPHOALIM                                        0338
         BNH   @DL00303                                            0338
@DC00303 DS    0H                                                  0339
*   IF CPHOANDX>CPHOALIM&CPHLSTSP='0'B /*OVERFLOW AND NOT END*/    0339
*      THEN                    /*YES*/                             0339
         L     @10,CPHOANDX                                        0339
         C     @10,CPHOALIM                                        0339
         BNH   @RF00339                                            0339
         TM    CPHLSTSP,B'00000100'                                0339
         BNZ   @RF00339                                            0339
*         CPHOFLOW='1'B;       /*SET OVERFLOW FLG*/                0340
         OI    CPHOFLOW,B'10000000'                                0340
*      ELSE;                   /*NOT OVER FLOW*/                   0341
@RF00339 DS    0H                                                  0342
*    /*CMZPEND*/                                                   0342
*     DO;                                                          0342
*    DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15)  */                 0343
*                                                                  0344
*    END;/* CMZMREG */                                             0344
*    GPR14P = CMZX9906;                                            0345
         LR    GPR14P,CMZX9906                                     0345
*    DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15) RELEASE */          0346
*                                                                  0347
*    END;/* CMZMREG */                                             0347
*    END ;                                                         0348
*    END CPHSUB34;                                                 0349
@EL00004 DS    0H                                                  0349
@EF00004 DS    0H                                                  0349
@ER00004 BR    @14                                                 0349
*/********************************************************************/
*/*                                                                  */
*/*        CPHSUB05: FUNCTION 5 ROUTINE                              */
*/*                                                                  */
*/********************************************************************/
*                                                                  0350
*  CPHSUB05: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                   0350
CPHSUB05 DS    0H                                                  0351
*  /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                        0351
*   DO;                                                            0351
*  DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15) RESTRICT */           0352
*                                                                  0353
*  END;/* CMZMREG */                                               0353
*  CMZX9907 = GPR14P;                                              0354
         LR    CMZX9907,GPR14P                                     0354
*  DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15)  */                   0355
*                                                                  0356
*  END;/* CMZMREG */                                               0356
*  END ;                                                           0357
*                      /* R1=PARM STRING PTR R2=OUTPUT AREA PTR*/  0358
*/*  RESET COUNT FIELD AND LIMIT OF OUTPUT AREA (PHRF5NSP & CPHOALIM)*/
*   PHRF5NSP=0;                                                    0358
         SLR   @10,@10                                             0358
         ST    @10,PHRF5NSP(,GPR02P)                               0358
*   CPHOALIM=(PHROALEN-(ADDR(PHRF5ENT(1))-GPR02P))/LENGTH(PHRF5ENT);
         LA    @10,PHRF5ENT(,GPR02P)                               0359
         SLR   @10,GPR02P                                          0359
         LR    @08,@10                                             0359
         LCR   @08,@08                                             0359
         AL    @08,PHROALEN(,GPR02P)                               0359
         SRDA  @08,32                                              0359
         D     @08,@CF00046                                        0359
         ST    @09,CPHOALIM                                        0359
*             /*PROCESS ENTRIES WHILE NO ERRORS*/                  0360
*LOOP5:                                                            0360
*   DO CPHOANDX=1 TO CPHOALIM WHILE(CPHLSTSP='0'B&CPHSYNER='0'B);  0360
LOOP5    LA    @10,1                                               0360
         B     @DE00360                                            0360
@DL00360 TM    CPHLSTSP,B'00000101'                                0360
         BNZ   @DC00360                                            0360
*      /*ICALL(CPHSUBSC)*/                                         0361
*      F5LOOP: DO;                                                 0361
F5LOOP   DS    0H                                                  0362
*      CALL CPHSUBSC;                                              0362
*                                                                  0362
         BAL   @14,CPHSUBSC                                        0362
*      END F5LOOP;     /* LOCATE NEXT SUBPARAM*/                   0363
*                  /*CPHSPPTR= SUBPARAM PTR CPHSPLEN= SUBPARAM LENGTH*/
*      IF CPHSYNER='1'B         /* SYNTAX ERROR */                 0364
*         THEN;                 /*YES  */                          0364
         TM    CPHSYNER,B'00000001'                                0364
         BO    @RT00364                                            0364
*         ELSE DO;            /* NOT SYNTAX ERROR*/                0366
*            IF CPHSPPTR=0     /*PARM DEFAULTED*/                  0367
*               THEN;          /*YES*/                             0367
         L     @10,CPHSPPTR                                        0367
         LTR   @10,@10                                             0367
         BZ    @RT00367                                            0367
*               ELSE DO;             /*NOT DEFAULTED*/             0369
*                   /*ICALL(CPHVALCK)*/                            0370
*                    DO;                                           0370
*                   CALL CPHVALCK;                                 0371
*                                                                  0371
         BAL   @14,CPHVALCK                                        0371
*                   END ;  /* CHECK SUBPARAM VALIDITY*/            0372
*                  PHRF5VF(CPHOANDX)=CPHVALFG;/*SET VAL FLGS IN OUTARA*
         L     @10,CPHOANDX                                        0373
         SLA   @10,3                                               0373
         ALR   @10,GPR02P                                          0373
         MVC   PHRF5VF-8(1,@10),CPHVALFG                           0373
*               END;                 /*END NOT DEFAULTED*/         0374
*            PHRF5SL(CPHOANDX)=CPHSPLEN;/*SET LENGTH IN OUT AREA*/ 0375
@RT00367 L     @10,CPHOANDX                                        0375
         SLA   @10,3                                               0375
         LH    @09,CPHSPLEN                                        0375
         STH   @09,PHRF5SL-8(@10,GPR02P)                           0375
*            PHRF5SPT(CPHOANDX)=CPHSPPTR;/*PUT PTR IN OUT AREA*/   0376
         L     @09,CPHSPPTR                                        0376
         ST    @09,PHRF5SPT-8(@10,GPR02P)                          0376
*            PHRF5NSP=PHRF5NSP+1;   /*INCR COUNT*/                 0377
         LA    @10,1                                               0377
         AL    @10,PHRF5NSP(,GPR02P)                               0377
         ST    @10,PHRF5NSP(,GPR02P)                               0377
*         END;                  /*END NOT SYNTAX ERROR*/           0378
*   END LOOP5;                  /*END DO WHILE*/                   0379
@RT00364 LA    @10,1                                               0379
         AL    @10,CPHOANDX                                        0379
@DE00360 ST    @10,CPHOANDX                                        0379
         C     @10,CPHOALIM                                        0379
         BNH   @DL00360                                            0379
@DC00360 DS    0H                                                  0380
*   IF CPHOANDX>CPHOALIM /*OVER FLOW AND NOT END OF LIST*/         0380
*      THEN                     /*YES */                           0380
         L     @10,CPHOANDX                                        0380
         C     @10,CPHOALIM                                        0380
         BNH   @RF00380                                            0380
*         CPHOFLOW='1'B;        /*SET OVERFLOW FLAG*/              0381
         OI    CPHOFLOW,B'10000000'                                0381
*      ELSE;                    /*NOT OVERFLOW*/                   0382
@RF00380 DS    0H                                                  0383
*    /*CMZPEND*/                                                   0383
*     DO;                                                          0383
*    DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15)  */                 0384
*                                                                  0385
*    END;/* CMZMREG */                                             0385
*    GPR14P = CMZX9907;                                            0386
         LR    GPR14P,CMZX9907                                     0386
*    DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15) RELEASE */          0387
*                                                                  0388
*    END;/* CMZMREG */                                             0388
*    END ;                                                         0389
*    END CPHSUB05;                                                 0390
@EL00005 DS    0H                                                  0390
@EF00005 DS    0H                                                  0390
@ER00005 BR    @14                                                 0390
*/********************************************************************/
*/*                                                                  */
*/*        CPHSUB06: FUNCTION 6 ROUTINE                              */
*/*                                                                  */
*/********************************************************************/
*   CPHSUB06: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0391
CPHSUB06 DS    0H                                                  0392
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0392
*    DO;                                                           0392
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15) RESTRICT */          0393
*                                                                  0394
*   END;/* CMZMREG */                                              0394
*   CMZX9908 = GPR14P;                                             0395
         LR    CMZX9908,GPR14P                                     0395
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15)  */                  0396
*                                                                  0397
*   END;/* CMZMREG */                                              0397
*   END ;                                                          0398
*                            /* R1=PARM STRING POINTER */          0399
*   DO WHILE (CPHLSTSP='0'B & CPHSYNER='0'B);    /*PROCESS PARMS*/ 0399
         B     @DE00399                                            0399
@DL00399 DS    0H                                                  0400
*     /*ICALL(CPHSUBSC)*/                                          0400
*     F6LOOP: DO;                                                  0400
F6LOOP   DS    0H                                                  0401
*     CALL CPHSUBSC;                                               0401
*                                                                  0401
         BAL   @14,CPHSUBSC                                        0401
*     END F6LOOP;   /*LOCATE NEXT SUBPARAM              */         0402
*   END;                   /*END DO WHILE*/                        0403
@DE00399 TM    CPHLSTSP,B'00000101'                                0403
         BZ    @DL00399                                            0403
*    /*CMZPEND*/                                                   0404
*     DO;                                                          0404
*    DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15)  */                 0405
*                                                                  0406
*    END;/* CMZMREG */                                             0406
*    GPR14P = CMZX9908;                                            0407
         LR    GPR14P,CMZX9908                                     0407
*    DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15) RELEASE */          0408
*                                                                  0409
*    END;/* CMZMREG */                                             0409
*    END ;                                                         0410
*    END CPHSUB06;                                                 0411
@EL00006 DS    0H                                                  0411
@EF00006 DS    0H                                                  0411
@ER00006 BR    @14                                                 0411
*/*******************************************************************/
*/*                                                                  */
*/*       CPHSUB07: FUNCTIONS 7 AND 8 ROUTINE                        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0412
*   CPHSUB07: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0412
CPHSUB07 DS    0H                                                  0413
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0413
*    DO;                                                           0413
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15) RESTRICT */          0414
*                                                                  0415
*   END;/* CMZMREG */                                              0415
*   CMZX9909 = GPR14P;                                             0416
         LR    CMZX9909,GPR14P                                     0416
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15)  */                  0417
*                                                                  0418
*   END;/* CMZMREG */                                              0418
*   END ;                                                          0419
* /*RESET COUNT FIELD AND LIMIT IN OUTPUT AREA (PHRF7NSP & CPHOALIM)*/
* IF CPHFUNNO=CPHFUN07 THEN DO;                            /*@D32CKKA*/
         TM    CPHFUNNO,B'00000111'                                0420
         BNO   @RF00420                                            0420
         TM    CPHFUNNO,B'00001000'                                0420
         BNZ   @RF00420                                            0420
*   PHRF7NSP=0;                                                    0422
         SLR   @10,@10                                             0422
         ST    @10,PHRF7NSP(,GPR02P)                               0422
*   CPHOALIM=(PHROALEN-(ADDR(PHRF7NUM(1))-GPR02P))/LENGTH(PHRF7NUM);
         LA    @10,PHRF7NUM(,GPR02P)                               0423
         SLR   @10,GPR02P                                          0423
         LCR   @10,@10                                             0423
         AL    @10,PHROALEN(,GPR02P)                               0423
         ST    @10,CPHOALIM                                        0423
*    END;                                                  /*@D32CKKA*/
* ELSE DO;                          /*DO SAME FOR FUNCTION 8 @D32CKKA*/
         B     @RC00420                                            0425
@RF00420 DS    0H                                                  0426
*   PHRF8NSP=0;                                            /*@D32CKKA*/
         SLR   @10,@10                                             0426
         ST    @10,PHRF8NSP(,GPR02P)                               0426
*   CPHOALIM=(PHROALEN-(ADDR(PHRF8ENT(1))-GPR02P))/LENGTH(PHRF8ENT);
         LA    @10,PHRF8ENT(,GPR02P)                               0427
         SLR   @10,GPR02P                                          0427
         LR    @08,@10                                             0427
         LCR   @08,@08                                             0427
         AL    @08,PHROALEN(,GPR02P)                               0427
         SRDA  @08,32                                              0427
         D     @08,@CF00311                                        0427
         ST    @09,CPHOALIM                                        0427
*    END;                                                  /*@D32CKKA*/
*                      /*  R1=PARM STRING PTR R2=OUTPUT AREA PTR*/ 0429
*LOOP7:                                                            0429
*   DO CPHOANDX=1 TO CPHOALIM WHILE(CPHLSTSP='0'B&CPHFUNER='0'B&   0429
*         CPHSYNER='0'B);/*PROCESS ENTRIES*/                       0429
@RC00420 DS    0H                                                  0429
LOOP7    LA    @10,1                                               0429
         B     @DE00429                                            0429
@DL00429 TM    CPHLSTSP,B'00000100'                                0429
         BNZ   @DC00429                                            0429
         TM    CPHFUNER,B'01000000'                                0429
         BNZ   @DC00429                                            0429
         TM    CPHSYNER,B'00000001'                                0429
         BNZ   @DC00429                                            0429
*      /*ICALL(CPHSUBSC)*/                                         0430
*      F7LOOP: DO;                                                 0430
F7LOOP   DS    0H                                                  0431
*      CALL CPHSUBSC;                                              0431
*                                                                  0431
         BAL   @14,CPHSUBSC                                        0431
*      END F7LOOP;            /* LOCATE NEXT SUBPARAM*/            0432
*                  /* CPHSPPTR= SUBPARAM PTR CPHSPLEN= SUBPARAM LENGTH*
*      IF CPHSYNER='1'B              /*SYNTAX ERROR*/              0433
*         THEN;                     /*YES */                       0433
         TM    CPHSYNER,B'00000001'                                0433
         BO    @RT00433                                            0433
*         ELSE DO;                   /*NOT SYNTAX ERROR*/          0435
*            CPHVALBT=CPHVALBT×'40'X;   /*CHECK FOR NUMERICS @DM12920*/
         OI    CPHVALBT,X'40'                                      0436
*            IF CPHSPPTR*CPHSPLEN=0 /*SUB PARM DEFAULTED*/         0437
*             THEN IF CPHFUNNO=CPHFUN07  /*DEFAULTED AND F7  @D32CKKA*/
         L     @10,CPHSPPTR                                        0437
         MH    @10,CPHSPLEN                                        0437
         LTR   @10,@10                                             0437
         BNZ   @RF00437                                            0437
*               THEN CPHFUNER='1'B;  /*SET FUNCTION ERROR    @D32CKKA*/
         TM    CPHFUNNO,B'00000111'                                0438
         BNO   @RF00438                                            0438
         TM    CPHFUNNO,B'00001000'                                0438
         BNZ   @RF00438                                            0438
         OI    CPHFUNER,B'01000000'                                0439
*               ELSE DO;               /*DEFAULTED AND FUNC8 @D32CKKA*/
         B     @RC00438                                            0440
@RF00438 DS    0H                                                  0441
*                 PHRF8DFT(CPHOANDX)='1'B;  /*DEFAULT FLG ON @D32CKKA*/
         L     @10,CPHOANDX                                        0441
         ALR   @10,@10                                             0441
         ST    @10,@TF00001                                        0441
         ALR   @10,GPR02P                                          0441
         OI    PHRF8DFT-2(@10),B'10000000'                         0441
*                 PHRF8NSP=PHRF8NSP+1;   /*INC SUBPARM COUNT @D32CKKA*/
         LA    @10,1                                               0442
         AL    @10,PHRF8NSP(,GPR02P)                               0442
         ST    @10,PHRF8NSP(,GPR02P)                               0442
*                 PHRF8NUM(CPHOANDX)='00'X;    /*CLEAR VALUE @D32CKKA*/
         SLR   @10,@10                                             0443
         L     @09,@TF00001                                        0443
         STC   @10,PHRF8NUM-2(@09,GPR02P)                          0443
*                 END;                                     /*@D32CKKA*/
*               ELSE DO;       /*NOT DEFAULTED*/                   0445
         B     @RC00437                                            0445
@RF00437 DS    0H                                                  0446
*                   /*ICALL(CPHVALCK)*/                            0446
*                    DO;                                           0446
*                   CALL CPHVALCK;                                 0447
*                                                                  0447
         BAL   @14,CPHVALCK                                        0447
*                   END ;     /*CHECK SUBPARAM FOR NUMERIC*/       0448
*                  IF CPHVALNU='1'B ×  /*NOT NUMERIC         @DM10621*/
*                     CPHVALAN='1'B /*OR NOT ALPHA NUMERIC   @DM10621*/
*                     THEN               /*YES*/                   0449
         TM    CPHVALNU,B'01100000'                                0449
         BZ    @RF00449                                            0449
*                        CPHFUNER='1'B;   /*SET FUNCTION ERROR*/   0450
         OI    CPHFUNER,B'01000000'                                0450
*                     ELSE DO;   /*NOT AN ERROR*/                  0451
         B     @RC00449                                            0451
@RF00449 DS    0H                                                  0452
*                        IF CPHSPLEN>3 /*GR THAN 3 CHAR*/          0452
*                           THEN      /*YES*/                      0452
         LH    @10,CPHSPLEN                                        0452
         C     @10,@CF00182                                        0452
         BNH   @RF00452                                            0452
*                              CPHFUNER='1'B;  /*SET FUNCT ERROR*/ 0453
         OI    CPHFUNER,B'01000000'                                0453
*                           ELSE DO;  /*NOT GR TAHN 3*/            0454
         B     @RC00452                                            0454
@RF00452 DS    0H                                                  0455
*                               /* CONVERT DECIMAL SUBPARAM TO HEX*/
*                              CPHDECHX='000';/* INIT HOLD AREA     */
         MVC   CPHDECHX(3),@CC00291                                0455
*                              CPHDECHX(4-CPHSPLEN:3)=     /*MOVE NO.*/
*                              CPHSPPTR->CPHSBYTE(1:CPHSPLEN);     0456
         LA    @10,4                                               0456
         SH    @10,CPHSPLEN                                        0456
         LA    @09,CPHDECHX-1(@10)                                 0456
         LCR   @10,@10                                             0456
         AL    @10,@CF00182                                        0456
         L     @08,CPHSPPTR                                        0456
         EX    @10,@SM00453                                        0456
*                              PACK(CPHDECHX,CPHDECHX);            0457
         PACK  CPHDECHX(3),CPHDECHX(3)                             0457
*                                     /* PACK EBCDIC TO DIGITS + SIGN*/
*                              CVB(GPR15F,CPHDECHX);               0458
         XC    @TS00001(8),@TS00001                                0458
         MVC   @TS00001+5(3),CPHDECHX                              0458
         CVB   GPR15F,@TS00001                                     0458
*                                     /* PUT HEX VALUE IN REGISTER 1*/
*                              IF GPR15F>255 /*PARM GR THAN 255*/  0459
*                                 THEN    /*YES*/                  0459
         C     GPR15F,@CF00294                                     0459
         BNH   @RF00459                                            0459
*                                    CPHFUNER='1'B;/*SET FUNCTION ERR*/
         OI    CPHFUNER,B'01000000'                                0460
*                                   ELSE IF CPHFUNNO=CPHFUN07      0461
*                                    THEN DO;             /*@D32CKKA*/
         B     @RC00459                                            0461
@RF00459 TM    CPHFUNNO,B'00000111'                                0461
         BNO   @RF00461                                            0461
         TM    CPHFUNNO,B'00001000'                                0461
         BNZ   @RF00461                                            0461
*                                   /* MOVE HEX BYTE TO OUTPUT AREA*/
*                                     PHRF7NUM(CPHOANDX)=GPR15F;   0463
         L     @10,CPHOANDX                                        0463
         STC   GPR15F,PHRF7NUM-1(@10,GPR02P)                       0463
*                                     PHRF7NSP=PHRF7NSP+1;/*INCR CNT*/
         LA    @10,1                                               0464
         AL    @10,PHRF7NSP(,GPR02P)                               0464
         ST    @10,PHRF7NSP(,GPR02P)                               0464
*                                     END;  /*END FUNC 7 @D32CKKA*/
*                                    ELSE DO; /*FUNC 8 @D32CKKA*/  0466
         B     @RC00461                                            0466
@RF00461 DS    0H                                                  0467
*                                      /*MOVE DATA TO OUTPUT AREA*/
*                                     PHRF8NUM(CPHOANDX)=GPR15F;   0467
         L     @10,CPHOANDX                                        0467
         ALR   @10,@10                                             0467
         STC   GPR15F,PHRF8NUM-2(@10,GPR02P)                       0467
*                                     PHRF8NSP=PHRF8NSP+1; /*@D32CKKA*/
         LA    @09,1                                               0468
         AL    @09,PHRF8NSP(,GPR02P)                               0468
         ST    @09,PHRF8NSP(,GPR02P)                               0468
*                                     PHRF8DFT(CPHOANDX)='0'B;     0469
         ALR   @10,GPR02P                                          0469
         NI    PHRF8DFT-2(@10),B'01111111'                         0469
*                                     /*INC NUMBER OF PARMS AND CLEAR*/
*                                     /*DEFAULT FLAG        @D32CKKA*/
*                                     END; /*END FUNC 8 @D32CKKA*/ 0470
*                           END;         /*END NOT GR THAN 3*/     0471
@RC00461 DS    0H                                                  0471
@RC00459 DS    0H                                                  0472
*                     END;               /*END NO ERRORS*/         0472
@RC00452 DS    0H                                                  0473
*               END;                     /*END NOT DEFAULTED*/     0473
@RC00449 DS    0H                                                  0474
*         END;                           /*END NOT SYNTAX ERROR*/  0474
@RC00437 DS    0H                                                  0475
*   END LOOP7;                            /*END DO WHILE*/         0475
@RT00433 LA    @10,1                                               0475
         AL    @10,CPHOANDX                                        0475
@DE00429 ST    @10,CPHOANDX                                        0475
         C     @10,CPHOALIM                                        0475
         BNH   @DL00429                                            0475
@DC00429 DS    0H                                                  0476
*   IF CPHOANDX>CPHOALIM                 /*OVERFLOW*/              0476
*      THEN                             /*YES*/                    0476
         L     @10,CPHOANDX                                        0476
         C     @10,CPHOALIM                                        0476
         BNH   @RF00476                                            0476
*         CPHOFLOW='1'B;                /*SET OVERFLOW FLG*/       0477
         OI    CPHOFLOW,B'10000000'                                0477
*      ELSE;                            /*NOT OVERFLOW*/           0478
@RF00476 DS    0H                                                  0479
*  /*CMZPEND*/                                                     0479
*   DO;                                                            0479
*  DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15)  */                   0480
*                                                                  0481
*  END;/* CMZMREG */                                               0481
*  GPR14P = CMZX9909;                                              0482
         LR    GPR14P,CMZX9909                                     0482
*  DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15) RELEASE */            0483
*                                                                  0484
*  END;/* CMZMREG */                                               0484
*  END ;                                                           0485
*  END CPHSUB07;                                                   0486
@EL00007 DS    0H                                                  0486
@EF00007 DS    0H                                                  0486
@ER00007 BR    @14                                                 0486
*/********************************************************************/
*/*                                                                  */
*/*      CPHTBLSC: TABLE SEARCH ROUTINE                              */
*/*                                                                  */
*/********************************************************************/
*   CPHTBLSC: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0487
CPHTBLSC DS    0H                                                  0488
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0488
*    DO;                                                           0488
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15) RESTRICT */          0489
*                                                                  0490
*   END;/* CMZMREG */                                              0490
*   CMZX9903 = GPR14P;                                             0491
         LR    CMZX9903,GPR14P                                     0491
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15)  */                  0492
*                                                                  0493
*   END;/* CMZMREG */                                              0493
*   END ;                                                          0494
*   CPHTABSV=CPHTABAD;         /*SAVE TABLE PTR IN CPHTABSV*/      0495
         L     @10,CPHTABAD                                        0495
         ST    @10,CPHTABSV                                        0495
*   CPHARGNF='1'B;          /*INIT ARG NOT FOUND ON*/              0496
         OI    CPHARGNF,B'00100000'                                0496
*TBLOOP:                    /*SEARCH FOR ARG*/                     0497
*   DO CPHENCTR=1 TO CPHTABSV->CPHENTNO WHILE(CPHARGNF='1'B);      0497
TBLOOP   LA    @10,1                                               0497
         B     @DE00497                                            0497
@DL00497 TM    CPHARGNF,B'00100000'                                0497
         BNO   @DC00497                                            0497
*      IF CPHKEYWD(1)=CPHARGUM /*IS THIS THE CORRECT ONE*/         0498
*         THEN DO;             /*YES*/                             0498
         L     @10,CPHTABAD                                        0498
         CLC   CPHKEYWD(8,@10),CPHARGUM                            0498
         BNE   @RF00498                                            0498
*            CPHSUBVL(1:CPHTABSV->CPHENTLN-8)=CPHFUNBT(1,1:CPHTABSV->
*             CPHENTLN-8);    /*MOVE ENTRY MINUS FIRST 8*/         0500
         L     @09,CPHTABSV                                        0500
         ICM   @09,12,CPHENTLN(@09)                                0500
         SRA   @09,16                                              0500
         SL    @09,@CF00268                                        0500
         EX    @09,@SM00456                                        0500
*            CPHARGNF='0'B;    /*RESET ARG NOT FOUND FLG*/         0501
         NI    CPHARGNF,B'11011111'                                0501
*         END;                 /*END CORRECT ENTRY*/               0502
*         ELSE                 /*NOT CORRECT ENTRY*/               0503
*            CPHTABAD=CPHTABSV->CPHENTLN+CPHTABAD;/*GET NEXT ENTRY*/
         B     @RC00498                                            0503
@RF00498 L     @10,CPHTABSV                                        0503
         ICM   @10,12,CPHENTLN(@10)                                0503
         SRA   @10,16                                              0503
         AL    @10,CPHTABAD                                        0503
         ST    @10,CPHTABAD                                        0503
*   END TBLOOP;                                                    0504
@RC00498 LA    @10,1                                               0504
         AH    @10,CPHENCTR                                        0504
@DE00497 STH   @10,CPHENCTR                                        0504
         L     @09,CPHTABSV                                        0504
         ICM   @09,12,CPHENTNO(@09)                                0504
         SRA   @09,16                                              0504
         CR    @10,@09                                             0504
         BNH   @DL00497                                            0504
@DC00497 DS    0H                                                  0505
*   /*CMZPEND*/                                                    0505
*   TBR: DO;                                                       0505
TBR      DS    0H                                                  0506
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15)  */                  0506
*                                                                  0507
*   END;/* CMZMREG */                                              0507
*   GPR14P = CMZX9903;                                             0508
         LR    GPR14P,CMZX9903                                     0508
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15) RELEASE */           0509
*                                                                  0510
*   END;/* CMZMREG */                                              0510
*   END TBR;                                                       0511
*   END CPHTBLSC;                                                  0512
@EL00008 DS    0H                                                  0512
@EF00008 DS    0H                                                  0512
@ER00008 BR    @14                                                 0512
*/********************************************************************/
*/*                                                                  */
*/*      CPHVALCK: VALIDITY CHECK ROUTINE                            */
*/*                                                                  */
*/********************************************************************/
*                                                                  0513
*   CPHVALCK: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0513
CPHVALCK DS    0H                                                  0514
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0514
*    DO;                                                           0514
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15) RESTRICT */          0515
*                                                                  0516
*   END;/* CMZMREG */                                              0516
*   CMZX9910 = GPR14P;                                             0517
         LR    CMZX9910,GPR14P                                     0517
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15)  */                  0518
*                                                                  0519
*   END;/* CMZMREG */                                              0519
*   END ;                  /*@DM30483*/                            0520
*   CPHVCK01=GPR01P;           /* SAVE REG01                 @DM30483*/
         ST    GPR01P,CPHVCK01                                     0521
*   CPHVCK02=GPR02P;           /* SAVE REG02                 @DM30483*/
         ST    GPR02P,CPHVCK02                                     0522
*   CPHVALFG='00'X;            /* RESET ERROR INDICATORS*/         0523
         MVI   CPHVALFG,X'00'                                      0523
*   IF CPHVALBT(1:4)='0000'B   /*VAL CHECKING CALLED FOR*/         0524
*      THEN;                   /*NO*/                              0524
         TM    CPHVALBT,B'11110000'                                0524
         BZ    @RT00524                                            0524
*      ELSE DO;                /*YES*/                             0526
*         CPHVALPS=1;           /*INIT SUBPARAM STRING POINTER*/   0527
         MVC   CPHVALPS(4),@CF00048                                0527
*         IF CPHFUNFC='1'B   /*CK 1ST CHAR ALPHA*/                 0528
*            THEN DO;           /*YES*/                            0528
         TM    CPHFUNFC,B'00010000'                                0528
         BNO   @RF00528                                            0528
*                          /* TRT CHAR. TO CLASSIFY TYPE*/         0530
*               GPR02F=0;     /* INIT TRT CODE REGISTER TO ZERO*/  0530
         SLR   GPR02F,GPR02F                                       0530
*               TRT(CPHSPPTR->CPHSBYTE(1),CPHVTRTB);               0531
         L     @10,CPHSPPTR                                        0531
         TRT   CPHSBYTE(1,@10),CPHVTRTB                            0531
*               IF GPR02F=1    /*IS CHAR ALPHA*/                   0532
*                  THEN DO;             /*YES*/                    0532
         LA    @10,1                                               0532
         CR    GPR02F,@10                                          0532
         BNE   @RF00532                                            0532
*                     IF CPHFUNAN='1'B /*CK ALPHA NUMERIC*/        0534
*                        THEN                 /*YES*/              0534
         TM    CPHFUNAN,B'00100000'                                0534
         BNO   @RF00534                                            0534
*                           CPHVALPS=CPHVALPS+1;/*INCR CHAR PTR*/  0535
         AL    @10,CPHVALPS                                        0535
         ST    @10,CPHVALPS                                        0535
*                         ELSE   /*NOT CK ALPHA NUMERIC*/          0536
*                            CPHVALPS=CPHSPLEN+1; /*SET END*/      0536
         B     @RC00534                                            0536
@RF00534 LA    @10,1                                               0536
         AH    @10,CPHSPLEN                                        0536
         ST    @10,CPHVALPS                                        0536
*                  END;        /*END CHAR ALPHA*/                  0537
*                  ELSE        /*NOT ALPHA*/                       0538
*                     CPHVALFC='1'B;         /* SET ERROR INDICATOR*/
         B     @RC00532                                            0538
@RF00532 OI    CPHVALFC,B'00010000'                                0538
*            END;               /*END CK FIRST CHAR ALPHA*/        0539
*            ELSE;              /*NOT CK FIRST ALPHA*/             0540
@RF00528 DS    0H                                                  0541
*                             /*VAL CK ENTRY*/                     0541
*VALLOOP:                                                          0541
*       DO CPHVALPS=CPHVALPS TO CPHSPLEN WHILE(CPHVALFG='00'X);    0541
@RC00528 DS    0H                                                  0541
VALLOOP  L     @10,CPHVALPS                                        0541
         B     @DE00541                                            0541
@DL00541 CLI   CPHVALFG,X'00'                                      0541
         BNE   @DC00541                                            0541
*          /* TRT CHAR. AT CPHVALPS USING CPHVTRTB TO FIND TYPE   */
*         GPR02F=0;             /*INIT TRT CODE REG TO 0*/         0542
         SLR   GPR02F,GPR02F                                       0542
*         TRT(CPHSPPTR->CPHSBYTE(CPHVALPS),CPHVTRTB);              0543
         L     @10,CPHSPPTR                                        0543
         AL    @10,CPHVALPS                                        0543
         BCTR  @10,0                                               0543
         TRT   CPHSBYTE(1,@10),CPHVTRTB                            0543
*         IF GPR02F=1           /*IS CHAR ALPHA*/                  0544
*             THEN DO;          /*YES*/                            0544
         C     GPR02F,@CF00048                                     0544
         BNE   @RF00544                                            0544
*                IF CPHFUNNU='1'B /*CHECK NUMERIC*/                0546
*                   THEN                /*YES*/                    0546
         TM    CPHFUNNU,B'01000000'                                0546
         BNO   @RF00546                                            0546
*                      CPHVALNU='1'B;   /*SET ERROR FLG*/          0547
         OI    CPHVALNU,B'01000000'                                0547
*                    ELSE;          /*NOT CHECK NUMERIC*/          0548
@RF00546 DS    0H                                                  0549
*             END;                 /*END CHAR ALPHA*/              0549
*             ELSE DO;           /*CHAR NOT ALPHA*/                0550
         B     @RC00544                                            0550
@RF00544 DS    0H                                                  0551
*                IF GPR02F=2  /*IS CHAR NUMERIC*/                  0551
*                   THEN;       /*YES*/                            0551
         C     GPR02F,@CF00311                                     0551
         BE    @RT00551                                            0551
*                   ELSE        /*NO*/                             0553
*                      CPHVALAN='1'B; /*SET ERROR FLG*/            0553
         OI    CPHVALAN,B'00100000'                                0553
*             END;              /*END CHAR NOT ALPHA*/             0554
@RT00551 DS    0H                                                  0555
*       END VALLOOP;                                               0555
@RC00544 LA    @10,1                                               0555
         AL    @10,CPHVALPS                                        0555
         ST    @10,CPHVALPS                                        0555
@DE00541 CH    @10,CPHSPLEN                                        0555
         BNH   @DL00541                                            0555
@DC00541 DS    0H                                                  0556
*     END;                                                         0556
*   GPR01P=CPHVCK01;           /* RESTORE REG01              @DM30483*/
@RT00524 L     GPR01P,CPHVCK01                                     0557
*   GPR02P=CPHVCK02;           /* RESTORE REG02              @DM30483*/
         L     GPR02P,CPHVCK02                                     0558
*   /*CMZPEND*/                                                    0559
*   VALR: DO;                                                      0559
VALR     DS    0H                                                  0560
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15)  */                  0560
*                                                                  0561
*   END;/* CMZMREG */                                              0561
*   GPR14P = CMZX9910;                                             0562
         LR    GPR14P,CMZX9910                                     0562
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15) RELEASE */           0563
*                                                                  0564
*   END;/* CMZMREG */                                              0564
*   END VALR;                                                      0565
*   END CPHVALCK;                                                  0566
@EL00009 DS    0H                                                  0566
@EF00009 DS    0H                                                  0566
@ER00009 BR    @14                                                 0566
*/********************************************************************/
*/*                                                                  */
*/*       CPHSUBSC: SUBPARAMETER SCAN ROUTINE                        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0567
*   CPHSUBSC: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0567
CPHSUBSC DS    0H                                                  0568
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0568
*    DO;                                                           0568
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15) RESTRICT */          0569
*                                                                  0570
*   END;/* CMZMREG */                                              0570
*   CMZX9902 = GPR14P;                                             0571
         LR    CMZX9902,GPR14P                                     0571
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15)  */                  0572
*                                                                  0573
*   END;/* CMZMREG */                                              0573
*   END ;                  /*@DM30483*/                            0574
*   CPHSCN00=GPR00P;           /* SAVE REG00                 @DM30483*/
         ST    GPR00P,CPHSCN00                                     0575
*   CPHSCN02=GPR02P;           /* SAVE REG02                 @DM30483*/
         ST    GPR02P,CPHSCN02                                     0576
*                              /*  REG1= ADDR OF PARM STRING*/     0577
*   CPHTCHAR=0;                /*   SET CPHTCHAR = X'00'*/         0577
         MVI   CPHTCHAR,X'00'                                      0577
*                 /* RESET CPHENDSP, CPHSPLEN, CPHSBPAR, AND CPHSPPTR*/
*   CPHSPLEN=0;                                                    0578
         SLR   @10,@10                                             0578
         STH   @10,CPHSPLEN                                        0578
*   CPHSPPTR=0;                                                    0579
         ST    @10,CPHSPPTR                                        0579
*   CPHENDSP='0'B;                                                 0580
         NI    CPHENDSP,B'11110111'                                0580
*   CPHSBPAR=0;                                                    0581
         STH   @10,CPHSBPAR                                        0581
*   IF GPR01P->CPHSBYTE(1)=' '&CPHKWSCN='1'B /*BLNK IN SCAN*/      0582
*      THEN                  /*YES BLANK WHILE SCANNING*/          0582
         CLI   CPHSBYTE(GPR01P),C' '                               0582
         BNE   @RF00582                                            0582
         TM    CPHKWSCN,B'00100000'                                0582
         BNO   @RF00582                                            0582
*         CPHENDST='1'B;     /*SET STRING EXHAUSTED*/              0583
         OI    CPHENDST,B'00010000'                                0583
*      ELSE DO;              /*NOT STRING EXHAUSTED*/              0584
         B     @RC00582                                            0584
@RF00582 DS    0H                                                  0585
*SS1:                                                              0585
*         IF CPHKWSCN='1'B   /*ARE WE SCANNING A KWD*/             0585
*            THEN            /*YES*/                               0585
SS1      TM    CPHKWSCN,B'00100000'                                0585
         BNO   @RF00585                                            0585
*               CPHKWPTR=GPR01P; /*PUT STRING PTR IN WKPTR*/       0586
         ST    GPR01P,CPHKWPTR                                     0586
*            ELSE;               /*NOT KWD SCAN*/                  0587
@RF00585 DS    0H                                                  0588
*SS5:                                       /*DOWHILE NOT END OF SCAN*/
*         DO WHILE(CPHENDSP='0'B&CPHSYNER='0'B)×(CPHLSTSP='1'B &   0588
*             CPHSLIST='1'B&CPHSYNER='0'B);                        0588
SS5      B     @DE00588                                            0588
@DL00588 DS    0H                                                  0589
*            /*ICALL(CPHSBTRT)*/                                   0589
*             DO;                                                  0589
*            CALL CPHSBTRT;                                        0590
*                                                                  0590
         BAL   @14,CPHSBTRT                                        0590
*            END ;          /* TRT:SCAN TO NEXT DELIMITER*/        0591
*            CPHTCHAR=GPR02F;       /*SAVE CHAR CODE IN TCHAR*/    0592
         STC   GPR02F,CPHTCHAR                                     0592
*                  /* CALCULATE TABLE INDEX FROM CPHTCHAR & CPHLCHAR*/
*            CPHSCNPT=CPHSCNTB(CPHTCHAR+1,CPHLCHAR+1);             0593
         SLR   @10,@10                                             0593
         IC    @10,CPHTCHAR                                        0593
         MH    @10,@CH00080                                        0593
         SLR   @09,@09                                             0593
         IC    @09,CPHLCHAR                                        0593
         ALR   @10,@09                                             0593
         SLA   @10,2                                               0593
         L     @10,CPHSCNTB(@10)                                   0593
         ST    @10,CPHSCNPT                                        0593
*             /*ICALL(CPHSCNPT)FLOWS(CPHCSP01,CPHCSP02,CPHCSP03,CPHCSP0
*,CPHCSP05,CPHCSP06,CPHCSP07,CPHCSP08,CPHCSP13,CPHCSP09,CPHCSP10,CPHCSP
*2,CPHCSP14)*/                                                     0594
*              DO;                                                 0594
*             DCL CMZP0229 BASED ENTRY VALRG (CPHCSP01,CPHCSP02,CPHCSP0
*,CPHCSP04,CPHCSP05,CPHCSP06,CPHCSP07,CPHCSP08,CPHCSP13,CPHCSP09,CPHCSP
*0,CPHCSP12,CPHCSP14) ;                                            0595
*             CALL CPHSCNPT-> CMZP0229 ;                           0596
*                                                                  0596
         LR    @15,@10                                             0596
         BALR  @14,@15                                             0596
*             END ;  /* GO TO SUB-PROCESSOR*/                      0597
*            IF CPHSYNER='1'B×CPHTCHAR=6 /*SYNTAX ERR OR BLNK CHAR*/
*               THEN;                /*YES*/                       0598
         TM    CPHSYNER,B'00000001'                                0598
         BO    @RT00598                                            0598
         CLI   CPHTCHAR,6                                          0598
         BE    @RT00598                                            0598
*               ELSE DO;             /*NOT SYNTAX OR BLANK*/       0600
*                  CPHLCHAR=CPHTCHAR; /*PUT CURRENT  CHAR IN LAST CHAR*
         IC    @10,CPHTCHAR                                        0601
         STC   @10,CPHLCHAR                                        0601
*                  GPR01P=GPR01P+1;   /*INCREMENT STRING PTR*/     0602
         AL    GPR01P,@CF00048                                     0602
*                END;                 /*END NOT SYNTAX OR BLANK*/  0603
*         END SS5;                    /*END DO WHILE*/             0604
@RT00598 DS    0H                                                  0604
@DE00588 TM    CPHENDSP,B'00001001'                                0604
         BZ    @DL00588                                            0604
         TM    CPHLSTSP,B'00000110'                                0604
         BNO   @DC00588                                            0604
         TM    CPHSYNER,B'00000001'                                0604
         BZ    @DL00588                                            0604
@DC00588 DS    0H                                                  0605
*      END;                           /*END NOT STRING EXHAUSTED*/ 0605
*/*******************************************************************/
*/*                                                                 */
*/*      CPHSBTRT: TRANSLATE AND TEST ROUTINE                       */
*/*                                                                 */
*/*******************************************************************/
*                                                                  0606
*   CPHSBTRT: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0606
         B     @PB00011                                            0606
CPHSBTRT DS    0H                                                  0607
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0607
*    DO;                                                           0607
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15) RESTRICT */          0608
*                                                                  0609
*   END;/* CMZMREG */                                              0609
*   CMZX9911 = GPR14P;                                             0610
         LR    CMZX9911,GPR14P                                     0610
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15)  */                  0611
*                                                                  0612
*   END;/* CMZMREG */                                              0612
*   END ;                                                          0613
*   CPHCONT='1'B;               /* SET CONTINUE FLAG*/             0614
         OI    CPHCONT,B'01000000'                                 0614
*   CPHTRTSV=GPR01P;              /*    SAVE START PTR   */        0615
         ST    GPR01P,CPHTRTSV                                     0615
*   GPR03P=GPR01P;               /*  SET R3 = INPUT PARM STRING PTR*/
         LR    GPR03P,GPR01P                                       0616
*TR3:                                                              0617
*   DO WHILE(CPHCONT='1'B);       /* SCAN 256 BYTES FOR A DELIMITER*/
TR3      B     @DE00617                                            0617
@DL00617 DS    0H                                                  0618
*      GPR02F=0;                  /*CLEAR OUTPUT CODE REG*/        0618
         SLR   GPR02F,GPR02F                                       0618
*      TRT(GPR03P->CPHSBYTE(1:256),CPHTRTB);     /*TRANSLATE AND TEST*/
         TRT   CPHSBYTE(256,GPR03P),CPHTRTB                        0619
*                                    /* NOTE: DELIMITERS ARE  )(,= */
*                              /*QUOTE OR BLANK CODE IN REG2 AFTER TRT*
*       IF GPR02F^=0                  /*  DELIMITER FOUND */       0620
*          THEN                         /*YES*/                    0620
         LTR   GPR02F,GPR02F                                       0620
         BZ    @RF00620                                            0620
*             CPHCONT='0'B;            /*RESET CONTINUE FLAG*/     0621
         NI    CPHCONT,B'10111111'                                 0621
*          ELSE                        /*NO DELIMITER YET*/        0622
*             GPR03P=GPR03P+256;     /* PREPARE TO SCAN NEXT 256 BYTES*
         B     @RC00620                                            0622
@RF00620 AL    GPR03P,@CF00139                                     0622
*   END TR3;                          /*END DO WHILE*/             0623
@RC00620 DS    0H                                                  0623
@DE00617 TM    CPHCONT,B'01000000'                                 0623
         BO    @DL00617                                            0623
*                                      /* R1= DELIM ADDR*/         0624
*   GPR04P=GPR01P-CPHTRTSV;             /*SET R4 = LEN OF SUB PARM*/
         L     @10,CPHTRTSV                                        0624
         LR    GPR04P,GPR01P                                       0624
         SLR   GPR04P,@10                                          0624
*   GPR03P=CPHTRTSV;                     /* RESTORE START PTR*/    0625
         LR    GPR03P,@10                                          0625
*   IF GPR01P^=CPHTRTSV                  /*WAS DELIMITER FIRST CHAR*/
*      THEN DO;                          /*NO*/                    0626
         CR    GPR01P,@10                                          0626
         BE    @RF00626                                            0626
*         GPR02F=0;                      /*SET NON DILIMITER CODE*/
         SLR   GPR02F,GPR02F                                       0628
*         GPR01P=GPR01P-1;           /*DECREMENT STRING PTR*/      0629
         BCTR  GPR01P,0                                            0629
*      END;                           /*END NOT FIRST SCANNED*/    0630
*      ELSE;                          /*YES FIRST CHAR WAS DELIMITER*/
@RF00626 DS    0H                                                  0632
*   /*CMZPEND*/                                                    0632
*   TR5: DO;                                                       0632
TR5      DS    0H                                                  0633
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15)  */                  0633
*                                                                  0634
*   END;/* CMZMREG */                                              0634
*   GPR14P = CMZX9911;                                             0635
         LR    GPR14P,CMZX9911                                     0635
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15) RELEASE */           0636
*                                                                  0637
*   END;/* CMZMREG */                                              0637
*   END TR5;                                                       0638
*   END CPHSBTRT;                                                  0639
@EL00011 DS    0H                                                  0639
@EF00011 DS    0H                                                  0639
@ER00011 BR    @14                                                 0639
*/********************************************************************/
*/*                                                                  */
*/*        CPHCSP01: STORE SUBPARM PTR & LENGTH                      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0640
*   CPHCSP01: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0640
CPHCSP01 DS    0H                                                  0641
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0641
*    DO;                                                           0641
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15) RESTRICT */          0642
*                                                                  0643
*   END;/* CMZMREG */                                              0643
*   CMZX9912 = GPR14P;                                             0644
         LR    CMZX9912,GPR14P                                     0644
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15)  */                  0645
*                                                                  0646
*   END;/* CMZMREG */                                              0646
*   END ;                                                          0647
*   IF CPHSPPTR^=0           /* START SUBPARM PTR ALREADY SET*/    0648
*       THEN;                /* YES */                             0648
         L     @10,CPHSPPTR                                        0648
         LTR   @10,@10                                             0648
         BNZ   @RT00648                                            0648
*       ELSE                 /*NO*/                                0650
*          CPHSPPTR=GPR03P;  /*SAVE PARM STRING PTR*/              0650
         ST    GPR03P,CPHSPPTR                                     0650
*   CPHSPLEN=GPR04P+CPHSPLEN;  /*ADD LENGTH OF SUB PARM */         0651
@RT00648 LR    @10,GPR04P                                          0651
         AH    @10,CPHSPLEN                                        0651
         STH   @10,CPHSPLEN                                        0651
*    /*CMZPEND*/                                                   0652
*     DO;                                                          0652
*    DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15)  */                 0653
*                                                                  0654
*    END;/* CMZMREG */                                             0654
*    GPR14P = CMZX9912;                                            0655
         LR    GPR14P,CMZX9912                                     0655
*    DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15) RELEASE */          0656
*                                                                  0657
*    END;/* CMZMREG */                                             0657
*    END ;                                                         0658
*    END CPHCSP01;                                                 0659
@EL00012 DS    0H                                                  0659
@EF00012 DS    0H                                                  0659
@ER00012 BR    @14                                                 0659
*/********************************************************************/
*/*                                                                  */
*/*        CPHCSP02: END OF KEYWORD A                                */
*/*                                                                  */
*/********************************************************************/
*                                                                  0660
*   CPHCSP02: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0660
CPHCSP02 DS    0H                                                  0661
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0661
*    DO;                                                           0661
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15) RESTRICT */          0662
*                                                                  0663
*   END;/* CMZMREG */                                              0663
*   CMZX9913 = GPR14P;                                             0664
         LR    CMZX9913,GPR14P                                     0664
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15)  */                  0665
*                                                                  0666
*   END;/* CMZMREG */                                              0666
*   END ;                                                          0667
*   IF CPHKWSCN='1'B                  /*KWD SCAN ON*/              0668
*      THEN DO;                       /*YES */                     0668
         TM    CPHKWSCN,B'00100000'                                0668
         BNO   @RF00668                                            0668
*         CPHKWLEN=CPHSPLEN;          /*SET KWD LEN = SUB PARM LEN*/
         LH    @10,CPHSPLEN                                        0670
         STH   @10,CPHKWLEN                                        0670
*         CPHKWSCN='0'B;              /*   RESET KWD SCAN FLAG*/   0671
*         CPHENDSP='1'B;               /*    SET END OF SUBPARM*/  0672
         OI    CPHENDSP,B'00001000'                                0672
         NI    CPHKWSCN,B'11011111'                                0672
*      END;                            /*END KWD SCAN*/            0673
*      ELSE DO;                        /*NOT KWD SCAN*/            0674
         B     @RC00668                                            0674
@RF00668 DS    0H                                                  0675
*P2A:                                                              0675
*         IF CPHPARCT=0                /*BALANCED PARENS*/         0675
*            THEN                      /* YES */                   0675
P2A      LH    @10,CPHPARCT                                        0675
         LTR   @10,@10                                             0675
         BNZ   @RF00675                                            0675
*               CPHSYNER='1'B;         /*SET SYNTAX ERROR*/        0676
         OI    CPHSYNER,B'00000001'                                0676
*            ELSE                      /*NOT BALANCED PARENS*/     0677
*               CPHSPLEN=CPHSPLEN+1;   /*UP SUB PARM LEN BY 1*/    0677
         B     @RC00675                                            0677
@RF00675 LH    @10,CPHSPLEN                                        0677
         LA    @10,1(,@10)                                         0677
         STH   @10,CPHSPLEN                                        0677
*      END;                            /*END NOT KWD SCAN*/        0678
@RC00675 DS    0H                                                  0679
*   /*CMZPEND*/                                                    0679
*   P2C: DO;                                                       0679
@RC00668 DS    0H                                                  0679
P2C      DS    0H                                                  0680
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15)  */                  0680
*                                                                  0681
*   END;/* CMZMREG */                                              0681
*   GPR14P = CMZX9913;                                             0682
         LR    GPR14P,CMZX9913                                     0682
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15) RELEASE */           0683
*                                                                  0684
*   END;/* CMZMREG */                                              0684
*   END P2C;                                                       0685
*   END CPHCSP02;                                                  0686
@EL00013 DS    0H                                                  0686
@EF00013 DS    0H                                                  0686
@ER00013 BR    @14                                                 0686
*/********************************************************************/
*/*                                                                  */
*/*         CPHCSP03: CHECK FOR LAST SUBPARM                         */
*/*                                                                  */
*/********************************************************************/
*                                                                  0687
*   CPHCSP03: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0687
CPHCSP03 DS    0H                                                  0688
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0688
*    DO;                                                           0688
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15) RESTRICT */          0689
*                                                                  0690
*   END;/* CMZMREG */                                              0690
*   CMZX9914 = GPR14P;                                             0691
         LR    CMZX9914,GPR14P                                     0691
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15)  */                  0692
*                                                                  0693
*   END;/* CMZMREG */                                              0693
*   END ;                                                          0694
*    /*ICALL(CPHCSP13)*/                                           0695
*     DO;                                                          0695
*    CALL CPHCSP13;                                                0696
*                                                                  0696
         BAL   @14,CPHCSP13                                        0696
*    END ;                 /*CHECK FOR END OF SUBPARM*/            0697
*   IF CPHPARCT=0                     /*BALANCED PARENS*/          0698
*      THEN                           /* YES */                    0698
         LH    @10,CPHPARCT                                        0698
         LTR   @10,@10                                             0698
         BNZ   @RF00698                                            0698
*         CPHLSTSP='1'B;              /*SET LAST SUB PARM */       0699
         OI    CPHLSTSP,B'00000100'                                0699
*      ELSE;                          /*NOT LAST SUB PARM*/        0700
@RF00698 DS    0H                                                  0701
*   /*CMZPEND*/                                                    0701
*   P3A: DO;                                                       0701
P3A      DS    0H                                                  0702
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15)  */                  0702
*                                                                  0703
*   END;/* CMZMREG */                                              0703
*   GPR14P = CMZX9914;                                             0704
         LR    GPR14P,CMZX9914                                     0704
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15) RELEASE */           0705
*                                                                  0706
*   END;/* CMZMREG */                                              0706
*   END P3A;                                                       0707
*   END CPHCSP03;                                                  0708
@EL00014 DS    0H                                                  0708
@EF00014 DS    0H                                                  0708
@ER00014 BR    @14                                                 0708
*/********************************************************************/
*/*                                                                  */
*/*     CPHCSP04: END OF SUBPARM A                                   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0709
*   CPHCSP04: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0709
CPHCSP04 DS    0H                                                  0710
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0710
*    DO;                                                           0710
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15) RESTRICT */          0711
*                                                                  0712
*   END;/* CMZMREG */                                              0712
*   CMZX9915 = GPR14P;                                             0713
         LR    CMZX9915,GPR14P                                     0713
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15)  */                  0714
*                                                                  0715
*   END;/* CMZMREG */                                              0715
*   END ;                                                          0716
*   IF CPHPARCT=0               /*BALANCED PARENS*/                0717
*      THEN                      /* YES */                         0717
         LH    @10,CPHPARCT                                        0717
         LTR   @10,@10                                             0717
         BNZ   @RF00717                                            0717
*         CPHSYNER='1'B;         /*SET SYNTAX ERROR*/              0718
         OI    CPHSYNER,B'00000001'                                0718
*      ELSE DO;                  /*NOT BALANCED PARENS*/           0719
         B     @RC00717                                            0719
@RF00717 DS    0H                                                  0720
*          /*ICALL(CPHCSP13)*/                                     0720
*           DO;                                                    0720
*          CALL CPHCSP13;                                          0721
*                                                                  0721
         BAL   @14,CPHCSP13                                        0721
*          END ;       /*  CHECK FOR END OF SUBPARM*/              0722
*         /*ICALL(CPHCSP01)*/                                      0723
*         P4A: DO;                                                 0723
P4A      DS    0H                                                  0724
*         CALL CPHCSP01;                                           0724
*                                                                  0724
         BAL   @14,CPHCSP01                                        0724
*         END P4A;            /*  STORE PTR AND LENGTH*/           0725
*      END;                        /*END NOT BALANCED PARENS*/     0726
*   /*CMZPEND*/                                                    0727
*   P4B: DO;                                                       0727
@RC00717 DS    0H                                                  0727
P4B      DS    0H                                                  0728
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15)  */                  0728
*                                                                  0729
*   END;/* CMZMREG */                                              0729
*   GPR14P = CMZX9915;                                             0730
         LR    GPR14P,CMZX9915                                     0730
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15) RELEASE */           0731
*                                                                  0732
*   END;/* CMZMREG */                                              0732
*   END P4B;                                                       0733
*   END CPHCSP04;                                                  0734
@EL00015 DS    0H                                                  0734
@EF00015 DS    0H                                                  0734
@ER00015 BR    @14                                                 0734
*/********************************************************************/
*/*                                                                  */
*/*      CPHCSP05: END OF SUBPARM LIST                               */
*/*                                                                  */
*/********************************************************************/
*                                                                  0735
*   CPHCSP05: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0735
CPHCSP05 DS    0H                                                  0736
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0736
*    DO;                                                           0736
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15) RESTRICT */          0737
*                                                                  0738
*   END;/* CMZMREG */                                              0738
*   CMZX9916 = GPR14P;                                             0739
         LR    CMZX9916,GPR14P                                     0739
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15)  */                  0740
*                                                                  0741
*   END;/* CMZMREG */                                              0741
*   END ;                                                          0742
*   IF CPHPARCT=0                 /*PARENS. BALANCED*/             0743
*      THEN                           /* YES */                    0743
         LH    @10,CPHPARCT                                        0743
         LTR   @10,@10                                             0743
         BNZ   @RF00743                                            0743
*         CPHSLIST='0'B;               /* RESET SUBPARM. LIST FLAG*/
         NI    CPHSLIST,B'11111101'                                0744
*      ELSE;                           /* NO */                    0745
@RF00743 DS    0H                                                  0746
*   /*CMZPEND*/                                                    0746
*   P5A: DO;                                                       0746
P5A      DS    0H                                                  0747
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15)  */                  0747
*                                                                  0748
*   END;/* CMZMREG */                                              0748
*   GPR14P = CMZX9916;                                             0749
         LR    GPR14P,CMZX9916                                     0749
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15) RELEASE */           0750
*                                                                  0751
*   END;/* CMZMREG */                                              0751
*   END P5A;                                                       0752
*   END CPHCSP05;                                                  0753
@EL00016 DS    0H                                                  0753
@EF00016 DS    0H                                                  0753
@ER00016 BR    @14                                                 0753
*/********************************************************************/
*/*                                                                  */
*/*         CPHCSP06: INCREASE PAREN COUNTER                         */
*/*                                                                  */
*/********************************************************************/
*                                                                  0754
*   CPHCSP06: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0754
CPHCSP06 DS    0H                                                  0755
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0755
*    DO;                                                           0755
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15) RESTRICT */          0756
*                                                                  0757
*   END;/* CMZMREG */                                              0757
*   CMZX9917 = GPR14P;                                             0758
         LR    CMZX9917,GPR14P                                     0758
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15)  */                  0759
*                                                                  0760
*   END;/* CMZMREG */                                              0760
*   END ;                                                          0761
*   IF CPHPARCT>0&CPHSBPAR=0 /*PAREN CNT GT 0 AND SUB PAREN CNT 0*/
*      THEN DO;               /* YES */                            0762
         LH    @10,CPHPARCT                                        0762
         SLR   @09,@09                                             0762
         CR    @10,@09                                             0762
         BNH   @RF00762                                            0762
         CH    @09,CPHSBPAR                                        0762
         BNE   @RF00762                                            0762
*         CPHSBPAR=CPHPARCT;  /*SET SUBPARM START PARENS. COUNT*/  0764
         STH   @10,CPHSBPAR                                        0764
*         CPHSPPTR=GPR01P;       /* FLAG LEFT PARENTHESIS AS START */
         ST    GPR01P,CPHSPPTR                                     0765
*                                /*    OF SUBPARM                    */
*      END;                   /*END PAREN CNT GT 0*/               0766
*      ELSE;                  /*PAREN CNT NOT GT 0 */              0767
@RF00762 DS    0H                                                  0768
*   CPHPARCT=CPHPARCT+1;       /* INCREASE PAREN COUNTER BY 1*/    0768
         LH    @10,CPHPARCT                                        0768
         LA    @10,1(,@10)                                         0768
         STH   @10,CPHPARCT                                        0768
*   CPHSLIST='1'B;             /*   SET SUBPARM LIST FLAG*/        0769
         OI    CPHSLIST,B'00000010'                                0769
*    /*CMZPEND*/                                                   0770
*     DO;                                                          0770
*    DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15)  */                 0771
*                                                                  0772
*    END;/* CMZMREG */                                             0772
*    GPR14P = CMZX9917;                                            0773
         LR    GPR14P,CMZX9917                                     0773
*    DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15) RELEASE */          0774
*                                                                  0775
*    END;/* CMZMREG */                                             0775
*    END ;                                                         0776
*    END CPHCSP06;                                                 0777
@EL00017 DS    0H                                                  0777
@EF00017 DS    0H                                                  0777
@ER00017 BR    @14                                                 0777
*/********************************************************************/
*/*                                                                  */
*/*         CPHCSP07: END OF SUBPARM C                               */
*/*                                                                  */
*/********************************************************************/
*                                                                  0778
*   CPHCSP07: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0778
CPHCSP07 DS    0H                                                  0779
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0779
*    DO;                                                           0779
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15) RESTRICT */          0780
*                                                                  0781
*   END;/* CMZMREG */                                              0781
*   CMZX9918 = GPR14P;                                             0782
         LR    CMZX9918,GPR14P                                     0782
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15)  */                  0783
*                                                                  0784
*   END;/* CMZMREG */                                              0784
*   END ;                                                          0785
*    /*ICALL(CPHCSP08)*/                                           0786
*     DO;                                                          0786
*    CALL CPHCSP08;                                                0787
*                                                                  0787
         BAL   @14,CPHCSP08                                        0787
*    END ;                /* CHECK FOR BALANCED PARENS*/           0788
*   IF CPHSYNER='1'B                 /*SYNTAX ERROR*/              0789
*      THEN ;                        /* YES */                     0789
         TM    CPHSYNER,B'00000001'                                0789
         BO    @RT00789                                            0789
*      ELSE                          /* NO */                      0791
*         /*ICALL(CPHCSP03)*/                                      0791
*          DO;                                                     0791
*         CALL CPHCSP03;                                           0792
*                                                                  0792
         BAL   @14,CPHCSP03                                        0792
*         END ;           /*   CHECK FOR LAST SUB-PARM*/           0793
*   /*CMZPEND*/                                                    0794
*   P7A: DO;                                                       0794
@RT00789 DS    0H                                                  0794
P7A      DS    0H                                                  0795
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15)  */                  0795
*                                                                  0796
*   END;/* CMZMREG */                                              0796
*   GPR14P = CMZX9918;                                             0797
         LR    GPR14P,CMZX9918                                     0797
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15) RELEASE */           0798
*                                                                  0799
*   END;/* CMZMREG */                                              0799
*   END P7A;                                                       0800
*   END CPHCSP07;                                                  0801
@EL00018 DS    0H                                                  0801
@EF00018 DS    0H                                                  0801
@ER00018 BR    @14                                                 0801
*/********************************************************************/
*/*                                                                  */
*/*          CPHCSP08: DECREASE PAREN COUNTER                        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0802
*   CPHCSP08: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0802
CPHCSP08 DS    0H                                                  0803
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0803
*    DO;                                                           0803
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15) RESTRICT */          0804
*                                                                  0805
*   END;/* CMZMREG */                                              0805
*   CMZX9919 = GPR14P;                                             0806
         LR    CMZX9919,GPR14P                                     0806
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15)  */                  0807
*                                                                  0808
*   END;/* CMZMREG */                                              0808
*   END ;                                                          0809
*   CPHPARCT=CPHPARCT-1;      /*DECREMENT PAREN CNT*/              0810
         LH    @10,CPHPARCT                                        0810
         BCTR  @10,0                                               0810
         STH   @10,CPHPARCT                                        0810
*   IF CPHPARCT<0            /*CPHPARCT LESS THAN 0*/              0811
*      THEN                   /* YES */                            0811
         LTR   @10,@10                                             0811
         BNM   @RF00811                                            0811
*         CPHSYNER='1'B;      /*SET SYNTAX ERROR*/                 0812
         OI    CPHSYNER,B'00000001'                                0812
*      ELSE;                  /* NO */                             0813
@RF00811 DS    0H                                                  0814
*   IF CPHSBPAR=0             /*SUB PAREN CNT 0*/                  0814
*      THEN DO;               /*YES */                             0814
         SLR   @10,@10                                             0814
         CH    @10,CPHSBPAR                                        0814
         BNE   @RF00814                                            0814
*         CPHENDSP='1'B;        /*SET END OF SUBPARM */            0816
         OI    CPHENDSP,B'00001000'                                0816
*         IF CPHSPPTR=0       /*SUB PARM PTR 0 */                  0817
*            THEN;            /*YES */                             0817
         C     @10,CPHSPPTR                                        0817
         BE    @RT00817                                            0817
*            ELSE             /* NO */                             0819
*               CPHSPLEN=GPR01P-CPHSPPTR;  /*SET TOTAL SUBPARM LENGTH*/
         LR    @10,GPR01P                                          0819
         SL    @10,CPHSPPTR                                        0819
         STH   @10,CPHSPLEN                                        0819
*      END;                   /*END SUB PAREN CNT 0*/              0820
*      ELSE DO;               /*SUB PAREN CNT NOT 0*/              0821
         B     @RC00814                                            0821
@RF00814 DS    0H                                                  0822
*         IF CPHSBPAR=CPHPARCT    /*SUBPARM START COUNT EQUAL CURRENT*/
*            THEN DO;                                              0822
         CLC   CPHSBPAR(2),CPHPARCT                                0822
         BNE   @RF00822                                            0822
*               CPHSBPAR=0;     /*SET SUB APREN CNT TO 0*/         0824
         SLR   @10,@10                                             0824
         STH   @10,CPHSBPAR                                        0824
*               CPHENDSP='1'B;    /* SET END OF SUBPARM*/          0825
         OI    CPHENDSP,B'00001000'                                0825
*               CPHSPLEN=GPR01P-CPHSPPTR+1; /*SET TOTAL SUBPARM LENGTH*
         LR    @10,GPR01P                                          0826
         SL    @10,CPHSPPTR                                        0826
         LA    @10,1(,@10)                                         0826
         STH   @10,CPHSPLEN                                        0826
*            END;                 /*END SUB PARM STRT =CURRENT*/   0827
*            ELSE;                /*NOT  EQUAL*/                   0828
@RF00822 DS    0H                                                  0829
*      END;                    /*END SUB PAREN CNT NOT 0*/         0829
*   /*CMZPEND*/                                                    0830
*   P8A: DO;                                                       0830
@RC00814 DS    0H                                                  0830
P8A      DS    0H                                                  0831
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15)  */                  0831
*                                                                  0832
*   END;/* CMZMREG */                                              0832
*   GPR14P = CMZX9919;                                             0833
         LR    GPR14P,CMZX9919                                     0833
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15) RELEASE */           0834
*                                                                  0835
*   END;/* CMZMREG */                                              0835
*   END P8A;                                                       0836
*   END CPHCSP08;                                                  0837
@EL00019 DS    0H                                                  0837
@EF00019 DS    0H                                                  0837
@ER00019 BR    @14                                                 0837
*/********************************************************************/
*/*                                                                  */
*/*         CPHCSP09: SCAN TO NEXT QUOTE                             */
*/*                                                                  */
*/********************************************************************/
*                                                                  0838
*   CPHCSP09: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0838
CPHCSP09 DS    0H                                                  0839
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0839
*    DO;                                                           0839
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15) RESTRICT */          0840
*                                                                  0841
*   END;/* CMZMREG */                                              0841
*   CMZX9921 = GPR14P;                                             0842
         LR    CMZX9921,GPR14P                                     0842
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15)  */                  0843
*                                                                  0844
*   END;/* CMZMREG */                                              0844
*   END ;                                                          0845
*   GPR03P=GPR03P+1;          /* INCREASE PARM STRING PTR BY 1*/   0846
         AL    GPR03P,@CF00048                                     0846
*   CPHSPPTR=GPR03P;             /*   STORE IN CPHSPPTR*/          0847
         ST    GPR03P,CPHSPPTR                                     0847
*   GPR02F=0;                       /* INITIALIZE TRT CODE REGISTER  */
         SLR   GPR02F,GPR02F                                       0848
*   DO WHILE GPR02F^=5;            /*SCAN FOR QUOTE*/              0849
         B     @DE00849                                            0849
@DL00849 DS    0H                                                  0850
*     /*ICALL(CPHSBTRT)*/                                          0850
*     P9A: DO;                                                     0850
P9A      DS    0H                                                  0851
*     CALL CPHSBTRT;                                               0851
*                                                                  0851
         BAL   @14,CPHSBTRT                                        0851
*     END P9A;            /*   TRT:SCAN TO NEXT DELIMITER*/        0852
*   END;                            /*END DO WHILE*/               0853
@DE00849 C     GPR02F,@CF00109                                     0853
         BNE   @DL00849                                            0853
*   CPHSPLEN=GPR01P-CPHSPPTR;      /*SAVE SUB PARM LENGTH*/        0854
         LR    @10,GPR01P                                          0854
         SL    @10,CPHSPPTR                                        0854
         STH   @10,CPHSPLEN                                        0854
*   CPHTCHAR=5;                   /*SET TCHAR = QUOTE CODE*/       0855
         MVI   CPHTCHAR,X'05'                                      0855
*   /*CMZPEND*/                                                    0856
*   P9B: DO;                                                       0856
P9B      DS    0H                                                  0857
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15)  */                  0857
*                                                                  0858
*   END;/* CMZMREG */                                              0858
*   GPR14P = CMZX9921;                                             0859
         LR    GPR14P,CMZX9921                                     0859
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15) RELEASE */           0860
*                                                                  0861
*   END;/* CMZMREG */                                              0861
*   END P9B;                                                       0862
*   END CPHCSP09;                                                  0863
@EL00020 DS    0H                                                  0863
@EF00020 DS    0H                                                  0863
@ER00020 BR    @14                                                 0863
*/********************************************************************/
*/*                                                                  */
*/*       CPHCSP10: END OF KEYWORD B OR SUBPARM                      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0864
*   CPHCSP10: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0864
CPHCSP10 DS    0H                                                  0865
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0865
*    DO;                                                           0865
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15) RESTRICT */          0866
*                                                                  0867
*   END;/* CMZMREG */                                              0867
*   CMZX9922 = GPR14P;                                             0868
         LR    CMZX9922,GPR14P                                     0868
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15)  */                  0869
*                                                                  0870
*   END;/* CMZMREG */                                              0870
*   END ;                                                          0871
*    /*ICALL(CPHCSP03)*/                                           0872
*     DO;                                                          0872
*    CALL CPHCSP03;                                                0873
*                                                                  0873
         BAL   @14,CPHCSP03                                        0873
*    END ;              /* CHECK FOR LAST SUBPARM */               0874
*   IF CPHLSTSP='1'B               /*LAST SUB PARM*/               0875
*      THEN DO;                    /* YES */                       0875
         TM    CPHLSTSP,B'00000100'                                0875
         BNO   @RF00875                                            0875
*         CPHENDSP='1'B;            /*   SET END OF SUBPARM */     0877
*         CPHKWSCN='0'B;            /*    RESET KWD SCAN FLAG*/    0878
         OI    CPHENDSP,B'00001000'                                0878
         NI    CPHKWSCN,B'11011111'                                0878
*         CPHKWLEN=CPHSPLEN;        /*SET KWD LENGTH*/             0879
         LH    @10,CPHSPLEN                                        0879
         STH   @10,CPHKWLEN                                        0879
*      END;                         /*END LAST SUB PARM*/          0880
*      ELSE DO;                     /*NOT LAST SUB PARM*/          0881
         B     @RC00875                                            0881
@RF00875 DS    0H                                                  0882
*         IF CPHKWSCN='1'B × CPHTCHAR=6 /*IN KWD SCAN OR BLAKN CHAR*/
*            THEN                 /* YES */                        0882
         TM    CPHKWSCN,B'00100000'                                0882
         BO    @RT00882                                            0882
         CLI   CPHTCHAR,6                                          0882
         BNE   @RF00882                                            0882
@RT00882 DS    0H                                                  0883
*               CPHSYNER='1'B;    /*SET SYNTAX ERROR*/             0883
         OI    CPHSYNER,B'00000001'                                0883
*            ELSE;                /*NOT KWD SCAN MODE*/            0884
@RF00882 DS    0H                                                  0885
*      END;                        /*END NOT LAST SUB PARM*/       0885
*   /*CMZPEND*/                                                    0886
*   P10B: DO;                                                      0886
@RC00875 DS    0H                                                  0886
P10B     DS    0H                                                  0887
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15)  */                  0887
*                                                                  0888
*   END;/* CMZMREG */                                              0888
*   GPR14P = CMZX9922;                                             0889
         LR    GPR14P,CMZX9922                                     0889
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15) RELEASE */           0890
*                                                                  0891
*   END;/* CMZMREG */                                              0891
*   END P10B;                                                      0892
*   END CPHCSP10;                                                  0893
@EL00021 DS    0H                                                  0893
@EF00021 DS    0H                                                  0893
@ER00021 BR    @14                                                 0893
*/********************************************************************/
*/*                                                                  */
*/*          CPHCSP12: SYNTAX ERROR                                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0894
*   CPHCSP12: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0894
CPHCSP12 DS    0H                                                  0895
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0895
*    DO;                                                           0895
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15) RESTRICT */          0896
*                                                                  0897
*   END;/* CMZMREG */                                              0897
*   CMZX9923 = GPR14P;                                             0898
         LR    CMZX9923,GPR14P                                     0898
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15)  */                  0899
*                                                                  0900
*   END;/* CMZMREG */                                              0900
*   END ;                                                          0901
*   CPHSYNER='1'B;                       /*SET SYNTAX ERROR FLAG*/ 0902
         OI    CPHSYNER,B'00000001'                                0902
*    /*CMZPEND*/                                                   0903
*     DO;                                                          0903
*    DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15)  */                 0904
*                                                                  0905
*    END;/* CMZMREG */                                             0905
*    GPR14P = CMZX9923;                                            0906
         LR    GPR14P,CMZX9923                                     0906
*    DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15) RELEASE */          0907
*                                                                  0908
*    END;/* CMZMREG */                                             0908
*    END ;                                                         0909
*    END CPHCSP12;                                                 0910
@EL00022 DS    0H                                                  0910
@EF00022 DS    0H                                                  0910
@ER00022 BR    @14                                                 0910
*/********************************************************************/
*/*                                                                  */
*/*           CPHCSP13: CHECK FOR END OF SUBPARM                     */
*/*                                                                  */
*/********************************************************************/
*                                                                  0911
*   CPHCSP13: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0911
CPHCSP13 DS    0H                                                  0912
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0912
*    DO;                                                           0912
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15) RESTRICT */          0913
*                                                                  0914
*   END;/* CMZMREG */                                              0914
*   CMZX9920 = GPR14P;                                             0915
         ST    GPR14P,CMZX9920                                     0915
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15)  */                  0916
*                                                                  0917
*   END;/* CMZMREG */                                              0917
*   END ;                                                          0918
*   IF CPHSBPAR=0                   /*IN NESTED SUB PARM*/         0919
*      THEN                          /* NO */                      0919
         LH    @10,CPHSBPAR                                        0919
         LTR   @10,@10                                             0919
         BNZ   @RF00919                                            0919
*         CPHENDSP='1'B;             /*SET END OF SUBPARM*/        0920
         OI    CPHENDSP,B'00001000'                                0920
*      ELSE;                         /*IN NESTED SUB PARM*/        0921
@RF00919 DS    0H                                                  0922
*   /*CMZPEND*/                                                    0922
*   P13A: DO;                                                      0922
P13A     DS    0H                                                  0923
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15)  */                  0923
*                                                                  0924
*   END;/* CMZMREG */                                              0924
*   GPR14P = CMZX9920;                                             0925
         L     GPR14P,CMZX9920                                     0925
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15) RELEASE */           0926
*                                                                  0927
*   END;/* CMZMREG */                                              0927
*   END P13A;                                                      0928
*   END CPHCSP13;                                                  0929
@EL00023 DS    0H                                                  0929
@EF00023 DS    0H                                                  0929
@ER00023 BR    @14                                                 0929
*/********************************************************************/
*/*                                                                  */
*/*        CPHCSP14: END OF LAST SUBPARM LIST                        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0930
*   CPHCSP14: PROC OPTIONS(DONTSAVE,NOSAVEAREA) ;                  0930
CPHCSP14 DS    0H                                                  0931
*   /*CMZPROC OPTIONS(DONTSAVE,NOSAVEAREA)*/                       0931
*    DO;                                                           0931
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15) RESTRICT */          0932
*                                                                  0933
*   END;/* CMZMREG */                                              0933
*   CMZX9924 = GPR14P;                                             0934
         LR    CMZX9924,GPR14P                                     0934
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15)  */                  0935
*                                                                  0936
*   END;/* CMZMREG */                                              0936
*   END ;                                                          0937
*   CPHSLIST='0'B;                   /*  RESET SUBPARM LIST FLAG */
         NI    CPHSLIST,B'11111101'                                0938
*    /*ICALL(CPHCSP03)*/                                           0939
*     DO;                                                          0939
*    CALL CPHCSP03;                                                0940
*                                                                  0940
         BAL   @14,CPHCSP03                                        0940
*    END ;                 /*  CHECK FOR END OF SUBPARMS*/         0941
*   IF CPHPARCT=0                  /*   BALANCED PARENS.*/         0942
*      THEN;                       /* YES */                       0942
         LH    @10,CPHPARCT                                        0942
         LTR   @10,@10                                             0942
         BZ    @RT00942                                            0942
*      ELSE                         /*NOT BALANCED PARENS*/        0944
*         CPHSYNER='1'B;             /* SET SYNTAX ERROR FLAG*/    0944
         OI    CPHSYNER,B'00000001'                                0944
*   /*CMZPEND*/                                                    0945
*   P14A: DO;                                                      0945
@RT00942 DS    0H                                                  0945
P14A     DS    0H                                                  0946
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15)  */                  0946
*                                                                  0947
*   END;/* CMZMREG */                                              0947
*   GPR14P = CMZX9924;                                             0948
         LR    GPR14P,CMZX9924                                     0948
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15) RELEASE */           0949
*                                                                  0950
*   END;/* CMZMREG */                                              0950
*   END P14A;                                                      0951
*   END CPHCSP14;                                                  0952
@EL00024 DS    0H                                                  0952
@EF00024 DS    0H                                                  0952
@ER00024 BR    @14                                                 0952
@PB00024 DS    0H                                                  0953
*   GPR00P=CPHSCN00;           /* RESTORE REG00              @DM30483*/
         L     GPR00P,CPHSCN00                                     0953
*   GPR02P=CPHSCN02;           /* RESTORE REG02              @DM30483*/
         L     GPR02P,CPHSCN02                                     0954
*   /*CMZPEND*/                                                    0955
*    DO;                                                           0955
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15)  */                  0956
*                                                                  0957
*   END;/* CMZMREG */                                              0957
*   GPR14P = CMZX9902;                                             0958
         LR    GPR14P,CMZX9902                                     0958
*   DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15) RELEASE */           0959
*                                                                  0960
*   END;/* CMZMREG */                                              0960
*   END ;                                                          0961
*   END CPHSUBSC;                                                  0962
*                                                                  0962
@EL00010 DS    0H                                                  0962
@EF00010 DS    0H                                                  0962
@ER00010 BR    @14                                                 0962
@PB00010 DS    0H                                                  0963
* DO; /* TPEPILOG   */                                             0963
*                                                                  0964
* GEN (PRINT OFF);                                                 0964
*                                                                  0964
         PRINT OFF
* DO;                                                              0965
* DCL GPR00F FIXED(31) REG(00),GPR00P PTR(31) REG(00),GPR01F FIXED(31)
*EG(01),GPR01P PTR(31) REG(01),GPR02F FIXED(31) REG(02),GPR02P PTR(31)
*EG(02),GPR03F FIXED(31) REG(03),GPR03P PTR(31) REG(03),GPR04F FIXED(31
* REG(04),GPR04P PTR(31) REG(04),GPR05F FIXED(31) REG(05),GPR05P PTR(31
* REG(05),GPR06F FIXED(31) REG(06),GPR06P PTR(31) REG(06),GPR07F FIXED(
*1) REG(07),GPR07P PTR(31) REG(07),GPR08F FIXED(31) REG(08),GPR08P PTR(
*1) REG(08),GPR09F FIXED(31) REG(09),GPR09P PTR(31) REG(09),GPR10F FIXE
*(31) REG(10),GPR10P PTR(31) REG(10),GPR11F FIXED(31) REG(11),GPR11P PT
*(31) REG(11),GPR12F FIXED(31) REG(12),GPR12P PTR(31) REG(12),GPR13F FI
*ED(31) REG(13),GPR13P PTR(31) REG(13),GPR14F FIXED(31) REG(14),GPR14P
*TR(31) REG(14),GPR15F FIXED(31) REG(15),GPR15P PTR(31) REG(15);   0966
* END;                                                             0967
*                                                                  0968
* GEN (PRINT ON);                                                  0968
         PRINT ON
* END;/* TPEPILOG */                                               0969
* DO; /* ATDSPLY   */                                              0970
*                                                                  0971
* END;/* ATDSPLY */                                                0971
*  /*CMZPEND*/                                                     0972
*   DO;                                                            0972
*  DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15)  */                   0973
*                                                                  0974
*  END;/* CMZMREG */                                               0974
*  DCL CMZX9902 REG(6) PTR(31);                                    0975
*  DCL CMZX9903 REG(6) PTR(31);                                    0976
*  DCL CMZX9904 REG(5) PTR(31);                                    0977
*  DCL CMZX9905 REG(5) PTR(31);                                    0978
*  DCL CMZX9906 REG(5) PTR(31);                                    0979
*  DCL CMZX9907 REG(5) PTR(31);                                    0980
*  DCL CMZX9908 REG(5) PTR(31);                                    0981
*  DCL CMZX9909 REG(5) PTR(31);                                    0982
*  DCL CMZX9910 REG(6) PTR(31);                                    0983
*  DCL CMZX9911 REG(12) PTR(31);                                   0984
*  DCL CMZX9912 REG(12) PTR(31);                                   0985
*  DCL CMZX9913 REG(7) PTR(31);                                    0986
*  DCL CMZX9914 REG(12) PTR(31);                                   0987
*  DCL CMZX9915 REG(7) PTR(31);                                    0988
*  DCL CMZX9916 REG(7) PTR(31);                                    0989
*  DCL CMZX9917 REG(7) PTR(31);                                    0990
*  DCL CMZX9918 REG(7) PTR(31);                                    0991
*  DCL CMZX9919 REG(12) PTR(31);                                   0992
*  /*PROC0012 INSUFFICIENT LINK REGISTERS*/                        0993
*  DCL CMZX9920 PTR(31);                                           0993
*  DCL CMZX9921 REG(7) PTR(31);                                    0994
*  DCL CMZX9922 REG(7) PTR(31);                                    0995
*  DCL CMZX9923 REG(7) PTR(31);                                    0996
*  DCL CMZX9924 REG(7) PTR(31);                                    0997
*  DO; /* CMZMREG (5,6,7,12,14,0,1,2,3,4,15) RELEASE */            0998
*  RFY (GPR00P,GPR01P,GPR02P,GPR03P,GPR04P,GPR05P,GPR06P,GPR07P,GPR12P,
*PR14P,GPR15P) UNRSTD;                                             0999
*                                                                  0999
*  END;/* CMZMREG */                                               1000
*  END ;                                                           1001
*  END ISTINCPH;                                                   1002
@EL00001 DS    0H                                                  1002
@EF00001 DS    0H                                                  1002
@ER00001 LM    @14,@12,12(@13)                                     1002
         BR    @14                                                 1002
@DATA    DS    0H
@CH00080 DC    H'7'
@SM00442 MVC   CPHARGUM(0),CPHSBYTE(@09)
@SM00449 MVC   PHRF34SP-12(0,@10),CPHSBYTE(@08)
@SM00451 MVC   PHRF34SP-12(0,@09),CPHSBYTE(@08)
@SM00453 MVC   0(0,@09),CPHSBYTE(@08)
@SM00456 MVC   CPHSUBVL(0),CPHFUNBT(@10)
@DATD    DSECT
         DS    0F
@TF00001 DS    F
ISTINCPH CSECT
         DS    0F
@CF00048 DC    F'1'
@CF00311 DC    F'2'
@CF00182 DC    F'3'
@CF00117 DC    F'4'
@CF00109 DC    F'5'
@CF00046 DC    F'8'
@CF00268 DC    F'9'
@CF00235 DC    F'12'
@CH00235 EQU   @CF00235+2
@CF00294 DC    F'255'
@CF00139 DC    F'256'
@CF00448 DC    F'-4'
@DATD    DSECT
         DS    0D
CPHTABAD DS    A
CPHSCNPT DS    A
CPHOANDX DS    F
CPHOALIM DS    F
CPHINSVA DS    A
CPHSCN00 DS    A
CPHSCN02 DS    A
CPHVCK01 DS    A
CPHVCK02 DS    A
CPHTABSV DS    A
CPHKWPTR DS    A
CPHTRTSV DS    A
CPHVALPS DS    A
CPHSPPTR DS    A
CMZX9920 DS    A
CPHSPLEN DS    H
CPHKWLEN DS    H
CPHPARCT DS    H
CPHSBPAR DS    H
CPHENCTR DS    H
CPHTCHAR DS    FL1
CPHLCHAR DS    FL1
         DS    0D
@TS00001 DS    CL8
CPHSUBVL DS    CL5
         ORG   CPHSUBVL
CPHVALBT DS    BL1
         ORG   CPHVALBT
@NM00005 DS    BL1
CPHFUNNU EQU   CPHVALBT+0
CPHFUNAN EQU   CPHVALBT+0
CPHFUNFC EQU   CPHVALBT+0
CPHFUNNO EQU   CPHVALBT+0
         ORG   CPHSUBVL+1
CPHVALUE DS    AL4
         ORG   CPHSUBVL+5
CPHARGUM DS    CL8
CPHDECHX DS    CL3
CPHVALFG DS    BL1
         ORG   CPHVALFG
@NM00006 DS    BL1
CPHVALNU EQU   CPHVALFG+0
CPHVALAN EQU   CPHVALFG+0
CPHVALFC EQU   CPHVALFG+0
@NM00007 EQU   CPHVALFG+0
         ORG   CPHVALFG+1
CPHFLAGS DS    BL1
         ORG   CPHFLAGS
@NM00008 DS    BL1
CPHCONT  EQU   CPHFLAGS+0
CPHKWSCN EQU   CPHFLAGS+0
CPHENDST EQU   CPHFLAGS+0
CPHENDSP EQU   CPHFLAGS+0
CPHLSTSP EQU   CPHFLAGS+0
CPHSLIST EQU   CPHFLAGS+0
CPHSYNER EQU   CPHFLAGS+0
         ORG   CPHFLAGS+1
CPHFLAG2 DS    BL1
         ORG   CPHFLAG2
CPHOFLOW DS    BL1
CPHFUNER EQU   CPHFLAG2+0
CPHARGNF EQU   CPHFLAG2+0
@NM00009 EQU   CPHFLAG2+0
         ORG   CPHFLAG2+1
ISTINCPH CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
@CC00266 DC    C'00000000'
@CC00291 EQU   @CC00266
CPHLOCK  DC    AL1(0)
         DS    CL3
STATICFD DS    CL116
CPHSCNTB DC    AL4(CPHCSP13)
         DC    AL4(CPHCSP01)
         DC    AL4(CPHCSP01)
         DC    AL4(CPHCSP01)
         DC    AL4(CPHCSP12)
         DC    AL4(CPHCSP12)
         DC    AL4(CPHCSP01)
         DC    AL4(CPHCSP02)
         DC    AL4(CPHCSP12)
         DC    AL4(CPHCSP12)
         DC    AL4(CPHCSP12)
         DC    AL4(CPHCSP12)
         DC    AL4(CPHCSP12)
         DC    AL4(CPHCSP12)
         DC    AL4(CPHCSP10)
         DC    AL4(CPHCSP10)
         DC    AL4(CPHCSP04)
         DC    AL4(CPHCSP04)
         DC    AL4(CPHCSP05)
         DC    AL4(CPHCSP13)
         DC    AL4(CPHCSP12)
         DC    AL4(CPHCSP12)
         DC    AL4(CPHCSP06)
         DC    AL4(CPHCSP06)
         DC    AL4(CPHCSP06)
         DC    AL4(CPHCSP12)
         DC    AL4(CPHCSP12)
         DC    AL4(CPHCSP12)
         DC    AL4(CPHCSP07)
         DC    AL4(CPHCSP12)
         DC    AL4(CPHCSP07)
         DC    AL4(CPHCSP12)
         DC    AL4(CPHCSP08)
         DC    AL4(CPHCSP08)
         DC    AL4(CPHCSP12)
         DC    AL4(CPHCSP12)
         DC    AL4(CPHCSP09)
         DC    AL4(CPHCSP09)
         DC    AL4(CPHCSP09)
         DC    AL4(CPHCSP12)
         DC    AL4(CPHCSP12)
         DC    AL4(CPHCSP12)
         DC    AL4(CPHCSP10)
         DC    AL4(CPHCSP10)
         DC    AL4(CPHCSP10)
         DC    AL4(CPHCSP12)
         DC    AL4(CPHCSP14)
         DC    AL4(CPHCSP10)
         DC    AL4(CPHCSP13)
ISTINCPH CSECT
CPHTRTB    DC    XL256'00'          INIT ALL CODES TO NON-DELIMITER
            ORG   CPHTRTB+C' '       RE-ORIGIN TO BLANK
            DC    X'06'              SCAN CODE = '06'X
            ORG   CPHTRTB+C','       RE-ORIGIN TO COMMA
            DC    X'02'              SCAN CODE = '02'X
            ORG   CPHTRTB+C'('       RE-ORIGIN TO LEFT PARENTHESIS
            DC    X'03'              SCAN CODE = '03'X
            ORG   CPHTRTB+C')'       RE-ORIGIN TO RIGHT PARENTHESIS
            DC    X'04'              SCAN CODE = '04'X
            ORG   CPHTRTB+C''''      RE-ORIGIN TO QUOTE MARK
            DC    X'05'              SCAN CODE = '05'X
            ORG   CPHTRTB+C'='       RE-ORIGIN TO EQUAL SIGN
            DC    X'01'              SCAN CODE = '01'X
            ORG             ,        CONTINUE WITH STORAGE DEFINITION
ISTINCPH CSECT
CPHVTRTB  DC    XL256'04'           DEFAULT CODE = '04'X
           ORG   CPHVTRTB+C'A'       RE-ORIGIN TO ALPHABETICS
           DC    9X'01'              A-I CODE = '01'X
           ORG   CPHVTRTB+C'J'       RE-ORIGIN TO NEXT ALPHA GROUP
           DC    9X'01'              J-R CODE = '01'X
           ORG   CPHVTRTB+C'S'       RE-ORIGIN TO LAST ALPHA GROUP
           DC    8X'01'              S-Z CODE = '01'X
           ORG   CPHVTRTB+C'$'       RE-ORIGIN TO NATIONAL CHARACTERS
           DC    X'01'               ALPHA CODE = '01'X
           ORG   CPHVTRTB+C'@'       ANOTHER NATIONAL CHARACTER
           DC    X'01'               ALPHA CODE = '01'X
           ORG   CPHVTRTB+X'7B'      RE-ORIGIN TO POUND SIGN
           DC    X'01'               ALPHA CODE = '01'X
           ORG   CPHVTRTB+C'0'       RE-ORIGIN TO NUMERICS
           DC    10X'02'             NUMERIC CODE = '02'X
           ORG         ,             CONTINUE STORAGE DEFINITION
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
ISTINCPH CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
GPR00P   EQU   @00
GPR01P   EQU   @01
GPR02P   EQU   @02
GPR03P   EQU   @03
GPR04P   EQU   @04
GPR05P   EQU   @05
GPR06P   EQU   @06
GPR07P   EQU   @07
GPR12P   EQU   @12
GPR14P   EQU   @14
GPR15P   EQU   @15
R4       EQU   @04
R5       EQU   @05
R6       EQU   @06
R7       EQU   @07
GPR13P   EQU   @13
GPR15F   EQU   @15
GPR00F   EQU   @00
CMZX9904 EQU   @05
CMZX9905 EQU   @05
CMZX9906 EQU   @05
CMZX9907 EQU   @05
CMZX9908 EQU   @05
CMZX9909 EQU   @05
CMZX9903 EQU   @06
CMZX9910 EQU   @06
GPR02F   EQU   @02
CMZX9902 EQU   @06
CMZX9911 EQU   @12
CMZX9912 EQU   @12
CMZX9913 EQU   @07
CMZX9914 EQU   @12
CMZX9915 EQU   @07
CMZX9916 EQU   @07
CMZX9917 EQU   @07
CMZX9918 EQU   @07
CMZX9919 EQU   @12
CMZX9921 EQU   @07
CMZX9922 EQU   @07
CMZX9923 EQU   @07
CMZX9924 EQU   @07
GPR01F   EQU   @01
GPR03F   EQU   @03
GPR04F   EQU   @04
GPR05F   EQU   @05
GPR06F   EQU   @06
GPR07F   EQU   @07
GPR08F   EQU   @08
GPR08P   EQU   @08
GPR09F   EQU   @09
GPR09P   EQU   @09
GPR10F   EQU   @10
GPR10P   EQU   @10
GPR11F   EQU   @11
GPR11P   EQU   @11
GPR12F   EQU   @12
GPR13F   EQU   @13
GPR14F   EQU   @14
ISTPHROA EQU   0
PHROALEN EQU   ISTPHROA
PHROADTA EQU   ISTPHROA+4
CPHKWDTB EQU   0
CPHENTNO EQU   CPHKWDTB
CPHENTLN EQU   CPHKWDTB+2
CPHTABEN EQU   CPHKWDTB+4
CPHKEYWD EQU   CPHTABEN
CPHFUNBT EQU   CPHTABEN+8
CPHPNTBK EQU   0
CPHSBVAL EQU   CPHPNTBK
CPHSBTAB EQU   CPHPNTBK+4
CPHSBYTE EQU   0
CMZP0229 EQU   0
PHRFN1OA EQU   PHROADTA
PHRF1SAD EQU   PHRFN1OA
PHRF1SLN EQU   PHRFN1OA+4
PHRFN2OA EQU   PHROADTA
PHRF2NVL EQU   PHRFN2OA
PHRF2VAL EQU   PHRFN2OA+4
PHRF2FLG EQU   PHRF2VAL+2
PHRF34OA EQU   PHROADTA
PHRF34NS EQU   PHRF34OA
PHRF34EN EQU   PHRF34OA+4
PHRF34VF EQU   PHRF34EN
PHRF34SL EQU   PHRF34EN+2
PHRF34SP EQU   PHRF34EN+4
PHRFN5OA EQU   PHROADTA
PHRF5NSP EQU   PHRFN5OA
PHRF5ENT EQU   PHRFN5OA+4
PHRF5VF  EQU   PHRF5ENT
PHRF5SL  EQU   PHRF5ENT+2
PHRF5SPT EQU   PHRF5ENT+4
PHRFN7OA EQU   PHROADTA
PHRF7NSP EQU   PHRFN7OA
PHRF7NUM EQU   PHRFN7OA+4
PHRFN8OA EQU   PHROADTA
PHRF8NSP EQU   PHRFN8OA
PHRF8ENT EQU   PHRFN8OA+4
PHRF8FLG EQU   PHRF8ENT
PHRF8DFT EQU   PHRF8FLG
PHRF8NUM EQU   PHRF8ENT+1
CPHF2VAL EQU   PHRF2VAL
CPHSBVL1 EQU   CPHSUBVL
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00004 EQU   PHRF8FLG
@NM00003 EQU   PHRF5ENT+1
@NM00002 EQU   PHRF34EN+1
PHRF2MSK EQU   PHRF2VAL+3
PHRF2MV  EQU   PHRF2FLG
PHRF2OFF EQU   PHRF2FLG
PHRF2ON  EQU   PHRF2FLG
@NM00001 EQU   PHRF2FLG
PHRF2TR  EQU   PHRF2FLG
PHRF2CL  EQU   PHRF2FLG
PHRF2LN  EQU   PHRF2FLG
PHRF2GP  EQU   PHRF2FLG
PHRF2OFS EQU   PHRF2VAL
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00098 EQU   @RC00096
@RC00101 EQU   @RC00096
@RC00105 EQU   @RC00096
@RC00110 EQU   @RC00096
@RC00115 EQU   @RC00096
@RC00120 EQU   @RC00096
@RC00125 EQU   @RC00096
@RC00315 EQU   @RC00313
@RC00438 EQU   @RC00437
@RC00532 EQU   @RC00528
@PB00009 EQU   @PB00010
@RT00817 EQU   @RC00814
@PB00023 EQU   @PB00024
@PB00008 EQU   @PB00009
@RC00534 EQU   @RC00532
@PB00022 EQU   @PB00023
@PB00007 EQU   @PB00008
@PB00021 EQU   @PB00022
@PB00006 EQU   @PB00007
@PB00020 EQU   @PB00021
@PB00005 EQU   @PB00006
@PB00019 EQU   @PB00020
@PB00004 EQU   @PB00005
@PB00018 EQU   @PB00019
@PB00003 EQU   @PB00004
@PB00017 EQU   @PB00018
@PB00002 EQU   @PB00003
@PB00016 EQU   @PB00017
@RC00062 EQU   @PB00002
@PB00015 EQU   @PB00016
@PB00014 EQU   @PB00015
@PB00013 EQU   @PB00014
@PB00012 EQU   @PB00013
@PB00011 EQU   @PB00012
@RC00582 EQU   @PB00011
@ENDDATA EQU   *
         END   ISTINCPH,(C'PLS1908',0702,79061)

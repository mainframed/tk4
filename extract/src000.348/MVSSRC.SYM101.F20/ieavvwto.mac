         TITLE 'IEAVVWTO - SINGLE LINE WTO AND WTOR PROCESSOR          *
                        '
IEAVVWTO CSECT
        USING *,REG6
        MODID BR=YES
        USING RBBASIC,REG5
* SAVE THE CONTENTS OF REGISTERS 0, 1 AND 14 SO THE PARAMETERS
* IN THESE REGISTERS ARENT LOST BY THE PL/S SET UP PROCESS.
        ST    REG0,XVWQEID        SAVE REG0  IN EXTENDED SAVEAREA
        ST    REG1,XVPARMAD       SAVE REG1  IN EXTENDED SAVEAREA
        ST    REG14,XVRET         SAVE REG14 IN EXTENDED SAVEAREA
        DROP  REG5                THIS STMNT MUST BE HERE
        DROP  REG6
IEAVVWTO CSECT ,                                                   0002
@PROLOG  BALR  @11,0                                               0002
@PSTART  LA    @12,4095(,@11)                                      0002
         USING @PSTART,@11                                         0002
         USING @PSTART+4095,@12                                    0002
         L     @00,@SIZDATD                                        0002
         GETMAIN  R,LV=(0)
         LR    @09,@01                                             0002
         USING @DATD,@09                                           0002
         ST    @13,@SA00001+4                                      0002
         LR    @13,@09                                             0002
RBPRFXLN EQU 64
RBPRFLNA EQU 32
PRBLEN   EQU 136
SIRBLEN  EQU 200
TIRBLEN  EQU 136
IRBLEN   EQU 128
SVRBLEN  EQU 200
*                                      REG3                          */
*/********************************************************************/
*/*                                                                  */
*/*  SET UP THE ESTAE ENVIRONMENT                                    */
*/*                                                                  */
*/********************************************************************/
*/********************************************************************/
*/*                                                                  */
*/*  FUNCTION THIS SEGMENT WILL SET UP THE ESTAE ENVIRONMENT         */
*/*  AND WILL SET THE FIRST FOOTPRINT FOR IEAVVWTO.                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0137
*   EPARM=EPARM&&EPARM;             /* CLEAR THE RECOVERY PARM LIST  */
         XC    EPARM(24),EPARM                                     0137
*   RFY                                                            0138
*    (REG2,                                                        0138
*     REG8) RSTD;                   /* USE REGS 2 AND 8 FOR ESTAE    */
*   REG8=ADDR(EPARM);               /* PUT ADDR OF OUR ESTAE PARM  0139
*                                      AREA                          */
         LA    REG8,EPARM                                          0139
*   REG2=UCMFRRAD;                  /* ADDR OF IEAVMFRR, OUR RECOVERY
*                                      MOD                           */
         L     @10,UCMBASPT(,REG3)                                 0140
         L     REG2,UCMFRRAD(,@10)                                 0140
*   RECREGS=ELIST;                  /* MOVE ESTAE PARM LIST TO AUTO
*                                      AREA                          */
         MVI   RECREGS+16,C' '                                     0141
         MVC   RECREGS+17(47),RECREGS+16                           0141
         MVC   RECREGS(16),ELIST                                   0141
*   REG1=ADDR(RECREGS);             /* GET ADDR OF ESTAE PARM LIST 0142
*                                      AREA                          */
         LA    REG1,RECREGS                                        0142
*   GEN(ESTAE (REG2),CT,PARAM=(REG8),RECORD=YES,MF=(E,(1)))        0143
*   REFS(REG2,REG8,REG1);           /* SET UP ESTAE ENVIRONMENT      */
         ESTAE (REG2),CT,PARAM=(REG8),RECORD=YES,MF=(E,(1))
*   PARMPTR=ADDR(EPARM);            /* SET ADDR TO ESTAE PARM AREA   */
         LA    @10,EPARM                                           0144
         ST    @10,PARMPTR                                         0144
*   PARMRGAD=ADDR(RECSAVE);         /* PT AT REG SAVE AREA           */
         LA    @06,RECSAVE                                         0145
         ST    @06,PARMRGAD(,@10)                                  0145
*   PARMID=MODULEID;                /* IDENTIFY MODULE TO FRR        */
         MVC   PARMID(4,@10),@CC01464                              0146
*   RECRGMAP=ALLREGS;               /* RESTORE ALL REGS AT RETRY     */
         MVC   RECRGMAP(2),@CB01462                                0147
*   STM(REG0,REG15,RECREGS);        /* SAVE OUR REGS FOR RETRY IF  0148
*                                      NEEDED.                       */
         STM   REG0,REG15,RECREGS                                  0148
*   PARMFTPT=FTVALCHK;              /* SET FOOT PRINT TO SHOW WE WERE
*                                      WORKING ON CHECKING THE     0149
*                                      VALIDITY OF THE USER'S WPL.   */
         MVI   PARMFTPT(@10),X'01'                                 0149
*   PARMRTAD=0;                     /* ZERO RETRY ADDRESS    @ZA05504*/
         SLR   @06,@06                                             0150
         ST    @06,PARMRTAD(,@10)                                  0150
*   RFY                                                            0151
*    (REG2,                                                        0151
*     REG8) UNRSTD;                 /* RELE REG 2 & 8                */
*/********************************************************************/
*/*                                                                  */
*/*  SET UP THE EXTENDED SAVEAREA                                    */
*/*                                                                  */
*/********************************************************************/
*/*** START OF SETUPXSA **********************************************/
*/*   SETUPXSA - SET UP THE EXTENDED SAVE AREA                       */
*/*                                                                  */
*/*   INPUT -                                                        */
*/*     REG 5 WILL BE POINTING AT THE SVRB WHICH CONTAINS THE        */
*/*           EXTENDED SAVEAREA.                                     */
*/*     XVPARMAD WILL PT AT THE USERS PARM LIST                      */
*/*     XVWQEID WILL CONTAIN THE CONTENTS OF REGISTER 0.             */
*/*     XVRET WILL CONTAIN THE RETURN ADDRESS.                       */
*/*     THESE LAST THREE FIELDS ARE SET UP AT THE BEGINNING OF THE   */
*/*     PROGRAM SO THAT THE NORMAL REENTRANT PROLOG CAN BE GENERATED */
*/*     BY PL/S.                                                     */
*/*     REG 4 IS THE ADDRESS OF THE TCB                              */
*/*     REG 7 IS THE ADDRESS OF OUR ASCB                             */
*/*                                                                  */
*/*   OUTPUT - THE EXTENDED SAVE AREA IS INITIALIZED                 */
*/*            VARIOUS BITS OR SETTINGS IN THE PARM LIST NOW APPEAR  */
*/*            IN XSA.                                               */
*/*            REG6 POINTS AT THE MESSAGE PART OF THE WPL            */
*/*            XVA8 CONTAINS THE TIME IN DECIMAL FORMAT AS HHMMSSTH. */
*/*                                                                  */
*/*     THE MESSAGE LENGTH IS SAVED FOR INTEGRITY REASONS.           */
*/*     THE LENGTH IS USED TO COMPUTE THE LENGTH OF THE PARM LIST.   */
*/*     BY SAVING THE LENGTH, THE USER CAN NOT CHANGE THE LENGTH     */
*/*     AFTER WE HAVE CHECKED THE VALIDITY OF THE PARM LIST.         */
*/*                                                                  */
*/********************************************************************/
*                                                                  0152
*   XVDFLAGS=0;                     /* INSURE THAT ALL FLAGS ARE   0152
*                                      INITIALLY SET TO ZERO         */
*                                                                  0152
         ST    @06,XVDFLAGS(,RBSECPTR)                             0152
*   /*****************************************************************/
*   /*                                                               */
*   /* INSURE THAT THE ROUTE CODES AND DESC CODES FILED IN XVSAV ARE */
*   /* ZERO                                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0153
*   XVRDMSV=XVRDMSV&&XVRDMSV;       /* INITIALIZE R/D CODES TO ZERO  */
         XC    XVRDMSV(6,RBSECPTR),XVRDMSV(RBSECPTR)               0153
*   RFY                                                            0154
*    (REG6) RSTD;                   /* USE REG6 TO POINT AT PARTS OF
*                                      PARM LIST                     */
*   RFY                                                            0155
*    (WPL,                                                         0155
*     WPLRF) BASED(REG6);           /* REG 6 IS NOW BASE FOR WPL     */
*   REG6=XVPARMAD;                  /* PICK UP ADDR OF PARM LIST     */
         L     REG6,XVPARMAD(,RBSECPTR)                            0156
*   XVRETCOD=0;                     /* INSURE RETURN CODE IS       0157
*                                      INITIALLY ZERO                */
         MVI   XVRETCOD(RBSECPTR),X'00'                            0157
*/********************************************************************/
*/*                                                                  */
*/*  CHECK TO SEE IF THIS IS A WTOR. THE CHECK IS MADE BY CHECKING   */
*/*  WHETHER WPLRLN (THE REPLY LENGTH) IS ZERO. IF THE WPL IS FOR    */
*/* A WTOR THEN WPLRLN WILL BE THE FIRST BYTE IN THE PARM LIST.      */
*/*   IF THE WPL IS FOR A                                            */
*/*  WTO THEN THERE WILL BE NO WTO PREFIX AND WPLLGH WILL BE THE     */
*/*  FIRST 2 BYTES. THE TEXT HAS A MAX LENGTH OF 125 BYTES SO THE    */
*/*  FIRST BYTE OF WPLLGH WILL BE ZERO. WPLRLN WILL ALWAYS BE NON    */
*/*  ZERO IF THE WPL IS FOR A WTOR.                                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0158
*   IF WPLRLN^=0 THEN               /* IS THIS A WTOR                */
         CLI   WPLRLN(REG6),0                                      0158
         BE    @RF00158                                            0158
*     DO;                           /* YES                           */
*       XVD2WTOR='1'B;              /* TURN ON WTOR BIT SO WE WILL 0160
*                                      KNOW TO SKIP PAST WTOR PREFIX */
         OI    XVD2WTOR(RBSECPTR),B'00000010'                      0160
*       REG6=REG6+                  /* INCREMENT WPL POINTER BY    0161
*                                      LENGTH                        */
*           LENGTH(WPLRF);          /* OF WTOR PREFIX                */
         AL    REG6,@CF00061                                       0161
*     END;                                                         0162
*   RFY                                                            0163
*     WPLRF BASED(XVPARMAD);        /* RESET POINTER TO WTOR PART OF
*                                      WPL                           */
@RF00158 DS    0H                                                  0164
*/********************************************************************/
*/*                                                                  */
*/* REG6 WILL NOW BE USED TO POINT AT THE WTO PART OF THE WPL        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0164
*   XVMSGLGH=WPLLGH;                /* SAVE LENGTH IN XSA            */
         LH    @10,WPLLGH(,REG6)                                   0164
         STH   @10,XVMSGLGH(,RBSECPTR)                             0164
*/********************************************************************/
*/*                                                                  */
*/* CHECK TO SEE IF MSGTYP WAS SPECIFIED IN THE MACRO. IF IT WAS     */
*/* TURN ON THE MSGTYP BIT IN THE XSA FLAGS. THIS IS DONE FOR FASTER */
*/* CHECKING IF MSGTYP WAS SPECIFIED                                 */
*/*                                                                  */
*/********************************************************************/
*                                                                  0165
*   IF WPLMCSFD='1'B THEN           /* WAS MSGTYP SPECIFIED          */
         TM    WPLMCSFD(REG6),B'00010000'                          0165
         BNO   @RF00165                                            0165
*     XVD2MSGT='1'B;                /* YES, SET XSA MSGTYP BIT ON    */
         OI    XVD2MSGT(RBSECPTR),B'00100000'                      0166
*/********************************************************************/
*/*                                                                  */
*/* CHECK IF ROUTE/DESCRIPTOR CODES (R/D CODES) WERE SPECIFIED.      */
*/* THE R/D CODES AND MSGTYPE FIELDS ARE OPTIONAL PARAMETERS AND     */
*/* EXTEND THE LENGTH OF THE WPL.                                    */
*/*                                                                  */
*/********************************************************************/
*                                                                  0167
*   IF WPLMCSFA='1'B THEN           /* WAS R/D CODES SPECIFIED       */
@RF00165 TM    WPLMCSFA(REG6),B'10000000'                          0167
         BNO   @RF00167                                            0167
*     XVD2RDC='1'B;                 /* YES, SET XSA R/D BIT ON       */
         OI    XVD2RDC(RBSECPTR),B'01000000'                       0168
*/********************************************************************/
*/*                                                                  */
*/* NOW CHECK TO SEE IF THE USER IS AUTHORIZED OR NOT AND WHETHER    */
*/* IT IS A PROBLEM PROGRAM OR NOT. THIS INFO IS USED TO SELECT      */
*/* THE PROPER MESSAGE FLAGGING AND ERROR RECOVERY PROCEDURES.       */
*/*                                                                  */
*/********************************************************************/
*                                                                  0169
*   RFY                                                            0169
*     REG15 RSTD;                   /* RESTRICT RETURN CODE REGISTER */
@RF00167 DS    0H                                                  0170
*   GEN(TESTAUTH  STATE=YES,KEY=YES)                               0170
*   SETS(REG15);                    /* CHECK IF USER IS SUPERVISOR 0170
*                                      STATE OR PROTECT KEY 0-7.     */
         TESTAUTH  STATE=YES,KEY=YES
*   IF REG15^=0 THEN                /* IS USER NOT STATE OR KEY    0171
*                                      AUTHORIZED                    */
         LTR   REG15,REG15                                         0171
         BZ    @RF00171                                            0171
*     DO;                           /* YES, THE USER IS A PROBLEM  0172
*                                      PROGRAM                       */
*       XVD1PP='1'B;                /* TURN ON PROB. PROGRAM BIT IN
*                                      XSA                           */
         OI    XVD1PP(RBSECPTR),B'00000100'                        0173
*       GEN(TESTAUTH FCTN=1)        /* CHECK IF APF AUTHOZIZED       */
*       SETS(REG15);                                               0174
         TESTAUTH FCTN=1
*       IF REG15=0 THEN             /* IS USER APF AUTHORIZED        */
         LTR   REG15,REG15                                         0175
         BNZ   @RF00175                                            0175
*         XVD1AUTH='1'B;            /* YES, TURN ON AUTHORIZED BIT IN
*                                      XSA                           */
         OI    XVD1AUTH(RBSECPTR),B'00000010'                      0176
*       ELSE                                                       0177
*         ;                         /* NO, DO NOTHING                */
@RF00175 DS    0H                                                  0178
*     END;                                                         0178
*   ELSE                            /* NO, USER NOT PP.              */
*     XVD1AUTH='1'B;                /* THEN USER IS AUTHORIZED       */
         B     @RC00171                                            0179
@RF00171 OI    XVD1AUTH(RBSECPTR),B'00000010'                      0179
*   RFY                                                            0180
*     REG15 UNRSTD;                 /* RELEASE REG 15                */
@RC00171 DS    0H                                                  0181
*/********************************************************************/
*/*                                                                  */
*/* NOW CHECK IF USER IS A PRIVELEGED TASK. A PRIVILEGED USER IS     */
*/*   A. THE COMMUNICATIONS TASK                                     */
*/*   B. ANY TASK RUNNING UNDER AN SIRB                              */
*/*   C. A DAUGHTER TASK OF THE COMMUNICATIONS TASK          @ZA01858*/
*/*   D. AN AUTHORIZED SUBSYSTEM SUCH AS JES3                @ZA19256*/
*/* A PRIVILEGED USER MAY PUT OUT A WTO ANY TIME. IT DOES NOT HAVE   */
*/* TO WAIT FOR SPACE IF ALL THE WQES ARE TAKEN.                     */
*/* FIRST CHECK IF THE USER IS COMMTASK.                             */
*/*                                                                  */
*/* NOTE: THE SPECIAL CHECK FOR A DAUGHTER TASK IS ADDED     @ZA01858*/
*/*       TO PERMIT TASK ATTACHED BY THE COMMUNICATIONS      @ZA01858*/
*/*       TASK TO EXCEED THE WQE LIMITS IF NECESSARY.        @ZA01858*/
*/*                                                                  */
*/********************************************************************/
*                                                                  0181
*   IF ASCBASID=UCMCTID&            /* ARE WE IN THE COMTASK'S MEMORY*/
*       REG4=UCMPXA×                /* AND COMTASK'S TCB     @ZA01858*/
*       UCMPXA=TCBOTC THEN          /* OR DAUGHTER TASK      @ZA01858*/
         L     @10,UCMBASPT(,REG3)                                 0181
         LH    @08,ASCBASID(,ASCBPTR)                              0181
         N     @08,@CF03329                                        0181
         CH    @08,UCMCTID(,@10)                                   0181
         BNE   @GL00001                                            0181
         C     REG4,UCMPXA(,@10)                                   0181
         BE    @RT00181                                            0181
@GL00001 L     @10,UCMBASPT(,REG3)                                 0181
         CLC   UCMPXA(4,@10),TCBOTC(TCBPTR)                        0181
         BNE   @RF00181                                            0181
@RT00181 DS    0H                                                  0182
*     XVD1PRIV='1'B;                /* YES, THEN INDICATE A        0182
*                                      PRIVILEGED TASK               */
         OI    XVD1PRIV(RBSECPTR),B'10000000'                      0182
*   ELSE                            /* NO, CHECK IF THIS RB IS AN  0183
*                                      SIRB                          */
*     DO;                           /* IS THE USER'S RB AN SIRB    0183
*                                                            @ZA03627*/
         B     @RC00181                                            0183
@RF00181 DS    0H                                                  0184
*/************************************************************YM06329*/
*/* IF THE TASK IS NOT RUNNING IN SIRB MODE, THEN CHECK IF    YM06329*/
*/* WE WERE ENTERED TO ISSUE A LOG MESSAGE, OR SUBSYSTEM.     YM06329*/
*/************************************************************YM06329*/
*                                                                  0184
*       IF RBLINK->RBFTP='100'B×TCBTID='F8'X THEN                  0184
         L     @10,RBLINK(,RBSECPTR)                               0184
         TM    RBFTP(@10),B'10000000'                              0184
         BNO   @GL00003                                            0184
         TM    RBFTP(@10),B'01100000'                              0184
         BZ    @RT00184                                            0184
@GL00003 CLI   TCBTID(TCBPTR),X'F8'                                0184
         BNE   @RF00184                                            0184
@RT00184 DS    0H                                                  0185
*         XVD1PRIV='1'B;            /* YES, INDICATE A PRIVILEGED  0185
*                                      TASK                          */
         OI    XVD1PRIV(RBSECPTR),B'10000000'                      0185
*       ELSE                        /*                       @ZA03627*/
*         IF UCMJES3T=REG7 THEN     /* IF SUBSYSTEM ISSUED WTO     0186
*                                                            @ZA19256*/
         B     @RC00184                                            0186
@RF00184 L     @10,UCMBASPT(,REG3)                                 0186
         C     REG7,UCMJES3T(,@10)                                 0186
         BNE   @RF00186                                            0186
*           XVD1PRIV='1'B;          /* SET PRIVILEGED BIT    @ZA03627*/
         OI    XVD1PRIV(RBSECPTR),B'10000000'                      0187
*     END;                          /*                       @ZA03627*/
@RF00186 DS    0H                                                  0188
@RC00184 DS    0H                                                  0189
*/********************************************************************/
*/*                                                                  */
*/*  TAKE THE TIME AND SAVE IT IN XVA8 ALSO KNOWN AS TIMEFLD   YM0820*/
*/*                                                                  */
*/********************************************************************/
*                                                                  0189
*   RFY                                                            0189
*     REG0 RSTD;                    /*                         YM0820*/
@RC00181 DS    0H                                                  0190
*   TIMEFLD=0;                      /* INITIALIZE THE TIME TO ZERO   */
         SLR   @10,@10                                             0190
         ST    @10,TIMEFLD(,RBSECPTR)                              0190
*   STM(REG0,REG15,RECREGS);        /* SAVE THE REGS AT THIS POINT IN
*                                      CASE THERE IS AN ERROR IN TIME
*                                      SVC                           */
         STM   REG0,REG15,RECREGS                                  0191
*   PARMFTPT=FTTIME;                /* TIME WAS TAKEN                */
         L     @10,PARMPTR                                         0192
         MVI   PARMFTPT(@10),X'02'                                 0192
*   PARMRTAD=ADDR(TIMERET);                                        0193
         LA    @08,TIMERET                                         0193
         ST    @08,PARMRTAD(,@10)                                  0193
*   GEN(TIME DEC,ERRET=TIMERET)                                    0194
*   SETS(REG0) FLOWS(TIMERET);      /* TAKE THE TIME.          YM0820*/
         TIME DEC,ERRET=TIMERET
*   TIMEFLD=REG0;                   /* SAVE THE TIME IN XVSAV. YM0820*/
         ST    REG0,TIMEFLD(,RBSECPTR)                             0195
*TIMERET:                           /* IF ERROR IN TIME THEN DONT  0196
*                                      STORE REG0                    */
*   PARMFTPT=FTVALCHK;              /* RESUME CHECK OF WPL           */
TIMERET  L     @10,PARMPTR                                         0196
         MVI   PARMFTPT(@10),X'01'                                 0196
*   PARMRTAD=0;                     /* ZERO RETRY ADDRESS    @ZA05504*/
         SLR   @08,@08                                             0197
         ST    @08,PARMRTAD(,@10)                                  0197
*   RFY                                                            0198
*     REG0 UNRSTD;                  /* YM0820                        */
*/***** END OF SETUPXSA **********************************************/
*/********************************************************************/
*/*                                                                  */
*/*  CHECK THAT THE PARAMETER LIST IS VALID                          */
*/*                                                                  */
*/********************************************************************/
*/*** START OF VALIDCHK **********************************************/
*/*                                                                  */
*/*   VALIDCHK - CHECK THE VALIDITY OF THE USER'S PARM LIST          */
*/*                                                                  */
*/*   INPUT -                                                        */
*/*     XVPARMAD SHOULD POINT AT THE USERS PARM LIST                 */
*/*     XVMSGLGH SHOULD CONTAIN LENGTH OF MSG + 4                    */
*/*     XVD2RDC & XVD2MSGT SHOULD BE SET IF ROUTE/DESRIPTOR          */
*/*       CODES OR MSGTYP FIELDS ARE USED. THESE FIELDS WILL         */
*/*       DETERMINE END LOCATION OF THE USERS PARM LIST              */
*/*     XVD2WTOR SHOULD BE SET ON IF THIS IS A WTOR                  */
*/*     REG6 POINTS AT THE BEGINNING OF THE WPL MESSAGE PART         */
*/*                                                                  */
*/*   OUTPUT -  XVD2VALD IS ON IF PARM LIST IS VALID, OFF IF INVALID */
*/*             REG8 POINTS AT THE ROUTE/DESC CODES AND MSGTYPE      */
*/*             PART OF THE WPL.                                     */
*/*                                                                  */
*/********************************************************************/
*/********************************************************************/
*/*                                                                  */
*/*  NOW CHECK THE VALIDITY OF THE USER'S PARM LIST. WE WILL CHECK   */
*/*  THAT THE BEGINNING AND ENDING ADDRESS OF THE PARM LIST IS IN    */
*/*  USER'S ADDRESSABLE STORAGE. WE WILL ALSO CHECK THAT THE WPL IS  */
*/*  ON A WORD BOUNDARY FOR WTORS. IF THE PARM LIST IS VALID THEN    */
*/*  XVD2VALD IS LEFT ON.                                            */
*/*                                                                  */
*/********************************************************************/
*                                                                  0199
*   XVD2VALD='1'B;                  /* ASSUME USER VALID. TURN BIT 0199
*                                      OFF IF FOUND INVALID. THIS  0199
*                                      TECHNIQUE IS USED BECAUSE OF
*                                      USE OF ESTATE TO TURN OFF BIT */
         OI    XVD2VALD(RBSECPTR),B'00010000'                      0199
*/********************************************************************/
*/*                                                                  */
*/* COMPUTE ENDING ADDRESS OF PARAMETER LIST                         */
*/*                                                                  */
*/********************************************************************/
*                                                                  0200
*   RFY                                                            0200
*    (REG2,                                                        0200
*     REG8) RSTD;                   /* RESTRICT REG2 FOR DEVELOPMENT
*                                      OF PARM LIST LENGTH, REG8 TO
*                                      POINT AT FLAGS PART OF WPL    */
*   RFY                                                            0201
*    (WPLLS01,                                                     0201
*     WPLML) BASED(REG2);           /* USE REG2 AS PTR TO ML PART    */
*   RFY                                                            0202
*     WPLFLGS BASED(REG8);          /* USE REG8 AS PTR TO FLAGS PART
*                                      OF WPL                        */
*   REG2=REG6+                      /* ADDRESS OF BEGINNING OF MSG 0203
*                                      PART                          */
*       XVMSGLGH;                   /* PLUS LENGTH OF TEXT + 4       */
         LR    REG2,REG6                                           0203
         AH    REG2,XVMSGLGH(,RBSECPTR)                            0203
*   REG8=REG2;                      /* SAVE ADDR OF FLAGS PART OF WPL*/
         LR    REG8,REG2                                           0204
*/********************************************************************/
*/*                                                                  */
*/*  CHECK FOR MSGTYP. IF SO ADD SIX FOR R/D CODES AND MSGTYP        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0205
*   IF XVD2MSGT='1'B THEN           /* WAS MSGTYP SPECIFIED (IMPLIES
*                                      THAT ROUTE/DESC CODES ARE   0205
*                                      PRESENT IN WPL)               */
         TM    XVD2MSGT(RBSECPTR),B'00100000'                      0205
         BNO   @RF00205                                            0205
*     DO;                           /* YES, MSGTYP PRESENT. CHECK FOR
*                                      QID                           */
*       IF WPLMSGTD='1'B THEN       /* IS QID INDICATED IN MSGTYP  0207
*                                      FIELD                         */
         TM    WPLMSGTD(REG8),B'00010000'                          0207
         BNO   @RF00207                                            0207
*         XVD0QID='1'B;             /* YES, SET BIT IN XSA           */
         OI    XVD0QID(RBSECPTR),B'00001000'                       0208
*       REG2=REG2+                  /* ADD LENGTH OF EXTRA FIELDS    */
*           LENGTH(WPLDESC)+LENGTH(WPLROUT)+LENGTH(WPLMSGTY);      0209
@RF00207 AL    REG2,@CF00187                                       0209
*     END;                                                         0210
*   ELSE                                                           0211
*                                                                  0211
*/********************************************************************/
*/*                                                                  */
*/*  CHECK IF JUST ROUT/DESC CODES PRESENT                           */
*/*                                                                  */
*/********************************************************************/
*                                                                  0211
*     IF XVD2RDC='1'B THEN          /* WERE R/D CODES SPECIFIED      */
         B     @RC00205                                            0211
@RF00205 TM    XVD2RDC(RBSECPTR),B'01000000'                       0211
         BNO   @RF00211                                            0211
*       REG2=REG2+                  /* THEN INCREMENT BY LENGTH OF 0212
*                                      R/D                           */
*           LENGTH(WPLDESC)+        /* CODES FIELD                   */
*           LENGTH(WPLROUT);                                       0212
*                                                                  0212
         AL    REG2,@CF00084                                       0212
*/********************************************************************/
*/*                                                                  */
*/*  CHECK IF THIS IS A MLWTO. IF SO COMPUTE LENGTH OF PARM LIST.    */
*/*  ALSO CHECK FOR THE INVALID COMBINATION OF MLWTOR. IF THIS WAS   */
*/*  SPECIFIED, TURN XVD2VALD OFF AS PARM LIST IS INVALID.           */
*/*                                                                  */
*/********************************************************************/
*                                                                  0213
*   IF WPLMCSFJ='1'B THEN           /* IS THIS A MLWTO               */
@RF00211 DS    0H                                                  0213
@RC00205 TM    WPLMCSFJ(REG6),B'01000000'                          0213
         BNO   @RF00213                                            0213
*     IF XVD2WTOR='1'B THEN         /* YES, IS IT ALSO A WTOR        */
         TM    XVD2WTOR(RBSECPTR),B'00000010'                      0214
         BNO   @RF00214                                            0214
*       XVD2VALD='0'B;              /* YES, PARM LIST IS INVALID     */
         NI    XVD2VALD(RBSECPTR),B'11101111'                      0215
*     ELSE                          /* NO, COMPUTE LENGTH OF MLWTO 0216
*                                      PART                          */
*       DO;                         /* OF THE PARM LIST.             */
*                                                                  0216
         B     @RC00214                                            0216
@RF00214 DS    0H                                                  0217
*         /***********************************************************/
*         /*                                                         */
*         /* WAS QID SPECIFIED IN MSGTYPE FIELD?                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0217
*         IF XVD0QID='1'B THEN                                     0217
         TM    XVD0QID(RBSECPTR),B'00001000'                       0217
         BNO   @RF00217                                            0217
*           REG2=REG2+              /* YES, UP PTR PAST QID FIELD    */
*               LENGTH(WPLQID);                                    0218
         AL    REG2,@CF00088                                       0218
*         RFY                                                      0219
*           REG1 RSTD;              /* REG1 WILL BE USED AS LOOP   0219
*                                      COUNTER                       */
@RF00217 DS    0H                                                  0220
*         REG1=WPLLINES-            /* WE HAVE ALREADY PROCESSED ONE
*                                      LINE                          */
*             1;                    /* OF THE MLWTO                  */
         SLR   REG1,REG1                                           0220
         IC    REG1,WPLLINES(,REG2)                                0220
         BCTR  REG1,0                                              0220
*         REG2=REG2+                /* POINT AT 1ST OF THE EXTRA   0221
*                                      LINES                         */
*             LENGTH(WPLLTF)+LENGTH(WPLAREA)+LENGTH(WPLLINES);     0221
*                                                                  0221
         AL    REG2,@CF00084                                       0221
*         /***********************************************************/
*         /*                                                         */
*         /* LOOP OVER MULTI LINE TEXT                               */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0222
*         DO REG1=REG1 TO 1 BY-1;                                  0222
*                                                                  0222
         B     @DE00222                                            0222
@DL00222 DS    0H                                                  0223
*           /*********************************************************/
*           /*                                                       */
*           /* POINT TO NEXT LINE OF TEXT                            */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0223
*           REG2=REG2+WPLMLLEN;                                    0223
         SLR   @10,@10                                             0223
         IC    @10,WPLMLLEN(,REG2)                                 0223
         ALR   REG2,@10                                            0223
*         END;                                                     0224
         BCTR  REG1,0                                              0224
@DE00222 LTR   REG1,REG1                                           0224
         BP    @DL00222                                            0224
*         RFY                                                      0225
*           REG1 UNRSTD;            /* RELEASE REGISTER 1            */
*       END;                                                       0226
*                                                                  0226
*/********************************************************************/
*/*                                                                  */
*/* REG2 SHOULD NOW POINT TO FIRST BYTE AFTER THE WPL. POINT AT      */
*/* LAST BYTE OF THE WPL.                                            */
*/*                                                                  */
*/********************************************************************/
*                                                                  0227
*   REG2=REG2-1;                    /* BACK UP ONE BYTE              */
@RC00214 DS    0H                                                  0227
@RF00213 BCTR  REG2,0                                              0227
*/********************************************************************/
*/*                                                                  */
*/* CHECK IF LIST IS STILL VALID                                     */
*/*                                                                  */
*/********************************************************************/
*                                                                  0228
*   IF XVD2VALD='1'B THEN           /* VALID BIT NOT TURNED OFF      */
         TM    XVD2VALD(RBSECPTR),B'00010000'                      0228
         BNO   @RF00228                                            0228
*     DO;                           /* YES, CHECK FOR VALID ADDRESSES*/
*/********************************************************************/
*/*                                                                  */
*/* NOW REFER TO START AND END OF WPL BY MOVING FIRST AND LAST BYTE  */
*/* INTO XVD3. IF USER CAN NOT USE THE WPL THEN WE WILL GET A PROGRAM*/
*/* CHECK, IF WE PROGRAM CHECK ESTAE WILL GET CONTROL. IT WILL TURN  */
*/* XVD2VALD OFF AND WILL RETURN CONTROL TO VWTOCONT. WE SWITCH TO   */
*/* THE USERS KEY AND THEN REFERENCE THE PARM LIST.                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0230
*       /*************************************************************/
*       /*                                                           */
*       /* SWITCH TO THE USERS PROTECT KEY                           */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0230
*       PARMRTAD=ADDR(VWTOVALR);    /* RETRY AT VALCHK       @ZA05504*/
         L     @10,PARMPTR                                         0230
         LA    @15,VWTOVALR                                        0230
         ST    @15,PARMRTAD(,@10)                                  0230
*       PARMNDMP='1'B;              /* IND. NO-DUMP TO RECOVERY RTN
*                                                            @ZA19994*/
         OI    PARMNDMP(@10),B'00000100'                           0231
*       RFY                                                        0232
*         REG15 RSTD;                                              0232
*       GEN REFS(REG4,TCBRBP) SETS(REG15);                         0233
        USING TCB,REG4                                         YM0820
        MODESET EXTKEY=RBT234,WORKREG=15
        DROP  REG4                                             YM0820
*       REG15=XVPARMAD->REFCHAR;    /* REFERENCE THE FIRST CHAR IN 0234
*                                      WPL.                          */
         L     @10,XVPARMAD(,RBSECPTR)                             0234
         SLR   REG15,REG15                                         0234
         IC    REG15,REFCHAR(,@10)                                 0234
*       REG15=REG2->REFCHAR;        /* REFERENCE THE LAST CHAR IN THE
*                                      WPL                           */
         SLR   REG15,REG15                                         0235
         IC    REG15,REFCHAR(,REG2)                                0235
*       RFY                                                        0236
*         REG15 UNRSTD;             /* RELEASE 15                    */
*VWTOCONT:                                                         0237
*       ;                                                          0237
VWTOCONT DS    0H                                                  0238
*       GENERATE(MODESET  EXTKEY=SUPR)                             0238
*       REFS(REG4);                 /* SWITCH TO SUPERVISOR KEY      */
         MODESET  EXTKEY=SUPR
*       PARMRTAD=0;                 /* ZERO RETRY ADDRESS    @ZA05504*/
         SLR   @10,@10                                             0239
         L     @15,PARMPTR                                         0239
         ST    @10,PARMRTAD(,@15)                                  0239
*       PARMNDMP='0'B;              /* RESET DUMP IND.       @ZA19994*/
         NI    PARMNDMP(@15),B'11111011'                           0240
*       IF XVD2WTOR='1'B&           /* IS THIS A WTOR AND IS THE PARM
*                                      LIST                          */
*           XVPARMAD//4^=0          /* NOT ON A WORD BOUNDARY        */
*         THEN                                                     0241
         TM    XVD2WTOR(RBSECPTR),B'00000010'                      0241
         BNO   @RF00241                                            0241
         L     @00,XVPARMAD(,RBSECPTR)                             0241
         SRDA  @00,32                                              0241
         D     @00,@CF00084                                        0241
         CR    @00,@10                                             0241
         BE    @RF00241                                            0241
*         XVD2VALD='0'B;            /* YES, TURN OFF VALID BIT IN  0242
*                                      XSA. THE PARM LIST ISN'T    0242
*                                      VALID.                        */
         NI    XVD2VALD(RBSECPTR),B'11101111'                      0242
*     END;                          /* OF CHECK OF PARM LIST         */
@RF00241 DS    0H                                                  0244
*/******* END OF VALIDITY CHECK **************************************/
*/********************************************************************/
*/*                                                                  */
*/*  CHECK TO SEE IF THE PARAMETER LIST WAS FOUND TO BE INVALID.     */
*/*  IF SO TURN ON THE ABEND INDICATOR. IF LIST IS VALID CONTINUE    */
*/*  PROCESSING                                                      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0244
*   IF XVD2VALD='0'B THEN           /* IS VALID INDICATOR OFF MEANING
*                                      LIST IS NOT VALID             */
@RF00228 TM    XVD2VALD(RBSECPTR),B'00010000'                      0244
         BNZ   @RF00244                                            0244
*     XVD1PERR='1'B;                /* YES - SET ABEND ERROR       0245
*                                      INDICATOR                     */
         OI    XVD1PERR(RBSECPTR),B'00000001'                      0245
*   ELSE                            /* PARM LIST WAS VALID. PROCESS
*                                      IT                            */
*     DO;                                                          0246
*                                                                  0246
         B     @RC00244                                            0246
@RF00244 DS    0H                                                  0247
*/********************************************************************/
*/*                                                                  */
*/*  TAKE THE INSTALLATION EXIT                                      */
*/*                                                                  */
*/********************************************************************/
*/*** START OF USEREXIT **********************************************/
*/********************************************************************/
*/*                                                                  */
*/*   USEREXIT - SET UP AND TAKE INSTALLATION WTO EXIT               */
*/*                                                                  */
*/*  INPUT -                                                         */
*/*   REG2 POINTS AT THE LAST BYTE IN THE WQE                        */
*/*    REG 6 POINTS AT THE BEGINNING OF THE MESSAGE PART OF THE WPL  */
*/*    REG 8 POINTS AT THE FLAGS PART OF THE WPL.                    */
*/*                                                                  */
*/*  OUTPUT -                                                        */
*/*    XVRCSAVE AND XVDESCD CONTAIN THE ROUTE AND DESCRIPTOR CODES   */
*/*    BE USED IN THE WQE.                                           */
*/*    XVMSGTYP IS FILLED FROM WPL IF MSGTYP WAS SPECIFIED.          */
*/*    REGS 2 AND 8 ARE NO LONGER NEEDED.                            */
*/*    XVD2DELW IS ON IF THE MESSAGE IS NOT TO GO TO THE CONSOLE BUT */
*/*    TO HARDCOPY ONLY.                                             */
*/*                                                                  */
*/********************************************************************/
*/********************************************************************/
*/*                                                                  */
*/* CHECK THAT THIS IS NOT A CONNECTING MLWTO, CONNECTING MLWTOS DO  */
*/* NOT GET SENT TO THE INSTALLATION EXIT UNLESS ISSUED      @YM7297P*/
*/* FROM A PROBLEM PROGRAM                                   @YM7297P*/
*/*                                                          @YM7297P*/
*/* THE INSTALLATION USER EXIT WILL BE TAKEN FOR ANY OF      @YM7297P*/
*/* THESE THREE SITUATIONS:                                  @YM7297P*/
*/*                                                          @YM7297P*/
*/*    1. THE WTO IS NOT A MULTI-LINE REQUEST                @YM7297P*/
*/*         OR                                               @YM7297P*/
*/*    2. THE MLWTO IS NOT A CONNECTING MLWTO REQUEST        @YM7297P*/
*/*         OR                                               @YM7297P*/
*/*    3. THE CONNECTING MLWTO REQUEST IS ISSUED FROM A      @YM7297P*/
*/*           PROBLEM PROGRAM                                @YM7297P*/
*/*                                                          @YM7297P*/
*/* THE ONLY OTHER SITUATION IS IF A CONNECTING MLWTO IS     @YM7297P*/
*/* ISSUED FROM SUPERVISOR STATE                             @YM7297P*/
*/*      FOR THIS CASE, DO NOT TAKE THE USER EXIT            @YM7297P*/
*/*                                                          @YM7297P*/
*/*                                                                  */
*/********************************************************************/
*                                                                  0247
*       IF WPLMCSFJ^='1'B×          /* SITUATION 1. ABOVE    @YM3471P*/
*           XVWQEIDA=0×             /* SITUATION 2. ABOVE    @YM7297P*/
*           XVD1PP='1'B THEN        /* SITUATION 3. ABOVE    @YM7297P*/
         TM    WPLMCSFJ(REG6),B'01000000'                          0247
         BNO   @RT00247                                            0247
         ICM   @10,7,XVWQEIDA(RBSECPTR)                            0247
         BZ    @RT00247                                            0247
         TM    XVD1PP(RBSECPTR),B'00000100'                        0247
         BNO   @RF00247                                            0247
@RT00247 DS    0H                                                  0248
*         DO;                       /* NO, THIS IS NOT A CONNECTING
*                                      MLWTO UNLESS ISSUED FROM A  0248
*                                      PROBLEM PROGRAM       @YM7297P*/
*/********************************************************************/
*/*                                                                  */
*/* CHECK IF WE SHOULD USE THE DEFAULTS FOR ROUTE & DESC CODES BY    */
*/* CHECKING IF THIS IS AN OLD STYLE MESSAGE WHICH HAS NO MCS FLAGS  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0249
*           IF WPLMCSF=0 THEN       /* ARE THERE NO MCS FLAGS IN THE
*                                      WPL                           */
         LH    @10,WPLMCSF(,REG6)                                  0249
         N     @10,@CF03329                                        0249
         LTR   @10,@10                                             0249
         BNZ   @RF00249                                            0249
*             DO;                   /* YES, USE DEFAULTS             */
*               XVRCSAVE=UCMOWTOR;  /* GET DEFAULT ROUTE CODES FROM
*                                      UCM                           */
         L     @10,UCMBASPT(,REG3)                                 0251
         AL    @10,@CF03336                                        0251
         L     @10,UCMMCSPT(,@10)                                  0251
         MVC   XVRCSAVE(2,RBSECPTR),UCMOWTOR(@10)                  0251
*               XVDESCD='2000'X;    /* DESC CODE DEFAULT = EVENTUAL
*                                      ACTION REQUIRED MESSAGE       */
         MVC   XVDESCD(2,RBSECPTR),@CB03252                        0252
*               XVD2RDC='1'B;       /* R/D CODES ARE PRESENT         */
         OI    XVD2RDC(RBSECPTR),B'01000000'                       0253
*             END;                                                 0254
*           ELSE                    /* NO, CHECK IF R/D CODES PRESENT*/
*             IF XVD2RDC='1'B THEN  /* WERE R/D CODES SUPPLIED IN WPL*/
         B     @RC00249                                            0255
@RF00249 TM    XVD2RDC(RBSECPTR),B'01000000'                       0255
         BNO   @RF00255                                            0255
*               DO;                 /* PICK THEM UP                  */
*                 XVRCSAVE=WPLROUT;                                0257
         MVC   XVRCSAVE(2,RBSECPTR),WPLROUT(REG8)                  0257
*                 XVDESCD=WPLDESC;                                 0258
         MVC   XVDESCD(2,RBSECPTR),WPLDESC(REG8)                   0258
*               END;                                               0259
*                                                                  0259
*           /*********************************************************/
*           /*                                                       */
*           /* IF NO R/D CODES SUPPLIED AND DEFULAT CODES WEREN'T    */
*           /* USED THEN R/D CODES ARE ZERO FROM INITIALIZATION.     */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0260
*/********************************************************************/
*/*                                                                  */
*/* PICK UP THE MSGTYPE FIELD FROM THE WPL. THIS IS DONE SO THAT     */
*/* REG 8 CAN BE RELEASED. THE ROUTE CODES, DESC CODES AND MSGTYPE   */
*/* WILL THUS BE ALL STORED IN XVRDMSV.                              */
*/*                                                                  */
*/********************************************************************/
*                                                                  0260
*           IF XVD2MSGT='1'B THEN   /* WAS MSGTYP SPECIFED?          */
@RF00255 DS    0H                                                  0260
@RC00249 TM    XVD2MSGT(RBSECPTR),B'00100000'                      0260
         BNO   @RF00260                                            0260
*             XVMSGTYP=WPLMSGTY;    /* YES, MOVE IN MSGTYP FIELD.    */
         MVC   XVMSGTYP(2,RBSECPTR),WPLMSGTY(REG8)                 0261
*           RFY                                                    0262
*             REG8 UNRSTD;          /* RELEASE REG 8                 */
@RF00260 DS    0H                                                  0263
*/********************************************************************/
*/*                                                                  */
*/* CHECK FOR AN INTERNAL MESSAGE (ONE THAT IS AUTHORIZED AND HAS ANY*/
*/* MCSFLAGS(2-8) ON). IF IT IS AN INTERNAL MESSAGE THEN SKIP THE    */
*/* INSTALLATION EXIT. CHECK ALSO THAT THE MSG LENGTH IS GREATER THAN*/
*/* ZERO (THAT XVMSGLGH > 4 ).                                       */
*/*                                                                  */
*/********************************************************************/
*                                                                  0263
*           IF^(XVD1AUTH='1'B&      /* DO WE NOT HAVE THE FOLLOWING:
*                                      ( IS THE USER AUTHORIZED AND
*                                      ARE ANY SYSTEM RELATED      0263
*                                      MCSFLAGS BITS TURNED ON (BITS
*                                      2 TO 8) ) AND THAT THE TEXT 0263
*                                      LENGTH IS > FOUR              */
*               WPLMCSF1(2:8)^='0000000'B)&XVMSGLGH>4 THEN         0263
         TM    XVD1AUTH(RBSECPTR),B'00000010'                      0263
         BNO   @GL00007                                            0263
         TM    WPLMCSF1(REG6),B'01111111'                          0263
         BNZ   @RF00263                                            0263
@GL00007 LH    @10,XVMSGLGH(,RBSECPTR)                             0263
         C     @10,@CF00084                                        0263
         BNH   @RF00263                                            0263
*             DO;                   /* YES, THEN MESSAGE IS NOT A  0264
*                                      SYSTEM INTERNALLY GENERATED 0264
*                                      ONE. TAKE EXIT                */
*                                                                  0264
*               /*****************************************************/
*               /*                                                   */
*               /* FILL IN THS INSTALLATION EXIT'S PARAMETER LIST.   */
*               /* MOVE IN THE MESSAGE FROM THE WPL                  */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0265
*               USERTEXT=WPLTXT(1:XVMSGLGH-4);                     0265
         MVI   USERTEXT+1,C' '                                     0265
         MVC   USERTEXT+2(126),USERTEXT+1                          0265
         SL    @10,@CF01082                                        0265
         EX    @10,@SM03337                                        0265
*               USERROUT=0;         /* INIT THE ROUTE AND DESC CODES
*                                      TO                            */
         SLR   @10,@10                                             0266
         ST    @10,USERROUT                                        0266
*               USERDESC=0;         /* ZERO.                         */
         ST    @10,USERDESC                                        0267
*               USERRC=XVRCSAVE;    /* PUT THE ROUTE/DESC CODES INTO
*                                      THE                           */
         MVC   USERRC(2),XVRCSAVE(RBSECPTR)                        0268
*               USERDC=XVDESCD;     /* PARM LIST FOR THE USER EXIT   */
*                                                                  0269
         MVC   USERDC(2),XVDESCD(RBSECPTR)                         0269
*               /*****************************************************/
*               /*                                                   */
*               /* SET UP FOOT PRINT AROUND USER EXIT                */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0270
*               STM(REG0,REG15,RECREGS);/* SAVE CURRENT REGS @ZA13440*/
         STM   REG0,REG15,RECREGS                                  0270
*               PARMFTPT=FTUSERX;   /* INSALLATION'S EXIT WAS CALLED */
         L     @08,PARMPTR                                         0271
         MVI   PARMFTPT(@08),X'03'                                 0271
*               PARMCLAD=0;         /* NO CLEAN UP ROUTINE   @ZA13440*/
         ST    @10,PARMCLAD(,@08)                                  0272
*               PARMRTAD=0;         /* NO RETRY ADDR         @ZA13440*/
*                                                                  0273
         ST    @10,PARMRTAD(,@08)                                  0273
*               /*****************************************************/
*               /*                                                   */
*               /* CALL INSTALLATION EXIT ROUTINE                    */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0274
*               CALL IEECVXIT(USERPARM);                           0274
*                                                                  0274
         LA    @10,USERPARM                                        0274
         ST    @10,@AL00001                                        0274
         L     @15,@CV00207                                        0274
         LA    @01,@AL00001                                        0274
         BALR  @14,@15                                             0274
*               /*****************************************************/
*               /*                                                   */
*               /* RESTORE THE FOOTPRINTS AFTER THE EXIT ROUTINE     */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0275
*               PARMFTPT=FTAFUX;                                   0275
         L     @10,PARMPTR                                         0275
         MVI   PARMFTPT(@10),X'04'                                 0275
*               XVNEWRC=USERRC;     /* PICK UP CHANGED ROUTE/DESC  0276
*                                      CODES                         */
         MVC   XVNEWRC(2,RBSECPTR),USERRC                          0276
*               XVNEWDC=USERDC;                                    0277
*                                                                  0277
         MVC   XVNEWDC(2,RBSECPTR),USERDC                          0277
*/********************************************************************/
*/*                                                                  */
*/* CHECK IF THE ROUTE CODES WERE CHANGED.                           */
*/*                                                                  */
*/********************************************************************/
*                                                                  0278
*               IF XVRCSAVE^=       /* WERE ROUTE CODES CHANGED?     */
*                   XVNEWRC THEN                                   0278
         CLC   XVRCSAVE(2,RBSECPTR),XVNEWRC(RBSECPTR)              0278
         BE    @RF00278                                            0278
*                 DO;               /* YES, PROCESS CHANGED ROUTE  0279
*                                      CODE                          */
*                   XVD2QFHC='1'B;  /* INDICATE MSG IS TO BE QUEUED
*                                      FOR HC                        */
         OI    XVD2QFHC(RBSECPTR),B'00000001'                      0280
*/********************************************************************/
*/*                                                                  */
*/* CHECK IF ROUTE CODE WAS CHANGED TO ZERO, INDICATING THAT THIS    */
*/*  MESSAGE SHOULDN'T GO TO THE CONSOLE.                            */
*/*                                                                  */
*/********************************************************************/
*                                                                  0281
*                   IF XVNEWRC=0 THEN                              0281
*                                                                  0281
         LH    @10,XVNEWRC(,RBSECPTR)                              0281
         N     @10,@CF03329                                        0281
         LTR   @10,@10                                             0281
         BNZ   @RF00281                                            0281
*/********************************************************************/
*/*                                                                  */
*/* CHECK IF THIS IS A WTOR. IF SO THEN IGNORE REQUEST TO DELETE     */
*/* MESSAGE (ZERO ROUTE CODE. IF WTO, DELETE MESSAGE. SEND JUST TO   */
*/* HARDCOPY.                                                        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0282
*                     IF XVD2WTOR='1'B THEN                        0282
         TM    XVD2WTOR(RBSECPTR),B'00000010'                      0282
         BNO   @RF00282                                            0282
*                       DO;         /* PUT IN WTOR ROUTE CODES       */
*                                                                  0283
*                         /*******************************************/
*                         /*                                         */
*                         /* ROUTE WTOR TO MASTER CONSOLE            */
*                         /*                                         */
*                         /*******************************************/
*                                                                  0284
*                         XVRCSAVE='8000'X;                        0284
         MVC   XVRCSAVE(2,RBSECPTR),@CB03254                       0284
*                         XVD2RDC='1'B;/* TURN ON ROUTE CODES PRESENT
*                                      FLAGS                         */
         OI    XVD2RDC(RBSECPTR),B'01000000'                       0285
*                       END;                                       0286
*                     ELSE          /* NOT A WTOR. INDICATE SEND MSG
*                                      TO HARDCOPY ONLY.             */
*                       XVD2DELW='1'B;                             0287
*                                                                  0287
         B     @RC00282                                            0287
@RF00282 OI    XVD2DELW(RBSECPTR),B'00001000'                      0287
*/********************************************************************/
*/*                                                                  */
*/* NO, THE ROUTE CODE WASNT SET TO ZERO, BUT IT IS CHANGED. PICK    */
*/* UP THE NEW ROUTE CODES FOR USE LATER IN BUILDING THE WQE.        */
*/* ALSO PASS THE NEW ROUTE CODES TO WTP IF ROUTE CODE 11 IS SET.    */
*/*                                                                  */
*/********************************************************************/
*                                                                  0288
*                   ELSE                                           0288
*                     XVRCSAVE=XVNEWRC;/* MOVE NEW ROUTECODES TO SAFE
*                                      PLACE                         */
         B     @RC00281                                            0288
@RF00281 MVC   XVRCSAVE(2,RBSECPTR),XVNEWRC(RBSECPTR)              0288
*                 END;              /* OF PROCESSING CHANGED ROUTE 0289
*                                      CODES                         */
@RC00281 DS    0H                                                  0290
*               IF XVDESCD^=XVNEWDC THEN/* WERE DESC. CODE CHANGED 0290
*                                                            @ZA05801*/
@RF00278 CLC   XVDESCD(2,RBSECPTR),XVNEWDC(RBSECPTR)               0290
         BE    @RF00290                                            0290
*                 DO;               /* SAVE DESC CODES       @ZA05801*/
*                   XVDESCD=XVNEWDC;/* SAVE USER CHANGES     @ZA05801*/
         MVC   XVDESCD(2,RBSECPTR),XVNEWDC(RBSECPTR)               0292
*                   XVD2QFHC='1'B;  /* INDICATE HARDCOPY MSG @ZA05801*/
         OI    XVD2QFHC(RBSECPTR),B'00000001'                      0293
*                 END;                                             0294
*             END;                  /* OF PROCESSING NON-INTERNAL  0295
*                                      MSG-S                         */
@RF00290 DS    0H                                                  0296
*         END;                      /* OF PROCESSING NON-CONNENCTING
*                                      MSGS                          */
@RF00263 DS    0H                                                  0297
*/********************************************************************/
*/*                                                                  */
*/* AT THIS POINT XVRCSAVE AND XVDESCD CONTAIN THE ROUTE AND         */
*/* DESCRIPTOR CODES AND MSGTYP FIELD TO BE USED BY THIS MESSAGE.    */
*/*                                                                  */
*/********************************************************************/
*                                                                  0297
*       RFY                                                        0297
*         REG2 UNRSTD;              /* RELEASE PTR TO LAST BYTE IN 0297
*                                      WPL                           */
@RF00247 DS    0H                                                  0298
*/********************************************************************/
*/*                                                                  */
*/***** RE-BASE WPL TO BE THE XSA. FUTURE REFERENCES OF      @ZA14991*/
*/***** ROUT AND DESC CODES IN WPL WILL ACTUALLY REFERENCE   @ZA14991*/
*/***** THE XSA. THIS WAS DONE BECAUSE THE USER EXIT COULD   @ZA14991*/
*/***** HAVE CHANGED THE ROUTE AND DESCRIPTOR CODES. THESE   @ZA14991*/
*/***** ARE SAVED IN THE XSA SO AFTER THIS POINT THE CHANGED @ZA14991*/
*/***** VALUES WILL BE REFERENCED INSTEAD OF THE VALUES      @ZA14991*/
*/***** SPECIFIED IN THE WPL.                                @ZA14991*/
*/*                                                                  */
*/***** NOTE - IF THE ORDERING OF THE SEGMENTS OF THIS       @ZA14991*/
*/*****        MODULE ARE CHANGED, THEN THIS RESPECIFY MAY   @ZA14991*/
*/*****        CAUSE THE COMPILER TO REFERENCE THE WRONG     @ZA14991*/
*/*****        AREA FOR THE WPL.                             @ZA14991*/
*/*                                                                  */
*/********************************************************************/
*                                                                  0298
*       RFY                                                        0298
*         WPLFLGS BASED(ADDR(XVRDMSV));                            0298
*                                                                  0298
*/***** END OF USER EXIT SEGMENT *************************************/
*/********************************************************************/
*/*                                                                  */
*/*  SEE IF A MULTI-LINE WTO WAS ISSUED. IF SO CALL IEAVMWTO         */
*/*                                                                  */
*/********************************************************************/
*                                                                  0299
*       IF WPLMCSFJ='1'B THEN       /* IS MULTI-LINE BIT SET IN WPL  */
         TM    WPLMCSFJ(REG6),B'01000000'                          0299
         BNO   @RF00299                                            0299
*         DO;                       /* YES, GO TO PROCESS MULTI-LINE */
*           RFY                                                    0301
*             REG10 RSTD;                                          0301
*           PARMFTPT=FTMLWTO;       /* START OF MLWTO PROCESSING     */
         L     @08,PARMPTR                                         0302
         MVI   PARMFTPT(@08),X'05'                                 0302
*           PARMRTAD=0;             /* DON'T RETRY. MLWTO DETECTS THE
*                                      ERROR                         */
         SLR   @02,@02                                             0303
         ST    @02,PARMRTAD(,@08)                                  0303
*           REG6=XVPARMAD;          /* GET PTR TO USERS PARM LIST    */
         L     REG6,XVPARMAD(,RBSECPTR)                            0304
*           REG10=UCMBASPT;         /* SET REG 10 POINTING AT THE UCM*/
         L     REG10,UCMBASPT(,REG3)                               0305
*           CALL IEAVMWTO;          /* PROCESS MULTI-LINE            */
         L     @15,@CV00206                                        0306
         BALR  @14,@15                                             0306
*           PARMFTPT=FTSWTO;        /* START OF WTO BLOCK PROCESSING */
         L     @08,PARMPTR                                         0307
         MVI   PARMFTPT(@08),X'06'                                 0307
*           RFY                                                    0308
*             REG10 UNRSTD;                                        0308
*         END;                                                     0309
*       ELSE                        /* NO, SINGLE LINE SPECIFIED     */
*/********************************************************************/
*/*                                                                  */
*/* CHECK TO SEE IF PARM LIST LENGTH IS LESS THAN OR EQUAL TO FOUR.  */
*/* IF SO THEN THE MSGLENGTH IS ZERO. THIS IS AN ABEND               */
*/* SITUATION FOR WTORS.                                             */
*/*                                                                  */
*/********************************************************************/
*                                                                  0310
*         IF XVMSGLGH<=4 THEN       /* DOES LENGTH SHOW ZERO MSG   0310
*                                      LENGTH                        */
         B     @RC00299                                            0310
@RF00299 LH    @10,XVMSGLGH(,RBSECPTR)                             0310
         C     @10,@CF00084                                        0310
         BH    @RF00310                                            0310
*/********************************************************************/
*/*                                                                  */
*/* CHECK FOR WTOR. IF WTOR, THEN  SET ABEND BIT. IF WTO, THEN  SET  */
*/* THE NO MESSAGE BIT ON (XVD2ZERO).                                */
*/*                                                                  */
*/********************************************************************/
*                                                                  0311
*           IF XVD2WTOR='1'B THEN   /* IS THIS A WTOR REQUEST        */
         TM    XVD2WTOR(RBSECPTR),B'00000010'                      0311
         BNO   @RF00311                                            0311
*             XVD1PERR='1'B;        /* YES, SET ABEND ERROR SITUATION
*                                      BIT                           */
         OI    XVD1PERR(RBSECPTR),B'00000001'                      0312
*           ELSE                    /* NO, INDICATE RETURN ZERO MSG
*                                      ID TO                         */
*             XVD2ZERO='1'B;        /* THE USER                      */
         B     @RC00311                                            0313
@RF00311 OI    XVD2ZERO(RBSECPTR),B'00000100'                      0313
*/********************************************************************/
*/*                                                                  */
*/* MESSAGE LENGTH WAS NOT ZERO. PROCESS GOOD MESSAGE                */
*/*                                                                  */
*/********************************************************************/
*                                                                  0314
*         ELSE                                                     0314
*           DO;                                                    0314
*                                                                  0314
         B     @RC00310                                            0314
@RF00310 DS    0H                                                  0315
*/********************************************************************/
*/*                                                                  */
*/* CHECK FOR WRITE TO PROGRAMMER (ROUTE CODE 11). IF WTP WAS SPECI- */
*/* FIED THEN CALL WTP. WTP WILL RETURN CONTROL TO VWTO.             */
*/*  ON RETURN FROM WTP THE XVD0USER BIT WILL BE ON IF THE MESSAGE   */
*/* WAS A WTP MESSAGE ONLY.  THIS MEANS THAT THERE IS NOTHING FOR    */
*/*  VWTO TO DO.                                                     */
*/*                                                                  */
*/********************************************************************/
*                                                                  0315
*             XVD0USER='0'B;        /* INSURE THAT RETURN BIT FROM 0315
*                                      WTP IS SET TO INDICATE      0315
*                                      CONTINUE PROCESSING           */
         NI    XVD0USER(RBSECPTR),B'11111101'                      0315
*             IF XVD2RDC='1'B&      /* WERE ROUTE CODES SPECIFIED    */
*                 WPLROUTK='1'B THEN/* AND WTP SPECIFIED             */
         TM    XVD2RDC(RBSECPTR),B'01000000'                       0316
         BNO   @RF00316                                            0316
         TM    WPLROUTK+108(RBSECPTR),B'00100000'                  0316
         BNO   @RF00316                                            0316
*               DO;                 /* GO TO WTP. WTP WILL RETURN TO
*                                      US                            */
*                 RFY                                              0318
*                   REG10 RSTD;                                    0318
*                 REG10=UCMBASPT;   /* SET UP PTR TO UCM FOR WTP     */
         L     REG10,UCMBASPT(,REG3)                               0319
*                 CALL IGC0203E;    /* CALL ON WTP                   */
         L     @15,@CV00208                                        0320
         BALR  @14,@15                                             0320
*                 RFY                                              0321
*                   REG10 UNRSTD;                                  0321
*               END;                                               0322
*                                                                  0322
*             /*******************************************************/
*             /*                                                     */
*             /* CHECK IF WTP FOUND THAT THERE WAS NO MORE PROCESSING*/
*             /* FOR US TO DO WITH THIS MESSAGE. IF SO SET XVD2ZERO  */
*             /* ON SO THAT A ZERO MESSAGE ID GETS PASSED TO THE     */
*             /* USER.                                               */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0323
*             IF XVD0USER='1'B THEN /* DID RETURN TO USER BIT GET SET
*                                      BY THE WTP ROUTINE.           */
@RF00316 TM    XVD0USER(RBSECPTR),B'00000010'                      0323
         BNO   @RF00323                                            0323
*               XVD2ZERO='1'B;      /* YES. INDICATE ZERO MSG ID TO
*                                      BE RETURNED TO CALLER AND SKIP
*                                      THE REST OF THE PROCESSING.   */
         OI    XVD2ZERO(RBSECPTR),B'00000100'                      0324
*             ELSE                  /* NO. PROCESS THE MESSAGE       */
*               DO;                                                0325
*                                                                  0325
         B     @RC00323                                            0325
@RF00323 DS    0H                                                  0326
*/********************************************************************/
*/*                                                                  */
*/* SET UP NEEDED LOCKS AND FRR                                      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0326
*                 CALL SETLOCK;                                    0326
*                                                                  0326
         BAL   @14,SETLOCK                                         0326
*                 /***************************************************/
*                 /*                                                 */
*                 /* SET UP THE FOOTPRINT TO COVER THE BUILDING OF   */
*                 /* THE ORE AND THE WQES. IF THER IS A PROBLEM THEN */
*                 /* VWTOCLNP WILL ATTEMPT TO CLEAN UP THE CONTROL   */
*                 /* BLOCKS.                                         */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0327
*                 PARMFTPT=FTCTLBLK;/* START OF CONTROL BLOCK      0327
*                                      PROCESSING                    */
         L     @10,PARMPTR                                         0327
         MVI   PARMFTPT(@10),X'07'                                 0327
*                 PARMCLAD=ADDR(VWTOCLNP);/* ADDRESS OF CLEAN UP   0328
*                                      ROUTINE                       */
         LA    @08,VWTOCLNP                                        0328
         ST    @08,PARMCLAD(,@10)                                  0328
*/********************************************************************/
*/*                                                                  */
*/* GET THE NEEDED CONTROL BLOCKS                                    */
*/*                                                                  */
*/********************************************************************/
*/*** START OF GETBLKS  **********************************************/
*/*                                                                  */
*/*   GETBLKS - GET AN ORE AND/OR A WQE                              */
*/*                                                                  */
*/*   INPUT - XVD2WTOR IF ON INDICATES AN ORE AND WQE ARE NEEDED.    */
*/*           IF OFF THEN JUST A WQE IS NEEDED.                      */
*/*           XVD1PRIV INDICATES WHETHER THIS USER IS A PRIVILEGED   */
*/*           TASK                                                   */
*/*                                                                  */
*/*   OUTPUT - XVOREAD POINTS AT THE ZEROED ORE                      */
*/*            XVWQEAD POINTS AT THE ZEROED WQE                      */
*/*            XVD1PERR IS ON IF CORE WAS NOT AVAILABLE.             */
*/*                                                                  */
*/********************************************************************/
*/*                                                                  */
*/*  TURN OFF DO LOOP AND ECB INDICATORS                             */
*/*                                                                  */
*/********************************************************************/
*                                                                  0329
*                 XVD1ALDN='0'B;    /* INIT TO NOT ALL DONE          */
         NI    XVD1ALDN(RBSECPTR),B'11011111'                      0329
*                 XVD0WWB='0'B;     /* INDICATE NO WTO WAIT BLOCK  0330
*                                      OBTAINED                      */
         NI    XVD0WWB(RBSECPTR),B'11111011'                       0330
*/********************************************************************/
*/*                                                                  */
*/*  CHECK FOR A WTOR. IF SO INDICATE THAT AN ORE IS NEEDED FIRST    */
*/*                                                                  */
*/********************************************************************/
*                                                                  0331
*                 IF XVD2WTOR='1'B THEN/* IS THIS REQUEST A WTOR     */
         TM    XVD2WTOR(RBSECPTR),B'00000010'                      0331
         BNO   @RF00331                                            0331
*                   DO;             /* YES                           */
*                     XVD0NORE='1'B;/* GET THE ORE FIRST             */
*                     XVD0NWQE='0'B;/* THEN GET THE WQE              */
         OI    XVD0NORE(RBSECPTR),B'00010000'                      0334
         NI    XVD0NWQE(RBSECPTR),B'11011111'                      0334
*                   END;                                           0335
*                 ELSE              /* NO, THIS IS A WTO             */
*                   DO;                                            0336
         B     @RC00331                                            0336
@RF00331 DS    0H                                                  0337
*                     XVD0NORE='0'B;/* WE DONT NEED AN ORE           */
*                     XVD0NWQE='1'B;/* BUT WE DO NEED A WQE          */
         OI    XVD0NWQE(RBSECPTR),B'00100000'                      0338
         NI    XVD0NORE(RBSECPTR),B'11101111'                      0338
*                   END;                                           0339
*                                                                  0339
*/********************************************************************/
*/*                                                                  */
*/*  WE WILL ATTEMPT TO GET A WQE OR AN ORE, A REPLY ID AND A WQE,   */
*/*  WE WILL LOOP UNTIL ALL NEEDED BLOCKS HAVE BEEN OBTAINED.        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0340
*                 DO WHILE(XVD1ALDN='0'B);/* LOOP UNTIL WE ARE DONE  */
@RC00331 B     @DE00340                                            0340
@DL00340 DS    0H                                                  0341
*/********************************************************************/
*/*                                                                  */
*/*  CHECK IF WE STILL NEED TO GET AN ORE. IF SO GET ONE             */
*/*                                                                  */
*/********************************************************************/
*                                                                  0341
*                   IF XVD0NORE='1'B THEN                          0341
*                                                                  0341
         TM    XVD0NORE(RBSECPTR),B'00010000'                      0341
         BNO   @RF00341                                            0341
*/********************************************************************/
*/*                                                                  */
*/*  CHECK IF AN ORE IS AVAILABLE                                    */
*/*                                                                  */
*/********************************************************************/
*                                                                  0342
*                     IF UCMRQNR<UCMRQLM×/* IS THE NUMBER ORES LESS
*                                      THAN LIMIT                    */
*                         XVD1PRIV='1'B THEN/* OR IS THE USER A    0342
*                                      PRIVILEGED TASK               */
         L     @10,UCMBASPT(,REG3)                                 0342
         LH    @08,UCMRQNR(,@10)                                   0342
         SLR   @02,@02                                             0342
         IC    @02,UCMRQLM(,@10)                                   0342
         CR    @08,@02                                             0342
         BL    @RT00342                                            0342
         TM    XVD1PRIV(RBSECPTR),B'10000000'                      0342
         BNO   @RF00342                                            0342
@RT00342 DS    0H                                                  0343
*                       DO;         /* YES, GET AN ORE AND ID        */
*                         CALL VWTOGETB(2);/* GET AN ORE AND ZERO IT */
         LA    @01,@AL00344                                        0344
         BAL   @14,VWTOGETB                                        0344
*/********************************************************************/
*/*                                                                  */
*/* CHECK TO SEE IF WE SUCCESSFULLY GOT AN ORE. IF NOT THEN SET      */
*/* THE ERROR FLAG AND SET OTHER FLAGS SO THAT WE GET OUT OF         */
*/* GET CONTROL BLOCKS LOOP.                                         */
*/*                                                                  */
*/********************************************************************/
*                                                                  0345
*                         IF XVOREAD=1 THEN/* WAS ERROR CONDITION SET
*                                      BY VWTOGETB                   */
         CLC   XVOREAD(4,RBSECPTR),@CF00062                        0345
         BNE   @RF00345                                            0345
*                           DO;     /* YES. SET FLAGS TO GET OUT OF
*                                      LOOP                          */
*                             XVD1ALDN='1'B;/* INDICATE THAT LOOP IS
*                                      OVER                          */
*                             XVD1PERR='1'B;/* INDICATE AN ERROR   0348
*                                      CONDITION FOUND               */
         OI    XVD1ALDN(RBSECPTR),B'00100001'                      0348
*                             XVD0RPFD='1'B;/* SET SO THAT WE SKIP TO
*                                      THE WQE TEST AND THEN OUT.    */
         OI    XVD0RPFD(RBSECPTR),B'01000000'                      0349
*                           END;                                   0350
*                         ELSE      /* AN ORE WAS OBTAINED. GET AN ID*/
*                           DO;                                    0351
*                                                                  0351
         B     @RC00345                                            0351
@RF00345 DS    0H                                                  0352
*/********************************************************************/
*/*  GETID - GET A REPLY ID SEGMENT                                  */
*/*                                                                  */
*/*  FUNCTION - TO OBTAIN ONE OF THE 100 REPLY IDS AND INSERT THE    */
*/*     ID IN THE ORE.                                               */
*/*                                                                  */
*/*  INPUT - XVOREAD PTS AT AN ORE.                                  */
*/*          UCMRPYL CONTAINS THE NEXT REPLY ID IN UCMRPYI TO TRY.   */
*/*          UCMRPYI IS THE BIT MAP OF AVAILABLE IDS                 */
*/*                                                                  */
*/*  OUTPUT - XVD0RPFD IS ON IF ID WAS STORED IN THE ORE             */
*/*           XVD0RPFD IS OFF IF ID WAS NOT AVAILABLE                */
*/*                                                                  */
*/********************************************************************/
*                                                                  0352
*                             XVD0RPFD='0'B;/* DON'T TURN REPLY FOUND
*                                      ON UNTIL ID IS AVAILABLE      */
         NI    XVD0RPFD(RBSECPTR),B'10111111'                      0352
*                             STARTID=UCMRPYL;/* INIT THE STARTING ID
*                                                            @ZA12401*/
         L     @10,UCMBASPT(,REG3)                                 0353
         L     @10,UCMEILPT(,@10)                                  0353
         MVC   STARTID(1),UCMRPYL(@10)                             0353
*                             DO UNTIL(XVD0RPFD='1'B×/* DO UNTIL AN
*                                      ID IS FOUND           @ZA12401*/
*                                   UCMRPYL=STARTID);/* OR ALL THE 0354
*                                      ID'S HAVE BEEN SEARCHED     0354
*                                                            @ZA12401*/
@DL00354 DS    0H                                                  0355
*                               RFY                                0355
*                                (REG1,                            0355
*                                 REG2) RSTD;                      0355
*                                                                  0355
*/********************************************************************/
*/*                                                                  */
*/* WE ADD ONE IN THE FOLLOWING TWO INSTRUCTIONS IN ORDER TO CONVERT */
*/* THE UCMRPYL FROM ZERO ORIGIN INDEX TO A ONE ORIGIN INDEX VALUE   */
*/* USED BY PL/S II.                                                 */
*/*                                                                  */
*/********************************************************************/
*                                                                  0356
*                               REG1=UCMRPYL/8+1;/* DEVELOP BYTE   0356
*                                      OFFSET INTO UCMRPYI           */
         LA    @10,1                                               0356
         L     @08,UCMBASPT(,REG3)                                 0356
         L     @15,UCMEILPT(,@08)                                  0356
         SLR   @14,@14                                             0356
         IC    @14,UCMRPYL(,@15)                                   0356
         LR    REG1,@14                                            0356
         SRL   REG1,3                                              0356
         ALR   REG1,@10                                            0356
*                               REG2=UCMRPYL//8+1;/* DEVELOP BYTE  0357
*                                      OFFSET INTO BIT MAP           */
         ST    @15,@TF00001                                        0357
         SRDA  @14,32                                              0357
         D     @14,@CF00061                                        0357
         ALR   @14,@10                                             0357
         LR    REG2,@14                                            0357
*/********************************************************************/
*/*                                                                  */
*/* CHECK IF THE UCMRPYL-TH BIT IS OFF. IF SO TURN IT ON AND CONVERT */
*/* THE ID.                                                          */
*/*                                                                  */
*/********************************************************************/
*                                                                  0358
*                               IF(UCMRPYI(REG1)&IDMAP(REG2))^=IDMAP(
*                                   REG2) THEN                     0358
         LR    @10,@08                                             0358
         ALR   @10,REG1                                            0358
         MVC   @TS00001(1),UCMRPYI-1(@10)                          0358
         LA    @10,IDMAP-1(REG2)                                   0358
         NC    @TS00001(1),0(@10)                                  0358
         LA    @10,IDMAP-1(REG2)                                   0358
         CLC   @TS00001(1),0(@10)                                  0358
         BE    @RF00358                                            0358
*                                 DO;/* YES, ID IS AVAILABLE         */
*                                   CVD(CURRID,CVDAREA);/* CONVERT 0360
*                                      BIT ID INTO DECIMAL IN 8 BYTE
*                                      AREA -CVDAREA         @ZA12401*/
*                                                                  0360
         L     @10,@TF00001                                        0360
         SLR   @00,@00                                             0360
         IC    @00,CURRID(,@10)                                    0360
         CVD   @00,CVDAREA                                         0360
*                                   /*********************************/
*                                   /*                               */
*                                   /* UNPACK ONLY THE LAST TWO BYTES*/
*                                   /* OF CONVERTED NUMBER           */
*                                   /*                               */
*                                   /*********************************/
*                                                                  0361
*                                   UNPK(OREID,CVDAREA(7:8));      0361
*                                                                  0361
         L     @10,OREPTR(,RBSECPTR)                               0361
         UNPK  OREID(2,@10),CVDAREA+6(2)                           0361
*                                   /*********************************/
*                                   /*                               */
*                                   /* REPLACE SIGN WITH 'F0' ZONE   */
*                                   /* BITS                          */
*                                   /*                               */
*                                   /*********************************/
*                                                                  0362
*                                   OREID(2)=OREID(2)×'F0'X;       0362
         OI    OREID+1(@10),X'F0'                                  0362
*                                   XVD0RPFD='1'B;/* INDICATE AN ID
*                                      WAS FOUND                     */
*                                                                  0363
         OI    XVD0RPFD(RBSECPTR),B'01000000'                      0363
*                                   /*********************************/
*                                   /*                               */
*                                   /* TURN ON ID BIT IN BIT MAP     */
*                                   /*                               */
*                                   /*********************************/
*                                                                  0364
*                                   UCMRPYI(REG1)=UCMRPYI(REG1)×IDMAP(
*                                       REG2);                     0364
         ALR   @08,REG1                                            0364
         LA    @10,IDMAP-1(REG2)                                   0364
         OC    UCMRPYI-1(1,@08),0(@10)                             0364
*                                   XVA0=REG1;/* SAVE CONTENTS OF  0365
*                                      REG1 IN CASE WE HAVE TO BIVE
*                                      BACK THE ID.                  */
         ST    REG1,XVA0(,RBSECPTR)                                0365
*                                   XVA4=REG2;/* SAVE CONTENTS OF  0366
*                                      REG2 FOR SAME REASON.         */
         ST    REG2,XVA4(,RBSECPTR)                                0366
*                                 END;/*                     @ZA12401*/
*                               IF UCMRPYL=NINTY9 THEN/* END OF ID'S
*                                      REACHED?              @ZA12401*/
@RF00358 L     @10,UCMBASPT(,REG3)                                 0368
         L     @10,UCMEILPT(,@10)                                  0368
         CLI   UCMRPYL(@10),99                                     0368
         BNE   @RF00368                                            0368
*                                 UCMRPYL=0;/* YES, GO BACK TO 1ST ID
*                                                            @ZA12401*/
         MVI   UCMRPYL(@10),X'00'                                  0369
*                               ELSE/* NO, INCREMENT UCMRPYL. THIS IS
*                                      DONE EVEN THOUGH AN ID MAY BE
*                                      PICKED, SO THAT UCMRPYL IS  0370
*                                      INITIALIZED FOR THE NEXT ID 0370
*                                      SCAN                  @ZA12401*/
*                                 UCMRPYL=UCMRPYL+1;/*       @ZA12401*/
         B     @RC00368                                            0370
@RF00368 L     @10,UCMBASPT(,REG3)                                 0370
         L     @10,UCMEILPT(,@10)                                  0370
         LA    @08,1                                               0370
         SLR   @00,@00                                             0370
         IC    @00,UCMRPYL(,@10)                                   0370
         ALR   @08,@00                                             0370
         STC   @08,UCMRPYL(,@10)                                   0370
*                               RFY                                0371
*                                (REG1,                            0371
*                                 REG2) UNRSTD;/*            @ZA12401*/
@RC00368 DS    0H                                                  0372
*                             END;  /* OF DO UNTIL (FINDING A FREE 0372
*                                      ID)                   @ZA12401*/
@DE00354 TM    XVD0RPFD(RBSECPTR),B'01000000'                      0372
         BO    @DC00354                                            0372
         L     @10,UCMBASPT(,REG3)                                 0372
         L     @10,UCMEILPT(,@10)                                  0372
         CLC   UCMRPYL(1,@10),STARTID                              0372
         BNE   @DL00354                                            0372
@DC00354 DS    0H                                                  0373
*/****** END OF GETID SEGMENT ****************************************/
*                                                                  0373
*                           END;                                   0373
*                                                                  0373
*/********************************************************************/
*/*                                                                  */
*/*  CHECK TO SEE IF AN ID WAS AVAILABLE                             */
*/*                                                                  */
*/********************************************************************/
*                                                                  0374
*                         IF XVD0RPFD='1'B THEN/* WAS A REPLY ID   0374
*                                      FOUND                         */
@RC00345 TM    XVD0RPFD(RBSECPTR),B'01000000'                      0374
         BNO   @RF00374                                            0374
*                           DO;     /* YES, INDICATE WE NOW NEED A 0375
*                                      WQE                           */
*                             XVD0NORE='0'B;/* PROCESSING DONE FOR AN
*                                      ORE                           */
*                             XVD0NWQE='1'B;/* GET A WQE             */
         OI    XVD0NWQE(RBSECPTR),B'00100000'                      0377
         NI    XVD0NORE(RBSECPTR),B'11101111'                      0377
*                           END;                                   0378
*                         ELSE      /* NO, A REPLY WASNT AVAILABLE   */
*                           DO;     /* FREE THE ORE JUST OBTAINED    */
         B     @RC00374                                            0379
@RF00374 DS    0H                                                  0380
*                             CALL VWTOFORE;/* FREE THE ORE.         */
*                                                                  0380
         BAL   @14,VWTOFORE                                        0380
*                             /***************************************/
*                             /*                                     */
*                             /* WAIT FOR AN ORE TO BE FREED         */
*                             /*                                     */
*                             /***************************************/
*                                                                  0381
*                             CALL VWTOWAIT(UCMOECBT);             0381
         L     @10,UCMBASPT(,REG3)                                 0381
         LA    @10,UCMOECBT(,@10)                                  0381
         ST    @10,@AL00001                                        0381
         LA    @01,@AL00001                                        0381
         BAL   @14,VWTOWAIT                                        0381
*                           END;                                   0382
*                       END;        /* OF GET ORE AND ID PART        */
*/********************************************************************/
*/*                                                                  */
*/*  NO, AN ORE WASN'T AVAILABLE. WAIT FOR AN ORE TO BE FREE'D       */
*/*                                                                  */
*/********************************************************************/
*                                                                  0384
*                     ELSE                                         0384
*                       CALL VWTOWAIT(UCMOECBT);                   0384
*                                                                  0384
         B     @RC00342                                            0384
@RF00342 L     @10,UCMBASPT(,REG3)                                 0384
         LA    @10,UCMOECBT(,@10)                                  0384
         ST    @10,@AL00001                                        0384
         LA    @01,@AL00001                                        0384
         BAL   @14,VWTOWAIT                                        0384
*/********************************************************************/
*/*                                                                  */
*/*  CHECK IF WE NEED A WQE                                          */
*/*                                                                  */
*/********************************************************************/
*                                                                  0385
*                   IF XVD0NWQE='1'B&/* IS A WQE NEEDED NOW          */
*                       XVD1PERR='0'B THEN/* AND WAS THERE NO ERROR
*                                      IN GETTING AN ORE             */
@RC00342 DS    0H                                                  0385
@RF00341 TM    XVD0NWQE(RBSECPTR),B'00100000'                      0385
         BNO   @RF00385                                            0385
         TM    XVD1PERR(RBSECPTR),B'00000001'                      0385
         BNZ   @RF00385                                            0385
*/********************************************************************/
*/*                                                                  */
*/*  YES, CHECK IF ONE IS AVAILABLE, IF SO, GET IT. IF NOT WAIT      */
*/*  UNTIL ONE IS FREE'D,                                            */
*/*                                                                  */
*/********************************************************************/
*                                                                  0386
*                     IF UCMWQNR<UCMWQLM×/* IS THE NUMBER OF WQES  0386
*                                      LESS THAN THE LIMIT OR        */
*                         XVD1PRIV='1'B THEN/* IS THE USER A       0386
*                                      PRIVILEGED TASK               */
         L     @10,UCMBASPT(,REG3)                                 0386
         LH    @08,UCMWQNR(,@10)                                   0386
         CH    @08,UCMWQLM(,@10)                                   0386
         BL    @RT00386                                            0386
         TM    XVD1PRIV(RBSECPTR),B'10000000'                      0386
         BNO   @RF00386                                            0386
@RT00386 DS    0H                                                  0387
*                       DO;         /* YES, GET THE WQE              */
*                         CALL VWTOGETB(1);/* GET A WQE AND ZERO IT  */
         LA    @01,@AL00388                                        0388
         BAL   @14,VWTOGETB                                        0388
*/********************************************************************/
*/*                                                                  */
*/* CHECK IF A WQE WAS OBTAINED BY VWTOGETB.  IF NOT THEN CHECK IF   */
*/* THIS IS A WTOR. IF SO THEN FREE THE ORE AND REPLY ID THAT WAS    */
*/* OBTAINED.                                                        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0389
*                         IF XVWQEAD=1 THEN/* WAS THERE AN ERROR IN
*                                      GETTING THE WQE?              */
         CLC   XVWQEAD(4,RBSECPTR),@CF00062                        0389
         BNE   @RF00389                                            0389
*                           DO;     /* YES, CHECK IF THIS IS A WTOR
*                                      REQUEST                       */
*                             IF XVD2WTOR='1'B THEN/* IS THIS A WTOR?*/
         TM    XVD2WTOR(RBSECPTR),B'00000010'                      0391
         BNO   @RF00391                                            0391
*                               DO; /* YES. FREE THE ORE AND REPLY ID*/
*                                 CALL VWTOFORE;/* FREE THE ORE.     */
*                                                                  0393
         BAL   @14,VWTOFORE                                        0393
*                                 /***********************************/
*                                 /*                                 */
*                                 /* FREE THE REPLY ID JUST PICKED.  */
*                                 /* THE INDEXS TO UCMRPYI AND IDMAP */
*                                 /* WERE SAVED BY GETID IN XVA0 AND */
*                                 /* XVA4                            */
*                                 /*                                 */
*                                 /***********************************/
*                                                                  0394
*                                 UCMRPYI(XVA0)=UCMRPYI(XVA0)&(-1&&
*                                     IDMAP(XVA4));                0394
         L     @10,XVA0(,RBSECPTR)                                 0394
         L     @08,UCMBASPT(,REG3)                                 0394
         L     @02,XVA4(,RBSECPTR)                                 0394
         SLR   @15,@15                                             0394
         IC    @15,IDMAP-1(@02)                                    0394
         X     @15,@CF03250                                        0394
         SLR   @02,@02                                             0394
         IC    @02,UCMRPYI-1(@10,@08)                              0394
         NR    @15,@02                                             0394
         STC   @15,UCMRPYI-1(@10,@08)                              0394
*                               END;/* OF FREEING ORE                */
*                             XVD1PERR='1'B;/* INDICATE AN ERROR   0396
*                                      CONDITION FOUND.              */
@RF00391 OI    XVD1PERR(RBSECPTR),B'00000001'                      0396
*                           END;    /* OF ERROR IN GETTING WQE.      */
*                         XVD1ALDN='1'B;/* INDICATE WE ARE ALL DONE  */
@RF00389 OI    XVD1ALDN(RBSECPTR),B'00100000'                      0398
*                       END;                                       0399
*                     ELSE          /* NO, A WQE IS NOT AVAILABLE    */
*                       DO;                                        0400
*                                                                  0400
         B     @RC00386                                            0400
@RF00386 DS    0H                                                  0401
*/********************************************************************/
*/*                                                                  */
*/*  CHECK IF THIS IS A WTOR. IF SO FREE THE ORE AND REPLY ID. THIS  */
*/*  IS DONE SO WE DON'T GET IN AN INTERLOCK SITUATION.              */
*/*                                                                  */
*/********************************************************************/
*                                                                  0401
*                         IF XVD2WTOR='1'B THEN/* IS THIS A WTOR     */
         TM    XVD2WTOR(RBSECPTR),B'00000010'                      0401
         BNO   @RF00401                                            0401
*                           DO;     /* YES                           */
*                             CALL VWTOFORE;/* FREE THE ORE.         */
*                                                                  0403
         BAL   @14,VWTOFORE                                        0403
*                             /***************************************/
*                             /*                                     */
*                             /* FREE THE REPLY ID JUST PICKED. THE  */
*                             /* INDEXS TO UCMRPYI AND IDMAP WERE    */
*                             /* SAVED BY GETID IN XVA0 AND XVA4     */
*                             /*                                     */
*                             /***************************************/
*                                                                  0404
*                             UCMRPYI(XVA0)=UCMRPYI(XVA0)&(-1&&IDMAP(
*                                 XVA4));                          0404
*                                                                  0404
         L     @10,XVA0(,RBSECPTR)                                 0404
         L     @08,UCMBASPT(,REG3)                                 0404
         L     @02,XVA4(,RBSECPTR)                                 0404
         SLR   @15,@15                                             0404
         IC    @15,IDMAP-1(@02)                                    0404
         X     @15,@CF03250                                        0404
         SLR   @02,@02                                             0404
         IC    @02,UCMRPYI-1(@10,@08)                              0404
         NR    @15,@02                                             0404
         STC   @15,UCMRPYI-1(@10,@08)                              0404
*                             /***************************************/
*                             /*                                     */
*                             /* NOW BACK UP UCMRPYL SO WE WILL TRY  */
*                             /* TO GET THE SAME REPLY               */
*                             /*                                     */
*                             /***************************************/
*                                                                  0405
*                             IF UCMRPYL=0 THEN/* ARE WE AT BEGINNING
*                                      OF IDS                        */
         L     @10,UCMEILPT(,@08)                                  0405
         CLI   UCMRPYL(@10),0                                      0405
         BNE   @RF00405                                            0405
*                               UCMRPYL=NINTY9;/* YES. BACK UP TO  0406
*                                      99TH ID                       */
         MVI   UCMRPYL(@10),X'63'                                  0406
*                             ELSE  /* NO WE ARE NOT AT ID 0.        */
*                               UCMRPYL=UCMRPYL-1;/* BACK UP JUST ONE*/
         B     @RC00405                                            0407
@RF00405 L     @10,UCMBASPT(,REG3)                                 0407
         L     @10,UCMEILPT(,@10)                                  0407
         SLR   @08,@08                                             0407
         IC    @08,UCMRPYL(,@10)                                   0407
         BCTR  @08,0                                               0407
         STC   @08,UCMRPYL(,@10)                                   0407
*                             XVD0NORE='1'B;/* INDICATE START OVER IN
*                                      GETTING ORE                   */
@RC00405 DS    0H                                                  0409
*                             XVD0NWQE='0'B;                       0409
         OI    XVD0NORE(RBSECPTR),B'00010000'                      0409
         NI    XVD0NWQE(RBSECPTR),B'11011111'                      0409
*                           END;                                   0410
*                                                                  0410
*/********************************************************************/
*/*                                                                  */
*/* NOW WAIT FOR A WQE TO BE FREE'D. THEN TRY AGAIN                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0411
*                         CALL VWTOWAIT(UCMWECBT);                 0411
@RF00401 L     @10,UCMBASPT(,REG3)                                 0411
         LA    @10,UCMWECBT(,@10)                                  0411
         ST    @10,@AL00001                                        0411
         LA    @01,@AL00001                                        0411
         BAL   @14,VWTOWAIT                                        0411
*                       END;                                       0412
*                 END;              /* OF DO WHILE LOOP              */
@RC00386 DS    0H                                                  0413
@RF00385 DS    0H                                                  0413
@DE00340 TM    XVD1ALDN(RBSECPTR),B'00100000'                      0413
         BZ    @DL00340                                            0413
*/* **** END GETBLKS SEGMENT *****************************************/
*/********************************************************************/
*/*                                                                  */
*/* NOW CHECK IF THE CONTROL BLOCKS WERE OBTAINED. IF SO THEN GO     */
*/* AHEAD AND BUILD THEM. IF NOT THEN ABEND WITH A D23 ABEND CODE.   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0414
*                 IF XVD1PERR='0'B THEN/* WERE WE SUCCESSFUL IN    0414
*                                      GETTING THE CONTROL BLOCKS (
*                                      WERE NO ERRORS FOUND IN     0414
*                                      GETTING THEM?)                */
         TM    XVD1PERR(RBSECPTR),B'00000001'                      0414
         BNZ   @RF00414                                            0414
*                   DO;             /* YES. BUILD THEM               */
*/********************************************************************/
*/*                                                                  */
*/* CHECK FOR WTOR. IF THIS REQUEST IS A WTOR THEN BUILD AN ORE      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0416
*                     IF XVD2WTOR='1'B THEN/* IS THIS REQUEST A WTOR */
         TM    XVD2WTOR(RBSECPTR),B'00000010'                      0416
         BNO   @RF00416                                            0416
*                       DO;                                        0417
*                                                                  0417
*/*** START OF BUILDORE **********************************************/
*/********************************************************************/
*/*                                                                  */
*/*   BUILDORE - CONSTRUCT THE ORE AND PUT IT ON THE ORE CHAIN       */
*/*                                                                  */
*/*   INPUT - XVPARMAD POINTS AT THE USER'S PARM LIST                */
*/*           XVOREAD  POINTS AT A ZEROED ORE                        */
*/*                                                                  */
*/*   OUTPUT - THE FILLED IN ORE IS ADDED TO THE ORE CHAIN           */
*/*            AND IS MARKED SUSPENDED FOR THE DURATION OF THE       */
*/*            SUBSYSTEM EXIT.                                       */
*/*                                                                  */
*/********************************************************************/
*/********************************************************************/
*/*                                                                  */
*/*           THE OREID WILL HAVE ALREADY BEEN FILLED IN BY GETID.   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0418
*                         ORETCB=REG4;/* INSERT TCB ADDR             */
         L     @10,OREPTR(,RBSECPTR)                               0418
         ST    REG4,ORETCB(,@10)                                   0418
*                         ORERPY=WPLRPTR;/* MOVE IN REPLY LENGTH AND
*                                      BUFFER ADDR                   */
         L     @08,XVPARMAD(,RBSECPTR)                             0419
         L     @02,WPLRPTR(,@08)                                   0419
         ST    @02,ORERPY(,@10)                                    0419
*                         OREECB=WPLRECB;/* MOVE IN THE REPLY ECB  0420
*                                      ADDR                          */
         L     @08,WPLRECB(,@08)                                   0420
         ST    @08,OREECB(,@10)                                    0420
*                         OREASID=ASCBASID;/* MOVE ASID OF THIS    0421
*                                      MEMORY                        */
         LH    @08,ASCBASID(,ASCBPTR)                              0421
         N     @08,@CF03329                                        0421
         STH   @08,OREASID(,@10)                                   0421
*                         OREWQE=XVWQEAD;/* MOVE IN ADDR OF        0422
*                                      ASSOCIATED WQE                */
         L     @08,XVWQEAD(,RBSECPTR)                              0422
         ST    @08,OREWQE(,@10)                                    0422
*                         OREBUFB='1'B;/* INDICATE THIS ORE IS IN USE*/
*                         OREBUFD='1'B;/* INDICATE ORE OBTAINED VIA A
*                                      GETMAIN                       */
         OI    OREBUFB(@10),B'01010000'                            0424
*/********************************************************************/
*/*                                                                  */
*/*  CHECK IF USER IS A PROBLEM PROGRAM. IF NOT THEN INDICATE THAT   */
*/*  VALIDITY CHECKING OF REPLY BUFFER AND ECB CAN BE BYPASSED BY    */
*/*  REPLY PROCESSING.                                               */
*/*                                                                  */
*/********************************************************************/
*                                                                  0425
*                         IF XVD1PP='0'B THEN/* IS USER NOT A PROBLEM
*                                      PROGRAM                       */
         TM    XVD1PP(RBSECPTR),B'00000100'                        0425
         BNZ   @RF00425                                            0425
*                           OREKEY0='1'B;/* INDICATE BYPASS VALIDITY
*                                      CHECK                         */
         OI    OREKEY0(@10),B'01000000'                            0426
*                         ORESUSP='1'B;/* INDICATE ORE SUSPENDED FOR
*                                      SUBSYSTEM EXIT.               */
@RF00425 L     @10,OREPTR(,RBSECPTR)                               0427
         OI    ORESUSP(@10),B'00010000'                            0427
*/********************************************************************/
*/*                                                                  */
*/*  NOW PUT THE ORE ON THE FRONT OF THE QUEUE. THE ORDER OF         */
*/*  APPEARANCE ON THE QUEUE IS IMMATERIAL. THE OPERATOR MAY RESPOND */
*/*  IN ANY ORDER AND REPLY PROCESSING WILL SCAN THE QUEUE FOR MATCH-*/
*/*  ING IDS.                                                        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0428
*                         ORELKP=UCMRPYQ;/* POINT THIS ORE AT NEXT 0428
*                                      ORE ON QUEUE                  */
         L     @08,UCMBASPT(,REG3)                                 0428
         L     @02,UCMRPYQ(,@08)                                   0428
         ST    @02,ORELKP(,@10)                                    0428
*                         UCMRPYQ=XVOREAD;/* POINT HEAD OF QUEUE AT
*                                      THIS ORE                      */
         L     @10,XVOREAD(,RBSECPTR)                              0429
         ST    @10,UCMRPYQ(,@08)                                   0429
*/********************************************************************/
*/*                                                                  */
*/*  WE ASSUME UCMRPYQ IS ZERO IF QUEUE IS EMPTY AT ENTRY TO VWTO    */
*/*                                                                  */
*/********************************************************************/
*/****** END OF BUILD ORE SEGMENT ************************************/
*                                                                  0430
*                       END;                                       0430
*                                                                  0430
*/********************************************************************/
*/*                                                                  */
*/* NOW BUILD THE WQE                                                */
*/*                                                                  */
*/********************************************************************/
*/*** START OF BUILDWQE **********************************************/
*/********************************************************************/
*/*                                                                  */
*/*   BUILDWQE - CONSTRUCT THE WQE AND PUT IT ON THE WQE CHAIN       */
*/*                                                                  */
*/*   INPUT - XVPARMAD POINTS AT THE USER'S PARM LIST                */
*/*           XVWQEAD  POINTS AT A ZEROED WQE                        */
*/*           REG6 POINTS AT THE MSG PART OF THE WPL                 */
*/*                                                                  */
*/*   OUTPUT - THE FILLED IN WQE IS ADDED TO THE WQE CHAIN.          */
*/*                                                                  */
*/*  START BY MOVING MESSAGE INTO THE WQE. THE FIRST CHARACTER OF    */
*/*  TEXT IN THE WQE WILL BE THE AUTHORIZATION FLAG. THE MESSAGE IS  */
*/*  SCANNED FOR 'NL' CHARACTER AND TO ELIMINATE TRAILING BLANKS.    */
*/*  THE LENGTH OF THE MSG IS IN XVMSGLGH AND IS NON-ZERO            */
*/*  THE SECURITY MESSAGE FLAGGING IN THE MESSAGE TEXT IS:           */
*/*   MSG TYPE           MSG FORMAT                                  */
*/*   WTO,P/P,NONACTION  BLANK,+,TEXT                                */
*/*   WTO,P/P,ACTION     @,TEXT                                      */
*/*   WTO,SYS,NONACTION  BLANK,TEXT                                  */
*/*   WTO,SYS,ACTION     *,TEXT                                      */
*/*   WTOR,P/P           @,ID,BLANK,TEXT                             */
*/*   WTOR,SYSTEM        *,ID,BLANK,TEXT                             */
*/*   AN ACTION MSG IS A WTOR OR A WTO WITH DESCRIPTOR CODE 1 OR 2.  */
*/* NOTE: P/P IN THE ABOVE TABLE MEANS THAT THE USER IS NOT          */
*/*       AUTHORIZED.                                                */
*/*                                                                  */
*/********************************************************************/
*                                                                  0431
*                     RFY                                          0431
*                       REG2 RSTD;  /* REG2 WILL BE USED AS TEXTPTR  */
@RF00416 DS    0H                                                  0432
*                     WQETXT='';    /* BLANK OUT TEXT PART OF THE WQE*/
         L     @10,WQEPTR(,RBSECPTR)                               0432
         MVI   WQETXT(@10),C' '                                    0432
         MVC   WQETXT+1(127,@10),WQETXT(@10)                       0432
*/********************************************************************/
*/*                                                                  */
*/*  CHECK FOR TYPE OF MESSAGE                                       */
*/*                                                                  */
*/********************************************************************/
*                                                                  0433
*                     IF XVD2WTOR='1'B THEN/* IS THIS A WTOR         */
         TM    XVD2WTOR(RBSECPTR),B'00000010'                      0433
         BNO   @RF00433                                            0433
*                       DO;         /* YES, IS USER NOT AUTHORIZED?  */
*                         IF XVD1AUTH='0'B THEN                    0435
         TM    XVD1AUTH(RBSECPTR),B'00000010'                      0435
         BNZ   @RF00435                                            0435
*                           MSGACTN='@';/* YES, MOVE IN P/P ACTION 0436
*                                      FLAG                          */
         MVI   MSGACTN(@10),C'@'                                   0436
*                         ELSE      /* NO, MOVE IN SYSTEM ACTION FLAG*/
*                           MSGACTN='*';                           0437
         B     @RC00435                                            0437
@RF00435 L     @10,WQEPTR(,RBSECPTR)                               0437
         MVI   MSGACTN(@10),C'*'                                   0437
*                         MSGID=OREID;/* MOVE IN REPLY ID FROM ORE   */
@RC00435 L     @10,WQEPTR(,RBSECPTR)                               0438
         L     @08,OREPTR(,RBSECPTR)                               0438
         MVC   MSGID(2,@10),OREID(@08)                             0438
*                         MSGBLNK=' ';/* MOVE IN A BLANK AFTER REPLY
*                                      ID                            */
*                                                                  0439
         MVI   MSGBLNK(@10),C' '                                   0439
*                         /*******************************************/
*                         /*                                         */
*                         /* POINT AT FIRST LOCATION OF MSG TEXT     */
*                         /*                                         */
*                         /*******************************************/
*                                                                  0440
*                         TEXTPTR=LENGTH(MSGFLAG)+1;               0440
         LA    TEXTPTR,5                                           0440
*                       END;                                       0441
*                     ELSE          /* NO, NOT A WTOR. CHECK FURTHER */
*/********************************************************************/
*/*                                                                  */
*/* IS IT ACTION MSG BY REASON OF DESCRIPTOR CODES. CHECK THE DESC   */
*/* CODES RETURNED BY THE INSTALLATION EXIT. THEY WERE       @ZA14991*/
*/* SAVED IN THE XSA AND THE WPL NOW MAPS THE XSA NOT THE    @ZA14991*/
*/* WPL.                                                     @ZA14991*/
*/*                                                                  */
*/********************************************************************/
*                                                                  0442
*                       DO;                                        0442
         B     @RC00433                                            0442
@RF00433 DS    0H                                                  0443
*                         IF WPLDESCA='1'B×/* IS DESC CODE 1 OR 2  0443
*                                      SPECIFIED                     */
*                             WPLDESCB='1'B THEN                   0443
         LA    @10,108                                             0443
         ALR   @10,RBSECPTR                                        0443
         TM    WPLDESCA(@10),B'11000000'                           0443
         BZ    @RF00443                                            0443
*                           IF XVD1AUTH='0'B THEN/* YES, CHECK FOR 0444
*                                      NOT AUTHORIZED.               */
         TM    XVD1AUTH(RBSECPTR),B'00000010'                      0444
         BNZ   @RF00444                                            0444
*                             DO;   /* YES, USER IS NOT AUTHORIZED.  */
*                               MSGACTN='@';/* MOVE IN P/P ACTION  0446
*                                      FLAG                          */
         L     @08,WQEPTR(,RBSECPTR)                               0446
         MVI   MSGACTN(@08),C'@'                                   0446
*                               TEXTPTR=LENGTH(MSGACTN)+1;         0447
         LA    TEXTPTR,2                                           0447
*                               WPLDESCG='1'B;/* TURN ON DESC 7 SO 0448
*                                      THE P/P ACTION MSG WILL BE  0448
*                                      DOMMED AT TASK TERMINATION  0448
*                                                            @ZA14991*/
         OI    WPLDESCG(@10),B'00000010'                           0448
*                             END;                                 0449
*                           ELSE    /* NO, THIS IS A SYSTEM ACTION 0450
*                                      MSG                           */
*                             DO;                                  0450
         B     @RC00444                                            0450
@RF00444 DS    0H                                                  0451
*                               MSGACTN='*';/* MOVE IN SYSTEM ACTION
*                                      FLAG                          */
         L     @10,WQEPTR(,RBSECPTR)                               0451
         MVI   MSGACTN(@10),C'*'                                   0451
*                               TEXTPTR=LENGTH(MSGACTN)+1;         0452
         LA    TEXTPTR,2                                           0452
*                             END;                                 0453
*                         ELSE      /* NO, THIS IS NOT AN ACTION   0454
*                                      MESSAGE                       */
*                           IF XVD1AUTH='0'B THEN/* IS THIS USER NOT
*                                      AUTHORIZED?                   */
         B     @RC00443                                            0454
@RF00443 TM    XVD1AUTH(RBSECPTR),B'00000010'                      0454
         BNZ   @RF00454                                            0454
*                             DO;   /* YES                           */
*                               PPMSGFLG=' +';/* MOVE IN P/P NO    0456
*                                      ACTION MSG FLAG               */
         L     @10,WQEPTR(,RBSECPTR)                               0456
         MVC   PPMSGFLG(2,@10),@CC03264                            0456
*                               TEXTPTR=LENGTH(PPMSGFLG)+1;        0457
         LA    TEXTPTR,3                                           0457
*                             END;                                 0458
*                           ELSE    /* NO, THIS IS A SYSTEM NO ACTION
*                                      MSG                           */
*                             DO;                                  0459
         B     @RC00454                                            0459
@RF00454 DS    0H                                                  0460
*                               MSGACTN=' ';/* MOVE IN SYSTEM NO   0460
*                                      ACTION FLAG                   */
         L     @10,WQEPTR(,RBSECPTR)                               0460
         MVI   MSGACTN(@10),C' '                                   0460
*                               TEXTPTR=LENGTH(MSGACTN)+1;         0461
         LA    TEXTPTR,2                                           0461
*                             END;                                 0462
*                       END;        /* OF WTO MSG FLAGGING SECTION   */
@RC00454 DS    0H                                                  0463
@RC00443 DS    0H                                                  0464
*/********************************************************************/
*/*                                                                  */
*/*  THE VARIABLE TEXTPTR IS NOW SET TO THE FIRST CHAR OF WPLTXT     */
*/*  IN WHICH TO PUT THE MSG. COMPUTE THE MSG LENGTH                 */
*/*                                                                  */
*/********************************************************************/
*                                                                  0464
*                     IF XVD2WTOR='1'B THEN/* IF A WTOR, MAX TEXT  0464
*                                      LENGTH IS 122                 */
@RC00433 TM    XVD2WTOR(RBSECPTR),B'00000010'                      0464
         BNO   @RF00464                                            0464
*                       TEXTLNGT=MIN((XVMSGLGH-4),122);            0465
         LH    @10,XVMSGLGH(,RBSECPTR)                             0465
         SL    @10,@CF00084                                        0465
         LA    @08,122                                             0465
         CR    @10,@08                                             0465
         BNH   *+6
         LR    @10,@08                                             0465
         ST    @10,TEXTLNGT                                        0465
*                     ELSE          /* IF WTO, MAX TEXT LENGTH IS 125*/
*                       TEXTLNGT=MIN((XVMSGLGH-4),125);            0466
*                                                                  0466
         B     @RC00464                                            0466
@RF00464 LH    @10,XVMSGLGH(,RBSECPTR)                             0466
         SL    @10,@CF00084                                        0466
         LA    @08,125                                             0466
         CR    @10,@08                                             0466
         BNH   *+6
         LR    @10,@08                                             0466
         ST    @10,TEXTLNGT                                        0466
*/********************************************************************/
*/*                                                                  */
*/* MOVE MESSAGE TEXT INTO WQE.                                      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0467
*                     WQETXT(TEXTPTR:TEXTLNGT+TEXTPTR-1)=WPLTXT;   0467
@RC00464 L     @08,WQEPTR(,RBSECPTR)                               0467
         ALR   @08,TEXTPTR                                         0467
         L     @15,TEXTLNGT                                        0467
         LR    @14,TEXTPTR                                         0467
         ALR   @14,@15                                             0467
         SLR   @14,TEXTPTR                                         0467
         BCTR  @14,0                                               0467
         EX    @14,@SM03342                                        0467
*                     ISCAN=TEXTPTR+TEXTLNGT;/*              @ZA19274*/
         ALR   @15,TEXTPTR                                         0468
         LR    ISCAN,@15                                           0468
*/********************************************************************/
*/*                                                                  */
*/*  NOW SCAN BACKWARDS LOOKING FOR FIRST NON BLANK CHARACTER.       */
*/*  THIS TECHNIQUE IS USED, RATHER THAN STORING COUNT OF EACH NON-  */
*/*  BLANK CHARACTER AND THUS HAVING THE LOCATION OF LAST NON-BLANK  */
*/*  AT THE END OF THE LOOP, AS IT IS FASTER FOR THE TYPICAL CASE.   */
*/*  WHICH IS A NON-BLANK CHARACTER AT THE END OF THE LINE           */
*/*                                                                  */
*/********************************************************************/
*                                                                  0469
*                     DO ISCAN=ISCAN-1 TO TEXTPTR BY-1 WHILE(WQETXT(
*                           ISCAN)=' ');                           0469
         LR    @08,ISCAN                                           0469
         BCTR  @08,0                                               0469
         LR    ISCAN,@08                                           0469
         B     @DE00469                                            0469
@DL00469 L     @08,WQEPTR(,RBSECPTR)                               0469
         ALR   @08,ISCAN                                           0469
         CLI   WQETXT-1(@08),C' '                                  0469
         BNE   @DC00469                                            0469
*                     END;          /* THE DO WHILE IS ALLTHAT IS  0470
*                                      NEEDED TO DO THE SCAN.        */
         BCTR  ISCAN,0                                             0470
@DE00469 CR    ISCAN,TEXTPTR                                       0470
         BNL   @DL00469                                            0470
@DC00469 DS    0H                                                  0471
*/********************************************************************/
*/*                                                                  */
*/*  CHECK IF MESSAGE WAS ALL BLANK                                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0471
*                     IF ISCAN<TEXTPTR THEN/* DID WE NOT FIND A NON
*                                      BLANK CHAR                    */
         CR    ISCAN,TEXTPTR                                       0471
         BNL   @RF00471                                            0471
*                       TEXTLNGT=TEXTPTR;/* YES, THE MSG LENGTH    0472
*                                      INCLUDES 1 BLNK               */
         ST    TEXTPTR,TEXTLNGT                                    0472
*                     ELSE          /* NO, WE FOUND A NON-BLANK      */
*                       TEXTLNGT=ISCAN;/* SET LENGTH                 */
         B     @RC00471                                            0473
@RF00471 ST    ISCAN,TEXTLNGT                                      0473
*                     WQENBR=TEXTLNGT;/* STORE LENGTH OF MESSAGE     */
@RC00471 L     @10,WQEPTR(,RBSECPTR)                               0474
         L     @08,TEXTLNGT                                        0474
         ST    @08,WQENBR(,@10)                                    0474
*                     WQESEQN=UCMCMID;/* MOVE IN MSG SEQUENCE NUMBER */
         L     @08,UCMBASPT(,REG3)                                 0475
         AL    @08,@CF03336                                        0475
         L     @08,UCMMCSPT(,@08)                                  0475
         MVC   WQESEQN(3,@10),UCMCMID+1(@08)                       0475
*/********************************************************************/
*/* CHECK IF THIS IS AN OLD STYLE MESSAGE WHICH HAS NO MCS FLAGS     */
*/*                                                          @ZA05154*/
*/********************************************************************/
*                                                                  0476
*                     IF WPLMCSF=0 THEN/* ARE THERE NO MCS FLAGS IN
*                                      THE WPL               @ZA05154*/
         LH    @08,WPLMCSF(,REG6)                                  0476
         N     @08,@CF03329                                        0476
         LTR   @08,@08                                             0476
         BNZ   @RF00476                                            0476
*                       WQEMCSA='1'B;/* IND R/D CODES IN WQ@ZA05154  */
*                                                                  0477
         OI    WQEMCSA(@10),B'10000000'                            0477
*                     /***********************************************/
*                     /*                                             */
*                     /* NOTE - THE MCS FIELD IN THE WPL IS SET TO   */
*                     /* ALLOW TOTAL MESSAGE PROCESSING BY ALL       */
*                     /* CONSOLES RECEIVING THE ORIGINAL MESSAGE.    */
*                     /*                                     @ZA05154*/
*                     /*                                             */
*                     /***********************************************/
*                                                                  0478
*                     ELSE                                         0478
*                       WQEMCSF=WPLMCSF;/* MOVE IN THE MCS FLAGS     */
*                                                                  0478
         B     @RC00476                                            0478
@RF00476 L     @10,WQEPTR(,RBSECPTR)                               0478
         MVC   WQEMCSF(2,@10),WPLMCSF(REG6)                        0478
*                     /***********************************************/
*                     /*                                             */
*                     /* CHECK IF THIS IS A WTP THAT IS TO GO TO     */
*                     /* HARDCOPY ONLY. IGC0203E WOULD HAVE SET      */
*                     /* XVD0HDCY ON IF THIS SITUATION EXISTS.       */
*                     /*                                             */
*                     /***********************************************/
*                                                                  0479
*                     IF XVD0HDCY='1'B THEN/* DO WE SEND THIS MSG TO
*                                      HC ONLY                       */
@RC00476 TM    XVD0HDCY(RBSECPTR),B'00000001'                      0479
         BNO   @RF00479                                            0479
*                       WQEMCSG='1'B;/* YES, TURN ON HC ONLY MCS FLAG*/
         L     @10,WQEPTR(,RBSECPTR)                               0480
         OI    WQEMCSG(@10),B'00000010'                            0480
*                     IF WQEMCSB='1'B×/* IS REG0 OR QREG0 MCS FLAG ON*/
*                         WQEMCSH='1'B THEN                        0481
@RF00479 L     @10,WQEPTR(,RBSECPTR)                               0481
         TM    WQEMCSB(@10),B'01000001'                            0481
         BZ    @RF00481                                            0481
*                       WQEUCMID=XVCONID;/* YES. MOVE IN CONSOLE ID  */
         IC    @08,XVCONID(,RBSECPTR)                              0482
         STC   @08,WQEUCMID(,@10)                                  0482
*                     XVWQEID=UCMCMID;/* SAVE ID FOR RETURN TO THE 0483
*                                      USER.                         */
@RF00481 L     @10,UCMBASPT(,REG3)                                 0483
         AL    @10,@CF03336                                        0483
         L     @10,UCMMCSPT(,@10)                                  0483
         L     @08,UCMCMID(,@10)                                   0483
         ST    @08,XVWQEID(,RBSECPTR)                              0483
*                     UCMCMID=UCMCMID+1;/* INCREMENT SEQUENCE NUMBER */
         AL    @08,@CF00062                                        0484
         ST    @08,UCMCMID(,@10)                                   0484
*                     WQEROUT=XVRCSAVE;/* MOVE IN ROUTE CODES FROM 0485
*                                      EXIT                          */
         L     @10,WQEPTR(,RBSECPTR)                               0485
         MVC   WQEROUT(2,@10),XVRCSAVE(RBSECPTR)                   0485
*                     WQEDESCD=XVDESCD;/* MOVE IN DESC CODES FROM  0486
*                                      EXIT                          */
         MVC   WQEDESCD(2,@10),XVDESCD(RBSECPTR)                   0486
*                     IF XVD2MSGT='1'B THEN/* WAS MSGTYP SPECIFIED?  */
         TM    XVD2MSGT(RBSECPTR),B'00100000'                      0487
         BNO   @RF00487                                            0487
*                       WQEMSGTP=XVMSGTYP;/* MOVE IN SAVED MSG TYPE
*                                      FLAGS                         */
         MVC   WQEMSGTP(2,@10),XVMSGTYP(RBSECPTR)                  0488
*                     WQEBUFB='1'B; /* INDICATE THE WQE IS IN USE    */
@RF00487 DS    0H                                                  0490
*                     WQEBUFD='1'B; /* INDICATE THE QWE            0490
*                                      DYNAMICALLYGOTTEN             */
         L     @10,WQEPTR(,RBSECPTR)                               0490
         OI    WQEBUFB(@10),B'01010000'                            0490
*/********************************************************************/
*/*                                                                  */
*/* IF WTOR FILL IN REPLY ID AND SET DESC CODES                      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0491
*                     IF XVD2WTOR='1'B THEN                        0491
         TM    XVD2WTOR(RBSECPTR),B'00000010'                      0491
         BNO   @RF00491                                            0491
*                       DO;                                        0492
*                         WQERPYID=OREID;/* MOVE IN REPLY ID         */
         L     @08,OREPTR(,RBSECPTR)                               0493
         MVC   WQERPYID(2,@10),OREID(@08)                          0493
*                         WQEORE='1'B;/* TURN ON ORE EXISTS BIT      */
*                         WQEWTOR='1'B;/* INDICATE THAT THIS WQE IS
*                                      FOR A WTOR                    */
         OI    WQEORE(@10),B'00101000'                             0495
*                         WQEDESCD='0200'X;/* MOVE IN DESC CODE OF 7
*                                      ONLY FOR WTOR                 */
         MVC   WQEDESCD(2,@10),@CB03267                            0496
*                       END;        /* OF WTOR HANDLING              */
*/********************************************************************/
*/*                                                                  */
*/* CHECK IF USER IS P/P. IF SO DON'T ALLOW BY PASS HC               */
*/*                                                                  */
*/********************************************************************/
*                                                                  0498
*                     IF XVD1PP='1'B THEN/* IS USER A P/P            */
@RF00491 TM    XVD1PP(RBSECPTR),B'00000100'                        0498
         BNO   @RF00498                                            0498
*                       WQEMCSN='0'B;/* YES, USER CAN'T BY PASS HC.  */
         L     @10,WQEPTR(,RBSECPTR)                               0499
         NI    WQEMCSN(@10),B'11111011'                            0499
*                     IF WQEMCSH='1'B&/* DID NOT AUTH USER SPECIFY 0500
*                                      QREG0                         */
*                         XVD1AUTH='0'B THEN                       0500
@RF00498 L     @10,WQEPTR(,RBSECPTR)                               0500
         TM    WQEMCSH(@10),B'00000001'                            0500
         BNO   @RF00500                                            0500
         TM    XVD1AUTH(RBSECPTR),B'00000010'                      0500
         BNZ   @RF00500                                            0500
*                       DO;         /* YES. SWITCH USER TO REG0 -  0501
*                                      CONDITION- AL QUEUE TO THAT 0501
*                                      CONSOLE                       */
*                         WQEMCSH='0'B;/* TURN OFF QREG0 MCS FLAG    */
*                         WQEMCSB='1'B;/* TURN ON REG0 MCS FLAG      */
         OI    WQEMCSB(@10),B'01000000'                            0503
         NI    WQEMCSH(@10),B'11111110'                            0503
*                       END;                                       0504
*                     WQEASID=ASCBASID;/* MOVE IN ASID OF THIS MEMORY*/
@RF00500 L     @10,WQEPTR(,RBSECPTR)                               0505
         MVC   WQEASID(2,@10),ASCBASID(ASCBPTR)                    0505
*                     WQETCB=REG4;  /* MOVE IN ADDR OF CURRENT TCB   */
         ST    REG4,WQETCB(,@10)                                   0506
*                     WQEJSTCB=TCBJSTCB;/* MOVE IN ADDR OF JOB STEPS
*                                      TCB                           */
         L     @08,TCBJSTCB(,TCBPTR)                               0507
         ST    @08,WQEJSTCB(,@10)                                  0507
*/********************************************************************/
*/*                                                                  */
*/* PUT IN USER AUTHORIZATION                                        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0508
*                     IF XVD1AUTH='1'B THEN/* IS USER AUTHORIZED     */
         TM    XVD1AUTH(RBSECPTR),B'00000010'                      0508
         BNO   @RF00508                                            0508
*                       WQEAUTH='1'B;/* YES, INDICATE SO             */
         OI    WQEAUTH(@10),B'00000001'                            0509
*                     ELSE                                         0510
*                       WQEAUTH='0'B;/* NO, MAKE SURE BIT IS OFF     */
         B     @RC00508                                            0510
@RF00508 L     @10,WQEPTR(,RBSECPTR)                               0510
         NI    WQEAUTH(@10),B'11111110'                            0510
*/********************************************************************/
*/*                                                                  */
*/*  NOW SET QUEUE FOR HC IF ALREADY INDICATED                       */
*/*                                                                  */
*/********************************************************************/
*                                                                  0511
*                     IF XVD2QFHC='1'B THEN/* IS QUEUE FOR HC      0511
*                                      INDICATED                     */
@RC00508 TM    XVD2QFHC(RBSECPTR),B'00000001'                      0511
         BNO   @RF00511                                            0511
*                       WQEQFHC='1'B;/* YES, SET SAVE BIT ON IN WQE  */
         L     @10,WQEPTR(,RBSECPTR)                               0512
         OI    WQEQFHC(@10),B'01000000'                            0512
*                     ELSE                                         0513
*                       WQEQFHC='0'B;/* NO, INSURE BIT IS OFF        */
         B     @RC00511                                            0513
@RF00511 L     @10,WQEPTR(,RBSECPTR)                               0513
         NI    WQEQFHC(@10),B'10111111'                            0513
*/********************************************************************/
*/*                                                                  */
*/* CHECK IF TIME IS TO BE TAKEN                                     */
*/*                                                                  */
*/********************************************************************/
*                                                                  0514
*                     IF WPLMCSFI='1'B THEN/* IS DO NOT TIME STAMP ON*/
@RC00511 TM    WPLMCSFI(REG6),B'10000000'                          0514
         BNO   @RF00514                                            0514
*                       WQETS='';   /* YES, FILL TIME STAMP WITH   0515
*                                      BLANKS                        */
         L     @10,WQEPTR(,RBSECPTR)                               0515
         MVI   WQETS(@10),C' '                                     0515
         MVC   WQETS+1(7,@10),WQETS(@10)                           0515
*                     ELSE          /* NO, UNPACK THE TIME STAMP     */
*                       DO;         /* FILL IN THE TIME FIELD.       */
         B     @RC00514                                            0516
@RF00514 DS    0H                                                  0517
*                         UNPK(TSAREA,TIMEFLD);/* PUT UNPACKED TIME
*                                      STAMP INTO WQETS              */
         UNPK  TSAREA(7),TIMEFLD(4,RBSECPTR)                       0517
*                         WQETSHH=TSAREAHH;/* MOVE IN THE HOURS PART
*                                      OF THE TIME                   */
         L     @10,WQEPTR(,RBSECPTR)                               0518
         MVC   WQETSHH(2,@10),TSAREAHH                             0518
*                         WQEPER1=PERIOD;/* INSERT FIRST SEPERATOR   */
         MVI   WQEPER1(@10),C'.'                                   0519
*                         WQETSMM=TSAREAMM;/* MOVE IN THE MINUTES  0520
*                                      PART                          */
         MVC   WQETSMM(2,@10),TSAREAMM                             0520
*                         WQEPER2=PERIOD;/* PUT IN THE SECOND      0521
*                                      SEPERATOR                     */
         MVI   WQEPER2(@10),C'.'                                   0521
*                         WQETSSS=TSAREASS;/* MOVE IN THE SECONDS  0522
*                                      PART OF THE TIME              */
         MVC   WQETSSS(2,@10),TSAREASS                             0522
*                       END;                                       0523
*                     WQEPAD1=' ';  /* INSERT BLANK BETWEEN TS AND 0524
*                                      jobname                       */
@RC00514 L     @10,WQEPTR(,RBSECPTR)                               0524
         MVI   WQEPAD1(@10),C' '                                   0524
*                     WQEPAD2=' ';  /* INSERT BLANK AFTER THE JOBNAME*/
         MVI   WQEPAD2(@10),C' '                                   0525
*                     WQEJOBNM=' '; /* BLANK OUT THE JOB NAME FIELD  */
         MVI   WQEJOBNM+1(@10),C' '                                0526
         MVC   WQEJOBNM+2(6,@10),WQEJOBNM+1(@10)                   0526
         MVI   WQEJOBNM(@10),C' '                                  0526
*/********************************************************************/
*/*                                                                  */
*/* NOW DECODE THE ROUTE CODES                                       */
*/*                                                                  */
*/********************************************************************/
*                                                                  0527
*                     RFY                                          0527
*                       REG2 RSTD;  /* REG2 AND REG3 WILL BE USED AS
*                                      A PAIR BY SLDL. REG3 IS     0527
*                                      ALREADY RSTD.                 */
*                     REG3=ROUTMAP; /* PICK UP UNDECODED ROUTE CODES */
         L     REG3,ROUTMAP(,@10)                                  0528
*                     DO ISCAN=1 TO 4;/* CONVERT FOUR ROUTE        0529
*                                      CHARACTERS                    */
         LA    ISCAN,1                                             0529
@DL00529 DS    0H                                                  0530
*                       REG2=0;     /* PREPARE FOR SHIFT             */
         SLR   REG2,REG2                                           0530
*                       GEN(SLDL  REG2,4)                          0531
*                       SETS(REG2,REG3);/* MOVE IN FOUR BITS OF ROUTE
*                                      CODE                          */
         SLDL  REG2,4
*                       REG2=REG2+1;/* MAKE INDEX TO EBCIDIC TABLE A
*                                      ONE ORIGIN INDEX.             */
         AL    REG2,@CF00062                                       0532
*/********************************************************************/
*/*                                                                  */
*/* NOW USE THE FOUR BITS IN REG2 TO PICK UP THE PROPER CHARACTER    */
*/* FROM THE CHARACTER TABLE                                         */
*/*                                                                  */
*/********************************************************************/
*                                                                  0533
*                       WQERR(ISCAN)=CHARTAB(REG2);                0533
         L     @08,WQEPTR(,RBSECPTR)                               0533
         ALR   @08,ISCAN                                           0533
         LA    @01,CHARTAB-1(REG2)                                 0533
         MVC   WQERR-1(1,@08),0(@01)                               0533
*                     END;                                         0534
         AL    ISCAN,@CF00062                                      0534
         C     ISCAN,@CF00084                                      0534
         BNH   @DL00529                                            0534
*                     WQEPAD=' ';   /* INSERT BLANK AFTER ROUTE      */
         L     @10,WQEPTR(,RBSECPTR)                               0535
         MVI   WQEPAD(@10),C' '                                    0535
*                     RFY                                          0536
*                       REG2 UNRSTD;                               0536
*                     REG3=CVTPTR;  /* RESET REG3 TO POINT AT CVTMAP */
         L     REG3,CVTPTR                                         0537
*                     WQESUSP='1'B; /* SUSPEND OPERATION OF WQE FOR
*                                      SUBSYSTEM EXIT                */
         OI    WQESUSP(@10),B'00000010'                            0538
*/********************************************************************/
*/*                                                                  */
*/*  PUT WQE ON THE QUEUE. CHECK IF QUEUE IS EMPTY                   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0539
*                     IF UCMWQEND=0 THEN/* IF QUEUE IS EMPTY SET UP
*                                      FOR INSERT                    */
         L     @10,UCMBASPT(,REG3)                                 0539
         L     @08,UCMWQEND(,@10)                                  0539
         LTR   @08,@08                                             0539
         BNZ   @RF00539                                            0539
*                       UCMWQEND=ADDR(UCMWTOQ);/* PT AT HEAD OF CHAIN*/
         LA    @08,UCMWTOQ(,@10)                                   0540
         ST    @08,UCMWQEND(,@10)                                  0540
*                     UCMWQEND->WQELKPA=XVWQEAD;/* PT LAST WQE AT NEW
*                                      WQE                           */
@RF00539 L     @10,UCMBASPT(,REG3)                                 0541
         L     @08,UCMWQEND(,@10)                                  0541
         L     @02,XVWQEAD(,RBSECPTR)                              0541
         STCM  @02,7,WQELKPA(@08)                                  0541
*                     UCMWQEND=XVWQEAD;/* PT END OF CHAIN AT NEW WQE */
         ST    @02,UCMWQEND(,@10)                                  0542
*                     WQELKP=0;     /* INDICATE LAST ON THE CHAIN    */
         L     @08,WQEPTR(,RBSECPTR)                               0543
         SLR   @02,@02                                             0543
         ST    @02,WQELKP(,@08)                                    0543
*/*** END OF BUILDWQE ************************************************/
*/*   CHECK IF WTO HAS BEEN MARKED FOR DELETION. IF SO MARK  @Y02668P*/
*/*   IT AS SERVICED AND SEND IT TO HARDCOPY.                @Y02668P*/
*                                                                  0544
*                     IF XVD2DELW='1'B THEN/* IS WQE TO BE DELETED?
*                                                            @Y02668P*/
         TM    XVD2DELW(RBSECPTR),B'00001000'                      0544
         BNO   @RF00544                                            0544
*                       DO;         /* YES, DELETE THIS MESSAGE    0545
*                                                            @Y02668P*/
*                         WQEBUFE='1'B;/* MARK WQE AS SERVICED     0546
*                                                            @Y02668P*/
         OI    WQEBUFE(@08),B'00001000'                            0546
*                         UCMSYSI='1'B;/* IND. CLEAN UP IS NEEDED  0547
*                                                            @Y02668P*/
         AL    @10,@CF03336                                        0547
         L     @10,UCMMCSPT(,@10)                                  0547
         OI    UCMSYSI(@10),B'10000000'                            0547
*                         WQEQFHC='1'B;/* SEND MESSAGE TO HARDCOPY 0548
*                                                            @Y02668P*/
         OI    WQEQFHC(@08),B'01000000'                            0548
*                         WQEBUFC='1'B;/* IND. READY FOR HARDCOPY  0549
*                                                            @Y02668P*/
         OI    WQEBUFC(@08),B'00100000'                            0549
*                       END;        /* END IF DELETE IS SPECIFIED  0550
*                                                            @Y02668P*/
*/********************************************************************/
*/*                                                                  */
*/* FREE THE HELD LOCKS AND FRR PRIOR TO TAKING THE SUBSYSTEM EXIT   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0551
*                     CALL FREELOCK;                               0551
*                                                                  0551
@RF00544 BAL   @14,FREELOCK                                        0551
*/********************************************************************/
*/*                                                                  */
*/* TAKE THE SUBSYSTEM EXIT                                          */
*/*                                                                  */
*/********************************************************************/
*                                                                  0552
*                     PARMFTPT=FTSSEXIT;/* START OF SUBSYSTEM EXIT 0552
*                                      CODE                          */
         L     @10,PARMPTR                                         0552
         MVI   PARMFTPT(@10),X'08'                                 0552
*                     PARMRTAD=ADDR(VWTOSSRT);/* IF ERROR TURN OFF 0553
*                                      DELETE BIT                    */
         LA    @08,VWTOSSRT                                        0553
         ST    @08,PARMRTAD(,@10)                                  0553
*/********************************************************************/
*/*                                                                  */
*/*   HASPEXIT - EXIT TO THE JOB ENTRY SUBSYSTEM                     */
*/*                                                                  */
*/*  THE SPACE FOR THE SSOB AND SSOBWT IS OBTAINED FROM SUBPOOL 231  */
*/*  WITH THE AUTOMATIC VARIABLES.                                   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0554
*                     RFY                                          0554
*                       REG15 RSTD;                                0554
*                                                                  0554
*/********************************************************************/
*/*                                                                  */
*/*   SET UP THE SSOB                                                */
*/*                                                                  */
*/********************************************************************/
*                                                                  0555
*                     SSOBID='SSOB';/* FILL IN THE ID FIELD          */
         MVC   SSOBID(4),@CC03269                                  0555
*                     SSOBLEN=LENGTH(SSOB);/* AND THE LENGTH FIELD   */
         MVC   SSOBLEN(2),@CH00333                                 0556
*                     SSOBFUNC=SSOBWTO;/* SPECIFY WTO EXIT TO THE  0557
*                                      SUBSYSTEM                     */
         MVC   SSOBFUNC(2),@CH00034                                0557
*                     SSOBSSIB=0;   /* INDICATE SUBSYSTEM WHICH    0558
*                                      INITIATED THE USER.           */
         SLR   @14,@14                                             0558
         ST    @14,SSOBSSIB                                        0558
*                     SSOBINDV=ADDR(SSWT);/* POINT AT WTO INTERFACE
*                                      BLOCK                         */
         LA    @14,SSWT                                            0559
         ST    @14,SSOBINDV                                        0559
*/********************************************************************/
*/*                                                                  */
*/*   NOW FILL IN THE SSWT BLOCK                                     */
*/*                                                                  */
*/********************************************************************/
*                                                                  0560
*                     SSWTLEN=LENGTH(SSWT);/* PUT LENGTH OF SSWT INTO
*                                      THE SSWT                      */
         MVC   SSWTLEN(2),@CH00092                                 0560
*                     SSWTWQE=XVWQEAD;/* PUT IN THE ADDR OF THE WQE  */
         L     @14,XVWQEAD(,RBSECPTR)                              0561
         ST    @14,SSWTWQE                                         0561
*/********************************************************************/
*/*                                                                  */
*/*   CHECK FOR A WTOR. IF SO THEN FILL IN ADDR OF THE ORE. IF NOT   */
*/*   THEN SET THE SSWTORE FIELD TO ZERO.                            */
*/*                                                                  */
*/********************************************************************/
*                                                                  0562
*                     IF XVD2WTOR='1'B THEN/* IS THIS A WTOR REQUEST */
         TM    XVD2WTOR(RBSECPTR),B'00000010'                      0562
         BNO   @RF00562                                            0562
*                       SSWTORE=XVOREAD;/* YES, PUT IN THE ADDR OF 0563
*                                      THE ORE                       */
         L     @14,XVOREAD(,RBSECPTR)                              0563
         ST    @14,SSWTORE                                         0563
*                     ELSE                                         0564
*                       SSWTORE=0;  /* NO, SET FIELD TO ZERO         */
         B     @RC00562                                            0564
@RF00562 SLR   @14,@14                                             0564
         ST    @14,SSWTORE                                         0564
*                     SSWTMIN=0;    /* THERE IS NO MINOR FOR A SINGLE
*                                      WTO                           */
@RC00562 SLR   @14,@14                                             0565
         ST    @14,SSWTMIN                                         0565
*/*   ? IEFSSREQ  (SSOB);                                            */
*/*                                                                  */
*/*  PASS CONTROL TO JOB ENTRY SUBSYSTEM TO                          */
*/*  PROCESS REQUEST -                                               */
*/*                                                                  */
*/*    INPUT - REGISTER 1 POINTS TO A ONE-                           */
*/*            WORD PARAMETER LIST WHICH                             */
*/*            POINTS TO THE SSOB                                    */
*/*                                                                  */
*                                                                  0566
*                     CALL SSREQ(SSOB);/* CALL ON THE SUBSYSTEM      */
         LA    @14,SSOB                                            0566
         ST    @14,@AL00001                                        0566
         MVI   @AL00001,X'80'                                      0566
         L     @10,CVTJESCT(,REG3)                                 0566
         L     @15,JESSSREQ(,@10)                                  0566
         LA    @01,@AL00001                                        0566
         BALR  @14,@15                                             0566
*/********************************************************************/
*/*                                                                  */
*/*   CHECK FOR A REQUEST TO DELETE MESSAGE BY SUBSYSTEM. CHECK FOR  */
*/*   GOOD EXIT AND DELETION REQUEST.                                */
*/*                                                                  */
*/********************************************************************/
*                                                                  0567
*                     IF REG15=SSRTOK&/* WAS EXIT SUCCESSFUL         */
*                         SSOBRETN=SSWTNDSP/* AND IS DON'T DISPLAY 0567
*                                      REQUESTED.                    */
*                       THEN        /* YES                           */
         LTR   REG15,REG15                                         0567
         BNZ   @RF00567                                            0567
         LA    @14,4                                               0567
         C     @14,SSOBRETN                                        0567
         BNE   @RF00567                                            0567
*                       DO;         /* DELETE MESSAGE        @Y02668P*/
*                         WQEBUFE='1'B;/* MARK WQE AS SERVICED     0569
*                                                            @Y02668P*/
         L     @10,WQEPTR(,RBSECPTR)                               0569
         OI    WQEBUFE(@10),B'00001000'                            0569
*                         UCMSYSI='1'B;/* IND. CLEAN UP IS NEEDED  0570
*                                                            @Y02668P*/
*                                                                  0570
         LCR   @14,@14                                             0570
         AL    @14,UCMBASPT(,REG3)                                 0570
         L     @14,UCMMCSPT(,@14)                                  0570
         OI    UCMSYSI(@14),B'10000000'                            0570
*                         /*******************************************/
*                         /*                                         */
*                         /* CHECK IF HARDCOPY IS TO BE BYPASSED     */
*                         /*                                 @Y02668P*/
*                         /*                                         */
*                         /*******************************************/
*                                                                  0571
*                         IF WQEMCSN='0'B THEN/* BYPASS HARDCOPY SET?
*                                                            @Y02668P*/
         TM    WQEMCSN(@10),B'00000100'                            0571
         BNZ   @RF00571                                            0571
*                           DO;     /* NO,SEND MESSAGE TO HARDCOPY 0572
*                                                            @Y02668P*/
*                             WQEBUFC='1'B;/* IND. READY FOR HARDCOPY
*                                                            @Y02668P*/
         OI    WQEBUFC(@10),B'00100000'                            0573
*                             WQEQFHC='1'B;/* SEND MESSAGE TO      0574
*                                      HARDCOPY              @Y02668P*/
         OI    WQEQFHC(@10),B'01000000'                            0574
*                           END;    /* END IF BYPASS NOT SET @Y02668P*/
*                         ELSE      /* IF BYPASS IS SET      @Y02668P*/
*                           DO;     /* DO NOT HARDCOPY MESSAGE     0576
*                                                            @Y02668P*/
         B     @RC00571                                            0576
@RF00571 DS    0H                                                  0577
*                             IF XVD2WTOR='1'B THEN/* THIS A WTOR? 0577
*                                                            @ZA03628*/
         TM    XVD2WTOR(RBSECPTR),B'00000010'                      0577
         BNO   @RF00577                                            0577
*                               WQEBUFC='1'B;/* YES, SET READY FOR 0578
*                                      HDCPY                 @ZA03628*/
         L     @14,WQEPTR(,RBSECPTR)                               0578
         OI    WQEBUFC(@14),B'00100000'                            0578
*                             WQEQFHC='0'B;/* TURN OFF HARDCOPY FLAG
*                                                            @Y02668P*/
@RF00577 L     @14,WQEPTR(,RBSECPTR)                               0579
         NI    WQEQFHC(@14),B'10111111'                            0579
*                           END;    /* END IF BYPASS IS SET  @Y02668P*/
*                       END;        /* END IF DON'T DISPLAY SPEC   0581
*                                                            @Y02668P*/
@RC00571 DS    0H                                                  0582
*/***********************************************************@ZA19274*/
*/*                                                          @ZA19274*/
*/* NOW GET RID OF UNPRINTABLE AND NONDISPLAY CHARACTERS IN  @ZA19274*/
*/* THE WQE IF THE USER IS A PROBLEM PROGRAM.                @ZA19274*/
*/*                                                          @ZA19274*/
*/***********************************************************@ZA19274*/
*                                                                  0582
*                     IF XVD1PP='1'B THEN/* IF PROBLEM PROGRAM THEN
*                                                            @ZA19274*/
@RF00567 TM    XVD1PP(RBSECPTR),B'00000100'                        0582
         BNO   @RF00582                                            0582
*                       DO;         /* TRANSLATE HIS MESSAGE TO    0583
*                                                            @ZA19274*/
*                         RFY                                      0584
*                           REG1 RSTD;/* PRINTABLE AND DISPLAY ONLY
*                                                            @ZA19274*/
*                         RFY                                      0585
*                           REG15 RSTD;/*                    @ZA19274*/
*                         REG15=WQEPTR;/*                    @ZA19274*/
         L     REG15,WQEPTR(,RBSECPTR)                             0586
*                         REG1=TEXTLNGT;/*                   @ZA19274*/
         L     REG1,TEXTLNGT                                       0587
*                         GEN REFS(REG1,TRTAB)(EX REG1,TRINST);/*  0588
*                                                            @ZA19274*/
         EX REG1,TRINST
*                         GEN DATA;                                0589
*                         RFY                                      0590
*                           REG1 UNRSTD;/*                   @ZA19274*/
*                         RFY                                      0591
*                           REG15 UNRSTD;/*                  @ZA19274*/
*                       END;        /*                       @ZA19274*/
*                                                                  0592
*                     /***********************************************/
*                     /*                                             */
*                     /* WE ARE DONE WITH THE SUBSYSTEM EXIT. REGAIN */
*                     /* THE LOCKS AND TAKE THE BLOCKS OUT OF THE    */
*                     /* SUSPENDED STATE                             */
*                     /*                                             */
*                     /***********************************************/
*                                                                  0593
*VWTOSSLB:                                                         0593
*                     CALL SETLOCK;                                0593
*                                                                  0593
@RF00582 DS    0H                                                  0593
VWTOSSLB BAL   @14,SETLOCK                                         0593
*/********************************************************************/
*/*                                                                  */
*/* TAKE THE WQE AND ORE OUT OF THE SUSPENDED STATE                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0594
*                     PARMFTPT=FTEND;/* END OF THE MODULE            */
         L     @10,PARMPTR                                         0594
         MVI   PARMFTPT(@10),X'09'                                 0594
*                     PARMRTAD=0;   /* NO RETRY NEEDED               */
         SLR   @08,@08                                             0595
         ST    @08,PARMRTAD(,@10)                                  0595
*                     WQESUSP='0'B; /* TURN OFF SUSPENDED BIT.       */
         L     @10,WQEPTR(,RBSECPTR)                               0596
         NI    WQESUSP(@10),B'11111101'                            0596
*                     IF XVD2WTOR='1'B THEN/* IS THERE AN ORE?       */
         TM    XVD2WTOR(RBSECPTR),B'00000010'                      0597
         BNO   @RF00597                                            0597
*                       ORESUSP='0'B;/* YES, TURN OFF THE SUSPENDED
*                                      BIT                           */
         L     @10,OREPTR(,RBSECPTR)                               0598
         NI    ORESUSP(@10),B'11101111'                            0598
*                     CALL FREELOCK;/* FREE ALL LOCKS        @Y02688P*/
@RF00597 BAL   @14,FREELOCK                                        0599
*/********************************************************************/
*/*                                                                  */
*/* NOW POST THE COMMUNICATIONS TASK TO INDICATE THAT IT HAS WORK    */
*/* TO DO. NAMELY A WQE, AND POSSIBLY AN ORE, TO PROCESS             */
*/*                                                                  */
*/********************************************************************/
*                                                                  0600
*                     RFY                                          0600
*                       REG1 RSTD;                                 0600
*                     CALL POSTOECB;/* XMPOST UCMOECB        @ZA03242*/
         BAL   @14,POSTOECB                                        0601
*                     RFY                                          0602
*                       REG1 UNRSTD;                               0602
*                   END;            /* OF TEST FOR VALID CONTROL   0603
*                                      BLOCKS                        */
*                 ELSE              /* NO THE CONTROL BLOCKS WERE NOT
*                                      OBTAINED. FREE THE LOCKS.     */
*                   CALL FREELOCK;                                 0604
         B     @RC00414                                            0604
@RF00414 BAL   @14,FREELOCK                                        0604
*               END;                /* OF RETURN TO USER FROM WTP  0605
*                                      TEST.                         */
@RC00414 DS    0H                                                  0606
*           END;                    /* END OF ELSE CLAUSE OF ZERO MSG
*                                      LENGTH TEST                   */
@RC00323 DS    0H                                                  0607
*     END;                          /* END OF VALID PARM LIST ELSE 0607
*                                      CLAUSE                        */
@RC00310 DS    0H                                                  0607
@RC00299 DS    0H                                                  0608
*/********************************************************************/
*/*                                                                  */
*/* NOW FREE THE ESTAE SO THAT ABENDS WILL BE SEEN BY THE USER       */
*/*                                                                  */
*/********************************************************************/
*                                                                  0608
*VWTOERRT:                                                         0608
*   ;                               /* ERROR RETURN POINT FOR POST   */
@RC00244 DS    0H                                                  0608
VWTOERRT DS    0H                                                  0609
*/********************************************************************/
*/*                                                                  */
*/* FREE ESTAE ROUTINE                                               */
*/*                                                                  */
*/********************************************************************/
*                                                                  0609
*   GEN( ESTAE 0);                                                 0609
*                                                                  0609
          ESTAE 0
*/********************************************************************/
*/*                                                                  */
*/* CHECK FOR ABEND ERROR SITUATION BEING FOUND                      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0610
*   IF XVD1PERR='1'B THEN           /* WAS ERROR BIT TURNED ON FOR 0610
*                                      ABEND                         */
*                                                                  0610
         TM    XVD1PERR(RBSECPTR),B'00000001'                      0610
         BNO   @RF00610                                            0610
*     /***************************************************************/
*     /*                                                             */
*     /* YES, THEN ABEND THE USER WITH CODE D23                      */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0611
*     DO;                                                          0611
*       RFY                                                        0612
*         REG1 RSTD;                                               0612
*       REG1=ABNDCODE;              /* LOAD REG 1 WITH D23 CODE      */
*                                                                  0613
         L     REG1,ABNDCODE                                       0613
*       /*************************************************************/
*       /*                                                           */
*       /* ISSUE SYSTEM ABEND WITH DUMP                              */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0614
*       GEN(ABEND (1),DUMP,,SYSTEM);                               0614
         ABEND (1),DUMP,,SYSTEM
*       RFY                                                        0615
*         REG1 UNRSTD;                                             0615
*     END;                                                         0616
*   ELSE                            /* NO, CHECK FOR VALID MESSAGE ID*/
*     IF XVD2ZERO='1'B THEN         /* WAS MESSAGE NOT PROCESSED   0617
*                                      BECAUSE OF ZERO LENGTH      0617
*                                      MESSAGE?                      */
         B     @RC00610                                            0617
@RF00610 TM    XVD2ZERO(RBSECPTR),B'00000100'                      0617
         BNO   @RF00617                                            0617
*       XVWQEID=0;                  /* YES, PASS BACK A ZERO MSG ID  */
         SLR   @10,@10                                             0618
         ST    @10,XVWQEID(,RBSECPTR)                              0618
*   RFY                                                            0619
*    (REG1,                                                        0619
*     REG14) RSTD;                                                 0619
@RF00617 DS    0H                                                  0619
@RC00610 DS    0H                                                  0620
*   REG14=XVRET;                    /* GET RETURN ADDRESS OF CALLER  */
         L     REG14,XVRET(,RBSECPTR)                              0620
*/********************************************************************/
*/*                                                                  */
*/* WE NOW GENERATE THE EPILOG CODE. PL/S WILL RETURN VALUES IN      */
*/* REG15 BUT WE NEED THE VALUE IN REG 1. THUS THE EPILOG CODE IS    */
*/* GENERATED AND NOT CREATED BY PL/S.                               */
*/*                                                                  */
*/****************************************************************** */
*                                                                  0621
*   GEN;                                                           0621
         L    REG0,@SIZDATD       GET SIZE OF DYNAMIC AREA
         LR   REG1,REG9           GET ADDR OF DYNAMIC AREA
         FREEMAIN R,LV=(0),A=(1)  FREE THE AREA
        SR    REG15,REG15    CLEAR REGISTER FOR IC
        IC    REG15,XVRETCOD(,RBSECPTR) PICK UP RETURN CODE
         L    REG1,XVWQEID(,RBSECPTR) GET MSG ID TO RETURN
         BR   REG14               RETURN TO CALLER
*   RFY                                                            0622
*    (REG1,                                                        0622
*     REG14) UNRSTD;                                               0622
         EJECT
*                                                                  0623
*/********************************************************************/
*/*                                                                  */
*/*   VWTOLREC - LOG RECOVERY ROUTINE                                */
*/*                                                                  */
*/*   FUNCTION - THIS ROUTINE IS ENTERED WHEN WE CAN NOT GET A CELL  */
*/*   POOL EXTENSION FROM CSA, SUBPOOL 231. WE CHECK TO SEE IF THE   */
*/*   REASON FOR THE GETMAIN FAILURE IS DUE TO THE SYSTEM LOG NOT    */
*/*   BEING INITIALIZED YET AND CSA HAS BEEN FILLED WITH MESSAGES    */
*/*   WAITING TO GO OUT TO THE LOG.  IF THAT IS THE CASE THEN WE     */
*/*   RECOVER FROM THE SITUATION BY SWITCHING HARDCOPY TO A CONSOLE  */
*/*   AND COMMTASK WILL FLUSH THE MESSAGES. WE WAIT UNTIL THE WQE    */
*/*   LIMIT IS DOWN AND THEN PROCEED.  IF THE CAUSE ISN'T DUE TO     */
*/*   LOG PROBLEMS THEN WE CAUSE THE CALLER TO BE ABENDED.           */
*/*                                                                  */
*/*   INPUT - THE INPUT PARM IS THE PTR IN XVSAV THAT WILL HOLD THE  */
*/*            CONTROL BLOCKS ADDR. EITHER XVOREAD OR XVWQEAD. THIS  */
*/*            FIELD IS ZERO ON INPUT.                               */
*/*            UCMWQLM AND UCMRQLM ARE THE LIMITS ON THE NUMBER OF   */
*/*            WQES AND ORES THAT WERE SET BY SYSGEN                 */
*/*            UCMWQLM1 AND UCMRQLM1 WERE THE LIMITS SET AT IPL      */
*/*            UCMFMSGN IS A FLAG WHICH WHEN ON TELLS        @ZA11392*/
*/*            IEAVMQWR NOT TO ISSUE ANY WQE THRESHOLD MSGS. @ZA11392*/
*/*                                                                  */
*/*   OUTPUT - BLKADDR IS RETURNED AS ZERO OR ONE. ZERO MEANS THAT   */
*/*            THE ERROR WAS RECOVERED, TRY TO GET ANOTHER CELL.     */
*/*            ONE MEANS THAT THE ERROR COULD NOT BE RECOVERED,      */
*/*            SO ABEND THE CALLER.                                  */
*/*            FLAG UCMFMSGN WILL BE ON.                     @ZA11392*/
*/*                                                                  */
*/********************************************************************/
*                                                                  0623
*VWTOLREC:                                                         0623
*   PROC(BLKADDR);                                                 0623
         B     @PB00002                                            0623
VWTOLREC STM   @14,@12,@SA00002                                    0623
         MVC   @PC00002(4),0(@01)                                  0623
*   DCL                                                            0624
*     BLKADDR PTR(31);              /* PTR TO BLOCK BEING OBTAINED BY
*                                      VWTOGETB WHEN PROBLEM OCCURED */
*                                                                  0624
*   /*****************************************************************/
*   /*                                                               */
*   /* SET FLAG TO INFORM IEAVMQWR NOT TO ISSUE ANY MESSAGES ABOUT   */
*   /* WQE USE.                                              @ZA11392*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0625
*   UCMFMSGN='1'B;                  /* FLAG IS IN UCM FIXED EXTENSION
*                                                            @ZA11392*/
*                                                                  0625
         L     @10,UCMBASPT(,REG3)                                 0625
         LR    @08,@10                                             0625
         AL    @08,@CF03345                                        0625
         L     @08,UCMEXTPT(,@08)                                  0625
         L     @08,UCMFXPTR(,@08)                                  0625
         OI    UCMFMSGN(@08),B'00100000'                           0625
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK IF ERROR DUE TO HC GOING TO UNINITIALIZED SYSLOG        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0626
*   IF UCMSYSG='1'B&                /* IS SYSLOG THE HARDCOPY DEVICE */
*       BALOGINT='0'B THEN          /* AND LOG NOT INITIALIZED YET 0626
*                                                            @ZA11392*/
         LR    @08,@10                                             0626
         AL    @08,@CF03336                                        0626
         L     @08,UCMMCSPT(,@08)                                  0626
         TM    UCMSYSG(@08),B'00000010'                            0626
         BNO   @RF00626                                            0626
         L     @02,CVTMSER(,REG3)                                  0626
         TM    BALOGINT(@02),B'10000000'                           0626
         BNZ   @RF00626                                            0626
*     DO;                                                          0627
*                                                                  0627
*       /*************************************************************/
*       /*                                                           */
*       /* SWITCH THE LIMITS FOR NUMBER OF ORES AND WQES ALLOWED IN  */
*       /* THE SYSTEM AT ONE TIME                                    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0628
*       UCMWQLM=UCMWQLM1;           /* SET SYSGENED LIMIT TO IPL   0628
*                                      LIMIT                         */
         LH    @02,UCMWQLM1(,@10)                                  0628
         STH   @02,UCMWQLM(,@10)                                   0628
*       UCMRQLM=UCMRQLM1;           /* FOR WQES AND ORES.            */
*                                                                  0629
         IC    @02,UCMRQLM1(,@10)                                  0629
         STC   @02,UCMRQLM(,@10)                                   0629
*       /*************************************************************/
*       /*                                                           */
*       /* NOW POST COMMTASK TO SWITCH HARDCOPY                      */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0630
*       UCMSYSO='1'B;               /* THIS IS A DUMMY ATTN INTERUPT
*                                      BY SVC 35                     */
         OI    UCMSYSO(@08),B'00000010'                            0630
*       CALL FREELOCK;              /* FREE THE FRR AND LOCKS        */
         BAL   @14,FREELOCK                                        0631
*       XVA0=ADDR(UCMAECB);         /* POST ATTN ECB                 */
         L     @10,UCMBASPT(,REG3)                                 0632
         LA    @08,UCMAECB(,@10)                                   0632
         ST    @08,XVA0(,RBSECPTR)                                 0632
*       XVA4=UCMASCB;               /* COMMTASK'S ASCB ADDR          */
         L     @08,UCMASCB(,@10)                                   0633
         ST    @08,XVA4(,RBSECPTR)                                 0633
*       XVA8=POSTRECY;              /* ADDR OF IEAVMEST              */
         L     @10,UCMWAKUP(,@10)                                  0634
         L     @10,POSTRECY(,@10)                                  0634
         ST    @10,XVA8(,RBSECPTR)                                 0634
*       RFY                                                        0635
*         REG1 RSTD;                                               0635
*       REG1=ADDR(XVA0);            /* LOAD PTR TO 3 WORD PARM LIST  */
         LA    REG1,XVA0(,RBSECPTR)                                0636
*       GEN( POST ,35,MF=(E,(1)));  /* POST WITH CODE OF 35 FOR WTO  */
          POST ,35,MF=(E,(1))
*       RFY                                                        0638
*         REG1 UNRSTD;                                             0638
*       CALL SETLOCK;               /* REGAIN THE LOCKS              */
         BAL   @14,SETLOCK                                         0639
*       IF XVD1PRIV='0'B THEN       /* MSG WASN'T ISSUED BY THE    0640
*                                      COMMTASK OR AN SIRB. THIS   0640
*                                      CHECK IS SO WE DON'T CAUSE AN
*                                      SIRB OR COMMTASK TO WAIT.   0640
*                                      INSTEAD THEY ARE ABENDED WITH
*                                      A D23 ABEND CODE      @ZA11392*/
         TM    XVD1PRIV(RBSECPTR),B'10000000'                      0640
         BNZ   @RF00640                                            0640
*         CALL VWTOWAIT(UCMWECBT);  /* WAIT FOR THE WQE LIMIT TO BE
*                                      REDUCED BELOW THE NEW LIMITS
*                                                            @ZA11392*/
         L     @10,UCMBASPT(,REG3)                                 0641
         LA    @10,UCMWECBT(,@10)                                  0641
         ST    @10,@AL00001                                        0641
         LA    @01,@AL00001                                        0641
         BAL   @14,VWTOWAIT                                        0641
*       ELSE                        /* MSG ISSUER WAS COMMTASK OR  0642
*                                      SIRB                  @ZA11392*/
*         BLKADDR=1;                /* SET PARAMETER ADDR TO ERROR 0642
*                                      COND SO ISSUER WILL BE ABENDED
*                                                            @ZA11392*/
         B     @RC00640                                            0642
@RF00640 L     @10,@PC00002                                        0642
         MVC   BLKADDR(4,@10),@CF00062                             0642
*     END;                                                         0643
*   ELSE                            /* ERROR NOT DUE TO SYSLOG. SET
*                                      ERROR RETURN INDICATOR.       */
*     BLKADDR=1;                    /* SET PARMAMETER ADDR TO ERROR
*                                      COND                          */
         B     @RC00626                                            0644
@RF00626 L     @10,@PC00002                                        0644
         MVC   BLKADDR(4,@10),@CF00062                             0644
*   RETURN;                         /* GO BACK TO CALLER             */
@EL00002 DS    0H                                                  0645
@EF00002 DS    0H                                                  0645
@ER00002 LM    @14,@12,@SA00002                                    0645
         BR    @14                                                 0645
*   END;                                                           0646
         B     @EL00002                                            0646
@PB00002 DS    0H                                                  0646
         EJECT
*                                                                  0647
*/********************************************************************/
*/*                                                                  */
*/*  VWTOCLNP - VWTO'S CLEAN UP ROUTINE.                             */
*/*                                                                  */
*/*   FUNCTION - THIS ROUTINE WILL BE CALLED IF THERE IS AN ERROR    */
*/*   IN VWTO WHILE IT WAS LOCKED AND BUILDING THE ORE OR WQE. THIS  */
*/*   ROUTINE WILL ATTEMP TO FREE THE ORE AND WQE. IT WILL THEN      */
*/*   RETURN TO IEAVMFRR WHICH WILL LET THE ERROR CONTINUE.          */
*/*                                                                  */
*/*  INPUT - REG 2 WILL POINT TO THE USERS FRR PARMLIST.             */
*/*          PARMRGAD WILL POINT TO THIS MODULES REG FRR SAVEAREA    */
*/*          REG13 WILL POINT TO IEAVMFRR'S SAVEAREA.                */
*/*          REG 14 AND 15 WILL BE THE RETURN AND ENTRY REGS.        */
*/*          XVSAV WILL CONTAIN INFORMATION ON LOCATION OF ORE/WQE   */
*/*                                                                  */
*/*    OUTPUT - IEAVMFRR'S REGS WILL BE RESTORED.                    */
*/*             THE ORE/WQE, IF ANY WILL BE FREED.                   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0647
*VWTOCLNP:                                                         0647
*   GEN;                                                           0647
*                                                                  0647
VWTOCLNP DS    0H                                                  0647
*                           /* SET UP THIS ENTRY POINT AND ALL REGS */
        USING *,REG15       TEMPORARY BASE REGISTER
        SAVE (14,12),,*  PUT NAME IN MODULE
        L     REG1,PARMRGAD(,REG2) PICK UP ADDR OF OUR SAVE AREA
        LM    REG3,REG12,14(REG1)  RESTORE OUR REGISTERS
        DROP  REG15         MODULE BASE REGS SHOULD BE SET UP NOW
*   /*****************************************************************/
*   /*                                                               */
*   /* NOW SAVE THE CALLER'S SAVE AREA ADDRESS                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0648
*   XVA8=REG13;                     /* USE THE XVSAV WORK AREA       */
         ST    REG13,XVA8(,RBSECPTR)                               0648
*   REG13=REG9;                     /* LOAD OUR OWN SAVEAREA ADDRESS */
         LR    REG13,REG9                                          0649
*   RFY                                                            0650
*    (REG0,                                                        0650
*     REG1) RSTD;                                                  0650
*                                                                  0650
*   /*****************************************************************/
*   /*                                                               */
*   /* NOW CHECK IF ORE WAS OBTAINED. IF SO THEN CHECK IF IS WAS ON  */
*   /* THE ORE QUEUE                                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0651
*   IF XVD1ALDN='1'B&               /* WERE WE THRU GETTING BLOCKS   */
*       XVOREAD>1 THEN              /* AND VALID ADDRESS IN THE    0651
*                                      OREADDR FLD                   */
         TM    XVD1ALDN(RBSECPTR),B'00100000'                      0651
         BNO   @RF00651                                            0651
         CLC   XVOREAD(4,RBSECPTR),@CF00062                        0651
         BNH   @RF00651                                            0651
*     DO;                           /* YES. CHECK IF ORE WAS ON THE
*                                      CHAIN                         */
*       DO REG1=ADDR(UCMRPYQ) BY 0 WHILE(REG1^=0);                 0653
         L     REG1,UCMBASPT(,REG3)                                0653
         LA    REG1,UCMRPYQ(,REG1)                                 0653
         B     @DE00653                                            0653
@DL00653 DS    0H                                                  0654
*         IF REG1->ORELKP=XVOREAD THEN/* DOES THIS LINK POINTER POINT
*                                      TO OUR ORE                    */
         L     @10,XVOREAD(,RBSECPTR)                              0654
         C     @10,ORELKP(,REG1)                                   0654
         BNE   @RF00654                                            0654
*           DO;                     /* YES. DECHAIN OUR ORE          */
*             REG1->ORELKP=XVOREAD->ORELKP;/* PUT PTR TO NEXT ORE IN
*                                      PREVIOUS ORE LINK FIELD       */
         L     @10,ORELKP(,@10)                                    0656
         ST    @10,ORELKP(,REG1)                                   0656
*             REG1=0;               /* GET OUT OF LOOP               */
         SLR   REG1,REG1                                           0657
*           END;                                                   0658
*         ELSE                      /* NO, NOT OURS. PT TO NEXT ORE  */
*           REG1=REG1->ORELKP;                                     0659
         B     @RC00654                                            0659
@RF00654 L     REG1,ORELKP(,REG1)                                  0659
*       END;                        /* THE ORE IS NOW OFF THE ORE  0660
*                                      CHAIN                         */
*                                                                  0660
@RC00654 DS    0H                                                  0660
@DE00653 LTR   REG1,REG1                                           0660
         BNZ   @DL00653                                            0660
*       /*************************************************************/
*       /*                                                           */
*       /* FREE THE ORE                                              */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0661
*       REG0=UCMORECP;              /* CELL POOL ID FOR IRES         */
         L     @10,UCMBASPT(,REG3)                                 0661
         L     REG0,UCMORECP(,@10)                                 0661
*       REG1=XVOREAD;               /* ADDR OF THE ORE               */
         L     REG1,XVOREAD(,RBSECPTR)                             0662
*       GEN(FREECELL CPID=(0),CELL=(1),BRANCH=YES);/* FREE ORE CELL  */
         FREECELL CPID=(0),CELL=(1),BRANCH=YES
*/********************************************************************/
*/*                                                                  */
*/* THIS ORE CELL MAY HAVE BEEN THE LAST ONE IN AN EXTENSION.@ZA05639*/
*/* IF SO THEN REG15 IS SET TO 20 BY FREECELL. IF THIS CONDI-@ZA05639*/
*/* TION IS FOUND THEN FREE THE EXTENSION. REG0 AND REG1 ARE @ZA05639*/
*/* ARE SET BY FREECELL.                                     @ZA05639*/
*/*                                                                  */
*/********************************************************************/
*                                                                  0664
*       RFY                                                        0664
*         REG15 RSTD;               /*                       @ZA14990*/
*       IF REG15=20 THEN            /* WAS CELL THE LAST IN AN     0665
*                                      EXTENSION             @ZA05639*/
*                                                                  0665
         C     REG15,@CF00333                                      0665
         BNE   @RF00665                                            0665
*         /***********************************************************/
*         /*                                                         */
*         /* YES, FREE THE EXTENSION.                                */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0666
*         GEN(FREEMAIN R,LV=(0),A=(1),BRANCH=YES);/*         @ZA05639*/
         FREEMAIN R,LV=(0),A=(1),BRANCH=YES
*       RFY                                                        0667
*         REG15 UNRSTD;             /*                       @ZA14990*/
@RF00665 DS    0H                                                  0668
*     END;                                                         0668
*                                                                  0668
*   /*****************************************************************/
*   /*                                                               */
*   /* NOW CHECK IF WQE WAS OBTAINED                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0669
*   IF XVD1ALDN='1'B&               /* WERE WE THRU GETTING BLOCKS   */
*       XVWQEAD>1 THEN              /* AND VALID ADDRESS IN THE    0669
*                                      WQEADDR FLD                   */
@RF00651 TM    XVD1ALDN(RBSECPTR),B'00100000'                      0669
         BNO   @RF00669                                            0669
         CLC   XVWQEAD(4,RBSECPTR),@CF00062                        0669
         BNH   @RF00669                                            0669
*     DO;                           /* YES. CHECK IF WQE WAS ON THE
*                                      CHAIN                         */
*       DO REG1=ADDR(UCMWTOQ) BY 0 WHILE(REG1^=0);                 0671
         L     REG1,UCMBASPT(,REG3)                                0671
         LA    REG1,UCMWTOQ(,REG1)                                 0671
         B     @DE00671                                            0671
@DL00671 DS    0H                                                  0672
*         IF REG1->WQELKPA=XVWQEAD THEN/* DOES THIS LINK POINTER   0672
*                                      POINT TO OUR WQE              */
         L     @10,XVWQEAD(,RBSECPTR)                              0672
         L     @08,WQELKPA-1(,REG1)                                0672
         LA    @08,0(,@08)                                         0672
         CR    @10,@08                                             0672
         BNE   @RF00672                                            0672
*           DO;                     /* YES. DECHAIN OUR WQE          */
*             REG1->WQELKPA=XVWQEAD->WQELKPA;/* PUT PTR TO NEXT WQE
*                                      IN PREVIOUS WQE LINK FIELD    */
         MVC   WQELKPA(3,REG1),WQELKPA(@10)                        0674
*             IF UCMWQEND=XVWQEAD THEN/* WAS THIS WQE THE LAST ON THE
*                                      CHAIN?                @ZA14990*/
         L     @08,UCMBASPT(,REG3)                                 0675
         C     @10,UCMWQEND(,@08)                                  0675
         BNE   @RF00675                                            0675
*               UCMWQEND=REG1;      /* YES. UPDATE PTR IN UCM TO   0676
*                                      POINT TO NEW END OF WQE CHAIN.
*                                                            @ZA14990*/
         ST    REG1,UCMWQEND(,@08)                                 0676
*             REG1=0;               /* GET OUT OF LOOP               */
@RF00675 SLR   REG1,REG1                                           0677
*           END;                                                   0678
*         ELSE                      /* NO, NOT OURS. PT TO NEXT WQE  */
*           REG1=REG1->WQELKPA;                                    0679
         B     @RC00672                                            0679
@RF00672 L     @10,WQELKPA-1(,REG1)                                0679
         LA    @10,0(,@10)                                         0679
         LR    REG1,@10                                            0679
*       END;                        /* THE WQE IS NOW OFF THE WQE  0680
*                                      CHAIN                         */
*                                                                  0680
@RC00672 DS    0H                                                  0680
@DE00671 LTR   REG1,REG1                                           0680
         BNZ   @DL00671                                            0680
*       /*************************************************************/
*       /*                                                           */
*       /* FREE THE WQE                                              */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0681
*       REG0=UCMWQECP;              /* CELL POOL ID FOR WQES         */
         L     @10,UCMBASPT(,REG3)                                 0681
         L     REG0,UCMWQECP(,@10)                                 0681
*       REG1=XVWQEAD;               /* ADDR OF THE WQE               */
         L     REG1,XVWQEAD(,RBSECPTR)                             0682
*       GEN(FREECELL CPID=(0),CELL=(1),BRANCH=YES);/* FREE WQE CELL  */
         FREECELL CPID=(0),CELL=(1),BRANCH=YES
*/********************************************************************/
*/*                                                          @ZA05639*/
*/* THIS WQE CELL MAY HAVE BEEN THE LAST ONE IN AN EXTENSION.@ZA05639*/
*/* IF SO THEN REG15 IS SET TO 20 BY FREECELL. IF THIS CONDI-@ZA05639*/
*/* TION IS FOUND THEN FREE THE EXTENSION. REG0 AND REG1 ARE @ZA05639*/
*/* SET BY FREECELL                                          @ZA05639*/
*/*                                                          @ZA05639*/
*/********************************************************************/
*                                                                  0684
*       RFY                                                        0684
*         REG15 RSTD;               /*                       @ZA14990*/
*       IF REG15=20 THEN            /* WAS CELL THE LAST IN AN     0685
*                                      EXTENSION             @ZA05639*/
*                                                                  0685
         C     REG15,@CF00333                                      0685
         BNE   @RF00685                                            0685
*         /***********************************************************/
*         /*                                                         */
*         /* YES, FREE THE EXTENSION.                                */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0686
*         GEN(FREEMAIN R,LV=(0),A=(1),BRANCH=YES);                 0686
         FREEMAIN R,LV=(0),A=(1),BRANCH=YES
*       RFY                                                        0687
*         REG15 UNRSTD;             /*                       @ZA14990*/
@RF00685 DS    0H                                                  0688
*     END;                                                         0688
*   REG13=XVA8;                     /* RESTORE CALLER'S SAVE AREA  0689
*                                      ADDR                          */
@RF00669 L     REG13,XVA8(,RBSECPTR)                               0689
*   GEN EXIT NOSEQFLOW(RETURN (14,12));/* GO BACK TO IEAVMFRR ROUTINE*/
         RETURN (14,12)
*   RFY                                                            0691
*    (REG0,                                                        0691
*     REG1) UNRSTD;                                                0691
         EJECT
*                                                                  0692
*/********************************************************************/
*/*                                                                  */
*/*   VWTOVALR                                                       */
*/*                                                                  */
*/*      FUNCTION THIS ROUTINE GETS CONTROL IF THERE IS AN ERROR     */
*/*      WHILE CHECKING OUT THE WPL. IT WILL TURN OFF THE VALIDITY   */
*/*      BIT (XVD1VALD) AND BRANCH TO VWTOCONT. THE USER WILL BE     */
*/*      ABENDED WITH A D23 ABEND CODE.                              */
*/*                                                                  */
*/********************************************************************/
*                                                                  0692
*VWTOVALR:                                                         0692
*   XVD2VALD='0'B;                  /* WPL IS NOT VALID              */
VWTOVALR NI    XVD2VALD(RBSECPTR),B'11101111'                      0692
*   PARMRTAD=0;                     /* CLEAR RETRY ADDR SO WE DONT 0693
*                                      LOOP                          */
         L     @10,PARMPTR                                         0693
         SLR   @08,@08                                             0693
         ST    @08,PARMRTAD(,@10)                                  0693
*   GO TO VWTOCONT;                 /* CONTINUE PROCESSING AND ABEND
*                                      USER                          */
         B     VWTOCONT                                            0694
         SPACE 5
*                                                                  0695
*/********************************************************************/
*/*                                                                  */
*/*  VWTOSSRT - RETYR ROUTINE FOR SUBSYTEM EXIT                      */
*/*                                                                  */
*/*  FUNCTION - THIS ROUTINE WILL GET CONTROL IF THERE WAS AN ERROR  */
*/*   IN THE SUBSYSTEM WTO EXIT ROUTINE. WE WILL TURN OFF XVD2DELW   */
*/*  SO THAT THE MESSAGE WILL BE SURE TO GO OUT.  THEN WE BRANCH TO  */
*/*  VWTOSSLB TO CONTINUE THE PROCESSING                             */
*/*                                                                  */
*/********************************************************************/
*                                                                  0695
*VWTOSSRT:                                                         0695
*   XVD2DELW='0'B;                  /* DONT DELETE THE MESSAGE       */
VWTOSSRT NI    XVD2DELW(RBSECPTR),B'11110111'                      0695
*   GO TO VWTOSSLB;                 /* CONTINUE WITH PROCESSING      */
         B     VWTOSSLB                                            0696
         EJECT
*                                                                  0697
*/********************************************************************/
*/*  GETBLOCK                                                        */
*/*                                                                  */
*/*  FUNCTION: THIS ROUTINE WILL GET CORE FOR EITHER A WQE OR ORE.   */
*/*     THE OBTAINED CORE WILL BE ZEROED OUT.                        */
*/*                                                                  */
*/*  INPUT: TYPE INDICATES THE TYPE OF BLOCK TO GET. WQE OR ORE      */
*/*          XVD0WWB MAY BE ON INDICATING THAT A WWB HAS BEEN        */
*/*     OBTAINED.                                                    */
*/*         XVWWB POINTS AT THE WWB.                                 */
*/*                                                                  */
*/*  OUTPUT: A BLOCK OF THE PROPER SIZE AND ZEROED IS RETURNED TO THE*/
*/*     CALLER. IF THE USER WAS ON THE WAIT CHAIN, THE WAIT ECB IS   */
*/*     REMOVED.                                                     */
*/*     IF THE GETCELL WAS UNSUCCESSFUL THEN THE ADDR PTR IS SET TO  */
*/*     ONE INSTEAD OF BEING THE ADDR OF THE NEW CELL.               */
*/*                                                                  */
*/********************************************************************/
*                                                                  0697
*VWTOGETB:                                                         0697
*   PROC(TYPE) OPTIONS(SAVE(14),NOSAVEAREA);                       0697
VWTOGETB ST    @14,12(,@13)                                        0697
         MVC   @PC00003(4),0(@01)                                  0697
*   DCL                                                            0698
*     TYPE FIXED(31);               /* INDICATES TYPE OF BLOCK TO GET*/
*   DCL                                                            0699
*     BITZERO BIT(*) BASED;         /* USED TO ZERO OUT THE BLOCK    */
*   RFY                                                            0700
*    (REG0,                                                        0700
*     REG1,                                                        0700
*     REG15) RSTD;                                                 0700
*                                                                  0700
*/********************************************************************/
*/*                                                                  */
*/* CHECK IF REQUEST IS FOR AN ORE OR FOR A WQE                      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0701
*   IF TYPE=2 THEN                  /* IS THIS REQUEST FOR AN ORE?   */
         L     @14,@PC00003                                        0701
         CLC   TYPE(4,@14),@CF00088                                0701
         BNE   @RF00701                                            0701
*     DO;                           /* YES. GET AN ORE CELL          */
*       XVOREAD=0;                  /* SET ADDR TO ZERO SO IT CAN BE
*                                      USED TO INDICATE SUCCESS OF 0703
*                                      GETCELL                       */
         SLR   @14,@14                                             0703
         ST    @14,XVOREAD(,RBSECPTR)                              0703
*       DO WHILE(XVOREAD=0);        /* LOOP UNTILL XVOREAD GETS    0704
*                                      FILLED IN                     */
         B     @DE00704                                            0704
@DL00704 DS    0H                                                  0705
*         REG0=UCMORECP;            /* PICK UP ORE CELL POOL ID      */
         L     @14,UCMBASPT(,REG3)                                 0705
         L     REG0,UCMORECP(,@14)                                 0705
*         GEN(GETCELL CPID=(0),BRANCH=YES)                         0706
*         REFS(REG0,CVTGETCL) SETS(REG1,REG15);                    0706
*                                                                  0706
         GETCELL CPID=(0),BRANCH=YES
*/********************************************************************/
*/*                                                                  */
*/* SEE IF GETCELL WAS SUCCESSFUL                                    */
*/*                                                                  */
*/********************************************************************/
*                                                                  0707
*         IF REG15=0 THEN           /* DID WE GET A CELL             */
         LTR   REG15,REG15                                         0707
         BNZ   @RF00707                                            0707
*           DO;                                                    0708
*             XVOREAD=REG1;         /* SAVE ADDRESS TO ORE           */
*                                                                  0709
         ST    REG1,XVOREAD(,RBSECPTR)                             0709
*             /*******************************************************/
*             /*                                                     */
*             /* ZERO OUT THE CONTROL BLOCK                          */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0710
*             REG1->BITZERO(1:LENGTH(OREF)*8)=''B;                 0710
         XC    BITZERO(32,REG1),BITZERO(REG1)                      0710
*             UCMRQNR=UCMRQNR+1;    /* INCREMENT ORE COUNT BY ONE    */
         L     @14,UCMBASPT(,REG3)                                 0711
         LA    @10,1                                               0711
         AH    @10,UCMRQNR(,@14)                                   0711
         STH   @10,UCMRQNR(,@14)                                   0711
*           END;                                                   0712
*         ELSE                      /* NO THE GETCELL WAS NOT      0713
*                                      SUCCESSFUL                    */
*/********************************************************************/
*/*                                                                  */
*/* WE DID NOT GET A CELL. CHECK IF WE ARE OUT OF CELLS. IF SO       */
*/* THEN GET AN EXTENSION.                                           */
*/*                                                                  */
*/********************************************************************/
*                                                                  0713
*           IF REG15=4 THEN         /* DO WE NEED TO EXTEND THE CELL
*                                      POOL                          */
         B     @RC00707                                            0713
@RF00707 C     REG15,@CF00084                                      0713
         BNE   @RF00713                                            0713
*             DO;                   /* YES.                          */
*               REG1=SUBPL231;      /* SET UP FOR GETMAIN FROM     0715
*                                      SUBPOOL 231                   */
         LA    REG1,231                                            0715
*               REG0=OREPLSZ;       /* PICK UP SIZE OF ORE POOL    0716
*                                      EXTENSION.                    */
         LA    REG0,1024                                           0716
*               GEN(GETMAIN  RC,LV=(0),SP=(1),BRANCH=YES)          0717
*               REFS(REG0,REG1,REG4,REG7,CVTCRMN) SETS(REG1,REG3,REG15)
*                   ;                                              0717
         GETMAIN  RC,LV=(0),SP=(1),BRANCH=YES
*               REG3=CVTPTR;        /* RELOAD REG3 WHICH WAS       0718
*                                      DESTROYED BY THE GETMAIN    0718
*                                      CALLING SEQUENCE.             */
*                                                                  0718
         L     REG3,CVTPTR                                         0718
*               /*****************************************************/
*               /*                                                   */
*               /* SEE IF GETMAIN WAS SUCCESSFUL. IF SO BUILD EXTEN. */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0719
*               IF REG15=0 THEN     /* WAS CORE OBTAINED.            */
         LTR   REG15,REG15                                         0719
         BNZ   @RF00719                                            0719
*                 DO;               /* YES. EXTEND THE ORE POOL      */
*                   CPEXTSAV=REG1;  /* SAVE ADDR OF POOL EXTENSION.  */
         LR    CPEXTSAV,REG1                                       0721
*                   REG15=LENGTH(OREF);/* GET SIZE OF CELL REQUIRED
*                                      FOR BLD                       */
         LA    REG15,32                                            0722
*                   REG0=UCMORECP;  /* PICK UP ORE CELL POOL ID.     */
         L     @14,UCMBASPT(,REG3)                                 0723
         L     REG0,UCMORECP(,@14)                                 0723
*                   GEN REFS(REG0,REG1,REG2,CVTBLDCP) SETS(REG15); 0724
*                                                                  0724
               BLDCPOOL  CPID=(0),CSIZE=(15),SP=231,CPADDR=(1),       **
               BRANCH=YES,POOLSIZ=1,AUTODEL=YES,SERIAL=YES    @ZA20159
*/********************************************************************/
*/*                                                                  */
*/* CHECK IF EXTENSION WAS SUCCESSFUL. IF NOT SET ERROR FLAG ON      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0725
*                   IF REG15^=0 THEN/* WAS EXTENSION UNSUCCESSFUL    */
         LTR   REG15,REG15                                         0725
         BZ    @RF00725                                            0725
*                     DO;           /* YES. INDICATE SO IN XVOREAD   */
*                                                                  0726
*                       /*********************************************/
*                       /*                                           */
*                       /* FREE THE CORE FOR THE EXTENSION           */
*                       /*                                           */
*                       /*********************************************/
*                                                                  0727
*                       REG0=FROREXT;/* GET SUBPOOL AND LENGTH PARM  */
         L     REG0,FROREXT                                        0727
*                       REG1=CPEXTSAV;/* GET ADDR OF EXTENSION.      */
         LR    REG1,CPEXTSAV                                       0728
*                       GEN(FREEMAIN R,LV=(0),A=(1),BRANCH=YES)    0729
*                       REFS(REG0,REG1);                           0729
         FREEMAIN R,LV=(0),A=(1),BRANCH=YES
*                       XVOREAD=1;  /* INDICATE NO ORE OBTAINED.     */
         MVC   XVOREAD(4,RBSECPTR),@CF00062                        0730
*                     END;                                         0731
*                 END;                                             0732
*               ELSE                                               0733
*                                                                  0733
*                 /***************************************************/
*                 /*                                                 */
*                 /* GETMAIN WAS NOT SUCCESSFUL. CALL ROUTINE TO TO  */
*                 /* CHECK IF ERROR IS DUE TO SYSLOG NOT YET         */
*                 /* INITIALIZED                                     */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0733
*                 CALL VWTOLREC(XVOREAD);                          0733
         B     @RC00719                                            0733
@RF00719 LA    @14,XVOREAD(,RBSECPTR)                              0733
         ST    @14,@AL00001                                        0733
         LA    @01,@AL00001                                        0733
         BAL   @14,VWTOLREC                                        0733
*             END;                  /* OF TEST FOR EXTENSION NEEDED. */
*           ELSE                                                   0735
*                                                                  0735
*/********************************************************************/
*/*                                                                  */
*/* THE ERROR WAS NOT DUE TO END OF EXTENSION. THE ERROR CAN NOT     */
*/* BE CORRECTED SO SET ERROR INDICATOR FOR CALLER.                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0735
*             XVOREAD=1;            /* INDICATE GET ORE UNSUCCESSFUL */
         B     @RC00713                                            0735
@RF00713 MVC   XVOREAD(4,RBSECPTR),@CF00062                        0735
*       END;                        /* OF DO WHILE LOOP              */
@RC00713 DS    0H                                                  0736
@RC00707 DS    0H                                                  0736
@DE00704 L     @14,XVOREAD(,RBSECPTR)                              0736
         LTR   @14,@14                                             0736
         BZ    @DL00704                                            0736
*     END;                                                         0737
*                                                                  0737
*   /*****************************************************************/
*   /*                                                               */
*   /* WQE GET CELL PART OF THIS SEGMENT                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0738
*   ELSE                            /* NO THIS REQUEST IS FOR A WQE  */
*     DO;                                                          0738
         B     @RC00701                                            0738
@RF00701 DS    0H                                                  0739
*       XVWQEAD=0;                  /* ZERO OUT ADDR SO IT CAN BE  0739
*                                      USED TO INDICATE SUCCESS OR 0739
*                                      FAILURE OF GETCELL.           */
         SLR   @14,@14                                             0739
         ST    @14,XVWQEAD(,RBSECPTR)                              0739
*       DO WHILE(XVWQEAD=0);        /* LOOP UNTILL ADDR GETS FILLED
*                                      IN.                           */
         B     @DE00740                                            0740
@DL00740 DS    0H                                                  0741
*         REG0=UCMWQECP;            /* PICK UP WQE CELL POOL ID.     */
         L     @14,UCMBASPT(,REG3)                                 0741
         L     REG0,UCMWQECP(,@14)                                 0741
*         GEN(GETCELL CPID=(0),BRANCH=YES)                         0742
*         REFS(REG0) SETS(REG1,REG15);                             0742
*                                                                  0742
         GETCELL CPID=(0),BRANCH=YES
*/********************************************************************/
*/*                                                                  */
*/* SEE IF GETCELL WAS SUCCESSFUL                                    */
*/*                                                                  */
*/********************************************************************/
*                                                                  0743
*         IF REG15=0 THEN           /* DID WE GET A CELL             */
         LTR   REG15,REG15                                         0743
         BNZ   @RF00743                                            0743
*           DO;                                                    0744
*             XVWQEAD=REG1;         /* SAVE ADDRESS TO WQE           */
*                                                                  0745
         ST    REG1,XVWQEAD(,RBSECPTR)                             0745
*             /*******************************************************/
*             /*                                                     */
*             /* ZERO OUT THE CONTROL BLOCK                          */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0746
*             REG1->BITZERO(1:LENGTH(WQE)*8)=''B;                  0746
         XC    BITZERO(192,REG1),BITZERO(REG1)                     0746
*             UCMWQNR=UCMWQNR+1;    /* INCREMENT WQE COUNT           */
         L     @14,UCMBASPT(,REG3)                                 0747
         LA    @10,1                                               0747
         AH    @10,UCMWQNR(,@14)                                   0747
         STH   @10,UCMWQNR(,@14)                                   0747
*           END;                                                   0748
*                                                                  0748
*/********************************************************************/
*/*                                                                  */
*/* WE DID NOT GET A CELL. CHECK IF WE ARE OUT OF CELLS. IF SO       */
*/* THEN GET AN EXTENSION.                                           */
*/*                                                                  */
*/********************************************************************/
*                                                                  0749
*         ELSE                                                     0749
*           IF REG15=4 THEN         /* DO WE NEED TO EXTEND THE CELL
*                                      POOL                          */
         B     @RC00743                                            0749
@RF00743 C     REG15,@CF00084                                      0749
         BNE   @RF00749                                            0749
*             DO;                   /* YES.                          */
*               REG1=SUBPL231;      /* SET UP FOR GETMAIN FROM 231   */
         LA    REG1,231                                            0751
*               REG0=WQEPLSZ;       /* PICK UP SIZE OF WQE EXTENSION */
         L     REG0,@CF00308                                       0752
*               GEN(GETMAIN  RC,LV=(0),SP=(1),BRANCH=YES)          0753
*               REFS(REG0,REG1,REG4,REG7,CVTCRMN) SETS(REG1,REG3,REG15)
*                   ;                                              0753
         GETMAIN  RC,LV=(0),SP=(1),BRANCH=YES
*               REG3=CVTPTR;        /* RELOAD REG3 WHICH WAS       0754
*                                      DESTROYED BY THE GETMAIN    0754
*                                      CALLING SEQUENCE.             */
*                                                                  0754
         L     REG3,CVTPTR                                         0754
*               /*****************************************************/
*               /*                                                   */
*               /* SEE IF GETMAIN WAS SUCCESSFUL. IF SO BUILD        */
*               /* EXTENSION.                                        */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0755
*               IF REG15=0 THEN     /* DID WE GET SPACE FOR THE    0755
*                                      EXTENSION                     */
         LTR   REG15,REG15                                         0755
         BNZ   @RF00755                                            0755
*                 DO;               /* YES, BUILD THE WQE EXTENSION  */
*                   CPEXTSAV=REG1;  /* SAVE ADDRES OF WQE EXTENSION  */
         LR    CPEXTSAV,REG1                                       0757
*                   REG0=UCMWQECP;  /* PICK UP THE WQE CELL POOL ID  */
         L     @14,UCMBASPT(,REG3)                                 0758
         L     REG0,UCMWQECP(,@14)                                 0758
*                   REG15=LENGTH(WQE);/* GET SIZE OF CELL REQUIRED.  */
         LA    REG15,192                                           0759
*                   GEN REFS(REG0,REG1,REG2,CVTBLDCP) SETS(REG15); 0760
*                                                                  0760
         BLDCPOOL CPID=(0),SP=231,CSIZE=(15),CPADDR=(1),BRANCH=YES,   **
               AUTODEL=YES,POOLSIZ=4,SERIAL=YES               @ZA20159
*/********************************************************************/
*/*                                                                  */
*/* CHECK IF EXTENSION WAS SUCCESSFUL. IF NOT SET ERROR FLAG ON      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0761
*                   IF REG15^=0 THEN/* WAS EXTENSION UNSUCCESSFUL    */
         LTR   REG15,REG15                                         0761
         BZ    @RF00761                                            0761
*                     DO;           /* YES. INDICATE SO IN XVWQEAD   */
*                                                                  0762
*                       /*********************************************/
*                       /*                                           */
*                       /* FREE THE WQE POOL EXTENSION.              */
*                       /*                                           */
*                       /*********************************************/
*                                                                  0763
*                       REG0=FRWQEXT;/* GET SUBPOOL AND LENGTH       */
         L     REG0,FRWQEXT                                        0763
*                       REG1=CPEXTSAV;/* GET ADDRESS OF WQE EXTENSION*/
         LR    REG1,CPEXTSAV                                       0764
*                       GEN(FREEMAIN R,LV=(0),A=(1),BRANCH=YES)    0765
*                       REFS(REG0,REG1);                           0765
         FREEMAIN R,LV=(0),A=(1),BRANCH=YES
*                       XVWQEAD=1;  /* INDICATE NO WQE OBTAINED.     */
         MVC   XVWQEAD(4,RBSECPTR),@CF00062                        0766
*                     END;                                         0767
*                 END;                                             0768
*                                                                  0768
*               /*****************************************************/
*               /*                                                   */
*               /* THE GETMAIN WAS NOT SUCCESSFUL. CALL THE LOG      */
*               /* RECOVERY ROUTINE TO SEE IF ERROR DUE TO SYSLOG    */
*               /* INIT                                              */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0769
*               ELSE                                               0769
*                 CALL VWTOLREC(XVWQEAD);/* LOG RECOVERY ROUTINE     */
         B     @RC00755                                            0769
@RF00755 LA    @14,XVWQEAD(,RBSECPTR)                              0769
         ST    @14,@AL00001                                        0769
         LA    @01,@AL00001                                        0769
         BAL   @14,VWTOLREC                                        0769
*             END;                  /* OF CHECK FOR EXTENSION NEEDED.*/
*/********************************************************************/
*/*                                                                  */
*/* THE ERROR WAS NOT DUE TO END OF EXTENSION. THE ERROR CAN NOT     */
*/* BE CORRECTED SO SET ERROR INDICATOR FOR CALLER.                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0771
*           ELSE                                                   0771
*             XVWQEAD=1;            /* INDICATE GET WQE UNSUCCESSFUL */
         B     @RC00749                                            0771
@RF00749 MVC   XVWQEAD(4,RBSECPTR),@CF00062                        0771
*       END;                        /* OF DO WHILE LOOP              */
@RC00749 DS    0H                                                  0772
@RC00743 DS    0H                                                  0772
@DE00740 L     @14,XVWQEAD(,RBSECPTR)                              0772
         LTR   @14,@14                                             0772
         BZ    @DL00740                                            0772
*     END;                                                         0773
*                                                                  0773
*/********************************************************************/
*/*                                                                  */
*/* CHECK IF WE HAVE TO FREE THE ECB                                 */
*/*                                                                  */
*/********************************************************************/
*                                                                  0774
*   IF XVD0WWB='1'B THEN            /* IS THERE A WWB ON THE CHAIN   */
@RC00701 TM    XVD0WWB(RBSECPTR),B'00000100'                       0774
         BNO   @RF00774                                            0774
*     DO;                           /* YES, FREE IT AND TURN OFF   0775
*                                      XVD0WWB                       */
*                                                                  0775
*       /*************************************************************/
*       /*                                                           */
*       /* POINT NEXT WWB AT BACK WWB                                */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0776
*       WWBFWDPT->WWBBCKPT=WWBBCKPT;                               0776
*                                                                  0776
         L     @14,XVWWB(,RBSECPTR)                                0776
         L     @10,WWBFWDPT(,@14)                                  0776
         L     @08,WWBBCKPT(,@14)                                  0776
         ST    @08,WWBBCKPT(,@10)                                  0776
*       /*************************************************************/
*       /*                                                           */
*       /* POINT BACK WWB AT NEXT WWB                                */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0777
*       WWBBCKPT->WWBFWDPT=WWBFWDPT;                               0777
*                                                                  0777
         ST    @10,WWBFWDPT(,@08)                                  0777
*/********************************************************************/
*/*                                                                  */
*/* WWB IS NOW OFF THE QUEUE. FREE IT                                */
*/*                                                                  */
*/********************************************************************/
*                                                                  0778
*       REG0=GETWWB;                /* PICK PARMS FOR FREEMAIN       */
         L     REG0,GETWWB                                         0778
*       REG1=XVWWB;                 /* GET ADDRESS OF WWB            */
         LR    REG1,@14                                            0779
*       GEN(FREEMAIN R,LV=(0),A=(1),BRANCH=YES)                    0780
*       REFS(REG0,REG1);                                           0780
         FREEMAIN R,LV=(0),A=(1),BRANCH=YES
*       RFY                                                        0781
*        (REG0,                                                    0781
*         REG1,                                                    0781
*         REG15) UNRSTD;                                           0781
*       XVWWB=0;                    /* ZERO OUT ADDRESS OF WWB IN XSA*/
         SLR   @10,@10                                             0782
         ST    @10,XVWWB(,RBSECPTR)                                0782
*       XVD0WWB='0'B;               /* INDICATE NO WWB ON CHAIN      */
         NI    XVD0WWB(RBSECPTR),B'11111011'                       0783
*     END;                                                         0784
*   RETURN;                                                        0785
@EL00003 DS    0H                                                  0785
@EF00003 DS    0H                                                  0785
@ER00003 L     @14,12(,@13)                                        0785
         BR    @14                                                 0785
*   END VWTOGETB;                                                  0786
         B     @EL00003                                            0786
         EJECT
*                                                                  0787
*/*** START OF WAITCHN  **********************************************/
*/********************************************************************/
*/*                                                                  */
*/*   WAITCHN - WAIT ON THE ECB IN THE WWB                           */
*/*                                                                  */
*/*   FUNCTION - THIS ROUTINE WILL CREATE A WWB AND PUT IT ON THE    */
*/*     CHAIN POINTED AT BY THE INPUT PARAMETER. IF A WWB ALREADY    */
*/*     EXISTS THE ECB PART IS ZEROED. THE ROUTINE FREES THE LOCKS   */
*/*     AND THEN WAITS FOR THE ECB TO BE POSTED. THE LOCKS ARE       */
*/*     THEN OBTAINED.                                               */
*/*                                                                  */
*/********************************************************************/
*                                                                  0787
*VWTOWAIT:                                                         0787
*   PROC(CHNTAIL) OPTIONS(SAVE(14));                               0787
VWTOWAIT ST    @14,@SA00004                                        0787
         MVC   @PC00004(4),0(@01)                                  0787
*   DCL                                                            0788
*     CHNTAIL PTR(31);              /* PTS AT END OF WQE WWB CHAIN OR
*                                      ORE WWB CHAIN                 */
*/********************************************************************/
*/*                                                                  */
*/*  CHECK IF A WWB ALREADY EXISTS. IF ONE DOES THEN IT IS ON THE    */
*/*  PROPER CHAIN.                                                   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0789
*   IF XVD0WWB='0'B THEN            /* DO WE NEED TO GET A WWB       */
         TM    XVD0WWB(RBSECPTR),B'00000100'                       0789
         BNZ   @RF00789                                            0789
*     DO;                           /* YES, GET IT AND PUT IT ON THE
*                                      CHAIN                         */
*       RFY                                                        0791
*        (REG0,                                                    0791
*         REG1) RSTD;               /* BOTH REG 0 AND 1 WILL BE USED
*                                      FOR THE GETMAIN.              */
*       REG0=GETWWB;                /* PICK UP GETMAIN PARMS FOR WWB */
         L     REG0,GETWWB                                         0792
*       GEN(GETMAIN R,LV=(0),BRANCH=YES)                           0793
*       REFS(REG0) SETS(REG1);                                     0793
         GETMAIN R,LV=(0),BRANCH=YES
*       XVWWB=REG1;                 /* SAVE ADDR OF WWB              */
         ST    REG1,XVWWB(,RBSECPTR)                               0794
*       XVD0WWB='1'B;               /* INDICATE WWB AVAILABLE        */
         OI    XVD0WWB(RBSECPTR),B'00000100'                       0795
*       RFY                                                        0796
*         WWB BASED(REG1);          /* REG1 DOES PT AT WWB. USE REG1 */
*       WWBASCB=REG7;               /* STORE ADDR OF ASCB            */
         ST    REG7,WWBASCB(,REG1)                                 0797
*       WWBTCBAD=REG4;              /* STORE ADDR OF TCB             */
         ST    REG4,WWBTCBAD(,REG1)                                0798
*/********************************************************************/
*/*                                                                  */
*/* PUT WWB ON THE CHAIN                                             */
*/*                                                                  */
*/********************************************************************/
*                                                                  0799
*       /*************************************************************/
*       /*                                                           */
*       /* POINT THIS WWB AT WHATEVER OLD LAST WWB WAS POINTING AT   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0799
*       WWBFWDPT=CHNTAIL->WWBFWDPT;                                0799
         L     @10,@PC00004                                        0799
         L     @08,CHNTAIL(,@10)                                   0799
         L     @02,WWBFWDPT(,@08)                                  0799
         ST    @02,WWBFWDPT(,REG1)                                 0799
*       CHNTAIL->WWBFWDPT=REG1;     /* LINK LAST CHN MEMBER TO THIS
*                                      WWB                           */
         ST    REG1,WWBFWDPT(,@08)                                 0800
*       WWBBCKPT=CHNTAIL;           /* PT OUR WWB BACK AT OLD LAST 0801
*                                      WWB                           */
         ST    @08,WWBBCKPT(,REG1)                                 0801
*       CHNTAIL=REG1;               /* PT END OF CHAIN AT OUR WWB    */
         ST    REG1,CHNTAIL(,@10)                                  0802
*     END;                                                         0803
*                                                                  0803
*/********************************************************************/
*/*                                                                  */
*/*  NOW INDICATE ECB IS WAITING                                     */
*/*                                                                  */
*/********************************************************************/
*                                                                  0804
*   RFY                                                            0804
*     WWB BASED(XVWWB);                                            0804
@RF00789 DS    0H                                                  0805
*   WWBPOSTD='0'B;                  /* INDICATE NOT POSTED           */
         L     @10,XVWWB(,RBSECPTR)                                0805
         NI    WWBPOSTD(@10),B'01111111'                           0805
*   WWBECB=0;                       /* READY TO BE POSTED            */
         SLR   @08,@08                                             0806
         ST    @08,WWBECB(,@10)                                    0806
*   CALL FREELOCK;                                                 0807
         BAL   @14,FREELOCK                                        0807
*   REG1=ADDR(WWBECB);              /* LOAD ADDRESS OF ECB FOR WAIT  */
*                                                                  0808
         L     REG1,XVWWB(,RBSECPTR)                               0808
         LA    REG1,WWBECB(,REG1)                                  0808
*   /*****************************************************************/
*   /*                                                               */
*   /* NOW CHECK WHICH MEMORY WE ARE IN AND ISSUE APPROPRIATE WAIT,  */
*   /* LONG OR SHORT                                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0809
*   IF ASCBASID=1 THEN              /* IF IN MEMORY ONE THEN ISSUE 0809
*                                      SHORT WAIT AS WE ARE IN     0809
*                                      COMMTASKS MEMORY.             */
         CLC   ASCBASID(2,ASCBPTR),@CH00062                        0809
         BNE   @RF00809                                            0809
*     GEN(WAIT ,ECB=(REG1))                                        0810
*     REFS(REG1);                                                  0810
         WAIT ,ECB=(REG1)
*   ELSE                            /* WE ARE NOT IN MEMORY ONE SO 0811
*                                      ISSUE A LONG WAIT TO LET    0811
*                                      COMMTASK PUT OUT SOME MESSAGES
*                                      AND FREE UP SOME WQES.        */
*     GEN(WAIT ,ECB=(REG1),LONG=YES)                               0811
*     REFS(REG1);                                                  0811
         B     @RC00809                                            0811
@RF00809 DS    0H                                                  0811
         WAIT ,ECB=(REG1),LONG=YES
*   RFY                                                            0812
*    (REG0,                                                        0812
*     REG1) UNRSTD;                                                0812
@RC00809 DS    0H                                                  0813
*   CALL SETLOCK;                                                  0813
         BAL   @14,SETLOCK                                         0813
*   RETURN;                                                        0814
@EL00004 DS    0H                                                  0814
@EF00004 DS    0H                                                  0814
@ER00004 L     @14,@SA00004                                        0814
         BR    @14                                                 0814
*   END VWTOWAIT;                                                  0815
*                                                                  0815
*/*** END OF WAITCHN *************************************************/
*                                                                  0816
         EJECT
*                                                                  0816
*/********************************************************************/
*/*                                                                  */
*/* THIS ROUTINE WILL FREE THE ORE POINTED AT BY XVOREAD. IT WILL    */
*/* ALSO DECREASE THE COUNT OF ORES BY ONE TO ACCOUNT FOR THE ORE    */
*/* JUST FREED.                                                      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0816
*VWTOFORE:                                                         0816
*   PROC OPTIONS(SAVE(14),NOSAVEAREA);                             0816
VWTOFORE ST    @14,12(,@13)                                        0816
*   RFY                                                            0817
*    (REG0,                                                        0817
*     REG1,                                                        0817
*     REG15) RSTD;                                                 0817
*   REG0=UCMORECP;                  /* GET ORE CELL POOL ID          */
         L     @14,UCMBASPT(,REG3)                                 0818
         L     REG0,UCMORECP(,@14)                                 0818
*   REG1=XVOREAD;                   /* GET ADDRESS OF ORE            */
*                                                                  0819
         L     REG1,XVOREAD(,RBSECPTR)                             0819
*   /*****************************************************************/
*   /*                                                               */
*   /* FREE THE ORE                                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0820
*   GEN(FREECELL CPID=(0),CELL=(1),BRANCH=YES)                     0820
*   REFS(REG0,REG1,CVTFRECL) SETS(REG0,REG1,REG15);                0820
*                                                                  0820
         FREECELL CPID=(0),CELL=(1),BRANCH=YES
*/********************************************************************/
*/*                                                                  */
*/* THIS ORE CELL MAY HAVE BEEN THE LAST ONE IN AN EXTENSION.        */
*/* IF SO THEN REG15 IS SET TO 20 BY FREECELL. IF THIS CONDITON IS   */
*/* FOUND THEN FREE THE EXTENSION. REG0 AND REG1 ARE SET BY FREECELL */
*/*                                                                  */
*/********************************************************************/
*                                                                  0821
*   IF REG15=20 THEN                /* WAS CELL THE LAST IN AN     0821
*                                      EXTENSION                     */
*                                                                  0821
         C     REG15,@CF00333                                      0821
         BNE   @RF00821                                            0821
*     /***************************************************************/
*     /*                                                             */
*     /* YES, FREE THE EXTENSION.                                    */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0822
*     GEN(FREEMAIN R,LV=(0),A=(1),BRANCH=YES)                      0822
*     REFS(REG0,REG1,CVTABEND,SCVTRMBR,CVTRMBR,SCVTSECT);          0822
         FREEMAIN R,LV=(0),A=(1),BRANCH=YES
*   RFY                                                            0823
*    (REG0,                                                        0823
*     REG1,                                                        0823
*     REG15) UNRSTD;                                               0823
@RF00821 DS    0H                                                  0824
*   UCMRQNR=UCMRQNR-1;              /* DECREASE COUNT OF ORES.       */
         L     @10,UCMBASPT(,REG3)                                 0824
         LH    @08,UCMRQNR(,@10)                                   0824
         BCTR  @08,0                                               0824
         STH   @08,UCMRQNR(,@10)                                   0824
*   END VWTOFORE;                                                  0825
@EL00005 DS    0H                                                  0825
@EF00005 DS    0H                                                  0825
@ER00005 L     @14,12(,@13)                                        0825
         BR    @14                                                 0825
         EJECT
*                                                                  0826
*/*** START OF SETLOCK  **********************************************/
*/*                                                                  */
*/*   SETLOCK - OBTAIN THE LOCAL AND CMS LOCK AND INSTALL AN FRR     */
*/*                                                                  */
*/********************************************************************/
*/*                                                                  */
*/*  SAVE REGISTER 13 ACROSS SETLOCK                                 */
*/*                                                                  */
*/********************************************************************/
*                                                                  0826
*SETLOCK:                                                          0826
*   PROC OPTIONS(SAVE(0,1,11,12,13,14),NOSAVEAREA);                0826
SETLOCK  ST    @14,12(,@13)                                        0826
         STM   @00,@01,20(@13)                                     0826
         STM   @11,@12,64(@13)                                     0826
*   RFY                                                            0827
*    (REG0,                                                        0827
*     REG1) RSTD;                                                  0827
*   XVA4=REG13;                                                    0828
         ST    REG13,XVA4(,RBSECPTR)                               0828
*   GENERATE REFS(PSALITA,FLC);                                    0829
*                                                                  0829
*                             /*
        LR   REG0,REG11          SAVE FIRST BASE REG
        LR   REG1,REG12          SAVE SECOND BASE REG
        SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                        XX
               RELATED=(UCM,IEAVVWTO(FREELOCK))
        SETLOCK OBTAIN,TYPE=CMS,MODE=UNCOND,                          XX
               RELATED=(UCM,IEAVVWTO(FREELOCK))
        LR   REG11,REG0          RESTORE BASE REG
        LR   REG12,REG1          RESTORE BASE REG
*   /*****************************************************************/
*   /*                                                               */
*   /* NOW SET UP THE FRR PROTECTION FOR THIS MODULE.                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0830
*   RFY                                                            0830
*     REG13 RSTD;                   /* WE NEED REG 1                 */
*   REG13=UCMFRRAD;                 /* GET ADDR OF IEAVMFRR FROM CUM */
         L     @10,UCMBASPT(,REG3)                                 0831
         L     REG13,UCMFRRAD(,@10)                                0831
*   GEN REFS(PSACSTK,FRRSCURR,FRRSLAST,PSALSFCC,FRRSENTR,FRRSELEN, 0832
*       FRRSFRRA,FRRSPARM);                                        0832
*                                                                  0832
        SETFRR A,FRRAD=(REG13),PARMAD=PARMPTR,WRKREGS=(REG11,REG12)
        LR   REG11,REG0          RESTORE BASE REG
        LR   REG12,REG1          RESTORE BASE REG
*   /*****************************************************************/
*   /*                                                               */
*   /* FRR USES REGS 11 AND 12 AS WORK REGS. THE PARM LIST PTED AT BY*/
*   /* PARMPTR IS ZEROED BY SETFRR                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0833
*   PARMRGAD=ADDR(RECSAVE);         /* PUT ADDR OF SAVE AREA INTO  0833
*                                      PARM LIST                     */
         L     @10,PARMPTR                                         0833
         LA    @08,RECSAVE                                         0833
         ST    @08,PARMRGAD(,@10)                                  0833
*   PARMID=MODULEID;                /* INSERT LAST FOUR LETTERS OF 0834
*                                      NAME                          */
         MVC   PARMID(4,@10),@CC01464                              0834
*   RFY                                                            0835
*     PARMLIST BASED(ADDR(EPARM));  /* SET BASE BACK TO ESTAE      0835
*                                      PARMLIST                      */
*                                                                  0835
*   /*****************************************************************/
*   /*                                                               */
*   /* THE FOLLOWING PARMFRID FIELD IN THE ESTAE PARAMETER    YM04929*/
*   /* LIST IS SET TO ZERO TO GUARANTEE THAT RECOVERY WILL BE YM04929*/
*   /* DONE ON BOTH THE ESTAE AND FRR LEVEL.                  YM04929*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0836
*   PARMFRID='0'B;                  /* MODULE PROTECTED BY FRR AND 0836
*                                      ESTAE                  YM04929*/
         LA    @10,EPARM                                           0836
         NI    PARMFRID(@10),B'11101111'                           0836
*   RFY                                                            0837
*     PARMLIST BASED(PARMPTR);      /* RESTORE BASE TO FRR PARMLIST  */
*   RFY                                                            0838
*    (REG0,                                                        0838
*     REG13,                                                       0838
*     REG1) UNRSTD;                                                0838
*                                                                  0838
*   /*****************************************************************/
*   /*                                                               */
*   /* RESTORE THE REGISTERS FROM THE SETLOCK                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0839
*   REG13=XVA4;                     /* RESTORE SAVEAREA PTR    Y02751*/
         L     REG13,XVA4(,RBSECPTR)                               0839
*   END SETLOCK;                                                   0840
@EL00006 DS    0H                                                  0840
@EF00006 DS    0H                                                  0840
@ER00006 L     @14,12(,@13)                                        0840
         LM    @00,@01,20(@13)                                     0840
         LM    @11,@12,64(@13)                                     0840
         BR    @14                                                 0840
         EJECT
*                                                                  0841
*/*** START OF FREELOCK **********************************************/
*/*                                                                  */
*/*   FREELOCK - FREE THE LOCAL AND CMS LOCKS AND REMOVE THE FRR     */
*/*                                                                  */
*/********************************************************************/
*/********************************************************************/
*/*                                                                  */
*/*  SAVE REGISTER 13 ACROSS FREEING OF LOCKS                        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0841
*FREELOCK:                                                         0841
*   PROC OPTIONS(SAVE(1,15,11,12,13,14),NOSAVEAREA);               0841
FREELOCK STM   @14,@15,12(@13)                                     0841
         ST    @01,24(,@13)                                        0841
         STM   @11,@12,64(@13)                                     0841
*   RFY                                                            0842
*    (REG1,                                                        0842
*     REG15) RSTD;                                                 0842
*   XVA4=REG13;                                                    0843
         ST    REG13,XVA4(,RBSECPTR)                               0843
*   GEN(SETFRR  D,WRKREGS=(REG1,REG15))                            0844
*   REFS(FRRSEMP);                  /* FREE THE FRR. USE 1 & 15 AS 0844
*                                      WORK REGS.                    */
         SETFRR  D,WRKREGS=(REG1,REG15)
*   RFY                                                            0845
*    (REG1,                                                        0845
*     REG15) UNRSTD;                                               0845
*   GENERATE;                                                      0846
        SETLOCK RELEASE,TYPE=CMS,RELATED=(UCM,IEAVVWTO(SETLOCK))
        SETLOCK RELEASE,TYPE=LOCAL,RELATED=(UCM,IEAVVWTO(SETLOCK))
*   PARMPTR=ADDR(EPARM);            /* PT AT ESTAES PARM AREA NOW    */
         LA    @10,EPARM                                           0847
         ST    @10,PARMPTR                                         0847
*   PARMFRID='0'B;                  /* SIGNAL FRR NO LONGER IN PLACE
*                                      TO ESTAE                      */
         NI    PARMFRID(@10),B'11101111'                           0848
*   REG13=XVA4;                                                    0849
         L     REG13,XVA4(,RBSECPTR)                               0849
*   END FREELOCK;                                                  0850
@EL00007 DS    0H                                                  0850
@EF00007 DS    0H                                                  0850
@ER00007 LM    @14,@15,12(@13)                                     0850
         L     @01,24(,@13)                                        0850
         LM    @11,@12,64(@13)                                     0850
         BR    @14                                                 0850
         EJECT
*                                                                  0851
*/********************************************************************/
*/* POSTOECB - THIS ROUTINE SETS UP THE INTERFACE NECESSARY  @ZA03242*/
*/*            TO BRANCH ENTER XMPOST WITH AN INDICATOR SET          */
*/*            TO RUN THE ERRET ROUTINE IN THE MASTER                */
*/*            SCHEDULER ADDRESS SPACE                               */
*/********************************************************************/
*                                                                  0851
*POSTOECB:                                                         0851
*   PROC;                           /* XMPOST PROC           @ZA03242*/
POSTOECB STM   @14,@12,@SA00008                                    0851
*   RFY                                                            0852
*    (REG10,                                                       0852
*     REG15) RSTD;                                                 0852
*   REG15=CVT0PT01;                 /* GET ENTRY POINT ADDRESS FOR 0853
*                                      BRANCH ENTRY TO XMPOST      0853
*                                                            @ZA03242*/
         L     REG15,CVT0PT01(,REG3)                               0853
*   REG1=0;                         /* CLEAR R1              @ZA03242*/
         SLR   REG1,REG1                                           0854
*   REG1=REG1×'80000000'X;          /* SET UP REG1 FOR USE AS BIT  0855
*                                      MASK TO PREVENT THE NEED FOR A
*                                      REFERENCE TO STORAGE ONCE THE
*                                      BASEREG HAS BEEN UPDATED.   0855
*                                                            @ZA03242*/
         O     REG1,@CF03313                                       0855
*   REG10=0;                        /* COMPLETION CODE WITH WHICH TO
*                                      POST UCMOECB          @ZA03242*/
         SLR   REG10,REG10                                         0856
*   REG13=UCMASCB;                  /* ASCB OF MEMORY CONTAINING ECB
*                                      TO BE POSTED          @ZA03242*/
         L     @14,UCMBASPT(,REG3)                                 0857
         L     REG13,UCMASCB(,@14)                                 0857
*   REG11=ADDR(UCMOECB);            /* POST THE WTO ECB IN COMTASK 0858
*                                                            @ZA03242*/
         LA    REG11,UCMOECB(,@14)                                 0858
*   REG11=REG11×REG1;               /* SET END OF LIST       @ZA03242*/
         OR    REG11,REG1                                          0859
*   REG12=UCMWAKUP;                 /* IF XMPOST ERROR LET IEAVMEST
*                                      GET CONTROL           @ZA03242*/
         L     REG12,UCMWAKUP(,@14)                                0860
*   REG12=REG12×REG1;               /* SET BIT TO SHOW ERRET IS TO 0861
*                                      RUN IN MASTER SCHEDULER MEMORY
*                                                            @ZA03242*/
         OR    REG12,REG1                                          0861
*   GEN(BALR REG14,REG15);          /* POST COMTASK          @ZA03242*/
         BALR REG14,REG15
*   RFY                                                            0863
*    (REG10,                                                       0863
*     REG15) UNRSTD;                /*                       @ZA03242*/
*   RETURN;                         /* RETURN TO MAINLINE    @ZA03242*/
@EL00008 DS    0H                                                  0864
@EF00008 DS    0H                                                  0864
@ER00008 LM    @14,@12,@SA00008                                    0864
         BR    @14                                                 0864
*   END POSTOECB;                   /*                       @ZA03242*/
*   END                                                            0866
*                                                                  0866
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSUT5  (PROLOG  )                                       */
*/*%INCLUDE SYSUT5  (DECLARES)                                       */
*/*%INCLUDE SYSLIB  (IHACTM  )                                       */
*/*%INCLUDE SYSLIB  (IEFJSSOB)                                       */
*/*%INCLUDE SYSLIB  (IEFJESCT)                                       */
*/*%INCLUDE SYSLIB  (IHAORE  )                                       */
*/*%INCLUDE SYSLIB  (IHAWQE  )                                       */
*/*%INCLUDE SYSLIB  (IEZWPL  )                                       */
*/*%INCLUDE SYSLIB  (IEECUCM )                                       */
*/*%INCLUDE SYSLIB  (IHAFRRS )                                       */
*/*%INCLUDE SYSLIB  (IEEBASEA)                                       */
*/*%INCLUDE SYSLIB  (IHAESTA )                                       */
*/*%INCLUDE SYSLIB  (IHARB   )                                       */
*/*%INCLUDE SYSLIB  (IKJRB   )                                       */
*/*%INCLUDE SYSLIB  (IKJTCB  )                                       */
*/*%INCLUDE SYSLIB  (IHAASVT )                                       */
*/*%INCLUDE SYSLIB  (IHAASCB )                                       */
*/*%INCLUDE SYSLIB  (IHAPSA  )                                       */
*/*%INCLUDE SYSLIB  (CVT     )                                       */
*/*%INCLUDE SYSLIB  (IHASCVT )                                       */
*/*%INCLUDE SYSUT5  (SETESTAE)                                       */
*/*%INCLUDE SYSUT5  (SETUPXSA)                                       */
*/*%INCLUDE SYSUT5  (VALIDCHK)                                       */
*/*%INCLUDE SYSUT5  (USEREXIT)                                       */
*/*%INCLUDE SYSUT5  (GETBLKS )                                       */
*/*%INCLUDE SYSUT5  (GETID   )                                       */
*/*%INCLUDE SYSUT5  (BUILDORE)                                       */
*/*%INCLUDE SYSUT5  (BUILDWQE)                                       */
*/*%INCLUDE SYSUT5  (HASPEXIT)                                       */
*/*%INCLUDE SYSUT5  (FREESTAE)                                       */
*/*%INCLUDE SYSUT5  (LOGRECVY)                                       */
*/*%INCLUDE SYSUT5  (VWTOCLNP)                                       */
*/*%INCLUDE SYSUT5  (GETBLOCK)                                       */
*/*%INCLUDE SYSUT5  (WAITCHN )                                       */
*/*%INCLUDE SYSUT5  (FREEORE )                                       */
*/*%INCLUDE SYSUT5  (SETLOCK )                                       */
*/*%INCLUDE SYSUT5  (FREELOCK)                                       */
*                                                                  0866
*       ;                                                          0866
@DATA    DS    0H
@CH00034 DC    H'9'
@CH00092 DC    H'16'
@SM03337 MVC   USERTEXT(0),WPLTXT(REG6)
@SM03342 MVC   WQETXT-1(0,@08),WPLTXT(REG6)
         DS    0F
@AL00344 DC    A(@CF00088)             LIST WITH   1 ARGUMENT(S)
@AL00388 DC    A(@CF00062)             LIST WITH   1 ARGUMENT(S)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00003 DS    1F
@SA00004 DS    1F
@PC00004 DS    1F
@SA00008 DS    15F
@SA00002 DS    15F
@PC00002 DS    1F
@AL00001 DS    1A
@TF00001 DS    F
IEAVVWTO CSECT
         DS    0F
@CF00062 DC    F'1'
@CH00062 EQU   @CF00062+2
@CF00088 DC    F'2'
@CF00084 DC    F'4'
@CF01082 DC    F'5'
@CF00187 DC    F'6'
@CF00061 DC    F'8'
@CF00333 DC    F'20'
@CH00333 EQU   @CF00333+2
@CF00308 DC    F'4096'
@CF03345 DC    F'-8'
@CF03336 DC    F'-4'
@CF03250 DC    F'-1'
@CF03313 DC    XL4'80000000'
@CF03329 DC    XL4'0000FFFF'
@DATD    DSECT
         DS    0D
TEXTLNGT DS    F
PARMPTR  DS    A
@TS00001 DS    CL1
STARTID  DS    CL1
         DS    CL6
CVDAREA  DS    CL8
TSAREA   DS    CL7
         ORG   TSAREA
TSAREAHH DS    CL2
TSAREAMM DS    CL2
TSAREASS DS    CL2
         ORG   TSAREA+7
         DS    CL1
USERPARM DS    CL136
         ORG   USERPARM
USERTEXT DS    CL128
USERROUT DS    CL4
         ORG   USERROUT
USERRC   DS    CL2
         ORG   USERPARM+132
USERDESC DS    CL4
         ORG   USERDESC
USERDC   DS    CL2
         ORG   USERPARM+136
SSOB     DS    CL20
         ORG   SSOB
SSOBID   DS    CL4
SSOBLEN  DS    FL2
SSOBFUNC DS    FL2
SSOBSSIB DS    AL4
SSOBRETN DS    AL4
SSOBINDV DS    AL4
         ORG   SSOB+20
SSWT     DS    CL16
         ORG   SSWT
SSWTLEN  DS    FL2
@NM00011 DS    FL2
SSWTWQE  DS    AL4
SSWTMIN  DS    AL4
SSWTORE  DS    AL4
         ORG   SSWT+16
EPARM    DS    CL24
         DS    CL2
RECSAVE  DS    CL66
         ORG   RECSAVE
RECRGMAP DS    CL2
RECREGS  DS    CL64
         ORG   RECSAVE+66
IEAVVWTO CSECT
         DS    0F
@SIZDATD DC    AL1(229)
         DC    AL3(@ENDDATD-@DATD)
@CV00206 DC    V(IEAVMWTO)
@CV00207 DC    V(IEECVXIT)
@CV00208 DC    V(IGC0203E)
         DS    0D
ABNDCODE DC    XL4'00000D23'
@CC01464 DC    C'VWTO'
@CC03269 DC    C'SSOB'
@CC03264 DC    C' +'
@CB01462 DC    X'FFFF'
@CB03252 DC    X'2000'
@CB03254 DC    X'8000'
@CB03267 DC    X'0200'
CHARTAB  DC    CL16'0123456789ABCDEF'
         DS    CL2
GETWWB   DS    CL4
         ORG   GETWWB
@NM00003 DC    AL1(231)
@NM00004 DC    AL3(24)
         ORG   GETWWB+4
FROREXT  DS    CL4
         ORG   FROREXT
@NM00005 DC    AL1(231)
@NM00006 DC    AL3(1024)
         ORG   FROREXT+4
FRWQEXT  DS    CL4
         ORG   FRWQEXT
@NM00007 DC    AL1(231)
@NM00008 DC    AL3(4096)
         ORG   FRWQEXT+4
GETSP231 DS    CL4
         ORG   GETSP231
@NM00009 DC    AL1(231)
@NM00010 DC    AL3(20+16)
         ORG   GETSP231+4
IDMAP    DC    X'80'
         DC    X'40'
         DC    X'20'
         DC    X'10'
         DC    X'08'
         DC    X'04'
         DC    X'02'
         DC    X'01'
TRTAB    DC    74CL1' '
         DC    CL1'Ö'
         DC    CL1'.'
         DC    CL1'<'
         DC    CL1'('
         DC    CL1'+'
         DC    X'4F'
         DC    CL1'&&'
         DC    9CL1' '
         DC    X'5A'
         DC    CL1'$'
         DC    CL1'*'
         DC    CL1')'
         DC    CL1';'
         DC    X'5F'
         DC    CL1'-'
         DC    CL1'/'
         DC    9CL1' '
         DC    CL1','
         DC    CL1'%'
         DC    CL1'_'
         DC    CL1'>'
         DC    CL1'?'
         DC    10CL1' '
         DC    CL1':'
         DC    CL1'#'
         DC    CL1'@'
         DC    CL1''''
         DC    CL1'='
         DC    CL1'"'
         DC    CL1' '
         DC    CL1'a'
         DC    CL1'b'
         DC    CL1'c'
         DC    CL1'd'
         DC    CL1'e'
         DC    CL1'f'
         DC    CL1'g'
         DC    CL1'h'
         DC    CL1'i'
         DC    7CL1' '
         DC    CL1'j'
         DC    CL1'k'
         DC    CL1'l'
         DC    CL1'm'
         DC    CL1'n'
         DC    CL1'o'
         DC    CL1'p'
         DC    CL1'q'
         DC    CL1'r'
         DC    8CL1' '
         DC    CL1's'
         DC    CL1't'
         DC    CL1'u'
         DC    CL1'v'
         DC    CL1'w'
         DC    CL1'x'
         DC    CL1'y'
         DC    CL1'z'
         DC    23CL1' '
         DC    CL1'A'
         DC    CL1'B'
         DC    CL1'C'
         DC    CL1'D'
         DC    CL1'E'
         DC    CL1'F'
         DC    CL1'G'
         DC    CL1'H'
         DC    CL1'I'
         DC    7CL1' '
         DC    CL1'J'
         DC    CL1'K'
         DC    CL1'L'
         DC    CL1'M'
         DC    CL1'N'
         DC    CL1'O'
         DC    CL1'P'
         DC    CL1'Q'
         DC    CL1'R'
         DC    8CL1' '
         DC    CL1'S'
         DC    CL1'T'
         DC    CL1'U'
         DC    CL1'V'
         DC    CL1'W'
         DC    CL1'X'
         DC    CL1'Y'
         DC    CL1'Z'
         DC    6CL1' '
         DC    CL1'0'
         DC    CL1'1'
         DC    CL1'2'
         DC    CL1'3'
         DC    CL1'4'
         DC    CL1'5'
         DC    CL1'6'
         DC    CL1'7'
         DC    CL1'8'
         DC    CL1'9'
         DC    6CL1' '
IEAVVWTO CSECT
         DS   0H
PATCHLOC DC (200)X'00'
IEAVVWTO CSECT
ELIST  ESTAE  ,MF=L
@DATD    DSECT
*                                                         /*@ZA19274*/
IEAVVWTO CSECT
TRINST   TR    WQETXT(0,REG15),TRTAB                      /*@ZA19274*/
*                                                         /*@ZA19274*/
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IEAVVWTO CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
CPEXTSAV EQU   @10
ISCAN    EQU   @10
REG0     EQU   @00
REG1     EQU   @01
REG2     EQU   @02
REG3     EQU   @03
REG4     EQU   @04
REG5     EQU   @05
REG6     EQU   @06
REG7     EQU   @07
REG8     EQU   @08
REG9     EQU   @09
REG10    EQU   @10
REG11    EQU   @11
REG12    EQU   @12
REG13    EQU   @13
REG14    EQU   @14
REG15    EQU   @15
TEXTPTR  EQU   @02
RBSECPTR EQU   @05
TCBPTR   EQU   @04
ASCBPTR  EQU   @07
PSA      EQU   0
FLCRNPSW EQU   PSA
FLCROPSW EQU   PSA+8
FLCICCW2 EQU   PSA+16
PSAEEPSW EQU   PSA+132
PSAESPSW EQU   PSA+136
FLCSVILC EQU   PSAESPSW+1
PSAEPPSW EQU   PSA+140
FLCPIILC EQU   PSAEPPSW+1
FLCPICOD EQU   PSAEPPSW+2
PSAPICOD EQU   FLCPICOD+1
FLCTEA   EQU   PSAEPPSW+4
FLCPER   EQU   PSA+152
FLCMCLA  EQU   PSA+168
FLCIOEL  EQU   FLCMCLA+4
FLCIOA   EQU   FLCMCLA+16
FLCFSA   EQU   FLCMCLA+80
PSASUPER EQU   PSA+552
PSASUP1  EQU   PSASUPER
PSASUP2  EQU   PSASUPER+1
PSASUP3  EQU   PSASUPER+2
PSASUP4  EQU   PSASUPER+3
PSACLHT  EQU   PSA+640
PSALKSA  EQU   PSA+696
PSAHLHI  EQU   PSA+760
PSALITA  EQU   PSA+764
PSADSSFL EQU   PSA+836
PSADSSF1 EQU   PSADSSFL
PSADSSF3 EQU   PSADSSFL+2
PSADSSF4 EQU   PSADSSFL+3
PSARSVT  EQU   PSA+896
PSALSFCC EQU   PSA+1012
CVTPTR   EQU   16
REFCHAR  EQU   0
WWB      EQU   0
WWBFWDPT EQU   WWB
WWBBCKPT EQU   WWB+4
WWBASCB  EQU   WWB+8
WWBTCBAD EQU   WWB+12
WWBFLAGS EQU   WWB+16
WWBPOSTD EQU   WWBFLAGS
WWBECB   EQU   WWB+20
PARMLIST EQU   0
PARMSTAT EQU   PARMLIST
PARMFTPT EQU   PARMSTAT
PARMFLAG EQU   PARMSTAT+1
PARMFRID EQU   PARMFLAG
PARMNDMP EQU   PARMFLAG
PARMCLAD EQU   PARMLIST+8
PARMRTAD EQU   PARMLIST+12
PARMRGAD EQU   PARMLIST+16
PARMID   EQU   PARMLIST+20
JESCT    EQU   0
JESWAA   EQU   JESCT+8
JESSSREQ EQU   JESCT+20
JESALLOC EQU   JESCT+32
JESUNALC EQU   JESCT+36
JESCATL  EQU   JESCT+40
SSREQ    EQU   0
OREF     EQU   0
ORELKP   EQU   OREF
OREID    EQU   OREF+4
OREXA    EQU   OREF+6
OREKEY0  EQU   OREXA
ORESUSP  EQU   OREXA
OREXC    EQU   OREF+7
OREBUFB  EQU   OREXC
OREBUFD  EQU   OREXC
ORETCB   EQU   OREF+8
OREWQE   EQU   OREF+12
ORERPY   EQU   OREF+16
OREECB   EQU   OREF+20
OREASID  EQU   OREF+24
WQE      EQU   0
WQELKP   EQU   WQE
WQELKPA  EQU   WQELKP+1
WQENBR   EQU   WQE+4
WQERR    EQU   WQE+8
WQEPAD   EQU   WQE+12
WQETS    EQU   WQE+13
WQETSHH  EQU   WQETS
WQEPER1  EQU   WQETS+2
WQETSMM  EQU   WQETS+3
WQEPER2  EQU   WQETS+5
WQETSSS  EQU   WQETS+6
WQEPAD1  EQU   WQE+21
WQEJOBNM EQU   WQE+22
WQEPAD2  EQU   WQE+30
WQETXT   EQU   WQE+31
WQEXA    EQU   WQE+160
WQEQFHC  EQU   WQEXA
WQEORE   EQU   WQEXA
WQEWTOR  EQU   WQEXA
WQESUSP  EQU   WQEXA
WQEAUTH  EQU   WQEXA
WQEASID  EQU   WQE+161
WQEAVAIL EQU   WQE+163
WQEBUFB  EQU   WQEAVAIL
WQEBUFC  EQU   WQEAVAIL
WQEBUFD  EQU   WQEAVAIL
WQEBUFE  EQU   WQEAVAIL
WQETCB   EQU   WQE+164
WQESEQN  EQU   WQE+169
WQEMCSF  EQU   WQE+172
WQEMCSF1 EQU   WQEMCSF
WQEMCSA  EQU   WQEMCSF1
WQEMCSB  EQU   WQEMCSF1
WQEMCSG  EQU   WQEMCSF1
WQEMCSH  EQU   WQEMCSF1
WQEMCSF2 EQU   WQEMCSF+1
WQEMCSN  EQU   WQEMCSF2
WQEMSGTP EQU   WQE+174
WQEMSGT1 EQU   WQEMSGTP
WQEROUT  EQU   WQE+176
WQEROUT1 EQU   WQEROUT
WQEROUT2 EQU   WQEROUT+1
WQEUCMID EQU   WQE+180
WQERPYID EQU   WQE+182
WQEDESCD EQU   WQE+184
WQEDC1   EQU   WQEDESCD
WQEDC2   EQU   WQEDESCD+1
WQEJSTCB EQU   WQE+188
WMJM     EQU   0
WMJMEXT  EQU   WMJM
WMJMEXTA EQU   WMJMEXT+1
WMJMMLW  EQU   WMJM+4
WMJMTS   EQU   WMJM+13
WMJMSER  EQU   WMJM+122
WMJMSER1 EQU   WMJMSER
WMJMLTYP EQU   WMJM+134
WMJMLTY1 EQU   WMJMLTYP
WMJMECBF EQU   WMJM+148
WMJMDSP  EQU   WMJM+160
WMJMBUF  EQU   WMJM+163
WMJMCS   EQU   WMJM+172
WMJMCS1  EQU   WMJMCS
WMJMCS2  EQU   WMJMCS+1
WMJMMT   EQU   WMJM+174
WMJMMT1  EQU   WMJMMT
WMJMRTC  EQU   WMJM+176
WMJMRCT1 EQU   WMJMRTC
WMJMRCT2 EQU   WMJMRTC+1
WMJMDEC  EQU   WMJM+184
WMJMDEC1 EQU   WMJMDEC
WMJMDEC2 EQU   WMJMDEC+1
WMNM     EQU   0
WMNMEXT  EQU   WMNM
WMNMML1  EQU   WMNM+4
WMNMLT1  EQU   WMNM+5
WMNMST1  EQU   WMNM+84
WMNMML2  EQU   WMNM+100
WMNMLT2  EQU   WMNM+101
WMNMST2  EQU   WMNM+180
WPLRF    EQU   0
WPLRPTR  EQU   WPLRF
WPLRLN   EQU   WPLRPTR
WPLRECB  EQU   WPLRF+4
WPL      EQU   0
WPLLGH   EQU   WPL
WPLMCSF  EQU   WPL+2
WPLMCSF1 EQU   WPLMCSF
WPLMCSFA EQU   WPLMCSF1
WPLMCSFD EQU   WPLMCSF1
WPLMCSF2 EQU   WPLMCSF+1
WPLMCSFI EQU   WPLMCSF2
WPLMCSFJ EQU   WPLMCSF2
WPLTXT   EQU   WPL+4
WPLFLGS  EQU   0
WPLDESC  EQU   WPLFLGS
WPLDESC1 EQU   WPLDESC
WPLDESCA EQU   WPLDESC1
WPLDESCB EQU   WPLDESC1
WPLDESCG EQU   WPLDESC1
WPLDESC2 EQU   WPLDESC+1
WPLROUT  EQU   WPLFLGS+2
WPLROUT1 EQU   WPLROUT
WPLROUT2 EQU   WPLROUT+1
WPLROUTK EQU   WPLROUT2
WPLMSGTY EQU   WPLFLGS+4
WPLMSGT1 EQU   WPLMSGTY
WPLMSGTD EQU   WPLMSGT1
WPLMSGT2 EQU   WPLMSGTY+1
WPLQID   EQU   WPLFLGS+6
WPLLS01  EQU   0
WPLLTF   EQU   WPLLS01
WPLLTF1  EQU   WPLLTF
WPLAREA  EQU   WPLLS01+2
WPLLINES EQU   WPLLS01+3
WPLML    EQU   0
WPLMLLEN EQU   WPLML+1
WPLMLLTF EQU   WPLML+2
WPLMLLT1 EQU   WPLMLLTF
UCMPRFXP EQU   0
UCM2PTR  EQU   0
UCM2EXT  EQU   0
UCM2STA  EQU   UCM2EXT+8
UCM2SFLG EQU   UCM2STA
UCM2FEXT EQU   UCM2EXT+12
UCMPRFX  EQU   0
UCMSAVE0 EQU   UCMPRFX+4
UCMSFLGS EQU   UCMPRFX+84
UCMSFLG1 EQU   UCMSFLGS
UCMSYSG  EQU   UCMSFLG1
UCMSFLG2 EQU   UCMSFLGS+1
UCMSYSI  EQU   UCMSFLG2
UCMSYSO  EQU   UCMSFLG2
UCMOWTOR EQU   UCMPRFX+86
UCMCMID  EQU   UCMPRFX+88
UCMXSA   EQU   UCMPRFX+104
UCMSDS1  EQU   UCMPRFX+156
UCM      EQU   0
UCMAECB  EQU   UCM+4
UCMOECB  EQU   UCM+8
UCMDECB  EQU   UCM+12
UCMLSTP  EQU   UCM+20
UCMWTOQ  EQU   UCM+24
UCMRPYQ  EQU   UCM+28
UCMRPYI  EQU   UCM+32
UCMRQLM  EQU   UCM+45
UCMWQLM  EQU   UCM+46
UCMRQNR  EQU   UCM+56
UCMWQNR  EQU   UCM+58
UCMWQEND EQU   UCM+60
UCMPXA   EQU   UCM+64
UCMPXB   EQU   UCM+68
UCMMODE  EQU   UCMPXB
UCMVDATA EQU   UCM+72
UCMVEA   EQU   UCMVDATA
UCMRQLM1 EQU   UCM+236
UCMWQLM1 EQU   UCM+238
UCMCTID  EQU   UCM+250
UCMWECBT EQU   UCM+260
UCMOECBT EQU   UCM+268
UCMORECP EQU   UCM+272
UCMWQECP EQU   UCM+276
UCMASCB  EQU   UCM+280
UCMFRRAD EQU   UCM+288
UCMWAKUP EQU   UCM+292
UCMJES3T EQU   UCM+296
UCMRSV42 EQU   UCM+300
UCMRSV51 EQU   UCM+301
UCMEIL   EQU   0
UCMRPYL  EQU   UCMEIL+1
UCMRECBA EQU   UCMEIL+24
UCMEXIT  EQU   0
UCMLIST  EQU   0
UCMSTS   EQU   UCMLIST+24
UCMATR   EQU   UCMLIST+25
UCMXA    EQU   UCMLIST+26
UCMAUTH  EQU   UCMLIST+40
UCMAUTHA EQU   UCMAUTH
UCMDISP  EQU   UCMLIST+42
UCMDISP1 EQU   UCMDISP
UCMDISP2 EQU   UCMDISP+1
UCMMSG   EQU   UCMLIST+60
UCMMSG1  EQU   UCMMSG
UCMDEVC  EQU   UCMLIST+63
UCMRCT   EQU   UCMLIST+68
UCMSDS5  EQU   UCMRCT
UCMFEXTA EQU   0
UCMFPPTR EQU   UCMFEXTA+4
UCMFMGFS EQU   UCMFEXTA+8
UCMFFLG1 EQU   UCMFMGFS
UCMFMSGN EQU   UCMFFLG1
UCMPEXTA EQU   0
UCMPDM1  EQU   UCMPEXTA+4
FRRSPTR  EQU   0
FRREPTR  EQU   0
FRRS     EQU   0
FRRSHEAD EQU   FRRS
FRRSEMP  EQU   FRRSHEAD
FRRSLAST EQU   FRRSHEAD+4
FRRSELEN EQU   FRRSHEAD+8
FRRSCURR EQU   FRRSHEAD+12
FRRSENTR EQU   0
FRRSFRRA EQU   FRRSENTR
FRRSFLGS EQU   FRRSENTR+4
FRRSFLG1 EQU   FRRSFLGS
FRRSPARM EQU   FRRSENTR+8
BASE     EQU   0
@NM00020 EQU   BASE+13
BALGSTAT EQU   BASE+24
BALOG    EQU   BALGSTAT+4
BALOGINT EQU   BALOG
BASFL    EQU   BASE+36
BARSW    EQU   BASFL
MSLOGST  EQU   BASE+46
BASPBYTE EQU   BASE+47
BAMONITR EQU   BASE+56
@NM00042 EQU   BASE+104
MSLGCLOZ EQU   BASE+108
MSCLOSSW EQU   MSLGCLOZ
MSLGWLOG EQU   BASE+112
MSWLOGSW EQU   MSLGWLOG
MSLGWTR  EQU   BASE+116
MSWTRSW  EQU   MSLGWTR
MSLGSTRT EQU   BASE+120
MSSTRTSW EQU   MSLGSTRT
MS1BASEX EQU   BASE+136
BASES01  EQU   0
MSNTAL   EQU   BASES01
MSSSB    EQU   BASES01+1
MSBTN    EQU   MSSSB
MSPFG    EQU   BASES01+2
MSECBFL  EQU   BASES01+3
MSTUS    EQU   BASES01+4
MSSSA    EQU   MSTUS
MSINLSW  EQU   MSSSA
MSREOF   EQU   MSSSA
MSNWP    EQU   MSSSA
MSFHF    EQU   BASES01+5
ESTAPTR  EQU   0
ESTA     EQU   0
ESTAEXT  EQU   ESTA
ESTAFLG1 EQU   ESTAEXT
ESTAIO   EQU   ESTAFLG1
ESTAFGRS EQU   ESTA+12
ESTAFLG2 EQU   ESTAFGRS
POSTRECY EQU   0
RBPRFX   EQU   0
RBBASIC  EQU   0
RBEXRTNM EQU   RBBASIC
RBTMFLD  EQU   RBEXRTNM
RBSTAB   EQU   RBBASIC+10
XSTAB    EQU   RBSTAB
RBSTAB1  EQU   XSTAB
XSTAB1   EQU   RBSTAB1
RBFTCKPT EQU   XSTAB1
RBSTAB2  EQU   XSTAB+1
XSTAB2   EQU   RBSTAB2
RBTCBNXT EQU   XSTAB2
RBFACTV  EQU   XSTAB2
RBFDYN   EQU   XSTAB2
RBECBWT  EQU   XSTAB2
RBOPSW   EQU   RBBASIC+16
XRBPSW   EQU   RBOPSW
RBOPSWB2 EQU   XRBPSW+1
RBLINK   EQU   RBBASIC+28
XRBLNK   EQU   RBLINK
RBWCF    EQU   XRBLNK
RBLINKB  EQU   XRBLNK+1
RBGRSAVE EQU   RBBASIC+32
XRBREG   EQU   RBGRSAVE
RBGRS0   EQU   XRBREG
RBGRS1   EQU   XRBREG+4
RBGRS2   EQU   XRBREG+8
RBGRS3   EQU   XRBREG+12
RBGRS4   EQU   XRBREG+16
RBGRS5   EQU   XRBREG+20
RBGRS6   EQU   XRBREG+24
RBGRS7   EQU   XRBREG+28
RBGRS8   EQU   XRBREG+32
RBGRS9   EQU   XRBREG+36
RBGRS10  EQU   XRBREG+40
RBGRS11  EQU   XRBREG+44
RBGRS12  EQU   XRBREG+48
RBGRS13  EQU   XRBREG+52
RBGRS14  EQU   XRBREG+56
RBGRS15  EQU   XRBREG+60
XRBESA   EQU   RBBASIC+96
RBEXSAVE EQU   XRBESA
RBPREFIX EQU   0
RBRSV019 EQU   RBPREFIX+14
RBRSV028 EQU   RBPREFIX+15
RBRSV041 EQU   RBPREFIX+27
RBRSV054 EQU   RBPREFIX+39
RBRTOPSW EQU   RBPREFIX+40
RBRTPSW2 EQU   RBRTOPSW+8
RBRTICIL EQU   RBRTPSW2
RBFLAGS1 EQU   RBPREFIX+56
RBINTCDA EQU   RBPREFIX+61
RBSECT   EQU   0
RBPPSAV  EQU   RBSECT
@NM00075 EQU   RBSECT+10
@NM00076 EQU   @NM00075
RBFTP    EQU   @NM00076
RBTRSVRB EQU   @NM00076
@NM00078 EQU   @NM00075+1
RBETXR   EQU   @NM00078
RBEP     EQU   RBSECT+12
RBPGMQ   EQU   RBSECT+24
@NM00085 EQU   RBSECT+28
IRBEND   EQU   RBSECT+96
@NM00089 EQU   RBSECT+96
RBRSV138 EQU   @NM00089+7
RBRSV150 EQU   RBSECT+167
TCBFIX   EQU   0
TCBFRS   EQU   TCBFIX
TCB      EQU   0
TCBRBP   EQU   TCB
TCBPIE   EQU   TCB+4
TCBPMASK EQU   TCBPIE
TCBCMP   EQU   TCB+16
TCBCMPF  EQU   TCBCMP
TCBCPP   EQU   TCBCMPF
TCBSTCC  EQU   TCBCMPF
TCBCDBL  EQU   TCBCMPF
TCBCWTO  EQU   TCBCMPF
TCBCIND  EQU   TCBCMPF
TCBCMSG  EQU   TCBCMPF
TCBTRN   EQU   TCB+20
TCBABF   EQU   TCBTRN
TCBMSS   EQU   TCB+24
TCBPKF   EQU   TCB+28
TCBFLGS  EQU   TCB+29
TCBFLGS1 EQU   TCBFLGS
TCBFLGS2 EQU   TCBFLGS+1
TCBFLGS3 EQU   TCBFLGS+2
TCBFLGS4 EQU   TCBFLGS+3
TCBFLGS5 EQU   TCBFLGS+4
TCBABWF  EQU   TCBFLGS5
TCBJPQ   EQU   TCB+44
TCBPURGE EQU   TCBJPQ
TCBGRS   EQU   TCB+48
TCBFSA   EQU   TCB+112
TCBTME   EQU   TCB+120
TCBJSTCB EQU   TCB+124
TCBOTC   EQU   TCB+132
TCBTSFLG EQU   TCB+148
TCBTSTSK EQU   TCBTSFLG
TCBSTAB  EQU   TCB+160
TCBNSTAE EQU   TCBSTAB
TCBTCT   EQU   TCB+164
TCBTCTGF EQU   TCBTCT
TCBSCNDY EQU   TCB+172
TCBNDSP  EQU   TCBSCNDY
TCBNDSP1 EQU   TCBNDSP+1
TCBNDSP2 EQU   TCBNDSP+2
TCBNDSP3 EQU   TCBNDSP+3
TCBJSCB  EQU   TCB+180
TCBRECDE EQU   TCBJSCB
TCBEXT1  EQU   TCB+196
TCBBITS  EQU   TCB+200
TCBNDSP4 EQU   TCBBITS
TCBNDSP5 EQU   TCBBITS+1
TCBFLGS6 EQU   TCBBITS+2
TCBFLGS7 EQU   TCBBITS+3
TCBDAR   EQU   TCB+204
TCBDARC  EQU   TCBDAR
TCBEXT2  EQU   TCB+208
TCBTID   EQU   TCB+238
TCBFOE   EQU   TCB+244
TCBESTAE EQU   TCB+264
TCBESTRM EQU   TCBESTAE+1
TCBFBYT1 EQU   TCB+276
TCBFBYT2 EQU   TCB+277
TCBRV124 EQU   TCB+278
TCBRV133 EQU   TCB+279
TCBXTNT2 EQU   0
TCBGTF   EQU   TCBXTNT2
TCBTFLG  EQU   TCBGTF
TCBRV146 EQU   TCBXTNT2+28
TCBRV155 EQU   TCBXTNT2+29
TCBRV164 EQU   TCBXTNT2+30
TCBRV173 EQU   TCBXTNT2+31
ASVT     EQU   0
ASVTFRST EQU   ASVT+524
ASVTENTY EQU   ASVT+528
ASCB     EQU   0
ASCBASID EQU   ASCB+36
ASCBFW1  EQU   ASCB+100
ASCBRCTF EQU   ASCBFW1+2
ASCBFLG1 EQU   ASCBFW1+3
ASCBDSP1 EQU   ASCB+114
ASCBFLG2 EQU   ASCB+115
CVTMAP   EQU   0
CVTDAR   EQU   CVTMAP+72
CVTFLGS1 EQU   CVTDAR
CVTCUCB  EQU   CVTMAP+100
CVTDCB   EQU   CVTMAP+116
CVTIOQET EQU   CVTMAP+120
CVTIERLC EQU   CVTMAP+144
CVTMSER  EQU   CVTMAP+148
CVT0PT01 EQU   CVTMAP+152
CVTHEAD  EQU   CVTMAP+160
CVTSV76C EQU   CVTHEAD
CVTOPTA  EQU   CVTMAP+182
CVTOPTB  EQU   CVTMAP+183
CVTABEND EQU   CVTMAP+200
CVTGTF   EQU   CVTMAP+236
CVTGTFST EQU   CVTGTF
CVTGTFS  EQU   CVTGTFST
CVTSTATE EQU   CVTGTFST
CVTTMODE EQU   CVTGTFST
CVTFORM  EQU   CVTGTFST
CVTAQAVT EQU   CVTMAP+240
CVTTCMFG EQU   CVTAQAVT
CVTVOLM2 EQU   CVTMAP+244
CVTTATA  EQU   CVTVOLM2
CVTTSKS  EQU   CVTTATA
CVTVOLF2 EQU   CVTTSKS
CVTTAT   EQU   CVTTATA+1
CVTATER  EQU   CVTMAP+248
CVTEXT1  EQU   CVTMAP+252
CVTPURG  EQU   CVTMAP+260
CVTQMSG  EQU   CVTMAP+268
CVTDMSR  EQU   CVTMAP+272
CVTRSV37 EQU   CVTDMSR
CVTDMSRF EQU   CVTRSV37
CVTJESCT EQU   CVTMAP+296
CVTERPV  EQU   CVTMAP+316
CVTINTLA EQU   CVTMAP+320
CVTAPF   EQU   CVTMAP+324
CVTEXT2  EQU   CVTMAP+328
CVTHJES  EQU   CVTMAP+332
CVTPGSIA EQU   CVTMAP+348
CVTA1F1  EQU   CVTMAP+356
CVTSYSK  EQU   CVTMAP+357
CVTVOLM1 EQU   CVTMAP+380
CVTVOLF1 EQU   CVTVOLM1
CVTATMCT EQU   CVTMAP+388
CVTXTNT1 EQU   0
CVTXTNT2 EQU   0
CVTDSSV  EQU   CVTXTNT2
CVTFLGBT EQU   CVTXTNT2+5
CVTQID   EQU   CVTXTNT2+24
CVTRV400 EQU   CVTXTNT2+52
CVTRV409 EQU   CVTXTNT2+53
CVTATCVT EQU   CVTXTNT2+64
CVTRV429 EQU   CVTXTNT2+84
CVTRV438 EQU   CVTXTNT2+85
CVTRV457 EQU   CVTXTNT2+112
CVTRV466 EQU   CVTXTNT2+113
CVTFIX   EQU   0
CVTRELNO EQU   CVTFIX+252
SCVTSECT EQU   0
SCVTRMBR EQU   SCVTSECT+28
BITZERO  EQU   0
IEFAB4F5 EQU   0
IEFBB410 EQU   0
IEFW21SD EQU   0
SWAMGR   EQU   0
BLKADDR  EQU   0
TYPE     EQU   0
CHNTAIL  EQU   0
CURRID   EQU   UCMRPYL
MSGFLAG  EQU   WQETXT
MSGACTN  EQU   MSGFLAG
MSGID    EQU   MSGFLAG+1
MSGBLNK  EQU   MSGFLAG+3
PPMSGFLG EQU   WQETXT
XVSAV    EQU   RBEXSAVE
XVA0     EQU   XVSAV
XVA4     EQU   XVSAV+4
XVA8     EQU   XVSAV+8
XVRDMSV  EQU   XVSAV+12
XVDESCD  EQU   XVRDMSV
XVRCSAVE EQU   XVRDMSV+2
XVMSGTYP EQU   XVRDMSV+4
XVMSGLGH EQU   XVSAV+18
XVPARMAD EQU   XVSAV+20
XVWQEAD  EQU   XVSAV+24
XVDFLAGS EQU   XVSAV+28
XVD0     EQU   XVDFLAGS
XVD0RPFD EQU   XVD0
XVD0NWQE EQU   XVD0
XVD0NORE EQU   XVD0
XVD0QID  EQU   XVD0
XVD0WWB  EQU   XVD0
XVD0USER EQU   XVD0
XVD0HDCY EQU   XVD0
XVD1     EQU   XVDFLAGS+1
XVD1PRIV EQU   XVD1
XVD1ALDN EQU   XVD1
XVD1PP   EQU   XVD1
XVD1AUTH EQU   XVD1
XVD1PERR EQU   XVD1
XVD2     EQU   XVDFLAGS+2
XVD2RDC  EQU   XVD2
XVD2MSGT EQU   XVD2
XVD2VALD EQU   XVD2
XVD2DELW EQU   XVD2
XVD2ZERO EQU   XVD2
XVD2WTOR EQU   XVD2
XVD2QFHC EQU   XVD2
XVOREAD  EQU   XVSAV+32
XVNEWDC  EQU   XVOREAD
XVNEWRC  EQU   XVOREAD+2
XVWWB    EQU   XVSAV+36
XVEXPMAD EQU   XVWWB
XVWQEID  EQU   XVSAV+40
XVWQEIDA EQU   XVWQEID
XVCONID  EQU   XVWQEID+3
XVRET    EQU   XVSAV+44
XVRETCOD EQU   XVRET
TIMEFLD  EQU   XVA8
ROUTMAP  EQU   WQEROUT
OREPTR   EQU   XVOREAD
WQEPTR   EQU   XVWQEAD
WMJPTR   EQU   XVWQEAD
WMNPTR   EQU   XVWQEAD
WPLPTR   EQU   XVPARMAD
UCMBASPT EQU   CVTCUCB
UCMMCSPT EQU   UCMPRFXP
UCMEILPT EQU   UCMLSTP
UCMEXTPT EQU   UCM2PTR
UCMUEWPT EQU   XVEXPMAD
UCMDVEPT EQU   UCMVEA
UCMFXPTR EQU   UCM2FEXT
UCMPXPTR EQU   UCMFPPTR
UCMIECBA EQU   UCMRECBA+4
RBSECS03 EQU   RBEP
RBCDE    EQU   RBSECS03
RBCDFLGS EQU   RBCDE
RBSECS05 EQU   RBPGMQ
RBSQE    EQU   RBSECS05
RBSECS06 EQU   RBPGMQ
RBIQE    EQU   RBSECS06
RBSECS07 EQU   RBPGMQ
RBIQE2   EQU   RBSECS07
RBSECS08 EQU   IRBEND
RBSECS09 EQU   IRBEND
CVTS01   EQU   CVTPGSIA
CVTLPDIA EQU   CVTS01+12
CVTDIRST EQU   CVTLPDIA
CVTSLIDA EQU   CVTS01+24
CVTCTLFG EQU   CVTS01+50
CVTBLDCP EQU   CVTS01+140
CVTGETCL EQU   CVTS01+144
CVTFRECL EQU   CVTS01+148
CVTCRMN  EQU   CVTS01+156
CVTASVT  EQU   CVTS01+208
CVTRV210 EQU   CVTS01+424
CVTRV219 EQU   CVTS01+425
CVTRV228 EQU   CVTS01+426
CVTRV237 EQU   CVTS01+427
CVTMFRTR EQU   CVTS01+452
CVTRV262 EQU   CVTS01+468
CVTRV271 EQU   CVTS01+469
CVTRV280 EQU   CVTS01+470
CVTRV289 EQU   CVTS01+471
CVTRMBR  EQU   CVTS01+492
CVTGSDA  EQU   CVTS01+600
ASVTPTR  EQU   CVTASVT
FLC      EQU   PSA
PSARSVTE EQU   PSARSVT
PSACSTK  EQU   PSARSVTE
SCVTSPTR EQU   CVTABEND
ASCBTBLE EQU   ASVTENTY
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
PSARSAV  EQU   PSARSVTE+60
PSARSTK  EQU   PSARSVTE+56
PSAESAV3 EQU   PSARSVTE+52
PSAESTK3 EQU   PSARSVTE+48
PSAESAV2 EQU   PSARSVTE+44
PSAESTK2 EQU   PSARSVTE+40
PSAESAV1 EQU   PSARSVTE+36
PSAESTK1 EQU   PSARSVTE+32
PSAPSAV  EQU   PSARSVTE+28
PSAPSTK  EQU   PSARSVTE+24
PSAMSAV  EQU   PSARSVTE+20
PSAMSTK  EQU   PSARSVTE+16
PSASSAV  EQU   PSARSVTE+12
PSASSTK  EQU   PSARSVTE+8
PSANSTK  EQU   PSARSVTE+4
CVTRV628 EQU   CVTS01+728
CVTRV627 EQU   CVTS01+724
CVTRV626 EQU   CVTS01+720
CVTRV625 EQU   CVTS01+716
CVTRV624 EQU   CVTS01+712
CVTRV623 EQU   CVTS01+708
CVTRV622 EQU   CVTS01+704
CVTRV621 EQU   CVTS01+700
CVTIHASU EQU   CVTS01+696
CVTRV619 EQU   CVTS01+692
CVTRV618 EQU   CVTS01+688
CVTRV617 EQU   CVTS01+684
CVTRV616 EQU   CVTS01+680
CVTRV615 EQU   CVTS01+676
CVTRV614 EQU   CVTS01+672
CVTRV613 EQU   CVTS01+668
CVTTCASP EQU   CVTS01+664
CVT0PT03 EQU   CVTS01+660
CVT0PT0E EQU   CVTS01+656
CVTRV609 EQU   CVTS01+652
CVTCGK   EQU   CVTS01+648
CVTRAC   EQU   CVTS01+644
CVTHSM   EQU   CVTS01+640
CVTRV605 EQU   CVTS01+636
CVTRV604 EQU   CVTS01+632
CVTEFF02 EQU   CVTS01+628
CVTCBBR  EQU   CVTS01+624
CVTSSCR  EQU   CVTS01+620
CVTEVENT EQU   CVTS01+616
CVTCRCA  EQU   CVTS01+612
CVTTPIO  EQU   CVTS01+608
CVTADV   EQU   CVTS01+604
CVTGSDAB EQU   CVTGSDA
CVTQV3   EQU   CVTS01+596
CVTQV2   EQU   CVTS01+592
CVTQV1   EQU   CVTS01+588
CVTRPT   EQU   CVTS01+584
CVTSSRB  EQU   CVTS01+580
CVTCSDRL EQU   CVTS01+576
CVTEXP1  EQU   CVTS01+572
CVTRMPMT EQU   CVTS01+568
CVTRMPTT EQU   CVTS01+564
CVTVPSA  EQU   CVTS01+560
CVTVSTOP EQU   CVTS01+556
CVTGTFR8 EQU   CVTS01+552
CVTQUIT  EQU   CVTS01+548
CVTVACR  EQU   CVTS01+544
CVTWTCB  EQU   CVTS01+540
CVTSTPRS EQU   CVTS01+536
CVT0PT02 EQU   CVTS01+532
CVTDARCM EQU   CVTS01+528
CVTIRECM EQU   CVTS01+524
CVTJRECM EQU   CVTS01+520
CVTVEMS0 EQU   CVTS01+516
CVTSPFRR EQU   CVTS01+512
CVTRLSTG EQU   CVTS01+508
CVT0TC0A EQU   CVTS01+504
CVTGMBR  EQU   CVTS01+500
CVTLFRM  EQU   CVTS01+496
CVTVIOP  EQU   CVTS01+488
CVTRV307 EQU   CVTS01+486
CVTRV306 EQU   CVTS01+484
CVTRV305 EQU   CVTS01+482
CVTRV304 EQU   CVTS01+480
CVTRV303 EQU   CVTS01+478
CVTRV302 EQU   CVTS01+476
CVTTRCA  EQU   CVTS01+472
CVTRV297 EQU   CVTRV289
CVTRV296 EQU   CVTRV289
CVTRV295 EQU   CVTRV289
CVTRV294 EQU   CVTRV289
CVTRV293 EQU   CVTRV289
CVTRV292 EQU   CVTRV289
CVTRV291 EQU   CVTRV289
CVTRV290 EQU   CVTRV289
CVTRV288 EQU   CVTRV280
CVTRV287 EQU   CVTRV280
CVTRV286 EQU   CVTRV280
CVTRV285 EQU   CVTRV280
CVTRV284 EQU   CVTRV280
CVTRV283 EQU   CVTRV280
CVTRV282 EQU   CVTRV280
CVTRV281 EQU   CVTRV280
CVTRV279 EQU   CVTRV271
CVTRV278 EQU   CVTRV271
CVTRV277 EQU   CVTRV271
CVTRV276 EQU   CVTRV271
CVTRV275 EQU   CVTRV271
CVTRV274 EQU   CVTRV271
CVTRV273 EQU   CVTRV271
CVTRV272 EQU   CVTRV271
CVTRV270 EQU   CVTRV262
CVTRV269 EQU   CVTRV262
CVTRV268 EQU   CVTRV262
CVTRV267 EQU   CVTRV262
CVTRV266 EQU   CVTRV262
CVTRV265 EQU   CVTRV262
CVTRV264 EQU   CVTRV262
CVTRV263 EQU   CVTRV262
CVTVFP   EQU   CVTS01+464
CVTVSI   EQU   CVTS01+460
CVTVPSIB EQU   CVTS01+456
CVTMFACT EQU   CVTMFRTR
CVTMFCTL EQU   CVTS01+448
CVTPVBP  EQU   CVTS01+444
CVTPWI   EQU   CVTS01+440
CVTRV254 EQU   CVTS01+438
CVTRV253 EQU   CVTS01+436
CVTRV252 EQU   CVTS01+434
CVTRV251 EQU   CVTS01+433
CVTRV250 EQU   CVTS01+432
CVTRV249 EQU   CVTS01+431
CVTRV248 EQU   CVTS01+430
CVTRV247 EQU   CVTS01+429
CVTRV246 EQU   CVTS01+428
CVTRV245 EQU   CVTRV237
CVTRV244 EQU   CVTRV237
CVTRV243 EQU   CVTRV237
CVTRV242 EQU   CVTRV237
CVTRV241 EQU   CVTRV237
CVTRV240 EQU   CVTRV237
CVTRV239 EQU   CVTRV237
CVTRV238 EQU   CVTRV237
CVTRV236 EQU   CVTRV228
CVTRV235 EQU   CVTRV228
CVTRV234 EQU   CVTRV228
CVTRV233 EQU   CVTRV228
CVTRV232 EQU   CVTRV228
CVTRV231 EQU   CVTRV228
CVTRV230 EQU   CVTRV228
CVTRV229 EQU   CVTRV228
CVTRV227 EQU   CVTRV219
CVTRV226 EQU   CVTRV219
CVTRV225 EQU   CVTRV219
CVTRV224 EQU   CVTRV219
CVTRV223 EQU   CVTRV219
CVTRV222 EQU   CVTRV219
CVTRV221 EQU   CVTRV219
CVTRV220 EQU   CVTRV219
CVTRV218 EQU   CVTRV210
CVTRV217 EQU   CVTRV210
CVTRV216 EQU   CVTRV210
CVTRV215 EQU   CVTRV210
CVTRV214 EQU   CVTRV210
CVTRV213 EQU   CVTRV210
CVTRV212 EQU   CVTRV210
CVTRV211 EQU   CVTRV210
CVTLCCAT EQU   CVTS01+420
CVTPCCAT EQU   CVTS01+416
CVTIPCRP EQU   CVTS01+412
CVTIPCRI EQU   CVTS01+408
CVTIPCDS EQU   CVTS01+404
CVTAIDVT EQU   CVTS01+400
CVTSSAP  EQU   CVTS01+396
CVTEHCIR EQU   CVTS01+392
CVTEHDEF EQU   CVTS01+388
CVTDAIR  EQU   CVTS01+384
CVTPERFM EQU   CVTS01+380
CVT044R2 EQU   CVTS01+376
CVTFETCH EQU   CVTS01+372
CVTRSTWD EQU   CVTS01+368
CVTSPOST EQU   CVTS01+364
CVTIOBP  EQU   CVTS01+360
CVTASMVT EQU   CVTS01+356
CVTRECRQ EQU   CVTS01+352
CVTWSAC  EQU   CVTS01+348
CVTRV149 EQU   CVTS01+344
CVTWSAL  EQU   CVTS01+340
CVTSPSA  EQU   CVTS01+336
CVTGLMN  EQU   CVTS01+332
CVTVEAC0 EQU   CVTS01+328
CVT062R1 EQU   CVTS01+324
CVTRPOST EQU   CVTS01+320
CVTDQIQE EQU   CVTS01+316
CVTCSD   EQU   CVTS01+312
CVTLKRMA EQU   CVTS01+308
CVTRSPIE EQU   CVTS01+304
CVTRENQ  EQU   CVTS01+300
CVTLQCB  EQU   CVTS01+296
CVTFQCB  EQU   CVTS01+292
CVTQCS01 EQU   CVTS01+288
CVTAPFT  EQU   CVTS01+284
CVTPARRL EQU   CVTS01+280
CVTVWAIT EQU   CVTS01+276
CVTGSPL  EQU   CVTS01+272
CVTLSMQ  EQU   CVTS01+268
CVTGSMQ  EQU   CVTS01+264
CVTEXPRO EQU   CVTS01+260
CVTOPCTP EQU   CVTS01+256
CVTSIC   EQU   CVTS01+252
CVTTPIOS EQU   CVTS01+248
CVTRTMS  EQU   CVTS01+244
CVTSDBF  EQU   CVTS01+240
CVTSCBP  EQU   CVTS01+236
CVTSDMP  EQU   CVTS01+232
CVTSV60  EQU   CVTS01+228
CVTRTMCT EQU   CVTS01+224
CVTASCBL EQU   CVTS01+220
CVTASCBH EQU   CVTS01+216
CVTGDA   EQU   CVTS01+212
CVTVVMDI EQU   CVTS01+204
CVTAQTOP EQU   CVTS01+200
CVTIOSCS EQU   CVTS01+196
CVTSDRM  EQU   CVTS01+192
CVTOPTE  EQU   CVTS01+188
CVTSTXU  EQU   CVTS01+184
CVTQUIS  EQU   CVTS01+180
CVTPARS  EQU   CVTS01+176
CVTS1EE  EQU   CVTS01+172
CVTFRAS  EQU   CVTS01+168
CVTQSAS  EQU   CVTS01+164
CVTCRAS  EQU   CVTS01+160
CVTDELCP EQU   CVTS01+152
CVTAUTHL EQU   CVTS01+136
CVTSCAN  EQU   CVTS01+132
CVTRV144 EQU   CVTS01+130
CVTMAXMP EQU   CVTS01+128
CVTSTCK  EQU   CVTS01+124
CVTRV139 EQU   CVTS01+123
CVTDSSAC EQU   CVTS01+122
CVTRV513 EQU   CVTS01+121
CVTIOSPL EQU   CVTS01+120
CVTPTGT  EQU   CVTS01+116
CVTCSPIE EQU   CVTS01+112
CVTSMFEX EQU   CVTS01+108
CVTOLT0A EQU   CVTS01+104
CVTSRBRT EQU   CVTS01+100
CVTPUTL  EQU   CVTS01+96
CVTASCRL EQU   CVTS01+92
CVTASCRF EQU   CVTS01+88
CVTRV326 EQU   CVTS01+84
CVTRV325 EQU   CVTS01+80
CVTRV324 EQU   CVTS01+76
CVT0VL01 EQU   CVTS01+72
CVTSHRVM EQU   CVTS01+68
CVTRV332 EQU   CVTS01+64
CVTTAS   EQU   CVTS01+60
CVTRSCN  EQU   CVTS01+56
CVTTRAC2 EQU   CVTS01+54
CVTTRACE EQU   CVTS01+52
CVTAPG   EQU   CVTS01+51
CVTSDTRC EQU   CVTCTLFG
CVTGTRCE EQU   CVTCTLFG
CVTNOMP  EQU   CVTCTLFG
CVTRSV79 EQU   CVTCTLFG
CVTDSTAT EQU   CVTCTLFG
CVTRSV78 EQU   CVTCTLFG
CVTRV333 EQU   CVTCTLFG
CVTRV323 EQU   CVTCTLFG
CVTSPVLK EQU   CVTS01+49
CVTRSV77 EQU   CVTS01+48
CVTRV331 EQU   CVTS01+44
CVTRV330 EQU   CVTS01+40
CVTRV329 EQU   CVTS01+36
CVTRV328 EQU   CVTS01+32
CVTRV322 EQU   CVTS01+28
CVTSLID  EQU   CVTSLIDA+1
CVTSYLK  EQU   CVTSLIDA
CVTRV321 EQU   CVTS01+20
CVTRV320 EQU   CVTS01+16
CVTLPDIR EQU   CVTLPDIA+1
CVTRSV69 EQU   CVTDIRST
CVTRSV68 EQU   CVTDIRST
CVTRSV67 EQU   CVTDIRST
CVTRSV66 EQU   CVTDIRST
CVTRSV65 EQU   CVTDIRST
CVTRSV64 EQU   CVTDIRST
CVTRSV63 EQU   CVTDIRST
CVTDICOM EQU   CVTDIRST
CVTPVTP  EQU   CVTS01+8
CVTLPDSR EQU   CVTS01+4
CVTGETL  EQU   CVTS01
RBRSV161 EQU   RBSECS09+64
RBSIRBWA EQU   RBSECS09
RBIQEWRK EQU   RBSECS08+4
RBNEXAV  EQU   RBSECS08
RBIQEA   EQU   RBIQE2
RBIQE1   EQU   RBIQE+1
RBUSE    EQU   RBIQE
RBSQEA   EQU   RBSQE+1
@NM00090 EQU   RBSQE
RBCDE1   EQU   RBCDE+1
RBCDLOAD EQU   RBCDFLGS
RBCDXCTL EQU   RBCDFLGS
RBCDSYNC EQU   RBCDFLGS
RBCDNODE EQU   RBCDFLGS
RBCDSAVE EQU   RBCDFLGS
RBCDATCH EQU   RBCDFLGS
RBRSV009 EQU   RBCDFLGS
RBNOCELL EQU   RBCDFLGS
UCMIECBP EQU   UCMIECBA+1
UCMIECBF EQU   UCMIECBA
XVD3     EQU   XVDFLAGS+3
XVD2CON  EQU   XVD2
XVRESV01 EQU   XVD1
XVD1OEXT EQU   XVD1
XVD1CFPL EQU   XVD1
XVD0S250 EQU   XVD0
@NM00148 EQU   SCVTSECT+180
@NM00147 EQU   SCVTSECT+176
SCVTPIQE EQU   SCVTSECT+172
@NM00146 EQU   SCVTSECT+168
SCVTPTRM EQU   SCVTSECT+164
@NM00145 EQU   SCVTSECT+160
@NM00144 EQU   SCVTSECT+156
SCVTQCBR EQU   SCVTSECT+152
SCVTSTAT EQU   SCVTSECT+148
@NM00143 EQU   SCVTSECT+144
SCVTTQE  EQU   SCVTSECT+140
@NM00142 EQU   SCVTSECT+136
SCVTSVCT EQU   SCVTSECT+132
@NM00141 EQU   SCVTSECT+128
@NM00140 EQU   SCVTSECT+124
SCVTRXLQ EQU   SCVTSECT+120
@NM00139 EQU   SCVTSECT+116
SCVTCTCB EQU   SCVTSECT+112
@NM00138 EQU   SCVTSECT+108
@NM00137 EQU   SCVTSECT+104
@NM00136 EQU   SCVTSECT+100
@NM00135 EQU   SCVTSECT+96
SCVTCOMM EQU   SCVTSECT+92
@NM00134 EQU   SCVTSECT+88
@NM00133 EQU   SCVTSECT+84
@NM00132 EQU   SCVTSECT+80
@NM00131 EQU   SCVTSECT+76
@NM00130 EQU   SCVTSECT+72
SCVTGMBR EQU   SCVTSECT+68
SCVTRPTR EQU   SCVTSECT+64
SCVTHSKP EQU   SCVTSECT+60
@NM00129 EQU   SCVTSECT+56
@NM00128 EQU   SCVTSECT+52
SCVTLFRM EQU   SCVTSECT+48
SCVTCDCL EQU   SCVTSECT+44
@NM00127 EQU   SCVTSECT+40
SCVTRACE EQU   SCVTSECT+36
@NM00126 EQU   SCVTSECT+32
@NM00125 EQU   SCVTSECT+24
@NM00124 EQU   SCVTSECT+20
@NM00123 EQU   SCVTSECT+16
@NM00122 EQU   SCVTSECT+14
SCVTBR14 EQU   SCVTSECT+12
SCVTSPET EQU   SCVTSECT+8
SCVTPGWR EQU   SCVTSECT+4
SCVTPGTM EQU   SCVTSECT
CVTLEVL  EQU   CVTRELNO+2
CVTNUMB  EQU   CVTRELNO
CVTMDL   EQU   CVTFIX+250
@NM00121 EQU   CVTFIX+248
@NM00120 EQU   CVTFIX
CVTRV482 EQU   CVTXTNT2+128
CVTRV481 EQU   CVTXTNT2+124
CVTRV480 EQU   CVTXTNT2+120
CVTRV479 EQU   CVTXTNT2+118
CVTRV478 EQU   CVTXTNT2+117
CVTRV477 EQU   CVTXTNT2+116
CVTRV476 EQU   CVTXTNT2+115
CVTRV475 EQU   CVTXTNT2+114
CVTRV474 EQU   CVTRV466
CVTRV473 EQU   CVTRV466
CVTRV472 EQU   CVTRV466
CVTRV471 EQU   CVTRV466
CVTRV470 EQU   CVTRV466
CVTRV469 EQU   CVTRV466
CVTRV468 EQU   CVTRV466
CVTRV467 EQU   CVTRV466
CVTRV465 EQU   CVTRV457
CVTRV464 EQU   CVTRV457
CVTRV463 EQU   CVTRV457
CVTRV462 EQU   CVTRV457
CVTRV461 EQU   CVTRV457
CVTRV460 EQU   CVTRV457
CVTRV459 EQU   CVTRV457
CVTRV458 EQU   CVTRV457
CVTRV456 EQU   CVTXTNT2+108
CVTRV455 EQU   CVTXTNT2+104
CVTRV454 EQU   CVTXTNT2+100
CVTRV453 EQU   CVTXTNT2+96
CVTRV452 EQU   CVTXTNT2+94
CVTRV451 EQU   CVTXTNT2+92
CVTRV450 EQU   CVTXTNT2+90
CVTRV449 EQU   CVTXTNT2+88
CVTRV448 EQU   CVTXTNT2+87
CVTRV447 EQU   CVTXTNT2+86
CVTRV446 EQU   CVTRV438
CVTRV445 EQU   CVTRV438
CVTRV444 EQU   CVTRV438
CVTRV443 EQU   CVTRV438
CVTRV442 EQU   CVTRV438
CVTRV441 EQU   CVTRV438
CVTRV440 EQU   CVTRV438
CVTRV439 EQU   CVTRV438
CVTRV437 EQU   CVTRV429
CVTRV436 EQU   CVTRV429
CVTRV435 EQU   CVTRV429
CVTRV434 EQU   CVTRV429
CVTRV433 EQU   CVTRV429
CVTRV432 EQU   CVTRV429
CVTRV431 EQU   CVTRV429
CVTRV430 EQU   CVTRV429
CVTRV428 EQU   CVTXTNT2+80
CVTRV427 EQU   CVTXTNT2+76
CVTRV426 EQU   CVTXTNT2+72
CVTRV425 EQU   CVTXTNT2+68
CVTATACT EQU   CVTATCVT
CVTRV423 EQU   CVTXTNT2+62
CVTRV422 EQU   CVTXTNT2+60
CVTRV421 EQU   CVTXTNT2+58
CVTRV420 EQU   CVTXTNT2+56
CVTRV419 EQU   CVTXTNT2+55
CVTRV418 EQU   CVTXTNT2+54
CVTRV417 EQU   CVTRV409
CVTRV416 EQU   CVTRV409
CVTRV415 EQU   CVTRV409
CVTRV414 EQU   CVTRV409
CVTRV413 EQU   CVTRV409
CVTRV412 EQU   CVTRV409
CVTRV411 EQU   CVTRV409
CVTRV410 EQU   CVTRV409
CVTRV408 EQU   CVTRV400
CVTRV407 EQU   CVTRV400
CVTRV406 EQU   CVTRV400
CVTRV405 EQU   CVTRV400
CVTRV404 EQU   CVTRV400
CVTRV403 EQU   CVTRV400
CVTRV402 EQU   CVTRV400
CVTRV401 EQU   CVTRV400
CVTICB   EQU   CVTXTNT2+48
CVTSKTA  EQU   CVTXTNT2+44
CVTCCVT  EQU   CVTXTNT2+40
CVTRSV98 EQU   CVTXTNT2+36
CVTRSV97 EQU   CVTXTNT2+34
CVTRSV96 EQU   CVTXTNT2+32
CVTOLTEP EQU   CVTXTNT2+28
CVTQIDA  EQU   CVTQID+1
CVTRSV95 EQU   CVTQID
CVTRSV94 EQU   CVTXTNT2+20
CVTRSV93 EQU   CVTXTNT2+16
CVTRSV92 EQU   CVTXTNT2+12
CVTDEBVR EQU   CVTXTNT2+8
CVTRSV91 EQU   CVTXTNT2+6
CVTRSV9H EQU   CVTFLGBT
CVTRSV9G EQU   CVTFLGBT
CVTRSV9F EQU   CVTFLGBT
CVTRSV9E EQU   CVTFLGBT
CVTRSV9D EQU   CVTFLGBT
CVTRSV9C EQU   CVTFLGBT
CVTVME   EQU   CVTFLGBT
CVTNPE   EQU   CVTFLGBT
CVTNUCLS EQU   CVTXTNT2+4
CVTDSSVA EQU   CVTDSSV+1
CVTRSV89 EQU   CVTDSSV
CVTRSV88 EQU   CVTXTNT1+8
CVTRSV87 EQU   CVTXTNT1+4
CVTFACHN EQU   CVTXTNT1
CVTRV488 EQU   CVTMAP+412
CVTRV487 EQU   CVTMAP+408
CVTRV486 EQU   CVTMAP+404
CVTRV485 EQU   CVTMAP+400
CVTACTAP EQU   CVTMAP+396
CVTAUTH  EQU   CVTMAP+392
CVTATMCA EQU   CVTATMCT+1
CVTATMST EQU   CVTATMCT
CVTRSV61 EQU   CVTMAP+384
CVTVOLT1 EQU   CVTVOLM1+1
CVTVOLI1 EQU   CVTVOLF1
CVTSTOA  EQU   CVTMAP+376
CVTRSV58 EQU   CVTMAP+374
CVTRSV57 EQU   CVTMAP+372
CVTDDCE  EQU   CVTMAP+368
CVTPNWFR EQU   CVTMAP+364
CVTSMF   EQU   CVTMAP+360
CVTSULK  EQU   CVTMAP+358
CVTSLKO  EQU   CVTSYSK
CVTSLKP  EQU   CVTSYSK
CVTSLKQ  EQU   CVTSYSK
CVTSLKR  EQU   CVTSYSK
CVTRSV56 EQU   CVTSYSK
CVTRSV55 EQU   CVTSYSK
CVTRSV54 EQU   CVTSYSK
CVTRSV53 EQU   CVTSYSK
CVTRSV52 EQU   CVTA1F1
CVTRSV51 EQU   CVTA1F1
CVTRSV50 EQU   CVTA1F1
CVTRSV49 EQU   CVTA1F1
CVTRSV48 EQU   CVTA1F1
CVTRSV47 EQU   CVTA1F1
CVTSRSW  EQU   CVTA1F1
CVTPFSW  EQU   CVTA1F1
CVTPCVT  EQU   CVTMAP+352
CVTRSV46 EQU   CVTMAP+344
CVTRSV45 EQU   CVTMAP+340
CVTRSV44 EQU   CVTMAP+338
CVTRSV43 EQU   CVTMAP+336
CVTHJESA EQU   CVTHJES+1
CVTRSV42 EQU   CVTHJES
CVTEXT2A EQU   CVTEXT2+1
CVTRSV41 EQU   CVTEXT2
CVTAPFA  EQU   CVTAPF+1
CVTRSV40 EQU   CVTAPF
CVTRV518 EQU   CVTINTLA
CVTRV517 EQU   CVTERPV
CVTEORM  EQU   CVTMAP+312
CVTMCHPR EQU   CVTMAP+308
CVTTZ    EQU   CVTMAP+304
CVTJEPS  EQU   CVTMAP+300
CVTMODE  EQU   CVTMAP+292
CVTPTRV  EQU   CVTMAP+288
CVTREAL  EQU   CVTMAP+284
CVTRSV39 EQU   CVTMAP+280
CVTRSV38 EQU   CVTMAP+276
CVTDMSRA EQU   CVTDMSR+1
CVTRV634 EQU   CVTDMSRF
CVTRV633 EQU   CVTDMSRF
CVTRV632 EQU   CVTDMSRF
CVTRV631 EQU   CVTDMSRF
CVTRV630 EQU   CVTDMSRF
CVTRV629 EQU   CVTDMSRF
CVTUDUMP EQU   CVTDMSRF
CVTSDUMP EQU   CVTDMSRF
CVTQMSGA EQU   CVTQMSG+1
CVTRSV36 EQU   CVTQMSG
CVTAMFF  EQU   CVTMAP+264
CVTPURGA EQU   CVTPURG+1
CVTRSV35 EQU   CVTPURG
CVTCBSP  EQU   CVTMAP+256
CVTATERA EQU   CVTATER+1
CVTSYST  EQU   CVTATER
CVTVOLT2 EQU   CVTTAT
CVTVOLI2 EQU   CVTVOLF2
CVTAQAVB EQU   CVTAQAVT+1
CVTRSV34 EQU   CVTTCMFG
CVTRSV33 EQU   CVTTCMFG
CVTRSV32 EQU   CVTTCMFG
CVTRSV31 EQU   CVTTCMFG
CVTRSV30 EQU   CVTTCMFG
CVTRSV29 EQU   CVTTCMFG
CVTRSV28 EQU   CVTTCMFG
CVTTCRDY EQU   CVTTCMFG
CVTGTFA  EQU   CVTGTF+1
CVTRSV27 EQU   CVTGTFST
CVTRNIO  EQU   CVTGTFST
CVTUSR   EQU   CVTGTFST
CVTRV318 EQU   CVTFORM
CVTRV317 EQU   CVTTMODE
CVTRV316 EQU   CVTSTATE
CVTRV315 EQU   CVTGTFS
CVTGTFAV EQU   CVTGTFS
CVT0SCR1 EQU   CVTMAP+232
CVTRV515 EQU   CVTMAP+228
CVTRMS   EQU   CVTMAP+224
CVTPATCH EQU   CVTMAP+220
CVTTSCE  EQU   CVTMAP+216
CVTLNKSC EQU   CVTMAP+214
CVTQABST EQU   CVTMAP+212
CVTMDLDS EQU   CVTMAP+208
CVTUSER  EQU   CVTMAP+204
CVTSMCA  EQU   CVTMAP+196
CVTRSV18 EQU   CVTMAP+192
CVTQLPAQ EQU   CVTMAP+188
CVTQCDSR EQU   CVTMAP+184
CVTRSV17 EQU   CVTOPTB
CVTRSV16 EQU   CVTOPTB
CVTFP    EQU   CVTOPTB
CVTAPTHR EQU   CVTOPTB
CVTNLOG  EQU   CVTOPTB
CVTTOD   EQU   CVTOPTB
CVTCTIMS EQU   CVTOPTB
CVTPROT  EQU   CVTOPTB
CVTXPFP  EQU   CVTOPTA
CVTASCII EQU   CVTOPTA
CVTRSV13 EQU   CVTOPTA
CVTRSV12 EQU   CVTOPTA
CVTNIP   EQU   CVTOPTA
CVTDDR   EQU   CVTOPTA
CVTAPR   EQU   CVTOPTA
CVTCCH   EQU   CVTOPTA
CVTSNCTR EQU   CVTMAP+180
CVTQMWR  EQU   CVTMAP+176
CVTQOCR  EQU   CVTMAP+172
CVT1EF00 EQU   CVTMAP+168
CVTMZ00  EQU   CVTMAP+164
CVTSV76Q EQU   CVTSV76C
CVTRSV11 EQU   CVTMAP+156
CVTRV516 EQU   CVTIERLC
CVTILCH  EQU   CVTMAP+140
CVT0DS   EQU   CVTMAP+136
CVTFBOSV EQU   CVTMAP+132
CVTNUCB  EQU   CVTMAP+128
CVTIXAVL EQU   CVTMAP+124
CVTSV76M EQU   CVTIOQET
CVTDCBA  EQU   CVTMAP+117
CVTMVS2  EQU   CVTDCB
CVT6DAT  EQU   CVTDCB
CVT4MPS  EQU   CVTDCB
CVTRSV09 EQU   CVTDCB
CVT4MS1  EQU   CVTDCB
CVT2SPS  EQU   CVTDCB
CVT1SSS  EQU   CVTDCB
CVTRSV08 EQU   CVTDCB
CVTSTB   EQU   CVTMAP+112
CVTQTD00 EQU   CVTMAP+108
CVTQTE00 EQU   CVTMAP+104
CVTSJQ   EQU   CVTMAP+96
CVTPBLDL EQU   CVTMAP+92
CVTTPC   EQU   CVTMAP+88
CVTSVDCB EQU   CVTMAP+84
CVTBRET  EQU   CVTMAP+82
CVTEXIT  EQU   CVTMAP+80
CVT0FN00 EQU   CVTMAP+76
CVTDARA  EQU   CVTDAR+1
CVTRSV07 EQU   CVTFLGS1
CVTRSV06 EQU   CVTFLGS1
CVTRSV05 EQU   CVTFLGS1
CVTRSV04 EQU   CVTFLGS1
CVTRSV03 EQU   CVTFLGS1
CVTRSV02 EQU   CVTFLGS1
CVTRSV01 EQU   CVTFLGS1
CVTDMPLK EQU   CVTFLGS1
CVTXITP  EQU   CVTMAP+68
CVTZDTAB EQU   CVTMAP+64
CVTMSLT  EQU   CVTMAP+60
CVTDATE  EQU   CVTMAP+56
CVTBTERM EQU   CVTMAP+52
CVTSYSAD EQU   CVTMAP+48
CVTXTLER EQU   CVTMAP+44
CVTILK2  EQU   CVTMAP+40
CVTILK1  EQU   CVTMAP+36
CVTPRLTV EQU   CVTMAP+32
CVTPCNVT EQU   CVTMAP+28
CVT0VL00 EQU   CVTMAP+24
CVTXAPG  EQU   CVTMAP+20
CVTBUF   EQU   CVTMAP+16
CVTJOB   EQU   CVTMAP+12
CVTLINK  EQU   CVTMAP+8
CVT0EF00 EQU   CVTMAP+4
CVTTCBP  EQU   CVTMAP
CVT      EQU   CVTMAP
ASCBEND  EQU   ASCB+208
ASCBSRBT EQU   ASCB+200
ASCBSWTL EQU   ASCB+196
ASCBRS14 EQU   ASCB+195
ASCBSMCT EQU   ASCB+194
ASCBRS12 EQU   ASCB+192
ASCBPCTT EQU   ASCB+188
ASCBVGTT EQU   ASCB+184
ASCBLGCB EQU   ASCB+180
ASCBJBNS EQU   ASCB+176
ASCBJBNI EQU   ASCB+172
ASCBMCC  EQU   ASCB+168
ASCBRTWA EQU   ASCB+164
ASCBIQEA EQU   ASCB+160
ASCBXMPQ EQU   ASCB+156
ASCBRS01 EQU   ASCB+154
ASCBFMCT EQU   ASCB+152
ASCBOUXB EQU   ASCB+148
ASCBOUCB EQU   ASCB+144
ASCBMECB EQU   ASCB+140
ASCBQECB EQU   ASCB+136
ASCBCMSB EQU   ASCB+132
ASCBCMSF EQU   ASCB+128
ASCBTCBS EQU   ASCB+124
ASCBNVSC EQU   ASCB+122
ASCBVSC  EQU   ASCB+120
ASCBSRBS EQU   ASCB+118
ASCBSSRB EQU   ASCB+116
ASCBRV06 EQU   ASCBFLG2
ASCBRV05 EQU   ASCBFLG2
ASCBRV04 EQU   ASCBFLG2
ASCBSNQS EQU   ASCBFLG2
ASCBS2S  EQU   ASCBFLG2
ASCBCEXT EQU   ASCBFLG2
ASCBPXMT EQU   ASCBFLG2
ASCBXMPT EQU   ASCBFLG2
ASCBRF07 EQU   ASCBDSP1
ASCBRF06 EQU   ASCBDSP1
ASCBRF05 EQU   ASCBDSP1
ASCBRF04 EQU   ASCBDSP1
ASCBRF03 EQU   ASCBDSP1
ASCBRF02 EQU   ASCBDSP1
ASCBFAIL EQU   ASCBDSP1
ASCBNOQ  EQU   ASCBDSP1
ASCBSWCT EQU   ASCB+112
ASCBASXB EQU   ASCB+108
ASCBTMCH EQU   ASCB+104
ASCBNSWP EQU   ASCBFLG1
ASCBTYP1 EQU   ASCBFLG1
ASCBSTND EQU   ASCBFLG1
ASCBABNT EQU   ASCBFLG1
ASCBTERM EQU   ASCBFLG1
ASCBS3S  EQU   ASCBFLG1
ASCBCMSH EQU   ASCBFLG1
ASCBTOFF EQU   ASCBFLG1
ASCBRF01 EQU   ASCBRCTF
ASCBTMLW EQU   ASCBRCTF
ASCBOUT  EQU   ASCBRCTF
ASCBWAIT EQU   ASCBRCTF
ASCBRV08 EQU   ASCBRCTF
ASCBFQU  EQU   ASCBRCTF
ASCBFRS  EQU   ASCBRCTF
ASCBTMNO EQU   ASCBRCTF
ASCBAFFN EQU   ASCBFW1
ASCBDUMP EQU   ASCB+96
ASCBQSVC EQU   ASCB+92
ASCBUBET EQU   ASCB+88
ASCBECB  EQU   ASCB+84
ASCBJSTL EQU   ASCB+80
ASCBEWST EQU   ASCB+72
ASCBEJST EQU   ASCB+64
ASCBTSB  EQU   ASCB+60
ASCBCSCB EQU   ASCB+56
ASCBRSM  EQU   ASCB+52
ASCBLDA  EQU   ASCB+48
ASCBSTOR EQU   ASCB+44
ASCBDP   EQU   ASCB+43
ASCBRV07 EQU   ASCB+42
ASCBIOSM EQU   ASCB+40
ASCBSEQN EQU   ASCB+38
ASCBCPUS EQU   ASCB+32
ASCBSPL  EQU   ASCB+28
ASCBLSLQ EQU   ASCB+24
ASCBFSLQ EQU   ASCB+20
ASCBIOSP EQU   ASCB+16
ASCBLOCK EQU   ASCB+12
ASCBBWDP EQU   ASCB+8
ASCBFWDP EQU   ASCB+4
ASCBASCB EQU   ASCB
ASCBEGIN EQU   ASCB
ASVTEND  EQU   ASVT+528
ASVTAVAL EQU   ASVTENTY
ASVTAVAI EQU   ASVTFRST
ASVTRS00 EQU   ASVT+520
ASVTMAXU EQU   ASVT+516
ASVTASVT EQU   ASVT+512
ASVTBEGN EQU   ASVT+512
@NM00095 EQU   ASVT
@NM00094 EQU   TCBXTNT2+32
TCBRV181 EQU   TCBRV173
TCBRV180 EQU   TCBRV173
TCBRV179 EQU   TCBRV173
TCBRV178 EQU   TCBRV173
TCBRV177 EQU   TCBRV173
TCBRV176 EQU   TCBRV173
TCBRV175 EQU   TCBRV173
TCBRV174 EQU   TCBRV173
TCBRV172 EQU   TCBRV164
TCBRV171 EQU   TCBRV164
TCBRV170 EQU   TCBRV164
TCBRV169 EQU   TCBRV164
TCBRV168 EQU   TCBRV164
TCBRV167 EQU   TCBRV164
TCBRV166 EQU   TCBRV164
TCBRV165 EQU   TCBRV164
TCBRV163 EQU   TCBRV155
TCBRV162 EQU   TCBRV155
TCBRV161 EQU   TCBRV155
TCBRV160 EQU   TCBRV155
TCBRV159 EQU   TCBRV155
TCBRV158 EQU   TCBRV155
TCBRV157 EQU   TCBRV155
TCBRV156 EQU   TCBRV155
TCBRV154 EQU   TCBRV146
TCBRV153 EQU   TCBRV146
TCBRV152 EQU   TCBRV146
TCBRV151 EQU   TCBRV146
TCBRV150 EQU   TCBRV146
TCBRV149 EQU   TCBRV146
TCBRV148 EQU   TCBRV146
TCBRV147 EQU   TCBRV146
TCBRV145 EQU   TCBXTNT2+26
TCBRV144 EQU   TCBXTNT2+24
TCBCAUF  EQU   TCBXTNT2+20
TCBRV142 EQU   TCBXTNT2+16
TCBRSV49 EQU   TCBXTNT2+12
TCBEVENT EQU   TCBXTNT2+8
TCBRCMP  EQU   TCBXTNT2+5
TCBRSVAB EQU   TCBXTNT2+4
TCBGTFA  EQU   TCBGTF+1
TCBRSV47 EQU   TCBTFLG
TCBRSV46 EQU   TCBTFLG
TCBRSV45 EQU   TCBTFLG
TCBRSV44 EQU   TCBTFLG
TCBRSV43 EQU   TCBTFLG
TCBDSPIT EQU   TCBTFLG
TCBERRTN EQU   TCBTFLG
TCBASYNC EQU   TCBTFLG
@NM00093 EQU   TCB+296
TCBSVCA2 EQU   TCB+292
TCBSWASA EQU   TCB+288
TCBDBTB  EQU   TCB+284
TCBRPT   EQU   TCB+280
TCBRV141 EQU   TCBRV133
TCBRV140 EQU   TCBRV133
TCBRV139 EQU   TCBRV133
TCBRV138 EQU   TCBRV133
TCBRV137 EQU   TCBRV133
TCBRV136 EQU   TCBRV133
TCBRV135 EQU   TCBRV133
TCBRV134 EQU   TCBRV133
TCBRV132 EQU   TCBRV124
TCBRV131 EQU   TCBRV124
TCBRV130 EQU   TCBRV124
TCBRV129 EQU   TCBRV124
TCBRV128 EQU   TCBRV124
TCBRV127 EQU   TCBRV124
TCBRV126 EQU   TCBRV124
TCBRV125 EQU   TCBRV124
TCBRV123 EQU   TCBFBYT2
TCBRV122 EQU   TCBFBYT2
TCBECBNV EQU   TCBFBYT2
TCBSSSYN EQU   TCBFBYT2
TCBFPRAP EQU   TCBFBYT2
TCBFDW   EQU   TCBFBYT2
TCBFMW   EQU   TCBFBYT2
TCBCNCB  EQU   TCBFBYT2
TCBLLH   EQU   TCBFBYT1
TCBRV113 EQU   TCBFBYT1
TCBEOT   EQU   TCBFBYT1
TCBRTM2  EQU   TCBFBYT1
TCBPGNLY EQU   TCBFBYT1
TCBNDIOS EQU   TCBFBYT1
TCBACTIV EQU   TCBFBYT1
TCBEOTFM EQU   TCBFBYT1
TCBAFFN  EQU   TCB+274
TCBCCPVI EQU   TCB+272
TCBUKYSP EQU   TCB+268
TCBMODE  EQU   TCBESTAE+3
TCBERTYP EQU   TCBESTAE+2
TCBRV314 EQU   TCBESTRM
TCBRV313 EQU   TCBESTRM
TCBRV312 EQU   TCBESTRM
TCBRV311 EQU   TCBESTRM
TCBRV310 EQU   TCBESTRM
TCBRV309 EQU   TCBESTRM
TCBRV308 EQU   TCBESTRM
TCBETERM EQU   TCBESTRM
TCBSCBKY EQU   TCBESTAE
TCBRTM12 EQU   TCB+260
TCBTCBID EQU   TCB+256
TCBRSV96 EQU   TCB+252
TCBSWA   EQU   TCB+248
TCBFOEA  EQU   TCBFOE+1
TCBRSV42 EQU   TCBFOE
TCBRV306 EQU   TCB+240
TCBRSV41 EQU   TCB+239
TCBRSVAA EQU   TCB+237
TCBABCUR EQU   TCB+236
TCBTMSAV EQU   TCB+232
TCBIOTIM EQU   TCB+228
TCBRTWA  EQU   TCB+224
TCBBACK  EQU   TCB+220
TCBTIRB  EQU   TCB+216
TCBAECB  EQU   TCB+212
TCBEXT2A EQU   TCBEXT2+1
TCBRSV39 EQU   TCBEXT2
TCBSTMCT EQU   TCB+207
TCBSYSCT EQU   TCB+206
TCBRSV37 EQU   TCB+205
TCBEXSVC EQU   TCBDAR
TCBDARMS EQU   TCBDAR
TCBDARWT EQU   TCBDAR
TCBDARO  EQU   TCBDAR
TCBDARMC EQU   TCBDARC
TCBDARD  EQU   TCBDAR
TCBDARS  EQU   TCBDAR
TCBDARP  EQU   TCBDAR
TCBGTOFM EQU   TCBFLGS7
TCBADMP  EQU   TCBFLGS7
TCBRSTSK EQU   TCBFLGS7
TCBSVCS  EQU   TCBFLGS7
TCBSTACK EQU   TCBFLGS7
TCBRSV34 EQU   TCBFLGS7
TCBRSV33 EQU   TCBFLGS7
TCBGPECB EQU   TCBFLGS7
TCBNTJS  EQU   TCBFLGS6
TCBAPG   EQU   TCBFLGS6
TCBMIGR  EQU   TCBFLGS6
TCBRV303 EQU   TCBFLGS6
TCBSPVLK EQU   TCBFLGS6
TCBCPU   EQU   TCBFLGS6
TCBPIE17 EQU   TCBFLGS6
TCBRV    EQU   TCBFLGS6
TCBRSV79 EQU   TCBNDSP5
TCBRSV78 EQU   TCBNDSP5
TCBRSV77 EQU   TCBNDSP5
TCBRSV76 EQU   TCBNDSP5
TCBRSV75 EQU   TCBNDSP5
TCBRSV74 EQU   TCBNDSP5
TCBRSV95 EQU   TCBNDSP5
TCBRSV94 EQU   TCBNDSP5
TCBRSV93 EQU   TCBNDSP4
TCBRSV92 EQU   TCBNDSP4
TCBRSV91 EQU   TCBNDSP4
TCBRSV90 EQU   TCBNDSP4
TCBRSV89 EQU   TCBNDSP4
TCBRSV88 EQU   TCBNDSP4
TCBRSV87 EQU   TCBNDSP4
TCBRSV86 EQU   TCBNDSP4
TCBEXT1A EQU   TCBEXT1+1
TCBRSV32 EQU   TCBEXT1
TCBEXCPD EQU   TCB+192
TCBIOBRC EQU   TCB+188
TCBDDWTC EQU   TCB+186
TCBDDEXC EQU   TCB+184
TCBJSCBB EQU   TCBJSCB+1
@NM00092 EQU   TCBRECDE
TCBREC   EQU   TCBRECDE
TCBMDIDS EQU   TCB+176
TCBNDINT EQU   TCBNDSP3
TCBRSV27 EQU   TCBNDSP3
TCBRSV26 EQU   TCBNDSP3
TCBRSV25 EQU   TCBNDSP3
TCBRSV24 EQU   TCBNDSP3
TCBSRBND EQU   TCBNDSP3
TCBRV302 EQU   TCBNDSP3
TCBLJSND EQU   TCBNDSP3
TCBABE   EQU   TCBNDSP2
TCBDSS   EQU   TCBNDSP2
TCBOWAIT EQU   TCBNDSP2
TCBIWAIT EQU   TCBNDSP2
TCBNDTS  EQU   TCBNDSP2
TCBNDSVC EQU   TCBNDSP2
TCBSTPP  EQU   TCBNDSP2
TCBABD   EQU   TCBNDSP2
TCBRSV22 EQU   TCBNDSP1
TCBPIEND EQU   TCBNDSP1
TCBTPSP  EQU   TCBNDSP1
TCBDDRND EQU   TCBNDSP1
TCBRSPND EQU   TCBNDSP1
TCBRSTND EQU   TCBNDSP1
TCBDARPN EQU   TCBNDSP1
TCBDARTN EQU   TCBNDSP1
TCBNDSP0 EQU   TCBNDSP
TCBUSER  EQU   TCB+168
TCBTCTB  EQU   TCBTCT+1
TCBRSV9C EQU   TCBTCTGF
TCBRSV9B EQU   TCBTCTGF
TCBRSV9A EQU   TCBTCTGF
TCBRSV99 EQU   TCBTCTGF
TCBRSV98 EQU   TCBTCTGF
TCBRSV97 EQU   TCBTCTGF
TCBRSV20 EQU   TCBTCTGF
TCBSMFGF EQU   TCBTCTGF
TCBSTABB EQU   TCBSTAB+1
TCBSTCUR EQU   TCBNSTAE
TCBRV301 EQU   TCBNSTAE
TCBSYNCH EQU   TCBNSTAE
TCBHALT  EQU   TCBNSTAE
TCBPPSUP EQU   TCBNSTAE
TCB33E   EQU   TCBNSTAE
TCBQUIES EQU   TCBNSTAE
TCBSTABE EQU   TCBNSTAE
TCBAQE   EQU   TCB+156
TCBPQE   EQU   TCB+152
TCBTSDP  EQU   TCB+151
TCBTSLP  EQU   TCB+150
TCBSTPCT EQU   TCB+149
TCBCPUBN EQU   TCBTSFLG
TCBDYDSP EQU   TCBTSFLG
TCBRSV18 EQU   TCBTSFLG
TCBRSV17 EQU   TCBTSFLG
TCBTIOTG EQU   TCBTSFLG
TCBATT   EQU   TCBTSFLG
TCBSTPPR EQU   TCBTSFLG
TCBRV300 EQU   TCBTSTSK
TCBECB   EQU   TCB+144
TCBIQE   EQU   TCB+140
TCBLTC   EQU   TCB+136
TCBNTC   EQU   TCB+128
TCBJSTCA EQU   TCBJSTCB+1
TCBRSV16 EQU   TCBJSTCB
TCBTQET  EQU   TCBTME
TCBTCB   EQU   TCB+116
TCBFSAB  EQU   TCBFSA+1
TCBQEL   EQU   TCBFSA
TCBGRS15 EQU   TCBGRS+60
TCBGRS14 EQU   TCBGRS+56
TCBGRS13 EQU   TCBGRS+52
TCBGRS12 EQU   TCBGRS+48
TCBGRS11 EQU   TCBGRS+44
TCBGRS10 EQU   TCBGRS+40
TCBGRS9  EQU   TCBGRS+36
TCBGRS8  EQU   TCBGRS+32
TCBGRS7  EQU   TCBGRS+28
TCBGRS6  EQU   TCBGRS+24
TCBGRS5  EQU   TCBGRS+20
TCBGRS4  EQU   TCBGRS+16
TCBGRS3  EQU   TCBGRS+12
TCBGRS2  EQU   TCBGRS+8
TCBGRS1  EQU   TCBGRS+4
TCBGRS0  EQU   TCBGRS
TCBJPQB  EQU   TCBJPQ+1
TCBRSV15 EQU   TCBPURGE
TCBRSV14 EQU   TCBPURGE
TCBRSV13 EQU   TCBPURGE
TCBRSV12 EQU   TCBPURGE
TCBRSV11 EQU   TCBPURGE
TCBRSV10 EQU   TCBPURGE
TCBRSV09 EQU   TCBPURGE
TCBJPQF  EQU   TCBPURGE
TCBJLB   EQU   TCB+40
TCBLLS   EQU   TCB+36
TCBDSP   EQU   TCB+35
TCBLMP   EQU   TCB+34
TCBPNDSP EQU   TCBFLGS5
TCBFCD1  EQU   TCBFLGS5
TCBSTP   EQU   TCBFLGS5
TCBSYS   EQU   TCBFLGS5
TCBANDSP EQU   TCBFLGS5
TCBPAGE  EQU   TCBFLGS5
TCBUXNDF EQU   TCBABWF
TCBFC    EQU   TCBFLGS5
TCBONDSP EQU   TCBFLGS4
TCBMPCND EQU   TCBFLGS4
TCBMPCVQ EQU   TCBFLGS4
TCBUXNDV EQU   TCBFLGS4
TCBHNDSP EQU   TCBFLGS4
TCBRQENA EQU   TCBFLGS4
TCBSER   EQU   TCBFLGS4
TCBNDUMP EQU   TCBFLGS4
TCBDWSTA EQU   TCBFLGS3
TCBRSV08 EQU   TCBFLGS3
TCBRSV07 EQU   TCBFLGS3
TCBRSV06 EQU   TCBFLGS3
TCBABGM  EQU   TCBFLGS3
TCBABTRM EQU   TCBFLGS3
TCBADINP EQU   TCBFLGS3
TCBFSM   EQU   TCBFLGS3
TCBFTS   EQU   TCBFLGS2
TCBFETXR EQU   TCBFLGS2
TCBFDSOP EQU   TCBFLGS2
TCBFJMC  EQU   TCBFLGS2
TCBFSMC  EQU   TCBFLGS2
TCBFABOP EQU   TCBFLGS2
TCBFSTI  EQU   TCBFLGS2
TCBFOINP EQU   TCBFLGS2
TCBFX    EQU   TCBFLGS1
TCBFS    EQU   TCBFLGS1
TCBFT    EQU   TCBFLGS1
TCBPDUMP EQU   TCBFLGS1
TCBNONPR EQU   TCBFLGS1
TCBFERA  EQU   TCBFLGS1
TCBFE    EQU   TCBFLGS1
TCBFA    EQU   TCBFLGS1
TCBZERO  EQU   TCBPKF
TCBFLAG  EQU   TCBPKF
TCBMSSB  EQU   TCBMSS+1
TCBRSV03 EQU   TCBMSS
TCBTRNB  EQU   TCBTRN+1
TCBRSV02 EQU   TCBABF
TCBOLTEP EQU   TCBABF
TCBTCP   EQU   TCBABF
TCBTCPP  EQU   TCBABF
TCBRSV01 EQU   TCBABF
TCBGRPH  EQU   TCBABF
TCBNOCHK EQU   TCBABF
TCBMOD91 EQU   TCBABF
TCBCMPC  EQU   TCBCMP+1
TCBRV318 EQU   TCBCMSG
TCBRV317 EQU   TCBCIND
TCBRV316 EQU   TCBCWTO
TCBCASID EQU   TCBCDBL
TCBNOCC  EQU   TCBSTCC
TCBDMPO  EQU   TCBCPP
TCBCSTEP EQU   TCBCMPF
TCBCREQ  EQU   TCBCMPF
TCBTIO   EQU   TCB+12
TCBDEB   EQU   TCB+8
TCBPIEA  EQU   TCBPIE+1
TCBPM    EQU   TCBPMASK
@NM00091 EQU   TCBPMASK
TCBFRS6  EQU   TCBFRS+24
TCBFRS4  EQU   TCBFRS+16
TCBFRS2  EQU   TCBFRS+8
TCBFRS0  EQU   TCBFRS
SIRBEND  EQU   RBSECT+168
SVRBEND  EQU   RBSECT+168
RBRSV158 EQU   RBRSV150
RBRSV157 EQU   RBRSV150
RBRSV156 EQU   RBRSV150
RBRSV155 EQU   RBRSV150
RBRSV154 EQU   RBRSV150
RBRSV153 EQU   RBRSV150
RBRSV152 EQU   RBRSV150
RBRSV151 EQU   RBRSV150
RBRSV149 EQU   RBSECT+166
RBRSV148 EQU   RBSECT+164
RBSCBB   EQU   RBSECT+144
TIRBEND  EQU   @NM00089+8
PRBEND   EQU   @NM00089+8
RBRSV146 EQU   RBRSV138
RBRSV145 EQU   RBRSV138
RBRSV144 EQU   RBRSV138
RBRSV143 EQU   RBRSV138
RBRSV142 EQU   RBRSV138
RBRSV141 EQU   RBRSV138
RBRSV140 EQU   RBRSV138
RBRSV139 EQU   RBRSV138
RBRSV137 EQU   @NM00089+6
RBRSV136 EQU   @NM00089+4
RBRSV135 EQU   @NM00089
@NM00088 EQU   RBSECT+32
@NM00087 EQU   @NM00085+1
@NM00086 EQU   @NM00085
RBPGMQ1  EQU   RBPGMQ+1
@NM00084 EQU   RBPGMQ
@NM00083 EQU   RBSECT+16
@NM00082 EQU   @NM00078
@NM00081 EQU   @NM00078
RBIQETP  EQU   @NM00078
RBUSIQE  EQU   RBETXR
RBATTN   EQU   @NM00078
@NM00080 EQU   @NM00078
@NM00079 EQU   @NM00078
RBPMSVRB EQU   @NM00076
RBATNXIT EQU   @NM00076
@NM00077 EQU   @NM00076
RBWAITP  EQU   @NM00076
RBFNSVRB EQU   RBTRSVRB
RBSIZE   EQU   RBSECT+8
RBABOPSW EQU   RBSECT+4
RBPPSAV1 EQU   RBPPSAV+1
@NM00074 EQU   RBPPSAV
RBPRFXND EQU   RBPREFIX+64
RBINTCOD EQU   RBINTCDA+1
RBINLNTH EQU   RBINTCDA
RBWCSA   EQU   RBPREFIX+60
RBRSV004 EQU   RBPREFIX+57
RBSSSYN  EQU   RBFLAGS1
RBSCB    EQU   RBFLAGS1
RBLONGWT EQU   RBFLAGS1
RBASIR   EQU   RBFLAGS1
RBRSV159 EQU   RBFLAGS1
RBABEND  EQU   RBFLAGS1
RBXWAIT  EQU   RBFLAGS1
RBSLOCK  EQU   RBFLAGS1
RBRTRAN  EQU   RBRTPSW2+4
RBRTINCD EQU   RBRTICIL+2
RBRTILC  EQU   RBRTICIL+1
RBRSV160 EQU   RBRTICIL
RBRTPSW1 EQU   RBRTOPSW
RBRSV062 EQU   RBRSV054
RBRSV061 EQU   RBRSV054
RBRSV060 EQU   RBRSV054
RBRSV059 EQU   RBRSV054
RBRSV058 EQU   RBRSV054
RBRSV057 EQU   RBRSV054
RBRSV056 EQU   RBRSV054
RBRSV055 EQU   RBRSV054
RBRSV053 EQU   RBPREFIX+38
RBRSV052 EQU   RBPREFIX+36
RBRSV051 EQU   RBPREFIX+32
RBPRFXST EQU   RBPREFIX+32
RBRSV050 EQU   RBPREFIX+28
RBRSV049 EQU   RBRSV041
RBRSV048 EQU   RBRSV041
RBRSV047 EQU   RBRSV041
RBRSV046 EQU   RBRSV041
RBRSV045 EQU   RBRSV041
RBRSV044 EQU   RBRSV041
RBRSV043 EQU   RBRSV041
RBRSV042 EQU   RBRSV041
RBRSV040 EQU   RBPREFIX+26
RBRSV039 EQU   RBPREFIX+24
RBRSV038 EQU   RBPREFIX+20
RBRSV037 EQU   RBPREFIX+16
RBRSV036 EQU   RBRSV028
RBRSV035 EQU   RBRSV028
RBRSV034 EQU   RBRSV028
RBRSV033 EQU   RBRSV028
RBRSV032 EQU   RBRSV028
RBRSV031 EQU   RBRSV028
RBRSV030 EQU   RBRSV028
RBRSV029 EQU   RBRSV028
RBRSV027 EQU   RBRSV019
RBRSV026 EQU   RBRSV019
RBRSV025 EQU   RBRSV019
RBRSV024 EQU   RBRSV019
RBRSV023 EQU   RBRSV019
RBRSV022 EQU   RBRSV019
RBRSV021 EQU   RBRSV019
RBRSV020 EQU   RBRSV019
RBRSV018 EQU   RBPREFIX+13
RBRSV017 EQU   RBPREFIX+12
RBSRV016 EQU   RBPREFIX+11
RBRSV015 EQU   RBPREFIX+10
RBRSV014 EQU   RBPREFIX+8
RBRSV013 EQU   RBPREFIX+4
RBRSV012 EQU   RBPREFIX
XRBREG15 EQU   RBGRS15
XRBREG14 EQU   RBGRS14
XRBREG13 EQU   RBGRS13
XRBREG12 EQU   RBGRS12
XRBREG11 EQU   RBGRS11
XRBREG10 EQU   RBGRS10
XRBREG9  EQU   RBGRS9
XRBREG8  EQU   RBGRS8
XRBREG7  EQU   RBGRS7
XRBREG6  EQU   RBGRS6
XRBREG5  EQU   RBGRS5
XRBREG4  EQU   RBGRS4
XRBREG3  EQU   RBGRS3
XRBREG2  EQU   RBGRS2
XRBREG1  EQU   RBGRS1
XRBREG0  EQU   RBGRS0
XRBLNKA  EQU   RBLINKB
XRBWT    EQU   RBWCF
@NM00073 EQU   RBBASIC+24
RBOPSWPS EQU   RBOPSWB2
@NM00072 EQU   RBOPSWB2
@NM00071 EQU   XRBPSW
@NM00070 EQU   RBBASIC+12
XRBWAIT  EQU   RBECBWT
XRBFRRB  EQU   RBFDYN
@NM00069 EQU   XSTAB2
XRBACTV  EQU   RBFACTV
XRBTCBP  EQU   RBTCBNXT
@NM00068 EQU   XSTAB1
XRBCKPT  EQU   RBFTCKPT
@NM00067 EQU   XSTAB1
@NM00066 EQU   RBBASIC+8
@NM00065 EQU   RBEXRTNM+1
RBTMIND3 EQU   RBTMFLD
RBTMIND2 EQU   RBTMFLD
RBTMCMP  EQU   RBTMFLD
RBWLIM   EQU   RBTMFLD
RBRSV005 EQU   RBTMFLD
RBTMTOD  EQU   RBTMFLD
RBTMQUE  EQU   RBTMFLD
@NM00064 EQU   RBPRFX
ESTARSVI EQU   ESTAFGRS+1
@NM00063 EQU   ESTAFLG2
ESTABRNT EQU   ESTAFLG2
@NM00062 EQU   ESTAFLG2
ESTAEREC EQU   ESTAFLG2
ESTATERM EQU   ESTAFLG2
@NM00061 EQU   ESTAFLG2
ESTAOWNR EQU   ESTA+8
ESTAPARM EQU   ESTA+4
ESTAEXIT EQU   ESTAEXT+1
ESTAHALT EQU   ESTAIO
ESTANOIO EQU   ESTAIO
ESTASYNC EQU   ESTAFLG1
@NM00060 EQU   ESTAFLG1
ESTAESTA EQU   ESTAFLG1
@NM00059 EQU   ESTAFLG1
ESTASTAR EQU   ESTAFLG1
ESTASTAI EQU   ESTAFLG1
MSSPARE  EQU   BASES01+48
MSUCBAL  EQU   BASES01+44
MSUCBPR  EQU   BASES01+40
MSBOBECB EQU   BASES01+36
MSSJQ    EQU   BASES01+32
MSECB    EQU   BASES01+28
MSPBP    EQU   BASES01+24
MSERM    EQU   BASES01+22
MSPASS   EQU   BASES01+14
MSVRB    EQU   BASES01+6
MSQHR    EQU   MSFHF
@NM00058 EQU   MSFHF
MSPSDT   EQU   MSFHF
MSREPLYB EQU   MSFHF
MSFAX    EQU   MSFHF
MSTTT    EQU   MSFHF
MSCSD    EQU   MSFHF
MSNMF    EQU   MSFHF
MSJNF    EQU   MSSSA
MSYOUT   EQU   MSNWP
MSNRP    EQU   MSSSA
MSSRDR   EQU   MSREOF
MSWRLOG  EQU   MSSSA
MSNUPSW  EQU   MSSSA
MSWRPEN  EQU   MSSSA
MSSSSIPL EQU   MSINLSW
MSSUM    EQU   MSECBFL
MSMCR    EQU   MSECBFL
MSYSOUT  EQU   MSECBFL
MSYSIN   EQU   MSECBFL
MSATTN   EQU   MSECBFL
MSWTL    EQU   MSECBFL
MSWTO    EQU   MSECBFL
MSEXT    EQU   MSECBFL
MSCCS    EQU   MSPFG
MSBSP    EQU   MSPFG
MSSYT    EQU   MSPFG
MSSYN    EQU   MSPFG
MSICR    EQU   MSPFG
MSCMC    EQU   MSPFG
MSPNB    EQU   MSPFG
MSDATE   EQU   MSPFG
@NM00057 EQU   MSBTN
MSTN     EQU   MSBTN
@NM00056 EQU   MSBTN
@NM00055 EQU   MSBTN
MSSO     EQU   MSBTN
MSROLFLG EQU   MSBTN
MSCANFLG EQU   MSBTN
MSCONFLG EQU   MSBTN
MSPNIP   EQU   MSNTAL
MSQNIP   EQU   MSNTAL
MSCURE34 EQU   MSNTAL
@NM00054 EQU   MSNTAL
@NM00053 EQU   MSNTAL
@NM00052 EQU   MSNTAL
@NM00051 EQU   MSNTAL
MSNIP    EQU   MSNTAL
@NM00050 EQU   MS1BASEX+40
@NM00049 EQU   MS1BASEX+20
@NM00048 EQU   MS1BASEX
@NM00047 EQU   BASE+128
MSLGJSCB EQU   BASE+124
@NM00046 EQU   MSSTRTSW
MSSTRTP  EQU   MSSTRTSW
MSSTRTW  EQU   MSSTRTSW
@NM00045 EQU   MSWTRSW
MSWTRP   EQU   MSWTRSW
MSWTRW   EQU   MSWTRSW
@NM00044 EQU   MSWLOGSW
MSWLOGP  EQU   MSWLOGSW
MSWLOGW  EQU   MSWLOGSW
@NM00043 EQU   MSCLOSSW
MSCLOSP  EQU   MSCLOSSW
MSCLOSW  EQU   MSCLOSSW
MSLOGLMT EQU   @NM00042+1
MSLOGCLS EQU   @NM00042
BAASCB   EQU   BASE+100
MSSMFPRM EQU   BASE+96
MSCOMMND EQU   BASE+92
BASP12   EQU   BASE+90
BASTCNT  EQU   BASE+88
BASESCT  EQU   BASE+86
BAJNCNT  EQU   BASE+84
BASUBECB EQU   BASE+80
BALOGCOM EQU   BASE+76
BADACNT  EQU   BASE+74
BATACNT  EQU   BASE+72
BAJBNR   EQU   BASE+64
BASP11   EQU   BASE+62
BALCCNT  EQU   BASE+61
BADUMPID EQU   BASE+60
BABCMAX  EQU   BASE+58
BAMONTR2 EQU   BASE+57
@NM00041 EQU   BAMONITR
BAMACTVE EQU   BAMONITR
@NM00040 EQU   BAMONITR
@NM00039 EQU   BAMONITR
@NM00038 EQU   BAMONITR
@NM00037 EQU   BAMONITR
BASPACE  EQU   BAMONITR
BADSN    EQU   BAMONITR
BADSO    EQU   BASE+52
BALOGECB EQU   BASE+48
@NM00036 EQU   BASPBYTE
@NM00035 EQU   BASPBYTE
@NM00034 EQU   BASPBYTE
@NM00033 EQU   BASPBYTE
@NM00032 EQU   BASPBYTE
BAMASCH  EQU   BASPBYTE
BATRACE  EQU   BASPBYTE
BAMSSTAR EQU   BASPBYTE
@NM00031 EQU   MSLOGST
@NM00030 EQU   MSLOGST
MSLOGSTA EQU   MSLOGST
MSLOGIPL EQU   MSLOGST
MSLOGDAR EQU   MSLOGST
MSLOGCOM EQU   MSLOGST
MSLOGTHD EQU   MSLOGST
MSLOGENQ EQU   MSLOGST
BAMIPAR2 EQU   BASE+44
BAMINPAR EQU   BASE+42
BAPKES   EQU   BASE+40
BAICTR   EQU   BASE+38
@NM00029 EQU   BASE+37
BADSET   EQU   BARSW
BANOSET  EQU   BARSW
BAMIDNT  EQU   BARSW
BAHR     EQU   BARSW
BAVU     EQU   BARSW
BAINTSET EQU   BARSW
MSTODWTO EQU   BARSW
BAIN     EQU   BARSW
BACV     EQU   BASE+32
@NM00028 EQU   BALOG
@NM00027 EQU   BALOG
@NM00026 EQU   BALOG
@NM00025 EQU   BALOG
@NM00024 EQU   BALOG
@NM00023 EQU   BALOG
@NM00022 EQU   BALOG
MSLOGSVC EQU   BALGSTAT
BAPRC    EQU   BASE+20
BAQ      EQU   BASE+16
BAIPLCC  EQU   @NM00020+2
@NM00021 EQU   @NM00020
BAIPL    EQU   BASE+12
BALAD    EQU   BASE+8
BATRM    EQU   BASE+4
BACHN    EQU   BASE
@NM00019 EQU   FRRSFLGS+1
@NM00018 EQU   FRRSFLG1
FRRSNEST EQU   FRRSFLG1
FRRSRCUR EQU   FRRSFLG1
FRRSENTS EQU   FRRS+84
FRRSRTMW EQU   FRRS+16
UCMPRSV2 EQU   UCMPEXTA+20
UCMPRSV1 EQU   UCMPDM1+8
UCMPNMCC EQU   UCMPDM1+4
UCMPWQE  EQU   UCMPDM1
UCMPUCMP EQU   UCMPEXTA
UCMFRSV3 EQU   UCMFEXTA+20
UCMF80WQ EQU   UCMFEXTA+18
UCMF60WQ EQU   UCMFEXTA+16
UCMFRSV2 EQU   UCMFMGFS+4
UCMFRSV1 EQU   UCMFMGFS+2
UCMFFLG2 EQU   UCMFMGFS+1
UCMFBR07 EQU   UCMFFLG1
UCMFBR06 EQU   UCMFFLG1
UCMFBR05 EQU   UCMFFLG1
UCMFBR04 EQU   UCMFFLG1
UCMFBR03 EQU   UCMFFLG1
UCMFMSGA EQU   UCMFFLG1
UCMFMSGE EQU   UCMFFLG1
UCMFUCMF EQU   UCMFEXTA
UCMRCTA  EQU   UCMRCT+1
UCMRSV31 EQU   UCMSDS5
UCMSDS5G EQU   UCMSDS5
UCMSDS5F EQU   UCMSDS5
UCMRSV30 EQU   UCMSDS5
UCMRSV29 EQU   UCMSDS5
UCMSDS5C EQU   UCMSDS5
UCMSDS5B EQU   UCMSDS5
UCMSDS5A EQU   UCMSDS5
UCMMLAST EQU   UCMLIST+64
UCMVHRSN EQU   UCMDEVC
UCMDEVG  EQU   UCMDEVC
UCMDEVF  EQU   UCMDEVC
UCMDEVE  EQU   UCMDEVC
UCMDEVD  EQU   UCMDEVC
UCMDEVCC EQU   UCMDEVC
UCMDEVB  EQU   UCMDEVC
UCMDEVA  EQU   UCMDEVC
UCMXOR   EQU   UCMLIST+62
UCMMSG2  EQU   UCMMSG+1
UCMRSV27 EQU   UCMMSG1
UCMRSV26 EQU   UCMMSG1
UCMMSGF  EQU   UCMMSG1
UCMMSGE  EQU   UCMMSG1
UCMMSGD  EQU   UCMMSG1
UCMMSGC  EQU   UCMMSG1
UCMMSGB  EQU   UCMMSG1
UCMMSGA  EQU   UCMMSG1
UCMCOMPC EQU   UCMLIST+56
UCMWLAST EQU   UCMLIST+52
UCMOAOEN EQU   UCMLIST+48
UCMALTEN EQU   UCMLIST+44
UCMRV007 EQU   UCMDISP2
UCMRV006 EQU   UCMDISP2
UCMRV005 EQU   UCMDISP2
UCMRV004 EQU   UCMDISP2
UCMRV003 EQU   UCMDISP2
UCMDISPK EQU   UCMDISP2
UCMDISPJ EQU   UCMDISP2
UCMDISPI EQU   UCMDISP2
UCMDISPH EQU   UCMDISP1
UCMDISPG EQU   UCMDISP1
UCMDISPF EQU   UCMDISP1
UCMDISPE EQU   UCMDISP1
UCMDISPD EQU   UCMDISP1
UCMDISPC EQU   UCMDISP1
UCMDISPB EQU   UCMDISP1
UCMDISPA EQU   UCMDISP1
UCMAUTHB EQU   UCMAUTH+1
UCMRSV23 EQU   UCMAUTHA
UCMRSV22 EQU   UCMAUTHA
UCMRSV21 EQU   UCMAUTHA
UCMRSV20 EQU   UCMAUTHA
UCMRSV19 EQU   UCMAUTHA
UCMAUTH3 EQU   UCMAUTHA
UCMAUTH2 EQU   UCMAUTHA
UCMAUTH1 EQU   UCMAUTHA
UCMOUTQ  EQU   UCMLIST+36
UCMRSV18 EQU   UCMLIST+34
UCMRTCD  EQU   UCMLIST+32
UCMXB    EQU   UCMLIST+28
@NM00017 EQU   UCMXA+1
UCMID    EQU   UCMXA
UCMRSV17 EQU   UCMATR
UCMRSV16 EQU   UCMATR
UCMAT04  EQU   UCMATR
UCMLF    EQU   UCMATR
UCMUF    EQU   UCMATR
UCMXF    EQU   UCMATR
UCMIF    EQU   UCMATR
UCMOF    EQU   UCMATR
UCMTC    EQU   UCMSTS
UCMTD    EQU   UCMSTS
UCMTB    EQU   UCMSTS
UCMTA    EQU   UCMSTS
UCMCF    EQU   UCMSTS
UCMBF    EQU   UCMSTS
UCMPF    EQU   UCMSTS
UCMAF    EQU   UCMSTS
UCMNAME  EQU   UCMLIST+16
UCMUCB   EQU   UCMLIST+12
UCMDCB   EQU   UCMLIST+8
UCMSBR   EQU   UCMLIST+4
UCMECB   EQU   UCMLIST
UCMTPSAV EQU   UCMEXIT+208
UCMXTSAV EQU   UCMEXIT+136
UCMDESCD EQU   UCMEXIT+132
UCMROUTC EQU   UCMEXIT+128
UCMMSTXT EQU   UCMEXIT
UCMDECBA EQU   UCMEIL+20
UCMOECBA EQU   UCMEIL+16
UCMAECBA EQU   UCMEIL+12
UCMXECBA EQU   UCMEIL+8
UCMNIPTR EQU   UCMEIL+4
UCMRSV15 EQU   UCMEIL+3
UCMRTCT  EQU   UCMEIL+2
@NM00016 EQU   UCMEIL
UCMRSV60 EQU   UCM+302
UCMRSV59 EQU   UCMRSV51
UCMRSV58 EQU   UCMRSV51
UCMRSV57 EQU   UCMRSV51
UCMRSV56 EQU   UCMRSV51
UCMRSV55 EQU   UCMRSV51
UCMRSV54 EQU   UCMRSV51
UCMRSV53 EQU   UCMRSV51
UCMRSV52 EQU   UCMRSV51
UCMRSV50 EQU   UCMRSV42
UCMRSV49 EQU   UCMRSV42
UCMRSV48 EQU   UCMRSV42
UCMRSV47 EQU   UCMRSV42
UCMRSV46 EQU   UCMRSV42
UCMRSV45 EQU   UCMRSV42
UCMRSV44 EQU   UCMRSV42
UCMRSV43 EQU   UCMRSV42
UCMSWCH  EQU   UCM+284
UCMOECBH EQU   UCM+264
UCMWECBH EQU   UCM+256
UCMMBEND EQU   UCM+252
UCMRSV61 EQU   UCM+248
UCMRP2AD EQU   UCM+244
UCMCRAAD EQU   UCM+240
UCMRV001 EQU   UCM+237
UCMMBPTR EQU   UCM+232
UCMMQNXT EQU   UCM+228
UCMMQEND EQU   UCM+224
UCMMQPTR EQU   UCM+220
UCMTRECB EQU   UCM+216
UCMMNECB EQU   UCM+212
UCMMNTR  EQU   UCM+208
UCMR9SV  EQU   UCM+204
UCMSAVE4 EQU   UCM+140
UCMSAVE3 EQU   UCM+84
UCMVEL   EQU   UCMVDATA+8
UCMVEZ   EQU   UCMVDATA+4
UCMINCR  EQU   UCM+71
UCMMODEL EQU   UCM+70
UCMCORE  EQU   UCM+69
UCMFIX   EQU   UCMMODE
UCMMCS   EQU   UCMMODE
UCMOGCE  EQU   UCMMODE
UCMAMFA  EQU   UCMMODE
UCMRSV14 EQU   UCMMODE
UCMTPUTA EQU   UCMMODE
UCMNOCON EQU   UCMMODE
UCMRSV11 EQU   UCMMODE
UCMWQECB EQU   UCM+52
UCMRQECB EQU   UCM+48
@NM00015 EQU   UCMRPYI
UCMARECB EQU   UCM+16
UCMLECB  EQU   UCMDECB
UCMXECB  EQU   UCM
UCMGMCNT EQU   UCMPRFX+158
UCMSDS2  EQU   UCMPRFX+157
UCMRSV09 EQU   UCMSDS1
UCMRSV08 EQU   UCMSDS1
UCMRSV07 EQU   UCMSDS1
UCMRSV06 EQU   UCMSDS1
UCMRSV05 EQU   UCMSDS1
UCMRSV04 EQU   UCMSDS1
UCMSDS1B EQU   UCMSDS1
UCMSDS1A EQU   UCMSDS1
UCMDTINT EQU   UCMPRFX+152
UCMLOGAD EQU   UCMPRFX+148
UCMNPECB EQU   UCMPRFX+144
UCMTPPTR EQU   UCMPRFX+140
UCMDOMRT EQU   UCMPRFX+136
UCMRUTCK EQU   UCMPRFX+132
UCMQRTN  EQU   UCMPRFX+128
UCM6WD   EQU   UCMXSA+20
UCM5WD   EQU   UCMXSA+16
UCM4WD   EQU   UCMXSA+12
UCM3WD   EQU   UCMXSA+8
UCM2WD   EQU   UCMXSA+4
UCM1WD   EQU   UCMXSA
UCMRSV03 EQU   UCMPRFX+102
UCMHRDRT EQU   UCMPRFX+100
UCMUEXIT EQU   UCMPRFX+97
UCMXCT   EQU   UCMPRFX+96
UCMHCUCM EQU   UCMPRFX+92
UCMRSV02 EQU   UCMSFLG2
UCMSYSN  EQU   UCMSFLG2
UCMSYSM  EQU   UCMSFLG2
UCMSYSL  EQU   UCMSFLG2
UCMSYSK  EQU   UCMSFLG2
UCMSYSJ  EQU   UCMSFLG2
UCMRSV35 EQU   UCMSFLG1
UCMSYSF  EQU   UCMSFLG1
UCMSYSE  EQU   UCMSFLG1
UCMSYSD  EQU   UCMSFLG1
UCMSYSC  EQU   UCMSFLG1
UCMSYSB  EQU   UCMSFLG1
UCMRSV01 EQU   UCMSFLG1
UCMWTOX  EQU   UCMPRFX+80
UCMDOME  EQU   UCMPRFX+76
UCMSVR0  EQU   UCMSAVE0+68
UCMSVQ0  EQU   UCMSAVE0+64
UCMSVP0  EQU   UCMSAVE0+60
UCMSVO0  EQU   UCMSAVE0+56
UCMSVN0  EQU   UCMSAVE0+52
UCMSVM0  EQU   UCMSAVE0+48
UCMSVL0  EQU   UCMSAVE0+44
UCMSVK0  EQU   UCMSAVE0+40
UCMSVJ0  EQU   UCMSAVE0+36
UCMSVI0  EQU   UCMSAVE0+32
UCMSVH0  EQU   UCMSAVE0+28
UCMSVG0  EQU   UCMSAVE0+24
UCMSVF0  EQU   UCMSAVE0+20
UCMSVE0  EQU   UCMSAVE0+16
UCMSVD0  EQU   UCMSAVE0+12
UCMSVC0  EQU   UCMSAVE0+8
UCMSVB0  EQU   UCMSAVE0+4
UCMSVA0  EQU   UCMSAVE0
UCMMCENT EQU   UCMPRFX
UCM2STAA EQU   UCM2STA+1
UCMRV008 EQU   UCM2SFLG
UCMRSV34 EQU   UCM2SFLG
UCMRSV33 EQU   UCM2SFLG
UCM2WTOI EQU   UCM2SFLG
UCM2DSTR EQU   UCM2SFLG
UCM2DTAK EQU   UCM2SFLG
UCM2SENT EQU   UCM2SFLG
UCM2SDWA EQU   UCM2SFLG
UCM2PST  EQU   UCM2EXT+4
UCM2RID  EQU   UCM2EXT+2
UCM2WID  EQU   UCM2EXT
WPLMLTXT EQU   WPLML+4
WPLMLLT2 EQU   WPLMLLTF+1
WPLRSV24 EQU   WPLMLLT1
WPLRSV23 EQU   WPLMLLT1
WPLRSV22 EQU   WPLMLLT1
WPLRSV21 EQU   WPLMLLT1
WPLMLLTD EQU   WPLMLLT1
WPLMLLTC EQU   WPLMLLT1
WPLMLLTB EQU   WPLMLLT1
WPLMLLTA EQU   WPLMLLT1
WPLML0   EQU   WPLML
WPLLTF2  EQU   WPLLTF+1
WPLRSV20 EQU   WPLLTF1
WPLRSV19 EQU   WPLLTF1
WPLRSV18 EQU   WPLLTF1
WPLRSV17 EQU   WPLLTF1
WPLLTFD  EQU   WPLLTF1
WPLLTFC  EQU   WPLLTF1
WPLLTFB  EQU   WPLLTF1
WPLLTFA  EQU   WPLLTF1
WPLRSV32 EQU   WPLMSGT2
WPLRSV31 EQU   WPLMSGT2
WPLRSV30 EQU   WPLMSGT2
WPLRSV29 EQU   WPLMSGT2
WPLRSV28 EQU   WPLMSGT2
WPLRSV27 EQU   WPLMSGT2
WPLRSV26 EQU   WPLMSGT2
WPLRSV25 EQU   WPLMSGT2
WPLRSV16 EQU   WPLMSGT1
WPLRSV15 EQU   WPLMSGT1
WPLMSGTF EQU   WPLMSGT1
WPLRSV14 EQU   WPLMSGT1
WPLMSGTC EQU   WPLMSGT1
WPLMSGTB EQU   WPLMSGT1
WPLMSGTA EQU   WPLMSGT1
WPLRSV13 EQU   WPLROUT2
WPLROUTO EQU   WPLROUT2
WPLROUTN EQU   WPLROUT2
WPLROUTM EQU   WPLROUT2
WPLROUTL EQU   WPLROUT2
WPLROUTJ EQU   WPLROUT2
WPLROUTI EQU   WPLROUT2
WPLROUTH EQU   WPLROUT1
WPLROUTG EQU   WPLROUT1
WPLROUTF EQU   WPLROUT1
WPLROUTE EQU   WPLROUT1
WPLROUTD EQU   WPLROUT1
WPLROUTC EQU   WPLROUT1
WPLROUTB EQU   WPLROUT1
WPLROUTA EQU   WPLROUT1
WPLRSV12 EQU   WPLDESC2
WPLRSV11 EQU   WPLDESC2
WPLRSV10 EQU   WPLDESC2
WPLRSV09 EQU   WPLDESC2
WPLRSV08 EQU   WPLDESC2
WPLRSV07 EQU   WPLDESC2
WPLDESCJ EQU   WPLDESC2
WPLDESCI EQU   WPLDESC2
WPLDESCH EQU   WPLDESC1
WPLDESCF EQU   WPLDESC1
WPLDESCE EQU   WPLDESC1
WPLDESCD EQU   WPLDESC1
WPLDESCC EQU   WPLDESC1
WPLTXTL  EQU   WPLTXT+125
@NM00014 EQU   WPLTXT
WPLRSV05 EQU   WPLMCSF2
WPLRSV04 EQU   WPLMCSF2
WPLMCSFN EQU   WPLMCSF2
WPLRSV03 EQU   WPLMCSF2
WPLNOWTP EQU   WPLMCSF2
WPLMCSFK EQU   WPLMCSF2
WPLMCSFH EQU   WPLMCSF1
WPLMCSFG EQU   WPLMCSF1
WPLMCSFF EQU   WPLMCSF1
WPLMCSFE EQU   WPLMCSF1
WPLMCSFC EQU   WPLMCSF1
WPLMCSFB EQU   WPLMCSF1
WPLRPTRA EQU   WPLRPTR+1
WQERSVC7 EQU   WMNM+184
WQERSVC6 EQU   WMNM+181
WQERSVC5 EQU   WMNMST2
WQERSVC4 EQU   WMNMST2
WQERSVC3 EQU   WMNMST2
WQERSVC2 EQU   WMNMST2
WQERSVC1 EQU   WMNMST2
WQERSVB9 EQU   WMNMST2
WQERSVB8 EQU   WMNMST2
WMNMTPD2 EQU   WMNMST2
WMNMTXT2 EQU   WMNM+108
WMNMHCT2 EQU   WMNM+104
WMNMTL2  EQU   WMNM+103
WQERSV74 EQU   WMNM+102
WQERSV73 EQU   WMNMLT2
WQERSV72 EQU   WMNMLT2
WQERSV71 EQU   WMNMLT2
WQERSV70 EQU   WMNMLT2
WMNMLT2D EQU   WMNMLT2
WMNMLT2C EQU   WMNMLT2
WMNMLT2B EQU   WMNMLT2
WMNMLT2A EQU   WMNMLT2
WMNMML2H EQU   WMNMML2
WMNMML2G EQU   WMNMML2
WQERSV69 EQU   WMNMML2
WMNMML2E EQU   WMNMML2
WMNMML2D EQU   WMNMML2
WMNMML2C EQU   WMNMML2
WMNMML2B EQU   WMNMML2
WQERSV68 EQU   WMNMML2
WMNMNX2  EQU   WMNM+97
WMNMUC2  EQU   WMNM+96
WQERSVB7 EQU   WMNM+88
WQERSVB6 EQU   WMNM+85
WQERSVB5 EQU   WMNMST1
WQERSVB4 EQU   WMNMST1
WQERSVB3 EQU   WMNMST1
WQERSVB2 EQU   WMNMST1
WQERSVB1 EQU   WMNMST1
WQERSVA9 EQU   WMNMST1
WQERSVA8 EQU   WMNMST1
WMNMTPD1 EQU   WMNMST1
WMNMTXT1 EQU   WMNM+12
WMNMHCT1 EQU   WMNM+8
WMNMTL1  EQU   WMNM+7
WQERSV67 EQU   WMNM+6
WQERSV66 EQU   WMNMLT1
WQERSV65 EQU   WMNMLT1
WQERSV64 EQU   WMNMLT1
WQERSV63 EQU   WMNMLT1
WMNMLT1D EQU   WMNMLT1
WMNMLT1C EQU   WMNMLT1
WMNMLT1B EQU   WMNMLT1
WMNMLT1A EQU   WMNMLT1
WMNMML1H EQU   WMNMML1
WMNMML1G EQU   WMNMML1
WMNMML1F EQU   WMNMML1
WMNMML1E EQU   WMNMML1
WMNMML1D EQU   WMNMML1
WMNMML1C EQU   WMNMML1
WMNMML1B EQU   WMNMML1
WQERSV62 EQU   WMNMML1
WMNMNX1  EQU   WMNMEXT+1
WMNMUC1  EQU   WMNMEXT
WMJMJTCB EQU   WMJM+188
WMJMDEC4 EQU   WMJMDEC+3
WMJMDEC3 EQU   WMJMDEC+2
WQERSV61 EQU   WMJMDEC2
WQERSV60 EQU   WMJMDEC2
WQERSV59 EQU   WMJMDEC2
WQERSV58 EQU   WMJMDEC2
WQERSV57 EQU   WMJMDEC2
WQERSV56 EQU   WMJMDEC2
WMJMDECJ EQU   WMJMDEC2
WMJMDECI EQU   WMJMDEC2
WMJMDECH EQU   WMJMDEC1
WMJMDECG EQU   WMJMDEC1
WMJMDECF EQU   WMJMDEC1
WMJMDECE EQU   WMJMDEC1
WMJMDECD EQU   WMJMDEC1
WMJMDECC EQU   WMJMDEC1
WMJMDECB EQU   WMJMDEC1
WMJMDECA EQU   WMJMDEC1
WQERSV54 EQU   WMJM+181
WMJMUID  EQU   WMJM+180
WMJMRCT4 EQU   WMJMRTC+3
WMJMRCT3 EQU   WMJMRTC+2
WQERSV53 EQU   WMJMRCT2
WMJMRCTO EQU   WMJMRCT2
WMJMRCTN EQU   WMJMRCT2
WMJMRCTM EQU   WMJMRCT2
WMJMRCTL EQU   WMJMRCT2
WMJMRCTK EQU   WMJMRCT2
WMJMRCTJ EQU   WMJMRCT2
WMJMRCTI EQU   WMJMRCT2
WMJMRCTH EQU   WMJMRCT1
WMJMRCTG EQU   WMJMRCT1
WMJMRCTF EQU   WMJMRCT1
WMJMRCTE EQU   WMJMRCT1
WMJMRCTD EQU   WMJMRCT1
WMJMRCTC EQU   WMJMRCT1
WMJMRCTB EQU   WMJMRCT1
WMJMRCTA EQU   WMJMRCT1
WMJMMT2  EQU   WMJMMT+1
WQERSV52 EQU   WMJMMT1
WQERSV51 EQU   WMJMMT1
WMJMMT1F EQU   WMJMMT1
WQERSV50 EQU   WMJMMT1
WMJMMT1D EQU   WMJMMT1
WQERSVA6 EQU   WMJMMT1
WMJMMT1B EQU   WMJMMT1
WMJMMT1A EQU   WMJMMT1
WQERSV11 EQU   WMJMCS2
WQERSV49 EQU   WMJMCS2
WMJMCS2F EQU   WMJMCS2
WQERSV48 EQU   WMJMCS2
WQERSV47 EQU   WMJMCS2
WMJMCS2C EQU   WMJMCS2
WMJMCS2B EQU   WMJMCS2
WMJMCS2A EQU   WMJMCS2
WMJMCS1H EQU   WMJMCS1
WMJMCS1G EQU   WMJMCS1
WMJMCS1F EQU   WMJMCS1
WMJMCS1E EQU   WMJMCS1
WMJMCS1D EQU   WMJMCS1
WMJMCS1C EQU   WMJMCS1
WMJMCS1B EQU   WMJMCS1
WMJMCS1A EQU   WMJMCS1
WMJMSEQ  EQU   WMJM+169
WMJMRTCT EQU   WMJM+168
WMJMTCB  EQU   WMJM+164
WQERSV45 EQU   WMJMBUF
WMJMBUFG EQU   WMJMBUF
WMJMBUFF EQU   WMJMBUF
WMJMBUFE EQU   WMJMBUF
WMJMBUFD EQU   WMJMBUF
WMJMBUFC EQU   WMJMBUF
WMJMBUFB EQU   WMJMBUF
WMJMBUFA EQU   WMJMBUF
WMJMASID EQU   WMJM+161
WMJMDSPH EQU   WMJMDSP
WMJMDSPG EQU   WMJMDSP
WMJMDSPF EQU   WMJMDSP
WMJMDSPE EQU   WMJMDSP
WMJMDSPD EQU   WMJMDSP
WMJMDSPC EQU   WMJMDSP
WMJMDSPB EQU   WMJMDSP
WMJMDSPA EQU   WMJMDSP
WQERSVA5 EQU   WMJM+156
WQERSVA4 EQU   WMJM+152
WQERSVD8 EQU   WMJM+149
WQERSVD7 EQU   WMJMECBF
WQERSVD6 EQU   WMJMECBF
WQERSVD5 EQU   WMJMECBF
WQERSVD4 EQU   WMJMECBF
WQERSVD3 EQU   WMJMECBF
WQERSVD2 EQU   WMJMECBF
WMJMMAJD EQU   WMJMECBF
WMJMWAIT EQU   WMJMECBF
WMJMMSGN EQU   WMJM+144
WMJMAECB EQU   WMJM+140
WMJMMIN  EQU   WMJM+136
WMJMLTY2 EQU   WMJMLTYP+1
WQERSV38 EQU   WMJMLTY1
WQERSV37 EQU   WMJMLTY1
WQERSV36 EQU   WMJMLTY1
WQERSV35 EQU   WMJMLTY1
WMJMLTYD EQU   WMJMLTY1
WMJMLTYC EQU   WMJMLTY1
WMJMLTYB EQU   WMJMLTY1
WMJMLTYA EQU   WMJMLTY1
WQERSV34 EQU   WMJM+132
WMJMCONS EQU   WMJM+124
WMJMSER2 EQU   WMJMSER+1
WQERSV33 EQU   WMJMSER1
WQERSV32 EQU   WMJMSER1
WQERSV31 EQU   WMJMSER1
WMJMSERE EQU   WMJMSER1
WMJMSERD EQU   WMJMSER1
WMJMSERC EQU   WMJMSER1
WMJMSERB EQU   WMJMSER1
WMJMSERA EQU   WMJMSER1
WQERSV30 EQU   WMJM+120
WQERSV29 EQU   WMJM+116
WMJMRESA EQU   WMJM+108
WNJNPAD3 EQU   WMJM+107
WMJMHCID EQU   WMJM+103
WMJMTXT  EQU   WMJM+31
WMJMPAD2 EQU   WMJM+30
WMJMJBNM EQU   WMJM+22
WMJMPAD1 EQU   WMJM+21
WMJMTSSS EQU   WMJMTS+6
WMJMTSP2 EQU   WMJMTS+5
WMJMTSMM EQU   WMJMTS+3
WMJMTSP1 EQU   WMJMTS+2
WMJMTSHH EQU   WMJMTS
WMJMPAD  EQU   WMJM+12
WMJMRR   EQU   WMJM+8
WMJMTXTL EQU   WMJM+6
WMJMAREA EQU   WMJM+5
WMJMMLWH EQU   WMJMMLW
WMJMMLWG EQU   WMJMMLW
WMJMMLWF EQU   WMJMMLW
WMJMMLWE EQU   WMJMMLW
WMJMMLWD EQU   WMJMMLW
WMJMMLWC EQU   WMJMMLW
WMJMMLWB EQU   WMJMMLW
WMJMMLWA EQU   WMJMMLW
WMJMNXT  EQU   WMJMEXTA
WMJMUC   EQU   WMJMEXT
WQERSV26 EQU   WQE+186
WQERSV25 EQU   WQEDC2
WQERSV24 EQU   WQEDC2
WQERSV23 EQU   WQEDC2
WQERSV22 EQU   WQEDC2
WQERSV21 EQU   WQEDC2
WQERSV20 EQU   WQEDC2
WQEDCJ   EQU   WQEDC2
WQEDCI   EQU   WQEDC2
WQEDCH   EQU   WQEDC1
WQEDCG   EQU   WQEDC1
WQEDCF   EQU   WQEDC1
WQEDCE   EQU   WQEDC1
WQEDCD   EQU   WQEDC1
WQEDCC   EQU   WQEDC1
WQEDCB   EQU   WQEDC1
WQEDCA   EQU   WQEDC1
WQERSV18 EQU   WQE+181
WQERSV17 EQU   WQE+178
WQERSV16 EQU   WQEROUT2
WQEROUTO EQU   WQEROUT2
WQEROUTN EQU   WQEROUT2
WQEROUTM EQU   WQEROUT2
WQEROUTL EQU   WQEROUT2
WQEROUTK EQU   WQEROUT2
WQEROUTJ EQU   WQEROUT2
WQEROUTI EQU   WQEROUT2
WQEROUTH EQU   WQEROUT1
WQEROUTG EQU   WQEROUT1
WQEROUTF EQU   WQEROUT1
WQEROUTE EQU   WQEROUT1
WQEROUTD EQU   WQEROUT1
WQEROUTC EQU   WQEROUT1
WQEROUTB EQU   WQEROUT1
WQEROUTA EQU   WQEROUT1
WQERSV15 EQU   WQEMSGT1
WQERSV14 EQU   WQEMSGT1
WQEMSGTF EQU   WQEMSGT1
WQERSV13 EQU   WQEMSGT1
WQEMSGTD EQU   WQEMSGT1
WQEMSGTC EQU   WQEMSGT1
WQEMSGTB EQU   WQEMSGT1
WQEMSGTA EQU   WQEMSGT1
WQEMCSP  EQU   WQEMCSF2
WQEMCSO  EQU   WQEMCSF2
WQERSV10 EQU   WQEMCSF2
WQERSV09 EQU   WQEMCSF2
WQEMCSK  EQU   WQEMCSF2
WQEMCSJ  EQU   WQEMCSF2
WQEMCSI  EQU   WQEMCSF2
WQEMCSFF EQU   WQEMCSF1
WQEMCSE  EQU   WQEMCSF1
WQEMCSD  EQU   WQEMCSF1
WQEMCSC  EQU   WQEMCSF1
WQERTCT  EQU   WQE+168
WQERSV07 EQU   WQEAVAIL
WQERSV06 EQU   WQEAVAIL
WQEBUFF  EQU   WQEAVAIL
WQEBUFA  EQU   WQEAVAIL
WQEDOM   EQU   WQEXA
WQEQDFHC EQU   WQEXA
WQEPURGE EQU   WQEXA
WQEPAD3  EQU   WQE+159
WQETXTL  EQU   WQETXT+127
@NM00013 EQU   WQETXT
WQEUSE   EQU   WQELKP
OREOPBUF EQU   OREF+28
ORERSV11 EQU   OREF+26
OREM     EQU   OREF+24
OREECBA  EQU   OREECB+1
ORETJID2 EQU   OREECB
ORERPYA  EQU   ORERPY+1
ORELNTH  EQU   ORERPY
ORETCBA  EQU   ORETCB+1
ORETJID1 EQU   ORETCB
ORERSV10 EQU   OREXC
ORERSV09 EQU   OREXC
ORERSV08 EQU   OREXC
OREBUFE  EQU   OREXC
OREBUFC  EQU   OREXC
OREBUFA  EQU   OREXC
ORERSV06 EQU   OREXA
ORERSV05 EQU   OREXA
ORERSV04 EQU   OREXA
ORERSV03 EQU   OREXA
ORESWAP  EQU   OREXA
ORERSV01 EQU   OREXA
JESSASTA EQU   JESCT+48
JESNUCBS EQU   JESCT+44
JESPJESN EQU   JESCT+28
JESSSCT  EQU   JESCT+24
JESRESQM EQU   JESCT+16
JESQMGR  EQU   JESCT+12
JESUNITS EQU   JESCT+4
@NM00012 EQU   JESCT
PARMSYAD EQU   PARMLIST+4
PARMCTBK EQU   PARMSTAT+3
PARMSYSR EQU   PARMSTAT+2
@NM00002 EQU   PARMFLAG
@NM00001 EQU   PARMFLAG
PARMWARG EQU   PARMFLAG
PARMRECU EQU   PARMFLAG
PARMCWT  EQU   PARMFLAG
PARMSDWA EQU   PARMFLAG
WWBRESRV EQU   WWB+17
@NM00119 EQU   PSA+3668
PSASTAK  EQU   PSA+3072
@NM00118 EQU   PSA+1048
PSAUSEND EQU   PSA+1048
PSARV062 EQU   PSA+1044
PSACDAL  EQU   PSA+1040
PSAWTCOD EQU   PSA+1036
PSAATCVT EQU   PSA+1032
PSAPCPSW EQU   PSA+1024
PSAPIR2  EQU   PSA+1020
PSARV059 EQU   PSA+1018
PSASVC13 EQU   PSA+1016
PSASFACC EQU   PSA+1008
PSASTOP  EQU   PSA+992
PSASTART EQU   PSA+976
PSARSPSW EQU   PSA+968
PSASRPSW EQU   PSA+960
PSARV045 EQU   PSA+892
PSARV044 EQU   PSA+888
PSARV043 EQU   PSA+884
PSARV042 EQU   PSA+880
PSARV041 EQU   PSA+876
PSARV040 EQU   PSA+872
PSARV025 EQU   PSA+868
PSADSSED EQU   PSA+868
PSADSSPR EQU   PSA+864
PSADSSFW EQU   PSA+860
PSADSS14 EQU   PSA+856
PSADSSPP EQU   PSA+848
PSADSSRP EQU   PSA+840
PSADSS05 EQU   PSADSSF4
PSADSS10 EQU   PSADSSF4
PSADSSVE EQU   PSADSSF4
PSADSSDE EQU   PSADSSF4
PSADSSC0 EQU   PSADSSF4
PSADSSIE EQU   PSADSSF4
PSADSS12 EQU   PSADSSF4
PSADSSRC EQU   PSADSSF4
PSARV057 EQU   PSADSSF3
PSARV056 EQU   PSADSSF3
PSARV055 EQU   PSADSSF3
PSADSSMC EQU   PSADSSF3
PSADSSRW EQU   PSADSSF3
PSADSSNM EQU   PSADSSF3
PSADSSES EQU   PSADSSF3
PSADSSGP EQU   PSADSSF3
PSADSSF2 EQU   PSADSSFL+1
PSADSSPI EQU   PSADSSF1
PSADSSOI EQU   PSADSSF1
PSADSSSP EQU   PSADSSF1
PSADSSTP EQU   PSADSSF1
PSADSSDW EQU   PSADSSF1
PSADSSDD EQU   PSADSSF1
PSADSSDM EQU   PSADSSF1
PSADSSMV EQU   PSADSSF1
PSADSSTS EQU   PSA+816
PSADSSWK EQU   PSA+812
PSADSSR3 EQU   PSA+808
PSADSSR2 EQU   PSA+804
PSADSSRS EQU   PSA+800
PSASTOR  EQU   PSA+796
PSACPUSA EQU   PSA+794
PSAVSTAP EQU   PSA+792
PSAWKVAP EQU   PSA+788
PSAWKRAP EQU   PSA+784
PSAMCHIC EQU   PSA+783
PSARV061 EQU   PSA+782
PSASYMSK EQU   PSA+781
PSAMCHFL EQU   PSA+780
PSACR0   EQU   PSA+776
PSAPSWSV EQU   PSA+768
PSACLHS  EQU   PSAHLHI
PSALKR15 EQU   PSALKSA+60
PSALKR14 EQU   PSALKSA+56
PSALKR13 EQU   PSALKSA+52
PSALKR12 EQU   PSALKSA+48
PSALKR11 EQU   PSALKSA+44
PSALKR10 EQU   PSALKSA+40
PSALKR9  EQU   PSALKSA+36
PSALKR8  EQU   PSALKSA+32
PSALKR7  EQU   PSALKSA+28
PSALKR6  EQU   PSALKSA+24
PSALKR5  EQU   PSALKSA+20
PSALKR4  EQU   PSALKSA+16
PSALKR3  EQU   PSALKSA+12
PSALKR2  EQU   PSALKSA+8
PSALKR1  EQU   PSALKSA+4
PSALKR0  EQU   PSALKSA
PSARV023 EQU   PSACLHT+52
PSALOCAL EQU   PSACLHT+48
PSACMSL  EQU   PSACLHT+44
PSAOPTL  EQU   PSACLHT+40
PSATPACL EQU   PSACLHT+36
PSATPDNL EQU   PSACLHT+32
PSATPNCL EQU   PSACLHT+28
PSAIOSLL EQU   PSACLHT+24
PSAIOSUL EQU   PSACLHT+20
PSAIOSCL EQU   PSACLHT+16
PSAIOSSL EQU   PSACLHT+12
PSASALCL EQU   PSACLHT+8
PSAASML  EQU   PSACLHT+4
PSADISPL EQU   PSACLHT
PSASRSA  EQU   PSA+636
PSARV050 EQU   PSA+634
PSADSSGO EQU   PSA+633
PSARECUR EQU   PSA+632
PSAHLHIS EQU   PSA+628
PSAIPCSA EQU   PSA+624
@NM00117 EQU   PSA+621
PSAIPCDM EQU   PSA+620
PSAIPCD  EQU   PSA+616
@NM00116 EQU   PSA+613
PSAIPCRM EQU   PSA+612
PSAIPCR  EQU   PSA+608
PSAMCHEX EQU   PSA+600
PSAMPSW  EQU   PSA+592
PSAEXPS2 EQU   PSA+584
PSAEXPS1 EQU   PSA+576
PSAPIREG EQU   PSA+572
PSARSREG EQU   PSA+568
PSAGPREG EQU   PSA+556
PSARV022 EQU   PSASUP4
PSARV021 EQU   PSASUP4
PSARV020 EQU   PSASUP4
PSARV019 EQU   PSASUP4
PSARV018 EQU   PSASUP4
PSARV017 EQU   PSASUP4
PSARV016 EQU   PSASUP4
PSARV015 EQU   PSASUP4
PSARV014 EQU   PSASUP3
PSAULCMS EQU   PSASUP3
PSARV012 EQU   PSASUP3
PSAESTA  EQU   PSASUP3
PSASPR   EQU   PSASUP3
PSAPSREG EQU   PSASUP3
PSAPI2   EQU   PSASUP3
PSAIOSUP EQU   PSASUP3
PSALCR   EQU   PSASUP2
PSARTM   EQU   PSASUP2
PSAACR   EQU   PSASUP2
PSAIPCE2 EQU   PSASUP2
PSAIPCES EQU   PSASUP2
PSAIPCEC EQU   PSASUP2
PSAGTF   EQU   PSASUP2
PSAIPCRI EQU   PSASUP2
PSATYPE6 EQU   PSASUP1
PSATCTL  EQU   PSASUP1
PSADISP  EQU   PSASUP1
PSALOCK  EQU   PSASUP1
PSAPI    EQU   PSASUP1
PSAEXT   EQU   PSASUP1
PSASVC   EQU   PSASUP1
PSAIO    EQU   PSASUP1
PSAAOLD  EQU   PSA+548
PSAANEW  EQU   PSA+544
PSATOLD  EQU   PSA+540
PSATNEW  EQU   PSA+536
PSALCCAR EQU   PSA+532
PSALCCAV EQU   PSA+528
PSAPCCAR EQU   PSA+524
PSAPCCAV EQU   PSA+520
PSACPULA EQU   PSA+518
PSACPUPA EQU   PSA+516
PSAPSA   EQU   PSA+512
FLCHDEND EQU   PSA+512
FLCCRSAV EQU   FLCMCLA+280
FLCGRSAV EQU   FLCMCLA+216
FLCFPSAV EQU   FLCMCLA+184
FLCFLA   EQU   FLCMCLA+88
FLCRGNCD EQU   FLCMCLA+84
FLCFSAA  EQU   FLCFSA+1
@NM00115 EQU   FLCFSA
@NM00114 EQU   FLCMCLA+72
FLCMCIC  EQU   FLCMCLA+64
@NM00113 EQU   FLCMCLA+20
FLCIOAA  EQU   FLCIOA+1
@NM00112 EQU   FLCIOA
@NM00111 EQU   FLCMCLA+15
@NM00110 EQU   FLCMCLA+14
@NM00109 EQU   FLCMCLA+12
FLCLCL   EQU   FLCMCLA+8
FLCIOELA EQU   FLCIOEL+1
@NM00108 EQU   FLCIOEL
FLCCHNID EQU   FLCMCLA
@NM00107 EQU   PSA+160
FLCMTRCD EQU   PSA+157
@NM00106 EQU   PSA+156
FLCPERA  EQU   FLCPER+1
@NM00105 EQU   FLCPER
@NM00104 EQU   PSA+151
FLCPERCD EQU   PSA+150
FLCMCNUM EQU   PSA+149
@NM00103 EQU   PSA+148
FLCTEAA  EQU   FLCTEA+1
@NM00102 EQU   FLCTEA
PSAPIPC  EQU   PSAPICOD
PSAPIMC  EQU   PSAPICOD
PSAPIPER EQU   PSAPICOD
PSARV049 EQU   FLCPICOD
FLCPILCB EQU   FLCPIILC
@NM00101 EQU   FLCPIILC
@NM00100 EQU   PSAEPPSW
FLCSVCN  EQU   PSAESPSW+2
FLCSILCB EQU   FLCSVILC
@NM00099 EQU   FLCSVILC
@NM00098 EQU   PSAESPSW
FLCEICOD EQU   PSAEEPSW+2
PSASPAD  EQU   PSAEEPSW
@NM00097 EQU   PSA+128
FLCINPSW EQU   PSA+120
FLCMNPSW EQU   PSA+112
FLCPNPSW EQU   PSA+104
FLCSNPSW EQU   PSA+96
FLCENPSW EQU   PSA+88
FLCTRACE EQU   PSA+84
FLCTIMER EQU   PSA+80
FLCCVT2  EQU   PSA+76
FLCCAW   EQU   PSA+72
FLCCSW   EQU   PSA+64
FLCIOPSW EQU   PSA+56
FLCMOPSW EQU   PSA+48
FLCPOPSW EQU   PSA+40
FLCSOPSW EQU   PSA+32
FLCEOPSW EQU   PSA+24
@NM00096 EQU   FLCICCW2+4
FLCCVT   EQU   FLCICCW2
FLCICCW1 EQU   FLCROPSW
FLCIPPSW EQU   FLCRNPSW
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00282 EQU   @RC00281
@RC00311 EQU   @RC00310
@RC00374 EQU   @RC00342
@RC00444 EQU   @RC00443
@RC00626 EQU   @EL00002
@RC00719 EQU   @RC00713
@RC00755 EQU   @RC00749
@RF00774 EQU   @EL00003
@RC00640 EQU   @RC00626
@RF00725 EQU   @RC00719
@RF00761 EQU   @RC00755
@ENDDATA EQU   *
         END   IEAVVWTO,(C'PLS2319',0701,78192)

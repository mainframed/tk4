         TITLE 'IEAVSWCH, COMM TASK CONSOLE SWITCH ROUTINE             *
                        '
IEAVSWCH CSECT
* A 353430                                                     @YA00092
IGC0407B EQU   *
         ENTRY IGC0407B
         USING *,REG15
         MODID
         USING CXSA,REG01
         LR    REG12,REG01          SAVE A COPY OF THE PTR TO CXSA
         ST    REG14,CSAXA          SAVE RETURN ADDR IN EXTENDED SAVE
         DROP  REG01,REG15
IEAVSWCH CSECT ,                                                01S0002
@PROLOG  BALR  @06,0                                            01S0002
@PSTART  LA    @08,4095(,@06)                                   01S0002
         LA    @05,4095(,@08)                                   01S0002
         USING @PSTART,@06                                      01S0002
         USING @PSTART+4095,@08                                 01S0002
         USING @PSTART+8190,@05                                 01S0002
         L     @00,@SIZDATD                                     01S0002
         GETMAIN  R,LV=(0)
         LR    @09,@01                                          01S0002
         USING @DATD,@09                                        01S0002
         ST    @13,@SA00001+4                                   01S0002
         LR    @13,@09                                          01S0002
RBPRFXLN EQU 64
RBPRFLNA EQU 32
PRBLEN   EQU 136
SIRBLEN  EQU 200
TIRBLEN  EQU 136
IRBLEN   EQU 128
SVRBLEN  EQU 224
         EJECT
*                                                               02S0179
*/*** START OF INITSEG SEGMENT ***************************************/
*/*                                                                  */
*/*  INITSEG - THIS SEGMENT INITIALIZES GENERAL POINTERS, SETS       */
*/*            SWITCHS TO ZERO (OFF OR NO), AND INITIALIZES THE      */
*/*            TIME TO BE USED IN MESSAGES                           */
*/*                                                                  */
*/*  INPUT -   NONE                                                  */
*/*                                                                  */
*/*  OUTPUT -  THE TIME STAMP, SWCHTS, HAS BEEN INITIALIZED TO THE   */
*/*            CURRENT TIME.                                         */
*/*                                                                  */
*/********************************************************************/
*                                                               02S0179
*   LCVTPTR=CVTPTR;                 /* INITIALIZE WORKING CVT BASE   */
         L     @04,CVTPTR                                       02S0179
         ST    @04,LCVTPTR                                      02S0179
*   UCMBASPT=CVTCUCB;               /* INITIALIZE BASE FOR UCM BASE  */
         L     UCMBASPT,CVTCUCB(,@04)                           02S0180
*   UCMMCSPT=UCMPRFXP;              /* INITIALIZE BASE FOR UCM PREFIX*/
         LR    @04,UCMBASPT                                     02S0181
         AL    @04,@CF03908                                     02S0181
         L     UCMMCSPT,UCMPRFXP(,@04)                          02S0181
*   RFY                                                         02S0182
*     CVTMAP BASED(LCVTPTR);        /* BASE CVT ON WORKING COPY      */
*   CSAXC=PSATOLD;                  /* SET ADDR OF CURRENT TCB  02S0183
*                                                            @ZA00886*/
         MVC   CSAXC(4,CXSAPTR),PSATOLD                         02S0183
*   CSAXF=PSAAOLD;                  /* SET ADDR OF CURRENT ASCB 02S0184
*                                                            @ZA00886*/
*                                                               02S0184
         MVC   CSAXF(4,CXSAPTR),PSAAOLD                         02S0184
*   /*****************************************************************/
*   /*                                                               */
*   /* ZERO POINTERS AND SWITCHES.                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0185
*   OLDMAST=ZERO;                   /* OLD MASTER CONSOLE PTR        */
         SLR   @04,@04                                          02S0185
         ST    @04,OLDMAST                                      02S0185
*   FAILI=ZERO;                     /* FAILING INPUT CONSOLE         */
         ST    @04,FAILI                                        02S0186
*   FAILO=ZERO;                     /* FAILING OUTPUT CONSOLE        */
         ST    @04,FAILO                                        02S0187
*   NEWI=ZERO;                      /* NEW INPUT CONSOLE             */
         SLR   NEWI,NEWI                                        02S0188
*   NEWO=ZERO;                      /* NEW OUTPUT CONSOLE            */
         ST    @04,NEWO                                         02S0189
*   BELLCONS=ZERO;                  /* CONSOLE TO RING THE BELL      */
         ST    @04,BELLCONS                                     02S0190
*   PWRCONS=ZERO;                   /* CONSOLE TO SOUND POWER ALARM
*                                                            @G51APSS*/
         ST    @04,PWRCONS                                      02S0191
*   FAILHC=ZERO;                    /* FAILING HARDCOPY CONSOLE      */
         SLR   FAILHC,FAILHC                                    02S0192
*   NEWHC=ZERO;                     /* NEW HARDCOPY CONSOLE          */
         SLR   NEWHC,NEWHC                                      02S0193
*   RETCODE=ZERO;                   /* RETURN CODE FIELD             */
         ST    @04,RETCODE                                      02S0194
*   SWFLAGS=SWFLAGS&&SWFLAGS;       /* CLEAR FLAGS           @G51APSS*/
*                                                               02S0195
         XC    SWFLAGS(4),SWFLAGS                               02S0195
*   /*****************************************************************/
*   /*                                                               */
*   /* TAKE A TIME STAMP, CONVERT IT TO EBCDIC, AND PLACE IT IN FIELD*/
*   /* SWCHTS FOR LATER USE IN CONSTRUCTING WQE'S.                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0196
*   WORD1=ZERO;                     /* TIME WILL BE ZERO IF ERRET    */
         ST    @04,WORD1                                        02S0196
*   RFY                                                         02S0197
*     REG00 RSTD;                                               02S0197
*   DO;                             /* TIMEP (DEC) ERRET(SWCHTIM)    */
*     RFY                                                       02S0199
*      (GPR00P,                                                 02S0199
*       GPR01F,                                                 02S0199
*       GPR15F) RSTD;               /* RESTRICT REGISTERS            */
*     GPR01F='00000042'X;           /* SET REGISTER ONE              */
         LA    GPR01F,66                                        02S0200
*     GPR00P=0;                     /* SET REGISTER ZERO             */
         SLR   GPR00P,GPR00P                                    02S0201
*     SVC(11);                      /* ISSUE TIME SVC                */
         SVC   11                                               02S0202
*     IF GPR15F>4 THEN              /* WAS SVC SUCCESSFUL            */
         CH    GPR15F,@CH00065                                  02S0203
         BH    @RT00203                                         02S0203
*       GOTO SWCHTIM;               /* BRANCH TO ERROR RETURN        */
*     RFY                                                       02S0205
*      (GPR00P,                                                 02S0205
*       GPR01F,                                                 02S0205
*       GPR15F) UNRSTD;             /* RELEASE REGISTERS             */
*   END;                            /* TIMEP (DEC) ERRET(SWCHTIM) GET
*                                      THE TIME                      */
*   WORD1=REG00;                    /* SAVE TIME FOR UNPACK          */
         ST    REG00,WORD1                                      02S0207
*   RFY                                                         02S0208
*     REG00 UNRSTD;                                             02S0208
*SWCHTIM:                                                       02S0209
*   UNPK(DBLWORD1,WORD1S);          /* UNPACK THE TIME               */
SWCHTIM  UNPK  DBLWORD1(8),WORD1S(4)                            02S0209
*   HH=HHP;                         /* FILL IN HOURS                 */
         MVC   HH(2),HHP                                        02S0210
*   PER1=PERIOD;                    /* PLACE PERIOD BETWEEN HOUR/MIN */
         MVI   PER1,C'.'                                        02S0211
*   MM=MMP;                         /* FILL IN MINUTES               */
         MVC   MM(2),MMP                                        02S0212
*   PER2=PERIOD;                    /* PLACE PERIOD BETWEEN MIN/SEC  */
         MVI   PER2,C'.'                                        02S0213
*   SS=SSP;                         /* FILL IN SECONDS               */
         MVC   SS(2),SSP                                        02S0214
*   MPLDEF=MPLDEF&&MPLDEF;          /* CLEAR PARM LIST TO ZEROS      */
         XC    MPLDEF(12),MPLDEF                                02S0215
*/*** END OF INITSEG SEGMENT *****************************************/
*                                                               02S0216
*   CALL GETLOCKS;                  /* GO OBTAIN LOCKS               */
*                                                               01S0216
         BAL   @14,GETLOCKS                                     01S0216
*   /*****************************************************************/
*   /*                                                               */
*   /* SET PTR TO CURRENT MASTER CONSOLE AFTER OBTAINING LOCKS TO    */
*   /* INSURE THAT THE COPY IS TRUE.                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                               01S0217
*   MASTERI=UCMMCENT;               /* INITIALIZE PTR TO MASTER      */
         L     @11,UCMMCENT(,UCMMCSPT)                          01S0217
         ST    @11,MASTERI                                      01S0217
*   MASTERO=MASTERI->UCMCOMPC;      /* PTR TO OTHER HALF OF MASTER IF
*                                      COMPOSIT, OTHERWISE, ZERO     */
         MVC   MASTERO(4),UCMCOMPC(@11)                         01S0218
*   IF CSAEXTI='1'B                 /* EXTERNAL INTERRUPT            */
*     THEN                                                      01S0219
         TM    CSAEXTI(CXSAPTR),B'00000100'                     01S0219
         BNO   @RF00219                                         01S0219
*     IF UCMSYSE='0'B               /* AND NOT NO CONSOLE CONDITION  */
*       THEN                                                    01S0220
         TM    UCMSYSE(UCMMCSPT),B'00001000'                    01S0220
         BNZ   @RF00220                                         01S0220
*       DO;                         /* SET UP TO PROCESS EXTERNAL    */
*         EXTSWREQ='1'B;            /* INDICATE SWITCH FOR EXTERNAL  */
         OI    EXTSWREQ,B'10000000'                             01S0222
*         CSAUCMA=MASTERI;          /* MAKE FAILING = MASTER         */
         STCM  @11,7,CSAUCMA(CXSAPTR)                           01S0223
*       END;                                                    01S0224
*     ELSE                          /* TRYING TO RESOLVE THE    01S0225
*                                      NO-CONSOLES CONDITION @G51APSS*/
*       CALL EXTINNCC;              /* SWCH TO THE CANDIDATE @G51APSS*/
         B     @RC00220                                         01S0225
@RF00220 BAL   @14,EXTINNCC                                     01S0225
*/********************************************************************/
*/*                                                                  */
*/*   TEST WHETHER TO RUN THROUGH THE CONSFAIL ROUTINE.              */
*/*   THIS IS NEEDED IF CALL IS FOR AN I/O ERROR, THE EXTERNAL       */
*/*   INTERRUPT KEY WAS PRESSED AND A NO CONSOLES CONDITION DOESNT   */
*/*   EXIST, OR A VARY MSTCONS CMD AFTER MESSAGE IEE141A.            */
*/*                                                                  */
*/********************************************************************/
*                                                               01S0226
*   IF CSACODE=CSASWTCH×EXTSWREQ='1'B×((UCMAMFA='1'B&CSAVMST='1'B)&
*       CSAUCMA^=MASTERI)           /*                       @YA00092*/
*     THEN                                                      01S0226
@RC00220 DS    0H                                               01S0226
@RF00219 CLI   CSACODE(CXSAPTR),0                               01S0226
         BE    @RT00226                                         01S0226
         TM    EXTSWREQ,B'10000000'                             01S0226
         BO    @RT00226                                         01S0226
         TM    UCMAMFA(UCMBASPT),B'00001000'                    01S0226
         BNO   @RF00226                                         01S0226
         TM    CSAVMST(CXSAPTR),B'00001000'                     01S0226
         BNO   @RF00226                                         01S0226
         SLR   @11,@11                                          01S0226
         ICM   @11,7,CSAUCMA(CXSAPTR)                           01S0226
         C     @11,MASTERI                                      01S0226
         BE    @RF00226                                         01S0226
@RT00226 DS    0H                                               01S0227
*     DO;                           /* IF REQUIRED, SWITCH CONSOLES  */
*                                                               02S0228
*/*** START OF CONSFAIL SEGMENT **************************************/
*/*                                                                  */
*/* CONSFAIL - PROCESSING FOR AN I/O ERROR ON ANY CONSOLE, VARY      */
*/*            MSTCONS WHEN ACCEPTED FROM ANYONE, AND AN EXTERNAL    */
*/*            INTERRUPT IN OTHER THAN A NO CONSOLES CONDITION       */
*/*                                                                  */
*/* FUNCTION - SELECTS AN ALTERNATE CONSOLE, CALLS THE SWCONS        */
*/*    TO SWITCH THE CONSOLES FUNCTION, REQUEUE MESSAGES, ETC.       */
*/*                                                                  */
*/* INPUT - CSAUCMA = UCME ADDR OF FAILING CONSOLE OR NEW MASTER     */
*/*                 FROM V MSTCONS COMMAND                           */
*/*         MASTERI = UCME ADDR OF MASTER (INPUT HALF IF COMPOSITE)  */
*/*                                                                  */
*/* OUTPUT - NONE                                                    */
*/*                                                                  */
*/********************************************************************/
*                                                               02S0228
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK FOR VARY MSTCONS FROM ANYONE.                       */
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0228
*       IF CSAVMST='1'B&UCMAMFA='1'B THEN/* VARY MSTCONS FROM ANYONE?*/
         TM    CSAVMST(CXSAPTR),B'00001000'                     02S0228
         BNO   @RF00228                                         02S0228
         TM    UCMAMFA(UCMBASPT),B'00001000'                    02S0228
         BNO   @RF00228                                         02S0228
*         DO;                       /* YES                           */
*           MASTERI->UCMUF='1'B;    /* TURN ON ACTIVE FLAG IN CURRENT
*                                      MASTER SO IT CAN CLOSE        */
         L     @11,MASTERI                                      02S0230
         OI    UCMUF(@11),B'00010000'                           02S0230
*           IF MASTERO^=ZERO THEN   /* MASTER A COMPOSITE?   @ZA20165*/
         L     @11,MASTERO                                      02S0231
         LTR   @11,@11                                          02S0231
         BZ    @RF00231                                         02S0231
*             MASTERO->UCMUF='1'B;  /* YES, THEN MARK OUTPUT HALF
*                                      ACTIVE                @ZA20165*/
         OI    UCMUF(@11),B'00010000'                           02S0232
*           NEWI=CSAUCMA;           /* PUT ADDR OF NEW MASTER IN NEWI*/
@RF00231 SLR   NEWI,NEWI                                        02S0233
         ICM   NEWI,7,CSAUCMA(CXSAPTR)                          02S0233
*           NEWO=NEWI->UCMCOMPC;    /* GET ADDR OF OUTPUT HALF OF NEW
*                                      MASTER (IF ANY)       @ZA18881*/
         MVC   NEWO(4),UCMCOMPC(NEWI)                           02S0234
*           FAILI=MASTERI;          /* PUT ADDR OF OLD MASTER IN
*                                      FAILI                         */
         L     @11,MASTERI                                      02S0235
         ST    @11,FAILI                                        02S0235
*           FAILO=MASTERI->UCMCOMPC;/* PUT ADDR OF OUTPUT HALF OF OLD
*                                      MASTER (IF ANY) IN OUTPUT HALF
*                                      OF FAILING CONSOLE            */
         MVC   FAILO(4),UCMCOMPC(@11)                           02S0236
*           UCMSYSD='1'B;           /* INDICATE SWITCH IS FOR MASTER */
         OI    UCMSYSD(UCMMCSPT),B'00010000'                    02S0237
*         END;                                                  02S0238
*       ELSE                        /* NOT VARY MSTCONS FROM ANYONE  */
*         DO;                                                   02S0239
*                                                               02S0239
         B     @RC00228                                         02S0239
@RF00228 DS    0H                                               02S0240
*           /*********************************************************/
*           /*                                                       */
*           /* SET UP PTRS TO INPUT AND OUTPUT HALVES OF THE FAILING */
*           /* CONSOLE. IF THE CONSOLE IS NOT COMPOSITE, FAILI WILL  */
*           /* CONTAIN ITS UCME ADDR.                                */
*           /*                                                       */
*           /*********************************************************/
*                                                               02S0240
*           FAILI=CSAUCMA;          /* GET PTR TO FAILING UCME       */
         SLR   @11,@11                                          02S0240
         ICM   @11,7,CSAUCMA(CXSAPTR)                           02S0240
         ST    @11,FAILI                                        02S0240
*           FAILO=CSAUCMA->UCMCOMPC;/* GET OTHER HALF OF FAILING
*                                      CONSOLE IF ANY                */
         L     @04,UCMCOMPC(,@11)                               02S0241
         ST    @04,FAILO                                        02S0241
*           IF FAILO^=ZERO THEN     /* IS FAILING CONSOLE A COMPOSITE*/
         LTR   @04,@04                                          02S0242
         BZ    @RF00242                                         02S0242
*             IF CSAUCMA->UCMOF='1'B THEN/* YES, IS FAILING HALF THE
*                                      OUTPUT HALF                   */
         TM    UCMOF(@11),B'10000000'                           02S0243
         BNO   @RF00243                                         02S0243
*               DO;                 /* YES, INTERCHANGE INPUT AND
*                                      OUTPUT HALF PTRS              */
*                 FAILI=FAILO;      /* PUT PTR TO INPUT HALF IN FAILI*/
         ST    @04,FAILI                                        02S0245
*                 FAILO=FAILI->UCMCOMPC;/* PUT PTR TO OUTPUT HALF IN
*                                      FAILO                         */
         MVC   FAILO(4),UCMCOMPC(@04)                           02S0246
*               END;                                            02S0247
*                                                               02S0247
*           /*********************************************************/
*           /*                                                       */
*           /* SELECT AN ALTERNATE FOR THE FAILING CONSOLE. IF AN    */
*           /* ALTERNATE IS FOUND ITS UCME ADDR IS PUT IN NEWI.      */
*           /*                                                       */
*           /*********************************************************/
*                                                               02S0248
*           CALL FINDALT;           /* GO FIND AN ALTERNATE          */
@RF00243 DS    0H                                               02S0248
@RF00242 BAL   @14,FINDALT                                      02S0248
*         END;                                                  02S0249
*       CALL SWCONS;                /* SWITCH FAILING CONSOLE TO ALT */
@RC00228 BAL   @14,SWCONS                                       02S0250
*/** END OF CONSFAIL SEGMENT *****************************************/
*                                                               02S0251
*     END;                                                      01S0251
*   ELSE                                                        01S0252
*     DO;                                                       01S0252
         B     @RC00226                                         01S0252
@RF00226 DS    0H                                               01S0253
*       IF CSAVMST='1'B             /* IS THIS A V MSTCONS REQUEST   */
*         THEN                                                  01S0253
         TM    CSAVMST(CXSAPTR),B'00001000'                     01S0253
         BNO   @RF00253                                         01S0253
*         DO;                       /* IF IT IS, SWITCH THE MASTER   */
*                                                               02S0255
*/*** START OF VMSCON SEGMENT ****************************************/
*/*                                                                  */
*/*  VMSCON -  NORMAL PROCESSING FOR A VARY MSTCONS COMMAND.         */
*/*            1.  THE OLD MASTERS AUTHORITY AND ROUTE CODES ARE     */
*/*                GIVEN TO THE MASTER.  (THE HARDCOPY FUNCTION IS   */
*/*                NOT TRANSFERRED).                                 */
*/*                                                                  */
*/*            2.  A MESSAGE INDICATING THE STATUS OF THE NEW MASTER */
*/*                IS WRITTEN.                                       */
*/*                                                                  */
*/*  INPUT  -  CSAUCMA = UCME ADDRESS FOR THE NEW MASTER.            */
*/*                                                                  */
*/*  OUTPUT -  NONE                                                  */
*/*                                                                  */
*/********************************************************************/
*                                                               02S0255
*           IF CSAUCMA^=MASTERI THEN/* IS NEW MASTER SAME AS OLD     */
         L     @11,MASTERI                                      02S0255
         SLR   @04,@04                                          02S0255
         ICM   @04,7,CSAUCMA(CXSAPTR)                           02S0255
         CR    @04,@11                                          02S0255
         BE    @RF00255                                         02S0255
*             DO;                   /* IF NOT THE SAME, DO THIS      */
*               NEWI=CSAUCMA;       /* SET UP NEW MASTER PTR         */
         LR    NEWI,@04                                         02S0257
*               FAILI=MASTERI;      /* SET UP FAILING CONSOLE PTR    */
         ST    @11,FAILI                                        02S0258
*               FAILO=MASTERO;      /* OUTPUT HALF OF OLD MASTER OR 0*/
         MVC   FAILO(4),MASTERO                                 02S0259
*               NEWO=NEWI->UCMCOMPC;/* GET PTR TO OTHER HALF OF NEW
*                                      MASTER CONSOLE.               */
         L     @11,UCMCOMPC(,NEWI)                              02S0260
         ST    @11,NEWO                                         02S0260
*               IF NEWO^=0 THEN     /* IS NEW MASTER A COMPOSITE     */
         LTR   @11,@11                                          02S0261
         BZ    @RF00261                                         02S0261
*                 IF NEWI->UCMOF='1'B THEN/* IS NEW MASTER PTR OUTPUT
*                                      HALF                          */
         TM    UCMOF(NEWI),B'10000000'                          02S0262
         BNO   @RF00262                                         02S0262
*                   DO;             /* IF OUTPUT HALF, EXCHANGE INPUT
*                                      AND OUTPUT HALF PTRS          */
*                     NEWI=NEWO;    /* PUT INPUT HALF IN NEWI        */
         LR    NEWI,@11                                         02S0264
*                     NEWO=NEWI->UCMCOMPC;/* PUT OUTPUT HALF IN NEWO */
         MVC   NEWO(4),UCMCOMPC(NEWI)                           02S0265
*                   END;            /* END SWITCH OF COMPOSITE HALVES*/
*               UCMSYSD='1'B;       /* INDICATE SWITCH IS FOR MASTER */
@RF00262 DS    0H                                               02S0267
@RF00261 OI    UCMSYSD(UCMMCSPT),B'00010000'                    02S0267
*               CALL SETOSW;        /* TRANSFER MASTERS FUNCTIONS TO
*                                      NEW MASTER.                   */
         BAL   @14,SETOSW                                       02S0268
*               CALL STATMSG;       /* ISSUE NEW MASTER STATUS MSG   */
         BAL   @14,STATMSG                                      02S0269
*             END;                  /* END DO FOR NEW ^= OLD MASTER  */
*/*** END OF VMSCON SEGMENT ******************************************/
*                                                               02S0271
*         END;                                                  01S0271
@RF00255 DS    0H                                               01S0272
*       IF CSAHC='1'B               /* IS HARDCOPY BEING SWITCHED    */
*         THEN                                                  01S0272
@RF00253 TM    CSAHC(CXSAPTR),B'00000010'                       01S0272
         BNO   @RF00272                                         01S0272
*         CALL HCSWITCH;            /* IF IT IS, CALL SUBROUTINE     */
         BAL   @14,HCSWITCH                                     01S0273
*       IF CSAVCPU='1'B×CSAVCHAN='1'B/* IS CALL FROM V CPU/CHANNEL   */
*         THEN                                                  01S0274
@RF00272 TM    CSAVCPU(CXSAPTR),B'01100000'                     01S0274
         BZ    @RF00274                                         01S0274
*         DO;                       /* IF IT IS, PROCESS REQUEST     */
*                                                               02S0276
*/*** START OF VCPU SEGMENT ******************************************/
*/*                                                                  */
*/* VCPU  -  PROCESSES VARY CPU AND VARY CHANNEL CMD REQUEST         */
*/*                                                                  */
*/* FUNCTION - THIS ROUTINE CHECKS WHETHER A VARY CPU OR CHANNEL     */
*/*            COMMAND WOULD RESULT IN A NO CONSOLES OR HARDCOPY     */
*/*            SUSPENDED SITUATION AND IF SO, NO CONSOLES ARE        */
*/*            SWITCHED AND THE VARY COMMAND IS NOTIFIED WITH A      */
*/*            RETURN CODE OF 4. IF THE VARY COMMAND WOULD NOT CAUSE */
*/*            THESE PROBLEMS, AFFECTED CONSOLES ARE MARKED TO BE    */
*/*            CLOSED AND TAKEN OFFLINE WHEN ALL THEIR CURRENT WORK  */
*/*            IS COMPLETE.                                          */
*/*                                                                  */
*/* INPUT  -   UCBVHRSN=1 FOR EACH CONSOLE WHOSE I/O PATH IS AFFECTED*/
*/*                                                                  */
*/* OUTPUT -   RETCODE=0      IF VARY COMMAND CAN CONTINUE           */
*/*             FOLLOWING FIELDS SET IF RETURN CODE IS ZERO          */
*/*              UCMCF=1      CLOSE PENDING IN UCME OF AFFECTED CONSO*/
*/*              UCBCHGS=1    DEVICE IS TO GO OFFLINE                */
*/*              UCBDADI=1    DEVIE IS GOING OUT OF CONSOLE STATUS   */
*/*              UCMMCENT=    ADDR OF NEW MASTER IF OLD WAS AFFECTED */
*/*              UCMDISPB=0   IN OLD HARDCOPY UCME IF IT WAS AFFECTED*/
*/*              UCMDISPB=1   IN NEW HARDCOPY UCME IF HC SWITCHED    */
*/*              UCMDISPA     OFF IN OLD MASTER, ON IN NEW           */
*/*            RETCODE=4      IF CMD WOULD CAUSE LOSS OF HC OR MASTER*/
*/*             NO CONSOLES ARE MODIFIED IF RETURN CODE IS 4         */
*/*                                                                  */
*/********************************************************************/
*                                                               02S0276
*           DO PATHUCME=UCMVEA TO UCMVEL BY UCMVEZ;/* FIND ALL  02S0276
*                                      AFFECTED CONS                 */
         L     @11,UCMVEA(,UCMBASPT)                            02S0276
         B     @DE00276                                         02S0276
@DL00276 DS    0H                                               02S0277
*             RFY                                               02S0277
*               UCMLIST BASED(PATHUCME);/* TEMPORARILY REBASE UCME   */
*             IF UCMUCB->UCBVHRSN='1'B&UCMUCB->UCBONLI='1'B&UCMUCB->
*                 UCBSYSR='1'B THEN                             02S0278
         L     @04,UCMUCB(,@11)                                 02S0278
         TM    UCBVHRSN(@04),B'00000010'                        02S0278
         BNO   @RF00278                                         02S0278
         TM    UCBONLI(@04),B'10000010'                         02S0278
         BNO   @RF00278                                         02S0278
*               UCMVHRSN='1'B;      /* TEST CONSOLE FOR I/O PATH LOSS*/
         OI    UCMVHRSN(@11),B'00000001'                        02S0279
*             RFY                                               02S0280
*               UCMLIST BASED(UCMDVEPT);/* RESTORE NORMAL UCME BASE  */
@RF00278 DS    0H                                               02S0281
*           END;                                                02S0281
         L     @11,PATHUCME                                     02S0281
         AL    @11,UCMVEZ(,UCMBASPT)                            02S0281
@DE00276 ST    @11,PATHUCME                                     02S0281
         C     @11,UCMVEL(,UCMBASPT)                            02S0281
         BNH   @DL00276                                         02S0281
*           IF MASTERO=ZERO         /* IS THE MASTER A COMPOSITE     */
*             THEN                                              02S0282
         ICM   @11,15,MASTERO                                   02S0282
         BNZ   @RF00282                                         02S0282
*             MASTERO=MASTERI;      /* IF NOT, OUTPUT SAME AS INPUT  */
         MVC   MASTERO(4),MASTERI                               02S0283
*/********************************************************************/
*/*                                                                  */
*/*  TEST THE MASTER CONSOLE TO SEE IF ITS PATH WOULD BE LOST BY THE */
*/*  VARY COMMAND. IF YES, SEE IF AN ALTERNATE CAN BE FOUND.         */
*/*                                                                  */
*/********************************************************************/
*                                                               02S0284
*           IF MASTERI->UCMVHRSN='1'B×MASTERO->UCMVHRSN='1'B/* IS
*                                      MASTER AFFECTD                */
*             THEN                  /* YES, THEN DO SEARCH           */
@RF00282 L     @11,MASTERI                                      02S0284
         TM    UCMVHRSN(@11),B'00000001'                        02S0284
         BO    @RT00284                                         02S0284
         L     @11,MASTERO                                      02S0284
         TM    UCMVHRSN(@11),B'00000001'                        02S0284
         BNO   @RF00284                                         02S0284
@RT00284 DS    0H                                               02S0285
*             DO;                                               02S0285
*                                                               03S0286
*/*** START OF VCPUMAST SEGMENT **************************************/
*/*                                                                  */
*/* VCPUMAST - SEARCHS FOR A MASTER CONSOLE FOR THE VCPU SEGMENT     */
*/*                                                                  */
*/* FUNCTION - IF THE I/O PATH TO THE MASTER CONSOLE WOULD BE        */
*/*            AFFECTED BY THE CALLING VARY CPU OR VARY CHANNEL      */
*/*            COMMAND, THIS ROUTINE SEARCHS THE MASTERS ALTERNATE   */
*/*            CHAIN FOR AN ALTERNATE WHICH WOULD STILL BE ACTIVE    */
*/*            IF THE COMMAND WERE PROCESSED.                        */
*/*                                                                  */
*/* INPUT  -   MASTERI CONTAINS ADDR OF MASTER CONSOLES UCME         */
*/*                                                                  */
*/* OUTPUT  -  RETCODE=0     IF SEARCH WAS SUCCESSFUL                */
*/*              NEWI AND NEWO WILL CONTAIN PTRS TO ALTERNATE        */
*/*            RETCODE=4     IF SEARCH WAS UNSUCCESSFUL              */
*/*                                                                  */
*/********************************************************************/
*                                                               03S0286
*               MASTERI->UCMDEVCC='1'B;/* MARK INPUT HALF AS TESTED  */
*               MASTERI->UCMDEVCC='1'B;/* MARK INPUT HALF AS TESTED  */
         L     @11,MASTERI                                      03S0287
         OI    UCMDEVCC(@11),B'00100000'                        03S0287
*               MASTERO->UCMDEVCC='1'B;/* MARK OUTPUT HALF AS TESTED */
         L     @04,MASTERO                                      03S0288
         OI    UCMDEVCC(@04),B'00100000'                        03S0288
*               NEWI=MASTERI->UCMALTEN;/* GET PTR TO ALTERNATE       */
         L     NEWI,UCMALTEN(,@11)                              03S0289
*               IF NEWI^=ZERO       /* IS THERE AN ALTERNATE         */
*                 THEN              /* YES, PROCEDE                  */
         SLR   @11,@11                                          03S0290
         CR    NEWI,@11                                         03S0290
         BE    @RF00290                                         03S0290
*                 DO;                                           03S0291
*                   IF NEWI->UCMCOMPC=ZERO/* IS ALTERNATE A     03S0292
*                                      COMPOSITE?                    */
*                     THEN                                      03S0292
         C     @11,UCMCOMPC(,NEWI)                              03S0292
         BNE   @RF00292                                         03S0292
*                     NEWO=NEWI;    /* NO, OUTPUT = INPUT            */
         ST    NEWI,NEWO                                        03S0293
*                   ELSE                                        03S0294
*                     NEWO=NEWI->UCMCOMPC;/* YES, OUTPUT = OUTPUT
*                                      HALF                          */
         B     @RC00292                                         03S0294
@RF00292 MVC   NEWO(4),UCMCOMPC(NEWI)                           03S0294
*                 END;                                          03S0295
@RC00292 DS    0H                                               03S0296
*               ALTFND='0'B;        /* INITIALIZE LOOP CONTROL SW    */
@RF00290 NI    ALTFND,B'11111110'                               03S0296
*/* LOOP THRU THE MASTERS ALTERNATE CHAIN SEARCHING FOR ALTERNATE    */
*                                                               03S0297
*               DO WHILE NEWI^=ZERO&ALTFND='0'B;                03S0297
         B     @DE00297                                         03S0297
@DL00297 DS    0H                                               03S0298
*                 IF NEWI->UCMDEVCC='0'B&NEWO->UCMDEVCC='0'B/* HAVE
*                                      THESE BEEN DONE               */
*                   THEN                                        03S0298
         TM    UCMDEVCC(NEWI),B'00100000'                       03S0298
         BNZ   @RF00298                                         03S0298
         L     @11,NEWO                                         03S0298
         TM    UCMDEVCC(@11),B'00100000'                        03S0298
         BNZ   @RF00298                                         03S0298
*                   IF NEWI->UCMVHRSN='0'B/* IS CONSOLE I/O PATH
*                                      UNAFFECTED                    */
*                       &(NEWI->UCMUF='1'B×NEWI->UCMTA='1'B)/* ACTIVE
*                                      OR OPEN PNDG                  */
*                       &NEWI->UCMCF='0'B/* CLOSE IS NOT PENDING     */
*                       &(NEWI->UCMDISPD='0'B×NEWI->UCMDISPC='1'B)/*
*                                      AND FULL I/O                  */
*                       &NEWO->UCMVHRSN='0'B/* OUTPUT I/O PATH  03S0299
*                                      UNAFFECTED                    */
*                       &(NEWO->UCMUF='1'B×NEWO->UCMTA='1'B)/* ACTIVE
*                                      OR OPEN PNDG                  */
*                       &NEWO->UCMCF='0'B/* AND NOT CLOSE PENDING    */
*                     THEN                                      03S0299
         TM    UCMVHRSN(NEWI),B'00000001'                       03S0299
         BNZ   @RF00299                                         03S0299
         TM    UCMUF(NEWI),B'00010000'                          03S0299
         BO    @GL00013                                         03S0299
         TM    UCMTA(NEWI),B'00001000'                          03S0299
         BNO   @RF00299                                         03S0299
@GL00013 TM    UCMCF(NEWI),B'00010000'                          03S0299
         BNZ   @RF00299                                         03S0299
         TM    UCMDISPC(NEWI),B'00100000'                       03S0299
         BNZ   @GL00011                                         03S0299
         TM    UCMDISPD(NEWI),B'00010000'                       03S0299
         BO    @RF00299                                         03S0299
@GL00011 L     @11,NEWO                                         03S0299
         TM    UCMVHRSN(@11),B'00000001'                        03S0299
         BNZ   @RF00299                                         03S0299
         TM    UCMUF(@11),B'00010000'                           03S0299
         BO    @GL00009                                         03S0299
         TM    UCMTA(@11),B'00001000'                           03S0299
         BNO   @RF00299                                         03S0299
@GL00009 L     @11,NEWO                                         03S0299
         TM    UCMCF(@11),B'00010000'                           03S0299
         BNZ   @RF00299                                         03S0299
*                     ALTFND=YES;   /* THEN ALTERNATE HAS BEEN FOUND */
         OI    ALTFND,B'00000001'                               03S0300
*                   ELSE            /* IF ALTERNATE IS UNACCEPTABLE  */
*                     DO;                                       03S0301
         B     @RC00299                                         03S0301
@RF00299 DS    0H                                               03S0302
*                       NEWI->UCMDEVCC='1'B;/* MARK INPUT HALF AS
*                                      TESTED                        */
         OI    UCMDEVCC(NEWI),B'00100000'                       03S0302
*                       NEWO->UCMDEVCC='1'B;/* MARK OUTPUT HALF AS
*                                      TESTED                        */
         L     @11,NEWO                                         03S0303
         OI    UCMDEVCC(@11),B'00100000'                        03S0303
*                       NEWI=NEWI->UCMALTEN;/* PICK UP PTR TO NEXT
*                                      ALT                           */
         L     NEWI,UCMALTEN(,NEWI)                             03S0304
*                       IF NEWI->UCMCOMPC=ZERO/* IS NEW ALT A   03S0305
*                                      COMPOSITE                     */
*                         THEN                                  03S0305
         ICM   @11,15,UCMCOMPC(NEWI)                            03S0305
         BNZ   @RF00305                                         03S0305
*                         NEWO=NEWI;/* NO, OUTPUT = INPUT            */
         ST    NEWI,NEWO                                        03S0306
*                       ELSE                                    03S0307
*                         NEWO=NEWI->UCMCOMPC;/* OUTPUT = OTHER HALF */
         B     @RC00305                                         03S0307
@RF00305 MVC   NEWO(4),UCMCOMPC(NEWI)                           03S0307
*                     END;                                      03S0308
*                 ELSE              /* IF NEW ALTERNATE WAS TESTED   */
*                   DO;                                         03S0309
         B     @RC00298                                         03S0309
@RF00298 DS    0H                                               03S0310
*                     NEWI=ZERO;    /* NO ALTERNATE FOUND            */
         SLR   NEWI,NEWI                                        03S0310
*                     NEWO=ZERO;    /* CLEAR OUTPUT HALF PTR ALSO    */
         SLR   @11,@11                                          03S0311
         ST    @11,NEWO                                         03S0311
*                   END;                                        03S0312
*               END;                /* END SEARCH LOOP               */
@RC00298 DS    0H                                               03S0313
@DE00297 LTR   NEWI,NEWI                                        03S0313
         BZ    @DC00297                                         03S0313
         TM    ALTFND,B'00000001'                               03S0313
         BZ    @DL00297                                         03S0313
@DC00297 DS    0H                                               03S0314
*               IF ALTFND=NO        /* WAS SEARCH UNSUCCESSFUL?      */
*                 THEN                                          03S0314
         TM    ALTFND,B'00000001'                               03S0314
         BNZ   @RF00314                                         03S0314
*                 RETCODE=FOUR;     /* IF UNSUCCESSFUL, RETURN CODE=4*/
         MVC   RETCODE(4),@CF00065                              03S0315
*/*** END OF VCPUMAST SEGMENT ****************************************/
*                                                               03S0316
*             END;                                              02S0316
@RF00314 DS    0H                                               02S0317
*           IF RETCODE=ZERO         /* TEST RETURN CODE BEFOR GOING
*                                      ON                            */
*             THEN                  /* RETURN CODE WAS ZERO, CONTINUE*/
@RF00284 SLR   @11,@11                                          02S0317
         C     @11,RETCODE                                      02S0317
         BNE   @RF00317                                         02S0317
*             DO;                                               02S0318
*               IF UCMHCUCM^=ZERO   /* IS HARDCOPY TO A CONSOLE?     */
*                 THEN                                          02S0319
         L     @04,UCMHCUCM(,UCMMCSPT)                          02S0319
         CR    @04,@11                                          02S0319
         BE    @RF00319                                         02S0319
*                 IF UCMHCUCM->UCMVHRSN='1'B/* AND IS ITS PATH  02S0320
*                                      AFFECTED                      */
*                   THEN            /* YES, SEARCH FOR ALTERNATE     */
         TM    UCMVHRSN(@04),B'00000001'                        02S0320
         BNO   @RF00320                                         02S0320
*                   DO;                                         02S0321
*                     FAILI=UCMHCUCM;/* GET PTR TO HARDCOPY UCME     */
         ST    @04,FAILI                                        02S0322
*                     IF FAILI->UCMCOMPC^=ZERO/* IS HARDCOPY TO A
*                                      COMPOSITE                     */
*                       THEN        /* YES, SET UP INPUT AND OUTPUT  */
         L     @02,UCMCOMPC(,@04)                               02S0323
         CR    @02,@11                                          02S0323
         BE    @RF00323                                         02S0323
*                       DO;                                     02S0324
*                         FAILO=FAILI;/* ASSUME HC WAS OUTPUT HALF   */
         ST    @04,FAILO                                        02S0325
*                         IF FAILI->UCMOF='1'B/* TEST ASSUMPTION     */
*                           THEN                                02S0326
         TM    UCMOF(@04),B'10000000'                           02S0326
         BNO   @RF00326                                         02S0326
*                           FAILI=FAILI->UCMCOMPC;/* RIGHT, SET INPT */
         ST    @02,FAILI                                        02S0327
*                         ELSE                                  02S0328
*                           FAILO=FAILI->UCMCOMPC;/* WRONG, SET OUTP */
         B     @RC00326                                         02S0328
@RF00326 L     @11,FAILI                                        02S0328
         MVC   FAILO(4),UCMCOMPC(@11)                           02S0328
*                       END;                                    02S0329
*                     ELSE                                      02S0330
*                       FAILO=FAILI;/* IF HC NOT COMPOSITE OUTPU=INPT*/
         B     @RC00323                                         02S0330
@RF00323 MVC   FAILO(4),FAILI                                   02S0330
*                     CALL FNDHCALT;/* GO SEARCH FOR HC ALTERNATE    */
@RC00323 BAL   @14,FNDHCALT                                     02S0331
*                     IF NEWHC=ZERO /* WAS A HARDCOPY CONSOLE FOUND? */
*                       THEN                                    02S0332
         LTR   NEWHC,NEWHC                                      02S0332
         BNZ   @RF00332                                         02S0332
*                       RETCODE=FOUR;/* IF NO, STOP VARY WITH CODE=4 */
         MVC   RETCODE(4),@CF00065                              02S0333
*                   END;            /* END HARDCOPY CONSOLE SEARCH   */
@RF00332 DS    0H                                               02S0335
*             END;                  /* END PROCESSING FOR RETCODE=0  */
@RF00320 DS    0H                                               02S0335
@RF00319 DS    0H                                               02S0336
*/********************************************************************/
*/*                                                                  */
*/* IF RETURN CODE IS ZERO AT THIS POINT, THE VARY COMMAND IS 'GO'.  */
*/* AN ALTERNATE FOR THE MASTER CONSOLE AND HARDCOPY CONSOLE HAVE    */
*/* BEEN FOUND IF THEY WERE REQUIRED,. IF A SWITCH OF THE            */
*/* MASTER CONSOLE IS NEEDED, IT WILL BE INDICATED BY NEWI BEING     */
*/* NON-ZERO, THE SWITCH IS DONE NOW. THEN ALL REMAINING CONSOLES    */
*/* WILL BE TESTED AND THOSE WHOSE I/O PATHS ARE AFFECTED WILL BE    */
*/* SWITCHED TO AN ALTERNATE OR TO THE MASTER IF NO ALTERNATE EXISTS.*/
*/*                                                                  */
*/********************************************************************/
*                                                               02S0336
*           IF RETCODE=ZERO         /* TEST RETURN CODE              */
*             THEN                  /* RETURN CODE IS ZERO, CONSTINUE*/
@RF00317 SLR   @11,@11                                          02S0336
         C     @11,RETCODE                                      02S0336
         BNE   @RF00336                                         02S0336
*             DO;                                               02S0337
*                                                               02S0337
*/* VARY COMMAND IS 'GO', SWITCH MASTER CONSOLE FUNCTION IF NEEDED.  */
*/********************************************************************/
*/*    THE FOLLOWING TWO INSTRUCTIONS PERFORM THE FOLLOWING PURPOSE: */
*/*        (1) POST REQUIRED BIT IS TURNED ON TO INSURE THAT COMM    */
*/*            TASK GETS CONTROL TO PROCESS THE CONSOLE CLOSE        */
*/*            FOR CONSOLES ON THE CPU BEING TAKEN OFFLINE.          */
*/*        (2) UCMSYSJ IS TURNED ON TO  INSURE THAT ONCE INTO COMM   */
*/*            TASK, THE OUTPUT ROUTINE IN IEAVMDSV WILL BE CALLED   */
*/*            FROM IEAVMQWR TO PROCESS THE CLOSE PENDINGS.          */
*/*    IF THIS WERE NOT DONE, THEN THE POSSIBILITY EXISTS THAT WHEN  */
*/*    THIS MODULE RETURNS TO VCPU, HE WILL SPIN WAITING FOR THE     */
*/*    CONSOLES TO CLOSE, AND NO ONE IS AROUND TO WAKE UP COMM TASK  */
*/*    TO ACTUALLY DO THE CLOSES.  WITH COMM TASK STILL IN A WAIT    */
*/*    STATE, AND VCPU WAITING FOR THE CLOSES, IT WOULD APPEAR TO    */
*/*    THE SYSTEM OPERATOR AS IF THE COMMAND GOT LOST IN THE SYSTEM. */
*/*    TO FORSTALL THIS, WE INSURE THAT COMM TASK WILL BE POSTED     */
*/*    AND WILL GO THROUGH THE NECESSARY CODE TO ACTUALLY CLOSE THE  */
*/*    CONSOLES.                                                     */
*/********************************************************************/
*                                                               02S0338
*               POSTREQ='1'B;       /* SIGNAL POST COMMTASK   YM03457*/
         OI    POSTREQ,B'00000010'                              02S0338
*               UCMSYSJ='1'B;       /* SIGNAL OUTPUT TO DO    YM03457*/
         OI    UCMSYSJ(UCMMCSPT),B'01000000'                    02S0339
*/********************************************************************/
*                                                               02S0340
*               IF NEWI^=ZERO       /* WAS ALTERNATE FOR THE MASTER
*                                      SELECTED?                     */
*                 THEN              /* YES, MASTER SWITCH NEEDED     */
         CR    NEWI,@11                                         02S0340
         BE    @RF00340                                         02S0340
*                 DO;                                           02S0341
*                   IF NEWI->UCMDISPC='1'B&NEWI->UCMDISPD='1'B/*
*                                      GRAPHICS AND OUTPUT ONLY?     */
*                     THEN                                      02S0342
         TM    UCMDISPC(NEWI),B'00110000'                       02S0342
         BNO   @RF00342                                         02S0342
*                     CALL SWFULCAP;/* YES, SWITCH TO FULL CAPACITY  */
         BAL   @14,SWFULCAP                                     02S0343
*                   FAILI=MASTERI;  /* SET UP PTR TO OLD FOR STATMSG */
@RF00342 MVC   FAILI(4),MASTERI                                 02S0344
*                   FAILO=MASTERO;  /* SET UP PTR TO OLD FOR STATMSG */
         MVC   FAILO(4),MASTERO                                 02S0345
*                   CALL SWCONS;    /* SWITCH CONSOLES FUNCTION      */
         BAL   @14,SWCONS                                       02S0346
*                   OLDMAST=MASTERI;/* SAVE PTR TO OLD MASTER CONSOLE*/
         MVC   OLDMAST(4),MASTERI                               02S0347
*                   MASTERI=NEWI;   /* ESTABLISH INPUT PTR TO NEW
*                                      MAST                          */
         ST    NEWI,MASTERI                                     02S0348
*                   MASTERO=NEWO;   /* AND OUTPUT PTR TO NEW MASTER  */
         MVC   MASTERO(4),NEWO                                  02S0349
*                 END;                                          02S0350
*                                                               02S0350
*/********************************************************************/
*/*                                                                  */
*/* NOW LOOP THRU ALL THE UCMES AND SWITCH THOSE CONSOLES WHOSE I.O  */
*/* PATHS ARE AFFECTED. THE MASTER CONSOLE FUNCTION HAS ALREADY      */
*/* BEEN SWITCH IF NECESSARY AND SWITCHING WILL BE AVOIDED.          */
*/*                                                                  */
*/********************************************************************/
*                                                               02S0351
*               DO PATHUCME=UCMVEA TO UCMVEL BY UCMVEZ;         02S0351
@RF00340 L     @11,UCMVEA(,UCMBASPT)                            02S0351
         B     @DE00351                                         02S0351
@DL00351 DS    0H                                               02S0352
*                 FAILI=PATHUCME;   /* INITIALIZE FOR TESTING        */
         ST    @11,FAILI                                        02S0352
*                 FAILO=FAILI->UCMCOMPC;/* ASSUME COMPOSITE CONSOLE  */
         L     @04,UCMCOMPC(,@11)                               02S0353
         ST    @04,FAILO                                        02S0353
*                 IF FAILO=ZERO     /* TEST ASSUMPTION OF COMPOSITE  */
*                   THEN                                        02S0354
         LTR   @04,@04                                          02S0354
         BNZ   @RF00354                                         02S0354
*                   FAILO=FAILI;    /* ASSUMPTION WRONG, OUTPUT=INPUT*/
         ST    @11,FAILO                                        02S0355
*                 ELSE                                          02S0356
*                   PATHUCME=PATHUCME+UCMVEZ;/* CONSOLE IS COMPOSITE,
*                                      ADJUST LOOP CONTROL TO SKIP
*                                      OVER TWO CONSOLES             */
         B     @RC00354                                         02S0356
@RF00354 L     @11,PATHUCME                                     02S0356
         AL    @11,UCMVEZ(,UCMBASPT)                            02S0356
         ST    @11,PATHUCME                                     02S0356
*                 IF FAILI->UCMVHRSN='1'B×FAILO->UCMVHRSN='1'B/* PATH
*                                      AFFECTED?                     */
*                   THEN            /* YES, PATH WILL BE LOST.       */
@RC00354 L     @11,FAILI                                        02S0357
         TM    UCMVHRSN(@11),B'00000001'                        02S0357
         BO    @RT00357                                         02S0357
         L     @11,FAILO                                        02S0357
         TM    UCMVHRSN(@11),B'00000001'                        02S0357
         BNO   @RF00357                                         02S0357
@RT00357 DS    0H                                               02S0358
*                   DO;                                         02S0358
*                     IF FAILI^=OLDMAST/* CHECK FOR OLD MASTER  02S0359
*                                      CONSOLE                       */
*                       THEN        /* IF NOT OLD MASTER,PROCEDE     */
         CLC   FAILI(4),OLDMAST                                 02S0359
         BE    @RF00359                                         02S0359
*                       DO;                                     02S0360
*                         NEWI=ZERO;/* CLEAR ALTERNATE PTR FOR FNDALT*/
         SLR   NEWI,NEWI                                        02S0361
*                         NEWO=ZERO;/* CLEAR OUTPUT PTR ALSO         */
         SLR   @11,@11                                          02S0362
         ST    @11,NEWO                                         02S0362
*                         CALL FINDALT;/* GO FIND AN ALTERNATE  02S0363
*                                      CONSOLE                       */
         BAL   @14,FINDALT                                      02S0363
*                         CALL SWCONS;/* GO SWITCH CONSOLE FUNCTION
*                                      AND QUEUE STATUS MESSAGE.     */
         BAL   @14,SWCONS                                       02S0364
*                       END;                                    02S0365
*                                                               02S0365
*/* MARK UCME AS CLOSE PENDING AND UCB AS GOING OFFLINE AND OUT OF
*   CONSOLE STATUS.                                                  */
*                                                               02S0366
*                     DO CONTROL=FAILI TO FAILO BY UCMVEZ;/* LOOP IF
*                                      COMPOSITE                     */
@RF00359 L     @11,FAILI                                        02S0366
         B     @DE00366                                         02S0366
@DL00366 DS    0H                                               02S0367
*                       CONTROL->UCMUCB->UCBCHGSX='1'B;/* GOING 02S0367
*                                      OFFLINE                       */
*                       CONTROL->UCMUCB->UCBDADIX='1'B;/* GOING OUT
*                                      OF CONSOLE                    */
         L     @11,UCMUCB(,@11)                                 02S0368
         L     @04,UCBCHGSX-3(,@11)                             02S0368
@GL00019 LR    @02,@04                                          02S0368
         O     @02,@CF03963                                     02S0368
         CS    @04,@02,UCBCHGSX-3(@11)                          02S0368
         BNE   @GL00019                                         02S0368
*                       CONTROL->UCMCF='1'B;/* MARK CONSOLE CLOSE
*                                      PENDING                       */
         L     @11,CONTROL                                      02S0369
         OI    UCMCF(@11),B'00010000'                           02S0369
*                     END;                                      02S0370
         AL    @11,UCMVEZ(,UCMBASPT)                            02S0370
@DE00366 ST    @11,CONTROL                                      02S0370
         C     @11,FAILO                                        02S0370
         BNH   @DL00366                                         02S0370
*                   END;                                        02S0371
*               END;                /* END LOOP ON UCMES             */
@RF00357 L     @11,PATHUCME                                     02S0372
         AL    @11,UCMVEZ(,UCMBASPT)                            02S0372
@DE00351 ST    @11,PATHUCME                                     02S0372
         C     @11,UCMVEL(,UCMBASPT)                            02S0372
         BNH   @DL00351                                         02S0372
*             END;                  /* END DO FOR RETCODE = 0        */
*/*** END OF VCPU SEGMENT ********************************************/
*                                                               02S0374
*         END;                                                  01S0374
@RF00336 DS    0H                                               01S0375
*       IF CSAACR='1'B              /* HAS A CPU FAILURE OCCURED     */
*         THEN                                                  01S0375
@RF00274 TM    CSAACR(CXSAPTR),B'00010000'                      01S0375
         BNO   @RF00375                                         01S0375
*         DO;                       /* IF SO, PROCESS FOR ACR        */
*                                                               02S0377
*/*** START OF ACR SEGMENT *******************************************/
*/*                                                                  */
*/* ACR - PERFORMS THE CONSOLE SWITCH FUNCTION FOR EVERY CONSOLE     */
*/*       ON THE FAILING CPU.  IOS HAS MARKED THE AFFECTED CONSOLES  */
*/*       OFFLINE AND HAS TURNED ON THE VARY COMMAND HIERARCHY       */
*/*       REASON INDICATOR.  IF THE MASTER IS AFFECTED AND NO        */
*/*       UNAFFECTED ALTERNATE CAN BE FOUND FOR IT, A MESSAGE WILL   */
*/*       BE ISSUED ASKING THAT A VARY MSTCONS COMMAND BE ISSUED     */
*/*       OR THE SYSTEM ALARM WILL BE RUNG.  MESSAGES ARE ALSO       */
*/*       ISSUED TO THE ALTERNATE CONSOLES INFORMING THEM OF THEIR   */
*/*       NEW FUNCTIONS.                                             */
*/*                                                                  */
*/* INPUT - UCBONLI=0 AFFECTED CONSOLES ARE MARKED OFFLINE           */
*/*         UCBSYSR=1 DEVICE MUST BE IN CONSOLE STATUS               */
*/*         UCBVHRSN=1 INDICATES CONSOLE IS AFFECTED BY THE FAILING  */
*/*                    CPU                                           */
*/*         MASTERI= UCME ADDR OF INPUT HALF OF MASTER CONSOLE       */
*/*         MASTERO= UCME ADDR OF OUTPUT HALF OF MASTER OR 0         */
*/*                                                                  */
*/* OUTPUT - NONE.                                                   */
*/*                                                                  */
*/********************************************************************/
*                                                               02S0377
*           /*********************************************************/
*           /*                                                       */
*           /* SCAN ALL THE UCMES AND FLAG THOSE CONSOLES AND THEIR  */
*           /* COMPOSITE HALVES IF THEY ARE AFFECTED BY THE FAILING  */
*           /* CPU.                                                  */
*           /*                                                       */
*           /*********************************************************/
*                                                               02S0377
*           DO UCMDVEPT=UCMVEA TO UCMVEL BY UCMVEZ;             02S0377
         L     UCMDVEPT,UCMVEA(,UCMBASPT)                       02S0377
         B     @DE00377                                         02S0377
@DL00377 DS    0H                                               02S0378
*             IF UCBONLI='0'B       /* IF CONSOLE IS MARKED OFFLINE  */
*                 &UCBSYSR='1'B     /* AND DEVICE IS IN CONSOLE 02S0378
*                                      STATUS                        */
*                 &UCBVHRSN='1'B THEN/* AND AFFECTED BY ACR          */
         L     @11,UCBPTR(,UCMDVEPT)                            02S0378
         TM    UCBSYSR(@11),B'00000010'                         02S0378
         BNO   @RF00378                                         02S0378
         TM    UCBONLI(@11),B'10000000'                         02S0378
         BNZ   @RF00378                                         02S0378
         TM    UCBVHRSN(@11),B'00000010'                        02S0378
         BNO   @RF00378                                         02S0378
*               DO;                 /* YES,                          */
*                 UCMVHRSN='1'B;    /* SET AFFECTED BY ACR/VCPU FLAG
*                                      IN UCME                       */
         OI    UCMVHRSN(UCMDVEPT),B'00000001'                   02S0380
*                 IF UCMCOMPC^=ZERO THEN/* COMPOSITE CONSOLE ?       */
         L     @11,UCMCOMPC(,UCMDVEPT)                          02S0381
         LTR   @11,@11                                          02S0381
         BZ    @RF00381                                         02S0381
*                   UCMCOMPC->UCMVHRSN='1'B;/* YES, INDICATE OTHER
*                                      HALF IS ALSO AFFECTED         */
         OI    UCMVHRSN(@11),B'00000001'                        02S0382
*               END;                                            02S0383
@RF00381 DS    0H                                               02S0384
*           END;                                                02S0384
@RF00378 AL    UCMDVEPT,UCMVEZ(,UCMBASPT)                       02S0384
@DE00377 C     UCMDVEPT,UCMVEL(,UCMBASPT)                       02S0384
         BNH   @DL00377                                         02S0384
*           OLDMAST=MASTERI;        /* SAVE PTR TO OLD MASTER        */
*                                                               02S0385
         L     @11,MASTERI                                      02S0385
         ST    @11,OLDMAST                                      02S0385
*           /*********************************************************/
*           /*                                                       */
*           /* IF THE MASTER IS AFFECTED, FIRST SELECT AN ALTERNATE  */
*           /* FOR IT                                                */
*           /*                                                       */
*           /*********************************************************/
*                                                               02S0386
*           IF MASTERI->UCMVHRSN='1'B THEN/* IS THE MASTER AFFECTED? */
         TM    UCMVHRSN(@11),B'00000001'                        02S0386
         BNO   @RF00386                                         02S0386
*             DO;                   /* YES,                          */
*               FAILI=MASTERI;      /* SET PTR TO INPUT HALF OF 02S0388
*                                      FAILING                       */
         ST    @11,FAILI                                        02S0388
*               FAILO=MASTERO;      /* SET PTR TO OUTPUT HALF OF
*                                      FAILING                       */
         MVC   FAILO(4),MASTERO                                 02S0389
*               CALL FINDALT;       /* SELECT AN ALTERNATE           */
         BAL   @14,FINDALT                                      02S0390
*               CALL SWCONS;        /* SWITCH FUNCTIONS AND MESSAGES
*                                      TO THE ALTERNATE IF ONE WAS
*                                      SELECTED OR PROCESS A NO 02S0391
*                                      MASTER CONDITION              */
         BAL   @14,SWCONS                                       02S0391
*               UCMSYSD='0'B;       /* TURN OFF MASTER IS FAILING
*                                      FLAG                          */
*                                                               02S0392
         NI    UCMSYSD(UCMMCSPT),B'11101111'                    02S0392
*               /*****************************************************/
*               /*                                                   */
*               /* MARK OLD MASTER SO IT CAN CLOSE. BOTH HALVES WILL */
*               /* BE MARKED IF IT IS A COMPOSITE.                   */
*               /*                                                   */
*               /*****************************************************/
*                                                               02S0393
*               DO CONTROL=MASTERI TO MASTERO BY UCMVEZ;        02S0393
         L     @11,MASTERI                                      02S0393
         B     @DE00393                                         02S0393
@DL00393 DS    0H                                               02S0394
*                 CONTROL->UCMUCB->UCBONLIX='1'B;/* SET ONLINE SO
*                                      CONSOLE CAN CLOSE AND GO 02S0394
*                                      OFFLINE                       */
*                 CONTROL->UCMUCB->UCBCHGSX='1'B;/* GOING OFFLINE    */
*                 CONTROL->UCMUCB->UCBDADIX='1'B;/* GOING OUT OF
*                                      CONSOLE STATUS                */
         L     @11,UCMUCB(,@11)                                 02S0396
         L     @04,UCBONLIX-3(,@11)                             02S0396
@GL00021 LR    @02,@04                                          02S0396
         O     @02,@CF03967                                     02S0396
         CS    @04,@02,UCBONLIX-3(@11)                          02S0396
         BNE   @GL00021                                         02S0396
*               END;                                            02S0397
         L     @11,CONTROL                                      02S0397
         AL    @11,UCMVEZ(,UCMBASPT)                            02S0397
@DE00393 ST    @11,CONTROL                                      02S0397
         C     @11,MASTERO                                      02S0397
         BNH   @DL00393                                         02S0397
*               IF NEWI^=ZERO THEN  /* WAS AN ALTERNATE SELECTED ?   */
         LTR   NEWI,NEWI                                        02S0398
         BZ    @RF00398                                         02S0398
*                 DO;               /* YES, SET PTRS TO THE NEW 02S0399
*                                      MASTER                        */
*                   MASTERI=NEWI;   /* SET PTR TO INPUT HALF OF NEW
*                                      MASTER                        */
         ST    NEWI,MASTERI                                     02S0400
*                   MASTERO=NEWI->UCMCOMPC;/* SET PTR TO OUTPUT HALF
*                                      OF NEW MASTER IF COMPOSITE OR
*                                      0                             */
         MVC   MASTERO(4),UCMCOMPC(NEWI)                        02S0401
*                 END;                                          02S0402
*             END;                                              02S0403
*                                                               02S0403
@RF00398 DS    0H                                               02S0404
*           /*********************************************************/
*           /*                                                       */
*           /* PROCESS REMAINING CONSOLES AFFECTED BY ACR. IF THE    */
*           /* MASTER WAS AFFECTED BUT NO ALTERNATE COULD BE FOUND   */
*           /* FOR IT, THE AFFECTED SECONDARY CONSOLES ARE SWITCHED  */
*           /* TO THE OLD MASTER IF NECESSARY. WHEN A VARY MSTCONS   */
*           /* COMMAND IS SUBSEQUENTLY ISSUED, ALL THE SECONDARY     */
*           /* CONSOLES FUNCTIONS AND MESSAGES WILL THEN BE          */
*           /* TRANSFERRED FROM THE OLD MASTER TO THE NEW.           */
*           /*                                                       */
*           /*********************************************************/
*                                                               02S0404
*           RFY                                                 02S0404
*             UCMLIST BASED(PATHUCME);                          02S0404
@RF00386 DS    0H                                               02S0405
*           DO PATHUCME=UCMVEA TO UCMVEL BY UCMVEZ;             02S0405
         L     @11,UCMVEA(,UCMBASPT)                            02S0405
         B     @DE00405                                         02S0405
@DL00405 DS    0H                                               02S0406
*             IF PATHUCME^=OLDMAST  /* IF THIS IS NOT THE OLD MASTER */
*                 &UCMVHRSN='1'B THEN/* AND THE CONSOLE IS AFFECTED
*                                      BY ACR                        */
         C     @11,OLDMAST                                      02S0406
         BE    @RF00406                                         02S0406
         TM    UCMVHRSN(@11),B'00000001'                        02S0406
         BNO   @RF00406                                         02S0406
*               DO;                 /* THEN PROCESS THE AFFECTED
*                                      CONSOLE                       */
*                 FAILI=PATHUCME;   /* SET PTR TO INPUT HALF OF 02S0408
*                                      FAILING                       */
         ST    @11,FAILI                                        02S0408
*                 FAILO=UCMCOMPC;   /* SET PTR TO OUTPUT HALF IF
*                                      COMPOSITE OR 0                */
         MVC   FAILO(4),UCMCOMPC(@11)                           02S0409
*                 CALL FINDALT;     /* SELECT AN UNAFFECTED ALTERNATE
*                                      OR THE MASTER FOR THE NEW
*                                      CONSOLE                       */
         BAL   @14,FINDALT                                      02S0410
*                 CALL SWCONS;      /* PERFORM THE CONSOLE SWITCH    */
*                                                               02S0411
         BAL   @14,SWCONS                                       02S0411
*                 /***************************************************/
*                 /*                                                 */
*                 /* MARK CONSOLE SO IT CAN CLOSE. BOTH HALVES WILL  */
*                 /* BE MARKED IF IT IS A COMPOSITE                  */
*                 /*                                                 */
*                 /***************************************************/
*                                                               02S0412
*                 DO CONTROL=FAILI TO FAILO BY UCMVEZ;          02S0412
         L     @11,FAILI                                        02S0412
         B     @DE00412                                         02S0412
@DL00412 DS    0H                                               02S0413
*                   CONTROL->UCMUCB->UCBONLIX='1'B;/* SET ONLINE SO
*                                      CONSOLE CAN CLOSE             */
*                   CONTROL->UCMUCB->UCBCHGSX='1'B;/* GOING OFFLINE  */
*                   CONTROL->UCMUCB->UCBDADIX='1'B;/* GOING OUT OF
*                                      CONSOLE STATUS                */
         L     @11,UCMUCB(,@11)                                 02S0415
         L     @04,UCBONLIX-3(,@11)                             02S0415
@GL00023 LR    @02,@04                                          02S0415
         O     @02,@CF03967                                     02S0415
         CS    @04,@02,UCBONLIX-3(@11)                          02S0415
         BNE   @GL00023                                         02S0415
*                 END;                                          02S0416
         L     @11,CONTROL                                      02S0416
         AL    @11,UCMVEZ(,UCMBASPT)                            02S0416
@DE00412 ST    @11,CONTROL                                      02S0416
         C     @11,FAILO                                        02S0416
         BNH   @DL00412                                         02S0416
*               END;                                            02S0417
*             IF UCMCOMPC^=ZERO THEN/* IS THE CONSOLE A COMPOSITE?   */
@RF00406 L     @11,PATHUCME                                     02S0418
         ICM   @04,15,UCMCOMPC(@11)                             02S0418
         BZ    @RF00418                                         02S0418
*               PATHUCME=PATHUCME+UCMVEZ;/* BUMP UCME PTR TO THE
*                                      OUTPUT HALF SO IT WILL BE
*                                      SKIPPED                       */
         AL    @11,UCMVEZ(,UCMBASPT)                            02S0419
         ST    @11,PATHUCME                                     02S0419
*           END;                    /* END OF UCME LOOP              */
@RF00418 L     @11,PATHUCME                                     02S0420
         AL    @11,UCMVEZ(,UCMBASPT)                            02S0420
@DE00405 ST    @11,PATHUCME                                     02S0420
         C     @11,UCMVEL(,UCMBASPT)                            02S0420
         BNH   @DL00405                                         02S0420
*           RFY                                                 02S0421
*             UCMLIST BASED(UCMDVEPT);                          02S0421
*                                                               02S0421
*/*** END OF ACR SEGMENT *********************************************/
*                                                               02S0422
*         END;                                                  01S0422
*     END;                                                      01S0423
*                                                               01S0423
@RF00375 DS    0H                                               01S0424
*   /*****************************************************************/
*   /*                                                               */
*   /* ALL MAINLINE PROCESSING IS COMPLETED, PERFORM WRAPUP.         */
*   /*                                                               */
*   /*****************************************************************/
*                                                               01S0424
*                                                               02S0424
*/*** START OF WRAPUP SEGMENT ****************************************/
*/*                                                                  */
*/* WRAPUP - PERFORMS END FUNCTIONS WHICH REQUIRE THE LOCKS TO       */
*/*          BE FREED.                                               */
*/*                                                                  */
*/* INPUT - NCCNOW  =1 IF A NO-CONSOLES CONDITION WAS        @ZA18879*/
*/*                    ENTERED THIS TIME THROUGH IEAVSWCH.   @ZA18879*/
*/*         RINGBELL=1 IF CONSOLE ALARM SHOULD BE RUNG               */
*/*         RINGPOWR=1 IF THE POWER AND COOLING ALARM SHOULD @G51APSS*/
*/*                    BE SOUNDED                            @G51APSS*/
*/*         AMFAMSG=1  IF VARY MSTCONS MSG (IEE141A) SHOULD BE       */
*/*                    ISSUED                                        */
*/*         HCSUSP=1   IF HARDCOPY SUSPENDED MSG (IEA964I) SHOULD BE */
*/*                    ISSUED.                                       */
*/*         POSTREQ=1  IF XMPOST OF COMMTASK (UCMOECB) SHOULD BE     */
*/*                    DONE                                          */
*/*                                                                  */
*/* OUTPUT - NONE                                                    */
*/*                                                                  */
*/********************************************************************/
*                                                               02S0424
*   UCMSYSD='0'B;                   /* TURN OFF MASTER-IS-FAILING    */
*                                                               02S0424
@RC00226 NI    UCMSYSD(UCMMCSPT),B'11101111'                    02S0424
*   /*****************************************************************/
*   /*                                                               */
*   /* CLEAR UCMVHRSN FLAGS                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0425
*   DO CONTROL=UCMVEA TO UCMVEL BY UCMVEZ;                      02S0425
         L     @11,UCMVEA(,UCMBASPT)                            02S0425
         B     @DE00425                                         02S0425
@DL00425 DS    0H                                               02S0426
*     CONTROL->UCMVHRSN='0'B;       /* TURN OFF AFFECTED BY ACR/VCPU
*                                      FLAG                          */
         NI    UCMVHRSN(@11),B'11111110'                        02S0426
*   END;                                                        02S0427
*                                                               02S0427
         AL    @11,UCMVEZ(,UCMBASPT)                            02S0427
@DE00425 ST    @11,CONTROL                                      02S0427
         C     @11,UCMVEL(,UCMBASPT)                            02S0427
         BNH   @DL00425                                         02S0427
*   /*****************************************************************/
*   /*                                                               */
*   /* SHOULD MESSAGE IEE141A BE DOMED?                      @G51APSS*/
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0428
*   IF UCMPNMCC^=ZERO&              /* ISSUE DOM IF A DOMID  @ZA19261*/
*       (CSAVMST='1'B×              /* EXISTS AND V MSTCONS  @ZA19261*/
*       CSAEXTI='1'B×               /* OR EXTERNAL INTERRUPT @ZA19261*/
*       AMFAMSG='1'B) THEN          /* OR MSG IEE141A IS TO BE ISSUED
*                                                            @ZA19261*/
         L     @11,UCMFXPTR(,UCMBASPT)                          02S0428
         L     @11,UCMPXPTR(,@11)                               02S0428
         ICM   @04,15,UCMPNMCC(@11)                             02S0428
         BZ    @RF00428                                         02S0428
         TM    CSAVMST(CXSAPTR),B'00001100'                     02S0428
         BNZ   @RT00428                                         02S0428
         TM    AMFAMSG,B'01000000'                              02S0428
         BNO   @RF00428                                         02S0428
@RT00428 DS    0H                                               02S0429
*     DO;                           /* FOR IEE141A MSG.      @ZA08472*/
*       UCMAMFA='0'B;               /* TURN OFF ACCEPT VARY  @ZA08472*/
         NI    UCMAMFA(UCMBASPT),B'11110111'                    02S0430
*       RFY                                                     02S0431
*        (REG01) RSTD;              /* RESTRICT REG1 FOR DOM @ZA08472*/
*       CALL FRLOCKS;               /* RELSE LOCKS FOR SVC87 @ZA08472*/
         BAL   @14,FRLOCKS                                      02S0432
*       REG01=UCMPNMCC;             /* GET DOMID AND DOM IT. @ZA08472*/
         L     @11,UCMFXPTR(,UCMBASPT)                          02S0433
         L     @11,UCMPXPTR(,@11)                               02S0433
         L     REG01,UCMPNMCC(,@11)                             02S0433
*       GEN;                                                    02S0434
*                                  /*                        @ZA08472*/
         DOM   MSG=(1)                                         @ZA08472
*       RFY                                                     02S0435
*        (REG01) UNRSTD;            /* RELEASE REG1 AFTER DOM   02S0435
*                                                            @ZA08472*/
*       CALL GETLOCKS;              /* REOBTAIN LOCKS        @ZA08472*/
         BAL   @14,GETLOCKS                                     02S0436
*       UCMPNMCC=ZERO;              /* INDICATE NO DOMID TO BE  02S0437
*                                                            @ZA08472*/
         L     @11,UCMFXPTR(,UCMBASPT)                          02S0437
         L     @11,UCMPXPTR(,@11)                               02S0437
         SLR   @04,@04                                          02S0437
         ST    @04,UCMPNMCC(,@11)                               02S0437
*     END;                          /* DOMED.                @ZA08472*/
*                                                               02S0438
*   /*****************************************************************/
*   /*                                                               */
*   /* SHOULD MESSAGE IEA420A BE DOMED?                      @G51APSS*/
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0439
*   IF UCMPNCC^=ZERO&               /* DOES A DOM ID FOR IEA420A
*                                      EXIST AND             @G51APSS*/
*       UCMSYSE='0'B THEN           /* A NO-CONSOLES CONDITION NO
*                                      LONGER EXISTS?        @G51APSS*/
@RF00428 L     @11,UCMFXPTR(,UCMBASPT)                          02S0439
         L     @11,UCMPXPTR(,@11)                               02S0439
         L     @11,UCMPNCC(,@11)                                02S0439
         LTR   @11,@11                                          02S0439
         BZ    @RF00439                                         02S0439
         TM    UCMSYSE(UCMMCSPT),B'00001000'                    02S0439
         BNZ   @RF00439                                         02S0439
*     DO;                           /* YES                   @G51APSS*/
*       RFY                                                     02S0441
*         REG01 RSTD;               /*                       @G51APSS*/
*       REG01=UCMPNCC;              /* GET DOM ID            @G51APSS*/
         LR    REG01,@11                                        02S0442
*       CALL FRLOCKS;               /* RELEASE THE LOCKS     @G51APSS*/
         BAL   @14,FRLOCKS                                      02S0443
*       DO;                         /* DOM MSG(REG01)                */
*         RFY                                                   02S0445
*          (GPR00F,                                             02S0445
*           GPR01F) RSTD;           /* RESTRICT REGISTERS            */
*         GPR01F=REG01;             /* MOVE IN MESSAGE ID            */
*         GPR00F=0;                 /* SHOW MSG SPECIFIED            */
         SLR   GPR00F,GPR00F                                    02S0447
*         SVC(87);                  /* ISSUE DOM SVC                 */
         SVC   87                                               02S0448
*         RFY                                                   02S0449
*          (GPR00F,                                             02S0449
*           GPR01F) UNRSTD;         /* RELEASE REGISTERS             */
*       END;                        /* DOM MSG(REG01) DOM IEA420A
*                                                            @G51APSS*/
*       RFY                                                     02S0451
*         REG01 UNRSTD;             /*                       @G51APSS*/
*       CALL GETLOCKS;              /* OBTAIN THE LOCKS      @G51APSS*/
         BAL   @14,GETLOCKS                                     02S0452
*       UCMPNCC=ZERO;               /*                       @G51APSS*/
         L     @11,UCMFXPTR(,UCMBASPT)                          02S0453
         L     @11,UCMPXPTR(,@11)                               02S0453
         SLR   @04,@04                                          02S0453
         ST    @04,UCMPNCC(,@11)                                02S0453
*     END;                          /*                       @G51APSS*/
*                                                               02S0454
*   /*****************************************************************/
*   /*                                                               */
*   /* SHOULD ANY ALARMS BE SOUNDED?                         @G51APSS*/
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0455
*   IF RINGBELL=YES THEN            /* SHOULD CONSOLE ALARM BE RUNG
*                                                            @G51APSS*/
@RF00439 TM    RINGBELL,B'01000000'                             02S0455
         BNO   @RF00455                                         02S0455
*     CALL SOUNDBEL;                /* YES, RING CONSOLE ALARM  02S0456
*                                                            @G51APSS*/
         BAL   @14,SOUNDBEL                                     02S0456
*   IF RINGPOWR=YES THEN            /* SHOULD POWER AND COOLING ALARM
*                                      BE SOUNDED?           @G51APSS*/
@RF00455 TM    RINGPOWR,B'00100000'                             02S0457
         BNO   @RF00457                                         02S0457
*     CALL SOUNDPWR;                /* YES                           */
*                                                               02S0458
         BAL   @14,SOUNDPWR                                     02S0458
*   /*****************************************************************/
*   /*                                                               */
*   /* DOES A NO-CONSOLES CONDITION EXIST? IF SO ISSUE MESSAGE       */
*   /* IEA420A                                               @G51APSS*/
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0459
*   IF NCCNOW=YES×                  /* DID THE NO-CONSOLES CONDITION
*                                      OCCUR THIS TIME THRU SWCH?
*                                                            @ZA18879*/
*       UCMSYSL='1'B THEN           /* OR DID DSP ABEND WHILE TRYING
*                                      TO OPEN/CLOSE A DEVICE IN A NO
*                                      CONSOLES CONDITION    @G51APSS*/
@RF00457 TM    NCCNOW,B'01000000'                               02S0459
         BO    @RT00459                                         02S0459
         TM    UCMSYSL(UCMMCSPT),B'00010000'                    02S0459
         BNO   @RF00459                                         02S0459
@RT00459 DS    0H                                               02S0460
*     DO;                           /* YES                   @G51APSS*/
*       UCMSYSL='0'B;               /* RESET FOR NEXT NCC    @G51APSS*/
*       UCMSYSP='0'B;               /*                       @G51APSS*/
         NI    UCMSYSL(UCMMCSPT),B'11101110'                    02S0462
*       CALL SAVEINDX;              /* SET UP DEVICES SO A NEW MASTER
*                                      CONSOLE CAN BE CHOSEN @G51APSS*/
         BAL   @14,SAVEINDX                                     02S0463
*       CALL SUBSWTCH;              /* NOTIFY SUBSYSTEM OF      02S0464
*                                      NO-CONSOLES CONDITION @G51APSS*/
         BAL   @14,SUBSWTCH                                     02S0464
*       CALL FRLOCKS;               /* RELEASE LOCKS         @G51APSS*/
         BAL   @14,FRLOCKS                                      02S0465
*       RFY                                                     02S0466
*        (REG00,                                                02S0466
*         REG01) RSTD;              /*                       @G51APSS*/
*       REG00=ZERO;                 /* CLEAR FOR MLWTO       @G51APSS*/
         SLR   REG00,REG00                                      02S0467
*       GEN SETS(REG01);                                        02S0468
*                                   /* ISSUE IEA420A         @G51APSS*/
         WTO   ('IEA420A NO FULL CAPABILITY CONSOLES',D),              X
               ('     TO RESTORE MASTER CONSOLE:',D),                  X
               ('     1) PRESS ENTER, REQUEST, OR END ON ANY AVAILABLE X
               CONSOLE',D),                                            X
               ('     2) PRESS THE EXTERNAL INTERRUPT KEY',DE),        X
               DESC=(2),MCSFLAG=(BRDCST)                       @G51APSS
*       UCMPNCC=REG01;              /* SAVE WTO DOM ID       @G51APSS*/
         L     @11,UCMFXPTR(,UCMBASPT)                          02S0469
         L     @11,UCMPXPTR(,@11)                               02S0469
         ST    REG01,UCMPNCC(,@11)                              02S0469
*       RFY                                                     02S0470
*        (REG00,                                                02S0470
*         REG01) UNRSTD;            /*                       @G51APSS*/
*       CALL GETLOCKS;              /* OBTAIN THE LOCKS      @G51APSS*/
         BAL   @14,GETLOCKS                                     02S0471
*       UCMFATCN=ZERO;              /* ALLOW IEAVVCRA TO ACCEPT A
*                                      CANDIDATE FOR THE NEW MASTER
*                                      CONSOLE               @G51APSS*/
         L     @11,UCMFXPTR(,UCMBASPT)                          02S0472
         SLR   @07,@07                                          02S0472
         ST    @07,UCMFATCN(,@11)                               02S0472
*     END;                          /*                       @G51APSS*/
*   CALL FRLOCKS;                   /* RELEASE LOCKS         @G51APSS*/
*                                                               02S0474
@RF00459 BAL   @14,FRLOCKS                                      02S0474
*   /*****************************************************************/
*   /*                                                               */
*   /* SHOULD MESSAGE IEE141A BE ISSUED?                     @G51APSS*/
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0475
*   IF AMFAMSG='1'B THEN            /* SHOULD VARY MSTCONS MSG BE
*                                      ISSUED                        */
         TM    AMFAMSG,B'01000000'                              02S0475
         BNO   @RF00475                                         02S0475
*     DO;                           /* YES                           */
*       UCMAMFA='1'B;               /* INDICATE ACCEPT VARY MSTCONS
*                                      FROM ANYONE           @ZA19261*/
         OI    UCMAMFA(UCMBASPT),B'00001000'                    02S0477
*       RFY                                                     02S0478
*         REG01 RSTD;               /*                       @G51APSS*/
*       GEN;                                                    02S0479
*                                                         /* @ZA08472*/
         WTO 'IEE141A  MASTER AND ALL ALTERNATES UNAVAILABLE - ISSUE VA*
               RY MSTCONS',DESC=2,MCSFLAG=BRDCST               @ZA08472
*       UCMPNMCC=REG01;             /* SAVE WTO DOM ID FOR DOM  02S0480
*                                                            @ZA08472*/
         L     @11,UCMFXPTR(,UCMBASPT)                          02S0480
         L     @11,UCMPXPTR(,@11)                               02S0480
         ST    REG01,UCMPNMCC(,@11)                             02S0480
*       RFY                                                     02S0481
*         REG01 UNRSTD;             /*                       @G51APSS*/
*     END;                                                      02S0482
*                                                               02S0482
*   /*****************************************************************/
*   /*                                                               */
*   /* SHOULD MESSAGE IEA964I BE ISSUED?                     @G51APSS*/
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0483
*   IF HCSUSP='1'B THEN             /* SHOULD HC SUSPENDED MSG BE
*                                      ISSUED                        */
@RF00475 TM    HCSUSP,B'10000000'                               02S0483
         BNO   @RF00483                                         02S0483
*     DO;                           /* YES                           */
*       GEN;                                                    02S0485
         WTO 'IEA964I HARDCOPY SUSPENDED, NO HARDCOPY DEVICE AVAILABLE'*
               ,ROUTCDE=1,DESC=4
*     END;                                                      02S0486
*                                                               02S0486
*   /*****************************************************************/
*   /*                                                               */
*   /* SHOULD OECB BE POSTED?                                @G51APSS*/
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0487
*   IF MSGFLAG1=ZERO&POSTREQ='1'B THEN/* IF NO WTOS WERE ISSUED AND A
*                                      POST IS REQUIRED              */
@RF00483 CLI   MSGFLAG1,0                                       02S0487
         BNE   @RF00487                                         02S0487
         TM    POSTREQ,B'00000010'                              02S0487
         BNO   @RF00487                                         02S0487
*     DO;                           /* THEN DO A XMPOST OF THE WTO
*                                      ECB                           */
*       DO;                         /* POST (UCMOECB) ASCB(ASCB)
*                                      ERRET(CVTBRET)                */
*         I002=I002&&I002;          /* INITIALIZE LIST               */
         XC    I002(12),I002                                    02S0490
*         I00201=ADDR(UCMOECB);     /* ECB ADDRESS                   */
         LA    @11,UCMOECB(,UCMBASPT)                           02S0491
         ST    @11,I00201                                       02S0491
*         I00202=ADDR(ASCB);        /* ASCB ADDRESS                  */
         MVC   I00202(4),ASCBPTR(UCMBASPT)                      02S0492
*         I00203=ADDR(CVTBRET);     /* ERRET ADDRESS                 */
         L     @07,LCVTPTR                                      02S0493
         LA    @07,CVTBRET(,@07)                                02S0493
         ST    @07,I00203                                       02S0493
*         RESPECIFY                                             02S0494
*          (GPR00F,                                             02S0494
*           GPR01P) RESTRICTED;                                 02S0494
*         GPR00F=0;                 /* POST CODE IN R0               */
         SLR   GPR00F,GPR00F                                    02S0495
*         GPR01P=ADDR(I002);        /* PARMLIST ADDR                 */
         LA    GPR01P,I002                                      02S0496
*         GPR01P=GPR01P×'80000000'X;/* SET LIST FORM IND             */
         O     GPR01P,@CF03732                                  02S0497
*         SVC(2);                   /* ISSUE POST SVC                */
         SVC   2                                                02S0498
*         RESPECIFY                                             02S0499
*          (GPR00F,                                             02S0499
*           GPR01P) UNRESTRICTED;                               02S0499
*       END;                        /* POST (UCMOECB) ASCB(ASCB)
*                                      ERRET(CVTBRET)                */
*     END;                                                      02S0501
*                                                               02S0501
*/*** END OF WRAPUP SEGMENT ******************************************/
*                                                               02S0502
*   RETURN CODE(RETCODE) TO RETURNPT;/* RETURN TO SVC SLIH           */
@RF00487 L     @07,CSAXA(,CXSAPTR)                              01S0502
         L     @04,RETCODE                                      01S0502
         L     @13,4(,@13)                                      01S0502
         L     @00,@SIZDATD                                     01S0502
         LR    @01,@09                                          01S0502
         FREEMAIN R,LV=(0),A=(1)
         LR    @14,@07                                          01S0502
         LR    @15,@04                                          01S0502
         BR    @14                                              01S0502
*                                                               01S0503
*   /*****************************************************************/
*   /*                                                               */
*   /* NOW INCLUDE THE SUBROUTINES                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                               01S0503
         EJECT
*                                                               02S0503
*/*** START OF EXTINNCC SUBROUTINE ***********************************/
*/*                                                                  */
*/* EXTINNCC - THE EXTERNAL INTERRUPT ECB HAS BEEN POSTED    @G51APSS*/
*/*            AND A NO-CONSOLES CONDITION EXISTS.           @G51APSS*/
*/*                                                                  */
*/* FUNCTION - RESTORE THE ATTENTION INDICES WHICH WERE      @G51APSS*/
*/*            SAVED WHEN THE NO-CONSOLES CONDITION AROSE.   @G51APSS*/
*/*            IF NO CANDIDATE FOR THE NEW MASTER WAS CHOSEN @G51APSS*/
*/*            THEN MARK THE OLD MASTER SO IT APPEARS AS IF  @G51APSS*/
*/*            A VARY CONSOLE WAS ISSUED FOR IT.             @G51APSS*/
*/*            CAUSE THE OLD MASTERS FUNCTION TO SWITCH TO   @G51APSS*/
*/*            THE CANDIDATE.                                @G51APSS*/
*/*                                                                  */
*/* INPUT    - UCMFATCN - ADDR OF CANDIDATES UCME OR ZERO    @G51APSS*/
*/*                                                                  */
*/* OUTPUT   - OLD MASTERS FUNCTIONS SWITCHED TO NEW MASTER  @G51APSS*/
*/*                                                                  */
*/********************************************************************/
*                                                               02S0503
*EXTINNCC:                                                      02S0503
*   PROC OPTIONS(SAVE);             /*                       @G51APSS*/
@EL00001 L     @13,4(,@13)                                      02S0503
@EF00001 L     @00,@SIZDATD                                     02S0503
         LR    @01,@09                                          02S0503
         FREEMAIN R,LV=(0),A=(1)
@ER00001 BR    @14                                              02S0503
EXTINNCC STM   @14,@02,@SA00002                                 02S0503
         STM   @04,@12,@SA00002+20                              02S0503
*   POSTREQ='1'B;                   /* MARK THAT POST OF OECB MUST BE
*                                      DONE                  @G51APSS*/
         OI    POSTREQ,B'00000010'                              02S0504
*   CALL ENQQ4;                     /* TRY TO OBTAIN Q4      @G51APSS*/
*                                                               02S0505
         BAL   @14,ENQQ4                                        02S0505
*   /*****************************************************************/
*   /*                                                               */
*   /* LOOP THRU UCMES RESTORING THE ATTN INDICES AND UCBSYSR        */
*   /*                                                       @G51APSS*/
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0506
*   DO UCMDVEPT=UCMVEA TO UCMVEL BY UCMVEZ;/*                @G51APSS*/
         L     UCMDVEPT,UCMVEA(,UCMBASPT)                       02S0506
         B     @DE00506                                         02S0506
@DL00506 DS    0H                                               02S0507
*     IF UCMEFLGA='1'B THEN         /* WAS ATTN INDEX SAVED? @G51APSS*/
         L     @11,UCMFEXTP(,UCMDVEPT)                          02S0507
         TM    UCMEFLGA(@11),B'10000000'                        02S0507
         BNO   @RF00507                                         02S0507
*       IF UCBATI=COMTSKAX THEN     /* IS ATTN INDEX FOR DEVICE THE
*                                      SAME AS WHAT WAS PLACED THERE
*                                      WHEN THE NO-CONSOLES CONDITION
*                                      AROSE?                @G51APSS*/
         L     @04,UCBPTR(,UCMDVEPT)                            02S0508
         L     @04,UCBEXTPT(,@04)                               02S0508
         CLI   UCBATI(@04),4                                    02S0508
         BNE   @RF00508                                         02S0508
*         UCBATI=UCMEFATT;          /* YES, RESTORE ATTN INDEX  02S0509
*                                                            @G51APSS*/
         MVC   UCBATI(1,@04),UCMEFATT(@11)                      02S0509
*     UCMEFLGA='0'B;                /* MARK ATTN INDEX SAVED IS NOT
*                                      VALID                 @G51APSS*/
@RF00508 DS    0H                                               02S0510
@RF00507 L     @11,UCMFEXTP(,UCMDVEPT)                          02S0510
         NI    UCMEFLGA(@11),B'01111111'                        02S0510
*     IF UCMEFLGB='1'B THEN         /* WAS UCBSYSR FORCED ON @G51APSS*/
         TM    UCMEFLGB(@11),B'01000000'                        02S0511
         BNO   @RF00511                                         02S0511
*       IF UCMDVEPT^=UCMFATCN THEN  /* YES, IS THIS THE CANDIDATE?
*                                                            @G51APSS*/
         L     @11,UCMFXPTR(,UCMBASPT)                          02S0512
         C     UCMDVEPT,UCMFATCN(,@11)                          02S0512
         BE    @RF00512                                         02S0512
*         UCBSYSRX='0'B;            /* NO, RESTORE FLAG      @G51APSS*/
         L     @03,UCBPTR(,UCMDVEPT)                            02S0513
         L     @11,UCBSYSRX-3(,@03)                             02S0513
@GL00029 LR    @04,@11                                          02S0513
         N     @04,@CF03973                                     02S0513
         CS    @11,@04,UCBSYSRX-3(@03)                          02S0513
         BNE   @GL00029                                         02S0513
*     UCMEFLGB='0'B;                /* MARK THAT UCBSYSR IS NOT 02S0514
*                                      FORCED ON ANYMORE     @G51APSS*/
@RF00512 DS    0H                                               02S0514
@RF00511 L     @11,UCMFEXTP(,UCMDVEPT)                          02S0514
         NI    UCMEFLGB(@11),B'10111111'                        02S0514
*   END;                            /* OF LOOP TO RESTORE ATTN  02S0515
*                                      INDICES               @G51APSS*/
         AL    UCMDVEPT,UCMVEZ(,UCMBASPT)                       02S0515
@DE00506 C     UCMDVEPT,UCMVEL(,UCMBASPT)                       02S0515
         BNH   @DL00506                                         02S0515
*   IF UCMFATCN=ZERO THEN           /* WAS A CANDIDATE CHOSEN?  02S0516
*                                                            @G51APSS*/
         L     @11,UCMFXPTR(,UCMBASPT)                          02S0516
         ICM   @04,15,UCMFATCN(@11)                             02S0516
         BNZ   @RF00516                                         02S0516
*     DO;                           /* NO, USE OLD MASTER    @G51APSS*/
*                                                               02S0517
*       /*************************************************************/
*       /*                                                           */
*       /* MARK THE OLD MASTER SO IT APPEARS AS IF A VARY CONSOLE    */
*       /* COMMAND WAS ISSUED FOR IT                         @G51APSS*/
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0518
*       UCMDVEPT=MASTERI;           /* GET MASTERS UCME ADDR @G51APSS*/
         L     UCMDVEPT,MASTERI                                 02S0518
*       DO I=1 TO 2 WHILE UCMDVEPT^=ZERO;/*                  @G51APSS*/
         LA    @11,1                                            02S0519
         ST    @11,I                                            02S0519
@DL00519 LTR   UCMDVEPT,UCMDVEPT                                02S0519
         BZ    @DC00519                                         02S0519
*         UCMAF='0'B;               /* ATTN PENDING OFF      @G51APSS*/
*         UCMCF='0'B;               /* CLOSE PENDING OFF     @G51APSS*/
*         UCMTA='1'B;               /* OPEN PENDING ON       @G51APSS*/
         OI    UCMTA(UCMDVEPT),B'00001000'                      02S0522
         NI    UCMAF(UCMDVEPT),B'01101111'                      02S0522
*         UCMUF='1'B;               /* DEVICE ACTIVE ON      @G51APSS*/
         OI    UCMUF(UCMDVEPT),B'00010000'                      02S0523
*         UCBDADIX='0'B;            /* CHANGING FROM CONSOLE STATE
*                                      OFF                   @G51APSS*/
*         UCBCHGSX='0'B;            /* CHANGING TO OFFLINE OFF  02S0525
*                                                            @G51APSS*/
         L     @03,UCBPTR(,UCMDVEPT)                            02S0525
         L     @11,UCBCHGSX-3(,@03)                             02S0525
@GL00030 LR    @04,@11                                          02S0525
         N     @04,@CF03977                                     02S0525
         CS    @11,@04,UCBCHGSX-3(@03)                          02S0525
         BNE   @GL00030                                         02S0525
*         UCBVORSX='0'B;            /* OFFLINE BY VARY OFF   @G51APSS*/
         L     @03,UCBPTR(,UCMDVEPT)                            02S0526
         L     @11,UCBVORSX(,@03)                               02S0526
@GL00031 LR    @04,@11                                          02S0526
         N     @04,@CF03980                                     02S0526
         CS    @11,@04,UCBVORSX(@03)                            02S0526
         BNE   @GL00031                                         02S0526
*         UCBONLIX='1'B;            /* DEVICE ONLINE         @G51APSS*/
*         UCBSYSRX='1'B;            /* DEVICE IS A CONSOLE   @G51APSS*/
         L     @03,UCBPTR(,UCMDVEPT)                            02S0528
         L     @11,UCBONLIX-3(,@03)                             02S0528
@GL00032 LR    @04,@11                                          02S0528
         O     @04,@CF03983                                     02S0528
         CS    @11,@04,UCBONLIX-3(@03)                          02S0528
         BNE   @GL00032                                         02S0528
*         UCMDVEPT=MASTERO;         /* MASTERS OUTPUT HALF   @G51APSS*/
         L     UCMDVEPT,MASTERO                                 02S0529
*       END;                        /*                       @G51APSS*/
         LA    @11,1                                            02S0530
         AL    @11,I                                            02S0530
         ST    @11,I                                            02S0530
         CH    @11,@CH00063                                     02S0530
         BNH   @DL00519                                         02S0530
@DC00519 DS    0H                                               02S0531
*       NEWI=MASTERI;               /* NEW MASTER IS OLD MASTER 02S0531
*                                                            @G51APSS*/
         L     NEWI,MASTERI                                     02S0531
*     END;                          /* OF CANDIDATE NOT CHOSEN  02S0532
*                                                            @G51APSS*/
*   ELSE                            /* A CANDIDATE WAS CHOSEN   02S0533
*                                                            @G51APSS*/
*     DO;                           /*                       @G51APSS*/
         B     @RC00516                                         02S0533
@RF00516 DS    0H                                               02S0534
*       NEWI=UCMFATCN;              /* NEW MASTER IS THE CANDIDATE
*                                                            @G51APSS*/
         L     @11,UCMFXPTR(,UCMBASPT)                          02S0534
         L     NEWI,UCMFATCN(,@11)                              02S0534
*       MASTERI->UCMUF='1'B;        /* MAKE OLD MASTER ACTIVE SO IT
*                                      WILL CLOSE            @G51APSS*/
         L     @11,MASTERI                                      02S0535
         OI    UCMUF(@11),B'00010000'                           02S0535
*       IF MASTERO^=ZERO THEN       /* MASTER A COMPOSITE?   @G51APSS*/
         L     @11,MASTERO                                      02S0536
         LTR   @11,@11                                          02S0536
         BZ    @RF00536                                         02S0536
*         MASTERO->UCMUF='1'B;      /* YES, MAKE THE OUTPUT HALF
*                                      ACTIVE SO IT WILL CLOSE  02S0537
*                                                            @G51APSS*/
         OI    UCMUF(@11),B'00010000'                           02S0537
*     END;                          /*                       @G51APSS*/
@RF00536 DS    0H                                               02S0539
*   UCMFATCN=ZERO;                  /* CLEAR CANDIDATE PTR   @G51APSS*/
@RC00516 L     @11,UCMFXPTR(,UCMBASPT)                          02S0539
         SLR   @04,@04                                          02S0539
         ST    @04,UCMFATCN(,@11)                               02S0539
*   UCMSYSE='0'B;                   /* NCC DOES NOT EXIST    @G51APSS*/
         NI    UCMSYSE(UCMMCSPT),B'11110111'                    02S0540
*   CALL DEQQ4;                     /* RELEASE Q4            @G51APSS*/
         BAL   @14,DEQQ4                                        02S0541
*   NEWO=NEWI->UCMCOMPC;            /* GET NEW MASTERS OUTPUT HALF
*                                                            @G51APSS*/
         MVC   NEWO(4),UCMCOMPC(NEWI)                           02S0542
*   FAILI=MASTERI;                  /* MARK MASTER FAILED    @G51APSS*/
         L     @11,MASTERI                                      02S0543
         ST    @11,FAILI                                        02S0543
*   FAILO=MASTERO;                  /* MARK MASTER FAILED    @G51APSS*/
         L     @04,MASTERO                                      02S0544
         ST    @04,FAILO                                        02S0544
*   IF NEWI=FAILI THEN              /* IF NEW MASTER THE OLD MASTER?
*                                                            @G51APSS*/
         CR    NEWI,@11                                         02S0545
         BNE   @RF00545                                         02S0545
*     DO;                           /* YES                   @G51APSS*/
*       IF MASTERO=ZERO THEN        /* MASTER A COMPOSITE?   @G51APSS*/
         LTR   @04,@04                                          02S0547
         BNZ   @RF00547                                         02S0547
*         DO;                       /* NO                    @G51APSS*/
*           FAILO=FAILI;            /* SET UP FOR STATMSG    @G51APSS*/
         ST    @11,FAILO                                        02S0549
*           NEWO=NEWI;              /* SET UP FOR STATMSG    @G51APSS*/
         ST    NEWI,NEWO                                        02S0550
*         END;                      /*                       @G51APSS*/
*       CALL STATMSG;               /* BUILD MSG IEE143I     @G51APSS*/
@RF00547 BAL   @14,STATMSG                                      02S0552
*     END;                          /*                       @G51APSS*/
*   ELSE                            /* NEW MASTER IS DIFFERENT DEVICE
*                                      FROM OLD MASTER       @G51APSS*/
*     DO;                           /*                       @G51APSS*/
         B     @RC00545                                         02S0554
@RF00545 DS    0H                                               02S0555
*       UCMSYSD='1'B;               /* INDICATE MASTER IS FAILING
*                                                            @G51APSS*/
         OI    UCMSYSD(UCMMCSPT),B'00010000'                    02S0555
*       IF NEWI->UCMDISPC='1'B THEN /* IS NEW MASTER A GRAPHICS 02S0556
*                                      CONSOLE?              @G51APSS*/
         TM    UCMDISPC(NEWI),B'00100000'                       02S0556
         BNO   @RF00556                                         02S0556
*         CALL SWFULCAP;            /* YES, FORCE FULL I/O   @G51APSS*/
         BAL   @14,SWFULCAP                                     02S0557
*       CALL SWCONS;                /* SWITCH FUNCTIONS AND ISSUE MSG
*                                      IEE143I               @G51APSS*/
@RF00556 BAL   @14,SWCONS                                       02S0558
*     END;                          /*                       @G51APSS*/
*   END EXTINNCC;                   /*                       @G51APSS*/
@EL00002 DS    0H                                               02S0560
@EF00002 DS    0H                                               02S0560
@ER00002 LM    @14,@02,@SA00002                                 02S0560
         LM    @04,@12,@SA00002+20                              02S0560
         BR    @14                                              02S0560
*/*** END OF EXTINNCC SUBROUTINE *************************************/
*                                                               02S0561
         EJECT
*                                                               02S0561
*/*** START OF FINDALT SUBROUTINE ************************************/
*/*                                                                  */
*/* FINDALT - FINDS AN ALTERNATE FOR A FAILING CONSOLE               */
*/*                                                                  */
*/* FUNCTION - SEARCHES THE FAILING CONSOLE'S ALTERNATE CHAIN.       */
*/*    IF NO ALTERNATE CAN BE FOUND, THE MASTER IS SELECTED          */
*/*    PROVIDED THE MASTER IS NOT THE FAILING CONSOLE.               */
*/*    THE ALTERNATE SELECTED IS MADE COMPATIBLE WITH THE FAILING    */
*/*    CONSOLE.                                                      */
*/*                                                                  */
*/* INPUT - FAILI = UCME ADDR OF INPUT HALF OF FAILING CONS.         */
*/*         FAILO = UCME ADDR OF OUTPUTHALF OF FAILING CONS. OR 0    */
*/*         MASTERI = UCME ADDR OF INPUT HALF OF MASTER              */
*/*         MASTERO = UCME ADDR OF OUTPUTHALF OF MASTER OR 0         */
*/*                                                                  */
*/* OUTPUT - NEWI = UCME ADDR OF INPUT HALF OF ALTERNATE OR 0        */
*/*                 IF NO ALTERNATE WAS FOUND                        */
*/*          NEWO = UCME ADDR OF OUTPUT HALF OF ALTERNATE OR 0       */
*/*          UCMDEVCC = 1 IN UCME OF EACH ALTERNATE TESTED           */
*/*          UCMSYSD = 1 IF MASTER IS FAILING                        */
*/*                                                                  */
*/********************************************************************/
*                                                               02S0561
*FINDALT:                                                       02S0561
*   PROC OPTIONS(SAVE(REG14));                                  02S0561
FINDALT  ST    @14,@SA00003                                     02S0561
*   CALL CLEARDVC;                  /* CLEAR UCME DEVICE TESTED BITS */
         BAL   @14,CLEARDVC                                     02S0562
*   ALTFND=NO;                      /* INITIALIZE ALTERNATE FOUND
*                                      FLAG                          */
         NI    ALTFND,B'11111110'                               02S0563
*   IF FAILI=MASTERI                /* IS FAILING CONSOLE THE MASTER */
*     THEN                                                      02S0564
         CLC   FAILI(4),MASTERI                                 02S0564
         BNE   @RF00564                                         02S0564
*     UCMSYSD='1'B;                 /* YES, INDICATE FAILING CONS IS
*                                      MASTER                        */
*                                                               02S0565
         OI    UCMSYSD(UCMMCSPT),B'00010000'                    02S0565
*   /*****************************************************************/
*   /*                                                               */
*   /* SEARCH THE FAILING CONSOLE'S ALTERNATE CHAIN FOR AN ACTIVE    */
*   /* CONSOLE WITHOUT A CLOSE PENDING                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0566
*   FAILI->UCMDEVCC='1'B;           /* INDICATE FAILING CONSOLE HAS
*                                      BEEN TESTED                   */
@RF00564 L     @11,FAILI                                        02S0566
         OI    UCMDEVCC(@11),B'00100000'                        02S0566
*   IF FAILO^=ZERO THEN             /* COMPOSITE ?                   */
         L     @11,FAILO                                        02S0567
         LTR   @11,@11                                          02S0567
         BZ    @RF00567                                         02S0567
*     FAILO->UCMDEVCC='1'B;         /* YES, INDICATE OUTPUT HALF OF
*                                      FAILING CONSOLE HAS ALSO BEEN
*                                      TESTED                        */
         OI    UCMDEVCC(@11),B'00100000'                        02S0568
*   NEWI=FAILI->UCMALTEN;           /* SELECT FIRST ALTERNATE        */
*                                                               02S0569
@RF00567 L     @11,FAILI                                        02S0569
         L     NEWI,UCMALTEN(,@11)                              02S0569
*   /*****************************************************************/
*   /*                                                               */
*   /* LOOP TO END OF ALTERNATE CHAIN OR UNTIL ALL ALTERNATES HAVE   */
*   /* BEEN TESTED                                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0570
*   DO WHILE(NEWI^=0&NEWI->UCMDEVCC='0'B);                      02S0570
         B     @DE00570                                         02S0570
@DL00570 DS    0H                                               02S0571
*     NEWI->UCMDEVCC='1'B;          /* MARK ALTERNATE AS TESTED      */
         OI    UCMDEVCC(NEWI),B'00100000'                       02S0571
*     IF NEWI->UCMUF='0'B×NEWI->UCMVHRSN='1'B THEN/* INACTIVE OR
*                                      AFFECTD                       */
         TM    UCMUF(NEWI),B'00010000'                          02S0572
         BZ    @RT00572                                         02S0572
         TM    UCMVHRSN(NEWI),B'00000001'                       02S0572
         BNO   @RF00572                                         02S0572
@RT00572 DS    0H                                               02S0573
*       NEWI=NEWI->UCMALTEN;        /* YES, GET NEXT ALTERNATE       */
         L     NEWI,UCMALTEN(,NEWI)                             02S0573
*     ELSE                          /* NO, CHECK FOR CLOSE PENDING   */
*/* IF THE FAILING CONSOLE IS FULL CAPABILITY, MAKE SURE THE NEW
*   CONSOLE IS ALSO.                                                 */
*                                                               02S0574
*       IF FAILI->UCMDISPD='0'B&    /* FAILING CONSOLE FULL I/0?
*                                                            @ZA18883*/
*           NEWI->UCMDISPD='1'B&    /* NEW CONSOLE HARDWARE OUTPUT
*                                                            @ZA18883*/
*           NEWI->UCMSDS5G='0'B     /* ONLY DEVICE?          @ZA18883*/
*         THEN                      /* YES, NEW CONSOLE IS      02S0574
*                                      UNACCEPTABLE          @ZA18883*/
         B     @RC00572                                         02S0574
@RF00572 L     @11,FAILI                                        02S0574
         TM    UCMDISPD(@11),B'00010000'                        02S0574
         BNZ   @RF00574                                         02S0574
         TM    UCMDISPD(NEWI),B'00010000'                       02S0574
         BNO   @RF00574                                         02S0574
         TM    UCMSDS5G(NEWI),B'00000010'                       02S0574
         BNZ   @RF00574                                         02S0574
*         NEWI=NEWI->UCMALTEN;      /* GET NEXT DEVICE       @ZA18883*/
         L     NEWI,UCMALTEN(,NEWI)                             02S0575
*       ELSE                                                    02S0576
*         IF NEWI->UCMCF='1'B THEN  /* CLOSE PENDING?                */
         B     @RC00574                                         02S0576
@RF00574 TM    UCMCF(NEWI),B'00010000'                          02S0576
         BNO   @RF00576                                         02S0576
*           IF CSAACR='1'B THEN     /* YES, IS ACR BEING PROCESSED?  */
         TM    CSAACR(CXSAPTR),B'00010000'                      02S0577
         BNO   @RF00577                                         02S0577
*             DO;                   /* YES, OK TO USE CLOSE PENDING  */
*               NEWI->UCMCF='0'B;   /* TURN OFF CLOSE PENDING        */
         NI    UCMCF(NEWI),B'11101111'                          02S0579
*               NEWI->UCMUCB->UCBCHGSX='0'B;/* STOP CHANGE TO OFFLINE*/
*               NEWI->UCMUCB->UCBDADIX='0'B;/* STOP CHANGE FROM 02S0581
*                                      CONSOLE                       */
         L     @02,UCMUCB(,NEWI)                                02S0581
         L     @11,UCBDADIX-3(,@02)                             02S0581
@GL00036 LR    @04,@11                                          02S0581
         N     @04,@CF03977                                     02S0581
         CS    @11,@04,UCBDADIX-3(@02)                          02S0581
         BNE   @GL00036                                         02S0581
*               ALTFND=YES;         /* INDICATE ALTERNATE FOUND      */
         OI    ALTFND,B'00000001'                               02S0582
*             END;                                              02S0583
*           ELSE                                                02S0584
*             NEWI=NEWI->UCMALTEN;  /* IF NOT ACR, SELECT NEXT ALTERN*/
         B     @RC00577                                         02S0584
@RF00577 L     NEWI,UCMALTEN(,NEWI)                             02S0584
*         ELSE                                                  02S0585
*           ALTFND=YES;             /* IF NOT, CLOSE PENDING,   02S0585
*                                      INDICATE ALTERNATE WAS FOUND. */
         B     @RC00576                                         02S0585
@RF00576 OI    ALTFND,B'00000001'                               02S0585
*   END;                                                        02S0586
*                                                               02S0586
@RC00576 DS    0H                                               02S0586
@RC00574 DS    0H                                               02S0586
@RC00572 DS    0H                                               02S0586
@DE00570 LTR   NEWI,NEWI                                        02S0586
         BZ    @DC00570                                         02S0586
         TM    UCMDEVCC(NEWI),B'00100000'                       02S0586
         BZ    @DL00570                                         02S0586
@DC00570 DS    0H                                               02S0587
*   /*****************************************************************/
*   /*                                                               */
*   /* IF AN ALTERNATE WAS SELECTED FORCE IT TO BE COMPATIBLE WITH   */
*   /* THE FAILING CONSOLE                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0587
*   IF ALTFND=YES THEN                                          02S0587
         TM    ALTFND,B'00000001'                               02S0587
         BNO   @RF00587                                         02S0587
*     DO;                                                       02S0588
*       IF NEWI->UCMDISPC='1'B&NEWI->UCMDISPD='1'B THEN/* IS THE
*                                      ALTERNATE AN OUTPUT-ONLY CRT  */
         TM    UCMDISPC(NEWI),B'00110000'                       02S0589
         BNO   @RF00589                                         02S0589
*         IF FAILI->UCMDISPD='0'B THEN/* YES, BUT IS THE FAILING
*                                      CONSOLE OUTPUT ONLY           */
         L     @11,FAILI                                        02S0590
         TM    UCMDISPD(@11),B'00010000'                        02S0590
         BNZ   @RF00590                                         02S0590
*           CALL SWFULCAP;          /* NO, FORCE THE ALTERNATE TO
*                                      FULL I/O                      */
         BAL   @14,SWFULCAP                                     02S0591
*         ELSE                      /* YES, FAILING IS ALSO OUTPUT
*                                      ONLY                          */
*           IF FAILI->UCMDISPF='1'B THEN/* IS FAILING MESSAGE STREAM
*                                      ONLY                          */
         B     @RC00590                                         02S0592
@RF00590 L     @11,FAILI                                        02S0592
         TM    UCMDISPF(@11),B'00000100'                        02S0592
         BNO   @RF00592                                         02S0592
*             DO;                   /* YES                           */
*               NEWI->UCMDISPF='1'B;/* MAKE ALT MESSAGE STREAM ONLY  */
*               NEWI->UCMDISPG='0'B;/* TURN OFF STATUS DISPLAY ONLY  */
         OI    UCMDISPF(NEWI),B'00000100'                       02S0595
         NI    UCMDISPG(NEWI),B'11111101'                       02S0595
*               NEWI->UCMXB->DCMSTSWT='1'B;/* INDICATE CHANGING 02S0596
*                                      STATUS IN THE DCM FOR DIDOCS  */
         L     @11,UCMXB(,NEWI)                                 02S0596
         OI    DCMSTSWT(@11),B'10000000'                        02S0596
*             END;                                              02S0597
*       NEWO=NEWI->UCMCOMPC;        /* GET OTHER HALF OF NEW CONSOLE,
*                                      IF ANY                        */
@RF00592 DS    0H                                               02S0598
@RC00590 DS    0H                                               02S0598
@RF00589 L     @11,UCMCOMPC(,NEWI)                              02S0598
         ST    @11,NEWO                                         02S0598
*       IF NEWO^=ZERO THEN          /* IS NEW CONSOLE A COMPOSITE    */
         LTR   @11,@11                                          02S0599
         BZ    @RF00599                                         02S0599
*         IF NEWI->UCMOF='1'B THEN  /* YES, IS FIRST HALF THE OUTPUT
*                                      HALF                          */
         TM    UCMOF(NEWI),B'10000000'                          02S0600
         BNO   @RF00600                                         02S0600
*           DO;                     /* YES, INTERCHANGE INPUT AND
*                                      OUTPUT PTRS                   */
*             NEWI=NEWO;            /* INPUT HALF                    */
         LR    NEWI,@11                                         02S0602
*             NEWO=NEWI->UCMCOMPC;  /* OUTPUT HALF                   */
         MVC   NEWO(4),UCMCOMPC(NEWI)                           02S0603
*           END;                                                02S0604
*     END;                                                      02S0605
*   ELSE                            /* ALTERNATE WAS NOT FOUND IN ALT
*                                      CHAIN                         */
*     IF FAILI=MASTERI THEN         /* IS THE MASTER FAILING         */
         B     @RC00587                                         02S0606
@RF00587 CLC   FAILI(4),MASTERI                                 02S0606
         BNE   @RF00606                                         02S0606
*       NEWI=0;                     /* YES, INDICATE NO ALTERNATE
*                                      FOUND                         */
         SLR   NEWI,NEWI                                        02S0607
*     ELSE                          /* NO,                           */
*       DO;                         /* MAKE THE MASTER THE ALTERNATE */
         B     @RC00606                                         02S0608
@RF00606 DS    0H                                               02S0609
*         NEWI=MASTERI;             /* INPUT HALF OF NEW IS INPUT
*                                      HALF OF MASTER                */
         L     NEWI,MASTERI                                     02S0609
*         NEWO=MASTERO;             /* OUTPUT HALF OF NEW IS OUTPUT
*                                      HALF OF MASTER                */
         MVC   NEWO(4),MASTERO                                  02S0610
*       END;                                                    02S0611
*   END FINDALT;                                                02S0612
*                                                               02S0612
@EL00003 DS    0H                                               02S0612
@EF00003 DS    0H                                               02S0612
@ER00003 L     @14,@SA00003                                     02S0612
         BR    @14                                              02S0612
*/*** END OF FINDALT SUBROUTINE **************************************/
*                                                               02S0613
         EJECT
*                                                               02S0613
*/*** START OF SWCONS SUBROUTINE *************************************/
*/*                                                                  */
*/* SWCONS  -  SUBROUTINE TO PERFORM ACTUAL SWITCH OF CONSOLE        */
*/*                                                                  */
*/* FUNCTION - TRANSFERS FUNCTION OF OLD CONSOLE TO NEW, REQUEUES    */
*/*            MESSAGES IF THIS IS REQUIRED (NOT REQUIRED FOR THE    */
*/*            VARY CPU OR CHANNEL COMMAND PROCESSING), ISSUES A NEW */
*/*            CONSOLE STATUS MESSAGE, AND MARKS THE FAILING CONSOLE */
*/*                                                                  */
*/* INPUT  -   NEWI CONTAINS THE ADDRESS OF THE NEW CONSOLE OR ZERO  */
*/*            IF NO ALTERNATE COULD BE FOUND AND FAILING WAS THE    */
*/*            MASTER CONSOLE.                                       */
*/*            FAILI CONTAINS THE ADDRESS OF THE FAILING CONSOLE OR  */
*/*            THE INPUT HALF OF THE FAILING CONSOLE IF IT IS A      */
*/*            COMPOSITE (IN WHICH CASE FAILO CONTAINS THE ADDRESS   */
*/*            OF THE OUTPUT HALF.)                                  */
*/*                                                                  */
*/* OUTPUT  -  NONE                                                  */
*/*                                                                  */
*/********************************************************************/
*                                                               02S0613
*SWCONS:                                                        02S0613
*   PROC OPTIONS(SAVE);             /*                       @G51APSS*/
SWCONS   STM   @14,@02,@SA00004                                 02S0613
         STM   @04,@12,@SA00004+20                              02S0613
*   IF NEWI=ZERO THEN               /* WAS AN ALTERNATE FOUND?       */
         LTR   NEWI,NEWI                                        02S0614
         BNZ   @RF00614                                         02S0614
*     CALL NOALTM;                  /* NO, MASTER MUST BE FAILING,
*                                      PROCESS A                02S0615
*                                      NO-ALTERNATE-FOR-THE-MASTER
*                                      CONDITION                     */
         BAL   @14,NOALTM                                       02S0615
*   ELSE                                                        02S0616
*     DO;                           /* AN ALTERNATE WAS FOUND        */
*                                                               02S0616
         B     @RC00614                                         02S0616
@RF00614 DS    0H                                               02S0617
*       /*************************************************************/
*       /*                                                           */
*       /* TRANSFER THE FAILING CONSOLE'S FUNCTIONS TO THE NEW       */
*       /* CONSOLE                                                   */
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0617
*       CALL SETOSW;                                            02S0617
         BAL   @14,SETOSW                                       02S0617
*       IF FAILO->UCMDISPB='1'B THEN/* IS OLD CONSOLE HARDCOPY       */
         L     @11,FAILO                                        02S0618
         TM    UCMDISPB(@11),B'01000000'                        02S0618
         BNO   @RF00618                                         02S0618
*         IF NEWO->UCMDISPC='1'B THEN/* YES, IS NEW CONSOLE GRAPHICS */
         L     @11,NEWO                                         02S0619
         TM    UCMDISPC(@11),B'00100000'                        02S0619
         BNO   @RF00619                                         02S0619
*           CALL HCSWITCH;          /* YES, SWITCH HARDCOPY TO  02S0620
*                                      ANOTHER CONSOLE IF POSSIBLE   */
         BAL   @14,HCSWITCH                                     02S0620
*         ELSE                                                  02S0621
*           DO;                     /* NO, NEW CONSOLE IS SUITABLE
*                                      FOR HARDCOPY                  */
*                                                               02S0621
         B     @RC00619                                         02S0621
@RF00619 DS    0H                                               02S0622
*             /*******************************************************/
*             /*                                                     */
*             /* TRANSFER HARDCOPY FUNCTION FROM OLD TO NEW CONSOLE  */
*             /*                                                     */
*             /*******************************************************/
*                                                               02S0622
*             FAILO->UCMDISPB='0'B; /* TURN OFF HC FLAG IN OLD  02S0622
*                                      CONSOLE                       */
         L     @11,FAILO                                        02S0622
         NI    UCMDISPB(@11),B'10111111'                        02S0622
*             NEWO->UCMDISPB='1'B;  /* TURN ON HC FLAG IN NEW CONSOLE*/
         L     @11,NEWO                                         02S0623
         OI    UCMDISPB(@11),B'01000000'                        02S0623
*             UCMHCUCM=NEWO;        /* STORE NEW HARDCOPY UCME ADDR  */
         ST    @11,UCMHCUCM(,UCMMCSPT)                          02S0624
*           END;                                                02S0625
*                                                               02S0625
*       /*************************************************************/
*       /*                                                           */
*       /* WRITE A MESSAGE TO THE NEW CONSOLE INFORMING IT IF ITS NEW*/
*       /* STATUS                                                    */
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0626
*       CALL STATMSG;                                           02S0626
@RC00619 DS    0H                                               02S0626
@RF00618 BAL   @14,STATMSG                                      02S0626
*       IF CSAVCPU='0'B&CSAVCHAN='0'B/* TEST FOR VARY COMMAND        */
*         THEN                                                  02S0627
         TM    CSAVCPU(CXSAPTR),B'01100000'                     02S0627
         BNZ   @RF00627                                         02S0627
*         DO;                       /* NOT A VARY COMMAND REQUEST    */
*                                                               02S0628
*           /*********************************************************/
*           /*                                                       */
*           /* QUEUE ANY UNANSWERED WTORS SENT TO THE FAILING CONSOLE*/
*           /* TO THE OUTPUT QUEUE OF THE NEW CONSOLE                */
*           /*                                                       */
*           /*********************************************************/
*                                                               02S0629
*                                                               03S0629
*/**  START OF OREREQU SEGMENT ***************************************/
*/*                                                                  */
*/* OREREQU - QUEUES WQES FOR UNANSWERED WTORS SENT TO THE FAILING   */
*/*    CONSOLES TO THE NEW CONSOLE.                                  */
*/*                                                                  */
*/* FUNCTION - SEARCHES THE ORE QUEUE AND DETERMINES IF THE          */
*/*    FAILING CONSOLE RECEIVED THE WTOR MSG.  IF SO, CREATES        */
*/*    CQE ENTRY ON THE NEW CONSOLE'S OUTPUT QUEUE FOR THE WTOR.     */
*/*                                                                  */
*/* INPUT - FAILO - UCME ADDR OF OUTPUT HALF OF FAILING CONSOLE      */
*/*         FAILI - UCME ADDR OF INPUT  HALF OF FAILING CONSOLE      */
*/* OUTPUT - WQEUCMID - CHANGED TO ID OF NEW CONSOLE WHEN MSG        */
*/*                     WAS QUEUED BY ID                             */
*/*         WQEUSE - INCREMENTED WHEN MSG IS QUEUED TO NEW CONSOLE   */
*/********************************************************************/
*                                                               03S0629
*           GETCQEFL=NO;            /* INIT GETCQE FAILURE FLAG      */
         NI    GETCQEFL,B'11011111'                             03S0629
*           OREPTR=UCMRPYQ;         /* GET PTR TO FIRST ORE ON THE
*                                      QUEUE                         */
         L     OREPTR,UCMRPYQ(,UCMBASPT)                        03S0630
*           J=ONE;                  /* INITIALIZE CQE COUNTER        */
*                                                               03S0631
         MVC   J(4),@CF00055                                    03S0631
*           /*********************************************************/
*           /*                                                       */
*           /* LOOP THROUGH THE ORES. FOR EACH ORE QUEUED TO THE     */
*           /* FAILING CONSOLE, CREATE A CQE ENTRY ON THE OUTPUT HALF*/
*           /* OF THE NEW CONSOLE.                                   */
*           /*                                                       */
*           /*********************************************************/
*                                                               03S0632
*           DO WHILE(OREPTR^=ZERO); /* SEARCH UNTIL END OF QUEUE     */
         B     @DE00632                                         03S0632
@DL00632 DS    0H                                               03S0633
*             IF OREBUFC='0'B&OREWQE->WQEBUFE='1'B THEN/* IS ORE NOT
*                                      LOGICALLY DELETED AND HAS
*                                      CORRESPONDING WQE BEEN   03S0633
*                                      SERVICED                      */
         TM    OREBUFC(OREPTR),B'00100000'                      03S0633
         BNZ   @RF00633                                         03S0633
         L     @04,OREWQE(,OREPTR)                              03S0633
         TM    WQEBUFE(@04),B'00001000'                         03S0633
         BNO   @RF00633                                         03S0633
*               DO;                 /* YES                           */
*                 SW1='0'B;         /* INITIALIZE QUEUE ORE SWITCH   */
         NI    SW1,B'01111111'                                  03S0635
*                 CONTROL=FAILI;    /* DO TEST FOR INPUT HALF FIRST  */
         MVC   CONTROL(4),FAILI                                 03S0636
*                 WQEPTR=OREWQE;    /* SET PTR TO WQE                */
*                                                               03S0637
         LR    WQEPTR,@04                                       03S0637
*                 /***************************************************/
*                 /*                                                 */
*                 /* TEST IF WTOR WOULD HAVE BEEN QUEUED TO THE INPUT*/
*                 /* OR OUTPUT HALF OF THE FAILING CONSOLE           */
*                 /*                                                 */
*                 /***************************************************/
*                                                               03S0638
*                 DO I=2 TO 1 BY-1 WHILE(SW1='0'B);             03S0638
         LA    @04,2                                            03S0638
         ST    @04,I                                            03S0638
@DL00638 TM    SW1,B'10000000'                                  03S0638
         BNZ   @DC00638                                         03S0638
*                   IF WQEMCSG='1'B&UCMSYSD='1'B THEN/* WTOR TO HC
*                                      ONLY AND MASTER IS FAILING    */
         TM    WQEMCSG(WQEPTR),B'00000010'                      03S0639
         BNO   @RF00639                                         03S0639
         TM    UCMSYSD(UCMMCSPT),B'00010000'                    03S0639
         BNO   @RF00639                                         03S0639
*                     SW1='1'B;     /* YES, QUEUE WTOR TO NEW CONSOLE*/
         OI    SW1,B'10000000'                                  03S0640
*                   ELSE                                        03S0641
*                     IF WQEMCSH='1'B&(CONTROL->UCMID=WQEUCMID) THEN
         B     @RC00639                                         03S0641
@RF00639 TM    WQEMCSH(WQEPTR),B'00000001'                      03S0641
         BNO   @RF00641                                         03S0641
         L     @04,CONTROL                                      03S0641
         CLC   UCMID(1,@04),WQEUCMID(WQEPTR)                    03S0641
         BNE   @RF00641                                         03S0641
*                                   /* QREG0 AND THE FAILING    03S0642
*                                      CONSOLE'S ID MATCHES THE WQE
*                                      ID                            */
*                       DO;         /* YES                           */
*                         WQEUCMID=NEWO->UCMID;/* CHANGE WQE ID TO
*                                      CONSOLE ID OF NEW CONSOLE     */
         L     @04,NEWO                                         03S0643
         MVC   WQEUCMID(1,WQEPTR),UCMID(@04)                    03S0643
*                         SW1='1'B; /* QUEUE WTOR TO NEW CONSOLE     */
         OI    SW1,B'10000000'                                  03S0644
*                       END;                                    03S0645
*                     ELSE                                      03S0646
*                       IF WQEMCSD='0'B THEN/* QUEUED BY MSGTYPE     */
         B     @RC00641                                         03S0646
@RF00641 TM    WQEMCSD(WQEPTR),B'00010000'                      03S0646
         BNZ   @RF00646                                         03S0646
*                         IF(WQEROUT&CONTROL->UCMRTCD)^=0 THEN/* NO,
*                                      DO ROUTE CODES MATCH          */
         L     @04,CONTROL                                      03S0647
         SLR   @15,@15                                          03S0647
         ICM   @15,3,UCMRTCD(@04)                               03S0647
         SLR   @04,@04                                          03S0647
         ICM   @04,3,WQEROUT(WQEPTR)                            03S0647
         NR    @15,@04                                          03S0647
         LTR   @15,@15                                          03S0647
         BZ    @RF00647                                         03S0647
*                           SW1='1'B;/* YES, QUEUE WTOR TO NEW  03S0648
*                                      CONSOLE                       */
         OI    SW1,B'10000000'                                  03S0648
*                         ELSE                                  03S0649
*                           IF WQEMCSB='1'B&CONTROL->UCMID=WQEUCMID
*                             THEN  /* REG0 AND THE FAILING CONSOLE'S
*                                      ID MATCHES THE WQE ID         */
         B     @RC00647                                         03S0649
@RF00647 TM    WQEMCSB(WQEPTR),B'01000000'                      03S0649
         BNO   @RF00649                                         03S0649
         L     @04,CONTROL                                      03S0649
         CLC   UCMID(1,@04),WQEUCMID(WQEPTR)                    03S0649
         BNE   @RF00649                                         03S0649
*                             DO;   /* YES                           */
*                               WQEUCMID=NEWO->UCMID;/* CHANG WQE ID
*                                      TO CONSOLE ID OF NEW CONSOLE  */
         L     @04,NEWO                                         03S0651
         MVC   WQEUCMID(1,WQEPTR),UCMID(@04)                    03S0651
*                               SW1='1'B;/* QUEUE WTOR TO NEW CONSOLE*/
         OI    SW1,B'10000000'                                  03S0652
*                             END;                              03S0653
*                           ELSE                                03S0654
*                             ;                                 03S0654
@RF00649 DS    0H                                               03S0655
*                       ELSE                                    03S0655
*                         IF(WQEMSGTP&CONTROL->UCMMSG)^=0 THEN/* DOES
*                                      MSG TYPE MATCH FAILING CONSOLE*/
         B     @RC00646                                         03S0655
@RF00646 L     @04,CONTROL                                      03S0655
         SLR   @15,@15                                          03S0655
         ICM   @15,3,UCMMSG(@04)                                03S0655
         SLR   @04,@04                                          03S0655
         ICM   @04,3,WQEMSGTP(WQEPTR)                           03S0655
         NR    @15,@04                                          03S0655
         LTR   @15,@15                                          03S0655
         BZ    @RF00655                                         03S0655
*                           SW1='1'B;/* YES, QUEUE WTOR TO NEW  03S0656
*                                      CONSOLE                       */
         OI    SW1,B'10000000'                                  03S0656
*                   CONTROL=FAILO;  /* REPEAT TESTS FOR OUTPUT HALF
*                                      OF FAILING CONSOLE            */
@RF00655 DS    0H                                               03S0657
@RC00646 DS    0H                                               03S0657
@RC00641 DS    0H                                               03S0657
@RC00639 MVC   CONTROL(4),FAILO                                 03S0657
*                 END;                                          03S0658
*                                                               03S0658
         SLR   @04,@04                                          03S0658
         BCTR  @04,0                                            03S0658
         AL    @04,I                                            03S0658
         ST    @04,I                                            03S0658
         LTR   @04,@04                                          03S0658
         BP    @DL00638                                         03S0658
@DC00638 DS    0H                                               03S0659
*                 /***************************************************/
*                 /*                                                 */
*                 /* IF THE WTOR WAS QUEUED TO THE FAILING CONSOLE,  */
*                 /* BUILD A CQE ENTRY FOR THE WTOR ON THE OUTPUT    */
*                 /* QUEUE OF THE NEW CONSOLE AND INCREMENT THE WQE  */
*                 /* USE COUNT. THE NEW CONSOLE WILL THEN RECEIVE THE*/
*                 /* WTOR MESSAGE.                                   */
*                 /*                                                 */
*                 /***************************************************/
*                                                               03S0659
*                 IF SW1='1'B THEN  /* SHOULD THE WQE BE QUEUED      */
         TM    SW1,B'10000000'                                  03S0659
         BNO   @RF00659                                         03S0659
*                   DO;             /* YES                           */
*                     IF J=1 THEN   /* IS A NEW CQE BLOCK REQUIRED   */
         CLC   J(4),@CF00055                                    03S0661
         BNE   @RF00661                                         03S0661
*                       DO;         /* YES                           */
*                         OUTQ=NEWO;/* PLACE NEW BLOCK ON NEW   03S0663
*                                      CONSOLE'S Q                   */
         MVC   OUTQ(4),NEWO                                     03S0663
*                         CALL GETCQE;/* GET AND CHAIN A NEW CQE     */
         BAL   @14,GETCQE                                       03S0664
*                       END;                                    03S0665
*                     IF GETCQEFL=NO THEN/* IF GETCQE DID NOT FAIL   */
@RF00661 TM    GETCQEFL,B'00100000'                             03S0666
         BNZ   @RF00666                                         03S0666
*                       DO;                                     03S0667
*                         CQEWQEA=WQEPTR;/* PTR TO WTOR              */
         L     @04,CQEPTR                                       03S0668
         STCM  WQEPTR,7,CQEWQEA(@04)                            03S0668
*                         CQEENTR='1'B;/* INDICATE ENTRY EXISTS      */
         OI    CQEENTR(@04),B'00000001'                         03S0669
*                         J=J+ONE;  /* INCREMENT CQE COUNTER         */
         LA    @15,1                                            03S0670
         L     @14,J                                            03S0670
         ALR   @14,@15                                          03S0670
         ST    @14,J                                            03S0670
*                         CQEPTR=CQEPTR+FOUR;/* INCREMENT PTR TO NEXT
*                                      ENTRY                         */
         LA    @01,4                                            03S0671
         ALR   @04,@01                                          03S0671
         ST    @04,CQEPTR                                       03S0671
*                         WQEUSE=WQEUSE+ONE;/* INCREMENT WTOR USE
*                                      COUNT                         */
         SLR   @00,@00                                          03S0672
         IC    @00,WQEUSE(,WQEPTR)                              03S0672
         ALR   @00,@15                                          03S0672
         STC   @00,WQEUSE(,WQEPTR)                              03S0672
*                         IF J=SIX THEN/* IF NEXT ENTRY IS THE 6TH
*                                      ENTRY, SET UP TO GET A NEW CQE
*                                      BLOCK                         */
         CH    @14,@CH00033                                     03S0673
         BNE   @RF00673                                         03S0673
*                           DO;                                 03S0674
*                             EVAL(CQEPTR-FOUR)->CQEEOQ='1'B;/* SET
*                                      END-OF-QUEUE IN 5TH CQE ENTRY */
         SLR   @04,@01                                          03S0675
         OI    CQEEOQ(@04),B'10000000'                          03S0675
*                             J=ONE;/* A NEW BLOCK IS NEEDED         */
         ST    @15,J                                            03S0676
*                           END;                                03S0677
*                       END;                                    03S0678
@RF00673 DS    0H                                               03S0679
*                   END;                                        03S0679
@RF00666 DS    0H                                               03S0680
*               END;                                            03S0680
@RF00659 DS    0H                                               03S0681
*             IF GETCQEFL=NO THEN   /* IF GETCQE DID NOT FAIL        */
@RF00633 TM    GETCQEFL,B'00100000'                             03S0681
         BNZ   @RF00681                                         03S0681
*               OREPTR=ORELKP;      /* GET PTR TO NEXT ORE           */
         L     OREPTR,ORELKP(,OREPTR)                           03S0682
*             ELSE                                              03S0683
*               OREPTR=ZERO;        /* ELSE IF GETCQE DID FAIL       */
         B     @RC00681                                         03S0683
@RF00681 SLR   OREPTR,OREPTR                                    03S0683
*           END;                                                03S0684
*                                                               03S0684
@RC00681 DS    0H                                               03S0684
@DE00632 LTR   OREPTR,OREPTR                                    03S0684
         BNZ   @DL00632                                         03S0684
*           /*********************************************************/
*           /*                                                       */
*           /* INDICATE END OF QUEUE IN ANY UNFINISHED CQE BLOCK     */
*           /*                                                       */
*           /*********************************************************/
*                                                               03S0685
*           IF J^=ONE THEN                                      03S0685
         CLC   J(4),@CF00055                                    03S0685
         BE    @RF00685                                         03S0685
*             EVAL(CQEPTR-FOUR)->CQEEOQ='1'B;/* SET END-OF-QUEUE IN
*                                      LAST ENTRY USED               */
         L     @11,CQEPTR                                       03S0686
         SL    @11,@CF00065                                     03S0686
         OI    CQEEOQ(@11),B'10000000'                          03S0686
*/*** END OF OREREQU SEGMENT *****************************************/
*                                                               03S0687
*                                                               02S0687
*           /*********************************************************/
*           /*                                                       */
*           /* TRANSFER THE OUTPUT QUEUE OF THE FAILING CONSOLE TO   */
*           /* THE OUTPUT QUEUE OF THE NEW CONSOLE                   */
*           /*                                                       */
*           /*********************************************************/
*                                                               02S0687
*                                                               03S0687
*/**** START OF WQEREQU SEGMENT **************************************/
*/* WQEREQU - TRANSFERS THE OUTPUT QUEUE OF THE FAILING CONSOLE TO   */
*/*          THE NEW CONSOLE.                                        */
*/* FUNCTION - SCANS THE FAILING CONSOLE'S OUTPUT QUEUE FOR VALID    */
*/*    CQE ENTRIES.  ENTRIES FOR MLWTOS ARE PASSED TO THE ML1        */
*/*    SUBROUTINE TO DETERMINE IF THEY CAN BE REQUEUED TO THE NEW    */
*/*    CONSOLE.  WTOS QUEUED BY ID TO THE FAILING CONSOLE HAVE THE   */
*/*    WQEUCMID CHANGE TO THAT OF THE NEW CONSOLE.  THEN THE ENTIRE  */
*/*    OUTPUT QUEUE OF THE FAILING CONSOLE IS CHAINED TO THE NEW     */
*/*    CONSOLE'S OUTPUT QUEUE.                                       */
*/*  INPUT - FAILO - UCME ADDR OF OUTPUT HALF OF FAILING CONSOLE.    */
*/*        NEWO - UCME ADDR OF OUTPUT HALF OF NEW CONSOLE.           */
*/* OUTPUT - NONE                                                    */
*/*                                                                  */
*/********************************************************************/
*                                                               03S0687
*           /*********************************************************/
*           /*                                                       */
*           /* SEARCH THROUGH THE OUTPUT QUEUE OF THE FAILING CONSOLE*/
*           /*                                                       */
*           /*********************************************************/
*                                                               03S0687
*           IF FAILO->UCMOUTQ^=0 THEN/* IS THERE AN OUTPUT QUEUE     */
@RF00685 L     @11,FAILO                                        03S0687
         L     @11,UCMOUTQ(,@11)                                03S0687
         LTR   @11,@11                                          03S0687
         BZ    @RF00687                                         03S0687
*             DO;                   /* YES                           */
*               CQEPTR=FAILO->UCMOUTQ;/* INITIALIZE PTR TO 1ST CQE
*                                      BLOCK                         */
         ST    @11,CQEPTR                                       03S0689
*               SW1='0'B;           /* INITIALIZE END-OF-Q SWITCH    */
         NI    SW1,B'01111111'                                  03S0690
*               DO WHILE(SW1='0'B); /* SEARCH STOPS WHEN END-OF-Q IS
*                                      FOUND                         */
         B     @DE00691                                         03S0691
@DL00691 DS    0H                                               03S0692
*                 IF CQEENTR='1'B&CQEMAJOR='1'B THEN/* VALID MLWTO
*                                      ENTRY?                        */
         L     @11,CQEPTR                                       03S0692
         TM    CQEENTR(@11),B'00000101'                         03S0692
         BNO   @RF00692                                         03S0692
*                   DO;             /* YES                           */
*                     UCMDVEPT=FAILO;/* DETERMINE IF MLWTO SHOULD BE */
         L     UCMDVEPT,FAILO                                   03S0694
*                     CALL ML1;     /* TRANSFERRED TO NEW CONSOLE. IF
*                                      NOT,                          */
         BAL   @14,ML1                                          03S0695
*                   END;            /* ML1 TURNS OFF CQEENTR         */
*                 IF CQEENTR='1'B THEN/* IS CQE ENTRY VALID          */
@RF00692 L     @11,CQEPTR                                       03S0697
         TM    CQEENTR(@11),B'00000001'                         03S0697
         BNO   @RF00697                                         03S0697
*                   DO;             /* YES                           */
*                     WQEPTR=CQEWQEA;/* GET PTR TO WQE               */
         SLR   WQEPTR,WQEPTR                                    03S0699
         ICM   WQEPTR,7,CQEWQEA(@11)                            03S0699
*                     IF WQEMCSB='1'B×WQEMCSH='1'B THEN/* QUEUED BY
*                                      ID?                           */
         TM    WQEMCSB(WQEPTR),B'01000001'                      03S0700
         BZ    @RF00700                                         03S0700
*                       DO;                                     03S0701
*                         IF WQEUCMID=FAILI->UCMID THEN/* DOES ID
*                                      MATCH ID OF INPUT HALF OF OLD */
         L     @11,FAILI                                        03S0702
         CLC   WQEUCMID(1,WQEPTR),UCMID(@11)                    03S0702
         BNE   @RF00702                                         03S0702
*                           WQEUCMID=NEWI->UCMID;/* YES, CHANGE ID TO
*                                      ID OF INPUT HALF OF NEW       */
         MVC   WQEUCMID(1,WQEPTR),UCMID(NEWI)                   03S0703
*                         IF WQEUCMID=FAILO->UCMID THEN/* DOES ID
*                                      MATCH ID OF OUTPUT HALF OF OLD*/
@RF00702 L     @11,FAILO                                        03S0704
         CLC   WQEUCMID(1,WQEPTR),UCMID(@11)                    03S0704
         BNE   @RF00704                                         03S0704
*                           WQEUCMID=NEWO->UCMID;/* YES, CHANGE ID TO
*                                      ID OF OUTPUT HALF OF NEW      */
         L     @11,NEWO                                         03S0705
         MVC   WQEUCMID(1,WQEPTR),UCMID(@11)                    03S0705
*                       END;                                    03S0706
@RF00704 DS    0H                                               03S0707
*                   END;                                        03S0707
@RF00700 DS    0H                                               03S0708
*                 IF CQEEOQ='0'B THEN                           03S0708
@RF00697 L     @11,CQEPTR                                       03S0708
         TM    CQEEOQ(@11),B'10000000'                          03S0708
         BNZ   @RF00708                                         03S0708
*                   DO;             /* END-OF-Q ? NO -               */
*                     CQEPTR=CQEPTR+LENGTH(CQEWQE);/* GET NEXT CQE   */
         AL    @11,@CF00065                                     03S0710
         ST    @11,CQEPTR                                       03S0710
*                     IF CQEEOB=ONTWO THEN/* END-OF-BLOCK?           */
         TM    CQEEOB(@11),B'11000000'                          03S0711
         BNO   @RF00711                                         03S0711
*                       CQEPTR=CQEWQEA;/* GET PTR TO NEXT BLOCK      */
         SLR   @04,@04                                          03S0712
         ICM   @04,7,CQEWQEA(@11)                               03S0712
         ST    @04,CQEPTR                                       03S0712
*                   END;                                        03S0713
*                 ELSE                                          03S0714
*                   SW1='1'B;       /* INDICATE END-OF-Q FOUND       */
         B     @RC00708                                         03S0714
@RF00708 OI    SW1,B'10000000'                                  03S0714
*               END;                /* END OF DO WHILE CQE LOOP      */
@RC00708 DS    0H                                               03S0715
@DE00691 TM    SW1,B'10000000'                                  03S0715
         BZ    @DL00691                                         03S0715
*               IF NEWO->UCMOUTQ=ZERO THEN/* DOES NEW HAVE AN OUTPUT
*                                      QUEUE                         */
         L     @11,NEWO                                         03S0716
         ICM   @04,15,UCMOUTQ(@11)                              03S0716
         BNZ   @RF00716                                         03S0716
*                 NEWO->UCMOUTQ=FAILO->UCMOUTQ;/* NO, ADD FAILING'S
*                                      OUTPUT Q TO NEW               */
         L     @04,FAILO                                        03S0717
         MVC   UCMOUTQ(4,@11),UCMOUTQ(@04)                      03S0717
*               ELSE                                            03S0718
*                 DO;               /* NEW HAS AN OUTPUT Q           */
         B     @RC00716                                         03S0718
@RF00716 DS    0H                                               03S0719
*                   CQEBLK=NEWO->UCMOUTQ;/* INIT PTR TO 1ST CQE BLOCK*/
         L     @11,NEWO                                         03S0719
         L     @11,UCMOUTQ(,@11)                                03S0719
         ST    @11,CQEBLK                                       03S0719
*                   CQEPTR=CQEBLK;  /* INIT PTR TO 1ST CQE ENTRY     */
         ST    @11,CQEPTR                                       03S0720
*                   SW1='0'B;       /* INIT END-OF-Q SWITCH          */
*                                                               03S0721
         NI    SW1,B'01111111'                                  03S0721
*                   /*************************************************/
*                   /*                                               */
*                   /* FIND END OF NEW CONSOLE'S OUTPUT QUEUE        */
*                   /*                                               */
*                   /*************************************************/
*                                                               03S0722
*                   DO WHILE(SW1='0'B);                         03S0722
         B     @DE00722                                         03S0722
@DL00722 DS    0H                                               03S0723
*                     IF CQEEOQ='0'B THEN/* END-OF-Q                 */
         L     @11,CQEPTR                                       03S0723
         TM    CQEEOQ(@11),B'10000000'                          03S0723
         BNZ   @RF00723                                         03S0723
*                       DO;         /* NO                            */
*                         CQEPTR=CQEPTR+LENGTH(CQEWQE);/* GET NEXT
*                                      CQE ENTRY                     */
         AL    @11,@CF00065                                     03S0725
         ST    @11,CQEPTR                                       03S0725
*                         IF CQEEOB=ONTWO THEN/* END-OF-BLOCK ?      */
         TM    CQEEOB(@11),B'11000000'                          03S0726
         BNO   @RF00726                                         03S0726
*                           DO;     /* YES                           */
*                             CQEBLK=CQEWQEA;/* GET PTR TO NEXT CQE
*                                      BLOCK                         */
         SLR   @04,@04                                          03S0728
         ICM   @04,7,CQEWQEA(@11)                               03S0728
         ST    @04,CQEBLK                                       03S0728
*                             CQEPTR=CQEBLK;/* GET PTR TO NEXT CQE
*                                      ENTRY                         */
         ST    @04,CQEPTR                                       03S0729
*                           END;                                03S0730
*                       END;                                    03S0731
*                     ELSE                                      03S0732
*                       SW1='1'B;   /* INDICATE END-OF-Q FOUND       */
         B     @RC00723                                         03S0732
@RF00723 OI    SW1,B'10000000'                                  03S0732
*                   END;                                        03S0733
*                                                               03S0733
@RC00723 DS    0H                                               03S0733
@DE00722 TM    SW1,B'10000000'                                  03S0733
         BZ    @DL00722                                         03S0733
*                   /*************************************************/
*                   /*                                               */
*                   /* CQEBLK POINTS TO LAST CQE BLOCK. CQEPTR POINTS*/
*                   /* TO LAST CQE ENTRY. ADD OLD QUEUE TO NEW       */
*                   /*                                               */
*                   /*************************************************/
*                                                               03S0734
*                   CQEEOQ='0'B;    /* TURN OFF END-OF-Q INDICATOR IN
*                                      LAST ENTRY OF NEW QUEUE       */
         L     @11,CQEPTR                                       03S0734
         NI    CQEEOQ(@11),B'01111111'                          03S0734
*                   EVAL(CQEBLK+TWENTY)->CQEWQE=FAILO->UCMOUTQ;/*
*                                      CHAIN FAIL'S OUTPUT QUEUE TO
*                                      NEW'S OUTPUT Q                */
         L     @11,CQEBLK                                       03S0735
         LA    @04,20                                           03S0735
         LR    @02,@11                                          03S0735
         ALR   @02,@04                                          03S0735
         L     @01,FAILO                                        03S0735
         MVC   CQEWQE(4,@02),UCMOUTQ(@01)                       03S0735
*                   EVAL(CQEBLK+TWENTY)->CQEEOB=ONTWO;/* RESET EOB
*                                      INDICATOR                     */
         ALR   @11,@04                                          03S0736
         OI    CQEEOB(@11),B'11000000'                          03S0736
*                 END;                                          03S0737
*             END;                                              03S0738
*                                                               03S0738
@RC00716 DS    0H                                               03S0739
*/*** END OF WQEREQU SEGMENT *****************************************/
*                                                               03S0739
*                                                               02S0739
*           /*********************************************************/
*           /*                                                       */
*           /* ELIMINATE DUPLICATES ON THE OUTPUT QUEUE OF THE NEW   */
*           /* CONSOLE                                               */
*           /*                                                       */
*           /*********************************************************/
*                                                               02S0739
*                                                               03S0739
*/*** START OF DUPSRCH SEGMENT ***************************************/
*/*                                                                  */
*/* DUPSRCH - SEARCH FOR DUPLICATE CQE ENTRIES.                      */
*/*                                                                  */
*/* FUNCTION - MARK DUPLICATE ENTRIES ON THE OUTPUT QUEUE OF THE     */
*/*    NEW CONSOLE AS 'NO LONGER NEEDED'.                            */
*/*                                                                  */
*/* INPUT - NEWO = UCME ADDR OF OUTPUT HALF OF NEW CONSOLE           */
*/*                                                                  */
*/* OUTPUT - NONE                                                    */
*/*                                                                  */
*/********************************************************************/
*                                                               03S0739
*           SW1='0'B;               /* INIT END-OF-Q SWITCH          */
@RF00687 NI    SW1,B'01111111'                                  03S0739
*           IF NEWO->UCMOUTQ^=0 THEN/* IS THERE AN OUTPUT Q          */
         L     @11,NEWO                                         03S0740
         L     @11,UCMOUTQ(,@11)                                03S0740
         LTR   @11,@11                                          03S0740
         BZ    @RF00740                                         03S0740
*             DO;                   /* YES                           */
*               CQEPTR=NEWO->UCMOUTQ;/* INIT CQEPTR TO 1ST ENTRY     */
*                                                               03S0742
         ST    @11,CQEPTR                                       03S0742
*               /*****************************************************/
*               /*                                                   */
*               /* OUTER LOOP TO CHECK EACH CQE ENTRY EXCEPT LAST    */
*               /*                                                   */
*               /*****************************************************/
*                                                               03S0743
*               DO WHILE(SW1='0'B);                             03S0743
         B     @DE00743                                         03S0743
@DL00743 DS    0H                                               03S0744
*                 IF CQEPTR->CQEEOQ='1'B THEN                   03S0744
         L     @11,CQEPTR                                       03S0744
         TM    CQEEOQ(@11),B'10000000'                          03S0744
         BNO   @RF00744                                         03S0744
*                   SW1='1'B;                                   03S0745
         OI    SW1,B'10000000'                                  03S0745
*                 ELSE                                          03S0746
*                   DO;             /* DONT DO LAST CQE              */
         B     @RC00744                                         03S0746
@RF00744 DS    0H                                               03S0747
*                     IF CQEPTR->CQEENTR='1'B THEN/* IS THE CQE ENTRY
*                                      VALID                         */
         L     @11,CQEPTR                                       03S0747
         TM    CQEENTR(@11),B'00000001'                         03S0747
         BNO   @RF00747                                         03S0747
*                       DO;         /* YES, SEARCH FOR DUPLICATES OF
*                                      THIS ENTRY                    */
*                         CQEPTR2=CQEPTR+LENGTH(CQEWQE);/* START AT
*                                      NEXT ENTRY                    */
         AL    @11,@CF00065                                     03S0749
         ST    @11,CQEPTR2                                      03S0749
*                         IF CQEPTR2->CQEEOB=ONTWO THEN/* IS IT THE
*                                      END OF A BLOCK                */
         TM    CQEEOB(@11),B'11000000'                          03S0750
         BNO   @RF00750                                         03S0750
*                           CQEPTR2=CQEPTR2->CQEWQEA;/* YES, GET PTR
*                                      TO NEXT BLOCK                 */
         SLR   @04,@04                                          03S0751
         ICM   @04,7,CQEWQEA(@11)                               03S0751
         ST    @04,CQEPTR2                                      03S0751
*                         SW2='0'B; /* INIT END-OF-Q SWITCH          */
*                                                               03S0752
@RF00750 NI    SW2,B'10111111'                                  03S0752
*                         /*******************************************/
*                         /*                                         */
*                         /* SEARCH REMAINING CQE ENTRIES FOR        */
*                         /* DUPLICATES OF CQE ENTRY SELECTED IN     */
*                         /* OUTER LOOP                              */
*                         /*                                         */
*                         /*******************************************/
*                                                               03S0753
*                         DO WHILE(SW2='0'B);/* STOP AT END-OF-QUEUE */
         B     @DE00753                                         03S0753
@DL00753 DS    0H                                               03S0754
*                           IF CQEPTR2->CQEENTR='1'B&CQEPTR2->CQEWQEA=
*                               CQEPTR->CQEWQEA THEN            03S0754
         L     @11,CQEPTR2                                      03S0754
         TM    CQEENTR(@11),B'00000001'                         03S0754
         BNO   @RF00754                                         03S0754
         L     @04,CQEPTR                                       03S0754
         CLC   CQEWQEA(3,@11),CQEWQEA(@04)                      03S0754
         BNE   @RF00754                                         03S0754
*                             DO;   /* DUPLICATE - YES               */
*                               CQEPTR2->CQEENTR='0'B;/* TURN OFF
*                                      ENTRY EXISTS INDICATOR        */
*                               CQEPTR2->CQEAVAIL='1'B;/* INDICATE
*                                      ENTRY IS NO LONGER NEEDED     */
         OI    CQEAVAIL(@11),B'00000010'                        03S0757
         NI    CQEENTR(@11),B'11111110'                         03S0757
*                             END;                              03S0758
*                           IF CQEPTR2->CQEEOQ='0'B THEN/* END-OF-Q ?*/
@RF00754 L     @11,CQEPTR2                                      03S0759
         TM    CQEEOQ(@11),B'10000000'                          03S0759
         BNZ   @RF00759                                         03S0759
*                             DO;   /* NO                            */
*                               CQEPTR2=CQEPTR2+LENGTH(CQEWQE);/*
*                                      INCREMENT PTR TO NEXT ENTRY   */
         AL    @11,@CF00065                                     03S0761
         ST    @11,CQEPTR2                                      03S0761
*                               IF CQEPTR2->CQEEOB=ONTWO THEN/* 03S0762
*                                      END-OF-BLOCK ?                */
         TM    CQEEOB(@11),B'11000000'                          03S0762
         BNO   @RF00762                                         03S0762
*                                 CQEPTR2=CQEPTR2->CQEWQEA;/* GET PTR
*                                      TO NEXT BLOCK                 */
         SLR   @04,@04                                          03S0763
         ICM   @04,7,CQEWQEA(@11)                               03S0763
         ST    @04,CQEPTR2                                      03S0763
*                             END;                              03S0764
*                           ELSE                                03S0765
*                             SW2='1'B;/* INDICATE END-OF-Q WAS FOUND*/
         B     @RC00759                                         03S0765
@RF00759 OI    SW2,B'01000000'                                  03S0765
*                         END;                                  03S0766
@RC00759 DS    0H                                               03S0766
@DE00753 TM    SW2,B'01000000'                                  03S0766
         BZ    @DL00753                                         03S0766
*                       END;                                    03S0767
*                     CQEPTR=CQEPTR+LENGTH(CQEWQE);/* INCREMENT PTR
*                                      TO NEXT ENTRY                 */
@RF00747 LA    @11,4                                            03S0768
         AL    @11,CQEPTR                                       03S0768
         ST    @11,CQEPTR                                       03S0768
*                     IF CQEPTR->CQEEOB=ONTWO THEN/* END-OF-BLOCK ?  */
         TM    CQEEOB(@11),B'11000000'                          03S0769
         BNO   @RF00769                                         03S0769
*                       CQEPTR=CQEPTR->CQEWQEA;/* GET PTR TO NEXT
*                                      BLOCK                         */
         SLR   @04,@04                                          03S0770
         ICM   @04,7,CQEWQEA(@11)                               03S0770
         ST    @04,CQEPTR                                       03S0770
*                   END;                                        03S0771
@RF00769 DS    0H                                               03S0772
*               END;                                            03S0772
@RC00744 DS    0H                                               03S0772
@DE00743 TM    SW1,B'10000000'                                  03S0772
         BZ    @DL00743                                         03S0772
*             END;                                              03S0773
*                                                               03S0773
*/*** END-OF-DUPSRCH SEGMENT *****************************************/
*                                                               03S0774
*                                                               02S0774
*           /*********************************************************/
*           /*                                                       */
*           /* SET UP TO CLOSE THE FAILING CONSOLE                   */
*           /*                                                       */
*           /*********************************************************/
*                                                               02S0774
*                                                               03S0774
*/*** START OF MARKFAIL SEGMENT **************************************/
*/*                                                                  */
*/*  MARKFAIL -IS A ROUTINE TO ADJUST THE VARIOUS BITS AND FIELDS    */
*/*            OF FAILING CONSOLE TO INDICATE ITS STATUS AND TO      */
*/*            CAUSE IT TO BE CLOSED. IT IS USED TO PROCESS CONSOLES.*/
*/*                                                                  */
*/*  INPUT  -  FAILI AND FAILO POINT TO THE INPUT AND OUTPUT HALVES  */
*/*            OF THE FAILING CONSOLE (BOTH POINTERS POINT TO THE    */
*/*            SAME CONSOLE OF IT WAS NOT A COMPOSITE).              */
*/*                                                                  */
*/*  OUTPUT -  UCME UPDATED TO SHOW CLOSE PENDING, NOT BUSY, AND     */
*/*            NO WORK QUEUED TO THE OUTPUT CONSOLE.                 */
*/*                                                                  */
*/********************************************************************/
*                                                               03S0774
*           FAILI->UCMCF='1'B;      /* SET 'CLOSE PENDING'           */
@RF00740 DS    0H                                               03S0775
*           FAILI->UCMBF='0'B;      /* TURN OFF 'DEVICE BUSY'        */
*           FAILI->UCMAF='0'B;      /* TURN OFF ATTENTION PENDING    */
         L     @11,FAILI                                        03S0776
         OI    UCMCF(@11),B'00010000'                           03S0776
         NI    UCMBF(@11),B'01011111'                           03S0776
*           IF FAILI^=FAILO         /* IF FAILING CONSOLE IS COMPOSIT*/
*             THEN                                              03S0777
         L     @04,FAILO                                        03S0777
         CR    @11,@04                                          03S0777
         BE    @RF00777                                         03S0777
*             DO;                   /* THEN PROCESS OUTPUT HALF      */
*               FAILO->UCMCF='1'B;  /* SET 'CLOSE PENDING' IN O-HALF */
*               FAILO->UCMBF='0'B;  /* TURN OFF 'BUSY' IN O-HALF     */
         OI    UCMCF(@04),B'00010000'                           03S0780
         NI    UCMBF(@04),B'11011111'                           03S0780
*             END;                                              03S0781
*                                                               03S0781
*           /*********************************************************/
*           /*                                                       */
*           /* SET OUTPUT QUEUE OF FAILING CONSOLE (OUTPUT HALF IN   */
*           /* THE CASE OF A COMPOSITE) AND PTR TO LAST WQE PROCESSED*/
*           /* TO ZERO.                                              */
*           /*                                                       */
*           /*********************************************************/
*                                                               03S0782
*           FAILO->UCMOUTQ=ZERO;    /* OUTPUT QUEUE                  */
@RF00777 SLR   @11,@11                                          03S0782
         L     @04,FAILO                                        03S0782
         ST    @11,UCMOUTQ(,@04)                                03S0782
*           FAILO->UCMWLAST=ZERO;   /* PTR TO LAST WQE PROCESSED     */
*                                                               03S0783
         ST    @11,UCMWLAST(,@04)                               03S0783
*           /*********************************************************/
*           /*                                                       */
*           /* CLEAR MESSAGE FORMAT FLAGS AND OUTPUT PENDING FLAG (IN*/
*           /* OUTPUT HALF IF COMPOSITE CONSOLE).                    */
*           /*                                                       */
*           /*********************************************************/
*                                                               03S0784
*           FAILO->UCMPF='0'B;      /* TURN OFF OUTPUT PENDING       */
         NI    UCMPF(@04),B'10111111'                           03S0784
*           FAILO->UCMDISPI='0'B;   /* TURN OFF TIME STAMP/JOBID     */
*           FAILO->UCMDISPJ='0'B;   /* TURN OFF JOBID ONLY           */
         NI    UCMDISPI(@04),B'00111111'                        03S0786
*/*** END OF MARKFAIL SEGMENT ****************************************/
*                                                               03S0787
*         END;                                                  02S0787
*     END;                                                      02S0788
*                                                               02S0788
@RF00627 DS    0H                                               02S0789
*   /*****************************************************************/
*   /*                                                               */
*   /* END ANY MONITOR COMMANDS AT THE FAILING CONSOLE CONSTRUCT THE */
*   /* MONITOR PARAMETER LIST FOR IEAVMNTR                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0789
*   MPLPTR=ADDR(MPLDEF);            /* INITIALIZE PTR TO MONITOR
*                                      PARAMETER LIST                */
@RC00614 LA    MPLPTR,MPLDEF                                    02S0789
*   MPLCONS='1'B;                   /* PROCESSING IS FOR A CONSOLE   */
*   MPLSTOP='1'B;                   /* STOP MONITOR                  */
         OI    MPLCONS(MPLPTR),B'10010000'                      02S0791
*   MPLID(2)=FAILI->UCMID;          /* CONSOLE ID OF INPUT HALF OF
*                                      FAILING CONSOLE               */
         L     @11,FAILI                                        02S0792
         MVC   MPLID+1(1,MPLPTR),UCMID(@11)                     02S0792
*   MPLTYPE1='11000100'B;           /* STOP ALL OUTSTANDING MONITOR
*                                      FUNCTIONS IF ANY              */
         MVI   MPLTYPE1(MPLPTR),B'11000100'                     02S0793
*   CALL IEAVMNTR(MPL);             /* STANDARD LINKAGE TO MONITOR
*                                      QUEUE MANAGER WITH LOCKS HELD */
         ST    MPLPTR,@AL00001                                  02S0794
         L     @15,UCMMNTR(,UCMBASPT)                           02S0794
         LA    @01,@AL00001                                     02S0794
         BALR  @14,@15                                          02S0794
*   END SWCONS;                                                 02S0795
*                                                               02S0795
@EL00004 DS    0H                                               02S0795
@EF00004 DS    0H                                               02S0795
@ER00004 LM    @14,@02,@SA00004                                 02S0795
         LM    @04,@12,@SA00004+20                              02S0795
         BR    @14                                              02S0795
*/*** END OF SWCONS SUBROUTINE ***************************************/
*                                                               02S0796
         EJECT
*                                                               02S0796
*/* START OF NOALTM SUBROUTINE ***************************************/
*/*                                                                  */
*/* NOALTM - WHEN THE MASTER IS FAILING AND NO ALTERNATE EXISTS IN   */
*/*          ITS ALTERNATE CHAIN, THIS ROUTINE ISSUES VARY   @ZA08472*/
*/*          MSTCONS MESSAGE. THEN DETERMINES IF ANY FULL    @ZA08472*/
*/*          I/O CONSOLE OR A CRT WITH I/O HARDWARE EXISTS.  @ZA08472*/
*/*          IF SO, THE STATUS OF THE DEVICE IS CHANGED SO   @ZA08472*/
*/*          THAT IT MAY BE USED AFTER VARY MSTCONS IS       @ZA08472*/
*/*          ISSUED. OTHERWISE, A NO CONSOLES CONDITION EXISTS.      */
*/*          IF SO, A CONSOLE WITH A BELL IS SELECTED TO SOUND THE   */
*/*          ALARM AND A 3036 WITH A POWER AND COOLING ALARM @G51APSS*/
*/*          IS SELECTED TO THE SOUND THE ALARM.             @G51APSS*/
*/*                                                                  */
*/* INPUT - NONE.                                                    */
*/*                                                                  */
*/* OUTPUT - AMFAMSG=1  VARY MSTCONS MSG SHOULD BE ISSUED            */
*/*          UCMUF=0    OLD MASTER IS NOT ACTIVE                     */
*/*          UCMSYSD=0  CLEAR MASTER IS FAILING FLAG                 */
*/*          UCMSYSE=1  INDICATES A NO CONSOLES CONDITION            */
*/*          NCCNOW=1   INDICATES THAT A NO-CONSOLES         @G51APSS*/
*/*                     CONDITION WAS ENTERED THIS TIME THRU @G51APSS*/
*/*                     IEAVSWCH                             @G51APSS*/
*/*          RINGBELL=1 BELL SHOULD BE RUNG                          */
*/*          RINGPOWR=1 POWER ALARM SHOULD BE SOUNDED        @G51APSS*/
*/*          BELLCONS=  UCME ADDR OF A CONSOLE WITH A BELL           */
*/*          PWRCONS=   UCME ADDR OF CONSOLE WITH POWER      @G51APSS*/
*/*                     ALARM                                @G51APSS*/
*/*                                                                  */
*/********************************************************************/
*                                                               02S0796
*NOALTM:                                                        02S0796
*   PROC OPTIONS(SAVE);             /*                       @G51APSS*/
NOALTM   STM   @14,@02,@SA00005                                 02S0796
         STM   @04,@12,@SA00005+20                              02S0796
*   AMFAMSG='1'B;                   /* INDICATE MSG IEE141A (VARY
*                                      MSTCONS) SHOULD BE ISSUED.
*                                                            @ZA08472*/
         OI    AMFAMSG,B'01000000'                              02S0797
*   FOUND=NO;                       /* INIT FOUND SWITCH             */
         NI    FOUND,B'11101111'                                02S0798
*                                                               02S0799
*   /*****************************************************************/
*   /*                                                               */
*   /* SEARCH FOR ANY FULL I/O CONSOLE                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0799
*   DO UCMDVEPT=UCMVEA TO UCMVEL BY UCMVEZ WHILE FOUND=NO;      02S0799
         L     UCMDVEPT,UCMVEA(,UCMBASPT)                       02S0799
         B     @DE00799                                         02S0799
@DL00799 TM    FOUND,B'00010000'                                02S0799
         BNZ   @DC00799                                         02S0799
*     FOUND=YES;                    /* FOUND UNLESS FLUNKS ONE OF THE
*                                      FOLLOWING TESTS               */
         OI    FOUND,B'00010000'                                02S0800
*     IF UCMDISPA='1'B×UCMDISPD='1'B THEN/* OUTPUT ONLY OR MASTER    */
         TM    UCMDISPA(UCMDVEPT),B'10010000'                   02S0801
         BZ    @RF00801                                         02S0801
*       FOUND=NO;                   /* YES, CANNOT BE USED.          */
         NI    FOUND,B'11101111'                                02S0802
*     IF UCMCOMPC^=ZERO THEN        /* COMPOSITE?                    */
@RF00801 L     @11,UCMCOMPC(,UCMDVEPT)                          02S0803
         LTR   @11,@11                                          02S0803
         BZ    @RF00803                                         02S0803
*       IF UCMCOMPC->UCMDISPA='1'B THEN/* YES, IS OTHER HALF MASTER? */
         TM    UCMDISPA(@11),B'10000000'                        02S0804
         BNO   @RF00804                                         02S0804
*         FOUND=NO;                 /* YES, IS OTHER HALF THE MASTER */
*                                                               02S0805
         NI    FOUND,B'11101111'                                02S0805
*     /***************************************************************/
*     /*                                                             */
*     /* TEST FOR CLOSE PENDING AND NOT AN ACR REQUEST, OR NOT       */
*     /* ACTIVE, OR I/O PATH AFFECTED BY ACR OR VARY                 */
*     /*                                                             */
*     /***************************************************************/
*                                                               02S0806
*     IF(UCMCF='1'B&CSAACR='0'B)×UCMUF='0'B×UCMVHRSN='1'B THEN  02S0806
@RF00804 DS    0H                                               02S0806
@RF00803 TM    UCMCF(UCMDVEPT),B'00010000'                      02S0806
         BNO   @GL00044                                         02S0806
         TM    CSAACR(CXSAPTR),B'00010000'                      02S0806
         BZ    @RT00806                                         02S0806
@GL00044 TM    UCMUF(UCMDVEPT),B'00010000'                      02S0806
         BZ    @RT00806                                         02S0806
         TM    UCMVHRSN(UCMDVEPT),B'00000001'                   02S0806
         BNO   @RF00806                                         02S0806
@RT00806 DS    0H                                               02S0807
*       FOUND=NO;                   /* YES, CANNOT BE USED.          */
         NI    FOUND,B'11101111'                                02S0807
*   END;                            /* END DO LOOP ON CONSOLES       */
@RF00806 AL    UCMDVEPT,UCMVEZ(,UCMBASPT)                       02S0808
@DE00799 C     UCMDVEPT,UCMVEL(,UCMBASPT)                       02S0808
         BNH   @DL00799                                         02S0808
@DC00799 DS    0H                                               02S0809
*                                                               02S0809
*   /*****************************************************************/
*   /*                                                               */
*   /* IF A FULL I/O CONSOLE WAS NOT FOUND, SEARCH FOR A OUTPUT ONLY */
*   /* CRT WITH I/O HARDWARE AND FORCE IT TO FULL I/O CAPABILITY     */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0809
*   IF FOUND=NO THEN                                            02S0809
         TM    FOUND,B'00010000'                                02S0809
         BNZ   @RF00809                                         02S0809
*     DO UCMDVEPT=UCMVEA TO UCMVEL BY UCMVEZ WHILE FOUND=NO;    02S0810
         L     UCMDVEPT,UCMVEA(,UCMBASPT)                       02S0810
         B     @DE00810                                         02S0810
@DL00810 TM    FOUND,B'00010000'                                02S0810
         BNZ   @DC00810                                         02S0810
*       FOUND=YES;                  /* FOUND UNLESS FLUNKS A TEST    */
         OI    FOUND,B'00010000'                                02S0811
*       IF UCMDISPC='0'B×UCMDISPD='0'B THEN/* OUTPUT ONLY CRT?       */
         TM    UCMDISPC(UCMDVEPT),B'00110000'                   02S0812
         BO    @RF00812                                         02S0812
*         FOUND=NO;                 /* NO, CANNOT BE USED            */
         NI    FOUND,B'11101111'                                02S0813
*       ELSE                        /* YES,                          */
*/* IF THE CONSOLE CAN BE MADE FULL CAPABILITY (I.E. INPUT AND OUTPUT
*   IS ACTIVE, AND NOT CLOSE PENDING OR CLOSE PENDING BUT ACR BEING
*   PROCESSED AND NOT AFFECTED BY ACR OR VARY CHANNEL/CPU.           */
*                                                               02S0814
*         IF UCMSDS5G='1'B&UCMUF='1'B&(UCMCF='0'B×CSAACR='1'B)&UCMVHRSN
*             ='0'B THEN                                        02S0814
         B     @RC00812                                         02S0814
@RF00812 TM    UCMSDS5G(UCMDVEPT),B'00000010'                   02S0814
         BNO   @RF00814                                         02S0814
         TM    UCMUF(UCMDVEPT),B'00010000'                      02S0814
         BNO   @RF00814                                         02S0814
         TM    UCMCF(UCMDVEPT),B'00010000'                      02S0814
         BZ    @GL00046                                         02S0814
         TM    CSAACR(CXSAPTR),B'00010000'                      02S0814
         BNO   @RF00814                                         02S0814
@GL00046 TM    UCMVHRSN(UCMDVEPT),B'00000001'                   02S0814
         BNZ   @RF00814                                         02S0814
*           DO;                     /* YES, CONDITIONS HAVE BEEN MET */
*             NEWI=UCMDVEPT;        /* SET UP FOR SWFULCAP           */
         LR    NEWI,UCMDVEPT                                    02S0816
*             CALL SWFULCAP;        /* FORCE TO FULL I/O STATUS      */
         BAL   @14,SWFULCAP                                     02S0817
*           END;                                                02S0818
*         ELSE                                                  02S0819
*           FOUND=NO;               /* NO, CANNOT BE USED            */
         B     @RC00814                                         02S0819
@RF00814 NI    FOUND,B'11101111'                                02S0819
*     END;                                                      02S0820
*                                                               02S0820
@RC00814 DS    0H                                               02S0820
@RC00812 AL    UCMDVEPT,UCMVEZ(,UCMBASPT)                       02S0820
@DE00810 C     UCMDVEPT,UCMVEL(,UCMBASPT)                       02S0820
         BNH   @DL00810                                         02S0820
@DC00810 DS    0H                                               02S0821
*   /*****************************************************************/
*   /*                                                               */
*   /* IF A FULL I/O CONSOLE WAS FOUND OR AN OUTPUT-ONLY CRT WAS     */
*   /* FORCED TO FULL I/O, VARY MSTCONS WILL BE ACCEPTED FROM ANY    */
*   /* CONSOLE.                                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0821
*   IF FOUND=YES THEN               /* WAS A CONSOLE SUITABLE FOR A
*                                      MASTER FOUND?                 */
@RF00809 TM    FOUND,B'00010000'                                02S0821
         BNO   @RF00821                                         02S0821
*     DO;                           /* YES,                          */
*       UCMDVEPT=UCMDVEPT-UCMVEZ;   /* BACK UP UMCE PTR TO SUITABLE
*                                      CONSOLE.                      */
         SL    UCMDVEPT,UCMVEZ(,UCMBASPT)                       02S0823
*       IF UCMCF='1'B               /* IF CONSOLE HAS CLOSE PENDING  */
*         THEN                                                  02S0824
         TM    UCMCF(UCMDVEPT),B'00010000'                      02S0824
         BNO   @RF00824                                         02S0824
*         DO;                                                   02S0825
*           UCMCF='0'B;             /* TURN OFF CLOSE PENDING        */
         NI    UCMCF(UCMDVEPT),B'11101111'                      02S0826
*           UCBCHGSX='0'B;          /* TURN OFF CHANGING TO OFFLINE  */
*           UCBDADIX='0'B;          /* STOP CHANGE FROM CONSOLE      */
         L     @01,UCBPTR(,UCMDVEPT)                            02S0828
         L     @11,UCBDADIX-3(,@01)                             02S0828
@GL00050 LR    @04,@11                                          02S0828
         N     @04,@CF03977                                     02S0828
         CS    @11,@04,UCBDADIX-3(@01)                          02S0828
         BNE   @GL00050                                         02S0828
*         END;                                                  02S0829
*     END;                                                      02S0830
*   ELSE                            /* NO, NO CONSOLES CONDITION
*                                      EXIST                         */
*     DO;                                                       02S0831
*                                                               02S0831
         B     @RC00821                                         02S0831
@RF00821 DS    0H                                               02S0832
*       /*************************************************************/
*       /*                                                           */
*       /* A NO-CONSOLES CONDITION EXISTS                    @G51APSS*/
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0832
*       UCMAMFA='0'B;               /* TURN OFF ACCEPT VARY MSTCONS
*                                      FROM ANYWHERE         @G51APSS*/
         NI    UCMAMFA(UCMBASPT),B'11110111'                    02S0832
*       AMFAMSG='0'B;               /* MSG IEE141A SHOULD NOT BE
*                                      ISSUED                @G51APSS*/
         NI    AMFAMSG,B'10111111'                              02S0833
*       IF UCMSYSE='0'B THEN        /* DID A NO-CONSOLES CONDITION
*                                      EXIST BEFORE?         @G51APSS*/
         TM    UCMSYSE(UCMMCSPT),B'00001000'                    02S0834
         BNZ   @RF00834                                         02S0834
*         DO;                       /* NO                    @G51APSS*/
*           UCMSYSE='1'B;           /* MARK THAT ONE EXISTS NOW 02S0836
*                                                            @G51APSS*/
         OI    UCMSYSE(UCMMCSPT),B'00001000'                    02S0836
*           UCMFATCN='80000000'X;   /* SET SO IEAVVCRA WILL NOT ALLOW
*                                      A CANDIDATE TO BE CHOSEN YET
*                                                            @G51APSS*/
         L     @11,UCMFXPTR(,UCMBASPT)                          02S0837
         MVC   UCMFATCN(4,@11),@CF03732                         02S0837
*           NCCNOW=YES;             /* NO-CONSOLES CONDITION OCCURED
*                                      THIS TIME THRU VSWCH  @ZA18879*/
         OI    NCCNOW,B'01000000'                               02S0838
*           CALL FNDALARM;          /* FIND A CONSOLE WITH AN ALARM
*                                      TO SOUND              @G51APSS*/
         BAL   @14,FNDALARM                                     02S0839
*           CALL FNDPOWER;          /* FIND A 3036 CONSOLE WITH THE
*                                      POWER AND COOLING ALARM  02S0840
*                                                            @G51APSS*/
         BAL   @14,FNDPOWER                                     02S0840
*         END;                      /* OF NO-CONSOLES CONDITION JUST
*                                      CAME INTO EXISTENCE   @G51APSS*/
*     END;                          /* OF NO-CONSOLES CONDITION 02S0842
*                                                            @G51APSS*/
@RF00834 DS    0H                                               02S0843
*   MASTERI->UCMUF='0'B;            /* INDICATE MASTER IS NOT ACTIVE */
@RC00821 L     @11,MASTERI                                      02S0843
         NI    UCMUF(@11),B'11101111'                           02S0843
*   IF MASTERO^=ZERO THEN           /* MASTER A COMPOSITE?   @ZA20165*/
         L     @11,MASTERO                                      02S0844
         LTR   @11,@11                                          02S0844
         BZ    @RF00844                                         02S0844
*     MASTERO->UCMUF='0'B;          /* YES, INDICATE THE OUTPUT HALF
*                                      IS NOT ACTIVE         @ZA20165*/
         NI    UCMUF(@11),B'11101111'                           02S0845
*   END NOALTM;                     /*                       @G51APSS*/
@EL00005 DS    0H                                               02S0846
@EF00005 DS    0H                                               02S0846
@ER00005 LM    @14,@02,@SA00005                                 02S0846
         LM    @04,@12,@SA00005+20                              02S0846
         BR    @14                                              02S0846
*/*** END OF NOALTM SUBROUTINE ***************************************/
*                                                               02S0847
         EJECT
*                                                               02S0847
*/*** START OF FNDALARM SUBROUTINE ***********************************/
*/*                                                                  */
*/* FNDALARM - SEARCH FOR A CONSOLE WHICH HAS AN ALARM WHICH @G51APSS*/
*/*            CAN BE SOUNDED.                               @G51APSS*/
*/*                                                                  */
*/* INPUT    - NONE                                          @G51APSS*/
*/*                                                                  */
*/* OUTPUT   - RINGBELL = ON IF A CONSOLE WITH AN ALARM WAS  @G51APSS*/
*/*                       WAS FOUND                          @G51APSS*/
*/*            BELLCONS = UCME ADDR OF CONSOLE WITH ALARM    @G51APSS*/
*/*                                                                  */
*/********************************************************************/
*                                                               02S0847
*FNDALARM:                                                      02S0847
*   PROC OPTIONS(SAVE);             /*                       @G51APSS*/
*                                                               02S0847
FNDALARM STM   @14,@12,@SA00006                                 02S0847
*   /*****************************************************************/
*   /*                                                               */
*   /* SEARCH FOR AN DEVICE IN CONSOLE STATUS WHICH HAS A BELL       */
*   /*                                                       @G51APSS*/
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0848
*   FOUND=NO;                       /* NONE FOUND YET        @G51APSS*/
         NI    FOUND,B'11101111'                                02S0848
*   DO UCMDVEPT=UCMVEA TO UCMVEL BY UCMVEZ WHILE FOUND=NO;      02S0849
         L     UCMDVEPT,UCMVEA(,UCMBASPT)                       02S0849
         B     @DE00849                                         02S0849
@DL00849 TM    FOUND,B'00010000'                                02S0849
         BNZ   @DC00849                                         02S0849
*     IF UCMNAME(4:5)='00'          /* IS THE CONSOLE'S DEVICE  02S0850
*                                      PROCESSOR NAME IGC0007B       */
*         ×(UCMDISPC='1'B&UCBTYP(3:4)^=DEV2260) THEN/* OR IS THE
*                                      CONSOLE GRAPHICS BUT NOT A
*                                      2260                          */
*                                                               02S0850
         CLC   UCMNAME+3(2,UCMDVEPT),@CC00120                   02S0850
         BE    @RT00850                                         02S0850
         TM    UCMDISPC(UCMDVEPT),B'00100000'                   02S0850
         BNO   @RF00850                                         02S0850
         L     @11,UCBPTR(,UCMDVEPT)                            02S0850
         CLC   UCBTYP+2(2,@11),@CB00337                         02S0850
         BE    @RF00850                                         02S0850
@RT00850 DS    0H                                               02S0851
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK TO SEE IF DEVICE IS OK TO USE               @ZA18885*/
*       /*                                                           */
*       /*************************************************************/
*                                                               02S0851
*       IF UCBONLI='1'B&            /* DEVICE ONLINE?        @ZA18885*/
*           UCBSYSR='1'B&           /* IS A CONSOLE?         @ZA18885*/
*           UCBVHRSN='0'B&          /* HAS AN I/O PATH?      @ZA18885*/
*           UCBNRY='0'B THEN        /* DEVICE IS READY?      @ZA18885*/
         L     @11,UCBPTR(,UCMDVEPT)                            02S0851
         TM    UCBONLI(@11),B'10000010'                         02S0851
         BNO   @RF00851                                         02S0851
         TM    UCBVHRSN(@11),B'00000010'                        02S0851
         BNZ   @RF00851                                         02S0851
         TM    UCBNRY(@11),B'01000000'                          02S0851
         BNZ   @RF00851                                         02S0851
*         DO;                       /* YES                   @ZA18885*/
*           FOUND=YES;              /* OK, RING ITS BELL     @ZA05340*/
         OI    FOUND,B'00010000'                                02S0853
*           CALL VERGRAF;           /* DETERMINE IF THIS IS A DISPLAY
*                                      UNIT WITH THE ALARM FEATURE
*                                                            @G51APSS*/
         BAL   @14,VERGRAF                                      02S0854
*         END;                      /*                       @G51APSS*/
*   END;                            /* END CONSOLE SEARCH LOOP       */
@RF00851 DS    0H                                               02S0856
@RF00850 AL    UCMDVEPT,UCMVEZ(,UCMBASPT)                       02S0856
@DE00849 C     UCMDVEPT,UCMVEL(,UCMBASPT)                       02S0856
         BNH   @DL00849                                         02S0856
@DC00849 DS    0H                                               02S0857
*                                                               02S0857
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NONE COULD BE FOUND, SEARCH FOR A DEVICE WITH A ALARM THAT */
*   /* IS ONLINE AND NOT ALLOCATED.                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0857
*   IF FOUND=NO THEN                                            02S0857
         TM    FOUND,B'00010000'                                02S0857
         BNZ   @RF00857                                         02S0857
*     DO UCMDVEPT=UCMVEA TO UCMVEL BY UCMVEZ WHILE FOUND=NO;    02S0858
         L     UCMDVEPT,UCMVEA(,UCMBASPT)                       02S0858
         B     @DE00858                                         02S0858
@DL00858 TM    FOUND,B'00010000'                                02S0858
         BNZ   @DC00858                                         02S0858
*       IF UCMNAME(4:5)='00'        /* IS THE CONSOLE'S DEVICE  02S0859
*                                      PROCESSOR NAME IGC0007B       */
*           ×(UCMDISPC='1'B&UCBTYP(3:4)^=DEV2260)/* OR IS THE CONSOLE
*                                      GRAPHICS BUT NOT A 2260       */
*         THEN                                                  02S0859
*                                                               02S0859
         CLC   UCMNAME+3(2,UCMDVEPT),@CC00120                   02S0859
         BE    @RT00859                                         02S0859
         TM    UCMDISPC(UCMDVEPT),B'00100000'                   02S0859
         BNO   @RF00859                                         02S0859
         L     @11,UCBPTR(,UCMDVEPT)                            02S0859
         CLC   UCBTYP+2(2,@11),@CB00337                         02S0859
         BE    @RF00859                                         02S0859
@RT00859 DS    0H                                               02S0860
*         /***********************************************************/
*         /*                                                         */
*         /* CHECK TO SEE IF DEVICE IS OK TO USE             @ZA18885*/
*         /*                                                         */
*         /***********************************************************/
*                                                               02S0860
*         IF UCBONLI='1'B&          /* DEVICE IS ONLINE      @ZA18885*/
*             UCBALOC='0'B&         /* DEVICE IS UNALLOCATED @ZA18885*/
*             UCBVHRSN='0'B&        /* HAS AN I/O PATH?      @ZA18885*/
*             UCBNRY='0'B&          /* DEVICE IS READY?      @ZA18885*/
*             UCMDISPK='0'B THEN    /* NOT A JES3 CONSOLE    @ZA18885*/
         L     @11,UCBPTR(,UCMDVEPT)                            02S0860
         TM    UCBONLI(@11),B'10000000'                         02S0860
         BNO   @RF00860                                         02S0860
         TM    UCBALOC(@11),B'00001000'                         02S0860
         BNZ   @RF00860                                         02S0860
         TM    UCBVHRSN(@11),B'00000010'                        02S0860
         BNZ   @RF00860                                         02S0860
         TM    UCBNRY(@11),B'01000000'                          02S0860
         BNZ   @RF00860                                         02S0860
         TM    UCMDISPK(UCMDVEPT),B'00100000'                   02S0860
         BNZ   @RF00860                                         02S0860
*           DO;                     /* YES                   @ZA18885*/
*             FOUND=YES;            /* OK, RING ITS BELL             */
         OI    FOUND,B'00010000'                                02S0862
*             CALL VERGRAF;         /* DETERMINE IF THIS IS A DISPLAY
*                                      UNIT WITH THE ALARM FEATURE
*                                                            @G51APSS*/
         BAL   @14,VERGRAF                                      02S0863
*           END;                    /*                       @G51APSS*/
*     END;                                                      02S0865
@RF00860 DS    0H                                               02S0865
@RF00859 AL    UCMDVEPT,UCMVEZ(,UCMBASPT)                       02S0865
@DE00858 C     UCMDVEPT,UCMVEL(,UCMBASPT)                       02S0865
         BNH   @DL00858                                         02S0865
@DC00858 DS    0H                                               02S0866
*                                                               02S0866
*   /*****************************************************************/
*   /*                                                               */
*   /* WAS ANY DEVICE WITH A BELL FOUND?                     @G51APSS*/
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0866
*   IF FOUND=YES THEN               /* WAS A CONSOLE WITH A BELL
*                                      FOUND                         */
@RF00857 TM    FOUND,B'00010000'                                02S0866
         BNO   @RF00866                                         02S0866
*     DO;                           /* YES,                          */
*       BELLCONS=UCMDVEPT-UCMVEZ;   /* STORE PTR TO BELL CONSOLE     */
         LR    @11,UCMDVEPT                                     02S0868
         SL    @11,UCMVEZ(,UCMBASPT)                            02S0868
         ST    @11,BELLCONS                                     02S0868
*       RINGBELL='1'B;              /* INDICATE BELL SHOULD BE RUNG  */
         OI    RINGBELL,B'01000000'                             02S0869
*     END;                                                      02S0870
*   ELSE                            /* NO CONSOLE WITH A BELL OTHER
*                                      THAN POSSIBLY         @ZA10757*/
*     DO;                           /* MASTER WAS FOUND. WAS A MASTER
*                                      WITH ALARM FOUND      @ZA10757*/
         B     @RC00866                                         02S0871
@RF00866 DS    0H                                               02S0872
*       IF MSTFOUND='1'B×MSTGRFND='1'B THEN/*                @ZA10757*/
         TM    MSTFOUND,B'00000011'                             02S0872
         BZ    @RF00872                                         02S0872
*         DO;                       /* YES, A MASTER WITH AN ALARM
*                                      WAS FOUND.            @ZA10757*/
*           BELLCONS=UCMMCENT;      /* STORE PTR TO BELL CONS.  02S0874
*                                                            @ZA10757*/
         MVC   BELLCONS(4),UCMMCENT(UCMMCSPT)                   02S0874
*           RINGBELL='1'B;          /* INDICATE BELL TO BE RUNG.
*                                                            @ZA10757*/
         OI    RINGBELL,B'01000000'                             02S0875
*           IF MSTGRFND='1'B THEN   /* WAS MASTER GRAPHICS   @ZA10757*/
         TM    MSTGRFND,B'00000001'                             02S0876
         BNO   @RF00876                                         02S0876
*             GRFSW='1'B;           /* YES, TURN ON INDICATOR   02S0877
*                                                            @ZA10757*/
         OI    GRFSW,B'00000100'                                02S0877
*         END;                      /*                       @G51APSS*/
*     END;                          /*                       @ZA10757*/
*   END FNDALARM;                   /*                       @G51APSS*/
@EL00006 DS    0H                                               02S0880
@EF00006 DS    0H                                               02S0880
@ER00006 LM    @14,@12,@SA00006                                 02S0880
         BR    @14                                              02S0880
*/*** END OF FNDALARM SUBROUTINE *************************************/
*                                                               02S0881
         EJECT
*                                                               02S0881
*/*** START OF VERGRAF SUBROUTINE ************************************/
*/*                                                                  */
*/* VERGRAF  - DETERMINE IF THE DEVICE POINTED TO BY         @G51APSS*/
*/*            UCMDVEPT IS A GRAPHICS DEVICE WITH THE ALARM  @G51APSS*/
*/*            FEATURE INSTALLED.                            @G51APSS*/
*/*                                                                  */
*/* INPUT    - UCMDVEPT - DEVICES UCME                       @G51APSS*/
*/*            FOUND = YES  A DEVICE WAS FOUND TO TEST       @G51APSS*/
*/*            MSTGRFND = NO                                 @G51APSS*/
*/*            GRFSW = NO                                    @G51APSS*/
*/*            MSTFOUND = NO                                 @G51APSS*/
*/*                                                                  */
*/* OUTPUT   - FOUND = NO IF A DEVICE WITH AN ALARM WAS      @G51APSS*/
*/*                  NOT FOUND.                              @G51APSS*/
*/*            MSTGRFND = YES IF THE MASTER CONSOLE IS A     @G51APSS*/
*/*                  GRAPHICS DEVICE AND HAS AN ALARM        @G51APSS*/
*/*            GRFSW = YES IF A GRAPHICS DEVICE WAS FOUND    @G51APSS*/
*/*                  WITH AN ALARM AND THE DEVICE WAS NOT    @G51APSS*/
*/*                  THE MASTER CONSOLE.                     @G51APSS*/
*/*            MSTFOUND = YES IF THE DEVICE WAS A PAPER      @G51APSS*/
*/*                  DEVICE AND IT WAS THE MASTER CONSOLE.   @G51APSS*/
*/*                                                                  */
*/********************************************************************/
*                                                               02S0881
*VERGRAF:                                                       02S0881
*   PROC OPTIONS(SAVE);             /*                       @G51APSS*/
VERGRAF  STM   @14,@12,12(@13)                                  02S0881
*   IF UCMDISPC='1'B THEN           /* GRAPHICS DEVICE       @ZA08472*/
*                                                               02S0882
         TM    UCMDISPC(UCMDVEPT),B'00100000'                   02S0882
         BNO   @RF00882                                         02S0882
*     /***************************************************************/
*     /*                                                             */
*     /* NOW CHECK FOR GRAPHICS TYPE                         @ZA08472*/
*     /* 3270, 3158, 3284, 3286 OR 3036                      @G51APSS*/
*     /*                                                             */
*     /***************************************************************/
*                                                               02S0883
*     DO;                           /*                       @ZA08472*/
*       IF UCBTYP(3:4)=DEV3270×     /*                       @ZA08472*/
*           UCBTYP(3:4)=DEV3158×    /*                       @G51APSS*/
*           UCBTYP(3:4)=DEV3036 THEN/*                       @G51APSS*/
*                                                               02S0884
         L     @04,UCBPTR(,UCMDVEPT)                            02S0884
         CLC   UCBTYP+2(2,@04),@CB00343                         02S0884
         BE    @RT00884                                         02S0884
         CLC   UCBTYP+2(2,@04),@CB00341                         02S0884
         BE    @RT00884                                         02S0884
         CLC   UCBTYP+2(2,@04),@CB00339                         02S0884
         BNE   @RF00884                                         02S0884
@RT00884 DS    0H                                               02S0885
*         /***********************************************************/
*         /*                                                         */
*         /* NOW CHECK FOR ALARM FEATURE                     @ZA08472*/
*         /*                                                         */
*         /***********************************************************/
*                                                               02S0885
*         IF UCB2OPT3='1'B THEN     /*                       @ZA08472*/
         L     @04,UCBPTR(,UCMDVEPT)                            02S0885
         TM    UCB2OPT3(@04),B'00010000'                        02S0885
         BNO   @RF00885                                         02S0885
*           DO;                     /* IS THIS THE MASTER CONSOLE
*                                      DEV.                  @ZA10757*/
*             IF UCMDVEPT=UCMMCENT THEN/*                    @ZA10757*/
         C     UCMDVEPT,UCMMCENT(,UCMMCSPT)                     02S0887
         BNE   @RF00887                                         02S0887
*               DO;                 /* YES, BYPASS FOR NOW AND  02S0888
*                                                            @ZA10757*/
*                 MSTGRFND=YES;     /* CONTINUE SCAN         @ZA10757*/
*                 FOUND=NO;         /* REMEMBER WE FOUND     @ZA10757*/
         OI    MSTGRFND,B'00000001'                             02S0890
         NI    FOUND,B'11101111'                                02S0890
*               END;                /* A GRAPHICS MASTER     @ZA10757*/
*             ELSE                  /* SET 3270/3158/3036 GRAPHICS
*                                      CCW SWITCH            @G51APSS*/
*               GRFSW=YES;          /*                       @G51PASS*/
         B     @RC00887                                         02S0892
@RF00887 OI    GRFSW,B'00000100'                                02S0892
*           END;                    /*                       @ZA08472*/
*         ELSE                      /* ALARM FEATURE NOT ON  @ZA08472*/
*           FOUND=NO;               /* RESUME SCAN           @ZA08472*/
         B     @RC00885                                         02S0894
@RF00885 NI    FOUND,B'11101111'                                02S0894
*       ELSE                        /*                       @ZA08472*/
*         IF UCBTYP(3:4)=DEV3284×   /*                       @ZA08472*/
*             UCBTYP(3:4)=DEV3286 THEN/*                     @ZA08472*/
         B     @RC00884                                         02S0895
@RF00884 L     @04,UCBPTR(,UCMDVEPT)                            02S0895
         CLC   UCBTYP+2(2,@04),@CB00345                         02S0895
         BE    @RT00895                                         02S0895
         CLC   UCBTYP+2(2,@04),@CB00347                         02S0895
         BNE   @RF00895                                         02S0895
@RT00895 DS    0H                                               02S0896
*           FOUND=NO;               /* RESUME SCAN           @ZA08472*/
         NI    FOUND,B'11101111'                                02S0896
*     END;                          /* END GRAPHICS CHECK    @ZA08472*/
*   ELSE                            /* NOT GRAPHICS DEVICE   @ZA08472*/
*     DO;                           /* IS THIS THE MASTER CONSOLE
*                                      DEVICE                @ZA10757*/
         B     @RC00882                                         02S0898
@RF00882 DS    0H                                               02S0899
*       IF UCMDVEPT=UCMMCENT THEN   /*                       @ZA10757*/
         C     UCMDVEPT,UCMMCENT(,UCMMCSPT)                     02S0899
         BNE   @RF00899                                         02S0899
*         DO;                       /* YES, BYPASS FOR NOW AND  02S0900
*                                      CONTINUE              @ZA10757*/
*           MSTFOUND=YES;           /* SCAN REMEMBER WE      @ZA10757*/
*           FOUND=NO;               /* FOUND A PAPER         @ZA10757*/
         OI    MSTFOUND,B'00000010'                             02S0902
         NI    FOUND,B'11101111'                                02S0902
*         END;                      /* MASTER.               @ZA10757*/
*     END;                          /*                       @ZA10757*/
*   END VERGRAF;                    /*                       @G51APSS*/
@EL00007 DS    0H                                               02S0905
@EF00007 DS    0H                                               02S0905
@ER00007 LM    @14,@12,12(@13)                                  02S0905
         BR    @14                                              02S0905
*/*** END OF VERGRAF SUBROUTINE **************************************/
*                                                               02S0906
         EJECT
*                                                               02S0906
*/*** START OF FNDPOWER SUBROUTINE ***********************************/
*/*                                                                  */
*/* FNDPOWER - SEARCH FOR AN ONLINE 3036. THIS DEVICE HAS    @G51APSS*/
*/*            A POWER AND COOLING ALARM AS A STANDARD       @G51APSS*/
*/*            FEATURE.                                      @G51APSS*/
*/*                                                                  */
*/* INPUT    - NONE                                          @G51APSS*/
*/*                                                                  */
*/* OUTPUT   - RINGPOWR= ON IF A 3036 DEVICE WAS FOUND       @G51APSS*/
*/*            PWRCONS = UCME ADDR OF CONSOLE WITH ALARM     @G51APSS*/
*/*                                                                  */
*/********************************************************************/
*                                                               02S0906
*FNDPOWER:                                                      02S0906
*   PROC OPTIONS(SAVE);             /*                       @G51APSS*/
*                                                               02S0906
FNDPOWER STM   @14,@12,12(@13)                                  02S0906
*   /*****************************************************************/
*   /*                                                               */
*   /* SEARCH THE UCMES FOR A 3036 DEVICE THAT IS ONLINE, READY,     */
*   /* UNALLOCATED, HAS AN I/O PATH AND IS NOT A JES3 CONSOLE. IF ONE*/
*   /* IS FOUND THEN THE POWER AND COOLING ALARM WILL BE SOUNDED ON  */
*   /* THIS DEVICE. IF THE DEVICE WHOS CONSOLE ALARM IS TO BE RUNG IS*/
*   /* THE SAME AS THE ONE FOUND IN THIS LOOP THEN CONTINUE          */
*   /* SEARCHING. IF ANOTHER DEVICE IS NOT FOUND THEN USE THE        */
*   /* PREVIOULY FOUND DEVICE                                @G51APSS*/
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S0907
*   FOUND=NO;                       /* NONE FOUND YET        @G51APSS*/
         NI    FOUND,B'11101111'                                02S0907
*   DO UCMDVEPT=UCMVEA TO UCMVEL BY UCMVEZ WHILE FOUND=NO;/* @G51APSS*/
         L     UCMDVEPT,UCMVEA(,UCMBASPT)                       02S0908
         B     @DE00908                                         02S0908
@DL00908 TM    FOUND,B'00010000'                                02S0908
         BNZ   @DC00908                                         02S0908
*     IF UCBTYP(3:4)=DEV3036&       /* DEVICE WITH POWER ALARM? 02S0909
*                                                            @G51APSS*/
*         UCBONLI='1'B&             /* DEVICE ONLINE?        @G51APSS*/
*         UCBALOC='0'B&             /* DEVICE UNALLOCATED?   @G51APSS*/
*         UCBVHRSN='0'B&            /* HAS AN I/O PATH?      @G51APSS*/
*         UCBNRY='0'B&              /* DEVICE IS READY?      @ZA18885*/
*         UCMDISPK='0'B THEN        /* NOT A JES3 CONSOLE?   @G51APSS*/
         L     @11,UCBPTR(,UCMDVEPT)                            02S0909
         CLC   UCBTYP+2(2,@11),@CB00339                         02S0909
         BNE   @RF00909                                         02S0909
         TM    UCBONLI(@11),B'10000000'                         02S0909
         BNO   @RF00909                                         02S0909
         TM    UCBALOC(@11),B'00001000'                         02S0909
         BNZ   @RF00909                                         02S0909
         TM    UCBVHRSN(@11),B'00000010'                        02S0909
         BNZ   @RF00909                                         02S0909
         TM    UCBNRY(@11),B'01000000'                          02S0909
         BNZ   @RF00909                                         02S0909
         TM    UCMDISPK(UCMDVEPT),B'00100000'                   02S0909
         BNZ   @RF00909                                         02S0909
*       DO;                         /* YES TO ALL OF ABOVE   @G51APSS*/
*         PWRCONS=UCMDVEPT;         /* UCME ADDR OF CONSOLE  @G51APSS*/
         ST    UCMDVEPT,PWRCONS                                 02S0911
*         RINGPOWR=YES;             /* SOUND POWER ALARM     @G51APSS*/
         OI    RINGPOWR,B'00100000'                             02S0912
*         IF BELLCONS^=PWRCONS THEN /* SAME DEVICE AS THE ONE WHOSE
*                                      CONSOLE ALARM IS TO BE RUNG?
*                                                            @G51APSS*/
         L     @11,PWRCONS                                      02S0913
         C     @11,BELLCONS                                     02S0913
         BE    @RF00913                                         02S0913
*           FOUND=YES;              /* NO, OK TO USE THIS DEVICE.
*                                      STOP SEARCHING.       @G51APSS*/
         OI    FOUND,B'00010000'                                02S0914
*       END;                        /*                       @G51APSS*/
@RF00913 DS    0H                                               02S0916
*   END;                            /* OF LOOP TO FIND CONSOLE WITH A
*                                      POWER ALARM           @G51APSS*/
@RF00909 AL    UCMDVEPT,UCMVEZ(,UCMBASPT)                       02S0916
@DE00908 C     UCMDVEPT,UCMVEL(,UCMBASPT)                       02S0916
         BNH   @DL00908                                         02S0916
@DC00908 DS    0H                                               02S0917
*   END FNDPOWER;                   /*                       @G51APSS*/
@EL00008 DS    0H                                               02S0917
@EF00008 DS    0H                                               02S0917
@ER00008 LM    @14,@12,12(@13)                                  02S0917
         BR    @14                                              02S0917
*/*** END OF FNDPOWER SUBROUTINE *************************************/
*                                                               02S0918
         EJECT
*                                                               02S0918
*/*** START OF SETOSW SUBROUTINE *************************************/
*/*                                                                  */
*/* SETOSW - TRANSFERS CONSOLE FUNCTIONS FROM THE OLD TO THE NEW     */
*/*    CONSOLE.                                                      */
*/*                                                                  */
*/* FUNCTION - ADDS AUTHORITY & ROUTCODES OF OLD CONSOLE TO NEW,     */
*/*    ADJUSTS MASTER INDICATORS WHEN OLD/NEW CONSOLE IS THE MASTER. */
*/*                                                                  */
*/* INPUT - FAILI = UCME ADDR OF INPUT HALF OF OLD CONSOLE           */
*/*         FAILO = UCME ADDR OF OUTPUTHALF OF OLD CONSOLE OR 0      */
*/*         NEWI  = UCME ADDR OF INPUT HALF OF NEW CONSOLE           */
*/*         NEWO  = UCME ADDR OF OUTPUTHALF OF NEW CONSOLE OR 0      */
*/*         MASTERI = UCME ADDR OF INPUT HALF OF MASTER              */
*/*                                                                  */
*/* OUTPUT - UCMSYSM = 1 IF FAILING CONS IS COMPOSITE                */
*/*          UCMSYSK = 1 IF NEW CONS IS COMPOSITE                    */
*/*          UCMMCENT = UCME ADDR OF NEW MASTER IF MASTER IS FAILING */
*/*          UCMDISPA SET IN NEW/OLD MASTER                          */
*/*          FAILO = FAILI IF FAILING IS NOT COMPOSITE               */
*/*          NEWO = NEWI IF NEW IS NOT COMPOSITE                     */
*/*                                                                  */
*/********************************************************************/
*                                                               02S0918
*SETOSW:                                                        02S0918
*   PROC OPTIONS(SAVE(REG14),NOSAVEAREA);                       02S0918
SETOSW   ST    @14,12(,@13)                                     02S0918
*   CALL CLEARDVC;                  /* CLEAR DEVICE TESTED FLAGS     */
         BAL   @14,CLEARDVC                                     02S0919
*   IF FAILO=ZERO THEN              /* IF FAILING CONSOLE IS NOT A
*                                      COMPOSITE                     */
         ICM   @11,15,FAILO                                     02S0920
         BNZ   @RF00920                                         02S0920
*     FAILO=FAILI;                  /* MAKE OUTPUT HALF UCME ADDR
*                                      SAME AS INPUT HALF            */
         MVC   FAILO(4),FAILI                                   02S0921
*   IF NEWO=ZERO THEN               /* IF NEW CONSOLE IS NOT A  02S0922
*                                      COMPOSITE                     */
@RF00920 ICM   @11,15,NEWO                                      02S0922
         BNZ   @RF00922                                         02S0922
*     NEWO=NEWI;                    /* MAKE OUTPUT HALF UCME ADDR
*                                      SAME AS INPUT HALF            */
         ST    NEWI,NEWO                                        02S0923
*   NEWI->UCMAUTH=NEWI->UCMAUTH×FAILI->UCMAUTH;/* ADD AUTHORITY OF
*                                      FAILING CONSOLE TO NEW CONSOLE*/
@RF00922 L     @11,FAILI                                        02S0924
         OC    UCMAUTH(2,NEWI),UCMAUTH(@11)                     02S0924
*   IF FAILI=MASTERI THEN           /* IS MASTER FAILING             */
         C     @11,MASTERI                                      02S0925
         BNE   @RF00925                                         02S0925
*     DO;                           /* YES, ADJUST MASTER INDICATERS */
*       MSTSWTCH='1'B;              /* SET MASTER FAILING FLAG FOR
*                                      SUB-SYSTEM INTERFACE. @ZA03626*/
         OI    MSTSWTCH,B'00001000'                             02S0927
*       FAILI->UCMDISPA='0'B;       /* TURN OFF MASTER FLAG IN  02S0928
*                                      FAILING CONS                  */
         NI    UCMDISPA(@11),B'01111111'                        02S0928
*       NEWI->UCMDISPA='1'B;        /* TURN ON MASTER FLAG IN NEW
*                                      CONS                          */
         OI    UCMDISPA(NEWI),B'10000000'                       02S0929
*       UCMMCENT=NEWI;              /* STORE PTR TO NEW MASTER       */
         ST    NEWI,UCMMCENT(,UCMMCSPT)                         02S0930
*     END;                                                      02S0931
*   NEWO->UCMRTCD=NEWO->UCMRTCD×FAILO->UCMRTCD;/* ADD FAILING CONS
*                                      ROUTCODES TO NEW CONSOLE      */
@RF00925 L     @11,NEWO                                         02S0932
         L     @04,FAILO                                        02S0932
         OC    UCMRTCD(2,@11),UCMRTCD(@04)                      02S0932
*   END;                                                        02S0933
*                                                               02S0933
@EL00009 DS    0H                                               02S0933
@EF00009 DS    0H                                               02S0933
@ER00009 L     @14,12(,@13)                                     02S0933
         BR    @14                                              02S0933
*/*** END OF SETOSW SUBROUTINE ***************************************/
*                                                               02S0934
         EJECT
*                                                               02S0934
*/*** START OF STATMSG SUBROUTINE ************************************/
*/*                                                                  */
*/* STATMSG - ISSUES A MSG INDICATING THE STATUS OF THE NEW CONSOLE  */
*/*                                                                  */
*/* FUNCTION - GETS TWO WQES.  CONSTRUCTS MSG IEE143I INDICATING THE */
*/*    STATUS OF THE NEW CONSOLE.  QUEUES THE WQES TO THE SYSTEM     */
*/*    OUTPUT QUEUE.  CALLS IEECMENQ (IN IEAVMWSV) TO QUEUE THE      */
*/*    MESSAGES TO THE NEW CONSOLE.                                  */
*/*                                                                  */
*/* INPUT - FAILI = UCME ADDR OF INPUT HALF OF OLD CONSOLE           */
*/*         FAILO = UCME ADDR OF OUTPUTHALF OF OLD CONSOLE OR FAILI  */
*/*         NEWI =  UCME ADDR OF INPUT HALF OF NEW CONSOLE           */
*/*         NEWO =  UCME ADDR OF OUTPUTHALF OF NEW CONSOLE OR NEWI   */
*/*                                                                  */
*/* OUTPUT - UCMWTOQ - UPDATED IF NEEDED WHEN WQES ARE QUEUED        */
*/*          UCMWQEND - UPDATED WHEN WQES ARE QUEUED                 */
*/*                                                                  */
*/********************************************************************/
*                                                               02S0934
*STATMSG:                                                       02S0934
*   PROC OPTIONS(SAVE(REG14));                                  02S0934
STATMSG  ST    @14,@SA00010                                     02S0934
*   CALL GETWQE;                    /* GO OBTAIN A WQE               */
         BAL   @14,GETWQE                                       02S0935
*   IF MSGPTR^=ONE                  /* TEST FOR SUSSCESSFUL GETWQE   */
*     THEN                          /* IF SUCCESSFUL                 */
         L     @11,MSGPTR                                       02S0936
         CH    @11,@CH00055                                     02S0936
         BE    @RF00936                                         02S0936
*     DO;                           /* PROCEDE                       */
*       MSG143P1=MSGPTR;            /* SET BASE FOR 1ST HALF 143I    */
         LR    MSG143P1,@11                                     02S0938
*       MSGPTR=ZERO;                /* CLEAR PTR                     */
         SLR   @11,@11                                          02S0939
         ST    @11,MSGPTR                                       02S0939
*       CALL GETWQE;                /* GET 2ND WQE                   */
         BAL   @14,GETWQE                                       02S0940
*       IF MSGPTR^=ONE              /* TEST FOR SUCCESSFUL GETWQE    */
*         THEN                      /* IF SUCCESSFUL                 */
         L     @11,MSGPTR                                       02S0941
         CH    @11,@CH00055                                     02S0941
         BE    @RF00941                                         02S0941
*         DO;                       /* PROCEDE                       */
*           MSG143P2=MSGPTR;        /* BASE 2ND HALF 143I            */
         ST    @11,MSG143P2                                     02S0943
*           MSGPTR=ZERO;            /* CLEAR PTR                     */
         SLR   @11,@11                                          02S0944
         ST    @11,MSGPTR                                       02S0944
*           WQEPTR=MSG143P1;        /* BASE WQE FOR 1ST MSG          */
         LR    WQEPTR,MSG143P1                                  02S0945
*           WQETXT=MSG143T1;        /* MOVE TEXT TO MESSAGE          */
         MVI   WQETXT+67(WQEPTR),C' '                           02S0946
         MVC   WQETXT+68(60,WQEPTR),WQETXT+67(WQEPTR)           02S0946
         MVC   WQETXT(67,WQEPTR),@CC00136                       02S0946
*           IF FAILI=FAILO          /* TEST FOR COMPOSITE CONS       */
*             THEN                  /* IF CONSOLE NON-COMPOSITE      */
         L     @11,FAILI                                        02S0947
         C     @11,FAILO                                        02S0947
         BNE   @RF00947                                         02S0947
*             OLDNOCP=FAILI->UCMUCB->UCBNAME;/* OLD ID               */
         L     @11,UCMUCB(,@11)                                 02S0948
         MVC   OLDNOCP(3,WQEPTR),UCBNAME(@11)                   02S0948
*           ELSE                                                02S0949
*             DO;                   /* IF CONSOLE WAS A COMPOSIT     */
         B     @RC00947                                         02S0949
@RF00947 DS    0H                                               02S0950
*               OLDCP=COMPOSIT;     /* MOVE IN COMPOSITE HEADER      */
         MVC   OLDCP(11,WQEPTR),@CC00101                        02S0950
*               OLDINID=FAILI->UCMUCB->UCBNAME;/* INPUT ID           */
         L     @11,FAILI                                        02S0951
         L     @11,UCMUCB(,@11)                                 02S0951
         MVC   OLDINID(3,WQEPTR),UCBNAME(@11)                   02S0951
*               OLDOUTID=FAILO->UCMUCB->UCBNAME;/* OUTPT ID          */
         L     @11,FAILO                                        02S0952
         L     @11,UCMUCB(,@11)                                 02S0952
         MVC   OLDOUTID(3,WQEPTR),UCBNAME(@11)                  02S0952
*             END;                  /* END COMPOSIT PROCESSING       */
*           IF NEWI=NEWO            /* TEST FOR A COMPOSITE CONS     */
*             THEN                  /* IF NOT COMPOSITE 1 NAME       */
@RC00947 C     NEWI,NEWO                                        02S0954
         BNE   @RF00954                                         02S0954
*             NEWNOCP=NEWI->UCMUCB->UCBNAME;/* NEW ID                */
         L     @11,UCMUCB(,NEWI)                                02S0955
         MVC   NEWNOCP(3,WQEPTR),UCBNAME(@11)                   02S0955
*           ELSE                                                02S0956
*             DO;                   /* IF COMPOSITE, 2 UCBNAMES      */
         B     @RC00954                                         02S0956
@RF00954 DS    0H                                               02S0957
*               NEWCP=COMPOSIT;     /* MOVE IN COMPOSITE HDR         */
         MVC   NEWCP(11,WQEPTR),@CC00101                        02S0957
*               NEWINID=NEWI->UCMUCB->UCBNAME;/* INPUT ID            */
         L     @11,UCMUCB(,NEWI)                                02S0958
         MVC   NEWINID(3,WQEPTR),UCBNAME(@11)                   02S0958
*               NEWOUTID=NEWO->UCMUCB->UCBNAME;/* OUTPT ID           */
         L     @11,NEWO                                         02S0959
         L     @11,UCMUCB(,@11)                                 02S0959
         MVC   NEWOUTID(3,WQEPTR),UCBNAME(@11)                  02S0959
*             END;                  /* END COMPOSITE PROCESSING      */
*/* OLD AND NEW CONSOLE NAMES (DEVICE ADDRESSES) HAVE BEEN INSERTED  */
*                                                               02S0961
*           /*********************************************************/
*           /*                                                       */
*           /* ANALYZE COMMAND AUTHORITY.                            */
*           /*                                                       */
*           /*********************************************************/
*                                                               02S0961
*           IF NEWI->UCMDISPD=YES   /* IS NEW CONSOLE OUTPUT ONLY    */
*             THEN                                              02S0961
@RC00954 TM    UCMDISPD(NEWI),B'00010000'                       02S0961
         BNO   @RF00961                                         02S0961
*             CMDS=NONE;            /* IF OUTPUT ONLY, CMDS=NONE     */
         MVI   CMDS+4(WQEPTR),C' '                              02S0962
         MVC   CMDS+5(13,WQEPTR),CMDS+4(WQEPTR)                 02S0962
         MVC   CMDS(4,WQEPTR),@CC00087                          02S0962
*           ELSE                                                02S0963
*             DO;                   /* IF NEW CONSOLE FULL CAP       */
         B     @RC00961                                         02S0963
@RF00961 DS    0H                                               02S0964
*               IF NEWI->UCMAUTH1='1'B&/* IF AUTHORIZED FOR SYS,     */
*                   NEWI->UCMAUTH2='1'B&/* AND I/O,                  */
*                   NEWI->UCMAUTH3='1'B/* AND CONS,                  */
*                 THEN                                          02S0964
         TM    UCMAUTH1(NEWI),B'11100000'                       02S0964
         BNO   @RF00964                                         02S0964
*                 CMDS=ALL;         /* THEN PUT 'ALL' IN MSG.        */
         MVI   CMDS+3(WQEPTR),C' '                              02S0965
         MVC   CMDS+4(14,WQEPTR),CMDS+3(WQEPTR)                 02S0965
         MVC   CMDS(3,WQEPTR),@CC00090                          02S0965
*               ELSE                                            02S0966
*                 DO;               /* IF NOT ALL, ANALYZE MORE      */
         B     @RC00964                                         02S0966
@RF00964 DS    0H                                               02S0967
*                   X=ONE;          /* SET SUBSTRING OFFSET TO 1     */
         LA    X,1                                              02S0967
*                   CMDS=C3;        /* MOVE DEFAULT OF 'INFO' IN     */
         MVI   CMDS+4(WQEPTR),C' '                              02S0968
         MVC   CMDS+5(13,WQEPTR),CMDS+4(WQEPTR)                 02S0968
         MVC   CMDS(4,WQEPTR),@CC00092                          02S0968
*                   X=X+LENGTH(C3); /* INCREMENT SUBSTRING OFFSET    */
         LA    @15,4                                            02S0969
         ALR   X,@15                                            02S0969
*                   IF NEWI->UCMAUTH1='1'B/* IF AUTHORIZED FOR SYS   */
*                     THEN                                      02S0970
         TM    UCMAUTH1(NEWI),B'10000000'                       02S0970
         BNO   @RF00970                                         02S0970
*                     DO;           /* THE MOVE 'SYS' INTO MSG       */
*                       CMDS(X:X+LENGTH(C4)-1)=C4;/* MOVE 'SYS'      */
         LR    @01,WQEPTR                                       02S0972
         ALR   @01,X                                            02S0972
         MVC   CMDS-1(4,@01),@CC00094                           02S0972
*                       X=X+LENGTH(C3);/* INCREMENT SUBSTRING OFFSET */
         ALR   X,@15                                            02S0973
*                     END;                                      02S0974
*                   IF NEWI->UCMAUTH2='1'B/* TEST AUTH FOR I/O       */
*                     THEN                                      02S0975
@RF00970 TM    UCMAUTH2(NEWI),B'01000000'                       02S0975
         BNO   @RF00975                                         02S0975
*                     DO;           /* IF AUTHORIZED MOVE I/O IN     */
*                       CMDS(X:X+LENGTH(C5)-1)=C5;/* MOVE IN 'I/O'   */
         LR    @01,WQEPTR                                       02S0977
         ALR   @01,X                                            02S0977
         MVC   CMDS-1(4,@01),@CC00096                           02S0977
*                       X=X+LENGTH(C5);/* INCREMENT SUBSTRING OFFS   */
         AL    X,@CF00065                                       02S0978
*                     END;                                      02S0979
*                   IF NEWI->UCMAUTH3='1'B/* TEST AUTH FOR CONS      */
*                     THEN                                      02S0980
@RF00975 TM    UCMAUTH3(NEWI),B'00100000'                       02S0980
         BNO   @RF00980                                         02S0980
*                     DO;           /* IF AUTH, MOVE CONS TO MSG     */
*                       CMDS(X:X+LENGTH(C6)-1)=C6;/* MOVE IN 'CONS'  */
         LR    @01,WQEPTR                                       02S0982
         ALR   @01,X                                            02S0982
         MVC   CMDS-1(5,@01),@CC00098                           02S0982
*                       X=X+LENGTH(C6);/* INCREMENT SUBSTRING OFS    */
         AH    X,@CH00035                                       02S0983
*                     END;                                      02S0984
*                 END;                                          02S0985
@RF00980 DS    0H                                               02S0986
*             END;                                              02S0986
*                                                               02S0986
@RC00964 DS    0H                                               02S0987
*/* THE FIRST MSG OF IEE143I IS COMPLETE, NOW COMPLETE THE WQE       */
*                                                               02S0987
*           WQENBR=LENGTH(MSG143T1);/* SET TEXT LENGTH               */
@RC00961 MVC   WQENBR(4,WQEPTR),@CF00135                        02S0987
*           WQEUCMID=NEWO->UCMID;   /* PLACE CONSOLE ID IN WQE       */
         L     @11,NEWO                                         02S0988
         MVC   WQEUCMID(1,WQEPTR),UCMID(@11)                    02S0988
*/********************************************************************/
*/*                                                                  */
*/*  CALL THE WQE BUILD ROUTINE TO INITIALIZE THE REMAINING FIELDS   */
*/*  IN THE WQE.                                                     */
*/*                                                                  */
*/********************************************************************/
*                                                               02S0989
*           CALL BUILDWQE;          /* GO TO SUBROUTINE FOR WQE'S    */
         BAL   @14,BUILDWQE                                     02S0989
*/* NOW SET UP TEXT OF SECOND HALF OF IEE143I                        */
*                                                               02S0990
*           WQEPTR=MSG143P2;        /* RESET MESSAGE PTR             */
         L     WQEPTR,MSG143P2                                  02S0990
*           WQENBR=LENGTH(MSG143T2);/* SET WQE LENGTH FOR 2ND HAF    */
         MVC   WQENBR(4,WQEPTR),@CF00142                        02S0991
*           WQETXT=MSG143T2;        /* MOVE IN MSG TEXT              */
         MVI   WQETXT+71(WQEPTR),C' '                           02S0992
         MVC   WQETXT+72(56,WQEPTR),WQETXT+71(WQEPTR)           02S0992
         MVC   WQETXT(71,WQEPTR),@CC00143                       02S0992
*           WQEUCMID=NEWO->UCMID;   /* PLACE CONSOLE ID IN WQE       */
         L     @11,NEWO                                         02S0993
         MVC   WQEUCMID(1,WQEPTR),UCMID(@11)                    02S0993
*           IF NEWO->UCMRTCD=ALLR   /* IF ALL ROUTE CODES,           */
*             THEN                                              02S0994
         CLC   UCMRTCD(2,@11),@CB00072                          02S0994
         BNE   @RF00994                                         02S0994
*             ROUTCDES=ALL;         /* JUST PUT 'ALL' IN MSG         */
         MVI   ROUTCDES+3(WQEPTR),C' '                          02S0995
         MVC   ROUTCDES+4(42,WQEPTR),ROUTCDES+3(WQEPTR)         02S0995
         MVC   ROUTCDES(3,WQEPTR),@CC00090                      02S0995
*           ELSE                                                02S0996
*             IF NEWO->UCMRTCD=ZERO /* IF NOT ALL, IS IT NONE        */
*               THEN                                            02S0996
         B     @RC00994                                         02S0996
@RF00994 L     @11,NEWO                                         02S0996
         ICM   @15,3,UCMRTCD(@11)                               02S0996
         BNZ   @RF00996                                         02S0996
*               ROUTCDES=NONE;      /* IF NONE, PUT 'NONE' IN MSG    */
         MVI   ROUTCDES+4(WQEPTR),C' '                          02S0997
         MVC   ROUTCDES+5(41,WQEPTR),ROUTCDES+4(WQEPTR)         02S0997
         MVC   ROUTCDES(4,WQEPTR),@CC00087                      02S0997
*             ELSE                                              02S0998
*               DO;                 /* MIXTURE OF ROUTCODES          */
*                                                               02S0998
         B     @RC00996                                         02S0998
@RF00996 DS    0H                                               02S0999
*                 /***************************************************/
*                 /*                                                 */
*                 /* THE ROUTE CODE FIELD OF THE NEW CONSOLE MUST BE */
*                 /* ANALYZED AND THE INFORMATION PLACED IN THE      */
*                 /* MESSAGE.                                        */
*                 /*                                                 */
*                 /***************************************************/
*                                                               02S0999
*                 RFY                                           02S0999
*                  (REG01,                                      02S0999
*                   REG01F) RSTD;                               02S0999
*                 REG01F=NEWO->UCMRTCD;/* GET A COPY OF THE RTE CDE  */
         L     @15,NEWO                                         02S1000
         SLR   REG01F,REG01F                                    02S1000
         ICM   REG01F,3,UCMRTCD(@15)                            02S1000
*                 SLL(REG01F,16);   /* MOVE TO LEFT OF REGISTER      */
         SLL   REG01F,16                                        02S1001
*                 MSGTXTPT=ADDR(ROUTCDES);/* POINT TO NEXT SPACE IN
*                                      MSG                           */
         LA    MSGTXTPT,ROUTCDES(,WQEPTR)                       02S1002
*                 DO I=1 TO 15 BY 1;/* LOOP THRU ALL 15 ROUTE CDES   */
         LA    @00,1                                            02S1003
         ST    @00,I                                            02S1003
@DL01003 DS    0H                                               02S1004
*                   IF REG01F<0     /* IF NEG, ROUTCDE PRESENT       */
*                     THEN          /* PROCESS                       */
         LTR   REG01F,REG01F                                    02S1004
         BNM   @RF01004                                         02S1004
*                     DO;           /* FOR ROUT FOR ROUTCDE          */
*                       RV(1:3)=RCTBL(I);/* MOVE ROUTE CODE TO MSG   */
         LA    @15,3                                            02S1006
         ST    @15,@TF00001                                     02S1006
         LR    @15,@00                                          02S1006
         M     @14,@TF00001                                     02S1006
         LA    @14,RCTBL-3(@15)                                 02S1006
         MVC   RV(3,MSGTXTPT),0(@14)                            02S1006
*                       MSGTXTPT=MSGTXTPT+3;/* BUMP PTR TO NEXT SPACE*/
         AL    MSGTXTPT,@TF00001                                02S1007
*                     END;                                      02S1008
*                   SLL(REG01F,1);  /* SHIFT TO NEXT ROUTE CODE      */
@RF01004 SLL   REG01F,1                                         02S1009
*                 END;                                          02S1010
         LA    @00,1                                            02S1010
         AL    @00,I                                            02S1010
         ST    @00,I                                            02S1010
         CH    @00,@CH00078                                     02S1010
         BNH   @DL01003                                         02S1010
*                 RFY                                           02S1011
*                  (REG01,                                      02S1011
*                   REG01F) UNRSTD;                             02S1011
*               END;                /* END PROCESSING MIXTURE        */
*                                                               02S1012
*           /*********************************************************/
*           /*                                                       */
*           /* NEXT SET CONSOLE TYPE IN MESSAGE                      */
*           /*                                                       */
*           /*********************************************************/
*                                                               02S1013
*           IF NEWI->UCMDISPA='1'B  /* TEST WHETHER NEW IS MASTER    */
*             THEN                                              02S1013
@RC00996 DS    0H                                               02S1013
@RC00994 TM    UCMDISPA(NEWI),B'10000000'                       02S1013
         BNO   @RF01013                                         02S1013
*             TYPE=M;               /* IF MASTER, SET TYPE TO 'M'    */
         MVI   TYPE(WQEPTR),C'M'                                02S1014
*           ELSE                                                02S1015
*             TYPE=S;               /* IF NOT MASTER, 'S' SCNDRY     */
*                                                               02S1015
         B     @RC01013                                         02S1015
@RF01013 MVI   TYPE(WQEPTR),C'S'                                02S1015
*           /*********************************************************/
*           /*                                                       */
*           /* LAST, PLACE CONSOLES HARDCOPY STATUS IN MESSAGE.      */
*           /*                                                       */
*           /*********************************************************/
*                                                               02S1016
*           IF NEWO->UCMDISPB='1'B  /* TEST HARDCOPY STATUS  @ZA20164*/
*             THEN                                              02S1016
@RC01013 L     @11,NEWO                                         02S1016
         TM    UCMDISPB(@11),B'01000000'                        02S1016
         BNO   @RF01016                                         02S1016
*             HCCHAR=Y;             /* 'Y' IF NEW IS HARDCOPY        */
         MVI   HCCHAR(WQEPTR),C'Y'                              02S1017
*           ELSE                                                02S1018
*             HCCHAR=N;             /* 'N' IF NEW NOT HARDCOPY       */
         B     @RC01016                                         02S1018
@RF01016 MVI   HCCHAR(WQEPTR),C'N'                              02S1018
*/********************************************************************/
*/*                                                                  */
*/*  THE SECOND HALF OF MESSAGE IEE143I IS COMPLETE, NOW             */
*/*  CALL THE WQE BUILD ROUTINE TO INITIALIZE THE REMAINING FIELDS   */
*/*  IN THE WQE.                                                     */
*/*                                                                  */
*/********************************************************************/
*                                                               02S1019
*           CALL BUILDWQE;          /* GO TO SUBROUTINE FOR WQE'S    */
*                                                               02S1019
@RC01016 BAL   @14,BUILDWQE                                     02S1019
*           /*********************************************************/
*           /*                                                       */
*           /* BOTH PARTS OF MESSAGE IEE143I ARE COMPLETE. INDICATE  */
*           /* THIS TO THE SUBSYSTEM AND THEN SET INDICATORS SO COMM */
*           /* TASK WILL QUEUE THE MESSAGE TO THE APPROPRIATE        */
*           /* CONSOLE. OUTPUT PENDING(UCMSYSJ) IS SET ON AND POSTREQ*/
*           /* IS SET ON SO THE WRAPUP SUBROUTINE WILL XMPOST        */
*           /* UCMOECB.                                      @ZA18877*/
*           /*                                                       */
*           /*********************************************************/
*                                                               02S1020
*           WQEPTR=MSG143P1;        /* SET UP TO QUEUE FIRST MSG     */
         LR    WQEPTR,MSG143P1                                  02S1020
*           CALL SUBEXIT;           /* INFORM SUBSYSTEM OF 1ST PART
*                                      OF MSG IEE143I        @ZA18877*/
         BAL   @14,SUBEXIT                                      02S1021
*           WQEPTR=MSG143P2;        /* SET UP TO QUEUE 2ND MSG       */
         L     WQEPTR,MSG143P2                                  02S1022
*           CALL SUBEXIT;           /* INFORM SUBSYSTEM OF 2ND PART
*                                      OF MSG IEE143I        @ZA18877*/
         BAL   @14,SUBEXIT                                      02S1023
*           CALL SUBSWTCH;          /* NOTIFY SUBSYSTEM,CONS SWITCH
*                                                            @ZA03626*/
         BAL   @14,SUBSWTCH                                     02S1024
*           POSTREQ='1'B;           /* XMPOST REQUIRED TO INSURE
*                                      COMTASK GETS CONTROL  @ZA00530*/
         OI    POSTREQ,B'00000010'                              02S1025
*           UCMSYSJ='1'B;           /* OUTPUT PENDING        @ZA00530*/
         OI    UCMSYSJ(UCMMCSPT),B'01000000'                    02S1026
*         END;                      /* END DO IF WQES GOTTEN         */
*       ELSE                        /* ELSE FOR 2ND GETWQE TEST      */
*         DO;                       /* IF 2ND GETWQE FAILS, FREE THE
*                                      FIRST ONE                     */
         B     @RC00941                                         02S1028
@RF00941 DS    0H                                               02S1029
*/********************************************************************/
*/*                                                                  */
*/*  IF ONLY ONE WQE WAS OBTAINED, DEQUEUE IT, FREE IT, AND DONT     */
*/*  ISSUE THE MESSAGE.                                              */
*/*                                                                  */
*/********************************************************************/
*                                                               02S1029
*           RFY                                                 02S1029
*            (REG00,                                            02S1029
*             REG01,                                            02S1029
*             REG15) RSTD;                                      02S1029
*                                                               02S1029
*           /*********************************************************/
*           /*                                                       */
*           /* DEQUEUE THE WQE.                                      */
*           /*                                                       */
*           /*********************************************************/
*                                                               02S1030
*           REG00=ADDR(UCMWTOQ);    /* START OF WQE QUEUE.           */
         LA    REG00,UCMWTOQ(,UCMBASPT)                         02S1030
*           REG01=UCMWTOQ;          /* ADDR OF FIRST WQE ON QUEUE.   */
         L     REG01,UCMWTOQ(,UCMBASPT)                         02S1031
*           DO WHILE REG01^=MSG143P1;/* DO UNTIL WE READ END OF Q    */
         B     @DE01032                                         02S1032
@DL01032 DS    0H                                               02S1033
*             REG00=REG01;          /* SAVE PTR TO LAST ENTRY        */
         LR    REG00,REG01                                      02S1033
*             REG01=REG01->WQELKPA; /* PICK UP PTR TO NEXT WQE       */
         SLR   @14,@14                                          02S1034
         ICM   @14,7,WQELKPA(REG01)                             02S1034
         LR    REG01,@14                                        02S1034
*           END;                    /* LOOP BBACK AND DO AGAIN       */
@DE01032 CR    REG01,MSG143P1                                   02S1035
         BNE   @DL01032                                         02S1035
*           IF REG01=UCMWTOQ        /* IF THIS WQE IS THE ONLY ONE   */
*             THEN                                              02S1036
         C     REG01,UCMWTOQ(,UCMBASPT)                         02S1036
         BNE   @RF01036                                         02S1036
*             DO;                   /* THEN PROCESS SPECIAL          */
*               UCMWTOQ=ZERO;       /* ZERO PTR TO FIRST WQE (Q HEAD)*/
         SLR   @14,@14                                          02S1038
         ST    @14,UCMWTOQ(,UCMBASPT)                           02S1038
*               UCMWQEND=ZERO;      /* ZERO PTR TO LAST WQE          */
         ST    @14,UCMWQEND(,UCMBASPT)                          02S1039
*             END;                  /* END OF SPECIAL PROCESSING     */
*           ELSE                                                02S1041
*             DO;                   /* IF WQE WAS NOT THE ONLY ONE   */
         B     @RC01036                                         02S1041
@RF01036 DS    0H                                               02S1042
*               REG00->WQELKPA=ZERO;/* ZERO LINK PTR IN 2ND LAST WQE */
         LR    @14,REG00                                        02S1042
         SLR   @11,@11                                          02S1042
         STCM  @11,7,WQELKPA(@14)                               02S1042
*               UCMWQEND=REG00;     /* CHANGE UCM PTR TO LAST WQE    */
         ST    REG00,UCMWQEND(,UCMBASPT)                        02S1043
*             END;                  /* END OF NORMAL PROCESSING      */
*           REG01=MSG143P1;         /* GET ADDR OF WQE               */
@RC01036 LR    REG01,MSG143P1                                   02S1045
*           REG00=UCMWQECP;         /* GET CELL POOL ID              */
*                                                               02S1046
         L     REG00,UCMWQECP(,UCMBASPT)                        02S1046
*           /*********************************************************/
*           /*                                                       */
*           /* FREE THE WQE                                          */
*           /*                                                       */
*           /*********************************************************/
*                                                               02S1047
*           GEN(FREECELL CPID=(0),CELL=(1),BRANCH=YES)          02S1047
*           REFS(REG00,REG01,CVTFRECL) SETS(REG00,REG01,REG15); 02S1047
*                                                               02S1047
         FREECELL CPID=(0),CELL=(1),BRANCH=YES
*           /*********************************************************/
*           /*                                                       */
*           /* IF THE WQE WAS THE LAST IN A CELL POOL EXTENSION, FREE*/
*           /* THE EXTENSION. THIS IS INDICATED BY A RETURN CODE OF  */
*           /* 20 IN REGISTER 15. REGISTERS 0 AND 1 WILL BE SET UP   */
*           /* FOR A FREEMAIN IF ONE IS NEEDED.                      */
*           /*                                                       */
*           /*********************************************************/
*                                                               02S1048
*           IF REG15=20             /* TEST RETURN CODE FOR 20       */
*             THEN                  /* IF RC=20 FREE CELLPOOL EXTEN  */
         CH    REG15,@CH00069                                   02S1048
         BNE   @RF01048                                         02S1048
*             GEN(FREEMAIN  R,LV=(0),A=(1),BRANCH=YES)          02S1049
*             REFS(REG00,REG01,CVTRMBR,CVTMAP,CVTPTR) SETS(REG01,REG14,
*                 REG15);                                       02S1049
         FREEMAIN  R,LV=(0),A=(1),BRANCH=YES
*           RFY                                                 02S1050
*            (REG00,                                            02S1050
*             REG01,                                            02S1050
*             REG15) UNRSTD;                                    02S1050
@RF01048 DS    0H                                               02S1051
*           UCMWQNR=UCMWQNR-1;      /* DECREMENT WQE COUNT           */
         LH    @11,UCMWQNR(,UCMBASPT)                           02S1051
         BCTR  @11,0                                            02S1051
         STH   @11,UCMWQNR(,UCMBASPT)                           02S1051
*         END;                      /* END DO FOR 2ND GETWQE FAIL    */
*     END;                          /* END PROCESSING FOR WQES       */
*                                                               02S1053
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE GETWQE FOR THE FIRST WQE FAILED, GO ON PROCESSING      */
*   /* WITHOUT ISSUING MESSAGES.                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S1054
*   END STATMSG;                                                02S1054
*                                                               02S1054
@EL00010 DS    0H                                               02S1054
@EF00010 DS    0H                                               02S1054
@ER00010 L     @14,@SA00010                                     02S1054
         BR    @14                                              02S1054
*/*** END OF STATMSG SEGMENT *****************************************/
*                                                               02S1055
         EJECT
*                                                               02S1055
*/*** START OF SOUNDBEL SUBROUTINE ***********************************/
*/*                                                                  */
*/* SOUNDBEL - SOUND A CONSOLE'S ALARM 3 TIMES               @G51APSS*/
*/*                                                                  */
*/* INPUT    - UCMSYSL = ON IF OPEN-TO-RING IS IN PROGRESS   @G51APSS*/
*/*            BELLCONS = UCME ADDRESS OF DEVICE WITH BELL   @G51APSS*/
*/*                       TO RING                            @G51APSS*/
*/*                                                                  */
*/* OUTPUT   - THE CONSOLE'S ALARM SHOULD RING THREE TIMES   @G51APSS*/
*/*                                                                  */
*/********************************************************************/
*                                                               02S1055
*SOUNDBEL:                                                      02S1055
*   PROC OPTIONS(SAVE);             /*                       @G51APSS*/
SOUNDBEL STM   @14,@12,@SA00011                                 02S1055
*   DCL                                                         02S1056
*     DEVOPN1 LABEL GENERATED STATIC LOCAL;/*                @ZA18882*/
*   DCL                                                         02S1057
*     DEVOPN2 LABEL GENERATED STATIC LOCAL;/*                @ZA18882*/
*   RFY                                                         02S1058
*     UCMLIST BASED(BELLCONS);      /* BASE UCME ON DEVICE WITH BELL
*                                      TO RING               @G51APSS*/
*                                                               02S1058
*   /*****************************************************************/
*   /*                                                               */
*   /* IF OPEN-TO-RING IS ON THEN DON'T SOUND THE ALARM. THE DSP HAS */
*   /* ALREADY RECEIVED CONTROL TO OPEN THE DEVICE TO SOUND THE ALARM*/
*   /* AND HAS HAD A PROBLEM SO DON'T TRY TO OPEN THE DEVICE AGAIN.  */
*   /*                                                       @G51APSS*/
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S1059
*   IF UCMSYSL='1'B THEN            /* OPEN-TO-RING IN PROGRESS?
*                                                            @G51APSS*/
         TM    UCMSYSL(UCMMCSPT),B'00010000'                    02S1059
         BNO   @RF01059                                         02S1059
*     RINGBELL=NO;                  /* YES, DON'T RING BELL  @G51APSS*/
         NI    RINGBELL,B'10111111'                             02S1060
*   ELSE                            /* TRY TO OPEN DEVICE    @G51APSS*/
*     DO;                           /*                       @G51APSS*/
         B     @RC01059                                         02S1061
@RF01059 DS    0H                                               02S1062
*       IF UCMDCB^=ZERO THEN        /* DOES DEVICE HAVE A DCB?  02S1062
*                                                            @G51APSS*/
         L     @04,BELLCONS                                     02S1062
         L     @04,UCMDCB(,@04)                                 02S1062
         LTR   @04,@04                                          02S1062
         BZ    @RF01062                                         02S1062
*         DO;                       /* YES, SEE IF DEVICE IS OPEN
*                                                            @ZA18882*/
*           RFY                                                 02S1064
*             REG10 RSTD;           /*                       @ZA18882*/
*           REG10=UCMDCB;           /* ADDR OF DCB           @ZA18882*/
         LR    REG10,@04                                        02S1065
*           GEN REFS(IHADCB,REG10,DCBOFLGS)/* RINGBELL IS    @ZA18882*/
*               SETS(RINGBELL)      /* SET OFF IF DEVICE IS NOT 02S1066
*                                                            @ZA18882*/
*               DEFS(DEVOPN1);                                  02S1066
*                             /* OPEN                        @ZA18882*/
         USING IHADCB,REG10       ADDRESSABILITY TO DCB        @ZA18882
         TM    DCBOFLGS,DCBOFOPN  DEVICE OPEN                  @ZA18882
         BO    DEVOPN1            YES THEN BRANCH              @ZA18882
         NI    RINGBELL,B'10111111' DO NOT RING BELL. THIS INSTR MUST  X
                                  BE CHANGED IF RINGBELL IS MOVED      X
                                  (RE-DECLARED).               @ZA18882
DEVOPN1  EQU   *                                               @ZA18882
         DROP REG10                                            @ZA18882
*           RFY                                                 02S1067
*             REG10 UNRSTD;         /*                       @ZA18882*/
*         END;                      /*                       @ZA18882*/
*       ELSE                        /* DEVICE IS NOT OPEN SO TRY TO
*                                      OPEN IT               @G51APSS*/
*         DO;                                                   02S1069
         B     @RC01062                                         02S1069
@RF01062 DS    0H                                               02S1070
*           UCMSYSL='1'B;           /* INDICATE OPEN TO RING BELL IN
*                                      PROGRESS              @G51APSS*/
         OI    UCMSYSL(UCMMCSPT),B'00010000'                    02S1070
*           IF UCBSYSR='0'B THEN    /* IS THE DEVICE ALLOCATED AS A
*                                      CONSOLE?              @G51APSS*/
         L     @04,BELLCONS                                     02S1071
         L     @04,UCBPTR(,@04)                                 02S1071
         TM    UCBSYSR(@04),B'00000010'                         02S1071
         BNZ   @RF01071                                         02S1071
*             DO;                   /* NO                    @G51APSS*/
*               CALL ENQQ4;         /* TRY TO OBTAIN Q4      @G51APSS*/
         BAL   @14,ENQQ4                                        02S1073
*               IF HAVEQ4=YES THEN  /* WAS Q4 OBTAINED?      @G51APSS*/
         TM    HAVEQ4,B'00010000'                               02S1074
         BNO   @RF01074                                         02S1074
*                 DO;               /* YES                   @G51APSS*/
*                   IF UCBALOC='0'B THEN/* DEVICE UNALLOCATED?  02S1076
*                                                            @G51APSS*/
         L     @04,BELLCONS                                     02S1076
         L     @04,UCBPTR(,@04)                                 02S1076
         TM    UCBALOC(@04),B'00001000'                         02S1076
         BNZ   @RF01076                                         02S1076
*                     DO;                                       02S1077
*                       UCBSYSRX='1'B;/* MAKE DEVICE A CONSOLE       */
         L     @15,UCBSYSRX-3(,@04)                             02S1078
@GL00067 LR    @14,@15                                          02S1078
         O     @14,@CF03988                                     02S1078
         CS    @15,@14,UCBSYSRX-3(@04)                          02S1078
         BNE   @GL00067                                         02S1078
*                       IF BELLCONS^=PWRCONS THEN/* SOUND ALARMS ON
*                                      DIFFERENT DEVICES?    @G51APSS*/
         L     @04,BELLCONS                                     02S1079
         C     @04,PWRCONS                                      02S1079
         BE    @RF01079                                         02S1079
*                         DO;       /* YES                   @G51APSS*/
*                           UCBCHGSX='1'B;/* DEVICE TO GO OFFLINE
*                                      AFTER RING                    */
*                           UCBDADIX='1'B;/* DEVICE GOING OUT OF CONS
*                                      STATUS                        */
         L     @04,UCBPTR(,@04)                                 02S1082
         L     @15,UCBCHGSX-3(,@04)                             02S1082
@GL00068 LR    @14,@15                                          02S1082
         O     @14,@CF03963                                     02S1082
         CS    @15,@14,UCBCHGSX-3(@04)                          02S1082
         BNE   @GL00068                                         02S1082
*                         END;      /*                       @G51APSS*/
*                     END;                                      02S1084
*                   ELSE            /* IF ALLOCATED, DONT TAKE DEVICE*/
*                     RINGBELL=NO;  /* TURN OFF RING-BELL-NEEDED FLAG*/
         B     @RC01076                                         02S1085
@RF01076 NI    RINGBELL,B'10111111'                             02S1085
*                   CALL DEQQ4;     /* RELEASE Q4            @G51APSS*/
@RC01076 BAL   @14,DEQQ4                                        02S1086
*                 END;                                          02S1087
*               ELSE                /* ENQ RETURN CODE NON-ZERO      */
*                 RINGBELL=NO;      /* TURN OFF RING-BELL-NEEDED FLAG*/
         B     @RC01074                                         02S1088
@RF01074 NI    RINGBELL,B'10111111'                             02S1088
*             END;                  /* END OF DO FOR UCMSYSR=OFF     */
@RC01074 DS    0H                                               02S1090
*           IF RINGBELL=YES THEN    /* SHOULD BELL BE RUNG?          */
@RF01071 TM    RINGBELL,B'01000000'                             02S1090
         BNO   @RF01090                                         02S1090
*             DO;                   /* YES                   @G51APSS*/
*               UCMTA='1'B;         /* INDICATE OPEN PENDING @G51APSS*/
*               UCMCF='0'B;         /* MARK NOT CLOSE PENDING   02S1093
*                                                            @ZA18886*/
         L     @04,BELLCONS                                     02S1093
         OI    UCMTA(@04),B'00001000'                           02S1093
         NI    UCMCF(@04),B'11101111'                           02S1093
*               CALL CALLDSP(BELLCONS,CSAOPEN);/* GO OPEN DEVICE TO
*                                      SOUND ALARM           @G51APSS*/
         LA    @04,BELLCONS                                     02S1094
         ST    @04,@AL00001                                     02S1094
         LA    @04,@CH00060+1                                   02S1094
         ST    @04,@AL00001+4                                   02S1094
         LA    @01,@AL00001                                     02S1094
         BAL   @14,CALLDSP                                      02S1094
*               IF UCMDCB=ZERO THEN /* DCB OBTAINED?         @ZA18882*/
         L     @04,BELLCONS                                     02S1095
         ICM   @15,15,UCMDCB(@04)                               02S1095
         BNZ   @RF01095                                         02S1095
*                 RINGBELL=NO;      /* NO, DEVICE NOT OPEN. DON'T
*                                      RING BELL             @ZA18882*/
         NI    RINGBELL,B'10111111'                             02S1096
*               ELSE                /*                       @ZA18882*/
*                 DO;               /* YES, SEE IF DEVICE IS OPEN
*                                                            @ZA18882*/
         B     @RC01095                                         02S1097
@RF01095 DS    0H                                               02S1098
*                   RFY                                         02S1098
*                     REG10 RSTD;   /*                       @ZA18882*/
*                   REG10=UCMDCB;   /* ADDR OF DCB           @ZA18882*/
         L     @04,BELLCONS                                     02S1099
         L     REG10,UCMDCB(,@04)                               02S1099
*                   GEN REFS(IHADCB,REG10,DCBOFLGS)/* SET RINGBELL
*                                                            @ZA18882*/
*                       SETS(RINGBELL)/* OFF IF DEVICE       @ZA18882*/
*                       DEFS(DEVOPN2);                          02S1100
*                                          /* IS NOT OPEN    @ZA18882*/
         USING IHADCB,REG10       ADDRESSABILITY TO DCB        @ZA18882
         TM    DCBOFLGS,DCBOFOPN  DEVICE OPEN                  @ZA18882
         BO    DEVOPN2            YES THEN BRANCH              @ZA18882
         NI    RINGBELL,B'10111111' DO NOT RING BELL. THIS INSTR MUST  X
                                  BE CHANGED IF RINGBELL IS MOVED      X
                                  (RE-DECLARED).               @ZA18882
DEVOPN2  EQU   *                                               @ZA18882
         DROP REG10                                            @ZA18882
*                   RFY                                         02S1101
*                     REG10 UNRSTD; /*                       @ZA18882*/
*                 END;              /*                       @ZA18882*/
*               IF BELLCONS^=PWRCONS×/* SOUND ALARMS OF DIFFERENT
*                                      DEVICES? OR           @G51APSS*/
*                   RINGBELL=NO THEN/* DEVICE NOT OPEN?      @G51APSS*/
@RC01095 CLC   BELLCONS(4),PWRCONS                              02S1103
         BNE   @RT01103                                         02S1103
         TM    RINGBELL,B'01000000'                             02S1103
         BNZ   @RF01103                                         02S1103
@RT01103 DS    0H                                               02S1104
*                 DO;               /* YES                   @G51APSS*/
*                   UCMTA='0'B;     /* TURN OFF OPEN PENDING @ZA18886*/
*                   UCMCF='1'B;     /* TURN ON CLOSE PENDING @G51APSS*/
         L     @04,BELLCONS                                     02S1106
         OI    UCMCF(@04),B'00010000'                           02S1106
         NI    UCMTA(@04),B'11110111'                           02S1106
*                 END;              /*                       @G51APSS*/
*               IF RINGBELL=NO THEN /* DEVICE OPENED?        @G51APSS*/
@RF01103 TM    RINGBELL,B'01000000'                             02S1108
         BNZ   @RF01108                                         02S1108
*                 CALL CALLDSP(BELLCONS,CSACLOSE);/* NO, GO TO DSP TO
*                                      CLOSE DEVICE          @G51APSS*/
         LA    @04,BELLCONS                                     02S1109
         ST    @04,@AL00001                                     02S1109
         LA    @04,@CH00065+1                                   02S1109
         ST    @04,@AL00001+4                                   02S1109
         LA    @01,@AL00001                                     02S1109
         BAL   @14,CALLDSP                                      02S1109
*               ELSE                /*                       @G51APSS*/
*                 CLOSEBEL=YES;     /* CLOSE DEVICE LATER    @G51APSS*/
         B     @RC01108                                         02S1110
@RF01108 OI    CLOSEBEL,B'00100000'                             02S1110
*             END;                                              02S1111
@RC01108 DS    0H                                               02S1112
*           UCMSYSL='0'B;           /* TURN OFF OPEN TO RING BELL
*                                      FLAG                          */
@RF01090 NI    UCMSYSL(UCMMCSPT),B'11101111'                    02S1112
*         END;                                                  02S1113
*     END;                          /* OF TRY TO OPEN DEVICE @G51APSS*/
@RC01062 DS    0H                                               02S1115
*   IF RINGBELL=YES THEN            /* STILL RING BELL?      @G51APSS*/
@RC01059 TM    RINGBELL,B'01000000'                             02S1115
         BNO   @RF01115                                         02S1115
*     DO;                           /* YES                   @G51APSS*/
*       CALL FRLOCKS;               /* FREE THE CMS AND LOCAL LOCKS  */
         BAL   @14,FRLOCKS                                      02S1117
*       CALL BELLEXCP(BELL);        /* RING CONSOLE'S BELL   @G51APSS*/
         LA    @01,@AL01118                                     02S1118
         BAL   @14,BELLEXCP                                     02S1118
*       CALL GETLOCKS;              /* OBTAIN THE LOCKS      @G51APSS*/
         BAL   @14,GETLOCKS                                     02S1119
*       IF CLOSEBEL=YES&            /* SHOULD DEVICE BE CLOSED? AND
*                                                            @G51APSS*/
*           BELLCONS^=PWRCONS THEN  /* SOUND ALARMS ON DIFFERENT
*                                      DEVICES?              @G51APSS*/
         TM    CLOSEBEL,B'00100000'                             02S1120
         BNO   @RF01120                                         02S1120
         CLC   BELLCONS(4),PWRCONS                              02S1120
         BE    @RF01120                                         02S1120
*         DO;                       /* YES, CLOSE DEVICE     @G51APSS*/
*           UCMSYSL='1'B;           /* MARK GOING TO DSP FOR ALARM
*                                                            @G51APSS*/
         OI    UCMSYSL(UCMMCSPT),B'00010000'                    02S1122
*           CALL CALLDSP(BELLCONS,CSACLOSE);/* GO TO DSP TO CLOSE
*                                      DEVICE                @G51APSS*/
         LA    @04,BELLCONS                                     02S1123
         ST    @04,@AL00001                                     02S1123
         LA    @04,@CH00065+1                                   02S1123
         ST    @04,@AL00001+4                                   02S1123
         LA    @01,@AL00001                                     02S1123
         BAL   @14,CALLDSP                                      02S1123
*           UCMSYSL='0'B;           /* BACK FROM DSP         @G51APSS*/
         NI    UCMSYSL(UCMMCSPT),B'11101111'                    02S1124
*           CLOSEBEL='0'B;          /* DEVICE CLOSED         @G51APSS*/
         NI    CLOSEBEL,B'11011111'                             02S1125
*         END;                      /*                       @G51APSS*/
*     END;                                                      02S1127
*   RFY                                                         02S1128
*     UCMLIST BASED(UCMDVEPT);      /* RESET BASE FOR UCME   @G51APSS*/
*   END SOUNDBEL;                   /*                       @G51APSS*/
@EL00011 DS    0H                                               02S1129
@EF00011 DS    0H                                               02S1129
@ER00011 LM    @14,@12,@SA00011                                 02S1129
         BR    @14                                              02S1129
*/*** END OF SOUNDBEL SUBROUTINE *************************************/
*                                                               02S1130
         EJECT
*                                                               02S1130
*/*** START OF SOUNDPWR SUBROUTINE************************************/
*/*                                                                  */
*/* SOUNDPWR - SOUND THE POWER AND COOLING ALARM 3 TIMES     @G51APSS*/
*/*                                                                  */
*/* INPUT    - UCMSYSP = ON IF OPEN-TO-SOUND-POWER-ALARM WAS @G51APSS*/
*/*                      ALREADY IN PROCESS                  @G51APSS*/
*/*            PWRCONS = UCME ADDRESS OF DEVICE TO SOUND     @G51APSS*/
*/*                      POWER ALARM ON                      @G51APSS*/
*/* OUTPUT   - THE POWER ALARM WILL BE SOUNDED               @G51APSS*/
*/*            3 TIMES                                       @G51APSS*/
*/*                                                                  */
*/********************************************************************/
*                                                               02S1130
*SOUNDPWR:                                                      02S1130
*   PROC OPTIONS(SAVE);             /*                       @G51APSS*/
SOUNDPWR STM   @14,@12,@SA00012                                 02S1130
*   DCL                                                         02S1131
*     DEVOPN3 LABEL GENERATED STATIC LOCAL;/*                @ZA18882*/
*   DCL                                                         02S1132
*     DEVOPN4 LABEL GENERATED STATIC LOCAL;/*                @ZA18882*/
*   RFY                                                         02S1133
*     UCMLIST BASED(PWRCONS);       /* BASE UCME ON DEVICE TO SOUND
*                                      POWER ALARM           @G51APSS*/
*                                                               02S1133
*   /*****************************************************************/
*   /*                                                               */
*   /* IF OPEN-TO-SOUND-POWER-ALARM IS ON THEN DON'T SOUND THE ALARM.*/
*   /* THE DSP HAS ALREADY RECEIVED CONTROL TO OPEN THE DEVICE TO    */
*   /* SOUND THE POWER ALARM AND HAS HAD A PROBLEM SO DON'T TRY TO   */
*   /* OPEN THE DEVICE AGAIN.                                @G51APSS*/
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S1134
*   IF UCMSYSP='1'B THEN            /* OPEN-TO-SOUND-POWER-ALARM IN
*                                      PROGRESS?             @G51APSS*/
         TM    UCMSYSP(UCMMCSPT),B'00000001'                    02S1134
         BNO   @RF01134                                         02S1134
*     RINGPOWR=NO;                  /* YES, DON'T SOUND POWER ALARM
*                                                            @G51APSS*/
         NI    RINGPOWR,B'11011111'                             02S1135
*   ELSE                            /* OK TO TRY AND SOUND POWER
*                                      ALARM                 @G51APSS*/
*     DO;                           /*                       @G51APSS*/
         B     @RC01134                                         02S1136
@RF01134 DS    0H                                               02S1137
*       IF UCMDCB^=ZERO THEN        /* DOES DEVICE HAVE A DCB?  02S1137
*                                                            @G51APSS*/
         L     @04,PWRCONS                                      02S1137
         L     @04,UCMDCB(,@04)                                 02S1137
         LTR   @04,@04                                          02S1137
         BZ    @RF01137                                         02S1137
*         DO;                       /* YES, SEE IF DEVICE IS OPEN
*                                                            @ZA18882*/
*           RFY                                                 02S1139
*             REG10 RSTD;           /*                       @ZA18882*/
*           REG10=UCMDCB;           /* ADDR OF DCB           @ZA18882*/
         LR    REG10,@04                                        02S1140
*           GEN REFS(IHADCB,REG10,DCBOFLGS)/* SET RINGPOWR   @ZA18882*/
*               SETS(RINGPOWR)      /* OFF IF DEVICE         @ZA18882*/
*               DEFS(DEVOPN3);                                  02S1141
*                                          /* IS NOT OPEN   @ZA18882*/
         USING IHADCB,REG10        ADDRESSABILITY TO DCB       @ZA18882
         TM    DCBOFLGS,DCBOFOPN   DEVICE OPEN                 @ZA18882
         BO    DEVOPN3             YES, THEN BRANCH            @ZA18882
         NI    RINGPOWR,B'11011111' DO NOT SOUND ALARM. THIS INSTR MUSTX
                                  BE CHANGED IF RINGPOWR IS MOVED      X
                                  (RE-DECLARED).               @ZA18882
DEVOPN3  EQU   *                                               @ZA18882
         DROP  REG10                                           @ZA18882
*           RFY                                                 02S1142
*             REG10 UNRSTD;         /*                       @ZA18882*/
*         END;                      /*                       @ZA18882*/
*       ELSE                        /* DEVICE IS NOT OPEN SO TRY TO
*                                      OPEN IT               @G51APSS*/
*         DO;                       /*                               */
         B     @RC01137                                         02S1144
@RF01137 DS    0H                                               02S1145
*           UCMSYSL='1'B;           /* NOTIFY DSP'S OF OPEN-TO RING
*                                      IN PROGRESS           @G51APSS*/
*           UCMSYSP='1'B;           /* MARK OPEN-TO-SOUND-POWER ALARM
*                                      IN PROGRESS           @G51APSS*/
         OI    UCMSYSL(UCMMCSPT),B'00010001'                    02S1146
*           IF UCBSYSR='0'B THEN    /* IS DEVICE ALREADY ALLOCATED AS
*                                      A CONSOLE?            @G51APSS*/
         L     @04,PWRCONS                                      02S1147
         L     @04,UCBPTR(,@04)                                 02S1147
         TM    UCBSYSR(@04),B'00000010'                         02S1147
         BNZ   @RF01147                                         02S1147
*             DO;                   /* NO                    @G51APSS*/
*               CALL ENQQ4;         /* TRY TO OBTAIN Q4      @G51APSS*/
         BAL   @14,ENQQ4                                        02S1149
*               IF UCBALOC='0'B THEN/* IS DEVICE UNALLOCATED?   02S1150
*                                                            @G51APSS*/
         L     @04,PWRCONS                                      02S1150
         L     @04,UCBPTR(,@04)                                 02S1150
         TM    UCBALOC(@04),B'00001000'                         02S1150
         BNZ   @RF01150                                         02S1150
*                 DO;               /* YES                   @G51APSS*/
*                   UCBSYSRX='1'B;  /* MARK DEVICE A CONSOLE @G51APSS*/
*                   UCBCHGSX='1'B;  /* DEVICE TO GO OFFLINE AFTER
*                                      ALARM                 @G51APSS*/
*                   UCBDADIX='1'B;  /* DEVICE TO GO OUT OF CONSOLE
*                                      STATUS AFTER ALARM    @G51APSS*/
         L     @15,UCBSYSRX-3(,@04)                             02S1154
@GL00071 LR    @14,@15                                          02S1154
         O     @14,@CF03991                                     02S1154
         CS    @15,@14,UCBSYSRX-3(@04)                          02S1154
         BNE   @GL00071                                         02S1154
*                 END;              /*                       @G51APSS*/
*               ELSE                /* DON'T USE AN ALLOCATED DEVICE
*                                                            @G51APSS*/
*                 RINGPOWR=NO;      /* DON'T SOUND ALARM     @G51APSS*/
         B     @RC01150                                         02S1156
@RF01150 NI    RINGPOWR,B'11011111'                             02S1156
*               CALL DEQQ4;         /* RELEASE Q4            @G51APSS*/
@RC01150 BAL   @14,DEQQ4                                        02S1157
*             END;                  /*                       @G51APSS*/
*           IF RINGPOWR=YES THEN    /* STILL SOUND ALARM?    @G51APSS*/
@RF01147 TM    RINGPOWR,B'00100000'                             02S1159
         BNO   @RF01159                                         02S1159
*             DO;                   /* YES                   @G51APSS*/
*               UCMTA='1'B;         /* MARK OPEN PENDING     @G51APSS*/
*               UCMCF='0'B;         /* MARK NOT CLOSE PENDING   02S1162
*                                                            @ZA18886*/
         L     @04,PWRCONS                                      02S1162
         OI    UCMTA(@04),B'00001000'                           02S1162
         NI    UCMCF(@04),B'11101111'                           02S1162
*               CALL CALLDSP(PWRCONS,CSAOPEN);/* GO OPEN DEVICE TO
*                                      SOUND ALARM           @G51APSS*/
         LA    @04,PWRCONS                                      02S1163
         ST    @04,@AL00001                                     02S1163
         LA    @04,@CH00060+1                                   02S1163
         ST    @04,@AL00001+4                                   02S1163
         LA    @01,@AL00001                                     02S1163
         BAL   @14,CALLDSP                                      02S1163
*               UCMTA='0'B;         /* TURN OFF OPEN PENDING @ZA18886*/
*               UCMCF='1'B;         /* TURN ON CLOSE PENDING @G51APSS*/
         L     @04,PWRCONS                                      02S1165
         OI    UCMCF(@04),B'00010000'                           02S1165
         NI    UCMTA(@04),B'11110111'                           02S1165
*               IF UCMDCB=ZERO THEN /* DCB OBTAINED?         @G51APSS*/
         ICM   @15,15,UCMDCB(@04)                               02S1166
         BNZ   @RF01166                                         02S1166
*                 RINGPOWR=NO;      /* NO, DEVICE NOT OPEN. DON'T
*                                      SOUND ALARM           @G51APSS*/
         NI    RINGPOWR,B'11011111'                             02S1167
*               ELSE                /*                               */
*                 DO;               /* YES, SEE IF DEVICE IS OPEN
*                                                            @ZA18882*/
         B     @RC01166                                         02S1168
@RF01166 DS    0H                                               02S1169
*                   RFY                                         02S1169
*                     REG10 RSTD;   /*                       @ZA18882*/
*                   REG10=UCMDCB;   /* ADDR OF DCB           @ZA18882*/
         L     @04,PWRCONS                                      02S1170
         L     REG10,UCMDCB(,@04)                               02S1170
*                   GEN REFS(IHADCB,REG10,DCBOFLGS)/* SET RINGPOWR
*                                                            @ZA18882*/
*                       SETS(RINGPOWR)/* OFF IF DEVICE       @ZA18882*/
*                       DEFS(DEVOPN4);                          02S1171
*                                          /* IS NOT OPEN    @ZA18882*/
         USING IHADCB,REG10        ADDRESSABILITY TO DCB       @ZA18882
         TM    DCBOFLGS,DCBOFOPN   DEVICE OPEN                 @ZA18882
         BO    DEVOPN4             YES, THEN BRANCH            @ZA18882
         NI    RINGPOWR,B'11011111' DO NOT SOUND ALARM. THIS INSTR MUSTX
                                  BE CHANGED IF RINGPOWR IS MOVED      X
                                  (RE-DECLARED).               @ZA18882
DEVOPN4  EQU   *                                               @ZA18882
         DROP  REG10                                           @ZA18882
*                   RFY                                         02S1172
*                     REG10 UNRSTD; /*                       @ZA18882*/
*                 END;              /*                       @ZA18882*/
*               IF RINGPOWR=NO THEN /* DEVICE OPENED?        @G51APSS*/
@RC01166 TM    RINGPOWR,B'00100000'                             02S1174
         BNZ   @RF01174                                         02S1174
*                 CALL CALLDSP(PWRCONS,CSACLOSE);/* NO, GO TO DSP TO
*                                      CLOSE DEVICE          @G51APSS*/
         LA    @04,PWRCONS                                      02S1175
         ST    @04,@AL00001                                     02S1175
         LA    @04,@CH00065+1                                   02S1175
         ST    @04,@AL00001+4                                   02S1175
         LA    @01,@AL00001                                     02S1175
         BAL   @14,CALLDSP                                      02S1175
*               ELSE                                            02S1176
*                 CLOSEALR=YES;     /* CLOSE DEVICE LATER    @G51APSS*/
         B     @RC01174                                         02S1176
@RF01174 OI    CLOSEALR,B'00010000'                             02S1176
*             END;                  /*                       @G51APSS*/
@RC01174 DS    0H                                               02S1178
*           UCMSYSL='0'B;           /* FINISHED OPENING DEVICE  02S1178
*                                                            @G51APSS*/
@RF01159 DS    0H                                               02S1179
*           UCMSYSP='0'B;           /*                       @G51APSS*/
         NI    UCMSYSL(UCMMCSPT),B'11101110'                    02S1179
*         END;                      /* OF OPENING DEVICE     @G51APSS*/
*     END;                          /* OF TRY TO SOUND ALARM @G51APSS*/
@RC01137 DS    0H                                               02S1182
*   IF RINGPOWR=YES THEN            /* STILL SOUND ALARM?    @G51APSS*/
@RC01134 TM    RINGPOWR,B'00100000'                             02S1182
         BNO   @RF01182                                         02S1182
*     DO;                           /* YES                   @G51APSS*/
*       CALL FRLOCKS;               /* RELEASE THE LOCKS     @G51APSS*/
         BAL   @14,FRLOCKS                                      02S1184
*       CALL BELLEXCP(POWER);       /* SOUND POWER ALARM     @G51APSS*/
         LA    @01,@AL01185                                     02S1185
         BAL   @14,BELLEXCP                                     02S1185
*       CALL GETLOCKS;              /* OBTAIN THE LOCKS      @G51APSS*/
         BAL   @14,GETLOCKS                                     02S1186
*       IF CLOSEBEL=YES×            /* CLOSE BELL DEVICE? OR @G51APSS*/
*           CLOSEALR=YES THEN       /* CLOSE POWER ALARM DEVICE 02S1187
*                                                            @G51APSS*/
         TM    CLOSEBEL,B'00110000'                             02S1187
         BZ    @RF01187                                         02S1187
*         DO;                       /* YES                   @G51APSS*/
*           UCMSYSP='1'B;           /* ACCESS-TO-SOUND POWER ALARM IN
*                                      PROGRESS              @G51APSS*/
*           UCMSYSL='1'B;           /*                       @G51APSS*/
         OI    UCMSYSP(UCMMCSPT),B'00010001'                    02S1190
*           CALL CALLDSP(PWRCONS,CSACLOSE);/* GO TO DSP TO CLOSE
*                                      DEVICE                @G51APSS*/
         LA    @04,PWRCONS                                      02S1191
         ST    @04,@AL00001                                     02S1191
         LA    @04,@CH00065+1                                   02S1191
         ST    @04,@AL00001+4                                   02S1191
         LA    @01,@AL00001                                     02S1191
         BAL   @14,CALLDSP                                      02S1191
*           UCMSYSP='0'B;           /* BACK FROM DSP         @G51APSS*/
*           UCMSYSL='0'B;           /*                       @G51APSS*/
         NI    UCMSYSP(UCMMCSPT),B'11101110'                    02S1193
*         END;                      /*                       @G51APSS*/
*     END;                          /*                       @G51APSS*/
*   RFY                                                         02S1196
*     UCMLIST BASED(UCMDVEPT);      /* RESET BASE FOR UCME   @G51APSS*/
*   END SOUNDPWR;                   /*                       @G51APSS*/
@EL00012 DS    0H                                               02S1197
@EF00012 DS    0H                                               02S1197
@ER00012 LM    @14,@12,@SA00012                                 02S1197
         BR    @14                                              02S1197
*/*** END OF SOUNDPWR SUBROUTINE *************************************/
*                                                               02S1198
         EJECT
*                                                               02S1198
*/*** START OF SAVEINDEX SUBROUTINE **********************************/
*/*                                                                  */
*/* SAVEINDX - FOR EVERY DEVICE WHICH CAN BECOME THE         @G51APSS*/
*/*            CANDIDATE FOR THE NEW MASTER CONSOLE, SAVE    @G51APSS*/
*/*            ITS ATTENTION INDEX AND REPLACE THE ATTENTION @G51APSS*/
*/*            INDEX WITH A X'04' SO COMM TASKS ATTN HANDLER @G51APSS*/
*/*            WILL RECEIVE CONTROL WHEN AN ATTN IS          @G51APSS*/
*/*            GENERATED ON THE DEVICE. INSURE THAT THE      @G51APSS*/
*/*            DEVICE HAS UCBSYSR ON SO ALLOCATION WILL NOT  @G51APSS*/
*/*            TOUCH THIS DEVICE.                            @G51APSS*/
*/*                                                                  */
*/*            SERIALIZATION WITH ALLOCATION IS DONE BY      @G51APSS*/
*/*            ENQING ON SYSIEFSD Q4 AND ALSO USING          @G51APSS*/
*/*            COMPARE-AND-SWAP TO MANIPULATE BITS IN THE    @G51APSS*/
*/*            UCB.                                          @G51APSS*/
*/*                                                                  */
*/* INPUT    - NONE                                          @G51APSS*/
*/*                                                                  */
*/* OUTPUT   _ UCMEFATT = SAVED ATTN INDEX                   @G51APSS*/
*/*            UCMEFLGA = 1 IF ATTN INDEX WAS SAVED          @G51APSS*/
*/*            UCBATI   = X'04' IF ATTN INDEX WAS SAVED      @G51APSS*/
*/*            UCBSYSR  = 1 IF IT WAS NOT ALREADY ON         @G51APSS*/
*/*            UCMEFLGB = 1 IF UCBSYSR WAS FORCED ON         @G51APSS*/
*/*                                                                  */
*/********************************************************************/
*                                                               02S1198
*SAVEINDX:                                                      02S1198
*   PROC OPTIONS(SAVE);             /*                       @G51APSS*/
SAVEINDX STM   @14,@12,@SA00013                                 02S1198
*   CALL ENQQ4;                     /* TRY TO OBTAIN Q4      @G51APSS*/
         BAL   @14,ENQQ4                                        02S1199
*   DO UCMDVEPT=UCMVEA TO UCMVEL BY UCMVEZ;/* LOOP THRU UCMES   02S1200
*                                                            @G51APSS*/
         L     UCMDVEPT,UCMVEA(,UCMBASPT)                       02S1200
         B     @DE01200                                         02S1200
@DL01200 DS    0H                                               02S1201
*     ACCEPT=YES;                   /* ASSUME ACCEPTANCE     @G51APSS*/
         OI    ACCEPT,B'10000000'                               02S1201
*     IF UCMCOMPC^=ZERO&            /* A COMPOSITE AND       @G51APSS*/
*         UCMIF='0'B THEN           /* THE OUTPUT HALF?      @G51APSS*/
         ICM   @11,15,UCMCOMPC(UCMDVEPT)                        02S1202
         BZ    @RF01202                                         02S1202
         TM    UCMIF(UCMDVEPT),B'01000000'                      02S1202
         BNZ   @RF01202                                         02S1202
*       ACCEPT=NO;                  /* YES, REJECT DEVICE    @G51APSS*/
         NI    ACCEPT,B'01111111'                               02S1203
*     ELSE                          /* DEVICE IS NOT A COMPOSITE OR
*                                      IT IS THE INPUT HALF  @G51APSS*/
*       DO;                         /*                       @G51APSS*/
         B     @RC01202                                         02S1204
@RF01202 DS    0H                                               02S1205
*         IF(UCMDISPD='1'B&UCMSDS5G='0'B)×/* HARDWARE OUTPUT ONLY OR
*                                                            @G51APSS*/
*             UCMDISPK='1'B×        /* JES3 DEVICE OR        @G51APSS*/
*             UCBALOC='1'B×         /* DEVICE IS ALLOCATED OR   02S1205
*                                                            @G51APSS*/
*             UCB3COMM='1'B×        /* DEVICE IS A 2740 OR   @G51APSS*/
*             UCBNALOC='1'B×        /* DEVICE IS NOT ALLOCATABLE OR
*                                                            @G51APSS*/
*             UCMEFLGA='1'B THEN    /* ATTN INDEX HAS ALREADY BEEN
*                                      SAVED FOR THIS DEVICE @G51APSS*/
         TM    UCMDISPD(UCMDVEPT),B'00010000'                   02S1205
         BNO   @GL00077                                         02S1205
         TM    UCMSDS5G(UCMDVEPT),B'00000010'                   02S1205
         BZ    @RT01205                                         02S1205
@GL00077 TM    UCMDISPK(UCMDVEPT),B'00100000'                   02S1205
         BO    @RT01205                                         02S1205
         L     @11,UCBPTR(,UCMDVEPT)                            02S1205
         TM    UCBALOC(@11),B'00001000'                         02S1205
         BO    @RT01205                                         02S1205
         TM    UCB3COMM(@11),B'01000000'                        02S1205
         BO    @RT01205                                         02S1205
         TM    UCBNALOC(@11),B'00000100'                        02S1205
         BO    @RT01205                                         02S1205
         L     @11,UCMFEXTP(,UCMDVEPT)                          02S1205
         TM    UCMEFLGA(@11),B'10000000'                        02S1205
         BNO   @RF01205                                         02S1205
@RT01205 DS    0H                                               02S1206
*           ACCEPT=NO;              /* YES TO ANY OF ABOVE THEN 02S1206
*                                      REJECT THE DEVICE     @G51APSS*/
         NI    ACCEPT,B'01111111'                               02S1206
*         ELSE                      /* DEVICE OF SO FAR      @G51APSS*/
*           IF UCMCOMPC^=ZERO&      /* IS IT A COMPOSITE AND @G51APSS*/
*               (UCMCOMPC->UCMDISPK='1'B×/* OUTPUT HALF IS A JES3
*                                      DEVICE OR             @G51APSS*/
*               UCMCOMPC->UCMUCB->UCBALOC='1'B×/* OUTPUT HALF IS
*                                      ALLOCATED OR          @G51APSS*/
*               UCMCOMPC->UCMUCB->UCB3COMM='1'B×/* OUTPUT HALF IS A
*                                      2740 DEVICE OR        @G51APSS*/
*               UCMCOMPC->UCMUCB->UCBNALOC='1'B×/* OUTPUT HALF IS NOT
*                                      ALLOCATABLE OR        @G51APSS*/
*               UCMCOMPC->UCMFEXTP->UCMEFLGA='1'B) THEN/* OUTPUT
*                                      HALFS ATTN INDEX HAS BEEN
*                                      SAVED?                @G51APSS*/
         B     @RC01205                                         02S1207
@RF01205 L     @11,UCMCOMPC(,UCMDVEPT)                          02S1207
         LTR   @11,@11                                          02S1207
         BZ    @RF01207                                         02S1207
         TM    UCMDISPK(@11),B'00100000'                        02S1207
         BO    @RT01207                                         02S1207
         L     @07,UCMUCB(,@11)                                 02S1207
         TM    UCBALOC(@07),B'00001000'                         02S1207
         BO    @RT01207                                         02S1207
         TM    UCB3COMM(@07),B'01000000'                        02S1207
         BO    @RT01207                                         02S1207
         TM    UCBNALOC(@07),B'00000100'                        02S1207
         BO    @RT01207                                         02S1207
         L     @11,UCMFEXTP(,@11)                               02S1207
         TM    UCMEFLGA(@11),B'10000000'                        02S1207
         BNO   @RF01207                                         02S1207
@RT01207 DS    0H                                               02S1208
*             ACCEPT=NO;            /* IF ANY OF ABOVE ARE TRUE THEN
*                                      REJECT THE DEVICE     @G51APSS*/
         NI    ACCEPT,B'01111111'                               02S1208
*       END;                        /*                       @G51APSS*/
@RF01207 DS    0H                                               02S1209
@RC01205 DS    0H                                               02S1210
*     IF ACCEPT=YES THEN            /* OK TO USE DEVICE?     @G51APSS*/
@RC01202 TM    ACCEPT,B'10000000'                               02S1210
         BNO   @RF01210                                         02S1210
*       DO;                         /* YES                   @G51APSS*/
*         UCMEFATT=UCBATI;          /* SAVE ATT INDEX. IF COMPOSITE
*                                      THEN ONLY INPUT HALFS IS SAVED
*                                                            @G51APSS*/
         L     @11,UCMFEXTP(,UCMDVEPT)                          02S1212
         L     @07,UCBPTR(,UCMDVEPT)                            02S1212
         L     @04,UCBEXTPT(,@07)                               02S1212
         MVC   UCMEFATT(1,@11),UCBATI(@04)                      02S1212
*         UCMEFLGA='1'B;            /* MARK THAT ATT INDEX SAVED IS
*                                      VALID                 @G51APSS*/
         OI    UCMEFLGA(@11),B'10000000'                        02S1213
*         UCBATI=COMTSKAX;          /* CHANGE ATTN INDEX SO COMM
*                                      TASKS ATTN HANDLER WILL  02S1214
*                                      RECEIVE CNTL IF AN ATTN IS
*                                      GENERATED ON THIS DEVICE 02S1214
*                                                            @G51APSS*/
         MVI   UCBATI(@04),X'04'                                02S1214
*         IF UCBSYSR='0'B THEN      /* DEVICE MARKED AS CONSOLE?
*                                                            @G51APSS*/
         TM    UCBSYSR(@07),B'00000010'                         02S1215
         BNZ   @RF01215                                         02S1215
*           DO;                     /* NO                    @G51APSS*/
*             UCBSYSRX='1'B;        /* MARK AS A CONSOLE     @G51APSS*/
         L     @11,UCBSYSRX-3(,@07)                             02S1217
@GL00084 LR    @04,@11                                          02S1217
         O     @04,@CF03988                                     02S1217
         CS    @11,@04,UCBSYSRX-3(@07)                          02S1217
         BNE   @GL00084                                         02S1217
*             UCMEFLGB='1'B;        /* MARK THAT UCBSYSR WAS FORCED
*                                      ON                    @G51APSS*/
         L     @11,UCMFEXTP(,UCMDVEPT)                          02S1218
         OI    UCMEFLGB(@11),B'01000000'                        02S1218
*           END;                    /*                       @G51APSS*/
*         IF UCMCOMPC^=ZERO&        /* A COMPOSITE?          @G51APSS*/
*             UCMCOMPC->UCMUCB->UCBSYSR='0'B THEN/* AND OUTPUT HALF
*                                      IS NOT MARKED AS A CONSOLE?
*                                                            @G51APSS*/
@RF01215 L     @11,UCMCOMPC(,UCMDVEPT)                          02S1220
         LTR   @11,@11                                          02S1220
         BZ    @RF01220                                         02S1220
         L     @11,UCMUCB(,@11)                                 02S1220
         TM    UCBSYSR(@11),B'00000010'                         02S1220
         BNZ   @RF01220                                         02S1220
*           DO;                     /* YES                   @G51APSS*/
*             UCMCOMPC->UCMUCB->UCBSYSRX='1'B;/* MARK AS A CONSOLE
*                                                            @G51APSS*/
         L     @07,UCBSYSRX-3(,@11)                             02S1222
@GL00086 LR    @04,@07                                          02S1222
         O     @04,@CF03988                                     02S1222
         CS    @07,@04,UCBSYSRX-3(@11)                          02S1222
         BNE   @GL00086                                         02S1222
*             UCMCOMPC->UCMFEXTP->UCMEFLGB='1'B;/* MARK THAT UCBSYSR
*                                      WAS FORCED ON         @G51APSS*/
         L     @11,UCMCOMPC(,UCMDVEPT)                          02S1223
         L     @11,UCMFEXTP(,@11)                               02S1223
         OI    UCMEFLGB(@11),B'01000000'                        02S1223
*           END;                    /*                       @G51APSS*/
*       END;                        /* OF OK TO USE DEVICE   @G51APSS*/
@RF01220 DS    0H                                               02S1226
*   END;                            /* OF DO LOOP THRU UCMES @G51APSS*/
@RF01210 AL    UCMDVEPT,UCMVEZ(,UCMBASPT)                       02S1226
@DE01200 C     UCMDVEPT,UCMVEL(,UCMBASPT)                       02S1226
         BNH   @DL01200                                         02S1226
*   CALL DEQQ4;                     /* RELEASE Q4            @G51APSS*/
         BAL   @14,DEQQ4                                        02S1227
*   END SAVEINDX;                   /*                       @G51APSS*/
@EL00013 DS    0H                                               02S1228
@EF00013 DS    0H                                               02S1228
@ER00013 LM    @14,@12,@SA00013                                 02S1228
         BR    @14                                              02S1228
*/*** END OF SAVEINDX SUBROUTINE *************************************/
*                                                               02S1229
         EJECT
*                                                               02S1229
*/*** START OF SUBSWTCH SUBROUTINE **************************@ZA03626*/
*/*                                                                  */
*/* SUBSWTCH - SUBSYSTEM EXIT FOR ALL CONSOLE SWITCH OR NO CONSOLE   */
*/*            CONDITIONS.                                           */
*/* FUNCTION - TO SET UP AND EXECUTE A SUBSYSTEM EXIT TO MAKE THE    */
*/*            SUBSYSTEM AWARE OF CONSOLE CHANGING STATUS, OR A      */
*/*            NO CONSOLE CONDITION. THIS ALLOWS THE SUBSYSTEM TO    */
*/*            UP-DATE ANY INTERNAL CONSOLE-ORIENTED TABLES IT MAY   */
*/*            BE RETAINING.                                         */
*/*                                                                  */
*/* INPUT - FAILI = UCME ADDR OF INPUT HALF OF OLD CONSOLE.          */
*/*         NEWI  = UCME ADDR OF INPUT HALF OF NEW CONSOLE.          */
*/*         UCMMCENT = UCME ADDR OF MASTER CONSOLE.                  */
*/*                                                                  */
*/* OUTPUT - A PARAMETER LIST TO THE SUBSYSTEM IN THE FORMAT -       */
*/*          FOR CONSOLE SWITCH -                                    */
*/*          . TWO WORDS -                                           */
*/*            1- ADDR OF OLD INPUT UCME - HI-BYTE = X'40'           */
*/*            2- ADDR OF NEW INPUT UCME - HI-BYTE = X'00'           */
*/*          FOR NO CONSOLE CONDITION -                              */
*/*          . ONE WORD -                                            */
*/*            1- ADDR OF MASTER CONSOLE - HI-BYTE = X'80'           */
*/********************************************************************/
*                                                               02S1229
*SUBSWTCH:                                                      02S1229
*   PROC OPTIONS(SAVE(REG14));      /*                       @ZA03626*/
SUBSWTCH ST    @14,@SA00014                                     02S1229
*   DCL                                                         02S1230
*     H80MASK PTR(32) INIT('80000000'X);/* HI-BYTE MASK FOR NO  02S1230
*                                      CONSOLE               @ZA03626*/
*   DCL                                                         02S1231
*     H40MASK PTR(32) INIT('40000000'X);/* HI-BYTE MASK FOR SWITCH
*                                      CONS                  @ZA03626*/
*   DCL                                                         02S1232
*     H00MASK PTR(32) INIT('00000000'X);/* HI-BYTE ZER MASK  @ZA03626*/
*   RFY                                                         02S1233
*    (REG02,                                                    02S1233
*     REG04,                                                    02S1233
*     REG13) RSTD;                  /*                       @G51APSS*/
*   SSOB=SSOB&&SSOB;                /* ZERO OUT SSOB         @ZA03626*/
         XC    SSOB(20),SSOB                                    02S1234
*   SSOBID=NAMESSOB;                /* FILL IN ID FIELD      @ZA03626*/
         MVC   SSOBID(4),@CC00112                               02S1235
*   SSOBLEN=LENGTH(SSOB);           /* SSOB LENGTH           @ZA03626*/
         MVC   SSOBLEN(2),@CH00069                              02S1236
*   SSOBINDV=ADDR(SSWT);            /* ADDR OF PARM LIST     @ZA03626*/
         LA    @11,SSWT                                         02S1237
         ST    @11,SSOBINDV                                     02S1237
*   SSWT=SSWT&&SSWT;                /* ZERO PARM LIST        @ZA03626*/
         XC    SSWT(16),SSWT                                    02S1238
*   SSWTLEN=LENGTH(SSWT);           /* SSWT LENGTH           @ZA03626*/
         MVC   SSWTLEN(2),@CH00071                              02S1239
*   SSOBFUNC=SSOBCONS;              /* INDICATE NO CONSOLE, SWITCH
*                                                            @ZA03626*/
         MVC   SSOBFUNC(2),@CH00434                             02S1240
*   IF NCCNOW=YES THEN              /* THIS IS NO CONSOLE COND  02S1241
*                                                            @ZA18879*/
         TM    NCCNOW,B'01000000'                               02S1241
         BNO   @RF01241                                         02S1241
*     DO;                                                       02S1242
*       SSWTWQE=UCMMCENT;           /* MASTER CONSOLE UCME ADDR 02S1243
*                                                            @ZA03626*/
         L     @11,UCMMCENT(,UCMMCSPT)                          02S1243
         ST    @11,SSWTWQE                                      02S1243
*       SSWTWQE=SSWTWQE×H80MASK;    /* SET HI-BYTE INDICATOR @ZA03626*/
         O     @11,H80MASK                                      02S1244
         ST    @11,SSWTWQE                                      02S1244
*     END;                                                      02S1245
*   ELSE                            /* THIS IS CONSOLE SWTCH @ZA03626*/
*     DO;                                                       02S1246
         B     @RC01241                                         02S1246
@RF01241 DS    0H                                               02S1247
*       SSWTWQE=FAILI;              /* OLD CONSOLE UCME ADDR @ZA03626*/
         L     @11,FAILI                                        02S1247
         ST    @11,SSWTWQE                                      02S1247
*       SSWTWQE=SSWTWQE×H40MASK;    /* SET HI-BYTE INDICATOR @ZA03626*/
         L     @15,H40MASK                                      02S1248
         OR    @11,@15                                          02S1248
         ST    @11,SSWTWQE                                      02S1248
*       SSWTMIN=NEWI;               /* NEW CONSOLE UCME ADDR @ZA03626*/
         ST    NEWI,SSWTMIN                                     02S1249
*       SSWTMIN=SSWTMIN×H00MASK;    /* ZERO HI-BYTE ADDR.    @ZA03626*/
         L     @11,SSWTMIN                                      02S1250
         O     @11,H00MASK                                      02S1250
         ST    @11,SSWTMIN                                      02S1250
*       IF MSTSWTCH='1'B THEN       /* FAILING MASTER CONSOLE   02S1251
*                                                            @ZA03626*/
         TM    MSTSWTCH,B'00001000'                             02S1251
         BNO   @RF01251                                         02S1251
*         DO;                                                   02S1252
*           SSWTORE=SSWTORE×H40MASK;/* TELL SUB-SYSTEM       @ZA03626*/
         O     @15,SSWTORE                                      02S1253
         ST    @15,SSWTORE                                      02S1253
*           MSTSWTCH='0'B;          /* TURN OFF FLAG         @ZA03626*/
         NI    MSTSWTCH,B'11110111'                             02S1254
*         END;                                                  02S1255
*     END;                                                      02S1256
@RF01251 DS    0H                                               02S1257
*   CALL FRLOCKS;                   /* RELEASE LOCKS ACROSS EXIT
*                                                            @ZA03626*/
@RC01241 BAL   @14,FRLOCKS                                      02S1257
*   REG04=REG13;                    /* SAVE SAV EAREA ADDR ACROSS
*                                      EXIT                  @ZA03626*/
         LR    REG04,REG13                                      02S1258
*   REG13=ADDR(SAV0SAVE);           /* SAVEAREA FOR SUBSYSTEM USE
*                                                            @ZA03626*/
         LA    REG13,SAV0SAVE                                   02S1259
*/*   ? IEFSSREQ  (SSOB);                                            */
*/*                                                                  */
*/*  PASS CONTROL TO JOB ENTRY SUBSYSTEM TO                          */
*/*  PROCESS REQUEST -                                               */
*/*                                                                  */
*/*    INPUT - REGISTER 1 POINTS TO A ONE-                           */
*/*            WORD PARAMETER LIST WHICH                             */
*/*            POINTS TO THE SSOB                                    */
*/*                                                                  */
*                                                               02S1260
*   CALL SSREQ(SSOB);               /* EXIT TO SUBSYSTEM     @ZA03626*/
         LA    @11,SSOB                                         02S1260
         ST    @11,@AL00001                                     02S1260
         MVI   @AL00001,X'80'                                   02S1260
         L     @11,LCVTPTR                                      02S1260
         L     @11,CVTJESCT(,@11)                               02S1260
         L     @15,JESSSREQ(,@11)                               02S1260
         LA    @01,@AL00001                                     02S1260
         BALR  @14,@15                                          02S1260
*   REG13=REG04;                    /* RESTORE SAVEAREA PTR  @ZA03626*/
         LR    REG13,REG04                                      02S1261
*   CALL GETLOCKS;                  /* RE-ACQUIRE LOCKS      @ZA03626*/
         BAL   @14,GETLOCKS                                     02S1262
*   RFY                                                         02S1263
*    (REG02,                                                    02S1263
*     REG13) UNRSTD;                /*                       @G51APSS*/
*   END SUBSWTCH;                                               02S1264
*                                                               02S1264
@EL00014 DS    0H                                               02S1264
@EF00014 DS    0H                                               02S1264
@ER00014 L     @14,@SA00014                                     02S1264
         BR    @14                                              02S1264
*/*** END OF SUBSWTCH SUBROUTINE *************************************/
*                                                               02S1265
         EJECT
*                                                               02S1265
*/*** START OF CALLDSP SUBROUTINE ************************************/
*/*                                                                  */
*/* CALLDSP  _ SUBROUTINE TO CALL A DEVICE PROCESSOR TO      @G51APSS*/
*/*            OPEN OR CLOSE A CONSOLE                       @G51APSS*/
*/*                                                                  */
*/* FUNCTION - SAVES REGISTERS, INITIALIZES REGISTERS AND    @G51APSS*/
*/*            THE CSA FOR THE DEVICE PROCESSOR, THEN CALLS  @G51APSS*/
*/*            THE DSP. IF THE DEVICE IS A 1052 THEN THE     @G51APSS*/
*/*            LOCKS ARE NOT RELEASED                        @G51APSS*/
*/*                                                          @G51APSS*/
*/*            IF THE DEVICE IS TO CLOSE THEN THE DSP MAY    @G51APSS*/
*/*            BE CALLED TWICE. I.E. DIDOCS FIRST BLANKS THE @G51APSS*/
*/*            SCREEN AND THEN RETURNS CONTROL. WHEN THE     @G51APSS*/
*/*            EXCP HAS COMPLETED DIDOCS IS CALLED AGAIN     @G51APSS*/
*/*            TO FINISH THE CLOSE. IF THE I/0 NEVER         @G51APSS*/
*/*            COMPLETES THEN THE UCME IS MADE TO APPEAR AS  @G51APSS*/
*/*            IF THE I/0 COMPLETED AND DIDOCS IS THEN       @G51APSS*/
*/*            CALLED                                        @G51APSS*/
*/*                                                                  */
*/* INPUT    - TYPECONS - UCME ADDR OF DEVICE TO OPEN/CLOSE  @G51APSS*/
*/*            OPNCLOSE - CODE WHICH TELLS DSP TO OPEN OR    @G51APSS*/
*/*                       CLOSE                              @G51APSS*/
*/*                                                                  */
*/* OUTPUT   - DEVICE IS OPEN OR CLOSED                      @G51APSS*/
*/*                                                                  */
*/********************************************************************/
*                                                               02S1265
*CALLDSP:                                                       02S1265
*   PROC(TYPECONS,OPNCLOSE) OPTIONS(SAVE);/*                 @G51APSS*/
CALLDSP  STM   @14,@12,@SA00015                                 02S1265
         MVC   @PC00015(8),0(@01)                               02S1265
*   DCL                                                         02S1266
*     TYPECONS PTR(31);             /* UCME ADDR OF DEVICE TO   02S1266
*                                      OPEN/CLOSE            @G51APSS*/
*   DCL                                                         02S1267
*     OPNCLOSE FIXED(8);            /* CODE WHICH TELLS THE DSP TO
*                                      OPEN OR CLOSE DEVICE  @G51APSS*/
*   RFY                                                         02S1268
*     UCMLIST BASED(TYPECONS);      /* RE-BASE UCME          @G51APSS*/
*   RFY                                                         02S1269
*    (REG01,                                                    02S1269
*     REG08,                                                    02S1269
*     REG09,                                                    02S1269
*     REG13,                                                    02S1269
*     REG15) RSTD;                  /*                       @G51APSS*/
*   UCMSWSA1=REG13;                 /* SAVE REG ACROSS CALL  @G51APSS*/
         ST    REG13,UCMSWSA1(,UCMMCSPT)                        02S1270
*   UCMSWSA2=REG09;                 /* SAVE DATA REG         @G51APSS*/
         ST    REG09,UCMSWSA2(,UCMMCSPT)                        02S1271
*   STM(REG05,REG06,OPENSAVE);      /* SAVE CODE REGS        @ZA10758*/
         STM   REG05,REG06,OPENSAVE                             02S1272
*   OPENSAV8=REG08;                 /* SAVE CODE REG         @ZA10758*/
         ST    REG08,OPENSAV8                                   02S1273
*   SAVCSAXA=CSAXA;                 /* SAVE RETURN ADDR              */
         MVC   SAVCSAXA(4),CSAXA(CXSAPTR)                       02S1274
*   IF UCMEFLGA='0'B THEN           /* HAS ATTN INDEX ALREADY BEEN
*                                      SAVED?                @G51APSS*/
         L     @14,@PC00015                                     02S1275
         L     @14,TYPECONS(,@14)                               02S1275
         L     @11,UCMFEXTP(,@14)                               02S1275
         TM    UCMEFLGA(@11),B'10000000'                        02S1275
         BNZ   @RF01275                                         02S1275
*     DO;                           /* NO                    @G51APSS*/
*       UCMEFATT=UCBATI;            /* SAVE ATTN INDEX       @G51APSS*/
         L     @14,UCBPTR(,@14)                                 02S1277
         L     @14,UCBEXTPT(,@14)                               02S1277
         MVC   UCMEFATT(1,@11),UCBATI(@14)                      02S1277
*       UCMEFLGA='1'B;              /* MARK THAT ATTN INDEX SAVED IS
*                                      VALID                 @G51APSS*/
         OI    UCMEFLGA(@11),B'10000000'                        02S1278
*       UCBATI=COMTSKAX;            /* CHANGE ATTN INDEX TO COMMTASKS
*                                                            @G51APSS*/
         MVI   UCBATI(@14),X'04'                                02S1279
*     END;                          /*                       @G51APSS*/
*   SW1='0'B;                       /* SET END OF LOOP SWITCH OFF
*                                                            @G51APSS*/
*                                                               02S1281
@RF01275 NI    SW1,B'01111111'                                  02S1281
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL THE DEVICE SERVICE PROCESSOR TO OPEN/CLOSE THE DEVICE.   */
*   /*                                                       @G51APSS*/
*   /*                                                               */
*   /*****************************************************************/
*                                                               02S1282
*   DO I=1 TO 2 WHILE SW1='0'B;     /*                       @G51APSS*/
         LA    @14,1                                            02S1282
         ST    @14,I                                            02S1282
@DL01282 TM    SW1,B'10000000'                                  02S1282
         BNZ   @DC01282                                         02S1282
*     CSAUCM=TYPECONS;              /* PUT UCME ADDR IN PARMLIST
*                                                            @G51APSS*/
         L     @14,@PC00015                                     02S1283
         L     @14,TYPECONS(,@14)                               02S1283
         ST    @14,CSAUCM(,CXSAPTR)                             02S1283
*     CSACODE=OPNCLOSE;             /* SET CODE TO INDICATE     02S1284
*                                      OPEN/CLOSE            @G51APSS*/
         L     @11,@PC00015+4                                   02S1284
         MVC   CSACODE(1,CXSAPTR),OPNCLOSE(@11)                 02S1284
*     CSANAME=UCMNAME;              /* SET UP CXSA FOR DSP   @G51APSS*/
         MVC   CSANAME(8,CXSAPTR),UCMNAME(@14)                  02S1285
*     REG01=REG12;                  /* PASS PTR TO CSA IN REG 1      */
         LR    REG01,REG12                                      02S1286
*     IF CSANAME(4:5)=V1052ID THEN  /* IS DSP 1052?          @G51APSS*/
         CLC   CSANAME+3(2,CXSAPTR),@CC00120                    02S1287
         BNE   @RF01287                                         02S1287
*       REG15=ADDR(IGC0I07B);       /* YES, USE SPECIAL ENTRY POINT  */
         L     REG15,@CV00237                                   02S1288
*     ELSE                          /* NO                    @G51APSS*/
*       DO;                         /*                       @G51APSS*/
         B     @RC01287                                         02S1289
@RF01287 DS    0H                                               02S1290
*         REG15=UCMSBR;             /* USE NORMAL MODULE EP  @G51APSS*/
         L     @14,@PC00015                                     02S1290
         L     @14,TYPECONS(,@14)                               02S1290
         L     REG15,UCMSBR(,@14)                               02S1290
*         CALL FRLOCKS;             /* RELEASE LOCKS FOR DSP @G51APSS*/
         BAL   @14,FRLOCKS                                      02S1291
*       END;                        /*                       @G51APSS*/
*     GEN REFS(REG12,REG14,REG15,CXSA,CSACTLM) SETS(REG14,UCMDCB);
@RC01287 DS    0H                                               02S1293
         BALR  REG14,REG15         CALL DSP TO OPEN/CLOSE      @G51APSS
         LR    REG12,REG01         RE-INITIALIZE CXSA BASE
         L     REG15,CSACTLM-CXSA(REG12) GET UCM BASE ADDR
         BCTR  REG15,0             DECR BY 1
         BCTR  REG15,0             DECR BY 2
         BCTR  REG15,0             DECR BY 3
         BCTR  REG15,0             DECR BY 4 TO FIND PTR TO UCM PREFIX
         L     REG15,0(REG15)      GET PTR TO UCMPRFX
*     REG13=REG15->UCMSWSA1;        /* RESTORE SAVEAREA PTR  @G51APSS*/
         L     REG13,UCMSWSA1(,REG15)                           02S1294
*     REG09=REG15->UCMSWSA2;        /* RESTORE DATA REG      @G51APSS*/
         L     REG09,UCMSWSA2(,REG15)                           02S1295
*     LM(REG05,REG06,OPENSAVE);     /* RESTORE CODE REGS     @G51APSS*/
         LM    REG05,REG06,OPENSAVE                             02S1296
*     REG08=OPENSAV8;               /* RESTORE CODE REG      @G51APSS*/
         L     REG08,OPENSAV8                                   02S1297
*     IF OPNCLOSE=CSAOPEN×          /* CALL DSP TO OPEN OR   @G51APSS*/
*         UCMDCB=ZERO THEN          /* DEVICE IS CLOSED?     @G51APSS*/
         L     @14,@PC00015+4                                   02S1298
         CLI   OPNCLOSE(@14),0                                  02S1298
         BE    @RT01298                                         02S1298
         L     @14,@PC00015                                     02S1298
         L     @14,TYPECONS(,@14)                               02S1298
         ICM   @00,15,UCMDCB(@14)                               02S1298
         BNZ   @RF01298                                         02S1298
@RT01298 DS    0H                                               02S1299
*       DO;                         /* YES                   @G51APSS*/
*         SW1='1'B;                 /* STOP LOOP             @G51APSS*/
         OI    SW1,B'10000000'                                  02S1300
*         CALL GETLOCKS;            /* OBTAIN LOCKS          @G51APSS*/
         BAL   @14,GETLOCKS                                     02S1301
*       END;                        /*                       @G51APSS*/
*     ELSE                          /* TRYING TO CLOSE A     @G51APSS*/
*       DO;                         /* DIDOCS DEVICE         @G51APSS*/
         B     @RC01298                                         02S1303
@RF01298 DS    0H                                               02S1304
*         CALL FRLOCKS;             /* RELEASE LOCKS         @G51APSS*/
         BAL   @14,FRLOCKS                                      02S1304
*         GEN REFS(THREESEC)(STIMER WAIT,BINTVL=THREESEC);/* WAIT FOR
*                                      I/O TO COMPLETE       @G51APSS*/
         STIMER WAIT,BINTVL=THREESEC
*         CALL GETLOCKS;            /* OBTAIN LOCKS          @G51APSS*/
         BAL   @14,GETLOCKS                                     02S1306
*         IF IOCOMP^=EXCPSUCC THEN  /* IS I/O COMPLETE?      @G51APSS*/
         L     @14,@PC00015                                     02S1307
         L     @14,TYPECONS(,@14)                               02S1307
         CLI   IOCOMP(@14),X'7F'                                02S1307
         BE    @RF01307                                         02S1307
*           DO;                     /* NO, CAUSE TO LOOK COMPLETE
*                                                            @G51APSS*/
*             UCMDEVE='1'B;         /* MARK I/O COMPLETE     @G51APSS*/
         OI    UCMDEVE(@14),B'00001000'                         02S1309
*             IOCOMP=EXCPSUCC;      /* MARK I/O SUCCESSFULL  @G51APSS*/
         MVI   IOCOMP(@14),X'7F'                                02S1310
*           END;                    /*                       @G51APSS*/
*       END;                        /*                       @G51APSS*/
@RF01307 DS    0H                                               02S1313
*   END;                            /* OF DO LOOP            @G51APSS*/
@RC01298 LA    @14,1                                            02S1313
         AL    @14,I                                            02S1313
         ST    @14,I                                            02S1313
         CH    @14,@CH00063                                     02S1313
         BNH   @DL01282                                         02S1313
@DC01282 DS    0H                                               02S1314
*   CSAXA=SAVCSAXA;                 /* RESTORE RETURN ADDRESS        */
         MVC   CSAXA(4,CXSAPTR),SAVCSAXA                        02S1314
*   RFY                                                         02S1315
*     UCMLIST BASED(UCMDVEPT);      /*                       @G51APSS*/
*   RFY                                                         02S1316
*    (REG01,                                                    02S1316
*     REG08,                                                    02S1316
*     REG09,                                                    02S1316
*     REG13,                                                    02S1316
*     REG15) UNRSTD;                /*                       @G51APSS*/
*   END CALLDSP;                    /*                       @G51APSS*/
@EL00015 DS    0H                                               02S1317
@EF00015 DS    0H                                               02S1317
@ER00015 LM    @14,@12,@SA00015                                 02S1317
         BR    @14                                              02S1317
*/*** END OF CALLDSP SUBROUTINE **************************************/
*                                                               02S1318
         EJECT
*                                                               02S1318
*/*** START OF BELLEXCP SUBROUTINE ***********************************/
*/*                                                                  */
*/* BELLEXCP - ISSUE EXCP 3 TIMES TO SOUND A CONSOLES ALARM  @G51APSS*/
*/*            OR TO SOUND THE POWER AND COOLING ALARM       @G51APSS*/
*/*                                                                  */
*/* FUNCTION - THIS SUBROUTINE SAVES THE PTR TO THE CURRENT CCW,     */
*/*            THEN A CHECK IS MADE TO SEE IF THE DEVICE IS  @ZA18885*/
*/*            MARKED NOT READY. IF SO THEN THE ALARM IS NOT @ZA18885*/
*/*            SOUNDED. IF THE DEVICE IS READY THEN AN EXCP  @ZA18885*/
*/*            IS ISSUED TO SOUND THE ALARM. A 3 SECOND      @ZA18885*/
*/*            STIMER WAIT IS THEN ISSUED. IF THE I/O HAS    @ZA18885*/
*/*            NOT COMPLETED SUCCESSFULLY THEN NO MORE       @ZA18885*/
*/*            ATTEMPTS TO SOUND THE ALARM ARE MADE. IF THE  @ZA18885*/
*/*            I/O COMPLETED SUCCESSFULLY THEN AN ATTEMPT IS @ZA18885*/
*/*            MADE TO SOUND THE ALARM 2 MORE TIMES.         @ZA18885*/
*/*                                                                  */
*/* INPUT    - TYPECCW IS TESTED TO DETERMINE IF A           @G51APSS*/
*/*            CONSOLES ALARM SHOULD BE SOUNDED OR IF THE    @G51APSS*/
*/*            POWER AND COOLING ALARM SHOULD BE SOUNDED.    @G51APSS*/
*/*                                                                  */
*/* OUTPUT -   DING --- DING --- DING.                               */
*/*                                                                  */
*/* NOTES    - APARS ZA08472,ZA10759,ZA17295 WERE ONCE       @G51APSS*/
*/*            FIXED IN THIS SUBROUTINE BUT HAVE BEEN        @G51APSS*/
*/*            REPLACED BY SUPPORT CODE G51APSS              @G51APSS*/
*/*                                                                  */
*/********************************************************************/
*                                                               02S1318
*BELLEXCP:                                                      02S1318
*   PROC(TYPECCW) OPTIONS(SAVE);    /*                       @G51APSS*/
BELLEXCP STM   @14,@12,@SA00016                                 02S1318
         MVC   @PC00016(4),0(@01)                               02S1318
*   DCL                                                         02S1319
*     TYPECCW FIXED(15);            /* VALUE DETERMINES IF CONSOLE
*                                      BELL OR POWER ALARM SHOULD BE
*                                      SOUNDED               @G51APSS*/
*   RFY                                                         02S1320
*    (REG00,                                                    02S1320
*     REG01,                                                    02S1320
*     REG10,                                                    02S1320
*     REG15) RSTD;                  /*                       @G51APSS*/
*   RFY                                                         02S1321
*     UCMLIST BASED(CONUCME);       /* BASE FOR UCME         @G51APSS*/
*   IF TYPECCW=BELL THEN            /* RING CONSOLES BELL?   @G51APSS*/
         L     @14,@PC00016                                     02S1322
         ICM   @11,3,TYPECCW(@14)                               02S1322
         BNZ   @RF01322                                         02S1322
*     CONUCME=BELLCONS;             /* YES, GET UCME ADDR    @G51APSS*/
         L     CONUCME,BELLCONS                                 02S1323
*   ELSE                            /* NO                    @G51APSS*/
*     CONUCME=PWRCONS;              /* GET UCME ADDR OF CONSOLE WITH
*                                      POWER ALARM           @G51APSS*/
         B     @RC01322                                         02S1324
@RF01322 L     CONUCME,PWRCONS                                  02S1324
*   UCMBF='0'B;                     /* MARK NOT BUSY         @G51APSS*/
@RC01322 NI    UCMBF(CONUCME),B'11011111'                       02S1325
*   UCMDEVE='0'B;                   /* MARK I/O NOT COMPLETE @G51APSS*/
         NI    UCMDEVE(CONUCME),B'11110111'                     02S1326
*   REG10=UCMDCB;                   /* PICK UP PTR DCB/IOB/CCW'S
*                                                            @G51APSS*/
         L     REG10,UCMDCB(,CONUCME)                           02S1327
*   GEN REFS(REG10,REG12,IHADCB,DMICPA) SETS(REG15);            02S1328
*                                   /* SAVE CURRENT CCW      @G51APSS*/
         USING IHADCB,REG10        THE I/O WORKAREA IS IN A BAL MACRO
         L     REG15,DMICPA        GET PTR TO CURRENT CCW
*   CSAXE=REG15;                    /* SAVE PTR TO CURRENT CCW  02S1329
*                                                            @G51APSS*/
         ST    REG15,CSAXE(,CXSAPTR)                            02S1329
*   EXCPERR=NO;                     /* NO EXCP ERROR YET     @G51APSS*/
         NI    EXCPERR,B'11111011'                              02S1330
*   DO I=1 TO 3 WHILE(EXCPERR=NO);  /* RING ALARM 3 TIMES    @G51APSS*/
         LA    @14,1                                            02S1331
         ST    @14,I                                            02S1331
@DL01331 TM    EXCPERR,B'00000100'                              02S1331
         BNZ   @DC01331                                         02S1331
*     IF TYPECCW=POWER THEN         /* SOUND POWER ALARM?    @G51APSS*/
         L     @14,@PC00016                                     02S1332
         CLC   TYPECCW(2,@14),@CH00055                          02S1332
         BNE   @RF01332                                         02S1332
*       REG15=ADDR(RINGPOWA);       /* YES, GET POWER ALARM CCW ADDR
*                                                            @G51APSS*/
         LA    REG15,RINGPOWA                                   02S1333
*     ELSE                          /*                       @G51APSS*/
*       IF GRFSW='1'B THEN          /* 3270/3158/3036 SWITCH SET?
*                                                            @G51APSS*/
         B     @RC01332                                         02S1334
@RF01332 TM    GRFSW,B'00000100'                                02S1334
         BNO   @RF01334                                         02S1334
*         REG15=ADDR(RING3270);     /* YES, GET CCW ADDR     @G51APSS*/
         LA    REG15,RING3270                                   02S1335
*       ELSE                        /*                       @G51APSS*/
*         REG15=ADDR(RING1052);     /* NO, GET X'0B' ALARM CCW ADDR
*                                                            @G51APSS*/
         B     @RC01334                                         02S1336
@RF01334 LA    REG15,RING1052                                   02S1336
*     UCMECB=ZERO;                  /* CLEAR I/O ECB         @G51APSS*/
@RC01334 DS    0H                                               02S1337
@RC01332 SLR   @14,@14                                          02S1337
         ST    @14,UCMECB(,CONUCME)                             02S1337
*     IF UCBNRY='1'B THEN           /* IS DEVICE NOT READY?  @ZA18885*/
         L     @14,UCBPTR(,CONUCME)                             02S1338
         TM    UCBNRY(@14),B'01000000'                          02S1338
         BNO   @RF01338                                         02S1338
*       EXCPERR=YES;                /* YES, DON'T ISSUE EXCP @ZA18885*/
         OI    EXCPERR,B'00000100'                              02S1339
*     ELSE                          /* NO, DEVICE IS READY   @ZA18885*/
*       DO;                         /*                       @G51APSS*/
         B     @RC01338                                         02S1340
@RF01338 DS    0H                                               02S1341
*         GEN REFS(REG10,REG15,DCBIOBAD,DMIOB,THREESEC) SETS(REG00,
*             REG01,DMICPA);                                    02S1341
*                                   /* ISSUE EXCP            @G51APSS*/
           L     REG01,DCBIOBAD    SET UP PTR TO IOB FOR EXCP  @ZA10759
           ST    REG15,DMICPA-DMIOB(REG01) STORE PTR TO ALARM CCW IN   X
                                           IOB                 @ZA10759
           EXCP  (1)                 SOUND ALARM
           STIMER WAIT,BINTVL=THREESEC WAIT FOR 3 SECONDS       YM02449
*         IF IOCOMP^=EXCPSUCC THEN  /* WAS EXCP SUCCESSFUL?  @G51APSS*/
         CLI   IOCOMP(CONUCME),X'7F'                            02S1342
         BE    @RF01342                                         02S1342
*           EXCPERR=YES;            /* NO, NO MORE EXCPS SHOULD BE
*                                      ISSUED                @G51APSS*/
         OI    EXCPERR,B'00000100'                              02S1343
*       END;                        /*                       @G51APSS*/
@RF01342 DS    0H                                               02S1345
*   END;                            /* OF DO LOOP TO SOUND ALARM 3
*                                      TIMES                 @G51APSS*/
@RC01338 LA    @14,1                                            02S1345
         AL    @14,I                                            02S1345
         ST    @14,I                                            02S1345
         CH    @14,@CH00089                                     02S1345
         BNH   @DL01331                                         02S1345
@DC01331 DS    0H                                               02S1346
*   UCMECB=ZERO;                    /* CLEAR I/O ECB         @G51APSS*/
         SLR   @14,@14                                          02S1346
         ST    @14,UCMECB(,CONUCME)                             02S1346
*   REG15=CSAXE;                    /* GET ORRIGINAL CCW PTR @G51APSS*/
         L     REG15,CSAXE(,CXSAPTR)                            02S1347
*   GEN REFS(REG10,REG15) SETS(DMICPA);                         02S1348
*                                      /*                    @G51APSS*/
         ST    REG15,DMICPA        RESTORE ORIGINAL CCW PTR IOB
         DROP  REG10               FREE BASE TO I/O WORK AREA  @G51APSS
*   RFY                                                         02S1349
*     UCMLIST BASED(UCMDVEPT);      /* RESTORE UCME BASE     @G51APSS*/
*   RFY                                                         02S1350
*    (REG00,                                                    02S1350
*     REG01,                                                    02S1350
*     REG10,                                                    02S1350
*     REG15) UNRSTD;                /*                       @G51APSS*/
*   END BELLEXCP;                                               02S1351
*                                                               02S1351
@EL00016 DS    0H                                               02S1351
@EF00016 DS    0H                                               02S1351
@ER00016 LM    @14,@12,@SA00016                                 02S1351
         BR    @14                                              02S1351
*/*** END OF BELLEXCP SUBROUTINE *************************************/
*                                                               02S1352
*                                                               02S1352
*/*** START OF HCSWITCH SEGMENT **************************************/
*/*                                                                  */
*/* HCSWITCH - SWITCHS THE HARDCOPY FUNCTION                         */
*/*                                                                  */
*/* FUNCTION - A SEARCH IS MADE FOR AN CONSOLE TO RECEIVE HARDCOPY   */
*/*            AND IF ONE IS FOUND, THE HARDCOPY FUNCTION IS SWITCHED*/
*/*            TO IT. MESSAGE IEE142I IS BUILT AND QUEUED TO THE     */
*/*            NEW HARDCOPY CONSOLE, AND CONTROL IS RETURNED TO THE  */
*/*            CALLER.  IF NO CONSOLE WAS FOUND, A SWITCH IS SET TO  */
*/*            CAUSE MESSAGE IEA964I (HARDCOPY SUSPENDED) TO BE      */
*/*            PRINTED IN WRAPUP.                                    */
*/*                                                                  */
*/* **NOTE**   HARDCOPY IS NEVER SWITCHED TO A GRAPHICS DEVICE.      */
*/*                                                                  */
*/* INPUT  -   CSACODE IS SET TO 'CSAHC' IF SWITCH FROM SYSLOG       */
*/*            NEWHC IS ZERO                                         */
*/*            OLDHC CONSTAINS ADDRESS OF FAILING CONSOLES UCME      */
*/*                                                                  */
*/* OUTPUT  -  UCMHCUCM CONTAINS UCME ADDR OF SELECTED CONSOLE       */
*/*            UCMDISPB IS ON IN UCME OF NEW HARDCOPY CONSOLE        */
*/*                                                                  */
*/********************************************************************/
*                                                               02S1352
*HCSWITCH:                                                      02S1352
*   PROC OPTIONS(SAVE(REG14));                                  02S1352
HCSWITCH ST    @14,@SA00017                                     02S1352
*   CALL FNDHCALT;                  /* SEARCH FOR A HARDCOPY CONSOLE */
         BAL   @14,FNDHCALT                                     02S1353
*   IF NEWHC^=0                     /* TEST WHETHER CONSOLE WAS FOUND*/
*     THEN                          /* IF CONSOLE FOUND, PROCESS     */
         LTR   NEWHC,NEWHC                                      02S1354
         BZ    @RF01354                                         02S1354
*     DO;                                                       02S1355
*       UCMHCUCM=NEWHC;             /* SET PTR TO HC CONSOLE IN UCM  */
         ST    NEWHC,UCMHCUCM(,UCMMCSPT)                        02S1356
*       NEWHC->UCMDISPB=YES;        /* MARK NEW CONSOLE AS HARDCOPY  */
         OI    UCMDISPB(NEWHC),B'01000000'                      02S1357
*       CALL HCMSG;                 /* BUILD AND QUEUE MSG IEE142I   */
         BAL   @14,HCMSG                                        02S1358
*       IF FAILO^=ZERO              /* WHAT IS HARDCOPY SWITCH FROM  */
*         THEN                      /* IF HARDCOPY SWITCH FOR CONSOLE*/
         L     @02,FAILO                                        02S1359
         SLR   @15,@15                                          02S1359
         CR    @02,@15                                          02S1359
         BE    @RF01359                                         02S1359
*         DO;                                                   02S1360
*           FAILO->UCMDISPB='0'B;   /* TURN OFF HC FLAG IN FAILING HC
*                                      CONSOLE'S UCME                */
         NI    UCMDISPB(@02),B'10111111'                        02S1361
*           IF CSAVCPU='0'B&CSAVCHAN='0'B/* VARY CPU OR CHANNEL?     */
*             THEN                                              02S1362
         TM    CSAVCPU(CXSAPTR),B'01100000'                     02S1362
         BNZ   @RF01362                                         02S1362
*             DO;                                               02S1363
*                                                               03S1364
*/*** START OF REQHCMSG SEGMENT **************************************/
*/*                                                                  */
*/* REQHCMSG - QUEUES MSGS SENT TO THE FAILING HC DEVICE, TO THE NEW */
*/*   HC DEVICE.  THE WQE AND NEW CQE ARE MARKED QUEUED FOR HC.      */
*/*                                                                  */
*/* INPUT - FAILO - PTR TO FAILING HC CONSOLE (OUTPUT HALF IF        */
*/*                 COMPOSITE)                                       */
*/*         NEWHC - PTR TO NEW HC CONSOLE (OUTPUT HALF IF COMPOSITE).*/
*/*                                                                  */
*/* OUTPUT - MESSAGES ARE QUEUED TO THE NEW HC CONSOLE.              */
*/*                                                                  */
*/********************************************************************/
*                                                               03S1364
*               IF FAILO->UCMOUTQ^=ZERO THEN/* IS THERE AN OUTPUT
*                                      QUEUE?                        */
         L     @02,UCMOUTQ(,@02)                                03S1364
         CR    @02,@15                                          03S1364
         BE    @RF01364                                         03S1364
*                 DO;               /* YES,                          */
*                   CQEPTR=FAILO->UCMOUTQ;/* INIT PTR TO 1ST CQE
*                                      BLOCK                         */
         ST    @02,CQEPTR                                       03S1366
*                   SW1='0'B;       /* INIT END-OF-Q SWITCH          */
         NI    SW1,B'01111111'                                  03S1367
*                   J=ONE;          /* INIT CQE ENTRY COUNTER        */
         MVC   J(4),@CF00055                                    03S1368
*                   GETCQEFL=NO;    /* INIT GET CQE FAILURE FLAG     */
*                                                               03S1369
         NI    GETCQEFL,B'11011111'                             03S1369
*                   /*************************************************/
*                   /*                                               */
*                   /* SEARCH THROUGH THE OUTPUT QUEUE OF THE FAILING*/
*                   /* CONSOLE FOR VALID CQE ENTRIES                 */
*                   /*                                               */
*                   /*************************************************/
*                                                               03S1370
*                   DO WHILE(SW1='0'B);                         03S1370
         B     @DE01370                                         03S1370
@DL01370 DS    0H                                               03S1371
*                     IF CQEENTR='1'B&CQEMAJOR='1'B THEN/* VALID
*                                      MLWTO ENTRY?                  */
         L     @02,CQEPTR                                       03S1371
         TM    CQEENTR(@02),B'00000101'                         03S1371
         BNO   @RF01371                                         03S1371
*                       DO;         /* YES,                          */
*                         UCMDVEPT=FAILO;/* SET UP UCME PTR. ML1 ALSO
*                                      USES CQEPTR.                  */
         L     UCMDVEPT,FAILO                                   03S1373
*                         CALL ML1; /* DETERMINE IF MLWTO CAN BE
*                                      QUEUED TO THE NEW HC CONSOLE.
*                                      IF NOT, ML1 TURNS OFF CQEENTR.*/
         BAL   @14,ML1                                          03S1374
*                       END;                                    03S1375
*                     IF CQEENTR='1'B THEN/* IS ENTRY STILL VALID    */
@RF01371 L     @02,CQEPTR                                       03S1376
         TM    CQEENTR(@02),B'00000001'                         03S1376
         BNO   @RF01376                                         03S1376
*                       DO;         /* YES                           */
*                                                               03S1377
*                         /*******************************************/
*                         /*                                         */
*                         /* BUILD A CQE ENTRY ON THE OUTPUT QUEUE OF*/
*                         /* THE NEW HARDCOPY CONSOLE.               */
*                         /*                                         */
*                         /*******************************************/
*                                                               03S1378
*                         IF J=ONE THEN/* IS A NEW CQE BLOCK NEEDED  */
         CLC   J(4),@CF00055                                    03S1378
         BNE   @RF01378                                         03S1378
*                           DO;     /* YES,                          */
*                             OUTQ=NEWHC;/* PLACE NEW BLOCK ON NEW HC
*                                      CONSOLE'S QUEUE               */
         ST    NEWHC,OUTQ                                       03S1380
*                             CONTROL=CQEPTR;/* SAVE CQE PTR. (GETCQE
*                                      USES IT)                      */
         ST    @02,CONTROL                                      03S1381
*                             CALL GETCQE;/* GET AND CHAIN A NEW CQE
*                                      BLOCK                         */
         BAL   @14,GETCQE                                       03S1382
*                             CQEPTR2=CQEPTR;/* MOVE PTR TO NEW CQE
*                                      BLOCK                         */
         MVC   CQEPTR2(4),CQEPTR                                03S1383
*                             CQEPTR=CONTROL;/* RESET CQEPTR TO OLD
*                                      CQE                           */
         MVC   CQEPTR(4),CONTROL                                03S1384
*                           END;                                03S1385
*                         IF GETCQEFL=NO THEN/* IF GETCQE DID NOT
*                                      FAIL                          */
@RF01378 TM    GETCQEFL,B'00100000'                             03S1386
         BNZ   @RF01386                                         03S1386
*                           DO;     /* OK - BLOCK WAS OBTAINED       */
*                             CQEPTR2->CQEWQE=CQEWQE;/* COPY CQE
*                                      ENTRY ON FAILING CONSOLE'S Q
*                                      TO NEW HC CONSOLE'S Q         */
         L     @02,CQEPTR2                                      03S1388
         L     @15,CQEPTR                                       03S1388
         MVC   CQEWQE(4,@02),CQEWQE(@15)                        03S1388
*                             CQEPTR2->CQEMLQHC='1'B;/* INDICATES Q'D
*                                      FOR HC                        */
         OI    CQEMLQHC(@02),B'00001000'                        03S1389
*                             CQEWQEA->WQEQDFHC='1'B;/* INDICATE Q'D
*                                      FOR HC IN WQE                 */
         SLR   @14,@14                                          03S1390
         ICM   @14,7,CQEWQEA(@15)                               03S1390
         OI    WQEQDFHC(@14),B'00010000'                        03S1390
*                             CQEWQEA->WQEUSE=CQEWQEA->WQEUSE+ONE;/*
*                                      INCREMENT USE COUNT           */
         LA    @15,1                                            03S1391
         SLR   @01,@01                                          03S1391
         IC    @01,WQEUSE(,@14)                                 03S1391
         ALR   @15,@01                                          03S1391
         STC   @15,WQEUSE(,@14)                                 03S1391
*                             IF(CQEPTR2->CQEMAJOR='1'B)&/* THIS A
*                                      MLWTO? AND            @ZA26850*/
*                                 (CQEWQEA->WMJMLTYD='0'B)&/* HAS NO
*                                      END LINE? AND         @ZA26850*/
*                                 (CQEWQEA->WMJMMIN^=ZERO) THEN/* HAS
*                                      MINORS?               @ZA26850*/
         TM    CQEMAJOR(@02),B'00000100'                        03S1392
         BNO   @RF01392                                         03S1392
         TM    WMJMLTYD(@14),B'00010000'                        03S1392
         BNZ   @RF01392                                         03S1392
         L     @02,WMJMMIN(,@14)                                03S1392
         LTR   @02,@02                                          03S1392
         BZ    @RF01392                                         03S1392
*                               DO; /* YES TO ALL OF ABOVE   @ZA26850*/
         ST    @02,@TF00001                                     03S1393
*                                 WMNPTR=CQEWQEA->WMJMMIN;/* 1ST
*                                      MINOR                 @ZA26850*/
*                                                               03S1394
         L     WMNPTR,@TF00001                                  03S1394
*                                 /***********************************/
*                                 /*                                 */
*                                 /* PROCESS ALL MINORS FOR THIS     */
*                                 /* MLTWO                   @ZA26850*/
*                                 /*                                 */
*                                 /***********************************/
*                                                               03S1395
*                                 DO WHILE(WMNPTR^=ZERO);/*  @ZA26850*/
         B     @DE01395                                         03S1395
@DL01395 DS    0H                                               03S1396
*                                   WMNPTR->WMNMUC1=WMNPTR->WMNMUC1+ONE
*                                       ;/* INCR USE CNT     @ZA26850*/
         LA    @15,1                                            03S1396
         SLR   @14,@14                                          03S1396
         IC    @14,WMNMUC1(,WMNPTR)                             03S1396
         ALR   @15,@14                                          03S1396
         STC   @15,WMNMUC1(,WMNPTR)                             03S1396
*                                   WMNPTR=WMNPTR->WMNMNX1;/* PTR TO
*                                      NEXR MINOR            @ZA26850*/
         SLR   @15,@15                                          03S1397
         ICM   @15,7,WMNMNX1(WMNPTR)                            03S1397
         LR    WMNPTR,@15                                       03S1397
*                                 END;/*                     @ZA26850*/
@DE01395 LTR   WMNPTR,WMNPTR                                    03S1398
         BNZ   @DL01395                                         03S1398
*                               END;/*                       @ZA26850*/
*                             CQEPTR2=CQEPTR2+LENGTH(CQEWQE);/* 03S1400
*                                      INCREMENT NEW CQE PTR TO ADDR
*                                      OF NEXT ENTRY                 */
@RF01392 LA    @02,4                                            03S1400
         L     @15,CQEPTR2                                      03S1400
         ALR   @15,@02                                          03S1400
         ST    @15,CQEPTR2                                      03S1400
*                             J=J+ONE;/* INCREMENT CQE ENTRY COUNTER */
         LA    @14,1                                            03S1401
         L     @01,J                                            03S1401
         ALR   @01,@14                                          03S1401
         ST    @01,J                                            03S1401
*                             IF J=SIX THEN/* IF POINTING AT EOB
*                                      ENTRY                         */
         CH    @01,@CH00033                                     03S1402
         BNE   @RF01402                                         03S1402
*                               DO;                             03S1403
*                                 EVAL(CQEPTR2-LENGTH(CQEWQE))->CQEEOQ=
*                                     '1'B;/* SET EOQ FLAG IN LAST
*                                      ENTRY USED                    */
         SLR   @15,@02                                          03S1404
         OI    CQEEOQ(@15),B'10000000'                          03S1404
*                                 J=ONE;/* NEW CQE BLOCK IS NEEDED   */
         ST    @14,J                                            03S1405
*                               END;                            03S1406
*                           END;                                03S1407
@RF01402 DS    0H                                               03S1408
*                       END;                                    03S1408
@RF01386 DS    0H                                               03S1409
*                     IF GETCQEFL=YES×CQEEOQ='1'B THEN/* IF GETCQE
*                                      FAILED OR THIS IS THE LAST CQE
*                                      ENTRY                         */
@RF01376 TM    GETCQEFL,B'00100000'                             03S1409
         BO    @RT01409                                         03S1409
         L     @02,CQEPTR                                       03S1409
         TM    CQEEOQ(@02),B'10000000'                          03S1409
         BNO   @RF01409                                         03S1409
@RT01409 DS    0H                                               03S1410
*                       SW1='1'B;   /* STOP CQE SEARCH               */
         OI    SW1,B'10000000'                                  03S1410
*                     ELSE                                      03S1411
*                       DO;         /* ELSE KEEP GOING               */
         B     @RC01409                                         03S1411
@RF01409 DS    0H                                               03S1412
*                         CQEPTR=CQEPTR+LENGTH(CQEWQE);/* GET ADDR OF
*                                      NEXT CQE ENTRY                */
         LA    @02,4                                            03S1412
         AL    @02,CQEPTR                                       03S1412
         ST    @02,CQEPTR                                       03S1412
*                         IF CQEEOB=ONTWO THEN/* END-OF-BLOCK?       */
         TM    CQEEOB(@02),B'11000000'                          03S1413
         BNO   @RF01413                                         03S1413
*                           CQEPTR=CQEWQEA;/* GET PTR TO NEXT CQE
*                                      BLOCK                         */
         SLR   @15,@15                                          03S1414
         ICM   @15,7,CQEWQEA(@02)                               03S1414
         ST    @15,CQEPTR                                       03S1414
*                       END;                                    03S1415
@RF01413 DS    0H                                               03S1416
*                   END;            /* END OF CQE LOOP               */
@RC01409 DS    0H                                               03S1416
@DE01370 TM    SW1,B'10000000'                                  03S1416
         BZ    @DL01370                                         03S1416
*                   IF J^=ONE THEN  /* WAS LAST BLOCK FINISHED?      */
         CLC   J(4),@CF00055                                    03S1417
         BE    @RF01417                                         03S1417
*                     EVAL(CQEPTR2-LENGTH(CQEWQE))->CQEEOQ='1'B;/*
*                                      SET EOQ IN LAST ENTRY USED    */
         L     @11,CQEPTR2                                      03S1418
         SL    @11,@CF00065                                     03S1418
         OI    CQEEOQ(@11),B'10000000'                          03S1418
*                 END;                                          03S1419
*                                                               03S1419
*/*** END OF REQHCMSG SEGMENT ****************************************/
*                                                               03S1420
*             END;                                              02S1420
*         END;                                                  02S1421
*       ELSE                                                    02S1422
*         UCMSYSG='0'B;             /* TURN OFF HC IS SYSLOG FLAG    */
         B     @RC01359                                         02S1422
@RF01359 NI    UCMSYSG(UCMMCSPT),B'11111101'                    02S1422
*     END;                          /* END CONSOLE FOUND PROCESSING  */
*   ELSE                                                        02S1424
*     IF CSAVCPU='0'B&CSAVCHAN='0'B /* IF CONSOLE NOT FOUND, TEST FOR
*                                      VARY CPU OR CHANNEL CMD       */
*       THEN                        /* REQUEST NOT VARY CPU OR  02S1424
*                                      CHANNEL                       */
         B     @RC01354                                         02S1424
@RF01354 TM    CSAVCPU(CXSAPTR),B'01100000'                     02S1424
         BNZ   @RF01424                                         02S1424
*       DO;                                                     02S1425
*         UCMSYSG=NO;               /* TURN OFF HARDCOPY IS SYSLOG   */
         NI    UCMSYSG(UCMMCSPT),B'11111101'                    02S1426
*         UCMHCUCM=ZERO;            /* ZERO HARDCOPY CONSOLE ADDR    */
         SLR   @11,@11                                          02S1427
         ST    @11,UCMHCUCM(,UCMMCSPT)                          02S1427
*         IF FAILO^=ZERO THEN       /* WAS HARDCOPY A DEVICE?   02S1428
*                                                            @ZA27148*/
         L     @02,FAILO                                        02S1428
         CR    @02,@11                                          02S1428
         BE    @RF01428                                         02S1428
*           FAILO->UCMDISPB='0'B;   /* YES, TURN OFF HC FLAG IN 02S1429
*                                      FAILING HC CONSOLE'S UCME
*                                                            @ZA27148*/
         NI    UCMDISPB(@02),B'10111111'                        02S1429
*         HCSUSP=YES;               /* SET FLAG TO ISSUE MSG IEA964I */
@RF01428 OI    HCSUSP,B'10000000'                               02S1430
*       END;                                                    02S1431
*   END HCSWITCH;                                               02S1432
*                                                               02S1432
@EL00017 DS    0H                                               02S1432
@EF00017 DS    0H                                               02S1432
@ER00017 L     @14,@SA00017                                     02S1432
         BR    @14                                              02S1432
*/*** END OF HCSWITCH SUBROUTINE *************************************/
*                                                               02S1433
         EJECT
*                                                               02S1433
*/*** START OF FNDHCALT SUBROUTINE ***********************************/
*/*                                                                  */
*/* FNDHCALT - SEARCHS FOR A CONSOLE SUITABLE TO RECEIVE HARDCOPY    */
*/*                                                                  */
*/* FUNCTION - A SEARCH OF THE CONSOLES IS MADE TO FIND A CONSOLE    */
*/*            WHICH HAS THE FOLLOWING REQUIREMENTS:                 */
*/*              1.  PAPER OUTPUT (NON GRAPHICS)                     */
*/*              2.  ACTIVE AND NOT CLOSE PENDING                    */
*/*            THE SEARCH SEQUENCES ARE AS FOLLOWS:                  */
*/*              1.  FOR A HARDCOPY SWITCH FROM SYSLOG               */
*/*                 A.  MASTER CONSOLE, THEN MASTERS ALTERNATE       */
*/*                     CHAIN, THEN ALL CONSOLES SYSGENED.           */
*/*              2.  FOR A SWITCH OF HARDCOPY FROM FAILING MASTER    */
*/*                 A.  MASTERS ALTERNATE CHAIN, THEN ALL CONSOLES   */
*/*                     SYSGENED.                                    */
*/*              3.  FOR A HARDCOPY SWITCH FROM A FAILING SECONDARY  */
*/*                 A.  FAILING CONSOLES ALTERNATE CHAIN, THEN       */
*/*                     THE MASTER CONSOLE, THEN MASTERS ALTERNATE   */
*/*                     CHAIN, THEN ALL CONSOLES SYSGENED.           */
*/*                                                                  */
*/* CALLERS -  HCSWITCH AND VCPU                                     */
*/*                                                                  */
*/* INPUT  -   CSACODE  CONTAINS CODE INDICATE TYPE OF SWITCH        */
*/*            FAILI/FAILO CONTAIN PTRS TO FAILING CONSOLES UCMES IF */
*/*                        HARDCOPY WAS TO A CONSOLE.                */
*/*            UCMSYSD  IS 'ON' IF FAILING CONSOLE IS MASTER         */
*/*                                                                  */
*/* OUTPUT  -  NEWHC - CONTAINS THE UCME ADDRESS OF THE CONSOLE TO   */
*/*                    RECEIVE HARDCOPY OR ZERO (0) IF NO SUITABLE   */
*/*                    CONSOLE WAS FOUND.                            */
*/*                                                                  */
*/********************************************************************/
*                                                               02S1433
*FNDHCALT:                                                      02S1433
*   PROC;                                                       02S1433
FNDHCALT STM   @14,@10,@SA00018                                 02S1433
         ST    @12,@SA00018+52                                  02S1433
*   ALTFND=NO;                      /* INITIALIZE SW TO 'NOT FOUND'  */
         NI    ALTFND,B'11111110'                               02S1434
*   SW1=YES;                        /* SET DO WHILE LOOP CONTROL     */
         OI    SW1,B'10000000'                                  02S1435
*   CALL CLEARDVC;                  /* CLEAR DEVICE TESTED FLAGS     */
         BAL   @14,CLEARDVC                                     02S1436
*   RFY                                                         02S1437
*     UCMLIST BASED(NEWHC);         /* REBASE THE UCME FOR THIS SEG  */
*   IF CSAHC='1'B                   /* IS HARDCOPY SWITCH FROM SYSLOG*/
*     THEN                                                      02S1438
         TM    CSAHC(CXSAPTR),B'00000010'                       02S1438
         BNO   @RF01438                                         02S1438
*     NEWHC=UCMMCENT;               /* IF SYSLOG, START AT MASTER    */
         L     NEWHC,UCMMCENT(,UCMMCSPT)                        02S1439
*   ELSE                            /* IF NOT SYSLOG,                */
*     DO;                           /* START AT ALTERNATE OF FAILING */
         B     @RC01438                                         02S1440
@RF01438 DS    0H                                               02S1441
*       NEWHC=FAILI->UCMALTEN;      /* ALTERNATE OF FAILING CONSOLE  */
         L     @15,FAILI                                        02S1441
         L     NEWHC,UCMALTEN(,@15)                             02S1441
*       FAILI->UCMDEVCC=YES;        /* MARK FAILING AS TESTED        */
         OI    UCMDEVCC(@15),B'00100000'                        02S1442
*       FAILO->UCMDEVCC=YES;        /* OUTPUT HALF TESTED ALSO       */
         L     @01,FAILO                                        02S1443
         OI    UCMDEVCC(@01),B'00100000'                        02S1443
*     END;                                                      02S1444
*                                                               02S1444
*/********************************************************************/
*/*                                                                  */
*/*  NOW SEARCH FROM EITHER THE MASTER OR THE ALTERNATE OF THE       */
*/*  FAILING CONSOLE FOR A CONSOLE TO RECIEVE HARDCOPY. IF SEARCH    */
*/*  DID NOT BEGIN WITH MASTER A SECOND PASS IS MADE TO SEARCH THE   */
*/*  MASTER AND ITS ALTERNATE CHAIN.  THE SEARCH END WHEN A CONSOLE  */
*/*  IS FOUND, OR THE ALTERNATE CHAINS ARE EXAUSTED.                 */
*/*                                                                  */
*/********************************************************************/
*                                                               02S1445
*   DO I=ONE TO TWO BY ONE WHILE SW1=YES;/* OUTER SEARCH LOOP        */
@RC01438 LA    @15,1                                            02S1445
         ST    @15,I                                            02S1445
@DL01445 TM    SW1,B'10000000'                                  02S1445
         BNO   @DC01445                                         02S1445
*     DO WHILE NEWHC^=ZERO&ALTFND=NO;/* INNER SEARCH LOOP, TO SEARCH
*                                      ONE COMPLETE ALTERNATE CHAIN  */
         B     @DE01446                                         02S1446
@DL01446 DS    0H                                               02S1447
*       IF UCMDEVCC=NO              /* WAS THIS DEVICE TESTED        */
*         THEN                      /* IF NOT TESTED THEN TEST IT    */
         TM    UCMDEVCC(NEWHC),B'00100000'                      02S1447
         BNZ   @RF01447                                         02S1447
*         DO;                       /* DO IF CONSOLE NOT TESTED      */
*           UCMDEVCC=YES;           /* MARK CONSOLE AS TESTED        */
         OI    UCMDEVCC(NEWHC),B'00100000'                      02S1449
*           IF UCMUF='1'B           /* IS CONSOLE ACTIVE             */
*               &(UCMCF='0'B×CSAACR='1'B)/* AND NO CLOSE PENDING, OR
*                                      CLOSE PENDING AND ACR,        */
*               &UCMVHRSN='0'B      /* AND ITS PATH IS NOT AFFECTED. */
*             THEN                  /* IF SO, CONSOLE IS OK SO FAR.  */
         TM    UCMUF(NEWHC),B'00010000'                         02S1450
         BNO   @RF01450                                         02S1450
         TM    UCMCF(NEWHC),B'00010000'                         02S1450
         BZ    @GL00091                                         02S1450
         TM    CSAACR(CXSAPTR),B'00010000'                      02S1450
         BNO   @RF01450                                         02S1450
@GL00091 TM    UCMVHRSN(NEWHC),B'00000001'                      02S1450
         BNZ   @RF01450                                         02S1450
*             IF UCMOF='1'B         /* IS IT AN OUTPUT TYPE DEVICE   */
*               THEN                                            02S1451
         TM    UCMOF(NEWHC),B'10000000'                         02S1451
         BNO   @RF01451                                         02S1451
*               IF UCMDISPC='0'B    /* IF OUTPUT, IS IT NON-GRAPHIC  */
*                 THEN                                          02S1452
         TM    UCMDISPC(NEWHC),B'00100000'                      02S1452
         BNZ   @RF01452                                         02S1452
*                 ALTFND=YES;       /* IF NON-GRAPHIC, FOUND IT      */
         OI    ALTFND,B'00000001'                               02S1453
*               ELSE                                            02S1454
*                 NEWHC=UCMALTEN;   /* IF GRAPHIC GET NEXT           */
         B     @RC01452                                         02S1454
@RF01452 L     NEWHC,UCMALTEN(,NEWHC)                           02S1454
*             ELSE                  /* IF NOT AN OUTPUT CONSOLE      */
*               IF UCMCOMPC^=ZERO   /* IS IT INPUT HALF OF COMPOSIT  */
*                 THEN              /* IF COMPOSIT,                  */
         B     @RC01451                                         02S1455
@RF01451 L     @15,UCMCOMPC(,NEWHC)                             02S1455
         LTR   @15,@15                                          02S1455
         BZ    @RF01455                                         02S1455
*                 DO;               /* CHECK OUTPUT HALF             */
*                   NEWHC=UCMCOMPC; /* GET PTR TO OTHER HALF         */
         LR    NEWHC,@15                                        02S1457
*                   IF UCMDEVCC=NO  /* IS IT TESTED                  */
*                     THEN          /* IF OTHER HALF IS NOT TESTED   */
         TM    UCMDEVCC(NEWHC),B'00100000'                      02S1458
         BNZ   @RF01458                                         02S1458
*                     DO;           /* THEN TEST IT                  */
*                       UCMDEVCC=YES;/* MARK IT TESTED               */
         OI    UCMDEVCC(NEWHC),B'00100000'                      02S1460
*                       IF UCMDISPC='0'B/* IS IT NON-GRAPHIC         */
*                           &UCMVHRSN='0'B/* AND ITS PATH NOT   02S1461
*                                      AFFECTED.                     */
*                         THEN                                  02S1461
         TM    UCMDISPC(NEWHC),B'00100000'                      02S1461
         BNZ   @RF01461                                         02S1461
         TM    UCMVHRSN(NEWHC),B'00000001'                      02S1461
         BNZ   @RF01461                                         02S1461
*                         ALTFND=YES;/* IF SO, FOUND.                */
         OI    ALTFND,B'00000001'                               02S1462
*                       ELSE                                    02S1463
*                         NEWHC=UCMALTEN;/* PTR TO NEXT              */
         B     @RC01461                                         02S1463
@RF01461 L     NEWHC,UCMALTEN(,NEWHC)                           02S1463
*                     END;          /* END DO OTHER HALF NOT TESTED  */
*                   ELSE                                        02S1465
*                     NEWHC=ZERO;   /* IF OTHER HALF TESTED END 02S1465
*                                      SEARCH THIS CHAIN             */
         B     @RC01458                                         02S1465
@RF01458 SLR   NEWHC,NEWHC                                      02S1465
*                 END;              /* END OF TESTING OTHER HALF     */
*               ELSE                                            02S1467
*                 NEWHC=UCMALTEN;   /* IF CLOSE PENDING OR NOT  02S1467
*                                      ACTIVE, GET NEXT              */
         B     @RC01455                                         02S1467
@RF01455 L     NEWHC,UCMALTEN(,NEWHC)                           02S1467
*           ELSE                                                02S1468
*             NEWHC=UCMALTEN;       /* CLOSE PENDING OR NOT ACTIVE   */
         B     @RC01450                                         02S1468
@RF01450 L     NEWHC,UCMALTEN(,NEWHC)                           02S1468
*         END;                      /* END DO IF ALTERNATE NOT TESTED*/
*       ELSE                                                    02S1470
*         NEWHC=ZERO;               /* IF NEXT IS TESTED, CHAIN END  */
         B     @RC01447                                         02S1470
@RF01447 SLR   NEWHC,NEWHC                                      02S1470
*     END;                          /* END OF INNER DO WHILE TO 02S1471
*                                      SEARCH ONE ALTERNATE CHAIN.   */
@RC01447 DS    0H                                               02S1471
@DE01446 LTR   NEWHC,NEWHC                                      02S1471
         BZ    @DC01446                                         02S1471
         TM    ALTFND,B'00000001'                               02S1471
         BZ    @DL01446                                         02S1471
@DC01446 DS    0H                                               02S1472
*/*  DETERMINE IF SWITCH IS FROM FAILING SECONDARY. IF SO, 2ND PASS  */
*                                                               02S1472
*     IF UCMSYSD=NO&ALTFND=NO&CSAHC=NO THEN                     02S1472
         TM    UCMSYSD(UCMMCSPT),B'00010000'                    02S1472
         BNZ   @RF01472                                         02S1472
         TM    ALTFND,B'00000001'                               02S1472
         BNZ   @RF01472                                         02S1472
         TM    CSAHC(CXSAPTR),B'00000010'                       02S1472
         BNZ   @RF01472                                         02S1472
*       NEWHC=UCMMCENT;             /* SET FOR 2ND PASS USING MASTER */
         L     NEWHC,UCMMCENT(,UCMMCSPT)                        02S1473
*     ELSE                                                      02S1474
*       SW1=NO;                     /* IF NOT SECONDARY SKIP 2ND PASS*/
         B     @RC01472                                         02S1474
@RF01472 NI    SW1,B'01111111'                                  02S1474
*   END;                            /* END OUTER DO WHILE SEARCH LOOP*/
@RC01472 LA    @15,1                                            02S1475
         AL    @15,I                                            02S1475
         ST    @15,I                                            02S1475
         CH    @15,@CH00063                                     02S1475
         BNH   @DL01445                                         02S1475
@DC01445 DS    0H                                               02S1476
*/********************************************************************/
*/*                                                                  */
*/*  THE FOLLOWING DO GROUP WILL BE EXECUTED TO SEARCH ALL CONSOLES  */
*/*  THAT WERE SYSGENED INTO THE SYSTEM IF NO ALTERNATE WAS FOUND    */
*/*  IN THE PREVIOUS SEARCHS.                                        */
*/*                                                                  */
*/********************************************************************/
*                                                               02S1476
*   DO CONTROL=UCMVEA TO UCMVEL BY UCMVEZ WHILE ALTFND=NO;      02S1476
         L     @15,UCMVEA(,UCMBASPT)                            02S1476
         B     @DE01476                                         02S1476
@DL01476 TM    ALTFND,B'00000001'                               02S1476
         BNZ   @DC01476                                         02S1476
*     NEWHC=CONTROL;                /* INITIALIZE NEW UCME PTR       */
         LR    NEWHC,@15                                        02S1477
*     IF UCMDEVCC='0'B              /* IF THIS CONSOLE NOT TESTED    */
*         &UCMUF='1'B               /* AND THE CONSOLE IS ACTIVE     */
*         &(UCMCF='0'B×CSAACR='1'B) /* AND NOT CLOSE PENDING OR CLOSE
*                                      PENDING WITH ACR IN PROCESS   */
*         &UCMOF='1'B               /* AND IT IS AN OUTPUT CONSOLE   */
*         &UCMDISPC='0'B            /* AND IT IS A NON-GRAPHICS      */
*         &UCMVHRSN='0'B            /* AND ITS PATH IS NOT AFFECTED  */
*       THEN                                                    02S1478
         TM    UCMDEVCC(NEWHC),B'00100000'                      02S1478
         BNZ   @RF01478                                         02S1478
         TM    UCMUF(NEWHC),B'00010000'                         02S1478
         BNO   @RF01478                                         02S1478
         TM    UCMCF(NEWHC),B'00010000'                         02S1478
         BZ    @GL00100                                         02S1478
         TM    CSAACR(CXSAPTR),B'00010000'                      02S1478
         BNO   @RF01478                                         02S1478
@GL00100 TM    UCMOF(NEWHC),B'10000000'                         02S1478
         BNO   @RF01478                                         02S1478
         TM    UCMDISPC(NEWHC),B'00100000'                      02S1478
         BNZ   @RF01478                                         02S1478
         TM    UCMVHRSN(NEWHC),B'00000001'                      02S1478
         BNZ   @RF01478                                         02S1478
*       ALTFND=YES;                 /* ALTERNATE CONSOLE IS FOUND    */
         OI    ALTFND,B'00000001'                               02S1479
*     ELSE                                                      02S1480
*       NEWHC=ZERO;                 /* OTHERWISE NOT FOUND YET       */
         B     @RC01478                                         02S1480
@RF01478 SLR   NEWHC,NEWHC                                      02S1480
*   END;                                                        02S1481
@RC01478 L     @15,CONTROL                                      02S1481
         AL    @15,UCMVEZ(,UCMBASPT)                            02S1481
@DE01476 ST    @15,CONTROL                                      02S1481
         C     @15,UCMVEL(,UCMBASPT)                            02S1481
         BNH   @DL01476                                         02S1481
@DC01476 DS    0H                                               02S1482
*   CALL CLEARDVC;                  /* GO CLEAR DEVICE TESTED FLAGS  */
         BAL   @14,CLEARDVC                                     02S1482
*   IF NEWHC^=ZERO                  /* IF A HARDCOPY CONSOLE WAS
*                                      FOUND                         */
*     THEN                                                      02S1483
         LTR   NEWHC,NEWHC                                      02S1483
         BZ    @RF01483                                         02S1483
*     IF UCMCF='1'B                 /* AND IF IT HAS A CLOSE PENDING */
*       THEN                                                    02S1484
         TM    UCMCF(NEWHC),B'00010000'                         02S1484
         BNO   @RF01484                                         02S1484
*       DO;                         /* RECLAIM CONSOLE FOR ACR       */
*         UCMCF='0'B;               /* TURN OFF CLOSE PENDING        */
         NI    UCMCF(NEWHC),B'11101111'                         02S1486
*         UCBCHGSX='0'B;            /* STOP CHANGE TO OFFLINE        */
*         UCBDADIX='0'B;            /* STOP CHANGE FROM CONSOLE      */
         L     @01,UCBPTR(,NEWHC)                               02S1488
         L     @15,UCBDADIX-3(,@01)                             02S1488
@GL00104 LR    @14,@15                                          02S1488
         N     @14,@CF03977                                     02S1488
         CS    @15,@14,UCBDADIX-3(@01)                          02S1488
         BNE   @GL00104                                         02S1488
*       END;                                                    02S1489
*   RFY                                                         02S1490
*     UCMLIST BASED(UCMDVEPT);      /* RESTORE UCME BASE             */
*   END FNDHCALT;                                               02S1491
*                                                               02S1491
@EL00018 DS    0H                                               02S1491
@EF00018 DS    0H                                               02S1491
@ER00018 LM    @14,@10,@SA00018                                 02S1491
         L     @12,@SA00018+52                                  02S1491
         BR    @14                                              02S1491
*/*** END OF FNDHCALT SUBROUTINE *************************************/
*                                                               02S1492
         EJECT
*                                                               02S1492
*/*** START OF HCMSG SEGMENT *****************************************/
*/*                                                                  */
*/* HCMSG  -   SUBROUTINE TO BUILD AND QUEUE MSG IEE142I.            */
*/*                                                                  */
*/* FUNCTION - OBTAIN A WQE, BUILD MESSAGE IEE142I IN THE WQE,       */
*/*            COMPLETE INITIALIZATION OF THE WQE, QUEUE THE NEW     */
*/*            WQE TO THE NEW HARDCOPY CONSOLE, AND RETURN TO THE    */
*/*            CALLER.  COMMON SUBROUTINES ARE USED TO GET THE WQE,  */
*/*            COMPLETE THE INITIALIZATION, AND QUEUE THE NEW WQE    */
*/*            TO ITS CONSOLE.                                       */
*/*                                                                  */
*/********************************************************************/
*                                                               02S1492
*HCMSG:                                                         02S1492
*   PROC OPTIONS(SAVE(REG14));                                  02S1492
HCMSG    ST    @14,@SA00019                                     02S1492
*   CALL GETWQE;                    /* OBTAINS A WQE                 */
         BAL   @14,GETWQE                                       02S1493
*   IF MSGPTR^=ONE                  /* WAS A WQE OBTAINED            */
*     THEN                          /* IF YES, PROCEED               */
         L     @02,MSGPTR                                       02S1494
         CH    @02,@CH00055                                     02S1494
         BE    @RF01494                                         02S1494
*     DO;                                                       02S1495
*       WQEPTR=MSGPTR;              /* BASE THE NEW WQE              */
         L     @15,MSGPTR                                       02S1496
         LR    WQEPTR,@15                                       02S1496
*       MSGPTR=ZERO;                /* CLEAR THE ANSWER AREA         */
         SLR   @15,@15                                          02S1497
         ST    @15,MSGPTR                                       02S1497
*       WQETXT=MSG142T;             /* MOVE MESSAGE TEXT TO WQE      */
         MVI   WQETXT+36(WQEPTR),C' '                           02S1498
         MVC   WQETXT+37(91,WQEPTR),WQETXT+36(WQEPTR)           02S1498
         MVC   WQETXT(36,WQEPTR),@CC00123                       02S1498
*       M142DEV=NEWHC->UCMUCB->UCBNAME;/* MOVE DEVICE ADDR TO MSG    */
         L     @01,UCMUCB(,NEWHC)                               02S1499
         MVC   M142DEV(3,WQEPTR),UCBNAME(@01)                   02S1499
*       WQENBR=LENGTH(MSG142T);     /* TEXT LENGTH FOR MSG IEE142I   */
         MVC   WQENBR(4,WQEPTR),@CF00122                        02S1500
*       WQEUCMID=NEWHC->UCMID;      /* CONSOLE ID FOR QUEUEING MSG   */
         MVC   WQEUCMID(1,WQEPTR),UCMID(NEWHC)                  02S1501
*/********************************************************************/
*/*                                                                  */
*/*  CALL THE WQE BUILD ROUTINE TO INITIALIZE THE REMAINING FIELDS   */
*/*  IN THE WQE.                                                     */
*/*                                                                  */
*/********************************************************************/
*                                                               02S1502
*       CALL BUILDWQE;              /* GO TO SUBROUTINE FOR WQE'S    */
*                                                               02S1502
         BAL   @14,BUILDWQE                                     02S1502
*       /*************************************************************/
*       /*                                                           */
*       /* INFORM SUBSYSTEM OF MESSAGE IEE142I THEN TURN ON OUTPUT   */
*       /* PENDING(UCMSYSJ) AND POSTREQ SWITCH SO AN XMPOST WILL BE  */
*       /* DONE IN WRAPUP TO UCMOECB. THIS ACTION WILL CAUSE THE WQE */
*       /* TO BE QUEUED TO THE APPROPRIATE CONSOLES SINCE THE WQE WAS*/
*       /* PUT ON THE WQE QUEUE ANCHORED FROM THE UCM BASE (UCMWQEND)*/
*       /* IN ROUTINE GETWQE.                                @ZA18877*/
*       /*                                                           */
*       /*************************************************************/
*                                                               02S1503
*       CALL SUBEXIT;               /* INFORM SUBSYSTEM OF MSG  02S1503
*                                      IEE142I               @ZA18877*/
         BAL   @14,SUBEXIT                                      02S1503
*       POSTREQ='1'B;               /* XMPOST REQUIRED TO INSURE WQE
*                                      QUEUING               @ZA18877*/
         OI    POSTREQ,B'00000010'                              02S1504
*       UCMSYSJ='1'B;               /* SET OUTPUT PENDING    @ZA18877*/
         OI    UCMSYSJ(UCMMCSPT),B'01000000'                    02S1505
*     END;                          /* END OF WQE OBTAINED PROCESSING*/
*   END HCMSG;                                                  02S1507
*                                                               02S1507
@EL00019 DS    0H                                               02S1507
@EF00019 DS    0H                                               02S1507
@ER00019 L     @14,@SA00019                                     02S1507
         BR    @14                                              02S1507
*/*** END OF HCMSG SEGMENT *******************************************/
*                                                               02S1508
         EJECT
*                                                               02S1508
*/*** START OF SWFULCAP SUBROUTINE ***********************************/
*/*                                                                  */
*/* SWFULCAP - MAKE A OUTPUT-ONLY CRT A FULL I/O CONSOLE             */
*/*                                                                  */
*/* INPUT - NEWI = ADDR OF OUTPUT-ONLY CRT                           */
*/*                                                                  */
*/* OUTPUT - UCMDISPE = ON FULL CAPABILITY                           */
*/*          UCMDISPD = OFF  OUTPUT ONLY                             */
*/*          UCMDISPF = OFF  MSG STREAM                              */
*/*          UCMDISPG = OFF  STATUS DISPLAY ONLY                     */
*/*          UCMDISPG = OFF  OUTPUT ONLY                             */
*/*          UCMIF = ON      ATTN SUPPORT                            */
*/*          DCMSTSWT = ON   CHANGING STATUS                         */
*/********************************************************************/
*                                                               02S1508
*SWFULCAP:                                                      02S1508
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                            02S1508
SWFULCAP DS    0H                                               02S1509
*   RESPECIFY                                                   02S1509
*     UCMLIST BASED(NEWI);          /* BASE UCME ON NEW CONSOLE ADDR */
*   UCMDISPE='1'B;                  /* FULL I/O CAPABILITY           */
*   UCMDISPD='0'B;                  /* NO LONGER OUTPUT ONLY         */
*   UCMDISPF='0'B;                  /* NO LONGER MSG STREAM ONLY     */
*   UCMDISPG='0'B;                  /* NO LONGER STATUS DISPLAY ONLY */
         OI    UCMDISPE(NEWI),B'00001000'                       02S1513
         NI    UCMDISPD(NEWI),B'11101001'                       02S1513
*   UCMSDS5G='0'B;                  /* I/O HARDWARE NO LONGER IN
*                                      OUTPUT                        */
         NI    UCMSDS5G(NEWI),B'11111101'                       02S1514
*   UCMIF='1'B;                     /* HAS ATTENTION SUPPORT         */
         OI    UCMIF(NEWI),B'01000000'                          02S1515
*   UCMXB->DCMSTSWT='1'B;           /* CHANGING STATUS FOR DIDOCS    */
         L     @11,UCMXB(,NEWI)                                 02S1516
         OI    DCMSTSWT(@11),B'10000000'                        02S1516
*   RESPECIFY                                                   02S1517
*     UCMLIST BASED(UCMDVEPT);      /* RETURN UCME BASE              */
*   END;                                                        02S1518
*                                                               02S1518
@EL00020 DS    0H                                               02S1518
@EF00020 DS    0H                                               02S1518
@ER00020 BR    @14                                              02S1518
*/*** END OF SWFULCAP SUBROUTINE *************************************/
*                                                               02S1519
         EJECT
*                                                               02S1519
*/*** START OF GETWQE SUBROUTINE *************************************/
*/*  GETWQE SEGMENT                                                  */
*/*                                                                  */
*/*  FUNCTION: THIS ROUTINE WILL GET CORE FOR A WQE.                 */
*/*     THE OBTAINED CORE WILL BE ZEROED OUT.                        */
*/*                                                                  */
*/*  INPUT: NONE                                                     */
*/*                                                                  */
*/*  OUTPUT: A BLOCK OF THE PROPER SIZE AND ZEROED IS RETURNED TO THE*/
*/*     CALLER IN MSGPTR.                                            */
*/*     IF THE GETCELL WAS UNSUCCESSFUL THEN THE ADDR PTR IS SET TO  */
*/*     ONE INSTEAD OF BEING THE ADDR OF THE NEW CELL.               */
*/*                                                                  */
*/********************************************************************/
*                                                               02S1519
*GETWQE:                                                        02S1519
*   PROC;                                                       02S1519
GETWQE   STM   @14,@12,@SA00021                                 02S1519
*   RFY                                                         02S1520
*    (REG00,                                                    02S1520
*     REG01,                                                    02S1520
*     REG04,                                                    02S1520
*     REG07,                                                    02S1520
*     REG15) RSTD;                                              02S1520
*   MSGPTR=ZERO;                    /* ZERO OUT ADDR SO IT CAN BE
*                                      USED TO INDICATE SUCCESS OR
*                                      FAILURE OF GETCELL.           */
         SLR   @14,@14                                          02S1521
         ST    @14,MSGPTR                                       02S1521
*   DO WHILE(MSGPTR=ZERO);          /* LOOP UNTILL ADDR GETS FILLED
*                                      IN.                           */
         B     @DE01522                                         02S1522
@DL01522 DS    0H                                               02S1523
*     REG00=UCMWQECP;               /* PICK UP WQE CELL POOL ID.     */
         L     REG00,UCMWQECP(,UCMBASPT)                        02S1523
*     GEN(GETCELL CPID=(0),BRANCH=YES)                          02S1524
*     REFS(REG00,CVTGETCL) SETS(REG01,REG15);                   02S1524
*                                                               02S1524
         GETCELL CPID=(0),BRANCH=YES
*/********************************************************************/
*/*                                                                  */
*/* SEE IF GETCELL WAS SUCCESSFUL                                    */
*/*                                                                  */
*/********************************************************************/
*                                                               02S1525
*     IF REG15=ZERO THEN            /* DID WE GET A CELL             */
         SLR   @14,@14                                          02S1525
         CR    REG15,@14                                        02S1525
         BNE   @RF01525                                         02S1525
*       DO;                                                     02S1526
*         MSGPTR=REG01;             /* SAVE ADDRESS TO WQE           */
*                                                               02S1527
         ST    REG01,MSGPTR                                     02S1527
*         /***********************************************************/
*         /*                                                         */
*         /* ZERO OUT THE CONTROL BLOCK                              */
*         /*                                                         */
*         /***********************************************************/
*                                                               02S1528
*         REG01->BITZERO(1:LENGTH(WQE)*EIGHT)=''B;              02S1528
         XC    BITZERO(192,REG01),BITZERO(REG01)                02S1528
*         UCMWQNR=UCMWQNR+ONE;      /* INCREMENT WQE COUNT           */
         LA    @11,1                                            02S1529
         AH    @11,UCMWQNR(,UCMBASPT)                           02S1529
         STH   @11,UCMWQNR(,UCMBASPT)                           02S1529
*/*  QUEUE THE NEW WQE INTO THE SYSTEM WQE QUEUE.                    */
*                                                               02S1530
*         IF UCMWQEND=ZERO          /* IF THE WQE CHAIN IS EMPTY     */
*           THEN                                                02S1530
         C     @14,UCMWQEND(,UCMBASPT)                          02S1530
         BNE   @RF01530                                         02S1530
*           UCMWQEND=ADDR(UCMWTOQ); /* PTR TO LAST PTS TO HEAD       */
         LA    @14,UCMWTOQ(,UCMBASPT)                           02S1531
         ST    @14,UCMWQEND(,UCMBASPT)                          02S1531
*         UCMWQEND->WQELKPA=MSGPTR; /* POINT LAST WQE AT NEW ONE     */
@RF01530 L     @14,MSGPTR                                       02S1532
         L     @11,UCMWQEND(,UCMBASPT)                          02S1532
         STCM  @14,7,WQELKPA(@11)                               02S1532
*         UCMWQEND=MSGPTR;          /* POINT END OF CHAIN AT NEW WQE */
         ST    @14,UCMWQEND(,UCMBASPT)                          02S1533
*       END;                                                    02S1534
*                                                               02S1534
*/********************************************************************/
*/*                                                                  */
*/* WE DID NOT GET A CELL. CHECK IF WE ARE OUT OF CELLS. IF SO       */
*/* THEN GET AN EXTENSION.                                           */
*/*                                                                  */
*/********************************************************************/
*                                                               02S1535
*     ELSE                                                      02S1535
*       IF REG15=FOUR THEN          /* DO WE NEED TO EXTEND THE CELL
*                                      POOL                          */
         B     @RC01525                                         02S1535
@RF01525 CH    REG15,@CH00065                                   02S1535
         BNE   @RF01535                                         02S1535
*         DO;                       /* YES.                          */
*           REG04=CSAXC;            /* TCB ADDRESS FOR GETMAIN       */
         L     REG04,CSAXC(,CXSAPTR)                            02S1537
*           REG07=CSAXF;            /* ASCB ADDRESS FOR GETMAIN      */
         L     REG07,CSAXF(,CXSAPTR)                            02S1538
*           DO;                     /* GETMAIN (RC) LV(WQEPLSZ) 02S1539
*                                      SP(SUBPL231) BRANCH           */
*             RESPECIFY                                         02S1540
*              (GPR01F,                                         02S1540
*               GPR03F,                                         02S1540
*               GPR00F) RESTRICTED;                             02S1540
*             GPR01F=0;             /* REG 1 MUST BE ZERO            */
         SLR   GPR01F,GPR01F                                    02S1541
*             GPR03F=0;             /* RC-TYPE GETMAIN               */
         SLR   GPR03F,GPR03F                                    02S1542
*             GPR00F=WQEPLSZ;       /* LENGTH REQUESTED              */
         LH    GPR00F,@CH00085                                  02S1543
*             GPR03F=GPR03F×((SUBPL231)*256);/* SP IN BYTE 2         */
         O     GPR03F,@CF03911                                  02S1544
*             CALL CVTCRMN;         /* BRANCH ENTRY POINT            */
         L     @11,LCVTPTR                                      02S1545
         L     @15,CVTCRMN(,@11)                                02S1545
         BALR  @14,@15                                          02S1545
*             RESPECIFY                                         02S1546
*              (GPR01F,                                         02S1546
*               GPR03F,                                         02S1546
*               GPR00F) UNRESTRICTED;                           02S1546
*           END;                    /* GETMAIN (RC) LV(WQEPLSZ) 02S1547
*                                      SP(SUBPL231) BRANCH           */
*                                                               02S1547
*           /*********************************************************/
*           /*                                                       */
*           /* SEE IF GETMAIN WAS SUCCESSFUL. IF SO BUILD EXTENSION. */
*           /*                                                       */
*           /*********************************************************/
*                                                               02S1548
*           IF REG15=ZERO THEN      /* DID WE GET SPACE FOR THE 02S1548
*                                      EXTENSION                     */
         LTR   REG15,REG15                                      02S1548
         BNZ   @RF01548                                         02S1548
*             DO;                   /* YES, BUILD THE WQE EXTENSION  */
*               CPEXTSAV=REG01;     /* SAVE ADDRES OF WQE EXTENSION  */
         ST    REG01,CPEXTSAV                                   02S1550
*               REG00=UCMWQECP;     /* PICK UP THE WQE CELL POOL ID  */
         L     REG00,UCMWQECP(,UCMBASPT)                        02S1551
*               REG15=LENGTH(WQE);  /* GET SIZE OF CELL REQUIRED.    */
         LA    REG15,192                                        02S1552
*               GEN REFS(REG00,REG01,REG02,CVTBLDCP) SETS(REG15);
*                                                               02S1553
          BLDCPOOL CPID=(0),SP=231,CSIZE=(15),CPADDR=(1),BRANCH=YES,   *
               AUTODEL=YES,POOLSIZ=4,SERIAL=YES                @ZA20159
*/********************************************************************/
*/*                                                                  */
*/* CHECK IF EXTENSION WAS SUCCESSFUL. IF NOT SET ERROR FLAG ON      */
*/*                                                                  */
*/********************************************************************/
*                                                               02S1554
*               IF REG15^=ZERO THEN /* WAS EXTENSION UNSUCCESSFUL    */
         LTR   REG15,REG15                                      02S1554
         BZ    @RF01554                                         02S1554
*                 DO;               /* YES. INDICATE SO IN XVWQEAD   */
*                                                               02S1555
*                   /*************************************************/
*                   /*                                               */
*                   /* FREE THE WQE POOL EXTENSION.                  */
*                   /*                                               */
*                   /*************************************************/
*                                                               02S1556
*                   DO;             /* FREEMAIN(R) LV(WQEPLSZ)SP(SUBP
*                                      L231)A(CPEXTSAV) BRANCH       */
*                     RESPECIFY                                 02S1557
*                      (GPR01F,                                 02S1557
*                       GPR00F) RESTRICTED;                     02S1557
*                     GPR00F=WQEPLSZ;/* LENGTH REQUESTED             */
         LH    GPR00F,@CH00085                                  02S1558
*                     GPR01F=SUBPL231;/* SP IN REG 1                 */
         LA    GPR01F,231                                       02S1559
*                     GEN(SLL   GPR01F,24)                      02S1560
*                     NODEFS NOREFS NOSETS NOEXIT NOFLOWS SEQFLOW;
         SLL   GPR01F,24
*                     GPR00F=GPR00F×GPR01F;/* SP IN HI BYTE          */
         OR    GPR00F,GPR01F                                    02S1561
*                     GPR01F=ADDR(CPEXTSAV);/* SET REGISTER ONE      */
         LA    GPR01F,CPEXTSAV                                  02S1562
*                     CALL CVTRMBR; /* BRANCH ENTRY POINT            */
         L     @11,LCVTPTR                                      02S1563
         L     @15,CVTRMBR(,@11)                                02S1563
         BALR  @14,@15                                          02S1563
*                     RESPECIFY                                 02S1564
*                      (GPR01F,                                 02S1564
*                       GPR00F) UNRESTRICTED;                   02S1564
*                   END;            /* FREEMAIN(R) LV(WQEPLSZ)SP(SUBP
*                                      L231)A(CPEXTSAV) BRANCH       */
*                   MSGPTR=ONE;     /* INDICATE NO WQE OBTAINED.     */
         MVC   MSGPTR(4),@CF00055                               02S1566
*                 END;                                          02S1567
*             END;                                              02S1568
*                                                               02S1568
*           /*********************************************************/
*           /*                                                       */
*           /* THE GETMAIN WAS NOT SUCCESSFUL                        */
*           /*                                                       */
*           /*********************************************************/
*                                                               02S1569
*           ELSE                                                02S1569
*             MSGPTR=ONE;           /* INDICATE NO WQE OBTAINED TO
*                                      CALLER.                       */
         B     @RC01548                                         02S1569
@RF01548 MVC   MSGPTR(4),@CF00055                               02S1569
*         END;                      /* OF CHECK FOR EXTENSION NEEDED.*/
*/********************************************************************/
*/*                                                                  */
*/* THE ERROR WAS NOT DUE TO END OF EXTENSION. THE ERROR CAN NOT     */
*/* BE CORRECTED SO SET ERROR INDICATOR FOR CALLER.                  */
*/*                                                                  */
*/********************************************************************/
*                                                               02S1571
*       ELSE                                                    02S1571
*         MSGPTR=ONE;               /* INDICATE GET WQE UNSUCCESSFUL */
         B     @RC01535                                         02S1571
@RF01535 MVC   MSGPTR(4),@CF00055                               02S1571
*   END;                            /* OF DO WHILE LOOP              */
@RC01535 DS    0H                                               02S1572
@RC01525 DS    0H                                               02S1572
@DE01522 ICM   @14,15,MSGPTR                                    02S1572
         BZ    @DL01522                                         02S1572
*   RFY                                                         02S1573
*    (REG00,                                                    02S1573
*     REG01,                                                    02S1573
*     REG04,                                                    02S1573
*     REG07,                                                    02S1573
*     REG15) UNRSTD;                                            02S1573
*   END GETWQE;                                                 02S1574
*                                                               02S1574
@EL00021 DS    0H                                               02S1574
@EF00021 DS    0H                                               02S1574
@ER00021 LM    @14,@12,@SA00021                                 02S1574
         BR    @14                                              02S1574
*/*** END OF GETWQE SUBROUTINE ***************************************/
*                                                               02S1575
         EJECT
*                                                               02S1575
*/*** START OF BUILDWQE SEGMENT **************************************/
*/*                                                                  */
*/* BUILDWQE - INITIALIZES WQE'S CREATED BY IEAVSWCH                 */
*/*                                                                  */
*/* FUNCTION - FILLS IN THE MESSAGE HEADER, ISSUER INFO, AND ROUTING */
*/*            INFO FOR MESSAGES IEE142I AND IEE143I.                */
*/*                                                                  */
*/* INPUT  -   WQEPTR CONTAINS THE ADDRESS OF THE WQE TO BE BUILT.   */
*/*                                                                  */
*/* OUTPUT -   THE FOLLOWING FIELDS IN THE WQE ARE INITIALIZED:      */
*/*            WQERR, WQEPAD, WQETS, WQEPAD1, WQEJOBNM, WQEPAD2,     */
*/*            WQEAUTH, WQEBUFD, WQEASID, WQETCB, WQEJSTCB,          */
*/*            WQESEQN, WQEMCSFL, WQEROUTC, AND WQEDESC.             */
*/*                                                                  */
*/********************************************************************/
*                                                               02S1575
*BUILDWQE:                                                      02S1575
*   PROC OPTIONS(NOSAVEAREA,SAVE(REG14));                       02S1575
BUILDWQE ST    @14,12(,@13)                                     02S1575
*   WQERR=M142143C;                 /* PUT IN ROUTE CODES FOR HC     */
         MVC   WQERR(4,WQEPTR),@CC00106                         02S1576
*   WQEPAD=BLANK;                   /* MAKE SPACE                    */
         MVI   WQEPAD(WQEPTR),C' '                              02S1577
*   WQETS=FMTDTS;                   /* MOVE TIME STAMP TO MESSAGE    */
         MVC   WQETS(8,WQEPTR),FMTDTS                           02S1578
*   WQEPAD1=BLANK;                  /* MAKE SPACE                    */
         MVI   WQEPAD1(WQEPTR),C' '                             02S1579
*   WQEJOBNM=CTJOBNM;               /* USE JOB ID OF COMM TASK       */
         MVC   WQEJOBNM(8,WQEPTR),@CC00104                      02S1580
*   WQEPAD2=BLANK;                  /* MAKE A SPACE                  */
         MVI   WQEPAD2(WQEPTR),C' '                             02S1581
*   WQEAUTH=YES;                    /* AUTHORIZED USER               */
         OI    WQEAUTH(WQEPTR),B'00000001'                      02S1582
*   WQEBUFD='1'B;                   /* BUFFER OBTAINED DYN           */
         OI    WQEBUFD(WQEPTR),B'00010000'                      02S1583
*   WQEASID=UCMCTID;                /* USE ASID OF COMMTASK          */
         MVC   WQEASID(2,WQEPTR),UCMCTID(UCMBASPT)              02S1584
*   WQETCB=UCMPXA;                  /* CALLERS TCB IS COMM TASK'S    */
         L     @15,UCMPXA(,UCMBASPT)                            02S1585
         ST    @15,WQETCB(,WQEPTR)                              02S1585
*   WQEJSTCB=UCMPXA;                /* JOB STEP TCB IS COMM TASKS    */
         ST    @15,WQEJSTCB(,WQEPTR)                            02S1586
*   WQESEQN=UCMCMID;                /* MOVE IN NEXT MSG NUMBER       */
         L     @15,UCMCMID(,UCMMCSPT)                           02S1587
         STCM  @15,7,WQESEQN(WQEPTR)                            02S1587
*   UCMCMID=UCMCMID+ONE;            /* INCREMENT NEXT MSG NUMBER     */
         AL    @15,@CF00055                                     02S1588
         ST    @15,UCMCMID(,UCMMCSPT)                           02S1588
*   WQEMCSA='1'B;                   /* ROUTE AND DESC CODES EXIST    */
*   WQEMCSB='1'B;                   /* QUEUE BY CONSOLE ID           */
         OI    WQEMCSA(WQEPTR),B'11000000'                      02S1590
*   WQEROUTB='1'B;                  /* ROUTING CODE 2                */
         OI    WQEROUTB(WQEPTR),B'01000000'                     02S1591
*   WQEDCD='1'B;                    /* DESCRIPTOR CODE 4             */
         OI    WQEDCD(WQEPTR),B'00010000'                       02S1592
*   END BUILDWQE;                   /* RETURN TO CALLER              */
@EL00022 DS    0H                                               02S1593
@EF00022 DS    0H                                               02S1593
@ER00022 L     @14,12(,@13)                                     02S1593
         BR    @14                                              02S1593
*/*** END OF BUILDWQE SEGMENT ****************************************/
*                                                               02S1594
         EJECT
*                                                               02S1594
*/*** START OF SUBEXIT SUBROUTINE****************************@ZA18877*/
*/*                                                          @Y02668P*/
*/*   SUBEXIT - EXIT TO THE JOB ENTRY SUBSYSTEM              @Y02668P*/
*/*                                                                  */
*/*  FUNCTION - GETS SPACE FOR THE SSOB AND SSOBWT FROM      @ZA18877*/
*/*             SUBPOOL 231 WITH THE AUTOMATIC VARIABLES.    @ZA18877*/
*/*             CONTRL IS THEN PASSED TO THE SUBSYSTEM VIA   @ZA18877*/
*/*             THE IEFSSREQ MACRO.                          @ZA18877*/
*/*                                                          @Y02668P*/
*/********************************************************************/
*                                                               02S1594
*SUBEXIT:                                                       02S1594
*   PROC OPTIONS(SAVE);             /*                       @ZA18877*/
SUBEXIT  STM   @14,@12,@SA00023                                 02S1594
*   WQESUSP=YES;                    /* SUSPEND OPER OF WQE   @Y02668P*/
         OI    WQESUSP(WQEPTR),B'00000010'                      02S1595
*   CALL FRLOCKS;                   /* FREE LOCKS            @Y02668P*/
         BAL   @14,FRLOCKS                                      02S1596
*/********************************************************************/
*/*                                                          @Y02668P*/
*/*   SET UP THE SSOB                                        @Y02668P*/
*/*                                                          @Y02668P*/
*/********************************************************************/
*                                                               02S1597
*   SSOBID=NAMESSOB;                /* FILL IN THE ID FIELD  @Y02668P*/
         MVC   SSOBID(4),@CC00112                               02S1597
*   SSOBLEN=LENGTH(SSOB);           /* AND THE LENGTH FIELD  @Y02668P*/
         MVC   SSOBLEN(2),@CH00069                              02S1598
*   SSOBFUNC=SSOBWTO;               /* SPECIFY WTO EXIT TO THE  02S1599
*                                      SUBSYSTEM             @Y02668P*/
         MVC   SSOBFUNC(2),@CH00032                             02S1599
*   SSOBSSIB=ZERO;                  /* INDICATE SUBSYSTEM WHICH 02S1600
*                                      INITIATED THE USER.   @Y02668P*/
         SLR   @04,@04                                          02S1600
         ST    @04,SSOBSSIB                                     02S1600
*   SSOBINDV=ADDR(SSWT);            /* POINT AT WTO INTERFACE BLOCK
*                                                            @Y02668P*/
         LA    @03,SSWT                                         02S1601
         ST    @03,SSOBINDV                                     02S1601
*/********************************************************************/
*/*                                                          @Y02668P*/
*/*   NOW FILL IN THE SSWT BLOCK                             @Y02668P*/
*/*                                                          @Y02668P*/
*/********************************************************************/
*                                                               02S1602
*   SSWTLEN=LENGTH(SSWT);           /* PUT LENGTH OF SSWT INTO THE
*                                      SSWT                  @Y02668P*/
         MVC   SSWTLEN(2),@CH00071                              02S1602
*   SSWTWQE=WQEPTR;                 /* PUT IN THE ADDR OF THE WQE
*                                                            @Y02668P*/
         ST    WQEPTR,SSWTWQE                                   02S1603
*   SSWTORE=ZERO;                   /* NO, SET FIELD TO ZERO @Y02668P*/
         ST    @04,SSWTORE                                      02S1604
*   SSWTMIN=ZERO;                   /* THERE IS NO MINOR FOR A SINGLE
*                                      WTO                   @Y02668P*/
         ST    @04,SSWTMIN                                      02S1605
*   RFY                                                         02S1606
*    (REG04,                                                    02S1606
*     REG13,                                                    02S1606
*     REG15) RSTD;                  /*                       @G51APSS*/
*   REG04=REG13;                    /* SAVE SAVEAREA ADDR ACROSS
*                                      SUBYSSTEM EXIT        @Y02668P*/
         LR    REG04,REG13                                      02S1607
*   REG13=ADDR(SAV0SAVE);           /* ASSIGN NEW SAVEAREA FOR SUB
*                                      EXIT                  @Y02668P*/
         LA    REG13,SAV0SAVE                                   02S1608
*/*   ? IEFSSREQ  (SSOB);                                            */
*/*                                                                  */
*/*  PASS CONTROL TO JOB ENTRY SUBSYSTEM TO                          */
*/*  PROCESS REQUEST -                                               */
*/*                                                                  */
*/*    INPUT - REGISTER 1 POINTS TO A ONE-                           */
*/*            WORD PARAMETER LIST WHICH                             */
*/*            POINTS TO THE SSOB                                    */
*/*                                                                  */
*                                                               02S1609
*   CALL SSREQ(SSOB);               /* CALL ON THE SUBSYSTEM @Y02668P*/
         LA    @14,SSOB                                         02S1609
         ST    @14,@AL00001                                     02S1609
         MVI   @AL00001,X'80'                                   02S1609
         L     @03,LCVTPTR                                      02S1609
         L     @03,CVTJESCT(,@03)                               02S1609
         L     @15,JESSSREQ(,@03)                               02S1609
         LA    @01,@AL00001                                     02S1609
         BALR  @14,@15                                          02S1609
*   REG13=REG04;                    /* RESTORE SAVEAREA ADDR @Y02668P*/
         LR    REG13,REG04                                      02S1610
*/********************************************************************/
*/*                                                          @Y02668P*/
*/*   CHECK FOR A REQUEST TO DELETE MESSAGE BY SUBSYSTEM.    @Y02668P*/
*/*   CHECK FOR GOOD EXIT AND DELETION REQUEST.              @Y02668P*/
*/*                                                          @Y02668P*/
*/********************************************************************/
*                                                               02S1611
*   CALL GETLOCKS;                  /* GET ALL LOCKS         @G51APSS*/
         BAL   @14,GETLOCKS                                     02S1611
*   IF REG15=SSRTOK&                /* WAS EXIT SUCCESSFUL   @Y02668P*/
*       SSOBRETN=SSWTNDSP           /* AND IS DON'T DISPLAY     02S1612
*                                      REQUESTED.                    */
*     THEN                          /* YES                           */
         LTR   REG15,REG15                                      02S1612
         BNZ   @RF01612                                         02S1612
         CLC   SSOBRETN(4),@CF00065                             02S1612
         BNE   @RF01612                                         02S1612
*     DO;                           /* DELETE MESSAGE        @Y02668P*/
*       WQEBUFE=YES;                /* MARK WQE AS SERVICED  @Y02668P*/
         OI    WQEBUFE(WQEPTR),B'00001000'                      02S1614
*       UCMSYSI=YES;                /* IND. CLEAN UP IS NEEDED  02S1615
*                                                            @Y02668P*/
*                                                               02S1615
         OI    UCMSYSI(UCMMCSPT),B'10000000'                    02S1615
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK IF HARDCOPY IS TO BE BYPASSED               @Y02668P*/
*       /*                                                           */
*       /*************************************************************/
*                                                               02S1616
*       IF WQEMCSN=NO THEN          /* BYPASS HARDCOPY SET?  @Y02668P*/
         TM    WQEMCSN(WQEPTR),B'00000100'                      02S1616
         BNZ   @RF01616                                         02S1616
*         DO;                       /* NO,SEND MESSAGE TO HARDCOPY
*                                                            @Y02668P*/
*           WQEBUFC=YES;            /* IND. READY FOR HARDCOPY  02S1618
*                                                            @Y02668P*/
         OI    WQEBUFC(WQEPTR),B'00100000'                      02S1618
*           WQEQFHC=YES;            /* SEND MESSAGE TO HARDCOPY 02S1619
*                                                            @Y02668P*/
         OI    WQEQFHC(WQEPTR),B'01000000'                      02S1619
*         END;                      /* END IF BYPASS NOT SET @Y02668P*/
*       ELSE                        /* IF BYPASS IS SET      @Y02668P*/
*         DO;                       /* DO NOT HARDCOPY MESSAGE  02S1621
*                                                            @Y02668P*/
         B     @RC01616                                         02S1621
@RF01616 DS    0H                                               02S1622
*           WQEQFHC=NO;             /* TURN OFF HARDCOPY FLAG   02S1622
*                                                            @Y02668P*/
         NI    WQEQFHC(WQEPTR),B'10111111'                      02S1622
*         END;                      /* END IF BYPASS IS SET  @Y02668P*/
*     END;                          /* END IF DON'T DISPLAY SPEC
*                                                            @Y02668P*/
@RC01616 DS    0H                                               02S1625
*   RFY                                                         02S1625
*    (REG04,                                                    02S1625
*     REG13,                                                    02S1625
*     REG15) UNRSTD;                /*                       @G51APSS*/
@RF01612 DS    0H                                               02S1626
*   WQESUSP=NO;                     /* TURN OFF SUSPEND BIT  @Y02669P*/
         NI    WQESUSP(WQEPTR),B'11111101'                      02S1626
*   END SUBEXIT;                    /*                       @ZA18877*/
@EL00023 DS    0H                                               02S1627
@EF00023 DS    0H                                               02S1627
@ER00023 LM    @14,@12,@SA00023                                 02S1627
         BR    @14                                              02S1627
*/*** END OF SUBEXIT SUBROUTINE******************************@ZA18877*/
*                                                               02S1628
         EJECT
*                                                               02S1628
*/*** START OF GETCQE SUBROUTINE *************************************/
*/*                                                                  */
*/* GETCQE - GETS A NEW CQE BLOCK                                    */
*/*                                                                  */
*/* FUNCTION - DOES A BRANCH ENTRY TO GETMAIN FOR 24 BYTES OF        */
*/*    NON-FETCH-PROTECTED CSA.  ZEROS THE OBTAINED CORE.            */
*/*    INDICATES END-OF-BLOCK IN NEW CQE.  CHAINS CQE TO THE END     */
*/*    OF THE OUTPUT QUEUE OF THE UCME PASSED AS INPUT.              */
*/*                                                                  */
*/* INPUT - OUTQ = UCME ADDR OF CONSOLE TO GET NEW CQE BLOCK         */
*/*                                                                  */
*/* OUTPUT - CQEPTR = ADDR OF 1ST CQE ENTRY IN THE BLOCK             */
*/*          GETCQEFL = 0 IF NO CQE WAS OBTAINED, 1 OTHERWISE.       */
*/*                                                                  */
*/********************************************************************/
*                                                               02S1628
*GETCQE:                                                        02S1628
*   PROC OPTIONS(SAVE,NOSAVEAREA);                              02S1628
GETCQE   STM   @14,@12,12(@13)                                  02S1628
*   GETCQEFL=NO;                    /* INIT CQE OBTAINED FLAG        */
         NI    GETCQEFL,B'11011111'                             02S1629
*/*   GET BRANCH ENTRY TO GET 24 BYTES OF CSA FOR A NEW BLOCK        */
*                                                               02S1630
*   RFY                                                         02S1630
*    (REG04,                                                    02S1630
*     REG07,                                                    02S1630
*     REG15,                                                    02S1630
*     REG01) RSTD;                                              02S1630
*   REG04=CSAXC;                    /* TCB ADDR                      */
         L     REG04,CSAXC(,CXSAPTR)                            02S1631
*   REG07=CSAXF;                    /* ASCB ADDR                     */
         L     REG07,CSAXF(,CXSAPTR)                            02S1632
*   DO;                             /* GETMAIN (RC) LV(LENGTH(CQE))
*                                      SP(CQESP) BRANCH              */
*     RESPECIFY                                                 02S1634
*      (GPR01F,                                                 02S1634
*       GPR03F,                                                 02S1634
*       GPR00F) RESTRICTED;                                     02S1634
*     GPR01F=0;                     /* REG 1 MUST BE ZERO            */
         SLR   GPR01F,GPR01F                                    02S1635
*     GPR03F=0;                     /* RC-TYPE GETMAIN               */
         SLR   GPR03F,GPR03F                                    02S1636
*     GPR00F=LENGTH(CQE);           /* LENGTH REQUESTED              */
         LA    GPR00F,24                                        02S1637
*     GPR03F=GPR03F×((CQESP)*256);  /* SP IN BYTE 2                  */
         O     GPR03F,@CF03912                                  02S1638
*     CALL CVTCRMN;                 /* BRANCH ENTRY POINT            */
         L     @02,LCVTPTR                                      02S1639
         L     @15,CVTCRMN(,@02)                                02S1639
         BALR  @14,@15                                          02S1639
*     RESPECIFY                                                 02S1640
*      (GPR01F,                                                 02S1640
*       GPR03F,                                                 02S1640
*       GPR00F) UNRESTRICTED;                                   02S1640
*   END;                            /* GETMAIN (RC) LV(LENGTH(CQE))
*                                      SP(CQESP) BRANCH GET A CQE    */
*   IF REG15^=0 THEN                /* WAS GETMAIN SUCCESSFUL        */
         LTR   REG15,REG15                                      02S1642
         BZ    @RF01642                                         02S1642
*     GETCQEFL=YES;                 /* NO, SET FAILURE INDICATOR     */
         OI    GETCQEFL,B'00100000'                             02S1643
*   ELSE                            /* YES                           */
*     DO;                                                       02S1644
         B     @RC01642                                         02S1644
@RF01642 DS    0H                                               02S1645
*       CQEPTR=REG01;               /* SAVE PTR TO NEW CQE BLOCK     */
         ST    REG01,CQEPTR                                     02S1645
*       RFY                                                     02S1646
*        (REG04,                                                02S1646
*         REG07,                                                02S1646
*         REG15,                                                02S1646
*         REG01) UNRSTD;            /*                       @G51APSS*/
*       CQE=CQE&&CQE;               /* CLEAR CQE                     */
         L     @07,CQEPTR                                       02S1647
         XC    CQE(24,@07),CQE(@07)                             02S1647
*       EVAL(CQEPTR+TWENTY)->CQEEOB=ONTWO;/* SET END-OF-BLOCK FLAGS
*                                      IN LAST ENTRY                 */
         LA    @04,20                                           02S1648
         ALR   @04,@07                                          02S1648
         OI    CQEEOB(@04),B'11000000'                          02S1648
*       SW2='0'B;                   /* INIT END-OF-Q SWITCH          */
         NI    SW2,B'10111111'                                  02S1649
*       CQEBLK=OUTQ->UCMOUTQ;       /* GET PTR TO FIRST CQE BLOCK    */
         L     @04,OUTQ                                         02S1650
         L     @15,UCMOUTQ(,@04)                                02S1650
         ST    @15,CQEBLK                                       02S1650
*       CQEPTR2=CQEBLK;             /* GET PTR TO FIRST CQE ENTRY    */
         ST    @15,CQEPTR2                                      02S1651
*       IF CQEPTR2=0 THEN           /* IS THERE AN OUTPUT QUEUE      */
         LTR   @15,@15                                          02S1652
         BNZ   @RF01652                                         02S1652
*         OUTQ->UCMOUTQ=CQEPTR;     /* NO, NEW BLOCK IS 1ST ON QUEUE */
         ST    @07,UCMOUTQ(,@04)                                02S1653
*       ELSE                        /* THERE IS AN OUTPUT QUEUE      */
*         DO;                                                   02S1654
         B     @RC01652                                         02S1654
@RF01652 DS    0H                                               02S1655
*           RFY                                                 02S1655
*             CQE BASED(CQEPTR2);                               02S1655
*                                                               02S1655
*           /*********************************************************/
*           /*                                                       */
*           /* FIND END OF CONSOLE'S OUTPUT QUEUE                    */
*           /*                                                       */
*           /*********************************************************/
*                                                               02S1656
*           DO WHILE(SW2='0'B);                                 02S1656
         B     @DE01656                                         02S1656
@DL01656 DS    0H                                               02S1657
*             IF CQEEOQ='0'B THEN   /* END-OF-Q                      */
         L     @07,CQEPTR2                                      02S1657
         TM    CQEEOQ(@07),B'10000000'                          02S1657
         BNZ   @RF01657                                         02S1657
*               DO;                 /* NO                            */
*                 CQEPTR2=CQEPTR2+LENGTH(CQEWQE);/* GET NEXT CQE
*                                      ENTRY                         */
         AL    @07,@CF00065                                     02S1659
         ST    @07,CQEPTR2                                      02S1659
*                 IF CQEEOB=ONTWO THEN/* END-OF-BLOCK?               */
         TM    CQEEOB(@07),B'11000000'                          02S1660
         BNO   @RF01660                                         02S1660
*                   DO;             /* YES                           */
*                     CQEBLK=CQEWQEA;/* GET PTR TO NEXT CQE BLOCK    */
         SLR   @04,@04                                          02S1662
         ICM   @04,7,CQEWQEA(@07)                               02S1662
         ST    @04,CQEBLK                                       02S1662
*                     CQEPTR2=CQEBLK;/* GET PTR TO NEXT CQE ENTRY    */
         ST    @04,CQEPTR2                                      02S1663
*                   END;                                        02S1664
*               END;                                            02S1665
*             ELSE                                              02S1666
*               SW2='1'B;           /* INDICATE END-OF-Q FOUND       */
         B     @RC01657                                         02S1666
@RF01657 OI    SW2,B'01000000'                                  02S1666
*           END;                                                02S1667
*                                                               02S1667
@RC01657 DS    0H                                               02S1667
@DE01656 TM    SW2,B'01000000'                                  02S1667
         BZ    @DL01656                                         02S1667
*           /*********************************************************/
*           /*                                                       */
*           /* CQEBLK POINTS TO LAST CQE BLOCK. CQEPTR2 POINTS TO    */
*           /* LAST CQE ENTRY. ADD NEW BLOCK TO END OF OUTPUT QUEUE  */
*           /*                                                       */
*           /*********************************************************/
*                                                               02S1668
*           CQEEOQ='0'B;            /* TURN OFF END-OF-Q INDICATOR IN
*                                      LAST ENTRY OF NEW QUEUE       */
         L     @07,CQEPTR2                                      02S1668
         NI    CQEEOQ(@07),B'01111111'                          02S1668
*           EVAL(CQEBLK+TWENTY)->CQEWQE=CQEPTR;/* CHAIN NEW BLOCK TO
*                                      END OF QUEUE                  */
         L     @07,CQEBLK                                       02S1669
         LA    @04,20                                           02S1669
         LR    @15,@07                                          02S1669
         ALR   @15,@04                                          02S1669
         MVC   CQEWQE(4,@15),CQEPTR                             02S1669
*           EVAL(CQEBLK+TWENTY)->CQEEOB=ONTWO;/* RESET EOB INDICATOR */
         ALR   @07,@04                                          02S1670
         OI    CQEEOB(@07),B'11000000'                          02S1670
*           RFY                                                 02S1671
*             CQE BASED(CQEPTR);                                02S1671
*         END;                                                  02S1672
*     END;                                                      02S1673
*   END GETCQE;                                                 02S1674
*                                                               02S1674
@EL00024 DS    0H                                               02S1674
@EF00024 DS    0H                                               02S1674
@ER00024 LM    @14,@12,12(@13)                                  02S1674
         BR    @14                                              02S1674
*/*** END OF GETCQE SUBROUTINE ***************************************/
*                                                               02S1675
         EJECT
*                                                               02S1675
*/*** START OF ML1 SUBROUTINE ****************************************/
*/*                                                                  */
*/* ML1 - PROCESSING OF AN MLWTO                                     */
*/*                                                                  */
*/* FUNCTION - CLEARS MLWTO FLAGS IN THE UCME. CHECKS CURRENT        */
*/*    ENTRY FOR CURRENT BEING WRITTEN, UNENDED, OR STATUS DISPLAY.  */
*/*    IF SO, MARKS CQE ENTRY AS INVALID AND NO LONGER NEEDED.       */
*/*                                                                  */
*/* INPUT - UCMDVEPT = ADDR OF UCME                                  */
*/*         CQEPTR = ADDR OF CQE                                     */
*/*                                                                  */
*/* OUTPUT - UCMMLAST = 0 PTR TO LAST MINOR PROCESSED                */
*/*          UCMTC = 0 NO LONGER PROCESSING AN MLWTO                 */
*/*          CQEENTR = 0  IF ENTRY SHOULD NOT BE REQUEUED            */
*/*          CQEAVAIL = 1 IF ENTRY SHOULD NOT BE REQUEUED            */
*/*                                                                  */
*/********************************************************************/
*                                                               02S1675
*ML1:                                                           02S1675
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                            02S1675
ML1      DS    0H                                               02S1676
*   SW2='1'B;                       /* INIT PURGE NEEDED FLAG        */
         OI    SW2,B'01000000'                                  02S1676
*   UCMMLAST=ZERO;                  /* CLEAR PTR TO LAST MINOR  02S1677
*                                      WRITTEN                       */
         SLR   @04,@04                                          02S1677
         ST    @04,UCMMLAST(,UCMDVEPT)                          02S1677
*   UCMSDS5A='0'B;                  /* TURN OFF MLWTO NEEDED         */
*   UCMSDS5B='0'B;                  /* TURN OFF INLINE OUTPUT PENDING*/
*   UCMSDS5C='0'B;                  /* TURN OFF OUT-OF-LINE OUTPUT   */
*   UCMSDS5F='0'B;                  /* TURN OFF 'UCMMLAST VALID'     */
         NI    UCMSDS5A(UCMDVEPT),B'00011011'                   02S1681
*   UCMTC='0'B;                     /* CLEAR PROCESSING-MLWTO FLAG   */
         NI    UCMTC(UCMDVEPT),B'11111110'                      02S1682
*   CONTROL=CQEWQEA;                /* SET UP FOR COMPARE            */
         L     @04,CQEPTR                                       02S1683
         SLR   @15,@15                                          02S1683
         ICM   @15,7,CQEWQEA(@04)                               02S1683
         ST    @15,CONTROL                                      02S1683
*   IF UCMWLAST^=CONTROL THEN       /* IN PROCESS OF WRITING MLWTO ? */
         C     @15,UCMWLAST(,UCMDVEPT)                          02S1684
         BE    @RF01684                                         02S1684
*     DO;                           /* NO                            */
*       WMJPTR=CQEWQEA;             /* SET PTR TO MAJOR              */
         ST    @15,WMJPTR                                       02S1686
*       IF WMJMLTYD='0'B THEN       /* END IN MAJOR ?                */
         TM    WMJMLTYD(@15),B'00010000'                        02S1687
         BNZ   @RF01687                                         02S1687
*         IF WMJMMLWH='0'B THEN     /* NO, DUMMY MINOR ?             */
         TM    WMJMMLWH(@15),B'00000001'                        02S1688
         BNZ   @RF01688                                         02S1688
*           DO;                     /* NO, SEARCH MINOR CHAIN FOR END*/
*             WMNPTR=WMJMMIN;       /* GET PTR TO 1ST MAJOR          */
*                                                               02S1690
         L     WMNPTR,WMJMMIN(,@15)                             02S1690
*             /*******************************************************/
*             /*                                                     */
*             /* SEARCH FOR AN END INDICATOR IN THE MINOR CHAIN      */
*             /*                                                     */
*             /*******************************************************/
*                                                               02S1691
*             DO WHILE(WMNPTR^=ZERO);/* PROCESS WHOLE CHAIN          */
         B     @DE01691                                         02S1691
@DL01691 DS    0H                                               02S1692
*               IF WMNMLT1D='1'B THEN/* END INDICATOR ?              */
         TM    WMNMLT1D(WMNPTR),B'00010000'                     02S1692
         BNO   @RF01692                                         02S1692
*                 DO;               /* YES                           */
*                   SW2='0'B;       /* DON'T PURGE                   */
         NI    SW2,B'10111111'                                  02S1694
*                   WMNPTR=ZERO;    /* GET OUT OF LOOP               */
         SLR   WMNPTR,WMNPTR                                    02S1695
*                 END;                                          02S1696
*               ELSE                                            02S1697
*                 WMNPTR=WMNMNX1;   /* GET PTR TO NEXT MINOR         */
         B     @RC01692                                         02S1697
@RF01692 SLR   @04,@04                                          02S1697
         ICM   @04,7,WMNMNX1(WMNPTR)                            02S1697
         LR    WMNPTR,@04                                       02S1697
*             END;                                              02S1698
@RC01692 DS    0H                                               02S1698
@DE01691 LTR   WMNPTR,WMNPTR                                    02S1698
         BNZ   @DL01691                                         02S1698
*           END;                                                02S1699
*         ELSE                                                  02S1700
*           ;                                                   02S1700
@RF01688 DS    0H                                               02S1701
*       ELSE                                                    02S1701
*         SW2='0'B;                 /* DON'T PURGE                   */
         B     @RC01687                                         02S1701
@RF01687 NI    SW2,B'10111111'                                  02S1701
*     END;                                                      02S1702
@RC01687 DS    0H                                               02S1703
*   IF SW2='0'B THEN                /* END LINE FOUND                */
@RF01684 TM    SW2,B'01000000'                                  02S1703
         BNZ   @RF01703                                         02S1703
*     IF WMJMDECH='1'B&WMJMDECI='1'B THEN/* STATUS DISPLAY           */
         L     @04,WMJPTR                                       02S1704
         TM    WMJMDECH(@04),B'00000001'                        02S1704
         BNO   @RF01704                                         02S1704
         TM    WMJMDECI(@04),B'10000000'                        02S1704
         BNO   @RF01704                                         02S1704
*       SW2='1'B;                   /* YES, PURGE                    */
         OI    SW2,B'01000000'                                  02S1705
*   IF SW2='1'B THEN                /* PURGE ?                       */
@RF01704 DS    0H                                               02S1706
@RF01703 TM    SW2,B'01000000'                                  02S1706
         BNO   @RF01706                                         02S1706
*     DO;                           /* YES                           */
*       CQEAVAIL='1'B;              /* MARK ENTRY NO LONGER NEEDED   */
*       CQEENTR='0'B;               /* INDICATE ENTRY IS NO LONGER
*                                      VALID                         */
         L     @04,CQEPTR                                       02S1709
         OI    CQEAVAIL(@04),B'00000010'                        02S1709
         NI    CQEENTR(@04),B'11111110'                         02S1709
*     END;                                                      02S1710
*   END;                                                        02S1711
*                                                               02S1711
@EL00025 DS    0H                                               02S1711
@EF00025 DS    0H                                               02S1711
@ER00025 BR    @14                                              02S1711
*/*** END OF ML1 SUBROUTINE ******************************************/
*                                                               02S1712
         EJECT
*                                                               02S1712
*/*** START OF CLEARDVC SUBROUTINE ***********************************/
*/*                                                                  */
*/* CLEARDVC - CLEARS THE DEVICE TESTED BIT IN EVERY UCME            */
*/*                                                                  */
*/* INPUT - NONE                                                     */
*/*                                                                  */
*/* OUTPUT - UCMDEVCC=OFF IN EACH UCME                               */
*/*                                                                  */
*/********************************************************************/
*                                                               02S1712
*CLEARDVC:                                                      02S1712
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                            02S1712
CLEARDVC DS    0H                                               02S1713
*   DO UCMDVEPT=UCMVEA TO UCMVEL BY UCMVEZ;/* PROCESS ALL UCMES      */
         L     UCMDVEPT,UCMVEA(,UCMBASPT)                       02S1713
         B     @DE01713                                         02S1713
@DL01713 DS    0H                                               02S1714
*     UCMDEVCC='0'B;                /* TURN OFF DEVICE TESTED FLAG   */
         NI    UCMDEVCC(UCMDVEPT),B'11011111'                   02S1714
*   END;                                                        02S1715
         AL    UCMDVEPT,UCMVEZ(,UCMBASPT)                       02S1715
@DE01713 C     UCMDVEPT,UCMVEL(,UCMBASPT)                       02S1715
         BNH   @DL01713                                         02S1715
*   END;                                                        02S1716
*                                                               02S1716
@EL00026 DS    0H                                               02S1716
@EF00026 DS    0H                                               02S1716
@ER00026 BR    @14                                              02S1716
*/*** END OF CLEARDVC SUBROUTINE *************************************/
*                                                               02S1717
         EJECT
*                                                               02S1717
*/*** START OF GETLOCKS SEGMENT **************************************/
*/*                                                                  */
*/* GETLOCKS - IS A SUBROUTINE WHICH IS CALLED TO OBTAIN THE LOCAL   */
*/*            AND CMS GLOBAL LOCKS. A SETFRR IS ALSO ISSUED TO      */
*/*            PLACE SWITCH'S FRR ON THE STACK.                      */
*/*                                                                  */
*/* INPUT -    REG12 CONTAINS THE PTR TO CXSA                        */
*/*            NO GLOBAL LOCKS HIGHER THAN CMS CAN BE HELD           */
*/*                                                                  */
*/* OUTPUT -   ENVIRONMENT NOW INCLUDES LOCAL AND CMS LOCKS, FRR     */
*/*            FOR IEAVSWCH IS ON THE STACK, AND FIELD CSADCBP       */
*/*            CONTAINS A POINTER TO THE FRR WORK AREA (6 WORDS).    */
*/*                                                                  */
*/********************************************************************/
*                                                               02S1717
*GETLOCKS:                                                      02S1717
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                            02S1717
GETLOCKS DS    0H                                               02S1718
*   GENERATE CODE NODEFS REFS(PSA,PSALITA,FLC,UCMFRRAD,PSACSTK,FRRSCURR
*       ,FRRS,PARMLIST,SVC72ID,PSALSFCC,UCM,CSACTLM,FRRSLAST,FRRSELEN,
*       FRRSFRRA,FRRSPARM,FRRSENTR,CXSA) SETS(CSADCBP,LOCKSAVE,PARMID);
*  GENERATED BAL CODE TO ISSUE SETLOCK AND SETFRR
         SPACE 1
         STM   REG10,REG15,LOCKSAVE  SAVE 10 THRU 15 ACROSS MACROS
         LR    REG10,REG13         SAVE PTR TO REG SAVE AREA IN REG 10
         LR    REG15,REG12         SAVE BASE FOR CXSA
         SPACE 1
         SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                        *
               RELATED=(UCM,IEAVSWCH(FRLOCKS))
         SPACE 1
         SETLOCK OBTAIN,TYPE=CMS,MODE=UNCOND,                          *
               RELATED=(UCM,IEAVSWCH(FRLOCKS))
         SPACE 2
*  NOW SET FRR IN PLACE
         SPACE 1
         L     REG11,CSACTLM-CXSA(REG15)  GET PTR TO UCM BASE
         L     REG11,UCMFRRAD-UCM(REG11)   GET PTR TO COMMON FRR RTN
         SPACE 1
         SETFRR A,FRRAD=(11),PARMAD=(13),WRKREGS=(12,13),              *
               RELATED=(CMS-LOCK,IEAVSWCH(FRLOCKS))
         SPACE 1
         ST    REG13,CSADCBP-CXSA(REG15)  SAVE PTR TO FRR WORK AREA
         MVC   PARMID-PARMLIST(4,REG13),SVC72ID  MOVE IN RECOVERY ID
         LM    REG10,REG15,LOCKSAVE  RESTORE MODIFIED REGS
*   END GETLOCKS;                                               02S1719
*                                                               02S1719
@EL00027 DS    0H                                               02S1719
@EF00027 DS    0H                                               02S1719
@ER00027 BR    @14                                              02S1719
*/*** END OF GETLOCKS SEGMENT ****************************************/
*                                                               02S1720
         EJECT
*                                                               02S1720
*/*** START OF FRLOCKS SEGMENT ***************************************/
*/*                                                                  */
*/* FRLOCKS -  IS A SUBROUTINE WHICH IS CALLED TO RELEASE THE LOCAL  */
*/*            AND CMS LOCKS AND REMOVE THE FRR FROM THE STACK       */
*/*                                                                  */
*/* INPUT -    REG 12 POINTS TO CXSA                                 */
*/*            THE CMS AND GLOBAL LOCKS ARE HELD AND THE FRR FOR     */
*/*            IEAVSWCH IS HIGHEST ON THE STACK                      */
*/*                                                                  */
*/* OUTPUT -   ENVIRONMENT IS NOW UNLOCKED WITH NO FRR FOR THIS      */
*/*            MODULE ON THE STACK. FIELD CSADCBP CONTAINS 0.        */
*/*                                                                  */
*/********************************************************************/
*                                                               02S1720
*FRLOCKS:                                                       02S1720
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                            02S1720
FRLOCKS  DS    0H                                               02S1721
*   GENERATE CODE NODEFS REFS(PSA,PSACSTK,FRRS,FRRSCURR,FRRSEMP,
*       FRRSELEN,PSALSFCC,PSALITA,FLC,CXSA) SETS(CSADCBP,LOCKSAVE);
*  GENERATED BAL CODE TO ISSUE SETFRR AND SETLOCK
         SPACE 1
         STM   REG10,REG15,LOCKSAVE  SAVE 10 THRU 15 ACROSS MACROS
         LR    REG10,REG13         SAVE REG 13
         LR    REG15,REG12         SWITCH PTR TO CXSA
         SPACE 2
*  REMOVE FRR FROM THE STACK
         SPACE 1
         SETFRR D,WRKREGS=(12,13),                                     *
               RELATED=(CMS-LOCK,IEAVSWCH(GETLOCKS))
         SR    REG12,REG12         SET TO ZERO
         ST    REG12,CSADCBP-CXSA(REG15)  CLEAR FRR WORK AREA POINTER
         SPACE 2
*  FREE THE CMS GLOBAL LOCK
         SPACE 1
         SETLOCK RELEASE,TYPE=CMS,                                     *
               RELATED=(UCM,IEAVSWCH(GETLOCKS))
         SPACE 2
*  FREE THE LOCAL LOCK
         SPACE 1
         SETLOCK RELEASE,TYPE=LOCAL,                                   *
               RELATED=(UCM,IEAVSWCH(GETLOCKS))
         SPACE 1
         LM    REG10,REG15,LOCKSAVE  RESTORE MODIFIED REGS
*   END FRLOCKS;                                                02S1722
*                                                               02S1722
@EL00028 DS    0H                                               02S1722
@EF00028 DS    0H                                               02S1722
@ER00028 BR    @14                                              02S1722
*/*** END OF FRLOCKS SEGMENT *****************************************/
*                                                               02S1723
         EJECT
*                                                               02S1723
*/*** START OF ENQQ4 SUBROUTINE **************************************/
*/*                                                                  */
*/* ENQQ4  - ENQ ON SYSIEFSD Q4 EXCLUSIVELY. TRY FIVE TIMES  @G51APSS*/
*/*          FIVE SECONDS APART                              @G51APSS*/
*/*                                                                  */
*/* INPUT  - NONE                                            @G51APSS*/
*/*                                                                  */
*/* OUTPUT - HAVEQ4 = ON IF ENQ WAS SUCCESSFUL               @G51APSS*/
*/*                                                                  */
*/********************************************************************/
*                                                               02S1723
*ENQQ4:                                                         02S1723
*   PROC OPTIONS(SAVE);             /*                       @G51APSS*/
ENQQ4    STM   @14,@12,@SA00029                                 02S1723
*   CALL FRLOCKS;                   /* RELEASE THE LOCKS     @G51APSS*/
         BAL   @14,FRLOCKS                                      02S1724
*   HAVEQ4=NO;                      /* Q4 NOT OBTAINED YET   @G51APSS*/
         NI    HAVEQ4,B'11101111'                               02S1725
*   DO I=1 TO 5 WHILE HAVEQ4=NO;    /* LOOP 5 TIMES OR UNTIL Q4 IS
*                                      OBTAINED              @G51APSS*/
         LA    @07,1                                            02S1726
         ST    @07,I                                            02S1726
@DL01726 TM    HAVEQ4,B'00010000'                               02S1726
         BNZ   @DC01726                                         02S1726
*     RFY                                                       02S1727
*       REG15 RSTD;                 /*                       @G51APSS*/
*     DO;                           /* ENQ (MAJOR,MINOR,E,TWO,SYSTEM)
*                                      RET(USE)                      */
*       RESPECIFY                                               02S1729
*        (GPR01P) RESTRICTED;                                   02S1729
*       I056(1:16)=I056(1:16)&&I056(1:16);/* ZERO OUT THE TABLE      */
         XC    I056(16),I056                                    02S1730
*       I05604(1)=TWO;              /* LENGTH OF MINOR RESOURCE NAME */
         MVI   I05604,X'02'                                     02S1731
*       I05606(1)=ADDR(MAJOR);      /* ADDRESS OF MAJOR RESOURCE NAME*/
         LA    @14,@CC00108                                     02S1732
         ST    @14,I05606                                       02S1732
*       I05607(1)=ADDR(MINOR);      /* ADDRESS OF MINOR RESOURCE NAME*/
         LA    @14,@CC00110                                     02S1733
         ST    @14,I05607                                       02S1733
*       I05603(1)='01000000'B;      /* SET BIT STRING 1 FOR RESOURCE
*                                      ELEMENT                       */
         MVI   I05603,B'01000000'                               02S1734
*       I05605(1)='01000011'B;      /* SET BIT STRING 2 FOR RESOURCE
*                                      ELEMENT                       */
         MVI   I05605,B'01000011'                               02S1735
*       I05603(1,1)='1'B;           /* SET END OF LIST BIT           */
         OI    I05603,B'10000000'                               02S1736
*       GPR01P=ADDR(I05602);        /* LOAD LIST ADDRESS             */
         LA    GPR01P,I05602                                    02S1737
*       SVC(56);                    /* ISSUE ENQ SVC                 */
         SVC   56                                               02S1738
*       RESPECIFY                                               02S1739
*        (GPR01P) UNRESTRICTED;                                 02S1739
*     END;                          /* ENQ (MAJOR,MINOR,E,TWO,SYSTEM)
*                                      RET(USE) ENQ ON Q4    @G51APSS*/
*     IF REG15=ZERO THEN            /* Q4 OBTAINED?          @G51APSS*/
         LTR   REG15,REG15                                      02S1741
         BNZ   @RF01741                                         02S1741
*       HAVEQ4=YES;                 /* YES                   @G51APSS*/
         OI    HAVEQ4,B'00010000'                               02S1742
*     ELSE                          /* NO                    @G51APSS*/
*       IF I<5 THEN                 /* LAST TIME TO TRY ENQ? @G51APSS*/
         B     @RC01741                                         02S1743
@RF01741 L     @14,I                                            02S1743
         CH    @14,@CH00035                                     02S1743
         BNL   @RF01743                                         02S1743
*         DO;                       /* NO, WAIT 5 SEC        @G51APSS*/
*           GEN REFS(FIVESEC)(STIMER WAIT,BINTVL=FIVESEC);/* @G51APSS*/
         STIMER WAIT,BINTVL=FIVESEC
*         END;                      /*                       @G51APSS*/
*     RFY                                                       02S1747
*       REG15 UNRSTD;               /*                       @G51APSS*/
@RF01743 DS    0H                                               02S1747
@RC01741 DS    0H                                               02S1748
*   END;                            /* OF ENQ LOOP           @G51APSS*/
         LA    @07,1                                            02S1748
         AL    @07,I                                            02S1748
         ST    @07,I                                            02S1748
         CH    @07,@CH00035                                     02S1748
         BNH   @DL01726                                         02S1748
@DC01726 DS    0H                                               02S1749
*   CALL GETLOCKS;                  /* OBTAIN THE LOCKS      @G51APSS*/
         BAL   @14,GETLOCKS                                     02S1749
*   END ENQQ4;                      /*                       @G51APSS*/
@EL00029 DS    0H                                               02S1750
@EF00029 DS    0H                                               02S1750
@ER00029 LM    @14,@12,@SA00029                                 02S1750
         BR    @14                                              02S1750
*/*** END OF ENQQ4 SUBROUTINE ****************************************/
*                                                               02S1751
         EJECT
*                                                               02S1751
*/*** START OF DEQQ4 SUBROUTINE **************************************/
*/*                                                                  */
*/* DEQQ4  - DEQ FROM SYSIEFSD Q4 IF IT IS CURRENTLY HELD    @G51APSS*/
*/*                                                                  */
*/* INPUT  - HAVEQ4 = ON IF Q4 HAS BEEN OBTAINED             @G51APSS*/
*/*                                                                  */
*/* OUTPUT - HAVEQ4 = OFF                                    @G51APSS*/
*/*                                                                  */
*/********************************************************************/
*                                                               02S1751
*DEQQ4:                                                         02S1751
*   PROC OPTIONS(SAVE);             /*                       @G51APSS*/
DEQQ4    STM   @14,@12,@SA00030                                 02S1751
*   IF HAVEQ4=YES THEN              /* SHOULD Q4 BE DEQ'ED?  @G51APSS*/
         TM    HAVEQ4,B'00010000'                               02S1752
         BNO   @RF01752                                         02S1752
*     DO;                           /* YES                   @G51APSS*/
*       CALL FRLOCKS;               /* RELEASE THE LOCKS     @G51APSS*/
         BAL   @14,FRLOCKS                                      02S1754
*       DO;                         /* DEQ LS(1)                02S1755
*                                      (MAJOR,MINOR,TWO,SYSTEM)      */
*         I048(1:20)=I048(1:20)&&I048(1:20);                    02S1756
         XC    I048(20),I048                                    02S1756
*         RFY                                                   02S1757
*           GPR01F RESTRICTED;                                  02S1757
*         I04804(1)='11000000'B;    /* LISTEND BYTE                  */
         MVI   I04804,B'11000000'                               02S1758
*         I04805(1)=TWO;            /* SET LENGTH                    */
         MVI   I04805,X'02'                                     02S1759
*         I04806(1)='01000000'B;    /* OPTIONS                       */
         MVI   I04806,B'01000000'                               02S1760
*         I04807(1)=ADDR(MAJOR);    /* QNAME ADDRESS                 */
         LA    @07,@CC00108                                     02S1761
         ST    @07,I04807                                       02S1761
*         I04808(1)=ADDR(MINOR);    /* RNAME ADDRESS                 */
         LA    @07,@CC00110                                     02S1762
         ST    @07,I04808                                       02S1762
*         GPR01F=ADDR(I04802);                                  02S1763
         LA    GPR01F,I04802                                    02S1763
*         SVC(48);                                              02S1764
         SVC   48                                               02S1764
*         RFY                                                   02S1765
*           GPR01F UNRESTRICTED;                                02S1765
*       END;                        /* DEQ LS(1)                02S1766
*                                      (MAJOR,MINOR,TWO,SYSTEM) DEQ
*                                      Q4                    @G51APSS*/
*       HAVEQ4=NO;                  /* NO LONGER HAVE Q4     @G51APSS*/
         NI    HAVEQ4,B'11101111'                               02S1767
*       CALL GETLOCKS;              /* OBTAIN THE LOCKS      @G51APSS*/
         BAL   @14,GETLOCKS                                     02S1768
*     END;                          /*                       @G51APSS*/
*   END DEQQ4;                      /*                       @G51APSS*/
@EL00030 DS    0H                                               02S1770
@EF00030 DS    0H                                               02S1770
@ER00030 LM    @14,@12,@SA00030                                 02S1770
         BR    @14                                              02S1770
*/*** END OF DEQQ4 SUBROUTINE ****************************************/
*                                                               02S1771
*   DECLARE                         /* GENERAL PURPOSE REGISTERS     */
*     GPR00F FIXED(31) REG(0),                                  01S1771
*     GPR01F FIXED(31) REG(1),                                  01S1771
*     GPR03F FIXED(31) REG(3),                                  01S1771
*     GPR15F FIXED(31) REG(15),                                 01S1771
*     GPR00P PTR(31) REG(0),                                    01S1771
*     GPR01P PTR(31) REG(1);                                    01S1771
*   DCL                                                         01S1772
*     1 I056 DEF(ILIST) BDY(WORD) CHAR(32767),/* LIST FOR ENQ        */
*       3 I05601 PTR(31),           /* TCB OR ECB ADDRESS            */
*       3 I05602(*) CHAR(12) BDY(WORD),/* ARRAY OF RESOURCE ELEMENTS */
*         5 I05603 BIT(8),          /* BIT FLAGS 1                   */
*         5 I05604 PTR(8),          /* MINOR RESOURCE NAME LENGTH    */
*         5 I05605 BIT(8),          /* BIT FLAGS 2                   */
*         5 I05655 CHAR(1),         /* CONTROL PGM USE               */
*         5 I05606 PTR(31),         /* MAJOR RESOURCE NAME ADDR      */
*         5 I05607 PTR(31);         /* MINOR RESOURCE NAME ADDR      */
*   DCL                                                         01S1773
*     1 I048 DEF(ILIST) CHAR(32767) BDY(WORD),                  01S1773
*       3 I04801 PTR(31),           /* TCB ADDR                      */
*       3 I04802(*) CHAR(12) BDY(WORD),                         01S1773
*         5 I04803 PTR(31),         /* UCB @ IN LAST ENTRY           */
*           7 I04804 BIT(8),        /* FLAGS                         */
*           7 I04805 PTR(8),        /* MINOR RESOURCE NAME LENGTH    */
*           7 I04806 BIT(8),        /* FLAGS                         */
*           7 * CHAR(1),            /* CONTROL PROGRAM USE           */
*         5 I04807 PTR(31),         /* MAJOR RESOURCE NAME @         */
*         5 I04808 PTR(31);         /* MINOR RESOURCE NAME @         */
*   DCL                                                         01S1774
*     1 I002 DEF(ILIST),            /* DEFINE LIST                   */
*      2 I00201 PTR(31),            /* ECB ADDRESS                   */
*      2 I00202 PTR(31),            /* ASCB ADDRESS                  */
*      2 I00203 PTR(31);            /* ERRET ADDRESS                 */
*   DECLARE                                                     01S1775
*     ILIST CHAR(20) BDY(DWORD);    /* STANDARD LIST                 */
*   DECLARE                         /* COMMON VARIABLES              */
*     I256C CHAR(256) BASED,                                    01S1776
*     I031F FIXED(31) BASED,                                    01S1776
*     I031P PTR(31) BASED,                                      01S1776
*     I015F FIXED(15) BASED,                                    01S1776
*     I015P PTR(15) BASED,                                      01S1776
*     I008P PTR(8) BASED,                                       01S1776
*     I001C CHAR(1) BASED;                                      01S1776
*   END IEAVSWCH                                                01S1777
*                                                               01S1777
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSUT5  (PROLOGUE)                                       */
*/*%INCLUDE SYSUT5  (DECLARES)                                       */
*/*%INCLUDE SYSLIB  (IEFJSSOB)                                       */
*/*%INCLUDE SYSLIB  (IEFJESCT)                                       */
*/*%INCLUDE SYSLIB  (IHAASCB )                                       */
*/*%INCLUDE SYSLIB  (CVT     )                                       */
*/*%INCLUDE SYSLIB  (IHACTM  )                                       */
*/*%INCLUDE SYSLIB  (IEERDCM )                                       */
*/*%INCLUDE SYSLIB  (IHAFRRS )                                       */
*/*%INCLUDE SYSLIB  (IEZMPL  )                                       */
*/*%INCLUDE SYSLIB  (IHAORE  )                                       */
*/*%INCLUDE SYSLIB  (IHAPSA  )                                       */
*/*%INCLUDE SYSLIB  (IHARB   )                                       */
*/*%INCLUDE SYSLIB  (IKJRB   )                                       */
*/*%INCLUDE SYSLIB  (IHASCVT )                                       */
*/*%INCLUDE SYSLIB  (IKJTCB  )                                       */
*/*%INCLUDE SYSLIB  (IEFUCBOB)                                       */
*/*%INCLUDE SYSLIB  (IEECUCM )                                       */
*/*%INCLUDE SYSLIB  (IHAWQE  )                                       */
*/*%INCLUDE SYSUT5  (INITSEG )                                       */
*/*%INCLUDE SYSUT5  (CONSFAIL)                                       */
*/*%INCLUDE SYSUT5  (VMSCON  )                                       */
*/*%INCLUDE SYSUT5  (VCPU    )                                       */
*/*%INCLUDE SYSUT5  (VCPUMAST)                                       */
*/*%INCLUDE SYSUT5  (ACR     )                                       */
*/*%INCLUDE SYSUT5  (WRAPUP  )                                       */
*/*%INCLUDE SYSUT5  (EXTINNCC)                                       */
*/*%INCLUDE SYSUT5  (FINDALT )                                       */
*/*%INCLUDE SYSUT5  (SWCONS  )                                       */
*/*%INCLUDE SYSUT5  (OREREQU )                                       */
*/*%INCLUDE SYSUT5  (WQEREQU )                                       */
*/*%INCLUDE SYSUT5  (DUPSRCH )                                       */
*/*%INCLUDE SYSUT5  (MARKFAIL)                                       */
*/*%INCLUDE SYSUT5  (NOALTM  )                                       */
*/*%INCLUDE SYSUT5  (FNDALARM)                                       */
*/*%INCLUDE SYSUT5  (VERGRAF )                                       */
*/*%INCLUDE SYSUT5  (FNDPOWER)                                       */
*/*%INCLUDE SYSUT5  (SETOSW  )                                       */
*/*%INCLUDE SYSUT5  (STATMSG )                                       */
*/*%INCLUDE SYSUT5  (SOUNDBEL)                                       */
*/*%INCLUDE SYSUT5  (SOUNDPWR)                                       */
*/*%INCLUDE SYSUT5  (SAVEINDX)                                       */
*/*%INCLUDE SYSUT5  (SUBSWTCH)                                       */
*/*%INCLUDE SYSUT5  (CALLDSP )                                       */
*/*%INCLUDE SYSUT5  (BELLEXCP)                                       */
*/*%INCLUDE SYSUT5  (HCSWITCH)                                       */
*/*%INCLUDE SYSUT5  (REQHCMSG)                                       */
*/*%INCLUDE SYSUT5  (FNDHCALT)                                       */
*/*%INCLUDE SYSUT5  (HCMSG   )                                       */
*/*%INCLUDE SYSUT5  (SWFULCAP)                                       */
*/*%INCLUDE SYSUT5  (GETWQE  )                                       */
*/*%INCLUDE SYSUT5  (BUILDWQE)                                       */
*/*%INCLUDE SYSUT5  (SUBEXIT )                                       */
*/*%INCLUDE SYSUT5  (GETCQE  )                                       */
*/*%INCLUDE SYSUT5  (ML1     )                                       */
*/*%INCLUDE SYSUT5  (CLEARDVC)                                       */
*/*%INCLUDE SYSUT5  (GETLOCKS)                                       */
*/*%INCLUDE SYSUT5  (FRLOCKS )                                       */
*/*%INCLUDE SYSUT5  (ENQQ4   )                                       */
*/*%INCLUDE SYSUT5  (DEQQ4   )                                       */
*                                                               01S1777
*       ;                                                       01S1777
@DATA    DS    0H
@CH00060 DC    H'0'
@CH00063 DC    H'2'
@CH00089 DC    H'3'
@CH00035 DC    H'5'
@CH00033 DC    H'6'
@CH00032 DC    H'9'
@CH00078 DC    H'15'
@CH00071 DC    H'16'
@CH00069 DC    H'20'
@CH00434 DC    H'33'
@CH00085 DC    H'4096'
         DS    0F
@AL01118 DC    A(@CH00060)             LIST WITH   1 ARGUMENT(S)
@AL01185 DC    A(@CF00055+2)           LIST WITH   1 ARGUMENT(S)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@SA00002 DS    14F
@SA00003 DS    1F
@SA00004 DS    14F
@SA00010 DS    1F
@SA00017 DS    1F
@SA00018 DS    14F
@SA00011 DS    15F
@SA00012 DS    15F
@SA00013 DS    15F
@SA00014 DS    1F
@SA00029 DS    15F
@SA00030 DS    15F
@SA00005 DS    14F
@SA00006 DS    15F
@SA00021 DS    15F
@SA00023 DS    15F
@SA00015 DS    15F
@PC00015 DS    2F
@SA00016 DS    15F
@PC00016 DS    1F
@SA00019 DS    1F
@AL00001 DS    2A
@TF00001 DS    F
IEAVSWCH CSECT
         DS    0F
@CF00055 DC    F'1'
@CH00055 EQU   @CF00055+2
@CF00065 DC    F'4'
@CH00065 EQU   @CF00065+2
@CF00122 DC    F'36'
@CF00135 DC    F'67'
@CF00142 DC    F'71'
@CF03911 DC    F'59136'
@CF03912 DC    F'61696'
@CF03908 DC    F'-4'
@CF03732 DC    XL4'80000000'
@CF03963 DC    BL4'00000000000000000000000001000001'
@CF03967 DC    BL4'00000000000000000000000011000001'
@CF03973 DC    BL4'11111111111111111111111111111101'
@CF03977 DC    BL4'11111111111111111111111110111110'
@CF03980 DC    BL4'11111011111111111111111111111111'
@CF03983 DC    BL4'00000000000000000000000010000010'
@CF03988 DC    BL4'00000000000000000000000000000010'
@CF03991 DC    BL4'00000000000000000000000001000011'
@DATD    DSECT
         DS    0D
MSG143P2 DS    A
FAILI    DS    A
FAILO    DS    A
NEWO     DS    A
MASTERI  DS    A
MASTERO  DS    A
BELLCONS DS    A
PWRCONS  DS    A
OLDMAST  DS    A
PATHUCME DS    A
OUTQ     DS    A
CQEPTR2  DS    A
CQEBLK   DS    A
RETCODE  DS    F
CONTROL  DS    A
I        DS    F
J        DS    F
MSGPTR   DS    A
SAVCSAXA DS    A
LCVTPTR  DS    A
CQEPTR   DS    A
FRREPTR  DS    A
FRRSPTR  DS    A
WMJPTR   DS    A
FMTDTS   DS    CL8
         ORG   FMTDTS
HH       DS    CL2
PER1     DS    CL1
MM       DS    CL2
PER2     DS    CL1
SS       DS    CL2
         ORG   FMTDTS+8
MPLDEF   DS    CL12
         ORG   MPLDEF
WORD1    DS    FL4
DBLWORD1 DS    CL8
         ORG   DBLWORD1
@NM00014 DS    CL1
HHP      DS    CL2
MMP      DS    CL2
SSP      DS    CL2
@NM00015 DS    CL1
         ORG   MPLDEF+12
SWFLAGS  DS    CL4
         ORG   SWFLAGS
SWFLAG1  DS    BL1
         ORG   SWFLAG1
EXTSWREQ DS    BL1
RINGBELL EQU   SWFLAG1+0
RINGPOWR EQU   SWFLAG1+0
HAVEQ4   EQU   SWFLAG1+0
HCSWREQ  EQU   SWFLAG1+0
EXCPERR  EQU   SWFLAG1+0
POSTREQ  EQU   SWFLAG1+0
ALTFND   EQU   SWFLAG1+0
         ORG   SWFLAGS+1
SWFLAG2  DS    BL1
         ORG   SWFLAG2
SW1      DS    BL1
SW2      EQU   SWFLAG2+0
GETCQEFL EQU   SWFLAG2+0
FOUND    EQU   SWFLAG2+0
MSTSWTCH EQU   SWFLAG2+0
GRFSW    EQU   SWFLAG2+0
MSTFOUND EQU   SWFLAG2+0
MSTGRFND EQU   SWFLAG2+0
         ORG   SWFLAGS+2
SWFLAG3  DS    BL1
         ORG   SWFLAG3
ACCEPT   DS    BL1
NCCNOW   EQU   SWFLAG3+0
CLOSEBEL EQU   SWFLAG3+0
CLOSEALR EQU   SWFLAG3+0
@NM00016 EQU   SWFLAG3+0
@NM00017 EQU   SWFLAG3+0
@NM00018 EQU   SWFLAG3+0
@NM00019 EQU   SWFLAG3+0
         ORG   SWFLAGS+3
MSGFLAG1 DS    BL1
         ORG   MSGFLAG1
HCSUSP   DS    BL1
AMFAMSG  EQU   MSGFLAG1+0
@NM00020 EQU   MSGFLAG1+0
@NM00021 EQU   MSGFLAG1+0
@NM00022 EQU   MSGFLAG1+0
         ORG   SWFLAGS+4
OPENSAVE DS    CL12
         ORG   OPENSAVE
OPENSAV5 DS    AL4
OPENSAV6 DS    AL4
OPENSAV8 DS    AL4
         ORG   OPENSAVE+12
SAV0SAVE DS    CL72
SSOB     DS    CL20
         ORG   SSOB
SSOBID   DS    CL4
SSOBLEN  DS    FL2
SSOBFUNC DS    FL2
SSOBSSIB DS    AL4
SSOBRETN DS    AL4
SSOBINDV DS    AL4
         ORG   SSOB+20
SSWT     DS    CL16
         ORG   SSWT
SSWTLEN  DS    FL2
@NM00032 DS    FL2
SSWTWQE  DS    AL4
SSWTMIN  DS    AL4
SSWTORE  DS    AL4
         ORG   SSWT+16
ILIST    DS    CL20
LOCKSAVE DS    6F
IEAVSWCH CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CV00237 DC    V(IGC0I07B)
         DS    0D
THREESEC DC    F'300'
FIVESEC  DC    F'500'
H80MASK  DC    XL4'80000000'
H40MASK  DC    XL4'40000000'
H00MASK  DC    XL4'00000000'
@CC00143 DC    C' IEE143I ROUTCDE=                                     C
                        T=  H=  '
@CC00136 DC    C' IEE143I OLD=            NEW=            VALDCMD=     C
                            '
@CC00123 DC    C' IEE142I      NOW RECEIVING HARDCOPY'
@CC00101 DC    C'I-   ,O-   '
@CC00104 DC    C'CONSOLE '
@CC00108 DC    C'SYSIEFSD'
@CC00098 DC    C',CONS'
@CC00087 DC    C'NONE'
@CC00092 DC    C'INFO'
@CC00094 DC    C',SYS'
@CC00096 DC    C',I/O'
@CC00106 DC    C'4000'
@CC00112 DC    C'SSOB'
@CC00090 DC    C'ALL'
@CC00110 DC    C'Q4'
@CC00120 DC    C'00'
@CB00072 DC    X'FFFE'
@CB00337 DC    X'1003'
@CB00339 DC    X'100D'
@CB00341 DC    X'100C'
@CB00343 DC    X'1009'
@CB00345 DC    X'100A'
@CB00347 DC    X'100B'
SVC72ID  DC    CL4'VCTR'
         DS    CL5
RING1052 DS    CL8
         ORG   RING1052
CCODE    DC    X'0B'
@NM00023 DC    XL3'00'
SLI      DC    X'20'
@NM00024 DC    X'00'
BYTECNT  DC    X'0001'
         ORG   RING1052+8
RING3270 DS    CL8
         ORG   RING3270
GRCCODE  DC    X'01'
WCCADR   DC    AL3(WCC)
GRSLI    DC    X'20'
@NM00025 DC    X'00'
GRBYTCT  DC    X'0001'
         ORG   RING3270+8
WCC      DC    X'C4'
         DS    CL7
RINGPOWA DS    CL8
         ORG   RINGPOWA
PWRCODE  DC    X'E3'
@NM00026 DC    XL3'00'
PWRSLI   DC    X'20'
@NM00027 DC    X'00'
PWR0YTCT DC    X'0001'
         ORG   RINGPOWA+8
RCTBL    DC    CL3'  1'
         DC    CL3', 2'
         DC    CL3', 3'
         DC    CL3', 4'
         DC    CL3', 5'
         DC    CL3', 6'
         DC    CL3', 7'
         DC    CL3', 8'
         DC    CL3', 9'
         DC    CL3',10'
         DC    CL3',11'
         DC    CL3',12'
         DC    CL3',13'
         DC    CL3',14'
         DC    CL3',15'
PATCH    DC    21CL25'** IEAVSWCH PATCH AREA **'
IEAVSWCH CSECT
*                                          /*                @G51APSS*/
SWCHUCDX DSECT
         IEEUCDX
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IEAVSWCH CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
WMNPTR   EQU   @02
WQEPTR   EQU   @02
UCMDVEPT EQU   @02
UCMBASPT EQU   @10
UCMMCSPT EQU   @07
OREPTR   EQU   @11
MPLPTR   EQU   @02
NEWHC    EQU   @11
FAILHC   EQU   @02
CONUCME  EQU   @03
NEWI     EQU   @03
MSG143P1 EQU   @04
X        EQU   @11
MSGTXTPT EQU   @11
REG00    EQU   @00
REG01    EQU   @01
REG01F   EQU   @01
REG02    EQU   @02
REG04    EQU   @04
REG05    EQU   @05
REG06    EQU   @06
REG07    EQU   @07
REG08    EQU   @08
REG09    EQU   @09
REG10    EQU   @10
REG12    EQU   @12
REG13    EQU   @13
REG14    EQU   @14
REG15    EQU   @15
CXSAPTR  EQU   @12
GPR00P   EQU   @00
GPR01F   EQU   @01
GPR15F   EQU   @15
GPR00F   EQU   @00
GPR01P   EQU   @01
GPR03F   EQU   @03
REG03    EQU   @03
REG11    EQU   @11
CVTPTR   EQU   16
PSA      EQU   0
FLCRNPSW EQU   PSA
FLCROPSW EQU   PSA+8
FLCICCW2 EQU   PSA+16
PSAEEPSW EQU   PSA+132
PSAESPSW EQU   PSA+136
FLCSVILC EQU   PSAESPSW+1
PSAEPPSW EQU   PSA+140
FLCPIILC EQU   PSAEPPSW+1
FLCPICOD EQU   PSAEPPSW+2
PSAPICOD EQU   FLCPICOD+1
FLCTEA   EQU   PSAEPPSW+4
FLCPER   EQU   PSA+152
FLCMCLA  EQU   PSA+168
FLCCHNID EQU   FLCMCLA
FLCCHTM  EQU   FLCCHNID
FLCIOEL  EQU   FLCMCLA+4
FLCIOA   EQU   FLCMCLA+16
PSAMEDC  EQU   FLCMCLA+76
FLCFSA   EQU   FLCMCLA+80
PSATOLD  EQU   PSA+540
PSAAOLD  EQU   PSA+548
PSASUPER EQU   PSA+552
PSASUP1  EQU   PSASUPER
PSASUP2  EQU   PSASUPER+1
PSASUP3  EQU   PSASUPER+2
PSASUP4  EQU   PSASUPER+3
PSACLHT  EQU   PSA+640
PSALKSA  EQU   PSA+696
PSAHLHI  EQU   PSA+760
PSALITA  EQU   PSA+764
PSADSSFL EQU   PSA+836
PSADSSF1 EQU   PSADSSFL
PSADSSF3 EQU   PSADSSFL+2
PSADSSF4 EQU   PSADSSFL+3
PSARSVT  EQU   PSA+896
PSALSFCC EQU   PSA+1012
RV       EQU   0
RETURNPT EQU   0
IEAVMNTR EQU   0
BITZERO  EQU   0
DCMTSPTR EQU   0
UCM2PTR  EQU   0
JESCT    EQU   0
JESWAA   EQU   JESCT+8
JESSSREQ EQU   JESCT+20
JESALLOC EQU   JESCT+32
JESUNALC EQU   JESCT+36
JESCATL  EQU   JESCT+40
SSREQ    EQU   0
ASCB     EQU   0
ASCBSUPC EQU   ASCB+16
ASCBRSM  EQU   ASCB+52
ASCBRSMF EQU   ASCBRSM
ASCBFW1  EQU   ASCB+100
ASCBRCTF EQU   ASCBFW1+2
ASCBFLG1 EQU   ASCBFW1+3
ASCBDSP1 EQU   ASCB+114
ASCBFLG2 EQU   ASCB+115
ASCBLKGP EQU   ASCB+128
ASCBSRQ  EQU   ASCB+180
ASCBSRQ1 EQU   ASCBSRQ
ASCBSRQ2 EQU   ASCBSRQ+1
ASCBSRQ3 EQU   ASCBSRQ+2
ASCBSRQ4 EQU   ASCBSRQ+3
CVTMAP   EQU   0
CVTDAR   EQU   CVTMAP+72
CVTFLGS1 EQU   CVTDAR
CVTBRET  EQU   CVTMAP+82
CVTCUCB  EQU   CVTMAP+100
CVTDCB   EQU   CVTMAP+116
CVTIOQET EQU   CVTMAP+120
CVTIERLC EQU   CVTMAP+144
CVTHEAD  EQU   CVTMAP+160
CVTSV76C EQU   CVTHEAD
CVTOPTA  EQU   CVTMAP+182
CVTOPTB  EQU   CVTMAP+183
CVTABEND EQU   CVTMAP+200
CVTGTF   EQU   CVTMAP+236
CVTGTFST EQU   CVTGTF
CVTGTFS  EQU   CVTGTFST
CVTSTATE EQU   CVTGTFST
CVTTMODE EQU   CVTGTFST
CVTFORM  EQU   CVTGTFST
CVTAQAVT EQU   CVTMAP+240
CVTTCMFG EQU   CVTAQAVT
CVTVOLM2 EQU   CVTMAP+244
CVTTATA  EQU   CVTVOLM2
CVTTSKS  EQU   CVTTATA
CVTVOLF2 EQU   CVTTSKS
CVTTAT   EQU   CVTTATA+1
CVTATER  EQU   CVTMAP+248
CVTEXT1  EQU   CVTMAP+252
CVTPURG  EQU   CVTMAP+260
CVTQMSG  EQU   CVTMAP+268
CVTDMSR  EQU   CVTMAP+272
CVTRSV37 EQU   CVTDMSR
CVTDMSRF EQU   CVTRSV37
CVTJESCT EQU   CVTMAP+296
CVTERPV  EQU   CVTMAP+316
CVTINTLA EQU   CVTMAP+320
CVTAPF   EQU   CVTMAP+324
CVTEXT2  EQU   CVTMAP+328
CVTHJES  EQU   CVTMAP+332
CVTPGSIA EQU   CVTMAP+348
CVTA1F1  EQU   CVTMAP+356
CVTSYSK  EQU   CVTMAP+357
CVTVOLM1 EQU   CVTMAP+380
CVTVOLF1 EQU   CVTVOLM1
CVTATMCT EQU   CVTMAP+388
CVTXTNT1 EQU   0
CVTXTNT2 EQU   0
CVTDSSV  EQU   CVTXTNT2
CVTFLGBT EQU   CVTXTNT2+5
CVTQID   EQU   CVTXTNT2+24
CVTRV400 EQU   CVTXTNT2+52
CVTRV409 EQU   CVTXTNT2+53
CVTATCVT EQU   CVTXTNT2+64
CVTRV429 EQU   CVTXTNT2+84
CVTRV438 EQU   CVTXTNT2+85
CVTRV457 EQU   CVTXTNT2+112
CVTRV466 EQU   CVTXTNT2+113
CVTFIX   EQU   0
CVTRELNO EQU   CVTFIX+252
CQE      EQU   0
CQEWQE   EQU   CQE
CQEFLAG  EQU   CQEWQE
CQEEOB   EQU   CQEFLAG
CQEEOQ   EQU   CQEEOB
CQEMLQHC EQU   CQEFLAG
CQEMAJOR EQU   CQEFLAG
CQEAVAIL EQU   CQEFLAG
CQEENTR  EQU   CQEFLAG
CQEWQEA  EQU   CQEWQE+1
CXSA     EQU   0
CSADCBP  EQU   CXSA+4
CSANAME  EQU   CXSA+8
CSAUCM   EQU   CXSA+16
CSACODE  EQU   CSAUCM
CSAVCPU  EQU   CSACODE
CSAVCHAN EQU   CSACODE
CSAACR   EQU   CSACODE
CSAVMST  EQU   CSACODE
CSAEXTI  EQU   CSACODE
CSAHC    EQU   CSACODE
CSAUCMA  EQU   CSAUCM+1
CSACTLM  EQU   CXSA+20
CSAXA    EQU   CXSA+24
CSAXB    EQU   CXSA+28
CSAXC    EQU   CXSA+32
CSAXE    EQU   CXSA+40
CSAXF    EQU   CXSA+44
PARMLIST EQU   0
PARMSTAT EQU   PARMLIST
PARMFLAG EQU   PARMSTAT+1
PARMID   EQU   PARMLIST+20
DCMTSRT  EQU   0
DCMRFLGS EQU   DCMTSRT+5
@NM00051 EQU   DCMTSRT+14
DCMDEVTY EQU   DCMTSRT+15
DCMADSDS EQU   DCMTSRT+16
DCMR2FLG EQU   DCMTSRT+44
DCMR3FLG EQU   DCMTSRT+45
DCMSTSWT EQU   DCMR3FLG
DCMPACB  EQU   DCMTSRT+60
DCMACB   EQU   0
DCMASACB EQU   DCMACB+5
DCMACLR  EQU   DCMACB+9
DCMAFLG1 EQU   DCMACLR+17
DCMAFLG2 EQU   DCMACLR+18
DCMATFLG EQU   DCMACLR+19
DCMADFLG EQU   DCMATFLG
DCMATRCK EQU   DCMATFLG+1
FRRS     EQU   0
FRRSHEAD EQU   FRRS
FRRSEMP  EQU   FRRSHEAD
FRRSLAST EQU   FRRSHEAD+4
FRRSELEN EQU   FRRSHEAD+8
FRRSCURR EQU   FRRSHEAD+12
FRRSENTR EQU   0
FRRSFRRA EQU   FRRSENTR
FRRSFLGS EQU   FRRSENTR+4
FRRSFLG1 EQU   FRRSFLGS
FRRSPARM EQU   FRRSENTR+8
MPL      EQU   0
MPLPROC  EQU   MPL
MPLPROC1 EQU   MPLPROC
MPLCONS  EQU   MPLPROC1
MPLSTOP  EQU   MPLPROC1
MPLID    EQU   MPL+2
MPLTYPE  EQU   MPL+4
MPLTYPE1 EQU   MPLTYPE
OREF     EQU   0
ORELKP   EQU   OREF
OREXA    EQU   OREF+6
OREXC    EQU   OREF+7
OREBUFC  EQU   OREXC
ORETCB   EQU   OREF+8
OREWQE   EQU   OREF+12
ORERPY   EQU   OREF+16
OREECB   EQU   OREF+20
RBPRFX   EQU   0
RBBASIC  EQU   0
RBEXRTNM EQU   RBBASIC
RBTMFLD  EQU   RBEXRTNM
RBSTAB   EQU   RBBASIC+10
XSTAB    EQU   RBSTAB
RBSTAB1  EQU   XSTAB
XSTAB1   EQU   RBSTAB1
RBFTCKPT EQU   XSTAB1
RBSTAB2  EQU   XSTAB+1
XSTAB2   EQU   RBSTAB2
RBTCBNXT EQU   XSTAB2
RBFACTV  EQU   XSTAB2
RBFDYN   EQU   XSTAB2
RBECBWT  EQU   XSTAB2
RBOPSW   EQU   RBBASIC+16
XRBPSW   EQU   RBOPSW
RBOPSWB2 EQU   XRBPSW+1
RBLINK   EQU   RBBASIC+28
XRBLNK   EQU   RBLINK
RBWCF    EQU   XRBLNK
RBLINKB  EQU   XRBLNK+1
RBGRSAVE EQU   RBBASIC+32
XRBREG   EQU   RBGRSAVE
RBGRS0   EQU   XRBREG
RBGRS1   EQU   XRBREG+4
RBGRS2   EQU   XRBREG+8
RBGRS3   EQU   XRBREG+12
RBGRS4   EQU   XRBREG+16
RBGRS5   EQU   XRBREG+20
RBGRS6   EQU   XRBREG+24
RBGRS7   EQU   XRBREG+28
RBGRS8   EQU   XRBREG+32
RBGRS9   EQU   XRBREG+36
RBGRS10  EQU   XRBREG+40
RBGRS11  EQU   XRBREG+44
RBGRS12  EQU   XRBREG+48
RBGRS13  EQU   XRBREG+52
RBGRS14  EQU   XRBREG+56
RBGRS15  EQU   XRBREG+60
XRBESA   EQU   RBBASIC+96
RBPREFIX EQU   0
RBRSV019 EQU   RBPREFIX+14
RBRSV028 EQU   RBPREFIX+15
RBRSV041 EQU   RBPREFIX+27
RBRSV054 EQU   RBPREFIX+39
RBRTOPSW EQU   RBPREFIX+40
RBRTPSW2 EQU   RBRTOPSW+8
RBRTICIL EQU   RBRTPSW2
RBFLAGS1 EQU   RBPREFIX+56
RBINTCDA EQU   RBPREFIX+61
RBSECT   EQU   0
RBPPSAV  EQU   RBSECT
@NM00127 EQU   RBSECT+10
@NM00128 EQU   @NM00127
RBTRSVRB EQU   @NM00128
@NM00130 EQU   @NM00127+1
RBETXR   EQU   @NM00130
RBEP     EQU   RBSECT+12
RBPGMQ   EQU   RBSECT+24
@NM00137 EQU   RBSECT+28
@NM00138 EQU   @NM00137
IRBEND   EQU   RBSECT+96
@NM00141 EQU   RBSECT+96
RBRSV138 EQU   @NM00141+7
RBSCBB   EQU   RBSECT+144
RBSPARM  EQU   RBSCBB+8
RBSFLGS1 EQU   RBSPARM
RBSIOPRC EQU   RBSFLGS1
RBSOWNR  EQU   RBSCBB+12
RBSFLGS2 EQU   RBSOWNR
RBSDATA  EQU   RBSCBB+16
RBSFLG3  EQU   RBSDATA
RBRSV150 EQU   RBSECT+167
SCVTSECT EQU   0
SCVTCTCB EQU   SCVTSECT+112
TCBFIX   EQU   0
TCBFRS   EQU   TCBFIX
TCB      EQU   0
TCBRBP   EQU   TCB
TCBPIE   EQU   TCB+4
TCBPMASK EQU   TCBPIE
TCBCMP   EQU   TCB+16
TCBCMPF  EQU   TCBCMP
TCBCPP   EQU   TCBCMPF
TCBSTCC  EQU   TCBCMPF
TCBCDBL  EQU   TCBCMPF
TCBCWTO  EQU   TCBCMPF
TCBCIND  EQU   TCBCMPF
TCBCMSG  EQU   TCBCMPF
TCBTRN   EQU   TCB+20
TCBABF   EQU   TCBTRN
TCBMSS   EQU   TCB+24
TCBPKF   EQU   TCB+28
TCBFLGS  EQU   TCB+29
TCBFLGS1 EQU   TCBFLGS
TCBFLGS2 EQU   TCBFLGS+1
TCBFLGS3 EQU   TCBFLGS+2
TCBFLGS4 EQU   TCBFLGS+3
TCBFLGS5 EQU   TCBFLGS+4
TCBABWF  EQU   TCBFLGS5
TCBJPQ   EQU   TCB+44
TCBPURGE EQU   TCBJPQ
TCBGRS   EQU   TCB+48
TCBFSA   EQU   TCB+112
TCBTME   EQU   TCB+120
TCBJSTCB EQU   TCB+124
TCBTSFLG EQU   TCB+148
TCBTSTSK EQU   TCBTSFLG
TCBSTAB  EQU   TCB+160
TCBNSTAE EQU   TCBSTAB
TCBTCT   EQU   TCB+164
TCBTCTGF EQU   TCBTCT
TCBSCNDY EQU   TCB+172
TCBNDSP  EQU   TCBSCNDY
TCBNDSP1 EQU   TCBNDSP+1
TCBNDSP2 EQU   TCBNDSP+2
TCBNDSP3 EQU   TCBNDSP+3
TCBJSCB  EQU   TCB+180
TCBRECDE EQU   TCBJSCB
TCBEXT1  EQU   TCB+196
TCBBITS  EQU   TCB+200
TCBNDSP4 EQU   TCBBITS
TCBNDSP5 EQU   TCBBITS+1
TCBFLGS6 EQU   TCBBITS+2
TCBFLGS7 EQU   TCBBITS+3
TCBDAR   EQU   TCB+204
TCBDARC  EQU   TCBDAR
TCBEXT2  EQU   TCB+208
TCBXSCT  EQU   TCB+240
TCBXSCT1 EQU   TCBXSCT
TCBFOE   EQU   TCB+244
TCBSTAWA EQU   TCB+252
TCBESTAE EQU   TCB+264
TCBESTRM EQU   TCBESTAE+1
TCBFBYT1 EQU   TCB+276
TCBFBYT2 EQU   TCB+277
TCBRV124 EQU   TCB+278
TCBRV133 EQU   TCB+279
TCBXTNT2 EQU   0
TCBGTF   EQU   TCBXTNT2
TCBTFLG  EQU   TCBGTF
TCBRV146 EQU   TCBXTNT2+28
TCBRV155 EQU   TCBXTNT2+29
TCBRV164 EQU   TCBXTNT2+30
TCBRV173 EQU   TCBXTNT2+31
UCB      EQU   0
UCBOB    EQU   0
UCBJBNR  EQU   UCBOB
UCBFL5   EQU   UCBOB+1
UCBAF    EQU   UCBFL5
UCBNALOC EQU   UCBFL5
UCBSTAT  EQU   UCBOB+3
UCBONLI  EQU   UCBSTAT
UCBALOC  EQU   UCBSTAT
UCBSYSR  EQU   UCBSTAT
UCBCHAN  EQU   UCBOB+4
UCBSFLS  EQU   UCBOB+6
UCBFLA   EQU   UCBSFLS
UCBFL1   EQU   UCBFLA
UCBBSY   EQU   UCBFL1
UCBNRY   EQU   UCBFL1
UCBPST   EQU   UCBFL1
UCBCUB   EQU   UCBFL1
UCBFLB   EQU   UCBSFLS+1
UCBCHM   EQU   UCBOB+8
UCBCHM1  EQU   UCBCHM
UCBPTH0  EQU   UCBCHM1
UCBPTH1  EQU   UCBCHM1
UCBWGT   EQU   UCBOB+12
UCBVHRSN EQU   UCBWGT
UCBNAME  EQU   UCBOB+13
UCBTYP   EQU   UCBOB+16
UCBTBYT1 EQU   UCBTYP
UCB1FEA5 EQU   UCBTBYT1
UCB1FEA6 EQU   UCBTBYT1
UCBTBYT2 EQU   UCBTYP+1
UCB2OPT2 EQU   UCBTBYT2
UCBDUDN1 EQU   UCB2OPT2
UCB2OPT3 EQU   UCBTBYT2
UCBDUDN2 EQU   UCB2OPT3
UCB2OPT4 EQU   UCBTBYT2
UCBRWTAU EQU   UCB2OPT4
UCB2OPT6 EQU   UCBTBYT2
UCB2OPT7 EQU   UCBTBYT2
UCBTBYT3 EQU   UCBTYP+2
UCBDVCLS EQU   UCBTBYT3
UCB3COMM EQU   UCBDVCLS
UCBTBYT4 EQU   UCBTYP+3
UCBEXTPT EQU   UCBOB+20
UCBFLC   EQU   UCBEXTPT
UCBDEV   EQU   UCBOB+24
UCBCMEXT EQU   0
UCBATI   EQU   UCBCMEXT+3
@NM00177 EQU   UCBATI
UCBFLP1  EQU   UCBCMEXT+5
UCBMT    EQU   0
UCBOCR   EQU   0
UCB3540X EQU   0
UCBDKBYT EQU   UCB3540X+6
UCB3800X EQU   0
UCBOPTNS EQU   UCB3800X
UCBACTIV EQU   UCB3800X+3
UCBMDRBF EQU   UCB3800X+36
UCBUCS   EQU   0
UCBUCSOP EQU   UCBUCS+4
UCBFCBOP EQU   UCBUCS+5
UCM2EXT  EQU   0
UCM2STA  EQU   UCM2EXT+8
UCM2SFLG EQU   UCM2STA
UCMPRFX  EQU   0
UCMMCENT EQU   UCMPRFX
UCMSAVE0 EQU   UCMPRFX+4
UCMSFLGS EQU   UCMPRFX+84
UCMSFLG1 EQU   UCMSFLGS
UCMSYSD  EQU   UCMSFLG1
UCMSYSE  EQU   UCMSFLG1
UCMSYSG  EQU   UCMSFLG1
UCMSFLG2 EQU   UCMSFLGS+1
UCMSYSI  EQU   UCMSFLG2
UCMSYSJ  EQU   UCMSFLG2
UCMSYSL  EQU   UCMSFLG2
UCMSYSP  EQU   UCMSFLG2
UCMCMID  EQU   UCMPRFX+88
UCMHCUCM EQU   UCMPRFX+92
UCMUEXIT EQU   UCMPRFX+97
UCMXSA   EQU   UCMPRFX+104
UCMQRTN  EQU   UCMPRFX+128
UCMSWSA1 EQU   UCMPRFX+132
UCMSWSA2 EQU   UCMPRFX+136
UCMSDS1  EQU   UCMPRFX+156
UCMPRFXP EQU   0
UCM      EQU   0
UCMOECB  EQU   UCM+8
UCMDECB  EQU   UCM+12
UCMLSTP  EQU   UCM+20
UCMWTOQ  EQU   UCM+24
UCMRPYQ  EQU   UCM+28
UCMRPYI  EQU   UCM+32
UCMWQNR  EQU   UCM+58
UCMWQEND EQU   UCM+60
UCMPXA   EQU   UCM+64
UCMPXB   EQU   UCM+68
UCMMODE  EQU   UCMPXB
UCMAMFA  EQU   UCMMODE
UCMVDATA EQU   UCM+72
UCMVEA   EQU   UCMVDATA
UCMVEZ   EQU   UCMVDATA+4
UCMVEL   EQU   UCMVDATA+8
UCMMNTR  EQU   UCM+208
UCMBFEXT EQU   UCM+240
UCMCTID  EQU   UCM+250
UCMWQECP EQU   UCM+276
UCMASCB  EQU   UCM+280
UCMFRRAD EQU   UCM+288
UCMRSV42 EQU   UCM+300
UCMRSV51 EQU   UCM+301
UCMEIL   EQU   0
UCMRECBA EQU   UCMEIL+24
UCMLIST  EQU   0
UCMECB   EQU   UCMLIST
UCMSBR   EQU   UCMLIST+4
UCMDCB   EQU   UCMLIST+8
UCMUCB   EQU   UCMLIST+12
UCMNAME  EQU   UCMLIST+16
UCMSTS   EQU   UCMLIST+24
UCMAF    EQU   UCMSTS
UCMPF    EQU   UCMSTS
UCMBF    EQU   UCMSTS
UCMCF    EQU   UCMSTS
UCMTA    EQU   UCMSTS
UCMTC    EQU   UCMSTS
UCMATR   EQU   UCMLIST+25
UCMOF    EQU   UCMATR
UCMIF    EQU   UCMATR
UCMUF    EQU   UCMATR
UCMXA    EQU   UCMLIST+26
UCMID    EQU   UCMXA
UCMXB    EQU   UCMLIST+28
UCMRTCD  EQU   UCMLIST+32
UCMOUTQ  EQU   UCMLIST+36
UCMAUTH  EQU   UCMLIST+40
UCMAUTHA EQU   UCMAUTH
UCMAUTH1 EQU   UCMAUTHA
UCMAUTH2 EQU   UCMAUTHA
UCMAUTH3 EQU   UCMAUTHA
UCMDISP  EQU   UCMLIST+42
UCMDISP1 EQU   UCMDISP
UCMDISPA EQU   UCMDISP1
UCMDISPB EQU   UCMDISP1
UCMDISPC EQU   UCMDISP1
UCMDISPD EQU   UCMDISP1
UCMDISPE EQU   UCMDISP1
UCMDISPF EQU   UCMDISP1
UCMDISPG EQU   UCMDISP1
UCMDISP2 EQU   UCMDISP+1
UCMDISPI EQU   UCMDISP2
UCMDISPJ EQU   UCMDISP2
UCMDISPK EQU   UCMDISP2
UCMALTEN EQU   UCMLIST+44
UCMWLAST EQU   UCMLIST+52
UCMCOMPC EQU   UCMLIST+56
UCMMSG   EQU   UCMLIST+60
UCMMSG1  EQU   UCMMSG
UCMDEVC  EQU   UCMLIST+63
UCMDEVCC EQU   UCMDEVC
UCMDEVE  EQU   UCMDEVC
UCMVHRSN EQU   UCMDEVC
UCMMLAST EQU   UCMLIST+64
UCMRCT   EQU   UCMLIST+68
UCMSDS5  EQU   UCMRCT
UCMSDS5A EQU   UCMSDS5
UCMSDS5B EQU   UCMSDS5
UCMSDS5C EQU   UCMSDS5
UCMSDS5F EQU   UCMSDS5
UCMSDS5G EQU   UCMSDS5
UCMFEXTP EQU   UCMLIST+72
UCMEXIT  EQU   0
UCMFEXTA EQU   0
UCMFPPTR EQU   UCMFEXTA+4
UCMFMGFS EQU   UCMFEXTA+8
UCMFFLG1 EQU   UCMFMGFS
UCMFECBL EQU   UCMFEXTA+28
UCMFRECB EQU   UCMFECBL+4
UCMFRBYT EQU   UCMFRECB
UCMFATCN EQU   UCMFEXTA+36
UCMPEXTA EQU   0
UCMPDM1  EQU   UCMPEXTA+4
UCMPNMCC EQU   UCMPDM1+4
UCMPNCC  EQU   UCMPDM1+8
UCMEFEXT EQU   0
UCMEFLG1 EQU   UCMEFEXT
UCMEFLGA EQU   UCMEFLG1
UCMEFLGB EQU   UCMEFLG1
UCMEFATT EQU   UCMEFEXT+2
UCMEFPEX EQU   UCMEFEXT+4
WQE      EQU   0
WQELKP   EQU   WQE
WQEUSE   EQU   WQELKP
WQELKPA  EQU   WQELKP+1
WQENBR   EQU   WQE+4
WQERR    EQU   WQE+8
WQEPAD   EQU   WQE+12
WQETS    EQU   WQE+13
WQEPAD1  EQU   WQE+21
WQEJOBNM EQU   WQE+22
WQEPAD2  EQU   WQE+30
WQETXT   EQU   WQE+31
WQEXA    EQU   WQE+160
WQEQFHC  EQU   WQEXA
WQEQDFHC EQU   WQEXA
WQESUSP  EQU   WQEXA
WQEAUTH  EQU   WQEXA
WQEASID  EQU   WQE+161
WQEAVAIL EQU   WQE+163
WQEBUFC  EQU   WQEAVAIL
WQEBUFD  EQU   WQEAVAIL
WQEBUFE  EQU   WQEAVAIL
WQETCB   EQU   WQE+164
WQESEQN  EQU   WQE+169
WQEMCSF  EQU   WQE+172
WQEMCSF1 EQU   WQEMCSF
WQEMCSA  EQU   WQEMCSF1
WQEMCSB  EQU   WQEMCSF1
WQEMCSD  EQU   WQEMCSF1
WQEMCSG  EQU   WQEMCSF1
WQEMCSH  EQU   WQEMCSF1
WQEMCSF2 EQU   WQEMCSF+1
WQEMCSN  EQU   WQEMCSF2
WQEMSGTP EQU   WQE+174
WQEMSGT1 EQU   WQEMSGTP
WQEROUT  EQU   WQE+176
WQEROUT1 EQU   WQEROUT
WQEROUTB EQU   WQEROUT1
WQEROUT2 EQU   WQEROUT+1
WQEUCMID EQU   WQE+180
WQEDESCD EQU   WQE+184
WQEDC1   EQU   WQEDESCD
WQEDCD   EQU   WQEDC1
WQEDC2   EQU   WQEDESCD+1
WQEJSTCB EQU   WQE+188
WMJM     EQU   0
WMJMEXT  EQU   WMJM
WMJMEXTA EQU   WMJMEXT+1
WMJMMLW  EQU   WMJM+4
WMJMMLWH EQU   WMJMMLW
WMJMTS   EQU   WMJM+13
WMJMSER  EQU   WMJM+122
WMJMSER1 EQU   WMJMSER
WMJMLTYP EQU   WMJM+134
WMJMLTY1 EQU   WMJMLTYP
WMJMLTYD EQU   WMJMLTY1
WMJMMIN  EQU   WMJM+136
WMJMECBF EQU   WMJM+148
WMJMDSP  EQU   WMJM+160
WMJMBUF  EQU   WMJM+163
WMJMCS   EQU   WMJM+172
WMJMCS1  EQU   WMJMCS
WMJMCS2  EQU   WMJMCS+1
WMJMMT   EQU   WMJM+174
WMJMMT1  EQU   WMJMMT
WMJMRTC  EQU   WMJM+176
WMJMRCT1 EQU   WMJMRTC
WMJMRCT2 EQU   WMJMRTC+1
WMJMDEC  EQU   WMJM+184
WMJMDEC1 EQU   WMJMDEC
WMJMDECH EQU   WMJMDEC1
WMJMDEC2 EQU   WMJMDEC+1
WMJMDECI EQU   WMJMDEC2
WMNM     EQU   0
WMNMEXT  EQU   WMNM
WMNMUC1  EQU   WMNMEXT
WMNMNX1  EQU   WMNMEXT+1
WMNMML1  EQU   WMNM+4
WMNMLT1  EQU   WMNM+5
WMNMLT1D EQU   WMNMLT1
WMNMST1  EQU   WMNM+84
WMNMML2  EQU   WMNM+100
WMNMLT2  EQU   WMNM+101
WMNMST2  EQU   WMNM+180
DCMREND  EQU   0
IEECMENQ EQU   0
IEFAB4F5 EQU   0
IEFBB410 EQU   0
IEFW21SD EQU   0
I001C    EQU   0
I008P    EQU   0
I015F    EQU   0
I015P    EQU   0
I031F    EQU   0
I031P    EQU   0
I256C    EQU   0
SWAMGR   EQU   0
UCBBGN   EQU   0
UCMEPEXT EQU   0
TYPECONS EQU   0
OPNCLOSE EQU   0
TYPECCW  EQU   0
MSG142M  EQU   WQETXT
M142DEV  EQU   MSG142M+10
MSG143M1 EQU   WQETXT
OLD      EQU   MSG143M1+13
OLDNOCP  EQU   OLD
OLDCP    EQU   OLDNOCP
OLDINID  EQU   OLDCP+2
OLDOUTID EQU   OLDCP+8
NEW      EQU   MSG143M1+29
NEWNOCP  EQU   NEW
NEWCP    EQU   NEWNOCP
NEWINID  EQU   NEWCP+2
NEWOUTID EQU   NEWCP+8
CMDS     EQU   MSG143M1+49
MSG143M2 EQU   WQETXT
ROUTCDES EQU   MSG143M2+17
TYPE     EQU   MSG143M2+65
HCCHAR   EQU   MSG143M2+69
@NM00013 EQU   UCMMCENT
WORD1S   EQU   WORD1
CPEXTSAV EQU   WORD1
ASCBPTR  EQU   UCMASCB
PARMPTR  EQU   CSAXB
SACBPTR  EQU   DCMADSDS
RBSECPTR EQU   TCBRBP
SCVTSPTR EQU   CVTABEND
TCBPTR   EQU   SCVTCTCB
UCBPTR   EQU   UCMUCB
UCMEXTPT EQU   UCM2PTR
UCMEILPT EQU   UCMLSTP
UCMUEWPT EQU   UCMUEXIT
UCMFXPTR EQU   UCMBFEXT
UCMPXPTR EQU   UCMFPPTR
IOCOMP   EQU   UCMECB
UCBSTATX EQU   UCBSTAT
UCBONLIX EQU   UCBSTATX
UCBCHGSX EQU   UCBSTATX
UCBSYSRX EQU   UCBSTATX
UCBDADIX EQU   UCBSTATX
UCBWGTX  EQU   UCBWGT
UCBVORSX EQU   UCBWGTX
CVTS01   EQU   CVTPGSIA
CVTLPDIA EQU   CVTS01+12
CVTDIRST EQU   CVTLPDIA
CVTSLIDA EQU   CVTS01+24
CVTCTLFG EQU   CVTS01+50
CVTBLDCP EQU   CVTS01+140
CVTGETCL EQU   CVTS01+144
CVTFRECL EQU   CVTS01+148
CVTCRMN  EQU   CVTS01+156
CVTRV210 EQU   CVTS01+424
CVTRV219 EQU   CVTS01+425
CVTRV228 EQU   CVTS01+426
CVTRV237 EQU   CVTS01+427
CVTMFRTR EQU   CVTS01+452
CVTRV262 EQU   CVTS01+468
CVTRV271 EQU   CVTS01+469
CVTRV280 EQU   CVTS01+470
CVTRV289 EQU   CVTS01+471
CVTRMBR  EQU   CVTS01+492
CVTGSDA  EQU   CVTS01+600
FLC      EQU   PSA
PSARSVTE EQU   PSARSVT
PSACSTK  EQU   PSARSVTE
RBSECS03 EQU   RBEP
RBCDE    EQU   RBSECS03
RBCDFLGS EQU   RBCDE
RBSECS05 EQU   RBPGMQ
RBSQE    EQU   RBSECS05
RBSECS06 EQU   RBPGMQ
RBIQE    EQU   RBSECS06
RBSECS07 EQU   RBPGMQ
RBIQE2   EQU   RBSECS07
RBSECS08 EQU   IRBEND
RBSECS09 EQU   IRBEND
UCBOBS01 EQU   UCBDEV
UCBSTAB  EQU   UCBOBS01+10
UCBBSVL  EQU   UCBSTAB
UCBPRSRS EQU   UCBSTAB
UCBDMCT  EQU   UCBOBS01+11
UCBFL4   EQU   UCBOBS01+13
UCBOBS02 EQU   UCBDEV
UCBTFL1  EQU   UCBOBS02+19
UCBXTN   EQU   UCBOBS02+20
UCBVOPT  EQU   UCBXTN
UCBOBS03 EQU   UCBDEV
UCBXTADR EQU   UCBOBS03
UCBOBS04 EQU   UCBDEV
UCBBTA   EQU   UCBOBS04+12
UCBOBS06 EQU   UCBDEV
UCBAOF   EQU   UCBOBS06
UCBAOF1  EQU   UCBAOF
UCBAOF2  EQU   UCBAOF+1
@NM00176 EQU   UCBOBS06+3
UCBIRB   EQU   UCBOBS06+4
UCBGRAF  EQU   UCBIRB
UCBLDNCA EQU   UCBOBS06+8
UCBRDYQ  EQU   UCBLDNCA
UCBIRLN  EQU   UCBRDYQ
UCBLDNCB EQU   UCBRDYQ+1
UCBCTLNK EQU   UCBOBS06+12
UCBOBS07 EQU   UCBDEV
UCBOBS08 EQU   UCBDEV
UCBCTCAD EQU   UCBOBS08
UCBCTCF1 EQU   UCBOBS08+4
UCBOBS09 EQU   UCBDEV
UCMIECBA EQU   UCMRECBA+4
I002     EQU   ILIST
I00201   EQU   I002
I00202   EQU   I002+4
I00203   EQU   I002+8
I056     EQU   ILIST
I05602   EQU   I056+4
I05603   EQU   I05602
I05604   EQU   I05602+1
I05605   EQU   I05602+2
I05606   EQU   I05602+4
I05607   EQU   I05602+8
I048     EQU   ILIST
I04802   EQU   I048+4
I04803   EQU   I04802
I04804   EQU   I04803
I04805   EQU   I04803+1
I04806   EQU   I04803+2
I04807   EQU   I04802+4
I04808   EQU   I04802+8
RING2250 EQU   RING1052
RING3036 EQU   RING3270
RING3066 EQU   RING1052
RING3215 EQU   RING1052
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00182 EQU   I04803+3
I04801   EQU   I048
I05655   EQU   I05602+3
I05601   EQU   I056
UCMIECBP EQU   UCMIECBA+1
UCMIECBF EQU   UCMIECBA
UCBRV066 EQU   UCBOBS09+4
UCBIOSBA EQU   UCBOBS09
UCBRV042 EQU   UCBOBS08+5
UCBRV082 EQU   UCBCTCF1
UCBRV081 EQU   UCBCTCF1
UCBRV080 EQU   UCBCTCF1
UCBRV079 EQU   UCBCTCF1
UCBRV078 EQU   UCBCTCF1
UCBRV077 EQU   UCBCTCF1
UCBRV076 EQU   UCBCTCF1
UCBCTC80 EQU   UCBCTCF1
UCBCTCAL EQU   UCBCTCAD
UCBICNCB EQU   UCBOBS07+4
UCBRV040 EQU   UCBOBS07
UCBCTLNA EQU   UCBCTLNK+1
UCBRLN   EQU   UCBCTLNK
UCBRDYQA EQU   UCBLDNCB
UCBINRLN EQU   UCBIRLN
UCBIRBA  EQU   UCBIRB+1
UCBRV039 EQU   UCBGRAF
UCBDWNR  EQU   UCBGRAF
UCBRPND  EQU   UCBGRAF
UCBUPM   EQU   UCBGRAF
UCBBTAM  EQU   UCBGRAF
UCBDRNO  EQU   UCBGRAF
UCBDRO   EQU   UCBGRAF
UCBOIP   EQU   UCBGRAF
UCBATRCD EQU   @NM00176
UCBSKPFG EQU   @NM00176
UCBRIPND EQU   @NM00176
UCBRTIAC EQU   @NM00176
UCBRSV79 EQU   @NM00176
UCBRSV78 EQU   @NM00176
UCBRSV77 EQU   @NM00176
UCBOLTEP EQU   @NM00176
UCBATNCT EQU   UCBOBS06+2
UCBRSV76 EQU   UCBAOF2
UCBRSV75 EQU   UCBAOF2
UCBRSV74 EQU   UCBAOF2
UCBRSV73 EQU   UCBAOF2
UCBRSV72 EQU   UCBAOF2
UCBRSV71 EQU   UCBAOF2
UCBRSV70 EQU   UCBAOF2
UCBRSV69 EQU   UCBAOF2
UCBRSV68 EQU   UCBAOF1
UCBRSV67 EQU   UCBAOF1
UCBRSV66 EQU   UCBAOF1
UCBRSV65 EQU   UCBAOF1
UCBRSV64 EQU   UCBAOF1
UCBOFNL  EQU   UCBAOF1
UCBOFSP  EQU   UCBAOF1
UCBOFMCR EQU   UCBAOF1
UCBBTB   EQU   UCBBTA+1
UCBDI    EQU   UCBBTA
UCBSNS   EQU   UCBOBS04+8
UCBTEB   EQU   UCBOBS04+4
UCBGCB   EQU   UCBOBS04+3
UCBOPEN  EQU   UCBOBS04+2
UCBSTART EQU   UCBOBS04
UCBXTNB  EQU   UCBXTN+1
UCBRSV22 EQU   UCBVOPT
UCBRSV21 EQU   UCBVOPT
UCBRSV20 EQU   UCBVOPT
UCBESVE  EQU   UCBVOPT
UCBERPC  EQU   UCBVOPT
UCBESVC  EQU   UCBVOPT
UCBEVA   EQU   UCBVOPT
UCBESV   EQU   UCBVOPT
UCBRV009 EQU   UCBTFL1
UCBRV008 EQU   UCBTFL1
UCBRV007 EQU   UCBTFL1
UCBRV006 EQU   UCBTFL1
UCBRV005 EQU   UCBTFL1
UCBDQDSP EQU   UCBTFL1
UCBNSLTP EQU   UCBTFL1
UCBNLTP  EQU   UCBTFL1
UCBRES1B EQU   UCBOBS02+18
UCBFSER  EQU   UCBOBS02+12
@NM00175 EQU   UCBOBS02+4
UCBFSEQ  EQU   UCBOBS02+2
UCBFSCT  EQU   UCBOBS02
UCBNEXP  EQU   UCBOBS01+20
UCBBASE  EQU   UCBOBS01+16
UCBRES1A EQU   UCBOBS01+15
UCBUSER  EQU   UCBOBS01+14
UCBFL47  EQU   UCBFL4
UCBMAT   EQU   UCBFL4
UCBHOLD  EQU   UCBFL4
UCBATTN  EQU   UCBFL4
UCBDSS   EQU   UCBFL4
UCBRESVP EQU   UCBFL4
UCBWDAV  EQU   UCBFL4
UCBDAVV  EQU   UCBFL4
UCBSQC   EQU   UCBOBS01+12
UCBDATP  EQU   UCBOBS01+12
UCBDMC   EQU   UCBDMCT
UCBMOUNT EQU   UCBDMCT
UCBBNUL  EQU   UCBSTAB
UCBSHAR  EQU   UCBSTAB
UCBBSTR  EQU   UCBSTAB
UCBBPUB  EQU   UCBSTAB
UCBBPRV  EQU   UCBSTAB
UCBBALB  EQU   UCBPRSRS
UCBPGFL  EQU   UCBSTAB
UCBDVSHR EQU   UCBBSVL
UCBVOLI  EQU   UCBOBS01+4
UCBVTOC  EQU   UCBOBS01
RBRSV161 EQU   RBSECS09+64
RBSIRBWA EQU   RBSECS09
RBIQEWRK EQU   RBSECS08+4
RBNEXAV  EQU   RBSECS08
RBIQEA   EQU   RBIQE2
RBIQE1   EQU   RBIQE+1
RBUSE    EQU   RBIQE
RBSQEA   EQU   RBSQE+1
@NM00142 EQU   RBSQE
RBCDE1   EQU   RBCDE+1
RBCDLOAD EQU   RBCDFLGS
RBCDXCTL EQU   RBCDFLGS
RBCDSYNC EQU   RBCDFLGS
RBCDNODE EQU   RBCDFLGS
RBCDSAVE EQU   RBCDFLGS
RBCDATCH EQU   RBCDFLGS
RBRSV009 EQU   RBCDFLGS
RBNOCELL EQU   RBCDFLGS
PSARSAV  EQU   PSARSVTE+60
PSARSTK  EQU   PSARSVTE+56
PSAESAV3 EQU   PSARSVTE+52
PSAESTK3 EQU   PSARSVTE+48
PSAESAV2 EQU   PSARSVTE+44
PSAESTK2 EQU   PSARSVTE+40
PSAESAV1 EQU   PSARSVTE+36
PSAESTK1 EQU   PSARSVTE+32
PSAPSAV  EQU   PSARSVTE+28
PSAPSTK  EQU   PSARSVTE+24
PSAMSAV  EQU   PSARSVTE+20
PSAMSTK  EQU   PSARSVTE+16
PSASSAV  EQU   PSARSVTE+12
PSASSTK  EQU   PSARSVTE+8
PSANSTK  EQU   PSARSVTE+4
CVTRV628 EQU   CVTS01+728
CVTRV627 EQU   CVTS01+724
CVTRV626 EQU   CVTS01+720
CVTRV625 EQU   CVTS01+716
CVTRV624 EQU   CVTS01+712
CVTRV623 EQU   CVTS01+708
CVTRV622 EQU   CVTS01+704
CVTRV621 EQU   CVTS01+700
CVTIHASU EQU   CVTS01+696
CVTSUSP  EQU   CVTS01+692
CVTT6SVC EQU   CVTS01+688
CVTCDAL  EQU   CVTS01+684
CVTTCTL  EQU   CVTS01+680
CVTRSUME EQU   CVTS01+676
CVTJTERM EQU   CVTS01+672
CVTASMRM EQU   CVTS01+668
CVTTCASP EQU   CVTS01+664
CVT0PT03 EQU   CVTS01+660
CVT0PT0E EQU   CVTS01+656
CVTRV609 EQU   CVTS01+652
CVTCGK   EQU   CVTS01+648
CVTRAC   EQU   CVTS01+644
CVTHSM   EQU   CVTS01+640
CVTRV605 EQU   CVTS01+636
CVTRV604 EQU   CVTS01+632
CVTEFF02 EQU   CVTS01+628
CVTCBBR  EQU   CVTS01+624
CVTSSCR  EQU   CVTS01+620
CVTEVENT EQU   CVTS01+616
CVTCRCA  EQU   CVTS01+612
CVTTPIO  EQU   CVTS01+608
CVTADV   EQU   CVTS01+604
CVTGSDAB EQU   CVTGSDA
CVTQV3   EQU   CVTS01+596
CVTQV2   EQU   CVTS01+592
CVTQV1   EQU   CVTS01+588
CVTRPT   EQU   CVTS01+584
CVTSSRB  EQU   CVTS01+580
CVTCSDRL EQU   CVTS01+576
CVTEXP1  EQU   CVTS01+572
CVTRMPMT EQU   CVTS01+568
CVTRMPTT EQU   CVTS01+564
CVTVPSA  EQU   CVTS01+560
CVTVSTOP EQU   CVTS01+556
CVTGTFR8 EQU   CVTS01+552
CVTQUIT  EQU   CVTS01+548
CVTVACR  EQU   CVTS01+544
CVTWTCB  EQU   CVTS01+540
CVTSTPRS EQU   CVTS01+536
CVT0PT02 EQU   CVTS01+532
CVTDARCM EQU   CVTS01+528
CVTIRECM EQU   CVTS01+524
CVTJRECM EQU   CVTS01+520
CVTVEMS0 EQU   CVTS01+516
CVTSPFRR EQU   CVTS01+512
CVTRLSTG EQU   CVTS01+508
CVT0TC0A EQU   CVTS01+504
CVTGMBR  EQU   CVTS01+500
CVTLFRM  EQU   CVTS01+496
CVTVIOP  EQU   CVTS01+488
CVTRV307 EQU   CVTS01+486
CVTRV306 EQU   CVTS01+484
CVTRV305 EQU   CVTS01+482
CVTRV304 EQU   CVTS01+480
CVTRV303 EQU   CVTS01+478
CVTRV302 EQU   CVTS01+476
CVTTRCA  EQU   CVTS01+472
CVTRV297 EQU   CVTRV289
CVTRV296 EQU   CVTRV289
CVTRV295 EQU   CVTRV289
CVTRV294 EQU   CVTRV289
CVTRV293 EQU   CVTRV289
CVTRV292 EQU   CVTRV289
CVTRV291 EQU   CVTRV289
CVTRV290 EQU   CVTRV289
CVTRV288 EQU   CVTRV280
CVTRV287 EQU   CVTRV280
CVTRV286 EQU   CVTRV280
CVTRV285 EQU   CVTRV280
CVTRV284 EQU   CVTRV280
CVTRV283 EQU   CVTRV280
CVTRV282 EQU   CVTRV280
CVTRV281 EQU   CVTRV280
CVTRV279 EQU   CVTRV271
CVTRV278 EQU   CVTRV271
CVTRV277 EQU   CVTRV271
CVTRV276 EQU   CVTRV271
CVTRV275 EQU   CVTRV271
CVTRV274 EQU   CVTRV271
CVTRV273 EQU   CVTRV271
CVTRV272 EQU   CVTRV271
CVTRV270 EQU   CVTRV262
CVTRV269 EQU   CVTRV262
CVTRV268 EQU   CVTRV262
CVTRV267 EQU   CVTRV262
CVTRV266 EQU   CVTRV262
CVTRV265 EQU   CVTRV262
CVTRV264 EQU   CVTRV262
CVTRV263 EQU   CVTRV262
CVTVFP   EQU   CVTS01+464
CVTVSI   EQU   CVTS01+460
CVTVPSIB EQU   CVTS01+456
CVTMFACT EQU   CVTMFRTR
CVTMFCTL EQU   CVTS01+448
CVTPVBP  EQU   CVTS01+444
CVTPWI   EQU   CVTS01+440
CVTRV254 EQU   CVTS01+438
CVTRV253 EQU   CVTS01+436
CVTRV252 EQU   CVTS01+434
CVTRV251 EQU   CVTS01+433
CVTRV250 EQU   CVTS01+432
CVTRV249 EQU   CVTS01+431
CVTRV248 EQU   CVTS01+430
CVTRV247 EQU   CVTS01+429
CVTRV246 EQU   CVTS01+428
CVTRV245 EQU   CVTRV237
CVTRV244 EQU   CVTRV237
CVTRV243 EQU   CVTRV237
CVTRV242 EQU   CVTRV237
CVTRV241 EQU   CVTRV237
CVTRV240 EQU   CVTRV237
CVTRV239 EQU   CVTRV237
CVTRV238 EQU   CVTRV237
CVTRV236 EQU   CVTRV228
CVTRV235 EQU   CVTRV228
CVTRV234 EQU   CVTRV228
CVTRV233 EQU   CVTRV228
CVTRV232 EQU   CVTRV228
CVTRV231 EQU   CVTRV228
CVTRV230 EQU   CVTRV228
CVTRV229 EQU   CVTRV228
CVTRV227 EQU   CVTRV219
CVTRV226 EQU   CVTRV219
CVTRV225 EQU   CVTRV219
CVTRV224 EQU   CVTRV219
CVTRV223 EQU   CVTRV219
CVTRV222 EQU   CVTRV219
CVTRV221 EQU   CVTRV219
CVTRV220 EQU   CVTRV219
CVTRV218 EQU   CVTRV210
CVTRV217 EQU   CVTRV210
CVTRV216 EQU   CVTRV210
CVTRV215 EQU   CVTRV210
CVTRV214 EQU   CVTRV210
CVTRV213 EQU   CVTRV210
CVTRV212 EQU   CVTRV210
CVTRV211 EQU   CVTRV210
CVTLCCAT EQU   CVTS01+420
CVTPCCAT EQU   CVTS01+416
CVTIPCRP EQU   CVTS01+412
CVTIPCRI EQU   CVTS01+408
CVTIPCDS EQU   CVTS01+404
CVTAIDVT EQU   CVTS01+400
CVTSSAP  EQU   CVTS01+396
CVTEHCIR EQU   CVTS01+392
CVTEHDEF EQU   CVTS01+388
CVTDAIR  EQU   CVTS01+384
CVTPERFM EQU   CVTS01+380
CVT044R2 EQU   CVTS01+376
CVTFETCH EQU   CVTS01+372
CVTRSTWD EQU   CVTS01+368
CVTSPOST EQU   CVTS01+364
CVTIOBP  EQU   CVTS01+360
CVTASMVT EQU   CVTS01+356
CVTRECRQ EQU   CVTS01+352
CVTWSAC  EQU   CVTS01+348
CVTRV149 EQU   CVTS01+344
CVTWSAL  EQU   CVTS01+340
CVTSPSA  EQU   CVTS01+336
CVTGLMN  EQU   CVTS01+332
CVTVEAC0 EQU   CVTS01+328
CVT062R1 EQU   CVTS01+324
CVTRPOST EQU   CVTS01+320
CVTDQIQE EQU   CVTS01+316
CVTCSD   EQU   CVTS01+312
CVTLKRMA EQU   CVTS01+308
CVTRSPIE EQU   CVTS01+304
CVTRENQ  EQU   CVTS01+300
CVTLQCB  EQU   CVTS01+296
CVTFQCB  EQU   CVTS01+292
CVTQCS01 EQU   CVTS01+288
CVTAPFT  EQU   CVTS01+284
CVTPARRL EQU   CVTS01+280
CVTVWAIT EQU   CVTS01+276
CVTGSPL  EQU   CVTS01+272
CVTLSMQ  EQU   CVTS01+268
CVTGSMQ  EQU   CVTS01+264
CVTEXPRO EQU   CVTS01+260
CVTOPCTP EQU   CVTS01+256
CVTSIC   EQU   CVTS01+252
CVTTPIOS EQU   CVTS01+248
CVTRTMS  EQU   CVTS01+244
CVTSDBF  EQU   CVTS01+240
CVTSCBP  EQU   CVTS01+236
CVTSDMP  EQU   CVTS01+232
CVTSV60  EQU   CVTS01+228
CVTRTMCT EQU   CVTS01+224
CVTASCBL EQU   CVTS01+220
CVTASCBH EQU   CVTS01+216
CVTGDA   EQU   CVTS01+212
CVTASVT  EQU   CVTS01+208
CVTVVMDI EQU   CVTS01+204
CVTAQTOP EQU   CVTS01+200
CVTIOSCS EQU   CVTS01+196
CVTSDRM  EQU   CVTS01+192
CVTOPTE  EQU   CVTS01+188
CVTSTXU  EQU   CVTS01+184
CVTQUIS  EQU   CVTS01+180
CVTPARS  EQU   CVTS01+176
CVTS1EE  EQU   CVTS01+172
CVTFRAS  EQU   CVTS01+168
CVTQSAS  EQU   CVTS01+164
CVTCRAS  EQU   CVTS01+160
CVTDELCP EQU   CVTS01+152
CVTAUTHL EQU   CVTS01+136
CVTSCAN  EQU   CVTS01+132
CVTRV144 EQU   CVTS01+130
CVTMAXMP EQU   CVTS01+128
CVTSTCK  EQU   CVTS01+124
CVTRV139 EQU   CVTS01+123
CVTDSSAC EQU   CVTS01+122
CVTRV513 EQU   CVTS01+121
CVTIOSPL EQU   CVTS01+120
CVTPTGT  EQU   CVTS01+116
CVTCSPIE EQU   CVTS01+112
CVTSMFEX EQU   CVTS01+108
CVTOLT0A EQU   CVTS01+104
CVTSRBRT EQU   CVTS01+100
CVTPUTL  EQU   CVTS01+96
CVTASCRL EQU   CVTS01+92
CVTASCRF EQU   CVTS01+88
CVTRV326 EQU   CVTS01+84
CVTRV325 EQU   CVTS01+80
CVTRV324 EQU   CVTS01+76
CVT0VL01 EQU   CVTS01+72
CVTSHRVM EQU   CVTS01+68
CVTRV332 EQU   CVTS01+64
CVTTAS   EQU   CVTS01+60
CVTRSCN  EQU   CVTS01+56
CVTTRAC2 EQU   CVTS01+54
CVTTRACE EQU   CVTS01+52
CVTAPG   EQU   CVTS01+51
CVTSDTRC EQU   CVTCTLFG
CVTGTRCE EQU   CVTCTLFG
CVTNOMP  EQU   CVTCTLFG
CVTRSV79 EQU   CVTCTLFG
CVTDSTAT EQU   CVTCTLFG
CVTRSV78 EQU   CVTCTLFG
CVTRV333 EQU   CVTCTLFG
CVTRV323 EQU   CVTCTLFG
CVTSPVLK EQU   CVTS01+49
CVTRSV77 EQU   CVTS01+48
CVTRV331 EQU   CVTS01+44
CVTRV330 EQU   CVTS01+40
CVTRV329 EQU   CVTS01+36
CVTRV328 EQU   CVTS01+32
CVTRV322 EQU   CVTS01+28
CVTSLID  EQU   CVTSLIDA+1
CVTSYLK  EQU   CVTSLIDA
CVTRV321 EQU   CVTS01+20
CVTRV320 EQU   CVTS01+16
CVTLPDIR EQU   CVTLPDIA+1
CVTRSV69 EQU   CVTDIRST
CVTRSV68 EQU   CVTDIRST
CVTRSV67 EQU   CVTDIRST
CVTRSV66 EQU   CVTDIRST
CVTRSV65 EQU   CVTDIRST
CVTRSV64 EQU   CVTDIRST
CVTRSV63 EQU   CVTDIRST
CVTDICOM EQU   CVTDIRST
CVTPVTP  EQU   CVTS01+8
CVTLPDSR EQU   CVTS01+4
CVTGETL  EQU   CVTS01
@NM00031 EQU   UCBWGTX
@NM00030 EQU   UCBWGTX
@NM00029 EQU   UCBSTATX
UCBALOCX EQU   UCBSTATX
@NM00028 EQU   UCBSTATX
CONSPTR  EQU   @NM00013+1
CONSFLGS EQU   @NM00013
@NM00012 EQU   MSG143M2+66
@NM00011 EQU   MSG143M2+63
@NM00010 EQU   MSG143M2
@NM00009 EQU   MSG143M1+41
@NM00008 EQU   NEWCP+5
@NM00007 EQU   NEWCP
@NM00006 EQU   MSG143M1+25
@NM00005 EQU   OLDCP+5
@NM00004 EQU   OLDCP
@NM00003 EQU   MSG143M1
@NM00002 EQU   MSG142M+13
@NM00001 EQU   MSG142M
WQERSVC7 EQU   WMNM+184
WQERSVC6 EQU   WMNM+181
WQERSVC5 EQU   WMNMST2
WQERSVC4 EQU   WMNMST2
WQERSVC3 EQU   WMNMST2
WQERSVC2 EQU   WMNMST2
WQERSVC1 EQU   WMNMST2
WQERSVB9 EQU   WMNMST2
WQERSVB8 EQU   WMNMST2
WMNMTPD2 EQU   WMNMST2
WMNMTXT2 EQU   WMNM+108
WMNMHCT2 EQU   WMNM+104
WMNMTL2  EQU   WMNM+103
WQERSV74 EQU   WMNM+102
WQERSV73 EQU   WMNMLT2
WQERSV72 EQU   WMNMLT2
WQERSV71 EQU   WMNMLT2
WQERSV70 EQU   WMNMLT2
WMNMLT2D EQU   WMNMLT2
WMNMLT2C EQU   WMNMLT2
WMNMLT2B EQU   WMNMLT2
WMNMLT2A EQU   WMNMLT2
WMNMML2H EQU   WMNMML2
WMNMML2G EQU   WMNMML2
WQERSV69 EQU   WMNMML2
WMNMML2E EQU   WMNMML2
WMNMML2D EQU   WMNMML2
WMNMML2C EQU   WMNMML2
WMNMML2B EQU   WMNMML2
WQERSV68 EQU   WMNMML2
WMNMNX2  EQU   WMNM+97
WMNMUC2  EQU   WMNM+96
WQERSVB7 EQU   WMNM+88
WQERSVB6 EQU   WMNM+85
WQERSVB5 EQU   WMNMST1
WQERSVB4 EQU   WMNMST1
WQERSVB3 EQU   WMNMST1
WQERSVB2 EQU   WMNMST1
WQERSVB1 EQU   WMNMST1
WQERSVA9 EQU   WMNMST1
WQERSVA8 EQU   WMNMST1
WMNMTPD1 EQU   WMNMST1
WMNMTXT1 EQU   WMNM+12
WMNMHCT1 EQU   WMNM+8
WMNMTL1  EQU   WMNM+7
WQERSV67 EQU   WMNM+6
WQERSV66 EQU   WMNMLT1
WQERSV65 EQU   WMNMLT1
WQERSV64 EQU   WMNMLT1
WQERSV63 EQU   WMNMLT1
WMNMLT1C EQU   WMNMLT1
WMNMLT1B EQU   WMNMLT1
WMNMLT1A EQU   WMNMLT1
WMNMML1H EQU   WMNMML1
WMNMML1G EQU   WMNMML1
WMNMML1F EQU   WMNMML1
WMNMML1E EQU   WMNMML1
WMNMML1D EQU   WMNMML1
WMNMML1C EQU   WMNMML1
WMNMML1B EQU   WMNMML1
WQERSV62 EQU   WMNMML1
WMJMJTCB EQU   WMJM+188
WMJMDEC4 EQU   WMJMDEC+3
WMJMDEC3 EQU   WMJMDEC+2
WQERSV61 EQU   WMJMDEC2
WQERSV60 EQU   WMJMDEC2
WQERSV59 EQU   WMJMDEC2
WQERSV58 EQU   WMJMDEC2
WQERSV57 EQU   WMJMDEC2
WQERSV56 EQU   WMJMDEC2
WMJMDECJ EQU   WMJMDEC2
WMJMDECG EQU   WMJMDEC1
WMJMDECF EQU   WMJMDEC1
WMJMDECE EQU   WMJMDEC1
WMJMDECD EQU   WMJMDEC1
WMJMDECC EQU   WMJMDEC1
WMJMDECB EQU   WMJMDEC1
WMJMDECA EQU   WMJMDEC1
WQERSV54 EQU   WMJM+181
WMJMUID  EQU   WMJM+180
WMJMRCT4 EQU   WMJMRTC+3
WMJMRCT3 EQU   WMJMRTC+2
WQERSV53 EQU   WMJMRCT2
WMJMRCTO EQU   WMJMRCT2
WMJMRCTN EQU   WMJMRCT2
WMJMRCTM EQU   WMJMRCT2
WMJMRCTL EQU   WMJMRCT2
WMJMRCTK EQU   WMJMRCT2
WMJMRCTJ EQU   WMJMRCT2
WMJMRCTI EQU   WMJMRCT2
WMJMRCTH EQU   WMJMRCT1
WMJMRCTG EQU   WMJMRCT1
WMJMRCTF EQU   WMJMRCT1
WMJMRCTE EQU   WMJMRCT1
WMJMRCTD EQU   WMJMRCT1
WMJMRCTC EQU   WMJMRCT1
WMJMRCTB EQU   WMJMRCT1
WMJMRCTA EQU   WMJMRCT1
WMJMMT2  EQU   WMJMMT+1
WQERSV52 EQU   WMJMMT1
WQERSV51 EQU   WMJMMT1
WMJMMT1F EQU   WMJMMT1
WQERSV50 EQU   WMJMMT1
WMJMMT1D EQU   WMJMMT1
WQERSVA6 EQU   WMJMMT1
WMJMMT1B EQU   WMJMMT1
WMJMMT1A EQU   WMJMMT1
WQERSV11 EQU   WMJMCS2
WQERSV49 EQU   WMJMCS2
WMJMCS2F EQU   WMJMCS2
WQERSV48 EQU   WMJMCS2
WQERSV47 EQU   WMJMCS2
WMJMCS2C EQU   WMJMCS2
WMJMCS2B EQU   WMJMCS2
WMJMCS2A EQU   WMJMCS2
WMJMCS1H EQU   WMJMCS1
WMJMCS1G EQU   WMJMCS1
WMJMCS1F EQU   WMJMCS1
WMJMCS1E EQU   WMJMCS1
WMJMCS1D EQU   WMJMCS1
WMJMCS1C EQU   WMJMCS1
WMJMCS1B EQU   WMJMCS1
WMJMCS1A EQU   WMJMCS1
WMJMSEQ  EQU   WMJM+169
WMJMRTCT EQU   WMJM+168
WMJMTCB  EQU   WMJM+164
WQERSV45 EQU   WMJMBUF
WMJMBUFG EQU   WMJMBUF
WMJMBUFF EQU   WMJMBUF
WMJMBUFE EQU   WMJMBUF
WMJMBUFD EQU   WMJMBUF
WMJMBUFC EQU   WMJMBUF
WMJMBUFB EQU   WMJMBUF
WMJMBUFA EQU   WMJMBUF
WMJMASID EQU   WMJM+161
WMJMDSPH EQU   WMJMDSP
WMJMDSPG EQU   WMJMDSP
WMJMDSPF EQU   WMJMDSP
WMJMDSPE EQU   WMJMDSP
WMJMDSPD EQU   WMJMDSP
WMJMDSPC EQU   WMJMDSP
WMJMDSPB EQU   WMJMDSP
WMJMDSPA EQU   WMJMDSP
WQERSVA5 EQU   WMJM+156
WQERSVA4 EQU   WMJM+152
WQERSVD8 EQU   WMJM+149
WQERSVD7 EQU   WMJMECBF
WQERSVD6 EQU   WMJMECBF
WQERSVD5 EQU   WMJMECBF
WQERSVD4 EQU   WMJMECBF
WQERSVD3 EQU   WMJMECBF
WQERSVD2 EQU   WMJMECBF
WMJMMAJD EQU   WMJMECBF
WMJMWAIT EQU   WMJMECBF
WMJMMSGN EQU   WMJM+144
WMJMAECB EQU   WMJM+140
WMJMLTY2 EQU   WMJMLTYP+1
WQERSV38 EQU   WMJMLTY1
WQERSV37 EQU   WMJMLTY1
WQERSV36 EQU   WMJMLTY1
WQERSV35 EQU   WMJMLTY1
WMJMLTYC EQU   WMJMLTY1
WMJMLTYB EQU   WMJMLTY1
WMJMLTYA EQU   WMJMLTY1
WQERSV34 EQU   WMJM+132
WMJMCONS EQU   WMJM+124
WMJMSER2 EQU   WMJMSER+1
WQERSV33 EQU   WMJMSER1
WQERSV32 EQU   WMJMSER1
WQERSV31 EQU   WMJMSER1
WMJMSERE EQU   WMJMSER1
WMJMSERD EQU   WMJMSER1
WMJMSERC EQU   WMJMSER1
WMJMSERB EQU   WMJMSER1
WMJMSERA EQU   WMJMSER1
WQERSV30 EQU   WMJM+120
WQERSV29 EQU   WMJM+116
WMJMRESA EQU   WMJM+108
WNJNPAD3 EQU   WMJM+107
WMJMHCID EQU   WMJM+103
WMJMTXT  EQU   WMJM+31
WMJMPAD2 EQU   WMJM+30
WMJMJBNM EQU   WMJM+22
WMJMPAD1 EQU   WMJM+21
WMJMTSSS EQU   WMJMTS+6
WMJMTSP2 EQU   WMJMTS+5
WMJMTSMM EQU   WMJMTS+3
WMJMTSP1 EQU   WMJMTS+2
WMJMTSHH EQU   WMJMTS
WMJMPAD  EQU   WMJM+12
WMJMRR   EQU   WMJM+8
WMJMTXTL EQU   WMJM+6
WMJMAREA EQU   WMJM+5
WMJMMLWG EQU   WMJMMLW
WMJMMLWF EQU   WMJMMLW
WMJMMLWE EQU   WMJMMLW
WMJMMLWD EQU   WMJMMLW
WMJMMLWC EQU   WMJMMLW
WMJMMLWB EQU   WMJMMLW
WMJMMLWA EQU   WMJMMLW
WMJMNXT  EQU   WMJMEXTA
WMJMUC   EQU   WMJMEXT
WQERSV26 EQU   WQE+186
WQERSV25 EQU   WQEDC2
WQERSV24 EQU   WQEDC2
WQERSV23 EQU   WQEDC2
WQERSV22 EQU   WQEDC2
WQERSV21 EQU   WQEDC2
WQERSV20 EQU   WQEDC2
WQEDCJ   EQU   WQEDC2
WQEDCI   EQU   WQEDC2
WQEDCH   EQU   WQEDC1
WQEDCG   EQU   WQEDC1
WQEDCF   EQU   WQEDC1
WQEDCE   EQU   WQEDC1
WQEDCC   EQU   WQEDC1
WQEDCB   EQU   WQEDC1
WQEDCA   EQU   WQEDC1
WQERPYID EQU   WQE+182
WQERSV18 EQU   WQE+181
WQERSV17 EQU   WQE+178
WQERSV16 EQU   WQEROUT2
WQEROUTO EQU   WQEROUT2
WQEROUTN EQU   WQEROUT2
WQEROUTM EQU   WQEROUT2
WQEROUTL EQU   WQEROUT2
WQEROUTK EQU   WQEROUT2
WQEROUTJ EQU   WQEROUT2
WQEROUTI EQU   WQEROUT2
WQEROUTH EQU   WQEROUT1
WQEROUTG EQU   WQEROUT1
WQEROUTF EQU   WQEROUT1
WQEROUTE EQU   WQEROUT1
WQEROUTD EQU   WQEROUT1
WQEROUTC EQU   WQEROUT1
WQEROUTA EQU   WQEROUT1
WQERSV15 EQU   WQEMSGT1
WQERSV14 EQU   WQEMSGT1
WQEMSGTF EQU   WQEMSGT1
WQERSV13 EQU   WQEMSGT1
WQEMSGTD EQU   WQEMSGT1
WQEMSGTC EQU   WQEMSGT1
WQEMSGTB EQU   WQEMSGT1
WQEMSGTA EQU   WQEMSGT1
WQEMCSP  EQU   WQEMCSF2
WQEMCSO  EQU   WQEMCSF2
WQERSV10 EQU   WQEMCSF2
WQERSV09 EQU   WQEMCSF2
WQEMCSK  EQU   WQEMCSF2
WQEMCSJ  EQU   WQEMCSF2
WQEMCSI  EQU   WQEMCSF2
WQEMCSFF EQU   WQEMCSF1
WQEMCSE  EQU   WQEMCSF1
WQEMCSC  EQU   WQEMCSF1
WQERTCT  EQU   WQE+168
WQERSV07 EQU   WQEAVAIL
WQERSV06 EQU   WQEAVAIL
WQEBUFF  EQU   WQEAVAIL
WQEBUFB  EQU   WQEAVAIL
WQEBUFA  EQU   WQEAVAIL
WQEDOM   EQU   WQEXA
WQEWTOR  EQU   WQEXA
WQEORE   EQU   WQEXA
WQEPURGE EQU   WQEXA
WQEPAD3  EQU   WQE+159
WQETXTL  EQU   WQETXT+127
@NM00181 EQU   WQETXT
WQETSSS  EQU   WQETS+6
WQEPER2  EQU   WQETS+5
WQETSMM  EQU   WQETS+3
WQEPER1  EQU   WQETS+2
WQETSHH  EQU   WQETS
UCMEFRV1 EQU   UCMEFEXT+8
UCMEFSA1 EQU   UCMEFEXT+3
UCMEFLG2 EQU   UCMEFEXT+1
UCMEFLGH EQU   UCMEFLG1
UCMEFLGG EQU   UCMEFLG1
UCMEFLGF EQU   UCMEFLG1
UCMEFLGE EQU   UCMEFLG1
UCMEFLGD EQU   UCMEFLG1
UCMEFLGC EQU   UCMEFLG1
UCMPEDUM EQU   UCMPEXTA+60
UCMPELST EQU   UCMPEXTA+56
UCMPELEN EQU   UCMPEXTA+52
UCMPE1ST EQU   UCMPEXTA+48
UCMPRSV2 EQU   UCMPEXTA+20
UCMPRSV1 EQU   UCMPDM1+12
UCMPWQE  EQU   UCMPDM1
UCMPUCMP EQU   UCMPEXTA
UCMFELST EQU   UCMFEXTA+48
UCMFELEN EQU   UCMFEXTA+44
UCMFE1ST EQU   UCMFEXTA+40
UCMFRAD  EQU   UCMFRECB+1
UCMFRB0  EQU   UCMFRBYT
UCMFXECB EQU   UCMFECBL
UCMFRSV3 EQU   UCMFEXTA+20
UCMF80WQ EQU   UCMFEXTA+18
UCMF60WQ EQU   UCMFEXTA+16
UCMFRSV2 EQU   UCMFMGFS+4
UCMFRSV1 EQU   UCMFMGFS+2
UCMFFLG2 EQU   UCMFMGFS+1
UCMFBR07 EQU   UCMFFLG1
UCMFBR06 EQU   UCMFFLG1
UCMFBR05 EQU   UCMFFLG1
UCMFBR04 EQU   UCMFFLG1
UCMFBR03 EQU   UCMFFLG1
UCMFMSGN EQU   UCMFFLG1
UCMFMSGA EQU   UCMFFLG1
UCMFMSGE EQU   UCMFFLG1
UCMFUCMF EQU   UCMFEXTA
UCMDESCD EQU   UCMEXIT+132
UCMROUTC EQU   UCMEXIT+128
UCMMSTXT EQU   UCMEXIT
UCMRSV64 EQU   UCMLIST+76
UCMRCTA  EQU   UCMRCT+1
UCMRSV31 EQU   UCMSDS5
UCMRSV30 EQU   UCMSDS5
UCMRSV29 EQU   UCMSDS5
UCMDEVG  EQU   UCMDEVC
UCMDEVF  EQU   UCMDEVC
UCMDEVD  EQU   UCMDEVC
UCMDEVB  EQU   UCMDEVC
UCMDEVA  EQU   UCMDEVC
UCMXOR   EQU   UCMLIST+62
UCMMSG2  EQU   UCMMSG+1
UCMRSV27 EQU   UCMMSG1
UCMRSV26 EQU   UCMMSG1
UCMMSGF  EQU   UCMMSG1
UCMRSV71 EQU   UCMMSG1
UCMMSGD  EQU   UCMMSG1
UCMRSV70 EQU   UCMMSG1
UCMMSGB  EQU   UCMMSG1
UCMMSGA  EQU   UCMMSG1
UCMOAOEN EQU   UCMLIST+48
UCMRV007 EQU   UCMDISP2
UCMRV006 EQU   UCMDISP2
UCMRV005 EQU   UCMDISP2
UCMRV004 EQU   UCMDISP2
UCMRV003 EQU   UCMDISP2
UCMDISPH EQU   UCMDISP1
UCMAUTHB EQU   UCMAUTH+1
UCMRSV23 EQU   UCMAUTHA
UCMRSV22 EQU   UCMAUTHA
UCMRSV21 EQU   UCMAUTHA
UCMRSV20 EQU   UCMAUTHA
UCMRSV19 EQU   UCMAUTHA
UCMRSV18 EQU   UCMLIST+34
@NM00180 EQU   UCMXA+1
UCMRSV17 EQU   UCMATR
UCMRSV16 EQU   UCMATR
UCMAT04  EQU   UCMATR
UCMLF    EQU   UCMATR
UCMXF    EQU   UCMATR
UCMTD    EQU   UCMSTS
UCMTB    EQU   UCMSTS
UCMDECBA EQU   UCMEIL+20
UCMOECBA EQU   UCMEIL+16
UCMAECBA EQU   UCMEIL+12
UCMXECBA EQU   UCMEIL+8
UCMNIPTR EQU   UCMEIL+4
UCMRSV15 EQU   UCMEIL+3
UCMRTCT  EQU   UCMEIL+2
UCMRPYL  EQU   UCMEIL+1
@NM00179 EQU   UCMEIL
UCMRSV62 EQU   UCM+304
UCMRSV60 EQU   UCM+302
UCMRSV59 EQU   UCMRSV51
UCMRSV58 EQU   UCMRSV51
UCMRSV57 EQU   UCMRSV51
UCMRSV56 EQU   UCMRSV51
UCMRSV55 EQU   UCMRSV51
UCMRSV54 EQU   UCMRSV51
UCMRSV53 EQU   UCMRSV51
UCMRSV52 EQU   UCMRSV51
UCMRSV50 EQU   UCMRSV42
UCMRSV49 EQU   UCMRSV42
UCMRSV48 EQU   UCMRSV42
UCMRSV47 EQU   UCMRSV42
UCMRSV46 EQU   UCMRSV42
UCMRSV45 EQU   UCMRSV42
UCMRSV44 EQU   UCMRSV42
UCMRSV43 EQU   UCMRSV42
UCMJES3T EQU   UCM+296
UCMWAKUP EQU   UCM+292
UCMSWCH  EQU   UCM+284
UCMORECP EQU   UCM+272
UCMOECBT EQU   UCM+268
UCMOECBH EQU   UCM+264
UCMWECBT EQU   UCM+260
UCMWECBH EQU   UCM+256
UCMMBEND EQU   UCM+252
UCMRSV61 EQU   UCM+248
UCMRP2AD EQU   UCM+244
UCMWQLM1 EQU   UCM+238
UCMRV001 EQU   UCM+237
UCMRQLM1 EQU   UCM+236
UCMMBPTR EQU   UCM+232
UCMMQNXT EQU   UCM+228
UCMMQEND EQU   UCM+224
UCMMQPTR EQU   UCM+220
UCMTRECB EQU   UCM+216
UCMMNECB EQU   UCM+212
UCMR9SV  EQU   UCM+204
UCMSAVE4 EQU   UCM+140
UCMRSV77 EQU   UCM+84
UCMRSV76 EQU   UCM+71
UCMRSV67 EQU   UCM+70
UCMRSV75 EQU   UCM+69
UCMFIX   EQU   UCMMODE
UCMMCS   EQU   UCMMODE
UCMOGCE  EQU   UCMMODE
UCMRSV14 EQU   UCMMODE
UCMTPUTA EQU   UCMMODE
UCMRSV66 EQU   UCMMODE
UCMRSV11 EQU   UCMMODE
UCMRQNR  EQU   UCM+56
UCMWQECB EQU   UCM+52
UCMRQECB EQU   UCM+48
UCMWQLM  EQU   UCM+46
UCMRQLM  EQU   UCM+45
@NM00178 EQU   UCMRPYI
UCMARECB EQU   UCM+16
UCMLECB  EQU   UCMDECB
UCMAECB  EQU   UCM+4
UCMXECB  EQU   UCM
UCMRSV65 EQU   UCMPRFX+158
UCMSDS2  EQU   UCMPRFX+157
UCMRSV09 EQU   UCMSDS1
UCMRSV08 EQU   UCMSDS1
UCMRSV07 EQU   UCMSDS1
UCMRSV06 EQU   UCMSDS1
UCMRSV05 EQU   UCMSDS1
UCMRSV04 EQU   UCMSDS1
UCMSDS1B EQU   UCMSDS1
UCMSDS1A EQU   UCMSDS1
UCMRSV72 EQU   UCMPRFX+152
UCMLOGAD EQU   UCMPRFX+148
UCMNPECB EQU   UCMPRFX+144
UCMRSV69 EQU   UCMPRFX+140
UCM6WD   EQU   UCMXSA+20
UCM5WD   EQU   UCMXSA+16
UCM4WD   EQU   UCMXSA+12
UCM3WD   EQU   UCMXSA+8
UCM2WD   EQU   UCMXSA+4
UCM1WD   EQU   UCMXSA
UCMRSV03 EQU   UCMPRFX+102
UCMHRDRT EQU   UCMPRFX+100
UCMXCT   EQU   UCMPRFX+96
UCMOWTOR EQU   UCMPRFX+86
UCMSYSO  EQU   UCMSFLG2
UCMSYSN  EQU   UCMSFLG2
UCMSYSM  EQU   UCMSFLG2
UCMSYSK  EQU   UCMSFLG2
UCMRSV35 EQU   UCMSFLG1
UCMSYSF  EQU   UCMSFLG1
UCMSYSC  EQU   UCMSFLG1
UCMSYSB  EQU   UCMSFLG1
UCMRSV01 EQU   UCMSFLG1
UCMWTOX  EQU   UCMPRFX+80
UCMDOME  EQU   UCMPRFX+76
UCMSVR0  EQU   UCMSAVE0+68
UCMSVQ0  EQU   UCMSAVE0+64
UCMSVP0  EQU   UCMSAVE0+60
UCMSVO0  EQU   UCMSAVE0+56
UCMSVN0  EQU   UCMSAVE0+52
UCMSVM0  EQU   UCMSAVE0+48
UCMSVL0  EQU   UCMSAVE0+44
UCMSVK0  EQU   UCMSAVE0+40
UCMSVJ0  EQU   UCMSAVE0+36
UCMSVI0  EQU   UCMSAVE0+32
UCMSVH0  EQU   UCMSAVE0+28
UCMSVG0  EQU   UCMSAVE0+24
UCMSVF0  EQU   UCMSAVE0+20
UCMSVE0  EQU   UCMSAVE0+16
UCMSVD0  EQU   UCMSAVE0+12
UCMSVC0  EQU   UCMSAVE0+8
UCMSVB0  EQU   UCMSAVE0+4
UCMSVA0  EQU   UCMSAVE0
UCMRSV74 EQU   UCM2EXT+20
UCMRSV73 EQU   UCM2EXT+16
UCM2FEXT EQU   UCM2EXT+12
UCM2STAA EQU   UCM2STA+1
UCMRV008 EQU   UCM2SFLG
UCMRSV34 EQU   UCM2SFLG
UCMRSV33 EQU   UCM2SFLG
UCM2WTOI EQU   UCM2SFLG
UCM2DSTR EQU   UCM2SFLG
UCM2DTAK EQU   UCM2SFLG
UCM2SENT EQU   UCM2SFLG
UCM2SDWA EQU   UCM2SFLG
UCM2PST  EQU   UCM2EXT+4
UCM2RID  EQU   UCM2EXT+2
UCM2WID  EQU   UCM2EXT
UCBERADR EQU   UCBUCS+12
UCBFCBID EQU   UCBUCS+8
UCBERCNT EQU   UCBUCS+7
UCBRSV51 EQU   UCBUCS+6
UCBFCBPE EQU   UCBFCBOP
UCBRSV49 EQU   UCBFCBOP
UCBRSV48 EQU   UCBFCBOP
UCBRSV47 EQU   UCBFCBOP
UCBRSV46 EQU   UCBFCBOP
UCBRSV45 EQU   UCBFCBOP
UCBRSV44 EQU   UCBFCBOP
UCBFCBO1 EQU   UCBFCBOP
UCBUCSPE EQU   UCBUCSOP
UCBRSV43 EQU   UCBUCSOP
UCBRSV42 EQU   UCBUCSOP
UCBRSV41 EQU   UCBUCSOP
UCBRSV40 EQU   UCBUCSOP
UCBRSV39 EQU   UCBUCSOP
UCBUCSO2 EQU   UCBUCSOP
UCBUCSO1 EQU   UCBUCSOP
UCBUCSID EQU   UCBUCS
UCBMDRBA EQU   UCBMDRBF+1
UCBRV075 EQU   UCBMDRBF
UCBRV074 EQU   UCB3800X+32
UCBIMAGE EQU   UCB3800X+28
UCBFCBNM EQU   UCB3800X+24
UCBCHAR4 EQU   UCB3800X+20
UCBCHAR3 EQU   UCB3800X+16
UCBCHAR2 EQU   UCB3800X+12
UCBCHAR1 EQU   UCB3800X+8
UCBCGMID EQU   UCB3800X+4
UCBBRSTA EQU   UCBACTIV
UCBRV063 EQU   UCBACTIV
UCBRV062 EQU   UCBACTIV
UCBRV061 EQU   UCBACTIV
UCBRV060 EQU   UCBACTIV
UCBRV059 EQU   UCBACTIV
UCBRV058 EQU   UCBACTIV
UCBRV057 EQU   UCBACTIV
UCBRV050 EQU   UCB3800X+2
UCBCGMNO EQU   UCB3800X+1
UCBRV083 EQU   UCBOPTNS
UCBBRSTR EQU   UCBOPTNS
UCBRV056 EQU   UCBOPTNS
UCBRV055 EQU   UCBOPTNS
UCBRV054 EQU   UCBOPTNS
UCBRV053 EQU   UCBOPTNS
UCBRV052 EQU   UCBOPTNS
UCBRV051 EQU   UCBOPTNS
UCBRV073 EQU   UCB3540X+7
UCBRV072 EQU   UCBDKBYT
UCBRV071 EQU   UCBDKBYT
UCBRV070 EQU   UCBDKBYT
UCBRV069 EQU   UCBDKBYT
UCBRV068 EQU   UCBDKBYT
UCBRV067 EQU   UCBDKBYT
UCBVLVER EQU   UCBDKBYT
UCBDKAMX EQU   UCBDKBYT
UCBVLSER EQU   UCB3540X
UCBRDATA EQU   UCBOCR+4
UCBFRID  EQU   UCBOCR
UCBCLN   EQU   UCBMT+14
UCBERG   EQU   UCBMT+12
UCBMS    EQU   UCBMT+11
UCBNB    EQU   UCBMT+10
UCBPW    EQU   UCBMT+9
UCBPR    EQU   UCBMT+8
UCBSIO   EQU   UCBMT+6
UCBTW    EQU   UCBMT+5
UCBTR    EQU   UCBMT+4
UCBTWT   EQU   UCBMT+3
UCBTRT   EQU   UCBMT+2
UCBCTD   EQU   UCBMT
UCBWTOID EQU   UCBCMEXT+17
UCBMIHTI EQU   UCBCMEXT+16
UCBASID  EQU   UCBCMEXT+14
UCBMFCNT EQU   UCBCMEXT+12
UCBPMSK  EQU   UCBCMEXT+10
UCBCCWOF EQU   UCBCMEXT+8
UCBRV041 EQU   UCBCMEXT+6
UCBRV036 EQU   UCBFLP1
UCBRV035 EQU   UCBFLP1
UCBERLOG EQU   UCBFLP1
UCBRV033 EQU   UCBFLP1
UCBINHIO EQU   UCBFLP1
UCBNSWAP EQU   UCBFLP1
UCBSHRUP EQU   UCBFLP1
UCBNSRCH EQU   UCBFLP1
UCBSNSCT EQU   UCBCMEXT+4
UCBHPDV  EQU   @NM00177
UCBHALI  EQU   @NM00177
UCBRSV09 EQU   @NM00177
UCBRSV08 EQU   @NM00177
UCBRSV07 EQU   @NM00177
UCBRSV06 EQU   @NM00177
UCBRSV05 EQU   @NM00177
UCBRSV04 EQU   @NM00177
UCBDTI   EQU   UCBCMEXT+2
UCBSTI   EQU   UCBCMEXT+1
UCBETI   EQU   UCBCMEXT
UCBEXTP  EQU   UCBEXTPT+1
UCBDDRSW EQU   UCBFLC
UCBTICBT EQU   UCBFLC
UCBIVRR  EQU   UCBFLC
UCBIVRS  EQU   UCBFLC
UCBITF   EQU   UCBFLC
UCBUDE   EQU   UCBFLC
UCBWAA   EQU   UCBFLC
UCBATTP  EQU   UCBFLC
UCBUNTYP EQU   UCBTBYT4
UCBRSV11 EQU   UCBDVCLS
UCBRSV10 EQU   UCBDVCLS
UCB3CHAR EQU   UCBDVCLS
UCB3UREC EQU   UCBDVCLS
UCB3DISP EQU   UCBDVCLS
UCB3DACC EQU   UCBDVCLS
UCB3TAPE EQU   UCBDVCLS
UCBDVPWR EQU   UCB2OPT7
UCBVLPWR EQU   UCB2OPT6
UCB2OPT5 EQU   UCBTBYT2
UCBRVDEV EQU   UCBRWTAU
UCBRPS   EQU   UCBDUDN2
UCBRR    EQU   UCBDUDN1
UCB2OPT1 EQU   UCBTBYT2
UCB2OPT0 EQU   UCBTBYT2
UCB1FEA7 EQU   UCBTBYT1
UCBD6250 EQU   UCB1FEA6
UCBD1600 EQU   UCB1FEA5
UCB1FEA4 EQU   UCBTBYT1
UCB1FEA3 EQU   UCBTBYT1
UCB1FEA2 EQU   UCBTBYT1
UCB1FEA1 EQU   UCBTBYT1
UCB1FEA0 EQU   UCBTBYT1
UCBRV029 EQU   UCBWGT
UCBVORSN EQU   UCBWGT
UCBMTPXP EQU   UCBWGT
UCBREW   EQU   UCBWGT
UCBPUB   EQU   UCBWGT
UCBOUT   EQU   UCBWGT
UCBIN    EQU   UCBWGT
UCBCPU   EQU   UCBOB+11
UCBLCI   EQU   UCBOB+10
UCBCNT   EQU   UCBOB+9
UCBRV017 EQU   UCBCHM1
UCBRV016 EQU   UCBCHM1
UCBRV015 EQU   UCBCHM1
UCBRV014 EQU   UCBCHM1
UCBSPB   EQU   UCBPTH1
UCBPPB   EQU   UCBPTH1
UCBSPA   EQU   UCBPTH0
UCBPPA   EQU   UCBPTH0
UCBSIGP  EQU   UCBFLB
UCBVALPH EQU   UCBFLB
UCBCRHSN EQU   UCBFLB
UCBCRHRV EQU   UCBFLB
UCBRESVH EQU   UCBFLB
UCBSPST  EQU   UCBFLB
UCBASNS  EQU   UCBFLB
UCBIORST EQU   UCBFLB
UCBQISCE EQU   UCBFL1
UCBACTV  EQU   UCBFL1
UCBSAP   EQU   UCBFL1
UCBNOTRC EQU   UCBCUB
UCBPSNS  EQU   UCBFL1
UCBUSING EQU   UCBPST
UCBNOTRD EQU   UCBNRY
UCBBUSYD EQU   UCBBSY
UCBUA    EQU   UCBCHAN+1
UCBCHA   EQU   UCBCHAN
UCBDADI  EQU   UCBSTAT
UCBPRES  EQU   UCBSTAT
UCBUNLD  EQU   UCBSTAT
UCBRESV  EQU   UCBSTAT
UCBCHGS  EQU   UCBSTAT
UCBID    EQU   UCBOB+2
UCBALTPH EQU   UCBFL5
UCBALTCU EQU   UCBFL5
UCBENVRD EQU   UCBFL5
UCBVSDR  EQU   UCBFL5
UCBSASK  EQU   UCBFL5
UCBAMV   EQU   UCBAF
UCBDCC   EQU   UCBFL5
UCBMONT  EQU   UCBJBNR
UCBRV011 EQU   UCBJBNR
UCBMMSGP EQU   UCBJBNR
UCBOLDSM EQU   UCBJBNR
UCBRV003 EQU   UCBJBNR
UCBDUC   EQU   UCBJBNR
UCBJES3  EQU   UCBJBNR
UCBVRDEV EQU   UCBJBNR
UCBCMSEG EQU   UCBOB
UCBPFXND EQU   UCB+512
UCBIOQ   EQU   UCB+508
UCBLOCK  EQU   UCB+504
UCBPXST  EQU   UCB+504
@NM00174 EQU   UCB
@NM00173 EQU   TCBXTNT2+32
TCBRV181 EQU   TCBRV173
TCBRV180 EQU   TCBRV173
TCBRV179 EQU   TCBRV173
TCBRV178 EQU   TCBRV173
TCBRV177 EQU   TCBRV173
TCBRV176 EQU   TCBRV173
TCBRV175 EQU   TCBRV173
TCBRV174 EQU   TCBRV173
TCBRV172 EQU   TCBRV164
TCBRV171 EQU   TCBRV164
TCBRV170 EQU   TCBRV164
TCBRV169 EQU   TCBRV164
TCBRV168 EQU   TCBRV164
TCBRV167 EQU   TCBRV164
TCBRV166 EQU   TCBRV164
TCBRV165 EQU   TCBRV164
TCBRV163 EQU   TCBRV155
TCBRV162 EQU   TCBRV155
TCBRV161 EQU   TCBRV155
TCBRV160 EQU   TCBRV155
TCBRV159 EQU   TCBRV155
TCBRV158 EQU   TCBRV155
TCBRV157 EQU   TCBRV155
TCBRV156 EQU   TCBRV155
TCBRV154 EQU   TCBRV146
TCBRV153 EQU   TCBRV146
TCBRV152 EQU   TCBRV146
TCBRV151 EQU   TCBRV146
TCBRV150 EQU   TCBRV146
TCBRV149 EQU   TCBRV146
TCBRV148 EQU   TCBRV146
TCBRV147 EQU   TCBRV146
TCBRV145 EQU   TCBXTNT2+26
TCBRV144 EQU   TCBXTNT2+24
TCBCAUF  EQU   TCBXTNT2+20
TCBRV142 EQU   TCBXTNT2+16
TCBRSV49 EQU   TCBXTNT2+12
TCBEVENT EQU   TCBXTNT2+8
TCBRCMP  EQU   TCBXTNT2+5
TCBRSVAB EQU   TCBXTNT2+4
TCBGTFA  EQU   TCBGTF+1
TCBRSV47 EQU   TCBTFLG
TCBRSV46 EQU   TCBTFLG
TCBRSV45 EQU   TCBTFLG
TCBRSV44 EQU   TCBTFLG
TCBRSV43 EQU   TCBTFLG
TCBDSPIT EQU   TCBTFLG
TCBERRTN EQU   TCBTFLG
TCBASYNC EQU   TCBTFLG
@NM00172 EQU   TCB+296
TCBSVCA2 EQU   TCB+292
TCBSWASA EQU   TCB+288
TCBDBTB  EQU   TCB+284
TCBRPT   EQU   TCB+280
TCBRV141 EQU   TCBRV133
TCBRV140 EQU   TCBRV133
TCBRV139 EQU   TCBRV133
TCBRV138 EQU   TCBRV133
TCBRV137 EQU   TCBRV133
TCBRV136 EQU   TCBRV133
TCBRV135 EQU   TCBRV133
TCBRV134 EQU   TCBRV133
TCBRV132 EQU   TCBRV124
TCBRV131 EQU   TCBRV124
TCBRV130 EQU   TCBRV124
TCBRV129 EQU   TCBRV124
TCBRV128 EQU   TCBRV124
TCBRV127 EQU   TCBRV124
TCBRV126 EQU   TCBRV124
TCBRV125 EQU   TCBRV124
TCBRV123 EQU   TCBFBYT2
TCBRV122 EQU   TCBFBYT2
TCBECBNV EQU   TCBFBYT2
TCBSSSYN EQU   TCBFBYT2
TCBFPRAP EQU   TCBFBYT2
TCBFDW   EQU   TCBFBYT2
TCBFMW   EQU   TCBFBYT2
TCBCNCB  EQU   TCBFBYT2
TCBLLH   EQU   TCBFBYT1
TCBRV113 EQU   TCBFBYT1
TCBEOT   EQU   TCBFBYT1
TCBRTM2  EQU   TCBFBYT1
TCBPGNLY EQU   TCBFBYT1
TCBNDIOS EQU   TCBFBYT1
TCBRV327 EQU   TCBFBYT1
TCBEOTFM EQU   TCBFBYT1
TCBAFFN  EQU   TCB+274
TCBRV326 EQU   TCB+272
TCBUKYSP EQU   TCB+268
TCBMODE  EQU   TCBESTAE+3
TCBERTYP EQU   TCBESTAE+2
TCBRV314 EQU   TCBESTRM
TCBRV313 EQU   TCBESTRM
TCBRV312 EQU   TCBESTRM
TCBRV311 EQU   TCBESTRM
TCBRV310 EQU   TCBESTRM
TCBRV309 EQU   TCBESTRM
TCBRV308 EQU   TCBESTRM
TCBETERM EQU   TCBESTRM
TCBSCBKY EQU   TCBESTAE
TCBRTM12 EQU   TCB+260
TCBTCBID EQU   TCB+256
TCBSTAFX EQU   TCBSTAWA
TCBSWA   EQU   TCB+248
TCBFOEA  EQU   TCBFOE+1
TCBRSV42 EQU   TCBFOE
TCBCCPVI EQU   TCBXSCT+2
TCBRV325 EQU   TCBXSCT+1
TCBRV324 EQU   TCBXSCT1
TCBRV323 EQU   TCBXSCT1
TCBRV322 EQU   TCBXSCT1
TCBRV321 EQU   TCBXSCT1
TCBRV320 EQU   TCBXSCT1
TCBRV319 EQU   TCBXSCT1
TCBS3A   EQU   TCBXSCT1
TCBACTIV EQU   TCBXSCT1
TCBRSV41 EQU   TCB+239
TCBTID   EQU   TCB+238
TCBRSVAA EQU   TCB+237
TCBABCUR EQU   TCB+236
TCBTMSAV EQU   TCB+232
TCBIOTIM EQU   TCB+228
TCBRTWA  EQU   TCB+224
TCBBACK  EQU   TCB+220
TCBTIRB  EQU   TCB+216
TCBAECB  EQU   TCB+212
TCBEXT2A EQU   TCBEXT2+1
TCBRSV39 EQU   TCBEXT2
TCBSTMCT EQU   TCB+207
TCBSYSCT EQU   TCB+206
TCBRSV37 EQU   TCB+205
TCBEXSVC EQU   TCBDAR
TCBDARMS EQU   TCBDAR
TCBDARWT EQU   TCBDAR
TCBDARO  EQU   TCBDAR
TCBDARMC EQU   TCBDARC
TCBDARD  EQU   TCBDAR
TCBDARS  EQU   TCBDAR
TCBDARP  EQU   TCBDAR
TCBGTOFM EQU   TCBFLGS7
TCBADMP  EQU   TCBFLGS7
TCBRSTSK EQU   TCBFLGS7
TCBSVCS  EQU   TCBFLGS7
TCBSTACK EQU   TCBFLGS7
TCBRSV34 EQU   TCBFLGS7
TCBRSV33 EQU   TCBFLGS7
TCBGPECB EQU   TCBFLGS7
TCBNTJS  EQU   TCBFLGS6
TCBAPG   EQU   TCBFLGS6
TCBMIGR  EQU   TCBFLGS6
TCBRV303 EQU   TCBFLGS6
TCBSPVLK EQU   TCBFLGS6
TCBCPU   EQU   TCBFLGS6
TCBPIE17 EQU   TCBFLGS6
TCBRV    EQU   TCBFLGS6
TCBRSV79 EQU   TCBNDSP5
TCBRSV78 EQU   TCBNDSP5
TCBRSV77 EQU   TCBNDSP5
TCBRSV76 EQU   TCBNDSP5
TCBRSV75 EQU   TCBNDSP5
TCBRSV74 EQU   TCBNDSP5
TCBRSV95 EQU   TCBNDSP5
TCBRSV94 EQU   TCBNDSP5
TCBRSV93 EQU   TCBNDSP4
TCBRSV92 EQU   TCBNDSP4
TCBRSV91 EQU   TCBNDSP4
TCBRSV90 EQU   TCBNDSP4
TCBRSV89 EQU   TCBNDSP4
TCBRSV88 EQU   TCBNDSP4
TCBRSV87 EQU   TCBNDSP4
TCBRSV86 EQU   TCBNDSP4
TCBEXT1A EQU   TCBEXT1+1
TCBRSV32 EQU   TCBEXT1
TCBEXCPD EQU   TCB+192
TCBIOBRC EQU   TCB+188
TCBDDWTC EQU   TCB+186
TCBDDEXC EQU   TCB+184
TCBJSCBB EQU   TCBJSCB+1
@NM00171 EQU   TCBRECDE
TCBREC   EQU   TCBRECDE
TCBMDIDS EQU   TCB+176
TCBNDINT EQU   TCBNDSP3
TCBRSV27 EQU   TCBNDSP3
TCBRSV26 EQU   TCBNDSP3
TCBRSV25 EQU   TCBNDSP3
TCBRSV24 EQU   TCBNDSP3
TCBSRBND EQU   TCBNDSP3
TCBRV302 EQU   TCBNDSP3
TCBLJSND EQU   TCBNDSP3
TCBABE   EQU   TCBNDSP2
TCBDSS   EQU   TCBNDSP2
TCBOWAIT EQU   TCBNDSP2
TCBIWAIT EQU   TCBNDSP2
TCBNDTS  EQU   TCBNDSP2
TCBNDSVC EQU   TCBNDSP2
TCBSTPP  EQU   TCBNDSP2
TCBABD   EQU   TCBNDSP2
TCBRSV22 EQU   TCBNDSP1
TCBPIEND EQU   TCBNDSP1
TCBTPSP  EQU   TCBNDSP1
TCBDDRND EQU   TCBNDSP1
TCBRSPND EQU   TCBNDSP1
TCBRSTND EQU   TCBNDSP1
TCBDARPN EQU   TCBNDSP1
TCBDARTN EQU   TCBNDSP1
TCBNDSP0 EQU   TCBNDSP
TCBUSER  EQU   TCB+168
TCBTCTB  EQU   TCBTCT+1
TCBRSV9C EQU   TCBTCTGF
TCBRSV9B EQU   TCBTCTGF
TCBRSV9A EQU   TCBTCTGF
TCBRSV99 EQU   TCBTCTGF
TCBRSV98 EQU   TCBTCTGF
TCBRSV97 EQU   TCBTCTGF
TCBRSV20 EQU   TCBTCTGF
TCBSMFGF EQU   TCBTCTGF
TCBSTABB EQU   TCBSTAB+1
TCBSTCUR EQU   TCBNSTAE
TCBRV301 EQU   TCBNSTAE
TCBSYNCH EQU   TCBNSTAE
TCBHALT  EQU   TCBNSTAE
TCBPPSUP EQU   TCBNSTAE
TCB33E   EQU   TCBNSTAE
TCBQUIES EQU   TCBNSTAE
TCBSTABE EQU   TCBNSTAE
TCBAQE   EQU   TCB+156
TCBPQE   EQU   TCB+152
TCBTSDP  EQU   TCB+151
TCBTSLP  EQU   TCB+150
TCBSTPCT EQU   TCB+149
TCBCPUBN EQU   TCBTSFLG
TCBDYDSP EQU   TCBTSFLG
TCBRSV18 EQU   TCBTSFLG
TCBRSV17 EQU   TCBTSFLG
TCBTIOTG EQU   TCBTSFLG
TCBATT   EQU   TCBTSFLG
TCBSTPPR EQU   TCBTSFLG
TCBRV300 EQU   TCBTSTSK
TCBECB   EQU   TCB+144
TCBIQE   EQU   TCB+140
TCBLTC   EQU   TCB+136
TCBOTC   EQU   TCB+132
TCBNTC   EQU   TCB+128
TCBJSTCA EQU   TCBJSTCB+1
TCBRSV16 EQU   TCBJSTCB
TCBTQET  EQU   TCBTME
TCBTCB   EQU   TCB+116
TCBFSAB  EQU   TCBFSA+1
TCBQEL   EQU   TCBFSA
TCBGRS15 EQU   TCBGRS+60
TCBGRS14 EQU   TCBGRS+56
TCBGRS13 EQU   TCBGRS+52
TCBGRS12 EQU   TCBGRS+48
TCBGRS11 EQU   TCBGRS+44
TCBGRS10 EQU   TCBGRS+40
TCBGRS9  EQU   TCBGRS+36
TCBGRS8  EQU   TCBGRS+32
TCBGRS7  EQU   TCBGRS+28
TCBGRS6  EQU   TCBGRS+24
TCBGRS5  EQU   TCBGRS+20
TCBGRS4  EQU   TCBGRS+16
TCBGRS3  EQU   TCBGRS+12
TCBGRS2  EQU   TCBGRS+8
TCBGRS1  EQU   TCBGRS+4
TCBGRS0  EQU   TCBGRS
TCBJPQB  EQU   TCBJPQ+1
TCBRSV15 EQU   TCBPURGE
TCBRSV14 EQU   TCBPURGE
TCBRSV13 EQU   TCBPURGE
TCBRSV12 EQU   TCBPURGE
TCBRSV11 EQU   TCBPURGE
TCBRSV10 EQU   TCBPURGE
TCBRSV09 EQU   TCBPURGE
TCBJPQF  EQU   TCBPURGE
TCBJLB   EQU   TCB+40
TCBLLS   EQU   TCB+36
TCBDSP   EQU   TCB+35
TCBLMP   EQU   TCB+34
TCBPNDSP EQU   TCBFLGS5
TCBFCD1  EQU   TCBFLGS5
TCBSTP   EQU   TCBFLGS5
TCBSYS   EQU   TCBFLGS5
TCBANDSP EQU   TCBFLGS5
TCBPAGE  EQU   TCBFLGS5
TCBUXNDF EQU   TCBABWF
TCBFC    EQU   TCBFLGS5
TCBONDSP EQU   TCBFLGS4
TCBMPCND EQU   TCBFLGS4
TCBMPCVQ EQU   TCBFLGS4
TCBUXNDV EQU   TCBFLGS4
TCBHNDSP EQU   TCBFLGS4
TCBRQENA EQU   TCBFLGS4
TCBSER   EQU   TCBFLGS4
TCBNDUMP EQU   TCBFLGS4
TCBDWSTA EQU   TCBFLGS3
TCBRSV08 EQU   TCBFLGS3
TCBRSV07 EQU   TCBFLGS3
TCBRSV06 EQU   TCBFLGS3
TCBABGM  EQU   TCBFLGS3
TCBABTRM EQU   TCBFLGS3
TCBADINP EQU   TCBFLGS3
TCBFSM   EQU   TCBFLGS3
TCBFTS   EQU   TCBFLGS2
TCBFETXR EQU   TCBFLGS2
TCBFDSOP EQU   TCBFLGS2
TCBFJMC  EQU   TCBFLGS2
TCBFSMC  EQU   TCBFLGS2
TCBFABOP EQU   TCBFLGS2
TCBFSTI  EQU   TCBFLGS2
TCBFOINP EQU   TCBFLGS2
TCBFX    EQU   TCBFLGS1
TCBFS    EQU   TCBFLGS1
TCBFT    EQU   TCBFLGS1
TCBPDUMP EQU   TCBFLGS1
TCBNONPR EQU   TCBFLGS1
TCBFERA  EQU   TCBFLGS1
TCBFE    EQU   TCBFLGS1
TCBFA    EQU   TCBFLGS1
TCBZERO  EQU   TCBPKF
TCBFLAG  EQU   TCBPKF
TCBMSSB  EQU   TCBMSS+1
TCBRSV03 EQU   TCBMSS
TCBTRNB  EQU   TCBTRN+1
TCBRSV02 EQU   TCBABF
TCBOLTEP EQU   TCBABF
TCBTCP   EQU   TCBABF
TCBTCPP  EQU   TCBABF
TCBRSV01 EQU   TCBABF
TCBGRPH  EQU   TCBABF
TCBNOCHK EQU   TCBABF
TCBMOD91 EQU   TCBABF
TCBCMPC  EQU   TCBCMP+1
TCBRV318 EQU   TCBCMSG
TCBRV317 EQU   TCBCIND
TCBRV316 EQU   TCBCWTO
TCBCASID EQU   TCBCDBL
TCBNOCC  EQU   TCBSTCC
TCBDMPO  EQU   TCBCPP
TCBCSTEP EQU   TCBCMPF
TCBCREQ  EQU   TCBCMPF
TCBTIO   EQU   TCB+12
TCBDEB   EQU   TCB+8
TCBPIEA  EQU   TCBPIE+1
TCBPM    EQU   TCBPMASK
@NM00170 EQU   TCBPMASK
TCBFRS6  EQU   TCBFRS+24
TCBFRS4  EQU   TCBFRS+16
TCBFRS2  EQU   TCBFRS+8
TCBFRS0  EQU   TCBFRS
@NM00169 EQU   SCVTSECT+180
@NM00168 EQU   SCVTSECT+176
SCVTPIQE EQU   SCVTSECT+172
@NM00167 EQU   SCVTSECT+168
SCVTPTRM EQU   SCVTSECT+164
@NM00166 EQU   SCVTSECT+160
@NM00165 EQU   SCVTSECT+156
SCVTQCBR EQU   SCVTSECT+152
SCVTSTAT EQU   SCVTSECT+148
@NM00164 EQU   SCVTSECT+144
SCVTTQE  EQU   SCVTSECT+140
@NM00163 EQU   SCVTSECT+136
SCVTSVCT EQU   SCVTSECT+132
@NM00162 EQU   SCVTSECT+128
@NM00161 EQU   SCVTSECT+124
SCVTRXLQ EQU   SCVTSECT+120
@NM00160 EQU   SCVTSECT+116
@NM00159 EQU   SCVTSECT+108
@NM00158 EQU   SCVTSECT+104
@NM00157 EQU   SCVTSECT+100
@NM00156 EQU   SCVTSECT+96
SCVTCOMM EQU   SCVTSECT+92
@NM00155 EQU   SCVTSECT+88
@NM00154 EQU   SCVTSECT+84
@NM00153 EQU   SCVTSECT+80
@NM00152 EQU   SCVTSECT+76
@NM00151 EQU   SCVTSECT+72
SCVTGMBR EQU   SCVTSECT+68
SCVTRPTR EQU   SCVTSECT+64
SCVTHSKP EQU   SCVTSECT+60
@NM00150 EQU   SCVTSECT+56
@NM00149 EQU   SCVTSECT+52
SCVTLFRM EQU   SCVTSECT+48
SCVTCDCL EQU   SCVTSECT+44
@NM00148 EQU   SCVTSECT+40
SCVTRACE EQU   SCVTSECT+36
@NM00147 EQU   SCVTSECT+32
SCVTRMBR EQU   SCVTSECT+28
@NM00146 EQU   SCVTSECT+24
@NM00145 EQU   SCVTSECT+20
@NM00144 EQU   SCVTSECT+16
@NM00143 EQU   SCVTSECT+14
SCVTBR14 EQU   SCVTSECT+12
SCVTSPET EQU   SCVTSECT+8
SCVTPGWR EQU   SCVTSECT+4
SCVTPGTM EQU   SCVTSECT
SVRBEND  EQU   RBSECT+192
RBFEPARM EQU   RBSECT+168
SIRBEND  EQU   RBSECT+168
RBRSV158 EQU   RBRSV150
RBRSV157 EQU   RBRSV150
RBRSV156 EQU   RBRSV150
RBRSV155 EQU   RBRSV150
RBRSV154 EQU   RBRSV150
RBRSV153 EQU   RBRSV150
RBRSV152 EQU   RBRSV150
RBRSV151 EQU   RBRSV150
RBRSV149 EQU   RBSECT+166
RBRSV148 EQU   RBSECT+164
RBRSV169 EQU   RBSDATA+3
RBSID    EQU   RBSDATA+2
RBSPKEY  EQU   RBSDATA+1
RBRSV168 EQU   RBSFLG3
RBSTERMO EQU   RBSFLG3
RBSBRNTR EQU   RBSFLG3
RBSPRNTR EQU   RBSFLG3
RBSCNCEL EQU   RBSFLG3
RBSRECRD EQU   RBSFLG3
RBSTERMI EQU   RBSFLG3
RBRSV167 EQU   RBSFLG3
RBSOWNRA EQU   RBSOWNR+1
RBSSUPER EQU   RBSFLGS2
RBSKEY0  EQU   RBSFLGS2
RBRSV166 EQU   RBSFLGS2
RBRSV165 EQU   RBSFLGS2
RBSINUSE EQU   RBSFLGS2
RBRSV164 EQU   RBSFLGS2
RBSXCTL2 EQU   RBSFLGS2
RBRSV163 EQU   RBSFLGS2
RBSPARMA EQU   RBSPARM+1
RBSHALT  EQU   RBSIOPRC
RBSNOIOP EQU   RBSIOPRC
RBSASYNC EQU   RBSFLGS1
RBRSV162 EQU   RBSFLGS1
RBSESTAE EQU   RBSFLGS1
RBSDUMMY EQU   RBSFLGS1
RBSSTAR  EQU   RBSFLGS1
RBSSTAI  EQU   RBSFLGS1
RBSEXIT  EQU   RBSCBB+4
RBSCHAIN EQU   RBSCBB
TIRBEND  EQU   @NM00141+8
PRBEND   EQU   @NM00141+8
RBRSV146 EQU   RBRSV138
RBRSV145 EQU   RBRSV138
RBRSV144 EQU   RBRSV138
RBRSV143 EQU   RBRSV138
RBRSV142 EQU   RBRSV138
RBRSV141 EQU   RBRSV138
RBRSV140 EQU   RBRSV138
RBRSV139 EQU   RBRSV138
RBRSV137 EQU   @NM00141+6
RBRSV136 EQU   @NM00141+4
RBRSV135 EQU   @NM00141
@NM00140 EQU   RBSECT+32
@NM00139 EQU   @NM00137+1
RBSCF    EQU   @NM00138
RBPGMQ1  EQU   RBPGMQ+1
@NM00136 EQU   RBPGMQ
@NM00135 EQU   RBSECT+16
@NM00134 EQU   @NM00130
@NM00133 EQU   @NM00130
RBIQETP  EQU   @NM00130
RBUSIQE  EQU   RBETXR
RBATTN   EQU   @NM00130
@NM00132 EQU   @NM00130
@NM00131 EQU   @NM00130
RBPMSVRB EQU   @NM00128
RBATNXIT EQU   @NM00128
@NM00129 EQU   @NM00128
RBWAITP  EQU   @NM00128
RBFNSVRB EQU   RBTRSVRB
RBFTP    EQU   @NM00128
RBSIZE   EQU   RBSECT+8
RBABOPSW EQU   RBSECT+4
RBPPSAV1 EQU   RBPPSAV+1
@NM00126 EQU   RBPPSAV
RBPRFXND EQU   RBPREFIX+64
RBINTCOD EQU   RBINTCDA+1
RBINLNTH EQU   RBINTCDA
RBWCSA   EQU   RBPREFIX+60
RBRSV004 EQU   RBPREFIX+57
RBSSSYN  EQU   RBFLAGS1
RBSCB    EQU   RBFLAGS1
RBLONGWT EQU   RBFLAGS1
RBASIR   EQU   RBFLAGS1
RBRSV159 EQU   RBFLAGS1
RBABEND  EQU   RBFLAGS1
RBXWAIT  EQU   RBFLAGS1
RBSLOCK  EQU   RBFLAGS1
RBRTRAN  EQU   RBRTPSW2+4
RBRTINCD EQU   RBRTICIL+2
RBRTILC  EQU   RBRTICIL+1
RBRSV160 EQU   RBRTICIL
RBRTPSW1 EQU   RBRTOPSW
RBRSV062 EQU   RBRSV054
RBRSV061 EQU   RBRSV054
RBRSV060 EQU   RBRSV054
RBRSV059 EQU   RBRSV054
RBRSV058 EQU   RBRSV054
RBRSV057 EQU   RBRSV054
RBRSV056 EQU   RBRSV054
RBRSV055 EQU   RBRSV054
RBRSV053 EQU   RBPREFIX+38
RBRSV052 EQU   RBPREFIX+36
RBRSV051 EQU   RBPREFIX+32
RBPRFXST EQU   RBPREFIX+32
RBRSV050 EQU   RBPREFIX+28
RBRSV049 EQU   RBRSV041
RBRSV048 EQU   RBRSV041
RBRSV047 EQU   RBRSV041
RBRSV046 EQU   RBRSV041
RBRSV045 EQU   RBRSV041
RBRSV044 EQU   RBRSV041
RBRSV043 EQU   RBRSV041
RBRSV042 EQU   RBRSV041
RBRSV040 EQU   RBPREFIX+26
RBRSV039 EQU   RBPREFIX+24
RBRSV038 EQU   RBPREFIX+20
RBRSV037 EQU   RBPREFIX+16
RBRSV036 EQU   RBRSV028
RBRSV035 EQU   RBRSV028
RBRSV034 EQU   RBRSV028
RBRSV033 EQU   RBRSV028
RBRSV032 EQU   RBRSV028
RBRSV031 EQU   RBRSV028
RBRSV030 EQU   RBRSV028
RBRSV029 EQU   RBRSV028
RBRSV027 EQU   RBRSV019
RBRSV026 EQU   RBRSV019
RBRSV025 EQU   RBRSV019
RBRSV024 EQU   RBRSV019
RBRSV023 EQU   RBRSV019
RBRSV022 EQU   RBRSV019
RBRSV021 EQU   RBRSV019
RBRSV020 EQU   RBRSV019
RBRSV018 EQU   RBPREFIX+13
RBRSV017 EQU   RBPREFIX+12
RBSRV016 EQU   RBPREFIX+11
RBRSV015 EQU   RBPREFIX+10
RBRSV014 EQU   RBPREFIX+8
RBRSV013 EQU   RBPREFIX+4
RBRSV012 EQU   RBPREFIX
RBEXSAVE EQU   XRBESA
XRBREG15 EQU   RBGRS15
XRBREG14 EQU   RBGRS14
XRBREG13 EQU   RBGRS13
XRBREG12 EQU   RBGRS12
XRBREG11 EQU   RBGRS11
XRBREG10 EQU   RBGRS10
XRBREG9  EQU   RBGRS9
XRBREG8  EQU   RBGRS8
XRBREG7  EQU   RBGRS7
XRBREG6  EQU   RBGRS6
XRBREG5  EQU   RBGRS5
XRBREG4  EQU   RBGRS4
XRBREG3  EQU   RBGRS3
XRBREG2  EQU   RBGRS2
XRBREG1  EQU   RBGRS1
XRBREG0  EQU   RBGRS0
XRBLNKA  EQU   RBLINKB
XRBWT    EQU   RBWCF
@NM00125 EQU   RBBASIC+24
RBOPSWPS EQU   RBOPSWB2
@NM00124 EQU   RBOPSWB2
@NM00123 EQU   XRBPSW
@NM00122 EQU   RBBASIC+12
XRBWAIT  EQU   RBECBWT
XRBFRRB  EQU   RBFDYN
@NM00121 EQU   XSTAB2
XRBACTV  EQU   RBFACTV
XRBTCBP  EQU   RBTCBNXT
@NM00120 EQU   XSTAB1
XRBCKPT  EQU   RBFTCKPT
@NM00119 EQU   XSTAB1
@NM00118 EQU   RBBASIC+8
@NM00117 EQU   RBEXRTNM+1
RBTMIND3 EQU   RBTMFLD
RBTMIND2 EQU   RBTMFLD
RBTMCMP  EQU   RBTMFLD
RBWLIM   EQU   RBTMFLD
RBRSV005 EQU   RBTMFLD
RBTMTOD  EQU   RBTMFLD
RBTMQUE  EQU   RBTMFLD
@NM00116 EQU   RBPRFX
OREOPBUF EQU   OREF+28
ORERSV11 EQU   OREF+26
OREASID  EQU   OREF+24
OREM     EQU   OREF+24
OREECBA  EQU   OREECB+1
ORETJID2 EQU   OREECB
ORERPYA  EQU   ORERPY+1
ORELNTH  EQU   ORERPY
ORETCBA  EQU   ORETCB+1
ORETJID1 EQU   ORETCB
ORERSV10 EQU   OREXC
ORERSV09 EQU   OREXC
ORERSV08 EQU   OREXC
OREBUFE  EQU   OREXC
OREBUFD  EQU   OREXC
OREBUFB  EQU   OREXC
OREBUFA  EQU   OREXC
ORERSV06 EQU   OREXA
ORERSV05 EQU   OREXA
ORERSV04 EQU   OREXA
ORERSV03 EQU   OREXA
ORESUSP  EQU   OREXA
ORESWAP  EQU   OREXA
OREKEY0  EQU   OREXA
ORERSV01 EQU   OREXA
OREID    EQU   OREF+4
MPLRSV10 EQU   MPL+6
MPLTYPE2 EQU   MPLTYPE+1
MPLRSV09 EQU   MPLTYPE1
MPLRSV08 EQU   MPLTYPE1
MPLSESS  EQU   MPLTYPE1
MPLRSV07 EQU   MPLTYPE1
MPLRSV06 EQU   MPLTYPE1
MPLRSV05 EQU   MPLTYPE1
MPLSTAT  EQU   MPLTYPE1
MPLJBNM  EQU   MPLTYPE1
MPLPROC2 EQU   MPLPROC+1
MPLRSV04 EQU   MPLPROC1
MPLRSV03 EQU   MPLPROC1
MPLRSV02 EQU   MPLPROC1
MPLRSV01 EQU   MPLPROC1
MPLSTRT  EQU   MPLPROC1
MPLTERM  EQU   MPLPROC1
@NM00089 EQU   FRRSFLGS+1
@NM00088 EQU   FRRSFLG1
FRRSNEST EQU   FRRSFLG1
FRRSRCUR EQU   FRRSFLG1
FRRSENTS EQU   FRRS+84
FRRSRTMW EQU   FRRS+16
DCMACBND EQU   DCMACB+40
DCMAPAD  EQU   DCMACLR+27
DCMATECB EQU   DCMACLR+23
DCMAUTME EQU   DCMATFLG+2
@NM00087 EQU   DCMATRCK
@NM00086 EQU   DCMATRCK
DCMATTSL EQU   DCMATRCK
DCMATTS  EQU   DCMATRCK
@NM00085 EQU   DCMATRCK
@NM00084 EQU   DCMATRCK
DCMATJBL EQU   DCMATRCK
DCMATJOB EQU   DCMATRCK
@NM00083 EQU   DCMADFLG
@NM00082 EQU   DCMADFLG
@NM00081 EQU   DCMADFLG
@NM00080 EQU   DCMADFLG
@NM00079 EQU   DCMADFLG
DCMACSIB EQU   DCMADFLG
DCMAHOLD EQU   DCMADFLG
DCMADD   EQU   DCMADFLG
@NM00078 EQU   DCMAFLG2
@NM00077 EQU   DCMAFLG2
@NM00076 EQU   DCMAFLG2
@NM00075 EQU   DCMAFLG2
DCMAMJFR EQU   DCMAFLG2
DCMARCON EQU   DCMAFLG2
DCMAWCON EQU   DCMAFLG2
DCMALMIN EQU   DCMAFLG2
@NM00074 EQU   DCMAFLG1
@NM00073 EQU   DCMAFLG1
DCMABL   EQU   DCMAFLG1
DCMAFULL EQU   DCMAFLG1
DCMAFRPR EQU   DCMAFLG1
DCMADEND EQU   DCMAFLG1
DCMADISP EQU   DCMAFLG1
@NM00072 EQU   DCMAFLG1
DCMAMT   EQU   DCMACLR+15
DCMATIME EQU   DCMACLR+11
DCMAMIN  EQU   DCMACLR+7
DCMAMJWQ EQU   DCMACLR+3
DCMAFR   EQU   DCMACLR+1
DCMAROW  EQU   DCMACLR
DCMATOP  EQU   DCMACB+8
DCMALN   EQU   DCMACB+6
DCMAGM   EQU   DCMASACB
DCMAUSE  EQU   DCMASACB
DCMAID   EQU   DCMACB+4
DCMACBNX EQU   DCMACB
DCMPLNPR EQU   DCMPACB+2
DCMPLN   EQU   DCMPACB
DCMMSGSV EQU   DCMTSRT+56
@NM00071 EQU   DCMTSRT+52
DCMRQDEL EQU   DCMTSRT+48
@NM00070 EQU   DCMTSRT+46
@NM00069 EQU   DCMR3FLG
@NM00068 EQU   DCMR3FLG
DCMRXHMT EQU   DCMR3FLG
DCMR3PKA EQU   DCMR3FLG
DCMRXSCN EQU   DCMR3FLG
DCMCLPR  EQU   DCMR3FLG
DCMKVIP  EQU   DCMR3FLG
@NM00067 EQU   DCMR2FLG
DCMRXTIM EQU   DCMR2FLG
@NM00066 EQU   DCMR2FLG
DCMRXDEL EQU   DCMR2FLG
DCMRXRLL EQU   DCMR2FLG
DCMRXTMR EQU   DCMR2FLG
DCMRXUNV EQU   DCMR2FLG
DCMRXSFL EQU   DCMR2FLG
DCMTMCTR EQU   DCMTSRT+42
DCMINTVL EQU   DCMTSRT+40
DCMADPFK EQU   DCMTSRT+36
DCMSUBAD EQU   DCMTSRT+32
DCMDOMKY EQU   DCMTSRT+30
DCMRMSAL EQU   DCMTSRT+28
DCMWLAST EQU   DCMTSRT+24
DCMADRMS EQU   DCMTSRT+21
DCMRMS   EQU   DCMTSRT+20
@NM00065 EQU   DCMDEVTY
@NM00064 EQU   DCMDEVTY
@NM00063 EQU   DCMDEVTY
@NM00062 EQU   DCMDEVTY
@NM00061 EQU   DCMDEVTY
@NM00060 EQU   DCMDEVTY
DCMTY50  EQU   DCMDEVTY
DCMTY60  EQU   DCMDEVTY
@NM00059 EQU   @NM00051
@NM00058 EQU   @NM00051
@NM00057 EQU   @NM00051
@NM00056 EQU   @NM00051
@NM00055 EQU   @NM00051
@NM00054 EQU   @NM00051
@NM00053 EQU   @NM00051
@NM00052 EQU   @NM00051
DCMTOPDS EQU   DCMTSRT+13
DCMTOPAR EQU   DCMTSRT+12
DCMADKP  EQU   DCMTSRT+8
DCMLEN   EQU   DCMTSRT+6
@NM00050 EQU   DCMRFLGS
@NM00049 EQU   DCMRFLGS
@NM00048 EQU   DCMRFLGS
DCMNIPP  EQU   DCMRFLGS
DCMDOM   EQU   DCMRFLGS
@NM00047 EQU   DCMRFLGS
@NM00046 EQU   DCMRFLGS
@NM00045 EQU   DCMRFLGS
@NM00044 EQU   DCMTSRT+4
DCMADTRN EQU   DCMTSRT
PARMRGAD EQU   PARMLIST+16
PARMRTAD EQU   PARMLIST+12
PARMCLAD EQU   PARMLIST+8
PARMSYAD EQU   PARMLIST+4
PARMCTBK EQU   PARMSTAT+3
PARMSYSR EQU   PARMSTAT+2
@NM00043 EQU   PARMFLAG
@NM00042 EQU   PARMFLAG
@NM00041 EQU   PARMFLAG
PARMWARG EQU   PARMFLAG
PARMFRID EQU   PARMFLAG
PARMRECU EQU   PARMFLAG
PARMCWT  EQU   PARMFLAG
PARMSDWA EQU   PARMFLAG
PARMFTPT EQU   PARMSTAT
CSAXD    EQU   CXSA+36
@NM00040 EQU   CSACODE
@NM00039 EQU   CSACODE
CSANPTR  EQU   CXSA
CQEENDA  EQU   CQE+21
CQEEND   EQU   CQE+20
@NM00038 EQU   CQE+4
CQEATTOP EQU   CQEFLAG
@NM00037 EQU   CQEFLAG
@NM00036 EQU   CQEEOB
CVTLEVL  EQU   CVTRELNO+2
CVTNUMB  EQU   CVTRELNO
CVTMDL   EQU   CVTFIX+250
@NM00035 EQU   CVTFIX+248
@NM00034 EQU   CVTFIX
CVTRV482 EQU   CVTXTNT2+128
CVTRV481 EQU   CVTXTNT2+124
CVTRV480 EQU   CVTXTNT2+120
CVTRV479 EQU   CVTXTNT2+118
CVTRV478 EQU   CVTXTNT2+117
CVTRV477 EQU   CVTXTNT2+116
CVTRV476 EQU   CVTXTNT2+115
CVTRV475 EQU   CVTXTNT2+114
CVTRV474 EQU   CVTRV466
CVTRV473 EQU   CVTRV466
CVTRV472 EQU   CVTRV466
CVTRV471 EQU   CVTRV466
CVTRV470 EQU   CVTRV466
CVTRV469 EQU   CVTRV466
CVTRV468 EQU   CVTRV466
CVTRV467 EQU   CVTRV466
CVTRV465 EQU   CVTRV457
CVTRV464 EQU   CVTRV457
CVTRV463 EQU   CVTRV457
CVTRV462 EQU   CVTRV457
CVTRV461 EQU   CVTRV457
CVTRV460 EQU   CVTRV457
CVTRV459 EQU   CVTRV457
CVTRV458 EQU   CVTRV457
CVTRV456 EQU   CVTXTNT2+108
CVTRV455 EQU   CVTXTNT2+104
CVTRV454 EQU   CVTXTNT2+100
CVTRV453 EQU   CVTXTNT2+96
CVTRV452 EQU   CVTXTNT2+94
CVTRV451 EQU   CVTXTNT2+92
CVTRV450 EQU   CVTXTNT2+90
CVTRV449 EQU   CVTXTNT2+88
CVTRV448 EQU   CVTXTNT2+87
CVTRV447 EQU   CVTXTNT2+86
CVTRV446 EQU   CVTRV438
CVTRV445 EQU   CVTRV438
CVTRV444 EQU   CVTRV438
CVTRV443 EQU   CVTRV438
CVTRV442 EQU   CVTRV438
CVTRV441 EQU   CVTRV438
CVTRV440 EQU   CVTRV438
CVTRV439 EQU   CVTRV438
CVTRV437 EQU   CVTRV429
CVTRV436 EQU   CVTRV429
CVTRV435 EQU   CVTRV429
CVTRV434 EQU   CVTRV429
CVTRV433 EQU   CVTRV429
CVTRV432 EQU   CVTRV429
CVTRV431 EQU   CVTRV429
CVTRV430 EQU   CVTRV429
CVTRV428 EQU   CVTXTNT2+80
CVTRV427 EQU   CVTXTNT2+76
CVTRV426 EQU   CVTXTNT2+72
CVTRV425 EQU   CVTXTNT2+68
CVTATACT EQU   CVTATCVT
CVTRV423 EQU   CVTXTNT2+62
CVTRV422 EQU   CVTXTNT2+60
CVTRV421 EQU   CVTXTNT2+58
CVTRV420 EQU   CVTXTNT2+56
CVTRV419 EQU   CVTXTNT2+55
CVTRV418 EQU   CVTXTNT2+54
CVTRV417 EQU   CVTRV409
CVTRV416 EQU   CVTRV409
CVTRV415 EQU   CVTRV409
CVTRV414 EQU   CVTRV409
CVTRV413 EQU   CVTRV409
CVTRV412 EQU   CVTRV409
CVTRV411 EQU   CVTRV409
CVTRV410 EQU   CVTRV409
CVTRV408 EQU   CVTRV400
CVTRV407 EQU   CVTRV400
CVTRV406 EQU   CVTRV400
CVTRV405 EQU   CVTRV400
CVTRV404 EQU   CVTRV400
CVTRV403 EQU   CVTRV400
CVTRV402 EQU   CVTRV400
CVTRV401 EQU   CVTRV400
CVTICB   EQU   CVTXTNT2+48
CVTSKTA  EQU   CVTXTNT2+44
CVTCCVT  EQU   CVTXTNT2+40
CVTRSV98 EQU   CVTXTNT2+36
CVTRSV97 EQU   CVTXTNT2+34
CVTRSV96 EQU   CVTXTNT2+32
CVTOLTEP EQU   CVTXTNT2+28
CVTQIDA  EQU   CVTQID+1
CVTRSV95 EQU   CVTQID
CVTRSV94 EQU   CVTXTNT2+20
CVTRSV93 EQU   CVTXTNT2+16
CVTRSV92 EQU   CVTXTNT2+12
CVTDEBVR EQU   CVTXTNT2+8
CVTRSV91 EQU   CVTXTNT2+6
CVTRSV9H EQU   CVTFLGBT
CVTRSV9G EQU   CVTFLGBT
CVTRSV9F EQU   CVTFLGBT
CVTRSV9E EQU   CVTFLGBT
CVTRSV9D EQU   CVTFLGBT
CVTRSV9C EQU   CVTFLGBT
CVTVME   EQU   CVTFLGBT
CVTNPE   EQU   CVTFLGBT
CVTNUCLS EQU   CVTXTNT2+4
CVTDSSVA EQU   CVTDSSV+1
CVTRSV89 EQU   CVTDSSV
CVTRSV88 EQU   CVTXTNT1+8
CVTRSV87 EQU   CVTXTNT1+4
CVTFACHN EQU   CVTXTNT1
CVTRV488 EQU   CVTMAP+412
CVTRV487 EQU   CVTMAP+408
CVTRV486 EQU   CVTMAP+404
CVTRV485 EQU   CVTMAP+400
CVTACTAP EQU   CVTMAP+396
CVTAUTH  EQU   CVTMAP+392
CVTATMCA EQU   CVTATMCT+1
CVTATMST EQU   CVTATMCT
CVTRSV61 EQU   CVTMAP+384
CVTVOLT1 EQU   CVTVOLM1+1
CVTVOLI1 EQU   CVTVOLF1
CVTSTOA  EQU   CVTMAP+376
CVTRSV58 EQU   CVTMAP+374
CVTRSV57 EQU   CVTMAP+372
CVTDDCE  EQU   CVTMAP+368
CVTPNWFR EQU   CVTMAP+364
CVTSMF   EQU   CVTMAP+360
CVTSULK  EQU   CVTMAP+358
CVTSLKO  EQU   CVTSYSK
CVTSLKP  EQU   CVTSYSK
CVTSLKQ  EQU   CVTSYSK
CVTSLKR  EQU   CVTSYSK
CVTRSV56 EQU   CVTSYSK
CVTRSV55 EQU   CVTSYSK
CVTRSV54 EQU   CVTSYSK
CVTRSV53 EQU   CVTSYSK
CVTRSV52 EQU   CVTA1F1
CVTRSV51 EQU   CVTA1F1
CVTRSV50 EQU   CVTA1F1
CVTRSV49 EQU   CVTA1F1
CVTRSV48 EQU   CVTA1F1
CVTRSV47 EQU   CVTA1F1
CVTSRSW  EQU   CVTA1F1
CVTPFSW  EQU   CVTA1F1
CVTPCVT  EQU   CVTMAP+352
CVTRSV46 EQU   CVTMAP+344
CVTRSV45 EQU   CVTMAP+340
CVTRSV44 EQU   CVTMAP+338
CVTRSV43 EQU   CVTMAP+336
CVTHJESA EQU   CVTHJES+1
CVTRSV42 EQU   CVTHJES
CVTEXT2A EQU   CVTEXT2+1
CVTRSV41 EQU   CVTEXT2
CVTAPFA  EQU   CVTAPF+1
CVTRSV40 EQU   CVTAPF
CVTRV518 EQU   CVTINTLA
CVTRV517 EQU   CVTERPV
CVTEORM  EQU   CVTMAP+312
CVTMCHPR EQU   CVTMAP+308
CVTTZ    EQU   CVTMAP+304
CVTJEPS  EQU   CVTMAP+300
CVTMODE  EQU   CVTMAP+292
CVTPTRV  EQU   CVTMAP+288
CVTREAL  EQU   CVTMAP+284
CVTRSV39 EQU   CVTMAP+280
CVTRSV38 EQU   CVTMAP+276
CVTDMSRA EQU   CVTDMSR+1
CVTRV634 EQU   CVTDMSRF
CVTRV633 EQU   CVTDMSRF
CVTRV632 EQU   CVTDMSRF
CVTRV631 EQU   CVTDMSRF
CVTRV630 EQU   CVTDMSRF
CVTRV629 EQU   CVTDMSRF
CVTUDUMP EQU   CVTDMSRF
CVTSDUMP EQU   CVTDMSRF
CVTQMSGA EQU   CVTQMSG+1
CVTRSV36 EQU   CVTQMSG
CVTAMFF  EQU   CVTMAP+264
CVTPURGA EQU   CVTPURG+1
CVTRSV35 EQU   CVTPURG
CVTCBSP  EQU   CVTMAP+256
CVTATERA EQU   CVTATER+1
CVTSYST  EQU   CVTATER
CVTVOLT2 EQU   CVTTAT
CVTVOLI2 EQU   CVTVOLF2
CVTAQAVB EQU   CVTAQAVT+1
CVTRSV34 EQU   CVTTCMFG
CVTRSV33 EQU   CVTTCMFG
CVTRSV32 EQU   CVTTCMFG
CVTRSV31 EQU   CVTTCMFG
CVTRSV30 EQU   CVTTCMFG
CVTRSV29 EQU   CVTTCMFG
CVTLDEV  EQU   CVTTCMFG
CVTTCRDY EQU   CVTTCMFG
CVTGTFA  EQU   CVTGTF+1
CVTRSV27 EQU   CVTGTFST
CVTRNIO  EQU   CVTGTFST
CVTUSR   EQU   CVTGTFST
CVTRV318 EQU   CVTFORM
CVTRV317 EQU   CVTTMODE
CVTRV316 EQU   CVTSTATE
CVTRV315 EQU   CVTGTFS
CVTGTFAV EQU   CVTGTFS
CVT0SCR1 EQU   CVTMAP+232
CVTRV515 EQU   CVTMAP+228
CVTRMS   EQU   CVTMAP+224
CVTPATCH EQU   CVTMAP+220
CVTTSCE  EQU   CVTMAP+216
CVTLNKSC EQU   CVTMAP+214
CVTQABST EQU   CVTMAP+212
CVTMDLDS EQU   CVTMAP+208
CVTUSER  EQU   CVTMAP+204
CVTSMCA  EQU   CVTMAP+196
CVTRSV18 EQU   CVTMAP+192
CVTQLPAQ EQU   CVTMAP+188
CVTQCDSR EQU   CVTMAP+184
CVTRSV17 EQU   CVTOPTB
CVTRSV16 EQU   CVTOPTB
CVTFP    EQU   CVTOPTB
CVTAPTHR EQU   CVTOPTB
CVTNLOG  EQU   CVTOPTB
CVTTOD   EQU   CVTOPTB
CVTCTIMS EQU   CVTOPTB
CVTPROT  EQU   CVTOPTB
CVTXPFP  EQU   CVTOPTA
CVTASCII EQU   CVTOPTA
CVTRSV13 EQU   CVTOPTA
CVTRSV12 EQU   CVTOPTA
CVTNIP   EQU   CVTOPTA
CVTDDR   EQU   CVTOPTA
CVTAPR   EQU   CVTOPTA
CVTCCH   EQU   CVTOPTA
CVTSNCTR EQU   CVTMAP+180
CVTQMWR  EQU   CVTMAP+176
CVTQOCR  EQU   CVTMAP+172
CVT1EF00 EQU   CVTMAP+168
CVTMZ00  EQU   CVTMAP+164
CVTSV76Q EQU   CVTSV76C
CVTRSV11 EQU   CVTMAP+156
CVT0PT01 EQU   CVTMAP+152
CVTMSER  EQU   CVTMAP+148
CVTRV516 EQU   CVTIERLC
CVTILCH  EQU   CVTMAP+140
CVT0DS   EQU   CVTMAP+136
CVTFBOSV EQU   CVTMAP+132
CVTNUCB  EQU   CVTMAP+128
CVTIXAVL EQU   CVTMAP+124
CVTSV76M EQU   CVTIOQET
CVTDCBA  EQU   CVTMAP+117
CVTMVS2  EQU   CVTDCB
CVT6DAT  EQU   CVTDCB
CVT4MPS  EQU   CVTDCB
CVTRSV09 EQU   CVTDCB
CVT4MS1  EQU   CVTDCB
CVT2SPS  EQU   CVTDCB
CVT1SSS  EQU   CVTDCB
CVTRSV08 EQU   CVTDCB
CVTSTB   EQU   CVTMAP+112
CVTQTD00 EQU   CVTMAP+108
CVTQTE00 EQU   CVTMAP+104
CVTSJQ   EQU   CVTMAP+96
CVTPBLDL EQU   CVTMAP+92
CVTTPC   EQU   CVTMAP+88
CVTSVDCB EQU   CVTMAP+84
CVTEXIT  EQU   CVTMAP+80
CVT0FN00 EQU   CVTMAP+76
CVTDARA  EQU   CVTDAR+1
CVTRSV07 EQU   CVTFLGS1
CVTRSV06 EQU   CVTFLGS1
CVTRSV05 EQU   CVTFLGS1
CVTRSV04 EQU   CVTFLGS1
CVTRSV03 EQU   CVTFLGS1
CVTRSV02 EQU   CVTFLGS1
CVTRSV01 EQU   CVTFLGS1
CVTDMPLK EQU   CVTFLGS1
CVTXITP  EQU   CVTMAP+68
CVTZDTAB EQU   CVTMAP+64
CVTMSLT  EQU   CVTMAP+60
CVTDATE  EQU   CVTMAP+56
CVTBTERM EQU   CVTMAP+52
CVTSYSAD EQU   CVTMAP+48
CVTXTLER EQU   CVTMAP+44
CVTILK2  EQU   CVTMAP+40
CVTILK1  EQU   CVTMAP+36
CVTPRLTV EQU   CVTMAP+32
CVTPCNVT EQU   CVTMAP+28
CVT0VL00 EQU   CVTMAP+24
CVTXAPG  EQU   CVTMAP+20
CVTBUF   EQU   CVTMAP+16
CVTJOB   EQU   CVTMAP+12
CVTLINK  EQU   CVTMAP+8
CVT0EF00 EQU   CVTMAP+4
CVTTCBP  EQU   CVTMAP
CVT      EQU   CVTMAP
ASCBEND  EQU   ASCB+208
ASCBSRBT EQU   ASCB+200
ASCBSWTL EQU   ASCB+196
ASCBRS14 EQU   ASCB+195
ASCBSMCT EQU   ASCB+194
ASCBRS12 EQU   ASCB+192
ASCBPCTT EQU   ASCB+188
ASCBVGTT EQU   ASCB+184
ASCBRV43 EQU   ASCBSRQ4
ASCBRV42 EQU   ASCBSRQ4
ASCBRV41 EQU   ASCBSRQ4
ASCBRV40 EQU   ASCBSRQ4
ASCBRV39 EQU   ASCBSRQ4
ASCBRV38 EQU   ASCBSRQ4
ASCBRV37 EQU   ASCBSRQ4
ASCBRV36 EQU   ASCBSRQ4
ASCBRV35 EQU   ASCBSRQ3
ASCBRV34 EQU   ASCBSRQ3
ASCBRV33 EQU   ASCBSRQ3
ASCBRV32 EQU   ASCBSRQ3
ASCBRV31 EQU   ASCBSRQ3
ASCBRV30 EQU   ASCBSRQ3
ASCBRV29 EQU   ASCBSRQ3
ASCBRV28 EQU   ASCBSRQ3
ASCBRV27 EQU   ASCBSRQ2
ASCBRV26 EQU   ASCBSRQ2
ASCBRV25 EQU   ASCBSRQ2
ASCBRV24 EQU   ASCBSRQ2
ASCBRV23 EQU   ASCBSRQ2
ASCBRV22 EQU   ASCBSRQ2
ASCBRV21 EQU   ASCBSRQ2
ASCBRV20 EQU   ASCBSRQ2
ASCBRV19 EQU   ASCBSRQ1
ASCBRV18 EQU   ASCBSRQ1
ASCBRV17 EQU   ASCBSRQ1
ASCBRV16 EQU   ASCBSRQ1
ASCBRV15 EQU   ASCBSRQ1
ASCBRV14 EQU   ASCBSRQ1
ASCBRV13 EQU   ASCBSRQ1
ASCBSTA  EQU   ASCBSRQ1
ASCBJBNS EQU   ASCB+176
ASCBJBNI EQU   ASCB+172
ASCBMCC  EQU   ASCB+168
ASCBRTWA EQU   ASCB+164
ASCBIQEA EQU   ASCB+160
ASCBXMPQ EQU   ASCB+156
ASCBRS01 EQU   ASCB+154
ASCBFMCT EQU   ASCB+152
ASCBOUXB EQU   ASCB+148
ASCBOUCB EQU   ASCB+144
ASCBMECB EQU   ASCB+140
ASCBQECB EQU   ASCB+136
ASCBLSQH EQU   ASCBLKGP+4
ASCBLOCK EQU   ASCBLKGP
ASCBTCBS EQU   ASCB+124
ASCBNVSC EQU   ASCB+122
ASCBVSC  EQU   ASCB+120
ASCBSRBS EQU   ASCB+118
ASCBSSRB EQU   ASCB+116
ASCBRV06 EQU   ASCBFLG2
ASCBRV05 EQU   ASCBFLG2
ASCBRV04 EQU   ASCBFLG2
ASCBSNQS EQU   ASCBFLG2
ASCBS2S  EQU   ASCBFLG2
ASCBCEXT EQU   ASCBFLG2
ASCBPXMT EQU   ASCBFLG2
ASCBXMPT EQU   ASCBFLG2
ASCBRF07 EQU   ASCBDSP1
ASCBRF06 EQU   ASCBDSP1
ASCBRF05 EQU   ASCBDSP1
ASCBRF04 EQU   ASCBDSP1
ASCBRF03 EQU   ASCBDSP1
ASCBRF02 EQU   ASCBDSP1
ASCBFAIL EQU   ASCBDSP1
ASCBNOQ  EQU   ASCBDSP1
ASCBSWCT EQU   ASCB+112
ASCBASXB EQU   ASCB+108
ASCBTMCH EQU   ASCB+104
ASCBNSWP EQU   ASCBFLG1
ASCBTYP1 EQU   ASCBFLG1
ASCBSTND EQU   ASCBFLG1
ASCBABNT EQU   ASCBFLG1
ASCBTERM EQU   ASCBFLG1
ASCBS3S  EQU   ASCBFLG1
ASCBCMSH EQU   ASCBFLG1
ASCBTOFF EQU   ASCBFLG1
ASCBRF01 EQU   ASCBRCTF
ASCBTMLW EQU   ASCBRCTF
ASCBOUT  EQU   ASCBRCTF
ASCBWAIT EQU   ASCBRCTF
ASCBRV08 EQU   ASCBRCTF
ASCBFQU  EQU   ASCBRCTF
ASCBFRS  EQU   ASCBRCTF
ASCBTMNO EQU   ASCBRCTF
ASCBAFFN EQU   ASCBFW1
ASCBDUMP EQU   ASCB+96
ASCBRV44 EQU   ASCB+92
ASCBUBET EQU   ASCB+88
ASCBECB  EQU   ASCB+84
ASCBJSTL EQU   ASCB+80
ASCBEWST EQU   ASCB+72
ASCBEJST EQU   ASCB+64
ASCBTSB  EQU   ASCB+60
ASCBCSCB EQU   ASCB+56
ASCBRSMA EQU   ASCBRSM+1
ASCBRV54 EQU   ASCBRSMF
ASCBRV53 EQU   ASCBRSMF
ASCBRV52 EQU   ASCBRSMF
ASCBRV51 EQU   ASCBRSMF
ASCBVEQR EQU   ASCBRSMF
ASCBN2LP EQU   ASCBRSMF
ASCB1LPU EQU   ASCBRSMF
ASCB2LPU EQU   ASCBRSMF
ASCBLDA  EQU   ASCB+48
ASCBSTOR EQU   ASCB+44
ASCBDP   EQU   ASCB+43
ASCBRV07 EQU   ASCB+42
ASCBIOSM EQU   ASCB+40
ASCBSEQN EQU   ASCB+38
ASCBASID EQU   ASCB+36
ASCBCPUS EQU   ASCB+32
ASCBSPL  EQU   ASCB+28
ASCBIOSP EQU   ASCB+24
ASCBSYNC EQU   ASCBSUPC+4
ASCBSVRB EQU   ASCBSUPC
ASCBCMSF EQU   ASCB+12
ASCBBWDP EQU   ASCB+8
ASCBFWDP EQU   ASCB+4
ASCBASCB EQU   ASCB
ASCBEGIN EQU   ASCB
JESSASTA EQU   JESCT+48
JESNUCBS EQU   JESCT+44
JESPJESN EQU   JESCT+28
JESSSCT  EQU   JESCT+24
JESRESQM EQU   JESCT+16
JESQMGR  EQU   JESCT+12
JESUNITS EQU   JESCT+4
@NM00033 EQU   JESCT
@NM00115 EQU   PSA+3668
PSASTAK  EQU   PSA+3072
@NM00114 EQU   PSA+1048
PSAUSEND EQU   PSA+1048
PSARV062 EQU   PSA+1044
PSACDAL  EQU   PSA+1040
PSAWTCOD EQU   PSA+1036
PSAATCVT EQU   PSA+1032
PSAPCPSW EQU   PSA+1024
PSAPIR2  EQU   PSA+1020
PSARV059 EQU   PSA+1018
PSASVC13 EQU   PSA+1016
PSASFACC EQU   PSA+1008
PSASTOP  EQU   PSA+992
PSASTART EQU   PSA+976
PSARSPSW EQU   PSA+968
PSASRPSW EQU   PSA+960
PSARV045 EQU   PSA+892
PSARV044 EQU   PSA+888
PSARV043 EQU   PSA+884
PSARV042 EQU   PSA+880
PSARV041 EQU   PSA+876
PSARV040 EQU   PSA+872
PSARV025 EQU   PSA+868
PSADSSED EQU   PSA+868
PSADSSPR EQU   PSA+864
PSADSSFW EQU   PSA+860
PSADSS14 EQU   PSA+856
PSADSSPP EQU   PSA+848
PSADSSRP EQU   PSA+840
PSADSS05 EQU   PSADSSF4
PSADSS10 EQU   PSADSSF4
PSADSSVE EQU   PSADSSF4
PSADSSDE EQU   PSADSSF4
PSADSSC0 EQU   PSADSSF4
PSADSSIE EQU   PSADSSF4
PSADSS12 EQU   PSADSSF4
PSADSSRC EQU   PSADSSF4
PSARV057 EQU   PSADSSF3
PSARV056 EQU   PSADSSF3
PSARV055 EQU   PSADSSF3
PSADSSMC EQU   PSADSSF3
PSADSSRW EQU   PSADSSF3
PSADSSNM EQU   PSADSSF3
PSADSSES EQU   PSADSSF3
PSADSSGP EQU   PSADSSF3
PSADSSF2 EQU   PSADSSFL+1
PSADSSPI EQU   PSADSSF1
PSADSSOI EQU   PSADSSF1
PSADSSSP EQU   PSADSSF1
PSADSSTP EQU   PSADSSF1
PSADSSDW EQU   PSADSSF1
PSADSSDD EQU   PSADSSF1
PSADSSDM EQU   PSADSSF1
PSADSSMV EQU   PSADSSF1
PSADSSTS EQU   PSA+816
PSADSSWK EQU   PSA+812
PSADSSR3 EQU   PSA+808
PSADSSR2 EQU   PSA+804
PSADSSRS EQU   PSA+800
PSASTOR  EQU   PSA+796
PSACPUSA EQU   PSA+794
PSAVSTAP EQU   PSA+792
PSAWKVAP EQU   PSA+788
PSAWKRAP EQU   PSA+784
PSAMCHIC EQU   PSA+783
PSAACTCD EQU   PSA+782
PSASYMSK EQU   PSA+781
PSAMCHFL EQU   PSA+780
PSACR0   EQU   PSA+776
PSAPSWSV EQU   PSA+768
PSACLHS  EQU   PSAHLHI
PSALKR15 EQU   PSALKSA+60
PSALKR14 EQU   PSALKSA+56
PSALKR13 EQU   PSALKSA+52
PSALKR12 EQU   PSALKSA+48
PSALKR11 EQU   PSALKSA+44
PSALKR10 EQU   PSALKSA+40
PSALKR9  EQU   PSALKSA+36
PSALKR8  EQU   PSALKSA+32
PSALKR7  EQU   PSALKSA+28
PSALKR6  EQU   PSALKSA+24
PSALKR5  EQU   PSALKSA+20
PSALKR4  EQU   PSALKSA+16
PSALKR3  EQU   PSALKSA+12
PSALKR2  EQU   PSALKSA+8
PSALKR1  EQU   PSALKSA+4
PSALKR0  EQU   PSALKSA
PSARV023 EQU   PSACLHT+52
PSALOCAL EQU   PSACLHT+48
PSACMSL  EQU   PSACLHT+44
PSAOPTL  EQU   PSACLHT+40
PSATPACL EQU   PSACLHT+36
PSATPDNL EQU   PSACLHT+32
PSATPNCL EQU   PSACLHT+28
PSAIOSLL EQU   PSACLHT+24
PSAIOSUL EQU   PSACLHT+20
PSAIOSCL EQU   PSACLHT+16
PSAIOSSL EQU   PSACLHT+12
PSASALCL EQU   PSACLHT+8
PSAASML  EQU   PSACLHT+4
PSADISPL EQU   PSACLHT
PSASRSA  EQU   PSA+636
PSARV050 EQU   PSA+634
PSADSSGO EQU   PSA+633
PSARECUR EQU   PSA+632
PSAHLHIS EQU   PSA+628
PSAIPCSA EQU   PSA+624
@NM00113 EQU   PSA+621
PSAIPCDM EQU   PSA+620
PSAIPCD  EQU   PSA+616
@NM00112 EQU   PSA+613
PSAIPCRM EQU   PSA+612
PSAIPCR  EQU   PSA+608
PSAMCHEX EQU   PSA+600
PSAMPSW  EQU   PSA+592
PSAEXPS2 EQU   PSA+584
PSAEXPS1 EQU   PSA+576
PSAPIREG EQU   PSA+572
PSARSREG EQU   PSA+568
PSAGPREG EQU   PSA+556
PSARV022 EQU   PSASUP4
PSARV021 EQU   PSASUP4
PSARV020 EQU   PSASUP4
PSARV019 EQU   PSASUP4
PSARV018 EQU   PSASUP4
PSARV017 EQU   PSASUP4
PSARV016 EQU   PSASUP4
PSARV015 EQU   PSASUP4
PSARV014 EQU   PSASUP3
PSAULCMS EQU   PSASUP3
PSARV012 EQU   PSASUP3
PSAESTA  EQU   PSASUP3
PSASPR   EQU   PSASUP3
PSAPSREG EQU   PSASUP3
PSAPI2   EQU   PSASUP3
PSAIOSUP EQU   PSASUP3
PSALCR   EQU   PSASUP2
PSARTM   EQU   PSASUP2
PSAACR   EQU   PSASUP2
PSAIPCE2 EQU   PSASUP2
PSAIPCES EQU   PSASUP2
PSAIPCEC EQU   PSASUP2
PSAGTF   EQU   PSASUP2
PSAIPCRI EQU   PSASUP2
PSATYPE6 EQU   PSASUP1
PSATCTL  EQU   PSASUP1
PSADISP  EQU   PSASUP1
PSALOCK  EQU   PSASUP1
PSAPI    EQU   PSASUP1
PSAEXT   EQU   PSASUP1
PSASVC   EQU   PSASUP1
PSAIO    EQU   PSASUP1
PSAANEW  EQU   PSA+544
PSATNEW  EQU   PSA+536
PSALCCAR EQU   PSA+532
PSALCCAV EQU   PSA+528
PSAPCCAR EQU   PSA+524
PSAPCCAV EQU   PSA+520
PSACPULA EQU   PSA+518
PSACPUPA EQU   PSA+516
PSAPSA   EQU   PSA+512
FLCHDEND EQU   PSA+512
FLCCRSAV EQU   FLCMCLA+280
FLCGRSAV EQU   FLCMCLA+216
FLCFPSAV EQU   FLCMCLA+184
FLCFLA   EQU   FLCMCLA+88
FLCRGNCD EQU   FLCMCLA+84
FLCFSAA  EQU   FLCFSA+1
@NM00111 EQU   FLCFSA
@NM00110 EQU   FLCMCLA+77
PSAMDISC EQU   PSAMEDC
PSAMINTR EQU   PSAMEDC
PSAMINST EQU   PSAMEDC
PSAMCCF  EQU   PSAMEDC
PSAMCNOP EQU   PSAMEDC
PSAMEXSR EQU   PSAMEDC
PSAMCOPR EQU   PSAMEDC
@NM00109 EQU   PSAMEDC
@NM00108 EQU   FLCMCLA+72
FLCMCIC  EQU   FLCMCLA+64
@NM00107 EQU   FLCMCLA+20
FLCIOAA  EQU   FLCIOA+1
@NM00106 EQU   FLCIOA
@NM00105 EQU   FLCMCLA+15
@NM00104 EQU   FLCMCLA+14
@NM00103 EQU   FLCMCLA+12
FLCLCL   EQU   FLCMCLA+8
FLCIOELA EQU   FLCIOEL+1
@NM00102 EQU   FLCIOEL
FLCCHIL  EQU   FLCCHNID+2
FLCCHMOD EQU   FLCCHTM
FLCCHTYP EQU   FLCCHTM
@NM00101 EQU   PSA+160
FLCMTRCD EQU   PSA+157
@NM00100 EQU   PSA+156
FLCPERA  EQU   FLCPER+1
@NM00099 EQU   FLCPER
@NM00098 EQU   PSA+151
FLCPERCD EQU   PSA+150
FLCMCNUM EQU   PSA+149
@NM00097 EQU   PSA+148
FLCTEAA  EQU   FLCTEA+1
@NM00096 EQU   FLCTEA
PSAPIPC  EQU   PSAPICOD
PSAPIMC  EQU   PSAPICOD
PSAPIPER EQU   PSAPICOD
PSARV049 EQU   FLCPICOD
FLCPILCB EQU   FLCPIILC
@NM00095 EQU   FLCPIILC
@NM00094 EQU   PSAEPPSW
FLCSVCN  EQU   PSAESPSW+2
FLCSILCB EQU   FLCSVILC
@NM00093 EQU   FLCSVILC
@NM00092 EQU   PSAESPSW
FLCEICOD EQU   PSAEEPSW+2
PSASPAD  EQU   PSAEEPSW
@NM00091 EQU   PSA+128
FLCINPSW EQU   PSA+120
FLCMNPSW EQU   PSA+112
FLCPNPSW EQU   PSA+104
FLCSNPSW EQU   PSA+96
FLCENPSW EQU   PSA+88
FLCTRACE EQU   PSA+84
FLCTIMER EQU   PSA+80
FLCCVT2  EQU   PSA+76
FLCCAW   EQU   PSA+72
FLCCSW   EQU   PSA+64
FLCIOPSW EQU   PSA+56
FLCMOPSW EQU   PSA+48
FLCPOPSW EQU   PSA+40
FLCSOPSW EQU   PSA+32
FLCEOPSW EQU   PSA+24
@NM00090 EQU   FLCICCW2+4
FLCCVT   EQU   FLCICCW2
FLCICCW1 EQU   FLCROPSW
FLCIPPSW EQU   FLCRNPSW
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RT00203 EQU   SWCHTIM
@RC00299 EQU   @RC00298
@RC00305 EQU   @RC00298
@RC00326 EQU   @RC00323
@RC00545 EQU   @EL00002
@RC00577 EQU   @RC00576
@RC00606 EQU   @EL00003
@RC00587 EQU   @EL00003
@RC00647 EQU   @RC00646
@RF00711 EQU   @RC00708
@RF00726 EQU   @RC00723
@RF00762 EQU   @RC00759
@RF00824 EQU   @RC00821
@RF00844 EQU   @EL00005
@RC00866 EQU   @EL00006
@RF00872 EQU   @EL00006
@RF00876 EQU   @EL00006
@RC00882 EQU   @EL00007
@RF00899 EQU   @EL00007
@RF00936 EQU   @EL00010
@RC00941 EQU   @EL00010
@RF01079 EQU   @RC01076
@RF01115 EQU   @EL00011
@RF01120 EQU   @EL00011
@RF01182 EQU   @EL00012
@RF01187 EQU   @EL00012
@RF01424 EQU   @EL00017
@RC01354 EQU   @EL00017
@RC01450 EQU   @RC01447
@RF01484 EQU   @EL00018
@RF01483 EQU   @EL00018
@RF01494 EQU   @EL00019
@RC01548 EQU   @RC01535
@RF01660 EQU   @RC01657
@RC01642 EQU   @EL00024
@RC01652 EQU   @EL00024
@RF01706 EQU   @EL00025
@RF01752 EQU   @EL00030
@RF00600 EQU   @RC00587
@RF00599 EQU   @RC00587
@RF00895 EQU   @RC00882
@RC00884 EQU   @RC00882
@RC01359 EQU   @RC01354
@RC01455 EQU   @RC01450
@RC01451 EQU   @RC01450
@RF01554 EQU   @RC01548
@RC00885 EQU   @RC00884
@RF01362 EQU   @RC01359
@RF01364 EQU   @RC01359
@RF01417 EQU   @RC01359
@RC01452 EQU   @RC01451
@RC01458 EQU   @RC01455
@RC00887 EQU   @RC00885
@RC01461 EQU   @RC01458
@ENDDATA EQU   *
         END   IEAVSWCH,(C'PLS2311',0701,78058)

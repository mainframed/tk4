         MACRO
         IEBUPCON
*1101                                                              MA0H
*1101                                                              4929
*1101                                                              5324
*1101004000,004200,022200-022800                                   UL0H
*A020100,020120                                                @SA67452
*C020000                                                       @SA67452
IEBUPCON DSECT
*  ********************************************************************
*  **      SWITCHES TO BE RE-INITIALIZED. THESE SWITCHES ARE RESET ****
*  **    UPON RE-ENTRY TO THIS PROGRAM, THIS IS DONE BY AT THE START **
*  **    OF THE PROGRAM BY AN XC INSTRUCTION. THE SIZE OF THE TABLE  **
*  **    IS OBTAINED BY SUBTRACTING THE BEGINNING FROM THE END IN    **
*  **    THE EQUATE AT SIZETAB.  SWITCHES MAY BE ADDED TO THE TABLE  **
*  **    ANYWHERE BETWEEN 'STARTAB' AND 'ENDTAB' AND THEY WILL BE    **
*  **    RESET BY THE INITIAL CODE UP TO A MAXIMUM OF 256 BYTES OF   **
*  **    SWITCHES. IF MORE THAN 256 BYTES OF SWITCHES, CHANGE CODE   **
*  **    AT START OF PROGRAM.                                        **
*  **            GROUP OF SWITCHES FROM COMDCD TO ENDTAB MUST REFER  **
*  **    ONLY TO CONTROL CARD SWITCHES.                              **
*  ********************************************************************
         SPACE 1
STARTAB  DS    0F   START OF SWITCH TABLE. COMMENTS STATE SWITCH USE
         SPACE 1
HICONCDE DC    H'0'                    RETURN CODE FOR IEBUPDAT
FIRSTCON DC    X'00'                   SET TO '0F' ON CONT. CARD   UL0H
LABELSW  DC    X'00'                    USER LABELS IN INPUT STREAMUL0H
LABEL2SW DC    X'00'                    PROCESSING USER LABELS     UL0H
EOVSWTCH DC    X'00'                    EOV ON OLD MASTER FOR LABELUL0H
IOBADSW  DC    X'00'                    I/O ERROR DURING LABEL PROCUL0H
LBLRETCD DC    X'00'                    RETURN CODE FROM LABEL RTNSUL0H
FRSTCOMD DC    X'00'                    INDICATES HEADERS INPUT    UL0H
LABLSYSN DC    X'00'                    LABELS HAVE BEEN SAVED SWT UL0H
LABELCNT DC    X'00'                    NO. OF HDR/TRL LABELS INPUTUL0H
USERCONT DC    X'00'                    NO. OF LABELS TO BE PRINTEDUL0H
ULBLCNT  DC    X'00'                    DECREMENTATION COUNT       UL0H
USYSNCNT DC    X'00'                    DECREMENTATION COUNT       UL0H
OMLBLCNT DC    X'00'                    NO. LABELS ON  OLD MASTER  UL0H
OMOPENSW DC    X'00'                    OLD MASTER IS OPEN  X'0F'  UL0H
NMOPNSWT DC    X'00'                    NEW MASTER IS OPEN  X'0F'  UL0H
NMCLSESW DC    X'00'                    NEW MASTER IS CLOSED X'0F' UL0H
OMSYSNLB DC    X'00'                    HDRS TAKEN FROM OM/INPUT   UL0H
NMSYSNLB DC    X'00'                    TRLRS TAKEN FROM OM/INPUT  UL0H
TOTALSW  DC    X'00'                    TOTAL EXIT TO BE TAKEN X'FFUL0H
FIRSENTR DC    X'00'                   FIRST CONTROL CARD SWITCH
ASISMSW  DC    X'00'                   WRITE RECORD AS IS NOT A MESSAGE
PRIMESW  DC    X'00'                   OPEN DCBLOGR SWITCH
QUITALL  DC    X'00'                   CLOSE DCBLOG IF '0F'
LOGBADSW DC    X'00'                   IF '0F'  DCBLOGR NOT OPENED
EODCTSW  DC    X'00'                   END OF DATA ON SYSIN
ERRNAMSW DC    X'00'                   ERROR FOUND IN EXIT NAME
CTONLYSW DC    X'00'                   PARM=NEW CT ONLY- NO OLD MASTER
CTHDRSW  DC    X'00'                   SET TO '0F' IF SYSIN TRAILERUL0H
CTTRLRSW DC    X'00'                   SET TO '0F' IF SYSIN HEADER UL0H
OMHDRSW  DC    X'00'                   SET TO '0F' IF OM USER HEADER
OMTRLRSW DC    X'00'                   SET TO '0F' IF OM USER TRAILER
NMHDRSW  DC    X'00'                   SET TO '0F' IF NM USER HEADER
NMTRLRSW DC    X'00'                   SET TO '0F' IF NM USER TRAILER
TEMPCON  DC    X'00'                   TEMPORARY RETURN CODE IEBUPDAT
NMBLKERR DC    X'00'                   INCORRECT NEW MASTER BLOCKSIZE
OMBLKERR DC    X'00'                   INCORRECT OLD MASTER BLOCKSIZE
OPENSW   DC    X'00'                   DCB NOT OPENED IF '0F'
LEVELXX  DC    X'F000'                 SAVES LEVEL, 'F0' NOT STORED
FLUSHSW  DC    X'00'                   SCANNING FOR NEXT COMD SWITCH
PRINTED  DC    X'00'                   IEBASCAN--IEBBSCAN COM. SWTCUL0H
PSSWOM   DC    X'00'                   OLD MASTER PHYSICAL SEQUENTIAL
PSSWNM   DC    X'00'                   NEW MASTER PHYSICAL SEQUENTIAL
CCSCANSW DC    X'00'                   SET TO 01 IF CARD SCAN READ
FINICCS  DC    X'00'                   CONTROL CARDS DEPLETED
REPLUPDT DC    X'00'                   REPLACEMENT MADE SWITCH
INPLCSW  DC    X'00'                   UPDATE INPLACE SWITCH
ENDONLY  DC    X'00'                   FLUSHIG TO ENDUP CARD       4929
FSTINSRT DC    X'00'    SET TO '0F' WHEN FIRST DATA CARD AFTER A A25432
*                 ./ NUMBER STMT (WITH INSERT=YES) IS SEQUENCED  A25432
SYNADSW  DC    X'00'  TURNED TO '0F' WHEN SYNAD EXIT TAKEN       A27716
*
****             WARNING--  PLEASE NOTE                             ***
*   ONLY CONTROL CARD SWITCHES GO BETWEEN HERE AND 'ENDTAB' OR THE    *
*       SCAN FOR NEXT COMMAND CARD IN 'FLUSH' ROUTINE WILL BE RUINED. *
*
COMDCD   DC    X'00'                   SET ON ADD,REPL,CHNGE,REPRO CARD
COMDCD2  DC    X'00'                   NEXT COMMAND CARD ENCOUNTERED
ALIASW   DC    X'00'                   FLAGS ALIAS PRESENT
ALIASW2  DC    X'00'                   ALIAS PENDING SWITCH        MA0H
REPROSW  DC    X'00'                   SWITCH SET FOR REPRO COMMAND
ADDSW    DC    X'00'                   SET TO INDICATE ADD COMMAND
REPLSW   DC    X'00'                   SET TO INDICATE REPL COMMAND
CHNGESW  DC    X'00'                   INDICATES CHANGE COMD
DELETSW  DC    X'00'                   SET FOR DELET STATEMENT NUMBER 1
DELET2SW DC    X'00'                   DELET PENDING- HOLD CARD READ
NUMBRSW  DC    X'00'                   NUMBR SWITCH
NUMBR2SW DC    X'00'                   NUMBER PENDING- HOLD CARD READ
RENUMALL DC    X'00'                   RENUMBER COMPLETE DATA IF '0F'
INSERTSW DC    X'00'                   BLOCK INSERT IF SET TO '0F'
INSRTRD  DC    X'00'                   FLAG AS INSERT, PROTECTS GR9
NEWNAME  DC    X'00'                   FLAG NEW MASTER PO MEMBER NAME
COLUMNSW DC    X'00'                   SELECTIVE COLUMN UPDATE
IGNORESW DC    X'00'                   PUT FIRST /* ON NM IF SWITCH 0F
IGNORE1  DC    X'00'                   SET TO '01' ON FIRST EOF
PRINTWRT DC    X'00'                   LIST RECORD, WRITE IT SWITCH
RIDIT2SW DC    X'00'                   FLUSH BY DELETE/NUMBER CARDS
NMBUFFR  DC    X'00'                   '0F' IF NM NOT WRITTEN '01' LAST
SSISW    DC    X'00'                   TOTAL SSI GIVEN
FLLISTSW DC    X'00'                   SET TO '01' LIST NM/CT FULL LIST
PARMSW   DC    X'00'                   SET TO INDICATE PARAMETERS FOUND
OMEND    DC    X'00'                   END OF MEMBER OR DATA SET SYSUT1
DONOTRDC DC    X'00'                   DO NOT READ SYSIN IF '0F'
SEQ1SW   DC    X'00'                   SEQUENCE 1 SATISFIED
READNOOM DC    X'00'                   DO NOT READ OLD MASTER IF '0F'
SHORTBLK DC    X'00'                   SET TO '0F' LAST BLOCK NOT FULL
EQUALREC DC    X'00'                   REPLACEMENT RECORD UPDATE INPLAC
STARTMEM DC    X'00'                   SET TO '0F' WHEN UPDATING MEMBER
UPDATCOL DC    H'0'                    PARTIAL UPDATE USUALLY 0
*   END OF CONTROL CARD SWITCHES IS ENDTAB                            *
ENDTAB   DS    0F                      END OF SWITCH TABLE
         SPACE 1
*   **  WARNING--   KEEP DELTSEQ1,DELTSEQ2,NUMRSEQ1,NUMRSEQ2 TOGETHER *
*  AS THEY ARE CLEARED BY A 32 BYTE XC IN FLUSH ROUTINE.              *
*
DELTSEQ1 DC    D'0'                    SEQUENCE START DELET CARD
DELTSEQ2 DC    D'0'                    SEQUENCE END DELET CARD
NUMRSEQ1 DC    D'0'                    SEQUENCE START NUMBR CARD
NUMRSEQ2 DC    D'0'                    SEQUENCE END NUMBR CARD
         SPACE 1
INCRNUMB DC    D'0'                    INCREMENTATION FACTOR
INCREMWA DC    D'0'                    INCREMENT FOR NUMBER
NEW1NUMB DC    D'0'                    STARTING NEW SEQUENCE NUMBER
MEMBNEW  DC    D'0'                    BUFFER FOR NEW PO MEMBER NAME
SSIBUF   DC    D'0'                    SSI INFORMATION BUFFER
ALIASNM  DC    CL128' '           BUFFER FOR ALIAS NAME        @SA67452
ALIASNM1 DS    A                  ALIAS SAVE POINTER           @SA67452
ALIASNM2 DS    A                  ALIAS MOVE POINTER           @SA67452
TEMPINCR DC    D'0'                    TEMPORARY INCR FOR 2ND BLOCK INS
***   WARNING--  KEEP THE 4 NAMES BELOW IN THIS ORDER-              ***
**               SYSIN, SYSPRINT, SYSUT1, SYSUT2                     **
*                                                                     *
SYSINNM  DC    CL8' '                  NAME OF INPUT DD CARD
SYSPRNTN DC    CL8' '                  NAME OF PRINTER DD CARD
SYSUT1NM DC    CL8' '                  NAME OF OLD MASTER DD CARD
SYSUT2NM DC    CL8' '                  NAME OF NEW MASTER DD CARD
         SPACE 1
MEMNAME  DC    CL8' '                  MEMBER NAME FOR PODS
 SPACE 2
***********************************************************************
*        THE FOLLOWING THREE WORD FIELDS CONTAIN THE USER'S LABEL     *
*        EXIT ROUTINE NAME,A ONE BYTE PRINT CONSTANT FOLLOWED BY A    *
*        THREE BYTE ADDRESS OF THE LOADED USER ROUTINE.               *
*                                                                     *
* FIELD  ************************                                     *
*        * USER ROUTINE  *C*ADDR*                                     *
*        ************************                                     *
***********************************************************************
   SPACE 1
USERRTN  DS    3F             CURRENT USER LABEL ROUTINE INFO      UL0H
CTHDR    DS    3F             USER LABEL HEADER ROUTINE ON SYSIN   UL0H
CTTRLR   DS    3F             USER LABEL TRALER ROUTINE ON SYSIN   UL0H
OMHDR    DS    3F             USER LABEL HEADER ROUTINE ON SYSUT1  UL0H
OMTRLR   DS    3F             USER LABEL TRALER ROUTINE ON SYSUT1  UL0H
NMHDR    DS    3F             USER LABEL HEADER ROUTINE ON SYSUT2  UL0H
NMTRLR   DS    3F             USER LABEL TRALER ROUTINE ON SYSUT2  UL0H
STOWAREA DS    CL80'        '          BUFFER USED BY STOW
LISTAREA DS    CL80'        '          BUFFER USED BY BLDL
OMINAREA DS    CL80'        '          BUFFER USED FOR OLD MASTER IMAGE
TEMP     DC    D'0'                    WORK BUFFER CSECT2
LASTCTRC DC    D'0'                    LAST CT SEQUENCE NUMBER
LASTSEQN DC    D'0'                    LAST SEQUENCE ASSIGNED BY NUMBER
TEMPSEQ  DC    D'0'                    LAST SEQUENCE NUMBER NEW SYSIN
FDADSET  DC    D'0'                    START OF MEMBER FDAD MBBCCHHR
TEMPWA   DC    2D'0'                   SAVE AREA FOR SEQUENCE NUMBERS
TEXTCTL  DS    CL121                   LOGOUT PRINT BUFFER + CONTROL
TRKBAL   DC    X'0000'       SAVE AREA FOR TRACK BALANCE           5666
SWITCHRD DS    27F                     SCAN BUFFER AND SWITCHES
INPUT    DS    20F                      SYSIN INPUT AREA           BS0H
EXTNTSW  DC    X'00'         OLD AND NEW SAME DATA SET             5324
STOREG   DS    3F                      SAVES SCAN REGISTERS
JFCBAREA DS    CL176               AREA INTO WHICH JFCB IS READ    3341
         DS    0D                  ALIGN DSCBAREA ON DOUBLE WORD   3341
DSCBAREA DS    CL350               WORK AREA FOR OBTAIN MACRO      3341
DSCBLIST DS    4F                  LIST OF INFORMATION FOR OBTAIN  3341
ADEVTYPE DS    2F                  AREA FOR DEVTYPE MACRO INFO     3341
BLOKSW   DC    X'00'                   SET IF BLOCKSIZE NOT 80     UL0H
BLOKFCTP DC    F'00'                                               UL0H
OMBLOCKP DC    F'0'                    OM BLOCK FACTOR/LENGTH RECORD
OMREADP  DC    F'0'                    ADDRESS OF OLD MASTER BUFFER
OMREADT  DC    F'0'                    ADDRESS OF OLD MASTER RECORD
NMWRITEP DC    F'0'                    ADDRESS OF NEW MASTER BUFFER
NMWRITET DC    F'0'                    ADDRESS OF NEW MASTER RECORD
READINAP DC    F'0'                    ADDRESS OF SYSIN BUFFER
LASTRECB DC    F'0'                    ADDRESS OF LAST RECORD PROCESSED
NEXTINSR DC    F'0'                    ADDRESS OF NEXT INSERT RECORD
OMLBLPTR DC    F'00'                    ADDR OF OMLABELS           UL0H
LABELBUF DC    F'00'                    ADDR OF GOTTEN CORE SAVE ARUL0H
USYSNBUF DC    F'00'                                               UL0H
UPDATBUF DC    F'00'                    ADDR OF SPECIAL UPDATE AREAUL0H
TOTALSIZ DC    F'00'                    SIZE SPECIFIED BY USER     UL0H
TOTALRTN DC    D'00'                    USER ROUTINE FOR TOTALING  UL0H
TOTALADR DC    F'00'                    ADDRESS OF TOTAL ROUTINE   UL0H
TOTLPARM DC    4F'0'                    USER TOTALING PARM LIST    000I
TOTRTNCD DC    H'00'                    RETURN CODE FROM TOTAL RTN UL0H
OMLABELS DS    160F                     EIGHT 80 BYTE LABEL SAVE ARUL0H
IDENTXX  DC    X'00480008'             SEQUENCE COLUMN-1,AND SIZE 73-8
*   POINTER TO DCB'S CONTAINED IN CSECT1  (IEBUPDAT)
DCBLOG   DS    F                       POINTER TO LOG (SYSPRINT) DCB
DCBCT    DS    F                       POINTER TO SYSIN DCB
DCBOM    DS    F                       POINTER TO OLD MASTER (SYSUT1)
DCBNM    DS    F                       POINTER TO NEW MASTER (SYSUT2)
*   CONSTANTS FOR INITIALIZATION ROUTINE
USRHDPTR DC    F'0'                    POINTER TO USER HEADER LABEL
USRTRPTR DC    F'0'                    POINTER TO USER TRAILER LABEL
PAGENO   DC    F'0'                    NUMBER FIELD OF PAGE REFERENCE
NMBLOCKP DC    F'0'                    NM BLOCK FACTOR/LOGICAL RECORD
SAVE13   DS    F                       POINTER TO SUPERVISOR REGISTERS
SEQWA    DC    F'0'                    STARTING SEQUENCE NUMBER
TEMPSEQA DC    F'0'                    TEMPORARY BUFFER 2ND (EW1 BLOCK
MAXSIZEL DC    H'80'                   ASSUMED LRECL
LRECL    DC    H'0'                    LOGICAL RECORD LENGTH SYSUT1/2
SOURCECD DC    X'FF'                   C'1'=IBM,C'0'=USER,'FF'=LEAVE IT
FLBLK    DC    H'00'                   ORIGINAL BLOCKSIZE          3628
SHRTBLK  DC    H'00'                   COMPUTED SHORT BLOCK ON READ3628
DSECTEND DS    0D                      END OF DSECT
         SPACE 1
*   THE FOLLOWING ARE THE CODES FOR MESSAGES. MESSAGES ARE CONTAINED  *
*  IN CSECT 'IEBUPLOG', THE MESSAGE CSECT. IN ALL CSECTS GR11 IS      *
*  LOADED WITH THE MESSAGE CODE NUMBER TO ENABLE THE MESSAGE WRITER   *
*  TO SELECT THE DESIRED MESSAGE. MESSAGES ARE OF VARIABLE LENGTHS    *
*  DETERMINED BY THE EQUATES IN THE 'IEBUPLOG' CSECT.                 *
         SPACE 1
BLOKSMSG EQU   X'01'                   NUMBER OF BLOCKSIZE ASSUMED 80
IOERR    EQU   X'02'           NUMBR OF I/O ERROR MESSAGE        A27716
FINDMSG  EQU   X'03'       NUMBER FOR FIND I/O ERROR MSG         A27716
BLDLMSG  EQU   X'04'       NUMBER FOR BLDL I/O ERROR MSG         A27716
SCANMSG  EQU   X'05'                   NUMBER OF CONTROL STATEMENT MSG
SEQMSG   EQU   X'06'                   NUMBER OF STATEMENT SEQUENCE MSG
ERROP    EQU   X'07'                   NUMBER OF INVALID OPERATION MSG
FLUSHING EQU   X'08'                   NUMBER OF FLUSH TO NEXT MEMBER
CARDSKIP EQU   X'09'                   NUMBER OF IGNORE CARD IN FLUSH
DELMSG   EQU   X'10'                   NUMBER OF DELETE RANGE ERROR MSG
NUMMSG   EQU   X'11'                   NUMBER OF NUMBER RANGE ERROR MSG
ERRDRIO  EQU   X'12'                   NUMBER OF DIRECTORY WRITE ERROR
ERRDIRF  EQU   X'13'                   NUMBER OF OUTPUT DIRECTORY FULL
NTOPMSG  EQU   X'14'                   NUMBER OF DS NOT OPENED MESSAGE
ERRMSGC  EQU   X'15'                   NUMBER OF ONLY 1 PS PROCESSED
STOWMSGN EQU   X'16'                   NUMBER OF NAME FOUND AND ALTERED
STOWMSGT EQU   X'17'                   NUMBER OF NAME NOT FOUND MSG
CONCDMSG EQU   X'18'                   NUMBER OF CONDITION CODE MESSAGE
EOJMESSG EQU   X'19'                   END OF JOB MESSAGE
UPDATMSG EQU   X'20'                   NUMBER OF CANNOT UPDATE INPLACE
PLUS8MSG EQU   X'21'                   NUMBER OF INVALID EXIT MESSAGE
USRTRMSG EQU   X'22'                   NUMBER OF EXIT RETURN ERROR MSG
ERRMSGN  EQU   X'23'                   NUMBER OF NULL DATA SET MESSAGE
PSALIAS  EQU   X'25'                   NUMBER OF IGNORE ALIAS IN PS
ALTTRUE  EQU   X'26'                   NUMBER OF ALIAS TO TRUE MESSAGE
BADPARMG EQU   X'27'                   NUMBER OF INVALID INPUT PARM MSG
PAGEMSG  EQU   X'28'                   NUMBER OF INVALID PAGE PARM MSG
DDNAMEMG EQU   X'29'                   NUMBER OF INVALID DD NAME MSG
SIZEBAD  EQU   X'30'                   OLD MASTER /NEW MASTER LRECL
DSORGBAD EQU   X'31'               OM AND NM DSORGS INCOMPATIBLE   3341
USRLBLMS EQU   X'32'                    ROUTINE IS PROCESSING LABELUL0H
LBLENTMS EQU   X'33'                    NO. OF ENTRANCES MSG       UL0H
LSTRCMSG EQU   X'34'                    LAST RETURN CODE FROM  USERUL0H
SEQDSMSG EQU   X'35'                    SUPPORTED ON SEQUENTIAL DS UL0H
INPLBLMS EQU   X'36'                    TRAILERS NOT ON UPDATE     UL0H
LBLERMSG EQU   X'37'                    I/O ERROR DURING LABEL PROCUL0H
NOLBLMSG EQU   X'38'                    NO. LABELS CREATED FROM IN UL0H
TOTENTMS EQU   X'39'                    ROUTINE IS TAKING TOTAL XITUL0H
TOTTERM  EQU   X'40'                    ROUTINE TERM. TOTAL EXITS  UL0H
TOTBDRCD EQU   X'41'                    INVALID RETURN CODE -TOTAL UL0H
TOTNTSPT EQU   X'42'                    TOTALING NOT SUPPORT- UPDATUL0H
BDCORESZ EQU   X'43'                    INVALID CORE SIZE--TOTALINGUL0H
NOULXSTM EQU   X'44'                    NO USER LABELS EXIST       UL0H
NOULCRTM EQU   X'45'                    NO USER LABELS CREATED     UL0H
UPALIAS  EQU   X'46'                                               UL0H
         SPACE 1
DSECTSIZ EQU   DSECTEND-IEBUPCON       SIZE OF DSECT
SIZETAB  EQU   ENDTAB-STARTAB-1        SIZE OF SWITCHES
CONTCLER EQU   ENDTAB-COMDCD-1         EXTENT OF CONTROL CARD SWITCHES
         SPACE 1
LOGOUTAR EQU   TEXTCTL+1               DATA PORTION OF PRINT BUFFER
IDENTY   EQU   IDENTXX+2               EXTENT OF SEQUENCE NUMBER
LASTCOLM EQU   SWITCHRD+72        LAST COLUMN                      3185
PARAMSW  EQU   SWITCHRD+81             PARAMETER FOLLOWS, CONTINUATION
SAVEPAPR EQU   SWITCHRD+83             SAVE AREA FOR PARTIAL PARAMETERS
COL72LG  EQU   SWITCHRD+103            COLUMN 72 SWITCH AND LENGTH SW
DELIMIN  EQU   SWITCHRD+106            DELIMITER INDICATORS
DELIMIN2 EQU   SWITCHRD+107            DELIMITER INDICATORS
NMBLOCKT EQU   NMBLOCKP+2              LOGICAL RECORD USED
OMBLOCKT EQU   OMBLOCKP+2              LOGICAL RECORD USED COUNT
         MEND

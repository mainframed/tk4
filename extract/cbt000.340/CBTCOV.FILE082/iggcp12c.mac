         MACRO
         IGGCP12C &OPTCD=
.*          RELEASE 23 DELETIONS/CHANGES
.*          RELEASE 22 DELETIONS/CHANGES
.*          RELEASE 21 DELETIONS/CHANGES
* CP12C  WRITES A NEW RECORD WHICH HAS REPLACED A DELETED RECORD
CL1      CCW   SIDEQ,0,CC,5              SEARCH FOR DELETED RECORD
CL2      CCW   TIC,CL1-CB1,0,0
         AIF   ('&OPTCD' NE 'W').VLR
CL3      CCW   WD,0,CC,0                 REPLACE DELETED RECORD
         AGO   .SVLR
.VLR     ANOP
CL3      CCW   WD,0,0,0
.SVLR    ANOP
SZ12C    EQU   CL3+8-CL1
    AIF   ('&OPTCD' NE 'W').END
* 12CW   WRITE VALIDITY CHECK
CL30     CCW   NOP,0,CC+SILI,1
CL3A     CCW   SIDEQ,0,CC,5              SEARCH FOR RECORD AGAIN
CL3B     CCW   TIC,CL3A-CB1,0,0
CL3C     CCW   RDATA,0,SKIP,0               READ IT BACK
SZ12CW   EQU   CL3C+8-CL30+SZ12C
.END     MEND

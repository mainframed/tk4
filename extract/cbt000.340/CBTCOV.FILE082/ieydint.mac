*1540530400-532200                                                 3123
*1540977400                                                        3123
*3610254400,264000,781800-783000                                   6107
         IEYEQU
TMP0     EQU      0                       EQU   0
WRKADR   EQU      4                       EQU   4
ADDR     EQU      7                       EQU   7
POPXIT   EQU      6                       EQU   6
EXTADR   EQU      5                       EQU   5
CONSTR   EQU      9                       EQU   9
TMP4     EQU      1                       EQU   1
PGB2     EQU      2                       EQU   2
POPADR   EQU      3                       EQU   3
LOC      EQU      12                      EQU   12
POPPGB   EQU      8                       EQU   8
ROLLBR   EQU      10                      EQU   10
RETURN   EQU      11                      EQU   11
TMP      EQU      12                      EQU   12
TMP1     EQU      13                      EQU   13
TMP2     EQU      14                      EQU   14
TMP3     EQU      15                      EQU   15
TEMP1    EQU      1                       EQU   1
TEMP2    EQU      12                      EQU   12
TEMP3    EQU      13                      EQU   13
TEMP4    EQU      14                      EQU   14
TEMP5    EQU      15                      EQU   15
TMP6     EQU      10                      EQU   10
TMP5     EQU      11                      EQU   11
GR1      EQU      13                      EQU   13
GR2      EQU      14                      EQU   14
GR3      EQU      15                      EQU   15
GR4      EQU      1                       EQU   1
GR5      EQU      2                       EQU   2
INC      EQU      14                      EQU   14
DIGIT    EQU      13                      EQU   13
ENDBR    EQU      15                      EQU   15
KEY      EQU      1                       EQU   1
LOW      EQU      4                       EQU   4
RETRN1   EQU      12                      EQU   12
QUOTBR   EQU      12                      EQU   12
UNCOND   EQU      15                      EQU   15
UC       EQU      15                      EQU   15
NLOV     EQU      12                      EQU   12
HIGH     EQU      2                       EQU   2
NEQUAL   EQU      6                       EQU   6
ALONE    EQU      1                       EQU   1
NALONE   EQU      12                      EQU   12
NZERO    EQU      6                       EQU   6
NLESS    EQU      10                      EQU   10
LESS     EQU      4                       EQU   4
NHIGH    EQU      12                      EQU   12
NTEQUL   EQU      6                       EQU   6
NTHIGH   EQU      12                      EQU   12
ZEROE    EQU      8                       EQU   8
NTLESS   EQU      10                      EQU   10
UNDER    EQU      14                      EQU   14
OVER     EQU      1                       EQU   1
FLTR0    EQU      0                       EQU   0
FLTR2    EQU      2                       EQU   2
MESSBR   EQU      12                      EQU   12
G0062    EQU      16                      POLISH ROLL X4
G0063    EQU      248                     CODE ROLL X4
G0064A   EQU      508              CODE ROLL TOP                  39375
G0066A   EQU      764              CODE ROLL BOTTOM               39375
G0065    EQU      104                     ERROR ROLL X4
G0070    EQU      0                       BASE
G0071    EQU      260                     TOP
G0072    EQU      516                     BOTTOM
G0073    EQU      772                     DISP FROM SYMBOL
G0074    EQU      774                     DISP FROM PNTR
G0075    EQU      1028                    COMP GROUP SIZE
G0076    EQU      1030                    GROUP SIZE
G0084    EQU      532                     BOTTOM POLISH ROLE
G0090    EQU      64                      BLANK
G0097    EQU      91                      DOLLAR SIGN
G0107    EQU      197                     E
G0108    EQU      196                     D
G0121    EQU      213                     N
G0192    EQU      8                       LETTER KEY X4
G0200    EQU      240                     LAST REG ROLL NO
G0201    EQU      244                     LAST REG ROLLL NO PLUS 1
G0202    EQU      3488                    ROLL DATA ADR TABLE
&MODE    SETC     'POP'
G0289    EQU      252                     AFTER POLISH BASE
*                                            POP BASE
G1000    ST       POPADR,G1002            ST  POPADR,LOCAL JUMP BASE
*                                            POPXIT SET
POPXSET  EQU      *
G1001    BALR     POPXIT,0                BALR  POPXIT,0
*                                            POPSETUP
*                                            POP SETUP
G0205    SR       ADDR,ADDR
         IC       ADDR,0(0,POPADR)
         LH       TMP1,POPTABLE(ADDR)
         IC       ADDR,1(0,POPADR)
         AR       ADDR,ADDR
         AR       ADDR,ADDR
         LA       POPADR,2(0,POPADR)
         B        POPTABLE(TMP1)
         L        TMP,G0365
         BALR     RETURN,TMP
*                                            JSB STORE IN EXIT
JSBSTORE EQU      *
G1003    C        EXTADR,G0354            C     EXTADR,END EXIT ROLL LO
         BNL      G0236                   BNL   GRACEFUL BLOWUP
         LA       EXTADR,12(0,EXTADR)     LA    EXTADR,12(0,EXTADR)
         ST       ADDR,4(0,EXTADR)        ST    ADDR,4(0,EXTADR)
         ST       POPADR,8(0,EXTADR)      ST    POPADR,8(0,EXTADR)
         B        0(TMP,CONSTR)           B     0(TMP,CONSTR)
*                                            POPTB
*                                            POPTABLE
POPTABLE IEYPPT
         EJECT
*                                            INDIRT
INDQ     EQU      *
G0206    LR       TMP1,ADDR               LR    TMP1,ADDR
         L        ADDR,G0433              L     ADDR,INDIRECT BOX
         AR       ADDR,ADDR               AR    ADDR,ADDR
         AR       ADDR,ADDR               AR    ADDR,ADDR
         B        G0213                   B     SPECIAL POP
*                                            POPW0
W0PQ     EQU      *
G0207    SR       TMP,TMP                 SR    TMP,TMP
         B        G0212                   B     POPW
*                                            POPW1
W1PQ     EQU      *
G0208    LA       TMP,4(0,0)              LA    TMP,4(0,0)
         B        G0212                   B     POPW
*                                            POPW2
W2PQ     EQU      *
G0209    LA       TMP,8(0,0)              LA    TMP,8(0,0)
         B        G0212                   B     POPW
*                                            POPW3
W3PQ     EQU      *
G0210    LA       TMP,12(0,0)             LA    TMP,12(0,0)
         B        G0212                   B     POPW
*                                            POPW4
W4PQ     EQU      *
G0211    LA       TMP,16(0,0)             LA    TMP,16(0,0)
*                                            POPW
G0212    LR       TMP1,ADDR               LR    TMP1,ADDR
         LR       ADDR,WRKADR             LR    ADDR,WRKADR
         SR       ADDR,TMP                SR    ADDR,TMP
         SR       ADDR,CONSTR             SR    ADDR,CONSTR
*                                            SPECIAL POP
G0213    SRL      TMP1,2(0)               SRL   TMP1,2(0)
         LH       LOC,POPTABLE(TMP1)       LH   LOC,POPTABLE(TMP1)
         B        POPTABLE(LOC)            B    POPTABLE(LOC)
         EJECT
*                                            AND
ANDQ     L        TMP,0(0,WRKADR)         L     TMP,0(0,WRKADR)
         N        TMP,0(ADDR,CONSTR)      N     TMP,0(ADDR,CONSTR)
         B        G0220                   B     STORE IN W0
*                                            ADD
ADDQ     L        TMP,0(0,WRKADR)         L     TMP,0(0,WRKADR)
         A        TMP,0(ADDR,CONSTR)      A     TMP,0(ADDR,CONSTR)
         B        G0220                   B     STORE IN W0
*                                            SUB
SUBQ     L        TMP,0(0,WRKADR)         L     TMP,0(0,WRKADR)
         S        TMP,0(ADDR,CONSTR)      S     TMP,0(ADDR,CONSTR)
         B        G0220                   B     STORE IN W0
*                                            MPY
MPYQ     L        TMP1,0(0,WRKADR)        L     TMP1,0(0,WRKADR)
         M        TMP,0(ADDR,CONSTR)      M     TMP,0(ADDR,CONSTR)
         LR       TMP,TMP1                LR    TMP,TMP1
         B        G0220                   B     STORE IN W0
*                                            DIV
DIVQ     SR       TMP,TMP                 SR    TMP,TMP
         L        TMP1,0(0,WRKADR)        L     TMP1,0(0,WRKADR)
         D        TMP,0(ADDR,CONSTR)      D     TMP,0(ADDR,CONSTR)
         MVI      0(EXTADR),1             MVI   0(EXTADR),1
         LTR      TMP,TMP                 LTR   TMP,TMP
         BZ       #DIVQ01                 BZ    #1
         MVI      0(EXTADR),0             MVI   0(EXTADR),0
#DIVQ01  LR       TMP,TMP1                LR    TMP,TMP1
         B        G0220                   B     STORE IN W0
*                                            CLA
CLAQ     L        TMP,0(ADDR,CONSTR)      L     TMP,0(ADDR,CONSTR)
*                                            STORE IN W0
G0220    ST       TMP,0(0,WRKADR)         ST    TMP,0(0,WRKADR)
         BR       POPXIT                  BR    POPXIT
*                                            AFS
AFSQ     EQU      *
G0221    L        TMP,0(ADDR,CONSTR)      L     TMP,0(ADDR,CONSTR)
         A        TMP,G0345               A     TMP,FOUR ML
         B        G0228                   B     STORE IN G
*                                            LRS
LRSQ     L        TMP,0(0,WRKADR)         L     TMP,0(0,WRKADR)
         SRL      ADDR,2                  SRL   ADDR,2
         SRL      TMP,0(ADDR)
         B        G0220                   B     STORE IN W0
*                                            LLS
LLSQ     L        TMP,0(0,WRKADR)         L     TMP,0(0,WRKADR)
         SRL      ADDR,2                  SRL   ADDR,2
         SLL      TMP,0(ADDR)
         B        G0220                   B     STORE IN W0
*                                            SWT
SWTQ     L        TMP,0(ADDR,CONSTR)      L     TMP,0(ADDR,CONSTR)
         L        TMP1,0(0,WRKADR)        L     TMP1,0(0,WRKADR)
         ST       TMP1,0(ADDR,CONSTR)     ST    TMP1,0(ADDR,CONSTR)
         B        G0220                   B     STORE IN W0
         EJECT
*                                            ASK
ASKQ     L        TMP,0(0,WRKADR)         L     TMP,0(0,WRKADR)
         B        G0228                   B     STORE IN G
*                                            APH
APHQ     LH       TMP,0(0,WRKADR)         LH    TMP,0(0,WRKADR)
         BAL      RETURN,G0235            BAL   RETURN,PRUNE ONE OFF WO
         STH      TMP,2(ADDR,CONSTR)      STH   TMP,2(ADDR,CONSTR)
         BR       POPXIT                  BR    POPXIT
*                                            ASP
ASPQ     L        TMP,0(0,WRKADR)         L     TMP,0(0,WRKADR)
         BAL      RETURN,G0235            BAL   RETURN,PRUNE ONE OFF WO
*                                            STORE IN G
G0228    ST       TMP,0(ADDR,CONSTR)      ST    TMP,0(ADDR,CONSTR)
         BR       POPXIT                  BR    POPXIT
*                                            EAW
EAWQ     LR       TMP,ADDR                LR    TMP,ADDR
         SRL      TMP,2                   SRL   TMP,2
         B        G0232                   B     ADD TO WORK
*                                            ECW
ECWQ     EQU      EAWQ
*                                            FTH
FTHQ     LH       TMP,2(ADDR,CONSTR)      LH    TMP,2(ADDR,CONSTR)
         SLL      TMP,16                  SLL   TMP,16
         B        G0232                   B     ADD TO WORK
*                                            FET
FETQ     L        TMP,0(ADDR,CONSTR)      L     TMP,0(ADDR,CONSTR)
*                                            ADD TO WORK
G0232    C        WRKADR,G0355            C     WRKADR,END WORK ROLL LO
         BNL      G0233                   BNL   WORK FULL
         LA       WRKADR,4(0,WRKADR)      LA    WRKADR,4(0,WRKADR)
         ST       TMP,0(0,WRKADR)         ST    TMP,0(0,WRKADR)
         BR       POPXIT                  BR    POPXIT
         EJECT
*                                            POW
POWQ     SR       WRKADR,ADDR             SR    WRKADR,ADDR
         C        WRKADR,G0418            C     WRKADR,POW BASE WORK LO
         BNH      G0236                   BNH   ILLEGAL PRUNE WORK
         BR       POPXIT                  BR    POPXIT
*                                            PRUNE ONE OFF WORK
G0235    C        WRKADR,G0357            C     WRKADR,BASE WORK ROLL L
         BNH      G0236                   BNH   ILLEGAL PRUNE WORK
         S        WRKADR,G0345            S     WRKADR,FOUR ML
         BR       RETURN                  BR    RETURN
*                                            ILLEGAL PRUNE WORK
*                                            GRACEFUL BLOWUP
*                                            WORK FULL
GRBLOW   EQU      *
G0233    EQU      *
G0236    MVI      G0395+8,128             MVI   ERROR CNT ML+8,128
*                                            RELEASE CORE
G1009    LA       1,G0202+4(0,ROLLBR)     LA    1,ROLL DATA ADR TABLE+4
         L        15,G0377                L     15,IEYFORT REENTRY ORIG
         BR       15                      BR    15
*                                            XIT
XITQ     BR       POPADR                  BR    POPADR
*                                            ZER
ZERQ     SR       TMP,TMP                 SR    TMP,TMP
         B        G0228                   B     STORE IN G
*                                            NOZ
NOZQ     LA       TMP,1(0,0)              LA    TMP,1(0,0)
         STC      TMP,0(ADDR,CONSTR)      STC   TMP,0(ADDR,CONSTR)
         BR       POPXIT                  BR    POPXIT
*                                            TLY
TLYQ     L        TMP,0(ADDR,CONSTR)      L     TMP,0(ADDR,CONSTR)
         A        TMP,G0346               A     TMP,ONE ML
         B        G0228                   B     STORE IN G
*                                            PSP
PSPQ     L        TMP,0(0,WRKADR)         L     TMP,0(0,WRKADR)
         X        TMP,0(ADDR,CONSTR)      X     TMP,0(ADDR,CONSTR)
         BAL      RETURN,G0235            BAL   RETURN,PRUNE ONE OFF WO
         B        G0228                   B     STORE IN G
         EJECT
*                                            PLD
PLDQ     AR       ADDR,CONSTR             AR    ADDR,CONSTR
         MVC      G0431(8),0(ADDR)        MVC   MPAC 1(8),0(ADDR)
         BR       POPXIT                  BR    POPXIT
*                                            LSS
LSSQ     AR       ADDR,CONSTR             AR    ADDR,CONSTR
         MVC      G0422(8),0(ADDR)        MVC   SYMBOL 1(8),0(ADDR)
         BR       POPXIT                  BR    POPXIT
*                                            PST
PSTQ     AR       ADDR,CONSTR             AR    ADDR,CONSTR
         MVC      0(8,ADDR),G0431         MVC   0(8,ADDR),MPAC 1
         BR       POPXIT                  BR    POPXIT
*                                            PAD
PADQ     EQU      POPTABLE
         EJECT
*                                            EAD
EADQ     LH       TMP,2(ADDR,CONSTR)      LH    TMP,2(ADDR,CONSTR)
         N        TMP,G0392               N     TMP,HALF WORD MASK ML
         B        G0232                   B     ADD TO WORK
*                                            ETA
ETAQ     L        TMP,0(ADDR,CONSTR)      L     TMP,0(ADDR,CONSTR)
         N        TMP,G0348               N     TMP,TAG MASK 1 ML
         B        G0232                   B     ADD TO WORK
*                                            EOP
EOPQ     SR       TMP,TMP                 SR    TMP,TMP
         IC       TMP,1(ADDR,CONSTR)      IC    TMP,1(ADDR,CONSTR)
         B        G0232                   B     ADD TO WORK
*                                            IAD
IADQ     LH       TMP,2(ADDR,CONSTR)      LH    TMP,2(ADDR,CONSTR)
         STH      TMP,2(0,WRKADR)         STH   TMP,2(0,WRKADR)
         BR       POPXIT                  BR    POPXIT
*                                            ITA
ITAQ     IC       TMP,0(ADDR,CONSTR)      IC    TMP,0(ADDR,CONSTR)
         STC      TMP,0(0,WRKADR)         STC   TMP,0(0,WRKADR)
         BR       POPXIT                  BR    POPXIT
*                                            ITM
ITMQ     L        TMP,0(0,WRKADR)         L     TMP,0(0,WRKADR)
         N        TMP,G0350               N     TMP,MODE MASK 2 ML
         L        TMP1,0(ADDR,CONSTR)     L     TMP1,0(ADDR,CONSTR)
         N        TMP1,G0349              N     TMP1,MODE MASK 1 ML
         OR       TMP,TMP1                OR    TMP,TMP1
         ST       TMP,0(0,WRKADR)         ST    TMP,0(0,WRKADR)
         BR       POPXIT                  BR    POPXIT
*                                            JPE
JPEQ     LA       RETURN,JUNLQ
*                                            JPE QLK
JPEQLK   L        TMP,G0435                L    TMP,CRRNT CHAR
         ST       TMP,G0621               ST    TMP,JPE SAVE 1
         L        TMP,G0436               L     TMP,CRRNT CHAR CNT
         ST       TMP,G0623               ST    TMP,JPE SAVE 2
         L        TMP,G0506               L     TMP,LAST CHAR CNT
         ST       TMP,G0625               ST    TMP,JPE SAVE 3
         L        TMP,G0507               LAST SRC CARD CHAR CNT   3778
         ST       TMP,G0629               JPPE SAVE LAST SCCCC     3778
         LR       TMP,ADDR                LR    TMP,ADDR
         L        ADDR,G1002              L     ADDR,LOCAL JUMP BASE
         STM      POPADR,ADDR,G0626
         LR       ADDR,TMP                LR    ADDR,TMP
         MVI      G0499,1                 MVI   JPE FLAG,1
         BR       RETURN                   BR   RETURN
*                                            IOP
IOPQ     SRL      ADDR,2                  SRL   ADDR,2
         STC      ADDR,1(0,WRKADR)        STC   ADDR,1(0,WRKADR)
         BR       POPXIT                  BR    POPXIT
         EJECT
*                                            SAD
SADQ     LH       TMP,2(ADDR,CONSTR)      LH    TMP,2(ADDR,CONSTR)
         CH       TMP,2(0,WRKADR)         CH    TMP,2(0,WRKADR)
         BNE      G0266                   BNE   SET ANSWER FALSE
         B        G0265                   B     SET ANSWER TRUE
*                                            SPT
SPTQ     L        TMP2,G0348              L     TMP2,TAG MASK 1 ML
         B        G0256                   B     SPM END
*                                            SPM
SPMQ     L        TMP2,G0349              L     TMP2,MODE MASK 1 ML
*                                            SPM END
G0256    L        TMP1,G0084(0,ROLLBR)    L     TMP1,BOTTOM POLISH ROLL
         S        TMP1,G0345              S     TMP1,FOUR ML
         BAL      TMP,G0290               BAL   TMP,MAPT1 TO T1
         B        G0260                   B     STA END
*                                            STM
STMQ     L        TMP2,G0349              L     TMP2,MODE MASK 1 ML
         B        G0259                   B     STA LOAD END
*                                            STA
STAQ     L        TMP2,G0348              L     TMP2,TAG MASK 1 ML
*                                            STA LOAD END
G0259    LR       TMP1,WRKADR             LR    TMP1,WRKADR
*                                            STA END
G0260    L        TMP,0(ADDR,CONSTR)      L     TMP,0(ADDR,CONSTR)
         NR       TMP,TMP2                NR    TMP,TMP2
         N        TMP2,0(0,TMP1)          N     TMP2,0(0,TMP1)
         CR       TMP,TMP2                CR    TMP,TMP2
         BNE      G0266                   BNE   SET ANSWER FALSE
         B        G0265                   B     SET ANSWER TRUE
*                                            SOP
SOPQ     SRL      ADDR,2                  SRL   ADDR,2
         SR       TMP,TMP                 SR    TMP,TMP
         IC       TMP,1(0,WRKADR)         IC    TMP,1(0,WRKADR)
         CR       TMP,ADDR                CR    TMP,ADDR
         BNE      G0266                   BNE   SET ANSWER FALSE
         B        G0265                   B     SET ANSWER TRUE
         EJECT
*                                            SLE
SLEQ     L        TMP,0(0,WRKADR)         L     TMP,0(0,WRKADR)
         C        TMP,0(ADDR,CONSTR)      C     TMP,0(ADDR,CONSTR)
         BH       G0266                   BH    SET ANSWER FALSE
         B        G0265                   B     SET ANSWER TRUE
*                                            SNE
SNEQ     L        TMP,0(0,WRKADR)         L     TMP,0(0,WRKADR)
         C        TMP,0(ADDR,CONSTR)      C     TMP,0(ADDR,CONSTR)
         BE       G0266                   BE    SET ANSWER FALSE
         B        G0265                   B     SET ANSWER TRUE
*                                            SNZ
SNZQ     L        TMP,0(ADDR,CONSTR)      L     TMP,0(ADDR,CONSTR)
         LTR      TMP,TMP                 LTR   TMP,TMP
         BZ       G0266                   BZ    SET ANSWER FALSE
*                                            SET ANSWER TRUE
G0265    MVI      0(EXTADR),1             MVI   0(EXTADR),1
         BR       POPXIT                  BR    POPXIT
*                                            SET ANSWER FALSE
G0266    MVI      0(EXTADR),0             MVI   0(EXTADR),0
         BR       POPXIT                  BR    POPXIT
         EJECT
*                                            CSA
CSAQ     SRL      ADDR,2                  SRL   ADDR,2
         SR       TMP,TMP                 SR    TMP,TMP
         IC       TMP,G0435               IC    TMP,CRRNT CHAR
         CR       ADDR,TMP                CR    ADDR,TMP
         BNE      G0266                   BNE   SET ANSWER FALSE
         L        TEMP5,G0848A            ADR OF NEXT CHAR ML IN PAR
         BALR     RETURN,TEMP5
         B        G0265                   B     SET ANSWER TRUE
*                                            CSF
CSFQ     SRL      ADDR,2                  SRL   ADDR,2
         SR       TMP,TMP                 SR    TMP,TMP
         IC       TMP,G0435               IC    TMP,CRRNT CHAR
         CR       ADDR,TMP                CR    ADDR,TMP
         L        TEMP5,G0831A            SYNTAX FAIL ML IN PAR
         BCR      NEQUAL,TEMP5              BNE SYNTAX FAIL
         L        TEMP5,G0848A            ADR OF NEXT CHAR ML IN PAR
         BALR     RETURN,TEMP5
         BR       POPXIT                  BR    POPXIT
*                                            SCE
SCEQ     SRL      ADDR,2                  SRL   ADDR,2
         SR       TMP,TMP                 SR    TMP,TMP
         IC       TMP,G0435               IC    TMP,CRRNT CHAR
         CR       ADDR,TMP                CR    ADDR,TMP
         BNE      G0266                   BNE   SET ANSWER FALSE
         B        G0265                   B     SET ANSWER TRUE
*                                            QSF
QSFQ     L        TMP1,G0831A             SYNTAX FAIL ML ADR IN PAR
         B        G0272                   B     QUOTE SCAN COMMON
*                                            QSA
QSAQ     LA       TMP1,G0266              LA    TMP1,SET ANSWER FALSE
*                                            QUOTE SCAN COMMON
G0272    ST       TMP1,G0352              ST    TMP1,QUOTE SCAN SAVE ML
         MVC      G0352+4(16),G0435       QUOTE SCAN SAVE          6107
         L        TMP,G0507               LAST CARD SOURCE CRD CHAR6107
         ST       TMP,G0507S              SAVE LST SRC CARD CHAR   6107
         ST       POPXIT,G0419            ST    POPXIT,CAR SAVE
         L        POPXIT,QBADCN           L     POPXIT,QUOTE BASE ADCON
         LH       POPXIT,0(POPXIT,ADDR)    H    POPXIT,0(POPXIT,ADDR)
         LA       ADDR,1(0,ADDR)          LA    ADDR,1(0,ADDR)
#027201  LA       ADDR,1(0,ADDR)          LA    ADDR,1(0,ADDR)
         L        TMP1,QBADCN             L     TMP1,QUOTE BASE ADCON
         LA       TMP1,0(TMP1,ADDR)       LA    TMP1,0(TMP1,ADDR)
         CLC      G0435(1),0(TMP1)        CLC   CRRNT CHAR(1),0(TMP1)
         BNE      #027202                 BNE   #2
         L        TEMP5,G0848A            ADR OF NEXT CHAR ML IN PAR
         BALR     RETURN,TEMP5
         BCT      POPXIT,#027201          BCT   POPXIT,#1
         L        POPXIT,G0419            L     POPXIT,CAR SAVE
         B        G0265                   B     SET ANSWER TRUE
#027202  MVC      G0435(16),G0352+4       CRRNT CHAR & LAST CHAR CT6107
         L        TMP,G0507S              RESTORE LAST SOURCE CARD 6107
         ST       TMP,G0507               CHARACTER                6107
         L        TMP,G0352               L     TMP,QUOTE SCAN SAVE ML
         L        POPXIT,G0419            L     POPXIT,CAR SAVE
         BR       TMP                     BR    TMP
         EJECT
*                                            JSB
JSBQ     ST       POPADR,12(0,EXTADR)     ST    POPADR,12(0,EXTADR)
         L        POPADR,G1002            L     POPADR,LOCAL JUMP BASE
         L        TMP,0(PGB2,ADDR)        GLBLJT
         BAL      ADDR,G1003              BAL   ADDR,JSB STORE IN EXIT
         ST       POPADR,G1002            ST    POPADR,LOCAL JUMP BASE
         L        POPADR,12(0,EXTADR)     L     POPADR,12(0,EXTADR)
         B        G1001                   B     POPXIT SET
*                                            JOW GL
JOWGQ    EQU      *
G0275    LA       RETURN,G0279            LA    RETURN,JUN GL
*                                            JOW COMMON
G0276    L        TMP,0(0,WRKADR)         L     TMP,0(0,WRKADR)
         S        TMP,G0346               S     TMP,ONE ML
         BNL      G0220                   BNL   STORE IN W0
         B        G0235                   B     PRUNE ONE OFF WORK
*                                            JAF GL
JAFGQ    EQU      *
G0278    CLI      0(EXTADR),0             CLI   0(EXTADR),0
         BCR      7,POPXIT                BCR   7,POPXIT
         B        G0279                   B     JUN GL
*                                            JAT GL
JATGQ    EQU      *
G0277    CLI      0(EXTADR),0             CLI   0(EXTADR),0
         BCR      8,POPXIT                BCR   8,POPXIT
*                                            JUN GL
JUNGQ    EQU      *
G0279    L        TMP,0(PGB2,ADDR)        GLBLJT
         B        0(TMP,CONSTR)           B     0(TMP,CONSTR)
*                                            JOWL QLK
JOWLQLK  EQU      G0276
*                                            JOW LO
JOWLQ    EQU      *
G0280    LA       RETURN,G0283            LA    RETURN,JUN LO
         B        G0276                   B     JOW COMMON
*                                            JAF LO
JAFLQ    EQU      *
G0282    CLI      0(EXTADR),0             CLI   0(EXTADR),0
         BCR      7,POPXIT                BCR   7,POPXIT
         B        G0283                   B     JUN LO
*                                            JAT LO
JATLQ    EQU      *
G0281    CLI      0(EXTADR),0             CLI   0(EXTADR),0
         BCR      8,POPXIT                BCR   8,POPXIT
*                                            JUN LO
JUNLQ    EQU      *
G0283    SRL      ADDR,1                  SRL   ADDR,1
         A        ADDR,G1002
         LR       POPADR,ADDR
         BR       POPXIT                  BR    POPXIT
         EJECT
         EJECT
*                                            MOA
MOAQ     BAL      RETURN,G0293            BAL   RETURN,MOVE OFF SBR WIT
         B        G0266                   B     SET ANSWER FALSE
         MVI      0(EXTADR),1             MVI   0(EXTADR),1
         B        G0232                   B     ADD TO WORK
*                                            MOVE OFF SBR WITH ANSWER
G0293    L        TMP1,G0072(ADDR,ROLLBR)       TMP1,BOTTOM(ADDR,ROLLBR
         C        TMP1,G0071(ADDR,ROLLBR)       TMP1,TOP(ADDR,ROLLBR)
         BCR      NTHIGH,RETURN           BCR   NTHIGH,RETURN
         BAL      TMP,G0290               BAL   TMP,MAPT1 TO T1
         L        TMP,0(0,TMP1)           L     TMP,0(0,TMP1)
         L        TMP1,G0410              L     TMP1,MAPT1 SAVE
         S        TMP1,G0345              S     TMP1,FOUR ML
         ST       TMP1,G0072(ADDR,ROLLBR)  T    TMP1,BOTTOM(ADDR,ROLLBR
         B        4(0,RETURN)             B     4(0,RETURN)
*                                            FLP
FLPQ     LR       RETURN,POPXIT           LR    RETURN,POPXIT
*                                            FLP SBR
G0295    L        TMP1,G0071(ADDR,ROLLBR)       TMP1,TOP(ADDR,ROLLBR)
         L        TMP2,G0072(ADDR,ROLLBR)       TMP2,BOTTOM(ADDR,ROLLBR
#029501  LA       TMP1,4(0,TMP1)          LA    TMP1,4(0,TMP1)
         CR       TMP2,TMP1               CR    TMP2,TMP1
         BCR      NTHIGH,RETURN           BCR   NTHIGH,RETURN
         BAL      TMP,G0290               BAL   TMP,MAPT1 TO T1
         BAL      TMP,G0291               BAL   TMP,MAPT2 TO T2
         L        TMP3,0(0,TMP1)          L     TMP3,0(0,TMP1)
         L        TMP4,0(0,TMP2)          L     TMP4,0(0,TMP2)
         ST       TMP4,0(0,TMP1)          ST    TMP4,0(0,TMP1)
         ST       TMP3,0(0,TMP2)          ST    TMP3,0(0,TMP2)
         L        TMP1,G0410              L     TMP1,MAPT1 SAVE
         L        TMP2,G0411              L     TMP2,MAPT2 SAVE
         S        TMP2,G0345              S     TMP2,FOUR ML
         B        #029501                 B     #1
*                                            CAR
CARQ     BAL      RETURN,G0295            BAL   RETURN,FLP SBR
         L        TMP,0(0,WRKADR)         L     TMP,0(0,WRKADR)
         SLL      TMP,2(0)                SLL   TMP,2(0)
         ST       TMP,G0419+4             ST    TMP,CAR SAVE+4
         BAL      RETURN,G0235            BAL   RETURN,PRUNE ONE OFF WO
         ST       ADDR,G0419              ST    ADDR,CAR SAVE
#CARQ01  BAL      RETURN,G0293            BAL   RETURN,MOVE OFF SBR WIT
         B        RELQ                    B     REL
         L        ADDR,G0419+4            L     ADDR,CAR SAVE+4
         BAL      RETURN,G0285            BAL   RETURN,MOVE ON SBR
         L        ADDR,G0419              L     ADDR,CAR SAVE
         B        #CARQ01                 B     #1
*                                            CNT
CNTQ     L        TMP,G0072(ADDR,ROLLBR)  L     TMP,BOTTOM(ADDR,ROLLBR)
         S        TMP,G0071(ADDR,ROLLBR)  S     TMP,TOP(ADDR,ROLLBR)
         SRL      TMP,2                   SRL   TMP,2
         B        G0232                   B     ADD TO WORK
         EJECT
*                                            NOG
NOGQ     SR       TMP,TMP                 SR    TMP,TMP
         L        TMP1,G0072(ADDR,ROLLBR)       TMP1,BOTTOM(ADDR,ROLLBR
         S        TMP1,G0071(ADDR,ROLLBR)       TMP1,TOP(ADDR,ROLLBR)
         LH       TMP2,G0076(ADDR,ROLLBR)  H    TMP2,GROUP SIZE(ADDR,RO
         DR       TMP,TMP2                DR    TMP,TMP2
         LR       TMP,TMP1                LR    TMP,TMP1
         B        G0232                   B     ADD TO WORK
*                                            RSV
RSVQ     L        TMP,G0071(ADDR,ROLLBR)  L     TMP,TOP(ADDR,ROLLBR)
         S        TMP,G0070(ADDR,ROLLBR)  S     TMP,BASE(ADDR,ROLLBR)
         BAL      RETURN,G0285            BAL   RETURN,MOVE ON SBR
         L        TMP,G0072(ADDR,ROLLBR)  L     TMP,BOTTOM(ADDR,ROLLBR)
         ST       TMP,G0071(ADDR,ROLLBR)  ST    TMP,TOP(ADDR,ROLLBR)
         BR       POPXIT                  BR    POPXIT
*                                            REL
RELQ     L        TMP1,G0071(ADDR,ROLLBR)       TMP1,TOP(ADDR,ROLLBR)
         C        TMP1,G0070(ADDR,ROLLBR)       TMP1,BASE(ADDR,ROLLBR)
         BE       #RELQ01                 BE    #1
         BAL      TMP,G0290               BAL   TMP,MAPT1 TO T1
         L        TMP1,0(0,TMP1)          L     TMP1,0(0,TMP1)
         A        TMP1,G0070(ADDR,ROLLBR)       TMP1,BASE(ADDR,ROLLBR)
         ST       TMP1,G0071(ADDR,ROLLBR)  T    TMP1,TOP(ADDR,ROLLBR)
         L        TMP1,G0410              L     TMP1,MAPT1 SAVE
         S        TMP1,G0345              S     TMP1,FOUR ML
#RELQ01  ST       TMP1,G0072(ADDR,ROLLBR)  T    TMP1,BOTTOM(ADDR,ROLLBR
         BR       POPXIT                  BR    POPXIT
*                                            SRD
SRDQ     L        TMP,G0072(ADDR,ROLLBR)  L     TMP,BOTTOM(ADDR,ROLLBR)
         C        TMP,G0071(ADDR,ROLLBR)  C     TMP,TOP(ADDR,ROLLBR)
         BE       G0266                   BE    SET ANSWER FALSE
         B        G0265                   B     SET ANSWER TRUE
*                                            PNG
PNGQ     L        TMP,G0072(ADDR,ROLLBR)  L     TMP,BOTTOM(ADDR,ROLLBR)
         S        TMP,G0071(ADDR,ROLLBR)  S     TMP,TOP(ADDR,ROLLBR)
         SLL      ADDR,14                 SLL   ADDR,14
         OR       TMP,ADDR                OR    TMP,ADDR
         LA       TMP,4(0,TMP)            LA    TMP,4(0,TMP)
         B        G0232                   B     ADD TO WORK
*                                            PGO
PGOQ     LH       TMP1,G0073(ADDR,ROLLBR)  H    TMP1,DISP FROM SYMBOL(A
         LA       TMP1,G0422(TMP1)        LA    TMP1,SYMBOL 1(TMP1)
         LH       TMP2,G0076(ADDR,ROLLBR)  H    TMP2,GROUP SIZE(ADDR,RO
#PGOQ01  L        TMP,0(0,TMP1)           L     TMP,0(0,TMP1)
         STM      TMP1,TMP2,G0368         STM   TMP1,TMP2,PGO SAVE ML
         BAL      RETURN,G0285            BAL   RETURN,MOVE ON SBR
         LM       TMP1,TMP2,G0368         LM    TMP1,TMP2,PGO SAVE ML
         LA       TMP1,4(0,TMP1)          LA    TMP1,4(0,TMP1)
         S        TMP2,G0345              S     TMP2,FOUR ML
         BH       #PGOQ01                 BH    #1
         BR       POPXIT                  BR    POPXIT
         EJECT
*                                            BOP
BOPQ     LR       TMP,ADDR                LR    TMP,ADDR
         A        TMP,G0370               A     TMP,CONTROL DRIVER OP M
         LA       ADDR,G0062(0,0)         LA    ADDR,POLISH ROLL X4(0,0
         BAL      RETURN,G0285            BAL   RETURN,MOVE ON SBR
         BR       POPXIT                  BR    POPXIT
*                                            MOC
MOCQ     LA       ADDR,4(0,ADDR)          LA    ADDR,4(0,ADDR)
         SRL      ADDR,3                  SRL   ADDR,3
         ST       POPXIT,G0368            ST    POPXIT,MOC SAVE ML
         LR       POPXIT,ADDR             LR    POPXIT,ADDR
         LA       ADDR,G0063(0,0)         LA    ADDR,CODE ROLL X4(0,0)
         LR       TMP,POPXIT              LR    TMP,POPXIT
         O        TMP,G0388               O     TMP,POC PSUEDO OP ML
         BAL      RETURN,G0285            BAL   RETURN,MOVE ON SBR
#MOCQ01  L        TMP1,G0369              L     TMP1,ADR OF LOC CNTR ML
         L        TMP2,0(0,TMP1)          L     TMP2,0(0,TMP1)
         TM       0(WRKADR),192           TM    0(WRKADR),192
         BZ       #MOCQ02                 BZ    #2
         LA       TMP2,2(0,TMP2)          LA    TMP2,2(0,TMP2)
#MOCQ02  LA       TMP2,2(0,TMP2)          LA    TMP2,2(0,TMP2)
         ST       TMP2,0(0,TMP1)          ST    TMP2,0(0,TMP1)
         L        TMP,0(0,WRKADR)         L     TMP,0(0,WRKADR)
         BAL      RETURN,G0285            BAL   RETURN,MOVE ON SBR
         BAL      RETURN,G0235            BAL   RETURN,PRUNE ONE OFF WO
         BCT      POPXIT,#MOCQ01          BCT   POPXIT,#1
         L        POPXIT,G0368            L     POPXIT,MOC SAVE ML
         BR       POPXIT                  BR    POPXIT
*                                            POC
POCQ     STM      EXTADR,POPXIT,G0368
         L        POPXIT,G0389            L     POPXIT,POC BASE ML
         AR       POPXIT,ADDR             AR    POPXIT,ADDR
         LA       ADDR,G0063(0,0)         LA    ADDR,CODE ROLL X4(0,0)
         LH       TMP,2(0,POPXIT)         LH    TMP,2(0,POPXIT)
         LA       TMP,1(0,TMP)            LA    TMP,1(0,TMP)
         SRL      TMP,1                   SRL   TMP,1
         LR       EXTADR,TMP              LR    EXTADR,TMP
         O        TMP,G0388               O     TMP,POC PSUEDO OP ML
         BAL      RETURN,G0285            BAL   RETURN,MOVE ON SBR
#POCQ01  LA       POPXIT,4(0,POPXIT)      LA    POPXIT,4(0,POPXIT)
         L        TMP1,G0369              L     TMP1,ADR OF LOC CNTR ML
         L        TMP,0(0,TMP1)           L     TMP,0(0,TMP1)
         TM       0(POPXIT),192           TM    0(POPXIT),192
         BZ       #POCQ02                 BZ    #2
         LA       TMP,2(0,TMP)            LA    TMP,2(0,TMP)
#POCQ02  LA       TMP,2(0,TMP)            LA    TMP,2(0,TMP)
         ST       TMP,0(0,TMP1)           ST    TMP,0(0,TMP1)
         L        TMP,0(0,POPXIT)         L     TMP,0(0,POPXIT)
         BAL      RETURN,G0285            BAL   RETURN,MOVE ON SBR
         BCT      EXTADR,#POCQ01          BCT   EXTADR,#1
         LM       EXTADR,POPXIT,G0368     LM    EXTADR,POPXIT,POC SAVE
         BR       POPXIT                  BR    POPXIT
         EJECT
*                                            SBP
SBPQ     LR       TMP4,ADDR               LR    TMP4,ADDR
         SR       TMP1,TMP1               SR    TMP1,TMP1
         BAL      RETURN,G0328            BAL   RETURN,CALCULATE ADDRES
         L        TMP1,G0410              L     TMP1,MAPT1 SAVE
         BAL      RETURN,G0235            BAL   RETURN,PRUNE ONE OFF WO
         LR       ADDR,TMP2               LR    ADDR,TMP2
         B        G0309                   B     SEARCH BY STATS FROM PN
*                                            SBS
SBSQ     LR       TMP4,ADDR               LR    TMP4,ADDR
         L        ADDR,0(TMP4,CONSTR)     L     ADDR,0(TMP4,CONSTR)
         L        TMP1,G0071(ADDR,ROLLBR)       TMP1,TOP(ADDR,ROLLBR)
*                                            SEARCH BY STATS FROM PNTR
G0309    C        TMP1,G0072(ADDR,ROLLBR)       TMP1,BOTTOM(ADDR,ROLLBR
         BNL      G0266                   BNL   SET ANSWER FALSE
         LH       TMP,4(TMP4,CONSTR)      LH    TMP,4(TMP4,CONSTR)
         LA       TMP,G0422(TMP)          LA    TMP,SYMBOL 1(TMP)
         LH        TMP3,6(TMP4,CONSTR)                          35138
         LR        TMP0,TMP3                                    35138
         LA        TMP1,4(TMP3,TMP1)                            35138
         LH       TMP2,10(TMP4,CONSTR)    LH    TMP2,10(TMP4,CONSTR)
         A         TMP3,G0072(ADDR,ROLLBR)                     35138
         LH       TMP4,8(TMP4,CONSTR)     LH    TMP4,8(TMP4,CONSTR)
         LA       RETURN,G0232            LA    RETURN,ADD TO WORK
         B        G0313                   B     SPECIAL SEARCH ENTRY
*                                            SFP
SFPQ     LA       RETURN,JUNLQ             LA   RETURN,JUNLQ
         ST       ADDR,G0373               ST   ADDR,G0373
*                                            SFP QLK
SFPQLK   ST       RETURN,G0373+4           ST   RETURN,G0373+4
         SR       TMP1,TMP1               SR    TMP1,TMP1
         BAL      RETURN,G0328            BAL   RETURN,CALCULATE ADDRES
         L        TMP1,G0410              L     TMP1,MAPT1 SAVE
         BAL      RETURN,G0235            BAL   RETURN,PRUNE ONE OFF WO
         LR       ADDR,TMP2               LR    ADDR,TMP2
         BAL      RETURN,G0312            BAL   RETURN,CONTINUE SEARCH
         C        WRKADR,G0355            C     WRKADR,END WORK ROLL LO
         BNL      G0233                   BNL   WORK FULL
         LA       WRKADR,4(0,WRKADR)      LA    WRKADR,4(0,WRKADR)
         ST       TMP,0(0,WRKADR)         ST    TMP,0(0,WRKADR)
         L        ADDR,G0373              L     ADDR,SEARCH FROM PNTR S
         L        RETURN,G0373+4           L    RETURN,G0373+4
         BR       RETURN                   BR   RETURN
         EJECT
*                                            SRA
SRAQ     LA       RETURN,G0232            LA    RETURN,ADD TO WORK
         L        TMP1,G0071(ADDR,ROLLBR)       TMP1,TOP(ADDR,ROLLBR)
*                                            CONTINUE SEARCH ENTRY
G0312    C        TMP1,G0072(ADDR,ROLLBR)       TMP1,BOTTOM(ADDR,ROLLBR
         BNL      G0266                   BNL   SET ANSWER FALSE
         LH       TMP,G0073(ADDR,ROLLBR)  LH    TMP,DISP FROM SYMBOL(AD
         LA       TMP,G0422(TMP)          LA    TMP,SYMBOL 1(TMP)
         LH       TMP3,G0074(ADDR,ROLLBR)  H    TMP3,DISP FROM PNTR(ADD
         LR       TMP0,TMP3               LR    TMP0,TMP3
         AR       TMP,TMP3                AR    TMP,TMP3
         LA       TMP1,4(TMP3,TMP1)       LA    TMP1,4(TMP3,TMP1)
         LH       TMP2,G0076(ADDR,ROLLBR)  H    TMP2,GROUP SIZE(ADDR,RO
         A        TMP3,G0072(ADDR,ROLLBR)       TMP3,BOTTOM(ADDR,ROLLBR
         LH       TMP4,G0075(ADDR,ROLLBR)  H    TMP4,COMP GROUP SIZE(AD
*                                            SPECIAL SEARCH ENTRY
G0313    ST       TMP1,G0405              ST    TMP1,SEARCH SAVE
         ST       TMP3,G0405+4            ST    TMP3,SEARCH SAVE+4
         N        TMP1,G1011              N     TMP1,ADR TABLE MASK ML
         N        TMP3,G1011              N     TMP3,ADR TABLE MASK ML
         CR       TMP1,TMP3               CR    TMP1,TMP3
         BNE      #031310                 BNE   #10
         L        TMP1,G0405+4            L     TMP1,SEARCH SAVE+4
         ST       TMP,G0405+4             ST    TMP,SEARCH SAVE+4
         BAL      TMP,G0290               BAL   TMP,MAPT1 TO T1
         LR       TMP3,TMP1               LR    TMP3,TMP1
         L        TMP1,G0405              L     TMP1,SEARCH SAVE
         BAL      TMP,G0290               BAL   TMP,MAPT1 TO T1
         L        TMP,G0405+4             L     TMP,SEARCH SAVE+4
#031305  EX       TMP4,#031306            EX    TMP4,#6
         BE       #031307                 BE    #7
         BXLE     TMP1,TMP2,#031305       BXLE  TMP1,TMP2,#5
         B        G0266                   B     SET ANSWER FALSE
#031306  CLC      0(0,TMP),0(TMP1)        CLC   0(0,TMP),0(TMP1)
#031307  SR       TMP3,TMP1               SR    TMP3,TMP1
         L        TMP1,G0072(ADDR,ROLLBR)       TMP1,BOTTOM(ADDR,ROLLBR
         SR       TMP1,TMP3               SR    TMP1,TMP3
         B        #031304                 B     #4
#031310  L        TMP1,G0405              L     TMP1,SEARCH SAVE
         L        TMP3,G0405+4            L     TMP3,SEARCH SAVE+4
         LA       TMP4,1(0,TMP4)          LA    TMP4,1(0,TMP4)
         ST       TMP4,G0405              ST    TMP4,SEARCH SAVE
#031315  STM      TMP,TMP1,G0405+4         TM   TMP,TMP1,SEARCH SAVE+4
#031301  ST       TMP,G0405+12            ST    TMP,SEARCH SAVE+12
         BAL      TMP,G0290               BAL   TMP,MAPT1 TO T1
         L        TMP,G0405+12            L     TMP,SEARCH SAVE+12
         CLC      0(1,TMP),0(TMP1)        CLC   0(1,TMP),0(TMP1)
         BNE      #031302                 BNE   #2
         LA       TMP,1(0,TMP)            LA    TMP,1(0,TMP)
         L        TMP1,G0410              L     TMP1,MAPT1 SAVE
         LA       TMP1,1(0,TMP1)          LA    TMP1,1(0,TMP1)
         BCT      TMP4,#031301            BCT   TMP4,#1
         B        #031303                 B     #3
#031302  LM       TMP,TMP1,G0405+4         M    TMP,TMP1,SEARCH SAVE+4
         AR       TMP1,TMP2               AR    TMP1,TMP2
         CR       TMP1,TMP3               CR    TMP1,TMP3
         BH       G0266                   BH    SET ANSWER FALSE
         L        TMP4,G0405              L     TMP4,SEARCH SAVE
         B        #031315                 B     #15
#031303  L        TMP1,G0405+8            L     TMP1,SEARCH SAVE+8
         SR       TMP1,TMP0               SR    TMP1,TMP0
#031304  S        TMP1,G0071(ADDR,ROLLBR)       TMP1,TOP(ADDR,ROLLBR)
         LR       TMP,ADDR                LR    TMP,ADDR
         SLL      TMP,14                  SLL   TMP,14
         OR       TMP,TMP1                OR    TMP,TMP1
         MVI      0(EXTADR),1             MVI   0(EXTADR),1
         BR       RETURN                  BR    RETURN
*                                            LCT
LCTQ     CLI      0(EXTADR),0             CLI   0(EXTADR),0
         BCR      8,POPXIT                BCR   8,POPXIT
         B        LCEQ                    B     LCE
*                                            LCF
LCFQ     CLI      0(EXTADR),0             CLI   0(EXTADR),0
         BCR      7,POPXIT                BCR   7,POPXIT
*                                            LCE
LCEQ     SR       TMP,TMP                 SR    TMP,TMP
         L        TMP1,MBADCN             L     TMP1,MESSAGE BASE ADCON
         IC       TMP,0(ADDR,TMP1)        IC    TMP,0(ADDR,TMP1)
         C        TMP,G0537               C     TMP,MAX STA ERROR NUMBE
         BNH      #LCEQ01                 BNH   #1
         ST       TMP,G0537               ST    TMP,MAX STA ERROR NUMBE
#LCEQ01  LR       TMP,ADDR                LR    TMP,ADDR
         LA       ADDR,G0065(0,0)         LA    ADDR,ERROR ROLL X4(0,0)
         BAL      RETURN,G0285            BAL   RETURN,MOVE ON SBR
         L        TMP,G0506               L     TMP,LAST CHAR CNT
         BAL      RETURN,G0285            BAL   RETURN,MOVE ON SBR
         BR       POPXIT                  BR    POPXIT
         EJECT
*                                            LGP
LGPQ     BAL      RETURN,G0320            BAL   RETURN,LGP AND PGP COMM
#LGPQ01  BAL      TMP,G0290               BAL   TMP,MAPT1 TO T1
         LH       TMP,0(0,TMP1)           LH    TMP,0(0,TMP1)
         STH      TMP,0(0,TMP2)           STH   TMP,0(0,TMP2)
         L        TMP1,G0410              L     TMP1,MAPT1 SAVE
         LA       TMP1,2(0,TMP1)          LA    TMP1,2(0,TMP1)
         LA       TMP2,2(0,TMP2)          LA    TMP2,2(0,TMP2)
         S        TMP3,G0374              S     TMP3,TWO ML
         BH       #LGPQ01                 BH    #1
         BR       POPXIT                  BR    POPXIT
*                                            PGP
PGPQ     BAL      RETURN,G0320            BAL   RETURN,LGP AND PGP COMM
*                                            PGP AND LGP COMMON END
G0319    BAL      TMP,G0290               BAL   TMP,MAPT1 TO T1
         LH       TMP,0(0,TMP2)           LH    TMP,0(0,TMP2)
         STH      TMP,0(0,TMP1)           STH   TMP,0(0,TMP1)
         L        TMP1,G0410              L     TMP1,MAPT1 SAVE
         LA       TMP1,2(0,TMP1)          LA    TMP1,2(0,TMP1)
         LA       TMP2,2(0,TMP2)          LA    TMP2,2(0,TMP2)
         S        TMP3,G0374              S     TMP3,TWO ML
         BH       G0319                   BH    PGP AND LGP COMMON END
         BR       POPXIT                  BR    POPXIT
*                                            LGP AND PGP COMMON SBR
G0320    LR       TMP4,RETURN             LR    TMP4,RETURN
         SR       TMP1,TMP1               SR    TMP1,TMP1
         BAL      RETURN,G0328            BAL   RETURN,CALCULATE ADDRES
         L        TMP1,G0410              L     TMP1,MAPT1 SAVE
         LTR      TMP3,ADDR               LTR   TMP3,ADDR
         BNZ      #032002                 BNZ   #2
         LH       TMP3,G0076(TMP2,ROLLBR)  H    TMP3,GROUP SIZE(TMP2,RO
#032001  AH       TMP1,G0074(TMP2,ROLLBR)  H    TMP1,DISP FROM PNTR(TMP
         LH       TMP2,G0073(TMP2,ROLLBR)  H    TMP2,DISP FROM SYMBOL(T
         LA       TMP2,G0422(TMP2)        LA    TMP2,SYMBOL 1(TMP2)
         BR       TMP4                    BR    TMP4
#032002  SRL      TMP3,2                  SRL   TMP3,2
         B        #032001                 B     #1
*                                            LGA
LGAQ     L        TMP1,G0072(ADDR,ROLLBR)       TMP1,BOTTOM(ADDR,ROLLBR
         C        TMP1,G0071(ADDR,ROLLBR)       TMP1,TOP(ADDR,ROLLBR)
         BNH      G0266                   BNH   SET ANSWER FALSE
         LH       TMP3,G0076(ADDR,ROLLBR)  H    TMP3,GROUP SIZE(ADDR,RO
         LR       TMP,TMP1                LR    TMP,TMP1
         SR       TMP,TMP3                SR    TMP,TMP3
         ST       TMP,G0072(ADDR,ROLLBR)  ST    TMP,BOTTOM(ADDR,ROLLBR)
         SRL      TMP3,2                  SRL   TMP3,2
         LH       TMP2,G0073(ADDR,ROLLBR)  H    TMP2,DISP FROM SYMBOL(A
         LA       TMP2,G0422(TMP2)        LA    TMP2,SYMBOL 1(TMP2)
#LGAQ01  BAL      TMP,G0290               BAL   TMP,MAPT1 TO T1
         MVC      0(4,TMP2),0(TMP1)       MVC   0(4,TMP2),0(TMP1)
         LA       TMP2,4(0,TMP2)          LA    TMP2,4(0,TMP2)
         L        TMP1,G0410              L     TMP1,MAPT1 SAVE
         S        TMP1,G0345              S     TMP1,FOUR ML
         BCT      TMP3,#LGAQ01            BCT   TMP3,#1
         CLC      G0376(4),G0422          CLC   BLANK WORD ML(4),SYMBOL
         BE       G0266                   BE    SET ANSWER FALSE
         B        G0265                   B     SET ANSWER TRUE
*                                            CPO
CPOQ     STM      EXTADR,POPXIT,G0368
         SR       TMP1,TMP1               SR    TMP1,TMP1
         BAL      RETURN,G0328            BAL   RETURN,CALCULATE ADDRES
         L        POPXIT,0(0,TMP1)        L     POPXIT,0(0,TMP1)
         LA       EXTADR,4(0,0)           LA    EXTADR,4(0,0)
#CPOQ01  LR       TMP1,EXTADR             LR    TMP1,EXTADR
         BAL      RETURN,G0328            BAL   RETURN,CALCULATE ADDRES
         L        TMP,0(0,TMP1)           L     TMP,0(0,TMP1)
         BAL      RETURN,G0285            BAL   RETURN,MOVE ON SBR
         LA       EXTADR,4(0,EXTADR)      LA    EXTADR,4(0,EXTADR)
         BCT      POPXIT,#CPOQ01          BCT   POPXIT,#1
         LM       EXTADR,POPXIT,G0368     LM    EXTADR,POPXIT,CPO SAVE
         BAL      RETURN,G0235            BAL   RETURN,PRUNE ONE OFF WO
         BR       POPXIT                  BR    POPXIT
*                                            ARK
ARKQ     LR       TMP4,POPXIT             LR    TMP4,POPXIT
         B        G0325                   B     ARK AND ARP COMMON END
*                                            ARP
ARPQ     LA       TMP4,POWQ               LA    TMP4,POW
*                                            ARK AND ARP COMMON END
G0325    BAL      RETURN,G0235            BAL   RETURN,PRUNE ONE OFF WO
         L        TMP1,0(ADDR,CONSTR)     L     TMP1,0(ADDR,CONSTR)
         BAL      RETURN,G0328            BAL   RETURN,CALCULATE ADDRES
         L        TMP,4(0,WRKADR)         L     TMP,4(0,WRKADR)
         ST       TMP,0(0,TMP1)           ST    TMP,0(0,TMP1)
         LA       ADDR,4(0,0)             LA    ADDR,4(0,0)
         BR       TMP4                    BR    TMP4
         EJECT
*                                            FRK
FRKQ     L        TMP1,0(ADDR,CONSTR)     L     TMP1,0(ADDR,CONSTR)
         BAL      RETURN,G0328            BAL   RETURN,CALCULATE ADDRES
         L        TMP,0(0,TMP1)           L     TMP,0(0,TMP1)
         B        G0232                   B     ADD TO WORK
*                                            FRP
FRPQ     L        TMP1,0(ADDR,CONSTR)     L     TMP1,0(ADDR,CONSTR)
         BAL      RETURN,G0328            BAL   RETURN,CALCULATE ADDRES
         L        TMP,0(0,TMP1)           L     TMP,0(0,TMP1)
         B        G0220                   B     STORE IN W0
*                                            CALCULATE ADDRESS FROM PNT
G0328    L        TMP2,G0392              CALCULATE MACHINE ADDR   3123
         N        TMP2,0(0,WRKADR)        FROM DISPLACEMENT AND    3123
         AR       TMP1,TMP2               ROLL NUMBER IN POINTER   3123
         SR       TMP2,TMP2               IN W0                    3123
         IC       TMP2,1(0,WRKADR)                                 3123
         SLL      TMP2,2                                           3123
         A        TMP1,G0071(TMP2,ROLLBR)       TMP1,TOP(TMP2,ROLLBR)
         BAL      TMP,G0290               BAL   TMP,MAPT1 TO T1
         BR       RETURN                  BR    RETURN
*                                            SCK
SCKQ     MVI      0(EXTADR),1             MVI   0(EXTADR),1
         BAL      RETURN,G0330            BAL   RETURN,SCK SUBROUTINE
         MVI      0(EXTADR),0             MVI   0(EXTADR),0
         BR       POPXIT                  BR    POPXIT
*                                            SCK SUBROUTINE
G0330    TM       G0435,192               TM    CRRNT CHAR,192
         BO       #033001                 BO    #1
         CLI      G0497,0                 CLI   BCD FLAG,0
         BCR      NEQUAL,RETURN           BCR   NEQUAL,RETURN
         CLI      G0435,G0097             CLI   CRRNT CHAR,DOLLAR SIGN
         BCR      NEQUAL,RETURN           BCR   NEQUAL,RETURN
         LA       TMP4,G0192(0,0)         LA    TMP4,LETTER KEY X4(0,0)
         B        #033002                 B     #2
#033001  SR       TMP4,TMP4               SR    TMP4,TMP4
         IC       TMP4,G0435              IC    TMP4,CRRNT CHAR
         IC       TMP4,G0400-192(TMP4)    IC    TMP4,SCK TABLE ML-192(T
#033002  NR       TMP4,ADDR               NR    TMP4,ADDR
         BM       4(0,RETURN)             BM    4(0,RETURN)
         BR       RETURN                  BR    RETURN
         EJECT
*                                            JRD
JRDQ     SR       TMP,TMP                 SR    TMP,TMP
         IC       TMP,1(0,WRKADR)         IC    TMP,1(0,WRKADR)
         SLL      TMP,2                   SLL   TMP,2
         LH       TMP1,2(0,WRKADR)        LH    TMP1,2(0,WRKADR)
         LTR      TMP1,TMP1               LTR   TMP1,TMP1
         BNE      #JRDQ01                 BNE   #1
         LA       TMP1,4(0,TMP1)          LA    TMP1,4(0,TMP1)
         B        #JRDQ02                 B     #2
#JRDQ01  AH       TMP1,G0076(TMP,ROLLBR)  AH    TMP1,GROUP SIZE(TMP,ROL
#JRDQ02  STH      TMP1,2(0,WRKADR)        STH   TMP1,2(0,WRKADR)
         A        TMP1,G0071(TMP,ROLLBR)  A     TMP1,TOP(TMP,ROLLBR)
         C        TMP1,G0072(TMP,ROLLBR)  C     TMP1,BOTTOM(TMP,ROLLBR)
         BCR      13,POPXIT               BCR   13,POPXIT
         LA       RETURN,G0279            LA    RETURN,JUN GL
         B        G0235                   B     PRUNE ONE OFF WORK
*                                            DIM
DIMQ     L        TMP,0(ADDR,CONSTR)      L     TMP,0(ADDR,CONSTR)
         S        TMP,G0346               S     TMP,ONE ML
         ST       TMP,0(ADDR,CONSTR)      ST    TMP,0(ADDR,CONSTR)
         BR       POPXIT                  BR    POPXIT
*                                            IOR
IORQ     L        TMP,0(0,WRKADR)         L     TMP,0(0,WRKADR)
         O        TMP,0(ADDR,CONSTR)      O     TMP,0(ADDR,CONSTR)
         ST       TMP,0(0,WRKADR)         ST    TMP,0(0,WRKADR)
         BR       POPXIT                  BR    POPXIT
*                                            CRP
CRPQ     STM      POPADR,POPXIT,G0419     STM POPADR,POPXIT,CRP SAVE ML
         SR       EXTADR,EXTADR           SR    EXTADR,EXTADR
         SR       TMP1,TMP1               SR    TMP1,TMP1
         BAL      RETURN,G0328            BAL   RETURN,CALCULATE ADDRES
         L        TMP1,G0410              L     TMP1,MAPT1 SAVE
         S        TMP1,G0345              S     TMP1,FOUR ML
         L        POPADR,G0072(TMP2,ROLLBR)     POPADR,BOTTOM(TMP2,ROLL
         SR       POPADR,TMP1             SR    POPADR,TMP1
         SRL      POPADR,2                SRL   POPADR,2
         LR       POPXIT,TMP2             LR    POPXIT,TMP2
         S        TMP1,G0071(TMP2,ROLLBR)       TMP1,TOP(TMP2,ROLLBR)
         ST       TMP1,G0368              ST    TMP1,DISP FROM CRP TOP
#CRPQ01  LR       TMP1,EXTADR             LR    TMP1,EXTADR
         BAL      RETURN,G0328            BAL   RETURN,CALCULATE ADDRES
         L        TMP,0(0,TMP1)           L     TMP,0(0,TMP1)
         BAL      RETURN,G0285            BAL   RETURN,MOVE ON SBR
         LA       EXTADR,4(0,EXTADR)      LA    EXTADR,4(0,EXTADR)
         BCT      POPADR,#CRPQ01          BCT   POPADR,#1
         L        TMP1,G0071(POPXIT,ROLLBR)     TMP1,TOP(POPXIT,ROLLBR)
         A        TMP1,G0368              A     TMP1,DISP FROM CRP TOP
         ST       TMP1,G0072(POPXIT,ROLLBR)     TMP1,BOTTOM(POPXIT,ROLL
         LM       POPADR,POPXIT,G0419     LM  POPADR,POPXIT,CRP SAVE ML
         BR       POPXIT                  BR    POPXIT
         EJECT
*                                            GET A CARD
G0335    L        15,G0379                L     15,IEYREAD ADCON ML
         BALR     14,15                   BALR  14,15
         ST       1,G0385                 ST    1,CURR READ BUF ML
         BR       RETURN                  BR    RETURN
*                                            PRINT THE BUFFER
G0336    L        1,G0386                 L     1,PRINT BUFFER ORG ML
         L        15,G0380                L     15,IEYPRNT ADCON ML
         BALR     14,15                   BALR  14,15
         BR       RETURN                  BR    RETURN
         EJECT
*                                            PRTLN
PRTLN    EQU      *
G0337    B        #033701                 B     #1
         B        #033702                 B     #2
#033701  LA       0,120(0,0)              LA    0,120(0,0)
         L        1,G0386                 L     1,PRINT BUFFER ORG ML
         L        15,G0380                L     15,IEYPRNT ADCON ML
         BALR     14,15                   BALR  14,15
#033702  L        1,G0386                 L     1,PRINT BUFFER ORG ML
         LA       TMP,15(0,0)             LA    TMP,15(0,0)
*                                            PRTLN PCHCD COMMON
G0338    LR       TMP1,1                  LR    TMP1,1
         LD       FLTR0,G0376             LD    FLTR0,BLANK WORD ML
#033801  STD      FLTR0,0(0,TMP1)         STD   FLTR0,0(0,TMP1)
         LA       TMP1,8(0,TMP1)          LA    TMP1,8(0,TMP1)
         BCT      TMP,#033801             BCT   TMP,#1
         BR       RETURN                  BR    RETURN
*                                            PCHCD
PCHCD    EQU      *
G0339    B        #033901                 B     #1
         B        #033902                 B     #2
#033901  L        1,G0387                 L     1,PUNCH BUFFER ORG ML
         L        15,G0381                L     15,IEYPCH ADCON ML
         BALR     14,15                   BALR  14,15
#033902  L        1,G0387                 L     1,PUNCH BUFFER ORG ML
         LA       TMP,10(0,0)             LA    TMP,10(0,0)
         B        G0338                   B     PRTLN PCHCD COMMON
*                                            BIN
BINQ     L        LOC,G0382               L     LOC,BIN ADCON ML
         BR       LOC                     BR    LOC
*                                            BIM
BIMQ     L        LOC,G0383               L     LOC,BIM ADCON ML
         BR       LOC                     BR    LOC
*                                            BID
BIDQ     L        LOC,G0384               L     LOC,BID ADCON ML
         BR       LOC                     BR    LOC
         EJECT
         DS       0F
*                                            LOCAL JUMP BASE
LJBASE   EQU      *
G1002    DC       X'00000000'
ABSWORK  DS       F
ABSEXIT  DS       F
ARBASE   DS       F
AINITDB  DS       F
APCHCD   DC       A(PCHCD)
APRTLN   DC       A(PRTLN)
APARSAV  DC       A(PARSAV)
AALLSAV  DC       A(ALLSAV)
AUNFSAV  DC       A(UNFSAV)
AGRBLOW  DC       A(GRBLOW)
AIEYCMR  DC       A(IEYCMR)
AIEYRTN  DS       F
ANEXT    DS       F
AMOVONS  DC       A(MOVONS)
ALOCADR  DS       F
ABINPOP  DS       F
ABIMPOP  DS       F
ABIDPOP  DS       F
APOCDAT  DS       F
G0364    EQU      AINITDB
G0369    EQU      ALOCADR
G0377    EQU      AIEYRTN
G0382    EQU      ABINPOP
G0383    EQU      ABIMPOP
G0384    EQU      ABIDPOP
G0389    EQU      APOCDAT
         EJECT                                                     4615
*                                       MON                        4615
MONQ     L     TMP,0(0,WRKADR)                                     4615
         BAL   RETURN,G0235            PRUNE ONE OFF WORK          4615
         LR    RETURN,POPXIT                                       4615
*                                       MOVONS                     4615
*                                       MOVE ON SBR                4615
*                                       MOVE ON RECYCLE            4615
MOVONS   EQU   *                                                   4615
G0286    EQU   *                                                   4615
G0285    L     TMP1,G0072(ADDR,ROLLBR)       BOTTOM                4615
         C     TMP1,G0070+4(ADDR,ROLLBR)     BASE+4                4615
         BNL   #028501
         LA    TMP1,4(0,TMP1)                                      4615
         ST    TMP1,G0072(ADDR,ROLLBR)       BOTTOM                4615
         LR    TMP4,TMP                                            4615
         BAL   TMP,G0290                     MAPT1 TO T1           4615
         ST    TMP4,0(0,TMP1)                                      4615
         BR    RETURN                                              4615
#028501  L     15,G0351
         BR    15
*                                              MAPT1 TO T1         4615
G0290    STM   TMP1,TMP2,G0410               MAPT1 SAVE            4615
         LR    TMP2,TMP1                                           4615
         SRL   TMP2,10                                             4615
         N     TMP2,G0417                    LOW 2 BITS ZERO MASK  4615
         N     TMP1,G0416                    LOW 12 BITS MASK      4615
         A     TMP1,G0202(TMP2,ROLLBR)       ROLL DATA ADR TABLE   4615
         L     TMP2,G0410+4                  MAPT1 SAVE            4615
         BR    TMP                                                 4615
*                                              MAPT2 TO T2         4615
G0291    STM   TMP2,TMP3,G0411               MAPT2 SAVE            4615
         LR    TMP3,TMP2                                           4615
         SRL   TMP3,10                                             4615
         N     TMP3,G0417                    LOW 2 BITS ZERO MASK  4615
         N     TMP2,G0416                    LOW 12 BITS MASK      4615
         A     TMP2,G0202(TMP3,ROLLBR)       ROLL DATA ADR TABLE   4615
         L     TMP3,G0411+4                  MAPT2 SAVE            4615
         BR    TMP                                                 4615
         EJECT                                                     4615
*                                              MOVE WITHIN BLOCK   4615
G1072    LR    TMP4,TMP2                                           4615
         SR    TMP4,TMP3                                           4615
         BNH   #107202                                             4615
         LA    TMP4,31(TMP4)                                       4615
         SRL   TMP4,5                                              4615
#107201  S     TMP2,G0412                    ROLL INCR             4615
         MVC   36(32,TMP2),4(TMP2)                                 4615
         BCT   TMP4,#107201                                        4615
#107202  BR    TMP                                                 4615
*                                                                  4615
*                                              PRESS MEMORY        4615
* MODULE 'FORT2' SETS THE SECOND BYTE OF THE PRESS ROUTINE TO X'F0'
* BEFORE BRANCHING TO IT.  THIS CONDITION SIGNALS PRESS TO EXIT VIA
* REGISTER 11 .
PRESS    EQU      *
G1070    BCR      0,0             SWITCH TO DISTINGUISH INTERNAL USE OF
*                                 PRESS FROM CALLS BY FORT2.
         LA       TMP4,4
#107001  L     TMP1,G0072(TMP4,ROLLBR)       BOTTOM                4615
         LA    TMP4,4(TMP4)                                        4615
         L     TMP2,G0070(TMP4,ROLLBR)       BASE                  4615
         LR    TMP0,TMP2                                           4615
         SR    TMP0,TMP1                                           4615
         BZ    #107003                                             4615
         L     TMP3,G0072(TMP4,ROLLBR)       BOTTOM                4615
         SR    TMP3,TMP2                                           4615
         SRL   TMP3,2                                              4615
         ST    TMP1,G0070(TMP4,ROLLBR)       BASE                  4615
         ST    TMP1,G0410                    MAPT1 SAVE            4615
         ST    TMP2,G0411                    MAPT2 SAVE            4615
#107004  L     TMP1,G0410                                          4615
         LA    TMP1,4(TMP1)                                        4615
         L     TMP2,G0411                                          4615
         LA    TMP2,4(TMP2)                                        4615
#107002  BAL   TMP,G0290                     MAPT1 TO T1           4615
         BAL   TMP,G0291                     MAPT2 TO T2           4615
         L     TMP,0(0,TMP2)                                       4615
         ST    TMP,0(0,TMP1)                                       4615
         LTR   TMP3,TMP3                                           4615
         BZ    #107005                                             4615
         BCT   TMP3,#107004                                        4615
#107005  L     TMP,G0071(TMP4,ROLLBR)        TOP                   4615
         SR    TMP,TMP0                                            4615
         ST    TMP,G0071(TMP4,ROLLBR)        TOP                   4615
         L     TMP,G0072(TMP4,ROLLBR)        BOTTOM                4615
         SR    TMP,TMP0                                            4615
         ST    TMP,G0072(TMP4,ROLLBR)        BOTTOM                4615
#107003  CL    TMP4,G1074                    TWO FORTY FOUR ML     4615
         BNE   #107001                                             4615
         CL    TMP0,G0412                    ROLL INCR             4615
         BL    G1071                         NO MORE CORE          4615
         L     TMP,G0409                     REASSIGN SAVE         4615
         CLI      PRESS+1,X'F0'   WAS PRESS CALLED BY FORT2
         MVI      PRESS+1,X'0'    RESET SWITCH
         BCR      8,11            RETURN TO FORT2 IF CALLED BY IT
         B     G0286                         MOVE ON RECYCLE       4615
*                                                                  4615
*                                              NO MORE CORE        4615
G1071    L     15,G1073                      ADDR OF NO MORE CORE  4615
         BR    15                                                  4615
         EJECT                                                     4615
         DS    0F                                                  4615
*                                            FOUR ML
G0345    DC       X'00000004'
*                                            ONE ML
G0346    DC       X'00000001'
*                                       SAVE RETURN               39375
G0347    DC    X'00000000'                                        39375
G0351    DC    A(G0287)                                          39375
G0353    DC    X'00000000'                                       39375
*                                            TAG MASK 1 ML
G0348    DC       X'FF000000'
*                                            MODE MASK 1 ML
G0349    DC       X'F0000000'
*                                            MODE MASK 2 ML
G0350    DC       X'0FFFFFFF'
         DS       0F
*                                            END EXIT ROLL LOC ML
G0354    DC       X'00000000'
*                                            END WORK ROLL LOC ML
G0355    DC       X'00000000'
*                                            BASE EXIT ROLL LOC ML
*                                            BASEEXIT
G0356    DC       X'00000000'
*                                            BWORK
*                                            BASE WORK ROLL LOC ML
*                                            BASEWORK
BWORK    EQU      *
G0357    DC       X'00000000'
*                                            ENDRMY
*                                            END OF ROLL MEMORY ML
ENDRMY   EQU      *
G0358    DC       X'00000000'
*                                            STRMEM
*                                            START OF ROLL MEMORY ML
STRMEM   EQU      *
G0363    DC       X'00000000'
*                                            CPO SAVE ML
*                                            PGO SAVE ML
*                                            POC SAVE ML
*                                            MOC SAVE ML
*                                            DISP FROM CRP TOP
G0368    DS       CL12
*                                            CONTROL DRIVER OP MARK ML
G0370    DC       X'00FF0000'
*                                            SEARCH FROM PNTR SAVE ML
G0373    DC       X'00000000'
         DC       X'00000000'
*                                            TWO ML
G0374    DC       X'00000002'
RFLAG    DC       F'0'
         DS       0D
*                                            BLANK WORD ML
G0376    DC       CL8'        '
G0362    DS       F                       A(IEYROL)
G0365    DS       F                       A(IEYDBG)
G0379    DS       F                       A(IEYRD)
G0380    DS       F                       A(IEYPR)
G0381    DS       F                       A(IEYPC)
G0406    DS       F                       A(IEYMOR)
G1073    DS       F                       A(IEYNOCR)
*                                            CURR READ BUF ML
G0385    DC       X'00000000'
*                                            PRINT BUFFER ORG ML
G0386    DC       AL4(G0401)                    AFPRINT BUFFER
*                                            PUNCH BUFFER ORG ML
G0387    DC       AL4(G0402)                    AFPUNCH BUFFER
*                                            POC PSUEDO OP ML
G0388    DC       X'A5000000'
*                                            HALF WORD MASK ML
*                                            PNTR ADDRESS MASK ML
G0392    DC       X'0000FFFF'
         DS       0D
*                                            IEYCMR
*                                            INTERFACE COMPILER COMM RE
*                                            PROGRAM NAME ML
IEYCMR   EQU      *
G0393    DC       CL8'        '
*                                            OPTION BITS ML
G0394    DC       X'48000000'
*                                            ERROR CNT ML
G0395    DC       X'00000000'
         DC       X'00000000'
         DC       X'00000000'
*                                            LINES PER PAGE ML
G1010    DC       X'00000000'
*                                            AFTER POLISH ROLL NUMBER
G0403    DC       X'000000FC'
*                                            LAST REGULAR ROLL NUMBER
G0404    DC       X'000000F0'
*                                            CAR SAVE
*                                            CRP SAVE ML
*                                            SEARCH SAVE
G0405    EQU      *
G0419    DC       X'00000000'
         DC       X'00000000'
         DC       X'00000000'
         DC       X'00000000'
ROLLTABL EQU      *               REFERENCED EXTERNALLY BY FORT2
*                                            NEXT REG ADR TABLE ENTRY
G0407    DC       X'00000000'
*                                            LAST ADR TABLE ENTRY
G0408    DC       X'00000000'
*                                            REASSIGN SAVE
G0409    DC       X'00000000'
*                                            MAPT1 SAVE
G0410    DC       X'00000000'
         DC       X'00000000'
*                                            MAPT2 SAVE
G0411    DC       X'00000000'
         DC       X'00000000'
G0412    DC       X'00000020'             ROLL INCR
G0413    DC       X'00000080'             SPECIAL ROLL INCR
G1074    DC       X'000000F4'             TWO FORTY FOUR ML
*                                            FOUR THOUS NINETY SIX
G0414    DC       X'00001000'
*                                            LOW 12 BITS MASK
G0416    DC       X'00000FFF'
*                                            LOW 2 BITS ZERO MASK
G0417    DC       X'00000FFC'
*                                            POW BASE WORK LOC ML
G0418    DC       X'00000000'
*                                            ADR TABLE MASK ML
G1011    DC       X'FFFFF000'
*                                         QUOTE SCAN SAVE          6107
*                                         QUOTE SCAN SAVE ML       6107
G0352    DS       CL20                                             6107
*                                            SCK TABLE ML
G0400    DC       X'00282828'
         DC       X'38382808'
         DC       X'08080000'
         DC       X'00000000'
         DC       X'00080808'
         DC       X'08080808'
         DC       X'08080000'
         DC       X'00000000'
         DC       X'00000808'
         DC       X'08080808'
         DC       X'08080000'
         DC       X'00000000'
         DC       X'24242424'
         DC       X'24242424'
         DC       X'24240000'
         DC       X'00000000'
         DS       0D
         EJECT
         EJECT
G0401    DS       CL120                   PRINT BUFFER
G0402    DS       CL80                    PUNCH BUFFER
PARSAV   DS       CL76
         DC       16F'0'
ALLSAV   DS       CL104
UNFSAV   DS       CL12
GENSAV   DS    CL12                                                3123
*                                       REASSIGN MEMORY      39375 4615
G0287    ST    3,G0353
         BALR  3,0
         USING *,3
         ST    TMP,G0409
         C     ADDR,G0404               LAST REG ROLL NO     39375 4615
         BH    G0288               SPECIAL REASSIGN MEMORY   39375 4615
         LA    TMP1,G0200(0,0)          LAST REG ROLL NO     39375 4615
         L     TMP2,G0070+4(TMP1,ROLLBR)     BASE+4          39375 4615
         N     TMP2,G0416               LOW 12 BITS MASK     39375 4615
         A     TMP2,G0412               ROLL INCR            39375 4615
         C     TMP2,G0414               FOUR THOUS NINETY SIX39375 4615
         BL    #028703                                       39375 4615
         L     TMP2,G0070+4(TMP1,ROLLBR)                     39375 4615
         SRL   TMP2,10                                       39375 4615
         N     TMP2,G0417                                    39375 4615
         A     TMP2,G0345               FOUR ML              39375 4615
         C     TMP2,G0407                                    39375 4615
         BL    #028736                                       39375 4615
         L     15,G0406            ADDR OF GET MORE CORE     39375 4615
         BALR  14,15                                         39375 4615
         BNH   #028737                                       39375 4615
         L     3,G0353
         B     G1070                    PRESS MEMORY         39375 4615
#028737  EQU   *                                             39375 4615
         L     TMP2,G0408               LAST ADDR TABLE ENTRY39375 4615
         LA    TMP2,4(0,TMP2)                                39375 4615
         LR    TMP3,TMP2                                     39375 4615
         ST    TMP2,G0408               LAST ADR TABLE ENTRY 39375 4615
         S     TMP2,G0407          NEXT REG ADR TABLE ENTRY  39375 4615
         SRL   TMP2,2                                        39375 4615
         SR    TMP0,TMP0                                     39375 4615
         ST    TMP0,G0202+4(TMP3,ROLLBR)  ROLL DATA ADR TBLE 39375 4615
#028701  S     TMP3,G0345               FOUR ML              39375 4615
         L     TMP0,G0202(TMP3,ROLLBR)  ROLL DATA ADR TABLE  39375 4615
         ST    TMP0,G0202+4(TMP3,ROLLBR)  ROLL DATA ADR TBLE 39375 4615
         BCT   TMP2,#028701                                  39375 4615
#028702  ST    1,G0202(TMP3,ROLLBR)     ROLL DATA ADR TABLE  39375 4615
         LA    TMP3,4(0,TMP3)                                39375 4615
         ST    TMP3,G0407          NEXT REG ADR TBLE ENTRY   39375 4615
         LA    TMP3,2                                        39375 4615
         LA    TMP1,G0063(0,0)          CODE ROLL X4         39375 4615
#028735  L     TMP0,G0070(TMP1,ROLLBR)  BASE                 39375 4615
         A     TMP0,G0414               FOUR THOUS NINETY SIX39375 4615
         ST    TMP0,G0070(TMP1,ROLLBR)  BASE                 39375 4615
         L     TMP0,G0071(TMP1,ROLLBR)  TOP                  39375 4615
         A     TMP0,G0414              FOUR THOUS NINETY SIX 39375 4615
         ST    TMP0,G0071(TMP1,ROLLBR)  TOP                  39375 4615
         L     TMP0,G0072(TMP1,ROLLBR)  BOTTOM               39375 4615
         A     TMP0,G0414              FOUR THOUS NINETY SIX 39375 4615
         ST    TMP0,G0072(TMP1,ROLLBR)  BOTTOM               39375 4615
         LA    TMP1,4(0,TMP1)                                39375 4615
         BCT   TMP3,#028735                                  39375 4615
         L     TMP0,G0070(TMP1,ROLLBR)  BASE                 39375 4615
         A     TMP0,G0414              FOUR THOUS NINETY SIX 39375 4615
         ST    TMP0,G0070(TMP1,ROLLBR)  BASE                 39375 4615
#028736  MVI   RFLAG,1                                       39375 4615
#028703  LA    TMP4,G0200          LAST REG ROLL NO TO TMP4  39375 4615
         L     TMP2,G0070+4(TMP4,ROLLBR)  BASE+4             39375 4615
         L     TMP1,G0070+4(ADDR,ROLLBR)  BASE+4             39375 4615
         BAL   TMP,G0290                MAPT1 TO T1          39375 4615
         BAL   TMP,G0291                MAPT2 TO T2          39375 4615
         L     TMP,G0410                MAPT1 SAVE           39375 4615
         SRL   TMP,10                                        39375 4615
         N     TMP,G0417                LOW 2 BITS ZERO MASK 39375 4615
         ST    TMP,G0410                MAPT1 SAVE           39375 4615
         L     TMP,G0411                MAPT2 SAVE           39375 4615
         SRL   TMP,10                                        39375 4615
         N     TMP,G0417                LOW 2 BITS ZERO MASK 39375 4615
         ST    TMP,G0411                MAPT2 SAVE           39375 4615
         CLI   RFLAG,1                                       39375 4615
         BNE   #028731                                       39375 4615
         MVI   RFLAG,0                                       39375 4615
         L     TMP3,G0202+4(TMP,ROLLBR)                      39375 4615
         S     TMP3,G0345                                    39375 4615
         B     #028733                                       39375 4615
#028731  CLC   G0410(4),G0411         MAPT1 SAVE, MAPT2 SAVE 39375 4615
         BE    #028732                                       39375 4615
         L     TMP3,G0202(TMP,ROLLBR)   ROLL DATA ADR TABLE  39375 4615
         S     TMP3,G0345               FOUR ML              39375 4615
         BAL   TMP,G1072                MOVE WITHIN BLOCK    39375 4615
         L     TMP,G0411                MAPT2 SAVE           39375 4615
         S     TMP,G0345                FOUR ML              39375 4615
         ST    TMP,G0411                MAPT2 SAVE           39375 4615
#028733  L     TMP2,G0202(TMP,ROLLBR)   ROLL DATA ADR TABLE  39375 4615
         LA    TMP2,4060(TMP2)                               39375 4615
         MVC   4(32,TMP3),4(TMP2)                            39375 4615
         B     #028731                                       39375 4615
#028732  LR    TMP3,TMP1                                     39375 4615
         BAL   TMP,G1072                MOVE WITHIN BLOCK    39375 4615
         LA    TMP0,4                                        39375 4615
#028706  L     TMP2,G0412               ROLL INCR            39375 4615
         LA    TMP1,G0201(0,0)     LAST REG ROLL NO PLUS ONE 39375 4615
#028707  L     TMP3,G0072(TMP1,ROLLBR)  BOTTOM               39375 4615
         AR    TMP3,TMP2                                     39375 4615
         ST    TMP3,G0072(TMP1,ROLLBR)  BOTTOM               39375 4615
         L     TMP3,G0071(TMP1,ROLLBR)  TOP                  39375 4615
         AR    TMP3,TMP2                                     39375 4615
         ST    TMP3,G0071(TMP1,ROLLBR)  TOP                  39375 4615
#028708  L     TMP3,G0070(TMP1,ROLLBR)  BASE                 39375 4615
         AR    TMP3,TMP2                                     39375 4615
         ST    TMP3,G0070(TMP1,ROLLBR)  BASE                 39375 4615
         SR    TMP1,TMP0                                     39375 4615
         CR    TMP1,ADDR                                     39375 4615
         BNE   #028707                                       39375 4615
         L     TMP,G0409                REASSIGN SAVE        39375 4615
         L     3,G0353
         B     G0286                    MOVE ON RECYCLE      39375 4615
*                                  SPECIAL REASSIGN MEMORY   39375 4615
G0288    L     TMP2,G0289+4(0,ROLLBR)   AFTER POLISH BASE+4  39375 4615
         N     TMP2,G0416               LOW 12 BITS MASK     39375 4615
         A     TMP2,G0413               SPECIAL ROLL INCR    39375 4615
         C     TMP2,G0414              FOUR THOUS NINETY SIX 39375 4615
         BL     #028801                                      39375 4615
         L     15,G0406                 ADR OF GET MORE CORE 39375 4615
         BALR  14,15                                         39375 4615
         BP    #028805                                            39375
         L     TMP2,G0408              LAST ADR TABLE ENTRY  39375 4615
         LA    TMP2,4(0,TMP2)                                39375 4615
         ST    TMP2,G0408               LAST ADR TABLE ENTRY 39375 4615
         ST    1,G0202(TMP2,ROLLBR)     ROLL DATA ADR TABLE  39375 4615
         SR    1,1                                           39375 4615
         ST    1,G0202+4(TMP2,ROLLBR)   ROLL DATA ADR TABLE  39375 4615
#028801  C     ADDR,G0403               AFTER POLISH ROLL NO 39375 4615
         BE    #028804                                       39375 4615
         L     TMP3,G0072+4(ADDR,ROLLBR)   BOTTOM            39375 4615
         S     TMP3,G0070+4(ADDR,ROLLBR)   BASE              39375 4615
         BZ    #028803                                       39375 4615
         L     TMP0,G0345               FOUR ML              39375 4615
         L     TMP1,G0072+4(ADDR,ROLLBR)   BOTTOM            39375 4615
         LR    TMP2,TMP1                                     39375 4615
         A     TMP2,G0413               SPECIAL ROLL INCR    39375 4615
#028802  BAL   TMP,G0290                MAPT1 TO T1          39375 4615
         BAL   TMP,G0291                MAPT2 TO T2          39375 4615
         L     TMP,0(0,TMP1)                                 39375 4615
         ST    TMP,0(0,TMP2)                                 39375 4615
         SR    TMP3,TMP0                                     39375 4615
         BZ    #028803                                       39375 4615
         L     TMP1,G0410               MAPT1 SAVE           39375 4615
         L     TMP2,G0411               MAPT2 SAVE           39375 4615
         SR    TMP1,TMP0                                     39375 4615
         SR    TMP2,TMP0                                     39375 4615
         B     #028802                                       39375 4615
#028803  L     TMP3,G0071+4(ADDR,ROLLBR)   TOP               39375 4615
         A     TMP3,G0413               SPECIAL ROLL INCR    39375 4615
         ST    TMP3,G0071+4(ADDR,ROLLBR)   TOP               39375 4615
         L     TMP3,G0072+4(ADDR,ROLLBR)   BOTTOM            39375 4615
         A     TMP3,G0413               SPECIAL ROLL INCR    39375 4615
         ST    TMP3,G0072+4(ADDR,ROLLBR)   BOTTOM            39375 4615
         L     TMP3,G0070+8(ADDR,ROLLBR)   BASE              39375 4615
         A     TMP3,G0413               SPECIAL ROLL INCR    39375 4615
         ST    TMP3,G0070+8(ADDR,ROLLBR)   BASE              39375 4615
#028804  L     TMP3,G0070+4(ADDR,ROLLBR)   BASE              39375 4615
         A     TMP3,G0413               SPECIAL ROLL INCR    39375 4615
         ST    TMP3,G0070+4(ADDR,ROLLBR)   BASE              39375 4615
         L     TMP,G0409                REASSIGN SAVE        39375 4615
         L     3,G0353
         B     G0286                    MOVE ON RECYCLE      39375 4615
#028805  ST    RETURN,G0347             SAVE RETURN               39375
         MVI   PRESS+1,X'F0'            SET SW IN PRESS           39375
         BAL   RETURN,PRESS             PRESS MEMORY              39375
         L     RETURN,G0347             LOAD RETURN               39375
         CL    TMP0,G0414               4096                      39375
         BNL   #028807                                       39375 4615
         L     3,G0353
         B     G1071                    NO MORE CORE              39375
#028807  EQU   *                                             39375 4615
         L     TMP3,G0407               NEXT ADDR TABLE ENTRY     39375
         S     TMP3,G0345               FOUR ML                   39375
         ST    TMP3,G0407               NEXT ADDR TABLE ENTRY     39375
         L     TMP2,G0202(TMP3,ROLLBR) DELET BLOCK FRM REG ROLLS  39375
#028806  L     TMP1,G0202+4(TMP3,ROLLBR)     ROLL DATA ADDR TABLE 39375
         ST    TMP1,G0202(TMP3,ROLLBR)       ROLL DATA ADDR TABLE 39375
         A     TMP3,G0345               FOUR ML                   39375
         C     TMP3,G0408               LAST ADDR TABLE ENTRY     39375
         BL    #028806                                            39375
         ST    TMP2,G0202(TMP3,ROLLBR)  ADD BLOCK TO SPEC ROLLS   39375
         L     TMP2,G0063(0,ROLLBR)     BASE CODE ROLL            39375
         S     TMP2,G0414               4096                      39375
         ST    TMP2,G0063(0,ROLLBR)     BASE CODE ROLL            39375
         L     TMP2,G0063+4(0,ROLLBR)   BASE AFTER POLISH         39375
         S     TMP2,G0414               4096                      39375
         ST    TMP2,G0063+4(0,ROLLBR)   BASE AFTER POLISH         39375
         L     TMP2,G0063+8(0,ROLLBR)   BASE AFTER POLISH         39375
         S     TMP2,G0414               4096                      39375
         ST    TMP2,G0063+8(0,ROLLBR)   BASE AFTER POLISH         39375
         L     TMP2,G0064A(0,ROLLBR)    TOP CODE ROLL             39375
         S     TMP2,G0414               4096                      39375
         ST    TMP2,G0064A(0,ROLLBR)    TOP CODE ROLL             39375
         L     TMP2,G0064A+4(0,ROLLBR)  TOP AFTER POLISH          39375
         S     TMP2,G0414               4096                      39375
         ST    TMP2,G0064A+4(0,ROLLBR)  TOP AFTER POLISH          39375
         L     TMP2,G0066A(0,ROLLBR)    BOTTOM CODE ROLL          39375
         S     TMP2,G0414               4096                      39375
         ST    TMP2,G0066A(0,ROLLBR)    BOTTOM CODE ROLL          39375
         L     TMP2,G0066A+4(0,ROLLBR)  BOTTOM AFTER POLISH       39375
         S     TMP2,G0414               4096                      39375
         ST    TMP2,G0066A+4(0,ROLLBR)  BOTTOM AFTER POLISH       39375
         B     #028801                                            39375

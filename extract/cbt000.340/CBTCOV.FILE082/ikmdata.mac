         MACRO
         IKMDATA
LEVELTAB DSECT
NXTOKN   EQU   *
         ORG   LEVELTAB+48
KEYTABLE EQU   *
         ORG   LEVELTAB+1200
INPUTTAB DS    256C
GENT     EQU   *
         ORG   GENT+12
ENTTAB   EQU   *
         ORG   ENTTAB+10
ATTRTAB  EQU   *
         ORG   ATTRTAB+62
LIMITS   DS    0F
BITCHARL EQU   *
AREALIML DC    F'1'
BITCHARU EQU   *
W32767   EQU   *
AREALIMH DC    F'32767'
LVNLLIM  DC    F'1'
LVNULIM  DC    F'255'
ARRBLLIM DC    F'-32768'
ARRBULIM DC    F'32767'
PRECLIM  EQU   *
BINFIXLL DC    F'1'
BINFIXUL DC    F'31'
DECFIXLL DC    F'1'
DECFIXUL DC    F'15'
BINFLTLL DC    F'1'
BINFLTUL DC    F'53'
DECFLTLL DC    F'1'
DECFLTUL DC    F'16'
SCALLIML DC    F'-128'
SCALLIMH DC    F'127'
ENTMAX   DC    H'3'
         ORG   LIMITS+74
ATTL     DC    X'0028'
MASKS    DC    X'8040201008040201'
ATTXMASK EQU   *
         ORG   ATTXMASK+364
MAJMASK  DC    X'FFFFFFFFE040'
MINMASK  DC    X'FFFFFFFFFFE0'
ELMASK   DC    X'80007FFFFFB0'
ENVXMASK DC    B'011001000000110010011000'     CONSECUTIVE
         DC    B'101111110110001100011000'     INDEXED
         DC    B'110111110000110010011000'     REGIONAL
         DC    B'011011000000110010011000'     CTLASA
         DC    B'011101000000110010011000'     CTL360
         DC    B'111110000000000011011000'     COBOL
         DC    B'011000010000110011111000'     LEAVE
         DC    B'011000100000110011111000'     REWIND
         DC    B'000000000000000010011000'     BUFFERS
         DC    B'010000000011111100011000'     U
         DC    B'010000000101110010011000'     V
         DC    B'000000000110001110011000'     F
         DC    B'101110110110001100011000'     INDEXAREA
         DC    B'101110110110001100011000'     NOWRITE
         DC    B'010000000101110110011000'     VS
         DC    B'010000000101111010011000'     VBS
         DC    B'101111111011001100011000'     GENKEY
         DC    B'000001110000000000011000'     TRKOFL
         DC    B'000000110000000000000000'     NCP
         DC    B'111111111111111111000000'     G
         DC    B'111111111111111111000000'     R
         ORG   ENVXMASK+70
FOUR     DC    H'4'
FIVE     DC    H'5'
EIGHT    DC    H'8'
AONE     DC    F'1'
OEIGHT   DC    X'00000008'
THREETWO DC    F'32'
HUTWSIX  DC    F'126'
W32760   DC    F'32760'
DECCONST DC    X'000002147483647F'
ZEROS    DC    X'0000000000000000'
ADDRMASK DC    X'00000FFE'
DECINT1  DC    X'0101'
PARMW    DC    X'00000C'
         DC    C'PARAMETER'
DCLT     DC    X'00000A'
         DC    C'DECLARE'
ATTRW    DC    X'00000D'
         DC    C'ATTRIBUTES'
DIMW     DC    X'00000C'
         DC    C'DIMENSION'
GENW     DC    X'00000A'
         DC    C'GENERIC'
PICW     DC    X'00000A'
         DC    C'PICTURE'
BASEW    DC    X'000007'
         DC    C'BASE'
LIKEW    DC    X'000007'
         DC    C'LIKE'
PRECW    DC    X'00000C'
         DC    C'PRECISION'
ENTRYW   DC    X'000008'
         DC    C'ENTRY'
ALLOCW   DC    X'00000B'
         DC    C'ALLOCATE'
LENGTHW  DC    X'000009'
         DC    C'LENGTH'
INITW    DC    X'00000A'
         DC    C'INITIAL'
AREAW    DC    X'000007'
         DC    C'AREA'
VARW     DC    X'00000A'
         DC    C'VARYING'
POSW     DC    X'00000B'
         DC    C'POSITION'
         DS    0F
RTAB     DC    X'0D'
         DC    X'29'                   BINARY
         DC    X'2A'                   DECIMAL
         DC    X'2B'                   FIXED
         DC    X'2C'                   FLOAT
         DC    X'2D'                   REAL
         DC    X'2E'                   COMPLEX
         DC    X'2F'                   PICTURE
         DC    X'30'                   BIT
         DC    X'31'                   CHARACTER
         DC    X'32'                   VARING
         DC    X'36'                   POINTER
         DC    X'37'                   OFFSET
         DC    X'38'                   AREA
KEYWORDS DS    0F
KIF      EQU   X'08'
KON      EQU   X'09'
KREVERT  EQU   X'0A'
KSIGNAL  EQU   X'0B'
KELSE    EQU   X'0C'
KBEGIN   EQU   X'0D'
KEXIT    EQU   X'0E'
KSTOP    EQU   X'0F'
KDO      EQU   X'10'
KFORMAT  EQU   X'11'
KGET     EQU   X'12'
KPUT     EQU   X'13'
KDELETE  EQU   X'14'
KLOCATE  EQU   X'15'
KREAD    EQU   X'16'
KREWRITE EQU   X'17'
KUNLOCK  EQU   X'18'
KWRITE   EQU   X'19'
KRETURN  EQU   X'1A'
KEND     EQU   X'1B'
KDISPLAY EQU   X'1C'
KDELAY   EQU   X'1D'
KWAIT    EQU   X'1E'
KGO      EQU   X'1F'
KGOTO    EQU   X'20'
KCLOSE   EQU   X'21'
KCALL    EQU   X'22'
KFREE    EQU   X'23'
KOPEN    EQU   X'24'
KALLOC   EQU   X'25'
KDCL     EQU   X'26'
KPROC    EQU   X'27'
KENTRY   EQU   X'28'
KBIN     EQU   X'29'
KDEC     EQU   X'2A'
KFIXED   EQU   X'2B'
KFLOAT   EQU   X'2C'
KREAL    EQU   X'2D'
KCPLX    EQU   X'2E'
KPIC     EQU   X'2F'
KBIT     EQU   X'30'
KCHAR    EQU   X'31'
KVAR     EQU   X'32'
KLABEL   EQU   X'33'
KTASK    EQU   X'34'
KEVENT   EQU   X'35'
KPTR     EQU   X'36'
KOFFSET  EQU   X'37'
KAREA    EQU   X'38'
KRETURNS EQU   X'39'
KGENERIC EQU   X'3A'
KBUILTIN EQU   X'3B'
KFILE    EQU   X'3C'
KSTREAM  EQU   X'3D'
KRECORD  EQU   X'3E'
KINPUT   EQU   X'3F'
KOUTPUT  EQU   X'40'
KUPDATE  EQU   X'41'
KPRINT   EQU   X'42'
KSEQUENT EQU   X'43'
KDIRECT  EQU   X'44'
KBUFFERD EQU   X'45'
KUNBUFFD EQU   X'46'
KBACKW   EQU   X'47'
KENV     EQU   X'48'
KKEYED   EQU   X'49'
KEXCLUS  EQU   X'4A'
KEXT     EQU   X'4B'
KINT     EQU   X'4C'
KSTATIC  EQU   X'4D'
KAUTO    EQU   X'4E'
KCTL     EQU   X'4F'
KBASED   EQU   X'50'
KINIT    EQU   X'51'
KDEF     EQU   X'52'
KLIKE    EQU   X'53'
KALIGNED EQU   X'54'
KUNAL    EQU   X'55'
KPOS     EQU   X'56'
KTRANS   EQU   X'57'
KIRRED   EQU   X'58'
KRED     EQU   X'59'
KSECNDRY EQU   X'5A'
KORDER   EQU   X'60'
KREORDER EQU   X'61'
KOPTIONS EQU   X'62'
KLINESIZ EQU   X'63'
KPAGESIZ EQU   X'64'
KTITLE   EQU   X'65'
KRECURS  EQU   X'66'
KSET     EQU   X'67'
KIN      EQU   X'68'
KERROR   EQU   X'71'
KFINISH  EQU   X'72'
KCOND    EQU   X'73'
KPENDING EQU   X'74'
KENDFILE EQU   X'75'
KENDPAGE EQU   X'76'
KKEY     EQU   X'77'
KNAME    EQU   X'78'
KTRANSM  EQU   X'79'
KUNDF    EQU   X'7A'
KCHECK   EQU   X'7B'
KCONV    EQU   X'7C'
KFOFL    EQU   X'7D'
KOFL     EQU   X'7E'
KUFL     EQU   X'7F'
KZDIV    EQU   X'80'
KSIZE    EQU   X'81'
KSUBRG   EQU   X'82'
KSTRG    EQU   X'83'
KNOCHECK EQU   X'84'
KNOCONV  EQU   X'85'
KNOFOFL  EQU   X'86'
KNOOFL   EQU   X'87'
KNOUFL   EQU   X'88'
KNOZDIV  EQU   X'89'
KNOSIZE  EQU   X'8A'
KNOSUBRG EQU   X'8B'
KNOSTRG  EQU   X'8C'
KCONSEC  EQU   X'93'
KINDEXED EQU   X'94'
KREGION  EQU   X'95'
KCTLASA  EQU   X'96'
KCTL360  EQU   X'97'
KCOBOL   EQU   X'98'
KLEAVE   EQU   X'99'
KREWIND  EQU   X'9A'
KBUFFERS EQU   X'9B'
KU       EQU   X'9C'
KV       EQU   X'9D'
KF       EQU   X'9E'
KINDEXAR EQU   X'9F'
KNOWRITE EQU   X'A0'
KVS      EQU   X'A1'
KVBS     EQU   X'A2'
KGENKEY  EQU   X'A3'
KTRKOFL  EQU   X'A4'
KNCP     EQU   X'A5'
KG       EQU   X'A6'
KR       EQU   X'A7'
KPAGE    EQU   X'A8'
KLINE    EQU   X'A9'
KCOL     EQU   X'AA'
KSKIP    EQU   X'AB'
KA       EQU   X'AC'
KB       EQU   X'AD'
KE       EQU   X'AE'
KP       EQU   X'AF'
KC       EQU   X'B0'
KX       EQU   X'B1'
KSTRING  EQU   X'B2'
KCOPY    EQU   X'B3'
KEDIT    EQU   X'B4'
KDATA    EQU   X'B5'
KLIST    EQU   X'B6'
KTHEN    EQU   X'B9'
KFROM    EQU   X'BA'
KIGNORE  EQU   X'BB'
KINTO    EQU   X'BC'
KKEYFROM EQU   X'BD'
KKEYTO   EQU   X'BE'
KMAIN    EQU   X'BF'
KNOLOCK  EQU   X'C0'
KPRIORIT EQU   X'C1'
KREFER   EQU   X'C2'
KREPLY   EQU   X'C3'
KREENTR  EQU   X'C4'
KSNAP    EQU   X'C5'
KSUB     EQU   X'C6'
KSYSTEM  EQU   X'C7'
KBY      EQU   X'C8'
KTO      EQU   X'C9'
KWHILE   EQU   X'CA'
TOKENS   DS    0F
IIDENT   EQU   X'00'               1 BYTE DEC 00
ICONST   EQU   X'01'               1 BYTE DEC 01
ILIT     EQU   X'02'               1 BYTE DEC 02
ICLOSE   EQU   X'03'
IOPEN    EQU   X'04'
ICOMMA   EQU   X'05'
IDOT     EQU   X'06'
INOT     EQU   X'07'
IPLUS    EQU   X'08'
IMINUS   EQU   X'09'
ISTAR    EQU   X'0A'
ISLASH   EQU   X'0B'
IAND     EQU   X'0C'
IOR      EQU   X'0D'
ILT      EQU   X'0E'
IGT      EQU   X'0F'
IEQUAL   EQU   X'10'
ILE      EQU   X'11'
IGE      EQU   X'12'
INE      EQU   X'13'
INL      EQU   X'14'
ING      EQU   X'15'
ICAT     EQU   X'16'
IEXPON   EQU   X'17'
IARROW   EQU   X'18'
ICOLON   EQU   X'19'
ISEMI    EQU   X'1A'
IQUOTE   EQU   X'1C'
DATAAREA DSECT
         DS    0F
SAVELEV1 DS    18F           1. LEVEL SAVEAREA
SAVELEV2 DS    18F           2. LEVEL SAVEAREA
SAVELEV3 DS    18F           3. LEVEL SAVEAREA
SAVELEV4 DS    18F           4. LEVEL SAVEAREA
VIKM12   DS    1F            ADDRESS OF THE ERROR ROUTINE IKM12
VIKM131  DS    1F            ADDRESS OF THE PICTURE SCAN ROUTINE
VIKM132  DS    1F            ADDRESS OF THE PARENTHESES SKIP ROUTINE
*                                      IKM132
VIKM133  DS    1F            ADDRESS OF THE EXPRESSION SCAN ROUTINE
*                                      IKM133
VIKM134  DS    1F            ADDRESS OF THE CONSTANT CHECK ROUTINE
VIKM135  DS    1F            ADDRESS OF THE REFERENCE SCAN ROUTINE
VIKM136  DS    1F
INPUTBEG DS    1F            START OF SOURCETEXT
WORKBEG  DS    1F            START OF TOKEN STRING. CONTAINS EITHER
*                            THE ADDRESS OF WORKB OR THE CORRESPONDING
*                            ADDRESS IN EXTRA STORAGE ES
STATBEG  DS    1F            STATEMENT START POSITION IN THE TOKEN
*                                      STRING
EXPBEG   DS    1F            START OF EXPRESSION TO BE SCANNED BY
*                                      IKM133
EXPEND   DS    1F            END OF EXPRESSION TO BE SCANNED BY
*                                      IKM133
ESLENGTH DS    1F            LENGTH OF EXTRA STORAGE
ESADDR   DS    1F            ADDRESS OF EXTRA STORAGE
STARTP   DS    5F            SAVE AREA FOR THE STARTVALUES OF THE
*                            POINTERS CP,RP,BP AND THE COUNTERS RC,CC
ENDP     DS    5F            SAVEAREA FOR THE ENDVALUES OF THE
*                            POINTERS CP,RP,BP AND THE COUNTERS RC,CC
CONTREG  DS    1F            ADDRESS OF SAVE AREA USED BY IKM12
*                            AT EXIT TO THE INVOKING PROGRAM
LINENR   DS    2F
LINECNT  DS    1H
STLINCNT DS    1H
INSERT1  DS    1F            ADDRESS OF 1. INSERTION TO BE MADE
*                                    IN ERRORMESSAGE
INSERT2  DS    1F            ADDRESS OF 2. INSERTION TO BE MADE
*                                    IN ERRORMESSAGE
LSM      DS    1C            VALUE OF LEFT SOURCEMARGIN
RSM      DS    1C            VALUE OF RIGHT SOURCEMARGIN
RL       DS    1C            RECORD LENGTH
COMFLAGS EQU   *
COMFLAG1 DS    1C
SOURCEFL EQU   B'10000000'
NSOURCEF EQU   B'01111111'
LINENOFL EQU   B'01000000'
NLINENOF EQU   B'10111111'
BPTFLAG  EQU   B'00100000'
NBPTFLAG EQU   B'11011111'
DIAGNSFL EQU   B'00010000'
NDIAGNSF EQU   B'11101111'
ERRFLAG  EQU   B'00001000'
NERRFLAG EQU   B'11110111'
IFFLAG   EQU   B'00000100'
NIFFLAG  EQU   B'11111011'
ONFLAG   EQU   B'00000010'
NONFLAG  EQU   B'11111101'
DIMREFFL EQU   B'00000001'
NDIMREFF EQU   B'11111110'
COMFLAG2 DS    1C
ESFLAG   EQU   B'10000000'
NESFLAG  EQU   B'01111111'
PTRREFFL EQU   B'01000000'
NPTRREFF EQU   B'10111111'
DOTREFFL EQU   B'00100000'
NDOTREFF EQU   B'11011111'
SUBREFFL EQU   B'00010000'
NSUBREFF EQU   B'11101111'
ISUBFLAG EQU   B'00001000'
NISUBFL  EQU   B'11110111'
EQUFLAG  EQU   B'00000100'
NEQUFLAG EQU   B'11111011'
REFERFL  EQU   B'00000010'
NREFERFL EQU   B'11111101'
LABTSTFL EQU   B'00000001'
NLABTSTF EQU   B'11111110'
SCANMODE DS    1C            SCAN MODE BYTE USED BY IKM00
TL       DS    1H
DEMANDFL DS    1C
*        BIT 0:   IKM21 DEMANDED
*        BIT 1:   IKM22 DEMANDED
*        BIT 2:   IKM23 DEMANDED
LOADFLAG DS    1C
*        BIT 0:   IKM21 LOADED
*        BIT 1:   IKM22 LOADED
*        BIT 2:   IKM23 LOADED
SLASK2   DS    62F           2. LEVEL WORKAREA
SLASK3   DS    7F            3. LEVEL WORKAREA
SLASK4   DS    3F            4. LEVEL WORKAREA
SLASK5   DS    2F            5. LEVEL WORKAREA
MESSBUFF DS    19F           ERROR MESSAGE BUFFER
BPT      DS    1F            BREAK POINT TABLE  FOR LINE NUMBERS
WORKB    DS    50F           AREA FOR TOKEN STRING
MODULE   DS    1F
         MEND

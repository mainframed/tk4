      INTEGER FUNCTION RAN(RANGE)
C
C  RETURN RANDOM UNIFORMLY DISTRIBUTED VALUE IN CLOSED INTERVAL
C  (0,RANGE-1).
C
C  THIS CODE WAS WRITTEN BY DON@SAIL AS DEC RANDOM NUMBER GENERATOR
C  IS SUPPOSEDLY A LOSER.
C
      IMPLICIT INTEGER(A-Z)
      COMMON /RANCOM/ R
C
      D=1
      IF(R.NE.0)GOTO 1
      CALL DATIME(D,T)
      R=18*T+5
      D=1000+MOD(D,1000)
1     DO 2 T=1,D
2     R=MOD(R*1021,1048576)
      RAN=(RANGE*R)/1048576
      RETURN
      END

      INTEGER FUNCTION CODE1(WORDS)
C
C#######################################################################
C ATTENTION SPF USERS.  THIS PROGRAM CONTAINS NONDISPLAY CHARACTERS    #
C WHICH ARE AN INTEGRAL PART OF THE PROGRAM AND NOT JUST TRASH.        #
C D O   N O T   D E L E T E   O R   C H A N G E    T H E M  ! ! ! ! !  #
C#######################################################################
C
C  CONVERT EXTERNAL CHARACTERS TO INTERNAL FORMAT (5 CHARS/INTEGER).
C
C  THE FIRST FIVE CHARACTERS OF WORDS ARE CONVERTED TO THEIR INTERNAL
C  REPRESENTATION (SIXBIT).  IF A CHARACTER HAS NO REPRESENTATION, IT IS
C  REPLACED BY A PERIOD.
C
C  DEFINITION OF CONSTANTS:
C       NWORDS = NUMBER OF INTEGER VARIABLES NEEDED TO HOLD FIVE CHARS
C       NCHARS = NUMBER OF CHARACTERS STORED IN AN INTEGER VARIABLE
C       CHRSIZ = NUMBER OF BITS REQUIRED TO REPRESENT A CHARACTER
C       CHRMSK = NUMBER TO AND WITH AN INTEGER TO OBTAIN HIGH-ORDER
C                CHARACTER.
C
      IMPLICIT INTEGER(A-Z)
      DIMENSION WORDS(2)
      DATA NWORDS/2/,NCHARS/4/,CHRSIZ/8/,CHRMSK/ZFF000000/
      DIMENSION CHRSET(64)
      DATA CHRSET/1H ,1H×,1H",1H#,1H$,1H%,1H&,1H',
     1            1H(,1H),1H*,1H+,1H,,1H-,1H.,1H/,
     2            1H0,1H1,1H2,1H3,1H4,1H5,1H6,1H7,
     3            1H8,1H9,1H:,1H;,1H<,1H=,1H>,1H?,
     4            1H@,1HA,1HB,1HC,1HD,1HE,1HF,1HG,
     5            1HH,1HI,1HJ,1HK,1HL,1HM,1HN,1HO,
     6            1HP,1HQ,1HR,1HS,1HT,1HU,1HV,1HW,
     7            1HX,1HY,1HZ,1HÖ,1H^,1H!,1H,1H_/
C
      RESULT=0
      COUNT=0
      DO 10 I=1,NWORDS
         WORD=WORDS(I)
         DO 5 J=1,NCHARS
            COUNT=COUNT+1
            IF(COUNT.GT.5) GO TO 20
            CHAR=AND(WORD,CHRMSK)
            WORD=SHIFT(WORD,CHRSIZ)
            DO 1 CHRIDX=1,64
               IF(CHAR.EQ.AND (CHRSET(CHRIDX),CHRMSK)) GO TO 2
1           CONTINUE
            CHRIDX=15
2           RESULT=SHIFT(RESULT,6)+CHRIDX-1
5        CONTINUE
10    CONTINUE
20    CODE1=RESULT
      RETURN
      END

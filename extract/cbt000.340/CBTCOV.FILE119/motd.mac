      SUBROUTINE MOTD(ALTER)
C
C  HANDLES MESSAGE OF THE DAY.  IF ALTER IS TRUE, READ A NEW MESSAGE
C  FROM THE WIZARD.  ELSE PRINT THE CURRENT ONE.  MESSAGE IS INITIALLY
C  NULL.
C
      IMPLICIT INTEGER(A-Z)
      LOGICAL ALTER
      COMMON /IOSCOM/ TTYI,TTYO,BLKLIN,DBFI,DBINIT,DBSAVE
      COMMON /MTDCOM/ MTDTXT
      DIMENSION MTDTXT(100),TEXT(70)
      DATA BLANK/' '/,BLANKS/'    '/,PERIOD/'.'/
C
      IF(ALTER)GOTO 50
      K=1
10    IF(MTDTXT(K).LT.0)RETURN
      NWORDS=MTDTXT(K)-K-1
      IF(NWORDS.EQ.0)GOTO 40
      NCHARS=5*NWORDS
      DO 15 I=1,NWORDS
         MIDX=K+I
         TIDX=5*(I-1)+1
         CALL DCODE1(MTDTXT(MIDX),TEXT(TIDX))
15    CONTINUE
      WRITE(TTYO,20)(TEXT(I),I=1,NCHARS)
20    FORMAT(1X,70A1)
30    K=MTDTXT(K)
      GOTO 10
40    WRITE(TTYO,45)
45    FORMAT(1X)
      GOTO 30
50    M=1
      CALL MSPEAK(23)
55    READ(TTYI,56)TEXT,K
56    FORMAT(70A1,A4)
      IF(K.EQ.BLANKS)GOTO 60
      CALL MSPEAK(24)
      GOTO 55
60    DO 62 I=1,70
         K=71-I
         IF(TEXT(K).NE.BLANK)GOTO 65
62    CONTINUE
      K=0
      GOTO 70
65    IF((K.EQ.1).AND.(TEXT(1).EQ.PERIOD))GOTO 90
      CALL CVLTUC(TEXT,K)
      K=(K+4)/5
      DO 66 I=1,K
         K1=M+I
         K2=5*(I-1)+1
         MTDTXT(K1)=CODE2(TEXT(K2))
66    CONTINUE
70    MTDTXT(M)=M+K+1
      M=M+K+1
      IF(M+14.LT.100)GOTO 55
      CALL MSPEAK(25)
90    MTDTXT(M)=-1
      RETURN
      END

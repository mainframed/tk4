      LOGICAL FUNCTION WIZARD(DUMMY)
C
C  ASK IF HE'S A WIZARD.  IF HE SAYS YES, MAKE HIM PROVE IT.  RETURN
C  TRUE IF HE REALLY IS A WIZARD.
C
      IMPLICIT INTEGER(A-Z)
      LOGICAL YESM
      DIMENSION HNAME(20),XD(10)
      COMMON /WIZCOM/ WKDAY,WKEND,HOLID,HBEGIN,HEND,HNAME,
     1SHORT,MAGIC,MAGNM,LATNCY,SAVED,SAVET,SETUP
      COMMON /IOSCOM/ TTYI,TTYO,BLKLIN,DBFI,DBINIT,DBSAVE
C
      WIZARD=YESM(16,0,7)
      IF(.NOT.WIZARD)RETURN
C
C  HE SAYS HE IS.  FIRST STEP: DOES HE KNOW ANYTHING MAGICAL?
C
      CALL MSPEAK(17)
      CALL GETIN(WORD,X,Y,Z,.FALSE.)
      IF(WORD.NE.MAGIC)GOTO 99
C
C  HE DOES.  GIVE HIM A RANDOM CHALLENGE AND CHECK HIS REPLY.
C
      X=0
      DO 10 I=1,10
         XD(I)=RAN(8)
         X=SHIFT(X,3)+XD(I)
10    CONTINUE
      MWORD=XOR(MAGIC,X)
      IF(YESM(18,0,0))GOTO 99
      WRITE(TTYO,11)XD
11    FORMAT(/1X,10I1)
      READ (TTYI,12) XD
12    FORMAT (10A1)
      WORD = CODE2(XD)
      IF(WORD.NE.MWORD)GOTO 99
C
C  BY GEORGE, HE REALLY *IS* A WIZARD!
C
      CALL MSPEAK(19)
      RETURN
C
C  AHA!  AN IMPOSTOR!
C
99    CALL MSPEAK(20)
      WIZARD=.FALSE.
      RETURN
      END

      INTEGER FUNCTION SHIFT(VAL,DIST)
C
C  RETURN VAL LEFT-SHIFTED (LOGICALLY) DIST BITS (RIGHT-SHIFT IF DIST<0)
C
C  DEFINITION OF CONSTANTS:
C      MAXPOS = MAXIMUM POSITIVE NUMBER
C      MAXNEG = MAXIMUM NEGATIVE NUMBER
C      MXPSR1 = MAXIMUM POSITIVE NUMBER SHIFTED RIGHT ONE BIT
C      MXNSR1 = MAXIMUM NEGATIVE NUMBER SHIFTED RIGHT ONE BIT (POSITIVE)
C
      IMPLICIT INTEGER(A-Z)
      DATA MAXPOS/2147483647/,
     1     MAXNEG/Z80000000/,
     2     MXPSR1/1073741823/,
     3     MXNSR1/1073741824/
C
      SHIFT=VAL
      IF(DIST)10,20,30
10    IDIST=-DIST
      DO 11 I=1,IDIST
      J=0
      IF(SHIFT.LT.0)J=MXNSR1
11    SHIFT=(AND(SHIFT,MAXPOS)/2)+J
20    RETURN
30    DO 31 I=1,DIST
      J=0
      IF(AND(SHIFT,MXNSR1).NE.0)J=MAXNEG
31    SHIFT=AND(SHIFT,MXPSR1)*2+J
      RETURN
      END

         MACRO
         SGIEX001 &PRC,&LST,&TRN,&PUN,&SCD,&SZE
         LCLB  &PCH
&PCH     SETB  (&PUN EQ 0)
CWA      TITLE 'IEX00001 - ALGOL COMPILER COMMON WORKAREA'
*
*STATUS:  CHANGE LEVEL 0
*
*FUNCTION/OPERATION:
*   THIS MODULE IS A COLLECTION OF DATA AND WORKING STORAGE WHICH
*   MUST BE READILY ACCESSIBLE TO MORE THAN ONE COMPILER PHASE.
*   REG. 13 CONTAINS THE ADDRESS OF THIS MODULE DURING THE WHOLE
*   COMPILATION.
*
*ENTRY POINTS: N/A.
*
*INPUT: N/A.
*
*OUTPUT: N/A.
*
*EXTERNAL ROUTINES: N/A.
*
*EXITS - NORMAL: N/A.
*
*EXITS - ERROR: N/A
*
*TABLES/WORK AREAS:
*
*   THE FOLLOWING AREAS ARE PERMANENTLY ASSIGNED DURING THE WHOLE
*   COMPILATION:
*   1. STARTING AT SAVEAREA: REGISTER SAVE AREA IN THE STANDARD FORMAT.
*   2. STARTING AT LINADD: DCB ADDRESSES FOR ALL DATA SETS USED.
*   3. STARTING AT EODUT1: END-OF-DATA EXIT ADDRESSES FOR SYSUT1,
*   SYSUT2,SYSUT3 AND SYSIN.
*   4. HCOMPMOD: THREE BYTES WITH VARIOUS SWITCHES AND INDICATORS FOR
*   CONTROLLING THE PROGRAM FLOW.
*
*   ALLOCATION OF THE BIT POSITIONS IN HCOMPMOD:
*
*   PURPOSE                   POSITION
*   (FIRST ALTERNATIVE        BYTE 1    BYTE 2    BYTE 3
*   CORRESPONDS TO ONE BIT)   01234567  01234567  01234567
*
*                             X
*                              X
*   WARNING ERROR               X
*   SERIOUS ERROR                X
*   TERMINATING ERROR             X
*   PROCEDURE/PROGRAM              X
*   LONG/SHORT PRECISION            X
*                                    X
*
*   NOSOURCE/SOURCE                     X
*   NOLOAD/LOAD                          X
*   NODECK/DECK                           X
*   ISO/EBCDIC                             X
*   PROG. INTERRUPT                         X
*   TERMINATING PHASE ENTERED                X
*   NO BUFFERS ASSIGNED                       X
*   NO COMPILATION POSSIBLE                    X
*
*   SYSPRINT DOWN                                 X
*   WHOLE SOURCE PROG IN CORE                      X
*   NO OPTAB                                        X
*   SYSPRINT NOT OPENED                              X
*   ERROR UNRELATED TO SEMICOLON NR.                  X
*   NOTEST/TEST                                        X
*   (NOT USED)                                          X
*   (NOT USED)                                           X
*
*   5. STARTING AT SIZE: MISC. CONTROL INFORMATION.
*   6. STARTING AT ERRPOOL: ADDRESS POINTERS TO THE ERROR POOL AND THE
*   SOURCE PROGRAM BUFFER 1.
*   7. STARTING AT INBLKS: A TABLE OF THE LENGTHS OF I/O BUFFERS AND
*   OTHER AREAS WHICH DEPEND ON THE STORAGE SIZE. THE TABLE IS SELECTED
*   BY THE INITIALIZATION PHASE AND INSERTED INTO THIS MODULE.
*   8. PAGEHEAD: THREE HEADLINES TO BE PRINTED AT THE TOP OF EVERY
*   PAGE.
*
*   THE FOLLOWING AREAS ARE USED ONLY DURING CERTAIN PHASES OF THE
*   COMPILATION, AS INDICATED IN THE ASSEMBLY LISTING. FOR THIS REASON,
*   SOME OF THEM OVERLAY EACH OTHER, AND ANY SPACE NOT RESERVED DURING
*   A CERTAIN PHASE MAY BE USED AS WORKING SPACE BY THAT PHASE.
*   9. PRELPOOL: A PRELIMINARY ERROR POOL USED DURING THE FIRST PART
*   OF THE INITIALIZATION PHASE.
*   10. DCBIN: DCB FOR SYSIN.
*   11. PBTAB2,PBTAB1, FSTAB: TABLES USED BY CERTAIN PHASES.
*   12. DCBUT1: DCB FOR SYSUT1.
*   13. SPTAB, GPTAB:  TABLES USED BY SCAN I/II AND SCAN III.
*
*   THE REMAINING SPACE UP TO 4K IS USED AS WORKING STORAGE.
*
*ATTRIBUTES: N/A.
*
*NOTES: THIS MODULE IS ASSEMBLED AT SYSTEM GENERATION TIME. THE OPTION
*   SWITCHES IN HCOMPMOD ARE THEN INITIALIZED TO REFLECT THE DESIRED
* DEFAULT OPTIONS. THE ASSEMBLED MODULE IS LINKAGE EDITED WITH THE
*   MODULE IEX00000 TO FORM THE RESIDENT PART OF THE COMPILER DIRECTORY
*   THE OPERATION OF THIS MODULE DEPENDS ON AN INTERNAL REPRESENTATION
*   OF EBCDIC CHARACTERS WHICH IS EQUVIVALENT TO THE ONE USED WHEN
*   THE MODULE WAS ASSEMBLED.
         EJECT
         EXTRN IEX00LIN,IEX00PCH,IEX00PRT,IEX00UT2,IEX00UT3
         EXTRN IEX00SYN,IEX00ED1,IEX00EDI,IEX00PIC,IEX00PRI
IEX00001 CSECT
SAVEAREA DS    F                                    ***
         DS    F         HIGHER LEVEL SAVEAREA ADDR   *
         DS    F         LOWER LEVEL SAVEAREA ADDR    *
         DS    F         RETURN ADDR                  *
         DS    F         ENTRY POINT ADDR             *
SVEREG0  DS    F         ***                          *
SVEREG1  DS    F           *                          *
SVEREG2  DS    F           *                          *
SVEREG3  DS    F           *                          *  SAVEAREA
SVEREG4  DS    F           *                          *
SVEREG5  DS    F           *                          *
SVEREG6  DS    F           * SAVEAREA FOR REGISTERS   *
SVEREG7  DS    F           *                          *
SVEREG8  DS    F           *                          *
SVEREG9  DS    F           *                          *
SVEREG10 DS    F           *                          *
SVEREG11 DS    F           *                          *
SVEREG12 DS    F         ***                        ***
         SPACE
LINADD   DC    A(IEX00LIN) ***
         DS    A             *
         DS    A             *
         DS    A             *
INADD    DC    A(DCBIN)      *  ADDRESSES OF  DATA CONTROL BLOCKS
PRINTADD DC    A(IEX00PRT)   *
PCHADD   DC    A(IEX00PCH)   *
UT1ADD   DC    A(DCBUT1)     *
UT2ADD   DC    A(IEX00UT2)   *
UT3ADD   DC    A(IEX00UT3) ***
         SPACE
EODUT1   DC    A(0)      ***
EODUT2   DC    A(0)        *  END OF DATA EXIT ADDRESSES
EODUT3   DC    A(0)      ***
EODIN    DC    A(0)                ADDR OF END OF DATA ROUTINE SYSIN
HCOMPMOD DC    BL2'&PRC.0&LST&TRN&PCH&SCD.0010',BL2'0'
PARMFLD  EQU   HCOMPMOD
         SPACE
* OPTION SWITCHES IN HCOMPMOD
PGR      EQU   X'FB'
PROC     EQU   X'04'
SHRT     EQU   X'FD'
LNG      EQU   X'02'
         SPACE
* OPTION SWITCHES IN HCOMPMOD+1
SRCE     EQU   X'7F'
NSRCE    EQU   X'80'
LOAD     EQU   X'BF'
NLOAD    EQU   X'40'
DCK      EQU   X'DF'
NDCK     EQU   X'20'
EBCDIC   EQU   X'EF'
ISO      EQU   X'10'
         SPACE
* ERROR SEVERITY INDICATORS IN HCOMPMOD
WERR     EQU   X'20'     WARNING ERROR
SERR     EQU   X'10'     SERIOUS ERROR
TERR     EQU   X'08'     TERMINATING ERROR
            SPACE
* TERMINATION SWITCHES IN HCOMPMOD+1
ERR      EQU   X'08'     PROG INTERRUPTION HAS OCCURED IN COMPILER
TERM     EQU   X'04'     LAST PHASE HAS BEEN ENTERED
NOBUF    EQU   X'02'     ERROR POOL IS IN WORKAREA, NO SCE PROG BUFF 1
NOGO     EQU   X'01'     COMPILATION IS IMPOSSIBLE, DO NOT START SCAN 1
NOBUNOGO EQU   X'03'     NOBUF AND NOGO
         SPACE
* SWITCES IN HCOMPMOD+2
PRT      EQU   X'80'     SYSPRINT IS DOWN
SPIC     EQU   X'40'     SOURCE PROG IN CORE
NOPT     EQU   X'20'     NO OPTAB
PRTNO    EQU   X'10'     SYSPRINT NOT OPENED
NOSC     EQU   X'08'                    SEMICOLON COUNTER NOT VALID
NOTEST   EQU   X'04'
TEST     EQU   X'FB'
SET60    EQU   X'02'              60 CHARACTER SET IS TO BE USED
         SPACE
*  MISCELLANEOUS CONTROL INFORMATION
SIZE     DC    F'&SZE'   AMOUNT OF AVAIBLE MAIN STORAGE
OLDPICA  DC    A(IEX00PIC) ADDR OF PICA OF THE INVOKER
PICAADD  EQU   OLDPICA             ADDR OF PICA OF THE COMPILER
HDING    DC    F'0'      POINTER TO THE HEADING INFO OF THE INVOKER
ERET     DC    F'0'      RETURN ADDRESS FOR PROGRAM AND I/O ERRORS
PAGECNT  DC    F'0'      PAGE COUNT
LINCNT   DC    H'0'      COUNTER OF LINES PER PAGE
MAXLINES DC    H'50'     NUMBER OF PRINT LINES PER PAGE
SEMCNT   DC    H'0'      SEMICOLON COUNTER
PBN      DC    H'50'      HIGHEST PROGRAM BLOCK NUMBER
KBN      DC    H'0'      HIGHEST CONSTANT POOL NUMBER
LATNR    EQU   28                       NR OF LIBRARY STAND FUNCTIONS
LATBEG   EQU   4*(LATNR-1)
LN       DC    AL2(LATBEG)         LAST USED DISPLACEMENT IN LAT
PRPT     DC    F'0'      PROGRAM POINTER
SAVOUTA  DC    F'0'
OUTAREA2 DS    F                       SYSPUNCH SAVE AREA
PIDENT   DC    CL4' '    PROGRAM IDENTIFICATION
SEQU     DC    F'0'      OBJECT PROGRAM CARD SEQUENCE NUMBER
PRTRTADD DC    A(IEX00PRI)    ADDRESS OF PRINT ROUTINE
         SPACE
* ADDRESSES OF AREAS WHICH ARE USED BY MORE THAN A SINGLE PHASE
ERRPOOL  DC    A(PRELPOOL)         FIRST BYTE OF PRELIMINARY ERROR POOL
NEXTERR  DC    A(PRELPOOL)         NEXT FREE PLACE IN ERROR POOL
ENDPOOL  DS    F         LAST BYTE OF ERROR POOL -23
SRCE1ADD DS    F         SOURCE PROGRAM BUFFER 1
SRCE1END DS    F           ADDR OF LAST BYTE +1
SULTSTRT DS    F         IDENTIFICATION OF LAST ITAB RECORD
         SPACE
* TABLE OF THE LENGTHS OF VARIABLE SIZE AREAS
INBLKS   DS    H         MAX BLOCKSIZE FOR SYSIN
PRTBLKS  DS    H         MAX BLOCKSIZE SYSPRINT
LINBLKS  DS    H         MAX BLOCKSIZE FOR SYSLIN
PCHBLKS  DS    H         MAX BLOCKSIZE FOR SYSPUNCH
POOLS    DS    F         SIZE OF ERROR POOL
SRCE1S   DS    F         SIZE OF SOURCE PROG BUFFERS 1 AND 2
SRCE3S   EQU   SRCE1S    SIZE OF SOURCE PROG BUFFERS 3 AND 4
ITAB10S  DS    F         SIZE OF ITAB FOR PHASE 10
ITAB20S  DS    F         SIZE OF ITAB FOR PHASE 20
ITAB30S  DS    F         SIZE OF ITAB FOR PHASE 30
CRIDTABS DS    F         SIZE OF CRIDTAB FOR PHASE 30
SUTAB30S DS    F         SIZE OF SUTAB BUFFER OF PHASE 30
LVTAB30S DS    F         SIZE OF LVTAB BUFFER FOR PHASE 30
OPTABS   DS    F         SIZE OF OPTAB BUFFERS 1 AND 2
SUTAB40S DS    F         SIZE OF SUTAB IN PHASE 40
LVTAB40S DS    F         SIZE OF LVTAB IN PHASE 40
OOSTACKS DS    F         SIZE OF OPERATOR/OPERAND STACK
         SPACE
* AREA FOR HEADING INFORMATION TO APPEAR AT THE TOP OF EACH NEW PAGE
         SPACE
* THE FORMAT OF EACH HEADING FIELD IS..
*   BYTE 1     NUMBER OF LINES OCCUPIED (INCL. BLANK LINES)
*   BYTE 2     PRINTER CONTROL CHARACTER
*   BYTES 3-93 TEXT TO BE PRINTED AS ONE LINE
         SPACE
PAGEHEAD EQU   *
PAGEHD1  DC    X'0109',CL82' '          FIRST HEADLINE
         DC    C'PAGE    '
HDLG     EQU   *-PAGEHEAD
PAGEHD2  DC    X'0109',CL90' '          SECOND HEADLINE
PAGEHD3  DC    X'0109',CL90' '          THIRD HEADLINE
PAGEHEND EQU   *-1
         SPACE
*  THE FOLLOWING AREAS ARE NEEDED BY SOME BUT NOT ALL PHASES AND
*  PARTLY OVERLAY EACH OTHER
         SPACE
*                             NAME OR PURPOSE          NEEDED BY PHASES
         SPACE
         DS    0F
PRELPOOL DC    236C' ',20C'X' PRELIMINARY ERROR POOL     IEX10
         ORG   PRELPOOL+414
*                             DCB FOR SYSIN                 11
DCBIN    DCB   DDNAME=SYSIN,                                           X
               DSORG=PS,                                               X
               MACRF=(GM),                                             X
               RECFM=FB,                                               X
               LRECL=80,                                               X
               BFTEK=S,                                                X
               SYNAD=IEX00SYN,                                         X
               EODAD=IEX00EDI
         ORG   PRELPOOL
PBTAB2   DS    CL510          PROGR. BLOCK TABLE 2          20-50
         DS    0F
PBTAB1   DS    CL255          PROGR. BLOCK TABLE 1          11-20
         ORG   PBTAB1
FSTAB    DS    CL255          FOR STATEMENT TABLE           30-40
*                             DCB FOR SYSUT1                11-30
DCBUT1   DCB   DDNAME=SYSUT1,                                          X
               DSORG=PS,                                               X
               MACRF=(R,W),                                            X
               RECFM=F,                                                X
               SYNAD=IEX00SYN,                                         X
               EODAD=IEX00ED1
         SPACE
         DS    0F
SPTAB    DS    CL255          SCOPE TABLE                   11-30
         DS    0F
GPTAB    EQU   *-3            GROUP TABLE                   11-30
         DS    CL1510
         SPACE
*  END OF SYMLIB PART OF COMMON WORK AREA
         SPACE
         ORG   SAVEAREA+3407
         DC    C'0'
         MEND

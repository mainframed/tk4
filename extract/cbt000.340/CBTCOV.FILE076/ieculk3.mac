         MACRO
     IECULK3 &OUA,&NUA,&UCBNUM,&NCUSW,&CUINDX,&LSTDEV,&CHAN,&DAN,&DSW, *
               &NEG
         LCLA  &COUNT
         AIF   (&LSTDEV EQ 1).EOTRTN    LAST DEVICE TO END OF TAB RTN
&COUNT   SETA  &OUA                     SET UP FOS POSSIBLE FILL
         AIF   (&NCUSW EQ 1).CHKIX      NEW CONTROL UNIT CHK INDEX
.FILOOP  AIF   (&COUNT+1 GE &NUA).INSTUCB  NO FILL-INSERT UCB
         DC    AL2(0)                   NORMAL FILL
&COUNT   SETA  &COUNT+1                 UPDATE COUNT
        AGO   .FILOOP                  RETURN TO FILLER LOOP
.CHKIX   ANOP             CHECK INDEX FOR NINUS VALUE
         AIF   (&NEG EQ 0).INSTUCB     IF INDEX NEG-TO INSERT UCB
&COUNT   SETA &CUINDX                  SERT UP FOR CHECK
.INDXFIL AIF   (&COUNT EQ 0).INSTUCB   END OF FILL-INSERT UCB
         DC    AL2(0)                   NEGATIVE FILLER
&COUNT   SETA  &COUNT-2                UPDATE CPUNT
         AGO   .INDXFIL                 RETUEN TO LOOP
.INSTUCB ANOP             INSERT THE UCB ASDRESS IN THE TABLE
         DC    Y(UCB&UCBNUM.-IPLPSW)   UCB ADDRESS ENTRY           IMP3
         MEXIT
.EOTRTN ANOP          END OF UCB LIST ROUTINE
PURGPTR  DC    AL4(IECIEND-UCBETI)     PSUEDO UCB/PURG END OF LIST
         ORG   PURGPTR
IECIEND  DC    X'FFFF'                 END OF UCB LIST
         DS    2C                      SLIP OVER PURGE POINTER
         DS    0F      ORIGIN UCB'S AT FULL WORD BOUNDARY
.*0054001000,004200-004800                                         IMP3
         MEND

         MACRO
         IECIDT &TYPE
         LCLA  &COUNT                                            BBBBBB
*   DEVICE TABLE
DEVTAB   DS    0F
.TSTLOOP AIF   (&COUNT EQ N'&TYPE).END  LAST TYPE OUT
&COUNT   SETA  &COUNT+1                UPDATE COUNT OF TUPES
         AIF   ('&TYPE(&COUNT)' EQ '').TSTLOOP  TEST FOR BLANK TYPE
         AIF   ('&TYPE(&COUNT)'(1,1) EQ 'P').PRTYTST  TEST PRIOROTY Q
         AIF   ('&TYPE(&COUNT)' EQ 'ODA').ORDDSK  TO ORDERED SEEK AD
.*                 CHECK FOR FIFO ENQUE
         AIF   ('&TYPE(&COUNT)' EQ 'DA').DAWFIFO  TEST DA/FIFO Q
         AIF   ('&TYPE(&COUNT)' EQ 'TA').TAWFIFO  TEST TA/FOFO
         AIF   ('&TYPE(&COUNT)' EQ 'TP').TPWFIFO  TEST TP/FIFO Q
         AIF   ('&TYPE(&COUNT)' EQ 'GR').GRWFIFO  TEST FOR GRAPHICS
**  UNIT RECORD ENTRY WITH FIFO ENQUEING
         DC    AL2(XCPENQ-IOSBASE)      FIFO QUEUE FOR UNIT RECORD RL19
         DC    AL2(XIOUR-IOSBASE)       SIO CODE FOR UNIT RECORD   RL19
         DC    AL2(INTURT-IOSBASE)      TRAP CODE FOR UNIT RECORD  RL19
         AGO   .TSTLOOP           RETURN TO TYPE TST LOOP
.TAWFIFO ANOP
**   TAPE ENTRY FOR FIFO QUEUEING
         DC    AL2(XCPENQ-IOSBASE)      FIFO QUEUE FOR TAPE        RL19
         DC    AL2(XIOTPE-IOSBASE)      SIO FOR TAPE               RL19
         DC    AL2(INTTAT-IOSBASE)      TRAP FOR TAPE              RL19
         AGO   .TSTLOOP           RETURN TO TYPE TST LOOP
.DAWFIFO ANOP
**  DA ENTRY WITH FIFO QUEING
.DAFIFO  DC    AL2(XCP100-IOSBASE)      FIFO QUEUEING FOR D.A.     RL19
         DC    AL2(XIODSK-IOSBASE)      SIO FOR D.A.               RL19
         DC    AL2(INTDAT-IOSBASE)      TRAP FOR D.A.              RL19
         AGO   .TSTLOOP           RETURN TO TYPE TST LOOP
.TPWFIFO ANOP
**  TP SUPPORT ENTRY WITH FIFO QUEING
         DC    AL2(XCPENQ-IOSBASE)      FIFO QUEUEING FOR TP       RL19
         DC    AL2(XCP121-IOSBASE)      SIO FOR TP DEVICES         RL19
         DC    AL2(XCPTPT-IOSBASE)      TRAP FOR TP DEVICES        RL19
         AGO   .TSTLOOP           RETURN TO TYPE TST LOOP
.GRWFIFO ANOP
**  GRAPHICS SUPPORT ENTRY WITH FIFO QUEUING
         DC    AL2(XCPENQ-IOSBASE)      FIFO QUEUING FOR GRAPHICS  RL19
         DC    AL2(XIOUR-IOSBASE)       SIO FOR GRPAHIC DEVICES    RL19
         DC    AL2(INTDNP-IOSBASE)      TRAP FOR GRAPHIC DEVICES   RL19
         AGO   .TSTLOOP            RETURN TO TYPE TST LOOP
.PRTYTST ANOP
         AIF   ('&TYPE(&COUNT)' EQ 'PDA').DAWPR   TEST DA/PRIORITY Q
         AIF   ('&TYPE(&COUNT)' EQ 'PTA').TAPEWPR  TEST TAPE/PRI.Q
         AIF   ('&TYPE(&COUNT)' EQ 'PTP').TPWPR  TEST T/T / PRIORITY Q
         AIF   ('&TYPE(&COUNT)' EQ 'PGR').GRWPR  TEST GR PRIORITY QUE.
**  UNIT RECORD EQUIPMENT POINTS TO ENTRY ONE WITH PRIORITY
         DC    AL2(XCPPRQ-IOSBASE)      PRIORITY Q'ING FOR U.R.    RL19
         DC    AL2(XIOUR-IOSBASE)       SIO CODE FO U.R.           RL19
         DC    AL2(INTURT-IOSBASE)      TRAP CODE FOR U.R.         RL19
         AGO   .TSTLOOP           RETURN TO TYPE TST LOOP
.TAPEWPR ANOP
**  TAPE ENTRY FOR PRIORITY QUEING
         DC    AL2(XCPPRQ-IOSBASE)      PRIORITY QUE FOR TAPE      RL19
         DC    AL2(XIOTPE-IOSBASE)      SIO FOR TAPE               RL19
         DC    AL2(INTTAT-IOSBASE)      TRAP FOR TAPE              RL19
         AGO   .TSTLOOP           RETURN TO TYPE TST LOOP
.DAWPR   ANOP
**  DA ENTRY WITH PRIORITY QUEING
         DC    AL2(XCP100A-IOSBASE)     PRIORITY SEEK Q'NG FOR DA  RL19
         DC    AL2(XIODSK-IOSBASE)      SIO FOR DIRECT ACCESS      RL19
         DC    AL2(INTDAT-IOSBASE)      TRAP FOR DIRECT ACCESS     RL19
         AGO   .TSTLOOP           RETURN TO TYPE TST LOOP
.TPWPR   ANOP
**  TP SUPPORT ENTRY WITH PRIORITY QUEING
         DC    AL2(XCPPRQ-IOSBASE)      PRIORITY QUE FOR TP        RL19
         DC    AL2(XCP121-IOSBASE)      SIO RTN FOR TP DEVICES     RL19
         DC    AL2(XCPTPT-IOSBASE)      TRAP FOR TP DEVICES        RL19
         AGO   .TSTLOOP           RETURN TO TYPE TST LOOP
.GRWPR   ANOP
**  GRAPHICS ENTRY WITH PRIORITY QUEUING
         DC    AL2(XCPPRQ-IOSBASE)      PRIORITY QUEUING FOR GRAPH RL19
         DC    AL2(XIOUR-IOSBASE)       SIO FOR GRAPHICS           RL19
         DC    AL2(INTDNP-IOSBASE)      TRAP FOR GRAPHICS          RL19
         AGO   .TSTLOOP            RETURN TO TYPE TST LOOP
.ORDDSK  ANOP                                                      OSER
**   DA ENTRY WITH ORDERED SEEK QUEUEING
         DC    AL2(XCPSEQ-IOSBASE)      ORDERED SEEK Q FOR DA      RL19
         DC    AL2(XIODSK-IOSBASE)      SIO FOR DIRECT ACCESS      RL19
         DC    AL2(INTDAT-IOSBASE)      TRAP FOR DIRECT ACCESS     RL19
         AGO   .TSTLOOP                 RETUN TO TEST LOOP
.*0582016000                                                       PRSE
.END     ANOP
         MEND

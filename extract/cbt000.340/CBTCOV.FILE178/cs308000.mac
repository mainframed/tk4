C          DATA SET CS308000   AT LEVEL 007 AS OF 05/16/79
C          DATA SET CS308000   AT LEVEL 005 AS OF 04/14/79
C          DATA SET CS308000   AT LEVEL 003 AS OF 10/04/77
C          DATA SET CS308000   AT LEVEL 001 AS OF 07/02/76
C     PGM-ID.  CS308000.
C     AUTHOR.  DON HIGGINS.
C     DATE.    07/02/76.
C     REMARKS. SMF UTILITY FOR FOLLOWING FUNCTIONS
C               1. DUMP ONE OF EACH TYPE OF RECORD.
C                  CODE 1 IN COL. 1 OF FT05F001.
C               2. COPY ALL SMF RECORDS IN THE INTERVAL
C                  AND REPORT TOTALS.
C                  CODE 2 AND YYDDDHHMMYYDDDHHMM.
C               3. COPY ONLY SELECTED RECORDS IN INTERVAL
C                  AND REPORT TOTALS.
C                  CODE 3 AND YYDDDHHMMYYDDDHHMM.
C
C     FILES.
C
C       FT05F001 - CONTROL CARDS FOR ALL OPTIONS
C
C       FT06F001 - OUTPUT REPORTS FOR ALL OPTIONS
C
C       SMFINPUT - INPUT SMF FILE READ BY SMFIO (GU016400)
C
C       SMFCOPY  - OUTPUT SMF FILE WRITTEN BY SMFIO.
C
C     MAINTENANCE.
C
C     10/04/77 DSH - ADD SECOND OPTION.
C     04/14/79 DSH - ADD OPTION 3
C     04/30/79 DSH - CHANGE OPTION 3 TO ALLOW TYPE SPECIFICATION
C
      IMPLICIT INTEGER(A-Z)
      INTEGER RDIO/1/,EOF/3/,DUMP/5/,MOVE/2/,COPY/4/
      INTEGER FCTL/5/,FRPT/6/,FJSR/10/
      INTEGER T(256)/256*0/,TOTAL/0/
C
C     FORMATS
C
   10 FORMAT(I1,I5,2I2,I5,2I2,I3)
   20 FORMAT('1CS308000 SMF RECORDS COPIED FOR ',I5,2I2,1X,I5,2I2
     *     //' TYPE  COUNT'/)
   30 FORMAT(1X,I4,I7)
   40 FORMAT(/5X,I7)
C
C     MAINLINE
C
      READ(FCTL,10)OPTION,SDATE,SHH,SMM,EDATE,EHH,EMM,RECTYP
      IF   (OPTION.EQ.1)
           PM TYPE1
      ELSEIF (OPTION.EQ.2)
           PM TYPE2
      ELSEIF (OPTION.EQ.3)
           PM TYPE3
      ELSE
           STOP 10
      FI
      STOP
C
C     TYPE1 - DUMP ONE OF EACH
C
      PENTRY TYPE1
      PM  GETSMF
      DO  WHILE,(RDIO.NE.EOF)
          IF   (T(RTYPE+1).EQ.0)
               T(RTYPE+1)=1
               CALL SMFIO(DUMP)
          FI
          PM   GETSMF
      OD
      PEXIT
C
C     GETSMF
C
      PENTRY GETSMF
      CALL SMFIO(RDIO,RTYPE,RTIME,RDATE)
      PEXIT
C
C     TYPE2 - COPY SELECTED RECORDS IN INTERVAL (NOTE TIME IS LIMITED
C                                                WITHIN EACH DAY)
      PENTRY TYPE2
      STIME=(SHH*60+SMM)*60*100
      ETIME=(EHH*60+EMM)*60*100
      PM   GETSMF
      DO   WHILE,(RDIO.NE.EOF)
           IF  ((RDATE.GE.SDATE).AND.(RDATE.LE.EDATE))
               IF   ((RTIME.GE.STIME).AND.(RTIME.LE.ETIME))
                    CALL SMFIO(COPY)
                    T(RTYPE+1)=T(RTYPE+1)+1
               FI
           FI
           PM  GETSMF
      OD
      WRITE(FRPT,20)SDATE,SHH,SMM,EDATE,EHH,EMM
      DO   I=1,256
           TOTAL=TOTAL+T(I)
           IF   (T(I).GT.0)
                J=I-1
                WRITE(FRPT,30)J,T(I)
           FI
      OD
      WRITE(FRPT,40)TOTAL
      PEXIT
C
C     TYPE3 - COPY SELECT RECORDS IN INTERVAL (NOTE TIME IS LIMITED FOR
C                                              EACH DAY IN RANGE)
      PENTRY TYPE3
      STIME=(SHH*60+SMM)*60*100
      ETIME=(EHH*60+EMM)*60*100
      PM   GETSMF
      DO   WHILE,(RDIO.NE.EOF)
           IF  (RTYPE.EQ.RECTYP)
               IF  ((RDATE.GE.SDATE).AND.(RDATE.LE.EDATE))
                   IF   ((RTIME.GE.STIME).AND.(RTIME.LE.ETIME))
                        CALL SMFIO(COPY)
                        T(RTYPE+1)=T(RTYPE+1)+1
                   FI
               FI
           FI
           PM  GETSMF
      OD
      WRITE(FRPT,20)SDATE,SHH,SMM,EDATE,EHH,EMM
      DO   I=1,256
           TOTAL=TOTAL+T(I)
           IF   (T(I).GT.0)
                J=I-1
                WRITE(FRPT,30)J,T(I)
           FI
      OD
      WRITE(FRPT,40)TOTAL
      PEXIT
      END

C          DATA SET GU137000   AT LEVEL 001 AS OF 10/22/74
C     PGM-ID.  PROBLEM OF THE EIGHT QUEENS.
C     AUTHOR.  NIKLAUS WIRTH.
C     DATE.    UNKNOWN.
C     REMARKS. TRANSLATED INTO STRUCTURED FORTRAN
C              ON 09/22/74 FROM ALGOL VERSION PUBLISHED IN
C              STURCTURED PROGRAMMING BY E. W. DIJKSTRA,
C              ACADEMIC PRESS, LONDON 1972.
C
C     PROBLEM STATEMENT.  MAKE A PROGRAM GENERATE ALL
C        CONFIGURATIONS OF EIGHT QUEENS ON A CHESSBOARD
C        OF 8 X 8 SQUARES SUCH THAT NO QUEEN CAN TAKE
C        ANY OF THE OTHER QUEENS.
C
C     GLOBAL VARIABLES.
C
C         N = NUMBER OF QUEENS ON THE BOARD (ALSO THE
C             ROW INDEX SINCE THERE CANNOT BE MORE THAN ONE
C             QUEEN ON ANY ROW).
C
C         X(8) = ARRAY INDEXED BY ROW VALUE CONTAINING
C                COLUMN OF EACH QUEEN ON BOARD.
C
C         COL(8) = ARRAY INDEXED BY COL INDICATING IF
C                  COLUMN IS COVERED BY ANY QUEEN.
C
C         UP(15) = ARRAY INDEXED BY (ROW-COL+8) INDICATING
C                  IF UPWARD DIAGONAL IS COVERED BY ANY
C                  QUEEN.
C
C         DOWN(15) = ARRAY INDEXED BY (ROW+COL-1) INDICATING
C                    IF DOWNWARD DIAGONAL IS COVERED BY ANY
C                    QUEEN.
C
C         RECUR = RECURSION COUNTER FOR GENQ ROUTINE.
C
C         STACK(8,2) = ARRAY INDEXED BY RECUR USED TO
C                      STACK LOCAL VALUE OF H AND GENQ
C                      DURING RECURSION.
C
C     LOCAL VARIABLES.
C
C         H = CURRENT COLUMN UNDER CONSIDERATION WITHIN GENQ
C
      INTEGER N,X(8),COL(8),UP(15),DOWN(15)
      INTEGER RECUR,STACK(8,2)
      INTEGER GENQ,H
      INTEGER TRUE,FALSE
      DATA TRUE/1/,FALSE/0/
      DATA N/1/,COL/8*1/,UP/15*1/,DOWN/15*1/
      DATA RECUR/0/
    1 FORMAT(' 8 QUEEN SOLUTION',8I2/)
C
C     MAIN PROGRAM
C
      PERFORM GENQ
      STOP
C
C     GENQ - GENERATE 8 QUEENS SOLUTIONS
C
      PENTRY GENQ
      RECUR=RECUR+1
      STACK(RECUR,1)=H
      STACK(RECUR,2)=GENQ
      H=1
      DO UNTIL,(H.GT.8)
          IF((COL(H).EQ.TRUE).AND.(UP(N-H+8).EQ.TRUE).AND.
     *       (DOWN(N+H-1).EQ.TRUE))
               X(N)=H
               COL(H)=FALSE
               UP(N-H+8)=FALSE
               DOWN(N+H-1)=FALSE
               N=N+1
               IF(N.GT.8)
                    WRITE(6,1)X
               ELSE
                    PERFORM GENQ
               FI
               N=N-1
               DOWN(N+H-1)=TRUE
               UP(N-H+8)=TRUE
               COL(H)=TRUE
          FI
          H=H+1
      OD
      H=STACK(RECUR,1)
      GENQ=STACK(RECUR,2)
      RECUR=RECUR-1
      PEXIT
      END

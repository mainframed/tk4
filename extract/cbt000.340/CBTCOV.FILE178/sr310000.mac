C          DATA SET SR310000   AT LEVEL 010 AS OF 04/28/78
C     PGM-ID. SR310000.
C     AUTHOR. DON HIGGINS.
C     DATE.   04/21/78.
C     REMARKS. TEST FSR/FSW TSO FULL SCREEN SUPPORT (SEE SR308-SR309)
C
      IMPLICIT INTEGER(A-Z)
      INTEGER A(20,23)/460*' '/,LINE(20)/20*' '/
      INTEGER ROW/1/,COL/1/
      INTEGER X/'X'/,C/' '/,BLK/' '/
      INTEGER LAID/0/,LROW/1/,LCOL/1/
      CALL DLOAD('SR309000')
      PM   PFK4
      DO   FOREVER
           CALL FSW(A,ROW,COL)
           LAID=AID
           LROW=ROW
           LCOL=COL
           CALL FSR(A,ROW,COL,AID)
           DOCASE AID
             CASE ELSE
                  IF  (AID.EQ.0)
                      PM   ENTER
                  ELSE
                      PM   BADAID
                  FI
             ESAC
             CASE 1
                  PM  PFK1
             ESAC
             CASE 2
                  PM  PFK2
             ESAC
             CASE 3
                  PM  PFK3
             ESAC
             CASE 4
                  PM  PFK4
             ESAC
             CASE 5
                  PM  PFK5
             ESAC
             CASE 6
                  PM  PFK6
             ESAC
             CASE 26
                  PM  PA2
             ESAC
         ESACOD
      OD
C
C ENTER  - PUT CHARACTER AT 1,1 AT ROW,COL USING AREA MOVE
C
      PENTRY ENTER
      CALL FSAM(A,ROW,COL,1,1,1,1,0)
      PEXIT
C
C PFK1   - WRITE LINE(COL) INTO LINE(ROW) USING WRITE FIELD
C
      PENTRY PFK1
      CALL FSAWF(A,ROW,1,80,A(1,COL))
      PEXIT
C
C PFK2   - READ LINE(ROW) FROM LINE(COL) USING READ FIELD
C
      PENTRY PFK2
      CALL FSARF(A,ROW,1,80,A(1,COL))
      PEXIT
C
C PFK3   - MOVE LINE 1 COLUMNS 1 TO COL TO THE TITLE AREA
C
      PENTRY PFK3
      CALL FST(A,COL)
      PEXIT
C
C PFK4   - DISPLAY HELP INFO
C
      PENTRY PFK4
      CALL FSAM(A,1,1,23*80,1,1,0,BLK)
      CALL FSAWF(A,01,1,40,'SR310000 IS FSF TEST AND DEMO PROGRAM   ')
      CALL FSAWF(A,02,1,40,'THE FOLLOWING FUNCTIONS ARE AVAILABLE   ')
      CALL FSAWF(A,03,1,40,'ENTER - MOVE CHAR AT 1,1 TO ROW,COL     ')
      CALL FSAWF(A,04,1,40,'PFK1  - MOVE LINE COL TO LINE ROW FSAWF ')
      CALL FSAWF(A,05,1,40,'PFK2  - MOVE LINE COL TO LINE ROW FSARF ')
      CALL FSAWF(A,06,1,40,'PFK3  - MOVE LINE 1 TO COL TO TITLE     ')
      CALL FSAWF(A,07,1,40,'PFK4  - DISPLAY THIS HELP SCREEN AGAIN  ')
      CALL FSAWF(A,08,1,40,'PFK5  - DISPLAY NN LINES USING FSRL/WL  ')
      CALL FSAWF(A,09,1,40,'PFK6  - FILL SCREEN WITH CHAR ROW,COL   ')
      CALL FSAWF(A,10,1,40,'NOTE *** MEANS HIT ENTER FOR NEXT SCREEN')
      CALL FSAWF(A,11,1,40,'NOTE $$$ MEANS BAD SCREEN - RE-ENTER    ')
      CALL FSAWF(A,12,1,40,'PA2   - CALL EXIT                       ')
      PEXIT
C
C PFK5 - READ NN WITH FSRL AND DISPLAY NN LINES USING FSWL
C
      PENTRY PFK5
      CALL INFILQ(LINE,80)
      WRITE(99,30)
   30 FORMAT(' PFK5 FSRL/WL TEST - ENTER NN TO PRODUCE NN LINES')
      CALL FSWL(LINE)
      CALL FSRL(LINE,ROW,COL,AID)
      CALL INFILQ(LINE,80)
      READ(99,20)NN
   20 FORMAT(I2)
      DO   WHILE,(NN.NE.0)
           DO  I=1,NN
               CALL INFILQ(LINE,80)
               WRITE(99,20)I
               CALL FSWL(LINE)
           OD
           CALL FSRL(LINE,ROW,COL,AID)
           CALL INFILQ(LINE,80)
           READ(99,20)NN
      OD
      PEXIT
C
C PFK6   - FILL SCREEN WITH CHARACTER AT ROW,COL
C
      PENTRY PFK6
      CALL FSARF(A,ROW,COL,1,C)
      CALL FSAM(A,1,1,23*80,1,1,0,C)
      PEXIT
C
C PA2    - CALL EXIT
C
      PENTRY PA2
      CALL EXIT
      PEXIT
C
C BADAID - DISPLAY BAD AID
C
      PENTRY BADAID
      CALL INFILQ(A,80)
      WRITE(99,10)AID
   10 FORMAT('UNDEFINED AID=',I5)
      PEXIT
      END

C          DATA SET GU722000   AT LEVEL 004 AS OF 08/28/75
      SUBROUTINE SWF(OP,NFILE,NBLK,NREC,BUF,LBUF,REC,LREC,EOF)
      IMPLICIT INTEGER(A-Z)
      INTEGER BUF(1),REC(1)
C
C     PGM-ID.  GU722000.
C     AUTHOR.  DON HIGGINS.
C     DATE.    08/06/75.
C     REMARKS. SEQUENTIAL WORK FILE ACCESS ROUTINE USING FORTRAN
C              DIRECT ACCESS FILE TO AVOID BSAM OPEN/CLOSE OVERHEAD.
C
C         OP - OPERATION CODE
C
C              1 - GET NEXT RECORD
C              2 - PUT NEXT RECORD
C              3 - ENDFILE (WRITE RECORD WITH ALL ZEROS AS EOF IND.)
C              4 OPEN (SET NBLK=1  AND NREC=1)
C
C         NFILE - FORTRAN DIRECT ACCESS FILE NUMBER. DEFINE FILE MUST
C                 BE IN THE MAIN CALLING PROGRAM.
C
C         NBLK - BLOCK POINTER.
C
C         NREC - RECORD POINTER USED BY THIS SUBROUTINE TO BLOCK AND
C                DEBLOCK RECORDS.
C
C         BUF - ARRAY EQUAL TO PHYSICAL BLOCK LENGTH IN DEFILE FILE
C
C         LBUF  - LENGTH OF BUFFER IN WORDS SAME AS IN DEFINE FILE
C
C         REC - ARRAY EQUAL TO LOGICAL RECORD LENGTH
C
C         LREC - LENGTH OF LOGICAL RECORD IN WORDS
C
C         EOF - END OF FILE INDICATOR
C
C                  0 - FALSE
C                  1 - TRUE
C
C     MAIN
C
      DOCASE OP
          CASE 1
                    PM   GET
          ESAC
          CASE 2
                    PM   PUT
          ESAC
          CASE 3
                    PM   ENDFL
          ESAC
          CASE 4
                    PM   OPEN
          ESAC
          CASE ELSE
                    STOP 1
          ESAC
      ESACOD
      RETURN
C
C     GET
C
      PENTRY GET
      IF  (NREC.EQ.1)
          READ(NFILE'NBLK)(BUF(I),I=1,LBUF)
      FI
      CALL CLCL(BUF(NREC),LREC*4,0,0,0,CC)
      IF  (CC.EQ.2)
          EOF=1
          PEXIT
      FI
      CALL MVCL(REC,LREC*4,BUF(NREC),LREC*4,0)
      NREC=NREC+LREC
      IF  (NREC.GT.LBUF)
          NREC=1
          NBLK=NBLK+1
      FI
      EOF=0
      PEXIT
C
C     PUT
C
      PENTRY PUT
      CALL MVCL(BUF(NREC),LREC*4,REC,LREC*4,0)
      NREC=NREC+LREC
      IF  (NREC.GT.LBUF)
          WRITE(NFILE'NBLK)(BUF(I),I=1,LBUF)
          NBLK=NBLK+1
          NREC=1
      FI
      PEXIT
C
C     ENDFILE
C
      PENTRY ENDFL
      CALL MVCL(BUF(NREC),LREC*4,0,0,0)
      WRITE(NFILE'NBLK)(BUF(I),I=1,LBUF)
      PEXIT
C
C     OPEN
C
      PENTRY OPEN
      NBLK=1
      NREC=1
      PEXIT
      END

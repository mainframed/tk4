C          DATA SET GU684000   AT LEVEL 001 AS OF 08/27/75
C     PGM-ID.  GU684000.
C     AUTHOR.  DON HIGGINS.
C     DATE.    08/27/75.
C     REMARKS. TEST FIFO DA QUEUE ROUTINES FOR TROUBLE ANALYSIS USE
C
      IMPLICIT INTEGER(A-Z)
      INTEGER MSG(20),REC(22)
      REAL*8 TERM
      INTEGER ERROR/'ERR'/
      INTEGER MAXQUE/10/
  100 CALL TPQUE(STATUS)
      IF  (STATUS.EQ.1)  GO TO 200
      NQ=1
  110 CALL QUEGET(NQ,REC,STATUS,TQUE)
      IF  (STATUS.EQ.1)  GO TO 120
      NQ=NQ+1
      IF  (NQ.GT.MAXQUE) GO TO 200
      GO TO 110
  120 CALL MVCOUT(REC,TERM,8,MSG,80)
      CALL TIMER(4,10)
      CALL TPPUT(TERM,'PROCESSED',9)
      CALL TPPUT(TERM,MSG,80)
      GO TO 100
  200 CALL TPGET(TERM,MSG,80)
      IF  (MSG(1).EQ.ERROR) GO TO 220
      QUEUE=1
      CALL MVCIN(REC,TERM,8,MSG,80)
      CALL QUEPUT(QUEUE,REC,STATUS,TQUE)
      IF  (STATUS.NE.1) GO TO 120
      CALL TPPUT(TERM,'ACCEPTED ON QUEUE',17)
      GO TO 100
  220 CALL TPPUT(TERM,'ERROR',5)
      CALL TPPUT(TERM,MSG,80)
      GO TO 100
      END

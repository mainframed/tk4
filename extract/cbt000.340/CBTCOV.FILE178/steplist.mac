C          DATA SET GU016600   AT LEVEL 002 AS OF 06/08/76
C     PGM-ID.  GU016600.
C     AUTHOR.  DON HIGGINS.
C     DATE.    05/15/71.
C     REMARKS. LIST SUMMARY INFO FROM TYPE 4 STEP SMF RECORDS.
C     FILES.
C
C        FT05F001 - CONTROL CARD
C              1-5 STARTING DATE YYDDD
C              6-10 ENDING DATE YYDDD
C              11-15 MINIMUM COMPLETION CODE TO PRINT
C        FT06F001 - REPORT
C        SMFINPUT - INPUT SMF FILE TO SMFIO (GU016400)
C
C     REV1 06/08/76 DSH - FIX PTN AND SIZE FOR VS2.
C
      IMPLICIT INTEGER (A-Z)
      DATA SYSIN/5/,SYSOUT/6/
      DATA RDIO/1/,MOVE/2/,EOF/3/
      DIMENSION HEX(16),HCODE(4)
      DATA HEX/'0','1','2','3','4','5','6','7',
     *         '8','9','A','B','C','D','E','F'/
      DATA LINE/0/,PAGE/0/
      REAL*8 JOB,STEP,PGM
      TDAY=24*3600*100
C
C     READ DATES
C
   10 READ(SYSIN,11)SDAY,EDAY,CMCODE
   11 FORMAT(3I5)
C
C     READ STEP RECORD
C
   20 CALL SMFIO(RDIO,RTYPE,J,J,J,J)
      IF(RDIO.EQ.EOF) GO TO 100
      IF(RTYPE.NE.4)GO TO 20
      CALL SMFIO(MOVE,RTYPE,6,4,0,DAY)
      CALL CVTPB(DAY)
      IF (DAY.LT.SDAY) GO TO 20
      IF (DAY.GT.EDAY) GO TO 20
      CODE=0
      CALL SMFIO(MOVE,RTYPE,51,2,2,CODE)
      IF(CMCODE.GT.CODE)GO TO 20
C
C     GET  STEP DATA
C
      CALL SMFIO(MOVE,RTYPE,14,8,0,JOB)
      CALL SMFIO(MOVE,RTYPE,62,8,0,STEP)
      CALL SMFIO(MOVE,RTYPE,54,8,0,PGM)
      CALL SMFIO(MOVE,RTYPE,39,4,0,START)
      CALL SMFIO(MOVE,RTYPE,02,4,0,ENDED)
      L=0
      CALL SMFIO(MOVE,RTYPE,102,2,2,L)
      CPU=0
      CALL SMFIO(MOVE,RTYPE,103+L,3,1,CPU)
      DUR=ENDED-START
      IF(DUR.LT.0)DUR=DUR+TDAY
      PTN=0
      SIZE=0
      CARDS=0
      CALL SMFIO(MOVE,RTYPE,70,2,2,PTN)
      CALL SMFIO(MOVE,RTYPE,74,2,2,SIZE)
      CALL SMFIO(MOVE,RTYPE,47,4,0,CARDS)
      M=102+L
      NIO=L/8
      IO=0
      L=108
   30 IF(L.GT.M)GO TO 40
      CALL SMFIO(MOVE,RTYPE,L,4,0,IT)
      IO=IO+IT
      L=L+8
      GO TO 30
C
C     EDIT STEP DATA
C
   40 I=CODE/4096
      HCODE(1)=HEX(I+1)
      CODE=CODE-I*4096
      I=CODE/256
      HCODE(2)=HEX(I+1)
      CODE=CODE-I*256
      I=CODE/16
      HCODE(3)=HEX(I+1)
      I=(CODE-I*16)
      HCODE(4)=HEX(I+1)
      CALL HHMMSS(START,SH,SM,SS)
      CALL HHMMSS(ENDED,EH,EM,ES)
      CALL HHMMSS(DUR  ,DH,DM,DS)
      CALL HHMMSS(CPU  ,CH,CM,CS)
C
C     PRINT DATA
C
   50 IF(LINE.GT.0)GO TO 70
      LINE=50
      PAGE=PAGE+1
   60 WRITE(SYSOUT,61)SDAY,EDAY,PAGE
   61 FORMAT(
     * '1'//1X,'GU016600 SMF STEP SUMMARY REPORT FROM'
     *   ,I6,' TO',I6,40X,'PAGE',
     * I4,
     * //1X,  'JOBNAME  STEPNAME PGMNAME  DATE  STARTED  ENDED    '
     *     ,  'DURUATION CPU     PTN  SIZE CODE CARDS DEVICES ACCESSES'
     * /)
   70 LINE=LINE-1
   80 WRITE(SYSOUT,81)
     * JOB,STEP,PGM,DAY,SH,SM,SS,EH,EM,ES,DH,DM,DS,CH,CM,CS,
     *    PTN,SIZE,HCODE,CARDS,NIO,IO
   81 FORMAT(
     * 1X,3(A8,1X),I5,4(1X,I2,'/',I2,'/',I2),
     * I4,I6,1X,4A1,I6,I6,I11)
      GO TO 20
  100 CALL EXIT
      END

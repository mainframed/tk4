C          DATA SET GU016700   AT LEVEL 004 AS OF 04/01/76
C
C     SMF RECORD TYPE, COUNT, AND LENGTH ANALYSIS
C
C     AUTHOR.  DON HIGGINS.
C     DATE.    05/15/71.
C     REMARKS.
C
C
C     REV1 03/31/76 DSH - UP RECORD CODES TO 256 FROM 21.
C
      IMPLICIT INTEGER (A-Z)
   61 FORMAT(
     *    10X,I4,I7,I10,6X,I8
     *)
      DATA SYSIN/5/,SYSOUT/6/
      DATA RDIO/1/,MOVE/2/,EOF/3/
      INTEGER COUNT(256)/256*0/,LENGTH(256)/256*0/
      INTEGER NR(256)/256*0/,MAX(256)/256*0/
C
C     READ DATES
C
   10 READ(SYSIN,11)SDAY,EDAY
   11 FORMAT(2I5)
C
C     ACCUMULATE COUNT AND LENGTHS
C
   20 CALL SMFIO(RDIO,RTYPE,TIME,DAY,J,J)
      IF(RDIO.EQ.EOF) GO TO 30
      IF(DAY.LT.SDAY)GO TO 20
      IF(DAY.GT.EDAY)GO TO 20
      IF(RTYPE.LT.0)RTYPE=255
      IF(RTYPE.GT.255)RTYPE=255
      COUNT(RTYPE+1)=COUNT(RTYPE+1)+1
      SIZE=0
      CALL SMFIO(MOVE,RTYPE,-4,2,2,SIZE)
      LENGTH(RTYPE+1)=LENGTH(RTYPE+1)+SIZE
      IF(SIZE.GT.MAX(RTYPE+1))MAX(RTYPE+1)=SIZE
      GO TO 20
C
C     CALCULATE AVERAGES AND PRINT
C
   30 DO 40 I=1,256
      NR(I)=I-1
      NC=COUNT(I)
      IF(NC.GT.1)LENGTH(I)=LENGTH(I)/NC
   40 CONTINUE
   50 WRITE(SYSOUT,51)SDAY,EDAY
      DO  I=1,256
          IF   (COUNT(I).NE.0)
               WRITE(SYSOUT,61)
     *              NR(I),COUNT(I),LENGTH(I),MAX(I)
          FI
      OD
   51 FORMAT(
     * '1'/10X,'SMF RECORD ANALYSIS FROM',I6,' TO ',I6,
     * //10X,'TYPE  COUNT  AVERAGE LENGTH  MAXIMUM LENGTH',
     */)
      CALL EXIT
      END

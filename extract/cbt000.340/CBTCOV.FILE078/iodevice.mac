         MACRO
&NAME  IODEVICE &UNIT=,&MODEL=,&ADDRESS=,&FEATURE=,&OPTCHAN=,&IOREQUE=,X
               &SEEKQUE=,&TRNMODE=,&ADAPTER=,&SETADDR=,                X
               &DEVTYPE=,&ERRTAB=,&NUMSECT=,&OBRCNT=,&AP=NO      S21167
         COPY  SGGBLPAK
.*
.*       SUPPORT CODE S99235 IS USED TO REPRESENT CODE CHANGES FOR
.*       158/158 CONSOLE AND 168 CPU.
.*
.*     OS69755,OS69505,OS69945,OS67531,OS73309,OS74355,@SA78185
 LCLA &A,&I,&ML,&Q,&UL,&H,&CB
         LCLA &X,&Z,&M,&L,&DIV,&QUOT,&DIFF,&REM
         LCLB &IOC,&MULT,&QUIT,&CHKSW
         LCLB &ALT(15),&LOC,&G,&J,&S,&DOC,&KB,&KB7,&KB8
 LCLC &UNIT2,&MODEL2,&B,&C,&D,&E,&F,&ID,&N,&ADDR,&DENS
         LCLC  &O,&OA,&OB,&OC,&OD,&OE,&OF,&OG,&OH
         ACTR  10000                                            SA69505
&QUIT    SETB  (&SGQUITB)
&SGQUITB SETB  0
.ADLOOP  ANOP
         AIF   (&SGMENTB(4)).START      IODEV USED BEFOR CK NO. CALL
&SGMENTB(4)  SETB  1                    SET ENTRY SW FOR 1ST IODEV CALL
         AIF   (&LIMIT(1)).MAX1
         AIF   (&LIMIT(2)).MAX2
         AIF (&LIMIT(3)).MAX3
&SGMAXA(2)  SETA  96
         AGO   .MA
.MAX1    ANOP
&SGMAXA(2)  SETA  248
         AGO   .MA
.MAX2    ANOP
&SGMAXA(2)  SETA  32
         AGO .MA
.MAX3  ANOP
&SGMAXA(2) SETA 768
.MA MNOTE *,'      MAXIMUM OF &SGMAXA(2) I/O DEVICES ALLOWED'
.START   ANOP
&SGCNTRA(3) SETA &SGCNTRA(3)+1          COUNT OF DEVICES TO BE SYSGENED
&I       SETA  &SGCNTRA(3)              SET LCLA PTR FOR SETTING SWT.S
&Z      SETA  &SGCNTRA(2)    GET I/O CONTROL UNIT COUNT
         AIF   ('&NAME' EQ '').INSERT   DID USER SUPPLY MACRO-CALL NAME
&ID      SETC  '&NAME'                  PUT USER'S CALL-NAME IN MNOTES
         AGO   .TESTCNT                 GO TEST FOR MAX DEV.S SYSGENED
.INSERT  ANOP                           ENTER RTN TO PLUG IN MACRO NO.
&ID      SETC  'DEV.#&I'                PUT MACRO-CALL-NO. INTO MNOTES
.TESTCNT  AIF  (&SGCNTRA(3) GE &SGMAXA(2)+1).MX
 AIF ((&SGCNTRA(3) GT 1024) OR (&SGCNTRA(3)+&SG2321A GT 1355)).MY
         AIF   (T'&UNIT EQ 'O').AA      IF UNIT OMITTED GO TO ERROR RTN
&UL      SETA  K'&UNIT                  PUT CNT OF UNIT CHAR IN TST BOX
         AIF   (&UL LE 5).R1            IF UNIT CNT OK,BR TO SAVE RTN
&UL      SETA  5                        IF UNIT CNT BAD,ONLY USE CH 1-5
.R1      ANOP                           ENTER SAVE RTN FOR UNIT CHAR.S
&UNIT2   SETC  '&UNIT'(1,&UL)           SAVE 1ST 5 CHAR UNIT FOR ER MSG
         AIF   (T'&MODEL EQ 'O').R4     IF MOD OMIT,PUT UNT ONLY IN &&C
&LOC     SETB  1                        MOD LOCAL USED LATER FOR TESTNG
&ML      SETA  K'&MODEL                 PUT CNT OF MOD. CHAR IN TST BOX
         AIF   (&ML LE 2).R3            IF MOD. CNT OK,BR TO SAVE RTN
&ML      SETA  2                        IF MOD. CNT BAD,ONLY USE CH 1-2
.R3      ANOP                           ENTER SAVE RTN FOR MODEL CHAR.S
&MODEL2  SETC   '-'.'&MODEL'(1,&ML)     PUT MODEL SPF'D INTO CHARTR BOX
.R4      ANOP                           INITIALIZE &&C FOR ERROR MSGS
&C       SETC  '&UNIT2&MODEL2'          USE 5 UNIT/2 MOD CHAR IN ER MSG
&ML      SETA  0                        CLR FOR USE AS MAX OPTCHAN CNTR
       AIF ('&UNIT' EQ '2401').T2400    IF UNIT=2401, GO 2400 TAPE RTN
       AIF ('&UNIT' EQ '2402').T2400    IF UNIT=2402, GO 2400 TAPE RTN
       AIF ('&UNIT' EQ '2403').T2400    IF UNIT=2403, GO 2400 TAPE RTN
       AIF ('&UNIT' EQ '2404').T2404    IF UNIT=2404, GO 2404 TAPE RTN
       AIF ('&UNIT' EQ '2415').T2400    IF UNIT=2415, GO 2400 TAPE RTN
       AIF ('&UNIT' EQ '2420').T2400    IF UNIT=2420, GO 2400 TAPE RTN
       AIF ('&UNIT' EQ '3420').T3420    IF UNIT=3420, GO 3420 TAPE RTN
         AIF   ('&UNIT' EQ '3410').T3410    IF UNIT=3410, GO 3410 TAPE
       AIF ('&UNIT' EQ '2495').T2495    IF UNIT=2495, GO 2495 CART RTN
       AIF ('&UNIT' EQ '7340').T7340    IF UNIT=7340, GO 7340 HYPTP RTN
       AIF ('&UNIT' EQ '1285').OPTCHAR  IF UNIT=1285, GO OP RDR RTN
       AIF ('&UNIT' EQ '1287').OPTCHAR  IF UNIT=1287, GO OP RDR RTN
       AIF ('&UNIT' EQ '1288').OPTCHAR  IF UNIT=1288, GO OP RDR RTN
       AIF ('&UNIT' EQ '2301').D2301    IF UNIT=2301, GO 2301 DRUM RTN
       AIF ('&UNIT' EQ '2302').D2302    IF UNIT=2302, GO 2302 DISK RTN
         AIF   ('&UNIT' EQ '2303').D2303  TO DRUM RTN
       AIF ('&UNIT' EQ '2311').D2311    IF UNIT=2311, GO 2311 DISK RTN
         AIF   ('&UNIT' EQ '2314').D2314
       AIF ('&UNIT' EQ '3330').D3330             3330
       AIF ('&UNIT' EQ '2305').D2305             2305
       AIF ('&UNIT' EQ '2321').D2321    IF UNIT=2321, GO 2321 DTCEL RTN
       AIF ('&UNIT' EQ '1052').K1052    IF UNIT=1052, GO 1052 KBPRT RTN
       AIF ('&UNIT' EQ '3210').K3210    IF UNIT=3210, GO 3210 CNSLE RTN
       AIF ('&UNIT' EQ '3213').K3213                            S99235
       AIF ('&UNIT' EQ '3215').K3215    IF UNIT=3215, GO 3215 CNSLE RTN
       AIF ('&UNIT' EQ '5450').DIS5450  IF UNIT=5450, GO 5450 DSPLY RTN
       AIF ('&UNIT' EQ '3066').DIS5450  IF UNIT=3066, GO 3066 DSPLY RTN
       AIF ('&UNIT' EQ '3158').DIS3158                          S99235
       AIF ('&UNIT' EQ '2250').DIS2250  IF UNIT=2250, GO 2250 DSPLY RTN
 AIF ('&UNIT' EQ '2260' AND '&ADAPTER' EQ '').DS2260 IF 2260GR BR GR RT
 AIF (&SGCNTRA(2) EQ 0 OR &SGCNTRA(2) GT 255).R6
       AIF   ('&UNIT' EQ '1053' AND &SGUNT2B(&SGCNTRA(2)) AND &SGUNU8B(X
               &SGCNTRA(2))).DIS1053   IF UNIT=1053 AND CONTROL=2848
.R6 ANOP
       AIF ('&UNIT' EQ '3277').DIS3277  IF UNIT=3277, GO 3277 DSPLY RTN
       AIF ('&UNIT' EQ '3284').PRT3284  IF UNIT=3284, GO 3284 PRNTR RTN
       AIF ('&UNIT' EQ '3286').PRT3286  IF UNIT=3286, GO 3286 PRNTR RTN
       AIF ('&UNIT' EQ '2280').DS2280   IS UNIT 2280
       AIF  ('&UNIT' EQ '2282').DS2282  IS UNIT 2282
       AIF ('&UNIT' EQ '1403').PRT1403  IF UNIT 1403
       AIF ('&UNIT' EQ '1404').PRT1404  IF UNIT=1404, GO 1404 PRNTR RTN
       AIF ('&UNIT' EQ '1443').PRT1443  IF UNIT=1443, GO 1443 PRNTR RTN
       AIF ('&UNIT' EQ '3211').PRT3211   IF UNIT 3211
       AIF ('&UNIT' EQ '1442').CRP1442  IF UNIT=1442, GO 1442 CDRDP RTN
       AIF ('&UNIT' EQ '1419').CHKRDR   IF UNIT=1419, GO CHECK READER
       AIF ('&UNIT' EQ '1275').CHKRDR   IF UNIT=1275, GO CHECK READER
       AIF ('&UNIT' EQ '2501').CR2501   IF UNIT=2501, GO 2501 CD RD RTN
       AIF ('&UNIT' EQ '2520').CRP2520  IF UNIT=2520, GO 2520 CDRDP RTN
       AIF ('&UNIT' EQ '2540R').CR2540  IF UNIT=2540R, GO 2540 RDR RTN
       AIF ('&UNIT' EQ '2540P').CP2540  IF UNIT=2540P, GO 2540 PNH RTN
       AIF ('&UNIT' EQ '3505').CR3505   IF UNIT=3505, GO 3505 RDR RTN
       AIF ('&UNIT' EQ '3525').CP3525   IF UNIT=3525, GO 3525 PCH RTN
       AIF ('&UNIT' EQ '2671').RDR2671  IF UNIT=2671, GO 2671 PAPTP RTN
       AIF ('&UNIT' EQ '1030').TP1030   IF UNIT=1030 , GO 1030-SYS RTN
       AIF ('&UNIT' EQ '1050').TP1050   IF UNIT=1050 , GO 1050-SYS RTN
       AIF ('&UNIT' EQ '1050X').TP1050X IF UNIT=1050X, GO 1050X TP/RTN
       AIF ('&UNIT' EQ '1060').TP1060   IF UNIT=1060 , GO 1060-SYS RTN
       AIF ('&UNIT' EQ '2260').TP2260   IF UNIT=2260 , GO 2260-T/P RTN
 AIF ('&UNIT' EQ '2265').TP2265   IF UNIT=2265 , GO 2265-T/P RTN
 AIF ('&UNIT' EQ '7770').TP7770   IF UNIT=7770 , GO 7770-T/P RTN
       AIF ('&UNIT' EQ '115A').TP115A   IF UNIT=115A , GO 115A-T/P RTN
       AIF ('&UNIT' EQ '2740').TP2740   IF UNIT=2740 , GO 2740-T/P RTN
       AIF ('&UNIT' EQ '2740C').TP2740C IF UNIT=2740C, GO 2740C TP/RTN
       AIF ('&UNIT' EQ '2740X').TP2740X IF UNIT=2740X, GO 2740X TP/RTN
       AIF ('&UNIT' EQ '2741P').TP2741P  IF UNIT=2741P,GO 2741P-T/P RTN
       AIF ('&UNIT' EQ '2741C').TP2741C  IF UNIT=2741C,GO 2741C-T/P RTN
       AIF ('&UNIT' EQ '2955').TP2955 IF UNIT=2955, GO 2955 T/P RTN
   AIF  ('&UNIT' EQ '83B3').TP83B3
  AIF  ('&UNIT' EQ 'TWX').TPTWX
       AIF ('&UNIT' EQ 'BSC1').TPBSC1   IF UNIT=BSC1, GO BSC1-T/P RTN
       AIF ('&UNIT' EQ 'BSC2').TPBSC2   IF UNIT=BSC2, GO BSC3-T/P RTN
       AIF ('&UNIT' EQ 'BSC3').TPBSC3   IF UNIT=BSC3, GO BSC3-T/P RTN
       AIF ('&UNIT' EQ 'S360').TPS360   IF UNIT=S360, GO S360-T/P RTN
       AIF ('&UNIT' EQ '2780').TP2780   IF UNIT=2780,GO 2780-T/P RTN
       AIF ('&UNIT' EQ '1130').TP1130   IF UNIT=1130, GO 1130-T/P RTN
       AIF ('&UNIT' EQ '2020').TP2020   IF UNIT=2020, GO 2020-T/P RTN
       AIF ('&UNIT' EQ '2245').PRT2245  IF UNIT=2245, GO TO 2245 RTN
         AIF ('&UNIT' EQ 'WTTA').TPWTTA
         AIF   ('&UNIT' EQ '3705').TP3705
         AIF   ('&UNIT' EQ '3704').TP3705  SAME AS 3705         SA67531
         AIF  ('&UNIT' EQ 'DUMMY').DD   IF DUMMY DEV SPEC, BR DUMMY RTN
.******************************************************************UNC8
         AIF   (K'&UNIT LT 5).IUN99    GREATER THAN 5 CHAR?       *UNC8
         AIF   ('&UNIT'(1,5) EQ 'HASP-').IUN01  AGO IF HASP DEV   *UNC8
.IUN99   ANOP                                                     *UNC8
.******************************************************************UNC8
    MNOTE 5,'* * * IEIIOD101 &ID-UNIT VALUE &UNIT INVALID'
         AGO   .BADUNIT                 INVALID UNIT SPCFD-GO ERROR RTN
.******************************************************************UNC8
.IUN01   ANOP                     **** HASP PSUDO DEVICES ***     *UNC8
&UNPSUDO(&I) SETB 1               INDICATE PSUDO DEVICE.          *UNC8
         AIF   (K'&UNIT NE 9).IUN10    LOOK FOR 10 BYTE TYPES.    *UNC8
&OA      SETC  '&UNIT'(6,4)                                       *UNC8
         AIF   ('&OA' NE '1442').IUN02      NOT 1442              *UNC8
&SGDEVTP(&I) SETA 3               SET LOW BYTE DEV TYPE           *UNC8
         MNOTE *,'      HASP 1442 PUNCH'                          *UNC8
         AGO   .IUN90                                             *UNC8
.IUN02   AIF   ('&OA' NE '2520').IUN03                            *UNC8
&SGDEVTP(&I) SETA 5                                               *UNC8
         MNOTE *,'      HASP 2520 PUNCH'                          *UNC8
         AGO   .IUN90                                             *UNC8
.IUN03   AIF   ('&OA' NE '1403').IUN04                            *UNC8
&SGDEVTP(&I) SETA 8                                               *UNC8
         MNOTE *,'      HASP 1403 PRINTER'                        *UNC8
         AGO   .IUN90                                             *UNC8
.IUN04   AIF   ('&OA' NE '1443').IUN99                            *UNC8
&SGDEVTP(&I) SETA 10                                              *UNC8
         MNOTE *,'      HASP 1443 PRINTER'                        *UNC8
         AGO   .IUN90                                             *UNC8
.IUN10   AIF   (K'&UNIT NE 10).IUN99   INVALID DEV TYPE.          *UNC8
&OA      SETC  '&UNIT'(6,5)                                       *UNC8
         AIF   ('&OA' NE '2540R').IUN11                           *UNC8
&SGDEVTP(&I) SETA 1                                               *UNC8
         MNOTE *,'      HASP 2540 READER '                        *UNC8
         AGO   .IUN90                                             *UNC8
.IUN11   AIF   ('&OA' NE '2540P').IUN99                           *UNC8
&SGDEVTP(&I) SETA 2                                               *UNC8
         MNOTE *,'      HASP 2540 PUNCH  '                        *UNC8
.IUN90   ANOP                                                     *UNC8
&SGETABA(&I) SETA &SGDEVTP(&I)   SET DEV TYP LOW BYTE.            *UNC8
&SGDEVTP(&I) SETA X'500008'           SET DEV TYP HIGH BYTES.     *UNC8
&SGDEVB(1) SETB 1  SET FOR DEV TAB INSP                           *UNC8
         AGO   .DD     HANDLE SAME AS DUMMY DEVICE.               *UNC8
.******************************************************************UNC8
.T2404    ANOP                          RDWT SW SET AUTOMAT'LY IF 2404
&SGDF03B(&I)  SETB  1                   RDWT STD ON 2404-SW REQD BY IOS
&ML      SETA  1                        1 AND ONLY 1 OPTCHAN REQ'D/2404
         AGO   .F6                      BYPASS RTN TO MAKE 3=MAX OPTCHN
.T2400   ANOP                           SET ONE GLOBAL TYP SW FOR 2400
&ML      SETA  3                        2400 W/NO READWRT,MAX OPTCHAN=3
.F6 MNOTE *,'     &UNIT MAGNETIC TAPE DRIVE '
&SGDU01B(&I)   SETB 1                   GLOBAL UNIT SWITCH 1 FOR 2400TP
&SGDF04B(&I) SETB ('&UNIT' EQ '2415' AND &SGUNF4B(&SGCNTRA(2)))
&SGDT01B(&I)   SETB 1                   GLOBAL TYPE SW 1 FOR TAPE
&SGDCLSB(1)  SETB  1                    A SEQUENTIAL CLASS DEV WAS SPEC
&SGDCLSB(2)  SETB  1                    A MAGNETIC TAPE DEV WAS SPECD
&SGDCLSB(3)  SETB  1                    A 2400 TAPE DRIVE WAS SPECD
 AIF ('&UNIT' EQ '2420').T2420
         AIF (NOT &LOC).AB              BR ERROR RTN IF MOD VALUE OMITD
 AIF ( '&MODEL' EQ '1' OR '&MODEL' EQ '2' OR '&MODEL' EQ '3').AC MOD123
 AIF (('&MODEL' EQ '4' OR '&MODEL' EQ '5' OR '&MODEL' EQ '6' OR '&MODEL*
               ' EQ '8') AND ('&UNIT' NE '2404')).AC MODEL 4,5,6, OR 8 *
               EXCEPT FOR 2404.
    MNOTE 5,'* * * IEIIOD103 &ID-MODEL VALUE &MODEL INVALID'
&SGQUITB SETB  1
         AGO   .TFEATRE
.T3410   ANOP
    MNOTE *,'      3410 MAGNETIC TAPE DRIVE '
&SGDT01B(&I)   SETB 1                    GLOBAL TYPE SWITCH FOR TAPE
&SGDU03B(&I)   SETB 1                   A 3400 TAPE DRIVE SPECIFIED
&SG3410B(&I)   SETB 1                   A 3410 TAPE DRIVE SPECIFIED
&SGDCLSB(77)   SETB 1                    A 3410 TAPE DRIVE SPECD
&SGDCLSB(1)    SETB 1                    A SEQUENTIAL CLASS DEV SPECD
&SGDCLSB(2)    SETB 1                    A MAGNETIC TAPE DRIVE SPECD
         AIF   (T'&MODEL EQ 'O').AB
         AIF   ('&MODEL' EQ '1' OR '&MODEL' EQ '2' OR '&MODEL' EQ '3').*
               AC
    MNOTE 5,'* * * IEIIOD103 &ID-MODEL VALUE &MODEL INVALID'
&SGQUITB SETB  1
         AGO   .TFEATRE
.T3420   ANOP
&ML      SETA  3
    MNOTE *,'     3420 MAGNETIC TAPE DRIVE'
&SGDU03B(&I)   SETB 1                   A 3400 TAPE DRIVE SPECIFIED
&SGDT01B(&I)   SETB 1                   GLOBAL TYPE SWITCH FOR TAPE
&SGDCLSB(73)   SETB 1                   A 3420 TAPE DRIVE SPECD
&SGDCLSB(1)    SETB 1                   A SEQUENTIAL CLASS DEV SPECD
&SGDCLSB(2)    SETB 1                   A MAGNETIC TAPE DRIVE SPECD
         AIF   (T'&MODEL EQ 'O').AB
         AIF   ('&MODEL' EQ '3' OR '&MODEL' EQ '5' OR '&MODEL' EQ '7' O*
               R '&MODEL' EQ '4' OR '&MODEL' EQ '6' OR '&MODEL' EQ '8')*
               .AC                                               S99223
    MNOTE 5,'* * * IEIIOD103 &ID-MODEL VALUE &MODEL INVALID'
&SGQUITB SETB  1
         AGO   .TFEATRE
.AC MNOTE *,'     MODEL &MODEL'
&SGDM01B(&I)  SETB (&MODEL EQ 1)   GLOBAL MODEL SWITCH 1
&SGDM02B(&I)  SETB (&MODEL EQ 2)   GLOBAL MODEL SWITCH 2
&SGDM03B(&I)  SETB (&MODEL EQ 3)   GLOBAL MODEL SWITCH 3
&SGDM04B(&I)  SETB (&MODEL EQ 4)   GLOBAL MODEL SWITCH 4
&SGDM05B(&I)  SETB (&MODEL EQ 5)   GLOBAL MODEL SWITCH 5
&SGDM06B(&I)  SETB (&MODEL EQ 6)   GLOBAL MODEL SWITCH 6
&SGDM07B(&I)  SETB (&MODEL EQ 7)   GLOBAL MODEL SWITCH 7
&SGDM08B(&I)  SETB (&MODEL EQ 8)   GLOBAL MODEL SWITCH 8
         AIF   (('&UNIT' EQ '3420') AND ('&MODEL' EQ '4' OR '&MODEL' EQ*
               '6' OR '&MODEL' EQ '8')).ACACA                    S99223
         AGO   .TFEATRE                                          S99223
.ACACA   ANOP                                                    S99223
&SGDF05B(&I)   SETB 1                                            S99223
         AGO   .TFEATRE                                          S99223
.AB MNOTE 5,'* * * IEIIOD104 &ID-MODEL VALUE NOT SPECIFIED'
&SGQUITB SETB  1
.TFEATRE  AIF  (T'&FEATURE EQ 'O').HEDTST                       OS74355
    MNOTE *,'     FEATURE(S) '
&A       SETA  1
.LOOP1   AIF   ('&FEATURE(&A)' EQ '7-TRACK').F1 WAS 7-TRACK HD SPECD
         AIF   ('&FEATURE(&A)' EQ '9-TRACK').F2 WAS 9-TRACK HD SPECD
 AIF ('&FEATURE(&A)' EQ 'READWRITE' AND('&UNIT' EQ '2401' OR '&UNIT' EQX
                '2402')).F3             RDWT VALID OPTL FEAT ON 2401/02
         AIF   ('&FEATURE(&A)' EQ 'DUALDENS').F4  WAS DUALDENS SPECD
         AIF   ('&FEATURE(&A)' EQ 'SHARABLE').F5A WAS SHAREABLE SPECD
         AIF   ('&FEATURE(&A)' EQ 'MDECOMPAT').F7 WAS MDECOMPAT SPECD
         AIF   ('&FEATURE(&A)' EQ 'OPT1600').F8 WAS OPT1600 SPCD S99223
.F1A     ANOP
    MNOTE 5,'* * * IEIIOD105 &ID-FEATURE VALUE &FEATURE(&A) INVALID'
&SGQUITB SETB  1
         AGO   .MORE1
.F1 MNOTE *,'        7-TRACK HEAD '
&SGDF01B(&I) SETB 1           GLOBAL FEAT. SW 1 FOR 7-TRK HED  @SA78185
         AIF  (('&UNIT' EQ '3420') AND ('&MODEL' NE '3' AND '&MODEL' NE*
               '5' AND '&MODEL' NE '7')).F1A  MODELS 3,5,7 OK FOR 3420
.*         NEXT TWO LINES ADDED FOR OS78185                    @SA78185
         AIF  (('&UNIT' EQ '2401') AND ('&MODEL' NE '1' AND '&MODEL' NE*
               '2' AND '&MODEL' NE '3' AND '&MODEL' NE '8')).F1A
         AIF   (&SGDF02B(&I)).AD        7-TRK AND 9-TRK MUTUALLY EXCLSV
         AGO   .MORE1
.F2 MNOTE *,'        9-TRACK HEAD '
&SGDF02B(&I) SETB 1                     GLOBAL FEAT. SW 2 FOR 9-TRK HED
         AIF   ('&MODEL' EQ '8' AND '&UNIT' NE '3420').F2A       S99223
         AIF   (&SGDF01B(&I)).AD        7-TRK & 9-TRK MUTUALLY EXCLUSVE
         AGO   .MORE1
.AD MNOTE 5,'* * * IEIIOD115 &ID-7-TRACK/9-TRACK MUTUALLY EXCLUSIVE'
&SGQUITB  SETB  1
   AGO   .MORE1
.F2A MNOTE 5,'* * * IEIOD105 2401 MODEL 8 EXCLUSIVELY 7-TRACK'
&SGQUITB SETB  1
         AGO   .MORE1
.F3      ANOP
    MNOTE *,'        SIMULATANEOUS READ WHILE WRITE '
&SGDF03B(&I)   SETB 1                   GLOBAL FEATURE SWITCH 3
&ML      SETA  1                        2401,-02 W/RDWT,ONLY 1 OPCH REQ
         AGO   .MORE1
.F4 AIF ((('&UNIT' EQ '2401' OR '&UNIT' EQ '2402' OR '&UNIT' EQ '2403')*
               AND('&MODEL' EQ '4' OR '&MODEL' EQ '5' OR '&MODEL' EQ '6*
               '))).BI DUALDENS    ONLY ON 2401-3 MOD 4,5 OR 6
         AIF   ('&UNIT' EQ '3410').BI   DUALDENS VALID FOR 3410
         AIF   (('&UNIT' EQ '3420') AND ('&MODEL' EQ '3' OR '&MODEL' EQ*
               '5' OR '&MODEL' EQ '7')).BI  3420 MODEL 3,5 OR 7  S99223
    MNOTE 5,'* * * IEIIOD110 &ID-FEATURE DUALDENS INVALID  FOR &UNIT   *
                                         MODEL &MODEL'
&SGQUITB SETB  1
         AGO   .MORE1
.BI MNOTE *,'       DUAL DENSITY FEATURE'
&SGDF04B(&I)   SETB 1                        DUALDENS FEATURE SW
         AIF   (&SGDF06B(&I)).F8A     OPT1600 FEATURE SPECIFIED? S99223
         AGO   .MORE1
.F5A     AIF   ('&UNIT' EQ '3420').F5B
    MNOTE 5,'* * * IEIIOD112 &ID-FEATURE SHARABLE INVALID FOR &UNIT'
&SGQUITB SETB  1
         AGO   .MORE1
.F5B     ANOP
    MNOTE *,'       DEVICE SHARABILITY FEATURE'
&SGDF09B(&I) SETB  1
         AGO   .MORE1
.F7      AIF   ('&UNIT' EQ '3420').F1A  MODE COMPAT. INVALID FOR 3420
         AIF   ('&UNIT' EQ '3410').F1A  MODE COMPAT. INVALID FOR 3410
         AIF   ('&MODEL' EQ '4' OR '&MODEL' EQ '5' OR '&MODEL' EQ '6'  *
               OR '&UNIT' EQ '2415').MM
    MNOTE *,'        MODE COMPATIBILITY FEATURE'
&SGDF05B(&I)   SETB 1
         AGO   .MORE1
.F8      AIF   ('&UNIT' NE '3420').F1A   ONLY 3420 VALID         S99223
         AIF   (('&UNIT' EQ '3420') AND ('&MODEL' NE '4' AND '&MODEL' N*
               E '6' AND '&MODEL' NE '8')).F1A MODELS 4,6,8 OK FOR 3420
      MNOTE *,'      OPT1600 SPECIFIED       '                   S99223
&SGDF06B(&I)   SETB 1                                            S99223
         AIF   (&SGDF04B(&I)).F8A   DUALDENS FEATURE SPECIFIED?  S99223
         AGO   .MORE1
.F8A     ANOP                                                    S99223
  MNOTE 5,'* * * IEIIOD114 &ID DUALDENS AND OPT1600 MUTUALLY EXCLUSIVE'
&SGQUITB SETB 1
         AGO   .MORE1
.MM MNOTE 5,'* * * IEIIOD111 &ID-FEATURE MDECOMPAT INVALID FOR &UNIT   X
                                         MODEL &MODEL'
&SGQUITB SETB 1
         AGO   .MORE1
.MORE1 AIF (N'&FEATURE EQ &A).HEDTST   DONE WITH FEATURES YET   OS74355
&A       SETA  &A+1
         AGO   .LOOP1                   GO BACK AND CHECK NEXT FEATURE
.HEDTST  AIF   ('&UNIT' NE '3410' AND '&UNIT' NE '3420').HEDTST2 S99223
         AIF   ('&MODEL' EQ '4' OR '&MODEL' EQ '6' OR '&MODEL' EQ '8').*
               HEADDEN                                           S99223
         AIF   (&SGDF01B(&I) OR &SGDF04B(&I)).TRKTST  7-TRK OR DUALDENS
&DENS    SETC  '1600'                                            S99223
.DF MNOTE *,'    &DENS BPI DEFAULTED '                           S99223
&SGDF02B(&I)   SETB 1          GLOBAL FEAT. SW. 2 FOR 9-TRK HEAD S99223
         AGO   .HEDTST2                                          S99223
.HEADDEN AIF   (&SGDF01B(&I) OR &SGDF04B(&I) OR &SGDF06B(&I)).TRKTST
&DENS    SETC  '6250'                                            S99223
         AGO   .DF
.HEDTST2 AIF   ('&UNIT' EQ '3410' OR '&UNIT' EQ '3420').TRKTST   S99223
         AIF   (&SGDF01B(&I) OR &SGDF02B(&I)).TRKTST  7-TRK OR 9-TRK
    MNOTE 5,'* * * IEIIOD107 &ID-7-TRACK OR 9-TRACK FEATURE REQUIRED'
&SGQUITB SETB  1                        USER MUST SPECIFY 7/9-TRK HEAD
.TRKTST  AIF   (NOT(&SGDF01B(&I) AND &SGDF04B(&I))).TRKTSTA      S99223
    MNOTE 5,'* * * IEIIOD150 &ID-7-TRACK/DUALDENS MUTUALLY EXCLUSIVE   *
               FOR THE &UNIT TAPE DRIVE'
&SGQUITB SETB  1
         AGO   .APX                                              S21167
.TRKTSTA AIF   (NOT(&SGDF01B(&I) AND &SGDF06B(&I))).APX   S99223 S21167
    MNOTE 5,'* * * IEIIOD151 &ID-7-TRACK/OPT1600 MUTUALLY EXCLUSIVE    *
               FOR THE &UNIT TAPE DRIVE'                         S99223
&SGQUITB SETB  1                                                 S99223
        AGO   .APX                                        S99223 S21167
.T2420   ANOP
&SGDM04B(&I) SETB 1                    MODEL 4 SWITCH
&SGDF02B(&I) SETB 1                    9 TRACK
&SGDCLSB(57)  SETB  1
    AIF (&SGUNT1B(&Z) AND &SGUNU6B(&Z) AND &SGUNM2B(&Z)).APX     S21167
    MNOTE 5,'* * * IEIIOD108 &ID-UNIT NEEDS 2803 MODEL 2 CONTROL UNIT'
&SGQUITB SETB 1
         AGO   .APX                                              S21167
.T2495 MNOTE *,'     2495 TAPE CARTRIDGE READER'
&SGDT07B(&I)   SETB  1                 DEVICE TYPE SWITCH
&SGDU07B(&I)   SETB  1                 UNIT TYPE SWITCH
&SGDCLSB(1)    SETB  1                 SEQUENTIAL CLASS SWITCH
&SGDCLSB(11)   SETB  1                 UNIT-RECORD CLASS SWITCH
&SGDCLSB(61)   SETB  1                 2495 CLASS SWITCH
         AGO   .CHECKX
.T7340   ANOP
&SGDT01B(&I)   SETB 1                   GLOBAL TYPE SWITCH 1 = TAPE
&SGDU06B(&I)   SETB 1                   GLOBAL UNIT SWITCH 6
&SGDCLSB(1)    SETB 1                   A SEQUENTIAL CLASS DEV WAS SPEC
&SGDCLSB(2)    SETB  1                  A MAGNETIC TAPE DEV WAS SPECD
&SGDCLSB(4)    SETB  1                  A 7340 HYPERTAPE DRIVE WAS SPEC
    MNOTE *,'     7340 HYPERTYPE DRIVE '
&ML      SETA  1                        7340 HAS MAX OF 1 OPTCHAN
         AIF   (NOT &LOC).AG            BR ERROR RTN IF MOD VALUE OMITD
         AIF   ('&MODEL' NE '3').AH     MODEL VALUE MUST BE 3 FOR 7340
&SGDM03B(&I)   SETB 1                   GLOBAL MODEL SWITCH 3
    MNOTE *,'     MODEL 3 '
         AGO   .TFEAT5
.AH MNOTE 5,'* * * IEIIOD103 &ID-MODEL VALUE &MODEL INVALID'
&SGQUITB SETB  1
         AGO   .TFEAT5
.AG MNOTE 5,'* * * IEIIOD104 &ID-MODEL VALUE NOT SPECIFIED'
&SGQUITB SETB  1
.TFEAT5  AIF   (T'&FEATURE EQ 'O').CHECKX BRANCH IF NO FEATURES SPECD
    MNOTE *,'     FEATURE  '
&A       SETA  1
.LOOP2   AIF   ('&FEATURE(&A)' EQ 'AUTOCART').F5
    MNOTE 5,'* * * IEIIOD105 &ID-FEATURE VALUE &FEATURE(&A) INVALID'
&SGQUITB SETB  1
         AGO   .MORE2
.F5 MNOTE *,'        AUTOMATIC CARTRIDGE LOADER '
&SGDF01B(&I)   SETB 1                   GLOBAL FEAT. SW 1
.MORE2   AIF   (&A EQ N'&FEATURE).CHECKX  BRANCH IF NO MORE FEATURES.
&A       SETA  &A+1
         AGO   .LOOP2
.OPTCHAR ANOP                          O P T L  C H A R  R D R  R T N
   MNOTE *,'     &UNIT OPTICAL CHARACTER READER'
&SGDT02B(&I) SETB 1                    DEVICE TYPE SWITCH FOR OP RDR
   AIF  ('&UNIT' NE '1285').XOPT
&SGDU01B(&I)  SETB  1
&SGDCLSB(13) SETB 1
   AGO  .ZOPT
.XOPT   AIF  ('&UNIT' NE '1287').YOPT
&SGDU02B(&I)  SETB  1
&SGDCLSB(58)  SETB  1
   AGO  .ZOPT
.YOPT  ANOP
&SGDU03B(&I)  SETB  1
&SGDCLSB(59)  SETB  1
.ZOPT   ANOP
&SGDCLSB(1)  SETB  1
&SGDCLSB(11)  SETB  1
&SGDCLSB(12)  SETB  1
         AGO   .CHECKX
.D2301   ANOP                           D I R E C T  A C C E S S  R T N
&SGDU01B(&I)   SETB 1                   GLOBAL UNIT SWITCH 1
&SGDCLSB(27) SETB  1                    A DRUM STORAGE DEV WAS SPECD.
&SGDCLSB(28) SETB  1                    A 2301 DRUM WAS SPECD.
&SGDASDA SETA &SGDASDA+1                COUNT D.A. DEVICES
    MNOTE *,'     2301 DRUM STORAGE '
         AGO   .PRINTD                  GO TO COMMON FEATURE RTN
.D2302   ANOP
&SGDU02B(&I)   SETB 1                   GLOBAL UNIT SWITCH 2
&SGDCLSB(29) SETB  1                    A DISK STORAGE DEV WAS SPECD.
&SGDCLSB(30) SETB  1                    A 2302 DISK WAS SPECD.
&SGDASDA SETA &SGDASDA+1                COUNT D.A. DEVICES
    MNOTE *,'     2302 DISK STORAGE '
         AIF   (NOT &LOC).AJ            BR ERROR RTN IF MOD VALUE OMITD
 AIF ('&MODEL' NE '3' AND '&MODEL' NE '4').AK
&SGDM01B(&I)  SETB  ('&MODEL' EQ '3')
&SGDM02B(&I) SETB ('&MODEL' EQ '4')
    MNOTE *,'     MODEL &MODEL '
         AGO   .DFEAT
.D2303   ANOP
&SGDU05B(&I)   SETB   1                 SET SWITCH 5
&SGDCLSB(27)   SETB    1                A DRUM STORAGE DEV SPEC
&SGDASDA SETA &SGDASDA+1                COUNT D.A. DEVICES
&SGDCLSB(42)  SETB  1   2303 DRUM STORAGE DEVICE SPECIFIED
    MNOTE *,'     2303 DRUM STORAGE '
         AGO   .PRINTD
.AK MNOTE 5,'* * * IEIIOD103 &ID-MODEL VALUE &MODEL INVALID'
&SGQUITB SETB  1
         AGO   .DFEAT
.AJ MNOTE 5,'* * * IEIIOD104 &ID-MODEL VALUE NOT SPECIFIED'
&SGQUITB SETB  1
         AGO   .DFEAT
.D2305 ANOP
&SGDCLSB(27) SETB 1
&SGDCLSB(40) SETB 1
&SGDCLSB(70) SETB 1
&SGDT03B(&I) SETB 1
&SGDU08B(&I) SETB 1
&SGDASDA SETA &SGDASDA+1
&SG2305A SETA &SG2305A+1
&ML SETA 1
 MNOTE *,'     2305 FIXED HEAD STORAGE'
 AIF (NOT &LOC).D2305E1
         AIF   ('&MODEL' NE '1').M22305
&SGDM01B(&I) SETB 1
&SGDCLSB(75) SETB 1
         AGO   .MDLMSG
.M22305  AIF   ('&MODEL' NE '2').D2305E2
&SGDM02B(&I) SETB 1
&SGDCLSB(76) SETB 1
.MDLMSG MNOTE *,'     MODEL &MODEL'
.D2305FE ANOP
&A SETA 1
 AIF (T'&FEATURE EQ 'O').CHECKX
 MNOTE *,'     FEATURES'
.D2305A AIF ('&FEATURE(&A)' EQ '2-CHANSW').D2305B
 AIF ('&FEATURE(&A)' EQ 'SHARED').D2305C
 MNOTE 5,'* * * IEIIOD147 &ID-FEATURE VALUE &FEATURE(&A) INVALID'
&SGQUITB SETB 1
 AGO .D2305D
.D2305B MNOTE *,'     TWO CHANNEL SWITCH'
&SGDF01B(&I) SETB 1
 AGO .D2305D
.D2305C MNOTE *,'     SHARED DASD'
&SGDF02B(&I) SETB 1
&SGDCLSB(54)  SETB  1         SHARED DASD CLASS SWITCH
.D2305D AIF (&A EQ N'&FEATURE).CHECKX
&A SETA &A+1
 AGO .D2305A
.D2305E1 MNOTE 5,'* * * IEIIOD148 &ID-MODEL VALUE REQUIRED'
&SGQUITB SETB 1
 AGO .D2305FE
.D2305E2 MNOTE 5,'* * * IEIIOD149 &ID-MODEL VALUE &MODEL INVALID'
&SGQUITB SETB 1
 AGO .D2305FE
.D2311   ANOP
&SGDU03B(&I)   SETB 1                   GLOBAL UNIT SWITCH 3
&SGDCLSB(29) SETB  1                    A DISK STORAGE DEV WAS SPECD.
&SGDCLSB(31) SETB  1                    A 2311 DISK WAS SPECD.
&SGDASDA SETA &SGDASDA+1                COUNT D.A. DEVICES
&SG2311A SETA &SG2311A+1     COUNT THE 2311 DISK DRIVES
    MNOTE *,'     2311 DISK STORAGE '
.PRINTD  AGO   .DFEAT
.D2314   ANOP
&SGDU06B(&I)   SETB 1              GLOBAL UNIT SWITCH 6
&SGDCLSB(29)   SETB 1              A DISK STORAGE DEVICE WAS SPECD.
&SGDCLSB(41)   SETB 1              A 2314 WAS SPECIFIED
&SGDASDA SETA &SGDASDA+1                COUNT D.A. DEVICES
&SGDCLSB(40)  SETB  1      OVERFLOW CLASS SWITCH
    MNOTE *,'     2314 DISK STORAGE'
&ML      SETA  3
 AIF (T'&FEATURE EQ 'O').FRM2314
.L2314  AIF (&Q EQ N'&FEATURE).FRM2314
&Q  SETA  &Q+1
  AIF  ('&FEATURE(&Q)' EQ '2-CHANSW').F2314
 AIF ('&FEATURE(&Q)' EQ 'SHARED').FE2314
 AIF ('&FEATURE(&Q)' EQ 'ALTCTRL').AL2314
    MNOTE 5,'* * * IEIIOD105 &ID-FEATURE VALUE &FEATURE(&Q) INVALID'
&SGQUITB  SETB  1
  AGO  .L2314
.F2314  ANOP
&SGDF01B(&I)  SETB  1
&SGDCLSB(56)  SETB  1
   MNOTE *,'       2-CHANSW FEATURE SPECIFIED'
  AGO  .L2314
.FE2314 MNOTE *,'     SHARED DASD'
&SGDF02B(&I) SETB 1      FIFTH GLOBAL FEATURE SWITCH
&SGDCLSB(54) SETB 1      SHARED DASD CLASS SWITCH
 AGO .L2314
.AL2314 MNOTE *,'     ALTERNATE CONTROL FEATURE'
&SGDF03B(&I) SETB 1                    ALTCTRL FOR THIS DEVICE
&SGMENTB(86) SETB 1                    ALTCTRL SPECIFIED DURING SYSGEN
 AGO .L2314
.D2321   ANOP
&SG2321A SETA  &SG2321A+9
&SGDU04B(&I)   SETB 1                   GLOBAL UNIT SWITCH 4
&SGDCLSB(32) SETB 1                     A 2321 DATA CELL DRIVE SPECD
&SGDASDA SETA &SGDASDA+1                COUNT D.A. DEVICES
    MNOTE *,'     2321 DATA CELL DRIVE '
         AGO   .DFEAT                   GO TO FEATURE RTN
.AM MNOTE 5,'* * * IEIIOD103 &ID-MODEL VALUE &MODEL INVALID'
&SGQUITB SETB  1
         AGO   .DFEAT
.AL MNOTE 5,'* * * IEIIOD104 &ID-MODEL VALUE NOT SPECIFIED'
&SGQUITB SETB  1                        MOD=INVLD/OMIT-TURN ON ERROR SW
.DFEAT   ANOP
&ML      SETA  1                        2301,02,11,&&2321,MAX OPTCHAN=1
.FRM2314 ANOP
&SGDT03B(&I)   SETB 1                   GLOBAL TYPE SWITCH 3
&SGDCLSB(26) SETB  1                    A RANDOM CLASS DEV WAS SPECD.
         AGO   .APX              NOP SEEKQUE RTN FOR 1ST DELIVRY S21167
         AIF (T'&SEEKQUE EQ 'O').Q1     IF NULL,ASSUME FIFO SEEK Q'ING
 AIF ('&SEEKQUE' NE 'FIFO' AND '&SEEKQUE' NE 'PRIORITY' AND '&SEEKQUE' X
               NE 'ORDERED').Q2         IF SPECD,BUT INVALID GO ERR RTN
&SGDSQ1B(&I) SETB ('&SEEKQUE' EQ 'PRIORITY') SW1 OFF=FIFO-SW1 ON=PR'RTY
&SGDSQ2B(&I) SETB ('&SEEKQUE' EQ 'ORDERED') SW2 ON=ORDERED QUEUEING
         AGO   .Q3                      GO PRT QUEUEING OPTION
.Q1      ANOP                           IF NO OPT,ASSUME FIFO-SW1=OFF
&F       SETC  'FIFO'                   PUT FIFO IN MSG IF DEFAULT FIFO
.Q3 MNOTE *,'     &F&SEEKQUE SEEK QUEUEING FOR &C '
         AGO  .NOFEAT                   GO TO FEAT TEST FOR D. A. DEV'S
.Q2 MNOTE 5,'* * * IEIIOD115 &ID-SEEKQUE VALUE &SEEKQUE INVALID'
&SGQUITB SETB  1
         AGO   .NOFEAT                  GO TO FEAT TEST FOR D. A. DEV'S
.D3330 MNOTE *,'     3330 DISK STORAGE'
&SGDT03B(&I) SETB 1
&SGDU07B(&I) SETB 1
&SGDCLSB(29) SETB 1
&SGDCLSB(40) SETB 1
&SGDCLSB(69) SETB 1
&SGDASDA SETA &SGDASDA+1
&ML      SETA  3                        3330 MAX OPTCHAN=3
 AIF (T'&FEATURE EQ 'O').APX                                     S21167
 MNOTE *,'     FEATURES'
.D33301 AIF (&A EQ N'&FEATURE).APX                               S21167
&A SETA &A+1
 AIF ('&FEATURE(&A)' EQ '2-CHANSW').D33302
 AIF ('&FEATURE(&A)' EQ 'SHARED').D33303
 MNOTE 5,'* * * IEIIOD150 &ID-FEATURE VALUE &FEATURE(&A) INVALID'
&SGQUITB SETB 1
 AGO .D33301
.D33302 MNOTE *,'     TWO CHANNEL SWITCH'
&SGDF01B(&I) SETB 1
 AGO .D33301
.D33303 MNOTE *,'     SHARED DASD'
&SGDF02B(&I) SETB 1
&SGDCLSB(54)  SETB  1         SHARED DASD CLASS SWITCH
 AGO .D33301
.APX     AIF   ('&AP' EQ 'NO').CHECKX                            S21167
         AIF   ('&AP' NE 'YES').PW                               S21167
&SGDF08B(&I)   SETB 1                                            S21167
       MNOTE *,'      AP SPECIFIED FOR THIS &UNIT '              S21167
         AGO   .CHECKX                                           S21167
.PW  MNOTE 5,'* * * IEIIOD202 AP INVALID - MUST BE YES OR NO'    S21167
&SGQUITB SETB 1                                                  S21167
         AGO   .CHECKX                                           S21167
.K1052   ANOP                           K Y B D  C O N S O L E  R T N S
&SGDU01B(&I)   SETB 1                   GLOBAL UNIT SWITCH 1
&SGDCLSB(5)  SETB 1                     A CONSOLE TYPE DEV WAS SPECD
&SGDCLSB(6)  SETB 1                     A 1052 KEYBD PRINTER WAS SPECD
    MNOTE *,'     1052 PRINTER KEYBOARD'
         AIF   (NOT &LOC).AN            BR ERROR RTN IF MOD VALUE OMITD
 AIF ('&MODEL' NE '8' AND '&MODEL' NE '7' AND '&MODEL' NE '6' AND '&MOD*
               EL' NE '5').AO
&SGDM01B(&I)  SETB  ('&MODEL' EQ '7')
&SGDM02B(&I) SETB ('&MODEL' EQ '8' OR '&MODEL' EQ '6')
&SGDM03B(&I)  SETB  ('&MODEL' EQ '5')
    MNOTE *,'      MODEL &MODEL'
         AGO   .CFEAT
.AO MNOTE 5,'* * * IEIIOD103 &ID-MODEL VALUE &MODEL INVALID'
&SGQUITB SETB  1
         AGO   .CFEAT
.AN MNOTE 5,'* * * IEIIOD104 &ID-MODEL VALUE NOT SPECIFIED'
&SGQUITB  SETB  1
         AGO   .CFEAT
.K3210   ANOP
&SGDU03B(&I)  SETB 1                    GLOBAL UNIT SWITCH 3
&SGDCLSB(5)   SETB 1                    A CONSOLE TYPE DEV WAS SPECD
&SGDCLSB(6)   SETB 1                    3210 PRINTER KEYBOARD SPECD
    MNOTE *,'     3210 CONSOLE'
         AGO .CFEAT
.K3213 MNOTE *,'     3213 CONSOLE'                               S99235
&SGDU08B(&I)  SETB  1                   3213 DEVICE              S99235
&SGDT04B(&I)  SETB  1                   GLOBAL TYPE SWITCH 4     S99235
&SGDCLSB(6)   SETB  1                   CONSOLE PRINTER CLASS    S99235
         AGO   .CHECKX                                           S99235
.K3215   ANOP
&SGDU04B(&I)  SETB 1                    GLOBAL UNIT SWITCH 4
&SGDCLSB(5)   SETB 1                    A CONSOLE TYPE DEV WAS SPECD
&SGDCLSB(6)   SETB 1                    3215 PRINTER KEYBOARD SPECD
    MNOTE *,'     3215 CONSOLE'
.CFEAT   ANOP
&SGDT04B(&I)   SETB 1                   GLOBAL TYPE SWITCH 4
&SGDCLSB(1)  SETB 1                     A SEQUENTIAL CLASS DEV WAS SPEC
.NOFEAT  AGO   .CHECKX
.NOFEAT1 AIF   (T'&FEATURE EQ 'O').CHECKX   TEST IF OMITTED
    MNOTE 5,'* * * IEIIOD164 &ID-&UNIT FEATURE VALUE INVALID, NO FEATUR*
               ES ALLOWED ON THIS DEVICE '
&SGQUITB SETB  1
         AGO   .CHECKX
.DIS3158 MNOTE *,'     3158 DISPLAY UNIT'                        S99235
&SGDT05B(&I)   SETB  1                  CONSOLE DEVICE           S99235
&SGDU10B(&I)   SETB  1                  3158 DEVICE              S99235
&SGDF01B(&I)   SETB  1                  AUDALRM                 SA69945
&SGDF02B(&I)   SETB  1                  SELECTOR PEN            SA69945
&SGDF13B(&I)   SETB  1                  66-KEY OPERATOR CONSOLE SA69945
&SGDCLSB(8)    SETB  1                  GRAPHICS CLASS           S99235
&SGDCLSB(1)  SETB 1                     A SEQUENTIAL CLASS DEV WAS SPEC
&SGDCLSB(80) SETB 1                     ANR DEVICE IN SYSTEM
         AIF   (T'&MODEL EQ 'O').NOFEAT1 NO MODEL SPECIFIED     SA69945
  MNOTE 5,'* * * IEIIOD103 MODEL VALUE &MODEL INVALID;NO MODEL ALLOWED'
&SGQUITB SETB  1                                                 S99235
         AGO   .NOFEAT1                                         SA69945
.DIS5450 ANOP
&SGDCLSB(8) SETB 1
&SGDT05B(&I) SETB 1
&SGDU06B(&I) SETB 1
&SGDCLSB(60)   SETB  1
&SGDF01B(&I) SETB ('&UNIT' EQ '3066')
    MNOTE *,'     &UNIT DISPLAY CONSOLE'
         AGO   .CHECKX
.DIS2250 ANOP                           G R A P H I C  D E V  R T N S
&SGDT05B(&I) SETB 1                     SET TYPE SWT FOR DISPLAY CONSLE
&SGDU01B(&I) SETB 1                     SET UNIT SWT FOR 2250
&SGDCLSB(1)  SETB  1                    A SEQUENTIAL CLASS DEV SPECIFYD
&SGDCLSB(8)  SETB  1                    A GRAPHIC TYPE DEV WAS SPECD
&SGDCLSB(9)  SETB  1                    A 2250 DISPLAY STA. WAS SPECD
    MNOTE *,'     2250 DISPLAY UNIT '
         AIF   (T'&MODEL EQ 'O').AP     BR ERROR RTN IF MOD VALUE OMITD
         AIF ('&MODEL' EQ '1').V1       IF MODEL SPECFYD IS MODEL EQ 1
         AIF  ('&MODEL' EQ '2').V2      GO TO SEPARATE RTN FOR MOD 2
 AIF ('&MODEL' EQ '3').I1       IS MODEL  3  SPECIFIED
    MNOTE 5,'* * * IEIIOD103 &ID-MODEL VALUE &MODEL INVALID'
&SGQUITB SETB  1
   AGO  .I2
.AP MNOTE 5,'* * * IEIIOD104 &ID-MODEL VALUE NOT SPECIFIED'
&SGQUITB SETB  1                        MOD=INVLD/OMIT-TURN ON ERROR SW
   AGO  .I2
.V1 MNOTE *,'     MODEL 1 '
&SGDM01B(&I) SETB 1                     TURN ON 1ST MODEL SWT FOR MOD 1
   AGO  .I2
.V2 MNOTE *,'      MODEL 2'
&SGDM02B(&I)  SETB  1
   AGO  .I2
.I1 MNOTE *,'      MODEL 3'
&SGDM03B(&I)  SETB  1
.I2 AIF (N'&FEATURE EQ 0).NUMSECT
    MNOTE *,'     FEATURE(S) '
.F2250M1 AIF (&Q EQ N'&FEATURE).NUMSECT
&Q       SETA  &Q+1                     IF NOT FINISHD,BUMP CTR & GO ON
  AIF ('&FEATURE(&Q)' EQ 'ALKYB2250').Z1 IS ALPHMERIC KEYBD SPEC'D
  AIF ('&FEATURE(&Q)' EQ 'PRGMKYBD').Z3 IS PRGRMED FNCTN KEYBD SPECFYD
 AIF (&SGDM03B(&I)).AQ  ALL OF FEATURES FOR MODEL 3
 AIF ('&FEATURE(&Q)' EQ 'LIGHTPEN').Z2  IS LIGHT PEN SPECIFIED
 AIF (&SGDM02B(&I)).AQ  ALL OF FEATURES FOR MODEL 2
 AIF ('&FEATURE(&Q)' EQ 'ABSLTVEC').Z4
  AIF ('&FEATURE(&Q)' EQ 'BUFFER4K').Z5 IS 4K-BYTE BUFFER SPECFYD
  AIF ('&FEATURE(&Q)' EQ 'BUFFER8K').Z6 IS 8K-BYTE BUFFER SPECFYD
  AIF ('&FEATURE(&Q)' EQ 'CHARGNTR').Z7 IS CHRCTR GNRTR SPECFYD
 AIF ('&FEATURE(&Q)' EQ 'OPPAN2').Z8
  AIF ('&FEATURE(&Q)' EQ 'OPPAN1').Z9   IS OP CTRL PAN 1ST SPECFYD
 AIF ('&FEATURE(&Q)' EQ 'DESIGNFEAT').ZA
.AQ MNOTE 5,'* * * IEIIOD105 &ID-FEATURE VALUE &FEATURE(&Q) INVALID'
&SGQUITB SETB  1
         AGO   .F2250M1                 GO TEST FOR END OF 2250 FEAT.S
.Z1 MNOTE *,'        ALPHAMERIC KEYBOARD '
&SGDF01B(&I) SETB 1                     SET FEAT SW 1 FOR ALPHAMRC KYBD
         AGO   .F2250M1                 GO TEST FOR END OF 2250 FEAT.S
.Z2 MNOTE *,'        LIGHT PEN '
&SGDF02B(&I) SETB 1                     SET FEAT SW 2 FOR LIGHT PEN
         AGO   .F2250M1                 GO TEST FOR END OF 2250 FEAT.S
.Z3 MNOTE *,'        PROGRAMMED FUCNTION KEYBOARD '
&SGDF03B(&I) SETB 1                     SET FEAT SW 3 FOR PRGM FNCT KYB
         AGO   .F2250M1                 GO TEST FOR END OF 2250 FEAT.S
.Z4 MNOTE *,'        ABSOLUTE VECTORS AND CONTROL '
&SGDF04B(&I) SETB 1                     SET FEAT SW 4 FOR ABSLT VEC/CTL
         AGO   .F2250M1                 GO TEST FOR END OF 2250 FEAT.S
.Z5 MNOTE *,'        4K BUFFER '
&SGDF05B(&I) SETB 1                     SET FEAT SW 5 FOR 4K-BYTE BUFER
         AIF   (&SGDF06B(&I)).AQ        IF 8K BUF SPEC THIS DV-GO ER RT
         AGO   .F2250M1                 GO TEST FOR END OF 2250 FEAT.S
.Z6 MNOTE *,'        8K BUFFER '
&SGDF06B(&I) SETB 1                     SET FEAT SW 6 FOR 8K-BYTE BUFFR
         AIF   (&SGDF05B(&I)).AQ        IF 4K BUF SPEC THIS DV-GO ER RT
         AGO   .F2250M1
.Z7 MNOTE *,'        CHARACTER GENERATOR '
&SGDF07B(&I) SETB 1                     SET FEAT SW 7 FOR CHAR GENRATOR
         AGO   .F2250M1                 GO TEST FOR END OF 2250 FEAT.S
.Z8 MNOTE *,'        OPERATOR CONTROL PANEL,FIRST AND SECOND '
&SGDF08B(&I) SETB 1                     SET FEAT SW 8 FOR OPPAN-1 & -2
         AGO   .F2250M1                 GO TEST FOR END OF 2250 FEAT.S
.Z9 MNOTE *,'        OPERATOR CONTROL PANEL ,FIRST '
&SGDF08B(&I) SETB  1
         AGO   .F2250M1                 GO TEST FOR END OF 2250 FEAT.S
.ZA MNOTE *,'      GRAPHIC DESIGN'
&SGDF09B(&I)  SETB  1
  AGO  .F2250M1
.NUMSECT AIF (T'&NUMSECT EQ 'O').CHECKX
   AIF (&SGDM01B(&I) AND &SGDU01B(&I)).I3
 AIF (T'&NUMSECT NE 'N').I4
&SGDNBFA(&I) SETA  &NUMSECT
    MNOTE *,'      NUMBER OF 256-BUFFER SECTIONS IS &NUMSECT'
 AGO  .CHECKX
.I3 MNOTE 5,'* * * IEIIOD136 &ID-NUMSECT INVALID ON 2250 MODEL 1'
&SGQUITB  SETB  1
  AGO .CHECKX
.I4 MNOTE 5,'* * * IEIIOD137 &ID-NUMSECT VALUE &NUMSECT INVALID'
&SGQUITB   SETB  1
   AGO  .CHECKX
.DS2260   ANOP
&SGDT05B(&I)  SETB  1                   SET 5TH TYPE GLBL FOR GRAPHIC
&SGDU02B(&I)  SETB  1                   SET 2ND UNIT GLBL FOR 2260 GRPH
&SGDCLSB(1)  SETB  1                    A SEQUENTIAL DEV WAS SPECD
&SGDCLSB(8)  SETB  1                    A DISPLAY TYPE DEV WAS SPECD
&SGDCLSB(10) SETB  1                    A 2260 DISPLAY STATION WAS SPEC
    MNOTE *,'     2260 DISPLAY STA. FOR ATTATCHMENT TO 2848 CNTL UNIT'
  AIF (T'&MODEL EQ 'O').WA GO TO ERROR ROUTINE IF MODEL OMITTED
  AIF (('&MODEL' EQ '1') OR ('&MODEL' EQ '2')).WB
   MNOTE 5,'* * * IEIIOD103   &ID-MODEL VALUE &MODEL INVALID'
&SGQUITB SETB 1
       AGO   .WZ
.WA MNOTE 5,'* * * IEIIOD104   &ID-MODEL VALUE NOT SPECIFIED'
&SGQUITB SETB 1
        AGO   .WZ
.WB     ANOP
&SGDM01B(&I) SETB ('&MODEL' EQ '1') IF MOD 1 SET 1ST GLOBAL SW
&SGDM02B(&I) SETB ('&MODEL' EQ '2') IF MOD 2 SET 2ND GLOBAL SW
  MNOTE *,'        MODEL &MODEL-DISPLAY STATION'
.WZ    ANOP
.TRYFEAT AIF  (T'&FEATURE EQ 'O').CHECKX
    MNOTE *,'     FEATURE '
.RELOOP  AIF (&Q EQ N'&FEATURE).CHECKX
&Q     SETA   &Q+1
  AIF  ('&FEATURE(&Q)' EQ 'ALKYB2260').W3
  AIF  ('&FEATURE(&Q)' EQ 'NMKYB2260').W4
 AIF ('&FEATURE(&Q)' EQ 'DEKYB2260').W45
&SGQUITB  SETB  1
    MNOTE 5,'* * * IEIIOD105 &ID-FEATURE VALUE &FEATURE(&Q) INVALID'
         AGO   .RELOOP
.W3 MNOTE *,'        ALPHAMERIC KEYBOARD '
&SGDF01B(&I)  SETB  1
 AIF (&SGDF02B(&I) OR &SGDF03B(&I)).W5
         AGO   .RELOOP
.W4 MNOTE *,'        NUMERIC KEYBOARD '
&SGDF02B(&I)  SETB  1
 AIF (&SGDF01B(&I) OR &SGDF03B(&I)).W5
 AGO .RELOOP
.W45 MNOTE *,'       DATA ENTRY KEYBOARD'
&SGDF03B(&I) SETB 1
 AIF (NOT(&SGDF01B(&I) OR &SGDF02B(&I))).RELOOP
.W5 MNOTE 5,'* * * IEIIOD105 &ID-FEATURE VALUE &FEATURE(&Q) INVALID'
&SGQUITB  SETB  1
         AGO   .RELOOP
.DIS1053 ANOP
&SGDT05B(&I) SETB 1                     SET 5TH TYPE GLBL FOR GRAPHIC
&SGDU03B(&I) SETB 1                     SET 3RD UNIT GLBL FOR 1053
&SGDCLSB(1) SETB 1                      A SEQUENTIAL DEV WAS SPECIFIED
&SGDCLSB(8) SETB 1                      A DISPLAY TYPE DEV WAS SPEC'D
&SGDCLSB(39)   SETB  1       SET 1053 2848  CLASS SWITCH
         MNOTE *,'     1053 PRINTER ATTACHED TO 2848 CONTROL UNIT'
   AIF (T'&MODEL EQ 'O').V3
 AIF ('&MODEL' NE '4').V4
&SGDM04B(&I) SETB ('&MODEL' EQ '4')
 AGO .CHECKX
.V3 MNOTE 5,'* * * IEIIOD104 &ID-MODEL VALUE NOT SPECIFIED'
&SGQUITB  SETB  1
   AGO  .CHECKX
.V4 MNOTE 5,'* * * IEIIOD103 &ID-MODEL VALUE &MODEL INVALID'
&SGQUITB  SETB  1
   AGO  .CHECKX
.DS2280  ANOP
&SGDT05B(&I)  SETB  1
&SGDU04B(&I)  SETB  1
&SGDCLSB(1) SETB 1
&SGDCLSB(8)   SETB   1
&SGDCLSB(45)  SETB   1
    MNOTE *,'      2280 FILM RECORDER'
    AGO  .NUMSECT
.DS2282   ANOP
&SGDT05B(&I)   SETB   1
&SGDU05B(&I)   SETB   1
&SGDCLSB(1)    SETB   1
&SGDCLSB(8)    SETB   1
&SGDCLSB(46)   SETB   1
    MNOTE *,'      2282 FILM RECORDER/SCANNER'
   AGO  .NUMSECT
.DIS3277 ANOP                           ENTER 3277 RTN
&SGDT05B(&I) SETB 1                     SET TYPE SW FOR GRAPHIC
&SGDU08B(&I) SETB 1                     SET UNIT SW FOR 3277
&SGDCLSB(1)  SETB 1                     A SEQUENTIAL CLASS DEV WAS SPEC
&SGDCLSB(8)  SETB 1                     A GRAPHIC DEV WAS SPECD
&SGDCLSB(80) SETB 1                     ANR DEVICE IN SYSTEM
    MNOTE *,'     3277 DISPLAY CONSOLE '
       AIF (T'&MODEL EQ 'O').MO3277     GO TO ERROR RTN IF NO MODEL
       AIF ('&MODEL' EQ '1').M13277     TEST FOR MODEL 1
       AIF ('&MODEL' EQ '2').M23277     TEST FOR MODEL 2
    MNOTE 5,'* * * IEIIOD103 &ID-MODEL VALUE &MODEL INVALID'
&SGQUITB SETB 1
         AGO   .FE3277
.MO3277  MNOTE 5,'* * * IEIOD104 &ID-MODEL VALUE NOT SPECIFIED'
&SGQUITB SETB 1
         AGO   .FE3277
.M13277  MNOTE *,'     MODEL 1'
&SGDM01B(&I) SETB 1                     SET MODEL SW FOR MODEL 1
         AGO   .FE3277
.M23277  MNOTE *,'     MODEL 2'
&SGDM02B(&I) SETB 1                     SET MODEL SW FOR MODEL 2
.FE3277  ANOP                           FEATURE CHECKING ROUTINE
         AIF (N'&FEATURE NE 0).F3277    FEATURES SPECIFIED,GO SCAN THEM
         AGO  .FELST                   GO TO FEATURE ROUTINE    OS73309
.F3277   MNOTE *,'     FEATURE(S)'
.FE3277A AIF (&Q EQ N'&FEATURE).FELST   TEST IF ALL FEATURES SCANNED
&Q       SETA &Q+1                      IF NOT, INCR CTR AND CONTINUE
         AIF ('&FEATURE(&Q)' EQ 'EBKY3277').FE1
         AIF ('&FEATURE(&Q)' EQ 'ASKY3277').FE2
         AIF ('&FEATURE(&Q)' EQ 'DEKY3277').FE3
         AIF ('&FEATURE(&Q)' EQ 'OCKY3277').FE4
         AIF ('&FEATURE(&Q)' EQ 'KB66KEY').FE15
         AIF ('&FEATURE(&Q)' EQ 'KB78KEY').FE5
         AIF ('&FEATURE(&Q)' EQ 'KB70KEY').FE17
         AIF ('&FEATURE(&Q)' EQ 'KB81KEY').FE18
         AIF ('&FEATURE(&Q)' EQ 'AUDALRM').FE6
         AIF ('&FEATURE(&Q)' EQ 'DOCHAR').FE16
         AIF ('&FEATURE(&Q)' EQ 'ASCACHAR').FE7
         AIF ('&FEATURE(&Q)' EQ 'ASCBCHAR').FE8
         AIF ('&FEATURE(&Q)' EQ 'UKCHAR').FE9
         AIF ('&FEATURE(&Q)' EQ 'FRCHAR').FE10
         AIF ('&FEATURE(&Q)' EQ 'GRCHAR').FE11
         AIF ('&FEATURE(&Q)' EQ 'KACHAR').FE19
         AIF ('&FEATURE(&Q)' EQ 'MAGCDRD').FE12
         AIF ('&FEATURE(&Q)' EQ 'SELPEN').FE13
         AIF ('&FEATURE(&Q)' EQ 'NUMLOCK').FE14
&SGQUITB SETB 1                         INVALID FEATURE
    MNOTE 5,'* * * IEIIOD105 &ID-FEATURE VALUE &FEATURE(&Q) INVALID '
         AGO   .FE3277A
.FE1     ANOP
&SGDF10B(&I)   SETB 1
         AGO   .FE3277A
.FE2     ANOP
&SGDF11B(&I)   SETB 1
         AGO   .FE3277A
.FE3     ANOP
&SGDF12B(&I)   SETB 1
         AGO   .FE3277A
.FE4     ANOP
&SGDF13B(&I)   SETB 1
         AGO   .FE3277A
.FE5     ANOP
&SGDF14B(&I)   SETB 1
         AGO   .FE3277A
.FE6     ANOP
&SGDF01B(&I)   SETB 1
         AGO   .FE3277A
.FE7     ANOP
&SGDF05B(&I)   SETB 1
         AGO   .FE3277A
.FE8     ANOP
&SGDF06B(&I)   SETB 1
         AGO   .FE3277A
.FE9     ANOP
&SGDF07B(&I)   SETB 1
         AGO   .FE3277A
.FE10    ANOP
&SGDF08B(&I)   SETB 1
         AGO   .FE3277A
.FE11    ANOP
&SGDF09B(&I)   SETB 1
         AGO   .FE3277A
.FE12    ANOP
&SGDF03B(&I)   SETB 1
         AGO   .FE3277A
.FE13    ANOP
&SGDF02B(&I)   SETB 1
         AGO   .FE3277A
.FE14    ANOP
&SGDF04B(&I)   SETB 1
         AGO   .FE3277A
.FE15    ANOP
&KB            SETB 1
         AGO   .FE3277A
.FE16    ANOP                           DOCHAR - CHAR GEN DEFAULT
&DOC           SETB 1
         AGO   .FE3277A
.FE17    ANOP
&KB7           SETB 1
         AGO   .FE3277A
.FE18    ANOP
&KB8           SETB 1
         AGO   .FE3277A
.FE19    ANOP
&SGDF15B(&I)   SETB 1
         AGO   .FE3277A
.FELST   ANOP                           FEATURE COMPATABILITY RTN
       AIF (&KB7).FELST70               TEST FOR 70-KEY KEYBOARD
       AIF (&SGDF14B(&I)).FELST78       TEST FOR 78-KEY KEYBOARD
       AIF (&KB8).FELST81               TEST FOR 81-KEY KEYBOARD
       AIF (&SGDF10B(&I)).FELST1        TEST FOR EBCDIC KEYBOARD
       AIF (&SGDF11B(&I)).FELST2        TEST FOR ASCII KEYBOARD
       AIF (&SGDF12B(&I)).FELST3        TEST FOR DATA ENTRY KEYBOARD
       AIF (&SGDF13B(&I)).FELST4        TEST FOR OPERATOR CONSOLE
       AIF (NOT (&KB)).NEXT             TEST FOR 66-KEY KEYBOARD
    MNOTE 5,'* * * IEIIOD165 66-KEY FEATURE INVALID WITHOUT SPECIFYING *
               KEYBOARD TYPE'
&SGQUITB SETB 1
.NEXT  AIF (&SGDF01B(&I)).FELSTA        TEST FOR AUDIBLE ALARM
.NEXTB AIF (&SGDF02B(&I)).FELSTB        TEST FOR SELECTOR PEN
.NEXTC AIF (&SGDF03B(&I)).FELSTC        TEST FOR MAGCDRD
.NEXTD AIF (&SGDF04B(&I)).FELSTD        TEST FOR NUMERIC LOCK
.NEXTE AIF (&SGDF05B(&I)).FELSTE        TEST FOR ASCII A CHAR GEN
       AIF (&SGDF06B(&I)).FELSTF        TEST FOR ASCII B CHAR GEN
       AIF (&SGDF07B(&I)).FELSTG        TEST FOR UK CHAR GEN
       AIF (&SGDF08B(&I)).FELSTH        TEST FOR FR CHAR GEN
       AIF (&SGDF09B(&I)).FELSTJ        TEST FOR GR CHAR GEN
       AIF (&DOC).FELSTM                TEST FOR DO CHAR GEN
       AIF (&SGDF15B(&I)).FELSTN        TEST FOR KA CHAR GEN
         AGO   .FELSTK
.FELST1  AIF (&SGDF11B(&I) OR &SGDF12B(&I) OR &SGDF13B(&I)).MULT
         AIF   (&SGDF15B(&I)).NONO6     KATAKANA CHAR GEN
    MNOTE *,'     66-KEY EBCDIC TYPEWRITER KEYBOARD'
         AGO   .NEXT
.FELST2  AIF (&SGDF10B(&I) OR &SGDF12B(&I) OR &SGDF13B(&I)).MULT
         AIF   (&SGDF15B(&I)).NONO6     KATAKANA CHAR GEN
    MNOTE *,'     66-KEY ASCII TYPEWRITER KEYBOARD'
         AGO   .NEXT
.FELST3  AIF (&SGDF10B(&I) OR &SGDF11B(&I) OR &SGDF13B(&I)).MULT
         AIF   (&SGDF15B(&I)).NONO6     KATAKANA CHAR GEN
    MNOTE *,'     66-KEY EBCDIC DATA ENTRY KEYBOARD'
         AGO   .NEXT
.FELST4  AIF (&SGDF10B(&I) OR &SGDF11B(&I) OR &SGDF12B(&I)).MULT S99235
&SGDF14B(&I) SETB 1                     SET FEATURE SW REQD FOR OCKY
         AIF   (&SGDF15B(&I)).NONO7     KATAKANA CHAR GEN
.FELST4A MNOTE *,'     78-KEY OPERATOR CONSOLE KEYBOARD'
         AGO   .NEXT
.MULT  MNOTE 5,'* * * IEIIOD160 MULTIPLE KEYBOARD TYPES - INVALID - ONL*
               Y ONE KEYBOARD TYPE PER 3277 ALLOWED'
&SGQUITB SETB 1
         AGO   .NEXT
.*          LINES 379351 THRU 379392 DELETED FOR S99235
.NONO6 MNOTE 5,'* * * IEIIOD190 66-KEY INVALID WITH KATAKANA CHARACTER *
               GENERATOR'
&SGQUITB SETB  1
         AGO   .NEXT
.FELST70 ANOP
       AIF (&KB OR &SGDF14B(&I) OR &KB8).MULT
       AIF (&SGDF10B(&I)).KA1           TEST FOR EBCDIC KEYBOARD
       AIF (&SGDF11B(&I)).KA2           TEST FOR ASCII KEYBOARD
       AIF (&SGDF12B(&I)).KA3           TEST FOR DATA ENTRY KEYBOARD
       AIF (&SGDF13B(&I)).KA4           TEST FOR OPERATOR CONSOLE
    MNOTE 5,'* * * IEIIOD167 70-KEY FEATURE INVALID WITHOUT SPECIFYING *
               KEYBOARD TYPE'
&SGQUITB SETB  1
         AGO   .NEXT
.KA1     AIF (&SGDF11B(&I) OR &SGDF12B(&I) OR &SGDF13B(&I)).MULT
         AGO   .KA4E
.KA2     AIF (&SGDF10B(&I) OR &SGDF12B(&I) OR &SGDF13B(&I)).MULT
         AGO   .KA4A
.KA3     AIF (&SGDF10B(&I) OR &SGDF11B(&I) OR &SGDF13B(&I)).MULT
         AIF (NOT &SGDF15B(&I)).KA6
    MNOTE *,'     70-KEY DATA ENTRY KEYBOARD'
         AGO   .NEXT
.KA4     AIF (&SGDF10B(&I) OR &SGDF11B(&I) OR &SGDF12B(&I)).MULT
         AGO   .KA4O
.KA4A    ANOP
    MNOTE 5,'* * * IEIIOD168  70-KEY FEATURE INVALID FOR ASCII TYPE KEY*
               BOARD'
&SGQUITB SETB  1
         AGO   .NEXT
.KA4E    ANOP
    MNOTE 5,'* * * IEIIOD168  70-KEY FEATURE INVALID FOR EBCDIC TYPE KE*
               YBOARD'
&SGQUITB SETB  1
         AGO   .NEXT
.KA4O    ANOP
    MNOTE 5,'* * * IEIIOD168  70-KEY FEATURE INVALID FOR OPERATOR CONSO*
               LE TYPE KEYBOARD'
&SGQUITB SETB  1
         AGO   .NEXT
.KA6 MNOTE 5,'* * * IEIIOD169 70-KEY DATA ENTRY KEYBOARD IS VALID ONLY *
               IF KACHAR HAS BEEN SPECIFIED'
&SGQUITB SETB  1
         AGO   .NEXT
.FELST78 ANOP
       AIF (&KB OR &KB7 OR &KB8).MULT
       AIF (&SGDF10B(&I)).FELST5        TEST FOR EBCDIC KEYBOARD
       AIF (&SGDF11B(&I)).FELST6        TEST FOR ASCII KEYBOARD
       AIF (&SGDF12B(&I)).FELST7        TEST FOR DATA ENTRY KEYBOARD
       AIF (&SGDF13B(&I)).FELST8        TEST FOR OPERATOR CONSOLE
    MNOTE 5,'* * * IEIIOD161 78-KEY FEATURE INVALID WITHOUT SPECIFYING *
               KEYBOARD TYPE'
&SGQUITB SETB  1
         AGO   .NEXT
.FELST5  AIF (&SGDF11B(&I) OR &SGDF12B(&I) OR &SGDF13B(&I)).MULT
         AIF   (&SGDF15B(&I)).NONO7     KATAKANA CHAR GEN
    MNOTE *,'     78-KEY EBCDIC TYPEWRITER KEYBOARD'
         AGO   .NEXT
.FELST6  AIF (&SGDF10B(&I) OR &SGDF12B(&I) OR &SGDF13B(&I)).MULT
         AIF   (&SGDF15B(&I)).NONO7     KATAKANA CHAR GEN
    MNOTE *,'     78-KEY ASCII TYPEWRITER KEYBOARD'
         AGO   .NEXT
.FELST7  AIF (&SGDF10B(&I) OR &SGDF11B(&I) OR &SGDF13B(&I)).MULT
    MNOTE 5,'* * * IEIIOD162  78-KEY FEATURE IS INVALID FOR DATA ENTRY *
               TYPE KEYBOARD '
&SGQUITB  SETB 1
         AGO   .NEXT
.FELST8  AIF (&SGDF10B(&I) OR &SGDF11B(&I) OR &SGDF12B(&I)).MULT
         AIF   (&SGDF15B(&I)).NONO7     KATAKANA CHAR GEN
         AGO   .FELST4A
.NONO7 MNOTE 5,'* * * IEIIOD191 78-KEY INVALID WITH KATAKANA CHARACTER *
               GENERATOR'
&SGQUITB SETB  1
         AGO   .NEXT
.FELST81 ANOP
       AIF (&KB OR &KB7 OR &SGDF14B(&I)).MULT
       AIF (&SGDF10B(&I)).KA7           TEST FOR EBCDIC KEYBOARD
       AIF (&SGDF11B(&I)).KA8           TEST FOR ASCII KEYBOARD
       AIF (&SGDF12B(&I)).KA9           TEST FOR DATA ENTRY KEYBOARD
       AIF (&SGDF13B(&I)).KAA           TEST FOR OPERATOR CONSOLE
    MNOTE 5,'* * * IEIIOD170  81-KEY FEATURE INVALID WITHOUT SPECIFYING*
                KEYBOARD TYPE'
&SGQUITB SETB  1
         AGO   .NEXT
.KA7     AIF (&SGDF11B(&I) OR &SGDF12B(&I) OR &SGDF13B(&I)).MULT
         AIF (NOT &SGDF15B(&I)).KAC
    MNOTE *,'     81-KEY EBCDIC TYPEWRITER KEYBOARD'
&KB8           SETB 0
&SGDF14B(&I)   SETB 1
         AGO   .NEXT
.KA8     AIF (&SGDF10B(&I) OR &SGDF12B(&I) OR &SGDF13B(&I)).MULT
         AGO   .KAAS
.KA9     AIF (&SGDF10B(&I) OR &SGDF11B(&I) OR &SGDF13B(&I)).MULT
         AGO   .KADE
.KAA     AIF (&SGDF10B(&I) OR &SGDF11B(&I) OR &SGDF12B(&I)).MULT
         AGO   .KAOC
.KAAS    ANOP
    MNOTE 5,'* * * IEIIOD171  81-KEY FEATURE INVALID FOR ASCII TYPE KEY*
               BOARD'
&SGQUITB SETB  1
         AGO   .NEXT
.KADE    ANOP
    MNOTE 5,'* * * IEIIOD171  81-KEY FEATURE INVALID FOR DATA ENTRY TYP*
               E KEYBOARD'
&SGQUITB SETB  1
         AGO   .NEXT
.KAOC    ANOP
    MNOTE 5,'* * * IEIIOD171  81-KEY FEATURE INVALID FOR OPERATOR CONSO*
               LE TYPE KEYBOARD'
&SGQUITB SETB  1
         AGO   .NEXT
.KAC MNOTE 5,'* * * IEIIOD172  81-KEY EBCDIC KEYBOARD IS VALID ONLY IF *
               KACHAR HAS BEEN SPECIFIED'
&SGQUITB SETB  1
         AGO   .NEXT
.FELSTA  AIF (NOT(&SGDF10B(&I) OR &SGDF11B(&I) OR &SGDF12B(&I) OR      *
               &SGDF13B(&I))).ERAUD
    MNOTE *,'     AUDIBLE ALARM'
         AGO   .NEXTB
.ERAUD MNOTE 5,'* * * IEIIOD163 AUDIBLE ALARM FEATURE INVALID WITHOUT  *
               KEYBOARD TYPE FEATURE '
&SGQUITB SETB  1
         AGO   .NEXTB
.FELSTB  MNOTE *,'     SELECTOR PEN'
         AGO   .NEXTC
.FELSTC  MNOTE *,'     MAGNETIC CARD READER ADAPTER'
         AGO   .NEXTD
.FELSTD  MNOTE *,'     NUMERIC LOCK'
         AGO   .NEXTE
.FELSTE  AIF (&SGDF06B(&I) OR &SGDF07B(&I) OR &SGDF08B(&I) OR          *
               &SGDF09B(&I) OR &SGDF15B(&I) OR &DOC).DUP
    MNOTE *,'     ASCII A CHARACTER GENERATOR'
         AGO   .CHECKX                  GO TO ADDR RTN
.FELSTF  AIF (&SGDF05B(&I) OR &SGDF07B(&I) OR &SGDF08B(&I) OR          *
               &SGDF09B(&I) OR &SGDF15B(&I) OR &DOC).DUP
    MNOTE *,'     ASCII B CHARACTER GENERATOR'
         AGO   .CHECKX
.FELSTG  AIF (&SGDF05B(&I) OR &SGDF06B(&I) OR &SGDF08B(&I) OR          *
               &SGDF09B(&I) OR &SGDF15B(&I) OR &DOC).DUP
    MNOTE *,'     UNITED KINGDOM CHARACTER GENERATOR'
         AGO   .CHECKX
.FELSTH  AIF (&SGDF05B(&I) OR &SGDF06B(&I) OR &SGDF07B(&I) OR          *
               &SGDF09B(&I) OR &SGDF15B(&I) OR &DOC).DUP
    MNOTE *,'     FRENCH CHARACTER GENERATOR'
         AGO   .CHECKX
.FELSTJ  AIF (&SGDF05B(&I) OR &SGDF06B(&I) OR &SGDF07B(&I) OR          *
               &SGDF08B(&I) OR &SGDF15B(&I) OR &DOC).DUP
    MNOTE *,'     GERMAN CHARACTER GENERATOR'
         AGO   .CHECKX
.FELSTK  AIF (&SGDF10B(&I) OR &SGDF11B(&I) OR &SGDF12B(&I) OR          *
               &SGDF13B(&I)).FELSTL
         AGO   .CHECKX
.FELSTL  AIF (&SGDF15B(&I)).FELSTL1
         AIF (&SGDF05B(&I) OR &SGDF06B(&I) OR &SGDF07B(&I) OR          *
               &SGDF08B(&I) OR &SGDF09B(&I)).CHECKX
         AIF (&KB7 OR &KB8 OR &SGDF14B(&I)).CHECKX    70/81 KEY KB
    MNOTE 0,'* * * IEIIODW61 NO CHARACTER GENERATOR SPECIFIED WITH KEYB*
               OARD - DOMESTIC ASSUMED'
         AGO   .CHECKX
.FELSTL1 AIF (NOT (&SGDF10B(&I) OR &SGDF12B(&I))).FELSTL2
         AIF (NOT (&KB7 OR &SGDF14B(&I))).FELSTO
         AGO   .CHECKX
.FELSTL2 ANOP
    MNOTE 5,'* * * IEIIOD174  KACHAR FEATURE INVALID WITHOUT EBKY3277 O*
               R DEKY3277 FEATURE'
&SGQUITB SETB  1
         AGO   .CHECKX
.FELSTM  AIF (&SGDF05B(&I) OR &SGDF06B(&I) OR &SGDF07B(&I) OR          *
               &SGDF08B(&I) OR &SGDF09B(&I) OR &SGDF15B(&I)).DUP
    MNOTE *,'     DOMESTIC CHARACTER GENERATOR'
         AGO   .CHECKX
.FELSTN  AIF (&SGDF05B(&I) OR &SGDF06B(&I) OR &SGDF07B(&I) OR          *
               &SGDF08B(&I) OR &SGDF09B(&I) OR &DOC).DUP
    MNOTE *,'     KATAKANA CHARACTER GENERATOR'
         AGO   .CHECKX
.FELSTO  ANOP
    MNOTE 5,'* * * IEIIOD173  KACHAR FEATURE INVALID WITHOUT KB70KEY OR*
               KB81KEY FEATURE'
&SGQUITB SETB  1
         AGO   .CHECKX
.DUP MNOTE 5,'* * * IEIIOD164 MULTIPLE CHARACTER GENERATORS - INVALID  *
               ONLY ONE CHARACTER GENERATOR PER &UNIT ALLOWED '  S99235
&SGQUITB SETB  1
         AGO   .CHECKX
.PRT1403 ANOP                           P R I N T E R  R O U T I N E S
&SGDT06B(&I) SETB 1                     SET TYPE SWT FOR PRINTERS
&SGDU01B(&I) SETB 1                     SET UNIT SWT FOR 1403
&SGDCLSB(1)  SETB 1                     A SEQUENTIAL CLASS DEV WAS SPEC
&SGDCLSB(11) SETB 1                     A UNIT-RECORD DEV WAS SPECD
&SGDCLSB(22) SETB 1                     A PRINTER WAS SPECD
&SGDCLSB(23) SETB 1                     A 1403 PRINTER WAS SPECD
    MNOTE *,'     1403 PRINTER '
         AIF   (T'&MODEL EQ 'O').AS
         AIF ('&MODEL' EQ 'N1').N1      IF MODEL SPECFYD,IS IT EQ N1
         AIF ('&MODEL' EQ '2').N2       IS MODEL EQ 2
         AIF ('&MODEL' EQ '3').N3       IS MODEL EQ 3
         AIF ('&MODEL' EQ '7').N4       IS MODEL EQ 7
    MNOTE 5,'* * * IEIIOD103 &ID-MODEL VALUE &MODEL INVALID'
&SGQUITB SETB  1
         AGO   .FEATEST
.AS MNOTE 5,'* * * IEIIOD104 &ID-MODEL VALUE NOT SPECIFIED'
&SGQUITB SETB  1                        MOD=INVLD/OMIT-TURN ON ERROR SW
         AGO   .FEATEST                 MOD BAD-GO RTN MOD DEPEND FEAT
.N1 MNOTE *,'     MODEL N1 '
&SGDM01B(&I) SETB 1                     SET 1ST MODEL SWT FOR MODEL 1
         AGO   .COMNFET                 GO TO FEAT RTN FOR MOD N1,2,& 3
.N2 MNOTE *,'     MODEL 2 '
&SGDM02B(&I) SETB 1                     SET 2ND MODEL SWT FOR MODEL 2
         AGO   .COMNFET                 GO TO FEAT RTN FOR MOD N1,2,& 3
.N3 MNOTE *,'     MODEL 3 '
&SGDM03B(&I) SETB 1                     SET 3RD MODEL SWT FOR MODEL 3
.COMNFET AIF (N'&FEATURE EQ 0).CHECKX   BR ADRS RTN IF NO FEAT,OR GO ON
    MNOTE *,'     FEATURE(S) '
.FMOD123 AIF (&Q EQ N'&FEATURE).CHECKX  DID SCAN ALL MOD N1,2,&3 FEAT.S
&Q       SETA  &Q+1                     IF NOT DONE,BUMP CTR AND GO ON.
 AIF ('&FEATURE(&Q)' EQ 'TAPELIST').N5  IS SELECTIVE TAPE LISTING SPECD
 AIF ('&FEATURE(&Q)' EQ 'UNVCHSET').N6  IS UNIV CHAR SET SPEC'D
&SGQUITB SETB  1                        FEATURE INVLD-TURN ON ERROR SWT
    MNOTE 5,'* * * IEIIOD105 &ID-FEATURE VALUE &FEATURE(&Q) INVALID'
         AGO   .FMOD123                 GO TEST REST OF MOD N1,2,&3 FET
.N5 MNOTE *,'        SELECTIVE TAPE LISTING '
&SGDF01B(&I) SETB 1                     SET 1ST FEAT SWT FOR SEL TP LST
         AGO   .FMOD123                 GO TEST REST OF MOD N1,2,&3 FET
.N6 MNOTE *,'        UNIVERSAL CHARACTER SET '
&SGDF02B(&I) SETB 1                     SET 2ND FEAT SWT FOR UNV CH SET
&SGDCLSB(55)  SETB  1                   SET UNVCHSET FEATURE SWITCH
         AGO   .FMOD123                 GO TEST REST OF MOD N1,2,&3 FET
.N4 MNOTE *,'     MODEL 7 '
&SGDM04B(&I) SETB 1                     SET 4TH MODEL SWT FOR MODEL 7
         AGO   .CHECKX                  GO TO RTN FOR CHECKING HEX ADRS
.PRT1404 ANOP
&SGDT06B(&I) SETB 1                     SET TYPE SW FOR PRINTER
&SGDU02B(&I) SETB 1                     SET UNIT SW FOR 1404
&SGDCLSB(1)  SETB 1                     A SEQUENTIAL CLASS DEV WAS SPEC
&SGDCLSB(11) SETB 1                     A UNIT-RECORD DEV WAS SPECD
&SGDCLSB(22) SETB 1                     A PRINTER WAS SPECD
&SGDCLSB(24) SETB 1                     A 1404 BAR PRINTER WAS SPECD
    MNOTE *,'     1404 PRINTER '
         AIF   (T'&MODEL EQ 'O').O1     GO TO ERROR RTN IF MODEL OMITTD
         AIF   ('&MODEL' EQ '2').O2
    MNOTE 5,'* * * IEIIOD103 &ID-MODEL VALUE &MODEL INVALID'
&SGQUITB SETB  1
         AGO   .FEATLST
.O1 MNOTE 5,'* * * IEIIOD104 &ID-MODEL VALUE NOT SPECIFIED'
&SGQUITB SETB  1                        MOD=INVLD/OMIT-TURN ON ERROR SW
         AGO   .FEATLST                 GO TO 1404 FEATURE TEST
.O2 MNOTE *,'     MODEL 2 '
&SGDM02B(&I) SETB 1
.FEATLST AGO   .CHECKX
&SGQUITB SETB  1
    MNOTE 5,'* * * IEIIOD107 &ID-OPTIONAL FEATURES NOT ALLOWED FOR &C'
         AGO   .CHECKX
.PRT1443 ANOP                           ENTER 1443 RTN
&SGDT06B(&I) SETB 1                     SET TYPE SWT FOR PRINTERS
&SGDU03B(&I) SETB 1                     SET UNIT SWT FOR 1443
&SGDCLSB(1)  SETB 1                     A SEQUENTIAL CLASS DEV WAS SPEC
&SGDCLSB(11) SETB 1                     A UNIT-RECORD DEV WAS SPECD
&SGDCLSB(22) SETB 1                     A PRINTER WAS SPECD
&SGDCLSB(25) SETB 1                     A 1443 PRINTER WAS SPECD
    MNOTE *,'     1443 PRINTER '
         AIF   (T'&MODEL EQ 'O').AT     GO TO ERROR RTN IF MODEL OMITED
         AIF ('&MODEL' EQ 'N1').P1      IF MODEL SPECFYD,IS IT EQ N1
    MNOTE 5,'* * * IEIIOD103 &ID-MODEL VALUE &MODEL INVALID'
&SGQUITB SETB  1
         AGO   .PRTFEAT
.AT MNOTE 5,'* * * IEIIOD104 &ID-MODEL VALUE NOT SPECIFIED'
&SGQUITB SETB  1                        MOD=INVLD/OMIT-TURN ON ERROR SW
         AGO   .PRTFEAT                 GO TO 1443 FEATURE ROUTINE
.P1 MNOTE *,'     MODEL N1 '
&SGDM01B(&I) SETB 1                     SET 1ST MODEL SWT FOR MODEL N1
.PRTFEAT AIF  (N'&FEATURE EQ 0).TRMDCHK BR TRNMODE TEST IF NO FEAT SPEC
    MNOTE *,'     FEATURE(S) '
.F1443M1 AIF (&Q EQ N'&FEATURE).TRMDCHK IF ALL FEAT SCND,GO TRNMDE TEST
&Q       SETA  &Q+1                     IF NO,BUMP CTR AND CON'T SCAN
 AIF ('&FEATURE(&Q)' EQ '24ADDPOS').P2  IS 24ADDPOS  FEATURE SPECD
 AIF ('&FEATURE(&Q)' EQ 'SELCHSET').P3  IS SELECTIVE CHAR SET SPEC'D
&SGQUITB SETB  1                        FEATURE INVLD-TURN ON ERROR SWT
    MNOTE 5,'* * * IEIIOD105 &ID-FEATURE VALUE &FEATURE(&Q) INVALID'
         AGO   .F1443M1                 GO TEST FOR END OF 1443 FEAT.S
.P2 MNOTE *,'        24 ADDITIONAL PRINT POSITIONS '
&SGDF01B(&I) SETB 1                     SET 1ST FEAT SWT FOR 24ADDPOS
         AGO   .F1443M1                 GO TEST FOR END OF 1443 FEAT.S
.P3 MNOTE *,'        SELECTIVE CHARACTER SET '
&SGDF02B(&I) SETB 1                     SET 2ND FEAT SWT FOR SEL CH SET
         AGO   .F1443M1                 GO TEST FOR END OF 1443 FEAT.S
.PRT2245 ANOP                           ENTER 2245 RTN
&SGDT06B(&I) SETB 1                     SET TYPE SWT FOR PRINTERS
&SGDU07B(&I) SETB 1                     SET UNIT SWT FOR 2245
&SGDCLSB(1)  SETB 1                     A SEQUENTIAL CLASS DEV WAS SPEC
&SGDCLSB(11) SETB 1                     A UNIT-RECORD DEV WAS SPECD
&SGDCLSB(22) SETB 1                     A PRINTER WAS SPECD
&SGDCLSB(74) SETB 1                     A 2245 PRINTER WAS SPECD
    MNOTE *,'     2245 PRINTER'
       AIF (T'&MODEL NE 'O').KJ1        GO TO ERROR RTN IF MODEL SPECD
       AIF (T'&FEATURE NE 'O').KJ2      GO TO ERROR RTN IF FEATURE SPEC
       AGO .CHECKX
.KJ1 MNOTE 5,'* * * IEIIOD200 MODEL VALUE SPECIFIED - INVALID; THERE ARX
               E NO MODEL NUMBERS'
&SGQUITB  SETB 1
       AGO .CHECKX
.KJ2 MNOTE 5,'* * * IEIIOD201 FEATURE(S) SPECIFIED - INVALID; THERE AREX
               NO SPECIAL OR OPTIONAL FEATURES'
&SGQUITB  SETB 1
       AGO .CHECKX
.PRT3284 ANOP                           ENTER 3284 RTN
&SGDT05B(&I) SETB 1                     SET TYPE SW FOR 3284
&SGDU09B(&I) SETB 1                     SET UNIT SW FOR 3284
&SGDCLSB(1) SETB 1                      A SEQUENTIAL CLASS DEV WAS SPEC
&SGDCLSB(11) SETB 1                     A UNIT-RECORD DEV WAS SPECD
&SGDCLSB(22) SETB 1                     A PRINTER WAS SPECD
&SGDCLSB(80) SETB 1                     ANR DEVICE WAS SPECD
    MNOTE *,'     3284 PRINTER '
.ANRPTR  AIF (T'&MODEL EQ 'O').MOPTR    TEST FOR MODEL NUMBER
         AIF ('&MODEL' EQ '1').M1PTR    TEST FOR MODEL 1
         AIF ('&MODEL' EQ '2').M2PTR    TEST FOR MODEL 2
    MNOTE 5,'* * * IEIIOD103 &ID-MODEL VALUE &MODEL INVALID '
&SGQUITB SETB 1
         AGO   .CHRGEN                  TEST FOR FEATURES
.MOPTR MNOTE 5,'* * * IEIIOD104 &ID-MODEL VALUE NOT SPECIFIED '
&SGQUITB SETB 1
         AGO   .CHRGEN                  TEST FOR FEATURES
.M1PTR  MNOTE *,'     MODEL 1 '
&SGDM01B(&I) SETB 1                     SET MODEL 1 SW
         AGO   .CHRGEN                  TEST FOR FEATURES
.M2PTR  MNOTE *,'     MODEL 2 '
&SGDM02B(&I) SETB 1                     SET MODEL 2 SW
.CHRGEN  ANOP                           FEATURE CHECKING ROUTINE
         AIF (N'&FEATURE EQ 0).CHRLST
    MNOTE *,'     FEATURE(S)'
.CHRGENL AIF (&Q EQ N'&FEATURE).CHRLST
&Q       SETA  &Q+1
         AIF ('&FEATURE(&Q)' EQ 'UKCHAR').FEAT1
         AIF ('&FEATURE(&Q)' EQ 'FRCHAR').FEAT2
         AIF ('&FEATURE(&Q)' EQ 'GRCHAR').FEAT3
         AIF ('&FEATURE(&Q)' EQ 'KACHAR').FEAT4
         AIF ('&FEATURE(&Q)' EQ 'DOCHAR').FEAT5
    MNOTE 5,'* * * IEIIOD105 &ID-FEATURE VALUE &FEATURE(&Q) INVALID'
&SGQUITB SETB  1
         AGO   .CHRLST6
.FEAT1   ANOP
&SGDF07B(&I)   SETB 1
         AGO   .CHRGENL
.FEAT2   ANOP
&SGDF08B(&I)   SETB 1
         AGO   .CHRGENL
.FEAT3   ANOP
&SGDF09B(&I)   SETB 1
         AGO   .CHRGENL
.FEAT4   ANOP
&SGDF15B(&I)   SETB 1
         AGO   .CHRGENL
.FEAT5   ANOP
&DOC           SETB 1
         AGO   .CHRGENL
.CHRLST  ANOP                           FEATURE COMPATABILITY RTN
         AIF (&SGDF07B(&I)).CHRLST1     TEST FOR UK CHAR GEN
         AIF (&SGDF08B(&I)).CHRLST2     TEST FOR FR CHAR GEN
         AIF (&SGDF09B(&I)).CHRLST3     TEST FOR GR CHAR GEN
         AIF (&SGDF15B(&I)).CHRLST4     TEST FOR KA CHAR GEN
         AIF (&DOC).CHRLST5             TEST FOR DO CHAR GEN
         AGO   .CHRLST6
.CHRLST1 AIF (&SGDF08B(&I) OR &SGDF09B(&I) OR &SGDF15B(&I) OR &DOC).MCG
    MNOTE *,'     UNITED KINGDOM CHARACTER GENERATOR'
         AGO   .CHECKX
.CHRLST2 AIF (&SGDF07B(&I) OR &SGDF09B(&I) OR &SGDF15B(&I) OR &DOC).MCG
    MNOTE *,'     FRENCH CHARACTER GENERATOR'
         AGO   .CHECKX
.CHRLST3 AIF (&SGDF07B(&I) OR &SGDF08B(&I) OR &SGDF15B(&I) OR &DOC).MCG
    MNOTE *,'     GERMAN CHARACTER GENERATOR'
         AGO   .CHECKX
.CHRLST4 AIF (&SGDF07B(&I) OR &SGDF08B(&I) OR &SGDF09B(&I) OR &DOC).MCG
    MNOTE *,'     KATAKANA CHARACTER GENERATOR'
         AGO   .CHECKX
.CHRLST5 AIF (&SGDF07B(&I) OR &SGDF08B(&I) OR &SGDF09B(&I) OR          *
               &SGDF15B(&I)).MCG
    MNOTE *,'     DOMESTIC CHARACTER GENERATOR'
         AGO   .CHECKX
.CHRLST6 ANOP
    MNOTE 0,'* * * IEIIODW62 NO CHARACTER GENERATOR SPECIFIED WITH PRIN*
               TER - DOMESTIC ASSUMED'
         AGO   .CHECKX
.MCG MNOTE 5,'* * * IEIIOD180 MULTIPLE CHARACTER GENERATORS - INVALID  *
               ONLY ONE CHARACTER GENERATOR PER 3284/3286 ALLOWED'
&SGQUITB SETB  1
         AGO   .CHECKX
.PRT3286 ANOP                           ENTER 3286 RTN
&SGDT05B(&I) SETB 1                     SET TYPE SW FOR 3286
&SGDU07B(&I) SETB 1                     SET UNIT SW FOR 3286
&SGDCLSB(1) SETB 1                      A SEQUENTIAL CLASS DEV WAS SPEC
&SGDCLSB(11) SETB 1                     A UNIT-RECORD DEV WAS SPECD
&SGDCLSB(22) SETB 1                     A PRINTER WAS SPECD
&SGDCLSB(80) SETB 1                     ANR DEVICE WAS SPECD
    MNOTE *,'     3286 PRINTER '
         AGO   .ANRPTR
.PRT3211 ANOP                           ENTER 3211 RTN
&SGDT06B(&I) SETB 1                     SET TYPE SWT FOR PRINTERS
&SGDU06B(&I) SETB 1                     SET UNIT SWT FOR 3211
&SGDCLSB(1)  SETB 1                     A SEQUENTIAL CLASS DEV WAS SPEC
&SGDCLSB(11) SETB 1                     A UNIT-RECORD DEV WAS SPECD
&SGDCLSB(22) SETB 1                     A PRINTER WAS SPECD
&SGDCLSB(71) SETB 1                     A 3211 PRINTER WAS SPECD
    MNOTE *,'     3211 PRINTER'
         AGO   .CHECKX
.CRP1442 ANOP                           C A R D  R D R -P N H  R T N S
&SGDT07B(&I) SETB 1
&SGDU01B(&I) SETB 1
&SGDCLSB(1)    SETB  1                  A SEQUENTIAL CLASS DEV WAS SPEC
&SGDCLSB(11)  SETB 1                    A UNIT-RECORD DEC WAS SPECD
&SGDCLSB(12)  SETB 1                    A READER-PUNCH DEC WAS SPECD
    MNOTE *,'     1442 CARD DEVICE '
         AIF  (T'&MODEL EQ 'O').M4      IF MOD VALUE OMITTED GO ERR RTN
 AIF (('&MODEL' NE 'N1')AND('&MODEL' NE 'N2')).AU 1442 FNCT MOD. DEPNDT
&SGDM01B(&I) SETB ('&MODEL' EQ 'N1')    MODEL N1 GLOBAL SWT
&SGDM02B(&I) SETB ('&MODEL' EQ 'N2')    MODEL N2 GLOBAL SWT
         AIF (&SGDM02B(&I)).M2          IF MOD 2 SKIP OTHERWISE SET SW
    MNOTE *,'     MODEL N1-CARD READER PUNCH '
&SGDCLSB(14) SETB  1                    A 1442 CARD RDR PNCH WAS SPECD
         AGO   .SAMEFET                 GO TO OPT'L FEAT TEST
.M2 MNOTE *,'     MODEL N2-CARD PUNCH '
&SGDCLSB(15)  SETB  1                   A 1442 CARD PUNCH WAS SPECD
         AGO   .SAMEFET                 GO TO OPT'L FEAT TEST
.AU MNOTE 5,'* * * IEIIOD103 &ID-MODEL VALUE &MODEL INVALID'
&SGQUITB SETB  1
         AGO   .SAMEFET
.M4 MNOTE 5,'* * * IEIIOD104 &ID-MODEL VALUE NOT SPECIFIED'
&SGQUITB  SETB  1                       MODEL VALUE MUST IMPLY DEV FNCT
.SAMEFET AIF   (N'&FEATURE EQ 0).CHECKX
    MNOTE *,'     FEATURE '
.F144212 AIF   (&Q EQ N'&FEATURE).CHECKX
&Q       SETA  &Q+1
         AIF   ('&FEATURE(&Q)' EQ 'CARDIMAGE').S1
&SGQUITB SETB  1
    MNOTE 5,'* * * IEIIOD105 &ID-FEATURE VALUE &FEATURE(&Q) INVALID'
         AGO   .F144212
.S1 MNOTE *,'        CARD IMAGE '
&SGDF01B(&I) SETB 1
         AGO   .F144212
.CHKRDR  ANOP
&CHKSW  SETB  1
&SGDT06B(&I) SETB 1
&SGDCLSB(11) SETB 1   SET SWITCHES COMMON TO BOTH CHK RDRS
   AIF  ('&UNIT' EQ '1275').CHK1275
&SGDU04B(&I) SETB 1
&SGDCLSB(65) SETB 1
   MNOTE *,'      1419 MAGNETIC CHECK READER'
   AGO  .TRMDCHK
.CHK1275  ANOP
&SGDU05B(&I)  SETB  1
&SGDCLSB(66)  SETB  1
    MNOTE *,'      1275 OPTICAL CHECK READER'
    AGO   .TRMDCHK
.CR2501  ANOP
&SGDT07B(&I) SETB 1
&SGDU02B(&I) SETB 1
&SGDCLSB(1)  SETB 1                     A SEQUENTIAL CLASS DEV WAS SPEC
&SGDCLSB(11) SETB 1                     A UNIT-RECORD DEV WAS SPECD
&SGDCLSB(12) SETB 1                     A READER-PUNCH DEV WAS SPECD
&SGDCLSB(16) SETB 1                     A 2501 CARD READER WAS SPECD
    MNOTE *,'     2501 CARD READER '
         AIF   (T'&MODEL EQ 'O').AV     IF MOD VALUE OMITTED GO ERR RTN
         AIF   ('&MODEL' EQ 'B1').T1
         AIF   ('&MODEL' EQ 'B2').T2
    MNOTE 5,'* * * IEIIOD103 &ID-MODEL VALUE &MODEL INVALID'
&SGQUITB SETB  1
         AGO   .SCANFET
.AV MNOTE 5,'* * * IEIIOD104 &ID-MODEL VALUE NOT SPECIFIED'
&SGQUITB SETB  1
         AGO   .SCANFET
.T1 MNOTE *,'     MODEL B1 '
&SGDM01B(&I) SETB 1
         AGO   .SCANFET
.T2 MNOTE *,'     MODEL B2 '
&SGDM02B(&I) SETB 1
.SCANFET AIF   (N'&FEATURE EQ 0).CHECKX
    MNOTE *,'     FEATURE  '
.F250112 AIF   (&Q EQ N'&FEATURE).CHECKX
&Q       SETA  &Q+1
         AIF   ('&FEATURE(&Q)' EQ 'CARDIMAGE').T3
&SGQUITB SETB  1
    MNOTE 5,'* * * IEIIOD105 &ID-FEATURE VALUE &FEATURE(&Q) INVALID'
         AGO   .F250112
.T3 MNOTE *,'        CARD IMAGE '
&SGDF01B(&I) SETB 1
         AGO   .F250112
.CRP2520 ANOP
&SGDT07B(&I) SETB 1
&SGDU03B(&I) SETB 1
&SGDCLSB(1)  SETB  1                    A SEQUENTIAL CLASS DEV WAS SPEC
&SGDCLSB(11)  SETB  1                   A UNIT-RECORD DEV WAS SPECD
&SGDCLSB(12)  SETB  1                   A READER-PUNCH DEC WAS SPECD
    MNOTE *,'     2520 CARD DEVICE '
         AIF   (T'&MODEL EQ 'O').M5     IF MOD VALUE OMITTED GO ERR RTN
 AIF (('&MODEL' NE 'B1')AND('&MODEL' NE 'B2')AND('&MODEL' NE 'B3')).AW
&SGDM01B(&I) SETB ('&MODEL' EQ 'B1')    IF MOD B1 SET 1ST GLOBAL SW
&SGDM02B(&I) SETB ('&MODEL' EQ 'B2')    IF MOD B2 SET 2ND GLOBAL SW
&SGDM03B(&I) SETB ('&MODEL' EQ 'B3')    IF MOD B3 SET 3RD GLOBAL SW
         AIF   (NOT &SGDM01B(&I)).M3    IF MOD B2/B3 GO THEIR RTN.S
    MNOTE *,'     MODEL B1-CARD READER PUNCH '
&SGDCLSB(17)  SETB  1                   A 2520 CARD RDR/PNH WAS SPECD
         AGO   .FEATRTN                 BR TO TEST FOR OPT'L FEAT SPECD
.M3 MNOTE *,'     MODEL &MODEL-CARD PUNCH '
&SGDCLSB(18)  SETB  1                   A 2520 CARD PNCH WAS SPECD
         AGO   .FEATRTN                 BR TO OPT'L FEAT TEST
.AW MNOTE 5,'* * * IEIIOD103 &ID-MODEL VALUE &MODEL INVALID'
&SGQUITB SETB  1
         AGO   .FEATRTN
.M5 MNOTE 5,'* * * IEIIOD104 &ID-MODEL VALUE NOT SPECIFIED'
&SGQUITB SETB 1                         MODEL VALUE MUST IMPLY DEV FNCT
.FEATRTN AIF   (N'&FEATURE EQ 0).TRMDCHK
    MNOTE *,'     FEATURE '
.F2520   AIF   (&Q EQ N'&FEATURE).TRMDCHK
&Q       SETA  &Q+1
         AIF   ('&FEATURE(&Q)' EQ 'CARDIMAGE').H1
&SGQUITB SETB  1
    MNOTE 5,'* * * IEIIOD105 &ID-FEATURE VALUE &FEATURE(&Q) INVALID'
         AGO   .F2520
.H1 MNOTE *,'        CARD IMAGE '
&SGDF01B(&I) SETB 1
         AGO   .F2520
.CR2540  ANOP                           ENTER 2540 CARD READER RTN
&SGDU04B(&I) SETB  1                    4TH DEV GLOBAL SW FOR 2540 RDR.
&SGDCLSB(19)  SETB  1                   A 2540 CARD READER SPECIFIED
    MNOTE *,'     2540 CARD READER '
         AGO   .TYPCLAS                 GO SET TYPE AND CLASS SW.S
.CP2540   ANOP                          ENTER 2540 CARD PUNCH DEVICE
&SGDU05B(&I)  SETB  1                   5TH DEV GLOBAL SW FOR 2540 PNCH
&SGDCLSB(20)  SETB  1                   A 2540 CARD PUNCH SPECIFIED
    MNOTE *,'     2540 CARD PUNCH  '
         AGO   .TYPCLAS
.CR3505  ANOP                           ENTER 3505 CARD READER RTN
&SG3505A SETA  &SG3505A+1               COUNT OF 3505 READERS
&SGDU08B(&I)  SETB  1                   8TH DEV GLOBAL SW FOR 3505 RDR
&SGDCLSB(78)  SETB  1                   A 3505 CARD READER SPECIFIED
    MNOTE *,'     3505 CARD READER '
         AGO   .TYPCLAS
.CP3525  ANOP                           ENTER 3525 CARD PUNCH RTN
&SG3525A SETA  &SG3525A+1               COUNT OF 3525 PUNCHES
&SGDU09B(&I)  SETB  1                   9TH DEV GLOBAL SW FOR 3525 PCH
&SGDCLSB(79)  SETB  1                   A 3525 CARD PUNCH SPECIFIED
    MNOTE *,'     3525 CARD PUNCH  '    A 3525 CARD PUNCH SPECIFIED
.TYPCLAS ANOP                           TYPE & CLASS SW-SETTING RTN
&SGDT07B(&I)  SETB  1                   7TH TYPE GLOBAL FOR RDR-PNCHS
&SGDCLSB(1)  SETB 1                     A SEQUENTIAL DEV WAS SPECD
&SGDCLSB(11) SETB  1                    A UNIT-RECORD DEV WAS SPECD
&SGDCLSB(12)  SETB  1                   A READER-PUNCH WAS SPECD
         AIF  ('&UNIT' EQ '3505' OR '&UNIT' EQ '3525').MODL35
         AIF   (T'&MODEL EQ 'O').AE     IF MOD VALUE OMITD GO ERR RTN
         AIF   ('&MODEL' EQ '1').AF     IF MOD VALUE 1 GO SET SW
    MNOTE 5,'* * * IEIIOD103 &ID-MODEL VALUE &MODEL INVALID'
&SGQUITB SETB  1
         AGO   .FEATCHK
.AE MNOTE 5,'* * * IEIIOD104 &ID-MODEL VALUE NOT SPECIFIED'
&SGQUITB  SETB  1                       MOD VALUE INVALID
         AGO   .FEATCHK                 GO SEE IF OPT'L FEAT SPECD
.AF MNOTE *,'     MODEL 1 '
&SGDM01B(&I)   SETB 1                  TURN MODEL GLOBAL 1 ON FOR MD 1
.FEATCHK AGO   .CHECKX
.MODL35  ANOP
         AIF   (T'&MODEL EQ 'O').FEAT01
    MNOTE 5,'* * * IEIIOD236 &ID-&UNIT   MODEL INVALID THIS DEVICE'
&SGQUITB SETB  1
.FEAT01  AIF   (N'&FEATURE EQ 0).CHECKX
&Q       SETA  0
    MNOTE *,'       FEATURE(S) '
.FEAT02  AIF (N'&FEATURE EQ &Q ).CHECKX
&Q       SETA  &Q+1
         AIF ('&FEATURE(&Q)' EQ 'TWOLINE').FTTWO
         AIF ('&FEATURE(&Q)' EQ 'MULTILINE').FTMULTI
         AIF ('&FEATURE(&Q)' EQ 'CARDIMAGE').FTCDIMG
.FEATERR ANOP
    MNOTE 5,'* * * IEIIOD105 &ID-FEATURE VALUE &FEATURE(&Q) INVALID'
&SGQUITB SETB  1
         AGO   .FEAT02
.FTTWO   ANOP
         AIF   ('&UNIT' EQ '3505').FEATERR
         AIF   (&SGDF02B(&I)).LINERR
    MNOTE *,'       TWOLINE PRINT '
&SGDF03B(&I)   SETB 1
         AGO   .FEAT02
.FTMULTI ANOP
         AIF   ('&UNIT' EQ '3505').FEATERR
         AIF   (&SGDF03B(&I)).LINERR
    MNOTE *,'       MULTILINE PRINT '
&SGDF02B(&I)   SETB 1
         AGO   .FEAT02
.FTCDIMG ANOP
    MNOTE *,'       CARDIMAGE '
&SGDF01B(&I)   SETB 1
         AGO   .FEAT02
.LINERR  ANOP
    MNOTE 5,'* * * IEIIOD237 TWOLINE-MULTILINE MUTUALLY EXCLUSIVE'
&SGQUITB SETB  1
         AGO   .FEAT02
.RDR2671 ANOP                           ENTER PAPER TAPE READER RTN
&SGDT07B(&I) SETB 1                     GLOBAL TYPE SW 7 EQ UNIT/REC DV
&SGDU06B(&I)  SETB  1                   GLOBAL UNIT SW 6 EQ PAPER TP RD
&SGDCLSB(1)  SETB  1                    A SEQUENTIAL DEV WAS SPECIFIED
&SGDCLSB(11) SETB  1                    A UNIT-RECORD DEV WAS SPECD
&SGDCLSB(12) SETB  1                    A CARD READER PUNCH WAS SPECD
&SGDCLSB(21) SETB  1                    A 2671 PAPER TAPE RDR WAS SPECD
    MNOTE *,'     2671 PAPER TAPE READER '
         AIF   (NOT &LOC).AX            BR ERROR RTN IF MOD VALUE OMITD
         AIF   ('&MODEL' NE '1').AY     MODEL VALUE MUST BE 1 FOR 2671
&SGDM01B(&I) SETB 1                     GLOBAL MODEL SW1 FOR MODEL 1
    MNOTE *,'     MODEL 1 '
         AGO   .RDR6FET                 GO TO 2671 FEATURE SCAN
.AY MNOTE 5,'* * * IEIIOD103 &ID-MODEL VALUE &MODEL INVALID'
&SGQUITB SETB  1
         AGO   .RDR6FET
.AX MNOTE 5,'* * * IEIIOD104 &ID-MODEL VALUE NOT SPECIFIED'
&SGQUITB SETB  1                        INVALID MODEL SPECD FOR 2671
.RDR6FET AGO   .CHECKX
.FEATEST AGO   .CHECKX
.TP1030  ANOP                           T E L C O M M U N ' T N S  R T.
&SGDT08B(&I) SETB  1                    SET GLOBAL TYPE 8 FOR TLCM DEV
&SGDU01B(&I) SETB  1                    SET GLOBAL UNIT 1 FOR 1030 SYS
&SGDCLSB(33) SETB  1                    A TELECOMMUN'TNS DEV WAS SPECD
&SGDCLSB(34) SETB  1                    A 1030 COMM SYS WAS SPECD
    MNOTE *,'     1030 COMMUNICATION SYSTEM'
        AIF (T'&ADAPTER EQ 'O').C1      IF ADAPTER OMIT GO ERR RTN
        AIF ('&ADAPTER' EQ 'IBM2').C2   IF ADAPTER OK SET SW/PRT
&SGQUITB  SETB 1                        ADAPTER VALUE MUST BE IBM2
    MNOTE 5,'* * * IEIIOD119 &ID-ADAPTER VALUE &ADAPTER INVALID'
         AGO   .POLLFET                 GO TO 1030 FEATURE RTN
.C1 MNOTE 5,'* * * IEIIOD120 &ID-ADAPTER VALUE NOT SPECIFIED'
&SGQUITB SETB  1                        ADAPTER REQ'D FOR ALL TLCM DEVS
         AGO .POLLFET                   GO TO FEATURE RTN
.C2 MNOTE *,'     IBM TERMINAL ADAPTER, TYPE II '
&SGDAD2B(&I) SETB 1                     SET 2ND ADAPTER SWT FOR IBM2
.POLLFET AIF (T'&FEATURE EQ 'O').SADTEST IF NO FEATS BR SAD SCAN
    MNOTE *,'     FEATURE '
.RETEST  AIF  (N'&FEATURE EQ &Q).SADTEST
&Q       SETA  &Q+1                     BUMP CTR TO FEAT SUBLSTD OPND
 AIF ('&FEATURE(&Q)' EQ 'AUTOPOLL').C3  IF AUTO POLL SPECD GO SET SW
&SGQUITB SETB  1                        AUTO POLL ONLY ALLOWABLE FEAT
    MNOTE 5,'* * * IEIIOD105 &ID-FEATURE VALUE &FEATURE(&Q) INVALID'
         AGO    .RETEST                 GO LOOK AT NEXT FEAT
.C3 MNOTE *,'        AUTOMATIC POLLING FEATURE '
&SGDF01B(&I)  SETB  1                   SET 1ST FEAT FOR ONLY VALID FET
.* AUTOPOLL VALID ONLY IF NO OTHER FEATURES ARE SPECIFIED
 AIF (&SGCNTRA(2) EQ 0 OR &SGCNTRA(2) GT 255).RETEST
 AIF ((&SGUNT2B(&Z) AND &SGUNU2B(&Z)) OR (&SGUNT3B(&Z) AND &SGUNU1B(&Z)X
               )).RETEST
 MNOTE 5,'* * * IEIIOD106 CONTROL UNIT 2702 OR 2703 REQUIRED FOR AUTOPOX
               LL FEATURE'
&SGQUITB SETB 1
         AGO .RETEST                    GO TEST FOR END OF FEATS.
.TP1050  ANOP                           ENTER 1050 ROUTINE
&SGDT08B(&I)  SETB  1                   SET GLOBAL TYPE 8 FOR TLCM DEV
&SGDU02B(&I)  SETB  1                   SET GLOBAL UNIT 2 FOR 1050 SYS
&SGDCLSB(33)  SETB  1                   A TELECOMMUN'TNS DEV WAS SPECD
&SGDCLSB(35)  SETB  1                   A 1050 COMM SYS WAS SPECD
    MNOTE *,'     1050 COMMUNICATION SYSTEM '
         AIF (T'&ADAPTER EQ 'O').G1     IF ADAPTER OMIT GO ERR RTN
         AIF ('&ADAPTER' EQ 'IBM1').G2  IF IBM TERMINAL ADPT,I SET SW
         AIF ('&ADAPTER' EQ 'IBMT').G3  IF IBM TELEGRAPH ADAPTER SET SW
&SGQUITB  SETB  1                       ADAPTER SPECD INVALID FOR 1050
    MNOTE 5,'* * * IEIIOD119 &ID-ADAPTER VALUE &ADAPTER INVALID'
         AGO   .AUTOSCN                 BR TO FEATURE RTN
.G1 MNOTE 5,'* * * IEIIOD120 &ID-ADAPTER VALUE NOT SPECIFIED'
&SGQUITB  SETB  1                       IF TLCM DEV,MUST SPEC ADAPTER
         AGO .AUTOSCN                   BR TO FEAT ROUTINE
.G2 MNOTE *,'     IBM TERMINAL ADAPTER, TYPE I '
&SGDAD1B(&I) SETB 1                     SET 1ST ADAPTER SW FOR IBM1
         AGO   .AUTOSCN                 BR TO FEATURE ROUTINE
.G3 MNOTE *,'     IBM TELEGRAPH ADAPTER '
&SGDAD3B(&I)  SETB  1
&G       SETB  1                        IF G SET 1050 ADAPTER EXCLD SAD
.AUTOSCN AIF (T'&FEATURE EQ 'O').CHKSWTG
    MNOTE *,'     FEATURE(S) '
.AUTOCHK AIF (N'&FEATURE EQ &Q).CHKSWTG NO OPT'L FEAT SPECD-GO SAD RTN
&Q     SETA  &Q+1                       BUMP CTR AND POINT NEXT FEAT
  AIF ('&FEATURE(&Q)' EQ 'AUTOPOLL').G4 IF POLL SPECD GO TST OMITD CALL
  AIF ('&FEATURE(&Q)' EQ 'AUTOCALL').G5 IF CALL SPECD GO TST OMITD CALL
  AIF ('&FEATURE(&Q)' EQ 'AUTOANSR').G6 IF ANSR SPECD GO TST OMITD CALL
&SGQUITB  SETB  1                       FEAT VALUE INVALID FOR 1050
    MNOTE 5,'* * * IEIIOD105 &ID-FEATURE VALUE &FEATURE(&Q) INVALID'
         AGO  .AUTOCHK                  BR TO TEST END OF FEAT SUBLIST
.G4 MNOTE *,'        AUTOMATIC POLLING '
&SGDF01B(&I)  SETB  1                   1ST GLOBAL FEAT SW FOR AUTOPOLL
 AIF (&SGCNTRA(2) EQ 0 OR &SGCNTRA(2) GT 255).AUTOCHK
 AIF ((&SGUNT2B(&Z) AND &SGUNU2B(&Z)) OR (&SGUNT3B(&Z) AND &SGUNU1B(&Z)X
               )).AUTOCHK        TEST NEXT FEATURE
 MNOTE 5,'* * * IEIIOD106 CONTROL UNIT 2702 OR 2703 REQUIRED FOR AUTOPOX
               LL FEATURE'
&SGQUITB SETB 1
         AGO .AUTOCHK                   RETURN TO TEST NEXT FEATURE
.G5 MNOTE *,'        AUTOMATIC CALLING '
&SGDF02B(&I)  SETB  1                   2ND GOLBAL FEAT SW FOR AUTOCALL
         AGO   .AUTOCHK                 RETURN TO TEST NEXT FEATURE
.G6 MNOTE *,'        AUTOMATIC ANSWERING '
&SGDF03B(&I)  SETB  1                   3RD GLOBAL FEAT SW FOR AUTOANSR
         AGO   .AUTOCHK                 RETURN TO TEST NEXT FEATURE
.CHKSWTG AIF (&SGDF01B(&I) AND (&SGDF02B(&I) OR &SGDF03B(&I))).G8
.G7    AIF   (NOT &G).SADTEST IF SAD ALLOWED ON THIS 1050, GO
         AGO  .CHECKX
.G8 MNOTE 5,'* * * IEIIOD105 AUTOCALL, AUTOANSR OR BOTH INVALID WITH AUX
               TOPOLL'
&SGQUITB SETB 1
              AGO .G7
.TP1050X ANOP
&SGDT02B(&I) SETB 1                     TELECOMMUNICATIONS DEVICE TYPE
&SGDU04B(&I) SETB 1                     1050X SYSTEM
&SGDCLSB(33) SETB 1                     TELECOMMUNICATION DEVICE CLASS
&SGDCLSB(62) SETB 1                     1050X COMMUNICATIONS CLASS
&Q  SETA  0
   MNOTE *,'     1050X COMMUNICATION SYSTEM'
         AIF   (T'&ADAPTER EQ 'O').E1   ADAPTER MUST BE SPECIFIED
         AIF   ('&ADAPTER' EQ 'IBM1').E2   IBM TERMINAL ADAPTER
         AIF   ('&ADAPTER' EQ 'IBMT').E3   IBM TELEGRAPH ADAPTER
&SGQUITB SETB 1                         INVALID ADAPTER SPECIFIED
   MNOTE 5,'* * * IEIIOD119 &ID-ADAPTER VALUE &ADAPTER INVALID'
         AGO   .E4
.E1 MNOTE 5,'* * * IEIIOD120 &ID-ADAPTER VALUE NOT SPECIFIED'
&SGQUITB SETB 1
         AGO   .E4
.E2 MNOTE *,'    IBM TERMINAL ADAPTER, TYPE I'
&SGDAD1B(&I) SETB 1
         AGO   .E4
.E3 MNOTE *,'     IBM TELEGRAPH ADAPTER'
&SGDAD3B(&I) SETB 1
&S  SETB 1
.E4      AIF   (N'&FEATURE EQ &Q).E5
&Q SETA &Q+1
         AIF   ('&FEATURE(&Q)' EQ 'AUTOCALL').E6
         AIF   ('&FEATURE(&Q)' EQ 'AUTOANSR').E7
&SGQUITB SETB 1
   MNOTE 5,'* * * IEIIOD105 &ID-FEATURE VALUE &FEATURE(&Q) INVALID'
         AGO   .E4
.E6 MNOTE *,'    AUTOMATIC CALLING'
&SGDF02B(&I) SETB 1
         AGO   .E4
.E7 MNOTE *,'    AUTOMATIC ANSWERING'
&SGDF03B(&I) SETB 1
         AGO   .E4
.E5      AIF   (NOT &S).SADTEST
         AGO   .CHECKX
.TP3705 MNOTE *,'     &UNIT COMMUNICATION CONTROL UNIT'         SA67531
&SGDT12B(&I)   SETB  1        TP CLASS
&SGDU06B(&I)   SETB  1        3705/3704                         SA67531
&ML      SETA  1              ALLOW ONE OPTCHAN
         AIF   (T'&ADAPTER EQ 'O').AERR
         AIF   ('&ADAPTER' EQ 'CA1').CA1
         AIF   ('&ADAPTER' EQ 'CA2').CA2
.AERR3 MNOTE 5,'* * * IEIIOD119 &ID-ADAPTER VALUE &ADAPTER INVALID'
         AGO   .AERR2
.AERR  MNOTE 5,'* * * IEIIOD120 &ID-ADAPTER VALUE NOT SPECIFIED'
.AERR2   ANOP
&SGQUITB SETB  1
         AGO   .CHECKX
.CA1 MNOTE *,'     CHANNEL ADAPTER - TYPE 1'
&SGDAD1B(&I)   SETB  1
         AGO   .CHECKX
.CA2 MNOTE *,'     CHANNEL ADAPTER - TYPE 2'
         AIF   ('&UNIT' NE '3705').AERR3                        SA67531
&SGDAD2B(&I)   SETB  1
         AGO   .CHECKX
.TP1060    ANOP                         ENTER 1060 ROUTINE
&SGDT08B(&I)  SETB  1                   SET GLOBAL TYPE 8 FOR TLCM DEV
&SGDU03B(&I)  SETB  1                   SET GLOBAL UNIT 3 FOR 1060 SYS
&SGDCLSB(33)  SETB  1                   A TELECOMMUN'TNS DEV WAS SPECD
&SGDCLSB(36)  SETB  1                   A 1060 COMM SYS WAS SPECD
    MNOTE *,'     1060 COMMUNICATION SYSTEM '
         AIF (T'&ADAPTER EQ 'O').K1     IF ADAPTER OMIT GO ERR RTN
         AIF ('&ADAPTER' EQ 'IBM1').K2  IF IMB TERMINAL ADPT 2 SET SW
&SGQUITB SETB 1                         ADAPTER SPECIFIED INVD FOR 1060
    MNOTE 5,'* * * IEIIOD119 &ID-ADAPTER VALUE &ADAPTER INVALID'
         AGO .FET1060                   BR FEATURE RTN
.K1 MNOTE 5,'* * * IEIIOD120 &ID-ADAPTER VALUE NOT SPECIFIED'
&SGQUITB  SETB  1                       IF TLCM DEV,MUST SPEC ADAPTER
         AGO   .FET1060                 BR TO FEATURE RTN
.K2 MNOTE *,'     IBM TERMINAL ADAPTER, TYPE I '
&SGDAD1B(&I) SETB 1                     SET 1ST ADAPTER SW FOR IBM1
.FET1060 AIF (T'&FEATURE EQ 'O').SADTEST IF NO FEATS BR TO SAD SCAN
   MNOTE *,'     FEATURE'
.FTURE AIF (N'&FEATURE EQ &Q).SADTEST
&Q      SETA &Q+1
  AIF ('&FEATURE(&Q)' EQ 'AUTOPOLL').IB IF AUTOPOLL SPECD GO TO TEST
&SGQUITB   SETB 1
  MNOTE 5,'* * * IEIIOD105 &ID-FEATURE VALUE &FEATURE (&Q) INVALID'
        AGO  .FTURE       LOOK AT NEXT FEATURE
.IB MNOTE *,'        AUTOMATIC POLLING '
&SGDF01B(&I)   SETB 1
.* AUTOPOLL VALID ONLY IF NO OTHER FEATURES ARE SPECIFIED
 AIF (&SGCNTRA(2) EQ 0 OR &SGCNTRA(2) GT 255).FTURE
 AIF ((&SGUNT2B(&Z) AND &SGUNU2B(&Z)) OR (&SGUNT3B(&Z) AND &SGUNU1B(&Z)X
               )).FTURE
 MNOTE 5,'* * * IEIIOD106 CONTROL UNIT 2702 OR 2703 REQUIRED FOR AUTOPOX
               LL FEATURE'
&SGQUITB SETB 1
        AGO  .FTURE       LOOK AT NEXT FEATURE
.TP2260  ANOP                           ENTER 2260-T/P RTN
&SGDT08B(&I)  SETB  1                   SET GLOBAL TYPE 8 FOR TLCM DEV
&SGDU04B(&I)  SETB  1                   SET GLOBAL UNIT 4 FOR 2260 STA.
&SGDCLSB(33)  SETB  1                   A TELECOMMUN'TNS DEV WAS SPECD
&SGDCLSB(10)  SETB  1                   A 2260 DISPLAY STAT'N SPECD
    MNOTE *,'     2260 DISPLAY STA. FOR ATTATCHMENT TO TELECOM ADAPTER'
         AIF   (T'&MODEL EQ 'O').KA   GO TO ERROR RTN IF MODEL OMITTD
         AIF   (('&MODEL' EQ '1') OR ('&MODEL' EQ '2')).KB
   MNOTE 5,'* * * IEIIOD103   &ID-MODEL VALUE &MODEL INVALID'
&SGQUITB SETB 1
         AGO  .KZ
.KA MNOTE 5,'* * * IEIIOD104  &ID-MODEL VALUE NOT SPECIFIED'
&SGQUITB SETB  1
         AGO  .KZ
.KB       ANOP
&SGDM01B(&I) SETB ('&MODEL' EQ '1')  IF MOD 1 SET 1ST GLOBAL SW
&SGDM02B(&I) SETB ('&MODEL' EQ '2')  IF MOD 2 SET 2ND GLOBAL SW
  MNOTE *,'      MODEL &MODEL-DISPLAY STATION'
.KZ      ANOP
         AIF (T'&ADAPTER EQ 'O').L1     IF ADAPTER OMITTED GO ERR RTN
         AIF ('&ADAPTER' EQ 'IBM3').L2  IS CORRECT ADAPTER SPECD
&SGQUITB  SETB  1                       INCORRECT ADAPTER VALUE SPECD
    MNOTE 5,'* * * IEIIOD119 &ID-ADAPTER VALUE &ADAPTER INVALID'
         AGO  .FET2260                  BR TO TEXT FOR OMITTED FEAT
.L1 MNOTE 5,'* * * IEIIOD120 &ID-ADAPTER VALUE NOT SPECIFIED'
&SGQUITB SETB  1                        ADAPTER MUST NOT BE OMITTED
         AGO  .FET2260                  BR TO TEST FOR OMITTED FEAT
.L2 MNOTE *,'     IBM TERMINAL ADAPTER, TYPE III '
&SGDAD6B(&I)   SETB   1
.FET2260 AIF (T'&FEATURE EQ 'O').ANYSAD ANY KYBD FEATURES SPEC'D
 MNOTE *,'        FEATURES PRODUCE NO CODE FOR 2260 ON 2701'
.ANYSAD  AGO   .CHECKX
.TP2265 ANOP
&SGDT12B(&I) SETB 1          DEVICE TYPE IS TP
&SGDU03B(&I) SETB 1          DEVICE IS 2265
&SGDCLSB(33) SETB 1          TELECOMMUNICATION CLASS SWITCH
&SGDCLSB(68) SETB 1          2265 CLASS SWITCH
    MNOTE *,'     2265 DISPLAY STATION FOR ATTACHMENT TO TP ADAPTER'
 AIF (T'&ADAPTER EQ 'O').T2265E1
 AIF ('&ADAPTER' EQ 'IBM3').T2265AD
  MNOTE 5,'* * * IEIIOD119 &ID-ADAPTER VALUE &ADAPTER INVALID'
&SGQUITB SETB 1
 AGO .CHECKX
.T2265AD ANOP
&SGDAD6B(&I) SETB 1          IBM3 ADAPTER
  MNOTE *,'     IBM TERMINAL ADAPTER, TYPE 3'
 AGO .CHECKX
.T2265E1 ANOP
   MNOTE 5,'* * * IEIIOD120 &ID-ADAPTER VALUE NOT SPECIFIED'
&SGQUITB SETB 1
 AGO .CHECKX
.TP7770 ANOP
&SGDT12B(&I) SETB 1          DEVICE TYPE IS TP
&SGDU04B(&I) SETB 1          DEVICE IS 7770
&SGDCLSB(33) SETB 1          TELECOMMUNICATION CLASS SWITCH
&SGDCLSB(67) SETB 1          7770 CLASS SWITCH
    MNOTE *,'     7770 AUDIO RESPONSE UNIT'
 AIF (T'&MODEL EQ 'O').T7770E1
 AIF ('&MODEL' EQ '3').T7770M3
  MNOTE 5,'* * * IEIIOD103 &ID-MODEL VALUE &MODEL INVALID'
&SGQUITB SETB 1
 AGO .CHECKX
.T7770M3 ANOP
  MNOTE *,'     MODEL &MODEL'
&SGDM03B(&I)   SETB 1                   SET MODEL 3 GLOBAL
 AGO .CHECKX
.T7770E1 ANOP
  MNOTE 5,'* * * IEIIOD104 &ID-MODEL VALUE NOT SPECIFIED'
&SGQUITB SETB 1
 AGO .CHECKX
.TP115A  ANOP                           ENTER 115A RTN
&SGDU05B(&I)  SETB  1                   SET GLOBAL UNIT 5 FOR 115A STA.
&SGDCLSB(37)  SETB  1                   A 115A POLL STA WAS SPEC'D
    MNOTE *,'     115A WESTERN UNION POLLING STATION '
         AGO   .SAMESWS                 GO TO COMMON ADAPT & FEAT RTN
.TP2740   ANOP                          ENTER 2740-T/P RTN
&SGDT08B(&I)  SETB  1                   SET GLOBAL TYPE 8 FOR TELCM DEV
&SGDU08B(&I)  SETB  1                   SET GLOBAL UNIT 8 FOR 2740 TERM
&SGDCLSB(33)  SETB  1                   A TELECOMMUN'TNS DEV WAS SPECD
&SGDCLSB(50)  SETB  1                   A 2740 COMMUNICATION TERM SPECD
   MNOTE *,'   2740 COMMUNICATION TERMINAL'
  AIF (T'&ADAPTER EQ 'O').T2740E1       IF ADAPTER IS OMITTED-ERROR
 AIF ('&ADAPTER' EQ 'IBM1').T2740AD     CORRECT ADAPTER
   MNOTE 5,'* * * IEIIOD119 &ID-ADAPTER VALUE &ADAPTER INVALID'
&SGQUITB  SETB  1
  AGO  .T2740FE                         CHECK FEATURES
.T2740AD  ANOP
   MNOTE *,'   IBM TERMINAL ADAPTER, TYPE I'
&SGDAD1B(&I)  SETB  1
.T2740FE AIF (T'&FEATURE EQ 'O').T2740SA
   MNOTE *,'         FEATURE(S)'
.T2740RE AIF (N'&FEATURE EQ &Q).T2740DI       DO DIAGNOSTICS
&Q   SETA  &Q+1             FEATURE INDEX
   AIF ('&FEATURE(&Q)' EQ 'AUTOPOLL').T2740AP
   AIF ('&FEATURE(&Q)' EQ 'AUTOCALL').T2740AC
   AIF ('&FEATURE(&Q)' EQ 'AUTOANSR').T2740AA
   AIF ('&FEATURE(&Q)' EQ 'SCONTROL').T2740SC
   AIF ('&FEATURE(&Q)' EQ 'XCONTROL').T2740XC
   AIF ('&FEATURE(&Q)' EQ 'CHECKING').T2740CH
         AIF ('&FEATURE(&Q)' EQ 'OIU').T2740IU
         AIF   ('&FEATURE(&Q)' EQ 'INTERRUPT').T2740IN
   MNOTE 5,'* * * IEIIOD105 &ID-FEATURE VALUE &FEATURE(&Q) INVALID'
&SGQUITB  SETB  1
  AGO  .T2740RE
.T2740AP MNOTE *,'        AUTOMATIC POLLING'
&SGDF01B(&I)  SETB  1
 AIF (&SGCNTRA(2) EQ 0 OR &SGCNTRA(2) GT 255).T2740RE
 AIF ((&SGUNT2B(&Z) AND &SGUNU2B(&Z)) OR (&SGUNT3B(&Z) AND &SGUNU1B(&Z)X
               )).T2740RE
 MNOTE 5,'* * * IEIIOD106 CONTROL UNIT 2702 OR 2703 REQUIRED FOR AUTOPOX
               LL FEATURE'
&SGQUITB SETB 1
  AGO  .T2740RE
.T2740AC MNOTE *,'        AUTOMATIC CALLING'
&SGDF02B(&I)  SETB  1
  AGO  .T2740RE
.T2740AA MNOTE *,'        AUTOMATIC ANSWERING'
&SGDF03B(&I)  SETB  1
  AGO  .T2740RE
.T2740SC MNOTE *,'        STATION CONTROL'
&SGDF04B(&I)  SETB  1
  AGO  .T2740RE
.T2740XC MNOTE *,'        TRANSMIT CONTROL'
&SGDF05B(&I)  SETB  1
  AGO  .T2740RE
.T2740CH MNOTE *,'        RECORD CHECKING'
&SGDF06B(&I)  SETB  1
  AGO  .T2740RE
.T2740IU MNOTE *,'        OPTICAL IMAGE UNIT'
&SGDF07B(&I)   SETB  1
   AGO  .T2740RE
.T2740IN MNOTE *,'        INTERRUPT**RPQ S30031**'
&SGDF08B(&I) SETB 1
         AGO   .T2740RE
.T2740DI  ANOP
 AIF (&SGCNTRA(2) EQ 0 OR &SGCNTRA(2) GT 255).CHECKX
   AIF (&SGDF01B(&I) AND NOT &SGDF04B(&I)).T2740E4 POLL REQRS SCONTROL
   AIF (&SGDF07B(&I) AND NOT &SGDF06B(&I)).T2740E5
.T2740DO AIF (&SGDF07B(&I) AND (&SGDF04B(&I) OR &SGDF05B(&I))).T2740E6
.T2740DJ ANOP
   AIF (&SGDF04B(&I) AND (&SGDF05B(&I) OR &SGDF02B(&I) OR &SGDF03B(&I))*
               ).T2740E2
  AIF (&SGDF05B(&I) AND (NOT(&SGDF02B(&I) OR &SGDF03B(&I)))).T2740E3
  AGO  .T2740SA
.T2740E3  ANOP
   MNOTE 5,'* * * IEIIOD142 AUTOCALL, AUTOANSR OR BOTH FEATURES REQUIRE*
               D WITH XCONTROL'
&SGQUITB  SETB  1
  AGO  .T2740SA
.T2740E2   ANOP
   MNOTE 5,'* * * IEIIOD143 XCONTROL,AUTOCALL OR AUTOANSR INVALID WITH**
               SCONTROL'
&SGQUITB  SETB  1
.T2740SA AIF (NOT((&SGUNT2B(&SGCNTRA(2)) AND &SGUNU2B(&SGCNTRA(2)))OR (*
               &SGUNT3B(&SGCNTRA(2))AND &SGUNU1B(&SGCNTRA(2))))).CHECKX
  AGO   .SADTEST
.T2740E1  ANOP
   MNOTE 5,'* * * IEIIOD120 &ID-ADAPTER VALUE NOT SPECIFIED'
&SGQUITB  SETB  1
  AGO  .T2740FE
.T2740E4   ANOP
 MNOTE 5,'* * * IEIIOD144 AUTOPOLL REQUIRES SCONTROL'
&SGQUITB SETB 1
         AGO .T2740DJ
.TP2740C  ANOP
&SGDT12B(&I)  SETB  1
&SGDU02B(&I)  SETB  1
&SGDCLSB(64)  SETB  1
&SGDCLSB(33)  SETB  1
&Q  SETA  0
 MNOTE *,'    2740C COMMUNICATION TERMINAL'
         AIF   (T'&ADAPTER EQ 'O').TLA
         AIF   ('&ADAPTER' EQ 'IBM1').TLB
&SGQUITB SETB  1
 MNOTE 5,'* * * IEIIOD119 &ID-ADAPTER VALUE &ADAPTER INVALID'
         AGO   .TLC
.TLA MNOTE 5,'* * * IEIIOD120 &ID-ADAPTER VALUE NOT SPECIFIED'
&SGQUITB SETB  1
         AGO   .TLC
.TLB MNOTE *,'    IBM TERMINAL ADAPTER, TYPE I'
&SGDAD1B(&I) SETB 1
.TLC     AIF   (T'&FEATURE EQ 'O').TLE
.TLD     AIF   (N'&FEATURE EQ &Q).TLE
&Q SETA  &Q+1
         AIF   ('&FEATURE(&Q)' EQ 'CHECKING').TLF
         AIF   ('&FEATURE(&Q)' EQ 'AUTOANSR').TLG
&SGQUITB SETB  1
 MNOTE 5,'* * * IEIIOD105 &ID-FEATURE VALUE &FEATURE(&Q) INVALID'
         AGO   .TLD
.TLF MNOTE *,'    RECORD CHECKING'
&SGDF06B(&I) SETB 1
         AGO   .TLD
.TLG MNOTE *,'    AUTOMATIC ANSWERING'
&SGDF03B(&I)  SETB  1
         AGO   .TLD
.TLE     AIF   (&SGDF06B(&I)).TLH
 MNOTE 5,'* * * IEIIOD122 CHECKING FEATURE REQUIRED WITH 2740C'
&SGQUITB  SETB  1
.TLH     AIF   (NOT((&SGUNT2B(&SGCNTRA(2)) AND &SGUNU2B(&SGCNTRA(2)))OR*
               (&SGUNT3B(&SGCNTRA(2)) AND                              *
               &SGUNU1B(&SGCNTRA(2))))).CHECKX
        AGO   .SADTEST
.TP2740X ANOP
&SGDT12B(&I) SETB 1
&SGDU01B(&I) SETB 1
&SGDCLSB(33) SETB 1
&SGDCLSB(63) SETB 1
&Q  SETA  0
   MNOTE *,'     2740X COMMUNICATION TERMINAL'
         AIF   (T'&ADAPTER EQ 'O').Q1B
         AIF   ('&ADAPTER' EQ 'IBM1').Q2B
&SGQUITB SETB 1
   MNOTE 5,'* * * IEIIOD119 &ID-ADAPTER VALUE &ADAPTER INVALID'
         AGO   .Q3A
.Q1B MNOTE 5,'* * * IEIIOD120 &ID-ADAPTER VALUE NOT SPECIFIED'
&SGQUITB SETB  1
         AGO   .Q3A
.Q2B MNOTE *,'    IBM TERMINAL ADAPTER, TYPE I'
&SGDAD1B(&I) SETB 1
.Q3A     AIF   (T'&FEATURE NE 'O').Q3B
&SGQUITB  SETB  1
   MNOTE 5,'* * * IEIIOD122 CHECKING FEATURE REQUIRED WITH 2740X'
         AGO   .Q4A
.Q3B     AIF   (N'&FEATURE EQ &Q).Q4A
&Q SETA &Q+1
         AIF   ('&FEATURE(&Q)' EQ 'CHECKING').Q5B
         AIF   ('&FEATURE(&Q)' EQ 'AUTOCALL').Q6B
         AIF   ('&FEATURE(&Q)' EQ 'AUTOANSR').Q7B
&SGQUITB SETB 1
   MNOTE 5,'* * * IEIIOD105 &ID-FEATURE VALUE &FEATURE(&Q) INVALID'
         AGO   .Q3B
.Q5B MNOTE *,'     RECORD CHECKING'
&SGDF06B(&I) SETB 1
         AGO   .Q3B
.Q6B MNOTE *,'     AUTOMATIC CALLING'
&SGDF02B(&I) SETB 1
         AGO   .Q3B
.Q7B MNOTE *,'     AUTOMATIC ANSWERING'
&SGDF03B(&I) SETB 1
         AGO   .Q3B
.Q4A     AIF   (&SGDF06B(&I)).Q4B
   MNOTE 5,'* * * IEIIOD122 CHECKING FEATURE REQUIRED WITH 2740X'
&SGQUITB  SETB  1
.Q4B     AIF   (NOT((&SGUNT2B(&SGCNTRA(2)) AND &SGUNU2B(&SGCNTRA(2)))OR*
               (&SGUNT3B(&SGCNTRA(2)) AND                              *
               &SGUNU1B(&SGCNTRA(2))))).CHECKX
         AGO   .SADTEST
.T2740E5 MNOTE 5,'* * * IEIIOD145 CHECKING FEATURE REQUIRED WITH OIU FEX
               ATURE'
&SGQUITB  SETB  1
         AGO   .T2740DO
.T2740E6 MNOTE 5,'* * * IEIIOD146 XCONTROL OR SCONTROL FEATURES INVALIDX
                WITH OIU FEATURE'
&SGQUITB SETB  1
         AGO   .T2740SA
.TP2741P ANOP                            ENTER 2741P RTN
&SGDT02B(&I)   SETB 1                   SET GLOBAL TYPE 2 FOR TELCM
&SGDU02B(&I)   SETB 1                   SET GLOBAL UNIT 2 FOR 2741P
.T2741A  ANOP
&SGDCLSB(33)   SETB 1                   A TELCM DEV. WAS SPECIFIED
    MNOTE *,'   &UNIT COMMUNICATION TERMINAL'
         AIF (T'&ADAPTER EQ 'O').T2741E1 IF ADAPTER OMITTED-ERROR
         AIF ('&ADAPTER' NE 'IBM1').T2741E2  INCORRECT ADAPTER
    MNOTE *,'   IBM TERMINAL ADAPTER, TYPE 1'
&SGDAD1B(&I)   SETB 1                   SET 1ST ADAPTER SW FOR IBM1
         AIF (T'&FEATURE EQ 'O').SADTEST
    MNOTE *,'     FEATURE'
.T2741F  AIF (N'&FEATURE EQ &Q).SADTEST
&Q       SETA  &Q+1
         AIF ('&FEATURE(&Q)' NE 'AUTOANSR').T2741E3
    MNOTE *,'        AUTOMATIC ANSWERING'
&SGDF03B(&I)   SETB 1                   AUTOMATIC ANSWERING GLOBAL
         AGO   .T2741F
.T2741E1 MNOTE 5,'* * * IEIIOD119 &ID-ADAPTER VALUE NOT SPECIFIED'
&SGQUITB SETB  1
         AGO   .T2741F
.T2741E2 MNOTE 5,'* * * IEIIOD120 &ID-ADAPTER VALUE &ADAPTER INVALID'
&SGQUITB SETB  1
         AGO   .T2741F
.T2741E3 MNOTE 5,'* * * IEIIOD105 &ID-FEATURE VALUE &FEATURE(&Q) INVALIX
               D'
&SGQUITB SETB  1
         AGO   .SADTEST
.TP2741C ANOP                            ENTER 2741C RTN
&SGDT02B(&I)   SETB 1                   SET GLOBAL TYPE 2 FOR TELCM
&SGDU03B(&I)   SETB 1                   SET GLOBAL UNIT 3 FOR 2741C
         AGO   .T2741A
.TP2955 MNOTE *,'     2955  FIELD ENGINEERING DATA ADAPTER UNIT'
&SGDT12B(&I) SETB 1           TP DEVICE TYPE
&SGDU05B(&I) SETB 1           2955 (REMOTE ANALYSIS) DEVICE
&SGDCLSB(72) SETB 1           2955 DEVICE CLASS IN SYSTEM
         AGO   .CHECKX        GO CHECK DEVTYPE
.TP83B3  ANOP
&SGDU06B(&I)  SETB  1                   SET GLOBAL UNIT 6 FOR 83B2 TERM
&SGDCLSB(38)  SETB  1                   A 83B2 POLLING TERMINAL SPEC'D
    MNOTE *,'       83B3 AT&&T CALLING TERMINAL'
   AGO .SAMESWS
.TPTWX   ANOP
&SGDT08B(&I)  SETB 1
&SGDU07B(&I)  SETB 1
&SGDCLSB(33)  SETB  1
&SGDCLSB(49) SETB 1
 MNOTE *,'          TWX COMMUNICATION SYSTEM '
  AIF (T'&ADAPTER EQ 'O').VV1
  AIF  ('&ADAPTER' EQ 'TELE2').VV2
&SGQUITB  SETB  1
 MNOTE 5,'* * * IEIOD119 &ID-ADAPTER VALUE &ADAPTER INVALID'
   AGO  .POLFET2
.VV1 MNOTE 5,'* * * IEIOD120 &ID-ADAPTER VALUE NOT SPECIFIED'
&SGQUITB  SETB  1
   AGO  .POLFET2
.VV2 MNOTE *,'      TELEGRAPH ADAPTER TYPE 2'
&SGDAD5B(&I) SETB 1
.POLFET2 AIF  (T'&FEATURE EQ 'O').SADTEST
 MNOTE *,'          FEATURE'
.RETST  AIF  (N'&FEATURE EQ &Q).SADTEST
&Q   SETA  &Q+1
  AIF  ('&FEATURE(&Q)' EQ 'AUTOCALL').VV3
 AIF ('&FEATURE(&Q)' EQ 'AUTOANSR').VV4
&SGQUITB  SETB  1
 MNOTE   5,'* * * IEIOD105 &ID-FEATURE VALUE &FEATURE(&Q) INVALID'
.VV3 MNOTE *,'      AUTOMATIC CALLING'
&SGDF02B(&I)  SETB 1
   AGO  .RETST
.VV4 MNOTE *,'      AUTOMATIC ANSWERING'
&SGDF03B(&I)  SETB  1
   AGO  .RETST
.TPS360 MNOTE *,'    SYSTEM/360 COMMUNICATION SYSTEM'
   AGO   .COMMON
.TP2780  MNOTE *,'    2780 DATA TRANSMISSION UNIT'
   AGO   .COMMON
.TP1130  MNOTE *,'    1130 COMMUNICATION SYSTEM'
   AGO   .COMMON
.TP2020  MNOTE *,'    2020 COMMUNICATION SYSTEM'
.COMMON  AIF (T'&ADAPTER EQ 'O').S12ERR      MUST HAVE ADAPTER
         AIF ('&ADAPTER' EQ 'BSCA').S12ADP
   MNOTE 5,'* * * IEIIOD119 &ID-ADAPTER VALUE &ADAPTER INVALID'
&SGQUITB SETB 1
         AGO   .FETCHK
.S12ADP  MNOTE *,'      BINARY SYNCHRONOUS ADAPTER'
&SGDAD7B(&I) SETB 1
     AGO   .FETCHK
.S12ERR  MNOTE 5,'* * * IEIIOD120 &ID-ADAPTER VALUE NOT SPECIFIED'
&SGQUITB SETB 1
.FETCHK  AIF  (T'&FEATURE EQ 'O').GOBSC1
.CHKMOR  AIF   (N'&FEATURE EQ &Q).NAUTO
&Q SETA &Q+1    FEATURE INDEX
   AIF   ('&FEATURE(&Q)' EQ 'AUTOCALL').AUTC
   AIF   ('&FEATURE(&Q)' EQ 'AUTOANSR').AUTA
   AIF   ('&FEATURE(&Q)' EQ 'AUTOPOLL').AUTP
   AIF   ('&FEATURE(&Q)' EQ 'DUALCOMM').DCOM
   AIF   ('&FEATURE(&Q)' EQ 'DUALCODE').DCOD
.NOVAL  ANOP
 MNOTE 5,'* * * IEIIOD105 &ID-FEATURE VALUE &FEATURE(&Q) INVALID'
&SGQUITB SETB 1
   AGO   .CHKMOR
.AUTC  MNOTE *,'      AUTOMATIC CALLING'
&SGDF02B(&I) SETB 1
  AGO   .GOBSC2
.AUTA  MNOTE *,'      AUTOMATIC ANSWERING'
&SGDF03B(&I) SETB 1
   AGO   .GOBSC2
.AUTP  AIF   ('&UNIT' EQ 'S360').NOVAL
   MNOTE *,'      AUTOMATIC POLLING'
&SGDF01B(&I) SETB 1
   AGO  .GOBSC3
.DCOM AIF (NOT(&SGUNT2B(&Z) AND &SGUNU1B(&Z))).NOVAL   2701 ONLY
   MNOTE *,'      DUAL COMMUNICATION STATIONS'
&SGDF06B(&I) SETB 1
   AGO   .CHKMOR
.DCOD  AIF  (NOT(&SGUNT2B(&Z) AND &SGUNU1B(&Z))).NOVAL   2701 ONLY
  MNOTE *,'      DUAL COMMUNICATION CODE SETS'
&SGDF05B(&I) SETB 1
   AGO   .CHKMOR
.GOBSC1  ANOP
&SGDT02B(&I) SETB 1
&SGDU06B(&I) SETB 1
&SGDCLSB(33) SETB 1                     TELECOMMUNICATIONS CLASS
&SGDCLSB(51) SETB 1                     BINARY SYNCHRONOUS DEVICE
   AGO  .S12DIAG
.GOBSC2  ANOP
&SGDT02B(&I) SETB 1
&SGDU07B(&I) SETB 1
&SGDCLSB(33)  SETB 1                    TELECOMMUNICATIONS CLASS
&SGDCLSB(51) SETB 1                     BINARY SYNCHRONOUS DEVICE
   AGO  .CHKMOR
.GOBSC3  ANOP
&SGDT02B(&I) SETB 1
&SGDU08B(&I) SETB 1
&SGDCLSB(33) SETB 1                     TELECOMMUNICATIONS CLASS
&SGDCLSB(51) SETB 1                     BINARY SYNCHRONOUS DEVICE
   AGO   .CHKMOR
.TPWTTA ANOP
 MNOTE *,'      WORLD TRADE TELEGRAPH ADAPTER'
&SGDT02B(&I) SETB 1
&SGDU01B(&I) SETB 1
&SGDCLSB(33) SETB 1          TELECOMMUNICATIONS CLASS
 AIF (T'&ADAPTER EQ 'O').WTTAE   ERROR
 AIF ('&ADAPTER' EQ 'TELEW').WTTA1
    MNOTE 5,'* * * IEIIOD119 &ID-ADAPTER VALUE &ADAPTER INVALID'
&SGQUITB SETB 1
 AGO .SADTEST
.WTTAE ANOP
    MNOTE 5,'* * * IEIIOD120 &ID-ADAPTER VALUE NOT SPECIFIED'
&SGQUITB SETB 1
 AGO .SADTEST
.WTTA1 ANOP
   MNOTE *,'      TELEW ADAPTER'
&SGDAD8B(&I) SETB 1
 AGO .SADTEST
.TPBSC1  MNOTE *,'    BINARY SYNCHRONOUS COMMUNICATION SYSTEM, TYPE 1'
&SGDT02B(&I) SETB 1
&SGDU06B(&I) SETB 1
&SGDCLSB(33) SETB 1                     TELECOMMUNICATIONS CLASS
&SGDCLSB(51) SETB 1                     BINARY SYNCHRONOUS DEVICE
         AGO   .S12COM
.TPBSC2  MNOTE *,'    BINARY SYNCHRONOUS COMMUNICATION SYSTEM TYPE 2'
&SGDT02B(&I) SETB 1
&SGDU07B(&I) SETB 1
&SGDCLSB(33) SETB 1                     TELECOMMUNICATIONS CLASS
&SGDCLSB(51) SETB 1                     BINARY SYNCHRONOUS DEVICE
         AGO   .S12COM
.TPBSC3  MNOTE *,'    BINARY SYNCHRONOUS COMMUNICATIONS SYSTEM, TYPE 3'
&SGDT02B(&I) SETB 1
&SGDU08B(&I) SETB 1
&SGDCLSB(33) SETB 1                     TELECOMMUNICATIONS CLASS
&SGDCLSB(51) SETB 1                     BINARY SYNCHRONOUS DEVICE
         AGO   .S12COM
.S12COM AIF (T'&ADAPTER EQ 'O').S12E1       MUST HAVE ADAPTER
 AIF ('&ADAPTER' EQ 'BSCA').S12AD
 MNOTE 5,'* * * IEIIOD119 &ID-ADAPTER VALUE &ADAPTER INVALID'
&SGQUITB SETB 1
 AGO .S12FET
.S12AD MNOTE *,'      BINARY SYNCHRONOUS ADAPTER'
&SGDAD7B(&I) SETB 1
 AGO .S12FET
.S12E1 MNOTE 5,'* * * IEIIOD120 &ID-ADAPTER VALUE NOT SPECIFIED'
&SGQUITB SETB 1
.S12FET AIF (T'&FEATURE EQ 'O').CNTEST1
.S12MORE AIF (N'&FEATURE EQ &Q).S12DIAG
&Q SETA &Q+1        FEATURE INDEX
 AIF ('&FEATURE(&Q)' EQ 'AUTOCALL').S12AUTC
 AIF ('&FEATURE(&Q)' EQ 'AUTOANSR').S12AUTA
 AIF ('&FEATURE(&Q)' EQ 'AUTOPOLL').S12AUTP
 AIF ('&FEATURE(&Q)' EQ 'DUALCOMM').S12DCOM
 AIF ('&FEATURE(&Q)' EQ 'DUALCODE').S12DCOD
.INVFET ANOP
 MNOTE 5,'* * * IEIIOD105 &ID-FEATURE VALUE &FEATURE(&Q) INVALID'
&SGQUITB SETB 1
 AGO .S12MORE
.S12AUTC AIF   (&SGDU06B(&I) OR &SGDU08B(&I)).INVFET
         MNOTE *,'       AUTOMATIC CALLING'
&SGDF02B(&I) SETB 1
 AGO .S12MORE
.S12AUTA AIF   (&SGDU06B(&I) OR &SGDU08B(&I)).INVFET
         MNOTE *,'       AUTOMATIC ANSWERING'
&SGDF03B(&I) SETB 1
 AGO .S12MORE
.S12AUTP AIF   (&SGDU06B(&I) OR &SGDU07B(&I)).INVFET
         MNOTE *,'       AUTOMATIC POLLING'
&SGDF01B(&I) SETB 1
 AGO .S12MORE
.S12DCOM AIF (NOT(&SGUNT2B(&Z) AND &SGUNU1B(&Z))).INVFET   2701 ONLY
 MNOTE *,'      DUAL COMMUNICATION STATIONS'
&SGDF06B(&I) SETB 1
 AGO .S12MORE
.S12DCOD AIF (NOT(&SGUNT2B(&Z) AND &SGUNU1B(&Z))).INVFET   2701 ONLY
 MNOTE *,'      DUAL COMMUNICATION CODE SETS'
&SGDF05B(&I) SETB 1
 AGO .S12MORE
.NAUTO  AIF (NOT (&SGDF02B(&I) OR &SGDF03B(&I) OR &SGDF01B(&I))).GOBSC1
.S12DIAG AIF (&SGDF01B(&I) AND (&SGDF02B(&I) OR &SGDF03B(&I))).S12E2
   AGO    .CNTEST
.S12E2 MNOTE 5,'* * * IEIIOD143 AUTOPOLL INVALID WITH AUTOCALL OR AUTOA*
               NSR'
&SGQUITB SETB 1
.CNTEST1 AIF (NOT &SGDU08B(&I)).CNTEST
         AIF (&SGDF01B(&I)).CNTEST
&SGDF01B(&I) SETB 1
         MNOTE *,'       AUTOMATIC POLLING ASSUMED FOR BSC3'
.CNTEST  AIF  (T'&OBRCNT EQ 'O').SADTEST
  AIF (&SGDU06B(&I) OR &SGDU07B(&I) OR &SGDU08B(&I)).ADD
   MNOTE 5,'* * * IEIIOD146 OBRCNT IS INVALIDLY SPECIFIED'
&SGQUITB SETB  1
    AGO  .SADTEST
.ADD    ANOP
&SGDCLSB(53)  SETB  1
         AIF   (&OBRCNT GT 800).A
  MNOTE *,'    OBRCNT SPECIFIED IS &OBRCNT'
&SGBSCA  SETA  &SGBSCA+&OBRCNT              ACCUMULATE OBRCNT
         AIF   (&SGBSCA LE 800).SADTEST
.A MNOTE 0,'* * * IEIIODW01 MAXIMUM ACCUMULATED VALUE FOR OBRCNT OF 800*
               HAS BEEN EXCEEDED. 800 IS INSERTED AS THE DEFAULT VALUE'
&SGBSCA  SETA  800
 AGO .SADTEST
.SAMESWS ANOP                           ENTER COMMON ADAPTR & FEAT RTN
&SGDT08B(&I)  SETB  1                   SET GLOBAL TYPE 8 SW
&SGDCLSB(33)   SETB  1                  A TELECOMMUN'TNS DEV WAS SPECD
         AIF (T'&ADAPTER EQ 'O').U1     IS REQ'D ADAPTER OMITTED
         AIF ('&ADAPTER' EQ 'TELE1').U2 IS ADAPTER VALUE VALID
&SGQUITB  SETB 1                        ADAPTER VALUE INCORRECT
    MNOTE 5,'* * * IEIIOD109 &ID-ADAPTER VALUE &ADAPTER INVALID'
         AGO  .FETSAME                  BR TO 115A & 13B2 RTN
.U1 MNOTE 5,'* * * IEIIOD120 &ID-ADAPTER VALUE NOT SPECIFIED'
&SGQUITB SETB  1                        ADAPTER PARAM MUST BE SPECD
         AGO   .FETSAME                 BR TO 115A & 83B2 FEAT RTN
.U2 MNOTE *,'     TELEGRAPH ADAPTER, TYPE I '
&SGDAD4B(&I) SETB 1
.FETSAME AIF (T'&FEATURE EQ 'O').SADTEST
    MNOTE *,'     FEATURE    '
.TERMTST AIF (N'&FEATURE EQ &Q).SADTEST IF NO FEAT OK-GO SAD RTN
&Q     SETA  &Q+1                       BUMP CRT TO SCAN FEAT LIST RTNS
  AIF ('&FEATURE(&Q)' EQ 'TERMTERM').U3 IS TERMINAL-TO-TERMINAL FEATURE
&SGQUITB  SETB  1                       IF FEAT INLVD SET ERROR SW
    MNOTE 5,'* * * IEIIOD105 &ID-FEATURE VALUE &FEATURE(&Q) INVALID'
         AGO   .TERMTST                 RETURN & SCAN NEXT FEAT
.U3 MNOTE *,'        TERMINAL TO TERMINAL DATA TRANSMISSION '
&SGDF01B(&I)  SETB  1                   SET 1ST GLB FET SW IF TERMTERM
         AGO   .TERMTST                 RETURN & SCAN ANY OTHER FEATURE
.SADTEST AIF (T'&SETADDR EQ 'O').J1       ERROR IS SAD OMIT & NOT 2260
 AIF (&SGCNTRA(2) EQ 0 OR &SGCNTRA(2) GT 255).CHECKX
 AIF (&SGUNT2B(&Z) AND &SGUNU1B(&Z)).J2
         AIF (K'&SETADDR GE 2).J2       ERR IF MORE THAN 1 SAD OR SBLST
 AIF (('&SETADDR' GE '0')AND('&SETADDR' LE '3')).J3   SAD EQ 0,1,2, OR3
    MNOTE 5,'* * * IEIIOD121 &ID-SETADDR VALUE &SETADDR INVALID'
&SGQUITB  SETB  1                       SETADDR VALUE MUST BE 0 TO 3
         AGO   .CHECKX                  BRANCH TO PHYSICAL ADDRESS RTN
.J1 AIF (NOT (&SGUNU2B(&SGCNTRA(2)) AND &SGUNT2B(&SGCNTRA(2)))).CHECKX
 MNOTE 5,'* * * IEIOD122 &ID-SETADDR VALUE NOT SPECIFIED'
&SGQUITB SETB  1                        SETADDR MUST NOT BE OMIITED
         AGO   .CHECKX                  BRANCH TO PHYSICAL ADDRESS RTN
.J2 MNOTE 5,'* * * IEIIOD121 &ID-SETADDR VALUE &SETADDR INVALID'
&SGQUITB  SETB  1                       SETADDR LONGER THAN 1 DIGIT 1
         AGO   .CHECKX                  BRANCH TO PHYSICAL ADDRESS RTN
.J3 MNOTE *,'     SET-ADDRESS-COMMAND &SETADDR SPECIFIED FOR &C '
&SGDM01B(&I)  SETB ('&SETADDR' EQ '0')  SET 1ST SAD SW ON IF SAD = 0
&SGDM02B(&I)  SETB ('&SETADDR' EQ '1')  SET 2ND SAD SW ON IF SAD = 1
&SGDM03B(&I)  SETB ('&SETADDR' EQ '2')  SET 2ND SAD SW ON IF SAD = 2
&SGDM04B(&I)  SETB ('&SETADDR' EQ '3')  SET 4TH SAD SW ON IF SAD = 3
         AGO   .CHECKX                  BR TO PHYSICAL ADDRESS RTN
.DD      ANOP
&SGDUMMY(&I)   SETB  1
         AGO   .CHECKX
.TRMDCHK AIF (T'&TRNMODE EQ 'O').CHECKX     T R N M O D E  R T N
 AIF ('&TRNMODE' NE 'BURST' AND '&TRNMODE' NE 'BYTE').X2
&SGTRMDB(&I) SETB ('&TRNMODE' EQ 'BURST') SW ON = BURST,SW OFF = BYTE
    MNOTE *,'     &TRNMODE TRANMISSION MODE '
         AGO   .CHECKX                  GO TO ADDRESS RTN
.X2 MNOTE 5,'* * * IEIIOD108 &ID-TRNMODE VALUE &TRNMODE INVALID'
&SGQUITB SETB  1                        ERROR IF PARAM INVALID
         AGO    .CHECKX                 GO TO ADDRESS RTN
.AA MNOTE 5,'* * * IEIIOD102 &ID-UNIT VALUE NOT SPECIFIED'
.BADUNIT ANOP
&SGQUITB SETB  1
.CHECKX  AIF  ('&AP' EQ 'NO').CHECKX1                            S21167
         AIF   ('&UNIT' EQ '2314' OR '&UNIT' EQ '3330').CHECKX1  S21167
         AIF   ('&UNIT' EQ '2401' OR '&UNIT' EQ '2415' OR '&UNIT' EQ '2*
               420' OR '&UNIT' EQ '3410' OR '&UNIT' EQ '3420').CHECKX1
    MNOTE 5,'* * * IEIIOD203 AP INVALID FOR &UNIT'               S21167
&SGQUITB SETB 1                                                  S21167
.CHECKX1  AIF  (T'&DEVTYPE EQ 'O').ERRTAB      NO PARM           S21167
&SGDEVB(1)   SETB  1    SET  FOR DEV TAB INSP
&X       SETA  K'&DEVTYPE               COUNT OF DEVTYPE
         AIF   (&X NE 8).O8
&OA      SETC  '&DEVTYPE'(1,1)
&OB      SETC  '&DEVTYPE'(2,1)
&OC      SETC  '&DEVTYPE'(3,1)
&OD      SETC  '&DEVTYPE'(4,1)
&OE      SETC  '&DEVTYPE'(5,1)
&OF      SETC  '&DEVTYPE'(6,1)
&OG      SETC  '&DEVTYPE'(7,1)
&OH      SETC  '&DEVTYPE'(8,1)
         AIF   (NOT((('&OA' GE 'A') AND ('&OA' LE 'F')) OR (('&OA' GE 'X
               0') AND ('&OA' LE '9')))).O8
         AIF   (NOT((('&OB' GE 'A') AND ('&OB' LE 'F')) OR (('&OB' GE 'X
               0') AND ('&OB' LE '9')))).O8
         AIF   (NOT((('&OC' GE 'A') AND ('&OC' LE 'F')) OR (('&OC' GE 'X
               0') AND ('&OC' LE '9')))).O8
         AIF   (NOT((('&OD' GE 'A') AND ('&OD' LE 'F')) OR (('&OD' GE 'X
               0') AND ('&OD' LE '9')))).O8
         AIF   (NOT((('&OE' GE 'A') AND ('&OE' LE 'F')) OR (('&OE' GE 'X
               0') AND ('&OE' LE '9')))).O8
         AIF   (NOT((('&OF' GE 'A') AND ('&OF' LE 'F')) OR (('&OF' GE 'X
               0') AND ('&OF' LE '9')))).O8
         AIF   (NOT((('&OG' GE 'A') AND ('&OG' LE 'F')) OR (('&OG' GE 'X
               0') AND ('&OG' LE '9')))).O8
         AIF   ((('&OH' GE 'A') AND ('&OH' LE 'F')) OR (('&OH' GE '0') X
               AND ('&OH' LE '9'))).VT
.*                                      NOT PROPERLY SPEC
.O8 MNOTE    5,'* * * IEIIOD140 &ID DEVTYPE VALUE &DEVTYPE INVALID'
&SGQUITB  SETB  1
         AGO   .CHECKXX                 CHECK ADDRESSES
.VT      AIF   ('&OE' NE '2').VTT
&SGDASDA SETA  &SGDASDA+1
.VTT MNOTE *,'   UCB DEVICE TYPE &DEVTYPE SET FOR THIS UNIT'
&O       SETC  '&DEVTYPE'(1,6)          FIRST SIX CHAR DEVTYPE
         CONVERT  TO=HEX,VALUE=&O,DIGITS=6
&SGDEVTP(&I)  SETA  &HEX
&O       SETC  '&DEVTYPE'(7,2)          LAST TWO CHAR
         CONVERT  TO=HEX,VALUE=&O,DIGITS=2
&SGETABA(&I)  SETA  &HEX                PASSED IN ERRTAB BOX
.ERRTAB  AIF   (T'&ERRTAB EQ 'O').CHECKXX       NOT SPEC
&SGDEVB(1)  SETB  1         SET FOR SERRTAB INSPECTION
         AIF   (T'&ERRTAB EQ 'N' AND (&ERRTAB GE 0 AND &ERRTAB LE 254))X
               .VE                      NOT PROPERLY SPECIFIED
    MNOTE 5,'***  IEIIOD141 &ID ERRTAB VALUE &ERRTAB INVALID'
&SGQUITB SETB 1
         AGO   .CHECKXX
.VE MNOTE *,'   UCB ERROR TAB INDEX &ERRTAB SET FOR THIS UNIT'
&SGETABA(&I)  SETA  (&ERRTAB+1)*256+&SGETABA(&I)   ERRTAB & DEVTAB
.CHECKXX AIF ('&UNIT' EQ '2314' OR '&UNIT' EQ '2305' OR '&UNIT' EQ '333*
               0' OR '&UNIT' EQ '3505' OR '&UNIT' EQ '3525' OR '&UNIT' *
               EQ '2245').CHECKAD
         AIF   (&SGDT01B(&I) OR &SGDT03B(&I)).IOCSAME
.*       CHECK FOR 1285,1287,1288
 AIF (&SGDT02B(&I) AND &SGDU01B(&I) AND NOT &SGDAD8B(&I)).CHECKAD
 AIF (&SGDT02B(&I) AND &SGDU02B(&I) AND NOT &SGDAD1B(&I)).CHECKAD
 AIF (&SGDT02B(&I) AND &SGDU03B(&I) AND NOT &SGDAD1B(&I)).CHECKAD
.*       CHECK FOR 1403,1404,2540R OR 2540P
         AIF   ((&SGDT06B(&I) AND (&SGDU01B(&I) OR &SGDU02B(&I))) OR (&X
               SGDT07B(&I) AND (&SGDU04B(&I) OR &SGDU05B(&I)))).IOCCH
 AIF (&SGDT06B(&I) AND  &SGDU06B(&I)).IOCSET           3211
 AIF (&SGDT06B(&I) AND (&SGDU04B(&I) OR &SGDU05B(&I))).CHECKAD  1419,
.*                                                              1275
 AIF (&SGDT05B(&I) AND (&SGDU06B(&I) OR &SGDU10B(&I))).CHECKAD  SA65474
 AIF (&SGDT05B(&I) AND NOT(&SGDU01B(&I) AND &SGDM01B(&I))).IOCSET
  AIF (&SGDT07B(&I) AND &SGDU06B(&I)).IOCSET
 AIF (&SGDT08B(&I) OR &SGDT02B(&I)).IOCSET
   AIF  (&SGDT12B(&I) AND (&SGDU01B(&I) OR &SGDU02B(&I))).IOCSET
 AIF (&SGDT12B(&I) AND &SGDU03B(&I)).IOCSET       2265
 AIF (&SGDT12B(&I) AND &SGDU04B(&I)).CHECKAD     7770
 AIF (&SGDT12B(&I) AND &SGDU05B(&I)).CHECKAD NO CU FOR 2955
   AIF   (&SGDT02B(&I) AND &SGDU04B(&I)).IOCSET
 AIF (&SGDT04B(&I) AND &SGDU03B(&I)).CHECKAD    3210
 AIF (&SGDT04B(&I) AND &SGDU04B(&I)).CHECKAD    3215
         AIF   (NOT (&SGDT04B(&I) AND &SGDU01B(&I))).CHECKAD 1052
         AIF   (&SGCNTRA(2) EQ 0).CHECKAD
.*       CHECK FOR LAST IOCONTRL BEING 1051
 AIF (NOT (&SGUNT1B(&SGCNTRA(2)) AND &SGUNU2B(&SGCNTRA(2)))).CHECKAD
         AGO   .IOCSET
.IOCSAME ANOP  DEVICES THAT COME HERE SHOULD HAVE SAME C.U. ADDRESS
.IOCCH   ANOP  DEVICES THAT COME HERE SHOULD HAVE SAME CHAN ADDRESS
.IOCSET AIF (&SGCNTRA(2) EQ 0 OR &SGCNTRA(2) GT 255).NOCU
&IOC     SETB  1  WILL CAUSE SGCNTRA(2) VALUE TO BE PUT INTO SGDADRA
&SGNODEV SETB 0              INDICATE A DEVICE ON C.U.
         AGO   .CHECKAD
.NOCU    ANOP
         MNOTE 5,'* * * IEIIOD130 &ID-IOCONTRL CARD MISSING'
&SGQUITB SETB  1
.CHECKAD  AIF (&MULT).NLOOP
         AIF (T'&ADDRESS EQ 'O').AZ  NO ADDRESS-ERROR
         AIF (K'&ADDRESS(1) NE 3).B2
&ADDR    SETC  '&ADDRESS(1)'
 AIF (NOT(&SGDT06B(&I) AND (&SGDU04B(&I) OR &SGDU05B(&I)))).NLOOP 1419,
.*                                                                 1275
   CONVERT TO=HEX,VALUE=&ADDR,DIGITS=3   ADDR OR 1419 OR 1275 MUST
&DIV SETA &HEX                           BE AN EVEN NUMBER
&QUOT  SETA  &DIV/2
&DIFF  SETA  &QUOT*2
&REM  SETA  &DIV-&DIFF
   AIF  (&REM EQ 0).NLOOP
   MNOTE 5,'* * * IEIIOD145 1419 AND/OR 1275 REQUIRE AN EVEN NUMBERED  *
               ADDRESS'
&SGQUITB SETB  1
         AGO   .OPTCHAN
.NLOOP   AIF   ('&ADDR' EQ 'FFF').B2     ADDR FFF INVALID
&D       SETC  '&ADDR'(1,1)        DIGIT REPRESENTING CHANNEL
&E       SETC  '&ADDR'(2,1)        DIGIT REPRESENTING CTRL UNIT
&F       SETC  '&ADDR'(3,1)        DIGIT REPRESENTING UNIT
 AIF (NOT((('&D' GE 'A')AND('&D' LE 'F'))OR(('&D' GE '0')AND('&D' LE '9*
               ')))).B2
 AIF (NOT((('&E' GE 'A')AND('&E' LE 'F'))OR(('&E' GE '0')AND('&E' LE '9X
               ')))).B2                 IS 2ND ADDRESS DIGIT 0-F
         AIF   ((('&F' GE 'A') AND ('&F' LE 'F')) OR (('&F' GE '0') ANDX
                ('&F' LE '9'))).VAL1    IS 3RD ADDRESS DIGIT 0-F
.B2 MNOTE 5,'* * * IEIIOD110 &ID-ADDRESS VALUE &ADDRESS INVALID'
&SGQUITB SETB  1
         AGO   .OPTCHAN                 GO TO OPTIONAL CHANNEL PATH RTN
.AZ MNOTE 5,'* * * IEIIOD111 &ID-ADDRESS VALUE NOT SPECIFIED'
&SGQUITB SETB  1
         AGO   .OPTCHAN
.BM2 MNOTE 5,'* * * IEIIOD112 &ID-ADDRESS MULTIPLIER VALUE &ADDRESS(2) X
               INVALID'
&SGQUITB SETB  1
         AGO   .OPTCHAN
.VAL1    AIF (&MULT).VALIDX
 AIF ('&UNIT' EQ '2314' OR '&UNIT' EQ '3330' OR '&UNIT' EQ '2305').VAL2
&M       SETA  1
.VAL2    AIF (N'&ADDRESS EQ 1).VALIDX        NOT A MULTIPLE ADDRESS
         AIF (N'&ADDRESS NE 2).B2
         AIF (T'&ADDRESS(2) EQ 'O').VALIDX
         AIF (&ADDRESS(2) LT 1).BM2
 AIF ('&UNIT' EQ '2305').BM2
&M       SETA  &ADDRESS(2)
.VALIDX  ANOP
         CONVERT  TO=HEX,VALUE=&ADDR,DIGITS=3
&SGDADRA(&I) SETA 1048576*&I+4096*&IOC*&SGCNTRA(2)+&HEX
    MNOTE *,'     ADDRESS &ADDR SPECIFIED '
         AIF   (NOT(&SGDT01B(&I) OR &SGDT03B(&I) OR (&SGDT05B(&I) AND &*
               SGDU01B(&I)))).CHKER     TEST FOR TAPE, DA, OR 2250
&H   SETA  &HEX/256                     USE CHN ADR FOR BRST DEV SUBSPT
&SGBRSTB(&H+1)  SETB  1                 TURN ON SW FOR CHAN W/BRST DEV
         AGO   .OPTCHAN
.CHKER   AIF   (NOT &CHKSW).OPTCHAN  HAS 1419, OR 1275 BEEN SPECIFIED
&HEX  SETA  &HEX+1                   YES
&SGDADRA(&I+1) SETA 1048576*&I+4096*&IOC*&SGCNTRA(2)+&HEX
&SGCNTRA(3)  SETA  &SGCNTRA(3)+1
&CHKSW  SETB  0
.OPTCHAN AIF (T'&OPTCHAN EQ 'O').RDWT   IF OMIT GO SEE IF 2400-RDWT DEV
         AIF (&ML NE 3 AND &ML NE 1).B3 ARE OPTCHAN PERMITTED THIS DEV
         AIF (('&UNIT' EQ '2305') AND &SGDF02B(&I)).INCFET2
 AIF (&Z EQ 0 OR &Z GT 255).IODSHAR
 AIF (&IOC AND &SGUNF5B(&Z)).INCFET2         THIS C.U. SHARED
.IODSHAR ANOP
         AIF   (&J).B4                  OPTCHAN UNDIAGNOSIBL IF ADR BAD
         AIF (N'&OPTCHAN LE &ML).B5     OPTCHAN SPEC EXCEED ALLWBLE NO.
&E       SETC  ''                       CLEAR OUT 2ND ADDR DGT FOR MSG
         AIF  (NOT(&SGDT01B(&I) AND &SGDF03B(&I))).B8
&B       SETC   ' WITH RE'              ALTER M N O T E IF READWRT SPCD
&E       SETC   'ADWRITE'
.B8 MNOTE 5,'* * * IEIIOD123 &ID-TOO MANY OPTCHAN VALUES'
&SGQUITB SETB  1
.B5      ANOP
&A       SETA  1
.LOOP5   ANOP
&N SETC '&OPTCHAN(&A)'
 AIF (N'&OPTCHAN EQ 1 AND (K'&OPTCHAN EQ 2 OR K'&OPTCHAN EQ 4)).SUBOPT
 AIF (N'&OPTCHAN EQ 2 AND K'&OPTCHAN EQ 7).SUBOPT
 AIF (N'&OPTCHAN EQ 3 AND K'&OPTCHAN EQ 10).SUBOPT
 AIF ((('&N' GE '1')AND('&N' LE '9'))OR(('&N' GE 'A')AND('&N' LE 'F')))*
               .OK
 AGO .BG           INVALID OPTCHAN ON SELECTOR OR MULTIPLEXOR
.SUBOPT ANOP
&N SETC '&OPTCHAN(&A)'(1,1)        CHANNEL PORTION
&F SETC '&ADDR'(1,1)
 AIF ('&N' NE '&F').B6
&N SETC '&OPTCHAN(&A)'(2,1)    GET C.U. PORTION
&F SETC '&ADDR'(2,1)
 AIF ('&F' LE 'B' OR '&F' GE 'F').B6
 AIF ('&N' LE '&F').BG     INVALID OPTCHAN FOR THIS ADDRESS
 AIF ('&N' EQ 'D').B5D
 AIF ('&N' EQ 'E').B5E
 AIF ('&N' EQ 'F').B5F
.BG MNOTE 5,'* * * IEIIOD112 &ID-OPTCHAN VALUE &OPTCHAN(&A) INVALID'
&SGQUITB SETB  1
         AGO   .NEXTOPT
.B5D ANOP
&ALT(2) SETB 1             OPTCHAN WITH SELECTOR SUB D
.BH MNOTE *,'     OPTIONAL CHANNEL PATH &OPTCHAN(&A)'
&SGOPSUB(&I) SETB 1   OPTCHAN ON SELECTOR SUB CH FOR THIS DEVICE
 AGO .B7ALT
.B5E ANOP
&ALT(3) SETB 1             OPTCHAN WITH SELECTOR SUB E
 AGO .BH
.B5F ANOP
&ALT(4) SETB 1             OPTCHAN WITH SELECTOR SUB F
 AGO .BH
.OK      AIF   ('&D' EQ 'F').BG        OPTCHAN OF F
 CONVERT TO=HEX,DIGITS=1,VALUE=&D
&CB      SETA  &HEX
 CONVERT TO=HEX,DIGITS=1,VALUE=&OPTCHAN(&A)
&H       SETA  &HEX
 AIF (&H GT &CB).B7
 AGO .BG
.B7 MNOTE *,'     OPTIONAL CHANNEL PATH &OPTCHAN(&A) '
&ALT(&H) SETB 1
.B7ALT ANOP
&SGOPCHA SETA &SGOPCHA+1
         AIF  (NOT &SGDT03B(&I)).BDASD
&SGDCLSB(83)   SETB  1            DASD WITH OPTCHAN
.BDASD  AIF (&SGOPCHA LE 128).NEXTOPT
    MNOTE 5,'* * * IEIIOD112 MAXIMUM OF 128 OPTIONAL PATHS EXCEEDED'
&SGQUITB SETB 1
.NEXTOPT AIF   (&A EQ N'&OPTCHAN).ON15  ALL OPTCHAN PARAMETERS CHECKED.
&A       SETA  &A+1
         AGO   .LOOP5
.ON15    ANOP
&SGDAP1B(&I)   SETB (&ALT(1))           GLOBAL ALTERNATE PATH
&SGDAP2B(&I)   SETB (&ALT(2))           SWITCHES 1-6
&SGDAP3B(&I)   SETB (&ALT(3))
&SGDAP4B(&I)   SETB (&ALT(4))
&SGDAP5B(&I)   SETB (&ALT(5))
&SGDAP6B(&I)   SETB (&ALT(6))
&SGDAP7B(&I)   SETB (&ALT(7))
&SGDAP8B(&I)   SETB (&ALT(8))
&SGDAP9B(&I)   SETB (&ALT(9))
&SGDAPAB(&I)   SETB (&ALT(10))
&SGDAPBB(&I)   SETB (&ALT(11))
&SGDAPCB(&I)   SETB (&ALT(12))
&SGDAPDB(&I)   SETB (&ALT(13))
&SGDAPEB(&I)   SETB (&ALT(14))
&SGDAPFB(&I)   SETB (&ALT(15))
         AGO   .RQSTEST                 IF DONE BR TO IOREQUE SCAN
.INCFET2 MNOTE 5,'* * * IEIIOD112 &ID-OPTCHAN AND SHARED MUTUALLY EXCLU*
               SIVE'
&SGQUITB SETB 1
         AGO   .RQSTEST
.B3 MNOTE 5,'* * * IEIIOD113 &ID-OPTCHAN VALUES INVALID ON &UNIT'
&SGQUITB SETB  1
         AGO  .RQSTEST                  BR TO IO REQUEST QUE RTN
.B4      AGO   .RQSTEST
.B6 MNOTE 5,'* * * IEIIOD112 &ID-OPTCHAN VALUE &OPTCHAN INVALID'
&SGQUITB  SETB   1
         AGO   .RQSTEST
.RDWT AIF (NOT(&SGDT01B(&I) AND &SGDF03B(&I))).RQSTEST
&SGQUITB SETB   1                       IF 2400RDWT,1 AND ONLY 1 OP RQD
    MNOTE 5,'* * * IEIIOD112 &ID-OPTCHAN VALUE OMITTED'
.RQSTEST AIF (T'&IOREQUE EQ 'O').Y1   IF NULL, ASSUME FIFO
 AIF ('&IOREQUE' NE 'FIFO' AND '&IOREQUE' NE 'PRIORITY' AND '&IOREQUE' *
               NE 'ORDERED').Y2
 AIF ('&IOREQUE' EQ 'ORDERED' AND NOT &SGDT03B(&I)).Y2
 AIF ('&IOREQUE' EQ 'ORDERED' AND NOT(&SGDU03B(&I) OR &SGDU04B(&I) OR &*
               SGDU06B(&I) OR &SGDU07B(&I))).Y2                  S99235
&SGDRQ1B(&I) SETB ('&IOREQUE' EQ 'PRIORITY') SW ON=PRIOR'TY,SW OFF=FIFO
&SGDRQ2B(&I) SETB ('&IOREQUE' EQ 'ORDERED')
&F     SETC  ''                         CLR FIFO SKQU OR LO ORD ADR CHR
         AGO   .Y3                      GO PRT QUEUEING OPTION
.Y1       ANOP                          IF NO OPT , ASSUME FIFO
&F      SETC   'FIFO'                   LEAVE SW 1 OFF-PUT FIFO IN MSG
.Y3 MNOTE *,'     &F&IOREQUE I/O REQUEST QUEUEING FOR &UNIT '
         AGO   .MEND                    EXIT FROM IODEVICE MACRO
.Y2 MNOTE 0,'* * * IEIIOD124 ORDERED QUEUEING INVALID THIS DEVICE - FIF*
               O DEFAULTED'
         AGO   .MEND
.MX MNOTE 5,'* * * IEIIOD135 &ID-MAXIMUM NUMBER OF DEVICES EXCEEDED'
&SGQUITB SETB  1
         AGO   .MEND
.MY MNOTE 5,'* * * IEIIOD136 &ID-MAXIMUM NUMBER DEVICE MASK ENTRIES EXC*
               EEDED'
&SGQUITB  SETB 1
.MEND    AIF (&MULT).SECOND
&L       SETA  1
.SECOND  AIF (&SGQUITB).MEND1
 AIF ('&UNIT' NE '2314' AND '&UNIT' NE '3330' AND '&UNIT' NE '2305').Z0*
               2
         AIF (&M NE 0).Z01
         AIF   ('&UNIT' EQ '3330').Z005
&M       SETA  8
         AGO   .Z01
.Z005    ANOP
&M       SETA  2
.Z01     AIF (&M LT 1 OR &M GT 8).Z03                         OS69755
 AIF ('&UNIT' EQ '2305').Z02
&SGDM01B(&I)   SETB (&M EQ 1)           GLOBAL MODEL SWITCH 1
&SGDM02B(&I)   SETB (&M EQ 2)           GLOBAL MODEL SWITCH 2
&SGDM03B(&I)   SETB (&M EQ 3)           GLOBAL MODEL SWITCH 3
&SGDM04B(&I)   SETB (&M EQ 4)           GLOBAL MODEL SWITCH 4
&SGDM05B(&I)   SETB (&M EQ 5)           GLOBAL MODEL SWITCH 5
&SGDM06B(&I)   SETB (&M EQ 6)           GLOBAL MODEL SWITCH 6
&SGDM07B(&I)   SETB (&M EQ 7)           GLOBAL MODEL SWITCH 7
&SGDM08B(&I)   SETB (&M EQ 8)           GLOBAL MODEL SWITCH 8
.* 95950017                                                    OS69755
.Z011    AIF (&MULT).Z02
 AIF ('&UNIT' NE '2314').Z01A
&SG2314A SETA &SG2314A+9-&M
 AGO .Z02
.Z01A ANOP
&SG3330A SETA &SG3330A+&M-1
.Z02  AIF (&L EQ &M).MEND1
&MULT    SETB  1
&L       SETA  &L+1
         CONVERT  TO=HEX,VALUE=&ADDR,DIGITS=3
&HEX     SETA  &HEX+1
         CONVERT  TO=EBCDIC,DIGITS=3,VALUE=&HEX
&ADDR    SETC  '&EBCDIC'
&A       SETA  0
&Q       SETA  0
         AGO   .ADLOOP
.Z03   MNOTE 5,'* * * IEIIOD137 &ID-ADDRESS MULTIPLIER VALUE &M INVALIDX
                FOR &UNIT'
&SGQUITB SETB  1
.MEND1 ANOP
&SGQUITB SETB  (&QUIT OR &SGQUITB)
   MEND

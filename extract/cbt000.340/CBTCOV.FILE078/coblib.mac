         MACRO
         COBLIB  &DESIGN=,&UNIT=,&VOLNO=
  COPY  SGGBLPAK
         LCLC  &C
         AIF   ('&DESIGN' EQ '').E2  CHECK VALIDITY OF DESIGN VALUE
         AIF ('&DESIGN' EQ 'F').E3
         AIF ('&DESIGN' NE 'E' AND '&DESIGN' NE 'U').E4
         AIF (('&DESIGN' EQ 'E' AND &SGCOBLB(1)) OR ('&DESIGN' EQ 'U' A*
               ND &SGCOBLB(3))).E6
.*  ERROR IF EITHER LEVEL WAS PREVIOUSLY CALLED
    MNOTE *,'      COBOL LIBRARY LEVEL &DESIGN SPECIFIED'
&SGCOBLB(1)  SETB  (('&DESIGN' EQ 'E') OR &SGCOBLB(1))
&SGCOBLB(3) SETB (('&DESIGN' EQ 'U') OR &SGCOBLB(3))
&SGMENTB(38)   SETB  1
 AIF  ('&DESIGN' NE 'U').COB1
.COB1 AIF   (N'&UNIT EQ N'&VOLNO).COB2    BOTH PRESENT/BOTH NULL
    MNOTE 5,'* * * IEICOL102 UNIT VALUE OR VOLNO VALUE MISSING'
         AGO   .CBQUIT
.COB2  AIF  ('&UNIT' EQ '').M1
         AIF   (K'&UNIT LE 8).COB3           UNIT NAME SHORT ENOUGH
    MNOTE 5,'* * * IEICOL103 UNIT VALUE &UNIT INVALID'
&SGQUITB  SETB  1
.COB3    AIF   (K'&VOLNO LE 6).COB4          VOL. NO. SHORT ENOUGH
    MNOTE 5,'* * * IEICOL104 VOLNO VALUE &VOLNO INVALID'
         AGO   .CBQUIT
.COB4    ANOP
&SGCTRLC(17)   SETC   '&UNIT'
&SGCTRLC(18)   SETC   '&VOLNO'
         MEXIT
.M1 MNOTE *,'      COBOL LIBRARY WILL RESIDE ON SYSRES'
         MEXIT
.E2 MNOTE 5,'* * * IEICOL105 DESIGN LEVEL NOT SPECIFIED'
         AGO   .CBQUIT
.E3 MNOTE 5,'* * * IEICOL108 DESIGN VALUE &DESIGN NOT SUPPORTED IN THIS*
                RELEASE'
         AGO   .CBQUIT
.E4 MNOTE 5,'* * * IEICOL106 DESIGN VALUE &DESIGN INVALID'
         AGO   .CBQUIT
.E6 MNOTE 5,'* * * IEICOL107 DESIGN LEVEL &DESIGN PREVIOUSLY SPECIFIED'
         AGO   .CBQUIT
.CBQUIT  ANOP
&SGQUITB SETB  1
         MEND

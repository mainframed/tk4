         MACRO
  UCS &UNIT=1403,&IMAGE=,&DEFAULT=
         COPY  SGGBLPAK
         LCLA  &A,&B,&C
         AIF   ('&UNIT' EQ '1403' AND &SGUCSEB(1) OR '&UNIT' EQ '3211' *
               AND &SGUCSEB(2)).E1
&SGMENTB(19)  SETB  1                   ENTRY SWITCH ON
         AIF   ('&UNIT' NE '1403' AND '&UNIT' NE '3211').E2
    MNOTE *,'      &UNIT UCS'
         AIF   ('&UNIT' EQ '3211').R1
&SGUCSEB(1)    SETB 1
.IMAGE   AIF   (T'&IMAGE NE 'O').IM1    IMAGE MUST BE SPECIFIED
    MNOTE 5,'* * * IEIUCS002 IMAGE CHARACTER SET-ID MUST BE SPECIFIED'
&SGQUITB SETB  1
         AGO   .FREE                    ***** FREE LABEL *****
.IM1     AIF   (&A EQ N'&IMAGE).DEFAULT
&A       SETA  &A+1
.IAN     AIF   ('&IMAGE(&A)' NE 'AN').IHN
&C       SETA  1
         AGO   .ICHK
.IHN     AIF   ('&IMAGE(&A)' NE 'HN').IPCAN
&C       SETA  2
         AGO   .ICHK
.IPCAN   AIF   ('&IMAGE(&A)' NE 'PCAN').IPCHN
&C       SETA  3
         AGO   .ICHK
.IPCHN   AIF   ('&IMAGE(&A)' NE 'PCHN').IPN
&C       SETA  4
         AGO   .ICHK
.IPN     AIF   ('&IMAGE(&A)' NE 'PN').IQN
&C       SETA  5
         AGO   .ICHK
.IQN     AIF   ('&IMAGE(&A)' NE 'QN').IRN
&C       SETA  6
         AGO   .ICHK
.IRN     AIF   ('&IMAGE(&A)' NE 'RN').ISN
&C       SETA  7
         AGO   .ICHK
.ISN     AIF   ('&IMAGE(&A)' NE 'SN').ITN
&C       SETA  8
         AGO   .ICHK
.ITN     AIF   ('&IMAGE(&A)' NE 'TN').IXN
&C       SETA  9
         AGO   .ICHK
.IXN     AIF   ('&IMAGE(&A)' NE 'XN').IYN
&C       SETA  10
         AGO   .ICHK
.IYN     AIF   ('&IMAGE(&A)' NE 'YN').IQNC
&C       SETA  11
         AGO   .ICHK
.IQNC    AIF   ('&IMAGE(&A)' NE 'QNC').IER
&C       SETA  12
         AGO   .ICHK
.IER MNOTE 5,'* * * IEIUCS004 IMAGE ID &IMAGE(&A) IS INVALID'
&SGQUITB SETB  1
         AGO   .IM1
.ICHK AIF (&SGUCSIB(&C)).IREDUND        ID PREVIOUSLY SPECIFIED
&SGUCSIB(&C)  SETB  1
    MNOTE *,'       CHARACTER SET IMAGE WITH &IMAGE(&A)-ID INCLUDED'
         AGO   .IM1
.IREDUND MNOTE 5,'* * * IEIUCS005 IMAGE ID &IMAGE(&A) IS REDUNDANT'
&SGQUITB SETB  1
         AGO   .IM1
.DEFAULT AIF   (T'&DEFAULT EQ 'O').FREE   *****FREE LABEL *****
.DEF1    AIF   (&B EQ N'&DEFAULT).FREE       ***** FREE LABEL *****
&B       SETA  &B+1
.DAN     AIF   ('&DEFAULT(&B)' NE 'AN').DHN
&C       SETA  1
         AGO   .DCHK
.DHN     AIF   ('&DEFAULT(&B)' NE 'HN').DPCAN
&C       SETA  2
         AGO   .DCHK
.DPCAN   AIF   ('&DEFAULT(&B)' NE 'PCAN').DPCHN
&C       SETA  3
         AGO   .DCHK
.DPCHN   AIF   ('&DEFAULT(&B)' NE 'PCHN').DPN
&C       SETA  4
         AGO   .DCHK
.DPN     AIF   ('&DEFAULT(&B)' NE 'PN').DQN
&C       SETA  5
         AGO   .DCHK
.DQN     AIF   ('&DEFAULT(&B)' NE 'QN').DRN
&C       SETA  6
         AGO   .DCHK
.DRN     AIF   ('&DEFAULT(&B)' NE 'RN').DSN
&C       SETA  7
         AGO   .DCHK
.DSN     AIF   ('&DEFAULT(&B)' NE 'SN').DTN
&C       SETA  8
         AGO   .DCHK
.DTN     AIF   ('&DEFAULT(&B)' NE 'TN').DXN
&C       SETA  9
         AGO   .DCHK
.DXN     AIF   ('&DEFAULT(&B)' NE 'XN').DYN
&C       SETA  10
         AGO   .DCHK
.DYN     AIF   ('&DEFAULT(&B)' NE 'YN').DQNC
&C       SETA  11
         AGO   .DCHK
.DQNC    AIF   ('&DEFAULT(&B)' NE 'QNC').DER
&C       SETA  12
         AGO   .DCHK
.DER MNOTE 5,'* * * IEIUCS007 DEFAULT ID &DEFAULT(&B) IS INVALID'
&SGQUITB SETB  1
         AGO   .DEF1
.DCHK    AIF   (&SGUCSDB(&C)).DREDUND   DEFAULT ID SPECIFIED PREVIOUSLY
&SGUCSDB(&C)  SETB  1
         AIF   (NOT &SGUCSIB(&C)).NOIMAGE
   MNOTE *,'       DEFAULT CHARACTER SET WITH &DEFAULT(&B)-ID INCLUDED'
         AGO   .DEF1
.DREDUND MNOTE 5,'* * * IEIUCS008 DEFAULT ID &DEFAULT(&B) IS REDUNDANT'
&SGQUITB SETB  1
         AGO   .DEF1
.NOIMAGE MNOTE 5,'* * * IEIUCS009 DEFAULT CHARACTER SET &DEFAULT(&B) MUS
               ST BE SPECIFIED IN IMAGE PARAMETER'
&SGQUITB SETB  1
         AGO   .DEF1
.FREE    AGO   .MEND          FREE LABEL
.R1      ANOP
&SGUCSEB(2)    SETB 1
         AIF   (T'&IMAGE NE 'O').RM1    IMAGE MUST BE SPECIFIED
    MNOTE 5,'* * * IEIUCS002 IMAGE CHARACTER SET-ID MUST BE SPECIFIED'
&SGQUITB SETB  1
         AGO   .MEND
.RM1     AIF   (&A EQ N'&IMAGE).V1
&A       SETA  &A+1
.RA11    AIF   ('&IMAGE(&A)' NE 'A11').RH11
&C       SETA  1
         AGO   .RCHK
.RH11    AIF   ('&IMAGE(&A)' NE 'H11').RG11
&C       SETA  2
         AGO   .RCHK
.RG11    AIF   ('&IMAGE(&A)' NE 'G11').RP11
&C       SETA  3
         AGO   .RCHK
.RP11    AIF   ('&IMAGE(&A)' NE 'P11').RT11
&C       SETA  4
         AGO   .RCHK
.RT11    AIF   ('&IMAGE(&A)' NE 'T11').RER
&C       SETA  5
         AGO   .RCHK
.RER MNOTE 5,'* * * IEIUCS004 IMAGE ID &IMAGE(&A) IS INVALID'
&SGQUITB SETB  1
         AGO   .RM1
.RCHK    AIF   (&SG2CSIB(&C)).RREDUND       ID PREVIOUSLY SPECIFIED
&SG2CSIB(&C)   SETB 1
    MNOTE *,'      CHARACTER SET IMAGE WITH &IMAGE(&A)-ID INCLUDED'
         AGO   .RM1
.RREDUND MNOTE 5,'* * * IEIUCS005 IMAGE ID &IMAGE(&A) IS REDUNDANT'
&SGQUITB SETB  1
         AGO   .RM1
.V1      AIF   (T'&DEFAULT EQ 'O').MEND
.VD1     AIF   (&B EQ N'&DEFAULT).MEND
&B       SETA  &B+1
.VA11    AIF   ('&DEFAULT(&B)' NE 'A11').VH11
&C       SETA  1
         AGO   .VCHK
.VH11    AIF   ('&DEFAULT(&B)' NE 'H11').VG11
&C       SETA  2
         AGO   .VCHK
.VG11    AIF   ('&DEFAULT(&B)' NE 'G11').VP11
&C       SETA  3
         AGO   .VCHK
.VP11    AIF   ('&DEFAULT(&B)' NE 'P11').VT11
&C       SETA  4
         AGO   .VCHK
.VT11    AIF   ('&DEFAULT(&B)' NE 'T11').VER
&C       SETA  5
         AGO   .VCHK
.VER MNOTE 5,'* * * IEIUCS007 DEFAULT ID &DEFAULT(&B) IS INVALID'
&SGQUITB SETB  1
         AGO   .VD1
.VCHK    AIF   (&SG2CSDB(&C)).VREDUND   DEFAULT ID SPECIFEID PREVIOUSLY
&SG2CSDB(&C)   SETB 1
         AIF   (NOT &SG2CSIB(&C)).VNOIM
    MNOTE *,'      DEFAULT CHARACTER SET WITH &DEFAULT(&B)-ID INCLUDED'
         AGO   .VD1
.VREDUND MNOTE 5,'* * * IEIUCS008 DEFAULT ID &DEFAULT(&B) IS REDUNDANT'
&SGQUITB SETB  1
         AGO   .VD1
.VNOIM MNOTE 5,'* * * IEIUCS009 DEFAULT CHARACTER SET &DEFAULT(&B) MUSTX
               BE SPECIFIED IN IMAGE PARAMETER'
&SGQUITB SETB  1
         AGO   .VD1
.E1 MNOTE 5,'* * * IEIUCS001 &UNIT UCS PREVIOUSLY SPECIFIED'
&SGQUITB SETB  1
         AGO   .MEND
.E2 MNOTE 5,'* * * IEIUCS010 UNIT VALUE &UNIT IS INVALID'
&SGQUITB SETB  1
.MEND    MEND

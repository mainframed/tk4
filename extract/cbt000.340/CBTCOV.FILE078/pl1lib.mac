         MACRO
    PL1LIB  &UNIT=,&VOLNO=,&LIBFCNS=REAL,&MODES=,&STORG=,&CONVS=,&STRGS*
               =,&ARRAY=,&MATHS=,&STRIO=,&RECIO=
         COPY  SGGBLPAK
   LCLB  &TASKSW
   LCLB  &NOTKSW
   LCLB  &REALSW
   LCLB  &CMPXSW
    LCLA &A
  LCLB  &SW
         AIF   (NOT &SGMENTB(49)).PL11
    MNOTE 5,'* * * IEIPLL101 PL1LIB MACRO PREVIOUSLY USED'
         AGO  .PLQUIT
.PL11    ANOP
&SGMENTB(49)   SETB  1
         AIF   (N'&UNIT EQ N'&VOLNO).PL12
    MNOTE 5,'* * * IEIPLL102 UNIT VALUE OR VOLNO VALUE MISSING'
         AGO   .PLQUIT
.PL12  AIF  ('&UNIT' EQ '').M1
         AIF   (K'&UNIT LE 8).PL13
    MNOTE 5,'* * * IEIPLL103 UNIT VALUE &UNIT INVALID'
&SGQUITB  SETB  1
.PL13    AIF   (K'&VOLNO LE 6).PL14
    MNOTE 5,'* * * IEIPLL104 VOLNO VALUE &VOLNO INVALID'
.PL14    ANOP
.AG AIF ('&LIBFCNS' NE 'REAL' AND '&LIBFCNS' NE 'COMPLEX').EH
&SGPL11B(47)  SETB  ('&LIBFCNS' EQ 'COMPLEX')
&SGPL11B(46)  SETB  ('&LIBFCNS' EQ 'REAL')
    MNOTE *,'      LIBRARY FUNCTIONS INCLUDED ARE &LIBFCNS'
&SGCTRLC(35)   SETC   '&UNIT'
&SGCTRLC(36)   SETC   '&VOLNO'
.*** SHARED LIBRARY FEATURE HANDLING ***  NOTE: FROM HERE UP TO AND
.*   INCLUDING SECTION MARKED RECIO/NOTK IS THE PL1LIB SHARED LIB
.*   FEATURE. IT SHOULD BE TREATED AS A WHOLE WHEN CONSIDERING
.*   MODIFICATIONS
         AIF   (T'&MODES NE 'O').PL15    MODES PARAMETER IS SPECIFIED
         AIF   ((T'&STORG NE 'O') OR (T'&CONVS NE 'O') OR (T'&STRGS NE *
               'O') OR (T'&ARRAY NE 'O') OR (T'&MATHS NE 'O') OR (T'&ST*
               RIO NE 'O') OR (T'&RECIO NE 'O')).E0
         AGO   .END                NO SHARED LIBRARY FEATURE
.PL15    AIF   ('&MODES(1)' EQ 'TASK').PL16
         AIF   ('&MODES(1)' EQ 'NOTK').PL17
         AGO  .E1                  TASK OR NOTK NOT SPECIFIED
.PL16    MNOTE *,'      MULTI-TASKING ENVIRONMENT'
&TASKSW  SETB  1
&SGPL11B(95)   SETB 1
         AGO  .PL18
.PL17    MNOTE *,'      NON-TASKING ENVIRONMENT'
&NOTKSW  SETB  1
&SGPL11B(96)   SETB 1
.PL18    MNOTE *,'      SHARED LIBRARY FEATURE SPECIFIED'
&SGPL11B(94)   SETB 1
&A  SETA 2
.UP      AIF   ('&MODES(&A)' EQ '').PL25
         AIF   ('&MODES(&A)' EQ 'REAL').PL19
         AIF   ('&MODES(&A)' EQ 'CMPX').PL20
         AGO   .E2
.PL19    MNOTE *,'      REAL ARITHMETIC ENVIRONMENT'
&REALSW  SETB  1
.MORE    AIF   (&A EQ 3).PL24
         AIF   (N'&MODES EQ &A).PL24
&A  SETA &A+1
         AGO   .UP
.PL20    MNOTE *,'      COMPLEX ARITHMETIC ENVIRONMENT'
&CMPXSW  SETB  1
         AGO   .MORE
.PL24    AIF   (&CMPXSW AND NOT &SGPL11B(47)).E4
.PL25    AIF   (T'&STRGS EQ 'O').PL29         ***** STRGS *****
&A  SETA  1
.RECK1   AIF   ('&STRGS(&A)' EQ 'BIT').PL26
         AIF   ('&STRGS(&A)' EQ 'CHAR').PL27
         AIF   ('&STRGS(&A)' EQ 'STR').PL28
     AGO .E5
.PL26    MNOTE *,'      BIT STRING HANDLING FUNCTIONS'
&SGPL11B(107)  SETB 1
.OPCK1   AIF   (&A EQ 3).PL29
         AIF   (N'&STRGS EQ &A).PL29
&A  SETA &A+1
         AGO   .RECK1
.PL27    MNOTE *,'      CHARACTER STRING HANDLING FUNCTIONS'
&SGPL11B(108) SETB 1
         AGO   .OPCK1                        CHECK IF MORE OPERANDS
.PL28    MNOTE *,'      STRING HANDLING BUILT/IN/FUNCTIONS'
&SGPL11B(109) SETB  1
         AGO   .OPCK1                        CHECK FOR MORE OPERANDS
.PL29    AIF   (T'&CONVS EQ 'O').PL37           ***** CONVS *****
&A  SETA  1
.RECK2   AIF   ('&CONVS(&A)' EQ 'EDIT').PL30
         AIF   ('&CONVS(&A)' EQ 'BIT').PL31
         AIF   ('&CONVS(&A)' EQ 'CHAR').PL32
         AIF   ('&CONVS(&A)' EQ 'PICT').PL33
         AIF   ('&CONVS(&A)' EQ 'STERL').PL34
         AIF   ('&CONVS(&A)' EQ 'OPT1').PL35
         AIF   ('&CONVS(&A)' EQ 'BASIC').PL36
     AGO .E6
.PL30    MNOTE *,'      EDIT CONVERSION'
&SGPL11B(100) SETB  1
.OPCK2   AIF   (&A EQ 7).PL37            7 DIFFERENT POSSIBLE OPERANDS
         AIF   (N'&CONVS EQ &A).PL37     HAVE ALL OPERANDS BEEN CHECKED
&A  SETA  &A+1
         AGO   .RECK2
.PL31    MNOTE *,'      BIT CONVERSION'
&SGPL11B(102) SETB  1
         AGO   .OPCK2                   CHECK FOR MORE OPERANDS
.PL32    MNOTE *,'      CHARACTER CONVERSION'
&SGPL11B(103) SETB  1
         AGO   .OPCK2                   CHECK FOR MORE OPERANDS
.PL33    MNOTE *,'      PICTURE CONVERSION'
&SGPL11B(104) SETB  1
         AGO   .OPCK2                   CHECK FOR MORE OPERANDS
.PL34    MNOTE *,'      STERLING CONVERSION'
&SGPL11B(105) SETB  1
         AGO   .OPCK2                   CHECK FOR MORE OPERANDS
.PL35    MNOTE *,'      OPTIMIZATION'
&SGPL11B(106) SETB  1
         AGO   .OPCK2                   CHECK FOR MORE OPERANDS
.PL36    AIF   (&REALSW).PL36A
         AIF   (&CMPXSW).PL36B
   MNOTE 5,'* * * IEIPLL130 REAL AND/OR CMPX MUST BE SPECIFIED WITH    *
               THE MODES KEYWORD IF CONVS=BASIC IS INCLUDED'
&SGQUITB SETB  1
.PL36A   ANOP
&SGPL11B(99) SETB  1
         AIF   (NOT &CMPXSW).MS
.PL36B   ANOP
&SGPL11B(101) SETB 1
.MS MNOTE *,'      BASIC CONVERSION'
         AGO   .OPCK2                   CHECK FOR MORE OPERANDS
.PL37    AIF   (T'&STORG EQ 'O').PL41             ***** STORG *****
&A  SETA  1
.RECK3   AIF   ('&STORG(&A)' EQ 'ERR').PL38
         AIF   ('&STORG(&A)' EQ 'LISTP').PL39
     AGO .E7                                 INVALID OPERAND
.PL38    MNOTE *,'      ERROR HANDLING'
&SGPL11B(97) SETB  1
.OPCK3   AIF   (&A EQ 2).PL41          2 DIFFERENT POSSIBLE OPERANDS
         AIF   (N'&STORG EQ &A).PL41    HAVE ALL OPERANDS BEEN CHECKED
&A  SETA  &A+1
         AGO   .RECK3
.PL39    MNOTE *,'      LIST PROCESSING'
&SGPL11B(98) SETB  1
         AGO   .OPCK3                   CHECK FOR MORE OPERANDS
.PL41    AIF   ((T'&MATHS EQ 'O') AND (T'&ARRAY EQ 'O')).PL41A
         AIF   (&REALSW OR &CMPXSW).PL41A
   MNOTE 5,'* * * IEIPLL131 REAL AND/OR CMPX MUST BE SPECIFIED WITH    *
               THE MODES KEYWORD IF MATHS OR ARRAY ARE INCLUDED'
&SGQUITB SETB  1
         AGO   .PL44         SYNTAX CHECK ONLY
.PL41A   AIF   (&REALSW).PL44
.PL45    AIF   (&CMPXSW).PL46
.PL49    AIF   (&TASKSW).PL47
         AGO   .PL49A
.PL44    AIF   (T'&ARRAY EQ 'O').PL50             ***** ARRAY *****
&A  SETA  1
.RECK4   AIF   ('&ARRAY(&A)' EQ 'BASIC').PL51
         AIF   ('&ARRAY(&A)' EQ 'LEAF').PL52
     AGO .E8                                      INVALID OPERAND
.PL51    MNOTE *,'      REAL, BASIC ARRAY HANDLING'
&SGPL11B(110) SETB  1
.OPCK4   AIF   (&A EQ 2).PL50
         AIF   (N'&ARRAY EQ &A).PL50
&A  SETA &A+1
         AGO   .RECK4
.PL52    MNOTE *,'      REAL, INTERLEAVED ARRAYS'
&SGPL11B(111) SETB  1
         AGO   .OPCK4                   CHECK FOR MORE OPERANDS
.PL50    AIF   (T'&MATHS EQ 'O').PL45        IS CMPX ALSO SPECIFIED?
&A  SETA 1
.RECK5   AIF   ('&MATHS(&A)' EQ 'BASIC').PL54
         AIF   ('&MATHS(&A)' EQ 'SHORT').PL55
         AIF   ('&MATHS(&A)' EQ 'LONG').PL56
     AGO .E9                                 INVALID OPERAND
.PL54    MNOTE *,'      REAL, BASIC ARITHMETIC FUNCTIONS'
&SGPL11B(114) SETB  1
.OPCK5   AIF   (&A EQ 3).PL45                   3 DIFFERENT POSSIBLE
         AIF   (N'&MATHS EQ &A).PL45            OPERANDS
&A  SETA &A+1
         AGO   .RECK5
.PL55    MNOTE *,'      REAL, SHORT PRICISION ARITHMETIC FUNCTIONS'
&SGPL11B(116) SETB 1
         AGO   .OPCK5                                    MORE OPERANDS?
.PL56    MNOTE *,'      REAL, LONG PRICISION ARITHMETIC FUNCTIONS'
&SGPL11B(117) SETB  1
         AGO   .OPCK5                                    MORE OPERANDS?
.PL46    AIF   (T'&ARRAY EQ 'O').PL60        ***** ARRAY/CMPX *****
&A  SETA 1
.RECK6   AIF   ('&ARRAY(&A)' EQ 'BASIC').PL61
         AIF   ('&ARRAY(&A)' EQ 'LEAF').PL62
         AGO   .EA
.PL61    MNOTE *,'      COMPLEX, BASIC ARRAY HANDLING'
&SGPL11B(112) SETB  1
.OPCK6   AIF   (&A EQ 2).PL60                2 DIFFERENT POSSIBLE
         AIF   (N'&ARRAY EQ &A).PL60         OPERANDS
&A  SETA &A+1
         AGO   .RECK6
.PL62    MNOTE *,'      COMPLEX INTERLEAVED ARRAYS'
&SGPL11B(113) SETB  1
         AGO   .OPCK6                        MORE OPERANDS
.PL60    AIF   (T'&MATHS EQ 'O').PL49                 ***** MATHS/CMPX
&A  SETA 1
.RECK7   AIF   ('&MATHS(&A)' EQ 'BASIC').PL63
         AIF   ('&MATHS(&A)' EQ 'SHORT').PL64
         AIF   ('&MATHS(&A)' EQ 'LONG').PL65
     AGO .EB                                 INVALID OPERAND
.PL63    MNOTE *,'      COMPLEX, BASIC ARITHMETIC FUNCTIONS'
&SGPL11B(115) SETB  1
.OPCK7   AIF   (&A EQ 3).PL49
         AIF   (N'&MATHS EQ &A).PL49
&A  SETA &A+1
         AGO   .RECK7
.PL64    MNOTE *,'      COMPLEX, SHORT PRICISION ARITHMETIC FUNCTIONS'
&SGPL11B(118) SETB  1
         AGO   .OPCK7                                   MORE OPERANDS?
.PL65    MNOTE *,'      COMPLEX, LONG PRECISION ARITHMETIC FUNCTIONS'
&SGPL11B(119) SETB  1
         AGO   .OPCK7                                  MORE OPERANDS?
.PL47    AIF   (T'&STRIO EQ 'O').PL70            ***** STRIO/TASK *****
&A  SETA 1
.RECK8   AIF   ('&STRIO(&A)' EQ 'DATA').PL71
         AIF   ('&STRIO(&A)' EQ 'LIST').PL72
         AIF   ('&STRIO(&A)' EQ 'EDIT').PL73
     AGO .EC                                      INVALID  OPERAND
.PL71    MNOTE *,'      DATA FORM STREAM I/O'
&SGPL11B(123) SETB  1
.OPCK8   AIF   (&A EQ 3).PL70
         AIF   (N'&STRIO EQ &A).PL70
&A  SETA &A+1
         AGO   .RECK8
.PL72    MNOTE *,'      LIST FORM STREAM I/O'
&SGPL11B(124) SETB  1
         AGO   .OPCK8                      CHECK FOR MORE OPERANDS
.PL73    MNOTE *,'      EDIT FORM STREAM I/O'
&SGPL11B(125) SETB  1
         AGO   .OPCK8                      CHECK FOR MORE OPERANDS
.PL70    AIF   (T'&RECIO EQ 'O').END              ***** RECIO/TASK ****
&A  SETA 1
.RECK9   AIF   ('&RECIO(&A)' EQ 'BASIC').PL74
         AIF   ('&RECIO(&A)' EQ 'WAIT').PL75
     AGO .ED
.PL74    MNOTE *,'      BASIC RECORD I/O'
&SGPL11B(127) SETB  1
.OPCK9   AIF   (&A EQ 2).END                 2 POSSIBLE DIFFERENT
         AIF   (N'&RECIO EQ &A).END          OPERANDS
&A  SETA &A+1
         AGO   .RECK9
.PL75    MNOTE *,'      RECORD I/O WITH EVENT OPTION'
&SGPL11B(129) SETB  1
         AGO   .OPCK9                             MORE OPERANDS?
.PL49A   AIF   (T'&STRIO EQ 'O').PL80             *****STRIO/NOTK ****
&A  SETA 1
.RECKA   AIF   ('&STRIO(&A)' EQ 'DATA').PL81
         AIF   ('&STRIO(&A)' EQ 'LIST').PL82
         AIF   ('&STRIO(&A)' EQ 'EDIT').PL83
     AGO .EE                                      INVALID OPERAND
.PL81    MNOTE *,'      DATA FORM STREAM I/O'
&SGPL11B(120) SETB  1
.OPCKA   AIF   (&A EQ 3).PL80
         AIF   (N'&STRIO EQ &A).PL80
&A  SETA &A+1
         AGO   .RECKA
.PL82    MNOTE *,'      LIST FORM STREAM I/O'
&SGPL11B(121) SETB  1
         AGO   .OPCKA                         CHECK FOR MORE OPERANDS
.PL83    MNOTE *,'      EDIT FORM STREAM I/O'
&SGPL11B(122) SETB  1
         AGO   .OPCKA                        CHECK FOR MORE OPERANDS
.PL80    AIF   (T'&RECIO EQ 'O').END              ***** RECIO/NOTK ****
&A  SETA 1
.RECKB   AIF   ('&RECIO(&A)' EQ 'BASIC').PL84
         AIF   ('&RECIO(&A)' EQ 'WAIT').PL85
&SW   SETB  1
     AGO .ED                                      INVALID OPERAND
.PL84    MNOTE *,'      BASIC RECORD I/O'
&SGPL11B(126) SETB  1
.OPCKB   AIF   (&A EQ 2).END                2 POSSIBLE DIFFERENT
         AIF   (N'&RECIO EQ &A).END         OPERANDS
&A  SETA &A+1
         AGO   .RECKB
.PL85    MNOTE *,'      RECORD I/O WITH EVENT OPTION'
&SGPL11B(128)  SETB  1
         AGO   .OPCKB                             MORE OPERANDS?
.* * * ERROR MESSAGES * * * ERROR MESSAGES * * * ERROR MESSAGES * * *
.E0 MNOTE 5,' * * * IEIPLL119 THE MODES KEYWORD MUST BE SPECIFIED IN   *
               ORDER TO INVOKE THE SHARED LIBRARY FEATURE'
&SGQUITB SETB  1
         AGO   .MORE
.E1 MNOTE 5,'* * * IEIPLL117 EITHER TASK OR NOTK MUST BE THE FIRST     *
               OPERAND SPECIFIED WITH THE MODES KEYWORD. SYNTAX        *
               CHECKING ONLY OF PL1LIB MACRO WILL CONTINUE.'
&SGQUITB SETB  1
&A  SETA  1
         AGO   .MORE
.E2 MNOTE 5,'* * * IEIPLL118 CMPX OR REAL ARE THE ONLY VALID SECOND    *
               AND/OR THIRD OPERANDS FOR THE MODES KEYWORD'
&SGQUITB SETB  1
         AGO   .MORE
.E4 MNOTE 5,'* * * IEIPLL120 MODES=CMPX CONFLICTS WITH LIBFCNS=REAL'
&SGQUITB SETB  1
         AGO   .PL25
.E5 MNOTE 5,'* * * IEIPLL121 STRGS VALUE &STRGS(&A) INVALID'
&SGQUITB SETB  1
         AGO   .OPCK1
.E6 MNOTE 5,'* * * IEIPLL122 CONVS VALUE &CONVS(&A) INVALID'
&SGQUITB SETB  1
         AGO   .OPCK2
.E7 MNOTE 5,'* * * IEIPLL123 STORG VALUE &STORG(&A) INVALID'
&SGQUITB SETB  1
         AGO   .OPCK3
.E8 MNOTE 5,'* * * IEIPLL124 ARRAY VALUE &ARRAY(&A) INVALID'
&SGQUITB SETB  1
         AGO   .OPCK4
.E9 MNOTE 5,'* * * IEIPLL125 MATHS VALUE &MATHS(&A) INVALID'
&SGQUITB SETB  1
         AGO   .OPCK5
.EA MNOTE 5,'* * * IEIPLL126 ARRAY VALUE &ARRAY(&A) INVALID'
&SGQUITB SETB  1
         AGO   .OPCK6
.EB MNOTE 5,'* * * IEIPLL127 MATHS VALUE &MATHS(&A) INVALID'
&SGQUITB SETB  1
         AGO   .OPCK7
.EC MNOTE 5,'* * * IEIPLL128 STRIO VALUE &STRIO(&A) INVALID'
&SGQUITB SETB  1
         AGO   .OPCK8
.ED MNOTE 5,'* * * IEIPLL129 RECIO VALUE &RECIO(&A) INVALID'
&SGQUITB SETB  1
         AIF  (&SW).OPCKB
         AGO   .OPCK9
.EE MNOTE 5,'* * * IEIPLL130 STRIO VALUE &STRIO(&A) INVALID'
&SGQUITB SETB  1
         AGO   .OPCKA
         MEXIT
.M1 MNOTE *,'      PL1 LIBRARY WILL RESIDE ON SYSRES'
     AGO  .AG
.EH MNOTE 5,'* * * IEIPLL116 LIBFCNS VALUE &LIBFCNS INVALID'
.PLQUIT  ANOP
&SGQUITB SETB  1
.END    MEND

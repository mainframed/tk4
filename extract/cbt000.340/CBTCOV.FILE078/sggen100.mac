         MACRO
         SGGEN100 &RESTYPE
.*
.*     SUPPORT CODE S99235 INDICATES CODE CHANGES FOR BOTH 158, 3158
.*     CONSOLE AND 168 CPU SUPPORT
.*
         COPY SGGBLPAK
         LCLA &A,&B,&CTLPT,&MESSAGE,&TABLADR,&CONA,&U
         LCLA  &C,&CH,&CHDEVAD,&CNTPTR,&COUNT,&COUNT2,&CT,&CTLPTR
         LCLA  &DD,&HIGH,&I,&J,&K,&LOW,&MAXDEV,&OLDCH
         LCLA  &D,&FP,&LP,&N,&OADAC,&OADCT,&MPOPT
         LCLB &CHAN(16),&BB,&Y(4),&GR,&SS,&II
         LCLA  &P,&E,&W,&X,&TT,&XX,&F                           SA66970
         LCLB  &CL,&RSW,&CSW,&TWO,&AC,&N1
         LCLB  &FH,&OPTCHB,&S,&S1,&OPCHNS
         LCLC  &ADDRESI,&ADDRESO,&Z,&C5
         LCLC  &UNIT,&DPOOLNM,&C4,&C6                             58697
         LCLC  &JC,&PT
         ACTR  &SGACTR
         AIF   (&GETB(2)).A01
         AIF   (&SGCPRGB(4) OR &SGCPRGB(8)).A01
&SGQUITB SETB  1
 MNOTE *,'************************************************************'
    MNOTE 7,'* * * IEIGEN000 PCP NOT SUPPORTED IN THIS RELEASE OF OS'
 MNOTE 7,'                19.6 LAST OS REL TO SUPPORT PCP'
 MNOTE 7,'                COMPONENT ORDER NUMBER FOR PCP IS NOW'
 MNOTE 7,'                        360S-CI-566'
 MNOTE *,'************************************************************'
.A01     AIF   (&SGMENTB(1)).A01A
    MNOTE 5,'* * * IEIGEN144 CENPROCS MACRO REQUIRED'
&SGQUITB SETB  1
.A01A    AIF  (&SGSCHDB(44)).A02    IF TSO, SKIP MACRO VALIDATION
         AIF   (NOT(&SGMENTB(60) OR &SGMENTB(61) OR &SGMENTB(59) OR &SG*
               MENTB(62) OR &SGMENTB(63) OR &SGMENTB(65))).A02
 MNOTE 5,'* * * IEIGEN231 THE FOLLOWING MACRO(S)   '
 MNOTE *,'              CMDLIB/EDIT/HELP/OUTPUT/TSOPTION/UADS'
 MNOTE *,'           MAY NOT BE CODED WITHOUT OPTIONS=TSO IN THE'
 MNOTE *,'           SCHEDULR MACRO.'
&SGQUITB SETB  1
.A02     AIF  (&GETB(2)).PROB  PROCESSOR ONLY
         AIF   (&SGMENTB(2)).A04
    MNOTE 5,'* * * IEIGEN144 CHANNEL  MACRO REQUIRED'
&SGQUITB SETB  1
.A04     AIF   (&SGMENTB(4)).A05
    MNOTE 5,'* * * IEIGEN144 IODEVICE MACRO REQUIRED'
&SGQUITB SETB  1
.A05     AIF   (&SGMENTB(5)).A06
    MNOTE 5,'* * * IEIGEN144 CTRLPROG MACRO REQUIRED'
&SGQUITB SETB  1
.A06     AIF   (&SGMENTB(6)).A07
    MNOTE 5,'* * * IEIGEN144 SCHEDULR MACRO REQUIRED'
&SGQUITB SETB  1
.A07     AIF (NOT &SGNODEV).A08
   MNOTE 0,'* * * IEIGEN144 LAST IOCONTRL STATEMENT HAS NO DEVICES'
.A08     ANOP
         AIF (&SGGJCB(8) AND NOT &SGSCHDB(2)).A085    SGJP AND MFT
         AGO   .A086
.A085 MNOTE 5,'* * * IEIGEN203 GJOBCTL REQUIRES MFT IF CLASS 3RD PARAME*
               TER IS SPECIFIED'
&SGQUITB SETB 1
.A086    AIF (NOT &SGMENTB(13)).A09   SERVAID
         AIF   (&SGMENTB(42)).A09        MACLIB
    MNOTE 0,'* * * IEIGENW14 SERVICE AID MACRO IMDSADMP WILL NOT BE INCX
               LUDED, MACLIB NOT SPECIFIED'
.A09     ANOP
.*  THIS ROUTINE SORTS ADDRESSES ASSIGNED TO UNITNAMES    SIFT METHOD
         AIF   (&SGCNTRA(4) EQ 0).T21       BYPASS ROUTINES IF NO NAMES
&CT      SETA  &SGCNTRA(4)    GET NUMBER OF NAMES
&K       SETA  1     SET REVERSE LIMIT FOR SIFT
.SRT     ANOP
&I       SETA  &I+1           STEP INDEX
.SRT2    ANOP
&S       SETB  (NOT &S)       COMPLEMENT FLIP-FLOP SWITCH
         AIF   (&S).SRT3      GO COMPARE X(I) LEFT AND X(I) RIGHT
&LOW   SETA  &SGUNNMA(&I)-&SGUNNMA(&I)/4096*4096  COMPARE X(I) RIGHT
&HIGH  SETA  &SGUNNMA(&I+1)/4096        WITH X(I+1) LEFT
         AGO  .SRT4    GO MAKE ACTUAL COMPARE
.SRT3   ANOP
&LOW   SETA  &SGUNNMA(&I)/4096  COMPARE X(2) LEFT AND
&HIGH  SETA  &SGUNNMA(&I)-&SGUNNMA(&I)/4096*4096   X(I) RIGHT
.SRT4    AIF   (&LOW EQ X'FFF').SRT12
         AIF   (&HIGH EQ X'FFF').SRU1
         AIF   (&LOW GT &HIGH).SRT7   THIS IS EXCHAN CONDITION
         AIF   (&LOW NE &HIGH).SRT5       NO EXCHANGE NEEDED
   CONVERT  TO=EBCDIC,VALUE=&LOW,DIGITS=3  CONVERT ADDRESS TO EBCDIC
    MNOTE 5,'* * * IEIGEN143 UNITNAME &SGUNNMC(&SGCNTRA(4)-&CT+1) HAS D*
               UPLICATE ADDRESS &EBCDIC'
&SGQUITB  SETB 1
.SRT5    AIF   (&J EQ 0).SRT6   BYPASS RESTORE INDEX ROUTINE
.SRT5A   ANOP
&I       SETA  &J    RESTORE INDEX TO RESUME FORWARD SORT
&S       SETB  (&S1)   RESTORE FLIP-FLOP SWITCH
&J       SETA  0       CLEAR INDEX STORAGE LOCATION
.SRT6    AIF   (&S).SRT2   IF ZERO,BUMP INDEX
         AGO   .SRT
.SRT7    AIF   (NOT &S).SRT8      EXCHANGE ROUTINE
&SGUNNMA(&I)  SETA &SGUNNMA(&I)-&SGUNNMA(&I)/4096*4096+&HIGH*4096  EXCH
&SGUNNMA(&I)  SETA &SGUNNMA(&I)/4096*4096+&LOW  X(I) LEFT AND X(I) RT.
    AGO .SRT9
.SRT8   ANOP        EXCHANGE ROUTINE
&SGUNNMA(&I+1)  SETA &SGUNNMA(&I+1)-&SGUNNMA(&I+1)/4096*4096+&LOW*4096
&SGUNNMA(&I)  SETA &SGUNNMA(&I)/4096*4096+&HIGH  EXCH X(I+1) L+T,XCI) R
.SRT9    AIF   (&J NE 0).SRT10     IS THIS A FORWARD SORT
&J       SETA  &I     YES,SAVE INDEX FOR FORWARD RESUMPTION
&S1      SETB  (&S)     SAVE FLIP-FLOP SWITCH STATUS
.SRT10   AIF   (&I GT &K).SRT11    IS I EQUAL TO REVERSE LIMIT
         AIF   (&S).SRT5A      IF ZERO,BUMP INDEX DOWN
    AGO .SRT2
.SRT11   AIF   (NOT &S).SRT2       IF ONE BUMP INDEX DOWN
&I       SETA  &I-1      BACK SORT IN PROGRESS
    AGO .SRT2
.SRT12   AIF   (&J NE 0).SRT5A
&CT      SETA  &CT-1
         AIF   (&CT EQ 0).SRU2
&S1      SETB  (NOT &S)
         AIF   (NOT &S).SRT
         AGO   .SRT2
.SRU1    ANOP
&CT      SETA  &CT-1         DECREMENT NAME COUNTER
         AIF   (&CT EQ 0).SRU2     IF ZERO ALL DONE
&K       SETA  &I+1       SET NEW REVERSE LIMIT
&S       SETB  (NOT &S)      COMPLEMENT FLIP-FLOP SWITCH
    AGO .SRT
.SRU2   ANOP   END OF UNITNAME ADDRESS SORT ROUTINE
.* THE FOLLOWING ROUTINE CHECKS ADDRESSES OF UNITNAMES FOR DEVICES
&A  SETA  &SGCNTRA(4)    GET TOTAL NUMBER OF UNITNAMES
&D SETA 1     COUNT NAMES
.T10 AIF ('&SGUNNMC(&D)' NE '&SGGJCC(10)').T11
&DPOOLNM SETC '&SGGJCC(10)'
.T11  AIF  (&FH).T13     CHECK RIGHT OR LEFT HALF OF ADDRESS BOX
&B  SETA   &B+1          STEP ADDRESS BOX INDEX TO NEW BOX
&C  SETA   &SGUNNMA(&B)/4096  SET LEFT ADDRESS IN BOX INTO C
  AGO .T15
.T13           ANOP
&C  SETA  &SGUNNMA(&B)-&SGUNNMA(&B)/4096*4096  SET RIGHT HALF INTO C
.T15  AIF  (&C EQ X'FFF').T19     EXIT ON ADDRESS DELIMITER
         IOCHECK  LOOKFOR=&C           CALL FOR BINARY SEARCH
   AIF  (&HEX NE 0).T17         IF NOT ZERO ITS FOUND
         CONVERT  TO=EBCDIC,VALUE=&C,DIGITS=3  CONVERT C TO EBCDIC
    MNOTE 5,'* * * IEIGEN130 UNITNAME ADDRESS &EBCDIC NOT A DEVICE'
&SGQUITB SETB  1
.T17 AIF (NOT &SGMENTB(29)).T18
 AIF ('&DPOOLNM' NE '&SGGJCC(10)').T18
&I SETA &SGDADRA(&HEX)/1048576      GET DEVICE POINTER
 AIF (&SGDT03B(&I)).T18        DIRECT ACCESS CLASS
         CONVERT TO=EBCDIC,VALUE=&C,DIGITS=3
    MNOTE 5,'* * * IEIGEN198 UNITNAME ADDRESS &EBCDIC INVALID FOR DAPOO*
               L IN GJOBCTL MACRO'
&SGQUITB SETB 1
.T18 ANOP
&FH  SETB  (NOT(&FH))    COMPLEMENT FLIP-FLOP SWITCH
  AGO .T11               RETURN TO START OF ROUTINE
.T19   ANOP
&DPOOLNM SETC ''
&D SETA &D+1
&A  SETA  &A-1           DECREMENT UNITNAME COUNT
&FH  SETB  (NOT(&FH))    COMPLEMENT FLIP-FLOP SWITCH
 AIF (&A NE 0).T10      RETURN TO START OF ROUTINE
.T21   ANOP   END OF UNITNAME ADDRESS CHECK
.*  THIS ROUTINE CHECKS HARDWARE COMPATIBILITY
&D SETA 0
.* THIS ROUTINE SETS UP FOR TEST THAT ALL DEVICES HAVE A CHANNEL AND
.* THAT ALL CHANNELS HAVE A DEVICE ON THEM
&I  SETA   0
.M1 AIF (&I EQ 16).MX1
&CHAN(&I+1)  SETB  (&SGCHANB(&I*15+1))
&I  SETA  &I+1
       AGO  .M1
.MX1  ANOP
&I SETA 0
.MX2 AIF (&I EQ 16).MX6
 AIF (&SGBRSTB(&I+1) AND &SGCHANB(&I*15+2)).MX3
 AIF (&SGBRSTB(&I+1) AND &SGCHANB(&I*15+4)).MX4
 AIF (&SGCHANB(&I*15+6)).MX25      TEST IF BLKMPXR CHANNEL IN SYSTEM
 AGO .MX5
.MX25 ANOP
&SGMENTB(68) SETB 1
&F       SETA  1                                                SA66970
.MX255   AIF   (&SGCPUB(4) OR &SGMOD4B(&F)).MPZ 65 OR SECMODS   SA66970
&F       SETA  &F+1                                             SA66970
         AIF   (&F LT 5).MX255                                  SA66970
         AGO .MX5                                               SA66970
.MPZ MNOTE 5,'* * * IEIGEN543 BLKMPXR AND MODEL 65 CPU INVALID COMBINAT*
               ION'                                             SA66970
&SGQUITB SETB 1                                                 SA66970
         AGO   .MX5                                             SA66970
.MX3 CONVERT TO=EBCDIC,DIGITS=1,VALUE=&I
     MNOTE 5,'* * * IEIGEN218 BURST DEVICES INVALID ON MULTIPLEXOR CHAN*
               NEL &EBCDIC'
&SGQUITB SETB 1
 AGO .MX4A
.MX4     CONVERT TO=EBCDIC,DIGITS=1,VALUE=&I
     MNOTE 0,'* * * IEIGENW11 BURST DEVICES ARE SUPPORTED ONLY ON SELEC*
               TOR SUB-CHANNELS OF CHANNEL &EBCDIC'
.MX4A MNOTE *,' BURST DEVICES INCLUDE 2250-2301-2302-2303-2305-2311'
 MNOTE *,'             2314-2321-2401-2402-2403-2404-2415-2420-3330'
.MX5 ANOP
&I SETA &I+1
 AGO .MX2
.MX6 ANOP
&TWO     SETB  0
&I       SETA  0
.D01     ANOP  TOP OF CHECK LOOP
&I       SETA  &I+1
         AIF   (NOT &SGCPRGB(13)).D010            M65MP
         AIF   (&MPOPT GT 1).MPERR                TOO MANY OPT CHANS
&MPOPT   SETA  0
         AGO   .D010
.MPERR   CONVERT TO=EBCDIC,DIGITS=3,VALUE=&CT
    MNOTE 5,'* * * IEIGEN251 ONLY 1 OPTIONAL CHANNEL FOR DEVICE AT ADDR*
               ESS &EBCDIC IS VALID IN M65MP ENVIRONMENT'
&SGQUITB SETB  1
&MPOPT   SETA  0
.D010    AIF   (&I GT &SGCNTRA(3)).D99  LAST DEVICE HAS BEEN CHECKED
&CT  SETA  &SGDADRA(&I)-&SGDADRA(&I)/4096*4096  GET ADDRESS INTO CT
&J SETA &SGDADRA(&I)/1048576      GET DEVICE POINTER
&K SETA &SGDADRA(&I)/4096-&SGDADRA(&I)/1048576*256   GET CU POINTER
         AIF   (&J EQ 0).D01            J USED AS DIMENSION
.*           IS THE CHANNEL PRESENT
.*    IF YES INDICATE USED
  AIF (NOT (&SGCHANB((&CT/256)*15+1))).M2
&CHAN(&CT/256+1)  SETB  0
 CONVERT TO=EBCDIC,DIGITS=3,VALUE=&CT
 AIF (&SGOPSUB(&J) AND NOT &SGCHANB((&CT/256)*15+4)).M10
 AIF (NOT &SGCHANB((&CT/256)*15+4)).D02 H.S. MULTIPLEXOR
         AIF   (&SGDAP1B(&J) OR &SGDAP5B(&J) OR &SGDAP6B(&J) OR &SGDAP7*
               B(&J) OR &SGDAP8B(&J) OR &SGDAP9B(&J)).M11
         AIF   (&SGDAPAB(&J) OR &SGDAPBB(&J) OR &SGDAPCB(&J) OR &SGDAPD*
               B(&J) OR &SGDAPEB(&J) OR &SGDAPFB(&J)).M11
         AIF   ((&SGDAP2B(&J) OR &SGDAP3B(&J) OR &SGDAP4B(&J)) AND NOT *
               &SGOPSUB(&J)).M11
.D02  AIF (&SGDT01B(&J)).DT1  DEVICE IS  TAPE
      AIF (&SGDT02B(&J)).DV1  DEVICE IS OPT.RDR. OR TELECOM/BTAM
      AIF (&SGDT03B(&J)).DD1  DEVICE IS  D-A-STORAGE
      AIF (&SGDT04B(&J)).DC1  DEVICE IS  CONSOLE
      AIF (&SGDT05B(&J)).DG1  DEVICE IS  GRAPHIC
      AIF (&SGDT06B(&J)).DP1  DEVICE IS  PRINTER
      AIF (&SGDT07B(&J)).DU1  DEVICE IS  RDR-PCH
      AIF (&SGDT08B(&J)).DX1  DEVICE IS  TELECOM/PROC
     AIF (&SGDT12B(&J)).DTB1  DEVICE IS OPT.RDR. OR TELECOM/BTAM
  AIF (&SGDUMMY(&J)).D01   DEVICE IS DUMMY
.INCOMP  CONVERT   TO=EBCDIC,DIGITS=3,VALUE=&CT
    MNOTE 5,'* * * IEIGEN132 DEVICE ADDRESS &EBCDIC /CTRL UNIT CONFLICT*
               '
&SGQUITB SETB  1     INCOMPATIB. BETWEEN DEVICE AND CONTROL UNIT
         AGO   .D01
.NOTSUP  CONVERT   TO=EBCDIC,DIGITS=3,VALUE=&CT
    MNOTE 5,'* * * IEIGEN131 DEVICE ADDRESS &EBCDIC NOT SUPPORTED OR CO*
               NTROL UNIT CONFLICT'
&SGQUITB SETB  1
         AGO   .D01
.*    CHECK NUMBER OF DEVICES ALLOWED FOR ONE CTRL  UNIT
.CHKNBDV AIF   (&CTLPTR EQ &K).TSTCNT   IS IT THE SAME CTRL UNIT
&CTLPTR  SETA  &K                       NO,CHANGE CTRL UNIT PTR
&COUNT   SETA  0                        ERASE COUNT OF DEVICES
         AGO   .INCCNT
.TSTCNT  AIF   (&COUNT LT &MAXDEV).INCCNT  CHECK COUNT LT MAX NO OF DEV
         CONVERT TO=EBCDIC,DIGITS=3,VALUE=&CT
    MNOTE 5,'* * * IEIGEN133 DEVICE ADDRESS &EBCDIC EXCEEDS MAX OF &MAX*
               DEV DEVICES ON CTRL UNIT'
&SGQUITB SETB  1
.INCCNT  ANOP              INCREASE COUNT OF DEVICES  BY ONE
&COUNT   SETA  &COUNT+1
         AIF   (&OPTCHB).TSTCHN  GO TO TEST CHANNEL SWITCHING
         AGO   .D01
.*    THIS ROUTINE CHECKS CHANNEL SWITCHING
.TSTCHN  ANOP
&DD SETA &CT/X'100'                    CHANNEL PORTION OF ADDRESS
&CHDEVAD SETA &CT-&CT/X'10'*X'10'      DEVICE PORTION OF ADDRESS
 AIF (&SGCHANB(&DD*15+4)).HSPX
&DD SETA &CT-&CT/X'100'*X'100'         C.U. AND DEVICE PORTION
 AGO .RET0
.HSPX ANOP
&DD SETA &CT/X'100'*X'100'   CHANNEL PORTION OF ADDRESS W/00 C.U. + DEV
.RET0 AIF (&SGDAP1B(&J)).CHAN1
.RET1    AIF  (&SGDAP2B(&J)).CHAN2    OPTIONAL CHANNEL 2
.RET2    AIF  (&SGDAP3B(&J)).CHAN3    OPTIONAL CHANNEL 3
.RET3    AIF  (&SGDAP4B(&J)).CHAN4    OPTIONAL CHANNEL 4
.RET4    AIF  (&SGDAP5B(&J)).CHAN5    OPTIONAL CHANNEL 5
.RET5    AIF  (&SGDAP6B(&J)).CHAN6    OPTIONAL CHANNEL 6
.RET6    AIF  (&SGDAP7B(&J)).CHAN7    OPTIONAL CHANNEL 7
.RET7    AIF  (&SGDAP8B(&J)).CHAN8    OPTIONAL CHANNEL 8
.RET8    AIF  (&SGDAP9B(&J)).CHAN9    OPTIONAL CHANNEL 9
.RET9    AIF  (&SGDAPAB(&J)).CHANA    OPTIONAL CHANNEL A
.RETA    AIF  (&SGDAPBB(&J)).CHANB    OPTIONAL CHANNEL B
.RETB    AIF  (&SGDAPCB(&J)).CHANC    OPTIONAL CHANNEL C
.RETC    AIF  (&SGDAPDB(&J)).CHAND    OPTIONAL CHANNEL D
.RETD    AIF  (&SGDAPEB(&J)).CHANE    OPTIONAL CHANNEL E
.RETE    AIF  (&SGDAPFB(&J)).CHANF    OPTIONAL CHANNEL F
&OPTCHB  SETB  0     RESET OPTIONAL CHANNEL SWITCH FOR CHKNBDV RTN
         AGO  .D01
.CHAN1 AIF (&SGCHANB(1*15+4)).M12       SEL. W/H.S.MPX. 1 FOR OPTCHAN
&CHDEVAD SETA  X'100'+&DD  OPTIONAL DEVICE ADDR
         AGO  .LOOK
.CHAN2 AIF (NOT &SGOPSUB(&J)).CHAN2A   H.S. MULTIPLEXOR SUB
&CHDEVAD SETA &DD+X'D0'+&CHDEVAD       SEL. SUB-CHANNEL OPTCHAN
 AGO .LOOK
.CHAN2A AIF (&SGCHANB(2*15+4)).M12      SEL. W/H.S.MPX. 2 FOR OPTCHAN
&CHDEVAD SETA  X'200'+&DD  OPTIONAL DEVICE ADDR
         AGO  .LOOK
.CHAN3 AIF (NOT &SGOPSUB(&J)).CHAN3A   H.S. MULTIPLEXOR SUB
&CHDEVAD SETA &DD+X'E0'+&CHDEVAD       SEL. SUB-CHANNEL OPTCHAN
 AGO .LOOK
.CHAN3A AIF (&SGCHANB(3*15+4)).M12      SEL. W/H.S.MPX. 3 FOR OPTCHAN
&CHDEVAD SETA  X'300'+&DD  OPTIONAL DEVICE ADDR
         AGO  .LOOK
.CHAN4 AIF (NOT &SGOPSUB(&J)).CHAN4A   H.S. MULTIPLEXOR SUB
&CHDEVAD SETA &DD+X'F0'+&CHDEVAD       SEL. SUB-CHANNEL OPTCHAN
 AGO .LOOK
.CHAN4A AIF (&SGCHANB(4*15+4)).M12      SEL. W/H.S.MPX. 4 FOR OPTCHAN
&CHDEVAD SETA  X'400'+&DD  OPTIONAL DEVICE ADDR
         AGO  .LOOK
.CHAN5 AIF (&SGCHANB(5*15+4)).M12       SEL. W/H.S.MPX. 5 FOR OPTCHAN
&CHDEVAD SETA  X'500'+&DD  OPTIONAL DEVICE ADDR
         AGO  .LOOK
.CHAN6 AIF (&SGCHANB(6*15+4)).M12       SEL. W/H.S.MPX. 6 FOR OPTCHAN
&CHDEVAD SETA  X'600'+&DD  OPTIONAL DEVICE ADDR
         AGO  .LOOK
.CHAN7 AIF (&SGCHANB(7*15+4)).M12     SEL. W/H.S.MPX. 7 FOR OPTCHAN
&CHDEVAD SETA X'700'+&DD  OPTIONAL DEVICE ADDR
         AGO .LOOK
.CHAN8 AIF (&SGCHANB(8*15+4)).M12     SEL. W/H.S.MPX. 8 FOR OPTCHAN
&CHDEVAD SETA X'800'+&DD  OPTIONAL DEVICE ADDR
         AGO .LOOK
.CHAN9 AIF (&SGCHANB(9*15+4)).M12     SEL. W/H.S.MPX. 9 FOR OPTCHAN
&CHDEVAD SETA X'900'+&DD  OPTIONAL DEVICE ADDR
         AGO .LOOK
.CHANA AIF (&SGCHANB(10*15+4)).M12    SEL. W/H.S.MPX.10 FOR OPTCHAN
&CHDEVAD SETA X'A00'+&DD  OPTIONAL DEVICE ADDR
         AGO .LOOK
.CHANB AIF (&SGCHANB(11*15+4)).M12    SEL. W/H.S.MPX.11 FOR OPTCHAN
&CHDEVAD SETA X'B00'+&DD  OPTIONAL DEVICE ADDR
         AGO .LOOK
.CHANC AIF (&SGCHANB(12*15+4)).M12    SEL. W/H.S.MPX.12 FOR OPTCHAN
&CHDEVAD SETA X'C00'+&DD  OPTIONAL DEVICE ADDR
         AGO .LOOK
.CHAND AIF (&SGCHANB(13*15+4)).M12    SEL. W/H.S.MPX.13 FOR OPTCHAN
&CHDEVAD SETA X'D00'+&DD  OPTIONAL DEVICE ADDR
         AGO .LOOK
.CHANE AIF (&SGCHANB(14*15+4)).M12    SEL. W/H.S.MPX.14 FOR OPTCHAN
&CHDEVAD SETA X'E00'+&DD  OPTIONAL DEVICE ADDR
         AGO .LOOK
.CHANF AIF (&SGCHANB(15*15+4)).M12    SEL. W/H.S.MPX.15 FOR OPTCHAN
&CHDEVAD SETA X'F00'+&DD  OPTIONAL DEVICE ADDR
         AGO .LOOK
.LOOK    ANOP
&MPOPT   SETA  &MPOPT+1
&OPCHNS  SETB  1                   SET GLOBAL FOR OPTCHAN - M65MP
        AIF  (NOT (&SGCHANB(&CHDEVAD/X'100'*15+1))).CHER  IS CH EXIST
&CHAN(&CHDEVAD/X'100'+1)  SETB  0
&SGCTRLB(1) SETB 1
&SGCTRLA(2) SETA &I                     PASS INDEX TO IOCHECK
         IOCHECK LOOKFOR=&CHDEVAD  IS THERE A DEVICE WITH THIS ADDR
&SGCTRLB(1) SETB 0
         AIF  (&HEX EQ 0).GOOD1      NO
.OPTERR CONVERT TO=EBCDIC,DIGITS=3,VALUE=&HEX
&ADDRESI SETC '&EBCDIC'
&MESSAGE SETA &CHDEVAD/X'100'
 CONVERT TO=EBCDIC,DIGITS=1,VALUE=&MESSAGE
 AIF (NOT &SGOPSUB(&J)).MSGTYP1        NOT SUB-CHANNELS
&MESSAGE SETA &CHDEVAD/X'10'           OPTCHAN AS SPECIFIED
 CONVERT TO=EBCDIC,DIGITS=2,VALUE=&MESSAGE
.MSGTYP1 ANOP
&ADDRESO SETC '&EBCDIC'
 CONVERT TO=EBCDIC,DIGITS=3,VALUE=&CT
    MNOTE 5,'* * * IEIGEN134 ADDRESS &EBCDIC OPTCHAN &ADDRESO CONFLICT *
               AT DEVICE WITH ADDRESS &ADDRESI'
&SGQUITB SETB  1                 TEST TWO CHANNEL SWITCH FOR 2820-2841
.GOOD1 AIF (&SGDT03B(&J) AND (&SGDU06B(&J) OR &SGDU07B(&J) OR &SGDU08B(*
               &J))).GOOD2
 AIF (&SGUNF3B(&K) OR (&SGUNT1B(&K) AND (&SGUNU4B(&K) OR &SGUNU7B(&K) OX
               R &SGUNU6B(&K) OR &SGUNU3B(&K)))).GOOD2
         AIF   (&SGUNT3B(&K) AND &SGUNU3B(&K)).GOOD2   3803 C. U.
         CONVERT TO=EBCDIC,DIGITS=3,VALUE=&CT
&ADDRESI SETC  '&EBCDIC'(1,2)
    MNOTE 5,'* * * IEIGEN135 ADDRESS &ADDRESI IMPROPER CTRL UNIT FOR   *
               OPTCHAN'
&SGQUITB SETB  1
.GOOD2 AIF (&SGOPSUB(&J)).GOOD3        H.S.MPX. SUB-CHANNEL OPTCHAN
         AIF  (&CHDEVAD/X'100' EQ 1).RET1  GET OTHER OPTCHANS
         AIF  (&CHDEVAD/X'100' EQ 2).RET2
         AIF  (&CHDEVAD/X'100' EQ 3).RET3
         AIF  (&CHDEVAD/X'100' EQ 4).RET4
         AIF  (&CHDEVAD/X'100' EQ 5).RET5
         AIF  (&CHDEVAD/X'100' EQ 6).RET6
         AIF  (&CHDEVAD/X'100' EQ 7).RET7
         AIF  (&CHDEVAD/X'100' EQ 8).RET8
         AIF  (&CHDEVAD/X'100' EQ 9).RET9
         AIF  (&CHDEVAD/X'100' EQ 10).RETA
         AIF  (&CHDEVAD/X'100' EQ 11).RETB
         AIF  (&CHDEVAD/X'100' EQ 12).RETC
         AIF  (&CHDEVAD/X'100' EQ 13).RETD
         AIF  (&CHDEVAD/X'100' EQ 14).RETE
&OPTCHB  SETB  0  RESET OPTIONAL CHANNEL SWITCH FOR CHKNBDV RTN
         AGO  .D01
.GOOD3 ANOP
&MESSAGE SETA &CHDEVAD/X'10'           SAVE CHDEVAD
&MESSAGE SETA &MESSAGE-&MESSAGE/X'10'*X'10' C.U. PORTION
&CHDEVAD SETA &CT-&CT/X'10'*X'10'           DEVICE PORTION
&HEX SETA X'D'
 AIF (&MESSAGE EQ &HEX).RET2
&HEX SETA X'E'
 AIF (&MESSAGE EQ &HEX).RET3
&OPTCHB SETB 0  RESET OPTIONAL CHANNEL SWITCH FOR CHKNBDV RTN
 AGO .D01
.CHER ANOP
 CONVERT TO=EBCDIC,DIGITS=3,VALUE=&CHDEVAD
&ADDRESI SETC '&EBCDIC'(1,1)
 CONVERT TO=EBCDIC,DIGITS=3,VALUE=&CT
     MNOTE 5,'* * * IEIGEN134 DEVICE ADDRESS &EBCDIC OPTCHAN &ADDRESI N*
               OT A DEFINED CHANNEL'
&SGQUITB SETB 1
 AGO .GOOD1                            CONTINUE OTHER CHECKS
.M10 MNOTE 5,'* * * IEIGEN134 DEVICE ADDRESS &EBCDIC SPECIFIES OPTCHAN(*
               S) VALID FOR H.S.MPX. ONLY'
&SGQUITB SETB 1
 AGO .D01
.M11 MNOTE 5,'* * * IEIGEN134 DEVICE ADDRESS &EBCDIC SPECIFIES OPTCHAN(*
               S) INVALID FOR H.S.MPX.'
&SGQUITB SETB 1
 AGO .D01
.M12 MNOTE 5,'* * * IEIGEN134 H.S.MPX. OPTCHAN AT DEVICE ADDRESS &EBCDI*
               C INVALID WITH SELECTOR OR MULTIPLEXOR'
&SGQUITB SETB 1
 AGO .D01
.DT1     ANOP    DEVICE IS TAPE
.*  CHECK FOR HYPERTAPE
 AIF (&SGDU06B(&J) AND &SGUNT1B(&K) AND &SGUNU5B(&K)).NOTSUP
.*  CHECK FOR TAPE DEVICE
         AIF   (&SGUNT3B(&K) AND &SG3410B(&J) AND &SGUNU4B(&K)).T3410
         AIF   (&SGUNT3B(&K) AND &SGDU03B(&J) AND (NOT(&SG3410B(&J)))).*
               T3420                    3803 WITH 3420 TAPE DRIVE
 AIF (NOT(&SGDU01B(&J) AND &SGUNT1B(&K))).INCOMP
.* CHECK FOR DEVICE MODEL 8.
         AIF   (&SGDM08B(&J)).RWW8
.*  CHECK FOR DEVICE MODEL 4-5 OR 6
         AIF   (&SGDM04B(&J) OR &SGDM05B(&J) OR &SGDM06B(&J)).RWW456
.*  CHECK FOR DEVICE MODEL 1-2 OR 3
         AIF   (&SGDM01B(&J) OR &SGDM02B(&J) OR &SGDM03B(&J)).RWW123
         AGO  .INCOMP
.RWW456  ANOP   MOD4-5 OR 6 DRIVES REQUIRE READ-WHILE-WRITE FEATURE
.*              WHEN ATTACHED TO A 2804 MOD2 CTRL UNIT
         AIF  (&SGUNU7B(&K) AND &SGUNM2B(&K)).CRWW456
         AGO  .MOD456   ASSOC. DEVICE/CTRL UNIT NOT REALISED
.RWW8    ANOP
.* CHECK FOR 2804 MODEL 3 CONTROL UNIT.
         AIF   (&SGUNU7B(&K) AND &SGUNM3B(&K)).CRWW8
.* CHECK FOR 2803 MODEL 3 CONTROL UNIT.
         AIF   (&SGUNU6B(&K) AND &SGUNM3B(&K)).RWWM3
         AGO   .INCOMP   INVALID COMBINATION WITH 2401-8
.RWWM3   ANOP
.* IF 2803 MODEL 3 READWRITE OPTION INVALID.
         AIF   (NOT &SGDF03B(&J)).CHKDNB
    MNOTE 5,'* * * IEIGEN135 READWRITE INVALID FOR 2803 MODEL 3'
&SGQUITB SETB  1
         AGO   .CHKDNB
.CRWW456 AIF  (&SGDF03B(&J)).MOD456
         CONVERT TO=EBCDIC,DIGITS=3,VALUE=&CT
    MNOTE 5,'* * * IEIGEN136 DEVICE ADDRESS &EBCDIC REQUIRES READ-WHILE*
               -WRITE FEATURE'
&SGQUITB SETB  1
         AGO  .MOD456
.CRWW8   ANOP  IF 2804 MODEL 3 MUST SELECT READ-WHILE-WRITE FEATURE.
         AIF   (&SGDF03B(&J)).CHKDNB
         CONVERT TO=EBCDIC,DIGITS=3,VALUE=&CT
    MNOTE 5,'* * * IEIGEN136 DEVICE ADDRESS &EBCDIC REQUIRES READ-WHILE*
               -WRITE FEATURE'
&SGQUITB SETB  1
         AGO   .CHKDNB
.*  CHECK FOR 2415 MOD4-5 OR 6 WITH 2415 MOD4-5 OR 6 CTRL UNIT
.MOD456  AIF   (&SGUNU8B(&K) AND (&SGUNM4B(&K) OR &SGUNM5B(&K) OR      *
               &SGUNM6B(&K))).C2415NB
.*  CHECK FOR 2401-2403 MOD4-5 OR 6, 1600 BPI
         AIF   (NOT &SGDF04B(&J)).CHKUN1
.*  CHECK FOR 2401-2403 MOD4-5 OR 6 WITH DUALDENS AND 800BPI COMP.FEAT.
         AIF   (&SGDF04B(&J) AND &SGUNF4B(&K)).CHKUN1
         AGO  .INCOMP     OTHER COMB. INVALID
.RWW123  ANOP   2401-2402 MOD1-2 OR 3 REQUIRE READ-WHILE-WRITE FEATURE
.*              WHEN ATTACHED TO A 2404 OR 2804 MOD1 CTRL UNIT
         AIF  (&SGUNU4B(&K) OR &SGUNU7B(&K) AND &SGUNM1B(&K)).CRWW123
         AGO  .MOD123   ASSOC. DEVICE/CTRL UNIT NOT REALISED
.CRWW123 AIF  (&SGDF03B(&J)).MOD123
         CONVERT TO=EBCDIC,VALUE=&CT,DIGITS=3
    MNOTE 5,'* * * IEIGEN136 DEVICE ADDRESS &EBCDIC REQUIRES READ-WHILE*
               -WRITE FEATURE'
&SGQUITB SETB  1
         AGO  .MOD123
.*  CHECK FOR 2415 MOD1-2 OR 3 WITH 2415 MOD1-2 OR 3 CTRL UNIT
.MOD123  AIF   (&SGUNU8B(&K) AND (&SGUNM1B(&K) OR &SGUNM2B(&K) OR      *
               &SGUNM3B(&K))).C2415NB
.*  CHECK FOR 2401-2404 MOD1-2 OR 3 WITH COMPAT.FEATURE 9-TRACK
         AIF   (&SGDF02B(&J) AND &SGDF05B(&J) AND &SGUNF4B(&K)).CHKUN1
.*  CHECK FOR 2401-2404 MOD1-2 OR 3 WITH COMPAT.FEATURE 7-TRACK
         AIF   (&SGDF01B(&J) AND &SGDF05B(&J) AND &SGUNF1B(&K)).CHKUN1
.*  CHECK FOR 2401-2404 MOD1-2 OR 3 WITHOUT COMP. FEATURE 9-TRACK
         AIF   (&SGDF02B(&J) AND NOT &SGDF05B(&J)).CHKUN2
.*  CHECK FOR 2401-2404 MOD1-2 OR 3 WITHOUT COMP. FEATURE 7-TRACK
    AIF (&SGDF01B(&J) AND NOT &SGDF05B(&J) AND &SGUNF1B(&K)).CHKUN2
         AGO  .INCOMP     OTHER COMB. INVALID
.*  CHECK IF CTRL UNIT IS 2403 MOD4-5 OR 6 OR 2803-2804 MOD2
.CHKUN1  AIF  (&SGUNU3B(&K) AND (&SGUNM4B(&K) OR &SGUNM5B(&K) OR       *
               &SGUNM6B(&K)) OR (&SGUNU6B(&K) OR &SGUNU7B(&K)) AND     *
               &SGUNM2B(&K)).CHKDNB
         AGO  .INCOMP
.*  CHECK IF CTRL UNIT IS 2403-2404 MOD1-2 OR 3 OR 2803-2804 MOD1
.CHKUN2  AIF  ((&SGUNU3B(&K) OR &SGUNU4B(&K)) AND (&SGUNM1B(&K) OR &SGU*
               NM2B(&K) OR &SGUNM3B(&K)) OR (&SGUNU6B(&K) OR &SGUNU7B(&*
               K)) AND &SGUNM1B(&K)).CHKDNB
         AGO  .INCOMP
.*  CHECK NB OF TAPE DRIVES FOR 2415 CTRL UNIT
.C2415NB AIF  (&SGDM01B(&J) OR &SGDM04B(&J)).TWODRV
         AIF  (&SGDM02B(&J) OR &SGDM05B(&J)).FOURDRV
.SIXDRV  ANOP   SIX TAPE DRIVES ON MODEL 3 AND 6
&MAXDEV  SETA  6
&OPTCHB  SETB  1  NO OPTCHAN ALLOWED
         AGO  .CHKNBDV
.FOURDRV ANOP   FOUR TAPE DRIVES ON MODEL 2 AND 5
&MAXDEV  SETA  4
&OPTCHB  SETB  1  NO OPTCHAN ALLOWED
         AGO  .CHKNBDV
.TWODRV  ANOP   TWO TAPE DRIVES ON MODEL 1 AND 4
&MAXDEV  SETA  2
&OPTCHB  SETB  1  NO OPTCHAN ALLOWED
         AGO  .CHKNBDV
.*  CHECK NB OF DEV. FOR OTHER CTRL UNITS THAN 2415
.CHKDNB AIF (&SGUNF3B(&K)).SXTDRV
&MAXDEV  SETA  8  UP TO 8 DEVICES WITH THIS CTRL UNIT
&OPTCHB  SETB  1  NO OPTCHAN ALLOWED
         AGO  .CHKNBDV
.SXTDRV  ANOP   16-DRIVE ADDR FEATURE ON THIS CTRL UNIT
         AIF  (&SGUNU4B(&K) OR &SGUNU7B(&K)).NOTALL
&MAXDEV  SETA  16
&OPTCHB  SETB  1
         AGO  .CHKNBDV
.NOTALL  ANOP   16-DRIVE ADDR NOT ALLOWED WITH 2404 OR 2804 CTRL UNIT
         CONVERT TO=EBCDIC,DIGITS=3,VALUE=&CT
&ADDRESI SETC  '&EBCDIC'(1,2)
    MNOTE 5,'* * * IEIGEN135 ADDRESS &ADDRESI IMPROPER CTRL UNIT FOR   *
               OPTCHAN OR 16-DRIVE ADDRESSING'
&SGQUITB SETB  1
&MAXDEV  SETA  8   SET MAX DEVICE NO TO 8
&OPTCHB  SETB  1
         AGO  .CHKNBDV
.T3410   AIF   (NOT(&SGUNT3B(&K) AND &SGUNU4B(&K))).INCOMP NOT 3410 C U
         AIF   (&SGDM01B(&J) AND &SGUNM1B(&K)).SETMAX
         AIF   (&SGDM02B(&J) AND &SGUNM2B(&K)).SETMAX
         AIF   (&SGDM03B(&J) AND &SGUNM3B(&K)).SETMAX
         AGO   .INCOMP
.SETMAX  ANOP
         AIF   (&SGDM01B(&J)).DEV4
&MAXDEV  SETA  6
         AGO   .CHKDENS
.DEV4    ANOP
&MAXDEV  SETA  4
         AGO   .CHKDENS
.T3420   AIF   (NOT(&SGUNT3B(&K) AND &SGUNU3B(&K))).INCOMP NOT 3803 C U
&MAXDEV  SETA  16
&OPTCHB  SETB  1
.CHKDENS ANOP
         AIF   (NOT(&SGDF09B(&J) AND &SGCPRGB(13))).CHKDEN
    MNOTE 5,'* * * IEIGEN129 DEVICE ADDRESS &EBCDIC  -  SHARABLE INVALI*
               D WITH M65MP'
&SGQUITB SETB  1
.CHKDEN  ANOP
         AIF   (NOT &SGDF04B(&J)).CHKTRK               DUALDENS?
         AIF   (&SGDF04B(&J) AND &SGUNF4B(&K)).CHKTRK  DUALDENS CHECK
         AGO   .INCOMP
.CHKTRK  AIF   (&SGDF06B(&J)).CHKCMP                  OPT1600 FEATURE
         AIF   (&SGDF02B(&J)).CHKNBDV                 9-TRACK FEATURE
         AIF   (&SGDF01B(&J) AND &SGUNF1B(&K)).CHKNBDV CHECK FOR 7-TRK
         AIF   (&SGUNT3B(&K) AND &SG3410B(&J) AND &SGUNU4B(&K)).CHKNBDV
         AIF   (&SGUNM1B(&K) AND (&SGDM03B(&J) OR &SGDM05B(&J) OR &SGDM*
               07B(&J))).CHKNBDV
         AIF   (&SGUNM2B(&K) AND (&SGDM03B(&J) OR &SGDM05B(&J) OR &SGDM*
               07B(&J))).CHKNBDV
         AIF   (&SGUNM2B(&K) AND (&SGDM04B(&J) OR &SGDM06B(&J) OR &SGDM*
               08B(&J))).CHKNBDV
.CHKCMP  AIF   (&SGDF06B(&J) AND &SGUNM2B(&K)).CHKNBDV  OPT1600/3803-2
         AGO   .INCOMP
.DV1 AIF (&SGDU01B(&J) AND NOT &SGDAD8B(&J)).D01  1285 NO CTRL/UNIT
     AIF (&SGDU02B(&J) AND NOT &SGDAD1B(&J)).D01  1287 NO CTRL/UNIT
     AIF (&SGDU03B(&J) AND NOT &SGDAD1B(&J)).D01  1288 NO CTRL/UNIT
 AIF (&SGDU01B(&J) OR &SGDU04B(&J)).DV2     WTTA OR 1050X
 AIF (&SGDU02B(&J) OR &SGDU03B(&J)).DV2A   2741P OR 2741C
.*  S360,1130,2020,2780 REQUIRE 2701 OR 2703
 AIF (&SGUNU1B(&K) AND (&SGUNT2B(&K) OR &SGUNT3B(&K))).D01
 AGO .INCOMP
.DV2 AIF (&SGUNT2B(&K) AND (&SGUNU1B(&K) OR &SGUNU2B(&K))).D01
 AIF (&SGUNT3B(&K) AND &SGUNU1B(&K)).D01
.*  WTTA AND 1050X REQUIRE 2701,2702, OR 2703
 AGO .INCOMP
.* 2741P AND 2741C REQUIRE 2702 OR 2703 OR 2701
.DV2A AIF ((&SGUNT2B(&K) AND &SGUNU2B(&K)) OR (&SGUNT3B(&K) AND &SGUNU1*
               B(&K)) OR (&SGUNT2B(&K) AND &SGUNU1B(&K))).D01
 AGO .INCOMP
.*                  7770 OR 2955
.DTB1    AIF   (&SGDU04B(&J) OR &SGDU05B(&J) OR &SGDU06B(&J)).D01
.*       2265 WITH 2701
 AIF (&SGDU03B(&J) AND (&SGUNT2B(&K) AND &SGUNU1B(&K))).D01
 AIF (&SGDU03B(&J)).INCOMP  ERROR MESSAGE IF 2265 NOT ON 2701
.*  2740C OR 2740X NEED 2701, 2702, OR 2703
.DTB2   AIF   (&SGUNT2B(&K) AND (&SGUNU1B(&K) OR &SGUNU2B(&K))).D01
         AIF   (&SGUNT3B(&K) AND &SGUNU1B(&K)).D01
         AGO   .INCOMP
.*  2740C AND 2740X REQUIRE 2701, 2702, OR 2703
.DD1 AIF (&SGDU06B(&J) OR &SGDU07B(&J)).TSTCHN      2314 - 3330
 AIF (&SGDU08B(&J)).TSTCHN
 AIF (&SGUNT2B(&K) AND &SGUNU7B(&K)).CU2841  CTRL UNIT 2841
         AIF  (&SGUNT2B(&K) AND &SGUNU3B(&K)).CU2820   CTRL UNIT 2820
         AGO  .INCOMP     NO OTHER CTRL UNIT COMPAT. WITH A DA DEVICE
.CU2841  AIF  (&SGDU03B(&J) OR &SGDU04B(&J)).CNT1  DEV IS 2311 OR 2321
 AIF (&SGDU02B(&J) OR &SGDU05B(&J)).CNT1
 AGO .NOTSUP
.CU2820  AIF  (&SGDU01B(&J)).CNT2                  DEV IS 2301
         AGO  .NOTSUP     OTHER DEVICES ARE NOT SUPORTED
.CNT1 AIF (&SGUNF4B(&K)).CNT11
&MAXDEV  SETA  8
&OPTCHB  SETB  1  AFTER CHK NO DEV GO TO CHK  CHANNEL SWITCHING
         AGO   .CHKNBDV  GO  TO  CHECK  NO  OF  DEV
.CNT11  ANOP
&MAXDEV  SETA  16
&OPTCHB  SETB  1
  AGO  .CHKNBDV
.CNT2    ANOP    MAX OF  4  2301  WITH A  2820 CTRL UNIT
&OPTCHB  SETB  1 AFTER CHK NO OF DEV GO TO CHK CHANNEL SWITCHING
&MAXDEV  SETA  4
         AGO   .CHKNBDV
.*   CONSOLE  DEVICE     1052/3210/3213/3215/2150  DO NOT NEED CTRL UNT
.DC1     AIF   (&SGDU01B(&J) OR  &SGDU02B(&J) OR &SGDU03B(&J) OR       *
               &SGDU04B(&J) OR &SGDU08B(&J)).D01                 S99235
         AGO   .NOTSUP
.*             GRAPHIC  DEVICE
.DG1     AIF (&SGDU01B(&J)).DIS2250  2250 DOES NOT NEED CTRL UNIT
         AIF (&SGDU06B(&J)).DIS5450
.*                                                               S99235
         AIF  (&SGDU10B(&J) AND  &SGDT05B(&J)).D01  3158-ONE PER SYSTEM
         AIF  (&SGDU02B(&J) AND &SGUNT2B(&K) AND &SGUNU8B(&K)).DIS2260
         AIF  (&SGDU03B(&J) AND &SGUNT2B(&K) AND &SGUNU8B(&K)).DIS1053
 AIF (&SGDU04B(&J) AND &SGUNT2B(&K) AND &SGUNU6B(&K)).DIS2280
 AIF (&SGDU05B(&J) AND &SGUNT2B(&K) AND &SGUNU6B(&K)).DIS2282
         AIF (&SGUNT3B(&K) AND &SGUNU5B(&K) AND (&SGDU07B(&J) OR &SGDU0*
               8B(&J) OR &SGDU09B(&J))).D32XX
         AGO  .INCOMP       2260 AND 1053 NEED 2848 CTRL UNIT
.DIS2250 AIF  (&SGDM01B(&J)).CHKCNT1
 AIF (&SGDM02B(&J)AND&SGUNT2B(&K)AND&SGUNU6B(&K)AND&SGUNM1B(&K)).D22502
 AIF (&SGDM03B(&J)AND&SGUNT2B(&K)AND&SGUNU6B(&K)AND&SGUNM2B(&K)).D22503
 AGO .INCOMP
.DIS2280 ANOP
.DIS2282 AIF (&CTLPT EQ &K).E2   ONLY 1 2280 OR 2282 PER 2840
&CTLPT  SETA  &K             PLUS 3 2250 S
&MAXDEV  SETA   4
  AGO  .CHKNBDV
.E2 MNOTE 5,'* * * IEIGEN165 ONLY ONE 2280 OR 2282 ALLOWED ON 2840 '
&SGQUITB  SETB   1
   AGO  .D01
.D22502  ANOP
.D22503 ANOP
&MAXDEV  SETA   4
  AGO  .CHKNBDV
.CHKCNT1 ANOP    MAX OF 8 2250 MODEL 1  ON ONE CHANNEL
&CH      SETA  &CT/X'100'   TAKE CHANNEL NO
         AIF  (&CH EQ &OLDCH).TSTCNT2   IS THIS CHANNEL ALREADY USED
&OLDCH   SETA  &CH                      CHANNEL ADDR
&COUNT2  SETA  0                        ERASE DEVICE COUNT
         AGO  .INCPTR2
.TSTCNT2 AIF  (&COUNT2 LT 8).INCPTR2
    MNOTE 5,'* * * IEIGEN133 MAX OF EIGHT 2250 ON THE SAME CHANNEL EXCE*
               EDED'
&SGQUITB SETB  1
.INCPTR2 ANOP                           INCREASE  DEVICE COUNT
&COUNT2  SETA  &COUNT2+1
         AGO  .D01
.DIS2260 AIF  (&SGUNM1B(&K)).MOD1   2848 MODEL-1
         AIF  (&SGUNM2B(&K)).MOD2   2848 MODEL-2
         AIF  (&SGUNM3B(&K)).MOD3   2848 MODEL-3
 AIF (&SGUNM4B(&K) OR &SGUNM5B(&K)).MOD2122
         AGO  .INCOMP
.MOD1    ANOP    UP TO 24  2260  AND 1  1053  WITH A 2848-1
&MAXDEV  SETA  24
         AGO  .CHKNBDV
.MOD2    ANOP    UP TO 16  2260  AND 1  1053  WITH A 2848-2
&MAXDEV  SETA  16
         AGO  .CHKNBDV
.MOD3    ANOP    UP TO 8   2260  AND 1  1053  WITH A 2848-3
&MAXDEV  SETA  8
         AGO  .CHKNBDV
.MOD2122 AIF (NOT &SGDM02B(&J)).INCOMP      2260 MOD. 2 ONLY
 AIF (&SGUNM5B(&K)).MOD22
&MAXDEV  SETA  24
  AGO .CHKNBDV
.MOD22  ANOP
&MAXDEV  SETA  16
 AGO .CHKNBDV
 AGO .INCOMP
.DIS1053 ANOP
         AIF (&CNTPTR EQ &K).ER   IF ALREADY ONE 1053 ERROR
&CNTPTR  SETA  &K                     NO, CHANGE CTRL UNIT PTR
         AGO  .D01
.ER MNOTE 5,'* * * IEIGEN133 ONLY ONE 1053 ALLOWED ON THIS CTRL UNIT'
&SGQUITB SETB  1
         AGO  .D01
.DIS5450  AIF (&SGDF01B(&J)).DIS3066
          AIF  (&SGCPUB(7) AND &SGSCHDB(34)).D01
    MNOTE 5,'* * * IEIGEN137 5450 DISPLAY UNIT REQUIRES MODEL 85 AND MCX
               S'
&SGQUITB SETB 1
         AGO .D01
.*       ***** CHECK CONTROL UNIT AND DEVICE MODEL COMPATABILITY *****
.D32XX   ANOP
         AIF (&SGUNM1B(&K) AND &SGDM01B(&J)).NUMDEV
         AIF (&SGUNM2B(&K) AND (&SGDM01B(&J) OR &SGDM02B(&J))).NUMDEV
         AGO   .INCOMP
.NUMDEV  ANOP       UP TO 32 32XX-1 WITH A 3272-1
.*                  UP TO 32 32XX-(1 OR 2) WITH A 3272-2
&MAXDEV  SETA  32
         AGO   .CHKNBDV
.DIS3066 AIF ((&SGCPUB(11) OR &SGCPUB(15)) AND &SGSCHDB(34)).D01 S99235
        AIF  (NOT &SGSCHDB(34)).UX                                M5069
&U     SETA  1                                                    M5069
.U AIF   (&SGMOD9B(&U) OR &SGMODBB(&U)).D01  SECMODS EQ 165/168   M5069
       AIF   (&U GT 5).UX                                         M5069
&U     SETA  &U+1                                                 M5069
       AGO  .U                                                    M5069
.UX MNOTE 5,'* * * IEIGEN250 3066 DISPLAY UNIT REQUIRES MODEL 165 OR 16*
               8 WITH MCS'                                       S99235
&SGQUITB SETB 1
         AGO  .D01
.DP1     ANOP       DEVICE IS PRINTER
         AIF   (&SGDU03B(&J)).D01       NO CTRL UNIT NEEDED FOR 1443
  AIF   (&SGDU04B(&J) OR &SGDU05B(&J)).D01  NOT CTRL UNIT FOR 1275/1419
  AIF    (&SGDU07B(&J)).D01   NO CTRL UNIT NEEDED FOR 2245
   AIF (&SGDU02B(&J) AND &SGUNT2B(&K) AND &SGUNU4B(&K) AND &SGUNM4B(&K)*
               ).PRT1404 WITH 2821-4 CTRL UNIT
      AIF (&SGDU01B(&J) AND &SGUNT2B(&K) AND &SGUNU4B(&K) AND &SGUNM4B(*
               &K)).PRT1404 ALLOWS 1404 TO BE SPECIFIED AS 1403-2821-4
    AIF  (&SGDU01B(&J) AND &SGUNT2B(&K) AND &SGUNU4B(&K)).PRT1403
    AIF (&SGDU06B(&J) AND &SGUNT3B(&K) AND &SGUNU2B(&K)).PRT3211
    AGO  .INCOMP
.PRT1404   ANOP    MAX  OF ONE  1404 PRT WITH CTRL UNIT 2821-4
&MAXDEV  SETA  1   MAX  OF ONE  1403 PRT WITH CTRL UNIT 2821-1 OR -2
         AGO  .CHKNBDV
.PRT1403 AIF  (&SGUNM1B(&K) OR &SGUNM2B(&K)).PRT1404  CTRL UNIT MOD-1-2
         AIF  (&SGUNM3B(&K)).CTLMOD3   CTRL UNIT   2821-3
         AIF  (&SGUNM5B(&K)).CTLMOD5   CTRL UNIT   2821-5
         AGO  .INCOMP
.CTLMOD3 ANOP    MAX OF THREE 1403 PRT WITH 2821-3
&MAXDEV  SETA  3
         AGO  .CHKNBDV
.PRT3211 ANOP  MAX OF ONE 3211 PRT WITH CTRL UNIT 3811
&MAXDEV  SETA  1
         AGO  .CHKNBDV
.CTLMOD5 ANOP   MAX OF THREE 1403 PRT WITH 2821-5
&MAXDEV  SETA  3
         AGO  .CHKNBDV
.DU1     ANOP    READ PUNCH DEVICE
 AIF (&SGDU07B(&J)).D01   2495 NO CTRL/UNIT
         AIF   (&SGDU08B(&J) OR &SGDU09B(&J)).RP35  ** 3505 OR 3525
.*                                      3505 IS CONTROL UNIT FOR 3525
 AIF (&SGDU01B(&J) OR &SGDU02B(&J) OR &SGDU03B(&J)).D01
 AIF (&SGDU06B(&J) AND (&SGUNT2B(&K) AND &SGUNU5B(&K))).D01
.*                                             NO CTRL UNIT NEEDED
         AIF  ((&SGDU04B(&J) OR &SGDU05B(&J)) AND &SGUNT2B(&K) AND &SGUX
               NU4B(&K) AND (&SGUNM1B(&K) OR &SGUNM4B(&K) OR &SGUNM5B(&X
               K) OR &SGUNM6B(&K))).D01                        @SA79798
.* 2540R OR 2540P WITH CTRL UNIT 2821 MODEL-1, -4, -5 OR -6    @SA79798
         AGO  .INCOMP
.*       TELECOMMUNICATION DEVICES
.*   1030,1050,1060,115A,83B3,TWX CAN BE ATTACHED TO 2701,2702,2703
.*   ADAPTER TYPES ARE CHECKED IN IODEVICE
.DX1     ANOP
 AIF (&SGDU01B(&J)OR&SGDU02B(&J)OR&SGDU03B(&J)OR&SGDU05B(&J)OR&SGDU06B(*
               &J)OR&SGDU07B(&J)AND((&SGUNT2B(&K)AND(&SGUNU1B(&K)OR&SGU*
               NU2B(&K)))OR(&SGUNT3B(&K)AND&SGUNU1B(&K)))).D01
.*    2260  CAN BE ATTACHED TO 2848
 AIF (&SGDU04B(&J) AND &SGUNT2B(&K) AND &SGUNU1B(&K)).D01
.*      2740 CAN BE ATTACHED TO 2701,2702,2703
 AIF (&SGDU08B(&J) AND ((&SGUNT3B(&K) AND &SGUNU1B(&K)) OR (&SGUNT2B(&K*
               ) AND &SGUNU2B(&K)) OR (&SGUNT2B(&K) AND &SGUNU1B(&K))))*
               .D01
   AGO  .INCOMP
.RP35    AIF   (&TWO).D01
         AIF   (&SG3505A GE &SG3525A).D01    MORE RDRS THAN PUNCHES?
    MNOTE 5,'* * * IEIGEN251 GREATER NUMBER OF 3525 PUNCHES THAN 3505  *
                               CONTROL UNITS '
&TWO     SETB  1
&SGQUITB SETB  1
         AGO   .D01
.M2  ANOP
&J SETA (&CT/256)
 CONVERT TO=EBCDIC,DIGITS=3,VALUE=&CT
&ADDRESI SETC '&EBCDIC'(1,1)
    MNOTE 5,'* * * IEIGEN164 ADDRESS &EBCDIC REQUIRES CHANNEL &ADDRESI'
&SGQUITB  SETB  1
   AGO  .D01
.*  CHECK THAT ALL CHANNELS HAVE A DEVICE
.D99  ANOP
&TWO     SETB  0
&I  SETA  0
.M4 AIF (&I EQ 16).M3
&I  SETA  &I+1
 AIF (NOT (&CHAN(&I))).M4
&CT  SETA  &I-1
 CONVERT TO=EBCDIC,DIGITS=1,VALUE=&CT
    MNOTE 5,'* * * IEIGEN165 CHANNEL &EBCDIC CONTAINS NO DEVICES '
&SGQUITB  SETB  1
  AGO  .M4
.*  MODEL 30 AND  40  ALOW ONLY 3 CHANNELS
.M3 AIF (NOT((&SGCPUB(1) OR &SGCPUB(2)) AND (&SGCNTRA(1) GT 3 ))).SUITE
    MNOTE 5,'* * * IEIGEN137 ONLY 3 CHANNELS VALID ON MODEL 30 OR 40'
&SGQUITB SETB  1
.*       END OF HARDWARE COMPATIBILITY CHECK
.SUITE   ANOP      CHECK SCHEDULER MACRO
.* CHECK FOR SUPRVSOR - SCHEDULR - CNTRLPROG COMPATIBILITY
 AIF (&SGSUPRA(2) EQ 0).NOTAL        ALTSYS
 IOCHECK LOOKFOR=&SGSUPRA(2)
 AIF (&HEX EQ 0).BADALT
&HEX SETA &SGDADRA(&HEX)/1048576       GET DEVICE POINTER
 AIF ('&RESTYPE' EQ '2311' AND &SGDT03B(&HEX) AND &SGDU03B(&HEX)).NOTAL
 AIF ('&RESTYPE' EQ '2301' AND &SGDT03B(&HEX) AND &SGDU01B(&HEX)).NOTAL
 AIF ('&RESTYPE' EQ '2303' AND &SGDT03B(&HEX) AND &SGDU05B(&HEX)).NOTAL
 AIF ('&RESTYPE' EQ '2314' AND &SGDT03B(&HEX) AND &SGDU06B(&HEX)).NOTAL
 AIF ('&RESTYPE' EQ '3330' AND &SGDT03B(&HEX) AND &SGDU07B(&HEX)).NOTAL
 AIF ('&RESTYPE' EQ '2305-1' AND &SGDT03B(&HEX) AND &SGDU08B(&HEX)).NOT*
               AL
 AIF ('&RESTYPE' EQ '2305-2' AND &SGDT03B(&HEX) AND &SGDU08B(&HEX)).NOT*
               AL
.BADALT ANOP
 MNOTE 5,'* * * IEIGEN225 INVALID ALTSYS IN SUPRVSOR MACRO'
&SGQUITB SETB 1
.NOTAL   AIF (NOT &SGSUPRB(34)).OVCKRD
         AIF ('&RESTYPE' NE '2305-1' AND '&RESTYPE' NE '2305-2' AND    X
               '&RESTYPE' NE '2303' AND '&RESTYPE' NE '2301').OVCKRD
    MNOTE 5,'* * * IEIGEN305 DDRSYS INVALID WITH SYSRES AS &RESTYPE'
&SGQUITB   SETB  1
.OVCKRD    AIF  (NOT &SGMENTB(86)).RATEST    WAS ALTCTRL SPECIFIED
 AIF (&SGCPRGB(13)).RATEST         M65MP
 MNOTE 5,'* * * IEIGEN224 ALTCTRL FEATURE ON IODEVICE OR IOCONTRL VALID*
                FOR M65MP ONLY'
&SGQUITB SETB 1
.RATEST AIF (NOT &SGDCLSB(72) OR &SGSUPRB(26)).WTOTST OLTEP OR NOT RA
&SGSUPRB(26) SETB 1
   MNOTE 0,'* * * IEIGENW21 ONLNTEST IS INCLUDED BY DEFAULT WITH 2955'
.WTOTST   ANOP                                                   S99247
.*                            DEFAULT WTOBFRS                    S99247
          AIF  (&SGSCHDB(34)).RPLTST         MCS?                S99247
          AIF   (&SGSCHDA(2) NE 0).OTHRTST                       S99247
          AIF   (&SGCPRGB(4)).MFT        MFT                     S99247
.*                                       ASSUME MFT              S99247
&SGSCHDA(2) SETA 40                      DEFAULT WTOBFRS         S99247
      AGO   .WTOPRT                                              S99247
.MFT      ANOP                                                   S99247
&SGSCHDA(2) SETA 20                      DEFAULT MFT WTOBFRS     S99247
          AGO   .WTOPRT                                          S99247
.OTHRTST  ANOP                                                   S99247
          AIF   (&SGSUPRB(26) AND (&SGSCHDA(2) LT 3)).SET3 ONLNTEST AND
.*                                       LESS THAN 3 BUFFERS     S99247
          AIF   (&SGMENTB(58) AND (&SGSCHDA(2) LT 2)).SET2 EMULATOR AND
.*                                       LESS THAN 2 BUFFERS     S99247
          AGO   .RPLTST                                          S99247
.SET2     ANOP                                                   S99247
&SGSCHDA(2) SETA 2                       DEFAULT WTOBFRS         S99247
          AGO   .WTOPRT                                          S99247
.SET3     ANOP                                                   S99247
&SGSCHDA(2) SETA 3                       DEFAULT                 S99247
.WTOPRT MNOTE 0,'* * * IEIGENW12 &SGSCHDA(2) WTOBFRS DEFAULTED BASED ON*
                MFT/MVT/ONLNTEST/EMULATOR'                       S99247
.RPLTST   ANOP                           DEFAULT REPLY BUFFERS   S99247
          AIF   (&SGSCHDA(1) NE 0).TSTOE                         S99247
          AIF   (&SGCPRGB(4)).RPLMFT     MFT                     S99247
&SGSCHDA(1) SETA 20                      DEFAULT REPLY BUFFERS   S99247
          AGO   .RPLPRT                                          S99247
.RPLMFT   ANOP                                                   S99247
&SGSCHDA(1) SETA 10                      DEFAULT MFT REPLY BUFFERS99247
          AGO   .RPLPRT                                          S99247
.TSTOE    ANOP                                                   S99247
          AIF   (&SGMENTB(58) AND (&SGSCHDA(1) LT 2)).RPL2       S99247
          AGO   .TSTIME                                          S99247
.RPL2     ANOP                                                   S99247
&SGSCHDA(1) SETA 2                       DEFAULT FOR EMULATOR    S99247
.RPLPRT MNOTE 0,'* * * IEIGENW13 &SGSCHDA(1) REPLY BUFFERS DEFAULTED'
.TSTIME AIF (NOT &SGSCHDB(44)).TT1 IF NOT TSO, DON'T NEED TCAM
        AIF (&SGDMGTB(5)).TT1      TEST FOR TCAM
 MNOTE 0,'* * * IEIGENW71 ACSMETH=TCAM DEFAULTED FOR TSO'
&SGDMGTB(5) SETB 1                 TURN ON TCAM BIT
.TT1    AIF (&SGSUPRB(14) OR &SGSUPRB(19) OR NOT &SGSUPRB(26)).TT2
 MNOTE 0,'* * * IEIGENW19 TIMER=INTERVAL DEFAULTED FOR ONLNTEST'
        AGO .TT3
.* TEST FOR BTAM/QTAM/TCAM, OR CRJE (WHICH IMPLIES BTAM)
.TT2     AIF   (NOT(&SGDMGTB(3) OR &SGDMGTB(4) OR &SGDMGTB(5) OR &SGSCH*
               DB(8))).TT5         IF NONE OF THESE, SKIP TIMER TEST
         AIF   (&SGSUPRB(19) OR (&SGSUPRB(14) AND &SGSUPRB(16))).TT4
    MNOTE 0,'* * * IEIGENW10 TIMER=INTERVAL DEFAULTED FOR BTAM/QTAM/TCA*
               M'
.TT3     ANOP
&SGSUPRB(13) SETB 0
&SGSUPRB(14) SETB 1
&SGSUPRB(16) SETB 1
.TT4     ANOP
.TT5     AIF   (NOT &SGCPRGB(4)).SUP1   MFT
         AIF   (&SGSUPRB(21)).TT7       RESIDNT=ACSMETH
         AIF   (NOT &SGSCHDB(7)).TT6    SMF
    MNOTE 5,'* * * IEIGEN178 RESIDNT=ACSMETH REQUIRED IN MFT WITH SMF'
&SGQUITB SETB  1
.TT6     AIF   (NOT &SGSCHDB(38)).TT7   LOG OPTION
    MNOTE 5,'* * * IEIGEN179 RESIDNT=ACSMETH REQUIRED IN MFT WITH SCHED*
               ULR OPTION=LOG'
&SGQUITB SETB  1
.TT7     AIF   (&SGCPRGB(4) AND (&SGSUPRB(19) OR &SGSUPRB(14) OR &SGSUP*
               RB(13))).SUP1            MFT WITH TIMER
    MNOTE 0,'* * * IEIGENW12  GTF TRACE RECORDS WILL NOT BE TIMESTAMPED*
                - TIMER SUPPORT NOT REQUESTED'
.SUP1    AIF   (NOT(&SGSUPRB(25))).CHKTYP
  AIF  (NOT(&SGSUPRB(3))).SUP2
         AGO   .CHKTYP
.SUP2    AIF   (&SGCPRGB(8)).CHKTYP
    MNOTE 5,'* * * IEIGEN181 OPTIONS=TRSVCTBL REQUIRED WITH RESIDNT=TRS*
               VC FOR MFT'
&SGQUITB SETB 1
.CHKTYP  AIF  (NOT &SGSUPRB(37)).CHKTYP2 NO ASYNCHRONOUS ATTACH
         AIF  (&SGCPRGB(4)).CHKTYP2   MFT SYSTEM
 MNOTE 0,'* * * IEIGENW18 WARNING- ASYNCHRONOUS ATTACH FUNCTION-OPTIONSX
               =ATTACH- IS VALID IN MFT SYSTEM ONLY AND HAS BEEN DELETED
               D'
&SGSUPRB(37) SETB  0
.CHKTYP2  ANOP
.* CHECK FOR CTRLPROG STORAGE AND SCHEDULER
   AIF (&SGCPRGB(8)).MS1
         AIF   (NOT &SGCPRGB(14)).OKPWF                          S21167
    MNOTE 5,'* * * IEIGEN176 CTRLPROG VALUE WARN INVALID WITH MFT'
&SGQUITB SETB  1                                                 S21167
.OKPWF   AIF   (&SGCPRGB(4) AND &SGSCHDB(2)).B41                 S21167
    MNOTE 5,'* * * IEIGEN146 CTRLPROG INCOMPATIBLE WITH SCHEDULR'
&SGQUITB SETB  1
.B41     ANOP    CHECK FOR SIZES BEING MULTIPLE OF 8 OR 2048
&A       SETA  8
         AIF   (NOT (&SGSUPRB(23))).B411
&A       SETA  2048
.B411    AIF   (&SGCPRGA(2)/&A*&A NE &SGCPRGA(2)).B4
         AIF  (&SGCPRGA(3)/&A*&A NE &SGCPRGA(3)).B4
         AIF  (&SGCPRGA(4)/&A*&A EQ &SGCPRGA(4)).B413
.B4 MNOTE 5,'* * * IEIGEN147 CTRLPROG SIZE NOT A MULTIPLE OF &A'
&SGQUITB SETB  1
   AGO  .B413
.MS1     AIF   ((&SGCPRGB(13) EQ &SGSCHDB(33)) AND (&SGCPRGB(8) EQ &SGS*
               CHDB(3))).MS13                                    S99247
    MNOTE 5,'* * * IEIGEN146 CTRLPROG INCOMPATIBLE WITH SCHEDULR'
&SGQUITB SETB 1
.*                           SEQ # 417000-419500 REMOVED FOR S99247
.MS13 AIF (NOT(&SGCPUB(30) OR &SGCPUB(31) OR &SGCPUB(32))).MS14
    MNOTE 5,'* * * IEIGEN168 INSTSET STD,COMM,OR SCNTF INVALID WITH MVT*
               '
&SGQUITB SETB 1
.MS14 AIF (NOT &SGCPUB(2)).MS15     MOD 40
   AIF (&SGCPUB(33) AND &SGCPUB(41)).MS15
    MNOTE 5,'* * * IEIGEN169 INSTSET=UNIV AND FEATURE=PROTECT REQUIRED *
               WITH MODEL 40 WITH MVT'
&SGQUITB SETB 1
.MS15 AIF (NOT &SGSUPRB(4)).MS16
   AIF (NOT &SGSUPRB(27)).MS15A        SHOULD IGNORE VALIDYCHK
    MNOTE 5,'* * * IEIGEN170 VALIDCHK INVALID WITH MVT'
&SGQUITB SETB 1
.MS15A   ANOP
&SGSUPRB(4)  SETB  0
.MS16 AIF (NOT(&SGSUPRB(13))).MS17
    MNOTE 5,'* * * IEIGEN171 TIMER=TIME INVALID WITH MVT'
&SGQUITB SETB 1
.MS17    AIF   (&SGSUPRB(14) OR &SGSUPRB(19)).MS19
    MNOTE 5,'* * * IEIGEN172 TIMER=INTERVAL OR JOBSTEP REQUIRED WITH MV*
               T'
&SGQUITB SETB 1
.MS19 AIF (&SGSUPRB(23)).MS1A
    MNOTE 5,'* * * IEIGEN174 PROTECT REQUIRED AS SUPRVSOR OPTION WITH M*
               VT'
&SGQUITB  SETB  1
.MS1A   AIF   (&GETB(3)).MS1END
         AIF   ('&SGSCHDC(9)' EQ '').MS1B
&ADDRESI SETC '&SGSCHDC(9)'(1,3)            ADDRESS OF JOBQRES
         CONVERT TO=HEX,VALUE=&ADDRESI,DIGITS=3
         IOCHECK LOOKFOR=&HEX
   AIF (&HEX NE 0).MS1B                     ADDRESS OK
    MNOTE 5,'* * * IEIGEN175 NON-EXISTENT ADDRESS &ADDRESI FOR JOBQRES *
               IN SCHEDULR MACRO'
.MS1B AIF ('&SGSCHDC(10)' EQ '').MS1END     NO PROCRES
&ADDRESI SETC '&SGSCHDC(10)'(1,3)           ADDRESS OF PROCRES
         CONVERT TO=HEX,VALUE=&ADDRESI,DIGITS=3
         IOCHECK LOOKFOR=&HEX
   AIF (&HEX NE 0).MS1END                   ADDRESS OK
    MNOTE 5,'* * * IEIGEN176 NON-EXISTENT ADDRESS &ADDRESI FOR PROCRES *
               IN SCHEDULR MACRO'
&SGQUITB SETB 1
.MS1END ANOP
.TSTQT1 ANOP
   AIF (&SGQUITB EQ 1).B413
    MNOTE *,'      * * * MVT ASSUMED SUPRVSOR FUNCTIONS * * *'
    MNOTE *,'      IDENTIFY OPTION - TRSVCTBL OPTION - IDENTIFY, EXTRAC*
               T, AND SPIE ARE RESIDENT - MULTIPLE WAIT'
&SGSUPRB(1) SETB 1
&SGSUPRB(3) SETB 1
&SGSUPRB(5) SETB 1
&SGSUPRB(6) SETB 1
&SGSUPRB(7) SETB 1
&SGSUPRB(8) SETB 1
&SGSUPRB(12) SETB 1
.B413 ANOP
.*  CHECK FOR SUPRVSOR PROTECTION
.ONB     AIF   (NOT (&SGSUPRB(23) AND (NOT &SGCPUB(41)))).ONC
    MNOTE 5,'* * * IEIGEN153 SUPRVSOR PROTECT OPTION REQUIRES CENPROCS *
               STORAGE PROTECTION FEATURE'
&SGQUITB SETB  1
.ONC  ANOP
        AIF  (NOT &SGSCHDB(7)).ONE  NO SMF
       AIF  (&SGSUPRB(19)).ONE  JOBSTEP TIMER
    MNOTE 5,'* * * IEIGEN203 SMF ACCOUNT ROUTINES REQUIRES SUPRVSOR JOBX
               STEP TIMER'
&SGQUITB  SETB  1
.ONE     ANOP
.*  CHECK CONSOLE ADDR
 AIF ((NOT &SGMENTB(6)) OR '&SGSCHDC(1)' EQ '').N4
&TABLADR SETA 0            USE TO SAVE 2250 POINTER
&CONA    SETA  1                   1ST CONSOLE POINTER
.ONF     ANOP
&ADDRESI SETC  '&SGSCHDC(&CONA)'(1,3)
         CONVERT TO=HEX,DIGITS=3,VALUE=&ADDRESI
         IOCHECK LOOKFOR=&HEX
         AIF   (&HEX EQ 0).NFOUNDI   ADDRESS INVALID
&HEX SETA &SGDADRA(&HEX)/1048576  GET DEVICE POINTER
    AIF (&SGDT04B(&HEX)AND NOT &SGSCHDB(34)).FOUNDI  CONSLE-NO MCS
 AIF (&SGSCHDB(34)AND ((&SGDT04B(&HEX)AND &SGDU01B(&HEX)AND &SGDM01B(&H*
               EX))OR (&SGDT04B(&HEX)AND &SGDU02B(&HEX)))).FOUNDI  MCS
.*                                                              S99235
         AIF  (&SGSCHDB(34) AND (&SGDT04B(&HEX) AND (&SGDU03B(&HEX) OR *
               &SGDU04B(&HEX) OR &SGDU08B(&HEX)))).FOUNDI        S99233
.*                                     3210/3213/3215 CONSOLES   S99233
 AIF (&SGDT07B(&HEX) AND (&SGDU02B(&HEX) OR &SGDU03B(&HEX) OR &SGDU04B(*
               &HEX) OR (&SGDU01B(&HEX) AND &SGDM01B(&HEX)))).FOUNDR
         AIF   (&SGDT07B(&HEX) AND (&SGDU08B(&HEX) OR &SGDU09B(&HEX))).*
               FOUNDR                 **RDR OR PUNCH EQ 3505 OR 3525**
     AIF (&SGDT05B(&HEX) AND &SGDU01B(&HEX)).FOUNDI       2250
 AIF (&SGDT05B(&HEX) AND &SGDU06B(&HEX)).FOUNDI            5450/3066
 AIF (&SGSCHDB(34)AND &SGDT08B(&HEX)AND &SGDU08B(&HEX)).FOUNDI  2740MCS
 AIF (&SGDT05B(&HEX) AND &SGDU02B(&HEX)).FOUNDI            2260
         AIF (&SGDT05B(&HEX) AND (&SGDU08B(&HEX) AND &SGDM02B(&HEX))).F*
               OUNDA                         3277-2
          AIF (&SGDT05B(&HEX) AND &SGDU10B(&HEX)).FOUNDA   3158  S99235
.NFOUNDI ANOP    INVALID CONSOLE INPUT ADDR
    MNOTE 5,'* * * IEIGEN138 SCHEDULR MACRO, ADDRESS &ADDRESI INVALID F*
               OR CONSOLE INPUT'
&SGQUITB SETB  1
 AGO .CHECKO
.FOUNDA AIF  (&SGSCHDB(34)).FOUNDI      MCS?                    SA65016
     MNOTE 5,'* * * IEIGEN311 MCS NOT SPECIFIED'
&SGQUITB SETB 1
         AGO   .CHKTGRI
.FOUNDR ANOP
&ADDRESO SETC '&SGSCHDC(&CONA)'(4,3)   * IF OUTPUT ADDR EQ RDR ADDR,
    AIF ('&ADDRESI' EQ '&ADDRESO').NFOUNDO   *  THEN INVALID
.FOUNDI  AIF (&SGSCHDA(16) EQ 0).CHKTGRI
         AIF (&SGDT05B(&HEX) AND (&SGDU01B(&HEX) OR &SGDU02B(&HEX)) AND*
               (NOT &SGSCHDB(34))).NMCSA     2250/2260 W/O MCS AS CONSL
         AIF (&SGDT05B(&HEX) AND &SGDU01B(&HEX) AND (&SGDF02B(&HEX) OR *
               &SGDF03B(&HEX))).CHKTGRI      2250 WITH PFK OR LIGHTPEN
         AIF (&SGDT05B(&HEX) AND &SGDU08B(&HEX) AND &SGDM02B(&HEX)).CHK*
               TGRI             3277 MODEL 2                      67190
         AIF (&SGDT05B(&HEX) AND &SGDU10B(&HEX)).CHKTGRI        SA69945
    MNOTE 5,'* * * IEIGEN300 SCHEDULR MACRO, CONSOLE ADDRESS &ADDRESI -*
               PFK SPECIFICATION INVALID'
&SGQUITB SETB 1
         AGO   .CHKTGRI
.NMCSA   ANOP      2250 AND 2260 AS CONSOLES REQUIRE MCS
    MNOTE 5,'* * * IEIGEN310 IODEVICE MACRO, 2250/2260 AS CONSOLES REQU*
               IRE MCS'
&SGQUITB SETB 1
.CHKTGRI AIF (&SGTGRIA(32) EQ 0).CHECKO
         AIF (&SGDT05B(&HEX) AND (&SGDU01B(&HEX) OR &SGDU02B(&HEX) OR &*
               SGDU06B(&HEX) OR &SGDU08B(&HEX) OR &SGDU10B(&HEX))).CHEC*
               KO                                                S99235
&SGTGRIA(32) SETA 0
    MNOTE 0,'* * * IEIGENW19 SCHEDULR MACRO, CONSOLE ADDRESS &ADDRESI -*
               OPSTRNI SPECIFICATION INVALID AND HAS BEEN IGNORED'
.CHECKO  ANOP  CHECK CONSOLE OUTPUT ADDRESS
&ADDRESO SETC  '&SGSCHDC(&CONA)'(4,3)
         AIF   ('&ADDRESI' EQ '&ADDRESO' AND &HEX EQ 0).CHKALT
         AIF   ('&ADDRESI' EQ '&ADDRESO').FDCON
         CONVERT TO=HEX,DIGITS=3,VALUE=&ADDRESO
         IOCHECK LOOKFOR=&HEX
         AIF  (&HEX EQ 0).NFOUNDO
&HEX SETA &SGDADRA(&HEX)/1048576  GET DEVICE POINTER
     AIF  (&SGDT04B(&HEX) OR (&SGDT06B(&HEX) AND (&SGDU01B(&HEX) OR &SGX
               DU02B(&HEX) OR &SGDU03B(&HEX)))).FDCON   CONS OR PRINT
     AIF (&SGDT06B(&HEX) AND &SGDU06B(&HEX)).FDCON     3211
         AIF (&SGDT05B(&HEX) AND (&SGDU07B(&HEX) OR &SGDU09B(&HEX))).FD*
               CON                           3284 OR 3286
         AIF (&SGDT05B(&HEX) AND (&SGDU10B(&HEX) OR &SGDU08B(&HEX) AND *
               &SGDM02B(&HEX))).FOUNDO      3158/3277-2          S99235
 AIF (&SGDT05B(&HEX) AND &SGDU06B(&HEX)).FOUNDO            5450
 AIF (&SGSCHDB(34)AND &SGDT08B(&HEX)AND &SGDU08B(&HEX)).FDCON    2740
         AIF (&SGDT05B(&HEX) AND (&SGDU01B(&HEX) OR &SGDU02B(&HEX)) AND*
                &SGSCHDB(34)).FOUNDO         2250/2260 WITH MCS
.NFOUNDO ANOP    INVALID CONSOLE OUTPUT
    MNOTE 5,'* * * IEIGEN138 SCHEDULR MACRO, ADDRESS &ADDRESO INVALID F*
               OR CONSOLE OUTPUT    '
&SGQUITB SETB  1
 AGO .CHKALT
.FDCON   ANOP
         AIF (&SGDT05B(&HEX) AND (&SGDU07B(&HEX) OR &SGDU09B(&HEX))).HD*
               COPY                          3284 OR 3286
  AIF (NOT(&SGDT04B(&HEX) OR (&SGDT06B(&HEX) AND (&SGDU01B(&HEX) OR &SGX
               DU02B(&HEX) OR &SGDU03B(&HEX) OR &SGDU06B(&HEX))) OR (&SX
               GDT08B(&HEX) AND &SGDU08B(&HEX)))).FOUNDO
.HDCOPY  ANOP                           SET HARDCOPY SW FOR PRINTERS
&AC      SETB  1
         AGO .CHKTGRO
.FOUNDO  AIF ('&SGSCHAA(12)' NE '0' AND NOT(&SGDT05B(&HEX) AND (&SGDU01*
               B(&HEX) OR &SGDU02B(&HEX) OR &SGDU06B(&HEX) OR (&SGDU08B*
               (&HEX) AND &SGDM02B(&HEX)) OR &SGDU10B(&HEX)))).MB 99235
         AIF (NOT &SGSCHDB(34)).CHKALT
         AIF (NOT(&SGDT05B(&HEX) AND (&SGDU01B(&HEX) OR &SGDU06B(&HEX) *
               OR &SGDU08B(&HEX)))).A2260    2250/5450/3066/3277
         AIF ((&SGDU01B(&HEX) AND '&SGSCHAA(12)' GT '47') OR (&SGDU06B(*
               &HEX) AND '&SGSCHAA(12)' GT '30')).MB   ERROR
         AIF (&SGDU08B(&HEX) AND '&SGSCHAA(12)' GT '19').MB ERROR
.*                                                               S99235
         AIF (&SGDU10B(&HEX) AND '&SGSCHAA(12)' GT '19').MB ERROR/3158
         AIF ('&SGSCHAA(12)' NE '0').CHKTGRO
&SGSCHAA(1)  SETA 14                                   DEFAULT 14
&SGSCHAA(12) SETA 14
         AGO .MA
.A2260   AIF (NOT(&SGDT05B(&HEX) AND &SGDU02B(&HEX))).CHKTGRO 2260
         AIF ('&SGSCHAA(12)' GT '8').MB                ERROR
         AIF ('&SGSCHAA(12)' NE '0').CHKTGRO
&SGSCHAA(1)  SETA 8                                    DEFAULT 8
&SGSCHAA(12) SETA 8
.MA MNOTE *,'CONSOLE ADDRESS &ADDRESO, STATUS DISPLAY AREA DEFAULTED   *
               TO LENGTH OF &SGSCHAA(1)'
         AGO .CHKTGRO
.MB MNOTE 5,'* * * IEIGEN301 SCHEDULR MACRO, DISPLAY AREA DEFINED INVAL*
               ID FOR CONSOLE ADDRESS &ADDRESO'
&SGQUITB SETB  1
.CHKTGRO AIF (&SGTGROA(32) EQ 0).CHKALT
         AIF (&SGDT05B(&HEX) AND (&SGDU01B(&HEX) OR &SGDU02B(&HEX) OR &*
               SGDU06B(&HEX) OR &SGDU08B(&HEX) OR &SGDU10B(&HEX))).CHKA*
               LT                                                S99235
&SGTGROA(32) SETA 0
    MNOTE 0,'* * * IEIGENW19 SCHEDULR MACRO, CONSOLE ADDRESS &ADDRESO -*
               OPSTRAN SPECIFICATION INVALID AND HAS BEEN IGNORED'
.*   CHECK ALTERNATE CONSOLE
.CHKALT  AIF   ('&SGSCHDC(12)' EQ '' OR &CONA EQ 12).FNDA
&CONA    SETA  12                  2ND CONSOLE POINTER
         AGO   .ONF
.FNDA    ANOP
         AIF   ('&SGSCHDC(1)' EQ '&SGSCHDC(2)').N3
.*  CHECK ALT CONS INPUT IS CONSOLE OR READER DEVICE
&CONA    SETA  2                   1ST ALTCONS POINTER
.FNDB    ANOP
&ADDRESI SETC  '&SGSCHDC(&CONA)'(1,3)   ADD  CONS. INPUT
    AIF (('&ADDRESI' EQ 'FFF' OR '&ADDRESI' EQ '')AND &CONA EQ 13).N4
 AIF ('&ADDRESI' EQ 'FFF' OR '&ADDRESI' EQ '').N3
         CONVERT TO=HEX,VALUE=&ADDRESI,DIGITS=3
         IOCHECK LOOKFOR=&HEX
         AIF  (&HEX EQ 0).NFDIN    THIS DEVICE DOES NOT EXIST
&HEX SETA &SGDADRA(&HEX)/1048576  GET DEVICE POINTER
    AIF (&SGDT04B(&HEX)AND NOT &SGSCHDB(34)).FDIN  ALT CONSLE-NO MCS
 AIF (&SGSCHDB(34)AND ((&SGDT04B(&HEX)AND &SGDU01B(&HEX)AND &SGDM01B(&H*
               EX))OR (&SGDT04B(&HEX)AND &SGDU02B(&HEX)))).FDIN    MCS
 AIF (&SGSCHDB(34) AND ((&SGDT04B(&HEX) AND &SGDU03B(&HEX)) OR (&SGDT04X
               B(&HEX) AND &SGDU04B(&HEX)))).FDIN      MCS / 3210 3215
 AIF (&SGDT07B(&HEX) AND (&SGDU02B(&HEX) OR &SGDU03B(&HEX) OR &SGDU04B(*
               &HEX) OR (&SGDU01B(&HEX) AND &SGDM01B(&HEX)))).FNDRDR
         AIF   (&SGDT07B(&HEX) AND (&SGDU08B(&HEX) OR &SGDU09B(&HEX))).*
               FNDRDR                 **RDR OR PUNCH EQ 3505 OR 3525**
         AIF (&SGDT05B(&HEX) AND (&SGDU01B(&HEX) OR &SGDU02B(&HEX)) AND*
                &SGSCHDB(34)).FDIN           2250/2260 WITH MCS
 AIF (&SGDT05B(&HEX) AND &SGDU06B(&HEX)).FDIN              5450
 AIF (&SGSCHDB(34)AND &SGDT08B(&HEX)AND &SGDU08B(&HEX)).FDIN    2740MCS
          AIF (&SGDT05B(&HEX) AND ((&SGDU08B(&HEX) AND &SGDM02B(&HEX)) *
               OR &SGDU10B(&HEX))).FNDBA      3158/3277-2        S99235
.NFDIN   ANOP   INVALID ALTERNATE CONSOL INPUT
    MNOTE 5,'* * * IEIGEN138 SCHEDULR MACRO, ADDRESS &ADDRESI INVALID F*
               OR ALT.CONSOLE INPUT'
&SGQUITB SETB  1
 AGO .FDIN
.FNDBA AIF (&SGSCHDB(34)).FDIN  CONSLE-MCS     CHECK MCS SWITCH SA65016
     MNOTE 5,'* * * IEIGEN311 MCS NOT SPECIFIED'
&SGQUITB SETB 1
         AGO   .FDIN
.FNDRDR ANOP
&ADDRESO SETC '&SGSCHDC(&CONA)'(4,3)   * IF OUTPUT ADDR EQ RDR ADDR,
    AIF ('&ADDRESI' EQ '&ADDRESO').NFDOUT      *  THEN INVALID
.FDIN    ANOP   CHECK ALT CONS. OUTPUT IS CONSOLE OR PRINTER DEVICE
&ADDRESO SETC  '&SGSCHDC(&CONA)'(4,3)   ADD  CONS. OUTPUT
         AIF   ('&ADDRESI' EQ '&ADDRESO' AND &HEX EQ 0).N3
         AIF   ('&ADDRESI' EQ '&ADDRESO').FDCON1
         CONVERT TO=HEX,DIGITS=3,VALUE=&ADDRESO
         IOCHECK LOOKFOR=&HEX
         AIF  (&HEX EQ 0).NFDOUT   THIS DEVICE DOES NOT EXIST
&HEX SETA &SGDADRA(&HEX)/1048576  GET DEVICE POINTER
     AIF  (&SGDT04B(&HEX) OR (&SGDT06B(&HEX) AND (&SGDU01B(&HEX) OR &SGX
               DU02B(&HEX) OR &SGDU03B(&HEX)))).FDCON1   CONS OR PRINT
     AIF (&SGDT06B(&HEX) AND &SGDU06B(&HEX)).FDCON1    3211
         AIF (&SGDT05B(&HEX) AND (&SGDU07B(&HEX) OR &SGDU09B(&HEX))).FD*
               CON1                          3284 OR 3286
          AIF (&SGDT05B(&HEX) AND ((&SGDU08B(&HEX) AND &SGDM02B(&HEX)) *
               OR &SGDU10B(&HEX))).N3         3158/3277-2        S99235
         AIF (&SGDT05B(&HEX) AND (&SGDU01B(&HEX) OR &SGDU02B(&HEX)) AND*
                &SGSCHDB(34)).N3             2250/2260 WITH MCS
 AIF (&SGDT05B(&HEX) AND &SGDU06B(&HEX)).N3                5450
 AIF (&SGSCHDB(34)AND &SGDT08B(&HEX)AND &SGDU08B(&HEX)).FDCON1     2740
.NFDOUT  ANOP   INVALID ADD FOR ALT. CONS. OUTPUT
    MNOTE 5,'* * * IEIGEN138 SCHEDULR MACRO, ADDRESS &ADDRESO INVALID F*
               OR ALT.CONSOLE OUTPUT'
&SGQUITB SETB  1
 AGO .N3
.FDCON1  ANOP
         AIF (&SGDT05B(&HEX) AND (&SGDU07B(&HEX) OR &SGDU09B(&HEX))).HD*
               COPY1                         3284 OR 3286
  AIF (NOT(&SGDT04B(&HEX) OR (&SGDT06B(&HEX) AND (&SGDU01B(&HEX) OR &SGX
               DU02B(&HEX) OR &SGDU03B(&HEX) OR &SGDU06B(&HEX))) OR (&S*
               GDT08B(&HEX) AND &SGDU08B(&HEX)))).N3
.HDCOPY1 ANOP                           SET HARDCOPY SW FOR PRINTERS
&AC      SETB  1
.N3      AIF   ('&SGSCHDC(13)' EQ '' OR &CONA EQ 13).N4
&CONA    SETA  13                  2ND ALTCONS POINTER
         AGO   .FNDB
.*    INSERT HERE CHECKING OF JOB QUEUE RESIDENCE
.*    CHECK START-R ADDRESS
.N4     AIF   (&GETB(3)).V01
         AIF   (NOT &SGSCHDB(16)).CKSTWTR     NO RDR SPEC. GO TO STR
&ADDRESI SETC  '&SGSCHDC(3)'(1,3)       SET TO STARTR  ADDR
         CONVERT TO=HEX,VALUE=&ADDRESI,DIGITS=3
         IOCHECK LOOKFOR=&HEX
         AIF  (&HEX EQ 0).NFDRDR   THIS DEVICE DOES NOT EXITS
&HEX SETA &SGDADRA(&HEX)/1048576  GET DEVICE POINTER
         AIF  (&SGDT01B(&HEX) OR &SGDT03B(&HEX) OR &SGDT07B(&HEX)).CKST*
               WTR    START-R ALLOWED ON TAPE,DISK OR CARD READER
.NFDRDR  ANOP
    MNOTE 5,'* * * IEIGEN139 SCHEDULR MACRO, ADDRESS &ADDRESI INVALID F*
               OR START READER'
&SGQUITB SETB  1
.*    CHECK START-W ADDRESS
.CKSTWTR AIF (NOT &SGSCHDB(17)).PROB  NO WTR SPEC. GO TO CHK NEXT
&ADDRESO SETC  '&SGSCHDC(3)'(4,3)       SET TO STARTW  ADDR
         CONVERT TO=HEX,VALUE=&ADDRESO,DIGITS=3
         IOCHECK LOOKFOR=&HEX
         AIF  (&HEX EQ 0).NFDWTR    THIS DEVICE DOES NOT EXIST
&HEX SETA &SGDADRA(&HEX)/1048576  GET DEVICE POINTER
 AIF (&SGDT01B(&HEX) OR &SGDT03B(&HEX) OR &SGDT07B(&HEX) OR &SGDT06B(&H*
               EX)).PROB ST-W ALLOWED ON TP,DA,PCH,PRTR
.NFDWTR  ANOP
    MNOTE 5,'* * * IEIGEN139 SCHEDULR MACRO, ADDRESS &ADDRESO INVALID F*
               OR START-WRITER'
&SGQUITB SETB  1
.*  THIS ROUTINE CHECKS PROGRAM AND MACHINE COMPATIBILITY
.*       PROCESSOR ONLY COMES HERE FROM .A02
.PROB   ANOP
.V01  AIF  (&GETB(1) OR &GETB(3)).V1 NUCLEUS OR IODEVICE SYSGEN
     AIF (NOT &SGMENTB(27)).COBCHK       FORTRAN
.*  CHECK FOR FORTRAN AND SCIENTIFIC INSTRUCTION SET OR UNIVERSAL SET
 AIF (&SGCPUB(32) OR &SGCPUB(33)).CORCHK1
    MNOTE 5,'* * * IEIGEN141 INVALID INSTRUCTION SET FOR FORTRAN'
&SGQUITB SETB  1
.CORCHK1 AIF (NOT(&SGFORTB(2))).CORCHK2       FORTRAN H
.*                                                               S99247
  MNOTE 0,'* * * IEIGENW41 FORTRAN H REQUIRES MINIMUM OF 256K STORAGE'
.CORCHK2 ANOP
.*  CHECK FOR COBOL
.COBCHK AIF (NOT &SGMENTB(24)).ALGCHK
.*  CHECK FOR COBOL AND COMMERCIAL OR UNIVERSAL INSTRUCTION SET
        AIF   (&SGCPUB(31) OR &SGCPUB(33)).CKCLIB
    MNOTE 5,'* * * IEIGEN141 INVALID INSTRUCTION SET FOR COBOL'
&SGQUITB SETB  1
.CKCLIB  ANOP  CHECK FOR COBOL AND COBOL LIBRARY
 AIF (&SGMENTB(38)).ALGCHK
    MNOTE 5,'* * * IEIGEN142 COBOL REQUIRES LIBRARY'
&SGQUITB SETB  1
.* CHECK ALGOL AND STORAGE F OR HIGHER AND INSTSET SCNTF OR UNIV
.ALGCHK AIF (NOT &SGMENTB(25)).PLICHK
         AIF   (&SGMENTB(25) EQ &SGMENTB(50)).RA52
    MNOTE 5,'* * * IEIGEN142 ALGOL REQUIRES LIBRARY'
&SGQUITB SETB 1
.RA52    AIF (&SGCPUB(32) OR &SGCPUB(33)).RA6
    MNOTE 5,'* * * IEIGEN144 INVALID INSTSET FOR ALGOL'
&SGQUITB SETB 1
.RA6 ANOP
.*  CHECK FOR PLI
.PLICHK  AIF  (NOT &SGMENTB(30)).CHKSHR
         AIF (&SGMENTB(10)).CHCARS   CHECK FOR SUPRVSOR MACRO
    MNOTE 5,'* * * IEIGEN145 PL/I REQUIRES SUPRVSOR MACRO'
&SGQUITB SETB  1
.*  CHECK FOR PLI AND UNIVERSAL INSTRUCTION SET
.CHCARS  AIF (&SGCPUB(33)).CHPLIB
    MNOTE 5,'* * * IEIGEN141 INVALID INSTRUCTION SET FOR PL/I'
&SGQUITB SETB  1
.CHPLIB  ANOP  CHECK FOR PL/I  LIBRARY
         AIF   (&SGMENTB(49)).CHKSHR
    MNOTE 5,'* * * IEIGEN142 PL/I  REQUIRES LIBRARY'
&SGQUITB SETB  1
.CHKSHR  AIF   (NOT &SGPL11B(94)).CHKSRT
         AIF   (&SGSUPRB(21) AND &SGSUPRB(22)).CHKSRT
    MNOTE 5,'* * * IEIGEN203 RENTCODE AND COMM MUST BE SPECIFIED IN    *
               SUPRVSOR MACRO WHEN REQUESTING PL1 SHARED LIB FEATURE'
&SGQUITB SETB  1
.*  CHECK FOR SORT AND LIBRARY
.CHKSRT  AIF   (&SGMENTB(35) EQ &SGMENTB(45)).V05
    MNOTE 5,'* * * IEIGEN142 IF EITHER SORTMERG OR SORTLIB, THEN BOTH RX
               EQUIRED'
&SGQUITB SETB  1
.V05 AIF (&GETB(2)).Y1                 PROCESSOR ONLY
.* IODEVICE OR NUCLEUS ONLY COMES HERE FROM .V01
.V1 AIF (NOT(&SGSUPRB(13) OR &SGSUPRB(19) OR (&SGSUPRB(14) AND &SGSUPRB*
               (16)))).V15
 AIF (&SGCPUB(40)).V15
    MNOTE 5,'* * * IEIGEN161 FEATURE=TIMER NECESSARY IN CENPROCS MACRO'
&SGQUITB  SETB  1
.V15 AIF (NOT(&SGCPUB(6) OR &SGCPUB(9) OR &SGCPUB(13))).V16 NOT 91/195
     AIF (&SGSUPRB(10)).V14                 SER1
    MNOTE 5,'* * * IEIGEN162  SER1 REQUIRED FOR MODELS 91 AND 195'
&SGQUITB SETB  1
.V14 AIF (&SGCPRGB(8)).Y1                   MVT FOR MODELS 91 AND 195
    MNOTE 5,'* * * IEIGEN220  MODELS 91 AND 195 REQUIRE MVT'
&SGQUITB SETB 1
.Y1  AIF (NOT(&SGCPUB(6) OR &SGCPUB(9) OR &SGCPUB(13))).V16 NOT 91/195
 AIF (NOT &SGCBLEB(6)).Y2              NOT COBOL E
         AIF (&SGCPUB(9) OR &SGCPUB(13)).G1  S360 OR S370 MOD 195
    MNOTE 5,'* * * IEIGEN221 COBOL E CANNOT BE SPECIFIED WITH MODEL 91'
&SGQUITB SETB 1
         AGO   .Y3
.G1 MNOTE 0,'* * * IEISGGW03  COBOL-E INVALID WITH MODEL 195'
.Y2      ANOP
.Y3  AIF (NOT &SGFORLB(4)).Y4               NOT BOUNDARY=ALIGN
         AIF (&SGCPUB(9) OR &SGCPUB(13)).Y4  S360 OR S370 MOD 195
    MNOTE 5,'* * * IEIGEN187 BOUNDARY=ALIGN INVALID FOR MOD 91'
&SGQUITB SETB  1
.Y4 AIF (NOT (&SGCPUB(9) OR &SGCPUB(13))).V16     NOT 195
         AIF   (NOT &SGMENTB(25)).VCCH     NOT ALGOL
    MNOTE 0,'* * * IEISGGW03  ALGOL INVALID WITH MODEL 195'
.VCCH    AIF   (&SGSUPRB(29)).V16
&SGSUPRB(29)   SETB 1
    MNOTE 0,'* * * IEIGENW09  CCH DEFAULTED ON MODEL 195'
.V16 AIF (&GETB(2)).VR                 PROCESSOR ONLY
        AIF   (NOT &SGSCHDB(8)).VM65MP    NO   CRJE
        AIF   (NOT &SGSCHDB(2)).VCJ1
       AIF   (&SGSUPRB(37)).VCJ1
&SGSUPRB(37) SETB 1
&SGSUPRB(16) SETB 1
&SGSUPRB(17) SETB 1
    MNOTE 0,'* * * IEIGENW19 WARNING- ASYNCHRONOUS ATTACH IS ASSUMED FOX
               R MFT WITH CRJE'
.VCJ1   AIF   (&SGDMGTB(4)).VM65MP
&SGDMGTB(4)   SETB   1
    MNOTE 0,'* * * IEIGENW20 WARNING - BTAM ACSMETH ASSUMED FOR CRJE'
.VM65MP  ANOP
          AIF   (NOT &SGCPRGB(13)).MP1   M65MP                   S99247
         AIF   (&SGCPUB(4)).MP1
    MNOTE 5,'* * * IEIGEN198 M65MP SYSTEM REQUIRES CENPROCS MODEL 65'
&SGQUITB SETB  1
.MP1      AIF   (&GETB(2)).VR            PROCESSOR               S99247
.*  59150020, 59460020, 59526021, 59528021, 59850020 REMOVED FOR PTM234
.V6B     AIF   (NOT (&SGCPUB(8) OR &SGCPUB(10) OR &SGCPUB(11) OR &SGCPU*
               B(12) OR &SGCPUB(14) OR &SGCPUB(15) OR &SGCPRGB(13))).EM*
               1  NOT 135/145/155/158/165/168/M65MP              S99235
         AIF   ((&SGCPUB(8) OR &SGCPUB(10) OR &SGCPUB(11) OR &SGCPUB(12*
               ) OR &SGCPUB(14) OR &SGCPUB(15)) AND &SGSUPRB(28) AND &S*
               GSUPRB(29)).EM1                                   S99235
         AIF   (&SGSUPRB(28) AND &SGSUPRB(29) AND &SGSUPRB(33) AND     *
               &SGSUPRB(35)).MP4     TEST FOR CORRECT SER/IORM OPTS
&SGSUPRB(28) SETB 1          SER=MCH
&SGSUPRB(29) SETB 1          OPTIONS=CCH
&SGSUPRB(9) SETB 0           SER=0
&SGSUPRB(10) SETB 0          SER=1
&SGSUPRB(31) SETB 0          SEREP
         AIF   (&SGCPUB(8) OR &SGCPUB(10) OR &SGCPUB(11) OR &SGCPUB(12)*
                OR &SGCPUB(14) OR &SGCPUB(15)).MPG TEST FOR MODEL 135/1*
                                         45/155/158/165/168      S99235
&SGSUPRB(33) SETB 1          OPTIONS=DDR
&SGSUPRB(35) SETB 1          OPTIONS=APR
 MNOTE *,' THE FOLLOWING DEFAULT OPTIONS ARE GIVEN FOR M65MP'
 MNOTE *,' SER=MCH--OPTIONS=CCH,DDR,APR'
.MP4     AIF   (&X EQ &SGCNTRA(2)).MPC
&X       SETA &X+1
         AIF   (&SGUNT1B(&X) AND &SGUNU6B(&X) AND &SGUNM2B(&X)).MP5
         AGO   .MP4
.MP5    AIF   (&Y(1)).MP4
&Y(1)    SETB  1
    MNOTE 0,'* * * IEIGEN209 HARDWARE SWITCHING CAPABILITY MUST BE AVAI*
               LABLE TO SUPPORT 2803-2 ON M65MP SYSTEM'
         AGO   .MP4
.MPC     AIF   (NOT &SGMENTB(53)).MPF
    MNOTE 5,'* * * IEIGEN218 SECMODS INVALID WITH M65MP'
&SGQUITB  SETB  1
.MPF     AIF   (NOT &SGDCLSB(57)).EM1   2420 INVALID WITH M65MP
    MNOTE 0,'* * * IEIGEN223 HARDWARE SWITCHING CAPABLILTY MUST BE AVAIX
               LABLE TO SUPPORT 2420 ON M65MP SYSTEM'
         AGO   .EM1
.MPG MNOTE *,'  MCH, CCH DEFAULTED FOR MODELS 135/145/155/158/165/168'
.EM1     AIF   (NOT &SGMENTB(58)).VG        EMULATOR
.EM2     AIF   (NOT &SGCPRGB(13)).EM3                  M65MP
    MNOTE 5,'* * * IEIGEN236 EMULATOR INVALID IN M65MP SYSTEM'
&SGQUITB SETB 1
.EM3     AIF   (&SGSUPRB(14) OR &SGSUPRB(19)).EM4   INTVL/JBSTP TIMER
    MNOTE 5,'* * * IEIGEN237 SUPRVSOR MACRO, EMULATOR VALID ONLY WITH IX
               NTERVAL OR JOBSTEP TIMER'
&SGQUITB SETB 1
.EM4     AIF   (NOT &SGCPRGB(4)).VG     MFT
         AIF   (NOT (&SGCPUB(7) OR &SGCPUB(11))).VG    165 OR 85
         AIF   (&SGSUPRB(1) AND &SGSUPRB(37)).VG   IDENT/ATTACH OPTS
    MNOTE 5,'* * * IEIGEN238 SUPRVSOR MACRO, M85 AND M165 WITH MFT REQUX
               IRES IDENTIFY AND ATTACH OPTIONS FOR EMULATOR'
&SGQUITB SETB 1
.VG      AIF   (NOT &SGSUPRB(28)).CENP    SER=MCH NOT SPECIFIED
         AIF (&SGCPUB(4) OR &SGCPUB(7) OR &SGCPUB(8) OR &SGCPUB(10) OR *
               &SGCPUB(11) OR &SGCPUB(12) OR &SGCPUB(14) OR &SGCPUB(15)*
               ).CENP                                            S99247
 MNOTE 5,'* * * IEIGEN184 MCH REQUIRES MODEL 65,85,135,145,155,158,165,*
                OR 168'                                          S99247
&SGQUITB SETB 1
.CENP AIF (&SGSUPRB(9) OR &SGSUPRB(10) OR &SGSUPRB(28) OR &SGSUPRB(31))X
               .VH            SER  LEVEL SPECIFIED
.VG1A     AIF   (NOT &SGCPUB(2)).VG1     MODEL 40                S99247
&SGSUPRB(9)    SETB 1
    MNOTE *,'  RECOVERY MANAGEMENT DEFAULT FOR PRIMARY CPU IS SER0'
         AGO   .VH
.VG1  AIF (&SGCPRGB(13) OR &SGCPUB(7)).VH
&SGSUPRB(10) SETB 1
     MNOTE *,'  RECOVERY MANAGEMENT DEFAULT FOR PRIMARY CPU IS SER1'
.VH      ANOP
.VH0 AIF (NOT &SGMENTB(53)).VH1
         AIF   (&SGMOD6B(1) OR &SGMOD7B(1) OR &SGMOD8B(1) OR &SGMOD9B(1*
               ) OR &SGMODAB(1) OR &SGMODBB(1)).VMSL  370 SECONDARY9247
         AIF   (&SGCPUB(8) OR &SGCPUB(10) OR &SGCPUB(11) OR &SGCPUB(12)*
                 OR &SGCPUB(14) OR &SGCPUB(15)).VMSL2  370 PRIMARY99247
         AIF   ((NOT &SGCPRGB(13)) AND (NOT &SGCPUB(7))).VMSLA M65MP/85
       MNOTE 5,'* * * IEIGEN185 SECMODS MACRO INVALID WITH MCH FOR OS  *
               MODELS M65MP AND 85 '
&SGQUITB SETB 1
         AGO   .VMSLA
.VMSL    ANOP
         AIF   (&SGCPUB(2) OR &SGCPUB(3) OR &SGCPUB(4) OR              *
                &SGCPUB(5) OR &SGCPUB(6) OR &SGCPUB(7) OR &SGCPUB(9)).V*
               MSL3
.VMSLA   AIF   (&SGSUPRB(22)).NSOS
    MNOTE 5,'* * * IEIGEN201 SECMODS REQUIRES SUPRVSOR OPTIONS=COMM -OP*
               ERATOR COMMUNICATION AT IPL TIME'
&SGQUITB  SETB  1
.NSOS    AIF   (&SGMOD6B(1) OR &SGMOD7B(1) OR &SGMOD8B(1) OR &SGMOD9B(1*
               ) OR &SGMODAB(1) OR &SGMODBB(1)).NSSEC            S99247
.SECMOD      ANOP            SETTING SECMODS MACRO DEFAULTS
&N       SETA  &N+1
         AIF   (&N GT 5).VH1           ONLY 5 PARAMETERS ALLOWED
.SEC1    AIF   (NOT (&SGMOD2B(&N) OR &SGMOD3B(&N) OR &SGMOD4B(&N) OR &SX
               GMOD5B(&N))).VH1  NO MODELS REMAINING
.VREST  AIF (&SGSER1B(&N) OR &SGSER2B(&N) OR &SGSER3B(&N)).SECMOD
&N1       SETB  (NOT(&SGMOD2B(&N)))     SER0 FOR MODEL 40 DEFAULTS99247
.VMSL1 MNOTE *,'      SECMODS MACRO PARAMETER &N SER DEFAULT IS SER&N1'
&SGSER2B(&N)   SETB (NOT &N1)
&SGSER3B(&N)   SETB (&N1)
         AGO   .SECMOD
.NSSEC   ANOP
&N       SETA  &N+1
          AIF   (&N GT 5).VH1            ONLY 5 SECONDARY MODELS S99247
         AIF (NOT (&SGMOD6B(&N) OR &SGMOD7B(&N) OR &SGMOD8B(&N) OR     *
               &SGMOD9B(&N) OR &SGMODAB(&N) OR &SGMODBB(&N))).VH1 DONE
.*                                                               S99247
&SGSER4B(&N)   SETB 1                   MCH SWITCH
.*             IF 'ALL' WAS SPECIFIED IN THE SECMODS MACRO, THEN ALL
.*             S370 SECONDARY SWITCHES WERE TURNED ON. THE MODEL
.*             SPECIFIED AS THE PRIMARY CPU WILL NOT BE A SECONDARY
.*             MODEL ALSO.
.*                                                              S99235
         AIF   (NOT(&SGMOD6B(&N) AND &SGMOD7B(&N) AND &SGMOD8B(&N) AND *
               &SGMOD9B(&N) AND &SGMODAB(&N) AND &SGMODBB(&N))).VSALL
&SGMOD6B(1)    SETB 0
&SGMOD7B(1)    SETB 0
&SGMOD8B(1)    SETB 0
&SGMOD9B(1)    SETB 0
&SGMODAB(1)   SETB 0                                            S99235
&SGMODBB(1)   SETB 0                                            S99235
         AIF   (&N NE 1).VH1
&SGSER4B(&N)   SETB 1                   MCH SWITCH
&SGSER4B(&N+1) SETB 1                   MCH SW
&SGSER4B(&N+2) SETB 1                   MCH SW
&SGMOD6B(&N)   SETB 1
&N       SETA  &N+1
.V135    ANOP
         AIF   (NOT(&SGCPUB(12))).V145  PRIMARY CPU MOD 135
&N       SETA  &N-1
&SGMOD6B(&N)   SETB 0                   TURN SECMOD 135 SWITCH OFF
.V145    ANOP
&SGMOD7B(&N)   SETB 1
&N       SETA  &N+1
         AIF   (NOT(&SGCPUB(10))).V155  PRIMARY CPU MOD 145
&N       SETA  &N-1
&SGMOD7B(&N)   SETB 0                   TURN SECMOD 145 SWITCH OFF
.V155    ANOP
&SGMOD8B(&N)   SETB 1
&N       SETA  &N+1
         AIF   (NOT(&SGCPUB(8))).V158  PRIMARY CPU MOD 155       S99235
&N       SETA  &N-1
&SGMOD8B(&N)   SETB 0                   TURN SECMOD 155 SWITCH OFF
.V158    ANOP                                                    S99235
&SGMODAB(&N)   SETB 1                                            S99235
&N       SETA  &N+1                                              S99235
         AIF   (NOT(&SGCPUB(14))).V165 PRIMARY CPU MOD 158       S99235
&N       SETA  &N-1                                              S99235
&SGMODAB(&N)   SETB 0                 TURN SECMOD 158 SWITCH OFF S99235
.V165    ANOP                                                    S99235
&SGMOD9B(&N)   SETB 1                                            S99235
&N       SETA  &N+1                                              S99235
         AIF   (NOT(&SGCPUB(11))).V168 PRIMARY CPU MOD 165       S99235
&N       SETA  &N-1                                              S99235
&SGMOD9B(&N)   SETB 0                 TURN SECMOD 165 SWITCH OFF S99235
.V168    AIF   (&N GE 6).VH1                                    SA67613
&SGMODBB(&N)   SETB 1                                            S99235
&N       SETA  &N+1                                              S99235
         AIF   (NOT(&SGCPUB(15))).VH1   PRIMARY CPU MOD 168      S99235
&N       SETA  &N-1                                              S99235
&SGMODBB(&N)   SETB 0                 TURN SECMOD 168 SWITCH OFF S99235
         AGO   .VH1                                              S99235
.VSALL   ANOP
         AIF   (&SGCPUB(12) AND &SGMOD6B(&N)).VMSL4
         AIF   (&SGCPUB(10) AND &SGMOD7B(&N)).VMSL4
         AIF   (&SGCPUB(8)  AND &SGMOD8B(&N)).VMSL4              S99235
         AIF   (&SGCPUB(11) AND &SGMOD9B(&N)).VMSL4              S99235
         AIF   (&SGCPUB(14) AND &SGMODAB(&N)).VMSL4              S99235
         AIF   (&SGCPUB(15) AND &SGMODBB(&N)).VMSL4              S99235
         AGO   .NSSEC
.VMSL2 MNOTE 5,'* * * IEIGEN302 SECMODS MACRO, S360 SECONDARY MODEL CPU*
               -INVALID WITH A S370 PRIMARY CPU'
&SGQUITB SETB  1
         AGO   .VH1
.VMSL3 MNOTE 5,'* * * IEIGEN303 SECMODS MACRO, S370 SECONDARY MODEL CPU*
               -INVALID WITH A S360 PRIMARY CPU'
&SGQUITB SETB  1
         AGO   .VH1
.VMSL4 MNOTE 5,'* * * THE SAME MODEL HAS BEEN SPECIFIED AS A SECONDARY *
               AND THE PRIMARY CPU '
&SGQUITB SETB  1
.VH1  AIF (NOT &SGSCHDB(26)).P0  NO RJE
.VI  AIF (&SGDMGTB(4) AND &SGDMGTB(1)).P0  RJE WITH BDAM & BTAM
    MNOTE 5,'* * * IEIGEN186 RJE REQUIRES BTAM AND BDAM'
&SGQUITB SETB  1
.P0 AIF (&GETB(3)).VM                  I/O DEVICE GEN
.P1   AIF  ((&SGCPRGB(4)) AND (NOT &SGMENTB(18))).PB  PARTITNS REQ MFT
    AIF  (NOT &SGCPRGB(4) AND &SGMENTB(18)).PB
&SGSUPRB(17) SETB  1  GTF REQUIRES CIRB (SVC 2B)                  56865
 AIF (&SGMENTB(54) AND (NOT &SGCPRGB(11))).PC1
.P2   AIF  (NOT &SGCPRGB(12)).PART         ** TIME SLICING **
  AIF  ((NOT &SGSUPRB(14) AND NOT &SGSUPRB(19)) AND (&SGCPRGB(12))).PA
.P3   AIF   (NOT &SGCPRGB(4)).VM       NOT MFT
         AIF  (NOT &SGMENTB(18)).VM     NOT PARTITNS
         AIF   (&SGCPRGA(8) GT &SGCPRGA(9)).PART      TMSLCE DEF ERROR
&LP      SETA  &SGCPRGA(9)+1                LAST PARTITION
&FP      SETA  &SGCPRGA(8)+1                FIRST PARTITION
         AGO   .PARTCK                       FIRST TIME CHECK
.PARTCH  AIF   (&FP EQ &LP).PART               END TEST
&FP      SETA  &FP+1                         NEXT PARTITION
.PARTCK  AIF   (&SGCPRPA(&FP) EQ 0 AND &SGCPRPA(&FP+52) EQ 0).PC  NONE
         AGO   .PARTCH                       RETURN TO CHECK ANOTHER
.PA MNOTE 5,'* * * IEIGEN188 INTERVAL TIMER NEEDED WITH TMSLICE'
&SGQUITB SETB  1
         AGO   .P3
.PB MNOTE 5,'* * * IEIGEN189 PARTITNS MACRO REQUIRED FOR MFT/INVALID FO*
               R MVT'
&SGQUITB SETB  1
         AGO   .P2
.PC      ANOP
&FP      SETA  &FP-1
    MNOTE 5,'* * * IEIGEN190 TMSLICE PARTITION &FP NOT SPECIFIED ON PARX
               TITN MACRO'
&FP      SETA  &FP+1
&SGQUITB SETB  1
         AGO   .PARTCH
.PC1 MNOTE 5,'* * * IEIGEN204 HIARCHY DESIGNATED IN PARTITNS MACRO'
   MNOTE *,'        REQUIRES HIARCHY=INCLUDE IN CTRLPROG'
&SGQUITB SETB 1
 AGO .P2
.PART  AIF  (NOT &SGMENTB(18)).VM
         AIF   (NOT &SGCPRGB(4)).VM     PARTITIONS SPECIFIED BUT NO MFT
&LP      SETA  0         RESET &LP TO COUNT PROB PARTITIONS
&FP      SETA  0         RESET &FP TO COUNT PARTITIONS
&E       SETA  2   EAST SIDE
&W       SETA  1   WEST SIDE
         AGO   .BYP
.PART1   AIF   (&P EQ 26).END   END TEST
&E       SETA  &E+2  INCREMENT EAST POINTER
&W       SETA  &W+2  INCREMENT WEST POINTER
.BYP     ANOP
&P       SETA  &P+1
&X       SETA  &W
&FP      SETA  &FP+1     COUNT PARTITIONS
         AIF   (&FP EQ &SGCPRNA(1)+1).END
         AIF   ('&SGCPRGC(&P)'(1,4) EQ '   R').READ
         AIF   ('&SGCPRGC(&P)'(1,4) EQ '   W').WRITE
.CLASS   ANOP
&LP      SETA  &LP+1     COUNT PROB PARTITIONS
&CL      SETB  1
.READ    ANOP
         AIF   (NOT &SGSCHDB(9)).K44
     AIF (&SGCPRPA(&X) GE 30*1024 OR &SGCPRPA(&X+52) GE 30*1024).CSCH
 AGO .REIN2
.K44     AIF   (NOT &SGSCHDB(12)).K100
  AIF (&SGCPRPA(&X) GE 44*1024 OR &SGCPRPA(&X+52) GE 44*1024).CSCH
 AGO .REIN2
.K100    AIF   (NOT &SGSCHDB(2)).REIN
   AIF (&SGCPRPA(&X) GE 100*1024 OR &SGCPRPA(&X+52) GE 100*1024).CSCH
 AGO .REIN2
.CSCH    ANOP
         AIF   (&CL).CSWT
         AGO   .REIN
.REIN2   AIF   (&CL).REIN
         AGO   .PF
.CSWT    ANOP
&CL      SETB  0    PROBLEM PROGRAM MEETS SCHEDULR SIZE
&CSW     SETB  1
.REIN    AIF   (&TWO).REIN1   REINITIALIZE
&X       SETA  &E
&TWO     SETB  1
&CL      SETB  0
         AGO   .PART2
.REIN1   ANOP
&X       SETA  &W
&TWO     SETB  0
&CL      SETB  0
         AGO   .PART1
.PART2   ANOP
&FP      SETA  &FP+1     COUNT PARTITIONS
         AIF   (&FP EQ &SGCPRNA(1)+1).END
         AIF   ('&SGCPRGC(&P)'(5,4) EQ '   R').READ
         AIF   ('&SGCPRGC(&P)'(5,4) EQ '   W').WRITE
         AGO   .CLASS
.WRITE AIF (&SGCPRPA(&X) GE 10*1024 OR &SGCPRPA(&X+52) GE 10*1024).REIN
 AGO .PD
.END     AIF   (&CSW).VMM
         AGO   .PE
.PD MNOTE 5,'* * * IEIGEN200 WRITER PARITITONS MUST BE AT LEAST 10K'
&SGQUITB SETB  1
         AGO   .REIN
.PE MNOTE 5,'* * * IEIGEN201 AT LEAST ONE PROBLEM PROGRAM PARTITION MUS*
               T BE THE SIZE OF THE SCHEDULR'
&SGQUITB SETB  1
         AGO   .VMM
.PF MNOTE 5,'* * * IEIGEN202 EACH READER PARTITION MUST BE THE SIZE OF X
               THE SCHEDULER'
&SGQUITB SETB  1
         AGO   .REIN
.VMM     AIF   (&LP GT 2).VM
.VMM1    AIF   (&LP LT 2).VMM2
         AIF   (NOT(&SGDMGTB(5) OR  &SGMENTB(64))).VM
         AIF   (&LP EQ 3).VM
.VMM2    ANOP
&JC      SETC  '   A'
         AIF   (&TWO).VMM3
&TWO     SETB  1
&SGCPRGC(&P)  SETC  '&JC&SGCPRGC(&P)'
&FP      SETA  &P*2-2
         AGO   .VMM4
.VMM3    ANOP
&TWO     SETB  0
&SGCPRGC(&P)  SETC  '&SGCPRGC(&P)&JC'
&FP      SETA  &P*2-1
&P       SETA  &P+1
.VMM4    ANOP
&LP      SETA  &LP+1
&SGCPRNA(1)  SETA  &SGCPRNA(1)+1
&PT      SETC  '&FP'
    MNOTE *,'     ADDITIONAL PARTITION NUMBER &PT GENERATED'
    MNOTE *,'   ZERO K SIZE, JOBCLASS A'
         AGO   .VMM1
.VM  AIF (NOT &SGMENTB(29)).VP     GJOBCTL
.VM1 AIF (&SGMENTB(12)).VM2
    MNOTE 5,'* * * IEIGEN192 GJOBCTL REQUIRES GRAPHICS SUPPORT'
&SGQUITB SETB 1
.VM2  ANOP
&I SETA 0
.VM3     AIF   (&I EQ &SGGJCA(1)).VP
&I SETA &I+1
 IOCHECK LOOKFOR=&SGGJUA(&I)
 AIF (&HEX EQ 0).VM4
&J SETA &SGDADRA(&HEX)/1048576    GET DEVICE POINTER
 AIF (&SGGJCB(7) AND NOT &SGGJCB(6)).VM3A         TP ONLY
 AIF (&SGGJCB(7) AND &SGGJCB(6)).VM3B
 AIF (&SGDT05B(&J) AND &SGDU01B(&J)).VM3
 AGO .VM4
.VM3A    AIF   (&SGDT02B(&J) AND (&SGDU06B(&J) OR &SGDU07B(&J) OR &SGDUX
               08B(&J))).VM3           BSC1,BSC2,BSC3
 AGO .VM4
.VM3B   AIF   ((&SGDT05B(&J) AND &SGDU01B(&J)) OR (&SGDT02B(&J) AND (&SX
               GDU06B(&J) OR &SGDU07B(&J) OR &SGDU08B(&J)))).VM3
.VM4 CONVERT TO=EBCDIC,DIGITS=3,VALUE=&SGGJUA(&I)
    MNOTE 5,'* * * IEIGEN193 GJOBCTL UNITS ADDRESS &EBCDIC INVALID'
&SGQUITB SETB 1
 AGO .VM3
.VP      AIF   (&GETB(1)).VQ
         AIF   (NOT &SGMENTB(66)).VP00
         AIF   (&SGDCLSB(55) OR &SGDCLSB(71)).VP26
 MNOTE 0,'* * * IEIGENW45 1403 WITH UNVCHSET OR 3211 REQUIRED FOR IMAGE*
               LIB--NO IMAGELIB TO BE INCLUDED'
&SGMENTB(66) SETB 0
         AGO   .VP01
.VP22 MNOTE 0,'* * * IEIGENW46 1403 UCS MACRO NOT SPECIFIED--NO UCS IMA*
               GES WILL BE INCLUDED'
         AGO   .VP28
.VP24 MNOTE 0,'* * * IEIGENW47 3211 UCS MACRO NOT SPECIFIED--NO UCS IMA*
               GES WILL BE INCLUDED'
         AGO   .VP01
.VP04 MNOTE 5,'* * * IEIGEN196 3211 OR 1403 WITH UNVCHSET REQUIRES IMAG*
               ELIB MACRO'
&SGQUITB SETB  1
.VP26    AIF   (&SGDCLSB(55) AND NOT &SGUCSEB(1)).VP22
.VP28    AIF   (&SGDCLSB(71) AND NOT &SGUCSEB(2)).VP24
         AGO   .VP01
.VP00    AIF   (&SGDCLSB(55) OR &SGDCLSB(71)).VP04
.VP01    AIF   (NOT &SGUCSEB(1) OR &SGDCLSB(55)).VP02
 MNOTE 5,'* * * IEIGEN194 UCS MACRO FOR 1403 REQUIRES A 1403 DEVICE WIT*
               H UNVCHSET'
&SGQUITB SETB  1
.VP02    AIF   (NOT &SGUCSEB(2) OR &SGDCLSB(71)).VQ
 MNOTE 5,'* * * IEIGEN195 UCS MACRO FOR 3211 REQUIRES A 3211 DEVICE'
&SGQUITB SETB  1
.VQ AIF (NOT &SGCPUB(7)).VS             MOD 85
.VR01 AIF (&SGSUPRB(28) AND &SGSUPRB(29)).VS
&SGSUPRB(28) SETB 1          SER=MCH
&SGSUPRB(29) SETB 1          OPTIONS=CCH
&SGSUPRB(9) SETB 0           SER=0
&SGSUPRB(10) SETB 0          SER=1
    MNOTE *,'      THE FOLLOWING FUNCTIONS ARE STANDARD FOR MODEL 85'
 MNOTE *,' SER=MCH--OPTIONS=CCH'
 AGO .VS
.VR  ANOP         PROCESSOR ONLY COMES HERE FROM .V16
   MNOTE 0,'    PROCESSOR ONLY SYSGEN SPECIFIED - THE FOLLOWING        *
               MACROS PRODUCE NO CODE'
   MNOTE *,'   CHANNEL-IOCONTRL-IODEVICE-UNITNAME-CTRLPROG'
   MNOTE *,'   SCHEDULR-SVCTABLE-RESMODS-DATAMGT-TELCMLIB'
   MNOTE *,'   PARTITNS-SYSUTILS-CKPTREST-UCS-GJOBCTL'
   MNOTE *,'   SECONSLE-EMULATOR-TSOPTION'
         AGO   .MEND
.VS  AIF (&GETB(1)).VW             NUCLEUS ONLY
       AIF  (NOT &SGMENTB(57)).VS6   NO  CHECKER
         AIF   (&SGSCHDB(8) OR &SGSCHDB(44)).VS6  TEST FOR CRJE OR TSO
    MNOTE 0,'* * * IEIGENW21 SYNTAX CHECKER WILL NOT BE GENERATED -    *
                   SCHEDULR OPTIONS= CRJE OR TSO IS REQUIRED'
&SGMENTB(57)   SETB   0
&SGCKPLB(1) SETB 0
&SGCKPLB(2) SETB 0
&SGCKPLB(3) SETB 0
&SGCKPLB(4) SETB 0
&SGCKFTB(1) SETB 0
&SGCKFTB(2) SETB 0
&SGCKFTB(3) SETB 0
&SGCKFTB(4) SETB 0
.VS6     ANOP
         AIF   (NOT &SGCPUB(9)).M91         NOT MODEL 195
         AIF   (NOT &SGSUPRB(24)).VT        NOT DECSIM
    MNOTE 0,'* * * IEISGGW05  DECSIM IN SUPRVSOR INVALID WITH MOD 195'
         AGO   .VT
.M91 AIF (&GETB(3)).VU2A     I/O GEN
 AIF (NOT &SGCPUB(6)).VT     NOT M91
     AIF (NOT(&SGMENTB(30) OR &SGMENTB(24) OR &SGMENTB(22))).VT
     AIF (&SGSUPRB(24)).VT         DECSIM
    MNOTE 5,'* * * IEIGEN177 DECSIM IN SUPRVSOR MACRO NEEDED FOR PLI-CO*
               BOL-AND RPG WITH MOD 91'
&SGQUITB SETB 1
.VT  AIF (NOT &SGGRPHB(3)).VU      NO GSP
 AIF (&SGMENTB(39) OR &SGMENTB(49) OR &SGCOBLB(2)).VU
 MNOTE 5,'* * * IEIGEN184 GSP REQUIRES FORTLIB, COBLIB, OR PL1LIB'
&SGQUITB SETB 1
.VU AIF (NOT &SGMENTB(29)).VU1              GJOBCTL
 AIF (NOT &SGGJCB(7)).VU1                   SGJP
 AIF (&SGDMGTB(4) AND &SGMENTB(31)).VU1     BTAM AND PTOP
    MNOTE 5,'* * * IEIGEN199 SATELLITE GRAPHIC JOB PROCESSOR REQUIRES B*
               TAM AND PTOP MACRO'
&SGQUITB SETB 1
.VU1 AIF (NOT &SGMENTB(31)).VU2A            PTOP
 AIF (&SGPTOPB(1) AND NOT &SGMENTB(39)).VUE
.VU1A AIF (&SGDMGTB(4)).VU2A           BTAM
    MNOTE 5,'* * * IEIGEN201 PTOP REQUIRES BTAM'
&SGQUITB SETB 1
 AGO .VU2A
.VUE    ANOP
    MNOTE 5,'* * * IEIGEN200 FORTLIB REQUIRED WHEN PTOP REQUESTS FORTLI*
               B'
&SGQUITB SETB 1
 AGO .VU1A
.VU2A   AIF  (NOT &SGMENTB(29)).VUIO2   GJOBCTL
&I SETA 0
.VU3 AIF (&I EQ &SGCNTRA(4)).VUE2
&I SETA &I+1
         AIF   ('&SGGJCC(10)' EQ '&SGUNNMC(&I)').VUIO2
     AGO .VU3
.VUE2   ANOP
    MNOTE 5,'* * * IEIGEN194 DAPOOL VALUE &SGGJCC(10) NOT SPECIFIED IN *
               UNITNAME'
&SGQUITB SETB 1
.VUIO2   AIF   (&GETB(3)).VW20
.VU2 AIF ((&SGDMGTB(3) OR &SGDMGTB(4) OR &SGDMGTB(5)) AND (NOT &SGMENTB*
               (48))).VUE1
 AGO .VV
.VUE1 ANOP
  MNOTE 5,'* * * IEIGEN182 TELCMLIB REQUIRED WITH BTAM/QTAM/TCAM'
&SGQUITB SETB 1
.VV AIF (NOT &SGMENTB(32)).VX  CKPTREST MACRO NOT SPECIFIED
.VV1 AIF (&SGSUPRB(21)).VX
         AIF   (NOT &SGCPRGB(4)).VV2    NOT MFT
 MNOTE 5,'* * * IEIGEN205 VALUE ''ACSMETH'' IN SUPRVSOR MACRO NOT SPECI*
               FIED FOR CKPTREST'
&SGQUITB SETB 1
  AGO  .VX
.VV2 AIF (NOT &SGCPRGB(8)).VX  NOT MVT
 MNOTE 5,'* * * IEIGEN206 VALUE ''RENTCODE'' IN SUPRVSOR MACRO NOT SPEC*
               IFIED FOR CKPTREST'
&SGQUITB SETB 1
  AGO  .VX
.VW  ANOP         NUCLEUS ONLY COMES HERE FROM .VS
   MNOTE 0,'   NUCLEUS ONLY SYSGEN SPECIFIED - THE FOLLOWING           *
               MACROS PRODUCE NO CODE'
   MNOTE *,'   UNITNAME-SVCLIB-PROCLIB-LINKLIB-TELCMLIB-EDITOR'
   MNOTE *,'   ASSEMBLR-MACLIB-SORTMERG-SORTLIB-ALGOL-ALGLIB'
   MNOTE *,'   COBOL-COBLIB-FORTRAN-FORTLIB-PL1-PL1LIB-RPG'
   MNOTE *,'   UCS-SYSUTILS-CKPTREST-LOADER'
         AIF   (NOT &SGMENTB(69)).VW20B  TEST FOR GENTSO MACRO
   MNOTE *,'    CMDLIB-EDIT-HELP-OUTPUT-TSOPTION-UADS'
.VW20B   ANOP
         AIF   (&GETB(1)).VW21     IF NUCLEUS ONLY
.VW20    ANOP
   MNOTE 0,'     I/O DEVICE SYSGEN SPECIFIED - THE FOLLOWING           *
               MACROS PRODUCE NO CODE'
   MNOTE *,'   ALGOL-ALGLIB-ASSEMBLR-CKPTREST-COBOL-COBLIB-EDITOR'
   MNOTE *,'   FORTRAN-FORTLIB-LINKLIB-LOADER-MACLIB-PARMLIB'
   MNOTE *,'   PARTITNS-PL1-PL1LIB-PROCLIB-PTOP-RESMODS-RPG-SORTLIB'
   MNOTE *,'   SORTMERG-SVCLIB-TELCMLIB'
         AIF   (NOT &SGMENTB(69)).VW21  TEST FOR GENTSO MACRO
   MNOTE *,'    CMDLIB-EDIT-HELP-OUTPUT-TSOPTION-UADS'
.VW21   ANOP
.* * * MULTIPLE CONSOLE SUPPORT * * *               * * * * *
.VX AIF (NOT(NOT &SGSCHDB(34) AND &SGSCNYA(2) GE 1)).VX0
 MNOTE 5,'* * * IEIGEN211 SECONSLE MACRO INVALID, MCS NOT SPECIFIED'
&SGQUITB SETB 1
.VX0 AIF (NOT &SGSCHDB(34)).VX0B    NO MCS
         AIF  (NOT &SGCPRGB(4)).VX0A    NOT MFT
         AIF  (&SGCPRGA(6) GE 2600).VX0A   SYSQUE SET TO 2600 OR MORE
&SGCPRGA(6) SETA  2600 IF MCS AND MFT SYSQUE DEFAULT IS 2600
    MNOTE *,'      2600 BYTES WILL BE ALLOCATED TO SYSTEM QUEUE AREA'
 AGO .VX0A
.VX0B AIF (&SGCPRGA(6) NE 1600).VX503
 AIF (NOT &SGCPRGB(4)).VX503
 MNOTE *,'     1600 BYTES FOR SYSTEM QUEUE AREA IS THE DEFAULT VALUE'
 AGO .VX503
.VX0A  ANOP
.VX1 AIF ('&SGSCHDC(14)' EQ '').VX3  NO HARD COPY ADDRESS
&ADDRESO SETC '&SGSCHDC(1)'(4,3)
    AIF ('&SGSCHDC(14)' EQ '&ADDRESO').VX27  ADDR ALSO IN PRIM.CONSLE
&C  SETA &SGSCNYA(1)
.VX2 AIF (&C EQ 0).VX25
&ADDRESO SETC '&SGSCNCC(&C)'(4,3)
    AIF ('&SGSCHDC(14)' EQ '&ADDRESO').VX27  ADDR ALSO IN SEC.CONSLE
&C  SETA &C-1
    AGO .VX2
.VX25 MNOTE 5,'* * * IEIGEN208 HARDCPY ADDRESS &SGSCHDC(14) NOT SPECIFI*
               ED IN OUTPUT OF SCHEDULR OR SECONSLE CONSOLE'
&SGQUITB SETB 1
.VX27 ANOP
&Z  SETC  '&SGSCHDC(14)'(1,3)
    CONVERT TO=HEX,DIGITS=3,VALUE=&Z
    IOCHECK LOOKFOR=&HEX
    AIF (&HEX EQ 0).VX28
&HEX SETA &SGDADRA(&HEX)/1048576
   AIF ((&SGDT04B(&HEX) AND (&SGDU01B(&HEX) OR &SGDU02B(&HEX))) OR (&SGX
               DT06B(&HEX) AND (&SGDU01B(&HEX) OR &SGDU02B(&HEX) OR &SGX
               DU03B(&HEX)))).VX3       1052/2150/1403/1404/1443
    AIF (&SGDT04B(&HEX) AND (&SGDU03B(&HEX) OR &SGDU04B(&HEX) OR       *
               &SGDU08B(&HEX))).VX3                              S99235
     AIF (&SGDT06B(&HEX) AND &SGDU06B(&HEX)).VX3       3211
     AIF (&SGDT08B(&HEX) AND &SGDU08B(&HEX)).VX3        2740
     AIF (&SGDT05B(&HEX) AND (&SGDU07B(&HEX) OR &SGDU09B(&HEX))).VX3
.*                                      3284 OR 3286 GRAPHIC PRINTERS
.VX28 MNOTE 5,'* * * IEIGEN219 SCHEDULR MACRO, ADDRESS &Z INVALID FOR HX
               ARDCOPY'
&SGQUITB SETB 1
.VX3 AIF ('&SGSCHDC(2)' EQ '&SGSCHDC(1)' OR '&SGSCHDC(2)' EQ 'FFFFFF' O*
               R '&SGSCHDC(2)' EQ '').VX4    ALTCONS OMITTED
&C  SETA &SGSCNYA(1)
.VX35 AIF (&C EQ 0).VX38
    AIF ('&SGSCHDC(2)' EQ '&SGSCNCC(&C)').VX4  ALT. EQ SEC. CONSLE
&C  SETA &C-1
    AGO .VX35
.VX38 ANOP
&ADDRESI SETC '&SGSCHDC(2)'(1,3)
&ADDRESO SETC '&SGSCHDC(2)'(4,3)
    AIF ('&ADDRESI' EQ '&ADDRESO').VX39
      MNOTE 5,'* * * IEIGEN209 SCHEDULR ALTCONS &SGSCHDC(2) NOT SPECIFI*
               ED IN SECONSLE CONSOLE'
&SGQUITB SETB 1
    AGO .VX4
.VX39 MNOTE 5,'* * * IEIGEN209 SCHEDULR ALTCONS &ADDRESI NOT SPECIFIED *
               IN SECONSLE CONSOLE'
&SGQUITB SETB 1
.VX4 AIF ('&SGSCHDC(1)' EQ '').VX5  SCHEDULR CONSOLE OMITTED
&C  SETA &SGSCNYA(1)
.VX42 AIF (&C EQ 0).VX5      SCHEDULR CONSOLE NOT DUPLICATED
    AIF ('&SGSCHDC(1)' EQ '&SGSCNCC(&C)').VX45
&C  SETA &C-1
    AGO .VX42
.VX45 ANOP
&ADDRESI SETC '&SGSCHDC(1)'(1,3)
&ADDRESO SETC '&SGSCHDC(1)'(4,3)
    AIF ('&ADDRESI' EQ '&ADDRESO').VX49
      MNOTE 5,'* * * IEIGEN210 SCHEDULR CONSOLE &SGSCHDC(1) DUPLICATED *
               IN SECONSLE CONSOLE'
&SGQUITB SETB 1
    AGO .VX5
.VX49 MNOTE 5,'* * * IEIGEN210 SCHEDULR CONSOLE &ADDRESI DUPLICATED IN *
               SECONSLE CONSOLE'
&SGQUITB SETB 1
.VX5 ANOP
&OADAC  SETA  &SGSCNYA(1)
.VX5A  ANOP
&OADCT  SETA  &SGSCNYA(1)
.VX5B  AIF  (&OADAC EQ 0).VX503
     AIF  (&OADCT NE 0).VX5C
&OADAC  SETA  &OADAC-1
     AGO  .VX5A
.VX5C   ANOP
     AIF  (&OADCT NE &OADAC).VX5C1
&OADCT  SETA  &OADCT-1
     AGO  .VX5B
.VX5C1   ANOP
&C4     SETC  '&SGSCNCC(&OADAC)'(4,3)
&C5    SETC  '&SGSCNCC(&OADCT)'(4,3)
     AIF  ('&C4' NE '&C5').VX5C2
.VX5C5 MNOTE 5,'* * * IEIGEN222 SECONSLE CONSOLE VALUE &C4 DUPLICATED'
&SGQUITB SETB 1
&OADAC  SETA  &OADAC-1
     AGO  .VX5A
.VX5C2  ANOP
&Z     SETC  'FFF'
&C4    SETC  '&SGSCNCC(&OADAC)'(1,3)
&C5    SETC  '&SGSCNCC(&OADCT)'(1,3)
     AIF  ('&C4' NE '&Z' AND '&C5' NE '&Z').VX5C3
&OADCT  SETA  &OADCT-1
     AGO  .VX5B
.VX5C3  AIF  ('&C4' NE '&C5').VX5C4
     AGO  .VX5C5
.VX5C4  ANOP
&OADCT  SETA  &OADCT-1
     AGO  .VX5B
.VX503   ANOP
&SS SETB 1
    AIF ('&SGSCHDC(1)' EQ '').VX506
&Z SETC '&SGSCHDC(1)'(1,3)
    AGO .VX505
.VX504 AIF (&XX EQ &SGSCNYA(1)).VX512
&XX SETA &XX+1
    AIF  ('&SGSCNCC(&XX)' EQ '').VX509
&Z SETC '&SGSCNCC(&XX)'(1,3)
    AIF ('&Z' EQ 'FFF').VX508
&II SETB 1
.VX505 CONVERT  TO=HEX,DIGITS=3,VALUE=&Z
    IOCHECK  LOOKFOR=&HEX
    AIF  (&HEX EQ 0).VX505A
&OADAC  SETA  &SGDADRA(&HEX)/1048576
&HEX    SETA  &SGDADRA(&HEX)/4096-&SGDADRA(&HEX)/1048576*256
    AIF (NOT (&SGDT05B(&OADAC) AND &SGDU02B(&OADAC))).L2250   2260
    AIF (&SGDM01B(&OADAC) AND &SGDF01B(&OADAC) AND &SGUNT2B(&HEX) AND  X
               &SGUNU8B(&HEX) AND &SGUNM3B(&HEX) AND &SGUNF1B(&HEX)).C2X
               260       2260/1 AN KYBD, 2848/3 LINE ADDRESSING
&C6 SETC '&SGSCNCC(&XX)'(1,3)                                    58697
    AIF ('&C6' EQ 'FFF').C2260                                   58697
    MNOTE 5,'* * * IEIGEN224 2260 CONSOLE, ADDRESS &Z, MUST BE MODEL 1 X
               WITH ALPHANUMERIC KEYBOARD FEATURE ATTACHED TO 2848 MODEX
               L 3 WITH LINE ADDRESSING FEATURE'
&SGQUITB SETB 1
.C2260 ANOP
&SGSCHDA(11) SETA &SGSCHDA(11)+1             2260 COUNT
    AGO .VX505A
.L2250  AIF (NOT (&SGDT05B(&OADAC) AND &SGDU01B(&OADAC))).L5450  2250
    AIF (&SGDM01B(&OADAC) OR &SGDM03B(&OADAC)).CM3     MODEL 1 OR 3
    MNOTE 5,'* * * IEIGEN225 2250 CONSOLE, ADDRESS &Z, MUST BE MODEL 1 X
               OR MODEL 3'
&SGQUITB SETB 1
.CM3 AIF (NOT (&SGDM03B(&OADAC))).C2250                MODEL 3
    AIF (&SGMENTB(12)).CNS                             GRAPHICS
&GR SETB 1
.CNS AIF (&SGDNBFA(&OADAC) GE 16).C2250      NUMSECT, 16 MINIMUM
&SGDNBFA(&OADAC) SETA 16                     16 DEFAULT
    MNOTE 0,'* * * IEIGENW02  NUMSECT, IODEVICE, ADDRESS &Z, HAS BEEN DX
               EFAULTED TO MINIMAL ACCEPTABLE VALUE OF 16'
.C2250 ANOP
&SGSCHDA(10) SETA &SGSCHDA(10)+1                  2250 COUNT
         AGO   .VX505A                            2250 COUNT
.L5450   AIF (NOT (&SGDT05B(&OADAC) AND &SGDU06B(&OADAC))).C3270
&SG5450A SETA  &SG5450A+1                         3066/5450 COUNT
         AGO   .VX505A
.C3270   ANOP                                     3270 CONSOLES
         AIF (&SGDT05B(&OADAC) AND &SGDU07B(&OADAC)).C328X
         AIF (&SGDT05B(&OADAC) AND &SGDU08B(&OADAC)).C3277
         AIF (&SGDT05B(&OADAC) AND &SGDU09B(&OADAC)).C328X
         AIF (&SGDT05B(&OADAC) AND &SGDU10B(&OADAC)).C3277X2      M5056
         AGO   .VX505A
.C3277   AIF (NOT (&SGDM01B(&OADAC))).C3277X2                     M5056
&SGSCHDA(17) SETA &SGSCHDA(17)+1                  3277-1 COUNT
         AGO   .VX505A
.C3277X2 ANOP                                                     M5056
&SGSCHDA(18) SETA &SGSCHDA(18)+1                  3158/3277-2 COUNT
         AGO   .VX505A
.C328X   ANOP                                     3284/86-1 COUNT
         AIF (NOT (&SGDM01B(&OADAC))).C328X2
&SGSCHDA(19) SETA &SGSCHDA(19)+1
         AGO   .VX505A
.C328X2  ANOP                                     3284/86-2 COUNT
&SGSCHDA(20) SETA &SGSCHDA(20)+1
.VX505A  AIF (NOT (&SS)).VX507
    AIF ('&Z' EQ '&SGSCHDC(1)'(4,3)).VX506
&Z SETC '&SGSCHDC(1)'(4,3)
    AGO .VX505
.VX506 ANOP
&SS SETB 0
    AGO .VX504
.VX507 AIF (NOT (&II)).VX509
    AIF ('&SGSCNCC(&XX)'(1,3) EQ '&SGSCNCC(&XX)'(4,3)).VX509
.VX508 ANOP
&II SETB 0
&Z SETC '&SGSCNCC(&XX)'(4,3)
    AGO .VX505
.VX509 AIF ('&SGSCNAC(&XX)' EQ '').VX504
&TT SETA &SGSCNYA(1)
.VX510 AIF (&TT EQ 0).VX511
    AIF (('&SGSCNAC(&XX)' EQ '&SGSCNCC(&TT)') OR ('&SGSCNAC(&XX)' EQ '&X
               SGSCHDC(1)')).VX504
&TT SETA &TT-1
    AGO .VX510
.VX511 MNOTE 5,'* * * IEIGEN229 SECONSLE ALT., ADDRESS &SGSCNAC(&XX), HX
               AS NOT BEEN SPECIFIED AS A CONSOLE'
&SGQUITB SETB 1
    AGO .VX504
.VX512  AIF (NOT &SGSCHDB(34)).VY            NO MCS
.VX51A   ANOP
&C5      SETC   'FFF'
&OADAC   SETA   &SGSCNYA(1)
.VX5D    AIF   (&OADAC EQ 0).VX51
&Z       SETC   '&SGSCNCC(&OADAC)'(1,3)
         AIF    ('&Z' NE '&C5').VX5F
&Z       SETC   '&SGSCNCC(&OADAC)'(4,3)
         CONVERT TO=HEX,DIGITS=3,VALUE=&Z
         IOCHECK LOOKFOR=&HEX
         AIF   (&HEX EQ 0).VX5F
&HEX     SETA  &SGDADRA(&HEX)/1048576
     AIF  (&SGDT06B(&HEX) AND &SGDU01B(&HEX)).VX5F
     AIF  (&SGDT06B(&HEX) AND &SGDU02B(&HEX)).VX5F
     AIF  (&SGDT06B(&HEX) AND &SGDU03B(&HEX)).VX5F
     AIF (&SGDT06B(&HEX) AND &SGDU06B(&HEX)).VX5F      3211
     AIF (&SGDT04B(&HEX) AND &SGDU08B(&HEX)).VX5F      3213      S99235
     AIF  (&SGDT05B(&HEX) AND (&SGDU07B(&HEX) OR &SGDU08B(&HEX) OR     *
               &SGDU09B(&HEX) OR &SGDU10B(&HEX))).VX5F           S99235
     AIF  (&SGDT05B(&HEX) AND &SGDU02B(&HEX)).VX5F     2260
.VX5E MNOTE 5,'* * * IEIGEN219 O-&Z CONSOLE MUST BE A 1403, 1443, 2260,*
               3211,3213,3158 3277, 3284, OR 3286'               S99235
&SGQUITB SETB   1
.VX5F    ANOP
&OADAC   SETA  &OADAC-1
         AGO  .VX5D
.VX51    ANOP
     AIF   (NOT &SGDCLSB(50)).VX51X     2740 SPECOFOED
.VX51L  ANOP
&C  SETA  &SGSCNYA(1)
.VX51M  AIF  (&C EQ 0).VX51X
&Z  SETC  '&SGSCNCC(&C)'(4,3)
     CONVERT  TO=HEX,DIGITS=3,VALUE=&Z
     IOCHECK  LOOKFOR=&HEX
     AIF   (&HEX EQ 0).VX51RB
&OADAC   SETA  &SGDADRA(&HEX)/1048576
&HEX     SETA  &SGDADRA(&HEX)/4096-&SGDADRA(&HEX)/1048576*256
     AIF  (&SGDT08B(&OADAC) AND &SGDU08B(&OADAC)).VX51N
     AGO   .VX51RB
.VX51N AIF (&SGUNT2B(&HEX) AND &SGUNU1B(&HEX)).VX51P
        AIF (&SGUNT2B(&HEX) AND &SGUNU2B(&HEX)).VX51P
        AIF   (&SGUNT3B(&HEX) AND &SGUNU1B(&HEX)).VX51P
     AGO  .VX51R
.VX51P   AIF   (&SGDF06B(&OADAC)).VX51RB    CHECKING FEATURE
    MNOTE 5,'* * * IEIGEN220  2740 REQUIRES RECORD CHECKING FEATURE WHEX
               N USED AS CONSOLE.'
&SGQUITB  SETB  1
     AGO   .VX51RB
.VX51R   ANOP
   MNOTE  5,'* * * IEIGEN221  2740 MUST BE ATTACHED TO A 2701,2702 OR  X
               2703 CONTROL UNIT'
.VX51RB   ANOP
&C  SETA  &C-1
     AGO  .VX51M
.VX51X  AIF  (NOT &SGDCLSB(50)).VX51ZA      2740 SPECIFIED
     AIF   (NOT &SGSCHDB(34)).VX51ZA    MCS SPECIFIED
&SGMCSTB(1)  SETB  1
.VX51ZA  ANOP
&C  SETA &SGSCNYA(1)
.VX51Z  AIF  (&C EQ 0).VY      SECONSLES EXHAUSTED
&ADDRESI  SETC  '&SGSCNCC(&C)'(1,3)
     CONVERT  TO=HEX,DIGITS=3,VALUE=&ADDRESI
     IOCHECK   LOOKFOR=&HEX
&C5      SETC   'FFF'
         AIF   ('&ADDRESI' EQ '&C5').VX52
    AIF (&HEX EQ 0).VNFNDI
&HEX     SETA  &SGDADRA(&HEX)/1048576
    AIF (&SGDT04B(&HEX) AND &SGDU01B(&HEX) AND &SGDM01B(&HEX)).VX52
    AIF (&SGDT04B(&HEX) AND (&SGDU03B(&HEX) OR &SGDU04B(&HEX) OR       *
               &SGDU08B(&HEX))).VX52                             S99235
 AIF (&SGDT07B(&HEX) AND (&SGDU02B(&HEX) OR &SGDU03B(&HEX) OR &SGDU04B(*
               &HEX) OR (&SGDU01B(&HEX) AND &SGDM01B(&HEX)))).VFNDRDR
         AIF   (&SGDT07B(&HEX) AND (&SGDU08B(&HEX) OR &SGDU09B(&HEX))).*
               VFNDRDR                **RDR OR PUNCH EQ 3505 OR 3525**
     AIF (&SGDT05B(&HEX) AND &SGDU01B(&HEX)).VX52              2250
    AIF (&SGDT08B(&HEX) AND &SGDU08B(&HEX)).VX52   2740
     AIF  (&SGDT05B(&HEX) AND &SGDU06B(&HEX)).VX52     5450
     AIF (&SGDT05B(&HEX) AND &SGDU02B(&HEX)).VX52      2260
.*                                                               S99235
     AIF (&SGDT05B(&HEX) AND ((&SGDU08B(&HEX) AND &SGDM02B(&HEX) OR &SG*
               DU10B(&HEX)) AND (&SGDF02B(&HEX) OR &SGDF10B(&HEX) OR &S*
               GDF11B(&HEX) OR &SGDF12B(&HEX) OR &SGDF13B(&HEX)))).VX52
.VNFNDI MNOTE 5,'* * * IEIGEN212 SECONSLE MACRO, ADDRESS &ADDRESI INVAL*
               ID FOR SECONDARY CONSOLE INPUT'
&SGQUITB SETB 1
    AGO .VCHKO
.VFNDRDR ANOP
&ADDRESO SETC '&SGSCNCC(&C)'(4,3)      * IF OUTPUT ADDR EQ RDR ADDR,
    AIF ('&ADDRESI' EQ '&ADDRESO').VNFNDO      *  THEN INVALID
.VX52    AIF (&SGSCNPA(&C) EQ 0).VTGRI
         AIF (&SGDT05B(&HEX) AND &SGDU01B(&HEX) AND (&SGDF02B(&HEX) OR *
               &SGDF03B(&HEX))).VTGRI        2250 WITH PFK OR LIGHTPEN
.*  THE FOLLOWING STATEMENTS CHECK FOR 3277-2 AND 3158            67190
         AIF (&SGDT05B(&HEX) AND &SGDU08B(&HEX) AND &SGDM02B(&HEX)).VTG*
               RI     3277 MODEL 2                                67190
         AIF (&SGDT05B(&HEX) AND &SGDU10B(&HEX)).VTGRI   3158   SA69945
    MNOTE 5,'* * * IEIGEN302 SECONSLE MACRO, CONSOLE ADDRESS &ADDRESI -*
               PFK SPECIFICATION INVALID'
&SGQUITB SETB  1
.VTGRI   AIF (&SGTGRIA(&C) EQ 0).VCHKO
         AIF (&SGDT05B(&HEX) AND (&SGDU01B(&HEX) OR &SGDU02B(&HEX) OR &*
               SGDU06B(&HEX) OR &SGDU08B(&HEX) OR                      *
               &SGDU10B(&HEX))).VCHKO                            S99235
&SGTGRIA(&C) SETA 0
    MNOTE 0,'* * * IEIGENW20 SECONSLE MACRO, CONSOLE ADDRESS &ADDRESI -*
               OPSTRNI SPECIFICATION INVALID AND HAS BEEN IGNORED'
.VCHKO   ANOP  CHECK SECONSLE-CONSOLE OUTPUT ADDRESS
&ADDRESO SETC '&SGSCNCC(&C)'(4,3)
    AIF ('&ADDRESI' EQ '&ADDRESO' AND &HEX EQ 0).VX6A
    AIF ('&ADDRESI' EQ '&ADDRESO').VX53
    CONVERT TO=HEX,DIGITS=3,VALUE=&ADDRESO
    IOCHECK LOOKFOR=&HEX
    AIF (&HEX EQ 0).VNFNDO
&HEX     SETA  &SGDADRA(&HEX)/1048576
    AIF ((&SGDT04B(&HEX) AND &SGDU01B(&HEX) AND &SGDM01B(&HEX))OR (&SGD*
               T06B(&HEX) AND (&SGDU01B(&HEX) OR &SGDU02B(&HEX) OR &SGD*
               U03B(&HEX)))).VX53
    AIF (&SGDT04B(&HEX) AND (&SGDU03B(&HEX) OR &SGDU04B(&HEX))).VX53
     AIF (&SGDT06B(&HEX) AND &SGDU06B(&HEX)).VX53      3211
     AIF (&SGDT04B(&HEX) AND &SGDU08B(&HEX)).VX53      3213      S99235
     AIF (&SGDT05B(&HEX) AND (&SGDU07B(&HEX) OR &SGDU09B(&HEX))).VX53
.*                                                               S99235
     AIF (&SGDT05B(&HEX) AND (&SGDU08B(&HEX) OR &SGDU10B(&HEX))).VX52A
     AIF (&SGDT05B(&HEX) AND &SGDU01B(&HEX)).VX6               2250
    AIF (&SGDT08B(&HEX) AND &SGDU08B(&HEX)).VX53               2740
     AIF  (&SGDT05B(&HEX) AND &SGDU06B(&HEX)).VX6        5450
     AIF (&SGDT05B(&HEX) AND &SGDU02B(&HEX)).VX6       2260
.VNFNDO MNOTE 5,'* * * IEIGEN213 SECONSLE MACRO, ADDRESS &ADDRESO INVAL*
               ID FOR SECONDARY CONSOLE OUTPUT'
&SGQUITB SETB 1
    AGO .VX6A
.VX52A   AIF   ('&ADDRESI' EQ 'FFF').VX52B
         AIF (NOT (&SGDM01B(&HEX))).VX6
    MNOTE 5,'* * * IEIGEN230 SECONSLE MACRO, ADDRESS &ADDRESO INVALID A*
               S OUTPUT DEVICE IN COMPOSITE EXPRESSION'
&SGQUITB       SETB 1
         AGO   .VX6
.VX52B   AIF   (NOT &SGDM01B(&HEX)).VX6 MODEL 1                   58722
         AIF   (&SGSCMSB(&C)).VX60      USE EQUAL MS
    MNOTE 0,'USE=MS DEFAULTED FOR 3277 MODEL 1'
&SGSCMSB(&C)   SETB 1
&SGSCSDB(&C)   SETB 0
         AGO   .VX60
.VX53 ANOP
         AIF (&SGDT05B(&HEX) AND (&SGDU07B(&HEX) OR &SGDU09B(&HEX))).HD*
               COPY2                         3284 OR 3286
 AIF (NOT(&SGDT04B(&HEX) OR (&SGDT06B(&HEX) AND (&SGDU01B(&HEX) OR &SGD*
               U02B(&HEX) OR &SGDU03B(&HEX))) OR (&SGDT08B(&HEX) AND &S*
               GDU08B(&HEX)))).VX6
 AIF ((&SGDT04B(&HEX) AND &SGDU01B(&HEX)) AND NOT &SGDM01B(&HEX)).VX6
.HDCOPY2 ANOP                           SET HARDCOPY SW FOR PRINTERS
&AC SETB 1
.VX6     AIF (NOT (&SGSCSDB(&C) OR &SGSCMSB(&C))).VX60 NOT MS OR SD
         AIF (&SGDT05B(&HEX) AND (&SGDU02B(&HEX) OR &SGDU08B(&HEX) OR  *
               &SGDU10B(&HEX))).VX60      2260/3277/158         SA58139
    MNOTE 5,'* * * IEIGEN216 SECONSLE MACRO, ADDRESS &ADDRESO INVALID A*
               S A LIMITED CAPACITY CONSOLE'
&SGQUITB SETB  1
.*                                                               S99235
.VX60    AIF ('&SGAR12A(&C)' NE '0' AND NOT(&SGDT05B(&HEX) AND (&SGDU01*
               B(&HEX) OR &SGDU02B(&HEX) OR &SGDU06B(&HEX) OR (&SGDU08B*
               (&HEX) AND &SGDM02B(&HEX)) OR &SGDU10B(&HEX)))).MS ERROR
         AIF (NOT(&SGDT05B(&HEX) AND (&SGDU01B(&HEX) OR &SGDU06B(&HEX))*
               )).B2260                                2250/5450/3066
         AIF ((&SGDU01B(&HEX) AND '&SGAR12A(&C)' GT '47') OR (&SGDU06B(*
               &HEX) AND '&SGAR12A(&C)' GT '30')).MS   ERROR
         AIF ('&SGAR12A(&C)' NE '0').VTGRO
&SGAR01A(&C) SETA 14                                   DEFAULT 14
&SGAR12A(&C) SETA 14
         AGO .MR
.B2260   AIF (NOT(&SGDT05B(&HEX) AND &SGDU02B(&HEX))).B3277
         AIF (&SGSCMSB(&C)).VTGRO                 MESSAGE STREAM MODE
         AIF (NOT &SGSCSDB(&C)).MQ                NOT STATUS DISPLAY
         AIF ('&SGAR12A(&C)' GT '11').MS               ERROR
         AIF ('&SGAR12A(&C)' NE '0').VTGRO
&SGAR01A(&C) SETA 11                                   DEFAULT 11
&SGAR12A(&C) SETA 11
         AGO .MR
.MQ      AIF ('&SGAR12A(&C)' GT '8').MS                ERROR
         AIF ('&SGAR12A(&C)' NE '0').VTGRO
&SGAR01A(&C) SETA 8                                    DEFAULT 8
&SGAR12A(&C) SETA 8
.MR MNOTE *,'CONSOLE ADDRESS &ADDRESO, STATUS DISPLAY AREA DEFAULTED TO*
               LENGTH OF &SGAR01A(&C)'
         AGO .VTGRO
.B3277   AIF (NOT(&SGDT05B(&HEX) AND (&SGDU08B(&HEX) AND &SGDM02B(&HEX)*
               )OR &SGDU10B(&HEX))).VTGRO        3158/3277-2     S99235
         AIF (&SGSCMSB(&C)).VTGRO            MESSAGE STREAM MODE
         AIF (NOT &SGSCSDB(&C)).MR1          NOT STATUS DISPLAY
         AIF ('&SGAR12A(&C)' GT '23').MS     ERROR
         AIF ('&SGAR12A(&C)' NE '0').VTGRO
&SGAR01A(&C) SETA 13
&SGAR02A(&C) SETA 10
&SGAR12A(&C) SETA 23
    MNOTE *,'CONSOLE ADDRESS &ADDRESO, STATUS DISPLAY AREAS DEFAULTED  *
               TO LENGTHS OF 13,10'
         AGO .VTGRO
.MR1     AIF ('&SGAR12A(&C)' GT '19').MS     ERROR
         AIF ('&SGAR12A(&C)' NE '0').VTGRO
&SGAR01A(&C) SETA 14
&SGAR12A(&C) SETA 14
         AGO .MR
.MS MNOTE 5,'* * * IEIGEN303 SECONSLE MACRO, DISPLAY AREA DEFINED INVAL*
               ID FOR CONSOLE ADDRESS &ADDRESO'
&SGQUITB SETB  1
.VTGRO   AIF (&SGTGROA(&C) EQ 0).VX6A
         AIF (&SGDT05B(&HEX) AND (&SGDU01B(&HEX) OR &SGDU02B(&HEX) OR &*
               SGDU06B(&HEX) OR &SGDU08B(&HEX))).VX6A
&SGTGROA(&C) SETA 0
    MNOTE 0,'* * * IEIGENW20 SECONSLE MACRO, CONSOLE ADDRESS &ADDRESO -*
               OPSTRAN SPECIFICATION INVALID AND HAS BEEN IGNORED'
.VX6A AIF  ('&SGSCNAC(&C)' EQ '').VX7        ALTCONS OMITTED
&ADDRESI SETC '&SGSCNAC(&C)'(1,3)
&C5      SETC   'FFF'
         AIF   ('&ADDRESI' EQ '&C5').VX62
    CONVERT TO=HEX,DIGITS=3,VALUE=&ADDRESI
    IOCHECK LOOKFOR=&HEX
    AIF (&HEX EQ 0).VNTFNDI
&HEX     SETA  &SGDADRA(&HEX)/1048576
    AIF ((&SGDT04B(&HEX)AND &SGDU01B(&HEX)AND &SGDM01B(&HEX))OR (&SGDT0*
               4B(&HEX)AND &SGDU02B(&HEX))).VX62  CONSLE
    AIF (&SGDT04B(&HEX) AND (&SGDU03B(&HEX) OR &SGDU04B(&HEX))).VX62
 AIF (&SGDT07B(&HEX) AND (&SGDU02B(&HEX) OR &SGDU03B(&HEX) OR &SGDU04B(*
               &HEX) OR (&SGDU01B(&HEX) AND &SGDM01B(&HEX)))).VRDRFND
         AIF   (&SGDT07B(&HEX) AND (&SGDU08B(&HEX) OR &SGDU09B(&HEX))).*
               VRDRFND                **RDR OR PUNCH EQ 3505 OR 3525**
     AIF (&SGDT05B(&HEX) AND &SGDU01B(&HEX)).VX62              2250
    AIF (&SGDT08B(&HEX) AND &SGDU08B(&HEX)).VX62       2740
     AIF  (&SGDT05B(&HEX) AND &SGDU06B(&HEX)).VX62      5450
     AIF (&SGDT05B(&HEX) AND &SGDU02B(&HEX)).VX62      2260
         AIF (&SGDT05B(&HEX) AND ((&SGDU08B(&HEX) AND &SGDM02B(&HEX))  *
               OR &SGDU10B(&HEX))).VX62       3277-2 OR 3158     S99235
.VNTFNDI  MNOTE 5,'* * * IEIGEN214 SECONSLE MACRO, ADDRESS &ADDRESI INV*
               ALID FOR SECONDARY ALT.CONSOLE INPUT'
&SGQUITB SETB 1
    AGO .VX62
.VRDRFND ANOP
&ADDRESO SETC '&SGSCNAC(&C)'(4,3)      * IF OUTPUT ADDR EQ RDR ADDR,
    AIF ('&ADDRESI' EQ '&ADDRESO').VNTFNDO     *  THEN INVALID
.VX62 ANOP
&ADDRESO SETC '&SGSCNAC(&C)'(4,3)
    AIF ('&ADDRESI' EQ '&ADDRESO').VX7
    CONVERT TO=HEX,DIGITS=3,VALUE=&ADDRESO
    IOCHECK LOOKFOR=&HEX
    AIF (&HEX EQ 0).VNTFNDO
&HEX     SETA  &SGDADRA(&HEX)/1048576
    AIF ((&SGDT04B(&HEX)AND &SGDU01B(&HEX)AND &SGDM01B(&HEX))OR (&SGDT0*
               4B(&HEX)AND &SGDU02B(&HEX))OR (&SGDT06B(&HEX)AND (&SGDU0X
               1B(&HEX)OR &SGDU02B(&HEX)OR &SGDU03B(&HEX)))).VX63
    AIF (&SGDT04B(&HEX) AND (&SGDU03B(&HEX) OR &SGDU04B(&HEX))).VX63
     AIF (&SGDT06B(&HEX) AND &SGDU06B(&HEX)).VX63      3211
     AIF (&SGDT04B(&HEX) AND &SGDU08B(&HEX)).VX63      3215      S99235
         AIF (&SGDT05B(&HEX) AND (&SGDU07B(&HEX) OR &SGDU09B(&HEX))).VX*
               63                            3284 OR 3286
.*                                                               S99235
     AIF (&SGDT05B(&HEX) AND (&SGDU08B(&HEX) OR &SGDU10B(&HEX))).VX62A
     AIF (&SGDT05B(&HEX) AND &SGDU01B(&HEX)).VX7               2250
         AIF   (&SGDT08B(&HEX) AND &SGDU08B(&HEX)).VX63   2740
     AIF  (&SGDT05B(&HEX) AND &SGDU06B(&HEX)).VX7      5450
     AIF (&SGDT05B(&HEX) AND &SGDU02B(&HEX)).VX7       2260
.VNTFNDO  MNOTE 5,'* * * IEIGEN215 SECONSLE MACRO, ADDRESS &ADDRESO INV*
               ALID FOR SECONDARY ALT.CONSOLE OUTPUT'
&SGQUITB SETB 1
    AGO .VX7
.VX63  ANOP
&AC SETB 1
         AGO   .VX7
.VX62A   AIF ('&ADDRESI' EQ 'FFF').VX7
         AIF (NOT (&SGDM01B(&HEX))).VX7
    MNOTE 5,'* * * IEIGEN230 SECONSLE MACRO, ADDRESS &ADDRESO INVALID A*
               S OUTPUT DEVICE IN COMPOSITE EXPRESSION'
&SGQUITB SETB 1
.VX7 AIF   ('&SGSCNAC(&C)' EQ '').VX7X    ALTCONS OMITTED       SA65020
&C  SETA &C-1
     AGO  .VX51Z     CHECK NEXT SECONSLE
.VX7X    ANOP                                                   SA65020
&SGSCNAC(&C) SETC '&SGSCHDC(1)'                                 SA65020
&C  SETA &C-1                                                   SA65020
     AGO  .VX51Z     CHECK NEXT SECONSLE                        SA65020
.VY      AIF   (&AC OR &SGSCHDB(36)).VY1
         AIF   ('&SGSCHDC(14)' EQ '').VY1    NO HARDCOPY SPECIFIED
    MNOTE 5,'* * * IEIGEN228 HARDCOPY DEVICE IS REQUIRED AS A CONSOLE'
&SGQUITB SETB 1
.VY1 AIF (&SGSCHDA(10)+&SGSCHDA(11)+&SGSCHDA(17)+&SGSCHDA(18)+&SGSCHDA(*
               19)+&SGSCHDA(20)+&SG5450A LE 0).VZ
    AIF (&SGSCHDB(34)).VY2
    MNOTE 5,'* * * IEIGEN227  2250/2260/3066/3277/3284/3286/5450 AS    *
               CONSOLES REQUIRE MCS'
&SGQUITB SETB 1
.VY2  AIF (NOT &GR).VZ
    MNOTE 5,'* * * IEIGEN226  2250 MODEL 3 CONSOLE INVALID WITHOUT GRAPX
               HICS'
&SGQUITB SETB  1
.VZ      ANOP
.* * * * THE FOLLOWING CHECKS THE TRANSIENT DCM GROUP TABLE * * * *
  AIF (&SGSCHDA(10)+&SGSCHDA(11)+&SGSCHDA(18)+&SG5450A LE 4).YZ1
&S       SETB  0
&S1      SETB  0
&A       SETA  0
&N       SETA  &SGSCNYA(1)                   NUMBER OF SECONSLES
&X       SETA  &N                            SECONSLE SUBSCRIPT
&CT      SETA  0                             NAME COUNTER
         AIF   (&SGTGRIA(32) EQ 0).VZ1       MASTER CONSOLE-INPUT
&A       SETA  &SGTGRIA(32)
         AIF   (&A NE &SGTGROA(32)).VZ5
&CT      SETA  &CT+1
         AGO   .VZ5                          GO CHECK REST OF TABLE
.VZ1     ANOP
&S       SETB  1
         AIF   (&SGTGROA(32) EQ 0).VZ2       MASTER CONSOLE-OUTPUT
&A       SETA  &SGTGROA(32)
         AGO   .VZ5                          GO CHECK REST OF TABLE
.VZ2     ANOP
         AIF   (&S1).VZ3
&S1      SETB  1
         AIF   (&SGTGRIA(&N) EQ 0).VZ3       SECONSLES-INPUT
&A       SETA  &SGTGRIA(&N)
         AGO   .VZ6
.VZ3     ANOP
&S1      SETB  0
         AIF   (&SGTGROA(&N) EQ 0).VZ4       SECONSLES-OUTPUT
&A       SETA  &SGTGROA(&N)
.VZ4     ANOP
&N       SETA  &N-1
         AIF   (&N LE 0).YZ1
&X       SETA  &N
.VZ5     AIF   (&A EQ 0).VZ7
         AIF   (&A NE &SGTGRIA(&X)).VZ6      START OF LOOP THRU TABLE
&CT      SETA  &CT+1
.VZ6     AIF   (&A NE &SGTGROA(&X)).VZ7
&CT      SETA  &CT+1
.VZ7     AIF   (&CT GT 4).VZMSG
         AIF   (&X LE 1).VZ8
&X       SETA  &X-1
         AGO   .VZ5                          END OF LOOP THRU TABLE
.VZ8     ANOP
&X       SETA  &N
&CT      SETA  0
         AIF   (NOT &S).VZ1                  BACK FOR MASTER-OUTPUT?
         AGO   .VZ2                          BACK FOR NEXT SECONSLE
.VZMSG   ANOP
    MNOTE 5,'* * * IEIGEN304 MAXIMUM OF 4 CONSOLES IN A TRANSIENT GROUP*
               - TRANSIENT GROUP &A, MAXIMUM EXCEEDED'
&SGQUITB SETB  1
         AGO   .VZ8
.YZ1     AIF   (&SGBSCA EQ 0).YZ2
         CONVERT  TO=HEX,VALUE=&SGBSCA
&SGBSCA  SETA  &HEX
.YZ2     AIF   (NOT &SGSUPRB(43)).YZ3
         AIF   (&SGCPUB(8) OR &SGCPUB(9) OR &SGCPUB(10) OR &SGCPUB(11) *
               OR &SGCPUB(12) OR &SGCPUB(13) OR &SGCPUB(14) OR         *
               &SGCPUB(15)).YZ3                                  S99235
&SGQUITB SETB  1
    MNOTE 5,'* * * IEIGEN228 RDE VALID ONLY ON SYSTEM 370 '      S99235
.YZ3     ANOP
.*  *  *  *  *  THE FOLLOWING DIAGNOSES TSO REQUIREMENTS  *  *  *  *
         AIF   (&SGDMGTB(1) OR NOT &SGSCHDB(44)).YZ4 BDAM OR NOT TSO
&SGDMGTB(1)    SETB 1                   NO - ASSUME BDAM & INFORM USER
    MNOTE 0,'* * * BDAM IS ASSUMED - TSO REQUIREMENT'
.YZ4     ANOP
.YZ5     ANOP
       AIF (NOT &SGDCLSB(74)).YZ5B                    2245 PNTR SPECD?
       AIF (&SGCPRGB(13)).YZ5A                        M65MP ?
       AIF (&SGCPRGB(4) OR &SGCPRGB(8)).YZ5B          MFT OR MVT ?
.YZ5A MNOTE 5,'* * * IEIGEN229  2245 PRINTER VALID FOR MFT OR MVT ONLY'
&SGQUITB SETB 1
.YZ5B    ANOP
.YZ8     ANOP                     ***** ADD NEW CHECKS HERE       *****
.MEND    MEND

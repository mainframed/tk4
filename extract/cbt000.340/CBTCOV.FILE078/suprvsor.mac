         MACRO
 SUPRVSOR &OPTIONS=,&RESIDNT=,&SER=,&TIMER=,&WAIT=,&TRACE=,&USERERR=NO,*
               &ALTSYS=,&ASCII=EXCLUDE,&LOAD=STANDARD
         COPY  SGGBLPAK
         LCLA  &A
 LCLC &B,&C,&D
         AIF  (&SGMENTB(10)).MR        SUPRVSOR ENTRY SWITCH
&SGMENTB(10)  SETB   1      SUPRVSOR ENTRY SWITCH.
&SGSUPRB(2) SETB 1            PATCH AREA ALWAYS INCLUDED IN NUCLEUS
         AIF   (T'&OPTIONS EQ 'O').RES
    MNOTE *,'     SUPERVISOR OPTION(S)'
.BACK1 AIF (&A GE N'&OPTIONS).DDFIN
&A       SETA  &A+1
         AIF   ('&OPTIONS(&A)' EQ 'IDENTIFY').ID
  AIF  ('&OPTIONS(&A)' EQ 'TRSVCTBL').SV
   AIF ('&OPTIONS(&A)' EQ 'VALIDCHK').VC
 AIF ('&OPTIONS(&A)' EQ 'COMM').CO
 AIF ('&OPTIONS(&A)' EQ 'PROTECT').PR
 AIF ('&OPTIONS(&A)' EQ 'ONLNTEST').ONL
   AIF ('&OPTIONS(&A)' EQ 'DECSIM').DS
 AIF ('&OPTIONS(&A)' EQ 'CCH').CH
         AIF   ('&OPTIONS(&A)' EQ 'RER').RE
 AIF ('&OPTIONS(&A)' EQ 'NODAV').NO
 AIF ('&OPTIONS(&A)' EQ 'DDR').DR
 AIF ('&OPTIONS(&A)' EQ 'DDRSYS').RSYS
 AIF ('&OPTIONS(&A)' EQ 'APR').AR
 AIF ('&OPTIONS(&A)' EQ 'DDRNSL').RNSL
 AIF  ('&OPTIONS(&A)' EQ 'ATTACH').ATCH
 AIF  ('&OPTIONS(&A)' EQ 'RDE').RDE
    MNOTE 5,'* * * IEISUP101 OPTIONS VALUE &OPTIONS(&A) INVALID'
&SGQUITB SETB  1
         AGO    .BACK1
.ID MNOTE *,'        IDENTIFY'
&SGSUPRB(1)     SETB 1
         AGO   .BACK1
.SV MNOTE *,'        TRANSIENT SVC TABLE'
&SGSUPRB(3)     SETB 1
         AGO   .BACK1
.VC  ANOP      THIS ENTRY SETS SWITCH 27 TO SHOW ENTRY FROM VALIDCHK
&SGSUPRB(27) SETB 1
.VA AIF (&SGSUPRB(4)).BACK1
    MNOTE *,'       EXTRA VALIDITY CHECKING'
&SGSUPRB(4)    SETB 1
         AGO   .BACK1
.CO MNOTE *,'       COMMUNICATION'
&SGSUPRB(22) SETB  1
  AGO  .BACK1
.PR MNOTE *,'       STORAGE PROTECTION'
&SGSUPRB(23)  SETB  1
  AGO  .VA
.ONL MNOTE *,'       ON-LINE TESTING'
&SGSUPRB(26)   SETB  1
  AGO    .BACK1
.DS MNOTE *,'       DECIMAL SIMULATOR INCLUDED'
&SGSUPRB(24)  SETB 1
   AGO  .BACK1
.NO MNOTE *,'       NO DIRECT ACCESS VOLUME SERIAL VERIFICATION'
&SGSUPRB(36)  SETB  1
         AGO   .BACK1
.CH MNOTE *,'       CHANNEL CHECK HANDLER'
&SGSUPRB(29) SETB 1
  AGO    .BACK1
.RE MNOTE *,'       REDUCED TAPE ERROR RECOVERY'
&SGSUPRB(32)  SETB  1
         AGO   .BACK1
.DR MNOTE *,'       DYNAMIC DEVICE RECONFIGURATION'
&SGSUPRB(33) SETB 1
 AGO .BACK1
.RSYS MNOTE *,'       DYNAMIC DEVICE RECONFIGURATION FOR SYSTEM'
 MNOTE *,'        RESIDENCE DEVICE'
&SGSUPRB(34) SETB 1
 AGO .BACK1
.AR MNOTE *,'       ALTERNATE PATH RETRY'
&SGSUPRB(35) SETB 1
 AGO .BACK1
.RNSL MNOTE *,'       DYNAMIC DEVICE RECONFIGURATION FOR NON-STANDARD'
 MNOTE *,'        LABELED TAPES'
&SGSUPRB(39) SETB 1
 AGO .BACK1
.ATCH MNOTE *,'       ASYNCHRONOUS ATTACH'
&SGSUPRB(37)  SETB  1
&SGSUPRB(16)  SETB  1
&SGSUPRB(17)  SETB  1
     AGO  .BACK1
.RDE  MNOTE *,'            RDE'
&SGSUPRB(43)   SETB  1
         AGO   .BACK1
.DDFIN   AIF   (&SGSUPRB(33)).CKALT
 AIF (&SGSUPRB(34) OR &SGSUPRB(39)).SET33
 AGO .CKALT
.SET33 ANOP
&SGSUPRB(33) SETB 1
 MNOTE *,'       DYNAMIC DEVICE RECONFIGURATION ASSUMED'
.CKALT AIF (&SGSUPRB(34) AND T'&ALTSYS NE 'O').DAVV
 AIF (NOT &SGSUPRB(34)).DAVV
 MNOTE 5,'* * * IEISUP110 OPTIONS=DDRSYS REQUIRES ALTSYS'
&SGQUITB SETB 1
.DAVV AIF (NOT(&SGSUPRB(33) AND &SGSUPRB(36))).RES
&SGSUPRB(36) SETB 0
 MNOTE 0,'* * * IEISUPW01 DIRECT ACCESS VOLUME VERIFICATION REQUIRED'
 MNOTE *,'      WITH OPTIONS=DDR -- OPTIONS=NODAV IGNORED'
.RES AIF (T'&RESIDNT EQ 'O').SERR
    MNOTE *,'     SUPERVISOR FUNCTIONS TO BE ALWAYS RESIDENT'
&A       SETA  0
.BACK2   AIF   (&A GE N'&RESIDNT).SERR
&A       SETA  &A+1
  AIF  ('&RESIDNT(&A)' NE 'ATTACH').RES1
&SGSUPRB(5)  SETB  1
   AGO  .OK
.RES1  AIF  ('&RESIDNT(&A)' NE 'EXTRACT').RES2
&SGSUPRB(6)  SETB  1
  AGO  .OK
.RES2  AIF  ('&RESIDNT(&A)' NE 'IDENTIFY').RES3
&SGSUPRB(7)  SETB  1
&SGSUPRB(1)  SETB  1
  AGO  .OK
.RES3 AIF ('&RESIDNT(&A)' NE 'SPIE').RES4
&SGSUPRB(8)  SETB  1
  AGO  .OK
.RES4 AIF ('&RESIDNT(&A)' NE 'BLDLTAB').RES5
&SGSUPRB(20) SETB  1
  AGO  .OK
.RES5  AIF  ('&RESIDNT(&A)' NE 'ACSMETH').RES6
&SGSUPRB(21)  SETB  1
   AGO  .OK
.RES6    AIF   ('&RESIDNT(&A)' NE 'TRSVC').RES7
&SGSUPRB(25)  SETB  1
   AGO  .OK
.RES7 AIF ('&RESIDNT(&A)' NE 'RENTCODE').RES9
&SGSUPRB(21)   SETB  1
&SGSUPRB(38)  SETB  1  LINK PACK AREA SWITCH FOR MFT-II
         AGO    .OK
.RES9 AIF ('&RESIDNT(&A)' NE 'ERP').XX
&SGSUPRB(40) SETB 1
  AGO .OK
.XX MNOTE 5,'* * * IEISUP102 RESIDNT VALUE &RESIDNT(&A) INVALID'
&SGQUITB  SETB  1
  AGO  .BACK2
.OK MNOTE *,'         &RESIDNT(&A)'
  AGO  .BACK2
.SERR    AIF   (T'&SER EQ 'O').WAIT
         AIF   ('&SER' EQ 'SER0').S0
         AIF   ('&SER' EQ 'SER1').S1
         AIF   ('&SER' EQ 'MCH').S2
         AIF   ('&SER' EQ 'SEREP').S3
    MNOTE 5,'* * * IEISUP103 SER VALUE &SER INVALID'
&SGQUITB SETB  1
         AGO   .WAIT
.S0 MNOTE *,'     SER LEVEL IS ZERO'
&SGSUPRB(9)    SETB 1
         AGO   .WAIT
.S1 MNOTE *,'     SER LEVEL IS ONE'
&SGSUPRB(10)   SETB 1
         AGO   .WAIT
.S2 MNOTE *,'       MACHINE CHECK HANDLER RECOVERY REQUESTED'
&SGSUPRB(28)  SETB  1
         AGO  .WAIT
.S3 MNOTE *,'     SER LEVEL IS SEREP'
&SGSUPRB(31)  SETB  1
.WAIT    AIF   (T'&WAIT EQ 'O').TIMER
         AIF   ('&WAIT' EQ 'SINGLE').S
         AIF   ('&WAIT' EQ 'MULTIPLE').M
    MNOTE 5,'* * * IEISUP104 WAIT VALUE &WAIT INVALID'
&SGQUITB SETB  1
         AGO   .TIMER
.S  MNOTE *,'     SINGLE EVENT WAIT REQUESTED'
&SGSUPRB(11)   SETB 1
         AGO   .TIMER
.M  MNOTE *,'     MULTIPLE EVENT WAIT REQUESTED'
&SGSUPRB(12)   SETB 1
.TIMER   AIF   (T'&TIMER EQ 'O').TRACE
         AIF   ('&TIMER' EQ 'TIME').T
         AIF   ('&TIMER' EQ 'INTERVAL').I
         AIF   ('&TIMER' EQ 'JOBSTEP').J
    MNOTE 5,'* * * IEISUP105 TIMER VALUE &TIMER INVALID'
&SGQUITB SETB  1
         AGO   .TRACE
.J  MNOTE *,'      ''JOBSTEP TIMING'' FUNCTION REQUESTED'
&SGSUPRB(19) SETB 1
&SGSUPRB(16)   SETB 1
  AGO  .TRACE
.T  MNOTE *,'     ''TIME'' FUNCTION REQUESTED'
&SGSUPRB(13)   SETB 1
         AGO   .TRACE
.I  MNOTE *,'     ''INTERVAL TIMER'' FUNCTION REQUESTED'
&SGSUPRB(14)   SETB 1
&SGSUPRB(16) SETB 1
.TRACE  AIF   (T'&TRACE EQ 'O').TSKTIME
         AIF  (T'&TRACE NE 'N' OR '&TRACE' EQ '0').ER
&SGSUPRA(1)    SETA &TRACE
    MNOTE *,'     THERE WILL BE A TRACE TABLE WITH &TRACE ENTRIES'
    AGO  .TSKTIME
.ER MNOTE 5,'* * * IEISUP106 TRACE VALUE &TRACE INVALID'
&SGQUITB SETB  1
.TSKTIME ANOP
 AIF (T'&ALTSYS EQ 'O').USERERR
 AIF (K'&ALTSYS NE 3).ALTERR
&B SETC '&ALTSYS'(1,1)
&C SETC '&ALTSYS'(2,1)
&D SETC '&ALTSYS'(3,1)
 AIF (NOT(('&B' GE '0' AND '&B' LE '9') OR ('&B' GE 'A' AND '&B' LE 'F'*
               ))).ALTERR
 AIF (NOT(('&C' GE '0' AND '&C' LE '9') OR ('&C' GE 'A' AND '&C' LE 'F'*
               ))).ALTERR
 AIF (NOT(('&D' GE '0' AND '&D' LE '9') OR ('&D' GE 'A' AND '&D' LE 'F'*
               ))).ALTERR
 MNOTE *,'       ALTERNATE SYSTEM RESIDENCE DEVICE FOR DDR IS &ALTSYS'
 CONVERT TO=HEX,VALUE=&ALTSYS,DIGITS=3
&SGSUPRA(2) SETA &HEX
 AGO .USERERR
.ALTERR MNOTE 5,'* * * IEISUP109 ALTSYS VALUE &ALTSYS INVALID'
&SGQUITB SETB 1
.USERERR AIF   ('&USERERR(1)' EQ 'NO').LOAD
         AIF   ('&USERERR(1)' NE 'YES').EU
    MNOTE *,'     THE USER ASYNCHRONOUS ERROR EXITS OPTION IS INCLUDED'
&SGSUPRB(18)   SETB  1
.LOAD    AIF   ('&LOAD' EQ 'STANDARD').ASCII
         AIF   ('&LOAD' EQ 'EXPLICIT').EXLOAD
    MNOTE 5,'* * * IEISUP111 LOAD VALUE &LOAD INVALID'
&SGQUITB SETB 1
         AGO   .ASCII
.EXLOAD MNOTE *,'      EXPLICIT LOAD FUNCTION REQUESTED'
&SGSUPRB(44)   SETB 1
.ASCII   AIF   ('&ASCII' EQ 'EXCLUDE').EX
         AIF   ('&ASCII' NE 'INCRES').IT
&SGSUPRB(41)   SETB 1
&SGSUPRB(42)   SETB 1
    MNOTE *,'       THE ASCII TRANSLATE SVC IS INCLUDED RESIDENT.'
         AGO   .MEND
.IT      AIF   ('&ASCII' NE 'INCTRAN').EY
&SGSUPRB(41)   SETB 1
    MNOTE *,'       THE ASCII TRANSLATE SVC IS INCLUDED TRANSIENT.'
         AGO   .MEND
.EX MNOTE *,'       THE ASCII TRANSLATE SVC IS EXCLUDED.'
         AGO   .MEND
.EU MNOTE 5,'* * * IEISUP107 USERERR VALUE &USERERR INVALID'
&SGQUITB SETB  1
         MEXIT
.EY MNOTE 5,'* * * IEISUP109  ASCII VALUE &ASCII IS INVALID.'
&SGQUITB SETB  1
         MEXIT
.MR MNOTE 5,'* * * IEISUP108 SUPRVSOR MACRO PREVIOUSLY USED'
&SGQUITB   SETB   1
.MEND  ANOP
   MEND

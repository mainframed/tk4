         MACRO
         MACLIB  &UNIT=,&VOLNO=,&EXCLUDE=
         COPY  SGGBLPAK
         LCLA  &A
         LCLC  &C
         AIF   (NOT &SGMENTB(42)).MAC1
    MNOTE 5,'* * * IEIMAL101 MACLIB MACRO PREVIOUSLY USED'
         AGO  .MAQUIT
.MAC1    ANOP
&SGMENTB(42)   SETB  1
         AIF   (N'&UNIT EQ N'&VOLNO).MAC2
    MNOTE 5,'* * * IEIMAL102 UNIT VALUE OR VOLNO VALUE MISSING'
&SGQUITB  SETB  1
         AGO   .MAC5
.MAC2  AIF  ('&UNIT' EQ '').M1
         AIF   (K'&UNIT LE 8).MAC3
    MNOTE 5,'* * * IEIMAL103 UNIT VALUE &UNIT INVALID'
&SGQUITB  SETB  1
.MAC3    AIF   (K'&VOLNO LE 6).MAC4
    MNOTE 5,'* * * IEIMAL104 VOLNO VALUE &VOLNO INVALID'
&SGQUITB  SETB  1
         AGO   .MAC5
.MAC4    ANOP
&SGCTRLC(15)   SETC   '&UNIT'
&SGCTRLC(16)   SETC   '&VOLNO'
         AGO   .MAC5
.M1 MNOTE *,'      MACRO LIBRARY WILL RESIDE ON SYSRES'
.MAC5    AIF   (N'&EXCLUDE LE 8).MAC6
    MNOTE 5,'* * * IEIMAL105 EXCLUDE VALUE &EXCLUDE INVALID'
         AGO   .MAQUIT
.MAC6    AIF   (&A NE N'&EXCLUDE).MAC7
         MEXIT
.MAC7    ANOP
&A       SETA  &A+1
&C       SETC  '&EXCLUDE(&A)'
         AIF   ('&C' NE 'BTAM').MAC8
&SGMALB(1)  SETB  1
         AGO   .M2
.MAC8    AIF   ('&C' NE 'QTAM').MACA
&SGMALB(2)  SETB  1
         AGO   .M2
.MACA    AIF   ('&C' NE 'GPS').MACB
&SGMALB(4)  SETB  1
         AGO   .M2
.MACB    AIF   ('&C' NE 'OCR').MACC
&SGMALB(5)     SETB 1
         AGO   .M2                      GO INFORM USER
.MACC    AIF   ('&C' NE 'TSO').MACD       TEST EXCLUDE=(TSO)
&SGMALB(7)     SETB 1                   YES - SET SWITCH
 AGO .M2
.MACD AIF ('&C' NE 'TCAM').MACE
&SGMALB(6) SETB 1
         AGO   .M2
.MACE    AIF   ('&C' NE 'FDM').M3
&SGMALB(10) SETB 1
.M2 MNOTE *,'      &C MACROS TO BE EXCLUDED FROM THE MACLIB'
         AGO   .MAC6
.M3 MNOTE 5,'* * * IEIMAL106 EXCLUDE VALUE &C INVALID'
&SGQUITB SETB  1
         AGO   .MAC6
.MAQUIT  ANOP
&SGQUITB SETB  1
         MEND

         MACRO
 FORTRAN &DESIGN=,&PUNCH=NODECK,&SORLIST=SOURCE,&STORMAP=NOMAP,        *
               &OBJPROG=LOAD,&SORCODE=EBCDIC,&LINELNG=132,&LINECNT=50, *
               &OBJLIST=NOLIST,&STORAGE=SPACE,&SCAN=NOADJUST,&OPT=0,   *
               &SIZE=1,&OBJID=NOID,&SOREDIT=NOEDIT,&SORXREF=NOXREF
         COPY  SGGBLPAK
         LCLA &A,&I
         LCLB  &E,&H,&G
         LCLC  &C
.*                                 DATED 31 MARCH 66
 AIF (NOT &SGMENTB(27)).A1
         AIF   ('&DESIGN' EQ 'H' AND &SGFORTB(2) OR '&DESIGN' EQ 'G' ANX
               D &SGFORTB(48)).D1
.A1     ANOP
         AIF   ('&DESIGN' NE 'H' AND '&DESIGN' NE 'G').E
    MNOTE *,'      FORTRAN DESIGN LEVEL &DESIGN SPECIFIED'
&SGMENTB(27)  SETB  1
&H   SETB  (&SGFORTB(2))
&G   SETB   (&SGFORTB(48))
&SGFORTB(2)  SETB  ('&DESIGN' EQ 'H')
&SGFORTB(48)  SETB  ('&DESIGN' EQ 'G')
&I  SETA (&SGFORTB(2)*15)+(&SGFORTB(48)*30)
.A2  AIF ('&PUNCH' NE 'DECK' AND '&PUNCH' NE 'NODECK').E1
&SGFORTB(&I+3)  SETB  ('&PUNCH' EQ 'DECK')
&SGFORTB(&I+4)  SETB  ('&PUNCH' EQ 'NODECK')
    MNOTE *,'      PUNCH OPTION FOR OBJECT DECK IS &PUNCH'
.A3  AIF ('&SORLIST' NE 'SOURCE' AND '&SORLIST' NE 'NOSOURCE').E2
&SGFORTB(&I+5)  SETB  ('&SORLIST' EQ 'SOURCE')
&SGFORTB(&I+6)  SETB  ('&SORLIST' EQ 'NOSOURCE')
    MNOTE *,'      LISTING OPTION FOR SOURCE PROGRAM IS &SORLIST'
.A4  AIF  ('&STORMAP' NE 'MAP' AND '&STORMAP' NE 'NOMAP').E3
&SGFORTB(&I+7)  SETB  ('&STORMAP' EQ 'MAP')
&SGFORTB(&I+8)  SETB  ('&STORMAP' EQ 'NOMAP')
    MNOTE *,'      RELATIVE LOCATION MAP OPTION IS &STORMAP'
.A5  AIF  ('&OBJPROG' NE 'LOAD' AND '&OBJPROG' NE 'NOLOAD').E4
&SGFORTB(&I+9)  SETB  ('&OBJPROG' EQ 'LOAD')
&SGFORTB(&I+10)  SETB  ('&OBJPROG' EQ 'NOLOAD')
    MNOTE *,'      RUN OPTION FOR OBJECT PROGRAM IS &OBJPROG'
.A6  AIF  ('&SORCODE' NE 'BCD' AND '&SORCODE' NE 'EBCDIC').E5
&SGFORTB(&I+11)  SETB  ('&SORCODE' EQ 'BCD')
&SGFORTB(&I+12)  SETB  ('&SORCODE' EQ 'EBCDIC')
    MNOTE *,'      SOURCE CODE CHARACTER SET OPTION IS &SORCODE'
.A7      ANOP
     AIF  ('&OBJLIST' NE 'LIST' AND '&OBJLIST' NE 'NOLIST').E6
&SGFORTB(&I+13)  SETB  ('&OBJLIST' EQ 'LIST')
    MNOTE *,'      LISTING OPTION FOR OBJECT PROGRAM IS &OBJLIST'
.B1  AIF  (&SGFORTB(48)).B4    G
     AIF  (&SGFORTB(2)).B3     H
         MEXIT
.B3      AIF   (T'&OPT NE 'N').E11
         AIF   (&OPT NE 0 AND &OPT NE 1 AND &OPT NE 2).E11
&SGFORTA(1)  SETA &OPT
    AIF   (&OPT NE 0).B3A
&C  SETC  'NO'
.B3A  AIF  (&OPT NE 1).B3B
&C  SETC 'BASIC'
.B3B  AIF  (&OPT NE 2).B3C
&C  SETC 'FULL'
.B3C MNOTE *,'      OBJECT PROGRAM OPTIMIZATION OPTION IS &C OPTIMIZATI*
               ON'
.B4      AIF   (T'&LINECNT NE 'N').E12
         AIF   (K'&LINECNT NE 2 OR &LINECNT LT 1 OR &LINECNT GT 99).E12
    AIF  (&SGFORTB(48)).B4A
&SGFORTA(6)  SETA &LINECNT
    AGO  .B4C
.B4A     ANOP
&SGFORTA(2)  SETA &LINECNT
.B4C MNOTE *,'      OBJECT PROGRAM PRINT PAGE IS MAXIMUM OF &LINECNT LI*
               NES'
.B5      AIF  (&SGFORTB(48)).B9        IF FORTRAN G
    AIF  ('&SIZE'(K'&SIZE,1) EQ 'K').B5A
         AIF   (T'&SIZE NE 'N').E13
     AIF   (&SIZE EQ 1).E15
         AIF   (&SIZE LT 153600 OR &SIZE GT 9999999).E13
&SGFORTA(5)  SETA  &SIZE
   AGO   .B5B
.B5A  ANOP
&C  SETC  '&SIZE'(1,K'&SIZE-1)
&A SETA K'&SIZE-1
.B5D AIF (&A EQ 0).B5C
     AIF ('&SIZE'(&A,1) LT '0' OR '&SIZE'(&A,1) GT '9').E13
&A SETA &A-1
     AGO .B5D
.B5C ANOP
&HEX    SETA   &C
     AIF (&HEX LT 150 OR &HEX GT 9999).E13
&SGFORTA(5)  SETA  &HEX*1024
.B5B MNOTE *,'      MAIN STORAGE AVAILABLE FOR COMPILER IS &SIZE BYTES'
.B6 AIF (NOT(&SGFORTB(2))).END          FORTRAN H
   AIF ('&OBJID' NE 'NOID' AND '&OBJID' NE 'ID').E16
&SGFORTB(29) SETB ('&OBJID' EQ 'NOID')
&SGFORTB(30)  SETB ('&OBJID' EQ 'ID')
   MNOTE *,'       INTERVAL STATEMENT NUMBERING OPTION IS &OBJID'
.B7 AIF ('&SOREDIT' NE 'NOEDIT' AND '&SOREDIT' NE 'EDIT').E17
&SGFORTB(44) SETB ('&SOREDIT' EQ 'NOEDIT')
&SGFORTB(45) SETB ('&SOREDIT' EQ 'EDIT')
   MNOTE *,'       STRUCTURED SOURCE LISTING OPTION IS &SOREDIT'
.B8 AIF ('&SORXREF' NE 'NOXREF' AND '&SORXREF' NE 'XREF').E18
&SGFORTB(49) SETB ('&SORXREF' EQ 'XREF')
&SGFORTB(50) SETB ('&SORXREF' EQ 'NOXREF')
 MNOTE *,'          SOURCE CROSS REFERENCE OPTION IS &SORXREF'
  AIF (NOT(&SGFORTB(45))).END           SOREDIT = EDIT
 AIF (&OPT EQ 2).END
   MNOTE 5,'* * * IEIFTC115 OPT=2 MUST BE SPECIFIED WITH SOREDIT=EDIT'
&SGQUITB  SETB  1
    AGO  .END
.B9 AIF ('&OBJID' NE 'NOID' AND '&OBJID' NE 'ID').E16
&SGFORTB(51) SETB ('&OBJID' EQ 'NOID')
&SGFORTB(52) SETB ('&OBJID' EQ 'ID')
   MNOTE *,'      INTERVAL STATEMENT NUMBERING OPTION IS &OBJID'
         AGO   .END
.D1 MNOTE 5,'* * * IEIFTC101 DESIGN LEVEL &DESIGN PREVIOUSLY SPECIFIED'
&SGQUITB  SETB 1
         AGO   .A2
.E  MNOTE 5,'* * * IEIFTC102 DESIGN VALUE &DESIGN INVALID'
&SGQUITB  SETB 1
         AGO   .A2
.E1 MNOTE 5,'* * * IEIFTC103 PUNCH VALUE &PUNCH INVALID'
&SGQUITB  SETB 1
         AGO   .A3
.E2 MNOTE 5,'* * * IEIFTC104 SORLIST VALUE &SORLIST INVALID'
&SGQUITB  SETB 1
         AGO   .A4
.E3 MNOTE 5,'* * * IEIFTC105 STORMAP VALUE &STORMAP INVALID'
&SGQUITB  SETB 1
         AGO   .A5
.E4 MNOTE 5,'* * * IEIFTC106 OBJPROG VALUE &OBJPROG INVALID'
&SGQUITB  SETB 1
         AGO   .A6
.E5 MNOTE 5,'* * * IEIFTC107 SORCODE VALUE &SORCODE INVALID'
&SGQUITB  SETB 1
         AGO   .A7
.E6 MNOTE 5,'* * * IEIFTC108 OBJLIST VALUE &OBJLIST INVALID'
&SGQUITB  SETB 1
         AGO   .B1
.E10 ANOP
     MNOTE 5,'* * * IEIFTC112 SIZE VALUE &SIZE INVALID'
&SGQUITB  SETB 1
         AGO   .B4
.E11 MNOTE 5,'* * * IEIFTC113 OPT VALUE &OPT INVALID'
&SGQUITB  SETB 1
         AGO   .B4
.E12 MNOTE 5,'* * * IEIFTC114 LINECNT VALUE &LINECNT INVALID'
&SGQUITB  SETB 1
         AGO   .B5
.E13 MNOTE 5,'* * * IEIFTC112 SIZE VALUE &SIZE INVALID'
&SGQUITB  SETB 1
   AGO  .B6
.E16 MNOTE 5,'* * * IEIFTC116 OBJID VALUE &OBJID INVALID'
&SGQUITB SETB 1
         AIF   (&SGFORTB(48)).END
   AGO   .B7
.E17 MNOTE 5,'* * * IEIFTC117 SOREDIT VALUE &SOREDIT INVALID'
&SGQUITB  SETB  1
 AGO .B8
.E18 MNOTE 5,'* * * IEIFTC118 SORXREF VALUE &SORXREF INVALID'
&SGQUITB SETB 1
.END   ANOP
&SGFORTB(2)  SETB  (&SGFORTB(2) OR &H)
&SGFORTB(48) SETB  (&SGFORTB(48) OR &G)
        MEXIT
.E14    ANOP
&SGFORTA(4) SETA 25856                  SET DEFAULT SIZE
     MNOTE *,'      MAIN STORAGE AVAILABLE FOR COMPILER IS 25856 BYTES'
       AGO   .B4
.E15    ANOP
&SGFORTA(5)   SETA   204800
    MNOTE *,'      MAIN STORAGE AVAILABLE FOR COMPILER IS 204800 BYTES'
  AGO  .B6
         MEND

         MACRO
          FORTLIB &UNIT=,&VOLNO=,&DESIGN=,&UNTABLE=08,&OBJERR=06,      X
               &ONLNRD=05,&ONLNPCH=07,&BOUNDRY=ALIGN,&OPTERR=EXCLUDE,&A*
               DDNTRY=
         COPY  SGGBLPAK
         LCLB  &A
         AIF   (NOT &SGMENTB(39)).A1
    MNOTE 5,'* * * IEIFOL101 FORTLIB MACRO PREVIOUSLY USED'
&SGQUITB SETB  1
         MEXIT
.A1      ANOP
&SGMENTB(39)  SETB  1
         AIF   (N'&UNIT EQ N'&VOLNO).A2
    MNOTE 5,'* * * IEIFOL102 UNIT OR VOLNO VALUE NOT SPECIFIED'
&A       SETB  1
         AGO   .B1
.A2      AIF   ('&UNIT' EQ '').B1
         AIF   (K'&UNIT LE 8).A3
    MNOTE 5,'* * * IEIFOL103 UNIT VALUE &UNIT INVALID'
&A       SETB  1
.A3      AIF   (K'&VOLNO LE 6).B1
    MNOTE 5,'* * * IEIFOL104 VOLNO VALUE &VOLNO INVALID'
&A       SETB  1
.B1      AIF   ('&DESIGN' NE '').B2
    MNOTE 5,'* * * IEIFOL105 DESIGN VALUE NOT SPECIFIED'
&A       SETB  1
         AGO   .B9
.B2     AIF    ('&DESIGN' NE 'E').B3
&SGFORLB(1)  SETB  1
 AGO  .B9B
.B3      AIF   ('&DESIGN' NE 'G').B4
&SGFORLB(2)  SETB  1
         AGO   .B9
.B4      AIF   ('&DESIGN' NE 'H').B8
&SGFORLB(3)  SETB  1
         AGO   .B9
.B8 MNOTE 5,'* * * IEIFOL106 DESIGN VALUE &DESIGN INVALID'
&A       SETB  1
.B9 AIF ('&BOUNDRY' NE 'ALIGN' AND '&BOUNDRY' NE 'NOALIGN').B9A
&SGFORLB(4) SETB ('&BOUNDRY' EQ 'ALIGN')
 AGO  .B9B
.B9A MNOTE 5,'* * * IEFOL114 BOUNDRY VALUE &BOUNDRY INVALID'
&A  SETB  1
.B9B     AIF   (T'&UNTABLE NE 'N').BB
         AIF  (K'&UNTABLE EQ 2 AND &UNTABLE GE 8 AND &UNTABLE LE 99).C2
.BB      ANOP
    MNOTE 5,'* * * IEIFOL107 UNTABLE VALUE &UNTABLE INVALID'
&A       SETB  1
.C2      AIF   (T'&OBJERR NE 'N').CC
         AIF   (K'&OBJERR EQ 2 AND '&OBJERR' LE '&UNTABLE').C5
.CC MNOTE 5,'* * * IEIFOL109 OBJERR VALUE &OBJERR INVALID'
&A       SETB  1
.C5      AIF   (T'&ONLNRD NE 'N').CA
         AIF   (K'&ONLNRD EQ 2 AND '&ONLNRD' LE '&UNTABLE' AND '&ONLNRD*
               ' NE '&OBJERR').C6
         AGO   .CA
.C6      AIF   (NOT &SGFORLB(1) OR &ONLNRD EQ 5).C7
.CA MNOTE 5,'* * * IEIFOL111 ONLNRD VALUE &ONLNRD INVALID'
&A       SETB  1
.C7      AIF   (T'&ONLNPCH NE 'N').CB
         AIF   (K'&ONLNPCH EQ 2 AND '&ONLNPCH' LE '&UNTABLE' AND '&ONLN*
               PCH' NE '&OBJERR' AND '&ONLNPCH' NE '&ONLNRD').C8
         AGO   .CB
.C8      AIF   (NOT &SGFORLB(1) OR &ONLNPCH EQ 7).D1
.CB MNOTE 5,'* * * IEIFOL113 ONLNPCH VALUE &ONLNPCH INVALID'
 AGO .D1
.C9      ANOP
&SGQUITB SETB  1
         MEXIT
.D1 AIF ('&OPTERR' NE 'EXCLUDE' AND '&OPTERR' NE 'INCLUDE').D1E
 AIF ('&OPTERR' EQ 'INCLUDE' AND '&DESIGN' EQ 'E').D1E
&SGFORLB(5) SETB ('&OPTERR' EQ 'INCLUDE')
 AGO .D1A
.D1E MNOTE 5,'* * * IEIFOL115 OPTERR VALUE &OPTERR INVALID'
&A SETB 1
.D1A AIF (T'&ADDNTRY EQ 'O').D1C
         AIF   (T'&ADDNTRY NE 'N').D1AA
  AIF ('&ADDNTRY' GE '0' AND '&ADDNTRY' LE '598' AND '&OPTERR' EQ 'INCL*
               UDE').D1B
.D1AA    ANOP
 MNOTE 5,'* * * IEIFOL116 ADDNTRY VALUE &ADDNTRY INVALID'
&A SETB 1
.D1B AIF (&A).C9
&SGFORLA(5)  SETA  &ADDNTRY
.D1C ANOP
&SGFORLA(1)  SETA  &UNTABLE
&SGFORLA(2)  SETA  &OBJERR
&SGFORLA(3)  SETA  &ONLNRD
&SGFORLA(4)  SETA  &ONLNPCH
         AIF   ('&UNIT' NE '').D2
    MNOTE *,'      THE LEVEL &DESIGN FORTRAN LIBRARY WILL RESIDE ON SYSX
               RES'
         AGO   .D3
.D2      ANOP
&SGCTRLC(21)  SETC  '&UNIT'
&SGCTRLC(22)  SETC  '&VOLNO'
    MNOTE *,'      FORTRAN LIBRARY LEVEL &DESIGN SPECIFIED'
.D3 MNOTE *,'      I/O UNIT TABLE WILL CONTAIN &UNTABLE LOGICAL UNITS'
   AIF  ('&DESIGN' NE 'E').D4
    MNOTE *,'      UNIT &OBJERR USED FOR ERROR MESSAGES AND DUMPS'
    AGO   .END
.D4   ANOP
    MNOTE *,'      UNIT &OBJERR USED FOR ''PRINT'' STATEMENTS,'
    MNOTE *,'          ERROR MESSAGES AND DUMPS'
    MNOTE *,'      UNIT &ONLNRD USED FOR ''READ'' STATEMENTS'
    MNOTE *,'      UNIT &ONLNPCH USED FOR ''PUNCH'' STATEMENTS'
    MNOTE *,'      OBJECT TIME ERROR HANDLING FACILITY IS &OPTERR'
 AIF (NOT &SGFORLB(5)).D4A     OPTERR=INCLUDE NOT SPECIFIED
 AIF (T'&ADDNTRY EQ 'O').D4A     ADDNTRY NOT SPECIFIED
 AIF (&A).D4A                   ADDNTRY IN ERROR
    MNOTE *,'      &ADDNTRY ADDITIONAL ERROR ENTRIES IN OPTION TABLE'
.D4A  ANOP
   AIF ('&BOUNDRY' EQ 'ALIGN').D5
    MNOTE *,'      BOUNDARY ALIGNMENT NOT REQUESTED'
 AGO .END
.D5 MNOTE *,'      BOUNDARY ALIGNMENT SPECIFIED'
.END  MEND

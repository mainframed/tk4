000100 IDENTIFICATION DIVISION.
000200     SKIP1
000300 PROGRAM-ID.    SOFTINVT.
000400     SKIP1
000500 AUTHOR.        FRANK G. BOLAN.
000600     SKIP1
000700 INSTALLATION.  SANTA FE INTERNATIONAL
000800                505 SOUTH MAIN STREET
000900                P.O. BOX 1401
001000                ORANGE, CALIFORNIA 92668
001100                (714) 558-1300.
001200     SKIP1
001300 REMARKS.      ***************************************************
001400               *      THIS PROGRAM READS A RECORD CREATED BY     *
001500               * INFORMATION/MANAGEMENT ONLINE MODULES.          *
001600               ***************************************************
001700     EJECT
001800 ENVIRONMENT DIVISION.
001900     SKIP1
002000 CONFIGURATION SECTION.
002100 SOURCE-COMPUTER.           IBM-370.
002200 OBJECT-COMPUTER.           IBM-370.
002300     SKIP1
002400 INPUT-OUTPUT SECTION.
002500     SKIP1
002600 FILE-CONTROL.
002700     SKIP1
002800     SELECT RECORD-INPT
002900        ASSIGN TO UT-S-CONFRI01.
003000     SELECT REPT-OUTPUT
003100        ASSIGN TO UT-S-CONFRO01.
003200     EJECT
003300 DATA DIVISION.
003400     SKIP1
003500 FILE SECTION.
003600 COPY SOFTREC.
003700     EJECT
003800 FD  REPT-OUTPUT
003900     RECORDING MODE IS F
004000     LABEL RECORDS ARE OMITTED
004100     RECORD CONTAINS 132 CHARACTERS
004200     REPORT IS INVENTORY-LOCATION-REPORT.
004300     EJECT
004400 WORKING-STORAGE SECTION.
004500     SKIP1
004600 01  CNT-COUNTERS.
004700     05  OPEN-COUNT               PIC  9(008) COMP VALUE 0.
004800     EJECT
004900 01  SWT-SWITCHES.
005000     05  SWT-END-OF-INPUT         PIC  X.
005100         88  END-OF-INPUT                VALUE 'T'.
005200 01  CON-CONSTANTS.
005300     05  CON-FALSE                PIC  X VALUE 'F'.
005400     05  CON-TRUE                 PIC  X VALUE 'T'.
005500     EJECT
005600 01  TDT-PROCESS-DATE.
005700     05  DATE-OF-RUN-YY           PIC 99.
005800     05  DATE-OF-RUN-MM           PIC 99.
005900     05  DATE-OF-RUN-DD           PIC 99.
006000 01  TDT-PROCESS-TIME.
006100     05  TIME-OF-RUN-HH           PIC 99.
006200     05  TIME-OF-RUN-MM           PIC 99.
006300     05  TIME-OF-RUN-SS           PIC 99.
006400     05  TIME-OF-RUN-TT           PIC 99.
006500 01  TDT-DATE-OF-RUN.
006600     05  DATE-OF-RUN-MM           PIC 99.
006700     05  FILLER                   PIC X(001) VALUE '/'.
006800     05  DATE-OF-RUN-DD           PIC 99.
006900     05  FILLER                   PIC X(001) VALUE '/'.
007000     05  DATE-OF-RUN-YY           PIC 99.
007100 01  TDT-TIME-OF-RUN.
007200     05  TIME-OF-RUN-HH           PIC 99.
007300     05  FILLER                   PIC X(001) VALUE ':'.
007400     05  TIME-OF-RUN-MM           PIC 99.
007500     05  FILLER                   PIC X(001) VALUE ':'.
007600     05  TIME-OF-RUN-SS           PIC 99.
007700     EJECT
007800 REPORT SECTION.
007900     SKIP1
008000 RD  INVENTORY-LOCATION-REPORT
008100     CONTROLS ARE COMPONENT-ID IN INPUT-RECORD
008200     PAGE LIMIT IS 59 LINES
008300     HEADING 1
008400     FIRST DETAIL 8
008500     LAST DETAIL 54
008600     FOOTING 56.
008700     EJECT
008800 01  PAGE-HEADING TYPE IS PAGE HEADING.
008900     02  LINE NUMBER IS 1.
009000         05  COLUMN 38            PIC X(044)
009100        VALUE 'INFORMATION SYSTEM CONFIGURATION MANAGEMENT'.
009200     02  LINE NUMBER IS 3.
009300         05  COLUMN NUMBER IS 2   PIC X(008)
009400             SOURCE IS TDT-DATE-OF-RUN.
009500         05  COLUMN 50            PIC X(035)
009600             VALUE 'SOFTWARE INVENTORY'.
009700         05  COLUMN NUMBER IS  98 PIC X(005)
009800             VALUE 'PAGE '.
009900         05  COLUMN NUMBER IS 104 PIC Z(004)9
010000             SOURCE IS PAGE-COUNTER.
010100         05  COLUMN NUMBER IS 123 PIC X(008)
010200             SOURCE IS TDT-TIME-OF-RUN.
010300     02  LINE NUMBER IS 5.
010400         05  COLUMN 1             PIC X(008) VALUE 'COMP-ID '.
010500         05  COLUMN 10            PIC X(012) VALUE 'ORDER NUMBER'.
010600         05  COLUMN 42            PIC X(011) VALUE 'DESCRIPTION'.
010700         05  COLUMN 69            PIC X(007) VALUE 'STATUS '.
010800         05  COLUMN 81            PIC X(011) VALUE 'DEPARTMENT '.
010900         05  COLUMN 93         PIC X(015) VALUE ' TECH. CONTACT '.
011000         05  COLUMN 109        PIC X(013) VALUE 'LICENSE BEGAN'.
011100     02  LINE NUMBER IS 7.
011200         05  COLUMN 1             PIC X(008) VALUE ALL '='.
011300         05  COLUMN 10            PIC X(012) VALUE ALL '='.
011400         05  COLUMN 23            PIC X(045) VALUE ALL '='.
011500         05  COLUMN 69            PIC X(011) VALUE ALL '='.
011600         05  COLUMN 81            PIC X(011) VALUE ALL '='.
011700         05  COLUMN 93            PIC X(015) VALUE ALL '='.
011800         05  COLUMN 109           PIC X(013) VALUE ALL '='.
011900     EJECT
012000 01  REPORT-LINE TYPE IS DETAIL LINE NUMBER PLUS 1.
012100     05  COLUMN 1                 PIC X(008)
012200         SOURCE IS COMPONENT-ID IN INPUT-RECORD.
012300     05  COLUMN 10                PIC X(007)
012400         SOURCE IS ORDER-NUMBER IN INPUT-RECORD.
012500     05  COLUMN 23                PIC X(045)
012600         SOURCE IS DESCRIPTION IN INPUT-RECORD.
012700     05  COLUMN 69                PIC X(011)
012800         SOURCE IS COMP-STATUS IN INPUT-RECORD.
012900     05  COLUMN 81                PIC X(011)
013000         SOURCE IS COMP-DEPARTMENT IN INPUT-RECORD.
013100     05  COLUMN 93                PIC X(015)
013200         SOURCE IS COMP-RESP-NAME IN INPUT-RECORD.
013300     05  COLUMN 111               PIC X(008)
013400         SOURCE IS LICENSE-BEGIN-DATE IN INPUT-RECORD.
013500     EJECT
013600 PROCEDURE DIVISION.
013700     SKIP2
013800 1010-MAINLINE.
013900     SKIP1
014000     PERFORM 2010-HOUSEKEEPING
014100        THRU 2010-EXIT.
014200     SKIP1
014300     PERFORM 3010-READ-RECORD
014400        UNTIL END-OF-INPUT.
014500     SKIP1
014600     PERFORM 4010-CLOSE-ALL-FILES
014700        THRU 4010-EXIT.
014800     GOBACK.
014900     SKIP2
015000 1010-EXIT.
015100     EJECT
015200 2010-HOUSEKEEPING.
015300     SKIP2
015400     ACCEPT TDT-PROCESS-DATE FROM DATE.
015500     ACCEPT TDT-PROCESS-TIME FROM TIME.
015600     MOVE CORRESPONDING TDT-PROCESS-DATE TO TDT-DATE-OF-RUN.
015700     MOVE CORRESPONDING TDT-PROCESS-TIME TO TDT-TIME-OF-RUN.
015800     MOVE CON-FALSE TO SWT-END-OF-INPUT.
015900     OPEN INPUT RECORD-INPT
016000          OUTPUT REPT-OUTPUT.
016100     INITIATE INVENTORY-LOCATION-REPORT.
016200     SKIP2
016300 2010-EXIT.
016400     EJECT
016500 3010-READ-RECORD.
016600     SKIP2
016700     READ RECORD-INPT
016800        AT END
016900           MOVE CON-TRUE TO SWT-END-OF-INPUT.
016910     IF NOT END-OF-INPUT
016920           THEN
017000               GENERATE REPORT-LINE.
017100     SKIP2
017200 3010-EXIT.
017300     EJECT
017400 4010-CLOSE-ALL-FILES.
017500     SKIP2
017600     TERMINATE INVENTORY-LOCATION-REPORT.
017700     CLOSE RECORD-INPT
017800           REPT-OUTPUT.
017900     SKIP2
018000 4010-EXIT.
018100     EJECT

    *********************************************************
    *              SOURCE.DATA(RUTS20)                      *
    *              WALTER MARZOUK           5-06-81         *
    *TO MERGE WEEKLY DATA WITH THE CUMULATIVE FILES         *
    ********************************************************;


  MACRO   COMONDT
    COMPDATE=TODAY() - 395;
    IF STARTDTE < COMPDATE    THEN DELETE;
   %
    DATA SMFNEW.SMFDATA;
    SET  SMFRCNT.SMFDATA  SMFDD.SMFDATA;
      BY STARTDTE SHIFT RUNHR CPUID  ACCOUNT  JOBNAME;
      DROP   COMPDATE;
       COMONDT

    PROC DELETE DATA=SMFDD._ALL_;
    PROC COPY     IN=SMFNEW
                 OUT=SMFDD;
  PROC CONTENTS DATA=SMFDD._ALL_  MAP POSITION;

    DATA RMFNEW.RMFDATA;
    SET  RMFRCNT.RMFDATA  RMFDD.RMFDATA;
      BY DATE SHIFT HOUR CPUID;
      DROP  COMPDATE STARTDTE;
    STARTDTE=DATE;  COMONDT

    PROC DELETE DATA=RMFDD._ALL_;
    PROC COPY     IN=RMFNEW
                 OUT=RMFDD;
   PROC CONTENTS DATA=RMFDD._ALL_  MAP POSITION;

    DATA SRMNEW.SRMDATA;
    SET  SRMRCNT.SRMDATA   SRMDD.SRMDATA;
      BY DATE SHIFT HOUR CPUID PG_NO DOMAINNO;
      DROP  COMPDATE STARTDTE;
    STARTDTE=DATE;  COMONDT

    PROC DELETE DATA=SRMDD._ALL_;
    PROC COPY     IN=SRMNEW
                 OUT=SRMDD;
   PROC CONTENTS DATA=SRMDD._ALL_  MAP POSITION;

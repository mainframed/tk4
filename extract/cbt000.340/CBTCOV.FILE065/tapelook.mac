 TAPLOOK: PROC OPTIONS(MAIN);  /* LOOK AT LABELS ON CONSOLE */
  DCL  FROG CHAR(32760) VARYING,
       BLOCK      FIXED DEC(15,0),
       CONS       CHAR(1) INIT('A'),
       TEXT       CHAR(56),
       FILE_IND   CHAR(1) INIT ('N'),
       TEXTL      CHAR(80),
       FILEA FILE INPUT RECORD SEQL;
 DCL 1 OUTAREA,
    3 FILLER1     CHAR(7) INIT('VOLUME='),
    3 VOLSER      CHAR(6),
    3 FILLER2     CHAR(5) INIT(',DSN='),
    3 DSNAME      CHAR(18),
    3 FILLER3     CHAR(15) INIT(',CREATION DATE='),
    3 CREDATE     CHAR(5);
 DCL TEXTOUT      CHAR(56) BASED(Q);
 DCL ADDR    BUILTIN;
 DCL SUBSTR  BUILTIN;
 DCL LENGTH BUILTIN;
 Q = ADDR(OUTAREA);
  ON ENDFILE(FILEA) FILE_IND = 'Y';
  TEXT = 'LABEL DISPLAY----ENTER U TO CONTINUE OR ANY CHAR TO STOP';
  DISPLAY (TEXT) REPLY (CONS);
  IF CONS ^= 'U'
  THEN GO TO ENDIT;
 LAB1: OPEN FILE(FILEA);
      READ FILE(FILEA) INTO (FROG);
      BLOCK = LENGTH(FROG);
      IF BLOCK ^= 80
      THEN DO;
        DISPLAY ('NON STANDARD LABELLED TAPE BLOCKSIZE IS ' ×× BLOCK);
        GO TO ENDIT;
           END;
      TEXTL = SUBSTR(FROG,1,80);
      VOLSER=SUBSTR(TEXTL,5,6);
      DO WHILE (FILE_IND = 'N');
         READ FILE(FILEA) INTO (FROG);
      TEXTL = SUBSTR(FROG,1,80);
      DSNAME=SUBSTR(TEXTL,5,18);
      CREDATE=SUBSTR(TEXTL,43,5);
      SIGNAL ENDFILE (FILEA);
      END;
      FILE_IND = 'N';
      CLOSE FILE(FILEA);
  DISPLAY (TEXTOUT);
 ENDIT: DISPLAY ('TAPE LABEL DISPLAY PROGRAM ENDED');
  END TAPLOOK;

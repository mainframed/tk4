000100 IDENTIFICATION DIVISION.
000200     SKIP1
000300 PROGRAM-ID.    DOCUMENT.
000400     SKIP1
000500 AUTHOR.        FRANK G. BOLAN.
000600     SKIP1
000700 INSTALLATION.  SANTA FE INTERNATIONAL
000800                505 SOUTH MAIN STREET
000900                P.O. BOX 1401
001000                ORANGE, CALIFORNIA 92668
001100                (714) 558-1300.
001200     SKIP1
001300 REMARKS.      ***************************************************
001400               *      THIS PROGRAM READS A 80 BYTE DATA SET AND  *
001500               * CREATES A REPORT. IT USES THE CHARACTER IN COL- *
001600               * UMN 72 (COLUMN 1 FOR DATA 132 BYTES LONG) OF THE*
001700               * INPUT DATA FOR CHARRIAGE CONTROL AND XEROX FONT *
001800               * CONTROL.                                        *
001900               *      VALID ENTRIES FOR COLUMN 72 ARE:           *
002000               *        E = PAGE NUMBER INCREASE AND EJECT       *
002100               *          = SKIP ONE LINE AFTER PRINT            *
002200               *        1 = SKIP ONE LINE AFTER PRINT            *
002300               *        2 = SKIP TWO LINES AFTER PRINT           *
002400               *        3 = SKIP THREE LINES AFTER PRINT         *
002500               *                                                 *
002600               *   **** D = DISTRIBUTION DATA                    *
002700               *        T = DOCUMENT TITLE                       *
002800               *        P = PART TITLE                           *
002900               *        C = CHAPTER TITLE                        *
003000               *        S = SECTION TITLE                        *
003100               *        U = SUB-SECTION TITLE                    *
003200               *                                                 *
003300               *   **** V = XEROX VERTICAL PRINT Titan-10p       *
003310               *        B = XEROX VERTICAL PRINT Titan10Bold-p   *
003320               *        F = XEROX VERTICAL PRINT Forms-10p       *
003400               *        H = XEROX HORIZONTAL PRINT               *
003500               *                                                 *
003600               *                                                 *
003700               * * PARM FIELD - IF THE PARM FIELD CONTAINS A 'Y' *
003800               *        (THE DEFAULT) THE PROGRAM WILL PROCESS   *
003900               *        THE INPUT AS 80 CHARACTERS LONG. IF THE  *
004000               *        PARM FIELD CONTAINS A 'N' THE PROGRAM    *
004100               *        WILL PROCESS THE DATA AS 133 CHARACTERS  *
004200               *        LONG.                                    *
004300               *                                                 *
004400               *        THE DOCUMENT TITLE, PART TITLE ,         *
004500               *        CHAPTER TITLE AND SECTION TITLE WILL     *
004600               *        GENERATE AN ENTRY IN THE TABLE OF CON-   *
004700               *        TENTS. THEY ARE ALSO SAVED AND PRINTED   *
004800               *        WHENEVER AN 'E' IS ENCOUNTERED. SUBSE-   *
004900               *        QUENT ENTRIES OVERLAY THE PREVIOUS.      *
005000               ***************************************************
005100     EJECT
005200 ENVIRONMENT DIVISION.
005300     SKIP1
005400 CONFIGURATION SECTION.
005500 SOURCE-COMPUTER.           IBM-370.
005600 OBJECT-COMPUTER.           IBM-370.
005700     SKIP1
005800 INPUT-OUTPUT SECTION.
005900     SKIP1
006000 FILE-CONTROL.
006100     SKIP1
006200     SELECT DATA-INPUT
006300        ASSIGN TO UT-S-SFICBI01.
006400     SELECT DATA-INPUT2
006500        ASSIGN TO UT-S-SFICBI02.
006600     SELECT REPT-OUTPUT0
006700        ASSIGN TO UT-S-SFICBO01.
006800     SELECT REPT-OUTPUT2
006900        ASSIGN TO UT-S-SFICBO02.
007000     SELECT REPT-OUTPUT3
007100        ASSIGN TO UT-S-SFICBO03.
007200     EJECT
007300 DATA DIVISION.
007400     SKIP1
007500 FILE SECTION.
007600 FD  DATA-INPUT
007700     RECORDING MODE IS F
007800     LABEL RECORDS ARE STANDARD
007900     RECORD CONTAINS 080 CHARACTERS
008000     BLOCK CONTAINS 0 RECORDS
008100     DATA RECORDS ARE INPUT-ACTIVITY-RECORDS.
008200     SKIP1
008300 01  INPUT-ACTIVITY-RECORDS.
008400     05  I-A-REC.
008500         10  INPUT-DATA           PIC X(071).
008600         10  CONTROL-CODE         PIC X(001).
008700             88 EJECT-PAGE                   VALUE 'E' 'e'.
008800             88 SKIP-ONE                     VALUE ' ' '1'.
008900             88 SKIP-TWO                     VALUE '2'.
009000             88 SKIP-THREE                   VALUE '3'.
009100             88 NOT-EIGHTY-BYTE              VALUE '4'.
009200             88 TITLE-CODE                   VALUE 'T' 't'.
009300             88 PART-CODE                    VALUE 'P' 'p'.
009400             88 CHAPTER-CODE                 VALUE 'C' 'c'.
009500             88 SECTION-CODE                 VALUE 'S' 's'.
009600             88 DOCUMENT-TITLE               VALUE 'D' 'd'.
009700             88 SUBSECTION-CODE              VALUE 'U' 'u'.
009800             88 XEROX-HORIZONTAL             VALUE 'H' 'h'.
009900             88 XEROX-VERTICAL               VALUE 'V' 'v'.
009910             88 XEROX-BOLD                   VALUE 'B' 'b'.
009920             88 XEROX-FORMS                  VALUE 'F' 'f'.
010000         10  INPUT-DATA-SEQ       PIC X(008).
010100 FD  DATA-INPUT2
010200     RECORDING MODE IS F
010300     LABEL RECORDS ARE STANDARD
010400     RECORD CONTAINS 132 CHARACTERS
010500     BLOCK CONTAINS 0 RECORDS
010600     DATA RECORDS ARE INPUT2-ACTIVITY-RECORDS2.
010700     SKIP1
010800 01  INPUT2-ACTIVITY-RECORDS.
010900         10  CONTROL-CODE         PIC X(001).
011000             88 EJECT-PAGE2                 VALUE 'E' 'e'.
011100             88 SKIP-ONE2                    VALUE ' ' '1'.
011200             88 SKIP-TWO2                    VALUE '2'.
011300             88 SKIP-THREE2                  VALUE '3'.
011400             88 NOT-EIGHTY-BYTE2             VALUE '4'.
011500             88 TITLE-CODE2                  VALUE 'T' 't'.
011600             88 PART-CODE2                   VALUE 'P' 'p'.
011700             88 CHAPTER-CODE2                VALUE 'C' 'c'.
011800             88 SECTION-CODE2                VALUE 'S' 's'.
011900             88 SUB-SECTION-CODE2            VALUE 'U' 'u'.
012000             88 DOCUMENT-TITLE2              VALUE 'D' 'd'.
012100             88 XEROX-HORIZONTAL2            VALUE 'H' 'h'.
012200             88 XEROX-VERTICAL2              VALUE 'V' 'v'.
012210             88 XEROX-BOLD2                  VALUE 'B' 'b'.
012220             88 XEROX-FORMS2                 VALUE 'F' 'f'.
012300         10  INPUT-DATA2.
012400             15 DES2   PIC X(071).
012500             15 FILLER PIC X(060).
012600 FD  REPT-OUTPUT0
012700     RECORDING MODE IS F
012800     LABEL RECORDS ARE STANDARD
012900     RECORD CONTAINS 133 CHARACTERS
013000     BLOCK CONTAINS 0 RECORDS
013100     DATA RECORDS ARE REPORT-RECORD-1.
013200     SKIP1
013300 01  REPORT-RECORD-1.
013400     05  PRINTCC                  PIC X(001).
013500     05  PRINTLINE                PIC X(132).
013600     EJECT
013700 FD  REPT-OUTPUT3
013800     RECORDING MODE IS F
013900     LABEL RECORDS ARE STANDARD
014000     RECORD CONTAINS 133 CHARACTERS
014100     BLOCK CONTAINS 0 RECORDS
014200     DATA RECORDS ARE REPORT-RECORD-3.
014300     SKIP1
014400 01  REPORT-RECORD-3.
014500     05  PRINTCC                  PIC X(001).
014600     05  PRINTLINE                PIC X(132).
014700     EJECT
014800 FD  REPT-OUTPUT2
014900     RECORDING MODE IS F
015000     LABEL RECORDS ARE STANDARD
015100     RECORD CONTAINS 133 CHARACTERS
015200     BLOCK CONTAINS 0 RECORDS
015300     DATA RECORDS ARE REPORT-RECORD-2.
015400     SKIP1
015500 01  REPORT-RECORD-2.
015600     05  PRINTCC-2                PIC X(001).
015700     05  PRINTLINE-2              PIC X(132).
015800     EJECT
015900 WORKING-STORAGE SECTION.
016000     SKIP1
016100 01  EJECT-LINE.
016200     05  FILLER                   PIC X(001) VALUE '1'.
016300     05  FILLER                   PIC X(132) VALUE SPACES.
016310 01  EJECT-LINE-80.
016320     05  FILLER                   PIC X(001) VALUE '1'.
016330     05  FILLER                   PIC X(079) VALUE SPACES.
016340     SKIP1
016400 01  DATA-LINE.
016500     05  FILLER                   PIC X(133) VALUE SPACES.
016600 01  DATA-LINE2.
016700     05  FILLER                   PIC X(133) VALUE SPACES.
017600 01  DETAIL-LINE.
017700     05  CC-CONTROL               PIC X(001).
017800     05  DETAIL-DATA              PIC X(071).
017900     05  FILLER                   PIC X(061) VALUE SPACES.
018000     SKIP1
018010 01  DETAIL-LINE2.
018020     05  CC-CONTROL2              PIC X(001).
018030     05  DETAIL-DATA2             PIC X(132).
018040     SKIP1
018050 01  HEADING-LINE.
018060     05  FILLER                   PIC X(001) VALUE '1'.
018070     05  HEAD-DATE                PIC X(008) VALUE SPACES.
018080     05  FILLER                   PIC X(001) VALUE ' '.
018090     05  HEADING-DETAIL           PIC X(055) VALUE SPACES.
018091     05  FILLER                   PIC X(001) VALUE ' '.
018092     05  FILLER                   PIC X(005) VALUE 'PAGE '.
018093     05  OUT-PAGE                 PIC Z,ZZ9.
018094     SKIP1
018100 01  HEADING-LINE2.
018200     05  FILLER                   PIC X(001) VALUE '1'.
018300     05  HEAD-DATE2               PIC X(008) VALUE SPACES.
018400     05  FILLER                   PIC X(001) VALUE ' '.
018500     05  HEADING-DETAIL2          PIC X(102) VALUE SPACES.
018600     05  FILLER                   PIC X(001) VALUE ' '.
018700     05  HEAD-TIME2               PIC X(008).
018800     05  FILLER                   PIC X(001) VALUE ' '.
018900     05  FILLER                   PIC X(005) VALUE 'PAGE '.
019000     05  OUT-PAGE2                PIC Z,ZZ9.
019100     SKIP1
019200 01  XEROX-LINE.
019300     05  FILLER                   PIC X(001) VALUE ' '.
019400     05  XEROX-DATA               PIC X(080).
019500     05  FILLER                   PIC X(052) VALUE ' '.
019600     SKIP1
019700 01  XEROX-DATA1.
019800     05  FILLER                   PIC X(006) VALUE '=UDK=~'.
019900     05  FILLER                   PIC X(074) VALUE ' '.
020200 01  XEROX-DATA2.
020300     05  FILLER                   PIC X(006) VALUE '~+P   '.
020400     05  FILLER                   PIC X(074) VALUE ' '.
020700     SKIP1
020800 01  XEROX-DATA3.
020900     05  FILLER                  PIC X(012) VALUE '~+1Titan10-P'.
021000     05  FILLER                  PIC X(068) VALUE ' '.
021300 01  XEROX-DATA4.
021400     05  FILLER                   PIC X(006) VALUE '~1    '.
021500     05  FILLER                   PIC X(074) VALUE ' '.
021800     SKIP1
021900 01  XEROX-DATA5.
022000     05  FILLER                   PIC X(006) VALUE '~+X   '.
022100     05  FILLER                   PIC X(074) VALUE ' '.
022400 01  XEROX-DATA6.
022500     05  FILLER                   PIC X(006) VALUE '~0    '.
022600     05  FILLER                   PIC X(074) VALUE ' '.
022900 01  XEROX-DATA7.
023000     05  FILLER                   PIC X(006) VALUE '#+X   '.
023100     05  FILLER                   PIC X(074) VALUE ' '.
023200 01  XEROX-DATA8.
023300     05  FILLER             PIC X(016) VALUE '~+2Titan10B-P   '.
023310     05  FILLER                  PIC X(064) VALUE ' '.
023320 01  XEROX-DATA9.
023330     05  FILLER                  PIC X(012) VALUE '~+3Forms10-P'.
023340     05  FILLER                  PIC X(068) VALUE ' '.
023350 01  XEROX-DATAB.
023360     05  FILLER                   PIC X(006) VALUE '~2    '.
023370     05  FILLER                   PIC X(074) VALUE ' '.
023380     SKIP1
023390 01  XEROX-DATAF.
023391     05  FILLER                   PIC X(006) VALUE '~3    '.
023392     05  FILLER                   PIC X(074) VALUE ' '.
023393     SKIP1
023400 01  T-OF-C-LINE212.
023500     05  FILLER                   PIC X(001) VALUE '0'.
023600     05  FILLER                   PIC X(054) VALUE SPACES.
023700     05  FILLER                   PIC X(011) VALUE 'TABLE OF CO'.
023800     05  FILLER                   PIC X(006) VALUE 'NTENTS'.
023900     05  FILLER                   PIC X(035) VALUE SPACES.
024000 01  T-OF-C-LINE22.
024100     05  FILLER                   PIC X(001) VALUE '0'.
024200     05  FILLER                   PIC X(057) VALUE SPACES.
024300     05  FILLER                   PIC X(011) VALUE 'DESCRIPTION'.
024400     05  FILLER                   PIC X(059) VALUE SPACES.
024500     05  FILLER                   PIC X(004) VALUE 'PAGE'.
024600 01  T-OF-C-LINE23.
024700     05  FILLER                   PIC X(001) VALUE SPACES.
024800     05  FILLER                   PIC X(132) VALUE ALL '_'.
024900     SKIP1
025000 01  T-OF-C-LINE24.
025100     05  FILLER                   PIC X(132) VALUE SPACES.
026700 01  T-OF-C-LINE1.
026800     05  FILLER                   PIC X(001) VALUE '0'.
026900     05  FILLER                   PIC X(027) VALUE SPACES.
027000     05  FILLER                   PIC X(011) VALUE 'TABLE OF CO'.
027100     05  FILLER                   PIC X(006) VALUE 'NTENTS'.
027200     05  FILLER                   PIC X(031) VALUE SPACES.
027300 01  T-OF-C-LINE2.
027400     05  FILLER                   PIC X(001) VALUE '0'.
027500     05  FILLER                   PIC X(030) VALUE SPACES.
027600     05  FILLER                   PIC X(011) VALUE 'DESCRIPTION'.
027700     05  FILLER                   PIC X(030) VALUE SPACES.
027800     05  FILLER                   PIC X(004) VALUE 'PAGE'.
027900 01  T-OF-C-LINE3.
028000     05  FILLER                   PIC X(001) VALUE SPACES.
028100     05  FILLER                   PIC X(075) VALUE ALL '_'.
028200     SKIP1
028300 01  T-OF-C-LINE4.
028400     05  FILLER                   PIC X(001) VALUE SPACES.
028500     05  FILLER                   PIC X(070) VALUE ' '.
028600     05  FILLER                   PIC X(001) VALUE SPACES.
028700 01  T-OF-C-DETAIL-LINE.
028800     05  CC-FOR-TOFC              PIC X(001) VALUE ' '.
028900     05  T-OF-C-DETAIL            PIC X(066) VALUE ' '.
029000     05  FILLER                   PIC X(001) VALUE SPACES.
029100     05  T-OF-C-PAGE              PIC Z,ZZ9.
029110 01  T-OF-C-DETAIL2-LINE2.
029120     05  CC-FOR-TOFC2             PIC X(001) VALUE ' '.
029130     05  T-OF-C-DETAIL2           PIC X(125) VALUE ' '.
029140     05  FILLER                   PIC X(001) VALUE SPACES.
029150     05  T-OF-C-PAGE2             PIC Z,ZZ9.
029200     EJECT
029300 01  PARM-DATA-LENGTH             PIC S9(004) COMP.
029400 01  CNT-COUNTERS.
029500     05  DET-LINE-COUNT2          PIC S9(004) VALUE ZERO.
029600     05  TBL-LINE-COUNT2          PIC S9(004) VALUE ZERO.
029700     05  TBL-PAGE-COUNT2          PIC S9(004) VALUE ZERO.
029800     05  DET-PAGE-COUNT2          PIC S9(004) VALUE ZERO.
029900     05  DET-LINE-COUNT           PIC S9(004) VALUE ZERO.
030000     05  TBL-LINE-COUNT           PIC S9(004) VALUE ZERO.
030100     05  TBL-PAGE-COUNT           PIC S9(004) VALUE ZERO.
030200     05  DET-PAGE-COUNT           PIC S9(004) VALUE ZERO.
030300 01  STA-STORAGE-AREAS.
030400     05  LRECL-TYPE               PIC X(001) VALUE SPACES.
030500     05  DETAIL-STORAGE2          PIC X(127) VALUE SPACES.
030600     05  TITLE-STORAGE2           PIC X(102) VALUE SPACES.
030700     05  PART-STORAGE2            PIC X(127) VALUE SPACES.
030800     05  CHAPTER-STORAGE2         PIC X(127) VALUE SPACES.
030900     05  SECTION-STORAGE2         PIC X(127) VALUE SPACES.
031000     05  SUB-SECTION-STORAGE2     PIC X(127) VALUE SPACES.
031100     05  DETAIL-STORAGE           PIC X(071) VALUE SPACES.
031200     05  TITLE-STORAGE            PIC X(071) VALUE SPACES.
031300     05  PART-STORAGE             PIC X(071) VALUE SPACES.
031400     05  CHAPTER-STORAGE          PIC X(071) VALUE SPACES.
031500     05  SECTION-STORAGE          PIC X(071) VALUE SPACES.
031600     05  SUBSECTION-STORAGE       PIC X(071) VALUE SPACES.
031700 01  CON-CONSTANTS.
031800     05  CON-TRUE                 PIC X(001)  VALUE 'T'.
031900     05  CON-FALSE                PIC X(001)  VALUE 'F'.
032000     05  CON-EJECT                PIC X(001)  VALUE '1'.
032100     05  CON-SKIP1                PIC X(001)  VALUE ' '.
032200     05  CON-SKIP2                PIC X(001)  VALUE '0'.
032300     05  CON-SKIP3                PIC X(001)  VALUE '-'.
032400     05  PLUS-1                   PIC S99     VALUE +1.
032500     05  PLUS-2                   PIC S99     VALUE +2.
032600     05  PLUS-3                   PIC S99     VALUE +3.
032700     05  DET-PAGE-LIMIT           PIC S99     VALUE +52.
032800     05  TBL-PAGE-LIMIT           PIC S99     VALUE +52.
032900     SKIP2
033000 01  SWT-SWITCHES.
033100     05  SWT-END-OF-INPUT         PIC X(001).
033200         88  END-OF-INPUT                     VALUE 'T'.
033300     05  SWT-TITLE-STORED         PIC X(001).
033400         88  TITLE-STORED                     VALUE 'T'.
033500     05  SWT-DISTRIBUTION         PIC X(001).
033600         88  DISTRIBUTION                     VALUE 'T'.
033700     05  SWT-DOCUMENT             PIC X(001).
033800         88  DOCUMENT                         VALUE 'T'.
033900     05  SWT-PART-STORED          PIC X(001).
034000         88  PART-STORED                      VALUE 'T'.
034100     05  SWT-CHAPTER-STORED       PIC X(001).
034200         88  CHAPTER-STORED                   VALUE 'T'.
034300     05  SWT-SECTION-STORED       PIC X(001).
034400         88  SECTION-STORED                   VALUE 'T'.
034500     05  SWT-SUB-SECTION-STORED    PIC X(001).
034600         88  SUB-SECTION-STORED                VALUE 'T'.
034700     05  SWT-PART1-STORED          PIC X(001).
034800         88  PART1-STORED                      VALUE 'T'.
034900     05  SWT-CHAPTER1-STORED       PIC X(001).
035000         88  CHAPTER1-STORED                   VALUE 'T'.
035100     05  SWT-SECTION1-STORED       PIC X(001).
035200         88  SECTION1-STORED                   VALUE 'T'.
035300     05  SWT-SUBSECTION1-STORED    PIC X(001).
035400         88  SUBSECTION1-STORED                VALUE 'T'.
035500     05  SWT-TTITLE-STORED         PIC X(001).
035600         88  TTITLE-STORED                     VALUE 'T'.
035700     05  SWT-TPART-STORED          PIC X(001).
035800         88  TPART-STORED                      VALUE 'T'.
035900     05  SWT-TCHAPTER-STORED       PIC X(001).
036000         88  TCHAPTER-STORED                   VALUE 'T'.
036100     05  SWT-TSECTION-STORED       PIC X(001).
036200         88  TSECTION-STORED                   VALUE 'T'.
036300     05  SWT-TSUB-SECTION-STORED    PIC X(001).
036400         88  TSUB-SECTION-STORED                VALUE 'T'.
036500     05  SWT-TPART1-STORED          PIC X(001).
036600         88  TPART1-STORED                      VALUE 'T'.
036700     05  SWT-TCHAPTER1-STORED       PIC X(001).
036800         88  TCHAPTER1-STORED                   VALUE 'T'.
036900     05  SWT-TSECTION1-STORED       PIC X(001).
037000         88  TSECTION1-STORED                   VALUE 'T'.
037100     05  SWT-TSUBSECTION1-STORED    PIC X(001).
037200         88  TSUBSECTION1-STORED                VALUE 'T'.
037300     05  SWT-EIGHTY-BYTE-RECORD    PIC X(001).
037400         88  EIGHTY-BYTE-RECORD                VALUE 'T'.
037500     05  SWT-XEROX-USED            PIC X(001).
037600         88  XEROX-USED                        VALUE 'T'.
037700     05  SWT-XEROX-FOR-CONTENTS    PIC X(001).
037800         88  XEROX-FOR-CONTENTS                VALUE 'T'.
037900     SKIP2
038000 01  TDT-PROCESS-DATE.
038100     05  DATE-OF-RUN-YY           PIC 99.
038200     05  DATE-OF-RUN-MM           PIC 99.
038300     05  DATE-OF-RUN-DD           PIC 99.
038400 01  TDT-PROCESS-TIME.
038500     05  TIME-OF-RUN-HH           PIC 99.
038600     05  TIME-OF-RUN-MM           PIC 99.
038700     05  TIME-OF-RUN-SS           PIC 99.
038800     05  TIME-OF-RUN-TT           PIC 99.
038900 01  TDT-DATE-OF-RUN.
039000     05  DATE-OF-RUN-MM           PIC 99.
039100     05  FILLER                   PIC X(001) VALUE '/'.
039200     05  DATE-OF-RUN-DD           PIC 99.
039300     05  FILLER                   PIC X(001) VALUE '/'.
039400     05  DATE-OF-RUN-YY           PIC 99.
039500 01  TDT-TIME-OF-RUN.
039600     05  TIME-OF-RUN-HH           PIC 99.
039700     05  FILLER                   PIC X(001) VALUE ':'.
039800     05  TIME-OF-RUN-MM           PIC 99.
039900     05  FILLER                   PIC X(001) VALUE ':'.
040000     05  TIME-OF-RUN-SS           PIC 99.
040100     EJECT
040200 LINKAGE SECTION.
040300 01  PARM.
040400     05  PARM-LENGTH             PIC S9(04) COMP.
040500     05  PARM-DATA.
040600         10  PARM-DATA-VARIABLE
040700             OCCURS 1 TO 100 TIMES
040800             DEPENDING ON PARM-DATA-LENGTH PIC X(01).
040900 PROCEDURE DIVISION USING PARM.
041000     SKIP2
041100 1010-MAINLINE.
041200     SKIP1
041300     MOVE CON-FALSE TO SWT-EIGHTY-BYTE-RECORD.
041400     SKIP1
041500     IF PARM-LENGTH GREATER THAN 1
041600        THEN MOVE 1 TO PARM-DATA-LENGTH
041700     ELSE
041800        MOVE PARM-LENGTH TO PARM-DATA-LENGTH.
041900     SKIP1
042000     IF PARM-DATA-LENGTH EQUAL ZERO
042100        THEN MOVE CON-TRUE TO SWT-EIGHTY-BYTE-RECORD
042200     ELSE
042300        MOVE PARM-DATA TO LRECL-TYPE
042400        MOVE CON-FALSE TO SWT-EIGHTY-BYTE-RECORD.
042500     SKIP1
042600     IF LRECL-TYPE NOT EQUAL 'N'
042700        THEN MOVE CON-TRUE TO SWT-EIGHTY-BYTE-RECORD.
042800     PERFORM 2010-HOUSEKEEPING
042900        THRU 2010-EXIT.
043000     SKIP1
043100     IF EIGHTY-BYTE-RECORD
043200     THEN
043300        PERFORM 3010-READ-RECORD
043400          UNTIL END-OF-INPUT
043500     ELSE
043600        PERFORM 3014-READ-RECORD
043700          UNTIL END-OF-INPUT.
043800     SKIP1
043900     MOVE SPACES TO DATA-LINE
044000                    DATA-LINE2.
044100     MOVE EJECT-LINE-80 TO DATA-LINE.
044200     MOVE EJECT-LINE-80 TO DATA-LINE2.
044300     PERFORM 3020-WRITE-REPORT-RECORD-3 THRU 3020-EXIT.
044400     MOVE XEROX-DATA5 TO XEROX-DATA
044500     MOVE XEROX-LINE TO DATA-LINE
044600     MOVE XEROX-LINE TO DATA-LINE2
044700     PERFORM 3020-WRITE-REPORT-RECORD-3 THRU 3020-EXIT.
044800     PERFORM 4010-CLOSE-ALL-FILES
044900        THRU 4010-EXIT.
045000     GOBACK.
045100     SKIP2
045200 1010-EXIT.
045300     EJECT
045400 2010-HOUSEKEEPING.
045500     SKIP2
045600     ACCEPT TDT-PROCESS-DATE FROM DATE.
045700     ACCEPT TDT-PROCESS-TIME FROM TIME.
045800     MOVE CORRESPONDING TDT-PROCESS-DATE TO TDT-DATE-OF-RUN.
045900     MOVE CORRESPONDING TDT-PROCESS-TIME TO TDT-TIME-OF-RUN.
046000*    MOVE TDT-DATE-OF-RUN TO HEAD-DATE.
046100*    MOVE TDT-DATE-OF-RUN TO HEAD-DATE2.
046200*    MOVE TDT-TIME-OF-RUN TO HEAD-TIME2.
046300     MOVE CON-FALSE TO SWT-DOCUMENT.
046400     MOVE CON-FALSE TO SWT-XEROX-USED.
046500     MOVE CON-FALSE TO SWT-XEROX-FOR-CONTENTS.
046600     MOVE CON-FALSE TO SWT-END-OF-INPUT.
046700     MOVE CON-FALSE TO SWT-TITLE-STORED.
046800     MOVE CON-FALSE TO SWT-PART-STORED.
046900     MOVE CON-FALSE TO SWT-CHAPTER-STORED.
047000     MOVE CON-FALSE TO SWT-SECTION-STORED.
047100     MOVE CON-FALSE TO SWT-SUB-SECTION-STORED.
047200     MOVE CON-TRUE TO SWT-DISTRIBUTION.
047300     MOVE ZERO TO DET-LINE-COUNT.
047400     MOVE ZERO TO TBL-LINE-COUNT.
047500     MOVE ZERO TO DET-LINE-COUNT2.
047600     MOVE ZERO TO TBL-LINE-COUNT2.
047700     MOVE TBL-PAGE-LIMIT TO TBL-LINE-COUNT.
047800     MOVE TBL-PAGE-LIMIT TO TBL-LINE-COUNT2.
047900     MOVE ZERO TO DET-PAGE-COUNT.
048000     MOVE ZERO TO DET-PAGE-COUNT2.
048100     OPEN INPUT DATA-INPUT
048200          INPUT DATA-INPUT2
048300          OUTPUT REPT-OUTPUT0
048400          OUTPUT REPT-OUTPUT3
048500          OUTPUT REPT-OUTPUT2.
048600     SKIP2
048700 2010-EXIT.
048800     EJECT
048900 3010-READ-RECORD.
049000     SKIP2
049100     READ DATA-INPUT
049200        AT END
049300           MOVE SPACES TO REPORT-RECORD-1
049400           MOVE SPACES TO REPORT-RECORD-2
049500           MOVE SPACES TO REPORT-RECORD-3
049600           MOVE SPACES TO DATA-LINE
049700           MOVE SPACES TO DATA-LINE2
049800           MOVE LOW-VALUES TO I-A-REC
049900           MOVE CON-TRUE TO SWT-END-OF-INPUT.
050000     ON 1 MOVE EJECT-LINE TO DATA-LINE.
050100     ON 1 MOVE EJECT-LINE TO DATA-LINE2.
050200     ON 1 PERFORM 3018-WRITE-REPORT-RECORD-1 THRU 3018-EXIT.
050300     IF XEROX-VERTICAL
050400        THEN
050500        IF DISTRIBUTION
050600          THEN
050700        MOVE CON-TRUE TO SWT-XEROX-USED
050800        MOVE CON-TRUE TO SWT-XEROX-FOR-CONTENTS
050900        MOVE XEROX-DATA6 TO XEROX-DATA
051000        MOVE XEROX-LINE TO DATA-LINE
051100        MOVE XEROX-LINE TO DATA-LINE2
051200        PERFORM 3018-WRITE-REPORT-RECORD-1 THRU 3018-EXIT
051300        MOVE XEROX-DATA1 TO XEROX-DATA
051400        MOVE XEROX-LINE TO DATA-LINE
051500        MOVE XEROX-LINE TO DATA-LINE2
051600        PERFORM 3018-WRITE-REPORT-RECORD-1 THRU 3018-EXIT
051700        MOVE XEROX-DATA2 TO XEROX-DATA
051800        MOVE XEROX-LINE TO DATA-LINE
051900        MOVE XEROX-LINE TO DATA-LINE2
052000        PERFORM 3018-WRITE-REPORT-RECORD-1 THRU 3018-EXIT
052100        MOVE XEROX-DATA3 TO XEROX-DATA
052200        MOVE XEROX-LINE TO DATA-LINE
052300        MOVE XEROX-LINE TO DATA-LINE2
052400        PERFORM 3018-WRITE-REPORT-RECORD-1 THRU 3018-EXIT
052410        MOVE XEROX-DATA8 TO XEROX-DATA
052420        MOVE XEROX-LINE TO DATA-LINE
052430        MOVE XEROX-LINE TO DATA-LINE2
052440        PERFORM 3018-WRITE-REPORT-RECORD-1 THRU 3018-EXIT
052450        MOVE XEROX-DATA9 TO XEROX-DATA
052460        MOVE XEROX-LINE TO DATA-LINE
052470        MOVE XEROX-LINE TO DATA-LINE2
052480        PERFORM 3018-WRITE-REPORT-RECORD-1 THRU 3018-EXIT
052500        MOVE XEROX-DATA4 TO XEROX-DATA
052600        MOVE XEROX-LINE TO DATA-LINE
052700        MOVE XEROX-LINE TO DATA-LINE2
052800        PERFORM 3018-WRITE-REPORT-RECORD-1 THRU 3018-EXIT
052900        MOVE EJECT-LINE-80 TO DATA-LINE
053000        MOVE EJECT-LINE-80 TO DATA-LINE2
053100        PERFORM 3018-WRITE-REPORT-RECORD-1 THRU 3018-EXIT.
053200     IF XEROX-HORIZONTAL
053300        THEN
053400        IF DISTRIBUTION
053500          THEN
053600        MOVE CON-TRUE TO SWT-XEROX-USED
053700        MOVE CON-FALSE TO SWT-XEROX-FOR-CONTENTS
053900        MOVE XEROX-DATA7 TO XEROX-DATA
054000        MOVE XEROX-LINE TO DATA-LINE
054100        MOVE XEROX-LINE TO DATA-LINE2
054200        PERFORM 3018-WRITE-REPORT-RECORD-1 THRU 3018-EXIT
054300        MOVE XEROX-DATA3 TO XEROX-DATA
054400        MOVE XEROX-LINE TO DATA-LINE
054500        MOVE XEROX-LINE TO DATA-LINE2
054600        PERFORM 3018-WRITE-REPORT-RECORD-1 THRU 3018-EXIT
054610        MOVE XEROX-DATA8 TO XEROX-DATA
054620        MOVE XEROX-LINE TO DATA-LINE
054630        MOVE XEROX-LINE TO DATA-LINE2
054640        PERFORM 3018-WRITE-REPORT-RECORD-1 THRU 3018-EXIT
054650        MOVE XEROX-DATA9 TO XEROX-DATA
054660        MOVE XEROX-LINE TO DATA-LINE
054670        MOVE XEROX-LINE TO DATA-LINE2
054680        PERFORM 3018-WRITE-REPORT-RECORD-1 THRU 3018-EXIT
054700        MOVE XEROX-DATA6 TO XEROX-DATA
054800        MOVE XEROX-LINE TO DATA-LINE
054900        MOVE XEROX-LINE TO DATA-LINE2
055000        PERFORM 3018-WRITE-REPORT-RECORD-1 THRU 3018-EXIT
055100        MOVE EJECT-LINE-80 TO DATA-LINE
055200        MOVE EJECT-LINE-80 TO DATA-LINE2
055300        PERFORM 3018-WRITE-REPORT-RECORD-1 THRU 3018-EXIT.
055400     IF XEROX-VERTICAL
055500        THEN
055600        IF DOCUMENT
055700          THEN
055800        MOVE CON-TRUE TO SWT-XEROX-USED
055900        MOVE XEROX-DATA4 TO XEROX-DATA
056000        MOVE XEROX-LINE TO DATA-LINE
056100        MOVE XEROX-LINE TO DATA-LINE2
056200        PERFORM 3020-WRITE-REPORT-RECORD-3 THRU 3020-EXIT.
056300     IF XEROX-HORIZONTAL
056400        THEN
056500        IF DOCUMENT
056600          THEN
056800        MOVE XEROX-DATA6 TO XEROX-DATA
056810        MOVE CON-FALSE TO SWT-XEROX-USED
056900        MOVE XEROX-LINE TO DATA-LINE
057000        MOVE XEROX-LINE TO DATA-LINE2
057100        PERFORM 3020-WRITE-REPORT-RECORD-3 THRU 3020-EXIT.
057200     IF DOCUMENT-TITLE
057300        THEN
057400        MOVE CON-TRUE    TO SWT-DISTRIBUTION
057500        MOVE CON-FALSE   TO SWT-DOCUMENT
057600        MOVE INPUT-DATA  TO DETAIL-DATA
057700        MOVE INPUT-DATA  TO DETAIL-DATA2
057800        MOVE CON-SKIP1   TO  CC-CONTROL
057900        MOVE CON-SKIP1   TO  CC-CONTROL2
058000        MOVE DETAIL-LINE TO DATA-LINE
058100        MOVE DETAIL-LINE TO DATA-LINE2
058200        PERFORM 3018-WRITE-REPORT-RECORD-1 THRU 3018-EXIT.
058300     IF TITLE-CODE
058400        THEN
058500         MOVE CON-FALSE     TO SWT-DISTRIBUTION
058600         MOVE CON-TRUE      TO SWT-DOCUMENT
058700         MOVE INPUT-DATA TO TITLE-STORAGE.
058800     IF TITLE-CODE
058900        AND
059000          INPUT-DATA NOT EQUAL SPACES
059100           THEN
059200             MOVE CON-FALSE TO SWT-PART-STORED
059300             MOVE CON-FALSE TO SWT-CHAPTER-STORED
059400             MOVE CON-FALSE TO SWT-SECTION-STORED
059500             MOVE CON-FALSE TO SWT-SUB-SECTION-STORED
059600             MOVE CON-TRUE TO SWT-TITLE-STORED.
059700     IF PART-CODE
059800        THEN
059900        MOVE CON-FALSE TO SWT-DISTRIBUTION
060000        MOVE CON-TRUE   TO SWT-DOCUMENT
060700        MOVE INPUT-DATA TO PART-STORAGE.
061100     IF PART-CODE
061200        AND
061300          INPUT-DATA NOT EQUAL SPACES
061400           THEN
061410             MOVE CON-FALSE TO SWT-CHAPTER-STORED
061420             MOVE CON-FALSE TO SWT-SECTION-STORED
061430             MOVE CON-FALSE TO SWT-SUB-SECTION-STORED
061500             MOVE CON-TRUE TO SWT-PART1-STORED
061600             MOVE CON-TRUE TO SWT-PART-STORED.
061700     IF CHAPTER-CODE
061800        THEN
061900        MOVE CON-FALSE TO SWT-DISTRIBUTION
062000        MOVE CON-TRUE   TO SWT-DOCUMENT
062700        MOVE INPUT-DATA TO CHAPTER-STORAGE.
062800     IF CHAPTER-CODE
062900        AND
063000          INPUT-DATA NOT EQUAL SPACES
063100           THEN
063110             MOVE CON-FALSE TO SWT-SECTION-STORED
063120             MOVE CON-FALSE TO SWT-SUB-SECTION-STORED
063200             MOVE CON-TRUE TO SWT-CHAPTER1-STORED
063300             MOVE CON-TRUE TO SWT-CHAPTER-STORED.
063400     IF SECTION-CODE
063500        THEN
063600        MOVE CON-FALSE TO SWT-DISTRIBUTION
063700        MOVE CON-TRUE   TO SWT-DOCUMENT
064100        MOVE INPUT-DATA TO SECTION-STORAGE.
064200     IF SECTION-CODE
064300        AND
064400          INPUT-DATA NOT EQUAL SPACES
064500           THEN
064510            MOVE CON-FALSE TO SWT-SUB-SECTION-STORED
064600            MOVE CON-TRUE TO SWT-SECTION-STORED
064700            MOVE CON-TRUE TO SWT-SECTION1-STORED.
064800     IF SUBSECTION-CODE
064900        THEN
065000        MOVE CON-FALSE TO SWT-DISTRIBUTION
065100        MOVE CON-TRUE   TO SWT-DOCUMENT
065200        MOVE INPUT-DATA TO SUBSECTION-STORAGE.
065300     IF SUBSECTION-CODE
065400        AND
065500          INPUT-DATA NOT EQUAL SPACES
065600           THEN
065700            MOVE CON-TRUE TO SWT-SUBSECTION1-STORED
065800            MOVE CON-TRUE TO SWT-SUB-SECTION-STORED.
065900     IF EJECT-PAGE
066000        THEN
066100        MOVE CON-FALSE TO SWT-DISTRIBUTION
066200        MOVE CON-TRUE   TO SWT-DOCUMENT
066300        PERFORM 3012-PRINT-HEADING
066400           THRU 3012-EXIT.
066500     IF SKIP-ONE
066600        THEN
066700        MOVE CON-FALSE TO SWT-DISTRIBUTION
066800        MOVE CON-TRUE   TO SWT-DOCUMENT
066900        MOVE INPUT-DATA TO DETAIL-DATA
067000        MOVE CON-SKIP1 TO  CC-CONTROL
067100        PERFORM 3011-PRINT-DETAIL-LINE
067200           THRU 3011-EXIT
067300        ADD PLUS-1 TO DET-LINE-COUNT.
067400     IF SKIP-TWO
067500        THEN
067600        MOVE CON-FALSE TO SWT-DISTRIBUTION
067700        MOVE CON-TRUE   TO SWT-DOCUMENT
067800        MOVE INPUT-DATA TO DETAIL-DATA
067900        MOVE CON-SKIP2 TO  CC-CONTROL
068000        PERFORM 3011-PRINT-DETAIL-LINE
068100           THRU 3011-EXIT
068200        ADD PLUS-2 TO DET-LINE-COUNT.
068300     IF SKIP-THREE
068400        THEN
068500        MOVE CON-FALSE TO SWT-DISTRIBUTION
068600        MOVE CON-TRUE   TO SWT-DOCUMENT
068700        MOVE INPUT-DATA TO DETAIL-DATA
068800        MOVE CON-SKIP3 TO  CC-CONTROL
068900        PERFORM 3011-PRINT-DETAIL-LINE
069000           THRU 3011-EXIT
069100        ADD PLUS-3 TO DET-LINE-COUNT.
069200     SKIP2
069300 3010-EXIT.
069400     EJECT
069500 3011-PRINT-DETAIL-LINE.
069600     SKIP2
069700     IF DET-LINE-COUNT GREATER THAN DET-PAGE-LIMIT
069800        OR DET-LINE-COUNT EQUAL DET-PAGE-LIMIT
069900        THEN
070000        MOVE DETAIL-DATA TO DETAIL-STORAGE
070100        PERFORM 3012-PRINT-HEADING
070200        MOVE DETAIL-STORAGE TO DETAIL-DATA
070300        MOVE CON-SKIP1 TO  CC-CONTROL.
070400     MOVE DETAIL-LINE TO DATA-LINE
070500     MOVE DETAIL-LINE TO DATA-LINE2
070600     PERFORM 3020-WRITE-REPORT-RECORD-3 THRU 3020-EXIT.
070700 3011-EXIT.
070800     EJECT
070900 3012-PRINT-HEADING.
071000     SKIP2
071100     MOVE ZERO TO DET-LINE-COUNT.
071200     ADD PLUS-1 TO DET-PAGE-COUNT.
071300     MOVE TITLE-STORAGE TO HEADING-DETAIL.
071400     MOVE DET-PAGE-COUNT TO OUT-PAGE.
071500     MOVE HEADING-LINE TO DATA-LINE
071600     MOVE HEADING-LINE TO DATA-LINE2
071700     PERFORM 3020-WRITE-REPORT-RECORD-3 THRU 3020-EXIT.
071800     IF PART1-STORED
071900      THEN
072000       MOVE PART-STORAGE TO DETAIL-DATA
072100       MOVE CON-SKIP2 TO  CC-CONTROL
072200       ADD PLUS-2 TO DET-LINE-COUNT
072300       PERFORM 3011-PRINT-DETAIL-LINE
072400        THRU 3011-EXIT.
072500     IF CHAPTER1-STORED
072600      THEN
072700       MOVE CHAPTER-STORAGE TO DETAIL-DATA
072800       MOVE CON-SKIP2 TO  CC-CONTROL
072900       ADD PLUS-2 TO DET-LINE-COUNT
073000       PERFORM 3011-PRINT-DETAIL-LINE
073100        THRU 3011-EXIT.
073200     IF SECTION1-STORED
073300      THEN
073400       MOVE SECTION-STORAGE TO DETAIL-DATA
073500       MOVE CON-SKIP2 TO  CC-CONTROL
073600       ADD PLUS-2 TO DET-LINE-COUNT
073700       PERFORM 3011-PRINT-DETAIL-LINE
073800        THRU 3011-EXIT.
073900     IF SUBSECTION1-STORED
074000      THEN
074100       MOVE SUBSECTION-STORAGE TO DETAIL-DATA
074200       ADD PLUS-2 TO DET-LINE-COUNT
074300       MOVE CON-SKIP2 TO  CC-CONTROL
074400       PERFORM 3011-PRINT-DETAIL-LINE
074500        THRU 3011-EXIT.
074600     PERFORM 3013-CONTENTS-PRINT
074700        THRU 3013-EXIT.
074800     SKIP2
074900 3012-EXIT.
075000     EJECT
075100 3013-CONTENTS-PRINT.
075200     SKIP2
075300     IF PART-STORED
075400       THEN
075500         IF TBL-LINE-COUNT GREATER THAN 30
075600          THEN
075700           MOVE ZERO TO TBL-LINE-COUNT
075800           ADD PLUS-1 TO TBL-PAGE-COUNT
075900           MOVE TBL-PAGE-COUNT TO OUT-PAGE
076000           MOVE TITLE-STORAGE TO HEADING-DETAIL
076100           MOVE HEADING-LINE TO DATA-LINE
076200           MOVE HEADING-LINE TO DATA-LINE2
076300           PERFORM 3019-WRITE-REPORT-RECORD-2 THRU 3019-EXIT
076400           MOVE T-OF-C-LINE1 TO DATA-LINE
076500           MOVE T-OF-C-LINE1 TO DATA-LINE2
076600           PERFORM 3019-WRITE-REPORT-RECORD-2 THRU 3019-EXIT
076700           ADD PLUS-2 TO TBL-LINE-COUNT
076800           MOVE T-OF-C-LINE2 TO DATA-LINE
076900           MOVE T-OF-C-LINE2 TO DATA-LINE2
077000           PERFORM 3019-WRITE-REPORT-RECORD-2 THRU 3019-EXIT
077100           ADD PLUS-2 TO TBL-LINE-COUNT
077200           MOVE T-OF-C-LINE3 TO DATA-LINE
077300           MOVE T-OF-C-LINE3 TO DATA-LINE2
077400           PERFORM 3019-WRITE-REPORT-RECORD-2 THRU 3019-EXIT
077500           ADD PLUS-2 TO TBL-LINE-COUNT
077600           MOVE T-OF-C-LINE4 TO DATA-LINE
077700           MOVE T-OF-C-LINE4 TO DATA-LINE2
077800           PERFORM 3019-WRITE-REPORT-RECORD-2 THRU 3019-EXIT
077900           ADD PLUS-1 TO TBL-LINE-COUNT.
078000     IF CHAPTER-STORED
078100       THEN
078200         IF TBL-LINE-COUNT GREATER THAN 40
078300          THEN
078400           MOVE ZERO TO TBL-LINE-COUNT
078500           ADD PLUS-1 TO TBL-PAGE-COUNT
078600           MOVE TBL-PAGE-COUNT TO OUT-PAGE
078700           MOVE TITLE-STORAGE TO HEADING-DETAIL
078800           MOVE HEADING-LINE TO DATA-LINE
078900           MOVE HEADING-LINE TO DATA-LINE2
079000           PERFORM 3019-WRITE-REPORT-RECORD-2 THRU 3019-EXIT
079100           MOVE T-OF-C-LINE1 TO DATA-LINE
079200           MOVE T-OF-C-LINE1 TO DATA-LINE2
079300           PERFORM 3019-WRITE-REPORT-RECORD-2 THRU 3019-EXIT
079400           ADD PLUS-2 TO TBL-LINE-COUNT
079500           MOVE T-OF-C-LINE2 TO DATA-LINE
079600           MOVE T-OF-C-LINE2 TO DATA-LINE2
079700           PERFORM 3019-WRITE-REPORT-RECORD-2 THRU 3019-EXIT
079800           ADD PLUS-2 TO TBL-LINE-COUNT
079900           MOVE T-OF-C-LINE3 TO DATA-LINE
080000           MOVE T-OF-C-LINE3 TO DATA-LINE2
080100           PERFORM 3019-WRITE-REPORT-RECORD-2 THRU 3019-EXIT
080200           ADD PLUS-2 TO TBL-LINE-COUNT
080300           MOVE T-OF-C-LINE4 TO DATA-LINE
080400           MOVE T-OF-C-LINE4 TO DATA-LINE2
080500           PERFORM 3019-WRITE-REPORT-RECORD-2 THRU 3019-EXIT
080600           ADD PLUS-1 TO TBL-LINE-COUNT.
080700     IF SECTION-STORED
080800       THEN
080900         IF TBL-LINE-COUNT GREATER THAN 45
081000          THEN
081100           MOVE ZERO TO TBL-LINE-COUNT
081200           ADD PLUS-1 TO TBL-PAGE-COUNT
081300           MOVE TBL-PAGE-COUNT TO OUT-PAGE
081400           MOVE TITLE-STORAGE TO HEADING-DETAIL
081500           MOVE HEADING-LINE TO DATA-LINE
081600           MOVE HEADING-LINE TO DATA-LINE2
081700           PERFORM 3019-WRITE-REPORT-RECORD-2 THRU 3019-EXIT
081800           MOVE T-OF-C-LINE1 TO DATA-LINE
081900           MOVE T-OF-C-LINE1 TO DATA-LINE2
082000           PERFORM 3019-WRITE-REPORT-RECORD-2 THRU 3019-EXIT
082100           ADD PLUS-2 TO TBL-LINE-COUNT
082200           MOVE T-OF-C-LINE2 TO DATA-LINE
082300           MOVE T-OF-C-LINE2 TO DATA-LINE2
082400           PERFORM 3019-WRITE-REPORT-RECORD-2 THRU 3019-EXIT
082500           ADD PLUS-2 TO TBL-LINE-COUNT
082600           MOVE T-OF-C-LINE3 TO DATA-LINE
082700           MOVE T-OF-C-LINE3 TO DATA-LINE2
082800           PERFORM 3019-WRITE-REPORT-RECORD-2 THRU 3019-EXIT
082900           ADD PLUS-2 TO TBL-LINE-COUNT
083000           MOVE T-OF-C-LINE4 TO DATA-LINE
083100           MOVE T-OF-C-LINE4 TO DATA-LINE2
083200           PERFORM 3019-WRITE-REPORT-RECORD-2 THRU 3019-EXIT
083300           ADD PLUS-1 TO TBL-LINE-COUNT.
083400     IF TBL-LINE-COUNT GREATER THAN TBL-PAGE-LIMIT
083500        OR TBL-LINE-COUNT EQUAL TBL-PAGE-LIMIT
083600        THEN
083700        MOVE ZERO TO TBL-LINE-COUNT
083800        ADD PLUS-1 TO TBL-PAGE-COUNT
083900        MOVE TBL-PAGE-COUNT TO OUT-PAGE
084000        MOVE TITLE-STORAGE TO HEADING-DETAIL
084100        MOVE HEADING-LINE TO DATA-LINE
084200        MOVE HEADING-LINE TO DATA-LINE2
084300        PERFORM 3019-WRITE-REPORT-RECORD-2 THRU 3019-EXIT
084400        MOVE T-OF-C-LINE1 TO DATA-LINE
084500        MOVE T-OF-C-LINE1 TO DATA-LINE2
084600        PERFORM 3019-WRITE-REPORT-RECORD-2 THRU 3019-EXIT
084700        ADD PLUS-2 TO TBL-LINE-COUNT
084800        MOVE T-OF-C-LINE2 TO DATA-LINE
084900        MOVE T-OF-C-LINE2 TO DATA-LINE2
085000        PERFORM 3019-WRITE-REPORT-RECORD-2 THRU 3019-EXIT
085100        ADD PLUS-2 TO TBL-LINE-COUNT
085200        MOVE T-OF-C-LINE3 TO DATA-LINE
085300        MOVE T-OF-C-LINE3 TO DATA-LINE2
085400        PERFORM 3019-WRITE-REPORT-RECORD-2 THRU 3019-EXIT
085500        ADD PLUS-2 TO TBL-LINE-COUNT
085600        MOVE T-OF-C-LINE4 TO DATA-LINE
085700        MOVE T-OF-C-LINE4 TO DATA-LINE2
085800        PERFORM 3019-WRITE-REPORT-RECORD-2 THRU 3019-EXIT
085900        ADD PLUS-1 TO TBL-LINE-COUNT.
086000     IF PART-STORED
086100        THEN
086200        MOVE CON-FALSE TO SWT-PART-STORED
086300        MOVE PART-STORAGE TO T-OF-C-DETAIL
086400        MOVE DET-PAGE-COUNT TO T-OF-C-PAGE
086500        MOVE CON-SKIP3 TO  CC-FOR-TOFC
086600        MOVE T-OF-C-DETAIL-LINE TO DATA-LINE
086700        MOVE T-OF-C-DETAIL-LINE TO DATA-LINE2
086800        PERFORM 3019-WRITE-REPORT-RECORD-2 THRU 3019-EXIT
086900        ADD PLUS-3 TO TBL-LINE-COUNT.
087000     IF CHAPTER-STORED
087100        THEN
087200        MOVE CON-FALSE TO SWT-CHAPTER-STORED
087300        MOVE CHAPTER-STORAGE TO T-OF-C-DETAIL
087400        MOVE DET-PAGE-COUNT TO T-OF-C-PAGE
087500        MOVE CON-SKIP2 TO  CC-FOR-TOFC
087600        MOVE T-OF-C-DETAIL-LINE TO DATA-LINE
087700        MOVE T-OF-C-DETAIL-LINE TO DATA-LINE2
087800        PERFORM 3019-WRITE-REPORT-RECORD-2 THRU 3019-EXIT
087900        ADD PLUS-2 TO TBL-LINE-COUNT.
088000     IF SECTION-STORED
088100        THEN
088200        MOVE CON-FALSE TO SWT-SECTION-STORED
088300        MOVE SECTION-STORAGE TO T-OF-C-DETAIL
088400        MOVE DET-PAGE-COUNT TO T-OF-C-PAGE
088500        MOVE CON-SKIP1 TO  CC-FOR-TOFC
088600        MOVE T-OF-C-DETAIL-LINE TO DATA-LINE
088700        MOVE T-OF-C-DETAIL-LINE TO DATA-LINE2
088800        PERFORM 3019-WRITE-REPORT-RECORD-2 THRU 3019-EXIT
088900        ADD PLUS-1 TO TBL-LINE-COUNT.
089000     IF SUB-SECTION-STORED
089100        THEN
089200        MOVE CON-FALSE TO SWT-SUB-SECTION-STORED
089300        MOVE SUBSECTION-STORAGE TO T-OF-C-DETAIL
089400        MOVE DET-PAGE-COUNT TO T-OF-C-PAGE
089500        MOVE CON-SKIP1 TO  CC-FOR-TOFC
089600        MOVE T-OF-C-DETAIL-LINE TO DATA-LINE
089700        MOVE T-OF-C-DETAIL-LINE TO DATA-LINE2
089800        PERFORM 3019-WRITE-REPORT-RECORD-2 THRU 3019-EXIT
089900        ADD PLUS-1 TO TBL-LINE-COUNT.
090000     SKIP2
090100 3013-EXIT.
090200     EJECT
090300 3014-READ-RECORD.
090400     SKIP2
090500     READ DATA-INPUT2
090600        AT END
090700           MOVE SPACES TO REPORT-RECORD-1
090800           MOVE SPACES TO REPORT-RECORD-2
090900           MOVE SPACES TO REPORT-RECORD-3
091000           MOVE SPACES TO DATA-LINE
091100           MOVE SPACES TO DATA-LINE2
091200           MOVE LOW-VALUES TO I-A-REC
091300           MOVE CON-TRUE TO SWT-END-OF-INPUT.
091400     ON 1 MOVE EJECT-LINE TO DATA-LINE.
091500     ON 1 MOVE EJECT-LINE TO DATA-LINE2.
091600     ON 1 PERFORM 3018-WRITE-REPORT-RECORD-1 THRU 3018-EXIT.
091700     IF XEROX-VERTICAL2
091800        THEN
091900        IF DISTRIBUTION
092000          THEN
092100        MOVE CON-TRUE TO SWT-XEROX-USED
092200        MOVE CON-TRUE TO SWT-XEROX-FOR-CONTENTS
092300        MOVE XEROX-DATA7 TO XEROX-DATA
092400        MOVE XEROX-LINE TO DATA-LINE
092500        MOVE XEROX-LINE TO DATA-LINE2
092600        PERFORM 3018-WRITE-REPORT-RECORD-1 THRU 3018-EXIT
092700        MOVE XEROX-DATA1 TO XEROX-DATA
092800        MOVE XEROX-LINE TO DATA-LINE
092900        MOVE XEROX-LINE TO DATA-LINE2
093000        PERFORM 3018-WRITE-REPORT-RECORD-1 THRU 3018-EXIT
093100        MOVE XEROX-DATA2 TO XEROX-DATA
093200        MOVE XEROX-LINE TO DATA-LINE
093300        MOVE XEROX-LINE TO DATA-LINE2
093400        PERFORM 3018-WRITE-REPORT-RECORD-1 THRU 3018-EXIT
093500        MOVE XEROX-DATA3 TO XEROX-DATA
093600        MOVE XEROX-LINE TO DATA-LINE
093700        MOVE XEROX-LINE TO DATA-LINE2
093800        PERFORM 3018-WRITE-REPORT-RECORD-1 THRU 3018-EXIT
093810        MOVE XEROX-DATA8 TO XEROX-DATA
093820        MOVE XEROX-LINE TO DATA-LINE
093830        MOVE XEROX-LINE TO DATA-LINE2
093840        PERFORM 3018-WRITE-REPORT-RECORD-1 THRU 3018-EXIT
093850        MOVE XEROX-DATA9 TO XEROX-DATA
093860        MOVE XEROX-LINE TO DATA-LINE
093870        MOVE XEROX-LINE TO DATA-LINE2
093880        PERFORM 3018-WRITE-REPORT-RECORD-1 THRU 3018-EXIT
093900        MOVE XEROX-DATA4 TO XEROX-DATA
094000        MOVE XEROX-LINE TO DATA-LINE
094100        MOVE XEROX-LINE TO DATA-LINE2
094200        PERFORM 3018-WRITE-REPORT-RECORD-1 THRU 3018-EXIT
094300        MOVE EJECT-LINE-80 TO DATA-LINE
094400        MOVE EJECT-LINE-80 TO DATA-LINE2
094500        PERFORM 3018-WRITE-REPORT-RECORD-1 THRU 3018-EXIT.
094600     IF XEROX-HORIZONTAL2
094610       THEN
094700        IF DISTRIBUTION
094800          THEN
094900        MOVE CON-FALSE TO SWT-XEROX-USED
095000        MOVE CON-FALSE TO SWT-XEROX-FOR-CONTENTS
095100        MOVE XEROX-DATA7 TO XEROX-DATA
095200        MOVE XEROX-LINE TO DATA-LINE
095300        MOVE XEROX-LINE TO DATA-LINE2
095400        PERFORM 3018-WRITE-REPORT-RECORD-1 THRU 3018-EXIT
095500        MOVE XEROX-DATA3 TO XEROX-DATA
095600        MOVE XEROX-LINE TO DATA-LINE
095700        MOVE XEROX-LINE TO DATA-LINE2
095800        PERFORM 3018-WRITE-REPORT-RECORD-1 THRU 3018-EXIT
095810        MOVE XEROX-DATA8 TO XEROX-DATA
095820        MOVE XEROX-LINE TO DATA-LINE
095830        MOVE XEROX-LINE TO DATA-LINE2
095840        PERFORM 3018-WRITE-REPORT-RECORD-1 THRU 3018-EXIT
095850        MOVE XEROX-DATA9 TO XEROX-DATA
095860        MOVE XEROX-LINE TO DATA-LINE
095870        MOVE XEROX-LINE TO DATA-LINE2
095880        PERFORM 3018-WRITE-REPORT-RECORD-1 THRU 3018-EXIT
095900        MOVE XEROX-DATA6 TO XEROX-DATA
096000        MOVE XEROX-LINE TO DATA-LINE
096100        MOVE XEROX-LINE TO DATA-LINE2
096200        PERFORM 3018-WRITE-REPORT-RECORD-1 THRU 3018-EXIT
096300        MOVE EJECT-LINE-80 TO DATA-LINE
096400        MOVE EJECT-LINE-80 TO DATA-LINE2
096500        PERFORM 3018-WRITE-REPORT-RECORD-1 THRU 3018-EXIT.
096600     IF XEROX-VERTICAL2
096700        THEN
096800        IF DOCUMENT
096900        THEN
097000        MOVE CON-TRUE TO SWT-XEROX-USED
097100        MOVE XEROX-DATA4 TO XEROX-DATA
097200        MOVE XEROX-LINE TO DATA-LINE
097300        MOVE XEROX-LINE TO DATA-LINE2
097400        PERFORM 3020-WRITE-REPORT-RECORD-3 THRU 3020-EXIT.
097500     IF XEROX-HORIZONTAL2
097600        THEN
097700        IF DOCUMENT
097800         THEN
097810        MOVE CON-FALSE TO SWT-XEROX-USED
097900        MOVE XEROX-DATA6 TO XEROX-DATA
098100        MOVE XEROX-LINE TO DATA-LINE
098200        MOVE XEROX-LINE TO DATA-LINE2
098300        PERFORM 3020-WRITE-REPORT-RECORD-3 THRU 3020-EXIT.
098400     IF DOCUMENT-TITLE2
098500        THEN
098600        MOVE CON-TRUE   TO SWT-DISTRIBUTION
098700        MOVE CON-FALSE TO SWT-DOCUMENT
098800        MOVE INPUT-DATA2 TO DETAIL-DATA2
098900        MOVE INPUT-DATA2 TO DETAIL-DATA
099000        MOVE CON-SKIP1 TO  CC-CONTROL2
099100        MOVE CON-SKIP1 TO  CC-CONTROL
099200        MOVE DETAIL-LINE  TO DATA-LINE
099300        MOVE DETAIL-LINE2 TO DATA-LINE2
099400        PERFORM 3018-WRITE-REPORT-RECORD-1 THRU 3018-EXIT.
099500     IF TITLE-CODE2
099600        THEN
099700          MOVE CON-FALSE TO SWT-DISTRIBUTION
099800          MOVE CON-TRUE  TO SWT-DOCUMENT
099900          MOVE DES2 TO TITLE-STORAGE
100000          MOVE INPUT-DATA2 TO TITLE-STORAGE2.
100100     IF TITLE-CODE2
100200        AND
100300          INPUT-DATA2 NOT EQUAL SPACES
100400           THEN
100500             MOVE CON-FALSE TO SWT-PART-STORED
100600             MOVE CON-FALSE TO SWT-CHAPTER-STORED
100700             MOVE CON-FALSE TO SWT-SECTION-STORED
100800             MOVE CON-FALSE TO SWT-SUB-SECTION-STORED
100900             MOVE CON-TRUE TO SWT-TITLE-STORED.
101000     IF PART-CODE2
101100        THEN
101200          MOVE CON-FALSE TO SWT-DISTRIBUTION
101300          MOVE CON-TRUE   TO SWT-DOCUMENT
101400          MOVE DES2 TO PART-STORAGE
101500          MOVE INPUT-DATA2 TO PART-STORAGE2.
101600     IF PART-CODE2
101700        AND
101800          INPUT-DATA2 NOT EQUAL SPACES
101900           THEN
102000             MOVE CON-FALSE TO SWT-TCHAPTER-STORED
102100             MOVE CON-FALSE TO SWT-TSECTION-STORED
102200             MOVE CON-FALSE TO SWT-TSUB-SECTION-STORED
102300             MOVE CON-TRUE TO SWT-TPART-STORED
102400             MOVE CON-TRUE TO SWT-PART-STORED.
102500     IF CHAPTER-CODE2
102600        THEN
102700        MOVE CON-FALSE TO SWT-DISTRIBUTION
102800        MOVE CON-TRUE   TO SWT-DOCUMENT
102900        MOVE DES2 TO CHAPTER-STORAGE
103000        MOVE INPUT-DATA2 TO CHAPTER-STORAGE2.
103100     IF CHAPTER-CODE2
103200        AND
103300          INPUT-DATA2 NOT EQUAL SPACES
103400           THEN
103500             MOVE CON-FALSE TO SWT-TSECTION-STORED
103600             MOVE CON-FALSE TO SWT-TSUB-SECTION-STORED
103700             MOVE CON-TRUE TO SWT-TCHAPTER-STORED
103800             MOVE CON-TRUE TO SWT-CHAPTER-STORED.
103900     IF SECTION-CODE2
104000        THEN
104100        MOVE CON-FALSE TO SWT-DISTRIBUTION
104200        MOVE CON-TRUE   TO SWT-DOCUMENT
104300        MOVE DES2 TO SECTION-STORAGE
104400        MOVE INPUT-DATA2 TO SECTION-STORAGE2.
104500     IF SECTION-CODE2
104600        AND
104700          INPUT-DATA2 NOT EQUAL SPACES
104800           THEN
104900            MOVE CON-FALSE TO SWT-TSUB-SECTION-STORED
105000            MOVE CON-TRUE TO SWT-TSECTION-STORED
105100            MOVE CON-TRUE TO SWT-SECTION-STORED.
105200     IF SUB-SECTION-CODE2
105300        THEN
105400        MOVE CON-FALSE TO SWT-DISTRIBUTION
105500        MOVE CON-TRUE   TO SWT-DOCUMENT
105600        MOVE DES2 TO SUBSECTION-STORAGE
105700        MOVE INPUT-DATA2 TO SUB-SECTION-STORAGE2.
105800     IF SUB-SECTION-CODE2
105900        AND
106000          INPUT-DATA2 NOT EQUAL SPACES
106100           THEN
106200            MOVE CON-TRUE TO SWT-TSUB-SECTION-STORED
106300            MOVE CON-TRUE TO SWT-SUB-SECTION-STORED.
106400     IF EJECT-PAGE2
106500        THEN
106600        MOVE CON-FALSE TO SWT-DISTRIBUTION
106700        MOVE CON-TRUE   TO SWT-DOCUMENT
106800        PERFORM 3016-PRINT-HEADING
106900           THRU 3016-EXIT.
107000     IF SKIP-ONE2
107100        THEN
107200        MOVE CON-FALSE TO SWT-DISTRIBUTION
107300        MOVE CON-TRUE   TO SWT-DOCUMENT
107400        MOVE INPUT-DATA2 TO DETAIL-DATA
107500        MOVE CON-SKIP1 TO  CC-CONTROL
107600        MOVE INPUT-DATA2 TO DETAIL-DATA2
107700        MOVE CON-SKIP1 TO  CC-CONTROL2
107800        PERFORM 3015-PRINT-DETAIL-LINE2
107900           THRU 3015-EXIT
108000        ADD PLUS-1 TO DET-LINE-COUNT2.
108100     IF SKIP-TWO2
108200        THEN
108300        MOVE CON-FALSE TO SWT-DISTRIBUTION
108400        MOVE CON-TRUE   TO SWT-DOCUMENT
108500        MOVE INPUT-DATA2 TO DETAIL-DATA2
108600        MOVE CON-SKIP2 TO  CC-CONTROL2
108700        MOVE INPUT-DATA2 TO DETAIL-DATA
108800        MOVE CON-SKIP2 TO  CC-CONTROL
108900        PERFORM 3015-PRINT-DETAIL-LINE2
109000           THRU 3015-EXIT
109100        ADD PLUS-2 TO DET-LINE-COUNT2.
109200     IF SKIP-THREE2
109300        THEN
109400        MOVE CON-FALSE TO SWT-DISTRIBUTION
109500        MOVE CON-TRUE   TO SWT-DOCUMENT
109600        MOVE INPUT-DATA2 TO DETAIL-DATA2
109700        MOVE CON-SKIP3 TO  CC-CONTROL2
109800        MOVE INPUT-DATA2 TO DETAIL-DATA
109900        MOVE CON-SKIP3 TO  CC-CONTROL
110000        PERFORM 3015-PRINT-DETAIL-LINE2
110100           THRU 3015-EXIT
110200        ADD PLUS-3 TO DET-LINE-COUNT2.
110300     SKIP2
110400 3014-EXIT.
110500     EJECT
110600 3015-PRINT-DETAIL-LINE2.
110700     SKIP2
110800     IF DET-LINE-COUNT2 GREATER THAN DET-PAGE-LIMIT
110900        OR DET-LINE-COUNT2 EQUAL DET-PAGE-LIMIT
111000        THEN
111100        MOVE DETAIL-DATA  TO DETAIL-STORAGE
111200        MOVE DETAIL-DATA2 TO DETAIL-STORAGE2
111300        PERFORM 3016-PRINT-HEADING
111400        MOVE DETAIL-STORAGE2 TO DETAIL-DATA2
111500        MOVE DETAIL-STORAGE  TO DETAIL-DATA
111600        MOVE CON-SKIP1 TO  CC-CONTROL
111700        MOVE CON-SKIP1 TO  CC-CONTROL2.
111800     MOVE DETAIL-LINE TO DATA-LINE
111900     MOVE DETAIL-LINE2 TO DATA-LINE2
112000     PERFORM 3020-WRITE-REPORT-RECORD-3 THRU 3020-EXIT.
112100 3015-EXIT.
112200     EJECT
112300 3016-PRINT-HEADING.
112400     SKIP2
112500     MOVE ZERO TO DET-LINE-COUNT2.
112501     ADD PLUS-1 TO DET-PAGE-COUNT2.
112502     MOVE TITLE-STORAGE  TO HEADING-DETAIL.
112503     MOVE TITLE-STORAGE2 TO HEADING-DETAIL2.
112504     MOVE  DET-PAGE-COUNT2 TO OUT-PAGE2.
112505     MOVE  DET-PAGE-COUNT2 TO OUT-PAGE.
112506     MOVE HEADING-LINE TO DATA-LINE
112507     MOVE HEADING-LINE2 TO DATA-LINE2
113300     PERFORM 3020-WRITE-REPORT-RECORD-3 THRU 3020-EXIT.
113400     IF TPART-STORED
113500        THEN
113730        MOVE PART-STORAGE2 TO DETAIL-DATA2
113800        MOVE PART-STORAGE  TO DETAIL-DATA
113810        MOVE CON-SKIP2 TO  CC-CONTROL2
113900        MOVE CON-SKIP2 TO  CC-CONTROL
113910        ADD PLUS-2 TO DET-LINE-COUNT2
114000        PERFORM 3015-PRINT-DETAIL-LINE2
114100           THRU 3015-EXIT.
114200     IF TCHAPTER-STORED
114300        THEN
114400        MOVE CHAPTER-STORAGE2 TO DETAIL-DATA2
114500        MOVE CON-SKIP2 TO  CC-CONTROL2
114600        MOVE CHAPTER-STORAGE  TO DETAIL-DATA
114700        MOVE CON-SKIP2 TO  CC-CONTROL
114800        PERFORM 3015-PRINT-DETAIL-LINE2
114900           THRU 3015-EXIT.
115000     IF TSECTION-STORED
115100        THEN
115200        MOVE SECTION-STORAGE2 TO DETAIL-DATA2
115300        MOVE CON-SKIP2 TO  CC-CONTROL2
115400        MOVE SECTION-STORAGE  TO DETAIL-DATA
115500        MOVE CON-SKIP2 TO  CC-CONTROL
115600        PERFORM 3015-PRINT-DETAIL-LINE2
115700           THRU 3015-EXIT.
115800     IF TSUB-SECTION-STORED
115900        THEN
116000        MOVE SUB-SECTION-STORAGE2 TO DETAIL-DATA2
116100        MOVE CON-SKIP2 TO  CC-CONTROL2
116200        MOVE SUBSECTION-STORAGE  TO DETAIL-DATA
116300        MOVE CON-SKIP2 TO  CC-CONTROL
116400        PERFORM 3015-PRINT-DETAIL-LINE2
116500           THRU 3015-EXIT.
116600     PERFORM 3017-CONTENTS-PRINT
116700        THRU 3017-EXIT.
116800     SKIP2
116900 3016-EXIT.
117000     EJECT
117100 3017-CONTENTS-PRINT.
117200     SKIP2
117300     IF TBL-LINE-COUNT2 GREATER THAN TBL-PAGE-LIMIT
117400        OR TBL-LINE-COUNT2 EQUAL TBL-PAGE-LIMIT
117500        THEN
117510        MOVE XEROX-DATAB TO XEROX-DATA
117511        MOVE XEROX-LINE TO DATA-LINE
117530        PERFORM 3019-WRITE-REPORT-RECORD-2 THRU 3019-EXIT
117600        MOVE ZERO TO TBL-LINE-COUNT2
117700        ADD PLUS-1 TO TBL-PAGE-COUNT2
117800        MOVE TBL-PAGE-COUNT2 TO OUT-PAGE2
117900        MOVE TBL-PAGE-COUNT2 TO OUT-PAGE
118000        MOVE TITLE-STORAGE2 TO HEADING-DETAIL2
118100        MOVE TITLE-STORAGE  TO HEADING-DETAIL
118200        MOVE HEADING-LINE  TO DATA-LINE
118300        MOVE HEADING-LINE2 TO DATA-LINE2
118400        PERFORM 3019-WRITE-REPORT-RECORD-2 THRU 3019-EXIT
118500        MOVE T-OF-C-LINE1   TO DATA-LINE
118600        MOVE T-OF-C-LINE212 TO DATA-LINE2
118700        PERFORM 3019-WRITE-REPORT-RECORD-2 THRU 3019-EXIT
118800        ADD PLUS-2 TO TBL-LINE-COUNT2
118900        MOVE T-OF-C-LINE2  TO DATA-LINE
119000        MOVE T-OF-C-LINE22 TO DATA-LINE2
119100        PERFORM 3019-WRITE-REPORT-RECORD-2 THRU 3019-EXIT
119200        ADD PLUS-2 TO TBL-LINE-COUNT2
119300        MOVE T-OF-C-LINE3  TO DATA-LINE
119400        MOVE T-OF-C-LINE23 TO DATA-LINE2
119500        PERFORM 3019-WRITE-REPORT-RECORD-2 THRU 3019-EXIT
119600        ADD PLUS-2 TO TBL-LINE-COUNT2
119700        MOVE T-OF-C-LINE4 TO DATA-LINE
119800        MOVE T-OF-C-LINE24 TO DATA-LINE2
119900        PERFORM 3019-WRITE-REPORT-RECORD-2 THRU 3019-EXIT
119901        MOVE XEROX-DATA4 TO XEROX-DATA
119902        MOVE XEROX-LINE TO DATA-LINE
119920        PERFORM 3019-WRITE-REPORT-RECORD-2 THRU 3019-EXIT
120000        ADD PLUS-1 TO TBL-LINE-COUNT2.
120100     IF PART-STORED
120200        THEN
120300        MOVE CON-FALSE TO SWT-PART-STORED
120400        MOVE PART-STORAGE2 TO T-OF-C-DETAIL2
120500        MOVE PART-STORAGE  TO T-OF-C-DETAIL
120600        MOVE DET-PAGE-COUNT2 TO T-OF-C-PAGE2
120700        MOVE DET-PAGE-COUNT2 TO T-OF-C-PAGE
120800        MOVE CON-SKIP3 TO  CC-FOR-TOFC2
120900        MOVE CON-SKIP3 TO  CC-FOR-TOFC
121000        MOVE T-OF-C-DETAIL-LINE  TO DATA-LINE
121100        MOVE T-OF-C-DETAIL2-LINE2 TO DATA-LINE2
121200        PERFORM 3019-WRITE-REPORT-RECORD-2 THRU 3019-EXIT
121300        ADD PLUS-3 TO TBL-LINE-COUNT2.
121400     IF CHAPTER-STORED
121500        THEN
121600        MOVE CON-FALSE TO SWT-CHAPTER-STORED
121700        MOVE CHAPTER-STORAGE2 TO T-OF-C-DETAIL2
121800        MOVE CHAPTER-STORAGE  TO T-OF-C-DETAIL
121900        MOVE DET-PAGE-COUNT2 TO T-OF-C-PAGE2
122000        MOVE DET-PAGE-COUNT2 TO T-OF-C-PAGE
122300        MOVE T-OF-C-DETAIL-LINE  TO DATA-LINE
122400        MOVE T-OF-C-DETAIL2-LINE2 TO DATA-LINE2
122410        MOVE CON-SKIP2 TO  CC-FOR-TOFC2
122420        MOVE CON-SKIP2 TO  CC-FOR-TOFC
122500        PERFORM 3019-WRITE-REPORT-RECORD-2 THRU 3019-EXIT
122600        ADD PLUS-2 TO TBL-LINE-COUNT2.
122700     IF SECTION-STORED
122800        THEN
122900        MOVE CON-FALSE TO SWT-SECTION-STORED
123000        MOVE SECTION-STORAGE2 TO T-OF-C-DETAIL2
123100        MOVE SECTION-STORAGE  TO T-OF-C-DETAIL
123200        MOVE DET-PAGE-COUNT2 TO T-OF-C-PAGE
123300        MOVE DET-PAGE-COUNT2 TO T-OF-C-PAGE2
123400        MOVE CON-SKIP1 TO  CC-FOR-TOFC
123500        MOVE CON-SKIP1 TO  CC-FOR-TOFC2
123600        MOVE T-OF-C-DETAIL-LINE TO DATA-LINE
123700        MOVE T-OF-C-DETAIL2-LINE2 TO DATA-LINE2
123800        PERFORM 3019-WRITE-REPORT-RECORD-2 THRU 3019-EXIT
123900        ADD PLUS-1 TO TBL-LINE-COUNT2.
124000     IF SUB-SECTION-STORED
124100        THEN
124200        MOVE CON-FALSE TO SWT-SUB-SECTION-STORED
124300        MOVE SUB-SECTION-STORAGE2 TO T-OF-C-DETAIL2
124400        MOVE SUBSECTION-STORAGE  TO T-OF-C-DETAIL
124500        MOVE DET-PAGE-COUNT2 TO T-OF-C-PAGE
124600        MOVE DET-PAGE-COUNT2 TO T-OF-C-PAGE2
124700        MOVE CON-SKIP1 TO  CC-FOR-TOFC
124800        MOVE CON-SKIP1 TO  CC-FOR-TOFC2
124900        MOVE T-OF-C-DETAIL-LINE TO DATA-LINE
125000        MOVE T-OF-C-DETAIL2-LINE2 TO DATA-LINE2
125100        PERFORM 3019-WRITE-REPORT-RECORD-2 THRU 3019-EXIT
125200        ADD PLUS-1 TO TBL-LINE-COUNT2.
125300     SKIP2
125400 3017-EXIT.
125500     EJECT
125600 3018-WRITE-REPORT-RECORD-1.
125700     SKIP2
125800     IF XEROX-USED
125900      THEN
126000       WRITE REPORT-RECORD-1 FROM DATA-LINE
126100     ELSE
126200       WRITE REPORT-RECORD-1 FROM DATA-LINE2.
126300 3018-EXIT.
126400     EJECT
126500 3019-WRITE-REPORT-RECORD-2.
126600     SKIP2
126700     IF XEROX-FOR-CONTENTS
126800      THEN
126900       WRITE REPORT-RECORD-2 FROM DATA-LINE
127000     ELSE
127100       WRITE REPORT-RECORD-2 FROM DATA-LINE2.
127200 3019-EXIT.
127300     EJECT
127400 3020-WRITE-REPORT-RECORD-3.
127500     SKIP2
127600     IF XEROX-USED
127700      THEN
127800       WRITE REPORT-RECORD-3 FROM DATA-LINE
127900     ELSE
128000       WRITE REPORT-RECORD-3 FROM DATA-LINE2.
128100 3020-EXIT.
128200     EJECT
128300 4010-CLOSE-ALL-FILES.
128400     SKIP2
128500     CLOSE DATA-INPUT
128600           DATA-INPUT2
128700           REPT-OUTPUT0
128800           REPT-OUTPUT3
128900           REPT-OUTPUT2.
129000     SKIP2
129100 4010-EXIT.

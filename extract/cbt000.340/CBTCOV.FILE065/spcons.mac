********************************************************************
*                                                                 JMH*
*         MODS :  MIKE HAWTHORNE    1984                          JMH*
*                                                                 JMH*
*         (PLEASE IGNORE XA COMMENTS---THIS PROGRAM WAS FIXED     JMH*
*          FOR XA BUT THIS VERSION WORKS ON SP WITHOUT CHANGE).   JMH*
*                                                                 JMH*
*                                                                 JMH*
********************************************************************
*                                                                 JMH*
* ---------JMH MODS FOR MVS/370   ---------------------------
*                                                                 JMH*
*        AND TO SUPPORT MODEL 3 DISPLAY STATION (32 LINES).       JMH*
*        ADDED CODE TO SUPPORT 43 LINE 3278 TERMINAL              JMH*
*        CHANGED CODE TO ISSUE SVC 34.                            JMH*
*        ADDED DISPLAY ON CONSOLE OF TSO USER-ID WHO ISSUES       JMH*
*        MVS AND JES2 COMMANDS.                                   JMH*
*        SUPPRESSED REPLY FOR REPLY COMMANDS.                     JMH*
*        ADDED PFK SUPPORT.                                       JMH*
*        ADDED SUPPRESSION OF OPERATOR REPLY ON OPER CMD LINE.    JMH*
*        FIXED NUMEROUS BUGS.                                     JMH*
*        CORRECTED CONSOLE ASID NUMBER FOR MVS/370 NOW 5.         JMH*
*        DROPPED SUPPORT OF 3066 CONSOLE. IF 3066 SUPPORT IS      JMH*
*          REQUIRED, ADD CODE TO CHECK CONSOLE AT LABEL "CHKSIZE" JMH*
*        ADDED SUPPORT FOR TSO COMMANDS                           JMH*
*            ENTER TSO --COMMAND PROCESSOR WILL PROMPT YOU        JMH*
*            THE SOURCE FOR EXECTSO PROGRAM IS ON THE TAPE        JMH*
*            ALSO.                                                JMH*
*                                                                 JMH*
*                                                                 JMH*
* NOTE ON TSO : TEST COMMAND NOT SUPPORTED IN THIS CODE .         JMH*
*       CHANGED THE TSO INTERFACE SO THAT YOU CAN USE THE         JMH*
*       TSO INTERFACE WITH ANY OTHER PROGRAM AS WELL AS THIS ONE. JMH*
*                                                                 JMH*
*        IF NOT TSO OPER USER THEN THIS WORKS IN DISPLAY          JMH*
*        MODE ONLY UNLESS A PASSWORD IS ENTERED. TO RETURN TO     JMH*
*        DISPLAY MODE ONLY ENTER ABCD.                            JMH*
*        YOU DO NOT NEED OPER AUTHORITY NOW--JUST ENTER THE       JMH*
*        PASSWORD----THE INSTALLATION CAN CHECK FOR ALLOWED       JMH*
*        COMMANDS TO BE ENTERED----ENTERING ABCD WILL NOT ALLOW   JMH*
*        ANY MVS OR JES2 COMMANDS TO BE ENTERED.
*        ADDED SUPPORT TO RETURN TO DISPLAY ONLY MODE             JMH*
*        CHANGED TO WORK UNDER SPF-----WE MUST RUN IN KEY ZERO    JMH*
*        NOTE--THIS REQUIRES CALL TO IGX000NN VIA SVC 109         JMH*
*        OR ANY OTHER EQUIVALENT SVC YOU HAVE IN YOUR SHOP        JMH*
*        THIS PROGRAM WILL ALSO WORK UNDER TSO/E.                 JMH*
*        DROPPED SUPPORT FOR HARD COPY TERMINAL--WHO USES ANYWAY. JMH*
*                                                                     *
*     THIS PROGRAM CAN BE LOADED FROM AN AUTHORIZED LIBRARY IN WHICH  *
*     CASE IT WILL ISSUE A MODSET TO GET INTO KEY ZERO---NEEDED FOR   *
*     CROSS MEMORY FUNCTIONS E.G AXSET AND SSAR MACROS TO BE ISSUED   *
*     IF IT IS NOT CALLED FROM AN AUTHORIZED LIBRARY OF IF            *
*     AUTHORIZATION HAS BEEN LOST E.G CALL FROM TSO (NOT TSO/E)       *
*     THEN A CALL TO USER SVC IGX00012 OR ANY IGX000NN VIA SVC 109    *
*     ATTEMPTS TO PUT IT IN KEY ZERO SUPERVISOR STATE                 *
*     WHICH WILL THEN ALLOW US TO OPERATE UNDER SPF.                  *
*     THIS FUNCTION IS NECESSARY SINCE CONSOLE BUFFERS ARE IN FETCH   *
*     PROTECTED STORAGE AND WE ARE USING CROSS MEMORY SERVICES TO     *
*     GET THIS DATA INTO OUR ADDRESS SPACE.                           *
*                                                                 JMH*
*        THIS PROGRAM WAS BASED ON THE ORIGINAL SPY PROGRAM BUT   JMH*
*        WITH SO MANY MODS FROM THE ORIGINAL IT BEARS LITTLE      JMH*
*        RESEMBLENCE TO IT.                                       JMH*
*                                                                 JMH*
         EJECT
***********************************************************************
*                                                                     *
*                                 XACONS                              *
*                                                                     *
*                               29/02/84                              *
*                                                                     *
*                       OPERATOR CONSOLE MONITOR                      *
*                                                                     *
*     XACONS GIVES A TSO USER THE CAPABILITY TO ENTER ANY             *
*     CONSOLE OPERATOR COMMAND.                                       *
*                                                                     *
*     JES COMMAND:  $...  ANY JES COMMAND ...                         *
*     OS COMMAND:   /...  ANY OS COMMAND ...  (THE / IS STRIPPED OFF) *
*     TSO COMMAND/CLIST PROCESSOR   ENTER TSO  --- THE TSO COMMAND    *
*     PROCESSOR WILL PROMPT YOU. NOTE TEST COMMAND IS NOT SUPPORTED   *
*     UNDER THIS PROCESSOR. MULTI-SPF SESSIONS ARE ALLOWED IF YOU     *
*     INSTALL THE MULTI-SPF SESSION PRODUCT FROM THE LA MVSUG TAPE    *
*                                                                     *
*     THE TSO COMMAND/CLIST PROCESSOR IS ALSO ON THE TAPE             *
*     (PROGRAM EXECTSO).                                              *
*                                                                     *
*           OPER AUTHORIZED TSO USERS CAN ENTER COMMANDS DIRECTLY     *
*     NON-OPER AUTHORIZED TSO USERS MUST ENTER A PASSWORD TO USE      *
*     THE REPLY FACILITY.                                             *
*                                                                     *
*     THIS PROGRAM NEEDS SYS1.AMODGEN CONCATENATED TO THE SYSLIB DD   *
*     DD STATEMENT OF THE ASSEMBLY STATEMENT. NOTE THAT THIS PROGRAM  *
*     WAS ASSEMBLED USING ASSEMBLER H ALTHGOUGH ASSEMBLER XF WILL     *
*     WORK AS WELL. IT MUST BE LINKED WITH RMODE AND AMODE AS 24 AND  *
*     PLEASE NOTE THAT THE ASID OF THE CONSOLE ADDRESS SPACE IS 6 AND *
*     NOT 5 AS IN SP 1.3.3. THE RESIDENT DISPLAY MODULE HAS ALSO      *
*     BEEN MODIFIED.                                                  *
*     THIS VERSION WILL NOT WORK UNDER SP 1.3.3                       *
*                                                                     *
*     IF FOR ANY REASON THE ASID OF THE CONSOLE TASK IS NOT 6 USE     *
*     SDSF FUNCTION DA OR ANY OTHER EQUIVALENT PROGRAM AND FIND OUT   *
*     WHAT THE NUMBER IS. CHANGE THE VALUE OF CONSASID TO REFLECT     *
*     THIS NUMBER                                                     *
*                                                                     *
*     TO MAKE THIS PROGRAM WORK UNDER XA 2.1.2 ALL YOU NEED TO DO     *
*     BELIEVE IT OR NOT IS TO CHANGE THE CONSOLE ASID NUMBER TO 6     *
*     AND RE-ASSEMBLE IT USING ASSEMBLER H  AND THE XA 2.1.1 VERSION  *
*     OF THE MACROS. IF YOU REALLY WANT TO BE CLEVER ASSEMBLE A MINI  *
*     DRIVER PROGRAM WHICH EXAMINES THE CVT TO SEE IF XA IS RUNNING   *
*     OR NOT AND THEN ISSUE A LOAD FOR THE XA OR SP 1.3.3 VERSION OF  *
*     THIS PROGRAM. (FIELD CVTMVSE IN THE CVT TELLS YOU IF YOU HAVE   *
*     XA OR MVS/SP .                                                  *
*                                                                     *
***********************************************************************
      EJECT
***********************************************************************
*                                                                     *
*                                                                     *
*  COMMAND     DESCRIPTION                                            *
*                                                                     *
*     PFK1/13  DISPLAY HELP                                           *
*     PFK3/15  END                                                    *
*     C        SWITCH MONITOR TO MASTER CONSOLE                       *
*     CXX      SWITCH MONITOR TO CONSOLE XX                           *
*     DXX      SET DELAY TO XX TENTHS SECONDS                         *
*     E        END XACONS                                             *
*     F        FREEZE DISPLAY ON CURRENT PAGE                         *
*     L        LINK TO SWAP PROGRAM (IF AVAILABLE)                    *
*     R        RELEASE DISPLAY                                        *
*     S        STATUS OF ALL CONSOLES                                 *
*     TSO      ATTACH TSO PROCESSOR (TEST COMMAND NOT SUPPORTED)      *
*     W        START TIMER MODE FOR 30 SECONDS                        *
*     WXX      START TIMER MODE FOR XX SECONDS                        *
*     W0       START TIMER MODE UNTIL INTERRUPT                       *
*     ?/H      DISPLAY HELP                                           *
*     1        DISPLAY MODE 1                                         *
*     2        DISPLAY MODE 2                                         *
*                                                                     *
*  HITTING INTERRUPT WILL STOP THE WAIT TIMER                         *
*                                                                     *
*     DISPLAY MODES 1 AND 2 ARE ONLY USEFUL WHEN WATCHING A CONSOLE   *
*     FROM A TSO TERMINAL WITH FEWER LINES. THESE MODES ARE:          *
*                                                                     *
*     DISPLAY MODE 1 - PAGE 1 = TOP X LINES                           *
*                      PAGE 2 = BOTTOM CONSOLE LINES-X                *
*                                                                     *
*     DISPLAY MODE 2 - PAGE 1 = TOP X  LINES                          *
*                      PAGE 2 = BOTTOM X  LINES                       *
*                                                                     *
***********************************************************************
         MACRO
         IEECDCM    &DEVICE=ALL,&USE=FC
***********************************************************************
*                                                                     *
*                              IEECDCM                        @G811PSS*
*                                                                     *
* COPYRIGHT  -                                                    @L2C*
*              5740-XC6 COPYRIGHT IBM CORP 1980, 1983,                *
*              LICENSED MATERIAL-PROGRAM, PROPERTY OF IBM,            *
*              REFER TO COPYRIGHT INSTRUCTIONS FORM NUMBER G120-2083. *
*                                                                     *
* STATUS     - OS/VS2 JBB2110                                     @L2C*
*                                                                     *
* FUNCTION   - BUILDS A TDCM AT SYSGEN FOR A PARTICULAR       @G811PSS*
*              DEVICE                                         @G811PSS*
*                                                                     *
* INVOCATION - SPECIFY: IEECDCM DEVICE=XX,USE=YY              @G811PSS*
*                                                                     *
*              WHERE:                                         @G811PSS*
*                 XX = B   2250 DEVICE                        @G860P2G*
*                      C   2260 DEVICE                        @G811PSS*
*                      D   3277 MOD 2 DEVICE                  @G811PSS*
*                      E   3277/3278 MOD 1 DEVICE             @G811PSS*
*                      F   3278 MOD 2 OR 3279 2A DEVICE       @G860PSS*
*                      G   3278 MOD 3 OR 3279 3A DEVICE       @G860PSS*
*                      H   3278 MOD 4 DEVICE                  @G811PSS*
*                      I   3278 MOD 2A OR 3279 MOD 2C DEVICE      @T1C*
*                      J   3279 MOD 2B DEVICE                 @G860PSS*
*                      K   3279 MOD 3B DEVICE                 @G860PSS*
*                      ALL A GENERALIZED TDCM IS TO BE        @G811PSS*
*                          MAPPED - DEFAULT                   @G811PSS*
*                 YY = FC FULL CAPABILITY CONSOLE - DEFAULT   @G811PSS*
*                      SD STATUS DISPLAY CONSOLE              @G811PSS*
*                      MS MESSAGE STREAM CONSOLE              @G811PSS*
*                                                                     *
* CHANGE                                                      @G811PSS*
*   ACTIVITY - G811PSS, ZA44483                                       *
* $L1=CONCOLOR, JBB1326,  801205,  PDSS: BASE COLOR SUPPORT           *
*              G860P2G - ADD BACKWARD POINTER TO RDCM; DROP           *
*                        3066 SUPPORT                                 *
*              G860PSS - EXTENDED COLOR SUPPORT                       *
*              ZA60763                                                *
* $L2=OCCF,     JBB2110,  820531,  PDSJ: ROUTABLE K S                 *
* $T1=OZ72482,  JBB2110,  830428,  PD2L: SUPPORT 3279-2C CONSOLE      *
*                                                                     *
***********************************************************************
.*                                                             @G811PSS
.* NOTES -                                                     @G811PSS
.*         . THE STAGE 1 SYSGEN MACRO WHICH BUILDS THE STAGE 2 @G811PSS
.*           OUTPUT TO CAUSE THIS MACRO TO BE INVOKED IS       @G811PSS
.*           SGIEA2D1.                                         @G811PSS
.*                                                             @G811PSS
.*         . 2250 CONSOLE CAN BE ONLY FULL CAPABILITY          @G811PSS
.*           3277/3278 MOD 1 CONSOLE CAN BE ONLY MESSAGE       @G811PSS
.*           STREAM                                            @G811PSS
.*                                                             @G811PSS
.*         . THE 3278 MODEL 1 IS TREATED AS A 3277 MODEL 1.    @G811PSS
.*           ALL CHECKS MADE WILL BE IN TERMS OF THE 3277      @G811PSS
.*           MODEL 1.                                          @G811PSS
.*                                                             @G811PSS
.*         . IF THE DEVICE PARAMETER IS NOT RECOGNIZED,        @G811PSS
.*           DEVICE=H WILL BE USED.                            @G811PSS
.*                                                             @G811PSS
.*         . IF THE USE PARAMETER IS NOT RECOGNIZED, USE=FC    @G811PSS
.*           WILL BE USED.                                     @G811PSS
.*                                                             @G811PSS
.*         . THE MODULES WHICH CURRENTLY INVOKE THIS MACRO     @G811PSS
.*           ARE: IEECVETP, IEECVETQ, IEECVETR, IEECVETU,      @G860P2G
.*                IEECVETV, IEECVETZ, IEECVFTR, IEE40110       @G860P2G
.*                                                             @G811PSS
.* MESSAGES ISSUED:                                            @G811PSS
.*                                                             @G811PSS
.* SEVERITY                                                    @G811PSS
.*  CODE             TEXT                                      @G811PSS
.* -------  -------------------------------------------------- @G811PSS
.*    5     'DEVICE' PARAMETER NOT RECOGNIZED. 'DEVICE=H' USED @G811PSS
.*    5     'USE' PARAMETER NOT RECOGNIZED. 'USE=FC' USED      @G811PSS
.*    5     A 2250 DEVICE CAN BE ONLY FULL CAPABILITY.         @G811PSS
.*          'USE=FC' USED.                                     @G811PSS
.*    5     A 3277/3278 MODEL 1 DEVICE CAN BE ONLY MESSAGE     @G811PSS
.*          STREAM. 'USE=MS' USED.                             @G811PSS
.*                                                             @G811PSS
.*                                                             @G811PSS
.* THE FOLLOWING ARE THE DEFINITIONS OF VARIABLES USED IN      @G811PSS
.* THIS MACRO.                                                 @G811PSS
.*                                                             @G811PSS
.*             FIELD                                           @G811PSS
.* SYMBOL   INITIALIZED             DEFINITION                 @G811PSS
.* ----------------------------------------------------------- @G811PSS
.* &DEVICE1               WORKING COPY OF DEVICE PARAMETER     @G811PSS
.* &USE1                  WORKING COPY OF USE PARAMETER        @G811PSS
.* &AA                    COUNTER USED TO GENERATE SCREEN      @G811PSS
.*                        IMAGE BUFFERS, DOM IDS, SCT'S        @G811PSS
.*                        AND SSCT'S.                          @G811PSS
.* &BB                    NUMBER OF DOM ID NUMBERS TO          @G811PSS
.*                        GENERATE.                            @G811PSS
.* &CC                    ORG VALUE FOR SCT AND SSCT TO SET    @G811PSS
.*                        STOPPER VALUE.                       @G811PSS
.* &DD                    NUMBER OF SCT'S AND SSCT'S TO        @G811PSS
.*                        GENERATE.                            @G811PSS
.* &QQ       DCMIONDX     INDEX TO BE USED TO FIND I/O         @G811PSS
.*                        ROUTINE.                             @G811PSS
.* &A        DCMWTINT     NAME OF THE LAST LINE IN THE MESSAGE @G811PSS
.*                        AREA PLUS ONE.                       @G811PSS
.* &B        DCMBUFAD     NAME OF BUFFER ADDRESS TABLE OR      @G811PSS
.*                        ZERO.                                @G811PSS
.*                        2250'S HAVE A BUFFER ADDRESS         @G860P2G
.*                        SPECIFIED.                           @G860P2G
.* &C        DCMWTBUF     NAME OF THE LAST LINE IN THE MESSAGE @G811PSS
.*                        AREA PLUS ONE. "A" AND "C" DO NOT    @G811PSS
.*                        HAVE TO BE THE SAME. DIFFERENT       @G811PSS
.*                        FIELDS ARE INITIALIZED WITH EACH     @G811PSS
.*                        VARIABLE.                            @G811PSS
.* &D        DCMLGNTH     LENGTH OF A LINE TO BE DISPLAYED.    @G811PSS
.* &E        DCMAXLGN     MAXIMUM LENGTH OF DATA WHICH CAN BE  @G811PSS
.*                        DISPLAYED ON A LINE.                 @G811PSS
.* &F        DCMMSGAL     NUMBER OF LINES IN THE MESSAGE AREA. @G811PSS
.* &G        DCMCORLN     LENGTH OF A LINE IN STORAGE.         @G811PSS
.* &H        DCMSEG       INITIAL VALUE FOR THE SEGMENT        @G811PSS
.*                        OPTION.                              @G811PSS
.* &J        DCMDL        DISPLAY AREA OPTION - "8" IS USED    @G811PSS
.*                        FOR ALL CURRENT DEVICES.             @G811PSS
.* &K        DCMRNUM      INITIAL VALUE FOR THE ROLL NUMBER    @G811PSS
.*                        OPTION.                              @G811PSS
.* &L        DCMRTME      INITIAL VALUE FOR THE ROLL TIME      @G811PSS
.*                        OPTION. (2 TIMES NUMBER OF LINES IN  @G811PSS
.*                        MESSAGE AREA)                        @G811PSS
.* &M        DCMSEGDF     DEFAULT VALUE FOR THE SEGMENT        @G811PSS
.*                        OPTION.                              @G811PSS
.* &N        DCMRNUMD     DEFAULT VALUE FOR THE ROLL NUMBER    @G811PSS
.*                        OPTION.                              @G811PSS
.* &P        DCMRTMED     DEFAULT VALUE FOR THE ROLL TIME      @G811PSS
.*                        OPTION. (2 TIMES NUMBER OF LINES IN  @G811PSS
.*                        MESSAGE AREA)                        @G811PSS
.* &V        DCMIOUNQ     UNIQUE I/O BYTE.                     @G811PSS
.* &W        DCMASKEN     DEVICE MASKS PRESENTED FOR "ENTER"   @G811PSS
.*                        "CANCEL" AND "CURSOR".               @G811PSS
.* &X        DCMPFKLN     NAME OF THE PFK LINE OR ZERO IF THE  @G811PSS
.*                        PFK LINE IS NOT SUPPORTED.           @G811PSS
.* &Y        DCMRMINC     UNIQUE DEVICE INCREMENT VALUE TO     @G811PSS
.*                        OBTAIN AID FROM RMI DATA.            @G811PSS
.* &Z        DCMASKEN     DEVICE MASKS PRESENTED FOR "LIGHT    @G811PSS
.*                        PEN", "1ST TYPE PFK", "2ND TYPE PFK" @G811PSS
.*                        "3RD TYPE PFK", "4TH TYPE PFK",      @G811PSS
.*                        "CLEAR".                             @G811PSS
.* &AIDS     DCMASKEN     DEVICE MASKS PRESENTED FOR 'PA1'     @G811PSS
.*                        AND 'PA3'                            @G811PSS
.* &ENTLNE1  DCMENTL1     LINE NUMBER OF FIRST LINE OF ENTRY   @G811PSS
.*                        AREA MINUS ONE.  ONLY FOR THE 3277   @G811PSS
.*                        MOD2, 3278 AND 3279 DEVICES.         @G811PSS
.* &ENTLNE2  DCMENTL2     LINE NUMBER OF SECOND LINE OF ENTRY  @G811PSS
.*                        AREA MINUS ONE.  ONLY FOR THE 3277   @G811PSS
.*                        MOD2, 3278 AND 3279 DEVICES.         @G811PSS
.* &PFKSBA   DCMPFKC      VALUE FOR SET BUFFER ADDRESS FOR PFK @G811PSS
.*                        LINE. ONLY FOR 3277 MOD 2. USED IN   @G811PSS
.*                        CONJUNCTION WITH &PFKLNAD.           @G811PSS
.* &PFKLNAD  DCMPFKRC     ADDRESS OF PFK LINE IN ROW-COLUMN    @G811PSS
.*                        FORMAT. ONLY FOR 3277 MOD 2.         @G811PSS
.* &ENTYPOS  DCMENTPO     THE OFFSET OF THE FIRST CHARACTER IN @G811PSS
.*                        THE ENTRY AREA. ONLY FOR 3277 MOD 2, @G811PSS
.*                        3278 AND THE 3279 DEVICES.           @G811PSS
.* &SBAINST               THE ORDERS AND ATTRIBUTES FOR THE    @G811PSS
.*                        INSTRUCTION LINE.  ONLY FOR 3277     @G811PSS
.*                        MOD2, 3278 AND 3279 DEVICES.         @G811PSS
.* &SBAENT1               THE ORDERS AND ATTRIBUTES FOR THE    @G811PSS
.*                        FIRST LINE OF THE ENTRY AREA.  ONLY  @G811PSS
.*                        FOR 3277 MOD 2, 3278 AND THE 3279    @G811PSS
.*                        DEVICES.                             @G811PSS
.* &SBAENT2               THE ORDERS AND ATTRIBUTES FOR THE    @G811PSS
.*                        SECOND LINE OF THE ENTRY AREA. ONLY  @G811PSS
.*                        FOR 3277 MOD 2, 3278 AND THE 3279    @G811PSS
.*                        DEVICES.                             @G811PSS
.* &SBAWARN               THE ORDERS AND ATTRIBUTES FOR THE    @G811PSS
.*                        WARNING LINE. ONLY FOR 3277 MOD 2,   @G811PSS
.*                        3278 AND THE 3279 DEVICES.           @G811PSS
.* &ENDLNUM               LINE NUMBER OF INSTRUCTION LINE      @G811PSS
.*                        MINUS ONEFOR 3277 MOD 2. LINE NUMBER @G811PSS
.*                        OF INSTRUCTION LINE MINUS TWO FOR    @G811PSS
.*                        THE 3278 AND 3279 DEVICES.           @G811PSS
.* &INSTRLN               LINE NUMBER OF THE INSTRUCTION LINE  @G860PSS
.*                        MINUS ONE                            @G860PSS
.* &SCRNWD                NUMBER OF CHARACTERS ON A SCREEN     @G860PSS
.*                        LINE                                 @G860PSS
.* &ADJORD                ADDRESS OF THE ADJUNCT ORDER AREA.   @G860PSS
.*                        ONLY FOR 3279-2B,3B DEVICES.         @G860PSS
.* &LSTSSCT  DCMLSSCT     ADDRESS OF THE LAST SSCT             @ZA60763
.*                                                             @G811PSS
.*                                                             @G811PSS
.*          VALUES USED WHEN THE DEVICE IS IN FULL             @G811PSS
.*          CAPABILITY MODE. ONLY FOR 3277 MOD 2, 3278         @G811PSS
.*          AND THE 3279 DEVICES.                              @G811PSS
.*                                                             @G811PSS
.* &FCNLMGA  DCMFNLMA     MAXIMUM NUMBER OF LINES IN THE       @G811PSS
.*                        MESSAGE AREA.                        @G811PSS
.* &FCLSTLA  DCMFLLA      NAME OF THE LAST LINE IN THE MESSAGE @G811PSS
.*                        AREA.                                @G811PSS
.* &FCLST1A  DCMFLL1A     NAME OF THE LAST LINE PLUS ONE IN    @G811PSS
.*                        THE MESSAGE AREA.                    @G811PSS
.* &FCLSCT   DCMFLSCT     NAME OF THE SCT FOR THE LAST LINE    @G811PSS
.*                        IN THE MESSAGE AREA.                 @G811PSS
.* &FCSCT1   DCMFSCT1     NAME OF THE SCT FOR THE LAST LINE    @G811PSS
.*                        PLUS ONE IN THE MESSAGE AREA.        @G811PSS
.* &FCLSSCT  DCMFSSCT     NAME OF THE SSCT FOR THE LAST LINE   @G811PSS
.*                        PLUS ONE IN THE MESSAGE AREA.        @G811PSS
.* &FCENTY2  DCMFENT2     NAME OF THE SECOND LINE OF THE ENTRY @G811PSS
.*                        AREA.                                @G811PSS
.* &FCEN2RC  DCMFENRC     ADDRESS OF SECOND LINE OF ENTRY      @G811PSS
.*                        AREA IN ROW-COLUMN FORMAT.           @G811PSS
.*                                                             @G811PSS
.*                                                             @G811PSS
.*          VALUES USED WHEN THE DEVICE IS IN MESSAGE          @G811PSS
.*          STREAM MODE. ONLY FOR THE 3277 MOD 2, 3278         @G811PSS
.*          AND THE 3279 DEVICES.                              @G811PSS
.*                                                             @G811PSS
.* &MSNLMGA  DCMMNLMA     MAXIMUM NUMBER OF LINES IN THE       @G811PSS
.*                        MESSAGE AREA.                        @G811PSS
.* &MSLSTLA  DCMMLLA      NAME OF THE LAST LINE IN THE MESSAGE @G811PSS
.*                        AREA.                                @G811PSS
.* &MSLST1A  DCMMLL1A     NAME OF THE LAST LINE PLUS ONE IN    @G811PSS
.*                        THE MESSAGE AREA.                    @G811PSS
.* &MSLSCT   DCMMLSCT     NAME OF THE SCT FOR THE LAST LINE    @G811PSS
.*                        IN THE MESSAGE AREA.                 @G811PSS
.* &MSSCT1   DCMMSCT1     NAME OF THE SCT FOR THE LAST LINE    @G811PSS
.*                        PLUS ONE IN THE MESSAGE AREA.        @G811PSS
.* &MSLSSCT  DCMMSSCT     NAME OF THE SSCT FOR THE LAST LINE   @G811PSS
.*                        PLUS ONE IN THE MESSAGE AREA.        @G811PSS
.*                                                             @G811PSS
.*                                                             @G811PSS
.*          VALUES USED WHEN THE DEVICE IS IN STATUS           @G811PSS
.*          DISPLAY MODE. ONLY FOR THE 3277 MOD 2, 3278        @G811PSS
.*          AND THE 3279 DEVICES.                              @G811PSS
.*                                                             @G811PSS
.* &SDNLMGA  DCMDNLMA     MAXIMUM NUMBER OF LINES IN THE       @G811PSS
.*                        MESSAGE AREA.                        @G811PSS
.* &SDLSTLA  DCMDLLA      NAME OF THE LAST LINE IN THE         @G811PSS
.*                        MESSAGE AREA.                        @G811PSS
.* &SDLST1A  DCMDLL1A     NAME OF THE LAST LINE PLUS ONE IN    @G811PSS
.*                        THE MESSAGE AREA.                    @G811PSS
.* &SDLSCT   DCMDLSCT     NAME OF THE SCT FOR THE LAST LINE    @G811PSS
.*                        IN THE MESSAGE AREA                  @G811PSS
.* &SDSCT1   DCMDSCT1     NAME OF THE SCT FOR THE LAST LINE    @G811PSS
.*                        PLUS ONE IN THE MESSAGE AREA.        @G811PSS
.* &SDLSSCT  DCMDSSCT     NAME OF THE SSCT FOR THE LAST LINE   @G811PSS
.*                        PLUS ONE IN THE MESSAGE AREA.        @G811PSS
.*                                                             @G811PSS
.**********************************************************************
.*                                                             @G860P2G
.* D (DCMIRCTR,DCMMSGDM,DCMMSGIR,DCMMSGWR,DCMDSINR)                @L1A
.* A (DCMMSGR1,DCMMSGR2,DCMMSGUA,DCMMSGEA)                         @L1A
.* A (DCMTVERN, DCMTVRID, DCMTSP21, DCMTRDCM)                  @G860P2G
.* D (.USEOK, .TESTDEV, .FC85, .TRY85)                         @G860P2G
.* A (&INSTRLN, &SCRNWD, &ADJORD)                              @G860PSS
.* A (&LSTSSCT)                                                @ZA60763
.* C (DCMLSSCT)                                                @ZA60763
.* A (DCMDELMS,DCMSEGMS,DCMCONMS,DCMRNUMM,DCMRTMEM,DCMMFRMM)       @L2A
.* COMMENT AND PROLOGUE CHANGES ONLY                               @T1A
.*                                                             @G860P2G
.**********************************************************************
.*                                                                    *
.*       DECLARE THE VARIABLES                                 @G811PSS
.*                                                                    *
.**********************************************************************
         LCLA      &AA,&BB,&CC,&DD,&QQ,&ENDLNUM                @G811PSS
         LCLC      &DEVICE1,&USE1                              @G811PSS
         LCLC      &A,&B,&C,&D,&E,&F,&G,&H,&J,&K
         LCLC      &L,&M,&N,&P,&V,&W,&X,&Y,&Z,&AIDS            @G811PSS
         LCLC      &ENTLNE1,&ENTLNE2,&PFKSBA,&PFKLNAD,&ENTYPOS @G811PSS
         LCLC      &INSTRLN,&SCRNWD,&ADJORD,&LSTSSCT           @ZA60763
         LCLC      &FCNLMGA,&FCLSTLA,&FCLST1A,&FCSCT1          @G811PSS
         LCLC      &FCLSSCT,&FCENTY2,&FCEN2RC,&FCLSCT          @G811PSS
         LCLC      &MSNLMGA,&MSLSTLA,&MSLST1A,&MSSCT1          @G811PSS
         LCLC      &MSLSSCT,&MSLSCT                            @G811PSS
         LCLC      &SDNLMGA,&SDLSTLA,&SDLST1A,&SDSCT1          @G811PSS
         LCLC      &SDLSSCT,&SDLSCT                            @G811PSS
         LCLC      &SBAINST,&SBAENT1,&SBAENT2,&SBAWARN         @G811PSS
.**********************************************************************
.*                                                                    *
.*       INITIALIZE VARIABLES WITH COMMON VALUES               @G811PSS
.*                                                                    *
.**********************************************************************
&DEVICE1 SETC  '&DEVICE'           GET WORKING COPY OF PARM    @G811PSS
&USE1    SETC  '&USE'              GET WORKING COPY OF PARM    @G811PSS
&A       SETC  'DCMWARN'           DCMWTINT INITIAL VALUE      @G811PSS
&B       SETC  '0'                 DCMBUFAD INITIAL VALUE      @G811PSS
&C       SETC  'DCMWARN'           DCMWTBUF INITIAL VALUE      @G811PSS
&D       SETC  '78'                DCMLGNTH INITIAL VALUE      @G811PSS
&E       SETC  '75'                DCMAXLGN INITIAL VALUE      @G811PSS
&G       SETC  '84'                DCMCORLN INITIAL VALUE      @G811PSS
&J       SETC  '8'                 DCMMDL   INITIAL VALUE      @G811PSS
&V       SETC  '0C'                DCMIOUNQ INITIAL VALUE
&W       SETC  '000000'            DCMASKEN INITIAL VALUE
&X       SETC  '0'                 DCMPFKLN INITIAL VALUE
&Y       SETC  '0'                 DCMRMINC INITIAL VALUE
&Z       SETC  '000000000000'      DCMASKEN INITIAL VALUE      @G811PSS
&ADJORD  SETC  '0'                 DCMAEORD INITIAL VALUE      @G860PSS
&LSTSSCT SETC  '0'                 DCMLSSCT INITIAL VALUE      @ZA60763
&AIDS    SETC  '0000'              DCMASKEN INITIAL VALUE      @G811PSS
&ENTLNE1 SETC  '0'                 DCMENTL1 INITIAL VALUE      @G811PSS
&ENTLNE2 SETC  '0'                 DCMENTL2 INITIAL VALUE      @G811PSS
&PFKSBA  SETC  '0'                 DCMPFKC  INITIAL VALUE      @G811PSS
&PFKLNAD SETC  '0'                 DCMPFKRC INITIAL VALUE      @G811PSS
&ENTYPOS SETC  '0'                 DCMENTPO INITIAL VALUE      @G811PSS
&SBAINST SETC  '0'                 INIT VALUE FOR NON 3270'S   @G811PSS
&SBAENT1 SETC  '0'                 INIT VALUE FOR NON 3270'S   @G811PSS
&SBAENT2 SETC  '0'                 INIT VALUE FOR NON 3270'S   @G811PSS
&SBAWARN SETC  '0'                 INIT VALUE FOR NON 3270'S   @G811PSS
&ENDLNUM SETA  0                   INIT VALUE FOR NON 3270'S   @G811PSS
&FCNLMGA SETC  '0'                 DCMFNLMA INITIAL VALUE      @G811PSS
&FCLSTLA SETC  '0'                 DCMFLLA  INITIAL VALUE      @G811PSS
&FCLST1A SETC  '0'                 DCMFLL1A INITIAL VALUE      @G811PSS
&FCLSCT  SETC  '0'                 DCMFLSCT INITIAL VALUE      @G811PSS
&FCSCT1  SETC  '0'                 DCMFSCT1 INITIAL VALUE      @G811PSS
&FCLSSCT SETC  '0'                 DCMFSSCT INITIAL VALUE      @G811PSS
&FCENTY2 SETC  '0'                 DCMFENT2 INITIAL VALUE      @G811PSS
&FCEN2RC SETC  '0000'              DCMFENRC INITIAL VALUE      @G811PSS
&INSTRLN SETC  '0'                 DCMINLNM INITIAL VALUE      @G860PSS
&MSNLMGA SETC  '0'                 DCMMNLMA INITIAL VALUE      @G811PSS
&MSLSTLA SETC  '0'                 DCMMLLA  INITIAL VALUE      @G811PSS
&MSLST1A SETC  '0'                 DCMMLL1A INITIAL VALUE      @G811PSS
&MSLSCT  SETC  '0'                 DCMMLSCT INITIAL VALUE      @G811PSS
&MSSCT1  SETC  '0'                 DCMMSCT1 INITIAL VALUE      @G811PSS
&MSLSSCT SETC  '0'                 DCMMSSCT INITIAL VALUE      @G811PSS
&SCRNWD  SETC  '80'                DCMSCRW  INITIAL VALUE      @G860PSS
&SDNLMGA SETC  '0'                 DCMDNLMA INITIAL VALUE      @G811PSS
&SDLSTLA SETC  '0'                 DCMDLLA  INITIAL VALUE      @G811PSS
&SDLST1A SETC  '0'                 DCMDLL1A INITIAL VALUE      @G811PSS
&SDLSCT  SETC  '0'                 DCMDLSCT INITIAL VALUE      @G811PSS
&SDSCT1  SETC  '0'                 DCMDSCT1 INITIAL VALUE      @G811PSS
&SDLSSCT SETC  '0'                 DCMDSSCT INITIAL VALUE      @G811PSS
.**********************************************************************
.*                                                                    *
.*       VERIFY THE USE PARAMETER                              @G811PSS
.*                                                                    *
.**********************************************************************
         AIF   (('&USE1' EQ 'FC') OR ('&USE1' EQ 'SD') OR ('&USE1' EQ 'X
               MS')).USEOK         IS USE PARAMETER VALID?     @G811PSS
         MNOTE 5,' ''USE'' PARAMETER NOT RECOGNIZED. ''USE=FC'' USED'  X
                                                               @G811PSS
&USE1    SETC  'FC'                SET ERROR DEFAULT           @G811PSS
.USEOK   ANOP                                                  @G811PSS
.**********************************************************************
.*                                                                    *
.*       VERIFY DEVICE AND USE PARAMETER COMBINATIONS          @G811PSS
.*                                                                    *
.**********************************************************************
         AIF   (('&DEVICE1' NE 'B') OR ('&USE1' EQ 'FC')).OK2250       X
                                   2250 DEVICE MUST BE FULL CAPABILITY X
                                                               @G811PSS
         MNOTE 5,' A 2250 DEVICE CAN BE ONLY FULL CAPABILITY. ''USE=FC'X
               ' USED'                                         @G811PSS
&USE1    SETC  'FC'                SET ERROR DEFAULT           @G811PSS
         AGO   .TESTDEV                                        @G811PSS
.OK2250  ANOP                                                  @G811PSS
         AIF   (('&DEVICE1' NE 'E') OR ('&USE1' EQ 'MS')).TESTDEV      X
                                   3277/3278 MOD 1 MUST BE ONLY        X
                                   MESSAGE STREAM              @G811PSS
         MNOTE 5,' A 3277/3278 MODEL 1 DEVICE CAN BE ONLY MESSAGE STREAX
               M. ''USE=MS'' USED'                             @G811PSS
&USE1    SETC  'MS'                SET ERROR DEFAULT           @G811PSS
.TESTDEV ANOP                                                  @G811PSS
.**********************************************************************
.*                                                                    *
.*       TEST FOR TYPE OF DEVICE AND PROCESS IT                @G811PSS
.*                                                                    *
.**********************************************************************
         AIF   ('&DEVICE1' EQ 'ALL').ALL
&LSTSSCT SETC  'DCMSECED'                 SET LAST SSCT VALUE FOR ANY  X
                                          DEVICE TYPE
         AIF   ('&DEVICE1' EQ 'B').FC50
         AIF   ('&DEVICE1' EQ 'C').TST60
         AIF   ('&DEVICE1' EQ 'D').D3270  3277-2               @G811PSS
         AIF   ('&DEVICE1' EQ 'E').D3270  3277-1/3278-1        @G811PSS
         AIF   ('&DEVICE1' EQ 'F').D3270  3278-2/3279-2A       @G860PSS
         AIF   ('&DEVICE1' EQ 'G').D3270  3278-3/3279-3A       @G860PSS
         AIF   ('&DEVICE1' EQ 'H').D3270  3278-4               @G811PSS
         AIF   ('&DEVICE1' EQ 'I').D3270  3278-2A/3279-2C          @T1C
         AIF   ('&DEVICE1' EQ 'J').D3270  3279-2B              @G860PSS
         AIF   ('&DEVICE1' EQ 'K').D3270  3279-3B              @G860PSS
.**********************************************************************
.*                                                                    *
.*       DEVICE TYPE NOT RECOGNIZED - ERROR                    @G811PSS
.*                                                                    *
.**********************************************************************
         MNOTE 5,' ''DEVICE'' PARAMETER NOT RECOGNIZED. ''DEVICE=H'' USX
               ED'                                             @G811PSS
&DEVICE1 SETC  'H'                SET ERROR DEFAULT            @G811PSS
.D3270   ANOP                                                  @G811PSS
.**********************************************************************
.*                                                                    *
.*       DEVICE IS A 3270 TYPE (3277, 3278, OR 3279)               @T1C
.*                                                                    *
.*       INITIALIZE COMMON VARIABLES                           @G811PSS
.*                                                                    *
.**********************************************************************
&QQ      SETA  16                  DCMIORTN VALUE             MB Y02958
&W       SETC  '7D6E00'            DCMASKEN INITIAL VALUE
&Z       SETC  '7EF070C0406D'      DCMASKEN INITIAL VALUE      @G811PSS
&AIDS    SETC  '6C6B'              DCMASKEN INITIAL VALUE      @G811PSS
         AIF   ('&DEVICE1' NE 'E').TST77
***********************************************************************
*                                                                     *
*        DEVICE IS A 3277/3278 MODEL 1 IN MESSAGE STREAM MODE  @G811PSS
*                                                                     *
***********************************************************************
.*                                                                    *
.*       INITIALIZE VARIABLES FOR 3277-1/3278-1 USE=MS         @G811PSS
.*                                                                    *
.**********************************************************************
&D       SETC  '38'                DCMLGNTH INITIAL VALUE
&E       SETC  '35'                DCMAXLGN INITIAL VALUE
&F       SETC  '11'                DCMMSGAL INITIAL VALUE
&G       SETC  '44'                DCMCORLN INITIAL VALUE
&H       SETC  '5'                 DCMSEG INITIAL VALUE
&K       SETC  '11'                DCMRNUM INITIAL VALUE
&L       SETC  '15'                DCMRTME INITIAL VALUE
&M       SETC  '5'                 DCMSEGDF INITIAL VALUE
&N       SETC  '11'                DCMRNUMD INITIAL VALUE
&P       SETC  '15'                DCMRTMED INITIAL VALUE
&BB      SETA  11                  NUMBER DOM ENTRIES
&CC      SETA  11                  ORG VALUE FOR SCT AND SSCT
&DD      SETA  11                  NUMBER SCT AND SSCT ENTRIES
&SCRNWD  SETC  '40'                DCMSCRW INITIAL VALUE       @G860PSS
         AGO   .START
.TST77   ANOP                                                  @G811PSS
&SDSCT1 SETC   'DCMMSGED'        SCT FOR LAST LINE + 1                 X
                                 FOR SD MODE                   @G811PSS
&SDLSSCT SETC  'DCMSECED'        SSCT FOR LAST LINE + 1                X
                                 FOR SD MODE                   @G811PSS
         AIF   ('&USE1' NE 'FC').SKP1 TEST FOR OUTPUT ONLY     @G811PSS
&FCLSTLA SETC  'DCMMLAST'          DCMFLLA  INITIAL VALUE      @G811PSS
&FCENTY2 SETC  'DCMENTR2'          DCMFENT2 INITIAL VALUE      @G811PSS
.SKP1    AIF   ('&DEVICE1' NE 'D').TST78  TEST FOR 3277-2      @G811PSS
.**********************************************************************
.*                                                                    *
.*       DEVICE IS A 3277 MODEL 2. INITIALIZE COMMON MODE      @G811PSS
.*       VARIABLES.                                                   *
.*                                                                    *
.**********************************************************************
&BB      SETA  23                  NUMBER OF DOM ENTRIES
&DD      SETA  23                  NUMBER OF SCT AND SSCT ENTRIES
&L       SETC  '46'                DCMRTME INITIAL VALUE
&P       SETC  '46'                DCMRTMED INITIAL VALUE
&ENDLNUM SETA  19                  LINE NUM OF INSTR LINE - 1  @G811PSS
&PFKSBA  SETC  '11'                SET BUFFER ADDR VALUE       @G811PSS
&PFKLNAD SETC  'D7F0'              ADDR OF PFK LINE IN ROW-COLUMN      X
                                   FORMAT                      @G811PSS
&SBAWARN SETC  '115CF01DE840'      WARNING LINE SBA-A1-A2-SF-ATT       X
                                   (PROT,INTEN,DETECT)         @G811PSS
&MSNLMGA SETC  '23'                NUMBER LINES IN MSG AREA FOR        X
                                   MS MODE                     @G811PSS
&MSLSTLA SETC  'DCMENTR2'          LAST LINE IN MSG AREA FOR           X
                                   MS MODE                     @G811PSS
&MSLST1A SETC  'DCMWARN'           LAST LINE + 1 IN MSG AREA FOR       X
                                   MS MODE                     @G811PSS
&MSLSCT  SETC  'DCMMSG23'          SCT FOR LAST LINE FOR               X
                                   MS MODE                     @G811PSS
&MSSCT1 SETC   'DCMMSGED'          SCT FOR LAST LINE + 1 FOR           X
                                   MS MODE                     @G811PSS
&MSLSSCT SETC  'DCMSECED'          SSCT FOR LAST LINE + 1 FOR          X
                                   MS MODE                     @G811PSS
&SDNLMGA SETC  '23'                NUMBER LINES IN MSG AREA            X
                                   FOR SD MODE                 @G811PSS
&SDLSCT  SETC  'DCMMSG23'          SCT FOR LAST LINE FOR               X
                                   SD MODE                     @G811PSS
&SDLSTLA SETC  'DCMENTR2'          LAST LINE IN MSG AREA FOR           X
                                   SD MODE                     @G811PSS
&SDLST1A SETC  'DCMWARN'           LAST LINE + 1 IN MSG AREA FOR       X
                                   SD MODE                     @G811PSS
         AIF   ('&USE1' NE 'FC').OPO77                         @G811PSS
***********************************************************************
*                                                                     *
*        DEVICE IS A 3277 MODEL 2 IN FULL CAPABILITY MODE      @G811PSS
*                                                                     *
***********************************************************************
&A       SETC  'DCMBLNK1'          DCMWTINT INITIAL VALUE
&C       SETC  'DCMBLNK1'          DCMWTBUF INITIAL VALUE
&F       SETC  '19'                DCMMSGAL INITIAL VALUE
&H       SETC  '9'                 DCMSEG INITIAL VALUE
&K       SETC  '19'                DCMRNUM INITIAL VALUE
&M       SETC  '9'                 DCMSEGDF INITIAL VALUE
&N       SETC  '19'                DCMRNUMD INITIAL VALUE
&X       SETC  'DCMPFKAR'          DCMPFKLN INITIAL VALUE
&CC      SETA  19                  ORG VALUE FOR SCT AND SSCT
&FCNLMGA SETC  '19'                NUMBER LINES IN MSG AREA FOR        X
                                   FC MODE                     @G811PSS
&FCLST1A SETC  'DCMBLNK1'          LAST LINE + 1 IN MSG AREA FOR FC    X
                                   MODE                        @G811PSS
&FCLSCT  SETC  'DCMMSG19'          SCT FOR LAST LINE FOR               X
                                   FC MODE                     @G811PSS
&FCSCT1 SETC   'DCMMSG20'          SCT FOR LAST LINE + 1 FOR FC        X
                                   MODE                        @G811PSS
&FCLSSCT SETC  'DCMSEC20'          SSCT FOR LAST LINE + 1 FOR FC       X
                                   MODE                        @G811PSS
&FCEN2RC SETC  '5B60'              ADDR OF 2ND LINE OF ENTRY AREA WHEN X
                                   IN FULL CAP MODE            @G811PSS
&INSTRLN SETC  '19'                DCMINLNM INITIAL VALUE      @G860PSS
&SBAINST SETC  '11D9401D6040'      INSTRUCTION LINE SBA-A1-A2-SF-ATT   X
                                   (PROT,NON-DETECT)           @G811PSS
&SBAENT1 SETC  '115A50401DC4'      1ST LINE IN ENTRY AREA              X
                                   SBA-A1-A2-BLANK DATA-SF-ATT         X
                                   (UNPROT,DETECT)             @G811PSS
&SBAENT2 SETC  '404040404040'      2ND LINE IN ENTRY AREA DUMMY ORDERS X
                                                               @G811PSS
&ENTLNE1 SETC  '21'                LINE NUMBER -1 OF ENTRY             X
                                   AREA                        @G811PSS
&ENTLNE2 SETC  '22'                2ND LINE OF ENTRY AREA -1   @G811PSS
&ENTYPOS SETC  '1681'              OFFSET OF ENTRY AREA        @G811PSS
         AGO   .START
.OPO77   ANOP                                                  @G811PSS
.**********************************************************************
.*                                                                    *
.*       DEVICE IS AN OUTPUT ONLY 3277 MODEL 2. INITIALIZE     @G811PSS
.*       COMMON OUTPUT ONLY VARIABLES                          @G811PSS
.*                                                                    *
.**********************************************************************
&CC      SETA   23                 ORG VALUE FOR SCT AND SSCT  @G811PSS
&F       SETC  '23'                NUMBER LINES IN MSG AREA    @G811PSS
&H       SETC  '11'                INITIAL SEGMENT VALUE       @G811PSS
&K       SETC  '23'                INITIAL ROLL NUMBER VALUE   @G811PSS
&M       SETC  '11'                INITIAL SEGMENT DEFAULT     @G811PSS
&N       SETC  '23'                INITIAL ROLL NUMBER DEFAULT @G811PSS
&SBAINST SETC  '11D9401DE440'      INSTRUCTION LINE SBA-A1-A2-SF-ATT   X
                                   (PROT, DETECT)              @G811PSS
&SBAENT1 SETC  '115A501DE440'      1ST LINE IN ENTRY AREA              X
                                   SBA-A1-A2-SF-ATT (PROT,DETECT)      X
                                                               @G811PSS
&SBAENT2 SETC  '115B601DE440'      2ND LINE IN ENTRY AREA              X
                                   SBA-A1-A2-SF-ATT (PROT,DETECT)      X
                                                               @G811PSS
         AIF   ('&USE1' NE 'SD').MS772 TEST FOR SD MODE        @G811PSS
***********************************************************************
*                                                                     *
*        DEVICE IS A 3277 MODEL 2 IN STATUS DISPLAY MODE       @G811PSS
*                                                                     *
***********************************************************************
         AGO   .START
.MS772   ANOP
***********************************************************************
*                                                                     *
*        DEVICE IS A 3277 MODEL 2 IN MESSAGE STREAM MODE       @G811PSS
*                                                                     *
***********************************************************************
         AGO   .START
.TST78   ANOP                                                  @G811PSS
.**********************************************************************
.*                                                                    *
.*       DEVICE IS A 3278 OR A 3279. INITIALIZE COMMON         @G811PSS
.*       VARIABLES                                             @G811PSS
.*                                                                    *
.**********************************************************************
&V       SETC  '0D'              DCMIOUNQ INITIAL VALUE        @G811PSS
         AIF   ('&USE1' NE 'FC').SKP2 TEST FOR OUTPUT ONLY     @G811PSS
&FCLST1A SETC  'DCMINSTR'        LAST LINE + 1 IN MSG AREA             X
                                 FOR FC MODE                   @G811PSS
.SKP2    ANOP                                                  @G811PSS
&MSLSTLA SETC  'DCMENTR2'        LAST LINE IN MSG AREA                 X
                                 FOR MS MODE                   @G811PSS
&MSLST1A SETC  'DCMWARN'         LAST LINE + 1 IN MSG AREA             X
                                 FOR MS MODE                   @G811PSS
&SDLSTLA SETC  'DCMWARN'         LAST LINE IN MSG AREA                 X
                                 FOR SD MODE                   @G811PSS
&SDLST1A SETC  'DCMLNEND'        LAST LINE + 1 IN MSG AREA             X
                                 FOR SD MODE                   @G811PSS
         AIF   ('&DEVICE1' EQ 'F').D32782 A 3278-2 OR 3279-2A? @G860PSS
         AIF   ('&DEVICE1' NE 'J').TST782A A 3279-2B?          @G860PSS
.**********************************************************************
.*                                                                    *
.*       DEVICE IS A 3278 MODEL 2 OR A 3279 MODEL 2A OR 2B     @G811PSS
.*                                                                    *
.**********************************************************************
.D32782  ANOP                                                  @G860PSS
         AIF   ('&DEVICE1' NE 'J').SETCOR1 A 3279-2B?          @G860PSS
&G       SETC  '90'               YES, SET DCMCORLN VALUE      @G860PSS
&ADJORD  SETC  'DCMEXOD1'         SET DCMAEORD VALUE           @G860PSS
.SETCOR1 ANOP                                                  @G860PSS
&BB      SETA  24                 NUMBER OF DOM ID ENTRIES     @G811PSS
&DD      SETA  24                 NUMBER SCT AND SSCT ENTRIES  @G811PSS
&ENDLNUM SETA  19                 LINE NUM OF INSTR LINE - 2   @G811PSS
&SBAWARN SETC  '115CF01DE840'     WARNING LINE SBA-A1-A2-SF-ATT        X
                                  (PROT,INTEN,DETECT)          @G811PSS
&MSNLMGA SETC  '23'               NUMBER OF LINES IN MSG AREA          X
                                  FOR MS MODE                  @G811PSS
&MSLSCT  SETC  'DCMMSG23'         SCT FOR LAST LINE FOR                X
                                  MS MODE                      @G811PSS
&MSSCT1 SETC   'DCMMSG24'         SCT FOR LAST LINE + 1                X
                                  FOR MS MODE                  @G811PSS
&MSLSSCT SETC  'DCMSEC24'         SSCT FOR LAST LINE + 1               X
                                  FOR MS MODE                  @G811PSS
&SDLSCT  SETC  'DCMMSG24'         SCT FOR LAST LINE FOR                X
                                  SD MODE                      @G811PSS
&SDNLMGA SETC  '24'               NUMBER OF LINES IN MSG AREA          X
                                  FOR SD MODE                  @G811PSS
         AIF   ('&USE1' NE 'FC').OPO782 TEST FOR FULL CAP      @G811PSS
         AIF   ('&DEVICE1' EQ 'J').SKP2BF 3279-2B              @G860PSS
***********************************************************************
*                                                                     *
*        DEVICE IS A 3278 MODEL 2 OR A 3279 MODEL 2A IN        @G860PSS
*        FULL CAPABILITY MODE                                  @G811PSS
*                                                                     *
***********************************************************************
         AGO   .SKP2BFA                                        @G860PSS
.SKP2BF  ANOP                                                  @G860PSS
***********************************************************************
*                                                                     *
*        DEVICE IS A 3279 MODEL 2B IN FULL CAPABILITY MODE     @G860PSS
*                                                                     *
***********************************************************************
.SKP2BFA ANOP                                                  @G860PSS
&CC      SETA  20                  ORG VALUE FOR SCT AND SSCT  @G811PSS
&A       SETC  'DCMINSTR'          LAST LINE + 1 IN MSG AREA   @G811PSS
&C       SETC  'DCMINSTR'          LAST LINE + 1 IN MSG AREA   @G811PSS
&F       SETC  '20'                NUMBER LINES IN MSG AREA    @G811PSS
&H       SETC  '10'                INITIAL SEGMENT VALUE       @G811PSS
&K       SETC  '20'                INITIAL ROLL NUMBER VALUE   @G811PSS
&L       SETC  '40'                INITIAL ROLL TIME VALUE     @G811PSS
&M       SETC  '10'                DEFAULT SEGMENT VALUE       @G811PSS
&N       SETC  '20'                DEFAULT ROLL NUMBER VALUE   @G811PSS
&P       SETC  '40'                DEFAULT ROLL TIME VALUE     @G811PSS
&ENTLNE1 SETC  '21'                LINE NUMBER -1 OF ENTRY             X
                                   AREA                        @G811PSS
&ENTLNE2 SETC  '22'                LINE NUMBER -1 OF 2ND LINE IN       X
                                   ENTRY AREA                  @G811PSS
&ENTYPOS SETC  '1681'              OFFSET OF 1ST CHAR IN ENTRY AREA    X
                                                               @G811PSS
&FCNLMGA SETC  '20'               NUMBER OF LINES IN MSG AREA          X
                                  FOR FC MODE                  @G811PSS
&FCLSCT  SETC  'DCMMSG20'         SCT FOR LAST LINE FOR                X
                                  FC MODE                      @G811PSS
&FCSCT1 SETC   'DCMMSG21'         SCT FOR LAST LINE +1                 X
                                  FOR FC MODE                  @G811PSS
&FCLSSCT SETC  'DCMSEC21'         SSCT FOR LAST LINE + 1               X
                                  FOR FC MODE                  @G811PSS
&INSTRLN SETC  '20'               DCMINLNM INITIAL VALUE       @G860PSS
&FCEN2RC SETC  '5B60'             ADDR OF 2ND LINE OF ENTRY AREA       X
                                                               @G811PSS
&SBAINST SETC  '11D9401D6040'      INSTRUCTION LINE SBA-A1-A2-SF-ATT   X
                                   (PROT,NON-DETECT)           @G811PSS
&SBAENT1 SETC  '115A50401DC4'      1ST LINE IN ENTRY AREA              X
                                   SBA-A1-A2-BLANK DATA-SF-ATT         X
                                   (UNPROT,DETECT)             @G811PSS
&SBAENT2 SETC  '404040404040'      2ND LINE IN ENTRY AREA DUMMY ORDERS X
                                                               @G811PSS
         AIF   ('&DEVICE1' NE 'J').START  CHECK FOR A 3279-2B  @G860PSS
&SBAINST SETC  '11D9402903C06042F4410040' INSTRUCTION LINE ORDERS      X
                                                               @G860PSS
&SBAENT1 SETC  '115A50402903C04042F44100' FIRST LINE IN ENTRY AREA     X
                                                               @G860PSS
&SBAENT2 SETC  '404040404040404040404040' SECOND LINE IN ENTRY AREA.   X
                                                               @G860PSS
&SBAWARN SETC  '115CF02903C06042F4410040' WARNING LINE ORDERS  @G860PSS
         AGO   .START                                          @G811PSS
.OPO782  ANOP                                                  @G811PSS
.**********************************************************************
.*                                                                    *
.*       DEVICE IS AN OUTPUT ONLY 3278 MODEL 2 OR A            @G811PSS
.*       3279 MODEL 2A OR 2B.                                  @G811PSS
.*       INITIALIZE COMMON OUTPUT ONLY VARIABLES               @G811PSS
.*                                                                    *
.**********************************************************************
&SBAINST SETC  '11D9401DE440'      INSTRUCTION LINE SBA-A1-A2-SF-ATT   X
                                   (PROT,DETECT)               @G811PSS
&SBAENT1 SETC  '115A501DE440'      1ST LINE IN ENTRY AREA              X
                                   SBA-A1-A2-SF-ATT (PROT,DETECT)      X
                                                               @G811PSS
&SBAENT2 SETC  '115B601DE440'      2ND LINE IN ENTRY AREA              X
                                   SBA-A1-A2-SF-ATT (PROT,DETECT)      X
                                                               @G811PSS
         AIF   ('&DEVICE1' NE 'J').CKUSE2 CHECK FOR A 3279-2B  @G860PSS
&SBAINST SETC  '11D9402903C0E442F4410040' INSTRUCTION LINE ORDERS      X
                                                               @G860PSS
&SBAENT1 SETC  '115A502903C0E442F4410040' FIRST LINE IN ENTRY AREA     X
                                                               @G860PSS
&SBAENT2 SETC  '115B602903C0E442F4410040' SECOND LINE IN ENTRY AREA.   X
                                                               @G860PSS
&SBAWARN SETC  '115CF02903C06042F4410040' WARNING LINE ORDERS  @G860PSS
.CKUSE2  ANOP                                                  @G860PSS
         AIF   ('&USE1' NE 'SD').MS782 TEST FOR SD MODE        @G811PSS
         AIF   ('&DEVICE1' EQ 'J').SKP2BS 3279-2B              @G860PSS
***********************************************************************
*                                                                     *
*        DEVICE IS A 3278 MODEL 2 OR A 3279 MODEL 2A IN        @G860PSS
*        STATUS DISPLAY MODE                                   @G811PSS
*                                                                     *
***********************************************************************
         AGO   .SKP2BSA                                        @G860PSS
.SKP2BS  ANOP                                                  @G860PSS
***********************************************************************
*                                                                     *
*        DEVICE IS A 3279 MODEL 2B IN STATUS DISPLAY MODE      @G860PSS
*                                                                     *
***********************************************************************
.SKP2BSA ANOP                                                  @G860PSS
&CC      SETA  24                  ORG VALUE FOR SCT AND SSCT  @G811PSS
&A       SETC  'DCMLNEND'          LAST LINE + 1 IN MSG AREA   @G811PSS
&C       SETC  'DCMLNEND'          LAST LINE + 1 IN MSG AREA   @G811PSS
&F       SETC  '24'                NUMBER LINES IN MSG AREA    @G811PSS
&H       SETC  '12'                INITIAL SEGMENT VALUE       @G811PSS
&K       SETC  '24'                INITIAL ROLL NUMBER VALUE   @G811PSS
&L       SETC  '48'                INITIAL ROLL TIME VALUE     @G811PSS
&M       SETC  '12'                DEFAULT SEGMENT VALUE       @G811PSS
&N       SETC  '24'                DEFAULT ROLL NUMBER VALUE   @G811PSS
&P       SETC  '48'                DEFAULT ROLL TIME VALUE     @G811PSS
&SBAWARN SETC  '115CF01DE440'      WARNING LINE SBA-A1-A2-SF-ATT       X
                                   (PROT,DETECT)               @G811PSS
         AIF   ('&DEVICE1' NE 'J').START  CHECK FOR A 3279-2B  @G860PSS
&SBAWARN SETC  '115CF02903C0E442F4410040' WARNING LINE ORDERS  @G860PSS
         AGO   .START                                          @G811PSS
.MS782   ANOP                                                  @G811PSS
         AIF   ('&DEVICE1' EQ 'J').SKP2BM 3279-2B              @G860PSS
***********************************************************************
*                                                                     *
*        DEVICE IS A 3278 MODEL 2 OR A 3279 MODEL 2A IN        @G860PSS
*        MESSAGE STREAM MODE                                   @G811PSS
*                                                                     *
***********************************************************************
         AGO   .SKP2BMA                                        @G860PSS
.SKP2BM  ANOP                                                  @G860PSS
***********************************************************************
*                                                                     *
*        DEVICE IS A 3279 MODEL 2B IN MESSAGE STREAM MODE      @G860PSS
*                                                                     *
***********************************************************************
.SKP2BMA ANOP                                                  @G860PSS
&CC      SETA  23                  ORG VALUE FOR SCT AND SSCT  @G811PSS
&F       SETC  '23'                NUMBER LINES IN MSG AREA    @G811PSS
&H       SETC  '11'                INITIAL SEGMENT VALUE       @G811PSS
&K       SETC  '23'                INITIAL ROLL NUMBER VALUE   @G811PSS
&L       SETC  '46'                INITIAL ROLL TIME VALUE     @G811PSS
&M       SETC  '11'                DEFAULT SEGMENT VALUE       @G811PSS
&N       SETC  '23'                DEFAULT ROLL NUMBER VALUE   @G811PSS
&P       SETC  '46'                DEFAULT ROLL TIME VALUE     @G811PSS
         AGO   .START                                          @G811PSS
.TST782A AIF   ('&DEVICE1' NE 'I').TST783 TEST FOR 3278-2A OR          X
                                          3279-2C                  @T1C
.**********************************************************************
.*                                                                    *
.*       DEVICE IS A 3278 MODEL 2A OR A 3279 MODEL 2C              @T1C
.*                                                                    *
.**********************************************************************
&V       SETC  '0C'               DCMIOUNQ INITIAL VALUE       @G811PSS
&BB      SETA  20                 NUMBER OF DOM ID ENTRIES     @G811PSS
&DD      SETA  20                 NUMBER SCT AND SSCT ENTRIES  @G811PSS
&ENDLNUM SETA  15                 LINE NUM OF INSTR LINE - 2   @G811PSS
&SBAWARN SETC  '11D7F01DE840'     WARNING LINE SBA-A1-A2-SF-ATT        X
                                  (PROT,INTEN,DETECT)          @G811PSS
&MSNLMGA SETC  '19'               NUMBER OF LINES IN MSG AREA          X
                                  FOR MS MODE                  @G811PSS
&MSLSCT  SETC  'DCMMSG19'         SCT FOR LAST LINE FOR                X
                                  MS MODE                      @G811PSS
&MSSCT1 SETC   'DCMMSG20'         SCT FOR LAST LINE + 1                X
                                  FOR MS MODE                  @G811PSS
&MSLSSCT SETC  'DCMSEC20'         SSCT FOR LAST LINE + 1               X
                                  FOR MS MODE                  @G811PSS
&SDLSCT  SETC  'DCMMSG20'         SCT FOR LAST LINE FOR                X
                                  SD MODE                      @G811PSS
&SDNLMGA SETC  '20'               NUMBER OF LINES IN MSG AREA          X
                                  FOR SD MODE                  @G811PSS
         AIF   ('&USE1' NE 'FC').OPO782A TEST FOR FULL CAP     @G811PSS
***********************************************************************
*                                                                     *
*        DEVICE IS A 3278 MODEL 2A OR A 3279 MODEL 2C IN FULL      @T1C
*        CAPABILITY MODE                                           @T1C
*                                                                     *
***********************************************************************
&CC      SETA  16                  ORG VALUE FOR SCT AND SSCT  @G811PSS
&A       SETC  'DCMINSTR'          LAST LINE + 1 IN MSG AREA   @G811PSS
&C       SETC  'DCMINSTR'          LAST LINE + 1 IN MSG AREA   @G811PSS
&F       SETC  '16'                NUMBER LINES IN MSG AREA    @G811PSS
&H       SETC  '8'                 INITIAL SEGMENT VALUE       @G811PSS
&K       SETC  '16'                INITIAL ROLL NUMBER VALUE   @G811PSS
&L       SETC  '32'                INITIAL ROLL TIME VALUE     @G811PSS
&M       SETC  '8'                 DEFAULT SEGMENT VALUE       @G811PSS
&N       SETC  '16'                DEFAULT ROLL NUMBER VALUE   @G811PSS
&P       SETC  '32'                DEFAULT ROLL TIME VALUE     @G811PSS
&ENTLNE1 SETC  '17'                LINE NUMBER -1 OF ENTRY             X
                                   AREA                        @G811PSS
&ENTLNE2 SETC  '18'                LINE NUMBER -1 OF 2ND LINE IN       X
                                   ENTRY AREA                  @G811PSS
&ENTYPOS SETC  '1361'              OFFSET OF 1ST CHAR IN ENTRY AREA    X
                                                               @G811PSS
&FCNLMGA SETC  '16'               NUMBER OF LINES IN MSG AREA          X
                                  FOR FC MODE                  @G811PSS
&FCLSCT  SETC  'DCMMSG16'         SCT FOR LAST LINE FOR                X
                                  FC MODE                      @G811PSS
&FCSCT1 SETC   'DCMMSG17'         SCT FOR LAST LINE +1                 X
                                  FOR FC MODE                  @G811PSS
&FCLSSCT SETC  'DCMSEC17'         SSCT FOR LAST LINE + 1               X
                                  FOR FC MODE                  @G811PSS
&FCEN2RC SETC  'D660'             ADDR OF 2ND LINE OF ENTRY AREA       X
                                                               @G811PSS
&INSTRLN SETC  '16'               DCMINLNM INITIAL VALUE       @G860PSS
&SBAINST SETC  '11D4401D6040'      INSTRUCTION LINE SBA-A1-A2-SF-ATT   X
                                   (PROT,NON-DETECT)           @G811PSS
&SBAENT1 SETC  '11D550401DC4'      1ST LINE IN ENTRY AREA              X
                                   SBA-A1-A2-BLANK DATA-SF-ATT         X
                                   (UNPROT,DETECT)             @G811PSS
&SBAENT2 SETC  '404040404040'      2ND LINE IN ENTRY AREA DUMMY ORDERS X
                                                               @G811PSS
         AGO   .START                                          @G811PSS
.OPO782A ANOP                                                  @G811PSS
.**********************************************************************
.*                                                                    *
.*       DEVICE IS AN OUTPUT ONLY 3278 MODEL 2A OR 3279 MODEL 2C.  @T1C
.*       INITIALIZE COMMON OUTPUT ONLY VARIABLES               @G811PSS
.*                                                                    *
.**********************************************************************
&SBAINST SETC  '11D4401DE440'      INSTRUCTION LINE SBA-A1-A2-SF-ATT   X
                                   (PROT,DETECT)               @G811PSS
&SBAENT1 SETC  '11D5501DE440'      1ST LINE IN ENTRY AREA              X
                                   SBA-A1-A2-SF-ATT (PROT,DETECT)      X
                                                               @G811PSS
&SBAENT2 SETC  '11D6601DE440'      2ND LINE IN ENTRY AREA              X
                                   SBA-A1-A2-SF-ATT (PROT,DETECT)      X
                                                               @G811PSS
         AIF   ('&USE1' NE 'SD').MS782A TEST FOR SD MODE       @G811PSS
***********************************************************************
*                                                                     *
*        DEVICE IS A 3278 MODEL 2A OR A 3279 MODEL 2C IN STATUS    @T1C
*        DISPLAY MODE                                              @T1C
*                                                                     *
***********************************************************************
&CC      SETA  20                  ORG VALUE FOR SCT AND SSCT  @G811PSS
&A       SETC  'DCMLNEND'          LAST LINE + 1 IN MSG AREA   @G811PSS
&C       SETC  'DCMLNEND'          LAST LINE + 1 IN MSG AREA   @G811PSS
&F       SETC  '20'                NUMBER LINES IN MSG AREA    @G811PSS
&H       SETC  '10'                INITIAL SEGMENT VALUE       @G811PSS
&K       SETC  '20'                INITIAL ROLL NUMBER VALUE   @G811PSS
&L       SETC  '40'                INITIAL ROLL TIME VALUE     @G811PSS
&M       SETC  '10'                DEFAULT SEGMENT VALUE       @G811PSS
&N       SETC  '20'                DEFAULT ROLL NUMBER VALUE   @G811PSS
&P       SETC  '40'                DEFAULT ROLL TIME VALUE     @G811PSS
&SBAWARN SETC  '11D7F01DE440'      WARNING LINE SBA-A1-A2-SF-ATT       X
                                   (PROT,DETECT)               @G811PSS
         AGO   .START                                          @G811PSS
.MS782A  ANOP                                                  @G811PSS
***********************************************************************
*                                                                     *
*        DEVICE IS A 3278 MODEL 2A OR A 3279 MODEL 2C IN MESSAGE   @T1C
*        STREAM MODE                                               @T1C
*                                                                     *
***********************************************************************
&CC      SETA  19                  ORG VALUE FOR SCT AND SSCT  @G811PSS
&F       SETC  '19'                NUMBER LINES IN MSG AREA    @G811PSS
&H       SETC  '9'                 INITIAL SEGMENT VALUE       @G811PSS
&K       SETC  '19'                INITIAL ROLL NUMBER VALUE   @G811PSS
&L       SETC  '38'                INITIAL ROLL TIME VALUE     @G811PSS
&M       SETC  '9'                 DEFAULT SEGMENT VALUE       @G811PSS
&N       SETC  '19'                DEFAULT ROLL NUMBER VALUE   @G811PSS
&P       SETC  '38'                DEFAULT ROLL TIME VALUE     @G811PSS
         AGO   .START                                          @G811PSS
.TST783  AIF   ('&DEVICE1' EQ 'G').D32783 A 3278-3 OR 3279-3A? @G860PSS
         AIF   ('&DEVICE1' NE 'K').TST784 A 3279-3B?           @G860PSS
.**********************************************************************
.*                                                                    *
.*       DEVICE IS A 3278 MODEL 3 OR A 3279 MODEL 3A OR 3B     @G811PSS
.*                                                                    *
.**********************************************************************
.D32783  ANOP                                                  @G860PSS
         AIF   ('&DEVICE1' NE 'K').SETCOR2 A 3279-3B?          @G860PSS
&G       SETC  '90'               YES, SET DCMCORLN VALUE      @G860PSS
&ADJORD  SETC  'DCMEXOD1'         SET DCMAEORD VALUE           @G860PSS
.SETCOR2 ANOP                                                  @G860PSS
&BB      SETA  32                  NUMBER OF DOM ID ENTRIES    @G811PSS
&DD      SETA  32                  NUMBER SCT AND SSCT ENTRIES @G811PSS
&ENDLNUM SETA  27                  LINE NUM OF INSTR LINE - 2  @G811PSS
&SBAWARN SETC  '11E6F01DE840'      WARNING LINE SBA-A1-A2-SF-ATT       X
                                   (PROT,INTEN,DETECT)         @G811PSS
&MSNLMGA SETC  '31'                NUMBER OF LINES IN MSG AREA         X
                                   FOR MS MODE                 @G811PSS
&MSLSCT  SETC  'DCMMSG31'          SCT FOR LAST LINE FOR               X
                                   MS MODE                     @G811PSS
&MSSCT1 SETC   'DCMMSG32'          SCT FOR LAST LINE + 1               X
                                   FOR MS MODE                 @G811PSS
&MSLSSCT SETC  'DCMSEC32'          SSCT FOR LAST LINE + 1              X
                                   FOR MS MODE                 @G811PSS
&SDLSCT  SETC  'DCMMSG32'          SCT FOR LAST LINE FOR               X
                                   SD MODE                     @G811PSS
&SDNLMGA SETC  '32'                NUMBER OF LINES IN MSG AREA         X
                                   FOR SD MODE                 @G811PSS
         AIF   ('&USE1' NE 'FC').OPO783 TEST FOR FULL CAP      @G811PSS
         AIF   ('&DEVICE1' EQ 'K').SKP3B  3279-3B?             @G860PSS
***********************************************************************
*                                                                     *
*        DEVICE IS A 3278 MODEL 3 OR A 3279 MODEL 3A IN        @G860PSS
*        FULL CAPABILITY MODE                                  @G811PSS
*                                                                     *
***********************************************************************
         AGO   .SKP3BA                                         @G860PSS
.SKP3B   ANOP                      DEVICE IS A 3279-3B         @G860PSS
***********************************************************************
*                                                                     *
*        DEVICE IS A 3279 MODEL 3B IN FULL CAPABILITY MODE     @G860PSS
*                                                                     *
***********************************************************************
.SKP3BA  ANOP                                                  @G860PSS
&CC      SETA  28                  ORG VALUE FOR SCT AND SSCT  @G811PSS
&A       SETC  'DCMINSTR'          LAST LINE + 1 IN MSG AREA   @G811PSS
&C       SETC  'DCMINSTR'          LAST LINE + 1 IN MSG AREA   @G811PSS
&F       SETC  '28'                NUMBER OF LINES IN MSG AREA @G811PSS
&H       SETC  '14'                INITIAL SEGMENT VALUE       @G811PSS
&K       SETC  '28'                INITIAL ROLL NUMBER VALUE   @G811PSS
&L       SETC  '56'                INITIAL ROLL TIME VALUE     @G811PSS
&M       SETC  '14'                DEFAULT SEGMENT VALUE       @G811PSS
&N       SETC  '28'                DEFAULT ROLL NUMBER VALUE   @G811PSS
&P       SETC  '56'                DEFAULT ROLL TIME VALUE     @G811PSS
&ENTLNE1 SETC  '29'                LINE NUMBER -1 OF ENTRY             X
                                   AREA                        @G811PSS
&ENTLNE2 SETC  '30'                LINE NUMBER -1 OF 2ND LINE IN ENTRY X
                                   AREA                        @G811PSS
&ENTYPOS SETC  '2321'              OFFSET OF 1ST CHAR IN ENTRY AREA    X
                                                               @G811PSS
&FCNLMGA SETC  '28'                NUMBER OF LINES IN MSG AREA         X
                                   FOR FC MODE                 @G811PSS
&FCLSCT  SETC  'DCMMSG28'          SCT FOR LAST LINE FOR               X
                                   FC MODE                     @G811PSS
&FCSCT1 SETC   'DCMMSG29'          SCT FOR LAST LINE + 1               X
                                   FOR FC MODE                 @G811PSS
&FCLSSCT SETC  'DCMSEC29'          SSCT FOR LAST LINE + 1              X
                                   FOR FC MODE                 @G811PSS
&FCEN2RC SETC  'E560'              ADDR OF 2ND LINE OF ENTRY AREA      X
                                                               @G811PSS
&INSTRLN SETC  '28'                DCMINLNM INITIAL VALUE      @G860PSS
&SBAINST SETC  '11E3401D6040'      INSTRUCTION LINE SBA-A1-A2-SF-ATT   X
                                   (PROT,NON-DETECT)           @G811PSS
&SBAENT1 SETC  '11E450401DC4'      1ST LINE IN ENTRY AREA              X
                                   SBA-A1-A2-BLANK DATA-SF-ATT         X
                                   (UNPROT,DETECT)             @G811PSS
&SBAENT2 SETC  '404040404040'      2ND LINE IN ENTRY AREA DUMMY ORDERS X
                                                               @G811PSS
         AIF   ('&DEVICE1' NE 'K').START  CHECK FOR A 3279-3B  @G860PSS
&SBAINST SETC  '11E3402903C06042F4410040' INSTRUCTION LINE ORDERS      X
                                                               @G860PSS
&SBAENT1 SETC  '11E450402903C04042F44100' FIRST LINE IN ENTRY AREA     X
                                                               @G860PSS
&SBAENT2 SETC  '404040404040404040404040' SECOND LINE IN ENTRY AREA.   X
                                          DUMMY ORDERS         @G860PSS
&SBAWARN SETC  '11E6F02903C06042F4410040' WARNING LINE ORDERS  @G860PSS
         AGO   .START                                          @G811PSS
.OPO783  ANOP                                                  @G811PSS
.**********************************************************************
.*                                                                    *
.*       DEVICE IS AN OUTPUT ONLY 3278 MODEL 3 OR A 3279       @G811PSS
.*       MODEL 3A OR 3B                                        @G811PSS
.*       INITIALIZE COMMON OUTPUT ONLY VARIABLES.              @G811PSS
.*                                                                    *
.**********************************************************************
&SBAINST SETC  '11E3401DE440'      INSTRUCTION LINE SBA-A1-A2-SF-ATT   X
                                   (PROT,DETECT)               @G811PSS
&SBAENT1 SETC  '11E4501DE440'      1ST LINE IN ENTRY AREA              X
                                   SBA-A1-A2-SF-ATT (PROT,DETECT)      X
                                                               @G811PSS
&SBAENT2 SETC  '11E5601DE440'      2ND LINE IN ENTRY AREA              X
                                   SBA-A1-A2-SF-ATT (PROT,DETECT)      X
                                                               @G811PSS
         AIF   ('&DEVICE1' NE 'K').CKUSE1 CHECK FOR A 3279-3B  @G860PSS
&SBAINST SETC  '11E3402903C0E442F4410040' INSTRUCTION LINE ORDERS      X
                                                               @G860PSS
&SBAENT1 SETC  '11E4502903C0E442F4410040' FIRST LINE IN ENTRY AREA     X
                                                               @G860PSS
&SBAENT2 SETC  '11E5602903C0E442F4410040' SECOND LINE IN ENTRY AREA.   X
                                                               @G860PSS
&SBAWARN SETC  '11E6F02903C06042F4410040' WARNING LINE ORDERS  @G860PSS
.CKUSE1  ANOP                                                  @G860PSS
         AIF   ('&USE1' NE 'SD').MS783 TEST FOR SD MODE        @G811PSS
         AIF   ('&DEVICE1' EQ 'K').SKP3BS 3279-3B?             @G860PSS
***********************************************************************
*                                                                     *
*        DEVICE IS A 3278 MODEL 3 OR A 3279 MODEL 3A IN        @G860PSS
*        STATUS DISPLAY MODE                                   @G811PSS
*                                                                     *
***********************************************************************
         AGO   .SKP3BSA                                        @G860PSS
.SKP3BS  ANOP                                                  @G860PSS
***********************************************************************
*                                                                     *
*        DEVICE IS A 3279 MODEL 3B IN STATUS DISPLAY MODE      @G860PSS
*                                                                     *
***********************************************************************
.SKP3BSA ANOP                                                  @G860PSS
&CC      SETA  32                  ORG VALUE FOR SCT AND SSCT  @G811PSS
&A       SETC  'DCMLNEND'          LAST LINE + 1 IN MSG AREA   @G811PSS
&C       SETC  'DCMLNEND'          LAST LINE + 1 IN MSG AREA   @G811PSS
&F       SETC  '32'                NUMBER LINES IN MSG AREA    @G811PSS
&H       SETC  '16'                INITIAL SEGMENT VALUE       @G811PSS
&K       SETC  '32'                INITIAL ROLL NUMBER VALUE   @G811PSS
&L       SETC  '64'                INITIAL ROLL TIME VALUE     @G811PSS
&M       SETC  '16'                DEFAULT SEGMENT VALUE       @G811PSS
&N       SETC  '32'                DEFAULT ROLL NUMBER VALUE   @G811PSS
&P       SETC  '64'                DEFAULT ROLL TIME VALUE     @G811PSS
&SBAWARN SETC  '11E6F01DE440'      WARNING LINE SBA-A1-A2-SF-ATT       X
                                   (PROT,DETECT)               @G811PSS
         AIF   ('&DEVICE1' NE 'K').START  CHECK FOR A 3279-3B  @G860PSS
&SBAWARN SETC  '11E6F02903C0E442F4410040' WARNING LINE ORDERS  @G860PSS
         AGO   .START                                          @G811PSS
.MS783   ANOP                                                  @G811PSS
         AIF   ('&DEVICE1' EQ 'K').SKP3BM 3279-3B?             @G860PSS
***********************************************************************
*                                                                     *
*        DEVICE IS A 3278 MODEL 3 OR A 3279 MODEL 3A IN        @G860PSS
*        MESSAGE STREAM MODE                                   @G811PSS
*                                                                     *
***********************************************************************
         AGO   .SKP3BMA                                        @G860PSS
.SKP3BM  ANOP                                                  @G860PSS
***********************************************************************
*                                                                     *
*        DEVICE IS A 3279 MODEL 3B IN MESSAGE STREAM MODE      @G860PSS
*                                                                     *
***********************************************************************
.SKP3BMA ANOP                                                  @G860PSS
&CC      SETA  31                  ORG VALUE FOR SCT AND SSCT  @G811PSS
&F       SETC  '31'                NUMBER LINES IN MSG AREA    @G811PSS
&H       SETC  '15'                INITIAL SEGMENT VALUE       @G811PSS
&K       SETC  '31'                INITIAL ROLL NUMBER VALUE   @G811PSS
&L       SETC  '62'                INITIAL ROLL TIME VALUE     @G811PSS
&M       SETC  '15'                DEFAULT SEGMENT VALUE       @G811PSS
&N       SETC  '31'                DEFAULT ROLL NUMBER VALUE   @G811PSS
&P       SETC  '62'                DEFAULT ROLL TIME VALUE     @G811PSS
         AGO   .START                                          @G811PSS
.TST784  ANOP                                                  @G811PSS
.**********************************************************************
.*                                                                    *
.*       DEVICE IS A 3278 MODEL 4                              @G811PSS
.*                                                                    *
.**********************************************************************
&BB      SETA  43                  NUMBER OF DOM ID ENTRIES    @G811PSS
&DD      SETA  43                  NUMBER SCT AND SSCT ENTRIES @G811PSS
&ENDLNUM SETA  38                  LINE NUM OF INSTR LINE - 2  @G811PSS
&SBAWARN SETC  '11F4601DE840'      WARNING LINE SBA-A1-A2-SF-ATT       X
                                   (PROT,INTEN,DETECT)         @G811PSS
&MSNLMGA SETC  '42'                NUMBER OF LINES IN MSG AREA         X
                                   FOR MS MODE                 @G811PSS
&MSLSCT  SETC  'DCMMSG42'          SCT FOR LAST LINE FOR               X
                                   MS MODE                     @G811PSS
&MSSCT1 SETC   'DCMMSG43'          SCT FOR LAST LINE + 1               X
                                   FOR MS MODE                 @G811PSS
&MSLSSCT SETC  'DCMSEC43'          SSCT FOR LAST LINE + 1              X
                                   FOR MS MODE                 @G811PSS
&SDLSCT  SETC  'DCMMSG43'          SCT FOR LAST LINE FOR               X
                                   SD MODE                     @G811PSS
&SDNLMGA SETC  '43'                NUMBER OF LINES IN MSG AREA         X
                                   FOR SD MODE                 @G811PSS
         AIF   ('&USE1' NE 'FC').OPO784 TEST FOR FULL CAP      @G811PSS
***********************************************************************
*                                                                     *
*        DEVICE IS A 3278 MODEL 4 IN FULL CAPABILITY MODE      @G811PSS
*                                                                     *
***********************************************************************
&CC      SETA  39                  ORG VALUE FOR SCT AND SSCT  @G811PSS
&A       SETC  'DCMINSTR'          LAST LINE + 1 IN MSG AREA   @G811PSS
&C       SETC  'DCMINSTR'          LAST LINE + 1 IN MSG AREA   @G811PSS
&F       SETC  '39'                NUMBER OF LINES IN MSG AREA @G811PSS
&H       SETC  '19'                INITIAL SEGMENT VALUE       @G811PSS
&K       SETC  '39'                INITIAL ROLL NUMBER VALUE   @G811PSS
&L       SETC  '78'                INITIAL ROLL TIME VALUE     @G811PSS
&M       SETC  '19'                DEFAULT SEGMENT VALUE       @G811PSS
&N       SETC  '39'                DEFAULT ROLL NUMBER VALUE   @G811PSS
&P       SETC  '78'                DEFAULT ROLL TIME VALUE     @G811PSS
&ENTLNE1 SETC  '40'                LINE NUMBER -1 OF ENTRY             X
                                   AREA                        @G811PSS
&ENTLNE2 SETC  '41'                LINE NUMBER -1 OF 2ND LINE IN       X
                                   ENTRY AREA                  @G811PSS
&ENTYPOS SETC  '3201'              OFFSET OF 1ST CHAR IN ENTRY AREA    X
                                                               @G811PSS
&FCNLMGA SETC  '39'                NUMBER OF LINES IN MSG AREA         X
                                   FOR FC MODE                 @G811PSS
&FCLSCT  SETC  'DCMMSG39'          SCT FOR LAST LINE FOR               X
                                   FC MODE                     @G811PSS
&FCSCT1 SETC   'DCMMSG40'          SCT FOR LAST LINE + 1               X
                                   FOR FC MODE                 @G811PSS
&FCLSSCT SETC  'DCMSEC40'          SSCT FOR LAST LINE + 1              X
                                   FOR FC MODE                 @G811PSS
&FCEN2RC SETC  'F350'              ADDR OF 2ND LINE OF ENTRY AREA      X
                                                               @G811PSS
&INSTRLN SETC  '39'                DCMINLNM INITIAL VALUE      @G860PSS
&SBAINST SETC  '11F0F01D6040'      INSTRUCTION LINE SBA-A1-A2-SF-ATT   X
                                   (PROT,NON-DETECT)           @G811PSS
&SBAENT1 SETC  '11F240401DC4'      1ST LINE IN ENTRY AREA              X
                                   SBA-A1-A2-BLANK DATA-SF-ATT         X
                                   (PROT,NON-DETECT)           @G811PSS
&SBAENT2 SETC  '404040404040'      2ND LINE IN ENTRY AREA DUMMY ORDERS X
                                                               @G811PSS
         AGO   .START                                          @G811PSS
.OPO784  ANOP                                                  @G811PSS
.**********************************************************************
.*                                                                    *
.*       DEVICE IS AN OUTPUT ONLY 3278 MODEL 4.                @G811PSS
.*       INITIALIZE COMMON OUTPUT ONLY VARIABLES.              @G811PSS
.*                                                                    *
.**********************************************************************
&SBAINST SETC  '11F0F01DE440'      INSTRUCTION LINE SBA-A1-A2-SF-ATT   X
                                   (PROT,DETECT)               @G811PSS
&SBAENT1 SETC  '11F2401DE440'      1ST LINE IN ENTRY AREA              X
                                   SBA-A1-A2-SF-ATT (PROT,DETECT)      X
                                                               @G811PSS
&SBAENT2 SETC  '11F3501DE440'      2ND LINE IN ENTRY AREA              X
                                   SBA-A1-A2-SF-ATT (PROT,DETECT)      X
                                                               @G811PSS
         AIF   ('&USE1' NE 'SD').MS784 TEST FOR SD MODE        @G811PSS
***********************************************************************
*                                                                     *
*        DEVICE IS A 3278 MODEL 4 IN STATUS DISPLAY MODE       @G811PSS
*                                                                     *
***********************************************************************
&CC      SETA  43                  ORG VALUE FOR SCT AND SSCT  @G811PSS
&A       SETC  'DCMLNEND'          LAST LINE + 1 IN MSG AREA   @G811PSS
&C       SETC  'DCMLNEND'          LAST LINE + 1 IN MSG AREA   @G811PSS
&F       SETC  '43'                NUMBER OF LINES IN MSG AREA @G811PSS
&H       SETC  '21'                INITIAL SEGMENT VALUE       @G811PSS
&K       SETC  '43'                INITIAL ROLL NUMBER VALUE   @G811PSS
&L       SETC  '86'                INITIAL ROLL TIME VALUE     @G811PSS
&M       SETC  '21'                DEFAULT SEGMENT VALUE       @G811PSS
&N       SETC  '43'                DEFAULT ROLL NUMBER VALUE   @G811PSS
&P       SETC  '86'                DEFAULT ROLL TIME VALUE     @G811PSS
&SBAWARN SETC  '11F4601DE440'      WARNING LINE SBA-A1-A2-SF-ATT       X
                                   (PROT,DETECT)               @G811PSS
         AGO   .START                                          @G811PSS
.MS784   ANOP                                                  @G811PSS
***********************************************************************
*                                                                     *
*        DEVICE IS A 3278 MODEL 4 IN MESSAGE STREAM MODE       @G811PSS
*                                                                     *
***********************************************************************
&CC      SETA  42                  ORG VALUE FOR SCT AND SSCT  @G811PSS
&F       SETC  '42'                NUMBER LINES IN MSG AREA    @G811PSS
&H       SETC  '21'                INITIAL SEGMENT VALUE       @G811PSS
&K       SETC  '42'                INITIAL ROLL NUMBER VALUE   @G811PSS
&L       SETC  '84'                INITIAL ROLL TIME VALUE     @G811PSS
&M       SETC  '21'                DEFAULT SEGMENT VALUE       @G811PSS
&N       SETC  '42'                DEFAULT ROLL NUMBER VALUE   @G811PSS
&P       SETC  '84'                DEFAULT ROLL TIME VALUE     @G811PSS
         AGO   .START                                          @G811PSS
.ALL     ANOP
***********************************************************************
*                                                                     *
*        DEVICE=ALL WAS SPECIFIED. A GENERALIZED TDCM IS BUILT @G811PSS
*                                                                     *
***********************************************************************
&A       SETC  '0'                 DCMWTINT INITIAL VALUE
&B       SETC  '0'                 DCMBUFAD INITIAL VALUE
&C       SETC  '0'                 DCMWTBUF INITIAL VALUE
         AGO   .DSECT
.FC50    ANOP
***********************************************************************
*                                                                     *
*        DEVICE IS A 2250 IN FULL CAPABILITY MODE              @G811PSS
*                                                                     *
***********************************************************************
&A       SETC  'DCMENTRY'          DCMWTINT INITIAL VALUE
&B       SETC  'DCMBASRT'          DCMBUFAD INITIAL VALUE
&C       SETC  'DCMBLNK1'          DCMWTBUF INITIAL VALUE
&X       SETC  'DCMPFKAR'          DCMPFKLN INITIAL VALUE
&W       SETC  '201000'            DCMASKEN INITIAL VALUE
&Z       SETC  '004000000000'      DCMASKEN INITIAL VALUE      @G811PSS
.DSECT   ANOP
&D       SETC  '74'                DCMLGNTH INITIAL VALUE
&E       SETC  '71'                DCMAXLGN INITIAL VALUE
&F       SETC  '47'                DCMMSGAL INITIAL VALUE
&G       SETC  '74'                DCMCORLN INITIAL VALUE
&H       SETC  '35'                DCMSEG INITIAL VALUE
&K       SETC  '47'                DCMRNUM INITIAL VALUE
&L       SETC  '94'                DCMRTME INITIAL VALUE
&M       SETC  '35'                DCMSEGDF INITIAL VALUE
&N       SETC  '47'                DCMRNUMD INITIAL VALUE
&P       SETC  '94'                DCMRTMED INITIAL VALUE
&QQ      SETA  8                   DCMIORTN VALUE             MB Y02958
&BB      SETA  47                  NUMBER DOM ENTRIES
&CC      SETA  47                  ORG VALUE FOR SCT AND SSCT
&DD      SETA  47                  NUMBER SCT AND SSCT ENTRIES
&INSTRLN SETC  '48'                DCMINLNM INITIAL VALUE      @G860PSS
&SCRNWD  SETC  '74'                DCMSCRW  INITIAL VALUE      @G860PSS
         AGO   .START
.TST60   ANOP
.**********************************************************************
.*                                                                    *
.*       DEVICE IS A 2260                                      @G811PSS
.*                                                                    *
.**********************************************************************
&D       SETC  '80'                DCMLGNTH INITIAL VALUE
&E       SETC  '73'                DCMAXLGN INITIAL VALUE
&F       SETC  '11'                DCMMSGAL INITIAL VALUE
&G       SETC  '80'                DCMCORLN INITIAL VALUE
&H       SETC  '8'                 DCMSEG INITIAL VALUE
&K       SETC  '8'                 DCMRNUM INITIAL VALUE
&L       SETC  '16'                DCMRTME INITIAL VALUE
&M       SETC  '8'                 DCMSEGDF INITIAL VALUE
&N       SETC  '8'                 DCMRNUMD INITIAL VALUE
&P       SETC  '16'                DCMRTMED INITIAL VALUE
&QQ      SETA  12                  DCMIORTN VALUE             MB Y02958
&V       SETC  '00'                DCMIOUNQ INITIAL VALUE
&Y       SETC  '2'                 DCMRMINC INITIAL VALUE
&BB      SETA  11                  NUMBER DOM ENTRIES
&CC      SETA  11                  ORG VALUE FOR SCT AND SSCT
&DD      SETA  11                  NUMBER SCT AND SSCT ENTRIES
         AIF   ('&USE1' EQ 'SD').SD60
         AIF   ('&USE1' EQ 'MS').MS60
.FC60    ANOP
***********************************************************************
*                                                                     *
*        DEVICE IS A 2260 IN FULL CAPABILITY MODE              @G811PSS
*                                                                     *
***********************************************************************
&A       SETC  'DCMINSTR'          DCMWTINT INITIAL VALUE
&C       SETC  'DCMINSTR'          DCMWTBUF INITIAL VALUE
&F       SETC  '8'                 DCMMSGAL INITIAL VALUE
&CC      SETA  8                   ORG VALUE FOR SCT AND SSCT
&INSTRLN SETC  '7'                 DCMINLNM INITIAL VALUE      @G860PSS
         AGO   .START
.SD60    ANOP
***********************************************************************
*                                                                     *
*        DEVICE IS A 2260 IN STATUS DISPLAY MODE               @G811PSS
*                                                                     *
***********************************************************************
         AGO   .START
.MS60    ANOP
***********************************************************************
*                                                                     *
*        DEVICE IS A 2260 IN MESSAGE STREAM MODE               @G811PSS
*                                                                     *
***********************************************************************
&K       SETC  '11'                DCMRNUM INITIAL VALUE
&L       SETC  '22'                DCMRTME INITIAL VALUE
&N       SETC  '11'                DCMRNUMD INITIAL VALUE
&P       SETC  '22'                DCMRTMED INITIAL VALUE
         AGO   .START
.START   ANOP
.**********************************************************************
.*                                                                    *
.*       ALL VARIABLES HAVE BEEN INITIALIZED. BEGIN BUILDING   @G811PSS
.*       THE TDCM.                                             @G811PSS
.*                                                                    *
.**********************************************************************
         EJECT                                                 @G811PSS
***********************************************************************
*                                                                     *
*        WORK AND SAVE AREAS                                          *
*                                                                     *
***********************************************************************
         SPACE 1                                               @G811PSS
STRTDCM  EQU   *
DCMOACRO DS    0F                  CNTL BLK ACRONYM 'TDCM' AFTER OPEN  X
                                                               @G811PSS
         DC    AL2(ENDDCM-STRTDCM) TDCM LENGTH BEFORE OPEN     @G811PSS
         DC    H'0'                PADDING FOR LENGTH          @G811PSS
         SPACE 1                                               @G811PSS
DCMFLG1  DC    X'00'               TDCM AREA INDICATORS
DCMOUTPT EQU   X'02'               TDCM UPDATED FOR OUTPUT ONLY
         SPACE 1                                               @G811PSS
DCMATI   DC    X'00'               SAVED UCB ATTN INDEX      MC SA55058
         DC    AL2(0)              RESERVED                  MC SA55058
         SPACE 1                                               @G811PSS
DCMWTINT DC    A(&A)               DCMWTINT INITIAL VALUE
DCMLNCNT DS    H                   NUMBER OF LINES TO BLANK  MC SA55058
DCMLNNUM DC    X'00'               FIRST LINE TO BLANK       MC SA55058
         DC    X'00'               RESERVED                  MC SA55058
DCMPACK  DC    F'0'                AREA TO PLACE NUMBER FOR PACKING
DCMCVBIN DC    F'0'                AREA FOR CONVERSION TO BINARY
         SPACE 1                                               @G811PSS
***********************************************************************
*                                                                     *
*        TIMER COMMUNICATION FIELD                             @G811PSS
*                                                                     *
***********************************************************************
         SPACE 1                                               @G811PSS
DCMTIMES DC    X'00'               TIME RTNS INDICATOR BYTE
DCMTIMER EQU   X'80'               TIME ELAPSED FOR THIS DISPLAY
DCMOPTTI EQU   X'40'               OPTIONS TO TI RTN
DCMOTTMM EQU   X'10'               OPTIONS OR TI RTNS TO MSG MODULE
DCMTASYN EQU   X'04'               TIMER SET FOR ASYNC ERROR MSG
DCMOCTTI EQU   X'02'               OPEN-CLOSE TO TI RTN
DCMRMTTI EQU   X'01'               ROLL MODE TO TIMER ROUTINE
         SPACE 1                                               @G811PSS
***********************************************************************
*                                                                     *
*        CONTROL BLOCK VERSION IDENTIFICATION                  @G860P2G
*                                                                     *
***********************************************************************
         SPACE 1                                               @G860P2G
DCMTSP21 EQU   1                   OS/VS2 HBB2102 LEVEL        @G860PSS
DCMTVRID EQU   DCMTSP21            CURRENT VERSION             @G860PSS
DCMTVERN DC    AL1(DCMTVRID)       CONTROL BLOCK VERSION       @G860P2G
         SPACE 1                                               @G811PSS
DCMELGN  DC    H'125'              ENTRY AREA LAST CHARACTER POINTER
         EJECT                                                 @G811PSS
***********************************************************************
*                                                                     *
*        ADDRESS TABLE                                         @G811PSS
*                                                                     *
***********************************************************************
         SPACE 1                                               @G811PSS
         AIF   ('&DEVICE1' NE 'ALL').AD2
DCMBUFAD DS    F                   POINTER TO BUFFER ADDRESS TABLE
DCMDOMPK DS    F                   ADDRESS OF FIRST DOM NUMBER
DCMAMTAB DS    F                   ADDRESS OF FIRST SCT ENTRY
DCMADSEC DS    F                   ADDRESS OF FIRST SSCT ENTRY
DCMADDRL DS    F                   ADDRESS OF LAST SCT ENTRY
DCMASCRN DS    F                   POINTER TO SCREEN IMAGE BUFFER
DCMLSCRN DS    F                   POINTER TO LAST BUFFER LINE
DCMWTBUF DS    F                   SCREEN LENGTH POINTER
DCMAINS  DS    F                   POINTER TO INSTRUCTION LINE
DCMAENTR DS    F                   POINTER TO ENTRY AREA
DCMAWARN DS    F                   POINTER TO WARNING LINE
DCMADCHP DS    F                   ADDRESS OF CHANNEL PROGRAM AREA
         AGO   .PFK                CONTINUE WITH PFK ADDRESS
.AD2     ANOP
DCMBUFAD DC    A(&B)               POINTER TO BUFFER ADDRESS TABLE
DCMDOMPK DC    A(DCMDOM1)          ADDRESS OF FIRST DOM NUMBER
DCMAMTAB DC    A(DCMMSG1)          ADDRESS OF FIRST SCT ENTRY
DCMADSEC DC    A(DCMSEC1)          ADDRESS OF FIRST SSCT ENTRY
DCMADDRL DC    A(DCMMSG&F)         ADDRESS OF LAST SCT ENTRY
DCMASCRN DC    A(DCMMFRST)         POINTER TO SCREEN IMAGE BUFFER
DCMLSCRN DC    A(DCMMLAST)         POINTER TO LAST BUFFER LINE
DCMWTBUF DC    A(&C)               SCREEN LENGTH POINTER       @G811PSS
         AIF   ('&USE1' EQ 'FC').FC     FOR FULL-CAPABILITY, GO TO FC
DCMAINS  DC    F'0'                POINTER TO INSTRUCTION LINE
DCMAENTR DC    F'0'                POINTER TO ENTRY AREA
         AGO   .ADWARN             FOR WARNING LINE ADDRESS
.FC      ANOP
DCMAINS  DC    A(DCMINSTR)         POINTER TO INSTRUCTION LINE
DCMAENTR DC    A(DCMENTRY)         POINTER TO ENTRY AREA
.ADWARN  ANOP
DCMAWARN DC    A(DCMWARN)          POINTER TO WARNING LINE
DCMADCHP DC    A(DCMCHPGM)         ADDRESS OF CHANNEL PROGRAM AREA
.PFK     ANOP
DCMPFKLN DC    A(&X)               POINTER TO PFK LINE
         SPACE 1                                               @G811PSS
DCMCXSVE DC    F'0'                CXSA SAVE AREA
DCMADOPN DC    F'0'                ADDRESS OF COMMAND OPERAND
         SPACE 1                                               @G811PSS
DCMDSAV  DC    5F'0'               SAVE AND WORK AREA
         EJECT                                                 @G811PSS
***********************************************************************
*                                                                     *
*        INPUT BUFFER FOR ISSUING SVC 34 AND SVC 35                   *
*        FIELDS DCMWQEXP THROUGH DCMINPUT MUST REMAIN IN ORDER        *
*                                                                     *
***********************************************************************
         SPACE 1                                               @G811PSS
DCMWQEXP DS    0F                  ENSURE FULL WORD BOUNDARY
DCMINLGN DC    H'0'                FIELD FOR INPUT LENGTH
DCMMCSFL DC    H'0'                MCS FLAGS FIELD
DCMINPUT DC    32F'0'              INPUT MESSAGE TEXT
         SPACE 1                                               @G811PSS
***********************************************************************
*                                                                     *
*        GENERAL LENGTH VALUES                                 @G811PSS
*                                                                     *
***********************************************************************
         SPACE 1                                               @G811PSS
DCMLGNTH DC    H'&D'               LENGTH OF A LINE
DCMBAINC DC    H'0'                ADDRESS TO INSERT CURSOR
         DC    H'0'                RESERVED - WAS DCMIRCTR        @L1A
DCMBADLN DC    H'0'                BUFFER ADDR TO BEGIN MSG WRITE
DCMBYTCT DC    H'0'                NUMBER OF BYTES TO WRITE
DCMADNUM DC    H'0'                NEXT LINE NUMBER
DCMAXLGN DC    H'&E'               MAXIMUM LINE LENGTH
DCMMSGAL DC    H'&F'               NUMBER OF LINES IN MESSAGE AREA
DCMRMINC DC    H'&Y'               INCREMENT INTO RMI
DCMSCTCN DC    H'2'                LENGTH OF ONE SCT ENTRY
DCMCORLN DC    H'&G'               LENGTH OF TDCM LINE IN CORE
         DC    H'0'                TIME COUNTER
DCMPFKNM DC    X'FF'               NUMBER OF KEY BEING PROCESSED
DCMPFKKN DC    X'FF'               LIST KEY NUMBER
         SPACE 1                                               @G811PSS
***********************************************************************
*                                                                     *
*        VALUES FOR OPTIONS                                    @G811PSS
*                                                                     *
***********************************************************************
         SPACE 1                                               @G811PSS
DCMDEL   DC    C'Y '               DEL VALUE
DCMCON   DC    C'Y'                CON VALUE
DCMSEG   DC    FL1'&H'             SEG VALUE
DCMDL    DC    FL1'&J'             DISPLAY AREA OPTION
DCMRNUM  DC    FL1'&K'             ROLL NUMBER VALUE
DCMRTME  DC    H'&L'               ROLL TIME VALUE
         EJECT                                                 @G811PSS
***********************************************************************
*                                                                     *
*        DEFAULT VALUES FOR OPTIONS                                   *
*                                                                     *
***********************************************************************
         SPACE 1                                               @G811PSS
DCMSEGDF DC    FL1'&M'             SEG DEFAULT
DCMRNUMD DC    FL1'&N'             RNUM DEFAULT
DCMRTMED DC    H'&P'               RTME DEFAULT
         SPACE 1                                               @G811PSS
         DC    XL5'00'             RESERVED                    @G811PSS
         SPACE 1                                               @G811PSS
***********************************************************************
*                                                                     *
*        COMMUNICATIONS AREAS                                         *
*                                                                     *
***********************************************************************
         SPACE 1                                               @G811PSS
DCMOPTST DC    X'E0'               STATUS OF SCREEN CONTROL OPTIONS
DCMOPTVR EQU   X'80'               DELETE VERIFICATION  CON=(Y=1,N=0)
DCMOPTAD EQU   X'40'               AUTOMATIC DELETION   DEL=(Y=1,N=0)
DCMOPTSG EQU   X'20'               DEFAULT SEGMENT SPECIFIED  SEG=(0=0)
DCMOPRLL EQU   X'10'               ROLL MODE  (Y=1,N=0)
         SPACE 1                                               @G811PSS
DCMCS    DC    X'40'               OPEN/CLOSE REQUEST
DCMCSC   EQU   X'80'               CLOSE REQUEST
DCMCSO   EQU   X'40'               OPEN REQUEST
         SPACE 1                                               @G811PSS
DCMUTILT DC    X'00'               INTERNAL FLAGS              @G811PSS
DCMUTILA EQU   X'80'               THESE BITS ARE
DCMUTILB EQU   X'40'                 INITIALIZED AND USED
DCMUTILC EQU   X'20'                 SOLELY WITHIN
DCMUTILD EQU   X'10'                 EACH MODULE
DCMUTILE EQU   X'08'               THEY ARE NEVER
DCMUTILF EQU   X'04'               USED FOR INTERFACE
DCMTEST1 EQU   X'02'               FOR TESTING
DCMTEST2 EQU   X'01'               FOR TESTING
         SPACE 1                                               @G811PSS
DCMDSTAT DC    X'00'               CURRENT DISPLAY STATUS
DCMDSTNM EQU   X'20'               MESSAGES ARE NUMBERED
DCMDSTNH EQU   X'10'               MSGS NUMBERED - HOLD OPTION
.* X'08' WAS DCMDSINR - INTERVENTION REQ'D DELETION TRIED          @L1A
DCMDSAUT EQU   X'04'               AUTOMATIC DELETION TRIED
         EJECT                                                 @G811PSS
***********************************************************************
*                                                                     *
*        MCS INTERFACE FIELD                                          *
*                                                                     *
***********************************************************************
         SPACE 1                                               @G811PSS
DCMMCSST DC    X'00'               MCS INTERFACE BYTE
DCMDUSE  EQU   X'80'               DIDOCS IN CONTROL           @G811PSS
DCMOOMSS EQU   X'04'               MESSAGE STREAM ENTRY
DCMOOSDS EQU   X'01'               STATUS DISPLAY ENTRY
         SPACE 1                                               @G811PSS
***********************************************************************
*                                                                     *
*        UNIQUE INTERFACE FIELD                                @G811PSS
*                                                                     *
***********************************************************************
         SPACE 1                                               @G811PSS
DCMIOUNQ DC    X'&V'               UNIQUE IO BYTE
DCMIO226 EQU   X'80'               RMI PERFORMED
DCMRPCUR EQU   X'40'               ADVANCE CURSOR TO BLANKS
DCMFRSCN EQU   X'20'               PUT OUTPUT IN HOLD MODE
DCMRDARM EQU   X'10'               PERFORM READ AFTER RMI
DCMW2250 EQU   X'08'               DEVICE HAS LIGHT PEN
DCMINNOR EQU   X'04'               NORMAL INSTRUCTION LINE
DCMINERR EQU   X'02'               ERROR INSTRUCTION LINE
DCMEWASP EQU   X'01'               ERASE/WRITE ALTERNATE COMMAND       X
                                   SUPPORTED                   @G811PSS
         EJECT                                                 @G811PSS
***********************************************************************
*                                                                     *
*        I/O COMMUNICATION FIELDS                              @G811PSS
*                                                                     *
***********************************************************************
         SPACE 1                                               @G811PSS
DCMIOCM1 DC    X'00'               IO COMMUNICATIONS BYTE 1
DCMDORMI EQU   X'80'               ISSUE RMI
DCMSOUND EQU   X'40'               SOUND ALARM
DCMWRWRN EQU   X'20'               WRITE WARNING LINE
DCMWRMSG EQU   X'10'               WRITE FULL MESSAGE AREA
DCMWRPAR EQU   X'08'               WRITE PARTIAL MESSAGE AREA
DCMWRINS EQU   X'04'               WRITE INSTRUCTION LINE
DCMWRENT EQU   X'02'               WRITE ENTRY AREA
DCMINSC  EQU   X'01'               INSERT CURSOR
         SPACE 1                                               @G811PSS
DCMIOCM2 DC    X'00'               IO COMMUNICATIONS BYTE 2
DCMBLENT EQU   X'80'               BLANK ENTRY AREA
DCMBLWRL EQU   X'40'               BLANK LEFT HALF WARNING LINE
DCMBLWRR EQU   X'20'               BLANK RIGHT HALF WARNING LINE
DCMINSSH EQU   X'10'               INIT AND SHIFT INSTRUCTION LINE
DCMWINFD EQU   X'08'               WRITE INFORMATIONAL DISPLAY
DCMERASE EQU   X'04'               PERFORM ERASE
DCMIOCRD EQU   X'02'               PERFORM READ (2250,22DOC)
DCMWRASY EQU   X'01'               WRITE ASYNC ERROR MSG TO MID-SCREEN
         SPACE 1                                               @G811PSS
DCMIOCM3 DC    X'00'               IO COMMUNICATIONS BYTE 3
DCMOPRMI EQU   X'80'               RMI AFTER OPEN TO UNLOCK KEYBOARD
DCMSSRG  EQU   X'40'               SUPPRESS START REGENERATION
DCMEWAND EQU   X'20'               ERASE/WRITE ALTERNATE COMMAND       X
                                   NEEDED                      @G811PSS
DCMWRPFK EQU   X'10'               TDCM WRITE PFK AREA
DCMPFKAT EQU   X'08'               PFK ATTENTION
DCMRDPFK EQU   X'04'               PFK AREA READ
DCMACPFK EQU   X'02'               EXTINGUISH PFK LIGNTS       @G811PSS
DCMLTPFK EQU   X'01'               LIGHT ALL ALLOCATED PFK LIGHTS      X
                                                               @G811PSS
         SPACE 1                                               @G811PSS
DCMLINEN DC    X'00'               LINE NUMBER TO BEGIN WRITE
DCMCULNO DC    X'00'               LINE IN ENTRY AREA TO INSERT CURSOR
DCMPOSCU DC    X'00'               POSITION TO INSERT CURSOR
         EJECT                                                 @G811PSS
***********************************************************************
*                                                                     *
*        ASYNCHRONOUS ERROR COMMUNICATIONS FIELD               @G811PSS
*                                                                     *
***********************************************************************
         SPACE 1                                               @G811PSS
DCMASYNC DC    X'00'               ASYN ERROR COMMUNICATIONS/RETRY BYTE
DCMASDA  EQU   X'40'               DATA CHECK RETRY BIT        @G811PSS
DCMASIN  EQU   X'20'               INVALID BUFFER ADDR CHECK RETRY BIT X
                                                               @G811PSS
DCMASBA  EQU   X'10'               BUFFER ADDR PARITY CHECK RETRY BIT  X
                                                               @G811PSS
DCMASEWA EQU   X'08'               PERMANENT ERROR ON EWA DEVICE       X
                                   RETRIED                     @G811PSS
         SPACE 1                                               @G811PSS
***********************************************************************
*                                                                     *
*        COMMUNICATION FIELDS                                  @G811PSS
*                                                                     *
***********************************************************************
         SPACE 1                                               @G811PSS
DCMCOM1  DC    X'00'               COMMUNICATIONS BYTE
DCMLPENT EQU   X'80'               ENTER BY LP OR CURSOR
DCMIOPRD EQU   X'40'               READ PERFORMED
DCMCOMRM EQU   X'20'               RMI PERFORMED
DCMCOMAU EQU   X'10'               PERFORM AUTO DELETE
DCMCOMRD EQU   X'08'               PERFORM REGULAR DELETE
DCMCOMNM EQU   X'04'               NUMBER MESSAGES
DCMCLEAR EQU   X'02'               CLEAR KEY WAS PRESSED       @G811PSS
DCMCANCL EQU   X'01'               INDICATE CANCEL TO COMMAND ROUTINE
         SPACE 1                                               @G811PSS
DCMCOM2  DC    X'00'               COMMUNICATIONS BYTE
DCMCM2I  EQU   X'80'               INPUT TO BE PROCESSED
DCMSPLIT EQU   X'40'               MSG TO BE SPLIT
DCMCOMAR EQU   X'20'               ACCEPTED REPLY
DCMREPLC EQU   X'10'               REPEAT LAST COMMAND KEY (PA1)       X
                                   PRESSED                     @G811PSS
DCMERPF  EQU   X'08'               ERASE PERF-PROC CAN NOW CLOSE DEVICE
DCMCMIN5 EQU   X'04'               RETURN TO INTER. 5 FOR BLNK
DCMCBLNK EQU   X'02'               BLANKING REQUIRED
DCMAE    EQU   X'01'               CLEANUP FOR ASY ERROR
         SPACE 1                                               @G811PSS
DCMCOM3  DC    X'00'               COMMUNICATIONS BYTE
DCMCDSP3 EQU   X'80'               DISPLAY 3 COMPLETED WORK
DCMRTPFK EQU   X'40'               RETURN TO PFK ROUTINE
DCMVLPFK EQU   X'20'               VERIFYING LAST COMMAND
DCMXINT1 EQU   X'10'               ENTRY FOR INTERFACE 1 ROUTINE
DCMOLUNV EQU   X'08'               O-O-L MSG CAUSED UNVIEW. MSG.
DCMPFKWR EQU   X'04'               WRITE PFK UPDATES TO LIB
DCMOLHLD EQU   X'02'               OUT OF LINE MESSAGES HELD
DCMCMIN7 EQU   X'01'               RETURN TO INTER. 7 FOR BLANKING
         EJECT                                                 @G811PSS
***********************************************************************
*                                                                     *
*        MESSAGE MODULES COMMUNICATION FIELDS                  @G811PSS
*                                                                     *
***********************************************************************
         SPACE 1                                               @G811PSS
DCMCMSG1 DC    X'00'               MSG MODULE COMMUNICATIONS BYTE 1
DCMMSGWT EQU   X'80'               MOVE IN MESSAGE WAITING
DCMUNMSG EQU   X'40'               MOVE IN UNVIEWABLE MESSAGE
DCMSTEX  EQU   X'20'               MOVE IN STATUS EXISTS
DCMCHOPT EQU   X'10'               MOVE IN CHANGE OPTIONS
DCMELONG EQU   X'08'               MOVE IN ENTRY TOO LONG
DCMWRCDL EQU   X'04'               MOVE IN CON=N,DEL=Y
DCMDELNT EQU   X'02'               MOVE IN DEL UNCHANGED, NO TIMER
         SPACE 1                                               @G811PSS
DCMCMSG2 DC    X'00'               MSG MODULE COMMUNICATIONS BYTE 2
DCMDLREQ EQU   X'80'               MOVE IN DELETION REQUESTED
DCMRQINC EQU   X'40'               MOVE IN REQUEST INCONSISTENT
DCMMSGCR EQU   X'20'               MOVE IN INVALID CURSOR OPERATION
DCMINVOP EQU   X'10'               MOVE IN INVALID OPERAND
DCMCILLP EQU   X'08'               MOVE IN ILLEGAL LP OPERATION
DCMDELRI EQU   X'04'               MOVE IN DELETE REQUEST INCONSISTENT
DCMASYRT EQU   X'02'               MOVE IN ASYN ERROR RETRYABLE
DCMASYCD EQU   X'01'               MOVE IN ASYN ERROR MAYBE RETRYABLE
         SPACE 1                                               @G811PSS
DCMCMSG3 DC    X'00'               MSG MODULE COMMUNICATIONS BYTE 3
DCMCMRLL EQU   X'80'               MOVE IN ROLL MODE MESSAGE
DCMCDLR1 EQU   X'40'               NO DELETABLE MESSAGES
DCMCDLR2 EQU   X'20'               INVALID RANGE
DCMCDLR3 EQU   X'10'               SEG EQU TO ZERO
DCMCDLR4 EQU   X'08'               DISPLAY NOT ON SCREEN
DCMCDLR5 EQU   X'04'               INVALID OPERAND
DCMDTBSY EQU   X'01'               COMMAND REJECTED - TASK BUSY
         SPACE 1                                               @G811PSS
DCMCMSG4 DC    X'00'               MSG MODULE COMMUNICATIONS BYTE 4
DCMPFKNA EQU   X'80'               MOVE IN PFK NOT ALLOCATED FOR
DCMPFKND EQU   X'40'               MOVE IN PFK NOT DEFINED
DCMPFKNO EQU   X'20'               MOVE IN NO PFK ALLOCATION
DCMPFKIP EQU   X'10'               MOVE IN PFK IN PROCESS
         EJECT                                                 @G811PSS
***********************************************************************
*                                                                     *
*        SVC 34 COMMUNICATIONS FIELD                           @G811PSS
*                                                                     *
***********************************************************************
         SPACE 1                                               @G811PSS
DCMSVC34 DC    X'00'               SVC 34 COMMUNICATION BYTE
DCMMYCMD EQU   X'80'               COMMAND TO BE HANDLED BY THIS CONS
DCMINVLD EQU   X'40'               INVALID K COMMAND
DCMTYPE1 EQU   X'20'               K COMMAND IS NOT ROUTABLE
         SPACE 1                                               @G811PSS
DCMCOM4  DC    X'00'               COMMUNICATION BYTE 4        @ZA44483
DCMCNTRL EQU   X'80'               CONTROL LINE INDICATOR      @ZA44483
         SPACE 1                                               @G811PSS
***********************************************************************
*                                                                     *
*        INDEX FOR I/O ROUTINE                                 @G811PSS
*                                                                     *
***********************************************************************
         SPACE 1                                               @G811PSS
DCMIONDX DC    AL1(&QQ)            INDEX FOR SELECTING THE    MB Y02958
*                                  APPROPRIATE I/O ROUTINE     @G811PSS
*                                  X'04' - RESERVED            @G860P2G
*                                  X'08' - 2250-IEECVETP       @G811PSS
*                                  X'0C' - 2260-IEECVETR       @G811PSS
*                                  X'10' - 3277 TYPE DEVICE-   @G811PSS
*                                               IEECVETU       @G811PSS
         SPACE 1                                               @G811PSS
DCMTEST  DC    H'0'                RESERVED FOR TESTING       MB Y02958
         EJECT
***********************************************************************
*                                                                     *
*        MODULE ADDRESSES                                             *
*                                                                     *
***********************************************************************
         SPACE 1
DCMIORTN DC    F'0'       IEECVETP,R,U APPROPRIATE I/O ROUTINE         X
                                                               @G860P2G
DCMNPRZ  DC    F'0'       IEECVFT1 PROCESSOR 0 LOAD ONE        @G811PSS
DCMNPROC DC    F'0'       IEECVET1 PROCESSOR ROUTINE LOAD ONE  @G811PSS
DCMNDSP1 DC    F'0'       IEECVET2 DISPLAY ROUTINE 1           @G811PSS
DCMNDSP2 DC    F'0'       IEECVET3 DISPLAY ROUTINE 2           @G811PSS
DCMNDSP3 DC    F'0'       IEECVFT2 DISPLAY ROUTINE 3           @G811PSS
DCMNCMD1 DC    F'0'       IEECVET4 COMMAND ROUTINE 1           @G811PSS
DCMNDEL1 DC    F'0'       IEECVET6 DELETE ROUTINE 1            @G811PSS
DCMNDEL2 DC    F'0'       IEECVET7 DELETE ROUTINE 2            @G811PSS
DCMNDEL3 DC    F'0'       IEECVET8 DELETE ROUTINE 3            @G811PSS
DCMNDEL4 DC    F'0'       IEECVET9 DELETE ROUTINE 4            @G811PSS
DCMNOPT1 DC    F'0'       IEECVETA OPTIONS ROUTINE 1           @G811PSS
DCMNPFK1 DC    F'0'       IEECVFTA PFK ROUTINE 1               @G811PSS
DCMNPFK2 DC    F'0'       IEECVFTB PFK ROUTINE 2               @G811PSS
DCMNERRO DC    F'0'       IEECVETC ASYNCHRONOUS ERROR ROUTINE  @G811PSS
DCMNMSG1 DC    F'0'       IEECVETD MESSAGE ROUTINE 1           @G811PSS
DCMNMSG2 DC    F'0'       IEECVETE MESSAGE ROUTINE 2           @G811PSS
DCMNMSG3 DC    F'0'       IEECVFTD MESSAGE ROUTINE 3           @G811PSS
DCMNLPCR DC    F'0'       IEECVETF LIGHT PEN/CURSOR SERVICE    @G811PSS
DCMNOPCL DC    F'0'       IEECVETG OPEN-CLOSE ROUTINE          @G811PSS
DCMNCLN  DC    F'0'       IEECVFTG CLEANUP MODULE              @G811PSS
DCMNROLL DC    F'0'       IEECVETJ ROLL MODE ROUTINE           @G811PSS
DCMNTIMR DC    F'0'       IEECVETK TIMER INTERPRETER ROUTINE   @G811PSS
DCMNINT1 DC    F'0'       IEECVFTL INTERFACE 1 ROUTINE         @G811PSS
DCMNINT2 DC    F'0'       IEECVFTM INTERFACE 2 ROUTINE         @G811PSS
DCMNINT3 DC    F'0'       IEECVFTN INTERFACE 3 ROUTINE         @G811PSS
DCMNINT4 DC    F'0'       IEECVFTO INTERFACE 4 ROUTINE         @G811PSS
DCMNINT5 DC    F'0'       IEECVFTP INTERFACE 5 ROUTINE         @G811PSS
DCMNINT6 DC    F'0'       IEECVFTQ INTERFACE 6 ROUTINE         @G811PSS
DCMNINT7 DC    F'0'       IEECVFTT INTERFACE 7 ROUTINE         @G811PSS
         EJECT                                                 @G811PSS
***********************************************************************
*                                                                     *
*        DIDOCS MODULE TRACE AREA                              @G811PSS
*                                                                     *
***********************************************************************
         SPACE 1                                               @G811PSS
DCMTRACE DC    CL30' '             DIDOCS MODULE TRACE AREA   MB Y02958
DCMTRAC2 EQU   DCMTRACE+2          TRACE MOVE FROM-ADDRESS    MB Y02958
DCMTRLEN EQU   *-DCMTRACE          LENGTH FOR TRACE MOVE      MB Y02958
DCMTREN1 DC    C' '                1ST BYTE OF TRACE ENTRY    MB Y02958
DCMTREN2 DC    C' '                2ND BYTE OF TRACE ENTRY    MB Y02958
         SPACE 1
***********************************************************************
*                                                                     *
*        FOLLOWING GROUP OF BYTES ARE DEVICE DEPENDENT AND     @G811PSS
*        ARE INITIALIZED VIA AN ORG                            @G811PSS
*                                                                     *
***********************************************************************
         SPACE 1
DCMASKEN DC    X'00'               ENTER MASK
DCMASKCN DC    X'00'               CANCEL MASK
DCMASKCR DC    X'00'               CURSOR MASK
DCMASKLP DC    X'00'               LIGHT PEN MASK
DCMSKPF1 DC    X'00'               1ST PFK TYPE MASK           @G811PSS
DCMSKPF2 DC    X'00'               2ND PFK TYPE MASK           @G811PSS
DCMSKPF3 DC    X'00'               3RD PFK TYPE MASK           @G811PSS
DCMSKPF4 DC    X'00'               4TH PFK TYPE MASK           @G811PSS
DCMASKCL DC    X'00'               CLEAR KEY MASK              @G811PSS
DCMSKPA1 DC    X'00'               PA1 KEY MASK                @G811PSS
DCMSKPA3 DC    X'00'               PA3 KEY MASK                @G811PSS
         DC    5XL1'00'            RESERVED                    @G811PSS
         ORG   DCMASKEN
         DC    XL3'&W'             RE-INIT MASK FIELDS         @G811PSS
         DC    XL6'&Z'             RE-INIT MASK FIELDS         @G811PSS
         DC    XL2'&AIDS'          RE-INIT MASK FIELDS         @G811PSS
         ORG
         SPACE 1                                               @G811PSS
***********************************************************************
*                                                                     *
*        ADDRESSES OF PARTS OF THE SCREEN IMAGE BUFFER WHEN IN @G811PSS
*        FULL CAPABILITY MODE                                  @G811PSS
*                                                                     *
***********************************************************************
         SPACE 1                                               @G811PSS
DCMSADCN EQU   *                  FIRST ADCON IN LIST          @G811PSS
DCMFLLA  DC    A(&FCLSTLA)        LAST LINE IN MSG AREA        @G811PSS
DCMFLL1A DC    A(&FCLST1A)        LAST LINE IN MSG AREA + 1    @G811PSS
DCMFLSCT DC    A(&FCLSCT)         SCT FOR LAST LINE IN MSG             X
                                  AREA                         @G811PSS
DCMFSCT1 DC    A(&FCSCT1)         SCT FOR LAST LINE IN MSG AREA + 1    X
                                                               @G811PSS
DCMFSSCT DC    A(&FCLSSCT)        SSCT FOR LAST LINE IN MSG AREA + 1   X
                                                               @G811PSS
DCMFENT2 DC    A(&FCENTY2)        2ND LINE OF ENTRY AREA       @G811PSS
         DC    6A(0)              RESERVED                     @G811PSS
***********************************************************************
*                                                                     *
*        ADDRESSES OF PARTS OF THE SCREEN IMAGE BUFFER WHEN IN @G811PSS
*        MESSAGE STREAM MODE                                   @G811PSS
*                                                                     *
***********************************************************************
         SPACE 1                                               @G811PSS
DCMMLLA  DC    A(&MSLSTLA)        LAST LINE MSG AREA           @G811PSS
DCMMLL1A DC    A(&MSLST1A)        LAST LINE IN MSG AREA + 1    @G811PSS
DCMMLSCT DC    A(&MSLSCT)         SCT FOR LAST LINE IN MSG             X
                                  AREA                         @G811PSS
DCMMSCT1 DC    A(&MSSCT1)         SCT FOR LAST LINE IN MSG AREA + 1    X
                                                               @G811PSS
DCMMSSCT DC    A(&MSLSSCT)        SSCT FOR LAST LINE IN MSG AREA + 1   X
                                                               @G811PSS
         DC    2A(0)              RESERVED                     @G811PSS
         SPACE 1                                               @G811PSS
***********************************************************************
*                                                                     *
*        ADDRESSES OF PARTS OF THE SCREEN IMAGE BUFFER WHEN IN @G811PSS
*        STATUS DISPLAY MODE                                   @G811PSS
*                                                                     *
***********************************************************************
         SPACE 1                                               @G811PSS
DCMDLLA  DC    A(&SDLSTLA)        LAST LINE IN MSG AREA        @G811PSS
DCMDLL1A DC    A(&SDLST1A)        LAST LINE IN MSG AREA + 1    @G811PSS
DCMDLSCT DC    A(&SDLSCT)         SCT FOR LAST LINE IN MSG             X
                                  AREA                         @G811PSS
DCMDSCT1 DC    A(&SDSCT1)         SCT FOR LAST LINE IN MSG AREA + 1    X
                                                               @G811PSS
DCMDSSCT DC    A(&SDLSSCT)        SSCT FOR LAST LINE IN MSG AREA + 1   X
                                                               @G811PSS
         DC    2A(0)              RESERVED                         @L1A
         SPACE 1                                               @G811PSS
***********************************************************************
*                                                                     *
*        ADDRESSES TO BE RESOLVED DURING OPEN                      @L1A
*                                                                     *
***********************************************************************
         SPACE 1                                                   @L1A
DCMLSSCT DC    A(&LSTSSCT)        ADDRESS OF LAST SSCT         @ZA60763
DCMAEORD DC    A(&ADJORD)         ADDR OF ADJUNCT EXTENDED ORDERS      X
                                                               @G860PSS
         DC    7A(0)              RESERVED                     @G860PSS
DCMLADCN EQU   *                  LAST ADCON IN LIST               @L1A
         DC    A(0)               RESERVED                         @L1A
         EJECT                                                 @G811PSS
***********************************************************************
*                                                                     *
*        NUMBER OF LINES IN MESSAGE AREA AND ENTRY AREA VALUES @G811PSS
*                                                                     *
***********************************************************************
         SPACE 1                                               @G811PSS
DCMFNLMA DC    FL1'&FCNLMGA'       MAX NUMBER LINES IN MSG AREA WHEN   X
                                   IN FULL CAPABILITY MODE     @G811PSS
DCMMNLMA DC    FL1'&MSNLMGA'       MAX NUMBER LINES IN MSG AREA WHEN   X
                                   IN MESSAGE STREAM MODE      @G811PSS
DCMDNLMA DC    FL1'&SDNLMGA'       MAX NUMBER LINES IN MSG AREA WHEN   X
                                   IN STATUS DISPLAY MODE      @G811PSS
DCMENTL1 DC    FL1'&ENTLNE1'       LINE NUMBER -1 OF 1ST LINE IN ENTRY X
                                   AREA                        @G811PSS
DCMENTL2 DC    FL1'&ENTLNE2'       LINE NUMBER -1 OF 2ND LINE IN ENTRY X
                                   AREA                        @G811PSS
DCMINLNM DC    FL1'&INSTRLN'       LINE NUMBER-1 OF INSTR LINE @G860PSS
         DC    FL2'0'              RESERVED                    @G860PSS
DCMFENRC DC    XL2'&FCEN2RC'       ADDR OF 2ND LINE IN ENTRY AREA IN   X
                                   ROW-COLUMN FORMAT           @G811PSS
DCMENTPO DC    H'&ENTYPOS'         OFFSET OF 1ST CHAR IN ENTRY AREA    X
                                                               @G811PSS
DCMSCRW  DC    H'&SCRNWD'          WIDTH OF SCREEN             @G860PSS
         DC    H'0'                RESERVED                    @G860PSS
         DC    1F'0'               RESERVED                    @G860PSS
         SPACE 1                                               @G811PSS
***********************************************************************
*                                                                     *
*        COMMAND BUFFER AREA FOR THE LAST COMMAND ENTERED      @G811PSS
*                                                                     *
***********************************************************************
         SPACE 1                                               @G811PSS
DCMCBUFA DC    CL128' '            COMMAND BUFFER AREA FOR LAST COMMANDX
                                   ENTERED                     @G811PSS
         SPACE 1                                               @G811PSS
***********************************************************************
*                                                                     *
*        SAVE AREAS                                            @G811PSS
*                                                                     *
***********************************************************************
         SPACE 1                                               @G811PSS
DCMMODAD DS    0F                  VIRT ADDR OF REAL TDCM AFTER OPEN   X
                                                               @G811PSS
DCMCACRO DC    CL4'TDCM'           CNTL BLK ACRONYM 'TDCM' BEFORE OPEN X
                                                               @G811PSS
DCMAIDSV DC    XL6'000000000000'   SAVE AREA FOR AID FROM RMI  @G811PSS
         DC    H'0'                RESERVED                    @G811PSS
DCMTRDCM DC    A(0)                POINTER TO RDCM             @G860P2G
DCMNXTOR DC    A(0)                ADDR OF NEXT ADJUNCT EXTENDED ORDER X
                                                               @G860PSS
DCMCROW  DC    XL1'00'             CURRENT ROW NUMBER - 1      @G860PSS
DCMCCOL  DC    XL1'00'             CURRENT COL NUMBER - 1      @G860PSS
DCMMFRMF DC    CL1'M'              FULL CAPABILITY MFORM VALUE     @L2A
DCMDELFC DC    CL2'Y '             FULL CAPABILITY DEL VALUE       @L2A
DCMCONFC DC    CL1'Y'              FULL CAPABILITY CON VALUE       @L2A
DCMSEGFC DC    FL1'&H'             FULL CAPABILITY SEG VALUE       @L2A
DCMRNUMF DC    FL1'&K'             FULL CAPABILITY RNUM VALUE      @L2A
DCMRTMEF DC    H'&L'               FULL CAPABILITY RTME VALUE      @L2A
DCMMFRMM DC    CL1'M'              MESSAGE STREAM MFORM VALUE      @L2A
DCMDELMS DC    CL2'RD'             MESSAGE STREAM DEL VALUE        @L2A
DCMCONMS DC    CL1'N'              MESSAGE STREAM CON VALUE        @L2A
DCMSEGMS DC    FL1'&H'             MESSAGE STREAM SEG VALUE        @L2A
DCMRNUMM DC    FL1'&K'             MESSAGE STREAM RNUM VALUE       @L2A
DCMRTMEM DC    H'&L'               MESSAGE STREAM RTME VALUE       @L2A
         DC    H'0'                RESERVED                        @L2A
         DC    3F'0'               RESERVED                        @L2A
         SPACE 1                                               @G811PSS
***********************************************************************
*                                                                     *
*        GENERAL EQUATED VALUES                                @G811PSS
*                                                                     *
***********************************************************************
         SPACE 1                                               @G811PSS
DCMPFKAL EQU   110                 SIZE OF THE PFK AREA        @G811PSS
         AIF   ('&DEVICE1' EQ 'ALL').SSCT
         AIF   ('&DEVICE1' NE 'B').TRY60                       @G860P2G
.**********************************************************************
.*                                                                    *
.*       DEVICE IS A 2250. GENERATE THE BUFFER ADDRESS TABLE,  @G811PSS
.*       CHANNEL PROGRAM AREA AND THE SCREEN IMAGE BUFFER.     @G811PSS
.*                                                                    *
.**********************************************************************
         EJECT
***********************************************************************
*                                                                     *
*        BUFFER ADDRESS TABLE                                  @G811PSS
*                                                                     *
***********************************************************************
         SPACE 1                                               @G811PSS
DCMBASRT DC    H'0'
DCMBAM1  DC    H'0'                FIRST MESSAGE LINE BUFFER ADDRESS
DCMBAPFK DC    H'0'                PFK INSERTION AREA
DCMBAINS DC    H'0'                INSTRUCTION LINE BUFFER ADDRESS
DCMBAENT DC    H'0'                ENTRY AREA BUFFER ADDRESS
DCMBAWRN DC    H'0'                WARNING LINE BUFFER ADDRESS
         SPACE 1                                               @G811PSS
***********************************************************************
*                                                                     *
*        CHANNEL PROGRAM AREA                                  @G811PSS
*                                                                     *
***********************************************************************
         SPACE 1                                               @G811PSS
         DS    0D
DCMCHPGM DC    28F'0'              CHANNEL PROGRAM AREA
         EJECT
***********************************************************************
*                                                                     *
*        SCREEN IMAGE BUFFER                                          *
*                                                                     *
***********************************************************************
         SPACE 1                                               @G811PSS
&AA      SETA  1
         DS    0F
         GINIT
         GSBLC DCMBASRT
DCMSRT   GSRT
         GEVM
         GDV   0,4095,B
         GECP  B
         GSBLC DCMBAM1
DCMMFRST DC    4X'40'              START OF FIRST MESSAGE LINE
.MSG     ANOP
         DC    69X'00'
         DC    X'15'
         AIF   (&AA EQ 46).LAST
         DC    4X'40'
&AA      SETA  &AA+1
         AGO   .MSG
.LAST    ANOP
DCMMLAST DC    4X'40'              START OF LAST MESSAGE LINE
         DC    69X'00'
         DC    X'15'
         GIBLC 3478
         GSBLC DCMBAPFK
DCMBLNK1 EQU   *
DCMPFKAR DC    73X'00'             PFK NUMBER AREA
         DC    X'15'
         GIBLC 74
         GSBLC DCMBAINS
DCMINSTR DC    73X'00'             INSTRUCTION LINE
         DC    X'15'
         GIBLC 74
         GECF  B
         GSBLC DCMBAENT
DCMENTRY DC    74X'40'             ENTRY
DCMENTR2 DC    74X'40'             AREA
         GIBLC 148
         GECP  B
         GSBLC DCMBAWRN
DCMWARN  DC    74X'40'             WARNING LINE
         GIBLC 74
         GTRU  DCMSRT
         GINIT
DCMERR   GSRT
         GEVM
         GDV   0,2048,B
         GECF  B
         AGO   .MORE
.TRY60   AIF   ('&DEVICE1' NE 'C').ANR
.**********************************************************************
.*                                                                    *
.*       DEVICE IS A 2260. GENERATE THE CHANNEL PROGRAM AREA   @G811PSS
.*       AND THE SCREEN IMAGE BUFFER.                          @G811PSS
.*                                                                    *
.**********************************************************************
         EJECT
***********************************************************************
*                                                                     *
*        CHANNEL PROGRAM AREA                                         *
*                                                                     *
***********************************************************************
         SPACE 1                                               @G811PSS
         DS    0D
DCMCHPGM DC    20F'0'              CHANNEL PROGRAM AREA
         EJECT
***********************************************************************
*                                                                     *
*        SCREEN IMAGE BUFFER                                          *
*                                                                     *
***********************************************************************
DCMLNE   DC    X'094A0000'         LINE ADDRESS AND ROOM FOR CHAN PROG
DCMLNEA  DC    X'094A'
         DS    0D
DCMMFRST DC    80C' '              FIRST MESSAGE LINE
         DC    80C' '
         DC    80C' '
         DC    80C' '
         DC    80C' '
         DC    80C' '
         DC    80C' '
         AIF   ('&USE1' EQ 'FC').FULL   TO FULL, FOR FULL CAPABILTIY
         DC    80C' '
         DC    80C' '
         DC    80C' '
DCMMLAST DC    80C' '              LAST MESSAGE LINE
         AGO   .WARN               FOR WARNING LINE
.FULL    ANOP
DCMMLAST DC    80C' '              LAST MESSAGE LINE
DCMINSTR DC    80C' '              INSTRUCTION LINE
DCMENTRY DC    80C' '              ENTRY
DCMENTR2 DC    80C' '                AREA
.WARN    ANOP
DCMWARN  DC    80C' '              WARNING LINE
         AGO   .MORE
.ANR     ANOP
         EJECT
         AIF   ('&DEVICE1' NE 'E').ANR2
.**********************************************************************
.*                                                                    *
.*       DEVICE IS A 3277/3278 MODEL 1. GENERATE THE CHANNEL   @G811PSS
.*       PROGRAM AREA AND THE SCREEN IMAGE BUFFER.             @G811PSS
.*                                                                    *
.**********************************************************************
***********************************************************************
*                                                                     *
*        CHANNEL PROGRAM AREA                                  @G811PSS
*                                                                     *
***********************************************************************
         SPACE 1                                               @G811PSS
DCMPFKC  DC    X'11D7F0'           SBA-A1-A2 FOR PFK LINE
         SPACE 1                                               @G811PSS
         DS    0D                  PADDING
DCMWCC   DC    X'00'               WRITE CONTROL CHARACTER
DCMEWAWC DC    X'40'               WRITE CONTROL CHARACTER FOR         X
                                   ERASE/WRITE ALTERNATE       @G811PSS
DCMERSDT DC    X'11C3C83CC3C840'   ERASE SCREEN DATA
*                                  (SBA-A1-A2-RA-A1-A2-BLANK)
*                                  (SBA-A1-A2-IC)
         DS    0D                  PADDING
DCMCCWS  CCW   SELECT,0,COMCHAN,1 SELECT CCW
SELECT   EQU   X'0B'               SELECT COMMAND CODE
COMCHAN  EQU   X'40'               COMMAND CHAINING FLAG
DCMCHPGM DC    24F'0'              CHANNEL PROGRAM AREA
         EJECT
***********************************************************************
*                                                                     *
*        SCREEN IMAGE BUFFER                                          *
*                                                                     *
***********************************************************************
         SPACE 1                                               @G811PSS
         DS    0F
DCMSRT   DC    X'1140401DE440'     SBA-A1-A2-SF-AT-DE
DCMLN00  EQU   *
DCMMFRST EQU   *
         DC    4C' '
         DC    34X'00'
         DC    X'1140E81DE440'     SBA-A1-A2-SF-AT-DE
DCMLN01  DC    4C' '               LINE NUMBER AND FLAGS
         DC    34X'00'             TEXT OF LINE
         DC    X'11C1501DE440'     SBA-A1-A2-SF-AT-DE
DCMLN02  DC    4C' '               LINE NUMBER AND FLAGS
         DC    34X'00'             TEXT OF LINE
         DC    X'11C1F81DE440'     SBA-A1-A2-SF-AT-DE
DCMLN03  DC    4C' '               LINE NUMBER AND FLAGS
         DC    34X'00'             TEXT OF LINE
         DC    X'11C2601DE440'     SBA-A1-A2-SF-AT-DE
DCMLN04  DC    4C' '               LINE NUMBER AND FLAGS
         DC    34X'00'             TEXT OF LINE
         DC    X'11C3C81DE440'     SBA-A1-A2-SF-AT-DE
DCMLN05  DC    4C' '               LINE NUMBER AND FLAGS
         DC    34X'00'             TEXT OF LINE
         DC    X'11C3F01DE440'     SBA-A1-A2-SF-AT-DE
DCMLN06  DC    4C' '               LINE NUMBER AND FLAGS
         DC    34X'00'             TEXT OF LINE
         DC    X'11C4D81DE440'     SBA-A1-A2-SF-AT-DE
DCMPFKAR EQU   *
DCMBLNK1 EQU   *
DCMLN07  DC    4C' '               LINE NUMBER AND FLAGS
         DC    34X'00'             TEXT OF LINE
         DC    X'11C5401DE440'     SBA-A1-A2-SF-AT-DE
DCMINSTR EQU   *
DCMLN08  DC    4C' '               LINE NUMBER AND FLAGS
         DC    34X'00'             TEXT OF LINE
         DC    X'11C5E81DE440'     SBA-A1-A2-SF-AT-DE
DCMENTRY EQU   *
DCMLN09  DC    4C' '               LINE NUMBER AND FLAGS
         DC    34X'00'             TEXT OF LINE
         DC    X'11C6501DE440'     SBA-A1-A2-SF-AT-DE
DCMMLAST EQU   *
DCMENTR2 EQU   *
DCMLN10  DC    4C' '               LINE NUMBER AND FLAGS
         DC    34X'00'             TEXT OF LINE
         DC    X'11C6F81DE840'     SBA-A1-A2-SF-AT-DE
DCMWARN  EQU   *
DCMLN11  DC    4C' '               LINE NUMBER AND FLAGS
         DC    34X'00'             TEXT OF LINE
         AGO   .MORE
.ANR2    ANOP
.**********************************************************************
.*                                                                    *
.*       DEVICE IS A 3277 MODEL 2 OR A 3278 MODEL 2,2A,3,4 OR  @G811PSS
.*       A 3279 MODEL 2A,2B,2C,3A,3B.                              @T1C
.*       GENERATE THE CHANNEL PROGRAM AREA AND THE             @G811PSS
.*       SCREEN IMAGE BUFFER.                                  @G811PSS
.*                                                                    *
.**********************************************************************
***********************************************************************
*                                                                     *
*        CHANNEL PROGRAM AREA                                  @G811PSS
*                                                                     *
***********************************************************************
         SPACE 1                                               @G811PSS
DCMPFKC  DS    0XL3                SBA-A1-A2 FOR PFK LINE      @G811PSS
         DC    XL1'&PFKSBA'        SET BUFFER ADDR             @G811PSS
DCMPFKRC DC    XL2'&PFKLNAD'       ADDR OF PFK LINE IN ROW-COLUMN      X
                                   FORMAT                      @G811PSS
         SPACE 1                                               @G811PSS
         DS    0D                  PADDING
DCMWCC   DC    X'00'               WRITE CONTROL CHARACTER
DCMEWAWC DC    X'40'               WRITE CONTROL CHARACTER FOR         X
                                   ERASE/WRITE ALTERNATE       @G811PSS
DCMERSDT DC    X'114B503C4B5040'   ERASE SCREEN DATA
*                                  (SBA-A1-A2-RA-A1-A2-BLANK)
DCMCRSDT DC    X'11404013'         INSERT CURSOR DATA
*                                  (SBA-A1-A2-IC)
         SPACE 1                                               @G860PSS
         DS    0D
DCMCCWS  CCW   SELECT,0,COMCHAN,1 SELECT CCW
SELECT   EQU   X'0B'               SELECT COMMAND CODE
COMCHAN  EQU   X'40'               COMMAND CHAINING FLAG
DCMCHPGM DC    38F'0'              CHANNEL PROGRAM AREA
         SPACE 1                                               @G860PSS
DCMAAREA DS    0XL2                CONVERSION AREA FOR A BUFFER        X
                                   POSITION                    @G860PSS
DCMROWA  DC    XL1'00'             ROW POSITION                @G860PSS
DCMCOLA  DC    XL1'00'             COLUMN POSTION              @G860PSS
         AIF   ('&DEVICE1' EQ 'J').EXSIB   IF 3279-2B GO BUILD EXTENDEDX
                                   SIB                         @G860PSS
         AIF   ('&DEVICE1' EQ 'K').EXSIB   IF 3279-3B GO BUILD EXTENDEDX
                                   SIB                         @G860PSS
         EJECT
***********************************************************************
*                                                                     *
*        SCREEN IMAGE BUFFER                                          *
*                                                                     *
***********************************************************************
         DS    0F
DCMSRT   DC    X'1140401DE440'     SBA-A1-A2-SF-AT-DE
DCMLN00  EQU   *
DCMMFRST EQU   *
         DC    4C' '
         DC    74X'00'
         DC    X'11C1501DE440'     SBA-A1-A2-SF-AT-DE
DCMLN01  DC    4C' '               LINE NUMBER AND FLAGS
         DC    74X'00'             TEXT OF LINE
         DC    X'11C2601DE440'     SBA-A1-A2-SF-AT-DE
DCMLN02  DC    4C' '               LINE NUMBER AND FLAGS
         DC    74X'00'             TEXT OF LINE
         DC    X'11C3F01DE440'     SBA-A1-A2-SF-AT-DE
DCMLN03  DC    4C' '               LINE NUMBER AND FLAGS
         DC    74X'00'             TEXT OF LINE
         DC    X'11C5401DE440'     SBA-A1-A2-SF-AT-DE
DCMLN04  DC    4C' '               LINE NUMBER AND FLAGS
         DC    74X'00'             TEXT OF LINE
         DC    X'11C6501DE440'     SBA-A1-A2-SF-AT-DE
DCMLN05  DC    4C' '               LINE NUMBER AND FLAGS
         DC    74X'00'             TEXT OF LINE
         DC    X'11C7601DE440'     SBA-A1-A2-SF-AT-DE
DCMLN06  DC    4C' '               LINE NUMBER AND FLAGS
         DC    74X'00'             TEXT OF LINE
         DC    X'11C8F01DE440'     SBA-A1-A2-SF-AT-DE
DCMLN07  DC    4C' '               LINE NUMBER AND FLAGS
         DC    74X'00'             TEXT OF LINE
         DC    X'114A401DE440'     SBA-A1-A2-SF-AT-DE
DCMLN08  DC    4C' '               LINE NUMBER AND FLAGS
         DC    74X'00'             TEXT OF LINE
         DC    X'114B501DE440'     SBA-A1-A2-SF-AT-DE
DCMLN09  DC    4C' '               LINE NUMBER AND FLAGS
         DC    74X'00'             TEXT OF LINE
         DC    X'114C601DE440'     SBA-A1-A2-SF-AT-DE
DCMLN10  DC    4C' '               LINE NUMBER AND FLAGS
         DC    74X'00'             TEXT OF LINE
         DC    X'114DF01DE440'     SBA-A1-A2-SF-AT-DE
DCMLN11  DC    4C' '               LINE NUMBER AND FLAGS
         DC    74X'00'             TEXT OF LINE
         DC    X'114F401DE440'     SBA-A1-A2-SF-AT-DE
DCMLN12  DC    4C' '               LINE NUMBER AND FLAGS
         DC    74X'00'             TEXT OF LINE
         DC    X'1150501DE440'     SBA-A1-A2-SF-AT-DE
DCMLN13  DC    4C' '               LINE NUMBER AND FLAGS
         DC    74X'00'             TEXT OF LINE
         DC    X'11D1601DE440'     SBA-A1-A2-SF-AT-DE
DCMLN14  DC    4C' '               LINE NUMBER AND FLAGS
         DC    74X'00'             TEXT OF LINE
         DC    X'11D2F01DE440'     SBA-A1-A2-SF-AT-DE
         AIF   ('&DEVICE1' EQ 'I').SBENDUP  IF 3278-2A/3279-2C, GO     X
                                            BUILD LAST LINES       @T1C
DCMLN15  DC    4C' '               LINE NUMBER AND FLAGS
         DC    74X'00'             TEXT OF LINE
         DC    X'11D4401DE440'     SBA-A1-A2-SF-AT-DE
DCMLN16  DC    4C' '               LINE NUMBER AND FLAGS
         DC    74X'00'             TEXT OF LINE
         DC    X'11D5501DE440'     SBA-A1-A2-SF-AT-DE
DCMLN17  DC    4C' '               LINE NUMBER AND FLAGS
         DC    74X'00'             TEXT OF LINE
         DC    X'11D6601DE440'     SBA-A1-A2-SF-AT-DE
         AIF   ('&DEVICE1' EQ 'D' AND '&USE1' EQ 'FC').SB772FC BRANCH  X
                                   IF 3277-2 IN FC MODE        @G811PSS
DCMLN18  DC    4C' '               LINE NUMBER AND FLAGS
         DC    74X'00'             TEXT OF LINE
         AIF   ('&DEVICE1' EQ 'D').SB772OO BRANCH IF 3277-2. MUST BE   X
                                   IN SD OR MS MODE            @G811PSS
         DC    X'11D7F01DE440'     SBA-A1-A2-SF-ATT (PROT,DETECT)      X
                                                               @G811PSS
         AIF   ('&DEVICE1' EQ 'F').SBENDUP IF 3278-2/3279-2A    GO     X
                                   BUILD LAST LINES            @G860PSS
DCMLN19  DC    4C' '               LINE NUMBER AND FLAGS
         DC    74X'00'             TEXT OF LINE
         DC    X'11D9401DE440'     SBA-A1-A2-SF-AT-DE
DCMLN20  DC    4C' '               LINE NUMBER AND FLAGS
         DC    74X'00'             TEXT OF LINE
         DC    X'115A501DE440'     SBA-A1-A2-SF-AT-DE
DCMLN21  DC    4C' '               LINE NUMBER AND FLAGS
         DC    74X'00'             TEXT OF LINE
         DC    X'115B601DE440'     SBA-A1-A2-SF-AT-DE
DCMLN22  DC    4C' '               LINE NUMBER AND FLAGS
         DC    74X'00'             TEXT OF LINE
         DC    X'115CF01DE440'     SBA-A1-A2-SF-ATT (PROT,DETECT)      X
                                                               @G811PSS
DCMLN23  DC    4C' '               LINE NUMBER AND FLAGS
         DC    74X'00'             TEXT OF LINE
         DC    X'115E401DE440'     SBA-A1-A2-SF-ATT (PROT,DETECT)      X
                                                               @G811PSS
DCMLN24  DC    4C' '               LINE NUMBER AND FLAGS       @G811PSS
         DC    74X'00'             TEXT OF LINE                @G811PSS
         DC    X'115F501DE440'     SBA-A1-A2-SF-ATT (PROT,DETECT)      X
                                                               @G811PSS
DCMLN25  DC    4C' '               LINE NUMBER AND FLAGS       @G811PSS
         DC    74X'00'             TEXT OF LINE                @G811PSS
         DC    X'1160601DE440'     SBA-A1-A2-SF-ATT (PROT,DETECT)      X
                                                               @G811PSS
DCMLN26  DC    4C' '               LINE NUMBER AND FLAGS       @G811PSS
         DC    74X'00'             TEXT OF LINE                @G811PSS
         DC    X'1161F01DE440'     SBA-A1-A2-SF-ATT (PROT,DETECT)      X
                                                               @G811PSS
         AIF   ('&DEVICE1' EQ 'G').SBENDUP IF 3278-3 OR 3279-3A        X
                                   GO BUILD LAST LINES         @G860PSS
DCMLN27  DC    4C' '               LINE NUMBER AND FLAGS       @G811PSS
         DC    74X'00'             TEXT OF LINE                @G811PSS
         DC    X'11E3401DE440'     SBA-A1-A2-SF-ATT (PROT,DETECT)      X
                                                               @G811PSS
DCMLN28  DC    4C' '               LINE NUMBER AND FLAGS       @G811PSS
         DC    74X'00'             TEXT OF LINE                @G811PSS
         DC    X'11E4501DE440'     SBA-A1-A2-SF-ATT (PROT,DETECT)      X
                                                               @G811PSS
DCMLN29  DC    4C' '               LINE NUMBER AND FLAGS       @G811PSS
         DC    74X'00'             TEXT OF LINE                @G811PSS
         DC    X'11E5601DE440'     SBA-A1-A2-SF-ATT (PROT,DETECT)      X
                                                               @G811PSS
DCMLN30  DC    4C' '               LINE NUMBER AND FLAGS       @G811PSS
         DC    74X'00'             TEXT OF LINE                @G811PSS
         DC    X'11E6F01DE440'     SBA-A1-A2-SF-ATT (PROT,DETECT)      X
                                                               @G811PSS
DCMLN31  DC    4C' '               LINE NUMBER AND FLAGS       @G811PSS
         DC    74X'00'             TEXT OF LINE                @G811PSS
         DC    X'11E8401DE440'     SBA-A1-A2-SF-ATT (PROT,DETECT)      X
                                                               @G811PSS
DCMLN32  DC    4C' '               LINE NUMBER AND FLAGS       @G811PSS
         DC    74X'00'             TEXT OF LINE                @G811PSS
         DC    X'11E9501DE440'     SBA-A1-A2-SF-ATT (PROT,DETECT)      X
                                                               @G811PSS
DCMLN33  DC    4C' '               LINE NUMBER AND FLAGS       @G811PSS
         DC    74X'00'             TEXT OF LINE                @G811PSS
         DC    X'116A601DE440'     SBA-A1-A2-SF-ATT (PROT,DETECT)      X
                                                               @G811PSS
DCMLN34  DC    4C' '               LINE NUMBER AND FLAGS       @G811PSS
         DC    74X'00'             TEXT OF LINE                @G811PSS
         DC    X'116BF01DE440'     SBA-A1-A2-SF-ATT (PROT,DETECT)      X
                                                               @G811PSS
DCMLN35  DC    4C' '               LINE NUMBER AND FLAGS       @G811PSS
         DC    74X'00'             TEXT OF LINE                @G811PSS
         DC    X'116D401DE440'     SBA-A1-A2-SF-ATT (PROT,DETECT)      X
                                                               @G811PSS
DCMLN36  DC    4C' '               LINE NUMBER AND FLAGS       @G811PSS
         DC    74X'00'             TEXT OF LINE                @G811PSS
         DC    X'116E501DE440'     SBA-A1-A2-SF-ATT (PROT,DETECT)      X
                                                               @G811PSS
DCMLN37  DC    4C' '               LINE NUMBER AND FLAGS       @G811PSS
         DC    74X'00'             TEXT OF LINE                @G811PSS
         DC    X'116F601DE440'     SBA-A1-A2-SF-ATT (PROT,DETECT)      X
                                                               @G811PSS
         AGO   .SBENDUP            GO BUILD LAST LINE          @G811PSS
.**********************************************************************
.*                                                                    *
.*       BUILD LINE 19 AND THE PFK LINE FOR THE 3277-2 DEVICE  @G811PSS
.*                                                                    *
.**********************************************************************
.SB772FC ANOP                      DEVICE IS A 3277-2          @G811PSS
DCMMLAST EQU   *                   LAST LINE IN MSG AREA       @G811PSS
DCMLN18  DC    4C' '               LINE NUMBER AND FLAGS       @G811PSS
         DC    74X'00'             TEXT OF LINE                @G811PSS
DCMPFKAR DC    X'000000000000'     DUMMY SBA-A1-A2-SF-AT-DE   MC YM3860
DCMBLNK1 EQU   *
         AGO   .SBEDUP1            GO BUILD LAST LINE          @G811PSS
.SB772OO ANOP                      DEVICE IS 3277-2 OUTPUT ONLY        X
                                                               @G811PSS
DCMPFKAR DC    X'11D7F01DE440'     SBA-A1-A2-SF-ATT (PROT,DETECT)      X
                                                               @G811PSS
DCMBLNK1 EQU   *                                               @G811PSS
         AGO   .SBEDUP1            GO BUILD LAST LINE          @G811PSS
.**********************************************************************
.*                                                                    *
.*       BUILD THE LAST LINE OF THE SCREEN IMAGE BUFFERS FOR   @G811PSS
.*       THE 3278'S, 3277-2 AND THE 3279-2A,3A DEVICES         @G860PSS
.*                                                                    *
.**********************************************************************
.SBENDUP AIF   ('&USE1' NE 'FC').SBEDUP1 TEST FOR OUTPUT ONLY  @G811PSS
DCMMLAST EQU   *                   LAST LINE IN MSG AREA       @G811PSS
.SBEDUP1 ANOP                                                  @G811PSS
&AA      SETA  &ENDLNUM            SET COUNTER FOR LINE NUMBER @G811PSS
DCMLN&AA DC    4C' '                                           @G811PSS
         DC    74X'00'             TEXT OF LINE                @G811PSS
         DC    XL6'&SBAINST'       SBA FOR INSTR LINE          @G811PSS
DCMINSTR EQU   *                   INSTRUCTION LINE            @G811PSS
&AA      SETA  &AA+1               BUMP LINE NUMBER            @G811PSS
DCMLN&AA DC    4C' '                                           @G811PSS
         DC    74X'00'             TEXT OF LINE                @G811PSS
         DC    XL6'&SBAENT1'       SBA FOR 1ST ENTRY LINE      @G811PSS
DCMENTRY EQU   *                   LAST LINE IN MSG AREA       @G811PSS
&AA      SETA  &AA+1               BUMP LINE NUMBER            @G811PSS
DCMLN&AA DC    4C' '                                           @G811PSS
         DC    74X'00'             TEXT OF LINE                @G811PSS
         DC    XL6'&SBAENT2'       SBA FOR 2ND ENTRY LINE      @G811PSS
DCMENTR2 EQU   *                   2ND LINE OF ENTRY AREA      @G811PSS
&AA      SETA  &AA+1               BUMP LINE NUMBER            @G811PSS
         AIF   (('&USE1' NE 'MS') AND ('&DEVICE1' NE 'D' OR            X
               '&USE1' NE 'SD')).SBNOMLT TEST FOR MS MODE OR 3277-2 IN X
                                   SD MODE                     @G811PSS
DCMMLAST EQU   *                   LAST LINE IN MSG AREA       @G811PSS
.SBNOMLT ANOP                                                  @G811PSS
DCMLN&AA DC    4C' '                                           @G811PSS
         DC    74X'00'             TEXT OF LAST LINE           @G811PSS
         DC    XL6'&SBAWARN'       SBA FOR WARNING LINE        @G811PSS
         AIF   ('&USE1' NE 'SD' OR '&DEVICE1' EQ 'D').SBNOML1  @G811PSS
DCMMLAST EQU   *                   LAST LINE IN MSG AREA       @G811PSS
.SBNOML1 ANOP                                                  @G811PSS
DCMWARN  EQU   *                   WARNING LINE                @G811PSS
&AA      SETA  &AA+1               BUMP LINE NUMBER            @G811PSS
DCMLN&AA DC    4C' '                                           @G811PSS
         DC    74X'00'             TEXT OF LINE                @G811PSS
         DC    6C' '               DUMMY COMMAND AREA          @G811PSS
DCMLNEND EQU   *                   LINE AFTER LAST LINE        @G811PSS
         DC    4C' '               DUMMY LINE NUMBER AND FLAGS @G811PSS
         AGO   .MORE                                           @G860PSS
.**********************************************************************
.*                                                                    *
.*       BUILD THE SCREEN IMAGE BUFFER FOR 3279-2B,3B          @G860PSS
.*                                                                    *
.**********************************************************************
.EXSIB   ANOP                                                  @G860PSS
         EJECT                                                 @G860PSS
***************************************************************@G860PSS
*                                                              @G860PSS
*        SCREEN IMAGE BUFFER                                   @G860PSS
*                                                              @G860PSS
***************************************************************@G860PSS
         DS    0F                                              @G860PSS
DCMSRT   DC    X'1140402903C0E442F4410040' SBA-A1-A2-SF-AT-DE  @G860PSS
DCMLN00  EQU   *                                               @G860PSS
DCMMFRST EQU   *                                               @G860PSS
         DC    4C' '                                           @G860PSS
         DC    74X'00'                                         @G860PSS
         DC    X'11C1502903C0E442F4410040' SBA-A1-A2-SF-AT-DE  @G860PSS
DCMLN01  DC    4C' '               LINE NUMBER AND FLAGS       @G860PSS
         DC    74X'00'             TEXT OF LINE                @G860PSS
         DC    X'11C2602903C0E442F4410040' SBA-A1-A2-SF-AT-DE  @G860PSS
DCMLN02  DC    4C' '               LINE NUMBER AND FLAGS       @G860PSS
         DC    74X'00'             TEXT OF LINE                @G860PSS
         DC    X'11C3F02903C0E442F4410040' SBA-A1-A2-SF-AT-DE  @G860PSS
DCMLN03  DC    4C' '               LINE NUMBER AND FLAGS       @G860PSS
         DC    74X'00'             TEXT OF LINE                @G860PSS
         DC    X'11C5402903C0E442F4410040' SBA-A1-A2-SF-AT-DE  @G860PSS
DCMLN04  DC    4C' '               LINE NUMBER AND FLAGS       @G860PSS
         DC    74X'00'             TEXT OF LINE                @G860PSS
         DC    X'11C6502903C0E442F4410040' SBA-A1-A2-SF-AT-DE  @G860PSS
DCMLN05  DC    4C' '               LINE NUMBER AND FLAGS       @G860PSS
         DC    74X'00'             TEXT OF LINE                @G860PSS
         DC    X'11C7602903C0E442F4410040' SBA-A1-A2-SF-AT-DE  @G860PSS
DCMLN06  DC    4C' '               LINE NUMBER AND FLAGS       @G860PSS
         DC    74X'00'             TEXT OF LINE                @G860PSS
         DC    X'11C8F02903C0E442F4410040' SBA-A1-A2-SF-AT-DE  @G860PSS
DCMLN07  DC    4C' '               LINE NUMBER AND FLAGS       @G860PSS
         DC    74X'00'             TEXT OF LINE                @G860PSS
         DC    X'114A402903C0E442F4410040' SBA-A1-A2-SF-AT-DE  @G860PSS
DCMLN08  DC    4C' '               LINE NUMBER AND FLAGS       @G860PSS
         DC    74X'00'             TEXT OF LINE                @G860PSS
         DC    X'114B502903C0E442F4410040' SBA-A1-A2-SF-AT-DE  @G860PSS
DCMLN09  DC    4C' '               LINE NUMBER AND FLAGS       @G860PSS
         DC    74X'00'             TEXT OF LINE                @G860PSS
         DC    X'114C602903C0E442F4410040' SBA-A1-A2-SF-AT-DE  @G860PSS
DCMLN10  DC    4C' '               LINE NUMBER AND FLAGS       @G860PSS
         DC    74X'00'             TEXT OF LINE                @G860PSS
         DC    X'114DF02903C0E442F4410040' SBA-A1-A2-SF-AT-DE  @G860PSS
DCMLN11  DC    4C' '               LINE NUMBER AND FLAGS       @G860PSS
         DC    74X'00'             TEXT OF LINE                @G860PSS
         DC    X'114F402903C0E442F4410040' SBA-A1-A2-SF-AT-DE  @G860PSS
DCMLN12  DC    4C' '               LINE NUMBER AND FLAGS       @G860PSS
         DC    74X'00'             TEXT OF LINE                @G860PSS
         DC    X'1150502903C0E442F4410040' SBA-A1-A2-SF-AT-DE  @G860PSS
DCMLN13  DC    4C' '               LINE NUMBER AND FLAGS       @G860PSS
         DC    74X'00'             TEXT OF LINE                @G860PSS
         DC    X'11D1602903C0E442F4410040' SBA-A1-A2-SF-AT-DE  @G860PSS
DCMLN14  DC    4C' '               LINE NUMBER AND FLAGS       @G860PSS
         DC    74X'00'             TEXT OF LINE                @G860PSS
         DC    X'11D2F02903C0E442F4410040' SBA-A1-A2-SF-AT-DE  @G860PSS
DCMLN15  DC    4C' '               LINE NUMBER AND FLAGS       @G860PSS
         DC    74X'00'             TEXT OF LINE                @G860PSS
         DC    X'11D4402903C0E442F4410040' SBA-A1-A2-SF-AT-DE  @G860PSS
DCMLN16  DC    4C' '               LINE NUMBER AND FLAGS       @G860PSS
         DC    74X'00'             TEXT OF LINE                @G860PSS
         DC    X'11D5502903C0E442F4410040' SBA-A1-A2-SF-AT-DE  @G860PSS
DCMLN17  DC    4C' '               LINE NUMBER AND FLAGS       @G860PSS
         DC    74X'00'             TEXT OF LINE                @G860PSS
         DC    X'11D6602903C0E442F4410040' SBA-A1-A2-SF-AT-DE  @G860PSS
DCMLN18  DC    4C' '               LINE NUMBER AND FLAGS       @G860PSS
         DC    74X'00'             TEXT OF LINE                @G860PSS
         DC    X'11D7F02903C0E442F4410040' SBA-A1-A2-SF-ATT            X
                                   (PROT,DETECT)               @G860PSS
         AIF   ('&DEVICE1' EQ 'J').EXENDUP IF 3279-2B GO BUILD LAST    X
                                   LINES                       @G860PSS
DCMLN19  DC    4C' '               LINE NUMBER AND FLAGS       @G860PSS
         DC    74X'00'             TEXT OF LINE                @G860PSS
         DC    X'11D9402903C0E442F4410040' SBA-A1-A2-SF-AT-DE  @G860PSS
DCMLN20  DC    4C' '               LINE NUMBER AND FLAGS       @G860PSS
         DC    74X'00'             TEXT OF LINE                @G860PSS
         DC    X'115A502903C0E442F4410040' SBA-A1-A2-SF-AT-DE  @G860PSS
DCMLN21  DC    4C' '               LINE NUMBER AND FLAGS       @G860PSS
         DC    74X'00'             TEXT OF LINE                @G860PSS
         DC    X'115B602903C0E442F4410040' SBA-A1-A2-SF-AT-DE  @G860PSS
DCMLN22  DC    4C' '               LINE NUMBER AND FLAGS       @G860PSS
         DC    74X'00'             TEXT OF LINE                @G860PSS
         DC    X'115CF02903C0E442F4410040' SBA-A1-A2-SF-ATT            X
                                   (PROT,DETECT)               @G860PSS
DCMLN23  DC    4C' '               LINE NUMBER AND FLAGS       @G860PSS
         DC    74X'00'             TEXT OF LINE                @G860PSS
         DC    X'115E402903C0E442F4410040' SBA-A1-A2-SF-ATT            X
                                   (PROT,DETECT)               @G860PSS
DCMLN24  DC    4C' '               LINE NUMBER AND FLAGS       @G860PSS
         DC    74X'00'             TEXT OF LINE                @G860PSS
         DC    X'115F502903C0E442F4410040' SBA-A1-A2-SF-ATT            X
                                   (PROT,DETECT)               @G860PSS
DCMLN25  DC    4C' '               LINE NUMBER AND FLAGS       @G860PSS
         DC    74X'00'             TEXT OF LINE                @G860PSS
         DC    X'1160602903C0E442F4410040' SBA-A1-A2-SF-ATT            X
                                   (PROT,DETECT)               @G860PSS
DCMLN26  DC    4C' '               LINE NUMBER AND FLAGS       @G860PSS
         DC    74X'00'             TEXT OF LINE                @G860PSS
         DC    X'1161F02903C0E442F4410040' SBA-A1-A2-SF-ATT            X
                                   (PROT,DETECT)               @G860PSS
.**************************************************************@G860PSS
.*                                                             @G860PSS
.*       BUILD THE LAST LINE OF THE SCREEN IMAGE BUFFERS FOR   @G860PSS
.*       THE 3279-2B,3B DEVICES                                @G860PSS
.*                                                             @G860PSS
.**************************************************************@G860PSS
.EXENDUP AIF   ('&USE1' NE 'FC').EXEDUP1 TEST FOR OUTPUT ONLY  @G860PSS
DCMMLAST EQU   *                   LAST LINE IN MSG AREA       @G860PSS
.EXEDUP1 ANOP                                                  @G860PSS
&AA      SETA  &ENDLNUM            SET COUNTER FOR LINE NUMBER @G860PSS
DCMLN&AA DC    4C' '                                           @G860PSS
         DC    74X'00'             TEXT OF LINE                @G860PSS
         DC    XL12'&SBAINST'      SBA FOR INSTR LINE          @G860PSS
DCMINSTR EQU   *                   INSTRUCTION LINE            @G860PSS
&AA      SETA  &AA+1               BUMP LINE NUMBER            @G860PSS
DCMLN&AA DC    4C' '                                           @G860PSS
         DC    74X'00'             TEXT OF LINE                @G860PSS
         DC    XL12'&SBAENT1'      SBA FOR 1ST ENTRY LINE      @G860PSS
DCMENTRY EQU   *                   LAST LINE IN MSG AREA       @G860PSS
&AA      SETA  &AA+1               BUMP LINE NUMBER            @G860PSS
DCMLN&AA DC    4C' '                                           @G860PSS
         DC    74X'00'             TEXT OF LINE                @G860PSS
         DC    XL12'&SBAENT2'      SBA FOR 2ND ENTRY LINE      @G860PSS
DCMENTR2 EQU   *                   2ND LINE OF ENTRY AREA      @G860PSS
&AA      SETA  &AA+1               BUMP LINE NUMBER            @G860PSS
         AIF   ('&USE1' NE 'MS').EXNOMLT TEST FOR MS MODE      @G860PSS
DCMMLAST EQU   *                   LAST LINE IN MSG AREA       @G860PSS
.EXNOMLT ANOP                                                  @G860PSS
DCMLN&AA DC    4C' '                                           @G860PSS
         DC    74X'00'             TEXT OF LAST LINE           @G860PSS
         DC    XL12'&SBAWARN'      SBA FOR WARNING LINE        @G860PSS
         AIF   ('&USE1' NE 'SD').EXNOML1                       @G860PSS
DCMMLAST EQU   *                   LAST LINE IN MSG AREA       @G860PSS
.EXNOML1 ANOP                                                  @G860PSS
DCMWARN  EQU   *                   WARNING LINE                @G860PSS
&AA      SETA  &AA+1               BUMP LINE NUMBER            @G860PSS
DCMLN&AA DC    4C' '                                           @G860PSS
         DC    74X'00'             TEXT OF LINE                @G860PSS
         DC    12C' '              DUMMY COMMAND AREA          @G860PSS
DCMLNEND EQU   *                   LINE AFTER LAST LINE        @G860PSS
         DC    4C' '               DUMMY LINE NUMBER AND FLAGS @G860PSS
.MORE    ANOP
.**********************************************************************
.*                                                                    *
.*       GENERATE THE DOM ID NUMBERS, SCT'S AND SSCT'S FOR     @G811PSS
.*       ALL DEVICES.                                          @G811PSS
.*                                                                    *
.**********************************************************************
         EJECT
***********************************************************************
*                                                                     *
*        DOM IDENTIFICATION NUMBERS                                   *
*                                                                     *
***********************************************************************
         SPACE 1                                               @G811PSS
&AA      SETA  1
.MOREX   ANOP
DCMDOM&AA DC    XL8'0'              DOM NUMBER
&AA      SETA  &AA+1
         AIF   (&AA LE &BB).MOREX   BACK TO MORE FOR NEXT DOM
         EJECT
&AA      SETA  1
***********************************************************************
*                                                                     *
*        SCREEN CONTROL TABLES                                        *
*                                                                     *
***********************************************************************
         SPACE 1                                               @G811PSS
.NEXT    ANOP
DCMMSG&AA DC   X'0000'             SCREEN CONTROL ENTRY
&AA      SETA  &AA+1
         AIF   ('&AA' LE '&DD').NEXT
DCMMSGED DC    X'0000'             OUTPUT ONLY STOPPER LOCATION        X
                                                               @G811PSS
         ORG   DCMMSG&CC+2
DCMMSGND DC    X'01'               STOPPER FOR SCT
         ORG
         EJECT
&AA      SETA  1
***********************************************************************
*                                                                     *
*        SECONDARY SCREEN CONTROL TABLES                              *
*                                                                     *
***********************************************************************
         SPACE 1                                               @G811PSS
.NEXT2   ANOP
DCMSEC&AA DC   X'00'               SECONDARY SCREEN CONTROL ENTRY
&AA      SETA  &AA+1
         AIF   ('&AA' LE '&DD').NEXT2
DCMSECED DC    X'00'               OUTPUT ONLY STOPPER LOCATION        X
                                                               @G811PSS
         ORG   DCMSEC&CC+1
DCMSECND DC    X'01'               STOPPER FOR SSCT
         ORG
.SSCT    ANOP
         EJECT
***********************************************************************
*                                                                     *
*        MAPPING OF A SCREEN CONTROL TABLE (SCT) ENTRY         @G811PSS
*                                                                     *
*        FIRST BYTE OF AN SCT                                  @G811PSS
*                                                                     *
***********************************************************************
         SPACE 1                                               @G811PSS
DCMMSGR1 EQU   X'80'               RESERVED - WAS DCMMSGWR         @L1A
DCMMSGIN EQU   X'40'               MESSAGE DISPLAYED IN LINE
DCMMSGCN EQU   X'20'               MESSAGE CONTINUED ON NEXT LINE
DCMMSGJK EQU   X'10'               TO WRITE OUT-OF-LINE DISPLAY FROM
*                                  MAY CONTAIN JUNK (SDS INTERFACE 2)
DCMMSGAD EQU   X'08'               MESSAGE CAN BE DELETED AUTOMATICALLY
DCMMSGRD EQU   X'04'               REQUEST HAS SPECIFIED MSG BE REMOVED
DCMMSGIF EQU   X'02'               INFORMATIONAL MESSAGE IN LINE
DCMMSGST EQU   X'01'               END OF TABLE INDICATOR
         SPACE 1                                               @G811PSS
***********************************************************************
*                                                                     *
*        SECOND BYTE OF AN SCT                                 @G811PSS
*                                                                     *
***********************************************************************
         SPACE 1                                               @G811PSS
DCMMSGAC EQU   X'80'               ACTION MESSAGE
DCMMSGC7 EQU   X'40'               DESCRIPTOR CODE 7 MESSAGE
DCMMSGR2 EQU   X'20'               RESERVED - WAS DCMMSGDM         @L1A
DCMMSGUA EQU   X'10'               URGENT ATTENTION MESSAGE DISPLAYED  X
                                   IN LINE                         @L1A
.* BIT DCMMSGAR HAS BEEN DELETED BY SUPPORT G811PSS            @G811PSS
DCMMSGEA EQU   X'08'               EVENTUAL ACTION MESSAGE DISPLAYED   X
                                   IN LINE - WAS DCMMSGIR          @L1A
DCMMSGCT EQU   X'04'               CONTINUATION LINE
DCMMSGPP EQU   X'02'               ISSUED BY PROBLEM PROGRAM
DCMMSGCL EQU   X'01'               CONTROL LINE OF IN LINE MLWTO
         EJECT
***********************************************************************
*                                                                     *
*    MAPPING OF A SECONDARY SCREEN CONTROL TABLE (SSCT) ENTRY  @G811PSS
*                                                                     *
***********************************************************************
         SPACE 1                                               @G811PSS
DCMSECCL EQU   X'80'               CONTROL LINE OF OUT OF LINE DISPLAY
DCMSECLL EQU   X'40'               LABEL LINE OF OUT OF LINE DISPLAY
DCMSECDL EQU   X'20'               DATA LINE OF OUT OF LINE DISPLAY
DCMSECBL EQU   X'10'               THIS LINE IS BLANKED
DCMSECDD EQU   X'02'               LINE RESERVED FOR DYNAMIC DISPLAY
DCMSECST EQU   X'01'               END OF TABLE INDICATOR
         AIF   ('&DEVICE1' EQ 'J').EXTORD A 3279-2B?           @G860PSS
         AIF   ('&DEVICE1' NE 'K').ORDMAP A 3279-3B?           @G860PSS
.EXTORD  ANOP                                                  @G860PSS
         EJECT                                                 @G860PSS
***************************************************************@G860PSS
*                                                              @G860PSS
*        ADJUNCT EXTENDED SCREEN CONTROL ORDERS FOR 3279-2B,3B @G860PSS
*                                                              @G860PSS
*        THE FIELDS ARE DEFINED AS FOLLOWS:                    @G860PSS
*           SBA-A1-A2,SFE-#-FA-ATT1-CA-ATT2-HA-ATT3            @G860PSS
*                                                              @G860PSS
*        WHERE:                                                @G860PSS
*           SBA  - SET BUFFER ADDRESS ORDER                    @G860PSS
*           A1   - ROW ADDRESS OF SCREEN                       @G860PSS
*           A2   - COLUMN ADDRESS OF SCREEN                    @G860PSS
*           SFE  - START FIELD EXTENDED ORDER                  @G860PSS
*           #    - NUMBER OF TYPE/VALUE PAIRS FOLLOWING THIS   @G860PSS
*                  ORDER                                       @G860PSS
*           FA   - FIELD ATTRIBUTE TYPE                        @G860PSS
*           ATT1 - FIELD ATTRIBUTE VALUE                       @G860PSS
*                  (PROTECTED,DETECTABLE)                      @G860PSS
*           CA   - COLOR ATTRIBUTE TYPE                        @G860PSS
*           ATT2 - COLOR ATTRIBUTE VALUE (GREEN)               @G860PSS
*           HA   - HIGHLIGHTING ATTRIBUTE TYPE                 @G860PSS
*           ATT3 - HIGHLIGHTING ATTRIBUTE VALUE (DEFAULT-NONE) @G860PSS
*                                                              @G860PSS
***************************************************************@G860PSS
         SPACE 1                                               @G860PSS
         DS    0F                                              @G860PSS
         SPACE 1                                               @G860PSS
***************************************************************@G860PSS
*                                                              @G860PSS
*        AREA FOR EXTENDED ORDERS FOR LINES WITH MORE THAN     @G860PSS
*        ONE FIELD TO BE DEFINED ON THE SCREEN. AREA CONTAINS  @G860PSS
*        TWO TIMES THE NUMBER OF LINES ON THE SCREEN.          @G860PSS
*                                                              @G860PSS
***************************************************************@G860PSS
         SPACE 1                                               @G860PSS
         AIF   ('&DEVICE1' EQ 'K').EXOD3B MAP A 3279-3B?       @G860PSS
DCMEXOD1 DC    48X'1100002903C0E442F44100'                     @G860PSS
         AGO   .ORDMAP                                         @G860PSS
.EXOD3B  ANOP                                                  @G860PSS
DCMEXOD1 DC    64X'1100002903C0E442F44100'                     @G860PSS
.ORDMAP  ANOP                                                  @G860PSS
         SPACE 4                                               @G860PSS
         DS    0D                   PAD TO DOUBLE WORD
ENDDCM   EQU   *
         AIF   ('&DEVICE1' EQ 'J').MAPORD A 3279-2B?           @G860PSS
         AIF   ('&DEVICE1' NE 'K').EXIT   A 3279-3B?           @G860PSS
.MAPORD  ANOP                                                  @G860PSS
         EJECT                                                 @G860PSS
***************************************************************@G860PSS
*                                                              @G860PSS
*        MAP OF THE EXTENDED ORDERS FOR THE 3270 DEVICES       @G860PSS
*                                                              @G860PSS
***************************************************************@G860PSS
         SPACE 1                                               @G860PSS
DCMORDER DSECT                                                 @G860PSS
DCMSBAO  DS    0XL3               SET BUFFER ADDRESS FIELD     @G860PSS
DCMSBA   DS    XL1                SET BUFFER ADDRESS ORDER     @G860PSS
DCMSBAA1 DS    XL1                SET BUFFER ADDRESS ROW ADDR  @G860PSS
DCMSBAA2 DS    XL1                SET BUFFER ADDRESS COL ADDR  @G860PSS
         SPACE 1                                               @G860PSS
DCMSFEO  DS    0XL8               START FIELD EXTENDED FIELD   @G860PSS
DCMSFE   DS    XL1                START FIELD EXTENDED ORDER   @G860PSS
DCMSFEN  DS    XL1                NUMBER OF TYPE/VALUE PAIRS WHICH     X
                                  FOLLOW                       @G860PSS
DCMSFEFT DS    XL1                FIELD ATTRIBUTE TYPE         @G860PSS
DCMSFEFA DS    XL1                FIELD ATTRIBUTE VALUE        @G860PSS
DCMSFECT DS    XL1                COLOR ATTRIBUTE TYPE         @G860PSS
DCMSFECA DS    XL1                COLOR ATTRIBUTE VALUE        @G860PSS
DCMSFEHT DS    XL1                HIGHLIGHTING ATTRIBUTE TYPE  @G860PSS
DCMSFEHA DS    XL1                HIGHLIGHTING ATTRIBUTE VALUE @G860PSS
         SPACE 1                                               @G860PSS
DCMORDLN EQU   *-DCMORDER         LENGTH OF EXTENDED ORDER FIELDS      X
                                                               @G860PSS
.EXIT    ANOP                                                  @G860PSS
         MEND
         MACRO
         IEECRDCM    &A=,&KEY=,&DSECT=                         @G860P2G
         SPACE 1                                               @G64UPSS
***********************************************************************
*                                                              @G64UPSS
*          IEECRDCM - RESIDENT DISPLAY CONTROL MODULE          @G64UPSS
*                                                              @G64UPSS
* COPYRIGHT  -                                                     @T1C
*              5740-XC6 COPYRIGHT IBM CORP 1980, 1983,
*              LICENSED MATERIAL-PROGRAM, PROPERTY OF IBM,
*              REFER TO COPYRIGHT INSTRUCTIONS FORM NUMBER G120-2083.
*
* STATUS     - OS/VS2 JBB2110                                      @T1C
*                                                              @G64UPSS
* INVOCATION - SPECIFY: IEECRDCM A=,KEY=,DSECT=                @G860P2G
*              WHERE:                                          @G64UPSS
*
*                A=     NUMBER OF DISPLAY AREAS AND THE        @G64UPSS
*                       LENGTHS OF EACH.                       @G64UPSS
*                       EXAMPLE: A=(6,4) WHERE TWO AREAS ARE   @G64UPSS
*                       BEING DEFINED. THE FIRST CONSISTS OF   @G64UPSS
*                       6 LINES; THE SECOND OF 4 LINES.        @G64UPSS
*
*                KEY=   THE NUMBER OF PROGRAM FUNCTION KEYS    @G860P2G
*                       DEFINED FOR THIS DEVICE.               @G860P2G
*
*                DSECT= Y ONLY ONE SACB WILL BE GENERATED.     @G64UPSS
*                       ENTRY STATEMENTS WILL NOT BE           @G64UPSS
*                       GENERATED. DO NOT SPECIFY DSECT= IF    @G64UPSS
*                       DSECT=Y IS NOT WANTED.                 @G64UPSS
*                                                              @G64UPSS
* FUNCTION   - THIS MACRO IS INVOKED AT SYSGEN TO BUILD AN     @G64UPSS
*              RDCM WITH SACBS IN THE NUCLEUS. THE MAPPING     @G64UPSS
*              MACRO FOR THIS CONTROL BLOCK IS IEERDCM.        @G64UPSS
*                                                              @G64UPSS
* CHANGE-ACTIVITY -                                            @G64UPSS
*              G64DPSS, G64UPSS, G811P2G, ZMD0033,             @ZMD0033
* $L1=XMCTASK,  JBB1326,  801031,  PD2I:  ADDED DCMAASID
* $L2=CONCOLOR, JBB1326,  801205,  PDSS:  BASE COLOR SUPPORT
* $P1=PMM0107,  JBB1326,  810402,  PD2I:  BASE ASCB
*              G860P2G - SUPPORT A PFK AREA FOR EACH CONSOLE   @G860P2G
*              ZMC0190 - DEFINE FIELD DCMMSGSV                 @ZMC0190
*              G860PSS - EMBEDDED LABEL LINE SUPPORT           @G860PSS
* $T1=OZ72482,  JBB2110,  830428,  PD2L:  SUPPORT 3279-2C CONSOLE
*
***********************************************************************
.*                                                             @G811P2G
.* OPERATION = THIS MACRO DEFINES THE RDCM FIELDS FOR A        @G860P2G
.*             CONSOLE.  IT ALSO BUILDS AN SACB FOR EACH       @G860P2G
.*             DISPLAY AREA DEFINED.                           @G811P2G
.*                                                             @G811P2G
.* MODULE TYPE = MACRO                                         @G811P2G
.*                                                             @G811P2G
.*   PROCESSOR = OS/VS2 ASSEMBLER                              @G811P2G
.*                                                             @G811P2G
.*   MODULE SIZE = N/A                                         @G811P2G
.*                                                             @G811P2G
.*   ATTRIBUTES = N/A                                          @G811P2G
.*                                                             @G811P2G
.* ENTRY POINT = N/A                                           @G811P2G
.*                                                             @G811P2G
.* INPUT = SEE 'INVOCATION' ABOVE FOR A DESCRIPTION OF THE     @G811P2G
.*         INPUT PARAMETERS.                                   @G811P2G
.*                                                             @G811P2G
.* OUTPUT = AN RDCM IS BUILT.  ONE SACB IS BUILT FOR EACH      @G811P2G
.*          DISPLAY AREA DEFINED BY INPUT.                     @G811P2G
.*                                                             @G811P2G
.* EXIT - NORMAL = N/A                                         @G811P2G
.*                                                             @G811P2G
.* EXIT - ERROR = N/A                                          @G811P2G
.*                                                             @G811P2G
.* EXTERNAL REFERENCES = NONE                                  @G811P2G
.*                                                             @G811P2G
.* TABLES = &TABLE   - A TABLE OF SCREEN AREA ID'S             @G811P2G
.*                                                             @G811P2G
.* VARIABLES = THE FOLLOWING LOCAL VARIABLES ARE USED:         @G811P2G
.*                                                             @G811P2G
.*       NAME     FUNCTION                                     @G811P2G
.*       ----     --------                                     @G811P2G
.*       &C       THE ID OF THE AREA CURRENTLY BEING DEFINED   @G811P2G
.*       &D       THE LENGTH OF THE AREA CURRENTLY BEING       @G811P2G
.*                DEFINED                                      @G811P2G
.*       &E       INDEX INTO AREA DEFINITION PARAMETER (&A)    @G811P2G
.*       &F       THE ID OF THE TOPMOST AREA ON THE CONSOLE    @G811P2G
.*       &N       INDEX INTO THE AREA ID TABLE (&TABLE)        @G811P2G
.*       &PFKLEN  THE LENGTH OF THE PFK BUFFER                 @G860P2G
.*       &S       THE TOTAL NUMBER OF SCREEN AREAS DEFINED     @G811P2G
.*                FOR THIS DEVICE                              @G811P2G
.*                                                             @G811P2G
.* MACROS = NONE                                               @G811P2G
.*                                                             @G811P2G
.* MESSAGES = NONE                                             @G860P2G
.*                                                             @G811P2G
.* COMPLETION CODES = N/A                                      @G811P2G
.*                                                             @G811P2G
.**********************************************************************
.*C (.NOTOPAR, .ZZZ)                                           @G811P2G
.*A (.DDD)                                                     @G811P2G
.*C (.FFF)                                                     @ZMD0033
.*A (DCMBCOLR,DCMECOLR) BASE COLOR SUPPORT                         @L2A
.*C (DCMAASCB)                                                     @P1A
.*A (DCMRVRID, DCMRSP21, DCMRVERN, DCMPFKEY, DCMPFKWK)         @G860P2G
.*A (DCMPFKIN, DCMPFKBD, DCMRCBID, DCMPFKSZ, DCMPFKBF)         @G860P2G
.*A (DCMRSV02, &PFKLEN)                                        @G860P2G
.*D (DCMRMS, DCMADRMS, AFTER DCMSUBAD)                         @G860P2G
.*A (DCMMSGSV)                                                 @ZMC0190
.*D (DCMAPAD)                                                  @G860PSS
.*A (DCMAELLF, DCMADLF, DCMANLAB)                              @G860PSS
.* COMMENT AND PROLOGUE CHANGES ONLY                               @T1A
         EJECT ,                                               @G811P2G
         LCLA  &N,&S,&E,&PFKLEN                                @G860P2G
         LCLC  &TABLE,&C,&D,&F                                 @G860P2G
.**********************************************************************
.*                                                            @G811P2G*
.*       SET VARIABLES TO GENERATE ONE AREA IF THE RDCM IS    @G811P2G*
.*       BEING MAPPED                                         @G811P2G*
.*                                                            @G811P2G*
.**********************************************************************
         AIF   ('&DSECT' EQ '').NODEC
&S       SETA   1
&E       SETA   1
&D       SETC   '1'
         AGO   .POS
.NODEC   ANOP
.**********************************************************************
.*                                                            @G811P2G*
.*       SET AREA PARAMETERS IF THE RDCM IS BEING CREATED     @G811P2G*
.*       AND AREAS ARE DEFINED                                @G811P2G*
.*                                                            @G811P2G*
.**********************************************************************
         AIF   ('&A'  EQ  '').NEG
&S       SETA    N'&A
&E       SETA  1
&D       SETC  '&A(&E)'
         AGO   .POS
.NEG     ANOP
&S       SETA  0
.POS     ANOP
&N       SETA  1
&F       SETC  '0'
&TABLE   SETC  'ABCDEFGHIJK'
         AIF   (&S  EQ  0).NUN
&C       SETC  '&TABLE'(&N,1)           COMPUTE AREA ID
&F       SETC  '&TABLE'(&S,1)
.NUN     ANOP
.**********************************************************************
.*                                                            @G811P2G*
.*       DEFINE THE FIRST PORTION OF THE RDCM                 @G811P2G*
.*                                                            @G811P2G*
.**********************************************************************
DCMADTRN DC    F'0'                POINTER TO PAGEABLE DCM
DCMRSP21 EQU   1                   OS/VS2 HBB2102              @G860P2G
DCMRVRID EQU   DCMRSP21            CURRENT VERSION             @G860P2G
DCMRVERN DC    AL1(DCMRVRID)       CONTROL BLOCK VERSION       @G860P2G
         AIF   (T'&KEY EQ 'O').NOPFKS PFK'S SPECIFIED?         @G860P2G
         AIF   (&KEY EQ 0).NOPFKS  SPECIFIED AS ZERO?          @G860P2G
DCMRFLGS DC    X'80'               FLAGS - PFK'S PRESENT       @G860P2G
         AGO   .SETFLGS            FLAGS ARE SET               @G860P2G
.NOPFKS  ANOP                                                  @G860P2G
DCMRFLGS DC    X'00'               FLAGS
.SETFLGS ANOP                                                  @G860P2G
DCMPFKEY EQU   X'80'               CONSOLE HAS PFK'S           @G860P2G
DCMPFKWK EQU   X'40'               PFK'S ARE OPERATIONAL       @G860P2G
DCMPFKIN EQU   X'20'               PFK INIT. IN PROCESS        @G860P2G
DCMDOM   EQU   X'10'               DOM MUST BE TRIED
DCMNIPP  EQU   X'08'               CONSOLE WAS USED BY NIP     @G64UPSS
DCMPFKBD EQU   X'04'               PFK DEFS ARE NOT FROM DCMLIB AND    *
                                   CAN'T BE SAVED WHEN CHANGED @G860P2G
DCMLEN   DC    H'0'                LENGTH OF TRANS DCM
DCMADKP  DC    A(0)                ADDRESS OF ROUTED K COMMAND
*                                       PARAMETER LIST
         AIF   ('&F' EQ '0').NOTOPAR                           @G811P2G
DCMTOPAR DC    C'&F'               TOP DISPLAY AREA DEFINED
         AGO   .TOPDONE                                        @G811P2G
.NOTOPAR ANOP  ,                                               @G811P2G
DCMTOPAR DC    X'00'
.TOPDONE ANOP  ,                                               @G811P2G
DCMTOPDS DC    X'00'               TOP DISPLAY ON SCREEN
         DC    X'00'               RESERVED
DCMDEVTY DC    X'00'               DEVICE TYPE FLAGS
DCMTY60  EQU   X'80'               USABLE FOR SD              MC X01958
DCMTY50  EQU   X'40'               UNUSABLE FOR SD            MC X01958
DCMBCOLR EQU   X'20'               USABLE FOR BASE COLOR           @L2A
DCMECOLR EQU   X'10'               USABLE FOR EXTENDED COLOR       @L2A
         AIF   (&S EQ 0).NONE      IF NO SDS AREAS REQUESTED
DCMADSDS DC    A(DCMACB)           POINTER TO FIRST SDS SUPPORT AREA
         AGO   .MCH                                            @G811P2G
.NONE    ANOP
DCMADSDS DC    F'0'                POINTER TO FIRST SDS SUPPORT AREA
.MCH     ANOP                                                  @G811P2G
DCMRCBID DC    C'RDCM'             CONTROL BLOCK ID            @G860P2G
.YYY     ANOP
.**********************************************************************
.*                                                            @G811P2G*
.*       DEFINE THE REMAINDER OF THE RDCM                     @G811P2G*
.*                                                            @G811P2G*
.**********************************************************************
DCMWLAST DC    F'0'                PT CON Q ENTRY LAST OUT (O-O-L)
DCMRMSAL DC    H'0'                NUMBER LINES IN MSG AREA
DCMDOMKY DC    H'0'                CONSOLE DOM ELEMENT        MC XM5812
DCMSUBAD DC    V(IEECVSUB)         POINTER TO SUB
DCMADPFK DC    F'0'                POINTER TO RESIDENT PFK AREA
DCMINTVL DC    H'0'                INTERVAL FOR THIS DCM
DCMTMCTR DC    H'0'                TIME COUNTER FOR THIS DCM
DCMR2FLG DC    X'00'               TIMER FLAGS
DCMRXSFL EQU   X'80'               FULL SCREEN FLAG
DCMRXUNV EQU   X'40'               UNVIEWABLE MESSAGE DISPLAYED
DCMRXTMR EQU   X'20'               TIMER FLAG
DCMRXRLL EQU   X'10'               READY TO ROLL
DCMRXDEL EQU   X'08'               PENDING DELETE REQUEST
DCMRXTIM EQU   X'02'               TIMER ELAPSED FOR THIS DISPLAY
DCMRXDCM EQU   X'01'               T DCM IS IN CORE
DCMR3FLG DC    X'00'               MISC FLAGS
DCMSTSWT EQU   X'80'               CHANGING STATUS OF OUTPUT ONLY CON
DCMKVIP  EQU   X'40'               ENTRY FOR K VARY COMMAND
DCMCLPR  EQU   X'20'               CLOSE IN PROCESS
DCMRXSCN EQU   X'10'               ASY ERROR MESSAGE ON SCREEN
DCMR3PKA EQU   X'08'               DA I/O COMPLETE FLAG
DCMRXHMT EQU   X'04'               FULL SCREEN SIMULATED?     MC YM4102
         AIF   (T'&KEY EQ 'O').NOKEYS   PFK'S SPECIFIED?       @G860P2G
         AIF   (&KEY EQ 0).NOKEYS SPECIFIED AS ZERO?           @G860P2G
&PFKLEN  SETA  (&KEY*110)+19       LENGTH OF PFK AREA IS 110 BYTES     *
                                   PER KEY + 18-BYTE HEADER + ONE-BYTE *
                                   STOPPER                     @G860P2G
&PFKLEN  SETA  (&PFKLEN+7)/8*8     ROUND UP TO DOUBLEWORD      @G860P2G
.NOKEYS  ANOP                                                  @G860P2G
DCMPFKSZ DC    H'&PFKLEN'          LENGTH OF PFK BUFFER        @G860P2G
DCMRQDEL DC    XL8'40'             BUFFER FOR PENDING DELETE REQUESTS
DCMMSGSV DC    F'0'                LINE COUNT SAVE AREA FOR            *
                                   IEECVFTP                    @ZMC0190
DCMPFKBF DC    F'0'                PFK BUFFER ADDRESS          @G860P2G
DCMRSV01 DC    F'0'                RESERVED                    @G860PSS
DCMRSV02 DC    F'0'                RESERVED                    @G860P2G
         AIF   (&S EQ 0).END       IF NO SDS AREAS, DEPART
         EJECT
***********************************************************************
* SCREEN AREA CONTROL BLOCK (SACB) PREFIX                      @G811P2G
***********************************************************************
         SPACE
DCMPACB  EQU   *                   SACB PREFIX
DCMPLN   DC    FL2'&D'                  SYSGEN LENGTH OF AREA
DCMPLNPR DC    H'04'               LENGTH OF SACB PREFIX-IN BYTES
DCMPRSZ  EQU   *-DCMPACB           SIZE OF SACB PREFIX IN BYTES
         SPACE
***********************************************************************
* SCREEN AREA CONTROL BLOCK (SACB)                             @G811P2G
***********************************************************************
         SPACE 1                                               @G811P2G
DCMACB   EQU   *                   SCREEN AREA CONTROL BLOCK
         AIF   (&N EQ &S).ZERO     BRANCH IF LAST AREA
DCMACBNX DC    A(*+DCMACBSZ+DCMPRSZ) POINTER TO NEXT SACB
         AGO   .AID
.ZERO    ANOP
DCMACBNX DC    A(0)                POINTER TO NEXT SACB
.AID     ANOP
DCMAID   DC    C'&C'               AREA ID
DCMASACB DC    X'80'               SACB FLAGS
DCMAUSE  EQU   X'80'               AREA PRESENTLY DEFINED     MB Y02958
DCMAGM   EQU   X'40'               GETMAINED SACB
DCMALN   DC    FL2'&D'                  LENGTH OF AREA
DCMATOP  DC    X'00'               TOP ROW OF AREA
DCMACLR  EQU   *                   REINITIALIZED PORTION      MB Y02958
DCMAROW  DC    X'00'               ROW TO BE WRITTEN NEXT
DCMAFR   DC    H'00'               FRAME ON SCREEN
DCMAMJWQ DC    A(0)                POINTER TO CON Q ENTRY FOR MAJOR
DCMAMIN  DC    A(0)                POINTER TO MINOR WQE
DCMATIME DC    F'0'                TIME CONTROL LINE WAS WRITTEN
DCMANLAB DC    FL1'0'              NUMBER OF LABEL LINES FOUND @G860PSS
DCMARES1 DC    XL1'00'             RESERVED                    @G860PSS
DCMAFLG1 DC    X'00'               AREA FLAGS1
DCMADISP EQU   X'40'               DISPLAY IN AREA
DCMADEND EQU   X'20'               END OF DISPLAY ON SCREEN
DCMAFRPR EQU   X'10'               FRAMING IN PROGRESS
DCMAFULL EQU   X'08'               FRAME FULL
DCMABL   EQU   X'04'               BLANKING TO BE DONE
DCMAELLF EQU   X'02'               EMBEDDED LABEL LINE FOUND   @G860PSS
DCMADLF  EQU   X'01'               DATA LINE FOUND WHILE WRITING       X
                                   DISPLAY                     @G860PSS
DCMAFLG2 DC    X'00'               AREA FLAGS 2
DCMALMIN EQU   X'80'               SAVED POINTER TO LAST MINOR OUTPUT
DCMAWCON EQU   X'40'               WRITE CONTROL LINE
DCMARCON EQU   X'20'               REWRITE CONTROL LINE
DCMAMJFR EQU   X'10'               MAJOR WQE HAS BEEN FOUND
DCMADFLG DC    X'00'               DYNAMIC DISPLAY FLAGS      MB Y02958
DCMADD   EQU   X'80'               TRACK IN AREA              MB Y02958
DCMAHOLD EQU   X'40'               TRACK IN HOLD MODE         MB Y02958
DCMACSIB EQU   X'20'               TRACK WITH CONTINUATION LINE IN     *
                                   SCREEN IMAGE BUFFER        MB Y02958
DCMATRCK DC    X'00'               TRACK REQUEST INDICATORS   MB Y02958
DCMATJOB EQU   X'80'               TRACK JOBS                 MB Y02958
DCMATJBL EQU   X'40'               TRACK JOBS,LIST            MB Y02958
DCMATTS  EQU   X'08'               TRACK TS                   MB Y02958
DCMATTSL EQU   X'04'               TRACK TS,LIST              MB Y02958
DCMATA   EQU   X'88'               TRACK A                    MB Y02958
DCMATAL  EQU   X'44'               TRACK A,LIST               MB Y02958
DCMAUTME DC    H'0'                UTME=NNN VALUE             MB Y02958
DCMATECB DC    F'0'                TRACK CANCEL ECB ADDRESS   MB Y02958
DCMAASCB DC    F'0'                TRACK ASCB POINTER              @P1C
*                                  NOTE: WHEN THE SACB IS
*                                       REINITIALIZED, FIELDS
*                                       DCMAROW THROUGH THE END
*                                       (INCLUDING THE RESERVED
*                                       FIELD) ARE ZERO'D
DCMACBND EQU   *                   END OF SACB
DCMCLRLN EQU   *-DCMACLR           LENGTH FOR REINITIALIZING  MB Y02958
DCMACBSZ EQU   *-DCMACB            SIZE OF SACB IN BYTES
.**********************************************************************
.*                                                            @G811P2G*
.*       BUILD THE SCREEN AREA CONTROL BLOCKS (SACB'S) - ONE  @G811P2G*
.*       PER AREA DEFINED                                     @G811P2G*
.*                                                            @G811P2G*
.**********************************************************************
.NEXT    AIF   (&N EQ &S).END      BRANCH IF LAST AREA IS DONE
&N       SETA  &N+1
&E       SETA  &E+1
&C       SETC  '&TABLE'(&N,1)           COMPUTE AREA ID
&D       SETC  '&A(&E)'
         SPACE
***********************************************************************
* SCREEN AREA CONTROL BLOCK (SACB) PREFIX                      @G811P2G
***********************************************************************
         SPACE 1                                               @G64UPSS
*                                  SACB PREFIX
         DC    FL2'&D'             SYSGEN LENGTH OF AREA
         DC    H'04'               LENGTH OF SACB PREFIX-IN BYTES
         SPACE 1                                               @G811P2G
***********************************************************************
* SCREEN AREA CONTROL BLOCK (SACB)                             @G811P2G
***********************************************************************
         SPACE 1                                               @G811P2G
         AIF   (&N EQ &S).Z        BRANCH IF LAST AREA
         DC    A(*+DCMACBSZ+DCMPRSZ) POINTER TO NEXT SACB
         AGO   .ID
.Z       ANOP
         DC    A(0)                POINTER TO NEXT SACB
.ID      ANOP
         DC    C'&C'               AREA ID
         DC    X'80'               SACB FLAGS
         DC    FL2'&D'             LENGTH OF AREA
         DC    X'00'               TOP ROW OF AREA
         DC    X'00'               ROW TO BE WRITTEN NEXT
         DC    H'00'               FRAME ON SCREEN
         DC    A(0)                POINTER TO CON Q ENTRY FOR MAJOR
         DC    A(0)                POINTER TO MINOR WQE
         DC    F'0'                TIME CONTROL LINE WAS WRITTEN
         DC    FL1'0'              NUMBER OF LABEL LINES FOUND @G860PSS
         DC    XL1'00'             RESERVED                    @G860PSS
         DC    X'00'               AREA FLAGS1
         DC    X'00'               AREA FLAGS2
         DC    X'00'               DISPLAY FLAGS
         DC    X'00'               TRACK REQUEST INDICATORS   MB Y02958
         DC    H'0'                UTME=NNN VALUE             MB Y02958
         DC    F'0'                CANCEL TRACK ECB ADDRESS   MB Y01958
         DC    F'0'                TRACK ASCB POINTER              @P1C
         AGO   .NEXT               RETURN TO GENERATE NEXT AREA
.END     MEND
         TITLE 'SPCONS  TSO CONSOLE OPERATOR PROGRAM VERSION 5.0'
         SPACE 3
         EJECT
SPCONS   CSECT
         PRINT NOGEN
         SPACE 2
R0       EQU   0
R1       EQU   1
R2       EQU   2
R3       EQU   3
R4       EQU   4
R5       EQU   5
R6       EQU   6
R7       EQU   7
R8       EQU   8
R9       EQU   9
R10      EQU   10
R11      EQU   11
R12      EQU   12
R13      EQU   13
R14      EQU   14
R15      EQU   15
         SPACE 2
         B     112(R15)           BRANCH AROUND SAVE AREAS
         DC    CL9'XACONS'        IDENTIFIER
         DC    CL9'&SYSDATE'
         DC    CL7'&SYSTIME'
         DC    CL11'VERSION 3.2'
SAVE     DC    18F'0'             SAVE AREA
         STM   R14,R12,12(R13)    SAVE REGISTERS
         LR    R12,R15            R12 = ADDR OF ENTRY POINT
         USING XACONS,R12,R11     ADDRESABILITY TO CSECT
         LA    R11,SAVE           R11 = ADDR OF OUR SAVE AREA
         ST    R13,SAVE+4         SAVE POINTER TO CALLERS SAVE AREA
         ST    R11,8(R13)         SAVE PTR TO OUR SAVE AREA IN CALLER'S
         LR    R13,R11            R13 = ADDR OF OUR SAVE AREA
         LA    R11,4095(R12)      R11 WILL BE
         LA    R11,1(R11)         SECOND BASE REGISTER
         EJECT
***********************************************************************
*                                                                     *
*   LOCATE LOGON ID, AND HOLD IT                                      *
*                                                                     *
***********************************************************************
SKIP     EQU   *
         L     R1,16          ADDR OF CVT
         L     R1,0(R1)       ADDR OF DISPATCH QUEUE
         L     R1,12(R1)      ADDR OF CURRENT ASCB
         L     R1,176(R1)     ADDR OF JOBNAME
         MVC   DOGTXT+4(8),0(R1)   USERS LOGON ID
***********************************************************************
*                                                                     *
*   CHECK FOR TSO OPER AUTHORITY--IF ON BYPASS PASSWORD CHECKING      *
*                                                                     *
***********************************************************************
         L     R1,PSATOLD-PSA     GET ADDRESS OF MY TCB            JMH
         L     R1,TCBJSCB-TCB(R1) GET ADDRESS OF JSCB              JMH
         L     R1,JSCBPSCB-IEZJSCB(R1) GET ADDRESS OF PSCB         JMH
         TM    PSCBATR1-PSCB(R1),PSCBCTRL  OPERATOR AUTHORITY?     JMH
         BO    OPROK              YES, CONTINUE                    JMH
         MVI   OPRFLAG,X'FF'      SET TO DISPLAY ONLY
         B     OPROK1
OPROK    MVI   OPRFLAG,X'00'                                       JMH
OPROK1   EQU   *
********************************************************************
*                                                                  *
*   CHECK FOR APF AUTHORISATION : IF WE ARE NON APF AUTHORIZED     *
*   YOU WILL NEED AN SVC TO MAKE YOU AUTHORIZED OTHERWISE          *
*   MODESET WILL NOT WORK. YOU CAN ALSO USE SPF OPTION 6           *
*   OR HAVE THIS FUNCTION ON A MENU PANEL.                         *
*                                                                  *
********************************************************************
         TESTAUTH FCTN=1
         LTR   R15,R15             IS CALLER AUTHORIZED ?          JMH
         BZ    APFOK               BRANCH IF NOT                   JMH
********************************************************************
*                                                                  *
*   INSERT YOUR SVC HERE. IN OUR SHOP WE HAVE THIS ONE.            *
*                                                                  *
********************************************************************
DOSVC    SR    R14,R14             ZERO R14                        JMH
         LA    R1,4                ASK FOR AUTH STATE              JMH
         SR    R0,R0               ZERO R0                         JMH
         LA    R15,32
         SVC   109                 GET INTO AUTH STATE             JMH
APFOK    EQU   *                                                   JMH
********************************************************************
*                                                                  *
*   MODESET ISSUED HERE---ITS NOT THE BEST PLACE BUT AS THIS       *
*   PROGRAM HAS ALMOST RUN OUT OF ADDRESSABILITY I ONLY NEED       *
*   TO ISSUE THIS MACRO ONCE--SAVES CODE.                          *
*   AT SOME STAGE I MIGHT MAKE THIS PROGRAM MODULAR.               *
*                                                                  *
********************************************************************
         MODESET MODE=SUP,KEY=ZERO GET INTO SUPERVISOR STATE       JMH
         GTSIZE ,                 GET SCREEN SIZE
         STH   R0,LPSCREEN        R0 = LINES PER SCREEN
         STH   R1,CPLINE          R1 = CHARACTERS PER LINE
***********************************************************************
*                                                                     *
*                       THIS TERMINAL IS A CRT                        *
*                                                                     *
***********************************************************************
CRTMOD2  CH    R0,=H'24'          IS USER ON A 327X-2?
         BE    FLSCREEN           YES, JUST CONTINUE
CRTMOD3  CH    R0,=H'32'          IS USER ON A 327X-3?             JMH
         BNE   CRTMOD4            NO, CHECK FOR MOD 4              JMH
         MVI   MOD3FLG,X'FF'      SET 327X-3 FLAG ON               JMH
         MVC   PHEADING(3),R31C1  ROW 31, COL 1                    JMH
         MVC   R24C1(3),R32C1     ROW 32, COL 1                    JMH
         MVC   CONTMSG(3),R32C1   ROW 32, COL 1                    JMH
         B     FLSCREEN           CONTINUE                         JMH
CRTMOD4  CH    R0,=H'43'          IS USER ON A 327X-4?             JMH
         BNE   CRTUNDEF                                            JMH
         MVI   MOD4FLG,X'FF'      SET 327X-4 FLAG ON
         MVC   PHEADING(3),R42C1  ROW 42, COL 1
         MVC   R24C1(3),R43C1     ROW 43, COL 1
         MVC   CONTMSG(3),R43C1   ROW 43, COL 1                    JMH
         B     FLSCREEN           CONTINUE                         JMH
CRTUNDEF TPUT  ERRMSG6,L'ERRMSG6  SEND MESSAGE - INVALID TERMINAL  JMH
         B     ALLDONE            AND TERMINATE                    JMH
FLSCREEN EQU   *
         STFSMODE ON,INITIAL=YES  TURN ON VTAM FULL SCREEN MODE
         LA    R3,STAXLIST        R3 = ADDRESS OF STAX LIST MACRO
         STAX  ATTNEXIT,MF=(E,(3)) ATTN EXIT TRAP
         B     BLDUCMS
         EJECT                                                     JMH
***********************************************************************
*                                                                     *
*          BUILD A TABLE OF UCM ADDRESSES (ONE PER CONSOLE)           *
*                                                                     *
***********************************************************************
BLDUCMS  L     R4,CVTPTR          R4 = ADDR OF CVT
         USING CVT,R4
         L     R4,CVTCUCB         R4 = ADDR OF 'CUCB' (UCM BASE)
         DROP  R4
         USING UCM,R4
         LR    R2,R4              R2 = R4
         S     R2,=F'4'           R2 = ADDR OF ADDR OF UCM PREFIX
         L     R2,0(R2)           R2 = ADDR OF UCM PREFIX
         USING UCMPRFX,R2
         L     R5,UCMVEA          R5 = ADDR OF FIRST UCM ENTRY
         L     R6,UCMVEZ          R6 = LENGTH OF EACH UCM ENTRY
         L     R7,UCMVEL          R7 = ADDR OF LAST UCM ENTRY
*        LA    R8,UCMTAB+16       R8 = ADDR OF UCMTAB
         L     R8,UCM#TAB         WE HAVE RUN OUT OF ADDRESSES SO
         LA    R8,16(R8)          CHEAT BY DOING IT THIS WAY
         L     R9,UCMTABE         R9 = ADDR OF END OF UCMTAB
         SLR   R10,R10            R10 = 0 (NUMBER OF VALID UCMS)
         MVC   CONSOLE(4),=F'01'  MAKE DEFAULT CONSOLE = 1
UCMLOOP  ST    R5,0(R8)           SAVE UCM ADDRESS IN UCMTAB
         LA    R10,1(R10)         R10 = R10 + 1  (ONE MORE UCM)
         C     R5,UCMMCENT        IS THIS UCM THE MASTER CONSOLE UCM?
         BNE   UCMNEXT            NO;  GO LOOK AT NEXT UCM ENTRY
         ST    R10,CONSOLE        YES; LOOK AT THIS ONE FIRST
UCMNEXT  LA    R8,16(R8)          R8 = ADDR OF NEXT UCMTAB ENTRY
         CR    R8,R9              DOES R8 POINT PAST END OF UCMTAB?
         BNL   UCMFULL            YES; LEAVE LOOP
         AR    R5,R6              R5 = ADDR OF NEXT UCM ENTRY
         CR    R5,R7              DOES R5 POINT PAST UCM ENTRIES?
         BNH   UCMLOOP            NO; KEEP GOING                   JMH
         B     UCMDONE            YES; TABLE COMPLETE
UCMFULL  MVC   ERROR(26),ERRMSG5  UCM TABLE TOO SMALL
UCMDONE  STH   R10,NUMUCMS        SAVE NUMBER OF UCMS FOUND
         MVC   MSTCON,CONSOLE     SAVE NUMBER OF MASTER CONSOLE    JMH
         DROP  R2,R4
         SPACE 3
SETAUTH  EQU   *                    ALREADY IN SUPERVISOR STATE    XA
*/*******************************************************************/
*/*                                                                 */
*/*                                                                 */
*/*     SET UP FOR CROSS MEMORY ADDRESS SPACE COMMUNICATION.        */
*/*     WE ARE GOING TO GET DATA FROM THE CONSOLE ADDRESS SPACE.    */
*/*                                                                 */
*/*******************************************************************/
         ESAR  R5                   GET SEC ASID                   XA
         ST    R5,SASID             KEEP IT                        XA
         AXSET AX=ONE      AUTHORISATION INDEX TO ALLOW SSAR       XA
         GETMAIN R,LV=820              GET STORAGE FOR TDCM        XA
         ST    R1,LOCDCM            SAVE THE ADDRESS               XA
         SPACE
***********************************************************************
*                                                                     *
*                            TOP OF LOOP                              *
*              LOCATE SCREEN BUFFER AND PREPARE TO TPUT               *
*                                                                     *
***********************************************************************
NEXTPAGE CLI   ATTNFLG,X'00'      WAS ATTN HIT?
         BE    NOATTN             NO
*                                 ATTENTION KEY HIT; PROCESS IT
         MVI   ATTNFLG,X'00'      YES, RESET FLAG
         MVC   TIME(3),BLANKS     BLANK OUT TIMER FIELD
         MVI   WAITFLG,X'00'      TURN OFF WAIT FLAG
         XC    TYMER,TYMER        SET TYMER TO 0
NOATTN   EQU   *
*        LA    R5,UCMTAB          R5 = ADDR OF UCMTAB
         L     R5,UCM#TAB      RUN OUT OF ADDRESSES--DID IT THIS WAY
         L     R4,CONSOLE         R4 = CONSOLE TO BE DISPLAYED
         CH    R4,NUMUCMS         IS NUMBER TOO HIGH?
         BNH   GETUCM             NO, CONTINUE
RESETCN  MVC   ERROR(26),ERRMSG1  CONSOLE UNDEFINED
RESETCN1 L     R4,OLDCONS         RESET TO OLD CONSOLE
         ST    R4,CONSOLE         AND SAVE IT
GETUCM   SLL   R4,4               MULTIPLY BY 16
         LA    R5,0(R5,R4)        R5 = ADDR OF ADDR OF UCM
         LR    R1,R5              R1 = ADDR OF UCMTAB ENTRY
         L     R5,0(R5)           R5 = ADDR OF UCM
         USING UCMLIST,R5
         L     R6,UCMXB           R6 = ADDR OF RDCM
         USING DCMADTRN,R6        SKIP THIS BIT   1.3.3
*        LTR   R6,R6              IS THIS A GRAPHICS CONSOLE?
*        BP    GRAPHICS           YES
         B     GRAPHICS           ABOVE 3 LINES SKIPPED
***********************************************************************
*                                                                     *
*       THIS IS NOT AN OPERATOR GRAPHIC CONSOLE - GIVE ERRMSG4        *
*                                                                     *
***********************************************************************
*        LA    R5,UCMTAB          R5 = ADDR OF UCMTAB
         L     R5,UCM#TAB
         MVC   ERROR(26),ERRMSG4  NON-GRAPHIC CONSOLE
         B     RESETCN1           RESET THE CONSOLE NUMBER
***********************************************************************
*                                                                     *
*   THIS IS A GRAPHIC CONSOLE - BUILD TRAILER LINE WITH CONSDATA      *
*                                                                     *
***********************************************************************
GRAPHICS EQU   *
         BAL   R14,CONSDATA       CALL CONSDATA RTN
         SPACE
*       SETUP TO COPY PAGEABLE DCM TO OUR ADDRESS SPACE            XA
         L     R5,DCMADTRN        ADDR OF TDCM - 'FROM' FOR MVCP   XA
         LA    R7,CONASID         GET 'CONSOLE' ASID               XA
         SSAR  R7                 SET CONSOLE AS SECONDARY         XA
         L     R7,LOCDCM          'TO' ADDR FOR MVCP               XA
         LA    R3,820             LENGTH TO MOVE                   XA
         SR    R15,R15            'FROM' KEY                       XA
MOVEDCM  MVCP  0(R3,R7),0(R5),R15  MOVE IT                         XA
         BZ    DCMMOVED                                            XA
         LA    R5,256(R5)         BUMP 'FROM' ADDR                 XA
         LA    R7,256(R7)         BUMP 'TO' ADDR                   XA
         SH    R3,=H'256'         DECREMENT TRUE LENGTH            XA
         B     MOVEDCM            GO GET THE REST                  XA
         SPACE
DCMMOVED L     R5,SASID           RESTORE PREVIOUS SECONDARY -     XA
         SSAR  R5                 SHOULD BE SAME AS PRIMARY        XA
         L     R7,LOCDCM          ADDR OF OUR COPY                 XA
         USING STRTDCM,R7         WAS DCMSTRT
         SPACE
***********************************************************************
*                                                                     *
*    FILLIN OPERATORS COMMAND INPUT BUFFER                            *
*                                                                     *
***********************************************************************
         MVC   LASTLINE(79),DCMINPUT MOVE IN INPUT BUFFER LINE
         CLI   LASTLINE,C'0'      CHECK FOR OPERATOR REPLY         JMH
         BNL   BPSUPP             IF NUMERIC ASSUME REPLY          JMH
         CLC   LASTLINE(2),=C'R ' CHECK FOR OPERATOR REPLY         JMH
         BE    BPSUPP             IF THERE,  ASSUME REPLY          JMH
         CLC   LASTLINE(2),=X'9940' CHECK FOR OPERATOR REPLY       JMH
         BNE   BPSUPR             IF THERE,  ASSUME REPLY          JMH
BPSUPP   EQU   *         DISPLAY OPERATOR REPLY                    JMH
         MVC   LASTLINE(10),=C'SUPPRESSED'
         MVC   LASTLINE+10(69),BLANKS BLANK OUT REPLY              JMH
BPSUPR   MVI   MODE+1,C' '        BLANK OUT VIP INDICATOR
***********************************************************************
*                                                                     *
*                         CHECK CONSOLE SIZE                          *
*                                                                     *
***********************************************************************
CHKSIZE  L     R2,DCMASCRN        LOAD ADDR OF SCREEN BUFFER+6     JMH
         L     R1,DCMAENTR        LOAD ADDR OF ENTRY LINE+5        JMH
         SR    R1,R2                DETERMINE BUFFER LENGTH        JMH
         LH    R2,LPSCREEN        LOAD SCREEN SIZE OF OUR TERMINAL JMH
         S     R2,=F'3'           SUBTRACT TRAILER LINES           JMH
         BP    CHKSIZE1           IF NEGATIVE TERMINAL IS HARDCOPY JMH
         LR    R2,R1              SET SIZE EQUAL FOR HARDCOPY      JMH
         B     CHKSIZE2           CONTINUE                         JMH
CHKSIZE1 MH    R2,=H'84'          DETERMINE OUR SCREEN SIZE        JMH
CHKSIZE2 CR    R2,R1              IS OUR SCREEN >= THEIRS?         JMH
         BL    MOD2               NO, PROCESS IN PARTS             JMH
***********************************************************************
*                                                                     *
*                  USER TERMINAL CAN HOLD TOTAL SCREEN BUFFER         *
*        WE CAN JUST FREEZE HIS DISPLAY ON 'PAGE 1' AND CONTINUE      *
*                                                                     *
***********************************************************************
         ST    R1,XXCONBUF        SAVE LENGTH FOR LATER            JMH
         LA    R1,HEADLEN+TRAILEN(R1) TOTAL LENGTH OF TPUT BUFFER  JMH
         ST    R1,XXTOTBUF        SAVE FOR LATER                   JMH
         MVI   FREEZE,C'F'        FREEZE DISPLAY
         MVI   PAGE,C'1'          ON PAGE 1
         L     R8,DCMASCRN        R8 = ADDR OF SCREEN BUFFER + 6
         S     R8,=F'6'           BACKUP TO START OF BUFFER        JMH
         B     MVETRAIL           MOVE IN TRAILER AND BUFFER       JMH
***********************************************************************
*                                                                     *
*               USER TERMINAL CANNOT HOLD TOTAL SCREEN BUFFER         *
*        THIS OPER CONSOLE WILL HAVE TO BE DISPLAYED IN TWO SEGMENTS  *
*                                                                     *
***********************************************************************
MOD2     ST    R2,XXCONBUF        SAVE MAX LENGTH FOR LATER        JMH
         LA    R2,HEADLEN+TRAILEN(R2) TOTAL LENGTH OF TPUT BUFFER  JMH
         ST    R2,XXTOTBUF        SAVE FOR LATER                   JMH
         CLI   PAGE,C'1'          ARE WE ON PAGE 1?
         BNE   ONTWO              NO, SO WE MUST BE ON 2
         CLI   FREEZE,C'F'        ARE WE FROZEN ON PAGE 1?
         BNE   PAGE2              NO, SO DISPLAY PAGE 2
         B     PAGE1              YES, SO DISPLAY PAGE 1
ONTWO    CLI   FREEZE,C'F'        ARE WE FROZEN ON PAGE 2?
         BE    PAGE2              YES, SO DISPLAY PAGE 2
PAGE1    MVI   PAGE,C'1'          PAGE = 1
         L     R8,DCMASCRN        R8 = ADDR OF SCREEN IMAGE BUFFER + 6
         S     R8,=F'6'           BACKUP TO START OF BUFFER        JMH
         MVC   LASTLINE,BLANKS    BLANK OUT OPER CMD ON PAGE 1     JMH
         B     MVETRAIL           GO MOVE THE BUFFER
PAGE2    MVI   PAGE,C'2'          PAGE = 2
         MVI   SBAFIX,X'FF'       SET FLAG TO ADJUST SBA ADDRESS   JMH
         LA    R1,1(R1)           ADD 1                            JMH
         L     R8,DCMASCRN        R8 = ADDR OF SCREEN IMAGE BUFFER + 6
         S     R8,=F'6'           BACKUP TO START OF BUFFER        JMH
         L     R2,XXCONBUF        RESTORE MAX LENGTH OF BUFFER     JMH
         SR    R1,R2              EXCESS OF SCREEN OVER TERMINAL   JMH
         CLI   MODE,C'2'          ARE WE IN DISPLAY MODE 2?
         BE    DMODE2             YES, BRANCH TO DMODE2
DMODE1   LA    R8,0(R2,R8)        MOVE POINTER DOWN ONE TERM SCREENJMH
         ST    R1,XXCONBUF        STORE NEW BUFF LENGTH            JMH
         LA    R1,HEADLEN+TRAILEN(R1) TOTAL LENGTH OF TPUT BUFFER  JMH
         ST    R1,XXTOTBUF        SAVE FOR LATER                   JMH
         B     MVETRAIL           MOVE IN TRAILER                  JMH
DMODE2   LA    R8,0(R1,R8)        MOVE POINTER DOWN BY DIFFERENCE  JMH
         BCTR  R8,0               BACK UP ONE POSITION             JMH
         L     R2,XXCONBUF        RESTORE MAX LENGTH OF BUFFER     JMH
         LA    R2,1(,R2)          ADJUST FOR BACKUP                JMH
         ST    R2,XXCONBUF        STORE NEW BUFF LENGTH            JMH
         LA    R2,HEADLEN+TRAILEN(R2) TOTAL LENGTH OF TPUT BUFFER  JMH
         ST    R2,XXTOTBUF        SAVE FOR LATER                   JMH
MVETRAIL LA    R4,BUF             R4 = ADDR OF OUTPUT BUFFER       JMH
         L     R5,XXCONBUF        R5 = LENGTH OF BUFFER TO BE MOVEDJMH
         LA    R9,0(R5,R4)        = ADDR OF TRAILER SEGMENT        JMH
         MVC   0(TRAILEN,R9),TRAILER MOVE IN TRAILER SEGMENT       JMH
         LR    R9,R5              R9 = LENGTH OF BUFFER TO BE MOVEDJMH
         SPACE
***********************************************************************
*                                                                     *
*               MOVE THE SCREEN IMAGE BUFFER INTO BUF                 *
*                                                                     *
***********************************************************************
MOVEBUFF STM   R4,R9,MOVEBSAV     KEEP REGS                        XA
*        SETUP TO COPY CONSOLE BUFFER TO OUR ADDRESS SPACE.        XA
*        FIRST FILL AREA WITH SPACES                               XA
         L     R9,=X'40000000'    MAKE BLANK THE PAD, LENGTH =0    XA
         MVCL  R4,R8              PAD WITH SPACES                  XA
         SPACE
         LA    R4,CONASID         GET 'CONSOLE' ASID               XA
         SSAR  R4                 SET 'CONSOLE' AS SECONDARY       XA
         LM    R4,R9,MOVEBSAV     GET BACK ADDRESSES, LENGTHS      XA
         SR    R15,R15            'FROM' KEY                       XA
MOVEBFR  MVCP  0(R9,R4),0(R8),R15 MOVE IT                          XA
         BZ    BFRMOVED           GET OUT WHEN ALL MOVED           XA
         LA    R8,256(R8)         BUMP FROM ADDR                   XA
         LA    R4,256(R4)         BUMP TO ADDR                     XA
         SH    R9,=H'256'         DECREMENT TRUE LENGTH            XA
         B     MOVEBFR            GET THE REST                     XA
         SPACE
BFRMOVED L     R4,SASID           RESTORE PREVIOUS SECONDARY -     XA
         SSAR  R4                 SHOULD BE SAME AS PRIMARY.       XA
         SPACE 2
         CLI   CRTFLAG,X'FF'      IS THIS A CRT?
         BE    TPUTCRT            YES
         DROP  R5,R6,R7
         EJECT
***********************************************************************
*                                                                     *
*               DISPLAY THE OPERATOR'S SCREEN ON A 327X               *
*                                                                     *
***********************************************************************
TPUTCRT  TCLEARQ OUTPUT           FLUSH OUTPUT BUFFERS             JMH
         CLI   SBAFIX,X'FF'       SBA FIX REQUIRED?                JMH
         BNE   TPUTCRT2           NO, CONTINUE                     JMH
         MVI   SBAFIX,X'00'       RESET FLAG                       JMH
         LA    R1,BUF             GET ADDRESS OF BUFFER SEGMENT    JMH
         L     R3,XXCONBUF        GET LENGTH OF SEGMENT            JMH
         LA    R3,0(R3,R1)        GET ADDR BYTE PAST SEGMENT       JMH
         LA    R4,SBATAB          LOAD ADDR OF SBA ADDR TABLE      JMH
         LA    R2,84              LOAD INCREMENT (LINE LENGTH)     JMH
TPUTCRT1 MVC   1(2,R1),0(R4)      INSERT SBA ADDR FOR THIS LINE    JMH
         MVI   0(R1),X'11'        RE-INSERT SBA ORDER              JMH
         LA    R4,2(,R4)          INCREMENT SBATAB TO NEXT LINE    JMH
         BXLE  R1,R2,TPUTCRT1     REPEAT FOR ENTIRE BUFFER         JMH
TPUTCRT2 LA    R1,CLEAR           R1 = ADDR OF OUTPUT STREAM       JMH
         L     R0,XXTOTBUF        R0 = LENGTH OF TPUT              JMH
         ICM   R1,8,FULLSCR       SET ASIS TYPE FOR TPUT
         TPUT  (1),(0),R          DISPLAY                          JMH
         LR    R1,R15             R15 -TPUT-BUT R15 USED AS BASE   JMH
         LTR   R1,R1              CHECK TPUT RETURN CODE           JMH
         BZ    CHKWAIT            IF OK, CONTINUE                  JMH
         C     R1,=F'8'          ATTENTION? (R15 FROM TPUT REALLY) JMH
         BE    TPUTCRT2           RESHOW THE PAGE                  JMH
         B     DONE               TERMINATE                        JMH
         SPACE 3
***********************************************************************
*                                                                     *
*      IF WE ARE IN WAIT MODE DO A STIMER FOR THE NECESSARY LENGTH    *
*      OF TIME, THEN CALCULATE AND DISPLAY THE NEW TIMER COUNT.       *
*      IF COUNT HAS HIT ZERO, TURN OFF WAIT FLAG.                     *
*                                                                     *
***********************************************************************
CHKWAIT  MVC   ERROR(66),BLANKS   BLANK OUT ERROR FIELD
         CLI   WAITFLG,X'FF'      IS THE WAIT FLAG ON?
         BNE   READCHAR           NO, SO GO GET A COMMAND
         STIMER WAIT,BINTVL=DELAY WAIT FOR DELAY * .01 SECONDS
         L     R2,TYMER           R2 = CURRENT VALUE OF TIMER
         BCTR  R2,0               TYMER = TYMER - 1
         ST    R2,TYMER           STORE NEW VALUE OF TYMER
         CVD   R2,WORK            CONVERT TO DECIMAL.
         MVC   SCRATCH(4),PATTERN MOVE IN EDIT PATTERN
         ED    SCRATCH(4),WORK+6  EDIT IN CONSOLE NUMBER
         MVC   TIME(3),SCRATCH+1  MOVE TIME LEFT INTO PLACE
         LTR   R2,R2              HAS TIMER HIT ZERO?
         BNZ   NEXTPAGE           NO, CONTINUE TO COUNT
         MVC   TIME(3),BLANKS     CLEAR COUNTER FIELD
         XI    WAITFLG,X'FF'      TOGGLE WAIT FLAG OFF
         B     NEXTPAGE           AND GO ON AS IF NOTHING HAPPENED..
         EJECT
***********************************************************************
*                                                                     *
*                       READ COMMAND FROM USER                        *
*                                                                     *
***********************************************************************
READCHAR TCLEARQ INPUT                                             JMH
         MVC   REPLY,BLANKS       CLEAR REPLY AREA                 JMH
         TGET  REPLY,L'REPLY,ASIS GET CHARACTERS FROM TERMINAL     JMH
         LTR   R15,R15            CHECK TGET RETURN CODE           JMH
         BZ    *+24               IF OK, CONTINUE                  JMH
         C     R15,=F'8'          ATTENTION?                       JMH
         BE    READCHAR           TRY IT AGAIN                     JMH
         C     R15,=F'12'         TOO MUCH DATA?                   JMH
         BE    *+8                IF SO, JUST CONTINUE             JMH
         B     DONE               TERMINATE                        JMH
         CLI   REPLY,X'6E'        RESHOW CODE?                     JMH
         BE    NEXTPAGE           YES, JUST GO REFRESH             JMH
         OI    REPLY,X'F0'        EQU PFK 13-24 TO PFK 1-12        JMH
         CLI   REPLY,X'F1'        PFK 1  ?                         JMH
         BE    PFK1               YES, ISSUE HELP                  JMH
         CLI   REPLY,X'F3'        PFK 1  ?                         JMH
         BE    DONE               YES, TERMINATE RUN               JMH
         C     R11,=F'3'          NO ENTRY?                        JMH
         BNH   NEXTPAGE           YES, JUST GO REFRESH             JMH
         MVC   REPLY(L'REPLY-6),REPLY+6 SHIFT TO 1ST DATA POSITION JMH
         OC    REPLY(79),BLANKS   CONVERT CHARS TO UPPER CASE      JMH
         CLI   REPLY,C' '         JUST A BLANK?                    JMH
         BE    NEXTPAGE           YES, JUST GO REFRESH             JMH
         EJECT
***********************************************************************
*                                                                     *
*               CHECK FOR SYSTEM OPERATOR COMMANDS                    *
*                                                                     *
***********************************************************************
OPER     CLC   REPLY(9),PASSW
         BE    VIP
         CLC   REPLY(4),PASS2
         BE    VIP2
NOTSYS   CLI   REPLY,C'/'         ARE WE IN ALLOWED MODE
         BNE   JES
DOGQ     CLI   OPRFLAG,X'FF'
         BE    BADCMD
         MVC   OPERCMD(78),REPLY+1 MOVE CMD IN FROM REPLY FIELD
         MVC   OPERCMD+78,BLANKS  BLANK OUT COLUMN 79,80
         MVC   OPREP(79),OPERCMD   SAVE COMMAND
         B     DOCMD              ISSUE SVC 34
         SPACE 2
***********************************************************************
*                                                                     *
*               CHECK FOR JES    OPERATOR COMMANDS                    *
*                                                                     *
***********************************************************************
JES      CLI   REPLY,C'$'         IS THIS A JES COMMAND?
         BNE   CWAIT              NO, CONTINUE
         CLI   OPRFLAG,X'FF'
         BE    BADCMD
CMDOKAY  MVC   OPERCMD(79),REPLY  MOVE CMD IN FROM REPLY FIELD
         MVI   OPERCMD+79,C' '    BLANK OUT COLUMN 80
         MVC   OPREP(79),OPERCMD  SAVE COMMAND
DOCMD    MVC   REPLY,BLANKS       BLANK OUT REPLY FIELD
         LA    R3,OPERCMD+79      R3 = ADDR OF LAST COLUMN
         LA    R1,OPERCMD         R1 = ADDR OF FIRST COLUMN
NXTCHAR  CLI   0(R3),C' '         IS THIS A BLANK?
         BNE   LASTCHAR           NO; THIS IS LAST CHAR IN CMD
         BCTR  R3,0               R3 = R3 - 1
         CR    R3,R1              IS WHOLE THING BLANK?
         BL    NEXTPAGE           YES; SOMETHING WRONG, BUT CONT ANYWAY
         B     NXTCHAR            NO;  GO LOOK AT NEXT CHAR
LASTCHAR SR    R3,R1              R3 = R3- R1
         LA    R3,5(R3)           R3 = R3 + 1 (+4 FOR CNTL INFO)  JMH
         STC   R3,OPERCARD+1      INSERT LENGTH OF COMMAND        JMH
*        MODESET KEY=ZERO         SUP STATE KEY ZERO REQ FOR SVC34JMH
         SLR   R0,R0              CLEAR REG0                      JMH
         CLI   VIPFLG2,X'FF'      CHECK VIP2 MODE                 JMH
         BNE   *+8                IF VIP2 MODE INACTIVE SKIP UCMIDJMH
         ICM   R0,1,CONSOLE+3     INSERT UCMID                    JMH
         LA    R1,OPERCARD        GET ADDRESS OF COMMAND BUFFER   JMH
         SVC   34                 ISSUE WTO SVC                   JMH
*/*******************************************************************/
*/*                                                                 */
*/*                                                                 */
*/*     MOVE IN TSO USER ID AND DISPLAY ON MASTER CONSOLE           */
*/*                                                                 */
*/*     DO NOT SHOW IF REPLY OTHERWISE OP CAN SEE PASSWORDS !!!!!   */
*/*                                                                 */
*/*                                                                 */
*/*******************************************************************/
         LA    R1,OPREP           WE ARE GOING TO CHECK FOR REPLY JMH
         LA    R0,=F'79'          OUR COMMAND BUFFER LENGTH
         CLC   =C'R ',0(R1)       R COMMAND
         BNE   REP2               NO GOOD
         LA    R1,2(,R1)          SKIP IT
         SH    R0,=H'2'           REDUCE LENGTH
         B     REP3
REP2     CLC   =C'REPLY ',0(R1)   FULL LENGTH REPLY
         BNE   REP5
         LA    R1,6(,R1)          SKIP COMMAND
         SH    R0,=H'6'           REDUCE LENGTH
REP3     LTR   R0,R0              HAVE WE GOT ANY MORE
         BNP   REP7
REP4     CLI   0(R1),C' '        LEADING BLANK
         BNE   REP5               NO  WE WANT A NUMBER
         LA    R1,1(,R1)          INCREMENT
         BCT   R0,REP4            LETS GO ROUND AGAIN
REP5     LTR   R0,R0              DONE IT ALL
         BNP   REP7
         TM    0(R1),X'F0'              GOT A NUMBER
         BNO   REP7                     CANT BE A REPLY
         MVI   REPLID,C'0'        IST DIGIT
         MVC   REPLID+1(1),0(1)   SAVE IST DIGIT OF REPLY
         CH    R0,=H'2'           ROOM FOR 2ND DIGIT
         BL    REP6               WE ONLY NEED 1 DIGIT
         TM    1(R1),X'F0'        NUMERIC ZONE
         BNO   REP6               NO  WE ONLY NEED I DIG
         MVC   REPLID,0(R1)       USE BOTH
REP6     MVI   OPREP,X'40'
         MVC   OPREP+1(78),OPREP
         MVC   OPREP(6),=C'REPLY '
         MVC   OPREP+6(2),REPLID
REP7     EQU   *
         MVC   WTOFIELD+8(17),DOGTXT   USER-ID ETC GARBAGE       JMH
         MVC   WTOFIELD+25(55),OPREP   REST OF TEXT              JMH
WTOFIELD WTO  '                                                        X
                                         '
         EJECT                                                    JMH
*        MODESET KEY=NZERO        RESTORE KEY                     JMH
         B     NEXTPAGE
***********************************************************************
*                                                                     *
*                       W  --  ENTER WAIT MODE                        *
*                                                                     *
***********************************************************************
CWAIT    CLI   REPLY,C'W'         DO WE SHIFT TO WAIT MODE?
         BNE   CDELAY             NO, SO CONTINUE
         XI    WAITFLG,X'FF'      TURN ON WAIT FLAG
         LA    R2,30              SET DEFAULT VALUE = 30
         LA    R15,CONVBIN        BRANCH TO CONVERSION RTN
         BALR  R14,R15            EBCDIC TO BINARY
         MVC   SCRATCH(4),PATTERN MOVE IN EDIT PATTERN
         ED    SCRATCH(4),WORK+6  EDIT IN CONSOLE NUMBER
         MVC   TIME(3),SCRATCH+1  MOVE TIME LEFT INTO PLACE
         ST    R2,TYMER           STORE STARTING TIMER VALUE
         B     NEXTPAGE           ALL SET - GO DISPLAY NEXT PAGE
***********************************************************************
*                                                                     *
*            D  --  SET TIMER DELAY IN TENTHS OF A SECOND             *
*                                                                     *
***********************************************************************
CDELAY   CLI   REPLY,C'D'         ARE WE CHANGING THE TIME DELAY?
         BNE   CCONSOLE           NO, SO CONTINUE
         LA    R2,10              SET DEFAULT VALUE = 10 TENTHS SECOND
         LA    R15,CONVBIN        BRANCH TO CONVERSION RTN
         BALR  R14,R15            EBCDIC TO BINARY
         LTR   R2,R2              TEST FOR ZERO                    JMH
         BNP   NEXTPAGE           IGNORE IF NOT GREATER THAN ZERO  JMH
         MVC   SCRATCH(5),DPATTRN MOVE IN EDIT PATTERN
         ED    SCRATCH(5),WORK+6  EDIT IN DELAY TIME
         MVC   PAUSE(3),SCRATCH+2 MOVE TIME LEFT INTO PLACE
         MH    R2,=H'10'          CONVERT TO 100THS OF A SECOND
         ST    R2,DELAY           STORE WAIT DELAY VALUE
         B     NEXTPAGE           ALL SET - GO DISPLAY NEXT PAGE
***********************************************************************
*                                                                     *
*                    C  --  SET CONSOLE NUMBER                        *
*                                                                     *
***********************************************************************
CCONSOLE CLI   REPLY,C'C'         DO WE CHANGE CONSOLES?
         BNE   END                NO, SO CONTINUE
         L     R2,CONSOLE         SET DEFAULT CONSOLE
         ST    R2,OLDCONS         SAVE OLD CONSOLE #
         CLI   REPLY+1,C' '       CONSOLE SPECIFIED?               JMH
         BNE   *+8                IF SO, USE IT                    JMH
         L     R2,MSTCON          OTHERWISE USE MASTER CONSOLE     JMH
         LA    R15,CONVBIN        BRANCH TO
         BALR  R14,R15            EBCDIC->BINARY CONVERTOR
         ST    R2,CONSOLE         STORE R2 AWAY AS CONSOLE NUMBER
         B     NEXTPAGE           CONTINUE
***********************************************************************
*                                                                     *
*                        E  --  TERMINATE XACONS                      *
*                                                                     *
***********************************************************************
END      CLI   REPLY,C'E'         IS IT AN 'E'?
         BE    DONE               YES, SO QUIT
***********************************************************************
*                                                                     *
*               F  --  FREEZE DISPLAY ON CURRENT PAGE                 *
*                                                                     *
***********************************************************************
F        CLI   REPLY,C'F'         IS IT AN 'F'?
         BNE   R                  NO, SO CONTINUE ON
         MVI   FREEZE,C'F'        TURN ON FREEZE INDICATOR
         B     NEXTPAGE           CONTINUE
***********************************************************************
*                                                                     *
*           R  --  RELEASE FREEZE ON CURRENT PAGE DISPLAY             *
*                                                                     *
***********************************************************************
R        CLI   REPLY,C'R'         IS IT AN 'R'?
         BNE   MODE1              NO, SO CONTINUE ON
         MVI   FREEZE,C'R'        TURN OFF FREEZE INDICATOR
         B     NEXTPAGE           CONTINUE
***********************************************************************
*                                                                     *
*                1  --  SHIFT TO MODE 1 TYPE DISPLAY                  *
*                                                                     *
***********************************************************************
MODE1    CLI   REPLY,C'1'         DO WE SHIFT TO MODE 1 DISPLAY?
         BNE   MODE2              NO, SO CONTINUE
         MVI   MODE,C'1'          SET MODE INDICATOR
         B     NEXTPAGE
***********************************************************************
*                                                                     *
*                2  --  SHIFT TO MODE 2 TYPE DISPLAY                  *
*                                                                     *
***********************************************************************
MODE2    CLI   REPLY,C'2'         DO WE SHIFT TO MODE 2 DISPLAY?
         BNE   GETHELP            NO, SO CONTINUE
         MVI   MODE,C'2'          SET MODE INDICATOR
         B     NEXTPAGE
***********************************************************************
*                                                                     *
*           ?  --  LIST HELP FOR MVS COMMANDS ON TERMINAL             *
*                                                                     *
***********************************************************************
GETHELP  CLI   REPLY,C'?'         IS HE ASKING FOR HELP?
         BE    PFK1               YES, GIVE IT TO HIM              JMH
         CLI   REPLY,C'H'         IS HE ASKING FOR HELP?           JMH
         BNE   GETSTAT            NO,SO CONTINUE
PFK1     L     R1,=A(HELP)        R1 = ADDR OF HELP PAGE
         LA    R0,HLENGTH         R0 = LENGTH OF HELP PAGE
         ICM   R1,8,FULLSCR       INSERT ASIS CNTL CHARS
         BAL   R14,TERMPUT        DO A TPUT; DISPLAY HELP
         B     READCHAR           READ REPLY                       JMH
         EJECT                                                     JMH
***********************************************************************
*                                                                     *
*           S  --  LIST STATUS PAGE FOR ALL DEFINED CONSOLES          *
*                                                                     *
***********************************************************************
GETSTAT  CLI   REPLY,C'S'         IS HE ASKING FOR STATUS REPORT?
         BNE   VIP                NO; CONTINUE
         BAL   R14,CLRBUF         CLEAR BUFFER
         LH    R10,NUMUCMS        R10 = NUMBER OF CONSOLES
*        LA    R2,UCMTAB+16       R2 = ADDR OF FIRST CONSOLE ENTRY
         L     R2,UCM#TAB         AS BEFORE WE HAVE TO DO IT THIS WAY
         LA    R2,16(R2)
         LA    R4,BUF             R4 = ADDR OF TPUT BUFFER
         L     R3,LPSCREEN        R3 = NUMBER OF LINES ON SCREEN   JMH
         BCTR  R3,0               SET TO LPSCREEN-1                JMH
STLOOP   LR    R1,R2              R1 = ADDR OF UCMTAB ENTRY
         BAL   R14,CONSDATA       CALL CONSOLE DATA ROUTINE
         MVC   0(45,R4),CONNUM    SAVE RESULTS IN BUFFER
         LA    R4,80(R4)          R4 = ADDR OF NEXT LINE IN BUFFER
         LA    R2,16(R2)          R2 = ADDR OF NEXT UCMTAB ENTRY
         BCT   R3,NOTFULL         BRANCH IF THE SCREEN NOT FULL
         MVC   0(MSGLEN,R4),CONTMSG ADD CONTINUE MSG               JMH
FULL     LA    R1,HEADER          R1 = ADDR OF TPUT BUF
         S     R4,=A(BUF)                                          JMH
         LA    R4,HEADLEN+MSGLEN(,R4)                              JMH
         LR    R0,R4              R0 = LENGTH OF TPUT BUF          JMH
         ICM   R1,8,FULLSCR       INSERT ASIS CNTL CHARS
         BAL   R14,TERMPUT        DO A TPUT; DISPLAY STATUS PAGE
         BAL   R14,CLRBUF         CLEAR BUFFER
         LA    R4,BUF             R4 = ADDR OF TPUT BUFFER
         L     R3,LPSCREEN        R3 = NUMBER OF LINES ON SCREEN   JMH
         BCTR  R3,0               SET TO LPSCREEN-1                JMH
         BCT   R10,MORE           MORE ENTRIES?
         B     NEXTPAGE           NO; CONTINUE                     JMH
MORE     EQU   *
         TCLEARQ INPUT                                             JMH
         TGET  REPLY,0,ASIS       PAUSE FOR ENTER                  JMH
         B     STLOOP             AND LOOP
NOTFULL  BCT   R10,STLOOP         LOOP IF MORE
         MVC   0(MSGLEN,R4),CONTMSG ADD CONTINUE MSG               JMH
         LA    R1,HEADER          R1 = ADDR OF TPUT BUF
         S     R4,=A(BUF)                                          JMH
         LA    R4,HEADLEN+MSGLEN(,R4)                              JMH
         LR    R0,R4              R0 = LENGTH OF TPUT BUF          JMH
         ICM   R1,8,FULLSCR       INSERT ASIS CNTL CHARS
         BAL   R14,TERMPUT        DO A TPUT; DISPLAY STATUS PAGE
         B     READCHAR           CONTINUE                         JMH
***********************************************************************
*                                                                     *
*                       CHECK FOR PASSWORD OR TSO                     *
*                                                                     *
***********************************************************************
VIP      CLC   REPLY(3),TSO       TSO REQUIRED
         BE    DOTSO
         CLC   REPLY(9),PASSW     WAS VIP PASSWORD ENTERED?
         BNE   VIP2               NO, CONTINUE                     JMH
         NI    OPRFLAG,X'00'      TOGGLE VIP FLAG
         B     NEXTPAGE
VIP2     CLC   REPLY(4),PASS2
         BNE   INVCMD
         OI    OPRFLAG,X'FF'      RE-SET DISPLAY ONLY MODE         JMH
         B     NEXTPAGE                                            JMH
***********************************************************************
*                                                                     *
*                      TSO REQUIRED                                   *
*   SINCE WEVE GOT VARIOUS ADDRESS SPACES HERE AND WE ARE IN          *
*   KEY ZERO AND SUPERVISOR STATE WE HAVE TO RELEASE ALL THIS GARBAGE *
*  AND GET BACK TO OUR HOME ASID. AT THIS TIME WE WILL CHECK THIS     *
*  FLAG. IF ITS ON WE WILL CALL THE TSO PROCESSOR OTHERWISE WE WILL   *
*  EXIT                                                               *
*                                                                     *
***********************************************************************
DOTSO    EQU   *
         MVI   TSOFLAG,X'FF'
         B     DONE
***********************************************************************
*                                                                     *
*                      COMMAND WAS INVALID                            *
*                                                                     *
***********************************************************************
BADCMD   MVC   ERROR(44),ERRMSG9  PASSWORD NEEDED
         B     NEXTPAGE
INVCMD   MVC   ERROR(44),ERRMSG8  INVALID COMMAND
         B     NEXTPAGE
         SPACE 3
***********************************************************************
*                                                                     *
*                     ALL DONE - PREPARE TO END                       *
*                                                                     *
***********************************************************************
DONE     DS    0H
         CLI   CRTFLAG,X'00'      IS THIS A HARDCOPY?
         BE    DONE2              YES
         TPUT  CLR,CLRLEN,FULLSCR NO, LETS CLEAR THE SCREEN FIRST
         TCLEARQ INPUT            CLEAN UP                         JMH
         STFSMODE OFF             AND TURN OFF FULLSCREEN MODE
DONE2    L     R1,LOCDCM          PREPARE TO FREEMAIN TDCM AREA    XA
         FREEMAIN R,LV=820,A=(1)  DO IT                            XA
         AXSET AX=ZERO            AUTH INDEX BACK TO 0             XA
ALLDONE  EQU   *
         LA    R1,MSGNEW           POINT TO SPF CLEAR MESSAGE
         LA    R0,NEWLEN           LENGTH OF MESSAGE
DOTPUT   ICM   R1,8,=X'03'         INDICATE FULL SCREEN TPUT
         TPUT  (1),(0),R           CLEAR SCREEN
         STAX
         STLINENO LINE=1,MODE=OFF  TURN OFF FULL SCREEN MODE FOR VTAM
         MODESET KEY=NZERO,MODE=PROB GET TO USER KEY PROBLEM MODE
         SR    R14,R14             ZERO R14                        JMH
         LA    R1,8                GET BACK TO UNAUTHORIZED STATE  JMH
         SR    R0,R0               ZERO R0                         JMH
         LA    R15,32
         SVC   109                 USE ESVC ROUTER                 JMH
*        RETURN (14,12),T          RETURN
*        SVC   3
         CLI   TSOFLAG,X'FF'
         BNE   KILLUS
         MVI   TSOFLAG,X'00'
         LINK  EP=EXECTSO         CALL OUR COMMAND PROCESSOR
         B     SKIP               WE HAVE TO START AGAIN
KILLUS   L     R13,SAVE+4         RESTORE POINTER TO CALLER'S SAVE AREA
         LM    R14,R12,12(R13)    RESTORE REGISTERS
         LA    R15,0              SET RC = 0
         BR    R14                RETURN TO SYSTEM
         EJECT
***********************************************************************
*                                                                     *
*            CONVERT EBCDIC NUMBERS FROM USER INTO BINARY             *
*                                                                     *
***********************************************************************
CONVBIN  CVD   R2,WORK            CONVERT TO DECIMAL.
         CLI   REPLY+1,C' '       DID HE ENTER A NUMBER?
         BE    RTRN               NO, USE THE DEFAULT
         CLI   REPLY+1,C'0'       IS THE HEX CODE < 'F0' ?
         BL    BADCHAR            YES, ERROR
         CLI   REPLY+1,C'9'       IS THE HEX CODE > 'F9' ?
         BH    BADCHAR            YES, ERROR
         PACK  WORK(8),REPLY+1(1) PACK EBCDIC (ASSUME 1 DIGIT)
         CLI   REPLY+2,C' '       DID HE ENTER 2 DIGITS?
         BE    CVB                NO, DONT DO THE 2 DIGIT PACK
         CLI   REPLY+2,C'0'       IS THE HEX CODE < 'F0' ?
         BL    BADCHAR            YES, ERROR
         CLI   REPLY+2,C'9'       IS THE HEX CODE > 'F9' ?
         BH    BADCHAR            YES, ERROR
         PACK  WORK(8),REPLY+1(2) PACK AGAIN, WITH 2 DIGITS THIS TIME
CVB      CVB   R2,WORK            GET BINARY
RTRN     BR    R14                RETURN TO MAINLINE
BADCHAR  MVC   ERROR(26),ERRMSG2  CONSOLE NUMBER ERROR
         B     RTRN
         SPACE 2
***********************************************************************
*                                                                     *
*                            C L R B U F                              *
*                                                                     *
*               CLEAR THE ENTIRE BUF AREA TO BLANKS                   *
*                                                                     *
***********************************************************************
CLRBUF   STM   R2,R5,SAVE25       SAVE REGS 2 - 5
         LA    R2,BUF             R2 = ADDR OF BUFFER
         L     R3,=A(BUFLEN)      R3 = LENGTH OF BUFFER            JMH
         LA    R4,BLANKS          R4 = ADDR OF BLANKS
         SLR   R5,R5              R5 = 0 TO FORCE ALL PAD CHARS    JMH
         ICM   R5,8,BLANKS        SETUP PAD CHAR = X'40'
         MVCL  R2,R4
         LM    R2,R5,SAVE25       RESTORE REGS
         BR    R14                RETURN TO CALLER
SAVE25   DS    4F
         SPACE 2
***********************************************************************
*                                                                     *
*                         T E R M P U T                               *
*                                                                     *
*          DO A TPUT TO THE TERMINAL; R0 AND R1 HOLD PARMS            *
*                                                                     *
***********************************************************************
TERMPUT  TPUT  (1),(0),R          PRINT ONE LINE ON HARDCOPY
         BR    R14                RETURN TO CALLER
         EJECT
***********************************************************************
*                                                                     *
*                          C O N S D A T A                            *
*                                                                     *
*         FILL IN THE DATA LINE FOR A GIVEN CONSOLE                   *
*                                                                     *
***********************************************************************
CONSDATA STM   R0,R15,SAVECDAT    SAVE REGS
         L     R5,0(R1)           R5 = ADDR OF UCM
         USING UCMLIST,R5
         L     R6,UCMXB           R6 = ADDR OF RDCM
*        USING DCMTSRT,R6
         USING DCMADTRN,R6
         MVC   CONNUM(48),BLANKS   BLANK OUT CONSOLE TYPE FIELD
         XR    R3,R3              CLEAR R3
         ICM   R3,1,UCMID         LOAD THE CONSOLE NUMBER
         CVD   R3,WORK            CONVERT TO DECIMAL IN WORK
         MVC   SCRATCH(4),PATTERN    MOVE IN EDIT PATTERN
         ED    SCRATCH(4),WORK+6     EDIT IN CONSOLE NUMBER
         MVC   CONNUM(2),SCRATCH+2   MOVE CONSOLE NUMBER INTO PLACE
         MVC   LOCATION(12),4(R1) MOVE IN CONSOLE LOCATION DESCRIPTION
         MVI   SLASH,C'/'
         MVC   STATUS(6),=CL6'ACTIVE' SET STATUS = 'ACTIVE'
         TM    UCMDISP1,UCMDISPA  IS THIS A MASTER CONSOLE?
         BNO   AUTH               NO
         MVC   STATUS(6),=CL6'MASTER' YES
AUTH     TM    UCMAUTHA,UCMAUTH1  IS THIS CONSOLE SYSTEM AUTHORIZED?
         BNO   AUTH1              NO
         MVC   SYS(3),=CL3'SYS '  YES
AUTH1    TM    UCMAUTHA,UCMAUTH2  IS IT I/O AUTHORIZED?
         BNO   AUTH2              NO
         MVC   IO(3),=CL3'I/O'    YES
AUTH2    TM    UCMAUTHA,UCMAUTH3  IS IT CONS AUTHORIZED?
         BNO   AUTHDONE           NO
         MVC   CONS(3),=CL3'CON'  YES
AUTHDONE EQU   *
         LTR   R6,R6              IS THIS A GRAPHICS CONSOLE?
         BP    NOTHARD            YES
         MVC   STATUS(6),=CL6'HRDCPY'
NOTHARD  EQU   *
         TM    UCMATR,UCMUF       IS THIS DEVICE ACTIVE?
         BO    ACT                YES
         MVC   STATUS(6),=CL6'INACTV'
ACT      EQU   *
         L     R7,UCMUCB          R7 = ADDR OF UCB
         MVC   UNIT(3),13(R7)     MOVE UNIT ADDR INTO LINE
         L     R5,UCMALTEN        R5 = ADDR OF ALTERNATE UCM
         L     R7,UCMUCB          R7 = ADDR OF UCB
         MVC   ALTUNIT(3),13(R7)  MOVE UNIT ADDR INTO LINE
         SPACE
         LM    R0,R15,SAVECDAT    RESTORE REGS
         BR    R14
         DROP  R5,R6,R12
SAVECDAT DS    16F
         SPACE 2
         EJECT
***********************************************************************
*                                                                     *
*                          A T T N E X I T                            *
*                                                                     *
*         TRAP USERS ATTENTION INTERRUPTS AND FLAG FOR RESET          *
*                                                                     *
***********************************************************************
         USING ATTNEXIT,R15       ADDRESSABILITY.
ATTNEXIT MVI   ATTNFLG,X'FF'      SET ATTN FLAG
         BR    R14                RETURN TO CALLER
         DROP  R15
         EJECT
***********************************************************************
*                                                                     *
*                         C O N S T A N T S                           *
*                                                                     *
***********************************************************************
         DS    0D
WORK     DS    D                   WORK AREA FOR PACKS
SCRATCH  DS    D                   SCRATCH AREA FOR CHAR. MANIP
OLDCONS  DC    F'1'                PREVIOUS CONSOLE NUMBER
CONSOLE  DC    F'1'                CONSOLE TO BE LOOKED AT
MSTCON   DC    F'1'                MASTER CONSOLE NUMBER
LPSCREEN DC    H'0'                LINES PER SCREEN
CPLINE   DC    H'0'                CHARACTERS PER LINE
TYMER    DC    F'30'               SECONDS LEFT ON TIMER
DELAY    DC    F'100'              DELAY FOR 100 HUNDREDTHS OF A SECOND
MSGNEW   DC    X'63115D7E1140403C4040001D40'
NEWLEN   EQU   *-MSGNEW
*
MOD3FLG  DC    X'00'               X'FF' INDICATES 327X-3 IN USE  JMH
MOD4FLG  DC    X'00'               X'FF' INDICATES 327X-4 IN USE
ATTNFLG  DC    X'00'               X'FF' INDICATES ATTN WAS TRAPPED
CRTFLAG  DC    X'FF'               X'FF' INDICATES CRT IN USE
WAITFLG  DC    X'00'               X'00' INDICATES NOT IN WAIT MODE
VIPFLG2  DC    X'FF'               X'FF' INDICATES VIP MODE 2     JMH
PASSW    DC   CL9'DOGBURGER'
PASS2    DC   CL4'ABCD'
INTEGFLG DC    X'00'               X'FF' INDICATES 35-LINE 3066 CONSOLE
SBAFIX   DC    X'00'               X'FF' INDICATES SBA ADDR FIX REQJMH
*
FULLSCR  DC    X'03'               TPUT FULSCREEN FLAG
EDITFLG  DC    X'00'               TPUT EDIT FLAG
TSO      DC    C'TSO'
TSOFLAG  DC    X'00'
*
SBATAB   DC    X'4040C150C260C3F0C540C650C760C8F04A404B50'  01-10  JMH
         DC    X'4C604DF04F405050D160D2F0D440D550D660D7F0'  11-20  JMH
         DC    X'D9405A505B605CF05E405F50606061F0E340E450'  21-30  JMH
         DC    X'E560E6F0E840E9506A606BF06D406E506F60F0F0'  31-40  JMH
         DC    X'F240F350F460'                              41-43  JMH
*
R30C1    DC    X'11E450'           327X-3  --  ROW 30, COL 1       JMH
R31C1    DC    X'11E560'           327X-3  --  ROW 31, COL 1       JMH
R32C1    DC    X'11E6F0'           327X-3  --  ROW 32, COL 1       JMH
*                                                                  JMH
R41C1    DC    X'11F240'           327X-4  --  ROW 41, COL 1
R42C1    DC    X'11F350'           327X-4  --  ROW 42, COL 1
R43C1    DC    X'11F460'           327X-4  --  ROW 43, COL 1
PATTERN  DC    X'40202020'         EDIT PATTERN FIELD
DPATTRN  DC    X'4021204B20'       EDIT PATTERN FIELD
PAD      DC    C' '                PAD CHARACTER FOR MOVEBUFF MVC
STAXLIST STAX  ATTNEXIT,MF=L       PARM LIST FOR ATTENTION TRAP
BLANKS   DC    CL85' '                                             JMH
MOVEBSAV DS    6F                 REG SAVE AREA - R4:R9             XA
         DS    0F
OPERCARD DC    Y(54),Y(00)         SETUP FOR COMMAND               JMH
OPERCMD  DC    CL80' '                                             JMH
REPLY    DC    CL85' '             USER'S COMMAND INPUT BUFFER
OPREP    DC    CL79' '
REPLID   DC    CL2' '
DOGTXT   DC    CL17'*** XXXXXXXX ==> '                             JMH
XXCONBUF DS    F                  LENGTH OF CONSOLE BUFFER AREA    JMH
XXTOTBUF DS    F                  TPUT BUFFER LENGTH               JMH
CONTMSG  DC    X'115CF0'        ROW 24, COL 1                      JMH
         DC    C'PRESS ENTER TO CONTINUE'                          JMH
         DC    X'1D40'
         DC    X'13000000'      INPUT AREA FOR COMMAND             JMH
         DC    X'1DE8'
MSGLEN   EQU   *-CONTMSG        LENGTH OF CONTINUE MESSAGE         JMH
***********************************************************************
*                                                                     *
*               327X SCREEN CLEAR CONTROL CHARACTERS                  *
*                                                                     *
***********************************************************************
CLR      DC    X'F3'              WCC - CLEAR SCREEN
         DC    X'115D7E'          SBA TO ROW 24, COL 80 TCAM FLAGS *JMH
         DC    X'114040'          SBA TO ROW 1, COL 1
         DC    X'3C404000'        FILL SCREEN WITH NULLS
         DC    X'114040'          SBA TO ROW 1, COL 1
         DC    X'13'              INSERT CURSOR
CLRLEN   EQU   *-CLR
         SPACE 5
***********************************************************************
*                                                                     *
*               DISPLAY SCREEN - TRAILER SECTION WORK AREA            *
*                                                                     *
***********************************************************************
TRAILER  EQU   *
CMDCTRL  DC    X'404040'
         DC    X'1DE8'            ATTR BYTE - PROTECTED, HIGH INTENSITY
LASTLINE DC    CL79' '            OPERATORS COMMAND INPUT LINE
PHEADING DC    X'115B60'          SBA TO ROW 23, COL 1
         DC    X'1DE8'            ATTR BYTE - PROTECTED, HIGH INTENSITY
HEADING  DC    CL8'CONSOLE '
CONNUM   DC    CL2' 1'            CONSOLE NUMBER
         DC    CL1' '
LOCATION DC    CL12' '
         DC    CL2' '
UNIT     DC    CL3' '
SLASH    DC    CL1'/'
ALTUNIT  DC    CL3' '
         DC    CL2' '
STATUS   DC    CL6' '             MASTER CONSOLE
         DC    CL2' '
SYS      DC    CL4' '             SYS  AUTHORIZATION
IO       DC    CL4' '             I/O  AUTHORIZATION
CONS     DC    CL3' '             CONS AUTHORIZATION
         DC    CL3' '
TIME     DC    CL3' '             SECONDS REMAINING ON TIMER
         DC    CL1'/'
PAUSE    DC    CL3'1.0'           DELAY IN SECONDS
         DC    CL2' '
HEADING2 DC    CL5'MODE:'
FREEZE   DC    C'F'               FREEZE/RELEASE MODE
MODE     DC    CL1'2'             DISPLAY MODE 2/1
         DC    CL1' '
         DC    CL5'PAGE '
PAGE     DC    CL1'1'             PAGE NUMBER
R24C1    DC    X'115CF0'          SBA TO ROW 24, COL 1
         DC    X'1D40'            ATTR BYTE - UNPROTECTED, LOW INTENS.
         DC    X'13'              INSERT CURSOR
USERLINE DC    13X'00'            USERS COMMAND INPUT LINE
ERROR    DC    CL66' '            ERROR MSG FIELD
TRAILEN  EQU   *-TRAILER          LENGTH OF TRAILER
***********************************************************************
*                                                                     *
*                  DISPLAY SCREEN - HEADER SECTION                    *
*                                                                     *
***********************************************************************
HEADER   EQU   *
CLEAR    DC    X'F3'              WCC
         DC    X'115D7F'          SBA TO ROW 24, COL 80 (FSE 5.0)
         DC    X'114040'          SBA TO ROW 1, COL 1
         DC    X'3C404000'        FILL SCREEN WITH NULLS
         DC    X'114040'          SBA TO ROW 1, COL 1 JUST IN CASE
         DC    X'1D60'            ATTR BYTE - PROTECTED FIELD
HEADLEN  EQU   *-HEADER           LENGTH OF HEADER
***********************************************************************
*                                                                     *
*                 DISPLAY SCREEN IMAGE BUFFER SECTION                 *
*                                                                     *
***********************************************************************
BUF      DC    43CL84' '          MAX OPERATORS SCREEN BUFFER      JMH
***********************************************************************
*                                                                     *
*               DISPLAY SCREEN - TRAILER SECTION                      *
*                                                                     *
***********************************************************************
         DC    CL(TRAILEN)' '     RESERVE FOR TRAILER              JMH
         SPACE 1
SASID    DS    F                  STORE FOR PREVIOUS SEC ASID     JMH
LOCDCM   DS    F                  ADDR OF GETMAINED AREA FOR TDCM JMH
ONE      DC    H'1'               TO SET AX 1                     JMH
ZERO     DC    H'0'               TO SET AX 0                     JMH
OPRFLAG  DC    X'00'
         SPACE
         LTORG
         SPACE
***********************************************************************
*                                                                     *
*                     ERROR AND WARNING MESSAGES                      *
*                                                                     *
***********************************************************************
ERRMSG1  DC    CL26'ERROR - CONSOLE UNDEFINED '
ERRMSG2  DC    CL26'ERROR - NON-NUMERIC VALUE '
ERRMSG3  DC    CL26'ERROR - INVALID COMMAND   '
ERRMSG4  DC    CL26'ERROR - NON-CRT CONSOLE   '
ERRMSG5  DC    CL26'WARNING - UCM TABLE FULL  '
ERRMSG6  DC    CL26'ERROR - TERMINAL INVALID  '
ERRMSG8  DC    CL44'INVALID COMMAND ENTERED--ENTER ? OR HELP'
ERRMSG9  DC    CL44'UNAUTHORIZED USE OF MVS OR JES2 COMMANDS'
         EJECT
***********************************************************************
*                                                                     *
*                            U C M T A B                              *
*                                                                     *
*        THE UCMTAB TABLE IS BUILT AT SPY INITIALIZATION TIME.        *
*        ONE ENTRY IS FILLED IN FOR EACH CONSOLE THAT HAS BEEN        *
*        IOGENED INTO THE SYSTEM. THE 12 BYTE DESCRIPTION FIELD       *
*        ALLOWS YOU TO TAG EACH CONSOLE WITH SOME MNEMONIC THAT       *
*        IS EASIER TO REMEMBER THAN CONSOLE NUMBERS. IF UCMTAB IS     *
*        NOT DEFINED LARGE ENOUGH TO HOLD ALL THE CONSOLES, A         *
*        WARNING IS ISSUED BUT SPY CONTINUES ANYWAY.                  *
*                                                                     *
***********************************************************************
NUMUCMS  DC    H'0'
UCM#TAB  DC    A(UCMTAB)
UCMTABE  DC    A(TABEND)
         DS    0F
UCMTAB   DC    A(0),CL12'            '
         DC    A(0),CL12'            '    CONSOLE 1
         DC    A(0),CL12'            '    CONSOLE 2
         DC    A(0),CL12'            '    CONSOLE 3
         DC    A(0),CL12'            '    CONSOLE 4
         DC    A(0),CL12'            '    CONSOLE 5
         DC    A(0),CL12'            '    CONSOLE 6
         DC    A(0),CL12'            '    CONSOLE 7
         DC    A(0),CL12'            '    CONSOLE 8
         DC    A(0),CL12'            '    CONSOLE 9
         DC    A(0),CL12'            '    CONSOLE 10
         DC    A(0),CL12'            '    CONSOLE 11
         DC    A(0),CL12'            '    CONSOLE 12
         DC    A(0),CL12'            '    CONSOLE 13
         DC    A(0),CL12'            '    CONSOLE 14
         DC    A(0),CL12'            '    CONSOLE 15
         DC    A(0),CL12'            '    CONSOLE 16
         DC    A(0),CL12'            '    CONSOLE 17
         DC    A(0),CL12'            '    CONSOLE 18
         DC    A(0),CL12'            '    CONSOLE 19
         DC    A(0),CL12'            '    CONSOLE 20
         DC    A(0),CL12'            '    CONSOLE 21
         DC    A(0),CL12'            '    CONSOLE 22
         DC    A(0),CL12'            '    CONSOLE 23
         DC    A(0),CL12'            '    CONSOLE 24
         DC    A(0),CL12'            '    CONSOLE 25
TABEND   EQU   *
         EJECT
***********************************************************************
*                                                                     *
*                           USER HELP PAGE                            *
*                                                                     *
***********************************************************************
HELP     CSECT                                                     JMH
         DC    X'F3'               WCC
         DC    X'115D7F'           SBA TO ROW 24, COL 80
         DC    X'114040'           SBA TO ROW 1, COL 1
         DC    X'3C404000'         FILL SCREEN WITH NULLS
         DC    X'114040',X'1DE8',C'XACONS--MIKE HAWTHORNE FEB 29 1984'
         DC    X'11C260',C'COMMAND  DESCRIPTION'
         DC    X'11C3F0'
         DC    X'11C540',C'  PFK1/13  DISPLAY HELP'                JMH
         DC    X'11C650',C'  PFK3/15  END'                         JMH
         DC    X'11C760',C'  C     SWITCH MONITOR TO MASTER CONSOLE'
         DC    X'11C8F0',C'  CXX   SWITCH MONITOR TO CONSOLE XX'
         DC    X'114A40',C'  DXX   SET DELAY TO XX TENTHS SECONDS'
         DC    X'114B50',C'  E     END'
         DC    X'114C60',C'  F     FREEZE DISPLAY ON CURRENT PAGE'
         DC    X'114DF0',C'  R     RELEASE DISPLAY'
         DC    X'114F40',C'  S     STATUS OF ALL CONSOLES'
         DC    X'115050',C'  W     START TIMER MODE FOR 30 SECONDS'
         DC    X'11D160',C'  WXX   START TIMER MODE FOR XX SECONDS'
         DC    X'11D2F0',C'  W0    START TIMER MODE UNTIL ATTN'
         DC    X'11D440',C'  ?/H   DISPLAY HELP'
         DC    X'11D550',C'  1     DISPLAY MODE 1 (TOP N, REMAINDER )'
         DC    X'11D660',C'  2     DISPLAY MODE 2 (TOP N, BOTTOM N  )'
         DC    X'11D7F0',C'  TSO   ATTACH TSO PROCESSOR (NOT TEST)'
         DC    X'11D940',C'HITTING INTERRUPT WILL STOP THE WAIT TIMER'
         DC    X'115A50'
         DC    X'115B60'
         DC    X'115CF0'        ROW 24, COL 1                      JMH
         DC    C'PRESS ENTER TO CONTINUE'                          JMH
         DC    X'1D40'
         DC    X'13000000'      INPUT AREA FOR COMMAND             JMH
         DC    X'1DE8'
HLENGTH  EQU   *-HELP           LENGTH OF HELP TPUT
XACONS   CSECT                                                     JMH
         EJECT
***********************************************************************
*                                                                     *
*                           E Q U A T E S                             *
*                                                                     *
*     NOTE THAT A 'LINE' IS DEFINED AS 84 BYTES; THIS IS BECAUSE      *
*     DIDOCS BUILDS THE OPERATOR SCREEN BUFFER LINES AS 79 BYTES OF   *
*     TEXT + 5 CONTROL BYTES. THIS CONSISTS OF AN SBA (X'11XXYY')     *
*     AND AN ATTRIBUTE BYTE (X'1DXX').                                *
*                                                                     *
***********************************************************************
CONASID  EQU   5                  'CONSOLE' ASID     CHANGED FOR SP  XA
BUFLEN   EQU   43*84              SIZE OF BUFFER                   JMH
         SPACE 3
***********************************************************************
*                                                                     *
*                SYSTEM CONTROL BLOCK MAPPING DSECTS                  *
*                                                                     *
*     ALL MACROS CAN BE FOUND IN SYS1.MACLIB, AND SYS1.AMODGEN.       *
*     SP 1.3.3 MACROS MAY ALSO NEED SYS1.AMACLIB AND OR SYS1.AGENLIB. *
*     NOTE THAT THE RESIDENT DISPLAY AND PAGEABLE DISPLAY MACROS      *
*     HAVE BEEN RE-NAMED FOR BOTH XA AND SP 1.3.3  JMH                *
*                                                                     *
***********************************************************************
         PRINT NOGEN
         CVT   DSECT=YES          COMMUNICATIONS VECTOR TABLE
         SPACE 2
         IEECUCM FORMAT=NEW,DSECT=YES,LIST=NO
         SPACE 2
         IEECRDCM                 RESIDENT DISPLAY CONTROL MODULE   XA
         SPACE 2
         IEECDCM ,                PAGEABLE DISPLAY CONTROL MODULE   XA
         SPACE 2
         IHAPSA  ,                PREFIXED STORAGE AREA            JMH
         SPACE 2
         IEZJSCB ,                JOB STEP CONTROL BLOCK
         SPACE 2
         IKJPSCB ,                PROTECTED STEP CONTROL BLOCK
         SPACE 2
         IKJTCB  ,                TASK CONTROL BLOCK
         SPACE 2
         END   XACONS

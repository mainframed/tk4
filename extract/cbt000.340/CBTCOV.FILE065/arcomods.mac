//TS00040  JOB 5208-7030,'M. H. HEMP LPK-4117',CLASS=Z,
//             NOTIFY=PTSMHH,MSGLEVEL=(1,1),MSGCLASS=Y
/*ROUTE  PRINT LOCAL
//TS00040 EXEC SMP4,SVOL=TARGET,A=Y
//SYSIN     DD *
  RECEIVE   SELECT (TS00040) .
  APPLY     SELECT (TS00040) .
  ACCEPT    SELECT (TS00040) USERMODS .
  LIST  CDS SYSMOD (TS00040) .
  LIST ACDS SYSMOD (TS00040) .
/*
//SMPPTFIN  DD *
++ USERMOD (TS00040) .
++ VER (Z038) FMID (JBB1126) PRE (UZ34424)                        /*

  PROBLEM: THE MCS DEFAULTS PROVIDED BY IBM FOR MVS CONSOLE
           SUPPORT LEAVES THE CONSOLES IN WHAT COULD BE
           CALLED A "NO MODE" CONDITION AFTER AN IPL.  THIS
           ARCO MODIFICATION, PATTERNED AFTER THAT DEVELOPED BY
           IBM WORLD TRADE, WILL PLACE ALL FULL CAPABILITY
           CONSOLES IN 'ROLL DELETE' MODE AFTER AN IPL.

           THIS CHANGE WILL SUPPORT DEVICES WITH IEECDCM MACRO
           ENTRIES OF:

                        DEVICE=A - 3066
                        DEVICE=D - 3277 MODEL 2 AND 3036
                        DEVICE=F - 3278 MODEL 2, 3279 MODEL 2A,
                                   AND 3279 MODEL 2B
                        DEVICE=G - 3278 MODEL 3, 3279 MODEL 3A,
                                   AND 3279 MODEL 3B
                        DEVICE=H - 3278 MODEL 4
                        DEVICE=I - 3278 MODEL 2A


           THE CONSOLE SPECIFICATIONS AFTER IPL WILL NOW BECOME:

           1.   FOR 'DEVICE=A' (3066) -

                     DEL=RD,SEG=30,CON=N,RNUM=30,RTME=001

           2.   FOR 'DEVICE=D' (3277-2 AND 3036) -

                     DEL=RD,SEG=19,CON=N,RNUM=19,RTME=001

           3.   FOR 'DEVICE=F' (3278-2 AND 3279-2A/2B) -

                     DEL=RD,SEG=20,CON=N,RNUM=20,RTME=001

           4.   FOR 'DEVICE=G' (3278-3 AND 3279-3A/3B) -

                     DEL=RD,SEG=28,CON=N,RNUM=28,RTME=001

           5.   FOR 'DEVICE=H' (3278-4) -

                     DEL=RD,SEG=39,CON=N,RNUM=39,RTME=001

           6.   FOR 'DEVICE=I' (3278-2A) -

                     DEL=RD,SEG=16,CON=N,RNUM=16,RTME=001

                                                                  */ .
++ MACUPD (IEECDCM) DISTLIB (AMODGEN) .
./      CHANGE NAME=IEECDCM
&P       SETC  '1'                 DCMRTMED INITIAL VALUE       TS00040
&M       SETC  '19'                DCMSEGDF INITIAL VALUE       TS00040
&M       SETC  '20'                DEFAULT SEGMENT VALUE        TS00040
&P       SETC  '1'                 DEFAULT ROLL TIME VALUE      TS00040
&M       SETC  '16'                DEFAULT SEGMENT VALUE        TS00040
&P       SETC  '1'                 DEFAULT ROLL TIME VALUE      TS00040
&M       SETC  '28'                DEFAULT SEGMENT VALUE        TS00040
&P       SETC  '1'                 DEFAULT ROLL TIME VALUE      TS00040
&M       SETC  '39'                DEFAULT SEGMENT VALUE        TS00040
&P       SETC  '1'                 DEFAULT ROLL TIME VALUE      TS00040
&M       SETC  '30'                DCMSEGDF INITIAL VALUE       TS00040
&P       SETC  '1'                 DCMRTMED INITIAL VALUE       TS00040
++ ZAP (IEECVETC) DISTLIB (AOSC5) .
  NAME IGC0007B IEECVETC
  VER 00F8 92E8                    DEL1 = Y
  VER 00FC 9240                    DEL2 = BLANK
  VER 0106 92E8                    CON  = Y
  VER 010A 92E0                    DCMOPTST
  VER 0184 9610                    DCMIOCM2
  VER 0188 5810,4024,1211,4780
  VER 01B0 96E0,9122               DCMCMSG3
  VER 01B4 58F0,9134               EXIT ADDRESS
  REP 00F8 92D9                    DEL1 = R
  REP 00FC 92C4                    DEL2 = D
  REP 0106 92D5                    CON  = N
  REP 010A 9230                    DCMOPTST
  REP 0184 96F0                    DCMIOCM2
  REP 0188 9650,9018,0700,47F0
  REP 01B0 9680,912D               DCMCMSG3
  REP 01B4 58F0,918C               EXIT ADDRESS
  IDRDATA TS00040
  DUMP IGC0007B IEECVETC
/*
//TS00071  JOB 5208-7030,'M. H. HEMP LPK-4117',CLASS=Z,
//             NOTIFY=PTSMHH,MSGLEVEL=(1,1),MSGCLASS=Y
/*ROUTE  PRINT LOCAL
//TS00071 EXEC SMP4,SVOL=TARGET,A=Y
//SYSIN     DD *
  RECEIVE   SELECT (TS00071) .
  APPLY     SELECT (TS00071) .
  ACCEPT    SELECT (TS00071) USERMODS .
  LIST  CDS SYSMOD (TS00071) .
  LIST ACDS SYSMOD (TS00071) .
/*
//SMPPTFIN  DD *
++ USERMOD (TS00071) .
++ VER (Z038) FMID (JBB1126) PRE (UZ33932)                        /*

  DESCRIPTION:  THIS USERMOD ADDS THE CHANNEL UNIT ADDRESS OF THE
      CONSOLE FROM WHICH AN OPERATOR COMMAND HAS BEEN ENTERED PRIOR
      TO WRITING THE OPERATOR COMMAND BACK TO THE CONSOLE.  AS SUCH,
      IT WILL BE POSSIBLE TO DETERMINE WHICH CONSOLE HAS ENTERED A
      PARTICULAR COMMAND.

      THIS USERMOD INTERFACES INTO THE SVC35 ROUTINE OF IEECVET4.  THE
      BASE REGISTER FOR IEECVETC IS REGISTER 12 AND IS INITIALIZED WITH
      THE UN-RELOCATED VALUE OF X'02'.  REGISTER 8 POINTS TO THE UCM
      ENTRY FOR THE CONSOLE IN THE UCM.  THIS ENTRY ALSO CONTAINS THE
      ADDRESS OF THE ASSOCIATED UCB, FROM WHICH THE EBCDIC CUA ADDRESS
      IS OBTAINED.  REGISTER 11 POINTS TO THE TDCM, WHICH CONTAINS A
      WTO PARAMETER LIST.  THE VALUE OF THE PARAMETER LIST LENGTH IS
      INCREASED BY FOUR AND COMPARED WITH A MAXIMUM ALLOWABLE LENGTH
      OF X'80' OR 128.  IF ADDING FOUR CHARACTERS WILL EXCEED THIS
      MAXIMUM LENGTH, THE COMMAND IS WRITTEN BACK WITHOUT THE CHANNEL-
      UNIT ADDRESS.  IF THE FOUR CHARACTERS CAN BE ADDED, THE ORIGINAL
      COMMAND IS FIRST CHANGED TO UPPER CASE BY OR'ING IN BLANKS, THE
      PARAMETER LIST LENGTH (DCMINLGN) IS INCREMENTED BY FOUR, AND
      A BLANK AND THE CHANNEL UNIT ADDRESS ARE APPENDED TO THE COMMAND.
      THE MCS FLAGS AT THE END ARE ALSO OR'ED TO FORCE THE APPENDED
      MESSAGE TO HARDCOPY.

                                                                  */ .
++ ZAP (IEECVET4) DISTLIB (AOSC5) .
  NAME IEECVET4
  VER 035A 9204,B06F               *****************************
  VER 035E 4110,B06C               * THIS PART OF THE CODE AT  *
  VER 0362 1B00                    * LABEL SVC35 IN THE DIDOCS *
  VER 0364 4300,801A               * ROUTINE IEECVET4.         *
  VER 0368 0A23                    *****************************
  VER 06B0 5C5C,40C9               VERIFY BEGINNING OF PATCH AREA
  REP 035A 9200,B06F         MVI - MCS FLAGS, FORCE TO HARDCOPY
  REP 035E 47F0,C6AE         BR  - BRANCH TO PATCH AREA
  REP 06B0 4810,B06C         LH  - LOAD PARMLIST LENGTH (DCMINLGN)
  REP 06B4 4110,1004         LA  - INCREMENT PARMLIST LENGTH BY 4
  REP 06B8 1801              LR  - PUT NEW LENGTH IN REGISTER 0
  REP 06BA 4110,0080         LA  - LOAD MAXIMUM PARMLIST LENGTH (X'80')
  REP 06BE 1901              CR  - COMPARE REGISTERS 0 AND 1
  REP 06C0 4720,C704         BC  - BRANCH IF LENGTH GREATER THAN MAX
  REP 06C4 4110,B06C         LA  - ADDRESS OF WTO PARMLIST IN TDCM
  REP 06C8 4A10,B06C         AH  - ADD LENGTH OF WTO PARMLIST
  REP 06CC 9240,1000         MVI - ADD BLANK TO END OF MESSAGE
  REP 06D0 4000,B06C         STH - STORE NEW MESSAGE LENGTH
  REP 06D4 1802              LR  - SAVE REGISTER 2
  REP 06D6 5820,800C         L   - LOAD UCMUCB ADDRESS
  REP 06DA D202,1001,200D    MVC - MOVE UCBNAME TO MESSAGE
  REP 06E0 4110,B070         LA  - ADDRESS OF WTO MESSAGE (DCMINPUT)
  REP 06E4 4120,007C         LA  - MAXIMUM MESSAGE LENGTH (X'124')
  REP 06E8 9640,1000         OI  - CHANGE CHARACTER TO UPPER CASE
  REP 06EC 4110,1001         LA  - POINT TO NEXT CHARACTER
  REP 06F0 4620,C6E6         BCT - BRANCH TO CONTINUE OR'ING
  REP 06F4 4110,B06C         LA  - ADDRESS OF WTO PARMLIST IN TDCM
  REP 06F8 1820              LR  - RESTORE REGISTER 2
  REP 06FA 1B00              SR  - CLEAR REGISTER 0
  REP 06FC 4300,801A         IC  - INSERT UCMID
  REP 0700 0A23              SVC - WTO (SVC 35)
  REP 0702 47F0,C368         BC  - BRANCH TO SVC34
  REP 0706 4110,B06C         LA  - ADDRESS OF WTO PARMLIST IN TDCM
  REP 070A 47F0,C360         BC  - BRANCH TO SVC35, MESSAGE TOO LONG
  REP 070E 0000,0000               * ZERO OUT REMAINDER
  REP 0712 0000                    * OF PATCH AREA
  IDRDATA TS00071
  DUMP IEECVET4
/*

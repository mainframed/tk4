JUST     TITLE 'GENERAL ROUTINE TO RIGHT JUSTIFY CHARACTER STRING'
XACFJUST CSECT ,
         ACFREGS LINK=14          DEFINE REGISTER EQUATES
         SAVE  (14,12),T,*        SAVE REGISTERS
         USING XACFJUST,R15       SET CSECT ADDRESSABILITY
         LR    R2,R0              GET STARTING ADDRESS
         LTR   R3,R1              GET ORIGINAL LENGTH
         BZ    RETURN             IF ZERO LENGTH RETURN
JUSTLOOP EQU   *
         CLI   0(R2),C' '         Q. IS CHARACTER A BLANK
         BNE   JUSTMOVE           A. NO, GO MOVE DATA
         LA    R2,1(,R2)          INCREMENT ADDRESS
         BCT   R3,JUSTLOOP        DECREMENT COUNT AND BRANCH
JUSTMOVE EQU   *
         ICM   R3,B'1000',=C' '   INSERT PAD CHARACTER
         MVCL  R0,R2              LEFT JUSTIFY
RETURN   EQU   *
         RETURN (14,12),T         RETURN
         END

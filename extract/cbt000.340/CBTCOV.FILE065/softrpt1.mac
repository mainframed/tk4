000100 IDENTIFICATION DIVISION.
000200     SKIP1
000300 PROGRAM-ID.    SOFTRPT3.
000400     SKIP1
000500 AUTHOR.        FRANK G. BOLAN.
000600     SKIP1
000700 INSTALLATION.  SANTA FE INTERNATIONAL
000800                505 SOUTH MAIN STREET
000900                P.O. BOX 1401
001000                ORANGE, CALIFORNIA 92668
001100     SKIP1
001200 REMARKS.      ***************************************************
001300               *      THIS PROGRAM READS A DIALOG MANAGER TABLE  *
001400               * CREATES A EXTRACT FILE, SORTS AND RECREATES THE *
001500               * TABLE THEN PRODUCES A SOFTWARE REPORT.          *
001600               ***************************************************
001700     EJECT
001800 ENVIRONMENT DIVISION.
001900     SKIP1
002000 CONFIGURATION SECTION.
002100 SOURCE-COMPUTER.           IBM-370.
002200 OBJECT-COMPUTER.           IBM-370.
002300     SKIP1
002400 INPUT-OUTPUT SECTION.
002500     SKIP1
002600 FILE-CONTROL.
002700     SKIP1
002800     SELECT SOFT-RECS
002900        ASSIGN TO UT-S-RI.
003000     SELECT REPT-OUTPUT
003100        ASSIGN TO UT-S-RO.
003200     SELECT SORT-FILE
003300        ASSIGN TO UT-S-SORTWK01.
003400     EJECT
003500 DATA DIVISION.
003600     SKIP1
003700 FILE SECTION.
003800 FD  SOFT-RECS
003900     RECORDING MODE IS F
004000     LABEL RECORDS ARE STANDARD
004100     RECORD CONTAINS 266 CHARACTERS
004200     BLOCK CONTAINS 0 RECORDS
004300     DATA RECORDS ARE SOFT-RECORD.
004400     SKIP1
004500 01  SOFT-RECORD                  PIC X(266).
004600     EJECT
004700 FD  REPT-OUTPUT
004800     RECORDING MODE IS F
004900     LABEL RECORDS ARE STANDARD
005000     RECORD CONTAINS 133 CHARACTERS
005100     BLOCK CONTAINS 0 RECORDS
005200     DATA RECORDS ARE REPORT-RECORD.
005300     SKIP1
005400 01  REPORT-RECORD.
005500     05  PRINTCC                  PIC X(001).
005600     05  PRINTLINE                PIC X(132).
005700     EJECT
005800 SD  SORT-FILE
005900     RECORDING MODE IS F.
006000     SKIP1
006100 01  SORT-RECORD.
006110     05  CONTROL-FIELDS       PIC X(001).
006200     05  SORT-KEY1.
006300         10  CONTROL-FIELDS       PIC X(001).
006400         10  VEND-OUTS            PIC X(010).
006500         10  FMID-OUTS            PIC X(010).
006600     05  IDTE-OUTS            PIC X(008).
006700     05  VERS-OUTS            PIC X(010).
006800     05  SERI-OUTS            PIC X(010).
006900     05  DESC-OUTS            PIC X(040).
007000     05  FMID2-OUTS           PIC X(010).
007100     05  FMID3-OUTS           PIC X(010).
007200     05  FMID4-OUTS           PIC X(010).
007300     05  FMID5-OUTS           PIC X(010).
007400     05  FMID6-OUTS           PIC X(010).
007500     05  FMID7-OUTS           PIC X(010).
007600     05  FMID8-OUTS           PIC X(010).
007700     05  FMID9-OUTS           PIC X(010).
007800     05  PTFI-OUTS            PIC X(010).
007900     05  STAT-OUTS            PIC X(010).
008000     05  SORT-KEY2.
008100         10  CONT-OUTS        PIC X(015).
008200     05  BUDG-OUTS            PIC X(010).
008300     05  COST-OUTS            PIC X(010).
008400     05  PCST-OUTS            PIC X(010).
008410     05  VPHN-OUTS            PIC X(014).
008411     05  HPHN-OUTS            PIC X(014).
008420     05  WPHN-OUTS            PIC X(004).
008500     EJECT
008600 WORKING-STORAGE SECTION.
008700 01  VDEF-KEYS.
008800     10  VEND1V               PIC X(007) VALUE '(VEND1)'.
008900     10  FMID1V               PIC X(007) VALUE '(FMID1)'.
009000 01  VDEF-SCREEN.
009100     10  VENDV                PIC X(006) VALUE '(VEND)'.
009200     10  FMIDV                PIC X(006) VALUE '(FMID)'.
009300     10  IDTEV                PIC X(006) VALUE '(IDTE)'.
009400     10  VERSV                PIC X(006) VALUE '(VERS)'.
009500     10  SERIV                PIC X(006) VALUE '(SERI)'.
009600     10  DESCV                PIC X(006) VALUE '(DESC)'.
009700     10  FMID2V               PIC X(007) VALUE '(FMID2)'.
009800     10  FMID3V               PIC X(007) VALUE '(FMID3)'.
009900     10  FMID4V               PIC X(007) VALUE '(FMID4)'.
010000     10  FMID5V               PIC X(007) VALUE '(FMID5)'.
010100     10  FMID6V               PIC X(007) VALUE '(FMID6)'.
010200     10  FMID7V               PIC X(007) VALUE '(FMID7)'.
010300     10  FMID8V               PIC X(007) VALUE '(FMID8)'.
010400     10  FMID9V               PIC X(007) VALUE '(FMID9)'.
010500     10  PTFIV                PIC X(006) VALUE '(PTFI)'.
010600     10  STATV                PIC X(006) VALUE '(STAT)'.
010700     05  CONTV                PIC X(006) VALUE '(CONT)'.
010800     05  BUDGV                PIC X(006) VALUE '(BUDG)'.
010900     05  COSTV                PIC X(006) VALUE '(COST)'.
011000     05  PCSTV                PIC X(006) VALUE '(PCST)'.
011010     05  VPHNV                PIC X(006) VALUE '(VPHN)'.
011020     05  HPHNV                PIC X(006) VALUE '(HPHN)'.
011030     05  WPHNV                PIC X(006) VALUE '(WPHN)'.
011100 01  VCREATE-KEYS.
011200     10  VEND1C               PIC X(007) VALUE '(VEND1 '.
011300     10  FMID1C               PIC X(006) VALUE 'FMID1)'.
011400 01  VCREATE-VARS.
011500     10  VENDC                PIC X(006) VALUE '(VEND '.
011600     10  FMIDC                PIC X(005) VALUE 'FMID '.
011700     10  IDTEC                PIC X(005) VALUE 'IDTE '.
011800     10  VERSC                PIC X(005) VALUE 'VERS '.
011900     10  SERIC                PIC X(005) VALUE 'SERI '.
012000     10  DESCC                PIC X(005) VALUE 'DESC '.
012100     10  FMID2C               PIC X(006) VALUE 'FMID2 '.
012200     10  FMID3C               PIC X(006) VALUE 'FMID3 '.
012300     10  FMID4C               PIC X(006) VALUE 'FMID4 '.
012400     10  FMID5C               PIC X(006) VALUE 'FMID5 '.
012500     10  FMID6C               PIC X(006) VALUE 'FMID6 '.
012600     10  FMID7C               PIC X(006) VALUE 'FMID7 '.
012700     10  FMID8C               PIC X(006) VALUE 'FMID8 '.
012800     10  FMID9C               PIC X(006) VALUE 'FMID9 '.
012900     10  PTFIC                PIC X(005) VALUE 'PTFI '.
013000     10  STATC                PIC X(005) VALUE 'STAT '.
013100     05  CONTC                PIC X(005) VALUE 'CONT '.
013200     05  BUDGC                PIC X(005) VALUE 'BUDG '.
013300     05  COSTC                PIC X(005) VALUE 'COST '.
013400     05  PCSTC                PIC X(005) VALUE 'PCST '.
013410     05  VPHNC                PIC X(005) VALUE 'VPHN '.
013420     05  HPHNC                PIC X(005) VALUE 'HPHN '.
013430     05  WPHNC                PIC X(005) VALUE 'WPHN)'.
013500 01  VARS.
013600     10  VEND1                PIC X(010).
013700     10  FMID1                PIC X(010).
013800     10  VEND                 PIC X(010).
013900     10  FMID                 PIC X(010).
014000     10  FMID2                PIC X(010).
014100     10  FMID3                PIC X(010).
014200     10  FMID4                PIC X(010).
014300     10  FMID5                PIC X(010).
014400     10  FMID6                PIC X(010).
014500     10  FMID7                PIC X(010).
014600     10  FMID8                PIC X(010).
014700     10  FMID9                PIC X(010).
014800     10  PTFI                 PIC X(010).
014900     10  IDTE                 PIC X(008).
015000     10  VERS                 PIC X(010).
015100     10  SERI                 PIC X(010).
015200     10  DESC                 PIC X(040).
015300     10  STAT                 PIC X(010).
015400     05  CONT                 PIC X(015).
015500     05  BUDG                 PIC X(010).
015600     05  COST                 PIC X(010).
015700     05  PCST                 PIC X(010).
015710     05  VPHN                 PIC X(014).
015720     05  HPHN                 PIC X(014).
015730     05  WPHN                 PIC X(004).
015800     SKIP1
015900 01  SPF-KEYWORD-PARMS.
016000     10  LENG           PIC 9(09) COMP VALUE 6.
016100     10  CHAR           PIC X(05) VALUE 'CHAR '.
016200     10  PANEL          PIC X(08) VALUE SPACE.
016300     10  VMOVE          PIC X(05) VALUE 'MOVE '.
016400     10  VLOCATE        PIC X(07) VALUE 'LOCATE '.
016500     10  NUMB           PIC S9(08) COMP VALUE +1.
016600 01  SPF-FUNCTION-CALLS.
016700     10  VDEFINE        PIC X(08) VALUE 'VDEFINE '.
016800     10  VREPLACE       PIC X(09) VALUE 'VREPLACE '.
016900     10  VCOPY          PIC X(06) VALUE 'VCOPY '.
017000     10  VDISPLAY       PIC X(08) VALUE 'DISPLAY '.
017100     10  TBSKIP         PIC X(07) VALUE 'TBSKIP '.
017200     10  TBOPEN         PIC X(07) VALUE 'TBOPEN '.
017300     10  TBCLOSE        PIC X(08) VALUE 'TBCLOSE '.
017400     10  TBCREATE       PIC X(09) VALUE 'TBCREATE '.
017500     10  TBDISPL        PIC X(08) VALUE 'TBDISPL '.
017600     10  TBERASE        PIC X(08) VALUE 'TBERASE '.
017700     10  TBADD          PIC X(06) VALUE 'TBADD '.
017800     10  TBGET          PIC X(06) VALUE 'TBGET '.
017900     10  VGET           PIC X(05) VALUE 'VGET '.
018000 01  SPF-TABLES.
018100     10  SOFT           PIC X(05) VALUE 'SOFT '.
018200     SKIP1
018300 01  DETAIL-LINE.
018400     05  CC-CONTROL               PIC X(001) VALUE SPACE.
018500     05  DETAIL-DATA              PIC X(132).
018600     SKIP1
018700 01  SUB-HEADING-LINE.
018800     05  SH-CONTROL               PIC X(001) VALUE '0'.
018900     05  SH-DETAIL                PIC X(132).
019000     SKIP1
019100 01  SOFT-HEADING.
019200     05  FILLER                   PIC X(001) VALUE '1'.
019300     05  HEAD-DATE                PIC X(008) VALUE SPACES.
019400     05  FILLER                   PIC X(022) VALUE ' '.
019500     05  HEADING-DETAIL    PIC X(033) VALUE 'SOFTWARE REPORT'.
019600     05  FILLER                   PIC X(018) VALUE ' '.
019700     05  HEAD-TIME                PIC X(008).
019800     05  FILLER                   PIC X(027) VALUE ' '.
019900     05  FILLER                   PIC X(005) VALUE 'PAGE '.
020000     05  OUT-PAGE                 PIC Z,ZZ9.
020100 01  CNT-COUNTERS.
020200     05  REPORT-LINE-COUNT        PIC S9(004) VALUE ZERO.
020300 01  CON-CONSTANTS.
020400     05  CON-TRUE                 PIC X(001)  VALUE 'T'.
020500     05  CON-FALSE                PIC X(001)  VALUE 'F'.
020600     05  CON-EJECT                PIC X(001)  VALUE '1'.
020700     05  CON-SKIP1                PIC X(001)  VALUE ' '.
020800     05  CON-SKIP2                PIC X(001)  VALUE '0'.
020900     05  CON-IBM                  PIC X(001)  VALUE 'A'.
021000     05  CON-NON-IBM              PIC X(001)  VALUE 'B'.
021100     05  CON-SKIP3                PIC X(001)  VALUE '-'.
021200     05  PLUS-1                   PIC S99     VALUE +1.
021300     05  PLUS-2                   PIC S99     VALUE +2.
021400     05  PLUS-3                   PIC S99     VALUE +3.
021500     05  PAGE-LIMIT               PIC S99     VALUE +50.
021600     SKIP2
021700 01  SWT-SWITCHES.
021800     05  SWT-END-OF-INPUT         PIC X(001).
021900         88  END-OF-INPUT                     VALUE 'T'.
022000     05  SWT-END-OF-DATA          PIC X(001).
022100         88  END-OF-DATA                      VALUE 'T'.
022200 01  STA-STORAGE.
022300     05  PAGE-COUNT               PIC 9(003)  VALUE ZERO.
022400     05  CONT-WRK                 PIC X(015)  VALUE SPACES.
022500     05  TBL-KEY-WORK             PIC X(020)  VALUE SPACES.
022600     05  RTN-CODE                 PIC X(004)  VALUE SPACES.
022700     05  SOFT-SUB.
022800         10  FILLER               PIC X(001)  VALUE SPACES.
022900         10  FILLER               PIC X(011)  VALUE 'VENDOR ID  '.
023000         10  FILLER               PIC X(001)  VALUE SPACES.
023100         10  FILLER               PIC X(011)  VALUE 'PRODUCT #  '.
023200         10  FILLER               PIC X(001)  VALUE SPACES.
023300         10  FILLER               PIC X(011)  VALUE 'VERSION #  '.
023400         10  FILLER               PIC X(012)  VALUE SPACES.
023500         10  FILLER               PIC X(011)  VALUE 'DESCRIPTION'.
023600         10  FILLER               PIC X(019)  VALUE SPACES.
023700         10  FILLER               PIC X(011)  VALUE 'CONTACT    '.
023800         10  FILLER               PIC X(010)  VALUE SPACES.
023900         10  FILLER               PIC X(011)  VALUE 'STATUS     '.
024000         10  FILLER               PIC X(012)  VALUE SPACES.
024100     05  SOFT-SUB2.
024200         10  FILLER               PIC X(001)  VALUE SPACES.
024300         10  FILLER               PIC X(011)  VALUE ALL '='.
024400         10  FILLER               PIC X(001)  VALUE SPACES.
024500         10  FILLER               PIC X(011)  VALUE ALL '='.
024600         10  FILLER               PIC X(001)  VALUE SPACES.
024700         10  FILLER               PIC X(011)  VALUE ALL '='.
024800         10  FILLER               PIC X(001)  VALUE SPACES.
024900         10  FILLER               PIC X(040)  VALUE ALL '='.
025000         10  FILLER               PIC X(001)  VALUE SPACES.
025100         10  FILLER               PIC X(011)  VALUE ALL '='.
025200         10  FILLER               PIC X(010)  VALUE SPACES.
025300         10  FILLER               PIC X(011)  VALUE ALL '='.
025400         10  FILLER               PIC X(012)  VALUE SPACES.
025500     05  SOFT-DETAIL.
025600         10  FILLER               PIC X(002)  VALUE SPACES.
025700         10  VEND-OUT1            PIC X(010)  VALUE SPACES.
025800         10  FILLER               PIC X(002)  VALUE SPACES.
025900         10  FMID-OUT1            PIC X(010)  VALUE SPACES.
026000         10  FILLER               PIC X(002)  VALUE SPACES.
026100         10  VERS-OUT1            PIC X(010)  VALUE SPACES.
026200         10  FILLER               PIC X(002)  VALUE SPACES.
026300         10  DESC-OUT1            PIC X(040)  VALUE SPACES.
026400         10  FILLER               PIC X(002)  VALUE SPACES.
026500         10  CONT-OUT1            PIC X(015)  VALUE SPACES.
026600         10  FILLER               PIC X(005)  VALUE SPACES.
026700         10  STAT-OUT1            PIC X(010)  VALUE SPACES.
026800         10  FILLER               PIC X(012)  VALUE SPACES.
026900     SKIP2
027000 01  TDT-PROCESS-DATE.
027100     05  DATE-OF-RUN-YY           PIC 99.
027200     05  DATE-OF-RUN-MM           PIC 99.
027300     05  DATE-OF-RUN-DD           PIC 99.
027400 01  TDT-PROCESS-TIME.
027500     05  TIME-OF-RUN-HH           PIC 99.
027600     05  TIME-OF-RUN-MM           PIC 99.
027700     05  TIME-OF-RUN-SS           PIC 99.
027800     05  TIME-OF-RUN-TT           PIC 99.
027900 01  TDT-DATE-OF-RUN.
028000     05  DATE-OF-RUN-MM           PIC 99.
028100     05  FILLER                   PIC X(001) VALUE '/'.
028200     05  DATE-OF-RUN-DD           PIC 99.
028300     05  FILLER                   PIC X(001) VALUE '/'.
028400     05  DATE-OF-RUN-YY           PIC 99.
028500 01  TDT-TIME-OF-RUN.
028600     05  TIME-OF-RUN-HH           PIC 99.
028700     05  FILLER                   PIC X(001) VALUE ':'.
028800     05  TIME-OF-RUN-MM           PIC 99.
028900     05  FILLER                   PIC X(001) VALUE ':'.
029000     05  TIME-OF-RUN-SS           PIC 99.
029100 01  MAC-A-REC.
029200         10  CONTROL-FIELD        PIC X(001).
029300         10  TBL-KEY.
029400             15  VEND-OUT         PIC X(010).
029500             15  FMID-OUT         PIC X(010).
029600         10  IDTE-OUT             PIC X(008).
029700         10  VERS-OUT             PIC X(010).
029800         10  SERI-OUT             PIC X(010).
029900         10  DESC-OUT             PIC X(040).
030000         10  FMID2-OUT            PIC X(010).
030100         10  FMID3-OUT            PIC X(010).
030200         10  FMID4-OUT            PIC X(010).
030300         10  FMID5-OUT            PIC X(010).
030400         10  FMID6-OUT            PIC X(010).
030500         10  FMID7-OUT            PIC X(010).
030600         10  FMID8-OUT            PIC X(010).
030700         10  FMID9-OUT            PIC X(010).
030800         10  PTFI-OUT             PIC X(010).
030900         10  STAT-OUT             PIC X(010).
031000         10  CONT-OUT             PIC X(015).
031100         10  BUDG-OUT             PIC X(010).
031200         10  COST-OUT             PIC X(010).
031300         10  PCST-OUT             PIC X(010).
031310         10  VPHN-OUT             PIC X(014).
031320         10  HPHN-OUT             PIC X(014).
031330         10  WPHN-OUT             PIC X(004).
031400     EJECT
031500 PROCEDURE DIVISION.
031600     SKIP2
031700 1010-MAINLINE.
031800     SKIP1
031900     PERFORM 2010-HOUSEKEEPING
032000        THRU 2010-EXIT.
032100     CALL 'ISPLINK' USING TBOPEN SOFT.
032200     MOVE 10 TO LENG.
032300     CALL 'ISPLINK' USING VDEFINE VEND1V VEND1 CHAR LENG.
032400     MOVE 10 TO LENG.
032500     CALL 'ISPLINK' USING VDEFINE VENDV VEND CHAR LENG.
032600     MOVE 10 TO LENG.
032700     CALL 'ISPLINK' USING VDEFINE FMID1V FMID1 CHAR LENG.
032800     MOVE 10 TO LENG.
032900     CALL 'ISPLINK' USING VDEFINE FMID2V FMID2 CHAR LENG.
033000     MOVE 10 TO LENG.
033100     CALL 'ISPLINK' USING VDEFINE FMID3V FMID3 CHAR LENG.
033200     MOVE 10 TO LENG.
033300     CALL 'ISPLINK' USING VDEFINE FMID4V FMID4 CHAR LENG.
033400     MOVE 10 TO LENG.
033500     CALL 'ISPLINK' USING VDEFINE FMID5V FMID5 CHAR LENG.
033600     MOVE 10 TO LENG.
033700     CALL 'ISPLINK' USING VDEFINE FMID6V FMID6 CHAR LENG.
033800     MOVE 10 TO LENG.
033900     CALL 'ISPLINK' USING VDEFINE FMID7V FMID7 CHAR LENG.
034000     MOVE 10 TO LENG.
034100     CALL 'ISPLINK' USING VDEFINE FMID8V FMID8 CHAR LENG.
034200     MOVE 10 TO LENG.
034300     CALL 'ISPLINK' USING VDEFINE FMID9V FMID9 CHAR LENG.
034400     MOVE 10 TO LENG.
034500     CALL 'ISPLINK' USING VDEFINE PTFIV  PTFI  CHAR LENG.
034600     MOVE 10 TO LENG.
034700     CALL 'ISPLINK' USING VDEFINE FMIDV FMID CHAR LENG.
034800     MOVE 08 TO LENG.
034900     CALL 'ISPLINK' USING VDEFINE IDTEV IDTE CHAR LENG.
035000     MOVE 10 TO LENG.
035100     CALL 'ISPLINK' USING VDEFINE VERSV VERS CHAR LENG.
035200     MOVE 10 TO LENG.
035300     CALL 'ISPLINK' USING VDEFINE SERIV SERI CHAR LENG.
035400     MOVE 40 TO LENG.
035500     CALL 'ISPLINK' USING VDEFINE DESCV DESC CHAR LENG.
035600     MOVE 10 TO LENG.
035700     CALL 'ISPLINK' USING VDEFINE STATV STAT CHAR LENG.
035800     MOVE 15 TO LENG.
035900     CALL 'ISPLINK' USING VDEFINE CONTV CONT CHAR LENG.
036000     MOVE 10 TO LENG.
036100     CALL 'ISPLINK' USING VDEFINE BUDGV BUDG CHAR LENG.
036200     MOVE 10 TO LENG.
036300     CALL 'ISPLINK' USING VDEFINE COSTV COST CHAR LENG.
036400     MOVE 10 TO LENG.
036500     CALL 'ISPLINK' USING VDEFINE PCSTV PCST CHAR LENG.
036510     MOVE 14 TO LENG.
036520     CALL 'ISPLINK' USING VDEFINE VPHNV VPHN CHAR LENG.
036530     MOVE 14 TO LENG.
036540     CALL 'ISPLINK' USING VDEFINE HPHNV HPHN CHAR LENG.
036550     MOVE 4 TO LENG.
036560     CALL 'ISPLINK' USING VDEFINE WPHNV WPHN CHAR LENG.
036600     SKIP1
036700     OPEN OUTPUT SOFT-RECS.
036800     MOVE CON-FALSE TO SWT-END-OF-DATA.
036900     PERFORM 2011-READ-RECORD
037000        UNTIL END-OF-DATA.
037100     CALL 'ISPLINK' USING TBCLOSE SOFT.
037200     CALL 'ISPLINK' USING TBERASE SOFT.
037201     MOVE RETURN-CODE TO RTN-CODE.
037300     CLOSE SOFT-RECS.
037400     PERFORM 2012-SORT.
037500     CALL 'ISPLINK' USING TBCREATE SOFT VCREATE-KEYS VCREATE-VARS.
037700     MOVE CON-FALSE TO SWT-END-OF-INPUT.
037800     MOVE CON-FALSE TO SWT-END-OF-DATA.
037900     OPEN INPUT SOFT-RECS.
038000     PERFORM 2014-RECREATE
038100        UNTIL END-OF-DATA.
038200     CALL 'ISPLINK' USING TBCLOSE SOFT.
038300     CLOSE SOFT-RECS.
038400     MOVE CON-FALSE TO SWT-END-OF-INPUT.
038500     OPEN INPUT SOFT-RECS.
038600     PERFORM 3010-READ-RECORD
038700        UNTIL END-OF-INPUT.
038800     CLOSE SOFT-RECS.
038900     PERFORM 2015-SORT.
039000     OPEN INPUT SOFT-RECS.
039100     MOVE CON-FALSE TO SWT-END-OF-INPUT.
039200     ON 1 ADD 70 TO REPORT-LINE-COUNT.
039300     MOVE 0 TO PAGE-COUNT.
039400     PERFORM 301X-READ-RECORD
039500        UNTIL END-OF-INPUT.
039600     SKIP1
039700     PERFORM 4010-CLOSE-ALL-FILES
039800        THRU 4010-EXIT.
039900     GOBACK.
040000     SKIP2
040100 1010-EXIT.
040200     EJECT
040300 2010-HOUSEKEEPING.
040400     SKIP2
040500     ACCEPT TDT-PROCESS-DATE FROM DATE.
040600     ACCEPT TDT-PROCESS-TIME FROM TIME.
040700     MOVE CORRESPONDING TDT-PROCESS-DATE TO TDT-DATE-OF-RUN.
040800     MOVE CORRESPONDING TDT-PROCESS-TIME TO TDT-TIME-OF-RUN.
040900     MOVE TDT-DATE-OF-RUN TO HEAD-DATE.
041000     MOVE TDT-TIME-OF-RUN TO HEAD-TIME.
041100     MOVE SPACES TO SH-DETAIL.
041200     OPEN OUTPUT REPT-OUTPUT.
041300     SKIP2
041400 2010-EXIT.
041500     EJECT
041600 2011-READ-RECORD.
041700     MOVE ZERO TO RETURN-CODE.
041800     CALL 'ISPLINK' USING TBSKIP SOFT.
041900     IF RETURN-CODE GREATER THAN 0 THEN
042000      MOVE CON-TRUE TO SWT-END-OF-DATA.
042100     IF NOT END-OF-DATA
042200      THEN
042300       MOVE VEND   TO VEND-OUT
042400       MOVE FMID   TO FMID-OUT
042500       MOVE IDTE   TO IDTE-OUT
042600       MOVE VERS   TO VERS-OUT
042700       MOVE SERI   TO SERI-OUT
042800       MOVE DESC   TO DESC-OUT
042900       MOVE FMID2  TO FMID2-OUT
043000       MOVE FMID3  TO FMID2-OUT
043100       MOVE FMID4  TO FMID2-OUT
043200       MOVE FMID5  TO FMID2-OUT
043300       MOVE FMID6  TO FMID2-OUT
043400       MOVE FMID7  TO FMID2-OUT
043500       MOVE FMID8  TO FMID2-OUT
043600       MOVE FMID9  TO FMID2-OUT
043700       MOVE PTFI   TO PTFI-OUT
043800       MOVE STAT   TO STAT-OUT
043900       MOVE CONT   TO CONT-OUT
044000       MOVE BUDG   TO BUDG-OUT
044100       MOVE COST   TO COST-OUT
044200       MOVE PCST   TO PCST-OUT
044210       MOVE VPHN   TO VPHN-OUT
044220       MOVE HPHN   TO HPHN-OUT
044230       MOVE WPHN   TO WPHN-OUT.
044300     IF NOT END-OF-DATA
044400       THEN
044500       IF VEND NOT EQUAL 'IBM       '
044600         THEN
044700          MOVE CON-NON-IBM TO CONTROL-FIELD.
044800     IF NOT END-OF-DATA
044900       THEN
045000       IF VEND EQUAL 'IBM       '
045100         THEN
045200          MOVE CON-IBM TO CONTROL-FIELD.
045300     IF NOT END-OF-DATA
045400       PERFORM 2013-WRITE-REC THRU 2013-EXIT.
045500 2012-SORT.
045600     SKIP2
045700     SORT SORT-FILE ON ASCENDING KEY SORT-KEY1
045800      USING SOFT-RECS GIVING SOFT-RECS.
045900 2012-EXIT.
046000     EJECT
046100 2013-WRITE-REC.
046200     SKIP2
046300     WRITE SOFT-RECORD FROM MAC-A-REC.
046400 2013-EXIT.
046500     EJECT
046600 2014-RECREATE.
046700     READ SOFT-RECS INTO MAC-A-REC
046800        AT END
046900          MOVE CON-TRUE TO SWT-END-OF-DATA.
047000     IF NOT END-OF-DATA
047100     THEN
047200       MOVE VEND-OUT   TO VEND1
047300       MOVE FMID-OUT   TO FMID1
047400       MOVE VEND-OUT   TO VEND
047500       MOVE FMID-OUT   TO FMID
047600       MOVE IDTE-OUT   TO IDTE
047700       MOVE VERS-OUT   TO VERS
047800       MOVE SERI-OUT   TO SERI
047900       MOVE DESC-OUT   TO DESC
048000       MOVE FMID2-OUT  TO FMID2
048100       MOVE FMID3-OUT  TO FMID2
048200       MOVE FMID4-OUT  TO FMID2
048300       MOVE FMID5-OUT  TO FMID2
048400       MOVE FMID6-OUT  TO FMID2
048500       MOVE FMID7-OUT  TO FMID2
048600       MOVE FMID8-OUT  TO FMID2
048700       MOVE FMID9-OUT  TO FMID2
048800       MOVE PTFI-OUT   TO PTFI
048900       MOVE STAT-OUT   TO STAT
049000       MOVE CONT-OUT   TO CONT
049100       MOVE COST-OUT   TO COST
049200       MOVE BUDG-OUT   TO BUDG
049300       MOVE PCST-OUT   TO PCST.
049400     IF NOT END-OF-DATA
049500     THEN
049600       IF TBL-KEY NOT EQUAL TBL-KEY-WORK
049700         THEN
049800          MOVE TBL-KEY TO TBL-KEY-WORK
049900          MOVE ZERO TO RETURN-CODE
050000          CALL 'ISPLINK' USING TBADD SOFT.
050100 2014-EXIT.
050200     EXIT.
050300 2015-SORT.
050400     SKIP2
050500     SORT SORT-FILE ON ASCENDING KEY SORT-KEY2
050600      USING SOFT-RECS GIVING SOFT-RECS.
050700 2015-EXIT.
050800     EXIT.
050900 3010-READ-RECORD.
051000     SKIP2
051100     READ SOFT-RECS INTO MAC-A-REC
051200        AT END
051300           MOVE CON-TRUE TO SWT-END-OF-INPUT.
051400     IF NOT END-OF-INPUT
051500        THEN
051600         IF STAT-OUT NOT EQUAL 'BUGDETED '
051700            THEN
051800             IF STAT-OUT NOT EQUAL 'CANCEL   '
051900               THEN
052000        PERFORM 3011-PRINT-THE-REPORT
052100           THRU 3011-EXIT.
052200     SKIP2
052300 3010-EXIT.
052400     EJECT
052500 301X-READ-RECORD.
052600     SKIP2
052700     READ SOFT-RECS INTO MAC-A-REC
052800        AT END
052900           MOVE CON-TRUE TO SWT-END-OF-INPUT.
053000     IF NOT END-OF-INPUT
053100        THEN
053200        IF CONT-OUT NOT EQUAL CONT-WRK
053300          THEN
053400           MOVE CONT-OUT TO CONT-WRK
053500           ADD 70 TO REPORT-LINE-COUNT.
053600     IF NOT END-OF-INPUT
053700        THEN
053800        PERFORM 3011-PRINT-THE-REPORT
053900           THRU 3011-EXIT.
054000     SKIP2
054100 301X-EXIT.
054200     EJECT
054300 3011-PRINT-THE-REPORT.
054400     SKIP2
054500     MOVE VEND-OUT TO VEND-OUT1.
054600     MOVE FMID-OUT TO FMID-OUT1.
054700     MOVE VERS-OUT TO VERS-OUT1.
054800     MOVE DESC-OUT TO DESC-OUT1.
054900     MOVE CONT-OUT TO CONT-OUT1.
055000     MOVE STAT-OUT TO STAT-OUT1.
055100     MOVE SOFT-SUB TO SH-DETAIL.
055200     MOVE SOFT-DETAIL TO DETAIL-LINE.
055300     ON 1 ADD 70 TO REPORT-LINE-COUNT.
055400     ADD 1 TO REPORT-LINE-COUNT.
055500     IF REPORT-LINE-COUNT GREATER THAN PAGE-LIMIT
055600        THEN
055700        MOVE ZERO TO REPORT-LINE-COUNT
055800        PERFORM 3012-SOFT-HEADER THRU 3012-EXIT.
055900     WRITE REPORT-RECORD FROM DETAIL-LINE.
056000     MOVE SPACES TO DETAIL-LINE.
056100 3011-EXIT.
056200     EJECT
056300 3012-SOFT-HEADER.
056400     SKIP2
056500     ADD 1 TO PAGE-COUNT.
056600     MOVE PAGE-COUNT TO OUT-PAGE.
056700     WRITE REPORT-RECORD FROM SOFT-HEADING.
056800     WRITE REPORT-RECORD FROM SUB-HEADING-LINE.
056900     MOVE SOFT-SUB2 TO SH-DETAIL.
057000     WRITE REPORT-RECORD FROM SUB-HEADING-LINE.
057100 3012-EXIT.
057200     EJECT
057300 4010-CLOSE-ALL-FILES.
057400     SKIP2
057500     CLOSE SOFT-RECS
057600           REPT-OUTPUT.
057700     SKIP2
057800 4010-EXIT.
057900     EJECT

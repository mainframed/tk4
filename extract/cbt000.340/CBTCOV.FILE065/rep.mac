REP      TITLE 'CHARACTER SUBSTITUTION  SUBROUTINE'
*   THIS PROGRAM IS A FORTRAN OR COBOL CALLABLE SUBROUTINE WHICH
* SEARCHES THROUGH A WORD IW AND REPLACES ALL OCCURRENCES OF A
* SPECIFIED 8 BIT BYTE CHARACTER OF IP1 WITH A NEW CHARACTER GIVEN
* IN IP2. THE ENTRY POINTS AND ARGUMENTS ARE:
*                 CALL REP(IW,IP1,IP2)
*                 CALL REP USING IW IP1 IP2.
* WHERE: IW - A 32 BIT WORD CONTAINING CHARACTERS WHICH ARE TO BE
*             REPLACED. BLANK FILL THE WORD IF THERE ARE LESS THAN
*             4 DISPLAY CHARACTERS.
*        IP1 - WORD WHOSE 1ST BYTE CONTAINS THE CHARACTER (OR ITS
*              REPRESENTATION) TO BE REPLACED. I.E. IT MUST BE LEFT
*              JUSTFIED.
*        IP2 - WORD WHOSE 1ST BYTE CONTAINS THE REPRESENTATION OF THE
*              REPLACEMENT CHARACTER. I.E. IT MUST BE LEFT JUSTIFIED.
*
* NOTE: WHEN A WORD DOES NOT CONTAIN THE TO BE REPLACED CHARACTER, NO
* REPLACEMENT WILL TAKE PLACE.
*
REP      ENTER PARMREG=2,          SAVE REGISTERS AND INITIALIZE       X
               GETMAIN=(WORKSIZE,0)
         REGISTER                  REGISTER EQUATES
         USING WORKAREA,R13
         LM    R4,R6,0(R2)
         MVC   CALLIST,CCALLST
         LOAD  EP=REPBYT
         LR    R15,R0
         CALL  (15),                                                   X
               ((R4),FOUR,(R5),                                        X
               (R6)),                                                  X
               MF=(E,CALLIST)
         LEAVE RETCODE=(15),                                           X
               GETMAIN=(WORKSIZE,0)
FOUR     DC    F'4'
CCALLST  CALL  ,(0,0,0,0),MF=L
CCALLEN  EQU   *-CCALLST
WORKAREA DSECT ,
         DS    18A
CALLIST  DS    CL(CCALLEN)
REPBYT   DS    F
WORKSIZE EQU   *-WORKAREA
         END

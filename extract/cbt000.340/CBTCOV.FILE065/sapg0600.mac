SAPG0600 START 0
         DS    0H
         STM   14,12,12(13)
         BALR  3,0
         USING *,3,4
START    L     4,BASEADDR
         B     EXEC
BASEADDR DC    A(START+4096)
EXEC     ST    13,SAVE+4
         LA    13,SAVE
         REGISTER     EQATES AND USAGE
         TIME
         ST    R1,ANS
         SP    ANS,=P'7'
         UNPK  DOUBLE,ANS
         OI    DOUBLE+7,X'F0'
         MVC   DATE,DOUBLE+2
*
*       DELETE OLD RECORDS
*
         OPEN  (INFILE1,,OUTFILE,OUTPUT)
READ1    GET   INFILE1,INREC1
         CLC   INREC1(6),DATE
         BE    READ1
         MVC   OUTREC,INREC1
         PUT   OUTFILE,OUTREC
         B     READ1
EOFRT1   CLOSE (INFILE1)
         OPEN  (INFILE2)
READ2    GET   INFILE2,INREC2
         MVC   OUTREC,INREC2
         PUT   OUTFILE,OUTREC
         B     READ2
EOFRT2   MVC   OUTREC,=34C'9'
         PUT   OUTFILE,OUTREC
         CLOSE (INFILE2,,OUTFILE)             CLOSE OUTPUT FILE
         SR    R15,R15
         IC    R15,RETCD
         L     R13,SAVE+4
         RETURN (14,12),RC=(15)
         EJECT
*
         LTORG
INFILE1  DCB   DDNAME=TABIN,DSORG=PS,MACRF=GM,LRECL=80,EODAD=EOFRT1
INFILE2  DCB   DDNAME=TABIN2,DSORG=PS,MACRF=GM,LRECL=80,EODAD=EOFRT2
OUTFILE  DCB   DDNAME=OUTFILE,DSORG=PS,MACRF=PM,LRECL=80
*
DOUBLE   DS    D
ANS      DS    F
*
DATE     DS    CL6
*
RETCD    DC    X'0'
         DC    X'0'
*
INREC1   DS    CL80
*
INREC2   DS    CL80
*
OUTREC   DS    CL80
*
SAVE     DS    18F                   SAVE AREA
*
         END   SAPG0600

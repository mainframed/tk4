000100 IDENTIFICATION DIVISION.
000200     SKIP1
000300 PROGRAM-ID.    SLSSRPT1.
000400     SKIP1
000500 AUTHOR.        FRANK G. BOLAN.
000600     SKIP1
000700 INSTALLATION.  SANTA FE INTERNATIONAL
000800                505 SOUTH MAIN STREET
000900                P.O. BOX 1401
001000                ORANGE, CALIFORNIA 92668
001100                (714) 558-1300.
001200     SKIP1
001300     EJECT
001400 ENVIRONMENT DIVISION.
001500     SKIP1
001600 CONFIGURATION SECTION.
001700 SOURCE-COMPUTER.           IBM-370.
001800 OBJECT-COMPUTER.           IBM-370.
001900     SKIP1
002000 INPUT-OUTPUT SECTION.
002100 FILE-CONTROL.
002200     SELECT RI ASSIGN TO UT-S-RI.
002300     SELECT SORT-FILE ASSIGN TO UT-S-SORTWK01.
002400     SELECT RO ASSIGN TO UT-S-RO.
002500     SELECT RN ASSIGN TO UT-S-RN.
002600 DATA DIVISION.
002700 FILE SECTION.
002800 FD  RO
002900     RECORDING MODE IS F
003000     LABEL RECORDS ARE STANDARD
003100     RECORD CONTAINS 133 CHARACTERS
003200     BLOCK CONTAINS 0 RECORDS
003300     DATA RECORD IS REPORT-REC.
003400 01  REPORT-REC                   PIC X(133).
003500 FD  RN
003600     RECORDING MODE IS F
003700     LABEL RECORDS ARE STANDARD
003800     RECORD CONTAINS 133 CHARACTERS
003900     BLOCK CONTAINS 0 RECORDS
004000     DATA RECORD IS REPORT-REC.
004100 01  REPORT-REC2                  PIC X(133).
004200 FD  RI
004300     RECORDING MODE IS F
004400     LABEL RECORDS ARE STANDARD
004500     RECORD CONTAINS 299 CHARACTERS
004600     BLOCK CONTAINS 0 RECORDS
004700     DATA RECORD IS REPORT-RECORD.
004800 01  REPORT-RECORD                PIC X(299).
004900 SD  SORT-FILE
005000     RECORDING MODE IS F.
005100 01  SORT-RECORD.
005200     10  SORT-KEY1.
005300         15  CONTS                    PIC X(001).
005400     10  SORT-KEY2.
005500             20  MACS                 PIC X(009).
005600             20  INIS             PICTURE X(005).
005700     10  TITS        PICTURE X(045).
005800     10  SUBS        PICTURE X(090).
005900     10  REFS        PICTURE X(045).
006000     10  VENDS       PICTURE X(010).
006100     10  DASHS       PICTURE X(004).
006200     10  LDTES       PICTURE X(008).
006300     10  CKBYS       PICTURE X(004).
006400     10  TNLS        PICTURE X(015).
006500     10  TDTES       PICTURE X(008).
006600     10  CDES        PICTURE X(050).
006700     10  CPIS        PICTURE X(005).
006800 WORKING-STORAGE SECTION.
006900 01  VDEF-KEYS.
007000     10  MAC1V       PICTURE X(006) VALUE '(MAC1)'.
007100     10  INI1V       PICTURE X(006) VALUE '(INI1)'.
007200 01  VDEF-SCREEN.
007300     10  MACV        PICTURE X(005) VALUE '(MAC)'.
007400     10  INIV        PICTURE X(005) VALUE '(INI)'.
007500     10  TITV        PICTURE X(005) VALUE '(TIT)'.
007600     10  SUBV        PICTURE X(005) VALUE '(SUB)'.
007700     10  REFV        PICTURE X(005) VALUE '(REF)'.
007800     10  VENDV       PICTURE X(006) VALUE '(VEND)'.
007900     10  DASHV       PICTURE X(006) VALUE '(DASH)'.
008000     10  LDTEV       PICTURE X(006) VALUE '(LDTE)'.
008100     10  CKBYV       PICTURE X(006) VALUE '(CKBY)'.
008200     10  TNLV        PICTURE X(005) VALUE '(TNL)'.
008300     10  TDTEV       PICTURE X(006) VALUE '(TDTE)'.
008400     10  CDEV        PICTURE X(005) VALUE '(CDE)'.
008500     10  CPIV        PICTURE X(005) VALUE '(CPI)'.
008600 01  VCREATE-KEYS.
008700     10  MAC1C       PICTURE X(006) VALUE '(MAC1 '.
008800     10  INI1C       PICTURE X(005) VALUE 'INI1)'.
008900 01  VCREATE-VARS.
009000     10  MACC        PICTURE X(005) VALUE '(MAC '.
009100     10  INIC        PICTURE X(004) VALUE 'INI '.
009200     10  TITC        PICTURE X(004) VALUE 'TIT '.
009300     10  SUBC        PICTURE X(004) VALUE 'SUB '.
009400     10  REFC        PICTURE X(004) VALUE 'REF '.
009500     10  VENDC       PICTURE X(005) VALUE 'VEND '.
009600     10  DASHC       PICTURE X(005) VALUE 'DASH '.
009700     10  LDTEC       PICTURE X(005) VALUE 'LDTE '.
009800     10  CKBYC       PICTURE X(005) VALUE 'CKBY '.
009900     10  TNLC        PICTURE X(004) VALUE 'TNL '.
010000     10  TDTEC       PICTURE X(005) VALUE 'TDTE '.
010100     10  CDEC        PICTURE X(004) VALUE 'CDE '.
010200     10  CPIC        PICTURE X(005) VALUE 'CPI)'.
010300 01  VARS.
010400     10  MAC1        PICTURE X(009).
010500     10  INI1        PICTURE X(005).
010600     10  MAC         PICTURE X(009).
010700     10  INI         PICTURE X(005).
010800     10  TIT         PICTURE X(045).
010900     10  SUB         PICTURE X(090).
011000     10  REF         PICTURE X(045).
011100     10  VEND        PICTURE X(010).
011200     10  DASH        PICTURE X(004).
011300     10  LDTE        PICTURE X(008).
011400     10  CKBY        PICTURE X(004).
011500     10  TNL         PICTURE X(015).
011600     10  TDTE        PICTURE X(008).
011700     10  CDE         PICTURE X(050).
011800     10  CPI         PICTURE X(005).
011900 01  SPF-KEYWORD-PARMS.
012000     10  LENG           PIC 9(09) COMP VALUE 6.
012100     10  CHAR           PIC X(05) VALUE 'CHAR '.
012200     10  PANEL          PIC X(08) VALUE SPACE.
012300     10  VMOVE          PIC X(05) VALUE 'MOVE '.
012400     10  VLOCATE        PIC X(07) VALUE 'LOCATE '.
012500     10  NUMB           PIC S9(08) COMP VALUE +1.
012600 01  SPF-FUNCTION-CALLS.
012700     10  VDEFINE        PIC X(08) VALUE 'VDEFINE '.
012800     10  VREPLACE       PIC X(09) VALUE 'VREPLACE '.
012900     10  VCOPY          PIC X(06) VALUE 'VCOPY '.
013000     10  VDISPLAY       PIC X(08) VALUE 'DISPLAY '.
013100     10  TBSKIP         PIC X(07) VALUE 'TBSKIP '.
013200     10  TBOPEN         PIC X(07) VALUE 'TBOPEN '.
013300     10  TBCLOSE        PIC X(08) VALUE 'TBCLOSE '.
013400     10  TBCREATE       PIC X(09) VALUE 'TBCREATE '.
013500     10  TBDISPL        PIC X(08) VALUE 'TBDISPL '.
013600     10  TBERASE        PIC X(08) VALUE 'TBERASE '.
013700     10  TBADD          PIC X(06) VALUE 'TBADD '.
013800     10  TBGET          PIC X(06) VALUE 'TBGET '.
013900     10  VGET           PIC X(05) VALUE 'VGET '.
014000 01  SPF-TABLES.
014100     10  SLSS           PIC X(05) VALUE 'SLSS '.
014200     SKIP1
014300 01  DETAIL-LINE.
014400     05  CC-CONTROL               PIC X(001) VALUE SPACE.
014500     05  DETAIL-DATA              PIC X(132).
014600     SKIP1
014700 01  SUB-HEADING-LINE.
014800     05  SH-CONTROL               PIC X(001) VALUE '0'.
014900     05  SH-DETAIL                PIC X(132).
015000     SKIP1
015100 01  HEADING-LINE.
015200     05  FILLER                   PIC X(001) VALUE '1'.
015300     05  HEAD-DATE                PIC X(008) VALUE SPACES.
015400     05  FILLER                   PIC X(022) VALUE ' '.
015500     05  HEADING-DETAIL           PIC X(033) VALUE 'SLSS REPORT'.
015600     05  FILLER                   PIC X(018) VALUE ' '.
015700     05  HEAD-TIME                PIC X(008).
015800     05  FILLER                   PIC X(027) VALUE ' '.
015900     05  FILLER                   PIC X(005) VALUE 'PAGE '.
016000     05  OUT-PAGE                 PIC Z,ZZ9.
016100     EJECT
016200 01  NON-IBM-HEADING.
016300     05  FILLER                   PIC X(001) VALUE '1'.
016400     05  HEAD2-DATE               PIC X(008) VALUE SPACES.
016500     05  FILLER                   PIC X(022) VALUE ' '.
016600     05  HEAD2-DETAIL             PIC X(033) VALUE 'SLSS REPORT'.
016700     05  FILLER                   PIC X(018) VALUE ' NON-IBM '.
016800     05  HEAD2-TIME               PIC X(008).
016900     05  FILLER                   PIC X(027) VALUE ' '.
017000     05  FILLER                   PIC X(005) VALUE 'PAGE '.
017100     05  OUT-PAGE2                PIC Z,ZZ9.
017200     EJECT
017300 01  CNT-COUNTERS.
017400     05  REPORT-LINE-COUNT        PIC S9(004) VALUE ZERO.
017500     05  REPORT-LINE-COUNT2       PIC S9(004) VALUE ZERO.
017600 01  CON-CONSTANTS.
017700     05  PLUS-3                   PIC S99     VALUE +3.
017800     05  CON-SUB-CODES            PIC X       VALUE 'A'.
017900     05  CON-PROCESSOR            PIC X       VALUE 'B'.
018000     05  CON-MACH-PGM             PIC X       VALUE 'C'.
018100     05  CON-MACH-SER             PIC X       VALUE 'D'.
018200     05  CON-MANUALS              PIC X       VALUE 'E'.
018300     05  CON-NON-IBM              PIC X       VALUE 'F'.
018400     05  CON-TRUE                 PIC X(001)  VALUE 'T'.
018500     05  CON-FALSE                PIC X(001)  VALUE 'F'.
018600     05  CON-EJECT                PIC X(001)  VALUE '1'.
018700     05  CON-SKIP1                PIC X(001)  VALUE ' '.
018800     05  CON-SKIP2                PIC X(001)  VALUE '0'.
018900     05  CON-SKIP3                PIC X(001)  VALUE '-'.
019000     05  PLUS-1                   PIC S99     VALUE +1.
019100     05  PLUS-2                   PIC S99     VALUE +2.
019200     05  PLUS-3                   PIC S99     VALUE +3.
019300     05  LINE1-INDEX-LIMIT        PIC S99     VALUE +0.
019400     05  LINE2-INDEX-LIMIT        PIC S99     VALUE +0.
019500     05  PAGE-LIMIT               PIC S99     VALUE +55.
019600     SKIP2
019700 01  SWT-SWITCHES.
019800     05  SWT-END-OF-INPUT         PIC X(001).
019900         88  END-OF-INPUT                     VALUE 'T'.
020000     05  SWT-LINE-MAX             PIC X(001).
020100         88  LINE-MAX                         VALUE 'T'.
020200     05  SWT-LINE2-MAX            PIC X(001).
020300         88  LINE2-MAX                        VALUE 'T'.
020400     05  SWT-FIRST-TIME           PIC X(001).
020500         88  FIRST-TIME                       VALUE 'T'.
020600     05  SWT-INDEX-CLEARED        PIC X(001).
020700         88  INDEX-CLEARED                    VALUE 'T'.
020800     02  SWT-END-OF-DATA          PIC X(001).
020900         88  END-OF-DATA  VALUE   'T'.
021000 01  STA-STORAGE.
021100     05  TBL-KEY-WORK             PIC X(014) VALUE SPACES.
021200     05  RTRN-CODE                PIC 9(004).
021300     05  PAGE-COUNT               PIC 9(003)  VALUE ZERO.
021400     05  PAGE-COUNT2              PIC 9(003)  VALUE ZERO.
021500     05  MAC-TYPE-1               PIC X(009)  VALUE SPACES.
021600     05  MAC-TYPE-2.
021700         10  MAC-FMID             PIC X(004)  VALUE SPACES.
021800         10  FILLER               PIC X(001)  VALUE '/'.
021900         10  MAC-SERIAL           PIC X(006)  VALUE SPACES.
022000         10  FILLER               PIC X(001)  VALUE '-'.
022100         10  MAC-TPE              PIC X(004)  VALUE SPACES.
022200     05  STA-DETAIL-1.
022300         10  FILLER               PIC X(001)  VALUE ' '.
022400         10  FILLER               PIC X(001)  VALUE SPACES.
022500         10  FILLER               PIC X(008)  VALUE 'SUBJECT '.
022600         10  FILLER               PIC X(007)  VALUE 'CODES: '.
022700         10  SUBO-OUT             PIC X(090)  VALUE SPACES.
022800     05  STA-DETAIL-2.
022900         10  FILLER               PIC X(001)  VALUE ' '.
023000         10  FILLER               PIC X(001)  VALUE SPACES.
023100         10  FILLER               PIC X(010)  VALUE 'SUPPORTED '.
023200         10  FILLER               PIC X(010)  VALUE 'PROCESSORS'.
023300         10  FILLER               PIC X(002)  VALUE ': '.
023400         10  PROCESSOR-OUT        PIC X(010)  VALUE SPACES.
023500         10  FILLER               PIC X(090)  VALUE SPACES.
023600     05  STA-DETAIL-3.
023700         10  FILLER               PIC X(002)  VALUE SPACES.
023800         10  MAC-PGM-1            PIC X(009)  VALUE SPACES.
023900         10  FILLER               PIC X(002)  VALUE SPACES.
024000         10  MAC-PGM-2            PIC X(009)  VALUE SPACES.
024100         10  FILLER               PIC X(002)  VALUE SPACES.
024200         10  MAC-PGM-3            PIC X(009)  VALUE SPACES.
024300         10  FILLER               PIC X(002)  VALUE SPACES.
024400         10  MAC-PGM-4            PIC X(009)  VALUE SPACES.
024500         10  FILLER               PIC X(002)  VALUE SPACES.
024600         10  MAC-PGM-5            PIC X(009)  VALUE SPACES.
024700         10  FILLER               PIC X(002)  VALUE SPACES.
024800         10  MAC-PGM-6            PIC X(009)  VALUE SPACES.
024900         10  FILLER               PIC X(002)  VALUE SPACES.
025000         10  MAC-PGM-7            PIC X(009)  VALUE SPACES.
025100         10  FILLER               PIC X(002)  VALUE SPACES.
025200         10  MAC-PGM-8            PIC X(009)  VALUE SPACES.
025300         10  FILLER               PIC X(002)  VALUE SPACES.
025400         10  MAC-PGM-9            PIC X(009)  VALUE SPACES.
025500         10  FILLER               PIC X(002)  VALUE SPACES.
025600         10  MAC-PGM-10           PIC X(009)  VALUE SPACES.
025700         10  FILLER               PIC X(002)  VALUE SPACES.
025800         10  MAC-PGM-11           PIC X(009)  VALUE SPACES.
025900         10  FILLER               PIC X(002)  VALUE SPACES.
026000         10  MAC-PGM-12           PIC X(009)  VALUE SPACES.
026100     05  STA-DETAIL-4.
026200         10  FILLER               PIC X(003)  VALUE SPACES.
026300         10  TYP-PGM-1            PIC X(016)  VALUE SPACES.
026400         10  FILLER               PIC X(002)  VALUE SPACES.
026500         10  TYP-PGM-2            PIC X(016)  VALUE SPACES.
026600         10  FILLER               PIC X(002)  VALUE SPACES.
026700         10  TYP-PGM-3            PIC X(016)  VALUE SPACES.
026800         10  FILLER               PIC X(002)  VALUE SPACES.
026900         10  TYP-PGM-4            PIC X(016)  VALUE SPACES.
027000         10  FILLER               PIC X(002)  VALUE SPACES.
027100         10  TYP-PGM-5            PIC X(016)  VALUE SPACES.
027200         10  FILLER               PIC X(002)  VALUE SPACES.
027300         10  TYP-PGM-6            PIC X(016)  VALUE SPACES.
027400         10  FILLER               PIC X(002)  VALUE SPACES.
027500         10  TYP-PGM-7            PIC X(016)  VALUE SPACES.
027600     05  STA-DETAIL-5.
027700         10  FILLER               PIC X(002)  VALUE SPACES.
027800         10  MAC-ID-OUT           PIC X(009)  VALUE SPACES.
027900         10  FILLER               PIC X(001)  VALUE '-'.
028000         10  DASH-OUT             PIC X(004)  VALUE SPACES.
028100         10  FILLER               PIC X(002)  VALUE SPACES.
028200         10  TITLE-OUT            PIC X(050)  VALUE SPACES.
028300         10  FILLER               PIC X(002)  VALUE SPACES.
028400         10  OWNER-OUT            PIC X(004)  VALUE SPACES.
028500         10  FILLER               PIC X(002)  VALUE SPACES.
028600         10  COPIES-OUT           PIC X(004)  VALUE SPACES.
028700         10  FILLER               PIC X(002)  VALUE SPACES.
028800         10  COMMENTS-OUT         PIC X(035)  VALUE SPACES.
028900         10  FILLER               PIC X(002)  VALUE SPACES.
029000         10  LAST-ACT-OUT         PIC X(008)  VALUE SPACES.
029100     05  STA-TITLE-DET-3.
029200         10  FILLER               PIC X(001)  VALUE ' '.
029300         10  FILLER               PIC X(009)  VALUE 'MACH/PGM '.
029400         10  FILLER               PIC X(002)  VALUE SPACES.
029500         10  FILLER               PIC X(009)  VALUE 'MACH/PGM '.
029600         10  FILLER               PIC X(002)  VALUE SPACES.
029700         10  FILLER               PIC X(009)  VALUE 'MACH/PGM '.
029800         10  FILLER               PIC X(002)  VALUE SPACES.
029900         10  FILLER               PIC X(009)  VALUE 'MACH/PGM '.
030000         10  FILLER               PIC X(002)  VALUE SPACES.
030100         10  FILLER               PIC X(009)  VALUE 'MACH/PGM '.
030200         10  FILLER               PIC X(002)  VALUE SPACES.
030300         10  FILLER               PIC X(009)  VALUE 'MACH/PGM '.
030400         10  FILLER               PIC X(002)  VALUE SPACES.
030500         10  FILLER               PIC X(009)  VALUE 'MACH/PGM '.
030600         10  FILLER               PIC X(002)  VALUE SPACES.
030700         10  FILLER               PIC X(009)  VALUE 'MACH/PGM '.
030800         10  FILLER               PIC X(002)  VALUE SPACES.
030900         10  FILLER               PIC X(009)  VALUE 'MACH/PGM '.
031000         10  FILLER               PIC X(002)  VALUE SPACES.
031100         10  FILLER               PIC X(009)  VALUE 'MACH/PGM '.
031200         10  FILLER               PIC X(002)  VALUE SPACES.
031300         10  FILLER               PIC X(009)  VALUE 'MACH/PGM '.
031400         10  FILLER               PIC X(002)  VALUE SPACES.
031500         10  FILLER               PIC X(009)  VALUE 'MACH/PGM '.
031600     05  STA-TITLE-DET-4.
031700         10  FILLER               PIC X(001)  VALUE ' '.
031800         10  FILLER               PIC X(011)  VALUE 'TYPE/SERIAL'.
031900         10  FILLER               PIC X(007)  VALUE ' MODEL '.
032000         10  FILLER               PIC X(011)  VALUE 'TYPE/SERIAL'.
032100         10  FILLER               PIC X(007)  VALUE ' MODEL '.
032200         10  FILLER               PIC X(011)  VALUE 'TYPE/SERIAL'.
032300         10  FILLER               PIC X(007)  VALUE ' MODEL '.
032400         10  FILLER               PIC X(011)  VALUE 'TYPE/SERIAL'.
032500         10  FILLER               PIC X(007)  VALUE ' MODEL '.
032600         10  FILLER               PIC X(011)  VALUE 'TYPE/SERIAL'.
032700         10  FILLER               PIC X(007)  VALUE ' MODEL '.
032800         10  FILLER               PIC X(011)  VALUE 'TYPE/SERIAL'.
032900         10  FILLER               PIC X(007)  VALUE ' MODEL '.
033000         10  FILLER               PIC X(011)  VALUE 'TYPE/SERIAL'.
033100         10  FILLER               PIC X(007)  VALUE ' MODEL '.
033200     05  STA-TITLE-DET-5.
033300         10  FILLER               PIC X(001)  VALUE ' '.
033400         10  FILLER               PIC X(011)  VALUE 'MANUAL ID  '.
033500         10  FILLER               PIC X(020)  VALUE SPACES.
033600         10  FILLER               PIC X(011)  VALUE ' TITLE     '.
033700         10  FILLER               PIC X(021)  VALUE SPACES.
033800         10  FILLER               PIC X(009)  VALUE '    OWNER'.
033900         10  FILLER               PIC X(001)  VALUE SPACES.
034000         10  FILLER               PIC X(003)  VALUE 'CPY'.
034100         10  FILLER               PIC X(013)  VALUE SPACES.
034200         10  FILLER               PIC X(011)  VALUE '  COMMENTS '.
034300         10  FILLER               PIC X(010)  VALUE SPACES.
034400         10  FILLER               PIC X(011)  VALUE 'LAST ACTIVI'.
034500         10  FILLER               PIC X(011)  VALUE 'TY DATE    '.
034600         10  FILLER               PIC X(002)  VALUE SPACES.
034700     05  NON-IBM-SUB.
034800         10  FILLER               PIC X(001)  VALUE ' '.
034900         10  FILLER               PIC X(011)  VALUE 'MANUAL ID  '.
035000         10  FILLER               PIC X(015)  VALUE SPACES.
035100         10  FILLER               PIC X(011)  VALUE ' TITLE     '.
035200         10  FILLER               PIC X(021)  VALUE SPACES.
035300         10  FILLER               PIC X(009)  VALUE '    OWNER'.
035400         10  FILLER               PIC X(001)  VALUE SPACES.
035500         10  FILLER               PIC X(003)  VALUE 'CPY'.
035600         10  FILLER               PIC X(013)  VALUE SPACES.
035700         10  FILLER               PIC X(011)  VALUE '  COMMENTS '.
035800         10  FILLER               PIC X(010)  VALUE SPACES.
035900         10  FILLER               PIC X(011)  VALUE 'ACTIVITY DA'.
036000         10  FILLER               PIC X(011)  VALUE 'TE  VENDOR '.
036100         10  FILLER               PIC X(002)  VALUE SPACES.
036200     05  NON-IBM-DETAIL.
036300         10  FILLER               PIC X(002)  VALUE SPACES.
036400         10  MAC-ID-OUT1          PIC X(009)  VALUE SPACES.
036500         10  FILLER               PIC X(001)  VALUE '-'.
036600         10  DASH-OUT1            PIC X(004)  VALUE SPACES.
036700         10  FILLER               PIC X(002)  VALUE SPACES.
036800         10  TITLE-OUT1           PIC X(044)  VALUE SPACES.
036900         10  FILLER               PIC X(002)  VALUE SPACES.
037000         10  OWNER-OUT1           PIC X(004)  VALUE SPACES.
037100         10  FILLER               PIC X(002)  VALUE SPACES.
037200         10  COPIES-OUT1          PIC X(004)  VALUE SPACES.
037300         10  FILLER               PIC X(002)  VALUE SPACES.
037400         10  COMMENTS-OUT1        PIC X(035)  VALUE SPACES.
037500         10  FILLER               PIC X(002)  VALUE SPACES.
037600         10  LAST-ACT-OUT1        PIC X(008)  VALUE SPACES.
037700         10  FILLER               PIC X(001)  VALUE SPACES.
037800         10  VENDOR-OUT1          PIC X(010)  VALUE SPACES.
037900     SKIP2
038000 01  SUB-TITLE1.
038100     05  LINE-LEVEL1           OCCURS 15 TIMES
038200                               INDEXED BY LINE-INDEX1.
038300         10 MAC-TYPE1          OCCURS 12 TIMES
038400                               INDEXED BY MAC-INDEX1
038500                               PIC X(009).
038600 01  SUB-TITLE2.
038700     05  LINE-LEVEL2           OCCURS 15 TIMES
038800                               INDEXED BY LINE-INDEX2.
038900         10 MAC-TYPE2          OCCURS 7 TIMES
039000                               INDEXED BY MAC-INDEX2
039100                               PIC X(016).
039200     SKIP2
039300 01  TDT-PROCESS-DATE.
039400     05  DATE-OF-RUN-YY           PIC 99.
039500     05  DATE-OF-RUN-MM           PIC 99.
039600     05  DATE-OF-RUN-DD           PIC 99.
039700 01  TDT-PROCESS-TIME.
039800     05  TIME-OF-RUN-HH           PIC 99.
039900     05  TIME-OF-RUN-MM           PIC 99.
040000     05  TIME-OF-RUN-SS           PIC 99.
040100     05  TIME-OF-RUN-TT           PIC 99.
040200 01  TDT-DATE-OF-RUN.
040300     05  DATE-OF-RUN-MM           PIC 99.
040400     05  FILLER                   PIC X(001) VALUE '/'.
040500     05  DATE-OF-RUN-DD           PIC 99.
040600     05  FILLER                   PIC X(001) VALUE '/'.
040700     05  DATE-OF-RUN-YY           PIC 99.
040800 01  TDT-TIME-OF-RUN.
040900     05  TIME-OF-RUN-HH           PIC 99.
041000     05  FILLER                   PIC X(001) VALUE ':'.
041100     05  TIME-OF-RUN-MM           PIC 99.
041200     05  FILLER                   PIC X(001) VALUE ':'.
041300     05  TIME-OF-RUN-SS           PIC 99.
041400     EJECT
041500 01  REC-WORK.
041600     10  CONTROL-FIELD            PIC X(001).
041700     10  TBL-KEY.
041800         15  MACO.
041900             20  MAC-ID.
042000                 25  MAC-CODE         PIC X(004).
042100                 25  FILLER           PIC X(001).
042200                 25  MAC-TYPE         PIC X(004).
042300         15  INIO        PICTURE X(005).
042400     10  TITO        PICTURE X(045).
042500     10  SUBO        PICTURE X(090).
042600     10  REFO.
042700         15  REF-SERIAL-NUMB  PIC X(006).
042800         15  FILLER           PIC X(039).
042900     10  VENDO       PICTURE X(010).
043000     10  DASHO       PICTURE X(004).
043100     10  LDTEO       PICTURE X(008).
043200     10  CKBYO       PICTURE X(004).
043300     10  TNLO        PICTURE X(015).
043400     10  TDTEO       PICTURE X(008).
043500     10  CDEO.
043600         15  CDE-ID.
043700             20  CDE-DES          PIC X(009).
043800             20  FILLER           PIC X(041).
043900     10  CPIO        PICTURE X(005).
044000 PROCEDURE DIVISION.
044100     SKIP2
044200 1010-MAINLINE.
044300     SKIP1
044400     PERFORM 2010-HOUSEKEEPING.
044500     OPEN OUTPUT RI.
044600     MOVE CON-FALSE TO SWT-END-OF-DATA.
044700     MOVE ZERO TO RETURN-CODE.
044800     CALL 'ISPLINK' USING TBOPEN SLSS.
044900     MOVE 9  TO LENG.
045000     CALL 'ISPLINK' USING VDEFINE MAC1V MAC1 CHAR LENG.
045100     MOVE 9  TO LENG.
045200     CALL 'ISPLINK' USING VDEFINE MACV MAC CHAR LENG.
045300     MOVE 05 TO LENG.
045400     CALL 'ISPLINK' USING VDEFINE INI1V INI1 CHAR LENG.
045500     MOVE 05 TO LENG.
045600     CALL 'ISPLINK' USING VDEFINE INIV INI CHAR LENG.
045700     MOVE 45 TO LENG.
045800     CALL 'ISPLINK' USING VDEFINE TITV TIT CHAR LENG.
045900     MOVE 90 TO LENG.
046000     CALL 'ISPLINK' USING VDEFINE SUBV SUB CHAR LENG.
046100     MOVE 45 TO LENG.
046200     CALL 'ISPLINK' USING VDEFINE REFV REF CHAR LENG.
046300     MOVE 10 TO LENG.
046400     CALL 'ISPLINK' USING VDEFINE VENDV VEND CHAR LENG.
046500     MOVE 04 TO LENG.
046600     CALL 'ISPLINK' USING VDEFINE DASHV DASH CHAR LENG.
046700     MOVE 08 TO LENG.
046800     CALL 'ISPLINK' USING VDEFINE LDTEV LDTE CHAR LENG.
046900     MOVE 06 TO LENG.
047000     CALL 'ISPLINK' USING VDEFINE CKBYV CKBY CHAR LENG.
047100     MOVE 15 TO LENG.
047200     CALL 'ISPLINK' USING VDEFINE TNLV TNL CHAR LENG.
047300     MOVE 08 TO LENG.
047400     CALL 'ISPLINK' USING VDEFINE TDTEV TDTE CHAR LENG.
047500     MOVE 50 TO LENG.
047600     CALL 'ISPLINK' USING VDEFINE CDEV CDE CHAR LENG.
047700     MOVE 5 TO LENG.
047800     CALL 'ISPLINK' USING VDEFINE CPIV CPI CHAR LENG.
047900     PERFORM 1020-NEXT UNTIL END-OF-DATA.
048000     CALL 'ISPLINK' USING TBCLOSE SLSS.
048100     CALL 'ISPLINK' USING TBERASE SLSS.
048200     CLOSE RI.
048300     PERFORM 1021-SORT.
048400     CALL 'ISPLINK' USING TBCREATE SLSS VCREATE-KEYS VCREATE-VARS.
048500     OPEN INPUT RI.
048600     MOVE CON-FALSE TO SWT-END-OF-DATA.
048700     PERFORM 1022-READ UNTIL END-OF-DATA.
048800     CALL 'ISPLINK' USING TBCLOSE SLSS.
048900     CLOSE RI.
049000     PERFORM 1025-SORT.
049100     OPEN INPUT RI.
049200     OPEN OUTPUT RO.
049300     OPEN OUTPUT RN.
049400     PERFORM 1023-REPORT UNTIL END-OF-INPUT.
049500     CLOSE RI
049600           RO
049700           RN.
049800     GOBACK.
049900 2010-HOUSEKEEPING.
050000     SKIP2
050100     ACCEPT TDT-PROCESS-DATE FROM DATE.
050200     ACCEPT TDT-PROCESS-TIME FROM TIME.
050300     MOVE CORRESPONDING TDT-PROCESS-DATE TO TDT-DATE-OF-RUN.
050400     MOVE CORRESPONDING TDT-PROCESS-TIME TO TDT-TIME-OF-RUN.
050500     MOVE TDT-DATE-OF-RUN TO HEAD-DATE.
050600     MOVE TDT-TIME-OF-RUN TO HEAD2-TIME.
050700     MOVE TDT-DATE-OF-RUN TO HEAD2-DATE.
050800     MOVE TDT-TIME-OF-RUN TO HEAD-TIME.
050900     MOVE CON-FALSE TO SWT-END-OF-INPUT.
051000     MOVE CON-FALSE TO SWT-INDEX-CLEARED.
051100     MOVE SPACES TO SH-DETAIL.
051200     ADD 1 TO LINE1-INDEX-LIMIT.
051300     ADD 1 TO LINE2-INDEX-LIMIT.
051400     SET LINE-INDEX1 TO 1.
051500     SET LINE-INDEX2 TO 1.
051600     SET MAC-INDEX1 TO 1.
051700     SET MAC-INDEX2 TO 1.
051800     PERFORM 3021-CLEAR-INDEX UNTIL INDEX-CLEARED.
051900     SET MAC-INDEX1 TO 1.
052000     SET MAC-INDEX2 TO 1.
052100     SET LINE-INDEX1 TO 1.
052200     SET LINE-INDEX2 TO 1.
052300 2010-EXIT.
052400     EJECT
052500 1020-NEXT.
052600     MOVE ZERO TO RETURN-CODE.
052700     CALL 'ISPLINK' USING TBSKIP SLSS.
052800     IF RETURN-CODE GREATER THAN 0 THEN
052900        MOVE CON-TRUE TO SWT-END-OF-DATA.
053000     IF NOT END-OF-DATA
053100      THEN
053200        MOVE MAC  TO MACO
053300        MOVE INI  TO INIO
053400        MOVE TIT  TO TITO
053500        MOVE REF  TO REFO
053600        MOVE SUB  TO SUBO
053700        MOVE VEND TO VENDO
053800        MOVE DASH TO DASHO
053900        MOVE LDTE TO LDTEO
054000        MOVE CKBY TO CKBYO
054100        MOVE TNL  TO TNLO
054200        MOVE TDTE TO TDTEO
054300        MOVE CDE  TO CDEO
054400        MOVE CPI  TO CPIO.
054500     IF NOT END-OF-DATA
054600      THEN
054700     IF VENDO NOT EQUAL 'IBM       '
054800        THEN
054900        MOVE CON-NON-IBM TO CONTROL-FIELD
055000        PERFORM 1024-WRITE-REC
055100        THRU 1024-EXIT.
055200     IF NOT END-OF-DATA
055300      THEN
055400     IF CDE-DES = 'PROCESSOR'
055500        THEN
055600        MOVE CON-SUB-CODES TO CONTROL-FIELD
055700        PERFORM 1024-WRITE-REC
055800           THRU 1024-EXIT
055900        MOVE CON-PROCESSOR TO CONTROL-FIELD
056000        PERFORM 1024-WRITE-REC
056100           THRU 1024-EXIT.
056200     IF NOT END-OF-DATA
056300      THEN
056400     IF VENDO EQUAL 'IBM       '
056500      THEN
056600     IF CDE-DES = 'MACHINE  '
056700        THEN
056800        MOVE CON-MACH-PGM TO CONTROL-FIELD
056900        PERFORM 1024-WRITE-REC
057000           THRU 1024-EXIT.
057100     IF NOT END-OF-DATA
057200      THEN
057300     IF VENDO EQUAL 'IBM       '
057400      THEN
057500     IF CDE-DES = 'PRODUCT  '
057600        THEN
057700        MOVE CON-MACH-SER TO CONTROL-FIELD
057800        PERFORM 1024-WRITE-REC
057900        THRU 1024-EXIT.
058000     IF NOT END-OF-DATA
058100      THEN
058200     IF CDE-DES NOT EQUAL 'PRODUCT  '
058300     AND CDE-DES NOT EQUAL 'MACHINE  '
058400     AND CDE-DES NOT EQUAL 'PROCESSOR'
058500        THEN
058600        MOVE CON-MANUALS TO CONTROL-FIELD
058700        PERFORM 1024-WRITE-REC
058800           THRU 1024-EXIT.
058900     MOVE SPACES TO REC-WORK.
059000 1024-WRITE-REC.
059100     SKIP2
059200     WRITE REPORT-RECORD FROM REC-WORK.
059300 1024-EXIT.
059400     EXIT.
059500 1020-EXIT.
059600     EXIT.
059700 1021-SORT.
059800     SORT SORT-FILE ON ASCENDING KEY SORT-KEY2
059900      USING RI GIVING RI.
060000 1021-EXIT.
060100     EXIT.
060200 1022-READ.
060300     READ RI INTO REC-WORK
060400       AT END
060500          MOVE CON-TRUE TO SWT-END-OF-DATA.
060600     IF NOT END-OF-DATA
060700     THEN
060800     MOVE MACO  TO MAC1
060900     MOVE INIO  TO INI1
061000     MOVE MACO  TO MAC
061100     MOVE INIO  TO INI
061200     MOVE TITO  TO TIT
061300     MOVE REFO  TO REF
061400     MOVE SUBO  TO SUB
061500     MOVE VENDO TO VEND
061600     MOVE DASHO TO DASH
061700     MOVE LDTEO TO LDTE
061800     MOVE CKBYO TO CKBY
061900     MOVE TNLO  TO TNLO
062000     MOVE TDTEO TO TDTE
062100     MOVE CDEO  TO CDE
062200     MOVE CPIO  TO CPI
062300     IF NOT END-OF-DATA
062400     THEN
062500       IF TBL-KEY NOT EQUAL TBL-KEY-WORK
062600         THEN
062700          MOVE TBL-KEY TO TBL-KEY-WORK
062800          CALL 'ISPLINK' USING TBADD SLSS.
062900 1022-EXIT.
063000     EXIT.
063100 1023-REPORT.
063200     SKIP2
063300     READ RI INTO REC-WORK
063400        AT END
063500           MOVE CON-TRUE TO SWT-END-OF-INPUT.
063600     IF NOT END-OF-INPUT
063700        THEN
063800        PERFORM 3011-GEN-THE-REPORT
063900           THRU 3011-EXIT.
064000     SKIP2
064100 1023-EXIT.
064200     EXIT.
064300 1025-SORT.
064400     SORT SORT-FILE ON ASCENDING KEY SORT-KEY1 SORT-KEY2
064500      USING RI GIVING RI.
064600 1025-EXIT.
064700     EXIT.
064800 3011-GEN-THE-REPORT.
064900     SKIP2
065000     IF CONTROL-FIELD = 'A'
065100        THEN
065200        MOVE SUBO TO SUBO-OUT.
065300     IF CONTROL-FIELD = 'B'
065400        THEN
065500        MOVE MAC-ID TO PROCESSOR-OUT.
065600     IF CONTROL-FIELD = 'C'
065700        THEN
065800        PERFORM 3012-SUB-TITLE-1
065900           THRU 3012-EXIT.
066000     IF CONTROL-FIELD = 'D'
066100        THEN
066200        PERFORM 3013-SUB-TITLE-2
066300        THRU 3013-EXIT.
066400     IF CONTROL-FIELD = 'E'
066500        THEN
066600          PERFORM 3014-SETUP-REPORT
066700             THRU 3014-EXIT.
066800     IF CONTROL-FIELD = 'F'
066900        THEN
067000          PERFORM 3022-NON-IBM-REPORT
067100             THRU 3022-EXIT.
067200 3011-EXIT.
067300     EJECT
067400 3012-SUB-TITLE-1.
067500     SKIP2
067600     IF MAC-INDEX1 GREATER THAN 12
067700        THEN
067800          SET LINE-INDEX1 UP BY 1
067900          ADD 1 TO LINE1-INDEX-LIMIT
068000          SET MAC-INDEX1 TO 1.
068100     MOVE MAC-ID   TO MAC-TYPE-1.
068200     MOVE MAC-TYPE-1 TO MAC-TYPE1 (LINE-INDEX1, MAC-INDEX1).
068300     SET MAC-INDEX1 UP BY 1.
068400     SKIP2
068500 3012-EXIT.
068600     EJECT
068700 3013-SUB-TITLE-2.
068800     SKIP2
068900     IF MAC-INDEX2 GREATER THAN 7
069000        THEN
069100          SET LINE-INDEX2 UP BY 1
069200          ADD 1 TO LINE2-INDEX-LIMIT
069300          SET MAC-INDEX2 TO 1.
069400     IF MAC-INDEX1 GREATER THAN 12
069500        THEN
069600          SET LINE-INDEX1 UP BY 1
069700          ADD 1 TO LINE1-INDEX-LIMIT
069800          SET MAC-INDEX1 TO 1.
069900     MOVE MAC-CODE TO MAC-FMID.
070000     MOVE REF-SERIAL-NUMB  TO MAC-SERIAL.
070100     MOVE MAC-TYPE TO MAC-TPE.
070200     MOVE MAC-TYPE-2 TO MAC-TYPE2 (LINE-INDEX2, MAC-INDEX2).
070300     MOVE MAC-ID TO MAC-TYPE-1.
070400     MOVE MAC-TYPE-1 TO MAC-TYPE1 (LINE-INDEX1, MAC-INDEX1).
070500     SET MAC-INDEX1 UP BY 1.
070600     SET MAC-INDEX2 UP BY 1.
070700     SKIP2
070800 3013-EXIT.
070900     EJECT
071000 3014-SETUP-REPORT.
071100     SKIP2
071200     IF VENDO EQUAL 'IBM       '
071300      THEN
071400     MOVE MAC-ID TO MAC-ID-OUT
071500     MOVE DASHO TO DASH-OUT
071600     MOVE TITO TO TITLE-OUT
071700     MOVE INIO TO OWNER-OUT
071800     MOVE CPIO TO COPIES-OUT
071900     MOVE CDE-ID TO COMMENTS-OUT
072000     MOVE LDTEO TO LAST-ACT-OUT
072100     MOVE CON-FALSE TO SWT-LINE-MAX
072200     MOVE CON-FALSE TO SWT-LINE2-MAX
072300     PERFORM 3015-PRINT-REPORT-REC THRU 3015-EXIT.
072400 3014-EXIT.
072500     EJECT
072600 3015-PRINT-REPORT-REC.
072700     SKIP2
072800     ON 1 PERFORM 3016-PRINT-HEADERS THRU 3016-EXIT.
072900     ON 1 WRITE REPORT-REC FROM STA-DETAIL-1.
073000     ON 1 WRITE REPORT-REC FROM STA-DETAIL-2.
073100     ON 1 MOVE CON-TRUE TO SWT-FIRST-TIME.
073200     IF FIRST-TIME
073300        THEN
073400         MOVE STA-TITLE-DET-3 TO SH-DETAIL
073500         PERFORM 3020-PRINT-SUB-HEADING
073600         SET LINE-INDEX1 TO 1
073700         PERFORM 3018-PRINT-MAC-PGM
073800           UNTIL LINE-MAX
073900         MOVE STA-TITLE-DET-4 TO SH-DETAIL
074000         PERFORM 3020-PRINT-SUB-HEADING
074100         SET LINE-INDEX2 TO 1
074200         PERFORM 3019-PRINT-MAC-SER
074300           UNTIL LINE2-MAX
074400         MOVE CON-FALSE TO SWT-FIRST-TIME.
074500     MOVE STA-TITLE-DET-5 TO SH-DETAIL.
074600     MOVE STA-DETAIL-5 TO DETAIL-LINE.
074700     ON 1 ADD 70 TO REPORT-LINE-COUNT.
074800     PERFORM 3017-WRITE-REPORT-REC.
074900 3015-EXIT.
075000     EJECT
075100 3016-PRINT-HEADERS.
075200     SKIP2
075300     ADD 1 TO PAGE-COUNT.
075400     MOVE PAGE-COUNT TO OUT-PAGE.
075500     WRITE REPORT-REC FROM HEADING-LINE.
075600     IF NOT FIRST-TIME
075700       THEN
075800         PERFORM 3020-PRINT-SUB-HEADING
075900            THRU 3020-EXIT.
076000 3016-EXIT.
076100     EJECT
076200 3017-WRITE-REPORT-REC.
076300     SKIP2
076400     ADD 1 TO REPORT-LINE-COUNT.
076500     IF REPORT-LINE-COUNT GREATER THAN PAGE-LIMIT
076600        THEN
076700        MOVE ZERO TO REPORT-LINE-COUNT
076800        PERFORM 3016-PRINT-HEADERS THRU 3016-EXIT.
076900     WRITE REPORT-REC FROM DETAIL-LINE.
077000     MOVE SPACES TO DETAIL-LINE.
077100 3017-EXIT.
077200     EJECT
077300 3018-PRINT-MAC-PGM.
077400     SKIP2
077500     MOVE MAC-TYPE1 (LINE-INDEX1, 1) TO MAC-PGM-1.
077600     MOVE MAC-TYPE1 (LINE-INDEX1, 2) TO MAC-PGM-2.
077700     MOVE MAC-TYPE1 (LINE-INDEX1, 3) TO MAC-PGM-3.
077800     MOVE MAC-TYPE1 (LINE-INDEX1, 4) TO MAC-PGM-4.
077900     MOVE MAC-TYPE1 (LINE-INDEX1, 5) TO MAC-PGM-5.
078000     MOVE MAC-TYPE1 (LINE-INDEX1, 6) TO MAC-PGM-6.
078100     MOVE MAC-TYPE1 (LINE-INDEX1, 7) TO MAC-PGM-7.
078200     MOVE MAC-TYPE1 (LINE-INDEX1, 8) TO MAC-PGM-8.
078300     MOVE MAC-TYPE1 (LINE-INDEX1, 9) TO MAC-PGM-9.
078400     MOVE MAC-TYPE1 (LINE-INDEX1, 10) TO MAC-PGM-10.
078500     MOVE MAC-TYPE1 (LINE-INDEX1, 11) TO MAC-PGM-11.
078600     MOVE MAC-TYPE1 (LINE-INDEX1, 12) TO MAC-PGM-12.
078700     MOVE STA-DETAIL-3 TO DETAIL-LINE.
078800     PERFORM 3017-WRITE-REPORT-REC THRU 3017-EXIT.
078900     MOVE SPACES TO DETAIL-LINE.
079000     SET LINE-INDEX1 UP BY 1.
079100     IF LINE-INDEX1 GREATER THAN LINE1-INDEX-LIMIT
079200        THEN
079300        MOVE CON-TRUE TO SWT-LINE-MAX.
079400 3018-EXIT.
079500     EJECT
079600 3019-PRINT-MAC-SER.
079700     SKIP2
079800     MOVE MAC-TYPE2 (LINE-INDEX2, 1) TO TYP-PGM-1
079900     MOVE MAC-TYPE2 (LINE-INDEX2, 2) TO TYP-PGM-2
080000     MOVE MAC-TYPE2 (LINE-INDEX2, 3) TO TYP-PGM-3
080100     MOVE MAC-TYPE2 (LINE-INDEX2, 4) TO TYP-PGM-4
080200     MOVE MAC-TYPE2 (LINE-INDEX2, 5) TO TYP-PGM-5
080300     MOVE MAC-TYPE2 (LINE-INDEX2, 6) TO TYP-PGM-6
080400     MOVE MAC-TYPE2 (LINE-INDEX2, 7) TO TYP-PGM-7
080500     MOVE STA-DETAIL-4 TO DETAIL-LINE.
080600     PERFORM 3017-WRITE-REPORT-REC THRU 3017-EXIT.
080700     MOVE SPACES TO DETAIL-LINE.
080800     SET LINE-INDEX2 UP BY 1.
080900     IF LINE-INDEX2 GREATER THAN LINE2-INDEX-LIMIT
081000        THEN
081100        MOVE CON-TRUE TO SWT-LINE2-MAX.
081200 3019-EXIT.
081300     EJECT
081400 3020-PRINT-SUB-HEADING.
081500     SKIP2
081600     WRITE REPORT-REC FROM SUB-HEADING-LINE.
081700 3020-EXIT.
081800     EJECT
081900 3021-CLEAR-INDEX.
082000     SKIP2
082100     IF LINE-INDEX1 LESS THAN 15
082200        THEN
082300     IF MAC-INDEX1 GREATER THAN 12
082400        THEN
082500          SET LINE-INDEX1 UP BY 1
082600          SET MAC-INDEX1 TO 1.
082700     IF LINE-INDEX2 LESS THAN 15
082800        THEN
082900     IF MAC-INDEX2 GREATER THAN 7
083000        THEN
083100          SET LINE-INDEX2 UP BY 1
083200          SET MAC-INDEX2 TO 1.
083300     IF LINE-INDEX1 LESS THAN 15
083400        THEN
083500          MOVE SPACES TO MAC-TYPE2 (LINE-INDEX2, MAC-INDEX2)
083600          SET MAC-INDEX1 UP BY 1.
083700     IF LINE-INDEX2 LESS THAN 15
083800        THEN
083900          MOVE SPACES TO MAC-TYPE1 (LINE-INDEX1, MAC-INDEX1)
084000          SET MAC-INDEX2 UP BY 1.
084100     IF LINE-INDEX2 EQUAL 14
084200        THEN
084300        MOVE CON-TRUE TO SWT-INDEX-CLEARED.
084400     SKIP2
084500 3021-EXIT.
084600 3022-NON-IBM-REPORT.
084700     SKIP2
084800     MOVE VENDO  TO VENDOR-OUT1.
084900     MOVE MAC-ID TO MAC-ID-OUT1
085000     MOVE DASHO  TO DASH-OUT1
085100     MOVE TITO   TO TITLE-OUT1
085200     MOVE INIO   TO OWNER-OUT1
085300     MOVE CPIO   TO COPIES-OUT1
085400     MOVE CDE-ID TO COMMENTS-OUT1
085500     MOVE LDTEO  TO LAST-ACT-OUT1
085600     MOVE CON-FALSE TO SWT-LINE-MAX
085700     MOVE CON-FALSE TO SWT-LINE2-MAX
085800     IF CDE-DES NOT EQUAL 'PRODUCT  '
085900       THEN
086000         PERFORM 3023-PRINT-NON-IBM THRU 3023-EXIT.
086100 3022-EXIT.
086200     EJECT
086300 3023-PRINT-NON-IBM.
086400     SKIP2
086500     MOVE NON-IBM-SUB TO SH-DETAIL.
086600     MOVE NON-IBM-DETAIL TO DETAIL-LINE.
086700     ON 1 ADD 70 TO REPORT-LINE-COUNT2.
086800     ADD 1 TO REPORT-LINE-COUNT.
086900     IF REPORT-LINE-COUNT2 GREATER THAN PAGE-LIMIT
087000        THEN
087100        MOVE ZERO TO REPORT-LINE-COUNT2
087200        PERFORM 3024-NON-IBM-HEADER THRU 3024-EXIT.
087300     WRITE REPORT-REC2 FROM DETAIL-LINE.
087400     MOVE SPACES TO DETAIL-LINE.
087500 3023-EXIT.
087600     EJECT
087700 3024-NON-IBM-HEADER.
087800     SKIP2
087900     ADD 1 TO PAGE-COUNT2.
088000     MOVE PAGE-COUNT2 TO OUT-PAGE2.
088100     WRITE REPORT-REC2 FROM NON-IBM-HEADING.
088200     WRITE REPORT-REC2 FROM SUB-HEADING-LINE.
088300 3024-EXIT.
088400     EJECT

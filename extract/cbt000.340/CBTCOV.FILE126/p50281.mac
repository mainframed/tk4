000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID.    P50281.
000030 AUTHOR.        DICK GLOJEK.
000040 INSTALLATION.  MILLER BREWING COMPANY - MILWAUKEE.
000050 DATE-WRITTEN.  MARCH, 1981.
000060 DATE-COMPILED.
000070 REMARKS.       *** ENVIRON-1 ACCOUNTING ***.
000080 ENVIRONMENT DIVISION.
000090 CONFIGURATION SECTION.
000100 SOURCE-COMPUTER.     IBM-370.
000110 OBJECT-COMPUTER.     IBM-370.
000120 INPUT-OUTPUT SECTION.
000130 FILE-CONTROL.
000140     SELECT E1-AUDIT-FILE ASSIGN UT-S-E1AUDIT.
000150     SELECT PRINTER-FILE ASSIGN UT-S-PRINTER.
000160     SELECT PARM-FILE ASSIGN UT-S-SYSIN.
000170     SELECT SORT-FILE ASSIGN UT-S-SORTWK01.
000180     SELECT WORK-FILE ASSIGN UT-S-WORK.
000190 DATA DIVISION.
000200 FILE SECTION.
000210 FD  E1-AUDIT-FILE
000220     BLOCK CONTAINS 0 RECORDS
000230     RECORDING MODE F
000240     LABEL RECORD STANDARD.
000250 01  E1-AUDIT-RECORD         PIC X(576).
000260 FD  PRINTER-FILE
000270     BLOCK CONTAINS 0 RECORDS
000280     RECORDING MODE F
000290     LABEL RECORD STANDARD.
000300 01  PRINT-LINE.
000310     05  PRT-CNTL            PIC X.
000320     05  FILLER              PIC X(132).
000330 FD  PARM-FILE
000340     BLOCK CONTAINS 0 RECORDS
000350     RECORDING MODE IS F
000360     LABEL RECORD ARE OMITTED.
000370 01  PARM-RECORD             PIC X(80).
000380 SD  SORT-FILE
000390     RECORDING MODE IS F.
000400 01  SORT-RECORD.
000410     05  SORT-KEY            PIC X(38).
000420     05  FILLER              PIC X(512).
000430 FD  WORK-FILE
000440     BLOCK CONTAINS 0 RECORDS
000450     RECORDING MODE IS F
000460     LABEL RECORD STANDARD.
000470 01  WORK-RECORD             PIC X(60).
000480     EJECT
000490 WORKING-STORAGE SECTION.
000500 01  ODDS-AND-ENDS.
000510     05  PAGE-CT             PIC S9(5)       VALUE +0    COMP.
000520     05  LINE-CT             PIC S99         VALUE +0    COMP.
000530     05  PREV-TERMINAL.
000540         10  PREV-LUNME      PIC X(8)        VALUE SPACES.
000550         10  PREV-TERMID     PIC X(4)        VALUE SPACES.
000560     05  PREV-AUDATE         PIC S9(6)       VALUE +0    COMP-3.
000570     05  PREV-USERID         PIC X(8)        VALUE SPACES.
000580     05  PREV-USERNME        PIC X(17)       VALUE SPACES.
000590     05  PREV-OWNERID        PIC X(8)        VALUE SPACES.
000600     05  PREV-TRANID         PIC X(4)        VALUE SPACES.
000610     05  PREV-TRANDESC       PIC X(30)       VALUE SPACES.
000620     05  PREV-SYSID          PIC XXX         VALUE SPACES.
000630     05  PREV-TRMLOC         PIC X(19)       VALUE SPACES.
000640     05  PREV-CTLLOC         PIC X(22)       VALUE SPACES.
000650     05  PREV-TYPE-IO        PIC X           VALUE SPACES.
000660     05  PREV-LOCCDE.
000670         10  PREV-LOCCDE-1   PIC X.
000680         10  FILLER          PIC XX.
000690     05  PREV-DBFILE.
000700         10  PREV-FILE       PIC X(4)        VALUE SPACES.
000710         10  PREV-PATH       PIC X(4)        VALUE SPACES.
000720     05  DBSUB               PIC S99         VALUE +0     COMP
000730                                             SYNC.
000740     05  ARSUB               PIC S99         VALUE +0     COMP
000750                                             SYNC.
000760     05  LOCSUB              PIC S99         VALUE +0     COMP
000770                                             SYNC.
000780     05  MONSUB              PIC S99         VALUE +0     COMP
000790                                             SYNC.
000800     05  AUD-PERIOD-START    PIC S9(6)       VALUE +999999 COMP-3.
000810     05  AUD-PERIOD-END      PIC S9(6)       VALUE +0      COMP-3.
000820     05  DATE-BREAKDOWN      PIC 9(6).
000830     05  FILLER REDEFINES DATE-BREAKDOWN.
000840         10  BRKDWN-YR       PIC 99.
000850         10  BRKDWN-MON      PIC 99.
000860         10  BRKDWN-DAY      PIC 99.
000870     05  TIME-BREAKDOWN      PIC 9(6).
000880     05  FILLER REDEFINES TIME-BREAKDOWN.
000890         10  BRKDWN-HH       PIC 99.
000900         10  BRKDWN-MM       PIC 99.
000910         10  BRKDWN-SS       PIC 99.
000920     05  RACF                PIC X(8)       VALUE 'P50212H'.
000930     05  RACF-FUNC           PIC X.
000940     05  RACF-KEY            PIC X(4).
000950     05  RACF-INFO           PIC X(256).
000960     05  FILLER REDEFINES RACF-INFO.
000970         10  RACF-RESULTS    PIC X(14).
000980     05  FILLER REDEFINES RACF-INFO.
000990         10  RACF-OWNERID    PIC X(4).
001000         10  RACF-OWNERNME   PIC X(20).
001010     05  DB-STATISTICS OCCURS 25 TIMES.
001020         10  DB-STAT-FILE    PIC X(4).
001030         10  DB-STAT-PATH    PIC X(4).
001040         10  DB-STAT-READ    PIC S9(9)                    COMP.
001050         10  DB-STAT-UPDT    PIC S9(9)                    COMP.
001060         10  DB-STAT-ADD     PIC S9(9)                    COMP.
001070         10  DB-STAT-DELT    PIC S9(9)                    COMP.
001080     05  DB-STAT-INIT-VALUES.
001090         10  FILLER          PIC X(8)        VALUE HIGH-VALUES.
001100         10  FILLER          PIC S9(9)       VALUE +0     COMP.
001110         10  FILLER          PIC S9(9)       VALUE +0     COMP.
001120         10  FILLER          PIC S9(9)       VALUE +0     COMP.
001130         10  FILLER          PIC S9(9)       VALUE +0     COMP.
001140     05  ACCUM-TOTALS COMP.
001150         10  ACC-DBREAD          PIC S9(9)   VALUE +0.
001160         10  ACC-DBUPDT          PIC S9(9)   VALUE +0.
001170         10  ACC-DBADD           PIC S9(9)   VALUE +0.
001180         10  ACC-DBDELT          PIC S9(9)   VALUE +0.
001190         10  ACC-TOT-DBREAD      PIC S9(9)   VALUE +0.
001200         10  ACC-TOT-DBUPDT      PIC S9(9)   VALUE +0.
001210         10  ACC-TOT-DBADD       PIC S9(9)   VALUE +0.
001220         10  ACC-TOT-DBDELT      PIC S9(9)   VALUE +0.
001230         10  ACC-TRAN-DBREAD     PIC S9(9)   VALUE +0.
001240         10  ACC-TRAN-DBUPDT     PIC S9(9)   VALUE +0.
001250         10  ACC-TRAN-DBADD      PIC S9(9)   VALUE +0.
001260         10  ACC-TRAN-DBDELT     PIC S9(9)   VALUE +0.
001270         10  ACC-TRAN-ENTER-CT   PIC S9(9)   VALUE +0.
001280         10  ACC-TRAN-ENTER-TOTAL PIC S9(9)  VALUE +0.
001290         10  ACC-TRAN-SYS-TOTAL  PIC S9(9)   VALUE +0.
001300         10  ACC-TRAN-GRAND-TOTAL PIC S9(9)  VALUE +0.
001310     05  LOCATION-DESCRIPTIONS.
001320         10  FILLER              PIC X(25)   VALUE
001330             'A  CORPORATE HEADQUARTERS'.
001340         10  FILLER              PIC X(25)   VALUE
001350             'B  ALBANY PLANT          '.
001360         10  FILLER              PIC X(25)   VALUE
001370             'C  EDEN PLANT            '.
001380         10  FILLER              PIC X(25)   VALUE
001390             'D  FORT WORTH PLANT      '.
001400         10  FILLER              PIC X(25)   VALUE
001410             'E  FULTON PLANT          '.
001420         10  FILLER              PIC X(25)   VALUE
001430             'F  IRWINDALE PLANT       '.
001440         10  FILLER              PIC X(25)   VALUE
001450             'G  MILWAUKEE PLANT       '.
001460         10  FILLER              PIC X(25)   VALUE
001470             'H  TRENTON PLANT         '.
001480         10  FILLER              PIC X(25)   VALUE
001490             'I  FORT WORTH CAN PLANT  '.
001500         10  FILLER              PIC X(25)   VALUE
001510             'J  FULTON CAN PLANT      '.
001520         10  FILLER              PIC X(25)   VALUE
001530             'K  MOULTRIE CAN PLANT    '.
001540         10  FILLER              PIC X(25)   VALUE
001550             'L  MILWAUKEE CAN PLANT   '.
001560         10  FILLER              PIC X(25)   VALUE
001570             'M  REIDSVILLE CAN PLANT  '.
001580         10  FILLER              PIC X(25)   VALUE
001590             'N80SOUTHWEST REGION      '.
001600         10  FILLER              PIC X(25)   VALUE
001610             'N81MOUNTAIN REGION       '.
001620         10  FILLER              PIC X(25)   VALUE
001630             'N82NORTHERN REGION       '.
001640         10  FILLER              PIC X(25)   VALUE
001650             'N83NEW ENGLAND REGION    '.
001660         10  FILLER              PIC X(25)   VALUE
001670             'N84MIDWEST REGION        '.
001680         10  FILLER              PIC X(25)   VALUE
001690             'N85CAPITOL REGION        '.
001700         10  FILLER              PIC X(25)   VALUE
001710             'N86EASTERN REGION        '.
001720         10  FILLER              PIC X(25)   VALUE
001730             'N87CENTRAL REGION        '.
001740         10  FILLER              PIC X(25)   VALUE
001750             'N88SOUTHERN REGION       '.
001760         10  FILLER              PIC X(25)   VALUE
001770             'N89NORTH PACIFIC REGION  '.
001780         10  FILLER              PIC X(25)   VALUE
001790             'N90SOUTH PACIFIC REGION  '.
001800         10  FILLER              PIC X(25)   VALUE
001810             'N91DELTA REGION          '.
001820         10  FILLER              PIC X(25)   VALUE
001830             'O  P. M. INTERNATIONAL   '.
001840         10  FILLER              PIC X(25)   VALUE
001850             'P01STAR DISTRIBUTING     '.
001860         10  FILLER              PIC X(25)   VALUE
001870             'P02MILLER BRANDS MILW.   '.
001880         10  FILLER              PIC X(25)   VALUE
001890             'P03MILLER BRANDS L.A.    '.
001900         10  FILLER              PIC X(25)   VALUE
001910             'P04CRESENT DISTRIBUTOR   '.
001920         10  FILLER              PIC X(25)   VALUE
001930             'P05BEAVERTON DISTRIBUTOR '.
001940         10  FILLER              PIC X(25)   VALUE
001950             'Q  CENTRAL N.Y. BOTTLE   '.
001960         10  FILLER              PIC X(25)   VALUE
001970             'R  PORTABLE TERMINALS    '.
001980         10  FILLER              PIC X(25)   VALUE
001990             '+++MISCELLANEOUS         '.
002000     05  LOC-DESC-TABLE REDEFINES
002010             LOCATION-DESCRIPTIONS OCCURS 34 TIMES.
002020         10  LOC-CODE.
002030             15  LOC-CODE-1      PIC X.
002040             15  FILLER          PIC XX.
002050         10  LOC-DESC            PIC X(22).
002060     SKIP3
002070     05  MONTH-TABLE.
002080         10  FILLER              PIC X(9)   VALUE '  JANUARY'.
002090         10  FILLER              PIC X(9)   VALUE ' FEBURARY'.
002100         10  FILLER              PIC X(9)   VALUE '    MARCH'.
002110         10  FILLER              PIC X(9)   VALUE '    APRIL'.
002120         10  FILLER              PIC X(9)   VALUE '      MAY'.
002130         10  FILLER              PIC X(9)   VALUE '     JUNE'.
002140         10  FILLER              PIC X(9)   VALUE '     JULY'.
002150         10  FILLER              PIC X(9)   VALUE '   AUGUST'.
002160         10  FILLER              PIC X(9)   VALUE 'SEPTEMBER'.
002170         10  FILLER              PIC X(9)   VALUE '  OCTOBER'.
002180         10  FILLER              PIC X(9)   VALUE ' NOVEMBER'.
002190         10  FILLER              PIC X(9)   VALUE ' DECEMBER'.
002200     05  MONTH-NAMES REDEFINES MONTH-TABLE.
002210         10  MONTH-NAME OCCURS 12 TIMES  PIC X(9).
002220     EJECT
002230     05  AUDIT-RECORD-LAYOUT.
002240         10  FILLER              PIC X(60).
002250         10  AUDIT-RECORD-DATA.
002260             15  AR-ID           PIC X(6).
002270                 88  AUDIT-RECORD            VALUE '$AUDIT'.
002280             15  AR-AUDATE       PIC S9(6)                COMP-3.
002290             15  AR-AUDTIM       PIC S9(6)                COMP-3.
002300             15  AR-TERMID       PIC X(4).
002310             15  AR-LUNME        PIC X(8).
002320             15  AR-TRMLOC       PIC X(19).
002330             15  AR-WRMIND       PIC X.
002340             15  AR-TYPE         PIC 99.
002350                88  E1-SIGNON               VALUE 10.
002360                88  SYSTEM-SIGNON           VALUE 15.
002370                88  TRANSACTION-REQUEST     VALUE 20.
002380                88  TRANSACTION-ENDED       VALUE 25.
002390                88  E1-SIGNOFF              VALUE 30.
002400             15  AR-SECDE        PIC 99.
002410                 88  NO-VIOLATION                VALUE 00.
002420             15  AR-E1SON        PIC S9(6)                COMP-3.
002430             15  AR-SYSID        PIC XXX.
002440             15  AR-USERID.
002450                 20  FILLER          PIC X(3).
002460                 20  AR-RACF-ID      PIC X.
002470                     88  NOT-RACF-ID  VALUE ' '.
002480                 20  AR-USER-RACF    PIC X.
002490                     88  RACF-USER   VALUE 'r'.
002500*                    88  RACF-USER   VALUE X'99'.
002510                 20  FILLER          PIC X(3).
002520             15  AR-USERID-RACF REDEFINES AR-USERID.
002530                 20  AR-USER-GRP-ID  PIC XX.
002540                 20  FILLER          PIC XX.
002550             15  AR-SYSSON       PIC S9(6)                COMP-3.
002560             15  AR-LSTDTE       PIC S9(6)                COMP-3.
002570             15  AR-LSTTIM       PIC S9(4)                COMP-3.
002580             15  AR-TRANID       PIC X(4).
002590             15  AR-PGMENT       PIC X(8).
002600             15  AR-TRNENT       PIC S9(6)                COMP-3.
002610             15  AR-TRNEND       PIC S9(6)                COMP-3.
002620             15  AR-E1SOFF       PIC S9(6)                COMP-3.
002630             15  AR-DBCONT       PIC X.
002640             15  AR-LOCCDE       PIC XXX.
002650             15  AR-LOCCDE-1 REDEFINES AR-LOCCDE PIC X.
002660             15  FILLER          PIC X(24).
002670             15  AR-DBINFO OCCURS 16 TIMES.
002680                 20  AR-DBFILE   PIC X(4).
002690                 20  AR-DBPATH   PIC X(4).
002700                 20  AR-DBREAD   PIC S9(9)                COMP.
002710                 20  AR-DBUPDT   PIC S9(9)                COMP.
002720                 20  AR-DBADD    PIC S9(9)                COMP.
002730                 20  AR-DBDELT   PIC S9(9)                COMP.
002740         10  FILLER REDEFINES AUDIT-RECORD-DATA.
002750             15  FILLER          PIC X(69).
002760             15  AR-ERR15        PIC X(35).
002770         10   FILLER REDEFINES AUDIT-RECORD-DATA.
002780             15  FILLER          PIC X(80).
002790             15  AR-ERR20        PIC X(35).
002800         10  FILLER              PIC X(4).
002810     SKIP3
002820     05  PARM-RECORD-LAYOUT.
002830         10  PARM-REPORT-NO              PIC X.
002840             88  DETAIL-TERMINAL-REPORT      VALUE '1'.
002850             88  DB-STATISTICS-REPORT        VALUE '2'.
002860             88  DB-STATISTICS-REPORT-2      VALUE 'B'.
002870             88  SECURITY-REPORT             VALUE '3'.
002880             88  TRANSACTION-USAGE-REPORT    VALUE '4'.
002890             88  TPNS-REPORT                 VALUE '5'.
002900             88  TPNS-REPORT-2               VALUE 'E'.
002910             88  TERMINAL-USAGE-REPORT       VALUE '6'.
002920             88  USER-REPORT                 VALUE '7'.
002930         10  PARM-SELECTIVES.
002940             15  PARM-SELECT-LOCCDES.
002950                 20  PARM-SELECT-LOC1    PIC X.
002960                 20  PARM-SELECT-LOC2    PIC X.
002970                 20  PARM-SELECT-LOC3    PIC X.
002980                 20  PARM-SELECT-LOC4    PIC X.
002990                 20  PARM-SELECT-LOC5    PIC X.
003000             15  PARM-SELECT-LUNME       PIC X(8).
003010             15  PARM-SELECT-TRANID      PIC X(4).
003020             15  PARM-SELECT-SYSID       PIC X(3).
003030             15  PARM-SELECT-USERID.
003040                 20  PARM-SELECT-USER-GRP-ID     PIC XX.
003050                 20  PARM-SELECT-USER-GRP-IND    PIC XX.
003060             15  PARM-SELECT-OWNERID     PIC X(4).
003070         10  FILLER                      PIC X(19).
003080         10  PARM-AUDIT-PERIOD-START     PIC 9(6).
003090         10  PARM-AUDIT-PERIOD-END       PIC 9(6).
003100         10  PARM-AUDIT-TIME-START       PIC 9(6).
003110         10  PARM-AUDIT-TIME-END         PIC 9(6).
003120         10  FILLER                      PIC X(8).
003130     SKIP3
003140     05  SORT-RECORD-LAYOUT.
003150         10  SR-KEY.
003160             15  SR-SEQUENCE         PIC X(30).
003170             15  FILLER REDEFINES SR-SEQUENCE.
003180                 20  SR-TRANID-K     PIC X(4).
003190                 20  SR-SYSID-K      PIC X(3).
003200             15  FILLER REDEFINES SR-SEQUENCE.
003210                 20  SR-LOCCDE-K     PIC X(3).
003220                 20  SR-TERMINAL-K.
003230                     25  SR-LUNME-K      PIC X(8).
003240                     25  SR-TERMID-K     PIC X(4).
003250                 20  SR-DBFILE-K.
003260                     25  SR-FILE-K   PIC X(4).
003270                     25  SR-PATH-K   PIC X(4).
003280             15  FILLER REDEFINES SR-SEQUENCE.
003290                 20  SR-DBFILE-K2.
003300                     25  SR-FILE-K2  PIC X(4).
003310                     25  SR-PATH-K2  PIC X(4).
003320                 20  SR-TERMINAL-K2.
003330                     25  SR-LUNME-K2     PIC X(8).
003340                     25  SR-TERMID-K2    PIC X(4).
003350             15  FILLER REDEFINES SR-SEQUENCE.
003360                 20  SR-SYSID-K3     PIC XXX.
003370                 20  SR-USERID-K3    PIC X(8).
003380                 20  SR-TERMINAL-K3.
003390                     25  SR-LUNME-K3     PIC X(8).
003400                     25  SR-TERMID-K3    PIC X(4).
003410             15  FILLER REDEFINES SR-SEQUENCE.
003420                 20  SR-SYSID-K4     PIC X(3).
003430                 20  SR-TRANID-K4    PIC X(4).
003440                 20  SR-TERMINAL-K4.
003450                     25  SR-LUNME-K4    PIC X(8).
003460                     25  SR-TERMID-K4   PIC X(4).
003470                 20  SR-USERID-K4    PIC X(8).
003480             15  FILLER REDEFINES SR-SEQUENCE.
003490                 20  SR-TERMINAL-K5.
003500                     25  SR-LUNME-K5    PIC X(8).
003510                     25  SR-TERMID-K5   PIC X(4).
003520                 20  SR-SYSID-K5     PIC X(3).
003530                 20  SR-TRANID-K5    PIC X(4).
003540                 20  SR-USERID-K5    PIC X(8).
003550             15  FILLER REDEFINES SR-SEQUENCE.
003560                 20  SR-OWNERID-K6   PIC X(4).
003570                 20  SR-USERID-K6    PIC X(8).
003580                 20  SR-SYSID-K6     PIC X(3).
003590                 20  SR-TRANID-K6    PIC X(4).
003600             15  SR-AUDATE-K     PIC S9(6)       COMP-3.
003610             15  SR-AUDTIM-K     PIC S9(6)       COMP-3.
003620         10  SR-AUDIT-DATA       PIC X(512).
003630         10  FILLER REDEFINES SR-AUDIT-DATA.
003640             15  SR-DBREAD   PIC S9(9)       COMP.
003650             15  SR-DBUPDT   PIC S9(9)       COMP.
003660             15  SR-DBADD    PIC S9(9)       COMP.
003670             15  SR-DBDELT   PIC S9(9)       COMP.
003680         10  FILLER REDEFINES SR-AUDIT-DATA.
003690             15  SR-USER-OWNERID    PIC X(4).
003700             15  SR-USER-OWNERNME   PIC X(20).
003710             15  SR-USER-USERID     PIC X(8).
003720             15  SR-USER-SYSID      PIC X(8).
003730             15  SR-USER-TRANID     PIC X(4).
003740             15  SR-USER-AUDATE     PIC S9(6)       COMP-3.
003750             15  SR-USER-AUDTIM     PIC S9(6)       COMP-3.
003760     SKIP3
003770     05  WORK-RECORD-LAYOUT  PIC X(60).
003780     05  DB-WORK-RECORD REDEFINES WORK-RECORD-LAYOUT.
003790         10  DB-FILE         PIC X(4).
003800         10  DB-PATH         PIC X(4).
003810         10  DB-AUDATE       PIC S9(6)       COMP-3.
003820         10  DB-DBREAD       PIC S9(9)       COMP.
003830         10  DB-DBUPDT       PIC S9(9)       COMP.
003840         10  DB-DBADD        PIC S9(9)       COMP.
003850         10  DB-DBDELT       PIC S9(9)       COMP.
003860     05  TPNS-WORK-RECORD REDEFINES WORK-RECORD-LAYOUT.
003870         10  TPNS-LOCCDE.
003880             15  TPNS-LOCCDE-1   PIC X.
003890             15  FILLER          PIC XX.
003900         10  TPNS-TERMID     PIC X(4).
003910         10  TPNS-AUDATE     PIC S9(6)       COMP-3.
003920         10  TPNS-AUDTIM     PIC S9(6)       COMP-3.
003930         10  TPNS-LUNME      PIC X(8).
003940         10  TPNS-TRMLOC     PIC X(19).
003950         10  TPNS-DBFILE.
003960             15  TPNS-FILE   PIC X(4).
003970             15  TPNS-PATH   PIC X(4).
003980         10  TPNS-TYPE-IO    PIC X.
003990     EJECT
004000     05  REPORT-TITLE        PIC X(50)       VALUE
004010            '      ENVIRON1 TERMINAL DETAIL AUDIT REPORT      '.
004020     05  HEADING1.
004030         10  FILLER          PIC X           VALUE '1'.
004040         10  FILLER          PIC X(6)        VALUE 'P50281'.
004050         10  FILLER          PIC X(34)       VALUE SPACES.
004060         10  HDG1-TITLE      PIC X(50)       VALUE
004070            'ENVIRON1 AUDIT REPORT SELECTION PARAMETERS       '.
004080         10  FILLER          PIC X(8)        VALUE SPACES.
004090         10  HDG1-DATE       PIC X(8).
004100         10  FILLER          PIC XX          VALUE SPACES.
004110         10  HDG1-TIME       PIC 9(6).
004120         10  FILLER          PIC X(13)       VALUE
004130            '        PAGE '.
004140         10  HDG1-PAGE       PIC ZZZZ9.
004150     05  HEADING1A.
004160         10  FILLER          PIC X           VALUE ' '.
004170         10  FILLER          PIC X(44)       VALUE SPACES.
004180         10  FILLER          PIC X(18)       VALUE
004190            'AUDIT PERIOD FROM '.
004200         10  HDG1A-MONTH     PIC X(10)       VALUE SPACES.
004210         10  HDG1A-DAY       PIC 99          VALUE 0.
004220         10  FILLER          PIC XX          VALUE ', '.
004230         10  FILLER          PIC X           VALUE QUOTE.
004240         10  HDG1A-YR        PIC 99          VALUE 0.
004250         10  FILLER          PIC XX          VALUE SPACES.
004260         10  HDG1A-TIMHH     PIC 99          VALUE 0.
004270         10  FILLER          PIC X           VALUE ':'.
004280         10  HDG1A-TIMMM     PIC 99          VALUE 0.
004290         10  FILLER          PIC X           VALUE ':'.
004300         10  HDG1A-TIMSS     PIC 99          VALUE 0.
004310         10  FILLER          PIC X(43)       VALUE SPACES.
004320     05  HEADING1B.
004330         10  FILLER          PIC X           VALUE ' '.
004340         10  FILLER          PIC X(44)       VALUE SPACES.
004350         10  FILLER          PIC X(18)       VALUE
004360            '               TO '.
004370         10  HDG1B-MONTH     PIC X(10)       VALUE SPACES.
004380         10  HDG1B-DAY       PIC 99          VALUE 0.
004390         10  FILLER          PIC XX          VALUE ', '.
004400         10  FILLER          PIC X           VALUE QUOTE.
004410         10  HDG1B-YR        PIC 99          VALUE 0.
004420         10  FILLER          PIC XX          VALUE SPACES.
004430         10  HDG1B-TIMHH     PIC 99          VALUE 23.
004440         10  FILLER          PIC X           VALUE ':'.
004450         10  HDG1B-TIMMM     PIC 99          VALUE 59.
004460         10  FILLER          PIC X           VALUE ':'.
004470         10  HDG1B-TIMSS     PIC 99          VALUE 59.
004480         10  FILLER          PIC X(43)       VALUE SPACES.
004490     05  HEADING2.
004500         10  FILLER          PIC X           VALUE '0'.
004510         10  FILLER          PIC X(48)       VALUE
004520            'LOGICAL   TERM                      AUDIT    E/1'.
004530         10  FILLER          PIC X(48)       VALUE
004540            '    SYS             SYS.    LAST SIGNON  TRAN   '.
004550         10  FILLER          PIC X(36)       VALUE
004560            'ENTRY    TRAN.    TRAN.    E/1      '.
004570     05  HEADING3.
004580         10  FILLER          PIC X           VALUE ' '.
004590         10  FILLER          PIC X(48)       VALUE
004600            'NAME      ID.   TERMINAL LOCATION   PERIOD  LOGO'.
004610         10  FILLER          PIC X(48)       VALUE
004620            'N   ID.  USER ID.  SIGNON    DATE  TIME   ID.   '.
004630         10  FILLER          PIC X(36)       VALUE
004640            'POINT    ENTERED  ENDED  LOGOFF     '.
004650     05  HEADING4.
004660         10  FILLER          PIC X           VALUE '0'.
004670         10  FILLER          PIC X(48)       VALUE
004680            'TRANS  SYS  AUDIT    TRANS.   FILE PATH  ++++++ '.
004690         10  FILLER          PIC X(48)       VALUE
004700            'READS ++++++   +++++ UPDATES ++++   ++++++ ADDS '.
004710         10  FILLER          PIC X(36)       VALUE
004720            '++++++   +++++ DELETES ++++         '.
004730     05  HEADING5.
004740         10  FILLER          PIC X           VALUE ' '.
004750         10  FILLER          PIC X(48)       VALUE
004760            ' ID.   ID.  PERIOD  ENTER CT              AVERAG'.
004770         10  FILLER          PIC X(48)       VALUE
004780            'E      TOTAL   AVERAGE      TOTAL   AVERAGE     '.
004790         10  FILLER          PIC X(36)       VALUE
004800            ' TOTAL   AVERAGE      TOTAL         '.
004810     05  HEADING6.
004820         10  FILLER          PIC X           VALUE '0'.
004830         10  FILLER          PIC X(48)       VALUE
004840            '            AUDIT  ++++++++ DATA  BASE  STATISTI'.
004850         10  FILLER          PIC X(48)       VALUE
004860            'CS +++++++                                      '.
004870         10  FILLER          PIC X(36)       VALUE SPACES.
004880     05  HEADING7.
004890         10  FILLER          PIC X           VALUE ' '.
004900         10  FILLER          PIC X(48)       VALUE
004910            'FILE PATH  PERIOD      READS   UPDATES      ADDS'.
004920         10  FILLER          PIC X(48)       VALUE
004930            '   DELETES                                      '.
004940         10  FILLER          PIC X(36)       VALUE SPACES.
004950     05  HEADING8.
004960         10  FILLER          PIC X           VALUE '0'.
004970         10  FILLER          PIC X(48)       VALUE
004980            'SYS                                             '.
004990         10  FILLER          PIC X(48)       VALUE
005000            '    AUDIT     TIME   TRAN                       '.
005010         10  FILLER          PIC X(36)       VALUE SPACES.
005020     05  HEADING9.
005030         10  FILLER          PIC X           VALUE ' '.
005040         10  FILLER          PIC X(48)       VALUE
005050            'ID. USER ID. ++++++NAME++++++  TERMINAL LOCATION'.
005060         10  FILLER          PIC X(48)       VALUE
005070            '    PERIOD    OCCUR   ID. +++++DESCRIPTION+++++ '.
005080         10  FILLER          PIC X(36)       VALUE
005090            ' ++++++++SECURITY DESCRIPTION+++++++'.
005100     05  HEADING10.
005110         10  FILLER          PIC X           VALUE '0'.
005120         10  FILLER          PIC X(48)       VALUE
005130            '                        LOGICAL   TERM          '.
005140         10  FILLER          PIC X(48)       VALUE
005150            '             AUDIT              TYPE            '.
005160         10  FILLER          PIC X(36)       VALUE SPACES.
005170     05  HEADING11.
005180         10  FILLER          PIC X           VALUE ' '.
005190         10  FILLER          PIC X(48)       VALUE
005200            '++++++ LOCATION ++++++  NAME       ID   TERMINAL'.
005210         10  FILLER          PIC X(48)       VALUE
005220            ' LOCATION    PERIOD  FILE PATH  I/O             '.
005230         10  FILLER          PIC X(36)       VALUE SPACES.
005240     05  HEADING12.
005250         10  FILLER          PIC X           VALUE '0'.
005260         10  FILLER          PIC X(48)       VALUE
005270            '            TYPE  LOGICAL   TERM                '.
005280         10  FILLER          PIC X(48)       VALUE
005290            '       AUDIT                                    '.
005300         10  FILLER          PIC X(36)       VALUE SPACES.
005310     05  HEADING13.
005320         10  FILLER          PIC X           VALUE ' '.
005330         10  FILLER          PIC X(48)       VALUE
005340            'FILE PATH   I/O   NAME       ID   TERMINAL LOCAT'.
005350         10  FILLER          PIC X(48)       VALUE
005360            'ION    PERIOD                                   '.
005370         10  FILLER          PIC X(36)       VALUE SPACES.
005380     05  HEADING14.
005390         10  FILLER          PIC X           VALUE '0'.
005400         10  FILLER          PIC X(48)       VALUE
005410            'SYS  TRAN                               TRAN    '.
005420         10  FILLER          PIC X(48)       VALUE
005430            '                     LOGICAL                    '.
005440         10  FILLER          PIC X(36)       VALUE
005450            '           AUDIT     TIMES REQUESTED'.
005460     05  HEADING15.
005470         10  FILLER          PIC X           VALUE ' '.
005480         10  FILLER          PIC X(48)       VALUE
005490            'ID.   ID.  +++++++DESCRIPTION+++++++   ENTER CT '.
005500         10  FILLER          PIC X(48)       VALUE
005510            ' TERMINAL LOCATION   NAME      USER ID. ++++++NA'.
005520         10  FILLER          PIC X(36)       VALUE
005530            'ME+++++++  PERIOD    FIRST  LAST    '.
005540     05  HEADING16.
005550         10  FILLER          PIC X           VALUE '0'.
005560         10  FILLER          PIC X(48)       VALUE
005570            'LOGICAL                       SYS  TRAN         '.
005580         10  FILLER          PIC X(48)       VALUE
005590            '                                                '.
005600         10  FILLER          PIC X(36)       VALUE
005610            'AUDIT       TRAN                    '.
005620     05  HEADING17.
005630         10  FILLER          PIC X           VALUE ' '.
005640         10  FILLER          PIC X(48)       VALUE
005650            'NAME     TERMINAL LOCATION    ID.   ID.  +++++++'.
005660         10  FILLER          PIC X(48)       VALUE
005670            'DESCRIPTION+++++++  USER ID. ++++++NAME+++++++  '.
005680         10  FILLER          PIC X(36)       VALUE
005690            'PERIOD    ENTER CT                  '.
005700     05  HEADING18.
005710         10  FILLER          PIC X           VALUE '0'.
005720         10  FILLER          PIC X(49)       VALUE SPACES.
005730         10  FILLER          PIC X(6)        VALUE 'OWNER '.
005740         10  HDG18-OWNERID   PIC X(6)        VALUE SPACES.
005750         10  HDG18-OWNERNME  PIC X(20)       VALUE SPACES.
005760         10  FILLER          PIC X(51)       VALUE SPACES.
005770     05  HEADING19.
005780         10  FILLER          PIC X           VALUE '0'.
005790         10  FILLER          PIC X(29)       VALUE SPACES.
005800         10  FILLER          PIC X(9)        VALUE 'SYS  TRAN'.
005810         10  FILLER          PIC X(36)       VALUE SPACES.
005820         10  FILLER          PIC X(4)        VALUE 'TRAN'.
005830         10  FILLER          PIC X(50)       VALUE SPACES.
005840     05  HEADING20.
005850         10  FILLER          PIC X           VALUE ' '.
005860         10  FILLER          PIC X(48)       VALUE
005870            'USER ID.  ++++++NAME+++++++  ID.   ID.  ++++++++'.
005880         10  FILLER          PIC X(48)       VALUE
005890            '++DESCRIPTION+++++++++   ENTER CT               '.
005900         10  FILLER          PIC X(36)       VALUE SPACES.
005910     SKIP3
005920     05  DET-LINE.
005930         10  DET-CNTL        PIC X.
005940         10  DET-LUNME       PIC X(8).
005950         10  FILLER          PIC XX.
005960         10  DET-TERMID      PIC X(4).
005970         10  FILLER          PIC XX.
005980         10  DET-TRMLOC      PIC X(19).
005990         10  FILLER          PIC X.
006000         10  DET-AUDATE      PIC 9(6).
006010         10  FILLER          PIC XX.
006020         10  DET-E1SON       PIC 9(6).
006030         10  FILLER          PIC XX.
006040         10  DET-SYSID       PIC XXX.
006050         10  FILLER          PIC XX.
006060         10  DET-USERID      PIC X(8).
006070         10  FILLER          PIC XX.
006080         10  DET-ERR15.
006090             15  DET-SYSSON      PIC 9(6).
006100             15  FILLER          PIC XX.
006110             15  DET-LSTDTE      PIC 9(6).
006120             15  FILLER          PIC XX.
006130             15  DET-LSTTIM      PIC 9(4).
006140             15  FILLER          PIC XX.
006150             15  DET-TRANID      PIC X(4).
006160             15  FILLER          PIC XX.
006170             15  DET-ERR20.
006180                 20  DET-PGMENT      PIC X(8).
006190                 20  FILLER          PIC XX.
006200                 20  DET-TRNENT      PIC 9(6).
006210                 20  FILLER          PIC XXX.
006220                 20  DET-TRNEND      PIC 9(6).
006230                 20  FILLER          PIC XX.
006240                 20  DET-E1SOFF      PIC 9(6).
006250                 20  FILLER          PIC X(4).
006260     05  FILLER REDEFINES DET-LINE.
006270         10  FILLER                  PIC X.
006280         10  DET-DBTRANID            PIC X(4).
006290         10  FILLER                  PIC XXX.
006300         10  DET-DBSYSID             PIC XXX.
006310         10  FILLER                  PIC XX.
006320         10  DET-DBAUDATE            PIC 9(6).
006330         10  FILLER                  PIC XX.
006340         10  DET-DBTRANCT            PIC Z(7).
006350         10  FILLER                  PIC XXX.
006360         10  DET-DBFILE              PIC X(4).
006370         10  FILLER                  PIC X.
006380         10  DET-DBPATH              PIC X(4).
006390         10  FILLER                  PIC XX.
006400         10  DET-DBREAD-AVGE         PIC Z(6).9.
006410         10  FILLER                  PIC XX.
006420         10  DET-DBREAD              PIC Z(9).
006430         10  FILLER                  PIC X.
006440         10  DET-DBUPDT-AVGE         PIC Z(7).9.
006450         10  FILLER                  PIC XX.
006460         10  DET-DBUPDT              PIC Z(9).
006470         10  FILLER                  PIC X.
006480         10  DET-DBADD-AVGE          PIC Z(7).9.
006490         10  FILLER                  PIC XX.
006500         10  DET-DBADD               PIC Z(9).
006510         10  FILLER                  PIC X.
006520         10  DET-DBDELT-AVGE         PIC Z(7).9.
006530         10  FILLER                  PIC XX.
006540         10  DET-DBDELT              PIC Z(9).
006550     05  FILLER REDEFINES DET-LINE.
006560         10  FILLER                  PIC X.
006570         10  DET-DBFILE-2            PIC X(4).
006580         10  FILLER                  PIC X.
006590         10  DET-DBPATH-2            PIC X(4).
006600         10  FILLER                  PIC XX.
006610         10  DET-DBAUDATE-2          PIC 9(6).
006620         10  FILLER                  PIC XX.
006630         10  DET-DBREAD-2            PIC Z(9).
006640         10  FILLER                  PIC X.
006650         10  DET-DBUPDT-2            PIC Z(9).
006660         10  FILLER                  PIC X.
006670         10  DET-DBADD-2             PIC Z(9).
006680         10  FILLER                  PIC X.
006690         10  DET-DBDELT-2            PIC Z(9).
006700     05  FILLER REDEFINES DET-LINE.
006710         10  FILLER                  PIC X.
006720         10  FILLER                  PIC X(29).
006730         10  DET-DBTOTAL-DESC        PIC X(10).
006740     05  FILLER REDEFINES DET-LINE.
006750         10  FILLER                  PIC X.
006760         10  DET-SVSYSID             PIC XXX.
006770         10  FILLER                  PIC X.
006780         10  DET-SVUSERID            PIC X(8).
006790         10  FILLER                  PIC X .
006800         10  DET-SVUSERNME           PIC X(17).
006810         10  FILLER                  PIC X.
006820         10  DET-SVTRMLOC            PIC X(19).
006830         10  FILLER                  PIC XX.
006840         10  DET-SVAUDMON            PIC 99.
006850         10  DET-SVSLASH1            PIC X.
006860         10  DET-SVAUDDAY            PIC 99.
006870         10  DET-SVSLASH2            PIC X.
006880         10  DET-SVAUDYR             PIC 99.
006890         10  FILLER                  PIC XX.
006900         10  DET-SVTIMHH             PIC 99.
006910         10  DET-SVTIMCOLON          PIC X.
006920         10  DET-SVTIMMM             PIC 99.
006930         10  FILLER                  PIC XX.
006940         10  DET-SVTRANID            PIC X(4).
006950         10  FILLER                  PIC X.
006960         10  DET-SVTRANDESC          PIC X(21).
006970         10  FILLER                  PIC XX.
006980         10  DET-SVERR               PIC X(35).
006990     05  FILLER REDEFINES DET-LINE.
007000         10  FILLER                  PIC X.
007010         10  DET-TRANS-SYSID         PIC X(3).
007020         10  FILLER                  PIC XX.
007030         10  DET-TRANS-TRANID        PIC X(4).
007040         10  FILLER                  PIC XX.
007050         10  DET-TRANS-TRANDESC      PIC X(25).
007060         10  FILLER                  PIC X.
007070         10  DET-TRANS-TRANCT        PIC Z(9)9.
007080         10  FILLER                  PIC XX.
007090         10  DET-TRANS-TRMLOC        PIC X(19).
007100         10  FILLER                  PIC X.
007110         10  DET-TRANS-LUNME         PIC X(8).
007120         10  FILLER                  PIC XX.
007130         10  DET-TRANS-USERID        PIC X(8).
007140         10  FILLER                  PIC X.
007150         10  DET-TRANS-USERNME       PIC X(17).
007160         10  FILLER                  PIC XX.
007170         10  DET-TRANS-AUDMON        PIC 99.
007180         10  DET-TRANS-SLASH1        PIC X.
007190         10  DET-TRANS-AUDDAY        PIC 99.
007200         10  DET-TRANS-SLASH2        PIC X.
007210         10  DET-TRANS-AUDYR         PIC 99.
007220         10  FILLER                  PIC XX.
007230         10  DET-TRANS-F-TIMHH       PIC 99.
007240         10  DET-TRANS-COLON1        PIC X.
007250         10  DET-TRANS-F-TIMMM       PIC 99.
007260         10  FILLER                  PIC XX.
007270         10  DET-TRANS-L-TIMHH       PIC 99.
007280         10  DET-TRANS-COLON2        PIC X.
007290         10  DET-TRANS-L-TIMMM       PIC 99.
007300     05  FILLER REDEFINES DET-LINE.
007310         10  FILLER                  PIC X.
007320         10  DET-TRANS-TOTAL-DESC    PIC X(36) JUSTIFIED RIGHT.
007330     05  FILLER REDEFINES DET-LINE.
007340         10  FILLER                  PIC X.
007350         10  DET-TPNS-CTLLOC         PIC X(22).
007360         10  FILLER                  PIC XX.
007370         10  DET-TPNS-LUNME          PIC X(8).
007380         10  FILLER                  PIC XX.
007390         10  DET-TPNS-TERMID         PIC X(4).
007400         10  FILLER                  PIC XX.
007410         10  DET-TPNS-TRMLOC         PIC X(19).
007420         10  FILLER                  PIC XX.
007430         10  DET-TPNS-AUDATE         PIC 9(6).
007440         10  FILLER                  PIC XX.
007450         10  DET-TPNS-FILE           PIC X(4).
007460         10  FILLER                  PIC X.
007470         10  DET-TPNS-PATH           PIC X(4).
007480         10  FILLER                  PIC X(3).
007490         10  DET-TPNS-TYPE           PIC X.
007500     05  FILLER REDEFINES DET-LINE.
007510         10  FILLER                  PIC X.
007520         10  DET-TPNS-FILE-2         PIC X(4).
007530         10  FILLER                  PIC X.
007540         10  DET-TPNS-PATH-2         PIC X(4).
007550         10  FILLER                  PIC X(4).
007560         10  DET-TPNS-TYPE-2         PIC X.
007570         10  FILLER                  PIC X(4).
007580         10  DET-TPNS-LUNME-2        PIC X(8).
007590         10  FILLER                  PIC XX.
007600         10  DET-TPNS-TERMID-2       PIC X(4).
007610         10  FILLER                  PIC XX.
007620         10  DET-TPNS-TRMLOC-2       PIC X(19).
007630         10  FILLER                  PIC XX.
007640         10  DET-TPNS-AUDATE-2       PIC 9(6).
007650     05  FILLER REDEFINES DET-LINE.
007660         10  FILLER                  PIC X.
007670         10  DET-TERMU-LUNME         PIC X(8).
007680         10  FILLER                  PIC X.
007690         10  DET-TERMU-TRMLOC        PIC X(19).
007700         10  FILLER                  PIC XX.
007710         10  DET-TERMU-SYSID         PIC XXX.
007720         10  FILLER                  PIC XX.
007730         10  DET-TERMU-TRANID        PIC XXXX.
007740         10  FILLER                  PIC XX.
007750         10  DET-TERMU-TRANDESC      PIC X(25).
007760         10  FILLER                  PIC XX.
007770         10  DET-TERMU-USERID        PIC X(8).
007780         10  FILLER                  PIC X.
007790         10  DET-TERMU-USERNME       PIC X(17).
007800         10  FILLER                  PIC XX.
007810         10  DET-TERMU-AUDMON        PIC 99.
007820         10  DET-TERMU-SLASH1        PIC X.
007830         10  DET-TERMU-AUDDAY        PIC 99.
007840         10  DET-TERMU-SLASH2        PIC X.
007850         10  DET-TERMU-AUDYR         PIC 99.
007860         10  FILLER                  PIC X.
007870         10  DET-TERMU-TRANCT        PIC Z(9).
007880     05  FILLER REDEFINES DET-LINE.
007890         10  FILLER                  PIC X.
007900         10  DET-USER-USERID         PIC X(8).
007910         10  FILLER                  PIC XX.
007920         10  DET-USER-USERNME        PIC X(17).
007930         10  FILLER                  PIC XX.
007940         10  DET-USER-SYSID          PIC XXX.
007950         10  FILLER                  PIC XX.
007960         10  DET-USER-TRANID         PIC X(4).
007970         10  FILLER                  PIC XX.
007980         10  DET-USER-TRANDESC       PIC X(30).
007990         10  FILLER                  PIC XX.
008000         10  DET-USER-TRANCT         PIC Z(9).
008010         10  FILLER                  PIC XX.
008020         10  DET-USER-TRANCT-DESC    PIC X(26).
008030     05  FILLER REDEFINES DET-LINE.
008040         10  DET-PARM-DESC           PIC X(21).
008050         10  DET-PARM-VALUE          PIC X(10).
008060         10  DET-PARM-VALUE1 REDEFINES DET-PARM-VALUE  PIC 9(6).
008070     SKIP3
008080     05  LAST-LINE.
008090         10  FILLER                  PIC X        VALUE '-'.
008100         10  FILLER                  PIC X(57)    VALUE ALL '*'.
008110         10  FILLER                  PIC X(17)    VALUE
008120            '  END OF REPORT  '.
008130         10  FILLER                  PIC X(58)    VALUE ALL '*'.
008140     EJECT
008150 PROCEDURE DIVISION.
008160     OPEN INPUT E1-AUDIT-FILE
008170          INPUT PARM-FILE
008180         OUTPUT PRINTER-FILE.
008190     MOVE CURRENT-DATE TO HDG1-DATE.
008200     MOVE TIME-OF-DAY TO HDG1-TIME.
008210     MOVE SPACES TO DET-LINE.
008220     PERFORM REPORT-SELECT THRU REPORT-SELECT-EX.
008230     IF DETAIL-TERMINAL-REPORT GO TO DETAIL-TERMINAL-REPT.
008240     IF DB-STATISTICS-REPORT GO TO DB-STATISTICS-REPT.
008250     IF SECURITY-REPORT GO TO SECURITY-VIOLATION-REPT.
008260     IF TRANSACTION-USAGE-REPORT GO TO TRANSACTION-USAGE-REPT.
008270     IF TERMINAL-USAGE-REPORT GO TO TERMINAL-USAGE-REPT.
008280     IF TPNS-REPORT GO TO TPNS-REPT.
008290     IF USER-REPORT GO TO USER-USAGE-REPT.
008300     EJECT
008310 DETAIL-TERMINAL-REPT SECTION.
008320     SORT SORT-FILE ASCENDING KEY SORT-KEY
008330         INPUT PROCEDURE DET-TERM-SORT
008340             THRU DET-TERM-SORT-EX
008350         OUTPUT PROCEDURE DET-TERM-REPORT
008360             THRU DET-TERM-REPORT-EX.
008370     GO TO END-OF-JOB.
008380     SKIP3
008390 DET-TERM-SORT SECTION.
008400     MOVE SPACES TO SORT-RECORD-LAYOUT.
008410 DET-TERM-RECORD-SELECT.
008420     PERFORM READ-AUDIT THRU READ-AUDIT-EX.
008430     IF AUDIT-RECORD-DATA = HIGH-VALUES GO TO DET-TERM-SORT-EX.
008440     IF PARM-SELECT-LOCCDES = SPACES GO TO DET-TERM-CHECK-LUNME.
008450     IF PARM-SELECT-LOC1 = AR-LOCCDE-1
008460          GO TO DET-TERM-CHECK-LUNME.
008470     IF PARM-SELECT-LOC2 = AR-LOCCDE-1
008480          GO TO DET-TERM-CHECK-LUNME.
008490     IF PARM-SELECT-LOC3 = AR-LOCCDE-1
008500          GO TO DET-TERM-CHECK-LUNME.
008510     IF PARM-SELECT-LOC4 = AR-LOCCDE-1
008520          GO TO DET-TERM-CHECK-LUNME.
008530     IF PARM-SELECT-LOC5 = AR-LOCCDE-1
008540          GO TO DET-TERM-CHECK-LUNME.
008550     GO TO DET-TERM-RECORD-SELECT.
008560 DET-TERM-CHECK-LUNME.
008570     IF PARM-SELECT-LUNME = SPACES GO TO DET-TERM-BUILD-SORT.
008580     IF AR-LUNME NOT = PARM-SELECT-LUNME
008590          GO TO DET-TERM-RECORD-SELECT.
008600 DET-TERM-BUILD-SORT.
008610     MOVE AR-LUNME TO SR-LUNME-K.
008620     MOVE AR-TERMID TO SR-TERMID-K.
008630     MOVE AR-AUDATE TO SR-AUDATE-K.
008640     MOVE AR-AUDTIM TO SR-AUDTIM-K.
008650     MOVE AUDIT-RECORD-DATA TO SR-AUDIT-DATA.
008660     RELEASE SORT-RECORD FROM SORT-RECORD-LAYOUT.
008670     GO TO DET-TERM-RECORD-SELECT.
008680 DET-TERM-SORT-EX.
008690     SKIP3
008700 DET-TERM-REPORT SECTION.
008710     PERFORM HDG-ROUTINE THRU HDG-ROUTINE-EX.
008720     PERFORM READ-SORTED THRU READ-SORTED-EX.
008730     MOVE SR-AUDIT-DATA TO AUDIT-RECORD-DATA.
008740 CHECK-RECORD-TYPE.
008750     IF AUDIT-RECORD-DATA = HIGH-VALUES
008760         GO TO DET-TERM-REPORT-EX.
008770     IF SYSTEM-SIGNON GO TO SYSTEM-SIGNON-RECORD.
008780     IF TRANSACTION-REQUEST GO TO TRANS-REQUEST-RECORD.
008790     IF TRANSACTION-ENDED GO TO TRANS-ENDED-RECORD.
008800     IF E1-SIGNOFF GO TO E1-SIGNOFF-RECORD.
008810 E1-SIGNON-RECORD.
008820     MOVE AR-TERMID TO DET-TERMID
008830                       PREV-TERMID.
008840     MOVE AR-LUNME TO DET-LUNME
008850                      PREV-LUNME.
008860     MOVE AR-TRMLOC TO DET-TRMLOC
008870                       PREV-TRMLOC.
008880     MOVE AR-AUDATE TO DET-AUDATE
008890                       PREV-AUDATE.
008900 CHECK-AUDATE.
008910     IF AR-AUDATE NOT = PREV-AUDATE
008920         MOVE AR-AUDATE TO DET-AUDATE
008930                           PREV-AUDATE.
008940     MOVE AR-E1SON TO DET-E1SON.
008950     PERFORM READ-SORTED THRU READ-SORTED-EX.
008960     MOVE SR-AUDIT-DATA TO AUDIT-RECORD-DATA.
008970     IF AR-LUNME NOT = PREV-LUNME
008980         PERFORM PRINT-DETLINE THRU PRINT-DETLINE-EX
008990         GO TO CHECK-RECORD-TYPE.
009000     IF AR-TERMID NOT = PREV-TERMID
009010         PERFORM PRINT-DETLINE THRU PRINT-DETLINE-EX
009020         GO TO CHECK-RECORD-TYPE.
009030     IF SYSTEM-SIGNON GO TO SYSTEM-SIGNON-RECORD.
009040     IF TRANSACTION-REQUEST GO TO TRANS-REQUEST-RECORD.
009050     IF TRANSACTION-ENDED GO TO TRANS-ENDED-RECORD.
009060     IF E1-SIGNOFF GO TO E1-SIGNOFF-RECORD.
009070     PERFORM PRINT-DETLINE THRU PRINT-DETLINE-EX.
009080     GO TO CHECK-AUDATE.
009090 SYSTEM-SIGNON-RECORD.
009100     MOVE AR-SYSID TO DET-SYSID
009110                      PREV-SYSID.
009120     MOVE AR-USERID TO DET-USERID
009130                      PREV-USERID.
009140     EXAMINE DET-USERID REPLACING ALL 'r' BY ' '.
009150     IF NO-VIOLATION
009160         MOVE AR-SYSSON TO DET-SYSSON
009170         MOVE AR-LSTDTE TO DET-LSTDTE
009180         MOVE AR-LSTTIM TO DET-LSTTIM
009190         ELSE
009200         MOVE AR-ERR15 TO DET-ERR15.
009210     IF AR-AUDATE NOT = PREV-AUDATE
009220         MOVE AR-AUDATE TO DET-AUDATE
009230                           PREV-AUDATE.
009240     PERFORM READ-SORTED THRU READ-SORTED-EX.
009250     MOVE SR-AUDIT-DATA TO AUDIT-RECORD-DATA.
009260     IF AR-LUNME NOT = PREV-LUNME
009270         PERFORM PRINT-DETLINE THRU PRINT-DETLINE-EX
009280         GO TO CHECK-RECORD-TYPE.
009290     IF AR-TERMID NOT = PREV-TERMID
009300         PERFORM PRINT-DETLINE THRU PRINT-DETLINE-EX
009310         GO TO CHECK-RECORD-TYPE.
009320     IF TRANSACTION-REQUEST GO TO TRANS-REQUEST-RECORD.
009330     IF TRANSACTION-ENDED GO TO TRANS-ENDED-RECORD.
009340     IF E1-SIGNOFF GO TO E1-SIGNOFF-RECORD.
009350     PERFORM PRINT-DETLINE THRU PRINT-DETLINE-EX.
009360     IF E1-SIGNON GO TO CHECK-AUDATE.
009370     GO TO SYSTEM-SIGNON-RECORD.
009380 TRANS-REQUEST-RECORD.
009390     MOVE AR-TRANID TO DET-TRANID
009400                       PREV-TRANID.
009410     IF NO-VIOLATION
009420         MOVE AR-PGMENT TO DET-PGMENT
009430         MOVE AR-TRNENT TO DET-TRNENT
009440         ELSE
009450         MOVE AR-ERR20 TO DET-ERR20.
009460     IF AR-AUDATE NOT = PREV-AUDATE
009470         MOVE AR-AUDATE TO DET-AUDATE
009480                           PREV-AUDATE.
009490     PERFORM READ-SORTED THRU READ-SORTED-EX.
009500     MOVE SR-AUDIT-DATA TO AUDIT-RECORD-DATA.
009510     IF AR-LUNME NOT = PREV-LUNME
009520         PERFORM PRINT-DETLINE THRU PRINT-DETLINE-EX
009530         GO TO CHECK-RECORD-TYPE.
009540     IF AR-TERMID NOT = PREV-TERMID
009550         PERFORM PRINT-DETLINE THRU PRINT-DETLINE-EX
009560         GO TO CHECK-RECORD-TYPE.
009570     IF TRANSACTION-ENDED GO TO TRANS-ENDED-RECORD.
009580     IF E1-SIGNOFF GO TO E1-SIGNOFF-RECORD.
009590     PERFORM PRINT-DETLINE THRU PRINT-DETLINE-EX.
009600     IF E1-SIGNON GO TO CHECK-AUDATE.
009610     IF SYSTEM-SIGNON GO TO SYSTEM-SIGNON-RECORD.
009620     GO TO TRANS-REQUEST-RECORD.
009630 TRANS-ENDED-RECORD.
009640     MOVE AR-TRNEND TO DET-TRNEND.
009650     IF AR-AUDATE NOT = PREV-AUDATE
009660         MOVE AR-AUDATE TO DET-AUDATE
009670                           PREV-AUDATE.
009680 BYPASS-DBCONT.
009690     PERFORM READ-SORTED THRU READ-SORTED-EX.
009700     MOVE SR-AUDIT-DATA TO AUDIT-RECORD-DATA.
009710     IF AR-LUNME NOT = PREV-LUNME
009720          PERFORM PRINT-DETLINE THRU PRINT-DETLINE-EX
009730          GO TO CHECK-RECORD-TYPE.
009740     IF AR-TERMID NOT = PREV-TERMID
009750          PERFORM PRINT-DETLINE THRU PRINT-DETLINE-EX
009760          GO TO CHECK-RECORD-TYPE.
009770     IF TRANSACTION-ENDED AND
009780          AR-DBCONT = 'C' GO TO BYPASS-DBCONT.
009790     IF E1-SIGNOFF GO TO E1-SIGNOFF-RECORD.
009800     PERFORM PRINT-DETLINE THRU PRINT-DETLINE-EX.
009810     IF E1-SIGNON GO TO CHECK-AUDATE.
009820     IF SYSTEM-SIGNON GO TO SYSTEM-SIGNON-RECORD.
009830     IF TRANSACTION-REQUEST GO TO TRANS-REQUEST-RECORD.
009840     GO TO TRANS-ENDED-RECORD.
009850 E1-SIGNOFF-RECORD.
009860     MOVE AR-E1SOFF TO DET-E1SOFF.
009870     IF AR-AUDATE NOT = PREV-AUDATE
009880         MOVE AR-AUDATE TO DET-AUDATE
009890                           PREV-AUDATE.
009900     PERFORM READ-SORTED THRU READ-SORTED-EX.
009910     MOVE SR-AUDIT-DATA TO AUDIT-RECORD-DATA.
009920     PERFORM PRINT-DETLINE THRU PRINT-DETLINE-EX.
009930     IF AR-LUNME NOT = PREV-LUNME
009940         GO TO CHECK-RECORD-TYPE.
009950     IF AR-TERMID NOT = PREV-TERMID
009960         GO TO CHECK-RECORD-TYPE.
009970     IF E1-SIGNON GO TO CHECK-AUDATE.
009980     IF SYSTEM-SIGNON GO TO SYSTEM-SIGNON-RECORD.
009990     IF TRANSACTION-REQUEST GO TO TRANS-REQUEST-RECORD.
010000     IF TRANSACTION-ENDED GO TO TRANS-ENDED-RECORD.
010010     GO TO E1-SIGNOFF-RECORD.
010020 DET-TERM-REPORT-EX.
010030     EJECT
010040 DB-STATISTICS-REPT SECTION.
010050     SORT SORT-FILE ASCENDING KEY SORT-KEY
010060         INPUT PROCEDURE DB-STATS-TRAN-SORT
010070             THRU DB-STATS-TRAN-SORT-EX
010080         OUTPUT PROCEDURE DB-STATS-TRAN-REPORT
010090             THRU DB-STATS-TRAN-REPORT-EX.
010100     SORT SORT-FILE
010110          ASCENDING SORT-KEY
010120              INPUT PROCEDURE DB-STATS-FILE-SORT
010130                  THRU DB-STATS-FILE-SORT-EX
010140              OUTPUT PROCEDURE DB-STATS-FILE-REPORT
010150                  THRU DB-STATS-FILE-REPORT-EX.
010160     GO TO END-OF-JOB.
010170     SKIP3
010180 DB-STATS-TRAN-SORT SECTION.
010190     MOVE SPACES TO SORT-RECORD-LAYOUT.
010200 DB-STATS-TRAN-SELECT.
010210     PERFORM READ-AUDIT THRU READ-AUDIT-EX.
010220     IF AUDIT-RECORD-DATA = HIGH-VALUES
010230         GO TO DB-STATS-TRAN-SORT-EX.
010240     IF NOT TRANSACTION-ENDED GO TO DB-STATS-TRAN-SELECT.
010250     IF AR-DBFILE (1) = '$END' GO TO DB-STATS-TRAN-SELECT.
010260     IF PARM-SELECT-LOCCDES = SPACES
010270         GO TO DB-STATS-TRAN-CHECK-TRANID.
010280     IF PARM-SELECT-LOC1 = AR-LOCCDE-1
010290         GO TO DB-STATS-TRAN-CHECK-TRANID.
010300     IF PARM-SELECT-LOC2 = AR-LOCCDE-1
010310         GO TO DB-STATS-TRAN-CHECK-TRANID.
010320     IF PARM-SELECT-LOC3 = AR-LOCCDE-1
010330         GO TO DB-STATS-TRAN-CHECK-TRANID.
010340     IF PARM-SELECT-LOC4 = AR-LOCCDE-1
010350         GO TO DB-STATS-TRAN-CHECK-TRANID.
010360     IF PARM-SELECT-LOC5 = AR-LOCCDE-1
010370         GO TO DB-STATS-TRAN-CHECK-TRANID.
010380     GO TO DB-STATS-TRAN-SELECT.
010390 DB-STATS-TRAN-CHECK-TRANID.
010400     IF PARM-SELECT-TRANID = SPACES
010410          GO TO DB-STATS-TRAN-CHECK-SYSID.
010420     IF AR-TRANID NOT = PARM-SELECT-TRANID
010430          GO TO DB-STATS-TRAN-SELECT.
010440     GO TO DB-STATS-TRAN-BUILD-SORT.
010450 DB-STATS-TRAN-CHECK-SYSID.
010460     IF PARM-SELECT-SYSID = SPACES
010470          GO TO DB-STATS-TRAN-BUILD-SORT.
010480     IF AR-SYSID NOT = PARM-SELECT-SYSID
010490          GO TO DB-STATS-TRAN-SELECT.
010500 DB-STATS-TRAN-BUILD-SORT.
010510     MOVE AR-TRANID TO SR-TRANID-K.
010520     MOVE AR-SYSID TO SR-SYSID-K.
010530     MOVE AR-AUDATE TO SR-AUDATE-K.
010540     MOVE AR-AUDTIM TO SR-AUDTIM-K.
010550     MOVE AUDIT-RECORD-DATA TO SR-AUDIT-DATA.
010560     RELEASE SORT-RECORD FROM SORT-RECORD-LAYOUT.
010570     GO TO DB-STATS-TRAN-SELECT.
010580 DB-STATS-TRAN-SORT-EX.
010590     SKIP3
010600 DB-STATS-TRAN-REPORT SECTION.
010610     OPEN OUTPUT WORK-FILE.
010620     MOVE SPACES TO WORK-RECORD-LAYOUT.
010630     PERFORM HDG-ROUTINE THRU HDG-ROUTINE-EX.
010640     MOVE 1 TO DBSUB.
010650     PERFORM DB-CLEAR-STATISTICS 25 TIMES.
010660 DB-GET-STATS-RECORD.
010670     PERFORM READ-SORTED THRU READ-SORTED-EX.
010680     MOVE SR-AUDIT-DATA TO AUDIT-RECORD-DATA.
010690     IF AUDIT-RECORD-DATA = HIGH-VALUES
010700         GO TO DB-DUMP-STATISTICS.
010710 DB-PROCESS-STATS-RECORD.
010720     MOVE AR-TRANID TO DET-DBTRANID
010730                       PREV-TRANID.
010740 DB-PROCESS-SYS-BREAK.
010750     MOVE AR-SYSID TO DET-DBSYSID
010760                      PREV-SYSID.
010770     MOVE AR-AUDATE TO DET-DBAUDATE
010780                       PREV-AUDATE
010790                       DB-AUDATE.
010800     IF AR-DBCONT NOT = 'C'
010810         ADD 1 TO ACC-TRAN-ENTER-CT
010820         ADD 1 TO ACC-TRAN-ENTER-TOTAL.
010830     MOVE 1 TO ARSUB DBSUB.
010840 DB-ACCUM-TOTALS.
010850     ADD AR-DBREAD (ARSUB) TO ACC-TRAN-DBREAD.
010860     ADD AR-DBUPDT (ARSUB) TO ACC-TRAN-DBUPDT.
010870     ADD AR-DBADD (ARSUB) TO ACC-TRAN-DBADD.
010880     ADD AR-DBDELT (ARSUB) TO ACC-TRAN-DBDELT.
010890 DB-FIND-FILE-ENTRY.
010900     IF AR-DBFILE (ARSUB) = DB-STAT-FILE (DBSUB)
010910         AND AR-DBPATH (ARSUB) = DB-STAT-PATH (DBSUB)
010920         ADD AR-DBREAD (ARSUB) TO DB-STAT-READ (DBSUB)
010930         ADD AR-DBUPDT (ARSUB) TO DB-STAT-UPDT (DBSUB)
010940         ADD AR-DBADD  (ARSUB) TO DB-STAT-ADD  (DBSUB)
010950         ADD AR-DBDELT (ARSUB) TO DB-STAT-DELT (DBSUB)
010960         GO TO DB-NEXT-FILE-ENTRY.
010970     IF DB-STAT-FILE (DBSUB) = HIGH-VALUES
010980         MOVE AR-DBFILE (ARSUB) TO DB-STAT-FILE (DBSUB)
010990         MOVE AR-DBPATH (ARSUB) TO DB-STAT-PATH (DBSUB)
011000         MOVE AR-DBREAD (ARSUB) TO DB-STAT-READ (DBSUB)
011010         MOVE AR-DBUPDT (ARSUB) TO DB-STAT-UPDT (DBSUB)
011020         MOVE AR-DBADD  (ARSUB) TO DB-STAT-ADD  (DBSUB)
011030         MOVE AR-DBDELT (ARSUB) TO DB-STAT-DELT (DBSUB)
011040         GO TO DB-NEXT-FILE-ENTRY.
011050     ADD 1 TO DBSUB.
011060     IF DBSUB GREATER THAN 24
011070         ADD AR-DBREAD (ARSUB) TO DB-STAT-READ (DBSUB)
011080         ADD AR-DBUPDT (ARSUB) TO DB-STAT-UPDT (DBSUB)
011090         ADD AR-DBADD  (ARSUB) TO DB-STAT-ADD  (DBSUB)
011100         ADD AR-DBDELT (ARSUB) TO DB-STAT-DELT (DBSUB)
011110         GO TO DB-NEXT-FILE-ENTRY.
011120     GO TO DB-FIND-FILE-ENTRY.
011130 DB-NEXT-FILE-ENTRY.
011140     ADD 1 TO ARSUB.
011150     MOVE 1 TO DBSUB.
011160     IF ARSUB GREATER THAN 16 GO TO DB-NEXT-STATS-RECORD.
011170     IF AR-DBFILE (ARSUB) = '$END' GO TO DB-NEXT-STATS-RECORD.
011180     GO TO DB-ACCUM-TOTALS.
011190 DB-NEXT-STATS-RECORD.
011200     PERFORM READ-SORTED THRU READ-SORTED-EX.
011210     MOVE SR-AUDIT-DATA TO AUDIT-RECORD-DATA.
011220     IF AUDIT-RECORD-DATA = HIGH-VALUES
011230          GO TO DB-DUMP-STATISTICS.
011240     IF NOT TRANSACTION-ENDED GO TO DB-NEXT-STATS-RECORD.
011250     IF AR-DBFILE (1) = '$END' GO TO DB-NEXT-STATS-RECORD.
011260     IF AR-TRANID NOT = PREV-TRANID GO TO DB-DUMP-STATISTICS.
011270     IF AR-SYSID NOT = PREV-SYSID GO TO DB-DUMP-STATISTICS.
011280     IF AR-DBCONT NOT = 'C'
011290         ADD 1 TO ACC-TRAN-ENTER-CT
011300         ADD 1 TO ACC-TRAN-ENTER-TOTAL.
011310     MOVE 1 TO ARSUB DBSUB.
011320     GO TO DB-ACCUM-TOTALS.
011330 DB-DUMP-STATISTICS.
011340     IF DB-STAT-FILE (1)  = HIGH-VALUES
011350          MOVE 'NONE' TO DET-DBFILE
011360          PERFORM PRINT-DETLINE THRU PRINT-DETLINE-EX
011370          GO TO DB-DUMP-TOTALS.
011380     MOVE ACC-TRAN-ENTER-CT TO DET-DBTRANCT.
011390     MOVE 1 TO DBSUB.
011400 DB-DUMP-STATS-LOOP.
011410     IF DBSUB NOT GREATER THAN 24
011420         MOVE DB-STAT-FILE (DBSUB) TO DET-DBFILE
011430         MOVE DB-STAT-PATH (DBSUB) TO DET-DBPATH.
011440     MOVE DET-DBFILE TO DB-FILE.
011450     MOVE DET-DBPATH TO DB-PATH.
011460     MOVE DB-STAT-READ (DBSUB) TO DET-DBREAD
011470                                  DB-DBREAD.
011480     MOVE DB-STAT-UPDT (DBSUB) TO DET-DBUPDT
011490                                  DB-DBUPDT.
011500     MOVE DB-STAT-ADD (DBSUB) TO DET-DBADD
011510                                 DB-DBADD.
011520     MOVE DB-STAT-DELT (DBSUB) TO DET-DBDELT
011530                                  DB-DBDELT.
011540     IF ACC-TRAN-ENTER-CT = ZERO GO TO DB-BYPASS-DETAIL-AVGE.
011550     IF DB-STAT-READ (DBSUB) NOT = ZERO
011560          COMPUTE DET-DBREAD-AVGE = DB-STAT-READ (DBSUB) /
011570               ACC-TRAN-ENTER-CT.
011580     IF DB-STAT-UPDT (DBSUB) NOT = ZERO
011590          COMPUTE DET-DBUPDT-AVGE = DB-STAT-UPDT (DBSUB) /
011600               ACC-TRAN-ENTER-CT.
011610     IF DB-STAT-ADD (DBSUB) NOT = ZERO
011620          COMPUTE DET-DBADD-AVGE = DB-STAT-ADD (DBSUB) /
011630               ACC-TRAN-ENTER-CT.
011640     IF DB-STAT-DELT (DBSUB) NOT = ZERO
011650          COMPUTE DET-DBDELT-AVGE = DB-STAT-DELT (DBSUB) /
011660               ACC-TRAN-ENTER-CT.
011670 DB-BYPASS-DETAIL-AVGE.
011680     WRITE WORK-RECORD FROM DB-WORK-RECORD.
011690     PERFORM PRINT-DETLINE THRU PRINT-DETLINE-EX.
011700     ADD 1 TO DBSUB.
011710     IF DBSUB GREATER THAN 25 GO TO DB-DUMP-TOTALS.
011720     IF DB-STAT-FILE (DBSUB) = HIGH-VALUES
011730         GO TO DB-DUMP-TOTALS.
011740     IF DBSUB GREATER THAN 24
011750         MOVE 'MISC' TO DET-DBFILE.
011760         MOVE '    ' TO DET-DBPATH.
011770     GO TO DB-DUMP-STATS-LOOP.
011780 DB-DUMP-TOTALS.
011790     IF AR-TRANID NOT = PREV-TRANID GO TO DB-DUMP-TRAN-TOTALS.
011800 DB-DUMP-SYS-TOTALS.
011810     MOVE '0' TO DET-CNTL.
011820     MOVE +0 TO ACC-TRAN-ENTER-CT.
011830     MOVE 1 TO DBSUB.
011840     PERFORM DB-CLEAR-STATISTICS 25 TIMES.
011850     GO TO DB-PROCESS-SYS-BREAK.
011860 DB-DUMP-TRAN-TOTALS.
011870     MOVE '0' TO DET-CNTL.
011880     MOVE '**TOTALS**' TO DET-DBTOTAL-DESC.
011890     MOVE ACC-TRAN-ENTER-TOTAL TO DET-DBTRANCT.
011900     MOVE ACC-TRAN-DBREAD TO DET-DBREAD.
011910     MOVE ACC-TRAN-DBUPDT TO DET-DBUPDT.
011920     MOVE ACC-TRAN-DBADD TO DET-DBADD.
011930     MOVE ACC-TRAN-DBDELT TO DET-DBDELT.
011940     IF ACC-TRAN-ENTER-TOTAL = ZERO GO TO DB-BYPASS-TRANS-AVGE.
011950     IF ACC-TRAN-DBREAD NOT = ZERO
011960         COMPUTE DET-DBREAD-AVGE =
011970             ACC-TRAN-DBREAD / ACC-TRAN-ENTER-TOTAL.
011980     IF ACC-TRAN-DBUPDT NOT = ZERO
011990         COMPUTE DET-DBUPDT-AVGE =
012000             ACC-TRAN-DBUPDT / ACC-TRAN-ENTER-TOTAL.
012010     IF ACC-TRAN-DBADD NOT = ZERO
012020         COMPUTE DET-DBADD-AVGE =
012030             ACC-TRAN-DBADD / ACC-TRAN-ENTER-TOTAL.
012040     IF ACC-TRAN-DBDELT NOT = ZERO
012050         COMPUTE DET-DBDELT-AVGE =
012060             ACC-TRAN-DBDELT / ACC-TRAN-ENTER-TOTAL.
012070 DB-BYPASS-TRANS-AVGE.
012080     PERFORM PRINT-DETLINE THRU PRINT-DETLINE-EX.
012090     IF AUDIT-RECORD-DATA NOT = HIGH-VALUES
012100         GO TO DB-CLEAR-TRANS-ACCUMS.
012110     PERFORM PRINT-LAST-LINE THRU LAST-LINE-EX.
012120     CLOSE WORK-FILE.
012130     GO TO DB-STATS-TRAN-REPORT-EX.
012140 DB-CLEAR-TRANS-ACCUMS.
012150     MOVE '0' TO DET-CNTL.
012160     MOVE +0 TO ACC-TRAN-DBREAD
012170                ACC-TRAN-DBUPDT
012180                ACC-TRAN-DBADD
012190                ACC-TRAN-DBDELT
012200                ACC-TRAN-ENTER-TOTAL
012210                ACC-TRAN-ENTER-CT.
012220     MOVE 1 TO DBSUB.
012230     PERFORM DB-CLEAR-STATISTICS 25 TIMES.
012240     GO TO DB-PROCESS-STATS-RECORD.
012250 DB-STATS-TRAN-REPORT-EX.
012260     SKIP3
012270 DB-STATS-FILE-SORT SECTION.
012280     OPEN INPUT WORK-FILE.
012290     MOVE SPACES TO SORT-RECORD-LAYOUT.
012300     MOVE +0 TO SR-AUDTIM-K.
012310 DB-STATS-FILE-SELECT.
012320     READ WORK-FILE INTO DB-WORK-RECORD AT END
012330          CLOSE WORK-FILE
012340          GO TO DB-STATS-FILE-SORT-EX.
012350     MOVE DB-FILE TO SR-FILE-K.
012360     MOVE DB-PATH TO SR-PATH-K.
012370     MOVE DB-AUDATE TO SR-AUDATE-K.
012380     MOVE DB-DBREAD TO SR-DBREAD.
012390     MOVE DB-DBUPDT TO SR-DBUPDT.
012400     MOVE DB-DBADD TO SR-DBADD.
012410     MOVE DB-DBDELT TO SR-DBDELT.
012420     RELEASE SORT-RECORD FROM SORT-RECORD-LAYOUT.
012430     GO TO DB-STATS-FILE-SELECT.
012440 DB-STATS-FILE-SORT-EX.
012450     SKIP3
012460 DB-STATS-FILE-REPORT SECTION.
012470     MOVE SPACES TO DET-LINE.
012480     MOVE 0 TO PAGE-CT.
012490     MOVE 'B' TO PARM-REPORT-NO.
012500     MOVE '    ENVIRON1 DATA BASE STATISTICS BY FILE/PATH' TO
012510         HDG1-TITLE.
012520     PERFORM HDG-ROUTINE THRU HDG-ROUTINE-EX.
012530     PERFORM READ-SORTED THRU READ-SORTED-EX.
012540     IF SORT-RECORD-LAYOUT = HIGH-VALUES
012550         GO TO DB-STATS-FILE-REPORT-EX.
012560 DB-CLEAR-FILE-TOTALS.
012570     MOVE +0 TO ACC-DBREAD
012580               ACC-DBUPDT
012590               ACC-DBADD
012600               ACC-DBDELT.
012610 DB-PROCESS-RETURN.
012620     MOVE SR-FILE-K TO DET-DBFILE-2
012630                       PREV-FILE.
012640     MOVE SR-PATH-K TO DET-DBPATH-2
012650                       PREV-PATH.
012660     MOVE SR-AUDATE-K TO DET-DBAUDATE-2.
012670 DB-ACCUM-FILE-TOTALS.
012680     ADD SR-DBREAD TO ACC-DBREAD.
012690     ADD SR-DBUPDT TO ACC-DBUPDT.
012700     ADD SR-DBADD TO ACC-DBADD.
012710     ADD SR-DBDELT TO ACC-DBDELT.
012720     ADD SR-DBREAD TO ACC-TOT-DBREAD.
012730     ADD SR-DBUPDT TO ACC-TOT-DBUPDT.
012740     ADD SR-DBADD TO ACC-TOT-DBADD.
012750     ADD SR-DBDELT TO ACC-TOT-DBDELT.
012760     PERFORM READ-SORTED THRU READ-SORTED-EX.
012770     IF SR-DBFILE-K = PREV-DBFILE GO TO DB-ACCUM-FILE-TOTALS.
012780     MOVE ACC-DBREAD TO DET-DBREAD-2.
012790     MOVE ACC-DBUPDT TO DET-DBUPDT-2.
012800     MOVE ACC-DBADD TO DET-DBADD-2.
012810     MOVE ACC-DBDELT TO DET-DBDELT-2.
012820     PERFORM PRINT-DETLINE THRU PRINT-DETLINE-EX.
012830     IF SORT-RECORD-LAYOUT = HIGH-VALUES
012840         GO TO DB-STATS-FILE-REPORT-TOTALS.
012850     GO TO DB-CLEAR-FILE-TOTALS.
012860 DB-STATS-FILE-REPORT-TOTALS.
012870     MOVE '0       **TOTALS**' TO DET-LINE.
012880     MOVE ACC-TOT-DBREAD TO DET-DBREAD-2.
012890     MOVE ACC-TOT-DBUPDT TO DET-DBUPDT-2.
012900     MOVE ACC-TOT-DBADD TO DET-DBADD-2.
012910     MOVE ACC-TOT-DBDELT TO DET-DBDELT-2.
012920     PERFORM PRINT-DETLINE THRU PRINT-DETLINE-EX.
012930     MOVE '0  **GRAND TOTAL**' TO DET-LINE.
012940     COMPUTE DET-DBREAD-2 =
012950           ACC-TOT-DBREAD +
012960           ACC-TOT-DBUPDT +
012970           ACC-TOT-DBADD +
012980           ACC-TOT-DBDELT.
012990     PERFORM PRINT-DETLINE THRU PRINT-DETLINE-EX.
013000 DB-STATS-FILE-REPORT-EX.
013010     EJECT
013020 SECURITY-VIOLATION-REPT SECTION.
013030     SORT SORT-FILE ASCENDING KEY SORT-KEY
013040         INPUT PROCEDURE SV-REPORT-SORT
013050             THRU SV-REPORT-SORT-EX
013060         OUTPUT PROCEDURE SV-REPORT
013070             THRU SV-REPORT-EX.
013080     GO TO END-OF-JOB.
013090     SKIP3
013100 SV-REPORT-SORT SECTION.
013110     MOVE SPACES TO SORT-RECORD-LAYOUT.
013120 SV-RECORD-SELECT.
013130     PERFORM READ-AUDIT THRU READ-AUDIT-EX.
013140     IF AUDIT-RECORD-DATA = HIGH-VALUES GO TO SV-REPORT-SORT-EX.
013150     IF SYSTEM-SIGNON GO TO SV-CHECK.
013160     IF TRANSACTION-REQUEST GO TO SV-CHECK.
013170     GO TO SV-RECORD-SELECT.
013180 SV-CHECK.
013190     IF NO-VIOLATION GO TO SV-RECORD-SELECT.
013200     IF RACF-USER GO TO SV-CHECK-LOC.
013210     IF NOT NOT-RACF-ID GO TO SV-CHECK-LOC.
013220     GO TO SV-RECORD-SELECT.
013230 SV-CHECK-LOC.
013240     IF PARM-SELECT-LOCCDES = SPACES
013250         GO TO SV-REPORT-CHECK-SYSID.
013260     IF PARM-SELECT-LOC1 = AR-LOCCDE-1
013270         GO TO SV-REPORT-CHECK-SYSID.
013280     IF PARM-SELECT-LOC2 = AR-LOCCDE-1
013290         GO TO SV-REPORT-CHECK-SYSID.
013300     IF PARM-SELECT-LOC3 = AR-LOCCDE-1
013310         GO TO SV-REPORT-CHECK-SYSID.
013320     IF PARM-SELECT-LOC4 = AR-LOCCDE-1
013330         GO TO SV-REPORT-CHECK-SYSID.
013340     IF PARM-SELECT-LOC5 = AR-LOCCDE-1
013350         GO TO SV-REPORT-CHECK-SYSID.
013360     GO TO SV-RECORD-SELECT.
013370 SV-REPORT-CHECK-SYSID.
013380     IF PARM-SELECT-SYSID = SPACES
013390         GO TO SV-REPORT-BUILD-SORT.
013400     IF AR-SYSID NOT = PARM-SELECT-SYSID
013410         GO TO SV-RECORD-SELECT.
013420 SV-REPORT-BUILD-SORT.
013430     MOVE AR-SYSID TO SR-SYSID-K3.
013440     MOVE AR-USERID TO SR-USERID-K3.
013450     MOVE AR-LUNME TO SR-LUNME-K3.
013460     MOVE AR-TERMID TO SR-TERMID-K3.
013470     MOVE AR-AUDATE TO SR-AUDATE-K.
013480     MOVE AR-AUDTIM TO SR-AUDTIM-K.
013490     MOVE AUDIT-RECORD-DATA TO SR-AUDIT-DATA.
013500     RELEASE SORT-RECORD FROM SORT-RECORD-LAYOUT.
013510     GO TO SV-RECORD-SELECT.
013520 SV-REPORT-SORT-EX.
013530     SKIP3
013540 SV-REPORT SECTION.
013550     PERFORM HDG-ROUTINE THRU HDG-ROUTINE-EX.
013560     PERFORM READ-SORTED THRU READ-SORTED-EX.
013570     MOVE SR-AUDIT-DATA TO AUDIT-RECORD-DATA.
013580     IF AUDIT-RECORD-DATA = HIGH-VALUES GO TO SV-REPORT-EX.
013590 SV-BUILD-DETLINE.
013600     MOVE AR-SYSID TO DET-SVSYSID
013610                      PREV-SYSID.
013620 SV-USER-BREAK.
013630     MOVE AR-USERID TO DET-SVUSERID
013640                       RACF-KEY
013650                       PREV-USERID.
013660     EXAMINE DET-SVUSERID REPLACING ALL 'r' BY ' '.
013670     MOVE '2' TO RACF-FUNC.
013680     PERFORM CALL-RACF.
013690     MOVE RACF-INFO TO DET-SVUSERNME
013700                       PREV-USERNME.
013710 SV-TERM-BREAK.
013720     MOVE AR-LUNME TO PREV-LUNME.
013730     MOVE AR-TERMID TO PREV-TERMID.
013740     MOVE AR-TRMLOC TO DET-SVTRMLOC
013750                       PREV-TRMLOC.
013760 SV-AUDATE-BREAK.
013770     MOVE AR-AUDATE TO PREV-AUDATE
013780                       DATE-BREAKDOWN.
013790     MOVE BRKDWN-MON TO DET-SVAUDMON.
013800     MOVE BRKDWN-DAY TO DET-SVAUDDAY.
013810     MOVE BRKDWN-YR TO DET-SVAUDYR.
013820     MOVE '/' TO DET-SVSLASH1, DET-SVSLASH2.
013830 SV-AUDTIME-BREAK.
013840     MOVE AR-AUDTIM TO TIME-BREAKDOWN.
013850     MOVE BRKDWN-HH TO DET-SVTIMHH.
013860     MOVE BRKDWN-MM TO DET-SVTIMMM.
013870     MOVE ':' TO DET-SVTIMCOLON.
013880     IF SYSTEM-SIGNON
013890         MOVE AR-ERR15 TO DET-SVERR
013900         ELSE
013910         MOVE AR-TRANID TO DET-SVTRANID
013920                           RACF-KEY
013930         MOVE '3' TO RACF-FUNC
013940         PERFORM CALL-RACF
013950         MOVE RACF-INFO TO DET-SVTRANDESC
013960         MOVE AR-ERR20 TO DET-SVERR.
013970     PERFORM PRINT-DETLINE THRU PRINT-DETLINE-EX.
013980     PERFORM READ-SORTED THRU READ-SORTED-EX.
013990     MOVE SR-AUDIT-DATA TO AUDIT-RECORD-DATA.
014000     IF AUDIT-RECORD-DATA = HIGH-VALUES GO TO SV-REPORT-EX.
014010     IF AR-SYSID NOT = PREV-SYSID
014020         MOVE 0 TO PAGE-CT
014030         PERFORM HDG-ROUTINE THRU HDG-ROUTINE-EX
014040         GO TO SV-BUILD-DETLINE.
014050     IF AR-USERID NOT = PREV-USERID GO TO SV-USER-BREAK.
014060     IF AR-LUNME NOT = PREV-LUNME GO TO SV-TERM-BREAK.
014070     IF AR-AUDATE NOT = PREV-AUDATE GO TO SV-AUDATE-BREAK.
014080     GO TO SV-AUDTIME-BREAK.
014090 SV-REPORT-EX.
014100     SKIP3
014110     EJECT
014120 TRANSACTION-USAGE-REPT SECTION.
014130     SORT SORT-FILE ASCENDING KEY SORT-KEY
014140         INPUT PROCEDURE TRANS-USAGE-SORT
014150             THRU TRANS-USAGE-SORT-EX
014160        OUTPUT PROCEDURE TRANS-USAGE-REPORT
014170             THRU TRANS-USAGE-REPORT-EX.
014180     GO TO END-OF-JOB.
014190     SKIP3
014200 TRANS-USAGE-SORT SECTION.
014210     MOVE SPACES TO SORT-RECORD-LAYOUT.
014220 TRANS-USAGE-SELECT.
014230     PERFORM READ-AUDIT THRU READ-AUDIT-EX.
014240     IF AUDIT-RECORD-DATA = HIGH-VALUES GO TO TRANS-USAGE-SORT-EX.
014250     IF TRANSACTION-REQUEST GO TO TRANS-USAGE-CHECK-LOC.
014260     GO TO TRANS-USAGE-SELECT.
014270 TRANS-USAGE-CHECK-LOC.
014280     IF AR-TRANID = 'SIGN' GO TO TRANS-USAGE-SELECT.
014290     IF PARM-SELECT-LOCCDES = SPACES
014300         GO TO TRANS-USAGE-CHECK-TRANID.
014310     IF PARM-SELECT-LOC1 = AR-LOCCDE-1
014320         GO TO TRANS-USAGE-CHECK-TRANID.
014330     IF PARM-SELECT-LOC2 = AR-LOCCDE-1
014340         GO TO TRANS-USAGE-CHECK-TRANID.
014350     IF PARM-SELECT-LOC3 = AR-LOCCDE-1
014360         GO TO TRANS-USAGE-CHECK-TRANID.
014370     IF PARM-SELECT-LOC4 = AR-LOCCDE-1
014380         GO TO TRANS-USAGE-CHECK-TRANID.
014390     IF PARM-SELECT-LOC5 = AR-LOCCDE-1
014400         GO TO TRANS-USAGE-CHECK-TRANID.
014410     GO TO TRANS-USAGE-SELECT.
014420 TRANS-USAGE-CHECK-TRANID.
014430     IF PARM-SELECT-TRANID = SPACES GO TO TRANS-USAGE-CHECK-SYSID.
014440     IF AR-TRANID NOT = PARM-SELECT-TRANID
014450         GO TO TRANS-USAGE-SELECT.
014460     GO TO TRANS-USAGE-CHECK-USERID.
014470 TRANS-USAGE-CHECK-SYSID.
014480     IF PARM-SELECT-SYSID = SPACES GO TO TRANS-USAGE-CHECK-USERID.
014490     IF AR-SYSID NOT = PARM-SELECT-SYSID GO TO TRANS-USAGE-SELECT.
014500 TRANS-USAGE-CHECK-USERID.
014510     IF PARM-SELECT-USERID = SPACES GO TO TRANS-USAGE-BUILD-SORT.
014520     IF PARM-SELECT-USER-GRP-IND NOT = '00'
014530         IF AR-USERID-RACF NOT = PARM-SELECT-USERID
014540         GO TO TRANS-USAGE-SELECT.
014550     IF PARM-SELECT-USER-GRP-IND = '00'
014560         IF AR-USER-GRP-ID NOT = PARM-SELECT-USER-GRP-ID
014570         GO TO TRANS-USAGE-SELECT.
014580 TRANS-USAGE-BUILD-SORT.
014590     MOVE AR-TRANID TO SR-TRANID-K4.
014600     MOVE AR-SYSID TO SR-SYSID-K4.
014610     MOVE AR-LUNME TO SR-LUNME-K4.
014620     MOVE AR-TERMID TO SR-TERMID-K4.
014630     MOVE AR-USERID TO SR-USERID-K4.
014640     MOVE AR-AUDATE TO SR-AUDATE-K.
014650     MOVE AR-AUDTIM TO SR-AUDTIM-K.
014660     MOVE AUDIT-RECORD-DATA TO SR-AUDIT-DATA.
014670     RELEASE SORT-RECORD FROM SORT-RECORD-LAYOUT.
014680     GO TO TRANS-USAGE-SELECT.
014690 TRANS-USAGE-SORT-EX.
014700     SKIP3
014710 TRANS-USAGE-REPORT SECTION.
014720     MOVE 0 TO ACC-TRAN-ENTER-CT
014730               ACC-TRAN-ENTER-TOTAL
014740               ACC-TRAN-SYS-TOTAL
014750               ACC-TRAN-GRAND-TOTAL.
014760     MOVE SPACES TO DET-LINE.
014770     PERFORM HDG-ROUTINE THRU HDG-ROUTINE-EX.
014780     PERFORM READ-SORTED THRU READ-SORTED-EX.
014790     MOVE SR-AUDIT-DATA TO AUDIT-RECORD-DATA.
014800     IF AUDIT-RECORD-DATA = HIGH-VALUES
014810         GO TO TRANS-USAGE-REPORT-EX.
014820 TRANS-USAGE-BUILD-DETLINE.
014830     MOVE AR-SYSID TO DET-TRANS-SYSID
014840                      PREV-SYSID.
014850 TRANS-USAGE-TRANID-BREAK.
014860     MOVE AR-TRANID TO DET-TRANS-TRANID
014870                       PREV-TRANID
014880                       RACF-KEY.
014890     MOVE '3' TO RACF-FUNC.
014900     PERFORM CALL-RACF.
014910     MOVE RACF-INFO TO DET-TRANS-TRANDESC
014920                       PREV-TRANDESC.
014930 TRANS-USAGE-LUNME-BREAK.
014940     MOVE AR-TRMLOC TO DET-TRANS-TRMLOC
014950                       PREV-TRMLOC.
014960     MOVE AR-LUNME TO DET-TRANS-LUNME
014970                      PREV-LUNME.
014980     MOVE AR-TERMID TO PREV-TERMID.
014990 TRANS-USAGE-USERID-BREAK.
015000     MOVE AR-USERID TO DET-TRANS-USERID
015010                       PREV-USERID.
015020     EXAMINE DET-TRANS-USERID REPLACING ALL 'r' BY ' '.
015030     MOVE SPACES TO DET-TRANS-USERNME.
015040     IF RACF-USER GO TO TRANS-USAGE-GET-USERNME.
015050     IF NOT-RACF-ID GO TO TRANS-USAGE-USERNME-BYPASS.
015060 TRANS-USAGE-GET-USERNME.
015070     MOVE '2' TO RACF-FUNC.
015080     MOVE AR-USERID TO RACF-KEY.
015090     PERFORM CALL-RACF.
015100     MOVE RACF-INFO TO DET-TRANS-USERNME.
015110 TRANS-USAGE-USERNME-BYPASS.
015120     MOVE DET-TRANS-USERNME TO PREV-USERNME.
015130 TRANS-USAGE-AUDATE-BREAK.
015140     MOVE AR-AUDATE TO DATE-BREAKDOWN
015150                       PREV-AUDATE.
015160     MOVE BRKDWN-MON TO DET-TRANS-AUDMON.
015170     MOVE BRKDWN-DAY TO DET-TRANS-AUDDAY.
015180     MOVE BRKDWN-YR TO DET-TRANS-AUDYR.
015190     MOVE '/' TO DET-TRANS-SLASH1
015200                 DET-TRANS-SLASH2.
015210     MOVE AR-AUDTIM TO TIME-BREAKDOWN.
015220     MOVE BRKDWN-HH TO DET-TRANS-F-TIMHH.
015230     MOVE BRKDWN-MM TO DET-TRANS-F-TIMMM.
015240     MOVE ':' TO DET-TRANS-COLON1
015250                 DET-TRANS-COLON2.
015260 TRANS-USAGE-AUDTIM-BREAK.
015270     MOVE BRKDWN-HH TO DET-TRANS-L-TIMHH.
015280     MOVE BRKDWN-MM TO DET-TRANS-L-TIMMM.
015290     ADD 1 TO ACC-TRAN-ENTER-CT.
015300     ADD 1 TO ACC-TRAN-ENTER-TOTAL.
015310     ADD 1 TO ACC-TRAN-SYS-TOTAL.
015320     ADD 1 TO ACC-TRAN-GRAND-TOTAL.
015330     PERFORM READ-SORTED THRU READ-SORTED-EX.
015340     MOVE SR-AUDIT-DATA TO AUDIT-RECORD-DATA.
015350     IF AUDIT-RECORD-DATA = HIGH-VALUES
015360         GO TO TRANS-USAGE-TRAN-SUB-TOTAL.
015370     IF AR-SYSID NOT = PREV-SYSID
015380         PERFORM TRANS-USAGE-TRAN-SUB-TOTAL THRU
015390             TRANS-USAGE-TRAN-SYS-TOTAL
015400         GO TO TRANS-USAGE-BUILD-DETLINE.
015410     IF AR-TRANID NOT = PREV-TRANID
015420         PERFORM TRANS-USAGE-TRAN-SUB-TOTAL THRU
015430             TRANS-USAGE-TRAN-TOTAL
015440         GO TO TRANS-USAGE-TRANID-BREAK.
015450     IF AR-LUNME NOT = PREV-LUNME
015460         PERFORM TRANS-USAGE-TRAN-SUB-TOTAL
015470         GO TO TRANS-USAGE-LUNME-BREAK.
015480     IF AR-USERID NOT = PREV-USERID
015490         PERFORM TRANS-USAGE-TRAN-SUB-TOTAL
015500         GO TO TRANS-USAGE-USERID-BREAK.
015510     IF AR-AUDATE NOT = PREV-AUDATE
015520         PERFORM TRANS-USAGE-TRAN-SUB-TOTAL
015530         GO TO TRANS-USAGE-AUDATE-BREAK.
015540     MOVE AR-AUDTIM TO TIME-BREAKDOWN.
015550     GO TO TRANS-USAGE-AUDTIM-BREAK.
015560 TRANS-USAGE-TRAN-SUB-TOTAL.
015570     MOVE ACC-TRAN-ENTER-CT TO DET-TRANS-TRANCT.
015580     PERFORM PRINT-DETLINE THRU PRINT-DETLINE-EX.
015590     MOVE 0 TO ACC-TRAN-ENTER-CT.
015600 TRANS-USAGE-TRAN-TOTAL.
015610     MOVE ACC-TRAN-ENTER-TOTAL TO DET-TRANS-TRANCT.
015620     MOVE '*** TRANSACTION TOTALS ***'
015630         TO DET-TRANS-TOTAL-DESC.
015640     PERFORM PRINT-DETLINE THRU PRINT-DETLINE-EX.
015650     MOVE 0 TO ACC-TRAN-ENTER-TOTAL.
015660     MOVE '0' TO DET-CNTL.
015670 TRANS-USAGE-TRAN-SYS-TOTAL.
015680     MOVE ACC-TRAN-SYS-TOTAL TO DET-TRANS-TRANCT.
015690     MOVE '*** SYSTEM TOTALS ***' TO DET-TRANS-TOTAL-DESC.
015700     PERFORM PRINT-DETLINE THRU PRINT-DETLINE-EX.
015710     MOVE 0 TO ACC-TRAN-SYS-TOTAL.
015720     MOVE 0 TO PAGE-CT.
015730     PERFORM HDG-ROUTINE THRU HDG-ROUTINE-EX.
015740 TRANS-USAGE-TRAN-GRAND-TOTAL.
015750     MOVE ACC-TRAN-GRAND-TOTAL TO DET-TRANS-TRANCT.
015760     MOVE '*** GRAND TRANSACTION TOTALS ***'
015770         TO DET-TRANS-TOTAL-DESC.
015780     PERFORM PRINT-DETLINE THRU PRINT-DETLINE-EX.
015790     MOVE '0' TO DET-CNTL.
015800 TRANS-USAGE-REPORT-EX.
015810     SKIP3
015820     EJECT
015830 TPNS-REPT SECTION.
015840     SORT SORT-FILE ASCENDING KEY SORT-KEY
015850         INPUT PROCEDURE TPNS-LOC-SORT THRU TPNS-LOC-SORT-EX
015860        OUTPUT PROCEDURE TPNS-LOC-REPORT THRU TPNS-LOC-REPORT-EX.
015870     SORT SORT-FILE ASCENDING KEY SORT-KEY
015880         INPUT PROCEDURE TPNS-DBWU-SORT THRU TPNS-DBWU-SORT-EX
015890        OUTPUT PROCEDURE TPNS-DBWU-REPORT THRU
015900            TPNS-DBWU-REPORT-EX.
015910     GO TO END-OF-JOB.
015920     SKIP3
015930 TPNS-LOC-SORT SECTION.
015940     MOVE SPACES TO SORT-RECORD-LAYOUT.
015950 TPNS-LOC-SELECT.
015960     PERFORM READ-AUDIT THRU READ-AUDIT-EX.
015970     IF AUDIT-RECORD-DATA = HIGH-VALUES
015980          GO TO TPNS-LOC-SORT-EX.
015990     IF NOT TRANSACTION-ENDED GO TO TPNS-LOC-SELECT.
016000     IF AR-DBFILE (1) = '$END' GO TO TPNS-LOC-SELECT.
016010     MOVE SPACES TO TPNS-WORK-RECORD.
016020     MOVE AR-LOCCDE TO TPNS-LOCCDE.
016030     MOVE SPACES TO SR-LOCCDE-K.
016040     IF AR-LOCCDE-1 = 'N' OR 'P'
016050          MOVE AR-LOCCDE TO SR-LOCCDE-K
016060          ELSE
016070          MOVE AR-LOCCDE-1 TO SR-LOCCDE-K.
016080     MOVE AR-TERMID TO TPNS-TERMID
016090                       SR-TERMID-K.
016100     MOVE AR-AUDATE TO TPNS-AUDATE
016110                       SR-AUDATE-K.
016120     MOVE AR-AUDTIM TO TPNS-AUDTIM
016130                       SR-AUDTIM-K.
016140     MOVE AR-LUNME TO TPNS-LUNME
016150                       SR-LUNME-K.
016160     MOVE AR-TRMLOC TO TPNS-TRMLOC.
016170     MOVE 1 TO DBSUB.
016180 TPNS-LOC-FILE-LOOP.
016190     IF AR-DBFILE (DBSUB) = '$END' GO TO TPNS-LOC-SELECT.
016200     IF AR-DBREAD (DBSUB) = +0 AND
016210         AR-DBUPDT (DBSUB) = +0 AND
016220         AR-DBADD (DBSUB) = +0 AND
016230         AR-DBDELT (DBSUB) = +0 GO TO TPNS-LOC-NXT-FILE.
016240     MOVE AR-DBFILE (DBSUB) TO TPNS-FILE
016250                               SR-FILE-K.
016260     MOVE AR-DBPATH (DBSUB) TO TPNS-PATH
016270                               SR-PATH-K.
016280     MOVE 'R' TO TPNS-TYPE-IO.
016290     IF AR-DBUPDT (DBSUB) = +0 AND
016300         AR-DBADD (DBSUB) = +0 AND
016310         AR-DBDELT (DBSUB) = +0 GO TO TPNS-LOC-WRITE-SORT.
016320     MOVE 'U' TO TPNS-TYPE-IO.
016330 TPNS-LOC-WRITE-SORT.
016340     MOVE TPNS-WORK-RECORD TO SR-AUDIT-DATA.
016350     RELEASE SORT-RECORD FROM SORT-RECORD-LAYOUT.
016360 TPNS-LOC-NXT-FILE.
016370     ADD 1 TO DBSUB.
016380     IF DBSUB IS NOT GREATER THAN 16 GO TO TPNS-LOC-FILE-LOOP.
016390     GO TO TPNS-LOC-SELECT.
016400 TPNS-LOC-SORT-EX.
016410     SKIP3
016420 TPNS-LOC-REPORT SECTION.
016430     OPEN OUTPUT WORK-FILE.
016440     MOVE SPACES TO DET-LINE.
016450     PERFORM HDG-ROUTINE THRU HDG-ROUTINE-EX.
016460 TPNS-LOC-REPORT-FIRST.
016470     PERFORM READ-SORTED THRU READ-SORTED-EX.
016480     IF SORT-RECORD-LAYOUT = HIGH-VALUES
016490         CLOSE WORK-FILE
016500         PERFORM PRINT-LAST-LINE THRU LAST-LINE-EX
016510         GO TPNS-LOC-REPORT-EX.
016520     MOVE SR-AUDIT-DATA TO TPNS-WORK-RECORD.
016530     IF PARM-SELECT-LOCCDES = SPACES GO TO TPNS-LOC-DETLINE.
016540     IF PARM-SELECT-LOC1 = TPNS-LOCCDE-1
016550         GO TO TPNS-LOC-DETLINE.
016560     IF PARM-SELECT-LOC2 = TPNS-LOCCDE-1
016570         GO TO TPNS-LOC-DETLINE.
016580     IF PARM-SELECT-LOC3 = TPNS-LOCCDE-1
016590         GO TO TPNS-LOC-DETLINE.
016600     IF PARM-SELECT-LOC4 = TPNS-LOCCDE-1
016610         GO TO TPNS-LOC-DETLINE.
016620     IF PARM-SELECT-LOC5 = TPNS-LOCCDE-1
016630         GO TO TPNS-LOC-DETLINE.
016640     WRITE WORK-RECORD FROM TPNS-WORK-RECORD.
016650     GO TO TPNS-LOC-REPORT-FIRST.
016660 TPNS-LOC-DETLINE.
016670     MOVE TPNS-LOCCDE TO PREV-LOCCDE.
016680     PERFORM GET-CENTRAL-LOCATION THRU CENTRAL-LOCATION-EX.
016690     MOVE PREV-CTLLOC TO DET-TPNS-CTLLOC.
016700 TPNS-LOC-TERM-BREAK.
016710     MOVE TPNS-TERMID TO DET-TPNS-TERMID
016720                         PREV-TERMID.
016730     MOVE TPNS-LUNME TO DET-TPNS-LUNME
016740                        PREV-LUNME.
016750     MOVE TPNS-TRMLOC TO DET-TPNS-TRMLOC
016760                         PREV-TRMLOC.
016770     MOVE TPNS-AUDATE TO DET-TPNS-AUDATE
016780                         PREV-AUDATE.
016790 TPNS-LOC-FILE-BREAK.
016800     MOVE TPNS-FILE TO DET-TPNS-FILE
016810                       PREV-FILE.
016820     MOVE TPNS-PATH TO DET-TPNS-PATH
016830                       PREV-PATH.
016840 TPNS-LOC-TYPE-BREAK.
016850     IF TPNS-TYPE-IO NOT = 'R'
016860          MOVE TPNS-TYPE-IO TO DET-TPNS-TYPE.
016870     MOVE TPNS-TYPE-IO TO PREV-TYPE-IO.
016880 TPNS-LOC-NXT-SORTED.
016890     WRITE WORK-RECORD FROM TPNS-WORK-RECORD.
016900     PERFORM READ-SORTED THRU READ-SORTED-EX.
016910     IF SORT-RECORD-LAYOUT NOT = HIGH-VALUES
016920         GO TO TPNS-LOC-BREAK-CHECK.
016930     PERFORM PRINT-DETLINE THRU PRINT-DETLINE-EX.
016940     PERFORM PRINT-LAST-LINE THRU LAST-LINE-EX.
016950     CLOSE WORK-FILE.
016960     GO TO TPNS-LOC-REPORT-EX.
016970 TPNS-LOC-BREAK-CHECK.
016980     MOVE SR-AUDIT-DATA TO TPNS-WORK-RECORD.
016990     IF PARM-SELECT-LOCCDES = SPACES GO TO TPNS-LOC-CHECK-LOCCDE.
017000     IF PARM-SELECT-LOC1 = TPNS-LOCCDE-1
017010          GO TO TPNS-LOC-CHECK-LOCCDE.
017020     IF PARM-SELECT-LOC2 = TPNS-LOCCDE-1
017030          GO TO TPNS-LOC-CHECK-LOCCDE.
017040     IF PARM-SELECT-LOC3 = TPNS-LOCCDE-1
017050          GO TO TPNS-LOC-CHECK-LOCCDE.
017060     IF PARM-SELECT-LOC4 = TPNS-LOCCDE-1
017070          GO TO TPNS-LOC-CHECK-LOCCDE.
017080     IF PARM-SELECT-LOC5 = TPNS-LOCCDE-1
017090          GO TO TPNS-LOC-CHECK-LOCCDE.
017100     GO TO TPNS-LOC-NXT-SORTED.
017110 TPNS-LOC-CHECK-LOCCDE.
017120     IF TPNS-LOCCDE-1 = 'N' OR 'P'
017130          IF TPNS-LOCCDE NOT = PREV-LOCCDE
017140          PERFORM PRINT-DETLINE THRU PRINT-DETLINE-EX
017150          GO TO TPNS-LOC-DETLINE.
017160     IF TPNS-LOCCDE-1 NOT = 'N' AND NOT = 'P'
017170          IF TPNS-LOCCDE-1 NOT = PREV-LOCCDE-1
017180          PERFORM PRINT-DETLINE THRU PRINT-DETLINE-EX
017190          GO TO TPNS-LOC-DETLINE.
017200     IF TPNS-LUNME NOT = PREV-LUNME
017210          PERFORM PRINT-DETLINE THRU PRINT-DETLINE-EX
017220          GO TO TPNS-LOC-TERM-BREAK.
017230     IF TPNS-DBFILE NOT = PREV-DBFILE
017240          PERFORM PRINT-DETLINE THRU PRINT-DETLINE-EX
017250          GO TO TPNS-LOC-FILE-BREAK.
017260     IF TPNS-TYPE-IO = PREV-TYPE-IO
017270          GO TO TPNS-LOC-NXT-SORTED.
017280     IF PREV-TYPE-IO = 'U'
017290          GO TO TPNS-LOC-NXT-SORTED.
017300     GO TO TPNS-LOC-TYPE-BREAK.
017310 TPNS-LOC-REPORT-EX.
017320     SKIP3
017330 TPNS-DBWU-SORT SECTION.
017340     MOVE SPACES TO SORT-RECORD-LAYOUT.
017350     OPEN INPUT WORK-FILE.
017360 TPNS-DBWU-SELECT.
017370     READ WORK-FILE INTO TPNS-WORK-RECORD AT END
017380         CLOSE WORK-FILE GO TO TPNS-DBWU-SORT-EX.
017390     MOVE TPNS-FILE TO SR-FILE-K2.
017400     MOVE TPNS-PATH TO SR-PATH-K2.
017410     MOVE TPNS-LUNME TO SR-LUNME-K2.
017420     MOVE TPNS-TERMID TO SR-TERMID-K2.
017430     MOVE TPNS-AUDATE TO SR-AUDATE-K.
017440     MOVE TPNS-AUDTIM TO SR-AUDTIM-K.
017450     MOVE TPNS-WORK-RECORD TO SR-AUDIT-DATA.
017460     RELEASE SORT-RECORD FROM SORT-RECORD-LAYOUT.
017470     GO TO TPNS-DBWU-SELECT.
017480 TPNS-DBWU-SORT-EX.
017490     SKIP3
017500 TPNS-DBWU-REPORT SECTION.
017510     MOVE 'E' TO PARM-REPORT-NO.
017520     MOVE SPACES TO DET-LINE.
017530     MOVE '      ENVIRON1 T.P.N.S. DATA BASE WHERE-USE'
017540         TO HDG1-TITLE.
017550     MOVE 0 TO PAGE-CT.
017560     PERFORM HDG-ROUTINE THRU HDG-ROUTINE-EX.
017570     PERFORM READ-SORTED THRU READ-SORTED-EX.
017580     IF SORT-RECORD-LAYOUT = HIGH-VALUES
017590         GO TO TPNS-DBWU-REPORT-EX.
017600     MOVE SR-AUDIT-DATA TO TPNS-WORK-RECORD.
017610 TPNS-DBWU-DETLINE.
017620     MOVE TPNS-FILE TO DET-TPNS-FILE-2
017630                       PREV-FILE.
017640     MOVE TPNS-PATH TO DET-TPNS-PATH-2
017650                       PREV-PATH.
017660 TPNS-DBWU-TERM-BREAK.
017670     IF TPNS-TYPE-IO NOT = 'R'
017680          MOVE TPNS-TYPE-IO TO DET-TPNS-TYPE-2.
017690     MOVE TPNS-TYPE-IO TO PREV-TYPE-IO.
017700     MOVE TPNS-TERMID TO DET-TPNS-TERMID-2
017710                         PREV-TERMID.
017720     MOVE TPNS-LUNME TO DET-TPNS-LUNME-2
017730                         PREV-LUNME.
017740     MOVE TPNS-TRMLOC TO DET-TPNS-TRMLOC-2.
017750     MOVE TPNS-AUDATE TO DET-TPNS-AUDATE-2.
017760 TPNS-DBWU-NXT-SORTED.
017770     PERFORM READ-SORTED THRU READ-SORTED-EX.
017780     IF SORT-RECORD-LAYOUT = HIGH-VALUES
017790         PERFORM PRINT-DETLINE THRU PRINT-DETLINE-EX
017800         GO TO TPNS-DBWU-REPORT-EX.
017810     MOVE SR-AUDIT-DATA TO TPNS-WORK-RECORD.
017820     IF TPNS-DBFILE NOT = PREV-DBFILE
017830         PERFORM PRINT-DETLINE THRU PRINT-DETLINE-EX
017840         GO TO TPNS-DBWU-DETLINE.
017850     IF TPNS-LUNME NOT = PREV-LUNME
017860         PERFORM PRINT-DETLINE THRU PRINT-DETLINE-EX
017870         GO TO TPNS-DBWU-TERM-BREAK.
017880     IF TPNS-TYPE-IO = PREV-TYPE-IO
017890         GO TO TPNS-DBWU-NXT-SORTED.
017900     IF PREV-TYPE-IO = 'U'
017910         GO TO TPNS-DBWU-NXT-SORTED.
017920     IF TPNS-TYPE-IO NOT = 'R'
017930         MOVE TPNS-TYPE-IO TO DET-TPNS-TYPE-2.
017940     MOVE TPNS-TYPE-IO TO PREV-TYPE-IO.
017950     GO TO TPNS-DBWU-NXT-SORTED.
017960 TPNS-DBWU-REPORT-EX.
017970     EJECT
017980 TERMINAL-USAGE-REPT SECTION.
017990     SORT SORT-FILE ASCENDING KEY SORT-KEY
018000         INPUT PROCEDURE TERMU-USAGE-SORT
018010             THRU TERMU-USAGE-SORT-EX
018020        OUTPUT PROCEDURE TERMU-USAGE-REPORT
018030             THRU TERMU-USAGE-REPORT-EX.
018040     GO TO END-OF-JOB.
018050     SKIP3
018060 TERMU-USAGE-SORT SECTION.
018070     MOVE SPACES TO SORT-RECORD-LAYOUT.
018080 TERMU-USAGE-SELECT.
018090     PERFORM READ-AUDIT THRU READ-AUDIT-EX.
018100     IF AUDIT-RECORD-DATA = HIGH-VALUES GO TO TERMU-USAGE-SORT-EX.
018110     IF TRANSACTION-REQUEST GO TO TERMU-USAGE-CHECK-LOC.
018120     GO TO TERMU-USAGE-SELECT.
018130 TERMU-USAGE-CHECK-LOC.
018140     IF AR-TRANID = 'SIGN' GO TO TERMU-USAGE-SELECT.
018150     IF PARM-SELECT-LOCCDES = SPACES
018160         GO TO TERMU-USAGE-CHECK-TRANID.
018170     IF PARM-SELECT-LOC1 = AR-LOCCDE-1
018180         GO TO TERMU-USAGE-CHECK-LUNME.
018190     IF PARM-SELECT-LOC2 = AR-LOCCDE-1
018200         GO TO TERMU-USAGE-CHECK-LUNME.
018210     IF PARM-SELECT-LOC3 = AR-LOCCDE-1
018220         GO TO TERMU-USAGE-CHECK-LUNME.
018230     IF PARM-SELECT-LOC4 = AR-LOCCDE-1
018240         GO TO TERMU-USAGE-CHECK-LUNME.
018250     IF PARM-SELECT-LOC5 = AR-LOCCDE-1
018260         GO TO TERMU-USAGE-CHECK-LUNME.
018270     GO TO TERMU-USAGE-SELECT.
018280 TERMU-USAGE-CHECK-LUNME.
018290     IF PARM-SELECT-LUNME = SPACES
018300         GO TO TERMU-USAGE-CHECK-TRANID.
018310     IF AR-LUNME NOT = PARM-SELECT-LUNME
018320         GO TO TERMU-USAGE-SELECT.
018330 TERMU-USAGE-CHECK-TRANID.
018340     IF PARM-SELECT-TRANID = SPACES GO TO TERMU-USAGE-CHECK-SYSID.
018350     IF AR-TRANID NOT = PARM-SELECT-TRANID
018360         GO TO TERMU-USAGE-SELECT.
018370     GO TO TERMU-USAGE-CHECK-USERID.
018380 TERMU-USAGE-CHECK-SYSID.
018390     IF PARM-SELECT-SYSID = SPACES GO TO TERMU-USAGE-CHECK-USERID.
018400     IF AR-SYSID NOT = PARM-SELECT-SYSID GO TO TERMU-USAGE-SELECT.
018410 TERMU-USAGE-CHECK-USERID.
018420     IF PARM-SELECT-USERID = SPACES GO TO TERMU-USAGE-BUILD-SORT.
018430     IF PARM-SELECT-USER-GRP-IND NOT = '00'
018440         IF AR-USERID-RACF NOT = PARM-SELECT-USERID
018450         GO TO TERMU-USAGE-SELECT.
018460     IF PARM-SELECT-USER-GRP-IND = '00'
018470         IF AR-USER-GRP-ID NOT = PARM-SELECT-USER-GRP-ID
018480         GO TO TERMU-USAGE-SELECT.
018490 TERMU-USAGE-BUILD-SORT.
018500     MOVE AR-TRANID TO SR-TRANID-K5.
018510     MOVE AR-SYSID TO SR-SYSID-K5.
018520     MOVE AR-LUNME TO SR-LUNME-K5.
018530     MOVE AR-TERMID TO SR-TERMID-K5.
018540     MOVE AR-USERID TO SR-USERID-K5.
018550     MOVE AR-AUDATE TO SR-AUDATE-K.
018560     MOVE AR-AUDTIM TO SR-AUDTIM-K.
018570     MOVE AUDIT-RECORD-DATA TO SR-AUDIT-DATA.
018580     RELEASE SORT-RECORD FROM SORT-RECORD-LAYOUT.
018590     GO TO TERMU-USAGE-SELECT.
018600 TERMU-USAGE-SORT-EX.
018610     SKIP3
018620 TERMU-USAGE-REPORT SECTION.
018630     MOVE 0 TO ACC-TRAN-ENTER-CT.
018640     MOVE SPACES TO DET-LINE.
018650     PERFORM HDG-ROUTINE THRU HDG-ROUTINE-EX.
018660     PERFORM READ-SORTED THRU READ-SORTED-EX.
018670     MOVE SR-AUDIT-DATA TO AUDIT-RECORD-DATA.
018680     IF AUDIT-RECORD-DATA = HIGH-VALUES
018690         GO TO TERMU-USAGE-REPORT-EX.
018700 TERMU-USAGE-BUILD-DETLINE.
018710     MOVE AR-LUNME TO DET-TERMU-LUNME
018720                      PREV-LUNME.
018730     MOVE AR-TERMID TO PREV-TERMID.
018740     MOVE AR-TRMLOC TO DET-TERMU-TRMLOC
018750                       PREV-TRMLOC.
018760 TERMU-USAGE-SYSID-BREAK.
018770     MOVE AR-SYSID TO DET-TERMU-SYSID
018780                      PREV-SYSID.
018790 TERMU-USAGE-TRANID-BREAK.
018800     MOVE AR-TRANID TO DET-TERMU-TRANID
018810                       PREV-TRANID
018820                       RACF-KEY.
018830     MOVE '3' TO RACF-FUNC.
018840     PERFORM CALL-RACF.
018850     MOVE RACF-INFO TO DET-TERMU-TRANDESC
018860                       PREV-TRANDESC.
018870 TERMU-USAGE-USERID-BREAK.
018880     MOVE AR-USERID TO DET-TERMU-USERID
018890                       PREV-USERID.
018900     EXAMINE DET-TERMU-USERID REPLACING ALL 'r' BY ' '.
018910     MOVE SPACES TO DET-TERMU-USERNME.
018920     IF RACF-USER GO TO TERMU-USAGE-GET-USERNME.
018930     IF NOT-RACF-ID GO TO TERMU-USAGE-USERNME-BYPASS.
018940 TERMU-USAGE-GET-USERNME.
018950     MOVE '2' TO RACF-FUNC.
018960     MOVE AR-USERID TO RACF-KEY.
018970     PERFORM CALL-RACF.
018980     MOVE RACF-INFO TO DET-TERMU-USERNME.
018990 TERMU-USAGE-USERNME-BYPASS.
019000     MOVE DET-TERMU-USERNME TO PREV-USERNME.
019010 TERMU-USAGE-AUDATE-BREAK.
019020     MOVE AR-AUDATE TO DATE-BREAKDOWN
019030                       PREV-AUDATE.
019040     MOVE BRKDWN-MON TO DET-TERMU-AUDMON.
019050     MOVE BRKDWN-DAY TO DET-TERMU-AUDDAY.
019060     MOVE BRKDWN-YR TO DET-TERMU-AUDYR.
019070     MOVE '/' TO DET-TERMU-SLASH1
019080                 DET-TERMU-SLASH2.
019090 TERMU-USAGE-TRAN-CT.
019100     ADD 1 TO ACC-TRAN-ENTER-CT.
019110     PERFORM READ-SORTED THRU READ-SORTED-EX.
019120     MOVE SR-AUDIT-DATA TO AUDIT-RECORD-DATA.
019130     IF AUDIT-RECORD-DATA = HIGH-VALUES
019140         PERFORM TERMU-USAGE-TRAN-TOTAL
019150         GO TO TERMU-USAGE-REPORT-EX.
019160     IF AR-LUNME NOT = PREV-LUNME
019170         PERFORM TERMU-USAGE-TRAN-TOTAL
019180         GO TO TERMU-USAGE-BUILD-DETLINE.
019190     IF AR-LUNME = SPACES
019200         IF AR-TERMID NOT = PREV-TERMID
019210         PERFORM TERMU-USAGE-TRAN-TOTAL
019220         GO TO TERMU-USAGE-BUILD-DETLINE.
019230     IF AR-SYSID NOT = PREV-SYSID
019240         PERFORM TERMU-USAGE-TRAN-TOTAL
019250         GO TO TERMU-USAGE-SYSID-BREAK.
019260     IF AR-TRANID NOT = PREV-TRANID
019270         PERFORM TERMU-USAGE-TRAN-TOTAL
019280         GO TO TERMU-USAGE-TRANID-BREAK.
019290     IF AR-USERID NOT = PREV-USERID
019300         PERFORM TERMU-USAGE-TRAN-TOTAL
019310         GO TO TERMU-USAGE-USERID-BREAK.
019320     IF AR-AUDATE NOT = PREV-AUDATE
019330         PERFORM TERMU-USAGE-TRAN-TOTAL
019340         GO TO TERMU-USAGE-AUDATE-BREAK.
019350     GO TO TERMU-USAGE-TRAN-CT.
019360 TERMU-USAGE-TRAN-TOTAL.
019370     MOVE ACC-TRAN-ENTER-CT TO DET-TERMU-TRANCT.
019380     PERFORM PRINT-DETLINE THRU PRINT-DETLINE-EX.
019390     MOVE 0 TO ACC-TRAN-ENTER-CT.
019400 TERMU-USAGE-REPORT-EX.
019410     EJECT
019420 USER-USAGE-REPT SECTION.
019430     SORT SORT-FILE ASCENDING KEY SORT-KEY
019440         INPUT PROCEDURE USER-USAGE-SORT
019450             THRU USER-USAGE-SORT-EX
019460        OUTPUT PROCEDURE USER-USAGE-REPORT
019470             THRU USER-USAGE-REPORT-EX.
019480     GO TO END-OF-JOB.
019490     SKIP3
019500 USER-USAGE-SORT SECTION.
019510     MOVE SPACES TO SORT-RECORD-LAYOUT.
019520 USER-USAGE-SELECT.
019530     PERFORM READ-AUDIT THRU READ-AUDIT-EX.
019540     IF AUDIT-RECORD-DATA = HIGH-VALUES GO TO USER-USAGE-SORT-EX.
019550     IF TRANSACTION-REQUEST GO TO USER-USAGE-CHECK-USERID.
019560     GO TO USER-USAGE-SELECT.
019570 USER-USAGE-CHECK-USERID.
019580     IF AR-TRANID = 'SIGN' GO TO USER-USAGE-SELECT.
019590     IF PARM-SELECT-OWNERID NOT = SPACES
019600         GO TO USER-USAGE-BUILD-SORT.
019610     IF PARM-SELECT-USERID = SPACES GO TO USER-USAGE-BUILD-SORT.
019620     IF PARM-SELECT-USER-GRP-IND NOT = '00'
019630         IF AR-USERID-RACF NOT = PARM-SELECT-USERID
019640             GO TO USER-USAGE-SELECT.
019650     IF PARM-SELECT-USER-GRP-IND = '00'
019660         IF AR-USER-GRP-ID NOT = PARM-SELECT-USER-GRP-ID
019670             GO TO USER-USAGE-SELECT.
019680 USER-USAGE-BUILD-SORT.
019690     MOVE AR-USERID TO SR-USERID-K6
019700                       SR-USER-USERID.
019710     MOVE AR-TRANID TO SR-TRANID-K6
019720                       SR-USER-TRANID.
019730     MOVE AR-SYSID TO SR-SYSID-K6
019740                       SR-USER-SYSID.
019750     MOVE AR-AUDATE TO SR-AUDATE-K
019760                       SR-USER-AUDATE.
019770     MOVE AR-AUDTIM TO SR-AUDTIM-K
019780                       SR-USER-AUDTIM.
019790     MOVE HIGH-VALUES TO SR-USER-OWNERID
019800                         SR-OWNERID-K6.
019810     MOVE 'NON-RACF USERS' TO SR-USER-OWNERNME.
019820     IF RACF-USER GO TO USER-USAGE-GET-OWNER.
019830     IF NOT NOT-RACF-ID GO TO USER-USAGE-GET-OWNER.
019840     IF PARM-SELECT-OWNERID = SPACES
019850          GO TO USER-USAGE-BYPASS-OWNER.
019860     IF PARM-SELECT-OWNERID NOT = 'XXXX'
019870          GO TO USER-USAGE-SELECT.
019880     GO TO USER-USAGE-BYPASS-OWNER.
019890 USER-USAGE-GET-OWNER.
019900     IF PARM-SELECT-OWNERID = 'XXXX' GO TO USER-USAGE-SELECT.
019910     MOVE SPACES TO SR-USER-OWNERID
019920                        SR-OWNERID-K6.
019930     MOVE SPACES TO RACF-INFO.
019940     MOVE '4' TO RACF-FUNC.
019950     MOVE AR-USERID TO RACF-KEY.
019960     CALL RACF USING RACF-FUNC RACF-KEY RACF-OWNERID RACF-OWNERNME
019970     IF RACF-OWNERNME = 'NAME NOT FOUND      '
019980         MOVE 'UNIDENTIFIED OWNER' TO SR-USER-OWNERNME
019990         ELSE
020000         MOVE RACF-OWNERID TO SR-OWNERID-K6
020010                              SR-USER-OWNERID
020020         MOVE RACF-OWNERNME TO SR-USER-OWNERNME.
020030     IF PARM-SELECT-OWNERID = SPACES
020040         GO TO USER-USAGE-BYPASS-OWNER.
020050     IF SR-USER-OWNERID NOT = PARM-SELECT-OWNERID
020060         GO TO USER-USAGE-SELECT.
020070 USER-USAGE-BYPASS-OWNER.
020080     RELEASE SORT-RECORD FROM SORT-RECORD-LAYOUT.
020090     GO TO USER-USAGE-SELECT.
020100 USER-USAGE-SORT-EX.
020110     SKIP3
020120 USER-USAGE-REPORT SECTION.
020130     MOVE SPACES TO DET-LINE.
020140     MOVE 0 TO ACC-TRAN-ENTER-CT.
020150     MOVE 0 TO ACC-TRAN-ENTER-TOTAL.
020160     PERFORM READ-SORTED THRU READ-SORTED-EX.
020170     IF SORT-RECORD-LAYOUT = HIGH-VALUES
020180         PERFORM HDG-ROUTINE THRU HDG-ROUTINE-EX
020190         GO TO USER-USAGE-REPORT-EX.
020200     MOVE SR-USER-OWNERID TO HDG18-OWNERID
020210                             PREV-OWNERID.
020220     MOVE SR-USER-OWNERNME TO HDG18-OWNERNME.
020230     PERFORM HDG-ROUTINE THRU HDG-ROUTINE-EX.
020240 USER-USAGE-BUILD-DETLINE.
020250     MOVE SR-USER-USERID TO DET-USER-USERID
020260                            PREV-USERID.
020270     EXAMINE DET-USER-USERID REPLACING ALL 'r' BY ' '.
020280     IF SR-USER-OWNERID = HIGH-VALUES
020290         MOVE SPACES TO PREV-USERNME
020300         GO TO USER-USAGE-SYSID-BREAK.
020310     MOVE SR-USER-USERID TO RACF-KEY.
020320     MOVE '2' TO RACF-FUNC.
020330     PERFORM CALL-RACF.
020340     MOVE RACF-INFO TO DET-USER-USERNME
020350                       PREV-USERNME.
020360 USER-USAGE-SYSID-BREAK.
020370     MOVE SR-USER-SYSID TO DET-USER-SYSID
020380                           PREV-SYSID.
020390 USER-USAGE-TRANID-BREAK.
020400     MOVE SR-USER-TRANID TO DET-USER-TRANID
020410                       PREV-TRANID
020420                       RACF-KEY.
020430     ADD 1 TO ACC-TRAN-ENTER-CT.
020440     ADD 1 TO ACC-TRAN-ENTER-TOTAL.
020450     MOVE '3' TO RACF-FUNC.
020460     PERFORM CALL-RACF.
020470     MOVE RACF-INFO TO DET-USER-TRANDESC
020480                       PREV-TRANDESC.
020490 USER-USAGE-SORT-READ.
020500     PERFORM READ-SORTED THRU READ-SORTED-EX.
020510     IF SORT-RECORD-LAYOUT = HIGH-VALUES
020520         PERFORM USER-USAGE-TRAN-CT
020530         PERFORM PRINT-DETLINE THRU PRINT-DETLINE-EX
020540         PERFORM USER-USAGE-TRAN-TOTAL
020550         GO TO USER-USAGE-REPORT-EX.
020560     IF SR-USER-OWNERID NOT = PREV-OWNERID
020570         PERFORM USER-USAGE-TRAN-CT
020580         PERFORM PRINT-DETLINE THRU PRINT-DETLINE-EX
020590         PERFORM USER-USAGE-TRAN-TOTAL
020600         MOVE SR-USER-OWNERID TO HDG18-OWNERID
020610                                 PREV-OWNERID
020620         MOVE SR-USER-OWNERNME TO HDG18-OWNERNME
020630         MOVE 0 TO PAGE-CT
020640         PERFORM HDG-ROUTINE THRU HDG-ROUTINE-EX
020650         GO TO USER-USAGE-BUILD-DETLINE.
020660     IF SR-USER-USERID NOT = PREV-USERID
020670         PERFORM USER-USAGE-TRAN-CT
020680         PERFORM PRINT-DETLINE THRU PRINT-DETLINE-EX
020690         PERFORM USER-USAGE-TRAN-TOTAL
020700         GO TO USER-USAGE-BUILD-DETLINE.
020710     IF SR-USER-SYSID NOT = PREV-SYSID
020720         PERFORM USER-USAGE-TRAN-CT
020730         PERFORM PRINT-DETLINE THRU PRINT-DETLINE-EX
020740         GO TO USER-USAGE-SYSID-BREAK.
020750     IF SR-USER-TRANID NOT = PREV-TRANID
020760         PERFORM USER-USAGE-TRAN-CT
020770         PERFORM PRINT-DETLINE THRU PRINT-DETLINE-EX
020780         GO TO USER-USAGE-TRANID-BREAK.
020790     ADD 1 TO ACC-TRAN-ENTER-CT.
020800     ADD 1 TO ACC-TRAN-ENTER-TOTAL.
020810     GO TO USER-USAGE-SORT-READ.
020820 USER-USAGE-TRAN-CT.
020830     MOVE ACC-TRAN-ENTER-CT TO DET-USER-TRANCT.
020840     MOVE 0 TO ACC-TRAN-ENTER-CT.
020850 USER-USAGE-TRAN-TOTAL.
020860     MOVE ACC-TRAN-ENTER-TOTAL  TO DET-USER-TRANCT.
020870     MOVE 0 TO ACC-TRAN-ENTER-TOTAL.
020880     MOVE '*** TRANSACTION TOTALS ***' TO DET-USER-TRANCT-DESC.
020890     PERFORM PRINT-DETLINE THRU PRINT-DETLINE-EX.
020900     MOVE '0' TO DET-CNTL.
020910 USER-USAGE-REPORT-EX.
020920     EJECT
020930 END-OF-JOB SECTION.
020940     PERFORM PRINT-LAST-LINE THRU LAST-LINE-EX.
020950     CLOSE E1-AUDIT-FILE PRINTER-FILE PARM-FILE.
020960     GOBACK.
020970     EJECT
020980 READ-AUDIT.
020990     READ E1-AUDIT-FILE INTO AUDIT-RECORD-LAYOUT
021000          AT END MOVE HIGH-VALUES TO AUDIT-RECORD-LAYOUT
021010                 GO TO READ-AUDIT-EX.
021020     IF NOT AUDIT-RECORD GO TO READ-AUDIT.
021030     IF AR-AUDATE LESS THAN PARM-AUDIT-PERIOD-START
021040         GO TO READ-AUDIT.
021050     IF AR-AUDATE GREATER THAN PARM-AUDIT-PERIOD-END
021060         GO TO READ-AUDIT.
021070     IF AR-AUDTIM LESS THAN PARM-AUDIT-TIME-START
021080         GO TO READ-AUDIT.
021090     IF AR-AUDTIM GREATER THAN PARM-AUDIT-TIME-END
021100         GO TO READ-AUDIT.
021110     IF AR-AUDATE LESS THAN AUD-PERIOD-START
021120         MOVE AR-AUDATE TO AUD-PERIOD-START.
021130     IF AR-AUDATE GREATER THAN AUD-PERIOD-END
021140         MOVE AR-AUDATE TO AUD-PERIOD-END.
021150     IF E1-SIGNON GO TO READ-AUDIT-EX.
021160     IF SYSTEM-SIGNON GO TO READ-AUDIT-EX.
021170     IF TRANSACTION-REQUEST GO TO READ-AUDIT-EX.
021180     IF TRANSACTION-ENDED GO TO READ-AUDIT-EX.
021190     IF E1-SIGNOFF GO TO READ-AUDIT-EX.
021200     GO TO READ-AUDIT.
021210 READ-AUDIT-EX.
021220     EXIT.
021230     SKIP3
021240 READ-SORTED.
021250     RETURN SORT-FILE INTO SORT-RECORD-LAYOUT
021260         AT END MOVE HIGH-VALUES TO SORT-RECORD-LAYOUT
021270         GO TO READ-SORTED-EX.
021280 READ-SORTED-EX.
021290     EXIT.
021300     SKIP3
021310 CALL-RACF.
021320     MOVE SPACES TO RACF-INFO.
021330     CALL RACF USING RACF-FUNC RACF-KEY RACF-INFO.
021340     IF RACF-RESULTS = 'NAME NOT FOUND' OR
021350                       'DATA NOT FOUND'
021360                        MOVE SPACES TO RACF-INFO.
021370     IF RACF-FUNC = '2' AND RACF-INFO = SPACES
021380         MOVE 'UNIDENTIFIED USER' TO RACF-INFO.
021390 CALL-RACF-EXIT.
021400     EXIT.
021410     SKIP3
021420 PRINT-DETLINE.
021430     WRITE PRINT-LINE FROM DET-LINE AFTER POSITIONING PRT-CNTL.
021440     IF DET-CNTL = ' ' ADD 1 TO LINE-CT.
021450     IF DET-CNTL = '0' ADD 2 TO LINE-CT.
021460     IF DET-CNTL = '-' ADD 3 TO LINE-CT.
021470     MOVE SPACES TO DET-LINE.
021480     IF LINE-CT NOT GREATER THAN 59 GO TO PRINT-DETLINE-EX.
021490     PERFORM HDG-ROUTINE THRU HDG-ROUTINE-EX.
021500     IF DETAIL-TERMINAL-REPORT
021510         MOVE PREV-TERMID TO DET-TERMID
021520         MOVE PREV-LUNME TO DET-LUNME
021530         MOVE PREV-TRMLOC TO DET-TRMLOC
021540         MOVE PREV-AUDATE TO DET-AUDATE.
021550     IF DB-STATISTICS-REPORT
021560         MOVE PREV-TRANID TO DET-DBTRANID
021570         MOVE PREV-SYSID TO DET-DBSYSID
021580         MOVE PREV-AUDATE TO DET-DBAUDATE.
021590     IF SECURITY-REPORT
021600         MOVE PREV-SYSID TO DET-SVSYSID
021610         MOVE PREV-USERID TO DET-SVUSERID
021620         EXAMINE DET-SVUSERID REPLACING ALL 'r' BY ' '
021630         MOVE PREV-USERNME TO DET-SVUSERNME
021640         MOVE PREV-TRMLOC TO DET-SVTRMLOC
021650         MOVE PREV-AUDATE TO DATE-BREAKDOWN
021660         MOVE BRKDWN-MON TO DET-SVAUDMON
021670         MOVE BRKDWN-DAY TO DET-SVAUDDAY
021680         MOVE BRKDWN-YR TO DET-SVAUDYR
021690         MOVE '/' TO DET-SVSLASH1, DET-SVSLASH2.
021700     IF TRANSACTION-USAGE-REPORT
021710         MOVE PREV-LUNME  TO DET-TRANS-LUNME
021720         MOVE PREV-TRMLOC TO DET-TRANS-TRMLOC
021730         MOVE PREV-SYSID TO DET-TRANS-SYSID
021740         MOVE PREV-TRANID TO DET-TRANS-TRANID
021750         MOVE PREV-TRANDESC TO DET-TRANS-TRANDESC
021760         MOVE PREV-USERID TO DET-TRANS-USERID
021770         EXAMINE DET-TRANS-USERID REPLACING ALL 'r' BY ' '
021780         MOVE PREV-USERNME TO DET-TRANS-USERNME
021790         MOVE PREV-AUDATE TO DATE-BREAKDOWN
021800         MOVE BRKDWN-MON TO DET-TRANS-AUDMON
021810         MOVE BRKDWN-DAY TO DET-TRANS-AUDDAY
021820         MOVE BRKDWN-YR TO DET-TRANS-AUDYR
021830         MOVE '/' TO DET-TRANS-SLASH1 DET-TRANS-SLASH2.
021840     IF TPNS-REPORT
021850         MOVE PREV-CTLLOC TO DET-TPNS-CTLLOC
021860         MOVE PREV-TERMID TO DET-TPNS-TERMID
021870         MOVE PREV-LUNME TO DET-TPNS-LUNME
021880         MOVE PREV-FILE TO DET-TPNS-FILE
021890         MOVE PREV-PATH TO DET-TPNS-PATH.
021900     IF TERMINAL-USAGE-REPORT
021910         MOVE PREV-TRANID TO DET-TERMU-TRANID
021920         MOVE PREV-TRANDESC TO DET-TERMU-TRANDESC
021930         MOVE PREV-SYSID TO DET-TERMU-SYSID
021940         MOVE PREV-LUNME  TO DET-TERMU-LUNME
021950         MOVE PREV-TRMLOC TO DET-TERMU-TRMLOC
021960         MOVE PREV-USERID TO DET-TERMU-USERID
021970         EXAMINE DET-TERMU-USERID REPLACING ALL 'r' BY ' '
021980         MOVE PREV-USERNME TO DET-TERMU-USERNME
021990         MOVE PREV-AUDATE TO DATE-BREAKDOWN
022000         MOVE BRKDWN-MON TO DET-TERMU-AUDMON
022010         MOVE BRKDWN-DAY TO DET-TERMU-AUDDAY
022020         MOVE BRKDWN-YR TO DET-TERMU-AUDYR
022030         MOVE '/' TO DET-TERMU-SLASH1 DET-TERMU-SLASH2.
022040     IF USER-REPORT
022050         MOVE PREV-USERID TO DET-USER-USERID
022060         EXAMINE DET-USER-USERID REPLACING ALL 'r' BY ' '
022070         MOVE PREV-SYSID TO DET-USER-SYSID
022080         MOVE PREV-USERNME TO DET-USER-USERNME.
022090 PRINT-DETLINE-EX.
022100     EXIT.
022110     SKIP3
022120 PRINT-LAST-LINE.
022130     IF LINE-CT GREATER THAN 57
022140         PERFORM HDG-ROUTINE THRU HDG-ROUTINE-EX.
022150     MOVE LAST-LINE TO DET-LINE.
022160     PERFORM PRINT-DETLINE THRU PRINT-DETLINE-EX.
022170 LAST-LINE-EX.
022180     EXIT.
022190     SKIP3
022200 HDG-ROUTINE.
022210     IF AUD-PERIOD-END = 0 GO TO BYPASS-DATE-HDG.
022220     MOVE AUD-PERIOD-START TO DATE-BREAKDOWN.
022230     MOVE BRKDWN-MON TO MONSUB.
022240     MOVE MONTH-NAME (MONSUB) TO HDG1A-MONTH.
022250     MOVE BRKDWN-DAY TO HDG1A-DAY.
022260     MOVE BRKDWN-YR TO HDG1A-YR.
022270     MOVE AUD-PERIOD-END TO DATE-BREAKDOWN.
022280     MOVE BRKDWN-MON TO MONSUB.
022290     MOVE MONTH-NAME (MONSUB) TO HDG1B-MONTH.
022300     MOVE BRKDWN-DAY TO HDG1B-DAY.
022310     MOVE BRKDWN-YR TO HDG1B-YR.
022320 BYPASS-DATE-HDG.
022330     ADD 1 TO PAGE-CT.
022340     MOVE PAGE-CT TO HDG1-PAGE.
022350     IF DETAIL-TERMINAL-REPORT
022360        WRITE PRINT-LINE FROM HEADING1 AFTER POSITIONING PRT-CNTL
022370        WRITE PRINT-LINE FROM HEADING1A AFTER POSITIONING PRT-CNTL
022380        WRITE PRINT-LINE FROM HEADING1B AFTER POSITIONING PRT-CNTL
022390        WRITE PRINT-LINE FROM HEADING2 AFTER POSITIONING PRT-CNTL
022400        WRITE PRINT-LINE FROM HEADING3 AFTER POSITIONING PRT-CNTL.
022410     IF DB-STATISTICS-REPORT
022420        WRITE PRINT-LINE FROM HEADING1 AFTER POSITIONING PRT-CNTL
022430        WRITE PRINT-LINE FROM HEADING1A AFTER POSITIONING PRT-CNTL
022440        WRITE PRINT-LINE FROM HEADING1B AFTER POSITIONING PRT-CNTL
022450        WRITE PRINT-LINE FROM HEADING4 AFTER POSITIONING PRT-CNTL
022460        WRITE PRINT-LINE FROM HEADING5 AFTER POSITIONING PRT-CNTL.
022470     IF DB-STATISTICS-REPORT-2
022480        WRITE PRINT-LINE FROM HEADING1 AFTER POSITIONING PRT-CNTL
022490        WRITE PRINT-LINE FROM HEADING1A AFTER POSITIONING PRT-CNTL
022500        WRITE PRINT-LINE FROM HEADING1B AFTER POSITIONING PRT-CNTL
022510        WRITE PRINT-LINE FROM HEADING6 AFTER POSITIONING PRT-CNTL
022520        WRITE PRINT-LINE FROM HEADING7 AFTER POSITIONING PRT-CNTL.
022530     IF SECURITY-REPORT
022540        WRITE PRINT-LINE FROM HEADING1 AFTER POSITIONING PRT-CNTL
022550        WRITE PRINT-LINE FROM HEADING1A AFTER POSITIONING PRT-CNTL
022560        WRITE PRINT-LINE FROM HEADING1B AFTER POSITIONING PRT-CNTL
022570        WRITE PRINT-LINE FROM HEADING8 AFTER POSITIONING PRT-CNTL
022580        WRITE PRINT-LINE FROM HEADING9 AFTER POSITIONING PRT-CNTL.
022590     IF TPNS-REPORT
022600       WRITE PRINT-LINE FROM HEADING1 AFTER POSITIONING PRT-CNTL
022610       WRITE PRINT-LINE FROM HEADING1A AFTER POSITIONING PRT-CNTL
022620       WRITE PRINT-LINE FROM HEADING1B AFTER POSITIONING PRT-CNTL
022630       WRITE PRINT-LINE FROM HEADING10 AFTER POSITIONING PRT-CNTL
022640       WRITE PRINT-LINE FROM HEADING11 AFTER POSITIONING PRT-CNTL.
022650     IF TPNS-REPORT-2
022660       WRITE PRINT-LINE FROM HEADING1 AFTER POSITIONING PRT-CNTL
022670       WRITE PRINT-LINE FROM HEADING1A AFTER POSITIONING PRT-CNTL
022680       WRITE PRINT-LINE FROM HEADING1B AFTER POSITIONING PRT-CNTL
022690       WRITE PRINT-LINE FROM HEADING12 AFTER POSITIONING PRT-CNTL
022700       WRITE PRINT-LINE FROM HEADING13 AFTER POSITIONING PRT-CNTL.
022710     IF TRANSACTION-USAGE-REPORT
022720       WRITE PRINT-LINE FROM HEADING1 AFTER POSITIONING PRT-CNTL
022730       WRITE PRINT-LINE FROM HEADING1A AFTER POSITIONING PRT-CNTL
022740       WRITE PRINT-LINE FROM HEADING1B AFTER POSITIONING PRT-CNTL
022750       WRITE PRINT-LINE FROM HEADING14 AFTER POSITIONING PRT-CNTL
022760       WRITE PRINT-LINE FROM HEADING15 AFTER POSITIONING PRT-CNTL.
022770     IF TERMINAL-USAGE-REPORT
022780       WRITE PRINT-LINE FROM HEADING1 AFTER POSITIONING PRT-CNTL
022790       WRITE PRINT-LINE FROM HEADING1A AFTER POSITIONING PRT-CNTL
022800       WRITE PRINT-LINE FROM HEADING1B AFTER POSITIONING PRT-CNTL
022810       WRITE PRINT-LINE FROM HEADING16 AFTER POSITIONING PRT-CNTL
022820       WRITE PRINT-LINE FROM HEADING17 AFTER POSITIONING PRT-CNTL.
022830     IF USER-REPORT
022840       WRITE PRINT-LINE FROM HEADING1 AFTER POSITIONING PRT-CNTL
022850       WRITE PRINT-LINE FROM HEADING1A AFTER POSITIONING PRT-CNTL
022860       WRITE PRINT-LINE FROM HEADING1B AFTER POSITIONING PRT-CNTL
022870       WRITE PRINT-LINE FROM HEADING18 AFTER POSITIONING PRT-CNTL
022880       WRITE PRINT-LINE FROM HEADING19 AFTER POSITIONING PRT-CNTL
022890       WRITE PRINT-LINE FROM HEADING20 AFTER POSITIONING PRT-CNTL.
022900     MOVE 7 TO LINE-CT.
022910     MOVE '0' TO DET-CNTL.
022920 HDG-ROUTINE-EX.
022930     EXIT.
022940     SKIP3
022950 DB-CLEAR-STATISTICS.
022960     MOVE DB-STAT-INIT-VALUES TO DB-STATISTICS (DBSUB).
022970     ADD 1 TO DBSUB.
022980 DB-CLEAR-STATISTICS-EX.
022990     EXIT.
023000     SKIP3
023010 REPORT-SELECT.
023020     MOVE SPACES TO PARM-RECORD-LAYOUT.
023030     READ PARM-FILE INTO PARM-RECORD-LAYOUT AT END
023040         MOVE '1' TO PARM-REPORT-NO.
023050     IF PARM-AUDIT-PERIOD-START NOT NUMERIC
023060         MOVE 0 TO PARM-AUDIT-PERIOD-START
023070         MOVE 999999 TO PARM-AUDIT-PERIOD-END.
023080     IF PARM-AUDIT-PERIOD-END NOT NUMERIC
023090         MOVE 0 TO PARM-AUDIT-PERIOD-START
023100         MOVE 999999 TO PARM-AUDIT-PERIOD-END.
023110     IF PARM-AUDIT-TIME-START NOT NUMERIC
023120         MOVE 0 TO PARM-AUDIT-TIME-START
023130         MOVE 235959 TO PARM-AUDIT-TIME-END.
023140     IF PARM-AUDIT-TIME-END NOT NUMERIC
023150         MOVE 0 TO PARM-AUDIT-TIME-START
023160         MOVE 235959 TO PARM-AUDIT-TIME-END.
023170     MOVE PARM-AUDIT-TIME-START TO TIME-BREAKDOWN.
023180     MOVE BRKDWN-HH TO HDG1A-TIMHH.
023190     MOVE BRKDWN-MM TO HDG1A-TIMMM.
023200     MOVE BRKDWN-SS TO HDG1A-TIMSS.
023210     MOVE PARM-AUDIT-TIME-END TO TIME-BREAKDOWN.
023220     MOVE BRKDWN-HH TO HDG1B-TIMHH.
023230     MOVE BRKDWN-MM TO HDG1B-TIMMM.
023240     MOVE BRKDWN-SS TO HDG1B-TIMSS.
023250     IF PARM-SELECT-LOCCDES = SPACES GO TO CHECK-REPORT-TYPE.
023260     IF PARM-SELECT-LOC1 = SPACES
023270         MOVE HIGH-VALUES TO PARM-SELECT-LOC1.
023280     IF PARM-SELECT-LOC2 = SPACES
023290         MOVE HIGH-VALUES TO PARM-SELECT-LOC2.
023300     IF PARM-SELECT-LOC3 = SPACES
023310         MOVE HIGH-VALUES TO PARM-SELECT-LOC3.
023320     IF PARM-SELECT-LOC4 = SPACES
023330         MOVE HIGH-VALUES TO PARM-SELECT-LOC4.
023340     IF PARM-SELECT-LOC5 = SPACES
023350         MOVE HIGH-VALUES TO PARM-SELECT-LOC5.
023360 CHECK-REPORT-TYPE.
023370     IF DETAIL-TERMINAL-REPORT GO TO PRINT-PARM-RECORD.
023380     IF DB-STATISTICS-REPORT
023390         MOVE '   ENVIRON1 DATA BASE STATISTICS BY TRANSACTION' TO
023400             REPORT-TITLE
023410         GO TO PRINT-PARM-RECORD.
023420     IF SECURITY-REPORT
023430         MOVE '          ENVIRON1 SECURITY AUDIT REPORT' TO
023440             REPORT-TITLE
023450         GO TO PRINT-PARM-RECORD.
023460     IF TRANSACTION-USAGE-REPORT
023470         MOVE '        ENVIRON1 TRANSACTION AUDIT REPORT' TO
023480             REPORT-TITLE
023490         GO TO PRINT-PARM-RECORD.
023500     IF TPNS-REPORT
023510         MOVE '  ENVIRON1 T.P.N.S. DATA BASE AUDIT BY LOCATION' TO
023520             REPORT-TITLE
023530        GO TO PRINT-PARM-RECORD.
023540     IF TERMINAL-USAGE-REPORT
023550         MOVE '    ENVIRON1 TERMINAL USAGE AUDIT REPORT' TO
023560             REPORT-TITLE
023570        GO TO PRINT-PARM-RECORD.
023580     IF USER-REPORT
023590         MOVE '            ENVIRON1 USER AUDIT REPORT  ' TO
023600             REPORT-TITLE
023610        GO TO PRINT-PARM-RECORD.
023620     MOVE '1' TO PARM-REPORT-NO.
023630 PRINT-PARM-RECORD.
023640     ADD 1 TO PAGE-CT.
023650     MOVE PAGE-CT TO HDG1-PAGE
023660     WRITE PRINT-LINE FROM HEADING1 AFTER POSITIONING PRT-CNTL.
023670     MOVE 0 TO PAGE-CT.
023680     MOVE REPORT-TITLE TO HDG1-TITLE.
023690     MOVE '-REPORT TYPE.........' TO DET-PARM-DESC.
023700     MOVE PARM-REPORT-NO TO DET-PARM-VALUE.
023710     WRITE PRINT-LINE FROM DET-LINE AFTER POSITIONING PRT-CNTL.
023720     MOVE '0LOCATIONS...........' TO DET-PARM-DESC.
023730     MOVE PARM-SELECT-LOCCDES TO DET-PARM-VALUE.
023740     WRITE PRINT-LINE FROM DET-LINE AFTER POSITIONING PRT-CNTL.
023750     MOVE '0LOGICAL UNIT NAME...' TO DET-PARM-DESC.
023760     MOVE PARM-SELECT-LUNME TO DET-PARM-VALUE.
023770     WRITE PRINT-LINE FROM DET-LINE AFTER POSITIONING PRT-CNTL.
023780     MOVE '0TRANSACTION ID......' TO DET-PARM-DESC.
023790     MOVE PARM-SELECT-TRANID TO DET-PARM-VALUE.
023800     WRITE PRINT-LINE FROM DET-LINE AFTER POSITIONING PRT-CNTL.
023810     MOVE '0SYSTEM ID...........' TO DET-PARM-DESC.
023820     MOVE PARM-SELECT-SYSID TO DET-PARM-VALUE.
023830     WRITE PRINT-LINE FROM DET-LINE AFTER POSITIONING PRT-CNTL.
023840     MOVE '0USER ID.............' TO DET-PARM-DESC.
023850     MOVE PARM-SELECT-USERID TO DET-PARM-VALUE.
023860     WRITE PRINT-LINE FROM DET-LINE AFTER POSITIONING PRT-CNTL.
023870     MOVE '0OWNER ID............' TO DET-PARM-DESC.
023880     MOVE PARM-SELECT-OWNERID TO DET-PARM-VALUE.
023890     WRITE PRINT-LINE FROM DET-LINE AFTER POSITIONING PRT-CNTL.
023900     MOVE '0AUDIT DATE START....' TO DET-PARM-DESC.
023910     MOVE PARM-AUDIT-PERIOD-START TO DET-PARM-VALUE1.
023920     WRITE PRINT-LINE FROM DET-LINE AFTER POSITIONING PRT-CNTL.
023930     MOVE '            END......' TO DET-PARM-DESC.
023940     MOVE PARM-AUDIT-PERIOD-END TO DET-PARM-VALUE1.
023950     WRITE PRINT-LINE FROM DET-LINE AFTER POSITIONING PRT-CNTL.
023960     MOVE '0AUDIT TIME START....' TO DET-PARM-DESC.
023970     MOVE PARM-AUDIT-TIME-START TO DET-PARM-VALUE1.
023980     WRITE PRINT-LINE FROM DET-LINE AFTER POSITIONING PRT-CNTL.
023990     MOVE '            END......' TO DET-PARM-DESC.
024000     MOVE PARM-AUDIT-TIME-END TO DET-PARM-VALUE1.
024010     WRITE PRINT-LINE FROM DET-LINE AFTER POSITIONING PRT-CNTL.
024020     MOVE '0********************' TO DET-LINE.
024030     WRITE PRINT-LINE FROM DET-LINE AFTER POSITIONING PRT-CNTL.
024040     MOVE SPACES TO DET-LINE.
024050 REPORT-SELECT-EX.
024060     EXIT.
024070     SKIP3
024080 GET-CENTRAL-LOCATION.
024090     MOVE 1 TO LOCSUB.
024100 CENTRAL-LOC-LOOP.
024110     IF PREV-LOCCDE-1 = 'N' OR 'P'
024120         IF PREV-LOCCDE = LOC-CODE (LOCSUB)
024130             MOVE LOC-DESC (LOCSUB) TO PREV-CTLLOC
024140             GO TO CENTRAL-LOCATION-EX
024150         ELSE GO TO NEXT-DESCRIPTION-ENTRY.
024160     IF PREV-LOCCDE-1 = LOC-CODE-1 (LOCSUB)
024170         MOVE LOC-DESC (LOCSUB) TO PREV-CTLLOC
024180         GO TO CENTRAL-LOCATION-EX.
024190 NEXT-DESCRIPTION-ENTRY.
024200     IF LOC-CODE (LOCSUB) = '+++'
024210         MOVE LOC-DESC (LOCSUB) TO PREV-CTLLOC
024220         GO TO CENTRAL-LOCATION-EX.
024230     ADD 1 TO LOCSUB.
024240     GO TO CENTRAL-LOC-LOOP.
024250 CENTRAL-LOCATION-EX.
024260     EXIT.
024270 END-OF-CODING.

         MACRO
&NAME  GFFM  &DIST,&MOT       FILM FRAME MOTION
         GBLA  &IHBBLC,&IHBBLIM
         LCLA  &WDIST,&WMOT,&BLCBUK
         IHBGAM3
&IHBBLC    SETA  &IHBBLC+4              UPDATE BUFFER-LOC COUNTER
       AIF   (&IHBBLC LE &IHBBLIM).TESTD
         IHBERMAC 182
.TESTD   AIF   (T'&DIST EQ 'O').NOTE1   DETERMINE DISTANCE
       AIF   ('&DIST' EQ 'A').SETDA
       AIF   ('&DIST' EQ 'B').SETDB
       AIF   ('&DIST' EQ 'C').SETDC
       AIF   ('&DIST' EQ 'D').SETDD
.NOTE1   IHBERMAC  180,DISTANCE,D
.SETDD ANOP
&WDIST SETA  4
       AGO   .TESTM
.SETDA ANOP
&WDIST SETA  20
       AGO   .TESTM
.SETDB ANOP
&WDIST SETA  10
       AGO   .TESTM
.SETDC ANOP
&WDIST SETA  0008
.TESTM   AIF   (T'&MOT EQ 'O').NOTE2    DETERMINE FILM MOTION
         AIF   ('&MOT'(1,1) EQ 'F').FWDRT
         AIF   ('&MOT'(1,1) EQ 'B').BACKR
.NOTE2   IHBERMAC  180,MOTION,FORWARD
.FWDRT ANOP
&NAME  DC      H'10960'
       DC    XL2'&WDIST'
       MEXIT
.BACKR ANOP
&NAME  DC      H'10961'
       DC    XL2'&WDIST'
       MEND

         MACRO
&NAME  GFRM  &DIST,&MOT       FILM REGISTRATION MOTION
         GBLA  &IHBBLC,&IHBBLIM
         LCLA  &WDIST,&WMOT,&BLCBUK
         IHBGAM3
&IHBBLC    SETA  &IHBBLC+4              UPDATE BUFFER-LOC COUNTER
       AIF   (&IHBBLC LE &IHBBLIM).TESTD
         IHBERMAC 182
.TESTD   AIF   (T'&DIST EQ 'O').NOTE1
         AIF   (T'&DIST NE 'N').NOTE1
         AIF   (&DIST GT 63).NOTE1
&WDIST   SETA  &DIST
         AGO   .TESTM
.NOTE1   IHBERMAC  180,DISTANCE,0
&WDIST SETA  0
.TESTM AIF   (T'&MOT EQ 'O').NOTE2
         AIF   ('&MOT'(1,1) EQ 'F').FWDRT
         AIF   ('&MOT'(1,1) EQ 'B').BACKR
.NOTE2   IHBERMAC  180,MOTION,FORWARD
.FWDRT ANOP
&NAME  DC      H'10962'
       DC    XL2'&WDIST'
       MEXIT
.BACKR ANOP
&NAME  DC      H'10963'
       DC    XL2'&WDIST'
       MEND

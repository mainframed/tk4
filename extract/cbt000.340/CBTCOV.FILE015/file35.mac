//TKSKD    JOB (S010),'KANWAR',
//             CLASS=S,MSGCLASS=X,MSGLEVEL=(2,1)               /*LREG*/
//STEP3    EXEC SMPSCP,COND=(0,NE),TIME=1439,RES=OLDRES,DLIB=OLDRES,
//      PLIB=NEWCAT
//LINKLIB DD DSN=TKSK.LINKLIB,DISP=SHR,UNIT=SYSDA,VOL=SER=TSOVOL
//SYSPRINT DD DSN=TKSK.LIST,DISP=MOD
//SMPPTFIN     DD  *
++ USERMOD (MM00001)  /*    MMI  MODIFICATION TO HASPCOMM
                          TO DISPLAY THE NUMBER OF PRINT
                          LINES FOR A JOB, IN RESPONSE TO
                          A $D , $L , $DU COMMAND.
                          K. S. KANWAR 9/06/82         */.
++ VER (Z038) FMID(HJE2226) PRE(UZ37497,UZ37266).
++ SRCUPD(HASPCOMM) DISTLIB(HASPSRC).
./ CHANGE NAME=HASPCOMM
         L     R9,DCTPCE                GET POINTER TO PCE  MMI MM00001
         TM    DCTDEVTP,DCTPRPU              PRT/PUN PCE ?  MMI MM00001
         BNO   COFTKSK1              NO DONT BOTHER         MMI MM00001
         L     R9,PWKJOE-PCEDSECT(,R9)  ADDRESS OF WORK JOE MMI MM00001
         L     R0,JOERECCT-JOEDSECT(,R9) TOTAL RECORD COUNT MMI MM00001
         L     R9,DCTPCE                GET POINTER TO PCE  MMI MM00001
         SL    R0,PPLNCDCT-PCEDSECT(,R9)  SUB CURRENT COUNT MMI MM00001
         AL    R0,=F'512'         ROUND RECORD COUNT TO 1K  MMI MM00001
         MVC   12(4,WA),=C'   *'  SET PATTERN IN MESSAGE    MMI MM00001
         SRL   R0,10                    DIVIDE BY 1K        MMI MM00001
         LTR   R0,R0              ZERO RECORD COUNT?        MMI MM00001
         BZ    COFTKSK2            YES BYPASS CONVERSION    MMI MM00001
         $CFCVE VALUE=(R0)              CONVERT TO EBCD     MMI MM00001
         MVC   12(4,WA),COMDWORK+1      MOVE TO DISPLAY     MMI MM00001
COFTKSK2 LA    WA,5(,WA)           POINT TO NEXT BYTE       MMI MM00001
COFTKSK1 EQU   *                                            MMI MM00001
         SLR   R9,R9             ZERO RECORD COUNT          MMI MM00001
         AL    R9,JOERECCT        SUM RECORD COUNT          MMI MM00001
         AL    R9,=F'512'         ROUND RECORD COUNT TO 1K  MMI MM00001
         MVC   1(6,WD),=C'(  *);'   SET PATTERN IN MESSAGE  MMI MM00001
         SRL   R9,10                    DIVIDE BY 1K        MMI MM00001
         LTR   R0,R9              ZERO RECORD COUNT?        MMI MM00001
         BZ    CDFTKSK1            YES BYPASS CONVERSION    MMI MM00001
         $CFCVE VALUE=(R0)              CONVERT TO EBCD     MMI MM00001
         MVC   2(3,WD),COMDWORK+2  MOVE IN VALUE FROM WORKA MMI MM00001
CDFTKSK1 LA    WD,2(,WD)           STEP TO NEXT MSG BYTE    MMI MM00001
         SPACE 2                                            MMI MM00001
         SLR   R9,R9             ZERO RECORD COUNT          MMI MM00001
         SLR   R9,R9             ZERO RECORD COUNT          MMI MM00001
         AL    R9,JOERECCT        SUM RECORD COUNT          MMI MM00001
         AL    R9,=F'512'         ROUND RECORD COUNT TO 1K  MMI MM00001
         MVC   1(6,WA),=C'(  *);'   SET PATTERN IN MESSAGE  MMI MM00001
         SRL   R9,10                    DIVIDE BY 1K        MMI MM00001
         LTR   R0,R9              ZERO RECORD COUNT?        MMI MM00001
         BZ    CLJTKSK1            YES BYPASS CONVERSION    MMI MM00001
         $CFCVE VALUE=(R0)              CONVERT TO EBCD     MMI MM00001
         MVC   2(3,WA),COMDWORK+2  MOVE IN VALUE FROM WORKA MMI MM00001
CLJTKSK1 LA    WA,2(,WA)           STEP TO NEXT MSG BYTE    MMI MM00001
         SLR   R9,R9             ZERO RECORD COUNT          MMI MM00001
//SYSIN   DD  *
 REJECT  S(MM00001) .
 RECEIVE.
 APPLY   S(MM00001) BYPASS(ID) DIS(NO).
//

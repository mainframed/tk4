         TITLE 'P D S  --  ISPF DIALOG DISPLAY CODE'     5/12/86'
*  PDS DIALOG SERVICES                                         SS NOV85
*      LOGICAL LEVELS                                          SS NOV85
*        SERVICES - REQUESTS FROM PDS                          SS NOV85
*        FUCTIONS - SECTIONS OF CODE TO PERFORM SERVICES       SS NOV85
*                   EACH FUCTIONS ROUTES TO NEXT FUCTION       SS NOV85
*                   VIA ISPROUT                                SS NOV85
*        LEVEL 1 SUBROUTINES  - PROVIDE HIGH LEVEL ACTIONS     SS NOV85
*        LEVEL 2 SUBROUTINES  - PROVIDE PRIMITIVE ACTIONS      SS NOV85
*                               I.E. SPF SERVICE INTERFACE     SS NOV85
*                                                              SS NOV85
*                                                              SS NOV85
         TITLE 'P D S  --  ISPF DIALOG MACROS'
         MACRO
&L       $TL   &TB,&F,&F2,&P,&P2,&PMID                         SS AUG85
         LCLC  &TC                                             SS JUL85
&TC      SETC  '&TB'.' '                                       SS JUL85
&L       DC    CL8'&TC'                        *** TABLE OFFSET
         DC    AL1(&F),AL1(&F2)                *** FLAGS 1 AND 2
         DC    AL1(&P),AL1(&P2)                *** PROC1,PROC2 SS NOV84
         DC    AL2(&PMID)                      *** MSGID       SS NOV84
         MEND
         SPACE 2
         MACRO
&L       $TX   &TB,&F,&F2,&P,&P2,&PMID                         SS AUG85
&L       DC    XL2'&TB',XL6'00'                                SS JUL85
         DC    AL1(&F+#X),AL1(&F2)             *** FLAGS 1 AND 2
         DC    AL1(&P),AL1(&P2)                *** PROC1,PROC2 SS NOV84
         DC    AL2(&PMID)                      *** MSGID       SS NOV84
         MEND
         MACRO
&L       $TD   ,                                               SS AUG85
*  ISPF COMMAND TABLE FLAGS                                    SS NOV84
*  FLAG1                                                       SS NOV84
#X       EQU   X'80'   NOT USED                                SS SEP84
#V       EQU   X'40'   VIEW MODE REQUIRED FOR LINE MODE        SS SEP84
#L       EQU   X'20'   VALID FOR LINE COMMANDS                 SS SEP84
#K       EQU   X'10'   DISABLE MEMLIST WITH THIS COMMAND       SS SEP84
#E       EQU   X'08'   END OF TABLE                            SS SEP84
#O       EQU   X'04'   LINE COMMAND ONLY                       SS SEP84
#S       EQU   X'02'   VALID FOR SOURCE ONLY                   SS SEP84
#U       EQU   X'01'   VALID FOR LOADMOD ONLY                  SS SEP84
*  FLAG2                                                       SS NOV84
#C       EQU   X'80'   $TLEX HAS COMMAND TABLE INDEX           SS NOV85
#P       EQU   X'40'   $TLEX HAS POST PROCESS FUNC CODE        SS NOV84
#R       EQU   X'20'   $TLEX HAS OFFSET TO OFFSET OF REAL CMD  SS NOV84
#T       EQU   X'10'   COMMAND LINE FUNC CALL PROVIDED         SS MAR85
*                      LINE COMMAND IS INTERNAL (O RESCAN)     SS NOV85
#D       EQU   X'08'   DO NOT USE FOR REPEATS                  SS NOV84
#M       EQU   X'04'   PERFORM MEMLIST ON MEMBER TO REFR STATS SS NOV84
#2       EQU   X'02'   SUBCOMMAND TURNS OFF VIEW MODE         ABL OCT84
#H       EQU   X'01'   COMMAND ALLOWED FROM O LINE COMMAND    ABL DEC84
* FOLLOWING CODES USED BY SELECT PANEL MODE                    SS NOV84
#Z       EQU   X'10'   USE CONTROL NONDISPL: NO INPUT REQUIRED SS NOV84
#A       EQU   X'08'   ACTIVATE RESCAN IN PANEL MODE           SS NOV84
         SPACE 1                                               SS SEP84
$TLCM    EQU   0       CMD (VALUE, TABLE OFFSET, EXTENDED OFF) SS NOV84
$TLF1    EQU   8       FLAG1                                   SS MAR85
$TLF2    EQU   9       FLAG2                                   SS NOV84
$TLFU    EQU   10      FUNCTION CODE                           SS NOV84
$TLEX    EQU   11      EXTENDED USE CODE                       SS NOV84
$TLMG    EQU   12      MESSAGE OFFSET (2 BYTES)                SS NOV84
$TLEX2   EQU   13      EXTENDED USE CODE                       SS NOV84
         SPACE 2                                               SS NOV84
         MEND
         SPACE 2
*************************************************************  SS JUL84
*                                                              SS JUL84
*        ADDED SUPPORT OF DIALOG DISPLAY MODE USING            SS JUL84
*        A DIALOG TABLE TO DISPLAY PDS OUTPUT                  SS JUL84
*                                                              SS JUL84
*************************************************************  SS JUL84
         SPACE 2                                               SS JUL84
         COPY  PDSGEN73                                        SS NOV85
         TITLE 'P D S  --  ISPF DIALOG DISPLAY CODE'     5/12/86'
ISPDSPY  CSECT
R0       EQU   0                                               SS JUL85
R1       EQU   1                                               SS JUL85
R2       EQU   2                                               SS JUL85
R3       EQU   3                                               SS JUL85
R4       EQU   4                                               SS JUL85
R5       EQU   5                                               SS JUL85
R6       EQU   6                                               SS JUL85
R7       EQU   7                                               SS JUL85
R8       EQU   8                                               SS JUL85
R9       EQU   9                                               SS JUL85
R10      EQU   10                                              SS JUL85
R11      EQU   11                                              SS JUL85
R12      EQU   12                                              SS JUL85
R13      EQU   13                                              SS JUL85
R14      EQU   14                                              SS JUL85
R15      EQU   15                                              SS JUL85
FF       EQU   255                                            ABL OCT85
         USING *,R8                                            SS JUL84
         USING WORKAREA,R7                                     SS JUL85
         ST    R14,SPFSAV14        SAVE 14                     SS JUL84
         STM   R1,R8,SPFSAV1       SAVE REGS 1-8               SS JUL84
         LR    R8,R15              ENTRY AND BASE IN R8        SS JUL84
         ICM   R6,15,SPFXWRK                                   SS NOV85
         BNZ   ISPXOK                                          SS NOV85
         GETMAIN R,LV=SPWRKCL                                  SS NOV85
         LR    R6,R1                                           SS NOV85
         ST    R6,SPFXWRK                                      SS NOV85
ISPXOK   DS    0H                                              SS NOV85
         USING SPWRKC,R6                                       SS NOV85
         LA    R5,2048(,R8)                                    SS SEP84
         LA    R5,2048(,R5)        SECOND BASE                 SS SEP84
         USING ISPDSPY+4096,R5                                 SS SEP84
         TM    SPFLAG0,SPFTABLE    FIRST TIME IN               SS JUL84
         BO    ISPOPT              NO, ALL SET                 SS JUL84
         SPACE 3
* INITIALIZE THE DIALOG VARIABLES                              SS JUL84
         L     R4,ISPVINIA         ADDR OF INIT ROUTINE        SS MAR85
         BALR  R3,R4                                           SS MAR85
         SPACE 3                                               SS SEP84
ISPOPT   DS    0H                                              SS NOV84
         OI    SPFLAG3,SPFREFR        MAKE SURE OF REFRESH     SS NOV84
         SR    R15,R15                                         SS NOV84
         IC    R15,SPFLAG1            FUNCTION CODE            SS JUL84
         B     *+4(R15)               FUNCTION BRANCH TABLE    SS JUL84
         B     ISPEXIT                NOP                      SS JUL84
         B     ISPCLN                 CLEAN UP                 SS JUL84
         B     ISPPTGET               PUTGET                   SS JUL84
         B     ISPPUTL                PUTLINE                  SS JUL84
         B     ISPMEML                ADD LINE TO MEMLIST      SS SEP84
         B     ISPPNSUP               PANEL SUPPORT            SS NOV84
         B     ISPEXIT                PAD                      SS JUL84
         B     ISPEXIT                PAD                      SS JUL84
         SPACE 3
ISPERR   DS    0H                                              SS JUL84
         LR    R4,R2              SAVE R2 FOR DEBUGGING        SS NOV85
         BAL   R2,ISPUSTKM        UNSTACK                      SS NOV85
         NI    SPFLAG0,255-SPFDON-SPFDSUSP-SPFVIEW            ABL JUN85
         NI    SPFLAG2,0             CLEAR MEMLIST MODE       ABL NOV84
         NI    SPFLAG3,SPFSELV       CLEAR MEMLIST MODE       ABL NOV84
         NI    SPFLAG4,0             CLEAR MEMLIST MODE       ABL JUN85
         NI    MEMFLAG0,0            CLEAR MEMLIST MODE       ABL NOV84
         DC    X'00'          FORCE 0C1                        SS JUL84
         SPACE 3
ISPCLN   DS    0H                                              SS JUL84
         BAL   R2,ISPUSTKM        TERMINATE MEMLIST TABLE      SS NOV85
         BAL   R2,ISPTBT#S        TERMINATE ISPMODE TABLE     ABL OCT84
         SPACE 1
         NI    SPFLAG0,0                                       SS SEP84
         NI    SPFLAG2,0                                       SS SEP84
         NI    SPFLAG3,0                                       SS SEP84
         NI    MEMFLAG0,0                                      SS SEP84
         XC    SPFVFLGS,SPFVFLGS  CLEAR ODD VARIABLE FLAGS     SS NOV85
         LA    R14,VRESET         DELETE ALL DIALOG VARIABLES  SS JUL84
         ST    R14,PARMLIST                                    SS JUL84
         OI    PARMLIST+00,X'80'                               SS JUL84
         LA    R1,PARMLIST                                     SS JUL84
         L     R15,ISPLINK                                     SS JUL84
         BALR  R14,R15                                         SS JUL84
         LTR   R15,R15                                         SS JUL84
         BNZ   ISPERR                                          SS JUL84
         LA    R0,SPWRKCL                                      SS NOV85
         LR    R1,R6                                           SS NOV85
         FREEMAIN R,A=(1),LV=(0)                               SS NOV85
         SR    R6,R6                                          ABL FEB86
         ST    R6,SPFXWRK         CLEAR THE WORK AREA POINTER ABL FEB86
         B     ISPEXIT                                         SS JUL84
         TITLE 'P D S  --  ISPF DIALOG ADD LINE TO LOG'
*                                                              SS JUL84
*  ADD ANOTHER DISPLAY LINE                                    SS JUL84
*                                                              SS JUL84
ISPPUTL  DS    0H                                              SS JUL84
         BAL   R2,ISPADDLN                                     SS AUG84
         TM    SPFLAG0,SPFCKER                                 SS SEP84
         BZ    ISPPUTL2                                        SS SEP84
         L     R1,SPFSAV1        RELOAD REGISTER 1            ABL JUN85
         CLI   4+6(R1),C'E'      ERROR TYPE MESSAGE           ABL JUN85
         BNE   ISPPUTL2                                        SS SEP84
         CLC   4+0(3,R1),ISPPDS  "PDS" PREFIX?                ABL JUN84
         BNE   ISPPUTL2          NO, BRANCH                   ABL OCT84
         TM    4+5(R1),X'F0'     NUMERIC?                     ABL JUN84
         BNO   ISPPUTL2          NO, BRANCH                   ABL OCT84
         TM    4+4(R1),X'F0'     NUMERIC?                     ABL JUN84
         BNO   ISPPUTL2          NO, BRANCH                   ABL OCT84
         TM    4+3(R1),X'F0'     NUMERIC?                     ABL JUN84
         BNO   ISPPUTL2          NO, BRANCH                   ABL OCT84
         OI    SPFLAG0,SPFMSGER  FLAG ERROR FOUND              SS SEP84
         MVC   SPFMLIN1(8),4(R1)     SAVE THE ERROR HEADER    ABL JUN85
         MVC   SPFMLIN2(79),SPFLINE  SAVE THE ERROR MESSAGE   ABL JUN85
ISPPUTL2 DS    0H                                              SS SEP84
         LH    R14,SPFCKPT       COUNT FROM LAST CKPT          SS JUL84
         LA    R14,1(R14)        ONE MORE ENTRY                SS JUL84
         STH   R14,SPFCKPT       SAVE COUNT                    SS JUL84
         CH    R14,SPFCKSZ       TIME FOR NEW CKPT             SS JUL84
         BL    ISPEXIT           DONE WITH PUTLINE            ABL OCT84
         LA    R14,ISPCNTL        CONTROLTABLE                ABL JUN85
         LA    R15,ISPDSP                                     ABL JUN85
         LA    R0,ISPREF                                      ABL JUN85
         STM   R14,R0,PARMLIST                                ABL JUN85
         OI    PARMLIST+08,X'80'                              ABL JUN85
         LA    R1,PARMLIST                                    ABL JUN85
         L     R15,ISPLINK                                    ABL JUN85
         BALR  R14,R15                                        ABL JUN85
         LTR   R15,R15                                        ABL JUN85
         BNZ   ISPERR                                         ABL JUN85
ISPATCK  DS    0H                CHECK POINT TIME              SS JUL84
         L     R1,SPFSTART        REPOSITION TO HERE           SS JUL84
         S     R1,SPFLAST         CALCULATE RELATIVE POSITION  SS JUL84
         BZ    ISPATCK2           IF ZERO SKIP REPOSITON       SS JUL84
         ST    R1,SPFFIXED        SAVE VALUE                   SS JUL84
         LA    R14,TBSKIP         CONTROLTABLE                 SS JUL84
         LA    R15,SPFTBL                                      SS JUL84
         LA    R0,SPFFIXED                                     SS JUL84
         STM   R14,R0,PARMLIST                                 SS JUL84
         OI    PARMLIST+08,X'80'                               SS JUL84
         LA    R1,PARMLIST                                     SS JUL84
         L     R15,ISPLINK                                     SS JUL84
         BALR  R14,R15                                         SS JUL84
         C     R15,ISPL8                                       SS JUL84
         BH    ISPERR                                          SS JUL84
ISPATCK2 DS    0H                CHECK POINT TIME              SS JUL84
         OI    ##ADRPA#,$A+$D           IGNORE ATTENTION NOW   SS JUL84
         LA    R15,100            TBDISPL SUPPORT              SS NOV85
         B     ISPROUT                                         SS NOV85
ISPATCK5 DS    0H                                              SS NOV85
         MVC   SPFMSGID,ISPPDSM       SET UP INVALID MESSAGE  ABL DEC84
         MVI   SPFMSGID+6,C'3'        ADD PANELID             ABL DEC84
         B     ISPATCK2                                        SS NOV85
ISPATCK4 DS    0H                                             ABL DEC84
         BAL   R2,ISPBOTM             REPOSITION FOR NEXT ADD  SS AUG84
         MVC   SPFSTART,SPFTDTOP      NEXT DISPLAY SAME PLACE  SS AUG84
         LA    R14,0                                           SS JUL84
         STH   R14,SPFCKPT        RESET CKPT VALUE             SS JUL84
         L     R14,SPFLAST                                     SS JUL84
         CH    R14,SPFMAX         OVER MAX                     SS JUL84
         BL    ISPEXIT                                         SS JUL84
*            CODE TO DELETE OLD OUTPUT IF OVER TABLE MAX       SS JUL84
         LH    R14,SPFMAX         MAX                          SS JUL84
         LNR   R14,R14            NEGATIVE .. BACKUP VALUE     SS JUL84
         ST    R14,SPFFIXE2       SAVE                         SS JUL84
         A     R14,SPFLAST        CALC DEL AMOUNT              SS JUL84
         ST    R14,SPFFIXED       SAVE                         SS JUL84
         L     R1,SPFSTART                                     SS JUL84
         SR    R1,R14             ADJUST SPFSTART              SS JUL84
         BP    ISPSTOK            NEGATIVE IS THAT LINE DELETE SS JUL84
         LA    R1,1               DISPLAY AT LINE 1            SS JUL84
ISPSTOK  ST    R1,SPFSTART        NEW START LINE VALUE         SS JUL84
         BAL   R2,ISPDEL          POSITION AND DELETE          SS JUL84
         BAL   R2,ISPQUERY        NEW TABLE SIZE               SS JUL84
         B     ISPEXIT                                         SS JUL84
ISPNWCMD DS    0H                                              SS JUL84
         BAL   R2,ISPBOTM             REPOSITION FOR NEXT ADD  SS AUG84
         MVC   SPFSTART,SPFTDTOP      NEXT DISPLAY SAME PLACE  SS AUG84
         MVC   PMEMCURR(4),PMEMMAX   TERMINATE MEMBER LIST    ABL APR85
         NI    FLAGSAA,255-FMEM#MEM  TURN OFF MEMBER RANGE     SS JUL84
         LA    R14,0
         STH   R14,SPFCKPT        RESET CKPT VALUE             SS JUL84
         LM    R1,R8,SPFSAV1                                   SS JUL84
         L     R14,SPFSAV14                                    SS JUL84
         BR    R14                ATT RETURN                   SS JUL84
         TITLE 'P D S  --  ISPF DIALOG PUT GET'
*                                                              SS JUL84
*  DISPLAY OUTPUT FROM LAST CMD .. ASK FOR NEW CMD             SS JUL84
*                                                              SS JUL84
ISPPTGET DS    0H                                              SS JUL84
         MVC   SPFVTPT,SPFSAVPT       RESTORE   POINTER        SS NOV85
         LA    R1,3                 PANEL 3                    SS NOV85
         CH    R1,SPFTBPI           THE SAME                   SS NOV85
         BNE   ISPPTGT9             NO                         SS NOV85
         LA    R1,0                 POP IT                     SS NOV85
         BAL   R2,ISPSTKI           DO IT                      SS NOV85
ISPPTGT9 DS    0H                                              SS NOV85
         AIF   ('&ALICHK' EQ 'NO').NOALIAS                    ABL APR86
         TM    SPFLAG2,SPFSEQ       NEW MEMBER LIST?          ABL APR86
         BNO   ISPPTGTA             NO, BRANCH                ABL APR86
         L     R4,ISPALICA          GET ADDR OF SUBRTM        ABL APR86
         BALR  R3,R4                CALL ALIAS CHECK SUBRTN   ABL APR86
ISPPTGTA DS    0H                                             ABL APR86
.NOALIAS ANOP                                                 ABL APR86
         LA    R1,PUTGETBF            SETUP BUFFER             SS JUL84
         ST    R1,ADDRCBUF                        ADDRESS      SS JUL84
         L     R1,SPFSAV1         OUTPUT BUFFER                SS AUG84
         NI    SPFLAG2,255-SPFSEQ-SPFUPDA          CLEANUP     SS NOV85
         NI    SPFLAG4,255-SPF38XA  CLEAR PROMPTING FLAG      ABL DEC84
         CLI   10(R1),C'A'          POSSIBLE ACTION MESSAGE?  ABL DEC84
         BNE   ISPPTGT1             NO, BRANCH                ABL DEC84
         CLC   4(4,R1),ISP300A      PDS3...?                  ABL DEC84
         BNE   ISPPTGT1             NO, BRANCH                ABL DEC84
         CLI   8(R1),C'8'           PDS38.. OR PDS39..?       ABL DEC84
         BL    ISPPTGT1             NO, BRANCH                ABL DEC84
         TM    9(R1),X'F0'          PDS38X. OR PDS39X.?       ABL DEC84
         BNO   ISPPTGT1             NO, BRANCH                ABL DEC84
         OI    SPFLAG4,SPF38XA      YES, SET A FLAG FOR LATER ABL DEC84
         MVI   SPFMLIN2,C' '        CLEAR OUTPUT LINE         ABL MAR86
         MVC   SPFMLIN2+1(78),SPFMLIN2                        ABL MAR86
         LH    R14,0(R1)         LENGTH                       ABL MAR86
         SH    R14,ISPH5         -4 FOR HEADER -1 FOR MVC     ABL MAR86
         CH    R14,ISPH78        MAX LENGTH                   ABL MAR86
         BNH   ISPPTGTM          OK                           ABL MAR86
         LH    R14,ISPH78        TRUNCATE                     ABL MAR86
ISPPTGTM MVC   SPFMLIN2(0),4(R1) MOVE TO DIALOG VARIABLE      ABL MAR86
         EX    R14,*-6                                         SS JUL84
         LA    R1,9               PANEL 9                      SS NOV85
         BAL   R2,ISPSTKI         STACK IT                     SS NOV85
         MVC   SPFMSGID,ISPPDSM   SET MESSAGE ID              ABL JUN85
         MVI   SPFMSGID+6,C'1'    MODIFY MSG  TO PDSM..1R     ABL JUN85
         MVI   SPFMSGID+7,C'R'                                ABL JUN85
ISPPTGT1 DS    0H                                             ABL DEC84
         TM    SPFLAG3,SPFCHN     HAS CHANGE DSN BEEN DONE     SS SEP84
         BZ    ISPPTGT2           NO, SKIP                     SS AUG84
         NI    SPFLAG3,255-SPFCHN-SPF300A CLEAR                SS SEP84
         BAL   R2,ISPUSTKM        UNSTACK                      SS NOV85
         L     R1,SPFSAV1         OUTPUT BUFFER                SS AUG84
ISPPTGT2 DS    0H                                              SS SEP84
         CLC   4(7,R1),ISP300A    SAME OLD MSG                 SS AUG84
         BE    ISPPTGT3           YES, CHECK                   SS AUG84
         BAL   R2,ISPADDLN        NO, DISPLAY IT               SS AUG84
         B     ISPDISPL                                        SS SEP84
ISPPTGT3 DS    0H                                              SS SEP84
         TM    SPFLAG3,SPF300A    HAS 300A OUTPUT ONCE         SS SEP84
         BO    ISPDISPL           YES, SKIP                    SS SEP84
         OI    SPFLAG3,SPF300A    NOW 300A OUTPUT ONCE         SS SEP84
         BAL   R2,ISPADDLN        DISPLAY IT                   SS AUG84
ISPDISPL DS    0H                                              SS JUL84
         TM    SPFLAG4,SPF38XA    NEED A REPLY                 SS NOV85
         BO    ISPDISP4           YES                          SS NOV85
         TM    SPFTFLG1,SPFTLPOS  POST PROCESSING REQUIRED     SS NOV85
         BZ    ISPNPOST           NO                           SS NOV85
         LH    R15,SPFTBPLF       GET FUNCTION CODE            SS NOV85
         B     ISPROUT                                         SS NOV85
ISPNPOST DS    0H                                              SS NOV85
         TM    SPFLAG3,SPFCONV    CONVERT AN ERROR TO VIEW?   ABL OCT84
         BZ    ISPDISP6           NO, BRANCH                   SS NOV85
         TM    SPFLAG0,SPFMSGER   ANY ERRORS?                  SS NOV85
         BZ    ISPDISP6           YES, DISPLAY NOW             SS NOV85
* SHOULD SET R1 FROM PANEL TABLE                               SS NOV85
         LA    R1,2               USE VIEW MODE PANEL          SS NOV85
         BAL   R2,ISPSTKI         STACK PANEL                  SS NOV85
         NI    SPFLAG4,255-SPFCPOST-SPFMCMD TERMINATE OTHERS   SS NOV85
         B     ISPDISP4                                        SS NOV85
ISPDISP6 DS    0H                                             ABL OCT84
         TM    SPFLAG4,SPFCPOST   COMMAND POST PROCESSING      SS NOV84
         BO    ISPCPOST           YES                          SS NOV84
         TM    SPFLAG4,SPFMCMD    MULTY CMD                    SS NOV84
         BO    ISPMCMD            YES                          SS NOV84
ISPDISP4 DS    0H                                              SS NOV85
         LA    R15,100            ROUTE TO PANEL DISPLAY       SS NOV85
         B     ISPROUT            ROUTE SUPPORT                SS NOV85
         TITLE 'P D S  --  ISPF DIALOG SIMPLE FUNCTIONS'
*    FUNCTION SELECTION                                        SS NOV84
ISPOPTT  DS    0H                                              SS NOV84
         L     R14,SPFTBPCD       LOAD COMMAND TABLE ADDR      SS NOV85
ISPOPT2  DS    0H                                              SS NOV85
         LA    R1,SPFINPUT        POINT TO INPUT               SS NOV84
         BAL   R2,ISPVERG         CHECK IT                     SS NOV84
         C     R15,ISPL8                                       SS NOV84
         BE    ISPOPTIV           TOO LONG                     SS NOV84
         CH    R15,ISPH12                                      SS NOV84
         BE    ISPOPT3            SHOULD BE A COMMAND          SS NOV84
         C     R15,ISPL4                                       SS NOV84
         BNE   ISPOPT4                                         SS NOV84
         BAL   R2,ISPUSTKM        UNSTACK AND KILL MEMLIST     SS NOV85
         L     R14,SPFVTPT                                     SS NOV85
ISPOPT4  DS    0H                                              SS NOV84
         L     R15,SPFOPER                                     SS NOV84
         CLI   0(R15),C'.'        DOT                          SS NOV84
         BNE   ISPFUNC                                         SS NOV84
         MVC   MEMLSAVZ,SPFINPUT  SAVE FOR REPROCESSING        SS NOV84
         OI    SPFLAG4,SPFMCMD         FOR MULIPLE COMMANDS    SS NOV84
         B     ISPFUNC                                         SS NOV84
ISPOPT3  DS    0H                                              SS NOV84
         CLI   SPFNAMEH,C'0'      NUMERIC?                    ABL DEC84
         BL    ISPFUNC            NO, MUST BE A COMMAND        SS NOV84
         B     ISPOPTIV           MUST BE INVALID              SS NOV84
         SPACE 4                                               SS NOV85
ISPMCMD  DS    0H                                              SS NOV84
         NI    SPFLAG4,255-SPFMCMD  RESET FLAG                 SS NOV84
         MVI   SPFVZCMD,C' '                                   SS NOV84
         MVC   SPFVZCMD+1(249),SPFVZCMD                        SS NOV84
         MVC   SPFVZCMD(L'MEMLSAVZ),MEMLSAVZ GET OLD CMD       SS NOV84
         BAL   R2,ISPSHCMD        EXTRACT NEXT COMMAND         SS NOV84
         MVC   SPFINPUT(L'MEMLSAVZ),SPFVZCMD                   SS NOV84
         B     ISPOPTT                                         SS NOV84
         SPACE 2                                               SS NOV84
*                                                              SS NOV84
* PANEL MESSAGE SETUP                                          SS NOV84
*                                                              SS NOV84
ISPOPTIV DS    0H                                              SS NOV84
         MVC   SPFMSGID,ISPPDSM   SET UP INVALID MSG           SS NOV84
* THE FOLLOWING INST SOULD USE A VALUE FROM PANEL TABLE ENTRY  SS NOV85
         MVI   SPFMSGID+6,C'1'                                 SS NOV85
         XC    SPFTCCRP,SPFTCCRP    NOT ON A LINE COMMAND     ABL APR86
         B     ISPDISP4                                        SS NOV85
ISPENDIV DS    0H                                             ABL MAR86
         MVC   SPFMSGID,ISPPDSM   SET UP INVALID MSG          ABL MAR86
* THE FOLLOWING INST SOULD USE A VALUE FROM PANEL TABLE ENTRY ABL MAR86
         MVI   SPFMSGID+6,C'1'                                ABL MAR86
         MVI   SPFMSGID+7,C'E'    END IS NOT ALLOWED          ABL MAR86
         OI    SPFLAG2,SPFNPOS    NO FREEZE/POSITIONING       ABL APR86
         XC    SPFTCCRP,SPFTCCRP  NOT ON A LINE COMMAND       ABL APR86
         B     ISPDISP4                                       ABL MAR86
ISPENDP  DS    0H                END OF PROMPT PANEL           SS NOV85
         LA    R1,0              POP                           SS NOV85
         BAL   R2,ISPSTKI        UNSTACK                       SS NOV85
         OI    SPFLAG3,SPFLOGM    LOG THE COMMAND              SS DEC84
         LA    R15,112              ROUTE TO ISPCMDC           SS NOV85
         BR    R3                                              SS NOV85
ISPMSGIN DS    0H                                              SS NOV84
         MVC   SPFMSGID,ISPPDSM   SET UP ENTER OPTION MSG      SS NOV84
         MVI   SPFMSGID+6,C'9'                                 SS NOV84
         MVI   SPFMSGID+7,C'E'                                 SS NOV84
         B     ISPDISP4                                        SS NOV85
         SPACE 3                                               SS NOV84
ISPCPOST DS    0H                                              SS NOV84
         NI    SPFLAG4,255-SPFCPOST                            SS NOV84
         L     R14,SPFVTPT         GET MY TABLE ENTRY          SS NOV85
         SR    R15,R15                                         SS NOV84
         IC    R15,SPFPOST1         GET POST PROCESSOR INDEX   SS NOV85
         B     ISPROUT              INDEX TO PROCESSOR         SS NOV85
         SPACE 2                                               SS NOV84
ISPFUNC  DS    0H                                              SS NOV84
         L     R14,SPFVTPT                                     SS NOV85
         SR    R15,R15                                         SS NOV84
         IC    R15,$TLFU(R14)                                  SS JUL85
ISPROUT  DS    0H                                              SS SEP85
         LA    R3,*                                            SS SEP85
         L     R4,ISPRTB(R15)                                  SS NOV84
         BR    R4                                              SS SEP85
ISPRTB   DS    0F                                              SS SEP85
* COMMON FUCTIONS                                              SS NOV84
         DC    A(ISPEND)       0    . END COMMAND              SS NOV84
         DC    A(ISPSUSP)      4    . SUSPEND ISPMODE          SS NOV84
         DC    A(ISPKLEAR)     8    . CLEAR ISPMODE TABLE      SS NOV84
         DC    A(ISPTRUNC)    12    . CLEAR ABOVE              SS NOV84
         DC    A(ISPCLIP)     16    . CLEAR BELOW              SS NOV84
         DC    A(ISPOFFIT)    20    . TERMINATE ISPMODE        SS NOV84
         DC    A(ISPCMDCK)    24    . CHECK COMMAND            SS NOV84
         DC    A(ISPOPTIV)    28    . OPTION INVALID           SS NOV84
         DC    A(ISPMSGIN)    32    . PROVIDE INVALID MESSAGE  SS NOV84
         DC    A(ISPALL)      36    . MEMLIST ALL              SS NOV84
         DC    A(ISPDISP6)    40    . ISPMODE DISPLAY          SS NOV84
ISPRCALA DC    A(ISPRCAL)     44    . RECALL                   SS NOV84
         DC    A(ISPSETP)     48    . PROCESS O COMMAND        SS NOV84
*                                                              SS NOV84
* MEMLIST ONLY FUCTIONS                                        SS NOV84
*                                                              SS NOV84
         DC    A(ISPOFFIT)    52    . TERMINATE ISPMODE        SS NOV84
         DC    A(ISPTOMML)    56    . SWITCH TO MEMLIST        SS NOV84
         DC    A(ISPDISPT)    60    . OUTPUT TABLE/DUP 140     SS NOV85
         DC    A(ISPLNC2)     64    . MEMLIST LINE CMD PROC    SS NOV84
         DC    A(ISPTOVW)     68    . SWITCH TO VIEW           SS NOV84
         DC    A(ISPMMOFF)    72    . TURN MEMLIST OFF         SS NOV84
         DC    A(ISPCKSHF)    76    . SWAP PANELS              SS NOV84
         DC    A(ISPCKALI)    80    . ALIAS CHECK              SS NOV84
         DC    A(ISPLOCAT)    84    . LOCATE                   SS NOV84
         DC    A(ISPSUB)      88    . SUBLIST =MEMLIST        ABL APR86
*                                                              SS NOV84
* MORE COMMON FUNCTIONS                                        SS NOV84
*                                                              SS NOV84
         DC    A(ISPUTL11)    92    . UT1 COMMAND              SS NOV84
         DC    A(ISPFIND)     96    . FIND                     SS NOV84
         DC    A(ISPTBDSP)   100    . COMMON TABLE DISPLAY     SS NOV84
         DC    A(ISPOPTT)    104    . PROCESS OPTION           SS SEP85
         DC    A(ISPREPLY)   108    . RETURN PDS REPLY         SS NOV85
         DC    A(ISPCMDC)    112    . COMMON COMMAND EXIT      SS NOV85
*                                                              SS NOV85
* CHECK POINT PROCESSING                                       SS NOV85
*                                                              SS NOV85
         DC    A(ISPNWCMD)   116    . TERMINATE COMMAND        SS NOV85
         DC    A(ISPATCK4)   120    . CONTINUE COMMAND         SS NOV85
         DC    A(ISPATCK5)   124    . INVALID                  SS NOV85
*                                                              SS NOV84
* MORE COMMON FUNCTIONS                                        SS NOV84
*                                                              SS NOV84
         DC    A(0)          128    . RESERVED                 SS NOV85
         DC    A(ISPUNSTK)   132    . UNSTACK PANEL            SS NOV84
         DC    A(ISPMEMG)    136    . MEMLIST GROUP            SS NOV85
         DC    A(ISPDISPT)   140    . OUTPUT TABLE             SS NOV85
*                                                              SS NOV84
* LISTA/LISTV FUNCTIONS                                        SS NOV84
*                                                              SS NOV84
         DC    A(ISPLISTA)   144    . LISTA NEW/REPEAT         SS NOV84
         DC    A(ISPLISTV)   148    . LISTV NEW/UPDATE         SS NOV85
         DC    A(ISPLAVL)    152    . LISTA/V LINE CMDS        SS NOV85
*                                                              SS NOV84
* MORE COMMON FUNCTIONS                                        SS NOV84
*                                                              SS NOV84
         DC    A(ISPENDTB)   156    . END/DEL TB AND UNSTACK   SS NOV84
         DC    A(ISPENDIV)   160    . END COMMAND IS INVALID  ABL MAR86
         SPACE 2                                               SS NOV84
*   REPLY PROCESSING                                           SS NOV85
ISPREPLY DS    0H                                              SS NOV85
         LA    R1,0                 POP PANEL                  SS NOV85
         BAL   R2,ISPSTKI           UNSTACK                    SS NOV85
         OI    SPFLAG3,SPFLOGM      LOG THE COMMAND            SS NOV85
         LA    R15,112              ROUTE TO ISPCMDC           SS NOV85
         CLC   SPFMLIN2(6),ISP381A  PROMPT FOR DATA SET NAME  ABL APR86
         BE    ISPREP4              NO, BRANCH                ABL APR86
         CLC   SPFMLIN2(5),ISP390A  PROMPT FOR YES/NO?        ABL APR86
         BNER  R3                   NO, BRANCH                ABL APR86
         CLI   SPFNAMEH,C'Y'        VALID REPLY?              ABL APR86
         BE    ISPREP4              YES, NO NOT FREEZE        ABL APR86
         CLI   SPFNAMEH,C'N'        VALID REPLY?              ABL APR86
         BNER  R3                   NO, BRANCH                ABL APR86
ISPREP4  OI    SPFLAG2,SPFNPOS      YES, NO FREEZE/POSITION   ABL APR86
         BR    R3                                              SS NOV85
         SPACE  2                                              SS NOV85
ISPENDTB DS    0H                                              SS NOV85
         BAL   R2,ISPTBEND                                     SS NOV85
ISPUNSTK DS    0H                                              SS NOV85
         LA    R1,0                POP PANEL                   SS NOV85
         BAL   R2,ISPSTKI          UNSTACK                     SS NOV85
         TM    SPFTBPF1,SPFTRET    THIS HAVE RETURN PROCESSING SS NOV85
         BO    ISPUNSK2            NO, DISPLAY THIS PANEL      SS NOV85
         TM    SPFTBPF1,SPFTLIN    THIS HAVE LINE CMDS         SS NOV85
         BZ    ISPDISP4            NO, DISPLAY THIS PANEL      SS NOV85
         TM    SPFTFLG1,SPFTLCD    LINE CMD ACTIVE             SS NOV85
         BZ    ISPDISP4            NO, DISPLAY THIS PANEL      SS NOV85
         LH    R15,SPFTBPLF        GET LINE PROC FUNC CODE     SS NOV85
         BR    R3                  RETURN TO ROUTER            SS NOV85
ISPUNSK2 DS    0H                                              SS NOV85
         NI    SPFTBPF1,255-SPFTRET  ONLY ONCE                 SS NOV85
         SR    R15,R15                                         SS NOV85
         IC    R15,SPFTPOSI        GET POST PROC INDEX         SS NOV85
         BR    R3                  RETURN TO ROUTER            SS NOV85
         SPACE 2                                               SS NOV85
ISPEND   MVC   PUTGETBF(13),ISPENDIT END COMMAND INTO BUFFER   SS JUL84
         MVC   PMEMCURR(4),PMEMMAX   TERMINATE MEMBER LIST    ABL APR85
         NI    FLAGSAA,255-FMEM#MEM  TURN OFF MEMBER RANGE     SS JUL84
         SPACE 1
         CLI   PDSENTRY+3,0          ENTRY FROM SPF PANEL?    ABL OCT84
         BE    ISPCLN                YES, NO PROBLEM          ABL OCT84
         BAL   R2,ISPCTLSM                                     SS MAR85
         B     ISPCLN                                          SS JUL84
ISPSUSP  MVC   PUTGETBF(13),ISPDSNMG DSN COMMAND INTO BUFFER   SS JUL84
         NI    SPFLAG0,255-SPFDON    TURN DIALOG DISPLAY OFF   SS JUL84
         OI    SPFLAG0,SPFDSUSP      SUSPEND BIT ON            SS JUL84
         TM    SPFTBPF2,SPFTREP      REPLY PANEL?             ABL APR86
         BNO   ISPSUSP2              NO, BRANCH               ABL APR86
         LA    R1,0                  POP PANEL                ABL APR86
         BAL   R2,ISPSTKI            UNSTACK                  ABL APR86
ISPSUSP2 DS    0H                                             ABL APR86
         BAL   R2,ISPUSTKM        UNSTACK                      SS NOV85
         BAL   R2,ISPCTLSM                                     SS MAR85
         B     ISPEXIT                                         SS JUL84
ISPOFFIT MVC   PUTGETBF(13),ISPDSNMG DSN COMMAND INTO BUFFER   SS JUL84
         LA    R0,ISPCNTL                 FIRST PARAMETER     ABL SEP84
         LA    R1,ISPDSP                  SECOND PARAMETER    ABL SEP84
         LA    R2,ISPSM                   THIRD PARAMETER     ABL SEP84
         LA    R3,=F'1'                   FOURTH PARAMETER    ABL SEP84
         STM   R0,R3,PARMLIST             SAVE ADDRESSES      ABL SEP84
         OI    PARMLIST+12,X'80'          LAST                ABL SEP84
         LA    R1,PARMLIST                    PARAMETER       ABL SEP84
         L     R15,ISPLINK                                    ABL SEP84
         BALR  R14,R15                    LET SPF KNOW        ABL SEP84
         B     ISPCLN                                          SS JUL84
ISPKLEAR DS    0H                                              SS JUL84
         BAL   R2,ISPTBT#S         TERMINATE ISPMODE TABLE    ABL OCT84
         BAL   R2,ISPCREAT                                     SS JUL84
         B     ISPDISP6                                        SS NOV84
ISPTRUNC DS    0H                                              SS JUL84
         BAL   R2,ISPBOTM             REPOSITION              ABL FEB86
         L     R14,SPFLAST         SIZE                        SS JUL84
         S     R14,SPFTDTOP        LESS DISPLAY POSITION       SS JUL84
         ST    R14,SPFFIXED        DEL THIS AMOUNT             SS JUL84
         LA    R14,0               NO POSITIONING              SS JUL84
         ST    R14,SPFFIXE2            IS LAST ENTRY           SS JUL84
         BAL   R2,ISPDEL           POSITION AND DELETE         SS JUL84
         BAL   R2,ISPQUERY         NEW TABLE SIZE              SS JUL84
         L     R14,SPFLAST         DISPLAY AT BOTTOM OF TABLE  SS JUL84
         ST    R14,SPFSTART                                    SS JUL84
         B     ISPDISP6            REDISPLAY                   SS NOV84
ISPCLIP  DS    0H                                              SS JUL84
         L     R14,SPFTDTOP        DISPLAY TOP                 SS JUL84
         LTR   R14,R14             AT TOP                      SS JUL84
         BZ    ISPCLIP2            YES NO CLIP                 SS JUL84
         BCTR  R14,0               POSITION ONE UP             SS JUL84
         LTR   R14,R14             AT TOP                      SS JUL84
         BZ    ISPCLIP2            YES NO CLIP                 SS JUL84
         ST    R14,SPFFIXED        DEL THIS AMOUNT             SS JUL84
         S     R14,SPFLAST         CALC REPOSITION AMOUNT      SS JUL84
         ST    R14,SPFFIXE2        SAVE                        SS JUL84
         BAL   R2,ISPBOTM             REPOSITION              ABL FEB86
         BAL   R2,ISPDEL           POSITION AND DELETE         SS JUL84
         BAL   R2,ISPQUERY         NEW TABLE SIZE              SS JUL84
ISPCLIP2 LA    R14,1               DISPLAY AT TOP OF TABLE     SS JUL84
         ST    R14,SPFSTART                                    SS JUL84
         B     ISPDISP6            REDISPLAY                   SS NOV84
         SPACE 3                                               SS JUL84
ISPTOMML DS    0H                                              SS SEP84
         NI    SPFLAG0,255-SPFVIEW   TURN OFF SPFVIEW          SS SEP84
         LA    R1,0                  POP                       SS NOV85
         BAL   R2,ISPSTKI            UNSTACK                   SS NOV85
         B     ISPDISP6                                        SS NOV84
*SPDISPX L     R4,ISPDISPA                                    ABL JUN85
*        BALR  R3,R4                 DISPLAY CURRENT TABLE    ABL JUN85
*        B     ISPDISP6                                       ABL JUN85
ISPREFR  DS    0H                                              SS NOV84
         OI    SPFLAG2,SPFUPDA       MUST BE REFRESHED         SS NOV84
ISPALL   MVC   PUTGETBF(16),ISPMALL  MEMLIST ALL INTO BUFFER  ABL NOV84
         NI    SPFLAG0,255-SPFVIEW   TURN OFF VIEW MODE        SS NOV84
ISPALL2  TM    SPFTBPF1,SPFTMLX      MEMLIST SUPPORT PANEL     SS NOV85
         BZ    ISPEXIT                                         SS NOV85
         TM    SPFTBPF1,SPFTLIN      AT MEMLIST PANEL          SS NOV85
         BO    ISPEXIT                                         SS NOV85
         LA    R1,0                  POP                       SS NOV85
         BAL   R2,ISPSTKI            UNSTACK                   SS NOV85
         B     ISPALL2                                         SS NOV84
         SPACE 2
ISPMGRP  DS    0H                                             ABL JUN85
         MVC   PUTGETBF(16),ISPMALL  MEMLIST ALL INTO BUFFER   SS MAR85
         MVI   PUTGETBF+13,C'*'      CONVERT TO LAST GROUP     SS MAR85
         B     ISPEXIT                                         SS MAR85
         SPACE 2
ISPMEMG  DS    0H                                             ABL JUN85
         MVC   PUTGETBF(16),ISPMALL  MEMLIST ALL INTO BUFFER   SS MAR85
         MVI   PUTGETBF+1,13         MODIFY LENGTH FOR INSERT ABL APR85
         CLC   ##SUBCOM+1(7),$ATT+1  ATTRIBUTE SUBCOMMAND?    ABL APR85
         BNE   ISPMEMG2              NO, BRANCH               ABL APR85
         TM    #OPTOPT,X'F0'         ANY CHANGES IN ATTRS?    ABL APR85
         BNO   ISPDISPL              NO, BRANCH               ABL APR85
         B     ISPMEMG3              DO MEMLIST ON MEMBER(S)   SS JAN86
ISPMEMG2 DS    0H                                             ABL APR85
* MEMLIST FOR EDIT                                             SS JAN86
         ICM   R14,15,SPFZDATA       GET RC FROM ISPLINK CALL  SS JAN86
         BNZ   ISPDISPL              NO ZERO, NO SAVE DONE     SS JAN86
ISPMEMG3 DS    0H                                              SS JAN86
         LH    R14,SPFZSAV           GET LENGTH                SS MAR85
         SL    R14,ISPL4             LESS 4 FOR PREFIX         SS MAR85
         LA    R15,SPFZSAV+4         ADDR OF OPERATED          SS MAR85
         BAL   R2,ISPCKBLK           FIND FIRST COMMAND        SS MAR85
         LTR   R15,R15               WE OK                     SS MAR85
         BZ    ISPDISPL              NO                        SS MAR85
         LA    R1,C' '               SCAN FOR BLANK            SS MAR85
         BAL   R2,ISPCLI                                       SS MAR85
         LTR   R15,R15               SHORT BUFFER              SS MAR85
         BZ    ISPDISPL                                        SS MAR85
         LA    R1,ISPPARST           GET STRING PARSE          SS MAR85
         BAL   R2,ISPPARSI           PARSE ROUTINE             SS NOV85
         MVC   SPFMSGID(8),ISPBLK8   CLEAR ANY MESSAGE        ABL JUN85
         LTR   R15,R15               GOOD                      SS MAR85
         BNZ   ISPMGRP               NO, TRY LAST MEMBER GRP  ABL JUN85
         LH    R1,SPFPRLN            GET STRING LENGTH         SS MAR85
         L     R15,SPFPRSR           GET STRING ADDR           SS MAR85
         EX    R1,ISPMEMG0           COPY IT                   SS MAR85
         AH    R1,PUTGETBF           CALULATE LENGTH OF DATA   SS MAR85
         STH   R1,PUTGETBF           STORE NEW LENGTH          SS MAR85
         OI    SPFLAG2,SPFUPDA       MUST BE REFRESHED         SS MAR84
         B     ISPEXIT                                         SS MAR85
ISPMEMG0 MVC   PUTGETBF+12(0),0(R15) COPY MEMBER OR  GROUP     SS MAR85
         SPACE 2
ISPMMOFF DS    0H                                              SS SEP84
         BAL   R2,ISPUSTKM        UNSTACK                      SS NOV85
         NI    SPFLAG0,255-SPFVIEW   TURN OFF VIEW MODE        SS NOV84
         B     ISPDISP6              NORMAL MODE               SS NOV84
ISPLOCAT DS    0H                                             ABL OCT84
         L     R15,SPFOPER           GET BLANK AFTER COMMAND   SS NOV84
         LA    R14,45                LOOK THIS FAR             SS NOV84
         BAL   R2,ISPCKBLK           FIND NON-BLANK OPERAND    SS NOV84
         MVC   MEMLNMSV,0(R15)       COPY OPERAND              SS SEP84
         OC    MEMLNMSV,ISPBLK8      UPPER CASE               ABL OCT84
         BAL   R2,ISPLOCI                                      SS NOV85
         NI    MEMFLAG0,255-MEMLGOTT  MAKE SURE TOP RESET      SS SEP84
         B     ISPDISP4              REDISPLAY NEW PLACE       SS NOV85
ISPTOVW  DS    0H                                              SS SEP84
         OI    SPFLAG0,SPFVIEW       TURN ON  SPFVIEW          SS SEP84
         LA    R1,2                  VIEW MODE PANEL           SS NOV85
         BAL   R2,ISPSTKI            STACK                     SS NOV85
         B     ISPDISP6              DISP IN VIEW MODE         SS NOV84
ISPCKSHF DS    0H                                              SS SEP84
         LH    R1,SPFTBPIN           NEXT PANEL INDEX          SS NOV85
         LTR   R1,R1                 ZERO                      SS NOV85
         BZ    ISPDISP6                                        SS NOV85
         LNR   R1,R1                                           SS NOV85
         BAL   R2,ISPSTKI           SWAP NEW PANEL             SS NOV85
         B     ISPDISP6                                        SS NOV85
*        TM    SPFLAG4,SPFSHIFT     OTHER TABLE                SS SEP84
*        BO    ISPMMLD7             YES                        SS SEP84
*        OI    SPFLAG4,SPFSHIFT     OTHER TABLE                SS SEP84
*        B     ISPDISP6                                        SS NOV84
*SPMMLD7 NI    SPFLAG4,255-SPFSHIFT BACK TO TABLE 6            SS SEP84
*        B     ISPDISP6                                        SS NOV84
         SPACE 2                                               SS SEP84
ISPCKALI DS    0H                                              SS SEP84
         L     R4,ISPALICA          GET ADDR OF SUBRTM         SS MAR85
         BALR  R3,R4                CALL ALIAS CHECK SUBRTN    SS MAR85
         B     ISPDISP6             CONTINUE                   SS NOV84
         SPACE 2                                               SS SEP84
         SPACE 3                                               SS NOV84
*                                                              SS MAR85
*   FORMAT UT1 COMMAND                                         SS MAR85
*                                                              SS MAR85
ISPUTL11 DS    0H                                              SS MAR85
         MVC   PUTGETBF(4),ISPCMD21                            SS MAR85
         MVC   SPFINPUT(8),$UT1   COPY CMD NAME                SS MAR85
*        MVC   SPFINPUT+08(5),ISPUTDOT INSERT LITERAL UT.     ABL FEB86
         TM    $TLF2(R14),#R       IS REAL COMMAND HERE        SS MAR85
         BO    ISPUTL41            YES, USE AFTER UT.          SS MAR85
         LA    R15,$TLCM(R14)      COMMAND NAME                SS JUL85
         B     ISPUTL51            USE IT                      SS MAR85
ISPUTL41 DS    0H                                              SS MAR85
         SR    R15,R15             CLEAR FOR INSERT            SS MAR85
         IC    R15,$TLEX(R14)      GET OFFSET OF REAL CMD      SS MAR85
         LA    R15,ISPREAL(R15)    GET ADDRESS                 SS MAR85
ISPUTL51 DS    0H                                              SS MAR85
         MVC   SPFINPUT+08(4),0(R15) INSERT 4 CHAR OF CMD     ABL FEB86
ISPUTL71 DS    0H                                              SS MAR85
         LA    R15,24              TO CMDCK                    SS NOV85
         B     ISPROUT             USE ROUTER                  SS NOV85
         SPACE 3                                               SS NOV84
*                                                              SS NOV84
*  MEMLIST ADD LINE FUNCTION                                   SS JUL84
*                                                              SS JUL84
ISPMEML  DS    0H                                              SS SEP84
         L     R4,MEMLFUNA        GET MEMLIST SUB              SS NOV85
         BALR  R3,R4                                           SS NOV85
         TM    FLAGSII,FMEMLIST   IF/FIND .. THEN(MEMLIST)?   ABL APR86
         BNO   ISPEXIT            NO, BRANCH                  ABL APR86
         MVI   SPFLAG1,0          TURN OFF FUNCTION           ABL APR86
         L     R8,=V(SUBLIST)     INVOKE                      ABL APR86
         BR    R8                       SUBLIST               ABL APR86
         SPACE 2                                               SS SEP84
*                                                              SS NOV84
*  SUPPORT REQUEST  SELECT PANEL DISPLAY (SUBCOMMANDS UT1,UT2) SS NOV84
*                                                              SS NOV84
ISPPNSUP DS    0H                                              SS NOV84
         MVI   SPFVZCMD,C' '                                   SS NOV84
         MVC   SPFVZCMD+1(249),SPFVZCMD                        SS NOV84
         LH    R15,SPFZLEN        GET LENG                     SS NOV84
         LTR   R15,R15            ZERO                         SS NOV84
         BZ    ISPPNSU3                                        SS NOV84
         BCTR  R15,0              LESS 1 MVC                   SS NOV84
         L     R14,SPFZDATA       PASSED ZCMD DATA             SS NOV84
ISPPNSU4 MVC   SPFVZCMD(0),0(R14)                              SS NOV84
         EX    R15,ISPPNSU4       COPY TO CMD FROM INPUT       SS NOV84
         BAL   R2,ISPFIRST        CHECK FOR ANY REAL DATA      SS NOV84
         LTR   R15,R15            CHECK RETURN ADDRESS/RC      SS MAR85
         BZ    ISPPNSU3           ALL BLANK                    SS MAR85
ISPPNSU2 DS    0H                                              SS NOV84
         OI    SPFLAG4,SPFNOND       INVOKE PANEL NON-DISPLAY  SS AUG85
ISPPNSU3 DS    0H                                              SS NOV84
         BAL   R2,ISPSETVI                                     SS NOV85
         MVC   SPFPANT2(12),SPFPANT  SAVE ISPMODE PAN SUPPORT  SS NOV84
         MVC   SPFPSTK2(8),SPFSAVP2  GET PASSED PANEL NAME     SS AUG85
         MVC   SPFMEMB,SPFSAVM2   GET PASSED MEMBER NAME       SS AUG85
         LA    R1,SPFPSTK2                                     SS NOV84
         ST    R1,SPFPANT                                      SS NOV84
         ST    R1,SPFPANC                                      SS NOV84
         LA    R1,SPFPSTKE                                     SS NOV84
         ST    R1,SPFPANB2                                     SS NOV84
         BAL   R2,ISPPANDI                                     SS NOV85
         MVC   SPFPANT(12),SPFPANT2  RESTORE ISPNODE PAN SUPPO SS NOV84
         LA    R1,SPFZSEL                                      SS NOV84
         ST    R1,SPFSAV1         RETURN DATA                  SS SEP84
         B     ISPEXIT                                         SS SEP84
         TITLE 'P D S  --  ISPF DIALOG LV2 SUBROUTINES'
*                                                              SS JUL84
*  LEVEL 2 SUBROUTINES                                         SS JUL84
*                                                              SS JUL84
ISPSXEQ0 DS    0H                                              SS MAR85
         LA    R1,PARMLIST                                     SS JUL84
         L     R15,ISPLINK                                     SS JUL84
         BALR  R14,R15                                         SS JUL84
         LTR   R15,R15                                         SS JUL84
         BNZ   ISPERR                                          SS JUL84
         BR    R2                                              SS SEP84
ISPSXEQ8 DS    0H                                              SS MAR85
         LA    R1,PARMLIST                                     SS JUL84
         L     R15,ISPLINK                                     SS JUL84
         BALR  R14,R15                                         SS JUL84
         C     R15,ISPL8                                       SS JUL84
         BH    ISPERR                                          SS JUL84
         BR    R2                 RETURN                       SS JUL84
         SPACE 1                                              ABL SEP84
* CONTROL DISPLAY SESSION MGR  (REFRESH)                       SS MAR85
ISPCTLSM DS    0H                                              SS MAR85
         LA    R14,ISPCNTL                FIRST PARAMETER     ABL APR85
         LA    R15,ISPDSP                 SECOND PARAMETER    ABL APR85
         LA    R0,ISPSM                   THIRD PARAMETER     ABL APR85
         LA    R1,=F'1'                   FOURTH PARAMETER    ABL APR85
         STM   R14,R1,PARMLIST            SAVE ADDRESSES      ABL APR85
         OI    PARMLIST+12,X'80'          LAST                ABL APR85
         B     ISPSXEQ0                                        SS MAR85
         SPACE 3                                               SS JUL84
*                                                              SS JUL84
*  VDEFINE SUPPORT SUBROUTINE: BEFORE ENTRY SET:               SS JUL84
*  R14=ADDR OF VARIABLE NAME                                   SS JUL84
*  R15=ADDR OF VARIABLE                                        SS JUL84
*  R1 =ADDR OF VARIABLE LENGTH                                 SS JUL84
*                                                              SS JUL84
ISPVDEF  DS    0H                                              SS SEP84
         LA    R0,ISPCHAR                                      SS SEP84
         STM   R14,R1,PARMLIST+4                               SS JUL84
         OI    PARMLIST+16,X'80'                               SS JUL84
         LA    R14,VDEFINE         START VDEFINES              SS JUL84
         ST    R14,PARMLIST                                    SS JUL84
         B     ISPSXEQ0                                        SS MAR85
         SPACE 2                                               SS SEP84
*  VDEFINE EXTENDED SUPPORT
*  R1 ADDR OF A DEFINE  CNTL AND LIST AS FOLLOWS               SS
*  CNTL BYTE OFFSET, HALF WORD                                 SS
*  CNTL BIT  (BIT WITHIN BYTE)                                 SS
*  RESERVED BYTE                                               SS
*  REPEATED ENTRIES AS FOLLOWS:                                SS
* ADDR OF VARIABLE NAME OR NAME LIST , FULL WORD               SS NOV85
* OFFSET TO STORAGE FOR VARIABLE(S)  , HALF WORD               SS NOV85
* LENGTH OF THE VARIABLE             , HALF WORD               SS NOV85
* X'FF' TO END LIST                                            SS NOV85
*                                                              SS NOV85
ISPVDEFX DS    0H                                              SS NOV85
         LH    R14,0(R1)           GET CNTL BYTE OFFSET        SS NOV85
         LA    R14,SPFVFLGS(R14)   CALC ADDR OF CNTL BYTE      SS NOV85
         IC    R15,2(R1)           GET CNTL BIT                SS NOV85
         EX    R15,ISPVTM          IS BIT ALREADY SET          SS NOV85
         BOR   R2                  YES SKIP IT                 SS NOV85
         EX    R15,ISPVOI          SET THE BIT                 SS NOV85
         LA    R1,4(R1)            FIRST ENTRY IN LIST         SS NOV85
         LA    R14,VDEFINE         START VDEFINES              SS NOV85
         ST    R14,PARMLIST                                    SS NOV85
         LA    R15,ISPCHAR         THIS ROUTINE ONLY FOR CHAR  SS NOV85
         LA    R0,PARMLIST+20      WHERE LENGTH IS STORED      SS NOV85
         STM   R15,R0,PARMLIST+12                              SS NOV85
ISPVLOOP DS    0H                                              SS NOV85
         CLI   0(R1),X'FF'         END OF LIST                 SS NOV85
         BER   R2                  ALL DONE                    SS NOV85
         MVC   PARMLIST+4(4),0(R1) COPY VAR NAME ADDR          SS NOV85
         LH    R14,4(R1)           GET OFFSET                  SS NOV85
         LA    R14,SPWRKC(R14)     CALC ADDR                   SS NOV85
         ST    R14,PARMLIST+8                                  SS NOV85
         LH    R0,6(R1)            GET LENGTH                  SS NOV85
         ST    R0,PARMLIST+20      PUT LENGTH HERE             SS NOV85
         OI    PARMLIST+16,X'80'                               SS NOV85
         ST    R1,PARMLIST+24      SAVE R1                     SS NOV85
         LA    R1,PARMLIST                                     SS JUL84
         L     R15,ISPLINK                                     SS JUL84
         BALR  R14,R15                                         SS JUL84
         LTR   R15,R15                                         SS JUL84
         BNZ   ISPERR                                          SS JUL84
         L     R1,PARMLIST+24      RESTORE R1                  SS NOV85
         LA    R1,8(,R1)           NEXT ENTRY                  SS NOV85
         B     ISPVLOOP                                        SS NOV85
ISPVTM   TM    0(R14),0            <<EXECUTED>>                SS NOV85
ISPVOI   OI    0(R14),0            <<EXECUTED>>                SS NOV85
         SPACE 2                                               SS SEP84
*            CODE TO POSITION TO FIRST NON BLANK IN INPUT      SS JUL84
ISPFIRST DS    0H                                              SS SEP84
         LA    R15,SPFVZCMD           START OF ZCMD            SS NOV84
         LA    R14,48                 INPUT SIZE               SS JUL84
ISPCKBLK CLI   0(R15),C' '            BLANK                    SS JUL84
         BNE   ISPNONBL                                        SS JUL84
         LA    R15,1(,R15)            NEXT CHAR                SS JUL84
         BCT   R14,ISPCKBLK                                    SS JUL84
         SR    R15,R15                ERROR                    SS JUL84
ISPNONBL DS    0H                                              SS JUL84
         BR    R2                                              SS SEP84
         SPACE 2                                               SS SEP84
*            CODE TO POSITION DATA AFTER PERIOD                SS NOV84
ISPSHCMD DS    0H                                              SS NOV84
         LA    R15,SPFVZCMD           START OF ZCMD            SS NOV84
         LA    R14,48                 INPUT SIZE               SS NOV84
ISPSHBLK CLI   0(R15),C' '            BLANK                    SS NOV84
         BNE   ISPSHBL2                                        SS NOV84
         LA    R15,1(,R15)            NEXT CHAR                SS NOV84
         BCT   R14,ISPSHBLK                                    SS NOV84
         SR    R15,R15                ERROR                    SS NOV84
ISPSHBL2 CLI   0(R15),C' '            BLANK                    SS NOV84
         BE    ISPSHBL3                                        SS NOV84
         CLI   0(R15),C'.'            PERIOD                   SS NOV84
         BE    ISPSHPRD                                        SS NOV84
         LA    R15,1(,R15)            NEXT CHAR                SS NOV84
         BCT   R14,ISPSHBL2                                    SS NOV84
ISPSHBL3 DS    0H                                              SS NOV84
         MVI   SPFVZCMD,C' '          BLANK                    SS NOV84
         MVC   SPFVZCMD+1(249),SPFVZCMD  RIPPLE                SS NOV84
         BR    R2                                              SS NOV84
ISPSHPRD DS    0H                                              SS NOV84
         LA    R15,1(,R15)                                     SS NOV84
         LA    R1,SPFVZCMD+250                                 SS NOV84
         SR    R1,R15                                          SS NOV84
ISPSHR2  MVC   SPFVZCMD(0),0(R15)     SHIFT BACK               SS NOV84
         EX    R1,ISPSHR2                                      SS NOV84
         LA    R15,SPFVZCMD(R1)                                SS NOV84
         LA    R1,SPFVZCMD+250                                 SS NOV84
         SR    R1,R15                                          SS NOV84
         MVI   0(R15),C' '                                     SS NOV84
         BCTR  R1,0                                            SS NOV84
         BCTR  R1,0                                            SS NOV84
ISPSHR3  MVC   1(0,R15),0(R15)                                 SS NOV84
         EX    R1,ISPSHR3                                      SS NOV84
         BR    R2                                              SS SEP84
         SPACE 2                                               SS SEP84
*  CODE TO FIND CHAR MATCH                                     SS MAR85
ISPCLI   DS    0H                                              SS MAR85
ISPCLILP EX    R1,ISPCLI0         USE CHAR IN R1 FOR COMPARE   SS MAR85
         BER   R2                 DONE IF EQU .. RETURN        SS MAR85
         LA    R15,1(,R15)        NEXT CHAR                    SS MAR85
         BCT   R14,ISPCLILP       CHARS LEFT COUNT DOWN        SS MAR85
         SR    R15,R15            RETURN 0 IF NONE FOUND       SS MAR85
         BR    R2                                              SS MAR85
ISPCLI0  CLI   0(R15),0           <<EXECUTED>>                 SS MAR85
         SPACE 2                                               SS MAR85
*  CODE TO FIND CHAR MATCH WORKING BACKWARD                    SS MAR85
ISPCLIB  DS    0H                                              SS MAR85
ISPCLIL2 EX    R1,ISPCLI0         USE CHAR IN R1 FOR COMPARE   SS MAR85
         BER   R2                 DONE IF EQU .. RETURN        SS MAR85
         BCTR  R15,0              NEXT CHAR BACK               SS MAR85
         BCT   R14,ISPCLIL2       CHARS LEFT COUNT DOWN        SS MAR85
         SR    R15,R15            RETURN 0 IF NONE FOUND       SS MAR85
         BR    R2                                              SS MAR85
         SPACE 2                                               SS MAR85
ISPCREF  DS    0H                                              SS NOV84
         LA    R14,ISPCNTL        CONTROLTABLE                 SS JUL84
         LA    R15,ISPDSP                                      SS JUL84
         LA    R0,ISPREF                                       SS JUL84
         STM   R14,R0,PARMLIST                                 SS JUL84
         OI    PARMLIST+08,X'80'                              ABL JUN85
         LA    R1,PARMLIST                                     SS JUL84
         L     R15,ISPLINK                                     SS JUL84
         BALR  R14,R15                                         SS JUL84
         LTR   R15,R15                                         SS JUL84
         BNZ   ISPERR                                          SS JUL84
         NI    SPFLAG3,255-SPFREFR                             SS NOV84
         BR    R2                                              SS NOV84
         SPACE 2                                               SS SEP84
ISPDVGET DS    0H                                              SS NOV84
         LA    R14,VGET               VGET                    ABL OCT84
         LA    R15,VZVERB             ZVERB                   ABL OCT84
         LA    R0,ISPSHARE            SHARED                  ABL OCT84
         STM   R14,R0,PARMLIST                                ABL OCT84
         OI    PARMLIST+8,X'80'                               ABL OCT84
         B     ISPSXEQ0                                        SS MAR85
         SPACE 2                                               SS SEP84
*   TB OPEN (CREATE)                                           SS NOV85
*   R0=ADDR OF VAR NAMES                                       SS NOV85
*   R15=ADDRES OF KEY VAR NAME (OR 0)                          SS NOV85
ISPTBOPN DS    0H                                              SS NOV85
         OI    SPFTFLG1,SPFTACT                                SS NOV85
         LA    R1,ISPNOWRT       NO WRITE                      SS NOV85
         LA    R14,SPFTBL                                      SS NOV85
         STM   R14,R1,PARMLIST+4                               SS NOV85
         LA    R14,TBCREATE                                    SS NOV85
         ST    R14,PARMLIST                                    SS NOV85
         OI    PARMLIST+16,X'80'                               SS NOV85
         B     ISPSXEQ0                                        SS NOV85
         SPACE 2                                               SS SEP84
ISPCREAT DS    0H                                              SS JUL84
         MVI   SPFTBL+2,C'S'      MAKE NAME "PDS"              SS SEP84
         LA    R14,TBCREATE       CREATE TABLE                 SS JUL84
         ST    R14,PARMLIST                                    SS JUL84
         LA    R14,SPFTBL                                      SS JUL84
         LA    R15,0                                           SS JUL84
         LA    R0,VSPFLIN                                      SS JUL84
         LA    R1,ISPNOWRT                                     SS JUL84
         STM   R14,R1,PARMLIST+4                               SS JUL84
         OI    PARMLIST+16,X'80'                               SS JUL84
ISPCREA2 LA    R1,PARMLIST                                     SS JUL84
         L     R15,ISPLINK                                     SS JUL84
         BALR  R14,R15                                         SS JUL84
         LTR   R15,R15                                         SS JUL84
         BZ    ISPIDONE                                        SS JUL84
         C     R15,ISPL8          DUPLICATE NAME               SS JUL84
         BNE   ISPERR             NO, MUST BE SEVERE ERROR     SS JUL84
         CLI   SPFTBL+7,C'9'      TRIED 9 TIMES                SS JUL84
         BE    ISPERR             YES, GIVE UP                 SS JUL84
         SR    R15,R15                                         SS JUL84
         LA    R15,1(R15)         ADD ONE TO MAKE DIFFERENT    SS JUL84
         STC   R15,SPFTBL+7                                    SS JUL84
         B     ISPCREA2           TRY AGAIN                    SS JUL84
ISPIDONE OI    SPFLAG0,SPFTABLE  GOOD TABLE CREATED            SS JUL84
         XC    SPFTFLG1(4),SPFTFLG1                            SS NOV85
         XC    SPFTFF(2),SPFTFF                                SS NOV85
         CLI   SPFLAG1,SPFPTGET   HAVE LINE TO ADD             SS SEP84
         BE    ISPADDLN                                        SS SEP84
         CLI   SPFLAG1,SPFPUTL    LINE WILL BE ADDED SOON      SS SEP84
         BER   R2                                              SS SEP84
         B     ISPADD1           MAKE TABLE NON EMPTY          SS JUL84
ISPCRMEM DS    0H                                              SS JUL84
         MVC   SPFTBL,SPFCSUF     GET BASE NAME                SS NOV85
         MVI   SPFTBL+2,C'M'      MAKE NAME "PDM"              SS SEP84
         LA    R14,TBCREATE       CREATE TABLE                 SS JUL84
         ST    R14,PARMLIST                                    SS JUL84
         LA    R14,SPFTBL                                      SS JUL84
         LA    R15,MEMLTKEY                                    SS JUL84
         LA    R0,MEMTNAML                                     SS JUL84
         LA    R1,ISPNOWRT                                     SS JUL84
         STM   R14,R1,PARMLIST+4                               SS JUL84
         OI    PARMLIST+16,X'80'                               SS JUL84
         LA    R1,PARMLIST                                     SS JUL84
         L     R15,ISPLINK                                     SS JUL84
         BALR  R14,R15                                         SS JUL84
         LTR   R15,R15            ERROR                        SS JUL84
         BNZ   ISPERR             NO, MUST BE SEVERE ERROR     SS JUL84
         XC    SPFTFLG1(4),SPFTFLG1                            SS NOV85
         XC    SPFTFF(2),SPFTFF                                SS NOV85
         OI    SPFLAG0,SPFMEMT   GOOD TABLE CREATED            SS JUL84
         NI    SPFLAG2,255-SPFMEMA NO ACTIVE YET               SS JUL84
         BR    R2                                              SS SEP84
         SPACE 2                                               SS JUL84
ISPTBT#S MVI   SPFTBL+2,C'S'         TERMINATE ISPMODE TABLE  ABL OCT84
         B     ISPTBEND                                       ABL OCT84
         SPACE 1
ISPTBT#M TM    SPFLAG2,SPFMEMA       TERMINATE MEMLIST TABLE  ABL OCT84
         BZR   R2                    DOES NOT EXIST, RETURN   ABL OCT84
         NI    SPFLAG0,255-SPFCLNM   CLEAR MEMLIST MODE       ABL OCT84
         NI    SPFLAG2,0             CLEAR MEMLIST MODE       ABL OCT84
         NI    SPFLAG3,255-SPFCONV   CLEAR MEMLIST MODE       ABL OCT84
         NI    SPFLAG3,SPFSELV+SPF300A                        ABL NOV84
         NI    MEMFLAG0,0            CLEAR MEMLIST MODE       ABL OCT84
         B     ISPTBEND                                        SS NOV85
         SPACE 1
ISPTBEND DS    0H                                              SS SEP84
         NI    SPFTFLG1,255-SPFTACT                            SS NOV85
         LA    R14,TBEND          END TABLE                    SS JUL84
         LA    R15,SPFTBL         TABLE NAME                   SS JUL84
         STM   R14,R15,PARMLIST                                SS JUL84
         OI    PARMLIST+04,X'80'                               SS JUL84
         B     ISPSXEQ0                                        SS MAR85
         SPACE 2                                               SS JUL84
ISPADD1  DS    0H                                              SS JUL84
         LA    R14,1              SET COUNTS TO ONE            SS JUL84
         ST    R14,SPFSTART           START OF LAST CMD        SS JUL84
         ST    R14,SPFCRP             CPR                      SS JUL84
         ST    R14,SPFTDTOP           DISPLAY TOP              SS JUL84
         LA    R14,0              SET COUNTS TO ZERO           SS JUL84
         STH   R14,SPFCKPT            COUNT FROM LAST CKPT     SS JUL84
         ST    R14,SPFLAST            ZERO SIZE TABLE          SS JUL84
         LA    R1,FIRST4K                                      SS NOV85
         LA    R1,MSGENTDS-FIRST4K(R1) ADD LINE AND RETURN     SS NOV85
         ST    R1,SPFSAV1                                      SS SEP84
         B     ISPADDLN                                        SS SEP84
         SPACE 2                                               SS SEP84
ISPADDLN DS    0H                                              SS JUL84
* ALWAYS ADD TO TBBOTTOM                                       SS NOV85
         LA    R14,TBBOTTOM      ADD TO TABLE                  SS NOV85
         LA    R15,SPFLOGHM      TABLE NAME FOR LOG            SS NOV85
         STM   R14,R15,PARMLIST                                SS NOV85
         OI    PARMLIST+4,X'80'                                SS NOV85
         LA    R1,PARMLIST                                     SS NOV85
         L     R15,ISPLINK                                     SS NOV85
         BALR  R14,R15                                         SS NOV85
         C     R15,ISPL8                                       SS NOV85
         BH    ISPERR                                          SS NOV85
         MVI   SPFLINE,C' '      PRE CLEAR OUTPUT LINE         SS JUL84
         MVC   SPFLINE+1(79),SPFLINE                          ABL APR86
         L     R1,SPFSAV1        OUTPUT BUFFER                 SS JUL84
         LH    R14,0(R1)         LENGTH                        SS JUL84
         SH    R14,ISPH5         -4 FOR HEADER -1 FOR MVC      SS JUL84
         L     R15,ADDRUPT              ADDRESS OF THE UPT    ABL APR85
         TM    UPTSWS-UPT(R15),UPTMID   MESSAGE ID DESIRED?   ABL APR85
         BO    ISPADD79                 YES, BRANCH           ABL APR85
         CLC   4(3,R1),ISPPDS    PDS PREFIX?                  ABL APR85
         BNE   ISPADD79          NO, BRANCH                   ABL APR85
         TM    9(R1),X'F0'       NUMERIC?                     ABL APR85
         BNO   ISPADD79          NO, BRANCH                   ABL APR85
         TM    8(R1),X'F0'       NUMERIC?                     ABL APR85
         BNO   ISPADD79          NO, BRANCH                   ABL APR85
         TM    7(R1),X'F0'       NUMERIC?                     ABL APR85
         BNO   ISPADD79          NO, BRANCH                   ABL APR85
         CLI   11(R1),X'40'      A FOLLOWING BLANK?           ABL APR85
         BNE   ISPADD79          NO, BRANCH                   ABL APR85
         CLI   10(R1),C'I'       INFORMATIONAL MESSAGE?       ABL APR85
         BE    ISPADDLS          YES, BRANCH                  ABL APR85
         CLI   10(R1),C'A'       ACTION MESSAGE?              ABL APR85
         BE    ISPADDLS          YES, BRANCH                  ABL APR85
         CLI   10(R1),C'W'       WARNING MESSAGE?             ABL APR85
         BE    ISPADDLS          YES, BRANCH                  ABL APR85
         CLI   10(R1),C'E'       ERROR MESSAGE?               ABL APR85
         BNE   ISPADD79          NO, BRANCH                   ABL APR85
ISPADDLS DS    0H                                             ABL APR85
         LA    R0,8              LITERAL 8                    ABL APR85
         SR    R14,R0            -8 FOR THE MESSAGE ID        ABL APR85
         AR    R1,R0                                          ABL APR85
ISPADD79 DS    0H                                             ABL APR85
         CH    R14,ISPH79        MAX LENGTH                   ABL APR86
         BNH   ISPMVLIN          OK                            SS JUL84
         LH    R14,ISPH79        TRUNCATE                     ABL APR86
ISPMVLIN MVC   SPFLINE(0),4(R1)  MOVE TO DIALOG VARIABLE       SS JUL84
         EX    R14,*-6                                         SS JUL84
ISPADDCO DS    0H                                              SS MAY85
         CLI   SPFLINE,X'40'     BLANK IN CHARACTER 1         ABL SEP84
         BNE   *+8               NO, BRANCH                   ABL SEP84
         MVI   SPFLINE,0         YES, CONVERT TO NULL         ABL SEP84
         LA    R14,TBADD         ADD TO TABLE                  SS JUL84
         LA    R15,SPFLOGHM      TABLE NAME FOR LOG            SS NOV85
         STM   R14,R15,PARMLIST                                SS JUL84
         OI    PARMLIST+4,X'80'                                SS JUL84
         LA    R1,PARMLIST                                     SS JUL84
         L     R15,ISPLINK                                     SS JUL84
         BALR  R14,R15                                         SS JUL84
         LTR   R15,R15                                         SS JUL84
         BNZ   ISPERR                                          SS JUL84
         L     R14,SPFLAST       TRACK TABLE POSITION          SS JUL84
         LA    R14,1(R14)        ONE MORE ENTRY                SS JUL84
         ST    R14,SPFLAST       SAVE NEW COUNT                SS JUL84
         BR    R2                RETURN                        SS AUG84
         SPACE 2                                               SS JUL84
ISPMEMOD DS    0H                ADD TO TABLE                  SS JUL84
         LA    R14,TBMOD         ADD TO TABLE                  SS SEP84
         LA    R15,SPFTBL                                      SS SEP84
         STM   R14,R15,PARMLIST                                SS SEP84
         OI    PARMLIST+4,X'80'                                SS SEP84
         LA    R1,PARMLIST                                     SS SEP84
         L     R15,ISPLINK                                     SS SEP84
         BALR  R14,R15                                         SS SEP84
         C     R15,ISPL8                                       SS SEP84
         BH    ISPERR                                          SS SEP84
         OI    SPFLAG2,SPFMEMA   MAKE MEMLIST ACTIVE           SS SEP84
         C     R15,ISPL8                                       SS SEP84
         BER   R2                ADDED AT END BY MISTAKE       SS SEP84
         TM    MEMFLAG0,MEMLGOTT TOP SET FIRST TIME            SS SEP84
         BZ    ISPQUERY          NO, QUERY TO GET CPR          SS SEP84
         SR    R15,R15           NORMAL RETURN                 SS SEP84
         BR    R2                RETURN                        SS SEP84
         SPACE 2                                               SS JUL84
ISPMEMAD DS    0H                ADD TO TABLE                  SS JUL84
         LA    R14,TBADD         ADD TO TABLE                  SS SEP84
         LA    R15,SPFTBL                                      SS SEP84
         STM   R14,R15,PARMLIST                                SS SEP84
         OI    PARMLIST+4,X'80'                                SS SEP84
         LA    R1,PARMLIST                                     SS SEP84
         L     R15,ISPLINK                                     SS SEP84
         BALR  R14,R15                                         SS SEP84
         C     R15,ISPL8                                       SS SEP84
         BER   R2                ADDED AT END BY MISTAKE       SS SEP84
         BH    ISPERR                                          SS SEP84
         OI    SPFLAG2,SPFMEMA   MAKE MEMLIST ACTIVE           SS SEP84
         TM    MEMFLAG0,MEMLGOTT TOP SET FIRST TIME            SS SEP84
         BZ    ISPQUERY          NO, QUERY TO GET CPR          SS SEP84
         SR    R15,R15           NORMAL RETURN                 SS SEP84
         BR    R2                RETURN                        SS SEP84
         SPACE 2                                               SS JUL84
ISPMEMSC DS    0H                ADD TO TABLE                  SS JUL84
         LA    R14,TBSCAN        ADD TO TABLE                  SS SEP84
         LA    R15,SPFTBL                                      SS SEP84
* R0 PASSED POINTING TO VAR NAME                               SS SEP84
         STM   R14,R0,PARMLIST                                 SS SEP84
         OI    PARMLIST+8,X'80'                                SS SEP84
         B     ISPSXEQ8                                        SS MAR85
         SPACE 2                                               SS JUL84
*  TB ADD                                                      SS NOV85
ISPTBADD DS    0H                                              SS NOV85
         LA    R14,TBADD         ADD TO TABLE                  SS NOV85
         LA    R15,SPFTBL                                      SS NOV85
         STM   R14,R15,PARMLIST                                SS NOV85
         OI    PARMLIST+4,X'80'                                SS NOV85
         B     ISPSXEQ8                                        SS NOV85
         SPACE 2                                               SS JUL84
*  TB MOD                                                      SS NOV85
ISPTBMOD DS    0H                                              SS NOV85
         LA    R14,TBMOD         NOD TO TABLE                  SS NOV85
         LA    R15,SPFTBL                                      SS NOV85
         STM   R14,R15,PARMLIST                                SS NOV85
         OI    PARMLIST+4,X'80'                                SS NOV85
         B     ISPSXEQ8                                        SS NOV85
         SPACE 2                                               SS JUL84
*  TB PUT                                                      SS NOV85
ISPTBPUT DS    0H                                              SS NOV85
         LA    R14,TBPUT         NOD TO TABLE                  SS NOV85
         LA    R15,SPFTBL                                      SS NOV85
         STM   R14,R15,PARMLIST                                SS NOV85
         OI    PARMLIST+4,X'80'                                SS NOV85
         B     ISPSXEQ8                                        SS NOV85
         SPACE 2                                               SS JUL84
ISPQUERY DS    0H                                              SS JUL84
         LA    R14,TBQUERY        GET CPR                      SS JUL84
         ST    R14,PARMLIST                                    SS JUL84
         LA    R14,SPFTBL         TABLE NAME                   SS JUL84
         LA    R15,0              NO KEYS  - NO KEYNUM         SS JUL84
         LA    R0,0               NO NAMES - NO NAMENUM        SS JUL84
         LA    R1,VSPFFIX2        TABLE SIZE GOES HERE         SS JUL84
         STM   R14,R1,PARMLIST+4                               SS JUL84
         STM   R15,R0,PARMLIST+20                              SS JUL84
         LA    R14,VSPFFIX        CPR GOES HERE                SS JUL84
         ST    R14,PARMLIST+28                                 SS JUL84
         OI    PARMLIST+28,X'80'                               SS JUL84
         LA    R1,PARMLIST                                     SS JUL84
         L     R15,ISPLINK                                     SS JUL84
         BALR  R14,R15                                         SS JUL84
         LTR   R15,R15                                         SS JUL84
         BNZ   ISPERR                                          SS JUL84
         TM    SPFTBPF1,SPFTLOG   LIST TABLE                   SS NOV85
         BZ    ISPQUER2           YES                          SS NOV85
         L     R15,SPFFIXE2       SAVE INFO                    SS JUL84
         LTR   R15,R15                                         SS JUL84
         BZ    ISPADD1            NOW EMPTY, PAD WITH ONE LINE SS JUL84
         ST    R15,SPFLAST                                     SS JUL84
         L     R14,SPFFIXED                                    SS JUL84
         ST    R14,SPFCRP                                      SS JUL84
         BR    R2                                              SS NOV85
ISPQUER2 DS    0H                                              SS SEP84
         SR    R15,R15           NORMAL RETURN                 SS SEP84
         L     R14,SPFFIXE2                                    SS SEP84
         ST    R14,SPFTSIZE                                    SS NOV85
         L     R14,SPFFIXED                                    SS SEP84
         ST    R14,SPFTCRP                                     SS NOV85
         TM    SPFTBPF1,SPFTMLX     MEMLIST                    SS NOV85
         BZR   R2                   NO                         SS NOV85
         TM    MEMFLAG0,MEMLGOTT                               SS SEP84
         BOR   R2                                              SS SEP84
         ST    R14,MEMLTOP                                     SS SEP84
         OI    MEMFLAG0,MEMLGOTT                               SS SEP84
         BR    R2                                              SS SEP84
         SPACE 2                                               SS SEP84
ISPTOP   DS    0H                                              SS AUG84
         LA    R14,TBTOP          PRE POSITION TO BOTTOM       SS JUL84
         B     ISPTWO             SET UP THE REST              SS JUL84
         SPACE 2                                               SS JUL84
ISPBOTM  DS    0H                                              SS AUG84
         LA    R14,TBBOTTOM       PRE POSITION TO BOTTOM       SS JUL84
ISPTWO   DS    0H                                              SS SEP84
         LA    R15,SPFTBL         TABLE NAME                   SS JUL84
         STM   R14,R15,PARMLIST                                SS JUL84
         OI    PARMLIST+04,X'80'                               SS JUL84
         B     ISPSXEQ8                                        SS NOV85
         SPACE 2                                               SS JUL84
ISPGET   DS    0H                                              SS AUG84
         LA    R14,TBGET          GET IT IF IT IS THERE        SS JUL84
         LA    R15,SPFTBL         TABLE NAME                   SS JUL84
         STM   R14,R15,PARMLIST                                SS JUL84
         OI    PARMLIST+04,X'80'                               SS JUL84
         B     ISPSXEQ8                                        SS MAR85
         SPACE 2                                               SS JUL84
*                                                              SS JUL84
*  SPFTTOP  CONTAIN TABLE   NEW POSITION                       SS NOV85
*  SPFTCRP  CONTAIN TABLE   CURRENT POSITION (QUERY FIRST)     SS NOV85
*                                                              SS JUL84
ISPOSTN  DS    0H                                              SS JUL84
         L     R15,SPFTTOP        CALCULATE                    SS NOV85
         LR    R14,R15                                         SS SEP84
         S     R15,SPFTCRP           SKIP AMOUNT + OR -        SS NOV85
         ST    R14,SPFTCRP        SET NEW CRP                  SS NOV85
ISPSKIP  DS    0H                 R15 IS SKIP VALUE            SS SEP84
         LTR   R15,R15            CHECK POSITION               SS JUL84
         BZR   R2                 NO SKIP REQUIRED             SS JUL84
         ST    R15,SPFFIXE2                                    SS SEP84
         LA    R14,TBSKIP         SKIP FUNCTION                SS JUL84
         LA    R15,SPFTBL                                      SS JUL84
         LA    R0,SPFFIXE2                                     SS JUL84
         STM   R14,R0,PARMLIST                                 SS JUL84
         OI    PARMLIST+08,X'80'                               SS JUL84
         B     ISPSXEQ8                                        SS MAR85
         SPACE 2                                               SS NOV84
ISPDEL1  DS    0H                                              SS NOV84
         XC    SPFFIXED,SPFFIXED                               SS NOV84
         XC    SPFFIXE2,SPFFIXE2                               SS NOV84
         MVI   SPFFIXED+3,1                                    SS NOV84
         B     ISPDEL                                          SS NOV84
*                                                              SS JUL84
*  SPFFIXED CONTAIN DELETE COUNT                               SS JUL84
*  SPFFIXE2 CONTAIN SKIP AMOUNT                                SS JUL84
*                                                              SS JUL84
ISPDEL   DS    0H                                              SS JUL84
         ICM   R14,15,SPFFIXE2    CHECK POSITION               SS JUL84
         BZ    ISPNOSK            NO SKIP REQUIRED             SS JUL84
         LA    R14,TBSKIP         SKIP FUNCTION                SS JUL84
         LA    R15,SPFTBL                                      SS JUL84
         LA    R0,SPFFIXE2                                     SS JUL84
         STM   R14,R0,PARMLIST                                 SS JUL84
         OI    PARMLIST+08,X'80'                               SS JUL84
         LA    R1,PARMLIST                                     SS JUL84
         L     R15,ISPLINK                                     SS JUL84
         BALR  R14,R15                                         SS JUL84
         C     R15,ISPL8                                       SS JUL84
         BH    ISPERR                                          SS JUL84
ISPNOSK  L     R14,SPFFIXED       INIT R14                     SS JUL84
         LTR   R14,R14            DEL AMOUNT                   SS JUL84
         BZR   R2                 NO DEL REQUIRED              SS JUL84
ISPDLUP  ST    R14,SPFFIXED       SAVE COUNT LIFT              SS JUL84
         LA    R14,TBDELETE       DELETE HIS LINE              SS JUL84
         LA    R15,SPFTBL         TABLE NAME                   SS JUL84
         STM   R14,R15,PARMLIST                                SS JUL84
         OI    PARMLIST+04,X'80'                               SS JUL84
         LA    R1,PARMLIST                                     SS JUL84
         L     R15,ISPLINK                                     SS JUL84
         BALR  R14,R15                                         SS JUL84
         C     R15,ISPL8                                       SS JUL84
         BH    ISPERR                                          SS JUL84
         BE    ISPQUERY                                        SS JUL84
         L     R14,SPFFIXED      DEL COUNT                     SS JUL84
         BCT   R14,ISPDLUP       DECRAMENT AND LOOP            SS JUL84
         BR    R2                 RETURN                       SS JUL84
         SPACE 2                                               SS JUL84
         SPACE 2                                               SS JUL84
ISPDSPSV DS    0H                                              SS SEP84
         LA    R14,ISPCNTL      CONTROL                        SS SEP84
         LA    R15,ISPDSP       DISPLAY                        SS SEP84
         LA    R0,ISPSAVE       SAVE                           SS SEP84
         STM   R14,R0,PARMLIST                                 SS SEP84
         OI    PARMLIST+8,X'80'                                SS SEP84
         B     ISPSXEQ0                                        SS MAR85
         SPACE 2                                               SS JUL84
ISPDSPRS DS    0H                                              SS SEP84
         LA    R14,ISPCNTL      CONTROL                        SS SEP84
         LA    R15,ISPDSP       DISPLAY                        SS SEP84
         LA    R0,ISPRSTR       RESTORE                        SS SEP84
         STM   R14,R0,PARMLIST                                 SS SEP84
         OI    PARMLIST+8,X'80'                                SS SEP84
         B     ISPSXEQ0                                        SS MAR85
         SPACE 2                                               SS JUL84
*  MESSAGE INSERT ROUTINE                                      SS NOV85
ISPLMSGS DS    0H                                              SS NOV85
         LH    R1,SPFTBPDA            OFFSET TO DATA FIELD     SS NOV85
         LA    R1,SPWRKC(R1)          CALC REAL ADDRESS        SS NOV85
         L     R14,SPFTTPT            MAKE SURE WE HAVE PTR    SS NOV85
         LH    R15,$TLMG(R14)         MSG OFFSET               SS NOV85
         CH    R15,ISPM9000           WE GOT SPECIAL NUMBER    SS NOV85
         BNL   ISPLMSG2               YES, GENERATE MSG        SS NOV85
         AL    R15,ISP$TMGA           CALC MSG ADDR            SS NOV85
         MVC   0(8,R1),0(R15)         MOVE MESSAGE             SS NOV85
         BR    R2                     RETURN                   SS NOV85
ISPM9000 DC    H'9000'                MSG NUM 9000 AND UP      SS NOV85
ISPLMSG2 DS    0H                                              SS NOV85
         MVI   0(R1),C'*'             SET TO *                 SS NOV85
         MVC   1(7,R1),$TLCM(R14)     COPY CMD NAME            SS NOV85
         LA    R15,6                                           SS NOV85
         LA    R1,2(R1)               SKIP OVER *+1 CHAR       SS NOV85
ISPLMSG3 DS    0H                                              SS NOV85
         CLI   0(R1),C' '             BLANK                    SS NOV85
         BE    ISPLMSG4               YES,  SET TO *           SS NOV85
         LA    R1,1(,R1)              NEXT CHAR                SS NOV85
         BCT   R15,ISPLMSG3           FIND END OF CMD          SS NOV85
         BR    R2                     NO END, SKIP IT          SS NOV85
ISPLMSG4 DS    0H                                              SS NOV85
         MVI   0(R1),C'*'             MAKE *                   SS NOV85
         BR    R2                                              SS NOV85
         SPACE 3                                               SS NOV85
*                                                              SS NOV85
* CONVERT DEC TO PRINTABLE                                     SS NOV85
*  R1=DEC VALUE                                                SS NOV85
*                                                              SS NOV85
ISPDECCV DS    0H                                              SS NOV85
         CVD   R1,DOUBLE                                       SS NOV85
         MVC   SPFDCONV,ISPDCNV1                               SS NOV85
         ED    SPFDCONV,DOUBLE+2                               SS NOV85
         BR    R2                                              SS NOV85
ISPDCNV1 DC    X'402020202020202020202120'                     SS NOV85
         SPACE 3                                               SS NOV85
*                                                              SS NOV85
* CONVERT PRINTABLE HEX                                        SS NOV85
*  R1=ONE WORD OF DATA                                         SS NOV85
*                                                              SS NOV85
ISPHEXCV DS    0H                                              SS NOV85
         ST    R1,DOUBLE                                       SS NOV85
         MVI   DOUBLE+4,X'0C'      FAKE SIGN                   SS NOV85
         UNPK  SPFHEXCV(9),DOUBLE(5)                           SS NOV85
         TR    SPFHEXCV(8),ISPHEXTR                            SS NOV85
         BR    R2                                              SS NOV85
         DC    C'0123456789ABCDEF'                             SS NOV85
ISPHEXTR EQU   *-256                                           SS NOV85
         SPACE 3                                               SS NOV85
*                                                              SS NOV85
* CONVERT HEX INPUT TO BINARY                                  SS NOV85
*  R1=BINARY OUT  DATA, INPUT SPFHEXCV                         SS NOV85
*                                                              SS NOV85
ISPBINCV DS    0H                                              SS NOV85
         NC    SPFHEXCV(8),ISPBINC2                            SS NOV85
         TR    SPFHEXCV(8),ISPHEXT2                            SS NOV85
         MVI   SPFHEXCV+8,X'C0'      FAKE SIGN                 SS NOV85
         PACK  DOUBLE(5),SPFHEXCV(9)                           SS NOV85
         L     R1,DOUBLE                                       SS NOV85
         BR    R2                                              SS NOV85
ISPBINC2 DC    X'1F1F1F1F1F1F1F1F'                             SS NOV85
ISPHEXT2 DC    X'00FAFBFCFDFEFF',XL9'00'   00-0F               SS NOV85
         DC    C'0123456789',XL6'00'       10-1F               SS NOV85
         SPACE 3                                               SS NOV85
*                                                              SS NOV85
*   FIND DSAB TO MATCH DDNAME                                  SS NOV85
*   R14=ADDR OF DDNAME                                         SS NOV85
*   R1=RETURNED DSAB ADDRESS OR 0 IF NOT FOUND                 SS NOV85
ISPFDSAB DS    0H                                              SS NOV85
         L     R1,16              CVT                          SS NOV85
         L     R1,0(,R1)          ACT TCB PT                   SS NOV85
         L     R1,4(,R1)          ACT TCB                      SS NOV85
         L     R1,TCBJSCB-TCBRBP(R1)     JSCB                  SS NOV85
         L     R1,JSCDSABQ-IEZJSCB(R1)   DSAB QUE              SS NOV85
         L     R1,12(,R1)                FIRST DSAB            SS NOV85
ISPFDSB1 LTR   R1,R1         END OF DSAB CHAIN                 SS NOV85
         BZR   R2            RETURN WITH R1=0                  SS NOV85
         L     R15,DSABTIOT-DSAB(R1)                           SS NOV85
         CLC   0(8,R14),TIOEDDNM-TIOENTRY(R15)                 SS NOV85
         BER   R2            GOT A MATCH                       SS NOV85
         L     R1,DSABFCHN-DSAB(R1)     NEXT DSAB              SS NOV85
         B     ISPFDSB1                                        SS NOV85
*                                                              SS NOV85
*   DSORG CONVERT TO PRINTABLE                                 SS NOV85
*   R1=ADDRESS OF DSORG INFORMATION                            SS NOV85
*   R0=WILL BE SET TO 4 CHAR DSORG NUMONIC (IE PO PS VSAM)     SS NOV85
*                                                              SS NOV85
ISPDSORG DS    0H            DSORG LEV 2 ROUTINE               SS NOV85
         TM    0(R1),JFCORGIS                                  SS NOV85
         BZ    *+14                                            SS NOV85
         ICM   R0,15,*+6                                       SS NOV85
         BR    R2                                              SS NOV85
         DC    C'ISAM'                                         SS NOV85
         TM    0(R1),JFCORGPO                                  SS NOV85
         BZ    *+14                                            SS NOV85
         ICM   R0,15,*+6                                       SS NOV85
         BR    R2                                              SS NOV85
         DC    C'PO  '                                         SS NOV85
         TM    0(R1),JFCORGPS                                  SS NOV85
         BZ    *+14                                            SS NOV85
         ICM   R0,15,*+6                                       SS NOV85
         BR    R2                                              SS NOV85
         DC    C'PS  '                                         SS NOV85
         TM    0(R1),JFCORGDA                                  SS NOV85
         BZ    *+14                                            SS NOV85
         ICM   R0,15,*+6                                       SS NOV85
         BR    R2                                              SS NOV85
         DC    C'DA  '                                         SS NOV85
         TM    1(R1),JFCORGAM                                  SS NOV85
         BZ    *+14                                            SS NOV85
         ICM   R0,15,*+6                                       SS NOV85
         BR    R2                                              SS NOV85
         DC    C'VSAM'                                         SS NOV85
         ICM   R0,15,*+6                                       SS NOV85
         BR    R2                                              SS NOV85
         DC    C'    '                                         SS NOV85
*                                                              SS NOV85
*  LSPACE SUBROUTINE  (USES SVC 78, UPDATES SPFV VARS)         SS NOV85
*  R0=UCB ADDRESS                                              SS NOV85
*  R15=RC FROM LSPACE                                          SS NOV85
ISPLSPAC DS    0H                                              SS NOV85
         LA    R1,SPFVLSPC     WORK AREA                       SS NOV85
         SVC   78                                              SS NOV85
         LTR   R15,R15                                         SS NOV85
         BZ    ISPLSPC2                                        SS NOV85
         MVC   SPFVDATA,ISPLSPCE                               SS NOV85
         BR    R2                                              SS NOV85
ISPLSPCE DC    CL8'*VTOCERR'                                   SS NOV85
ISPLSPC2 DS    0H                                              SS NOV85
         MVC   SPFVTCYL,SPFVLSPC+6                             SS NOV85
         MVC   SPFVTTRK,SPFVLSPC+11                            SS NOV85
         MVC   SPFVXNUM,SPFVLSPC+16                            SS NOV85
         MVC   SPFVLCYL,SPFVLSPC+21                            SS NOV85
         MVC   SPFVLTRK,SPFVLSPC+26                            SS NOV85
         LA    R15,SPFVTCYL                                    SS NOV85
         BAL   R1,ISPLSPCS             LITTLE SUB              SS NOV85
         LA    R15,SPFVTTRK                                    SS NOV85
         BAL   R1,ISPLSPCS             LITTLE SUB              SS NOV85
         LA    R15,SPFVXNUM                                    SS NOV85
         BAL   R1,ISPLSPCS             LITTLE SUB              SS NOV85
         LA    R15,SPFVLCYL                                    SS NOV85
         BAL   R1,ISPLSPCS             LITTLE SUB              SS NOV85
         LA    R15,SPFVLTRK                                    SS NOV85
         BAL   R1,ISPLSPCS             LITTLE SUB              SS NOV85
         BR    R2                                              SS NOV85
ISPLSPCS DS    0H                                              SS NOV85
         LA    R14,3                   FIRST 3 NUMBERS         SS NOV85
ISPLSPCL CLI   0(R15),C'0'             STILL ZEROS             SS NOV85
         BHR   R1                      NO, END OF LEADING 0    SS NOV85
         MVI   0(R15),C' '             CONVERT TO BLANK        SS NOV85
         LA    R15,1(,R15)             NEXT NUMBER             SS NOV85
         BCT   R14,ISPLSPCL            LOOP FOR 3              SS NOV85
         BR    R1                      ALL DONE                SS NOV85
*  DEVTYPE CHARACTERISTICES FOR DASD                           SS NOV85
*  R1=ADDRESS OF 4 BYTE DEVTYPE DATA (IE UCBTYP OR FROM CATLG) SS NOV85
*  R14=RETURNED ADDRESS OF TABLE ENTRY (SEE DVCT MACRO)        SS NOV85
*  R15=TRKS PER CYLINTER                                       SS NOV85
*                                                              SS NOV85
ISPDEVTC DS    0H                                              SS NOV85
         L     R14,16                                          SS NOV85
         L     R14,CVTZDTAB-CVT(R14)                           SS NOV85
         LA    R15,DVCTYPMK     MASK                           SS NOV85
         N     R15,0(R1)        TYPE DATA AND WITH MASK        SS NOV85
         IC    R15,0(R15,R14)   INDEX TO ENTRY                 SS NOV85
         LA    R14,0(R15,R14)   CALU ADDRESS                   SS NOV85
         LH    R15,DVCTRK-DVCT(R14)  TRACKS PER CYL            SS NOV85
         BR    R2                                              SS NOV85
*                                                              SS NOV85
*    GET FORMAT 4 DSCB   R1=ADDR OF VOLUME ID                  SS NOV85
*                                                              SS NOV85
ISPFMT4  DS    0H                                              SS NOV85
         LA    R14,ISPFMT04                                    SS NOV85
         B     ISPDSCB                                         SS NOV85
         SPACE 2                                               SS NOV85
ISPFMT04 DC    X'04040404040404040404040404040404040404040404' SS NOV85
         DC    X'04040404040404040404040404040404040404040404' SS NOV85
         SPACE 2                                               SS NOV85
*                                                              SS NOV85
*    GET FORMAT 1 DSCB                                         SS NOV85
*                        R1=ADDR OF VOLUME ID                  SS NOV85
*                       R14=ADDR OF DSN                        SS NOV85
ISPDSCB  DS    0H                                              SS NOV85
         MVC   SPFCAMLS(4),ISPDSCBS    SEARCH CAMLST           SS NOV85
         B     ISPDSCB2                                        SS NOV85
*                                                              SS NOV85
*    GET DSCB BY CCHHR                                         SS NOV85
*                        R1=ADDR OF VOLUME ID                  SS NOV85
*                       R14=ADDR OF CCHHR                      SS NOV85
ISPDSCBC DS    0H                                              SS NOV85
         MVC   SPFCAMLS(4),ISPDSCBK    SEEK   CAMLST           SS NOV85
ISPDSCB2 DS    0H                                              SS NOV85
         ST    R14,SPFCAMLS+4    DSN OR CCHHR                  SS NOV85
         ST    R1,SPFCAMLS+8     VOLUME                        SS NOV85
         LA    R15,SPFDSCB                                     SS NOV85
         ST    R15,SPFCAMLS+12   DSCB RETURN AREA              SS NOV85
         OBTAIN SPFCAMLS                                       SS NOV85
* CALLER CAN CHECK RETURN CODE                                 SS NOV85
         BR    R2                                              SS NOV85
ISPDSCBS CAMLST SEARCH,0,4,8                                   SS NOV85
ISPDSCBK CAMLST SEEK,0,4,8                                     SS NOV85
         SPACE 2                                               SS NOV85
*                                                              SS NOV85
*                                                              SS NOV85
*  GET DEVICE GROUP NAME USING DEVICE TYPE (IE UCBTYP)         SS NOV85
*  R1=ADDRESS OF 4 BYTE DEVT DATA                              SS NOV85
*  R15=ADDRESS OF NAME  (ZERO IF NOT FOUND)                    SS NOV85
*  R0=RETURNED DEVTYPE WITH UNNESSARY BITS REMOVED             SS NOV85
ISPDEVNM DS    0H                                              SS NOV85
         L     R15,16                                          SS NOV85
         TM    CVTDCB-CVT(R15),X'80'   CVTMVSE (XA)            SS NOV85
         BO    ISPDEVN3                USE IEFEB4UV            SS NOV85
         L     R15,CVTJESCT-CVT(R15)   JESCT                   SS NOV85
         L     R15,JESEDT-JESCT(R15)   EDT                     SS NOV85
* NO MACRO FOR EDT                                             SS NOV85
         L     R15,0(R15)              LOOK UP SECTION         SS NOV85
         L     R0,4(R15)               SIZE OF EACH ENTRY      SS NOV85
         L     R14,0(R14)              NUMBER OF ENTRIES       SS NOV85
         LA    R15,8(R15)              OVER HEADER             SS NOV85
ISPDEVN1 DS    0H                      LOOP BACK HERE          SS NOV85
         CLC   2(2,R1),10(R15)         COMPARE LAST 2 BYTES    SS NOV85
         BE    ISPDEVN2                GOT IT                  SS NOV85
         ALR   R15,R0                  NEXT ENTRY              SS NOV85
         BCT   R14,ISPDEVN1            KEEP LOOKING            SS NOV85
         SR    R15,R15                 NONE FOUND              SS NOV85
         SR    R0,R0                                           SS NOV85
         BR    R2                                              SS NOV85
ISPDEVN2 DS    0H                      GOT IT                  SS NOV85
         L     R0,8(R15)               LOAD GOOD DEVT          SS NOV85
         BR    R2                                              SS NOV85
*   USE IEFEB4UV  (XA EDT SERVICE ROUTINE)                     SS NOV85
ISPDEVNF DC    X'2100'                 CONVERT DEVT TO NAME    SS NOV85
ISPDEVN3 DS    0H                                              SS NOV85
         LA    R15,PARMLIST+8          UNIT TABLE              SS NOV85
         ST    R15,PARMLIST                                    SS NOV85
         LA    R15,ISPDEVNF            FLAGS                   SS NOV85
         ST    R15,PARMLIST+4                                  SS NOV85
         OI    PARMLIST+4,X'80'                                SS NOV85
         MVC   PARMLIST+8+8(4),0(R1)   COPY DEVT               SS NOV85
         NI    PARMLIST+8+8+1,255-X'20' TURN OFF SHARE BIT     SS NOV85
         SR    R14,R14                                         SS NOV85
         ST    R14,PARMLIST+8+12       ZERO ATTRIBUTE AREA PT  SS NOV85
         LA    R1,PARMLIST                                     SS NOV85
         LINK  EP=IEFEB4UV                                     SS NOV85
         LTR   R15,R15                                         SS NOV85
         BZ    ISPDEVN4                                        SS NOV85
         SR    R15,R15                 NONE FOUND              SS NOV85
         SR    R0,R0                                           SS NOV85
         BR    R2                                              SS NOV85
ISPDEVN4 DS    0H                      GOT IT                  SS NOV85
         L     R0,PARMLIST+8+8         LOAD GOOD DEVT          SS NOV85
         LA    R15,PARMLIST+8          PT TO RETURNED NAME     SS NOV85
         BR    R2                                              SS NOV85
*                                                              SS NOV85
*  DYNAMIC UNALLOCATE/DECONCATENATE                            SS NOV85
*  R0=02/04 S99VRBAL/S99VRBDC                                  SS NOV85
*  R1=ADDR OF DDNAME                                           SS NOV85
ISPUNALC DS    0H                                              SS NOV85
         XC    M99RBPTR(40),M99RBPTR    CLEAR THE WORK AREA
         LA    R14,M99RB
         USING S99RB,R14
         ST    R14,M99RBPTR
         OI    M99RBPTR,S99RBPND        MARK END OF LIST
         SPACE 1
         MVI   S99RBLN,20               LENGTH 20
         STC   R0,S99VERB               UNALLOC/DECONCAT
         LA    R15,M99TUPL
         ST    R15,S99TXTPP             POINT TO TEXT POINTERS
         MVC   WORKTBL+6(8),0(R1)       DDNAME                 SS NOV85
         LA    R1,WORKTBL                        START OF TEXT
         ST    R1,0(R15)                FIRST TEXT UNIT        SS NOV85
         MVC   0(6,R1),ISPUNAL2         DD TEXT UNIT           SS NOV85
         CLI   S99VERB-S99RB+M99RB,S99VRBDC  DECONCAT          SS NOV85
         BE    ISPUNAL1                                        SS NOV85
         LA    R1,WORKTBL+14            NEXT TEXT UNIT         SS NOV85
         LA    R15,4(,R15)              NEXT POINTER           SS NOV85
         ST    R1,0(R15)                SET  POINTER           SS NOV85
         MVC   0(4,R1),ISPUNAL3         UNALLOC PERM           SS NOV85
ISPUNAL1 OI    0(R15),X'80'             END OF LIST            SS NOV85
         B     ISPDYNA                  DO DYNAM               SS NOV85
ISPUNAL2 DC    X'000100010008'         BY DDNAME               SS NOV85
ISPUNAL3 DC    X'00070000'             UNALLOC EVEN PERM       SS NOV85
*                                                              SS NOV85
*  DYNAMIC ALLOCATION INTERFACE                                SS NOV85
*    M99RBPTR MUST BE SET BY USER                              SS NOV85
*    R15= RETURN CODE,  ANY ERROR MESSAGE WILL BE PRESET       SS NOV85
*                                                              SS NOV85
ISPDYNA  DS    0H                                              SS NOV85
         LA    R1,M99RBPTR                                     SS NOV85
         DYNALLOC                                              SS NOV85
         LTR   R15,R15                                         SS NOV85
         BZR   R2                                              SS NOV85
         ST    R15,DOUBLE            TEMP SAVE                 SS NOV85
         LA    R14,M99RB                POINTER TO SVC 99 BLOCK
         ST    R15,DAIRRC               RETURN CODE
         LA    R15,DAIRRC               POINTER TO RETURN CODE
         LA    R0,ADDRFF02              POINTER TO A(IKJEFF02)
         LA    R1,ISPDYN5               POINTER TO INVOCATION TYPE
         CLI   S99VERB-S99RB+M99RB,S99VRBAL                    SS NOV85
         BE    ISPDYN2                                         SS NOV85
         CLI   S99VERB-S99RB+M99RB,S99VRBCC                    SS NOV85
         BE    ISPDYN2                                         SS NOV85
         LA    R1,ISPDYN6               POINTER TO INVOCATION TYPE
         CLI   S99VERB-S99RB+M99RB,S99VRBUN                    SS NOV85
         BE    ISPDYN2                                         SS NOV85
         CLI   S99VERB-S99RB+M99RB,S99VRBDC                    SS NOV85
         BE    ISPDYN2                                         SS NOV85
         B     ISPDYN3                                         SS NOV85
ISPDYN2  DS    0H                                              SS NOV85
         STM   R14,R1,DFDAPLP           INITIALIZE DFDAPLP, DFDRCP,
*                                         DFJEFF02, DFIDP      SS NOV85
         L     R1,ADDRCPPL              POINTER TO THE CPPL    SS NOV85
         ST    R1,DFDAPLP+16               AND DFCPPLP         SS NOV85
         SPACE 1
         LINK  EP=IKJEFF18,MF=(E,DFPARMS)
ISPDYN3  DS    0H                                              SS NOV85
         MVC   SPFMLIN2,ISPDYN7                                SS NOV85
         SR    R1,R1                                           SS NOV85
         ICM   R1,3,S99ERROR-S99RB+M99RB  ERROR CODE           SS NOV85
         LR    R0,R2                                           SS NOV85
         BAL   R2,ISPHEXCV                                     SS NOV85
         LR    R2,R0                                           SS NOV85
         MVC   SPFMLIN2+29(4),SPFHEXCV+4                       SS NOV85
         MVC   SPFMSGID,ISPPDSM    BASE MSGAGE                 SS NOV85
         MVI   SPFMSGID+6,C'1'                                 SS NOV85
         MVI   SPFMSGID+7,C'A'                                 SS NOV85
         L     R15,DOUBLE          RELOAD RETURN CODE          SS NOV85
         BR    R2                                              SS NOV85
ISPDYN5  DC    AL2(DFSVC99)                                    SS NOV85
ISPDYN6  DC    AL2(DFFREE)                                     SS NOV85
ISPDYN7 DC CL79'DYNAMIC ALOC/UNAL ERROR CODE=0000, SEE TUTORIAL APPENDI*
               X A'                                            SS NOV85
         TITLE 'P D S  --  ISPF DIALOG LV1 SUB INTERACES'
*                                                              SS NOV85
*  LEVEL 1 SUBROUTINES                                         SS NOV85
*                                                              SS NOV85
*  THESE SAVE R2-R4 AND USE A BALR R3,R4 FOR LINKAGE           SS NOV85
*  RETURN IS BY R2                                             SS NOV85
         SPACE 5                                               SS NOV85
*                                                              SS SEP84
*  SUBROUTINE TO LOCATE COMMAND IN BUFFER AND MATCH WITH TABLE SS SEP84
*  OF COMMANDS                                                 SS SEP84
*  ENTRY ISPVER FOR ZCMD  BUFFER                               SS SEP84
*                                                              SS SEP84
         SPACE 1                                               SS SEP84
ISPVERG  DS    0H            FIND VERB WITH GIVEN PARMS        SS NOV84
         LA    R15,30         LIMIT OF SCAN                    SS SEP84
         B     ISPVER1                                         SS SEP84
ISPVER1  DS    0H                                              SS MAR85
         STM   R2,R4,SPFSAVR2                                  SS NOV85
         L     R4,ISPVERAD   LOAD ADDRESS OF VERB SUBROUTINE   SS MAR85
         BALR  R3,R4                                           SS NOV85
         LM    R2,R4,SPFSAVR2                                  SS NOV85
         BR    R2                                              SS NOV85
         SPACE 5                                               SS MAR85
*                                                              SS MAR85
*   VERB SUBROUTINE USES BASE R4                               SS MAR85
*                                                              SS MAR85
        SPACE 5                                                SS NOV85
*                                                              SS NOV85
*       INTERFACE FOR ISPLOC                                   SS NOV85
*                                                              SS NOV85
ISPLOCI  DS    0H                                              SS NOV85
         STM   R2,R4,SPFSAVR2                                  SS NOV85
         L     R4,ISPLOCA    LOAD ADDRESS OF SUBROUTINE        SS MAR85
         BALR  R3,R4                                           SS NOV85
         LM    R2,R4,SPFSAVR2                                  SS NOV85
         BR    R2                                              SS NOV85
         SPACE 5                                               SS MAR85
*                                                              SS NOV85
*       INTERFACE FOR ISPPAND                                  SS NOV85
*                                                              SS NOV85
ISPPANDI DS    0H                                              SS NOV85
         STM   R2,R4,SPFSAVR2                                  SS NOV85
         L     R4,ISPPANDA   LOAD ADDRESS OF SUBROUTINE        SS MAR85
         BALR  R3,R4                                           SS NOV85
         LM    R2,R4,SPFSAVR2                                  SS NOV85
         BR    R2                                              SS NOV85
         SPACE 5                                               SS MAR85
*                                                              SS NOV85
*       INTERFACE FOR ISPPARSE                                 SS NOV85
*                                                              SS NOV85
ISPPARSI DS    0H                                              SS NOV85
         STM   R2,R4,SPFSAVR2                                  SS NOV85
         L     R4,ISPPARSA   LOAD ADDRESS OF SUBROUTINE        SS MAR85
         BALR  R3,R4                                           SS NOV85
         LM    R2,R4,SPFSAVR2                                  SS NOV85
         BR    R2                                              SS NOV85
         SPACE 5                                               SS MAR85
*                                                              SS NOV85
*       INTERFACE FOR ISPSETVS                                 SS NOV85
*                                                              SS NOV85
ISPSETVI DS    0H                                              SS NOV85
         STM   R2,R4,SPFSAVR2                                  SS NOV85
         L     R4,ISPSETVA   LOAD ADDRESS OF SUBROUTINE        SS MAR85
         BALR  R3,R4                                           SS NOV85
         LM    R2,R4,SPFSAVR2                                  SS NOV85
         BR    R2                                              SS NOV85
         SPACE 5                                               SS MAR85
*                                                              SS NOV85
*       INTERFACE FOR MEMLIST                                  SS NOV85
*                                                              SS NOV85
MEMLISTI DS    0H                                              SS NOV85
         STM   R2,R4,SPFSAVR2                                  SS NOV85
         L     R4,AMEMLIST   LOAD ADDRESS OF SUBROUTINE        SS MAR85
         BALR  R3,R4                                           SS NOV85
         LM    R2,R4,SPFSAVR2                                  SS NOV85
         BR    R2                                              SS NOV85
         SPACE 5                                               SS MAR85
*                                                              SS NOV85
*       INTERFACE FOR FIND COMMAND                             SS NOV85
*                                                              SS NOV85
ISPFNDI  DS    0H                                              SS NOV85
         STM   R2,R4,SPFSAVR2                                  SS NOV85
         L     R4,ISPFNDA    LOAD ADDRESS OF SUBROUTINE        SS MAR85
         BALR  R3,R4                                           SS NOV85
         LM    R2,R4,SPFSAVR2                                  SS NOV85
         BR    R2                                              SS NOV85
         SPACE 5                                               SS MAR85
*                                                              SS NOV85
*    LOG COMMAND IN SESION LOG                                 SS NOV85
*                                                              SS NOV85
ISPLOGCD DS    0H                                              SS NOV85
         STM   R2,R4,SPFSAVR2                                  SS NOV85
         LA    R15,1(,R15)                                    ABL OCT84
         ST    R15,SPFSTART                                   ABL OCT84
         LH    R3,0(,R1)          GET BUFFER LENGTH            SS MAY85
         LA    R4,4(,R1)                                       SS MAY85
         S     R3,ISPL4           LESS -4 FOR HEADER           SS MAY85
         MVI   SPFLINE,C'>'       FLAG CMD LINE                SS MAY85
ISPCOLP  MVI   SPFLINE+1,C' '     BLANK                        SS MAY85
         MVC   SPFLINE+2(78),SPFLINE+1 RIPPLE                 ABL APR86
         CH    R3,ISPH78          LENGTH 78                    SS MAY85
         BNH   ISPCOLPL           LESS , LAST                  SS MAY85
         CLC   SPFLINE+1(78),0(R4) IS IT A BLANK LINE          SS MAY85
         BE    ISPCOLPN           YES SKIP TO NEXT             SS MAY85
         MVC   SPFLINE+1(78),0(R4) COPY GOOD LINE              SS MAY85
         BAL   R2,ISPADDCO        PUT IT INTO THE TABLE        SS MAY85
         MVI   SPFLINE,C'-'       FLAG ADDITIONAL LINES        SS MAY85
ISPCOLPN LA    R4,78(,R4)         NEXT PART OF LINE            SS MAY85
         SH    R3,ISPH78          REDUCE BY LENGTH             SS MAY85
         B     ISPCOLP                                         SS MAY85
ISPCOLPL BCTR  R3,0               ONE LESS FOR MVC             SS MAY85
         CLC   SPFLINE+1(0),0(R4) IS IT A BLANK LINE           SS MAY85
         EX    R3,*-6             EXECUTE IT                   SS MAY85
         BE    ISPCOLPS                                        SS MAY85
         MVC   SPFLINE+1(0),0(R4) COPY TO OUTPUT LINE          SS MAY85
         EX    R3,*-6             EXECUTE IT                   SS MAY85
         BAL   R2,ISPADDCO                                     SS MAY85
ISPCOLPS DS    0H                                              SS MAY85
         NI    SPFLAG3,FF-SPFLOGM LOGGED NOW                  ABL OCT84
         LM    R2,R4,SPFSAVR2                                  SS NOV85
         BR    R2                                              SS NOV85
         SPACE 5                                               SS MAR85
*                                                              SS NOV85
*       INTERFACE FOR ISPSTACK                                 SS NOV85
*                                                              SS NOV85
ISPSTKI  DS    0H                                              SS NOV85
         STM   R2,R4,SPFSAVR2                                  SS NOV85
         L     R4,ISPSTKA    LOAD ADDRESS OF SUBROUTINE        SS MAR85
         BALR  R3,R4                                           SS NOV85
         LM    R2,R4,SPFSAVR2                                  SS NOV85
         C     R15,ISPL8                                       SS NOV85
         BNL   ISPERR                                          SS NOV85
         BR    R2                                              SS NOV85
         SPACE 5                                               SS MAR85
*                                                              SS NOV85
*       MEMLIST UNSTACK (HAS INTERFACE TO ISPSTACK)            SS NOV85
*                                                              SS NOV85
ISPUSTKM DS    0H                                              SS NOV85
         STM   R2,R4,SPFSAVR2                                  SS NOV85
         L     R4,ISPSTKA    LOAD ADDRESS OF SUBROUTINE        SS MAR85
ISPUSTK2 TM    SPFTBPF1,SPFTMLX  MEMLIST SUPPORT PANEL         SS NOV85
         BZ    ISPUSTK3                                        SS NOV85
         TM    SPFTBPF1,SPFTLIN  MEMLIST PANEL                 SS NOV85
         BZ    ISPUSTK4                                        SS NOV85
         BAL   R2,ISPTBT#M       DELETE MEMLIST TABLE          SS NOV85
ISPUSTK4 DS    0H                                              SS NOV85
         LA    R1,0              DO UNSTACK                    SS NOV85
         BALR  R3,R4                                           SS NOV85
         B     ISPUSTK2                                        SS NOV85
ISPUSTK3 LM    R2,R4,SPFSAVR2                                  SS NOV85
         BR    R2                                              SS NOV85
         SPACE 5                                               SS MAR85
ISPEXIT  DS    0H                                              SS JUL84
         MVI   SPFLAG1,0      TURN OFF FUNCTION                SS JUL84
         LM    R2,R8,SPFSAV2                                   SS JUL84
         L     R14,SPFSAV14                                    SS JUL84
         B     4(R14)                                          SS JUL84
*                                                              SS NOV85
*       INTERFACE FOR ISPVSTAT                                 SS NOV85
*                                                              SS NOV85
ISPVSTAI DS    0H                                              SS NOV85
         STM   R2,R4,SPFSAVR2                                  SS NOV85
         L     R4,ISPVSTAA   LOAD ADDRESS OF SUBROUTINE        SS MAR85
         BALR  R3,R4                                           SS NOV85
         LM    R2,R4,SPFSAVR2                                  SS NOV85
         BR    R2                                              SS NOV85
ISPVSTAA DC    A(ISPVSTAT)                                     SS NOV85
         SPACE 5                                               SS MAR85
*                                                              SS NOV85
*       INTERFACE FOR ISPVSPAC                                 SS NOV85
*                                                              SS NOV85
ISPVSPAI DS    0H                                              SS NOV85
         STM   R2,R4,SPFSAVR2                                  SS NOV85
         L     R4,ISPVSPAA   LOAD ADDRESS OF SUBROUTINE        SS MAR85
         BALR  R3,R4                                           SS NOV85
         LM    R2,R4,SPFSAVR2                                  SS NOV85
         BR    R2                                              SS NOV85
ISPVSPAA DC    A(ISPVSPAC)                                     SS NOV85
         SPACE 5                                               SS MAR85
         TITLE 'P D S  --  ISPF DIALOG CONSTANTS'
*                                                              SS JUL84
*  CONSTANTS                                                   SS JUL84
*                                                              SS JUL84
*  ISPF FUNCTIONS                                              SS JUL84
ISPCNTL  DC    C'CONTROL'                                      SS JUL84
ISPDISP  DC    C'DISPLAY'                                      SS NOV84
TBADD    DC    C'TBADD'                                        SS JUL84
TBBOTTOM DC    C'TBBOTTOM'                                     SS JUL84
TBCREATE DC    C'TBCREATE'                                     SS JUL84
TBDELETE DC    C'TBDELETE'                                     SS JUL84
TBDISPL  DC    C'TBDISPL'                                      SS JUL84
TBEND    DC    C'TBEND'                                        SS JUL84
TBGET    DC    C'TBGET'                                        SS JUL84
TBMOD    DC    C'TBMOD'                                        SS JUL84
TBPUT    DC    C'TBPUT'                                        SS JUL84
TBQUERY  DC    C'TBQUERY'                                      SS JUL84
TBSCAN   DC    C'TBSCAN'                                       SS JUL84
TBSKIP   DC    C'TBSKIP'                                       SS JUL84
TBTOP    DC    C'TBTOP'                                        SS JUL84
TBVCLEAR DC    C'TBVCLEAR'                                     SS JUL84
VCOPY    DC    C'VCOPY'                                        SS JUL84
VDEFINE  DC    C'VDEFINE'                                      SS JUL84
VDELETE  DC    C'VDELETE'                                      SS JUL84
VGET     DC    C'VGET'                                         SS JUL84
VRESET   DC    C'VRESET'                                       SS JUL84
*  ISPF OPERANDS                                               SS JUL84
ISPDSP   DC    C'DISPLAY'                                      SS JUL84
ISPNOND  DC    C'NONDISPL'                                     SS NOV84
ISPREF   DC    C'REFRESH'                                      SS JUL84
ISPSAVE  DC    C'SAVE'                                         SS JUL84
ISPRSTR  DC    C'RESTORE'                                      SS JUL84
ISPCHAR  DC    C'CHAR'                                         SS JUL84
ISPFIX   DC    C'FIXED'                                        SS JUL84
ISPMOVE  DC    C'MOVE'                                         SS JUL84
ISPNOWRT DC    C'NOWRITE'                                      SS JUL84
*SPPANAL DC    C'P..PN   '                                     SS NOV85
ISPPDSM  DC    C'PDS&M..N'                                    ABL OCT84
ISPSM    DC    C'SM '                                         ABL OCT84
ISPSHARE DC    C'SHARED '                                     ABL SEP84
ISPNO    DC    C'NO '          TBDSPLY AUTOSEL=NO              SS MAR85
*  ISPF VARIABLE NAMES AND NAME LISTS                          SS JUL84
VSPFVFIX DC    C'('        START OF FIX DIALOG VERBS           SS SEP84
VSPFFIX  DC    C'PDSFIX '                                      SS JUL84
VSPFFIX2 DC    C'PDSFIX2 '                                     SS JUL84
VSPFCRP  DC    C'PDSCRP '                                      SS JUL84
VZTDTOP  DC    C'ZTDTOP '                                      SS JUL84
         DC    C')'        END OF FIX DIALOG VERBS             SS SEP84
VSPFLIN  DC    C'PDSLINE '                                     SS JUL84
VSPFMSG  DC    C'PDSMSG '                                      SS JUL84
VSPFMSG1 DC    C'PDSMSG1 '                                    ABL JUN85
VSPFMSG2 DC    C'PDSMSG2 '                                    ABL JUN85
VZCMD    DC    C'ZCMD '                                        SS JUL84
VZTIME   DC    C'ZTIME '                                       SS JUL84
VZENVIR  DC    C'ZENVIR '  ISPF V2 INDICATOR                   SS MAR85
VZVERB   DC    C'ZVERB '                                      ABL SEP84
* THE FOLLOWING CONSTANTS DEFINE THE TABLE VARIABLES, BOTH KEY AND
*   NAMES
         SPACE
MEMLTKEY DC    C'(MEMLNAME)'       TABLE KEY
         SPACE 3
MEMTNAML DC    C'( '               MEM TBL
MEMLTDAT DC    C'MEMLDATA '        USER ENTERED DATA
MMLOPT   DC    C'MEMLOPT '
MMLALIS  DC    C'MEMLALIS '
MMLTTR   DC    C'MEMLTTR '         MEM TBL ALIAS SCAN ARG LIST
         DC    C'MEMXATT '         HEX TTR AND STATUS          SS NOV84
         DC    C'MEMLVMOD MEMLCDAT MEMLMDAT  '
         DC    C'MEMLMTIM MEMLMID MEMLISIZ MEMLCSIZ '          SS NOV84
         DC    C'MEMLMNAM MEMLMTTR '                           SS NOV84
         DC    C'MEMLLENG MEMLENTY MEMLATT1 MEMLATT2 MEMLDC MEMLTEST '
         DC    C'MEMLAPF MEMLMODE MEMLSSI MEMLLDAT '           SS MAR85
         DC    C')'
*        ADDED MEMLISIZ MEMLSSI                                SS NOV84
*        ADDED MEMLLDAT  FUTURE: LINKEDIT DATE                 SS MAR85
         SPACE
         EJECT
*  ISPF VARIABLE LENGTHS
ISPL1    DC    F'1'                     LENGTH OF TYPE  VAR    SS SEP84
ISPL2    DC    F'2'                     LENGTH OF DSORG VAR    SS SEP84
ISPL4    DC    F'4'                     LENGTH OF FIXED VAR    SS JUL84
ISPL6    DC    F'6'                     LENGTH OF VOLUME VAR   SS SEP84
ISPL8    DC    F'8'                     LENGTH OF 8            SS JUL84
ISPL32   DC    F'32'                    LENGTH OF ZENVIR       SS MAR85
ISPL44   DC    F'44'                    LENGTH OF DSN          SS SEP84
ISPLMSG  DC    F'79'                    LENGTH OF SPFMSG      ABL NOV84
ISPL80   DC    F'80'                    LENGTH OF TABLE VAR   ABL APR86
ISPL250  DC    F'250'                   LENGTH OF ZSEL/ZCMD    SS SEP84
ISPH78   DC    H'78'                    LENGTH OF MSG VAR-1    SS JUL84
ISPH79   DC    H'79'                    LENGTH OF TABLE VAR-1 ABL APR86
ISPH5    DC    H'5'                     LEN PUTL BUF LESS HEAD SS JUL84
ISPH12   DC    H'12'                    RC 16                  SS NOV84
ISPH16   DC    H'16'                    RC 16                  SS NOV84
ISPLEN   DC    H'52',H'0'               LENGTH (ZCMD+4,0)     ABL OCT84
ISPLEN2  DC    H'254',H'0'              LENGTH (ZCMD+4,0)      SS NOV84
*  ISPF SUBROUTINE ACONS
ISPVERAD DC    A(ISPVER11)                                     SS MAR85
ISPALICA DC    A(ISPALICK)                                     SS MAR85
ISPLOCA  DC    A(ISPLOC)                                       SS MAR85
ISPTBDSA DC    A(ISPTBDSP)                                     SS MAR85
ISPPANDA DC    A(ISPPAND)                                      SS MAR85
ISPSETVA DC    A(ISPSETVS)                                     SS MAR85
ISPPARSA DC    A(ISPPARSE)                                     SS MAR85
ISPVINIA DC    A(ISPVINIT)                                     SS MAR85
ISPSTKA  DC    A(ISPSTACK)                                     SS NOV85
ISPESTAE DC    V(STAEEXIT)                                    ABL JUN85
VLOGDATA DC    V(LOGDATA)                                      SS JUL85
*SPDISPA DC    A(ISPDISPT)                                    ABL JUN85
ISPRLOGA DC    A(ISPRLOG)                                      SS MAY85
*SPFLOGA DC    A(ISPFLOG)                                      SS MAY85
ISPFNDA  DC    A(ISPFND)                                       SS NOV85
AMEMLIST DC    A(MEMLIST)                                      SS JUL85
MEMLFUNA DC    A(MEMLFUNC)                                     SS NOV85
ISPLNCA  DC    A(ISPLNC2)                                     ABL FEB86
*  ISPF OTHER CONSTANTS
$ATT     DC    CL8'&NATT '                                     SS JUL85
$HIS     DC    CL8'&NHIS '                                     SS JUL85
$MAP     DC    CL8'&NMAP '                                     SS JUL85
$MML     DC    CL8'&NMML '                                     SS JUL85
$SUL     DC    CL8'&NSUL '                                    ABL APR86
$UT1     DC    CL8'&NUT1 '                                     SS JUL85
$UT2     DC    CL8'&NUT2 '                                     SS JUL85
ISPBLK8  DC    CL8' '                                          SS SEP84
ISPPDS   DC    C'PDS'                                          SS JUL84
ISPCEND  DC    C'END '                                         SS NOV84
ISPCPAN  DC    C'PANEL('                                       SS NOV84
ISP300A  DC    C'PDS300A'               MSG TO SKIP            SS AUG84
ISP381A  DC    C'PDS381A'               DSNAME PROMPT         ABL APR86
ISP390A  DC    C'PDS390A'               RESTORE PROMPT        ABL APR86
ISPALIS  DC    CL8'*AL*  '                                     SS SEP84
ISPUNKN  DC    CL8'*UNKNOWN'                                   SS SEP84
ISPORP   DC    CL8'*ORPHAN'                                    SS SEP84
ISPNEWNM DC   CL8'*NEWNAME'                                   ABL OCT84
ISPERMSG DC   CL8'**ERROR*'                                   ABL OCT84
ISPATTN  DC   CL8'**ATTN**'                                   ABL APR85
ISPINVLD DC   CL8'*INVALID'                                   ABL OCT84
ISPPO    DC    C'PO'                                           SS SEP84
ISPPS    DC    C'PS'                                           SS SEP84
**PUTDOT DC    C'  UT.'                                       ABL FEB86
ISPENDIT DC    X'000D0000',CL9'&NEND'                          SS JUL84
ISPDSNMG DC    X'000D0000',CL9'&NDSN'                          SS JUL84
ISPMALL  DC    X'00100000',CL9'&NMML ',CL3':  '              ABL NOV84
ISPCMD21 DC    X'00150000'                                     SS SEP84
ISPCMD30 DC    X'001E0000'                                    ABL DEC84
STAELIST ESTAE *-*,PARAM=*-*,MF=L                              SS JUL85
         SPACE 2                                               SS MAR85
* PARSE PARM LIST OPTIONS                                      SS MAR85
*        DC    X'XX'   OPTION FLAG                             SS MAR85
*              X'80'   STRING   (MUST BE FIRST IF USED)        SS MAR85
*              X'40'   NUMERIC PARM (MUST BE FIRST AFTER STR)  SS MAR85
*              X'20'   KEYWORD (NO SUB VALUES)                 SS MAR85
*              X'10'   ALLOW KEYWORD SINGLE CHAR MATCH         SS MAR85
*              X'10'   CHECK STRING FOR IMBED CHAR (FUTURE)    SS MAR85
*              X'10'   NUMERIC RANGE CHECK REQUESTED           SS MAR85
*              X'00-07' LENGTH OF COMMPARE                     SS MAR85
*              X'FF'   END OF TABLE                            SS MAR85
*        DC    X'XX'   BITS ORED IF MATCH                      SS MAR85
*        DC    CL8''/F'',F''                                   SS MAR85
*                      KEYWORD                                 SS MAR85
*                      RANGE VALUES                            SS MAR85
         SPACE 2                                               SS MAR85
* PARSE PARM LIST FOR STRING ONLY                              SS MAR85
ISPPARST DC    X'80',X'80',X'00',X'00',CL8' ',X'FF'            SS MAR85
         SPACE 1                                               SS MAY85
* PARSE PARM LIST FOR RECALL                                   SS MAR85
         DS    0F                                              SS MAR85
ISPPARRE DC    X'51',X'41',X'00',X'00',F'-1000',F'1000'        SS JUN85
         DC    X'30',X'20',X'00',X'00',CL8'CHANGE'            ABL APR86
         DC    X'30',X'10',X'00',X'00',CL8'ENTER'             ABL APR86
         DC    X'34',X'09',X'00',X'00',CL8'FIRST' KEYWORDS     SS MAR85
         DC    X'30',X'01',X'00',X'00',CL8'LOG'               ABL APR86
         DC    X'23',X'05',X'00',X'00',CL8'PREVIOUS'           SS JUN85
         DC    X'23',X'07',X'00',X'00',CL8'LAST'               SS JUN85
         DC    X'FF'                                           SS MAR85
         SPACE 1                                               SS MAY85
         SPACE 3                                               SS MAR85
L7FFF    EQU   32767                                           SS MAR85
H7FFF    DC    H'32767'                                        SS MAR85
ISPSIZE  DC    H'&SPFSIZE'                                     SS JUL84
ISPMAX   DC    H'&SPFMAX'                                      SS JUL84
ISPCKPT  DC    H'&SPFCKPT'                                     SS JUL84
         SPACE 1                                               SS JUL85
         LTORG
         SPACE 1                                               SS SEP84
* ADDCONS TO COMMAND TABLES AND TABLE ENTRIES                  SS NOV84
*SP$TLA  DC    A(ISP$TL)                                       SS NOV84
ISP$TL2A DC    A(ISP$TL2)                                      SS NOV84
ISP$TLXA DC    A(ISP$TLX)                                      SS NOV84
*SP$TLPA DC    A(ISP$TLP)                                      SS NOV84
*SP$TLVA DC    A(ISP$TLV)                                      SS NOV84
*SP$TLIA DC    A(ISP$TLI)                                      SS NOV84
*SP$TLMA DC    A(ISP$TLM)                                      SS NOV84
ISPEXECA DC    A(ISPEXECT)                                    ABL DEC84
ISP$PNA  DC    A(ISP$PAN)                                      SS MAR85
ISP$TMGA DC    A(ISP$TMG)                                      SS MAR85
         SPACE 2                                               SS NOV84
         COPY  DIATBL73                                       ABL DEC84
         TITLE 'P D S  --  ISPF LEVEL 1 SUBROUTINES'
         SPACE 2                                               SS NOV85
*                                                              SS NOV85
*  FIND SUBCMD VERB IN TABLE                                   SS NOV85
*                                                              SS NOV85
         USING *,R4                                            SS MAR85
ISPVER11 DS    0H                                              SS MAR85
         LR    R2,R3                                           SS NOV85
         CLI   0(R1),C' '     SCAN FIRST NON BLANK             SS NOV84
         BNE   ISPVER2                                         SS SEP84
         LA    R1,1(,R1)      NEXT CHAR                        SS SEP84
         BCT   R15,ISPVER11                                    SS NOV84
ISPVER16 DS    0H            BLANK INPUT                       SS NOV84
         ST    R1,SPFVERB    SAVE ADDRESS                      SS NOV84
         LA    R3,1(,R1)     RESUME SCAN AT NEXT CHAR          SS SEP84
         ST    R3,SPFOPER    SAVE ADDRESS                      SS NOV84
         SR    R3,R3         LENGTH 0                          SS NOV84
         MVI   SPFNAMEH,X'41' NULL CMD                         SS NOV84
         B     ISPVER5                                         SS NOV84
ISPVER2  LA    R15,8         EXPAND SCAN                       SS SEP84
         ST    R1,SPFVERB    SAVE ADDRESS                      SS NOV84
         LA    R3,1(,R1)     RESUME SCAN AT NEXT CHAR          SS SEP84
ISPVER3  CLI   0(R3),C' '    SCAN NEXT BLANK                   SS SEP84
         BE    ISPVER4                                         SS SEP84
         CLI   0(R3),C'.'    SCAN NEXT PERIOD (PANEL SUPPORT)  SS NOV84
         BE    ISPVER4                                         SS NOV84
         LA    R3,1(,R3)     NEXT CHAR                         SS SEP84
         BCT   R15,ISPVER3                                     SS SEP84
ISPVER20 LA    R15,20        INVALID SYNTAX                    SS SEP84
ISPVER4  DS    0H                                              SS SEP84
         ST    R3,SPFOPER    SAVE ADDRESS                      SS NOV84
         SR    R3,R1         LENGTH                            SS SEP84
         BCTR  R3,0          LESS ONE FOR CLC                  SS SEP84
         MVC   SPFNAMEH,0(R1)   SAVE THE SUBCOMMAND NAME      ABL OCT84
         OC    SPFNAMEH,ISPBLK8 UPPER CASE THE NAME           ABL OCT84
ISPVER5  TM    $TLF1(R14),#E END OF TABLE                      SS NOV84
         BO    ISPVER12      NOT VALID                         SS NOV84
         LA    R15,$TLCM(R14) POINT TO VALUE IN ENTRY          SS JUL85
ISPVER7  DS    0H                                              SS SEP84
         CLC   0(0,R15),SPFNAMEH  MATCH TABLE AND SUBCOMMAND  ABL OCT84
         EX    R3,*-6        FOR LENGTH OF CMD                 SS SEP84
         BE    ISPVER8       MATCH                             SS SEP84
         LA    R14,ISPTEL(,R14)  NEXT ENTRY                    SS SEP84
         B     ISPVER5                                         SS SEP84
ISPVER8  DS    0H                                              SS SEP84
         ST    R14,SPFVTPT   SAVE TABLE ENTRY ADDR             SS NOV85
         TM    $TLF1(R14),#O LINE CMD ONLY                     SS SEP84
         BO    ISPVER08                                        SS SEP84
         TM    $TLF1(R14),#K FORCE MEMLIST INACTIVE            SS SEP84
         BO    ISPVER04                                        SS SEP84
         SR    R15,R15       GOOD CMD                          SS SEP84
         BR    R2                                              SS SEP84
ISPVER04 LA    R15,04        FORCE MEMLIST INACTIVE            SS SEP84
         BR    R2                                              SS SEP84
ISPVER08 LA    R15,08        LINE CMD ONLY                     SS SEP84
         BR    R2                                              SS SEP84
ISPVER12 LA    R15,12        NOT FOUND                         SS SEP84
         ST    R14,SPFVTPT   SAVE TABLE ENTRY ADDR             SS NOV84
         BR    R2                                              SS SEP84
         DROP  R4                                              SS MAR85
         SPACE 2                                               SS SEP84
*                                                              SS SEP84
*  LOC NEAREST MATCH TO MEMBER NAME IN ISPNMSV                 SS SEP84
*  R3 IS RETURN REGISTER                                       SS SEP84
*                                                              SS SEP84
ISPLOC   DS    0H
         USING *,R4                                            SS MAR85
         BAL   R2,ISPQUERY           GET CURRENT TABLE SIZE    SS SEP84
         XC    MEMLNAME,MEMLNAME     NO NAME YET               SS SEP84
         OC    MEMLSIZE,MEMLSIZE     EMPTY                     SS SEP84
         BZ    ISPLOC7               YES                       SS SEP84
         BAL   R2,ISPTOP             START AT TOP              SS SEP84
ISPLOC1  L     R15,MEMLSIZE          GET SIZE                  SS SEP84
         LA    R15,2(,R15)           ROUND UP                  SS SEP84
         SRL   R15,1                 DIVIDE TABLE IN TWO       SS SEP84
         ST    R15,SPFFIXED          SAVE FIRST TIME           SS SEP84
ISPLOC2  ST    R15,SPFFIXE2          LAST SKIP VALUE           SS SEP84
         BAL   R2,ISPSKIP            DO SKIP                   SS SEP84
         LTR   R15,R15               RC 0                      SS SEP84
         BZ    ISPLOC4               YES                       SS SEP84
         L     R15,SPFFIXE2          TABLE EMPTY               SS SEP84
         LTR   R15,R15                                         SS SEP84
         BM    ISPLOC3               RAN OFF TOP               SS SEP84
         BAL   R2,ISPBOTM            RAN OFF BOTTOM            SS SEP84
         B     ISPLOC4                                         SS SEP84
ISPLOC3  LA    R15,1                 REPOSITON                 SS SEP84
         ST    R15,SPFFIXE2               TO FIRST             SS SEP84
         BAL   R2,ISPSKIP                     LINE WITH SKIP   SS SEP84
ISPLOC4  L     R15,SPFFIXED          TRY THIS                  SS SEP84
         LA    R1,1                  BINARY SEARCH OVER        SS SEP84
         CR    R15,R1                                          SS SEP84
         BNH   ISPLOC7               YES MUST BE CLOSE         SS SEP84
         LA    R15,1(,R15)           ROUND                     SS SEP84
         SRL   R15,1                 DIVIDE PORTION  IN HALF   SS SEP84
         ST    R15,SPFFIXED          SAVE                      SS SEP84
         CLC   MEMLNMSV,MEMLNAME     WHICH WAY FROM HERE       SS SEP84
         BH    ISPLOC2               GO DOWN FROM HERE         SS SEP84
         BE    ISPLOC6               WE ARE THERE              SS SEP84
ISPLOC5  DS    0H                    GO UP FROM HERE           SS SEP84
         LNR   R15,R15                  WITH NEG VALUE         SS SEP84
         B     ISPLOC2                    POSITION             SS SEP84
ISPLOC6  SR    R15,R15               RC=0 .. GOT MATCH         SS SEP84
         BR    R3                                              SS SEP84
ISPLOC7  LA    R15,1                 RC=-1.. GOT CLOSE         SS SEP84
         LNR   R15,R15                                         SS SEP84
         CLC   MEMLNMSV,MEMLNAME     JUST ABOVE OR BELOW       SS SEP84
         BE    ISPLOC6                                         SS SEP84
         BHR   R3                    ABOVE .. DONE             SS SEP84
         BAL   R2,ISPSKIP            MOVE BACK ABOVE           SS SEP84
         LTR   R15,R15                                         SS SEP84
         BZ    ISPLOC7               CHECK ONE MORE TIME       SS SEP84
         LA    R15,1                 RC=-1.. GOT CLOSE         SS SEP84
         LNR   R15,R15                                         SS SEP84
         BR    R3                    DONE                      SS SEP84
         DROP  R4                                              SS MAR85
         SPACE 5                                               SS NOV85
*                                                              SS NOV84
*   SELECT PANEL DISPLAY ROUTINE    RETURN = R3                SS NOV84
*                                                              SS NOV84
ISPPAND  DS    0H                                              SS NOV84
         USING *,R4                                            SS MAR85
         TM    SPFLAG4,SPFNOND    INVOKE PANEL NON-DISPLAY     SS NOV84
         BZ    ISPPAND2                                        SS NOV84
         LA    R14,ISPCNTL        CONTROLTABLE                 SS NOV84
         LA    R15,ISPNOND                                     SS NOV84
         STM   R14,R15,PARMLIST                                SS NOV84
         OI    PARMLIST+04,X'80'                               SS NOV84
         LA    R1,PARMLIST                                     SS NOV84
         L     R15,ISPLINK                                     SS NOV84
         BALR  R14,R15                                         SS NOV84
         LTR   R15,R15                                         SS NOV84
         BNZ   ISPERR                                          SS NOV84
         NI    SPFLAG4,255-SPFNOND                             SS NOV84
         B     ISPPAND3                                        SS NOV84
ISPPAND2 DS    0H                                              SS NOV84
         TM    SPFLAG3,SPFREFR    NEED REFRESH                 SS NOV84
         BZ    ISPPAND3                                        SS NOV84
         BAL   R2,ISPCREF                                      SS NOV84
ISPPAND3 DS    0H                                              SS NOV84
         OI    ##ADRPA#,$A+$D           IGNORE ATTENTION NOW
         LA    R14,ISPDISP        DISPLAY TABLE                SS NOV84
         L     R15,SPFPANC        PANEL NAME                   SS NOV84
         LA    R0,0               NO MSG                       SS NOV84
         CLC   SPFMSGID(4),ISPPDSM ANY MSG                     SS NOV84
         BNE   ISPPAND4                                        SS NOV84
         LA    R0,SPFMSGID                                     SS NOV84
         CLC   SPFPANPR(8),0(R15) SAME PANEL AS LAST TIME?    ABL DEC84
         BNE   ISPPAND4           NO, BRANCH                  ABL DEC84
         TM    SPFLAG2,SPFNPOS    OVERRIDE POSITIONING?       ABL APR86
         BO    ISPPAND4           YES, BRANCH                 ABL APR86
         SR    R15,R15            NULLIFY PANEL NAME          ABL DEC84
ISPPAND4 DS    0H                                              SS NOV84
         NI    SPFLAG2,255-SPFNPOS   RESET FREEZE/POSITION    ABL APR86
         MVC   SPFPANPR(8),SPFPANC   SAVE LAST PANEL NAME     ABL DEC84
         LA    R1,VZCMD           CURSER AT CMD LINE           SS NOV84
         STM   R14,R1,PARMLIST                                 SS NOV84
         LA    R1,SPFCURSO           CURSOR OFFSET            ABL JUN85
         ST    R1,PARMLIST+16                                 ABL JUN85
         OI    PARMLIST+16,X'80'                              ABL JUN85
         SPACE 1                                               SS NOV84
ISPPAND5 DS    0H                                              SS NOV84
         LA    R1,PARMLIST                                     SS JUL84
         L     R15,ISPLINK                                     SS JUL84
         BALR  R14,R15                                         SS JUL84
         CLI   FLAGSSS,0          RETURN KEY ACTIVE?           SS NOV84
         MVI   FLAGSSS,0                                       SS NOV84
         BNE   ISPPAND5           YES, REPEAT THE TBDISPL      SS NOV84
         MVI   SPFMSGID,C' '      TURN OFF MSG                 SS NOV84
         MVI   SPFCURSO+3,0       RESET THE CURSOR OFFSET     ABL JUN85
         ST    R15,SPFFIXED       SAVE RC                      SS JUL84
         AIF ('&RETURNX' EQ 'NO').RETURN4                      SS NOV84
         CLI   SPFFIXED+3,8           RETURN CODE=8?          ABL OCT84
         BNE   ISPPAND8               NO, BRANCH              ABL OCT84
         BAL   R2,ISPDVGET                                     SS NOV84
         SPACE 1                                              ABL OCT84
         CLI   SPFRETRN,C'R'         "RETURN"                 ABL OCT84
         BNE   ISPPAND8              YES, BRANCH               SS NOV84
         CLC   SPFPANT,SPFPANC       TOP  PANEL                SS NOV84
         BNE   ISPPAND8              NO,  NO PROBLEM           SS NOV84
         MVI   FLAGSSS,C'2'          REINVOKE ALL LATER       ABL OCT84
ISPPAND8 DS    0H                                             ABL OCT84
.RETURN4 ANOP                                                 ABL OCT84
         SPACE 1                                              ABL OCT84
         CLI   SPFFIXED+3,8           RETURN?                 ABL OCT84
         BNE   ISPPAND9               YES, BRANCH              SS NOV84
         MVI   SPFFIXED+3,0          RESET RETURN CODE         SS NOV84
         MVC   SPFZSEL(4),ISPCEND    SET TO END CODE           SS NOV84
         B     ISPPANDC                                        SS NOV84
ISPPAND9 DS    0H                                              SS NOV84
         CLI   SPFFIXED+3,12          NO PANEL                 SS NOV84
         BE    ISPPANDE               YES, BRANCH              SS NOV84
         CLI   SPFFIXED+3,0                                    SS NOV84
         BNE   ISPERR                                          SS NOV84
         CLC   SPFZSEL(6),ISPCPAN    NEXT PANEL                SS NOV84
         BNE   ISPPANDC              NO                        SS NOV84
         L     R15,SPFPANC           CURRENT PANEL             SS NOV84
         C     R15,SPFPANB           IS IT LAST                SS NOV84
         BE    ISPPANDD              YES, LEAVE AS LAST        SS NOV84
         LA    R15,8(R15)            NEXT                      SS NOV84
         ST    R15,SPFPANC           UPDATE DATA               SS NOV84
ISPPANDD MVC   0(8,R15),SPFZSEL+6    MOVE PANEL NAME           SS NOV84
         CLI   0(R15),C'A'           GOOD ENTRY                SS NOV84
         BL    ISPPANDE              BAD ENTRY                 SS NOV84
         LA    R1,9                  SCAN FOR 8                SS NOV84
ISPPANDF CLI   0(R15),C'A'           FIND END OF NAME          SS NOV84
         BL    ISPPANDG                                        SS NOV84
         LA    R15,1(,R15)           NEXT                      SS NOV84
         BCT   R1,ISPPANDF                                     SS NOV84
         B     ISPPANDK                                        SS NOV84
ISPPANDG MVI   0(R15),C' '           BLANK OUT REST            SS NOV84
         LA    R15,1(,R15)           NEXT                      SS NOV84
         BCT   R1,ISPPANDG                                     SS NOV84
ISPPANDH BAL   R2,ISPSHCMD           SHIFT ZCMD TO NEXT '.'    SS NOV84
         CLI   SPFVZCMD,C' '         IS IT BLANK               SS NOV84
         BE    ISPPAND               YES DISPLAY PANEL         SS NOV84
         OI    SPFLAG4,SPFNOND       NO, INVOKE PANEL NONDISPL SS NOV84
         B     ISPPAND                                         SS NOV84
ISPPANDC DS    0H                                              SS NOV84
         CLI   SPFZSEL,C' '          NULL                      SS NOV84
         BNH   ISPPANDN              YES                       SS NOV84
         CLI   SPFZSEL,C'?'          INVALID                   SS NOV84
         BE    ISPPANDK                                        SS NOV84
         B     ISPPANDJ              CONTINUE CHECKS           SS NOV84
ISPPANDK DS    0H                                              SS NOV84
         MVC   SPFMSGID,ISPPDSM      SET BASE MSG              SS NOV84
         MVI   SPFMSGID+6,C'9'       COMMON MSG                SS NOV84
         MVI   SPFMSGID+7,C'A'       COMMON MSG                SS NOV84
         B     ISPPAND               TRY AGAIN                 SS NOV84
ISPPANDN DS    0H                                              SS NOV84
         MVC   SPFMSGID,ISPPDSM      SET BASE MSG              SS NOV84
         MVI   SPFMSGID+6,C'9'       COMMON MSG                SS NOV84
         MVI   SPFMSGID+7,C'E'       COMMON MSG                SS NOV84
         B     ISPPAND               TRY AGAIN                 SS NOV84
ISPPANDE DS    0H                                              SS NOV84
         MVC   SPFMSGID,ISPPDSM      SET BASE MSG              SS NOV84
         MVI   SPFMSGID+6,C'9'       COMMON MSG                SS NOV84
         MVI   SPFMSGID+7,C'P'       BAD PANEL                 SS NOV84
         MVC   SPFZSEL(4),ISPCEND    END CODE                  SS NOV84
ISPPANDJ DS    0H                                              SS NOV84
         CLC   SPFZSEL(4),ISPCEND    END CODE                  SS NOV84
         BNE   ISPPANDX              NO, GOT COMMAND           SS NOV84
         CLC   SPFPANC,SPFPANT       LAST PANEL                SS NOV84
         BER   R3                    RETURN END                SS NOV84
         L     R14,SPFPANC           GET ADDR                  SS NOV84
         S     R14,ISPL8             BACK UP 8                 SS NOV84
         ST    R14,SPFPANC                                     SS NOV84
         B     ISPPAND                                         SS NOV84
ISPPANDX DS    0H                                              SS NOV84
         SPACE 2                                               SS NOV84
         NI    ##ADRPA#,FF-$A-$D        DO NOT IGNORE ATTENTION NOW
         SPACE 1
         ESTAE 0                        CANCEL THE ESTAE ADDRESS
         MVC   STAEPARM(4),STAELIST     RESET THE ESTAE ADDRESS
         L     R2,ISPESTAE              ESTAE EXIT ADDRESS    ABL JUN85
         ESTAE (R2),CT,PARAM=(R7),MF=(E,STAEPARM)             ABL JUN85
         BR    R3                                              SS NOV84
         SPACE 2                                               SS SEP84
         DROP  R4                                              SS MAR85
*                                                              SS SEP84
*  ALIAS CHECKER                                               SS SEP84
*  R3 IS RETURN REGISTER                                       SS SEP84
*                                                              SS SEP84
ISPALICK DS    0H                                              SS SEP84
         USING *,R4                                            SS MAR85
         BAL   R2,ISPTOP             START WITH TOP            SS SEP84
ISPALI2  DS    0H                                              SS SEP84
         MVC   MEM2ALIS,ISPALIS      SET CODE FOR ALIAS INDIC  SS SEP84
         LA    R0,MMLALIS            SCAN VARIABLE             SS SEP84
         BAL   R2,ISPMEMSC           DO SCAN                   SS SEP84
         C     R15,ISPL8             NONE FOUND                SS SEP84
         BER   R3                    DONE                      SS SEP84
         MVC   MEMLNMSV,MEMLNAME     SAVE NAME                 SS SEP84
         MVC   MEMLTTSV,MEM2TTR      SAVE TTR                  SS SEP84
         TM    FLAGSCC,RECFMU        IS IT A LOAD MODE         SS SEP84
         BO    ISPALI50              YES                       SS SEP84
ISPALI3  DS    0H                                              SS SEP84
         BAL   R2,ISPTOP             START AT TOP              SS SEP84
ISPALI4  DS    0H                                              SS SEP84
         MVC   MEM2TTR,MEMLTTSV      TTR FOR SCAN              SS SEP84
         LA    R0,MMLTTR             SCAN FOR                  SS SEP84
         BAL   R2,ISPMEMSC                   MATCH TTR         SS SEP84
         C     R15,ISPL8             FOUND ANY                 SS SEP84
         BE    ISPALI10              NO                        SS SEP84
         CLC   MEM2ALIS,ISPBLK8      ANOTHER ALIAS             SS SEP84
         BNE   ISPALI4               YES KEEP TRYING           SS SEP84
* GOT A MATCH                                                  SS SEP84
         XC    MEMLNAME,MEMLNMSV     SWITCH                    SS SEP84
         XC    MEMLNMSV,MEMLNAME          MEMBER               SS SEP84
         XC    MEMLNAME,MEMLNMSV                NAMES          SS SEP84
         BAL   R2,ISPGET             GET ORIGINAL MEMBER       SS SEP84
         MVC   MEM2ALIS,MEMLNMSV     ALIAS OF NAME             SS SEP84
         BAL   R2,ISPMEMOD           UPDATE                    SS SEP84
         B     ISPALI2               CONTINUE WITH NEXT        SS SEP84
ISPALI10 DS    0H                    NO MATCH                  SS SEP84
         MVC   MEMLNAME,MEMLNMSV                NAMES          SS SEP84
         BAL   R2,ISPGET             GET ORIGINAL MEMBER       SS SEP84
         MVC   MEM2ALIS,ISPUNKN      MARK UNKNOWN              SS SEP84
         BAL   R2,ISPMEMOD           UPDATE                    SS SEP84
         B     ISPALI2               CONTINUE WITH NEXT        SS SEP84
ISPALI50 DS    0H                                              SS SEP84
         CLC   MEM2MNAM,ISPBLK8      IS THERE A MAIN NAME      SS SEP84
         BE    ISPALI3                                         SS SEP84
         MVI   MEMFLAG2,0            CLEAR BEFORE TESTS        SS SEP84
         MVC   MEMLNAME,MEM2MNAM     GET THIS ON IF THERE      SS SEP84
         BAL   R2,ISPGET             GET ORIGINAL MEMBER       SS SEP84
         C     R15,ISPL8             IS THERE ONE              SS SEP84
         BE    ISPALI55              NO, TRY BY TTR            SS SEP84
         OI    MEMFLAG2,MEMLGMNM     FOUND MAIN NAME           SS SEP84
         CLC   MEMLTTSV,MEM2TTR      SAME TTR                  SS SEP84
         BNE   ISPALI55              NO                        SS SEP84
         XC    MEMLNAME,MEMLNMSV     SWITCH                    SS SEP84
         XC    MEMLNMSV,MEMLNAME          MEMBER               SS SEP84
         XC    MEMLNAME,MEMLNMSV                NAMES          SS SEP84
         BAL   R2,ISPGET             GET ORIGINAL MEMBER       SS SEP84
         MVC   MEM2ALIS,MEMLNMSV     ALIAS OF NAME             SS SEP84
         MVC   MEM2MTTR,MEMLNMSV     ALIAS OF NAME             SS SEP84
         BAL   R2,ISPMEMOD           UPDATE                    SS SEP84
         B     ISPALI2               CONTINUE WITH NEXT        SS SEP84
ISPALI55 DS    0H                                              SS SEP84
         MVC   MEM2TTR,MEMLTTSV      TRY  TTR                  SS SEP84
         BAL   R2,ISPTOP             START AT TOP              SS SEP84
ISPALI56 DS    0H                                              SS SEP84
         LA    R0,MMLTTR             SCAN FOR                  SS SEP84
         BAL   R2,ISPMEMSC                   MATCH TTR         SS SEP84
         C     R15,ISPL8             FOUND ANY                 SS SEP84
         BE    ISPALI57              UNKNOWN                   SS SEP84
         CLC   MEM2ALIS,ISPBLK8      ANOTHER ALIAS             SS SEP84
         BNE   ISPALI56              YES KEEP TRYING           SS SEP84
* GOT A MATCH                                                  SS SEP84
         OI    MEMFLAG2,MEMLGTTR     FOUND TTR MATCH           SS SEP84
         XC    MEMLNAME,MEMLNMSV     SWITCH                    SS SEP84
         XC    MEMLNMSV,MEMLNAME          MEMBER               SS SEP84
         XC    MEMLNAME,MEMLNMSV                NAMES          SS SEP84
         BAL   R2,ISPGET             GET ORIGINAL MEMBER       SS SEP84
         MVC   MEM2MTTR,MEMLNMSV     ALIAS OF NAME             SS SEP84
         B     ISPALI58                                        SS SEP84
ISPALI57 DS    0H                                              SS SEP84
         MVC   MEMLNAME,MEMLNMSV     ORIGINAL MEMBER NAME      SS SEP84
         BAL   R2,ISPGET             GET ORIGINAL MEMBER       SS SEP84
ISPALI58 DS    0H                                              SS SEP84
         MVC   MEM2ALIS,ISPORP       ORPHAN                    SS SEP84
         SR    R15,R15               CLEAR                     SS SEP84
         IC    R15,MEMFLAG2          GET STATUS                SS SEP84
         LA    R15,X'F1'(,R15)       ADD 1 AND MAKE PRINTABLE  SS SEP84
         STC   R15,MEM2ALIS+7        TYPE ORPHAN               SS SEP84
         BAL   R2,ISPMEMOD           UPDATE                    SS SEP84
         B     ISPALI2               CONTINUE WITH NEXT        SS SEP84
         DROP  R4                                              SS MAR85
         TITLE  'ISPF - TABLE DISPLAY FUNCTION'                SS NOV85
*                                                              SS MAR85
*  TABLE DISPLAY FUNCTION                                      SS MAR85
*                                                              SS MAR85
ISPTBDSP DS    0H                                              SS SEP84
         USING *,R4                                            SS MAR85
         BAL   R2,ISPQUERY                                     SS NOV85
         TM    SPFTBPF1,SPFTLIN   ACTIVE MEMLIST               SS NOV85
         BO    ISPMMLDS           YES, DISPLAY IT              SS SEP84
         L     R15,SPFSTART       REPOSITION TO HERE           SS MAY85
         S     R15,SPFCRP         CALCULATE RELATIVE POSTION   SS NOV85
         BAL   R2,ISPSKIP                                      SS MAY85
         MVI   SPFLAG1,0          RESET ACTION FLAG           ABL OCT84
         B     ISPTBDP2                                        SS NOV85
         SPACE 3                                               SS NOV84
ISPMMLDS DS    0H                                              SS SEP84
         TM    SPFTFLG1,SPFTLCD     LINE COMMAND ACTIVE        SS NOV85
         BO    ISPMMLLR           RETURN FROM LINE CMD         SS NOV85
         BAL   R2,ISPOSTN                                      SS SEP84
ISPTBDP2 DS    0H                                              SS NOV85
         TM    SPFLAG3,SPFREFR    NEED REFRESH                 SS NOV84
         BZ    ISPTBDNR                                        SS NOV84
         BAL   R2,ISPCREF                                      SS NOV84
ISPTBDNR DS    0H                                              SS NOV84
         OI    ##ADRPA#,$A+$D           IGNORE ATTENTION NOW
         LA    R14,TBDISPL        DISPLAY TABLE                SS JUL84
         ST    R14,PARMLIST                                    SS JUL84
         LA    R14,SPFTBL         TABLE NAME                   SS JUL84
         LA    R15,SPFPANEL       PANEL NAME                   SS JUL84
         LA    R0,0               NO MSG                       SS JUL84
         CLC   SPFMSGID(4),ISPPDSM ANY MSG                     SS NOV84
         BNE   ISPTBDNM                                        SS NOV84
         LA    R0,SPFMSGID                                     SS NOV84
         CLC   SPFPANPR(8),0(R15) SAME PANEL AS LAST TIME?    ABL DEC84
         BNE   ISPTBDNM           NO, BRANCH                  ABL DEC84
         TM    SPFLAG2,SPFNPOS    OVERRIDE POSITIONING?       ABL APR86
         BO    ISPTBDNM           YES, BRANCH                 ABL APR86
         SR    R15,R15            NULLIFY PANEL NAME          ABL DEC84
ISPTBDNM DS    0H                                              SS NOV84
         TM    SPFTBPF1,SPFTLIN   MEMLIST TABLE?               SS NOV85
         BZ    ISPTBDNC           NO, NO CURSOR CRP            SS NOV85
         TM    SPFTFLG1,SPFTYPOS  POSITIONING CALL?            SS NOV85
         BNO   ISPTBDV1           NO, BRANCH                  ABL JUN85
***TEST  CLC   SPFPANPR(8),SPFPANEL  PANEL NAMES EQUAL?       ABL JUN85
***TEST  BNE   ISPTBDV1              NO, CANNOT USE BLANK     ABL JUN85
         TM    SPFLAG2,SPFNPOS    OVERRIDE POSITIONING         SS NOV85
         BO    ISPTBDV1                                        SS AUG85
         SR    R15,R15            CLEAR THE PANEL NAME        ABL JUN85
ISPTBDV1 DS    0H                                             ABL JUN85
         MVC   SPFPANPR(8),SPFPANEL  SAVE LAST PANEL NAME     ABL JUN85
         NI    SPFTFLG1,255-SPFTYPOS          FLAGS OFF        SS NOV85
         NI    SPFLAG2,255-SPFNPOS            FLAGS OFF        SS NOV85
         L     R1,SPFTCCRP        CURSER AT A LINE             SS MAR85
         LTR   R1,R1                                           SS MAR85
         BZ    ISPTBDNC                                        SS MAR85
         L     R1,SPFTBPOA        SET CURSER AT OPT FIELD      SS NOV85
         STM   R14,R1,PARMLIST+4                               SS MAR85
         LA    R14,SPFTCCRP       CRP                          SS NOV85
         ST    R14,PARMLIST+20                                 SS MAR85
         CLI   SPFVERSN,C'2'      ISPF V2 OR LATER             SS MAR85
         BNL   ISPTBDV2           YES                          SS MAR85
         OI    PARMLIST+20,X'80'                               SS JUL84
         B     ISPTBDNF                                        SS MAR85
ISPTBDV2 DS    0H                                              SS MAR85
         SR    R0,R0                                           SS MAR85
         ST    R0,PARMLIST+24     NO POSITION                  SS MAR85
         LA    R14,ISPNO          NO AUTOSEL                   SS MAR85
         ST    R14,PARMLIST+28                                 SS MAR85
         OI    PARMLIST+28,X'80'                               SS JUL84
         CLC   SPFMSGID(4),ISPPDSM  ERROR MESSAGE?            ABL JUN85
         BNE   ISPTBDNF             NO, BRANCH                ABL JUN85
         OI    PARMLIST+20,X'80'    YES, LET AUTOSEL DEFAULT  ABL JUN85
         B     ISPTBDNF                                        SS MAR85
ISPTBDNC DS    0H                                              SS MAR85
         MVC   SPFPANPR(8),SPFPANEL  SAVE LAST PANEL NAME     ABL JUN85
         NI    SPFTFLG1,255-SPFTYPOS          FLAGS OFF        SS NOV85
         NI    SPFLAG2,255-SPFNPOS            FLAGS OFF        SS NOV85
         LA    R1,VZCMD           CURSER AT CMD LINE           SS JUL84
         STM   R14,R1,PARMLIST+4                               SS JUL84
         OI    PARMLIST+16,X'80'                               SS MAR85
ISPTBDNF DS    0H                                              SS MAR85
         CLI   FLAGSSS,C'4'       RETURN FROM MEMLIST?        ABL OCT84
         BL    ISPREAP2           NO, BRANCH                  ABL OCT84
         TM    SPFTBPF1,SPFTLIN   MEMLIST                      SS NOV85
         BZ    ISPREAP2           NO, BRANCH                   SS NOV85
         MVI   FLAGSSS,0          YES, CLEAR IT NOW           ABL OCT84
         SPACE 1                                              ABL SEP84
ISPREAP2 DS    0H                                             ABL SEP84
         LA    R1,PARMLIST                                     SS JUL84
         L     R15,ISPLINK                                     SS JUL84
         BALR  R14,R15                                         SS JUL84
         SPACE 3
***
***
***  TBDISPL ARGUMENT LIST:
***
***    1.  NO LINE COMMANDS:
***        CALL ISPLINK('TBDISPL',SPFTBL,SPFPANEL,MSGID,'ZCMD')
***
***
***    2.  LINE COMMANDS WITH ISPFV1 (OR ISPFV2 AND AN ERROR MESSAGE):
***        CALL ISPLINK('TBDISPL',SPFTBL,SPFPANEL,MSGID,'ISPOPT',LINE)
***
***
***    3.  LINE COMMANDS WITH ISPFV2 AND NO ERROR MESSAGE:
***        CALL ISPLINK('TBDISPL',SPFTBL,SPFPANEL,MSGID,'ISPOPT',LINE,
***                     0,'NO ')   -- AUTOSELECT=NO
***
         SPACE 3
         CLI   FLAGSSS,0          RETURN KEY ACTIVE?          ABL SEP84
         MVI   FLAGSSS,0                                      ABL SEP84
         BNE   ISPREAP2           YES, REPEAT THE TBDISPL     ABL SEP84
         MVI   SPFMSGID,C' '      TURN OFF MSG                 SS NOV84
         ST    R15,SPFFIXED       SAVE RC                      SS JUL84
         CLI   SPFFIXED+3,8           RETURN CODE=8?          ABL OCT84
         BNE   ISPSET8                NO, BRANCH              ABL OCT84
         BAL   R2,ISPDVGET                                     SS NOV84
         SPACE 1                                              ABL OCT84
         CLI   SPFRETRN,C'R'         "RETURN"                 ABL OCT84
         BE    ISPSET4               YES, BRANCH              ABL DEC84
*        CLI   SPFRETRN,C'E'         "END"?                   ABL MAR86
*        BE    ISPSET0               YES, BRANCH              ABL MAR86
*** UNKNOWN SPF KEYWORD, IGNORE                               ABL MAR86
*        MVI   SPFFIXED+3,0          RESET RETURN CODE        ABL MAR86
*        B     ISPSET8               IGNORE                   ABL MAR86
*SPSET0  DS    0H                                             ABL MAR86
         MVC   SPFVZCMD(2),ISP8      SET TO 'END' CODE        ABL DEC84
         MVI   SPFFIXED+3,0          RESET RETURN CODE        ABL DEC84
         TM    SPFTBPF1,SPFTPRI      PANEL 1 (PRIMARY)?       ABL DEC84
         BZ    ISPSET8               NO, BRANCH               ABL DEC84
         CLI   PDSENTRY+3,0          ENTERED AS A DIALOG?     ABL DEC84
         BE    ISPSET8               YES, BRANCH              ABL DEC84
         MVC   SPFVZCMD(2),ISP1      END ON PANEL 1           ABL DEC84
         B     ISPSET8                                        ABL DEC84
ISPSET4  DS    0H                                             ABL DEC84
         MVC   SPFVZCMD(2),ISPR      SET TO 'RETURN' CODE     ABL DEC84
         TM    SPFTBPF1,SPFTPRI      PANEL 1 (PRIMARY)?       ABL DEC84
         BO    ISPSET8               YES, NO PROBLEM          ABL DEC84
         CLI   PDSENTRY+3,0          ENTRY FROM SPF PANEL?    ABL DEC84
         BE    ISPSET8               YES, NO PROBLEM          ABL DEC84
         MVI   SPFFIXED+3,0          RESET RETURN CODE        ABL DEC84
         AIF ('&RETURNX' EQ 'NO').RETURN3                     ABL DEC84
         MVI   FLAGSSS,C'2'          REINVOKE ALL LATER       ABL OCT84
         TM    SPFTBPF1,SPFTLIN   MEMLIST                      SS NOV85
         BZ    ISPSET8            NO, BRANCH                   SS NOV85
         MVI   FLAGSSS,C'4'          REINVOKE EXCEPT MEMLIST  ABL OCT84
.RETURN3 ANOP                                                 ABL DEC84
ISPSET8  DS    0H                                             ABL OCT84
         NI    SPFLAG3,FF-SPFLOGM     ASSUME NO LOGGING        SS NOV84
         CLI   SPFFIXED+3,8           VALID RETURN CODE?      ABL DEC84
         BH    ISPERR                 NO, ERROR               ABL DEC84
* ALL VALIDATION DONE BY TABLES AT ISPOPTT                     SS NOV84
         SPACE 2                                               SS NOV84
         NI    ##ADRPA#,FF-$A-$D        DO NOT IGNORE ATTENTION NOW
         SPACE 1
         ESTAE 0                        CANCEL THE ESTAE ADDRESS
         MVC   STAEPARM(4),STAELIST     RESET THE ESTAE ADDRESS
         L     R2,ISPESTAE              ESTAE EXIT ADDRESS    ABL JUN85
         ESTAE (R2),CT,PARAM=(R7),MF=(E,STAEPARM)             ABL JUN85
         CLI   SPFFIXED+3,4           MORE THAN ONE LINE CMD? ABL JUN85
         BE    ISPMMLD6               SET FLAG                 SS NOV85
         CLC   SPFVZCMD(2),ISP1       END AT PANEL 1?         ABL JUN85
         BE    ISPTBLGD               YES, PROCESS             SS NOV85
         CLC   SPFVZCMD(2),ISP8       END SUBCOMMAND?         ABL JUN85
         BE    ISPTBLGD               YES, PROCESS             SS NOV85
         B     ISPTBLB2                                        SS NOV85
ISPMMLD6 DS    0H                                             ABL JUN85
         TM    SPFTBPF1,SPFTLIN       MEMLIST                  SS NOV85
         BZ    ISPTBLB2                                        SS NOV85
         OI    SPFTFLG1,SPFTMUT       YES, SET BIT             SS SEP84
         B     ISPMMLD8                                        SS NOV85
ISPTBLB2 DS    0H                                              SS NOV85
         LA    R0,80              CHARACTERS TO SCAN          ABL JUN85
         LA    R1,SPFVZCMD+80     WHERE TO START SCAN         ABL JUN85
ISPTBLB  CLI   0(R1),X'40'        BLANK?                      ABL JUN85
         BNE   ISPTBLNB           NO, BRANCH                  ABL JUN85
         BCTR  R1,0               ONE LESS CHARACTER          ABL JUN85
         BCT   R0,ISPTBLB         CHECK ALL CHARACTERS?       ABL JUN85
         B     ISPTBLGD           YES, ALL BLANK               SS NOV85
ISPTBLNB CLI   0(R1),C'+'         CONTINUATION DESIRED?       ABL JUN85
         BNE   ISPTBLGD           NO, PROCESS AS IS            SS NOV85
         LA    R0,SPFVZCMD-1      OFFSET BY -1                ABL JUN85
         SR    R1,R0                                          ABL JUN85
         ST    R1,SPFCURSO        SAVE THE CURSOR POSITION    ABL JUN85
         BAL   R2,ISPSETVI                                     SS NOV85
         L     R0,SPFPANT                                     ABL JUN85
         ST    R0,SPFPANC                                     ABL JUN85
         MVC   SPFPSTK(8),ISP$PANC  CONTINUED PANEL           ABL JUN85
         BAL   R2,ISPPANDI                                     SS NOV85
         CLC   SPFZSEL(4),ISPCEND                             ABL JUN85
         BNE   ISPTBLGD                                        SS NOV85
         MVI   SPFVZCMD,X'40'                                 ABL JUN85
         MVC   SPFVZCMD+1(249),SPFVZCMD  RIPPLE               ABL JUN85
ISPTBLGD DS    0H                                              SS NOV85
         TM    SPFTBPF1,SPFTLIN       MEMLIST                  SS NOV85
         BZ    ISPTBLG3               NO                       SS NOV85
ISPMMLD8 DS    0H                                              SS SEP84
         L     R15,SPFTDTOP           GET TOP OF SCREEN        SS SEP84
         ST    R15,MEMLTOP            NEXT DISPLAY SAME PLACE  SS SEP84
         BAL   R2,ISPQUERY                                     SS JUL84
         L     R15,SPFTCRP                                     SS SEP84
         LTR   R15,R15                ANY LINE COMMANDS?       SS SEP84
         BNZ   ISPLNCMD                                        SS SEP84
         ST    R15,SPFTCCRP           SET ZERO CURSOR          SS MAR85
         B     ISPTBLG4                                        SS NOV85
ISPTBLG3 DS    0H                                              SS SEP84
         MVC   SPFSTART,SPFTDTOP  SAVE INFO                    SS NOV84
ISPTBLG4 DS    0H                                              SS NOV85
         LA    R1,PUTGETBF                                    ABL OCT84
         ST    R1,SPFSAV1                                     ABL OCT84
         BAL   R2,ISPQUERY                                     SS JUL84
         MVC   PUTGETBF(4),ISPLEN     AL2(52,0)               ABL OCT84
         MVC   SPFINPUT(48),SPFVZCMD                           SS NOV84
         CLC   SPFVZCMD+48(8),ISPBLK8  ANY ADDITIONAL OPERS?  ABL JUN85
         BE    ISPTBLG2                NO, BRANCH             ABL JUN85
         MVC   PUTGETBF(4),ISPLEN2     AL2(254,0)             ABL JUN85
         MVC   SPFINPUT(250),SPFVZCMD  CURRENT SUBCOMMAND     ABL JUN85
ISPTBLG2 LA    R15,104                 PROCESS OPTION NEXT     SS NOV85
         BR    R3                      RETURN TO ROUTER       ABL JUN85
         SPACE 2                                              ABL JUN85
ISPLNCMD DS    0H                                              SS SEP84
         BAL   R2,ISPFIRST          CHECK FOR ANY ZCMD         SS SEP84
         LTR   R15,R15              RETURN RC WILL TELL        SS SEP84
         BZ    ISPLNCM2             NO, SKIP SAVE              SS NOV85
*        MVC   MEMLSAVZ,SPFVZCMD    SAVE ZCMD                  SS SEP84
         LH    R15,SPFTBPZC         WHERE TO SAVE ZCMD         SS NOV85
         LA    R15,SPWRKC(R15)      CALC ADDR                  SS NOV85
         MVC   0(48,R15),SPFVZCMD   SAVE ZCMD                  SS NOV85
         OI    SPFTFLG1,SPFTZSV     INDICATE HAVE ZCMD         SS SEP84
ISPLNCM2 DS    0H                                              SS NOV85
         SR    R15,R15              ZERO VALUE                 SS MAR85
         ST    R15,SPFTCCRP         INIT TO ZERO               SS MAR85
         NI    SPFTFLG1,255-SPFTLPOS RESET FLAG                SS NOV85
         OI    SPFTFLG1,SPFTLCD                                SS NOV85
         BAL   R2,ISPDSPSV          SAVE DISPLAY               SS NOV85
         LH    R15,SPFTBPLF         PROCESS LINE CMD           SS NOV85
         BR    R3                                              SS NOV85
* PROCESS RETURN FROM LINE COMMAND                             SS NOV85
ISPMMLLR DS    0H                                              SS NOV85
         NI    SPFTFLG1,255-SPFTLCD  RESET                     SS AUG85
         BAL   R2,ISPDSPRS      RESTORE DISPLAY                SS SEP84
         TM    SPFTFLG1,SPFTMUT MORE LINES TO PROCESS          SS NOV85
         BZ    ISPLNCKZ         NO, CHECK FOR ZCMD            ABL JUN85
ISPREAP1 DS    0H                                             ABL SEP84
         LA    R14,TBDISPL      DISPLAY TABLE                  SS SEP84
         LA    R15,SPFTBL                                      SS SEP84
         STM   R14,R15,PARMLIST  WITH NO                       SS SEP84
         OI    PARMLIST+4,X'80'         TABLE NAME OR MSG      SS SEP84
         LA    R1,PARMLIST                                     SS SEP84
         L     R15,ISPLINK                                     SS JUL84
         BALR  R14,R15                                         SS JUL84
         CLI   FLAGSSS,0          RETURN KEY ACTIVE?          ABL SEP84
         MVI   FLAGSSS,0                                      ABL SEP84
         BNE   ISPREAP1           YES, REPEAT THE TBDISPL     ABL SEP84
         C     R15,ISPL8        FORCED END                     SS SEP84
         BE    ISPMML8          YES                            SS SEP84
         BH    ISPERR                                          SS SEP84
         C     R15,ISPL4           STILL MORE LINES AFTER THIS SS SEP84
         BE    ISPLNCM2            CONTINUE                    SS SEP84
         NI    SPFTFLG1,255-SPFTMUT NO MORE AFTER THIS         SS NOV85
         B     ISPLNCM2            PROCESS THE LAST            SS SEP84
         SPACE 2
ISPMML8  DS    0H                                              SS NOV85
         MVC   SPFVZCMD(2),ISP8                                SS NOV85
         B     ISPTBLGD                                        SS NOV85
         SPACE 2
ISPLNCKZ OI    SPFTFLG1,SPFTYPOS    HONOR POSITIONING          SS NOV85
         TM    SPFTFLG1,SPFTZSV     ZCMD TO PROCESS?           SS NOV85
         BNO   ISPMMLDS             NO, BRANCH                ABL JUN85
         NI    SPFTFLG1,255-SPFTYPOS NO POSITIONING POSSIBLE   SS NOV85
         LH    R15,SPFTBPZC         WHERE IS SAVED ZCMD        SS NOV85
         LA    R15,SPWRKC(R15)      CALC ADDR                  SS NOV85
         MVC   SPFVZCMD(48),0(R15)  RESTORE ZCMD               SS NOV85
         NI    SPFTFLG1,255-SPFTZSV RESET FLAG                 SS NOV85
         B     ISPTBLG3             PROCESS GOOD CMD           SS NOV85
         DROP  R4                                              SS MAR85
         TITLE 'COMMAND PROCESSING'                            SS NOV85
ISPCMDCK DS    0H                   CHECK FOR A PDS COMMAND    SS NOV84
         USING *,R4                                            SS NOV85
         LA    R1,SPFINPUT                                     SS NOV85
         SR    R15,R15                                         SS NOV85
         L     R14,SPFVTPT          RELOAD R14                 SS NOV85
         IC    R15,$TLEX(R14)       GET ANY EXTEND CODE        SS NOV85
         TM    $TLF2(R14),#C        COMMAND TABLE IN EXTEND    SS NOV85
         BO    *+8                  YES, USE IT                SS NOV85
         LA    R15,0                NO, USE PRIMARY            SS NOV85
         L     R14,ISPCMDTT(R15)    INDEX TO TABLE             SS NOV85
         BAL   R2,ISPVERG                                      SS NOV84
         C     R15,ISPL8                                       SS NOV84
         BE    ISPCMDIV                                        SS NOV84
         CH    R15,ISPH12           INVALID COMMAND?           SS NOV84
         BNE   ISPCMDC1             NO, BRANCH                ABL DEC84
         CLI   SPFNAMEH,C'?'        QUESTION MARK?            ABL DEC84
         BE    ISPCMDC0             YES, ALLOW IT             ABL DEC84
         CLI   SPFNAMEH,C'.'        . OF .?                   ABL DEC84
         BE    ISPCMDC0             YES, ALLOW IT             ABL DEC84
         CLI   SPFNAMEH,C'%'        IMPLIED CLIST?            ABL DEC84
         BNE   ISPCMDIV             YES, INCORRECT            ABL DEC84
ISPCMDC0 L     R14,ISPEXECA         ADDRESS OF EXEC           ABL DEC84
         ST    R14,SPFVTPT          SAVE THE ADDRESS           SS NOV85
ISPCMDC1 DS    0H                                             ABL DEC84
         TM    $TLF1(R14),#S        SOURCE ONLY?               SS NOV84
         BZ    ISPCMDC2             NO, BRANCH                 SS NOV84
         TM    FLAGSCC,RECFMU       LOAD LIBRARY?              SS NOV84
         BO    ISPCMDIV             YES, BAD                   SS NOV84
         B     ISPCMDC3                                        SS NOV84
ISPCMDC2 DS    0H                                              SS NOV84
         TM    $TLF1(R14),#U        LOAD LIBRARY ONLY?         SS NOV84
         BZ    ISPCMDC3             NO, BRANCH                 SS NOV84
         TM    FLAGSCC,RECFMU       LOAD LIBRARY?              SS NOV84
         BZ    ISPCMDIV             NO, BAD                    SS NOV84
ISPCMDC3 DS    0H                                              SS NOV84
         TM    $TLF2(R14),#T         COMMAND PROCESS PROVIDED  SS MAR85
         BZ    ISPCMDC7              NO, BRANCH                SS MAR85
         SR    R15,R15                                         SS NOV85
         IC    R15,$TLFU(R14)        GET FUNCTION CODE         SS NOV85
         BR    R3                    RETURN TO ROUTER          SS NOV85
ISPCMDIV DS    0H                                              SS NOV85
         LA    R15,28                ROUTE TO INVALID          SS NOV85
         BR    R3                    RETURN TO ROUTER          SS NOV85
ISPCMDC7 DS    0H                                             ABL DEC84
         TM    SPFLAG2,SPFMEMA      IS IT ACTIVE               SS MAR85
         BZ    ISPCMDC4             NOTHING TO DO              SS MAR85
         CLC   0(8,R14),$SUL        SUBLIST?                  ABL APR86
         BNE   ISPCMDCO             NO, BRANCH                ABL APR86
         TM    SPFLAG0,SPFVIEW      VIEW MODE?                ABL APR86
         BO    ISPCMDCO             YES, IGNORE = OPERAND     ABL APR86
         L     R15,SPFOPER          GET BLANK AFTER COMMAND   ABL APR86
         LA    R14,20               LOOK THIS FAR             ABL APR86
         BAL   R2,ISPCKBLK          FIND NON-BLANK OPERAND    ABL APR86
         CLI   0(R15),C'='          OPERAND "="?              ABL APR86
         BNE   ISPCMDCO             NO, BRANCH                ABL APR86
         LA    R15,88               FUNCTION CODE FOR SUBLIST ABL APR86
         BR    R3                   RETURN TO ROUTER          ABL APR86
ISPCMDCO DS    0H                                             ABL APR86
         TM    $TLF1(R14),#K        INACTIVATE MEMLIST?        SS MAR85
         BZ    ISPCMDCZ             NO, BRANCH                 SS MAR85
ISPCMDCM DS    0H                                              SS MAR85
         BAL   R2,ISPUSTKM        UNSTACK                      SS NOV85
         L     R14,SPFVTPT                                     SS NOV85
         B     ISPCMDC4                                        SS MAR85
ISPCMDCZ DS    0H                                              SS MAR85
         TM    $TLF2(R14),#M         COULD CHANGE STATS        SS MAR85
         BZ    ISPCMDC4                                        SS MAR85
         MVI   SPFPOST1,136         CMD POST PROCESS NUM 8     SS NOV85
         OI    SPFLAG4,SPFCPOST     SET POST PROC FLAG         SS MAR85
ISPCMDC4 DS    0H                                              SS NOV84
         TM    $TLF2(R14),#2         TERMINATE VIEW MODE?     ABL DEC84
         BNO   ISPCMDC8              NO, BRANCH               ABL DEC84
         NI    SPFLAG0,255-SPFVIEW   YES, TURN OFF VIEW MODE  ABL DEC84
ISPCMDC9 TM    SPFTBPF1,SPFTLIN      AT MEMLIST PANEL          SS NOV85
         BO    ISPCMDC8                                        SS NOV85
         TM    SPFTBPF1,SPFTMLX      MEMLIST SUPPORT           SS NOV85
         BZ    ISPCMDC8              NO MORE POPS              SS NOV85
         LA    R1,0                  POP                       SS NOV85
         BAL   R2,ISPSTKI            UNSTACK                   SS NOV85
         B     ISPCMDC9              NEXT                      SS NOV85
ISPCMDC8 DS    0H                                             ABL DEC84
         TM    SPFTBPF1,SPFTLIN      MEMLIST PANEL             SS NOV85
         BZ    ISPCMD                NO                        SS NOV85
         NI    SPFLAG3,255-SPFCONV                             SS NOV84
         NI    SPFLAG0,255-SPFCKER-SPFMSGER                    SS NOV84
         TM    $TLF1(R14),#E         NO MATCH                  SS NOV84
         BO    ISPCMDIV              INVALID MSG               SS NOV84
         TM    $TLF1(R14),#V         VIEW MODE                 SS NOV85
         BZ    ISPCMDCY              NO                        SS NOV85
* R1  SHOULD BE SET FROM PANEL TABLE                           SS NOV85
         LA    R1,2                  VIEW MODE PANEL           SS NOV85
         BAL   R2,ISPSTKI            STACK ROUTINE             SS NOV85
         B     ISPCMD                                          SS NOV85
ISPCMDCY DS    0H                                              SS NOV85
         OI    SPFLAG0,SPFCKER       CHECK FOR PDS ERROR MSGS  SS NOV84
         OI    SPFLAG3,SPFCONV       CONVERT ERROR --> VIEW    SS NOV84
ISPCMD   DS    0H                                              SS NOV84
         LH    R15,PUTGETBF       GET LENG                     SS NOV84
         BCTR  R15,0              LESS 1 MVC                   SS NOV84
         L     R14,SPFVTPT        REFRESH R14                  SS NOV85
         LA    R2,ISPCMDNO        IGNORE TABLE                ABL APR86
         LA    R1,9               9 ENTRIES                   ABL MAR86
ISPCMDNL DS    0H                                              SS NOV85
         CLC   0(8,R14),0(R2)     COMPARE TO TABLE             SS NOV85
         BE    ISPCMDM3           SKIP SAVE                    SS NOV85
         LA    R2,8(,R2)          NEXT ENTRY                   SS NOV85
         BCT   R1,ISPCMDNL        TRY ALL 9                    SS NOV85
ISPCMDM  MVC   SPFZSAV(0),PUTGETBF                             SS NOV84
         EX    R15,ISPCMDM        SAVE CMD FOR RECALL          SS NOV84
ISPCMDM3 DS    0H                                              SS NOV85
         OI    SPFLAG3,SPFLOGM    LOG THE COMMAND              SS DEC84
         LA    R15,112              ROUTE TO ISPCMDC           SS NOV85
         BR    R3                                              SS NOV85
         DROP  R4                                              SS MAR85
ISPCMDTT DS    0F                                              SS NOV85
         DC    A(ISP$TL2)   0   MAIN COMMAND TABLE             SS NOV85
         DC    A(ISP$TL3)   4   DISPLAY ONLY COMMANDS          SS NOV85
         DC    A(ISP$TL3)   8   PAD                            SS NOV85
ISPCMDNO DS    0F                                              SS NOV85
         DC    CL8'&NOR1 '  IGNORE FOR RECALL                  SS NOV85
         DC    CL8'&NOR2 '  IGNORE FOR RECALL                  SS NOV85
         DC    CL8'&NOR3 '  IGNORE FOR RECALL                  SS NOV85
         DC    CL8'&NOR4 '  IGNORE FOR RECALL                  SS NOV85
         DC    CL8'&NOR5 '  IGNORE FOR RECALL                  SS NOV85
         DC    CL8'&NOR6 '  IGNORE FOR RECALL                  SS NOV85
         DC    CL8'&NOR7 '  IGNORE FOR RECALL                 ABL MAR86
         DC    CL8'&NOR8 '  IGNORE FOR RECALL                 ABL MAR86
         DC    CL8'&NOR9 '  IGNORE FOR RECALL                 ABL MAR86
         TITLE 'COMMAND SETUP FOR PDS'                         SS NOV85
*                                                              SS NOV85
*   SETUP COMMAND FOR PDS PROCESSING                           SS NOV85
*                                                              SS NOV85
ISPCMDC  DS    0H                                              SS NOV84
         USING *,R4                                            SS NOV85
         MVC   SPFTTPT,SPFVTPT      GOOD CMD, SAVE             SS NOV85
         MVC   SPFSAVPT,SPFVTPT     SAVE POINTER               SS NOV85
         NI    SPFLAG4,255-SPF38XA  NOT PROMPTING NOW         ABL DEC84
         LA    R1,3                 POINT AT CKP PANEL         SS NOV85
         BAL   R2,ISPSTKI            STACK                     SS NOV85
         BAL   R2,ISPBOTM            GO TO BOTTOM              SS NOV85
         BAL   R2,ISPQUERY                                     SS NOV85
         L     R15,SPFLAST          SAVE INFO                  SS JUL84
         ST    R15,SPFSTART                                    SS JUL84
         LA    R1,PUTGETBF                                    ABL OCT84
         ST    R1,SPFSAV1                                     ABL OCT84
         TM    SPFLAG3,SPFLOGM    TO BE LOGGED?               ABL OCT84
         BNO   ISPNOLOG           NO, BRANCH                  ABL OCT84
         BAL   R2,ISPLOGCD        SPECIAL CODE TO LOG          SS NOV85
ISPNOLOG DS    0H                                             ABL NOV84
         TM    FLAGSFF,FLOGWRT    LOGGING TO A DATA SET?      ABL NOV84
         BNO   ISPNOLDS           NO, BRANCH                  ABL NOV84
         LA    R1,PUTGETBF        POINT TO THE DATA LINE      ABL NOV84
         L     R2,VLOGDATA        GET VCON ADDRESS             SS JUL85
         BALR  R14,R2             LOG TO THE DATA SET          SS JUL85
ISPNOLDS DS    0H                                             ABL NOV84
         LA    R14,0                                           SS JUL84
         STH   R14,SPFCKPT                                     SS JUL84
*            CODE TO DELETE OLD OUTPUT IF OVER TABLE SIZE      SS JUL84
         L     R14,SPFLAST        CURRENT SIZE                 SS JUL84
         CH    R14,SPFSIZE        SIZE LIMIT                   SS JUL84
         BNH   ISPSZOK            NOT TO BIG                   SS JUL84
         SH    R14,SPFSIZE        CALC DELETE AMOUNT           SS JUL84
         ST    R14,SPFFIXED       SAVE DELETE COUNT            SS JUL84
         LH    R14,SPFSIZE        TABLE SIZE                   SS JUL84
         LNR   R14,R14                NEGATIVE                 SS JUL84
         ST    R14,SPFFIXE2       SAVE SKIP COUNT              SS JUL84
         BAL   R2,ISPDEL          GO DELETE                    SS JUL84
         BAL   R2,ISPQUERY       GET NEW SIZE                  SS JUL84
         L     R15,SPFLAST        SAVE INFO                    SS JUL84
         ST    R15,SPFSTART                                    SS JUL84
ISPSZOK  DS    0H                                              SS NOV84
         B     ISPEXIT                                         SS NOV84
         DROP  R4                                              SS MAR85
         TITLE 'ISPF - PARSE LEVEL 1 SUBROUTINE'               SS NOV85
*                                                              SS MAR85
*   PARSE SUBROUTINE  R3 = RETURN                              SS MAR85
*                     R1 = PARSE LIST                          SS MAR85
*                     R14= LENGTH OF INPUT LINE                SS MAR85
*                     R15= INPUT LINE ADDRESS                  SS MAR85
*         EACH PARSE ENTRY IN LIST                             SS NOV85
*   X'00' ENTRY TYPE/LEN                                       SS NOV85
*   X'000000'   ENTRY ID (BIT PATTERN ORED INTO RETURN FLAGS   SS NOV85
*   CL8' '      KEY WORD OR  F,F FOR NUMERIC RANGE             SS NOV85
ISPPELN  EQU   12    LENGTH OF EACH ENTRY                      SS NOV85
ISPPKW   EQU   4     OFFSET TO KEY WORD IN ENTRY               SS NOV85
*                                                              SS NOV85
ISPPARSE DS    0H                                              SS MAR85
         USING *,R4                                            SS MAR85
         MVI   SPFPRRC,0    SET RC ZERO                        SS MAR85
         MVI   SPFPRFG,0    ZERO PROCESS FLAG                  SS NOV85
         XC    SPFPRBI,SPFPRBI ZERO PARM BITS                  SS NOV85
         SR    R0,R0                                           SS NOV85
         ST    R0,SPFPRNU                                      SS NOV85
         ST    R0,SPFPRNU2                                     SS NOV85
         BAL   R2,ISPCKBLK  POSITION AT FIRST NON BLANK        SS MAR85
         LTR   R15,R15      ANY                                SS MAR85
         BZ    ISPPARE8     NO  STRING FOUND                   SS MAR85
         ST    R1,SPFPRAD   SAVE PARSE LIST                    SS MAR85
         TM    0(R1),X'80'  STRING REQUEST                     SS MAR85
         BZ    ISPPAR50     NO TRY OTHER                       SS MAR85
         CLI   0(R15),X'8B' BRACKET                            SS MAR85
         BE    ISPPAR05     YES USE A DELIMITER                SS MAR85
         CLI   0(R15),X'80' ALPHA (UPPER OR LOWER)             SS MAR85
         BH    ISPPAR10     YES, USE BLANK AS DELIMITER        SS MAR85
         CLI   0(R15),C'$'  NATIONAL CHAR                      SS MAR85
         BE    ISPPAR10     YES, USE BLANK AS DELIMITER        SS MAR85
         CLI   0(R15),C'@'  NATIONAL CHAR                      SS MAR85
         BE    ISPPAR10     YES, USE BLANK AS DELIMITER        SS MAR85
         CLI   0(R15),C'#'  NATIONAL CHAR                      SS MAR85
         BE    ISPPAR10     YES, USE BLANK AS DELIMITER        SS MAR85
         TM    1(R1),X'80'  FIND COMMAND?                     ABL JUN85
         BZ    ISPPAR02     YES, USE CHARACTER AS DELIMITER   ABL JUN85
         CLI   0(R15),C'*'  RECALL GROUP                       SS MAR85
         BE    ISPPAR10     YES, USE BLANK AS DELIMITER        SS MAR85
         CLI   0(R15),C':'  GROUP                              SS MAR85
         BE    ISPPAR10     YES, USE BLANK AS DELIMITER        SS MAR85
         CLI   0(R15),C'/'  PATTERN?                          ABL JUN85
         BE    ISPPAR10     YES, USE BLANK AS DELIMITER?      ABL JUN85
ISPPAR02 DS    0H                                             ABL JUN85
         IC    R1,0(R15)    INSERT COMPARE CHAR                SS MAR85
         LA    R15,1(,R15)  START AT NEXT CHAR                 SS MAR85
         B     ISPPAR15     CONTINUE                           SS MAR85
ISPPAR05 DS    0H                                              SS MAR85
         IC    R1,0(R15)                                       SS MAR85
         B     ISPPAR15                                        SS MAR85
ISPPAR10 DS    0H                                              SS MAR85
         LA    R1,C' '      USE BLANK                          SS MAR85
ISPPAR15 DS    0H                                              SS MAR85
         ST    R15,SPFPRSR  START OF STRING                    SS MAR85
         BAL   R2,ISPCLI                                       SS MAR85
         LTR   R15,R15                                         SS MAR85
         BZ    ISPPAREL     RC 12 ERROR IN LENGTH OF STRING    SS MAR85
         LR    R0,R15                                          SS MAR85
         SL    R0,SPFPRSR   CALCULATE FIRST LENGTH             SS MAR85
         BCTR  R0,0         LESS ON                            SS MAR85
         STH   R0,SPFPRLN                                      SS MAR85
         L     R1,SPFPRAD   GET ADDRESS OF PARM                SS MAR85
         OC    SPFPRBI,1(R1) OR IN PARM BIT                    SS MAR85
         CLI   0(R15),C' '  WE AT BLANK                        SS MAR85
         BE    ISPPAR20     YES                                SS MAR85
         LA    R15,1(,R15)  SKIP OVER DELIMITER                SS MAR85
ISPPAR20 DS    0H                                              SS MAR85
         BAL   R2,ISPCKBLK  FIND NEXT PARM                     SS MAR85
         LTR   R15,R15      ANY FOUND                          SS MAR85
         BZR   R3           NO DONE                            SS MAR85
         LA    R1,ISPPELN(,R1) SET TO NEXT PARSE ENTRY         SS MAR85
         ST    R1,SPFPRAD                                      SS MAR85
ISPPAR50 DS    0H                                              SS MAR85
         MVI   SPFPRRC,24   INCASE INVALID KEY                 SS MAY85
         ST    R14,SPFPRLL  SAVE IT                            SS MAR85
         L     R1,SPFPRAD   GET ADDRESS                        SS MAR85
         CLI   0(R1),X'FF'  END OF TABLE                       SS MAR85
         BE    ISPPAR90     DONE, SETUP RC                     SS MAR85
         CLI   0(R15),C'-'  IS IT NUMERIC (NEGATIVE)           SS MAR85
         BE    ISPPAR60     YES                                SS MAR85
         CLI   0(R15),C'0'  IS IT NUMERIC                      SS MAR85
         BNL   ISPPAR62     YES                                SS MAR85
         TM    0(R1),X'40'  NUMERIC PARM                       SS MAR85
         BZ    ISPPAR70     NO                                 SS MAR85
         LA    R1,ISPPELN(,R1) NEXT ENTRY                      SS MAR85
         TM    0(R1),X'40'  NUMERIC SECOND PARM                SS NOV85
         BZ    ISPPAR70     NO                                 SS NOV85
         LA    R1,ISPPELN(,R1) NEXT ENTRY                      SS NOV85
         B     ISPPAR70     TRY KEYWORDS                       SS MAR85
ISPPAR60 DS    0H                                              SS MAR85
         OI    SPFPRRC,X'80' SAY NEGATIVE VALUE                SS MAR85
         LA    R15,1(,R15)  SKIP OVER - SIGN                   SS MAR85
         BCT   R14,ISPPAR61                                    SS MAR85
         B     ISPPARES     NO NUMBERS                         SS MAR85
ISPPAR61 CLI   0(R15),C'0'  CHECK NUMERIC FOR SURE             SS MAR85
         BL    ISPPARES     NO NUMBERS                         SS MAR85
ISPPAR62 DS    0H                                              SS MAR85
         TM    0(R1),X'40'  WE LOOKING FOR NUMERIC             SS MAR85
         BZ    ISPPARES     NO NUMBERS ALLOWED                 SS MAR85
         ST    R15,SPFPRSV  SAVE LOCATION                      SS MAR85
ISPPAR63 CLI   0(R15),C'0'  FIND ALL THE NUMBERS               SS MAR85
         BL    ISPPAR65     END OF NUMBERS                     SS MAR85
         LA    R15,1(,R15)  NEXT                               SS MAR85
         BCT   R14,ISPPAR63 CONTINUE                           SS MAR85
ISPPAR65 ST    R14,SPFPRLL  SAVE                               SS MAR85
         L     R14,SPFPRSV  GET ADDRESS NUMBER                 SS MAR85
         LR    R1,R15                                          SS MAR85
         SLR   R1,R14       CALCULATE LENGTH                   SS MAR85
         BCTR  R1,0         ON LESS FOR PACK                   SS MAR85
         EX    R1,ISPPAR95  DO PACK                            SS MAR85
         TM    SPFPRRC,X'80'  WAS IT NEG                       SS MAR85
         BZ    ISPPAR66                                        SS MAR85
         NI    WORKTBL+7,X'FD' MAKE NEG DECIMAL                SS MAR85
ISPPAR66 DS    0H                                              SS MAR85
         CVB   R14,WORKTBL                                     SS MAR85
         TM    SPFPRFG,SPFPRN1  WE HAVE FIRST NUMBER           SS NOV85
         BO    ISPPAR6A                                        SS NOV85
         ST    R14,SPFPRNU  SAVE VALUE                         SS MAR85
         B     ISPPAR6B                                        SS NOV85
ISPPAR6A ST    R14,SPFPRNU2                                    SS NOV85
ISPPAR6B OI    SPFPRFG,SPFPRN1 GOT FIRST NUMBER                SS NOV85
         L     R1,SPFPRAD   GET ADDRESS OF PARM                SS MAR85
         TM    0(R1),X'10'  CHECK RANGE REQUIRED               SS MAY85
         BZ    ISPPAR67     NO                                 SS MAY85
         C     R14,4(,R1)   LOWER RANGE                       ABL MAR86
         BL    ISPPARER     LOWER IS ERROR                     SS MAY85
         C     R14,8(,R1)   UPPER RANGE                       ABL MAR86
         BH    ISPPARER     UPPER IS ERROR                     SS MAY85
ISPPAR67 DS    0H                                              SS MAY85
         MVI   SPFPRRC,0    GOOD SO FAR                        SS MAY85
         OC    SPFPRBI,1(R1) OR IN PARM BIT                    SS MAR85
         LA    R1,ISPPELN(,R1) BUMP TO NEXT PARSE ENTRY        SS NOV85
         ST    R1,SPFPRAD                                      SS NOV85
         B     ISPPAR80     CONTINUE LOOKING FOR OTHER PARMS   SS MAR85
ISPPAR95 PACK  WORKTBL(8),0(0,R14)   <<EXECUTED>>              SS MAR85
ISPPAR70 DS    0H                                              SS MAR85
         CLI   0(R1),X'FF'  END OF TABLE                       SS MAR85
         BE    ISPPAREK     DONE, SETUP RC                     SS MAR85
         TM    0(R1),X'20'  IS IT KEYWORD                      SS MAR85
         BZ    ISPPAREP     INVALID PARSE PARM RC=16           SS MAR85
         TM    0(R1),X'10'  SINGLE CHAR CHECK                  SS MAY85
         BZ    ISPPAR72     NO                                 SS MAY85
         CLI   1(R15),C' '  ONLY ONE CHAR                      SS MAY85
         BNE   ISPPAR72     NO                                 SS MAY85
         OC    0(1,R15),ISPBLK8 MAKE UPPER CASE                SS MAR85
         CLC   0(1,R15),ISPPKW(R1) COMP PARM TO KEYWORD       ABL APR86
         BNE   ISPPAR75     TRY NEXT KEYWORD                   SS MAR85
         B     ISPPAR73     GOOD KEY                           SS MAR85
ISPPAR72 DS    0H                                              SS MAY85
         IC    R14,0(R1)    GET COMPARE LENGTH                 SS MAR85
         N     R14,ISPPAR97 AND OUT OTHER BITS                 SS MAR85
         OC    0(8,R15),ISPBLK8 MAKE UPPER CASE                SS MAR85
         EX    R14,ISPPAR98 COMPARE KEYWORD                    SS MAR85
         BNE   ISPPAR75     TRY NEXT KEYWORD                   SS MAR85
ISPPAR73 DS    0H                                              SS MAY85
         MVI   SPFPRRC,0    GOOD KEY                           SS MAY85
         OC    SPFPRBI,1(R1) FOUND THIS KEYWORD                SS MAR85
         B     ISPPAR80     SETUP FOR NEXT PARM                SS MAR85
ISPPAR75 DS    0H                                              SS MAR85
         LA    R1,ISPPELN(,R1) NEXT ENTRY                      SS MAR85
         B     ISPPAR70     CONTINUE                           SS MAR85
         DS    0F                                             ABL APR85
ISPPAR97 DC    X'00000007'  MASK LAST 3 BITS                   SS MAR85
ISPPAR98 CLC   0(0,R15),ISPPKW(R1) COMP PARM TO KEYWORD        SS NOV85
ISPPAR80 DS    0H                                              SS MAR85
         L     R14,SPFPRLL  GET LENGTH                         SS MAR85
         LTR   R14,R14      ANY MORE                           SS MAR85
         BZ    ISPPAR90     SETUP RC                           SS MAR85
         LA    R1,C' '      FIND NEXT BLANK                    SS MAR85
         BAL   R2,ISPCLI                                       SS MAR85
         LTR   R15,R15                                         SS MAY85
         BZ    ISPPAR90     END OF INPUT                       SS MAY85
         BAL   R2,ISPCKBLK  FIND NEXT PARM                     SS MAY85
         LTR   R15,R15                                         SS MAY85
         BZ    ISPPAR90     END OF INPUT                       SS MAY85
         B     ISPPAR50     VERIFY THIS PARM                   SS MAR85
ISPPARE8 MVI   SPFPRRC,8    NO STRING PARM                     SS MAY85
         B     ISPPAR90                                        SS MAY85
ISPPAREL MVI   SPFPRRC,12   STRING PARM TO LONG                SS MAY85
         MVC   SPFMSGID,ISPPDSM SETUP MESSAGE                  SS MAY85
         MVI   SPFMSGID+7,C'A'                                 SS MAY85
         MVI   SPFMSGID+6,C'3'                                 SS MAY85
         B     ISPPAR90                                        SS MAY85
ISPPARES MVI   SPFPRRC,16   SYNTAX ERROR IN NUMERIC            SS MAY85
         MVC   SPFMSGID,ISPPDSM SETUP MESSAGE                  SS MAY85
         MVI   SPFMSGID+7,C'A'                                 SS MAY85
         MVI   SPFMSGID+6,C'4'                                 SS MAY85
         B     ISPPAR90                                        SS MAY85
ISPPARER MVI   SPFPRRC,20   RANGE  ERROR IN NUMERIC            SS MAY85
         MVC   SPFMSGID,ISPPDSM SETUP MESSAGE                  SS MAY85
         MVI   SPFMSGID+7,C'A'                                 SS MAY85
         MVI   SPFMSGID+6,C'5'                                 SS MAY85
         B     ISPPAR90                                        SS MAY85
ISPPAREK MVI   SPFPRRC,24   INVALID KEY                        SS MAY85
         MVC   SPFMSGID,ISPPDSM SETUP MESSAGE                  SS MAY85
         MVI   SPFMSGID+7,C'A'                                 SS MAY85
         MVI   SPFMSGID+6,C'6'                                 SS MAY85
         B     ISPPAR90                                        SS MAY85
ISPPAREP MVI   SPFPRRC,32   INVALID PARSE LIST                 SS MAY85
         DC    H'0'         TEST .. FORCE  0C1                 SS MAY85
         B     ISPPAR90                                        SS MAY85
ISPPAR90 DS    0H                                              SS MAR85
         SR    R15,R15                                         SS MAR85
         IC    R15,SPFPRRC                                     SS MAR85
         BR    R3                                              SS MAR85
         DROP  R4                                              SS MAR85
         SPACE 2                                               SS MAR85
         TITLE 'ISPF - SUPPORT  LV 1 SUBROUTINE'               SS NOV85
*                                                              SS JUL84
*  SUPPORT ROUTE TO VDEFINE AND COPY DATA SET INFO             SS JUL84
*    RETURN REG IS R3                                          SS JUL84
*                                                              SS JUL84
ISPSETVS DS    0H                                              SS SEP84
         USING *,R4                                            SS MAR85
         TM    SPFVFLGS,X'40'          VDEFINES DONE           SS NOV85
         BO    ISPSETV2                                        SS NOV85
         LA    R1,SPFPSTK                                      SS NOV85
         ST    R1,SPFPANT                                      SS NOV85
         ST    R1,SPFPANC                                      SS NOV85
         LA    R1,SPFPSTKB                                     SS NOV85
         ST    R1,SPFPANB                                      SS NOV85
         LA    R1,ISPSETVZ                                     SS NOV85
         BAL   R2,ISPVDEFX                                     SS NOV85
ISPSETV2 DS    0H                                              SS SEP84
         MVC   SPFDSNAM,DSNAME                                 SS SEP84
         MVC   SPFPWD,PASSWORD                                 SS SEP84
         MVC   SPFVOL,VOLUME                                   SS SEP84
*              SPFMEMB SET BY CALLER                           SS NOV84
*              MEMLNMSV SET BY CALLER                          SS NOV84
         MVC   SPFDSORG,ISPPS          ASSUME DSORG=PS         SS SEP84
         MVI   SPFTYPE,C' '            TYPE BLANK              SS NOV84
         TM    DSORG,DS1DSGPO          IS IT PO                SS SEP84
         BZ    ISPSETV4                NO                      SS NOV84
         MVC   SPFDSORG,ISPPO          YES, SET TO PO          SS SEP84
ISPSETV3 DS    0H                                              SS SEP84
         TM    FLAGSCC,RECFMU              IS IT LOAD          SS SEP84
         BZ    ISPSETV4                    NO                  SS SEP84
         MVI   SPFTYPE,C'U'                YES, SET U          SS SEP84
ISPSETV4 DS    0H                                              SS SEP84
         MVI   SPFZSEL,C' '            CLEAR ZSEL              SS SEP84
         MVC   SPFZSEL+1(249),SPFZSEL        RIPPLE            SS SEP84
         BR    R3                                              SS SEP84
         DROP  R4                                              SS MAR85
         DS    0F                                              SS NOV85
ISPSETVZ DC    H'0',X'40',X'00'                                SS NOV85
         DC    A(VSPFDSN),AL2(SPFDSNAM-SPWRKC),H'44'           SS NOV85
         DC    A(VSPFPWD),AL2(SPFPWD-SPWRKC),H'8'              SS NOV85
         DC    A(VSPFVOL),AL2(SPFVOL-SPWRKC),H'6'              SS NOV85
         DC    A(VSPFMEM),AL2(SPFMEMB-SPWRKC),H'8'             SS NOV85
         DC    A(VSPFDATA),AL2(MEMLNMSV-SPWRKC),H'8'           SS NOV85
         DC    A(VSPFDSG),AL2(SPFDSORG-SPWRKC),H'2'            SS NOV85
         DC    A(VSPFTYPE),AL2(SPFTYPE-SPWRKC),H'1'            SS NOV85
         DC    A(VSPFZSEL),AL2(SPFZSEL-SPWRKC),H'250'          SS NOV85
         DC    X'FF'                                           SS NOV85
         SPACE 2                                               SS SEP84
VSPFDSN  DC    C'PDSDSN '                                      SS JUL84
VSPFPWD  DC    C'PDSPWD '                                      SS JUL84
VSPFVOL  DC    C'PDSVOL '                                      SS JUL84
VSPFMEM  DC    C'PDSMEM '                                      SS JUL84
VSPFDATA DC    C'PDSDATA '                                     SS NOV84
VSPFDSG  DC    C'PDSDSORG '                                    SS JUL84
VSPFTYPE DC    C'PDSTYPE '                                     SS JUL84
VSPFZSEL DC    C'PDSZSEL '                                     SS NOV84
         TITLE 'ISPF - INITIZATION 1 SUBROUTINE'               SS NOV85
* INITIALIZE THE DIALOG VARIABLES                              SS JUL84
ISPVINIT DS    0H                                              SS MAR85
         USING *,R4                                            SS MAR85
         MVI   SPFINPUT,C' '           BLANK IF NOT USED YET   SS NOV84
         MVC   SPFINPUT+1(48),SPFINPUT                         SS NOV84
         MVC   SPFZSAV(13),ISPENDIT  DEFAULT                   SS NOV84
         CLI   SPFLAG1,SPFCLEAN    OPT CLEANUP                 SS JUL84
         BE    ISPEXIT             YES, NOTHING TO CLEANUP     SS JUL84
         NI    MEMFLAG0,0                                      SS SEP84
         XC    SPFVFLGS,SPFVFLGS  CLEAR ODD VARIABLE FLAGS     SS NOV85
         LA    R14,VDEFINE         START VDEFINES              SS JUL84
         ST    R14,PARMLIST                                    SS JUL84
         LA    R14,VSPFVFIX        ALL FIXED DIALOG VERBS      SS SEP84
         LA    R15,SPFFIXED                                    SS JUL84
         LA    R0,ISPFIX                                       SS JUL84
         LA    R1,ISPL4                                        SS JUL84
         STM   R14,R1,PARMLIST+4                               SS JUL84
         OI    PARMLIST+16,X'80'                               SS JUL84
         LA    R1,PARMLIST                                     SS JUL84
         L     R15,ISPLINK                                     SS JUL84
         BALR  R14,R15                                         SS JUL84
         LTR   R15,R15                                         SS JUL84
         BNZ   ISPERR                                          SS JUL84
         LA    R1,ISPVIV                                       SS NOV85
         BAL   R2,ISPVDEFX                                     SS NOV85
         B     ISPVINT2                                        SS NOV85
         DS    0F                                              SS NOV85
ISPVIV   DC    H'0',X'80',X'00'                                SS NOV85
         DC    A(VZCMD),AL2(SPFVZCMD-SPWRKC),H'250'            SS NOV85
         DC    A(VSPFMSG1),AL2(SPFMLIN1-SPWRKC),H'8'           SS NOV85
         DC    A(VSPFMSG2),AL2(SPFMLIN2-SPWRKC),H'79'          SS NOV85
         DC    X'FF'                                           SS NOV85
ISPVINT2 DS    0H                                              SS NOV85
         LA    R14,VSPFLIN                                     SS JUL84
         LA    R15,SPFLINE        TABLE LINE                   SS JUL84
         LA    R1,ISPL80                                      ABL APR86
         BAL   R2,ISPVDEF                                      SS SEP84
         LA    R14,VZVERB                                     ABL OCT84
         LA    R15,SPFRETRN       RETURN/END                  ABL OCT84
         L     R1,ISPL8            SET LENGTH                 ABL OCT84
         ST    R1,SPFFIXER            TO 8                    ABL OCT84
         LA    R1,SPFFIXER               USE AS PARM          ABL OCT84
         BAL   R2,ISPVDEF                                     ABL OCT84
         LA    R14,VSPFMSG                                     SS JUL84
         LA    R15,FIRST4K                                     SS NOV85
         LA    R15,SPFDSNMG-FIRST4K(R15) DSN AND VOL PANEL MSG SS NOV85
         LA    R1,ISPLMSG                                      SS JUL84
         BAL   R2,ISPVDEF                                      SS SEP84
         LA    R14,VCOPY          GET THE TIME                 SS JUL84
         ST    R14,PARMLIST                                    SS JUL84
         LA    R14,VZTIME           GET TIME OF DATA           SS JUL84
         L     R15,ISPL8            SET LENGTH                 SS JUL84
         ST    R15,SPFFIXED            TO 8                    SS JUL84
         LA    R15,SPFFIXED               USE AS PARM          SS JUL84
         LA    R0,SPFTBL                                       SS JUL84
         LA    R1,ISPMOVE                                      SS JUL84
         STM   R14,R1,PARMLIST+4                               SS JUL84
         OI    PARMLIST+16,X'80'                               SS JUL84
         LA    R1,PARMLIST                                     SS JUL84
         L     R15,ISPLINK                                     SS JUL84
         BALR  R14,R15                                         SS JUL84
         LTR   R15,R15                                         SS JUL84
         BNZ   ISPERR                                          SS JUL84
         MVC   SPFTBL+5(2),SPFTBL+3 MINUTES PART OF TABLE NAME SS JUL84
         MVC   SPFTBL+3(2),SPFTBL   HOURS ALSO                 SS JUL84
         MVC   SPFTBL(3),ISPPDS     TABLE NAME STARTS PDS      SS JUL84
         MVI   SPFTBL+7,C'0'        FILL OUT TO 8 CHAR         SS JUL84
         LA     R15,0               ZERO COMPARES              SS AUG84
         CH     R15,SPFMAX          IS IT SET                  SS AUG84
         BNZ    *+10                YES                        SS AUG84
         MVC    SPFMAX,ISPMAX       NO, SET IT                 SS AUG84
         CH     R15,SPFCKSZ         IS IT SET                  SS AUG84
         BNZ    *+10                YES                        SS AUG84
         MVC    SPFCKSZ,ISPCKPT     NO, SET IT                 SS AUG84
         CH     R15,SPFSIZE         IS IT SET                  SS AUG84
         BNZ    *+10                YES                        SS AUG84
         MVC    SPFSIZE,ISPSIZE     NO, SET IT                 SS AUG84
         BAL   R2,ISPCREAT        CREATE TABLE                 SS JUL84
*        MVC   SPFPANEL,ISPPANAL                               SS NOV85
         LA    R14,SPFPSTKT        TOP OF STACK                SS NOV85
         ST    R14,SPFPANTT        SET TOP                     SS NOV85
         ST    R14,SPFPANCT        SET CURRENT                 SS NOV85
         LA    R14,SPFPSTKL        LAST OF STACK               SS NOV85
         ST    R14,SPFPANBT        SET BOTTOM                  SS NOV85
         MVC   SPFLOGHM(8),SPFTBL  MAKE IT THE SAME            SS NOV85
         MVC   SPFCSUF,SPFTBL      SET SUFFIX                  SS NOV85
         LA    R1,SPFLOGHM         HOME FOR LOG                SS NOV85
         ST    R1,SPFTHOME         INIT HOME  POINTER          SS NOV85
         LA    R1,1                PANEL INDEX 1               SS NOV85
         LNR   R1,R1               NEG FOR SWAP                SS NOV85
         BAL   R2,ISPSTKI          CALL STACK ROUTINE          SS NOV85
         LA    R14,VCOPY          GET THE TIME                 SS MAR85
         ST    R14,PARMLIST                                    SS MAR85
         LA    R14,VZENVIR          GET TIME OF DATA           SS MAR85
         L     R15,ISPL32           SET LENGTH                 SS MAR85
         ST    R15,SPFFIXED            TO 8                    SS MAR85
         LA    R15,SPFFIXED               USE AS PARM          SS MAR85
         LA    R0,SPFZENVI                                     SS MAR85
         LA    R1,ISPMOVE                                      SS MAR85
         STM   R14,R1,PARMLIST+4                               SS MAR85
         OI    PARMLIST+16,X'80'                               SS MAR85
         LA    R1,PARMLIST                                     SS MAR85
         L     R15,ISPLINK                                     SS MAR85
         BALR  R14,R15                                         SS MAR85
         C     R15,ISPL8            RC=8 -- FROM ISPFV1?      ABL APR85
         BER   R3                   YES, RETURN               ABL APR85
         LTR   R15,R15                                         SS MAR85
         BNZ   ISPERR                                          SS MAR85
         BR    R3                                              SS MAR85
         DROP  R4                                              SS MAR85
         TITLE 'ISPF - RECALL FUNCTION          '              SS NOV85
* RECALL SUPPORT                                               SS MAY85
ISPRCAL  DS    0H          ****   RECALL SUBCOMMAND  ****      SS NOV84
         USING ISPRCAL,R4                                      SS NOV85
         L     R15,SPFOPER           FIRST BLANK AFTER CMD    ABL DEC84
         LA    R14,30                TRY FOR 30 BYTES         ABL DEC84
         LA    R1,ISPPARRE           PARSE LIST                SS MAY85
         BAL   R2,ISPPARSI           PARSE ROUTINE             SS NOV85
         C     R15,ISPL8             RETURN CODE               SS MAY85
         BE    ISPRCAL3                                        SS MAY85
         BH    ISPDISP6                                        SS MAY85
         TM    SPFPRBI,X'01'         FROM LOG                  SS MAY85
         BO    ISPRCAL8                                        SS MAY85
         TM    SPFPRBI,X'20'         CHANGE OPERAND            SS MAY85
         BO    ISPRCAL6                                        SS MAY85
         TM    SPFPRBI,X'10'         ENTER                     SS MAY85
         BO    ISPRCAL5                                        SS MAY85
         B     ISPRCAL3                                        SS MAY85
ISPRCAL5 LH    R15,SPFZSAV           LENGTH                    SS MAR85
         BCTR  R15,0                 MACHINE LENGTH           ABL DEC84
         MVC   PUTGETBF(*-*),SPFZSAV <<EXECUTED>>             ABL DEC84
         EX    R15,*-6               MOVE IN THE SUBCOMMAND   ABL DEC84
         LA    R15,104               ROUTE TO ISPOPTT          SS NOV85
         BR    R3                    RETURN TO ROUTER          SS NOV85
*        B     ISPOPTT               RESCAN THE SUBCOMMAND    ABL DEC84
ISPRCAL3 DS    0H                                              SS MAR85
         MVI   SPFVZCMD,C' '                                   SS NOV84
         MVC   SPFVZCMD+1(249),SPFVZCMD                        SS NOV84
         LH    R15,SPFZSAV        GET LENG                     SS NOV84
         SH    R15,ISPH5          LESS 5 MVC                   SS NOV84
ISPRCAL2 MVC   SPFVZCMD(0),SPFZSAV+4                           SS NOV84
         EX    R15,ISPRCAL2       SAVE CMD FOR RECALL          SS NOV84
         B     ISPRCALP                                        SS NOV85
*        B     ISPSETP3                                        SS NOV84
ISPRCAL6 DS    0H                                              SS MAY85
         TM    SPFPRBI,X'10'      SHOULD NOT BE ENTER KEY      SS MAY85
         BO    ISPRCAL9           CONFLICT                     SS MAY85
         MVI   SPFVZCMD,C' '                                  ABL APR85
         MVC   SPFVZCMD+1(249),SPFVZCMD                       ABL APR85
         LA    R15,FIRST4K                                     SS NOV85
         MVC   SPFVZCMD(128),RECALLDS+4-FIRST4K(R15)     MSG   SS NOV85
         B     ISPRCALP                                        SS NOV85
*        B     ISPSETP3                                       ABL APR85
ISPRCAL8 DS    0H                                              SS MAY85
         TM    SPFTBPF1,SPFTLIN   MEMLIST                      SS NOV85
         BO    ISPRCAL9           INVALID                      SS NOV85
         TM    SPFPRBI,X'30'      TEST ENTER AND CHANGE KEY    SS MAY85
         BNZ   ISPRCAL9           CONFLICT                     SS MAY85
*   NEED INTERFACE TO RLOG                                     SS NOV85
         L     R4,ISPRLOGA                                     SS MAY85
         BALR  R3,R4                                           SS MAY85
         LA    R3,ISPROUT         RELOAD ROUTER ADDRESS       ABL MAR86
         L     R4,ISPRCALA        RELOAD BASE REGISTER        ABL MAR86
         LTR   R15,R15                                         SS MAY85
         BZ    ISPRCALP                                        SS NOV85
*        BZ    ISPSETP3                                        SS MAY85
         B     ISPRCALX                                        SS NOV85
*        B     ISPDISP6                                        SS MAY85
ISPRCAL9 DS    0H                                              SS MAY85
         MVC   SPFMSGID,ISPPDSM   INIT MESSAGE                 SS MAY85
         MVI   SPFMSGID+7,C'A'                                 SS MAY85
         MVI   SPFMSGID+6,C'7'    CONFLICT MESSAGE             SS MAY85
ISPRCALX DS    0H                                              SS NOV85
         LA    R15,40             ROUTE TO ISPDISP6            SS NOV85
         BR    R3                 RETURN TO ROUTER             SS NOV85
*        B     ISPDISP6                                        SS MAY85
ISPRCALP DS    0H                 SET UP TO PANEL PROCESSOR    SS NOV85
         LA    R4,ISPSETP                                      SS NOV85
         DROP  R4                                              SS NOV85
         B     ISPSETP3-ISPSETP(R4)                            SS NOV85
         TITLE 'ISPF - O AND T SUBCOMMANDS      '              SS NOV85
         SPACE 2
ISPSETP  DS    0H          ****   O AND T SUBCOMMANDS ****     SS NOV84
         USING ISPSETP,R4                                      SS NOV85
         NI    SPFLAG4,255-SPFMCMD  RESET FLAG                 SS NOV84
         MVI   SPFVZCMD,C' '                                   SS NOV84
         MVC   SPFVZCMD+1(249),SPFVZCMD                        SS NOV84
         MVC   MEMLNMSV,ISPBLK8                                SS NOV84
         MVC   SPFSAVM2,ISPBLK8                                SS AUG85
         MVC   SPFMEMB,ISPBLK8                                 SS NOV84
         L     R14,SPFVTPT                                     SS NOV85
         TM    $TLF2(R14),#Z                                   SS NOV84
         BO    ISPSETP2                                        SS NOV84
         LH    R15,PUTGETBF       GET LENG                     SS NOV84
         SH    R15,ISPH5          LESS 5 MVC                   SS NOV84
ISPSETP4 MVC   SPFVZCMD(0),SPFINPUT                            SS NOV84
         EX    R15,ISPSETP4       COPY TO CMD FROM INPUT       SS NOV84
         BAL   R2,ISPSHCMD                                     SS NOV84
         CLI   SPFVZCMD,C' '                                   SS NOV84
         BE    ISPSETP3                                        SS NOV84
ISPSETP2 DS    0H                                              SS NOV84
         OI    SPFLAG4,SPFNOND      INVOKE PANEL NON-DISPLAY   SS NOV84
ISPSETP3 DS    0H                                              SS NOV84
         BAL   R2,ISPSETVI                                     SS NOV85
         L     R1,SPFPANT                                      SS NOV84
         ST    R1,SPFPANC                                      SS NOV84
         L     R14,SPFVTPT                                     SS NOV85
         SR    R15,R15                                         SS NOV84
         IC    R15,$TLEX(R14)                                  SS NOV84
         AL    R15,ISP$PNA                                     SS MAR85
         MVC   SPFPSTK(8),0(R15)                               SS NOV84
         TM    DSORG,DS1DSGPO        IS IT PO                 ABL OCT85
         BO    ISPSETPP              YES, CONTINUE            ABL OCT85
         CLI   SPFPSTK+4,C'P'        NO, IS IT P..0P@P        ABL OCT85
         BNE   ISPSETPP              NO, CONTINUE             ABL OCT85
         MVI   SPFPSTK+4,C'S'        YES, USE P..OS@P         ABL OCT85
ISPSETPP DS    0H                                              SS NOV84
         BAL   R2,ISPPANDI                                     SS NOV85
         CLC   SPFZSEL(4),ISPCEND                              SS NOV84
         BE    ISPDISP6                                        SS NOV84
         MVC   SPFINPUT(250),SPFZSEL                           SS NOV84
         MVC   PUTGETBF(4),ISPLEN2                             SS NOV84
         L     R14,SPFVTPT                                     SS NOV85
*        TM    $TLF2(R14),#Z        NONDISPL                   SS NOV84
*        BO    ISPSETP5             YES, THEN NO POST PROC     SS NOV84
*        TM    $TLF2(R14),#A        RESCAN.. MULTY FUNC PANEL  SS NOV84
*        BZ    ISPSETP5             NO, THEN NO POST PROC      SS NOV84
ISPSETP5 DS    0H                                              SS NOV84
         TM    $TLF2(R14),#A        ACTIVATE RESCAN?           SS NOV84
         BZ    ISPSETP6             NO, CHECK COMMAND          SS NOV84
         LA    R15,104              TO ISPOPTT                 SS NOV85
         BR    R3                   RETURN TO ROUTER           SS NOV85
ISPSETP6 DS    0H                                              SS NOV85
         LA    R15,24               TO CMDCK                   SS NOV85
         BR    R3                   RETURN TO ROUTER           SS NOV85
         DROP  R4                                              SS NOV85
         TITLE 'ISPF - RECALL LEVEL 1 SUBROUTINE'              SS NOV85
         SPACE 3                                               SS NOV84
*  RECALL FROM LOG                                             SS MAY85
ISPRLOG  DS    0H                                              SS MAY85
         USING ISPRLOG,R4                                      SS MAY85
ISPRLG10 DS    0H                  PROCESS RECALL FROM LOG     SS MAY85
         TM    SPFPRBI,X'40'       NUMBER SUPPLIED             SS MAY85
         BZ    ISPRLG12            NO                          SS JUN85
         L     R15,SPFPRNU         GET NUMBER                  SS JUN85
         LTR   R15,R15             CHECK VALUE                 SS JUN85
         BZ    ISPRLG12            ZERO, SET DEFAULT           SS JUN85
         BP    ISPRLG15            POSITIVE, OK                SS JUN85
         LPR   R15,R15             MAKE POSITIVE               SS JUN85
         OI    SPFPRBI,X'05'       PREVIOUS CODE               SS JUN85
         ST    R15,SPFPRNU         SAVE                        SS JUN85
         B     ISPRLG15                                        SS JUN85
ISPRLG12 DS    0H                                              SS JUN85
         LA    R15,1               DEFAULT TO 1                SS MAY85
         ST    R15,SPFPRNU                                     SS MAY85
ISPRLG15 DS    0H                                              SS MAY85
         TM    SPFPRBI,X'08'       FIRST KEY WORD              SS MAY85
         BZ    ISPRLG30            NO, THEN USE CURRENT        SS MAY85
         TM    SPFPRBI,X'06'       LAST/PREV/-N KEYWORD?       SS JUN85
         BNZ   ISPRLGEC            YES, CONFLICT WITH FIRST    SS JUN85
         BAL   R2,ISPTOP           YES, START AT TOP           SS MAY85
         B     ISPRLG45                                        SS MAY85
ISPRLG30 DS    0H                                              SS MAY85
         TM    SPFPRBI,X'02'       LAST KEYWORD?               SS JUN85
         BZ    ISPRLG35            NO, THEN USE CURRENT        SS JUN85
         BAL   R2,ISPBOTM          YES, START AT BOTTOM        SS JUN85
         B     ISPRLG45                                        SS JUN85
ISPRLG35 DS    0H                                              SS JUN85
         BAL   R2,ISPQUERY                                     SS NOV85
         L     R15,SPFSTART        START SEARCH HERE           SS MAY85
         S     R15,SPFCRP          RELATIVE POSITION           SS MAY85
         BAL   R2,ISPSKIP          POSITION SUBR               SS MAY85
         TM    SPFPRBI,X'04'       PREVIOUS?                   SS JUN85
         BO    ISPRLG47            BACK UP ONE                 SS JUN85
         B     ISPRLG45            START SEARCH                SS MAY85
ISPRLG40 DS    0H                                              SS MAY85
         ST    R15,SPFPRNU         SAVE NUMBER FOR NEXT TIME   SS MAY85
         B     ISPRLG47                                        SS MAY85
ISPRLG45 DS    0H                                              SS MAY85
         CLI   SPFLINE,C'>'        COMMAND FLAG                SS MAY85
         BE    ISPRLG50            GOT IT                      SS MAY85
ISPRLG47 DS    0H                                              SS MAY85
         LA    R15,1               SKIP ONE                    SS MAY85
         TM    SPFPRBI,X'04'       PREVIOUS KEYWORD?           SS JUN85
         BZ    ISPRLG48                                        SS JUN85
         LNR   R15,R15             YES, SKIP -1                SS JUN85
ISPRLG48 DS    0H                                              SS JUN85
         BAL   R2,ISPSKIP                                      SS MAY85
         LTR   R15,R15                                         SS MAY85
         BNZ   ISPRLGEN            RAN OFF END                 SS JUN85
         B     ISPRLG45                                        SS MAY85
ISPRLG50 DS    0H                                              SS MAY85
         L     R15,SPFPRNU         COUNT THEM                  SS MAY85
         BCT   R15,ISPRLG40        NOT THIS ONE                SS MAY85
         BAL   R2,ISPQUERY                                     SS NOV85
         MVC   SPFLAST,SPFCRP      DISPLAY HERE IF NO ACTION   SS NOV85
         MVI   SPFVZCMD,C' '       BLANK ZCMD                  SS MAY85
         MVC   SPFVZCMD+1(249),SPFVZCMD  RIPPLE                SS MAY85
         LA    R1,SPFVZCMD         START OF BUFFER TEXT        SS MAY85
         ST    R1,SPFPRNU          SAVE FOR NEXT               SS MAY85
ISPRLG60 DS    0H                                              SS MAY85
         MVC   0(78,R1),SPFLINE+1  MOVE COMMAND TEXT           SS MAY85
         LA    R15,1               CHECK NEXT LINE             SS MAY85
         BAL   R2,ISPSKIP                                      SS MAY85
         LTR   R15,R15                                         SS MAY85
         BNZ   ISPRLG90            NOT MORE IN TABLE           SS MAY85
         CLI   SPFLINE,C'-'        COMMAND CONTINUATION        SS MAY85
         BNE   ISPRLG90            NO, DONE                    SS MAY85
         L     R1,SPFPRNU          LAST TEXT POSITION          SS MAY85
         LA    R1,78(,R1)          POSITION TEXT 78 CHAR       SS MAY85
         ST    R1,SPFPRNU          LAST TEXT POSITION         ABL JUN85
         B     ISPRLG60            PROCESS IT                  SS MAY85
ISPRLGEC DS    0H                                              SS JUN85
         BAL   R2,ISPBOTM          RESET RECORD POINTER        SS JUN85
         MVC   SPFMSGID,ISPPDSM    INIT                        SS JUN85
         MVI   SPFMSGID+7,C'A'      CONFLICT                   SS JUN85
         MVI   SPFMSGID+6,C'7'             MESSAGE             SS JUN85
         B     ISPRLGE2                                        SS JUN85
ISPRLGEN DS    0H                                              SS MAY85
         BAL   R2,ISPBOTM          RESET RECORD POINTER        SS MAY85
         MVC   SPFMSGID,ISPPDSM    INIT                        SS MAY85
         MVI   SPFMSGID+7,C'F'      BOTTOM                     SS MAY85
         MVI   SPFMSGID+6,C'2'             MESSAGE             SS MAY85
         TM    SPFPRBI,X'04'       PREVIOUS?                   SS JUN85
         BZ    ISPRLGE2                                        SS JUN85
         MVI   SPFMSGID+6,C'3'     TOP                         SS JUN85
ISPRLGE2 DS    0H                                              SS JUN85
         LA    R15,8               NO COMMANDS FOUND           SS MAY85
         BR    R3                                              SS MAY85
ISPRLG90 DS    0H                                              SS MAY85
         BAL   R2,ISPBOTM          RESET RECORD POINTER        SS MAY85
         SR    R15,R15             GOOD COMMAND                SS MAY85
         BR    R3                                              SS MAY85
         DROP  R4                                              SS MAR85
         SPACE 2                                               SS MAY85
         TITLE 'ISPF - FIND  FUNCTION'                         SS NOV85
* FIND SUPPORT                                                 SS MAY85
ISPFIND  DS    0H          ****    FIND  SUBCOMMAND  ****      SS MAY85
         USING *,R4                                            SS NOV85
         L     R15,SPFOPER           FIRST BLANK AFTER CMD     SS MAY85
         LA    R14,46                TRY FOR 46 BYTES          SS MAY85
         LH    R1,SPFTBPFD         FIND INDEX CODE             SS NOV85
         L     R1,ISPFDPR(R1)      GET PARSE TABLE             SS NOV85
*        LA    R1,ISPPARFD           PARSE LIST                SS MAY85
         BAL   R2,ISPPARSI           PARSE ROUTINE             SS NOV85
         C     R15,ISPL8             RETURN CODE               SS MAY85
         BH    ISPFIND2                                        SS NOV85
         CLI   SPFPRRC,8           NO STRING                   SS MAY85
         BE    ISPFLG03                                        SS MAY85
         TM    SPFPRBI,X'03'       PREFIX OR SUFFIX            SS MAY85
         BO    ISPFLGX2            BOTH.. ERROR                SS MAY85
         TM    SPFPRBI,X'05'       WORD OR SUFFIX              SS MAY85
         BO    ISPFLGX2            BOTH.. ERROR                SS MAY85
         TM    SPFPRBI,X'06'       WORD OR PREFIX              SS MAY85
         BO    ISPFLGX2            BOTH.. ERROR                SS MAY85
         MVC   SPFTFF,SPFPRBI                                  SS NOV85
         NI    SPFTFF2,255-X'02'   CLEAR AT TOP/BOTTOM         SS NOV85
         NI    SPFTFF2,255-X'18'   CLEAR REPET FIND/SEC NUM    SS JAN86
         OI    SPFTFF2,X'01'       HAVE STRING                 SS NOV85
         TM    SPFPRBI2,X'80'      HAVE SECONDED NUMBER        SS NOV85
         BZ    *+8                                             SS NOV85
         OI    SPFTFF2,X'10'                                   SS NOV85
         NI    SPFPRBI2,255-X'80'  CLEAR                       SS NOV85
* SPFTFST IS SET TO START OF FIELD FOR SEARCH                  SS NOV85
* SPFTFED IS SET TO LENGTH OF FIELD                            SS NOV85
         LH    R1,SPFTBPFD         FIND INDEX CODE             SS NOV85
         LTR   R1,R1               INDEX 0                     SS NOV85
         BZ    ISPFINDS            YES, FOR SESION LOG         SS NOV85
         L     R1,ISPFDCK(R1)      GET CHECK TABLE             SS NOV85
ISPFINDL CLI   0(R1),X'FF'         END OF TABLE                SS NOV85
         BE    ISPFLGX2            MUST BE KEY CONFLICT        SS NOV85
         CLC   0(2,R1),SPFPRBI2    COMPARE BYTES 2 AND 3       SS NOV85
         BE    ISPFINDF            GOT A MATCH                 SS NOV85
         LA    R1,06(,R1)          NEXT ENTRY                  SS NOV85
         B     ISPFINDL            LOOP                        SS NOV85
* THE FOLLOWING ARE FOR SESION LOG                             SS NOV85
* OTHERS COULD BE SET FOR OTHER TABLES                         SS NOV85
ISPFINDS LA    R1,SPFLINE                                      SS NOV85
         ST    R1,SPFTFST          STARTING LOCATION           SS NOV85
         LA    R1,78                                           SS NOV85
         STH   R1,SPFTFED          SET LENGTH                  SS NOV85
         B     ISPFIND3                                        SS NOV85
* THIS IS END OF PARMETERS FOR LOG FIND                        SS NOV85
ISPFINDF DS    0H                  GOOD ONE                    SS NOV85
         LH    R14,2(R1)           GET FIELD OFFSET            SS NOV85
         LA    R14,SPWRKC(R14)     CALU ADDRESS                SS NOV85
         ST    R14,SPFTFST         STARTIN LOCATION            SS NOV85
         LH    R14,4(R1)           LENGTH                      SS NOV85
         STH   R14,SPFTFED         SET LENGTH                  SS NOV85
         B     ISPFIND3                                        SS NOV85
ISPFIND3 DS    0H                                              SS NOV85
         TM    SPFTFF,X'40'        OFFSET FLAG                 SS NOV85
         BZ    ISPFLG01            NO                          SS NOV85
         LH    R1,SPFTFED          LENGTH                      SS JAN86
         LA    R1,1(,R1)           BASE 1                      SS JAN86
         C     R1,SPFPRNU          CHECK RANGE                 SS JAN86
         BL    ISPFLGX1            RANGE ERROR                 SS JAN86
         TM    SPFTFF2,X'10'       ENDING RANGE ALSO           SS JAN86
         BZ    ISPFLGD1            SKIP SECOND RANGE CHECK     SS JAN86
         C     R1,SPFPRNU2         CHECK RANGE                 SS JAN86
         BL    ISPFLGX1            RANGE ERROR                 SS JAN86
         CLC   SPFPRNU,SPFPRNU2    SECOND MUST FOLLOW FIRST    SS JAN86
         BH    ISPFLGX1            RANGE ERROR                 SS JAN86
ISPFLGD1 DS    0H                                              SS JAN86
         BCTR  R1,0                BASE 0                      SS JAN86
         SH    R1,SPFPRLN          LAST POSSIBLE POSITION      SS JAN86
         BM    ISPFLGX3            LENGTH ERROR                SS JAN86
         L     R14,SPFPRNU         OFFSET                      SS JAN86
         BCTR  R14,0               REF TO ZERO                 SS JAN86
         CR    R14,R1              AFTER LAST POSSIBLE POSITIONSS JAN86
         BH    ISPFLGX3            YES, LENGTH ERROR           SS JAN86
         L     R15,SPFTFST         STARTING LOCATION           SS JAN86
         AR    R15,R14             ADD POSITION                SS JAN86
         ST    R15,SPFTFST         NEW STARTING LOCATION       SS JAN86
         TM    SPFTFF2,X'10'       ENDING RANGE                SS JAN86
         BZ    ISPFLGA1            NO                          SS JAN86
         L     R15,SPFPRNU2        GET IT                      SS JAN86
         BCTR  R15,0               REF TO ZERO                 SS JAN86
         CR    R15,R1              AFTER LAST POSSIBLE POSITIONSS JAN86
         BH    *+6                 YES                         SS JAN86
         LR    R1,R15              NO, USE THIS POSITION       SS JAN86
         SR    R1,R14              LAST MINUS FIRST            SS JAN86
         BZ    ISPFLGA1            NO LENGTH, USE ONLY FIRST   SS JAN86
         LA    R1,1(,R1)           PLUS 1                      SS JAN86
         STH   R1,SPFTFED          SET LENGTH OF SEARCH        SS JAN86
         NI    SPFTFF,255-X'40'    TURN OFF POSITION           SS NOV85
         B     ISPFLGA1                                        SS NOV85
ISPFLG01 DS    0H                                              SS NOV85
         LH    R1,SPFTFED                                      SS NOV85
         SH    R1,SPFPRLN          ALLOW FOR LENG OF STRING    SS NOV85
         BM    ISPFLGX3            TO LONG                     SS NOV85
         BZ    ISPFLGC1                                        SS NOV85
         LA    R1,1(,R1)                                       SS NOV85
         STH   R1,SPFTFED          SET LENGTH                  SS NOV85
         B     ISPFLGA1                                        SS NOV85
ISPFLGC1 DS    0H                                              SS NOV85
         OI    SPFTFF,X'40'        USE POSITION                SS NOV85
         B     ISPFLGA1                                        SS NOV85
ISPFLGX1 DS    0H                                              SS NOV85
         MVC   SPFMSGID,ISPPDSM SETUP MESSAGE                  SS NOV85
         MVI   SPFMSGID+7,C'A'                                 SS NOV85
         MVI   SPFMSGID+6,C'5'     RANGE ERROR                 SS NOV85
         B     ISPFIND2            RETURN WITH ERROR           SS NOV85
ISPFLGX2 DS    0H                                              SS NOV85
         MVC   SPFMSGID,ISPPDSM SETUP MESSAGE                  SS NOV85
         MVI   SPFMSGID+7,C'A'                                 SS NOV85
         MVI   SPFMSGID+6,C'7'     CONFLICT ERROR              SS NOV85
         B     ISPFIND2            RETURN WITH ERROR           SS NOV85
ISPFLGX3 DS    0H                                              SS NOV85
         MVC   SPFMSGID,ISPPDSM SETUP MESSAGE                  SS NOV85
         MVI   SPFMSGID+7,C'A'                                 SS NOV85
         MVI   SPFMSGID+6,C'3'     OPERAND LENGTH ERROR        SS NOV85
         B     ISPFIND2            RETURN WITH ERROR           SS NOV85
ISPFLGA1 DS    0H                                              SS NOV85
         LH    R2,SPFPRLN          LENGTH OF STRING            SS NOV85
         STH   R2,SPFTFDL                                      SS NOV85
         LA    R1,SPFFDSAV                                     SS NOV85
         ST    R1,SPFTFDS          SAVE COMPARE STG ADDR       SS NOV85
         LH    R1,SPFPRLN                                      SS MAY85
         L     R15,SPFPRSR                                     SS MAY85
         EX    R1,ISPFLGMV         EXECUTE MVC CHAR            SS MAY85
         TM    SPFPRBI,X'80'       ASIS                        SS MAY85
         BO    ISPFLG02            DO NOT FORCE UPPER CASE     SS MAY85
         MVI   SPFINPUT,C' '       SETUP BLANK LINE            SS MAY85
         MVC   SPFINPUT+1(79),SPFINPUT  RIPPLE                ABL APR86
         LH    R1,SPFTFDL          FIND STRING LENGTH          SS NOV85
         EX    R1,ISPFLGOC         EXECUTE OR CHAR             SS MAY85
         B     ISPFLG04                                        SS NOV85
ISPFLGOC OC    SPFFDSAV,SPFINPUT   FORCE UPPER CASE            SS MAY85
ISPFLGMV MVC   SPFFDSAV(0),0(R15)  SAVE COMPARE STRING         SS NOV85
ISPFLG03 DS    0H                                              SS NOV85
         OI    SPFTFF2,X'08'       REPET FIND                  SS NOV85
ISPFLG04 BAL   R2,ISPFNDI                                      SS NOV85
ISPFIND2 DS    0H                                              SS NOV85
         LA    R15,100              ROUTE TO TBDISPLAY         SS NOV85
         B     ISPROUT              RETURN TO ROUTER           SS NOV85
         DROP  R4                                              SS NOV85
         SPACE 2
ISPFDPR  DS    0F                                              SS NOV85
         DC    A(ISPPARFD)     0   PARSE LIST ADDRESS          SS NOV85
         DC    A(ISPPARF2)     4   MEMLIST SOURCE              SS NOV85
         DC    A(ISPPARF3)     8   MEMLIST LOAD MOD            SS NOV85
         DC    A(ISPPARF4)    12   LISTA                       SS NOV85
         DC    A(ISPPARF5)    16   LISTV                       SS NOV85
ISPFDCK  DS    0F                                              SS NOV85
         DC    A(0)                TABLE ADDRESSES             SS NOV85
         DC    A(ISPFDCK2)                                     SS NOV85
         DC    A(ISPFDCK3)                                     SS NOV85
         DC    A(ISPFDCK4)                                     SS NOV85
         DC    A(ISPFDCK5)                                     SS NOV85
* PARSE PARM LIST FOR FIND                                     SS MAR85
         DS    0F                                              SS MAR85
ISPPARFD DC    X'80',X'00',X'00',X'00',CL8' ' STRING           SS MAY85
         DC    X'51',X'40',X'00',X'00',F'1',F'79' NUMERIC      SS MAY85
         DC    X'51',X'00',X'80',X'00',F'2',F'79' NUMERIC2     SS NOV85
         DC    X'33',X'80',X'00',X'00',CL8'ASIS' KEYWORDS      SS MAY85
         DC    X'34',X'20',X'00',X'00',CL8'FIRST'              SS MAY85
         DC    X'23',X'10',X'00',X'00',CL8'PREVIOUS'           SS MAY85
         DC    X'33',X'18',X'00',X'00',CL8'LAST'               SS MAY85
         DC    X'33',X'04',X'00',X'00',CL8'WORD'               SS MAY85
         DC    X'23',X'02',X'00',X'00',CL8'PREFIX'             SS MAY85
         DC    X'23',X'01',X'00',X'00',CL8'SUFFIX'             SS MAY85
         DC    X'FF'                                           SS MAY85
         DS    0F                                              SS NOV85
ISPPARF2 DC    X'80',X'00',X'00',X'00',CL8' ' STRING           SS MAY85
         DC    X'51',X'40',X'00',X'00',F'1',F'08' NUMERIC      SS MAY85
         DC    X'51',X'00',X'80',X'00',F'2',F'08' NUMERIC2     SS NOV85
         DC    X'33',X'80',X'00',X'00',CL8'ASIS' KEYWORDS      SS MAY85
         DC    X'34',X'20',X'00',X'00',CL8'FIRST'              SS MAY85
         DC    X'23',X'10',X'00',X'00',CL8'PREVIOUS'           SS MAY85
         DC    X'33',X'18',X'00',X'00',CL8'LAST'               SS MAY85
         DC    X'33',X'04',X'00',X'00',CL8'WORD'               SS MAY85
         DC    X'23',X'02',X'00',X'00',CL8'PREFIX'             SS MAY85
         DC    X'23',X'01',X'00',X'00',CL8'SUFFIX'             SS MAY85
         DC    X'33',X'00',X'40',X'00',CL8'USERID'             SS NOV85
         DC    X'22',X'00',X'00',X'10',CL8'ANY'               ABL APR86
         DC    X'21',X'00',X'40',X'00',CL8'ID'                 SS NOV85
         DC    X'34',X'00',X'20',X'00',CL8'CDATE'              SS NOV85
         DC    X'34',X'00',X'20',X'00',CL8'CREATED'           ABL APR86
         DC    X'34',X'00',X'10',X'00',CL8'MDATE'              SS NOV85
         DC    X'33',X'00',X'10',X'00',CL8'MODIFIED'          ABL APR86
         DC    X'22',X'00',X'00',X'04',CL8'MOD'               ABL APR86
         DC    X'23',X'00',X'08',X'00',CL8'SIZE'               SS NOV85
         DC    X'22',X'00',X'04',X'00',CL8'VERSION'            SS NOV85
         DC    X'22',X'00',X'04',X'00',CL8'VERMOD'             SS NOV85
         DC    X'23',X'00',X'00',X'02',CL8'INIT'              ABL APR86
         DC    X'22',X'00',X'02',X'00',CL8'TTR'                SS NOV85
         DC    X'24',X'00',X'01',X'00',CL8'ALIASOF'            SS NOV85
         DC    X'22',X'00',X'00',X'01',CL8'MEMBER'  REDUNDANT  SS NOV85
         DC    X'FF'                                           SS MAY85
         DS    0H                                              SS NOV85
ISPFDCK2 DC    X'0000',AL2(MEMLNAME-SPWRKC),AL2(MEM2CSIZ+8-MEMLNAME)
         DC    X'0010',AL2(MEMLNAME-SPWRKC),AL2(MEM2CSIZ+8-MEMLNAME)
*SPFDCK2 DC    X'0000',AL2(MEMLNAME-SPWRKC),H'07'              SS NOV85
         DC    X'0001',AL2(MEMLNAME-SPWRKC),H'07'              SS NOV85
         DC    X'4000',AL2(MEM2MID-SPWRKC),H'07'               SS NOV85
         DC    X'2000',AL2(MEM2CDAT-SPWRKC),H'07'              SS NOV85
         DC    X'1000',AL2(MEM2MDAT-SPWRKC),H'07'              SS NOV85
         DC    X'0800',AL2(MEM2CSIZ-SPWRKC),H'05'              SS NOV85
         DC    X'0400',AL2(MEM2VMOD-SPWRKC),H'07'              SS NOV85
         DC    X'0004',AL2(MEM2VMOD-SPWRKC+3),H'02'           ABL APR86
         DC    X'0002',AL2(MEM2ISIZ-SPWRKC),H'05'             ABL APR86
         DC    X'0200',AL2(MEM2TTR-SPWRKC),H'05'               SS NOV85
         DC    X'0100',AL2(MEM2ALIS-SPWRKC),H'07'              SS NOV85
         DC    X'FFFF'              END OF TABLE               SS NOV85
         DS    0F                                              SS NOV85
ISPPARF3 DC    X'80',X'00',X'00',X'00',CL8' ' STRING           SS MAY85
         DC    X'51',X'40',X'00',X'00',F'1',F'08' NUMERIC      SS MAY85
         DC    X'51',X'00',X'80',X'00',F'2',F'08' NUMERIC2     SS NOV85
         DC    X'33',X'80',X'00',X'00',CL8'ASIS' KEYWORDS      SS MAY85
         DC    X'34',X'20',X'00',X'00',CL8'FIRST'              SS MAY85
         DC    X'23',X'10',X'00',X'00',CL8'PREVIOUS'           SS MAY85
         DC    X'33',X'18',X'00',X'00',CL8'LAST'               SS MAY85
         DC    X'33',X'04',X'00',X'00',CL8'WORD'               SS MAY85
         DC    X'23',X'02',X'00',X'00',CL8'PREFIX'             SS MAY85
         DC    X'23',X'01',X'00',X'00',CL8'SUFFIX'             SS MAY85
         DC    X'22',X'00',X'00',X'10',CL8'ANY'               ABL APR86
******   DC    X'23',X'00',X'40',X'00',CL8'ATTR'               SS NOV85
         DC    X'33',X'00',X'20',X'00',CL8'DATE'               SS NOV85
         DC    X'33',X'00',X'20',X'00',CL8'LENLKED'           ABL APR86
         DC    X'23',X'00',X'10',X'00',CL8'LENGTH'             SS NOV85
         DC    X'23',X'00',X'10',X'00',CL8'SIZE'               SS NOV85
         DC    X'24',X'00',X'08',X'00',CL8'ENTRY'              SS NOV85
         DC    X'23',X'00',X'00',X'80',CL8'MAIN'               SS NOV85
         DC    X'24',X'00',X'00',X'40',CL8'MATCH'              SS NOV85
         DC    X'22',X'00',X'00',X'20',CL8'SSI'                SS NOV85
         DC    X'22',X'00',X'02',X'00',CL8'TTR'                SS NOV85
         DC    X'24',X'00',X'01',X'00',CL8'ALIASOF'            SS NOV85
         DC    X'22',X'00',X'00',X'01',CL8'MEMBER'  REDUNDANT  SS NOV85
         DC    X'FF'                                           SS MAY85
         DS    0H                                              SS NOV85
ISPFDCK3 DC    X'0000',AL2(MEMLNAME-SPWRKC),AL2(MEM2LDAT+8-MEMLNAME)
         DC    X'0010',AL2(MEMLNAME-SPWRKC),AL2(MEM2LDAT+8-MEMLNAME)
*SPFDCK3 DC    X'0000',AL2(MEMLNAME-SPWRKC),H'07'              SS NOV85
         DC    X'0001',AL2(MEMLNAME-SPWRKC),H'07'              SS NOV85
*        DC    X'4000',AL2(MEM2ATT1-SPWRKC),H'27'              SS NOV85
         DC    X'2000',AL2(MEM2LDAT-SPWRKC),H'07'              SS NOV85
         DC    X'1000',AL2(MEM2LENG-SPWRKC),H'05'              SS NOV85
         DC    X'0800',AL2(MEM2ENTY-SPWRKC),H'05'              SS NOV85
         DC    X'0080',AL2(MEM2MNAM-SPWRKC),H'07'              SS NOV85
         DC    X'0040',AL2(MEM2MTTR-SPWRKC),H'07'              SS NOV85
         DC    X'0020',AL2(MEM2SSI-SPWRKC),H'07'               SS NOV85
         DC    X'0200',AL2(MEM2TTR-SPWRKC),H'05'               SS NOV85
         DC    X'0100',AL2(MEM2ALIS-SPWRKC),H'07'              SS NOV85
         DC    X'FFFF'              END OF TABLE               SS NOV85
         DS    0F                                              SS NOV85
ISPPARF4 DC    X'80',X'00',X'00',X'00',CL8' ' STRING           SS MAY85
         DC    X'51',X'40',X'00',X'00',F'1',F'44' NUMERIC     ABL APR86
         DC    X'51',X'00',X'80',X'00',F'2',F'44' NUMERIC2    ABL APR86
         DC    X'33',X'80',X'00',X'00',CL8'ASIS' KEYWORDS      SS MAY85
         DC    X'34',X'20',X'00',X'00',CL8'FIRST'              SS MAY85
         DC    X'23',X'10',X'00',X'00',CL8'PREVIOUS'           SS MAY85
         DC    X'33',X'18',X'00',X'00',CL8'LAST'               SS MAY85
         DC    X'33',X'04',X'00',X'00',CL8'WORD'               SS MAY85
         DC    X'23',X'02',X'00',X'00',CL8'PREFIX'             SS MAY85
         DC    X'23',X'01',X'00',X'00',CL8'SUFFIX'             SS MAY85
         DC    X'22',X'00',X'00',X'10',CL8'ANY'               ABL APR86
         DC    X'21',X'00',X'00',X'01',CL8'DDNAME'             SS NOV85
         DC    X'22',X'00',X'08',X'00',CL8'DSNAME'            ABL APR86
         DC    X'22',X'00',X'40',X'00',CL8'VOLUME'             SS NOV85
         DC    X'22',X'00',X'20',X'00',CL8'MEMBER'             SS NOV85
         DC    X'21',X'00',X'10',X'00',CL8'ALLOC'              SS NOV85
         DC    X'21',X'00',X'10',X'00',CL8'ALOC'               SS NOV85
         DC    X'FF'                                           SS MAY85
         DS    0H                                              SS NOV85
ISPFDCK4 DC    X'0000',AL2(SPFADDNM-SPWRKC),AL2(SPFAFLAG+8-SPFADDNM)
         DC    X'0010',AL2(SPFADDNM-SPWRKC),AL2(SPFAFLAG+8-SPFADDNM)
*SPFDCK4 DC    X'0000',AL2(SPFADDNM-SPWRKC),H'07'              SS NOV85
         DC    X'0001',AL2(SPFADDNM-SPWRKC),H'07'              SS NOV85
         DC    X'0800',AL2(SPFADSN-SPWRKC),H'43'              ABL APR86
         DC    X'4000',AL2(SPFAVOL-SPWRKC),H'05'               SS NOV85
         DC    X'2000',AL2(SPFAMEM-SPWRKC),H'07'               SS NOV85
         DC    X'1000',AL2(SPFAALLC-SPWRKC),H'03'              SS NOV85
         DC    X'FFFF'              END OF TABLE               SS NOV85
         DS    0F                                              SS NOV85
ISPPARF5 DC    X'80',X'00',X'00',X'00',CL8' ' STRING           SS MAY85
         DC    X'51',X'40',X'00',X'00',F'1',F'08' NUMERIC      SS MAY85
         DC    X'51',X'00',X'80',X'00',F'2',F'08' NUMERIC2     SS NOV85
         DC    X'33',X'80',X'00',X'00',CL8'ASIS' KEYWORDS      SS MAY85
         DC    X'34',X'20',X'00',X'00',CL8'FIRST'              SS MAY85
         DC    X'23',X'10',X'00',X'00',CL8'PREVIOUS'           SS MAY85
         DC    X'33',X'18',X'00',X'00',CL8'LAST'               SS MAY85
         DC    X'33',X'04',X'00',X'00',CL8'WORD'               SS MAY85
         DC    X'23',X'02',X'00',X'00',CL8'PREFIX'             SS MAY85
         DC    X'23',X'01',X'00',X'00',CL8'SUFFIX'             SS MAY85
         DC    X'22',X'00',X'00',X'10',CL8'ANY'               ABL APR86
         DC    X'31',X'00',X'00',X'01',CL8'VOLUME'             SS NOV85
         DC    X'31',X'00',X'08',X'00',CL8'INDC'              ABL APR86
         DC    X'22',X'00',X'40',X'00',CL8'ADDRESS'            SS NOV85
         DC    X'FF'                                           SS MAY85
         DS    0H                                              SS NOV85
ISPFDCK5 DC    X'0000',AL2(SPFVVOL-SPWRKC),AL2(SPFVVSIZ+4-SPFVVOL)
         DC    X'0010',AL2(SPFVVOL-SPWRKC),AL2(SPFVVSIZ+4-SPFVVOL)
*SPFDCK5 DC    X'0000',AL2(SPFVVOL-SPWRKC),H'05'               SS NOV85
         DC    X'0001',AL2(SPFVVOL-SPWRKC),H'05'               SS NOV85
         DC    X'0800',AL2(SPFVINDC-SPWRKC),H'07'             ABL APR86
         DC    X'4000',AL2(SPFVADDR-SPWRKC),H'02'              SS NOV85
         DC    X'FFFF'              END OF TABLE               SS NOV85
         TITLE 'ISPF - FIND   LEVEL 1 SUBROUTINE'              SS NOV85
*  FIND STRING IN TABLE                                        SS MAY85
ISPFND   DS    0H                                              SS NOV85
         USING ISPFND,R4                                       SS MAY85
         BAL   R2,ISPQUERY                                     SS NOV85
         TM    SPFTBPF1,SPFTLOG    THIS LOG                    SS NOV85
         BZ    ISPFLG02                                        SS NOV85
         MVC   SPFTTOP,SPFSTART    SAVE START /TOP             SS MAY85
         MVC   SPFTSIZE,SPFLAST    SAVE BOTTOM/SIZE            SS NOV85
         MVC   SPFTCRP,SPFCRP      SAVE CURRENT                SS NOV85
ISPFLG02 DS    0H                                              SS MAY85
         TM    SPFTFF2,X'08'       REPET FIND                  SS NOV85
         BO    ISPFLG05                                        SS NOV85
         MVC   SPFTCCRP,SPFTCRP    INIT TO CURRENT             SS NOV85
         MVC   SPFTFTOP,SPFTTOP    INIT CURRENT PLACE          SS APR86
         TM    SPFTFF,X'10'        BACKWARD SEARCH             SS MAY85
         BO    ISPFLG60                                        SS MAY85
         CLC   SPFTFTOP,ISPL1      AT TOP                      SS MAY85
         BNE   ISPFLG10                                        SS MAY85
         OI    SPFTFF2,X'02'       FROM TOP                    SS MAY85
         B     ISPFLG10                                        SS MAY85
ISPFLG05 DS    0H                                              SS MAY85
         L     R2,SPFTFDS          STING ADDRESS               SS NOV85
         CLI   0(R2),0             ANY STRING                  SS NOV85
         BE    ISPFLGEM            CANNOT DO REPEAT FIND       SS MAY85
         TM    SPFTFF2,X'01'       HAVE STRING                 SS MAY85
         BZ    ISPFLGEM            NO, NO REPEAT FIND          SS MAY85
         TM    SPFTFF,X'10'        BACKWARD SEARCH             SS MAY85
         BO    ISPFLG50            START HERE                  SS MAY85
         CLC   SPFTFTOP,SPFTTOP    STILL SAME PLACE            SS MAY85
         BNE   ISPFLG07                                        SS MAY85
         MVI   SPFINPUT,C' '       SETUP BLANK LINE            SS MAY85
         MVC   SPFINPUT+1(79),SPFINPUT  RIPPLE                ABL APR86
         TM    SPFTFF,X'20'        FIRST KEY WORD              SS MAY85
         BO    ISPFLG15            NO, THEN USE CURRENT        SS MAY85
         L     R15,SPFTTOP         SET NEW PLACE               SS MAY85
         LA    R15,1(,R15)                                     SS MAY85
         C     R15,SPFTSIZE        BOTTOM                      SS MAY85
         BH    ISPFLGEN            RAN OFF BOTTOM              SS MAY85
         ST    R15,SPFTTOP                                     SS MAY85
         B     ISPFLG30                                        SS MAY85
ISPFLG07 DS    0H                                              SS MAY85
         MVC   SPFTFTOP,SPFTTOP    INIT CURRENT PLACE          SS APR86
         NI    SPFTFF,255-X'20'    RESET FIRST                 SS MAY85
ISPFLG10 DS    0H                  PROCESS FIND                SS MAY85
         MVI   SPFINPUT,C' '       SETUP BLANK LINE            SS MAY85
         MVC   SPFINPUT+1(79),SPFINPUT  RIPPLE                ABL APR86
         TM    SPFTFF,X'20'        FIRST KEY WORD              SS MAY85
         BZ    ISPFLG30            NO, THEN USE CURRENT        SS MAY85
ISPFLG15 DS    0H                  GO TO TOP                   SS MAY85
         NI    SPFTFF,255-X'20'    RESET FIRST                 SS MAY85
         OI    SPFTFF2,X'02'       FROM TOP                    SS MAY85
         BAL   R2,ISPTOP           START AT TOP                SS MAY85
         LA    R15,1                                           SS MAY85
         ST    R15,SPFTCRP         NOW AT TOP                  SS MAY85
         BAL   R2,ISPSKIP                                      SS MAY85
         LTR   R15,R15                                         SS MAY85
         BNZ   ISPFLGEN            RAN OFF BOTTOM              SS MAY85
         B     ISPFLG40                                        SS MAY85
ISPFLG30 DS    0H                                              SS MAY85
         L     R15,SPFTTOP         START SEARCH HERE           SS MAY85
         S     R15,SPFTCRP         RELATIVE POSITION           SS MAY85
         BAL   R2,ISPSKIP          POSITION SUBR               SS MAY85
         MVC   SPFTCRP,SPFTTOP     UPDATE                      SS NOV85
ISPFLG40 DS    0H                                              SS MAY85
         TM    SPFTFF,X'80'        ASIS                        SS MAY85
         BO    ISPFLG42            DO NOT FORCE UPPER CASE     SS MAY85
         L     R2,SPFTFST          STRING LOCATION             SS NOV85
         L     R15,SPFTFST         STARTING FIND LOCATION      SS NOV85
         LH    R14,SPFTFDL         LENGTH OF STRING            SS NOV85
         TM    SPFTFF,X'40'        POSITION NUMBER             SS NOV85
         BO    *+8                 YES, SKIP SEARCH LEN        SS NOV85
         AH    R14,SPFTFED         LENGTH OF SEARCH            SS NOV85
         EX    R14,ISPFLG41        EXEC OC                     SS NOV85
         B     ISPFLG42                                        SS NOV85
ISPFLG41 OC    0(0,R15),SPFINPUT   FORCE ALL UPPER CASE        SS NOV85
ISPFLG42 DS    0H                                              SS MAY85
         L     R15,SPFTFST         STARTING FIND LOCATION      SS NOV85
         TM    SPFTFF,X'40'        POSITION NUMBER             SS MAY85
         BO    ISPFLG47            DO COMPARE HERE             SS MAY85
ISPFLG45 DS    0H                                              SS MAY85
         LH    R14,SPFTFED         LENGTH OF SEARCH            SS NOV85
ISPFLG46 DS    0H                                              SS MAY85
         SR    R1,R1               FOR IC                      SS MAY85
         L     R2,SPFTFDS          COMPARE STRING ADDRESS      SS NOV85
         IC    R1,0(R2)            FIRST CHAR                  SS NOV85
         BAL   R2,ISPCLI           FIND MATCH                  SS MAY85
         LTR   R15,R15             ANY                         SS MAY85
         BZ    ISPFLG49                                        SS MAY85
ISPFLG47 DS    0H                                              SS MAY85
         LH    R1,SPFTFDL          LENGTH OF COMPARE STRING    SS NOV85
         L     R2,SPFTFDS          COMPARE STRING ADDRESS      SS NOV85
         EX    R1,ISPFLGCL                                     SS MAY85
         BE    ISPFLG80                                        SS MAY85
ISPFLG48 DS    0H                                              SS MAY85
         TM    SPFTFF,X'40'        POSITION NUMBER             SS MAY85
         BO    ISPFLG49            YES TRY NEXT LINE           SS MAY85
         LA    R15,1(,R15)         CONTINUE NEXT CHAR          SS MAY85
         BCT   R14,ISPFLG46        IF MORE CHAR                SS MAY85
ISPFLG49 DS    0H                                              SS MAY85
         LA    R15,1               SKIP ONE                    SS MAY85
         BAL   R2,ISPSKIP                                      SS MAY85
         LTR   R15,R15                                         SS MAY85
         BNZ   ISPFLGEN            RAN OFF BOTTOM              SS MAY85
         L     R15,SPFTCRP         KEEP                        SS MAY85
         LA    R15,1(,R15)              POINTER                SS MAY85
         ST    R15,SPFTCRP                      UP TO DATE     SS MAY85
         B     ISPFLG40                                        SS MAY85
ISPFLGEN DS    0H                                              SS MAY85
         MVC   SPFMSGID,ISPPDSM    INIT MESSAGE                SS MAY85
         MVI   SPFMSGID+7,C'F'                                 SS MAY85
         TM    SPFTFF2,X'02'       WE START AT TOP             SS MAY85
         BZ    ISPFLGE2                                        SS MAY85
         MVI   SPFTFF2,0           FORCE NEW FIND              SS MAY85
         MVI   SPFMSGID+6,C'1'                                 SS MAY85
         B     ISPFLGE4                                        SS MAY85
ISPFLGE2 DS    0H                                              SS MAY85
         MVI   SPFMSGID+6,C'2'                                 SS MAY85
         OI    SPFTFF,X'20'        FORCE FIRST NEXT TIME       SS MAY85
ISPFLGE4 DS    0H                                              SS MAY85
         MVI   SPFVZCMD,C' '       BLANK                       SS MAY85
         MVC   SPFVZCMD+1(249),SPFVZCMD                        SS MAY85
         LA    R15,8               NO COMMANDS FOUND           SS MAY85
         BR    R3                                              SS MAY85
ISPFLGCL CLC   0(0,R15),0(R2)      COMPARE TEXT                SS NOV85
*SPFLGCL CLC   0(0,R15),SPFFDSAV   COMPARE TEXT                SS MAY85
ISPFLG50 DS    0H                  REPEAT FIND PREV            SS MAY85
         MVI   SPFINPUT,C' '       SETUP BLANK LINE            SS MAY85
         MVC   SPFINPUT+1(79),SPFINPUT  RIPPLE                ABL APR86
         CLC   SPFTTOP,SPFTFTOP    STILL SAME PLACE            SS NOV85
         BNE   ISPFLG57                                        SS MAY85
         TM    SPFTFF,X'08'        LAST  KEY WORD              SS MAY85
         BO    ISPFLG65            YES, SET                    SS MAY85
         B     ISPFLG69                                        SS MAY85
ISPFLG57 DS    0H                                              SS MAY85
         MVC   SPFTFTOP,SPFTTOP    INIT CURRENT PLACE          SS APR86
         NI    SPFTFF,255-X'08'    RESET LAST                  SS MAY85
         B     ISPFLG69                                        SS MAY85
ISPFLG60 DS    0H                  PROCESS FIND PREV/LAST      SS MAY85
         TM    SPFTFF,X'20'        FIRST KEYWORD               SS MAY85
         BO    ISPFLGEC            CONFLICT WITH PREV/LAST     SS MAY85
         MVI   SPFINPUT,C' '       SETUP BLANK LINE            SS MAY85
         MVC   SPFINPUT+1(79),SPFINPUT  RIPPLE                ABL APR86
         TM    SPFTFF,X'08'        LAST  KEY WORD              SS MAY85
         BZ    ISPFLG69            NO, THEN USE CURRENT        SS MAY85
ISPFLG65 DS    0H                  GO TO TOP                   SS MAY85
         NI    SPFTFF,255-X'08'    RESET LAST                  SS MAY85
         OI    SPFTFF2,X'02'       FROM BOTTOM                 SS MAY85
         BAL   R2,ISPBOTM          START AT BOTTOM             SS MAY85
         LTR   R15,R15                                         SS MAY85
         BNZ   ISPFLGET            RAN OFF BOTTOM              SS MAY85
         L     R15,SPFTSIZE                                    SS MAY85
         ST    R15,SPFTCRP         NOW AT BOTTOM               SS MAY85
         B     ISPFLG70                                        SS MAY85
ISPFLG69 DS    0H                                              SS MAY85
         L     R15,SPFTTOP         START SEARCH HERE           SS MAY85
         S     R15,SPFTCRP         RELATIVE POSITION           SS MAY85
         BAL   R2,ISPSKIP          POSITION SUBR               SS MAY85
         MVC   SPFTCRP,SPFTTOP     UPDATE                      SS NOV85
         B     ISPFLG79            BACK UP ONE                 SS MAY85
ISPFLG70 DS    0H                                              SS MAY85
         L     R2,SPFTFST          STRING LOCATION             SS NOV85
         L     R15,SPFTFST         STARTING FIND LOCATION      SS NOV85
         TM    SPFTFF,X'80'        ASIS                        SS MAY85
         BO    ISPFLG72            DO NOT FORCE UPPER CASE     SS MAY85
         LH    R14,SPFTFDL         LENGTH OF STRING            SS NOV85
         TM    SPFTFF,X'40'        POSITION NUMBER             SS NOV85
         BO    *+8                 YES, SKIP SEARCH LEN        SS NOV85
         AH    R14,SPFTFED         LENGTH OF SEARCH            SS NOV85
         EX    R14,ISPFLG41        EXEC OC                     SS NOV85
ISPFLG72 DS    0H                                              SS MAY85
         L     R15,SPFTFST         STARTING FIND LOCATION      SS NOV85
         TM    SPFTFF,X'40'        POSITION NUMBER             SS MAY85
         BO    ISPFLG77            DO COMPARE HERE             SS MAY85
ISPFLG75 DS    0H                                              SS MAY85
         LH    R14,SPFTFED         LENGTH OF SEARCH            SS NOV85
         ALR   R15,R14             POSITION TO END OF STRING   SS MAY85
         BCTR  R15,0               ADJUST START POSITION       SS DEC85
ISPFLG76 DS    0H                                              SS MAY85
         SR    R1,R1               FOR IC                      SS MAY85
         L     R2,SPFTFDS          COMPARE STRING ADDRESS      SS NOV85
         IC    R1,0(R2)            FIRST CHAR                  SS NOV85
         BAL   R2,ISPCLIB          FIND MATCH                  SS MAY85
         LTR   R15,R15             ANY                         SS MAY85
         BZ    ISPFLG79                                        SS MAY85
ISPFLG77 DS    0H                                              SS MAY85
         LH    R1,SPFTFDL          LENGTH OF COMPARE STRING    SS NOV85
         L     R2,SPFTFDS          COMPARE STRING ADDRESS      SS NOV85
         EX    R1,ISPFLGCL                                     SS MAY85
         BE    ISPFLG80                                        SS MAY85
ISPFLG78 DS    0H                                              SS MAY85
         TM    SPFTFF,X'40'        POSITION NUMBER             SS MAY85
         BO    ISPFLG79            YES TRY NEXT LINE           SS MAY85
         BCTR  R15,0               CONTINUE NEXT CHAR          SS MAY85
         BCT   R14,ISPFLG76        IF MORE CHAR                SS MAY85
ISPFLG79 DS    0H                                              SS MAY85
         LA    R15,1               SKIP                        SS MAY85
         LNR   R15,R15                  -1                     SS MAY85
         BAL   R2,ISPSKIP                                      SS MAY85
         LTR   R15,R15                                         SS MAY85
         BNZ   ISPFLGET            RAN OFF TOP                 SS MAY85
         L     R15,SPFTCRP         KEEP                        SS NOV85
         BCTR  R15,0                    POINTER                SS MAY85
         ST    R15,SPFTCRP                      UP TO DATE     SS NOV85
         B     ISPFLG70                                        SS MAY85
ISPFLGET DS    0H                                              SS MAY85
         MVC   SPFMSGID,ISPPDSM    INIT MESSAGE                SS MAY85
         MVI   SPFMSGID+7,C'F'                                 SS MAY85
         TM    SPFTFF2,X'02'       WE START AT BOTTOM          SS MAY85
         BZ    ISPFLGE6                                        SS MAY85
         NI    SPFTFF2,255-X'03'   FORCE NEW FIND              SS MAY85
         MVI   SPFMSGID+6,C'1'                                 SS MAY85
         B     ISPFLGE8                                        SS MAY85
ISPFLGE6 DS    0H                                              SS MAY85
         MVI   SPFMSGID+6,C'3'                                 SS MAY85
         OI    SPFTFF,X'08'        FORCE LAST NEXT TIME        SS MAY85
ISPFLGE8 DS    0H                                              SS MAY85
*        BAL   R2,ISPBOTM          RESET RECORD POINTER        SS NOV85
         MVC   SPFTTOP,SPFTFTOP    RESET START                 SS NOV85
         MVI   SPFVZCMD,C' '       BLANK                       SS MAY85
         MVC   SPFVZCMD+1(249),SPFVZCMD                        SS MAY85
         LA    R15,8               NO COMMANDS FOUND           SS MAY85
         BR    R3                                              SS MAY85
ISPFLGEM DS    0H                                              SS MAY85
         MVC   SPFMSGID,ISPPDSM    INIT MESSAGE                SS MAY85
         MVI   SPFMSGID+7,C'A'                                 SS MAY85
         MVI   SPFMSGID+6,C'2'                                 SS MAY85
         LA    R15,8                                           SS MAY85
         BR    R3                                              SS MAY85
ISPFLGEC DS    0H                                              SS MAY85
         MVC   SPFMSGID,ISPPDSM    INIT MESSAGE                SS MAY85
         MVI   SPFMSGID+7,C'A'                                 SS MAY85
         MVI   SPFMSGID+6,C'7'                                 SS MAY85
         LA    R15,8                                           SS MAY85
         BR    R3                                              SS MAY85
ISPFLG80 DS    0H                                              SS MAY85
         TM    SPFTFF,X'07'   4+2+1 WORD, PREFIX, SUFFIX       SS MAY85
         BZ    ISPFLG89             NONE, THIS IS A MATCH      SS MAY85
         LR    R2,R15               BACK                       SS MAY85
         BCTR  R2,0                      UP ONE                SS MAY85
         CLI   0(R2),C'$'           NATIONAL CHAR              SS MAY85
         BE    ISPFLG82             YES                        SS MAY85
         CLI   0(R2),C'@'           NATIONAL CHAR              SS MAY85
         BE    ISPFLG82             YES                        SS MAY85
         CLI   0(R2),C'#'           NATIONAL CHAR              SS MAY85
         BE    ISPFLG82             YES                        SS MAY85
         CLI   0(R2),X'81'          LOWER CASE A               SS MAY85
         BNL   ISPFLG82             NORMAL CHAR                SS MAY85
*  MUST BE SPECIAL CHAR                                        SS MAY85
         TM    SPFTFF,X'06'         WORD OR PREFIX             SS MAY85
         BZ    ISPFLG88             SUFFIX,  NO MATCH          SS MAY85
         B     ISPFLG84             NEXT TEST                  SS MAY85
ISPFLG82 DS    0H                                              SS MAY85
         TM    SPFTFF,X'06'         WORD OR PREFIX             SS MAY85
         BNZ   ISPFLG88             NO MATCH                   SS MAY85
ISPFLG84 DS    0H                   NO MATCH                   SS MAY85
         LA    R2,1(,R15)           SKIP                       SS MAY85
         AH    R2,SPFTFDL                OVER STRING           SS MAY85
         CLI   0(R2),C'$'           NATIONAL CHAR              SS MAY85
         BE    ISPFLG85             YES                        SS MAY85
         CLI   0(R2),C'@'           NATIONAL CHAR              SS MAY85
         BE    ISPFLG85             YES                        SS MAY85
         CLI   0(R2),C'#'           NATIONAL CHAR              SS MAY85
         BE    ISPFLG85             YES                        SS MAY85
         CLI   0(R2),X'81'          LOWER CASE A               SS MAY85
         BNL   ISPFLG85             NORMAL CHAR                SS MAY85
*  MUST BE SPECIAL CHAR                                        SS MAY85
         TM    SPFTFF,X'05'         WORD OR SUFFIX             SS MAY85
         BZ    ISPFLG88             PREFIX,  NO MATCH          SS MAY85
         B     ISPFLG89             GOOD MATCH                 SS MAY85
ISPFLG85 DS    0H                                              SS MAY85
         TM    SPFTFF,X'05'         WORD OR SUFFIX             SS MAY85
         BZ    ISPFLG89             PREFIX, GOOD MATCH         SS MAY85
ISPFLG88 DS    0H                   NO MATCH                   SS MAY85
         TM    SPFTFF,X'10'         BACKWARD SEARCH            SS MAY85
         BO    ISPFLG78             CONTINUE HERE              SS MAY85
         B     ISPFLG48             ELSE CONTINUE HERE         SS MAY85
ISPFLG89 DS    0H                                              SS MAY85
         NI    SPFTFF2,255-X'02'   NO LONGER AT TOP/BOTTOM     SS MAY85
ISPFLG90 DS    0H                                              SS MAY85
         MVC   SPFTFTOP,SPFTCRP    SAVE FOUND LOCATION         SS NOV85
         MVC   SPFTTOP,SPFTCRP     DISPLAY FROM NEW LOCATION   SS NOV85
         TM    SPFTBPF1,SPFTLOG    THIS LOG                    SS NOV85
         BZ    ISPFLG92                                        SS NOV85
         MVC   SPFSTART,SPFTCRP    UPDATE START                SS NOV85
         MVC   SPFCRP,SPFTCRP      UPDATE                      SS NOV85
ISPFLG92 DS    0H                                              SS NOV85
         SR    R15,R15             GOOD COMMAND                SS MAY85
         BR    R3                                              SS MAY85
         SPACE 2                                              ABL JUN85
         TITLE 'ISPF - OUTPUT LV 1 SUBROUTINE'                 SS NOV85
***  RESET THE SUBLIST TO THE MEMBER TABLE                    ABL APR86
ISPSUB   DS    0H                                             ABL APR86
         USING *,R4                                           ABL APR86
         LA    R14,TBTOP                    TBTOP
         LA    R15,SPFTBL                   TABLE ADDRESS
         STM   R14,R15,PARMLIST
         OI    PARMLIST+4,X'80'
         LA    R1,PARMLIST
         L     R15,ISPLINK
         BALR  R14,R15
         SPACE 2
ISPSU010 LA    R14,TBSKIP                   TBSKIP
         LA    R15,SPFTBL                   TABLE ADDRESS
         STM   R14,R15,PARMLIST
         OI    PARMLIST+4,X'80'
         LA    R1,PARMLIST
         L     R15,ISPLINK
         BALR  R14,R15
         LTR   R15,R15                      END OF DATA?
         BNZ   ISPSU900                     NO, BRANCH
         SPACE 1
         TM    FLAGSEE,FMEMGRP            MEMBER GROUP DEFINE START?
         BO    ISPSU100                   YES, BRANCH
         SPACE 1
         OI    FLAGSEE,FMEMGRP            FIRST SUBLIST ELEMENT
         MVC   MMEMMAX(4),MMEMMIN         POINT TO THE FIRST ELEMENT
         XC    MMEMBERD(1+2+8+8+2),MMEMBERD  CLEAR THE MEMBER NAME
         MVC   MMEMBERD+1+2(8),MEMLNAME      MEMBER NAME
         MVC   DIRNAME(8),MEMLNAME           SAVE FOR LATER
         MVC   MMEMBERD+1+2+8+8+2(3),MEM2TTR TTR OF FIRST MEMBER
         LA    R1,MEMLNAME+7              END OF MEMBER NAME
         LA    R0,7                       MACHINE LENGTH
ISPSU050 CLI   0(R1),X'40'                BLANK?
         BNE   ISPSU060                   NO, BRANCH
         BCTR  R1,0                       PREVIOUS CHARACTER
         BCT   R0,ISPSU050                CHECK ALL BYTES
ISPSU060 STCM  R0,B'1100',MMEMBERD+1      SAVE THE MACHINE LENGTH
         MVI   MMEMBERD,FMEMBER1          A SINGLE MEMBER NAME
         NI    MMEMMIN,FF-X'80'           MEMBER LIST IS INACTIVE
         SPACE 1
         ICM   R1,B'0111',MMEMMIN+1       FIRST ELEMENT POINTER?
         BZ    ISPSU010                   NO, DONE
         MVI   0(R1),0                    YES, INACTIVE ELEMENT
         B     ISPSU010
         SPACE 2
ISPSU100 L     R1,MMEMMAX                 CURRENT END POINTER
         CLC   1(3,R1),=F'0'              ANY SLOT ENTRIES LEFT?
         BNE   ISPSU180                   YES, BRANCH
         LA    R0,36*28                   36 MEMBERS, 28 WIDE EACH
         ICM   R0,B'1000',=AL1(24)        ASSUME SPF IS INITIALIZED
         STCM  R0,B'1000',SUBLIST2        MARK FOR LATER RELEASE
         GETMAIN R,LV=(0)                 GET MORE ELEMENT STORAGE
         LR    R15,R1                     START OF TABLE
         L     R1,MMEMMAX                 CURRENT ELEMENT
         LA    R0,36-1                    NUMBER OF ELEMENTS -1
ISPSU136 LA    R15,28(,R15)               NEXT ELEMENT POINTER
         ST    R15,0(,R1)                 POINT TO THE NEXT ELEMENT
         LR    R1,R15                     NEXT ELEMENT
         BCT   R0,ISPSU136                DO 36 ELEMENTS
         XC    0(4,R1),0(R1)              CLEAR THE LAST POINTER
         SPACE 2
ISPSU180 LA    R1,MMEMMIN                 ANCHOR FOR MEMBER LIST
         CLC   MEMLNAME(8),MMEMBERD+1+2   ALREADY IN LIST?
         BE    ISPSU010                   YES, DO NOT ADD AGAIN
         SPACE 2
ISPSU190 L     R1,0(,R1)                  NEXT ELEMENT
         TM    0(R1),X'80'                ACTIVE ELEMENT?
         BNO   ISPSU200                   NO, NOT FOUND
         CLC   MEMLNAME(8),4+2(R1)        ALREADY IN LIST?
         BE    ISPSU010                   YES, DO NOT ADD AGAIN
         B     ISPSU190                   SEARCH THE ENTIRE LIST
         SPACE 2
ISPSU200 L     R1,MMEMMAX                 CURRENT ADDED ELEMENT
         L     R15,0(,R1)                 NEXT POINTER
         MVI   0(R15),0                   INACTIVE THE NEXT ELEMENT
         ST    R15,MMEMMAX                NEXT ELEMENT TO ADD
         OI    0(R1),X'80'                ACTIVE ELEMENT
         OI    MMEMMIN,X'80'              MEMBER LIST IS ACTIVE
         XC    4(2+8+8+2,R1),4(R1)        CLEAR THE MEMBER NAME
         MVC   4+2(8,R1),MEMLNAME         MEMBER NAME
         MVC   4+2+8+8+2(3,R1),MEM2TTR    ADD THIS TTR
         LA    R15,MEMLNAME+7             END OF MEMBER NAME
         LA    R0,7                       MACHINE LENGTH
ISPSU250 CLI   0(R15),X'40'               BLANK?
         BNE   ISPSU260                   NO, BRANCH
         BCTR  R15,0                      PREVIOUS CHARACTER
         BCT   R0,ISPSU250                CHECK ALL BYTES
ISPSU260 STC   R0,5(R1)                   SAVE THE MACHINE LENGTH
         MVI   4(R1),FMEMBER1             A SINGLE MEMBER NAME
         B     ISPSU010
         SPACE 3
ISPSU900 DS    0H
         NI    SPFLAG0,255-SPFCKER-SPFMSGER   RESET           ABL APR86
         MVC   PMEMCURR(4),PMEMMIN     RESET THE CURRENT POINTER
NEWCMD22 MVC   LMEMBER1(2+8+8+2),MMEMBERD+1  RESET THE MEMBER NAME
         NI    FLAGSAA,FF-FMEMBER1-FMEMBER2-FMEMRANG-FMEM#MEM
         OC    FLAGSAA(1),MMEMBERD     RESET THE MEMBER FLAG
         XC    MMEMMIN(12),PMEMMIN     INTERCHANGE
         XC    PMEMMIN(12),MMEMMIN                THE
         XC    MMEMMIN(12),PMEMMIN                   MEMBER LISTS
         MVC   MEMBERD(1+2+8+8+2),MMEMBERD    RESET THE DEFAULT NAME
         BAL   R14,DEFGROUP            ADD DEFAULT GROUP
         XI    FLAGSEE,FMEMGRP         MEMGRP USED NOW
         LA    R15,40                  RETURN TO ISPDISP6
         BR    R3
         DROP  R4                                             ABL APR86
         TITLE 'ISPF - OUTPUT LV 1 SUBROUTINE'
***  EXTRACT THE CURRENT ISPMODE/MEMLIST TABLE                ABL JUN85
ISPDISPT DS    0H                                             ABL JUN85
         USING *,R4
         MVC   SPFMSGID(8),ISPBLK8   TURN OFF MESSAGES
         MVC   SPFCURSR(8),ISPBLK8   TURN OFF CURSOR NAME
         NI    HFLAGSDD,FF-X'02'     NO OPEN YET
ISPD020  OI    ##ADRPA#,$A+$D        IGNORE ATTENTION NOW
         NI    HFLAGSDD,FF-X'01'     NO ATTRIBUTES
         LA    R14,ISPDISP           DISPLAY TABLE
         LA    R15,ISPDEXN           PANEL NAME
         LA    R0,0                  NO MSG
         CLC   SPFMSGID(4),ISPPDSM   ANY MSG
         BNE   ISPD030
         LA    R0,SPFMSGID
         CLC   SPFPANPR(8),0(R15)    SAME PANEL AS LAST TIME?
         BNE   ISPD030               NO, BRANCH
         SR    R15,R15               YES, NULLIFY PANEL NAME
ISPD030  MVC   SPFPANPR(8),ISPDEXN   SAVE LAST PANEL NAME
         LA    R1,SPFCURSR           DEFAULT CURSOR POSITIONING
         STM   R14,R1,PARMLIST
         OI    PARMLIST+12,X'80'
         LA    R1,PARMLIST
         L     R15,ISPLINK
         BALR  R14,R15
         MVC   SPFMSGID(8),ISPBLK8   TURN OFF MESSAGES
         MVC   SPFCURSR(8),ISPBLK8   TURN OFF CURSOR NAME
         LTR   R15,R15               PF3/PF4 HIT?
         BNZ   ISPD900               YES, BRANCH
         SPACE 2
         LA    R14,ISPDDSNL          SET OUT LOCATION
         LA    R15,44                SET LENGTH
         LA    R0,SPFDDSN            SET OUTPUT VARIABLE NAME
         BAL   R2,ISPDVCOP           COPY INTO STORAGE
         SPACE 1
         LA    R14,ISPDMEML          SET OUT LOCATION
         LA    R15,8                 SET LENGTH
         LA    R0,SPFDMEM            SET OUTPUT VARIABLE NAME
         BAL   R2,ISPDVCOP           COPY INTO STORAGE
         SPACE 1
         LA    R14,ISPDDESL          SET OUT LOCATION
         LA    R15,8                 SET LENGTH
         LA    R0,SPFDDEST           SET OUTPUT VARIABLE NAME
         BAL   R2,ISPDVCOP           COPY INTO STORAGE
         SPACE 1
         LA    R14,ISPDFORL          SET OUT LOCATION
         LA    R15,4                 SET LENGTH
         LA    R0,SPFDFORM           SET OUTPUT VARIABLE NAME
         BAL   R2,ISPDVCOP           COPY INTO STORAGE
         SPACE 1
         LA    R14,ISPDDISL          SET OUT LOCATION
         LA    R15,1                 SET LENGTH
         LA    R0,SPFDDISP           SET OUTPUT VARIABLE NAME
         BAL   R2,ISPDVCOP           COPY INTO STORAGE
         SPACE 1
         LA    R14,ISPDSYSL          SET OUT LOCATION
         LA    R15,1                 SET LENGTH
         LA    R0,SPFDSOUT           SET OUTPUT VARIABLE NAME
         BAL   R2,ISPDVCOP           COPY INTO STORAGE
         SPACE 3
         LA    R1,M99RBPTR              DYNAMIC ALLOCATION
         XC    M99RBPTR(40),M99RBPTR    CLEAR THE WORK AREA
         LA    R1,M99RBPTR              DYNAMIC ALLOCATION
         USING S99RBP,R1
         SPACE 1
         LA    R14,M99RB
         USING S99RB,R14
         ST    R14,S99RBPTR
         OI    S99RBPTR,S99RBPND        MARK END OF LIST
         SPACE 1
         LA    R15,M99TUPL
         USING S99TUPL,R15
         MVI   S99RBLN,20               LENGTH 20
         MVI   S99VERB,S99VRBAL         ALLOCATE
         ST    R15,S99TXTPP             POINT TO TEXT POINTERS
         LA    R2,WORKTBL                        START OF TEXT
         SPACE 1
         MVC   0(L'ISPDDDNA,R2),ISPDDDNA         SPECIFY DDNAME TEXT
         ST    R2,S99TUPTR                       POINT TO TEXT UNIT
         LA    R2,L'ISPDDDNA(,R2)                START OF NEXT TEXT
         SPACE 1
         LA    R15,4(,R15)                       NEXT POINTER ELEMENT
         MVC   0(L'ISPDDSOR,R2),ISPDDSOR         SPECIFY DSORG TEXT
         ST    R2,S99TUPTR                       POINT TO TEXT UNIT
         LA    R2,L'ISPDDSOR(,R2)                START OF NEXT TEXT
         SPACE 1
         LA    R15,4(,R15)                       NEXT POINTER ELEMENT
         MVC   0(L'ISPDFREE,R2),ISPDFREE         SPECIFY FREE TEXT
         ST    R2,S99TUPTR                       POINT TO TEXT UNIT
         LA    R2,L'ISPDFREE(,R2)                START OF NEXT TEXT
         SPACE 1
         MVC   SPFCURSR(8),ISPDSYSP              SYSOUT VARIABLE
         CLI   SPFDSOUT,X'40'                    DSNAME ALLOCATION?
         BH    ISPD080                           NO, BRANCH
         MVC   SPFCURSR(8),ISPDDSNP              DSNAME VARIABLE
         LA    R15,4(,R15)                       NEXT POINTER ELEMENT
         MVC   0(L'ISPDDSNA,R2),ISPDDSNA         SPECIFY DSNAME TEXT
         MVC   6(44,R2),SPFDDSN                  SPECIFY DSNAME
         ST    R2,S99TUPTR                       POINT TO TEXT UNIT
         LA    R2,L'ISPDDSNA+44(,R2)             START OF NEXT TEXT
         SPACE 1
         CLI   SPFDMEM,X'41'                     ANY MEMBER?
         BL    ISPD050                           NO, BRANCH
         LA    R15,4(,R15)                       NEXT POINTER ELEMENT
         MVC   0(L'ISPDMEMB,R2),ISPDMEMB         SPECIFY MEMBER TEXT
         MVC   6(8,R2),SPFDMEM                   SPECIFY MEMBER
         ST    R2,S99TUPTR                       POINT TO TEXT UNIT
         LA    R2,L'ISPDMEMB(,R2)                START OF NEXT TEXT
         SPACE 1
ISPD050  LA    R15,4(,R15)                       NEXT POINTER ELEMENT
         MVC   0(L'ISPDALLO,R2),ISPDALLO         SPECIFY DISP=OLD
         CLI   SPFDDISP,C'S'                     SHR?
         BNE   *+8                               NO, BRANCH
         MVI   6(R2),ISPDSHR                     SPECIFY DISPOSITION
         CLI   SPFDDISP,C'M'                     MOD?
         BNE   *+8                               NO, BRANCH
         MVI   6(R2),ISPDMOD                     SPECIFY DISPOSITION
         CLI   SPFDDISP,C'N'                     NEW?
         BNE   *+8                               NO, BRANCH
         MVI   6(R2),ISPDNEW                     SPECIFY DISPOSITION
         ST    R2,S99TUPTR                       POINT TO TEXT UNIT
         LA    R2,L'ISPDALLO(,R2)                START OF NEXT TEXT
         SPACE 1
         CLI   SPFDDISP,C'O'                     OLD?
         BE    ISPD070                           YES, BRANCH
         CLI   SPFDDISP,C'S'                     SHR?
         BE    ISPD070                           YES, BRANCH
         LA    R15,4(,R15)                       NEXT POINTER ELEMENT
         MVC   0(L'ISPDFIRS,R2),ISPDFIRS         SPECIFY PRIMARY
         ST    R2,S99TUPTR                       POINT TO TEXT UNIT
         LA    R2,L'ISPDFIRS(,R2)                START OF NEXT TEXT
         SPACE 1
         LA    R15,4(,R15)                       NEXT POINTER ELEMENT
         MVC   0(L'ISPDSECO,R2),ISPDSECO         SPECIFY SECONDARY
         ST    R2,S99TUPTR                       POINT TO TEXT UNIT
         LA    R2,L'ISPDSECO(,R2)                START OF NEXT TEXT
         SPACE 1
         LA    R15,4(,R15)                       NEXT POINTER ELEMENT
         MVC   0(L'ISPDTRK,R2),ISPDTRK           SPECIFY TRACK ALLOC
         ST    R2,S99TUPTR                       POINT TO TEXT UNIT
         LA    R2,L'ISPDTRK(,R2)                 START OF NEXT TEXT
         SPACE 1
         CLI   SPFDMEM,X'41'                     ANY MEMBER NAME?
         BL    ISPD070                           NO, BRANCH
         LA    R15,4(,R15)                       NEXT POINTER ELEMENT
         MVC   0(L'ISPDDIR,R2),ISPDDIR           SPECIFY DIRECTORY BLKS
         ST    R2,S99TUPTR                       POINT TO TEXT UNIT
         LA    R2,L'ISPDDIR(,R2)                 START OF NEXT TEXT
         SPACE 1
ISPD070  LA    R15,4(,R15)                       NEXT POINTER ELEMENT
         MVC   0(L'ISPDNORM,R2),ISPDNORM         SPECIFY DISP=(,CATLG)
         ST    R2,S99TUPTR                       POINT TO TEXT UNIT
         LA    R2,L'ISPDNORM(,R2)                START OF NEXT TEXT
         SPACE 1
         LA    R15,4(,R15)                       NEXT POINTER ELEMENT
         MVC   0(L'ISPDANOR,R2),ISPDANOR         SPECIFY DISP=(,,KEEP)
         ST    R2,S99TUPTR                       POINT TO TEXT UNIT
         B     ISPD110
         SPACE 1
ISPD080  CLI   SPFDFORM,X'41'                    ANY FORM?
         BL    ISPD090                           NO, BRANCH
         LA    R15,4(,R15)                       NEXT POINTER ELEMENT
         MVC   0(L'ISPDFORM,R2),ISPDFORM         SPECIFY FORMS TEXT
         MVC   6(4,R2),SPFDFORM                  SPECIFY FORM NAME
         ST    R2,S99TUPTR                       POINT TO TEXT UNIT
         LA    R2,L'ISPDFORM(,R2)                START OF NEXT TEXT
         SPACE 1
ISPD090  CLI   SPFDDEST,X'41'                    ANY DEST?
         BL    ISPD100                           NO, BRANCH
         LA    R15,4(,R15)                       NEXT POINTER ELEMENT
         MVC   0(L'ISPDDEST,R2),ISPDDEST         SPECIFY DEST TEXT
         MVC   6(8,R2),SPFDDEST                  SPECIFY DESTINATION
         ST    R2,S99TUPTR                       POINT TO TEXT UNIT
         LA    R2,L'ISPDDEST(,R2)                START OF NEXT TEXT
         SPACE 1
ISPD100  LA    R15,4(,R15)                       NEXT POINTER ELEMENT
         MVC   0(L'ISPDSYSO,R2),ISPDSYSO         SPECIFY SYSOUT TEXT
         MVC   6(1,R2),SPFDSOUT                  SPECIFY SYSOUT CLASS
         ST    R2,S99TUPTR                       POINT TO TEXT UNIT
         SPACE 1
ISPD110  OI    S99TUPTR,X'80'                    MARK END OF LIST
         DYNALLOC
         SPACE 2
         DROP  R1,R14,R15
         MVC   DDNAMEH,WORKTBL+6        SAVE DDNAME
         LTR   R15,R15                  SUCCESSFUL?
         BZ    ISPD120                  YES, BRANCH
         SPACE 2
         LA    R14,M99RB                POINTER TO SVC 99 BLOCK
         ST    R15,DAIRRC               RETURN CODE
         LA    R15,DAIRRC               POINTER TO RETURN CODE
         LA    R0,ADDRFF02              POINTER TO A(IKJEFF02)
         LA    R1,=AL2(DFSVC99)         POINTER TO INVOCATION TYPE
         L     R2,ADDRCPPL              POINTER TO THE CPPL
         STM   R14,R2,DFDAPLP           INITIALIZE DFDAPLP, DFDRCP,
*                                         DFJEFF02, DFIDP AND DFCPPLP
         SPACE 1
         LINK  EP=IKJEFF18,MF=(E,DFPARMS)
         MVC   SPFMSGID(8),ISPD701X     ERROR MESSAGE
         LTR   R15,R15                  PROBLEM WITH IKJEFF18?
         BNZ   ISPD020                  YES, BRANCH
         B     ISPD020
         SPACE 2
ISPD120  CLI   SPFDSOUT,X'40'           SYSOUT ALLOCATION?
         BH    ISPD180                  YES, BRANCH
         CLI   WORKTBL+14+6,DS1DSGPO    PARTITIONED?
         BNE   ISPD130                  NO, BRANCH
         CLI   SPFDMEM,X'41'            ANY MEMBER NAME?
         BL    ISPD170                  NO, ERROR
         B     ISPD180
         SPACE 1
ISPD130  CLI   WORKTBL+14+6,DS1DSGPS    SEQUENTIAL?
         BNE   ISPD170                  NO, ERROR
         CLI   SPFDMEM,X'41'            ANY MEMBER NAME?
         BL    ISPD180                  NO, ERROR
         SPACE 1
ISPD170  MVC   SPFMSGID(8),ISPD702X     ERROR MESSAGE
         B     ISPD020
         SPACE 2
*** OPEN THE SYSOUT/DATA SET
ISPD180  MVC   STOWDCB(ISPDDCBL),ISPDDCB     CONSTRUCT A DCB
         MVC   DCBDDNAM-IHADCB+STOWDCB(8),DDNAMEH
         MVI   OPENLIST,X'80'
         OPEN  (STOWDCB,(OUTPUT)),MF=(E,OPENLIST)
         TM    DCBOFLGS-IHADCB+STOWDCB,X'10' OPEN ALREADY
         BNO   ISPD190                       NO, ERROR
         OI    HFLAGSDD,X'02'                OPEN NOW
         TM    HFLAGSDD,X'01'                OPEN WITH GOOD VALUES?
         BO    ISPD200                       YES, BRANCH
         MVI   OPENLIST,X'80'
         CLOSE (STOWDCB),MF=(E,OPENLIST)
ISPD190  MVC   SPFMSGID(8),ISPD703X     ERROR MESSAGE
         B     ISPD020
         SPACE 2
*** OUTPUT THE DATA
ISPD200  LA    R14,TBTOP                    TBTOP
         LA    R15,SPFTBL                   TABLE ADDRESS
         STM   R14,R15,PARMLIST
         OI    PARMLIST+4,X'80'
         LA    R1,PARMLIST
         L     R15,ISPLINK
         BALR  R14,R15
         SPACE 2
         L     R0,RECOVER                   CURRENT RECOVERY ADDRESS
         STM   R14,R8,WORKTBL               SAVE ENTRY REGISTERS
         LA    R0,ISPD500                   LOCAL RECOVERY ADDRESS
         ST    R0,RECOVER
         OI    ##ADRPA#,$Q                  QUIET MODE IF ABEND
         SPACE 1
*  THIS IS CONTROLLED BY PANEL TABLE                           SS NOV85
         LH    R2,SPFTBPPI                  GET FORMAT INDEX   SS NOV85
         SLL   R2,2                         INDEX*4
         SPACE 1
         LA    R0,ISPDT0                    START OF TABLE TITLES
         LH    R1,SPFTBPTI                  INDEX TO THIS TITLE
         AR    R0,R1                        POINT TO THIS TITLE
         PUT   STOWDCB,(0)
         SPACE 1
         LA    R0,ISPDT0                    START OF TABLE TITLES
         LH    R1,SPFTBPTI                  INDEX TO THIS TITLE
         LA    R1,80(,R1)                   NEXT TITLE INDEX
         AR    R1,R0                        POINT TO THIS TITLE
         CLI   0(R1),X'40'                  ANY DATA IN COLUMN 1?
         BNE   ISPD300                      YES, BRANCH
         LR    R0,R1                        NO, SECOND TITLE LINE
         PUT   STOWDCB,(0)
         SPACE 2
ISPD300  LA    R14,TBSKIP                   TBSKIP
         LA    R15,SPFTBL                   TABLE ADDRESS
         STM   R14,R15,PARMLIST
         OI    PARMLIST+4,X'80'
         LA    R1,PARMLIST
         L     R15,ISPLINK
         BALR  R14,R15
         LTR   R15,R15                      END OF DATA?
         BNZ   ISPD600                      NO, BRANCH
         SPACE 2
         LA    R1,WORKTBL+80                OUTPUT DATA LINE
         MVI   0(R1),X'40'
         MVC   1(79,R1),0(R1)
         SPACE 1
         B     *(R2)                        PERFORM THE FORMATING RTN
         B     ISPD310                      PANEL=1
         B     ISPD310                      PANEL=2
         B     ISPD310                      PANEL=3
         B     ISPD310                      PANEL=4
         B     ISPD350                      PANEL=5
         B     ISPD360                      PANEL=6
         B     ISPD370                      PANEL=7
         B     ISPD380                      PANEL=8
         B     ISPD310                      PANEL=9
         B     ISPD310                      PANEL=A
         B     ISPD310                      PANEL=B
         B     ISPD310                      PANEL=C
         B     ISPD3D0                      PANEL=D
         B     ISPD310                      PANEL=E
         B     ISPD3F0                      PANEL=F
         B     ISPD3G0                      PANEL=G
         B     ISPD3H0                      PANEL=H
         B     ISPD3I0                      PANEL=I
         SPACE 2
ISPD310  MVC   0(80,R1),SPFLINE             ADD TABLE DATA
         CLI   0(R1),X'39'                  NULL FIRST BYTE?
         BH    ISPD400                      NO, BRANCH
         MVI   0(R1),X'40'                  YES, RESET TO BLANK
         B     ISPD400
         SPACE 2
ISPD350  OC    0(4,R1),MEM2OPT              PANEL=5
         OC    4+1(8,R1),MEMLNAME
         OC    13+1(8,R1),MEMLDATA
         OC    23+1(6,R1),MEM2VMOD
         OC    31+2(8,R1),MEM2CDAT
         OC    41+2(8,R1),MEM2MDAT
         OC    51+1(8,R1),MEM2MTIM
         OC    57+1(8,R1),MEM2CSIZ
         OC    63+1(8,R1),MEM2ISIZ
         OC    71+1(8,R1),MEM2MID
         B     ISPD400
         SPACE 2
ISPD360  OC    0(4,R1),MEM2OPT              PANEL=6
         OC    4+1(8,R1),MEMLNAME
         OC    13+1(8,R1),MEMLDATA
         OC    22+1(8,R1),MEM2ALIS
         OC    31+2(8,R1),MEM2TTR
         OC    41+2(5,R1),MEM2VMOD
         OC    50+1(8,R1),MEM2MDAT
         OC    59+1(5,R1),MEM2MTIM
         OC    65+1(5,R1),MEM2CSIZ
         OC    71+1(7,R1),MEM2MID
         B     ISPD400
         SPACE 2
ISPD370  OC    0(4,R1),MEM2OPT              PANEL=7
         OC    4+1(8,R1),MEMLNAME
         OC    13+1(8,R1),MEMLDATA
         OC    22+1(8,R1),MEM2ALIS
         OC    31+1(8,R1),MEM2LDAT
         OC    40+1(4,R1),MEM2ATT1
         OC    45+1(4,R1),MEM2ATT2
         OC    50+1(4,R1),MEM2DC
         OC    55+1(4,R1),MEM2TEST
         OC    60+1(4,R1),MEM2APF
         OC    65+1(4,R1),MEM2MODE
         OC    70+1(8,R1),MEM2MNAM
         B     ISPD400
         SPACE 2
ISPD380  OC    0(4,R1),MEM2OPT              PANEL=8
         OC    4+1(8,R1),MEMLNAME
         OC    13+1(8,R1),MEMLDATA
         OC    22+1(8,R1),MEM2ALIS
         OC    30+2(6,R1),MEM2TTR
         OC    37+2(8,R1),MEM2MNAM
         OC    47+1(8,R1),MEM2MTTR
         OC    56+1(6,R1),MEM2LENG
         OC    63+1(6,R1),MEM2ENTY
         OC    70+1(8,R1),MEM2SSI
         B     ISPD400
         SPACE 2
ISPD3D0  OC    0(4,R1),MEM2OPT              PANEL=D
         OC    4+1(8,R1),MEMLNAME
         OC    13+1(8,R1),MEMLDATA
         OC    22+1(8,R1),MEM2ALIS
         OC    31+1(8,R1),MEM2LDAT
         OC    40+1(4,R1),MEM2ATT1
         OC    45+1(4,R1),MEM2ATT2
         OC    50+1(4,R1),MEM2DC
         OC    55+1(4,R1),MEM2TEST
         OC    60+1(4,R1),MEM2APF
         OC    65+1(4,R1),MEM2MODE
         OC    70+1(8,R1),MEM2MNAM
         LR    R0,R1
         PUT   STOWDCB,(0)
         LA    R1,WORKTBL+80
         MVI   0(R1),X'40'
         MVC   1(79,R1),0(R1)
         OC    31+1(6,R1),MEM2LENG
         OC    40+1(6,R1),MEM2TTR
         OC    50+1(6,R1),MEM2ENTY
         OC    60+1(8,R1),MEM2SSI
         LR    R0,R1
         PUT   STOWDCB,(0)
         LA    R1,WORKTBL+80
         MVI   0(R1),X'40'
         MVC   1(79,R1),0(R1)
         B     ISPD400
         SPACE 2
ISPD3F0  OC    0(4,R1),SPFAOPT              PANEL=F
         OC    04+1(8,R1),SPFADDNM
         OC    13+1(8,R1),SPFADATA
         OC    22+1(4,R1),SPFATYPE
         OC    27+1(1,R1),SPFAOCNT
         OC    30+1(6,R1),SPFAVOL
         OC    37+1(8,R1),SPFAMEM
         OC    46+1(32,R1),SPFADSN
         B     ISPD400
         SPACE 2
ISPD3G0  OC    0(4,R1),SPFAOPT              PANEL=G
         OC    04+1(8,R1),SPFADDNM
         OC    13+1(8,R1),SPFADATA
         OC    22+1(4,R1),SPFATYPE
         OC    27+1(1,R1),SPFAOCNT
         OC    30+1(4,R1),SPFASTAT
         OC    35+1(44,R1),SPFADSN
         LR    R0,R1
         PUT   STOWDCB,(0)
         LA    R1,WORKTBL+80
         MVI   0(R1),X'40'
         MVC   1(79,R1),0(R1)
         OC    22+1(6,R1),SPFAVOL
         OC    30+1(8,R1),SPFAMEM
         OC    42+1(4,R1),SPFAALLC
         OC    47+1(4,R1),SPFADISP
         OC    52+1(4,R1),SPFAADSP
         LR    R0,R1
         PUT   STOWDCB,(0)
         LA    R1,WORKTBL+80
         MVI   0(R1),X'40'
         MVC   1(79,R1),0(R1)
         B     ISPD400
         SPACE 2
ISPD3H0  OC    0(4,R1),SPFVOPT              PANEL=H
         OC    04+1(6,R1),SPFVVOL
         OC    11+1(8,R1),SPFVDATA
         OC    20+1(3,R1),SPFVADDR
         OC    24+1(6,R1),SPFVTYPE
         OC    31+1(4,R1),SPFVATTR
         OC    36+1(4,R1),SPFVCNT
         OC    40+1(4,R1),SPFVTCYL
         OC    45+1(4,R1),SPFVTTRK
         OC    50+1(4,R1),SPFVXNUM
         OC    55+1(4,R1),SPFVDSCB
         OC    60+1(4,R1),SPFVLCYL
         OC    65+1(4,R1),SPFVLTRK
         OC    70+1(8,R1),SPFVINDC
         B     ISPD400
         SPACE 2
ISPD3I0  OC    0(4,R1),SPFVOPT              PANEL=I
         OC    04+1(6,R1),SPFVVOL
         OC    11+1(8,R1),SPFVDATA
         OC    20+1(3,R1),SPFVADDR
         OC    24+1(6,R1),SPFVTYPE
         OC    31+1(4,R1),SPFVATTR
         OC    36+1(4,R1),SPFVSTAT
         OC    41+1(8,R1),SPFVINDC
         OC    50+1(3,R1),SPFVCNT
         OC    54+1(8,R1),SPFVVTOC
         OC    63+1(4,R1),SPFVVSIZ
         OC    68+1(4,R1),SPFVDSCB
         B     ISPD400
         SPACE 2
ISPD400  LR    R0,R1
         PUT   STOWDCB,(0)
         B     ISPD300
         SPACE 1
ISPD500  LM    R14,R8,WORKTBL               RESET ENTRY REGISTERS
         ST    R0,RECOVER                   RESET THE RECOVERY ADDRESS
         NI    ##ADRPA#,FF-$Q               RESET QUIET MODE
         MVC   SPFMSGID(8),ISPD704X         ERROR MESSAGE
         MVI   OPENLIST,X'80'
         TM    DCBOFLGS-IHADCB+STOWDCB,X'10' STILL OPEN?
         BNO   ISPD020                       NO, BRANCH
         CLOSE (STOWDCB),MF=(E,OPENLIST)
         B     ISPD020
         SPACE 2
*** CLOSE THE SYSOUT/DSNAME DATA SET
ISPD600  MVI   OPENLIST,X'80'
         CLOSE (STOWDCB),MF=(E,OPENLIST)
         LM    R14,R1,WORKTBL               RELOAD CHANGED REGISTERS
         ST    R0,RECOVER                   RESET THE RECOVERY ADDRESS
         MVC   SPFMSGID(8),ISPD705X         COMPLETED MESSAGE
         SPACE 1
ISPD900  NI    ##ADRPA#,FF-$Q-$A-$D         RESET QUIET MODE/ATTN
         LA    R15,40                       RETURN TO ISPDISP6 SS NOV85
         TM    HFLAGSDD,X'02'               ANY OPEN?
         BNOR  R3                           NO, RETURN
         BR    R3                           WILL NOT RESTART   SS JUL85
         SPACE 1
         MVI   VOLALLOC,X'40'       NEED TO REREAD THE DSCB   ABL OCT85
         BAL   R2,CLOSEIT           CLOSE THE INPUT DCB'S     ABL OCT85
         B     RESTART2                                       ABL OCT85
         SPACE 3
         USING IHADCB,R1
*** DCB OPEN EXIT
ISPD980  SR    R15,R15
         CH    R15,DCBDSORG                  ANY DSORG?
         BNE   *+8                           YES, BRANCH
         OI    DCBDSORG,DS1DSGPS             NO, USE DSORG=PS
         TM    DCBDSORG,DS1DSGPS             DSORG=PS?
         BNOR  R14                           NO, ERROR
         CLI   DCBRECFM,0                    ANY RECFM?
         BNE   *+8                           YES, BRANCH
         MVI   DCBRECFM,DCBRECF+DCBRECBR     NO, USE RECFM=FB
         TM    DCBRECFM,DCBRECF+DCBRECV      RECFM=F. OR RECFM=V.?
         BNMR  R14                           NO, ERROR
         LA    R0,80                         DEFAULT LRECL
         TM    DCBRECFM,DCBRECV              RECFM=V.?
         BOR   R14                           YES, ERROR
         CH    R15,DCBLRECL                  ANY LRECL?
         BNE   *+8                           YES, BRANCH
         STH   R0,DCBLRECL                   NO, USE LRECL=80
         CH    R0,DCBLRECL                   LRECL=80?
         BNER  R14                           NO, ERROR
         LA    R0,3120                       DEFAULT BLKSIZE
         CH    R15,DCBBLKSI                  ANY BLKSIZE?
         BNE   *+8                           YES, BRANCH
         STH   R0,DCBBLKSI                   NO, USE BLKSIZE=3120
         OI    HFLAGSDD,X'01'                ALL ATTRIBUTES ARE CORRECT
         BR    R14
         DROP  R1
         SPACE 2
ISPDVCOP LA    R1,VCOPY              COPY VARIABLE VALUES
         ST    R1,PARMLIST
*        LA    R14,XXXXXX            GET FIRST VARIABLE
*        L     R15,YYYYYY            SET LENGTH
         ST    R15,SPFFIXED
         LA    R15,SPFFIXED
*        LA    R0,ZZZZZZ             SET OUTPUT VARIABLE NAME
         LA    R1,ISPMOVE
         STM   R14,R1,PARMLIST+4
         OI    PARMLIST+16,X'80'
         LA    R1,PARMLIST
         L     R15,ISPLINK
         BALR  R14,R15
         C     R15,ISPL8                                       SS NOV85
         BH    ISPERR                                          SS NOV85
         BR    R2
         SPACE 2
         LTORG  ,                                              SS NOV85
         SPACE 2                                               SS NOV85
         PRINT NOGEN
ISPDDCB  DCB   DSORG=PS,DDNAME=PDSLOG,MACRF=(PM),EXLST=ISPDXIT
ISPDDCBL EQU   *-ISPDDCB
         PRINT GEN
         SPACE 2
ISPDXIT  DC    0F'0',X'85',AL3(ISPD980)      OPEN EXIT ONLY
ISPDDSNL DC    C'EXTRDSN '
ISPDMEML DC    C'MEMBER '
ISPDDESL DC    C'DEST '
ISPDFORL DC    C'FORM '
ISPDDISL DC    C'DISP '
ISPDSYSL DC    C'SYSOUT '
ISPDSYSP DC    C'PDSPCLAS'
ISPDDSNP DC    C'PDSPXDSN'
ISPDCMD  DC    C'CMD  '
ISPDTEXT DC    CL8'LOGCOPY'
ISPDDDNA DC    X'0055000100084040404040404040'     RETURN DDNAME
ISPDDSOR DC    X'0057000100024040'                 RETURN DSORG
ISPDFREE DC    X'001C0000'                         FREE=CLOSE
ISPDMEMB DC    X'0003000100084040404040404040'     DSNAME
ISPDDSNA DC    X'00020001002C'                     DSNAME
ISPDALLO DC    X'00040001000101'                   DISP=(_)
ISPDNORM DC    X'00050001000102'                   DISP=(,CATLG)
ISPDANOR DC    X'00060001000108'                   DISP=(,,KEEP)
ISPDTRK  DC    X'00070000'                         SPACE=(TRK,
ISPDFIRS DC    X'000A00010003000001'               SPACE=(,1
ISPDSECO DC    X'000B00010003000004'               SPACE=(,,4
ISPDDIR  DC    X'000C00010003000005'               SPACE=(,,,5)
ISPDOLD  EQU   X'01'
ISPDMOD  EQU   X'02'
ISPDNEW  EQU   X'04'
ISPDSHR  EQU   X'08'
ISPDSYSO DC    X'001800010001C1'                   SYSOUT=A
ISPDFORM DC    X'001A00010004C4F1F0F1'             SYSOUT=(,,D101)
ISPDDEST DC    X'005800010008D5F1F3F040404040'     DEST=R130
ISPDEXN  DC    CL8'&P.VEXT '                       PANEL NAME  SS NOV85
ISPD701X DC    CL8'PDS&M.1X'                       ERROR NAME
ISPD702X DC    CL8'PDS&M.2X'                       ERROR NAME
ISPD703X DC    CL8'PDS&M.3X'                       ERROR NAME
ISPD704X DC    CL8'PDS&M.4X'                       ERROR NAME
ISPD705X DC    CL8'PDS&M.5X'                       DONE MESSAGE
ISPDT0   DS    0H   TITLES FOR TABLE OUTPUT FOLLOW:
ISPDT1   DC    CL80'ISPMODE TABLE FOLLOWS:'
ISPDT5   DC    CL80'CMD  NAME     DATA     VER.MOD    CREATED   LAST MOX
               DIFIED  SIZE  INIT    ID'
ISPDT6   DC    CL80'CMD  NAME     DATA     ALIASOF   TTR      VER.MOD  X
                LAST MODIFIED  SIZE  ID'
ISPDT7   DC    CL80'CMD  NAME     DATA     ALIASOF  LEN/LKED --  ATTRIBX
               UTES   -- APF  MODE  MAIN'
ISPDT8   DC    CL80'CMD  NAME     DATA     ALIASOF   TTR     MAIN    MAX
               TCH   LENGTH  ENTRY   SSI'
ISPDTD   DC    CL80'CMD  NAME     DATA     ALIASOF  LEN/LKED --  ATTRIBX
               UTES   -- APF  MODE  MAIN'
         DC    CL80'                       MATCH    LENGTH   TTR       X
               ENTRY     SSI'
ISPDTF   DC    CL80'CMD  DDNAME   DATA     TYPE O# VOLUME  MEMBER   ---X
               --- DATA SET NAME ----------'
ISPDTG   DC    CL80'CMD  DDNAME   DATA     TYPE O# STAT ------DATA SET X
               NAME ----------------------'
         DC    CL80'                       VOLUME  -MEMBER-    ---- DISX
               P ----'
ISPDTH   DC    CL80'CMD  VOLUME   DATA   DEV DEV   MOUNT USE ---- TOTALX
                FREE ---  LARGEST   STATUS'
         DC    CL80'      NAME  -------- ADR TYPE   ATTR CNT CYLS TRKS X
                NUM DSCB CYLS TRKS --INDC--'
ISPDTI   DC    CL80'CMD  VOLUME   DATA   DEV DEV    ------MOUNT------- X
               USE -----VTOC---- FREE'
         DC    CL80'      NAME  -------- ADR TYPE   ATTR STAT --INDC-- X
               CNT --CCHH-- SIZE DSCB'
         DROP  R4                                              SS MAR85
         SPACE 1
         TITLE 'ISPF - MEMLIST  FUNCTION'                      SS NOV85
*****************************************************          SS NOV85
*                                                              SS NOV85
*        MEMLLIST SUPPORT FUCNTION                             SS NOV85
*                                                              SS NOV85
*****************************************************          SS NOV85
         SPACE 1
MEMLFUNC DS    0H                                              SS NOV85
         USING *,R4                                            SS NOV85
* AT THIS POINT ALTERNATE MEMBER PROCESSING CAN BE INSERTED    SS NOV85
         TM    SPFLAG0,SPFMEMV    VDEFINES FOR MEMLIST OK      SS SEP84
         BO    ISPMEMOK                                        SS SEP84
         LA    R14,VDEFINE         START VDEFINES              SS JUL84
         ST    R14,PARMLIST                                    SS JUL84
         LA    R14,MEMLTKEY        MEMBER NAME IS KEY          SS JUL84
         LA    R15,MEMLNAME                                    SS JUL84
         LA    R0,ISPCHAR                                      SS JUL84
         LA    R1,ISPL8                                        SS JUL84
         STM   R14,R1,PARMLIST+4                               SS JUL84
         OI    PARMLIST+16,X'80'                               SS JUL84
         LA    R1,PARMLIST                                     SS JUL84
         L     R15,ISPLINK                                     SS JUL84
         BALR  R14,R15                                         SS JUL84
         LTR   R15,R15                                         SS JUL84
         BNZ   ISPERR                                          SS JUL84
         LA    R14,MEMTNAML       VAR NAME LIST                SS JUL84
         LA    R15,MEMTNAMA       TABLE ARRAY                  SS JUL84
         LA    R0,ISPCHAR                                      SS JUL84
         LA    R1,ISPL8                                        SS JUL84
         STM   R14,R1,PARMLIST+4                               SS JUL84
         OI    PARMLIST+16,X'80'                               SS JUL84
         LA    R1,PARMLIST                                     SS JUL84
         L     R15,ISPLINK                                     SS JUL84
         BALR  R14,R15                                         SS JUL84
         LTR   R15,R15                                         SS JUL84
         BNZ   ISPERR                                          SS JUL84
         OI    SPFLAG0,SPFMEMV    VDEFINES IS DONE             SS SEP84
ISPMEMOK DS    0H                                              SS SEP84
         LA    R1,0               POP PANEL 3 CKT              SS NOV85
         BAL   R2,ISPSTKI         USTACK ROUTINE               SS NOV85
         TM    SPFLAG3,SPFCHN     HAS CHANGE DSN BEEN DONE    ABL OCT84
         BZ    ISPMEMK1           NO, SKIP                    ABL OCT84
         NI    SPFLAG3,255-SPFCHN-SPF300A CLEAR               ABL OCT84
         BAL   R2,ISPUSTKM        UNSTACK AND KILL OLD TABLE   SS NOV85
ISPMEMK1 DS    0H                                             ABL OCT84
         LA    R1,5               ASSUME SOURCE PANEL          SS NOV85
         TM    FLAGSCC,RECFMU     LOAD LIB                     SS NOV85
         BZ    ISPMEMK4           NO                           SS NOV85
         LA    R1,7               LOAD LIB PANEL INDEX         SS NOV85
ISPMEMK4 CH    R1,SPFTBPI         SAME PANEL                   SS NOV85
         BE    ISPMEMK5           YES, SKIP STACK              SS NOV85
         BAL   R2,ISPSTKI         STACK NEW PANEL              SS NOV85
ISPMEMK5 DS    0H                                              SS NOV85
         TM    SPFLAG0,SPFMEMT    IS MEMLIST TABLE CREATED     SS SEP84
         BO    ISPMEMK2                                        SS SEP84
         BAL   R2,ISPCRMEM        CREATE MEMLIST TABLE         SS NOV85
ISPMEMK2 DS    0H                                              SS SEP84
         BAL   R2,MEMLISTI        GET MEMLIST SUB              SS NOV85
         TM    SPFLAG2,SPFMEMA    FIRST TIME                   SS SEP84
         BO    ISPMEMK3           NO                           SS SEP84
         OI    SPFLAG2,SPFSEQ                                  SS SEP84
         B     ISPMEML4                                        SS SEP84
ISPMEMK3 TM    SPFLAG2,SPFSEQ     FIRST TIME SEQ ADD           SS SEP84
         BO    ISPMEML4           YES                          SS SEP84
         BAL   R2,ISPGET          FIND ENTRY TO REPLACE        SS SEP84
         LTR   R15,R15            WE FIND IT                   SS SEP84
         BZ    ISPMEML2           YES                          SS SEP84
         MVC   MEMLNMSV,MEMLNAME  NO, MUST INSERT              SS SEP84
         BAL   R2,ISPLOCI                                      SS NOV85
         LTR   R15,R15            FIND EXACT MATCH             SS SEP84
         BZ    ISPMEML2           YES ????                     SS SEP84
         MVC   MEMLNAME,MEMLNMSV  GET ORIGINAL NAME            SS SEP84
ISPMEML4 DS    0H                 ADD NEW ENTRY HERE           SS SEP84
         MVC   MEMLDATA,ISPBLK8                                SS SEP84
         MVC   MEM2NAMA(MEMLVLEN),MEM1NAMA                     SS SEP84
         BAL   R2,ISPMEMAD                                     SS SEP84
         BR    R3                 RETURN                       SS SEP84
ISPMEML2 DS    0H                                              SS SEP84
         TM    SPFLAG2,SPFUPDA    REFRESH ENTRIES              SS SEP84
         BO    ISPMEML3           YES                          SS SEP84
         MVC   MEMLDATA,ISPBLK8   NO, CLEAR MSGS               SS SEP84
ISPMEML3 DS    0H                                              SS SEP84
         MVC   MEM2NAMA(MEMLVLEN),MEM1NAMA                     SS SEP84
         BAL   R2,ISPMEMOD                                     SS SEP84
         BR    R3                  RETURN                      SS SEP84
         DROP  R4                                              SS NOV85
         SPACE 5                                               SS NOV85
         TITLE 'ISPF - MEMLIST LV 1 SUBROUTINE'                SS NOV85
*                                                              SS NOV85
*                                                              SS NOV85
*                                                              SS NOV85
       SPACE 3
*************************************************************  SS SEP84
*                                                              SS SEP84
*        ADDED SUPPORT OF DIALOG MEMLIST MODE USING            SS SEP84
*        A DIALOG TABLE TO DISPLAY PDS MEMBER LIST             SS SEP84
*                                                              SS SEP84
*************************************************************  SS SEP84
*
*      MEMLNAME     MEMBER NAME (*MUST* BE ONLY 'KEY' VARIABLE IN TBL)
*      MEMLACT      USER'S ACTION REQUEST
*      MEMLALIS     MAIN NAME IF ALIAS
*      MEMLTTR      MEMBER TTR (REQUIRED TO DETERMINE ALIAS MAIN NAME)
*   THE FOLLOWING ARE UPDATED FOR SPF FILES                    SS MAY84
*      MEMLVMOD     SPF STATS VERSION MOD
*      MEMLCDAT     SPF STATS CREATION DATE
*      MEMLMDAT     SPF STATS LAST MOD DATE
*      MEMLMTIM     SPF STATS LAST MOD TIME
*      MEMLMID      SPF STATS LAST MOD ID
*      MEMLISIZ     SPF STATS INITIAL SIZE                     SS NOV84
*      MEMLCSIZ     SPF STATS CURRENT SIZE
*                                                              SS NOV84
*   THE FOLLOWING ARE UPDATED FOR LOAD LIBRARIES
*      MEMLMNAM     ALIAS MAIN NAME
*      MEMLXATT     LOAD ATTRIBUTE BYTES IN HEX
*      MEMLLENG     LOAD PROGRAM LENGTH      (PRINTABLE)
*      MEMLENTY     LOAD PROGRAM ENTRY POINT (PRINTABLE)
*      MEMLATT1     LOAD ATTRIBUTE - FIRST
*      MEMLATT2     LOAD ATTRIBUTE - SECONDARY
*      MEMLDC       LOAD ATTRIBUTE OF DC
*      MEMLTEST     LOAD ATTRIBUTE OF TEST
*      MEMLAPF      LOAD APF ATTRIBUTE
*      MEMLMODE     LOAD AMODE/RMODE ATTRIBUTE
*      MEMLSSI      SSI INFORMATION                            SS NOV84
*      MEMLLDAT     LINKAGE EDIT DATE IN YY/MM/DD FORMAT      ABL OCT85
*
***********************************************************************
         SPACE 2
MEMLIST  DS    0H                                              SS SEP84
         USING *,R4                                            SS JUL44
         MVI   MEM1NAMA,C' '       BLANK                       SS SEP84
         MVC   MEM1NAMA+1(MEMLVLEN-1),MEM1NAMA  RIPPLE         SS SEP84
         SPACE 1
*        CLEAR VARS HERE
         MVC   MEMLNAME,DIRNAME    MEMBER NAME FROM DIR TO VAR
         UNPK  MEMLWK(7),DIRTTR(4) UNPACK HEX
         TR    MEMLWK(6),TRHEX     TRANSLATE TO HEX
         MVC   MEMLTTR(6),MEMLWK
         MVI   MEMLXATT,C'S'       ASSUME SOURCE
         MVC   MEMLXATT+2(4),DIRTTR SAVE TTR                   SS NOV84
         TM    DIRFLAG,DIRALIAS    IS THIS AN ALIAS NAME
         BNO   MMLSTATS            NO: ALIAS LOGIC
         MVC   MEMLALIS,MMLALI          NAME AS AN ALIAS
* DETERMINE IF WE HAVE SPF STATISTICS
MMLSTATS DS    0H                                              SS NOV84
         LA    R0,DIRCUDHW         CLEAR IC REG
         LA    R15,0               CLEAR IC REG
         IC    R15,DIRFLAG         FETCH COUNT FIELD MASK
         NR    R15,R0              ZERO OUT NON-COUNT BITS
         SLL   R15,1               TIMES 2                     SS SEP84
         TM    FLAGSCC,RECFMU      LOAD MODULE LIBRARY?        SS NOV84
         BO    MEMLLOAD            YES, BRANCH                 SS NOV84
         STC   R15,MEMLMNAM        SAVE LENGTH                 SS SEP84
*        MVC   MEMLMNAM+1(0),DIRUSER  SAVE DIR                 SS NOV85
*        EX    R15,*-6                                         SS NOV85
         CLC   MEMLALIS,MMLALI     ALIAS
         BE    MMLSALI             YES, NO STATS
         TM    DIRFLAG,DIRSPFOF    CK FOR BITS THAT SHOULD BE OFF
         BNZ   MEMLADD             THEY'RE NOT: NO SPF STATS
         TM    DIRFLAG,DIRSPFON    CK FOR BITS THAT SHOULD BE ON
         BNO   MEMLADD             THEY'RE NOT: NO SPF STATS
         OC    DIRSPFZ(3),DIRSPFZ  RESERVED AND 00 OF 00YYDDDF ZEROS?
         BNZ   MEMLADD             NO, BRANCH
         CLI   DIRSPFCD,0          00 OF OTHER 00YYDDDF ZERO?
         BNZ   MEMLADD             NO, BRANCH
         SPACE 1
* ALL TESTS PASSED: ASSUME WE HAVE SPF STATS
         SPACE
         SR    R1,R1
         IC    R1,DIRSPFR          REVISION NUMBER FIRST
         CVD   R1,DOUBLE
         MVC   MEMLVMOD+1(4),=X'40212020'                     ABL OCT85
         ED    MEMLVMOD+1(4),DOUBLE+6                         ABL OCT85
         MVI   MEMLVMOD+2,C'.'                                ABL OCT85
         IC    R1,DIRSPFV          VERSION NUMBER
         CVD   R1,DOUBLE
         MVC   DOUBLE(4),=X'40212020'                         ABL OCT85
         ED    DOUBLE(4),DOUBLE+6                             ABL OCT85
         MVC   MEMLVMOD(2),DOUBLE+2                           ABL OCT85
         LA    R1,DIRSPFCR+1           POINT TO YYDDDF
         LA    R15,FULLWORD+1
         L     R2,MEMLCVTD                                     SS JUL85
         BALR  R14,R2                                          SS JUL85
         MVC   FULLWORD(1),FULLWORD+3  CONVERT TO YYMMDD
         MVC   MEMLCDAT(L'DATEMASK),DATEMASK
         ED    MEMLCDAT(L'DATEMASK),FULLWORD
         MVC   MEMLCDAT(8),MEMLCDAT+1                          SS SEP84
         LA    R1,DIRSPFCD+1           POINT TO YYDDDF
         LA    R15,FULLWORD+1
         L     R2,MEMLCVTD                                     SS JUL85
         BALR  R14,R2                                          SS JUL85
         MVC   FULLWORD(1),FULLWORD+3  CONVERT TO YYMMDD
         MVC   MEMLMDAT(L'DATEMASK),DATEMASK
         ED    MEMLMDAT(L'DATEMASK),FULLWORD
         MVC   MEMLMDAT(8),MEMLMDAT+1                          SS SEP84
         MVC   MEMLMTIM(6),MEML0021                           ABL APR85
         ED    MEMLMTIM(6),DIRSPFCT    TIME OF LAST CHANGE
         MVC   MEMLMTIM(5),MEMLMTIM+1                          SS SEP84
         MVI   MEMLMTIM+5,X'40'        FOLLOWING BLANK        ABL OCT84
         LH    R1,DIRSPFIN                                     SS NOV84
         CVD   R1,DOUBLE
         MVC   MEMLISIZ(6),MEML0020                           ABL APR85
         ED    MEMLISIZ(6),DOUBLE+5                            SS NOV84
         MVC   MEMLISIZ(5),MEMLISIZ+1                          SS NOV84
         MVI   MEMLISIZ+5,X'40'        FOLLOWING BLANK         SS NOV84
         LH    R1,DIRSPFSI
         CVD   R1,DOUBLE
         MVC   MEMLCSIZ(6),MEML0020                           ABL APR85
         ED    MEMLCSIZ(6),DOUBLE+5
         MVC   MEMLCSIZ(5),MEMLCSIZ+1                          SS SEP84
         MVI   MEMLCSIZ+5,X'40'        FOLLOWING BLANK        ABL OCT84
         SPACE 1
         MVC   MEMLMID,DIRSPFID
         B     MEMLADD
* PROCESS SOURCE ALIAS                                         SS NOV84
MMLSALI  DS    0H                                              SS NOV84
         MVC   MEMLVMOD(5),MMLALI+1                            SS NOV84
         B     MEMLADD                                         SS NOV84
* PROCESS DIR AS LOAD MODULE
MEMLLOAD DS    0H
* SAVE ATTR BYTES
         MVI   MEMLXATT,C'L'       LOAD TYPE MEMBER
         STC   R15,MEMLVMOD        SAVE LENGTH                 SS SEP84
         MVC   MEMLVMOD+1(0),DIRUSER  SAVE DIR                 SS SEP84
         EX    R15,*-6                                         SS SEP84
         TM    DIRFLAG,X'60'       ANY TTR BITS ON?           ABL APR86
         BNZ   MMLLNSOR            YES, NOT SOURCE            ABL APR86
         CLI   MEMLVMOD,0          CHECK FOR SOURCE IN LOAD    SS NOV84
         BE    MMLNONL             SOURCE                      SS NOV84
         CLI   MEMLVMOD,30         COMPARE FOR SPF STATS       SS NOV84
         BE    MMLNONL             SOURCE                      SS NOV84
MMLLNSOR DS    0H                                             ABL APR86
         CLC   MEMLALIS,MMLALI     IS IT ALIAS
         BNE   MMLALIAS
         CLI   MEMLVMOD,34         COMPARE FOR ALIAS AREA      SS NOV84
         BNE   MMLALIAS            GOOD
         MVC   MEMLMNAM,DIRREAL    SAVE CLAIMED MAIN NAME
MMLALIAS DS    0H
* PROCESS PROGRAM LENGTH
         UNPK  MEMLWK(7),DIRSTORE(4)
         TR    MEMLWK(6),TRHEX
         MVC   MEMLLENG(6),MEMLWK
* PROCESS PROGRAM ENTRY
         UNPK  MEMLWK(7),DIREPA(4)
         TR    MEMLWK(6),TRHEX
         MVC   MEMLENTY(6),MEMLWK
* PROCESS LINKAGE EDIT DATE
         MVC   MEMLLDAT(8),MEMLLENG  INITIALIZE DATE/SIZE FLD ABL APR85
         MVI   LKEDDATE,X'FF'        INVALID DATE             ABL APR85
         AIF   ('&LKEDDAT' EQ 'NO').NOLKED                    ABL APR85
         CLI   #LKEDOPT,2            NOLKEDDATE?              ABL APR85
         BE    MMLNOLKD              YES, BRANCH              ABL APR85
         AGO   .LKEDDEF                                       ABL APR85
.NOLKED  ANOP                                                 ABL APR85
         CLI   #LKEDOPT,1            LKEDDATE?                ABL APR85
         BNE   MMLNOLKD              NO, BRANCH               ABL APR85
.LKEDDEF ANOP                                                 ABL APR85
*
*        IDR SCAN SUBROUTINE
*
         SPACE 3
READIDR  DS    0H
         MVC   STARTTR(3),DIRTTR   FIRST TTR
         SPACE 2
IDREXCP  L     R15,VEXCP
         BALR  R14,R15
         B     *+4(R15)            PROCESS RETURN CODE
         B     IDREXCP1              00 - GOOD READ
         B     LASTIDR               04 - END OF MEMBER
         B     LASTIDR               08 - END OF DATA SET
         B     LASTIDR               12 - I/O ERROR
VEXCP    DC    V(EXCP)                                         SS JUL85
         SPACE 1
IDREXCP1 LR    R15,R0              START OF RECORD
         TM    0(R15),X'50'        TEST SYM OR SCATTER RECORD?
         BM    IDREXCP             YES, SKIP IT
         SPACE 1
         CLI   0(R15),X'20'        CESD RECORD?
         BE    IDREXCP             YES, SKIP
         SPACE 1
         CLI   0(R15),X'80'        IDR RECORD?
         BNE   LASTIDR             NO, BRANCH
         SPACE 1
         TM    2(R15),X'02'        LINKAGE EDITOR IDR RECORD?
         BO    LKEDIDR             YES, BRANCH
         B     IDREXCP             CONTINUED RECORD
         SPACE 2
LASTIDR  DS    0H
         MVI   LKEDDATE,X'FF'      NO DATE                     SS JUL85
         B     MMLNOLKD                                       ABL NOV85
         EJECT
         SPACE 3
*  LINKAGE EDITOR IDR RECORDS:
* --  --  --  --  -- ---+ --  -- ---+ --  --  --  --  --  --  --  -- -*
*  0 - 9                  10 - 11    12 - 14                        *
*  LINKAGE EDITOR NAME    VVMM       LINKAGE EDIT DATE              *
* --  --  --  --  -- ---+ --  -- ---+ --  --  --  --  --  --  --  -- -*
         SPACE 1
LKEDIDR  OI    FLAGSCC,FIDR
         LA    R1,15(R15)          ADDRESS OF DATE
         LA    R15,LKEDDATE
         L     R2,MEMLCVTD                                     SS JUL85
         BALR  R14,R2                                          SS JUL85
         SPACE 2
         MVC   MEMLWK(9),DATEMASK    EDIT MASK                ABL APR85
         ED    MEMLWK(9),LKEDDATE    DATE AS " MM/DD/YY"      ABL APR85
         MVC   MEMLLDAT(2),MEMLWK+7  YY                       ABL APR85
         MVC   MEMLLDAT+3(5),MEMLWK+1 MM/DD                   ABL APR85
         MVI   MEMLLDAT+2,C'/'       NOW IN YY/MM/DD FORMAT   ABL APR85
         CLI   MEMLLDAT+3,C' '       SUPPRESSED LEADING BLANK?ABL APR85
         BNE   MMLNOLKD              NO, BRANCH               ABL APR85
         MVI   MEMLLDAT+3,C'0'       YES, REPLACE THE BLANK   ABL APR85
MMLNOLKD DS    0H                                             ABL APR85
* PROCESS APF CODE
         TM    DIRATTR2,DIRVS      IS IT VS
         BO    MMLAPF
         MVC   MEMLAPF(4),MMLCNOVS
         B     MMLDC
MMLAPF   TM    DIRATTR2,DIRAPFF    IS APF THERE
         BZ    MMLDC
*        LA    R0,DIRCUDHW         CLEAR IC REG
*        LA    R15,0               CLEAR IC REG
*        IC    R15,DIRFLAG         FETCH COUNT FIELD MASK
*        NR    R15,R0              ZERO OUT NON-COUNT BITS
*        SLL   R15,1               MULT BY 2=NUMBER OF BYTES IN ENTRY
*        TM    DIRATTR2,DIRSSIF    IS THERE SSI
*        BO    MMLM1               LENG COMES OUT EVEN
*        TM    DIRATTR,DIRSCTR     IS IT SCATTER LOAD
*        BO    MMLM2               LENG COMES OUT EXTRA BYTE
*        CH    R15,MMLH34          LENG FOR ALIAS MAIN NAME    SS NOV84
*        BE    MMLM1               LENG COMES OUT EVEN
*        MAIN ENTRY DIR ENTRY --   LENG COMES OUT EXTRA BYTE
*MLM2    LA    R15,DIRUSER-2(R15)        GET TO END OF DIR-2
*        B     MMLAPF2
*MLM1    LA    R15,DIRUSER-1(R15)        GET TO END OF DIR-1
         LA    R2,DIRAPF                                       SS NOV85
         TM    DIRATTR,DIRSCTR     SCATTER FORMAT              SS NOV85
         BNO   *+8                                             SS NOV85
         LA    R2,8(,R2)                                       SS NOV85
         TM    DIRFLAG,X'80'       ALIAS                       SS NOV85
         BO    MEMLAPF3            YES                         SS NOV85
         CLI   8(R2),0             CONVERTED ALIAS             SS NOV85
         BE    *+8                 NO, SKIP                    SS NOV85
MEMLAPF3 LA    R2,11(,R2)                                      SS NOV85
         TM    DIRATTR2,DIR2SSI    SSI PRESENT                 SS NOV85
         BNO   MEMLAPF4            NO                          SS NOV85
         LA    R2,1(,R2)           ROUND                       SS NOV85
         N     R2,=F'-2'           OFF LAST BIT (MAKE EVEN)    SS NOV85
         CLC   =F'0',0(R2)         ZERO SSI                    SS NOV85
         BE    MEMLAPF4            NO SSI                      SS NOV85
         CLC   =F'-1',0(R2)        ALL FFFFFF                  SS NOV85
         BE    MEMLAPF4                                        SS NOV85
         LA    R2,4(,R2)           ADD FOR SSI                 SS NOV85
MEMLAPF4 DS    0H                                              SS NOV85
         LA    R15,1(,R2)          APF DATA                    SS NOV85
         CLI   0(R2),1             GOOD SSI                    SS NOV85
         BE    MMLAPF2             YES                         SS NOV85
         MVC    MEMLAPF(4),MMLCERR                             SS NOV85
         B     MMLDC                                           SS NOV85
MMLAPF2  CLI   0(R15),0            TEST AC(0)
         BE    MMLDC
         MVC   MEMLAPF+3(1),0(R15)                            ABL OCT85
         OI    MEMLAPF+3,X'F0'     MAKE PRINTABLE             ABL OCT85
         MVC   MEMLAPF(3),MMLCAC   FILL IN                    ABL OCT85
MMLDC    TM    DIRATTR+1,DIRNODC   IS IT DC
         BO    MMLSSI              NO                          SS NOV84
         MVC   MEMLDC(2),MMLCDC    SET DC
MMLSSI   TM    DIRATTR2,DIRSSIF    DO WE HAVE SSI INFO         SS NOV84
         BZ    MMLTEST             NO                          SS NOV84
         SH    R15,MMLH5           BACK UP TO SSI INFO         SS NOV84
         UNPK  MEMLWK(9),0(5,R15)  UNPACK HEX                  SS NOV84
         TR    MEMLWK(8),TRHEX     TRANSLATE TO HEX            SS NOV84
         MVC   MEMLSSI(8),MEMLWK                               SS NOV84
MMLTEST  TM    DIRATTR,DIRTEST     IS IT TEST
         BZ    MMLATTR1
         TM    DIRATTR+1,DIRNOED   IS IT EDITABLE
         BZ    MEMLOK              NO, INCOMPATIBLE WITH TEST
         MVC   MEMLATT1(4),MMLCNOED
         MVC   MEMLTEST(3),MMLCERR
         B     MMLLEV2
MEMLOK   MVC   MEMLTEST(4),MMLCTEST
MMLATTR1 TM    DIRATTR+1,DIRNOED   IS IT EDITABLE
         BZ    MMLEXEC             NO, INCOMPATIBLE WITH TEST
         MVC   MEMLATT1(4),MMLCNOED
         B     MMLLEV2
MMLEXEC  TM    DIRATTR,DIREXEC     IS IT EXECUTABLE
         BO    MMLLOAD             YES CONTINUE
         MVC   MEMLATT1(4),MMLCNOEX
         B     MMLLEV2A
MMLLOAD  TM    DIRATTR,DIRLOAD     IS IT LOAD ONLY
         BZ    MMLOVLY             NO  CONTINUE
         MVC   MEMLATT1(4),MMLCLOAD
         B     MMLLEV2B
MMLOVLY  TM    DIRATTR,DIROVLY     IS IT OVERLAY
         BZ    MMLSCTR             NO  CONTINUE
         MVC   MEMLATT1(4),MMLCOVLY
         B     MMLLEV2C
MMLSCTR  TM    DIRATTR,DIRSCTR     IS IT SCATTER LOAD
         BZ    MMLREFR             NO  CONTINUE
         MVC   MEMLATT1(4),MMLCSCTR
         B     MMLLEV2D
MMLREFR  TM    DIRATTR+1,DIRREFR   IS IT REFRESHABLE
         BZ    MMLRENT             NO  CONTINUE
         MVC   MEMLATT1(4),MMLCREFR
         B     MMLLEV2E
MMLRENT  TM    DIRATTR,DIRRENT     IS IT REENTRANT
         BZ    MMLREUS             NO  CONTINUE
         MVC   MEMLATT1(4),MMLCRENT
         TM    DIRATTR,DIRREUS     MUST ALSO BE REUS
         BZ    REUSERR
         MVC   MEMLATT2(4),MMLCREUS
         B     MMLMODE
REUSERR  MVC   MEMLATT2(4),MMLCERR1
         B     MMLMODE
MMLREUS  TM    DIRATTR,DIRREUS     IS IT REENTRANT
         BZ    MMLMODE             NO  CONTINUE
         MVC   MEMLATT1(4),MMLCREUS
         B     MMLMODE
MMLLEV2  DS    0H
         TM    DIRATTR,DIREXEC     IS IT EXECUTABLE
         BO    MMLLOAD2            YES CONTINUE
         MVC   MEMLATT2(4),MMLCNOEX
         B     MMLMODE
MMLLEV2A DS    0H
MMLLOAD2 TM    DIRATTR,DIRLOAD     IS IT LOAD ONLY
         BZ    MMLOVLY2            NO  CONTINUE               ABL OCT85
         MVC   MEMLATT2(4),MMLCLOAD
         B     MMLLEV2B
MMLOVLY2 TM    DIRATTR,DIROVLY     IS IT OVERLAY
         BZ    MMLSCTR2            NO  CONTINUE
         MVC   MEMLATT2(4),MMLCOVLY
         B     MMLLEV2C
MMLSCTR2 TM    DIRATTR,DIRSCTR     IS IT SCATTER LOAD
         BZ    MMLREFR2            NO  CONTINUE
         MVC   MEMLATT2(4),MMLCSCTR
         B     MMLLEV2D
MMLREFR2 TM    DIRATTR+1,DIRREFR   IS IT REFRESHABLE
         BZ    MMLRENT2            NO  CONTINUE
         MVC   MEMLATT2(4),MMLCREFR
         B     MMLMODE
MMLLEV2E DS    0H
MMLRENT2 TM    DIRATTR,DIRRENT     IS IT REENTRANT
         BZ    MMLREUS2            NO  CONTINUE
         MVC   MEMLATT2(4),MMLCRENT
         TM    DIRATTR,DIRREUS     MUST ALSO BE REUS
         BO    MMLMODE
         MVC   MEMLATT2(4),MMLCERR1
         B     MMLMODE
MMLREUS2 TM    DIRATTR,DIRREUS     IS IT REUSABLE
         BZ    MMLMODE             NO  CONTINUE
         MVC   MEMLATT2(4),MMLCREUS
         B     MMLMODE
MMLLEV2B TM    DIRATTR,DIRBADL
         BZ    MMLMODE                                        ABL OCT85
         MVC   MEMLATT2(4),MMLCERRL
         B     MMLMODE
MMLLEV2C TM    DIRATTR,DIRBADO
         BZ    MMLMODE
         MVC   MEMLATT2(4),MMLCERRO
         B     MMLMODE
MMLLEV2D TM    DIRATTR,DIRBADS
         BZ    MMLREUS2
         MVC   MEMLATT2(4),MMLCERRS
         B     MMLMODE
MMLMODE  DS    0H
         CLI   DIRATTR3,0
         BE    MEMLEMOD
         CLC   MEMLALIS,MMLALI    IS IT ALIAS
         BE    MMLMODEA
         TM    DIRATTR3,DIRRANY    RMODE ANY
         BZ    MMLMODE2
         TM    DIRATTR3,DIRAMOD2   CHK AMODE 31
         BO    MMLERRR             RMODEANY, AMODEANY         ABL OCT85
         TM    DIRATTR3,DIRAERR2*2                            ABL OCT85
         BO    MMLRANY             RMODEANY, AMODE31 (VALID)  ABL OCT85
         B     MMLERRR
MMLMODE2 TM    DIRATTR3,DIRAMOD2
         BO    MMLAANY
         TM    DIRATTR3,DIRAERR2*2                            ABL OCT85
         BNO   MMLA24                                         ABL OCT85
         B     MMLA31
MMLMODEA TM    DIRATTR3,DIRRANY    RMODE ANY
         BZ    MMLMODE3
         TM    DIRATTR3,DIRAMOD1   CHK AMODE 31
         BO    MMLERRR             RMODEANY, AMODEANY         ABL OCT85
         TM    DIRATTR3,DIRAERR1*2                            ABL OCT85
         BO    MMLRANY             RMODEANY, AMODE31 (VALID)  ABL OCT85
         B     MMLERRR
MMLMODE3 TM    DIRATTR3,DIRAMOD1
         BO    MMLAANY
         TM    DIRATTR3,DIRAERR1*2                            ABL OCT85
         BNO   MMLA24                                         ABL OCT85
         B     MMLA31
MMLERRR  MVC   MEMLMODE(4),MMLCERRR
         B     MEMLEMOD
MMLRANY  MVC   MEMLMODE(4),MMLCRANY                           ABL OCT85
         B     MEMLEMOD
MMLAANY  MVC   MEMLMODE(4),MMLCAANY
         B     MEMLEMOD
MMLA31   MVC   MEMLMODE(3),MMLCA31
         B     MEMLEMOD
MMLA24   MVC   MEMLMODE(3),MMLCA24                            ABL OCT85
         B     MEMLEMOD                                       ABL OCT85
MMLNONL  DS    0H                                              SS NOV84
         MVC   MEMLATT1,MMLSORCE                               SS NOV84
         B     MEMLADD                                         SS NOV84
MEMLEMOD DS    0H
MEMLADD  DS    0H
         BR    R3            RETURN                            SS JUL85
         DROP  R4                                              SS JUL85
*
*  MEML CONSTANT AREA
*
*
MEMLCVTD DC    V(CONVDATE)                                     SS JUL85
MMLH5    DC    H'5'                                            SS NOV84
MMLH34   DC    H'34'                                           SS NOV84
MMLALI   DC    CL8'*ALIAS'
MMLCNOVS DC    CL4'NOVS'
MMLCAC   DC    CL4'AC= '                                      ABL OCT85
MMLCDC   DC    CL4'DC  '
MMLCNOED DC    CL4'NOED'
MMLCERR  DC    CL4'ERR '
MMLCTEST DC    CL4'TEST'
MMLCNOEX DC    CL4'NOEX'
MMLCLOAD DC    CL4'LOAD'
MMLCOVLY DC    CL4'OVLY'
MMLCSCTR DC    CL4'SCTR'
MMLCREFR DC    CL4'REFR'
MMLCRENT DC    CL4'RENT'
MMLCREUS DC    CL4'REUS'
MMLCERR1 DC    CL4'ERR1'
MMLCERRL DC    CL4'ERRL'
MMLCERRO DC    CL4'ERRO'
MMLCERRS DC    CL4'ERRS'
MMLCERRR DC    CL4'ERRR'
MMLCRANY DC    CL4'RANY'                                      ABL OCT85
MMLCA24  DC    CL4'A24 '                                      ABL OCT85
MMLCA31  DC    CL4'A31 '
MMLCAANY DC    CL4'AANY'
MMLSORCE DC    CL4'SORC'                                       SS NOV84
         SPACE 2
DATEMASK DC    X'402120612020612020'                           SS JUL85
TRHEX1   DC    C'0123456789ABCDEF'   TRANSLATE TO HEX
TRHEX    EQU   *-256
         LTORG ,                                               SS NOV85
         EJECT
DIRCALIS EQU   B'10000000'         ALIAS FLAG
DIRCTTRN EQU   B'01100000'         TTR COUNT
DIRCUDHW EQU   B'00011111'         HALFWD COUNT
DIRSPFOF EQU   B'01110000'         BITS ARE OFF IN SPF STATS
* SOME BITS ON FOR LOAD MODULES
DIRSPFON EQU   B'00001111'         BITS ARE ON IN SPF STATS
DIRRENT  EQU   B'10000000'           RENT
DIRREUS  EQU   B'01000000'           REUS
DIROVLY  EQU   B'00100000'           OVLY
DIRBADO  EQU   B'11001100'           OVLY      CONFLICTS
DIRTEST  EQU   B'00010000'           TEST
DIRLOAD  EQU   B'00001000'           LOAD ONLY
DIRBADL  EQU   B'00000100'           LOAD ONLY CONFLICTS
DIRSCTR  EQU   B'00000100'           SCTR LOAD
DIRBADS  EQU   B'10101000'           SCTR LOAD CONFLICTS
DIREXEC  EQU   B'00000010'           EXECUTABLE
DIRF1    EQU   B'00000001'
* ATTR 1 BYTE 1
DIRNODC  EQU   B'10000000'           NOT DC
DIRF2    EQU   B'01000000'
DIRF3    EQU   B'00100000'
DIRF4    EQU   B'00010000'
DIRNOED  EQU   B'00001000'           NOT EDITABLE
DIRF5    EQU   B'00000100'
DIRLKEDF EQU   B'00000010'           F LEVEL LINK EDITER
DIRREFR  EQU   B'00000001'           REFR
* ATTR 2
DIRVS    EQU   B'10000000'           VS LEVEL LINK EDITER
DIRRES1  EQU   B'01000000'
DIRPG    EQU   B'00100000'           PAGE ALIGNMEMT
DIRSSIF  EQU   B'00010000'           SSI PRESENT
DIRAPFF  EQU   B'00001000'           APF PRESENT
* AMODE/RMODE FLAGS
DIRRANY  EQU   B'00010000'           RMODE ANY FLAG
DIRAMOD1 EQU   B'00001100'           AMODE FOR ALIAS
DIRAERR1 EQU   B'00000100'           AMODE INVALID BIT COMB    SS NOV84
DIRAMOD2 EQU   B'00000011'           AMODE FOR MAIN ENTRY
DIRAERR2 EQU   B'00000001'           AMODE INVALID BIT COMB    SS NOV84
MEML0021 DC    X'0021207A2020'                                ABL APR85
MEML0020 DC    X'002020202120'                                ABL APR85
         SPACE 2
         TITLE 'MEMLIST LINE CMD FUCTION'                      SS NOV85
*                                                              SS SEP84
*  MEMLIST LINE CMD PROCESSOR                                  SS SEP84
*                                                              SS SEP84
ISPLNC2  DS    0H                                              SS SEP84
         USING *,R4                                            SS NOV85
         TM    SPFTFLG1,SPFTLPOS  POST PROCESSING REQUIRED     SS NOV85
         BO    ISPPOST              YES                        SS NOV85
         NI    SPFLAG0,255-SPFCKER-SPFMSGER   RESET            SS SEP84
         OC    MEMLDATA,ISPBLK8     MAKE UPPER CASE            SS SEP84
         OC    MEM2OPT,ISPBLK8 FORCE UPPER CASE                SS NOV85
         LA    R1,MEM2OPT                                      SS NOV85
         LA    R15,4          LIMIT OF SCAN OF LINE ENTRY      SS NOV85
         L     R14,SPFTBPLC  TABLE FOR SEARCH                  SS NOV85
         BAL   R2,ISPVER1           CHECK CMD VERB             SS NOV85
         MVC   SPFTTPT,SPFVTPT      COPY POINTER               SS NOV85
         C     R15,ISPL8            IS THIS VALID              SS SEP84
         BH    ISPLNB3              NO                         SS SEP84
*        TM    $TLF1(R14),#L+#O     IS THIS VALID LINE CMD     SS SEP84
*        BZ    ISPLNB3                                         SS SEP84
         TM    $TLF2(R14),#H        FROM LINE O CMD ONLY       SS NOV85
         BO    ISPLNB3                                         SS NOV85
         TM    $TLF1(R14),#S        IS THIS SOURCE ONLY        SS SEP84
         BZ    ISPLNC3                                         SS SEP84
         TM    FLAGSCC,RECFMU       IS IT A LOADMOD?           SS SEP84
         BO    ISPLNB3              YES, BAD                   SS SEP84
         B     ISPLNC4                                         SS SEP84
ISPLNC3  DS    0H                                              SS SEP84
         TM    $TLF1(R14),#U        IS THIS LOADMOD ONLY       SS SEP84
         BZ    ISPLNC4                                         SS SEP84
         TM    FLAGSCC,RECFMU       IS IT A LOADMOD?           SS SEP84
         BZ    ISPLNB3              NO,  BAD                   SS SEP84
ISPLNC4  DS    0H                                              SS SEP84
         MVI   SPFTPOSI,0           DEFAULT POST PROCESSOR     SS SEP84
         OI    SPFTFLG1,SPFTLPOS    POST PROCESSING TO GO      SS NOV85
ISPLNC5  DS    0H                                              SS SEP84
         SR    R15,R15                                         SS SEP84
         IC    R15,$TLFU(R14)       GET PROCESSOR INDEX        SS JUL85
         B     *+4(R15)             INDEX TO PROCESSOR         SS SEP84
         B     ISPLNBAD          0  INVALID                    SS SEP84
         B     ISPMMLNL          4  BLANK ENTRY                SS SEP84
         B     ISPDELL           8  DEL MEML ENTRY             SS NOV84
         B     ISPLALI          12  ALIAS                      SS SEP84
         B     ISPGEN           16  GENERAL PROCESSOR          SS SEP84
         B     ISPLDEL          20  DELETE                     SS SEP84
         B     ISPLREN          24  RENAME                     SS SEP84
         B     ISPLNBAD         28  UNDO                       SS SEP84
         B     ISPLPND          32  SELECT PANEL SUPPORT       SS NOV84
         B     ISPSTAT1         36  STATUS COMMAND             SS SEP84
         B     ISPUTL1          40  UTILITY COMMANDS           SS SEP84
         B     ISPLNBAD         44  PAD                        SS NOV85
         SPACE 3                                               SS SEP84
ISPLERR  DS    0H                                              SS SEP84
         NI    SPFLAG0,255-SPFCKER-SPFMSGER   RESET            SS SEP84
         MVC   MEMLDATA,ISPERMSG                               SS SEP84
         MVC   SPFMSGID,ISPPDSM   INIT MESSAGE                ABL JUN85
         MVI   SPFMSGID+7,C'A'                                ABL JUN85
         MVI   SPFMSGID+6,C'1'    GENERAL ERROR MESSAGE       ABL JUN85
         B     ISPLNB2          CONTINUE                       SS SEP84
ISPLNBAD DS    0H                                              SS SEP84
         MVC   MEMLDATA,ISPINVLD    INVALID MESSAGE            SS SEP84
         B     ISPLNB2          CONTINUE                       SS NOV85
ISPLNB3  DS    0H                                              SS SEP84
         MVC   MEMLDATA,ISPINVLD    INVALID MESSAGE            SS SEP84
ISPLNB2  DS    0H                                              SS NOV85
         OI    SPFLAG2,SPFNPOS      POSITIONING NOT ALLOWED   ABL APR86
         BAL   R2,ISPMEMOD          UPDATE TABLE LINE          SS SEP84
         BAL   R2,ISPQUERY                                     SS MAR85
         MVC   MEMLCCRP,MEMLCRP     SAVE CUR CPR FOR CURSER    SS MAR85
         NI    SPFTFLG1,255-SPFTMUT-SPFTLCD-SPFTZSV-SPFTLPOS   SS NOV85
         BAL   R2,ISPDSPRS      RESTORE DISPLAY                SS NOV85
         LA    R15,100             TBDISPL SUPPORT             SS NOV85
         BR    R3                  RETURN TO ROUTER            SS NOV85
         SPACE 2                                               SS NOV85
ISPCMDL  DS    0H                                              SS NOV85
         MVC   SPFTTPT2,SPFTTPT   SAVE CMD FOR REPEAT          SS NOV85
         OI    SPFLAG2,SPFLNCD    SET FOR RENAME/ALIAS         SS NOV85
         LA    R15,112            ISPCMDC                      SS NOV85
         BR    R3                 RETURN TO ROUTER             SS NOV85
         SPACE 2                                               SS SEP84
ISPPOST  DS    0H                                              SS SEP84
         L     R14,SPFTTPT         GET MY TABLE ENTRY          SS NOV85
         NI    SPFLAG2,255-SPFLNCD    FOR RENAME/ALIAS         SS NOV85
         SR    R15,R15                                         SS SEP84
         IC    R15,SPFTPOSI         GET POST PROCESSOR INDEX   SS SEP84
         B     *+4(R15)             INDEX TO PROCESSOR         SS SEP84
         B     ISPLNX            0  CLEAN UP                   SS SEP84
         B     ISPLNV            4  RETURN AFTER STATS REFRESH SS SEP84
         B     ISPDELP           8  DEL MEML ENTRY             SS SEP84
         B     ISPLALIP         12  ALIAS                      SS SEP84
         B     ISPGENP          16  GENERAL PROCESSOR          SS SEP84
         B     ISPLDELP         20  DELETE                     SS NOV84
         B     ISPLRENP         24  RENAME                     SS SEP84
         B     ISPLNX           28  RESTORE                    SS SEP84
         B     ISPLPNDP         32  SELECT PANEL SUPPORT       SS NOV84
         B     ISPSTAP2         36  STATUS PART 2              SS SEP84
         B     ISPSTAP3         40  STATUS PART 3              SS SEP84
         B     ISPSTAP4         44  STATUS PART 4              SS SEP84
         SPACE 3                                               SS SEP84
ISPLNV   DS    0H                                              SS SEP84
         L     R14,SPFTTPT         GET MY TABLE ENTRY          SS NOV85
         TM    $TLF1(R14),#V       VIEW MODE TO FOLLOW         SS SEP84
         BZ    ISPLNX              NO                          SS NOV85
         MVI   SPFTPOSI,28         COME BACK TO ISPLNX         SS NOV85
         LA    R1,4                LINE OUTPUT PANEL           SS NOV85
         BAL   R2,ISPSTKI          STACK IT                    SS NOV85
         LA    R15,100             TBDISPL SUPPORT             SS NOV85
         BR    R3                  RETURN TO ROUTER            SS NOV85
ISPMMLNL DS    0H                                              SS MAR85
         CLI   MEMLDATA,C'*'    IS IT A MSG                    SS MAR85
         BNE   ISPMMLNK         NO,  CLEAR                     SS MAR85
         CLC   MEMLDATA,ISPINVLD  INVALID MSG                  SS MAR85
         BNE   ISPMMLN2         NO, DONT CLEAR                ABL JUN85
ISPMMLNK DS    0H                                              SS MAR85
         MVC   MEMLDATA,ISPBLK8    BLANK OUT DATA              SS MAR85
ISPMMLN2 DS    0H                                             ABL JUN85
         BAL   R2,ISPMEMOD      UPDATE TABLE                   SS MAR85
         B     ISPLNX2                                         SS MAR85
ISPLNX   DS    0H                                              SS NOV85
         BAL   R2,ISPQUERY      GET CUR CRP FOR CURSOR         SS MAR85
         MVC   MEMLCCRP,MEMLCRP SAVE CUR CRP                   SS MAR85
         OI    SPFTFLG1,SPFTYPOS   WE CAN DO CUR POSITIONING   SS NOV85
ISPLNX2  DS    0H                                              SS MAR85
         NI    SPFTFLG1,255-SPFTLPOS                           SS NOV85
         LA    R15,100          TABLE PANEL DISPLAY SUPPORT    SS NOV85
         BR    R3                  RETURN TO ROUTER            SS NOV85
         SPACE 2                                               SS SEP84
ISPLDELP DS    0H                                              SS SEP84
         TM    SPFLAG0,SPFMSGER    ANY ERRORS                  SS SEP84
         BO    ISPLERR                                         SS SEP84
         MVI   MEM2XATT+1,C'D'     MARK NO LONGER ACTIVE       SS NOV84
         AIF   ('&SPFTDEL' EQ 'N').NOTDEL                      SS JUN85
         BAL   R2,ISPDEL1          REMOVE FROM TABLE           SS NOV84
         B     ISPLNX              CONTINUE WITH NEXT ENTRY    SS NOV84
.NOTDEL  ANOP                                                  SS JUN85
         B     ISPGENP             SAME POST PROCESSING        SS SEP84
ISPLRENP DS    0H                                              SS SEP84
         TM    SPFLAG0,SPFMSGER    ANY ERRORS                  SS SEP84
         BO    ISPLERR             SAME POST PROCESSING        SS SEP84
*        LH    R15,$TLMG(R14)      MSG OFFSET                  SS NOV84
*        AL    R15,ISP$TMGA        MSG ADDR                    SS MAR85
*        MVC   MEMLDATA,0(R15)     PUT MSG IN MEMLIST TABLE    SS SEP84
         BAL   R2,ISPLMSGS         PROCESS MESSAGE             SS NOV85
         MVC   MEM2OPT,ISPBLK8     CLEAR OPTION                SS SEP84
         MVI   MEM2XATT+1,C'R'     NO LONGER ACTIVE            SS NOV84
         BAL   R2,ISPMEMOD         UPDATE TABLE                SS SEP84
         MVC   MEM1NAMA(MEMLVLEN),MEM2NAMA   SAVE STATS        SS SEP84
         AIF   ('&SPFTDEL' EQ 'N').NOTDEL2                     SS JUN85
         BAL   R2,ISPDEL1          REMOVE FROM TABLE           SS NOV84
.NOTDEL2 ANOP                                                  SS JUN85
         CLI   SPFSAVM2,C' '       RENAME PASS A NAME          SS AUG85
         BNH   ISPLREN3            NO                          SS NOV85
         MVC   MEMLNMSV,SPFSAVM2   YES USE                     SS NOV85
ISPLREN3 DS    0H                                              SS NOV85
         BAL   R2,ISPLOCI                                      SS NOV85
         MVC   MEM2NAMA(MEMLVLEN),MEM1NAMA   SAME STATS        SS SEP84
         MVI   MEM2XATT+1,C' '     MAKE SURE IT IS ACTIVE      SS NOV84
         MVC   MEMLDATA,ISPNEWNM   PUT MSG IN MEMLIST TABLE    SS SEP84
         MVC   MEMLNAME,MEMLNMSV   ADD ENTRY FOR NEWNAME       SS SEP84
         LTR   R15,R15             OVERLAY ONE                 SS SEP84
         BZ    ISPLREN5                                        SS SEP84
         BAL   R2,ISPMEMAD         UPDATE TABLE                SS SEP84
         B     ISPLNV                                          SS SEP84
ISPLREN5 DS    0H                                              SS SEP84
         BAL   R2,ISPMEMOD         UPDATE TABLE                SS SEP84
         B     ISPLNV                                          SS SEP84
ISPLALIP DS    0H                                              SS SEP84
         TM    SPFLAG0,SPFMSGER    ANY ERRORS                  SS SEP84
         BO    ISPLERR             SAME POST PROCESSING        SS SEP84
*        LH    R15,$TLMG(R14)      MSG OFFSET                  SS NOV84
*        AL    R15,ISP$TMGA        MSG ADDR                    SS MAR85
*        MVC   MEMLDATA,0(R15)     PUT MSG IN MEMLIST TABLE    SS SEP84
         BAL   R2,ISPLMSGS         PROCESS MESSAGE             SS NOV85
         MVC   MEM2OPT,ISPBLK8     CLEAR OPTION                SS SEP84
         BAL   R2,ISPMEMOD         UPDATE TABLE                SS SEP84
         MVC   MEM1NAMA(MEMLVLEN),MEM2NAMA   SAVE STATS        SS SEP84
         CLI   SPFSAVM2,C' '       RENAME PASS A NAME          SS AUG85
         BNH   ISPLALI3            NO                          SS NOV85
         MVC   MEMLNMSV,SPFSAVM2   YES USE                     SS NOV85
ISPLALI3 DS    0H                                              SS NOV85
         BAL   R2,ISPLOCI                                      SS NOV85
         MVC   MEM2NAMA(MEMLVLEN),MEM1NAMA   SAME STATS        SS SEP84
         MVI   MEM2XATT+1,C' '     MAKE SURE IT IS ACTIVE      SS NOV84
         MVC   MEMLDATA,ISPNEWNM   PUT MSG IN MEMLIST TABLE    SS SEP84
         MVC   MEMLNAME,MEMLNMSV   ADD ENTRY FOR NEWNAME       SS SEP84
         LTR   R15,R15             OVERLAY ONE                 SS SEP84
         BE    ISPLALI5                                        SS SEP84
         BAL   R2,ISPMEMAD         UPDATE TABLE                SS SEP84
         B     ISPLSTAT            RESET STATS                 SS SEP84
ISPLALI5 DS    0H                                              SS SEP84
         BAL   R2,ISPMEMOD         UPDATE TABLE                SS SEP84
         B     ISPLSTAT            RESET STATS                 SS SEP84
         SPACE 2                                               SS SEP84
ISPLDEL  DS    0H                                              SS SEP84
ISPLREN  DS    0H                                              SS SEP84
ISPLALI  DS    0H                                              SS SEP84
ISPGEN   DS    0H                                              SS SEP84
         CLI   MEM2XATT+1,C' '     IS THIS A GOOD MEMBER       SS NOV84
         BH    ISPLNBAD            CANNOT PROCESS              SS NOV84
         MVC   SPFTPOSI(1),$TLFU(R14)  POST PROCESSING INDEX   SS JUL85
         TM    $TLF2(R14),#P       DIFFERENT POST PROC         SS NOV84
         BZ    ISPGEN2              NO SKIP                    SS NOV84
         MVC   SPFTPOSI(1),$TLEX(R14) USE IT                   SS NOV84
ISPGEN2  DS    0H                                              SS SEP84
         OI    SPFLAG0,SPFCKER     ALSO CHECK FOR ERRORS       SS NOV84
         LA    R15,$TLCM(R14)   GET NAME                       SS JUL85
         TM    $TLF2(R14),#R       REAL CMD OFFSET*2           SS NOV84
         BZ    ISPGEN4                                         SS JUL85
         SR    R15,R15                                         SS NOV84
         IC    R15,$TLEX(R14)                                  SS NOV84
         LA    R15,ISPREAL(R15)                                SS NOV84
ISPGEN4  DS    0H                                             ABL OCT84
         MVC   PUTGETBF(4),ISPCMD30                           ABL OCT84
         MVC   SPFINPUT(8),0(R15) COPY CMD NAME                SS SEP84
         MVI   SPFINPUT+8,C' '                                 SS SEP84
         MVC   SPFINPUT+9(8),MEMLNAME                          SS SEP84
         MVI   SPFINPUT+17,C' '                               ABL OCT84
         CLI   MEMLDATA,X'00'      NULLS                       SS NOV84
         BE    ISPGEN5             YES, CONVERT TO BLANKS      SS NOV84
         CLI   MEMLDATA,C'*'       STATUS MESSAGE?            ABL OCT84
         BNE   *+10                NO, BRANCH                 ABL OCT84
ISPGEN5  DS    0H                                              SS NOV84
         MVC   MEMLDATA(8),ISPBLK8 YES, BLANK IT OUT          ABL OCT84
         MVC   SPFINPUT+18(8),MEMLDATA                        ABL OCT84
         MVC   MEMLNMSV,MEMLDATA                               SS NOV84
         TM    $TLF1(R14),#V       VIEW MODE OUTPUT?           SS DEC84
         BZ    ISPGEN6             NO, BRANCH                  SS DEC84
         OI    SPFLAG3,SPFLOGM     YES, MARK FOR LOGGING       SS DEC84
ISPGEN6  DS    0H                                              SS NOV84
         B     ISPCMDL                                        ABL OCT84
ISPGENP  DS    0H                                              SS SEP84
* #V: ATTRIB, COMPARE, DIR, FIND, HISTORY, LIST, MAP & VERIFY ABL DEC84
         TM    $TLF1(R14),#V       VIEW MODE EXPECTED?        ABL DEC84
         BO    ISPGENP2            YES, IGNORE ERROR MSG FLG  ABL DEC84
         TM    SPFLAG0,SPFMSGER    ANY ERRORS?                 SS SEP84
         BO    ISPLERR             YES, TERMINATE LIST CMDS.   SS SEP84
ISPGENP2 DS    0H                                             ABL SEP84
*        LH    R15,$TLMG(R14)      MSG OFFSET                  SS NOV84
*        AL    R15,ISP$TMGA        MSG ADDR                    SS SEP84
*        MVC   MEMLDATA,0(R15)     PUT MSG IN MEMLIST TABLE    SS SEP84
         BAL   R2,ISPLMSGS         PROCESS MESSAGE             SS NOV85
         MVC   MEM2OPT,ISPBLK8     CLEAR OPTION                SS SEP84
         BAL   R2,ISPMEMOD         UPDATE TABLE                SS SEP84
         TM    ##ADRPA#,$F         SOFT ATTN SIGNALLED?       ABL APR85
         BNO   ISPLSTA0            NO, BRANCH                 ABL APR85
         NI    ##ADRPA#,255-$F     YES, TURN OFF FLAG         ABL APR85
         MVC   MEMLDATA,ISPATTN    SPECIAL *ATTN* FLAG        ABL APR85
         B     ISPLNB2             TERMINATE LINE COMMANDS    ABL APR85
ISPLSTA0 DS    0H                                             ABL APR85
         L     R14,SPFTTPT         RESTORE R14 WITH TABLE ENT  SS NOV85
         TM    $TLF2(R14),#M       UPDATE STATS                SS NOV84
         BZ    ISPLNV              NO CONTINUE                 SS NOV84
ISPLSTAT DS    0H                                              SS NOV84
         MVI   SPFTPOSI,4          CHANGE SECOND POST PROC     SS NOV84
         OI    SPFLAG2,SPFUPDA                                 SS NOV84
         MVC   DIRNAME(8),MEMLNAME MEMBER NAME                ABL FEB86
         SPACE 1                                              ABL FEB86
         BLDL  INDCB,BLDLLIST           INSURE IT IS THERE    ABL FEB86
         B     *+4(R15)                 PROCESS RETURN CODE   ABL FEB86
         B     ISPLSTT4                   00 - MEMBER FOUND   ABL FEB86
         B     ISPLSTT8                   04 - NOT FOUND      ABL FEB86
         B     ISPLSTT8                   08 - DIRECTORY I/O  ABL FEB86
         SPACE 1                                              ABL FEB86
ISPLSTT4 MVC   DIRFLAG(DIREND-DIRFLAG),DIRFLAG+2 BLDL ADDS    ABL FEB86
         B     ISPLSTT9                                       ABL FEB86
ISPLSTT8 XC    DIRFLAG(DIREND-DIRFLAG),DIRFLAG  CLEAR ENTRY   ABL FEB86
         SPACE 1                                              ABL FEB86
ISPLSTT9 L     R4,MEMLFUNA         MEMLIST PROCESSOR          ABL FEB86
         BALR  R3,R4                                          ABL FEB86
         LA    R15,64              REINVOKE THIS ROUTINE      ABL FEB86
         B     ISPROUT                                        ABL FEB86
         SPACE 1                                              ABL FEB86
ISPDELP  DS    0H                 DELETE THIS LINE             SS NOV84
         TM    SPFLAG0,SPFMSGER    ANY ERRORS                  SS NOV84
         BO    ISPLERR                                         SS NOV84
ISPDELL  DS    0H                 DELETE THIS LINE             SS NOV84
         BAL   R2,ISPDEL1                                      SS NOV84
         B     ISPLNX             CLEAN UP                     SS NOV84
*                                                              SS NOV84
*  LINE CMD SELECT PANEL DISPLAY SUPPORT (O LINE COMMAND)      SS NOV84
*                                                              SS NOV84
ISPLPND  DS    0H                                              SS NOV84
         CLI   MEM2XATT+1,C' '     IS THIS A GOOD MEMBER       SS NOV84
         BH    ISPLNBAD            CANNOT PROCESS              SS NOV84
         OI    SPFLAG0,SPFCKER     ALSO CHECK FOR ERRORS       SS NOV84
         CLI   MEMLDATA,X'00'      NULLS                       SS NOV84
         BE    ISPLPND3            YES, CONVERT TO BLANKS      SS NOV84
         CLI   MEMLDATA,C'*'       STATUS MESSAGE?             SS NOV84
         BNE   *+10                NO, BRANCH                  SS NOV84
ISPLPND3 DS    0H                                              SS NOV84
         MVC   MEMLDATA(8),ISPBLK8 YES, BLANK IT OUT           SS NOV84
         MVC   MEMLNMSV,MEMLDATA   SAVE FOR PANEL              SS NOV84
         MVC   SPFMEMB,MEMLNAME    SAVE FOR PANEL              SS NOV84
         MVI   SPFVZCMD,C' '             BLANK FIRST           SS NOV84
         MVC   SPFVZCMD+1(249),SPFVZCMD                        SS NOV84
         L     R14,SPFTTPT         RESTORE R14                 SS NOV85
         ST    R14,SPFTTPT2        SAVE TABLE ENTRY            SS NOV85
         TM    $TLF2(R14),#Z       NONDISPL                    SS NOV84
         BO    ISPLPND2            YES                         SS NOV84
         MVC   SPFVZCMD(4),MEM2OPT ANY .MORE                   SS NOV84
         BAL   R2,ISPSHCMD         SET IT UP                   SS NOV84
         CLI   SPFVZCMD,C' '       ANY .MORE                   SS NOV84
         BE    ISPLPND4            NO                          SS NOV84
ISPLPND2 DS    0H                                              SS NOV84
         OI    SPFLAG4,SPFNOND     INVOKE PANEL NON-DISPLAY    SS NOV84
ISPLPND4 DS    0H                                              SS NOV84
         BAL   R2,ISPSETVI                                     SS NOV85
         L     R1,SPFPANT                                      SS NOV84
         ST    R1,SPFPANC          SET CURRENT TO NEW          SS NOV84
         L     R14,SPFTTPT         RESTORE R14                 SS NOV85
         SR    R15,R15                                         SS NOV84
         IC    R15,$TLEX(R14)      GET                         SS NOV84
         AL    R15,ISP$PNA             PANEL                   SS MAR85
         MVC   SPFPSTK(8),0(R15)            NAME               SS NOV84
ISPLPND5 DS    0H                                              SS NOV84
         BAL   R2,ISPPANDI                                     SS NOV85
         CLC   SPFZSEL(4),ISPCEND     END KEY?                 SS NOV84
         BE    ISPLNX                 YES, DONE                SS NOV84
         MVC   SPFINPUT(250),SPFZSEL                           SS NOV84
         MVC   PUTGETBF(4),ISPLEN2                             SS NOV84
         L     R14,SPFTTPT          RESTORE R14                SS NOV85
         MVI   SPFTPOSI,16          USE GENERAL PURPOSE POST   SS NOV84
         OI    SPFTFLG1,SPFTLPOS                               SS NOV85
         TM    $TLF2(R14),#A        RESCAN.. MULTY FUNC PANEL? SS NOV84
         BZ    ISPCMDL              NO, NO CHANGE              SS NOV84
*  RESCAN LINE CMD FROM PANEL                                  SS NOV84
         LA    R1,SPFINPUT                                     SS NOV85
         L     R14,SPFTBPLC  TABLE FOR SEARCH                  SS NOV85
         BAL   R2,ISPVERG           CHECK CMD VERB             SS NOV85
         MVC   SPFTTPT,SPFVTPT      COPY POINTER               SS NOV85
         C     R15,ISPL8            VALID VERB?                SS NOV84
         BH    ISPLNB3              NO, ERROR                  SS NOV84
         TM    $TLF1(R14),#V        VIEW MODE OUTPUT?         ABL DEC84
         BZ    *+8                  NO, BRANCH                ABL DEC84
         OI    SPFLAG3,SPFLOGM      YES, MARK FOR LOGGING     ABL DEC84
*        TM    $TLF2(R14),#H        ALLOWED FROM O LINE CMD?  ABL DEC84
*        BO    ISPLPN2              YES, BRANCH               ABL DEC84
*        TM    $TLF1(R14),#L        VALID LINE COMMAND?        SS NOV84
*        BZ    ISPLNB3              NO, ERROR                  SS NOV84
ISPLPN2  DS    0H                                              SS NOV84
         TM    $TLF1(R14),#S        COMMAND FOR SOURCE ONLY?   SS NOV84
         BZ    ISPLPN3              NO, BRANCH                 SS NOV84
         TM    FLAGSCC,RECFMU       LOAD LIBRARY?              SS NOV84
         BO    ISPLNB3              YES, ERROR                 SS NOV84
         B     ISPLPN4                                         SS NOV84
ISPLPN3  DS    0H                                              SS NOV84
         TM    $TLF1(R14),#U        COMMAND FOR LOAD ONLY?     SS NOV84
         BZ    ISPLPN4              NO, BRANCH                 SS NOV84
         TM    FLAGSCC,RECFMU       LOAD LIBRARY?              SS NOV84
         BZ    ISPLNB3              NO, ERROR                  SS NOV84
ISPLPN4  DS    0H                                              SS NOV84
         TM    $TLF2(R14),#T        INTERNAL CMD OK FROM O     SS NOV85
         BO    ISPLNC5              PROCESS INTERNALLY         SS NOV85
         TM    $TLF1(R14),#V        REVIEW MODE REQUIRED?      SS NOV84
         BO    ISPLPN5              YES, USE GENERAL PURPOSE   SS NOV84
         MVI   SPFTPOSI,32          COME BACK TO PANEL POST PR SS NOV84
ISPLPN5  DS    0H                                              SS NOV84
         TM    $TLF2(R14),#P        DIFFERENT POST PROCESSOR?  SS NOV84
         BZ    ISPCMDL              NO, BRANCH                 SS NOV84
         MVC   SPFTPOSI(1),$TLEX(R14) USE IT                   SS NOV84
         B     ISPCMDL                                         SS NOV84
ISPLPNDP DS    0H                                              SS NOV84
         TM    SPFLAG0,SPFMSGER    ANY ERRORS                  SS NOV84
         BO    ISPLERR                                         SS NOV84
*        LH    R15,$TLMG(R14)      MSG OFFSET                  SS NOV84
*        AL    R15,ISP$TMGA        MSG ADDR                    SS NOV84
*        MVC   MEMLDATA,0(R15)     PUT MSG IN MEMLIST TABLE    SS NOV84
         BAL   R2,ISPLMSGS         PROCESS MESSAGE             SS NOV85
         MVC   MEM2OPT,ISPBLK8     CLEAR OPTION                SS NOV84
         BAL   R2,ISPMEMOD         UPDATE TABLE                SS NOV84
         L     R14,SPFTTPT         RESTORE R14 WITH TABLE ENT  SS NOV85
         TM    $TLF2(R14),#M       UPDATE STATS                SS NOV84
         BO    ISPLSTAT            YES, BRANCH                 SS NOV84
         L     R14,SPFTTPT2        GET SAVED TABLE ENTRY       SS NOV85
         ST    R14,SPFTTPT         RESTORE IT                  SS NOV85
         B     ISPLNV              REENTER MEMLIST DISPLAY    ABL DEC84
*****    B     ISPLPND5            REDISPLAY PANEL             SS NOV84
         SPACE 3                                               SS NOV84
*                                                              SS MAR85
*   STATUS LINE COMMAND                                        SS MAR85
*                                                              SS MAR85
ISPSTAT1 DS    0H                                              SS MAR85
         CLI   MEM2XATT+1,C' '     IS THIS A GOOD MEMBER       SS MAR85
         BH    ISPLNBAD            CANNOT PROCESS              SS MAR85
         MVI   SPFTPOSI,36         SET POST PROCESSING INDEX   SS MAR85
         OI    SPFLAG0,SPFCKER     ALSO CHECK FOR ERRORS       SS MAR85
         MVC   PUTGETBF(4),ISPCMD30                            SS MAR85
         MVC   SPFINPUT(8),$ATT   COPY CMD NAME                SS MAR85
ISPSTAT2 DS    0H                                              SS MAR85
         MVI   SPFINPUT+8,C' '                                 SS MAR85
         MVC   SPFINPUT+9(8),MEMLNAME                          SS MAR85
         MVI   SPFINPUT+17,C' '                                SS MAR85
         CLI   MEMLDATA,C'*'       MSG                         SS MAR85
         BNE   *+10                                           ABL JUN85
         MVC   MEMLDATA(8),ISPBLK8      BLANK IT OUT           SS MAR85
         MVC   SPFINPUT+18(8),MEMLDATA                         SS MAR85
         MVC   MEMLNMSV,MEMLDATA                               SS MAR85
         OI    SPFLAG3,SPFLOGM                                 SS MAR85
         B     ISPCMDL                                         SS MAR85
ISPSTAP2 DS    0H                                              SS MAR85
         TM    SPFLAG0,SPFMSGER    ANY ERRORS                  SS MAR85
         BO    ISPLERR                                         SS MAR85
         MVC   MEMLCCRP,SPFSTART   SAVE LOG POSITION           SS NOV85
         MVI   SPFTPOSI,40         SET POST PROCESSING INDEX   SS MAR85
         OI    SPFLAG0,SPFCKER     ALSO CHECK FOR ERRORS       SS MAR85
         MVC   PUTGETBF(4),ISPCMD30                            SS MAR85
         MVC   SPFINPUT(8),$HIS   COPY CMD NAME                SS MAR85
         B     ISPSTAT2                                        SS MAR85
ISPSTAP3 DS    0H                                              SS MAR85
         TM    SPFLAG0,SPFMSGER    ANY ERRORS                  SS MAR85
         BO    ISPLERR                                         SS MAR85
         MVI   SPFTPOSI,44         SET POST PROCESSING INDEX   SS MAR85
         OI    SPFLAG0,SPFCKER     ALSO CHECK FOR ERRORS       SS MAR85
         MVC   PUTGETBF(4),ISPCMD30                            SS MAR85
         MVC   SPFINPUT(8),$MAP   COPY CMD NAME                SS MAR85
         B     ISPSTAT2                                        SS MAR85
ISPSTAP4 DS    0H                                              SS NOV85
         MVC   SPFSTART,MEMLCCRP                               SS NOV85
         B     ISPGENP            PROCESS AS NORMAL            SS NOV85
         SPACE 3                                               SS NOV84
*                                                              SS MAR85
*   FORMAT UT2 LINE COMMAND                                    SS MAR85
*                                                              SS MAR85
ISPUTL1  DS    0H                                              SS MAR85
         CLI   MEM2XATT+1,C' '     IS THIS A GOOD MEMBER       SS MAR85
         BH    ISPLNBAD            CANNOT PROCESS              SS MAR85
         MVI   SPFTPOSI,16         SET POST PROCESSING INDEX   SS MAR85
         MVC   PUTGETBF(4),ISPCMD30                            SS MAR85
         MVC   SPFINPUT(8),$UT2   COPY CMD NAME                SS MAR85
         MVI   SPFINPUT+8,C' '                                 SS MAR85
         MVC   SPFINPUT+9(8),MEMLNAME  GET MEMBER NAME         SS MAR85
**       MVC   SPFINPUT+17(5),ISPUTDOT INSERT LITERAL UT.     ABL FEB86
         MVI   SPFINPUT+17,X'40'   SEPARATOR CHARACTER        ABL APR86
         TM    $TLF2(R14),#R       IS REAL COMMAND HERE        SS MAR85
         BO    ISPUTL4             YES, USE AFTER UT.          SS MAR85
         LA    R15,$TLCM(R14)      COMMAND NAME                SS JUL85
         B     ISPUTL5             USE IT                      SS MAR85
ISPUTL4  DS    0H                                              SS MAR85
         SR    R15,R15             CLEAR FOR INSERT            SS MAR85
         IC    R15,$TLEX(R14)      GET OFFSET OF REAL CMD      SS MAR85
         LA    R15,ISPREAL(R15)    GET ADDRESS                 SS JUL85
ISPUTL5  DS    0H                                              SS MAR85
         MVC   SPFINPUT+18(4),0(R15) INSERT 4 CHAR OF CMD     ABL APR86
ISPUTL7  DS    0H                                              SS MAR85
         CLI   MEMLDATA,C'*'       MSG                         SS MAR85
         BE    *+10                                            SS MAR85
         MVC   MEMLDATA(8),ISPBLK8      BLANK IT OUT           SS MAR85
         MVC   MEMLNMSV,MEMLDATA   SAVE FOR PANEL USE          SS MAR85
         B     ISPCMDL                                         SS MAR85
         DROP  R4                                              SS NOV85
         TITLE 'ISPF - STACK   LV 1 SUBROUTINE'                SS NOV85
*************************************************************  SS NOV85
*      STACK TABLE PANEL INDEX                                 SS NOV85
*      R1=0 THEN UNSTACK OR POP                                SS NOV85
*      R1=INDEX VALUE THEN PUSH ON TOP                         SS NOV85
*      R1=NEG INDEX VALUE THEN SWAP INDEX                      SS NOV85
*************************************************************  SS NOV85
         SPACE 2
ISPSTACK DS    0H                                              SS NOV85
         USING *,R4                                            SS NOV85
         SPACE 1
         LTR   R1,R1                 ZERO                      SS NOV85
         BM    ISPSTSW               NEG, SWAP                 SS NOV85
         BNZ   ISPSTPU               NO, PUSH                  SS NOV85
ISPSTPP  DS    0H                    POP STACK                 SS NOV85
         L     R2,SPFPANCT           GET TOP OF STACK          SS NOV85
         C     R2,SPFPANTT           AT TOP ALREADY            SS NOV85
         BE    ISPSTTP               RETURN WITH RC=4          SS NOV85
         LA    R1,2                  2 FOR SUBTRACT            SS NOV85
         SR    R2,R1                 BACK UP                   SS NOV85
         ST    R2,SPFPANCT           NET CURRENT TOP           SS NOV85
         LH    R1,0(,R2)             GET INDEX                 SS NOV85
         BCTR  R1,0                  INDEX TO ONE              SS NOV85
         MH    R1,ISPSTHW            TIME LENGTH FOR OFFSET    SS NOV85
         LA    R1,ISPIDX1(R1)        ADDRESS OF ENTRY          SS NOV85
         MVC   SPFTBPI(SPFTBPLN),0(R1) COPY NEW TOP OF STACK   SS NOV85
         B     ISPSTCK               CHECK FOR TABLE CHANGE    SS NOV85
ISPSTSW  DS    0H                    SWAP                      SS NOV85
         LPR   R1,R1                 MAKE POSITIVE             SS NOV85
         CH    R1,ISPSTMX            MAX INDEX                 SS NOV85
         BH    ISPSTEE               BAD INDEX FROM CALLER     SS NOV85
         L     R2,SPFPANCT           CURRENT INDEX             SS NOV85
         STH   R1,0(,R2)             STORE NEW INDEX           SS NOV85
         BCTR  R1,0                  INDEX TO ONE              SS NOV85
         MH    R1,ISPSTHW            TIME LENGTH FOR OFFSET    SS NOV85
         LA    R1,ISPIDX1(R1)        ADDRESS OF ENTRY          SS NOV85
         MVC   SPFTBPI(SPFTBPLN),0(R1) COPY NEW TOP OF STACK   SS NOV85
         B     ISPSTCK               CHECK FOR TABLE CHANGE    SS NOV85
ISPSTPU  DS    0H                    PUSH STACK                SS NOV85
         CH    R1,ISPSTMX            MAX INDEX                 SS NOV85
         BH    ISPSTEE               BAD INDEX FROM CALLER     SS NOV85
         L     R2,SPFPANCT           CURRENT INDEX             SS NOV85
         C     R2,SPFPANBT           AT BOTTOM                 SS NOV85
         BE    ISPSTER               HELP                      SS NOV85
         LA    R2,2(,R2)             NEXT ENTRY                SS NOV85
         ST    R2,SPFPANCT           NEW TOP ENTRY             SS NOV85
         STH   R1,0(,R2)             STORE NEW INDEX           SS NOV85
         BCTR  R1,0                  INDEX TO ONE              SS NOV85
         MH    R1,ISPSTHW            TIME LENGTH FOR OFFSET    SS NOV85
         LA    R1,ISPIDX1(R1)        ADDRESS OF ENTRY          SS NOV85
         MVC   SPFTBPI(SPFTBPLN),0(R1) COPY NEW TOP OF STACK   SS NOV85
         B     ISPSTCK               CHECK FOR TABLE CHANGE    SS NOV85
ISPSTCK  DS    0H                                              SS NOV85
         LH    R15,SPFTBPHM          GET HOME OFFSET           SS NOV85
         LA    R15,SPWRKC(R15)       CALC ADDRESS              SS NOV85
         CL    R15,SPFTHOME          IS IT SAME TABLE          SS NOV85
         BE    ISPSTR0               RETURN                    SS NOV85
         L     R14,SPFTHOME          LOAD ADDRESS              SS NOV85
         MVC   0(SPFTTLN,R14),SPFTBL PUT OLD TABLE BACK        SS NOV85
         MVC   SPFTBL(SPFTTLN),0(R15) FETCH NEW TABLE          SS NOV85
         ST    R15,SPFTHOME          NEW HOME ADDRESS          SS NOV85
ISPSTR0  DS    0H                                              SS NOV85
         SR    R15,R15               ZERO RETURN CODE          SS NOV85
         BR    R3                    RETURN                    SS NOV85
ISPSTTP  DS    0H                    AT TOP                    SS NOV85
         LA    R15,4                 END OF STACK              SS NOV85
         BR    R3                                              SS NOV85
ISPSTER  DS    0H                    TABLE SIZE TO SMALL       SS NOV85
         LA    R15,8                 RAN OUT OF STACK          SS NOV85
         BR    R3                                              SS NOV85
ISPSTEE  DS    0H                    CALLER ERROR              SS NOV85
         LA    R15,12                BAD INDEX                 SS NOV85
         BR    R3                                              SS NOV85
         SPACE 2
* OPT VAR NAME FOR EACH TABLE                                  SS NOV85
ISPSTOPT DC    CL8'MEMLOPT'   00                               SS NOV85
         DC    CL8'PDSAOPT'   08                               SS NOV85
         DC    CL8'PDSVOPT'   16                               SS NOV85
ISPSTHW  DC    AL2(ISPFIDX2-ISPIDX1)   LENGTH  ENTRY           SS NOV85
         DS    0F                                              SS NOV85
         SPACE 3
*         =1    ID   PREV  NEXT  PRINT  (ISPMODE PANEL 1)      SS NOV85
ISPIDX1  DC    H'01',H'00',H'10',H'01'                         SS NOV85
         DC    CL8'&P.PN1'                 PANEL ID            SS NOV85
         DC    AL1(SPFTLOG+SPFTPRI)        FLAGS               SS NOV85
         DC    X'000000'                   FLAGS               SS NOV85
         DC    A(ISP$TLI)                  CMD TABLE           SS NOV85
         DC    A(0)                        LINE CMD TABLD      SS NOV85
         DC    H'00',H'00'    LINE CMD FUNC , FIND INDEX       SS NOV85
         DC    AL2(SPFLOGHM-SPWRKC) TABLE HOME OFFSET          SS NOV85
         DC    AL2(0)               MSG/DATA FIELD OFFSET      SS NOV85
         DC    AL2(0)               CMD SAVE OFFSET            SS NOV85
         DC    AL2(0)               VIEW MODE PANEL INDEX      SS NOV85
         DC    A(0)           ADDRESS OF DEFAULT SORT PARM     SS NOV85
         DC    AL2(0)               OPT FIELD OFFSET           SS NOV85
         DC    AL2(ISPDT1-ISPDT0)   OFFSET TO OUTPUT TITLE    ABL APR86
         DC    A(0)           ADDR OF OPT VAR FOR LINE CMDS    SS NOV85
         SPACE 1
*         =2    ID   PREV  NEXT  PRINT  (VIEW PRIMARY)         SS NOV85
ISPFIDX2 DS    0H                                              SS NOV85
         DC    H'02',H'00',H'14',H'01'                         SS NOV85
         DC    CL8'&P.PN2'                                     SS NOV85
         DC    AL1(SPFTLOG+SPFTMLX)                            SS NOV85
         DC    X'000000'                                       SS NOV85
         DC    A(ISP$TLV)                                      SS NOV85
         DC    A(0)                                            SS NOV85
         DC    H'00',H'00'                                     SS NOV85
         DC    AL2(SPFLOGHM-SPWRKC) TABLE HOME OFFSET          SS NOV85
         DC    AL2(0)               MSG/DATA FIELD OFFSET      SS NOV85
         DC    AL2(0)                                          SS NOV85
         DC    AL2(0)                                          SS NOV85
         DC    A(0)                                            SS NOV85
         DC    AL2(0)                                          SS NOV85
         DC    AL2(ISPDT1-ISPDT0)   OFFSET TO OUTPUT TITLE    ABL APR86
         DC    A(0)                                            SS NOV85
         SPACE 1
*ISPIDX3  =3    ID   PREV  NEXT  PRINT  (CHECKPOINT PANEL)     SS NOV85
         DC    H'03',H'00',H'00',H'01'                         SS NOV85
         DC    CL8'&P.PN3'                                     SS NOV85
         DC    AL1(SPFTLOG)                                    SS NOV85
         DC    X'000000'                                       SS NOV85
         DC    A(ISP$TLC)                                      SS NOV85
         DC    A(0)                                            SS NOV85
         DC    H'00',H'00'                                     SS NOV85
         DC    AL2(SPFLOGHM-SPWRKC) TABLE HOME OFFSET          SS NOV85
         DC    AL2(0)               MSG/DATA FIELD OFFSET      SS NOV85
         DC    AL2(0)                                          SS NOV85
         DC    AL2(0)                                          SS NOV85
         DC    A(0)                                            SS NOV85
         DC    AL2(0)                                          SS NOV85
         DC    AL2(ISPDT1-ISPDT0)   OFFSET TO OUTPUT TITLE    ABL APR86
         DC    A(0)                                            SS NOV85
         SPACE 1
*ISPIDX4  =4    ID   PREV  NEXT  PRINT  (LINE MODE PANEL 1)    SS NOV85
         DC    H'04',H'00',H'12',H'01'                         SS NOV85
         DC    CL8'&P.PN4'                                     SS NOV85
         DC    AL1(SPFTLOG+SPFTMLX)                            SS NOV85
         DC    X'000000'                                       SS NOV85
         DC    A(ISP$TLP)                                      SS NOV85
         DC    A(0)                                            SS NOV85
         DC    H'00',H'00'                                     SS NOV85
         DC    AL2(SPFLOGHM-SPWRKC) TABLE HOME OFFSET          SS NOV85
         DC    AL2(0)               MSG/DATA FIELD OFFSET      SS NOV85
         DC    AL2(0)                                          SS NOV85
         DC    AL2(0)                                          SS NOV85
         DC    A(0)                                            SS NOV85
         DC    AL2(0)                                          SS NOV85
         DC    AL2(ISPDT1-ISPDT0)   OFFSET TO OUTPUT TITLE    ABL APR86
         DC    A(0)                                            SS NOV85
         SPACE 1
*ISPIDX5  =5    ID   PREV  NEXT  PRINT  (MEMLIST SOURCE 1)     SS NOV85
         DC    H'05',H'00',H'06',H'05'                         SS NOV85
         DC    CL8'&P.PN5'                                     SS NOV85
         DC    AL1(SPFTLIN+SPFTMLX+SPFT1CD)                    SS NOV85
         DC    X'000000'                                       SS NOV85
         DC    A(ISP$TLM)                                      SS NOV85
         DC    A(ISP$TLS)                                      SS NOV85
         DC    H'64',H'04'                                     SS NOV85
         DC    AL2(SPFMEMLH-SPWRKC) TABLE HOME OFFSET          SS NOV85
         DC    AL2(MEMLDATA-SPWRKC) MSG/DATA FIELD OFFSET      SS NOV85
         DC    AL2(MEMLSAVZ-SPWRKC) SAVE ZCMD OFFSET           SS NOV85
         DC    H'02'                                           SS NOV85
         DC    A(0)                                            SS NOV85
         DC    AL2(MEMLOPT-SPWRKC)  OPT FIELD OFFSET           SS NOV85
         DC    AL2(ISPDT5-ISPDT0)   OFFSET TO OUTPUT TITLE    ABL APR86
         DC    A(ISPSTOPT+00)                                  SS NOV85
         SPACE 1
*ISPIDX6  =6    ID   PREV  NEXT  PRINT  (MEMLIST SOURCE 2)     SS NOV85
         DC    H'06',H'05',H'05',H'06'                         SS NOV85
         DC    CL8'&P.PN6'                                     SS NOV85
         DC    AL1(SPFTLIN+SPFTMLX+SPFT1CD)                    SS NOV85
         DC    X'000000'                                       SS NOV85
         DC    A(ISP$TLM)                                      SS NOV85
         DC    A(ISP$TLS)                                      SS NOV85
         DC    H'64',H'04'                                     SS NOV85
         DC    AL2(SPFMEMLH-SPWRKC) TABLE HOME OFFSET          SS NOV85
         DC    AL2(MEMLDATA-SPWRKC) MSG/DATA FIELD OFFSET      SS NOV85
         DC    AL2(MEMLSAVZ-SPWRKC) SAVE ZCMD OFFSET           SS NOV85
         DC    H'02'                                           SS NOV85
         DC    A(0)                                            SS NOV85
         DC    AL2(MEMLOPT-SPWRKC)  OPT FIELD OFFSET           SS NOV85
         DC    AL2(ISPDT6-ISPDT0)   OFFSET TO OUTPUT TITLE    ABL APR86
         DC    A(ISPSTOPT+00)                                  SS NOV85
         SPACE 1
*ISPIDX7  =7    ID   PREV  NEXT  PRINT  (MEMLIST LOAD 1)       SS NOV85
         DC    H'07',H'00',H'08',H'07'                         SS NOV85
         DC    CL8'&P.PN7'                                     SS NOV85
         DC    AL1(SPFTLIN+SPFTMLX+SPFT2CD)                    SS NOV85
         DC    X'000000'                                       SS NOV85
         DC    A(ISP$TLM)                                      SS NOV85
         DC    A(ISP$TLL)                                      SS NOV85
         DC    H'64',H'08'                                     SS NOV85
         DC    AL2(SPFMEMLH-SPWRKC) TABLE HOME OFFSET          SS NOV85
         DC    AL2(MEMLDATA-SPWRKC) MSG/DATA FIELD OFFSET      SS NOV85
         DC    AL2(MEMLSAVZ-SPWRKC) SAVE ZCMD OFFSET           SS NOV85
         DC    H'02'                                           SS NOV85
         DC    A(0)                                            SS NOV85
         DC    AL2(MEMLOPT-SPWRKC)  OPT FIELD OFFSET           SS NOV85
         DC    AL2(ISPDT7-ISPDT0)   OFFSET TO OUTPUT TITLE    ABL APR86
         DC    A(ISPSTOPT+00)                                  SS NOV85
         SPACE 1
*ISPIDX8  =8    ID   PREV  NEXT  PRINT  (MEMLIST LOAD 2)       SS NOV85
         DC    H'08',H'07',H'13',H'08'                         SS NOV85
         DC    CL8'&P.PN8'                                     SS NOV85
         DC    AL1(SPFTLIN+SPFTMLX+SPFT2CD)                    SS NOV85
         DC    X'000000'                                       SS NOV85
         DC    A(ISP$TLM)                                      SS NOV85
         DC    A(ISP$TLL)                                      SS NOV85
         DC    H'64',H'08'                                     SS NOV85
         DC    AL2(SPFMEMLH-SPWRKC) TABLE HOME OFFSET          SS NOV85
         DC    AL2(MEMLDATA-SPWRKC) MSG/DATA FIELD OFFSET      SS NOV85
         DC    AL2(MEMLSAVZ-SPWRKC) SAVE ZCMD OFFSET           SS NOV85
         DC    H'02'                                           SS NOV85
         DC    A(0)                                            SS NOV85
         DC    AL2(MEMLOPT-SPWRKC)  OPT FIELD OFFSET           SS NOV85
         DC    AL2(ISPDT8-ISPDT0)   OFFSET TO OUTPUT TITLE    ABL APR86
         DC    A(ISPSTOPT+00)                                  SS NOV85
         SPACE 1
*ISPIDX9  =9    ID   PREV  NEXT  PRINT  (PDS YES/NO PROMPT)    SS NOV85
         DC    H'09',H'00',H'00',H'01'                         SS NOV85
         DC    CL8'&P.PN9'                                     SS NOV85
         DC    AL1(SPFTLOG)
         DC    AL1(SPFTREP)             REPLY PANEL           ABL APR86
         DC    X'0000'                                        ABL APR86
         DC    A(ISP$TLR)                                      SS NOV85
         DC    A(0)                                            SS NOV85
         DC    H'00',H'00'                                     SS NOV85
         DC    AL2(SPFLOGHM-SPWRKC) TABLE HOME OFFSET          SS NOV85
         DC    AL2(0)                                          SS NOV85
         DC    AL2(0)                                          SS NOV85
         DC    AL2(0)                                          SS NOV85
         DC    A(0)                                            SS NOV85
         DC    AL2(0)                                          SS NOV85
         DC    AL2(ISPDT1-ISPDT0)   OFFSET TO OUTPUT TITLE    ABL APR86
         DC    A(0)                                            SS NOV85
         SPACE 1
*ISPIDX10 =A    ID   PREV  NEXT  PRINT  (ISPMODE PANEL 2)      SS NOV85
         DC    H'10',H'00',H'01',H'01'                         SS NOV85
         DC    CL8'&P.PNA'                                     SS NOV85
         DC    AL1(SPFTLOG+SPFTPRI)                            SS NOV85
         DC    X'000000'                                       SS NOV85
         DC    A(ISP$TLI)                                      SS NOV85
         DC    A(0)                                            SS NOV85
         DC    H'00',H'00'                                     SS NOV85
         DC    AL2(SPFLOGHM-SPWRKC) TABLE HOME OFFSET          SS NOV85
         DC    AL2(0)                                          SS NOV85
         DC    AL2(0)                                          SS NOV85
         DC    AL2(0)                                          SS NOV85
         DC    A(0)                                            SS NOV85
         DC    AL2(0)                                          SS NOV85
         DC    AL2(ISPDT1-ISPDT0)   OFFSET TO OUTPUT TITLE    ABL APR86
         DC    A(0)                                            SS NOV85
         SPACE 1
*ISPIDX11 =B    ID   PREV  NEXT  PRINT  (ISPMODE PANEL ?)      SS NOV85
         DC    H'11',H'00',H'10',H'01'                         SS NOV85
         DC    CL8'&P.PNB'                                     SS NOV85
         DC    AL1(SPFTLOG+SPFTPRI)                            SS NOV85
         DC    X'000000'                                       SS NOV85
         DC    A(ISP$TLI)                                      SS NOV85
         DC    A(0)                                            SS NOV85
         DC    H'00',H'00'                                     SS NOV85
         DC    AL2(SPFLOGHM-SPWRKC) TABLE HOME OFFSET          SS NOV85
         DC    AL2(0)                                          SS NOV85
         DC    AL2(0)                                          SS NOV85
         DC    AL2(0)                                          SS NOV85
         DC    A(0)                                            SS NOV85
         DC    AL2(0)                                          SS NOV85
         DC    AL2(ISPDT1-ISPDT0)   OFFSET TO OUTPUT TITLE    ABL APR86
         DC    A(0)                                            SS NOV85
         SPACE 1
*ISPIDX12 =C    ID   PREV  NEXT  PRINT  (LINE MODE PANEL 2)    SS NOV85
         DC    H'12',H'00',H'04',H'01'                         SS NOV85
         DC    CL8'&P.PNC'                                     SS NOV85
         DC    AL1(SPFTLOG+SPFTMLX)                            SS NOV85
         DC    X'000000'                                       SS NOV85
         DC    A(ISP$TLP)                                      SS NOV85
         DC    A(0)                                            SS NOV85
         DC    H'00',H'00'                                     SS NOV85
         DC    AL2(SPFLOGHM-SPWRKC) TABLE HOME OFFSET          SS NOV85
         DC    AL2(0)                                          SS NOV85
         DC    AL2(0)                                          SS NOV85
         DC    AL2(0)                                          SS NOV85
         DC    A(0)                                            SS NOV85
         DC    AL2(0)                                          SS NOV85
         DC    AL2(ISPDT1-ISPDT0)   OFFSET TO OUTPUT TITLE    ABL APR86
         DC    A(0)                                            SS NOV85
         SPACE 1
*ISPIDX13 =D    ID   PREV  NEXT  PRINT  (MEMLIST LOAD 3)       SS NOV85
         DC    H'13',H'08',H'07',H'13'                        ABL APR86
         DC    CL8'&P.PND'                                     SS NOV85
         DC    AL1(SPFTLIN+SPFTMLX+SPFT2CD)                    SS NOV85
         DC    X'000000'                                       SS NOV85
         DC    A(ISP$TLM)                                      SS NOV85
         DC    A(ISP$TLL)                                      SS NOV85
         DC    H'64',H'08'                                     SS NOV85
         DC    AL2(SPFMEMLH-SPWRKC) TABLE HOME OFFSET          SS NOV85
         DC    AL2(MEMLDATA-SPWRKC) MSG/DATA FIELD OFFSET      SS NOV85
         DC    AL2(MEMLSAVZ-SPWRKC) SAVE ZCMD OFFSET           SS NOV85
         DC    H'02'                                           SS NOV85
         DC    A(0)                                            SS NOV85
         DC    AL2(MEMLOPT-SPWRKC)  OPT FIELD OFFSET           SS NOV85
         DC    AL2(ISPDTD-ISPDT0)   OFFSET TO OUTPUT TITLE    ABL APR86
         DC    A(0)                                            SS NOV85
         SPACE 1
*ISPIDX14 =E    ID   PREV  NEXT  PRINT  (VIEW PANEL 2)         SS NOV85
         DC    H'14',H'00',H'02',H'01'                         SS NOV85
         DC    CL8'&P.PNE'                                     SS NOV85
         DC    AL1(SPFTLOG+SPFTMLX)                            SS NOV85
         DC    X'000000'                                       SS NOV85
         DC    A(ISP$TLV)                                      SS NOV85
         DC    A(0)                                            SS NOV85
         DC    H'00',H'00'                                     SS NOV85
         DC    AL2(SPFLOGHM-SPWRKC) TABLE HOME OFFSET          SS NOV85
         DC    AL2(0)                                          SS NOV85
         DC    AL2(0)                                          SS NOV85
         DC    AL2(0)                                          SS NOV85
         DC    A(0)                                            SS NOV85
         DC    AL2(0)                                          SS NOV85
         DC    AL2(ISPDT1-ISPDT0)   OFFSET TO OUTPUT TITLE    ABL APR86
         DC    A(0)                                            SS NOV85
         SPACE 1
*ISPIDX15 =F    ID   PREV  NEXT  PRINT  (LISTA PANEL 1)        SS NOV85
         DC    H'15',H'00',H'16',H'15'                        ABL APR86
         DC    CL8'&P.PNF'                                     SS NOV85
         DC    AL1(SPFTLIN)                                    SS NOV85
         DC    X'000000'                                       SS NOV85
         DC    A(ISP$TLAA)                                     SS NOV85
         DC    A(ISP$TLAL)                                     SS NOV85
         DC    H'152',H'12'                                    SS NOV85
         DC    AL2(SPFLISTA-SPWRKC) TABLE HOME OFFSET          SS NOV85
         DC    AL2(SPFADATA-SPWRKC) MSG/DATA FIELD OFFSET      SS NOV85
         DC    AL2(SPFASAVZ-SPWRKC) SAVE ZCMD OFFSET           SS NOV85
         DC    H'02'                                           SS NOV85
         DC    A(0)                                            SS NOV85
         DC    AL2(SPFAOPT-SPWRKC)  OPT FIELD OFFSET           SS NOV85
         DC    AL2(ISPDTF-ISPDT0)   OFFSET TO OUTPUT TITLE    ABL APR86
         DC    A(ISPSTOPT+08)                                  SS NOV85
         SPACE 1
*ISPIDX16 =G    ID   PREV  NEXT  PRINT  (LISTA PANEL 2)        SS NOV85
         DC    H'16',H'00',H'15',H'16'                        ABL APR86
         DC    CL8'&P.PNG'                                     SS NOV85
         DC    AL1(SPFTLIN)                                    SS NOV85
         DC    X'000000'                                       SS NOV85
         DC    A(ISP$TLAA)                                     SS NOV85
         DC    A(ISP$TLAL)                                     SS NOV85
         DC    H'152',H'12'                                    SS NOV85
         DC    AL2(SPFLISTA-SPWRKC) TABLE HOME OFFSET          SS NOV85
         DC    AL2(SPFADATA-SPWRKC) MSG/DATA FIELD OFFSET      SS NOV85
         DC    AL2(SPFASAVZ-SPWRKC) SAVE ZCMD OFFSET           SS NOV85
         DC    H'02'                                           SS NOV85
         DC    A(0)                                            SS NOV85
         DC    AL2(SPFAOPT-SPWRKC)  OPT FIELD OFFSET           SS NOV85
         DC    AL2(ISPDTG-ISPDT0)   OFFSET TO OUTPUT TITLE    ABL APR86
         DC    A(ISPSTOPT+08)                                  SS NOV85
         SPACE 1
*ISPIDX17 =H    ID   PREV  NEXT  PRINT  (LISTV PANEL 1)        SS NOV85
         DC    H'17',H'00',H'18',H'17'                        ABL APR86
         DC    CL8'&P.PNH'                                     SS NOV85
         DC    AL1(SPFTLIN)                                    SS NOV85
         DC    X'000000'                                       SS NOV85
         DC    A(ISP$TLVV)                                     SS NOV85
         DC    A(ISP$TLVL)                                     SS NOV85
         DC    H'152',H'16'                                    SS NOV85
         DC    AL2(SPFLISTV-SPWRKC) TABLE HOME OFFSET          SS NOV85
         DC    AL2(SPFVDATA-SPWRKC) MSG/DATA FIELD OFFSET      SS NOV85
         DC    AL2(SPFVSAVZ-SPWRKC) SAVE ZCMD OFFSET           SS NOV85
         DC    H'02'                                           SS NOV85
         DC    A(0)                                            SS NOV85
         DC    AL2(SPFVOPT-SPWRKC)  OPT FIELD OFFSET           SS NOV85
         DC    AL2(ISPDTH-ISPDT0)   OFFSET TO OUTPUT TITLE    ABL APR86
         DC    A(ISPSTOPT+16)                                  SS NOV85
         SPACE 1
*ISPIDX18 =I    ID   PREV  NEXT  PRINT  (LISTV PANEL 2)        SS NOV85
         DC    H'18',H'00',H'17',H'18'                        ABL APR86
         DC    CL8'&P.PNI'                                     SS NOV85
         DC    AL1(SPFTLIN)                                    SS NOV85
         DC    X'000000'                                       SS NOV85
         DC    A(ISP$TLVV)                                     SS NOV85
         DC    A(ISP$TLVL)                                     SS NOV85
         DC    H'152',H'16'                                    SS NOV85
         DC    AL2(SPFLISTV-SPWRKC) TABLE HOME OFFSET          SS NOV85
         DC    AL2(SPFVDATA-SPWRKC) MSG/DATA FIELD OFFSET      SS NOV85
         DC    AL2(SPFVSAVZ-SPWRKC) SAVE ZCMD OFFSET           SS NOV85
         DC    H'02'                                           SS NOV85
         DC    A(0)                                            SS NOV85
         DC    AL2(SPFVOPT-SPWRKC)  OPT FIELD OFFSET           SS NOV85
         DC    AL2(ISPDTI-ISPDT0)   OFFSET TO OUTPUT TITLE    ABL APR86
         DC    A(ISPSTOPT+16)                                  SS NOV85
         SPACE 3                                               SS NOV85
ISPSTMX  DC    H'18'            MAX INDEX                      SS NOV85
         TITLE 'LISTA AND LISTV FUNCTIONS'                     SS NOV85
*************************************************************  SS NOV85
*                                                              SS NOV85
*      LISTA  FUNCTION                                         SS NOV85
*                                                              SS NOV85
*************************************************************  SS NOV85
         SPACE 2
ISPLISTA DS    0H                                              SS NOV85
         USING *,R4                                            SS NOV85
         SPACE 1
* DO VDEF                                                      SS NOV85
         LA    R1,ISPLSTAV        DEF VAR TABLE                SS NOV85
         BAL   R2,ISPVDEFX                                     SS NOV85
* STACK 15                                                     SS NOV85
         CLC   ISPLSTAH,SPFTBPHM  SAME TABLE                   SS NOV85
         BE    ISPLSTAR           YES,  RESET TABLE            SS NOV85
         LA    R1,15              PANEL E                      SS NOV85
         BAL   R2,ISPSTKI         STACK IT                     SS NOV85
         B     ISPLSTAO           OPEN                         SS NOV85
ISPLSTAH DC    AL2(SPFLISTA-SPWRKC) HOME ADDRESS OFFSET        SS NOV85
ISPLSTAR DS    0H                                              SS NOV85
* RESET TB IF OPEN                                             SS NOV85
         BAL   R2,ISPTBEND                                     SS NOV85
ISPLSTAO DS    0H                                              SS NOV85
* OPEN TB                                                      SS NOV85
         MVC   SPFTBL,SPFCSUF    GET BASE NAME                 SS NOV85
         MVI   SPFTBL+2,C'A'     SET TO PDA                    SS NOV85
         XC    SPFTFLG1(4),SPFTFLG1                            SS NOV85
         XC    SPFTFF(2),SPFTFF                                SS NOV85
         LA    R15,0             NO KEY                        SS NOV85
         LA    R0,ISPLSTAN       VER NAMES                     SS NOV85
         BAL   R2,ISPTBOPN                                     SS NOV85
* SET UP DSAB SCAN                                             SS NOV85
         L     R2,16              CVT                          SS NOV85
         L     R2,0(,R2)          ACT TCB PT                   SS NOV85
         L     R2,4(,R2)          ACT TCB                      SS NOV85
         L     R2,TCBJSCB-TCBRBP(R2)     JSCB                  SS NOV85
         L     R2,JSCDSABQ-IEZJSCB(R2)   DSAB QUE              SS NOV85
         L     R2,12(,R2)                FIRST DSAB            SS NOV85
         ST    R2,SPFATMP1               SAVE TEMP             SS NOV85
* ADD DDN ENTRIES                                              SS NOV85
ISPLSTAL DS    0H                                              SS NOV85
         L     R2,SPFATMP1                                     SS NOV85
         LTR   R2,R2                                           SS NOV85
         BZ    ISPLSTAX           EXIT                         SS NOV85
         USING DSAB,R2                                         SS NOV85
         MVC   SPFAOPT,ISPBLK8                                 SS NOV85
         MVC   SPFADATA,ISPBLK8                                SS NOV85
         XC    SPFATFLG,SPFATFLG                               SS NOV85
         SR    R1,R1                                           SS NOV85
         ICM   R1,7,DSABSSVA     SIOT                          SS NOV85
         LA    R1,16(,R1)        OVER SWA HEADER               SS NOV85
         USING INDMSIOT,R1                                     SS NOV85
         MVC   SPFACLS,SCTOUTPN    SAVE SYSOUT CLASS           SS NOV85
         TM    SCTSBYT1,SCTDUMMY   DUMMY DATASET               SS NOV85
         BZ    *+8                                             SS NOV85
         OI    SPFATFLG,SPFANUCB   NO UCB                      SS NOV85
         TM    SCTSBYT2,SIOTCATL   CATALOG DATASET             SS NOV85
         BZ    ISPLSTA7                                        SS NOV85
         OI    SPFATFLG,SPFATYSE   GOT TYPE                    SS NOV85
         MVC   SPFATYPE,=C'CTLG'                               SS NOV85
ISPLSTA7 DS    0H                                              SS NOV85
         MVC   SPFADISP(8),ISPBLK8  CLEAR DISP AND CDSP        SS NOV85
         TM    SCTSDISP,X'10'                                  SS NOV85
         BZ    *+10                                            SS NOV85
         MVC   SPFADISP,=C'PASS'                               SS NOV85
         TM    SCTSDISP,X'08'                                  SS NOV85
         BZ    *+10                                            SS NOV85
         MVC   SPFADISP,=C'KEEP'                               SS NOV85
         TM    SCTSDISP,X'04'                                  SS NOV85
         BZ    *+10                                            SS NOV85
         MVC   SPFADISP,=C'DLET'                               SS NOV85
         TM    SCTSDISP,X'02'                                  SS NOV85
         BZ    *+10                                            SS NOV85
         MVC   SPFADISP,=C'CTLG'                               SS NOV85
         TM    SCTSDISP,X'01'                                  SS NOV85
         BZ    *+10                                            SS NOV85
         MVC   SPFADISP,=C'UNCT'                               SS NOV85
         TM    SIOTALTD,X'08'                                  SS NOV85
         BZ    *+10                                            SS NOV85
         MVC   SPFAADSP,=C'KEEP'                               SS NOV85
         TM    SIOTALTD,X'04'                                  SS NOV85
         BZ    *+10                                            SS NOV85
         MVC   SPFAADSP,=C'DLET'                               SS NOV85
         TM    SIOTALTD,X'02'                                  SS NOV85
         BZ    *+10                                            SS NOV85
         MVC   SPFAADSP,=C'CTLG'                               SS NOV85
         TM    SIOTALTD,X'01'                                  SS NOV85
         BZ    *+10                                            SS NOV85
         MVC   SPFAADSP,=C'UNCT'                               SS NOV85
* GET DISP AND CDSP FROM SIOT                                  SS NOV85
         L     R1,DSABTIOT                                     SS NOV85
         USING TIOENTRY,R1                                     SS NOV85
         ST    R1,SPFATMP2        SAVE TIOT ADDR               SS NOV85
         ICM   R0,B'1110',DSABFLG1    FLAGS                    SS NOV85
         ICM   R0,B'0001',TIOELINK    FLAGS                    SS NOV85
         LR    R1,R0                                           SS NOV85
         BAL   R2,ISPHEXCV                                     SS NOV85
         MVC   SPFAFLAG(8),SPFHEXCV                            SS NOV85
         L     R2,SPFATMP1                                     SS NOV85
         MVC   SPFAOCNT,ISPBLK8                                SS NOV85
         LH    R1,DSABOPCT        OPEN COUNT                   SS NOV85
         CH    R1,=H'9'                                        SS NOV85
         BH    ISPLSTA9                                        SS NOV85
         MVC   SPFAOCNT(1),DSABOPCT+1   MOVE NUMBER            SS NOV85
         OI    SPFAOCNT,X'F0'           FIX NUMBERIC ZONE      SS NOV85
         B     *+8                                             SS NOV85
ISPLSTA9 MVI   SPFAOCNT,C'*'           ALLOC OVER 9            SS NOV85
         L     R2,SPFATMP1                                     SS NOV85
         TM    SPFATFLG,SPFATYSE                               SS NOV85
         BO    ISPLSTA8                                        SS NOV85
         LA    R1,DSABORG         DSORG                        SS NOV85
         BAL   R2,ISPDSORG                                     SS NOV85
         STCM  R0,15,SPFATYPE                                  SS NOV85
ISPLSTA8 DS    0H                                              SS NOV85
         L     R1,SPFATMP2        TIOT ENT ADDR                SS NOV85
         MVC   SPFADDNM,TIOEDDNM                               SS NOV85
         SR    R2,R2                                           SS NOV85
         ICM   R2,7,TIOEJFCB                                   SS NOV85
         LA    R2,16(,R2)        OVER HEADER                   SS NOV85
         MVC   SPFADSN,JFCBDSNM-JFCB(R2)                       SS NOV85
         MVC   SPFAMEM,JFCBELNM-JFCB(R2)                       SS NOV85
         TM    JFCBIND2-JFCB(R2),JFCNEW                        SS NOV85
         BZ    *+10                                            SS NOV85
         MVC   SPFAALLC,=C'NEW '                               SS NOV85
         TM    JFCBIND2-JFCB(R2),JFCMOD                        SS NOV85
         BZ    *+10                                            SS NOV85
         MVC   SPFAALLC,=C'MOD '                               SS NOV85
         TM    JFCBIND2-JFCB(R2),JFCOLD                        SS NOV85
         BZ    *+10                                            SS NOV85
         MVC   SPFAALLC,=C'OLD '                               SS NOV85
         TM    JFCBIND2-JFCB(R2),JFCSHARE                      SS NOV85
         BZ    *+10                                            SS NOV85
         MVC   SPFAALLC,=C'SHR '                               SS NOV85
         TM    JFCBIND2-JFCB(R2),JFCTEMP                       SS NOV85
         BZ    *+10                                            SS NOV85
         MVC   SPFAALLC,=C'TMP '                               SS NOV85
         L     R2,SPFATMP1        GET DSAB                     SS NOV85
         MVC   SPFASTAT,ISPBLK8                                SS NOV85
         TM    DSABFLG1,DSABPALC  PERMINENT                    SS NOV85
         BZ    *+10                                            SS NOV85
         MVC   SPFASTAT,=C'PRM '                               SS NOV85
         TM    DSABFLG1,DSABCONV  CONVERTABLE                  SS NOV85
         BZ    *+10                                            SS NOV85
         MVC   SPFASTAT,=C'CNV '                               SS NOV85
         TM    DSABFLG3,DSABVAM   VIO                          SS NOV85
         BZ    ISPLATAA                                        SS NOV85
         MVC   SPFATYPE,=C'VIO '                               SS NOV85
         OI    SPFATFLG,SPFANUCB+SPFATYSE                      SS NOV85
         B     ISPLSTA5                                        SS NOV85
ISPLATAA DS    0H                                              SS NOV85
         TM    DSABFLG3,DSABCATL  THIS A CATALOG               SS NOV85
         BZ    ISPLATAB                                        SS NOV85
         MVC   SPFATYPE,=C'CTLG'                               SS NOV85
         OI    SPFATFLG,SPFATYSE                               SS NOV85
         B     ISPLSTA2                                        SS NOV85
ISPLATAB DS    0H                                              SS NOV85
         TM    DSABFLG3,DSABVVDS  THIS A CATALOG               SS NOV85
         BZ    ISPLATAC                                        SS NOV85
         MVC   SPFATYPE,=C'VVDS'                               SS NOV85
         OI    SPFATFLG,SPFATYSE                               SS NOV85
         B     ISPLSTA2                                        SS NOV85
ISPLATAC DS    0H                                              SS NOV85
         TM    TIOELINK,TIOESYOT  SYSOUT                       SS NOV85
         BZ    ISPLSTA1           NO TRY TERM                  SS NOV85
         MVC   SPFATYPE,=C'JES '                               SS NOV85
         OI    SPFATFLG,SPFANUCB+SPFATYSE                      SS NOV85
         MVC   SPFAVOL,=CL6'CLS='                              SS NOV85
         MVC   SPFAVOL+5(1),SPFACLS                            SS NOV85
         B     ISPLSTA4                                        SS NOV85
ISPLSTA1 DS    0H                                              SS NOV85
         TM    TIOELINK,TIOTTERM                               SS NOV85
         BZ    ISPLSTA2                                        SS NOV85
         OI    SPFATFLG,SPFANUCB+SPFATYSE                      SS NOV85
         MVC   SPFATYPE,=C'TERM'                               SS NOV85
         B     ISPLSTA5                                        SS NOV85
ISPLSTA2 DS    0H                                              SS NOV85
         CLC   SPFADSN(8),=C'NULLFILE'                         SS NOV85
         BE    ISPLSTA5                                        SS NOV85
         TM    SPFATFLG,SPFANUCB                               SS NOV85
         BO    ISPLSTA5                                        SS NOV85
         SR    R2,R2                                           SS NOV85
         IC    R2,TIOELNGH                                     SS NOV85
         CH    R2,=H'20'         ONE DEV ENTRY LONG            SS NOV85
         BH    ISPLSTA3                                        SS NOV85
         SR    R2,R2                                           SS NOV85
         ICM   R2,7,TIOEFSRT     UCB ADDR                      SS NOV85
         MVC   SPFAVOL,UCBVOLI-UCBOB(R2) GET VOLUME            SS NOV85
         B     ISPLSTA4                                        SS NOV85
ISPLSTA5 MVC   SPFAVOL,ISPBLK8                                 SS NOV85
         B     ISPLSTA4                                        SS NOV85
ISPLSTA3 MVC   SPFAVOL,=C'*MULT*'                              SS NOV85
ISPLSTA4 DS    0H                                              SS NOV85
         L     R2,SPFATMP1       RESET DSAB ADDR               SS NOV85
         SR    R1,R1                                           SS NOV85
         ICM   R1,7,DSABSSVA     SIOT                          SS NOV85
         BAL   R2,ISPTBADD                                     SS NOV85
         L     R2,SPFATMP1       RESET DSAB ADDR               SS NOV85
         L     R2,DSABFCHN                                     SS NOV85
         ST    R2,SPFATMP1       NEW   DSAB ADDR               SS NOV85
         B     ISPLSTAL          LOOP TO TOP                   SS NOV85
* RETURN TO TBDISPL                                            SS NOV85
ISPLSTAX DS    0H                                              SS NOV85
         LA    R15,1                                           SS NOV85
         ST    R15,SPFTTOP                                     SS NOV85
         BAL   R2,ISPTOP                                       SS NOV85
         LA    R15,100           GO TO TBDISPL                 SS NOV85
         BR    R3                                              SS NOV85
         DROP  R1,R2                                           SS NOV85
ISPLSTAE DS    0H                                              SS NOV85
         LA    R15,28       INVALID                            SS NOV85
         BR    R3                                              SS NOV85
         LTORG ,                                               SS NOV85
         DS    0F                                              SS NOV85
ISPLSTAV DC    H'0',X'10',X'00'                                SS NOV85
         DC    A(VSPFADDN),AL2(SPFADDNM-SPWRKC),H'08'          SS NOV85
         DC    A(VSPFADSN),AL2(SPFADSN-SPWRKC),H'44'           SS NOV85
         DC    A(VSPFAVOL),AL2(SPFAVOL-SPWRKC),H'06'           SS NOV85
         DC    A(VSPFADSB),AL2(SPFADSAB-SPWRKC),H'04'          SS NOV85
         DC    A(VSPFAFLG),AL2(SPFAFLAG-SPWRKC),H'08'          SS NOV85
         DC    X'FF'                                           SS NOV85
VSPFADDN DC    C'(PDSADDN PDSADATA PDSAMEM)'                   SS NOV85
VSPFADSN DC    C'PDSADSN '                                     SS NOV85
VSPFAVOL DC    C'PDSAVOL '                                     SS NOV85
VSPFADSB DC    C'(PDSADSAB PDSAOPT PDSATYPE PDSADISP PDSACDSP PDSAOCNT X
               PDSAALLC PDSASTAT)'                             SS NOV85
VSPFAFLG DC    C'PDSAFLAG '                                    SS NOV85
ISPLSTAN DC    C'(PDSAOPT PDSADDN PDSADATA PDSADSAB PDSATYPE PDSADISP  X
               PDSACDSP PDSAOCNT PDSAFLAG PDSAFLAG PDSAVOL PDSADSN     X
               PDSAMEM PDSAALLC PDSASTAT)'                     SS NOV85
         SPACE 2
*************************************************************  SS NOV85
*                                                              SS NOV85
*      LISTV  FUNCTION                                         SS NOV85
*                                                              SS NOV85
*************************************************************  SS NOV85
         SPACE 2
ISPLISTV DS    0H                                              SS NOV85
         USING *,R4                                            SS NOV85
         SPACE 1
*  DO PARSE ON LISTV COMMAND                                   SS NOV85
         L     R15,SPFOPER      FIRST BLANK AFTER CMD          SS NOV85
         LA    R14,30           MAX LENGTH                     SS NOV85
         LA    R1,ISPLSTVP      PARSE LIST                     SS NOV85
         BAL   R2,ISPPARSI      PARSE IT                       SS NOV85
         C     R15,ISPL8        RETURN CODE                    SS NOV85
         BH    ISPLSTVE         ERROR                         ABL APR86
         BE    ISPLSTVQ         NO OPTIONS                     SS NOV85
         TM    SPFPRBI,X'80'+X'40'  ADDR AND GROUP             SS NOV85
         BO    ISPLSTVK         BOTH ON, CONFLICT              SS NOV85
* CHECK FOR RANGE ON STRING LENGTH 2 OR 5 FOR ADDR OR VOL/GRP  SS NOV85
         LH    R1,SPFPRLN       GET LENGTH                     SS NOV85
         TM    SPFPRBI,X'40'    GROUP                          SS NOV85
         BZ    ISPLSTV2         NO                             SS NOV85
         CH    R1,=H'7'                                        SS NOV85
         BH    ISPLSTVW                                        SS NOV85
         B     ISPLSTV3                                        SS NOV85
ISPLSTV2 DS    0H                                              SS NOV85
         CH    R1,=H'5'         MAX                            SS NOV85
         BH    ISPLSTVW                                        SS NOV85
         TM    SPFPRBI,X'80'    BY ADDRESS                     SS NOV85
         BZ    *+12                                            SS NOV85
         CH    R1,=H'2'         MUST BE LESS                   SS NOV85
         BH    ISPLSTVW                                        SS NOV85
ISPLSTV3 DS    0H                                              SS NOV85
         L     R14,SPFPRSR         STRING ADDRESS              SS NOV85
         OC    0(0,R14),ISPBLK8    <<EXECUTED>>                SS NOV85
         EX    R1,*-6              FORCE UPPER CASE            SS NOV85
* DO VDEF                                                      SS NOV85
         LA    R1,ISPLSTVV        DEF VAR TABLE                SS NOV85
         BAL   R2,ISPVDEFX                                     SS NOV85
* STACK 17                                                     SS NOV85
         CLC   ISPLSTVH,SPFTBPHM  SAME TABLE                   SS NOV85
         BE    ISPLSTVR           YES,  RESET TABLE            SS NOV85
         LA    R1,17              PANEL H                      SS NOV85
         BAL   R2,ISPSTKI         STACK IT                     SS NOV85
         B     ISPLSTVO           OPEN                         SS NOV85
ISPLSTVH DC    AL2(SPFLISTV-SPWRKC) HOME ADDRESS OFFSET        SS NOV85
ISPLSTVR DS    0H                                              SS NOV85
*  RESET TB IS OPEN AND RESET OPTION                           SS NOV85
         TM    SPFPRBI,X'08'      RESET REQUEST                SS NOV85
         BZ    ISPLSTV1           NO, SKIP END AND OPEN        SS NOV85
         BAL   R2,ISPTBEND                                     SS NOV85
ISPLSTVO DS    0H                                              SS NOV85
* OPEN TB                                                      SS NOV85
         MVC   SPFTBL,SPFCSUF    GET BASE NAME                 SS NOV85
         MVI   SPFTBL+2,C'V'     SET TO PDV                    SS NOV85
         XC    SPFTFLG1(4),SPFTFLG1                            SS NOV85
         XC    SPFTFF(2),SPFTFF                                SS NOV85
         LA    R15,VSPFVVOL      VOL IS KEY                    SS NOV85
         LA    R0,ISPLSTVN       VER NAMES                     SS NOV85
         BAL   R2,ISPTBOPN                                     SS NOV85
         LA    R15,1                                           SS NOV85
         ST    R15,SPFTTOP                                     SS NOV85
         OI    SPFPRBI2,X'80'    TERMINATE IF NO VOLUME FOUND ABL APR86
*  SET UP UCB SCAN                                             SS NOV85
ISPLSTV1 DS    0H                                              SS NOV85
         TM    SPFPRBI,X'40'       GROUP                       SS NOV85
         BO    ISPLSTVA            YES                         SS NOV85
         XC    SPFUCBSN,SPFUCBSN   ZERO FOR FRESH START        SS NOV85
         L     R1,16               CVT                         SS NOV85
         L     R1,CVTUCBSC-CVT(R1) IOSSVSUCB  UCB SCAN         SS NOV85
         ST    R1,SPFVTMP2         SAVE ADDRESS                SS NOV85
         B     ISPLSTVL            START LOOP                  SS NOV85
ISPLSTVA DS    0H                                              SS NOV85
*  SET UP CALL FOR IEFEB4UV      (FUTURE)                      SS NOV85
ISPLSTVL DS    0H                  LOOP                        SS NOV85
         TM    SPFPRBI,X'40'       GROUP                       SS NOV85
         BZ    ISPLSTVB            YES                         SS NOV85
*  EXTRACT ENTRY FROM UCB LIST   (FUTURE)                      SS NOV85
*  AT END OF LIST FREEMAIN AND   (FUTURE)                      SS NOV85
*  BRANCH TO ISPLSTVD            (FUTURE)                      SS NOV85
         B     ISPLSTVC                                        SS NOV85
ISPLSTVB DS    0H                                              SS NOV85
         LA    R1,SPFUCBSN                                     SS NOV85
         ST    R1,PARMLIST                                     SS NOV85
         LA    R1,ISPLSTVZ                                     SS NOV85
         ST    R1,PARMLIST+4                                   SS NOV85
         LA    R1,SPFUCBA                                      SS NOV85
         ST    R1,PARMLIST+8                                   SS NOV85
         OI    PARMLIST+8,X'80'                                SS NOV85
         LA    R1,PARMLIST                                     SS NOV85
         L     R15,SPFVTMP2        ROUTINE ADDRESS             SS NOV85
         BALR  R14,R15                                         SS NOV85
         LTR   R15,R15                                         SS NOV85
         BNZ   ISPLSTVD            DONE                        SS NOV85
         L     R1,SPFUCBA                                      SS NOV85
ISPLSTVC DS    0H                                              SS NOV85
         USING UCBOB,R1                                        SS NOV85
         TM    UCBSTAT,UCBONLI     IS IT ONLINE                SS NOV85
         BZ    ISPLSTVL            NO, SKIP IT                 SS NOV85
         CLI   UCBVOLI,C' '        ANY VOLUME                  SS NOV85
         BNH   ISPLSTVL            NO VOLUME, SKIP IT          SS NOV85
         TM    UCBSTAT,UCBCHGS+UCBUNLD GOING OFFLINE           SS NOV85
         BNZ   ISPLSTVL            YES, SKIP IT                SS NOV85
         LH    R15,SPFPRLN         LENGTH OR PARM              SS NOV85
         L     R14,SPFPRSR         STRING ADDRESS              SS NOV85
         TM    SPFPRBI,X'80'       BY ADDRSS                   SS NOV85
         BO    ISPLSTV4            YES                         SS NOV85
         CLC   UCBVOLI(0),0(R14)   <<EXECUTED>>                SS NOV85
         EX    R15,*-6                                         SS NOV85
         BNE   ISPLSTVL            NOT THE ONE                 SS NOV85
         B     ISPLSTV7                                        SS NOV85
ISPLSTV4 CLC   UCBNAME(0),0(R14)   <<EXECUTED>>                SS NOV85
         EX    R15,*-6                                         SS NOV85
         BNE   ISPLSTVL            NOT THE ONE                 SS NOV85
         B     ISPLSTV7                                        SS NOV85
*  ADD / REPLACE VOL ENTRIES                                   SS NOV85
ISPLSTV7 DS    0H                                              SS NOV85
         OI    SPFPRBI2,X'40'      AT LEAST ONE VOLUME FOUND  ABL APR86
         ST    R1,SPFVTMP1         SAVE UCB FOR NOW            SS NOV85
         NI    SPFPRBI,255-X'01'   CLEAR FLAG BEFORE           SS NOV85
         MVC   SPFVVOL,UCBVOLI     GET VOLSER                  SS NOV85
         BAL   R2,ISPGET           SEE IF DUP                  SS NOV85
         L     R1,SPFVTMP1         RESET R1                    SS NOV85
         LTR   R15,R15             FOUND ONE                   SS NOV85
         BNZ   ISPLSTV5            NO, NO UPDATE               SS NOV85
         OI    SPFPRBI,X'01'       SET UPDATE BIT              SS NOV85
         B     ISPLSTV6                                        SS NOV85
ISPLSTV5 DS    0H                                              SS NOV85
         BAL   R2,ISPBOTM          ADD TO BOTTOM               SS NOV85
         L     R1,SPFVTMP1         RESET R1                    SS NOV85
         MVC   SPFVVOL,UCBVOLI     GET VOLSER                  SS NOV85
         MVC   SPFVDATA,ISPBLK8                                SS NOV85
ISPLSTV6 DS    0H                                              SS NOV85
         MVC   SPFVOPT,ISPBLK8                                 SS NOV85
         MVC   SPFVINDC,ISPBLK8                                SS NOV85
         MVC   SPFVSTAT,ISPBLK8                                SS NOV85
         ST    R1,SPFVUCBA                                     SS NOV85
         BAL   R2,ISPVSTAI         STATUS SUBROUTINE           SS NOV85
         MVC   SPFVTCYL(8),ISPBLK8                             SS NOV85
         MVC   SPFVXNUM(16),SPFVTCYL                           SS NOV85
         MVC   SPFVVSIZ,ISPBLK8                                SS NOV85
         TM    SPFPRBI,X'10'       NOSPACE                     SS NOV85
         BO    ISPLSTV8            ADD ENTRY                   SS NOV85
         BAL   R2,ISPVSPAI         VOLUME SPACE  BUILD  SUB    SS NOV85
* CAN DO UPDATE NOW                                            SS NOV85
ISPLSTV8 DS    0H                                              SS NOV85
         TM    SPFPRBI,X'01'       UPDATE                      SS NOV85
         BO    ISPLSTVU            YES                         SS NOV85
         BAL   R2,ISPTBADD                                     SS NOV85
         B     ISPLSTVL            CONTINUE WITH NEXT UCB      SS NOV85
ISPLSTVU DS    0H                                              SS NOV85
         BAL   R2,ISPTBMOD                                     SS NOV85
         B     ISPLSTVL            CONTINUE WITH NEXT UCB      SS NOV85
         SPACE 1
* RETURN TO DISPLAY                                            SS NOV85
ISPLSTVD DS    0H                                              SS NOV85
         LA    R15,100             GO TO TBDISPL               SS NOV85
         TM    SPFPRBI2,X'40'      AT LEAST ONE VOLUME FOUND? ABL APR86
         BOR   R3                  YES, RETURN                ABL APR86
         MVC   SPFMSGID,ISPPDSM    ERROR MESSAGE              ABL APR86
         MVI   SPFMSGID+6,C'8'     NO MATCHING VOLUME         ABL APR86
         MVI   SPFMSGID+7,C'A'                                ABL APR86
         TM    SPFPRBI2,X'80'      TERMINATE IF NONE?         ABL APR86
         BNOR  R3                  NO, RETURN                 ABL APR86
         MVI   SPFMSGID,0          TURN OFF MSGID             ABL APR86
         BAL   R2,ISPTBEND         TERMINATE THIS TABLE       ABL APR86
         LA    R1,0                POP PANEL                  ABL APR86
         BAL   R2,ISPSTKI          UNSTACK                    ABL APR86
         MVC   SPFMSGID,ISPPDSM    ERROR MESSAGE              ABL APR86
         MVI   SPFMSGID+6,C'8'     NO MATCHING VOLUME         ABL APR86
         MVI   SPFMSGID+7,C'A'                                ABL APR86
         LA    R15,100             GO TO TBDISPL              ABL APR86
         BR    R3                  RETURN TO ROUTER            SS NOV85
         SPACE 1
* INVALID LISTV WITH NO OPERANDS                               SS NOV85
ISPLSTVQ DS    0H                                              SS NOV85
         MVC   SPFMSGID,ISPPDSM   INIT MESSAGE                 SS NOV85
         MVI   SPFMSGID+6,C'2'    NO OPERAND    MESSAGE        SS NOV85
         MVI   SPFMSGID+7,C'V'                                 SS NOV85
         B     ISPLSTVE                                       ABL APR86
         SPACE 1
* INVALID RANGE ON STRING                                      SS NOV85
ISPLSTVW DS    0H                                              SS NOV85
         MVC   SPFMSGID,ISPPDSM   INIT MESSAGE                 SS NOV85
         MVI   SPFMSGID+6,C'3'    TOO LONG      MESSAGE        SS NOV85
         MVI   SPFMSGID+7,C'V'                                 SS NOV85
         B     ISPLSTVE                                       ABL APR86
         SPACE 1
* KEY CONFLICT                                                 SS NOV85
ISPLSTVK DS    0H                                              SS NOV85
         MVC   SPFMSGID,ISPPDSM   INIT MESSAGE                 SS NOV85
         MVI   SPFMSGID+6,C'7'    KEY CONFLICT  MESSAGE        SS NOV85
         MVI   SPFMSGID+7,C'A'                                 SS NOV85
         SPACE 1
ISPLSTVE LA    R15,100            GO TO TBDISPL               ABL APR86
         BR    R3                 RETURN TO ROUTER            ABL APR86
         SPACE 2
ISPLSTVP DS    0F                                              SS NOV85
         DC    X'80',X'000000',CL8' '                          SS NOV85
         DC    X'33',X'800000',CL8'ADDRESS'                    SS NOV85
*        DC    X'34',X'400000',CL8'GROUP'                      SS NOV85
         DC    X'34',X'200000',CL8'SPACE'                      SS NOV85
         DC    X'36',X'100000',CL8'NOSPACE'                    SS NOV85
         DC    X'31',X'100000',CL8'NO'                         SS NOV85
         DC    X'34',X'080000',CL8'RESET'                      SS NOV85
         DC    X'FF'                                           SS NOV85
ISPLSTVZ DC    X'20'        UCB SCAN FOR DASD                  SS NOV85
         SPACE 2
         DS    0F                                              SS NOV85
ISPLSTVV DC    H'0',X'08',X'00'                                SS NOV85
         DC    A(VSPFVVOL),AL2(SPFVVOL-SPWRKC),H'06'           SS NOV85
         DC    A(VSPFVUCB),AL2(SPFVUCBA-SPWRKC),H'04'          SS NOV85
         DC    A(VSPFVDAT),AL2(SPFVDATA-SPWRKC),H'08'          SS NOV85
         DC    X'FF'                                           SS NOV85
VSPFVVOL DC    C'PDSVVOL '                                     SS NOV85
VSPFVUCB DC C'(PDSVUCBA PDSVOPT PDSVADDR PDSVATTR PDSVCNT  PDSVTCYL    X
               PDSVTTRK  PDSVXNUM PDSVDSCB PDSVLCYL PDSVLTRK PDSVSTAT  X
               PDSVVSIZ)'                                      SS NOV85
VSPFVDAT DC    C'(PDSVDATA PDSVTYPE PDSVVTOC PDSVINDC)'        SS NOV85
ISPLSTVN DC    C'(PDSVOPT PDSVDATA PDSVUCBA PDSVTYPE PDSVADDR PDSVVTOC X
               PDSVATTR PDSVCNT PDSVTCYL PDSVTTRK PDSVXNUM PDSVDSCB    X
               PDSVLCYL PDSVLTRK PDSVINDC PDSVSTAT PDSVVSIZ)'  SS NOV85
         SPACE 5                                               SS NOV85
*                                                              SS NOV85
*   ISPVSTAT SUBROUTINE  BUILD VOLUME STATS                    SS NOV85
*                                                              SS NOV85
ISPVSTAT DS    0H                                              SS NOV85
         USING *,R4                                            SS NOV85
         L     R1,SPFVUCBA                                     SS NOV85
         MVC   SPFVVOL,UCBVOLI     GET VOLSER                  SS NOV85
         MVC   SPFVADDR(3),UCBNAME CUU                         SS NOV85
         MVI   SPFVADDR+3,C' '     BLANK                       SS NOV85
         SR    R0,R0                                          ABL APR86
         IC    R0,UCBUSER                                     ABL APR86
         LR    R1,R0               ONE BYTE ONLY              ABL APR86
         BAL   R2,ISPDECCV         CONVERT DO DEC              SS NOV85
         MVC   SPFVCNT,SPFDCNV3    GET VALUE                   SS NOV85
         MVI   SPFVCNT+3,C' '                                  SS NOV85
         L     R1,SPFVUCBA                                     SS NOV85
         TM    UCBSTAB,UCBBPRV     PRIVATE                     SS NOV85
         BZ    *+10                                            SS NOV85
         MVC   SPFVATTR,=C'PRIV'                               SS NOV85
         TM    UCBSTAB,UCBBPUB     PUBLIC                      SS NOV85
         BZ    *+10                                            SS NOV85
         MVC   SPFVATTR,=C'PUB '                               SS NOV85
         TM    UCBSTAB,UCBBSTR     STORAGE                     SS NOV85
         BZ    *+10                                            SS NOV85
         MVC   SPFVATTR,=C'STOR'                               SS NOV85
         TM    UCBSTAT,UCBRESV     RESERVED                    SS NOV85
         BZ    *+10                                            SS NOV85
         MVC   SPFVSTAT,=C'RESV'                               SS NOV85
         TM    UCBSTAT,UCBPRES     PERMINAT RESIDENT           SS NOV85
         BZ    *+10                                            SS NOV85
         MVC   SPFVSTAT,=C'PRES'                               SS NOV85
         TM    UCBSTAT,UCBSYSR     SYSTEM RESIDENT             SS NOV85
         BZ    *+10                                            SS NOV85
         MVC   SPFVSTAT,=C'SYSR'                               SS NOV85
         MVC   SPFVINDC(4),ISPBLK8  RESET INDC AREA            SS NOV85
         TM    UCBSTAT,UCBALOC     ALLOCATED                   SS NOV85
         BZ    *+8                                             SS NOV85
         MVI   SPFVINDC,C'A'                                   SS NOV85
         TM    UCBSTAB,UCBPGFL     PAGE DATASET                SS NOV85
         BZ    *+8                                             SS NOV85
         MVI   SPFVINDC+1,C'P'                                 SS NOV85
         TM    UCBTYP+1,X'08'      VIRT DASD 3330V             SS NOV85
         BZ    *+8                                             SS NOV85
         MVI   SPFVINDC+3,C'M'     MASS STORE                  SS NOV85
         TM    UCBSTAB,UCBBNUL     CATALOG (NOT ALWAYS SET)    SS NOV85
         BZ    *+8                                             SS NOV85
         MVI   SPFVINDC+2,C'C'                                 SS NOV85
         MVC   SPFVTYPE,ISPBLK8                                SS NOV85
         LA    R1,UCBTYP                                       SS NOV85
         BAL   R2,ISPDEVTC                                     SS NOV85
         STH   R15,SPFVCSIZ        TRK/CYL                     SS NOV85
         BAL   R2,ISPDEVNM         GET DEVICE TYPE NAME        SS NOV85
         LTR   R15,R15                                         SS NOV85
         BZ    *+10                                            SS NOV85
         MVC   SPFVTYPE,0(R15)                                 SS NOV85
         L     R1,SPFVUCBA                                     SS NOV85
* SET VTOC ADDRESS IN SPFVVTOC                                 SS NOV85
         SR    R0,R0                                           SS NOV85
         ICM   R1,3,UCBVTOC       GET TT OF TTR0               SS NOV85
         ICM   R1,12,=X'0000'     CLEAR                        SS NOV85
         LH    R15,SPFVCSIZ                                    SS NOV85
         DR    R0,R15                                          SS NOV85
         SLL   R1,16              SHIFT CC                     SS NOV85
         OR    R1,R0              ADD IN HH                    SS NOV85
         BAL   R2,ISPHEXCV        CONVERT TO HEX               SS NOV85
         MVC   SPFVVTOC,SPFHEXCV  MOVE IT                      SS NOV85
         BR    R3                                              SS NOV85
         DROP  R4                                              SS NOV85
*                                                              SS NOV85
*   ISPVSPAC SUBROUTINE  BUILD VOLUME SPACE AND DSCB F4 INFO   SS NOV85
*                                                              SS NOV85
ISPVSPAC DS    0H                                              SS NOV85
         USING *,R4                                            SS NOV85
         CLI   SPFVINDC+3,C'M'     MASS STORE                  SS NOV85
         BER   R3                  SKIP LSPACE                 SS NOV85
         L     R0,SPFVUCBA         GET UCB ADDR                SS NOV85
         BAL   R2,ISPLSPAC         UPDATE SPACE                SS NOV85
* SHOULD ALSO READ DSCB F4 FOR MORE INFOMATION                 SS NOV85
         L     R1,SPFVUCBA                                     SS NOV85
         LA    R1,UCBVOLI          LOCATION OF VOLUME          SS NOV85
         BAL   R2,ISPFMT4          GET DSCB FORMAT 4           SS NOV85
         LTR   R15,R15                                         SS NOV85
         BNZR  R3                  SKIP, BAD RC                SS NOV85
         LH    R1,DS4DSREC-DS4IDFMT+SPFDSCB                    SS NOV85
         BAL   R2,ISPDECCV                                     SS NOV85
         MVC   SPFVDSCB,SPFDCNV4                               SS NOV85
         MVC   SPFVINDC+4(4),ISPBLK8   RESET INDC AREA         SS NOV85
         TM    DS4VTOCI-DS4IDFMT+SPFDSCB,DS4IVTOC  INDEX VTOC  SS NOV85
         BZ    *+8                                             SS NOV85
         MVI   SPFVINDC+4,C'I'                                 SS NOV85
         TM    DS4VSIND-DS4IDFMT+SPFDSCB,X'80'     VSAM OWNED  SS NOV85
         BZ    *+8                                             SS NOV85
         MVI   SPFVINDC+5,C'V'                                 SS NOV85
         SR    R1,R1                                           SS NOV85
         ICM   R1,3,DS4VSCRA-DS4IDFMT+SPFDSCB      CRA         SS NOV85
         LTR   R1,R1                               ANY         SS NOV85
         BZ    *+8                                             SS NOV85
         MVI   SPFVINDC+6,C'R'                                 SS NOV85
         LA    R1,DS4VTOCE-DS4IDFMT+SPFDSCB                    SS NOV85
         SR    R0,R0                                           SS NOV85
         SR    R2,R2                                           SS NOV85
         ICM   R0,3,2(R1)      CC OF LOWER LIMIT               SS NOV85
         ICM   R2,3,4(R1)      HH OF LOWER LIMIT               SS NOV85
         MH    R0,SPFVCSIZ     CC TIMES TRK/CYL                SS NOV85
         ALR   R2,R0           RELATIVE TRK OF LOWER LIMIT     SS NOV85
         LR    R15,R2          SAVE HERE                       SS NOV85
         ICM   R0,3,6(R1)      CC OF UPPER LIMIT               SS NOV85
         ICM   R2,3,8(R1)      HH OF UPPER LIMIT               SS NOV85
         MH    R0,SPFVCSIZ     CC TIMES TRK/CYL                SS NOV85
         ALR   R2,R0           RELATIVE TRK OF UPPER LIMIT     SS NOV85
         SLR   R2,R15          DIFFERANCE                      SS NOV85
         LA    R1,1                                            SS NOV85
         ALR   R1,R2           VTOC SIZE IN TRKS               SS NOV85
         BAL   R2,ISPDECCV                                     SS NOV85
         MVC   SPFVVSIZ,SPFDCNV4                               SS NOV85
         BR    R3                                              SS NOV85
         DROP  R4                                              SS NOV85
         TITLE  'LISTA LISTV LINE CMD FUNCTION'                SS NOV85
*************************************************************  SS NOV85
*                                                              SS NOV85
*      LISTA/LISTV LINE CMD FUNCTIONS                          SS NOV85
*                                                              SS NOV85
*************************************************************  SS NOV85
         SPACE 2
ISPLAVL  DS    0H                                              SS NOV85
         USING *,R4                                            SS NOV85
         SPACE 1
         TM    SPFTFLG1,SPFTLPOS  POST PROCESSING REQUIRED     SS NOV85
         BO    ISPLAVPP             YES                        SS NOV85
         NI    SPFLAG0,255-SPFCKER-SPFMSGER   RESET            SS SEP84
         LH    R1,SPFTBPDA    DATA OFFSET                      SS NOV85
         LA    R1,SPWRKC(R1)                                   SS NOV85
         OC    0(8,R1),ISPBLK8 FORCE UPPER CASE                SS NOV85
         LH    R1,SPFTBPOT    OPT OFFSET                       SS NOV85
         LA    R1,SPWRKC(R1)                                   SS NOV85
         MVC   SPFINPUT(4),0(R1)  MOVE CMD                     SS NOV85
         MVI   SPFINPUT+4,C' '    FORCE TRAILING BLANK         SS NOV85
         OC    SPFINPUT(4),ISPBLK8 FORCE UPPER CASE            SS NOV85
         LA    R1,SPFINPUT                                     SS NOV85
         LA    R15,4          LIMIT OF SCAN OF LINE ENTRY      SS NOV85
         L     R14,SPFTBPLC  TABLE FOR SEARCH                  SS NOV85
         BAL   R2,ISPVER1           CHECK CMD VERB             SS NOV85
         MVC   SPFTTPT,SPFVTPT      COPY POINTER               SS NOV85
         C     R15,ISPL8            IS THIS VALID              SS SEP84
         BH    ISPLAV3              NO                         SS SEP84
         TM    $TLF2(R14),#H        FROM O LINE CMD ONLY       SS NOV85
         BO    ISPLAV3                                         SS NOV85
ISPLAV0  DS    0H                                              SS NOV85
         SR    R15,R15                                         SS SEP84
         IC    R15,$TLFU(R14)       GET PROCESSOR INDEX        SS JUL85
         B     *+4(R15)             INDEX TO PROCESSOR         SS SEP84
         B     ISPLAV3           0  INVALID                    SS SEP84
         B     ISPLAVB           4  BLANK LISTA                SS SEP84
         B     ISPLAVD           8  DELETE ENTRY               SS NOV85
         B     ISPLAVP          12  SELECT PANEL SUPPORT       SS NOV84
         B     ISPLAVU          16  UTILITY COMMANDS           SS SEP84
         B     ISPLAVFR         20  LISTA FREE                 SS NOV85
         B     ISPLAVFR         24  LISTA DECONCAT             SS NOV85
         B     ISPLAV3          28  LISTA SET CONCAT ENTRY     SS NOV85
         B     ISPLAVSP         32  LISTV SPACE                SS NOV85
         B     ISPLAVSP         36  LISTV UPDATE STATS         SS NOV85
         B     ISPLAV3          40  LISTV ALLOC VOLUME         SS NOV85
         B     ISPLAV3          44  LISTV VSAM TIME STAMP      SS NOV85
         B     ISPLAV3          48  LISTV FREE SPACE EXTENTS   SS NOV85
         B     ISPLAV3          52  LISTV DATASET LIST         SS NOV85
         B     ISPLAV3          56  LISTV FIND DSN BY CCHH     SS NOV85
         SPACE 3                                               SS SEP84
ISPLAVAA DC    AL2(SPFLISTA-SPWRKC)                            SS NOV85
ISPLAVVV DC    AL2(SPFLISTV-SPWRKC)                            SS NOV85
         SPACE 3                                               SS SEP84
ISPLAVER DS    0H                                              SS SEP84
         NI    SPFLAG0,255-SPFCKER-SPFMSGER   RESET            SS SEP84
         LH    R1,SPFTBPDA                                     SS NOV85
         LA    R1,SPWRKC(R1)                                   SS NOV85
         MVC   0(8,R1),ISPERMSG                                SS SEP84
         MVC   SPFMSGID,ISPPDSM   INIT MESSAGE                ABL JUN85
         MVI   SPFMSGID+7,C'A'                                ABL JUN85
         MVI   SPFMSGID+6,C'1'    GENERAL ERROR MESSAGE       ABL JUN85
         B     ISPLAV2          CONTINUE                       SS SEP84
ISPLAV3  DS    0H                                              SS SEP84
         LH    R1,SPFTBPDA                                     SS NOV85
         LA    R1,SPWRKC(R1)                                   SS NOV85
         MVC   0(8,R1),ISPINVLD                                SS SEP84
ISPLAV2  DS    0H                                              SS NOV85
         OI    SPFLAG2,SPFNPOS      POSITIONING NOT ALLOWED   ABL APR86
         BAL   R2,ISPTBPUT          UPDATE TABLE LINE          SS SEP84
         BAL   R2,ISPQUERY                                     SS MAR85
         MVC   SPFTCCRP,SPFTCRP     SAVE CUR CPR FOR CURSER    SS MAR85
         NI    SPFTFLG1,255-SPFTMUT-SPFTLCD-SPFTZSV-SPFTLPOS   SS NOV85
         BAL   R2,ISPDSPRS      RESTORE DISPLAY                SS NOV85
         LA    R15,100             TBDISPL SUPPORT             SS NOV85
         BR    R3                  RETURN TO ROUTER            SS NOV85
         SPACE 2                                               SS NOV85
ISPLAVC  DS    0H                                              SS NOV85
         MVC   SPFTTPT2,SPFTTPT   SAVE CMD FOR REPEAT          SS NOV85
         LA    R15,112            ISPCMDC                      SS NOV85
         BR    R3                 RETURN TO ROUTER             SS NOV85
         SPACE 2                                               SS SEP84
ISPLAVD  DS    0H                                              SS NOV85
         BAL   R2,ISPDEL1                                      SS NOV85
         B     ISPLAVY                                         SS NOV85
ISPLAVPP DS    0H                                              SS SEP84
         L     R14,SPFTTPT         GET MY TABLE ENTRY          SS NOV85
         SR    R15,R15                                         SS SEP84
         IC    R15,SPFTPOSI         GET POST PROCESSOR INDEX   SS SEP84
         B     *+4(R15)             INDEX TO PROCESSOR         SS SEP84
         B     ISPLAVY           0  CLEAN UP                   SS SEP84
         B     ISPLAVGP          4  GENERAL PROCESSOR          SS SEP84
         SPACE 3                                               SS SEP84
ISPLAVN  DS    0H                  NORMAL CLEANUP              SS NOV85
         BAL   R2,ISPLMSGS         PROCESS MESSAGE             SS NOV85
         LH    R1,SPFTBPOT                                     SS NOV85
         LA    R1,SPWRKC(R1)                                   SS NOV85
         MVC   0(4,R1),ISPBLK8     CLEAR OPTION                SS SEP84
         BAL   R2,ISPTBPUT         UPDATE TABLE                SS SEP84
         TM    ##ADRPA#,$F         SOFT ATTN SIGNALLED?       ABL APR85
         BNO   ISPLAVX             NO, BRANCH                 ABL APR85
         NI    ##ADRPA#,255-$F     YES, TURN OFF FLAG         ABL APR85
         MVC   SPFADATA,ISPATTN    SPECIAL *ATTN* FLAG        ABL APR85
         B     ISPLAV2             TERMINATE LINE COMMANDS    ABL APR85
ISPLAVX  DS    0H                                              SS SEP84
         L     R14,SPFTTPT         GET MY TABLE ENTRY          SS NOV85
         TM    $TLF1(R14),#V       VIEW MODE TO FOLLOW         SS SEP84
         BZ    ISPLAVY             NO                          SS NOV85
         MVI   SPFTPOSI,0          COME BACK TO ISPLAVY        SS NOV85
         LA    R1,4                LINE OUTPUT PANEL           SS NOV85
         BAL   R2,ISPSTKI          STACK IT                    SS NOV85
         LA    R15,100             TBDISPL SUPPORT             SS NOV85
         BR    R3                  RETURN TO ROUTER            SS NOV85
ISPLAVB  DS    0H                                              SS MAR85
         LH    R1,SPFTBPDA                                     SS NOV85
         LA    R1,SPWRKC(R1)                                   SS NOV85
         CLI   0(R1),C'*'       IS IT A MSG                    SS MAR85
         BNE   ISPLAVB2         NO,  CLEAR                     SS MAR85
         CLC   00(8,R1),ISPINVLD  INVALID MSG                  SS MAR85
         BNE   ISPLAVM          NO, DONT CLEAR                ABL JUN85
ISPLAVB2 DS    0H                                              SS MAR85
         MVC   00(8,R1),ISPBLK8    BLANK OUT DATA              SS MAR85
         B     ISPLAVM                                        ABL JUN85
ISPLAVM  DS    0H                                             ABL JUN85
         BAL   R2,ISPTBPUT      UPDATE TABLE                   SS MAR85
         B     ISPLAV4                                         SS MAR85
ISPLAVY  DS    0H                                              SS NOV85
         BAL   R2,ISPQUERY      GET CUR CRP FOR CURSOR         SS MAR85
         MVC   SPFTCCRP,SPFTCRP SAVE CUR CRP                   SS MAR85
         OI    SPFTFLG1,SPFTYPOS   WE CAN DO CUR POSITIONING   SS NOV85
ISPLAV4  DS    0H                                              SS MAR85
         NI    SPFTFLG1,255-SPFTLPOS                           SS NOV85
         LA    R15,100          TABLE PANEL DISPLAY SUPPORT    SS NOV85
         BR    R3                  RETURN TO ROUTER            SS NOV85
         SPACE 2                                               SS SEP84
*   GENERAL SAMPLE FOR LINE CMD                                SS NOV85
ISPLAVG  DS    0H                                              SS SEP84
         MVC   SPFTPOSI(1),$TLFU(R14)  POST PROCESSING INDEX   SS JUL85
         TM    $TLF2(R14),#P       DIFFERENT POST PROC         SS NOV84
         BZ    ISPLAVG2             NO SKIP                    SS NOV84
         MVC   SPFTPOSI(1),$TLEX(R14) USE IT                   SS NOV84
ISPLAVG2 DS    0H                                              SS SEP84
         OI    SPFLAG0,SPFCKER     ALSO CHECK FOR ERRORS       SS NOV84
         LA    R15,$TLCM(R14)   GET NAME                       SS JUL85
         TM    $TLF2(R14),#R       REAL CMD OFFSET*2           SS NOV84
         BZ    ISPLAVG3                                        SS JUL85
         SR    R15,R15                                         SS NOV84
         IC    R15,$TLEX(R14)                                  SS NOV84
         LA    R15,ISPREAL(R15)                                SS NOV84
ISPLAVG3 DS    0H                                             ABL OCT84
         MVC   PUTGETBF(4),ISPCMD30                           ABL OCT84
         MVC   SPFINPUT(8),0(R15) COPY CMD NAME                SS SEP84
         MVI   SPFINPUT+8,C' '                                 SS SEP84
         MVC   SPFINPUT+9(8),SPFADDNM                          SS SEP84
* BUILD REST OF CMD                                           ABL OCT84
         CLI   SPFADATA,X'00'      NULLS                       SS NOV84
         BE    ISPLAVG5            YES, CONVERT TO BLANKS      SS NOV84
         CLI   SPFADATA,C'*'       STATUS MESSAGE?            ABL OCT84
         BNE   *+10                NO, BRANCH                 ABL OCT84
ISPLAVG5 DS    0H                                              SS NOV84
         MVC   SPFADATA(8),ISPBLK8 YES, BLANK IT OUT          ABL OCT84
         MVC   SPFINPUT+18(8),SPFADATA                        ABL OCT84
         MVC   SPFASAVD,SPFADATA                               SS NOV84
         TM    $TLF1(R14),#V       VIEW MODE OUTPUT?           SS DEC84
         BZ    ISPLAVG6            NO, BRANCH                  SS DEC84
         OI    SPFLAG3,SPFLOGM     YES, MARK FOR LOGGING       SS DEC84
ISPLAVG6 DS    0H                                              SS NOV84
         B     ISPLAVC                                        ABL OCT84
*                                                              SS NOV85
*  LISTV SPACE AND STATUS LINE CMDS                            SS NOV85
*                                                              SS NOV85
ISPLAVSP DS    0H                                              SS NOV85
         L     R1,SPFVUCBA                                     SS NOV85
         USING UCBOB,R1                                        SS NOV85
         TM    UCBSTAT,UCBONLI     IS IT ONLINE                SS NOV85
         BZ    ISPLAVS2            NO, SKIP IT                 SS NOV85
         CLI   UCBVOLI,C' '        ANY VOLUME                  SS NOV85
         BNH   ISPLAVS2            NO VOLUME, SKIP IT          SS NOV85
         TM    UCBSTAT,UCBCHGS+UCBUNLD GOING OFFLINE           SS NOV85
         BNZ   ISPLAVS2            YES, SKIP IT                SS NOV85
         DROP  R1                                              SS NOV85
         BAL   R2,ISPVSTAI         UPDATE STATS                SS NOV85
         L     R14,SPFTTPT              RELOAD POINTER         SS NOV85
         CLI   $TLFU(R14),36            STAT                   SS NOV85
         BE    ISPLAVN             YES SKIP SPACE              SS NOV85
         BAL   R2,ISPVSPAI         UPDATE SPACE                SS NOV85
         B     ISPLAVN             NORMAL CLEANUP              SS NOV85
         SPACE 2                                               SS NOV85
ISPLAVS2 DS    0H                                              SS NOV85
         MVC   SPFVDATA,ISPLAVS3                               SS NOV85
         B     ISPLAV2                                         SS NOV85
ISPLAVS3 DC    CL8'*UNAVAL*'                                   SS NOV85
         SPACE 2                                               SS NOV85
*                                                              SS NOV85
*  LISTA FREE LINE CMD                                         SS NOV85
*                                                              SS NOV85
ISPLAVFR DS    0H                                              SS NOV85
         CLC   SPFADDNM,ISPBLK8                                SS NOV85
         BNH   ISPLAVFE                 NO DD                  SS NOV85
         LA    R14,SPFADDNM             VERIFY DD STILL ALOC   SS NOV85
         BAL   R2,ISPFDSAB                                     SS NOV85
         LTR   R1,R1                                           SS NOV85
         BZ    ISPLAVF8                 GONE                   SS NOV85
         LH    R2,DSABOPCT-DSAB(R1)     GET OPEN COUNT         SS NOV85
         LTR   R2,R2                                           SS NOV85
         BNZ   ISPLAVF9                 STILL OPEN             SS NOV85
         TM    DSABFLG1-DSAB(R1),DSABNUSE                      SS NOV85
         BO    ISPLAVFA                 IN USE                 SS NOV85
         L     R14,SPFTTPT              RELOAD POINTER         SS NOV85
         CLI   $TLFU(R14),24            DECONCAT               SS NOV85
         BNE   ISPLAVFD                 NO SKIP                SS NOV85
         TM    DSABFLG1-DSAB(R1),DSABCATM IS IT CONCAT?        SS NOV85
         BZ    ISPLAVFB                   NO, BRANCH           SS NOV85
         TM    DSABFLG1-DSAB(R1),DSABPCAT IS IT PERM CAT?      SS NOV85
         BO    ISPLAVFC                   YES, BRANCH          SS NOV85
         LA     R0,S99VRBDC                                    SS NOV85
         B      ISPLAVFF                                       SS NOV85
ISPLAVFD DS    0H                                              SS NOV85
         LA    R0,S99VRBUN              SET UNALLOC            SS NOV85
ISPLAVFF DS    0H
         LA    R1,SPFADDNM              DDNAME                 SS NOV85
         BAL   R2,ISPUNALC                                     SS NOV85
         LTR   R15,R15                                         SS NOV85
         BZ    ISPLAVN                  NORMAL                 SS NOV85
         MVC   SPFADATA,ISPERMSG                               SS NOV85
         B     ISPLAV2                  TERMINATE  LINE CMD    SS NOV85
ISPLAVF8 DS    0H                                              SS NOV85
         MVC   SPFADATA,ISPLAVFM                               SS NOV85
         B     ISPLAV2                                         SS NOV85
ISPLAVF9 DS    0H                                              SS NOV85
         MVC   SPFADATA,ISPLAVFM+8                             SS NOV85
         B     ISPLAV2                                         SS NOV85
ISPLAVFA DS    0H                                              SS NOV85
         MVC   SPFADATA,ISPLAVFM+16                            SS NOV85
         B     ISPLAV2                                         SS NOV85
ISPLAVFB DS    0H                                              SS NOV85
         MVC   SPFADATA,ISPLAVFM+24                            SS NOV85
         B     ISPLAV2                                         SS NOV85
ISPLAVFC DS    0H                                              SS NOV85
         MVC   SPFADATA,ISPLAVFM+32                            SS NOV85
         B     ISPLAV2                                         SS NOV85
ISPLAVFE DS    0H                                              SS NOV85
         MVC   SPFADATA,ISPLAVFM+40                            SS NOV85
         B     ISPLAV2                                         SS NOV85
ISPLAVFM DC    CL8'*DD GONE'        0                          SS NOV85
         DC    CL8'*OPEN DD'        8                          SS NOV85
         DC    CL8'*IN USE*'       16                          SS NOV85
         DC    CL8'*NOT CON'       24                          SS NOV85
         DC    CL8'*PERMCON'       32                          SS NOV85
         DC    CL8'*NO DDN*'       40                          SS NOV85
         SPACE 3                                               SS NOV85
* GENERAL SAMPLE OF POST PROCESSING                            SS NOV85
ISPLAVGP DS    0H                                              SS SEP84
         TM    $TLF1(R14),#V       VIEW MODE EXPECTED?        ABL DEC84
         BO    ISPLAVN             YES, IGNORE ERROR MSG FLG  ABL DEC84
         TM    SPFLAG0,SPFMSGER    ANY ERRORS?                 SS SEP84
         BO    ISPLAVER            YES, TERMINATE LIST CMDS.   SS SEP84
* INSERT ANY POST PROCESSING HERE                              SS NOV85
         B     ISPLAVN             NORMAL CLEAN UP             SS NOV85
*                                                              SS NOV84
*  LINE CMD SELECT PANEL DISPLAY SUPPORT (O LINE COMMAND)      SS NOV84
*                                                              SS NOV84
ISPLAVP  DS    0H                                              SS NOV84
         LH    R1,SPFTBPDA                                     SS NOV85
         LA    R1,SPWRKC(R1)                                   SS NOV85
         OI    SPFLAG0,SPFCKER     ALSO CHECK FOR ERRORS       SS NOV84
         CLI   0(R1),X'00'         NULLS                       SS NOV84
         BE    ISPLAVP3            YES, CONVERT TO BLANKS      SS NOV84
         CLI   0(R1),C'*'  '       STATUS MESSAGE?             SS NOV84
         BNE   *+10                NO, BRANCH                  SS NOV84
ISPLAVP3 DS    0H                                              SS NOV84
         MVC   0(8,R1),ISPBLK8     YES, BLANK IT OUT           SS NOV84
         MVC   SPFASAVD,0(R1)      SAVE FOR PANEL              SS NOV84
         MVI   SPFVZCMD,C' '             BLANK FIRST           SS NOV84
         MVC   SPFVZCMD+1(249),SPFVZCMD                        SS NOV84
         L     R14,SPFTTPT         RESTORE R14                 SS NOV85
         ST    R14,SPFTTPT2        SAVE TABLE ENTRY            SS NOV85
         TM    $TLF2(R14),#Z       NONDISPL                    SS NOV84
         BO    ISPLAVP2            YES                         SS NOV84
         LH    R1,SPFTBPOT         OPT                         SS NOV85
         LA    R1,SPWRKC(R1)                                   SS NOV85
         MVC   SPFVZCMD(4),0(R1)   ANY .MORE                   SS NOV84
         BAL   R2,ISPSHCMD         SET IT UP                   SS NOV84
         CLI   SPFVZCMD,C' '       ANY .MORE                   SS NOV84
         BE    ISPLAVP4            NO                          SS NOV84
ISPLAVP2 DS    0H                                              SS NOV84
         OI    SPFLAG4,SPFNOND     INVOKE PANEL NON-DISPLAY    SS NOV84
ISPLAVP4 DS    0H                                              SS NOV84
         BAL   R2,ISPSETVI                                     SS NOV85
         L     R1,SPFPANT                                      SS NOV84
         ST    R1,SPFPANC          SET CURRENT TO NEW          SS NOV84
         L     R14,SPFTTPT         RESTORE R14                 SS NOV85
         SR    R15,R15                                         SS NOV84
         IC    R15,$TLEX(R14)      GET                         SS NOV84
         AL    R15,ISP$PNA             PANEL                   SS MAR85
         MVC   SPFPSTK(8),0(R15)            NAME               SS NOV84
ISPLAVP5 DS    0H                                              SS NOV84
         BAL   R2,ISPPANDI                                     SS NOV85
         CLC   SPFZSEL(4),ISPCEND     END KEY?                 SS NOV84
         BE    ISPLAVY                YES, DONE                SS NOV84
         MVC   SPFINPUT(250),SPFZSEL                           SS NOV84
         MVC   PUTGETBF(4),ISPLEN2                             SS NOV84
         L     R14,SPFTTPT          RESTORE R14                SS NOV85
         MVI   SPFTPOSI,16          USE GENERAL PURPOSE POST   SS NOV84
         OI    SPFTFLG1,SPFTLPOS                               SS NOV85
         TM    $TLF2(R14),#A        RESCAN.. MULTY FUNC PANEL? SS NOV84
         BZ    ISPLAVC              NO, NO CHANGE              SS NOV84
*  RESCAN LINE CMD FROM PANEL                                  SS NOV84
         LA    R1,SPFINPUT                                     SS NOV85
         L     R14,SPFTBPLC  TABLE FOR SEARCH                  SS NOV85
         BAL   R2,ISPVERG           CHECK CMD VERB             SS NOV85
         MVC   SPFTTPT,SPFVTPT      COPY POINTER               SS NOV85
         C     R15,ISPL8            VALID VERB?                SS NOV84
         BH    ISPLAV3              NO, ERROR                  SS NOV84
         TM    $TLF1(R14),#V        VIEW MODE OUTPUT?         ABL DEC84
         BZ    *+8                  NO, BRANCH                ABL DEC84
         OI    SPFLAG3,SPFLOGM      YES, MARK FOR LOGGING     ABL DEC84
         TM    $TLF2(R14),#T        ALLOWED FROM O LINE CMD?  ABL DEC84
         BO    ISPLAV0              YES, PROCESS INTERNALLY   ABL DEC84
         TM    $TLF2(R14),#P        DIFFERENT POST PROCESSOR?  SS NOV84
         BZ    ISPLAVC              NO, BRANCH                 SS NOV84
         MVC   SPFTPOSI(1),$TLEX(R14) USE IT                   SS NOV84
         B     ISPLAVC                                         SS NOV84
         SPACE 3                                               SS NOV84
*                                                              SS MAR85
*   FORMAT UT1 LINE COMMAND                                    SS MAR85
*                                                              SS MAR85
ISPLAVU  DS    0H                                              SS MAR85
         MVI   SPFTPOSI,04         SET POST PROCESSING INDEX   SS MAR85
         MVC   PUTGETBF(4),ISPCMD30                            SS MAR85
*        MVC   SPFINPUT(8),$UT1   COPY CMD NAME                SS MAR85
         MVI   SPFINPUT+8,C' '                                 SS MAR85
*        MVC   SPFINPUT+9(8),          GET MEMBER NAME         SS MAR85
**       MVC   SPFINPUT+17(5),ISPUTDOT INSERT LITERAL UT.     ABL FEB86
         TM    $TLF2(R14),#R       IS REAL COMMAND HERE        SS MAR85
         BO    ISPLAVU4            YES, USE AFTER UT.          SS MAR85
         LA    R15,$TLCM(R14)      COMMAND NAME                SS JUL85
         B     ISPLAVU5            USE IT                      SS MAR85
ISPLAVU4 DS    0H                                              SS MAR85
         SR    R15,R15             CLEAR FOR INSERT            SS MAR85
         IC    R15,$TLEX(R14)      GET OFFSET OF REAL CMD      SS MAR85
         LA    R15,ISPREAL(R15)    GET ADDRESS                 SS JUL85
ISPLAVU5 DS    0H                                              SS MAR85
         MVC   SPFINPUT+17(4),0(R15) INSERT 4 CHAR OF CMD     ABL FEB86
         LH    R1,SPFTBPDA                                     SS NOV85
         LA    R1,SPWRKC(R1)                                   SS NOV85
         CLI   0(R1),C'*'          MSG                         SS MAR85
         BE    *+10                                            SS MAR85
         MVC   0(8,R1),ISPBLK8          BLANK IT OUT           SS MAR85
*        MVC   XXXXXX,0(R1)             SAVE FOR PANEL USE     SS NOV85
         B     ISPLAVC                                         SS MAR85
         DROP  R4                                              SS NOV85
         SPACE 2
*************************************************************  SS NOV85
*      MODEL SUBROUTINE                                        SS NOV85
*      MODEL SUBROUTINE                                        SS NOV85
*      MODEL SUBROUTINE                                        SS NOV85
*************************************************************  SS NOV85
         SPACE 2
ISPXXXX  DS    0H                                              SS NOV85
         USING *,R4                                            SS NOV85
         SPACE 1
         BR    R3                                              SS NOV85
         SPACE 2
         SPACE 5                                               SS NOV85
*                                                              SS NOV85
*    END OF EXECUTABLE CODE                                    SS NOV85
*                                                              SS NOV85
         DROP  R6,R5,R8                                        SS SEP84
         TITLE 'ISPF - WORK AREA 2            '                SS NOV85
         COPY  SPWRK73B                                        SS NOV85
         COPY  PDSDSECT                                        SS JUL85
         DCBD  DSORG=PO                                        SS JUL85
         IKJUPT                                                SS JUL85
         IEFZB4D0                                              SS JUL85
         CVT   DSECT=YES                                       SS JUL85
         IHADSAB                                               SS NOV85
         IKJTCB ,                                              SS NOV85
TIOT     DSECT                                                 SS NOV85
         IEFTIOT1                                              SS NOV85
         IEFUCBOB ,                                            SS NOV85
         IEZJSCB                                               SS NOV85
JFCB     DSECT                                                 SS NOV85
         IEFJFCBN                                              SS NOV85
SIOT     DSECT                                                 SS NOV85
         IEFASIOT                                              SS NOV85
         IHADVCT                                               SS NOV85
         IEFJESCT                                              SS NOV85
         IECSDSL1  (2,3,4,5)                                   SS NOV85
         END

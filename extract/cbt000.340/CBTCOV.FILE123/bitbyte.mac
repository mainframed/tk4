1BITBYTE:   /* PROCEDURE TO CONVERT ACCESS BITS TO CHARACTER         */
  PROC(STR1,STR2)     /* THE BYTE 'STR1' IS CONVERTED TO A           */
    RETURNS(CHAR(1)); /*  CHARACTER FROM THE NTH POSITION OF         */
                      /*  STRING 'STR2' WHERE N=1ST BIT='1'B         */
                      /*  IN BIT STRING STR1.  IF NO BIT IS          */
                      /*  ON, THE NINTH BYTE OF STR2 IS RETURNED     */
0DCL STR1 CHAR(*);
 DCL STR2 CHAR(*);
 DCL I   FIXED BIN(15,0);
0IF SUBSTR(STR1,1,1)=LOW(1)
    THEN RETURN(SUBSTR(STR2,9,1));/* IF NO STR1, USE LAST BYTE       */
    ELSE RETURN(SUBSTR(STR2,INDEX(UNSPEC(SUBSTR(STR1,1,1)),'1'B),1));
          /* ELSE USE CHARACTER CORRESPONDING TO BIT ON              */
-BYTEBIT:   /* PROCEDURE TO CONVERT CHARACTER VALUE TO BIT STRING    */
  ENTRY(STR1,STR2)    /*  STRING  'STR2' IS COMPARED AGAINST THE     */
    RETURNS(CHAR(1)); /*  FIRST BYTE OF STRING 'STR1'. IF A MATCH    */
                      /*  IS FOUND THE POSITION IN STR2 IS USED TO   */
                      /*  TURN ON BIT(N) IN STR1.  IF NO MATCH IS    */
                      /*  FOUND, STR1 IS SET TO X'00'.               */
0DCL CHAR1 CHAR(1) INIT(LOW(1));
 DCL BITS (8) BIT(1) BASED(ADDR(CHAR1));
0I=INDEX(SUBSTR(STR1,1,1),STR2);      /* FIND POSITION IN STRING     */
 IF I <= 0 THEN RETURN(CHAR1);    /* IF NO MATCH, RETURN X'00'       */
 BITS(I)=ON;                      /* ELSE TURN ON BIT AND RETURN     */
 RETURN(CHAR1);
 END BITBYTE;

PROC 0 LIST TEST
CONTROL PROMPT
IF &LIST=LIST THEN CONTROL LIST
IF &TEST=TEST THEN CONTROL LIST CONLIST SYMLIST
CLRSCRN
WRITE CLIST TO COMPUTE DEVICE INDEPENDENT BLKSIZE FOR RECFM=FB DATASETS
LOOP: WRITENR ENTER LRECL OF DATASET ====>
READ &L
IF &L = &STR() THEN EXIT
IF &L GT 6233 THEN GOTO OUT1
IF &DATATYPE(&L) :=NUM THEN GOTO LOOP
CLRSCRN
WRITE SELECTED LRECL = &L
WRITE   IDEAL        ACTUAL     3330        3350        3380
WRITE BLOCKSIZE    BLOCKSIZE UTILIZATION UTILIZATION UTILIZATION
SET &B = 1740/&L*&L
SET &BT = 13165/(&B+135)
SET &U30 = 100*&B*&BT/13030
SET &BT = 19254/(&B+185)
SET &U50 = 100*&B*&BT/19069
SET &BT = 48000/(&B+524)
SET &U80 = 100*&B*&BT/47476
WRITE   1740          &B       &U30.%         &U50.%         &U80.%
SET &B = 3024/&L*&L
SET &BT = 13165/(&B+135)
SET &U30 = 100*&B*&BT/13030
SET &BT = 19254/(&B+185)
SET &U50 = 100*&B*&BT/19069
SET &BT = 48000/(&B+524)
SET &U80 = 100*&B*&BT/47476
WRITE   3024          &B       &U30.%         &U50.%         &U80.%
SET &B = 6233/&L*&L
SET &BT = 13165/(&B+135)
SET &U30 = 100*&B*&BT/13030
SET &BT = 19254/(&B+185)
SET &U50 = 100*&B*&BT/19069
SET &BT = 48000/(&B+524)
SET &U80 = 100*&B*&BT/47476
WRITE   6233          &B       &U30.%         &U50.%         &U80.%
GOTO LOOP
OUT1: WRITE DEVICE INDEPENDENT BLOCKSIZE NOT POSSIBLE
GOTO LOOP
OUT: END

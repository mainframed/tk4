* THIS PROGRAM PRODUCED BY BRITISH STEEL CORPORATION CORBY
* REFER ANY PROBLEMS TO MALCOLM SISMEY TEL 053-66-2121 EXT 729
         TITLE 'SYIDTABLE  LISTER PROGRAM'NUMBER ONE'
         EJECT
*    FIRST PROGRAM OF A PAIR WHICH LIST A JOB CODE AND THE PACKS
*    ASSOCIATED WITH IT.
*    THIS PROGRAM LOADS SYIDTAB AND PUTS OUT RECORDS IN THE FORMAT
*    XXNNNNNN - WHERE  XX  IS THE LOG CODE AND XXXXXX IS VOLUME SERIAL
*    NUMBER.
*    THE NEXT PROGRAM IS A SORT OF THESE RECORDS INTO
*    ASCENDING  SEQUENCE.  THE  PROGRAM AFTER THAT IS A PRINT.
*
         EJECT
SYIDLST1 BEGIN
         LOAD  EP=SYIDTAB          LOAD THE TABLE
         LR    2,0                 LOAD ADDRESS INTO R2
LOOP1    CLC   0(6,2),ENDEND       IS LAST ENTRY IN TABLE
         OPEN  (OUTFILE,OUTPUT)    OPEN OUTPUT FILE
         BE    FINISH              YES FINISH
         MVC   OUTVOL,0(2)         MOVE VOLUME SERIAL NO TO OUTPUT
         LA    3,44(2)             SET R3 TO LAST CODE IN ENTRY
         LA    4,6(2)              SET R4 TO FIRST CODE
LOOP2    CLC   0(2,4),BL2          IS THIS ENTRY BLANK
         BE    NEXCARD             YES TRY NEXT CARD
         MVC   OUTLOG,0(4)         MOVE TO OUTPUT AREA
         PUT   OUTFILE,OUTAR       PUT OUT RECORD
         CR    3,4                 WAS THIS THE LAST ENRY ON A CARD
         BE    NEXCARD             YES GET NEXT CARD
         LA    4,2(4)              STEP UP
         B     LOOP2               GO BACK AND TRY NEXT CARD
NEXCARD  LA    2,47(2)             STEP UP TO NEXT CARD
         B     LOOP1               GO BACK AGAIN
FINISH   CLOSE OUTFILE
         L     13,4(13)
         RETURN (14,12)
*        CONSTANTS ETC
OUTFILE  DCB   DDNAME=OUT,DSORG=PS,MACRF=PM,LRECL=18,DEVD=DA
ENDEND   DC    CL6'ENDEND'
OUTAR    EQU   *
OUTLOG   DS    CL2                 LOG CODE
OUTVOL   DS    CL6                 VOL SERIAL NO
OUTREST  DS    CL10
BL2      DC    CL2'  '             BLANKS
         END   SYIDLST1

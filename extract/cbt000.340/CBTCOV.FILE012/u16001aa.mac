************************************************************************

  MEMBER   - $DOC1

  SYSTEM   - PRINT TAPE SPLITTER

  PROGRAMS - SU33SPL  :  MAIN PROGRAM
           - SM19PRM  :  PARM FIELD SCANNER
           - SU21GEN  :  HIGH-SPEED REWRITE OF IEBGENER
           - SU25EOF  :  WRITES EOF MARKER ON PDS OR SEQ FILE

  MACROS   - ENTER    :  ADDRESSABILITY ETC.
           - PARMSCAN :  SCAN PARM FIELD
           - IFOPEN   :  CHECK RESULTS OF OPEN
           - SYSPRINT :  PRINTER DCB
           - LEAVE    :  EXIT

************************************************************************

   THIS PROGRAM TAKES PRINT LINES ON A TAPE OR DISK AND SPLITS IT UP
 INTO SMALLER FILES AND CREATES JOBS TO PRINT THEM SEPARATELY. THIS
 STOPS THE SPOOL FILE BECOMING FULL AND ALLOWS RESTARTS AND REPRINTS
 TO BE DONE.

    THE SPLITS ARE ALWAYS DONE AT DOCUMENT (FULL PAGE) BOUNDARIES,
 TO ENABLE THIS TO BE DONE THE FILE MUST CONTAIN VALID CARRIAGE CONTROL
 CHARACTERS (ANS OR MACHINE CODE) AND THE FIRST CHARACTER ON THE FILE
 MUST BE A "SKIP TO CHANNEL 1" CONTROL CHARACTER.

    THE NUMBER OF DOCUMENTS TO BE CONTAINED IN EACH SPLIT IS DEFINED IN
 THE PARM FIELD. A DOCUMENT IS CONSIDERED TO BE A PAGE OF OUTPUT
 (BETWEEN CHANNEL 1 SKIPS). EACH SPLIT IS WRITTEN TO A MINI FILE AND A
 JOB IS THEN READ ONTO THE QUEUE TO PRINT THE MINI FILE WHILE THE MAIN
 JOB THEN CONTINUES ONTO THE NEXT MINI FILE. THE NUMBER OF MINI FILES
 USED CAN BE FROM 1 TO 100 BUT 5 TO 10 SHOULD BE ENOUGH. THE PROGRAM
 TAKES A CHECKPOINT AT THE END OF EACH SPLIT TO ENABLE A RESTART TO BE
 DONE. THE PROGRAM WRITES CONTROL INFORMATION TO THE CONTROL FILE AT THE
 END OF EACH SPLIT TO ENABLE REPRINTS OF ANY SPLIT TO BE DONE AT ANY
 TIME AFTER THE MAIN RUN.

    BEFORE USING ANY MINI FILE THE PROGRAM CHECKS TO SEE IF IT IS EMPTY
 (STARTS WITH AN END-OF-FILE MARKER). BECAUSE OF THIS THE MINI FILES
 MUST ALL BE SETUP BEFORE THE MAIN RUN USING THE EOF PROGRAM. THE JCL
 THAT THE PROGRAM WRITES TO THE QUEUE REQUIRES THE MINI FILES TO BE
 CATALOGED BUT THIS COULD BE CHANGED IN THE PROGRAM. THE DISPOSITION
 OF THE MINI FILES MUST BE "SHR" TO ENABLE THE IEBGENERS TO RUN
 CONCURRENTLY WITH THE SPLITTER. THIS DOES NOT CAUSE ANY PROBLEM AS
 THE SPLITTER CHECKS FOR AN END-OF-FILE MARKER BEFORE USING ANY FILE.

    DURING THE RUN OF THE SPLITTER ITS OPERATION MAY BE CONTROLLED BY
 USING THE "MODIFY" OPERATOR COMMAND. THE FOLLOWING COMMANDS ARE
 AVAILABLE :

     HOLD  :  THIS STOPS THE PROGRAM TEMPORARILY. IT MAY BE USED IF
              THE SPOOL FILE IS GETTING TOO FULL RATHER THAN
              CANCELLING THE JOB AND RESTARTING IT.

     GO    :  THIS RELEASES THE JOB AND ALLOWS IT TO CONTINUE AFTER
              A HOLD COMMAND.

     KILL  :  THIS TERMINATES THE PROGRAM AT THE END OF THE CURRENT
              DOCUMENT. THE CURRENT SPLIT WILL BE PRINTED AS A
              TRUNCATED SPLIT.

     END   :  THIS TERMINATES THE PROGRAM AT THE END OF THE CURRENT
              SPLIT.


    PARM FIELD PARAMETERS. THESE MAY BE ENTERED IN ANY ORDER OR OMITTED
 AS REQUIRED.

     SPLIT=N       :  NUMBER OF DOCUMENTS IN EACH SPLIT.
                      CAN BE 1 TO 8 DIGITS. DEFAULT = 500.

     ACT=NNN       :  OVERRIDES THE FIRST ACCOUNTING PARAMETER.
                      PROBABLY NEEDS CHANGING OR OMITTING.
                      DEFAULT = 065.

     FORM=XXXX     :  FOUR CHARACTER FORM IDENTIFIER TO BE PASSED
                      TO THE MINI FILE PRINT JOBS. NO DEFAULT.

     SOUT=X        :  SYSOUT CLASS FOR MINI FILE PRINT JOBS.

     REPRINT=NAME  :  REPRINTS THE SPLIT WHOSE JOBNAME WAS "NAME".


    NOTES.
    ******

    A CHECK IS MADE ON THE LENGTH OF EACH DOCUMENT TO ENSURE THE
 PROGRAM IS WORKING PROPERLY. IF THE PROGRAM FINDS A DOCUMENT OF
 MORE THAN 128 LINES THEN IT TERMINATES WITH AN ERROR MESSAGE.
 THIS NUMBER MAY BE CHANGED EASILY IN THE PROGRAM IF NECESSARY.

    IF AT ANY TIME ALL THE MINI FILES BECOME FULL THEN THE PROGRAM
 ISSUES A MESSAGE TO THE OPERATOR AND WAITS FOR ONE TO BE PRINTED.
 IT THEN CHECKS EVERY 30 SECONDS AND ISSUES THE MESSAGE TO THE
 OPERATOR AGAIN.

    THE JOBNAME FOR THE MINI FILE PRINT JOBS IS FORMED BY APPENDING
 A THREE DIGIT NUMBER TO THE FIRST FIVE (OR LESS) CHARACTERS OF THE
 JOBNAME OF THE MAIN SPLITTER JOB.
 E.G. IF THE SPLITTER JOB WAS CALLED "SPLITALL" THE FIRST PRINT JOB
      WOULD BE CALLED "SPLIT001" ETC.

    THE CHECKPOINT IDENTIFIER IS THE JOBNAME OF THE NEXT PRINT JOB
 TO BE PRODUCED. SO IF YOU WANT TO START AFTER THE FOURTH SPLIT THE
 CHECKPOINT ID TO USE IS "SPLIT005" FOR THE ABOVE EXAMPLE. THIS MEANS
 THAT THE FIRST CHECKPOINT ID WOULD BE "SPLIT002" IN THE EXAMPLE ABOVE.

    ON A REPRINT IF THE INPUT DATASET IS ON A TAPE THEN "DEFER" MUST
 BE CODED IN THE UNIT PARAMETER TO ALLOW THE PROGRAM TO START WITH THE
 CORRECT VOLUME OF A MULTI-VOLUME FILE.

    WHEN SETTING UP THE MINI FILES ENOUGH SPACE MUST BE ALLOWED TO
 CONTAIN A COMPLETE SPLIT. SECONDARY ALLOCATION WILL BE USED IF
 SPECIFIED.

    THE USUAL RULES APPLY TO THE CHECKPOINT DATASET AND RESTARTABILITY
 OF A JOB WITH TEMPORARY DATASETS.

    NO REPRINTS SHOULD BE ATTEMPTED BEFORE THE MAIN SPLITTER RUN HAS
 COMPLETED NORMALLY.

    TO ENABLE REPRINTS TO BE DONE AT ANY TIME THE CONTROL FILE MUST BE
 SAVED. ALL OTHER FILES (EXCEPT THE INPUT FILE!) CAN BE NEW FILES FOR
 A REPRINT BUT NOT FOR A RESTART.


    J.C.L. FOR MAIN SPLITTER RUN.
    *****************************

//JOBNAME JOB (ACCT# ETC.),PROGS NAME,RD=NR
//STEPA EXEC PGM=SPLITTER,PARM=OPTIONAL
//SYSPRINT DD SYSOUT=A
//IEFRDER DD SYSOUT=(A,INTRDR)
//INTAPE DD PARAMETERS FOR INPUT FILE
//CONTROL DD UNIT=SYSDA,SPACE=(TRK,(1,1)),DSN=CONTROL.FILE,
//        DCB=BLKSIZE=2300,DISP=(,KEEP,KEEP)
//CHKPT DD UNIT=SYSDA,SPACE=(CYL,(3,3)),DSN=CHECK.DATASET,
//        DISP=(,KEEP)
//MINIXX DD DSN=MINI.FILEXX,DISP=SHR
     .
     .
     .
     .
//MINIZZ DD DSN=MINI.FILEZZ,DISP=SHR
//

  THE BLOCKSIZE ON THE "CONTROL" DD CARD MUST BE A MULTIPLE OF
 23 BYTES.

  MINI FILE DDNAMES CAN BE FROM MINI00 TO MINI99, THEY CAN BE SPECIFIED
 IN ANY ORDER AND DO NOT HAVE TO BE CONSECUTIVE NOR START AT 00. IF TWO
 DD CARDS WITH THE SAME NAME ARE USED THEN RESULTS ARE UNPREDICTABLE.
 IF A MINI FILE IS NOT EMPTY AND IS NOT "DISP=SHR" THEN AN ERROR MESSAGE
 IS ISSUED AND IT IS NOT USED.
  A TIME PARAMETER MAY BE REQUIRED IF THE INPUT FILE IS VERY LARGE.


    FOR A RESTART THE J.C.L. IS THE SAME EXCEPT THAT YOU MUST ADD A
 SYSCHK DD CARD AND THE CHKPT DD CARD MUST SPECIFY "DISP=MOD" AND YOU
 MUST SPECIFY A RESTART PARAMETER ON THE JOB CARD.


    FOR A REPRINT THE CONTROL AND INTAPE FILES MUST BE THE SAME.
 NO CHKPT DD CARD IS REQUIRED AND ONLY ONE MINI FILE NEEDS TO BE
 SPECIFIED.


************************************************************************

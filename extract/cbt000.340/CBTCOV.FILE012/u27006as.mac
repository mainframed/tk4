SY4      CSECT
*
*   SY4
* SEE DESCRIPTION OF HOUSEKEEPING SYSTEM IN SY1 FOR USE OF THIS
*    PROGRAM
*
**************************************************************
* THIS PROGRAM UPDATES A DATE FILE DDNAME= DATEFL BY ADDING  *
* THE PERIOD ,WHICH IS WRITTEN TO THE DATE FILE BY SY1,TO THE DATE
* AND REWRITING IT TO THE FILE.THE FILES WHICH ARE INPUT TO  *
* THIS PROGRAM ARE ALL USED TO CONTROL THE DIFFERRENT LEVELS *
* OF BACKUP. FORMAT OF THE DATE FILE DEFINED BY DDNAME=DATEFL*
* IS:- FIRST 4 BYTES..DATE IN PACKED FORMAT(00YYDDDS).THE    *
* NEXT 2 BYTES CONTAIN THE PERIOD WHICH WAS PICKED OP AS A   *
* PARAMETER BY SY1.THE REMAINDER OF THE RECORD IS UNUSED.THE *
* PROGRAM IS EXECUTED AT THE END OF THE ENDOFDAY PROCEDURE   *
* ONLY WHEN A CERTAIN LEVEL OF BACKUP HAS BEEN SUCCESSFULLY  *
* COMPLETED.IT THEN UPDATES THE FILE WHICH CONTROLS THAT     *
* LEVEL.                                                     *
**************************************************************
         XR   15,15
         SAVE (14,12)
         BALR  12,0
         USING *,12
         LR    11,13
         LA    13,SAVER
         ST    11,4(13)
         ST    13,8(11)
         OPEN  (CHDATE,(UPDAT))
         GET   CHDATE         READ DATE FILE
         LR    8,1
         USING INDATE,8
         AP    DTEDTE+2(2),PERIOD
         MVC   PERIOD,=X'000C'
         PUTX  CHDATE
         CLOSE CHDATE
         L     13,4(13)
         RETURN (14,12)
SAVER    DS    9D
CHDATE   DCB   DSORG=PS,DDNAME=DATEFL,MACRF=(GL,PL)
INDATE   DSECT
DTEDTE   DS    CL4
PERIOD   DS    CL2
         DS    CL74
         END

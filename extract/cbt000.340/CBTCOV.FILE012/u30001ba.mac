GENPRT
GENERAL FILE PRINT PROGRAM
THIS PROGRAM WRITTEN IN B.A.L. WILL PRINT ALL THE LOGICAL RECORDS OR
SELECT LOGICAL RECORDS OF ANY SEQUENTIAL OR DIRECT FILE ON
TAPE, 2314 OF 3330. A BDAM FILE IS PROCESSED AS A SEQUENTIAL FILE.
THE RECORD FORMATS ACCEPTED ARE:
F  FB  V  VB  U.
ISAM FILES WITH RECORD FORMATS OF F, FB, V, VB ON 2314 OR 3330 MAY
ALSO BE SPECIFIED AS THE INPUT FILE.
THE PROGRAM IS GENERALISED IN THAT IT OBTAINS BLKSIZE, LRECL, RECFM
INFORMATION FOM THE STANDARD LABELS FOR THE FILE. THIS MEANS THEREFORE
THET:
A) IF THE FILE IS CATALOGUED, ONLY THE DSNAME AND DISP PARAMETERS
ARE REQUIRED ON THE DD CARD DESCRIBING THE FILE,
B) IF THE FILE IS NOT CATACLOGUED BUT HAS STANDARD LABELS THEN
DSNAME, DISP, VOL AND UNIT PARAMETERS ARE REQUIRED ON THE
DD CARD, AND
C) IF THE FILE IS UNLABELLED OR IS A DOS FILE, THEN DCB AND LABEL
INFORMATION MUST BE ENTERED ON THE DD CARD IN ADDITION TO THAT
DETAILED IN (B).
THERE IS A CATALOGUED PROCEDURE TO INVOKE THE PROGRAM AND AN EXAMPLE OF
THE REQUIRED JCL IS SHOWN IN APPENDIX A.
THE PRINTED OUTPUT IS THE LOGICAL RECORDS OF THE FILE AND MAY BE IN
CHARACTER OF HECADECIMAL AND CHARACTER. HOWEVER, 'GENPRT' CAN SEARCH A
FILE AND ONLY PRINT BETWEEN SPECIFIED LIMITS OR MATCH OUT CERTAIN RECORD
ACCORDING TO CERTAIN MATCHING INFORMATION. VARIOUS COMBINATIONS EXIST
AND A FULL LIST IS SPECIFIED IN APPENDIX C. THE VARIOUS LIMITS FIELD
AND MATCHING FIELDS MAY BE SPECIFIED TO USE CHARACTER OR PACKED DECIMAL
DATA.
IF MUST BE NOTED THAT WHEN V OR VB FILES ARE TO BE PRINTED THE LOGICAL
RECORDS PRINTED INCLUDE THE RECORD DESCRIPTOR WORD (RDW). THIS 4 BYTE
FIELD MUST BE TAKEN INTO ACCOUNT WHEN SPECIFYING DISPLACEMENTS OF LIMITS
AND MATCHING FIELDS (SEE APPENDIX B).
IF THE FORMAT OF THE PRINTED OUTPUT FROM GENPRT OS NOT ACCEPTABLE, THEN
A SPECIALISED PRINT ROUTINE MAY BE USED. THIS IS DONE BY SPECIFYING THE
NAME OF THE SPECIALISED ROUTINE IN THE PARM FIELD OF THE EXEC CARD USED
TO INVOKE THE GENPRT PROCEDURE (SEE APPENDIX A). IF A ROUTINE NAME IS
SPECIFIED, THEN GENPRT WILL PERFORM ITS NORMAL RETRIEVAL OF RECORDS BUT
WILL NOT PRINT ANY RECORDS AND INSTEAD WILL LOAD AND CALL THE SPECIFIED
ROUTINE, PASSING THE ADDRESS OF THE RETRIEVED RECORD(S) TO THE ROUTINE.
THIS IS DONE USING NORMAL LINKAGE CONVENSIONS AND RETURN SHOULD BE MADE
TO GENPRT IN THE NORMAL MANNER. THE SPECIALISED ROUTINE NEED NOT
NECESSARILY BE A PRINTING ROUTINE; IT MIGHT BE A ROUTINE FOR EXTRACTING
RECORDS FROM A LARGE MASTER FILE IN ORDER TO CREATE A SMALL TESTING FILE
GENPRT WILL OPEN AND CLOSE THE INPUT FILE AND THE SPECIALISED ROUTINE
NEED ONLY BE CONCERNED WITH PROCESSING THE RECORDS PASSED BY GENPRT.
PRIOR TO EOJ, AN EOF INDICATION WILL BE PASSED BY GENPRT TO ALLOW THE
SPECIALISED ROUTINE TO PERFORM ITS OWN EOJ PROCESSING. IT WILL BE THE
ROUTINE'S RESPONSIBILITY TO CATER FOR THE SITUATION WHERE NO RECORDS ARE
RETRIEVED AND PASSED PRIOR TO RECEIVING THE EOF INDICATION. THE EOF
INDICATION PASSED IS A CHARACTER STRING OF THE FORM  *,*,*,*
THE SPECIALISED ROUTINE SHOULD USE THE 'PRINTER2' FILE OF RBIORTN, AS
'PRINTER1' IS USED BY GENPRT.
THE INFORMATION REGARDING THE REQUIRED FUNCTION TO BE PERFORMED BY
'GENPRT' IS ENTERED THROUGH A CONTROL CARD AND THE LAYOUT OF THE CARD
WITH ITS RELEVANT FIELDS MARKED IS SHOWN IN APPENDIX D. THIS PRO FORMA
SHEET SHOULD BE USED TO PREPARE THE CONTROL CARDS, AND SUPPLIES OF THE
FORM IS AVAILABLE IN THE PROGRAMMING DEPARTMENT.
THE 'GENPRT' PROGRAM PERFORMS CERTAIN CHECKS IN NUMERIC FIELDS AND
CERTAIN COMBINATIONS OF PARAMETERS, AND ALSO THE VALIDITY OF PARAMETERS:
THE EXTENT OF THE CERIFICATION IS DETAILED IN APPENDIX B WHICH DESCRIBES
IN DETAIL THE USES AND ALLOWABLE CONTENTS OF ALL THE FIELDS ON THE
CONTROL CARD.
IF A SPECIFIED ROUTINE IS USED, THEN IT MAY, IF DESIRED, READ ITS
OWN CONTROL CARD. THIS SHOULD BE READ USING RBIORTN, THE ONLY CONSTRAINT
BEING THAT THE GENPRT CONTROL CARD MUST BE THE FIRST CARD IN THE CARDIN
STREAM.
IF VERIFICATION FAILS ON ANY FIELD THE JOB WILL BE ENDED WITH AN
EXPLANATORY MESSAGE PRINTED. IT SHOULD BE NOTED THAT 'GENPRT' CAN ONLY
CHECK FOR VALID NUMERIC DATA, AND IF WHEN USING PACKED DECIMAL FIELDS A
DATA EXCEPTION CANCELS THE JOB, THEN THE INFORMATION ON THE CONTROL CARD
SHOULD BE SCRUTINISED FIRST, E.G., INCORRECT POINTER TO THE PACKED DECIM
FIELD, BEFORE SUSPECTING THE PROGRAM.
COLUMN 78 OF THE CONTROL CARD IS USED TO INDICATE WHETHER THE INPUT
FILE IS AN ISAM FILE OR A 'NON' ISAM FILE; IF COLUMN 78 CONTAINS AN
S, AN ISAM FILE IS ASSUMED BUT IF COLUMN 78 IS BLANK, OR ANY RATE
NOT AN S, THEN A SAM OR BDAM FILE IS ASSUMED.
NOTE
IF A VARIABLE-UNBLOCKED ISAM FILE IS TO BE PRINTED, IT MUST BE SPECIFIED
AS A VARIABLE-BLOCKED FILE (I.E. ON THE DD CARD DESCRIBING THE FILE
DCB=RECFM=VB). THIS IS DUE TO THE WAY THE RDW IS RETURNED FOR VARIABLE-
UNBLOCKED ISAM FILES.
GENPRT - APPENDIX 'A'
//GENPRT   JOB
//         EXEC GENPRT
//GENPRT.FILEIN DD  DSNAME= FILE NAME,
//             DISP=OLD OR SHR,
//             VOL=SER=SERIAL NUMBER,
//             UNIT=XXXX
//GENPRT.CARDIN DD *
   GENPRT CONTROL CARD
IF A SPECIALISED ROUTINE IS TO BE USED
//GENPRT   JOB
//         EXEC GENPRT,PARM.GENPRT=ROUTNAME  (ROUTNAAME BEING REPLACED B
ACTUAL ROUTINE NAME
//GENPRT.FILEIN DD  AS ABOVE
//GENPRT.PRINTER2 DD SYSOUT=A  ALLOCATED AS REQD.
//GENPRT.CARDIN DD *
    GENPRT CONTROL CARD
    ROUTINE CONTROL CARD IF REQD.
//GENPRT   EXEC PGM=GENPRT
//PRINTER1 DD  SYSOUT=A,SPACE=(CYL,(1,1),RLSE)
//FILEIN   DD  DUMMY
APPENDIX B
COLUMN FIELD FUNCTION
1 IDENTIFIER IDENTIFIES THE 'GENPRT' CONTROL CARD:
2 INPUT MEDIA IDENTIFIES INPUT MEDIA TYPE.
T = TAPE D = DISK
3 - 6 LOGICAL RECORD 1 TO 4 DIGITS RIGHT-ALIGNED AND PADDED
LENGTH
WITH ZEROS INDICATING THE LENGTH OF THE
LOGICAL RECORD.
VERIFIED FOR NUMERIC.
7 - 12 START RECORD NUMBER 1 TO 6 DIGITS RIGHT-ALIGNED AND PADDED WITH
ZEROS INDICATING THE RECORD AT WHICH GENPRT
IS TO ITS PROCESSING OF THE INPUT
FILE. (X-1 RECORDS WILL BE BYPASSED)
VERIFIED FOR NUMERIC.
13 - 22 LOWER LIMIT 1 TO 10 CHARACTERS SPECIFYING THE LOWER
INCLUSIVE ID WHICH WILL BE USED TO DETERMINE
IF A RECORD SHOULD BE PRINTED
SEE NOTE 1 AT THE END OF THIS APPENDIX.
23 - 32 UPPER LIMIT AS FOR LOWER LIMIT BUT SPECIFYING THE UPPER
INCLUSIVE ID WHICH WILL BE USED TO DETERMINE
IF A RECORD SHOULD BE PRINTED.
33-36 DISPLACEMENT FOR LIMITS 1 TO 4 DIGITS RIGHT-ALIGNED AND PADDED
WITH ZEROS INDICATING THE ACTUAL BYTE
WITHIN THE RECORD AT WHICH THE LIMITS
FIELD STARTS.  SEE NOTE 2 AT THE END OF
THIS APPENDEX.
VERIFIED FOR NUMERIC.
37 LENGTH OF LIMITS FIELD 1 DIGIT INDICATING THE 'LENGTH OF THE
LIMITS FIELD WITHIN THE RECORD MINUS 1'
SEE THE NOTE AT THE END OF THIS APPENDIX
VERIFIED FOR NUMERIC.
38 LIMITS PACKED THE CODE 'P' IN THIS COLUMN INDICATES IF
THE LIMITS IN THE RECORD ARE PACKED.
IF NOT 'P', CHARACTER IS ASSUMED.
39-44 MAXIMUM NUMBER OF 1 TO 6 DIGITS RIGHT-ALIGNED AND PADDED
RECORDS
WITH ZEROS INDICATING THE MAXIMUM NUMBER
OF RECORDS WHICH MAY BE PRINTED BEFORE
FORCING EOJ.  IF THIS FIELD IS ALL BLANKS
THEN A DEFAULT OF 100 IS ASSUMED UNLESS
 CODE 'E' IS SPECIFIED IN COLUMN 45,WHEN
NO MAXIMUM NUMBER CONTROL IS THEN USED.
IF THIS FIELD IS NOT ALL BLANKS IT
IS VERIFIIS VERIFIED FOR NUMERIC
45 EOF INDICATOR THE CODE 'E' INDICATES THAT PRINTING IS TO
CONTINUE UNTIL END OF FILE IS REACHED. ANY
OTHER CODE IS IGNORED.
THIS CODE 'E' CAN ALSO BE USED TO INDICATE,
WHEN SEARCHING THE INPUT FILE USEING LOWER
AND UPPER LIMITS, THAT THE FILE IS UNSORTED
AND THE SEARCH SHOULD BE CONTINUED UNTIL
EOF IS REACHED AND NOT JUST UNTIL THE
UPPER LIMIT IS PASSED.
46 - 55 SENIOR MATCH 1 TO 10 CHARACTERS SPECIFIYING THE SENIOR
MATCH DATA WJICH IS TO BE APPLIED TO
SELECT RECORDS FOR PRINTING.
SEE NOTE 1 AT THE END OF THIS APPENDIX.
56 - 59 DISPLACEMENT FOR 1 TO 4 DIGITS RIGHT-ALIGNES AND PADDED
SENIOR
WITH ZEROS INDICATING THE ACTUAL BYTE
WITHIN A RECORD A T WHICH THE SENIOR MATCH
FIELD STARTS. SEE NOTE 2 AT THE END OF
THIS APPENDIX.
VERIFIED FOR NUMERIC.
60 LENGTH OF SENIOR 1 DIGIT INDICATING THE 'LENGTH OF THE
MATCH FIELD
SENIOR MATCH FIELD WITHIN THE RECORD
MINUS 1'. SEE NOTE 3 AT THE END OF
THIS APPENDIX.
VARIFIED FOR NUMERIC.
61 SENIOR MATCH PACKED CODE 'P' IN THIS COLUMN INDICATES IF
THE SENIOR MATCH FIELD IN THE RECORD
IS PACKED.  IF NOT 'P', CHARACTER
IS ASSUMED.
62-72 JUNIOR MATCH THESE FIELDS ARE USED AXECTLY AS
72-75 DISPLACEMENT FOR THEIR SENIOR EQUIVALENTS. THESE
JUNIOR
'JUNIOR' FIELDS ARE ONLY INTERROGATED
76 LENGTH OF JUNIOR
MATCH FIELD WHEN CODE 'B' OR 'E' IS SPECIFIED IN
77 JUNIOR MATCH PACKED) COLUMN 79.
78 ISAM INDICATOR CODE 'S' IN THIS COLUMN INDICATES AN
ISAM INPUT FILE. IF NOT 'S' A SAM OR
BDAM FILE IS ASSUMED
79 MATCH TYPE INDICATOR REQUIRES TO BE SPECIFIED IF THE SENIOR
AND JUNIOR MATCH FIELDS ARE UTILISED.
'B' MEANS SENIOR AND JUNIOR EQUAL MATCH
IS REQUIRED FOR A RECORD TO BE PRINTED.
'E' MEANS SENIOR OR JUNIOR EQUAL MATCH
IS REQUIRED.
IF THE TWO MATCH FIELDS ARE APECIFIED
THIS COLUMN MUST CONTAIN 'B' OR 'E',
OTHERWISE THE JOB IS CANELLED. IF ONLY
SENIOR MATCH IS SPECIFIED, THEN THIS
COLUMN SHOULD BE BLANK.
80 PRINT TYPE INDICATOR INDICATES THE TYPE OF PRINTOUT REQUIRED.
'C' MEANS CHARACTER PRINTING ONLY.
'H' MEANS CHARACTER AND HEXADECIMAL
PRINTING REQUIRED.
IF NEITHER OF THESE CODES ARE SPECIFIED
THE PROGRAM DEFAULTS TO 'H'.
NOTES FOR APPENDIX B
NOTE 1 - WHEN COMPLETING THE LOWER OF UPPER LIMITS FIELDS OR THE SENIOR
OF JUNIOR MATCH FIELDS, IF THE FIELD IS NOT TO BE PACKED THE
DATA SHOULD BE ENTERED LEFT-ALIGNED AND PADDED WITH BLANKS.
NOT VERIFIED IN THIS CASE. IF THE FIELD IS TO BE PACKED THE
DATA SHOULD BE ENTERED RIGHT-ALIGNED AND PADDED WITH ZEROS.
IN THIS CASE THE FIELDS WILL BE VERIFIED FOR NUMERIC.
NOTE 2 - WHEN ENTERING THE DISPLACEMENT FOR THE LIMITS OR THE
SENIOR OF JUNIOR MATCH FIELDS, THE ACTUAL BYTE WITHIN THE
RECORD AT WHICH THE FIELD STARTS SHOULD BE SPECIFIED, E.G.
IF THE FIELD IS THE FIRST FIVE BYTES OF THE RECORD THEN 0001
SHOULD BE ENTERED IN THE DISPLACEMENT FIELD.
NOTE 3 - THE VALUE SPECIFIED FOR THE LIMITS FIELD OR THE SENIOR OR
JUNIOR FIELDS TO INDICATE THE LENGTH OF THE FIELD ON THE RECORD
IS ALWAYS ONE LESS THAN ITS ACTUAL LENGTH, E.G. FOR A 10 BYTE
FIELD ENTER 9, FOR A 1 BYTE FIELD ENTER 0. THE MAXIMUM IS OF
COURSE 9 (I.E. A 10 BYTE FIELD).
APPENDIX C
1. PRINTING FROM THE START OF THE INPUT FILE UP TO THE END.
2. PRINTING FROM THE START OF THE INPUT FILE UNTIL A SPECIFIED MAXIMUM
NUMBER OF RECORDS HAVE BEEN PRINTED.
3. PRINTING STARTING AT A SPECIFIED RECORD UP TO THE END OF THE INPUT
FILE.
4. PRINTING STARTING AT A SPECIFIC RECORD UNTIL A SPECIFIED MAXIMUM
NUMBER OF RECORDS HAVE BEEN PRINTED.
5. OPTIONS 1 - 4 COMBINED WITH MATCHING.
6. PRINTING FROM THE START OF THE INPUT FILE, OR SPECIFIC START RECORD,
USING LOWER AND UPPER LIMITS.
NOTE: OPTION 6 WILL PROCESS UNSORTED AND SORTED FILES DIFFERENTLY.
IF A SORTED FILE IS TO BE PRINTED THE PROGRAM WILL TERMINATE
PRINTING AND END WHENEVER THE UPPER LIMIT IS PASSED.  IF AN
UNSORTED FILE IS TO BE PRINTED, CODE 'E' SHOULD BE PUNCHED IN
COLUMN 45 OF THE CONTROL CARD AND THIS WILL CAUSE THE PROGRAM
TO CONTINUE SEARCH THROUGH THE COMPLETE FILE.
7. OPTION 6 MAY BE CONTROLLED BY SPECIFYING A MAXIMUM NUMBER OF RECORDS
TO BE PRINTED, WHETHER THE INPUT FILE IS SORTED OR UNSORTED.
8. OPTIONS 6 AND 7 COMBINED WITH MATCHING.
THE PROGRAM WILL NOT MAKE ANY COMMENT IN THE EVENT OF EOF BEING
REACHED BEFORE A SPECIFIED MAXIMUM NUMBER OF RECORDS HAVE BEEN PRINTED

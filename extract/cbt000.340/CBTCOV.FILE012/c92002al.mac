PROC 0
CONTROL NOFLUSH NOMSG/*LIST CONLIST MSG SYMLIST
SET COMMAND=
SET ES=HEX
SET XS=0123456789ABCDEF
DO WHILE &COMMAND^=END
  ISPEXEC DISPLAY PANEL(V00P71)
  IF &LASTCC=8 THEN SET COMMAND=END
  ELSE DO
    IF &STR(&E1&E2&E3&E4&E5&E6&E7&E8&E9&E10&HEXDEC)^=+
    &STR(&ES) THEN DO
      SET R1= &STR(
      SET R2= &STR(
      SET R3= &STR(
      SET R4= &STR(
      SET R5= &STR(
      SET R6= &STR(
      SET R7= &STR(
      SET R8= &STR(
      SET R9= &STR(
      SET R10=&STR(
      IF &STR(&E1)^= THEN DO
        SET E=&STR(&E1)
        SET RET=RE1
        GOTO CALC
        RE1: SET R1=&STR(&RESULT99)
        END
      IF &STR(&E2)^= THEN DO
        SET E=&STR(&E2)
        SET RET=RE2
        GOTO CALC
        RE2: SET R2=&STR(&RESULT99)
        END
      IF &STR(&E3)^= THEN DO
        SET E=&STR(&E3)
        SET RET=RE3
        GOTO CALC
        RE3: SET R3=&STR(&RESULT99)
        END
      IF &STR(&E4)^= THEN DO
        SET E=&STR(&E4)
        SET RET=RE4
        GOTO CALC
        RE4: SET R4=&STR(&RESULT99)
        END
      IF &STR(&E5)^= THEN DO
        SET E=&STR(&E5)
        SET RET=RE5
        GOTO CALC
        RE5: SET R5=&STR(&RESULT99)
        END
      IF &STR(&E6)^= THEN DO
        SET E=&STR(&E6)
        SET RET=RE6
        GOTO CALC
        RE6: SET R6=&STR(&RESULT99)
        END
      IF &STR(&E7)^= THEN DO
        SET E=&STR(&E7)
        SET RET=RE7
        GOTO CALC
        RE7: SET R7=&STR(&RESULT99)
        END
      IF &STR(&E8)^= THEN DO
        SET E=&STR(&E8)
        SET RET=RE8
        GOTO CALC
        RE8: SET R8=&STR(&RESULT99)
        END
      IF &STR(&E9)^= THEN DO
        SET E=&STR(&E9)
        SET RET=RE9
        GOTO CALC
        RE9: SET R9=&STR(&RESULT99)
        END
      IF &STR(&E10)^= THEN DO
        SET E=&STR(&E10)
        SET RET=RE10
        GOTO CALC
        RE10: SET R10=&STR(&RESULT99)
        END
      SET ES=&STR(&E1&E2&E3&E4&E5&E6&E7&E8&E9&E10&HEXDEC)
      END
    END
  END
EXIT
CALC: ERROR GOTO NONN
SET RESULT99=0+&EVAL(&E)
GOTO RESULT
NONN: ERROR GOTO ERR
SET E=&STR( &E )
SET &CC=1
DO WHILE &CC<&EVAL(&LENGTH(&STR(&E)))
  SET CC=&EVAL(&CC+1)
  IF &SUBSTR(&CC,&STR(&E))=R THEN SET E=&STR(&SUBSTR(1:&CC-1,&STR(&E))+
  &STR(&&)&SUBSTR(&CC:&LENGTH(&STR(&E)),&STR(&E)))
  IF &SUBSTR(&CC,&STR(&E))=&STR(') THEN DO
    SET &P=&EVAL(&CC-1)
    SET &CC=&EVAL(&CC+1)
    IF &SUBSTR(&CC,&STR(&E))<A THEN GOTO ERR
    SET &N=0
    SET &X=0
    DO WHILE &SUBSTR(&CC,&STR(&E))>=A
      SET X=&EVAL(&X*16+&N)
      SET C=&SUBSTR(&CC,&STR(&E))
      IF &C>=0 THEN SET N=&C
      ELSE DO
        IF &C<D THEN DO
          IF &C<B THEN SET N=10
          ELSE DO
            IF &C=B THEN SET N=11
            ELSE SET N=12
            END
          END
        ELSE DO
          IF &C>E THEN DO
            IF &C=F THEN SET N=15
            ELSE GOTO ERR
            END
          ELSE DO
            IF &C=E THEN SET N=14
            ELSE SET N=13
            END
          END
        END
      SET &CC=&EVAL(&CC+1)
      END
    SET X=&EVAL(&X*16+&N)
    SET E=&STR(&SUBSTR(1:&P,&STR(&E))&STR(&X)+
    &SUBSTR(&CC:&LENGTH(&STR(&E)),&STR(&E)))
    SET CC=&EVAL(&P+&LENGTH(&X)+1)
    END
  END
SET RESULT99 = 0+&EVAL(&E)
RESULT: IF &HEXDEC=DECIMAL THEN DO
  ERROR OFF
  GOTO &RET
  END
IF &RESULT99<0 THEN DO
  SET &SIGN=&STR(-)
  SET &RESULT99=&EVAL(-1*&RESULT99)
  END
ELSE SET &SIGN=&STR()
SET RESULT99X=&SUBSTR(&EVAL((&RESULT99//16)+1),&XS)
SET RESULT99=&RESULT99/16
IF &RESULT99=0 THEN GOTO RESX
SET RESULT99X=&SUBSTR(&EVAL((&RESULT99//16)+1),&XS)&RESULT99X
SET RESULT99=&RESULT99/16
IF &RESULT99=0 THEN GOTO RESX
SET RESULT99X=&SUBSTR(&EVAL((&RESULT99//16)+1),&XS)&RESULT99X
SET RESULT99=&RESULT99/16
IF &RESULT99=0 THEN GOTO RESX
SET RESULT99X=&SUBSTR(&EVAL((&RESULT99//16)+1),&XS)&RESULT99X
SET &RESULT99=&RESULT99/16
IF &RESULT99=0 THEN GOTO RESX
SET RESULT99X=&SUBSTR(&EVAL((&RESULT99//16)+1),&XS)&RESULT99X
SET RESULT99=&RESULT99/16
IF &RESULT99=0 THEN GOTO RESX
SET RESULT99X=&SUBSTR(&EVAL((&RESULT99//16)+1),&XS)&RESULT99X
SET RESULT99=&RESULT99/16
IF &RESULT99=0 THEN GOTO RESX
SET RESULT99X=&SUBSTR(&EVAL((&RESULT99//16)+1),&XS)&RESULT99X
SET RESULT99=&RESULT99/16
IF &RESULT99=0 THEN GOTO RESX
SET RESULT99X=&SUBSTR(&EVAL((&RESULT99//16)+1),&XS)&RESULT99X
SET RESULT99=&RESULT99/16
RESX: ERROR OFF
SET RESULT99=&STR(&SIGN'&RESULT99X)
GOTO &RET
ERR: SET RESULT99=??????
ERROR OFF
GOTO &RET

00010     PRINT "U. OF TEXAS STAR TREK GAME BY GRADY HICKS AND JIM KORP.
00020     PRINT "GENERAL IDEA STOLEN FROM PENN. U. BY HICKS."
00030     PRINT "ADAPTED TO PURDUE :ALFIE: BY LARRY CUNNINGHAM."
00040     GOSUB 14830
00050     PRINT "   BE CAREFUL AND HAVE A GOOD TIME."
00060     PRINT
00070     PRINT
00080     DIM Q$(10)
00090    DIM G(8,8),Q(8,8),D(8),K(10,3),N(3),C(4,2)
00100    DIM C$(20)
00110    GOSUB 11140
00120    PRINT "   TO PLAY SHORT VERSION, TYPE 1 ---"
00130    PRINT "   TO PLAY REGULAR VERSION, TYPE 2:";
00140    INPUT V
00150    IF V=1 THEN 190
00160    IF V=2 THEN 190
00170    PRINT
00180    GOTO 120
00190    REM:  M1=1 IS A FLAG TO REQUEST POSTHUMOUS RATING
00200    M1=1
00210    E0=3000
00220    E=3000
00230    P0=13
00240    P=13
00250    S9=200
00260 RANDOMIZE
00270    GOSUB 11510
00280    DEF FNO(F)=SQR((K(F,1)-S1)×2+(K(F,2)-S2)×2)
00290    Q1=INT(RND*8+1)
00300    Q2=INT(RND*8+1)
00310    F=1
00320    T0=INT(RND*50+20)*100
00330    T=T0
00340    T9=25+INT(RND*11)
00350    FOR I=1 TO 7
00360    D(I)=0
00370    NEXT I
00380    S1=INT(RND*8+1)
00390    S2=INT(RND*8+1)
00400    DIM F$(12)
00410    DIM N$(15)
00420    REM: SET UP GALAXY
00430    B9=0
00440    LET E4=W3=C5=0
00450    Z$="DOWN"
00460    A9=3000
00470    K9=0
00480    MAT C=ZER
00490    FOR I=1 TO 8
00500    FOR J=1 TO 8
00510    R=RND*64
00520    IF V=2 THEN 690
00530    T9=10+INT(RND*11)
00540    IF R>=.78 THEN 570
00550    K3=4
00560    GOTO 670
00570    IF R>=2.00 THEN 600
00580    K3=3
00590    GOTO 670
00600    IF R>=5.28  THEN 630
00610    K3=2
00620    GOTO 670
00630    IF R>=9.28 THEN 660
00640    K3=1
00650    GOTO 670
00660    K3=0
00670    K9=K9+K3
00680    GOTO 1030
00690    REM: DETERMINE NUMBER OF KLINGONS, BASES AND STARS.
00700    IF R>=.10 THEN 730
00710    K3=9
00720    GOTO 980
00730    IF R>=.25 THEN 760
00740    K3=8
00750    GOTO 980
00760    IF R>=.50 THEN 790
00770    K3=7
00780    GOTO 980
00790    IF R>=1.00 THEN 820
00800    K3=6
00810    GOTO 980
00820    IF R>=1.50 THEN 850
00830    K3=5
00840    GOTO 980
00850    IF R>=3.00 THEN 880
00860    K3=4
00870    GOTO 980
00880    IF R>=6.28 THEN 910
00890    K3=3
00900    GOTO 980
00910    IF R>=9.00 THEN 940
00920    K3=2
00930    GOTO 980
00940    IF R>=14.28 THEN 970
00950    K3=1
00960    GOTO 980
00970    K3=0
00980    K9=K9+K3
00990    B3=RND
01000    IF B3<=.97 THEN 1030
01010    B3=1
01020    GOTO 1040
01030    B3=0
01040    B9=B9+B3
01050    S3=INT(RND*8+1)
01060    G(I,J)=K3*100+B3*10+S3
01070    NEXT J
01080    NEXT I
01090    K0=K9
01100    IF B9>0 THEN 1150
01110    I=INT(RND*8+1)
01120    J=INT(RND*8+1)
01130    G(I,J)=G(I,J)+10
01140    B9=1
01150    LET P2=1
01160    PRINT
01170    PRINT "   PLEASE TYPE A SECRET PASSWORD:";
01180    INPUT X$
01190    PRINT
01200    LET N1=N9=N7=A7=0
01210    REM: DETERMINE KLINGON COMMANDER
01220   FOR I=1 TO INT(RND*5)
01220   R1=INT(RND*8+1)
01240   R2=INT(RND*8+1)
01250   C(I,1)=R1
01260   C(I,2)=R2
01270   G(R1,R2)=G(R1,R2)+100
01280   K9=K9+1
01290   K0=K9
01300   NEXT I
01310   REM: CONTINUE
01320   H1=0
01330   H2=INT(RND*5)
01340   GOTO 12710
01350   REM: SET UP QUADRANT
01360   K3=B3=S3=0
01370   IF Q1<1 THEN 1490
01380   IF Q1>8 THEN 1490
01390   IF Q2<1 THEN 1490
01400   IF Q2>8 THEN 1490
01410   X=G(Q1,Q2)/99.999
01420   K3=INT(X)
01430   IF K3<6.5 THEN 1460
01440   P4=5
01450   GOSUB 11870
01460   B3=INT((X-K3)*10.0)
01470   S3=G(Q1,Q2)-INT(G(Q1,Q2)*.1)*10
01480   MAT K=ZER
01490   FOR I=1 TO 8
01500   FOR J=1 TO 8
01510   Q(I,J)=0
01520   NEXT J
01530   NEXT I
01540   IF N1<>1 THEN 1570
01550   Q(S1,S2)=5
01560   GOTO 1580
01570   Q(S1,S2)=1
01580   FOR I=1 TO K3
01590   GOSUB 12660
01600   Q(R1,R2)=2
01610   K(I,1)=R1
01620   K(I,2)=R2
01630   K(I,3)=S9
01640   NEXT I
01650   FOR I=1 TO 4
01660   IF Q1<>C(I,1) THEN 1700
01670   IF Q2<>C(I,2) THEN 1700
01680   K(K3,3)=600
01690   Q(R1,R2)=6
01700   NEXT I
01710   FOR I=1 TO B3
01720   GOSUB 12660
01730   Q(R1,R2)=3
01740   NEXT I
01750   FOR I=1 TO S3
01760   GOSUB 12660
01770   Q(R1,R2)=4
01780   NEXT I
01790   A=-1
01800   IF P2=1 THEN 1840
01810   GOSUB 6390
01820   IF E<=0 THEN 6820
01830   GOTO 2570
01840   REM: SHORT RANGE SENSOR SCAN
01850   IF P2<>1 THEN 1880
01860   P4=8
01870   GOSUB 11870
01880   P2=P2+1
01890   LET T8=S1-1
01900   LET U=S1+1
01910   LET M=S2-1
01920   LET N=S2+1
01930   IF T8>=1 THEN 1950
01940   T8=1
01950   IF U<=8 THEN 1970
01960   U=8
01970   IF M>=1 THEN 1990
01980   M=1
01990   IF N<=8 THEN 2010
02000   N=8
02010   FOR I=T8 TO U
02020   FOR J=M TO N
02030   IF Q(I,J)<>3 THEN 2070
02040   C$="DOCKED"
02050   GOSUB 10230
02060   GOTO 2160
02070   NEXTJ
02080   NEXTI
02090   IF K3>0 THEN 2130
02100   IF E<E0*.1 THEN 2150
02110   C$="GREEN"
02120   GOTO 2160
02130   C$="RED"
02140   GOTO 2160
02150   C$="YELLOW"
02160   IF A<0 THEN 2180
02170   GOTO 2190
02180   GOSUB 6390
02190   IF E<=0 THEN 6820
02200   IF D(2) >= 0 THEN 2240
02210   PRINT "SHORT RANGE SENSORS ARE OUT "
02220   PRINT
02230   GOTO 2570
02240   PRINT "----------------------"
02250   FOR I=1 TO 8
02260   FOR J=1 TO 8
02270   PRINT Q$(Q(I,J));" ";
02280   NEXT J
02290   PRINT "   ";
02300   GOSUB 2340
02310   NEXT I
02320   PRINT "--------------------------"
02330   GOTO 2570
02340   IF I>1 THEN 2370
02350   PRINT "STARDATE         "INT(T*10)/10
02360   GOTO 2560
02370   IF I>2 THEN 2400
02380   PRINT "CONDITION        "C$
02390   GOTO 2560
02400   IF I>3 THEN 2430
02410   PRINT "QUADRANT         "Q1;"-"Q2
02420   GOTO 2560
02430   IF I>4 THEN 2460
02440   PRINT "SECTOR           "S1;"-"S2
02450   GOTO 2560
02460   IF I>5 THEN 2490
02470   PRINT "ENERGY           "E
02480   GOTO 2560
02490   IF I>6 THEN 2520
02500   PRINT "PHOTON TORPEDOES "P
02510   GOTO 2560
02520   IF I>7 THEN 2550
02530   PRINT "KLINGONS LEFT    "K9
02540   GOTO 2560
02550   PRINT "ENERGY SHIELDS   "Z$;","A9
02560   RETURN
02570   IF N9<>1 THEN 2610
02580   GOSUB 10750
02590   IF N7=1 THEN 5880
02600   N9=2
02610   PRINT "COMMAND:";
02620   INPUT A
02630   IF C$<>"DOCKED" THEN 2650
02640   GOSUB 10230
02650   GOTO 8400
02660   PRINT
02670   PRINT "   0 = SET COURSE"
02680   PRINT "   1 = SHORT RANGE SENSOR SCAN"
02690   PRINT "   2 = LONG RANGE SENSOR SCAN"
02700   PRINT "   3 = FIRE PHASERS"
02710   PRINT "   4 = FIRE PHOTON TORPEDOES"
02720  PRINT "   5 = DAMAGE CONTROL REPORT"
02730  PRINT "   6 = SELF-DESTRUCT"
02740  PRINT "   7 = ABANDON SHIP"
02750  PRINT "   8 = ACTIVATE ENERGY SHIELDS"
02760  PRINT "   9 = DEACTIVATE ENERGY SHIELDS"
02770  PRINT "   10 = FIRE EXPERIMENTAL DEATH RAY"
02780  PRINT "   11 = ACTIVATE TELEPORTATION UNIT"
02790  PRINT "   12 = ENGAGE IMPULSE ENGINES"
02800  PRINT "   13 = MAINTAIN POSITION"
02820  PRINT
02830  GOTO 2570
02840  REM: WARP DRIVE
02850  C$="MOVING"
02860  PRINT "COURSE (1-8.9999):";
02870  INPUT C1
02880  IF C1=0 THEN 2570
02890  IF C1<1 THEN 2610
02900  IF C1>= 9 THEN 2860
02910  PRINT "WARP FACTOR (0-12):";
02920  INPUT W1
02930  IF W1<0 THEN 2610
02940  IF W1>12 THEN 2610
02950  IF W1<=.25 THEN 2990
02960  IF D(1) >= 0 THEN 2990
02970  PRINT "WARP ENGINES ARE DAMAGED, MAXIMUM SPEED = WARP .25"
02980  GOTO 2860
02990  GOTO 9620
03000  E=E-W1*C5/4-C5/4
03010  IF E<=0 THEN 6820
03020  IF W1<.2 THEN 3040
03030  W9=RND
03040  IF W1=12 THEN 5720
03050  REM: THIS IS A CONTINUE CARD
03060  IF K3<=0 THEN 3090
03070  P4=6
03080  GOSUB 11870
03090  GOSUB 6390
03100  IF N9=1 THEN 2570
03110  IF E>100.0 THEN 3140
03120  P4=11
03130  GOSUB 11870
03140  IF E <=0 THEN 6880
03150  IF T<>T0+5 THEN 3180
03160  P4=4
03170  GOTO 3260
03180  IF T<>T0+10 THEN 3210
03190  P4=3
03200  GOTO 3260
03210  IF T<>T0+18 THEN 3240
03220  P4=2
03230  GOTO 3260
03240  IF T<>T0+30 THEN 3270
03250  P4=1
03260  GOSUB 11870
03270  FOR I=1 TO 8
03280  IF D(I)=0 THEN 3320
03290  D(I)=D(I)+W1/2
03300  IF D(I)<0 THEN 3320
03310  D(I)=0
03320  NEXT I
03330  IF RND>.20 THEN 3620
03340  R1=INT(RND*8+1)
03350  IF RND>.5 THEN 3470
03360  IF RND>.5 THEN 3620
03370  D(R1)=D(R1)-(RND*5+1)
03380  PRINT "*** SPACE STORM, ";
03390  GOSUB 7480
03400  PRINT F$;
03410  PRINT " DAMAGED ***"
03420  IF F$<>"NRGY SHLDS" THEN 3620
03430  C5=0
03440  PRINT "*** ENERGY SHIELDS ARE DOWN ***"
03450  Z$="DOWN"
03460  GOTO 3620
03470  FOR I=R1 TO 8
03480  IF D(I)<0 THEN 3540
03490  NEXT I
03500  FOR I=1 TO R1-1
03510  IF D(I)<0 THEN 3540
03520  NEXT I
03530  GOTO 3620
03540  R1=I
03550  D(I)=D(I)+RND*5+1
03560  IF D(I)<=0 THEN 3580
03570  D(I)=0
03580  PRINT "*** TEMPORARY TRUCE, ";
03590  GOSUB 7480
03600  PRINT F$;
03610  PRINT " STATE OF REPAIR IMPROVED ***"
03620  N=INT(W1*8)
03630  T=T+(.25*W1)
03640  E=E-2*N
03650  Q(S1,S2)=0
03660  X=S1
03670  Y=S2
03680  IF T>T0+T9 THEN 6820
03690  GOSUB 5690
03700  FOR I=1 TO N
03710  S1=S1+X1
03720  S2=S2+X2
03730  X3=INT(S1+.5)
03740  Y3=INT(S2+.5)
03750  IF S1<.5 THEN 3990
03760  IF S2<.5 THEN 3990
03770  IF S1>=8.5 THEN 3990
03780  IF S2>=8.5 THEN 3990
03790  IF Q(X3,Y3)<>0 THEN 3820
03800  NEXT I
03810  GOTO 3950
03820  LET Z5=Q(X3,Y3)
03830  IF Z5<>6 THEN 3880
03840  Z3=Q1
03850  Z4=Q2
03860  GOSUB 12090
03870  GOTO 7860
03880  IF Z5<>2 THEN 3900
03890  GOTO 7860
03900  PRINT
03910  GOSUB 10670
03920  PRINT N$;"BLOCKED BY OBJECT AT SECTOR "S1;"-"S2
03930  S1=S1-X1
03940  S2=S2-X2
03950  S1=INT(S1+.5)
03960  S2=INT(S2+.5)
03970  Q(S1,S2)=A5
03980  GOTO 2570
03990  Q1=INT(Q1+W1*X1+(X-.5)/8)
04000  Q2=INT(Q2+W1*X2+(Y-.5)/8)
04010  IF Q1>=1 THEN 4040
04020  Q1=1
04030  Z2=1
04040  IF Q1<=8 THEN 4070
04050  Q1=8
04060  Z2=1
04070  IF Q2>=1 THEN 4100
04080  Q2=1
04090  Z2=1
04100  IF Q2<=8 THEN 4130
04110  Q2=8
04120  Z2=1
04130  IF Z2<>1 THEN 4150
04140  GOSUB 12510
04150  PRINT
04160  IF G(Q1,Q2)>999 THEN 10170
04170  Z2=0
04180  S1=INT(RND*8+1)
04190  S2=INT(RND*8+1)
04200  GOTO 1350
04210  REM: LONG RANGE SENSOR SCAN
04220  IF D(3) >= 0 THEN 4260
04230  PRINT "LONG RANGE SENSORS ARE INOPERABLE"
04240  PRINT
04250  GOTO 2570
04260  PRINT "LONG RANGE SENSOR SCAN FOR QUADRANT "Q1;"-";Q2
04270  PRINT "----------------- -"
04280  FOR I=Q1-1 TO Q1+1
04290  N(1)=N(2)=N(3)=0
04300  FOR J=Q2-1 TO Q2+1
04310  IF I<1 THEN 4360
04320  IF I>8 THEN 4360
04330  IF J<1 THEN 4360
04340  IF J>8 THEN 4360
04350  N(J-Q2+2)=G(I,J)
04360  NEXT J
04370  PRINT ":"N(1);":"N(2);":"N(3)
04380  PRINT "------------------- -"
04390  NEXT I
04400  PRINT
04410  GOTO 2570
04420  REM: PHASER CONTROL
04430  IF D(4) >= 0 THEN 4470
04440  PRINT "PHASER CONTROL IS DISABLED"
04450  PRINT
04460  GOTO 2570
04470  IF C5=0 THEN 4510
04480  PRINT "YOU MUST LOWER YOUR ENERGY SHIELDS TO FIRE."
04490  PRINT
04500  GOTO 2610
04510  PRINT "PHASERS LOCKED ON TARGET.  ENERGY AVAILABLE = "E
04520  PRINT "NUMBER OF UNITS TO FIRE:";
04530  INPUT X
04540  IF X <= 0 THEN 2570
04550  IF E-X<0 THEN 4510
04560  E=E-X
04570  IF K3=0 THEN 4710
04580  W2=K3
04590  FOR I=1 TO 10
04600  IF K(I,3) <= 0 THEN 4680
04610  H=(X)/(FNO(I))*(3.0+RND)
04620  K(I,3)=K(I,3)-(H/W2)
04630  PRINT H/W2;"UNIT HIT ON KLINGON AT SECTOR "K(I,1);"-"K(I,2)
04640  PRINT "("K(I,3);"LEFT)"
04650  IF K(I,3)>0 THEN 4680
04660  GOSUB 6290
04670  IF K9 <= 0 THEN 6950
04680  NEXT I
04690  IF K3<=0 THEN 4720
04700  GOSUB 6390
04710  IF E <= 0 THEN 6820
04720  GOTO 2570
04730  REM: PHOTON TORPEDOES
04740  IF D(5) >= 0 THEN 4780
04750  PRINT "PHOTON TUBES ARE NOT OPERATIONAL"
04760  PRINT
04770  GOTO 2570
04780  IF P>0 THEN 4810
04790  PRINT "ALL PHOTON TORPEDOES EXPENDED"
04800  GOTO 2570
04810  IF C5=0 THEN 4850
04820  PRINT"YOU MUST LOWER YOUR ENERGY SHIELDS TO FIRE."
04830  PRINT
04840  GOTO 2610
04850  PRINT "DO YOU WISH TO FIRE A BURST:";
04860  INPUT M$
04870  PRINT "TORPEDO COURSE (1-8.9999):";
04880  INPUT C1
04890  IF C1=0 THEN 2570
04900  IF C1<1 THEN 2610
04910  IF C1>= 9 THEN 2610
04920  IF P<3 THEN 4940
04930  IF M$="YES" THEN 8220
04940  IF RND<.92 THEN 5020
04950  PRINT " TORPEDO MISFIRES."
04960  C1=C1+RND*8+1
04970  IF C1<9.0 THEN 4990
04980  C1=C1-8.0
04990  IF E4=0 THEN 5020
05000  PRINT " REMAINDER OF BURST ABORTED."
05010  E4=0
05020  GOSUB 5690
05030  X=S1
05040  Y=S2
05050  P=P-1
05060  U2=-1
05070  PRINT "TORPEDO TRACK:";
05080  X=X+X1
05090  Y=Y+X2
05100  IF X<.5 THEN 5580
05110  IF Y<.5 THEN 5580
05120  IF X>=8.5 THEN 5580
05130  IF Y>=8.5 THEN 5580
05140  PRINT INT(X*10)/10;"-"INT(Y*10)/10;
05150  U2=U2+1
05160  X5=INT(X+.5)
05170  Y5=INT(Y+.5)
05180  IF Q(X5,Y5)<>0 THEN 5200
05190  GOTO 5080
05200  LET F7=Q(X5,Y5)
05210  IF F7=1 THEN 5080
05220  IF F7=2 THEN 7160
05230  IF F7=3 THEN 5370
05240  IF F7=4 THEN 5430
05250  IF F7=6 THEN 7160
05260  IF F7=5 THEN 5080
05270  PRINT
05280  PRINT "*** KLINGON DESTROYED ***"
05290  K3=K3-1
05300  K9=K9-1
05310  IF K9<=0 THEN 6950
05320  FOR I=1 TO 9
05330  IF K(I,1)<>X5 THEN 5360
05340  IF K(I,2)<>Y5 THEN 5360
05350  GOTO 5500
05360  NEXT I
05370  Q(X5,Y5)=0
05380  PRINT
05390  PRINT "***STARBASE DESTROYED ... CONGRATULATIONS***"
05400  B3=B3-1
05410  C$="RIDICULOUS"
05420  GOTO 5560
05430  Q(X5,Y5)=0
05440  PRINT
05450  PRINT "***STAR DESTROYED***"
05460  S3=S3-1
05470  IF S3>=0 THEN 5560
05480  S3=0
05490  GOTO 5560
05500  K(I,3)=0
05510  Q(X5,Y5)=0
05520  IF F7<>6 THEN 5560
05530  Z3=Q1
05540  Z4=Q2
05550  GOSUB 12090
05560  G(Q1,Q2)=K3*100+B3*10+S3
05570  GOTO 5600
05580  PRINT
05590  PRINT "TORPEDO MISSED"
05600  IF E4=0 THEN 5650
05610  E4=E4+1
05620  IF E4>3.5 THEN 5640
05630  GOTO 8290
05640  IF K3<=0 THEN 5670
05650  GOSUB 6390
05660  IF E <= 0 THEN 6820
05670  E4=0
05680  GOTO 2570
05690  X2=COS((C1-1)*.785398)
05700  X1=-SIN((C1-1)*.785398)
05710  RETURN
05720  W9=RND
05730  IF T>T0+8.99 THEN 5760
05740  PRINT "WARP 12 CANNOT BE USED UNTIL STARDATE "T0+9
05750  GOTO 2860
05760  GOSUB 6390
05770  IF E<=0 THEN 6860
05780  PRINT "SPEED APPROACHING WARP 12."
05790  PRINT "ENGINES OPERATING ABOVE DANGER LEVEL."
05800  PRINT "ALL SAFETY DEVICES DISFUNCTIONAL."
05810  PRINT "CRITICAL OVERHEATING--SPONTANEOUS IMPLOSION IMMINENT."
05820  IF W9>=.40 THEN 5910
05830  FOR I=1 TO 2
05840  PRINT "*****************************************************"
05850  NEXT I
05860  GOSUB 10670
05870  PRINT "*** ENTROPY OF "N$;"MAXIMIZED **************"
05880  GOSUB 14830
05890  PRINT "  STIPENDIUM PECCATI MORS EST."
05900  GOTO 14880
05910  IF W9>=.55 THEN 5970
05920  PRINT
05930  PRINT " YOU ARE TRAVELLING BACK IN TIME."
05940  T=T-9
05950  PRINT "*** STARDATE ="INT(T*10)/10+1
05960  GOTO 3050
05970  IF W9>=.60 THEN 6030
05980  PRINT
05990  PRINT " YOU ARE TRAVELLING BACK IN TIME."
06000  T=T-14
06010  PRINT "*** STARDATE ="INT(T*10)/10+1
06020  GOTO 3050
06030  IF W9>=.70 THEN 6100
06040  PRINT
06050  PRINT " YOU ARE TRAVELLING FORWARD IN TIME."
06060  T=T+2
06070  IF T>T0+T9 THEN 6820
06080  PRINT "*** STARDATE ="INT(T*10)/10
06090  GOTO 3050
06100  PRINT
06110  PRINT "NUCLEAR REACTOR CHAIN REACTION QUENCHED."
06120  PRINT "*** TIME PORTAL MISSED ***"
06130  GOTO 3050
06140  REM: DAMAGE CONTROL REPORT
06150  IF D(6) >= 0 THEN 6190
06160  PRINT "DAMAGE CONTROL REPORT IS NOT AVAILABLE"
06170  PRINT
06180  GOTO 2570
06190  PRINT
06200  PRINT "DEVICE         STATE OF REPAIR"
06210  FOR I=1 TO 8
06220  R5=I-.5
06230  GOSUB 7480
06240  PRINT F$,D(I)
06250  NEXT I
06260  PRINT
06270  GOTO 2570
06280  REM:
06290  PRINT "*** KLINGON AT SECTOR "K(I,1);"-"K(I,2);"DESTROYED."
06300  IF Q(K(I,1),K(I,2))<>6 THEN 6340
06310  Z3=Q1
06320  Z4=Q2
06330  GOSUB 12090
06340  K3=K3-1
06350  K9=K9-1
06360  Q(K(I,1),K(I,2))=0
06370  G(Q1,Q2)=K3*100+B3*10+S3
06380  RETURN
06390  REM: KLINGON ATTACK
06400  GOSUB 10670
06410  IF K3<=0 THEN 6810
06420  IF C$ <> "DOCKED" THEN 6450
06430  PRINT "STARBASE SHIELDS PROTECT THE "N$
06440  RETURN
06450  IF C5=0 THEN 6470
06460  GOTO 7330
06470  IF K3*150<E THEN 6640
06480  IF N1<>0 THEN 6610
06490  PRINT
06500  PRINT "   KLINGON COMMANDER TO ENTERPRISE---"
06510  PRINT "AS YOU WELL KNOW, YOU ARE DANGEROUSLY LOW ON ENERGY"
06520  PRINT "AND WILL PROBABLY BE DESTROYED BY MY NEXT ATTACK."
06530  PRINT "AS AN OFFICER AND GENTLEMAN, I OFFER YOU A CHANCE TO"
06540  PRINT "SAVE YOURSELF AND YOUR CREW----"
06550  PRINT "    DO YOU SURRENDER:";
06560  INPUT S$
06570  IF S$<>"YES" THEN 6610
06580  A7=1
06590  N9=1
06600  GOTO 6810
06610  IF E>100.0 THEN 6640
06620  P4=11
06630  GOSUB 11870
06640  U3=1
06650  PRINT
06660  FOR I=U3 TO 10
06670  IF K(I,3) <= 0 THEN 6790
06680  H=(K(I,3)/FNO(I))*(2+RND)
06690  E=E-H
06700  PRINT H;"UNIT HIT ON "N$;"FROM KLINGON, SECTOR "K(I,1);"-"K(I,2)
06710  IF H<=180 THEN 6780
06720  R5=INT(RND*8+1)
06730  R1=R5
06740  D(R5)=D(R5)-(H/200)*(1.5+RND)
06750  PRINT "*** CRITICAL HIT, ";
06760  GOSUB 7480
06770  PRINT E$;" DAMAGED ***"
06780  PRINT "("E;"LEFT)"
06790  NEXT I
06800  PRINT
06810  RETURN
06820  REM: LOSE
06830  IF E>0 THEN 6860
06840  P4=10
06850  GOSUB 11870
06860  GOSUB 14840
06870  PRINT "IT IS STARDATE "INT(T*10)/10
06880  PRINT
06890  GOSUB 10670
06900  PRINT "THE "N$;"HAS BEEN DESTROYED."
06910  PRINT "THERE ARE STILL "K9;"KLINGON BATTLE CRUISERS."
06920  PRINT "THE FEDERATION WILL BE CONQUERED."
06930  PRINT "YOU ARE DEAD."
06940  GOTO 14880
06950  REM: WIN
06960  P4=9
06970  GOSUB 11870
06980  GOSUB 14840
06990  PRINT "IT IS STARDATE "INT(T*10)/10
07000  PRINT "THE LAST KLINGON BATTLE CRUISER IN THE GALAXY HAS BEEN"
07010  PRINT "DESTROYED."
07020  PRINT "THE FEDERATION HAS BEEN SAVED."
07030  PRINT "YOU HAVE BEEN PROMOTED TO COMMODORE EMERITUS."
07040  M1=0
07050  IF N1<>0 THEN 7080
07060  PRINT K0;"KLINGONS IN "T-T0;"YEARS.  RATING ="INT(K0/(T-T0)*1000)
07070  GOTO 14880
07080  PRINT K0;"KLINGONS IN "T-T0;"YEARS."
07090  IF A7=5 THEN 7130
07100  PRINT "ENTERPRISE CAPTURED."
07110  PRINT "RATING ="INT(K0/(T-T0)*1000-1000)
07120  GOTO 14880
07130  PRINT "ENTERPRISE DESTROYED INTENTIONALLY."
07140  PRINT "RATING ="INT(K0/(T-T0)*1000-500)
07150  GOTO 14880
07160  REM: HIT OR MISS
07170  IF RND<(U2*3)/100 THEN 7290
07180  IF RND>.15 THEN 5270
07190  PRINT
07200  PRINT "** KLINGON EVASIVE ACTION---"
07210  PRINT "* KLINGON DAMAGED, BUT NOT DESTROYED *"
07220  FOR I=1 TO 10
07230  IF K(I,1)<>X5 THEN 7260
07240  IF K(I,2)<>Y5 THEN 7260
07250  GOTO 7270
07260  NEXT I
07270  K(I,3)=0.4*K(I,3)
07280  GOTO 5600
07290  PRINT
07300  PRINT "** KLINGON EVASIVE ACTION---"
07310  PRINT "* TORPEDO MISSED *"
07320  GOTO 5600
07330  REM: SHIELDS
07340  FOR I=1 TO 10
07350  IF K(I,3)<=0 THEN 7450
07360  H=(K(I,3)/FNO(I))*(2+RND)
07370  A9=A9-H
07380  IF A9>0 THEN 7450
07390  Z$="DOWN"
07400  U3=I+1
07410  PRINT "** KLINGONS ATTACK--ENERGY SHIELDS KNOCKED OUT**"
07420  PRINT
07430  C5=0
07440  GOTO 6660
07450  NEXT I
07460  PRINT "** KLINGONS ATTACK--ENERGY SHIELDS PROTECT THE "N$
07470  GOTO 6800
07480  REM: SELECT DAMAGED DEVICE
07490  IF A+1<>1 THEN 7510
07500  R5=R1
07510  IF R5>1 THEN 7540
07520  F$="WARP ENGNS"
07530  GOTO 11130
07540  IF R5>2 THEN 7570
07550  F$="SR SENSORS"
07560  GOTO 11130
07570  IF R5>3 THEN 7600
07580  F$="LR SENSORS"
07590  GOTO 11130
07600  IF R5>4 THEN 7630
07610  F$="PHASER CTL"
07620  GOTO 11130
07630  IF R5>5 THEN 7660
07640  F$="PHOTON TBS"
07650  GOTO 11130
07660  IF R5>6 THEN 7690
07670  F$="DAMAGE CTL"
07680  GOTO 11130
07690  IF R5>7 THEN 7720
07700  F$="NRGY SHLDS"
07710  GOTO 11130
07720  F$="CLOAKING D"
07730  GOTO 11130
07740  REM: MAINTAIN POSITION
07750  W1=0
07760  W9=RND
07770  C1=3
07780  T=T+1
07790  FOR I=1 TO 8
07800  D(I)=D(I)+2
07810  IF D(I)<0 THEN 7830
07820  D(I)=0
07830  NEXT I
07840  E=E-50
07850  GOTO 9620
07860  REM: RAMMING KLINGON
07870  PRINT
07880  Q(S1,S2)=0
07890  K3=K3-1
07900  K9=K9-1
07910  Z$="DOWN"
07920  FOR I=1 TO 9
07930  IF K(I,1)<>X3 THEN 7980
07940  IF K(I,2)<>Y3 THEN 7980
07950  Z6=K(I,1)
07960  Z7=K(I,2)
07970  GOTO 7990
07980  NEXT I
07990  K(I,3)=0
08000  GOSUB 10670
08010  Q(X3,Y3)=A5
08020  GOTO 8030
08030  G(Q1,Q2)=K3*100+B3*10+S3
08040  PRINT "*** EMERGENCY ALERT ***"
08050  PRINT "*** COLLISION IMMINENT ***"
08060  GOSUB 14830
08070  GOSUB 10670
08080  PRINT N$;"RAMS KLINGON AT SECTOR "Z6;"-"Z7
08090  PRINT "*** KLINGON DESTROYED, "N$;"HEAVILY DAMAGED. ***"
08100  FOR I=1 TO 7
08110  D(I)=D(I)-(RND*4+1)
08120  NEXT I
08130  C5=0
08140  E=E-500
08150  IF K9<=0 THEN 6950
08160  GOSUB 6390
08170  IF E<=0 THEN 6880
08180  S1=Z6
08190  S2=Z7
08200  A=2
08210  GOTO 6190
08220  REM: TORPEDO BURST FORMATION
08230  PRINT "BURST ANGLE (0.05-0.30):";
08240  INPUT E5
08250  IF E5=O THEN 2610
08260  IF E5<0.05 THEN 8230
08270  IF E5>0.30 THEN 8230
08280  E4=1
08290 PRINT "NUMBER "E4;
08300  IF E4>1.5 THEN 8330
08310  C1=C1-E5
08320  GOTO 8340
08330  C1=C1+E5
08340  IF C1>=1.0 THEN 8370
08350  C1=C1+8.0
08360  GOTO 4940
08370  IF C1<9.0 THEN 4940
08380  C1=C1-8.0
08390  GOTO 4940
08400  REM: COMMAND LINK
08405 IF A+1=-8 THEN 14960
08410  IF A+1 = 1 THEN 2840
08420  IF A+1 = 2 THEN 1840
08430  IF A+1 = 3 THEN 4210
08440  IF A+1 = 4 THEN 4420
08450  IF A+1 = 5 THEN 4730
08460  IF A+1 = 6 THEN 6140
08470  IF A+1 = 8 THEN 9280
08475 IF A+1=7 THEN 11220
08480  IF A+1 = 9 THEN 10340
08490  IF A+1 = 10 THEN 10550
08500  IF A+1 = 11 THEN 8550
08510  IF A+1 = 12 THEN 12180
08520  IF A+1 = 13 THEN 11880
08530  IF A+1 = 14 THEN 7740
08540  GOTO 2660
08550  REM: DEATH RAY
08560  IF T>T0+9.99 THEN 8600
08570  PRINT " DEATH RAY CANNOT BE USED UNTIL STARDATE "T0+10
08580  PRINT
08590  GOTO 2610
08600  IF W3<.05 THEN 8640
08610  PRINT " DEATH RAY PERMANENTLY OUT OF ORDER."
08620  PRINT
08630  GOTO 2610
08640  IF C5=0 THEN 8680
08650  PRINT " YOU MUST LOWER YOUR SHIELDS TO FIRE."
08660  PRINT
08670  GOTO 2610
08680  W3=RND
08690  PRINT
08700  IF W3>.35 THEN 8810
08710  PRINT " *ANTI-MATTER OVERLOAD,"
08720  PRINT " TEMPORARY PSEUDO-STARS CREATED FROM ENERGY."
08730  FOR I=1 TO 8
08740  FOR J=1 TO 8
08750  IF Q(I,J)<>0 THEN 8770
08760  Q(I,J)=4
08770  NEXT J
08780  NEXT I
08790  PRINT
08800  GOTO 2240
08810  IF W3>.50 THEN 8850
08820  PRINT "*** DEATH RAY BACKFIRES ***"
08830  PRINT "*** BETTER LUCK NEXT TIME ***"
08840  GOTO 5830
08850  IF W3>.60 THEN 9030
08860  PRINT "*** DEATH RAY ANNIHILATES ALL KLINGONS IN QUADRANT "Q1;"-"
08870  K9=K9-K3
08880  IF K9<=0 THEN 6950
08890  FOR I=1 TO 8
08900  FOR J=1 TO 8
08910  IF Q(I,J)<>6 THEN 8930
08920  Q(I,J)=0
08930  IF Q(I,J)<>2 THEN 8950
08940  Q(I,J)=0
08950  NEXT J
08960  NEXT I
08970  K3=0
08980  G(Q1,Q2)=INT(B3*10+S3)
08990  Z3=Q1
09000  Z4=Q2
09010  GOSUB 12090
09020  GOTO 2610
09030  IF W3>.75 THEN 9080
09040  PRINT "*THERMAL REACTOR ENERGY DRAIN."
09050  PRINT .95*E;"UNITS OF ENERGY BURNED."
09060  E=.05*E
09070  GOTO 8860
09080  IF W3>.95 THEN 9220
09090  PRINT "*MATTER/ANTI-MATTER TRANSFORMATION."
09100  IF K3>0 THEN 9120
09110  GOTO 8720
09120  PRINT "KLINGONS HIT BY MAIN BEAM DUPLICATED."
09130  P8=K3
09140  PRINT "ENTIRE QUADRANT DISORDERED."
09150  FOR I=1 TO P8
09160  IF K3>8 THEN 9200
09170  K3=K3+1
09180  K9=K9+1
09190  NEXT I
09200  G(Q1,Q2)=K3*100+B3*10+S3
09210  GOTO 4180
09220  PRINT "*** DEATH RAY GOES CRAZY ***"
09230  PRINT "*** DESTROYS EVERY KLINGON IN THE GALAXY ***"
09240  PRINT "*** ALSO DESTROYS "N$
09250  IF N1<>0 THEN 9270
09260  A7=N1=5
09270  GOTO 6950
09280  REM: ABANDON SHIP
09290  IF N1=0 THEN 9320
09300  PRINT "THE FAIRIE QUEENE CANNOT BE ABANDONED."
09310  GOTO 2610
09320  PRINT
09330  IF A7<>1 THEN 9380
09340  PRINT "** YOU MAY NOT ABANDON SHIP AFTER YOU HAVE BEEN "
09350  PRINT "ASKED TO SURRENDER."
09360  PRINT
09370  GOTO 2610
09380  PRINT "WOULD YOU LIKE TO RECONSIDER:";
09390  INPUT P$
09400  IF P$<>"YES" THEN 9420
09410  GOTO 2610
09420  PRINT "*** ABANDON SHIP ***"
09430  PRINT "*** ABANDON SHIP ***"
09440  PRINT
09450  PRINT "SERIES ENTER-BLITZ INITIATED."
09460  PRINT "FAIL-SAFE AUTO-OVERRIDE INSERTED."
09470  PRINT " COMMANDER AND SELECT FEMALE CREW ESCAPE IN SHUTTLE CRAFT.
09480  PRINT
09490  PRINT "*** ENTERPRISE REDUCED TO SUB-ATOMIC PARTICLES ***"
09500  PRINT
09510  A7=5
09520  N1=1
09530  N9=1
09540  IF T<T0+T9 THEN 9610
09550  PRINT "ABANDONING SHIP COSTS 1 STARDATE."
09560  T=T+1
09570  PRINT "*** SO LONG, SPORT ***"
09580  N1=0
09590  PRINT
09600  GOTO 6870
09610  GOTO 2570
09620  REM: SUPERNOVA
09630  IF RND>W1 THEN 9960
09640  IF V=2 THEN 9670
09650  IF RND>.15 THEN 9960
09660  GOTO 9680
09670  IF RND>.10 THEN 9960
09680  Z3=INT(RND*8+1)
09690  Z4=INT(RND*8+1)
09700  IF G(Z3,Z4)>999 THEN 9960
09710  S4=G(Z3,Z4)-INT(G(Z3,Z4)*.1)*10
09720  IF S4<=0 THEN 9960
09730  PRINT
09740  PRINT "*************************************************"
09750  PRINT "********* SUPERNOVA IN QUADRANT "Z3;"-"Z4
09760  PRINT "ALL MATTER IN THIS QUADRANT CONVERTED TO ENERGY."
09770  IF Q1<>Z3 THEN 9850
09780  IF Q2<>Z4 THEN 9850
09790  PRINT
09800  GOSUB 10670
09810  PRINT "UNFORTUNATELY, THE "N$;"WAS IN THIS QUADRANT."
09820  P4=7
09830  GOSUB 11870
09840  GOTO 5880
09850  PRINT "FROM NOW ON, ANY VESSEL STOPPING IN THIS QUADRANT"
09860  PRINT "WILL BE TOTALLY ENERGIZED."
09870  PRINT "*************************************************"
09880  PRINT
09890  K4=INT(G(Z3,Z4)/99.99)
09900  B4=INT((G(Z3,Z4)/99.99-K4)*10.0)
09910  B9=B9-B4
09920  K9=K9-K4
09930  IF K9<=0 THEN 6950
09940  G(Z3,Z4)=INT(1000.0)
09950  GOSUB 12090
09960  REM: MAGNETIC K-CAPTURE
09970  IF RND>.12 THEN 10160
09980  FOR I=1 TO 4
09990  IF C(I,1)<0.5 THEN 10150
10000  Q1=C(I,1)
10010  Q2=C(I,2)
10020  S1=INT(RND*8+1)
10030  S2=INT(RND*8+1)
10040  PRINT
10050  PRINT N$;"CAUGHT IN MAGNETIC TRACTOR BEAM."
10060  PRINT
10070  T=T+.5
10080  W9=RND
10090  FOR I=1 TO 7
10100  D(I)=D(I)+1
10110  IF D(I)<=0 THEN 10130
10120  D(I)=0
10130  NEXT I
10140  GOTO 1350
10150  NEXT I
10160  GOTO 3000
10170  REM: STARSHIP ENCOUNTERS OLD SUPERNOVA
10180  GOSUB 10670
10190  PRINT "THE "N$;"HAS WARPED INTO A QUADRANT CONTAINING A"
10200  PRINT "SUPERNOVA AND HAS BEEN FRIED. "
10210  PRINT "               . . . NOT EVEN CINDERS REMAIN . . ."
10220  GOTO 12630
10230  REM: VARIABLE RESUPPLY
10240  IF N1=1 THEN 10290
10250  E=3000
10260  A9=3000
10270  P=13
10280  GOTO 10320
10290  E=2000
10300  A9=2000
10310  P=8
10320  A7=0
10330  RETURN
10340  REM: ACTIVATE ENERGY SHIELDS
10350  IF D(7)>=0 THEN 10380
10360  PRINT "ENERGY SHIELDS DISABLED."
10370  GOTO 2610
10380  IF C5=0 THEN 10420
10390  PRINT "ENERGY SHIELDS ALREADY ACTIVATED."
10400  PRINT
10410  GOTO 2610
10420  IF A9>=200 THEN 10460
10430  PRINT "SHIELD ENERGY DRAINED."
10440  PRINT
10450  GOTO 2610
10460  PRINT
10470  PRINT "ENERGY SHIELDS ACTIVATED."
10480  PRINT
10490  C5=200
10500  Z$="UP"
10510  A9=A9-C5
10520  IF E<=0 THEN 6820
10530  GOSUB 6390
10540  GOTO 2610
10550  REM: DEACTIVATE ENERGY SHIELDS
10560  PRINT
10570  IF C5<>0 THEN 10610
10580  PRINT "ENERGY SHIELDS ALREADY DOWN."
10590  PRINT
10600  GOTO 2610
10610  PRINT "ENERGY SHIELDS DEACTIVATED."
10620  PRINT
10630  C5=0
10640  Z$="DOWN"
10650  GOSUB 6390
10660  GOTO 2570
10670  REM: DETERMINE NAME
10680  IF N1<>1 THEN 10720
10690  A5=5
10700  N$="FAIRY QU. "
10710  GOTO 10740
10720  N$=" ENTRPRSE "
10730  A5=1
10740  RETURN
10750  REM: CHANGING OF THE GUARD AT BUCKINGHAM PALACE
10760  PRINT
10770  Z$="DOWN"
10780  A9=2000
10790  FOR I=1 TO 8
10800  FOR J=1 TO 8
10810  K3=INT(G(I,J)/99.99)
10820  B3=INT((G(I,J)/99.99-K3)*10.0)
10830  IF B3>0 THEN 10940
10840  NEXT J
10850  NEXT I
10860  PRINT " YOU HAVE BEEN TAKEN TO KLINGON HEADQUARTERS."
10870  PRINT "IF YOU HAD A STARBASE, YOU WOULD BE REPATRIATED"
10880  PRINT "AND GIVEN A NEW STARSHIP TO COMMAND."
10890  PRINT "SINCE YOU HAVE NO STARBASE, YOU WILL BE MERCILESSLY"
10900  PRINT "TORTURED TO DEATH BY THE ARCHFIEND,"
10910  PRINT "LAURENT SIKLOSSY, SCOURGE OF THE UNIVERSE."
10920  N7=1
10930  GOTO 11130
10940  N9=2
10950  T=T+1
10960  Q1=I
10970  Q2=J
10980  E=2000
10990  P=8
11000  N1=1
11010  PRINT "YOU HAVE BEEN SENT BACK TO STARFLEET COMMAND."
11020  PRINT "YOU ARE NOW IN COMMAND OF A NEW STARSHIP,"
11030  PRINT "   THE FAIRIE QUEENE,"
11040  PRINT "WHICH LOOKS LIKE /Q/ ON THE SCAN."
11050  PRINT
11060  PRINT "   YE FAIRIE QUEENE IS CURRENTLY IN QUADRANT "Q1;"-"Q2
11070  PRINT "TRY TO BE MORE CAREFUL THIS TIME."
11080  FOR I=1 TO 7
11090  D(I)=0
11100  NEXT I
11110  PRINT
11120  GOTO 4180
11130  RETURN
11140  Q$(0)="."
11150  Q$(1)="E"
11160  Q$(2)="K"
11170  Q$(3)="B"
11180  Q$(4)="*"
11190  Q$(5)="Q"
11200  Q$(6)="C"
11210  RETURN
11220  REM: SELF-DESTRUCT
11230  PRINT
11240  PRINT "SERIES ENTER-BLITZ INITIATED."
11250  PRINT "IN TEN SECONDS THIS VESSEL WILL SELF-DESTRUCT."
11260  PRINT "10"
11270  PRINT "   9"
11280  PRINT "      8"
11290  PRINT "         7"
11300  PRINT "            6"
11310  PRINT
11320  PRINT "T MINUS 5 SECONDS AND HOLDING."
11330  PRINT "FAIL-SAFE MECHANISM ENGAGED.  ONLY THE COMMANDER OF"
11340  PRINT "THE STARSHIP CAN OVERRIDE WITH HIS SECRET PASSWORD."
11350  PRINT "SCIENCE OFFICER SPOCK HAS ALREADY ENTERED HIS CORRECT"
11360  PRINT "COUNTER-PASSWORD."
11370  PRINT "TO CONTINUE SERIES ENTER-BLITZ, TYPE YOUR "
11380  PRINT "SECRET PASSWORD:";
11390  INPUT V$
11400  IF V$<>X$ THEN 11470
11410  PRINT
11420  PRINT "               4"
11430  PRINT "                  3"
11440  PRINT "                     2"
11450  PRINT "                        1"
11460  GOTO 5830
11470  PRINT
11480  PRINT "SERIES ENTER-BLITZ TERMINATED."
11490  PRINT
11500  GOTO 2570
11510  REM: RANDOMIZE
11520  PRINT
11530  PRINT "   TYPE A WEIRD NUMBER BETWEEN 0.0 AND 1.0 :";
11540  INPUT E6
11550  E9=RND(E6)
11560  RETURN
11570  REM:  POST-MORTEM...     (HAD TO PUT IT SOMEWHERE>)
11580  IF M1=0 THEN 11860
11590  PRINT
11600  PRINT (K0-K9);"KLINGONS IN "T-T0;"YEARS."
11610  REM:  COMPUTE BASIC POSTHUMOUS RATING
11620  R0=INT((K0-K9)/(T-T0)*1000-2000)
11630  REM:  LESS 500 IF ENTERPRISE DESTROYED, 1000 IF CAPTURED
11640  IF N1=0 THEN 11680
11650  R0=R0-500
11660  IF A7=5 THEN 11680
11670  R0=R0-500
11680  PRINT "POSTHUMOUS RATING ="R0
11690  PRINT
11700  PRINT "          . . . BETTER LUCK NEXT REINCARNATION . . ."
11710  PRINT
11720  PRINT
11730  PRINT "WOULD YOU LIKE TO SEE THE CURRENT STATE OF THE GALAXY? ";
11740  INPUT A$
11750  IF A$ ="NO" THEN 11860
11760  FOR I=1 TO 8
11770  PRINT "-----------------------------------"
11780  PRINT G(I,1);G(I,2);G(I,3);G(I,4);G(I,5);G(I,6);G(I,7);G(I,8)
11790  NEXT I
11800  PRINT "-----------------------------------"
11810  PRINT
11820  GOSUB 10670
11830  PRINT "LAST KNOWN POSITION OF "N$
11840  PRINT "     QUADRANT "Q1;"-"Q2;"   SECTOR "S1;"-"S2
11850  PRINT
11860  RETURN
11870  RETURN
11880  REM: IMPULSE ENGINES
11890  PRINT
11900  PRINT "IMPULSE ENGINES ON STANDBY."
11910  PRINT
11920  PRINT "COURSE(1-8.9999):";
11930  INPUT C1
11940  IF C1<1 THEN 2610
11950  IF C1>=9 THEN 11920
11960  PRINT "WARP FACTOR(1-5):";
11970  INPUT W1
11980  IF W1<1 THEN 2610
11990  IF W1>5 THEN 2610
12000  PRINT
12010  PRINT "IMPULSE ENGINES ENGAGED."
12020  C$="MOVING"
12030  E=E-400
12040  IF E<=0 THEN 6870
12050  IF RND<.92 THEN 9620
12060  PRINT
12070  PRINT "***** IMPULSE ENGINES IMPLODE *****"
12080  GOTO 6910
12090  REM: COMMANDER DIES
12100  FOR I=1 TO 4
12110  IF C(I,1)<>Z3 THEN 12160
12120  IF C(I,2)<>Z4 THEN 12160
12130  C(I,1)=0
12140  C(I,2)=0
12150  RETURN
12160  NEXT I
12170  RETURN
12180  REM: TELEPORTER
12190  IF T>T0+6.99 THEN 12230
12200  PRINT "TELEPORTER CANNOT BE USED UNTIL STARDATE "T0+7
12210  PRINT
12220  GOTO 2610
12230  IF W9>.20 THEN 12280
12240  PRINT "SPACE STORM BETWEEN HERE AND BASE CAUSING STATIC ON ALL"
12250  PRINT "FREQUENCIES--TELEPORTER TEMPORARILY DYSFUNCTIONAL."
12260  PRINT
12270  GOTO 2610
12280  H1=H1+1
12290  IF H1<=2*H2 THEN 12320
12300  PRINT "TELEPORTATION CAPABILITY PERMANENTLY LOST."
12310  GOTO 2610
12320  PRINT
12330  PRINT " TELEPORTER ACTIVATED."
12340  FOR I=1 TO 8
12350  FOR J=1 TO 8
12360  K3=INT(G(I,J)/99.99)
12370  B3=INT((G(I,J)/99.99-K3)*10.0)
12380  IF B3>0 THEN 12430
12390  NEXT J
12400  NEXT I
12410  PRINT
12420  GOTO 12240
12430  Q1=I
12440  Q2=J
12450  IF RND>.15 THEN 12500
12460  PRINT "DISINTEGRATOR/INTEGRATOR MALFUNCTION--"
12470  PRINT "STARSHIP MOLECULES REORIENTED AS RICHARD NIXON."
12480  PRINT "  YOU ATE THAT ONE."
12490  GOTO 5880
12500  GOTO 4180
12510  REM: LEAVING GALAXY
12520  IF F>2 THEN 12610
12530  PRINT
12540  PRINT "STARSHIP ENCOUNTERS END OF GALAXY."
12550  PRINT
12560  PRINT "FOOLISH MORTAL, YOU HAVE ATTEMPTED TO VENTURE OUT OF THE"
12570  PRINT "GALAXY INTO SUB-SPACE.  ON THE THIRD TIME YOU TRY THIS,"
12580  PRINT "ZIMBULA WILL DESTROY YOU."
12590  F=F+1
12600  GOTO 12650
12610  PRINT
12620  PRINT "YOU HAVE DARED TO ENTER SUB-SPACE A THIRD TIME."
12630  PRINT "FOR THIS, ************ YOU DIE ****************"
12640  GOTO 5830
12650  RETURN
12660  REM: RANDOM NUMBER GENERATOR
12670  R1=INT(RND*8+1)
12680  R2=INT(RND*8+1)
12690  IF Q(R1,R2) <> 0 THEN 12670
12700  RETURN
12710  PRINT
12720  PRINT "ORDERS:  STARDATE = "T
12730  PRINT
12740  PRINT "   AS COMMANDER OF THE UNITED STARSHIP ENTERPRISE,"
12750  PRINT "YOUR MISSION IS TO RID THE GALAXY OF THE DEADLY"
12760  PRINT "KLINGON MENACE.  TO DO THIS, YOU MUST DESTROY THE "
12770  PRINT "KLINGON INVASION FORCE OF "K9;"BATTLE CRUISERS."
12780  PRINT "YOU HAVE "T9;"SOLAR YEARS TO COMPLETE YOUR MISSION."
12790  PRINT "(I.E. UNTIL STARDATE "T0+T9;")."
12800  PRINT
12810  IF B9 > 1 THEN 12840
12820  PRINT "   YOU WILL HAVE ONE SUPPORTING STARBASE."
12830 GOTO 12880
12840  PRINT "   YOU WILL HAVE "B9;"SUPPORTING STARBASES."
12880  PRINT "THE ENTERPRISE IS CURRENTLY IN QUADRANT "Q1;"-";Q2;
12890  PRINT "SECTOR ";S1;"-";S2
12930 GOTO 1350
14830  REM
14840  FOR I=1 TO 3
14850  PRINT
14860  NEXT I
14870  RETURN
14880  GOSUB 11570
14890 PRINT G(I,1);G(I,2);G(I,3);G(I,4);G(I,5);G(I,6);G(I,7);G(I,8)
14900  PRINT "  DO YOU WISH TO PLAY AGAIN:";
14910  INPUT A$
14920  IF A$ ="YES" THEN 40
14930  PRINT
14940  PRINT " ** AVE ATQUE VALE **"
14950 STOP
14960 FOR I=1 TO 8
14970 PRINT "-----------------------------------"
14980 PRINT G(I,1);G(I,2);G(I,3);G(I,4);G(I,5);G(I,6);G(I,7);G(I,8)
14990 NEXT I
15000 PRINT "-----------------------------------"
15010 GO TO 2610
15020 END

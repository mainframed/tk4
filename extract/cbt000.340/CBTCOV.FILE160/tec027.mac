 FUTBOL:PROCEDURE OPTIONS(MAIN);
0 DCL BALLOWNER BIN FIXED(15) STATIC INIT(0);
  DCL YARDTOGO  BIN FIXED(15) STATIC INIT(0);
  DCL TIMELIMIT BIN FIXED(31) STATIC INIT(200);
  DCL GAMESTART BIN FIXED(31) STATIC INIT(0);
  DCL CURSECONDS BIN FIXED(31) STATIC INIT(0);
  DCL CRUNCH    BIN FIXED(31) STATIC INIT(12345);
  DCL CLOCKSEC PIC'ZZ9';
  DCL FLD1     PIC'---9';
  DCL FLD2     PIC'---9';
  DCL QUARTER         PIC'9' STATIC INIT(1);
  DCL TIMER        PIC'(9)9' STATIC INIT(0);
  DCL PLAYCALL       PIC'99' STATIC INIT(0);
  DCL MYSCORE       PIC'ZZ9' STATIC INIT(0);
  DCL THIERSCORE    PIC'ZZ9' STATIC INIT(0);
  DCL CURRENTCLOCK PIC'(9)9' STATIC INIT(0);
  DCL ANSWER CHAR(1);
  DCL RAND ENTRY(FIXED BIN(31),FLOAT DEC(6));
         DCL TIME BUILTIN;
 W='LINEMAN CRASHES THROUGH TO BLOCK PASS ';
  DCL NUMBER DEC FLOAT(6) STATIC INIT(12345);
  DCL 1 START DEF TIMER,
      2 HH PIC'99',
      2 MM PIC'99',
      2 SS PIC'99',
      2 MS PIC'999';
  DCL 1 CURRENT DEF CURRENTCLOCK,
      2 HH PIC'99',
      2 MM PIC'99',
      2 SS PIC'99',
      2 MS PIC'999';
  DCL STARTHUDDLE BIN FIXED(31) STATIC INIT(0);
  DCL ENDHUDDLE BIN FIXED(31) STATIC INIT(0);
  DCL QTR(4) CHAR(7);
  DCL LINE CHAR(129) VAR;
  DCL ENDGAME BIN FIXED(15) INIT(0);
  DCL WORKNUM BIN FIXED(15) INIT(0);
  DCL WARNING BIN FIXED(15) INIT(0);
  DCL GAINLSS BIN FIXED(15) INIT(0);
  DCL MYPLAY  BIN FIXED(15) INIT(0);
  DCL YARDON  BIN FIXED(15) INIT(0);
  DCL DOWN    BIN FIXED(15) INIT(1);
  DCL RTN     BIN FIXED(15) INIT(0);
  DCL I       BIN FIXED(15) INIT(0);
  DCL U_PLAY  BIN FIXED(15) INIT(0);
  DCL I_PLAY  BIN FIXED(15) INIT(0);
  DCL U_PASS  BIN FIXED(15) INIT(0);
  DCL I_PASS  BIN FIXED(15) INIT(0);
  DCL U_P_OK  BIN FIXED(15) INIT(0);
  DCL I_P_OK  BIN FIXED(15) INIT(0);
  DCL I_INTR  BIN FIXED(15) INIT(0);
  DCL U_INTR  BIN FIXED(15) INIT(0);
  DCL U_F_YD  BIN FIXED(15) INIT(0);
  DCL U_K_YD  BIN FIXED(15) INIT(0);
  DCL U_P_YD  BIN FIXED(15) INIT(0);
  DCL U_R_YD  BIN FIXED(15) INIT(0);
  DCL I_F_YD  BIN FIXED(15) INIT(0);
  DCL I_K_YD  BIN FIXED(15) INIT(0);
  DCL I_P_YD  BIN FIXED(15) INIT(0);
  DCL I_R_YD  BIN FIXED(15) INIT(0);
  DCL I_KICK  BIN FIXED(15) INIT(0);
  DCL I_K1CK  BIN FIXED(15) INIT(0);
  DCL U_KICK  BIN FIXED(15) INIT(0);
  DCL U_K1CK  BIN FIXED(15) INIT(0);
  DCL I_LOST  BIN FIXED(15) INIT(0);
  DCL I_F_NO  BIN FIXED(15) INIT(0);
  DCL U_LOST  BIN FIXED(15) INIT(0);
  DCL U_F_NO  BIN FIXED(15) INIT(0);
  DCL I_FD_P  BIN FIXED(15) INIT(0);
  DCL I_FD_R  BIN FIXED(15) INIT(0);
  DCL U_FD_P  BIN FIXED(15) INIT(0);
  DCL U_FD_R  BIN FIXED(15) INIT(0);
  DCL I_K_RB  BIN FIXED(15) INIT(0);
  DCL U_K_RB  BIN FIXED(15) INIT(0);
  DCL I_THRD  BIN FIXED(15) INIT(0);
  DCL U_THRD  BIN FIXED(15) INIT(0);
  DCL DNWRD CHAR(7);
  DCL WHO_FRST CHAR(1);
  DCL TWO_MN CHAR(1) INIT('2');
  DCL W CHAR(120) VAR;
  W = ' '; CALL HTPUT(W);
  QTR(1) = 'quarter';
  QTR(2) = 'half.  ';
  QTR(3) = 'quarter';
  QTR(4) = 'game.  ';
  TWO_MN = '2';
  W = 'Welcome to  T S O  football'; CALL HTPUT(W);
  W = 'Do you need instructions? Reply N or Y'; CALL HTPUT(W);
 TGET1:
   CALL TGET(LINE,RTN);
   IF RTN = 8 THEN GOTO TGET1;
   IF RTN > 0 THEN RETURN;
   ANSWER = LINE;
   IF ANSWER = 'N' THEN GOTO BYPASS;
   IF ANSWER = 'n' THEN GOTO BYPASS;
   W = ' ';  CALL HTPUT(W);
   W = 'The following are the offensive codes,'; CALL HTPUT(W);
   W = '              and the defensive codes.'; CALL HTPUT(W);
   W = '====================='; CALL HTPUT(W);
   W = 'O f f e n s i v e :';   CALL HTPUT(W);
   W = '====================='; CALL HTPUT(W);
   w = '08 = Trap ';            call htput(W);
   W = '09 = Option ';          CALL HTPUT(W);
   W = '10 = Run';              CALL HTPUT(W);
   W = '11 = Draw';             CALL HTPUT(W);
   W = '12 = Sweep';            CALL HTPUT(W);
   W = '13 = Screen';           CALL HTPUT(W);
   W = '14 = Pass';             CALL HTPUT(W);
   W = '15 = Long pass';        CALL HTPUT(W);
   W = '16 = Punt';             CALL HTPUT(W);
   W = '17 = Fieldgoal try';    CALL HTPUT(W);
   W = '====================='; CALL HTPUT(W);
   W = 'D e f e n s i v e :';   CALL HTPUT(W);
   W = '====================='; CALL HTPUT(W);
   W = '20=Hold:Use for run and draw'; CALL HTPUT(W);
   W = '21=Normal:Use for sweep and screen'; CALL HTPUT(W);
   W = '22=Blitz (reddog):use for pass & long pass'; call htput(W);
   W = '23=Intercept:Better odds for interception'; CALL HTPUT(W);
   W = '24=Block:Use for kicks and punts'; CALL HTPUT(W);
   W = '25=Zone:use for prevent defense'; CALL HTPUT(W);
   W = '26=9-2:use for sweep & option';   CALL HTPUT(W);
   W = '================================';CALL HTPUT(W);
   W = ' ';  CALL HTPUT(W);
   W = 'There are 4 clocked quarters.'; CALL HTPUT(W);
   W = 'The quarter duration will be set before kickoff.';
   CALL HTPUT(W);
   W = 'No time out''s allowed . . Good luck'; CALL HTPUT(W);
   W = 'A 99 code causes the game to be called.'; CALL HTPUT(W);
   W = 'Remove the instructions for reference.';  CALL HTPUT(W);
   W = ' '; CALL HTPUT(W);
0 BYPASS:
   CRUNCH = TIME;
   W='First, set the quarter duration.';
   CALL HTPUT(W);
  RE_GOT:
   W='Anything from 2 to 7 minutes is acceptable.';
   CALL HTPUT(W);
   W='Enter a one digit number - 2 thru 7 - please.';
   CALL HTPUT(W);
   CALL TGET(LINE,RTN);
   IF RTN = 8 THEN GOTO RE_GOT;
   IF RTN > 0 THEN RETURN;
   QUARTER = LINE;
   IF QUARTER < 2 × QUARTER > 7 THEN GOTO RE_GOT;
   TIMELIMIT = (QUARTER * 60);
   QUARTER = 1;
   CRUNCH = TIME;
   W='Coin toss to start game . . .';
   CALL HTPUT(W);
   W='You call it in the air, heads (h) or tails (t).';
   CALL HTPUT(W);
   W='f l i p . . . .';
   CALL HTPUT(W);
 TGET2:
   CALL TGET(LINE,RTN);
   IF RTN = 8 THEN GOTO TGET2;
   IF RTN > 0 THEN RETURN;
   ANSWER = LINE;
   TIMER = TIME;
   GAMESTART = (START.HH*3600) + (START.MM*60) + (START.SS);
   CALL RAND(CRUNCH,NUMBER);
   IF ANSWER = 'H' & NUMBER < .499999 THEN GOTO BEGIN_IT;
   IF ANSWER = 'h' & NUMBER < .499999 THEN GOTO BEGIN_IT;
   IF ANSWER = 'T' & NUMBER > .499998 THEN GOTO BEGIN_IT;
   IF ANSWER = 't' & NUMBER > .499998 THEN GOTO BEGIN_IT;
   IF ANSWER = 'H' × ANSWER = 'h' THEN GOTO I_WIN;
   IF ANSWER = 'T' × ANSWER = 't' THEN GOTO I_WIN;
    W = 'Wrong! Reply h or t please.'; CALL HTPUT(W);
    GOTO TGET2;
 I_WIN:
   WHO_FRST = 'M';
   W='I win the coin toss.';
   CALL HTPUT(W);
   BALLOWNER = 1;
   GOTO STARTUP;
 RE_START_IT:
   IF TWO_MN = 'M' THEN BALLOWNER = 0;
                   ELSE BALLOWNER = 1;
   GOTO STARTUP;
 BEGIN_IT:
   WHO_FRST = 'Y';
   W='You win the flip.';
   CALL HTPUT(W);
   BALLOWNER = 0;
 STARTUP:
   IF ENDGAME = 1 THEN GOTO FINIS;
   CALL KICKOFF;
   IF WHO_FRST = 'Q' THEN WHO_FRST = 'A';
 MYBALL:
   IF ENDGAME = 1 THEN GOTO FINIS;
   IF WHO_FRST = 'Q' THEN GOTO RE_START_IT;
   IF BALLOWNER = 1 THEN DO;
     CURRENTCLOCK = TIME;
     STARTHUDDLE=(CURRENT.HH*3600)+(CURRENT.MM*60)+(CURRENT.SS);
 TRYAGAIN:
     W = 'Defense?';  CALL HTPUT(W);
  TGET3:
     CALL TGET(LINE,RTN);
     IF RTN = 8 THEN GOTO TGET3;
     IF RTN > 0 THEN RETURN;
     I = LENGTH(LINE);
     IF I > 2 × I < 2 THEN GOTO TRYAGAIN;
     I = VERIFY(LINE,'0123456789');
     IF I ^=0 THEN DO;
        W = 'Wrong!';
        CALL HTPUT(W);
        GOTO TRYAGAIN;
        END;
     PLAYCALL = LINE;
   IF PLAYCALL = 99 THEN GOTO QUITTER;
   I_PLAY = I_PLAY + 1;
   CURRENTCLOCK = TIME;
   ENDHUDDLE=(CURRENT.HH*3600)+(CURRENT.MM*60)+(CURRENT.SS);
   IF ANSWER = 'Q' THEN DO;
      ANSWER = 'X';
      GOTO MO_Q_NO;    END;
   IF (ENDHUDDLE-STARTHUDDLE) > 30 THEN DO;
     W = 'Delay of game. 5 yard penalty.'; CALL HTPUT(W);
     W = 'Clock reset for time delayed.'; CALL HTPUT(W);
     CURSECONDS=(CURSECONDS-(ENDHUDDLE-STARTHUDDLE));
     IF YARDTOGO < 6 THEN DO; YARDTOGO = 10;
                              DOWN = 1; END;
                     ELSE YARDTOGO = YARDTOGO-5;
     IF YARDON > 94 THEN YARDON = 99;
                    ELSE YARDON = YARDON +5;
     CALL YARDMRK;
     GOTO MYBALL;  END;
   MO_Q_NO:
   IF PLAYCALL < 20 × PLAYCALL > 26 THEN DO;
     W = 'That defense is not available'; CALL HTPUT(W);
     GOTO TRYAGAIN;  END;
   CALL OFFENSE;
         W = 'The offensive play was' ×× myplay; call htput(w);
              IF MYPLAY = 8 THEN DO ;
              IF PLAYCALL = 20 × PLAYCALL = 22 THEN CALL COMPAT;
              ELSE CALL INCOMP ;
              END ;
            ELSE IF MYPLAY = 9 THEN DO ;
       IF PLAYCALL = 26 × PLAYCALL = 22 THEN CALL COMPAT ;
       ELSE  CALL INCOMP ;
       END ;
   IF MYPLAY = 10 × MYPLAY = 11 THEN DO;
     IF PLAYCALL = 20 THEN CALL COMPAT;
                      ELSE CALL INCOMP;  END;
   ELSE IF MYPLAY = 12 × MYPLAY = 13 THEN DO;
     IF PLAYCALL = 21 THEN CALL COMPAT;
                     ELSE CALL INCOMP;  END;
   ELSE IF MYPLAY = 14 × MYPLAY= 15 THEN DO;
     I_PASS = I_PASS + 1;
     IF PLAYCALL = 22 × PLAYCALL = 23 × PLAYCALL =25 THEN CALL COMPAT;
                                      ELSE CALL INCOMP;  END;
   ELSE IF MYPLAY = 16 THEN DO;
     I_KICK = I_KICK + 1;
     IF PLAYCALL = 24 THEN DO;
        CALL RAND(CRUNCH,NUMBER);
        IF NUMBER > .800000 THEN DO;
           W = '***Punt Blocked***'; CALL HTPUT(W);
           I_K1CK = I_K1CK + 1;
           IF YARDON > 4 THEN DO;
              I_K_YD = I_K_YD - 4;
              YARDON = YARDON - 4;
              END;
           DOWN = 1;
           YARDTOGO = 10;
           BALLOWNER = 0;
           YARDON = 100 - YARDON;
           CALL YARDMRK;
           CALL TIMERTN;
           GOTO MYBALL;  END;
        ELSE DO;
        TOPPUNT1:
           CALL RAND(CRUNCH,NUMBER);
           WORKNUM = NUMBER * 70;
           IF WORKNUM < 20 THEN WORKNUM = WORKNUM + 20;
           I_K_YD = I_K_YD + WORKNUM;
           IF WORKNUM + YARDON> 99 THEN DO;
              I_K_YD = I_K_YD - 20;
              W = 'PUNTED INTO ENDZONE, BALL PLACED ON THE 20.';
              CALL HTPUT(W);
              BALLOWNER = 0;
              YARDON = 20;
              DOWN = 1;
              YARDTOGO = 10;
              CALL TIMERTN;
              GOTO MYBALL;  END;
           YARDON = YARDON + WORKNUM;
           IF NUMBER < .300000 THEN W='Punt rolls out-of bounds.';
                               ELSE
              IF NUMBER < .449999 THEN DO; W='Fair catch signalled.';
                                           END;
                                  ELSE DO;
               IF YARDON > 50 THEN FLD1 = 100 - YARDON;
                              ELSE FLD1 = YARDON;
               W='Punt gathered in on the' ×× FLD1;
               CALL HTPUT(W);
               CALL RAND(CRUNCH,NUMBER);
               IF NUMBER > .499999 THEN WORKNUM=(NUMBER*10)*5;
                                   ELSE WORKNUM=(NUMBER*10)*7;
               FLD1 = WORKNUM;
               U_K_RB = U_K_RB + WORKNUM;
               W='and run back . . . .' ×× FLD1 ×× ' yards.';
               YARDON = YARDON - WORKNUM;
               I_K_YD = I_K_YD - WORKNUM;
               END;
           CALL HTPUT(W);
           DOWN = 1;
           BALLOWNER = 0;
           YARDTOGO = 10;
           YARDON = 100 - YARDON;
           CALL YARDMRK;
           CALL TIMERTN;
           GOTO MYBALL;  END;
        END;
     ELSE GOTO TOPPUNT1;  END;
   ELSE IF MYPLAY = 17 THEN DO;
      I_KICK = I_KICK + 1;
      CALL FLDGOAL;
      IF WHO_FRST = 'Q' THEN GOTO RE_START_IT;
      IF DOWN = 1 THEN GOTO MYBALL;
                  ELSE GOTO STARTUP;  END;
   IF WHO_FRST = 'Q' THEN GOTO RE_START_IT;
   IF BALLOWNER = 1 THEN GOTO MYBALL;
                    ELSE GOTO THIERBALL;  END;
-THIERBALL:
   IF ENDGAME = 1 THEN GOTO FINIS;
   IF WHO_FRST = 'Q' THEN GOTO RE_START_IT;
   IF BALLOWNER = 0 THEN DO;
     CURRENTCLOCK = TIME;
     STARTHUDDLE=(CURRENT.HH*3600)+(CURRENT.MM*60)+(CURRENT.SS);
   TRY:
     W = 'Offense?'; CALL HTPUT(W);
   TGET4:
     CALL TGET(LINE,RTN);
     IF RTN = 8 THEN GOTO TGET4;
     IF RTN > 0 THEN RETURN;
     I = LENGTH(LINE);
     IF I > 2 × I < 2 THEN GOTO TRY;
     I = VERIFY(LINE,'0123456789');
     IF I ^= 0 THEN DO;
        W = 'Wrong!';
        CALL HTPUT(W);
        GOTO TRY;
        END;
     PLAYCALL = LINE;
 IF PLAYCALL = 99 THEN GOTO QUITTER;
 U_PLAY = U_PLAY + 1;
 CURRENTCLOCK = TIME;
 ENDHUDDLE=(CURRENT.HH*3600)+(CURRENT.MM*60)+(CURRENT.SS);
 IF ANSWER = 'Q' THEN DO;
    ANSWER = 'X';
    GOTO NO_MO_Q;    END;
 IF (ENDHUDDLE-STARTHUDDLE) > 30 THEN DO;
   W = 'Delay of game. 5 yard penalty.'; CALL HTPUT(W);
   W = 'Clock reset for time delayed.'; CALL HTPUT(W);
   CURSECONDS=(CURSECONDS-(ENDHUDDLE-STARTHUDDLE));
   IF YARDON < 6 THEN DO; YARDON = 1;
                          YARDTOGO=YARDTOGO+(YARDON-1); END;
                 ELSE DO; YARDON = YARDON - 5;
                          YARDTOGO=YARDTOGO+5; END;
   PLAYCALL = 00;
   CALL YARDMRK;
   GOTO THIERBALL;  END;
0  NO_MO_Q:
     IF PLAYCALL < 08 × PLAYCALL > 17 THEN DO;
         W = 'Sorry! That play not allowed.'; CALL HTPUT(W);
         GOTO TRY;  END;
     CALL DEFENSE;
         W = 'My defense called a' ×× myplay ; Call HTPUT(W);
              IF PLAYCALL = 8 THEN DO ;
              IF MYPLAY = 20 × MYPLAY = 22 THEN CALL COMPAT ;
              ELSE CALL INCOMP ;
              END ;
                 ELSE IF PLAYCALL = 9 THEN DO ;
        IF MYPLAY = 26 × MYPLAY = 21 × MYPLAY=22 THEN CALL COMPAT ;
                 ELSE CALL INCOMP ;
                 END ;
   IF PLAYCALL = 10 × PLAYCALL = 11 THEN DO;
     IF MYPLAY = 20 THEN CALL COMPAT;
                    ELSE CALL INCOMP;  END;
   ELSE IF PLAYCALL = 12 × PLAYCALL = 13 THEN DO;
     IF MYPLAY = 21 THEN CALL COMPAT;
                    ELSE CALL INCOMP;  END;
   ELSE IF PLAYCALL = 14 × PLAYCALL = 15 THEN DO;
     U_PASS = U_PASS + 1;
     IF MYPLAY = 22 × MYPLAY = 23 × MYPLAY = 25
         THEN CALL COMPAT;
         ELSE CALL INCOMP;  END;
     ELSE IF PLAYCALL = 16 THEN DO;
       U_KICK = U_KICK + 1;
       IF MYPLAY = 24 THEN DO;
          CALL RAND(CRUNCH,NUMBER);
          IF NUMBER > .800000 THEN DO;
            W = '***Punt Blocked***'; CALL HTPUT(W);
            U_K1CK = U_K1CK + 1;
            IF YARDON > 4 THEN DO;
               U_K_YD = U_K_YD - 4;
               YARDON = YARDON - 4;
               END;
            DOWN = 1;
            YARDTOGO = 10;
            BALLOWNER = 1;
            YARDON = 100 - YARDON;
            CALL YARDMRK;
            CALL TIMERTN;
            GOTO MYBALL;  END;
          ELSE DO;
          TOPPUNT2:
               CALL RAND(CRUNCH,NUMBER);
               WORKNUM = NUMBER * 100;
               IF WORKNUM < 20 THEN WORKNUM = WORKNUM + 20;
               U_K_YD = U_K_YD + WORKNUM;
               IF WORKNUM + YARDON > 99 THEN DO;
                    U_K_YD = U_K_YD - 20;
                    W = 'PUNTED INTO ENDZONE, BALL PLACED ON THE 20.';
                    CALL HTPUT(W);
                    BALLOWNER = 1;
                    YARDON = 20;
                    DOWN = 1;
                    YARDTOGO = 10;
                    CALL TIMERTN;
                    GOTO MYBALL;  END;
               YARDON = YARDON + WORKNUM;
               IF NUMBER < .300000 THEN W='Punt rolls out-of-bounds.';
                                   ELSE
                  IF NUMBER < .449999 THEN DO;
                     W='Fair catch signalled.';
                     END;
                  ELSE DO;
                     IF YARDON > 50 THEN FLD1 = 100 - YARDON;
                                    ELSE FLD1 = YARDON;
                     W='Punt received on the' ×× FLD1;
                     CALL HTPUT(W);
                     CALL RAND(CRUNCH,NUMBER);
                     IF NUMBER > .499999 THEN WORKNUM = (NUMBER*10)*6;
                                         ELSE WORKNUM = (NUMBER*11)*6;
                     FLD1 = WORKNUM;
                     I_K_RB = I_K_RB + WORKNUM;
                     W='and returned . . . .' ×× FLD1 ×× ' yards.';
                     YARDON = YARDON - WORKNUM;
                     U_K_YD = U_K_YD - WORKNUM;
                     END;
               CALL HTPUT(W);
               DOWN = 1;
               BALLOWNER = 1;
               YARDTOGO = 10;
               YARDON = 100 - YARDON;
               CALL YARDMRK;
               CALL TIMERTN;
               GOTO MYBALL;  END;
            END;
         ELSE GOTO TOPPUNT2;
     END;
     ELSE IF PLAYCALL = 17 THEN DO;
         U_KICK = U_KICK + 1;
         CALL FLDGOAL;
         IF WHO_FRST = 'Q' THEN GOTO RE_START_IT;
         IF DOWN = 1 THEN GOTO MYBALL;
                     ELSE GOTO STARTUP;  END;
       IF WHO_FRST = 'Q' THEN GOTO RE_START_IT;
     IF BALLOWNER = 1 THEN GOTO MYBALL;
                      ELSE GOTO THIERBALL;  END;
1QUITTER:
    QUARTER = 4;
    TIMELIMIT = 0;
    WARNING = 1;
    CALL TIMERTN;
    GOTO FINIS;



-DEFENSE: PROC; /* GENERATES PLAYS 20,21,22,23,24,25,26 */
   IF ENDGAME = 1 THEN RETURN;
   IF DOWN = 4 THEN DO;
     IF YARDON < 50 THEN DO;
    CALL RAND(CRUNCH,NUMBER);
         IF NUMBER > .49 THEN MYPLAY = 24 ;
         IF NUMBER < .50 THEN MYPLAY = 22 ;
         IF NUMBER < .15 THEN MYPLAY = 21 ;
         RETURN;  END;
     END;
   IF DOWN = 1 & YARDON>90 THEN DO;
     IF BALLOWNER = 0 THEN DO;
        W='Defensive line digging in.';
        CALL HTPUT(W);
        END;
     END;
   CALL RAND(CRUNCH,NUMBER);
   IF DOWN < 4 & YARDTOGO > 16 THEN DO;
      MYPLAY = ((NUMBER * 2) + 22);
      if myplay = 24 then myplay = 25;
          RETURN ;
        END;
   WORKNUM = NUMBER * 10;
       IF DOWN  = 1 & YARDTOGO > 5 THEN DO;
          TEST =((WORKNUM / 2) + 20);
          IF TEST + 4 = 26 THEN MYPLAY = 26 ;
          ELSE MYPLAY = TEST ;
          IF MYPLAY = 24 THEN MYPLAY = 22 ;
          IF MYPLAY = 25 THEN MYPLAY = 20 ;
          RETURN ;
      END;
          IF DOWN = 2 & YARDTOGO < 5 THEN DO ;
             TEST = ((WORKNUM/2) + 20 );
             IF TEST > 26 THEN MYPLAY = ((WORKNUM/2) + 20 );
              ELSE MYPLAY = TEST;
           IF MYPLAY = 24 THEN MYPLAY = 26 ;
              RETURN ;
           END;
           IF DOWN = 2 & YARDTOGO > 4 & YARDTOGO < 11 THEN DO ;
                 TEST = ((WORKNUM / 2 ) + 25) ;
                 IF TEST = 25 THEN MYPLAY = 22 ;
                 ELSE MYPLAY = ((WORKNUM /2) + 20) ;
      IF DOWN = 2 & YARDTOGO > 10 THEN DO ;
      TEST = ((WORKNUM / 2) + 20) ;
      IF TEST = 24 THEN MYPLAY = 23 ;
      ELSE IF TEST = 20 THEN MYPLAY = 22 ;
      ELSE IF TEST = 25 THEN MYPLAY = 23 ;
         ELSE MYPLAY = TEST ;
        RETURN ; END ;
        IF MYPLAY = 24 THEN MYPLAY =  20 ;
                 RETURN ;          END;
        IF DOWN = 3 & YARDTOGO < 3 THEN DO ;
            TEST = ((WORKNUM /2) + 26) ;
            IF TEST = 26 THEN MYPLAY = 26 ;
            ELSE MYPLAY =((WORKNUM / 2) + 20) ;
             IF MYPLAY = 24 THEN MYPLAY =23;
            RETURN ;
            END ;
        IF DOWN = 3 & YARDTOGO > 2 & YARDTOGO < 6 THEN DO;
           TEST = ((WORKNUM / 2) + 26) ;
           IF TEST = 26 THEN MYPLAY = 26;
           ELSE MYPLAY = ((WORKNUM / 2) + 20) ;
           IF MYPLAY = 24 THEN MYPLAY = 25;
           RETURN ;
        END ;
        IF DOWN = 3 & YARDTOGO > 5 & YARDTOGO < 15 THEN DO ;
            TEST = ((WORKNUM / 2) + 25) ;
            IF TEST = 25 THEN MYPLAY = 25 ;
           ELSE MYPLAY = ((WORKNUM /2) + 21) ;
            IF MYPLAY = 24 THEN MYPLAY = 20 ;
            RETURN ;
            END ;
         IF DOWN = 3 & YARDTOGO > 24 THEN DO ;
         myplay = 25 ;
         return ;
         end ;
   MYPLAY = (WORKNUM / 2) + 20;
           IF MYPLAY = 24 THEN MYPLAY = 21 ;
   RETURN;
 END; /* END DEFENSE */


1OFFENSE: PROC;
   IF QUARTER = 4 × QUARTER = 2 THEN DO;
     IF CURSECONDS > (TIMELIMIT - 13) THEN DO;
     IF YARDON > 47 & TWO_MN = 'X' THEN DO;
       MYPLAY=17;
       RETURN;  END;
     END;
    END;
 IF DOWN = 4 THEN DO;
 IF YARDTOGO=0 THEN DO;
   CALL RAND(CRUNCH,NUMBER);
   IF NUMBER>.500000 THEN DO;
      W = 'I''ll go for it'; CALL HTPUT(W);
      GOTO RECALL;  END;
   END;
 IF MYSCORE <= THIERSCORE THEN DO;
    IF (THIERSCORE - MYSCORE) <= 3 & YARDON > 47 THEN DO;
       MYPLAY = 17;
       RETURN;
       END;
   IF YARDON > 54 & YARDTOGO < 7 THEN GOTO RECALL;
   IF QUARTER=4 & YARDON >40 THEN GOTO RECALL; END;
   IF YARDON < 47 THEN DO;
       call rand(crunch,number) ;
       if number > .85 then myplay = 14;
       else myplay = 16 ;
     RETURN;  END;
   MYPLAY = 17;
   RETURN;  END;
 IF DOWN = 1 & YARDON > 90 THEN DO;
    IF BALLOWNER = 1 THEN DO;
    W = 'Coach sends in goal line series';
    CALL HTPUT(W); END;   END;



 RECALL:
   CALL RAND(CRUNCH,NUMBER);
  WORKNUM = NUMBER * 10 + 7;
   if worknum >7 & worknum <16 then do;
                   MYPLAY = WORKNUM ;
                   GOTO DOWN2 ;
                   END;
      ELSE IF WORKNUM < 8 × WORKNUM > 15 THEN GOTO RECALL;
  DOWN2:   IF YARDON > 85 & MYPLAY = 15 THEN MYPLAY = 14 ;
   IF QUARTER = 4 & MYSCORE<THIERSCORE THEN DO;
     IF MYPLAY =14 × MYPLAY = 15 THEN DO;
       IF PLAYCALL = 22 THEN DO;
         w='28-Green....28-Green...Hut-Hut.';      CALL HTPUT(W);
       W='Sorry. I read your BLITZ, so I audibled!'; CALL HTPUT(W);
       IF YARDON > 50 THEN MYPLAY = 11 ; ELSE MYPLAY = 13 ;
       RETURN;  END;
       END;
    END;
 RETURN;
0END; /* END OFFENSE */
1KICKOFF: PROC;
 TOPKICK:
 ANSWER = 'Q';
 IF BALLOWNER = 1 THEN W = 'You kickoff';
                  ELSE W = 'I kickoff';   CALL HTPUT(W);
 W = 'T w e e t . . . . . . . . . thud'; CALL HTPUT(W);
 KICKAGAIN:
 CALL RAND(CRUNCH,NUMBER);
 WORKNUM = NUMBER * 65;
 IF WORKNUM > 59 THEN DO;
    W = 'Ball booted into the endzone.'; CALL HTPUT(W);
   IF WORKNUM < 90 THEN DO;
    W = '*--Touchback--*'; CALL HTPUT(W);
    DOWN = 1;
    YARDON = 20;
    YARDTOGO = 10;
    IF BALLOWNER = 1 THEN W='1st and 10 on my 20';
                     ELSE W='1st and 10 on your 20';
    CALL HTPUT(W);
    CALL TIMERTN;
    RETURN;  END;
0   W='Deep receiver elects to run it out.';
    CALL HTPUT(W);
    WORKNUM = ((NUMBER - .899999) * 100);
    WORKNUM = WORKNUM * WORKNUM;
    IF WORKNUM < 9 THEN WORKNUM = WORKNUM + 17;
    FLD1 = WORKNUM;
    W='and runs it back . . . .' ×× FLD1 ×× ' yards.';
    CALL HTPUT(W);
    DOWN = 1;
    YARDTOGO = 10;
    YARDON = WORKNUM;
    IF BALLOWNER = 1 THEN I_K_RB = I_K_RB + WORKNUM;
                     ELSE U_K_RB = U_K_RB + WORKNUM;
    MYPLAY = 99;
    PLAYCALL = 99;
    CALL YARDMRK;
    CALL TIMERTN;
    RETURN;  END;
 IF WORKNUM < 35 THEN GOTO KICKAGAIN;
 YARDON = 100 - (WORKNUM + 40);
 FLD1 = YARDON;
 W = 'Ball received on the ' ×× FLD1; CALL HTPUT(W);
 W = '     and run back...'; CALL HTPUT(W);
 CALL RAND(CRUNCH,NUMBER);
 IF NUMBER > .900000 THEN WORKNUM = (NUMBER * 10) * 7;
                     ELSE WORKNUM = NUMBER * 10;
   IF WORKNUM + YARDON > 99 THEN DO;  /**** MY FIX FOR VALIDITY **/
     YARDON = 100 - YARDON;
     FLD2 = YARDON;
     IF BALLOWNER = 1 THEN I_K_RB = I_K_RB + YARDON;
                      ELSE U_K_RB = U_K_RB + YARDON;
     W = '     ' ×× FLD2 ×× ' yards'; CALL HTPUT(W);
     W = '* * T o u c h d o w n * *'; CALL HTPUT(W);
     CALL EXTRAPT;
     GOTO TOPKICK;  END;
 IF BALLOWNER = 1 THEN DO;
     I_K_RB = I_K_RB + WORKNUM;
     IF YARDON + WORKNUM > 50 THEN DO;
         YARDON = (YARDON + WORKNUM);
         FLD1 = 100 - YARDON;
         W = '     to your ' ×× FLD1; CALL HTPUT(W);
     SET:
         DOWN = 1;
         YARDTOGO = 10;
         CALL TIMERTN;
         RETURN;  END;
     ELSE DO;
         YARDON = YARDON + WORKNUM;
         FLD2 = YARDON;
         W = '     to my ' ×× FLD2; CALL HTPUT(W);
         GOTO SET;  END;
     END;
 ELSE DO;
     U_K_RB = U_K_RB + WORKNUM;
     IF YARDON + WORKNUM > 50 THEN DO;
         YARDON = (YARDON + WORKNUM);
         FLD1 = 100 - YARDON;
         W = '     to my ' ×× FLD1; CALL HTPUT(W);
     SET1:
         DOWN = 1;
         YARDTOGO= 10;
         CALL TIMERTN;
         RETURN;  END;
     ELSE DO;
         YARDON = YARDON + WORKNUM;
         FLD2 = YARDON;
         W = '     to your ' ×× FLD2; CALL HTPUT(W);
         GOTO SET1;  END;
     END;
0END; /* END OF PROC */
1EXTRAPT: PROC;
0W = 'The extra point is . . .'; CALL HTPUT(W);
 CALL RAND(CRUNCH,NUMBER);
 IF NUMBER > .200000 THEN W = '... GOOD';
                     ELSE W = 'No  good'; CALL HTPUT(W);
 IF BALLOWNER = 1 THEN DO;
     IF NUMBER > .200000 THEN
     MYSCORE = MYSCORE + 7;
     ELSE MYSCORE = MYSCORE + 6;  END;
 ELSE DO;
     IF NUMBER > .200000 THEN
     THIERSCORE = THIERSCORE + 7;
     ELSE THIERSCORE = THIERSCORE + 6;  END;
 W = 'Score: YOU ' ×× THIERSCORE ×× '   ME ' ×× MYSCORE;
    CALL HTPUT(W);
 IF BALLOWNER = 1 THEN BALLOWNER = 0;
                  ELSE BALLOWNER = 1;
0END; /* END OF PROC. */
1TIMERTN: PROC;
0CURRENTCLOCK = TIME;
 CURSECONDS = (CURRENT.HH*3600)+(CURRENT.MM*60)+(CURRENT.SS);
 CURSECONDS = CURSECONDS - GAMESTART;
 IF CURSECONDS > (TIMELIMIT - 120) THEN DO;
     IF QUARTER = 2 × QUARTER = 4 THEN DO;
         IF WARNING = 0 THEN DO;
              W='...TWEEEET! Official time out. . Two minute warning.';
              WARNING = 1;
              TWO_MN = 'X';
              CALL HTPUT(W);  END;
        END;
    END;
 IF CURSECONDS > TIMELIMIT THEN DO;
     IF QUARTER = 1 × QUARTER = 3 THEN DO;
          QUARTER = QUARTER + 1;
          TWO_MN = '2';
          W = 'End of quarter, Score: YOU ' ×× THIERSCORE ××
              '   ME ' ×× MYSCORE;  CALL HTPUT(W);
          TIMER = TIME;
          GAMESTART = (START.HH*3600)+(START.MM*60)+(START.SS);
          W='Reset timer . . Start next period.'; CALL HTPUT(W);
          RETURN;  END;
     ELSE IF QUARTER = 2 THEN DO;
         W = '...TWEEEET ! End of half, Score: YOU ' ×× THIERSCORE ××
             '   ME ' ×× MYSCORE;  CALL HTPUT(W);
         QUARTER = QUARTER + 1;
         WARNING = 0;
         TWO_MN = WHO_FRST;
         TIMER = TIME;
         GAMESTART = (START.HH*3600)+(START.MM*60)+(START.SS);
         W='Reset timer . . Start 2nd half.'; CALL HTPUT(W);
         W='Set for the 2nd half kickoff now, and . .';
         CALL HTPUT(W);
         DOWN = 1;
         IF WHO_FRST = 'M' THEN BALLOWNER = 0;
                           ELSE BALLOWNER = 1;
         WHO_FRST = 'Q';
         RETURN;  END;
     ELSE DO;
         W = ' ';
         CALL HTPUT(W);
         IF TIMELIMIT > 0 THEN W='Bang ! Game ended.';
            ELSE W='Game cancelled due to divine intervention.';
         CALL HTPUT(W);
         W = ' ';
         CALL HTPUT(W);
         W='The final is... YOU ' ×× THIERSCORE ×× '   ME ' ×× MYSCORE;
         CALL HTPUT(W);
         W = ' ';
         CALL HTPUT(W);
         W = ' ';
         CALL HTPUT(W);
         W='Game statistics:        You    Me';
         CALL HTPUT(W);
         W=' ';
         CALL HTPUT(W);
         FLD1 = U_FD_R + U_FD_P;
         FLD2 = I_FD_R + I_FD_P;
         W='Total first downs   =  ' ×× FLD1 ×× '  ' ×× FLD2;
         CALL HTPUT(W);
         FLD1 = U_FD_R;
         FLD2 = I_FD_R;
         W='First downs running =  ' ×× FLD1 ×× '  ' ×× FLD2;
         CALL HTPUT(W);
         FLD1 = U_FD_P;
         FLD2 = I_FD_P;
         W='First downs passing =  ' ×× FLD1 ×× '  ' ×× FLD2;
         CALL HTPUT(W);
         FLD1 = U_PLAY;
         FLD2 = I_PLAY;
         W='Total plays =          ' ×× FLD1 ×× '  ' ×× FLD2;
         CALL HTPUT(W);
         FLD1 = U_PLAY - (U_PASS + U_KICK);
         FLD2 = I_PLAY - (I_PASS + I_KICK);
         W='Run   plays =          ' ×× FLD1 ×× '  ' ×× FLD2;
         CALL HTPUT(W);
         FLD1 = U_PASS;
         FLD2 = I_PASS;
         W='Pass  plays =          ' ×× FLD1 ×× '  ' ×× FLD2;
         CALL HTPUT(W);
         FLD1 = U_P_OK;
         FLD2 = I_P_OK;
         W='Completed Passes  =    ' ×× FLD1 ×× '  ' ×× FLD2;
         CALL HTPUT(W);
         IF U_PASS = 0 THEN FLD1 = 0;
                       ELSE FLD1 = (100 * (U_P_OK / U_PASS) + 0.5);
         IF I_PASS = 0 THEN FLD2 = 0;
                       ELSE FLD2 = (100 * (I_P_OK / I_PASS) + 0.5);
         W='Pass Completion % =    ' ×× FLD1 ×× '  ' ×× FLD2;
         CALL HTPUT(W);
         FLD1 = U_INTR;
         FLD2 = I_INTR;
         W='Passes had intercepted=' ×× FLD1 ×× '  ' ×× FLD2;
         CALL HTPUT(W);
         FLD1 = U_P_YD + U_R_YD + U_F_YD;
         FLD2 = I_P_YD + I_R_YD + I_F_YD;
         W='Total net yards   =    ' ×× FLD1 ×× '  ' ×× FLD2;
         CALL HTPUT(W);
         FLD1 = U_P_YD;
         FLD2 = I_P_YD;
         W='Net passing yards =    ' ×× FLD1 ×× '  ' ×× FLD2;
         CALL HTPUT(W);
         FLD1 = U_R_YD;
         FLD2 = I_R_YD;
         W='Net running yards =    ' ×× FLD1 ×× '  ' ×× FLD2;
         CALL HTPUT(W);
         FLD1 = U_KICK;
         FLD2 = I_KICK;
         W='Total kicks (Punts+FGs)' ×× FLD1 ×× '  ' ×× FLD2;
         CALL HTPUT(W);
         IF I_KICK = 0 & U_KICK = 0 THEN GOTO NO_KIK;
         FLD1 = U_K1CK;
         FLD2 = I_K1CK;
         W='Kicks had blocked =    ' ×× FLD1 ×× '  ' ×× FLD2;
         CALL HTPUT(W);
         FLD1 = U_K_YD;
         FLD2 = I_K_YD;
         W='Total net yards kicked=' ×× FLD1 ×× '  ' ×× FLD2;
         CALL HTPUT(W);
       NO_KIK:
         FLD1 = U_F_NO;
         FLD2 = I_F_NO;
         W='Total fumbles =        ' ×× FLD1 ×× '  ' ×× FLD2;
         CALL HTPUT(W);
         IF U_F_NO = 0 & I_F_NO = 0 THEN GOTO NO_FUM;
         FLD1 = U_LOST;
         FLD2 = I_LOST;
         W='Fumbles lost  =        ' ×× FLD1 ×× '  ' ×× FLD2;
         CALL HTPUT(W);
         FLD1 = U_F_YD;
         FLD2 = I_F_YD;
         W='Net fumble yardage =   ' ×× FLD1 ×× '  ' ×× FLD2;
         CALL HTPUT(W);
        NO_FUM:
         FLD1 = U_K_RB;
         FLD2 = I_K_RB;
         W='Yards kicks run back = ' ×× FLD1 ×× '  ' ×× FLD2;
         CALL HTPUT(W);
         FLD1 = U_THRD;
         FLD2 = I_THRD;
         W='Third downs converted =' ×× FLD1 ×× '  ' ×× FLD2;
         CALL HTPUT(W);
         FLD1 = U_LOST + U_INTR;
         FLD2 = I_LOST + I_INTR;
         W='Turnovers =            ' ×× FLD1 ×× '  ' ×× FLD2;
         CALL HTPUT(W);
         W = ' ';
         CALL HTPUT(W);
         W = ' ';
         CALL HTPUT(W);
         GOTO FINIS;  END;
    END;
0IF DOWN = 1 THEN DO;
    IF ENDGAME=1 THEN RETURN;
    CLOCKSEC = TIMELIMIT - CURSECONDS;
    W = CLOCKSEC ×× ' seconds left in the ' ×× QTR(QUARTER);
    CALL HTPUT(W);  END;
0END;  /* END OF PROC. */
-YARDMRK: PROC;
0IF DOWN = 1    THEN DNWRD='1st and';
 ELSE IF DOWN=2 THEN DNWRD='2nd and';
 ELSE IF DOWN=3 THEN DNWRD='3rd and';
 ELSE                DNWRD='4th and';
 FLD2 = YARDTOGO;
0IF BALLOWNER=0 THEN DO;  /**** PLAYER HAS BALL ****/
   IF DOWN = 1 THEN DO;
      IF PLAYCALL = 14 × PLAYCALL = 15 THEN U_FD_P = U_FD_P + 1;
      IF PLAYCALL < 14 THEN U_FD_R = U_FD_R + 1;   END;
   IF YARDON>50 THEN DO;
      FLD1=100-YARDON;
      IF (100-YARDON) <= YARDTOGO THEN
         W='Your ball, ' ×× DNWRD ×× ' goal on my' ×× FLD1;
         ELSE
         W='Your ball, ' ×× DNWRD ×× FLD2 ×× ' on my' ×× FLD1;
      CALL HTPUT(W);
      RETURN;  END;
   FLD1 = YARDON;
   W='Your ball, ' ×× DNWRD ×× FLD2 ×× ' on your' ×× FLD1;
   IF YARDON = 50 THEN
      W='Your ball, ' ×× DNWRD ×× FLD2 ×× ' at mid-field.';
    CALL HTPUT(W);
   RETURN;  END;
-ELSE IF BALLOWNER=1 THEN DO;  /**** COMPUTER HAS BALL ****/
   IF DOWN = 1 THEN DO;
      IF MYPLAY = 14 × MYPLAY = 15 THEN I_FD_P = I_FD_P + 1;
      IF MYPLAY < 14 THEN I_FD_R = I_FD_R + 1;  END;
   IF YARDON>50 THEN DO;
      FLD1=100-YARDON;
      IF (100-YARDON) <= YARDTOGO THEN
         W='My ball, ' ×× DNWRD ×× ' goal on your' ×× FLD1;
         ELSE
         W='My ball, ' ×× DNWRD ×× FLD2 ×× ' on your' ×× FLD1;
      CALL HTPUT(W);
      RETURN;  END;
   FLD1 = YARDON;
   W='My ball, ' ×× DNWRD ×× FLD2 ×× ' on my' ×× FLD1;
   IF YARDON = 50 THEN
      W='My ball, ' ×× DNWRD ×× FLD2 ×× ' at mid-field.';
    CALL HTPUT(W);
   RETURN;  END;
0END; /* END OF PROC */
-FLDGOAL: PROC;
0IF YARDON < 41 THEN DO;
    U_K1CK = U_K1CK + 1;
    U_K_YD = U_K_YD - 4;
    BALLOWNER = 1;
 BLOK:
   W = 'Field goal attempt blocked'; CALL HTPUT(W);
   DOWN = 1;
   YARDTOGO = 10;
   YARDON = YARDON - 4;
   YARDON = 100 - YARDON;
   CALL YARDMRK;
   RETURN;  END;
0  CALL RAND(CRUNCH,NUMBER);
   IF NUMBER < .039999 THEN DO;
      IF BALLOWNER = 1 THEN DO; I_K1CK = I_K1CK + 1;
                                I_K_YD = I_K_YD - 4;
                                BALLOWNER = 0;  END;
                       ELSE DO; U_K1CK = U_K1CK + 1;
                                U_K_YD = U_K_YD - 4;
                                BALLOWNER = 1;  END;
                       GOTO BLOK;     END;
   IF YARDON > 89 & NUMBER > .099999 THEN GOTO MADEIT;
   IF YARDON > 79 & NUMBER > .199999 THEN GOTO MADEIT;
   IF YARDON > 69 & NUMBER > .299999 THEN GOTO MADEIT;
   IF YARDON > 59 & NUMBER > .399999 THEN GOTO MADEIT;
   IF YARDON > 49 & NUMBER > .674999 THEN GOTO MADEIT;
   IF YARDON > 39 & NUMBER > .874999 THEN GOTO MADEIT;
   IF YARDON < 59 THEN W = 'Field goal try is short';
                  ELSE W = 'Field goal try is wide'; CALL HTPUT(W);
   W = 'Ball turned over on the 20.'; CALL HTPUT(W);
   IF BALLOWNER = 1 THEN I_K_YD = I_K_YD + (80 - YARDON);
                    ELSE U_K_YD = U_K_YD + (80 - YARDON);
   YARDON = 20;
   DOWN = 1;
   YARDTOGO = 10;
   CALL TIMERTN;
   GOTO SWITCH;
 MADEIT:
    W = 'Kick is good'; CALL HTPUT(W);
    IF BALLOWNER = 1 THEN MYSCORE = MYSCORE + 3;
                     ELSE THIERSCORE = THIERSCORE + 3;
    CALL TIMERTN;
    DOWN = 5;
 SWITCH:
    IF BALLOWNER = 1 THEN BALLOWNER = 0;
                     ELSE BALLOWNER = 1;
    W = 'Score: YOU ' ×× THIERSCORE ×× '   ME ' ×× MYSCORE;
    CALL HTPUT(W);
    RETURN;
 END;  /* END OF PROC. */

-COMPAT: PROC;
0IF MYPLAY < 14 × PLAYCALL < 14 THEN DO;
 CALL RAND(CRUNCH,NUMBER);
     GAINLSS = NUMBER * 10;
     IF GAINLSS = 0 THEN CALL NOGAIN;
                     ELSE CALL LOSS;
     RETURN;  END;
0IF MYPLAY = 22 × PLAYCALL = 22 THEN CALL SACK;
 ELSE IF MYPLAY = 23 × PLAYCALL = 23 THEN CALL INTRCPT;
 ELSE IF MYPLAY = 25 × PLAYCALL = 25 THEN CALL INTRCPT;
 RETURN;
0END;  /* END OF PROC. */
0INCOMP: PROC;
 IF MYPLAY=15 × PLAYCALL=15 THEN CALL BIGPASS;
                            ELSE CALL BIGRUN;
 RETURN;
 END;  /* END OF PROC */
1YARDAGE: PROC;
0LOSS:ENTRY;
 DOWN = DOWN + 1;
 FLD2 = GAINLSS;
 IF GAINLSS >= YARDON THEN DO;
     W='Ballcarrier fighting off the middle guard in the endzone. . .';
     CALL HTPUT(W);
     IF PLAYCALL < 14 THEN U_R_YD = U_R_YD - YARDON;
     IF  MYPLAY  < 14 THEN I_R_YD = I_R_YD - YARDON;
     GOTO SAFETY;  END;
   call rand(crunch,number) ;
   if number > .7 then W ='Linebackers close the hole';
   if number > .4 & number < .701 then w = 'Tackle shoots the gap';
   if number > .2 & number < .401 then w ='Gang tackle';
   if number < .201 then W ='Offensive line breaks down';
   if number < .1 then w = 'Signal mix-up';
   CALL HTPUT(W);
   W='Ballcarrier loses' ×× FLD2;
   CALL HTPUT(W);
   YARDON = YARDON - (GAINLSS * 2);
   YARDTOGO = YARDTOGO + (GAINLSS * 2);
   IF PLAYCALL < 14 THEN U_R_YD = U_R_YD - GAINLSS;
   IF  MYPLAY  < 14 THEN I_R_YD = I_R_YD - GAINLSS;
   GOTO STATISTICS;
0NOGAIN:ENTRY;
   DOWN = DOWN + 1;
   W = 'Stopped cold, no gain'; CALL HTPUT(W);
   GOTO STATISTICS;
0SACK:ENTRY;
   DOWN = DOWN + 1;
   CALL RAND(CRUNCH,NUMBER);
   GAINLSS = NUMBER * 10;
   IF GAINLSS = 0 THEN DO;
     W = 'Quarterback dropped for no gain'; CALL HTPUT(W);
     GOTO STATISTICS;  END;
 SAFETY:
 IF GAINLSS >= YARDON THEN DO;
 IF PLAYCALL = 14 × PLAYCALL = 15 THEN DO;
   W='Quarterback trapped in endzone...'; CALL HTPUT(W);
   U_P_YD = U_P_YD - YARDON;  END;
 IF MYPLAY   = 14 × MYPLAY = 15 THEN DO;
   W='Quarterback trapped in endzone...'; CALL HTPUT(W);
   I_P_YD = I_P_YD - YARDON;  END;
 W = 'SCRAMBLING.....'; CALL HTPUT(W);
 W = '* * S a f e t y * *'; CALL HTPUT(W);
 IF BALLOWNER = 0 THEN DO;
 W = 'Great defensive work!!!'; CALL HTPUT(W);
 MYSCORE = MYSCORE + 2;
 BALLOWNER = 1;  END;
 ELSE DO;
 W = 'Dammit !@*/#'; CALL HTPUT(W);
 THIERSCORE = THIERSCORE + 2;
 BALLOWNER = 0;  END;
 W = 'Score: YOU ' ×× THIERSCORE ×× ' ME ' ×× MYSCORE;
    CALL HTPUT(W);
    CALL TIMERTN;
 CALL KICKOFF;
 RETURN;
 END; /* END OF SAFETY ROUTINE */
    FLD2 = GAINLSS;
 W = 'Quarterback dumpped for a loss of' ×× FLD2;
    CALL HTPUT(W);
 YARDTOGO = YARDTOGO + (GAINLSS * 2);
 YARDON = YARDON - (GAINLSS * 2);
 IF PLAYCALL < 14 THEN U_R_YD = U_R_YD - GAINLSS;
 IF  MYPLAY  < 14 THEN I_R_YD = I_R_YD - GAINLSS;
 IF PLAYCALL = 14 × PLAYCALL = 15 THEN U_P_YD=U_P_YD-GAINLSS;
 IF  MYPLAY  = 14 ×  MYPLAY  = 15 THEN I_P_YD=I_P_YD-GAINLSS;
 GOTO STATISTICS;
0INTRCPT:ENTRY;
 CALL RAND(CRUNCH,NUMBER);
 IF NUMBER > .289999 THEN GOTO COMPLETEPASS;
 GAINLSS = (NUMBER * 10) * 9;
 IF YARDON + GAINLSS > 99 THEN DO;
 W = '***Interception in endzone***'; CALL HTPUT(W);
 W = '*--Touchback--*'; CALL HTPUT(W);
 DOWN = 1;
 YARDTOGO = 10;
 YARDON = 20;
 IF BALLOWNER = 1 THEN DO; BALLOWNER =0;
                           I_INTR = I_INTR + 1; END;
                  ELSE DO; BALLOWNER = 1;
                           U_INTR = U_INTR + 1; END;
 GOTO STATISTICS;  END;
 ELSE DO;
 W = '***Interception***'; CALL HTPUT(W);
 DOWN = 1;
 YARDTOGO = 10;
 YARDON = 100 - (YARDON + GAINLSS);
 IF BALLOWNER = 1 THEN DO; BALLOWNER = 0;
                           I_INTR = I_INTR + 1; END;
                  ELSE DO; BALLOWNER = 1;
                           U_INTR = U_INTR + 1; END;
 GOTO STATISTICS;  END;
0BIGPASS:ENTRY;
 COMPLETEPASS:
 CALL RAND(CRUNCH,NUMBER);
 IF NUMBER < .510000 THEN GAINLSS = 0;
           ELSE GAINLSS = (NUMBER * 10) * 3;
 PASSNOGOOD:
  IF MYPLAY = 25 × PLAYCALL = 25 THEN GAINLSS = GAINLSS - 10;
     IF  GAINLSS < 1 THEN GAINLSS = GAINLSS * -1 ;
         IF NUMBER > .9500 THEN DO ;
            W = ' Pass Inteference ' ;
            GAINLSS = 15 ;
            CALL HTPUT(W) ;
         END;
 IF GAINLSS = 0 THEN DO;
 IF MYPLAY = 23 × PLAYCALL = 23 THEN DO;
 W='Receiver double teamed . . . pass batted down.';
    CALL HTPUT(W);  END;
 ELSE DO;
 IF NUMBER<.084999 THEN
 W='Receiver fell down....Pass incomplete.';
 ELSE IF NUMBER<.169999 THEN
 W = 'Pass completed out-of-bounds. Ruled incomplete!';
 ELSE IF NUMBER<.254999 THEN
 W='Reciever runs wrong pattern .... pass is incomplete.';
 ELSE IF NUMBER<.339999 THEN
 W='All-pro cornerback spits in receiver''s eye. Pass incomplete.';
 ELSE IF NUMBER<.419999 THEN
 W='Defenders use bump and run on the ends. Pass incomplete.';
 ELSE IF NUMBER<.509999 THEN
 W='LINEMAN CRASHES THROUGH TO BLOCK PASS';
 ELSE W = 'Pass drops incomplete.'; CALL HTPUT(W);  END;
 DOWN = DOWN + 1;
 GOTO STATISTICS;  END;
 ELSE DO;
 IF (YARDON+GAINLSS) > 110 THEN DO;
 W = 'Pass completed out of endzone. Ruled incomplete!';
    CALL HTPUT(W);
 GAINLSS=0;
 DOWN=DOWN+1;
 GOTO STATISTICS;  END;
 IF GAINLSS + YARDON > 99 THEN GOTO TOUCHDOWN;
 IF PLAYCALL = 15 × PLAYCALL = 14 THEN DO; U_P_OK = U_P_OK + 1;
                              U_P_YD = U_P_YD + GAINLSS;  END;
 IF MYPLAY   = 15 × MYPLAY   = 14 THEN DO; I_P_OK = I_P_OK + 1;
                              I_P_YD = I_P_YD + GAINLSS;  END;
    FLD2 = GAINLSS;
 W = 'Pass completed for' ×× FLD2 ×× ' yards.';
    CALL HTPUT(W);
 IF GAINLSS >  YARDTOGO THEN DO;
     IF DOWN = 3 THEN DO;
        IF BALLOWNER = 0 THEN U_THRD = U_THRD + 1;
                         ELSE I_THRD = I_THRD + 1;
        END;
     DOWN = 1;
     YARDTOGO = 10;
     YARDON = YARDON + GAINLSS;
     GOTO STATISTICS;  END;
 DOWN = DOWN + 1;
 GOTO STATISTICS;  END;
0BIGRUN:ENTRY;
 CALL RAND(CRUNCH,NUMBER);
 IF NUMBER < .060000 THEN DO;
 IF MYPLAY =14 × PLAYCALL = 14 THEN DO;
 W = 'Mix-up as quarterback drops back into pocket...';
    CALL HTPUT(W);  END;
   W = 'F u m b l e'; CALL HTPUT(W);
   GAINLSS = ((NUMBER * 100) - 4.0);
   I = YARDON + GAINLSS;
   IF I > 50 THEN I = 100 - I;
   FLD1 = I;
   W = 'Ball is loose on the ' ×× fld1 ;
   CALL HTPUT(W);
   W = 'Players unpile. . . . .'; CALL HTPUT(W);
   IF BALLOWNER = 1 THEN DO; I_F_YD = I_F_YD + GAINLSS;
                             I_F_NO = I_F_NO + 1;  END;
                    ELSE DO; U_F_YD = U_F_YD + GAINLSS;
                             U_F_NO = U_F_NO + 1;  END;
   CALL RAND(CRUNCH,NUMBER);
   IF NUMBER < .45 THEN DO;
      W = 'Defense recovers'; CALL HTPUT(W);
      DOWN = 1;
      YARDTOGO = 10;
      YARDON = 100 - (YARDON + GAINLSS);
      IF BALLOWNER = 1 THEN DO; I_LOST = I_LOST + 1;
                                BALLOWNER = 0;  END;
                       ELSE DO; U_LOST = U_LOST + 1;
                                BALLOWNER = 1;  END;
      GOTO PRNTSTAT;  END;
   W = 'Offense keeps possession'; CALL HTPUT(W);
   DOWN = DOWN + 1;
   GOTO STATISTICS;  END;
 IF NUMBER >.749999 THEN
 GAINLSS =(NUMBER * 10) * 3;
 ELSE GAINLSS = NUMBER * 10;
 IF GAINLSS = 0 THEN DO;
 IF PLAYCALL =14 × MYPLAY = 14 THEN GOTO PASSNOGOOD;
 W = 'No gain'; CALL HTPUT(W);
 DOWN = DOWN + 1;
 GOTO STATISTICS;  END;
 ELSE DO;
 IF GAINLSS + YARDON > 99 THEN GOTO TOUCHDOWN;
 FLD2 = GAINLSS;
 IF PLAYCALL = 14 × MYPLAY = 14 THEN
     W='Pass completed for' ×× FLD2 ×× ' yards.';
 ELSE  W = 'Gain of' ×× FLD2 ×× ' yards.';
    CALL HTPUT(W);
 IF PLAYCALL = 14 THEN DO; U_P_OK = U_P_OK + 1;
              U_P_YD = U_P_YD + GAINLSS;  END;
 IF MYPLAY   = 14 THEN DO; I_P_OK = I_P_OK + 1;
              I_P_YD = I_P_YD + GAINLSS;  END;
 IF PLAYCALL < 14 THEN U_R_YD = U_R_YD + GAINLSS;
 IF  MYPLAY  < 14 THEN I_R_YD = I_R_YD + GAINLSS;
 IF GAINLSS >  YARDTOGO THEN DO;
    IF DOWN = 3 THEN DO;
       IF BALLOWNER = 0 THEN U_THRD = U_THRD + 1;
                        ELSE I_THRD = I_THRD + 1;
       END;
    DOWN = 1;
    YARDTOGO = 10;
    YARDON = YARDON + GAINLSS;
    GOTO STATISTICS;  END;
 DOWN = DOWN + 1;
 GOTO STATISTICS;  END;
0TOUCHDOWN:
   IF DOWN = 3 THEN DO;
      IF BALLOWNER = 1 THEN I_THRD = I_THRD + 1;
                       ELSE U_THRD = U_THRD + 1;
      END;
   IF MYPLAY = 14 × MYPLAY = 15 THEN DO;
    W='Flanker fakes out your free safety.';
    CALL HTPUT(W);
    I_P_OK = I_P_OK + 1;
    I_P_YD = I_P_YD + GAINLSS;
    END;
   IF PLAYCALL = 14 × PLAYCALL = 15 THEN DO;
    IF NUMBER < .599999 THEN
       W='Defense caught overshifted, split end wide open.';
       ELSE W='Tight end spots hole in zone defense.';
    CALL HTPUT(W);
    U_P_OK = U_P_OK + 1;
    U_P_YD = U_P_YD + GAINLSS;
    END;
   IF MYPLAY  < 14 THEN DO;
     I_R_YD = I_R_YD + GAINLSS;
     IF NUMBER < .630000 THEN W='Tailback follows blockers in.';
                         ELSE W='Slick halfback reverses field and . .';
     CALL HTPUT(W);
     END;
   IF PLAYCALL < 14 THEN DO;
    U_R_YD = U_R_YD + GAINLSS;
    IF NUMBER < .599999 THEN W='Fullback smashes thru big hole.';
                        ELSE W='Quarterback flips out on the play.';
    CALL HTPUT(W);
    END;
   W = '* * T o u c h d o w n * *'; CALL HTPUT(W);
   CALL EXTRAPT;
   CALL KICKOFF;
   RETURN;
0STATISTICS:
 IF DOWN = 1 THEN GOTO PRNTSTAT;
 IF GAINLSS >  YARDTOGO THEN DO;
 GOOD:
 DOWN = 1;
 YARDTOGO = 10;
 YARDON = YARDON + GAINLSS;
 GOTO PRNTSTAT;  END;
 IF GAINLSS=YARDTOGO THEN DO;
   W = 'M e a s u r e m e n t'; CALL HTPUT(W);
    W = 'Call for the chains'; CALL HTPUT(W);
   CALL RAND(CRUNCH,NUMBER);
   IF NUMBER>.500000 THEN DO;
      W = '×_ _ _ _ _ _ _ _ _ _ ×*'; CALL HTPUT(W);
      W = ' F i r s t   D o w n'; CALL HTPUT(W);
      GOTO GOOD;  END;
   ELSE DO;
      W = '×_ _ _ _ _ _ _ _ _ _*×'; CALL HTPUT(W);
      W = ' Short  by  inches'; CALL HTPUT(W);
   IF DOWN < 5 THEN DO;
     IF BALLOWNER = 0 THEN
          W='Hold that line, H e y !! Hold that line, H e y !!';
     ELSE W = 'CROWD ON ITS FEET CHEERING ! ' ;
     CALL HTPUT(W);
     END;
   END;
 END;
 YARDTOGO = YARDTOGO-GAINLSS;
 YARDON = YARDON + GAINLSS;
 IF DOWN = 5 THEN DO;
 W = 'Loss of ball on downs'; CALL HTPUT(W);
 DOWN = 1;
 YARDTOGO = 10;
 YARDON = 100 - YARDON;
 W = 'Score: YOU ' ×× THIERSCORE ×× '   ME ' ×× MYSCORE;
 CALL HTPUT(W);
 IF BALLOWNER = 1 THEN BALLOWNER = 0;
                  ELSE BALLOWNER = 1;
 GOTO PRNTSTAT;  END;
0PRNTSTAT:
   CALL YARDMRK;
   CALL TIMERTN;
   RETURN;
   END;  /* END OF PROC */
-HTPUT: PROC(S);
    DCL S CHAR(120) VAR;
    DCL TPUT ENTRY(CHAR(120) VAR, FIXED BIN(15));
   WR:  CALL TPUT(S, RTN);
    IF RTN = 8 THEN GOTO WR;
    IF RTN^= 0 THEN RETURN;
    RETURN;
   END HTPUT;
 FINIS:
 END; /* END OF PROGRAM */

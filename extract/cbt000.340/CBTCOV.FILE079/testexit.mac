//TESTEXIT    JOB   MSGLEVEL=1                                         C
//                     *                                               C
//          THIS PROCEDURE WILL ASSEMBLE      TESTEXIT AND COMBINE IT  C
//             WITH  EXIT ROUTINES FROM EXITLIB. THE RESULTANT LOAD    C
//             MODULE WILL BE PLACED IN TESTLIB AND CAN BE EXECUTED    C
//             VIA A JOBLIB.    THE INPUT CAN BE GENERATED BY IEBDG    C
//             THE REQUIRED JCL FOR EXECUTION CAN BE FOUND IN THE      C
//             SMF PLANNING GUIDE                                      C
//                     *
//TEST   EXEC   ASMFCL
//ASM.SYSIN   DD *
TESTEXIT CSECT
* 554500                                                         A33525
* 067500,567500                                                  A46754
* 322100,322200                                                  A46755
         ENTRY TSMFWTM
         ENTRY IEFYS
         EJECT
***********************************************************************
* MODULE NAME - TESTEXIT                                              *
* ALIASES - NONE                                                      *
* FUNCTION - TO PROVIDE AN ENVIORNMENT FOR TESTING USER-WRITTEN SMF   *
*            EXIT ROUTINES BEFORE THEY ARE LINKEDITED INTO THE        *
*            SCHEDULAR.                                               *
* ENTRY POINTS - 1. TESTEXIT - MAIN ENTRY POINT. ENTERED BY THE       *
*                              OPERATING SYSTEM WHEN TESTEXIT IS      *
*                              EXECUTED.                              *
*                2. SMFWTM - ENTRY FOR THE SECTION THAT WRITES TO     *
*                            MANX TO SIMULATE WRITING TO A SMF DATA   *
*                            SET. ALL EXIT ROUTINES MAY ACCESS THIS   *
*                            ENTRY.                                   *
*               3. IEFYS - ENTRY FOR THE SECTION THAT WRITES TO       *
*                              SYSPRINT FROM IEFACTRT.                *
* EXITS - THE ONLY EXIT IS A RETURN TO THE OPERATING SYSTEM.          *
* SUBROUTINES - 1. IEBDG - THE DATA GENERATOR IS ATTACHED ONCE FOR    *
*                          EACH EXIT ROUTINE TO BE TESTED.            *
*               2. IEFUJV                                             *
*               3. IEFUJI                                             *
*               4. IEFUSI                                             *
*               5. IEFUTL                                             *
*               6. IEFACTRT                                           *
*               7. IEFUSO                                             *
* ATTRIBUTES -  TESTEXIT IS SERIALLY REUSEABLE BUT NOT RE-ENTRANT     *
* CSECT NAME - TESTEXIT                                               *
* MACROS USED - GETMAIN,FREEMAIN,ATTACH,WAIT,DETACH,OPEN,CLOSE,GET,   *
*               PUT,WTO,DCB                                           *
* WORK AREAS -  A WORK AREA TO CONSTRUCT PARAMETER LISTS IS OBTAINED  *
*               FROM SUBPOOL 1. THE AMOUNT OF CORE MAY BE CHANGED BY  *
*               CHANGING THE VARIABLE CORE. THE WORK AREA MUST BE     *
*               LARGE ENOUGH TO CONTAIN THE LARGEST PARAMETER LIST    *
*               FOR ONE CALL TO AN EXIT ROUTINE.                      *
* REGISTER USEAGE - REGISTER 10 IS THE BASE REGISTER. ALL OTHERS ARE  *
*                   MULTI-PURPOSE.                                    *
* CALLING SEQUENCES - 1.TESTEXIT IS CALLED BY THE EXEC STATEMENT. A   *
*                       PARAMETER LIST CONTAINS THE ALIAS NAMES OF    *
*                       THE EXITS TO BE TESTED AND THE NUMBER OF      *
*                       CALLS TO MAKE TO EACH EXIT. FOR EXAMPLE -     *
*                         //STEP EXEC PGM=TESTEXIT,PARM='UJV=3,ACT=5' *
*                     2.SMFWTM IS CALLED TO WRITE A RECORD TO MANX.AS *
*                       FOLLOWS                                       *
*                             R1 CONTAINS THE MESSAGE ADDRESS         *
*                             R15 CONTAINS THE ADDRESSOF ENTRY SMFWTM *
*                             R14 CONTAINS THE RETURN ADDRESS         *
*                    3.IEFYS IS CALLED BY IEFACTRT IN THE SAME WAY    *
*                      THAT IS DESCRIBED IN THE SYSTEM PROGRAMMER'S   *
*                      GUIDE.                                         *
***********************************************************************
         SPACE 3
PARM     EQU   1
TOTAL    EQU   2
ACM      EQU   3
INDEX    EQU   4
FIELDREG EQU   5
CNT      EQU   6
CNT1     EQU   7
CNT2     EQU   8
BACK     EQU   9
TABLE    EQU   9
BASE     EQU   10
AREA     EQU   11
WORK     EQU   12
SAVEREG  EQU   13
RET      EQU   14
ENTRY    EQU   15
EQUAL    EQU   8
         EJECT
***********************************************************************
* SECTION FUNCTIONS - 1. SAVES REGISTERS                              *
*                     2. ESTABLISHES ADDRESSABILITY                   *
*                     3. PREPARES TO PROCESS PARAMETER LIST FROM THE  *
*                        EXEC STATEMENT.                              *
*                     4. OBTAINS A WORK AREA                          *
*                     5. INITIALIZES FIELDS                           *
* INPUT - R1 CONTAINS THE ADDRESS OF THE PARAMETER LIST FROM THE EXEC *
*         STATEMENT. REFER TO SUPERVISOR AND DATA MANAGEMENT SERVICES *
*         FOR A DESCRIPTION OF THE FORMAT OF THE PARAMETER LIST.      *
*         R15 CONTAINS THE ENTRY POINT ADDRESS                        *
*         R14 CONTAINS THE RETURN ADDRESS TO THE OPERATING SYSTEM     *
* OUTPUT - R2(TOTAL)  ADDRESS OF END OF EXEC PARAMETER LIST           *
*          R3(ACM)  ADDRESS OF BEGINNING OF EXEC PARAMETER LIST       *
*          R9(TABLE) ADDRESS OF 5 BYTE FIELD OF ZEROS, TABLE          *
*          R10(BASE) BASE REGISTER                                    *
*          R13(SAVEREG) ADDRESS OF SAVE, SAVE AREA IN TESTEXIT        *
*                                                                     *
*         R13  ADDRESS OF CALLER'S SAVE AREA                          *
*                                                                     *
* EXITS - 1. GETMAIN TO OBTAIN WORK AREA                              *
*         2. PARMPROS TO PROCESS PARAMETERS                           *
***********************************************************************
         SPACE 3
         BC    15,12(15)
         DC    CL8'TESTEXIT'
         STM   RET,12,12(SAVEREG)           SAVE REGISTERS
         LR    BASE,ENTRY
         USING TESTEXIT,BASE                ESTABLISH ADDRESSABILITY
         ST    SAVEREG,SAVE+4               CHAIN SAVE AREAS
         LR    CNT,SAVEREG
         LA    SAVEREG,SAVE
         ST    SAVEREG,8(CNT)
         L     PARM,0(PARM)                 ADDRESS OF COUNT FIELD
         LH    TOTAL,0(PARM)                CHARACATERS IN PARM FIELD
         LA    PARM,2(PARM)                 ADDRESS OF PARM FIELD
         AR    TOTAL,PARM                   END OF PARM LIST
         LR    ACM,PARM
         L     0,AMTMAIN                    GET SUBPOOL AND CORE
         GETMAIN R,LV=(0)
         ST    PARM,MAIN                    ADDRESS OF STORAGE AREA
         SR    INDEX,INDEX                  MAKE SERIALLY REUSEABLE
         ST    INDEX,USERCOMM               INITIALIZE USER COMM FIELD
         STH   INDEX,RECORDS
         STC   INDEX,FIELD+3                ZERO BIT FIELDS
         STC   INDEX,FIELD+7
         STC   INDEX,FIELD+11
         STC   INDEX,FIELD+15
         STC   INDEX,FIELD+19
         LA    INDEX,X'40'                  BLANK OUT FIELD
         STC   INDEX,USERID
         MVC   USERID+1(7),USERID
         MVC   NUMBERS(6),DDNAMES+2         ZERO FIELD           A46754
         LA    TABLE,NUMBERS
         EJECT
***********************************************************************
* SECTION FUNCTIONS - 1. PROCESS THE EXEC PARAMETER LIST              *
*                        THE FIRST 3 LETTERS BETWEEN COMMAS ARE       *
*                        COMPARED TO THE FIRST 3 BYTES OF EACH WORD   *
*                        IN FIELD. IF A MATCH IS FOUND, THE CHAR-     *
*                        ACTERS AFTER THE EQUAL SIGN AND BEFORE THE   *
*                        NEXT COMMA ARE CONVERTED TO BINARY AND PUT   *
*                        INTO NUMBERS. ALSO, THE BYTE AFTER THE NAME  *
*                        OF THE EXIT IN FIELDS IS SET TO X'01' TO     *
*                        INDICATE THAT THE EXIT IS TO BE CALLED. IF   *
*                        NO MATCH IS FOUND OR IF THE NUMBER OF CALLS  *
*                        IS GT 255, AN ERROR MESSAGE IS WRITTEN, AND  *
*                        TESTEXIT RETURNS CONTROL TO THE OPERATING    *
*                        SYSTEM.                                      *
* ENTRIES - FROM THE FIRST SECTION                                    *
* EXITS - 1. DATAGEN TO GENERATE PARAMETER LISTS FOR REQUESTED EXITS  *
*         2. PARMERR TO WRITE AN ERROR MESSAGE TO SYSPRINT AND RETURN *
*            TO THE SYSTEM.                                           *
* INPUT - R2(TOTAL) - ADDRESS OF END OF THE EXEC PARAMETER LIST       *
*         R3(ACM) - ADDRESS OF BEGINNING OF EXEC PARAMETER LIST       *
*         R9(TABLE) - ADDRESS OF NUMBERS                              *
* TABLES - 1. NUMBERS - 6 BYTES, INDICATES THE NUMBER OF CALLS TO THE *
*                       EXIT ROUTINES, INITIALIZED WITH ZEROS:        *
*                       BYTE 0 - NUMBER OF CALLS TO IEFUJV(UJV)       *
*                       BYTE 1 - NUMBER OF CALLS TO IEFUJI(UJI)       *
*                       BYTE 2 - NUMBER OF CALLS TO IEFUSI(USI)       *
*                       BYTE 3 - NUMBER OF CALLS TO IEFUTL(UTL)       *
*                       BYTE 4 - NUMBER OF CALLS TO IEFACTRT(ACT)     *
*                       BYTE 5 - NUMBER OF CALLS TO IEFUSO(USO)       *
*          2. FIELD - 5 WORD AREA  THE FIRST 3 BYTES OF EACH WORD     *
*                     CONTAIN THE NAME OF THE EXIT. THE 4TH BYTE IS   *
*                     AN INDICATOR OF WHETHER OR NOT TO CALL THE EXIT *
*                     FIELD MUST BE ON A FULL-WORD BOUNDRY AND IN THE *
*                     FOLLOWING ORDER                                 *
*                       WORD 0 - CL3'UJV',BL1'0'   IEFUJV             *
*                       WORD 1 - CL3'UJI',BL1'0'   IEFUJI             *
*                       WORD 2 - CL3'USI',BL1'0'   IEFUSI             *
*                       WORD 3 - CL3'UTL',BL1'0'   IEFUTL             *
*                       WORD 4 - CL3'ACT',BL1'0'   IEFACTRT           *
*                       WORD 5 - CL3'USO',BL1'0'   IEFUSO             *
* REGISTER USEAGE - R2(TOTAL) - ADDRESS OF END OF PARAMETER LIST      *
*                   R3(ACM) - ADDRESS OF NEXT PARAMETER CHARACTER     *
*                   R4(INDEX) - COUNT OF COMPARASIONS MADE TO FIELD   *
*                               AND INDEX INTO NUMBERS                *
*                   R5(FIELDREG) - ADDRESS OF NEXT CHARACTERS TO      *
*                                  COMPARE IN FIELD OR ADDRESS OF 4TH *
*                                  BYTE INDICATOR IN FIELD            *
*                   R6 - NOT USED                                     *
*                   R7(CNT1) - COUNT OF DIGITS IN CALL NUMBER AND     *
*                              NUMBER OF CHARACTERS LEFT TO PROCESS   *
*                   R8(CNT2) - ADDRESS OF BEGINNING OF NUMBER FOR     *
*                              CALLS                                  *
*                   R9(TABLE) - ADDRESS OF NUMBERS                    *
*                   R10(BASE) - BASE REGISTER                         *
*                   R11 - NOT USED                                    *
*                   R12(WORK) - NUMBER OF CHARACTERS LEFT TO PROCESS  *
*                   R13(SAVEREG) - ADDRESS OF SAVE                    *
*                   R14(RET) - USED TO BAL WITHIN THIS SECTION        *
*                   R15 - NOT USED                                    *
* OUTPUT - 1. NUMBERS CONTAINS THE NUMBER OF CALLS TO EACH EXIT       *
*          2. FIELD CONTAINS A X'01' IN THE BYTE FOLLOWING THE EXIT   *
*             CALL LETTERS IF THE EXIT IS TO BE CALLED                *
***********************************************************************
         SPACE 3
PARMPROS EQU   *                            PROCESS PARAMETERS HERE
SETUP    SR    INDEX,INDEX
         BAL   RET,TESTEND                  TEST FOR END OF FIELD
         LA    FIELDREG,FIELD               ADDRESS OF TABLE
COMPARE  CLC   0(3,ACM),0(FIELDREG)         COMPARE PARAMETERS
         BC    EQUAL,MATCH
         LA    INDEX,1(INDEX)               GET NEXT ENTRY
         LA    FIELDREG,4(FIELDREG)         GET NEXT ENTRY
         CH    INDEX,CON6
         BC    EQUAL,PARMERR                SEARCHED ALL - NO MATCH
         B     COMPARE                      CONTINUE SEARCH
MATCH    EQU   *
         LA    FIELDREG,3(FIELDREG)         ADDRESS OF BIT INDICATOR
         XI    0(FIELDREG),1                TURN ON BIT
         LA    ACM,3(ACM)                   INCREMENT POINTER
LOOP     BAL   RET,TESTEND
         CLC   0(1,ACM),COMMA               TEST FOR ','
         BNE   COMPAREQ
         LA    ACM,1(ACM)                   FOUND COMMA
         B     SETUP                        GET NEXT PARAMETER
COMPAREQ EQU   *
         CLC   0(1,ACM),EQSIGN              TEST FOR '='
         BNE   PARMERR
         LA    ACM,1(ACM)
NUMBER   LR    CNT1,TOTAL
         SR    CNT1,ACM
         CH    CNT1,CON3                    TEST FOL LE 3 CHARACTERS
         BH    BEGINEND                     COUNT DIGITS
         AR    ACM,CNT1                     ACM POINTS PAST DIGITS
         B     CONVERT
BEGINEND EQU   *
         SR    CNT1,CNT1                    COUNT OF DIGITS
FINDEND  EQU   *
         CLC   0(1,ACM),COMMA               TEST FOR ','
         BE    CONVERT                      FOUND END OF NUMBER
         LA    CNT1,1(CNT1)                 INCREMENT COUNT
         LA    ACM,1(ACM)
         CH    CNT1,CON3                    MAXIMUM NUMBER OF DIGITS
         BNH   FINDEND                      OK KEEP LOOKING
         B     PARMERR
TESTEND  EQU   *
         LR    WORK,TOTAL                   KEEP TOTAL INTACT
         SR    WORK,ACM                     NUMBER BYTES LEFT
         CH    WORK,CON1
         BE    PARMERR                      CANNOT HAVE ONLY 1 CHAR
         BL    DATAGEN                      END OF PARAMETER LIST
         BR    RET
CONVERT  LR    CNT2,ACM
         SR    CNT2,CNT1                    GET POINTER TO BEGINNING OF
         BCTR  CNT1,0                         NUMBER
         EX    CNT1,PACKER                  CONVERT TO PACKED DECIMAL
         CVB   CNT1,WORKAREA                CONVERT OT BINARY
         CH    CNT1,CON256                  TEST FOR ONE BYTE NUMBER
         BNL   PARMERR
         STC   CNT1,0(INDEX,TABLE)          STORE NUMBER
         LA    ACM,1(ACM)                   INCREMENT PAST COMMA
         B     SETUP                        GET NEXT PARAMETER
         SPACE 3
PARMERR  EQU   *
         LA    CNT2,APARMMSG                ADDRESS OF MESSAGE PARMS
         BAL   BACK,WRITEMSG
         B     ENDUP
         EJECT
***********************************************************************
* SECTION FUNCTIONS - 1. ATTACH THE DATA GENERATOR FOR EACH EXIT      *
*                        THE DG IS USED TO CREATE THE PARAMETER LISTS *
*                        FOR THE EXITS. THE BYTE AFTER THE EXIT NAME  *
*                        IN FIELD IS TESTED FOR '01'. IF IT IS X'01', *
*                        THE 3 LETTER EXIT NAME IS MOVED INTO DDNAMES *
*                        (THE PARAMETER LIST TO DG), AND THE DG IS    *
*                        ATTACHED. TESTEXIT WAITS UNTIL THE DG POSTS  *
*                        ITS ECB THAT IT IS FINISHED. IF A NON-ZERO   *
*                        CODE IS RETURNED, AND ERROR MESSAGE IS       *
*                        WRITTEN AND THE EXIT IS NOT CALLED.          *
*                        OTHERWISE, THE OUTPUT DATA SET FROM THE DG   *
*                        IS OPENED FOR INPUT IN ORDER TO READ THE     *
*                        PARAMETER LISTS INTO TESTEXIT WORK AREA. IF  *
*                        THE DATA SET DOES NOT OPEN CORRECTLY, AN     *
*                        ERROR MESSAGE IS WRITTEN AND THE EXIT IS NOT *
*                        CALLED. THE ADDRESS OF THE OPEN DCB IS PUT   *
*                        INTO OPENADDR. THE DCB IS TEST FOR FIXED OR  *
*                        VARIABLE RECORD FORMAT. IF THE RECFM IS      *
*                        FIXED, SWITCH IS SET TO X'01' AND THE LOGICAL*
*                        RECORD LENGTH IS SAVED IN FLRECL. A BLANK    *
*                        LINE AND THE EXIT NAME ARE WRITTEN TO        *
*                        SYSPRINT. THIS SECTION THEN BAL'S TO THE     *
*                        SECTION TO CALL THE EXIT ROUTINE. UPON       *
*                        RETURN, THE DCB IS CLOSED AND THE NEXT EXIT  *
*                        NAME IS TESTED. AFTE ALL EXITS HAVE BEEN     *
*                        TESTED FOR THE CALL INDICATOR, THIS SECTION  *
*                        BRANCHES TO ENDUP TO RETURN TO THE SYSTEM.   *
* ENTRIES - INITIALLY FROM PARMPROS - PARAMETER PROCESSING            *
* EXITS  - FINALLY TO ENDUP TO RETURN TO THE SYSTEM                   *
* SUBROUTINES - 1. DATA GENERATOR-IEBDG  TO GENERATE PARAMETER LIST   *
*                  FOR EACH EXIT TO BE CALLED                         *
*               2. WAIT ROUTINES TO WAIT FOR DG TO COMPLETE           *
*               3. DETACH TO DETACH DG AFTER EACH USE                 *
*               4. OPEN TO OPEN OUTPUT DATA SETS FROM DG FOR INPUT TO *
*                  TESTEXIT.                                          *
*               5. WRITEMSG TO WRITE BLANK LINE                       *
*               6. MAKEMSG TO WRITE EXIT 3 LETTER NAME                *
*               7. CALL EXIT SECTIONS TO CALL THE USER EXIT ROUTINES. *
*               8. CLOSE TO CLOSE THE OUTPUT DATA SET FROM THE DG.    *
*               9. DGERROR TO WRITE ERROR MESSAGE FOR DG ERROR,       *
*               10. OPENERROR TO WRITE ERROR MESSAGE IF DATA SET DOES *
*                   NOT OPEN CORRECTLY.                               *
* INPUT - 1. NUMBERS CONTAINS THE NUMBER OF CALLS TO EACH EXIT        *
*         2. FIELD CONTAINS A X'01' IN THE BYTE FOLLOWING THE EXIT    *
*            CALL LETTERS IF THE EXIT IS TO BE CALLED,                *
* TABLES - 1. FIELD - SEE PREVIOUS DESCRIPTION                        *
*          2. NUMBERS - SEE PREVIOUS DESCRIPTION                      *
*          3. DDNAMES - THE PARAMETER LIST FOR DG.  IT MUST BE ON A   *
*             MALF-WORD BOUNDRY. THE FIRST 2 BYTES CONTAIN THE LENGTH *
*             OF THE LIST EXCLODING THE FIRST 2 BYTES. THE DDNAME FOR *
*             SYSIN IS IN DDNAMES+34 AND FOR SYSPRINT IN DDNAMES+42.  *
*             THE DOUBLE WORDS FOLLOWING THE 2 BYTE LENGTH MUST BE ON *
*             DOUBLE-WORD BOUNDRIES. AS EACH EXIT IS SETUP, THE 3 CALL*
*             LETTERS ARE PLACED AFTER 'IN' SO THE DG WILL KNOW WHICH *
*             DATA SET TO USE AS SYSIN.                               *
*          4. ECBBLK - EVENT CONTROL BLOCK FOR THE DG. IT MUST BE ZERO*
*             BEFORE THE DG IS ATTACHED.  AFTER THE WAIT MACRO, IT    *
*             CONTAINS THE RETURN CODE FROM THE DG. THE SYSTEM ALSO   *
*             USES IT DURING THE DETACH.                              *
*          5. DCBADDR - CONTAINS THE ADDRESS OF THE DCB'S FOR THE     *
*             OUTPUT DATA SETS FROM THE DG. THE ADDRESSES MUST BE IN  *
*             THE ORDER THE EXITS ARE CALLED.                         *
*          6. RTNADDR - CONTAINS THE ADDRESS OF THE 'SUBROUTINES' THAT*
*             CALL THE EXITS. THESE ADDRESSES MUST BE IN THE ORDER    *
*             THE EXITS ARE CALLED.                                   *
*                   EXITS ARE CALVED IN THIS ORDER                    *
*                        1. IEFUJV(UJV)                               *
*                        2. IEFUJI(UJI)                               *
*                        3. IEFUSI(USI)                               *
*                        4. IEFUTL(UTL)                               *
*                        5. IEFACTRT(ACT)                             *
*                        6. IEFUSO(USO)                               *
* REGISTER USEAGE - R1 - USED BY MACROS FOR DARAMETE REGISTER         *
*                   R2 - NOT USED                                     *
*                   R3 - NOT USED                                     *
*                   R4(INDEX) - CONTAINS THE NUMBER OF TIMES AN EXIT  *
*                               IS TO BE CALLED. THIS REGISTER MUST   *
*                               NOT BE CHANGED EXCEPT BY THE SECTION  *
*                               THAT CALLS THE EXIT.                  *
*                   R5(FIELDREG) - ADDRESS OF FIELD                   *
*                   R6(CNT) - CONTAINS A COUNT OF THE NUMBER OF EXITS *
*                             THAT HAVE BEEN TESTED FOR CALLING. IT   *
*                             MUST NOT BE CHANGED BY ANY OTHER SECTION*
*                   R7(CNT1) - DURING THIS SECTION IT CONTAINS THE    *
*                              DISPLACEMENT OF THE EXIT NAME IN FIELD.*
*                              BEFORE GOING TO A CALLING SECTION, IT  *
*                              CONTAINS THE ADDRESS OF TESTEXIT'S WORK*
*                              AREA                                   *
*                   R8(CNT2) - WORK REGISTER                          *
*                   R9(TABLE AND BACK) - ADDRESS OF NUMBERS AND FIELD *
*                                        ALSO USED AS A RETURN ADDRESS*
*                                        REGISTER FOR BAL WITHIN      *
*                                        TESTEXIT                     *
*                   R10(BASE) - BASE REGISTER                         *
*                   R11 - NOT USED                                    *
*                   R12(WORK) - WORK REGISTER                         *
*                   R13(SAVEREG) - ADDRESS OF SAVE                    *
*                   R14 - USED BY MACROS                              *
*                   R15 - USED BY MACROS                              *
*                   R0 - USED BY MACROS                               *
* OUTPUT - 1. OPENADDR CONTAINS THE ADDRESS OF THE OPEN DCB FOR THE   *
*             EXIT CALLING SECTION TO USE.                            *
*          2. SWITCH CONTAINS A X'01' IF THE RECORD FORMAT FOR THE    *
*             OUTPUT DATA SET FROM DG IS FIXED. AND IN THIS CASE,     *
*             FLRECL CONTAINS THE LOGICAL RECORD LENGTH.              *
*          3. R7(CNT1) - CONTAINS THE ADDRESS OF TESTEXIT'S WORK AREA *
*                (THE ABOVE OUTPUT IS TO THE EXIT CALLING SECTIONS)   *
*                                                                     *
*                                                                     *
***********************************************************************
         SPACE 3
DATAGEN  EQU   *
         SR    CNT,CNT                      ZERO COUNT REGISTER
         LA    FIELDREG,FIELD               ADDRESS OF FIELDREG
FINDRTN  EQU   *
         TM    3(FIELDREG),1                TEST FOR ROUTINE
         BO    PUTNAMES                     FOUND - PUT IN LIST
CONTINUE EQU   *
         LA    FIELDREG,4(FIELDREG)         INCREMENT ADDRESS
         LA    CNT,1(CNT)
         CH    CNT,CON6                     TEST IF END OF LIST
         BNL   ENDUP                        YES - ALL DONE
         B     FINDRTN                      NO - CONTINUE
PUTNAMES LR    CNT1,CNT
         SR    INDEX,INDEX
         LA    TABLE,NUMBERS
         IC    INDEX,0(CNT1,TABLE)          NUMBER OF CALLS TO EXIT
         LTR   INDEX,INDEX                  TEST FOR ZERO CALLS
         BZ    CONTINUE                     DO NOT SET UP IF ZERO CALLS
         SLL   CNT1,2(0)                    MULTIPLY BY 4
         LA    TABLE,FIELD                  ADDRESS OF NAMES
         AR    TABLE,CNT1                   DISPLACEMENT FOR NAME
         MVC   DDNAMES+36(3),0(TABLE)       MOVE NAMES INTO PARMLIST
         SR    WORK,WORK
         ST    WORK,ECBBLK                  CLEAR ECB
         CLOSE (DCBPRINT,LEAVE)
         ATTACH  EP=IEBDG,PARAM=(OPTLIST,DDNAMES),VL=1,ECB=ECBBLK
         ST    PARM,TCBADDR                 SAVE TCB ADDRESS
         WAIT  ECB=ECBBLK                   WAIT FOR DATA GENERATOR
         CH    WORK,ECBBLK+2                TEST FOR 0 RETURN CODE
*                                           REMOVE COMMENT WHEN DG OK
*        BNE   DGERROR                      ERROR IF NOT 0
         DETACH  TCBADDR                    DETACH DATA GENERATOR
         LA    CNT2,DCBADDR
         L     CNT2,0(CNT1,CNT2)            ADDRESS OF CORRECT DCB
         ST    CNT2,OPENADDR
         LA    WORK,144                     OPTIONS FOR OPEN
         STC   WORK,OPENADDR                SET FOR INPUT,REREAD
         OPEN  ,MF=(E,OPENADDR)
         TM    48(CNT2),X'10'               TEST DCBOFLGS FOR OK OPEN
         BZ    OPENERRS
         NI    SWITCH,X'00'                 TURN OFF FIXED SWITCH
         TM    36(CNT2),X'80'               TEST DCBRECFM FOR FIXED
         BZ    AROUND
         LH    CNT2,82(CNT2)                GET DCBLRECL
         STH   CNT2,FLRECL                  SAVE FIXED LRECL
         OI    SWITCH,X'01'                 TURN ON FIXED SWITCH
AROUND   EQU   *
         LA    CNT2,ABLNKMSG                WRITE A BLANK LINE
         BAL   BACK,WRITEMSG
         LR    CNT2,CNT1                    DISPLACEMTNT FOR EXIT NAME
         BAL   BACK,MAKEMSG                 WRITE EXIT NAME
         LA    CNT2,RTNADDR                 GET ROUTINE TO FORM PARMS
         L     CNT2,0(CNT1,CNT2)            ADDRESS OF CORRECT RTN
         L     CNT1,MAIN
         BR    CNT2                         GO TO CORRECT RTN
CLOSEDCB EQU   *
         CLOSE ,MF=(E,OPENADDR)
         B     CONTINUE                     FIND NEXT EXIT RTN
         SPACE 3
DGERROR  EQU   *
         DETACH  TCBADDR                    DETACH DATA GENERATOR
OPENERRS EQU   *
         NI    3(FIELDREG),X'00'            TURN OFF CALL BIT
         MVC   DGMSG+41(3),0(FIELDREG)      FILL IN DATA SET DDNAME
         LR    CNT2,CNT1                    DISPLACEMTNT FOR EXIT NAME
         BAL   BACK,MAKEMSG                 WRITE EXIT NAME
         LA    CNT2,ADGMSG                  ADDRESS OF DG MESSAGE
         BAL   BACK,WRITEMSG                WRITE DG MSG
         B     CONTINUE                     GET NEXT EXIT ROUTINE
         EJECT
***********************************************************************
* SECTION FUNCTIONS - 1. THE CODING IN THIS SECTION CALLS THE EXIT    *
*                        ROUTINES                                     *
*                     2. RETURN CODES ARE TESTED AND MESSAGES ARE     *
*                        WRITTEN                                      *
*                     3. THE LOGIC FOR EACH PORTION (READUJV, READUJI,*
*                        READUSI, READUTL, READACT) IS SIMILAR. EACH  *
*                        SETS THE NUMBER OF PARAMETERS IN THE LIST    *
*                        FOR ITS EXIT ROUTINE AND BRANCHES TO GETREC  *
*                        TO HAVE THE PARAMETER LIST READ IN AND THE   *
*                        ADDRESSES SET UP. A SWITCH, NULLSW, IS SET   *
*                        TO X'01' IF THE PARAMETERS DID NOT FIT INTO  *
*                        TESTEXIT WORK AREA. IN THAT CASE THE CALL IS *
*                        BYPASSED. THE USER IDENTIFICATION AND USER   *
*                        COMMUNICATION FIELDS ARE RESTORED BEFORE     *
*                        EACH CALL AND SAVED AFTER EACH CALL.         *
* ENTRIES - FROM THE SECOND SECTION, DATAGEN                          *
* EXITS - 1. TO USERFLDS TO PRINT THE USER IDENTIFICATION AND USER    *
*             COMMUNICATION  FIELDS AT THE END OF EACH EXIT ROUTINE'S *
*              TESTING.                                               *
*            COMMUNICATION FIELDS AND TO RETURN TO CLOSEDCB IN DATAGEN*
* SUBROUTINES - 1. GETREC-TO READ AND FORMAT THE PARAMETER LISTS      *
*               2. EXIT ROUTINES                                      *
*               3. JCANCEL- TO WRITE JOB CANCELLED MESSAGE            *
*               4. WRITEMSG- TO WRITE MESSAGES TO SYSPRINT            *
* INPUT - 1. R7(CNT1) - CONTAINS THE ADDRESS OF TESTEXIT'S WORK AREA. *
* TABLES - 1. AMTMAIN - NUMBER OF BYTES IN TESTEXIT'S WORK AREA       *
*          2. NULLSW - A X'01' INDICATES THE CALL IS TO BE BYPASSED   *
*          3. USERID - LOCATION TO SAVE THE USER IDENTIFICATION FIELD *
*                      BETWEEN CALLS AND EXITS.                       *
*          4. USERCOMM - LOCATION TO SAVE THE USER COMMUNICATION FIELD*
*                        BETWEEN CALLS AND EXITS.                     *
*          5. ADDRESS - 11 WORK AREA WHERE THE ADDRESSES OF THE PARAM-*
*                       ETERS ARE STORED. THE ADDRESS OF ADDRESS IS   *
*                       PASSED TO THE EXIT ROUTINES IN REG 1.         *
* REGISTER USEAGE - R1(PARM)-ADDRESS OF PARAMETER LIST TO EXIT        *
*                            ROUTINES                                 *
*                   R2(TOTAL)- NUMBER OF BYTES IN TESTEXIT'S WORK     *
*                              AREA. SET UP FOR EACH BRANCH TO GETREC.*
*                   R3(ACM)- USED IN GETREC AND INITIALIZED TO 0      *
*                            BEFORE EACH BRANCH TO GETREC.            *
*                   R4(INDEX)- NUMBER OF TIMES THE EXIT IS TO BE      *
*                              CALLED. IT IS DECREMENTED AFTER EACH   *
*                              CALL AND IS 0 WHEN THE EXIT CALLS ARE  *
*                              COMPLETED. IT MUST NOT BE CHANGED BY   *
*                              CODING OUTSIDE THESE SECTIONS.         *
*                   R5(FIELDREG)- ADDRESS OF FIELD FROM DATAGEN. IT   *
*                                 MUST NOT BE ALTERED.                *
*                   R6(CNT)- NUMBER OF EXITS THAT HAVE BEEN TESTED    *
*                            FOR CALLING. IT MUST NOT BE ALTERED.     *
*                   R7(CNT1)- ADDRESS OF TESTEXIT'S WORK AREA. IT     *
*                             MUST NOT BE ALTERED.                    *
*                   R8(CNT2)- NUMBER OF PARAMETES THAT GETREC MUST    *
*                             SET UP FOR EACH EXIT ROUTINE. IF AN     *
*                             EXIT ROUTINE USES A SPECIAL CODE, THAT  *
*                             IS CONSIDERED AN EXTRA PARAMETER FOR    *
*                             GETREC ALTHOUGH THE CODE IS PROPERLY    *
*                             INSERTED INTO A REGISTER BEFORE CALLING *
*                             THE EXIT ROUTINE. ALSO ADDRESS OF       *
*                             MESSAGE LENGTH AND ADDRESS FOR WRITEMSG *
*                  R9(BACK)- USED TO BAL TO GETREC AND MESSAGE WRITING*
*                            SECTIONS.                                *
*                  R10(BASE)- BASE REGISTER                           *
*                  R11(AREA)- ADDRESS OF TESTEXIT'S WORK AREA. GETREC *
*                             CHANGES THIS REGISTER.                  *
*                  R12(WORK)- WORK REGISTER                           *
*                  R13(SAVEREG)- ADDRESS OF SAVE                      *
*                  R14(RET)- RETURN ADDRESS IN TESTEXIT FOR EXIT RTNS *
*                  R15(ENTRY)- ENTRY ADDRESS OF EXIT ROUTINES         *
* OUTPUT - 1. USER IDENTIFICATION AND COMMUNICATION FIELDS ARE SAVED  *
*             AND RESTORED.                                           *
*          2. JOB CANCEL AND/OR CONTINUE MESSAGES MAY BE WRITTEN TO   *
*             SYSPRINT.                                               *
*          3. MESSAGES TO SYSPRINT CONTAININD USER COMMUNICATION AND  *
***********************************************************************
         SPACE 3
READUJV  EQU   *
NEXTUJV  LA    CNT2,3                       NUMBER OF PARAMETERS
         LR    AREA,CNT1                    ADDRESS OF CORE
         SR    ACM,ACM                      CLEAR FOR USE IN GETREC
         L     TOTAL,AMTMAIN                AMOUNT OF CORE AVAILABLE
         LA    TOTAL,0(TOTAL)               REMOVE SUBPOOL NUMBER
         NI    NULLSW,X'00'                 TURN OFF NULL SWITCH
         BAL   BACK,GETREC                  SET UP PARAMETERS
         TM    NULLSW,X'01'                 TEST PROCESS SWITCH
         BO    ENDUJV                       DO NOT CALL EXIT
         MVC   20(8,CNT1),USERID            RESTORE USERID FIELD
         MVC   32(4,CNT1),USERCOMM          RESTORE USERCOMM FIELD
         LA    PARM,ADDRESS                 ADDRESS OF PARAMETER LIST
         L     ENTRY,ADDRUJV
         BALR  RET,ENTRY                    CALL EXIT ROUTINE
         CH    ENTRY,CON4                   CODE TO CANCEL JOB
         BNE   MOREUJV                      DO NOT CANCEL
         BAL   BACK,JCANCEL                 JOB CANCELLED MESSAGE
MOREUJV  EQU   *
         MVC   USERID(8),20(CNT1)           SAVE USERID FIELD
         MVC   USERCOMM(4),32(CNT1)         SAVE USERCOMM FIELD
ENDUJV   EQU   *
         SH    INDEX,CON1                   DECREMENT COUNT OF EXIT CLS
         BNZ   NEXTUJV                      SET UP TO CALL UJV AGAIN
         B     USERFLDS                     WRITE USER FIELDS
         SPACE 3
READUJI  EQU   *
NEXTUJI  LA    CNT2,4                       NUMBER OF PARAMETERS
         LR    AREA,CNT1                    ADDRESS OF CORE
         SR    ACM,ACM                      CLEAR FOR USE IN GETREC
         L     TOTAL,AMTMAIN                AMOUNT OF CORE AVAILABLE
         LA    TOTAL,0(TOTAL)               REMOVE SUBPOOL NUMBER
         NI    NULLSW,X'00'                 TURN OFF NULL SWITCH
         BAL   BACK,GETREC                  SET UP PARAMETERS
         TM    NULLSW,X'01'                 TEST PROCESS SWITCH
         BO    ENDUJI                       DO NOT CALL EXIT
         MVC   20(8,CNT1),USERID            RESTORE USERID FIELD
         MVC   32(4,CNT1),USERCOMM          RESTORE USERCOMM FIELD
         LA    PARM,ADDRESS                 ADDRESS OF PARAMETER LIST
         L     ENTRY,ADDRUJI
         BALR  RET,ENTRY                    CALL EXIT ROUTINE
         CH    ENTRY,CON4                   CODE TO CANCEL JOB
         BNE   MOREUJI                      DO NOT CANCEL
         BAL   BACK,JCANCEL                 JOB CANCELLED MESSAGE
MOREUJI  EQU   *
         MVC   USERID(8),20(CNT1)           SAVE USERID FIELD
         MVC   USERCOMM(4),32(CNT1)         SAVE USERCOMM FIELD
ENDUJI   EQU   *
         SH    INDEX,CON1                   DECREMENT COUNT OF EXIT CLS
         BNZ   NEXTUJI                      SET UP TO CALL UJI AGAIN
         B     USERFLDS                     WRITE USER FIELDS
         SPACE 3
READUSI  EQU   *
NEXTUSI  LA    CNT2,4                       NUMBER OF PARAMETERS
         LR    AREA,CNT1                    ADDRESS OF CORE
         SR    ACM,ACM                      CLEAR FOR USE IN GETREC
         L     TOTAL,AMTMAIN                AMOUNT OF CORE AVAILABLE
         LA    TOTAL,0(TOTAL)               REMOVE SUBPOOL NUMBER
         NI    NULLSW,X'00'                 TURN OFF NULL SWITCH
         BAL   BACK,GETREC                  SET UP PARAMETERS
         TM    NULLSW,X'01'                 TEST PROCESS SWITCH
         BO    ENDUSI                       DO NOT CALL EXIT
         MVC   20(8,CNT1),USERID            RESTORE USERID FIELD
         MVC   32(4,CNT1),USERCOMM          RESTORE USERCOMM FIELD
         LA    PARM,ADDRESS                 ADDRESS OF PARAMETER LIST
         L     ENTRY,ADDRUSI
         BALR  RET,ENTRY                    CALL EXIT ROUTINE
         CH    ENTRY,CON4                   CODE TO CANCEL JOB
         BNE   MOREUSI                      DO NOT CANCEL
         BAL   BACK,JCANCEL                 JOB CANCELLED MESSAGE
MOREUSI  EQU   *
         MVC   USERID(8),20(CNT1)           SAVE USERID FIELD
         MVC   USERCOMM(4),32(CNT1)         SAVE USERCOMM FIELD
ENDUSI   EQU   *
         SH    INDEX,CON1                   DECREMENT COUNT OF EXIT CLS
         BNZ   NEXTUSI                      SET UP TO CALL USI AGAIN
         B     USERFLDS                     WRITE USER FIELDS
         SPACE 3
READUTL  EQU   *
NEXTUTL  LA    CNT2,2                       NUMBER OF PARAMETERS
         LR    AREA,CNT1                    ADDRESS OF CORE
         SR    ACM,ACM                      CLEAR FOR USE IN GETREC
         L     TOTAL,AMTMAIN                AMOUNT OF CORE AVAILABLE
         LA    TOTAL,0(TOTAL)               REMOVE SUBPOOL NUMBER
         NI    NULLSW,X'00'                 TURN OFF NULL SWITCH
         BAL   BACK,GETREC                  SET UP PARAMETERS
         TM    NULLSW,X'01'                 TEST PROCESS SWITCH
         BO    ENDUTL                       DO NOT CALL EXIT
         MVC   20(8,CNT1),USERID            RESTORE USERID FIELD
         MVC   32(4,CNT1),USERCOMM          RESTORE USERCOMM FIELD
         SR    0,0
         L     WORK,ADDRESS+4               CLEAR FOR PARAMETER
         IC    0,0(WORK)                    CODE
         LA    PARM,ADDRESS                 ADDRESS OF PARAMETER LIST
         L     ENTRY,ADDRUTL
         BALR  RET,ENTRY                    CALL EXIT ROUTINE
         CH    ENTRY,CON4                   CODE TO CONTINUE JOB
         BNE   MOREUTL                      DO NOT CONTINUE
         L     WORK,ADDRESS                 ADDRESS OF JOB LOG NUMBER
         MVC   JOBCONT+4(8),0(WORK)         MOVE IN JOB NAME
         CVD   PARM,WORKAREA                CONVERT EXTRA TIMER UNI3S
         UNPK  JOBCONT+28(8),WORKAREA+3(5)
         OI    JOBCONT+35,X'F0'
         LA    CNT2,AJOBCONT                ADDRESS OF PARAMETERS
         BAL   BACK,WRITEMSG                WRITE CONTINUED MESSAGE
MOREUTL  EQU   *
         MVC   USERID(8),20(CNT1)           SAVE USERID FIELD
         MVC   USERCOMM(4),32(CNT1)         SAVE USERCOMM FIELD
ENDUTL   EQU   *
         SH    INDEX,CON1                   DECREMENT COUNT OF EXIT CLS
         BNZ   NEXTUTL                      SET UP TO CALL UTL AGAIN
         B     USERFLDS                     WRITE USER FIELDS
         SPACE 3
READACT  EQU   *
NEXTACT  LA    CNT2,11                      NUMBER OF PARAMETERS
         LR    AREA,CNT1                    ADDRESS OF CORE
         SR    ACM,ACM                      CLEAR FOR USE IN GETREC
         L     TOTAL,AMTMAIN                AMOUNT OF CORE AVAILABLE
         LA    TOTAL,0(TOTAL)               REMOVE SUBPOOL NUMBER
         NI    NULLSW,X'00'                 TURN OFF NULL SWITCH
         BAL   BACK,GETREC                  SET UP PARAMETERS
         TM    NULLSW,X'01'                 TEST PROCESS SWITCH
         BO    ENDACT                       DO NOT CALL EXIT
         MVC   20(8,CNT1),USERID            RESTORE USERID FIELD A46755
         MVC   32(4,CNT1),USERCOMM          RESTORE USERCOMM FLD A46755
         SR    0,0                          CLEAR FOR CODE
         L     WORK,ADDRESS+40              ADDRESS OF CODE
         CLI   0(WORK),12                   CODE FOR STEP TERMINATION
         BE    SETUPACT
         ST    0,ADDRESS+4                  ZERO POINTERS FOR JOB TERM
         ST    0,ADDRESS+20
         ST    0,ADDRESS+24
SETUPACT EQU   *
         IC    0,0(WORK)                    CODE
         LA    WORK,YSAREA                  AREA FOR WRITE TO SYSPRINT
         LA    PARM,ADDRESS                 ADDRESS OF PARAMETER LIST
         L     ENTRY,ADDRACT
         BALR  RET,ENTRY                    CALL EXIT ROUTINE
         STH   ENTRY,MARKER                 SAVE RETURN CODE
         CH    PARM,CON4                    CODE TO WRITE RECORD
         BE    COMEBACK                     DO NOT WRITE TERM RECORD
         L     PARM,ADDRESS+36              ADDRESS OF RECORD
         LA    ENTRY,SMFWTM                 USE SMFWTM
         BALR  RET,ENTRY
COMEBACK EQU   *                            MUST BE AFTER BALR
         L     WORK,ADDRESS+28              ADDRESS OF FLAGS
         TM    0(WORK),X'01'                TEST FOR '1' IN FLAGS BYTE
         BNZ   CANCELED                     JOB CANCELLED
         LH    ENTRY,MARKER                 RESTORE RETURN CODE
         CH    ENTRY,CON4                   CODE TO CANCEL JOB
         BNE   MOREACT                      DO NOT CANCEL
CANCELED EQU   *
         BAL   BACK,JCANCEL                 JOB CANCELLED MESSAGE
MOREACT  EQU   *
         MVC   USERID(8),20(CNT1)           SAVE USERID FIELD
         MVC   USERCOMM(4),32(CNT1)         SAVE USERCOMM FIELD
ENDACT   EQU   *
         SH    INDEX,CON1                   DECREMENT COUNT OF EXIT CLS
         BNZ   NEXTACT                      SET UP TO CALL ACT AGAIN
         B     USERFLDS                     WRITE USER FIELDS
         SPACE 3
READUSO  EQU   *
NEXTUSO  LA    CNT2,1                  NUMBER OF PARAMETERS
         LR    AREA,CNT1                    ADDRESS OF CORE
         SR    ACM,ACM                      CLEAR FOR USE IN GETREC
         L     TOTAL,AMTMAIN                AMOUNT OF CORE AVAILABLE
         LA    TOTAL,0(TOTAL)               REMOVE SUBPOOL NUMBER
         NI    NULLSW,X'00'                 TURN OFF NULL SWITCH
         BAL   BACK,GETREC                  SET UP PARAMETERS
         TM    NULLSW,X'01'                 TEST PROCESS SWITCH
         BO    ENDUSO                       DO NOT CALL EXIT
         MVC   20(8,CNT1),USERID            RESTORE USERID FIELD
         MVC   32(4,CNT1),USERCOMM          RESTORE USERCOMM FIELD
         LA    PARM,ADDRESS                 ADDRESS OF PARAMETER LIST
         LA    WORK,DCBPRINT                LOAD DCB ADDRESS
         ST    WORK,ADDRESS+4               ADDRESS IN PARM LIST
         L     ENTRY,ADDRUSO
         BALR  RET,ENTRY                    CALL EXIT ROUTINE
         CH    ENTRY,CON4
         BE    MOREUSO                      DO NOT CANCEL
         BAL   BACK,JCANCEL                 JOB CANCEL MESSAGE
MOREUSO  EQU   *
         MVC   USERID(8),20(CNT1)           SAVE USERID FIELD
         MVC   USERCOMM(4),32(CNT1)         SAVE USERCOMM FIELD
ENDUSO   EQU   *
         SH    INDEX,CON1                   DECREMENT COUNT OF EXIT CLS
         BNZ   NEXTUSO                      SET UP TO CALL USO AGAIN
         B     USERFLDS                     WRITE USER FIELDS
         SPACE 3
JCANCEL  EQU   *
         L     WORK,ADDRESS                 ADDRESS OF JOB LOG NUMBER
         MVC   JOBCAN+4(8),0(WORK)          JOB NAME
         ST    BACK,YSAREA                  SAVE BACK
         LA    CNT2,AJOBCAN                 ADDRESS OF PARAMETERS
         BAL   BACK,WRITEMSG                WRITE JOB CANCEL MSG
         L     BACK,YSAREA                  RESTORE BACK
         BR    BACK                         RETURN TO EXIT SECTION
         SPACE 3
USERFLDS EQU   *
         UNPK  IDMSG+29(5),USERID(3)
         UNPK  IDMSG+33(13),USERID+2(7)     UNPK ONE BYTE EXTRA TO GET
         UNPK  COMMSG+28(9),USERCOMM(5)     LAST DIGIT PRINTED
         TR    IDMSG+29(16),CHAR-240         CONVERT TO EBCDIC
         TR    COMMSG+28(8),CHAR-240         CONVERT TO EBCDIC
         LA    CNT2,AIDMSG
         BAL   BACK,WRITEMSG                 WRITE USER ID
         LA    CNT2,ACOMMSG
         BAL   BACK,WRITEMSG                WRITE USER COMM
         B     CLOSEDCB                     CLOSE DATA SETS & CONTINUE
         EJECT
***********************************************************************
* SECTION FUNCTIONS - 1. THIS SECTION SETS UP THE PARAMETER LIST FOR  *
*                        THE CALLS TO THE EXITS.                      *
*                     2. IF THE TOTAL PARAMETR LIST DOES NOT FIT INTO *
*                        TESTEXIT'S CORE, AN ERROR MESSAGE IS WRITTEN *
*                        AND THE CALL IS CANCELLED.                   *
*                     3. IF GETREC IS CALLED  BUT THERE ARE NO MORE   *
*                        PARAMETERS TO READ IN, AN ERROR MESSAGE IS   *
*                        WRITTEN AND CONTROL IS PASSED TO USERFLDS    *
*                        AND TO CLOSEDCB TO SET UP THE NEXT EXIT.     *
* ENTRIES - FROM THE PRECEEDING SECTION THAT CALLS THE EXITS.         *
* EXITS - RETURN VIA REG9 TO CALLERS                                  *
*         TO DSERFLDS TO WRITE MESSAGES AND SET UP NEXT EXIT          *
* SUBROUTINES - DATA MANAGEMENT TO GET RECORDS                        *
*               WRITEMSG TO WRITE ERROR MESSAGES TO SYSPRINT          *
* INPUT - R2(TOTAL)-NUMBER OF BYTES IN TESTEXIT'S WORK AREA           *
*         R3(ACM)-ZERO                                                *
*         R8(CNT2)-NUMBER OF PARAMETERS TO SET UP FOR EACH EXIT       *
*         R9(BACK)-RETURN ADDRESS TO CALLER                           *
*         R11(AREA)-ADDRESS OF TESTEXIT'S WORK AREA.                  *
*         OPENADDR-ADDRESS OF OPEN DCB FOR OUTPUT FROM DATA GENERATOR *
*         NULLSW-SET TO X'00'                                         *
* TABLES - 1. SWITCH-VALUE OF X'00' IF RECORDS ARE FIXED FORMAT       *
*                    VALUE OF X'01' IF RECORDS ARE VARIABLE FORMAT    *
*          2. FLRECL-LOGICAL RECORD LENGTH FOR FIXED LENGTH RECORDS   *
*          3. NULLSW-VALUE OF X'00' INITIALLY AND SET TO X'01' IF ALL *
*             RECORDS FOR A PARAMETER LIST WILL NOT FIT INTO TESTEXIT *
*             WORK AREA. IN THAT CASE THE REST OF THE RECORDS FOR     *
*             THE PARAMETER LIST ARE NOT READ IN AND THE CALL IS      *
*             CANCELLED.                                              *
*          4. ADDRESS-AN 11 WORD TABLE TO CONTAIN THE ADDRESS OF THE  *
*             PARAMETERS READ INTO TESTEXIT'S WORK AREA.              *
* REGISTER USEAGE - R0- USED BY DATA MANAGEMENT                       *
*                   R1(PARM)-PARAMETERS FOR GET AND ADDRESS OF        *
*                            ADDRESS(LIST OF PARAMETER ADDRESSES)     *
*                            UPON RETURN TO CALLER.                   *
*                   R2(TOTAL)-THE NUMBER OF BYTES LEFT IN TESTEXIT'S  *
*          5. TSMFSAVE-A TEMPORARY SAVE AREA WHILE AN ERROR MESSAGE   *
*                      IS WRITTEN.                                    *
*                             WORK AREA AFTER EACH PARAMETER RECORD   *
*                             IS PUT IN. INITIALLY THE TOTAL NUMBER   *
*                   R3(ACM)-DISPLACEMENT OF PARAMETER ADDRESS IN      *
*                           ADDRESS. INITIALALLY ZERO                 *
*                             OF BYTES IN THE WORK AREA               *
*                   R4(INDEX)-NUMBER OF CALLS LEFT FOR THE EXIT. NOT  *
*                             CHANGED.                                *
*                   R5(FIELDREG)-ADDRESS OF FIELD FROM DATAGEN. NOT   *
*                                CHANGED.                             *
*                   R6(CNT)-NUMBER OF EXITS THAT HAVE BEEN TESTED FOR *
*                          CALLING. NOT CHANGED.                      *
*                   R7(CNT1)-ADDRESS OF TESTEXIT'S WORK AREA. NOT     *
*                            CHANGED.                                 *
*                   R8(CNT2)-NUMBER OF PARAMETERS TO GET FOR EACH EXIT*
*                            ROUTINE. ALSO USED TO WRITE ERROR        *
*                            MESSAGES.                                *
*                   R9(BACK)-RETURN ADDRESS IN CALLING SECTION. ALSO  *
*                            USED TO RETURN FROM WRITING AN ERROR     *
*                            MESSAGE.                                 *
*                   R10(BASE)- BASE REGISTER                          *
*                   R11(AREA)-ADDRESS OF PLACE TO PUT NEXT PARAMETER  *
*                             RECORD IN TEXTEXIT'S WORK AREA.         *
*                   R12(WORK)-WORK REGISTER                           *
*                   R13(SAVEREG)-ADDRESS OF SAVE.                     *
*                   R14(RET)-USED BY DATA MANAGEMENT                  *
*                   R15(ENTRY)-USED BY DATA MANAGEMENT                *
* OUTPUT - 1. NULLSW IS SET TO X'01' IF THE CALL IS CANCELLED.        *
*          2. ADDRESS CONTAINS LIST OF PARAMETERS FOR THE EXIT ROUTINE*
*          3. R1(PARM) CONTAINS THE ADDRESS OF THE TABLE ADDRESS.     *
*          4. MESSAGES TO SYSPRINT FOR ERROR CONDITIONS.              *
***********************************************************************
         SPACE 3
GETREC   EQU   *
         L     PARM,OPENADDR                ADDRESS OF DCB
         LA    PARM,0(PARM)                 CLEAR HIGH ORDER BYTE
         GET   (PARM)
         TM    NULLSW,X'01'                 TEST PROCESS SWITCH
         BO    NEXT                         DON'T PROCESS RECORDS
         TM    SWITCH,X'01'                 TEST FOR FIXED FORMAT
         BO    FIXED
         LH    WORK,0(PARM)                 ADDRESS OF LL
         SH    WORK,CON4                    SUBTRACT FOR LLO0
         LA    PARM,4(PARM)                 GO BEYOND LL00
         B     FITTING
FIXED    EQU   *
         LH    WORK,FLRECL                  GET LRECL
FITTING  EQU   *
         CR    TOTAL,WORK                   WILL RECORD FIT INTO AREA
         BL    NEEDMORE                     NO - GET MORE CORE
         BCTR  WORK,0                       FOR EXECUTE
         EX    WORK,MOVEDATA                MOVE RECORD INTO AREA
         AH    WORK,CON1                    CORRECT LENGTH
         ST    AREA,ADDRESS(ACM)            SET UP PARAMETER LIST
KEEPCNT  EQU   *
         LA    ACM,4(ACM)                   INCREMENT DISPLACEMENT
         AR    AREA,WORK                    ADD DISPLACEMENT TO LAST
         SR    TOTAL,WORK                   SUBTRACT FROM TOTAL AREA
NEXT     EQU   *
         SH    CNT2,CON1                    DECREMENT COUNT OF PARMS
         BNZ   GETREC
         BR    BACK
NEEDMORE EQU   *
         STM   0,15,TSMFSAVE+8              SAVE REGS DURING ERROR COND
         LA    CNT2,NUMBERS                 CALLS TO MAKE TO EACH EXIT
         SR    WORK,WORK
         IC    WORK,0(CNT,CNT2)             TOTAL CALLS FOR THIS EXIT
         SR    WORK,INDEX
         AH    WORK,CON1
         CVD   WORK,WORKAREA                PRINT CALL NUMBER
         UNPK  COREMSG+37(3),WORKAREA+6(2)
         OI    COREMSG+39,X'F0'
         LA    CNT2,ACOREMSG                CORE MESSAGE
         BAL   BACK,WRITEMSG
         OI    NULLSW,X'01'                 TURN ON NULL SWITCH
         LM    0,15,TSMFSAVE+8              RESTORE FOR PROCESSING
         B     NEXT
         SPACE 3
ENDT     EQU   *
         LA    CNT2,AENDMSG                 ADDRESS OF MESSAGE PARMS
         BAL   BACK,WRITEMSG                WRITE MESSAGE
         B     USERFLDS                     WRITE USER FIELDS & GO ON
         EJECT
***********************************************************************
* SECTION FUNCTIONS - 1. WRITES MESSAGES TO SYSPRINT. SINCE THIS IS   *
*                     2. CLOSES DCBS, FREEMAINS, AND RETURNS TO THE   *
*                        OPERATING SYSTEM.                            *
* ENTRIES - FROM ALL SECTIONS OF TESTEXIT TO WRITE MESSAGES           *
*           FROM DATAGEN AND PARMPROS TO RETURN TO THE SYSTEM         *
* SUBROUTINES - DATA MANAGEMENT ROUTINES AND WTO ROUTINES             *
* INPUT - 1. TO MAKEMSG- R8(CNT2) CONTAINS THE DISPLACEMENT OF THE    *
*                         EXIT NAME IN FIELD                          *
*                        R9(BACK) CONTAINS THE RETURN ADDRESS         *
*         2. TO WRITEMSG- R8(CNT2) CONTAINS THE ADDRESS OF THE DOUBLE *
*                          WORD OF MESSAGE PARAMETERS FOR THE MESSAGE *
*                         R9(BACK) CONTAINS THE RETURN ADDRESS        *
*         3 TO ENDUP- AMTMAIN CONTAINS THE NUMBER OF BYTES IN         *
*                        TESTEXIT'S  WORK AREA AND SUBPOOL NUMBER     *
*                     MAIN CONTAINS THE ADDRESS OF TESTEXIT'S WORK    *
*                        AREA                                         *
* TABLES - EACH MESSAGE HAS A 2 WORD TABLE CONTAINING THE NUMBER OF   *
*             BYTES IN THE MESSAGE AND THE ADDRESS OF THE MESSAGE     *
*              AAA  DC F'NUMBER OF BYTES',AL4(ADDRESS)                *
* REGISTER USEAGE - R0-SUBPOOL NUMBER AND NUMBER OF BYTES FOR FREEMAIN*
*                   R1(PARM)-ADDRESS OF CORE FOR FREEMAIN ALSO USED   *
*                            BY DATA MANAGEMENT                       *
*                   R2-NOT USED                                       *
*                   R3-NOT USED                                       *
*                   R4-NOT USED                                       *
*                   R5-NOT USED                                       *
*                   R6-NOT USED                                       *
*                   R7-NOT USED                                       *
*                   R8(CNT2)-CONTAINS INFORMATION ON INPUT            *
*                   R9(BACK)-RETURN ADDRESS IN TESTEXIT               *
*                   R10(BASE)-BASE REGISTER                           *
*                   R11-NOT USED                                      *
*                   R12(WORK)-WORK REGISTER                           *
*                   R13(SAVEREG)-ADDRESS OF SAVE.  USED TO RESTORE    *
*                                REGISTERS IN RETURNING TO THE SYSTEM *
*                   R14(RET)-RETURN ADDRESS IN OPERATING SYSTEM       *
*                   R15-USED BY DATA MANAGEMENT, ZEROED BEFORE RETURN *
*                        DONE BY A PUT MOVE MODE, THE LL00 FIELD MUST *
*                        BE SET UP AND THE MESSAGE MOVED TO BUFFER    *
*                        RETURNED BY DATA MANAGEMENT.                 *
* OUTPUT - 1. MASSAGES ARE WRITTEN TO SYSPRINT                        *
*          2. IF SYSPRINT DOES NOT OPEN, A MESSAGE IS WRITTEN TO THE  *
*             CONSOLE AND CONTROL IS RETURNED TO THE SYSTEM.          *
*          3. DCB'S FOR SYSPRINT AND MANX ARE CLOSED, TESTEXIT'S WORK *
*             AREA IS RELEASED, AND CONTROL IS RETURNED TO THE SYSTEM.*
*             THE RETURN CODE IN R15 IS ALWAYS 0.                     *
***********************************************************************
         SPACE 3
MAKEMSG  EQU   *
         LA    WORK,FIELD                   ROUTINE NAMES
         LA    WORK,0(CNT2,WORK)            CORRECT ADDRESS OF NAME
         MVC   MSG+13(3),0(WORK)            MOVE NAME TO MSG
         LA    CNT2,AMSG                    ADDRESS OF MESSAGE PARMS
WRITEMSG TM    DCBPRINT+48,X'10'            TEST IF SYSPRINT OPEN
         BZ    OPENPRNT                     NO GO TO OPEN
PUTMSG   EQU   *
         PUT   DCBPRINT                     GET BUFFER
         L     WORK,0(CNT2)                 GET LENGTH
         AH    WORK,CON4                    ADD FOR CONTROL CARD
         STH   WORK,0(PARM)
         L     CNT2,4(CNT2)                 ADDRESS OF MESSAGE
         SH    WORK,CON5                    FOR EXECUTE
         EX    WORK,MOVEMSGS                MOVE MESSAGE TO BUFFER
         SR    WORK,WORK                    CLEAR FOR LENGTH
         STH   WORK,2(PARM)                 SET UP 00 FIELD
         BR    BACK                         RETURN TO CALLER
OPENPRNT OPEN  (DCBPRINT,(OUTPUT,LEAVE))
         TM    DCBPRINT+48,X'10'            TEST IF OPEN
         BNZ   PUTMSG                       YES-
         WTO   'PROGRAM TESTEXIT - OPEN ERROR ON SYSPRINT'
         B     ENDUP                        RETURN TO SYSTEM
         SPACE 3
ENDUP    EQU   *
         CLOSE (DCBPRINT,REREAD)
         CLOSE (DCBMANX,REREAD)
         L     0,AMTMAIN                    GET SUBPOOL AND CORE
         L     1,MAIN                       ADDRESS OF GETMAIN CORE
         FREEMAIN  R,LV=(0),A=(1)
         L     SAVEREG,SAVE+4
         LM    RET,12,12(SAVEREG)           RESTORE REGISTERS
         SR    ENTRY,ENTRY                  CLEAR FOR RETURN CODE
         BR    RET                          RETURN TO SYSTEM
         EJECT
***********************************************************************
* SECTION FUNCTIONS - WRITES RECORDS TO MANX                          *
*                     SETS DEFAULT BLKSIZE AND LRECL FOR SYSPRINT     *
*                        AND MANX                                     *
*                     THIS SECTION IS ALMOST A SEPARATE PROGRAM.  IT  *
*                     MUST ESTABLISH ADDRESSABILITY AND SAVE REGISTERS*
*                     THE RECORD IS TESTED FOR ERRORS.                *
*                     1. IF THE LENGTH IS LT 5, THE LENGTH IS SET TO  *
*                        10, THE RECORD IS WRITTEN TO MANX, AND AN    *
*                        ERROR MESSAGE IS WRITTEN TO SYSPRINT.        *
*                     2. IF THE RECORD TYPE FOR ALL USER RECORDS IS   *
*                        LT 128, THE RECORD IS WRITTEN TO MANX, AND   *
*                        AN ERROR MESSAGE IS WRITTEN TO SYSPRINT.     *
*                     3. IF MANX DOES NOT OPEN, AN ERROR MESSAGE IS   *
*                        WRITTEN TO SYSPRINT, BUT THE RECORD IS NOT   *
*                        WRITTEN TO MANX.                             *
*                     REGUARDLESS OF THE RETURN CODE THE RECORD IS    *
*                     ALWAYS COMPLETELY WRITTEN TO MANX IF MANX OPENS.*
*                     THIS IS TO ALLOW THE USER TO CHECK ALL RECORDS. *
* ENTRIES - 1. USER EXIT ROUTINES                                     *
*           2. SECTION IN TESTEXIT THAT PROCESSES CALLS TO IEFACTRT   *
*              TO WRITE JOB OR  STEP TERMINATION RECORD IF REQUESTED  *
* SUBROUTINES - 1. DATA MANAGEMENT ROUTINES                           *
*               2. WRITEMSG TO WRITE ERROR MESSAGES                   *
* INPUT - THE CALLING SEQUENCE MUST BE AS FOLLOWS:                    *
*              R1  -ADDRESS OF RECORD TO BE WRITTEN                   *
*              R14 -RETURN ADDRESS                                    *
*              R15 -ENTRY ADDRESS OF TSMFWTM                          *
* TABLES - 1. USERSAVE-18 WORD SAVE AREA FOR THE CALLER'S REGISTERS   *
*          2. TSMFSAVE-18 WORD SAVE AREA FOR TSMFWTM                  *
*          3. RETCODE - RETURN CODE FROM TSMFWTM                      *
*                       X'00' - RECORD SUCCESSFULLY WRITTEN           *
*                       X'04' - RECORD TRUNCATED                      *
*                       X'08' - LENGTH LT 5 OR RECORD TYPE LT 128     *
*                       X'0C' - NON-ZERO PROTECT KEY (NEVER USED HERE)*
*                       X'10' - DATA SET FULL OR DATA SET DID NOT     *
*                               OPEN                                  *
*          4. RECORDS - COUNT OF RECORDS WRITTEN TO DETERMINE THE     *
*                       RETURN CODES. AFTER THE COUNT REACHES '8', IT *
*                       IS RESET TO 0. AT A COUNT OF 4 A RETURN CODE  *
*                       OF X'04' IS GIVEN. AT A COUNT OF 8 A RETURN   *
*                       CODE OF X'10' IS GIVEN.  IN BOTH CASES THE    *
*                       RECORD IS COMPLETELY WRITTEN TO MANX SO THAT  *
*                       THE USER MAY CHECK HIS RECORDS FOR ERRORS.    *
* REGISTER USEAGE - R0 -USED BY DATA MANAGEMENT                       *
*                   R1(PARM) - ADDRESS OF RECORD TO BE WRITTEN        *
*                   R2 - NOT USED                                     *
*                   R3(ACM) - ADDRESS OF DCB FOR MANX                 *
*                   R4 - NOT USED                                     *
*                   R5 - NOT USED                                     *
*                   R6(CNT) - WORK REGISTER                           *
*                   R7(CNT1)- ADDRESS OF RECORD TO BE WRITTEN         *
*                   R8(CNT2)- ADDRESS OF ERROR MESSAGES FOR WRITEMSG  *
*                   R9(BACK)- RETURN ADDRESS FROM WRITEMSG            *
*                   R10(BASE) - BASE REGISTER                         *
*                   R11 - NOT USED                                    *
*                   R12(WORK) - WORK REGISTER                         *
*                   R13(SAVEREG) - ADDRESS OF TSMFSAVE                *
*                   R14(RET) - RETURN ADDRESS TO CALLER               *
*                   R15(ENTRY) - ADDRESS OF TSMFWTM AND RETURN CODE   *
* OUTPUT - 1. RECORD WRITTEN TO MANX                                  *
*          2. RETURN CODES TO CALLER                                  *
*          3. ERROR MESSAGES TO SYSPRINT                              *
*          4. ERROR MESSAGE TO CONSOLE FOR AN I/O ERROR ON MANX       *
***********************************************************************
         SPACE 3
TSMFWTM  EQU   *                            PSUEDO WRITE TO SYS1.MANX
SMFWTM   EQU   *
         USING *,ENTRY
         STM   14,12,USERSAVE+12            SAVE USER'S REGS
         ST    SAVEREG,USERSAVE+8
         LA    SAVEREG,USERSAVE
         ST    SAVEREG,TSMFSAVE+8
         LA    SAVEREG,TSMFSAVE
         ST    SAVEREG,USERSAVE+4
         L     BASE,ATEXIT                  RESTORE BASE REGISTER
         DROP  ENTRY
         NI    RETCODE,X'00'                ZERO RETURN CODE
         LA    ACM,DCBMANX                  ADDRESS OF DCB FOR MANX
         LR    CNT1,PARM                    SAVE ADDRESS OF RECORD
         TM    48(ACM),X'10'                TEST IF OPEN
         BZ    NOTOPEN
GOON     EQU   *
         CLC   CON5(2),0(CNT1)              TEST LENGTH OF MESSAGE
         BNH   ABBRA                        LENGTH IS OK
         MVC   0(2,CNT1),CON10              PUT IN NEW LENGTH
         B     RECERROR                     PRINT ERROR MESSAGE
ABBRA    EQU   *
         LA    WORK,COMEBACK                ADDRESS OF RETURN POINT
         L     CNT,USERSAVE+12              RETURN ADDRESS
         LA    CNT,0(CNT)
         CR    WORK,CNT                     TEST IF  FROM TESTEXIT
         BE    PUTREC                       DONT CHECK RECORD TYPE
         SR    WORK,WORK
         IC    WORK,5(CNT1)                 RECORD TYPE BYTE
         CH    WORK,CON128                  COMPARE TO 128
         BL    RECERROR                     ERROR IF LT 128
INCRE    EQU   *
         LA    WORK,1
         AH    WORK,RECORDS
         STH   WORK,RECORDS                 INCREMENT COUNT
         TM    RECORDS+1,X'08'              IF 8 - SAY DATA SET FULL
         BNZ   DSFULL
         CH    WORK,CON4                    REC COUNT = 4?
         BE    RECTRUNC                     GIVE CODE FOR TRUNCATION
PUTREC   EQU   *
         PUT   DCBMANX,(CNT1)               PUT RECORD INTO BUFFER
TSMFEXIT EQU   *
         SR    15,15                        SET RETURN CODE
         IC    15,RETCODE                   SET UP RETURN CODE
         L     SAVEREG,USERSAVE+8           RESTORE R13
         L     RET,USERSAVE+12              RETURN ADDRESS
         LM    2,12,USERSAVE+28             RESTORE 2-12
         BR    RET                          RETURN
         SPACE 3
NOTOPEN  EQU   *
         OPEN  (DCBMANX,(OUTPUT,LEAVE))
         TM    48(ACM),X'10'                TEST IF OPEN
         BNZ   GOON                         OPENED CONTINUE
         OI    RETCODE,X'10'                RETURN CODE OF 16
         LA    CNT2,AMANXMSG
         BAL   BACK,WRITEMSG                WRITE ERROR MSG
         B     TSMFEXIT                     RETURN TO CALLER
DSFULL   EQU   *
         NI    RECORDS+1,X'00'              RESET COUNT TO 0
         LA    WORK,16                       RETURN CODE
         STC   WORK,RETCODE
         B     PUTREC                       WRITE RECORD
RECTRUNC EQU   *
         LA    WORK,4                       RETURN CODE FOR TRUNCATION
         STC   WORK,RETCODE
         B     PUTREC                       WRITE RECORD
RECERROR EQU   *
         LA    CNT2,ARECERR
         BAL   BACK,WRITEMSG                WRITE ERROR MESSAGE
         OI    RETCODE,X'08'                RETURN CODE OF 8
         B     INCRE                        WRITE BAD RECORD
         SPACE 3
IOERROR  EQU   *
         WTO   'PROGRAM TESTEXIT - I/O ERROR ON MANX'
         BR    RET                          RETURN TO SYSTEM
         SPACE 3
XLIST    EQU   *
         CLC   62(2,PARM),DDNAMES+2         TEST BLKSIZE FOR ZERO
         BNE   GOBACK                       RETURN IF NOT ZERO
         LA    ENTRY,124
         STH   ENTRY,62(PARM)               DEFAULT BLKSIZE
         LA    ENTRY,120
         STH   ENTRY,82(PARM)               DEFAULT LRECL
GOBACK   EQU   *
         BR    RET                          RETURN TO OPEN ROUTINE
         EJECT
***********************************************************************
* SECTION FUNCTIONS - IMPLIMENTS WRITENG TO SYSPRINT FROM IEFACTRT.   *
*                     THE CALLING SEQUENCE IS AS FOLLOWS              *
*                          MVC  36(4,12),MSGADDR   MOVE MESSAGE       *
*                          MVC  42(2,12),MSGLEN    ADDRESS AND LENGTH *
*                          L    REG15,VCONYS       TO TESTEXIT TABLE. *
*                          BALR REG14,REG15        BAL TO IEFYS IN    *
*                          .                       TESTEXIT           *
*                          .                                          *
*                          .                                          *
*                     MSGADDR  DC  A(MSG)                             *
*                     MSG      DC  C' TEXT OF MESSAGE '               *
*                     MSGLEN   DC  H' 2 CHARACTER LENGTH OF MESSAGE ' *
*                     VCONYS   DC  V(IEFYS)                           *
*                      (R13 MUST CONTAIN THE ADDRESS OF A 64 WORD     *
*                     UPON ENTRY TO IEFACTRT R12 CONTAINS THE ADDRESS *
*                     OF YSAREA SO THE ABOVE SEQUENCE WILL WORK.      *
*                      SAVE AREA)                                     *
* ENTRIES - IEFACTRT EXIT ROUTINE                                     *
* EXITS - IEFACTRT EXIT ROUTINE                                       *
* SUBROUTINES - WRITEMSG TO WRITE MESSAGE TO SYSPRINT                 *
* INPUT - YSAREA+36 MUST CONTAIN THE ADDRESS OF THE MESSAGE           *
*         YSAREA+42 MUST CONTAIN THE 2 BYTE MESSAGE LENGTH            *
*                   THE USER MUST DEFINE SYSPRINT'S LRECL TO BE AT    *
*                   LEAST AS LARGE AS THE ALRGEST MESSAGE.            *
* TABLES - YSAREA-A  11 WORD AREA TO CONTAIN THE MESSAGE ADDRESS AND  *
*                 LENGTH. THE 2 BYTE MESSAGE LENGTH IS PALCED BEFORE  *
*                 THE MESSAGE ADDRESS TO CREATE A DOUBLE WORD OF      *
*                          DC F'LENGTH',AL4(ADDRESS)                  *
*                 AS WRITEMSG EXPECTS.                                *
*          TSMFSAVE-A 18 WORD SAVE AREA FOR IEFYS. SAVE CANNOT BE     *
*                   DESTROYED BECAUSE THE EXIT ROUTINE HAS STORED     *
*                   TESTEXIT'S REGISTERS THERE.                       *
* REGISTER USEAGE - R0-R5-NOT USED                                    *
*                   R8(CNT2)-ADDRESS OF 2 WORD LENGTH AND MESSAGE     *
*                            ADDRESS FOR WRITEMSG                     *
*                   R6(CNT)-WORK REGISTER                             *
*                   R7-NOT USED                                       *
*                   R9(BACK)-RETURN ADDRESS IN IEFYS FOR WRITEMSG     *
*                   R10(BASE)-BASE REGISTER                           *
*                   R11-NOT USED                                      *
*                   R12(WORK)- WORK REGISTER                          *
*                   R13(SAVEREG)-ADDRESS OF TSMFSAVE                  *
*                   R14(RET)-RETURN ADDRESS IN IEFACTRT               *
*                   R15-NOT USED                                      *
* OUTPUT - THE MESSAGE IS WRITTEN TO SYSPRINT                         *
***********************************************************************
         SPACE 3
IEFYS    EQU   *
         USING *,ENTRY            ESTABLISH ADDRESSABILITY       A33525
         STM   RET,12,12(SAVEREG)
         L     BASE,ATEXIT        USE TESTEXIT ENTRY AS BASE     A33525
         DROP  ENTRY                                             A33525
         ST    SAVEREG,TSMFSAVE+4
         LR    CNT,SAVEREG
         LA    SAVEREG,TSMFSAVE
         ST    SAVEREG,8(CNT)
         LH    WORK,YSAREA+42               LENGTH OF MSG
         ST    WORK,YSAREA+32               PUT BEFORE ADDRESS OF MSG
         LA    CNT2,YSAREA+32               ADDRESS OF LIST
         BAL   BACK,WRITEMSG                WRITE RECORD
         L     SAVEREG,TSMFSAVE+4
         LM    RET,12,12(SAVEREG)
         BR    RET                          RETURN
         EJECT
CON1     DC    H'1'
CON2     DC    H'2'
CON3     DC    H'3'
CON4     DC    H'4'
CON5     DC    H'5'
CON6     DC    H'6'
CON10    DC    H'10'
CON128   DC    H'128'
CON256   DC    H'256'
COMMA    DC    CL1','
EQSIGN   DC    CL1'='
SWITCH   DC    XL1'0'
RETCODE  DC    XL1'0'                       RETURN CODE FOR SMFWTM
NULLSW   DC    XL1'00'
NUMBERS  DS    XL6                          NO OF CALLS TO EXITS A46754
RECORDS  DS    H
FLRECL   DS    H
         CNOP  0,4
AMTMAIN  EQU   *
SUBPOOL  DC    XL1'01'                      SUBPOOL NUMBER
CORE     DC    XL3'000800'                  CORE REQUESTED IN HEX
USERCOMM DS    F
USERID   DS    D
FIELD    DC    CL3'UJV',BL1'0'              MUST BE IN THIS ORDER     1
         DC    CL3'UJI',BL1'0'                                        2
         DC    CL3'USI',BL1'0'                                        3
         DC    CL3'UTL',BL1'0'                                        4
         DC    CL3'ACT',BL1'0'                                        5
         DC    CL3'USO',BL1'0'                                        6
PLACE    DS    0F
MARKER   DS    H                            ALIGN DDNAMES TO HALF WORD
DDNAMES  DC    H'48'                        NUMBER OF BYTES IN LIST
         DC    XL8'00000000'                MUST BE IN THIS ORDER     1
         DC    XL8'00000000'                                          2
         DC    XL8'00000000'                                          3
         DC    XL8'00000000'                                          4
         DC    CL8'IN      '                                          5
         DC    CL8'DGPRINT '                                          6
OPTLIST  EQU   DDNAMES+4
WORKAREA DS    D
EXITLIST DC    XL1'85',AL3(XLIST)
SAVE     DS    18F                          SAVE AREA
TSMFSAVE DS    18F
USERSAVE DS    18F
OPENADDR DS    F
ADDRESS  DS    11F                          PARAMETER LISTS FOR EXITS
YSAREA   DS    11F                          AREA FOR IEFYS-SPRINT
MAIN     DS    1F                           ADDRESS OF GETMAIN AREA
ECBBLK   DS    F                            EVENT CONTROL BLOCK FOR DG
TCBADDR  DS    F                            ADDRESS OF TCB
ATEXIT   DC    A(TESTEXIT)
ADDRUJV  DC    V(IEFUJV)
ADDRUJI  DC    V(IEFUJI)
ADDRUSI  DC    V(IEFUSI)
ADDRUTL  DC    V(IEFUTL)
ADDRACT  DC    V(IEFACTRT)
ADDRUSO  DC    V(IEFUSO)
ABLNKMSG DC    F'10',AL4(BLNKMSG)
AMSG     DC    F'16',AL4(MSG)
APARMMSG DC    F'24',AL4(PARMMSG)
AENDMSG  DC    F'58',AL4(ENDMSG)
AJOBCAN  DC    F'22',AL4(JOBCAN)
AJOBCONT DC    F'48',AL4(JOBCONT)
ADGMSG   DC    F'75',AL4(DGMSG)
ARECERR  DC    F'47',AL4(RECERR)
ACOMMSG  DC    F'36',AL4(COMMSG)
AIDMSG   DC    F'45',AL4(IDMSG)
ACOREMSG DC    F'90',AL4(COREMSG)
AMANXMSG DC    F'58',AL4(MANXMSG)
DCBADDR  DC    A(DCBUJV)                    MUST  BE IN THIS ORDER    1
         DC    A(DCBUJI)                    ADDRESS OF DCBS           2
         DC    A(DCBUSI)                                              3
         DC    A(DCBUTL)                                              4
         DC    A(DCBACT)                                              5
         DC    A(DCBUSO)                                              6
RTNADDR  DC    A(READUJV)                   MUST BE IN THIS ORDER     1
         DC    A(READUJI)                   ADDRESS OF CALL EXIT RTNS 2
         DC    A(READUSI)                                             3
         DC    A(READUTL)                                             4
         DC    A(READACT)                                             5
         DC    A(READUSO)                                             6
PACKER   PACK  WORKAREA(8),0(0,CNT2)
MOVEDATA MVC   0(0,AREA),0(1)
MOVEMSGS MVC   4(0,PARM),0(CNT2)
CHAR     DC    CL16'0123456789ABCDEF'
BLNKMSG  DC    CL10'          '
MSG      DC    CL16'EXIT ROUTINE    '
PARMMSG  DC    CL24'ERROR IN PARAMETER FIELD'
ENDMSG   DC    CL58'NUMBER OF CALLS GREATER THAN DATA GENERATED FOR PAR*
               AMETERS'
RECERR   DC    CL47'INVALID RECORD TYPE OR LENGTH - RETURN CODE = 8'
JOBCAN   DC    CL22'JOB          CANCELLED'
JOBCONT  DC    CL48'JOB          CONTINUED WITH          TIMER UNITS'
DGMSG    DC    CL75'DATA GENERATOR ERROR CODE OR DATA SET OUT    DID NO*
               T OPEN - EXIT NOT CALLED'
COMMSG   DC    CL37'USER COMMUNICATION FIELD IS          '
IDMSG    DC    CL46'USER IDENTIFICATION FIELD IS                  '
COREMSG  DC    CL90'TOTAL PARAMETER LIST FOR CALL NUMBER     UNABLE TO *
               FIT INTO TESTEXIT CORE - CALL CANCELLED'
MANXMSG  DC    CL58'OPEN ERROR ON MANX - RETURN CODE = 16 - RECORD NOT *
               WRITTEN'
DCBUJV   DCB   DDNAME=OUTUJV,DEVD=DA,DSORG=PS,MACRF=GL,EODAD=ENDT
DCBUJI   DCB   DDNAME=OUTUJI,DEVD=DA,DSORG=PS,MACRF=GL,EODAD=ENDT
DCBUSI   DCB   DDNAME=OUTUSI,DEVD=DA,DSORG=PS,MACRF=GL,EODAD=ENDT
DCBUTL   DCB   DDNAME=OUTUTL,DEVD=DA,DSORG=PS,MACRF=GL,EODAD=ENDT
DCBACT   DCB   DDNAME=OUTACT,DEVD=DA,DSORG=PS,MACRF=GL,EODAD=ENDT
DCBUSO   DCB   DDNAME=OUTUSO,DEVD=DA,DSORG=PS,MACRF=GL,EODAD=ENDT
DCBMANX  DCB   DDNAME=MANX,DEVD=DA,DSORG=PS,MACRF=PM,SYNAD=IOERROR,    *
               EXLST=EXITLIST,RECFM=VBS
DCBPRINT DCB   DDNAME=SYSPRINT,DEVD=DA,DSORG=PS,MACRF=PL,              *
               EXLST=EXITLIST,RECFM=VB
         END
//LKED.SYSLMOD DD DSNAME=TESTLIB,VOLUME=SER=231400,UNIT=2314,          *
//             SPACE=(TRK,(5,2,1)),DISP=(NEW,KEEP)
//LKED.EXITS  DD DSNAME=EXITLIB,VOLUME=SER=231400,UNIT=2314,DISP=OLD
//LKED.SYSIN  DD  *
         INCLUDE EXITS(IEFUJV,IEFUJI,IEFACTRT,IEFUTL)
         NAME TESTEXIT
//DATAGEN     JOB   MSGLEVEL=1                                         C
//                     *                                               C
//          THIS PROCEDURE CREATES A NEW PARTIONED DATA SET (DGINPUT)  C
//             WHICH WILL CONTAIN DATA GENERATOR CONTROL STATEMENTS    C
//             FOR TESTING EXIT ROUTINES.                              C
//          MEMBER UJV WILL CONTAIN DATA GENERATOR STATEMENTS FOR      C
//             TESTING IEFUJV.  EACH SERIES OF 3 CREATE STATEMENTS     C
//             WILL RESULT IN ONE SET OF PARAMETERS (I.E. A PARAMETER  C
//             LIST) FOR IEFUJV.                                       C
//          MEMBER UJI WILL CONTAIN DATA GENERATOR STATEMENTS FOR      C
//             TESTING IEFUJI.  EACH SERIES OF 4 CREATE STATEMENTS     C
//             WILL RESULT IN ONE SET OF PARAMETERS FOR IEFUJI.        C
//          MEMBER USI WILL CONTAIN DATA GENERATOR STATEMENTS FOR      C
//             TESTING IEFUSI. EACH SERIES OF 4 CREATE STATEMENTS      C
//             WILL RESULT IN ONE SET OF PARAMETERS FOR IEFUSI.        C
//          MEMBER UTL WILL CONTAIN DATA GENERATOR STATEMENTS FOR      C
//             TESTING IEFUT2.  EACH SERIES OF 2 CREATE STATEMENTS     C
//             WILL RESULT IN ONE SET OF PARAMETERS FOR IEFUTL (I.E. A C
//             PARAMETER LIST PLUS AN EXTRA PARAMETER REPRESENTING THE C
//             CODE PASSED TO IEFUTL IN REGISTER 0).                   C
//          MEMBER ACT WILL CONTAIN DATA GENERATOR STATEMENTS FOR      C
//             TESTING IEFACTRT.  EACH SERIES OF 11 CREATE STATEMENTS  C
//             WILL RESULT IN ONE SET OF PARAMETERS FOR IEFACTRT (I.E. C
//             A PARAMETER LIST PLUS AN EXTRA PARAMETER REPRESENTING   C
//             THE CODE PASSED TO IEFACTRT IN REGISTER 0).             C
//          MEMBER USO WILL CONTAIN DATA GENERATOR STATEMENTS FOR      C
//             TESTING IEFUSO.  EACH SERIES OF 1 CREATE STATEMENT      C
//             WILL RESULT IN ONE SET OF PARAMETERS FOR IEFUTL.        C
//                     *
// EXEC PGM=IEBUPDTE,PARM=NEW
//SYSUT2 DD DSNAME=DGINPUT,UNIT=2314,DISP=(,KEEP),VOLUME=SER=231400,   *
//             SPACE=(TRK,(10,5,1)),DCB=(LRECL=80,BLKSIZE=400,RECFM=FB)
//SYSPRINT DD SYSOUT=A
//SYSIN DD DATA
./       ADD   NAME=UJV
         DSD   OUTPUT=(OUTUJV)
         FD    NAME=JOBNAME,LENGTH=8,FILL=X'40',PICTURE=7,'TESTJOB'
         FD    NAME=TIMESTP,LENGTH=4,FORMAT=BI,INDEX=2
         FD    NAME=DATE,LENGTH=4,PICTURE=5,P'19968'
         FD    NAME=SID,LENGTH=4,FILL=X'40',PICTURE=2,'5C'
         FD    NAME=USERID,LENGTH=8,FILL=X'40'
         FD    NAME=USERCOMM,LENGTH=4,STARTLOC=32,FORMAT=BI
         FD    NAME=C0,LENGTH=1,PICTURE=1,B'0'
         FD    NAME=C1,LENGTH=1,PICTURE=1,B'1'
         FD    NAME=C2,LENGTH=1,PICTURE=1,B'2'
         FD    NAME=C3,LENGTH=1,PICTURE=1,B'3'
         FD    NAME=C4,LENGTH=1,PICTURE=1,B'4'
         FD    NAME=C5,LENGTH=1,PICTURE=1,B'5'
         FD    NAME=C6,LENGTH=1,PICTURE=1,B'6'
         FD    NAME=C7,LENGTH=1,PICTURE=1,B'7'
         FD    NAME=C8,LENGTH=1,PICTURE=1,B'8'
         FD    NAME=C9,LENGTH=1,PICTURE=1,B'9'
         FD    NAME=C10,LENGTH=1,PICTURE=2,B'10'
         FD    NAME=C11,LENGTH=1,PICTURE=2,B'11'
         FD    NAME=C12,LENGTH=1,PICTURE=2,B'12'
         FD    NAME=C13,LENGTH=1,PICTURE=2,B'13'
         FD    NAME=C14,LENGTH=1,PICTURE=2,B'14'
         FD    NAME=C15,LENGTH=1,PICTURE=2,B'15'
         FD    NAME=C16,LENGTH=1,PICTURE=2,B'16'
         CREATE NAME=(JOBNAME,TIMESTP,DATE,SID,USERID,C1,USERCOMM)
         CREATE INPUT=SYSIN(TSMF)
//TESTJOB  JOB B3235678,SMITH,MSGLEVEL=1,
TSMF
         CREATE NAME=C1
         CREATE NAME=(JOBNAME,TIMESTP,DATE,SID,USERID,C1,USERCOMM)
         CREATE INPUT=SYSIN(TSMF)
//             PRTY=2,REGION=123K,TIME=(5,30)
TSMF
         CREATE NAME=C1
         CREATE NAME=(JOBNAME,TIMESTP,DATE,SID,USERID,C1,USERCOMM)
         CREATE INPUT=SYSIN(TSMF)
//STP1   EXEC  FORTHCLG,PARM.FORT=BCD
TSMF
         CREATE NAME=C8
         CREATE NAME=(JOBNAME,TIMESTP,DATE,SID,USERID,C1,USERCOMM)
         CREATE INPUT=SYSIN(TSMF)
//FORT   EXEC  PGM=IEKAA00,REGION=228K
TSMF
         CREATE  NAME=C2
         CREATE NAME=(JOBNAME,TIMESTP,DATE,SID,USERID,C1,USERCOMM)
         CREATE INPUT=SYSIN(TSMF)
//SYSPRINT DD  SYSOUT=A
TSMF
         CREATE  NAME=C4
         CREATE NAME=(JOBNAME,TIMESTP,DATE,SID,USERID,C1,USERCOMM)
         CREATE INPUT=SYSIN(TSMF)
//SYSPUNCH DD  SYSOUT=B
TSMF
         CREATE  NAME=C4
         CREATE NAME=(JOBNAME,TIMESTP,DATE,SID,USERID,C1,USERCOMM)
         CREATE INPUT=SYSIN(TSMF)
//FORT.SYSLIN  DD  DSNAME=&LOADSET,UNIT=SYSDA,DISP=(MOD,PASS),         *
TSMF
         CREATE NAME=C4
         CREATE NAME=(JOBNAME,TIMESTP,DATE,SID,USERID,C1,USERCOMM)
         CREATE INPUT=SYSIN(TSMF)
//             SPACE=(400,(200,50),RLSE)
TSMF
         CREATE NAME=C4
         CREATE NAME=(JOBNAME,TIMESTP,DATE,SID,USERID,C1,USERCOMM)
         CREATE INPUT=SYSIN(TSMF)
XXSYSLIN  DD   DSNAME=&LOADSET,UNIT=SYSSQ,DISP=(MOD,PASS),             *
TSMF
         CREATE NAME=C4
         CREATE NAME=(JOBNAME,TIMESTP,DATE,SID,USERID,C1,USERCOMM)
         CREATE INPUT=SYSIN(TSMF)
//             SPACE=(400,(200,50),RLSE)
TSMF
         CREATE NAME=C4
         CREATE NAME=(JOBNAME,TIMESTP,DATE,SID,USERID,C2,USERCOMM)
         CREATE INPUT=SYSIN(TSMF)
//FORT.SYSIN  DD *
TSMF
         CREATE  NAME=C4
         CREATE NAME=(JOBNAME,TIMESTP,DATE,SID,USERID,C2,USERCOMM)
         CREATE INPUT=SYSIN(TSMF)
//LKED   EXEC  PGM=IEWL,REGION=96K,PARM=(MAP,LET,LIST),COND=(4,LT,FORT)
TSMF
         CREATE NAME=C2
         CREATE NAME=(JOBNAME,TIMESTP,DATE,SID,USERID,C2,USERCOMM)
         CREATE INPUT=SYSIN(TSMF)
//SYSLIB  DD  DSNAME=SYS1.FORTLIB,DISP=SHR
TSMF
         CREATE NAME=C4
         CREATE NAME=(JOBNAME,TIMESTP,DATE,SID,USERID,C2,USERCOMM)
         CREATE INPUT=SYSIN(TSMF)
//SYSPRINT  DD SYSOUT=A
TSMF
         CREATE  NAME=C4
         CREATE NAME=(JOBNAME,TIMESTP,DATE,SID,USERID,C2,USERCOMM)
         CREATE INPUT=SYSIN(TSMF)
//SYSLMOD DD DSNAME=&GOSET(MAIN),UNIT=SYSDA,DISP=(,PASS),              *
TSMF
         CREATE NAME=C4
         CREATE NAME=(JOBNAME,TIMESTP,DATE,SID,USERID,C2,USERCOMM)
         CREATE INPUT=SYSIN(TSMF)
//             SPACE=(3072,(30,10,1),RLSE)
TSMF
         CREATE  NAME=C4
         CREATE NAME=(JOBNAME,TIMESTP,DATE,SID,USERID,C2,USERCOMM)
         CREATE INPUT=SYSIN(TSMF)
//SYSUT1   DD  UNIT=SYSDA,SPACE=(1024,(200,20)),SEP=SYSLMOD
TSMF
         CREATE NAME=C4
         CREATE NAME=(JOBNAME,TIMESTP,DATE,SID,USERID,C2,USERCOMM)
         CREATE INPUT=SYSIN(TSMF)
//SYSLIN   DD  DSNAME=&LOADSET,DISP=(OLD,DELETE)
TSMF
         CREATE NAME=C4
         CREATE NAME=(JOBNAME,TIMESTP,DATE,SID,USERID,C3,USERCOMM)
         CREATE INPUT=SYSIN(TSMF)
//        DD   DDNAME=SYSIN
TSMF
          CREATE NAME=C4
         CREATE NAME=(JOBNAME,TIMESTP,DATE,SID,USERID,C3,USERCOMM)
         CREATE INPUT=SYSIN(TSMF)
//GO     EXEC  PGM=*.LKED.SYSLMOD,COND=((4,LT,FORT),(4,LT,LKED))
TSMF
         CREATE NAME=C2
         CREATE NAME=(JOBNAME,TIMESTP,DATE,SID,USERID,C3,USERCOMM)
         CREATE INPUT=SYSIN(TSMF)
//FT05F001  DD DDNAME=SYSIN
TSMF
         CREATE  NAME=C4
         CREATE NAME=(JOBNAME,TIMESTP,DATE,SID,USERID,C3,USERCOMM)
         CREATE INPUT=SYSIN(TSMF)
//FT06F001  DD  SYSOUT=A
TSMF
         CREATE NAME=C4
         CREATE NAME=(JOBNAME,TIMESTP,DATE,SID,USERID,C3,USERCOMM)
         CREATE INPUT=SYSIN(TSMF)
//FT07F001  DD SYSOUT=B
TSMF
         CREATE NAME=C4
         CREATE NAME=(JOBNAME,TIMESTP,DATE,SID,USERID,C3,USERCOMM)
         CREATE INPUT=SYSIN(TSMF)
//GO.SYSIN  DD *
TSMF
         CREATE  NAME=C4
         CREATE NAME=(JOBNAME,TIMESTP,DATE,SID,USERID,C3,USERCOMM)
         CREATE INPUT=SYSIN(TSMF)

TSMF
         CREATE NAME=C16
         END
./       ADD   NAME=UJI
         DSD   OUTPUT=(OUTUJI)
         FD    NAME=JOBNAME,LENGTH=8,FILL=X'40',PICTURE=7,'JOBNAME',   *
               ACTION=TR
         FD    NAME=TIMESTP,LENGTH=4,FORMAT=BI,INDEX=10
         FD    NAME=DATE,LENGTH=4,PICTURE=5,P'19968'
         FD    NAME=SID,LENGTH=4,FILL=X'40',PICTURE=2,'5C'
         FD    NAME=USERID,LENGTH=8,FILL=X'40'
         FD    NAME=STEPNUM,LENGTH=4,PICTURE=1,B'1'
         FD    NAME=USERCOMM,LENGTH=4,FORMAT=BI,STARTLOC=32
         FD    NAME=AUTHOR,LENGTH=20,FILL=X'40',                       *
               PICTURE=10,'PROGRAMMER',ACTION=TR
         FD    NAME=JOBPRTY,LENGTH=1,FORMAT=RA
         FD    NAME=C0,LENGTH=1,PICTURE=1,B'0'
         FD    NAME=C1,LENGTH=1,PICTURE=1,B'1'
         FD    NAME=C2,LENGTH=1,PICTURE=1,B'2'
         FD    NAME=C3,LENGTH=1,PICTURE=1,B'3'
         FD    NAME=C4,LENGTH=1,PICTURE=1,B'4'
         FD    NAME=C5,LENGTH=1,PICTURE=1,B'5'
         FD    NAME=C6,LENGTH=1,PICTURE=1,B'6'
         FD    NAME=C7,LENGTH=1,PICTURE=1,B'7'
         FD    NAME=C8,LENGTH=1,PICTURE=1,B'8'
         FD    NAME=C9,LENGTH=1,PICTURE=1,B'9'
         FD    NAME=C10,LENGTH=1,PICTURE=2,B'10'
         FD    NAME=C11,LENGTH=1,PICTURE=2,B'11'
         FD    NAME=C12,LENGTH=1,PICTURE=2,B'12'
         FD    NAME=C13,LENGTH=1,PICTURE=2,B'13'
         FD    NAME=C14,LENGTH=1,PICTURE=2,B'14'
         FD    NAME=C15,LENGTH=1,PICTURE=2,B'15'
         FD    NAME=C16,LENGTH=1,PICTURE=2,B'16'
         FD    NAME=FA,LENGTH=1,PICTURE=1,'A'
         FD    NAME=FB,LENGTH=2,PICTURE=2,'BC',ACTION=RP
         FD    NAME=FC,LENGTH=3,PICTURE=3,'DEF',ACTION=RP
         FD    NAME=FD,LENGTH=4,PICTURE=4,'GHIJ',ACTION=RP
         FD    NAME=FE,LENGTH=5,PICTURE=5,'KLMNO',ACTION=RP
         FD    NAME=F0,LENGTH=1,PICTURE=1,'0'
         FD    NAME=F1,LENGTH=1,PICTURE=1,'1'
         FD    NAME=F2,LENGTH=2,PICTURE=2,'23',ACTION=RP
         FD    NAME=F3,LENGTH=3,PICTURE=3,'456',ACTION=RP
         FD    NAME=F4,LENGTH=4,PICTURE=4,'7890',ACTION=RP
         FD    NAME=F5,LENGTH=5,PICTURE=5,'12345',ACTION=RP
         CREATE NAME=(JOBNAME,TIMESTP,DATE,SID,USERID,STEPNUM,USERCOMM)
         CREATE NAME=AUTHOR
         CREATE NAME=JOBPRTY
         CREATE NAME=(C1,C1,F1)
         CREATE NAME=(JOBNAME,TIMESTP,DATE,SID,USERID,STEPNUM,USERCOMM)
         CREATE NAME=AUTHOR
         CREATE NAME=JOBPRTY
        CREATE NAME=(C2,C5,FC,F2,C10,F5,FB,F3)
         CREATE NAME=(JOBNAME,TIMESTP,DATE,SID,USERID,STEPNUM,USERCOMM)
         CREATE NAME=AUTHOR
         CREATE NAME=JOBPRTY
         CREATE NAME=C0
         CREATE NAME=(JOBNAME,TIMESTP,DATE,SID,USERID,STEPNUM,USERCOMM)
         CREATE NAME=AUTHOR
         CREATE NAME=JOBPRTY
        CREATE NAME=(C4,C1,FA,C0,C0,C3,F3)
         CREATE NAME=(JOBNAME,TIMESTP,DATE,SID,USERID,STEPNUM,USERCOMM)
         CREATE NAME=AUTHOR
         CREATE NAME=JOBPRTY
        CREATE NAME=(C5,C5,F5,C6,FE,F0,C2,FB,C4,FD,C7,F1,FB,F3,FA)
         CREATE NAME=(JOBNAME,TIMESTP,DATE,SID,USERID,STEPNUM,USERCOMM)
         CREATE NAME=AUTHOR
         CREATE NAME=JOBPRTY
        CREATE NAME=(C3,C1,F0,C12,FE,F5,F2,C0)
         CREATE NAME=(JOBNAME,TIMESTP,DATE,SID,USERID,STEPNUM,USERCOMM)
         CREATE NAME=AUTHOR
         CREATE NAME=JOBPRTY
        CREATE NAME=(C6,C0,C4,F4,C3,F3,C9,FE,F4,C2,F2,C2,FB)
         CREATE NAME=(JOBNAME,TIMESTP,DATE,SID,USERID,STEPNUM,USERCOMM)
         CREATE NAME=AUTHOR
         CREATE NAME=JOBPRTY
         CREATE NAME=(C1,C15,F1,FA,F5,FD,FD)
         END
./       ADD   NAME=USI
         DSD   OUTPUT=(OUTUSI)
         FD    NAME=JOBNAME,LENGTH=8,FILL=X'40',PICTURE=7,'JOBNAME',   *
               ACTION=TR
         FD    NAME=TIMESTP,LENGTH=4,FORMAT=BI,INDEX=10
         FD    NAME=DATE,LENGTH=4,PICTURE=5,P'19968'
         FD    NAME=SID,LENGTH=4,FILL=X'40',PICTURE=2,'SC'
         FD    NAME=USERID,LENGTH=8,FILL=X'40'
         FD    NAME=STEPNUM,LENGTH=4,PICTURE=1,B'1'
         FD    NAME=USERCOMM,LENGTH=4,FORMAT=BI,STARTLOC=32
         FD    NAME=STEPNAME,LENGTH=8,FILL=X'40',PICTURE=8,'STEPNAME', *
               ACTION=TR
         FD    NAME=PROGNAME,LENGTH=8,FILL=X'40',PICTURE=8,'PROGNAME', *
               ACTION=TR
         FD    NAME=C0,LENGTH=1,PICTURE=1,B'0'
         FD    NAME=C1,LENGTH=1,PICTURE=1,B'1'
         FD    NAME=C2,LENGTH=1,PICTURE=1,B'2'
         FD    NAME=C3,LENGTH=1,PICTURE=1,B'3'
         FD    NAME=C4,LENGTH=1,PICTURE=1,B'4'
         FD    NAME=C5,LENGTH=1,PICTURE=1,B'5'
         FD    NAME=C6,LENGTH=1,PICTURE=1,B'6'
         FD    NAME=C7,LENGTH=1,PICTURE=1,B'7'
         FD    NAME=C8,LENGTH=1,PICTURE=1,B'8'
         FD    NAME=C9,LENGTH=1,PICTURE=1,B'9'
         FD    NAME=C10,LENGTH=1,PICTURE=2,B'10'
         FD    NAME=C11,LENGTH=1,PICTURE=2,B'11'
         FD    NAME=C12,LENGTH=1,PICTURE=2,B'12'
         FD    NAME=C13,LENGTH=1,PICTURE=2,B'13'
         FD    NAME=C14,LENGTH=1,PICTURE=2,B'14'
         FD    NAME=C15,LENGTH=1,PICTURE=2,B'15'
         FD    NAME=C16,LENGTH=1,PICTURE=2,B'16'
         FD    NAME=FA,LENGTH=1,PICTURE=1,'A'
         FD    NAME=FB,LENGTH=2,PICTURE=2,'BC',ACTION=RP
         FD    NAME=FC,LENGTH=3,PICTURE=3,'DEF',ACTION=RP
         FD    NAME=FD,LENGTH=4,PICTURE=4,'GHIJ',ACTION=RP
         FD    NAME=FE,LENGTH=5,PICTURE=5,'KLMNO',ACTION=RP
         FD    NAME=F0,LENGTH=1,PICTURE=1,'0'
         FD    NAME=F1,LENGTH=1,PICTURE=1,'1'
         FD    NAME=F2,LENGTH=2,PICTURE=2,'23',ACTION=RP
         FD    NAME=F3,LENGTH=3,PICTURE=3,'456',ACTION=RP
         FD    NAME=F4,LENGTH=4,PICTURE=4,'7890',ACTION=RP
         FD    NAME=F5,LENGTH=5,PICTURE=5,'12345',ACTION=RP
        CREATE NAME=(JOBNAME,TIMESTP,DATE,SID,USERID,STEPNUM,USERCOMM)
        CREATE NAME=(STEPNAME)
        CREATE NAME=(PROGNAME)
        CREATE NAME=(C1,C1,F1)
        CREATE NAME=(JOBNAME,TIMESTP,DATE,SID,USERID,STEPNUM,USERCOMM)
        CREATE NAME=(STEPNAME)
        CREATE NAME=(PROGNAME)
        CREATE NAME=(C2,C5,FC,F2,C10,F5,FB,F3)
        CREATE NAME=(JOBNAME,TIMESTP,DATE,SID,USERID,STEPNUM,USERCOMM)
        CREATE NAME=(STEPNAME)
        CREATE NAME=(PROGNAME)
        CREATE NAME=(C0)
        CREATE NAME=(JOBNAME,TIMESTP,DATE,SID,USERID,STEPNUM,USERCOMM)
        CREATE NAME=(STEPNAME)
        CREATE NAME=(PROGNAME)
        CREATE NAME=(C4,C1,FA,C0,C0,C3,F3)
        CREATE NAME=(JOBNAME,TIMESTP,DATE,SID,USERID,STEPNUM,USERCOMM)
        CREATE NAME=(STEPNAME)
        CREATE NAME=(PROGNAME)
        CREATE NAME=(C5,C5,F5,C6,FE,F0,C2,FB,C4,FD,C7,F1,FB,F3,FA)
        CREATE NAME=(JOBNAME,TIMESTP,DATE,SID,USERID,STEPNUM,USERCOMM)
        CREATE NAME=(STEPNAME)
        CREATE NAME=(PROGNAME)
        CREATE NAME=(C3,C1,F0,C12,FE,F5,F2,C0)
        CREATE NAME=(JOBNAME,TIMESTP,DATE,SID,USERID,STEPNUM,USERCOMM)
        CREATE NAME=(STEPNAME)
        CREATE NAME=(PROGNAME)
        CREATE NAME=(C6,C0,C4,F4,C3,F3,C9,FE,F4,C2,F2,C2,FB)
        CREATE NAME=(JOBNAME,TIMESTP,DATE,SID,USERID,STEPNUM,USERCOMM)
        CREATE NAME=(STEPNAME)
        CREATE NAME=(PROGNAME)
        CREATE NAME=(C1,C15,F1,FA,F5,FD,FD)
         END
./       ADD   NAME=UTL
         DSD   OUTPUT=(OUTUTL)
         FD    NAME=JOBNAME,LENGTH=8,FILL=X'40',PICTURE=7,'JOBNAME',   *
               ACTION=TR
         FD    NAME=TIMESTP,LENGTH=4,FORMAT=BI,INDEX=10
         FD    NAME=DATE,LENGTH=4,PICTURE=5,P'19968'
         FD    NAME=SID,LENGTH=4,FILL=X'40',PICTURE=2,'SC'
         FD    NAME=USERID,LENGTH=8,FILL=X'40'
         FD    NAME=STEPNUM,LENGTH=4,FORMAT=BI
         FD    NAME=USERCOMM,LENGTH=4,FORMAT=BI,STARTLOC=32
         FD    NAME=C0,LENGTH=1,PICTURE=1,B'0'
         FD    NAME=C1,LENGTH=1,PICTURE=1,B'1'
         FD    NAME=C2,LENGTH=1,PICTURE=1,B'2'
         FD    NAME=C3,LENGTH=1,PICTURE=1,B'3'
         FD    NAME=C4,LENGTH=1,PICTURE=1,B'4'
         FD    NAME=C5,LENGTH=1,PICTURE=1,B'5'
         FD    NAME=C6,LENGTH=1,PICTURE=1,B'6'
         FD    NAME=C7,LENGTH=1,PICTURE=1,B'7'
         FD    NAME=C8,LENGTH=1,PICTURE=1,B'8'
         FD    NAME=C9,LENGTH=1,PICTURE=1,B'9'
         CREATE NAME=(JOBNAME,TIMESTP,DATE,SID,USERID,C1,USERCOMM)
         CREATE NAME=C0
         CREATE NAME=(JOBNAME,TIMESTP,DATE,SID,USERID,C2,USERCOMM)
         CREATE NAME=C8
         CREATE NAME=(JOBNAME,TIMESTP,DATE,SID,USERID,C3,USERCOMM)
         CREATE NAME=C8
         CREATE NAME=(JOBNAME,TIMESTP,DATE,SID,USERID,C4,USERCOMM)
         CREATE NAME=C4
         CREATE NAME=(JOBNAME,TIMESTP,DATE,SID,USERID,C5,USERCOMM)
         CREATE NAME=C0
         END
./       ADD   NAME=ACT
         DSD   OUTPUT=(OUTACT)
         FD    NAME=JOBNAME,LENGTH=8,FILL=X'40',PICTURE=7,'JOBNAME',   *
               ACTION=TR
         FD    NAME=TIMESTP,LENGTH=4,PICTURE=1,B'0',INDEX=10
         FD    NAME=DATE,LENGTH=4,PICTURE=5,P'19968'
         FD    NAME=SID,LENGTH=4,FILL=X'40',PICTURE=2,'5C'
         FD    NAME=USERID,LENGTH=8,FILL=X'40'
         FD    NAME=STEPNUM,LENGTH=4,FORMAT=BI
         FD    NAME=USERCOMM,LENGTH=4,FORMAT=BI,STARTLOC=32
         FD    NAME=STEPNAME,LENGTH=8,FILL=X'40',PICTURE=8,'STEPNAME', *
               ACTION=TR
         FD    NAME=AUTHOR,LENGTH=20,FILL=X'40',                       *
               PICTURE=10,'PROGRAMMER',ACTION=TR
         FD    NAME=EXCPCNT,LENGTH=4,FORMAT=RA
         FD    NAME=TAPECLAS,LENGTH=1,PICTURE=3,B'128'
         FD    NAME=DACLASS,LENGTH=1,PICTURE=2,B'32'
         FD    NAME=URECLASS,LENGTH=1,PICTURE=1,B'8'
         FD    NAME=STEPPRTY,LENGTH=1,FORMAT=RA
         FD    NAME=JOBTIME,LENGTH=3,FORMAT=RA
         FD    NAME=STEPTIME,LENGTH=3,FORMAT=RA
         FD    NAME=RDSTARTT,LENGTH=4,FORMAT=BI,INDEX=4
         FD    NAME=RDSTARTD,LENGTH=4,PICTURE=5,P'19968'
         FD    NAME=STARTIME,LENGTH=4,FORMAT=BI,INDEX=2
         FD    NAME=STARTDAT,LENGTH=4,PICTURE=5,P'19968'
         FD    NAME=RDRSTOPT,LENGTH=4,FORMAT=BI,INDEX=6
         FD    NAME=RDRSTOPD,LENGTH=4,PICTURE=5,P'19968'
         FD    NAME=DEVCLASS,LENGTH=1,FORMAT=BI
         FD    NAME=DEVTYPE,LENGTH=1,FORMAT=BI
         FD    NAME=REGION,LENGTH=2,FORMAT=BI
         FD    NAME=FLAGS,LENGTH=1,PICTURE=1,B'0'
         FD    NAME=SYSINCNT,LENGTH=4,INDEX=10,PICTURE=1,B'0'
         FD    NAME=JOBPRTY,LENGTH=1,INDEX=1,RANGE=13
         FD    NAME=TERMCODE,LENGTH=1,FORMAT=RA
         FD    NAME=TERMSTAT,LENGTH=2,FORMAT=RA
         FD    NAME=SYSOUTCL,LENGTH=5,FORMAT=RA
         FD    NAME=CPRSTART,LENGTH=1
         FD    NAME=JOBINCL,LENGTH=1,FORMAT=RA
         FD    NAME=CPUTIME,LENGTH=3,FORMAT=RA
         FD    NAME=JOBTYPE,LENGTH=1,PICTURE=1,B'5'
         FD    NAME=STEPTYPE,LENGTH=1,PICTURE=1,B'4'
         FD    NAME=PROGNAME,LENGTH=8,FILL=X'40',PICTURE=7,'PROGRAM',  *
               ACTION=TR
         FD    NAME=REGSIZE,LENGTH=2,FORMAT=RA
         FD    NAME=LCSBRRD,LENGTH=2
         FD    NAME=LCSUSED,LENGTH=2
         FD    NAME=COREBRRD,LENGTH=2
         FD    NAME=COREUSED,LENGTH=2,FORMAT=RA
         FD    NAME=ADDR180,LENGTH=2,PICTURE=3,B'180'
         FD    NAME=ADDR181,LENGTH=2,PICTURE=3,B'181'
         FD    NAME=ADDR182,LENGTH=2,PICTURE=3,B'182'
         FD    NAME=ADDR183,LENGTH=2,PICTURE=3,B'183'
         FD    NAME=ADDR280,LENGTH=2,PICTURE=3,B'280'
         FD    NAME=ADDR281,LENGTH=2,PICTURE=3,B'281'
         FD    NAME=ADDR282,LENGTH=2,PICTURE=3,B'282'
         FD    NAME=ADDR283,LENGTH=2,PICTURE=3,B'283'
         FD    NAME=ADDR284,LENGTH=2,PICTURE=3,B'284'
         FD    NAME=ADDR190,LENGTH=2,PICTURE=3,B'190'
         FD    NAME=ADDR191,LENGTH=2,PICTURE=3,B'191'
         FD    NAME=ADDR192,LENGTH=2,PICTURE=3,B'192'
         FD    NAME=ADDR193,LENGTH=2,PICTURE=3,B'193'
         FD    NAME=ADDR1C0,LENGTH=2,PICTURE=3,B'448'
         FD    NAME=ADDR00C,LENGTH=2,PICTURE=3,B'012'
         FD    NAME=ADDR00D,LENGTH=2,PICTURE=3,B'013'
         FD    NAME=ADDR00E,LENGTH=2,PICTURE=3,B'014'
         FD    NAME=C0,LENGTH=1,PICTURE=1,B'0'
         FD    NAME=C1,LENGTH=1,PICTURE=1,B'1'
         FD    NAME=C2,LENGTH=1,PICTURE=1,B'2'
         FD    NAME=C3,LENGTH=1,PICTURE=1,B'3'
         FD    NAME=C4,LENGTH=1,PICTURE=1,B'4'
         FD    NAME=C5,LENGTH=1,PICTURE=1,B'5'
         FD    NAME=C6,LENGTH=1,PICTURE=1,B'6'
         FD    NAME=C7,LENGTH=1,PICTURE=1,B'7'
         FD    NAME=C8,LENGTH=1,PICTURE=1,B'8'
         FD    NAME=C9,LENGTH=1,PICTURE=1,B'9'
         FD    NAME=C10,LENGTH=1,PICTURE=2,B'10'
         FD    NAME=C11,LENGTH=1,PICTURE=2,B'11'
         FD    NAME=C12,LENGTH=1,PICTURE=2,B'12'
         FD    NAME=C13,LENGTH=1,PICTURE=2,B'13'
         FD    NAME=C14,LENGTH=1,PICTURE=2,B'14'
         FD    NAME=C15,LENGTH=1,PICTURE=2,B'15'
         FD    NAME=C16,LENGTH=1,PICTURE=2,B'16'
         FD    NAME=C26,LENGTH=1,PICTURE=2,B'26'
         FD    NAME=C91,LENGTH=1,PICTURE=2,B'91'
         FD    NAME=C110,LENGTH=1,PICTURE=3,B'110'
         FD    NAME=C130,LENGTH=1,PICTURE=3,B'130'
         FD    NAME=FA,LENGTH=1,PICTURE=1,'A'
         FD    NAME=FB,LENGTH=2,PICTURE=2,'BC',ACTION=RP
         FD    NAME=FC,LENGTH=3,PICTURE=3,'DEF',ACTION=RP
         FD    NAME=FD,LENGTH=4,PICTURE=4,'GHIJ',ACTION=RP
         FD    NAME=FE,LENGTH=5,PICTURE=5,'KLMNO',ACTION=RP
         FD    NAME=F0,LENGTH=1,PICTURE=1,'0'
         FD    NAME=F1,LENGTH=1,PICTURE=1,'1'
         FD    NAME=F2,LENGTH=2,PICTURE=2,'23',ACTION=RP
         FD    NAME=F3,LENGTH=3,PICTURE=3,'456',ACTION=RP
         FD    NAME=F4,LENGTH=4,PICTURE=4,'7890',ACTION=RP
         FD    NAME=F5,LENGTH=5,PICTURE=5,'12345',ACTION=RP
         CREATE NAME=(JOBNAME,TIMESTP,DATE,SID,USERID,STEPNUM,USERCOMM)
         CREATE NAME=STEPNAME
         CREATE NAME=AUTHOR
         CREATE NAME=(JOBTIME,C1)
         CREATE NAME=(C1,F1)
         CREATE NAME=(STEPTIME,C2)
         CREATE NAME=(C5,FC,F2,C10,F5,FB,F3)
         CREATE NAME=(FLAGS,STEPNUM)
         CREATE NAME=(C0,C0)
         CREATE NAME=(C0,C130,C0,C0,C0,STEPTYPE,TIMESTP,DATE,SID,      *
               JOBNAME,RDSTARTT,RDSTARTD,USERID,C1,STARTIME,STARTDAT,  *
               SYSINCNT,TERMSTAT,STEPPRTY,PROGNAME,STEPNAME,REGSIZE,   *
               COREUSED,COREBRRD,LCSUSED,LCSBRRD,C0,C26,TAPECLAS,      *
               DEVTYPE,ADDR180,EXCPCNT,URECLASS,DEVTYPE,ADDR00E,       *
               EXCPCNT,URECLASS,DEVTYPE,ADDR00C,EXCPCNT,C11,STEPTIME,  *
               C2,C5,FC,F2,C10,F5,F3)
         CREATE NAME=C12
         CREATE NAME=(JOBNAME,TIMESTP,DATE,SID,USERID,STEPNUM,USERCOMM)
         CREATE NAME=STEPNAME
         CREATE NAME=AUTHOR
         CREATE NAME=(JOBTIME,C1)
         CREATE NAME=(C1,F1)
         CREATE NAME=(STEPTIME,C2)
         CREATE NAME=(C5,FC,F2,C10,F5,FB,F3)
         CREATE NAME=(FLAGS,STEPNUM)
         CREATE NAME=(C0,C0)
         CREATE NAME=(C0,C91,C0,C0,C0,JOBTYPE,TIMESTP,DATE,SID,        *
               JOBNAME,RDSTARTT,RDSTARTD,USERID,C2,STARTIME,STARTDAT,  *
               SYSINCNT,TERMSTAT,JOBPRTY,RDRSTOPT,RDRSTOPD,TERMSTAT,   *
               SYSOUTCL,CPRSTART,DEVCLASS,DEVTYPE,JOBINCL,C26,AUTHOR,  *
               CPUTIME,C1,C1,F1)
         CREATE NAME=C16
         END
./       ADD   NAME=USO
         DSD   OUTPUT=(OUTUSO)
         FD    NAME=JOBNAME,LENGTH=8,FILL=X'40',PICTURE=7,'JOBNAME',   *
               ACTION=TR
         FD    NAME=TIMESTP,LENGTH=4,FORMAT=BI,INDEX=10
         FD    NAME=DATE,LENGTH=4,PICTURE=5,P'19968'
         FD    NAME=SID,LENGTH=4,FILL=X'40',PICTURE=2,'SC'
         FD    NAME=USERID,LENGTH=8,FILL=X'40'
         FD    NAME=STEPNUM,LENGTH=4,FORMAT=BI
         FD    NAME=USERCOMM,LENGTH=4,FORMAT=BI,STARTLOC=32
         FD    NAME=C0,LENGTH=1,PICTURE=1,B'0'
         FD    NAME=C1,LENGTH=1,PICTURE=1,B'1'
         FD    NAME=C2,LENGTH=1,PICTURE=1,B'2'
         FD    NAME=C3,LENGTH=1,PICTURE=1,B'3'
         FD    NAME=C4,LENGTH=1,PICTURE=1,B'4'
         FD    NAME=C5,LENGTH=1,PICTURE=1,B'5'
         CREATE NAME=(JOBNAME,TIMESTP,DATE,SID,USERID,C1,USERCOMM)
         CREATE NAME=(JOBNAME,TIMESTP,DATE,SID,USERID,C2,USERCOMM)
         CREATE NAME=(JOBNAME,TIMESTP,DATE,SID,USERID,C3,USERCOMM)
         CREATE NAME=(JOBNAME,TIMESTP,DATE,SID,USERID,C4,USERCOMM)
         CREATE NAME=(JOBNAME,TIMESTP,DATE,SID,USERID,C5,USERCOMM)
         END
./       ENDUP
//TESTING     JOB   MSGLEVEL=1
//JOBLIB DD DSNAME=TESTLIB,VOLUME=SER=231400,UNIT=2314,DISP=(OLD,KEEP) *
//                     *                                               C
//          THIS PROCEDURE WILL EXECUTE TESTEXIT WITH THE SAMPLE SMF   C
//             EXIT ROUTINES.
//       EXEC  PGM=TESTEXIT,PARM='UJV=25,UJI=8,UTL=5,ACT=2'
//INUJV  DD    DSNAME=DGINPUT(UJV),DCB=(LRECL=80,BLKSIZE=400,RECFM=FB),*
//             DISP=(OLD,PASS),UNIT=2314,VOLUME=SER=231400
//INUJI  DD    DSNAME=DGINPUT(UJI),DCB=(LRECL=80,BLKSIZE=400,RECFM=FB),*
//             DISP=(OLD,PASS),UNIT=2314,VOLUME=SER=231400
//INUSI  DD    DSNAME=DGINPUT(USI),DCB=(LRECL=80,BLKSIZE=400,RECFM=FB),*
//             DISP=(OLD,PASS),UNIT=2314,VOLUME=SER=231400
//INUTL  DD    DSNAME=DGINPUT(UTL),DCB=(LRECL=80,BLKSIZE=400,RECFM=FB),*
//             DISP=(OLD,PASS),UNIT=2314,VOLUME=SER=231400
//INACT  DD    DSNAME=DGINPUT(ACT),DCB=(LRECL=80,BLKSIZE=400,RECFM=FB),*
//             DISP=(OLD,PASS),UNIT=2314,VOLUME=SER=231400
//INUSO  DD    DSNAME=DGINPUT(USO),DCB=(LRECL=80,BLKSIZE=400,RECFM=FB),*
//             DISP=(OLD,PASS),UNIT=2314,VOLUME=SER=231400
//OUTUJV DD DSNAME=UJV(OUT),UNIT=2314,DISP=(,PASS),                    *
//             SPACE=(TRK,(10,5,1)),VOLUME=SER=231400,                 *
//             DCB=(LRECL=80,BLKSIZE=400,RECFM=FB)
//OUTUJI DD DSNAME=UJI(OUT),UNIT=2314,DISP=(,PASS),                    *
//             SPACE=(TRK,(10,5,1)),VOLUME=SER=231400,                 *
//             DCB=(LRECL=80,BLKSIZE=400,RECFM=FB)
//OUTUSI DD DSNAME=USI(OUT),UNIT=2314,DISP=(,PASS),                    *
//             SPACE=(TRK,(10,5,1)),VOLUME=SER=231400,                 *
//             DCB=(LRECL=80,BLKSIZE=400,RECFM=FB)
//OUTUTL DD DSNAME=UTL(OUT),UNIT=2314,DISP=(,PASS),                    *
//             SPACE=(TRK,(10,5,1)),VOLUME=SER=231400,                 *
//             DCB=(LRECL=80,BLKSIZE=400,RECFM=FB)
//OUTACT DD DSNAME=ACT(OUT),UNIT=2314,DISP=(,PASS),                    *
//             SPACE=(TRK,(10,5,1)),VOLUME=SER=231400,                 *
//             DCB=(LRECL=130,BLKSIZE=130,RECFM=FB)
//OUTUSO DD DSNAME=USO(OUT),UNIT=2314,DISP=(,PASS),                    *
//             SPACE=(TRK,(10,5,1)),VOLUME=SER=231400,                 *
//             DCB=(LRECL=80,BLKSIZE=400,RECFM=FB)
//MANX DD UNIT=2314,VOLUME=SER=231400,SPACE=(TRK,(3,1)),               *
//             DISP=(NEW,PASS),DCB=(BLKSIZE=144,LRECL=140)
//SYSPRINT DD SYSOUT=A,DCB=(BLKSIZE=136,LRECL=132)
//DGPRINT DD SYSOUT=A
//SYSABEND DD SYSOUT=A

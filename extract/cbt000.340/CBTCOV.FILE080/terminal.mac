         MACRO
&NAME    TERMINAL  &QBY=,&DCB=,&RLN=,&COMP=NO,&TERM=,&QUEUES=,&CALL=,  X
               &ADDR=,&LEVEL=(0),&CLOCK=,&INTVL=,&ALTDEST=,&SECTERM=NO,X
               &BLOCK=,&SUBBLCK=,&TRANSP=,&BUFSIZE=,&BFDELAY=,&OPDATA=,X
               &QS=(DN,DR,TS,MO,MR,MN,34,18,2,66,82,98),&FEATURE=,     X
               &TBLKSZ=,&DIALNO=,&NTBLKSZ=,&CINTVL=,&UTERM=NO,         X
               &DVCID=,&QCNTRL=,&LMD=NO,&CTBMAX=,&MB=NO,               X
               &SCRSIZE=,&GROUP=,&RETRY=,&ACTIVE=,&SPECOUT=,     S22024X
               &GPCLSTR=                                         S22024
         GBLA  &IEDQCH(128),&IEDQAR(64),&IEDQZF
         GBLA  &IEDQRL                                           S22024
         GBLB  &IEDQFL(16),&IEDQZA(64),&IEDQNO,&IEDQIHB(2),&IEDQZZ(16)
         GBLB  &IEDQGP,&IEDQRN(8)                                S22024
         GBLB  &IEDQQEF(8) .                                     S22025
         GBLC  &IEDQAD(5),&IEDQSV(8),&IEDQCTM                   SA57685
         GBLC  &IEDQGN                                           S22024
         LCLA  &A,&S,&L,&P,&LP,&CTBCNT .                         S22025
         LCLB  &NO,&NB,&B(8),&IEDQTAC,&CONC .                    S22025
         LCLB  &GPT,&SPCO,&BFRD                                  S22024
         LCLC  &CHA,&IEDQID(2),&IEDQCTB(2) .                     S22025
         LCLC  &CHB,&CHC,&CHD                                    S22024
.******************* MICROFICHE FLAGS *********************** SUPT CODE
.*   VERSION DATED SEPTEMBER 27, 1972                            S22024
.*
.*C638400,646000,655000                                          S22027
.*A636000-637800                                                 S22027
.*A042000-044400,777500                                          S99528
.*C771700-773100                                                 S99528
.*A043600                                                        S99228
.*C027000,030000,044100,139890-140540,262500,264000,265500       S99228
.*C267000,270000,777000-777500                                   S99228
.*A039000,2888000-XXXXXX,669600-671400                           S22029
.*C023400,261000-266500,285000,312000,780000                     S22029
.*D041000,300000-306000,669600-671400                            S22029
.*A019000,022000,127000-128000,138020-139840,152000-155400       S22025
.*A184000,196000,199000,202000-203000,246000-259800,310000       S22025
.*A475200-476960,582500-583000,595000,621200-622600,658000       S22025
.*A706000,712000                                                 S22025
.*C021000,162000,201000                                          S22025
.*C030000-030800,138000,150000-151000,174000-175000              S22025
.*C189000-192600,300000-301000,339000-350200,576000-578200       S22025
.*C591000,627000,633000,645000-646000,654000-655000,669000       S22025
.*C738000,768000-770200                                          S22025
.*D033000-039000                                                 S22025
.*A474000                                                        A50220
.*A042000                                                        A47143
.*C738000                                                        A47143
.*C747000                                                        S21101
.*C108000-114000                                                 A42365
.*C474000                                                       SA56918
.*C381000,384000                                                SA50203
.*A594000                                                       SA50203
.*C738000                                                        A52954
.*C043200,044160-044260,384700,594400                           SA56318
.*C030200,030826-041500,771000     SEE IEDQCKO/IEDQGCH          SA57685
.*D022000,030850,042000,706000,712000,                          SA57685
.*C021000,030820,147000,159000,165000,171000,186000              S22024
.*C189000-192000,193200-194400,194640-194760,204000-207000       S22024
.*C282000,576000,579000,594000,642000,651000,657000-663000       S22024
.*C669000,594200                                                 S22024
.*A024000,027000,030200,030600,128000,396000,399000,637800       S22024
.*A696000,699000                                                 S22024
.*A246000                                                      SA66363
.*C594000                                                       OX01432
.*D585000                                                       OX01432
.*A475200                                                       SA66922
.*C475200                                                       SA66922
.*C475200                                                       OY04887
.*A657050                                                      @XA09782
.*C285000,290000                                               @SA75764
.*C171000                                                      @OY11968
.*C657070                                                      @OS76680
.**********************************************************************
         AIF   (NOT &IEDQZA(21)).GO                              S99228
         MNOTE 12,'*** IED901 ALL TERMINAL MACROS MUST PRECEDE TSINPUT'
.GO      AIF   ('&TERM' EQ '').COK .                             S99228
         AIF   ('&SECTERM' NE 'YES' OR '&TERM'(4,1) NE 'C').COK  S99228
         AIF   ('&TERM'(1,4) EQ '274C').COK                      S99228
         MNOTE 12,'*** IED902 TYPE=&TERM AND SECTERM=YES ARE MUTUALLY E*
               XCLUSIVE'                                        SA56318
.COK     ANOP  .                                                 S99228
         AIF   ('&UTERM' EQ 'NO').A1
&IEDQSV(4) SETC '&SYSECT'
.A1      AIF   (&IEDQAR(10) EQ 0).C0
         AIF   (&IEDQAR(10) EQ 3 AND '&NAME' EQ '&IEDQSV(1)').OPT
         IEDQGCH 3
.C0      AIF   (&IEDQZA(55)).C1
         AIF   ('&IEDQZA(54)' EQ '&IEDQZA(55)' AND '&IEDQZA(53)'       X
               EQ '&IEDQZA(55)').A3
         MNOTE 12,'***IHB315 SEQUENCE ERROR-MUST PRECEDE LAST ENTRY    X
               SPEC. BY TTABLE MACRO'
         AGO   .A4
.A3      MNOTE 12,'***  IHB070 SEQUENCE ERROR-MUST FOLLOW TTABLE MACRO'
.A4      ANOP
&IEDQNO  SETB  1
.C1      AIF   ('&NAME' NE '').C1A
         MNOTE 12,'*** IHB076 MACRO NAME FIELD BLANK- NAME REQUIRED'
&IEDQNO  SETB  1
.C1A     AIF   (K'&NAME LE &IEDQAR(1)-3).C1B
&S       SETA  &IEDQAR(1)-3
         MNOTE 4,'*** IHB302 NAME FIELD LONG- TRUNCATED TO &S CHARACTER*
               S'
.C1B     AIF   ('&UTERM' EQ 'NO').C1F
         AIF   (('&LEVEL' NE '(0)') OR ('&CLOCK' NE '') OR             *
               ('&COMP' NE 'NO') OR ('&CALL' NE '') OR                 *
               ('&DIALNO' NE '')).C1Z                            A42365
         AIF   ('&INTVL' NE '' OR '&CINTVL' NE '' OR '&ALTDEST' NE     X
               '' OR '&SECTERM' NE 'NO' OR '&BLOCK' NE '').C1Z
         AIF   ('&SUBBLCK' NE '' OR '&NTBLKSZ' NE '' OR '&TRANSP' NE   X
               '' OR '&TBLKSZ' NE '' OR '&BFDELAY' NE '').C1Z
         AIF   ('&QCNTRL' NE '' OR '&LMD' NE 'NO' OR '&DVCID' NE '' OR X
               '&CTBMAX' NE '' ).C1Z .                           S22025
         AIF   ('&GPCLSTR' NE '').C1Z                            S22024
         AIF   ('&COMP' EQ 'NO' OR '&GROUP' NE '').C2A           S22024
         AGO   .C1F
.C1Z     MNOTE 12,'***IHB342 INVALID OPERANDS SPECIFIED'
         AGO   .C5M
.C1F     AIF   ('&DVCID' EQ '').TERM .                           S22025
         AIF   (&IEDQZA(13)).CSPEC .                             S22025
         MNOTE 8,'*** IHB233 INCONSISTENT WITH FEATURE OPERAND OF THE IX
               NTRO MACRO' .                                     S22025
&IEDQNO  SETB  1 .                                               S22025
.CSPEC   AIF   ('&BFDELAY' EQ '' AND '&DIALNO' EQ '' AND '&CALL' EQ '' X
               AND '&INTVL' EQ '' AND '&CINTVL' EQ '' AND '&CLOCK' EQ  X
               '').CHKDID .                                      S22025
&IEDQNO  SETB  1 .                                               S22025
         MNOTE 12,'*** IHB342 INVALID OPERANDS SPECIFIED' .      S22025
.CHKDID  AIF   ('&DVCID(1)' NE 'CONC').TAC .                     S22025
&IEDQID(1)  SETC  '&DVCID(1)' .                                  S22025
&IEDQAR(46) SETA 254 .                                           S22025
&IEDQFL(9) SETB 0 .                                              S22025
&CONC    SETB  1 .                                               S22025
&IEDQAR(47) SETA 1 .                                             S22025
&IEDQQEF(3) SETB 0 .                                             S22025
         AIF   ('&QUEUES' EQ '' AND '&LEVEL' EQ '(0)' AND '&ALTDEST'   X
               EQ '' AND '&SECTERM' EQ 'NO' ).NONERR .           S22025
         AGO   .ANERR .                                          S22025
.NONERR  AIF   ('&COMP' EQ 'NO' AND '&LMD' EQ 'NO' AND '&QCNTRL' EQ    X
               '' AND '&MB' EQ 'NO' ).CHKCONC .                  S22025
.ANERR   MNOTE 12,'*** IHB342 INVALID OPERANDS SPECIFIED' .      S22025
&IEDQNO  SETB  1 .                                               S22025
.CHKCONC AIF   ('&QBY' EQ 'T').QBYCHK                            S22025
&IEDQNO  SETB  1 .                                               S22025
         AIF   ('&QBY' NE '' ).QBYO .                            S22025
         MNOTE 12,'*** IHB001 QBY OPERAND REQ''D- NOT SPECIFIED' S22025
         AGO   .QBYCHK .                                         S22025
.QBYO    MNOTE 12,'*** IHB002 INVALID QBY OPERAND SPECIFIED- &QBY'
.*                                                               S22025
.QBYCHK  AIF   (N'&DVCID EQ 1 ).VID .                            S22025
         AIF   ( N'&DVCID EQ 2).SCC .                            S22025
&IEDQNO  SETB  1 .                                               S22025
.DVCERR  MNOTE 12,'*** IHB002 INVALID DVCID OPERAND SPECIFIED- &DVCID'
.*                                                               S22025
.SCC     AIF   ('&DVCID(2)' EQ '' ).VID .                        S22025
DVCID    IEDQCKO &DVCID(2),,31,R=(1,8) .                         S22025
.VID     ANOP .                                                  S22025
&IEDQAR(47) SETA &IEDQAR(47)+3 .                                 S22025
&CTBCNT  SETA  0 .                                               S22025
         AIF   ('&CTBMAX' EQ '').CONCSET .                       S22025
         AIF   ( T'&CTBMAX EQ 'N' AND '&CTBMAX' GE '1' AND '&CTBMAX'   X
               LE '255').CTBOK .                                 S22025
         MNOTE 12,'*** IHB002 INVALID CTBMAX OPERAND SPECIFIED- &CTBMAXX
               '                                                 S22025
&IEDQNO  SETB  1 .                                               S22025
         AGO   .CONCSET .                                        S22025
.CTBOK   ANOP .                                                  S22025
&CTBCNT  SETA  &CTBMAX .                                         S22025
.CONCSET AIF   (&IEDQNO).C2A .                                   S22025
&IEDQFL(9) SETB 1 .                                              S22025
         AGO   .C2A .                                            S22025
.TAC     AIF   ( &IEDQFL(9) ).CDEF .                             S22025
&IEDQAR(47) SETA 4 .                                             S22025
         MNOTE 12,'*** IHB070 SEQUENCE ERROR- MUST FOLLOW CONC TERMINALX
                MACRO' .                                         S22025
&IEDQNO  SETB  1 .                                               S22025
.CDEF    ANOP .                                                  S22025
&IEDQTAC   SETB 1 .                                              S22025
         AIF   ('&QBY' EQ '' AND '&CTBMAX' EQ '' ).ATTOK .       S22025
&IEDQNO  SETB  1 .                                               S22025
         MNOTE 12,'*** IHB342 INVALID OPERANDS SPECIFIED' .      S22025
.ATTOK   AIF   ('&DVCID(1)' NE 'FF' AND N'&DVCID EQ 1).IDFINE .  S22025
&IEDQNO  SETB  1 .                                               S22025
         MNOTE 12,'*** IHB002 INVALID DVCID OPERAND SPECIFIED- &DVCID'
.*                                                               S22025
.IDFINE  ANOP .                                                  S22025
&IEDQID(1) SETC 'FF' .                                           S22025
         AIF   ('&DVCID(1)' EQ 'NONE').TERM2 .                   S22025
&LP      SETA  K'&DVCID .                                        S22025
         AIF   ((K'&DVCID(1)/2)*2 EQ K'&DVCID(1)).IDC .          S22025
         MNOTE 4,'*** IHB154 DEVICE ID NOT MULT. OF 2, POSSIBLE ERROR'
.*                                                               S22025
.IDC     AIF   ((K'&DVCID(1)+1)/2 LE &IEDQAR(47)-3).IDOK .       S22025
&LP      SETA  &IEDQAR(47)-3 .                                   S22025
         MNOTE 4,'*** IHB302 DEVICE ID TOO LONG - TRUNCATED TO &LP CHARX
               '                                                 S22025
&LP      SETA  &LP*2 .                                           S22025
.IDOK    ANOP .                                                  S22025
&L       SETA  0 .                                               S22025
         AIF   ( &LP LE 8).FIRP .                                S22025
&L       SETA  &LP-8 .                                           S22025
&IEDQID(2) SETC '&DVCID'(9,&L) .                                 S22025
.FIRP    ANOP .                                                  S22025
&IEDQID(1) SETC '&DVCID'(1,&LP-&L) .                             S22025
         AGO   .TERM2 .                                          S22025
.TERM    AIF   ('&QCNTRL' EQ '' AND '&CTBMAX' EQ '').TERM3 .     S22025
         MNOTE 12,'*** IHB342 INVALID OPERANDS SPECIFIED' .      S22025
&IEDQNO  SETB  1 .                                               S22025
.TERM3   ANOP .                                                  S22025
&IEDQFL(9) SETB 0 .                                              S22025
.TERM2   ANOP                                                    S99228
         AIF   ('&TERM' EQ '').D1 .                              S99228
         AIF   ('&TERM'(1,4) EQ '367C' OR '&TERM'(1,4) EQ '274C').D1
         AIF   ('&ADDR' EQ '' OR ('&ADDR' NE '' AND '&TERM'(4,1) NE    X
               'C')).D1                                          S99228
&IEDQNO  SETB  1                                                 S99228
         MNOTE 12,'*** IHB346 ADDR AND TERM=&TERM MUTUALLY EXCLUSIVE'
.D1      ANOP                                                    S99228
         AIF   ('&COMP' EQ 'NO').C2A                             S99228
         AIF   ( '&GROUP' NE '' ).C2A .                          S22024
         AIF   ('&UTERM' EQ 'NO' AND '&COMP' EQ 'YES').C2B
         MNOTE 12,'***  IHB002 COMP OPERAND SPECIFIED &COMP'
.C2A     AIF   ('&DCB' NE '' AND '&GROUP' NE '').CR2  ERROR      S22024
         AIF   ('&DCB' EQ '' AND '&GROUP' EQ '').CR1  ERROR      S22024
         AIF   ('&DCB' EQ '').CR4                                S22024
&CHB     SETC  '&DCB'                                            S22024
&CHC     SETC  'DCB'                                             S22024
&IEDQFL(12) SETB 0                                               S22024
         AIF   ('&ACTIVE' EQ '' AND '&SPECOUT' EQ '' AND               *
               '&GPCLSTR' EQ '').CR5                             S22024
         MNOTE 4,'***  IED910  3705-ONLY OPERAND SPECIFIED ON NON-3705 *
               TERMINAL ENTRY'                                   S22024
         AGO   .CR5                                              S22024
.CR4     ANOP                                                    S22024
&CHB     SETC  '&GROUP'                                          S22024
&CHC     SETC  'GROUP'                                           S22024
&IEDQFL(12) SETB 1                                               S22024
         AIF   (NOT &IEDQRN(1)).CR4A                             S22024
.CR5     ANOP                                                    S22024
         AIF   ('&UTERM' NE 'NO' AND '&UTERM' NE 'YES' AND '&UTERM'    *
               NE 'IDLE').CR6                                    S22024
         AIF   ('&UTERM' EQ 'IDLE' AND (NOT &IEDQFL(12))).CR6    S22024
         AIF   (&IEDQFL(12) AND '&QBY' NE 'T' AND '&UTERM' EQ 'NO'     *
               ).CR6B                                            S22024
         AGO   .CR7                                              S22024
.CR4A    MNOTE 12,'***  IED911  GROUP=&GROUP MUST FOLLOW INTRO MACRO WIX
               TH FEATURE=(,,,,MIXD3705/ONLY3705) OPERAND'       S22024
&IEDQNO  SETB  1                                                 S22024
         AGO   .CR7                                              S22024
.CR6     MNOTE 12,'***  IHB002  UTERM OPERAND INCORRECTLY SPECIFIED'
         AGO   .CR6C                                             S22024
.CR6B    MNOTE 12,'***  IHB002  INVALID QBY OPERAND SPECIFIED- &QBY'
.CR6C    ANOP                                                    S22024
&IEDQNO  SETB  1                                                 S22024
.CR7     ANOP                                                    S22024
         AIF   ('&TERM' EQ '' AND '&GROUP' EQ '').CR1  ERROR     S22024
         AIF   ('&RLN' EQ '' AND (NOT &IEDQFL(12))).CR1          S22024
         AIF   ('&RLN' EQ '' AND '&UTERM' EQ 'NO').CR1           S22024
         AGO   .C1C                                              S22024
.CR2     MNOTE 12,'***  IHB346  DCB AND GROUP MUTUALLY EXCLUSIVE'
         AGO   .C5M                                              S22024
.CR1     ANOP                                                    S22024
         AIF   (&IEDQTAC).C2B .                                  S22025
         AIF   ('&DCB' NE '').CHKRLN .                           S22025
&IEDQNO  SETB  1 .                                               S22025
         MNOTE 12,'*** IHB001 DCB OPERAND REQ''D- NOT SPECIFIED' S22025
.CHKRLN  AIF   ('&RLN' NE '' ).C1C .                             S22025
         MNOTE 12,'*** IHB001 RLN OPERAND REQ''D- NOT SPECIFIED' S22025
&IEDQNO  SETB  1 .                                               S22025
         AGO   .C2B .                                            S22025
.C1C     ANOP
         AIF   ('&UTERM' EQ 'NO').GA1                            S22024
         AIF   (&IEDQFL(12) AND (NOT &IEDQGP)).GA5               S22024
         AIF   (NOT &IEDQFL(12)).GA6                             S22024
         AIF   ('&GROUP' NE '&IEDQGN').GA5                       S22024
.GA9     AIF   (NOT &IEDQFL(12)).GA6                             S22024
         AIF   ('&RLN' EQ '').GA2                                S22024
         AIF   (&RLN NE &IEDQRL).GA7                             S22024
.GA2     ANOP                                                    S22024
&CHD     SETC  '&IEDQRL'                                         S22024
&IEDQRL  SETA  &IEDQRL+1                                         S22024
         AGO   .GA3                                              S22024
.GA5     MNOTE 12,'***  IED912  SEQUENCE ERROR-MUST FOLLOW APPROPRIATE *
               GROUP MACRO'                                      S22024
&IEDQNO  SETB  1                                                 S22024
         AGO   .GA9                                              S22024
.GA7     MNOTE 12,'***  IED913  RLN OPERAND INCORRECTLY SPECIFIED'
&IEDQNO  SETB  1                                                 S22024
         AGO   .GA6                                              S22024
.GA1     ANOP                                                    S22024
&IEDQGP  SETB  0                                                 S22024
.GA6     ANOP                                                    S22024
&A       SETA  &RLN                                              S22024
&CHD     SETC  '&A'                                              S22024
.GA3     ANOP                                                    S22024
&A       SETA  &CHD                                              S22024
         AIF   (&A LE 255).C2B .                                 S22025
         MNOTE 12,'***  IHB002  RLN OPERAND SPECIFIED-&CHD'      S22024
&IEDQNO  SETB  1
.C2B     AIF   ('&TERM' NE '').C2                              @OY11968
         AIF   ('&UTERM' EQ 'YES' OR '&UTERM' EQ 'IDLE'                X
               AND (&IEDQFL(12))).C2                           @OY11968
         MNOTE 12,'*** IHB001 TERM OPERAND REQ''D- NOT SPECIFIED'
.*                                                               S22025
&IEDQNO  SETB  1 .                                               S22025
         AGO   .C5M
.C2      ANOP
&A       SETA  0
         AIF   (&IEDQTAC).TERM5 .                                S22025
         AIF   ('&COMP' EQ 'NO' ).C3A .
         AIF   ( NOT &IEDQFL(12) ).TERM5 .                       S22024
         MNOTE 12,'*** IHB002 INVALID COMP OPERAND SPECIFIED- &COMP'
.*                                                               S22024
&IEDQNO  SETB  1 .                                               S22024
.TERM5   AIF   ('&CHB' EQ '' AND '&CHD' EQ '').BOPS              S22024
         AIF   ('&CHB' EQ '&IEDQSV(6)').BOPSA                    S22024
&IEDQNO  SETB  1 .                                               S22025
         MNOTE 12,'*** IHB002 INVALID DCB OPERAND SPECIFIED- &CHB'
.*                                                               S22024
.BOPSA   AIF   ('&CHD' EQ '&IEDQSV(8)').BOPS                     S22024
&IEDQNO  SETB  1 .                                               S22025
         MNOTE 12,'*** IHB002 INVALID RLN OPERAND SPECIFIED- &CHD'
.*                                                               S22024
         AIF   (&IEDQTAC).C3A .                                  S22025
         MNOTE 12,'*** IHB002 DCB AND RLN OPERANDS INCORRECTLY SPEC'
         AGO   .C5M
.BOPS    AIF   ( NOT &IEDQTAC).C6 .                              S22025
.C3A     AIF   (&CONC).C4B .                                     S22025
         AIF   ('&QUEUES' NE '').C4 .                            S22025
         AIF   (&IEDQFL(12) AND '&UTERM' NE 'NO').QCB            S22024
         AIF   ( &IEDQTAC).TAC11 .                               S22025
         AIF   ('&QBY' EQ 'L' AND '&CHB' EQ '&IEDQSV(6)' AND           *
               '&CHD' EQ '&IEDQSV(8)').C4B                       S22024
         MNOTE 12,'***  IHB001 QUEUES OPERAND REQ''D NOT SPECIFIED'
         AGO   .C5M
.INX     MNOTE 12,'*** IHB002 MSUNITS OPERAND SPECIFIED- 0'
.IN      MNOTE 12,'***  IHB002  QUEUES OPERAND SPECIFIED- &QUEUES'
.C5M     ANOP
&IEDQNO  SETB  1
         AIF   ('&UTERM' EQ 'NO').C5
         AGO   .EXIT
.C4      AIF   (&A GT 5 OR K'&QUEUES GT 3 OR K'&QUEUES LT 2).IN  S22029
         AIF   (&A GT 2 AND NOT &IEDQZA(42)).INX
&A       SETA  &A+1
         AIF   ('&QUEUES'(1,2) NE '&QS(&A)').C4
&A       SETA  &QS(&A+6)
         AIF   ('&QUEUES'(1,2) EQ 'TS' AND '&SECTERM' EQ 'YES').C4A
.*                                                             SA66363
         AGO   .C4Z                                             SA66363
.C4A     MNOTE 12,'*** IHB346 QUEUES=TS AND SECTERM=YES MUTUALLY EXCLUS*
               IVE'
.*                                                             SA66363
.C4Z     ANOP                                                   SA66363
         AIF   ( NOT &IEDQTAC ).QEND .                           S22025
         AIF   ('&QCNTRL' NE '').QC1 .                           S22025
         MNOTE 12,'*** IHB001 QCNTRL OPERAND REQ''D- NOT SPECIFIED'
.*                                                               S22025
&IEDQNO  SETB  1 .                                               S22025
         AGO   .QEND .                                           S22025
.TAC11   AIF   ('&QCNTRL' EQ '' ).C6 .                           S22025
&IEDQNO  SETB 1 .                                                S22025
         MNOTE 12,'*** IHB001 QUEUES OPERAND REQ''D NOT SPECIFIED'
.*                                                               S22025
         AIF   ('&DCB' NE '' AND '&RLN' NE '' ).QC1 .            S22025
         MNOTE 12,'*** IHB004 REQUIRED OPERAND(S) NOT SPECIFIED' S22025
&IEDQNO  SETB  1 .                                               S22025
         AGO   .C4B .                                            S22025
.QC1     ANOP .                                                  S22025
&IEDQQEF(1) SETB 0 .                                             S22025
&IEDQQEF(2) SETB 0 .                                             S22025
&IEDQQEF(3) SETB 0 .                                             S22025
&IEDQAR(48) SETA 1 .                                             S22025
&IEDQCTB(1)  SETC  'FF' .                                        S22025
&L       SETA  1 .                                               S22025
         AIF ( '&QCNTRL(1)' EQ '').Q4 .                          S22025
         AIF   ( T'&QCNTRL(1) NE 'N').Q2 .                       S22025
&IEDQQEF(2) SETB 1 .                                             S22025
QCNTRL   IEDQCKO &QCNTRL(1),,32,R=(1,32767) .                    S22025
         AGO   .Q4 .                                             S22025
.Q2      ANOP .                                                  S22025
&LP      SETA  K'&QCNTRL(1) .                                    S22025
         AIF   ( &LP NE 3).Q3 .                                  S22025
&CHA     SETC  '&QCNTRL(1)' .                                    S22025
         AIF   ( '&CHA' EQ 'MSG').Q4 .                           S22025
         AIF   ('&CHA' NE 'ALL').Q7 .                            S22025
&IEDQAR(48) SETA 0 .                                             S22025
         AGO  .Q4 .                                              S22025
.Q7      MNOTE 12,'*** IHB002 INVALID QCNTRL OPERAND SPECIFIED- &QCNTRLX
               (&L)' .                                           S22025
&IEDQNO  SETB  1 .                                               S22025
         AGO   .QEND .                                           S22025
.Q3      AIF   ('&QCNTRL(1)'(1,1) NE '(' OR '&QCNTRL(1)'(&LP,1) NE     X
               ')' ).Q7 .                                        S22025
         AIF   ( '&QCNTRL(1)'(2,3) NE 'MSG' ).Q7 .               S22025
         AIF   ( &LP    EQ 5).Q4 .                               S22025
         AIF   ( '&QCNTRL(1)'(5,1) NE ',' ).Q7 .                 S22025
         AIF   ( &LP    EQ 6).Q4 .                               S22025
&CHA     SETC  '&QCNTRL(1)'(6,&LP-6) .                           S22025
QCNTRL   IEDQCKO &CHA,,32,R=(1,255) .                            S22025
.Q4      AIF   ( N'&QCNTRL EQ &L).QEND .                         S22025
&L       SETA  &L+1 .                                            S22025
         AIF   ( '&QCNTRL(&L)' EQ '' ).QL1 .                     S22025
         AIF   ( '&QCNTRL(&L)' NE 'L' ).Q7 .                     S22025
         AIF   ( &IEDQAR(48) NE 1 ).Q7 .                         S22025
&IEDQQEF(3) SETB 1 .                                             S22025
.QL1     AIF   ( N'&QCNTRL EQ &L ).QEND .                        S22025
&L       SETA  &L+1 .                                            S22025
         AIF   ( '&QCNTRL(&L)' EQ '').Q5 .                       S22025
         AIF   ( '&QCNTRL(&L)'  NE 'STATUS').Q7 .                S22025
         AIF   ( &IEDQQEF(2)  EQ 0 AND &IEDQAR(48) NE 1).Q7 .    S22025
&IEDQQEF(1)  SETB 1 .                                            S22025
.Q5      AIF   ( N'&QCNTRL EQ &L).QEND .                         S22025
&L       SETA  &L+1 .                                            S22025
         AIF   ( '&QCNTRL(&L)' EQ '').QEND .                     S22025
         AIF   ( K'&QCNTRL(&L)/2  GT 8).Q7 .                     S22025
         AIF   ((K'&QCNTRL(&L)/2)*2 EQ K'&QCNTRL(&L)).Q8 .       S22025
         MNOTE 4,'*** IHB154 CTB CHAR. NOT A MULT. OF 2, POSSIBLE ERRORX
               ' .                                               S22025
.Q8      ANOP .                                                  S22025
&LP      SETA  0 .                                               S22025
         AIF   (K'&QCNTRL(&L) LT 8).CTB1 .                       S22025
&IEDQCTB(2) SETC '&QCNTRL(&L)'(9,K'&QCNTRL(&L)-8) .              S22025
&LP      SETA  K'&QCNTRL(&L)-8 .                                 S22025
.CTB1    ANOP .                                                  S22025
&IEDQCTB(1) SETC '&QCNTRL(&L)'(1,K'&QCNTRL(&L)-&LP) .            S22025
.QEND    ANOP .                                                  S22025
         AIF   (K'&QUEUES EQ 2).TSO0010                          S22029
         AIF   ('&QUEUES'(3,1) NE 'T').IN                        S22029
         AIF   ('&QUEUES'(1,2) EQ 'TS').IN                       S22029
&IEDQZZ(8) SETB 1                                                S99228
         AGO   .TSO0020                                          S22029
.TSO0010 ANOP                                                    S22029
&IEDQZZ(8) SETB ('&QUEUES' EQ 'TS')                              S99228
.TSO0020 ANOP                                                    S22029
&IEDQZA(17) SETB ('&QUEUES'(1,2) NE 'TS')                        S22029
         AIF   (NOT &IEDQZZ(8)).TSO0030                          S99228
&A       SETA  &A+128                                            S22029
.TSO0030 ANOP                                                    S22029
         AIF   (&IEDQZZ(8) AND &IEDQZA(51)).C4B                  S99228
         AIF   ((NOT &IEDQZZ(8)) AND &IEDQZA(52)).C4B            S99228
         MNOTE 12,'***  IHB110  QUEUES=&QUEUES MUST FOLLOW INTRO MACRO -
               WITH APPROPRIATE ENVIRON OPERAND'                    TSO
&IEDQNO  SETB  1
.C4B     AIF   ('&UTERM' EQ 'YES' OR '&UTERM' EQ 'IDLE').QCB     S22024
         AIF   (&IEDQZZ(8) AND '&QBY' EQ 'L').C5A              @SA75764
.C5      AIF   (&IEDQFL(9) OR &CONC OR &IEDQTAC ).C5B .          S22029
         AIF   ( '&QBY' EQ 'T' OR '&QBY' EQ 'L').C5B .           S22029
.C5A     MNOTE 12,'***  IHB002  QBY OPERAND SPECIFIED &QBY'      S22029
&NO      SETB  1                                                 S22029
.C5B     AIF   ('&QUEUES' EQ 'TS' AND '&LEVEL' NE '(0)').C4D   @SA75764
         AGO   .C6                                               S22029
.C4D     MNOTE 8,'*** IHB314 LEVEL=&LEVEL INVALID WITH QUEUES=TS. IGN  X
               ORED'                                                TSO
         AGO   .C8                                                  TSO
.C6      ANOP
&L       SETA  0 .                                               S22025
.C7      ANOP                                                    S22029
         AIF   (&L+1 GT N'&LEVEL-1).C8
&L       SETA  &L+1
         AIF   ('&LEVEL(&L+1)' GT '&LEVEL(&L)').C7
         MNOTE 12,'*** IHB002 LEVEL OPERAND SPECIFIED &LEVEL(&L)'
&NO      SETB  1
         AGO   .C7
.NAL     DC    AL2(0) .                 NO ALTERNATE DESTINATION
         AGO   .ST
.CKT     AIF   ( '&QBY' NE 'T' AND NOT &IEDQFL(9)).NQ .          S22025
         AIF   ( &IEDQFL(9) AND NOT &IEDQTAC).QCB .              S22025
         AIF   ( NOT &IEDQTAC ).SCB1 .                           S22025
         AIF   ('&COMP' EQ 'NO').SCB2 .                          S22025
&NO      SETB  1 .                                               S22025
         AGO   .SCB1 .                                           S22025
.SCB2    AIF   ('&QCNTRL' EQ '').SCB1 .                          S22025
&L       SETA  1 .                                               S22025
.SCB1    AIF   ( NOT &IEDQFL(7) AND NOT &IEDQFL(10)).QCB .       S22025
&L       SETA  &L+1 .                                            S22025
         AIF   ('&QCNTRL' NE '' OR NOT &IEDQTAC).QCB .           S22025
&NO      SETB  1 .                                               S22025
         AGO   .QCB .                                            S22025
.C8      ANOP
&IEDQSV(4) SETC '&SYSECT'
         IEDQCHI &TERM,&FEATURE
.C9      AIF   ('&SECTERM' EQ 'NO').C10
&B(8)    SETB  1
         AIF   ('&SECTERM' EQ 'YES').C10
         MNOTE 12,'***  IHB002  SECTERM OPERAND SPECIFIED- &SECTERM'
&NO      SETB  1
.C10     ANOP
BUFSIZE  IEDQCKO  &BUFSIZE,,1,R=(36,65535)
         AIF   ('&DIALNO' EQ '').MAC1                           SA50203
         AIF   (&IEDQZA(60) EQ 0).MAC2                          SA50203
         MNOTE 12,'*** IED903 FEATURE=NODAIL SPECIFIED ON INTRO'
.*                                                              SA50203
         AGO   .MAC3                                            SA50203
.MAC1    ANOP
CALL     IEDQCKO  &CALL,NONE,2
         AGO   .MAC3
.MAC2    ANOP
         AIF   ('&DIALNO' EQ 'REMOTE').MAC2A                     S22024
DIALNO   IEDQCKO &DIALNO,NONE,2
         AGO   .MAC3                                             S22024
.MAC2A   ANOP                                                    S22024
DIALNO   IEDQCKO F,,2                                            S22024
.MAC3    ANOP
ADDR     IEDQCKO  &ADDR,,3,C=1
         AIF   ('&NTBLKSZ(1)' EQ '' AND '&BLOCK' NE '').MAC4
         AGO   .MAC5
.MAC4    ANOP
BLOCK  IEDQCKO  &BLOCK,,4,R=(1,65535)
         AGO   .TEST6
.MAC5    ANOP
NTBLOCK  IEDQCKO &NTBLKSZ(1),,4,R=(1,65535)
.TEST6   AIF   ('&NTBLKSZ(2)' EQ '' AND '&SUBBLCK' NE '').MAC7
         AGO   .MAC8
.MAC7    ANOP
SUBBLCK IEDQCKO &SUBBLCK,,5,R=(1,255)
         AGO   .TEST7
.MAC8    ANOP
NTSUBLK  IEDQCKO &NTBLKSZ(2),,5,R=(1,255)
.TEST7   AIF   ('&TBLKSZ' EQ '' AND '&TRANSP' NE '').MAC9
         AGO   .MAC10
.MAC9    ANOP
TRANSP  IEDQCKO &TRANSP,,6,R=(1,65535)
         AGO   .MAC11
.MAC10   ANOP
TBLKSZ   IEDQCKO &TBLKSZ,,6,R=(1,65535)
.MAC11   ANOP
BFDELAY  IEDQCKO &BFDELAY,,7,R=(0,65535)                        SA56918
         AIF   ('&BFDELAY' EQ '' ).CHKDONE .                     A50220
         AIF   ('&CALL' EQ '' AND '&DIALNO' EQ '' ).CHKDONE .    A50220
&IEDQNO  SETB  1 .                                               A50220
         AIF   ( '&DIALNO' EQ '' AND '&CALL' NE '' ).CHKCALL .   A50220
         MNOTE 12,'*** IHB346 DIALNO AND BFDELAY MUTUALLY EXCLUSIVE'
.*                                                               A50220
         AGO   .CHKDONE .                                        A50220
.CHKCALL MNOTE 12,'*** IHB346 CALL AND BFDELAY MUTUALLY EXCLUSIVE'
.*                                                               A50220
.CHKDONE ANOP .                                                  A50220
SCRSIZE  IEDQCKO &SCRSIZE,,8,R=(1,255)                              TSO
LMD      IEDQCKO  &LMD,NO,10 .                                   S22025
         AIF   ( '&MB' EQ 'NO' ).SKPMB .                         S22025
MB       IEDQCKO &MB,NO,10 .                                     S22025
.SKPMB   AIF   (&IEDQTAC OR &IEDQFL(12)).LMDOK                  OY04887
&IEDQFL(10) SETB  0                                             SA66922
.LMDOK   ANOP                                                   SA66922
RETRY    IEDQCKO &RETRY,,11,R=(1,255)                            S22025
         AIF   ('&RETRY' NE '' AND '&CINTVL' EQ '' AND '&CLOCK' EQ '').X
               RETERR                                            S22025
         AGO   .NORTERR                                          S22025
.RETERR  ANOP                                                    S22025
         MNOTE 12,'*** IHB232 CLOCK= OR CINTVL= REQD WHEN RETRY SPECIFIX
               ED'                                               S22025
&IEDQNO  SETB  1                                                 S22025
.NORTERR ANOP                                                    S22025
         AIF   ('&LMD' EQ 'NO' AND '&MB' EQ 'NO').NOLMD          S22025
&IEDQFL(7)  SETB 1                                               S22025
.NOLMD   ANOP                                                    S22025
&L       SETA  0
         AIF   ('&CLOCK' EQ '' AND '&INTVL' EQ '' AND '&CINTVL' EQ     X
               '').QOK
         AIF   ('&CALL' NE '' OR ('&DIALNO' NE '' AND '&DIALNO' NE     C
               'NONE')).NOCLL                                   SA57695
         MNOTE 12,'*** IHB345 DIALNO= REQD WHEN CINTVL OR CLOCK SPECIFI*
               ED'
         AGO   .EXIT
.NOCLL   AIF   ('&CLOCK' EQ '' OR ('&INTVL' EQ '' AND '&CINTVL' EQ ''))X
               .CLOC
         MNOTE 12,'*** IHB346 CLOCK AND CINTVL MUTUALLY EXCLUSIVE'
         AGO   .EXIT
.CLOC    AIF   ('&CLOCK' EQ '').INOK
         AIF   ('&CLOCK' LT '1' OR '&CLOCK' GT '2359').CLER
&B(6)    SETB  1
&P       SETA  0
&CHA     SETC  '&CLOCK'
         AIF   (K'&CLOCK LE 2).NOH
&CHA     SETC  '&CLOCK'(1,K'&CLOCK-2)
&P       SETA  &CHA*3600
&CHA     SETC  '&CLOCK'(K'&CLOCK-1,2)
.NOH     ANOP
&P       SETA  (&P+(&CHA*60))/2
         AGO   .QOK
.CLER    MNOTE 12,'*** IHB002  CLOCK OPERAND SPECIFIED- &CLOCK'
         AGO   .EXIT
.INOK    ANOP
&P       SETA  0
         AIF   ('&INTVL' EQ '').QOL
&P       SETA  &INTVL
         AGO   .QOK
.QOL     AIF   ('&CINTVL' EQ '').QOK
&P       SETA  &CINTVL
.QOK     AIF   (&NO OR &IEDQNO).EXIT
&IEDQZA(54) SETB 1
         AIF   ('&COMP' EQ 'YES' AND NOT &IEDQTAC ).NQ
         AIF   (&IEDQTAC AND '&QCNTRL' EQ '' AND '&LMD' EQ 'NO' AND    X
               '&MB' EQ 'NO' ).NQ .                              S22025
         AIF   (&IEDQTAC AND '&CHB' EQ '' AND '&CHD' EQ '').CKT  S22024
         AIF   ('&IEDQSV(6)' EQ '&CHB' AND '&IEDQSV(8)' EQ '&CHD').CKT
.*                                                               S22024
&IEDQAR(13) SETA 0
         AIF   (&IEDQTAC ).CKT .                                 S22025
         AIF   (&IEDQFL(9)).CMSCB .                              S22025
.CMSCB   ANOP
&L       SETA  &L+1 .                                            S22025
.QCB     AIF   ('&DIALNO' EQ '').QCB0                           OX01432
&L       SETA  0                                                OX01432
.QCB0    AIF   ('&UTERM' EQ 'NO').CF                            OX01432
&L       SETA  0                                                 S22024
.ZZ1     AIF   ('&UTERM' EQ 'NO').CF                             S22024
         AIF   (NOT &IEDQZA(60) OR &IEDQFL(12)).QCB1             S22024
         MNOTE 12,'*** IED903 FEATURE=NODAIL SPECIFIED ON INTRO'
.*                                                              SA50203
.QCB1    ANOP
&NB      SETB  1 .                                               S22025
&IEDQZA(12) SETB 1                                                  TSO
         IEDQCHI &TERM,&FEATURE
&IEDQZA(12) SETB 0                                                  TSO
BUFSIZE  IEDQCKO &BUFSIZE,,1,R=(36,65535)                           TSO
ADDR    IEDQCKO  &ADDR,,3,C=1
         AIF   (&IEDQNO).EXIT
&IEDQZA(54) SETB 1
&NB      SETB  1
.CF      ANOP
         AIF   ( NOT &IEDQFL(9) ).NOTX .                         S22025
         AIF   ( &IEDQTAC ).GQUE .                               S22025
&A       SETA  4 .                                               S22025
.GQUE    ANOP .                                                  S22025
&CHA       SETC '20' .                                           S22025
&IEDQNO  SETB  (&B(6)) .                                         S22025
         AGO   .GQB .                                            S22025
.NOTX    ANOP .                                                  S22025
&IEDQNO  SETB  (&B(6))
&CHA       SETC  '0E' .                                          S22025
         AIF   (T'&BFDELAY EQ 'O').GQB                           S22025
         AIF   (NOT &IEDQFL(7)).GQB
&CHA       SETC  '1A' .                                          S22025
.GQB     ANOP                                                    S22027
         AIF   ('&TERM' NE '367C').SETFLG                        S22027
&A       SETA  0 .                                               S22027
.SETFLG  ANOP                                                    S22027
         AIF   (NOT &IEDQFL(12)).GQC                             S22024
&CHA     SETC  '22'                                              S22024
         AIF   ('&TERM' EQ '327C').NQ3705                        S22024
         AIF   ('&UTERM' EQ 'NO').GQC                            S22024
.NQ3705  ANOP                                                    S22024
&A       SETA  2 .                                               S22024
.GQC     ANOP                                                    S22024
         AIF   ('&DIALNO' EQ '' AND '&CALL' NE '').MAC13         S22027
         AGO   .MAC14
.MAC13   IEDQTQ &CHB,&A,&P,&CHD,&LEVEL,&UTERM,CALL=&CALL,C=&L,         *
               ST=&CHA,QT=&QBY,CLOCK=&B(6),CTB=&IEDQCTB(1)&IEDQCTB(2), X
               TAC=&IEDQTAC,QUE=&NO,MAX=&CTBCNT,TERM=&TERM .     S22027
         AGO   .NQ
.MAC14   IEDQTQ &CHB,&A,&P,&CHD,&LEVEL,&UTERM,CALL=&DIALNO,C=&L,       *
               ST=&CHA,QT=&QBY,CLOCK=&B(6),CTB=&IEDQCTB(1)&IEDQCTB(2), X
               TAC=&IEDQTAC,QUE=&NO,MAX=&CTBCNT,TERM=&TERM .     S22027
.NQ      AIF   ('&UTERM' EQ 'YES' OR '&UTERM' EQ 'IDLE').ZF      S22024
         AIF   (&IEDQTAC AND '&CHB' EQ '' AND '&CHD' EQ '').ZF   S22024
         AIF   ('&COMP' EQ 'YES').ZF                           @OS76680
&IEDQSV(6) SETC '&CHB'                                           S22024
&IEDQSV(8) SETC '&CHD'                                           S22024
.ZF      ANOP
         AIF   (T'&BFDELAY NE 'O').NOBFR                         S22025
&IEDQFL(7)  SETB  0                                              S22025
.NOBFR   ANOP                                                    S22025
&NAME    IEDQTT    TAC=&IEDQTAC,ACTV=&ACTIVE,GPCU=&GPCLSTR       S22024
&B(7)    SETB  ('&OPDATA' NE '')
         DC    BL1'&NB.00110&B(7)&B(8)',AL3(&IEDQSV(2)),2H'01'
         AIF   ('&ALTDEST' EQ '').NAL
&S       SETA  82-&IEDQAR(1)
         DC    AL2((&ALTDEST-IEDQTNT-&S)/&IEDQAR(1))
.ST      DC    BL1'&IEDQFL(1)&IEDQFL(2)&IEDQFL(3)&IEDQFL(4)&IEDQFL(5)&IX
               EDQFL(6)&IEDQFL(7)&IEDQFL(8)'
         DC    BL1'&IEDQFL(9)&IEDQFL(10)&IEDQFL(11)&IEDQFL(12)&IEDQFL(1X
               3)&IEDQFL(14)&IEDQFL(15)&IEDQFL(16)'
         AIF   (NOT &IEDQFL(12)).RN3                             S22024
&B(1)    SETB  ('&UTERM' EQ 'YES')                               S22024
&B(2)    SETB  ('&DIALNO' NE '')                                 S22024
&GPT     SETB  0                                                 S22024
&SPCO    SETB  0                                                 S22024
&BFRD    SETB  (0)                                               S22024
         AIF   (&B(1) OR '&UTERM' EQ 'IDLE').RN3B                S22024
&GPT     SETB  ('&GPCLSTR' NE '')                                S22024
&SPCO    SETB  ('&SPECOUT' EQ 'YES')                             S22024
&BFRD    SETB  ('&TERM' EQ '274I' OR '&TERM' EQ '274J' OR '&TERM' EQ   *
               '277A' OR '&TERM' EQ '277B')                      S22024
.RN3B    ANOP                                                    S22024
         DC    BL1'0&B(1)&GPT&SPCO.00&B(2)&BFRD'                 S22024
         DC    XL3'0',AL1(&IEDQAR(12))                           S22024
         AGO   .RN3A                                             S22024
.RN3     ANOP                                                    S22024
         DC    XL4'0',AL1(&IEDQAR(12))
.RN3A    ANOP                                                    S22024
         AIF   (&IEDQAR(12) LE &IEDQAR(11)).OLD
&IEDQAR(11)  SETA  &IEDQAR(12)
IEDQSTCS CSECT
         DC    A(&IEDQCH(&IEDQAR(11)))
&IEDQSV(4) CSECT
.OLD     AIF   (N'&OPDATA EQ 0).CSE
.OPT     IEDQTO  &OPDATA
         AIF   (&IEDQAR(5) EQ 0).CSE
&IEDQAR(10) SETA 3
         AGO   .EXIT
.CSE     AIF   ('&NAME' NE '&IEDQSV(5)').EXT
&IEDQZA(55) SETB 0
         AIF   (NOT &IEDQZA(52) OR (&IEDQFL(9) AND NOT &IEDQTAC)).CE
.*                                                               A52954
         AIF   (&IEDQAR(33) EQ 0 AND &IEDQAR(34) EQ 0).CSND
         ORG   IEDNADDR
         DC    A(&IEDQAR(34)*4+1),A(&IEDQAR(33)*4+3) .           S21101
         ORG
.CSND    AIF   (&IEDQAR(3) EQ 0).EXT
.CE      ANOP
IEDQOPT  CSECT
IEDQOPTN DC    AL2(&IEDQAR(15))
&IEDQSV(4) CSECT
.EXT     IEDQGCH SCRSZ=&SCRSIZE,TAC=&IEDQTAC,RETRYCT=&RETRY .    S22025
         AIF   ( NOT &IEDQFL(9) ).OUT .                          S22025
&NAME    IEDQDID &IEDQID(1)&IEDQID(2) .                          S22025
.OUT     ANOP .                                                  S22025
.EXIT    ANOP                                                   SA57685
         AIF   ('&NAME' NE '&IEDQSV(5)').EXTOLT                  S99528
         IEDNOL  ,                                               S99528
.EXTOLT  ANOP                                                    S99528
&IEDQNO  SETB  0
&IEDQZZ(8) SETB 0                                                S99228
&IEDQZZ(2) SETB 0                                                S99228
&IEDQZA(17) SETB 0                                               S22029
         MEND

T S O   L O G   C O M M A N D
=============================

WICHTIG: DIESE BESCHREIBUNG GILT NUR FUER MVS (>= 3.6)
========

         FUER SVS SIEHE MEMBER 'UDAT01AA'.


DER LOG-COMMAND WURDE GESCHAFFEN, UM DIE EIN- UND AUSGABE
AM 3270-BILDSCHIRM NACH (ODER WAEHREND) DER TSO-SESSION
UEBER EINEN SYSTEM-DRUCKER (Z.B. 1403) ANZULISTEN.
AUSSERDEM WERDEN IN DER MVS-VERSION DIE PFK-TASTEN AUCH
AUSSERHALB DER SPF-SESSION UNTERSTUETZT.


DIE ANWENDUNG ERLAEUTERT DAS NACHSTEHENDE HELP-MEMBER:



)F FUNKTION -
         MIT HILFE DES LOG-COMMANDS KOENNEN TSO-AKTIVITAETEN AUF
         EINEM 3270-BILDSCHIRM IN EINER LOG-DATEI FESTGEHALTEN UND
         ZU EINEM SPAETEREN ZEITPUNKT ENTWEDER DIREKT AUF DEM
         BILDSCHIRM ODER UEBER SYSOUT GELISTET WERDEN.
)X SYNTAX -
         LOG  OPERAND

         DEFAULTS - KEINE
         ACHTUNG  - FOLGENDE LOG-COMMANDS WERDEN INTERN IN COMMAND-
                    PROCEDURES GEAENDERT UND DUERFEN DESHALB NUR IM
                    READY-MODE GEGEBEN WERDEN:
                    'LOG DEL', 'LOG EDIT' UND 'LOG PRINT'.
)O OPERANDS -
))ON     - EINSCHALTEN DER LOG-FUNKTION. AB SOFORT WIRD EINE
           LOG-DATEI GEFUEHRT.
           LOG008I HARDCOPY-LOG TO 'DSNAME'
))OFF    - AUSSCHALTEN DER LOG-FUNKTION. ES WIRD NICHT MEHR GE-
           LOGT, DIE DATEI BLEIBT JEDOCH FUER WEITERE LOGS
           BESTEHEN.
           LOG014I LOG-WRITING STOPPED
))DEL    - DIE LOG-FUNKTION WIRD AUSGESCHALTET UND DIE LOG-DATEI
           DELETED. KEIN ANZEIGEN MEHR MOEGLICH.
           LOG012I 'DSNAME' DELETED
))EDIT   - DIE LOG-FUNKTION WIRD AUSGESCHALTET UND DIE LOG-DATEI
           UMGEWANDELT IN EINE EDIT-DATEI. DIESE EDIT-DATEI
           MIT DEM NAMEN 'USERID.LOGDATA.TEXT' KANN MIT HILFE DES
           EDIT- ODER LIST-COMMANDS AUF DEM BILDSCHIRM GELISTET
           WERDEN.
           LOG017I EDIT-DATASET 'LOGDATA.TEXT' CREATED
))PRINT  - DIE LOG-FUNKTION WIRD AUSGESCHALTET UND DIE LOG-DATEI
           AUF SYSOUT AUSGEGEBEN.
           LOG009I LOGDATA WILL BE MOVED TO SYSOUT=T
))S      - DER LOG-STATUS WIRD AUSGEGEBEN.
           LOG016I S=... D=... R=........ / X'..........'
)M MESSAGES  -
))LOG001E LOG-DATASET IS NOT AVAILABLE
                   DIE LOG-FUNKTION IST MOMENTAN NICHT ANWENDBAR,
                   ENTWEDER IST DIE BEGRENZTE ANZAHL DER LOG-
                   DATEIEN UEBERSCHRITTEN ODER ES IST NICHT GENUG
                   PLATZ VORHANDEN (KERNSPEICHER ODER PLATTE)
))LOG002E LOG-DATASET ABEND ......
                   BEIM SCHREIBEN AUF DEN LOG-DATASET TRAT EIN
                   ABEND AUF. DIE LOG-FUNKTIN WIRD ABGEBROCHEN.
                   DIE BISHER GELOGTEN DATEN SIND NICHT MEHR
                   VERFUEGBAR. NEUER LOG EIN - COMMAND KANN
                   GEGEBEN WERDEN.
))LOG003W LOG-DATASET NEAR FULL * * * * *
                   WARNING. ES SOLLTE DEMNAECHST DIE LOG-FUNKTION
                   AUSGESCHALTET WERDEN. DIESE MESSAGE ERSCHEINT
                   BEI JEDEM 1000. SATZ NACHDEM 3000 SAETZE GE-
                   SCHRIEBEN WURDEN. BEIM 7000. SATZ JEDOCH WIRD
                   DIE FOLGENDE MESSAGE ANGEZEIGT.
))LOG004E LOG-DATASET FULL
                   DIE LOG-FUNKTION WIRD ABGEBROCHEN. ANZEIGEN
                   DER DATEN MIT DER PROCEDURE ZLOG (SYSOUT)
                   ODER SLOG (EDIT-DATEI) MOEGLICH, WENN DER
                   DREISTELLIGE QUALIFIER DER LOG-DATEI BEKANNT
                   IST.  Z.B.  ZLOG AXY
                   LOG-FUNKTION KANN MIT LOG EIN ERNEUT GESTARTET
                   WERDEN.
))LOG005I HELP-OUTPUT NOT PRINTED
                   DIESER HINWEIS ERSCHEINT AUF DEM LOG-OUTPUT
                   NACH JEDEM HELP-COMMAND
))LOG006E LOG-DATASET OPEN-ERROR
                   BEIM OPEN DES LOG-DATASETS TRAT EIN FEHLER
                   AUF. DIE LOG-FUNKTION WIRD ABGEBROCHEN. DIE
                   BISHER GELOGTEN DATEN SIND NICHT MEHR VER-
                   FUEGBAR.
))LOG007E - FEHLER BEIM MHPUT, LETZTE EINGABE UEBERPRUEFEN
                   IM TCAM-MCP WURDE NACH EINEM MHPUT-MACRO EIN
                   RETURN-CODE UNGLEICH 0 FESTGESTELLT.
))LOG008I HARDCOPY-LOG TO 'DSNAME'
                   LOG-FUNKTION EINGESCHALTET, DSNAME EVTL.
                   MERKEN (SIEHE LOG004E).
))LOG009I LOGDATA WILL BE MOVED TO SYSOUT=T
                   LOG PRINT - COMMAND IN ARBEIT.
))LOG010I LOGON/LOGOFF IGNORED - LOG IN PROCESS
))LOG011I ENTER 'LOG DEL', 'LOG EDIT' OR 'LOG PRINT' TO STOP
                   LOG
                   SOLANGE DIE LOG-FUNKTION EINGESCHALTET IST,
                   KANN KEIN LOGOFF DURCHGEFUEHRT WERDEN. NACH
                   AUSSCHALTEN DER LOG-FUNKTION MUSS ERNEUT
                   LOGOFF/LOGON EINGEGEBEN WERDEN.
))LOG012I 'DSNAME' DELETED
                   LOG DEL - COMMAND BENUTZT.
))LOG013I LOG TO 'DSNAME' AGAIN
                   ZWEITES LOG EIN AUF DIE GLEICHE DATEI
                   GEGEBEN.
))LOG014I LOG-WRITING STOPPED
                   LOG AUS - COMMAND SCHALTET DIE LOG-FUNKTION
                   ZWAR AUS, LAESST DIE LOG-DATEI JEDOCH FUER
                   SPAETERES LOG EIN EROEFFNET.
))LOG015I DUMP FORMAT PRINTED
                   ERSCHEINT AUF DER OUTPUT-DATEI WENN EIN TCAM-
                   PUFFER AUFGRUND VON LINE-STEUERZEICHEN NICHT
                   AUFGELOESST WERDEN KONNTE.
                   DER ENTSPRECHENDE PUFFER WIRD DIREKT NACH DER
                   MESSAGE IN HEXADEZIMAL AUSGEDRUCKT.
))LOG016I S=... D=... R=........ / X'..........'
                   STATUS-MESSAGE
))LOG017I EDIT-DATASET 'LOGDATA.TEXT' CREATED
                   LOG EDIT - COMMAND HAT EINE EDIT-DATEI MIT
                   DEM NAMEN 'USERID.LOGDATA.TEXT' ERSTELLT. ALS
                   NAECHSTES WERDEN DANN DIE ERSTE UND LETZTE
                   ZEILE DER DATEI ANGEZEIGT.
))LOG018I SPF IN PROCESS - LOG STOPPED
                   ERSCHEINT IN DER OUTPUT-DATEI WENN DER COMMAND
                   'SPF' EINGEGEBEN WURDE. DIE LOG-FUNKTION WIRD
                   WAEHREND DER SPF-SESSION UNTERBROCHEN
))LOG019I ENTER 'ZLOG ...' TO PRINT LOG
                   ERSCHEINT NUR AUF DEM BILDSCHIRM, WENN DIE SESSION
                   (LOG AKTIV) GECANCELT WURDE.
                   NACH NEUEM LOGON KANN DANN MIT DEM COMMAND
                   'ZLOG ...' DIE ABGEBROCHENE LOG-DATEI AUF SYSOUT=T
                   GEDRUCKT WERDEN.
))LOG020I TOOMUCH LOG-USERS ACTIVE
                   ZUR ZEIT BENUTZEN ZUVIELE USER DIE LOG-FUNKTION.
                   DIE BESCHRAENKUNG WIRD IM PROGRAMM 'SPTSO01' FEST
                   GELEGT.
))LOG021I DUMP, PFK OR TIME BIT CHANGED
                   NUR FUER SYSTEMPROGRAMMIERUNG ZUM TEST VOM 'SPTSO01'





NUR FUER DIE SYSTEMPROGRAMMIERUNG WURDEN WEITERE LOG-COMMANDS
GESCHAFFEN:


LOG S        DER STATUS DER LOG-FUNKTION FUER DIESES TERMINAL
             WIRD ANGEZEIGT. U.A. DAS 8. ZEICHEN DES DDNAMEN,
             DIE ANZAHL SAETZE, DER DSNAME, SCHALTER-BITS AUS
             LCBTAB.

LOG TIME     AB DIESEM COMMAND WIRD VOR JEDER ZEILE DIE UHRZEIT
             GEDRUCKT UND ZWAR IN MINUTEN, SEKUNDEN UND BRUCH-
             TEILEN VON SEKUNDEN. DURCH NOCHMALIGE EINGABE VON
             'LOG TIME' WIRD DAS DRUCKEN DER ZEIT GESTOPPT.

LOG DUMP     SAEMTLICHE EIN- UND AUSGABEN WERDEN AUF DER LISTE IN DUMP-
             FORMAT ANGEDRUCKT. WICHTIG ZUR ANALYSIERUNG VON STEUER-
             ZEICHEN. DURCH WEITERES 'LOG DUMP' WIRD DER OUTPUT NORMAL
             AUFBEREITET.

LOG PFK      DIE VOM 'SPTSO01' ZUGEORDNETEN BEDEUTUNGEN FUER DIE PFK-
             TASTEN WERDEN BIS ZUR NAECHSTEN EINGAGE DES 'LOG PFK' -
             COMMANDS ODER LOGON/LOGOFF NICHT WIRKSAM.




*** HELP - MEMBER FUER DIE PFK-UNTERSTUETZUNG



)F FUNKTION
 DIE PFK-TASTEN KOENNEN AUCH AUSSERHALB EINER SPF-SESSION
 BENUTZT WERDEN.

 FOLGENDE BEDEUTUNGEN SIND DEN EINZELNEN TASTEN ZUGEORDNET:

            CNCL  = '?'
            PF1-9 = '%PF1PROC' - '%PF9PROC'
            PF10  = 'GO'
            PF11  = 'YES'
            PF12  = 'END'

 DEN PF1-9-TASTEN KANN DURCH ANLEGEN VON COMMAND-PROCEDURES MIT
 DEN NAMEN 'PF1PROC' BIS 'PF9PROC' WAHLWEISE EIN BEDEUTUNG ZUGE=
 ORDNET WERDEN.

 IST ALS 'SYSPROC'-DATASET DIE 'TSO.CMDPROC' ALLOCATED SO HABEN
 DIE PF-KEYS FOLGENDE BEDEUTUNGEN:

            PF1 = INFORMATIONEN UEBER PFK
            PF2 = LIBSAVE * OUT
            PF3 = LISTC
            PF4 = DDSN
            PF5 = UTILITY-CALL P(IEHPROGM)
            PF6 = STATUS
            PF7 = PROF LIST
            PF8 = TIME
            PF9 = RE-ALLOCATE SYSPROC

 DURCH ANLAGE EINES 'USERID.CMDPROC.CLIST'-DATASETS UND ENT=
 SPRECHENDE 'SYSPROC'-ZUORDNUNG (PF9) KOENNEN DIE BEDEUTUNGEN
 USER-INDIVIDUELL GEAENDERT WERDEN.
 IST EINE 'USERID.CMDPROC.CLIST'-DATEI VORHANDEN SO WIRD SIE         ×
 BEREITS ZUR LOGON-ZEIT VOR DIE 'TSO.CMDPROC.CLIST' GEKETTET.        ×
 AUSSERDEM WIRD IN DANN DIE PROCEDURE 'START' AUFGERUFEN, IN         ×
 DER JEDER BENUTZER DIE COMMANDS ANGEBEN KANN, DIE ZU BEGINN         ×
 JEDER SESSION AUFLAUFEN SOLLEN.                                     ×

            ×× LOG-, LOGON- BZW. LOGOFF-COMMANDS DUERFEN ××
            ×× NICHT UEBER PF-KEYS AUFGERUFEN WERDEN.    ××
            ×× DAS GLEICHE GILT FUER DEN SPF-COMMAND.    ××

 NATUERLICH WIRD UNTER SPF DIE BEDEUTUNG DER PFK-TASTEN NICHT
 VERAENDERT.




I N T E R N :
-------------

IM   M C P   WERDEN ALLE INPUT-BUFFER 'DURCHGESCANED'. IST EIN 'LOG ON'-
COMMAND GEGEBEN WORDEN, SO WERDEN BIS ZUM 'LOG PRINT' ALLE INPUT- UND
OUTPUT-BUFFER DIESES LCB'S AUFBEREITET UND AUF EINEN DATASET GESCHRIEBEN
DER OVERHEAD IST MINIMAL, ER BETRAEGT PRO TCAM-BUFFER ETWA 50-70
INSTRUKTIONEN.
BEI DIESEM 'SCAN' WERDEN DIE PFK-TASTEN ERKANNT UND AN TSO WERDEN DIE
ZUGEORDNETEN BEDEUTUNGEN WEITER GEGEBEN.





FOLGENDE SKIZZE SOLL DEN ABLAUF VERDEUTLICHEN:


_____________________                           _______________________
× M C P             ×<<- - - - - - - - - - - - -× T S O - U S E R :   ×
×   ________________×                           ×                     ×
×   × T S O M H     ×                           ×         LOG ON      ×
×   ×               ×    __________________     ×         LISTC       ×
×   ×     CALL -----×--->× SPTSO01        ×     ×         LOG PRINT   ×
×   ×               ×    ×                ×     ×_____________________×
×   ×     CALL -----×--->×      __________×
×___×_______________×    ×      × LCBTAB  ×
          ×              ×______×_________×
          ×                     +
          ×                      +       OPEN
          ×                       +      PUT
          ×                        +     CLOSE
_____________________            ___+___________
× T S O             ×   ALLOC    × DATASET     ×
×       XLOG        ×----------->× TSL.LOG#... ×
×       LISTC       ×            ×             ×
×       ZLOG        ×<-----------×             ×
×___________________×   DELETE   ×_____________×
          ×
          ×
    _____________
    × SYSOUT=T  ×
    ×           ×
    ×       ___/
    ×      /
    ×_____/




DER 'LOG ON'-COMMAND WIRD IM MCP ABGEFANGEN UND MIT HILFE DER DYNAMIC
ALLOCATION WIRD EIN LOG-DATASET ANGELEGT. GLEICHZEITIG WIRD EIN
TABELLEN-ELEMENT IN DER LCBTAB IM SPTSO01 KREIERT, WELCHES ALLE
ERFORDERLICHEN INFORMATIONEN ENTHAELT. IN DEN ZUGEORDNETEN LOG DATASET
WIRD DANN VOM 'SPTSO01' GESCHRIEBEN. DER NAME DES DATASETS SETZT SICH
AUS DEM STRING 'TSL.LOG#' UND EINEM 3-STELLIGEN ZUFALLSSTRING ZUSAMMEN.
FALLS DER DER HIGH LEVEL INDEX 'TSL' GEAENDERT WERDEN SOLL, SIND
AENDERUNGEN IN DEN CMDPROCS UND IM SPTSO01 NOTWENDIG.

DER 'LOG PRINT'-COMMAND KOPIERT DIE DATEN AUS 'TSL.LOG#...' MIT
IEBGENER IN SYSOUT=T UND DELETED DEN DATASET (DIESES GESCHIEHT IN
EINER COMMAND-PROCEDURE (ZLOG) DIE DEN 'LOG PRINT'-COMMAND ERSETZT.


ANDEREN LOG-COMMANDS WERDEN Z.T. AUCH IN COMMAND-PROC-AUFRUFE GEAENDERT.
(SIEHE HELP-MEMBER)




I N S T A L L A T I O N
=======================


1. INSTALLIEREN SIE ZUNAECHST 'UDAT02' (SIEHE BESCHREIBUNG 'UDAT02AA'),
   DENN 'DMPRINT' IST IM TSO LOG INTEGRIERT (DIE KOPIERTEN MACROS
   (MDAT01AM) MUESSEN DER TSO-LOG-INSTALLATION EBENFALLS ZUR VERFUEGUNG
   STEHEN).

2. FAHREN SIE DAS MEMBER 'UDAT03CS' IN IHRE CMDPROC-LIBRARY, DAS
   MEMBER 'UDAT03DS' IN DIE SYS1.HELP.
   IEBUPDTE: DIE './ ADD' - KARTEN SIND VORHANDEN.
   FOLGENDE CMDPROCS MUESSEN EVTL. GEAENDERT WERDEN:
      SLOG   CALL 'SYS1.TSOLOAD(SPTSO02)'
      ZLOG   PROC ... CLASS(T)

3. COMPILE UND LINK DER MODULE SPTSO01 UND SPTSO02 ('UDAT03AS' UND
   'UDAT03BS') IN EINE LNKLST00-LIBRARY.
   DIE GLOBALS IN SPTSO01 ('&KEYLEN' UND '&BUFSIZE') MUESSEN UNBEDINGT
   AUF DIE ENTSPRECHENDEN MCP-WERTE GESETZT WERDEN.

4. AENDERUNGEN IM   M C P  :
   ES IST ERFORDERLICH, INS MCP 4 MACROS EINZUBAUEN. ALLE LABEL, DIE
   VON DIESEN MACROS GENERIERT WERDEN, BEGINNEN MIT 'TSO'. SIE KOENNEN
   DEN STRING AENDERN, WENN SIE BEI ALLEN AUFRUFEN DEN OPERANDEN
   'QUAL=...' ANGEBEN. BEIM MACRO DMLOGL GIBT ES EINEN ZUSAETZLICHEN
   OPERANDEN, DER DEN MODULE-NAMEN DES SPTSO01 AENDERT ('EXIT=.....').

   HIER DIE 4 MACROS:

      D M L O G L     LOAD SPTSO01 UND SPEICHERN DER ADDRESSE.
                      EINZUFUEGEN ZWISCHEN INTRO- UND READY-MACRO
      D M L O G D     DEFINITIONEN.
                      EINZUFUEGEN NACH STARTMH-MACRO DES TSOMH
      D M L O G I     INPUT-VERARBEITUNG.
                      EINZUFUEGEN ZWISCHEN INBUF- UND CUTOFF-MACRO
                      DES TSO-MESSAGE-HANDLERS.
      D M L O G O     OUTPUT-VERARBEITUNG.
                      EINZUFUEGEN ZWISCHEN OUTBUF- UND CODE-MACRO
                      DES TSOMH. FALLS SPF INSTALLIERT IST, VOR SPFMCHK!

   DIE MACROS HABEN NUR DIE O.A. OPERANDEN ('QUAL=' UND 'EXIT='). SIE
   SIND IM MEMBER 'MDAT01AM' ENTHALTEN.

   AUSSERDEM IST SOWOHL IN DER INBUF-SUBGROUP ALS AUCH IN DER OUTBUF
   SUBGROUP EIN MSGGEN-MACRO ANZULEGEN:

      MSGGEN X'0000080000',TSOMSG

5. ERWEITERUNG DER TCAM-START-PROCEDURE:
   DIE ZUORDNUNG DER LOG-DATASETS ERFOLGT MIT DYNAMIC ALLOCATION.
   DIE ANGABE DES PARAMETERS 'DYNAMNBR=..' IST EVENTUELL ERFORDERLICH.

   EIN ZUSAETZLICHES DD-STATEMENT IST ZU EMPFEHLEN:

      //PRINTOUT DD SYSOUT=A

   UEBER DIESES DD-STATEMENT WERDEN IM FEHLERFALL KURZDUMPS
   AUSGEGEBEN, AUSSERDEM GRUNDSAETZLICH EINE INITIALISIERUNGS-
   MESSAGE.

6. ERWEITERUNG DER LOGON-PROCEDURE:
   DIESE AENDERUNG IST NUR NOTWENDIG, WENN DIE ALLOCATION DER CLIST-
   DATASETS AUTOMATISCH ERFOLGEN SOLL. (SIEHE 'HELP PFK')
   IN DIE EXEC-KARTE SOLLTE >PARM='%FIRSTPR'< EINGEFUEGT WERDEN.

7. J E T Z T   S O L L T E   E S   F U N K T I O N I E R E N .

8. HIER NOCH EINIGE HINWEISE:

   * NUR 3270-BUFFER WERDEN RICHTIG ANALYSIERT (GETESTET NUR MIT
     LOCAL-DEVICES), ANDERE STEUERZEICHEN FUEHREN WAHRSCHEINLICH
     ZUM AUSDRUCK IN DUMPFORMAT.

   * SOBALD SPF AUFGERUFEN WIRD, WIRD DIE LOG-FUNKTION UNTERBROCHEN.
     SIE STARTET WIEDER BEIM 1. 'READY'. DESHALB SOLLTE DARAUF GEACHTET
     WERDEN, DASS SPF NICHT MIT 'PA1' VERLASSEN UND DURCH 'ENTER'
     WIEDER 'BETRETEN' WIRD.

   * DA DIE LOG-DATASETS KATALOGISIERT WERDEN, IST EIN 'TSL'-POINTER
     ZUM TSO-KATALOG ZU EMPFEHLEN.


WENN UNKLARHEITEN ODER PROBLEME AUFTAUCHEN, RUFEN SIE MICH BITTE AN.


MIT FREUNDLICHEM GRUSS

WOLFGANG STOEHLER
C/O DATEV EG., NUERNBERG
0911/2761

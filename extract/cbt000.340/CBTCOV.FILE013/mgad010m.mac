         MACRO
&NAME    GADBEGIN  &SAVE=YES
         PUSH  PRINT
         PRINT OFF
         COPY  GADGLOBL
&GADB(2) SETB  0
&GADB(3) SETB  0
&GADB(4) SETB  0
&GADB(1) SETB  1
         LCLA  &L
         LCLA  &S
         LCLC  &GN
         LCLC  &R(12)
&GADA(1) SETA  &GADA(1)+1
&GN      SETC  'GAD'.'&GADA(1)'
&S       SETA  2
         CNOP  0,4
         AIF   (&GADA(1) GT 1).A1
R0       EQU   0
R1       EQU   1
R2       EQU   2
R3       EQU   3
R4       EQU   4
R5       EQU   5
R6       EQU   6
R7       EQU   7
R8       EQU   8
R9       EQU   9
R10      EQU   10
R11      EQU   11
R12      EQU   12
R13      EQU   13
R14      EQU   14
R15      EQU   15
XF00     EQU   0
XF01     EQU   1
XF02     EQU   2
XF03     EQU   3
XF04     EQU   4
XF05     EQU   5
XF06     EQU   6
XF07     EQU   7
XF08     EQU   8
XF09     EQU   9
XF0A     EQU   10
XF0B     EQU   11
XF0C     EQU   12
XF0D     EQU   13
XF0E     EQU   14
XF0F     EQU   15
XF10     EQU   16
XF11     EQU   17
XF12     EQU   18
XF13     EQU   19
XF14     EQU   20
XF15     EQU   21
XF16     EQU   22
XF17     EQU   23
XF18     EQU   24
XF19     EQU   25
XF1A     EQU   26
XF1B     EQU   27
XF1C     EQU   28
XF1D     EQU   29
XF1E     EQU   30
XF1F     EQU   31
XF20     EQU   32
XF21     EQU   33
XF22     EQU   34
XF23     EQU   35
XF24     EQU   36
XF25     EQU   37
XF26     EQU   38
XF27     EQU   39
XF28     EQU   40
XF29     EQU   41
XF2A     EQU   42
XF2B     EQU   43
XF2C     EQU   44
XF2D     EQU   45
XF2E     EQU   46
XF2F     EQU   47
XF30     EQU   48
XF31     EQU   49
XF32     EQU   50
XF33     EQU   51
XF34     EQU   52
XF35     EQU   53
XF36     EQU   54
XF37     EQU   55
XF38     EQU   56
XF39     EQU   57
XF3A     EQU   58
XF3B     EQU   59
XF3C     EQU   60
XF3D     EQU   61
XF3E     EQU   62
XF3F     EQU   63
XF40     EQU   64
XF41     EQU   65
XF42     EQU   66
XF43     EQU   67
XF44     EQU   68
XF45     EQU   69
XF46     EQU   70
XF47     EQU   71
XF48     EQU   72
XF49     EQU   73
XF4A     EQU   74
XF4B     EQU   75
XF4C     EQU   76
XF4D     EQU   77
XF4E     EQU   78
XF4F     EQU   79
XF50     EQU   80
XF51     EQU   81
XF52     EQU   82
XF53     EQU   83
XF54     EQU   84
XF55     EQU   85
XF56     EQU   86
XF57     EQU   87
XF58     EQU   88
XF59     EQU   89
XF5A     EQU   90
XF5B     EQU   91
XF5C     EQU   92
XF5D     EQU   93
XF5E     EQU   94
XF5F     EQU   95
XF60     EQU   96
XF61     EQU   97
XF62     EQU   98
XF63     EQU   99
XF64     EQU   100
XF65     EQU   101
XF66     EQU   102
XF67     EQU   103
XF68     EQU   104
XF69     EQU   105
XF6A     EQU   106
XF6B     EQU   107
XF6C     EQU   108
XF6D     EQU   109
XF6E     EQU   110
XF6F     EQU   111
XF70     EQU   112
XF71     EQU   113
XF72     EQU   114
XF73     EQU   115
XF74     EQU   116
XF75     EQU   117
XF76     EQU   118
XF77     EQU   119
XF78     EQU   120
XF79     EQU   121
XF7A     EQU   122
XF7B     EQU   123
XF7C     EQU   124
XF7D     EQU   125
XF7E     EQU   126
XF7F     EQU   127
XF80     EQU   128
XF81     EQU   129
XF82     EQU   130
XF83     EQU   131
XF84     EQU   132
XF85     EQU   133
XF86     EQU   134
XF87     EQU   135
XF88     EQU   136
XF89     EQU   137
XF8A     EQU   138
XF8B     EQU   139
XF8C     EQU   140
XF8D     EQU   141
XF8E     EQU   142
XF8F     EQU   143
XF90     EQU   144
XF91     EQU   145
XF92     EQU   146
XF93     EQU   147
XF94     EQU   148
XF95     EQU   149
XF96     EQU   150
XF97     EQU   151
XF98     EQU   152
XF99     EQU   153
XF9A     EQU   154
XF9B     EQU   155
XF9C     EQU   156
XF9D     EQU   157
XF9E     EQU   158
XF9F     EQU   159
XFA0     EQU   160
XFA1     EQU   161
XFA2     EQU   162
XFA3     EQU   163
XFA4     EQU   164
XFA5     EQU   165
XFA6     EQU   166
XFA7     EQU   167
XFA8     EQU   168
XFA9     EQU   169
XFAA     EQU   170
XFAB     EQU   171
XFAC     EQU   172
XFAD     EQU   173
XFAE     EQU   174
XFAF     EQU   175
XFB0     EQU   176
XFB1     EQU   177
XFB2     EQU   178
XFB3     EQU   179
XFB4     EQU   180
XFB5     EQU   181
XFB6     EQU   182
XFB7     EQU   183
XFB8     EQU   184
XFB9     EQU   185
XFBA     EQU   186
XFBB     EQU   187
XFBC     EQU   188
XFBD     EQU   189
XFBE     EQU   190
XFBF     EQU   191
XFC0     EQU   192
XFC1     EQU   193
XFC2     EQU   194
XFC3     EQU   195
XFC4     EQU   196
XFC5     EQU   197
XFC6     EQU   198
XFC7     EQU   199
XFC8     EQU   200
XFC9     EQU   201
XFCA     EQU   202
XFCB     EQU   203
XFCC     EQU   204
XFCD     EQU   205
XFCE     EQU   206
XFCF     EQU   207
XFD0     EQU   208
XFD1     EQU   209
XFD2     EQU   210
XFD3     EQU   211
XFD4     EQU   212
XFD5     EQU   213
XFD6     EQU   214
XFD7     EQU   215
XFD8     EQU   216
XFD9     EQU   217
XFDA     EQU   218
XFDB     EQU   219
XFDC     EQU   220
XFDD     EQU   221
XFDE     EQU   222
XFDF     EQU   223
XFE0     EQU   224
XFE1     EQU   225
XFE2     EQU   226
XFE3     EQU   227
XFE4     EQU   228
XFE5     EQU   229
XFE6     EQU   230
XFE7     EQU   231
XFE8     EQU   232
XFE9     EQU   233
XFEA     EQU   234
XFEB     EQU   235
XFEC     EQU   236
XFED     EQU   237
XFEE     EQU   238
XFEF     EQU   239
XFF0     EQU   240
XFF1     EQU   241
XFF2     EQU   242
XFF3     EQU   243
XFF4     EQU   244
XFF5     EQU   245
XFF6     EQU   246
XFF7     EQU   247
XFF8     EQU   248
XFF9     EQU   249
XFFA     EQU   250
XFFB     EQU   251
XFFC     EQU   252
XFFD     EQU   253
XFFE     EQU   254
XFFF     EQU   255
.A1      AIF   ('&SAVE' EQ 'YES').A2  NORMAL
         AIF   ('&SAVE' NE 'NP').B1 NOT NORMAL NOT NOPARM
.A2      ANOP
&GADB(2) SETB  1     TYPE SAVE YES
&R(1)    SETC  ',R13'   FIRST REGISTER
&L       SETA  1    POINTER IN SYSLIST
         USING *,R15
&NAME    STM   R14,R12,XF0C(R13)   SAVE REGISTERS
         LR    R2,R13    SAVE OLD SAVEA POINTER
         CNOP  0,4
         BAL   R13,&GN.F  LOAD NEW SAVEA POINTER
&GN.S    DC    18F'0'   NEW SAVEAREA
         AIF   (T'&SYSECT EQ 'O').A3
         DC    CL8'&SYSECT'
         AGO   .A4
.A3      ANOP
         DC    CL8' '    NO SECTION-NAME
.A4      ANOP
         DC    C'&SYSDATE'
         DC    C'&SYSTIME'
         DC    C'GAD HOUSEKEEPING '
&GN.F    ST    R13,XF08(R2)  STORE NEW SAVEA
         ST    R2,XF04(R13)  STORE OLD SAVEAPOINTER
         AIF   (N'&SYSLIST EQ 0).D1  NO MORE BASE
         LA    &SYSLIST(1),4095
         LA    &SYSLIST(1),1(&SYSLIST(1),R13)   LOAD NEXT BASE
.D1      AIF   (N'&SYSLIST LT &L).D2  END OF LIST
&R(&S)   SETC  ',&SYSLIST(&L)'
&S       SETA  &S+1
&L       SETA  &L+1
         AGO   .D1
.D2      ANOP
         USING &GN.S&R(1)&R(2)&R(3)&R(4)&R(5)&R(6)&R(7)&R(8)&R(9)&R(10)*
               &R(11)&R(12)
         DROP  R15
&L       SETA  1
.D3      AIF   (N'&SYSLIST LT &L+1).E1   END OF LIST
         LA    &SYSLIST(&L+1),4095
         LA    &SYSLIST(&L+1),1(&SYSLIST(&L+1),&SYSLIST(&L)) NEXT BASE
&L       SETA  &L+1
         AGO   .D3
.B1      AIF   (N'&SYSLIST EQ 0).ERR1  NO BASE
&R(1)    SETC  ',&SYSLIST(1)'  FIRST REG FOR USING
&L       SETA  2   POINTER IN SYSLIST
         USING *,R15
&GN.S    DS    0D
&NAME    STM   R14,R12,XF0C(R13)  SAVE REGISTERS
         AIF   ('&SAVE' NE 'RENT').C1  NOT RENT
&GADB(3) SETB  1    TYPE SAVE RENT
         LR    R2,R13  SAVE OLD SAVEA
         LR    R3,R15  SAVE BASE
         LR    R4,R1  SAVE PARM POINTER
         GETMAIN R,LV=72  GET NEW SAVE
         LR    R13,R1  LOAD NEW SAVE
         LR    R1,R4  REPRIME PARM
         ST    R13,XF08(R2)  STORE NEW SAVE
         ST    R2,XF04(R13)  STORE OLD SAVEA
         LR    R15,R3        REPRIME BASE
         B     &GN.F
         AGO   .C2
.C1      AIF   ('&SAVE' NE 'NO').ERR2  NOT NO
&GADB(4) SETB  1   TYPE SAVE NO
         B     &GN.F
.C2      ANOP
         DC    C'&SYSDATE'
         DC    C'&SYSTIME'
         DC    C'GAD HOUSEKEEPING '
&GN.F    LR    &SYSLIST(1),R15  LOAD BASE
         AGO   .D1
.E1      AIF   ('&SAVE' NE 'YES').E2
         AIF   (&GADA(1) GT 1).E2
         ST    R1,XFREG1
         L     R1,0(R1)
         LH    R1,0(R1)
         LTR   R1,R1
         BZ    &GN.N
         BCTR  R1,R0
         STC   R1,*+13
         L     R1,XFREG1
         L     R1,0(R1)
         MVC   XFPARM,2(R1)
         B     &GN.N
XFREG1   DC    F'0'
XFPARM   DC    XL100'0'
&GN.N    L     R1,XFREG1  REPRIME POINTER
.E2      ANOP
         POP   PRINT
         MEXIT
.ERR1    ANOP
         POP   PRINT
         MNOTE 16,'SAVE NO OR RENT WITHOUT BASE GIVEN'
         MEXIT
.ERR2    ANOP
         POP   PRINT
         MNOTE 16,'WRONG SAVE PARAMETER, SPECIFY NO OR RENT'
         MEXIT
.ERR3    ANOP
         POP   PRINT
         MNOTE 20,'NOT AUTHORIZED'
         MEND

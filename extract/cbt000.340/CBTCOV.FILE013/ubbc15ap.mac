 PAGE:    PROC OPTIONS(MAIN);
   DCL BEWERT FILE RECORD, GUELTIG FILE RECORD,
       L1 FILE PRINT,L2 FILE PRINT;
   DCL 1 BSATZ,
        2 F1 CHAR(1),
        2 RECORD BIT(8),
        2 SZEITHS BIN FIXED(31) UNAL,
        2 SDATUM FIXED(7),
        2 F2 CHAR(4),
        2 JOBNAME CHAR(8),
        2 TSOEZHS  BIN FIXED(31)  UNAL, /*FUER SATZ 34 ODER 40 */
        2 TSOEDAT  FIXED(7),
        2 F3 CHAR(9),
        2 EZEITHS BIN FIXED(31) UNAL,
        2 EDATUM FIXED(7),
        2 F4 CHAR(15),
        2 STEPNAME CHAR(8),
        2 F5 CHAR(32),
        2 LENGTH BIN FIXED(15) UNAL,
        2 VA CHAR(3992);
   DCL 1 RDSATZ1,
        2 F1 CHAR(2),
        2 EJAHR PIC'99',
        2 ELTAG PIC'999',
          RD1 PIC'(7)9' DEF RDSATZ1,
       1 RDSATZ2,
        2 F1 CHAR(2),
        2 SJAHR PIC'99',
        2 SLTAG PIC'999',
         RD2 PIC'(7)9' DEF RDSATZ2,
     1 SGUEL, 2 ERSTTAG CHAR(10),
      2 VONTAG PIC'99', 2 VONMON PIC'99', 2 VONJR PIC'99',
      2 BISTAG PIC'99', 2 BISMON PIC'99', 2 BISJR PIC'99',
      2 RXX1 CHAR(58);
   DCL (FTAG,FMON,FJR,LASTTAG,LASTMON,LASTJR,
        LTZW1,LTZW2) BIN FIXED INIT(0), IMP(24) INIT((24) 0);
   DCL MARK1 LABEL,DATE BUILTIN,FELD CHAR(13);
   DCL (BATCH,TSO) CHAR(3),WOCHTAG(7) CHAR(10);
   DCL (MON(12),STAG,SMON,VGLTAG,VGLMON,VGLJR,UEBTAG,ACCLEN,GESLEN,
        STEPZEIT,UEBZEIT) BIN FIXED;
   DCL (PI1,PO1) FIXED(15,3);
   DCL (PI,PO,EZEITG,SZEITG,CPUZHS) BIN FIXED(31);
   DCL (SPIMIN(1440),SPOMIN(1440),UEBPI(1440),UEBPO(1440),
       PIDREI(480),PODREI(480),PISTD(24),POSTD(24),PITAG(35),POTAG(35),
       PIMIN,POMIN,MONSUMPI,MONSUMPO,SUMPI,SUMPO,SUMPIS,SUMPOS,
       SUMPIT,SUMPOT,UEBPIMIN,UEBPOMIN)   FIXED(15,3);
   DCL (PISEC(24),POSEC(24),MPISEC(24),MPOSEC(24),
   PISTDH(24),POSTDH(24),MPISTDH(24),MPOSTDH(24),
   PISECM,POSECM,MPISECM,MPOSECM,SUMSECM,SUMSEC)  FIXED(15,3);
   DCL (MAX,STEP) PIC'999V99',(MAX1,MAXU,MAXO) FIXED(9,3);
    DCL JSTEP FIXED(9,3);
   DCL TAGMON(35) CHAR(2),MPTAG(35) FIXED(5),
       GLEICH CHAR(132) INIT((132)'=');
    DCL (MAXMON(35),MAXTAG(24),MAXSUM(24),MAXMIN,MAXSTD) FIXED(11,3);
   ON ERROR CALL PLIDUMP('T,F,C,H,B,A');
   DCL (MONPIM,MONPOM,K)  FLOAT(15);
   ON SUBRG BEGIN;
   PUT SKIP LIST('UEBRLAUF EINES FELDINDEX !');
   GO TO ENDE;
   END;
   OPEN FILE(L1) PAGESIZE(70);
   OPEN FILE(L2) PAGESIZE(70);
   ON ENDFILE(SYSIN) GO TO ENDE;
   ON ENDFILE(GUELTIG) BEGIN;
   PUT SKIP LIST('KEINE KARTE FUER G.BEREICH ODER FUER JAHRESWECHSEL');
   GO TO ENDE;
   END;
   MON(1),MON(3),MON(5),MON(7),MON(8),MON(10),MON(12)=31;
   MON(4),MON(6),MON(9),MON(11)=30;
   WOCHTAG(1)='MONTAG    ';
   WOCHTAG(2)='DIENSTAG  ';
   WOCHTAG(3)='MITTWOCH  ';
   WOCHTAG(4)='DONNERSTAG';
   WOCHTAG(5)='FREITAG   ';
   WOCHTAG(6)='SAMSTAG   ';
   WOCHTAG(7)='SONNTAG   ';
 ERSTDAT: PROC;
   FTAG=STAG; FMON=SMON; FJR=SJAHR;
   END ERSTDAT;
 LASTDAT: PROC;
   LASTTAG=STAG; LASTMON=SMON; LASTJR=SJAHR;
   END LASTDAT;
 LESEN:
   GET DATA(BATCH,TSO,MAX,STEP);
   IZEICH=0;
   IF BATCH='YES' & TSO='YES' THEN DO;
   FELD='(BATCH + TSO)';
   ISCH1=1;GO TO U1;
   END;
   IF BATCH='YES' & TSO='NO ' THEN DO;
   FELD='(ONLY  BATCH)';
   ISCH1=2; GO TO U1;
   END;
   IF BATCH='NO ' & TSO='YES' THEN DO;
   ISCH1=3; FELD='( ONLY TSO  )';
   END;
   ELSE DO;
   PUT SKIP LIST('FALSCHER PARAM. FUER BATCH ODER TSO');
   GO TO LESEN;
   END;
   IF MAX=0 × STEP=0 THEN DO;
   PUT SKIP LIST('FALSCHER WERT FUER MAX ODER STEP (0)');
   GO TO ENDE;
   END;
 U1:
   OPEN FILE(BEWERT) INPUT;
   ON ENDFILE(BEWERT) BEGIN;
  IF IZEICH=0 THEN GO TO ENDE;
   ISCHALT=0;
   GO TO RECHNEN;
   END;
   PIMIN,POMIN,MONSUMPI,MONSUMPO=0;
   SPIMIN,SPOMIN=0;
   PIDREI,PODREI=0;
   PISTD,POSTD=0;
   PITAG,POTAG=0;
   UEBPI,UEBPO=0;
   MPISEC,MPOSEC,PISEC,POSEC,MPISTDH,MPOSTDH=0;
   PISECM,POSECM,MPISECM,MPOSECM,SUMSECM=0;
   IMP=0;
    MAXMON=0; MAXSUM=0;
   LTZW1,LTZW2=0;
   K1,IDAT=0; ISCHALT=1;
 WOCHE: PROC;
   READ FILE(GUELTIG) INTO(SGUEL);
   DO I=1 TO 7;
   IF WOCHTAG(I) ^= ERSTTAG THEN GO TO HAS1;
   IWT=I;
   GO TO HAS2;
 HAS1: END;
   PUT SKIP LIST('KEIN GUELTIGER ERSTTAG WURDE EINGEGEBEN !');
   PUT DATA(WOCHTAG);
   GO TO ENDE;
 HAS2: END WOCHE;
   CALL WOCHE;
   IF MOD(VONJR,4)=0 THEN MON(2)=29;
   ELSE MON(2)=28;
   IF VONMON=1 THEN GO TO RI1;
   DO I=1 TO (VONMON-1);
   LTZW1=LTZW1+MON(I);
   END;
 RI1: LTZW1=LTZW1+VONTAG;
   IF MOD(BISJR,4)=0 THEN MON(2)=29;
   ELSE MON(2)=28;
   IF  BISMON=1 THEN GO TO RI2;
   DO I=1 TO (BISMON-1);
   LTZW2=LTZW2+MON(I);
   END;
 RI2: LTZW2=LTZW2+BISTAG;
 LES1:
   MARK1=LES1;
   READ FILE(BEWERT) INTO(BSATZ);  /*ERSTER SATZ */
   CALL SATZFR;
   CALL RICHTIG;
   RD1=EDATUM;
   RD2=SDATUM;
   IF SLTAG + 366*SJAHR > LTZW2 + 366*BISJR ×
      SLTAG + 366*SJAHR < LTZW1 + 366*VONJR THEN GO TO LES1;
   IZEICH=1;
   IF MOD(SJAHR,4)=0 THEN MON(2)=29;
   ELSE MON(2)=28;
   LTAG=SLTAG;
   CALL KALTAG;
   STAG=KTAG;    /*STARTTAG*/
   SMON=IMONAT;  /*STARTMONAT*/
   VGLTAG=STAG;
   IVTAG=ITAG;
   VGLMON=SMON;
   VGLJR=SJAHR;
   UEBTAG=STAG;
   CALL ERSTDAT;
   GO TO BERECH1;
 LES2:
   MARK1=LES2;
   READ FILE(BEWERT) INTO(BSATZ); /* FOLGESAETZE */
   CALL SATZFR;
   CALL RICHTIG;
   RD1=EDATUM;
   RD2=SDATUM;
   IF SLTAG + 366*SJAHR > LTZW2 + 366*BISJR ×
      SLTAG + 366*SJAHR < LTZW1 + 366*VONJR THEN GO TO LES2;
   IF VGLJR ^= SJAHR THEN CALL WOCHE;
   LTAG=SLTAG;
   CALL KALTAG;
   STAG=KTAG;
   SMON=IMONAT;
   CALL LASTDAT;
   IF VGLTAG ^= STAG THEN GO TO RECHNEN; /* TAGESABRECHNUNG */
 BERECH1:
   IF EZEITHS = SZEITHS THEN GO TO  LES2;
   ACCLEN=UNSPEC(SUBSTR(VA,LENGTH-1,1));
   GESLEN=LENGTH+ACCLEN;
   PI=UNSPEC(SUBSTR(VA,GESLEN,4));
   PO=UNSPEC(SUBSTR(VA,GESLEN+4,4));
   IF PI=0 & PO=0 THEN GO TO LES2;
   IF SZEITHS > EZEITHS  THEN CALL SONDFALL;
   CALL ZEITBER; /* ZEITBERECHNUNG IN MINUTEN */
   IF SZEITG=0 THEN DO;
   SZEITG=1;
   EZEITG=EZEITG+1;
   END;
   STEPZEIT=EZEITG - SZEITG + 1;
 U3:
   IF STEPZEIT = 0 THEN GO TO LES2;
   PI1=PI;
   PO1=PO;
   PIMIN=PI1/STEPZEIT; /* PAGE-INS PRO MINUTE */
   POMIN=PO1/STEPZEIT;
   DO I=SZEITG TO EZEITG;
   SPIMIN(I)=SPIMIN(I) + PIMIN;
   SPOMIN(I)=SPOMIN(I) + POMIN;
   END;
   GO TO LES2;
 RECHNEN:    /* TAGESABRECHNUNG */
   SUMPI,SUMPO,SUMPIS,SUMPOS,SUMPIT,SUMPOT=0;
    MAXTAG=0; MAXMIN,MAXSTD=0;
   DO I= 1 TO 1440;
   SUMPI=SUMPI + SPIMIN(I);
   SUMPO=SUMPO + SPOMIN(I);
   SUMPIS=SUMPIS + SPIMIN(I);
   SUMPOS=SUMPOS + SPOMIN(I);
   SUMPIT=SUMPIT + SPIMIN(I);
   SUMPOT=SUMPOT + SPOMIN(I);
    IF SPIMIN(I) + SPOMIN(I) > MAXMIN THEN MAXMIN=SPIMIN(I)+
    SPOMIN(I);
   IF MOD(I,3) ^= 0 THEN GO TO GU1;
   L=I/3;
   PIDREI(L)=SUMPI + 0.5;
   PODREI(L)=SUMPO + 0.5;
   SUMPI,SUMPO=0;
   IF MOD(I,60) ^= 0 THEN GO TO GU1;
   L=I/60;
   PISTD(L)=SUMPIS + 0.5;
   POSTD(L)=SUMPOS + 0.5;
   IF MAXMIN > 0 THEN IMP(L)=IMP(L)+1;
    MAXTAG(L)=MAXMIN/60 + 0.05;
    MAXSUM(L)=MAXSUM(L) + MAXTAG(L);
    IF MAXTAG(L) > MAXSTD THEN
    MAXSTD=MAXTAG(L);
   SUMPIS,SUMPOS=0; MAXMIN=0;
   IF MOD(I,1440) ^= 0 THEN GO TO GU1;
   K1=K1+1;
    MAXMON(K1)=MAXSTD;
   PITAG(K1)=SUMPIT + 0.5;
   POTAG(K1)=SUMPOT + 0.5;
 GU1: END;
 /* TAGESTABELLE IN ZAHLEN PRO 3 MINUTEN */
   PUT PAGE FILE(L1) EDIT
   ('STATISTIK DER  P A G E - I N  UND  P A G E - O U T  PRO 3 MIN ',
    'VOM ',WOCHTAG(IVTAG),' DEN ',VGLTAG,'.',VGLMON,'.',VGLJR,
   (89)'=')(SKIP(2),COL(20),(4)A,(2)(P'99',A),P'99',SKIP,COL(20),A);
   PUT SKIP FILE(L1) EDIT
   (FELD,(13)'=')(COL(50),A,SKIP,COL(50),A);
   PUT FILE(L1) SKIP(2) EDIT
   ('MIN   ')(X(2),A);
   DO I=1 TO 20;
   PUT FILE(L1) EDIT (3*I)(P'(3)Z99');
   END;
   PUT FILE(L1) EDIT('SUMME')(COL(120),A);
   PUT SKIP FILE(L1);
   DO I= 1 TO 24;
   PUT SKIP FILE(L1) EDIT
   (I-1,' UHR  ')(P'ZZ9',A);
   DO J=1 TO 20;
   PUT FILE(L1) EDIT(PIDREI(20*(I-1)+J))(P'(4)Z9');
   END;
   PUT FILE(L1) EDIT(PISTD(I),' PI')(COL(119),P'(5)Z9',A);
   PUT FILE(L1) SKIP EDIT((9)' ')(A);
   DO J=1 TO 20;
   PUT FILE(L1) EDIT(PODREI(20*(I-1)+J))(P'(4)Z9');
   END;
   PUT FILE(L1) EDIT(POSTD(I),' PO')(COL(119),P'(5)Z9',A);
   END;
   PUT FILE(L1) SKIP EDIT((9)'-')(COL(119),A);
   PUT FILE(L1) SKIP EDIT
   ('TAGESSUMME  ',PITAG(K1),' PI',POTAG(K1),' PO')
   (COL(106),A,COL(119),P'(5)Z9',A,SKIP,COL(119),P'(5)Z9',A);
 /* SCHAUBILDER */
   CALL KOPF1;
   CALL SCHAU1;
   IF ISCHALT=0 THEN GO TO MONAT; /* SPAETER GO TO MONAT */
   DO I=1 TO 1440;
   SPIMIN(I)=UEBPI(I);
   SPOMIN(I)=UEBPO(I);
   UEBPI(I),UEBPO(I)=0;
   END;
 SO:
   IF UEBTAG=VGLTAG × UEBTAG=STAG THEN DO;
   UEBTAG=STAG;
   VGLTAG=STAG;
   IVTAG=ITAG;
   VGLMON=SMON;
   VGLJR=SJAHR;
   GO TO BERECH1;
   END;
   IF VGLMON ^= SMON THEN DO;
   UEBTAG=STAG;
   GO TO SO;
   END;
 MONAT:
   ISCHALT=2;
   IF IDAT ^= 0 THEN
   PUT PAGE FILE(L2) EDIT
   ('WEGEN FALSCHEN DATUMS WURDEN ',IDAT,' SMF-SAETZE UEBERGANGEN')
   (A,F(5),A);
   DO I=1 TO K1;
   MONSUMPI=MONSUMPI+PITAG(I);
   MONSUMPO=MONSUMPO+POTAG(I);
   END;
   PUT FILE(L1) EDIT
   ('MONATSSUMME = ',MONSUMPI,MONSUMPO)(SKIP,A,(2)P'ZZZ.ZZZ.ZZZ.ZZ9');
   CALL KOPF2;
   CALL SCHAU1;
   CALL SCHAU2;
   CLOSE FILE(BEWERT);
   ISCHALT=1;
   GO TO LESEN;
 ENDE:
   CLOSE FILE(L1);
   CLOSE FILE(L2);
 ZEITBER: PROC;
   SZEITG=SZEITHS/6000;
   EZEITG=EZEITHS/6000;
   END ZEITBER;
 SONDFALL: PROC;
   IF SLTAG=ELTAG THEN GO TO LES2;
   CALL ZEITBER;
   UEBZEIT=EZEITG;
   IF UEBZEIT=0 THEN UEBZEIT=1;
   STEPZEIT=1440 - SZEITG +1;
   EZEITG=1440;
   UEBPIMIN=PI1/(UEBZEIT+STEPZEIT);
   UEBPOMIN=PO1/(UEBZEIT+STEPZEIT);
   PI1=PI1 - UEBPIMIN*UEBZEIT;
   PO1=PO1 - UEBPOMIN*UEBZEIT;
   DO I=1 TO UEBZEIT;
   UEBPI(I)=UEBPI(I)+UEBPIMIN;
   UEBPO(I)=UEBPO(I)+UEBPOMIN;
   END;
   UEBTAG=STAG+1;
   GO TO U3;
   END SONDFALL;
 SATZFR: PROC;
   IF ISCH1=1 THEN DO; /* BATCH + TSO SATZ 4 + 34 */
   IF RECORD ^= 4 & RECORD ^= 34 THEN GO TO MARK1;
   GO TO U2;
   END;
   IF ISCH1=2 THEN DO;     /* NUR BATCH   SATZ 4 */
   IF RECORD ^= 4 THEN GO TO MARK1;
   GO TO U2;
   END;
   IF RECORD ^= 34 THEN GO TO MARK1;
 U2: END SATZFR;
 KALTAG:  PROC;
   IZAE2=0;
   DO I= 1 TO 12;
   IZAE1=IZAE2;
   IZAE2=IZAE2+MON(I);
   IF LTAG <= IZAE2 THEN DO;
   IMONAT=I;
   GO TO DRAU;
   END;
   END;
   IDAT=IDAT+1;
   GO TO LES1;
 DRAU: KTAG=LTAG-IZAE1;
   ITAG=MOD(LTAG+IWT-1,7);
   IF ITAG=0 THEN ITAG=7;
   END KALTAG;
 RICHTIG: PROC;
   IF RECORD = 34 THEN DO;
   EZEITHS=TSOEZHS;
   EDATUM=TSOEDAT;
   END;
   END RICHTIG;
 KOPF1:PROC;/* UEBERSCHRIFT DER TAGESSCHAUBILDER */
   TAGMON(K1)=SUBSTR(WOCHTAG(IVTAG),1,2);
   MPTAG(K1)=VGLTAG;
   DO I=1 TO 24;
   PISEC(I)=PISTD(I)/3600 + 0.005;
   POSEC(I)=POSTD(I)/3600 + 0.005;
   PISTDH(I)=(PISTD(I) + 50)/100;
   POSTDH(I)=(POSTD(I) + 50)/100;
   MPISEC(I)=MPISEC(I) + PISEC(I);
   MPOSEC(I)=MPOSEC(I) + POSEC(I);
   MPISTDH(I)=MPISTDH(I) + PISTD(I);
   MPOSTDH(I)=MPOSTDH(I) + POSTD(I);
   END;
   PISECM=PITAG(K1)/86400 + 0.005;
   POSECM=POTAG(K1)/86400 + 0.005;
   MPISECM=MPISECM + PISECM;
   MPOSECM=MPOSECM + POSECM;
   PUT PAGE FILE(L2) EDIT ('G',K1+2)(SKIP,COL(125),A,P'99');
   PUT FILE(L2) SKIP EDIT
   ('TAGESSTATISTIK DER PAGE-IN UND PAGE-OUT VOM ',WOCHTAG(IVTAG),
    ' DEN ',VGLTAG,'.',VGLMON,'.',VGLJR,'  FUER ',FELD)
    (COL(10),A,A,A,(3)(P'99',A),A);
   PUT SKIP(2) FILE(L2) EDIT
   ('TAGESSUMMEN :',PITAG(K1),' P.I.',POTAG(K1),' P.O.','GESAMT :',
   PITAG(K1)+POTAG(K1),' P.I. + P.O.')
   (A,COL(22),P'ZZ.ZZZ.ZZ9',A,COL(42),P'ZZ.ZZZ.ZZ9',A,COL(60),
    A,P'ZZZ.ZZZ.ZZ9',A);
   PUT SKIP FILE(L2) EDIT
   ('MITTELWERTE/SEC : ===',PISECM,' P.I.  ---',POSECM,' P.O.',
    'GESAMT :',PISECM+POSECM,' P.I. + P.O.')
   (A,COL(22),P'ZZZ.ZZ9V,99',A,COL(42),P'ZZZ.ZZ9V,99',A,COL(60),
    A,P'ZZZZ.ZZ9V,99',A);
   PUT SKIP FILE(L2) EDIT
   ('SUMMEN/STD IN 100 EINHEITEN ')(A);
  END KOPF1;
 KOPF2: PROC;  /*  UEBERSCHRIFT FUER TAGESVERDICHTUNG */
   PISTDH,POSTDH,PISEC,POSEC,MAXTAG=0;
   DO I=1 TO 24;
   IF IMP(I) > 0 THEN DO;
   PISTDH(I)=(MPISTDH(I)+50)/(100*IMP(I));
   POSTDH(I)=(MPOSTDH(I)+50)/(100*IMP(I));
   PISEC(I)=MPISEC(I)/IMP(I) + 0.005;
   POSEC(I)=MPOSEC(I)/IMP(I) + 0.005;
   MAXTAG(I)=MAXSUM(I)/IMP(I) + 0.05;
   END;
   END;
   PISECM,POSECM=0;
   DO I=1 TO 24;
   PISECM=PISECM+PISEC(I);
   POSECM=POSECM+POSEC(I);
   END;
   PISECM=PISECM/24 + 0.005;
   POSECM=POSECM/24 + 0.005;
   PUT PAGE FILE(L2) EDIT
 ('VERDICHTETE TAGESSTATISTIK DER PAGE-IN UND PAGE-OUT VOM ',
   FTAG,'.',FMON,'.',FJR,' BIS ZUM ',
   LASTTAG,'.',LASTMON,'.',LASTJR,' FUER ',FELD,'G01')
   (SKIP,A,(6)(P'99',A),A(13),X(24),A(3));
   K=K1;
   IF K=0 THEN DO; PUT SKIP LIST('K=0');GO TO ENDE;END;
   MONPIM=MONSUMPI/K; MONPOM=MONSUMPO/K;
   PUT SKIP(2) FILE(L2) EDIT
   ('MITTLERE SUMME/ATAG : ',MONPIM,' P.I.     ',MONPOM,
    ' P.O.')(A,COL(23),(2)(P'ZZZ.ZZZ.ZZ9',A));
   PUT FILE(L2) EDIT('GESAMT :',MONPIM+MONPOM,' P.I. + P.O.')
   (COL(65),A,P'ZZZ.ZZZ.ZZ9',A);
   PUT SKIP FILE(L2) EDIT
   ('MITTELWERTE/SEC :    ',PISECM,' P.I. === ',POSECM,' P.O. ---',
    'GESAMT :',PISECM+POSECM,' P.I. + P.O')
   (A,COL(23),(2)(P'ZZZZ.ZZ9V,99',A),COL(65),A,P'ZZZZ.ZZ9V,99',A);
   PUT SKIP FILE(L2) EDIT
   ('MITTELWERTE/STD IN 100 EINHEITEN ')(A);
   END KOPF2;
 SCHAU1: PROC;
   PUT FILE(L2) SKIP EDIT('PI/STD  ')(A);
   DO I=1 TO 24;
   PUT FILE(L2) EDIT(PISTDH(I))(P'ZZZZ9');
   END;
   PUT FILE(L2) SKIP EDIT('PO/STD  ')(A);
   DO I=1 TO 24;
   PUT FILE(L2) EDIT(POSTDH(I))(P'ZZZZ9');
   END;
   PUT FILE(L2) SKIP EDIT((132)'=','= PI/SEC ')(A,SKIP,A);
   DO I=1 TO 24;
   PUT FILE(L2) EDIT(PISEC(I))(P'ZZ9V,9');
   END;
   PUT FILE(L2) EDIT('=')(COL(132),A);
   PUT FILE(L2) SKIP EDIT('= PO/SEC ')(A);
   DO I=1 TO 24;
   PUT FILE(L2) EDIT(POSEC(I))(P'ZZ9V,9');
   END;
   PUT FILE(L2) EDIT ('=')(COL(132),A);
    PUT SKIP FILE(L2) EDIT('= MAXPAGE')(A);
    DO I=1 TO 24;
    PUT FILE(L2) EDIT(MAXTAG(I))(P'ZZ9V,9');
    IF MAXTAG(I) > MAX THEN MAXTAG(I)=MAX;
    END;
    PUT FILE(L2) EDIT('  =')(A);
   SUMSECM=PISECM+POSECM;
   MAX1=MAX;
   MAXU=MAX1-STEP*0.5;
   MAXO=MAX1+STEP*0.5;
   DO JSTEP=MAX TO STEP BY -STEP;
   MERK1,MERK2=0;
   PUT SKIP FILE(L2) EDIT('=',MAX1,' I')(A,P'ZZ9V,99',A);
   DO I=1 TO 24;
   SUMSEC=PISEC(I)+POSEC(I);
   IF SUMSECM >= MAXU & SUMSECM < MAXO THEN  DO;
   PUT FILE(L2) EDIT((3)'=')(A); MERK1=1;GO TO DOS1;
   END;
   IF POSECM>= MAXU & POSECM < MAXO THEN DO;
   PUT FILE(L2) EDIT((3)'-')(A); MERK2=1; GO TO DOS1;
   END;
   PUT FILE(L2) EDIT((3)' ')(A);
 DOS1:
   IF MAXTAG(I) >= MAXU & MAXTAG(I) < MAXO THEN DO;
   PUT FILE(L2) EDIT('MP')(A); GO TO DOS2; END;
   IF POSEC(I) >= MAXU THEN DO;
   PUT FILE(L2) EDIT('**')(A); GO TO DOS2;
   END;
   IF SUMSEC >= MAXU THEN
   PUT FILE(L2) EDIT('++')(A);
   ELSE DO;
   IF MERK1=1 THEN DO;PUT FILE(L2) EDIT('==')(A); GO TO DOS2; END;
   IF MERK2=1 THEN DO;PUT FILE(L2) EDIT('--')(A); GO TO DOS2; END;
   PUT FILE(L2) EDIT('  ')(A);
   END;
 DOS2: END;
   PUT FILE(L2) EDIT('  =')(A);
   MAX1=MAX1-STEP;
   MAXU=MAX1-0.5*STEP;
   MAXO=MAX1+0.5*STEP;
   END;
   PUT SKIP FILE(L2) EDIT('=       I')(A);
   DO I=1 TO 24;
   PUT FILE(L2) EDIT('---II')(A);
   END;
   PUT FILE(L2) EDIT('->=')(A);
   IF ISCHALT=2 THEN
   PUT SKIP FILE(L2) EDIT
   ('=  ASTD  ',(IMP(I) DO I=1 TO 24),'=')
   (A,(24)(P'ZZZZ9'),COL(132),A);
   PUT SKIP FILE(L2) EDIT('=       0')(A);
   DO I=1 TO 24;
   PUT FILE(L2) EDIT(I)(X(3),P'Z9');
   END;
   PUT FILE(L2) EDIT('=')(COL(132),A);
   PUT SKIP FILE(L2) EDIT('=','=')(A,COL(132),A);
   PUT SKIP FILE(L2) EDIT('= ++ PAGE-IN/SEC','TAGESZEIT(STD)','=')
   (A,COL(110),A,COL(132),A);
   PUT SKIP FILE(L2) EDIT('= ** PAGE-OUT/SEC','=',(132)'=')
   (A,COL(132),A,SKIP,A);
   END SCHAU1;
 SCHAU2: PROC;
   PUT FILE(L2) PAGE EDIT
   ('MONATSSTATISTIK DER PAGE-IN UND PAGE-OUT PRO TAG VOM ',
    FTAG,'.',FMON,'.',FJR,' BIS ZUM ',
   LASTTAG,'.',LASTMON,'.',LASTJR,' FUER ',FELD,'G02')
   (SKIP,A,(6)(P'99',A),A,COL(125),A);
   PUT FILE(L2) EDIT
   ('MONATSSUMMEN :',MONSUMPI,' P.I.',MONSUMPO,' P.O.','GESAMT :',
   MONSUMPI+MONSUMPO,' P.I. + P.O.')
   (SKIP(2),A,(2)(P'BZZ.ZZZ.ZZZ.ZZ9',A),COL(60),A,P'ZZZ.ZZZ.ZZZ.ZZ9',A);
   PUT SKIP FILE(L2) EDIT
   ('MITTELWERTE/SEC :    ',MONSUMPI/(86400*K) + 0.005,' P.I.===    ',
   MONSUMPO/(86400*K)+ 0.005,' P.O.---','GESAMT :',
   MONSUMPI/(86400*K)+MONSUMPO/(86400*K)+0.005,' P.I. + P.O.')
   ((2)(A,P'Z.ZZ9V,99'),A,COL(60),A,X(7),P'Z.ZZ9V,99',A);
   PUT FILE(L2) SKIP EDIT
   ('SUMMEN/TAG IN 1000 EINHEITEN','PI/TAG   ')(A,SKIP,A);
   DO I=1 TO K;
   PUT FILE(L2) EDIT((PITAG(I)+500)/1000)(P'ZZZ9');
   END;
   PUT FILE(L2) EDIT('PO/TAG   ')(SKIP,A);
   DO I=1 TO K;
   PUT FILE(L2) EDIT((POTAG(I)+500)/1000)(P'ZZZ9');
   END;
   PUT FILE(L2) SKIP EDIT(SUBSTR(GLEICH,1,4*K+12))(A);
   PUT FILE(L2) SKIP EDIT('= PI/SEC ')(A);
   DO I=1 TO K;
   PUT FILE(L2) EDIT(PITAG(I)/86400+0.5)(P'ZZZ9');
   END;
   PUT FILE(L2) EDIT('  =','= PO/SEC ')(A,SKIP,A);
   DO I=1 TO K;
   PUT FILE(L2) EDIT(POTAG(I)/86400 +0.5)(P'ZZZ9');
   END;
   PUT FILE(L2) EDIT('  =')(A);
   SUMSECM=MONSUMPI/(86400*K) + MONSUMPO/(86400*K) + 0.005;
   PUT SKIP FILE(L2) EDIT('= MAXPAGE')(A);
   DO I= 1 TO K;
   PUT FILE(L2) EDIT(MAXMON(I))(P'ZZZ9');
   IF MAXMON(I) > MAX THEN MAXMON(I)=MAX;
   END;
   PUT FILE(L2) EDIT('  =')(A);
   MAX1=MAX;
   MAXU=MAX1-STEP*0.5;
   MAXO=MAX1+STEP*0.5;
   DO JSTEP=MAX TO STEP BY -STEP;
   MERK1,MERK2=0;
   PUT SKIP FILE(L2) EDIT('=',MAX1,' I')(A,P'ZZ9V,99',A);
   DO I=1 TO K;
   SUMSEC=(PITAG(I)+POTAG(I))/86400 + 0.005;
   IF SUMSECM >= MAXU & SUMSECM < MAXO THEN DO;
   PUT FILE(L2) EDIT('==')(A); MERK1=1;GO TO BOS1;
   END;
   IF MONSUMPO/(86400*K) + 0.005 >= MAXU &
      MONSUMPO/(86400*K) + 0.005 < MAXO THEN DO;
   PUT FILE(L2) EDIT ('--')(A); MERK2=1; GO TO BOS1; END;
   PUT FILE(L2) EDIT ('  ')(A);
 BOS1:
   IF MAXMON(I) >= MAXU & MAXMON(I) < MAXO THEN DO;
   PUT FILE(L2) EDIT('MP')(A); GO TO BOS2; END;
   IF POTAG(I)/86400 + 0.005 >= MAXU THEN DO;
   PUT FILE(L2) EDIT('**')(A);
   GO TO BOS2; END;
   IF SUMSEC >= MAXU THEN PUT FILE(L2) EDIT('++')(A);
   ELSE DO;
   IF MERK1=1 THEN DO;
   PUT FILE(L2) EDIT('==')(A); GO TO BOS2; END;
   IF MERK2=1 THEN DO;
   PUT FILE(L2) EDIT('--')(A); GO TO BOS2; END;
   PUT FILE(L2) EDIT('  ')(A);
   END;
 BOS2: END;
   PUT FILE(L2) EDIT('  =')(A);
   MAX1=MAX1-STEP;
   MAXU=MAX1-STEP*0.5;
   MAXO=MAX1+STEP*0.5;
   END;
   PUT SKIP FILE(L2) EDIT('=       I')(A);
   DO I=1 TO K;
   PUT FILE(L2) EDIT('--II')(A);
   END;
   PUT FILE(L2) EDIT('->=','= DATUM')(A,SKIP,A(9));
   DO I=1 TO K;
   PUT FILE(L2) EDIT(MPTAG(I))(P'BBZ9');
   END;
   PUT FILE(L2) EDIT('  =','=')(A,SKIP,A(9));
   DO I=1 TO K;
   PUT FILE(L2) EDIT(TAGMON(I))(X(2),A); END;
   PUT FILE(L2) EDIT
   ('  =','=','=')(A,SKIP,A,COL(4*K+12),A);
   PUT FILE(L2) SKIP EDIT
   ('= ++ PAGE-IN /SEC','=','= ** PAGE-OUT/SEC','=',
   SUBSTR(GLEICH,1,12+4*K))
   (A,COL(4*K+12),A,SKIP,A,COL(4*K+12),A,SKIP,A);
   END SCHAU2;
   END PAGE;

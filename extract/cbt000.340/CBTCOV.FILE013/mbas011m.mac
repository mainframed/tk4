./ ADD  NAME=$CL1L00
         MACRO
&NAME    $CL1L00 &DSECT=NO
.*-------------------------------------------------------------------*
.*       GENERATE THE CL1 LOADER CSECT                               *
.*-------------------------------------------------------------------*
.*
         AIF   ('&DSECT' EQ 'NO').CSECT
&NAME    DSECT
         AGO   .A010
.CSECT   ANOP
CLIST    CSECT
         WXTRN CL1L00
.A010    STM   14,2,12(13)         SAVE REGS
         LR    2,15                SET BASE
         USING CLIST,2
*
         ICM   15,15,LOADER        PICK UP 'LOADER' ADDRESS
         BNZ   CL0010              BRANCH IF RESOLVED
         LOAD  EP=CL1L00           LOAD THE 'LOADER'
         LR    15,0                SET LOADER EP
CL0010   LA    0,VCONS             ADDRESS THE VCONS
         L     14,12(,13)          RESTORE RETURN ADDRESS
         LM    1,2,24(13)          RESTORE REGS
         BR    15                  BRANCH TO THE LOADER
*
LOADER   DC    A(CL1L00)
VCONS    DC    A(PCL)
         DC    A(PROCBLOK)
         EJECT
         MEND
./ ADD  NAME=$IKJLPCS
         MACRO
         $IKJLPCS
$LIST    IKJKEYWD
         IKJNAME '$LIST'
$PROMPT  IKJKEYWD
         IKJNAME '$PROMPT'
$CONLIST IKJKEYWD
         IKJNAME '$CONLIST'
$SYMLIST IKJKEYWD
         IKJNAME '$SYMLIST'
$VERSION IKJKEYWD
         IKJNAME '$VERSION'
         MEND
./ ADD  NAME=ARCHIV
** TITLE   INTERFACE ZU TMS
** OWNER   128.FRANZ
** LCHNG   07/25/83 09:27:27   Z227128 FRANZ
         MACRO
&NAME    ARCHIV &OP,&ADDR,&CCHH,&SVC
.*
.**********************************************************************
.*                                                                    *
.*       5788-DHL COPYRIGHT IBM DEUTSCHLAND GMBH 1978                 *
.*      (SIEHE IBM COPYRIGHT-RICHTLINIEN FORM 30 617-4)               *
.*                                                                    *
.**********************************************************************
.*
.*       STAND VOM 25.07.1983
.*       LAST MODIFICATION BY H. FRANZ
.*
         AIF   ('&OP' EQ 'READ').READ
         AIF   ('&OP' EQ 'WRITE').WRITE
         AIF   ('&OP' EQ 'SMF').SMF
         AIF   ('&OP' EQ 'EVENT').EVENT
         AIF   ('&OP' EQ 'STATM').STATM
         AIF   ('&OP' EQ 'STATC').STATC
         AIF   ('&OP' EQ 'CHECK').CHECK
         AIF   ('&OP' EQ 'UPDATE').UPDATE
         AIF   ('&OP' EQ 'ENQ').ENQ
         AIF   ('&OP' EQ 'DEQ').DEQ
         AIF   ('&OP' EQ 'OPVSAM').OPVSAM
         AIF   ('&OP' EQ 'OPEN').OPEN
         AIF   ('&OP' EQ 'SAVE').SAVE
         AIF   ('&OP' EQ 'CLOSE').CLOSE
         AIF   ('&OP' EQ 'LOCATE').LOCATE
         AIF   ('&OP' EQ 'UNAVAIL').UNAVAIL
         AIF   ('&OP' EQ 'SVC').SVC
         AIF   ('&OP' EQ 'LIST').LIST
         MNOTE 8,'INVALID FUNCTION PARAMETER'
         MEXIT
.READ    ANOP
&NAME    SR    0,0                INDICATE READ
         AGO   .RW
.SMF     ANOP
&NAME    LA    0,1                INDICATE WRITE SMF
         AGO   .RW
.EVENT   ANOP
&NAME    SR    1,1                CLEAR PARAMETER REGISTER
         LA    0,2                INDICATE EVENT REQUEST
         AGO   .RW1
.STATM   ANOP
&NAME    SR    1,1                CLEAR PARAMETER REGISTER
         LA    0,3                INDICATE STATUS MODIFY REQUEST
         AGO   .RW1
.STATC   ANOP
&NAME    SR    1,1                CLEAR PARAMETER REGISTER
         LA    0,4                INDICATE STATUS CLEAR REQUEST
         AGO   .RW1
.WRITE   ANOP
&NAME    LA    0,1                INDICATE WRITE
         SLL   0,31
.RW      LA    1,&ADDR            GET RECORD AREA
.RW1     LA    15,1               GET INDICATOR
         SLL   15,24              - FOR SVC 251-1
         OR    1,15               INDICATE SVC 251-1
         AGO   .SVC251
.CHECK   AIF   (T'&CCHH EQ 'O').NOUCB
&NAME    LA    0,&CCHH            GET UCB ADDRESS
         LA    1,1                INDICATE
         SLL   1,31               - CHECK FOR FREE VOLUME
         OR    0,1                GET INDICATOR
         AGO   .CHIND
.NOUCB   ANOP
&NAME    LA    0,1                INDICATE
         SLL   0,31               - CHECK FOR FREE VOLUME
.CHIND   LA    15,2               GET INDICATOR
         SLL   15,24              - FOR SVC 251-2
         LA    1,&ADDR            GET ADDRESS OF VOLSER
         OR    1,15               INDICATE SVC 251-2
         AGO   .SVC251
.UPDATE  ANOP
&NAME    LA    0,&ADDR             GET ADDRESS OF O/C/E WORKAREA
         LA    15,2                GET INDICATOR
         SLL   15,24               - FOR SVC 251-2
         LA    1,&CCHH             GET UCB ADDRESS
         OR    1,15                INDICATE SVC 251-2
         AGO   .SVC251
.OPVSAM  ANOP
&NAME    LA    15,4                GET INDICATOR
         SLL   15,24               - FOR OPEN AUTHORIZED DATASET
         LA    1,&ADDR             GET ACB/DCB ADDRESS
         OR    1,15                INDICATE SVC 251-4
         AGO   .SVC251
.ENQ     ANOP
&NAME    LA    0,1                 INDICATE ENQ/RESERVE
         AGO   .ENQDEQ
.DEQ     ANOP
&NAME    LA    0,2                 INDICATE DEQ
.ENQDEQ  LNR   0,0                 SET INDICATOR NEGATIVE
         LA    15,8                GET INDICATOR
         SLL   15,24               - FOR SVC 251-8
         LA    1,&ADDR             GET ENQ/DEQ LIST
         OR    1,15                INDICATE SVC 251-8
         AGO   .SVC251
.SAVE    ANOP
&NAME    DS    0H
* ON THIS POINT REG1 MUST CONTAIN ARCHIV'S UCB ADDRESS
* AND REG0 ITS STARTING CYLINDER IN BINARY.
         AGO   .SVC252
.CLOSE   ANOP
&NAME    LA    1,1                INDICATE
         SLL   1,31               - CLOSE SYS1.ARCHIV
         AGO   .SVC252
.LOCATE  ANOP
&NAME    SR    1,1                INDICATE LOCATE
         AGO   .SVC252
.UNAVAIL ANOP
&NAME    LA    1,1                INDICATE
         LNR   1,1                - SYS1.ARCHIV UNAVAILABLE
.SVC252  CNOP  0,4                ENSURE FULLWORD BOUNDARY
         B     *+8                BRANCH AROUND VCON
         DC    V(ARCHSVC)         EXTERNAL REFERENCE
         AIF   ('&SVC' EQ 'SVC').SVC252S
         L     15,*-4             PICK UP START OF ARCHSVC
         EX    0,2(15)            EXECUTE SVC 252
         MEXIT
.SVC252S EX    0,ARCHSVC+2        EXECUTE SVC 252
         MEXIT
.OPEN    ANOP
&NAME    LA    1,3                INDICATE
         SLL   1,24               - SVC 251-3
.SVC251  CNOP  0,4                ENSURE FULLWORD BOUNDARY
         B     *+8                BRANCH AROUND VCON
         DC    V(ARCHSVC)         EXTERNAL REFERENCE
         AIF   ('&SVC' EQ 'SVC').SVC251S
         L     15,*-4             PICK UP START OF ARCHSVC
         EX    0,0(15)            EXECUTE SVC 251
         MEXIT
.SVC251S EX    0,ARCHSVC          EXECUTE SVC 251
         MEXIT
.SVC     ANOP
ARCHSVC  CSECT
         SVC   &ADDR              TYPE 4 SVC (251)
         SVC   &CCHH              TYPE 1 SVC (252)
         MEXIT
.LIST    ANOP
         AIF   ('&ADDR' NE 'SMF').ALIST
* SMF RECORD PREFIX RECORD TYPE 220 AND 221
         CNOP  2,4 .                   TO GET FULLWORD BOUNDARY
&NAME    DS    0H .                    START OF SMF RECORD
SLEN     DS    H .                     LENGTH
SSPAN    DS    H .                     SPAN INFO RESERVED
SSYS     DS    X .                     SYSTEM INDICATOR
STYPE    DS    X .                     RECORD TYPE
         AIF   ('&CCHH' NE 'OLD').ARCHR
SEVENT   DS    0F
.ARCHR   ANOP
STDAY    DS    F .                     TIME OF DAY
SDATE    DS    F .                     DAY
SID      DS    H .                     SYSTEM ID
SMOD     DS    H .                     MODEL NUMBER
SJNAME   DS    CL8 .                   JOBNAME
STSTAMP  DS    F .                     JOB TIME STAMP
SDSTAMP  DS    F .                     JOB DATE STAMP
SJID     DS    CL8 .                   JOB ID
         AIF   ('&CCHH' EQ 'OLD').NOSMF
SEVENT   DS    F .                     EVENT COUNT
         AGO   .NOSMF
.ALIST   ANOP
&NAME    DS    0F .                    ENSURE FULLWORD BOUNDARY
.NOSMF   ANOP
* ARCHIV RECORD
ARCVOL   DS    CL06 .                  VOLUME-SERIAL-NUMBER
* RECORD TYPE D, DATA RECORD
ARCDSN   DS    CL44 .                  DATA-SET-NAME
ARCSTAT  DS    XL01 .                  STATUS
ARCFSEQ  DS    XL01 .                  FILE-SEQUENCE-NUMBER
ARCVSEQ  DS    XL02 .                  VOLUME-SEQUENCE-NUMBER
ARCCRDT  DS    XL03 .                  CREATION-DATE
ARCXPDT  DS    XL03 .                  EXPIRATION-DATE
ARCUSED  DS    XL02 .                  USE-COUNT
ARCAUFTR DS    CL08 .                  AUFTRAGSNUMMER
ARCKST   DS    CL04 .                  KOSTENSTELLE
ARCAGG   DS    CL03 .                  ARBEITSGANG
ARCORT   DS    0XL02 .                 STORE-ROOM
ARCORT1  DS    XL01 .                             NORMAL
ARCORT2  DS    XL01 .                             SAFETY
ARCSW    DS    XL01 .                  SWITCH
ANSI     EQU   B'10000000' .           TRANSFER TO SAFETY
AUSI     EQU   B'01000000' .           TRANSFER FROM SAVETY
INSI     EQU   B'00100000' .           IN SAVETY
INFR     EQU   B'00010000' .           FREELIST SWITCH
DEFSTA   EQU   B'00001000' .           DEFERRED STATUS CHANGE
*        EQU   B'00000100' .           RESERVED
*        EQU   B'00000010' .           RESERVED
FRDR     EQU   B'00000001' .           FREE VOLUME
ARCUSFLD DS    XL01 .                  USERFIELD
* RECORD TYPE I, INDEX RECORD
         ORG   ARCDSN
ARCIVOL1 DS    CL6 .                   HIGHEST VOLSER TRACK 1
ARCICCT1 DS    XL4 .                   CCHH TRACK 1
         DS    6XL10 .                 VOLSER AND CCHH TRACK 2-7
         DS    XL5 .                   RESERVED
* RECORD TYPE H, HEADER RECORD
         ORG   ARCDSN
ARCDAT   DS    CL16 .                  DATE AND TIME DD.MM.YYHH.MM.SS
         DS    X .                     RESERVED
ARCPGM   DS    CL8 .                   PROGRAM NAME
         DS    X .                     RESERVED
ARCCAP   DS    F .                     CAPACITY OF ARCHIV
ARCEVENT DS    F .                     EVENT COUNT
ARCOUNT  DS    H .                     VOLUMES IN ARCHIV
         DS    H       RESERVED                              BASF
ARCSTCNT DS    H       COUNT OF ONLINE STATUS MODIFICATIONS  BASF
         ORG
ARCSA    DS    CL01 .                  RECORD IDENTIFIER I=INDEX-REC.
*                                                        D=DATA-RECORD
*                                                        H=HEADER-REC.
ARCJOBNM DS    CL8            NAME OF CREATING JOB
ARCSTEPN DS    CL8            NAME OF CREATING STEP OR PROC
ARCUNIT  DS    CL3            UNIT ADDRESS ON WHICH TAPE IS CREATED
ARCFLAG  DS    CL1            FLAG TO INDICATE DEFECTIVE TAPE
ARCCRTIM DS    CL8            CREATION TIME AND DATE OF TAPE
ARCLRU   DS    CL4            DATE LAST USED
ARCSIO   DS    CL2            START I/O'S
ARCBLK   DS    CL2            BLOCKSIZE
ARCMOUNT DS    CL2            NO. OF MOUNTS
ARCEND   EQU   *
ARCDLEN  EQU   *-ARCDSN .              LENGTH OF ARCHIV-RECORD
ARCTLEN  EQU   *-ARCVOL .              TOTAL LENGTH OF ARCHIV-RECORD
ARCBLKSI EQU   ARCTLEN*25     BLOCKSIZE OF SEQUENTIELL ARCHIV DATA
*
ARCFAC   EQU   7                       BLOCKING FACTOR
         AIF   ('&ADDR' EQ 'SMF').ACAT
         MEXIT
.ACAT    ANOP
         ORG   ARCVOL
* CAMLIST PARAMETERS
SCAML    DS    H .                     LENGTH OF CATALOG LIST
SCAMFL   DS    XL4 .                   CAMLIST FLAGS
SDSN     DS    CL44 .                  DATASET NAME
SCVOLTYP DS    XL4 .                   CONTROL VOLUME TYPE
SCVOL    DS    CL6 .                   CONTROL VOLUME SERIAL
SCDSCBTT DS    XL3 .                   DSCBTTR
SCVAR    DS    0H .                    VARIABLE PART
SCALIAS  DS    CL8 .                   ALIAS NAME FOR BLDA
         ORG   SCVAR
SCLNKX   DS    XL10 .                  VOL ID FOR LNKX
         ORG   SCVAR
SVOLCNT  DS    H .                     VOLUME COUNT
SVOL     DS    0X .                    VARIABLE VOLUME LIST
         ORG
         MEND
./ ADD  NAME=BACK
         MACRO
&NAME    BACK  &RC
         GBLA  &GBASISA
         GBLC  &NAM(20)
         LCLA  &A
         LCLB  &I,&J,&K,&L
         LCLC  &V
         ACTR  100
.* TEST IF SAVEAREA GIVEN
&A       SETA  1
         AIF   (&GBASISA EQ 0).BACK1
         AIF   (&GBASISA LE 20).BACK2
.BACK1   MNOTE 0,'NO CORRESPONDING BASIS FOUND'
&J       SETB  1
         AGO   .BACK3
.BACK2   AIF   ('&NAM(&A)' EQ '&SYSECT').BACK3
         AIF   (&A EQ &GBASISA).BACK1
&A       SETA  &A+1
         AGO   .BACK2
.* TEST IF &RC IS GIVEN
.BACK3   AIF   (N'&SYSLIST EQ 0).BACK6
         AIF   ('&RC' EQ '').BACK6
.BACK4   AIF   ('&RC' EQ '(15)').BACK7
         AIF   (T'&RC EQ 'N').BACK5
         MNOTE 0,'PARAMETER NO SELF DEFINING TERM -IGNORED-'
         AGO   .BACK6
.BACK5   AIF   (&RC LE 4095).BACK8
         MNOTE 0,'''&RC'' IS GREATER THAN 4095 -SET TO 0-'
.BACK6   ANOP
&K       SETB  1
         AGO   .BACK9
.BACK7   ANOP
&I       SETB  1
.BACK8   ANOP
&L       SETB  1
.* TEST IF MORE THAN ONE PARAMETER
.BACK9   AIF   (N'&SYSLIST LE 1).BACK10
         MNOTE 0,'MORE THAN ONE PARAMETER -REST IGNORED-'
.BACK10  AIF   (&J).BACK11
&V       SETC  'C'.'&A'.'W'
.BACK11  ANOP
*
* RETURN TO CALLING SECTION
*
         AIF   (&J).BACK12
&NAME    LA    13,&V                   GET EADRESS OF OWN SAVEAREA
         L     13,4(13)          GET ADRESS OF CALLING SAVEAREA
         AGO   .BACK13
.BACK12  ANOP
&NAME    L     13,4(13)          GET ADRESS OF CALLING SAVEAREA
.BACK13  ANOP
         XC    8(4,13),8(13)     RESET POINTER TO OWN SAVEAREA
         L     14,12(13)         LOAD REGISTER 14 WITH RETURN ADRESS
         AIF   (&I).BACK15
         AIF   (&L).BACK14
         SR    15,15
         AGO   .BACK15
.BACK14  ANOP
         LA    15,&RC            LOAD RETURN CODE TO REGISTER 15
.BACK15  ANOP
         LM    0,12,20(13)       RESTORE REGISTERS FROM CALLING SAVEA
         BR    14                RETURN TO CALLING SECTION
         SPACE 3
         MEND
./ ADD  NAME=BASIS
         MACRO
&NAME    BASIS &BR,&ID,&APL,&MORE
         GBLA  &GBASISA
         GBLC  &NAM(20)
         LCLA  &A,&B,&C,&D,&E,&F,&G,&H,&AA,&CC
         LCLB  &J,&K,&L,&N,&M,&O
         LCLC  &S,&T,&U,&V
         ACTR  100
&O       SETB  0
.* TEST SECTION IDENTIFIER
         AIF   ('&ID' EQ '').THREE
&A       SETA  K'&ID
&B       SETA  0
         AIF   ('&ID'(1,1) NE '''').QUOT3
.QUOT1   ANOP
         AIF   ('&ID'(&A,1) EQ '''').QUOT2
         MNOTE 0,'SECOND QUOTE MISSING'
&A       SETA  K'&ID-1
         AGO   .QUOT3
.QUOT2   ANOP
&A       SETA  K'&ID-2
.QUOT3   ANOP
         AIF   ('&ID' EQ '*').THREE
*
*  SECTION IDENTIFIER                  MACRO DRZ HH (OS) *VERS.2* 8.70
*
&CC      SETA  ((&A+2)/2)*2+4
&NAME    B     &CC.(0,15)              BRANCH AROUND IDENTIFIER
         DC    AL1(&A)                 LENGTH OF IDENTIFIER
         AIF   ('&ID'(1,1) NE '''').QUOT4
&B       SETA  &B+1
.QUOT4   ANOP
.ONE     AIF   (&A GT 8).TWO
         AIF   (&A EQ 0).NINE
&S       SETC  '&ID'(&B+1,&A)          IDENTIFIER
         DC    CL&A'&S'
         AGO   .NINE
.TWO     ANOP
&S       SETC  '&ID'(&B+1,8)           IDENTIFIER
         DC    CL8'&S'
&B       SETA  &B+8
&A       SETA  &A-8
         AGO   .ONE
.THREE   AIF   ('&NAME' EQ '').SEVEN
&S       SETC  '&NAME'
.FOUR    ANOP
&A       SETA  1
.FIVE    AIF   ('&S'(1,&A) EQ '&S').SIX
&A       SETA  &A+1
         AGO   .FIVE
.SIX     ANOP
*
*  SECTION IDENTIFIER                  MACRO DRZ HH (OS) *VERS.2* 8.70
*
&CC      SETA  ((&A+2)/2)*2+4
&NAME    B     &CC.(0,15)              BRANCH AROUND IDENTIFIER
         DC    AL1(&A)                 LENGTH OF IDENTIFIER
         DC    CL&A'&S'                IDENTIFIER
         AGO   .NINE
.SEVEN   AIF   ('&SYSECT' EQ '').EIGHT
&S       SETC  '&SYSECT'
         AGO   .FOUR
.EIGHT   ANOP
&N       SETB  1
&S       SETC  'NO*NAME'
         AGO   .FOUR
.NINE    DC    0H'0'
         AIF   (NOT &N).TEN
         MNOTE 0,'NO IDENTIFIER GIVEN -SET TO ''NO*NAME''-'
&N       SETB  0
.TEN     AIF   (&GBASISA GE 1).BASIS00
&GBASISA SETA  1
.BASIS00 ANOP
&S       SETC  '11'
&A       SETA  N'&BR
         AIF   (&A LE 4).BASIS01
&N       SETB  1
.* TEST SECTION INITIATION
&A       SETA  4
.BASIS01 AIF   (&A NE 0).BASIS02
&E       SETA  12
         AGO   .BASIS08
.BASIS02 ANOP
&C       SETA  &A
.BASIS03 ANOP
         AIF   (T'&BR(&C) NE 'O').BASI03A
         MNOTE 255,'INVALID REGISTER NOTATION -MACRO IGNORED-'
         AGO   .FINI
.BASI03A ANOP
&D       SETA  &BR(&C)
         AIF   (&D LT 13 AND &D GT 1).BASIS04
         MNOTE 255,'''&D'' INVALID REGISTER NOTATION -MACRO IGNORED-'
         AGO   .FINI
.BASIS04 ANOP
&C       SETA  &C-1
         AIF   (&C NE 0).BASIS03
&C       SETA  &BR(1)
         AIF   (&C NE 11).BASIS05
&S       SETC  '12'
.BASIS05 ANOP
&E       SETA  &BR(1)
         AIF   (&A EQ 1).BASIS08
&J       SETB  1
&F       SETA  &BR(2)
         AIF   (&E NE &F).BASIS07
.BASIS06 ANOP
         MNOTE 255,'DUPLICATE BASIS REGISTERS -MACRO IGNORED-'
         AGO   .FINI
.BASIS07 AIF   (&A EQ 2).BASIS08
&K       SETB  1
&G       SETA  &BR(3)
         AIF   (&G EQ &E OR &G EQ &F).BASIS06
         AIF   (&A EQ 3).BASIS08
&L       SETB  1
&H       SETA  &BR(4)
         AIF   (&H EQ &G OR &H EQ &E OR &H EQ &F).BASIS06
.BASIS08 ANOP
&AA      SETA  1
         AIF   (&GBASISA LE 20).BASIS09
         MNOTE 255,'MORE THAN 20 MACRO-CALLS -MACRO IGNORED-'
         AGO   .FINI
.BASIS09 AIF   (&AA EQ &GBASISA).BASIS10
         AIF   ('&NAM(&AA)' EQ '&SYSECT').BASIS11
&AA      SETA  &AA+1
         AGO   .BASIS09
.BASIS10 ANOP
&NAM(&GBASISA) SETC '&SYSECT'
&GBASISA SETA  &GBASISA+1
         AGO   .BASIS12
.BASIS11 MNOTE 0,'MACRO USED MORE THAN ONE TIME IN A CSECT'
&M       SETB  1
.BASIS12 ANOP
&V       SETC  'C'.'&AA'.'W'
*
* SECTION INITIALIZATION               MACRO DRZ HH (OS) *VERS.2* 8.70
*
         AIF   ('&ID' NE '').BASIS13
         STM   14,12,12(13)
         AGO   .BASIS14
.BASIS13 STM   14,12,12(13)
.BASIS14 ANOP
A&SYSNDX.W BALR  &E,0                  LOAD BASEREGISTER 1
         AIF   (&J).BASIS20
         USING *,&E
         AGO   .BASIS23
.BASIS20 AIF   (&K).BASIS21
         USING *,&E,&F
         AGO   .BASIS23
.BASIS21 AIF   (&L).BASIS22
         USING *,&E,&F,&G
         AGO   .BASIS23
.BASIS22 USING *,&E,&F,&G,&H
.BASIS23 ANOP
&U       SETC  'D'.'&SYSNDX'.'W'
B&SYSNDX.W LA  &S,&V         GET ADRESS OF OWN SAVEAREA
         ST    &S,8(13)      STORE ADR. OF OWN SAVEA TO CALLING SAVEA
         ST    13,4(&S)      STORE ADR. OF CALLING SAVEA TO OWN SAVEA
         AIF   ('&APL' EQ '').BASI231
         LR    1,13
         CLC   4(4,1),&APL   ADRESS OF HIGHER SAVEAREA ZERO?
         BE    C&SYSNDX.W    IF SYSTEM SAVEAREA IS REACHED
         ST    1,&APL+4      SAVE ADRESS OF SAVEAREA
         L     1,4(1)        CHAIN BACK TO HIGHER SAVEAREA
         CLC   &APL+4(4),8(1) BACK CHAINING OK?
         BE    *-24                    IF OK - LOOP
         ABEND 254,DUMP                IF BACK CHAINING INVALID
C&SYSNDX.W L   1,24(1)       GET ADRESS OF SYSTEM PARAMETER LIST
         ST    1,&APL        APPLY SYSTEM PARAMETER LIST
&O       SETB  1
.BASI231 L     1,24(13)      GET ADRESS OF CALLING PROGRAM PARAM. LIST
         LR    13,&S         LOAD ADRESS OF OWN SAVEAREA TO REG. 13
         XC    8(4,13),8(13) CLEAR ADRESS OF LOWER SAVEAREA
         AIF   (NOT &J).BASIS24
         L     &BR(2),&U
.BASIS24 AIF   (NOT &K).BASIS25
         L     &BR(3),&U+4
.BASIS25 AIF   (NOT &L).BASIS26
         L     &BR(4),&U+8   LOAD BASEREGISTER 4
.BASIS26 B     E&SYSNDX.W              BRANCH AROUND CONSTANTS
         AIF   (&M).BASI26A
&V       DC    18F'0'                  OWN SAVEAREA
.BASI26A AIF   (NOT &J).BASIS27
&U       DC    A(A&SYSNDX.W+2+4096)    BASIS FOR BASEREGISTER 2
.BASIS27 AIF   (NOT &K).BASIS28
         DC    A(A&SYSNDX.W+2+2*4096)  BASIS FOR BASEREGISTER 3
.BASIS28 AIF   (NOT &L).BASIS29
         DC    A(A&SYSNDX.W+2+3*4096)  BASIS FOR BASEREGISTER 4
.BASIS29 ANOP
         AIF   (NOT &O).BASI291
&APL     DC    F'0'       ADRESS OF SYSTEM PARAMETER LIST
         DC    F'0'       WORK FOR BACK CHAINING
.BASI291 ANOP
E&SYSNDX.W EQU *
         AIF   (NOT &N).BASIS30
         MNOTE O,'MORE THAN 4 BASEREGISTERS GIVEN - 4 ASSUMED -'
.BASIS30 AIF   (N'&SYSLIST LE 3).FINI
         MNOTE O,'MORE THAN 3 PARAMETERS -REST IGNORED-'
.FINI    SPACE 2
         MEND
./ ADD  NAME=BCH1PARM
** TITLE   DEFINITION PARAMETER FUER LUBCH1
** OWNER   128.FRANZ
** LCHNG   10/13/82 08:59:05   Z227368 PELIKAN
         MACRO
&NM      BCH1PARM &TYPE=DEF,&PREF=BCH
         LCLC  &N
&N       SETC  '&NM'
         AIF   ('&TYPE' NE 'DSECT').DEF
&N       DSECT
&N       SETC  ' '
.DEF     ANOP
         SPACE 3
*        DEFINITION DER PARAMETER FUER LUBCH1
*
&N        DS    0D
&PREF.ANZ DS    H          ANZAHL ELEMENTE IN TABELLE
&PREF.LEN DS    H          LAENGE EINES TABELLEN ELEMENTS
&PREF.ANF DS    H          POSITION SUCHBEGRIFF1 ANFANG
&PREF.END DS    H          POSITION SUCHBEGRIFF1 ENDE
&PREF.BIS DS    H          POSITION SUCHGEGRIFF2 ANFANG
&PREF.SUZ DS    H          ANZAHL SUCHSCHRITTE
&PREF.FST DS    H          ELEMENT NUMMER 1. VERGLEICH
&PREF.FLN DS    H          VERGLEICHS LAENGE (-1) FUER EX
&PREF.STB DS    F          A(ZWEITES VERGLEICHS ELEMENT)
&PREF.STA DS    F          A(ERSTES VERGLEICHS ELEMENT)
&PREF.BER DS    F          ERSTER BERICHTIGUNGSWERT BEI LOW
&PREF.BEH DS    H          ERSTER BERICHTIGUNGSWERT FUER # BEI HIGH
&PREF.BWH DS    H          ERSTE ADDRESS BERICHTIGUNG BEI HIGH
         MEND
./ ADD  NAME=BCH2PARM
** TITLE   DEFINITION PARAMETER FUER LUBCH2
** OWNER   128.FRANZ
** LCHNG   10/13/82 09:00:33   Z227368 PELIKAN
         MACRO
&NM      BCH2PARM &TYPE=DEF,&PREF=BCH
         LCLC  &N
&N       SETC  '&NM'
         AIF   ('&TYPE' NE 'DSECT').DEF
&N       DSECT
&N       SETC  ' '
.DEF     ANOP
         SPACE 3
*        DEFINITION DER PARAMETER FUER LUBCH2
*
&N        DS    0D
&PREF.ANZ DS    F          ANZAHL ELEMENTE IN TABELLE
&PREF.LEN DS    F          LAENGE EINES TABELLEN ELEMENTS
&PREF.ANF DS    F          POSITION SUCHBEGRIFF1 ANFANG
&PREF.END DS    F          POSITION SUCHBEGRIFF1 ENDE
&PREF.BIS DS    F          POSITION SUCHBEGRIFF2 ANFANG
&PREF.SUZ DS    F          ANZAHL SUCHSCHRITTE
&PREF.FST DS    F          ELEMENT NUMMER 1. VERGLEICH
&PREF.FLN DS    F          VERGLEICHS LAENGE (-1) FUER EX
&PREF.STB DS    F          A(ZWEITES VERGLEICHS ELEMENT)
&PREF.STA DS    F          A(ERSTES VERGLEICHS ELEMENT)
&PREF.BER DS    F          ERSTER BERICHTIGUNGSWERT BEI LOW
&PREF.BEH DS    F          ERSTER BERICHTIGUNGSWERT FUER # BEI HIGH
&PREF.BWH DS    F          ERSTE ADDRESS BERICHTIGUNG BEI HIGH
         MEND
./ ADD  NAME=BHER
** TITLE   GHH
** OWNER   FRANZ
** LCHNG   01/20/82 14:12:53   Z227128 FRANZ
  MIST  QUADRAT
./ ADD  NAME=BLR
         MACRO
&NAME    BLR   &REG
&NAME    BCR   4,&REG
         MEXIT
         MEND
./ ADD  NAME=BMR
         MACRO
&NAME    BMR   &REG
&NAME    BCR   4,&REG
         MEXIT
         MEND
./ ADD  NAME=BNER
         MACRO
&NAME    BNER  &REG
&NAME    BCR   7,&REG
         MEXIT
         MEND
./ ADD  NAME=BNHR
         MACRO
&NAME    BNHR  &REG
&NAME    BCR   13,&REG
         MEXIT
         MEND
./ ADD  NAME=BNLR
         MACRO
&NAME    BNLR  &REG
&NAME    BCR   11,&REG
         MEXIT
         MEND
./ ADD  NAME=BNMR
         MACRO
&NAME    BNMR  &REG
&NAME    BCR   11,&REG
         MEXIT
         MEND
./ ADD  NAME=BNOR
         MACRO
&NAME    BNOR  &REG
&NAME    BCR   14,&REG
         MEXIT
         MEND
./ ADD  NAME=BNPR
         MACRO
&NAME    BNPR  &REG
&NAME    BCR   13,&REG
         MEXIT
         MEND
./ ADD  NAME=BNZR
         MACRO
&NAME    BNZR  &REG
&NAME    BCR   7,&REG
         MEXIT
         MEND
./ ADD  NAME=BOR
         MACRO
&NAME    BOR   &REG
&NAME    BCR   1,&REG
         MEXIT
         MEND
./ ADD  NAME=BPR
         MACRO
&NAME    BPR   &REG
&NAME    BCR   2,&REG
         MEXIT
         MEND
./ ADD  NAME=BZR
         MACRO
&NAME    BZR   &REG
&NAME    BCR   8,&REG
         MEXIT
         MEND
./ ADD  NAME=CATREC
         MACRO
         CATREC &P1
         AIF   ('&P1' EQ 'RECORD').RECORD
CATREC   DSECT                     START OF CATREC AREA
*
* COMMON SECTION (RECORD TYPE 5)
*
.RECORD  ANOP
CCHAIN   DS    F                   ADDRESS OF NEXT BUFFER
CVOLSER  DS    CL6                 VOLUME SERIAL OF TAPE
CSA      DS    CL1                 RECORD TYPE (5)
CRECCNT  DS    XL2                 RECORD COUNT
CRGN     DS    CL2                 RELATIVE GENERATION NUMBER
CGDGDSNL DS    XL1                 LENGTH OF GDG INDEX
         DS    CL3                 RESERVED
CIDENT   DS    CL1                 IDENTIFIER (D=DATASET G=GDG)
CCGC     DS    XL2                 CURRENT GDG COUNT
CMGA     DS    XL1                 MAX. GENERATION NUMBER
CFLAGS   DS    XL1                 FLAGS
CDEVCD   DS    XL4                 DEVICE CODE
CDSN     DS    CL44                DATA SET NAME
CSTAT    DS    CL1                 STATUS
CVSERCAT DS    CL6                 VOLSER OF CATALOG
CTYPE    DS    CL1                 CATALOG TYPE (V=VSAM C=CVOL)
CSUFF    DS    CL1                 DDNAME SUFFIX (ARCHCATX)
CFSEQ    DS    XL1                 FILE SEQUENCE NUMBER
CVOLCNT  DS    XL2                 VOLUME COUNT
         DS    CL20                RESERVED
         AIF   ('&P1' EQ 'RECORD').EXIT
CRGDG    DS    H                   RELATIVE GENERATION NUMBER
CSAVE    DS    18F                 NORMAL SAVE AREA
CWORKREG DS    10F                 WORK REGISTER SAVE AREA
CVAR     DS    0F                  START OF VARAIBLE PART
*
* CVOL SECTION
*
SPCDSN   DS    CL88                DSNAME AREA + 44 BLANKS
SPCTTR   DS    CL3                 TTR FIELD FOR READING CATALOG
SPCTTR0  DS    C                   FOURTH TTR BYTE FOR POINT (ZERO)
SPCDSNL  DS    X                   LENGTH OF DSNAME
SPCNODL  DS    X                   LENGTH OF DSNAME UP TO LAST NODE
SPCFRBUF DS    A                   ADDR. OF NEXT FREE BUFFER
CDCB     DCB   DDNAME=DUMMY,DSORG=PS,MACRF=RP
CLDCB    EQU   *-CDCB              LENGTH OF DCB
CCVOLBUF DS    23CL288             23 TIMES CIRWORK AREA
CATCEND  DS    0D                  END OF CVOL PART
CATCLEN  EQU   *-CATREC            LENGTH OF CVOL PART
CATREND  DS    0D                  END OF CATREC AREA
CATRLEN  EQU   *-CATREC            LENGTH OF CATREC AREA
.EXIT    MEND
./ ADD  NAME=CLEAR
         MACRO
&NAME    CLEAR &T,&L,&CHAR
         LCLC  &LEN
         LCLC  &BLANK
&LEN     SETC  'L'''
         AIF   ('&T'(1,1) EQ '(').C1
&NAME    LA    0,&T .       LOAD ADDRESS OF RECEIVING FIELD
         AGO   .C2
.C1      ANOP
&NAME    LR    0,&T(1) .     LOAD ADDRESS OF RECEIVING FIELD
.C2      ANOP
         AIF   (T'&L NE 'O').C71
         LA    1,&LEN&T .        GET LENGTH
         AGO   .C4
.C71     ANOP
         AIF   ('&L'(1,1) EQ '(').C3
         AIF   (T'&L NE 'N').C7
.C9      LA    1,&L .       GET LENGTH
         AGO   .C4
.C7      AIF   (T'&L EQ 'F').C8
         AIF   (T'&L NE 'H').C9
        LH    1,&L .       GET LENGTH
         AGO   .C4
.C8      L     1,&L .      GET LENGTH
         AGO   .C4
.C3      LR    1,&L(1) .     GET LENGTH
.C4      ANOP
&BLANK   SETC  'X''40'''
         AIF   (T'&CHAR NE 'O').C81
         LA    15,&BLANK .     GET PADDING CHARACTER
         AGO   .C42
.C81     ANOP
         AIF   (T'&CHAR NE 'N').C82
         LA    15,&CHAR  .        GET PADDING CHARACTER
         AGO   .C42
.C82     ANOP
         AIF   ('&CHAR'(1,1) NE '(').C83
         IC    15,0(&CHAR)  .        GET PADDING CHARACTER
         AGO   .C42
.C83     ANOP
         IC    15,&CHAR .       GET PADDING CHARACTER
.C42     ANOP
         SLL   15,24 .       CLEAR LENGTH
         SR    14,14 .      INDICATES NO SENDING FIELD
         MVCL  0,14 .         MOVE LONG
         MEND
./ ADD  NAME=CMPR
         MACRO
&NAME    CMPR  &T,&L,&F
         GBLB  &FIRSTC
         GBLC  &GOTOCL1
         GBLC  &CSECTC
         LCLC  &GOTOCL2
         LCLC  &GOTOCL3
         AIF   (&FIRSTC).W0
&CSECTC  SETC  '&SYSECT'
.W0      AIF   ('&T'(1,1) EQ '(').W1
&NAME    LA    1,&T      LOAD ADDRESS OF FIELD TO BE COMPARED
         AGO   .W2
.W1      ANOP
&NAME    LR    1,&T(1)   LOAD ADDRESS OF FIELD TO BE COMPARED
.W2      AIF   ('&L'(1,1) EQ '(').W6
         AIF   (T'&L NE 'N').W4
.W3      LA    15,&L     GET LENGTH
         AGO   .W7
.W4      AIF   (T'&L EQ 'F').W5
         AIF   (T'&L NE 'H').W3
         LH    15,&L     GET LENGTH
         AGO   .W7
.W5      L     15,&L     GET LENGTH
         AGO   .W7
.W6      LR    15,&L(1)  GET LENGTH
.W7      AIF   ('&F'(1,1) EQ '(').W8
         LA    2,&F      LOAD ADDRESS OF SECOND FIELD TO BE COMPARED
         AGO   .W9
.W8      LR    2,&F(1)   LOAD ADDRESS OF SECOND FIELD TO BE COMPARED
.W9      AIF   ('&CSECTC' EQ '&SYSECT').W10
&FIRSTC  SETB  0
&CSECTC  SETC  'SYSECT'
.W10     AIF   (&FIRSTC).W11
&FIRSTC  SETB  1
&GOTOCL1 SETC  'CL1&SYSNDX'
&GOTOCL2 SETC  'CL2&SYSNDX'
&GOTOCL3 SETC  'CL3&SYSNDX'
         LA    14,&GOTOCL3+2 GET ADDRESS OF NEXT INSTRUCTION
         LA    0,256
&GOTOCL1 CR    15,0
         BL    &GOTOCL2  BRANCH TO CLC
         CLC   0(256,1),0(2) COMPARE OF 256 BYTES
         BNE   &GOTOCL3
         SR    15,0      REDUCE ACTUAL LENGTH
         AR    1,0       RESET FIELD POINTER
         AR    2,0       RESET FIELD POINTER
         B     &GOTOCL1  GO TO COMPARE OF LENGTH
         CLC   0(0,1),0(2) EXEC - CLC
&GOTOCL2 LTR   15,15
         BZ    &GOTOCL3  IF ZERO GO TO MEND
         BCTR  15,0
         EX    15,&GOTOCL2-6 COMPARE REMAINING BYTES
&GOTOCL3 BR    14        RETURN
         MEXIT
.W11     BAL   14,&GOTOCL1-4 BRANCH TO COMPARE - LOOP
         MEND
./ ADD  NAME=CONVDAT
  TITLE 'CONVDAT - CONVERTS DATE FROM YYDDDF TO EG. MONTAG 6. MAI 1974'
CONVDAT  CSECT
         XSAVE 12,SA,CONVDAT
         LM    3,4,0(1)                PARMADDRESSES
         OI    3(3),X'0F'              SET RIGHTEST HALFBYTE HEX F
         MVC   DATE,0(3)               DATE
         CLC   DATE,=XL4'0F'
         BNE   N#A#D                   NO ACTUAL DATE
         TIME  DEC
         ST    1,DATE                  ACTUAL DATE
         OI    DATE+3,X'0F'            SET RIGHTEST HALFBYTE HEX F
         MVC   0(4,3),DATE             MOVE DATE (YYDDDF) TO PARAMETER
N#A#D    EQU   *
         UNPK  UDATE,DATE+1(3)         UNPACK THE DATE
         ZAP   CVDW,DATE+2(2)          ONLY DAY
         CVB   9,CVDW
         LA    7,7
         XR    8,8
         DR    8,7
         LA    9,9
         MR    8,8
         LH    7,BASEDAY
         LA    8,YEARS
DAY#1    EQU   *
         CLC   DATE(2),0(8)            COMPARE YEAR
         BE    DAY#2
         LA    8,4(8)                  GET ADDRESS NEXT YEAR
         BCT   7,DAY#1                 ALL YEARS?
         B     DAY#7
DAY#2    EQU   *
         MVI   0(4),C' '
         MVC   1(27,4),0(4)            CLEAR OUTPUT-PARAMETERFIELD
         LH    8,2(8)
         LA    7,DAYS
         AR    7,8
         AR    7,9
         MVC   0(9,4),0(7)             WEEKDAY
DAY#3    EQU   *
         PACK  CVDW,UDATE+2(2)         PACK YEAR
         CVB   9,CVDW
         N     9,=F'3'                 FEBRUARY 29 DAYS?
         BNZ   DAY#4                   NO, DAY#4
         ZAP   MONTHS+11(2),=P'29'     SET FEBRUARY 29 DAYS
DAY#4    EQU   *
         LA    9,MONTHS
         LA    7,12                    NUMBER OF MONTHS A YEAR
DAY#5    EQU   *
         CP    DATE+2(2),0(2,9)        COMPARE DAY
         BH    DAY#6
         OI    DATE+3,X'0F'            SET RIGHTEST HALFBYTE HEX F
         MVC   9(4,4),MASK
         ED    9(4,4),DATE+2           EDIT DAY
         MVI   13(4),C'.'
         MVC   15(9,4),2(9)            MONTH
         MVC   24(2,4),=C'19'
         MVC   26(2,4),UDATE+2         YEAR
         B     DAY#7
DAY#6    SP    DATE+2(2),0(2,9)        SUBTRAC DAYS THAT MONTH
         LA    9,11(9)                 NEXT MONTH
         BCT   7,DAY#5                 ALL MONTHS?
DAY#7    EQU   *
         ZAP   MONTHS+11(2),=P'28'     SET FEBRUARY 28 DAYS
         CLC   0(9,4),=C'DONNERSTA'
         BNE   *+8
         MVI   9(4),C'G'
         XRETURN 0
*
*   DEFINITIONEN
*
MASK     DC    X'40202020'
BASEDAY  DC    H'10'
YEARS    EQU   *
         DC    X'0070',H'18'
         DC    X'0071',H'27'
         DC    X'0072',H'36'
         DC    X'0073',H'54'
         DC    X'0074',H'0'
         DC    X'0075',H'9'
         DC    X'0076',H'18'
         DC    X'0077',H'36'
         DC    X'0078',H'45'
         DC    X'0079',H'54'
MONTHS   EQU   *
         DC    PL2'31',CL9' JANUAR  '
         DC    PL2'28',CL9' FEBRUAR '
         DC    PL2'31',CL9'  MAERZ  '
         DC    PL2'30',CL9'  APRIL  '
         DC    PL2'31',CL9'   MAI   '
         DC    PL2'30',CL9'  JUNI   '
         DC    PL2'31',CL9'  JULI   '
         DC    PL2'31',CL9' AUGUST  '
         DC    PL2'30',CL9'SEPTEMBER'
         DC    PL2'31',CL9' OKTOBER '
         DC    PL2'30',CL9'NOVEMBER '
         DC    PL2'31',CL9'DEZEMBER '
DAYS     EQU   *
         DC    C' MONTAG  ',C'DIENSTAG ',C'MITTWOCH '
         DC    C'DONNERSTA',C' FREITAG ',C' SAMSTAG ',C' SONNTAG '
         DC    C' MONTAG  ',C'DIENSTAG ',C'MITTWOCH '
         DC    C'DONNERSTA',C' FREITAG ',C' SAMSTAG ',C' SONNTAG '
         LTORG
DATE     DS    F
UDATE    DS    CL7
CVDW     DS    D
./ ADD  NAME=CONVXE
         MACRO
&CON     CONVXE &LAE,&BER,&ADR
         LCLC  &NAME,&REG
         LCLA  &DIFF
&NAME    SETC  '&CON'
         AIF (T'&LAE EQ 'O' AND T'&BER EQ 'O').PFEHL
         AIF (T'&LAE EQ 'O').LFEHL
         AIF (T'&BER EQ 'O').BFEHL
         AGO   .LAEPAR
.PFEHL   MNOTE 8,'LAENGEN- UND BEREICHSPARAMETER FEHLEN'
         MEXIT
.LFEHL   MNOTE 4,'LAENGENPARAMETER FEHLT - LAE=1 ANGENOMMEN'
&NAME    LA    0,1  LOAD LENGTH
         AGO   .BERPAR
.BFEHL   MNOTE 8,'BEREICHSPARAMETER FEHLT ODER FALSCH'
         MEXIT
.LAEFE   MNOTE 8,'LAENGENPARAMETER FALSCH'
         MEXIT
.AFEHL   MNOTE 8,'ADRESSPARAMETER FALSCH'
         MEXIT
.LAEPAR  ANOP
         AIF ('&LAE'(1,1) EQ '(').REGL
         AIF (T'&LAE EQ 'N').DIR
&NAME    LH    0,&LAE  LOAD LENGTH
         AGO   .BERPAR
.REGL    ANOP
&DIFF    SETA  K'&LAE-2
         AIF ('&LAE'(K'&LAE,1) NE ')').LAEFE
&REG     SETC  '&LAE'(2,&DIFF)
.LRICHT   AIF ('&LAE'(2,1) EQ '0').LR0
&NAME    LR    0,&REG  LOAD LENGTH
         AGO   .BERPAR
.DIR     ANOP
&NAME    LA    0,&LAE  LOAD LENGTH
.BERPAR  ANOP
&NAME    SETC  ''
.LR0     ANOP
         AIF ('&BER'(1,1) EQ '(').REGB
         AIF (T'&BER EQ 'N').BFEHL
&NAME    LA    1,&BER  LOAD ADDRESS OF AREA TO BE CONVERTED
         AGO   .ADRPAR
.REGB    ANOP
&DIFF    SETA  K'&BER-2
         AIF ('&BER'(K'&BER,1) NE ')').BFEHL
&REG     SETC  '&BER'(2,&DIFF)
.BRICHT   AIF ('&BER'(2,1) EQ '1').BR1
&NAME    LR    1,&REG  LOAD ADDRESS OF AREA TO BE CONVERTED
         AGO   .ADRPAR
.BR1     ANOP
         AIF ('&NAME' NE '').BER1
.ADRPAR  ANOP
&NAME    SETC  ''
.BER1    ANOP
         AIF (T'&ADR EQ 'O').OHN
         AIF ('&ADR'(1,1) EQ '(').REGA
         AIF (T'&ADR EQ 'N').AFEHL
&NAME    L     15,&ADR  LOAD PARAMETER OF ADDRESS
         AGO   .ENDE
.REGA    ANOP
&DIFF    SETA  K'&ADR-2
         AIF ('&ADR'(K'&ADR,1) NE ')').AFEHL
&REG     SETC  '&ADR'(2,&DIFF)
.ARICHT  ANOP
&NAME    LR    15,&REG  LOAD PARAMETER OF ADDRESS
         AGO   .ENDE
.OHN     ANOP
&NAME    L     15,=V(CONVXE)  LOAD PARAMETER OF ADDRESS
.ENDE    BALR  14,15  STORE RETURN ADDRESS
         MEND
./ ADD  NAME=CPYCV
         MACRO
         CPYCV
         SPACE 3
*
*
COMVEC   DSECT           LUCOPY COMMUNICATIONS VECTOR
*
JFCBI    DS        F         POINTER TO INPUT JFCB
JFCBO    DS        F         POINTER TO OUTPUT JFCB
DSCBI    DS        F         DSCB INPUT
DSCBO    DS        F         DSCB OUTPUT
DVCINFI  DS        F         DEVTYPE INFORMATION INPUT DVC
DVCINFO  DS        F         DEVTYPE INFORMATION OUTPUT DVC
DCBINP   DS        F         DCB INP
DCBOUT   DS        F         DCB OUT
DDNAMEA  DS        F         DDNAME ADDR
TRKNOINP DS        F         TRK # DS HAS ON INP VOL
CURVOLO  DS        F         CURRENT VOLUME POINTER
CURCOPY  DS        F         CURRENT COPY POINTER
CURSEL   DS        F         CURRENT SELECT STRING POINTER
ACPYLOG  DS        F         CPYLOG ENTRY ADDR
ACONVXE  DS        F         CONVXE ENTRY ADDR
AMSGGEN  DS        F         MSGGEN ENTRY ADDR
ALUSORT  DS        F         LUSORT ENTRY ADDR
DIRCHAIN DS        F         POINTS TO 1ST DIR BLK OF PDS IN STOR
LSTAR    DS        F         SAVE AREA FOR LAST BLOCK POINTER
VOLPOINT DS        F         VOLUME POINTER
CURVOLI  DS        F         CURRENT VOLSER PNT TO INP FJCB
ABCOUNT  DS        H         COUNT AREA FOR ABENDS PER COPY
PATCH    DS        3H        PATCH AREA
DIRALC   DS        H         DIRECTORY SPC ALLOCATED (OLD DS)
DIRUSED  DS        H         DIRECTORY SPC USED      (OLD DS)
DIRBLKS  DS        H         DIRECTORY SPC ALLOCATED (NEW DS)
RCODE    DS        H         RETURN CODE
ACMCD    DS        X         ACCESS METHOD CODE (SYNADAF)
SW       DS        X         SWITCH BYTE REFERED TO IN SEVERAL MODULES
RENCHAR  DS        C         RENAME CHARACTER (COMPR IN PLACE/EXPAND)
SW2      DS        X         SECOND SWITCH BYTE
EXITAD   DS        F         EXIT ROUTINE ENTRY ADDR
CPYEXIT  DS        3H        INSTRUCTIONS TO BRANCH TO EXIT
ACPYDCK  DS        F         DCB CHECK RTN ENTRY ADDR
RESTBUF  DS        F         RESTORE BUFFER PNT
DDNAMEO  DS        F         OUTPUT DDNAME ADDR
*
COMVECE  EQU       *     COMMUNICATIONS VECTOR END
         EJECT
         SPACE 3
CSTR     DSECT           COPY STRING DESCRIPTION
*
CNXTCPY  DS        F         PNT TO NXT C STR OR 0 IF LAST
CNXTSEL  DS        F         PNT TO 1ST S STR OR 0 IF NONE
CDSGROUP DS        F         POINTER TO DSN GROUP
CABENDS  DS        H         MAX NO OF SYS ABENDS ALLOWED
CTYPE    DS        X         TYPE
CRETCD   DS        X         MAX RETURN CODE
CFILL    DS        X         FILL CHARACTER
COPT     DS        X         OPTION IN COPY STMT
COPT2    DS        X         OPTION IN COPY STMT
CINDDS   DS        CL64      8 DDNAMES ALLOWED
CBLANK1  DS        X         MUST STAY BLANK
COUTDDS  DS        CL64      8 DDNAMES ALLOWED
CBLANK2  DS        X         MUST STAY BLANK
*
CSTRE    EQU       *
         SPACE 2
SSTR     DSECT           SELECT STRING DESCRIPTION
*
SNXTSEL  DS        F         PNT TO NXT S STR OR 0 IF LAST
SMEMBER  DS        F         POINTER TO MEMBER NAMES
SRSV     DS        XL2       RESERVE COUNT IN %
SEXPD    DS        XL2       EXPAND VALUE
*        BIT       0=1:      ADD TO DIRECTORY SPACE ALLOCATED
*        BIT       0=0:      ADD TO DIRECTORY SPACE USED
*        BIT       1=1:      UNIT IS IN PERCENT
*        BIT       1=0:      UNIT IS IN BLOCKS
*        BIT       2=1:      UNIT IS IN MEMBER ENTRIES
*        BIT       3 BYTE 0 -BIT  7 BYTE 1: EXPAND COUNT
SEXPS    DS        H         EXPAND SPACE VALUE
         ORG       SEXPS
SREDS    DS        H         REDUCE SPACE VALUE (WITH HI BIT TO 1)
SOPT     DS        X         OPTION IN SELECT STATEMENT
SOPT2    DS        X         OPTION IN SELECT STATEMENT
SFILL    DS        X         FILL CHARACTER
SSW      DS        X         SELECT SWITCH BYTE
SDSN     DS        CL44      DSNAME
         DS        0F        ORG WORD BOUNDARY
SSTRL    EQU       *-SSTR
*
SSTRE    EQU       *
         SPACE 2
DSNGR    DSECT               DSNAME GROUP DESCR
DSNGLL   DS        H         NO OF CHARS SPECIFIED
DSNGID   DS        C         + START     - END
DSNGDSN  DS        CL44      PART OF DSN TO COMPARE
DSNGE    EQU       *         STRING END
         EJECT
         SPACE 3
RECHEAD  DSECT     DUMP RECORD HEADER
*
RECLEN   DS        AL2       VB LENGTH FIELD
RECRSV1  DS        XL2       VBS RESERVED 0
RECID    DS        X         LUCOPY RECORD IDENTIFIER
RECRSV2  DS        X         LUCOPY RESERVED 0
RECTTR   DS        XL3       ORIGINAL TTR OF THIS BLOCK
RECTTRC  DS        X         0 IF DATA BLOCK, N OF TTRN IF NOTE LIST
RECDATAS DS        X         START OF DATA IF DATA RECORD
         ORG       RECTTR
RECMNAME DS        CL8       MEMBER NAME IF DIRECTORY ENTRY
RECMTTR  DS        CL3       MEMBER TTR IN DIR ENTRY
RECMTTRC DS        X         C BYTE OF MEMBER TTRC
         ORG       RECTTR
RECDBU   DS        H         DIRECTORY BLKS USED IF PO
RECDBA   DS        H         DIRECTORY BLKS ALLOCATED IF PO
         SPACE 3
*   EQUATES FOR TAPE RECORD TYPES
*
RECDSCB  EQU       X'01'     RECORD CONTAINS DSCB AND DEVTYPE INFO
RECDIRE  EQU       X'02'     RECORD CONTAINS ONE DIRECORY ENTRY
RECEOFD  EQU       X'04'     RECORD REPRESENTS DATA SET EOF
RECEOFM  EQU       X'08'     RECORD REPRESENTS PDS MEMBER EOF
RECDATA  EQU       X'10'     RECORD CONTAINS USER DATA
RECDIRA  EQU       X'20'     RECORD CONTAINS DIR ENTRY FOR AN ALIAS
RECNLST  EQU       X'40'     RECORD CONTAINS NOTE LIST
RECDBLK  EQU       X'80'     RECORD CONTAINS NO OF DIRECTORY BLOCKS
         EJECT
         SPACE 2
*   BIT EQUATES USED TO MANIPULATE COPT, SOPT, CTYPE, SSW
         SPACE
*   TYPE BITS      (CTYPE)
EXCL     EQU       001       INDICATE TYPE=EXCLUDE
*FILL    EQU       002       FILL CHARACTER EXISTANT
SEP      EQU       004       INDICATE TYPE=SEPERATION
DSCBIN   EQU       016       INDICATE NODSCB=IN (TAPE)
DSCBOUT  EQU       032       INDICATE NODSCB=OUT (TAPE)
INCL     EQU       064       INDICATE TYPE=INCLUDE
*        EQU       128       THIS BIT SHOULD NOT BE USED
         SPACE
*   OPTION BITS    (COPT, SOPT)
TRK      EQU       001       INDICATE OPTION=TRACK
FILL     EQU       002       FILL CHARACTER EXISTANT
PUR      EQU       004       INDICATE PREALLOC=PURGE
SKIP     EQU       016       INDICATE PREALLOC=SKIP
DEL      EQU       032       INDICATE PREALLOC=DELETE
REUS     EQU       SKIP+DEL  INDICATE PREALLOC=REUSE
ADD      EQU       SKIP+PUR  INDICATE PREALLOC=ADD
INACT    EQU       064       INDICATE THIS DSNAME ENTRY INACTIVE
*        EQU       128       THIS BIT SHOULD NOT BE USED
         SPACE
*   OPTION BITS    (COPT2, SOPT2)
NOLIST   EQU       001       MEMBER LIST NOT WANTED IF ON
PRT      EQU       002       OUTPUT TO PRINTER
CAT      EQU       004       CATALOG WANTED
RECAT    EQU       008       RECATALOG WANTED
REBLM    EQU       016       REBLOCK MAXIMUM
REBLO    EQU       032       REBLOCK OPTIMUM
SORTED   EQU       064       MEMBER LIST TO BE SORTED
         SPACE
*   SWITCH BITS    (SSW)
EXP      EQU       001       INDICATE EXPAND=CCNNN SPECIFIED
         SPACE 2
*   EQUATES FOR SWITCH BYTE IN COMVEC (SW)
*
NODS     EQU       128       SET IF NO DS TO BE SELECTED
FIRST1   EQU       064       DEVCL COMPARE (ONCE PER COPY)
FIRST2   EQU       032       INDICATES 1ST DDNAME OF COPY
ALL      EQU       016       PARM=ALL
VOLEQ    EQU       008       VOL SERS INP + OUTP EQ
INPL     EQU       004       UPDATE IN PLACE (PO)
POSHR    EQU       002       OUTPUT PO DS DOES ALREADY EXIST
SCC      EQU       001       SYS ABEND OCCURED IF ON
         SPACE 2
*   EQUATES FOR SECOND SWITCH BYTE IN COMVEC (SW2)
*
CAPEXC   EQU       128       TRK CAP ON OUTP DVC EXCEEDED
DUMP     EQU       064       DATA IS TO BE DUMPED ONTO TAPE
RESTORE  EQU       032       DATA IS TO BE RESTORED FROM TAPE
NOTVS    EQU       016       OPERATING SYSTEM IS NOT  V S
TPSKIP   EQU       008       DATASET ON TAPE TO BE SKIPPED IF ON
CATOK    EQU       004       CATALOGING WAS SUCCESSFUL FOR THIS DS
         EJECT
         MEND
./ ADD  NAME=CTGPL
         MACRO
         CTGPL
*
*   THIS MACRO DESCRIBES THE LAYOUT OF THE OS/VS2
*   CATALOG MANAGEMENT PARAMETER LIST.
*
CTGPL    DS    0CL32          -DECLARE CTGPL LEVEL ONE
CTGOPTN1 DS    X              -FIRST OPTION INDICATOR
CTGBYPSS EQU   X'80'          -BYPASS
CTGMAST  EQU   X'40'          -VERIFY MASTER PASSWORD
CTGCI    EQU   X'20'          -VERIFY CONTROL INTERVAL
CTGUPD   EQU   X'10'          -VERIFY UPDATE
CTGREAD  EQU   X'08'          -VERIFY READ
CTGNAME  EQU   X'04'          - ON:  44-BYTE NAME OR VOL SER
*                             - OFF: ENTRY ID NUMBER
CTGCNAME EQU   X'02'          - ON:  44-BYTE NAME
*                             - OFF: ACB ADDRESS
CTGGENLD EQU   X'01'          -GENERIC LOCATE REQUEST
CTGOPTN2 DS    X              -SECOND OPTION INDICATOR
CTGEXT   EQU   X'80'          -EXTEND (UPDATE)
CTGNSVS  EQU   X'80'          -CATALOG CLEANUP REQUEST
CTGERASE EQU   X'40'          -ERASE (DELETE)
CTGSMF   EQU   X'40'          -WRITE SMF (LSPACE)
CTGREL   EQU   X'40'          -RELEASE (UPDATE)
CTGGTALL EQU   X'40'          -CONCAT SRCH (LISTCAT)
CTGPURG  EQU   X'20'          -PURGE (DELETE)
CTGVMNT  EQU   X'20'          -VOLUME MOUNT CALLER
CTGRCATN EQU   X'20'          -RTN CAT NAME (GLOC)
CTGGTNXT EQU   X'10'          -GET NEXT (LIST CTLG)
CTGDISC  EQU   X'08'          -DISCONNECT (DELETE)
CTGOVRID EQU   X'04'          -ERASE OVERRIDE (DELETE)
CTGSCR   EQU   X'02'          -SCRATCH SPACE (DELETE)
CTGBOTH  EQU   X'01'          -ACCEPT ICF CAT ARCHITECTURE
CTGOPTN3 DS    X              -THIRD OPTION INDICATOR
CTGCMS   EQU   X'80'          -CATALOG MGMT. SERV. FUNCTION IS USED
*                             -(SEE CTGOPTNS)
CTGLSP   EQU   X'40'          -LSPACE
CTGLOC   EQU   X'20'          -LOCATE
CTGUPDAT EQU   X'60'          -UPDATE
CTGSUPLT EQU   X'10'          -SUPER LOCATE
CTGGDGL  EQU   X'08'          -GDG LOCATE REQUEST W/BASE LEVEL
*                             -GIVEN (CTGWAGB IN CTGWA)
CTGSRH   EQU   X'04'          - ON:  SEARCH OS CAT FIRST
*                             - OFF: SEARCH MASTER CAT ONLY
CTGNUM   EQU   X'02'          - ON:  SEARCH BOTH CATALOGS
*                             - OFF: SEARCH ONE CATALOG
CTGAM0   EQU   X'01'          -VSAM REQ VERSUS NONVSAM
CTGOPTN4 DS    X              -FOURTH OPTION INDICATOR
CTGLBASE EQU   X'80'          -LOCATE GDG BASE ONLY
CTGDOCAT EQU   X'40'          -DO NOT OPEN NEEDED CATLG
CTGBYPMT EQU   X'08'          -BYPASS SECURITY PROMPTING
CTGENT   DS    A              -USER ENTRY ADDR OR PTR TO
*                             -VOL SER NUMBER (LSPACE)
         ORG   CTGENT
CTGFVT   DS    A              -FVT ADDRESS (DEFINE, ALTER)
CTGCAT   DS    A              -CATALOG POINTER
         ORG   CTGCAT
CTGCVOL  DS    A              -CVOL PTR (SUPER LOCATE)
CTGWKA   DS    A              -WORKAREA ADDR
CTGDSORG DS    XL2            -DATA SET ORG - SUPER LOC
         ORG   CTGDSORG
CTGOPTNS DS    X              -CMS OPTIONS
CTGLTCAT EQU   X'20'          -LISTCAT
         DS    X              -RESERVED
CTGTYPE  DS    X              -ENTRY TYPE - LISTCAT, DELETE
CTGNOFLD DS    X              -NUMBER FIELD POINTERS
CTGDDNM  DS    A              -DD NAME ADDR
         ORG   CTGDDNM
CTGNEWNM DS    A              -NEWNAME ADDRESS - ALTER
         ORG   CTGDDNM
CTGFDBK  DS    XL2            -SUPER LOCATE FEEDBACK
CTGFBFLG DS    XL2            -SUPER LOCATE FLAGS
CTGPAR   EQU   X'80'          -PARALLEL MOUNT - SUPER LOC
CTGKEEP  EQU   X'40'          -FORCED KEEP - SUPER LOC
CTGGDGB  EQU   X'20'          -GDG BASE LOCATED
CTGNGDSN EQU   X'10'          -GDG NAME GENERATED
CTGJSCB  DS    A              -JSCB ADDR
         ORG   CTGJSCB
CTGPSWD  DS    A              -PASSWORD ADDR
CTGFIELD DS    A              -FIELD POINTERS
CTGPLEND DS    0X             -END OF CTGPL
         MEXIT
         MEND
./ ADD  NAME=DALLO
         MACRO
&LAB     DALLO &DA=,&FILE=,&DISP=,&SYSOUT=,&ERROR=,                    *
               &UNIT=,&VOLUME=,&FREE=,&MEMBER=,&QNAME=,&SPACE=,        *
               &UCOUNT=,                                               *
               &FORM=,&OUTLIM=,&COPIES=,&LABEL=,&EXPDT=,&RETPD=,       *
               &FCB=,&HOLD=,&BLKSIZE=,&LRECL=,&RECFM=,&UCS=,&DSORG=,   *
               &USING=,&BFALN=,&BUFNO=,&DEN=,&EROPT=,&KEYLEN=,&OPTCD=, *
               &SPACE1=
.**********************************************************************
.*                                                                    *
.*       DALLO - MACRO                                                *
.*                                                                    *
.*       PARAMETER &DEN ERGAENZT.         ISSELHARD 24.10.77          *
.*       PARAMETER &UCOUNT HINZUGEFUEGT.  ISSELHARD 23.11.77          *
.*                                                                    *
.*       LOEBER, W.      22.04.76     GAD - MUENSTER                  *
.*                                                                    *
.**********************************************************************
         LCLA  &LGM,&IND1,&IND2,&MULT,&TP,&TU,&FILEPR,&DSNPR
         LCLA  &POI
         LCLC  &TAB,&C1,&DV,&TAB1(11),&TAB2(11),&C2
&C2      SETC  'MDA'.'&SYSNDX'
.*
.* FIRST CHECK OPERANDS AND COMPUTE LENGTH FOR WORK-AEREA
&LGM     SETA  24
&POI     SETA  24
         AIF   (T'&DA NE 'O' OR T'&FILE NE 'O').A1002
.A1001   ANOP
         MNOTE 04,'MISSING KEYWORD DA, FILE, OR ERROR'
         MEXIT
.*
.A1002   ANOP
         AIF   (T'&ERROR(1) EQ 'O').A1001
.*
         AIF   (T'&DA EQ 'O').A1009
         AIF   (K'&DA LT 47).A1004
.A1003   ANOP
         MNOTE 04,'INCORRECT ''DA'' VALUE'
         MEXIT
.*
.A1004   ANOP
         AIF   (N'&DA GT 2).A1003
         AIF   (N'&DA EQ 1).A1005
         AIF   (K'&DA(1) GT 1).A1003
         AIF   ('&DA(1)' NE 'R').A1003
         AIF   ('&DA(2)'(1,1) EQ '''').A1003
         AGO   .A1008
.*
.A1005   ANOP
         AIF   ('&DA'(1,1) NE '''').A1008
&IND1    SETA  2
&IND2    SETA  1
.A1006   ANOP
         AIF   ('&DA'(&IND1,1) NE '.').A1007
&IND2    SETA  1
&IND1    SETA  &IND1+1
         AGO   .A1006
.*
.A1007   ANOP
         AIF   ('&DA'(&IND1,1) EQ '''').A1008
         AIF   (&IND2 GT 8).A1003
&IND2    SETA  &IND2+1
&IND1    SETA  &IND1+1
         AGO   .A1006
.*
.A1008   ANOP
&LGM     SETA  &LGM+4+50
&POI     SETA  &POI+4
.A1009   ANOP
         AIF   (T'&FILE EQ 'O').A1013
         AIF   (K'&FILE LT 13).A1011
.A1010   ANOP
         MNOTE 04,'INCORRECT ''FILE'' VALUE'
         MEXIT
.*
.A1011   ANOP
         AIF   (N'&FILE GT 2).A1010
         AIF   (N'&FILE EQ 1).A1012
         AIF   ('&FILE(1)' NE 'R').A1010
         AIF   (K'&FILE(2) GT 8).A1010
.*
.A1012   ANOP
&LGM     SETA  &LGM+4+14
&POI     SETA  &POI+4
.*
.A1013   ANOP
         AIF   (N'&DISP LT 4).A1015
.A1014   ANOP
         MNOTE 04,'INCORRECT ''DISP'' VALUE'
         MEXIT
.*
.A1015   ANOP
         AIF   (T'&DISP(1) EQ 'O').A1016
         AIF   ('&DISP(1)'(1,1) NE '''').A1016
         AIF   ('&DISP(1)' NE '''OLD''' AND '&DISP(1)' NE '''MOD''' AND*
                '&DISP(1)' NE '''NEW''' AND '&DISP(1)' NE '''SHR''').A1*
               014
.A1016   ANOP
         AIF   (T'&DISP(2) EQ 'O').A1017
         AIF   ('&DISP(2)'(1,1) NE '''').A1017
         AIF   ('&DISP(2)' NE '''UNCATLG''' AND '&DISP(2)' NE '''CATLG'*
               '' AND '&DISP(2)' NE '''DELETE''' AND '&DISP(2)' NE '''K*
               EEP''').A1014
.A1017   ANOP
         AIF   (T'&DISP(3) EQ 'O').A1018
         AIF   ('&DISP(3)'(1,1) NE '''').A1018
         AIF   ('&DISP(3)' NE '''UNCATLG''' AND '&DISP(3)' NE '''CATLG'*
               '' AND '&DISP(3)' NE '''DELETE''' AND '&DISP(3)' NE '''K*
               EEP''').A1014
.A1018   ANOP
&MULT    SETA  N'&DISP
&POI     SETA  &POI+4*&MULT
&LGM     SETA  &LGM+(4*&MULT)+(7*&MULT)
.*
.A1019   ANOP
         AIF   (T'&SYSOUT EQ 'O').A1022
         AIF   ('&SYSOUT'(1,1) NE '''').A1021
         AIF   (K'&SYSOUT LT 4).A1021
.A1020   ANOP
         MNOTE 04,'INCORRECT ''SYSOUT'' VALUE'
         MEXIT
.A1021   ANOP
&LGM     SETA  &LGM+4+7
&POI     SETA  &POI+4
.*
.A1022   ANOP
         AIF   (T'&UNIT EQ 'O').A1025
         AIF   ('&UNIT'(1,1) NE '''').A1024
         AIF   (K'&UNIT LT 9).A1024
.A1023   ANOP
         MNOTE 04,'INCORRECT ''UNIT'' VALUE'
         MEXIT
.*
.A1024   ANOP
&LGM     SETA  &LGM+4+12
&POI     SETA  &POI+4
.*
.A1025   ANOP
         AIF   (T'&VOLUME EQ 'O').A1028
         AIF   ('&VOLUME'(1,1) NE '''').A1027
         AIF   (K'&VOLUME LT 9).A1027
.A1026   ANOP
         MNOTE 04,'INCORRECT ''VOLUME'' VALUE'
         MEXIT
.A1027   ANOP
&LGM     SETA  &LGM+4+12
&POI     SETA  &POI+4
.*
.A1028   ANOP
         AIF   (T'&FREE EQ 'O').A1031
         AIF   ('&FREE'(2,5) EQ 'CLOSE').A1030
.A1029   ANOP
         MNOTE 04,'INCORRECT ''FREE'' VALUE'
         MEXIT
.A1030   ANOP
&LGM     SETA  &LGM+4+4
&POI     SETA  &POI+4
.*
.A1031   ANOP
         AIF   (T'&MEMBER EQ 'O').A1034
         AIF   ('&MEMBER'(1,1) NE '''').A1033
         AIF   (K'&MEMBER LT 11).A1033
.A1032   ANOP
         MNOTE 04,'INCORRECT ''MEMBER'' VALUE'
         MEXIT
.A1033   ANOP
&LGM     SETA  &LGM+4+14
&POI     SETA  &POI+4
.*
.A1034   ANOP
         AIF   (T'&QNAME EQ 'O').A1037
         AIF   ('&QNAME'(1,1) NE '''').A1036
         AIF   (K'&QNAME LT 11).A1036
.A1035   ANOP
         MNOTE 04,'INCORRECT ''QNAME'' VALUE'
         MEXIT
.A1036   ANOP
&LGM     SETA  &LGM+4+14
&POI     SETA  &POI+4
.*
.A1037   ANOP
         AIF   (T'&SPACE EQ 'O').A1047
         AIF   ('&SPACE'(1,1) EQ '(').A1039
.A1038   ANOP
         MNOTE 04,'INCORRECT ''SPACE'' VALUE'
         MEXIT
.A1039   ANOP
         AIF   (N'&SPACE GT 5 OR N'&SPACE LT 2).A1038
&LGM     SETA  &LGM+4+9
&POI     SETA  &POI+4
         AIF   (T'&SPACE(2) EQ 'O').A1038
         AIF   ('&SPACE(2)' NE '*').A1038
         AIF   (N'&SPACE1 GT 3).A1038
         AIF   (T'&SPACE1(1) EQ 'O').A1038
&LGM     SETA  &LGM+4+9
&POI     SETA  &POI+4
         AIF   (T'&SPACE1(2) EQ 'O').A1040
&LGM     SETA  &LGM+4+9
&POI     SETA  &POI+4
.A1040   ANOP
         AIF   (T'&SPACE1(3) EQ 'O').A1041
&LGM     SETA  &LGM+4+9
&POI     SETA  &POI+4
.A1041   ANOP
         AIF   (T'&SPACE(3) EQ 'O').A1043
         AIF   ('&SPACE(3)' NE '''RLSE''').A1038
.A1042   ANOP
&LGM     SETA  &LGM+4+4
&POI     SETA  &POI+4
.A1043   ANOP
         AIF   (T'&SPACE(4) EQ 'O').A1045
         AIF   ('&SPACE(4)'(1,1) NE '''').A1044
         AIF   ('&SPACE(4)'(2,6) NE 'CONTIG' AND '&SPACE(4)'(2,4) NE 'M*
               XIG' AND '&SPACE(4)'(2,3) NE 'ALX').A1038
.A1044   ANOP
&LGM     SETA  &LGM+4+7
&POI     SETA  &POI+4
.A1045   ANOP
         AIF   (T'&SPACE(5) EQ 'O').A1047
         AIF   ('&SPACE(5)'(2,5) NE 'ROUND').A1038
.A1046   ANOP
&LGM     SETA  &LGM+4+4
&POI     SETA  &POI+4
.A1047   ANOP
         AIF   (T'&FORM EQ 'O').A1050
         AIF   ('&FORM'(1,1) NE '''').A1049
         AIF   (K'&FORM LT 7).A1049
.A1048   ANOP
         MNOTE 04,'INCORRECT ''FORM'' VALUE'
         MEXIT
.A1049   ANOP
&LGM     SETA  &LGM+4+10
&POI     SETA  &POI+4
.*
.A1050   ANOP
         AIF   (T'&OUTLIM EQ 'O').A1051
&LGM     SETA  &LGM+4+9
&POI     SETA  &POI+4
.*
.A1051   ANOP
         AIF   (T'&COPIES EQ 'O').A1052
&LGM     SETA  &LGM+4+7
&POI     SETA  &POI+4
.*
.A1052   ANOP
         AIF   (T'&UCOUNT EQ 'O').A10525
&LGM     SETA  &LGM+4+7
&POI     SETA  &POI+4
.*
.A10525  ANOP
         AIF   (N'&LABEL LT 5).A1054
.A1053   ANOP
         MNOTE 04,'INCORRECT ''LABEL'' VALUE'
         MEXIT
.A1054   ANOP
         AIF   (T'&LABEL(1) EQ 'O').A1055
&LGM     SETA  &LGM+4+8
&POI     SETA  &POI+4
.*
.A1055   ANOP
         AIF   (T'&LABEL(2) EQ 'O').A1057
         AIF   ('&LABEL(2)'(1,1) NE '''').A1056
         AIF   ('&LABEL(2)'(2,2) NE 'SL' AND '&LABEL(2)'(2,3) NE 'SUL' *
               AND '&LABEL(2)'(2,2) NE 'AL' AND '&LABEL(2)'(2,3) NE 'AU*
               L' AND '&LABEL(2)'(2,3) NE 'NSL' AND '&LABEL(2)'(2,2) NE*
                'NL' AND '&LABEL(2)'(2,3) NE 'BLP' AND '&LABEL(2)'(2,3)*
                NE 'LTM').A1053
.A1056   ANOP
&LGM     SETA  &LGM+4+7
&POI     SETA  &POI+4
.*
.A1057   ANOP
         AIF   (T'&LABEL(3) EQ 'O').A1059
         AIF   ('&LABEL(3)'(1,1) NE '''').A1058
         AIF   ('&LABEL(3)'(2,8) NE 'PASSWORD' AND '&LABEL(3)'(2,8) NE *
               'NOPWREAD').A1053
.A1058   ANOP
&LGM     SETA  &LGM+4+7
&POI     SETA  &POI+4
.*
.A1059   ANOP
         AIF   (T'&LABEL(4) EQ 'O').A1061
         AIF   ('&LABEL(4)'(1,1) NE '''').A1060
         AIF   ('&LABEL(4)'(2,2) NE 'IN' AND '&LABEL(4)'(2,3) NE 'OUT')*
               .A1053
.A1060   ANOP
&LGM     SETA  &LGM+4+7
&POI     SETA  &POI+4
.A1061   ANOP
         AIF   (T'&EXPDT EQ 'O').A1064
         AIF   ('&EXPDT'(1,1) NE '''').A1063
         AIF   (K'&EXPDT EQ 7).A1063
.*
.A1062   ANOP
         MNOTE 04,'INCORRECT ''EXPDT'' OR ''RETPD'' VALUE'
         MEXIT
.A1063   ANOP
&LGM     SETA  &LGM+4+11
&POI     SETA  &POI+4
.A1064   ANOP
         AIF   (T'&RETPD EQ 'O').A1066
         AIF   ('&RETPD'(1,1) NE '''').A1065
         AIF   (K'&RETPD GT 6).A1062
.*
.A1065   ANOP
&LGM     SETA  &LGM+4+8
&POI     SETA  &POI+4
.*
.A1066   ANOP
         AIF   (T'&FCB EQ 'O').A1072
         AIF   (N'&FCB LT 3).A1068
.A1067   ANOP
         MNOTE 04,'INCORRECT ''FCB'' VALUE'
         MEXIT
.A1068   ANOP
         AIF   (T'&FCB(1) EQ 'O').A1070
         AIF   ('&FCB(1)'(1,1) NE 'O').A1069
         AIF   (K'&FCB(1) GT 6).A1067
.*
.A1069   ANOP
&LGM     SETA  &LGM+4+10
&POI     SETA  &POI+4
.A1070   ANOP
         AIF   (T'&FCB(2) EQ 'O').A1072
         AIF   ('&FCB(2)'(1,1) NE '''').A1071
         AIF   ('&FCB(2)'(2,5) NE 'ALIGN' AND '&FCB(2)'(2,6) NE 'VERIFY*
               ').A1067
.A1071   ANOP
&LGM     SETA  &LGM+4+7
&POI     SETA  &POI+4
.A1072   ANOP
         AIF   (T'&HOLD EQ 'O').A1075
         AIF   ('&HOLD' EQ '''YES''').A1074
.A1073   ANOP
         MNOTE 04,'INCORRECT ''HOLD'' VAUE'
         MEXIT
.A1074   ANOP
&LGM     SETA  &LGM+4+4
&POI     SETA  &POI+4
.*
.A1075   ANOP
         AIF   (T'&BLKSIZE EQ 'O').A1076
&LGM     SETA  &LGM+4+8
&POI     SETA  &POI+4
.*
.A1076   ANOP
         AIF   (T'&LRECL EQ 'O').A1077
&LGM     SETA  &LGM+4+8
&POI     SETA  &POI+4
.*
.A1077   ANOP
         AIF   (T'&RECFM EQ 'O').A1083
         AIF   ('&RECFM'(1,1) NE '''').A1082
         AGO   .A1079
.A1078   ANOP
         MNOTE 04,'INCORRECT ''RECFM'' VALUE'
         MEXIT
.*
.A1079   ANOP
&TAB     SETC  'RMAGSBTDVFU'
&IND1    SETA  2
&IND2    SETA  1
.*
.A1080   ANOP
         AIF   ('&RECFM'(&IND1,1) EQ '&TAB'(&IND2,1)).A1081
         AIF   (&IND2 EQ 11).A1078
&IND2    SETA  &IND2+1
         AGO   .A1080
.*
.A1081   ANOP
&IND1    SETA  &IND1+1
         AIF   ('&RECFM'(&IND1,1) EQ '''').A1082
         AIF   ('&RECFM'(&IND1,1) EQ '').A1078
&IND2    SETA  1
         AGO   .A1080
.*
.A1082   ANOP
&LGM     SETA  &LGM+4+7
&POI     SETA  &POI+4
.A1083   ANOP
         AIF   (T'&UCS(1) EQ 'O').A1086
         AIF   ('&UCS(1)'(1,1) NE '''').A1085
         AIF   (K'&UCS(1) LT 7).A1085
.A1084   ANOP
         MNOTE 04,'INCORRECT ''UCS'' VALUE'
         MEXIT
.A1085   ANOP
&LGM     SETA  &LGM+4+10
&POI     SETA  &POI+4
.*
.A1086   ANOP
         AIF   (T'&UCS(2) EQ 'O').A1087
         AIF   ('&UCS(2)'(2,4) NE 'FOLD').A1084
&LGM     SETA  &LGM+4+4
&POI     SETA  &POI+4
.*
.A1087   ANOP
         AIF   (T'&UCS(3) EQ 'O').A1088
         AIF   ('&UCS(3)'(2,5) NE 'VERFY').A1084
&LGM     SETA  &LGM+4+4
&POI     SETA  &POI+4
.*
.A1088   ANOP
         AIF   (T'&USING EQ 'O').A1091
         AIF   ('&USING'(1,1) NE '''').A1090
         AIF   (K'&USING LT 11).A1090
.A1089   ANOP
         MNOTE 04,'INCORRECT ''USING'' VALUE'
         MEXIT
.A1090   ANOP
&LGM     SETA  &LGM+4+14
&POI     SETA  &POI+4
.*
.A1091   ANOP
         AIF   (T'&BFALN EQ 'O').A1093
         AIF   ('&BFALN'(1,1) NE '''').A1092
         AIF   ('&BFALN'(1,3) EQ '''D''' OR '&BFALN'(1,3) EQ '''F''').A*
               1092
         MNOTE 04,'INCORRECT ''BFALN'' VALUE'
         MEXIT
.A1092   ANOP
&LGM     SETA  &LGM+4+7
&POI     SETA  &POI+4
.*
.A1093   ANOP
         AIF   (T'&BUFNO EQ 'O').A1095
         AIF   ('&BUFNO'(1,1) NE '''').A1094
         AIF   (K'&BUFNO LT 4).A1094
         MNOTE 04,'INCORRECT ''BUFNO'' VALUE'
         MEXIT
.A1094   ANOP
&LGM     SETA  &LGM+4+7
&POI     SETA  &POI+4
.*
.A1095   ANOP
         AIF   (T'&DEN EQ 'O').A1099
         AIF   ('&DEN'(1,1) NE '''').A1098
         AIF   (K'&DEN EQ 3).A1097
.A1096   ANOP
         MNOTE 04,'INCORRECT ''DEN'' VALUE'
         MEXIT
.A1097   ANOP
         AIF   ('&DEN'(2,1) NE '0' AND '&DEN'(2,1) NE '1' AND '&DEN'(2,*
               1) NE '2' AND '&DEN'(2,1) NE '3' AND '&DEN'(2,1) NE '4')*
               .A1096
.A1098   ANOP
&LGM     SETA  &LGM+4+7
&POI     SETA  &POI+4
.*
.A1099   ANOP
.************************ READY ********************
.*
.************** NOW GENERATION *********************
.B1000   ANOP
&LGM     SETA  &LGM+8+8
&POI     SETA  &POI+4
.*  GENERATE MACRO-LABEL
         AIF   ('&LAB' EQ '').B1005
&LAB     DS    0H
.*
.B1005   ANOP
.*  G E N E R A T E  INSTRUCTIONS
         GETMAIN R,LV=&LGM
         LR    14,1
         LR    0,1
         LA    14,0(0,14)
         LA    1,&LGM.(,0)
         XR    15,15
         MVCL  0,14
.*
         LA    1,4(,14)
         ST    1,0(,14)
         MVC   4(2,14),=X'1401'
         LA    1,24(,14)
         ST    1,12(,14)
         MVI   0(14),X'80'
.* FILE
&C1      SETC  '(,14)'
&TP      SETA  24
&TU      SETA  &POI
         AIF   (T'&FILE EQ 'O').B1020
* FILE
         LA    1,&TU&C1
         ST    1,&TP&C1
         AIF   (N'&FILE EQ 2).B1015
         AIF   ('&FILE'(1,1) NE '''').B1010
&IND1    SETA  K'&FILE-2
         MVC   &TU.(4,14),=X'00010001'
&TU      SETA  &TU+4
         MVC   &TU.(2,14),=H'&IND1.'
&TU      SETA  &TU+2
         MVC   &TU.(&IND1.,14),=C&FILE
&TU      SETA  &TU+&IND1
&TP      SETA  &TP+4
         AGO   .B1020
.*
.B1010   ANOP
         MVC   &TU.(4,14),=X'00010001'
&TU      SETA  &TU+4
         MVC   &TU.(10,14),&FILE
&TU      SETA  &TU+4
&TP      SETA  &TP+4
         AGO   .B1020
.*
.B1015   ANOP
         MVC   &TU.(14,14),=X'0055000100084040404040404040'
&TU      SETA  &TU+14
&TP      SETA  &TP+4
&FILEPR  SETA  &TU-10
.*
.B1020   ANOP
         AIF   (T'&DA EQ 'O').B1035
* DA
         LA    1,&TU&C1
         ST    1,&TP&C1
&TP      SETA  &TP+4
         AIF   (N'&DA EQ 2).B1030
         MVC   &TU.(4,14),=X'00020001'
&TU      SETA  &TU+4
.*
         AIF   ('&DA'(1,1) NE '''').B1025
&IND1    SETA  K'&DA-2
         MVC   &TU.(2,14),=H'&IND1.'
         MVC   &TU.+2(&IND1.,14),=C&DA
&TU      SETA  &TU+2+&IND1
         AGO   .B1035
.*
.B1025   ANOP
         MVC   &TU.(46,14),&DA
&TU      SETA  &TU+46
         AGO   .B1035
.*
.B1030   ANOP
         MVC   &TU.(6,14),=X'00560001002C'
         MVI   &TU.+6(14),X'40'
         MVC   &TU.+7(43,14),&TU.+6(14)
&DSNPR   SETA  &TU+4
&TU      SETA  &TU+50
.*
.B1035   ANOP
         AIF   (T'&MEMBER EQ 'O').B1045
* MEMBER
         LA    1,&TU&C1
         ST    1,&TP&C1
&TP      SETA  &TP+4
         MVC   &TU.(4,14),=X'00030001'
&TU      SETA  &TU+4
         AIF   ('&MEMBER'(1,1) NE '''').B1040
&IND1    SETA  K'&MEMBER-2
         MVC   &TU.(2,14),=H'&IND1.'
         MVC   &TU.+2(&IND1.,14),=C&MEMBER
&TU      SETA  &TU+2+&IND1
         AGO   .B1045
.*
.B1040   ANOP
         MVC   &TU.(10,14),&MEMBER
&TU      SETA  &TU+10
.*
.B1045   ANOP
         AIF   (T'&DISP(1) EQ 'O').B1060
* DISP(1)
         LA    1,&TU&C1
         ST    1,&TP&C1
&TP      SETA  &TP+4
         MVC   &TU.(6,14),=X'000400010001'
&TU      SETA  &TU+6
         AIF   ('&DISP(1)'(1,1) NE '''').B1055
&DV      SETC  'X''01'''
         AIF   ('&DISP(1)'(2,3) EQ 'OLD').B1050
&DV      SETC  'X''02'''
         AIF   ('&DISP(1)'(2,3) EQ 'MOD').B1050
&DV      SETC  'X''04'''
         AIF   ('&DISP(1)'(2,3) EQ 'NEW').B1050
&DV      SETC  'X''08'''
.*
.B1050   ANOP
         MVI   &TU.(14),&DV
&TU      SETA  &TU+1
         AGO   .B1060
.*
.B1055   ANOP
         MVC   &TU.(1,14),&DISP(1)
&TU      SETA  &TU+1
.*
.B1060   ANOP
         AIF   (T'&DISP(2) EQ 'O').B1075
* DISP(2)
         LA    1,&TU&C1
         ST    1,&TP&C1
&TP      SETA  &TP+4
         MVC   &TU.(6,14),=X'000500010001'
&TU      SETA  &TU+6
         AIF   ('&DISP(2)'(1,1) NE '''').B1070
&DV      SETC  'X''01'''
         AIF   ('&DISP(2)'(2,7) EQ 'UNCATLG').B1065
&DV      SETC  'X''02'''
         AIF   ('&DISP(2)'(2,5) EQ 'CATLG').B1065
&DV      SETC  'X''04'''
         AIF   ('&DISP(2)'(2,6) EQ 'DELETE').B1065
&DV      SETC  'X''08'''
.*
.B1065   ANOP
         MVI   &TU.(14),&DV
&TU      SETA  &TU+1
         AGO   .B1075
.*
.B1070   ANOP
         MVC   &TU.(1,14),&DISP(2)
&TU      SETA  &TU+1
.*
.B1075   ANOP
         AIF   (T'&DISP(3) EQ 'O').B1090
* DISP(3)
         LA    1,&TU&C1
         ST    1,&TP&C1
&TP      SETA  &TP+4
         MVC   &TU.(6,14),=X'000600010001'
&TU      SETA  &TU+6
         AIF   ('&DISP(3)'(1,1) NE '''').B1085
&DV      SETC  'X''01'''
         AIF   ('&DISP(3)'(2,7) EQ 'UNCATLG').B1080
&DV      SETC  'X''02'''
         AIF   ('&DISP(3)'(2,5) EQ 'CATLG').B1080
&DV      SETC  'X''04'''
         AIF   ('&DISP(3)'(2,6) EQ 'DELETE').B1080
&DV      SETC  'X''08'''
.*
.B1080   ANOP
         MVI   &TU.(14),&DV
&TU      SETA  &TU+1
         AGO   .B1090
.*
.B1085   ANOP
         MVC   &TU.(1,14),&DISP(3)
&TU      SETA  &TU+1
.*
.B1090   ANOP
         AIF   (T'&SPACE EQ 'O').B0340
         AIF   (T'&SPACE(1) EQ 'O').B1110
* SPACE(1)
         LA    1,&TU&C1
         ST    1,&TP&C1
&TP      SETA  &TP+4
         AIF   ('&SPACE(1)'(1,1) EQ '''').B1095
         MVC   &TU.(9,14),&SPACE(1)
&TU      SETA  &TU+9
         AGO   .B1110
.*
.B1095   ANOP
         AIF   ('&SPACE(1)'(2,3) EQ 'TRK').B1100
         AIF   ('&SPACE(1)'(2,3) EQ 'CYL').B1105
         MVC   &TU.(6,14),=X'000900010003'
         L     1,=F&SPACE(1)
         STCM  1,7,&TU.+6(14)
&TU      SETA  &TU+9
         AGO   .B1110
.*
.B1100   ANOP
         MVC   &TU.(4,14),=X'00070000'
&TU      SETA  &TU+4
         AGO   .B1110
.*
.B1105   ANOP
         MVC   &TU.(4,14),=X'00080000'
&TU      SETA  &TU+4
.*
.B1110   ANOP
         AIF   (T'&SPACE1(1) EQ 'O').B1120
* SPACE(2,1)
         LA    1,&TU&C1
         ST    1,&TP&C1
&TP      SETA  &TP+4
         AIF   ('&SPACE1(1)'(1,1) NE '''').B1115
         MVC   &TU.(6,14),=X'000A00010003'
         L     1,=F&SPACE1(1)
         STCM  1,7,&TU.+6(14)
&TU      SETA  &TU+9
         AGO   .B1120
.*
.B1115   ANOP
         MVC   &TU.(6,14),=X'000A00010003'
         MVC   &TU.+6(3,14),&SPACE1(1).+1
&TU      SETA  &TU+9
.*
.B1120   ANOP
         AIF   (T'&SPACE1(2) EQ 'O').B1130
* SPACE(2,2)
         LA    1,&TU&C1
         ST    1,&TP&C1
&TP      SETA  &TP+4
         MVC   &TU.(6,14),=X'000B00010003'
&TU      SETA  &TU+6
         AIF   ('&SPACE1(2)'(1,1) NE '''').B1125
         L     1,=F&SPACE1(2)
         STCM  1,7,&TU.(14)
&TU      SETA  &TU+3
         AGO   .B1130
.*
.B1125   ANOP
         MVC   &TU.(3,14),&SPACE1(2).+1
&TU      SETA  &TU+3
.*
.B1130   ANOP
         AIF   (T'&SPACE1(3) EQ 'O').B1140
* SPACE(2,3)
         LA    1,&TU&C1
         ST    1,&TP&C1
&TP      SETA  &TP+4
         MVC   &TU.(6,14),=X'000C00010003'
&TU      SETA  &TU+6
         AIF   ('&SPACE1(3)'(1,1) NE '''').B1135
         L     1,=F&SPACE1(3)
         STCM  1,7,&TU.(14)
&TU      SETA  &TU+3
         AGO   .B1140
.*
.B1135   ANOP
         MVC   &TU.(3,14),&SPACE1(3).+1
&TU      SETA  &TU+3
.*
.B1140   ANOP
         AIF   (T'&SPACE(3) EQ 'O').B0300
* RLSE
         LA    1,&TU&C1
         ST    1,&TP&C1
&TP      SETA  &TP+4
         MVC   &TU.(4,14),=X'000D0000'
&TU      SETA  &TU+4
.*
.B0300   ANOP
         AIF   (T'&SPACE(4) EQ 'O').B0330
* CONTIG,MIXG,ALX
         LA    1,&TU&C1
         ST    1,&TP&C1
&TP      SETA  &TP+4
         MVC   &TU.(6,14),=X'000E00010001'
&TU      SETA  &TU+6
         AIF   ('&SPACE(4)'(1,1) NE '''').B0320
&DV      SETC  'X''02'''
         AIF   ('&SPACE(4)'(2,3) EQ 'ALX').B0310
&DV      SETC  'X''04'''
         AIF   ('&SPACE(4)'(2,4) EQ 'MIXG').B0310
&DV      SETC  'X''08'''
.*
.B0310   ANOP
         MVI   &TU.(14),&DV
&TU      SETA  &TU+1
         AGO   .B0330
.*
.B0320   ANOP
         MVC   &TU.(1,14),&SPACE(4)
&TU      SETA  &TU+1
.*
.B0330   ANOP
         AIF   (T'&SPACE(5) EQ 'O').B0340
* ROUND
         LA    1,&TU&C1
         ST    1,&TP&C1
&TP      SETA  &TP+4
         MVC   &TU.(4,14),=X'000F0000'
&TU      SETA  &TU+4
.*
.B0340   ANOP
         AIF   (T'&VOLUME EQ 'O').B0360
* VOLUME
         LA    1,&TU&C1
         ST    1,&TP&C1
&TP      SETA  &TP+4
         MVC   &TU.(4,14),=X'00100001'
&TU      SETA  &TU+4
         AIF   ('&VOLUME'(1,1) NE '''').B0350
&IND1    SETA  K'&VOLUME-2
         MVC   &TU.(2,14),=H'&IND1.'
         MVC   &TU.+2(&IND1.,14),=C&VOLUME
&TU      SETA  &TU+2+&IND1
         AGO   .B0360
.*
.B0350   ANOP
         MVC   &TU.(8,14),&VOLUME
&TU      SETA  &TU+8
.*
.B0360   ANOP
         AIF   (T'&UNIT EQ 'O').B0380
* UNIT
         LA    1,&TU&C1
         ST    1,&TP&C1
&TP      SETA  &TP+4
         MVC   &TU.(4,14),=X'00150001'
&TU      SETA  &TU+4
         AIF   ('&UNIT'(1,1) NE '''').B0370
&IND1    SETA  K'&UNIT-2
         MVC   &TU.(2,14),=H'&IND1.'
         MVC   &TU.+2(&IND1.,14),=C&UNIT
&TU      SETA  &TU+2+&IND1
         AGO   .B0380
.*
.B0370   ANOP
         MVC   &TU.(8,14),&UNIT
&TU      SETA  &TU+8
.*
.B0380   ANOP
         AIF   (T'&UCOUNT EQ 'O').B0400
* UNIT COUNT
         LA    1,&TU&C1
         ST    1,&TP&C1
&TP      SETA  &TP+4
         MVC   &TU.(6,14),=X'001600010001'
&TU      SETA  &TU+6
         AIF   ('&UCOUNT'(1,1) NE '''').B0390
         L     1,=F&UCOUNT
         STC   1,&TU.(,14)
&TU      SETA  &TU+1
         AGO   .B0400
.*
.B0390   ANOP
         MVC   &TU.(1,14),&UCOUNT.+3
&TU      SETA  &TU+1
.*
.B0400   ANOP
         AIF   (T'&SYSOUT EQ 'O').B0430
* SYSOUT
         LA    1,&TU&C1
         ST    1,&TP&C1
&TP      SETA  &TP+4
         MVC   &TU.(2,14),=X'0018'
&TU      SETA  &TU+2
         AIF   ('&SYSOUT'(1,1) NE '''').B0420
         AIF   ('&SYSOUT'(2,1) NE '*').B0410
         MVC   &TU.(2,14),=X'0000'
&TU      SETA  &TU+2
         AGO   .B0430
.*
.B0410   ANOP
         MVC   &TU.(4,14),=X'00010001'
         MVI   &TU.+4(14),C&SYSOUT
&TU      SETA  &TU+5
         AGO   .B0430
.*
.B0420   ANOP
         MVC   &TU.(5,14),&SYSOUT
&TU      SETA  &TU+5
.*
.B0430   ANOP
         AIF   (T'&FORM EQ 'O').B0450
* FORM
         LA    1,&TU&C1
         ST    1,&TP&C1
&TP      SETA  &TP+4
         MVC   &TU.(4,14),=X'001A0001'
&TU      SETA  &TU+4
         AIF   ('&FORM'(1,1) NE '''').B0440
&IND1    SETA  K'&FORM-2
         MVC   &TU.(2,14),=H'&IND1.'
         MVC   &TU.+2(&IND1.,14),=C&FORM
&TU      SETA  &TU+2+&IND1
         AGO   .B0450
.*
.B0440   ANOP
         MVC   &TU.(6,14),&FORM
&TU      SETA  &TU+6
.*
.B0450   ANOP
         AIF   (T'&OUTLIM EQ 'O').B0470
* OUTLIM
         LA    1,&TU&C1
         ST    1,&TP&C1
&TP      SETA  &TP+4
         MVC   &TU.(6,14),=X'001B00010003'
&TU      SETA  &TU+6
         AIF   ('&OUTLIM'(1,1) NE '''').B0460
         L     1,=F&OUTLIM
         STCM  1,7,&TU.(14)
&TU      SETA  &TU+3
         AGO   .B0470
.*
.B0460   ANOP
         MVC   &TU.(3,14),&OUTLIM.+1
&TU      SETA  &TU+3
.*
.B0470   ANOP
         AIF   (T'&FREE EQ 'O').B0480
* FREE
         LA    1,&TU&C1
         ST    1,&TP&C1
&TP      SETA  &TP+4
         MVC   &TU.(4,14),=X'001C0000'
&TU      SETA  &TU+4
.*
.B0480   ANOP
         AIF   (T'&DEN EQ 'O').B0510
* DEN
         LA    1,&TU&C1
         ST    1,&TP&C1
&TP      SETA  &TP+4
         MVC   &TU.(6,14),=X'003B00010001'
&TU      SETA  &TU+6
         AIF   ('&DEN'(1,1) NE '''').B0500
&DV      SETC  'X''03'''
         AIF   ('&DEN'(2,1) EQ '0').B0490
&DV      SETC  'X''43'''
         AIF   ('&DEN'(2,1) EQ '1').B0490
&DV      SETC  'X''83'''
         AIF   ('&DEN'(2,1) EQ '2').B0490
&DV      SETC  'X''C3'''
         AIF   ('&DEN'(2,1) EQ '3').B0490
&DV      SETC  'X''D3'''
.*
.B0490   ANOP
         MVI   &TU.(14),&DV
&TU      SETA  &TU+1
         AGO   .B0510
.B0500   ANOP
         MVC   &TU.(1,14),&DEN
&TU      SETA  &TU+1
.*
.B0510   ANOP
         AIF   (T'&COPIES EQ 'O').B0530
* COPIES
         LA    1,&TU&C1
         ST    1,&TP&C1
&TP      SETA  &TP+4
         MVC   &TU.(6,14),=X'001D00010001'
&TU      SETA  &TU+6
         AIF   ('&COPIES'(1,1) NE '''').B0520
         L     1,=F&COPIES
         STC   1,&TU.(,14)
&TU      SETA  &TU+1
         AGO   .B0530
.*
.B0520   ANOP
         MVC   &TU.(1,14),&COPIES.+3
&TU      SETA  &TU+1
.*
.B0530   ANOP
         AIF   (T'&LABEL(1) EQ 'O').B0550
* LABEL(1)
         LA    1,&TU&C1
         ST    1,&TP&C1
&TP      SETA  &TP+4
         MVC   &TU.(6,14),=X'001F00010002'
&TU      SETA  &TU+6
         AIF   ('&LABEL(1)'(1,1) NE '''').B0540
         MVC   &TU.(2,14),=H&LABEL(1)
&TU      SETA  &TU+2
         AGO   .B0550
.*
.B0540   ANOP
         MVC   &TU.(2,14),&LABEL(1)
&TU      SETA  &TU+2
.*
.B0550   ANOP
         AIF   (T'&LABEL(2) EQ 'O').B0580
* LABEL(2)
         LA    1,&TU&C1
         ST    1,&TP&C1
&TP      SETA  &TP+4
         MVC   &TU.(6,14),=X'001E00010001'
&TU      SETA  &TU+6
         AIF   ('&LABEL(2)'(1,1) NE '''').B0570
&DV      SETC  'X''01'''
         AIF   ('&LABEL(2)'(2,2) EQ 'NL').B0560
&DV      SETC  'X''02'''
         AIF   ('&LABEL(2)'(2,2) EQ 'SL').B0560
&DV      SETC  'X''04'''
         AIF   ('&LABEL(2)'(2,3) EQ 'NSL').B0560
&DV      SETC  'X''08'''
         AIF   ('&LABEL(2)'(2,3) EQ 'SUL').B0560
&DV      SETC  'X''10'''
         AIF   ('&LABEL(2)'(2,3) EQ 'BLP').B0560
&DV      SETC  'X''21'''
         AIF   ('&LABEL(2)'(2,3) EQ 'LTM').B0560
&DV      SETC  'X''40'''
         AIF   ('&LABEL(2)'(2,2) EQ 'AL').B0560
&DV      SETC  'X''48'''
.*
.B0560   ANOP
         MVI   &TU.(14),&DV
&TU      SETA  &TU+1
         AGO   .B0580
.*
.B0570   ANOP
         MVC   &TU.(1,14),&LABEL(2)
&TU      SETA  &TU+1
.*
.B0580   ANOP
         AIF   (T'&LABEL(3) EQ 'O').B0610
* LABEL(3)
         LA    1,&TU&C1
         ST    1,&TP&C1
&TP      SETA  &TP+4
         MVC   &TU.(6,14),=X'002000010001'
&TU      SETA  &TU+6
         AIF   ('&LABEL(3)'(1,1) NE '''').B0600
&DV      SETC  'X''10'''
         AIF   ('&LABEL(3)'(2,8) EQ 'PASSWORD').B0590
&DV      SETC  'X''30'''
.*
.B0590   ANOP
         MVI   &TU.(14),&DV
&TU      SETA  &TU+1
         AGO   .B0610
.*
.B0600   ANOP
         MVC   &TU.(1,14),&LABEL(3).+3
&TU      SETA  &TU+1
.*
.B0610   ANOP
         AIF   (T'&LABEL(4) EQ 'O').B0640
* LABEL(4)
         LA    1,&TU&C1
         ST    1,&TP&C1
&TP      SETA  &TP+4
         MVC   &TU.(6,14),=X'002100010001'
&TU      SETA  &TU+6
         AIF   ('&LABEL(4)'(1,1) NE '''').B0630
&DV      SETC  'X''40'''
         AIF   ('&LABEL(4)'(2,3) EQ 'OUT').B0620
&DV      SETC  'X''80'''
.*
.B0620   ANOP
         MVI   &TU.(14),&DV
&TU      SETA  &TU+1
         AGO   .B0640
.*
.B0630   ANOP
         MVC   &TU.(1,14),&LABEL(4).+3
&TU      SETA  &TU+1
.*
.B0640   ANOP
         AIF   (T'&EXPDT EQ 'O').B0660
* EXPDT
         LA    1,&TU&C1
         ST    1,&TP&C1
&TP      SETA  &TP+4
         MVC   &TU.(6,14),=X'002200010005'
&TU      SETA  &TU+6
         AIF   ('&EXPDT'(1,1) NE '''').B0650
         MVC   &TU.(5,14),=C&EXPDT
&TU      SETA  &TU+5
         AGO   .B0660
.*
.B0650   ANOP
         MVC   &TU.(5,14),&EXPDT
&TU      SETA  &TU+5
.*
.B0660   ANOP
         AIF   (T'&RETPD EQ 'O').B0680
* RETPD
         LA    1,&TU&C1
         ST    1,&TP&C1
&TP      SETA  &TP+4
         MVC   &TU.(6,14),=X'002300010002'
&TU      SETA  &TU+6
         AIF   ('&RETPD'(1,1) NE '''').B0670
         MVC   &TU.(2,14),=H&RETPD
&TU      SETA  &TU+2
         AGO   .B0680
.*
.B0670   ANOP
         MVC   &TU.(2,14),&RETPD
&TU      SETA  &TU+2
.*
.B0680   ANOP
         AIF   (T'&FCB(1) EQ 'O').B0700
* FCB(1)
         LA    1,&TU&C1
         ST    1,&TP&C1
&TP      SETA  &TP+4
         MVC   &TU.(4,14),=X'00250001'
         AIF   ('&FCB(1)'(1,1) NE '''').B0690
&IND1    SETA  K'&FCB(1)-2
         MVC   &TU.+4(2,14),=H'&IND1.'
         MVC   &TU.+6(&IND1.,14),=C&FCB(1)
&TU      SETA  &TU+6+&IND1
         AGO   .B0700
.*
.B0690   ANOP
         MVC   &TU.+4(6,14),&FCB(1)
&TU      SETA  &TU+10
.*
.B0700   ANOP
         AIF   (T'&FCB(2) EQ 'O').B0730
* FCB(2)
         LA    1,&TU&C1
         ST    1,&TP&C1
&TP      SETA  &TP+4
         MVC   &TU.(6,14),=X'002600010001'
&TU      SETA  &TU+6
         AIF   ('&FCB(2)'(1,1) NE '''').B0720
&DV      SETC  'X''04'''
         AIF   ('&FCB(2)'(2,6) EQ 'VERIFY').B0710
&DV      SETC  'X''08'''
.*
.B0710   ANOP
         MVI   &TU.(14),&DV
&TU      SETA  &TU+1
         AGO   .B0730
.*
.B0720   ANOP
         MVC   &TU.(1,14),&FCB(2)
&TU      SETA  &TU+1
.*
.B0730   ANOP
         AIF   (T'&HOLD EQ 'O').B0740
* HOLD
         LA    1,&TU&C1
         ST    1,&TP&C1
&TP      SETA  &TP+4
         MVC   &TU.(4,14),=X'00590000'
&TU      SETA  &TU+4
.*
.B0740   ANOP
         AIF   (T'&QNAME EQ 'O').B0760
* QNAME
         LA    1,&TU&C1
         ST    1,&TP&C1
&TP      SETA  &TP+4
         MVC   &TU.(4,14),=X'00270001'
&TU      SETA  &TU+4
         AIF   ('&QNAME'(1,1) NE '''').B0750
&IND1    SETA  K'&QNAME-2
         MVC   &TU.(2,14),=H'&IND1.'
         MVC   &TU.+2(&IND1.,14),=C&QNAME
&TU      SETA  &TU+2+&IND1
         AGO   .B0760
.*
.B0750   ANOP
         MVC   TU.(10,14),&QNAME
&TU      SETA  &TU+10
.*
.B0760   ANOP
         AIF   (T'&LRECL EQ 'O').B0780
* LRECL
         LA    1,&TU&C1
         ST    1,&TP&C1
&TP      SETA  &TP+4
         MVC   &TU.(6,14),=X'004200010002'
&TU      SETA  &TU+6
         AIF   ('&LRECL'(1,1) NE '''').B0770
         MVC   &TU.(2,14),=H&LRECL
&TU      SETA  &TU+2
         AGO   .B0780
.*
.B0770   ANOP
         MVC   &TU.(2,14),&LRECL
&TU      SETA  &TU+2
.*
.B0780   ANOP
         AIF   (T'&BLKSIZE EQ 'O').B0800
* BLKSIZE
         LA    1,&TU&C1
         ST    1,&TP&C1
&TP      SETA  &TP+4
         MVC   &TU.(6,14),=X'003000010002'
&TU      SETA  &TU+6
         AIF   ('&BLKSIZE'(1,1) NE '''').B0790
         MVC   &TU.(2,14),=H&BLKSIZE
&TU      SETA  &TU+2
         AGO   .B0800
.*
.B0790   ANOP
         MVC   &TU.(2,14),&BLKSIZE
&TU      SETA  &TU+2
.*
.B0800   ANOP
         AIF   (T'&RECFM EQ 'O').C0000
* RECFM
         LA    1,&TU&C1
         ST    1,&TP&C1
&TP      SETA  &TP+4
         MVC   &TU.(7,14),=X'00490001000100'
&TU      SETA  &TU+6
         AIF   ('&RECFM'(1,1) EQ '''').B0810
         MVC   &TU.(1,14),&RECFM
&TU      SETA  &TU+1
         AGO   .C0000
.*
.B0810   ANOP
&TAB1(01) SETC 'M'
&TAB2(01) SETC 'X''02'''
&TAB1(02) SETC 'R'
&TAB2(02) SETC 'X''02'''
&TAB1(03) SETC 'A'
&TAB2(03) SETC 'X''04'''
&TAB1(04) SETC 'G'
&TAB2(04) SETC 'X''04'''
&TAB1(05) SETC 'S'
&TAB2(05) SETC 'X''08'''
&TAB1(06) SETC 'B'
&TAB2(06) SETC 'X''10'''
&TAB1(07) SETC 'D'
&TAB2(07) SETC 'X''20'''
&TAB1(08) SETC 'T'
&TAB2(08) SETC 'X''20'''
&TAB1(09) SETC 'V'
&TAB2(09) SETC 'X''40'''
&TAB1(10) SETC 'F'
&TAB2(10) SETC 'X''80'''
&TAB1(11) SETC 'U'
&TAB2(11) SETC 'X''C0'''
.*
&IND1    SETA  2
.B0820   ANOP
         AIF   ('&RECFM'(&IND1,1) EQ '''').B0860
&IND2    SETA  1
.B0830   ANOP
         AIF   ('&TAB1(&IND2)' NE '&RECFM'(&IND1,1)).B0850
         OI    &TU.(14),&TAB2(&IND2)
.B0840   ANOP
&IND1    SETA  &IND1+1
         AGO   .B0820
.*
.B0850   ANOP
         AIF   (&IND2 EQ 11).B0840
&IND2    SETA  &IND2+1
         AGO   .B0830
.*
.B0860   ANOP
&TU      SETA  &TU+1
.*******
.C0000   ANOP
*
         LA    1,&TU&C1
         ST    1,&TP&C1
         MVC   &TU.(4,14),=X'00520000'
*
         MVI   &TP.(14),X'80'
* SVC 99
         LR    1,14
         SVC   99
* ERROR-CODES
         XC    &ERROR(1).(4),&ERROR(1)
         LH    1,8(,14)
         STCM  1,3,&ERROR(1)
         LH    1,10(,14)
         STCM  1,3,&ERROR(1).+2
.*
         AIF   (T'&FILE EQ 'O').C0005
         AIF   (N'&FILE EQ 1).C0005
* RETURN FILE
         MVI   &FILE(2).,X'40'
         MVC   &FILE(2).+1(9),&FILE(2)
         MVC   &FILE(2).(2),&FILEPR.(14)
         XR    1,1
         ICM   1,3,&FILEPR.(14)
         LTR   1,1
         BZ    &C2.B
         BCTR  1,0
         EX    1,&C2.A
         B     &C2.B
&C2.A    MVC   &FILE(2).+2(0),&FILEPR.+2(14)
&C2.B    DS    0H
.*
.C0005   ANOP
         AIF   (T'&DA EQ 'O').C0010
         AIF   (N'&DA EQ 1).C0010
* RETURN DA
         MVI   &DA(2).,X'40'
         MVC   &DA(2).+1(45),&DA(2)
         MVC   &DA(2).(2),&DSNPR.(14)
         XR    1,1
         ICM   1,3,&DSNPR.(14)
         LTR   1,1
         BZ    &C2.D
         BCTR  1,0
         EX    1,&C2.C
         B     &C2.D
&C2.C    MVC   &DA(2).+2(0),&DSNPR.+2(14)
&C2.D    DS    0H
.*
.C0010   ANOP
* FREEMAIN
         LA    1,&LGM.(,0)
         AIF   ('&ERROR(2)' EQ 'FREE').FREMAIN
         LTR   15,15
         BNZ   &C2.E
         AGO   .FREMAIM
.FREMAIN ANOP
         ST    15,&ERROR(1).+4
.FREMAIM ANOP
         FREEMAIN R,LV=&LGM.,A=(14)
         AIF   ('&ERROR(2)' NE 'FREE').FREMAIO
         L     15,&ERROR(1).+4
.FREMAIO ANOP
&C2.E    DS    0H
         MEXIT
         MEND
./ ADD  NAME=DATPR
         MACRO
&SYM     DATPR &A=,&I=,&O=,&R=,&JH=19,&IND=LU,&LIB=SBRLIB
         LCLA  &B,&C,&IC,&OC,&RC,&IE,&OE,&RE,&ICE,&B0
         LCLC  &II,&OO,&RR,&I1,&O1,&R1
&ICE     SETA  6
&I1      SETC '&I'
&O1      SETC '&O'
&R1      SETC '&R'
         AIF   ('&A' EQ 'ALL').PRP
         AIF   (T'&A EQ 'O').PRI
         MNOTE 8,'&A ILLEGAL AS PARAMETER'
         MEXIT
.PRP     ANOP
&I1      SETC  'ALL'
&O1      SETC  'ALL'
&R1      SETC  'ALL'
         AGO  .CAPR
.PRI     ANOP
         AIF   (T'&I EQ 'O').PRR
         AIF   ('&I' EQ 'ALL').PRO
         AIF   ('&I' EQ 'D').PRO
         AIF   ('&I' EQ 'N').PRO
         AIF   ('&I' EQ 'S').PRO
         AIF   ('&I' EQ 'K').PRO
         AIF   ('&I' EQ 'M').PRO
         AIF   ('&I' EQ 'P').PRO
         AIF   ('&I' EQ 'L').PRO
         MNOTE 8,'&I ILLEGAL AS PARAMETER'
         MEXIT
.PRO     ANOP
         AIF   ('&O' EQ 'ALL').PRR
         AIF   ('&O' EQ 'N').PRR
         AIF   ('&O' EQ 'S').PRR
         AIF   ('&O' EQ 'K').PRR
         AIF   ('&O' EQ 'M').PRR
         AIF   ('&O' EQ 'P').PRR
         AIF   ('&O' EQ 'L').PRR
         MNOTE 8,'&O ILLEGAL AS PARAMETER'
         MEXIT
.PRR     ANOP
         AIF   (T'&R EQ 'O').CAPR
         AIF  ('&R' EQ 'ALL').CAPR
         AIF ('&R' EQ 'R').CAPR
         MNOTE 8,'&R ILLEGAL AS PARAMETER'
         MEXIT
.CAPR    ANOP
&II      SETC  '&I'
&IE      SETA  1
&OO      SETC  '&O'
&OE      SETA  1
&RR      SETC  '&R'
&RE      SETA  1
.JOBC    ANOP
     PUNCH '//Z223PG&B0.&B JOB (6600,253,1),GRAB,'
     PUNCH '// CLASS=S,TIME=2'
&B       SETA   &B+1
.STEPC   ANOP
     PUNCH '//STEP&C  EXEC ASMFCL,LEPRM='',REUS'''
&C       SETA  &C+1
         AGO  .RLOOP
.ILOOP   ANOP
&OE      SETA  0
         AIF  ('&I1' NE 'ALL').IE
&IE      SETA  0
.AIC     ANOP
         AIF  (&IC LT &ICE).RSIC
&IE      SETA 1
.RSIC    ANOP
&IC      SETA  &IC+1
&II      SETC  'DNSKMPL'(&IC,1)
&ICE     SETA  6
         AIF  ('&O1' EQ 'ALL').BAEQ1
         AIF  ('&RR' EQ 'R').BAEQ1
&ICE     SETA  5
         AIF  ('&II' EQ '&OO').AIC
.BAEQ1   ANOP
         AGO   .OLOOP
.IE      ANOP
&IE      SETA 1
.OLOOP   ANOP
&RE      SETA  0
         AIF   (&OE EQ 1).ILOOP
         AIF  ('&II' NE 'D').CO1
&OO      SETC ''
&RR      SETC ''
&OE      SETA  1
&RE      SETA  1
         AGO   .PDAT
.CO1     ANOP
         AIF  ('&O1' NE 'ALL').OE
.AOC     ANOP
         AIF  ('&RR' EQ 'R').TOC5
         AIF  ('&II' NE 'L').TOC5
         AIF  (&OC LT 4).RSOC
         AGO  .SOE1
.TOC5    ANOP
         AIF  (&OC LT 5).RSOC
.SOE1    ANOP
&OE      SETA  1
.RSOC    ANOP
&OC      SETA &OC+1
&OO      SETC  'NSKMPL'(&OC,1)
         AIF  ('&RR' EQ 'R').BAEQ2
         AIF  ('&R1' EQ 'ALL').BAEQ2
         AIF  ('&OO' EQ '&II').AOC
.BAEQ2   ANOP
         AGO  .RLOOP
.OE      ANOP
&OE      SETA 1
.RLOOP   ANOP
         AIF   (&RE EQ 1).OLOOP
         AIF  ('&R1' NE 'ALL').RE
.ARC     ANOP
&RC      SETA  &RC+1
         AIF  (&RC EQ 2).RC2
         AIF  ('&II' EQ '&OO').ARC
&RR      SETC ''
         AGO .PDAT
.RC2     ANOP
&RR      SETC  'R'
&RC      SETA  0
.RE      ANOP
&RE      SETA  1
.PDAT    ANOP
     PUNCH '         DATUM  I=&II,O=&OO,R=&RR,JHD=&JH'
     PUNCH '         END'
     PUNCH '//LKED.SYSLMOD DD DSN=&IND..&LIB.(&II.DAT&OO.&RR),DISP=SHR'
         AIF  ('&II' NE 'D').TIE
&OO      SETC  '&O'
.TIE     ANOP
         AIF  (&IE EQ 1).IEND
         AIF  (&OE NE 1).STC1
&OC      SETA  0
.STC1    ANOP
         AIF  (&C LT 5).STEPC
&C       SETA  0
         AIF  (&B LT 10).JOBC
&B       SETA  0
&B0      SETA  &B0+1
         AGO  .JOBC
.IEND    ANOP
&IC      SETA  0
         AIF  (&OE EQ 1).OEND
         AGO   .STC1
.OEND    ANOP
&OC      SETA 0
         AIF  (&RE EQ 1).REND
         AGO  .STC1
.REND    ANOP
         MEND
./ ADD  NAME=DATUM
** TITLE   DATUM
** OWNER   SCHAPITZ
** LCHNG   10/04/83 12:01:19   Z228554 SCHAPITZ
         MACRO
&SYM     DATUM &I=,&O=,&R=,&JHD=19
         LCLA  &B
         LCLC  &RX
&B       SETA  4
&RX      SETC  'R4'
&I.DAT&O.&R CSECT
         REG
         XSAVE 12,SVA,&I.DAT&O.&R
         SPACE
*** R3   EINGANGSDATUM
*** R4   AUSGANGSDATUM
         AIF ('&I' EQ 'D').SETRX      WENN DIFFERENZ GEWUENSCHT
         AIF (T'&R EQ 'O').C1         WENN DIFF.ADD. NICHT GEFORDERT
.SETRX   ANOP
&B       SETA  8
&RX      SETC  'R5'
*** R5   DIFFERENZ
.C1      ANOP
         SPACE
         TM    &B.(R1),X'80'          ANZAHL DER PARAMETER RICHTIG ?
         BO    PRUEF2                 JA
         LA    R15,4
         B     XRET
PRUEF2   EQU   *
         LM    R3,&RX,0(R1)
         AIF   ('&I' EQ 'D').DIFROUT  DIFFERENZ IST FESTZUSTELLEN
         AIF   ('&I' EQ 'N').NIN      TT.MM.JJJJ
         AIF   ('&I' EQ 'V').VIN      TTMMJJJJ
         AIF   ('&I' EQ 'X').XIN      JJJJMMTT
         AIF   ('&I' EQ 'L').LIN      TAG,MONAT,JAHR
         MVC   JH1N,JHDFIX
         AIF   ('&I' EQ 'S').SIN      JJMMTT
         AIF   ('&I' EQ 'K').KIN      TTMMJJ
         AIF   ('&I' EQ 'M').MIN      JJ.TTT
         AIF   ('&I' EQ 'P').PIN      JJTTTF (GEPACKT)
         MNOTE 8,'&I  ILLEGAL AS PARAMETER'
         MEXIT
*
.NIN     ANOP
         CLI   2(R3),C'.'             TT.MM.JJJJ
         BNE   PARMERR
         CLI   5(R3),C'.'
         BNE   PARMERR
         MVC   NFORM,0(R3)
         AGO   .GES1
.SIN     ANOP
         MVC   TTN,4(R3)              JJMMTT => TT.MM.JJJJ
         MVC   MMN,2(R3)
         MVC   JH2N,0(R3)
         AGO   .GES1
.KIN     ANOP
         MVC   TTN,0(R3)              TTMMJJ => TT.MM.JJJJ
         MVC   MMN,2(R3)
         MVC   JH2N,4(R3)
         AGO   .GES1
.VIN     ANOP
         MVC   TTN,0(R3)              TTMMJJJJ => TT.MM.JJJJ
         MVC   MMN,2(R3)
         MVC   JHN,4(R3)
         AGO   .GES1
.XIN     ANOP
         MVC   TTN,6(R3)          JJJJMMTT => TT.MM.JJJJ
         MVC   MMN,4(R3)
         MVC   JHN,0(R3)
         AGO   .GES1
.MIN     ANOP
         CLI   2(R3),C'.'         JJ.TTT => TT.MM.JJJJ
         BNE   PARMERR
         MVC   JH2N,0(R3)
         TRT   3(3,R3),TRTTAB     FELD NUMERISCH ?
         BNZ   NONUM              NEIN
         PACK  TTTP,3(3,R3)
.MINP    ANOP
         MVC   MMP,=PL3'0'
         TRT   JHN,TRTTAB
         BNZ   NONUM
         PACK  JJJJP,JHN
         BAL   R6,TESTSCH
         CP    TTTP,TAGZAHL       TAG INNERHALB DES JAHRES ?
         BH    RET8               NEIN
         LA    R7,12              MONATSZAHL
MV1      EQU   *                  FESTSTELLEN MMP
         AP    MMP,=P'1'
         LA    R8,2(R8)
         CP    TTTP,0(2,R8)       INDUSTRIETAGEZAHL ZU MMP ?
         BNH   WEITER             JA
         BCT   R7,MV1             NEIN
         B     RET8               TAGESZAHL NICHT INNERHALB DES JAHRES
WEITER   EQU   *                  FESTSTELLEN TTP
         SH    R8,=H'2'           R8 ZEIGT AUF BISHERIGE TAGEZAHL
         MVC   TTP,TTTP
         SP    TTP,0(2,R8)        TTP = TAGESDATUM
         UNPK  HFELD,MMP          ENTPACKEN MONAT
         MVC   MMN,HFELD+3
         OI    MMN+1,X'F0'
         UNPK  HFELD,TTP          ENTPACKEN TAG
         MVC   TTN,HFELD+3
         OI    TTN+1,X'F0'
         AGO   .GES2
.PIN     ANOP
         UNPK  EINGABEP,0(3,R3)   JJTTTF (GEPACKT)
         MVI   HFELD+4,X'00'
         MVZ   HFELD+4(1),EINGABEP+4
         CLI   HFELD+4,X'C0'
         BNE   PINTEST
         OI    EINGABEP+4,X'F0'
PINTEST  EQU   *
         TRT   EINGABEP,TRTTAB    DATUM NUMERISCH ?
         BNZ   NONUM              NEIN
         MVC   JH2N,EINGABEP      JAHR ENTPACKT NACH JH2N
         MVI   TTTP,X'00'
         MVC   TTTP+1(2),1(R3)    INDUSTRIETAGE GEPACKT IN TTTP(=M)
         AGO   .MINP
.LIN     ANOP
         MVC   TTN,11(R3)
         CLI   11(R3),C' '        TAGESZAHL ZWEISTELLIG ?
         BNE   LIN2               JA
         MVI   TTN,C'0'           NEIN => MIT FUEHRENDER NULL
LIN2     CLI   13(R3),C'.'
         BNE   PARMERR
         CLI   10(R3),C','
         BNE   PARMERR
         CLI   23(R3),C' '
         BNE   PARMERR
         MVC   JHN,24(R3)
         TRT   JHN,TRTTAB
         BNZ   NONUM
         TRT   TTN,TRTTAB
         BNZ   NONUM
         LA    R6,TABMON          TABELLE MIT MONATSNAMEN
         LA    R7,12
         MVC   MMP,=PL3'0'
LLOOP    EQU   *                  FINDEN MONATSZAHL NACH TABMON
         AP    MMP,=P'1'
         CLC   14(9,R3),0(R6)
         BE    LOOPEND
         LA    R6,9(R6)
         BCT   R7,LLOOP
         B     RET8
LOOPEND  EQU   *
         UNPK  HFELD,MMP             ENTPACKEN MONAT
         MVC   MMN,HFELD+3
         OI    MMN+1,X'F0'
*        CALL  WTAG,(NFORM,WOTAG),VL
         CALL  WTAG,(NFORM,WOTAG),VL
         CLC   WOTAG,0(R3)           WOCHENTAG ZU TAGESDATUM PASSEND ?
         BNE   RET8                  NEIN
         AGO   .GES0
.GES1    ANOP
         PACK  MMP,MMN
.GES0    ANOP
         PACK  TTP,TTN
         PACK  JJJJP,JHN
.GES2    ANOP
*
* PRUEFEN AUF NUMERISCH UND GUELTIG
* =================================
         SPACE
         TRT   JHN,TRTTAB       JAHR NUMERISCH ?
         BNZ   NONUM            NEIN
         TRT   MMN,TRTTAB       MONAT NUMERISCH ?
         BNZ   NONUM            NEIN
         TRT   TTN,TRTTAB       TAG NUMERISCH ?
         BNZ   NONUM            NEIN
         CP    MMP,=P'12'       MONAT > 12 ?
         BH    RET8             JA
         CP    MMP,=P'1'        MONAT < 1  ?
         BL    RET8             JA
         CP    TTP,=P'1'        TAG < 1 ?
         BL    RET8             JA
         BAL   R6,TESTSCH       FESTSTELLEN ANZAHL TAGE IM JAHR UND FEB
         ZAP   DW,MMP
         CVB   R7,DW
         BCTR  R7,0             - 1
         SLA   R7,1             * 2
         LA    R6,JANUAR+2(R7)
         CP    TTP,0(2,R6)      TAG INNERHALB DES ANGEGEBENEN MONATS ?
         BH    RET8             NEIN
         LA    R7,0(R7,R8)
         ZAP   TTTP,0(2,R7)
         AP    TTTP,TTP               INDUSTRIETAG AUS EINGABETAG
         AIF   (T'&R EQ 'O').DATAUS   DIFFERENZADDITION UNERWUENSCHT
         AIF   ('&R' EQ 'R').YES      DIFFERENZADDITION ERWUENSCHT
         MNOTE 8,'&R ILLEGAL AS PARAMETER'
.YES     ANOP
         SPACE 3
* DIFFERENZADDITION
* =================
         SPACE
         AP    JJJJP,0(2,R5)        ADDIEREN DER JAHRE
         AP    MMP,2(2,R5)          ADDIEREN DER MONATE
         BP    MUEBLAUF             WENN POSITIV => MUEBLAUF
         SPACE
LO2      SP    JJJJP,=P'1'
         AP    MMP,=P'12'
         BNP   LO2
         SPACE
TUEBLAUF BAL   R6,TESTSCH
         BAL   R6,INDX
         CP    TTP,0(2,R7)
         BNH   MIN2
         ZAP   TTP,0(2,R7)
MIN2     EQU   *
         AP    TTP,4(2,R5)
         BP    BAL
SUB      SP    MMP,=P'1'
         CP    MMP,=PL2'0'
         BP    VERGLT
         SP    JJJJP,=P'1'
         AP    MMP,=P'12'
VERGLT   CP    MMP,=P'2'
         BNE   S2
         BAL   R6,TESTSCH
S2       EQU   *
         BAL   R6,INDX
         AP    TTP,0(2,R7)
         BNP   SUB
         B     FORM1
BAL      EQU   *
         CP    MMP,=P'2'
         BNE   WEITER2
         BAL   R6,TESTSCH     BRANCH NACH TEST-SCHALTJAHR
WEITER2  EQU   *
         BAL   R6,INDX
         CP    TTP,0(2,R7)    VERGLEICH TAGE TAB - TAGE STANDARDDAT
         BNH   FORM1
         AP    MMP,=P'1'      RICHTIG STELLEN
         SP    TTP,0(2,R7)          DER
         CP    MMP,=P'12'     TAGE UND MONATE
         BNH   BAL
         AP    JJJJP,=P'1'
         SP    MMP,=P'12'
         B     BAL
         SPACE
MUEBLAUF CP    MMP,=P'12'
         BNH   TUEBLAUF
         AP    JJJJP,=P'1'
         SP    MMP,=P'12'
         B     MUEBLAUF
         SPACE
INDX     EQU   *
         ZAP   DW,MMP
         CVB   R7,DW
         SLA   R7,1
         LA    R7,MOTAG(R7)
         BR    R6
         SPACE
DIFFERR  EQU   *
         LA    R15,11
         B     XRET
         SPACE
FORM1    EQU   *               *** MMTT = TTT ***
         ZAP   DW,MMP          INDEX BERECHNEN
         CVB   R7,DW
         BCTR  R7,0            - 1
         SLA   R7,1            * 2
         BAL   R6,TESTSCH
         LA    R7,0(R7,R8)
         ZAP   TTTP,TTP
         AP    TTTP,0(2,R7)
         UNPK  HFELD,JJJJP
         MVC   JHN,HFELD+1
         UNPK  HFELD,MMP
         MVC   MMN,HFELD+3
         UNPK  HFELD,TTP
         MVC   TTN,HFELD+3
         OI    MMN+1,X'F0'
         OI    TTN+1,X'F0'
         OI    JHN+3,X'F0'
         SPACE 3
.DATAUS  ANOP
*
* AUFBEREITEN DER AUSGABE
* =======================
         SPACE
         AIF   ('&O' EQ 'N').NOUT      TT.MM.JJJJ
         AIF   ('&O' EQ 'S').SOUT      JJMMTT
         AIF   ('&O' EQ 'K').KOUT      TTMMJJ
         AIF   ('&O' EQ 'M').MOUT      JJ.TTT
         AIF   ('&O' EQ 'P').POUT      JJTTTF (GEPACKT)
         AIF   ('&O' EQ 'L').LOUT      TAG,MONAT,JAHR
         AIF   ('&O' EQ 'V').VOUT      TTMMJJJJ
         AIF   ('&O' EQ 'X').XOUT      JJJJMMTT
         MNOTE 8,'&O ILLEGAL AS PARAMETER'
         MEXIT
.NOUT    ANOP
         MVC   0(10,R4),NFORM          NORMALFORM NACH AUSGABE
         AGO   .GESAMT
.SOUT    ANOP
         MVC   0(2,R4),JH2N            JJMMTT
         MVC   2(2,R4),MMN
         MVC   4(2,R4),TTN
         AGO   .GESAMT
.KOUT    ANOP
         MVC   0(2,R4),TTN             TTMMJJ
         MVC   2(2,R4),MMN
         MVC   4(2,R4),JH2N
         AGO   .GESAMT
.MOUT    ANOP
         MVC   0(2,R4),JH2N            JJ.TTT
         MVI   2(R4),C'.'
         UNPK  HFELD,TTTP
         MVC   3(3,R4),HFELD+2
         OI    5(R4),X'F0'
         AGO   .GESAMT
.VOUT    ANOP
         MVC   0(2,R4),TTN             TTMMJJJJ
         MVC   2(2,R4),MMN
         MVC   4(4,R4),JHN
         AGO   .GESAMT
.XOUT    ANOP
         MVC   0(4,R4),JHN             JJJJMMTT
         MVC   4(2,R4),MMN
         MVC   6(2,R4),TTN
         AGO   .GESAMT
.POUT    ANOP
         MVC   EINGABEP(2),JH2N        JJTTTF (GEPACKT)
         UNPK  HFELD,TTTP
         MVC   EINGABEP+2(3),HFELD+2
         OI    EINGABEP+4,X'F0'
         PACK  HFELD+2(3),EINGABEP
         MVC   0(3,R4),HFELD+2
         AGO   .GESAMT
.LOUT    ANOP
*        CALL  WTAG,(NFORM,WOTAG),VL   TAG,MONAT,JAHR
         CALL  WTAG,(NFORM,WOTAG),VL
         MVC   0(10,R4),WOTAG          WOCHENTAG NACH AUSGABE
         MVI   10(R4),C','
         MVC   11(3,R4),TTN            ZAHL DES WOCHENTAGES NACH AUSG.
         CLI   11(R4),C'0'
         BH    INDMO
         MVI   11(R4),C' '
INDMO    EQU   *
         ZAP   DW,MMP              INDEX FUER MOTAB
         CVB   R6,DW
         BCTR  R6,0                - 1
         MH    R6,=H'9'            * 9  (9 = MONATSLAENGE)
         LA    R6,TABMON(R6)
         MVC   14(9,R4),0(R6)      MONAT NACH AUSGABE
         MVI   23(R4),C' '
         MVC   24(4,R4),JHN        JAHR NACH AUSGABE
         AGO   .GESAMT
.GESAMT  ANOP
         SR    R15,R15             RETURNCODE = 0
XRET     EQU   *
         XRETURN (R15)
TESTSCH  EQU   *                   TESTEN SCHALTJAHR
         ZAP   TAGZAHL,=P'365'     KEIN SCHALTJAHR
         ZAP   FEBRUAR,=P'28'
         LA    R8,TAB365
         ZAP   DW,JJJJP            JAHR NACH DW
         CVB   R11,DW              JAHR IN R11
         ST    R11,FF
         SR    R10,R10
         D     R10,=F'100'         R10=REST  R11=ERGEBNIS
         LTR   R10,R10             :100 TEILBAR (REST=0) ?
         BNZ   NO100               NEIN
         ST    R11,FF              NUR JAHRHUNDERT GESPEICHERT
NO100    EQU   *
         TM    FF+3,X'03'          DURCH 4 TEILBAR ?
         BNZR  R6                  NEIN
         ZAP   TAGZAHL,=P'366'
         ZAP   FEBRUAR,=P'29'
         LA    R8,TAB366
         BR    R6
         SPACE
PARMERR  EQU   *
         LA    R15,12
         B     XRET
         SPACE
NONUM    EQU   *
         LA    R15,10
         B     XRET
         SPACE
RET8     EQU   *
         LA    R15,8
         B     XRET
         SPACE
* DEFINITIONEN
* ============
         SPACE
NFORM    DS    0CL10        TT.MM.JJJJ
TTN      DS    CL2
PPN1     DC    C'.'
MMN      DS    CL2
PPN2     DC    C'.'
JHN      DS    0CL4
JH1N     DS    CL2
JH2N     DS    CL2
         SPACE
EINGABEP DS    CL5
JJJJP    DS    PL3              JAHR  GEPACKT
MMP      DS    PL3              MONAT GEPACKT
TTP      DS    PL3              TAG   GEPACKT
TTTP     DS    PL3              INDUSTRIETAGE GEPACKT
HFELD    DS    CL5
WOTAG    DS    CL10             FELD FUER WOCHENTAG
TAGZAHL  DS    PL2              ANZAHL DER TAGE IM JAHR
JHDFIX   DC    CL2'&JHD'        JAHRHUNDERT-KONSTANTE
         AIF   ('&I' EQ 'L').TABM
         AIF   ('&O' EQ 'L').TABM
         AGO   .DEF
.TABM    ANOP
***
TABMON   DS    0CL108
         DC    CL9'JANUAR   '
         DC    CL9'FEBRUAR  '
         DC    CL9'MAERZ    '
         DC    CL9'APRIL    '
         DC    CL9'MAI      '
         DC    CL9'JUNI     '
         DC    CL9'JULI     '
         DC    CL9'AUGUST   '
         DC    CL9'SEPTEMBER'
         DC    CL9'OKTOBER  '
         DC    CL9'NOVEMBER '
         DC    CL9'DEZEMBER '
         AGO   .DEF
.DIFROUT ANOP
*
* DIFFERENZ ZWISCHEN DATUM1 UND DATUM2
* ====================================
         SPACE
*** R3   DATUM1
*** R4   DATUM2
*** R5   AUSGABE IN TAGEN
*** R6   BAL
*** R7   INDEXREGISTER
         SPACE
         MVI   SW,X'00'
         AIF   ('&O' NE '2').JH19        ALTE VERSION VON DDAT
         CLC   0(8,R3),0(R4)
         BNH   OK
         XR    R3,R4
         XR    R4,R3
         XR    R3,R4
         OI    SW,X'01'
OK       EQU   *
         TRT   0(8,R3),TRTTAB            DATUM NUMERISCH ?
         BNZ   DNONUM                    NEIN
         TRT   0(8,R4),TRTTAB            DATUM NUMERISCH ?
         BNZ   DNONUM                    NEIN
         MVC   D1JH1N,0(R3)              JJJJMMTT
         MVC   D2JH1N,0(R4)              JJJJMMTT
         LA    R3,2(R3)                  => JJMMTT
         LA    R4,2(R4)                  => JJMMTT
         AGO   .JHOK
.JH19    ANOP
         SPACE
         MVC   D1JH1N,DJHDFIX
         MVC   D2JH1N,DJHDFIX
         CLC   0(6,R3),0(R4)
         BNH   PACK
         XR    R3,R4
         XR    R4,R3
         XR    R3,R4
         OI    SW,X'01'            ERGEBNIS NEGATIV
PACK     EQU   *
         TRT   0(6,R3),TRTTAB      DATUM NUMERISCH ?
         BNZ   DNONUM              NEIN
         TRT   0(6,R4),TRTTAB      DATUM NUMERISCH ?
         BNZ   DNONUM              NEIN
.JHOK    ANOP
         LA    R1,2                SCHLEIFE ZWEIMAL DURCHLAUFEN
         LA    R2,DATUM1
PACKLOOP EQU   *
         MVC   10(2,R2),0(R3)      JAHR
         PACK  DW,8(4,R2)          PACKEN JAHR (4-STELLIG)
         CVB   R9,DW
         ST    R9,0(R2)            JAHR BINAER IN FJJ1 BZW. FJJ2
         BAL   R6,DTESTSCH         SCHALTJAHR ?
         PACK  DW,2(2,R3)          PACKEN MONAT
         CP    DW+6(2),=P'12'      MONAT GUELTIG ?
         BH    DPARMERR            NEIN
         CP    DW+6(2),=P'1'       MONAT GUELTIG ?
         BL    DPARMERR            NEIN
         CVB   R10,DW
         BCTR  R10,0               - 1
         SLA   R10,1               * 2
         LA    R6,JANUAR+2(R10)    R6 ZEIGT AUF TAGZAHL DES MONATS
         LA    R10,0(R10,R8)       TAGEZAHL
         ZAP   DW,0(2,R10)         INDUSTRIETAGE
         PACK  TTP,4(2,R3)         TAGE DES MONATS
         CP    TTP,=P'1'           TAG < 1 ?
         BL    DPARMERR            JA
         CP    TTP,0(2,R6)         TAG INNERHALB VON ANGEGEBENEM MONAT
         BH    DPARMERR            NEIN
         AP    DW,TTP              DATUM ALS INDUSTRIETAG
         CVB   R10,DW
         ST    R10,4(R2)           INDUSTRIETAGE BINAER IN FTTT1(FTTT2)
         CR    R10,R7              TAGE INNERHALB DES JAHRES ?
         BH    DPARMERR            NEIN
         LA    R2,DATUM2
         LR    R3,R4
         BCT   R1,PACKLOOP         AUFBEREITEN DES 2.DATUMS
         SPACE
         L     R3,FTTT1
         L     R4,FTTT2
         L     R9,FJJ1             LADEN JAHR1
         BAL   R6,DTESTSCH
         LR    R2,R7               REGISTER FUER GESAMTTAGEZAHL
         C     R9,FJJ2             JAHR1 = JAHR2 ?
         BNE   DWEITER1            NEIN
         SR    R4,R3               TTT2 - TTT1 = DIFFERENZ
         LR    R2,R4
         B     DIFFTAG
         SPACE
DWEITER1 EQU   *
         SR    R2,R3               TAGZAHL BIS 1.1. NAECHSTES JAHR
         SPACE
DWEITER2 EQU   *
         LA    R9,1(R9)            JAHR1 = JAHR1 + 1
         C     R9,FJJ2             JAHR1 = JAHR2 ?
         BNE   DWEITER3
         AR    R2,R4               GESAMTTAGE + TTT2
         B     DIFFTAG             DIFFERENZ BERECHNET
         SPACE
DWEITER3 EQU   *
         BAL   R6,DTESTSCH
         AR    R2,R7               GESAMTTAGE + TAGZAHL VON JAHR1
         B     DWEITER2
         SPACE
DIFFTAG  EQU   *
         ZAP   DW,=P'0'
         CVD   R2,DW
         MVC   0(4,R5),DW+4
         SR    R15,R15
         TM    SW,X'01'
         BNO   XRET
         MVN   3(1,R5),=X'0D'
XRET     EQU   *
         XRETURN (R15)
DPARMERR EQU   *
         LA    R15,8
         B     XRET
         SPACE
DNONUM   EQU   *
         LA    R15,10
         B     XRET
         SPACE
DTESTSCH EQU   *
         LA    R7,365
         LA    R8,TAB365
         ZAP   FEBRUAR,=P'28'    ANZAHL TAGE IM FEBRUAR
         SR    R10,R10
         LR    R11,R9            JAHR IN R11
         D     R10,=F'100'       R10=REST , R11=ERGEBNIS
         LTR   R10,R10
         BZ    D100
         LR    R11,R9
D100     EQU   *
         ST    R11,FF
         TM    FF+3,X'03'        DURCH 4 TEILBAR ?
         BNZR  R6                NEIN
         LA    R7,366
         LA    R8,TAB366
         ZAP   FEBRUAR,=P'29'    ANZAHL TAGE IM FEBRUAR IM SCHALTJAHR
         BR    R6
         SPACE 2
* DEFINITIONEN
* ============
         SPACE
DATUM1   DS    0F
FJJ1     DS    F
FTTT1    DS    F
D1JHN    DS    0CL4
D1JH1N   DS    CL2
D1JH2N   DS    CL2
         SPACE
DATUM2   DS    0F
FJJ2     DS    F
FTTT2    DS    F
D2JHN    DS    0CL4
D2JH1N   DS    CL2
D2JH2N   DS    CL2
         SPACE
TTP      DS    PL2
SW       DS    X
DJHDFIX  DC    CL2'&JHD'
         SPACE
.DEF     ANOP
DW       DS    D
FF       DS    F
TAB365   DS    0XL26
JAN365   DC    X'000C031C'
         DC    X'059C090C120C151C181C212C243C273C304C334C365C'
***
TAB366   DS    0XL26
JAN366   DC    X'000C031C'
         DC    X'060C091C121C152C182C213C244C274C305C335C366C'
***
MOTAG    DS    0XL26
JANUAR   DC    X'000C031C'
FEBRUAR  DS    PL2
         DC    X'031C030C031C030C031C031C030C031C030C031C'
***
TRTTAB   DS    0CL256
         DC    240X'FF'
         DC    10X'00'
         DC    6X'FF'
         LTORG
         MEXIT
         MEND
./ ADD  NAME=DATUMALT
         MACRO
&SYM     DATUMALT &I=,&O=,&R=,&JHD=19
         LCLA  &X,&Y,&Z,&A,&B,&DM,&C
         LCLC  &RX,&J
&DM      SETA  2
&B       SETA  4
&RX      SETC  'R4'
&J       SETC  'JH2'
&I.DAT&O.&R CSECT
         REG
         XSAVE 12,SVA,&I.DAT&O.&R
         AIF ('&I' EQ 'D').SETRX
         AIF (T'&R EQ 'O').C1
.SETRX   ANOP
&B       SETA  8
&RX      SETC  'R5'
.C1      ANOP
         TM    &B.(R1),X'80'
         BO    PRUEF2
         LA    R15,4
         B     XRETURN
PRUEF2   EQU   *
         LM    R3,&RX,0(R1)
         AIF   ('&I' EQ 'D').DIFROUT
         AIF   ('&I' EQ 'N').NROUTIN
         AIF   ('&I' EQ 'S').SROUTIN
         AIF   ('&I' EQ 'K').KROUTIN
         AIF   ('&I' EQ 'M').MROUTIN
         AIF   ('&I' EQ 'P').PROUTIN
         AIF   ('&I' EQ 'L').LROUTIN
         MNOTE 8,'&I  ILLEGAL AS PARAMETER'
         MEXIT
.NROUTIN ANOP
&J       SETC  'JH'
&X       SETA  0
&Y       SETA  6
&DM      SETA  3
         AGO   .ROUT
.SROUTIN ANOP
&X       SETA  4
&Y       SETA  0
         AGO   .ROUT
.KROUTIN ANOP
&X       SETA  0
&Y       SETA  4
.ROUT    ANOP
         MVC   &J,&Y.(R3)
         PACK  JJJJ,JH
         PACK  MM,&DM.(2,R3)
         PACK  TT,&X.(2,R3)
         CP    MM,=P'12'
         BNH   PRUEFEND
.R8      ANOP
RET8     EQU   *
         LA    R15,8
         B     XRETURN
         AIF   ('&I' EQ 'M').RC8
         AIF  ('&I'EQ 'P').RC8
         AIF  ('&I' EQ 'L').RD8
PRUEFEND EQU   *
         CP    MM,=P'1'
         BL    RET8
         ZAP   DW,MM
         CVB   R7,DW
.BCTR7   ANOP
         BCTR  R7,0
         SLA   R7,1
         LA    R6,JANUAR+2(R7)
.TSCH    ANOP
         PACK  JH4,JH1
         DP    JH4,=P'4'
         CLI   JH4+2,X'0C'
         BE    LA366
         CLC   JH2,=C'00'
         BE    MOVE
         ZAP   JH4,JJJJ
         DP    JH4,=P'4'
         CLI   JH4+2,X'0C'
         BNE   MOVE
LA366    EQU   *
         LA    R8,TAB366
         MVC   FEBRUAR,NEUN
         B     MOVE1
MOVE     EQU   *
         LA    R8,TAB365
         MVC   FEBRUAR,ACHT
MOVE1    EQU   *
         AIF   ('&I' EQ 'M').CM
         AIF  ('&I' EQ 'P').CM
         CP    TT,0(2,R6)
         BH    RET8
         CP    TT,=P'1'
         BL    RET8
         LA    R7,0(R7,R8)
         ZAP   TTT,0(2,R7)
         AP    TTT,TT
.BDEF    ANOP
         B     DEFEND
*        R3    EINGABE-DATUM
*        R4    AUSGABE-DATUM
*        R5    DATUMSDIFFERENZ
*        R7    INDEXREGISTER
         AIF   ('&I' NE 'P').PC
EINGABE  DS    CL5
.PC      ANOP
JH       DS    0CL4
JH1      DC    CL2'&JHD'
JH2      DS    CL2
JH4      DC    PL3'0'
STANDARD DS    0PL9
JJJJ     DS    PL3
TTT      DS    PL3
TT       DS    PL3
MM       DC    PL2'0'
**
         AGO   .DEF
.MROUTIN ANOP
ADD      MVC   JH2,0(R3)
         PACK  JJJJ,JH
         PACK  TTT,3(3,R3)
.CM0     ANOP
         MVC   ACHT,=PL2'365'
         MVC   NEUN,=PL2'366'
         AGO   .TSCH
.CM      ANOP
         CP    TTT,FEBRUAR
         BH    RET8
         CP    TTT,=P'1'
         BL    RET8
MV1      EQU   *
         AP    MM,=P'1'  BERECHNUNG VON TT UND MM
         LA    R8,2(R8)
         CP    TTT,0(2,R8)
         BNH   WEITER
         B     MV1
         AGO   .R8
.RC8     ANOP
WEITER   EQU   *
         SH    R8,=H'2'
         MVC   TT,TTT
         SP    TT,0(2,R8)
         MVC   ACHT,=PL2'28'
         MVC   NEUN,=PL2'29'
         AGO   .BDEF
.PROUTIN ANOP
         UNPK  EINGABE,0(3,R3)
         OI    EINGABE+4,X'F0'
ADD      MVC   JH2,EINGABE
         PACK  JJJJ,JH
         PACK  TTT,EINGABE+2(3)
         AGO   .CM0
.LROUTIN ANOP
         CLI   11(R3),C' '
         BNE   TEST
         MVI   11(R3),C'0'
TEST     EQU   *
ADD      MVC   JH2,26(R3)
         PACK  JJJJ,JH
         PACK  TT,11(2,R3)
         LA    R6,TABMON
         SR    R7,R7
LOOP     EQU   *
         LA    R7,1(R7)
         CLC   14(9,R3),0(R6)
         BE    LOOPEND
         CH    R7,=H'12'
         BH    RET8
         LA    R6,9(R6)
         B     LOOP
         AGO   .R8
.RD8     ANOP
LOOPEND  EQU   *
         CVD   R7,DW
         ZAP   MM,DW
         AGO   .BCTR7
.DATCAL  ANOP
         CNOP 0,4
DEFEND   EQU   *
         AIF  (T'&R EQ 'O').DATAUS
         AIF  ('&R' EQ 'R').YES
         MNOTE 8,'&R ILLEGAL AS PARAMETER'
.YES     ANOP
DATCAL   EQU   *
         AP    JJJJ,0(2,R5)
         AP    MM,2(2,R5)
         BP    MUEBLAUF
LO2      SP    JJJJ,EINS
         AP    MM,ZWOELF
         BNP   LO2
TUEBLAUF BAL   R6,TESTSCHA
         BAL   R6,INDX
         CP    TT,0(2,R7)
         BNH   MIN2
         ZAP   TT,0(2,R7)
MIN2     EQU   *
         AP    TT,4(2,R5)
         BP    BAL
SUB      SP    MM,=P'1'
         CP    MM,=PL2'0'
         BP    VERGLT
         SP    JJJJ,EINS
         AP    MM,ZWOELF
VERGLT   CP    MM,=P'2'
         BNE   S2
         BAL   R6,TESTSCHA
S2       EQU   *
         BAL   R6,INDX
         AP    TT,0(2,R7)
         BNP   SUB
         B     FORM1
BAL      EQU   *
         CP    MM,=P'2'
         BNE   WEITER2
         BAL   R6,TESTSCHA    BRANCH NACH TEST-SCHALTJAHR
WEITER2  EQU   *
         BAL   R6,INDX
         CP    TT,0(2,R7)         VERGLEICH TAGE TAB - TAGE STANDARDDAT
         BNH   FORM1
         AP    MM,EINS            RICHTIG STELLEN
         SP    TT,0(2,R7)              DER
         CLC   MM,ZWOELF          TAGE UND MONATE
         BNH   BAL
         AP    JJJJ,EINS
         SP    MM,ZWOELF
         B     BAL
MUEBLAUF CLC   MM,ZWOELF
         BNH   TUEBLAUF
         AP    JJJJ,EINS
         SP    MM,ZWOELF
         B     MUEBLAUF
TESTSCHA EQU   *                   TESTEN SCHALTJAHR
         ZAP   S365,=P'365'
         ZAP   FEBRUAR,ACHT
         LA    R8,TAB365
         MVC   JAHR+1(3),JJJJ
         DP    JAHR,=P'400'
         MVI   JAHR,X'00'
         CLC   JAHR+2(2),=PL2'0'
         BE    SCHALT1
         MVC   JAHR+1(3),JJJJ
         DP    JAHR,=P'100'
         MVI   JAHR,X'00'
         CLC   JAHR+2(2),=PL2'0'
         BCR   8,R6
         MVC   JAHR+1(3),JJJJ
         DP    JAHR,=P'4'
         MVI   JAHR,X'00'
         CLI   JAHR+3,X'0C'
         BCR   7,R6
SCHALT1  EQU   *
         ZAP   S365,=P'366'
         ZAP   FEBRUAR,NEUN
         LA    R8,TAB366
RETURN   BR    R6
INDX     ZAP   DW,MM
         CVB   R7,DW
         SLA   R7,1
         LA    R7,MOTAG(R7)
         BR    R6
FORM1    EQU   *                *** MMTT = TTT ***
         ZAP   DW,MM              INDEX-
         CVB   R7,DW            BE -
         BCTR  R7,0             RECH-
         SLA   R7,1
         BAL   R6,TESTSCHA
         LA    R7,0(R7,R8)
         ZAP   SUTAG,TT
         AP    SUTAG,0(2,R7)
         MVC   TTT,SUTAG
         B     DEFRET
***
ZWOELF   DC    PL2'12'
EINS     DC    PL1'1'
S365     DS    PL2
JAHR     DC    PL4'0'
SUTAG    DC    PL3'00'
         DS    0H
DEFRET   EQU   *
***
***
*        R5    PARAMETER-LISTE
*        R6    BAL
*        R7    INDEX-REGISTER
.DATAUS  ANOP
&B       SETA  2
&C       SETA  2
&DM      SETA  3
         AIF   ('&O' EQ 'N').OROUTN
         AIF   ('&O' EQ 'S').OROUTS
         AIF   ('&O' EQ 'K').OROUTK
         AIF   ('&O' EQ 'M').OROUTM
         AIF   ('&O' EQ 'P').OROUTP
         AIF   ('&O' EQ 'L').OROUTL
         MNOTE 8,'&O ILLEGAL AS PARAMETER'
         MEXIT
.OROUTN  ANOP
         MVI   5(R4),C'.'
         MVI   2(R4),C'.'
&X       SETA  0
&Y       SETA  6
&Z       SETA  9
&A       SETA  1
&B       SETA  3
&DM      SETA  4
&C       SETA  4
         AGO   .ROUTO
.OROUTS  ANOP
&X       SETA  4
&Y       SETA  0
&Z       SETA  1
&A       SETA  5
         AGO   .ROUTO
.OROUTK  ANOP
&X       SETA  0
&Y       SETA  4
&Z       SETA  5
&A       SETA  1
.ROUTO   ANOP
         UNPK  &Y.(&C,R4),JJJJ
         OI    &Z.(R4),X'F0'
         UNPK  &B.(2,R4),MM
         OI    &DM.(R4),X'F0'
         UNPK  &X.(2,R4),TT         TAG NACH AUSGABE
         OI    &A.(R4),X'F0'
.ENDR    ANOP
         ZAP   MM,=P'0'
         LA    R15,0
XRETURN  XRETURN (R15)
         AIF  ('&O' NE 'L').LTO
TABJAHR  DS    0XL337
         DC    X'0C'
         DC    X'2C3C4C5C7C1C2C3C5C6C7C1C'
         DC    X'3C4C5C6C1C2C3C4C6C7C1C2C4C5C6C7C'
         DC    X'5C6C7C1C3C4C5C6C1C2C3C4C'
         DC    X'6C7C1C2C4C5C6C7C2C3C4C5C7C1C2C3C'
         DC    X'5C6C7C2C3C4C5C7C1C2C3C5C'
         DC    X'6C7C1C3C4C5C6C1C2C3C4C6C7C1C2C4C'
         DC    X'1C2C3C5C6C7C1C3C4C5C6C1C'
         DC    X'2C3C4C6C7C1C2C4C5C6C7C2C3C4C5C7C'
         DC    X'3C4C5C7C1C2C3C5C6C7C1C3C'
         DC    X'4C5C6C1C2C3C4C6C7C1C2C4C5C6C7C2C'
         DC    X'6C7C1C3C4C5C6C1C2C3C4C6C'
         DC    X'7C1C2C4C5C6C7C2C3C4C5C7C1C2C3C5C'
         DC    X'1C2C3C5C6C7C1C3C4C5C6C1C'
         DC    X'2C3C4C6C7C1C2C4C5C6C7C2C3C4C5C7C'
         DC    X'4C5C6C1C2C3C4C6C7C1C2C4C'
         DC    X'5C6C7C2C3C4C5C7C1C2C3C5C6C7C1C3C'
         DC    X'7C1C2C4C5C6C7C2C3C4C5C7C'
         DC    X'1C2C3C5C6C7C1C3C4C5C6C1C2C3C4C6C'
         DC    X'2C3C4C6C7C1C2C4C5C6C7C2C'
         DC    X'3C4C5C7C1C2C3C5C6C7C1C3C4C5C6C1C'
         DC    X'5C6C7C2C3C4C5C7C1C2C3C5C'
         DC    X'6C7C1C3C4C5C6C1C2C3C4C6C7C1C2C4C'
         DC    X'7C1C2C4C5C6C7C2C3C4C5C7C'
         DC    X'1C2C3C5C6C7C1C3C4C5C6C1C2C3C4C6C'
TABTAG   DS    0CL77
         DC    CL11'SAMSTAG,   '
         DC    CL11'SONNTAG,   '
         DC    CL11'MONTAG,    '
         DC    CL11'DIENSTAG,  '
         DC    CL11'MITTWOCH,  '
         DC    CL11'DONNERSTAG,'
         DC    CL11'FREITAG,   '
TG       DS    PL3
J28      DC    PL4'0'
K100     DC    PL4'0'
L400     DC    PL4'0'
SCHANZ   DC    PL2'0'
.LTO     ANOP
         LTORG
         MEXIT
.OROUTM  ANOP
         UNPK  0(2,R4),JJJJ        JAHR NACH
         OI    1(R4),X'F0'         AUSGABE
         MVI   2(R4),C'.'
         UNPK  3(3,R4),TTT         TAG NACH
         OI    5(R4),X'F0'         AUSGABE
         AGO   .ENDR
.OROUTP  ANOP
         UNPK  MM,JJJJ
         OI    MM+1,X'F0'
         UNPK  MM+2(3),TTT
         OI    MM+4,X'F0'
         PACK  0(3,R4),MM(5)
         AGO   .ENDR
.OROUTL  ANOP
         UNPK  24(4,R4),JJJJ       JAHR NACH AUSGABE
         OI    27(R4),X'F0'
         MVI   23(R4),C' '
         MVI   13(R4),C'.'
         UNPK  11(2,R4),TT         TAG NACH AUSGABE
         OI    12(R4),X'F0'
         CLC   11(2,R4),=C'09'
         BH    INDMO
         MVI   11(R4),C' '
INDMO    ZAP   DW,MM                 ERRECHNEN INDEX
         CVB   R6,DW                 FUER MOTAB
         BCTR  R6,0
         MH    R6,=H'9'
         LA    R6,TABMON(R6)
         MVC   14(9,R4),0(R6)      MONAT NACH AUSGABE
**                                 BESTIMMEN WOCHENTAG
         SP    JJJJ,=P'1900'    1900 = STICHJAHR
*                                  AKT.JAHR - STICHJAHR
         MVC   J28+1(3),JJJJ
         MVC   K100+1(3),JJJJ
         MVC   L400+1(3),JJJJ
         DP    J28,=P'28'          J=I MOD 28
         AP    L400,=P'300'
         MVC   SCHANZ,J28+2
         DP    K100,=P'100'        K=(I+1):100
         CLC   K100+2,=P'00'        OHNE REST:
         BNE   REST1                    JAN,FEB: J=J-(K-1)
         CLC   MM,=P'01'                 MAERZ-DEZ: J=J-K
         BE    NREST1              MIT REST:      J=J-K
         CLC   MM,=P'02'
         BNE   REST1
NREST1   AP    SCHANZ,=P'1'
REST1    SP    SCHANZ,K100(2)
D400     DP    L400,=P'400'        L=(I+300):400
         CLC   L400+2,=P'00'          OHNE REST:
         BNE   REST2                        JAN,FEB: J=J+(L-1)
         CLC   MM,=P'01'                     MAERZ-DEZ: J=J+L
         BE    NREST2                 MIT REST:       J=J+L
         CLC   MM,=P'02'
         BNE   REST2
NREST2   SP    SCHANZ,=P'1'
REST2    AP    SCHANZ,L400(2)
INDEX1   BNM   INDEX2
         AP    SCHANZ,=P'28'       BERECHNEN INDEX
INDEX2   ZAP   DW,MM                 FUER TABJAHR
         SP    DW,=P'1'
         MP    DW,=P'28'
         AP    DW,SCHANZ
         CVB   R6,DW
         LA    R6,TABJAHR(R6)
         ZAP   TG,0(1,R6)         BERECHNEN INDEX
         AP    TG,TT
         DP    TG,=P'7'
         ZAP   DW,TG+2(1)
         CVB   R6,DW
         MH    R6,=H'11'
         LA    R6,TABTAG(R6)
         MVC   0(11,R4),0(R6)
         AGO   .ENDR
.DIFROUT ANOP
***      R3    DATUM1
***      R4    DATUM2
***      R5    AUSGABE IN TAGEN
***      R6    BAL
***      R7    INDEXREGISTER
         CLC   0(6,R3),0(R4)
         BNH   PACK
         XR    R3,R4
         XR    R4,R3
         XR    R3,R4
         NI    BNEG+1,X'0F'
PACK     EQU   *
         PACK  JJ1,0(2,R3)
         PACK  MM1,2(2,R3)
         PACK  TT1,4(2,R3)
         LA    R3,JJ1
         PACK  JJ2,0(2,R4)
         PACK  MM2,2(2,R4)
         PACK  TT2,4(2,R4)
         LA    R4,JJ2
         NI    1(R3),X'FC'
         NI    3(R3),X'FC'
         NI    5(R3),X'FC'
         NI    3(R4),X'FC'
         NI    1(R4),X'FC'
         NI    5(R4),X'FC'
         CP    2(2,R3),=P'12'      PRUEFEN DATUM1
         BH    RET8
         CP    2(2,R3),=P'01'
         BNL   PRUEFMON
RET8     EQU   *
         OI    BNEG+1,X'F0'
         LA    R15,8
         B     XRETURN1
PRUEFMON CP    2(2,R4),=P'12'      PRUEFEN  DATUM2
         BH    RET8
         CP    2(2,R4),=P'01'
         BL    RET8
         ZAP   0(4,R5),=P'0'
         ZAP   JDIFF,0(2,R4)
         SP    JDIFF,0(2,R3)
         ZAP   DW,2(2,R4)          BERECHNEN GESAMTTAGE
         ZAP   JAHR,0(2,R4)
         BAL   R6,TESTSCHA
         MVC   TTT2+2(2),0(R7)
         LR    R6,R7
         SH    R6,=H'2'
         SP    TTT2+2(2),0(2,R6)
         CP    4(2,R4),TTT2+2(2)
         BH    RET8
         CP    4(2,R4),=P'1'
         BL    RET8
         MVC   TTT2+2(2),0(R6)
         AP    TTT2,4(2,R4)        TTT2: GESAMTTAGE DATUM2
         ZAP   DW,2(2,R3)         BERECHNEN GESAMTTAGE
         ZAP   JAHR,0(2,R3)
         BAL   R6,TESTSCHA
         MVC   TTT1+2(2),0(R7)
         LR    R6,R7
         SH    R6,=H'2'
         SP    TTT1+2(2),0(2,R6)
         CP    4(2,R3),TTT1+2(2)
         BH    RET8
         CP    4(2,R3),=P'1'
         BL    RET8
         MVC   TTT1+2(2),0(R6)
         AP    TTT1,4(2,R3)
         CLC   JDIFF,=PL2'0'
         BE    GESAMTTG
NSW      SP    TAG,TTT1            RESTTAGE BIS ZUM
         AP    0(4,R5),TAG          VOLLEN JAHR
         NI    1(R4),X'FC'
LOOP     AP    0(2,R3),=P'1'
         CLC   0(2,R3),0(R4)       jAQ9  =JA&Q92
         BE    ENDE
         ZAP   JAHR,0(2,R3)
         BAL   R6,TESTSCH
NSW1     AP    0(4,R5),TAG
         B     LOOP
ENDE     EQU   *
         AP    0(4,R5),TTT2
XRETURN  EQU   *
BNEG     B     LAR15
         OI    BNEG+1,X'F0'
         OI    3(R5),X'01'
LAR15    EQU   *
         LA    R15,0
XRETURN1 XRETURN (R15)
GESAMTTG SP    TTT2,TTT1
         AP    0(4,R5),TTT2
         B     XRETURN
TESTSCHA EQU   *
         CVB   R7,DW
         SLA   R7,1
TESTSCH  EQU   *
         DP    JAHR,=P'4'
         CLI   JAHR+2,X'0C'
         BNE   RETURN
         ZAP   TAG+2(2),=P'366'
         LA    R7,TAB366(R7)
         B     RET1
RETURN   EQU   *
         ZAP   TAG+2(2),=P'365'
         LA    R7,TAB365(R7)
RET1     EQU   *
         BR    R6
TTT1     DC    PL4'0'
TTT2     DC    PL4'0'
TAG      DC    PL4'0'
JDIFF    DS    PL2
JJ1      DC    PL2'0'
MM1      DC    PL2'0'
TT1      DC    PL2'0'
JJ2      DC    PL2'0'
MM2      DC    PL2'0'
TT2      DC    PL2'0'
JAHR     DS    PL3
.DEF     ANOP
DW       DS    D
TAB365   DS    0XL26
JAN365   DC    X'000C031C'
         DC    X'059C090C120C151C181C212C243C273C304C334C365C'
***
TAB366   DS    0XL26
JAN366   DC    X'000C031C'
         DC    X'060C091C121C152C182C213C244C274C305C335C366C'
         AIF  ('&I' EQ 'D').DIFEND
***
MOTAG    DS    0XL26
JANUAR   DC    X'000C031C'
FEBRUAR  DS    PL2
         DC    X'031C030C031C030C031C031C030C031C030C031C'
ACHT     DC    PL2'28'
NEUN     DC    PL2'29'
***
         AIF   ('&I' NE 'L').PRO
.TAB     ANOP
TABMON   DS    0CL108
         DC    CL9'JANUAR   '
         DC    CL9'FEBRUAR  '
         DC    CL9'MAERZ    '
         DC    CL9'APRIL    '
         DC    CL9'MAI      '
         DC    CL9'JUNI     '
         DC    CL9'JULI     '
         DC    CL9'AUGUST   '
         DC    CL9'SEPTEMBER'
         DC    CL9'OKTOBER  '
         DC    CL9'NOVEMBER '
         DC    CL9'DEZEMBER '
         AGO   .DATCAL
.PRO     ANOP
         AIF  ('&O' NE 'L').DATCAL
         AGO   .TAB
.DIFEND  ANOP
         LTORG
         MEXIT
         MEND
./ ADD  NAME=DCBEXIT
         MACRO
&NAME    DCBEXIT &IHL=,&OHL=,&ITL=,&OTL=,&OPEN=,&EOV=,&JFCB=,&UTOT=,   *
               &BLOCK=,&DITL=,&DNSL=,&FCB=,                            *
               &ABEND=
         LCLA  &CD
         LCLC  &AD
         AIF   ('&NAME' NE '').DEF
         MNOTE 12,'MACRO INSTRUCTION MUST HAVE A NAME'
         MEXIT
.DEF     ANOP
&AD      SETC  '0'
&NAME    DS    0F
.DIHL    ANOP
         AIF   ('&IHL' EQ '').DOHL
&CD      SETA  1
&AD      SETC  '&IHL'
.DOHL    ANOP
         AIF   ('&OHL' EQ '').DITL
         AIF   (&CD EQ 0).TOHL
         DC    AL1(&CD)
         DC    AL3(&AD)
.TOHL    ANOP
&CD      SETA  2
&AD      SETC  '&OHL'
.DITL    ANOP
         AIF   ('&ITL' EQ '').DOTL
         AIF   (&CD EQ 0).TITL
         DC    AL1(&CD)
         DC    AL3(&AD)
.TITL    ANOP
&CD      SETA  3
&AD      SETC  '&ITL'
.DOTL    ANOP
         AIF   ('&OTL' EQ '').DOPEN
         AIF   (&CD EQ 0).TOTL
         DC    AL1(&CD)
         DC    AL3(&AD)
.TOTL    ANOP
&CD      SETA  4
&AD      SETC  '&OTL'
.DOPEN   ANOP
         AIF   ('&OPEN' EQ '').DEOV
         AIF   (&CD EQ 0).TOPEN
         DC    AL1(&CD)
         DC    AL3(&AD)
.TOPEN   ANOP
&CD      SETA  5
&AD      SETC  '&OPEN'
.DEOV    ANOP
         AIF   ('&EOV' EQ '').DJFCB
         AIF   (&CD EQ 0).TEOV
         DC    AL1(&CD)
         DC    AL3(&AD)
.TEOV    ANOP
&CD      SETA  6
&AD      SETC  '&EOV'
.DJFCB   ANOP
         AIF   ('&JFCB' EQ '').DUTOT
         AIF   (&CD EQ 0).TJFCB
         DC    AL1(&CD)
         DC    AL3(&AD)
.TJFCB   ANOP
&CD      SETA  7
&AD      SETC  '&JFCB'
.DUTOT   ANOP
         AIF   ('&UTOT' EQ '').DBLK
         AIF   (&CD EQ 0).TUTOT
         DC    AL1(&CD)
         DC    AL3(&AD)
.TUTOT   ANOP
&CD      SETA  10
&AD      SETC  '&UTOT'
.DBLK    ANOP
         AIF   ('&BLOCK' EQ '').DDITL
         AIF   (&CD EQ 0).TBLK
         DC    AL1(&CD)
         DC    AL3(&AD)
.TBLK    ANOP
&CD      SETA  11
&AD      SETC  '&BLOCK'
.DDITL   ANOP
         AIF   ('&DITL' EQ '').DDNSL
         AIF   (&CD EQ 0).TDITL
         DC    AL1(&CD)
         DC    AL3(&AD)
.TDITL   ANOP
&CD      SETA  12
&AD      SETC  '&DITL'
.DDNSL   ANOP
         AIF   ('&DNSL' EQ '').DFCB
         AIF   (&CD EQ 0).TDNSL
         DC    AL1(&CD)
         DC    AL3(&AD)
.TDNSL   ANOP
&CD      SETA  13
&AD      SETC  '&DNSL'
.DFCB    ANOP
         AIF   ('&FCB' EQ '').DABE
         AIF   (&CD EQ 0).TFCB
         DC    AL1(&CD)
         DC    AL3(&AD)
.TFCB    ANOP
&CD      SETA  16
&AD      SETC  '&FCB'
.DABE    ANOP
         AIF   ('&ABEND' EQ '').LDEF
         AIF   (&CD EQ 0).TABE
         DC    AL1(&CD)
         DC    AL3(&AD)
.TABE    ANOP
&CD      SETA  17
&AD      SETC  '&ABEND'
.LDEF    ANOP
&CD      SETA  &CD+128
         DC    AL1(&CD)
         DC    AL3(&AD)
         MEND
./ ADD  NAME=DCBUA
         MACRO
&NAME    DCBUA &DDNAME=,&DSORG=,&MACRF=,&EODAD=,&JFCB=,&EROPT=,        *
               &OPTCD=,&SYNAD=
         LCLA  &A1
         LCLB  &B1
         LCLC  &CNAME,&CDDN,&CDSO,&CMACRF,&CEODAD,&CJFCB,&CSYNAD
         ACTR  100
.* CHECK PARAMETER
         AIF   (T'&NAME NE 'O').DCBN2
&CNAME   SETC  'SYSIN'
         AGO   .DDN1
.DCBN2   ANOP
&CNAME   SETC  '&NAME'
         AIF   (K'&NAME LE 7).DDN1
         MNOTE 8,'DCBNAME EXEEDS 7 BYTES -MACRO IGNORED-'
         MEXIT
.DDN1    AIF   (T'&DDNAME NE 'O').DDN2
&CDDN    SETC  'SYSIN'
         AGO   .DSO1
.DDN2    ANOP
&CDDN    SETC  '&DDNAME'
.DSO1    AIF   (T'&DSORG NE 'O').DSO2
&CDSO    SETC  'PS'
         AGO   .MACR1
.DSO2    ANOP
&CDSO    SETC  '&DSORG'
.MACR1   AIF   (T'&MACRF NE 'O').MACR2
&CMACRF  SETC  'GM'
         AGO   .EODAD1
.MACR2   ANOP
&CMACRF  SETC  '&MACRF'
.EODAD1  AIF   (T'&EODAD NE 'O').EODAD2
&CEODAD  SETC  'EOFSYSIN'
         AGO   .JFCB1
.EODAD2  ANOP
&CEODAD  SETC  '&EODAD'
.JFCB1   AIF   (T'&JFCB NE 'O').JFCB2
&B1      SETB  1
         AGO   .SYNAD1
.JFCB2   ANOP
&CJFCB   SETC  '&JFCB'
.SYNAD1  ANOP
         AIF   (T'&SYNAD NE 'O').SYNAD2
&CSYNAD  SETC  '1'
         AGO   .DCBHH1
.SYNAD2  ANOP
&CSYNAD  SETC  '&SYNAD'
.DCBHH1  ANOP
.* CREATE DCB
&CNAME   DCB   DDNAME=&CDDN,DSORG=&CDSO,MACRF=&CMACRF,EODAD=&CEODAD,   *
               EROPT=&EROPT,OPTCD=&OPTCD,SYNAD=&CSYNAD,                *
               EXLST=EXL&SYSNDX
.* EXIT LIST
* DCB EXIT LIST
         DS    0F
         AIF   (&B1).DCBHH2
EXL&SYSNDX DC  AL1(5)
         AGO   .DCBHH3
.DCBHH2  ANOP
EXL&SYSNDX DC  AL1(128+5)              OPEN EXIT
.DCBHH3  ANOP
         DC    AL3(EXR&SYSNDX)
         AIF   (&B1).DCBHH4
         DC    AL1(128+7)
         DC    AL3(&CJFCB)
.DCBHH4  ANOP
         SPACE
****************************************
*** HANDLE 'UNLIKE ATTRIBUTES IN INPUT
*** DCB- AND EOV EXIT ROUTINE
****************************************
EXR&SYSNDX DS  0H
         USING *,15                    ADDRESSABILITY
EXR&SYSNDX.B EQU *+1                   FIRST TIME SWITCH
         NOP   EXR&SYSNDX.D            *
         OI    EXR&SYSNDX.B,X'F0'      RESET FIRST TIME SWITCH
         OI    &CNAME+X'30',X'08' .    SET 'UNLIKE ATTRIBUTES'
EXR&SYSNDX.C DS 0H
         BR    14                      RETURN TO OPEN OR EOV ROUTINE
EXR&SYSNDX.D DS 0H
         OI    &CNAME.Z,X'FF'          SET REREAD SWITCH
         B     EXR&SYSNDX.C            RETURN
         DROP  15                      DROP BASE OF EXIT
&CNAME.Z DC    X'0'                    REREAD SWITCH, SET TO FF ON EOV
         SPACE 3
         MEND
./ ADD  NAME=DECB
         MACRO
         DECB  &ACSM=
         LCLA  &NAM,&XAM
         LCLB  &FIRST,&BS,&BD,&BT
         LCLC  &AM
&NAM     SETA  N'&ACSM
         AIF   (&NAM EQ 0).ENO
&FIRST   SETB  (1)
.CONT    ANOP
&XAM     SETA  &XAM+1
         AIF   (&XAM GT &NAM).OUT
&AM      SETC  '&ACSM(&XAM)'
         AIF   ('&AM' EQ 'BSAM').BSAM
         AIF   ('&AM' EQ 'BDAM').BDAM
         AIF   ('&AM' EQ 'BTAM').BTAM
         AGO   .EAM
.BSAM    ANOP
         AIF   (&BS).EAM
&BS      SETB  (1)
         AIF   (&FIRST).COM
         AGO   .BSAMC
.BDAM    ANOP
         AIF   (&BD).EAM
&BD      SETB  (1)
         AIF   (&FIRST).COM
         AGO   .BDAMC
.BTAM    ANOP
         AIF   (&BT).EAM
&BT      SETB  (1)
         AIF   (&FIRST).COM
         AGO   .BTAMC
.COM     ANOP
*
*        SYMBOLIC DEFINITION OF DECB FIELDS
*
** COMMON FIELDS
DECSDECB DC    0F'0'                   ECB
         DC    X'00'
DECEXCD1 DC    X'00'                   EXCEPTION CODE BYTE 1
DECEXCD2 DC    X'00'                   EXCEPTION CODE BYTE 2
         DC    X'00'
DECTYPE  DC    XL2'00'                 TYPE AND OPTIONS
DECLNGTH DC    H'0'                    LENGTH
DECDCBAD DC    A(0)                    DCB ADDRESS
DECAREA  DC    A(0)                    AREA ADDRESS
         AIF   (&BT).BTAMD
         AIF   (&BD).BDAMD
         AGO   .BSAMD
.BSAMC   ANOP
         AIF   (&BD).EXIT
         ORG   DECAREA+4
.BSAMD   ANOP
*   BSAM/BDAM FIELD
DECIOBPT DC    A(0)                    IOB ADDRESS
         AGO   .EXIT
.BDAMC   ANOP
         AIF   (&BS).BDAMC1
         ORG   DECAREA+4
         AGO   .BDAMD
.BDAMC1  ANOP
         ORG   DECIOBPT+4
         AGO   .BDAMD1
.BDAMD   ANOP
*   BDAM/BSAM FIELD
DECIOBPT DC    A(0)                    IOB ADDRESS
.BDAMD1  ANOP
*   BDAM FIELDS
DECKYADR DC    A(0)                    KEY ADDRESS
DECRECPT DC    A(0)                    BLOCK REF POINTER
         AGO   .EXIT
.BTAMC   ANOP
         ORG   DECAREA+4
.BTAMD   ANOP
*   BTAM FIELDS
DECSENS0 DC    X'00'                   SENSE
DECSENS1 DC    X'00'                   RSVD
DECCOUNT DC    H'0'                    CSW RESIDUAL COUNT
DECCMCOD DS    0XL1                    COMMAND CODE ON ERROR
DECENTRY DC    A(0)                    ADDR IN TERMINAL LIST
DECFLAGS DC    X'00'                   FLAGS
DECRLN   DC    X'00'                   REL LINE NUMBER
DECRESPN DS    0XL2                    RESPONSE FIELDS
DECADRSP DC    X'00'                   RESPONSE TO ADDRESSING
DECRCRSP DC    X'00'                   LRC/VRC RESPONSE
DECTPCOD DC    X'00'                   TP-OP CODE
DECERRST DC    X'00'                   I/O ERROR STATUS
DECCSWST DC    XL2'00'                 CSW STATUS FOR LAST CCW
DECADRPT DC    A(0)                    LAST ENTRY IN ADDR LIST PTR
DECPOLPT DC    A(0)                    ENTRY PTR/INDEX & ADDR POLL LIST
         DC    H'0'                    RSVD
DECWLNG  DC    H'0'                    AREA LENGTH I LEADING GRAPHS/
DECWAREA DC    A(0)                    AREA ADDR   I CONVERSATIONAL
         AGO   .EXIT
.EXIT    ANOP
&FIRST   SETB  (0)
         AGO   .CONT
.ENO     MNOTE 4,'ACCESS METHOD OMITTED'
         AGO   .TERM
.EAM     MNOTE 4,'ACCESS METHOD INVALID OR DUPLICATE - IGNORED'
         AGO   .CONT
.TERM    MNOTE *,'GENERATION TERMINATED'
.OUT     MEND
./ ADD  NAME=DECIMAL
         MACRO
&SYM     DECIMAL &S,&T,&L,&SIGN=YES
         LCLA  &LEN
         LCLC  &REG,&M
         AIF   ('&S' EQ '').NOSRC
         AIF   ('&T' EQ '').NOTGT
         AIF   ('&L' EQ '').NOLEN
&LEN     SETA  &L
         AGO   .LEN
.NOLEN   ANOP
&LEN     SETA  L'&T
.LEN     AIF   (&LEN GT 16).ERRL
         AIF   (&LEN LT 1).ERRL
&REG     SETC  '0'
         AIF   ('&S'(1,1) EQ '(').REGS
         AIF   (T'&S EQ 'F').WORD
         AIF   (T'&S EQ 'H').HWORD
         AIF   (T'&S EQ 'A').ERRS
         AIF   (L'&S EQ 4).WORD
         AIF   (L'&S EQ 2).HWORD
&SYM     DS    0H
         SR    0,0
         IC    0,&S
         AGO   .CVD
.HWORD   ANOP
&M       SETC  'H'
.WORD    ANOP
&SYM     DS    0H
         L&M   0,&S
         AGO   .CVD
.REGS    AIF   ('&S'(K'&S,1) NE ')').ERRS
&REG     SETC  '&S'(2,K'&S-2)
&SYM     DS    0H
.CVD     CNOP  0,8
         CVD   &REG,*+8
         B     *+12
         DC    XL8'00'
         AIF   ('&SIGN' EQ 'YES').LEAVE
         OI    *-1,X'0F'
         UNPK  &T.(&LEN),*-12(8)
         MEXIT
.LEAVE   ANOP
         UNPK  &T.(&LEN),*-8+(8-(&LEN/2+1))
         MEXIT
.ERRL    MNOTE 8,'INVALID LEN FOR &T'
         MEXIT
.ERRS    MNOTE 8,'INCORRECT TYPE OR SYNTAX FOR &S'
         MEXIT
.NOTGT   MNOTE 8,'2ND OP REQUIRED'
         MEXIT
.NOSRC   MNOTE 8,'1ST OP REQUIRED'
         MEND
./ ADD  NAME=DECINSTR
         MACRO
&NAME    DECINSTR &L=,&T=
.*       DEFINING AN INSTRUCTION
.*
.*             L=(F,L)
.*       INSTR
.*             L=(V,OFFS,C(1),L(1)...,C(N),L(N))
.*       F=FIX, L=LENGTH OF INSTRUCTION
.*       OFFS=OFFSET WITHIN INSTRUCTION (HEX)
.*       V=VARIABLE
.*       WITH MASK OR DIRECT VALUE C(I) THE INSTRUCTION WILL HAVE THE
.*       LENGTH L(I)
.*
         LCLA  &K,&I,&J,&M,&O,&N
&N       SETA  N'&L
         AIF   (T'&L EQ 'O').ERR3
         AIF   ('&L(1)' NE 'F' AND '&L(1)' NE 'V').ERR1
         AIF   ('&L(1)' EQ 'V').VAR
         AIF   (&N NE 2).ERR2
&NAME    DC    0D'0'         FIX INSTRUCTION TABLE
         DC    X'80'         INDICATE FIX FORMAT
         DC    AL1(&L(2))    INSTRUCTION LENGTH
         MEXIT
.VAR     ANOP
&NAME    DC    0D'0'         VARIABLE INSTRUCTION TABLE
         AIF   (T'&T EQ 'O').NOTM
         DC    X'40' INDICATE VARIABLE FORMAT WITH TEST UNDER MASK
         AGO   .SETI
.NOTM    ANOP
         DC    X'00'         INDICATE VARIABLE FORMAT
.SETI    ANOP
         DC    AL1(&L(2))    CRITERIUM OFFSET
&I       SETA  K'&L(3)
&I       SETA  &I/2          EBCDIC AS HEX
         AIF   (T'&T EQ 'O').LCI
         DC    X'&T' BIT POSITIONS TO BE TESTED
         AGO   .SETJ
.LCI     ANOP
         DC    AL1(&I)       LENGTH FOR ONE COMPARE
.SETJ    ANOP
&J       SETA  &N-2          N OF C(N)
&K       SETA  &J/2+&J/2*&I  COMPUTE LENGTH
         DC    AL2(&K)       REST TABLE LENGTH
&J       SETA  &N-&J+1       SET J BEHIND FIX PART
.LOOP    ANOP
         AIF   (&N LT &J).LEAVE
         DC    X'&L(&J)'     MASK/COMPARE ID
         DC    XL1'&L(&J+1)' INSTRUCTION LENGTH
&J       SETA  &J+2
         AGO   .LOOP
.LEAVE   ANOP
         MEXIT
.*
.*       ERRORS
.*
         MEXIT
.ERR1    MNOTE 8,'NO FIX OR VARIABLE FORMAT SPECIFIED'
         MEXIT
.ERR2    MNOTE 8,'MORE OR LESS THAN 2 SUBLIST OPERANDS'
         MEXIT
.ERR3    MNOTE 8,'NO OPERAND SPECIFIED, MACRO IGNORED'
         MEXIT
.ERR4    MNOTE 8,'MODE NOT CI NOR TM, MACRO IGNORED'
         MEND
./ ADD  NAME=DECOPER
         MACRO
&NM      DECOPER
.*       DEFINE OPERATION TO BE ANALYZED
.*       CALL MACRO FOR EACH FORMAT IN THE FOLLOWING FORM
.*         OPER  (A,B,C,D,(E,F)),           *
.*               (G,H,I,J,(K,L))
.*               A = INDEX FOR PRINTING ROUTINE
.*               B = ACTION TYPE
.*                     TX1 = MOVE A TEXT
.*                     TX2 = MOVE A TEXT
.*                     DAD = DATA ADDRESS GENERATION
.*                     BAD = BRANCH ADDRESS GENERATION
.*                     MVC = MOVE A CONSTANT
.*               C = START BIT POSITION OF SENDING FIELD
.*               D = END   BIT POSITION OF SENDING FIELD
.*               E = START BIT POSITION OF RECEIVING FIELD
.*               F = END   BIT POSITION OF RECEIVING FIELD
.*               E, F NOT ALLOWED WITH KEYWORD TXT
.*       DEFINE THE WHOLE TABLE BY 1 OPER MACRO PER FORMAT
.*       I.E.:
.*             OPER  ......,       *
.*                   ......
.*             OPER  .....
.*               .
.*               .
.*               .
.*       FMTEND EQU   *      (NECESSARY)
         GBLA  &CNT1,&CNT2
         GBLB  &SW1
         LCLA  &NSUBP,&NSOP,&INDX,&SCNT
         LCLC  &C
&NSUBP   SETA  N'&SYSLIST
&SCNT    SETA  1
&INDX    SETA  1
&CNT1    SETA  &CNT1+1
         AIF   (&SW1).TABST
         SPACE 2
*        EQUATE VALUES DEFINING ACTION TYPES
         SPACE 1
TX1      EQU   004  MOVE TEXT, BITS SPECIFIED CONTAIN INDEX
TX2      EQU   008  MOVE TEXT, VALUE SPECIFIED IS INDEX
TX3      EQU   012  MOVE TEXT, INDEX WAS BUILT BEFORE WITH IXS
DAD      EQU   016           DATA ADDR GENERATION
BAD      EQU   020           BRANCH ADDR GENERATION
MCX      EQU   024           MOVE A CONSTANT (HEX)
MCE      EQU   028  MOVE A CONSTANT (EBCDIC)
IXS      EQU   032  INDEX SUMMARY FOR LATER TEXT MOVE
MVF      EQU   036  MOVE FORMAT IDENTIFICATION
         SPACE 2
         DS    0D
&NM      DC    AL2(FMTEND-*) WHOLE TABLE LENGTH
&SW1     SETB  1
.TABST   ANOP
         DC    AL2(F&SYSNDX.A-*)   TABLE LENGTH THIS FORMAT
         DC    AL2(&CNT1)    FORMAT IDENTIFIER
.LOOP    ANOP
         AIF   (&SCNT GT &NSUBP).ALLEND
         DC    AL2(F&SYSNDX&INDX-*)   LENGTH OF SUBPART
&NSOP    SETA  N'&SYSLIST(&INDX)
&C       SETC  '&SYSLIST(&INDX,2)'
         AIF   (&NSOP EQ 3 AND '&C' EQ 'TX3').NRSOK
         AIF   (&NSOP EQ 2 AND '&C' EQ 'MVF').NRSOK
         AIF   (&NSOP EQ 6 AND '&C' EQ 'IXS').NRSOK
         AIF   (&NSOP EQ 4 AND '&C' EQ 'TX2').NRSOK
         AIF   (&NSOP EQ 5 AND '&C' EQ 'TX1').NRSOK
         AIF   (&NSOP EQ 6 AND '&C' EQ 'BAD').NRSOK
         AIF   (&NSOP EQ 6 AND '&C' EQ 'DAD').NRSOK
         AIF   (&NSOP EQ 4 AND '&C' EQ 'MCX').NRSOK
         AIF   (&NSOP EQ 4 AND '&C' EQ 'MCE').NRSOK
         AGO   .ERR
.NRSOK   ANOP
         DC    AL1(&SYSLIST(&INDX,1))    LIST INDEX TO PRINT ROUTINE
         DC    AL1(&SYSLIST(&INDX,2))    DEFINE ACTION TO BE TAKEN
         AIF   ('&C' EQ 'MVF').SETNEW
         AIF   ('&C' EQ 'TX3').TEXTE
         AIF   ('&C' EQ 'TX1' OR '&C' EQ 'TX2').TEXTE
         DC    AL1(&SYSLIST(&INDX,3))    START BIT POS SENDING
         DC    AL1(&SYSLIST(&INDX,4))    END   BIT POS SENDING
         AIF   ('&C' EQ 'MCX' OR '&C' EQ 'MCE').SETNEW
         AIF   (&SYSLIST(&INDX,4) LE &SYSLIST(&INDX,3)).ERR2
         AIF   (&SYSLIST(&INDX,6) LE &SYSLIST(&INDX,5)).ERR2
         DC    AL1(&SYSLIST(&INDX,5))    START BIT POS RECEIVING
         DC    AL1(&SYSLIST(&INDX,6))    END   BIT POS RECEIVIN&
         AGO   .SETNEW
.TEXTE   ANOP
         DC    AL2(&SYSLIST(&INDX,3)) ID FOR TEXT TABLE
         AIF   ('&C' EQ 'TX2').TX2
         AIF   ('&C' EQ 'TX3').SETNEW
         AIF   (&SYSLIST(&INDX,5) LE &SYSLIST(&INDX,4)).ERR2
         DC    AL1(&SYSLIST(&INDX,4))  INDEX STARTING BIT POSITION
         DC    AL1(&SYSLIST(&INDX,5))  INDEX ENDING   BIT POSITION
         AGO   .SETNEW
.TX2     DC    AL1(&SYSLIST(&INDX,4)) INDEX OF TEXT FIELD IN TABLE
         DC    AL1(0)  DUMMY BYTE TO PROVIDE EVEN ORIGIN
.SETNEW  ANOP
F&SYSNDX&INDX EQU   *
&INDX    SETA  &INDX+1
&SCNT    SETA  &SCNT+1
         AGO   .LOOP
.ALLEND  ANOP
F&SYSNDX.A EQU   *
         MEXIT
.ERR     MNOTE 8,'ERROR IN SUBLIST OPERAND: &INDX, SPECIFIED ACTION TYP*
               E: &C'
         MEXIT
.ERR2    MNOTE 8,'END BIT POSITION NOT GREATER THAN START BIT POS.'
         MEND
./ ADD  NAME=DECTEXT
         MACRO
&NAME    DECTEXT
         LCLA  &NSUBP,&INDX,&NSOP,&SINDX,&STL,&CNT,&INDX2
         LCLA  &LOPCNT,&S,&OPIX
         LCLA  &SCNT
         LCLC  &C,&FMT
         LCLC  &CC,&BLANK
&NSUBP   SETA  N'&SYSLIST
&INDX    SETA  1
&SCNT    SETA  1
&SINDX   SETA  1
&OPIX    SETA  1
&BLANK   SETC  '       '
&NAME    DC    A(T&SYSNDX.Z)    POINTS TO END OF TEXT TABLE
.LOOP1   ANOP
         AIF   (&SCNT GT &NSUBP).ALLEND
&LOPCNT  SETA  1
&C       SETC '&SYSLIST(&INDX,1)'
&C       SETC  '&C&BLANK'
         AIF   ('&C'(1,1) NE 'V' AND '&C'(1,1) NE 'F').ERR1
         AIF   ('&C'(2,1) EQ ' ' AND '&C'(1,1) EQ 'V').SID
         AIF   ('&C'(4,1) EQ ' ' AND '&C'(1,1) EQ 'F').SID
         AIF   ('&C'(1,1) EQ 'V').LONGV
&CC      SETC  '&C'(4,2)
&LOPCNT  SETA  &CC
         AGO   .SID
.LONGV   ANOP
&CC      SETC  '&C'(2,2)
&LOPCNT  SETA  &CC
.SID     ANOP
         DC    AL2(&OPIX) SUBFORMAT ID, IDENTICAL TO VALUE IN DECOPER
         DC    AL2(T&SYSNDX&OPIX-*)      LENGTH OF SUBPART
         AIF   ('&C'(1,1) EQ 'V').VAR
&C       SETC  '&C'(2,2)
&S       SETA  2
         DC    AL2(&C)         LENGTH OF EACH ITEM
.FIXSTR  ANOP
&C       SETC '&SYSLIST(&INDX,&S)' SET ON STRING
         AIF   ('&C'(1,1) NE '''').NOHYP
         DC    C&SYSLIST(&INDX,&S) TEXT STRING
         AGO   .LONGFIX
.NOHYP   ANOP
         DC    C'&SYSLIST(&INDX,&S)' TEXT STRING
.LONGFIX ANOP
&LOPCNT  SETA  &LOPCNT-1
         AIF   (&LOPCNT EQ 0).SETHIGH
&S       SETA  1
&SINDX   SETA  1
&INDX    SETA  &INDX+1
&SCNT    SETA  &SCNT+1
         AIF   (&SCNT GT &NSUBP).ERR2
         AGO   .FIXSTR
.VAR     ANOP
&SINDX   SETA  2
         DC    AL2(0)  INDICATE LENGTH PRECEDING STRING
.SETCNT  ANOP
&CNT     SETA  N'&SYSLIST(&INDX)
.LOOP2   ANOP
         AIF   (&SINDX GT &CNT).LONGVAR
&STL     SETA  K'&SYSLIST(&INDX,&SINDX)
&C       SETC '&SYSLIST(&INDX,&SINDX)'
         AIF   ('&C'(1,1) EQ '''').HYPH
         DC    AL1(&STL)                LENGTH OF FOLLOWING STRING
         DC    C'&SYSLIST(&INDX,&SINDX)'  TEXT STRING
         AGO   .SETIX
.HYPH    ANOP
&STL     SETA  &STL-2
         DC    AL1(&STL) LENGTH OF STRING FOLLOWING
         DC    C&SYSLIST(&INDX,&SINDX)  TEXT STRING
.SETIX   ANOP
&SINDX   SETA  &SINDX+1
         AGO   .LOOP2
.LONGVAR ANOP
&LOPCNT  SETA  &LOPCNT-1
         AIF   (&LOPCNT EQ 0).SETHIGH
&SINDX   SETA  1
&INDX    SETA  &INDX+1
&SCNT    SETA  &SCNT+1
         AIF   (&SCNT GT &NSUBP).ERR2
         AGO   .SETCNT
.SETHIGH ANOP
T&SYSNDX&OPIX EQU   *      END OF SUBFORMAT
&SINDX   SETA  1
&INDX    SETA  &INDX+1
&OPIX    SETA  &OPIX+1
&SCNT    SETA  &SCNT+1
         AGO   .LOOP1
.ALLEND  ANOP
T&SYSNDX.Z EQU   *
         MEXIT
.ERR1    MNOTE 8,'INVALID STRING FORMAT IN OPERAND &INDX'
         MEXIT
.ERR2    MNOTE 8,'REPEAT FACTOR FOR TABLE &LOPCNT TOO HIGH'
         MEND
./ ADD  NAME=DEFFCB
         MACRO
&XXX     DEFFCB &DEFAULT,&NAME=,&LINECNT=0,&CHAN=,&DEN=6,&FPTPOS=1
.*
.*
.*                 AUTHOR:  H. FRANZ   1973
.*
.*
         GBLB  &USE
         LCLA  &LEN,&TLEN,&CC,&I,&POS,&N
         LCLA  &CH
         LCLA  &M
         LCLA  &LN(180),&EIGHT
         LCLB  &DEFLT,&ERR
         LCLB  &CH1
         LCLC  &X
         LCLC  &CHC,&IC
&DEFLT   SETB  ('&DEFAULT' EQ 'D')
         AIF   (K'&NAME LE 4).TSTCNT
&ERR     SETB  1
         MNOTE 12,'*****  NAME LONGER THAN 4 CHARACTERS INVALID'
.TSTCNT  ANOP
&LEN     SETA  &LINECNT
         AIF   (&LEN GE 1).CNT1
&ERR     SETB  1
         MNOTE 12,'*****  LINE COUNT MUST BE SPECIFIED'
         AGO   .TSTCHAN
.CNT1    AIF   (&LEN LE 180).TSTCHAN
&ERR     SETB  1
         MNOTE 12,'*****  LINE COUNT MUST NOT EXCEED 180'
.TSTCHAN ANOP
         AIF   ('&CHAN' NE '').CHN1
&ERR     SETB  1
         MNOTE 12,'*****  CHANNEL DEFINITIONS MUST BE SPECIFIED'
         AGO   .DENS
.CHN1    ANOP
&CC      SETA  N'&CHAN
&POS     SETA  1
.TSTCH   ANOP
&X       SETC  '&CHAN(&POS)'
&N       SETA  1
         AIF   ('&X'(&N,1) NE '(').ONLY1
.ONLY1R  ANOP
&M       SETA  2
.GOON1   ANOP
&N       SETA  &N+1
         AIF   ('&X'(&N,1) EQ ',').SETCH
         AIF   (&N GT &M+2).CHERR
         AGO   .GOON1
.SETCH   ANOP
&CHC     SETC  '&X'(&M,&N-&M)
&CH      SETA  &CHC
         AIF   (&CH NE 1).NOTCH1
&CH1     SETB  1
.NOTCH1  ANOP
         AIF   (&CH GT 12 OR &CH LT 1).CHERR1
&M       SETA  &N+1
.GOON2   ANOP
&N       SETA  &N+1
          AIF   (&N GT &M+3).CHERR
         AIF   ('&X'(&N,1) EQ ')').SETL
         AGO   .GOON2
.SETL    ANOP
&IC      SETC  '&X'(&M,&N-&M)
&I       SETA  &IC
         AIF   (&I GT &LEN OR &I LT 1).CHERR2
         AIF   (&LN(&I) NE 0).DUPLCH
&LN(&I)  SETA  &CH
.COUNT   ANOP
&POS     SETA  &POS+1
         AIF   (&POS GT &CC).DENS
         AGO   .TSTCH
.CHERR1  ANOP
&ERR     SETB  1
    MNOTE 12,'*****  INVALID CHANNEL-NUMBER ''&CH'' IN CHAN.-DEF. &POS'
         AGO   .COUNT
.CHERR2  ANOP
&ERR     SETB  1
        MNOTE 12,'*****  INVALID LINE-NUMBER ''&I'' IN CHAN.-DEF. &POS'
         AGO   .COUNT
.CHERR   ANOP
&ERR     SETB  1
         MNOTE 12,'*****  ERROR IN CHANNEL SPECIFICATION &POS'
         AGO   .COUNT
.DUPLCH  ANOP
&ERR     SETB  1
         MNOTE 12,'***** DUPLICATE CHANNEL DEFINITION IN LINE &I'
         AGO   .COUNT
.ONLY1   ANOP
         AIF   (&POS GT 1).CHERR
         AIF   (&CC NE 2).CHERR
&CC      SETA  1
&X       SETC  '('.'&CHAN(1)'.','.'&CHAN(2)'.')'
         AGO   .ONLY1R
.EQC     MNOTE  12,'***** CHANNEL 1 MUST BE SPECIFIED'
&ERR     SETB  1
&CH1     SETB  1
         AGO   .TSTERR
.DENS    ANOP
         AIF   (NOT ('&DEN' EQ '6' OR '&DEN' EQ '8')).DENERR
         AIF   ('&DEN' EQ '6').PRTPOS
&EIGHT   SETA  1
         AGO   .PRTPOS
.DENERR  ANOP
&ERR     SETB  1
       MNOTE 12,'*****  DEN=&DEN IS INVALID, MUST BE 6 OR 8 LINES/INCH'
.PRTPOS  ANOP
&POS     SETA  &FPTPOS
         AIF   (&POS LE 31).POS1
&ERR     SETB  1
         MNOTE 12,'*****  FIRST PRINT-POSITION MUST BE LESS THAN 31'
         AGO   .TSTERR
.DUPLIC  MNOTE 12,'***** DUPLICATE USE OF MACRO NOT ALLOWED'
&ERR     SETB  1
         AGO   .TSTERR
.POS1    AIF   (&POS GT 1).POS2
&POS     SETA  0
.POS2    ANOP
.TSTERR  ANOP
         AIF   ( NOT &CH1).EQC
         AIF   (NOT &ERR).FCBGEN
         SPACE 3
         MNOTE *,'       GENERATION CANCELLED, DUE TO INDICATED ERRORS'
         MEXIT
.FCBGEN  ANOP
         AIF   (&USE).DUPLIC
&USE     SETB  1
         TITLE 'BASF FORMS CONTROL BUFFER FOR IBM-3211 - FCB2&NAME'
***********************************************************************
*
         MNOTE *,'          BASF FCB    &NAME'
*
***********************************************************************
         SPACE 1
***********************************************************************
*
*              (1)  MEMBER NAME
         MNOTE *,'           ''FCB2&NAME'''
*
*              (2)  IDENTIFICATION
         MNOTE *,'              ''&NAME'''
*
***********************************************************************
         SPACE 2
FCB2&NAME CSECT
***********************************************************************
*
         AIF   (&DEFLT).D
         DC    X'00'
*                                      THIS IS NOT A DEFAULT IMAGE
         AGO   .DEFLEN
.D       DC    X'80'
*                                      THIS IS A DEFAULT IMAGE
.DEFLEN  ANOP
*
***********************************************************************
         SPACE 2
&N       SETA  &LEN
&TLEN    SETA  ((&LEN+8)/8)*8
         AIF   (&POS EQ 0).DEFL
&LEN     SETA  &LEN+1
.DEFL    DC    AL1(&LEN)     LENGTH OF THE FCB-IMAGE
         AIF   (&POS EQ 0).SET3
         DC    AL1(128+&POS) INDEX BYTE
         MNOTE *,'                     FIRST PRINT POSITION IS &POS'
&POS     SETA  4
         AGO   .DEFC
.SET3    ANOP
&POS     SETA  3
.DEFC    ANOP
         SPACE 1
         DC    AL1(16*&EIGHT+&LN(1))
         MNOTE *,'           PRINT DENSITY IS &DEN LINES PER INCH'
         AIF   (&LN(1) EQ 0).NOCHL1
         MNOTE *,'           CHANNEL &LN(1) IS DEFINED IN LINE 1'
.NOCHL1  ANOP
&I       SETA  2
.TSTON   ANOP
&CC      SETA  0
.TSTLN   AIF   (&I+&CC EQ &N).ENDE
         AIF   (&LN(&I+&CC) NE 0).GEN
&CC      SETA  &CC+1
         AGO   .TSTLN
.GEN     AIF   (&CC EQ 0).GENCH
         DC    &CC.X'00'
         MNOTE *,'           &CC LINES NO CHANNEL DEFINITION'
.GENCH   ANOP
&POS     SETA  &POS+&CC+1
&I       SETA  &I+&CC
         DC    AL1(&LN(&I))
         MNOTE *,'              CHANNEL &LN(&I) IS DEFINED IN LINE &I'
&I       SETA  &I+1
         AGO   .TSTON
.ENDE    AIF   (&CC EQ 0).NOSPACE
         DC    &CC.X'00'
         MNOTE *,'           &CC LINES NO CHANNEL DEFINITION'
.NOSPACE ANOP
&POS     SETA  &POS+&CC+1
&I       SETA  &I+&CC
         AIF   (&LN(&I) EQ 0).LCHAN
         DC    AL1(16+&LN(&I)) DEFINITION OF THE LAST LINE
         MNOTE *,'    &I IS THE LAST LINE AND CONTAINS CHANNEL &LN(&I)'
         AGO   .TERM
.LCHAN   DC    AL1(16)       THIS IS THE LAST LINE
         MNOTE *,'         &I IS THE LAST LINE ON FORM WITH NO CHANNEL'
.TERM    ANOP
&CC      SETA  &TLEN-&POS
         AIF   (&CC EQ 0).FINI
         DC    &CC.X'00'      FILLERS UP TO NEXT DOUBLE-WORD BOUNDARY
.FINI    ANOP
         SPACE 1
***********************************************************************
***********************************************************************
         MEND
./ ADD  NAME=DEFSVC
         MACRO
         DEFSVC
SVC3     EQU   3
SVC32    EQU   32
SVC34    EQU   34
SVC35    EQU   35
SVC78    EQU   78
SVC83    EQU   83
SVC237   EQU   237
SVC238   EQU   238
SVC249   EQU   249
SVC250   EQU   250
SVC253   EQU   253
         MEND
./ ADD  NAME=DEUA
         MACRO
&NM      DEUA  &LOC
&NM      DC    X'12'         ERASE UNPROTECTED TO ADDRESS
         DLOC  &LOC
         MEND
./ ADD  NAME=DEVTAB
         MACRO
         DEVTAB
         EJECT
DEVICES  DSECT
*
*
*   THIS DUMMY SECTION DESCRIBES ONE ENTRY OF THE DEVICE-TABLE
*   USED IN SOME COST AND TPROC CALCULATING PROGRAMS.
*
*   THIS TABLE IS SEPARATLY ASSEMBLED AND LINKED UNDER THE NAME
*   DEVXX, WHERE XX REPRESENTS THE SMF-SYSTEM-ID (SID).
*
*
DEVCHNC  DS    A   CHAIN ADDRESS
DEVEXCPC DS    F   EXCP-COUNTERS ARE ACCUMULATED HERE
DEVBELC  DS    H   NUMBER OF DEVICES USED
DEVTYPE  DS    XL2  DEVICE-TYPE (LAST 2 BYTES FROM UCB)
*.                THE LAST ENTRY OF THE DEVTAB MUST CONTAIN A ZERO
*.                DEVICE-TYPE
DEVNAME  DS    CL4  DEVICE-NAME IN EBCDIC
DEVBELPR DS    F  PRICE FOR ONE HOUR USAGE IN PFENNIGEN.
DEVZF    DS    H  ACCESS-TIME FOR ONE EXCP IN MS.
DEVZGPR  DS    H  PRICE FOR ONE EXCP IN 1/1000 PFENNIGEN
DEVSWT   DS    X  SWITCH
DEVBLCLC EQU   X'80'  USAGE OF DEVICE WILL BE CHARGED
DEVPRINT EQU   X'20'   FOR IEFACTRT ONLY: DEVICE WILL APPEAR IN
*.                  THE PRICE/DEVICE-HEADER
DEVTEXT  DS    CL15  TEXT FOR USAGE-CHARGE LINE
DEVLEN   EQU   *-DEVICES  LENGTH OF ONE ENTRY
         EJECT
         MEND
./ ADD  NAME=DEZIMAL
         MACRO
&SYM     DEZIMAL &S,&T,&L
         LCLA  &LEN
         LCLC  &REG,&M
         AIF   ('&S' EQ '').NOSRC
         AIF   ('&T' EQ '').NOTGT
         AIF   ('&L' EQ '').NOLEN
&LEN     SETA  &L
         AGO   .LEN
.NOLEN   ANOP
&LEN     SETA  L'&T
.LEN     AIF   (&LEN GT 16).ERRL
         AIF   (&LEN LT 1).ERRL
&REG     SETC  '0'
         AIF   ('&S'(1,1) EQ '(').REGS
         AIF   (T'&S EQ 'F').WORD
         AIF   (T'&S EQ 'H').HWORD
         AIF   (T'&S EQ 'A').ERRS
         AIF   (L'&S EQ 4).WORD
         AIF   (L'&S EQ 2).HWORD
&SYM     DS    0H
         SR    0,0
         IC    0,&S
         AGO   .CVD
.HWORD   ANOP
&M       SETC  'H'
.WORD    ANOP
&SYM     DS    0H
         L&M   0,&S
         AGO   .CVD
.REGS    AIF   ('&S'(K'&S,1) NE ')').ERRS
&REG     SETC  '&S'(2,K'&S-2)
&SYM     DS    0H
.CVD     CVD   &REG,DW
         MVC   &T.(&LEN),MASK&LEN
         OI    DW+7,X'0F'
         ED    &T.(&LEN),DW+(8-(&LEN/2))
         MEXIT
.ERRL    MNOTE 8,'INVALID LEN FOR &T'
         MEXIT
.ERRS    MNOTE 8,'INCORRECT TYPE OR SYNTAX FOR &S'
         MEXIT
.NOTGT   MNOTE 8,'2ND OP REQUIRED'
         MEXIT
.NOSRC   MNOTE 8,'1ST OP REQUIRED'
         MEND
./ ADD  NAME=DFLIST
         MACRO
         DFLIST &TERMZHL=,&CU=,&ADR=
         LCLA  &ZAEHLER
&ZAEHLER SETA  1
         AIF   (&ZAEHLER EQ &TERMZHL).SPDONE1
         DC    AL1(&ZAEHLER)
.SPFRT1  ANOP
&ZAEHLER SETA  &ZAEHLER+1
&ADR&ZAEHLER EQU *
         DC    X'&CU'
         DC    AL1(&ZAEHLER+191)
         DC    AL1(&ZAEHLER+191)
         DC    X'2D'
         AIF   (&ZAEHLER EQ &TERMZHL).SPDONE1
         DC    AL1(&ZAEHLER)
         AGO   .SPFRT1
.SPDONE1 ANOP
         DC    AL1(128+&ZAEHLER)
         MEND
./ ADD  NAME=DFREE
         MACRO
&LAB     DFREE &ERROR=,&FILE=,&DA=,&MEMBER=,&DISP=,&HOLD=,&SYSOUT=
.**********************************************************************
.*                                                                    *
.*       DFREE - MACRO                                                *
.*                                                                    *
.*       LOEBER, W.      30.04.1976     GAD - MUENSTER                *
.*                                                                    *
.*             DISCRIPTION OF PARAMETERS                              *
.*  R E S T  -  F O L L O W S                                         *
.*                                                                    *
.**********************************************************************
         LCLA  &POI,&LGM,&IND1,&IND2,&TU,&TP
         LCLC  &C2,&C1,&DV
&C2      SETC  'GAD'.'&SYSNDX'
.*
.* FIRST CHECK OPERANDS AND COMPUTE LENGTH FOR WORK-AEREA
&LGM     SETA  24
&POI     SETA  24
         AIF   (T'&DA NE 'O' OR T'&FILE NE 'O').A1002
.A1001   ANOP
         MNOTE 04,'MISSING KEYWORD DA, FILE, OR ERROR'
         MEXIT
.*
.A1002   ANOP
         AIF   (T'&ERROR EQ 'O').A1001
.*
         AIF   (T'&DA EQ 'O').A1009
         AIF   (K'&DA LT 47).A1004
.A1003   ANOP
         MNOTE 04,'INCORRECT ''DA'' VALUE'
         MEXIT
.*
.A1004   ANOP
         AIF   (N'&DA NE 1).A1003
.*
.A1005   ANOP
         AIF   ('&DA'(1,1) NE '''').A1008
&IND1    SETA  2
&IND2    SETA  1
.A1006   ANOP
         AIF   ('&DA'(&IND1,1) NE '.').A1007
&IND2    SETA  1
&IND1    SETA  &IND1+1
         AGO   .A1006
.*
.A1007   ANOP
         AIF   ('&DA'(&IND1,1) EQ '''').A1008
         AIF   (&IND2 GT 8).A1003
&IND2    SETA  &IND2+1
&IND1    SETA  &IND1+1
         AGO   .A1006
.*
.A1008   ANOP
&LGM     SETA  &LGM+4+50
&POI     SETA  &POI+4
.A1009   ANOP
         AIF   (T'&FILE EQ 'O').A1013
         AIF   (K'&FILE LT 11).A1011
.A1010   ANOP
         MNOTE 04,'INCORRECT ''FILE'' VALUE'
         MEXIT
.*
.A1011   ANOP
         AIF   (N'&FILE GT 1).A1010
.*
.A1012   ANOP
&LGM     SETA  &LGM+4+14
&POI     SETA  &POI+4
.*
.A1013   ANOP
         AIF   (T'&MEMBER EQ 'O').A1016
         AIF   ('&MEMBER'(1,1) NE '''').A1015
         AIF   (K'&MEMBER LT 11).A1015
.*
.A1014   ANOP
         MNOTE 04,'INCORRECT ''MEMBER'' VALUE'
         MEXIT
.*
.A1015   ANOP
&LGM     SETA  &LGM+4+14
&POI     SETA  &POI+4
.*
.A1016   ANOP
         AIF   (T'&DISP EQ 'O').A1019
         AIF   ('&DISP'(1,1) NE '''').A1018
         AIF   ('&DISP'(2,7) NE 'UNCATLG' AND '&DISP'(2,5) NE 'CATLG' A*
               ND '&DISP'(2,6) NE 'DELETE' AND '&DISP'(2,4) NE 'KEEP').*
               A1017
         AGO   .A1018
.*
.A1017   ANOP
         MNOTE 04,'INCORRECT ''DISP'' VALUE'
         MEXIT
.*
.A1018   ANOP
&LGM     SETA  &LGM+4+7
&POI     SETA  &POI+4
.*
.A1019   ANOP
         AIF   (T'&HOLD EQ 'O').A1022
         AIF   ('&HOLD'(1,1) NE '''').A1021
         AIF   ('&HOLD'(2,3) NE 'YES' AND '&HOLD'(2,2) NE 'NO').A1020
         AGO   .A1021
.*
.A1020   ANOP
         MNOTE 04,'INCORRECT ''HOLD'' VALUE'
         MEXIT
.*
.A1021   ANOP
&LGM     SETA  &LGM+4+4
&POI     SETA  &POI+4+4
.*
.A1022   ANOP
         AIF   (T'&SYSOUT EQ 'O').B1000
         AIF   ('&SYSOUT'(1,1) NE '''').A1024
         AIF   (K'&SYSOUT LT 4).A1024
.*
.A1023   ANOP
         MNOTE 04,'INCORRECT ''SYSOUT'' VALUE'
         MEXIT
.*
.A1024   ANOP
&LGM     SETA  &LGM+4+7
&POI     SETA  &POI+4
.************************ READY ********************
.*
.************** NOW GENERATION *********************
.B1000   ANOP
&LGM     SETA  &LGM+8+8
&POI     SETA  &POI+4
.*  GENERATE MACRO-LABEL
         AIF   ('&LAB' EQ '').B1005
&LAB     DS    0H
.*
.B1005   ANOP
.*  G E N E R A T E  INSTRUCTIONS
         GETMAIN R,LV=&LGM
         LR    14,1
         LR    0,1
         LA    14,0(0,14)
         LA    1,&LGM.(,0)
         XR    15,15
         MVCL  0,14
.*
         LA    1,4(,14)
         ST    1,0(,14)
         MVC   4(2,14),=X'1402'
         LA    1,24(,14)
         ST    1,12(,14)
         MVI   0(14),X'80'
.* FILE
&C1      SETC  '(,14)'
&TP      SETA  24
&TU      SETA  &POI
         AIF   (T'&FILE EQ 'O').B1015
* FILE
         LA    1,&TU&C1
         ST    1,&TP&C1
&TP      SETA  &TP+4
         MVC   &TU.(4,14),=X'00010001'
&TU      SETA  &TU+4
         AIF   ('&FILE'(1,1) NE '''').B1010
&IND1    SETA  K'&FILE-2
         MVC   &TU.(2,14),=H'&IND1.'
         MVC   &TU.+2(&IND1.,14),=C&FILE
&TU      SETA  &TU+2+&IND1
         AGO   .B1015
.*
.B1010   ANOP
         MVC   &TU.(10,14),&FILE
&TU      SETA  &TU+10
.*
.B1015   ANOP
         AIF   (T'&DA EQ 'O').B1025
* DA
         LA    1,&TU&C1
         ST    1,&TP&C1
&TP      SETA  &TP+4
         MVC   &TU.(4,14),=X'00020001'
         AIF   ('&DA'(1,1) NE '''').B1020
&IND1    SETA  K'&DA-2
         MVC   &TU.(2,14),=H'&IND1.'
         MVC   &TU.+2(&IND1.,14),=C&DA
&TU      SETA  &TU+2+&IND1
         AGO   .B1025
.*
.B1020   ANOP
         MVC   &TU.(46,14),&DA
&TU      SETA  &TU+46
.*
.B1025   ANOP
         AIF   (T'&MEMBER EQ 'O').B1035
* MEMBER
         LA    1,&TU&C1
         ST    1,&TP&C1
&TP      SETA  &TP+4
         MVC   &TU.(4,14),=X'00030001'
&TU      SETA  &TU+4
         AIF   ('&MEMBER'(1,1) NE '''').B1030
&IND1    SETA  K'&MEMBER-2
         MVC   &TU.(2,14),=H'&IND1.'
         MVC   &TU.+2(&IND1.,14),=C&MEMBER
&TU      SETA  &TU+2+&IND1
         AGO   .B1035
.*
.B1030   ANOP
         MVC   &TU.(10,14),&MEMBER
&TU      SETA  &TU+10
.*
.B1035   ANOP
         AIF   (T'&DISP EQ 'O').B1050
* DISP
         LA    1,&TU&C1
         ST    1,&TP&C1
&TP      SETA  &TP+4
         MVC   &TU.(6,14),=X'000500010001'
&TU      SETA  &TU+6
         AIF   ('&DISP'(1,1) NE '''').B1045
&DV      SETC  'X''01'''
         AIF   ('&DISP'(2,7) EQ 'UNCATLG').B1040
&DV      SETC  'X''02'''
         AIF   ('&DISP'(2,5) EQ 'CATLG').B1040
&DV      SETC  'X''04'''
         AIF   ('&DISP'(2,6) EQ 'DELETE').B1040
&DV      SETC  'X''08'''
.*
.B1040   ANOP
         MVI   &TU.(14),&DV
&TU      SETA  &TU+1
         AGO   .B1050
.*
.B1045   ANOP
         MVC   &TU.(1,14),&DISP
&TU      SETA  &TU+1
.*
.B1050   ANOP
         AIF   (T'&SYSOUT EQ 'O').B1060
* SYSOUT
         LA    1,&TU&C1
         ST    1,&TP&C1
&TP      SETA  &TP+4
         MVC   &TU.(6,14),=X'001800010001'
&TU      SETA  &TU+6
         AIF   ('&SYSOUT'(1,1) NE '''').B1055
         MVI   &TU.(14),C&SYSOUT
&TU      SETA  &TU+1
         AGO   .B1060
.*
.B1055   ANOP
         MVC   &TU.(1,14),&SYSOUT
&TU      SETA  &TU+1
.*
.B1060   ANOP
         AIF   (T'&HOLD EQ 'O').C0000
* HOLD
         LA    1,&TU&C1
         ST    1,&TP&C1
&TP      SETA  &TP+4
         AIF   ('&HOLD'(1,1) NE '''').B1070
&DV      SETC  'X''000A0000'''
         AIF   ('&HOLD'(2,2) EQ 'NO').B1065
&DV      SETC  'X''00590000'''
.*
.B1065   ANOP
         MVC   &TU.(4,14),&DV
&TU      SETA  &TU+4
         AGO   .C0000
.*
.B1070   ANOP
         MVC   &TU.(4,14),&HOLD
&TU      SETA  &TU+4
.*******
.C0000   ANOP
*
         LA    1,&TU&C1
         ST    1,&TP&C1
         MVC   &TU.(4,14),=X'00070000'
*
         MVI   &TP.(14),X'80'
* SVC 99
         LR    1,14
         SVC   99
* ERROR-CODES
         XC    &ERROR.(4),&ERROR
         LH    1,8(,14)
         STCM  1,3,&ERROR
         LH    1,10(,14)
         STCM  1,3,&ERROR.+2
* FREEMAIN
         LA    1,&LGM.(,0)
         LTR   15,15
         BNZ   &C2.E
         FREEMAIN R,LV=&LGM.,A=(14)
&C2.E    DS    0H
         MEXIT
         MEND
./ ADD  NAME=DIC
         MACRO
&NM      DIC
&NM      DC    X'13'         INSERT CURSOR
         MEND
./ ADD  NAME=DLOC
         MACRO
&NM      DLOC  &LOC
         GBLA  &MOD
         LCLA  &ROW,&COL,&POS,&POS2
         LCLA  &T1,&T2
         LCLC  &TAB(64)
         AIF   (N'&LOC NE 2).ERR2
&T1      SETA  &LOC(1)
&T2      SETA  &LOC(2)
         AIF   (&T1 LT 1 OR &T1 GT 24).ERR
         AIF   (&T2 LT 1 OR &T2 GT 80).ERR
         AIF   (&MOD NE 40 AND &MOD NE 80).ERR3
         AIF   (&MOD EQ 80).SETAB
         AIF   (&T1 GT 12 OR &T2 GT 40).ERR
.SETAB   ANOP
&TAB(01) SETC  '40'
&TAB(02) SETC  'C1'
&TAB(03) SETC  'C2'
&TAB(04) SETC  'C3'
&TAB(05) SETC  'C4'
&TAB(06) SETC  'C5'
&TAB(07) SETC  'C6'
&TAB(08) SETC  'C7'
&TAB(09) SETC  'C8'
&TAB(10) SETC  'C9'
&TAB(11) SETC  '4A'
&TAB(12) SETC  '4B'
&TAB(13) SETC  '4C'
&TAB(14) SETC  '4D'
&TAB(15) SETC  '4E'
&TAB(16) SETC  '4F'
&TAB(17) SETC  '50'
&TAB(18) SETC  'D1'
&TAB(19) SETC  'D2'
&TAB(20) SETC  'D3'
&TAB(21) SETC  'D4'
&TAB(22) SETC  'D5'
&TAB(23) SETC  'D6'
&TAB(24) SETC  'D7'
&TAB(25) SETC  'D8'
&TAB(26) SETC  'D9'
&TAB(27) SETC  '5A'
&TAB(28) SETC  '5B'
&TAB(29) SETC  '5C'
&TAB(30) SETC  '5D'
&TAB(31) SETC  '5E'
&TAB(32) SETC  '5F'
&TAB(33) SETC  '60'
&TAB(34) SETC  '61'
&TAB(35) SETC  'E2'
&TAB(36) SETC  'E3'
&TAB(37) SETC  'E4'
&TAB(38) SETC  'E5'
&TAB(39) SETC  'E6'
&TAB(40) SETC  'E7'
&TAB(41) SETC  'E8'
&TAB(42) SETC  'E9'
&TAB(43) SETC  '6A'
&TAB(44) SETC  '6B'
&TAB(45) SETC  '6C'
&TAB(46) SETC  '6D'
&TAB(47) SETC  '6E'
&TAB(48) SETC  '6F'
&TAB(49) SETC  'F0'
&TAB(50) SETC  'F1'
&TAB(51) SETC  'F2'
&TAB(52) SETC  'F3'
&TAB(53) SETC  'F4'
&TAB(54) SETC  'F5'
&TAB(55) SETC  'F6'
&TAB(56) SETC  'F7'
&TAB(57) SETC  'F8'
&TAB(58) SETC  'F9'
&TAB(59) SETC  '7A'
&TAB(60) SETC  '7B'
&TAB(61) SETC  '7C'
&TAB(62) SETC  '7D'
&TAB(63) SETC  '7E'
&TAB(64) SETC  '7F'
&POS     SETA  (&LOC(1)-1)*&MOD+&LOC(2)-1
&POS2    SETA  &POS
&POS     SETA  &POS/64
&ROW     SETA  &POS+1
&COL     SETA  &POS2-&POS*64+1
&NM      DC    X'&TAB(&ROW)&TAB(&COL)' 3270 INTERNAL BUFFER ADDRESS
         MEXIT
.ERR     MNOTE 8,'INCORRECT BUFFER ADDRESS SPECIFIED'
         MEXIT
.ERR2    MNOTE 8,'INCORRECT FORM OF BUFFER ADDRESS SPECIFICATION'
         MEXIT
.ERR3    MNOTE 4,'MODEL NOT SET, 2 ASSUMED'
&MOD     SETA  80
         AGO   .SETAB
.END     ANOP
         MEND
./ ADD  NAME=DMAP
         MACRO
&NAME    DMAP  &E,&ADD=,&OFFSET=,&MAXL=,&JUST=LEFT,&TRANS=NO
         LCLA  &OFF,&IND,&R,&TRA
         AIF   (T'&ADD EQ 'O').ERR2
         AIF   (T'&OFFSET EQ 'O').ERR3
         AIF   (T'&MAXL EQ 'O').ERR4
         AIF   ('&JUST' NE 'RIGHT' AND '&JUST' NE 'LEFT').ERR5
         AIF   ('&TRANS' NE 'YES' AND '&TRANS' NE 'NO').ERR6
&OFF     SETA  &OFFSET-1
&R       SETA  2
&TRA     SETA  1
         DS    0H            PROVIDE HALFWORD BOUNDARY
&NAME    DLOC  &ADD
         DC    H'&OFF'       RELATIVE OFFSET IN TARGET BUFFER
         DC    AL1(&MAXL)    MAX FIELD LENGTH
         AIF   ('&JUST' EQ 'LEFT').ISTRA
&IND     SETA  &IND+&R
         AGO   .NEXT
.ISTRA   AIF   ('&TRANS' EQ 'NO').NEXT
&IND     SETA  &IND+&TRA
.NEXT    ANOP
         DC    X'&IND'       OPTION INDICATOR
         AIF   (T'&E EQ 'O').END
         AIF   ('&E' NE 'E').ERR1
         DC    X'FF'         END OF LIST INDICATOR
         AGO   .END
.ERR1    ANOP
         MNOTE 8,'UNKNOWN OPERAND'
         MEXIT
.ERR2    ANOP
         MNOTE 8,'ADD - PARAMETER MISSING'
         MEXIT
.ERR3    ANOP
         MNOTE 8,'OFFSET - PARAMETER MISSING'
         MEXIT
.ERR4    ANOP
         MNOTE 8,'MAXL - PARAMETER MISSING'
         MEXIT
.ERR5    ANOP
         MNOTE 8,'JUST - PARAMETER INVALID'
         MEXIT
.ERR6    ANOP
         MNOTE 8,'TRANS - PARAMETER INVALID'
         MEXIT
.END     ANOP
         MEND
./ ADD  NAME=DMBHW
         MACRO
&NM      DMBHW &TYPE=DEF,&D=DM
         LCLC  &N
&N       SETC  '&NM'
         AIF   ('&TYPE' NE 'DSECT').DEF
&N       DSECT
&N       SETC  ' '
.DEF     ANOP
         SPACE 3
*        DEFINITION DES BEARBEITUNGS-HINWEIS-SATZES
*           AUF DER DRUCKMANAGEMENT-DATEI
*
&N       DS    0D
&D.BHW    EQU   *
*
&D.BHWKEY DS    0CL10' '       KEY
&D.BHWK0  DC    CL4'#BHW'      FIX PART OF KEY
&D.BHW#   DC    CL2' '         BEARBEITUNGS-HW NUMMER
&D.BHWK4  DC    CL4' '         SPACE
&D.BHWMOD DC    XL4'00'        KEY MODIFYER
*
&D.BHWTX  DC    CL72' '        BEARBEITUNGS-HW TEXT
          DC    CL4' '         FREE SPACE
*
&D.BHWDAT DC    CL10' '        DATUM VON LETZTEM UPDATE
&D.BHWPRG DC    CL8' '         JOBNAME VON UPDATE-PROGRAMM
          DC    CL12' '        FREE SPACE
*
&D.BHWLG  EQU   *-&D.BHW       LGTH OF BHW-RECORD
*
         MEND
./ ADD  NAME=DMCHKREC
         MACRO
&NM      DMCHKREC &TYPE=DEF,&D=DM
         LCLC  &N
&N       SETC  '&NM'
         AIF   ('&TYPE' NE 'DSECT').DEF
&N       DSECT
&N       SETC  ' '
.DEF     ANOP
         SPACE 3
***************************************************************
*
*          CHECKPOINT RECORD FUER 'BASFPRT'
*
***************************************************************
&D.CHKPTR EQU  *
&D.CHKPRT DS    CL3       DRUCKER ADRESSE
&D.CHKFIL DS    CL7       FILLER 1 (BLANKS)
&D.CHKFL2 DS    CL4       FILLER 2 (HEX '00')
&D.CHKHDR DS    CL4       HEADER DER LIST#-TABELLE
         SPACE
&D.CHKL#  DS    20CL10    ZUR VERARBEITUNG ANSTEHENDE LISTEN-#
&D.CHKL#P DS    CL10      LIST# DIE GERADE DRUCKT
         SPACE
&D.CHKSMF DS    CL(&D.SMFLEN) SMFINFO FOR RESTART
&D.CHKINT DS    CL(&D.INTLG)
&D.CHKSTM DS    CL8       TIMESTAMP DRUCK BEGINN
&D.CHKCTM DS    CL8       TIMESTAMP LETZTER CHECKPOINT
         DS    0D
&D.CHKLEN EQU  *-&D.CHKPTR
         MEND
./ ADD  NAME=DMOD
         MACRO
         DMOD  &MODEL=2
         GBLA  &MOD
         AIF   ('&MODEL' NE '1' AND '&MODEL' NE '2').ERR3
         AIF   ('&MODEL' EQ '2').MODL2
.MODL1   ANOP
&MOD     SETA  40
         MEXIT
.MODL2   ANOP
&MOD     SETA  80
         MEXIT
.ERR3    MNOTE 8,'INVALID MODEL, "1" OR "2" ALLOWED'
.END     ANOP
         MEND
./ ADD  NAME=DMRECOLD
         MACRO
&NM      DMRECORD &TYPE=DEF,&D=DM
         LCLC  &N
&N       SETC  '&NM'
         AIF   ('&TYPE' NE 'DSECT').DEF
&N       DSECT
&N       SETC  ' '
.DEF     ANOP
         SPACE 3
*        DEFINITION DES LISTSATZES AUF DER DRUCK-MANAGEMENT DATEI
*
&N       DS    0D
&D.RECORD EQU   *
*
*                  DIESE INFORMATION KOMMT AUS DER EMIS-DATENBANK
*
&D.EMIS   EQU   *
&D.LIST#  DC    CL10' '        LISTEN NUMMER
&D.KEYMOD DC    XL4'0'         KEY MODIFIER
&D.ABLS   DC    CL8' '         ABLAUFSEITE
&D.ARB#   DC    CL4' '         ARBEITSNUMMER DES DRUCKABLAUFS
&D.FORM   DC    CL4' '         PAPIER-FORMULAR-NUMMER
&D.MULTNM DC    CL8' '         MULTNAME DER DRUCKARBEIT
&D.EMPF   DS    0CL71
&D.EMPF#  DC    CL3' '         SB# DES EMPFAENGERS
&D.EMPFNM DC    CL40' '        NAME DES EMPFAENGERS
&D.EMPFB  DC    CL4' '         BAU DES EMPF.
&D.EMPFZ  DC    CL4' '         ZIMMER # DES EMPF.
&D.EMPFOR DC    CL12' '        ORG. EINHEIT DES EMPF.
&D.EMPFTL DC    CL8' '         TEL-NR DES EMPF
&D.PROG   DS    0CL71
&D.PROG#  DC    CL3' '         SB# DES PROGRAMMIERERS
&D.PROGNM DC    CL40' '        NAME DES PROG
&D.PROGB  DC    CL4' '         BAU DES PROG
&D.PROGZ  DC    CL4' '         ZIMMER # DES PROG
&D.PROGOR DC    CL12' '        ORG. EINHEIT DES PROG
&D.PROGTL DC    CL8' '         TEL-NR DES PROG
&D.COM    DC    CL8' '         COM-NR DIESER LISTE
&D.BEARTX DC    CL72' '        BEARBEITUNGS-TEXT
&D.LISTBZ DC    CL80' '        TEXT DER LISTENBEZEICHNUNG
&D.LIST#O DC    CL06' '        ALTE LISTEN NUMMER
&D.TERMIN DC    CL08' '        TERMIN AUS EMIS (ABLIEFERUNG)
         DC    CL06' '        FREE SPACE
&D.EMISLG EQU   *-&D.EMIS       LENGTH OF EMIS PORTION
         SPACE 3
*
*                  DIESE INFORMATION KOMMT AUS DER OP-DATEI
*
&D.OP     EQU   *
&D.DSN    DC    CL44' '        DSNAME DER DRUCKDATEI
&D.DRHW   DC    CL35' '        DRUCKHINWEIS (ANMERKUNG)
&D.DRART  DC    CL5' '         DRUCKART
&D.SKZ    DC    CL1' '         SONDER-KENNZEICHEN
&D.BURST  DC    CL1' '         3800 BURST PARAMETER
&D.OPTCD  DC    CL1' '         OPTION-CODE FUER DIESE LISTE
&D.FCB    DC    CL4' '         FCB FUER DIESE LISTE
&D.UCS    DC    CL4' '         UCS FUER DIESE LISTE
&D.FLASH  DC    CL4' '         3800-MASKE FUER DIESE LISTE
&D.PARM   DC    CL5' '         PARAMETER FUER DRUCKPROGRAMM
&D.KZ3800 DC    CL1' '         KZ FUER DRUCKBARKEIT AUF 3800
&D.INDEV  DC    CL4' '         DATENTRAEGER
         DC    CL2' '         FREE SPACE
*
*                 JCL-PARAMETER
*
&D.CH0    DC    CL4' '         CHARACTER-SETS
&D.CH1    DC    CL4' '         FUER DIESE LISTE
&D.CH2    DC    CL4' '
&D.CH3    DC    CL4' '
&D.MOD    DC    CL4' '         MODIFY PARAMETER
&D.MODCNT DC    X'00'          MODIFY NUMMER
&D.COPY   DC    X'00'          COPIES-PARAMETER
&D.COPGR0 DC    X'00'          GROUP-PARAMETER
&D.COPGR1 DC    X'00'          FUER 3800
&D.COPGR2 DC    X'00'          (SUB-PARAMETER DES
&D.COPGR3 DC    X'00'          COPIES-PARAMETER)
&D.COPGR4 DC    X'00'
&D.COPGR5 DC    X'00'
&D.COPGR6 DC    X'00'
&D.COPGR7 DC    X'00'
&D.FLCNT  DC    X'00'          FLASH COUNT
         SPACE 3
*
*                  DIESE INFORMATION KOMMT AUS RZ.RZGEN..A
*
&D.DIN    DC    CL3' '         PAPIER-FORMAT
&D.SATZ   DC    XL1'0'         ANZAHL DURCHSCHLAEGE (PAPIER-SATZ)
         SPACE 3
&D.CNGDAT DC    CL10' '        TAG DER LETZTEN AENDERUNG
&D.CNGPRG DC    CL8' '         AENDERUNGS-PROGRAMM/JOB/UID
         SPACE 3
&D.OPLG   EQU   *-&D.OP         LENGTH OF OP PORTION
         SPACE 3
*
*                  DIESE FELDER WERDEN VOM PROGRAMM OP023 INITIALISIERT
*
&D.OP23   EQU   *
&D.BERZ   DC    CL8' '         BERICHTSZEIT
&D.ERSTTG DC    CL10' '        ERSTELLUNGSTAG (TAG DES PROGRAMM-LAUFS)
&D.ERSTTM DC    CL8' '         ERSTELLUNGSUHRZEIT
&D.VOLCNT DC    XL2'0'         ANZAHL VOLUMES DER DRUCKDATEI
&D.VOLSER DC    5CL6' '        DIE ERSTEN 5 VOLSER NUMMERN
&D.DEVTYP DC    CL6' '         DEVICE TYP DER DRUCK-DATEI
&D.LKZ    DC    CL1' '         LAUFKENNZIFFER
&D.PAGES  DC    XL4'FFFFFFFF'  ANZAHL SEITEN DIESER LISTE
         DC    CL4' '         FREE SPACE
&D.OP23LG EQU   *-&D.OP23       LENGTH OF OP023 PORTION
         SPACE 3
*
*                  DIESE FELDER FUELLT DAS DRUCKPROGRAMM BASFPRT
*
&D.PRT    EQU   *
&D.OPER#  DC    CL3' '         SB# DES DRUCKER-OPERATORS BEIM AUFSETZEN
&D.OPER#F DC    CL3' '         SB# DES DRUCKER-OPERATORS BEI DRUCKENDE
&D.PRTBTG DC    CL10' '        TAG DES DRUCKBEGINNS
&D.PRTBTM DC    CL8' '         UHRZEIT DES DRUCKBEGINNS
&D.PRTETG DC    CL10' '        TAG DES DRUCKENDES
&D.PRTETM DC    CL8' '         UHRZEIT DRUCK-ENDE
&D.ERLTG  DC    CL10' '        TAG DER ERLEDIGUNG (AUSGANG AUS RZ
&D.ERLTM  DC    CL8' '         UHRZEIT DER ERLEDIGUNG
&D.DDNAME DC    CL8' '         DDNAME, VERGEBEN DURCH PRTALLOC
&D.OUTCUA DC    CL3' '         DRUCKERADRESSE
         SPACE 1
&D.DCBADR DC    F'0'           DCB-ADRESSE NACH OPEN DURCH PRTALLOC
&D.BLKCNT DC    F'0'           BLOCK COUNT AUF DIESEM VOLUME
&D.CURVOL DC    F'0'           VOLUME COUNT
&D.INPCNT DC    F'0'           INPUT EXCP COUNT
&D.PGECNT DC    F'0'           PAGECOUNT
&D.OUTCNT DC    F'0'           OUTPUT EXCP COUNT
&D.CNTCNT DC    F'0'           CHECKPOINT EXCP COUNT
&D.CRDCNT DC    F'0'           WTOR COUNT
&D.CPUTIM DC    F'0'           CPUTIME FUER DIESE LISTE
&D.CURCOP DC    F'0'           ANZ ERLEDIGTER KOPIEN
&D.COPY#  DC    F'0'           ANZ NOCH ZU DRUCKENDER KOPIEN
&D.RECFM  DC    X'00'          RECFM OF PRINT-DS
&D.FLAG   DC    X'00'          PASSWORD AND RESTART FLAG
&D.FLPW   EQU   X'80'          PASSWORD REQUIRED
&D.FLRS   EQU   X'40'          RESTART REQUIRED
&D.FLATT  EQU   X'03'          PASSWORD ATTEMPTS
&D.LRECL  DC    XL2'0000'      LRECL OF PRINT-DS
&D.BLKS   DC    XL2'0000'      BLOCKSIZE OF PRINT-DS
         DC    XL2'0000'      FREE SPACE
         SPACE 3
&D.PRTLG  EQU   *-&D.PRT        LENGTH OF PRT PORTION
         DS    0D
&D.SMFLEN EQU   *-&D.BLKCNT          LENGTH OF SMF PORTION
&D.RECLEN EQU   *-&D.RECORD
         SPACE 3
*
*        DIESE FELDER BENOETIGT DAS DRUCKPROGRAMM BASFPRT INTERN
*
&D.INTERN EQU   *
&D.PSW    DC    CL20' '        PASSWORD FUER DIESE LISTE
&D.SMFTM  DC    XL8'0'         TIMESTAMP DRUCK BEGINN
&D.CHKTM  DC    XL8'0'         TIMESTAMP LETZTER CHECK POINT
&D.CURRPG DC    F'0'           CURRENT PAGE NUMBER
&D.EMPFTB DC    F'0'           ADDRESS OF AREA FUER SONDERVERTEILER
&D.ETBLEN DC    F'0'           AREA-LENGTH
&D.ETBENT DC    H'0'           NUMBER OF TABLE-ENTRIES (SVT)
&D.LBSENT DC    F'0'           CURRENT ENTRY IN SVT-TAB
&D.LBSCPY DC    F'0'           CURRENT COPY FOR THIS EMPFAENGER
&D.INTLG  EQU   *-&D.INTERN
&D.LENGTH EQU   *-&D.RECORD
         SPACE 3
***************************************************************
         MEND
./ ADD  NAME=DMRECORD
** TITLE   SATZBESCHREIBUNG DM-DATEI OPV.OP02201A
** OWNER   128.FRANZ
** LCHNG   05/26/84 10:00:00   Z227128 FRANZ
         MACRO
&NM      DMRECORD &TYPE=DEF,&D=DM
         LCLC  &N
&N       SETC  '&NM'
         AIF   ('&TYPE' NE 'DSECT').DEF
&N       DSECT
&N       SETC  ' '
.DEF     ANOP
         SPACE 3
*        DEFINITION DES LISTSATZES AUF DER DRUCK-MANAGEMENT DATEI
*
&N       DS    0D
&D.RECORD EQU   *
*
*                  DIESE INFORMATION KOMMT AUS DER EMIS-DATENBANK
*
&D.EMIS   EQU   *
&D.LIST#  DC    CL10' '        LISTEN NUMMER
&D.KEYMOD DC    XL4'0'         KEY MODIFIER
&D.FORM   DC    CL4' '         PAPIER-FORMULAR-NUMMER
&D.EIN    DC    CL8' '         PROGRAMM-EINSATZ
&D.ABLS   DC    CL8' '         ABLAUFSEITE
&D.ARB#   DC    CL4' '         ARBEITSNUMMER
&D.MULTNM DC    CL8' '         MULTNAME DER DRUCKDATEI
&D.MLTABL DC    CL8' '         ABLAUFSEITE DES MULTS
&D.LTERM  DC    CL8' '         TERMIN DER LISTE
&D.COM    DC    CL8' '         COM-NR DIESER LISTE
&D.COMABL DC    CL8' '         ABLAUFSEITE VON COM
&D.CTERM  DC    CL8' '         TERMIN DER MICRO-FICHE
&D.ETANZ  DC    XL2'00'        ANZAHL ETIKETTEN FUER FICHE
&D.EMPF   DS    0CL71
&D.EMPF#  DC    CL3' '         SB# DES EMPFAENGERS
&D.EMPFNM DC    CL40' '        NAME DES EMPFAENGERS
&D.EMPFB  DC    CL4' '         BAU DES EMPF.
&D.EMPFZ  DC    CL4' '         ZIMMER # DES EMPF.
&D.EMPFOR DC    CL12' '        ORG. EINHEIT DES EMPF.
&D.EMPFTL DC    CL8' '         TEL-NR DES EMPF
&D.PROG   DS    0CL71
&D.PROG#  DC    CL3' '         SB# DES PROGRAMMIERERS
&D.PROGNM DC    CL40' '        NAME DES PROG
&D.PROGB  DC    CL4' '         BAU DES PROG
&D.PROGZ  DC    CL4' '         ZIMMER # DES PROG
&D.PROGOR DC    CL12' '        ORG. EINHEIT DES PROG
&D.PROGTL DC    CL8' '         TEL-NR DES PROG
&D.BRBHW  DS    0CL74
&D.BEAR#  DC    CL2' '         BEARBEITUNGS-HW-NUMMER
&D.BEARTX DC    CL72' '        BEARBEITUNGS-TEXT
&D.EMPFEX DC    CL1' '         EXEMPLAR-#
&D.EMPFAA DC    XL2'00'        ANZAHL EXEMPLARE
&D.EMPFS  DC    CL1' '         SCHLUESSEL F. ORIGINAL-MICRO-F
&D.EMPFF  DC    CL1' '         FACH-KZ
&D.LISTBZ DC    CL80' '        TEXT DER LISTENBEZEICHNUNG
&D.RMTKZ  DC    C' '           REMOTE-KZ (LISTE NICHT IN RZ GEDR)
&D.EMPORT DC    CL10' '        ORT DES EMPFAENGER-BAUS
          DC    CL05' '        FREE SPACE
&D.EMISLG EQU   *-&D.EMIS       LENGTH OF EMIS PORTION
         SPACE 3
*
*
*
&D.OP     EQU   *
&D.DSNEM  DC    CL44' '        DSNAME DER DRUCKDATEI AUS EMIS
&D.DRHW   DC    CL35' '        DRUCKHINWEIS (ANMERKUNG)
&D.DRART  DC    CL5' '         DRUCKART
&D.SKZ    DC    CL1' '         SONDER-KENNZEICHEN
&D.BURST  DC    CL1' '         3800 BURST PARAMETER
&D.OPTCD  DC    CL1' '         OPTION-CODE FUER DIESE LISTE
&D.FCB    DC    CL4' '         FCB FUER DIESE LISTE
&D.UCS    DC    CL4' '         UCS FUER DIESE LISTE
&D.FLASH  DC    CL4' '         3800-MASKE FUER DIESE LISTE
&D.PARM   DC    CL5' '         PARAMETER FUER DRUCKPROGRAMM
&D.KZ3800 DC    CL1' '         KZ FUER DRUCKBARKEIT AUF 3800
&D.INDEV  DC    CL4' '         DATENTRAEGER
          DC    CL12' '        FREE SPACE
*
*                 JCL-PARAMETER
*
&D.CH0    DC    CL4' '         CHARACTER-SETS
&D.CH1    DC    CL4' '         FUER DIESE LISTE
&D.CH2    DC    CL4' '
&D.CH3    DC    CL4' '
&D.MOD    DC    CL4' '         MODIFY PARAMETER
&D.MODCNT DC    X'00'          MODIFY NUMMER
&D.COPY   DC    X'00'          COPIES-PARAMETER
&D.COPGR0 DC    X'00'          GROUP-PARAMETER
&D.COPGR1 DC    X'00'          FUER 3800
&D.COPGR2 DC    X'00'          (SUB-PARAMETER DES
&D.COPGR3 DC    X'00'          COPIES-PARAMETER)
&D.COPGR4 DC    X'00'
&D.COPGR5 DC    X'00'
&D.COPGR6 DC    X'00'
&D.COPGR7 DC    X'00'
&D.FLCNT  DC    X'00'          FLASH COUNT
         SPACE 3
*
*                  DIESE INFORMATION KOMMT AUS RZ.RZGEN..A
*
&D.DIN    DC    CL3' '         PAPIER-FORMAT
&D.SATZ   DC    XL1'0'         ANZAHL DURCHSCHLAEGE (PAPIER-SATZ)
         SPACE 3
&D.CNGDAT DC    CL10' '        TAG DER LETZTEN AENDERUNG
&D.CNGPRG DC    CL8' '         AENDERUNGS-PROGRAMM/JOB/UID
         SPACE 3
&D.OPLG   EQU   *-&D.OP         LENGTH OF OP PORTION
         SPACE 3
*
*                  DIESE FELDER WERDEN VOM PROGRAMM OP023 INITIALISIERT
*
&D.OP23   EQU   *
&D.BERZ   DC    CL8' '         BERICHTSZEIT
&D.ERSTTG DC    CL10' '        ERSTELLUNGSTAG (TAG DES PROGRAMM-LAUFS)
&D.ERSTTM DC    CL8' '         ERSTELLUNGSUHRZEIT
&D.DSN    DC    CL44' '        AKTUELLER DSN DER DRUCKDATEI
&D.VOLCNT DC    XL2'0'         ANZAHL VOLUMES DER DRUCKDATEI
&D.VOLSER DC    5CL6' '        DIE ERSTEN 5 VOLSER NUMMERN
&D.DEVTYP DC    CL6' '         DEVICE TYP DER DRUCK-DATEI
&D.LKZ    DC    CL1' '         LAUFKENNZIFFER
&D.PAGES  DC    XL4'FFFFFFFF'  ANZAHL SEITEN DIESER LISTE
&D.PACK#  DC    XL2'0'         ANZAHL LISTEN-STAPEL
&D.LFD#  DC        XL4'00'   LAUFENDE NUMMER LBS
          DC    CL06' '        FREE SPACE
&D.OP23LG EQU   *-&D.OP23       LENGTH OF OP023 PORTION
         SPACE 3
*
*                  DIESE FELDER FUELLT DAS DRUCKPROGRAMM BASFPRT
*
&D.PRT    EQU   *
&D.OPER#  DC    CL3' '         SB# DES DRUCKER-OPERATORS BEIM AUFSETZEN
&D.OPER#F DC    CL3' '         SB# DES DRUCKER-OPERATORS BEI DRUCKENDE
&D.PRTBTG DC    CL10' '        TAG DES DRUCKBEGINNS
&D.PRTBTM DC    CL8' '         UHRZEIT DES DRUCKBEGINNS
&D.PRTETG DC    CL10' '        TAG DES DRUCKENDES
&D.PRTETM DC    CL8' '         UHRZEIT DRUCK-ENDE
&D.ERLTG  DC    CL10' '        TAG DER ERLEDIGUNG (AUSGANG AUS RZ
&D.ERLTM  DC    CL8' '         UHRZEIT DER ERLEDIGUNG
&D.DDNAME DC    CL8' '         DDNAME, VERGEBEN DURCH PRTALLOC
&D.OUTCUA DC    CL3' '         DRUCKERADRESSE
         SPACE 1
&D.DCBADR DC    F'0'           DCB-ADRESSE NACH OPEN DURCH PRTALLOC
&D.BLKCNT DC    F'0'           BLOCK COUNT AUF DIESEM VOLUME
&D.CURVOL DC    F'0'           VOLUME COUNT
&D.INPCNT DC    F'0'           INPUT EXCP COUNT
&D.PGECNT DC    F'0'           PAGECOUNT
&D.OUTCNT DC    F'0'           OUTPUT EXCP COUNT
&D.CNTCNT DC    F'0'           CHECKPOINT EXCP COUNT
&D.CRDCNT DC    F'0'           WTOR COUNT
&D.CPUTIM DC    F'0'           CPUTIME FUER DIESE LISTE
&D.CURCOP DC    F'0'           ANZ ERLEDIGTER KOPIEN
&D.COPY#  DC    F'0'           ANZ NOCH ZU DRUCKENDER KOPIEN
&D.DCBI   DS    0CL6           DCBINFO
&D.RECFM  DC    X'00'          RECFM OF PRINT-DS
&D.FLAG   DC    X'00'          PASSWORD FLAG
&D.FLPW   EQU   X'80'          PASSWORD REQUIRED
&D.FLRS   EQU   X'40'          RESTART REQUIRED
&D.FLLB   EQU   X'20'          LISTENBEGLEITSCHEIN REQUIRED
&D.FLVSP  EQU   X'10'          DRUCK-VORSPANN REQUIRED
&D.FLEOD  EQU   X'08'          EODAD ON INPUT FILE (FOR SVT)
&D.FLATT  EQU   X'03'          PASWORD ATTEMPTS
&D.LRECL  DC    XL2'0000'      LRECL OF PRINT-DS
&D.BLKS   DC    XL2'0000'      BLOCKSIZE OF PRINT-DS
&D.COMJOB DC    CL6' '         NAME OF THE AGFA 2300 JOB
          DC    XL04'0000'      FREE SPACE
         SPACE 3
&D.PRTLG  EQU   *-&D.PRT        LENGTH OF PRT PORTION
         DS    0D
&D.SMFLEN EQU   *-&D.BLKCNT          LENGTH OF SMF PORTION
&D.RECLEN EQU   *-&D.RECORD
         SPACE 3
*
*        DIESE FELDER BENOETIGT DAS DRUCKPROGRAMM BASFPRT INTERN
*
&D.INTERN EQU   *
&D.PSWE   DC    F'0'           ECB FUER PASSWORD HANDLING WTOR
&D.PSW    DC    CL20' '        PASSWORD FUER DIESE LISTE
&D.SMFTM  DC    XL8'0'         TIMESTAMP DRUCK BEGINN
&D.CHKTM  DC    XL8'0'         TIMESTAMP LETZTER CHECK POINT
&D.CURRPG DC    F'0'           CURRENT PAGE NUMBER
&D.EMPFTB DC    F'0'           ADDRESS OF AREA FUER SONDERVERTEILER
&D.ETBLEN DC    F'0'           AREA-LENGTH
&D.ETBENT DC    H'0'           NUMBER OF TABLE-ENTRIES (SVT)
&D.PWATTS DC    H'0'           PASSWORD ATTEMPTS
&D.LBSENT DC    F'0'           CURRENT ENTRY IN SVT-TAB
&D.LBSCPY DC    F'0'           CURRENT COPY FOR THIS EMPFAENGER
&D.LBSPK# DC    F'0'           CURRENT PACK NUMBER
         DC    CL6' '         FORMERLY COMJOB NAME
&D.RECEND DS    0D
&D.INTLG  EQU   *-&D.INTERN
&D.LENGTH EQU   *-&D.RECORD
         SPACE 3
***************************************************************
         MEND
./ ADD  NAME=DMSBN
** TITLE   SACHBEARBEITER SATZ IN DM-DATEI
** OWNER   FRANZ
** LCHNG   03/06/84 14:19:10   Z227128 FRANZ
         MACRO
&NM      DMSBN &TYPE=DEF,&D=DM
         LCLC  &N
&N       SETC  '&NM'
         AIF   ('&TYPE' NE 'DSECT').DEF
&N       DSECT
&N       SETC  ' '
.DEF     ANOP
         SPACE 3
*        DEFINITION DES SACHBEARBEITER-SATZES
*           AUF DER DRUCKMANAGEMENT-DATEI
*
&N       DS    0D
&D.SBN    EQU   *
*
&D.SBNKEY DS    0CL10          KEY
&D.SBNK0  DC    CL4'#SBN'      FIX PART OF KEY
&D.SBN#   DC    CL3' '         SBN-NO
&D.SBN3   DC    CL3' '         SPACE
&D.SBNMOD DC    XL4'00'        KEY-MOD
*
&D.SBNNM  DC    CL40' '        NAME DES SBN
&D.SBNB   DC    CL4' '         BAU DES SBN
&D.SBNZ   DC    CL4' '         ZIMMER # DES SBN
&D.SBNOR  DC    CL12' '        ORG. EINHEIT DES SBN
&D.SBNTL  DC    CL8' '         TEL-NR DES SBN
&D.SBNF   DC    CL3' '         FACH-#
&D.SBNSL  EQU   *-&D.SBNNM     LGTH OF SBN-DESCRIPTION
*
&D.SBNDAT DC    CL10' '        CHANGE DATE
&D.SBNPRG DC    CL8' '         CHANGE PROGRAM
&D.SBNORT DC    CL10' '        ORT DES EMPFAENGER BAUS
          DC    CL07' '        FREE SPACE
*
&D.SBNLG  EQU   *-&D.SBN       LENGTH OF SBN-RECORD
         MEND
./ ADD  NAME=DMSSMFE0
         MACRO
         DMSSMFE0 &D=SE0
         CNOP  2,4
&D.ANF   EQU   *
         SPACE
         DC    AL2(&D.END-&D.ANF)
         DC    AL2(0)
         DC    H'224'
&D.TIME  DC    XL4'0'                       TIME RECORD WRITTEN
&D.DATE  DC    PL4'0'                       DATE RECORD WRITTEN
&D.SID   DC    CL2' '                       SYSTEM ID
&D.MOD   DC    CL2' '                       MODEL
&D.DSN   DC    CL44' '                      DATASET NAME
&D.BYTES DC    XL4'0'                       ANZAHL BYTES F. COP *2
&D.DTYP  DC    CL4' '                       DEVICE TYPE
&D.VOL   DC    CL6' '                       VOLSER ARCHIVED FROM
&D.CREDT DC    PL4'0'                       CREATION DATE
&D.EXPDT DC    PL4'0'                       EXPIRATION DATE
&D.ARBNR DC    CL4' '                       ARBEITSNUMMER
&D.K     DC    H'0'                         NOT YET USED
&D.RES   DC    18XL1'0'                     FILLER
         SPACE
&D.DISP  DC    CL8' '                       DISP OF CALL
&D.RESE  DC    CL1' '                       RESET OPTION
&D.JOBNM DC    CL8' '                       JOBNAME
&D.SBR   DC    CL3' '                       SACHBEARBEITER
&D.IREST DC    XL40'00'
         SPACE
&D.END   EQU   *
         MEND
./ ADD  NAME=DMSTT
         MACRO
         DMSTT &D=
&D.DMSTT DSECT
         SPACE
DMSTTANZ DS    H                            ANZAHL ELEMENTE
DMSTTANF EQU   *                            ANFANG DER ELEMENTE
DMSTTDSN DS    CL12                         TAPE-DSN
DMSTTOR  DS    H                            RETPD FOR ORGINAL
DMSTTCR  DS    H                            RETPD FOR COPY
DMSTTAVO DS    CL6                          SOURCE VOLUMES
DMSTTCAT DS    CL1                          CATALOG Y OR N
DMSTTBZ  DS    CL1                          LAUFZEIT
DMSTTART DS    CL1                          PRIM OR COPY TAPE
DMSTTPRI EQU   1
DMSTTCOP EQU   2
DMSTTFIL DS    CL23                         FILLER
DMSTTELE EQU   *-DMSTTDSN                   LAENGE EINES ELEMENTS
         SPACE
         MEND
./ ADD  NAME=DMSVT
         MACRO
&NM      DMSVT &TYPE=DEF,&D=DM
         LCLC  &N
&N       SETC  '&NM'
         AIF   ('&TYPE' NE 'DSECT').DEF
&N       DSECT
&N       SETC  ' '
.DEF     ANOP
         SPACE 3
*        DEFINITION DES SONDERVERTEILER-SATZES
*           AUF DER DRUCKMANAGEMENT-DATEI
*
&N       DS    0D
&D.SVT    EQU   *
*
&D.SVTLIS DC    CL10' '        LISTEN NUMMER
&D.SVTKEY DS    0XL4           KEY MODIFIER
&D.SVTK1  DC    CL1' '         CHAR
&D.SVTK3  DC    XL3'00'        RECORD NUMBER
&D.SVTNUM DC    XL2'00'        NUMBER OF SVT
*
&D.SVTSB1 DS    0CL14
&D.SVTSB# DC    CL3' '         SB# DES EMPFAENGERS
&D.SVTEX  DC    CL1' '         EXEMPLAR-#
&D.SVTAA  DC    XL2'00'        ANZAHL EXEMPLARE
&D.SVTS   DC    CL1' '         SCHLUESSEL F. ORIGINAL-MICRO-F
&D.SVTB   DC    CL2' '         BEARBEITUNGS-HW NUMMER
&D.SVTF   DC    CL1' '         FACH-KENNZEICHEN
          DC    CL4' '         FREE SPACE
*
&D.SVT1L  EQU   *-&D.SVTSB1    LGTH OF ONE SVT-ENTRY
*
&D.SVTSBX DC    47CL14' '      SPACE FOR 47 SVT
&D.SVTEND EQU   *
*
&D.SVTFF  DC    CL3' '         +++ TO CONTINUE, *** IF END
&D.SVTLG  EQU   *-&D.SVTSB1    LENGTH OF ALL SVT
*
&D.SVTDAT DC    CL10' '        DATE OF CHANGE
&D.SVTPRG DC    CL8' '         JOB OR USER-ID WHICH CHANGES
          DC    CL11' '        FREE SPACE
*
&D.SVLGTH EQU   *-&D.SVT       LENGTH OF SVT-RECORD
&D.SVTMAX EQU   (&D.SVTEND-&D.SVTSB1)/&D.SVT1L      MAX NO OF SVT
         MEND
./ ADD  NAME=DMSVTENT
** TITLE   SONDER-VERTEILER ENTRY IM DM
** OWNER   FRANZ
** LCHNG   03/06/84 15:40:26   Z227128 FRANZ
         MACRO
&NM      DMSVTENT &TYPE=DEF
         LCLC  &N
&N       SETC  '&NM'
         AIF   ('&TYPE' NE 'DSECT').DEF
&N       DSECT
&N       SETC  ' '
.DEF     ANOP
         SPACE 3
*        DEFINITION DER SONDERVERTEILER-ENTRIES
*
&N       DS    0D
SVTENTRY EQU   *
*
SVTSB#   DC    CL3' '    SBN
SVTNM    DC    CL40' '   NAME
SVTORT   DC    CL10' '   ORT
SVTBAU   DC    CL4' '    BAU
SVTZ     DC    CL4' '    ZIMMERNUMMER
SVTOR    DC    CL12' '   ORG.EINHEIT
SVTTL    DC    CL8' '    TEL-NR
SVTBTX   DC    CL72' '   BEARBEITUNGSHINWEISE
SVTEX    DC    CL1' '    EXEMPLAR-NUMMER
SVTAA    DC    XL2'00'   ANZAHL EXEMPLARE
SVTS     DC    CL1' '    SCHLUESSEL FUER ORIGINAL-MICRO-F
SVTSUBL  DC    X'0'      KENNZEICHEN SUBLISTE = 1
SVTBL#   DC    XL4'00'   BLATTANZAHL DER SUBLISTE
SVTPK#   DC    XL4'00'   PACK # DER SUBLISTE
         DC    CL10' '   FREE SPACE
         DS    0D
*
SVTENTL  EQU   *-SVTENTRY    LGTH OF ONE SVT-ENTRY
         MEND
./ ADD  NAME=DPT
         MACRO
&NM      DPT
&NM      DC    X'05'         PROGRAM TAB
         MEND
./ ADD  NAME=DRA
         MACRO
&NM      DRA   &LOC,&C
         LCLC  &CHAR
         LCLA  &CNT
         AIF   (T'&C EQ 'O').ERR1
         AIF   (K'&C GT 3).ERR2
         AIF   ('&C'(1,1) NE '''' OR '&C'(3,1) NE '''').ERR3
.GEN     ANOP
&CHAR    SETC  '&C'(2,1)
&NM      DC    X'3C'         REPEAT TO FOLLOWING ADDRESS
         DLOC  &LOC
         DC    C'&CHAR'      CHARACTER TO REPEAT
         MEXIT
.ERR1    MNOTE 8,'CHARACTER TO REPEAT MISSING'
         MEXIT
.ERR2    ANOP
&CNT     SETA  K'&C
         AIF   ('&C'(1,1) NE '''' OR '&C'(&CNT,1) NE '''').ERR3
         MNOTE 4,'ONE CHARACTER ONLY, FIRST TAKEN'
         AGO   .GEN
.ERR3    MNOTE 8,'IMPROPER APOSTROPHEES WITH CHARACTER TO REPEAT'
.END     ANOP
         MEND
./ ADD  NAME=DSBA
         MACRO
&NM      DSBA  &LOC
&NM      DC    X'11'         SET BUFFER ADDRESS
         DLOC  &LOC
         MEND
./ ADD  NAME=DSCBDEF
** TITLE   DEFINITION EINES CONTROLL-BLOCKS (FORMAT1-DSCB)
** OWNER   EXNER
** LCHNG   05/05/83 09:12:26   Z227128 FRANZ
         MACRO
&NM      DSCBDEF &DSN=,&DSNAM=,&CREDT=,&CRDTE=,&EXPDT=,&VOLSQ=,        *
               &NOEPV=,&NOBDB=,&CRJOB=,&LSJOB=,&REFD=,&DSORG=,         *
               &RECFM=,&OPTCD=,&BLKSI=,&BLKL=,&LRECL=,                 *
               &KEYL=,&RKP=,&DSIND=,&SCALO=,&LSTAR=,&TRBAL=,           *
               &EXT1=,&EXT2=,&EXT3=,&PTRDS=,&UNUSE=,&TRNUS=,           *
               &TRALC=,&TRUSE=,&VOLSER=,&DEVT=,&OPCNT=,&MDATE=,        *
               &CHANGE=,&PROTECT=,&EXTUSE=,&ALCTYP=,&SECQU=,           *
               &EXT=,&EX1QU=
&NM      DS    0D
.*********************************************************************
.*       DIESES MACRO DEFINIERT EINEN CONTOLL-BLOCK, DER ANGABEN     *
.*       DARUEBER ENTHAELT, WIE DAS UNTERPROGRAMM 'LUDSCB' EINEN     *
.*       UEBERGEBENEN FORMAT1-DSCB FORMATIEREN SOLL.                 *
.*                                                                   *
.*         &DSN   = DATA SET NAME                                    *
.*         &DSNAM = ALIAS OF &DSN                                    *
.*         &CREDT = CREATION DATE                                    *
.*                  STANDARD OUTPUT L(5)   YYDDD                     *
.*                  3.PARM = 'P' => L(6)   YY.DDD                    *
.*                  3.PARM = 'B' => L(3)   X'YYDDDD'                 *
.*                  3.PARM = 'N' => L(10)  DD.MM.YYYY                *
.*         &CRDTE = ALIAS OF &CREDT                                  *
.*                  SIEHE CREDT                                      *
.*         &EXPDT = EXPIRATION DATE                                  *
.*                  SIEHE CREDT                                      *
.*         &VOLSQ = VOLUME SEQUENCE NUMBER                           *
.*         &NOEPV = NUMBER OF EXTENTS ON VOLUME                      *
.*         &NOBDB = NUMBER OF BYTES USED IN LAST DIRECTORY BLOCK     *
.*         &CRJOB = CREATION JOB                                     *
.*         &LSJOB = LAST JOB                                         *
.*         &REFD  = DATE LAST REFERENCED                             *
.*                  SIEHE CREDT                                      *
.*         &DSORG = DATA SET ORGANISATION                            *
.*                  3.PARM = 'X' => L(2)   AS IS                     *
.*         &RECFM = RECORD FORMAT                                    *
.*                  3.PARM = 'X' => L(1)   AS IS                     *
.*         &OPTCD = OPTION CODE                                      *
.*                  3.PARM = 'X' => L(1)   AS IS                     *
.*         &BLKSI = BLOCK LENGTH                                     *
.*                  3.PARM = 'X' => L(2)   AS IS                     *
.*         &BLKL  = ALIAS OF &BLKSI                                  *
.*                  3.PARM = 'X' => L(2)   AS IS                     *
.*         &LRECL = RECORD LENGTH                                    *
.*                  3.PARM = 'X' => L(2)   AS IS                     *
.*         &KEYL  = KEY LENGTH                                       *
.*                  3.PARM = 'X' => L(2)   AS IS                     *
.*         &RKP   = RELATIV KEY POSITION                             *
.*                  3.PARM = 'X' => L(2)   AS IS                     *
.*         &DSIND = DATA SET INDICATORS                              *
.*                  3.PARM = 'X' => L(1)   AS IS                     *
.*         &SCALO = SECONDARY ALLOCATION                             *
.*                  3.PARM = 'X' => L(4)   AS IS                     *
.*         &LSTAR = LAST USED TRACK AND BLOCK ON TRACK               *
.*                  3.PARM = 'X' => L(3)   AS IS                     *
.*         &TRBAL = BYTES REMAINING ON LAST TRACK USED               *
.*         &EXT1  = FIRST EXTEND DESCRIPTION                         *
.*                  3.PARM = 'X' => L(10)  AS IS                     *
.*         &EXT2  = SECOND EXTEND DESCRIPTION                        *
.*                  3.PARM = 'X' => L(10)  AS IS                     *
.*         &EXT3  = THIRD EXTEND DESCRIPTION                         *
.*                  3.PARM = 'X' => L(10)  AS IS                     *
.*         &PTRDS = POSSIBLE PTR TO A FORMAT 2 OR 3 DSCB             *
.*                  3.PARM = 'X' => L(5)   AS IS                     *
.*         &UNUSE = UNUSED SPACE                                     *
.*         &TRNUS = ALIAS OF UNUSE                                   *
.*         &TRALC = TRACKS ALLOCATED                                 *
.*         &TRUSE = TRACKS USED                                      *
.*         &VOLSER= VOLUME SERIAL NUMBER                             *
.*         &DEVT  = DEVICE TYPE                                      *
.*                  3.PARM = BLANK  L(4)   AS IS Z. B. X'3050200B'   *
.*                  3.PARM = 'U' => L(5)   UNITNAME   3350,3330V     *
.*                  3.PARM = 'X' => L(8)   HEXA  Z. B. 3050200B      *
.*         &OPCNT = OPEN-COUNT (OPEN OTHER THAN INPUT COUNTED BY DMS)*
.*         &MDATE = DATE OF LAST MODIFICATION (DMS)                  *
.*                  SIEHE CREDT                                      *
.*         &CHANGE= CHANGE-BIT SET ? YES OR NO                       *
.*         &PROTECT= PROTECTED ?     RACF, OS-READ OR OS-WRITE       *
.*         &EXTUSE= NUMBER OF EXTENTS USED                           *
.*         &ALCTYP= TYPE OF ALLOCATION CYL TRK OR BLK                *
.*         &SECQU = SECONDARY QUANTITY                               *
.*         &EXT   = ALL EXTENTS  L(10)  AS IS     ODER               *
.*                  3. PARM ='X' IN HEX BB/MM/CCCC/HHHH/CCCC/HHHH    *
.*                  3. PARM ='D' IN DEC CCCC/HHHH/CCCC/HHHH          *
.*         &EX1QU = QUANTITY OF FIRST EXTENT IN UNITS OF ALCTYP      *
.*********************************************************************
         AIF   ('&DSN' EQ '' AND '&DSNAM' EQ '').CREDT
         AIF   ('&DSN' NE '' AND '&DSNAM' NE '').DSNERR
         AIF   ('&DSN' NE '').DSN
         DC    AL2(1),AL2(&DSNAM(1)),AL2(&DSNAM(2)),CL8' '
         AGO   .CREDT
.DSNERR  MNOTE 8,'DSN AND DSNAM MUTUALLY EXCLUSIVE'
         MEXIT
.DSN     ANOP
         DC    AL2(1),AL2(&DSN(1)),AL2(&DSN(2)),CL8' '
.*
.CREDT   ANOP
         AIF   ('&CREDT' EQ '' AND '&CRDTE' EQ '').EXPDT
         AIF   ('&CREDT' NE '' AND '&CRDTE' NE '').CRDERR
         AIF   ('&CREDT' NE '').CRDT
         DC    AL2(2),AL2(&CRDTE(1)),AL2(&CRDTE(2)),CL8'&CRDTE(3) '
         AGO   .EXPDT
.CRDERR  MNOTE 8,'CREDT AND CRDTE MUTUALLY EXCLUSIVE'
         MEXIT
.CRDT    ANOP
         DC    AL2(2),AL2(&CREDT(1)),AL2(&CREDT(2)),CL8'&CREDT(3) '
.*
.EXPDT   ANOP
         AIF   ('&EXPDT' EQ '').VOLSQ
         DC    AL2(3),AL2(&EXPDT(1)),AL2(&EXPDT(2)),CL8'&EXPDT(3) '
.*
.VOLSQ   ANOP
         AIF   ('&VOLSQ' EQ '').NOEPV
         DC    AL2(4),AL2(&VOLSQ(1)),AL2(&VOLSQ(2)),CL8' '
.*
.NOEPV   ANOP
         AIF   ('&NOEPV' EQ '').NOBDB
         DC    AL2(5),AL2(&NOEPV(1)),AL2(&NOEPV(2)),CL8' '
.*
.NOBDB   ANOP
         AIF   ('&NOBDB' EQ '').CRJOB
         DC    AL2(6),AL2(&NOBDB(1)),AL2(&NOBDB(2)),CL8' '
.*
.CRJOB   ANOP
         AIF   ('&CRJOB' EQ '').LSJOB
         DC    AL2(7),AL2(&CRJOB(1)),AL2(&CRJOB(2)),CL8' '
.*
.LSJOB   ANOP
         AIF   ('&CRJOB' EQ '').REFD
         DC    AL2(8),AL2(&LSJOB(1)),AL2(&LSJOB(2)),CL8' '
.*
.REFD    ANOP
         AIF   ('&REFD' EQ '').DSORG
         DC    AL2(9),AL2(&REFD(1)),AL2(&REFD(2)),CL8'&REFD(3) '
.*
.DSORG   ANOP
         AIF   ('&DSORG' EQ '').RECFM
         DC    AL2(10),AL2(&DSORG(1)),AL2(&DSORG(2)),CL8'&DSORG(3) '
.*
.RECFM   ANOP
         AIF   ('&RECFM' EQ '').OPTCD
         DC    AL2(11),AL2(&RECFM(1)),AL2(&RECFM(2)),CL8'&RECFM(3) '
.*
.OPTCD   ANOP
         AIF   ('&OPTCD' EQ '').BLKSI
         DC    AL2(12),AL2(&OPTCD(1)),AL2(&OPTCD(2)),CL8'&OPTCD(3) '
.*
.BLKSI   ANOP
         AIF   ('&BLKSI' EQ '' AND '&BLKL' EQ '').LRECL
         AIF   ('&BLKSI' NE '' AND '&BLKL' NE '').BLKERR
         AIF   ('&BLKSI' NE '').BLKS
         DC    AL2(13),AL2(&BLKL(1)),AL2(&BLKL(2)),CL8'&BLKL(3) '
         AGO   .LRECL
.BLKERR  MNOTE 8,'BLKSI AND BLKL MUTUALLY EXCLUSIVE'
         MEXIT
.BLKS    ANOP
         DC    AL2(13),AL2(&BLKSI(1)),AL2(&BLKSI(2)),CL8'&BLKSI(3) '
.*
.LRECL   ANOP
         AIF   ('&LRECL' EQ '').KEYL
         DC    AL2(14),AL2(&LRECL(1)),AL2(&LRECL(2)),CL8'&LRECL(3) '
.*
.KEYL    ANOP
         AIF   ('&KEYL' EQ '').RKP
         DC    AL2(15),AL2(&KEYL(1)),AL2(&KEYL(2)),CL8'&KEYL(3) '
.*
.RKP     ANOP
         AIF   ('&RKP' EQ '').DSIND
         DC    AL2(16),AL2(&RKP(1)),AL2(&RKP(2)),CL8'&RKP(3) '
.*
.DSIND   ANOP
         AIF   ('&DSIND' EQ '').SCALO
         DC    AL2(17),AL2(&DSIND(1)),AL2(&DSIND(2)),CL8'&DSIND(3) '
.*
.SCALO   ANOP
         AIF   ('&SCALO' EQ '').LSTAR
         DC    AL2(18),AL2(&SCALO(1)),AL2(&SCALO(2)),CL8'&SCALO(3) '
.*
.LSTAR   ANOP
         AIF   ('&LSTAR' EQ '').TRBAL
         DC    AL2(19),AL2(&LSTAR(1)),AL2(&LSTAR(2)),CL8'&LSTAR(3) '
.*
.TRBAL   ANOP
         AIF   ('&TRBAL' EQ '').EXT1
         DC    AL2(20),AL2(&TRBAL(1)),AL2(&TRBAL(2)),CL8' '
.*
.EXT1    ANOP
         AIF   ('&EXT1' EQ '').EXT2
         DC    AL2(21),AL2(&EXT1(1)),AL2(&EXT1(2)),CL8'&EXT1(3) '
.*
.EXT2    ANOP
         AIF   ('&EXT2' EQ '').EXT3
         DC    AL2(22),AL2(&EXT2(1)),AL2(&EXT2(2)),CL8'&EXT2(3) '
.*
.EXT3    ANOP
         AIF   ('&EXT3' EQ '').PTRDS
         DC    AL2(23),AL2(&EXT3(1)),AL2(&EXT3(2)),CL8'&EXT3(3) '
.*
.PTRDS   ANOP
         AIF   ('&PTRDS' EQ '').UNUSE
         DC    AL2(24),AL2(&PTRDS(1)),AL2(&PTRDS(2)),CL8'&PTRDS(3) '
.*
.UNUSE   ANOP
         AIF   ('&UNUSE' EQ '' AND '&TRNUS' EQ '').TRALC
         AIF   ('&UNUSE' NE '' AND '&TRNUS' NE '').UNUERR
         AIF   ('&UNUSE' EQ '').TRNUS
         DC    AL2(25),AL2(&UNUSE(1)),AL2(&UNUSE(2)),CL8' '
         AGO   .TRALC
.UNUERR  MNOTE 8,'UNUSE AND TRNUS MUTUALLY EXCLUSIVE'
         MEXIT
.TRNUS   ANOP
         DC    AL2(25),AL2(&TRNUS(1)),AL2(&TRNUS(2)),CL8' '
.*
.TRALC   ANOP
         AIF   ('&TRALC' EQ '').TRUSE
         DC    AL2(26),AL2(&TRALC(1)),AL2(&TRALC(2)),CL8' '
.*
.TRUSE   ANOP
         AIF   ('&TRUSE' EQ '').VOLSER
         DC    AL2(27),AL2(&TRUSE(1)),AL2(&TRUSE(2)),CL8' '
.*
.VOLSER  ANOP
         AIF   ('&VOLSER' EQ '').DEVT
         DC    AL2(28),AL2(&VOLSER(1)),AL2(&VOLSER(2)),CL8' '
.*
.DEVT    ANOP
         AIF   ('&DEVT' EQ '').OPCNT
         DC    AL2(29),AL2(&DEVT(1)),AL2(&DEVT(2)),CL8'&DEVT(3) '
.*
.OPCNT   ANOP
         AIF   ('&OPCNT' EQ '').MDATE
         DC    AL2(30),AL2(&OPCNT(1)),AL2(&OPCNT(2)),CL8' '
.*
.MDATE   ANOP
         AIF   ('&MDATE' EQ '').CHNGE
         DC    AL2(31),AL2(&MDATE(1)),AL2(&MDATE(2)),CL8'&MDATE(3) '
.*
.CHNGE   ANOP
         AIF   ('&CHANGE' EQ '').PROTECT
         DC    AL2(32),AL2(&CHANGE(1)),AL2(&CHANGE(2)),CL8' '
.*
.PROTECT ANOP
         AIF   ('&PROTECT' EQ '').EXTUS
         DC    AL2(33),AL2(&PROTECT(1)),AL2(&PROTECT(2)),CL8' '
.*
.EXTUS   ANOP
         AIF   ('&EXTUSE' EQ '').ALCTYP
         DC    AL2(34),AL2(&EXTUSE(1)),AL2(&EXTUSE(2)),CL8' '
.*
.ALCTYP  ANOP
         AIF   ('&ALCTYP' EQ '').SECQU
         DC    AL2(35),AL2(&ALCTYP(1)),AL2(&ALCTYP(2)),CL8' '
.*
.SECQU   ANOP
         AIF   ('&SECQU' EQ '').EXT
         DC    AL2(36),AL2(&SECQU(1)),AL2(&SECQU(2)),CL8' '
.*
.EXT     ANOP
         AIF   ('&EXT' EQ '').EX1QU
         DC    AL2(37),AL2(&EXT(1)),AL2(&EXT(2)),CL8'&EXT(3) '
.*
.EX1QU   ANOP
         AIF   ('&EX1QU' EQ '').END
         DC    AL2(38),AL2(&EX1QU(1)),AL2(&EX1QU(2)),CL8' '
.*
.END     ANOP
         DC    4X'FF'                 END OF DEFINITIONS
         MEND
./ ADD  NAME=DSF
         MACRO
&NM      DSF   &ATT
         LCLA  &CNT,&INX,&TABINX
         LCLA  &P,&N,&S,&M,&H,&D,&ND
         LCLB  &LP,&LN,&LS,&LM,&LH,&LD,&LND
         LCLC  &TAB(32)
&INX     SETA  0
&P       SETA  16
&N       SETA  8
&S       SETA  8
&M       SETA  1
&H       SETA  4
&D       SETA  3
&ND      SETA  6
&TAB(01) SETC  '40'
&TAB(02) SETC  'C1'
&TAB(03) SETC  'C4'
&TAB(04) SETC  'C5'
&TAB(05) SETC  'C8'
&TAB(06) SETC  'C9'
&TAB(07) SETC  '4C'
&TAB(08) SETC  '4D'
&TAB(09) SETC  '50'
&TAB(10) SETC  'D1'
&TAB(11) SETC  'D4'
&TAB(12) SETC  'D5'
&TAB(13) SETC  'D8'
&TAB(14) SETC  'D9'
&TAB(15) SETC  '5C'
&TAB(16) SETC  '5D'
&TAB(17) SETC  '60'
&TAB(18) SETC  '61'
&TAB(19) SETC  'E4'
&TAB(20) SETC  'E5'
&TAB(21) SETC  'E8'
&TAB(22) SETC  'E9'
&TAB(23) SETC  '6C'
&TAB(24) SETC  '6D'
&TAB(25) SETC  'F0'
&TAB(26) SETC  'F1'
&TAB(27) SETC  'F4'
&TAB(28) SETC  'F5'
&TAB(29) SETC  'F8'
&TAB(30) SETC  'F9'
&TAB(31) SETC  '7C'
&TAB(32) SETC  '7D'
&CNT     SETA  N'&ATT
.CLOOP   ANOP
&INX     SETA  &INX+1
         AIF   (&INX GT &CNT).LOGIC
         AIF   ('&ATT(&INX)' EQ 'PROT').APROT
         AIF   ('&ATT(&INX)' EQ 'NUM').ANUM
         AIF   ('&ATT(&INX)' EQ 'SKIP').ASKIP
         AIF   ('&ATT(&INX)' EQ 'MDT').AMDT
         AIF   ('&ATT(&INX)' EQ 'HI').AHI
         AIF   ('&ATT(&INX)' EQ 'DET').ADET
         AIF   ('&ATT(&INX)' EQ 'NONDISP').ANOND
         AGO   .ERR1
.APROT   ANOP
         AIF   (&LP).ERR2
&LP      SETB  1
&TABINX  SETA  &TABINX+16
         AGO   .CLOOP
.ANUM    ANOP
         AIF   (&LN).ERR2
&LN      SETB  1
&TABINX  SETA  &TABINX+8
         AGO   .CLOOP
.ASKIP   ANOP
         AIF   (&LS).ERR2
&LS      SETB  1
         AGO   .CLOOP
.AMDT    ANOP
         AIF   (&LM).ERR2
&LM      SETB  1
&TABINX  SETA  &TABINX+1
         AGO   .CLOOP
.AHI     ANOP
         AIF   (&LH).ERR2
&LH      SETB  1
         AGO   .CLOOP
.ADET    ANOP
         AIF   (&LD).ERR2
&LD      SETB  1
         AGO   .CLOOP
.ANOND   ANOP
         AIF   (&LND).ERR2
&LND     SETB  1
         AGO   .CLOOP
.LOGIC   ANOP
         AIF   (&LH AND &LND).ERR3
         AIF   (&LD AND &LND).ERR3
         AIF   (&LND).A6
         AIF   (NOT &LH).ISLD
&TABINX  SETA  &TABINX+4
         AGO   .TSKIP
.ISLD    AIF   (NOT &LD).TSKIP
&TABINX  SETA  &TABINX+2
         AGO   .TSKIP
.A6      ANOP
&TABINX  SETA  &TABINX+6
.TSKIP   ANOP
         AIF   (&LS AND &LP AND NOT &LN).A8
         AIF   (&LS AND &LN AND NOT &LP).A16
         AIF   (&LS AND NOT &LP AND NOT &LN).A24
         AGO   .GEN
.A8      ANOP
&TABINX  SETA  &TABINX+8
         AGO   .GEN
.A16     ANOP
&TABINX  SETA  &TABINX+16
         AGO   .GEN
.A24     ANOP
&TABINX  SETA  &TABINX+24
.GEN     ANOP
&NM      DC    X'1D'         START FIELD
         DC    X'&TAB(&TABINX+1)' ATTRIBUTE
         MEXIT
.ERR1    MNOTE 8,'UNKNOWN OPERAND'
         MEXIT
.ERR2    MNOTE 4,'DUPLICATE OPERAND, IGNORED'
         AGO   .CLOOP
.ERR3    MNOTE 8,'OPERANDS INCOMPATIBLE'
         MEXIT
.END     ANOP
         MEND
./ ADD  NAME=DTAETT
ETZU1    DS    0CL45
         DC    C'1'
JOBNM    DC    CL8' '
         DC    C' '
STEPNM   DC    CL8' '
         DC    CL18' '
         DC    CL6'BLATT '
BLATT    DC    CL3' '
ETZU2    DS    0CL45
         DC    C'-'
         DC    X'B0'
         DC    42X'20'
         DC    X'B1'
ETZ01    DS    0CL45
         DC    C' '
         DC    X'B9'
         DC    CL13' EMPFAENGER: '
EMPF1    DC    CL29' '
         DC    X'B9'
ETZ02    DS    0CL45
         DC    C' '
         DC    X'B9'
         DC    CL13' '
EMPF2    DC    CL29' '
         DC    X'B9'
ETZ03    DS    0CL45
         DC    C' '
         DC    X'B9'
         DC    CL4' '
EILT     DC    CL4' '
         DC    CL5' '
EMPF3    DC    CL29' '
         DC    X'B9'
ETZ04    DS    0CL45
         DC    C' '
         DC    X'B9'
         DC    CL4' '
STRICH   DC    CL4' '
         DC    CL5' '
EMPF4    DC    CL29' '
         DC    X'B9'
ETZ05    DS    0CL45
         DC    C' '
         DC    X'B9'
         DC    CL13' '
         DC    28X'60'
         DC    C' '
         DC    X'B9'
ETZ06    DS    0CL45
         DC    C' '
         DC    X'B9'
         DC    CL13' ABSENDER:   '
         DC    CL29'BASF AKTIENGESELLSCHAFT      '
         DC    X'B9'
ETZ07    DS    0CL45
         DC    C' '
         DC    X'B9'
         DC    CL13' '
         DC    CL29'6700 LUDWIGSHAFEN            '
         DC    X'B9'
ETZ08    DS    0CL45
         DC    C' '
         DC    X'B9'
         DC    CL13' '
         DC    CL18'BANKLEITZAHL      '
BLZ      DC    CL8' '
         DC    CL3' '
         DC    X'B9'
ETZ09    DS    0CL45
         DC    C' '
         DC    X'B9'
         DC    CL13' '
         DC    CL18'KONTONUMMER       '
KTONR    DC    CL10' '
         DC    C' '
         DC    X'B9'
ETZ10    DS    0CL45
         DC    C' '
         DC    X'B9'
         DC    CL13' '
         DC    CL18'DATEINAME         '
         DC    CL5'DTAUS'
         DC    CL6' '
         DC    X'B9'
ETZ11    DS    0CL45
         DC    C' '
         DC    X'B9'
         DC    C' '
DAT      DC    CL12' '
         DC    CL18'BANDNUMMER        '
BNDNR    DC    CL6' '
         DC    CL5' '
         DC    X'B9'
ETZ12    DS    0CL45
         DC    C' '
         DC    X'B4'
         DC    42X'20'
         DC    X'B5'
ETZLG    EQU   *-ETZ12                LENGTH OF ONE LINE
ETZNR    EQU   (*-ETZ01)/ETZLG        LINE COUNTER
./ ADD  NAME=DTALISTE
** TITLE   AUSGANGSSCHEIN
** OWNER   THIESEN
** LCHNG   04/16/84 08:25:20   Z228496 THIESEN
DTAZ01   DS    0CL66
         DC    C'1'
         DC    X'B0'
         DC    13X'20'
         DC    X'B6'
         DC    34X'20'
         DC    X'B6'
         DC    14X'20'
         DC    X'B1'
DTAZ02   DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL13' '
         DC    X'B9'
         DC    CL34' '
         DC    X'B9'
         DC    C' '
LHSTEPNM DC    CL8' '
         DC    CL5' '
         DC    X'B9'
DTAZ03   DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL3' '
         DC    XL6'CACBCCCDCECF'
         DC    CL4' '
         DC    X'B9'
         DC    CL6' '
         DC    C'DATENTRAEGERAUSTAUSCH'
         DC    CL7' '
         DC    X'B9'
         DC    C' BLATT '
LBLATT   DC    CL3' '
         DC    CL4' '
         DC    X'B9'
DTAZ04   DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL3' '
         DC    XL6'DADBDCDDDEDF'
         DC    CL4' '
         DC    X'B9'
         DC    CL34' '
         DC    X'B9'
         DC    CL14' '
         DC    X'B9'
DTAZ05   DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL13' '
         DC    X'B9'
         DC    CL5' '
LHEAD    DC    CL23' '
         DC    CL6' '
         DC    X'B9'
         DC    CL14' LUDWIGSHAFEN '
         DC    X'B9'
DTAZ06   DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    C'    ZLI/R    '
         DC    X'B9'
         DC    CL5' '
LAUFTR   DC    CL23' '
         DC    CL6' '
         DC    X'B9'
         DC    C' '
LDAT     DC    C'..........'
         DC    CL3' '
         DC    X'B9'
DTAZ07   DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL13' '
         DC    X'B9'
         DC    CL34' '
         DC    X'B9'
         DC    CL14' '
         DC    X'B9'
DTAZ08   DS    0CL66
         DC    C' '
         DC    X'B4'
         DC    13X'20'
         DC    X'B7'
         DC    34X'20'
         DC    X'B7'
         DC    14X'20'
         DC    X'B5'
DTAZ09   DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL63' '
         DC    X'B9'
DTAZ10   DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    C' EMPFAENGER: '
LEMPFNM  DC    CL49' '
         DC    C' '
         DC    X'B9'
DTAZ10A  DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL13' '
LEMPFZ1  DC    CL49' '
         DC    C' '
         DC    X'B9'
DTAZ10B  DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL13' '
LEMPFZ2  DC    CL49' '
         DC    C' '
         DC    X'B9'
DTAZ11   DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL13' '
LEMPFST  DC    CL49' '
         DC    C' '
         DC    X'B9'
DTAZ12   DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL13' '
LEMPFO   DC    CL49' '
         DC    C' '
         DC    X'B9'
DTAZ13   DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL63' '
         DC    X'B9'
DTAZ14   DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    C' BETREFF:    '
LBETR1   DC    CL49' '
         DC    C' '
         DC    X'B9'
DTAZ14A  DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL13' '
LBETR2   DC    CL49' '
         DC    C' '
         DC    X'B9'
DTAZ15   DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL63' '
         DC    X'B9'
DTAZ16   DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    C' VERSANDART: '
LVSART   DC    CL49' '
         DC    C' '
         DC    X'B9'
DTAZ17   DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    C' VERSANDWEG: '
LVSWEG   DC    CL49' '
         DC    C' '
         DC    X'B9'
DTAZ18   DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL31' '
         DC    C'UNTERSCHRIFT'
         DC    CL20' '
         DC    X'B9'
DTAZ19   DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    C' FREIGABE DURCH: '
LFREI    DC    CL13' '
         DC    C' REFERATSLEITER: '
LREFLTR  DC    CL15' '
         DC    C' '
         DC    X'B9'
DTAZ20   DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    C' SACHBEARBEITER: '
LSBN     DC    CL13' '
         DC    C' PROJEKTLEITER : '
LPRLTR   DC    CL15' '
         DC    C' '
         DC    X'B9'
DTAZ21   DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    C' TELEFON :       '
LSBNTEL  DC    CL8' '
         DC    CL14' '
         DC    C'DATUM :  '
LUDAT    DC    CL10' '
         DC    CL5' '
         DC    X'B9'
DTAZ22   DS    0CL66
         DC    C' '
         DC    X'B4'
         DC    63X'20'
         DC    X'B5'
DTAZ23   DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL63' '
         DC    X'B9'
DTAZ24   DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    C' SACHGEBIET:     '
LSGE     DC    CL2' '
         DC    CL19' '
         DC    C'JOBNAME:   '
LJOBNAME DC    CL8' '
         DC    CL6' '
         DC    X'B9'
DTAZ25   DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    C' BEZEICHNUNG:    '
LSGEB    DC    CL45' '
         DC    C' '
         DC    X'B9'
DTAZ26   DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    C' DFP-BLATT-NR:   '
LABLS    DC    CL8' '
         DC    CL12' '
         DC    C' STEPNAME:  '
LSTEPN   DC    CL8' '
         DC    CL6' '
         DC    X'B9'
DTAZ27   DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL63' '
         DC    X'B9'
DTAZ28   DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    C' BERZEITRAUM:    '
LBZEIT   DC    CL20' '
         DC    C' ERST-DATUM: '
LERDATUM DC    CL10' '
         DC    CL3' '
         DC    X'B9'
DTAZ29   DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL63' '
         DC    X'B9'
DTAZ30   DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    C' DS-NAME:'
         DC    CL8' '
LDSN     DC    CL44' '
         DC    CL2' '
         DC    X'B9'
DTAZ31   DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL63' '
         DC    X'B9'
DTAZ32   DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    C' BANDTEXT:'
         DC    CL7' '
LBANDTX  DC    CL45' '
         DC    C' '
         DC    X'B9'
DTAZ33   DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL63' '
         DC    X'B9'
DTAZ34   DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    C' RECFM:'
         DC    CL10' '
LRECFM   DC    CL5' '
         DC    CL13' '
         DC    C'FILE:    '
LFILE    DC    CL8' '
         DC    CL11' '
         DC    X'B9'
DTAZ35   DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    C' LRECL:'
         DC    CL10' '
LLRECL   DC    CL5' '
         DC    CL13' '
         DC    C'LABEL:   '
LLABEL   DC    CL14' '
         DC    CL5' '
         DC    X'B9'
DTAZ36   DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    C' BLKSIZE:'
         DC    CL8' '
LBLKS    DC    CL5' '
         DC    CL13' '
         DC    C'EXPDT:   '
LEXPDT   DC    CL10' '
         DC    CL9' '
         DC    X'B9'
DTAZ37   DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    C' DEN:'
         DC    CL12' '
LDEN     DC    CL4' '
         DC    CL14' '
         DC    C'SAETZE:  '
LSAETZE  DC    CL17' '
         DC    CL2' '
         DC    X'B9'
DTAZ38   DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    C' MODUS(TRK):     '
LMODUS   DC    C' '
         DC    CL45' '
         DC    X'B9'
DTAZ39   DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL63' '
         DC    X'B9'
DTAZ40   DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    C' VOL-SER: ROLLE VON '
         DC    X'B9'
         DC    C' VOL-SER: ROLLE VON '
         DC    X'B9'
         DC    C' VOL-SER: ROLLE VON  '
         DC    X'B9'
DTAZ41   DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    C' '
         DC    18X'60'
         DC    C' '
         DC    X'B9'
         DC    C' '
         DC    18X'60'
         DC    C' '
         DC    X'B9'
         DC    C' '
         DC    18X'60'
         DC    C'  '
         DC    X'B9'
DTAZ42   DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    C'  '
LVOL11   DC    CL6' '
         DC    CL3' '
LROL11   DC    CL2' '
         DC    CL4' '
LVON11   DC    CL2' '
         DC    C' '
         DC    X'B9'
         DC    C'  '
LVOL12   DC    CL6' '
         DC    CL3' '
LROL12   DC    CL2' '
         DC    CL4' '
LVON12   DC    CL2' '
         DC    C' '
         DC    X'B9'
         DC    C'  '
LVOL13   DC    CL6' '
         DC    CL3' '
LROL13   DC    CL2' '
         DC    CL4' '
LVON13   DC    CL2' '
         DC    C'  '
         DC    X'B9'
DTAZ43   DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    C'  '
LVOL21   DC    CL6' '
         DC    CL3' '
LROL21   DC    CL2' '
         DC    CL4' '
LVON21   DC    CL2' '
         DC    C' '
         DC    X'B9'
         DC    C'  '
LVOL22   DC    CL6' '
         DC    CL3' '
LROL22   DC    CL2' '
         DC    CL4' '
LVON22   DC    CL2' '
         DC    C' '
         DC    X'B9'
         DC    C'  '
LVOL23   DC    CL6' '
         DC    CL3' '
LROL23   DC    CL2' '
         DC    CL4' '
LVON23   DC    CL2' '
         DC    C'  '
         DC    X'B9'
DTAZ44   DS    0CL66
         DC    C' '
         DC    X'B4'
         DC    63X'20'
         DC    X'B5'
DTAZ45   DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    C' VERSANDHW:  '
LVSHW    DC    CL49' '
         DC    C' '
         DC    X'B9'
DTAZ46   DS    0CL66
         DC    C' '
         DC    X'B4'
         DC    63X'20'
         DC    X'B5'
DTAZ47   DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL63' '
         DC    X'B9'
DTAZ48   DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL25' '
         DC    CL13'AUSGANGSDATUM'
         DC    CL12' '
         DC    CL13'UNTERSCHRIFT '
         DC    X'B9'
DTAZ49   DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL22' '
         DC    CL19'(SOLL)        (IST)'
         DC    CL22' '
         DC    X'B9'
DTAZ50   DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL15' AUS BANDARCHIV'
         DC    CL5' '
LSOLLDAT DC    CL10' '
         DC    CL33' '
         DC    X'B9'
DTAZ51   DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL63' '
         DC    X'B9'
DTAZ52   DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL28' GENEHMIGUNG  SCHICHTLEITER:'
         DC    CL35' '
         DC    X'B9'
DTAZ53   DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL63' '
         DC    X'B9'
DTAZ54   DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL63' RUECKLIEFERUNGSTERMIN     : SPAETESTENS 4 WOCHEN N*
               ACH ERHALT'
         DC    X'B9'
DTAZ55   DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL63' '
         DC    X'B9'
DTAZ56   DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL63' MIT DER EROEFFNUNG DES ROUTINE- BZW. SONDER-DATENT*
               RAEGER-'
         DC    X'B9'
DTAZ57   DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL63' AUSTAUSCHES WIRD DURCH UNTERSCHRIFT (AB HGL AUFWAE*
               RTS) BE-'
         DC    X'B9'
DTAZ58   DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL63' STAETIGT, DASS DIE RESTDATEN (AB EOF BIS REFLEKTOR*
               MARKE-ENDE)'
         DC    X'B9'
DTAZ59   DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL63' GELOESCHT SIND.'
         DC    X'B9'
DTAZ60   DS    0CL66
         DC    C' '
         DC    X'B2'
         DC    63X'20'
         DC    X'B3'
DTAZLG   EQU   *-DTAZ60       LGTH OF ONE LINE
DTAZNO   EQU   (*-DTAZ01)/DTAZLG
DTAZ09#  DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL63' '
         DC    X'B9'
DTAZ10#  DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL2' '
LEMPFNM# DC    CL49' '
         DC    CL12' '
         DC    X'B9'
DTAZ10A# DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL2' '
LEMPFZ1# DC    CL49' '
         DC    CL12' '
         DC    X'B9'
DTAZ10B# DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL2' '
LEMPFZ2# DC    CL49' '
         DC    CL12' '
         DC    X'B9'
DTAZ11#  DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL2' '
LEMPFST# DC    CL49' '
         DC    CL12' '
         DC    X'B9'
DTAZ12#  DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL2' '
LEMPFO#  DC    CL49' '
         DC    CL12' '
         DC    X'B9'
DTAZ13#  DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL63' '
         DC    X'B9'
DTAZ13A# DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL63' '
         DC    X'B9'
DTAZ14#  DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL2' '
         DC    CL25'ROLLENNUMMER DER 1. ROLLE'
         DC    CL29' '
LVOL11#  DC    CL6' '
         DC    C' '
         DC    X'B9'
DTAZ15#  DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL63' '
         DC    X'B9'
DTAZ16#  DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL19' '
         DC    CL8'2. ROLLE'
         DC    CL29' '
LVOL12#  DC    CL6' '
         DC    C' '
         DC    X'B9'
DTAZ17#  DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL63' '
         DC    X'B9'
DTAZ18#  DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL19' '
         DC    CL8'3. ROLLE'
         DC    CL29' '
LVOL13#  DC    CL6' '
         DC    C' '
         DC    X'B9'
DTAZ19#  DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL63' '
         DC    X'B9'
DTAZ20#  DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL19' '
         DC    CL8'4. ROLLE'
         DC    CL29' '
LVOL21#  DC    CL6' '
         DC    C' '
         DC    X'B9'
DTAZ21#  DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL63' '
         DC    X'B9'
DTAZ22#  DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL19' '
         DC    CL8'5. ROLLE'
         DC    CL29' '
LVOL22#  DC    CL6' '
         DC    C' '
         DC    X'B9'
DTAZ23#  DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL63' '
         DC    X'B9'
DTAZ24#  DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL63' '
         DC    X'B9'
DTAZ25#  DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL2' '
         DC    CL17'ERSTELLUNGSDATUM '
LERDAT#  DC    CL10' '
         DC    CL15' '
         DC    CL8'VALUTA  '
VALUTA#  DC    CL10' '
         DC    C' '
         DC    X'B9'
DTAZ26#  DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL63' '
         DC    X'B9'
DTAZ27#  DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL63' '
         DC    X'B9'
DTAZ28#  DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL2' '
         DC    CL17'ZEICHENDICHTE BPI'
         DC    CL39' '
DENSITY  DC    CL4' '
         DC    C' '
         DC    X'B9'
DTAZLG#  EQU   *-DTAZ28#
ADDRNO   EQU   (*-DTAZ09#)/DTAZLG#
DTAZ29#  DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL63' '
         DC    X'B9'
DTAZ30#  DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL63' '
         DC    X'B9'
DTAZ31#  DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL2' '
         DC    CL12'BANKLEITZAHL'
         DC    CL38' '
BLZ1#    DC    CL3' '
         DC    C' '
BLZ2#    DC    CL3' '
         DC    C' '
BLZ3#    DC    CL2' '
         DC    C' '
         DC    X'B9'
DTAZ32#  DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL63' '
         DC    X'B9'
DTAZ33#  DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL63' '
         DC    X'B9'
DTAZ34#  DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL2' '
         DC    CL11'KONTONUMMER'
         DC    CL39' '
KTONR#   DC    CL10' '
         DC    C' '
         DC    X'B9'
DTAZ35#  DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL2' '
         DC    CL23'BASF AKTIENGESELLSCHAFT'
         DC    CL38' '
         DC    X'B9'
DTAZ36#  DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL63' '
         DC    X'B9'
DTAZ37#  DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL63' '
         DC    X'B9'
DTAZ38#  DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL63' '
         DC    X'B9'
DTAZ39#  DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL63' '
         DC    X'B9'
DTAZ40#  DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL2' '
         DC    CL23'.......................'
         DC    CL38' '
         DC    X'B9'
DTAZ41#  DS    0CL66
         DC    C' '
         DC    X'B9'
         DC    CL63' '
         DC    X'B9'
FOOTNO#  EQU   (*-DTAZ35#)/DTAZLG#
DTAZ60#  DS    0CL66
         DC    C' '
         DC    X'B2'
         DC    63X'20'
         DC    X'B3'
./ ADD  NAME=DTAREC
** TITLE   BESCHREIBUNG DATENTRAEGER-AUSTAUSCH-SATZ
** OWNER   128.FRANZ
** LCHNG   11/28/83 14:11:04   Z227128 FRANZ
         MACRO
&NM      DTAREC &TYPE=DEF,&D=DA
         LCLC  &N
&N       SETC  '&NM'
         AIF   ('&TYPE' NE 'DSECT').DEF
&N       DSECT
&N       SETC  ' '
.DEF     ANOP
         SPACE 3
*        SATZBESCHREIBUNG DER DATENTRAEGER-AUSTAUSCH-DATEI
*
&N       DS    0D
&D.REC   EQU   *
&D.DSN    DC    CL44' '        DATASET NAME
&D.KEYMOD DC    XL4'0'         KEY MODIFIER
&D.ABLS   DC    CL8' '         ABLAUFSEITE
&D.SBN    DS    0CL21          SBN, DER DIESEN SATZ ANLEGT
&D.SBNNM  DC    CL13' '        NAME DES SBN
&D.SBNTEL DC    CL8' '         TEL-NR DES SBN
&D.EMPF   DS    0CL245         EMPFAENGER DES DT
&D.EMPFNM DC    CL49' '        NAME DES EMPFAENGERS
&D.EMPFZ1 DC    CL49' '        ADRESS-ZUSATZ
&D.EMPFZ2 DC    CL49' '        ADRESS-ZUSATZ
&D.EMPFST DC    CL49' '        STRASSE
&D.EMPFO  DC    CL49' '        ORT
*
          DC    CL6' '         FREE SPACE
&D.LISTNR DC    CL10' '        LISTENNUMMER
&D.BLZ    DC    CL8' '         BANKLEITZAHL
&D.KTONR  DC    CL10' '        KONTONUMMER
          DC    CL16' '        FREE SPACE
*
&D.BETR1  DC    CL49' '        BETREFF 1. TEIL
&D.BETR2  DC    CL49' '        BETREFF 2. TEIL
&D.BANDTX DC    CL45' '        BAND-TEXT
&D.VSART  DC    CL49' '        VERSAND-ART
&D.VSWEG  DC    CL49' '        VERSAND-WEG
&D.VSHW   DC    CL49' '        VERSAND-HINWEIS
*
&D.SGE    DC    CL2' '         SACHGEBIETS-INDEX
&D.SGEB   DC    CL45' '        SACHGEBIETS-BESCHREIBUNG
*
&D.REFLTR DC    CL15' '        REFERATS-LEITER
&D.PRLTR  DC    CL15' '        PROJEKT-LEITER
*
&D.FLAG   DC    X'00'          FLAG-BYTE
&D.AUTH   EQU   X'10'          DAUERAUFTRAG
*
&D.AUTHL  DS    0CL16
&D.AUTHS  DC    CL3' '         SBN, WHO CHANGES DAFLAG
&D.AUTHD  DC    CL8' '         CHANG DATE
&D.AUTHT  DC    CL5' '         CHNG TIME
*
&D.ARCHKZ DC    C' '           ARCHIVIERUNGS KENNZEICHEN
          DC    CL12' '        FREE SPACE
*
&D.LOG    DS    0CL20
&D.LOGJ   DC    CL8' '         JOB, WHICH WRITES DTA
&D.LOGD   DC    CL8' '         DAY, DTA IS WRITTEN
&D.LOGT   DC    CL5' '         TIME, DTA IS WRITTEN
*
&D.CHNG   DS    0CL60' '
&D.UID    DC    CL7' '         USERID
&D.CNGDAT DC    CL8' '         CHANGE DATE
&D.CNGTIM DC    CL5' '         CHANGE TIME
&D.CHNGLE EQU   *-&D.CHNG      LENGTH OF ONE ENTRY
&D.CHNGR  DC    2CL20' '       SPACE FOR 2 CHANGE-ENTRIES
&D.CHNGLT EQU   *-&D.CHNG      LENGTH OF TOTAL ENTRIES
&D.CHNGEN EQU   &D.CHNGLT/&D.CHNGLE  NO OF ENTRIES
*
&D.LGTH   EQU   *-DADSN        LENGTH OF DTAREC
         SPACE 3
***************************************************************
         MEND
./ ADD  NAME=DTARECO
** TITLE   BESCHREIBUNG DATENTRAEGER-AUSTAUSCH-SATZ
** OWNER   128.FRANZ
** LCHNG   11/08/83 14:15:02   Z228496 THIESEN
         MACRO
&NM      DTARECO &TYPE=DEF,&D=DO
         LCLC  &N
&N       SETC  '&NM'
         AIF   ('&TYPE' NE 'DSECT').DEF
&N       DSECT
&N       SETC  ' '
.DEF     ANOP
         SPACE 3
*        SATZBESCHREIBUNG DER DATENTRAEGER-AUSTAUSCH-DATEI
*
&N       DS    0D
&D.REC   EQU   *
&D.DSN    DC    CL44' '        DATASET NAME
&D.KEYMOD DC    XL4'0'         KEY MODIFIER
&D.ABLS   DC    CL8' '         ABLAUFSEITE
&D.SBN    DS    0CL21          SBN, DER DIESEN SATZ ANLEGT
&D.SBNNM  DC    CL13' '        NAME DES SBN
&D.SBNTEL DC    CL8' '         TEL-NR DES SBN
&D.EMPF   DS    0CL245         EMPFAENGER DES DT
&D.EMPFNM DC    CL49' '        NAME DES EMPFAENGERS
&D.EMPFZ1 DC    CL49' '        ADRESS-ZUSATZ
&D.EMPFZ2 DC    CL49' '        ADRESS-ZUSATZ
&D.EMPFST DC    CL49' '        STRASSE
&D.EMPFO  DC    CL49' '        ORT
*
&D.BETR1  DC    CL49' '        BETREFF 1. TEIL
&D.BETR2  DC    CL49' '        BETREFF 2. TEIL
&D.BANDTX DC    CL45' '        BAND-TEXT
&D.VSART  DC    CL49' '        VERSAND-ART
&D.VSWEG  DC    CL49' '        VERSAND-WEG
&D.VSHW   DC    CL49' '        VERSAND-HINWEIS
*
&D.SGE    DC    CL2' '         SACHGEBIETS-INDEX
&D.SGEB   DC    CL45' '        SACHGEBIETS-BESCHREIBUNG
*
&D.REFLTR DC    CL15' '        REFERATS-LEITER
&D.PRLTR  DC    CL15' '        PROJEKT-LEITER
*
&D.FLAG   DC    X'00'          FLAG-BYTE
&D.AUTH   EQU   X'10'          DAUERAUFTRAG
*
&D.AUTHL  DS    0CL16
&D.AUTHS  DC    CL3' '         SBN, WHO CHANGES DAFLAG
&D.AUTHD  DC    CL8' '         CHANG DATE
&D.AUTHT  DC    CL5' '         CHNG TIME
*
&D.ARCHKZ DC    C' '           ARCHIVIERUNGS KENNZEICHEN
          DC    CL13' '        FREE SPACE
*
&D.LOG    DS    0CL20
&D.LOGJ   DC    CL7' '         JOB, WHICH WRITES DTA
&D.LOGD   DC    CL8' '         DAY, DTA IS WRITTEN
&D.LOGT   DC    CL5' '         TIME, DTA IS WRITTEN
*
&D.CHNG   DS    0CL60' '
&D.UID    DC    CL7' '         USERID
&D.CNGDAT DC    CL8' '         CHANGE DATE
&D.CNGTIM DC    CL5' '         CHANGE TIME
&D.CHNGLE EQU   *-&D.CHNG      LENGTH OF ONE ENTRY
&D.CHNGR  DC    2CL20' '       SPACE FOR 2 CHANGE-ENTRIES
&D.CHNGLT EQU   *-&D.CHNG      LENGTH OF TOTAL ENTRIES
&D.CHNGEN EQU   &D.CHNGLT/&D.CHNGLE  NO OF ENTRIES
*
&D.LGTH   EQU   *-DODSN        LENGTH OF DTAREC
         SPACE 3
***************************************************************
         MEND
./ ADD  NAME=DTAWORK
         DS    0F
ATABNO   DC    F'0'           NO OF TABELEMENTS
         SPACE
ASTTAB   DC    48F'0'         SPACE FOR 16 TABELEMENTS
         SPACE
ATABELG  EQU   (*-ASTTAB)/16
         SPACE 3
ERRLINE  DC    CL66' '
         SPACE 3
PARMDCB  DCB   DDNAME=DTAPARM,DSORG=PS,MACRF=GM,                       *
               LRECL=80
         SPACE 3
LISTDCB  DCB   DDNAME=DTALIST,DSORG=PS,MACRF=PM,                       *
               RECFM=FBA,LRECL=66,BLKSIZE=3102
./ ADD  NAME=DVT
         MACRO
         DVT
*
*        THIS MACRO DEFINES THE FIELDS USED WITH -DEVTYPE- MACRO
*
DVTDDNAM DS    CL8                     DDNAME
*
*                                      FIELDS FILLED BY MACRO
*
         DS    0F
DVTDEVCD DS    XL1                         DEVICE CODE
DVTOPTFT DS    XL1                         OPT. FEATURES
DVTDEVCL DS    XL1                         DEVICE CLASS
DVTMT    EQU   X'80'                       MAGNETIC TAPE DEVICES
DVTTP    EQU   X'40'                       COMMUNICATIONS EQUIPMENT
DVTDA    EQU   X'20'                       DIRECT ACCESS DEVICES
DVTGR    EQU   X'10'                       GRAPHICS EQUIPMENT
DVTUR    EQU   X'08'                       UNIT RECORD EQUIPMENT
DVTUNTYP DS    XL1                         UNIT TYPE
*
DVTBLKSI DS    F                           MAXIMUM BLOCK LENGTH
*
*              THESE FIELDS ARE MEANINGFULL ONLY IF -DEVTAB- CODED
*
DVTNCYL  DS    H                           NUMBER OF CYLINDERS(->CIND)
DVTNTCL  DS    H                           NUMBER OF TRACKS PER CYL
*
DVTTRKSI DS    H                           TRACK LENGTH
DVTABKOH DS    0H                          OVERHEAD ANY BLOCK(->OIND)
DVTBLKOH DS    XL1                         OVERHEAD PER BLOCK
DVTLBKOH DS    XL1                         OVERHEAD FOR LAST BLOCK
*
DVTKEYOH DS    XL1                         SUBTRACT IF UNKEYED
DVTIND   DS    XL1                         INDICATORS
DVTCIND  EQU   X'80'                       NUMBER CYLS INVALID
DVTOIND  EQU   X'08'                       OVERHEAD FOR ANY BLOCK
DVTTIND  EQU   X'01'                       TOLERANCE FACTOR APPLIES
DVTTFACT DS    H                           TOLERANCE FACTOR(->TIND)
         MEND
./ ADD  NAME=DWCC
         MACRO
&NM      DWCC  &ATT
         LCLC  &TAB(8)
         LCLA  &CNT,&INX,&TABINX
         LCLB  &A,&RO,&RE
&TAB(1)  SETC  'C0'
&TAB(2)  SETC  'C1'
&TAB(3)  SETC  'C2'
&TAB(4)  SETC  'C3'
&TAB(5)  SETC  'C4'
&TAB(6)  SETC  'C5'
&TAB(7)  SETC  'C6'
&TAB(8)  SETC  'C7'
&CNT     SETA  N'&ATT
.CLOOP   ANOP
&INX     SETA  &INX+1
         AIF   (&INX GT &CNT).GEN
         AIF   ('&ATT(&INX)' EQ 'ALARM').ALARM
         AIF   ('&ATT(&INX)' EQ 'REST').REST
         AIF   ('&ATT(&INX)' EQ 'RESET').RESET
         AGO   .ERR1
.ALARM   ANOP
         AIF   (&A).ERR2
&A       SETB  1
&TABINX  SETA  &TABINX+4
         AGO   .CLOOP
.REST    ANOP
         AIF   (&RO).ERR2
&RO      SETB  1
&TABINX  SETA  &TABINX+2
         AGO   .CLOOP
.RESET   ANOP
         AIF   (&RE).ERR2
&RE      SETB  1
&TABINX  SETA  &TABINX+1
         AGO   .CLOOP
.GEN     ANOP
&NM      DC    X'&TAB(&TABINX+1)' DISPLAY WRITE CONTROL CHARACTER
         MEXIT
.ERR1    MNOTE 8,'UNKNOWN OPERAND'
         MEXIT
.ERR2    MNOTE 4,'AT LEAST ONE OPERAND DUPLICATE'
         AGO   .CLOOP
         MEND
./ ADD  NAME=EMDB01LI
          SPACE 3
*         EMIS DATENBANK SEGMENT-BESCHREIBUNG
*              LISTEN SEGMENT
*
EMLISTE  DS    0D
         DS    H             SEGMENT LAENGE
EMLIKEY  DS    CL2           SEGMENT KEY   IMMER 'LI'
EMLI#OLD DS    CL6           ALTE LISTEN NUMMER
EMLIKZ   DS    C             KENNZEICHEN  'X' ==> INAKTIVIERT
EMLITEXT DS    CL80          LISTEN TEXT
EMLITERM DS    CL8           TERMIN VERSCHLUESSELUNG
EMLIFORM DS    CL4           PAPIER FORMAT NUMMER
EMLIBGL# DS    CL2           ANZAHL LISTEN BEGLEITSCHEINE
EMLIERST DS    CL6           DATUM DER ERSTAUFNAHME (TTMMJJ)
EMLILAST DS    CL6           DATUM DER LETZTEN AENDERUNG
EMLIINAC DS    CL6           DATUM DER INAKTIVIERUNG
         DS    CL25          FILLER
EMLIAEND DS    XL2           AENDERUNGS-KENNZEICHEN
./ ADD  NAME=EMDB01SB
         SPACE 3
*
*        EMIS DATENBANK SEGMENT-BESCHREIBUNG
*             SACHBEARBEITER SEGMENT
*
EMSACHB  DS    0D
         DS    H               SEGMENT LAENGE
EMSBKEY  DS    CL2             SEGMENT TYP    IMMER 'SB'
EMSBZNM  DS    CL20            ZUNAME
EMSBVNM  DS    CL20            VORNAME
EMSBBAU  DS    CL4             BAU-NUMMER
EMSBZIM  DS    CL4             ZIMMER-NUMMER
EMSBTEL  DS    CL8             TELEFON NUMMER
EMSBTELT DS    CL1             TELEFON ANSCHLUSS-TYP
EMSBORG  DS    CL12            ORGANISCHE EINHEIT
EMSBKST  DS    CL5             KOSTENSTELLE
EMSBUAB  DS    CL1             UNTERABTEILUNG
EMSBFKT  DS    CL4             FUNKTION - BERUF
EMSBSKZ  DS    CL2             SONSTIGE KENNZEICHEN
EMSBKSL  DS    CL1             KSL-BELEG
EMSBFACH DS    CL3             FACH-NUMMER
EMSBPNR  DS    CL8             PERSONAL NUMMER + KTR
EMSBERST DS    CL6             DATUM DER ERSTAUFNAHME
EMSBINAC DS    CL6             DATUM DER INAKTIVIERUNG
EMSBLAST DS    CL6             DATUM DER LETZTEN AENDERUNG
         DS    CL33
EMSBAEND DS    XL2             AENDERUNGS-KENNZEICHEN
./ ADD  NAME=EMDB0101
         SPACE 3
*
*        EMIS DATEN-BANK-BESCHREIBUNG
*             ROOT-STAMMSEGMENT
*
EMSTAMM  DS    0D
         DS    H             SEGMENT LAENGE
EMSTTYP  DS    CL3           SEGMENT-TYP
EMSTKEY  DS    CL44          SEGMENT-KEY
         DS    CL1           FILLER
./ ADD  NAME=EMDB0102
         SPACE 3
*
*        EMIS DATENBANK SEGMENT-BESCHREIBUNG
*             VERWEIS-SEGMENT
*
EMVERW   DS    0D
EMVWTYP  DS    CL3          SEGMENT TYP
EMVWKEY  DS    CL44         SEGMENT KEY
./ ADD  NAME=EMDB0106
         SPACE 3
*
*        EMIS DATENBANK BESCHREIBUNG
*             VERWEIS-BESCHREIBUNG  LISTE -> SACHBEARBEITER
*
EMLISSB  DS    0D
         DS    H             SEGMENT LAENGE
EMLSKEY  DS    CL2           SEGMENT KEY    IMMER 'LS'
EMLSEXEM DS    CL1           EXEMPLAR
EMLSAUSD DS    CL2           ANZAHL AUSDRUCKE
EMLSSCHL DS    CL1           SCHLUESSEL
EMLSHW   DS    CL2           BEARBEITUNGS HINWEIS (VERSCHLUESSELT)
EMLSFACH DS    CL1           FACH
         DS    CL33          FILLER
./ ADD  NAME=EMEMP
         MACRO
&NM      EMEMP &TYPE=DSECT
         LCLC  &N
&N       SETC  '&NM'
         AIF   ('&TYPE' NE 'DSECT').DEF
&N       DSECT
&N       SETC  ' '
.DEF     ANOP
&N       DS    0D
*
*   BESCHREIBUNG FUER EMPFAENGER
*     (BEARBEITUNGS-HW, FACH-KZ USW.)
*
BSEGLGTH DC    XL2'00'
BSEGKEY  DC    CL2' '
EXEMPLAR DC    C' '
ANZAUSDR DC    CL2' '
SCHL     DC    C' '
BHINWEIS DC    CL2' '
BFACH    DC    C' '
         DC    CL39' '
         MEND
./ ADD  NAME=EMLIS
         MACRO
&NM      EMLIS &TYPE=DSECT
         LCLC  &N
&N       SETC  '&NM'
         AIF   ('&TYPE' NE 'DSECT').DEF
&N       DSECT
&N       SETC  ' '
.DEF     ANOP
&N       DS    0D
*
*   BESCHREIBUNG FUER LISTEN-SEGMENT
*
LGTH     DC    XL2'00'
LKEY     DC    C'LI'
LAENDKZ  DC    XL2'00'
LIDW     DC    C' '
LRX      DC    5C' '
LAUFN    DC    CL6' '
LSTONL   DC    CL6' '
LSTOFL   DC    CL6' '
LINAKTIV DC    CL6' '
         SPACE
LFILL1   DC    CL12' '
LCOMKZ   DC    C' '
LMLTKZ   DC    C' '
LISTBZ   DC    CL80' '
TERMINL  DC    CL8' '
TERMINC  DC    CL8' '
FORMNR   DC    CL4' '
ANZBGL   DC    PL2'0'
SVKZ     DC    C' '
BURST    DC    C' '
FCB      DC    CL4' '
FLASH    DC    CL4' '
FLCNT    DC    PL2'0'
MODIFY   DC    CL4' '
MODCNT   DC    PL1'0'
UCS      DC    CL4' '
OPTCD    DC    CL1' '
         SPACE
DSN      DC    CL44' '
CHARS    DC    4CL4' '
COPY01   DC    PL2'0'
COPY02   DC    8PL2'0'
DRART    DC    CL5' '
PARM     DC    CL5' '
DRHW     DC    CL35' '
OPKZ     DC    CL2' '
LIST#O   DC    CL6' '
LKZ      DC    C' '
REMOTEKZ DC    C' '
         MEND
./ ADD  NAME=EMMLT
         MACRO
&NM      EMMLT &TYPE=DSECT
         LCLC  &N
&N       SETC  '&NM'
         AIF   ('&TYPE' NE 'DSECT').DEF
&N       DSECT
&N       SETC  ' '
.DEF     ANOP
&N       DS    0D
*
*   BESCHREIBUNG FUER MULT-NAME, ABLAUFSEITE,
*     ARBEITSNUMMER UND EMPFAENGER-NUMMER
*
MLGTH    DC    XL2'00'
MSEGTYP  DC    CL3' '
MSEGKEY  DC    CL44' '
         DC    C' '
MSEGL    DC    XL2'00'
MSEGKEY2 DC    CL2' '
MVERWBSC DC    CL46' '
         MEND
./ ADD  NAME=EMPFREC
** TITLE   INTERNE EMPFEHLUNG
** OWNER   SCHAPITZ
** LCHNG   02/28/84 12:06:13   Z228554 SCHAPITZ
EMPFREC  DSECT
EMPFSA   DS    C             SATZART : V=VORTRAG, E=EMPFEHLUNG
EMPF#    DS    CL3           EMPFEHLUNGS-NUMMER
EMPFTEXT DS    CL50          TEXT DER EMPFEHLUNG
EMPFGEN  DS    CL5           GENEHMIGUNSDATUM
EMPFKZG  DS    0CL5          KENNZEICHEN
EFILL1   DS    C
EMPFKZF  DS    C             KENNZEICHEN FORSCHUNG (K,N ODER BLANK)
EMPFKZ   DS    CL2           KENNZEICHEN (KAUF, MIETE ETC.)
EFILL2   DS    C
EMPFBEG  DS    CL10          DATUM DER ERSTEN KOSTEN
EMPFKST1 DS    0CL8          1. EINMALIGE KOSTEN
EMPFK1V  DS    C             VORZEICHEN DIESER KOSTEN
EMPFK1BT DS    CL7           BETRAG DIESER KOSTEN
EMPFKST2 DS    0CL8          1. MONATLICHE KOSTEN
EMPFK2V  DS    C             VORZEICHEN DIESER KOSTEN
EMPFK2BT DS    CL7           BETRAG DIESER KOSTEN
EMPFKOMP DS    CL12          BETROFFENE KOMPONENTE (RESOURCE)
EMPFJ1   DS    0CL10         KOSTENDIFFERENZ 1. FOLGEJAHR
EMPF1V   DS    C             VORZEICHEN DIESER KOSTEN
EMPF1BT  DS    CL9           BETRAG DIESER KOSTEN
EMPFJ2   DS    0CL10         KOSTENDIFFERENZ 2. FOLGEJAHR
EMPF2V   DS    C             VORZEICHEN DIESER KOSTEN
EMPF2BT  DS    CL9           BETRAG DIESER KOSTEN
EMPFJ3   DS    0CL10         KOSTENDIFFERENZ 3. FOLGEJAHR
EMPF3V   DS    C             VORZEICHEN DIESER KOSTEN
EMPF3BT  DS    CL9           BETRAG DIESER KOSTEN
EMPFWERT DS    CL10          ANSCHAFFUNGSWERT
EMPFFILL DS    CL12
./ ADD  NAME=EMSBN
         MACRO
&NM      EMSBN &TYPE=DSECT
         LCLC  &N
&N       SETC  '&NM'
         AIF   ('&TYPE' NE 'DSECT').DEF
&N       DSECT
&N       SETC  ' '
.DEF     ANOP
&N       DS    0D
*
*   BESCHREIBUNG FUER SBN-SEGMENT
*
ELGTH    DC    XL2'00'
ESEGKEY  DC    C'SB'
EAENDKZ  DC    XL2'00'
ZUNAME   DC    CL20' '
VORNAME  DC    CL20' '
BAUNR    DC    CL4' '
ZIMMERNR DC    CL4' '
TELNR    DC    CL8' '
TELANTYP DC    C' '
ORGEIN   DC    CL12' '
KST      DC    CL5' '
UNTERABT DC    C' '
FXTBERUF DC    CL4' '
SONSTKZ  DC    CL2' '
KSLBELEG DC    C' '
FACHNR   DC    CL3' '
PERSNR   DC    CL8' '
EAUFN    DC    CL6' '
EINAKTIV DC    CL6' '
ESTAND   DC    CL6' '
EORT     DC    CL10' '
         MEND
./ ADD  NAME=FAIRDS
         MACRO
&LABEL   FAIRDS &DSECT=,&RTN=ALL
         LCLA  &SWA1
         LCLB  &SWB1,&SWBA,&SWBO,&SWBL,&SWBM,&SWBR,&SWBC,&SWBY
.*             DETERMINE WHICH CONTROL SECTION IS GOING TO BE USED
         AIF   ('&DSECT' EQ 'NO').CSECT
         AIF   ('&DSECT' EQ 'YES').DSECT
         AIF   ('&DSECT' NE '').TERM1
.DSECT   ANOP
&SWB1    SETB  1
.CSECT   ANOP
.*             NOW VALIDATE & DETERMINE DESIRED ROUTINE
.NULS    ANOP
         AIF   ('&RTN' EQ '').ALL
         AIF   ('&RTN'(1,1) NE '(').ONLY1
.INCNTR1 ANOP
         AIF   (&SWA1 EQ 5).BEGIN
         AIF   (&SWBY).BEGIN
&SWA1    SETA  &SWA1+1
         AIF   ('&RTN(&SWA1)' EQ '').INCNTR1
.CHK     ANOP
         AIF   ('&RTN(&SWA1)' EQ 'ALL').ALL
         AIF   ('&RTN(&SWA1)' EQ 'O').OPEN
         AIF   ('&RTN(&SWA1)' EQ 'L').LOCATE
         AIF   ('&RTN(&SWA1)' EQ 'M').MODULE
         AIF   ('&RTN(&SWA1)' EQ 'R').RECORD
         AIF   ('&RTN(&SWA1)' EQ 'C').CLOSE
         AGO   .TERM2
.*             ONLY ONE ROUTINE IS SELECTED
.ONLY1   ANOP
&SWA1    SETA  1
&SWBY    SETB  1
         AGO   .CHK
.*             ALL OF ROUTINES ARE SELECTED OR DEFAULT IS USING
.ALL     ANOP
&SWBA    SETB  1
         AGO   .BEGIN
.*             MASTROPN RESULT AREA IS SELECTD
.OPEN    ANOP
         AIF   (&SWBO).INCNTR1
&SWBO    SETB  1
         AGO   .INCNTR1
.*             MASTRLOC RESULT AREA IS SELECTED
.LOCATE  ANOP
         AIF   (&SWBL).INCNTR1
&SWBL    SETB  1
         AGO   .INCNTR1
.*             MASTRMOD RESULT AREA IS SELECTED
.MODULE  ANOP
         AIF   (&SWBM).INCNTR1
&SWBM    SETB  1
         AGO   .INCNTR1
.*             MASTREC RESULT AREA IS SELECTED
.RECORD  ANOP
         AIF   (&SWBR).INCNTR1
&SWBR    SETB  1
         AGO   .INCNTR1
.*             MASTRCLS RESULT AREA IS SELECTED
.CLOSE   ANOP
         AIF   (&SWBC).INCNTR1
&SWBC    SETB  1
         AGO   .INCNTR1
.*             NOW BEGIN TO EXPAND MACRO ACCORDING TO SELECTION
.BEGIN   ANOP
         AIF   (&SWBA).OPN
         AIF   (NOT &SWBO).BEGIN1
.*       OPEN RESULT AREA
.OPN     ANOP
         SPACE 1
***********************************************************************
*****    M A S T R O P N    PROCESSING  RESULT  AREA              *****
***********************************************************************
         SPACE 1
         AIF   (&SWB1).DSECT1
OPENRES  DS    0D                                                  @ADR
         AGO   .BSECT1
.DSECT1  ANOP
OPENRES  DSECT                                                     @ADR
.BSECT1  ANOP
         DS    0CL120     LIBRARIAN/FAIR/VS MASTROPN RESULT AREA   @ADR
OPENRET  DS    CL1        PROCESSING RETURN CODE                   @ADR
OPENREA  DS    CL1        OPEN FAILURE REASON CODE                 @ADR
OPENTYPE DS    CL1        TYPE OF MASTER FILE THAT HAS BEEN OPENED @ADR
OPENARC  DS    CL1        ARCHIE FILE INDICATOR                    @ADR
OPENPASS DS    CL1        PASSWORD REQUIREMENT INDICATOR           @ADR
OPENSEQ  DS    CL1        IMPLICIT UPDATING INDICATOR              @ADR
OPENGPO  DS    CL1        GROUP PROCESSING OPTION INDICATOR        @ADR
OPENRSV1 DS    CL1        RESERVED                                 @ADR
OPENCOMX DS    CL1        COMPRESS STATUS FOR FILE                 @ADR
OPENRSV6 DS    CL5        RESREVED                                 @ADR
OPENMCD  DS    CL1        PROD 2 MODULE ACCESS INDICATOR           @ADR
OPENRSV2 DS    CL2        RESERVED                                 @ADR
OPENLEVS DS    CL3        NO. OF LEVELS THAT CAN BE STORED         @ADR
OPENB1US DS    F          NO. OF BYTES FROM 1ST BUFFER AREA USED   @ADR
OPENB1LT DS    F          NO. OF BYTES FROM 1ST BUFFER AREA UNUSED @ADR
OPENB2US DS    F          NO. OF BYTES FROM 2ND BUFFER AREA USED   @ADR
OPENB2LT DS    F          NO. OF BYTES FROM 2ND BUFFER AREA UNUSED @ADR
OPENRSV3 DS    XL16       RESERVED                                 @ADR
OPENDSN  DS    CL44       MASTER FILE DSNAME                       @ADR
OPENVERS DS    CL10       DATE AND TIME OF TAPE MASTER CREATION    @ADR
OPENRSV4 DS    CL4        RESERVED                                 @ADR
OPENVOL  DS    CL6        VOLUME SERIAL NUMBER OF MASTER FILE      @ADR
OPENRSV5 DS    CL4        RESERVED                                 @ADR
OPEN#LEN EQU   *-OPENRES  LENGTH OF RESULT AREA                    @ADR
***********************************************************************
         AIF   (NOT &SWB1).END
&SYSECT  CSECT                                                     @ADR
.END     ANOP
         SPACE 2
.*       LOCATE RESULT AREA
.BEGIN1  ANOP
         AIF   (&SWBA).LOC
         AIF   (NOT &SWBL).BEGIN2
.LOC     ANOP
         SPACE 1
***********************************************************************
*****    M A S T R L O C    PROCESSING  RESULT  AREA              *****
***********************************************************************
         SPACE 1
         AIF   (&SWB1).DSECT2
LOCRES   DS    0D                                                  @ADR
         AGO   .BSECT2
.DSECT2  ANOP
LOCRES   DSECT                                                     @ADR
.BSECT2  ANOP
         DS    0CL72      LIBRARIAN/FAIR/VS MASTRLOC RESULT AREA   @ADR
LOCRET   DS    CL1        MASTRMOD RETURN CODE                     @ADR
LOCSTAT  DS    CL1        MODULE TEST OR PROD STATUS               @ADR
LOCARC   DS    CL1        ARCHIE STATUS                            @ADR
LOCUPD   DS    CL1        UPDATE INDICATOR                         @ADR
LOCRSV1  DS    CL8        RESERVED                                 @ADR
LOCNAME  DS    CL8        MODULE NAME                              @ADR
LOCRSV2  DS    CL4        RESERVED                                 @ADR
LOCPASS  DS    CL4        MODULE PASSWORD                          @ADR
LOCRSV3  DS    CL4        RESERVED                                 @ADR
LOCVERS  DS    CL12       DATE/TIME OF MOST RECENT MODULE          @ADR
LOCRSV4  DS    CL4        RESERVED                                 @ADR
LOCLEVS  DS    CL3        NUMBER OF LEVELS AVAILABLE               @ADR
LOCARCA  DS    CL5        ABSOLUTE LEVEL NUMBER OF OLDEST          @ADR
LOCDARC  DS    CL12       DATE/TIME OF OLDEST LEVEL                @ADR
LOCRSV5  DS    CL4        RESERVED                                 @ADR
LOC#LEN  EQU   *-LOCRES   LENGTH OF RESULT AREA                    @ADR
***********************************************************************
         AIF   (NOT &SWB1).END1
&SYSECT  CSECT                                                     @ADR
.END1    ANOP
         SPACE 2
.*       MODULE RESULT AREA
.BEGIN2  ANOP
         AIF   (&SWBA).MOD
         AIF   (NOT &SWBM).BEGIN3
.MOD     ANOP
         SPACE 1
***********************************************************************
*****    M A S T R M O D    PROCESSING  RESULT  AREA              *****
***********************************************************************
         SPACE 1
         AIF   (&SWB1).DSECT3
MODRES   DS    0D                                                  @ADR
         AGO   .BSECT3
.DSECT3  ANOP
MODRES   DSECT                                                     @ADR
.BSECT3  ANOP
         DS    0CL800     LIBRARIAN/FAIR/VS MASTRMOD RESULT AREA   @ADR*
                        + = SELECTED LEVEL, * = MOST CURRENT LEVEL @ADR
MODRET   DS    CL1        MASTRMOD RETURN CODE                     @ADR
MODSTAT1 DS    CL1      * MODULE TEST OR PROD STATUS               @ADR
MODARC   DS    CL1        ARCHIE STATUS                            @ADR
MODUPD   DS    CL1      * UPDATE INDICATOR                         @ADR
MODRSV1  DS    CL1        RESERVED                                 @ADR
MODCOMX  DS    CL1        COMPRESS STATUS FOR MODULE               @ADR
MODRSV32 DS    CL6        RESREVED                                 @ADR
MODNAME  DS    CL8        MODULE NAME                              @ADR
MODRSV2  DS    CL4        RESERVED                                 @ADR
MODPASS  DS    CL4      * MODULE PASSWORD                          @ADR
MODRSV3  DS    CL4        RESERVED                                 @ADR
MODVERS  DS    CL12     * DATE/TIME OF MOST RECENT MODULE          @ADR
MODRSV4  DS    CL2        RESERVED                                 @ADR
MODADD   DS    CL6        DATE MODULE WAS ADDED TO MASTER          @ADR
MODRSV5  DS    CL8        RESERVED                                 @ADR
MODSTAT2 DS    CL1      + STATUS OF MODULE BEING PROCESSED         @ADR
MODPRTR  DS    CL1      + PRINTER MODULE FLAG                      @ADR
MODCOPY  DS    CL1      * COPIED MODULE FLAG                       @ADR
MODABSLV DS    CL5        ABSOLUTE LEVEL # OF MODULE               @ADR
MODCOPYD DS    CL6      * DATE MODULE WAS COPIED TO MASTER         @ADR
MODRSV6  DS    CL8        RESERVED                                 @ADR
MODOSDOS DS    CL1        OS OR DOS FLAG                           @ADR
MODRSV7  DS    CL15       RESERVED                                 @ADR
MODVERS2 DS    CL12     + DATE/TIME FOR MODULE PROCESSED           @ADR
MODRSV8  DS    CL2        RESERVED                                 @ADR
MODPASS2 DS    CL4      + PASSWORD OF MODULE BEING PROCESSED       @ADR
MODRSV9  DS    CL4        RESERVED                                 @ADR
MODACS   DS    CL5        NUMBER OF ACCESSES                       @ADR
MODACSD  DS    CL6        DATE OF THE LAST ACCESS                  @ADR
MODRSV33 DS    CL8        RESERVED                                 @ADR
MODUPDNO DS    CL5        NUMBER OF UPDATES                        @ADR
MODRSV34 DS    CL44       RESERVED                                 @ADR
MODDESC  DS    CL30     + MODULE DESCRIPTION                       @ADR
MODRSV10 DS    CL50       RESERVED                                 @ADR
MODPGMR  DS    CL15     + PROGRAMMER NAME                          @ADR
MODRSV11 DS    CL5        RESERVED                                 @ADR
MODRSV12 DS    CL3        RESERVED                                 @ADR
MODRECS  DS    CL5      + NUMBER OF RECORDS, EBCDIC                @ADR
MODLANG  DS    CL3      + MODULE LANGUAGE                          @ADR
MODBLKS  DS    CL3        NUMBER OF BLOCKS FOR THIS MODULE         @ADR
MODRSV13 DS    CL10       RESERVED                                 @ADR
MODRSV14 DS    CL2        RESERVED                                 @ADR
MODSQOPT DS    CL1        RESEQ/NORESEQ FLAG                       @ADR
MODRSV15 DS    CL1        RESERVED                                 @ADR
MODSEQ1  DS    CL2      + STARTING COLUMN OF SEQUENCE NUMBERS      @ADR
MODRSV16 DS    CL1        RESERVED                                 @ADR
MODSEQ2  DS    CL1      + LENGTH OF SEQUENCE NUMBERS               @ADR
MODRSV17 DS    CL4        RESERVED                                 @ADR
MODSEQ3  DS    CL4      + STARTING VALUE OF SEQUENCE NUMBERS       @ADR
MODRSV18 DS    CL4        RESERVED                                 @ADR
MODSEQ4  DS    CL4      + INCREMENT OF SEQUENCE NUMBERS            @ADR
MODRSV19 DS    CL4        RESERVED                                 @ADR
MODCBCHK DS    CL1      + COBOL SYNTAX CHECKER FLAG. 1 = CHECKED   @ADR
MODRSV20 DS    CL1        RESERVED                                 @ADR
MODCBLEV DS    CL1      + LEVEL OF COBOL SYNTAX CHECKER USED       @ADR
MODCBOPT DS    CL1      + SYNTAX CHECK OUTPUT SUPPRESSION FLAG     @ADR
MODCBEXP DS    CL1      + COBOL COPY EXPANSION OPTION FLAG         @ADR
MODRSV21 DS    CL1        RESERVED                                 @ADR
MODCOPDF DS    CL1      + STATUS OF COPYDD OPTION, 0-OFF/1-ON      @ADR
MODRSV40 DS    CL6        RESERVED                                 @ADR
MODJCL   DS    CL1        JCL OPTION FLAG                          @ADR
MODJOB   DS    CL1      + JOB STATEMENT FLAG                       @ADR
MODJNFLG DS    CL1      + JOBNAME FLAG                             @ADR
MODJNAME DS    CL8      + JOBNAME, IF NOT SAME AS MODULE NAME      @ADR
MODRSV22 DS    CL4        RESERVED                                 @ADR
MODRSV23 DS    CL32       RESERVED                                 @ADR
MODOS    DS    0CL400     ***** OS SEGMENT *****                   @ADR
MODHPTYF DS    CL1      + HASP PRIORITY FLAG                       @ADR
MODHPTYV DS    CL2      + VALUE OF HASP PRIORITY                   @ADR
MODACCTF DS    CL1      + ACCOUNT NUMBER FLAG                      @ADR
MODACCTV DS    CL55     + GENERATED ACCOUNT NUMBER                 @ADR
MODTIMEF DS    CL1      + TIME PARAMETER FLAG                      @ADR
MODTIME  DS    CL7      + TIME PARAMETER VALUE                     @ADR
MODRSV24 DS    CL2        RESERVED                                 @ADR
MODCLASF DS    CL1      + CLASS PARAMETER FLAG                     @ADR
MODCLASV DS    CL1      + CLASS PARAMETER VALUE                    @ADR
MODREGF  DS    CL1      + REGION PARAMETER FLAG                    @ADR
MODREGV  DS    CL11     + REGION PARAMETER VALUE                   @ADR
MODRSV25 DS    CL4        RESERVED                                 @ADR
MODPRTYF DS    CL1      + PRTY PARAMETER FLAG                      @ADR
MODPRTYV DS    CL2      + PRTY PARAMETER VALUE                     @ADR
MODRSV26 DS    CL5        RESERVED                                 @ADR
MODMSGF  DS    CL1      + MSGCLASS PARAMETER FLAG                  @ADR
MODMSGV  DS    CL1      + MSGCLASS PARAMETER VALUE                 @ADR
MODRSV27 DS    CL70       RESERVED                                 @ADR
MODEXEC1 DS    CL55     + OPERAND PORTION OF EXEC CARD OR SPACES   @ADR
MODCONT1 DS    CL1      + CONTINUATION OF EXEC CARD FLAG           @ADR
MODEXEC2 DS    CL45     + OPERAND PORTION OF EXEC CARD OR SPACES   @ADR
MODRSV28 DS    CL23       RESERVED                                 @ADR
MODCPDDF DS    CL1      + COMPILER STEPNAME FLAG                   @ADR
MODODDF  DS    CL1      + COMPILER/LINKAGE EDITOR DDNAME FLAG      @ADR
MODODSF  DS    CL1      + COMPILER/LINKAGE EDITOR DSNAME FLAG      @ADR
MODOSTAF DS    CL1      + COMPILER/LINKAGE EDITOR DISP FLAG        @ADR
MODRSV29 DS    CL1        RESERVED                                 @ADR
MODRSV30 DS    CL8        RESERVED                                 @ADR
MODCPDDN DS    CL8      + COMPILER STEPNAME QUALIFIER              @ADR
MODODDN  DS    CL8      + DDNAME OF COMPILER/LINK.ED. OUTPUT       @ADR
MODOSTAT DS    CL4      + STATUS OF COMPILER/LINK.ED. OUTPUT       @ADR
MODODSN  DS    CL44     + DSNAME OF COMPILR/LINK.ED. OUTPUT        @ADR
MODOMEMB DS    CL8      + MEMBER NAME FOR COMPILER/LINK.ED. OUTPUT @ADR
MODISYS  DS    CL6      + DDNAME OF COMPILER SYSIN FILE            @ADR
MODRSV31 DS    CL18       RESERVED                                 @ADR
         ORG   MODOS                                               @ADR
MODDOS   DS    0CL400     ***** DOS SEGMENT *****                  @ADR
MODTYPF  DS    CL1        FLAG...TYPE OF MODULE BEING PROCESSED    @ADR
MODTYPV  DS    CL9      + VALUE...THE TYPE OF MODULE BEING PROC'D  @ADR
MODDR50  DS    CL5        RESERVED                                 @ADR
MODJA1F  DS    CL1      + FLAG...ACCOUNT NUMBER ON JOB STATEMENT   @ADR
MODJA1V  DS    CL16     + VALUE...ACCOUNT NUMBER ON JOB STATEMENT  @ADR
MODDR51  DS    CL7        RESERVED                                 @ADR
MODOPTF  DS    CL1      + FLAG...OPTION STATEMENT BEING GENERATED  @ADR
MODOPTV  DS    CL60     + VALUE...OPTION STATEMENT BEING GENERATED @ADR
MODDR52  DS    CL2        RESERVED                                 @ADR
MODDR53  DS    CL1        RESERVED                                 @ADR
MODCTRF  DS    CL1      + FLAG...CATALR STATEMENT BEING GENERATED  @ADR
MODCTRV  DS    CL8      + VALUE...MODULE NAME ON CATALR STATEMENT  @ADR
MODJA2F  DS    CL1      + FLAG...ACTION= ON -JCL SPECIFIED         @ADR
MODJA2V  DS    CL30     + VALUE...ACTION= ON -JCL SPECIFIED        @ADR
MODDR54  DS    CL32       RESERVED                                 @ADR
MODDR55  DS    CL4        RESERVED                                 @ADR
MODPHSF  DS    CL1      + FLAG...PHASE STATEMENT BEING GENERATED   @ADR
MODPHSV  DS    CL44     + VALUE...PHASE STATEMENT BEING GENERATED  @ADR
MODECPCF DS    CL1      + FLAG...EXEC OR PROC ON -JCL SPECIFIED    @ADR
MODCOPTF DS    CL1      + FLAG...COMOPT ON -JCL SPECIFIED          @ADR
MODNTRYF DS    CL1      + FLAG...ENTRY ON -JCL SPECIFIED           @ADR
MODLTYPF DS    CL1      + FLAG...LBLTYP ON -JCL SPECIFIED          @ADR
MODLOPTF DS    CL1      + FLAG...LINKOPT ON -JCL SPECIFIED         @ADR
MODGOPTF DS    CL1      + FLAG...GOOPT ON -JCL SPECIFIED           @ADR
MODDR56  DS    CL1        RESERVED                                 @ADR
MODEOJF  DS    CL1      + FLAG...E-O-J STATEMENT BEING GENERATED   @ADR
MODECPCV DS    CL10     + VALUE...EXEC OR PROC ON -JCL SPECIFIED   @ADR
MODDR57  DS    CL6        RESERVED                                 @ADR
MODCOPTV DS    CL15     + VALUE...COMOPT ON -JCL SPECIFIED         @ADR
MODDR58  DS    CL17       RESERVED                                 @ADR
MODNTRYV DS    CL8      + VALUE...ENTRY ON -JCL SPECIFIED          @ADR
MODLTYPV DS    CL9      + VALUE...LBLTYP ON -JCL SPECIFIED         @ADR
MODDR59  DS    CL7        RESERVED                                 @ADR
MODLOPTV DS    CL15     + VALUE...LINKOPT ON -JCL SPECIFIED        @ADR
MODDR60  DS    CL17       RESERVED                                 @ADR
MODGOPTV DS    CL15     + VALUE...GOOPT ON -JCL SPECIFIED          @ADR
MODDR61  DS    CL49       RESERVED                                 @ADR
MOD#LEN  EQU   *-MODRES   LENGTH OF RESULT AREA                    @ADR
***********************************************************************
         AIF   (NOT &SWB1).END2
&SYSECT  CSECT                                                     @ADR
.END2    ANOP
         SPACE 2
.*       RECORD RESULT AREA
.BEGIN3  ANOP
         AIF   (&SWBA).REC
         AIF   (NOT &SWBR).BEGIN4
.REC     ANOP
         SPACE 1
***********************************************************************
*****    M A S T R E C    PROCESSING  RESULT  AREA                *****
***********************************************************************
         SPACE 1
         AIF   (&SWB1).DSECT4
RECRES   DS    0D                                                  @ADR
         AGO   .BSECT4
.DSECT4  ANOP
RECRES   DSECT                                                     @ADR
.BSECT4  ANOP
         DS    0CL400     LIBRARIAN/FAIR/VS MASTREC RESULT AREA    @ADR
RECRET   DS    CL1        MASTREC RETURN CODE                      @ADR
RECPRTR  DS    CL1        PRINTER MODULE FLAG                      @ADR
RECINC   DS    CL1        -INCLUDE PROCESSING FLAG                 @ADR
RECRSV1  DS    CL1        RESERVED                                 @ADR
RECINC#  DS    CL2        NUMBER OF -INCLUDED MODULES              @ADR
RECRSV2  DS    CL6        RESERVED                                 @ADR
RECNAME  DS    CL8        NAME OF MODULE BEING PROCESSED           @ADR
RECRSV3  DS    CL4        RESERVED                                 @ADR
RECINCNM DS    CL8        NAME OF MODULE ON -INC CARD              @ADR
RECRSV4  DS    CL4        RESERVED                                 @ADR
RECRSV5  DS    CL1        RESERVED                                 @ADR
RECTYPE  DS    CL1        RECORD TYPE FOR RETRIEVED RECORD         @ADR
RECRSV51 DS    CL2        RESERVED                                 @ADR
RECVAR   DS    CL1        VARIABLE FLAG                           @ADR
RECDATE  DS    CL1        DATE STAMP FLAG                          @ADR
RECSEQFG DS    CL1        SEQUENCE PROCESSING FLAG                 @ADR
RECRSV6  DS    CL1        RESERVED                                 @ADR
RECSEQ1  DS    CL2        STARTING COLUMN OF SEQUENCE              @ADR
RECRSV7  DS    CL1        RESERVED                                 @ADR
RECSEQ2  DS    CL1        LENGTH OF SEQUENCE FIELD                 @ADR
RECINV#  DS    CL16       RECORD INVENTORY NUMBER                  @ADR
RECADD   DS    CL6        DATE RECORD WAS ADDED TO MODULE          @ADR
RECRSV8  DS    CL8        RESERVED                                 @ADR
RECRSV9  DS    CL2        RESERVED                                 @ADR
RECRSV10 DS    CL8        RESERVED                                 @ADR
RECSEQ#  DS    CL8        RECORD SEQUENCE NUMBER                   @ADR
RECLOST  DS    CL9        DATA OVERLAID BY SEQUENCE #              @ADR
RECRSV11 DS    CL7        RESERVED                                 @ADR
RECRSV12 DS    CL8        RESERVED                                 @ADR
RECRECD  DS    CL133      THE RETURNED RECORD                      @ADR
RECRSV13 DS    CL147      RESERVED                                 @ADR
REC#LEN  EQU   *-RECRES   LENGTH OF RESULT AREA                    @ADR
***********************************************************************
         AIF   (NOT &SWB1).END3
&SYSECT  CSECT                                                     @ADR
.END3    ANOP
         SPACE 2
.*       CLOSE RESULT AREA
.BEGIN4  ANOP
         AIF   (&SWBA).CLS
         AIF   (NOT &SWBC).END5
.CLS     ANOP
         SPACE 1
***********************************************************************
*****    M A S T R C L S    PROCESSING  RESULT  AREA              *****
***********************************************************************
         SPACE 1
         AIF   (&SWB1).DSECT5
CLOSERES DS    0D                                                  @ADR
         AGO   .BSECT5
.DSECT5  ANOP
CLOSERES DSECT                                                     @ADR
.BSECT5  ANOP
         DS    0CL8       LIBRARIAN/FAIR/VS MASTRCLS RESULT AREA   @ADR
CLOSERET DS    CL1        MASTRCLS RETURN CODE                     @ADR
CLOSRSV1 DS    CL7        RESERVED                                 @ADR
CLOS#LEN EQU   *-CLOSERES LENGTH OF RESULT AREA                    @ADR
***********************************************************************
         AIF   (NOT &SWB1).END4
&SYSECT  CSECT                                                     @ADR
.END4    ANOP
         SPACE 3
         AGO   .END5
.*       TERMINATE MACRO
.TERM0   ANOP                                                      @ADR
.TERM1   ANOP                                                      @ADR
.TERM2   ANOP                                                      @ADR
         MNOTE *,' INVALID EXPRESSION, MACRO EXPANSION SUPPRESSED.'
.END5    MEND
./ ADD  NAME=FMT1DSCB
** TITLE   BESCHREIBUNG FORMAT-1 DSCB
** OWNER   128.FRANZ
** LCHNG   08/26/83 10:25:25   Z227128 FRANZ
         MACRO
         FMT1DSCB
         SPACE 1
.*
*   DESCRIPTION OF FORMAT 1 DSCB
.*
.*       MODIFIED BY H. FRANZ         MAY 1982
*        MODIFIED BY H. FRANZ     26. AUG 1983
.*
.*       TO MEET BASF-REQUIREMENTS AFTER INSTALLATION OF DMS/OS
.*
         SPACE 1
DS1DSNAM DS    CL44      DATA SET NAME
DS1FMTID DS    CL1       FORMAT ID: C'1'
DS1DSSN  DS    CL6       DATA SET SERIAL NUMBER
         ORG   DS1DSSN                                   BASF-DMS
DS1CJOB2 DS    CL3       SECOND PART OF CREATING JOBNAME BASF-DMS
DS1MDATE DS    CL3       DATE OF LAST MODIFICATION       BASF-DMS
*                        (OPEN OTHER THAN INPUT)         BASF-DMS
DS1VOLSQ DS    XL2       VOLUME SEQUANCE NUMBER
DS1CREDT DS    XL3       CREATION DATE IN BINARY, FORM: YDD
DS1EXPDT DS    XL3       EXPIRATION DATE (SAME FORM AS ABOVE)
DS1NOEPV DS    XL1       NO OF EXTENTS
DS1NOBDB DS    XL1       NO OF USED BYTES IN LAST PDS DIR BLOCK
         DS    XL1       RESERVED
DS1SYSCD DS    CL13      SYSTEM CODE
         ORG   DS1SYSCD                                  BASF-DMS
DS1MJOB  DS    CL8       LAST MODIFYING JOBNAME          BASF-DMS
DS1CJOB1 DS    CL5       FIRST PART OF CREATING JOBNAME  BASF-DMS
DS1REFD  DS    XL3       LAST REFERENCE DATE BASF-SU60
DS1OPCNT DS    XL4       OPEN COUNT (MODIFICATIONS ONLY) BASF-DMS
DS1DSORG DS    XL2       DATA SET ORGANIZATION
DS1RECFM DS    XL1       RECORD FORMAT
DS1OPTCD DS    XL1       OPTION CODE
DS1BLKL  DS    XL2       BLOCK LENGTH
DS1LRECL DS    XL2       LOGICAL RECORD LENGTH
DS1KEYL  DS    XL1       KEY LENGTH
DS1RKP   DS    XL2       RELATIVE KEY POSITION
DS1DSIND DS    XL1       DATA SET INDICATORS
DS1SCALO DS    XL4       ALLOCATION PARAMETERS
DS1LSTAR DS    XL3       LAST BLOCK POINTER, TTR OF TTRLL
DS1TRBAL DS    XL2       LL PORTION OF DS1LSTAR, LL OF TTRLL
         DS    XL2       RESERVED
DS1EXT1  DS    XL10      EXTENT DESCRIPTION FOR 1ST EXTENT
DS1EXT2  DS    XL10      EXTENT DESCRIPTION FOR 2ND EXTENT
DS1EXT3  DS    XL10      EXTENT DESCRIPTION FOR 3RD EXTENT
DS1PTRDS DS    XL5       CCHHR POINTER TO ADDITIONAL EXTENT DSCB
         SPACE 2
         MEND
./ ADD  NAME=FORMREC
         MACRO
&NM      FORMREC &TYPE=DEF
         LCLC  &N
&N       SETC  '&NM'
         AIF   ('&TYPE' NE 'DSECT').DEF
&N       DSECT
&N       SETC  ' '
.DEF     ANOP
         SPACE 3
*
*        DEFINITION DER PAPIER-LAGERNUMMER DATEI
*
&N       DS    0D
FORMREC  DS    0D
FORM#    DS    CL3            FORM NUMMER
FORMKZ   DS    CL1            KENNZEICHEN (L=LISTE, K=KARTE)
FORMTEXT DS    CL36           BESCHREIBUNGS TEXT
         DS    CL11
FORMDIN  DS    CL2            DIN FORMAT
FORMCOPY DS    CL1            ANZAHL DURCHSCHLAEGE
FORMPACK DS    CL4            STAPELGROESSE IN BLATT
         DS    CL22
         MEND
./ ADD  NAME=FREESAVE
         MACRO
&NAME    FREESAVE  &SA=
&NAME    DS    0H
         AIF   (K'&SA EQ 0).FREE
         L     13,4(13)  RESTORE S.A. ADR.
         MEXIT
.FREE    ANOP
         LR    1,13     ADR. OF S.A. TO BE FREED.
         L     13,4(13)  ADR. OF PREVIOUS S.A.
         FREEMAIN  R,LV=72,A=(1)
         MEND
./ ADD  NAME=GENSORT
         MACRO
&NAME    GENSORT  &LIST
         LCLC  &N3(50),&N4(50),&N5(50),&ZWSP,&INSERT
         LCLA  &I,&I3,&I4,&I5,&K3,&K4,&K5,&L3,&L4,&L5,&M3,&M4,&M5,&LAE
         ACTR  10000
         AIF   (N'&LIST EQ 0).ERROR4
.UEBERN  ANOP
         AIF   (&I GE N'&SYSLIST).ANZFL3
&I       SETA  &I+1
         AIF   (K'&SYSLIST(&I) EQ 3).FELDWL3
         AIF   (K'&SYSLIST(&I) EQ 4).FELDWL4
         AIF   (K'&SYSLIST(&I) EQ 5).FELDWL5
         AGO   .ERROR2
.FELDWL3 ANOP
&LAE     SETA  3
         AIF   (&I3 GE 50).ERROR3
&I3      SETA  &I3+1
&N3(&I3) SETC  '&SYSLIST(&I)'
         AGO   .UEBERN
.FELDWL4 ANOP
&LAE     SETA  4
         AIF   (&I4 GE 50).ERROR3
&I4      SETA  &I4+1
&N4(&I4) SETC  '&SYSLIST(&I)'
         AGO   .UEBERN
.FELDWL5 ANOP
&LAE     SETA  5
         AIF   (&I5 GE 50).ERROR3
&I5      SETA  &I5+1
&N5(&I5) SETC  '&SYSLIST(&I)'
         AGO   .UEBERN
.ANZFL3  ANOP
         AIF   (&I3 LE 1).ANZFL4
.SORTFL3 ANOP
         AIF   (&K3 GE &I3-1).ANZFL4
&K3      SETA  &K3+1
&L3      SETA  &K3
.VERGLF3 ANOP
         AIF   (&L3 GE &I3).SORTFL3
&L3      SETA  &L3+1
.ABFRF3  ANOP
         AIF   ('&N3(&K3)' GT '&N3(&L3)').ORDNEN3
         AGO   .VERGLF3
.ORDNEN3 ANOP
&ZWSP    SETC  '&N3(&K3)'
&N3(&K3) SETC  '&N3(&L3)'
&N3(&L3) SETC  '&ZWSP'
&L3      SETA  &K3+1
         AGO   .ABFRF3
.ANZFL4  ANOP
         AIF   (&I4 LE 1).ANZFL5
.SORTFL4 ANOP
         AIF   (&K4 GE &I4-1).ANZFL5
&K4      SETA  &K4+1
&L4      SETA  &K4
.VERGLF4 ANOP
         AIF   (&L4 GE &I4).SORTFL4
&L4      SETA  &L4+1
.ABFRF4  ANOP
         AIF   ('&N4(&K4)' GT '&N4(&L4)').ORDNEN4
         AGO   .VERGLF4
.ORDNEN4 ANOP
&ZWSP    SETC  '&N4(&K4)'
&N4(&K4) SETC  '&N4(&L4)'
&N4(&L4) SETC  '&ZWSP'
&L4      SETA  &K4+1
         AGO   .ABFRF4
.ANZFL5  ANOP
         AIF   (&I5 LE 1).TAB1
.SORTFL5 ANOP
         AIF   (&K5 GE &I5-1).TAB1
&K5      SETA  &K5+1
&L5      SETA  &K5
.VERGLF5 ANOP
         AIF   (&L5 GE &I5).SORTFL5
&L5      SETA  &L5+1
.ABFRF5  ANOP
         AIF   ('&N5(&K5)' GT '&N5(&L5)').ORDNEN5
         AGO   .VERGLF5
.ORDNEN5 ANOP
&ZWSP    SETC  '&N5(&K5)'
&N5(&K5) SETC  '&N5(&L5)'
&N5(&L5) SETC  '&ZWSP'
&L5      SETA  &K5+1
         AGO   .ABFRF5
.TAB1    ANOP
         AIF   (&I3 EQ 0).TAB2
&L3      SETA  &I3*12
         SPACE
TAB3T    DS    0D
T3ANF    EQU   *
.ERH3    ANOP
&M3      SETA  &M3+1
         AIF   (&M3 GT &I3).TAB2
&INSERT  SETC  '&N3(&M3)'
&INSERT  DC    CL5'&INSERT',AL3(&INSERT.@),AL2(O&INSERT.@-GENOUT)
         AGO   .ERH3
.TAB2    ANOP
*
T3END    EQU   *
*
         AIF   (&I4 EQ 0).TAB3
&L4      SETA  &I4*12
         SPACE
TAB4T    DS    0D
T4ANF    EQU   *
.ERH4    ANOP
&M4      SETA  &M4+1
         AIF   (&M4 GT &I4).TAB3
&INSERT  SETC  '&N4(&M4)'
&INSERT  DC    CL5'&INSERT',AL3(&INSERT.@),AL2(O&INSERT.@-GENOUT)
         AGO   .ERH4
.TAB3    ANOP
*
T4END    EQU   *
*
         AIF   (&I5 EQ 0).EXIT
&L5      SETA  &I5*12
         SPACE
TAB5T    DS    0D
T5ANF    EQU   *
.ERH5    ANOP
&M5      SETA  &M5+1
         AIF   (&M5 GT &I5).T5E
&INSERT  SETC  '&N5(&M5)'
&INSERT  DC    CL5'&INSERT',AL3(&INSERT.@),AL2(O&INSERT.@-GENOUT)
         AGO   .ERH5
.ERROR2  ANOP
         SPACE
         MNOTE '*** LENGTH OF PARAMETER &I (&SYSLIST(&I)) INVALID ***'
         SPACE
         MEXIT
.ERROR3  ANOP
         SPACE
         MNOTE '*** MORE THAN FIFTY PARAMETERS OF LENGTH &LAE ***'
         SPACE
         MEXIT
.ERROR4  ANOP
         SPACE
         MNOTE '*** PARAMETERS MISSING ***'
         SPACE
.T5E     ANOP
*
T5END    EQU   *
*
.EXIT    MEXIT
         MEND
./ ADD  NAME=GETSAVE
         MACRO
&NAME    GETSAVE  &SA=
&NAME    DS    0H
         AIF   (K'&SA EQ 0).DYNAM  IF NO KEYWORD, GETMAIN.
         AIF   ('&SA' EQ '(1)').REG1   SA ADR. IN REG 1.
         AIF   ('&SA' NE '*').CONT1    NAMED SAVE AREA.
.*       SA=* CASE.  PROVIDE SAVE AREA HERE.
         CNOP  4,8
         BAL   1,*+76  PROVIDE S.A. ADR.
         DS    CL72    SAVE AREA
         AGO   .REG1
.CONT1   LA    1,&SA   PROVIDE S.A. ADR.
         AGO   .REG1
.DYNAM   GETMAIN  R,LV=72  GET S.A. DYNAMICALLY
.REG1    XC    0(72,1),0(1)  ZERO NEW S.A.
         ST    1,8(13)   CHAIN OLD AND
         ST    13,4(1)    NEW SAVE AREAS TOGETHER.
         LR    13,1      PROVIDE ADR. OF NEW S.A.
         MEND
./ ADD  NAME=GETUA
         MACRO
&NAME    GETUA &DCBNAME,&WORKA
         LCLA  &A1
         LCLB  &B1
         LCLC  &CDCBN
         ACTR  100
.* CHECK PARAMETER
         AIF   (T'&DCBNAME NE 'O').DCBN2
&CDCBN   SETC  'SYSIN'
         AGO   .WORKA1
.DCBN2   ANOP
&CDCBN   SETC  '&DCBNAME'
         AIF   (K'&DCBNAME LE 7).WORKA1
         MNOTE 8,'DCBNAME EXEEDS 7 BYTES -MACRO IGNORED-'
         MEXIT
.WORKA1  AIF   (T'&WORKA NE 'O').WORKA2
&B1      SETB  1
.WORKA2  ANOP
.* OPEN AND GET MACRO
*
* OPEN AND GET UNLIKE ATTRIBUTES                MACRO DRZ HH V1L1 07.71
*
         AIF   (T'&NAME EQ 'O').GET0
&NAME    DS    0H
.GET0    ANOP
G&SYSNDX.A EQU *+1
         NOP   G&SYSNDX.C .            OPEN SWITCH
         TM    &CDCBN+X'30',X'10' .    TEST IF DCB OPEN
         BO    G&SYSNDX.B .          . YES
         OPEN  (&CDCBN) .              ISSUE OPEN MACRO
         TM    &CDCBN+X'30',X'10' .    TEST IF OPEN SUCCESSFUL
         BO    G&SYSNDX.B .            . YES
         ABEND 13,DUMP                 OPEN NOT SUCCESSFUL
G&SYSNDX.B DS  0H
         MVI   G&SYSNDX.A,X'F0' .      INDICATE OPEN OK
G&SYSNDX.C DS  0H
         AIF   (&B1).GET1              IF NO WORK AREA
         GET   &CDCBN,&WORKA
         AGO   .GET2
.GET1    ANOP
         GET   &CDCBN
.GET2    ANOP
         CLI   &CDCBN.Z,X'FF' .        TEST IF EOV
         BNE   G&SYSNDX.D .            . NO
         MVI   &CDCBN.Z,0 .            CLEAR REREAD SWITCH
         B     G&SYSNDX.C .            REISSUE GET MACRO
G&SYSNDX.D DS  0H .                    CONTINUE PROCESSING
         MEND
./ ADD  NAME=GOTO
         MACRO
&NAME    GOTO  &LIST,&IND
         LCLA  &CNTL
&CNTL    SETA  0
.*
.*    CHECK FOR PROPER USE OF MACRO-INSTRUCTION (OPTION 1)
.*
         AIF   (N'&LIST EQ 0).ERROR1
         AIF   ('&IND' EQ '').ERROR3
.*
.*    MACRO INSTRUCTION OK FOR OPTION 1
.*
         CNOP  0,4
&NAME    L     1,&IND
         SLL   1,2
         LA    2,*+12
         L     1,0(1,2)
         BR    1
         CNOP  0,4
.MOVE    ANOP
&CNTL    SETA  &CNTL+1
         DC    A(&LIST(&CNTL))
         AIF   (&CNTL EQ N'&LIST).EXIT
         AGO   .MOVE
.EXIT    MEXIT
.ERROR1  MNOTE 'INVALID ADDRESS-LIST, NO STATEMENTS GENERATED'
         MNOTE 'PROCESSING CONTINUES WITH NEXT STMT.'
         MEXIT
.ERROR3  ANOP
&NAME    B     &LIST(1)
         MEXIT
         MEND
./ ADD  NAME=HISTHDR
HISTHDR  DSECT
MHDR     DS    0CL48
MLLZZ    DS    0AL4
MLL      DS    AL2
MFF1     DS    AL2
MHISTID  DS    0CL6
MSG      DS    CL2
MKZ      DS    CL2
MFF2     DS    CL2
MHISTNR  DS    PL4
MFLGKZ   DS    CL1
MDATE    DS    CL10
MTIME    DS    CL8
MABSID   DS    CL8
MFF3     DS    CL7
         ORG   MHISTID
MTC      DS    CL8
MHDRDAT  DS    CL44
./ ADD  NAME=IEZBASEV
         MACRO
&NM      IEZBASEV &P=BAS,&TYPE=
         AIF   ('&TYPE' EQ '').LAB1
&NM      DSECT
         AGO   .LAB2
.LAB1    ANOP
&NM      DS    0D
.LAB2    ANOP
&P.NAME  DS    0CL13
&P.EVKEY DC    CL5' '
&P.SERNO DC    CL6' '
         DC    XL45'00'
&P.NEXTV DC    CL6' '
         DC    XL6'00'
&P.FRESP DC    XL2'00'
         DC    XL110'00'
&P.GROUP DC    CL8' '
         DC    XL36'00'
         MEND
./ ADD  NAME=IKJEBEST
         MACRO
         IKJEBEST &CSECT=IBM
         LCLA  &A,&B,&C,&D,&E
         LCLA  &F                                                A42956
         LCLC  &CNAME,&SCNAME,&ABBR,&LDMOD,&LABEL,&LABEL1,&LABEL2,&NMBR
.*A035000,185000,230600-239000,255000                            A42956
         AIF   ('&CSECT' NE 'IBM').CONT0
&CNAME   SETC  'IKJEBMA8'     DEFINE CSECT NAME FOR IBM TABLE.
IKJEBMA8 CSECT
         ENTRY MA8IP002
         ENTRY MA8LI002
         AGO   .CONT1
.CONT0   ANOP
         AIF   ('&CSECT' NE 'USER').ERROR2
&CNAME   SETC  'IKJEBMA9'     DEFINE CSECT NAME FOR USER TABLE.
IKJEBMA9 CSECT
.CONT1   ANOP
&A       SETA  N'&SYSLIST
         AIF   (&A EQ 0).END
&B       SETA  1
&F       SETA  1                                                 A42956
.CONT2   ANOP
&C       SETA  N'&SYSLIST(&B)
         AIF   (&C LT 2 OR &C GT 3).ERROR1
&E       SETA  K'&SYSLIST(&B,&C)
&D       SETA  &E-1
.*  THE FOLLOWING FLAGED INSTRUCTIONS WERE ADDED TO PROVIDE      A42956
.*  UNIQUE LABELS, EVEN IF MODULES HAVE IDENTICAL LAST TWO       A42956
.*  CHARACTERS IN ENTRY POINT NAMES.  THE LABELS FOR MODULES     A42956
.*  IKJEBELI AND IKJEBEIP ARE UNCHANGED, SINCE THEY ARE          A42956
.*  REFERENCED WITHIN IKJEBEMA.                                  A42956
         AIF   ('&CSECT' NE 'IBM').CONT10                        A42956
         AIF   ('&SYSLIST(&B,&C)'(&D,&E) EQ 'LI' OR                    X
                '&SYSLIST(&B,&C)'(&D,&E) EQ 'IP' ).CONT11        A42956
.CONT10  ANOP                                                    A42956
&LABEL1  SETC  '&CNAME'(6,8).'@'.'&F'                            A42956
&F       SETA  &F+1                                              A42956
&LABEL2  SETC  '&CNAME'(6,8).'@'.'&F'                            A42956
&F       SETA  &F+1                                              A42956
         AGO   .CONT12                                           A42956
.CONT11  ANOP                                                    A42956
&LABEL1  SETC  '&CNAME'(6,8).'&SYSLIST(&B,&C)'(&D,&E).'001'
&LABEL2  SETC  '&CNAME'(6,8).'&SYSLIST(&B,&C)'(&D,&E).'002'
.CONT12  ANOP                                                    A42956
&SCNAME  SETC  '&SYSLIST(&B,1)'
         SPACE 2
         DC    AL1(&LABEL1-*-1) LENGTH OF SUBCOMMAND NAME.
         DC    C'&SCNAME' SUBCOMMAND NAME.
&LABEL1  EQU   *
         DC    AL1(&LABEL2-*-1) LENGTH OF ABBREVIATION.
         AIF   (K'&SYSLIST(&B,2) EQ 0).CONT5
&ABBR    SETC '&SYSLIST(&B,2)'
         DC    C'&ABBR' ABBREVIATION FOR SUBCOMMAND.
.CONT5   ANOP
&LABEL2  EQU   *
&LDMOD   SETC  '&SYSLIST(&B,&C)'
         DC    CL8'&LDMOD' LOAD MODULE NAME.
         AIF   (&B EQ &A).END
&B       SETA  &B+1
         AGO   .CONT2
.END     ANOP
         SPACE 2
         DC    AL1(255)       END OF TABLE MARKER.
         MEXIT
.ERROR1  MNOTE 12,'INVALID TABLE ENTRY'
         MEXIT
.ERROR2  MNOTE 12,'INVALID KEYWORD VALUE'
         MEND
./ ADD  NAME=IMSSAND
         TITLE '**  SANDERS  PDS--EQU''S  **'
***  DEVICE AND REGISTER ADDRESS MNEMONICS
         SPACE 2
*    BUS ADDRESSES
         SPACE 1
UPR      EQU   X'00'          MICROPROCESSOR
IAR      EQU   X'01'          INSTRUCTION ADDRESS REGISTER
PAG      EQU   X'01'          INSTRUCTION PAGE REGISTER
GP1      EQU   X'02'          GENERAL PURPOSE REGISTER ONE
SPA      EQU   X'02'          SCRATCH PAD ADDRESS
GP2      EQU   X'03'          GENERAL PURPOSE REGISTER TWO
GP3      EQU   X'04'          GENERAL PURPOSE REGISTER THREE
DMR      EQU   X'05'          DISPLAY MEMORY DATA REGISTER
KYB      EQU   X'06'          KYBOARD
COL      EQU   X'07'          DISPLAY MEMORY ADDRESS COLUMN
LIN      EQU   X'08'          DISPLAY MEMORY ADDRESS LINE
BDR      EQU   X'09'          BUFFERED CHANNEL DATA
DSK      EQU   X'09'          DISK
BAR      EQU   X'0A'          BUFFERED CHANNEL ADDRESS
SPD      EQU   X'0B'          SCRATCH PAD DATA
STP      EQU   X'0B'          STATUS PANEL
BXR      EQU   X'0E'          BUS EXPANSION SELECTION REGISTER
MAR      EQU   X'0F'          MEMORY ACCESS
         EJECT
***  810 PROCESSOR MODULE MICROINSTRUCTIONS
         SPACE 2
*    UPR
STLNK    EQU   X'02'          SET LINK
ST4BM    EQU   X'04'         SET FOUR BIT MODE
CL4BM    EQU   X'08'         CLEAR FOUR BIT MODE
SK4BM    EQU   X'10'         SKIP IF FOUR BIT MODE
*    IAR
POP      EQU   X'01'          POP STACK
STPAG    EQU   X'02'          SET PAGE MODE
STSTK    EQU   X'40'          SET STACK MODE
STPGSK   EQU   X'42'          SET PAGE AND STACK MODE
STNORM   EQU   X'80'          SET NORMAL MODE
ENABL    EQU   X'04'          ENABLE INTERRUPTS
INHIB    EQU   X'08'          INHIBIT INTERRUPTS
SKINT    EQU   X'10'          SKIP IF ANY INTERRUPT PENDING
SKLOAD   EQU   X'20'          SKIP AND CLEAR FLAG IF SET
*    GP1
EXCH     EQU   X'01'          EXCHANGE
DIAG     EQU   X'80'         DIAGNOSTIC
*    GP2
*EXCH    EQU   X'01'         *EXCHANGE
*    GP3
*EXCH    EQU   X'01'         *EXCHANGE
SKLWRC   EQU   X'08'          SKIP IF LOWER CASE OPTION
FHSNSW   EQU   X'20'          FETCH SENSE SWITCHES
*    BXR
*EXCH    EQU   X'01'
*    STP
SETALL   EQU   X'3F'         SET ALL INDICATORS
CLRALL   EQU   X'7F'         CLEAR ALL INDICATORS
STIND0   EQU   X'01'          SET INDICATOR ZERO
STIND1   EQU   X'02'                        ONE
STIND2   EQU   X'04'                        TWO
STIND3   EQU   X'08'                        THREE
STIND4   EQU   X'10'                        FOUR
STIND5   EQU   X'20'                        FIVE
CLIND0   EQU   X'41'          CLEAR INDICATOR ZERO
CLIND1   EQU   X'42'                          ONE
CLIND2   EQU   X'44'                          TWO
CLIND3   EQU   X'48'                          THREE
CLIND4   EQU   X'50'                          FOUR
CLIND5   EQU   X'60'                          FIVE
SKIND0   EQU   X'81'          SKIP IF INDICATOR ZERO
SKIND1   EQU   X'82'                            ONE
SKIND2   EQU   X'84'                            TWO
SKIND3   EQU   X'88'                            THREE
SKIND4   EQU   X'90'                            FOUR
SKIND5   EQU   X'A0'                            FIVE
SKCIN0   EQU   X'C1'          SKIP AND CLEAR IF INDICATOR ZERO
SKCIN1   EQU   X'C2'                                      ONE
SKCIN2   EQU   X'C4'                                      TWO
SKCIN3   EQU   X'C8'                                      THREE
SKCIN4   EQU   X'D0'                                      FOUR
SKCIN5   EQU   X'E0'                                      FIVE
*    MAR
*EXCH    EQU   X'01'         *EXCHANGE
INC      EQU   X'02'          INCREMENT MEMORY ADDRESS
READ     EQU   X'04'          READ MEMORY
WRIT     EQU   X'08'          WRITE MEMORY
FHMAC    EQU   X'20'          FETCH MEMORY ADDRESS
STMAC    EQU   X'40'          SET MEMORY ADDRESS
*    DMR
*EXCH    EQU   X'01'         *EXCHANGE
*INC     EQU   X'02'         *INCREMENT ADDRESS
SKREAD   EQU   X'04'          SKIP AND READ IF READY
SKWRIT   EQU   X'08'          SKIP AND WRITE IF READY
CLEOL    EQU   X'10'          CLEAR TO END OF LINE
CLEOS    EQU   X'20'          CLEAR TO END OF SCREEN
SKCLF    EQU   X'40'          SKIP IF CLEAR FINISHED
SPCLR    EQU   X'80'          STOP CLEAR AT END OF LINE
*    KYB
SKKBIN   EQU   X'04'          SKIP IF ANY KEYBOARD INTERRUPT
SKTRM    EQU   X'08'          SKIP IF SELECTED TERMINAL CONNECTED
FHKYBD   EQU   X'10'          FETCH SELECTED KEYBOARD DATA
SKINDF   EQU   X'20'          SKIP IF INDICATOR TRANSFER FINISHED
STIND    EQU   X'40'          SET SELECTED INDICATOR LAMPS
FHKYBF   EQU   X'80'          FETCH KEYBOARD FLAGS
*    COL
SK64     EQU   X'04'          SKIP IF 64/32 COLUMNS
SK40     EQU   X'08'          SKIP IF 40/32 COLUMNS
SK12     EQU   X'10'          SKIP IF 12 LINES
FHCUR    EQU   X'40'          FETCH SELECTED CURSOR COLUMN
STCUR    EQU   X'80'          SET SELECTED CURSOR COLUMN
*    LIN
*FHCUR   EQU   X'40'         *FETCH SELECTED CURSOR LINE ADDRESS
*STCUR   EQU   X'80'         *SET SELECTED CURSOR LINE ADDRESS
*    MDR
CLORG    EQU   X'01'          CLEAR ORIGINATE MODE
STORG    EQU   X'02'          SET ORIGINATE MODE
CLDTR    EQU   X'04'          CLEAR DATA TERMINAL READY
STDTR    EQU   X'08'          SET DATA TERMINAL READY
SRTIME   EQU   X'10'          START TIME-OUT
FHCUA    EQU   X'20'          FETCH CONTROL UNIT ADDRESS
CLRTS    EQU   X'40'          CLEAR REQUEST TO SEND
STRTS    EQU   X'80'          START REQUEST TO SEND
*    MDT
SKRING   EQU   X'02'          SKIP IF RING INDICATOR
SKDSR    EQU   X'03'          SKIP IF DATASET READY
SKONLN   EQU   X'04'          SKIP IF ON-LINE
SKFDPX   EQU   X'05'          SKIP IF FULL-DUPLEX
SKCTS    EQU   X'08'          SKIP IF CLEAR TO SEND
SKDCD    EQU   X'09'          SKIP IF DATA CARRIER DETECTED
SKNTOW   EQU   X'10'          SKIP IF NO TIMEOUT AND NO WRITE BREAK
INHTO    EQU   X'11'          INHIBIT TIMEOUT
SKMDP    EQU   X'20'          SKIP IF MODEM DATA PRESENT
CLMDP    EQU   X'21'          CLEAR MODEM DATA PRESENT
SKTRDY   EQU   X'40'          SKIP IF TRANSMIT READY
SNCHR    EQU   X'41'          SEND CHARACTER
SKSYNC   EQU   X'80'          SKIP IF SYNC I/O MODE
RESYNC   EQU   X'81'          RESYNC
*    CRC
CLCRC    EQU   X'10'          CLEAR CRC
CLSHFT   EQU   X'20'          CLEAR SHIFT MODE
STSHFT   EQU   X'40'          SET SHIFT MODE
*    PRN
*EXCH    EQU   X'01'         *EXCHANGE
*INC     EQU   X'02'         *INCREMENT PBA
ENPFIN   EQU   X'08'          ENABLE PRINTER FINISHED INTERRUPT
SKPRNC   EQU   X'10'          SKIP IF PRINTER NOT CONNECTED
SKBUF    EQU   X'20'          SKIP IF BUFFER/ADAPTER INSTALLED
SKBUSY   EQU   X'30'          SKIP IF PRINTER BUSY
SKNRDY   EQU   X'40'          SKIP IF PRINTER NOT READY
SKPFIN   EQU   X'50'          SKIP IF PRINTER FINISHED INTERRUPT
SKPBAO   EQU   X'60'          SKIP IF PRINTER BUFFER ADDRESS OVERFLOW
SRPRNT   EQU   X'80'          START PRINT
SPPRNT   EQU   X'90'          STOP PRINT
STPSA    EQU   X'A0'          SET PRINTER START ADDRESS
PREAD    EQU   X'C0'          READ DATA
STPBA    EQU   X'D0'          SET PRINTER BUFFER ADDRESS
FHPBA    EQU   X'E0'          FETCH PRINTER BUFFER ADDRESS
PWRIT    EQU   X'F0'          WRITE DATA
CLPBA    EQU   X'04'          CLEAR PBA
*    CDR
SPMOTR   EQU   X'01'          STOP MOTOR
STMOTR   EQU   X'02'          START MOTOR
SKDTER   EQU   X'04'          SKIP IF DATA OVERRUN ERROR
SKCRDY   EQU   X'08'          SKIP IF CARD READER READY
SKCDP    EQU   X'10'          SKIP IF DATA PRESENT
STPICK   EQU   X'20'          SET PICK
CLPICK   EQU   X'40'          CLEAR PICK
PICK1    EQU   X'60'          PICK ONE CARD
*    CAS
*EXCH    EQU   X'01'         *EXCHANGE
STLRC    EQU   X'04'          SET LRC MODE
DSCINT   EQU   X'08'          DISABLE CASSETTE INTERRUPTS
ENCINT   EQU   X'0A'          ENABLE CASSETTE INTERRUPTS
CLLDR    EQU   X'11'          CLEAR LEADER DETECT
CLGAP    EQU   X'12'          CLEAR GAP DETECT
CLRRDY   EQU   X'14'          CLEAR READ READY (WRITE)
CLWRDY   EQU   X'18'          CLEAR WRITE READY
SKLDR    EQU   X'21'          SKIP IF LEADER DETECT
SKGAP    EQU   X'22'          SKIP IF GAP DETECT
SKRRDY   EQU   X'24'          SKIP IF READ READY
SKWRDY   EQU   X'28'          SKIP IF WRITE READY
SKCLDR   EQU   X'31'          SKIP AND CLEAR LEADER DETECT
SKCGAP   EQU   X'32'          SKIP AND CLEAR GAP DETECT
SKCRRY   EQU   X'34'          SKIP AND CLEAR READ READY
SKCWRY   EQU   X'38'          SKIP AND WRITE IF READY
CSTOP    EQU   X'40'          STOP
SRRWND   EQU   X'41'          START REWIND
SRFFWD   EQU   X'42'          START FAST FORWARD
SRREAD   EQU   X'44'          START READ
SRWRSK   EQU   X'48'          START WRITE AND SKIP IF WRITE ENABLED
SRRDWR   EQU   X'4C'          START READ AFTER WRITE MODE
SELT1    EQU   X'84'          SELECT TRACK ONE
SELT2    EQU   X'85'          SELECT TRACK TWO
SELD1    EQU   X'88'          SELECT DRIVE ONE AND SKIP IF DRIVE READY
SELD2    EQU   X'8A'          SELECT DRIVE TWO AND SKIP IF DRIVE READY
SEL11    EQU   X'8C'          SELECT D-ONE,T-ONE AND SKIP IF D READY
SEL12    EQU   X'8D'          SELECT D-ONE,T-TWO AND SKIP IF D READY
SEL21    EQU   X'8E'          SELECT D-TWO,T-ONE AND SKIP IF D READY
SEL22    EQU   X'8F'          SELECT D-TWO,T-TWO AND SKIP IF D READY
*    PDR
*EXCH    EQU   X'01'         *EXCHANGE
STADRO   EQU   X'08'          SET ADDRESS OUT
STDATO   EQU   X'10'          SET DATA OUT
SKPDLD   EQU   X'40'          SKIP IF PAD INITIATED LOAD COMMAND
FHDATA   EQU   X'41'          FETCH DATA FROM LINE
FHCTL    EQU   X'42'          FETCH TAG AND CONTROL FLAGS
CLPINT   EQU   X'44'          CLEAR PAD INTERRUPT
CLADRO   EQU   X'48'          CLEAR ADDRESS OUT
CLDATO   EQU   X'50'          CLEAR DATA OUT
SKNOIN   EQU   X'81'          SKIP IF ANY INPUTS NOT ZERO
SKINPZ   EQU   X'82'          SKIP IF ALL INPUTS ZERO
SKPINT   EQU   X'84'          SKIP IF PAD INTERRUPT
*    PFR
STATTN   EQU   X'01'          SET ATTENTION OUT
STEOF    EQU   X'02'          SET EOF OUT
STNAK    EQU   X'04'          SET NAK OUT
STACK    EQU   X'08'          SET ACK OUT
STPRDY   EQU   X'10'          SET PRINTER READ OUT
STPBZY   EQU   X'20'          SET PRINTER BUSY OUT
CLCNTL   EQU   X'BF'          CLEAR ALL CONTROL OUT
SKCCNT   EQU   X'EF'          SKIP AND CLEAR ALL CONTROL OUT
*    BAR
*EXCH    EQU   X'01'         *EXCHANGE
*INC     EQU   X'02'         *INCREMENT BUFFER ADDRESS
*READ    EQU   X'04'         *READ DATA
*WRIT    EQU   X'08'         *WRITE DATA
*    BDR
*EXCH    EQU   X'01'         *EXCHANGE
SKNBZY   EQU   X'10'          SKIP IF CHANNEL NOT BUSY
SKNCIN   EQU   X'20'          SKIP IF NO CHANNEL INTERRUPT
STSELR   EQU   X'91'          SET SELECTION REGISTER
FHSELR   EQU   X'A1'          FETCH SELECTION REGISTER
ENCTIN   EQU   X'B1'          ENABLE CHANNEL INTERRUPTS
DSCTIN   EQU   X'B2'          DISABLE CHANNEL INTERRUPTS
*    DSK
RSDCSR   EQU   X'92'          RESET DISK CONTROLLER STATUS
STBBAR   EQU   X'93'          SET BUFFER BLOCK ADDRESS
STDSAR   EQU   X'96'          SET SECTOR ADDRESS
STDTAR   EQU   X'95'          SET TRACK ADDRESS AND SEEK CYLINDER
FHDCSR   EQU   X'A2'          FETCH DISK CONTROLLER STATUS
FHBBAR   EQU   X'A3'          FETCH BUFFER BLOCK ADDRESS
FHDSAR   EQU   X'A6'          FETCH SECTOR ADDRESS
FHDTAR   EQU   X'A5'          FETCH TRACK ADDRESS
RDSCTR   EQU   X'C0'          READ SECTOR
CKSCTR   EQU   X'C1'          CHECK SECTOR
WRSCTR   EQU   X'C4'          WRITE SECTOR
RSCNTL   EQU   X'C8'          RESET CONTROLLER
RSTRHM   EQU   X'D4'          RESTORE HEADS TO HOME POSITION
./ ADD  NAME=IMSTDEF
         MACRO
&TRAN    IMSTDEF  &KREG,&MSGCL,&ACCNT
         LCLA  &NO,&REST,&ADD,&LEN,&REG
&REG     SETA  &KREG
&TRAN    DC    CL8'&TRAN'    TRANSACTION CODE
         DC    H'&REG'       REGION USED
         DC    CL1'&MSGCL'   MSG - CLASS
&NO      SETA  N'&ACCNT      NO. OF FIELDS
&REST    SETA  21
         AIF   (&NO EQ 0).FEND
         DC    X'&NO'        NO.OF FIELDS
&REST    SETA  &REST-1
&ADD     SETA  1
.LOOP    ANOP
&LEN     SETA  K'&ACCNT(&ADD)
         SPACE
         DC    X'&LEN'       LENGTH OF FOLLOWING FIELD
         AIF   (&LEN EQ 0).NOC
         DC    C'&ACCNT(&ADD)'
.NOC     ANOP
&REST    SETA  &REST-&LEN-1
&ADD     SETA  &ADD+1
         AIF   (&ADD LE &NO).LOOP
.FEND    ANOP
         SPACE
         DC    XL&REST'00'
         SPACE 3
         MEND
./ ADD  NAME=IOHISTR1
IOHISTR1 DSECT
R1HDR    DS    0CL48
R1LL     DS    AL2
R1FF1    DS    AL2
R1KEY    DS    0CL10
R1HISTID DS    0CL6
R1SG     DS    CL2
R1KZ     DS    CL2
R1FF2    DS    CL2
R1HISTNR DS    PL4
R1FLGKZ  DS    CL1
R1DATE   DS    CL10
R1TIME   DS    CL8
R1ABSID  DS    CL8
R1FF3    DS    CL7
R1HISDAT DS    CL200
./ ADD  NAME=JCLVERZ
         MACRO
&NM      JCLVERZ &PRF=
*        BESCHREIBUNG DES JCL-VERZEICHNIS SATZES
&PRF.JOB  DC   CL8' '         JOBNAME
         DC    C' '
&PRF.UID  DC   CL7' '         USERID
         DC    C' '
&PRF.FLAG DC   CL5' '         FLAG AREA
         DC    C' '
&PRF.DATE DC   CL5' '         DATE OF ACTION
         DC    C' '
&PRF.TIME DC   CL5' '         TIME OF ACTION
&PRF.FLG2 DC   CL1' '         ADDITIONAL FLAGS
&PRF.VOLS DC   CL6' '         VOLSER OF TSO-DATASET
         DC    C' '
&PRF.JDAT DC   CL5' '         DATE OF LAST JCLLS
&PRF.REST DC   CL33' '        NOT USED
         MEND
./ ADD  NAME=JES2COPY
         MACRO
&NM      JES2COPY &TYPE=DEF,&D=J
         LCLC  &N
&N       SETC  '&NM'
         AIF   ('&TYPE' NE 'DSECT').DEF
&N       DSECT
&N       SETC  ' '
.DEF     ANOP
         SPACE 3
*        DEFINITION EINES EINTRAGS DER JES2-TABELLE
*           (URSPRUNG: UADSTAB UND SBNTAB)
*
&N       DS    0D
&D.COPY   DS    0CL51
*
&D.SBN#   DC    CL3' '         SBN#
&D.SBNNM  DC    CL20' '        NAME OF SBN
&D.SBNB   DC    CL4' '         BAU
&D.SBNZ   DC    CL4' '         ZIMMER
&D.SBNOR  DC    CL12' '        ORG EINHEIT
&D.SBNTL  DC    CL8' '         TELEFON
*
&D.LGTH   EQU   *-&D.COPY      LENGTH OF TAB-ENTRY
         MEND
./ ADD  NAME=JFCB
         MACRO
         JFCB
JFCB     DSECT
         IEFJFCBN
         SPACE 2
         MEND
./ ADD  NAME=JFCBE
         MACRO
         JFCBE
JFCBE    EQU   *
*
*        JOB FILE CONTROL BLOCK 3800 EXTENSION   (SELF MADE)
*
*
JFCBEXTR DS    XL3     NEXT EXTENSION TTR
         DS    XL1     RESERVED
JFCBFLAG DS    XL1     FLAG FOR 3800
JFCBBST  EQU   X'02'   MEANS BURST=Y
JFCBCFS  EQU   X'04'   MEANS BURST=N CONTINOUS FORMS STACKING
JFCIDTRC DS    XL1     MODIFY SUB PARM (0 - 3)
         DS    XL1     RESERVED
JFCIMTOT DS    XL1     NUMBER OF FLASHES
JFCBMAGT DS    CL4     FLASH ID
JFCMODIF DS    XL4     COPY MODIFICATION ID
         DS    XL4     RESERVED
JFCBTRS1 DS    CL4     NAME OF TRANSLATE TABLE 1 (CHARACTER SET)
JFCBTRS2 DS    CL4     NAME OF TRANSLATE TABLE 2 (CHARACTER SET)
JFCBTRS3 DS    CL4     NAME OF TRANSLATE TABLE 3 (CHARACTER SET)
JFCBTRS4 DS    CL4     NAME OF TRANSLATE TABLE 4 (CHARACTER SET)
JFCGROUP DS    0XL8    GROUP COPY COUNTERS
JFCGRP1  DS    XL1     GROUP1 COUNT
JFCGRP2  DS    XL1     GROUP2 COUNT
JFCGRP3  DS    XL1     GROUP3 COUNT
JFCGRP4  DS    XL1     GROUP4 COUNT
JFCGRP5  DS    XL1     GROUP5 COUNT
JFCGRP6  DS    XL1     GROUP6 COUNT
JFCGRP7  DS    XL1     GROUP7 COUNT
JFCGRP8  DS    XL1     GROUP8 COUNT
         DS    XL128   RESERVED
JFCBFORM DS        CL4     PAPIER NUMMER (BASF MODIFICATION)
         MEND
./ ADD  NAME=JOBCARD
         MACRO
         JOBCARD &CNT,&CLASS,&LEVEL
         LCLC  &B
         AIF   (T'&LEVEL EQ 'O').JOB1
         PUNCH '         REPRO'
.JOB1    PUNCH '//Z222068&CNT JOB (6695,068,2),  '
         AIF   (T'&LEVEL EQ 'O').JOB2
         PUNCH '         REPRO'
&B       SETC  ',TYPRUN=HOLD'
.JOB2    PUNCH '//   MSGCLASS=&CLASS&B,CLASS=C'
         MEND
./ ADD  NAME=KASAM
         MACRO
&NAME KASAM &INBUFN=2,&INBLK=,&INLABL=NO,&INRECF=,&INRECSZ=0,&INDEV=,&IX
               NALT=,&INLADD=0,&DEVICE=,&CODETR=,&DELIM=E0,&INNAME=,&OUX
               TBUFN=2,&OUTBLK=,&OUTLABL=NO,&OUTLADD=0,&OUTNAME=,&OUTDEX
               V=,&OUTALT=,&COMTAPE=,&TPMARK=YES,&SEL=,&GRAPHIC=,&STRIPX
               =,&MAG=2000,&RTRV=,&CHKSTP=,&PGEND=F,&BREAK=,&EYEBALL=,&X
               HDR=KASAM,&EDIT=,&EOFADDR=,&BGNPAD=,&ENDPAD=,&IBTAB=,&PTX
               RNTAB=,&PRTCODE=ASA,&ERROPT=ABE,&PULDOWN=3,&PTRNSKP=,&LIX
               NKAGE=,&MIR=,&IBSKIP=
         GBLC  &ERR
         GBLC  &SYN
         GBLC  &CG15
         GBLC  &CG14
         GBLC  &CG13
         GBLC  &CG12
         GBLC  &CG11
         GBLC    &CG10
         GBLC  &CG8
         GBLC  &RESDEV
         GBLC  &TYPEF
         GBLC  &LEDR
         LCLA  &AL8
         LCLA  &AL7
         LCLA  &AL6
         LCLA  &AL5
         LCLA  &AL4
         LCLA  &AL3
         LCLA  &AL2
         LCLA  &AL1
         LCLA    &AL0
         LCLA    &AL9
         LCLA  &AL10
         LCLA  &AL11
         LCLB  &BL7
         LCLB  &BL6
         LCLB  &BL5
         LCLB  &BL4
         LCLB  &BL3
         LCLB  &BL2
         LCLB  &BL1
         LCLB  &BL0
*  KODAK KOM-90 MICROFILMER SOFTWARE  OS VER 2  10/01/69
         AIF   ('&LINKAGE' EQ '').AUD01
         AIF   ('&LINKAGE' EQ 'COBOL').AUD03
         AIF   ('&LINKAGE' EQ 'PL').AUD03
         AIF   ('&LINKAGE' EQ 'ASSEMB').AUD03
         AIF   ('&LINKAGE' EQ 'FORTRAN').AUD03
         MNOTE 'KASAM IMPROPER LINKAGE'
&BL1     SETB  (1)
         AGO   .AUD03
.AUD01   AIF   ('&INBLK' NE '').AUD03
         MNOTE 'KASAM INBLK NOT SPECIFIED'
&BL1     SETB  (1)
.AUD03   AIF   ('&OUTBLK' NE '').AUD07
         MNOTE 'KASAM OUTBLK NOT SPECIFIED'
&BL1     SETB  (1)
.AUD07   AIF   ('&NAME' NE '').AUD002
         MNOTE 'KASAM NAME NOT SPECIFIED'
&BL1     SETB  (1)
.AUD002  AIF   ('&PULDOWN' NE '3').AUD02Q
&LEDR    SETC  '45'
         AGO   .AUD02T
.AUD02Q  AIF   ('&PULDOWN' NE '2').AUD02S
&LEDR    SETC  '70'
         AGO   .AUD02T
.AUD02S  AIF   ('&PULDOWN' NE '1').AUD02P
&LEDR    SETC  '135'
         AGO   .AUD02T
.AUD02P  MNOTE 'KASAM INVALID PULDOWN'
&BL1     SETB  (1)
.AUD02T  AIF   ('&LINKAGE' NE '').AUD005
         AIF   ('&INRECF' NE 'VB').AUD004
         AGO   .AUD007
.AUD004  AIF   ('&INRECF' NE 'FB').AUD005
         AGO   .AUD007
.AUD005  AIF   ('&INRECF' NE 'F').AUD006
         AGO   .AUD007
.AUD006  AIF   ('&INRECF' NE 'V').AUD012
.AUD007  AIF   ('&INRECSZ' EQ '').AUD009
&TYPEF   SETC  '&INRECF'
&AL0     SETA  &INRECSZ
         AIF   (&AL0 NE 0).AUD018
.AUD009  MNOTE 'KASAM IMPROPER INRECSZ'
&BL1     SETB  (1)
         AGO   .AUD018
.AUD012  AIF   ('&LINKAGE' NE '').AUD013
         AIF   ('&INRECF' NE 'UB').AUD014
         AIF   ('&DELIM' LE '9').AUD010
         AIF   ('&DELIM' GT '99').AUD010
&CG14    SETC  '&DELIM'(1,1)
         AIF   ('&CG14' LT 'A').AUD010
         AIF   ('&CG14' LE 'F').AUD10A
         AIF   ('&CG14' LT '0').AUD010
.AUD10A  ANOP
&CG14    SETC  '&DELIM'(2,1)
         AIF   ('&CG14' LT 'A').AUD010
         AIF   ('&CG14' LE 'F').AUD016
         AIF   ('&CG14' GE '0').AUD016
.AUD010  MNOTE 'KASAM IMPROPER DELIM'
&BL1     SETB  (1)
         AGO   .AUD016
.AUD014  AIF   ('&INRECF' EQ 'VBA').AUD016
         AIF   ('&INRECF' EQ 'U').AUD015
.AUD013  MNOTE 'KASAM IMPROPER INRECF'
&BL1     SETB  (1)
         AIFB  ('&LINKAGE' NE '').AUD007
         AGO   .AUD018
.AUD015  AIF   ('&EDIT' NE '').AUD016
         MNOTE 'KASAM EDIT REQ''D BUT NOT SPECIFIED'
&BL1     SETB  (1)
         AGO   .AUD018
.AUD016  ANOP
&BL7     SETB  (1)
&TYPEF   SETC  'U'
.AUD018  AIF   ('&DEVICE' NE 'TAPE7').AUD022
         AIF   ('&COMTAPE' NE '7').AUD020
&AL1     SETA  1
         AGO   .AUD032
.AUD020  AIF   ('&COMTAPE' NE '9').AUD022
&AL1     SETA  2
         AGO   .AUD032
.AUD022  AIF   ('&DEVICE' EQ 'TAPE9').AUD026
         AIF   ('&DEVICE' EQ '2311').AUD024
         AIF   ('&DEVICE' EQ '2314').AUD024
         MNOTE 'KASAM IMPROPER DEVICE'
&BL1     SETB  (1)
         AGO   .AUD026
.AUD024  ANOP
&BL0     SETB  (1)
.AUD026  AIF   ('&COMTAPE' NE '7').AUD028
&AL1     SETA  3
         AGO   .AUD032
.AUD028  AIF   ('&COMTAPE' EQ '9').AUD030
         MNOTE 'KASAM IMPROPER COMTAPE'
&BL1     SETB  (1)
         AGO   .AUD032
.AUD030  ANOP
&AL1     SETA  0
.AUD032  AIF   ('&LINKAGE' NE '').AUD034
         AIF   ('&INNAME' NE '').AUD034
         MNOTE 'KASAM INNAME NOT SPECIFIED'
&BL1     SETB  (1)
.AUD034  AIF   ('&OUTNAME' NE '').AUD035
         MNOTE 'KASAM OUTNAME NOT SPECIFIED'
&BL1     SETB  (1)
.AUD035  AIF   ('&LINKAGE' NE '').AUD036
         AIF   ('&ERROPT' EQ 'SKP').AUDE01
         AIF   ('&ERROPT' EQ 'ACC').AUDE01
         AIF   ('&ERROPT' EQ 'ABE').AUDE01
&ERR     SETC  'SKP'
&SYN   SETC  '&ERROPT'
         AGO   .AUDE02
.AUDE01  ANOP
&ERR    SETC  '&ERROPT'
&SYN    SETC  '1'
.AUDE02  AIF   ('&SEL' EQ '').AUD036
         AIF   ('&SEL' EQ 'YES').AUD036
         AIF   ('&SEL' LE '9').AUDE04
         AIF   ('&SEL' GT '99').AUDE04
&CG14    SETC  '&SEL'(1,1)
         AIF   ('&CG14' LT 'A').AUDE04
         AIF   ('&CG14' LE 'F').AUDE03
         AIF   ('&CG14' LT '0').AUDE04
.AUDE03  ANOP
&CG14    SETC  '&SEL'(2,1)
         AIF   ('&CG14' LT 'A').AUDE04
         AIF   ('&CG14' LE 'F').AUD036
         AIF   ('&CG14' GE '0').AUD036
.AUDE04  MNOTE 'KASAM IMPROPER SEL'
&BL1     SETB  (1)
.AUD036  AIF   ('&STRIP' EQ '').AUD042
         AIF   ('&BGNPAD' EQ '').AUD38J
&AL0     SETA  0
&AL0     SETA  &BGNPAD
         AIF   (&AL0 LT 1).AUD38G
         AIF   (&AL0 LT 256).AUD38J
.AUD38G  MNOTE 'KASAM IMPROPER BGNPAD'
&BL1     SETB  (1)
.AUD38J  AIF   ('&ENDPAD' EQ '').AUD39J
&AL0     SETA  0
&AL0     SETA  &ENDPAD
         AIF   (&AL0 LT 1).AUD39G
         AIF   (&AL0 LT 256).AUD39J
.AUD39G  MNOTE 'KASAM IMPROPER ENDPAD'
&BL1     SETB  (1)
.AUD39J  ANOP
&AL2     SETA  &STRIP
         AIF   (&AL2 NE 0).AUD048
         MNOTE 'KASAM IMPROPER STRIP'
&BL1     SETB  (1)
.AUD042  ANOP
&AL2     SETA  &MAG
&BL2     SETB  (1)
         AIF   (&AL2 NE 0).AUD048
         MNOTE 'KASAM IMPROPER MAG'
&BL1     SETB  (1)
.AUD048  AIF   ('&CHKSTP' NE '').AUD052
         AIF   (&BL2).AUD050
&AL3     SETA  100
         AGO   .AUD054
.AUD050  ANOP
&AL3     SETA  1
         AGO   .AUD054
.AUD052  ANOP
         AIF   ('&CHKSTP' EQ 'NO').AUD054
&AL3     SETA  &CHKSTP
         AIF   (&AL3 NE 0).AUD054
         MNOTE 'KASAM IMPROPER CHKSTP'
&BL1     SETB  (1)
.AUD054  AIF   ('&PGEND' EQ 'F').AUD056
         AIF   ('&MIR' EQ '').AUD055
         MNOTE 'KASAM IMPROPER PGEND WITH MIR'
&BL1     SETB  (1)
.AUD055  AIF   ('&PGEND' EQ 'A').AUD056
         MNOTE 'KASAM IMPROPER PGEND'
&BL1     SETB  (1)
.AUD056  AIF   ('&BREAK' EQ '').AUD062
&CG14    SETC  '&BREAK'(1,2)
&AL4     SETA  &CG14
         AIF   (&AL4 EQ 0).AUD060
         AIF   (&AL4 GT 32).AUD060
&CG14    SETC  '&BREAK'(3,3)
&AL5     SETA  &CG14
         AIF   (&AL5 EQ 0).AUD060
         AIF   (&AL5 LE 150).AUD062
.AUD060  MNOTE 'KASAM IMPROPER BREAK'
&BL1     SETB  (1)
.AUD062  AIF   ('&EYEBALL' EQ '').AUD070
         AIF   ('&IBSKIP' EQ '').AUD063
         AIF   ('&IBSKIP' LT '1').AUD063A
         AIF   ('&IBSKIP' LE '9').AUD063
.AUD063A MNOTE 'KASAM IMPROPER IBSKIP'
&BL1     SETB  (1)
.AUD063  AIF   ('&EYEBALL' NE 'YES').AUD064
         AIF   ('&LINKAGE' EQ '').AUD068
&BL4     SETB  (1)
         AGO   .AUD070
.AUD064  ANOP
&CG14    SETC  '&EYEBALL'(1,1)
         AIF   ('&CG14' GE '0').AUD066
&BL5     SETB  (1)
         AGO   .AUD070
.AUD066  ANOP
&BL6     SETB  (1)
.AUD067  ANOP
&CG14    SETC  '&EYEBALL'(1,2)
&AL6     SETA  &CG14
         AIF   (&AL6 EQ 0).AUD068
         AIF   (&AL6 GT 64).AUD068
&CG14    SETC  '&EYEBALL'(3,2)
&AL7     SETA  &CG14
         AIF   (&AL7 EQ 0).AUD068
         AIF   (&AL7 GT 24).AUD068
&CG14    SETC  '&EYEBALL'(5,3)
&AL8     SETA  &CG14
         AIF   (&AL8 EQ 0).AUD068
         AIF   (&AL8 LE 150).AUD070
.AUD068  MNOTE 'KASAM IMPROPER EYEBALL'
&BL1     SETB  (1)
.AUD070  AIF   ('&PRTCODE' EQ 'ASA').AUD71
         AIF   ('&PRTCODE' EQ 'MACH').AUD71
         AIF   ('&LINKAGE' EQ '').AUD072
         AIF   ('&PRTCODE' NE 'COBOL').AUD072
         AIF   ('&CODETR' EQ '').AUD71
         MNOTE 'KASAM CODETR SPECIFIED WITH PRTCODE=COBOL'
         AGO   .AUD074
.AUD072  MNOTE 'KASAM IMPROPER PRTCODE'
         AGO   .AUD074
.AUD71   AIF   (NOT &BL1).AUDITOK
.AUD074 MNOTE 'KASAM GENERATION TERMINATED'
         MEXIT
.AUDITOK AIF   ('&LINKAGE' NE '').AUDN03
         AIF   ('&TYPEF' NE 'U').AUDNO1
&AL11    SETA  &INBLK+2
         AGO   .AUDNO2
.AUDNO1  ANOP
&AL11    SETA  &INBLK
.AUDNO2  ANOP
         DCBD  DSORG=(LR)
.AUDN03  ANOP
&SYSECT  CSECT
&CG13    SETC  'NO'
         AIF   ('&EYEBALL' EQ '').FD015
&CG13    SETC  'YES'
.FD015   AIF   (NOT &BL2).FD014
&CG15    SETC  'YES'
&CG14    SETC  'NO'
         AGO   .FD018
.FD014   ANOP
&CG15    SETC  'NO'
&CG14    SETC  'YES'
.FD018   AIF   ('&CHKSTP' EQ 'NO').FD020
&CG12    SETC  'YES'
         AGO   .FD022
.FD020   ANOP
&CG12    SETC  'NO'
.FD022   ANOP
         AIF   ('&RTRV' EQ '').FD023
&CG8     SETC  'YES'
         AIF   ('&MIR' EQ '').FD023
         AIF   ('&MIR' EQ 'BEFORE').FD023
         AIF   ('&MIR' EQ 'AFTER').FD023
         MNOTE 'KASAM IMPROPER MIR'
         AGOB  .AUD074
.FD023   ANOP
KFCOM KFCOM BUFNO=&OUTBUFN,BLKSIZE=&OUTBLK,DDNAME=&OUTNAME,KCHKR=&CG15,X
               KPARL=&CG14,KPERP=YES,KIBAL=&CG13,KSTOP=&CG12,LABADDR=&OX
               UTLADD,TAPETRK=&COMTAPE,GENIO=NO,IBTAB=&IBTAB,PTRNTAB=&PX
               TRNTAB,KRTRV=&CG8,PULDOWN=&PULDOWN,PTRNSKP=&PTRNSKP,MIR=X
               &MIR,IBSKIP=&IBSKIP,CLOSE=UNLOAD
         EJECT
 CNOP 0,4
&NAME EQU *
         AIF   ('&LINKAGE' EQ '').NOLINK1
         ENTRY &NAME
.NOLINK1 STM   14,12,12(13)
 BALR 11,0
 USING *,11
         ST    13,KSAVER+4
         LA    13,KSAVER
         AIF   ('&LINKAGE' EQ '').NOLINK2
         LR    2,1
KHSKP    B     KSTARTR
KADCHNG  DC    S(KLINK2)
KNEWREC  DC    CL&INRECSZ.' '
         AIF   ('&INRECF' EQ 'F').FD006
KSUBDW   DS    D
         AGO   .FD006
.NOLINK2 B     KSTARTR
         SPACE 2
&INNAME  DCB   DSORG=PS,MACRF=GL,DDNAME=&INNAME,RECFM=&TYPEF,LRECL=&INRX
               ECSZ,BLKSIZE=&AL11,BFTEK=S,BUFNO=&INBUFN,EODAD=KASAMEOF,X
               EXLST=&INLADD,EROPT=&ERR,SYNAD=&SYN
.FD006   EJECT
&OUTNAME DCB   DSORG=PS,MACRF=W,DDNAME=&OUTNAME,RECFM=U,EXLST=&OUTLADD,X
               BLKSIZE=&OUTBLK
 EJECT
 AIF ('&COMTAPE' EQ '7').GEN001
&CG8 SETC 'BC'
 AGO .GEN002
.GEN001 ANOP
&CG8 SETC 'D0'
.GEN002 ANOP
         CNOP  0,4
KSTARTR  EQU   *
 AIF ('&STRIP' NE '').GEN003
         TIME
         ST    1,KDWORKA
         UNPK  KHDRDATE+1(5),KDWORKA+1(3)
         OI    KHDRDATE+5,X'F0'
.GEN003  AIF   ('&LINKAGE' EQ '').GEN004
         MVC   KHSKP+2(2),KADCHNG
         KOPEN KFCOM
KLINK2   EQU   *
         AIF   ('&INRECF' EQ 'F').GEN003B
         LM    3,5,0(2)
         AGO   .GEN003D
.GEN003B LM    3,4,0(2)
.GEN003D AIF   ('&LINKAGE' NE 'PL').GEN003X
         L     3,0(3)
         L     4,0(4)
         AIF   ('&INRECF' EQ 'F').GEN003X
         L     5,0(5)
.GEN003X CLI   0(3),C'2'
         BE    KNEXT2
         CLI   0(3),C'0'
         BE    KASAMEOF
         AIF   ('&EDIT' NE '').KLINK1
         CLI   0(3),C'1'
         BNE   KLINK3
         MVI   KTERMSW,X'F0'
         B     KNEXT2
.KLINK1  ANOP
KLINK3   EQU   *
         AIF   ('&EYEBALL' NE 'YES').KLINK2
         CLI   0(3),C'3'
         BNE   KLINK4
         MVC   KIBALL,0(4)
         B     KEND
KLINK4   EQU   *
.KLINK2  MVI   KNEWREC,X'FF'
         AIF   ('&INRECF' EQ 'F').GEN003E
         LA    0,&INRECSZ
.GEN003E B     KNEXT3
KNEXT2   EQU   *
         AIF   ('&INRECF' EQ 'F').GEN003F
         PACK  KSUBDW,0(3,5)
         CVB   1,KSUBDW
         BCTR  1,0
         STC   1,KMOVEREC
         LA    0,1(1)
KMOVEREC EQU   *+1
.GEN003F MVC   KNEWREC,0(4)
KNEXT3   EQU   *
         LA    1,KNEWREC
         AIF   ('&INRECF' EQ 'V').GEN003H
         LA    0,&INRECSZ
.GEN003H AIF   ('&PRTCODE' NE 'COBOL').GEN003K
         TM    KNEWREC,X'F0'
         BO    KOBOLOK
         OI    KNEWREC,X'FF'
KOBOLOK  EQU   *
         TR    KNEWREC(1),KOBOLTBL-240
         B     KNEXT
KOBOLTBL DC    X'F140F060'
         DC    12X'00'
.GEN003K ANOP
KNEXT    EQU   *
         AGO   .GENED
.GEN004  OPEN  &INNAME
         KOPEN KFCOM
KGET     EQU   *
         AIF   ('&INRECF' EQ 'UB').GENDBLK
         AIF   ('&INRECF' NE 'VBA').GENGET
.GENDBLK ANOP
KDBGETSW EQU   *+1
         B     KDBGET
         L     3,KDBPTR
KDBTRT   TRT   0(247,3),KDBTBL
         BZ    KDBNOHIT
         LA    0,0(1)
         SR    0,3
         BZ    KDBEOB
KDBRBSW1 EQU   *+1
         NOP   KDBEOB
         CLI   1(1),0
         BNE   KDBSPTR
         MVI   KDBGETSW,X'F0'
         B     KDBLOAD
KDBSPTR  LA    1,1(1)
         ST    1,KDBPTR
KDBLOAD  EQU   *
         AIF   ('&INRECF' NE 'VBA').GENDB2
         LA    1,3(3)
         S     0,KDBTHREE
         B     KNEXT
KDBTHREE DC    F'3'
         AGO   .GENDB4
.GENDB2  LR    1,3
         B     KNEXT
.GENDB4  ANOP
KDBRBSW2 EQU   *+1
KDBNOHIT NOP   KDPTRPLS
         LA    0,256
         LA    1,255(3)
         MVI   KDBRBSW1,X'F0'
         MVI   KDBRBSW2,X'F0'
         B     KDBSPTR
KDPTRPLS LA    3,256(3)
         B     KDBTRT
KDBEOB   CLI   1(1),0
         BNE   KDBHTPTR
KDBGET   GET   &INNAME
         LA    3,&INNAME
         USING IHADCB,3
         LH    3,DCBLRECL
         CH    3,KBLKCHK
         BL    KBLKOK
         WTO   'KASAM INPUT EXCEEDS MAX SPECIFIED / JOB TERMINATED'
         B     KBLCKR
KBLKOK   EQU   *
.GENDB6  LR    2,1
.GENDB8  LA    4,0(3,2)
         MVI   0(4),X'&DELIM'
         MVI   1(4),0
         AIF   ('&INRECF' NE 'VBA').GENDB9
         LA    3,4(2)
         AGO   .GENDB10
.GENDB9  LR    3,2
.GENDB10 ANOP
KDBSWOFF MVI   KDBGETSW,0
         MVI   KDBRBSW1,0
         MVI   KDBRBSW2,0
         B     KDBTRT
KDBHTPTR LA    3,1(1)
         B     KDBSWOFF
KDBPTR   DS    F
KDBTBL   DC    256X'00'
         ORG   KDBTBL+X'&DELIM'
         DC    X'FF'
         ORG   KDBTBL+256
         AGO   .GEN012
.GENGET  ANOP
         GET   &INNAME
         LA    3,&INNAME
         USING IHADCB,3
         LH    3,DCBLRECL
         AIF   (NOT &BL7).KNGENK
         CH    3,KBLKCHK
         BL    KBLKOK
         WTO   'INPUT EXCEEDS MAX. SPECIFIED / JOB TERMINATED'
         B     KBLCKR
KBLKOK   EQU   *
.KNGENK  ANOP
         AIF   ('&INRECF' EQ 'VB').GEN011
         AIF   ('&INRECF' EQ 'V').GEN011
.GEN005  LR    0,3
         AGO   .GEN012
.GEN011  MVC   KGETHW,0(1)
         LH    0,KGETHW
         SH    0,KHW4
         LA    1,4(1)
         B     KNEXT
KGETHW   DS    H
KHW4     DC    H'4'
.GEN012  ANOP
KNEXT    EQU   *
         AIF   ('&SEL' EQ '').GENED
         AIF   ('&SEL' EQ 'YES').GENSEL4
         CLI   1(1),X'&SEL'
         BNE   KGET
         AGO   .GENSEL4
.GENSEL4 MVC   1(1,1),0(1)
         LA    1,1(1)
         BCTR  0,0
.GENED   AIF   ('&EDIT' EQ '').GENATR
         STM   0,1,KEDITLNG
KRETED   L     15,KEDITADR
         BALR  14,15
         CH    1,KEDITC1
         BH    KEDIT02
         AIF   ('&LINKAGE' EQ '').GENED1
         BL    KEND
         AGO   .GENED2
.GENED1  BL    KGET
.GENED2  MVI   KTERMSW,X'F0'
         LM    0,1,KEDITLNG
         B     KRETED
KEDIT02  EQU   *
         AIF   ('&INRECF' EQ 'U').NOCOMP
         C     1,KEDITPTR
         BE    KEDITEND
.NOCOMP  MVI   KINSRTSW,X'F0'
         B     KEDITEND
KEDITADR DC    A(&EDIT)
KEDITLNG DS    F
KEDITPTR DS    F
KEDITC1  DC    H'1'
.GENATR  ANOP
KEDITEND EQU   *
         AIF   ('&PRTCODE' EQ 'MACH').GENMACH
         AIF   ('&CODETR' EQ '').GENGRPH
         L     2,KASAADR
         TR    0(1,1),0(2)
         B     KASAEND
KASAADR  DC    A(&CODETR)
KASAEND  EQU   *
         AGO   .GENGRPH
.GENMACH AIF   ('&CODETR' EQ '').MACHOK
         L     2,KMACHTR
         TR    0(1,1),0(2)
.MACHOK  TM    0(1),X'02'
         BZ    KNOIMMED
         CLI   0(1),X'8B'
         BE    KREJMC
         CLI   KMCTRL1,X'01'
         BE    KREJMC
         CLI   KMCTRL1,X'03'
         BNE   KCHKCHAN
KREJMC   EQU   *
         MVI   KMCTRL1,X'00'
         OI    KMCSW,X'80'
         B     KNOIMMED
KCHKCHAN EQU   *
         TM    0(1),X'80'
         BZ    KBLDATA
         CLC   0(1,1),KMCTRL1
         BE    KREJMC
KBLDATA  EQU   *
         MVI   1(1),X'40'
         LR    2,0
         BCTR  2,0
         BCTR  2,0
         LTR   2,2
         BZ    KNOIMMED
         BCTR  2,0
         STC   2,KMCMVC+1
KMCMVC   MVC   2(1,1),1(1)
KNOIMMED EQU   *
         MVC   KMCTRL2,0(1)
         MVC   0(1,1),KMCTRL1
         MVC   KMCTRL1,KMCTRL2
         TR    0(1,1),KODTBL
         B     KMACHEND
         AIF   ('&CODETR' EQ '').NOTRAD
KMACHTR  DC    A(&CODETR)
.NOTRAD  ANOP
KMCSW    DC    X'00'
KMCTRL1  DC    X'01'
KMCTRL2  DS    CL1
KODTBL   DC    X'0050005000000000004000400000000000F000F000000000006000X
               60'
         DC    XL109'00'
         DC    X'F100F10000000000F200F20000000000F300F30000000000F400F4X
               0000000000F500F50000000000F600F60000000000F700F7000000'
         DC    X'0000F800F80000000000F900F90000000000F500F50000000000F6X
               00F60000000000F700F7'
         DC    XL28'00'
         DS    0H
KMACHEND EQU   *
.GENGRPH L     2,KGRPHADR
         LR    3,0
         BCT   3,KBCT
         B     KGRPHEND
KBCT     EQU   *
         BCTR  3,0
         EX    3,KGRPHTR
         B     KGRPHEND
KGRPHTR  TR    1(0,1),0(2)
         AIF   ('&GRAPHIC' EQ '').GENGR4
KGRPHADR DC    A(&GRAPHIC)
KGRPHEND EQU   *
         AGO   .GENNP
.GENGR4  ANOP
KGRPHADR DC    A(KGRPHTBL)
KGRPHTBL DC    74X'40'
         AIF   ('&DEVICE' NE 'TAPE9').GENGR6
         AIF   ('&COMTAPE' EQ '9').GENGR9
         DC    XL24'C34B4E4D6F4F504040404040404040404F5B5C5D6B4C6061'
         DC    9X'40'
         DC    XL21'6B6C6D7EC0404040404040404040407D7B7C5E6E5E'
         DC    65X'40'
         DC    XL9'C1C2C3C4C5C6C7C8C9'
         DC    7X'40'
         DC    XL17'D1D2D3D4D5D6D7D8D94040404040404040'
         AGO   .GENGR10
.GENGR6  AIF   ('&COMTAPE' NE '9').GENGR8
         DC    XL24'404BCC4D4C4F50404040404040404040405B5C5D5E5F6061'
         DC    9X'40'
         DC    XL21'6B6C6D7E4E40404040404040404040407B7C7A6E7F'
         DC    64X'40'
         DC    XL10'6FC1C2C3C4C5C6C7C8C9'
         DC    6X'40'
         DC    XL18'5AD1D2D3D4D5D6D7D8D94040404040404A40'
         AGO   .GENGR10
.GENGR8  DC    XL24'404B4C4D4E4F50404040404040404040405B5C5D6B4C6061'
         DC    9X'40'
         DC    XL21'6B6C6D6E6F40404040404040404040407B7C7D7E4C'
         DC    64X'40'
         DC    XL10'C0C1C2C3C4C5C6C7C8C9'
         DC    6X'40'
         DC    XL18'5ED1D2D3D4D5D6D7D8D94040404040404C40'
         AGO   .GENGR10
.GENGR9  DC    XL24'4A4B4C4D4E4F504040404040404040405A5B5C5D5E5F6061'
         DC    9X'40'
         DC    XL21'6B6C6D6E6F404040404040404040407A7B7C7D7E7F'
         DC    65X'40'
         DC    CL31'ABCDEFGHI       JKLMNOPQR'
         DC    XL2'CC40'
.GENGR10 DC    CL8'STUVWXYZ'
         DC    6X'40'
         DC    XL16'F0F1F2F3F4F5F6F7F8F9404040404040'
KGRPHEND EQU   *
.GENNP   ANOP
K1ST     EQU   *+1
         NOP   KCHK41
         AIF   ('&PRTCODE' NE 'MACH').KOPNDH1
         CLI   0(1),X'00'
         BE    KOPASANG
.KOPNDH1 ANOP
         MVI   K1ST,X'F0'
         LR    10,0
         AIF   ('&BREAK' EQ '').NP001
&CG14    SETC  '&BREAK'(1,2)
&AL9     SETA  &CG14
&CG13    SETC  '&BREAK'(3,3)
&AL10    SETA  &CG13
KMVBRK1  MVC   KBRFLD(&AL9.),&AL10.(1)
         B     *+36
KBRFLD   DS    CL32
.NP001   B     KNXTSECT
KCHK41   EQU   *
         CLI   0(1),C'1'
         BE    KFRDONE
         AIF   ('&PRTCODE' NE 'MACH').KOPNDH2
         CLI   0(1),X'00'
         BE    KOPASANG
.KOPNDH2 ANOP
         LH    2,KLINE#
         LA    2,1(2)
         STH   2,KLINE#
         AIF   ('&RTRV' EQ '').NP002
         B     KRTRVLNK
         AGO   .NP003
.NP002   B     KOPACOMP
.NP003   AIF   (NOT &BL6).NP006
KSWI     EQU   *-3
         B     KIBSRCH
.NP006   ANOP
KNXTSECT EQU   *
         AIF   (&BL2).NP010
         KPARL KFCOM
         AIF   ('&BGNPAD' EQ '').NP012
         KPGND KFCOM,A,&BGNPAD
         AGO   .NP012
.NP010   KPGND KFCOM,A,&LEDR
         KCHKR KFCOM
         AIF   (NOT &BL5).NP011
         CNOP  2,4
         L     15,*+10
         BALR  14,15
         B     KBLDHDR
         DC    AL1(0)
         DC    AL3(&EYEBALL)
KBLDHDR  EQU   *
.NP011   ANOP
         LH    2,KSECT#
         CVD   2,KDW
         UNPK  KHDRSEQ,KDW+6(2)
         OI    KHDRSEQ+2,X'F0'
         KPUT  KFCOM,KHDR
         KPGND KFCOM,A
         AIF   ('&RTRV' EQ '').NORT1
         CNOP  0,4
         L     15,*+8
         B     *+8
         DC    AL1(2)
         DC    AL3(&RTRV)
         BALR  14,15
         AIF   ('&MIR' NE 'BEFORE').NORT1
         KPUT  KFCOM,KDUMBY
         KPGND KFCOM,F
.NORT1   LR    0,10
         B     KHDRDONE
KDW      DS    D
KHDR     EQU   *
KHDRLNG  DC    H'64'
         DC    CL8'  \1T1'
         DC    X'&CG8'
         DC    CL15'HEADER &HDR'
         DC    CL6'\-T1'
         DC    X'&CG8'
         DC    CL10'START SEQ'
KHDRSEQ  DC    CL3'000'
         DC    CL6'\-T1'
         DC    X'&CG8'
         DC    CL5'DATE'
KHDRDATE DC    CL6' '
KHDRDONE EQU   *
.NP012   AIF   (NOT &BL6).NP014
         MVI   KSWI,X'00'
         LH    2,KLINE#
KIBSRCH  EQU   *
         CH    2,KIBLINE#
         AIF   ('&RTRV' NE '').NP013
         BNE   KOPACOMP
         AGO   .NP013C
.NP013   BNE   KRTRVLNK
.NP013C  ANOP
&CG14    SETC  '&EYEBALL'(3,2)
&AL9     SETA  &CG14
&CG13    SETC  '&EYEBALL'(5,3)
&AL10    SETA  &CG13
         MVC   KIBALL(&AL9.),&AL10.(1)
.NP014   AIF   ('&RTRV' EQ '').NP016
KRTRVLNK EQU   *
         MVC   KMVI+1(1),0(1)
         LA    1,1(1)
         STM   0,1,KRTRVDUB
KMVI     MVI   KRTRVDUB+4,C'X'
         L     1,KRTRVDUB+4
         L     15,KRAD1
         BALR  14,15
         LM    0,1,KRTRVDUB
         BCTR  1,0
         B     KOPACOMP
         CNOP  0,4
KRAD1    DC    AL1(0)
         DC    AL3(&RTRV)
KRTRVDUB DS    D
         AIF   ('&EDIT' NE '').NP018
KEDITLNG DS    F
KEDITPTR DS    F
         AGO   .NP018
.NP016   B     KOPACOMP
.NP018   ANOP
KFRDONE  B     KREJEXEP
         KPGND KFCOM,&PGEND
         LH    2,KFRAME#
         LA    2,1(2)
         STH   2,KFRAME#
KREJEXEP EQU   *
         MVI   KLINE#,X'00'
         MVI   KLINE#+1,X'01'
         AIF   ('&RTRV' EQ '').NP019
         STM   0,1,KLPSAV
KNXTRTRV L     15,KRAD2
         BALR  14,15
         STC   0,KSAVCODE
         CLI   KSAVCODE,X'00'
         BE    KNORTVA
         LR    0,1
         KRTRV KFCOM
         CLI   KSAVCODE,X'02'
         BE    KNXTRTRV
KNORTVA  LM    0,1,KLPSAV
         CNOP  0,4
         B     *+18
KRAD2   DC    AL1(1)
         DC    AL3(&RTRV)
KLPSAV   DS    2F
KSAVCODE DS    H
.NP019   AIF   ('&EDIT' NE '').NP019C
         AIF   ('&LINKAGE' EQ '').NP020
.NP019C  ANOP
KTERMSW  EQU   *+1
         NOP   KSECTEND
.NP020   CLC   KFRAME#,KFRSECT
KBR      EQU   *+1
         AIF   (&BL2).NP021
         NOP   KSECTEND
.NP021   BE    KSECTDON
.NP022   AIF   (NOT &BL6).NP024
         MVI   KSWI,X'F0'
.NP024   AIF   ('&BREAK' NE '').NP026
         AIF   ('&RTRV' EQ '').NPR1
         B     KRTRVLNK
         AGO   .NPR2
.NPR1    B     KOPACOMP
.NPR2    ANOP
         AIF   ('&EDIT' NE '').NP028
         AIF   ('&LINKAGE' NE '').NP028
KSECTEND EQU   *
         AGO   .NP032
.NP026   ANOP
&CG14    SETC  '&BREAK'(1,2)
&AL9     SETA  &CG14
&CG13    SETC  '&BREAK'(3,3)
&AL10    SETA  &CG13
         CLC   KBRFLD(&AL9),&AL10.(1)
         AIF   ('&RTRV' EQ '').NPR3
         BE    KRTRVLNK
         AGO   .NP028
.NPR3    BE    KOPACOMP
.NP028   ANOP
KSECTEND EQU   *
         AIF   ('&EDIT' NE '').NP031
         AIF   ('&LINKAGE' EQ '').NP032
.NP031   MVI   KTERMSW,X'00'
.NP032   AIF   (&BL2).NP034
         LH    2,KFRSECT
         SH    2,KFRAME#
         KPGND KFCOM,A,(2)
.NP034   ANOP
KSECTDON EQU   *
         AIF   ('&BREAK' EQ '').NP034C
         MVC   KBRFLD(&AL9),&AL10.(1)
.NP034C  AIF   (NOT &BL2).NP036
         LR    10,0
         AIF   ('&MIR' EQ '').NP034Q
         AIF   ('&MIR' NE 'AFTER').NP034K
         KPUT  KFCOM,KDUMBY
         KPGND KFCOM,F
.NP034K  B     KTRLAR
KDUMBY   DC    H'22'
         DC    CL8'  \1T1'
         DC    X'&CG8'
         DC    CL11'DUMMY FRAME'
KTRLAR   EQU   *
.NP034Q  ANOP
         MVC   KTRLRSEQ,KHDRSEQ
         LH    2,KFRAME#
         CVD   2,KDW
         UNPK  KSECTCNT,KDW+5(3)
         OI    KSECTCNT+3,X'F0'
         CLI   KEOFSW2,X'F0'
         BNE   *+10
         MVC   KTRLRMSG(4),KMSGNONE
         KPUT  KFCOM,KTRLR
         KPGND KFCOM,A
         AIF   ('&EYEBALL' EQ '').NP0355
         AIF   (NOT &BL5).NP035
         L     15,KUSERAD
         BALR  14,15
         B     KENDCHKR
         DS    0F
KUSERAD  DC    AL1(1)
         DC    AL3(&EYEBALL)
         AGO   .NP0355
.NP035   LA    0,KIBALL
         KIBAL KFCOM
         MVI   KIBALL,X'40'
         MVC   KIBALL+1(23),KIBALL
.NP0355  ANOP
KENDCHKR EQU   *
         KCHKR KFCOM
         B     KTRLRDON
KMSGNONE DC    C'NONE'
KTRLR    EQU   *
KTRLRLNG DC    H'84'
         DC    CL8'  \1T1'
         DC    X'&CG8'
         DC    CL16'TRAILER &HDR'
         DC    CL6'\-T1'
         DC    X'&CG8'
         DC    CL8'END SEQ'
KTRLRSEQ DC    CL3'000'
         DC    CL6'\-T1'
         DC    X'&CG8'
KSECTCNT DC    CL4'0000'
         DC    CL7' FRAMES'
         DC    CL6'\-T1'
         DC    X'&CG8'
KTRLRMSG DC    CL14'MORE TO FOLLOW'
         DS    0H
KTRLRDON EQU   *
         AGO   .NP044
.NP036  AIF   ('&EYEBALL' EQ '').NP041
         STM   0,1,KRSAV
         B     KRSAV+8
KRSAV    DS    D
         AIF   (NOT &BL5).NP038
         L     15,KUSERAD
         BALR  14,15
         LM    0,1,KRSAV
         B     KUSERAD+4
         DS    0F
KUSERAD  DC    AL1(1)
         DC    AL3(&EYEBALL)
         AGO   .NP041
.NP038   LA    0,KIBALL
         KIBAL KFCOM
         LM    0,1,KRSAV
         MVI   KIBALL,X'40'
         MVC   KIBALL+1(23),KIBALL
.NP041   AIF   ('&ENDPAD' EQ '').NP042
         KPGND KFCOM,A,&ENDPAD
.NP042   ANOP
         L    15,KSTRPCT
         LA    15,1(15)
         ST    15,KSTRPCT
         B    KSTP1
KSTRPCT  DC    F'0'
KSTP1    EQU   *
.NP044   LH    3,KSECT#
         LA    4,1(3)
         STH   4,KSECT#
         XC    KFRAME#,KFRAME#
KEOFSW2  EQU   *+1
         NOP   KEFEND
         AIF   ('&CHKSTP' EQ 'NO').NP046
         SR    2,2
         D     2,KSTOPCNT
         LTR   2,2
         BC    7,KNXTSECT
         KSTOP KFCOM
.NP046   B     KNXTSECT
         AIF   ('&CHKSTP' EQ 'NO').NP048
KSTOPCNT DC    F'&AL3'
.NP048   ANOP
KFRSECT  DC    H'&AL2'
KLINE#   DC    H'1'
KSECT#   DC    H'1'
KFRAME#  DC    H'0'
         AIF   (&BL6).NP049
         AIF   (NOT &BL4).NP050
.NP049   ANOP
KIBALL   DC    CL24' '
         AIF   (&BL4).NP050
&CG14    SETC  '&EYEBALL'(1,2)
&AL9     SETA  &CG14
KIBLINE# DC    H'&AL9'
.NP050   ANOP
KOPACOMP CLI   0(1),C' '
         BE    KOPASAOK
         CLI   0(1),C'-'
         BE    KOPASAOK
         CLI   0(1),C'9'
         BH    KOPASANG
         TM    0(1),X'F0'
         BO    KOPASAOK
.OP002   CLI   0(1),X'50'
         BE    KOPASAOK
         CLI   0(1),X'4E'
         BNE   KOPASANG
         MVI   0(1),X'50'
         B     KOPASAOK
.OP004   ANOP
KOPASANG EQU   *
         AIF   ('&PRTCODE' EQ 'ASA').OP005
         AIF   ('&PRTCODE' EQ 'COBOL').OP005
         TM    KMCSW,X'80'
         BZ    KOPNFX
         NI    KMCSW,X'7F'
         B     KOPNEXT
.OP005   ANOP
KOPNFX   L     2,KREJCNT
         LA    2,1(2)
         ST    2,KREJCNT
         B     KOPNEXT
KOPASAOK LR    2,0
         LA    2,13(2)
         STH   2,KOPWORKA
         MVC   KOPWORKA+2(12),KOPPRFX
         MVC   KOPWORKA+5(1),0(1)
         MVC   KOPWORKA+14(256),1(1)
         LA    0,KOPWORKA
         MVI   KFRDONE+1,X'00'
         KPUT  KFCOM
KOPNEXT  EQU   *
.OPN01   AIF   ('&EOFADDR' EQ '').OP006
KEOFSW1  EQU   *+1
         NOP   KEFUSER
.OP006   AIF   ('&EDIT' EQ '').OP008
KINSRTSW EQU   *+1
         NOP   KOPINSRT
         AIF   ('&LINKAGE' EQ '').OP007
         B     KEND
         AGO   .OP007A
.OP007   B     KGET
.OP007A  ANOP
KOPINSRT MVI   KINSRTSW,0
        LM     0,1,KEDITLNG
         B     KRETED
         AGO   .EF002
.OP008   AIF   ('&LINKAGE' EQ '').OP008A
         B     KEND
         AGO   .EF002
.OP008A  B     KGET
.EF002   ANOP
KASAMEOF EQU   *
.EF004   AIF   ('&EOFADDR' EQ '').EF006
         MVI   KEOFSW1,X'F0'
KEFUSER  L     15,KEFADDR
         BALR  14,15
         LTR   1,1
         BZ    KEFSS2
         B     KEDITEND
KEFADDR  DC    A(&EOFADDR)
KEFSS2   EQU   *
.EF006   ANOP
KBLCKR   MVI   KEOFSW2,X'F0'
         AIF   ('&LINKAGE' NE '').EF008
         CLOSE &INNAME
.EF008   MVI   KBR,X'F0'
         B     KFRDONE
KEFEND   EQU   *
         AIF   (NOT &BL2).EF008A
         KPGND KFCOM,A,&LEDR
         AGO   .EF008B
.EF008A  KPARL KFCOM
.EF008B  KPERP KFCOM
         KLOSE KFCOM
         CVD   15,KDWORKA
         UNPK  KFRMWTO+22(6),KDWORKA
         OI    KFRMWTO+27,X'F0'
KFRMWTO  WTO   'FRAME COUNT -       '
         AIF   (&BL2).GENIXS
         L    15,KSTRPCT
         CVD   15,KDWORKA
         UNPK  KSTPWTO+22(6),KDWORKA
         OI    KSTPWTO+27,X'F0'
KSTPWTO  WTO   'STRIP COUNT -       '
.GENIXS  L    1,KREJCNT
         LTR   1,1
         BZ    KEND
         CVD   1,KDWORKA
         UNPK  KCHEKO+8(6),KDWORKA
         OI    KCHEKO+13,X'F0'
KCHEKO   WTO   '       LINES REJECTED'
KEND     L     13,KSAVER+4
         RETURN (14,12),T
         AIF   (NOT &BL7).NOENGN
KBLKCHK  DC    H'&AL11'
.NOENGN  ANOP
KOPPRFX  DC    X'4040E040E3F14040404040&CG8.40'
KEOFREP  EQU   *
KREP1    DS    CL3
KECB1    DC    F'0'
KSAVER   DS    18F
KDWORKA  DS    D
KREJCNT  DC    F'0'
KOPWORKA DS    270CL1
         CNOP  0,4
KOUT1 DS &OUTBLK.CL1
 AIF ('&OUTBUFN' NE '2').FD025
KOUT2 DS &OUTBLK.CL1
.FD025 EJECT
         CNOP  0,4
         MEND
./ ADD  NAME=KCHKR
         MACRO
&NAME    KCHKR &FILEN,&COUNT
         GBLC  &CG14
         LCLA  &AL1
*  KODAK KOM-90 MICROFILMER SOFTWARE  OS VER 2  10/01/69
         AIF   ('&FILEN' NE '').A
         MNOTE 'NO FILENAME SPECIFIED'
         MEXIT
.A       ANOP
         CNOP  2,4
         AIF   ('&NAME' EQ '').B
&NAME    EQU   *
.B       AIF   ('&COUNT' EQ '').K
&CG14    SETC  '&COUNT'(1,1)
         AIF   ('&CG14' NE '(').C
&CG14    SETC  '&COUNT'(3,1)
         AIF   ('&CG14' EQ ')').D
&CG14    SETC  '&COUNT'(4,1)
         AIF   ('&CG14' EQ ')').E
.ERR     MNOTE 'IMPROPER SECOND OPERAND,VALUE OF 1 ASSIGNED'
         AGO   .K
.D       ANOP
&CG14    SETC  '&COUNT'(2,1)
         AIFB  ('&CG14' LT '0').ERR
         AGO   .F
.E       ANOP
&CG14    SETC  '&COUNT'(2,2)
         AIFB  ('&CG14' GT '15').ERR
         AIFB  ('&CG14' LT '10').ERR
.F       STC   &CG14,*+14
&AL1     SETA  0
         AGO   .LAST
.K       ANOP
&AL1     SETA  1
         AGO   .LAST
.C       AIFB  ('&COUNT' GT '255').ERR
&AL1     SETA  &COUNT
         AIFB  ('&AL1' LT '1').ERR
.LAST    L     15,*+6
         BALR  14,15
         DC    AL1(4)
         DC    AL3(&FILEN)
         DC    AL1(&AL1)
         DC    AL1(0)
         MEND
./ ADD  NAME=KFCOM
         MACRO
&NAME         KFCOM &BLKSIZE=1500,&BUFNO=2,&DDNAME=,&EOFADDR=1,&TYPEFLEX
               =OUTPUT,&ERROPT=ABE,&KCHKR=NO,&KPARL=NO,&KPERP=NO,      X
               &KIBAL=NO,&KSTOP=NO,&KPGND=NO,&KRTRV=NO,&TAPETRK=9,     X
               &ASA=NO,&RECFM=V,&LRECL=,&DEVADDR=,&FILABL=NO,          X
               &LABADDR=0,&CLOSE=,&ALTTAPE=,&TPMARK=YES,&GENIO=,&IBTAB=X
               ,&PTRNTAB=,&PULDOWN=3,&PTRNSKP=,&LINKAGE=,&MIR=,        X
               &IBSKIP=
   LCLA  &AL1,&AL2,&AL3,&AL4,&AL5,&AL6
              LCLB  &BL1,&BL2,&BL3,&BL4,&BL5,&BL6,&BL7,&BL8,&BL9,&BL10
              LCLB  &BL101,&BL102,&BL103,&BL104,&BL106,&BL107
              LCLB  &BL11,&BL12,&BL100
         LCLC  &EROPT,&SYNAD,&KLOSE,&BUF,&OPTN,&BUFN,&EOFAD
*  KODAK KOM-90 MICROFILMER SOFTWARE  OS VER 2  10/01/69
 AIF ('&NAME' NE '').ABLK
 MNOTE 'KFCOM  NAME OMITTED'
&BL1 SETB (1)
.ABLK ANOP
&AL2     SETA  &BLKSIZE
&AL1 SETA &BLKSIZE
 AIF (&AL1 NE 0).ABLKMAX
 MNOTE 'KFCOM  BLKSIZE INVALID'
&BL1 SETB (1)
 AGO .ADDN
.ABLKMAX AIF (&AL1 LE 16383).ADDN
 MNOTE 'KFCOM  BLKSIZE EXCEEDS MAXIMUM'
&BL1 SETB (1)
.ADDN AIF ('&DDNAME' NE '').ACLS
 MNOTE 'KFCOM  DDNAME OMITTED'
&BL1 SETB (1)
.ACLS         AIF   ('&CLOSE' EQ 'UNLOAD').ATPF
         AIF   ('&CLOSE' NE'').CLSNR
&KLOSE   SETC  'REREAD'
              AGO   .ATPF
.CLSNR        AIF   ('&CLOSE' NE 'NORWD').CLSERR
&KLOSE   SETC  'LEAVE'
              AGO   .ATPF
.CLSERR       MNOTE 'KFCOM  CLOSE INVALID-UNLOAD ASSUMED'
.ATPF         AIF   ('&TYPEFLE' EQ 'OUTPUT').ABUFO
 AIF ('&TYPEFLE' EQ 'INPUT').AEOF
 MNOTE 'KFCOM  TYPEFLE INVALID'
&BL1 SETB (1)
              AGO   .ABUFO
.AEOF    AIF   ('&LINKAGE' EQ '').AEOF1
         MNOTE 'KFCOM  LINKAGE INVALID WITH INPUT FILE'
&BL1     SETB  (1)
.AEOF1   AIF   ('&EOFADDR' NE '1').INPT
              MNOTE 'KFCOM  EOFADDR OMITTED FOR INPUT DATA SET'
&BL1 SETB (1)
.INPT ANOP
&EOFAD   SETC  'K185&SYSNDX'
&BL2 SETB (1)
&AL1          SETA  &BUFNO
              AIF   (&AL1 NE 0).SETBUF
              MNOTE 'KFCOM  BUFNO INVALID'
&BL1     SETB  (1)
              AGO   .EOPT
.SETBUF       ANOP
.EOPT    AIF   ('&ERROPT' EQ 'ABE').ACC
         AIF   ('&ERROPT' EQ 'SKP').ACC
         AIF   ('&ERROPT' EQ 'ACC').ACC
&EROPT   SETC  'SKP'
&SYNAD   SETC  '&ERROPT'
         AGO   .TESTGEN
.ACC     ANOP
&EROPT   SETC  '&ERROPT'
&SYNAD  SETC  '1'
         AGO   .TESTGEN
.ABUFO   ANOP
&EOFAD   SETC  '1'
         AIF   ('&BUFNO' EQ '1').ACKR
              AIF   ('&BUFNO' EQ '2').ACKR
              MNOTE 'KFCOM  BUFNO INVALID'
&BL1     SETB  (1)
.ACKR    AIF   ('&LINKAGE' EQ '').ACKR1
         AIF   ('&LINKAGE' EQ 'COBOL').ACKR1
         AIF   ('&LINKAGE' EQ 'PL').ACKR1
         AIF   ('&LINKAGE' EQ 'FORTRAN').ACKR1
         AIF   ('&LINKAGE' EQ 'ASSEMB').ACKR1
         MNOTE 'KFCOM  LINKAGE INVALID'
&BL1     SETB  (1)
.ACKR1   AIF   ('&KCHKR' EQ 'NO').APRL
 AIF ('&KCHKR' NE 'YES').CKRN
&BL3 SETB (1)
&BL10 SETB (1)
 AGO .APRL
.CKRN MNOTE 'KFCOM  KCHKR INVALID-''NO'' ASSUMED'
.APRL AIF ('&KPARL' EQ 'NO').APPN
 AIF ('&KPARL' NE 'YES').PRLN
&BL4 SETB (1)
&BL10 SETB (1)
 AGO .APPN
.PRLN MNOTE 'KFCOM  KPARL INVALID-''NO'' ASSUMED'
.APPN AIF ('&KPERP' EQ 'NO').AIBL
 AIF ('&KPERP' NE 'YES').PPNN
&BL5 SETB (1)
&BL10 SETB (1)
 AGO .AIBL
.PPNN MNOTE 'KFCOM  KPERP INVALID-''NO'' ASSUMED'
.AIBL AIF ('&KIBAL' EQ 'NO').ASTP
 AIF ('&KIBAL' NE 'YES').IBLN
&BL6 SETB (1)
&BL10 SETB (1)
 AGO .ASTP
.IBLN MNOTE 'KFCOM  KIBAL INVALID-''NO'' ASSUMED'
.ASTP AIF ('&KSTOP' EQ 'NO').ARTV
 AIF ('&KSTOP' NE 'YES').STPN
&BL7 SETB (1)
 AGO .ARTV
.STPN MNOTE 'KFCOM  KSTOP INVALID-''NO'' ASSUMED'
.ARTV  AIF ('&KRTRV' EQ 'NO').APGN
         AIF   ('&KRTRV' EQ '').APGN
         AIF   ('&MIR' EQ '').APGN1
         AIF   ('&MIR' EQ 'BEFORE').APGN1
         AIF   ('&MIR' EQ 'AFTER').APGN1
         MNOTE 'KFCOM MIR INVALID'
&BL1     SETB  (1)
.APGN1   ANOP
 AIF ('&KRTRV' NE 'YES').RTRVN
&BL8 SETB (1)
 AGO .APGN
.RTRVN MNOTE 'KFCOM  KRTRV INVALID-''NO'' ASSUMED'
.APGN AIF ('&KPGND' EQ 'NO').BLKMIN
 AIF ('&KPGND' NE 'YES').PGNN
&BL10 SETB (1)
 AGO .BLKMIN
.PGNN MNOTE 'KFCOM  KPGND INVALID-''NO'' ASSUMED UNLESS NEEDED  BY OTHEX
               R ROUTINES'
.BLKMIN ANOP
&AL2 SETA &BLKSIZE
 AIF (NOT &BL10).ASA
 AIF (&BLKSIZE GE 90).ASA
 MNOTE 'KFCOM  BLKSIZE INCREASED TO 90 TO HANDLE INTERNALLY GENERATED RX
               ECORDS'
&AL2 SETA 90
.ASA AIF ('&ASA' EQ 'NO').RECFM
 AIF ('&ASA' EQ 'YES').ASAPE
 MNOTE 'KFCOM  ASA INVALID'
&BL1 SETB (1)
.ASAPE ANOP
&BL10 SETB (1)
.RECFM   AIF   ('&RECFM' NE 'V').RECFMF
         AIF   ('&LINKAGE' NE '').LRECL
         AGO   .TRK
.RECFMF  AIF   ('&RECFM' EQ 'F').LRECL
 MNOTE 'KFCOM  RECFM INVALID'
&BL1 SETB (1)
.LRECL ANOP
&AL1 SETA &LRECL
 AIF (&AL1 NE 0).LRECLNU
 MNOTE 'KFCOM  LRECL INVALID'
 AGO .LRECERR
.LRECLNU AIF ('&ASA' NE 'YES').ANO
 AIF (&LRECL+9 GT &BLKSIZE).RECLERA
 AIF (&LRECL GT 135).RECLMAX
 AGO .TRK
.ANO AIF (&LRECL GT &BLKSIZE).RECLERR
 AIF (&LRECL LE 145).TRK
.RECLMAX MNOTE 'KFCOM  WARNING-LRECL EXCEEDS NORMAL PRINT LINE SIZE'
 AGO .TRK
.RECLERA MNOTE 'KFCOM  LRECL PLUS CONTROL PREFIX EXCEEDS BLKSIZE'
 AGO .LRECERR
.RECLERR MNOTE 'KFCOM  LRECL EXCEEDS BLKSIZE'
.LRECERR ANOP
&BL1 SETB (1)
.TRK ANOP
&BL11 SETB ('&TAPETRK' EQ '7')
         AIF   (&BL11).AIBSKP
         AIF   ('&TAPETRK' EQ '9').AIBSKP
 MNOTE 'KFCOM  TAPETRK INVALID'
&BL1 SETB (1)
.AIBSKP  AIF   ('&IBSKIP' EQ '').AITAB
         AIF   ('&IBSKIP' GE '1').AIBS
.IBSKN   MNOTE 'KFCOM IBSKIP INVALID'
&BL1     SETB  (1)
         AGO   .AITAB
.AIBS    AIFB  ('&IBSKIP' GT '9').IBSKN
.AITAB AIF ('&IBTAB' EQ '').APTAB
&AL3 SETA &IBTAB
 AIF (&AL3 EQ 0).ITABNG
 AIF (&AL3 LE 8).APTAB
.ITABNG MNOTE 'KFCOM  IBTAB INVALID-''1'' ASSUMED'
&AL3 SETA 1
.APTAB   AIF   ('&PTRNTAB' EQ '').TESTSKP
&AL4 SETA &PTRNTAB
 AIF (&AL4 EQ 0).PTABNG
         AIF   (&AL4 LE 8).TESTSKP
.PTABNG MNOTE 'KFCOM  PTRNTAB INVALID-''1'' ASSUMED'
&AL4 SETA 1
.TESTSKP AIF   ('&PTRNSKP' EQ '').TESTPUL
&AL5     SETA  &PTRNSKP
         AIF   (&AL5 GT 9).SKPMN
         AIF   (&AL5 NE 0).TESTGEN
.SKPMN   MNOTE 'KFCOM PTRNSKP INVALID-''1'' ASSUMED'
&AL5     SETA  1
.TESTPUL ANOP
&AL6     SETA  &PULDOWN
         AIF   (&AL6 EQ 1).TESTGEN
         AIF   (&AL6 EQ 2).TESTGEN
         AIF   (&AL6 EQ 3).TESTGEN
         MNOTE 'KFCOM IMPROPER PULDOWN'
&BL1     SETB  (1)
.TESTGEN AIF (NOT &BL1).GEN
              MNOTE 8,'KFCOM  GENERATION TERMINATED'
 MEXIT
.GEN DS 0H
 USING *,15
&NAME    EQU   *
         AIF   ('&LINKAGE' EQ '').GEN1
         SAVE   (14,12)
         ENTRY &NAME
         BALR  6,0
         USING  *,6
         ST    13,K040&SYSNDX
         LA    13,K040&SYSNDX
         LM    2,4,0(1)
         AIF   ('&LINKAGE'  NE 'PL').CMP3
         L     2,0(2)
         L     3,0(3)
         L     4,0(4)
.CMP3   MVC  K039&SYSNDX,0(2)
         TR    K039&SYSNDX,K038&SYSNDX
         AIF   ('&RECFM' NE 'F').CMP1
         CLI   K039&SYSNDX,X'09'
         BE    K007&SYSNDX
         B     K008&SYSNDX
         AGO   .CMP2
.CMP1    ANOP
         CLI   K039&SYSNDX,X'00'
         BE    K007&SYSNDX
         CLI   K039&SYSNDX,X'09'
         BNE   K008&SYSNDX
.CMP2    ANOP
K007&SYSNDX  PACK K037&SYSNDX+6(2),0(3,4)
         CVB   1,K037&SYSNDX
         CLI   K039&SYSNDX,X'09'
         BE    K014&SYSNDX
         CH    1,K036&SYSNDX
         BH    K010&SYSNDX
K014&SYSNDX  LR  7,1
         LA    1,4(0,1)
         STH   1,K041&SYSNDX
K008&SYSNDX CLI K039&SYSNDX,X'FF'
         BNE   K009&SYSNDX
K010&SYSNDX  L  13,K040&SYSNDX
         LM    14,12,12(13)
         ABEND 10
K009&SYSNDX CLI K039&SYSNDX,X'00'
         BE    K011&SYSNDX
         CLI   K039&SYSNDX,X'01'
         BE    K011&SYSNDX
         CLI   K039&SYSNDX,X'02'
         BE    K011&SYSNDX
         CLI   K039&SYSNDX,X'09'
         BE    K011&SYSNDX
         MVC   K026&SYSNDX,K039&SYSNDX
         CLI   K026&SYSNDX,X'07'
         BNE   K012&SYSNDX
         MVC   K035&SYSNDX,0(3)
         MVC   K027&SYSNDX,0(4)
         B     K013&SYSNDX
K012&SYSNDX      PACK K037&SYSNDX+6(2),0(3,3)
         CVB   1,K037&SYSNDX
         STC   1,K027&SYSNDX
         CLI   K026&SYSNDX,X'08'
         BNE   K013&SYSNDX
         MVC   K028&SYSNDX,0(4)
K013&SYSNDX LA 0,K035&SYSNDX
         B     K025&SYSNDX
K011&SYSNDX MVC K024&SYSNDX,K039&SYSNDX
         CLI   K024&SYSNDX,X'01'
         BE    K023&SYSNDX
         CLI   K024&SYSNDX,X'02'
         BE    K023&SYSNDX
         AIF   ('&RECFM' NE 'F').COMPLG
         CLI   K024&SYSNDX,X'09'
         BE    K021&SYSNDX
         LR    0,3
         B     K023&SYSNDX
.COMPLG  ANOP
K021&SYSNDX  BCTR  7,0
         EX    7,K043&SYSNDX
         LA    0,K041&SYSNDX
         B     K023&SYSNDX
         CNOP  2,4
K025&SYSNDX  L 15,*+6
         BALR  14,15
K026&SYSNDX DC AL1(0)
            DC AL3(K000&SYSNDX)
K027&SYSNDX DC AL1(0)
K028&SYSNDX DC AL1(0)
         B     K015&SYSNDX
         CNOP  2,4
K023&SYSNDX  L 15,*+6
         BALR  14,15
K024&SYSNDX DC AL1(0)
            DC AL3(K000&SYSNDX)
         CLI   K024&SYSNDX,X'01'
         BNE   K015&SYSNDX
         CVD   15,K037&SYSNDX
         UNPK  K033&SYSNDX,K037&SYSNDX
         MVZ   K033&SYSNDX+5(1),K033&SYSNDX+4
         MVC   0(6,3),K033&SYSNDX
K015&SYSNDX MVC K037&SYSNDX,K044&SYSNDX
             L  13,K040&SYSNDX
         RETURN (14,12)
K038&SYSNDX DC 256X'FF'
         ORG   K038&SYSNDX+X'F0'
         DC    X'000102'
         AIF   (NOT &BL7).TB2
         DC    X'03'
.TB2     AIF   (NOT &BL3).TB4
         AIF   (&BL7).TB3
         ORG   K038&SYSNDX+X'F4'
.TB3     DC    X'04'
.TB4     AIF   (NOT &BL4).TB6
         AIF   (&BL3).TB5
         ORG   K038&SYSNDX+X'F5'
.TB5     DC    X'05'
.TB6     AIF   (NOT &BL5).TB8
         AIF   (&BL4).TB7
         ORG   K038&SYSNDX+X'F6'
.TB7     DC    X'06'
.TB8     AIF   (NOT &BL6).TB10
         AIF   (&BL5).TB9
         ORG   K038&SYSNDX+X'F7'
.TB9     DC    X'07'
.TB10    AIF   (NOT &BL10).TB12
         AIF   (&BL6).TB11
         ORG   K038&SYSNDX+X'F8'
.TB11    DC    X'08'
.TB12    AIF   (NOT &BL8).TB14
         AIF   (&BL10).TB13
         ORG   K038&SYSNDX+X'F9'
.TB13    DC    X'09'
.TB14    AIF   ('&TYPEFLE' NE 'OUTPUT').TB20
         ORG   K038&SYSNDX+X'C1'
         DC    X'0A'
.TB20    ORG   K038&SYSNDX+256
K033&SYSNDX DS CL6
K034&SYSNDX DS H
K035&SYSNDX DS CL24
K036&SYSNDX DC H'&LRECL'
         DS    0D
K037&SYSNDX DC X'0000000000000000'
K039&SYSNDX DS CL1
K040&SYSNDX  DS  F
K041&SYSNDX DC C'    '
K042&SYSNDX  DS  &LRECL.C
K043&SYSNDX  MVC  K042&SYSNDX,0(3)
K044&SYSNDX  DC  XL8'00'
         USING *,15
K000&SYSNDX EQU *
.GEN1    STM   14,13,K050&SYSNDX
 SR 11,11
 IC 11,K050&SYSNDX+4
 SLL 11,2
 AIF (NOT &BL2).OPT2
 BALR 3,0
 DROP 15
 USING *,3
 L 11,K060&SYSNDX.(11)
 BALR 10,11
 LM 14,15,K050&SYSNDX
 LA 14,0(2,14)
 LM 2,13,K050&SYSNDX+16
 AGO .INPT4
.OPT2 LM 2,10,K052&SYSNDX
 DROP 15
 USING *,3,2
K002&SYSNDX L 11,K060&SYSNDX.(11)
 BALR 10,11
 MVC K048&SYSNDX,K050&SYSNDX+4
K004&SYSNDX STM 4,10,K052&SYSNDX+8
 L 14,K050&SYSNDX
 LA 14,0(1,14)
         L     15,K049&SYSNDX
         LM    0,13,K050&SYSNDX+8
.INPT4   BR    14
 AIF (&BL2).INPT6
K006&SYSNDX LA 1,1
 B K004&SYSNDX
K048&SYSNDX DC X'FF'
.INPT6 ANOP
K049&SYSNDX DC F'0'
K050&SYSNDX DS 16F
 AIF (&BL2).INPT8
K052&SYSNDX DC A(K002&SYSNDX+4096)
 DC A(K002&SYSNDX)
 AIF ('&GENIO' EQ 'NO').NOIO1
K054&SYSNDX DC A(K998&SYSNDX)
 AGO .K056
.NOIO1 ANOP
K054&SYSNDX DC A(KOUT1)
.K056 ANOP
K056&SYSNDX DC F'0'
K058&SYSNDX DC F'&BLKSIZE'
 DS 4F
.INPT8 ANOP
K060&SYSNDX DC A(K100&SYSNDX)
 DC A(K090&SYSNDX)
 DC A(K080&SYSNDX)
 AIF (&BL2).FILDEF
.EPT05 AIF (&BL7).EPT05A
 DC A(K006&SYSNDX)
 AGO .EPT06
.EPT05A DC A(K500&SYSNDX)
.EPT06 AIF (&BL3).EPT06A
 DC A(K006&SYSNDX)
 AGO .EPT07
.EPT06A DC A(K200&SYSNDX)
.EPT07 AIF (&BL4).EPT07A
 DC A(K006&SYSNDX)
 AGO .EPT08
.EPT07A DC A(K250&SYSNDX)
.EPT08 AIF (&BL5).EPT08A
 DC A(K006&SYSNDX)
 AGO .EPT09
.EPT08A DC A(K300&SYSNDX)
.EPT09 AIF (&BL6).EPT09A
 DC A(K006&SYSNDX)
 AGO .EPT10
.EPT09A DC A(K550&SYSNDX)
.EPT10 AIF (&BL10).EPT10A
 DC A(K006&SYSNDX)
 AGO .EPT11
.EPT10A DC A(K400&SYSNDX)
.EPT11   AIF   (&BL8).EPT11A
 DC A(K006&SYSNDX)
         AGO   .EPT12
.EPT11A DC A(K350&SYSNDX)
.EPT12   AIF   ('&TYPEFLE' EQ 'OUTPUT').EPT12A
         DC    A(K006&SYSNDX)
         AGO   .FILDEF
.EPT12A  DC    A(K100&SYSNDX)
.FILDEF AIF ('&GENIO' EQ 'NO').OPEN
         AIF   (&BL2).IDCB
&DDNAME       DCB   DSORG=PS,DDNAME=&DDNAME,MACRF=W,BLKSIZE=&AL2,      X
               EODAD=&EOFAD,RECFM=U,                                   X
               EXLST=&LABADDR
              AGO   .OPEN
.IDCB         ANOP
&DDNAME       DCB   DSORG=PS,DDNAME=&DDNAME,MACRF=GL,BLKSIZE=&AL2,     X
               EODAD=&EOFAD,RECFM=U,                                   X
               EXLST=&LABADDR,BUFNO=&BUFNO,SYNAD=&SYNAD,EROPT=&EROPT
.OPEN ANOP
              AIF   (&BL2).OPENI
K080&SYSNDX   OPEN  (&DDNAME,(OUTPUT))
              LA    1,4
              AGO   .ORET
.OPENI        ANOP
K080&SYSNDX   OPEN  (&DDNAME)
              LA    2,4
.ORET BR 10
K090&SYSNDX EQU *
 AIF (&BL2).CLIPT
 LTR 5,5
              AIF   ('&BUFNO' EQ '2').CL2BUF
 BZ K094&SYSNDX
              AGO   .LWRT
.CL2BUF       BZ    K092&SYSNDX
.LWRT         BAL   9,K160&SYSNDX
              AIF   ('&BUFNO' EQ '1').CL1BUF
K092&SYSNDX   CHECK K166&SYSNDX
.CL1BUF       ANOP
K094&SYSNDX   EQU   *
.CLIPT        ANOP
         AIF   ('&KLOSE' NE '').CLKOPT
         CLOSE (&DDNAME)
         AGO   .CLDUN
.CLKOPT  CLOSE (&DDNAME,&KLOSE)
.CLDUN   AIF   (NOT &BL2).CLOPT
 LA 2,4
 BR 10
 AGO .DEBLK
.CLOPT LA 1,4
 BR 10
K100&SYSNDX LR 8,0
 AIF ('&RECFM' EQ 'V').ALL41
 CLI K050&SYSNDX+4,0
 BNE K102&SYSNDX
 LH 7,K134&SYSNDX
 AIF ('&ASA' NE 'YES').F1
         B     K116&SYSNDX
 AGO .ALL41
.F1 B K105&SYSNDX
.ALL41 ANOP
K102&SYSNDX MVC K130&SYSNDX,0(8)
 LH 7,K130&SYSNDX
 N 7,K136&SYSNDX
 LA 9,4
 SR 7,9
 LA 8,4(8)
 AIF ('&RECFM' EQ 'F').ALL42
 AIF ('&ASA' NE 'YES').V1
 CLI K050&SYSNDX+4,0
         BE    K116&SYSNDX
.V1 CH 7,K132&SYSNDX
 BH K112&SYSNDX
.ALL42  ANOP
K105&SYSNDX CR 7,6
 BNH K106&SYSNDX
 BAL 9,K160&SYSNDX
K106&SYSNDX SR 6,7
 AR 5,7
 BCTR 7,0
 EX 7,K108&SYSNDX
 LA 4,1(7,4)
 LA 1,4
 BR 10
K108&SYSNDX MVC 0(0,4),0(8)
K110&SYSNDX SR 5,5
 LH 6,K132&SYSNDX
 BR 9
 AIF ('&RECFM' EQ 'F').ALL43
K112&SYSNDX B K006&SYSNDX
.ALL43 AIF ('&ASA' NE 'YES').BCON
K116&SYSNDX CLI 0(8),X'4E'
         BNE   K115&SYSNDX
         MVI   0(8),X'50'
K115&SYSNDX LA 11,9(7)
 AIF ('&RECFM' EQ 'F').F2
 CH 11,K132&SYSNDX
 BH K112&SYSNDX
.F2 CR 11,6
 BNH K117&SYSNDX
 BAL 9,K160&SYSNDX
K117&SYSNDX MVC 0(10,4),K140&SYSNDX
         MVC   1(1,4),0(8)
 LA 9,10
 AR 4,9
 AR 5,9
 SR 6,9
 BCTR 7,0
 LA 8,1(8)
 B K106&SYSNDX
.BCON ANOP
K130&SYSNDX DS H
K132&SYSNDX DC H'&BLKSIZE'
 AIF ('&RECFM' EQ 'V').ALL44
K134&SYSNDX DC H'&LRECL'
.ALL44 DS 0F
K136&SYSNDX DC X'0000FFFF'
 AIF ('&ASA' NE 'YES').WRITE
 AIF (&BL11).T70
K140&SYSNDX DC X'E040E3F14040404040BC'
 AGO .WRITE
.T70 ANOP
K140&SYSNDX DC X'E040E3F14040404040D0'
.WRITE   AIF   ('&BUFNO' EQ '1').IOA1W
K160&SYSNDX   STH   5,K168&SYSNDX
K162&SYSNDX   EQU   *+1
              B     K172&SYSNDX
              CHECK K166&SYSNDX
         AIF   ('&GENIO' EQ 'NO').NOGEN6
K164&SYSNDX   WRITE K166&SYSNDX,SF,&DDNAME,K998&SYSNDX,0
         AGO   .KOSF2
.NOGEN6  ANOP
K164&SYSNDX   WRITE K166&SYSNDX,SF,&DDNAME,KOUT1,0
.KOSF2   AIF   ('&MIR' NE 'BEFORE').KRA
         CLI   K050&SYSNDX+4,X'09'
         BCR   8,9
.KRA     ANOP
              L     4,K174&SYSNDX
              MVC   K174&SYSNDX,K170&SYSNDX
              ST    4,K170&SYSNDX
              B     K110&SYSNDX
K168&SYSNDX   EQU   K166&SYSNDX+6
K170&SYSNDX   EQU   K166&SYSNDX+12
K172&SYSNDX   NI    K162&SYSNDX,X'0F'
              B     K164&SYSNDX
         AIF   ('&GENIO' EQ 'NO').NOGEN7
K174&SYSNDX   DC    A(K999&SYSNDX)
         AGO   .KOSF3
.NOGEN7  ANOP
K174&SYSNDX   DC    A(KOUT2)
.KOSF3   AGO   .CHKR
.IOA1W        ANOP
K160&SYSNDX   STH   5,K168&SYSNDX
         AIF   ('&GENIO' EQ 'NO').NOGEN8
K164&SYSNDX   WRITE K166&SYSNDX,SF,&DDNAME,K998&SYSNDX,0
         AGO   .KOSF4
.NOGEN8  ANOP
K164&SYSNDX   WRITE K166&SYSNDX,SF,&DDNAME,KOUT1,0
.KOSF4   ANOP
              CHECK K166&SYSNDX
         AIF   ('&MIR' NE 'BEFORE').KOSF6
         CLI   K050&SYSNDX+4,X'09'
         BCR   8,9
.KOSF6   ANOP
              L     4,K170&SYSNDX
              B     K110&SYSNDX
K168&SYSNDX   EQU   K166&SYSNDX+6
K170&SYSNDX   EQU   K166&SYSNDX+12
              AGO   .CHKR
.DEBLK ANOP
K100&SYSNDX LM 4,5,K122&SYSNDX
 CLI 0(4),X'E0'
 BNE K101&SYSNDX
 MVI K105&SYSNDX+1,0
K101&SYSNDX C 5,K120&SYSNDX
 BH K102&SYSNDX
 BE K114&SYSNDX
 BAL 9,K160&SYSNDX
 MVI K105&SYSNDX+1,X'F0'
K102&SYSNDX LA 6,1(4)
 LR 7,5
K103&SYSNDX C 7,K125&SYSNDX
 BL K104&SYSNDX
 LA 7,255
K104&SYSNDX EX 7,K116&SYSNDX
 BZ K112&SYSNDX
K105&SYSNDX NOP *+10
 CR 1,6
 BE K110&SYSNDX
 ST 1,K122&SYSNDX
 SR 1,4
 LR 0,1
K106&SYSNDX LR 1,4
K108&SYSNDX SR 5,0
         ST    5,K124&SYSNDX
         LA    2,4
         BR    10
K110&SYSNDX BCTR 7,0
 LA 6,1(6)
 C 7,K120&SYSNDX
 BH K104&SYSNDX
 SR 6,4
 LR 0,6
 B K106&SYSNDX
K112&SYSNDX C 5,K125&SYSNDX
 BL K113&SYSNDX
 LA 6,256(6)
 LR 7,5
 S 7,K125&SYSNDX
 B K103&SYSNDX
K113&SYSNDX LA 0,2(5)
 LR 1,4
 B K108&SYSNDX
K114&SYSNDX LA 0,1
 B K106&SYSNDX
K116&SYSNDX TRT 0(0,6),K126&SYSNDX
K120&SYSNDX DC F'-1'
K122&SYSNDX  DC  A(K124&SYSNDX)
K124&SYSNDX DC F'-2'
K125&SYSNDX DC F'256'
K126&SYSNDX DC XL225'FF'
 DC XL31'00'
K160&SYSNDX   GET   &DDNAME
              LR    4,1
              LH    5,&DDNAME+82
              BCTR  5,0
              BCTR  5,0
              BR    9
K180&SYSNDX DC A(&EOFADDR)
K185&SYSNDX L  14,K180&SYSNDX
            LM 2,13,K050&SYSNDX+16
             BR 14
              AGO   .END
.CHKR    AIF   (NOT &BL3).PARLL
K200&SYSNDX ST 10,K468&SYSNDX
 SR 9,9
 IC 9,4(14)
 LTR 9,9
 BZ K209&SYSNDX
         AIF   (&AL5 EQ 0).NOPSK1
         MVI   K450&SYSNDX+5,C'&AL5'
.NOPSK1  ANOP
K202&SYSNDX STH 9,K466&SYSNDX
 LA 7,4
 MVC K452&SYSNDX.(40),K454&SYSNDX
K204&SYSNDX MVC K452&SYSNDX+40(40),K452&SYSNDX
K206&SYSNDX LA 8,12
K208&SYSNDX LA 0,K450&SYSNDX
 STM 7,8,K470&SYSNDX
 BAL 10,K100&SYSNDX
         AIF   (&AL5 EQ 0).NOPSK2
         MVI   K450&SYSNDX+5,C' '
.NOPSK2  ANOP
 LM 7,8,K470&SYSNDX
 BCT 8,K208&SYSNDX
 BCT 7,K210&SYSNDX
         AIF   ('&PULDOWN' NE '1').CHK01
         LA    14,K440&SYSNDX
         AGO   .CHK02
.CHK01   LA    14,K460&SYSNDX
.CHK02   BAL   10,K400&SYSNDX
 LH 9,K466&SYSNDX
 BCT 9,K202&SYSNDX
K209&SYSNDX L 10,K468&SYSNDX
 LA 1,6
 BR 10
K210&SYSNDX MVC K452&SYSNDX.(40),K452&SYSNDX+20
 B K204&SYSNDX
.PARLL AIF (NOT &BL4).PERPN
K250&SYSNDX ST 10,K468&SYSNDX
 SR 9,9
 IC 9,4(14)
 LTR 9,9
 BZ K257&SYSNDX
         AIF   (&AL5 EQ 0).NOPSK3
         MVI   K450&SYSNDX+5,C'&AL5'
.NOPSK3  ANOP
K252&SYSNDX STH 9,K466&SYSNDX
 LA 7,4
 B K260&SYSNDX
K254&SYSNDX LA 8,12
K256&SYSNDX LA 0,K450&SYSNDX
 STM 7,8,K470&SYSNDX
 BAL 10,K100&SYSNDX
         AIF   (&AL5 EQ 0).NOPSK4
         MVI   K450&SYSNDX+5,C' '
.NOPSK4  ANOP
 LM 7,8,K470&SYSNDX
 BCT 8,K256&SYSNDX
 BCT 7,K258&SYSNDX
         AIF   ('&PULDOWN' NE '1').PAR01
         LA    14,K440&SYSNDX
         AGO   .PAR02
.PAR01   LA    14,K460&SYSNDX
.PAR02   BAL   10,K400&SYSNDX
 LH 9,K466&SYSNDX
 BCT 9,K252&SYSNDX
K257&SYSNDX L 10,K468&SYSNDX
 LA 1,6
 BR 10
K258&SYSNDX B K262&SYSNDX
K260&SYSNDX MVI K452&SYSNDX,C' '
 MVC K452&SYSNDX+1(79),K452&SYSNDX
 MVI K258&SYSNDX+1,240
 B K254&SYSNDX
K262&SYSNDX MVI K452&SYSNDX,C'M'
 MVC K452&SYSNDX+1(79),K452&SYSNDX
 MVI K258&SYSNDX+1,0
 B K254&SYSNDX
.PERPN AIF (NOT &BL5).RTRV
K300&SYSNDX ST 10,K468&SYSNDX
 SR 9,9
 IC 9,4(14)
 LTR 9,9
 BZ K306&SYSNDX
         AIF   (&AL5 EQ 0).NOPSK5
         MVI   K450&SYSNDX+5,C'&AL5'
.NOPSK5  ANOP
 MVC K452&SYSNDX.(32),K454&SYSNDX+4
 MVC K452&SYSNDX+32(48),K452&SYSNDX
K302&SYSNDX STH 9,K466&SYSNDX
 LA 7,48
K304&SYSNDX LA 0,K450&SYSNDX
 ST 7,K470&SYSNDX
 BAL 10,K100&SYSNDX
         AIF   (&AL5 EQ 0).NOPSK6
         MVI   K450&SYSNDX+5,C' '
.NOPSK6  ANOP
 L 7,K470&SYSNDX
 BCT 7,K304&SYSNDX
         AIF   ('&PULDOWN' NE '1').PERP01
         LA    14,K440&SYSNDX
         AGO   .PERP02
.PERP01  LA    14,K460&SYSNDX
.PERP02  BAL   10,K400&SYSNDX
 LH 9,K466&SYSNDX
 BCT 9,K302&SYSNDX
K306&SYSNDX L 10,K468&SYSNDX
 LA 1,6
 BR 10
.RTRV AIF (NOT &BL8).PGEND
K350&SYSNDX ST 10,K468&SYSNDX
 LR 7,0
 MVC K466&SYSNDX,0(7)
 LH 8,K466&SYSNDX
 N 8,K136&SYSNDX
 LA 9,5
 SR 8,9
 CH 8,K464&SYSNDX
 BL K351&SYSNDX
 LA 8,21
K351&SYSNDX MVI K462&SYSNDX+5,C' '
 MVC K462&SYSNDX+6(32),K462&SYSNDX+5
 EX 8,K356&SYSNDX
 LA 7,K462&SYSNDX+6(8)
 MVC 0(1,7),K458&SYSNDX+13
 MVC 1(10,7),K458&SYSNDX+4
         MVI   2(7),C'A'
         AIF   ('&MIR' NE 'BEFORE').KRTV2
         ST    5,K360&SYSNDX
         L     5,K170&SYSNDX
         ST    5,K361&SYSNDX
         AIF   ('&BUFNO' EQ '1').KRTV0
         L     5,K362&SYSNDX
         MVC   K362&SYSNDX,K363&SYSNDX
         ST    5,K363&SYSNDX
         MVC   0(34,5),K462&SYSNDX+4
         AGO   .KRTV1
.KRTV0   LA    5,K462&SYSNDX+4
.KRTV1   ST    5,K170&SYSNDX
         LA    5,34
         BAL   9,K160&SYSNDX
         L     5,K361&SYSNDX
         ST    5,K170&SYSNDX
         L     5,K360&SYSNDX
         AGO   .KRTV8
.KRTV2   LA    0,K462&SYSNDX
 BAL 10,K100&SYSNDX
 SR 6,6
.KRTV8   L     10,K468&SYSNDX
 LA 1,4
 BR 10
K356&SYSNDX MVC K462&SYSNDX+5(1),4(7)
         AIF   ('&MIR' NE 'BEFORE').PGEND
K360&SYSNDX DS F
K361&SYSNDX DS F
         AIF   ('&BUFNO' EQ '1').PGEND
K362&SYSNDX DC A(K364&SYSNDX)
K363&SYSNDX DC A(K365&SYSNDX)
K364&SYSNDX DS CL34
         CNOP  0,4
K365&SYSNDX DS CL34
.PGEND        AIF   (NOT &BL3 AND NOT &BL4 AND NOT &BL5 AND NOT &BL6 ANX
               D NOT &BL7 AND NOT &BL8 AND NOT &BL9 AND NOT &BL10).BUFDX
               EF
K400&SYSNDX ST 10,K469&SYSNDX
 SR 7,7
 MVC K458&SYSNDX+5(1),5(14)
 IC 7,4(14)
 LTR 7,7
 BZ K404&SYSNDX
         L     10,K049&SYSNDX
         LA    10,0(7,10)
         ST    10,K049&SYSNDX
K402&SYSNDX LA 0,K458&SYSNDX
 ST 7,K470&SYSNDX
 BAL 10,K100&SYSNDX
 SR 6,6
 L 7,K470&SYSNDX
 BCT 7,K402&SYSNDX
K404&SYSNDX L 10,K469&SYSNDX
 LA 1,6
 BR 10
 AIF (&BL3 OR &BL4).CON0
 AIF (NOT &BL5).CON1
.CON0 ANOP
         AIF   ('&PULDOWN' NE '1').T70B
K440&SYSNDX EQU  *-4
         DC    X'02C1'
.T70B    ANOP
K450&SYSNDX DC H'94'
 AIF (&BL11).T71
 DC X'4040E040404040404040BCBD'
 AGO .T91
.T71 DC X'4040E040404040404040D05F'
.T91 AIF (&AL4 EQ 0).T91A
 ORG K450&SYSNDX+6
 DC C'T&AL4'
 ORG
.T91A ANOP
K452&SYSNDX DS CL80
 AIF (NOT &BL3 AND NOT &BL5).CON1
K454&SYSNDX DC 20C'M'
K456&SYSNDX DC CL20' '
.CON1 ANOP
K458&SYSNDX DC H'34'
 AIF (&BL11).T72
 DC X'4040E04040404040404040BC'
 AGO .T92
.T72 DC X'4040E04040404040404040D0'
.T92 DC CL20' '
K460&SYSNDX EQU *-4
 DC X'01C1'
 AIF ('&ASA' EQ 'YES').FLASH
 AIF (NOT &BL6).NOFLSH
.FLASH ANOP
K461&SYSNDX EQU *-4
 DC X'01C2'
.NOFLSH AIF (NOT &BL8).CON3
         CNOP  0,4
K462&SYSNDX DC H'38'
 DC X'4040E0'
 DS CL33
K464&SYSNDX DC H'22'
.CON3 ANOP
K466&SYSNDX DS H
K468&SYSNDX DS F
K469&SYSNDX DS F
K470&SYSNDX DS F
K471&SYSNDX DS F
K472&SYSNDX DC A(K100&SYSNDX)
.STOP AIF (NOT &BL7).IBAL
K500&SYSNDX ST 10,K468&SYSNDX
 SR 9,9
 IC 9,4(14)
 LTR 9,9
 BZ K504&SYSNDX
 MVI K458&SYSNDX+5,C'A'
 MVI K458&SYSNDX+6,C'S'
K502&SYSNDX STH 9,K466&SYSNDX
 LA 0,K458&SYSNDX
 BAL 10,K100&SYSNDX
      SR 6,6
    LH  9,K466&SYSNDX
      BCT   9,K502&SYSNDX
         MVI   K458&SYSNDX+6,C' '
K504&SYSNDX L 10,K468&SYSNDX
         LA    1,6
 BR 10
.IBAL AIF (NOT &BL6).BUFDEF
K550&SYSNDX STM 4,10,K700&SYSNDX
 LR 4,0
         AIF   ('&IBSKIP' EQ '').IB004
         MVI   K720&SYSNDX+5,C'&IBSKIP'
         AGO   .IB010
.IB004   MVI   K720&SYSNDX+5,X'50'
.IB010   MVC   K727&SYSNDX.(24),0(4)
 LA 4,K727&SYSNDX
 LA 1,1
         CLC   K72A&SYSNDX,K724&SYSNDX
         BNE   K554&SYSNDX
         LA    1,1(1)
         CLC   K729&SYSNDX,K724&SYSNDX
         BNE   K554&SYSNDX
         LA    1,1(1)
         CLC   K728&SYSNDX,K724&SYSNDX
         BNE   K554&SYSNDX
         LA    1,1(1)
K552&SYSNDX CH 1,K716&SYSNDX
 BNH K554&SYSNDX
K553&SYSNDX LM 4,8,K700&SYSNDX
 L 14,K050&SYSNDX
 CLI 4(14),C'B'
 BH K546&SYSNDX
 BE K548&SYSNDX
 LA 14,K460&SYSNDX
K544&SYSNDX BAL 10,K400&SYSNDX
K546&SYSNDX L 10,K700&SYSNDX+24
 LA 1,6
 BR 10
K548&SYSNDX LA 14,K461&SYSNDX
 B K544&SYSNDX
K554&SYSNDX LA 5,K718&SYSNDX
 CLC 0(6,4),K724&SYSNDX
 BNE K558&SYSNDX
 LA 4,6(4)
 LA 1,1(1)
 ST 1,K702&SYSNDX
 ST 4,K704&SYSNDX
 LA 4,16
K555&SYSNDX MVI K722&SYSNDX,C' '
 MVC K722&SYSNDX+1(124),K722&SYSNDX
 BAL 10,K600&SYSNDX
         MVI   K720&SYSNDX+5,X'40'
 BCT 4,K602&SYSNDX
K556&SYSNDX L 1,K702&SYSNDX
 L 4,K704&SYSNDX
 B K552&SYSNDX
K558&SYSNDX LA 0,6
K560&SYSNDX CLI 0(4),C' '
 BNE K566&SYSNDX
 MVI 0(5),X'00'
 MVC 1(23,5),0(5)
K562&SYSNDX LA 5,24(5)
 LA 4,1(4)
 BCT 0,K560&SYSNDX
 LA 1,1(1)
 ST 1,K702&SYSNDX
 ST 4,K704&SYSNDX
 B K610&SYSNDX
K564&SYSNDX LA 4,4
 L 1,K702&SYSNDX
 CH 1,K716&SYSNDX
 BNH K555&SYSNDX
 B K553&SYSNDX
K566&SYSNDX CLI 0(4),X'C0'
 BNH K570&SYSNDX
 TR 0(1,4),K750&SYSNDX
         LA    7,K740&SYSNDX
 SR 8,8
 IC 8,0(4)
 SLL 8,2
 AR 7,8
K568&SYSNDX MVC 0(24,5),0(7)
 B K562&SYSNDX
K570&SYSNDX CLI 0(4),X'60'
 BNE K572&SYSNDX
 LA 7,K730&SYSNDX
 B K568&SYSNDX
K572&SYSNDX CLI 0(4),X'61'
 BNE K574&SYSNDX
 LA 7,K732&SYSNDX
 B K568&SYSNDX
K574&SYSNDX CLI 0(4),X'7B'
 BNE K576&SYSNDX
 LA 7,K734&SYSNDX
 B K568&SYSNDX
K576&SYSNDX CLI 0(4),X'4B'
 BNE K578&SYSNDX
 LA 7,K736&SYSNDX
 B K568&SYSNDX
K578&SYSNDX LA 7,K738&SYSNDX
 B K568&SYSNDX
K600&SYSNDX ST 10,K706&SYSNDX
K602&SYSNDX LA 0,K720&SYSNDX
 ST 4,K708&SYSNDX
 LM 4,8,K700&SYSNDX
 BAL 10,K100&SYSNDX
 STM 4,8,K700&SYSNDX
 L 4,K708&SYSNDX
 L 10,K706&SYSNDX
 BR 10
K610&SYSNDX LA 4,K718&SYSNDX
K612&SYSNDX SR 5,5
 LA 8,K722&SYSNDX
 LR 9,8
K614&SYSNDX SR 1,1
 CH 1,0(4,5)
 BNE K618&SYSNDX
 MVC 0(15,8),K724&SYSNDX
 LA 8,22(8)
K616&SYSNDX LR 9,8
 LA 5,24(5)
 C 8,K710&SYSNDX
 BNE K614&SYSNDX
 B K630&SYSNDX
K618&SYSNDX LA 8,15(8)
 MVI K622&SYSNDX,0
 LH 7,0(4,5)
 N 7,K136&SYSNDX
 SR 6,6
 SLDL 6,20
K620&SYSNDX LTR 6,6
 BZ K621&SYSNDX
 BCTR 6,0
 EX 6,K650&SYSNDX
 LA 9,1(6,9)
 CR 9,8
 BNL K626&SYSNDX
 SR 6,6
K621&SYSNDX SLDL 6,4
 LTR 6,6
 BZ K623&SYSNDX
 BCTR 6,0
 EX 6,K652&SYSNDX
 LA 9,1(6,9)
 CR 9,8
 BNL K626&SYSNDX
K622&SYSNDX EQU *+1
K623&SYSNDX NOP K628&SYSNDX
K624&SYSNDX SR 6,6
 SLDL 6,4
 MVI K622&SYSNDX,240
 B K620&SYSNDX
K626&SYSNDX LA 8,7(8)
 B K616&SYSNDX
K628&SYSNDX L 7,K714&SYSNDX
 B K624&SYSNDX
K630&SYSNDX BAL 10,K600&SYSNDX
         MVI   K720&SYSNDX+5,X'40'
 C 4,K712&SYSNDX
 BE K564&SYSNDX
 LA 4,2(4)
 B K612&SYSNDX
K650&SYSNDX MVC 0(0,9),K726&SYSNDX
K652&SYSNDX MVC 0(0,9),K724&SYSNDX
K700&SYSNDX DS 7F
K702&SYSNDX DS F
K704&SYSNDX DS F
K706&SYSNDX DS F
K708&SYSNDX DS F
K710&SYSNDX DC A(K722&SYSNDX+132)
K712&SYSNDX DC A(K718&SYSNDX+22)
K714&SYSNDX DC X'3400000000000000'
K716&SYSNDX DC H'4'
K718&SYSNDX DS 144C
K720&SYSNDX DC H'146'
 AIF (&BL11).T75
 DC X'4040E040404040404040BCBD404040'
 AGO .T95
.T75 DC X'4040E040404040404040D05F404040'
.T95 AIF (&AL3 EQ 0).T95A
 ORG K720&SYSNDX+6
 DC C'T&AL3'
 ORG
.T95A ANOP
K722&SYSNDX DC 125C' '
K724&SYSNDX DC CL15' '
K726&SYSNDX DC 15C'M'
K727&SYSNDX DS CL6
K728&SYSNDX DS CL6
K729&SYSNDX DS CL6
K72A&SYSNDX DS CL6
K740&SYSNDX DS 0F
 DC X'047402B247403930393039303930F000F000393039303930'
 DC X'C300D200383139303831C300C300383139303831D200C300'
 DC X'039301D1393039303C003C003C003C003930393001D10393'
 DC X'C300D20038313930393039303930393039303831D200C300'
 DC X'F000F0003C003C003C00C300C3003C003C003C00F000F000'
 DC X'F000F0003C003C003C00C300C3003C003C003C003C003C00'
 DC X'039301D1393039303C003C003C0036603660393001D10393'
 DC X'39303930393039303930F000F00039303930393039303930'
 DC X'039303930636063606360636063606360636063603930393'
K752&SYSNDX DC X'0C300C300C300C300C300C300C300C303930393001D10393'
 DC X'393037413543334531476900690031383246344436423840'
 DC X'3C003C003C003C003C003C003C003C003C003C00F000F000'
 DC X'393047405550636031713252333339303930393039303930'
 DC X'483057306630313532343333343235313660375038403930'
 DC X'039301D13930393039303930393039303930393001D10393'
 DC X'C300D200383139303831D200C3003C003C003C003C003C00'
 DC X'039301D13930393039303930393033333432353101D10372'
 DC X'C300D200383139303831D200C30035343633373238313930'
K754&SYSNDX DC X'039301D139304B0001590456075309510B40393001D10393'
 DC X'F000F0000636063606360636063606360636063606360636'
 DC X'393039303930393039303930393039303930393001D10393'
 DC X'393039303930013701370235023503330333043105550636'
 DC X'393039303930393039303333325231716360555047403930'
 DC X'393001370235033304310555055504310333023501373930'
 DC X'393001370235033304310555063606360636063606360636'
 DC X'F000F0000B4009420744064504470348014A4B00F000F000'
 DC X'055503930235013739303930393039300137023503930555'
 DC X'063605460456063606360636063606360636063603840384'
 DC X'039301D139300C300A4108430645044702494B00F000F000'
 DC X'039301D138400C300B31066306630B310C30384001D10393'
 DC X'0762067205320433033402350136F000F0000A320A320A32'
 DC X'F000F0003C003183E10039300C300C300C30393001D10393'
 DC X'039301D139303C003C003273E10039303930393001D10393'
 DC X'F000F0000B310A320933083407350636053704380339023A'
 DC X'039301D147403930013702B202B201373930474001D10393'
 DC X'039301D139303930393001E003720C300C30393001D10393'
K730&SYSNDX DC X'000000000000000000000393039300000000000000000000'
K732&SYSNDX DC X'0B310A320933083407350636053704380339023A013B3C00'
K734&SYSNDX DC X'033303330333F000F00003330333F000F000033303330333'
K736&SYSNDX DC X'000000000000000000000000000000000000055505550555'
K738&SYSNDX DC X'F000F000F000F000F000F000F000F000F000F000F000F000'
K750&SYSNDX EQU *-193
 DC X'00060C12181E242A30F0F0F0F0F0F0'
 DC X'F0363C42484E545A6066F0F0F0F0F0F0'
 DC X'F0F06C72787E848A9096F0F0F0F0F0F0'
 DC X'9CA2A8AEB4BAC0C6CCD2F0F0F0F0F0F0'
.BUFDEF AIF ('&GENIO' EQ 'NO').END
K998&SYSNDX DS &BLKSIZE.C
 AIF ('&BUFNO' EQ '1').END
K999&SYSNDX DS &BLKSIZE.C
.END   CNOP  0,4
         AIF (&BL2).IEND
 DROP 2,3
 MEXIT
.IEND DROP 3
 MEND
./ ADD  NAME=KGET
         MACRO
&NAME    KGET  &FILEN
*  KODAK KOM-90 MICROFILMER SOFTWARE  OS VER 2  10/01/69
         AIF   ('&FILEN' NE '').A
         MNOTE 'NO FILENAME SPECIFIED'
         MEXIT
.A       ANOP
         CNOP  2,4
         AIF   ('&NAME' EQ '').B
&NAME    EQU   *
.B       L     15,*+6
         BALR  14,15
         DC    AL1(0)
         DC    AL3(&FILEN)
         MEND
./ ADD  NAME=KIBAL
         MACRO
&NAME    KIBAL &FILEN,&WORKA,&CODE
         GBLC  &CG14
*  KODAK KOM-90 MICROFILMER SOFTWARE  OS VER 2  10/01/69
         AIF   ('&FILEN' NE '').A
         MNOTE 'NO FILENAME SPECIFIED'
         MEXIT
.A       ANOP
         CNOP  2,4
&CG14    SETC   'B'
         AIF   ('&NAME' EQ '').B
&NAME    EQU   *
.B       AIF   ('&WORKA' EQ '').C
         LA    0,&WORKA
.C       AIF   ('&CODE' EQ 'F').E
&CG14    SETC   'A'
         AIF   ('&CODE' EQ '').E
         AIF   ('&CODE' EQ 'A').E
         AIF   ('&CODE' NE 'S').D
&CG14    SETC  'S'
         AGO   .E
.D       MNOTE 'INVALID THIRD OPERAND.''A'' ASSUMED'
.E       L     15,*+6
         BALR  14,15
         DC    AL1(7)
         DC    AL3(&FILEN)
         DC    CL1'&CG14'
         DC    AL1(0)
         MEND
./ ADD  NAME=KSL
         MACRO
&NM      KSL   &LEN=0,&EXIT=,&STK1=1,&STK3=3,&TRANS=YES
         LCLC  &NAME,&EX,&TR
*
*       AUTHOR
*       H. FRANZ       1980
*       BASF AG  FLD/OS        TEL. 6390
*
         AIF   (T'&NM EQ 'O').NONAME
&NAME    SETC  '&NM'
         AGO   .CHKSTK
.NONAME  ANOP
         MNOTE 12,'ASSIGN A NAME TO THE PROGRAM'
         MEXIT
.INVSTK  ANOP
         MNOTE 12,'STACKER SELECTION MUST BE 1 OR 3'
         MEXIT
.CHKSTK  ANOP
         AIF ('&STK1' NE '1' AND '&STK1' NE '3').INVSTK
         AIF ('&STK3' NE '1' AND '&STK3' NE '3').INVSTK
.CSECT   ANOP
         AIF   ('&LEN' NE '0').LENWAS
         MNOTE 12,'LENGTH OF INPUT AREA MUST BE SPECIFIED BY LEN=NNN'
         MEXIT
.LENWAS  ANOP
         AIF   ('&EXIT' EQ '').NOEXIT
&EX      SETC  '&EXIT'
         AGO   .TESTTR
.NOEXIT  ANOP
&EX      SETC  '0'
.TESTTR  ANOP
         AIF   ('&TRANS' NE 'YES').NOTRANS
&TR      SETC  'Y'
         AGO   .OKGEN
.NOTRANS ANOP
&TR      SETC  'N'
.OKGEN   ANOP
         TITLE 'BASF          BELEG-LESE-DEFINITIONEN'
&NAME    CSECT
INPPNT   DC    A(IN)         POINTER TO INPUT AREA DEFINITION
INPLEN   DC    A(&LEN)       LENGTH OF INPUT AREA
CCWPNT   DC    A(CCW)        POINTER TO START OF CCW-CHAIN
         DC    A(&EX)        POINTER TO EXIT-ROUTINE
         DC    AL1(&STK1)    STACKER FOR DOCUMENTS WITHOUT ERROR
         DC    AL1(&STK3)    STACKER FOR REJECTED DOCUMENTS
         DC    C'&TR'        TRANSLATION INDICATOR
         DS    0D
         DC    CL8'&NAME'
         SYSDATE
         MEND
./ ADD  NAME=LFD1PARM
** TITLE   DEFINITION PARAMETER FUER LULFD1
** OWNER   128.FRANZ
** LCHNG   10/01/82 10:44:17   Z227368 PELIKAN
         MACRO
&NM      LFD1PARM &TYPE=DEF,&PREF=LFD
         LCLC  &N
&N       SETC  '&NM'
         AIF   ('&TYPE' NE 'DSECT').DEF
&N       DSECT
&N       SETC  ' '
.DEF     ANOP
         SPACE 3
*        DEFINITION DER PARAMETER FUER LULFD1
*
&N        DS    0D
&PREF.ANZ DS    H          ANZAHL ELEMENTE IN TABELLE
&PREF.LEN DS    H          LAENGE EINES TABELLEN ELEMENTS
&PREF.ANF DS    H          POSITION SUCHBEGRIFF ANFANG
&PREF.END DS    H          POSITION SUCHBEGRIFF ENDE
&PREF.SUZ DS    H          ANZAHL SUCHSCHRITTE
&PREF.FST DS    H          ELEMENT NUMMER 1. VERGLEICH
&PREF.STA DS    F          A(ERSTES VERGLEICHS ELEMENT)
&PREF.BER DS    F          ERSTER BERICHTIGUNGSWERT BEI LOW
&PREF.BEH DS    H          ERSTER BERICHTIGUNGSWERT FUER # BEI HIGH
&PREF.BWH DS    H          ERSTE ADDRESS BERICHTIGUNG BEI HIGH
&PREF.FLN DS    H          VERGLEICHS LAENGE (-1) FUER EX
         MEND
./ ADD  NAME=LFD2PARM
** TITLE   DEFINITION PARAMETER FUER LULFD2
** OWNER   128.FRANZ
** LCHNG   10/01/82 08:42:24   Z227368 PELIKAN
         MACRO
&NM      LFD2PARM &TYPE=DEF,&PREF=LFD
         LCLC  &N
&N       SETC  '&NM'
         AIF   ('&TYPE' NE 'DSECT').DEF
&N       DSECT
&N       SETC  ' '
.DEF     ANOP
         SPACE 3
*        DEFINITION DER PARAMETER FUER LULFD2
*
&N        DS    0D
&PREF.ANZ DS    F          ANZAHL ELEMENTE IN TABELLE
&PREF.LEN DS    F          LAENGE EINES TABELLEN ELEMENTS
&PREF.ANF DS    F          POSITION SUCHBEGRIFF ANFANG
&PREF.END DS    F          POSITION SUCHBEGRIFF ENDE
&PREF.SUZ DS    F          ANZAHL SUCHSCHRITTE
&PREF.FST DS    F          ELEMENT NUMMER 1. VERGLEICH
&PREF.STA DS    F          A(ERSTES VERGLEICHS ELEMENT)
&PREF.BER DS    F          ERSTER BERICHTIGUNGSWERT BEI LOW
&PREF.BEH DS    F          ERSTER BERICHTIGUNGSWERT FUER # BEI HIGH
&PREF.BWH DS    F          ERSTE ADDRESS BERICHTIGUNG BEI HIGH
&PREF.FLN DS    F          VERGLEICHS LAENGE (-1) FUER EX
         MEND
./ ADD  NAME=LOCKTAB
** TITLE   DSN-TABELLE FUER LULOCK
** OWNER   128.FRANZ
** LCHNG   06/15/83 13:54:04   Z227128 128.FRANZ
         DS    0D
LOCKADR  DC    A(LOCKTANF)
LOCKTANZ DC    A((LOCKTEND-LOCKTANF)/LOCKELLN)
         DC    10F'0'
LOCKTANF DS    0D
LOCKTENT DS    0CL62
LOCKLEN  DC    AL2(9)           LENGTH OF DSN FOR ENQ-SVC
LOCKDSN  DC    CL44'LU.MACLIB'  DSNAME
LOCKQNAM DC    CL8'SYSIEWLP'    MAJOR QNAME FOR ENQ-SVC
LOCKRNAM DC    CL8' '           MINOR RNAME FOR ENQ-SVC,(BLANK=DSN)
LOCKELLN EQU   *-LOCKTENT       LENGTH OF AN ENTRY
PARMFIX  DC    AL2(10),CL44'OX.PARMFIX',CL8'SYSIEWLP',CL8' '
PROCLIB  DC    AL2(12),CL44'SYS1.PROCLIB',CL8'SYSIEWLP',CL8' '
DATALIB  DC    AL2(12),CL44'SYS1.DATALIB',CL8'SYSIEWLP',CL8' '
DMDATEI  DC    AL2(12),CL44'OPV.OP02201A',CL8'DMDATEI',CL8' '
UCC11LIB DC    AL2(12),CL44'OP.UCC11.CMT',CL8'CMTQNAME',CL8' '
ASTSUM   DC    AL2(10),CL44'AST.ASTSUM',CL8'ASTSUM',CL8'ASTPGM'
IMAGELIB DC    AL2(13),CL44'SYS1.IMAGELIB',CL8'SYSIEWLP',CL8' '
ASTARCH  DC    AL2(14),CL44'OP.ASTWTR.DATA',CL8'ASTSUM',CL8'ARCHIV'
ASTLOG   DC    AL2(17),CL44'OP.ASTWTR.DATALOG',CL8'ASTSUM',CL8'ARCHIV'
LOCKTEND EQU   *
         DS    0D
./ ADD  NAME=LUALLOC
         MACRO
         LUALLOC &DD=,&DSN=,&MEMBER=,&VOL=,&UNIT=,&FREE=,&DISP=,       *
               &SPACE=,&EXPDT=,                                        *
               &RETPD=,&MSVGP=,&RECFM=,&LRECL=,&BLKSIZE=
*
*        MACRO FUER DYNALLOC PS/PO DATEIN
*
         LCLC  &P,&ZDISP,&ZDISP1,&ZDISP2,&ZDISP3
         LCLC  &RECFM1,&RECFM2,&RECFM3
&ZDISP   SETC  '08'
&P       SETC  '&SYSNDX'
         AGO   .ZDISPR
.WEI0    ANOP
         CNOP  0,4
         BAL   R1,IH&P.Z
IH&P.A   DC    AL1(128),AL3(IH&P.B)
IH&P.B   DS    0CL20
         DC    X'14010000'
         DS    CL4
         DC    AL4(IH&P.C)
         DS    CL8
IH&P.C   DC    AL4(IH&P.D)                  ADR DD - NAME
         DC    AL4(IH&P.E)                  ADR DS - NAME
         AIF   ('&MEMBER' EQ '').WEI1
         DC    AL4(IH&P.F)                  ADR MEMBER - NAME
.WEI1    ANOP
         AIF   ('&VOL' EQ '').WEI2
         DC    AL4(IH&P.H)                  ADR VOLSER
.WEI2    ANOP
         AIF   ('&UNIT' EQ '').WEI3
         DC    AL4(IH&P.I)                  ADR UNIT
.WEI3    ANOP
         AIF   ('&FREE' NE '').WEI3A
         DC    AL4(IH&P.K)                  ADR FREE=CLOSE
.WEI3A   ANOP
         AIF   ('&ZDISP1' EQ '04').WEI99
.WEI3R   ANOP
         AIF   ('&ZDISP2' EQ '').WEI3R2
         DC    AL4(IH&P.X)                  ADR 2. DISP PARAMETER
.WEI3R2  ANOP
         AIF   ('&ZDISP3' EQ '').WEI3R3
         DC    AL4(IH&P.Y)                  ADR 3. DISP PARAMETER
.WEI3R3  ANOP
         DC    AL1(128),AL3(IH&P.G)         ADR DISP
IH&P.D   DC    X'00010001'                  DD - NAME
         DC    AL2(IH&P.D1)                 
IH&P.D2  DC    C'&DD'                       
IH&P.D1  EQU   *-IH&P.D2                    V
IH&P.E   DC    X'00020001'                  DS - NAME
         DC    AL2(IH&P.E1)                 
IH&P.E2  DC    C'&DSN'                      
IH&P.E1  EQU   *-IH&P.E2                    V
IH&P.G   DC    X'000400010001&ZDISP1'       DISP 1
         AIF   ('&MEMBER' EQ '').WEI4
IH&P.F   DC    X'00030001'                  MEMBER - NAME
         DC    AL2(IH&P.F1)                 
IH&P.F2  DC    C'&MEMBER'                   
IH&P.F1  EQU   *-IH&P.F2                    V
.WEI4    ANOP
         AIF   ('&VOL' EQ '').WEI5
IH&P.H   DC    X'00100001'                  VOLSER
         DC    AL2(IH&P.H1)                 
IH&P.H2  DC    C'&VOL'                      
IH&P.H1  EQU   *-IH&P.H2                    V
.WEI5    ANOP
         AIF   ('&UNIT' EQ '').WEI6
IH&P.I   DC    X'00150001'                  UNIT
         DC    AL2(IH&P.I1)                 
IH&P.I2  DC    C'&UNIT'                     
IH&P.I1  EQU   *-IH&P.I2                    V
.WEI6    ANOP
         AIF   ('&FREE' NE '').WEI7
IH&P.K   DC    X'001C0000'                  FREE = CLOSE
.WEI7    ANOP
         AIF   ('&ZDISP1' EQ '04').WEI999
.WEI7R   ANOP
         AIF   ('&ZDISP2' EQ '').WEI7A
IH&P.X   DC    X'000500010001&ZDISP2'       DISP 2
.WEI7A   ANOP
         AIF   ('&ZDISP3' EQ '').WEI7B
IH&P.Y   DC    X'000600010001&ZDISP3'       DISP 3
.WEI7B   ANOP
         CNOP  0,4
IH&P.Z   EQU   *
         AIF   ('&RECFM' EQ '').WEI8
         AIF   ('&RECFM2' EQ '').WEI8
         OI    IH&P.U+6,X'&RECFM2'          CODE 2.RECFM-PARAM.
         AIF   ('&RECFM3' EQ '').WEI8
         OI    IH&P.U+6,X'&RECFM3'          CODE 3.RECFM-PARAM.
.WEI8    ANOP
         SVC 99
         MEXIT
.WEI99   ANOP
         AIF   ('&SPACE(1)' NE 'TRK').WEI99A
         DC    AL4(IH&P.L)                  ADR TRACK
.WEI99A  ANOP
         AIF   ('&SPACE(1)' NE 'CYL').WEI99B
         DC    AL4(IH&P.M)                  ADR CYLINDER
.WEI99B  ANOP
         AIF   ('&SPACE(2)' EQ '').WEI99C
         DC    AL4(IH&P.N)                  ADR PRIMARY SPACE
.WEI99C  ANOP
         AIF   ('&SPACE(3)' EQ '').WEI99D
         DC    AL4(IH&P.O)                  ADR SECONDERY SPACE
.WEI99D  ANOP
         AIF   ('&SPACE(4)' EQ '').WEI99E
         DC    AL4(IH&P.P)                  ADR DIRECTORY BL.
.WEI99E  ANOP
         AIF   ('&SPACE(5)' EQ '').WEI99F
         DC    AL4(IH&P.Q)                  ADR RELEASE UNUSED SP.
.WEI99F  ANOP
         AIF   ('&EXPDT' EQ '').WEI99G
         DC    AL4(IH&P.R)                  ADR EXP-DATE
.WEI99G  ANOP
         AIF   ('&RETPD' EQ '').WEI99H
         DC    AL4(IH&P.S)                  ADR RETPD
.WEI99H  ANOP
         AIF   ('&MSVGP' EQ '').WEI99I
         DC    AL4(IH&P.T)                  ADR MSVGP
.WEI99I  ANOP
         AIF   ('&RECFM' EQ '').WEI99J
         DC    AL4(IH&P.U)                  ADR ADR RECFM
.WEI99J  ANOP
         AIF   ('&LRECL' EQ '').WEI99K
         DC    AL4(IH&P.V)                  ADR ADR LRECL
.WEI99K  ANOP
         AIF   ('&RECFM' EQ '').WEI99L
         DC    AL4(IH&P.W)                  ADR BLKSIZE
.WEI99L  ANOP
         AGO   .WEI3R
.WEI999  ANOP
         AIF   ('&SPACE(1)' NE 'TRK').WEI999A
IH&P.L   DC    X'00070000'                  SPACE = TRACKS
.WEI999A ANOP
         AIF   ('&SPACE(1)' NE 'CYL').WEI999B
IH&P.M   DC    X'00080000'                  SPACE = CYLINDERS
.WEI999B ANOP
         AIF   ('&SPACE(2)' EQ '').WEI999C
IH&P.N   DC    X'000A00010003'              PRIMARY SPACE
         DC    AL3(&SPACE(2))               V
.WEI999C ANOP
         AIF   ('&SPACE(3)' EQ '').WEI999D
IH&P.O   DC    X'000B00010003'              SECONDARY SPACE
         DC    AL3(&SPACE(3))               V
.WEI999D ANOP
         AIF   ('&SPACE(4)' EQ '').WEI999E
IH&P.P   DC    X'000C00010003'              DIRECTORY BLOCKS
         DC    AL3(&SPACE(4))               V
.WEI999E ANOP
         AIF   ('&SPACE(5)' EQ '').WEI999F
IH&P.Q   DC    X'000D0000'                  RELEASE = YES
.WEI999F ANOP
         AIF   ('&EXPDT' EQ '').WEI999G
IH&P.R   DC    X'002200010005'              EXPIRATION DATE
         DC    C'&EXPDT'                    V
.WEI999G ANOP
         AIF   ('&RETPD' EQ '').WEI999H
IH&P.S   DC    X'002300010002'              RETENTION PERIOD
         DC    AL2(&RETPD)                  V
.WEI999H ANOP
         AIF   ('&MSVGP' EQ '').WEI999I
IH&P.T   DC    X'005E0001'                  MSS - GROUP
         DC    AL2(IH&P.T1)                 
IH&P.T2  DC    C'&MSVGP'                    
IH&P.T1  EQU   *-IH&P.T2                    V
.WEI999I ANOP
         AIF   ('&RECFM' EQ '').WEI999J
IH&P.U   DC    X'004900010001'              RECFM
         AGO   .RECR
.WE999JR ANOP
         DC    X'&RECFM1'                   RECFM 1
.WEI999J ANOP
         AIF   ('&LRECL' EQ '').WEI999K
IH&P.V   DC    X'004200010002'              LRECL
         DC    AL2(&LRECL)                  V
.WEI999K ANOP
         AIF   ('&BLKSIZE' EQ '').WEI999L
IH&P.W   DC    X'003000010002'              BLKSIZE
         DC    AL2(&BLKSIZE)                V
.WEI999L ANOP
         AGO   .WEI7R
.RECR    ANOP
&RECFM1  SETC  '&RECFM'(1,1)
&RECFM2  SETC  '&RECFM'(2,1)
&RECFM3  SETC  '&RECFM'(3,1)
         AIF   ('&RECFM1' NE 'M').RECR1A
&RECFM1  SETC  '02'
         AGO   .RECR2
.RECR1A  ANOP
         AIF   ('&RECFM1' NE 'A').RECR1B
&RECFM1  SETC  '04'
         AGO   .RECR2
.RECR1B  ANOP
         AIF   ('&RECFM1' NE 'S').RECR1C
&RECFM1  SETC  '08'
         AGO   .RECR2
.RECR1C  ANOP
         AIF   ('&RECFM1' NE 'B').RECR1D
&RECFM1  SETC  '10'
         AGO   .RECR2
.RECR1D  ANOP
         AIF   ('&RECFM1' NE 'V').RECR1E
&RECFM1  SETC  '40'
         AGO   .RECR2
.RECR1E  ANOP
         AIF   ('&RECFM1' NE 'F').RECR1F
&RECFM1  SETC  '80'
         AGO   .RECR2
.RECR1F  ANOP
         AIF   ('&RECFM1' NE 'U').RECR2
&RECFM1  SETC  'C0'
.RECR2   ANOP
         AIF   ('&RECFM2' EQ '').RECR4
         AIF   ('&RECFM2' NE 'M').RECR2A
&RECFM2  SETC  '02'
         AGO   .RECR3
.RECR2A  ANOP
         AIF   ('&RECFM2' NE 'A').RECR2B
&RECFM2  SETC  '04'
         AGO   .RECR3
.RECR2B  ANOP
         AIF   ('&RECFM2' NE 'S').RECR2C
&RECFM2  SETC  '08'
         AGO   .RECR3
.RECR2C  ANOP
         AIF   ('&RECFM2' NE 'B').RECR2D
&RECFM2  SETC  '10'
         AGO   .RECR3
.RECR2D  ANOP
         AIF   ('&RECFM2' NE 'V').RECR2E
&RECFM2  SETC  '40'
         AGO   .RECR3
.RECR2E  ANOP
         AIF   ('&RECFM2' NE 'F').RECR2F
&RECFM2  SETC  '80'
         AGO   .RECR3
.RECR2F  ANOP
         AIF   ('&RECFM2' NE 'U').RECR3
&RECFM2  SETC  'C0'
.RECR3   ANOP
         AIF   ('&RECFM3' EQ '').RECR4
         AIF   ('&RECFM3' NE 'M').RECR3A
&RECFM3  SETC  '02'
         AGO   .RECR4
.RECR3A  ANOP
         AIF   ('&RECFM3' NE 'A').RECR3B
&RECFM3  SETC  '04'
         AGO   .RECR4
.RECR3B  ANOP
         AIF   ('&RECFM3' NE 'S').RECR3C
&RECFM3  SETC  '08'
         AGO   .RECR4
.RECR3C  ANOP
         AIF   ('&RECFM3' NE 'B').RECR3D
&RECFM3  SETC  '10'
         AGO   .RECR4
.RECR3D  ANOP
         AIF   ('&RECFM3' NE 'V').RECR3E
&RECFM3  SETC  '40'
         AGO   .RECR4
.RECR3E  ANOP
         AIF   ('&RECFM3' NE 'F').RECR3F
&RECFM3  SETC  '80'
         AGO   .RECR4
.RECR3F  ANOP
         AIF   ('&RECFM3' NE 'U').RECR4
&RECFM3  SETC  'C0'
.RECR4   ANOP
         AGO   .WE999JR
.ZDISPR  ANOP
&ZDISP1  SETC  '&DISP(1)'
&ZDISP2  SETC  '&DISP(2)'
&ZDISP3  SETC  '&DISP(3)'
         AIF   ('&ZDISP1' EQ '' AND '&ZDISP2' EQ '' AND                *
               '&ZDISP3' EQ '').ZDIEND
         AIF   ('&ZDISP1' NE '').ZDI1A
&ZDISP1  SETC  '04'
         AGO   .ZDI2
.ZDI1A   ANOP
         AIF   ('&ZDISP1' NE 'SHR').ZDI1B
&ZDISP1  SETC  '08'
         AGO   .ZDI2
.ZDI1B   ANOP
         AIF   ('&ZDISP1' NE 'MOD').ZDI1C
&ZDISP1  SETC  '02'
         AGO   .ZDI2
.ZDI1C   ANOP
         AIF   ('&ZDISP1' NE 'OLD').ZDI1D
&ZDISP1  SETC  '01'
         AGO   .ZDI2
.ZDI1D   ANOP
         AIF   ('&ZDISP1' NE 'NEW').ZDI2
&ZDISP1  SETC  '04'
.ZDI2    ANOP
         AIF   ('&ZDISP2' EQ '').ZDI3
         AIF   ('&ZDISP2' NE 'UNCATLG').ZDI2A
&ZDISP2  SETC  '01'
         AGO   .ZDI3
.ZDI2A   ANOP
         AIF   ('&ZDISP2' NE 'CATLG').ZDI2B
&ZDISP2  SETC  '02'
         AGO   .ZDI3
.ZDI2B   ANOP
         AIF   ('&ZDISP2' NE 'DELETE').ZDI2C
&ZDISP2  SETC  '04'
         AGO   .ZDI3
.ZDI2C   ANOP
         AIF   ('&ZDISP2' NE 'KEEP').ZDI3
&ZDISP2  SETC  '08'
.ZDI3    ANOP
         AIF   ('&ZDISP3' EQ '').ZDI4
         AIF   ('&ZDISP3' NE 'UNCATLG').ZDI3A
&ZDISP3  SETC  '01'
         AGO   .ZDI4
.ZDI3A   ANOP
         AIF   ('&ZDISP3' NE 'CATLG').ZDI3B
&ZDISP3  SETC  '02'
         AGO   .ZDI4
.ZDI3B   ANOP
         AIF   ('&ZDISP3' NE 'DELETE').ZDI3C
&ZDISP3  SETC  '04'
         AGO   .ZDI4
.ZDI3C   ANOP
         AIF   ('&ZDISP3' NE 'KEEP').ZDI4
&ZDISP3  SETC  '08'
.ZDI4    ANOP
         AGO   .WEI0
.ZDIEND  ANOP
&ZDISP1  SETC  '08'
         AGO   .WEI0
         MEND
./ ADD  NAME=LUALLOCS
         MACRO
         LUALLOCS &DD=,&FREE=,&SYSOUT=,&PGM=,&LINES=,&COPIES=,&FCB=,   *
               &HOLD=,&RECFM=,&LRECL=,&BLKSIZE=,&UCS=
*
*        MACRO FUER DYNALLOC SYSOUT-DATEIN
*
         LCLC  &P,&RECFM1,&RECFM2,&RECFM3
&P       SETC  '&SYSNDX'
         CNOP  0,4
         BAL   R1,IH&P.Z
IH&P.A   DC    AL1(128),AL3(IH&P.B)
IH&P.B   DS    0CL20
         DC    X'14010000'
         DS    CL4
         DC    AL4(IH&P.C)
         DS    CL8
IH&P.C   DC    AL4(IH&P.D)                  ADR DD - NAME
         AIF   ('&PGM' EQ '').WEI1
         DC    AL4(IH&P.E)                  ADR PGM-NAME
.WEI1    ANOP
         AIF   ('&SYSOUT(3)' EQ '').WEI2
         DC    AL4(IH&P.F)                  ADR FORM-NUMBER
.WEI2    ANOP
         AIF   ('&RECFM' EQ '').WEI2A
         DC    AL4(IH&P.L)                  ADR RECFM
.WEI2A   ANOP
         AIF   ('&LRECL' EQ '').WEI2B
         DC    AL4(IH&P.M)                  ADR LRECL
.WEI2B   ANOP
         AIF   ('&BLKSIZE' EQ '').WEI2C
         DC    AL4(IH&P.N)                  ADR BLKSIZE
.WEI2C   ANOP
         AIF   ('&LINES' EQ '').WEI2D
         DC    AL4(IH&P.G)                  ADR LINES
.WEI2D   ANOP
         AIF   ('&UCS' EQ '').WEI3
         DC    AL4(IH&P.Q)                  ADR UCS
.WEI3    ANOP
         AIF   ('&FREE' EQ 'NO').WEI3A
         DC    AL4(IH&P.H)                  ADR FREE=CLOSE
.WEI3A   ANOP
         AIF   ('&COPIES' EQ '').WEI3R2
         DC    AL4(IH&P.I)                  ADR COPIES
.WEI3R2  ANOP
         AIF   ('&FCB' EQ '').WEI3R3
         DC    AL4(IH&P.J)                  ADR FCB
.WEI3R3  ANOP
         AIF   ('&HOLD' NE 'YES').WEI3R4
         DC    AL4(IH&P.K)                  ADR HOLD
.WEI3R4  ANOP
         DC    AL1(128),AL3(IH&P.O)         ADR SYSOUT
IH&P.D   DC    X'00010001'                  DD - NAME
         DC    AL2(IH&P.D1)                 
IH&P.D2  DC    C'&DD'                       
IH&P.D1  EQU   *-IH&P.D2                    V
         AIF   ('&PGM' EQ '').WEI5Z
IH&P.E   DC    X'00190001'                  PGM
         DC    AL2(IH&P.E1)                 
IH&P.E2  DC    C'&PGM'                      
IH&P.E1  EQU   *-IH&P.E2                    V
.WEI5Z   ANOP
         AIF   ('&UCS' EQ '').WEI5
IH&P.Q   DC    X'00290001'                  UCS
         DC    AL2(IH&P.Q1)                 
IH&P.Q2  DC    C'&UCS'                      
IH&P.Q1  EQU   *-IH&P.Q2                    V
.WEI5    ANOP
         AIF   ('&SYSOUT(3)' EQ '').WEI6
IH&P.F   DC    X'001A0001'                  FORM-NUMBER
         DC    AL2(IH&P.F1)                 
IH&P.F2  DC    C'&SYSOUT(3)'                
IH&P.F1  EQU   *-IH&P.F2                    V
.WEI6    ANOP
         AIF   ('&FREE' EQ 'NO').WEI7
IH&P.H   DC    X'001C0000'                  FREE = CLOSE
.WEI7    ANOP
         AIF   ('&LINES' EQ '').WEI7A
IH&P.G   DC    X'001B00010003'              LINES
         DC    AL3(&LINES)
.WEI7A   ANOP
         AIF   ('&COPIES' EQ '').WEI7B
IH&P.I   DC    X'001D00010001'
         DC    AL1(&COPIES)
.WEI7B   ANOP
         AIF   ('&FCB' EQ '').WEI7C
IH&P.J   DC    X'002500010004'
         DC    CL4'&FCB'
.WEI7C   ANOP
         AIF   ('&HOLD' NE 'YES').WEI7D
IH&P.K   DC    X'00590000'
.WEI7D   ANOP
IH&P.O   DC    X'001800010001'
         DC    C'&SYSOUT(1)'
         AIF   ('&RECFM' EQ '').WEI7S
         AGO   .DCB
.WEI7R   ANOP
         AIF   ('&RECFM' EQ '').WEI7S
IH&P.L   DC    X'004900010001&RECFM1'
.WEI7S   ANOP
         CNOP  0,4
IH&P.Z   EQU   *
         AIF   ('&RECFM' EQ '').WEI8
         AIF   ('&RECFM2' EQ '').WEI8
         OI    IH&P.L+6,X'&RECFM2'          CODE 2.RECFM-PARAM.
         AIF   ('&RECFM3' EQ '').WEI8
         OI    IH&P.L+6,X'&RECFM3'          CODE 3.RECFM-PARAM.
.WEI8    ANOP
         SVC 99
         MEXIT
.DCB     ANOP
         AIF   ('&LRECL' EQ '').DCB1
IH&P.M   DC    X'004200010002'              LRECL
         DC    AL2(&LRECL)                  V
.DCB1    ANOP
         AIF   ('&BLKSIZE' EQ '').DCB2
IH&P.N   DC    X'003000010002'              BLKSIZE
         DC    AL2(&BLKSIZE)                V
.DCB2    ANOP
&RECFM1  SETC  '&RECFM'(1,1)
&RECFM2  SETC  '&RECFM'(2,1)
&RECFM3  SETC  '&RECFM'(3,1)
         AIF   ('&RECFM1' NE 'M').RECR1A
&RECFM1  SETC  '02'
         AGO   .RECR2
.RECR1A  ANOP
         AIF   ('&RECFM1' NE 'A').RECR1B
&RECFM1  SETC  '04'
         AGO   .RECR2
.RECR1B  ANOP
         AIF   ('&RECFM1' NE 'S').RECR1C
&RECFM1  SETC  '08'
         AGO   .RECR2
.RECR1C  ANOP
         AIF   ('&RECFM1' NE 'B').RECR1D
&RECFM1  SETC  '10'
         AGO   .RECR2
.RECR1D  ANOP
         AIF   ('&RECFM1' NE 'V').RECR1E
&RECFM1  SETC  '40'
         AGO   .RECR2
.RECR1E  ANOP
         AIF   ('&RECFM1' NE 'F').RECR1F
&RECFM1  SETC  '80'
         AGO   .RECR2
.RECR1F  ANOP
         AIF   ('&RECFM1' NE 'U').RECR2
&RECFM1  SETC  'C0'
.RECR2   ANOP
         AIF   ('&RECFM2' EQ '').RECR4
         AIF   ('&RECFM2' NE 'M').RECR2A
&RECFM2  SETC  '02'
         AGO   .RECR3
.RECR2A  ANOP
         AIF   ('&RECFM2' NE 'A').RECR2B
&RECFM2  SETC  '04'
         AGO   .RECR3
.RECR2B  ANOP
         AIF   ('&RECFM2' NE 'S').RECR2C
&RECFM2  SETC  '08'
         AGO   .RECR3
.RECR2C  ANOP
         AIF   ('&RECFM2' NE 'B').RECR2D
&RECFM2  SETC  '10'
         AGO   .RECR3
.RECR2D  ANOP
         AIF   ('&RECFM2' NE 'V').RECR2E
&RECFM2  SETC  '40'
         AGO   .RECR3
.RECR2E  ANOP
         AIF   ('&RECFM2' NE 'F').RECR2F
&RECFM2  SETC  '80'
         AGO   .RECR3
.RECR2F  ANOP
         AIF   ('&RECFM2' NE 'U').RECR3
&RECFM2  SETC  'C0'
.RECR3   ANOP
         AIF   ('&RECFM3' EQ '').RECR4
         AIF   ('&RECFM3' NE 'M').RECR3A
&RECFM3  SETC  '02'
         AGO   .RECR4
.RECR3A  ANOP
         AIF   ('&RECFM3' NE 'A').RECR3B
&RECFM3  SETC  '04'
         AGO   .RECR4
.RECR3B  ANOP
         AIF   ('&RECFM3' NE 'S').RECR3C
&RECFM3  SETC  '08'
         AGO   .RECR4
.RECR3C  ANOP
         AIF   ('&RECFM3' NE 'B').RECR3D
&RECFM3  SETC  '10'
         AGO   .RECR4
.RECR3D  ANOP
         AIF   ('&RECFM3' NE 'V').RECR3E
&RECFM3  SETC  '40'
         AGO   .RECR4
.RECR3E  ANOP
         AIF   ('&RECFM3' NE 'F').RECR3F
&RECFM3  SETC  '80'
         AGO   .RECR4
.RECR3F  ANOP
         AIF   ('&RECFM3' NE 'U').RECR4
&RECFM3  SETC  'C0'
.RECR4   ANOP
         AGO   .WEI7R
         MEND
./ ADD  NAME=LUCATANS
** TITLE   ANSWER FOR A CATALOG SEARCH REQUEST
** OWNER   FRANZ
** LCHNG   05/05/83 12:34:56   Z227128 FRANZ
         MACRO
&NM      LUCATANS &PREF=CRP
&NM      DS    0D
&PREF.NAME DC    CL44' '       DSNAME FOUND ON THIS ENTRY
&PREF.NMLN DC    H'0'          LENGTH OF DSN FOUND
&PREF.NIX  DC    H'0'          NUMBER OF INDEX LEVELS FOUND
&PREF.FLAG DC    X'0'          FLAG BYTE
&PREF.VOLL EQU   X'80'         WHEN ON  ==> DEVT CONTAINS POINTER TO
*                                           VOLUME LIST
&PREF.NVOL DC    H'0'          NUMBER OF VOLUMES, DATASET RESIDES ON
&PREF.DEVT DC    F'0'          DEVICE TYPE FROM CATALOG ENTRY
*                              OR POINTER TO VOLUME LIST
&PREF.VOLS DC    CL6' '        VOLSER, IF ONLY ONE
         MEND
./ ADD  NAME=LUCATDEF
** TITLE   DEFINITION DER MASTERCATALOGE
** OWNER   FRANZ
** LCHNG   05/05/83 11:46:48   Z227128 FRANZ
         MACRO
&NM      LUCATDEF &PREF=CAT
&NM      DS    0D
&PREF.SYS  DC    CL4' '        SYSTEM ID
&PREF.NAME DC    CL44' '       DSNAME OF CATALOG
&PREF.NML  DC    AL1(0)        LENGTH OF THIS DSNAME
&PREF.PSWL DC    AL1(0)        LENGTH OF PASSWORD
&PREF.PSWA DC    CL8' '        PASSWORD
           DS    0D
&PREF.ELN  EQU   *-&PREF.SYS   LENGTH OF AN ENTRY
         MEND
./ ADD  NAME=LUDCB
         MACRO
         LUDCB &IN=CARD,&PRNT=LIST,&PCH=,&INPEOF=,                     *
               &INPDDN=LUINPUT,&PRTDDN=LUPRINT,&PCHDDN=LUPUNCH,        *
               &INM=M,&PRM=M,&PUM=M
         AIF   ('&IN' EQ '').NOIN
*
**************************************************
*                                                *
*        ***  CARD-INPUT-DCB  ***                *
*                                                *
**************************************************
*
         AIF   ('&INPEOF' EQ '').NOEOF
&IN      DCB   DDNAME=&INPDDN,DSORG=PS,MACRF=(G&INM),EODAD=&INPEOF,    *
               RECFM=FB,LRECL=80,BLKSIZE=80
         AGO   .NOIN
.NOEOF   ANOP
&IN      DCB   DDNAME=&INPDDN,DSORG=PS,MACRF=(G&INM),                  *
               RECFM=FB,LRECL=80,BLKSIZE=80
.NOIN    AIF   ('&PRNT' EQ '').NOPRNT
*
**************************************************
*                                                *
*        ***  LIST-OUTPUT-DCB  ***               *
*                                                *
**************************************************
*
&PRNT    DCB   DDNAME=&PRTDDN,DSORG=PS,MACRF=(P&PRM),                  *
               RECFM=FBA,LRECL=133,BLKSIZE=133
.NOPRNT  AIF   ('&PCH' EQ '').NOPCH
*
**************************************************
*                                                *
*        ***  CARD-OUTPUT-DCB  ***               *
*                                                *
**************************************************
*
&PCH     DCB   DDNAME=&PCHDDN,DSORG=PS,MACRF=(P&PUM),                  *
               RECFM=FB,LRECL=80,BLKSIZE=80
.NOPCH   ANOP
         MEND
./ ADD  NAME=LUDVTAB
** TITLE   DEFINITION VON DEVICE KONSTANTEN
** OWNER   P. RASP TEL 26390
** LCHNG   09/30/83 12:18:34   Z227128 H. FRANZ
         MACRO
&NM      LUDVTAB &P=DVT,&TYPE=
         AIF   ('&TYPE' EQ '').LAB1
&NM      DSECT
         AGO   .LAB2
.LAB1    ANOP
&NM      DS    0D
.LAB2    ANOP
&P.UNTNM DS    CL8                         C'3330V'
&P.DEVT  DS    XL4                         X'30582009'
&P.BLKSI DS    F       MAX. BLOCKSIZE        13030
&P.TRKSI DS    F       TRACKSIZE             13165
&P.CYLS  DS    H       # OF CYLS               411
&P.CYLSU DS    H       # OF CYLS USABLE        404
&P.TRKS  DS    H       TRACKS PER CYLINDER      19
&P.BOHK  DS    H       BLOCK OVERHEAD (KEYED)  191
&P.BOHD  DS    H       BLOCK OVERHEAD (NO KEY) 135
&P.UNTNL DS    H       REAL LENGTH OF UNITNAME
&P.ELE   EQU   *-&P.UNTNM
         MEND
./ ADD  NAME=LUFREE
         MACRO
         LUFREE &DD=,&DSN=,&MEMBER=
*
*        MACRO FUER FREE PS/PO DATEIN
*
         LCLC  &P
&P       SETC  '&SYSNDX'
         CNOP  0,4
         BAL   R1,IH&P.Z
IH&P.A   DC    AL1(128),AL3(IH&P.B)
IH&P.B   DS    0CL20
         DC    X'14020000'
         DS    CL4
         DC    AL4(IH&P.C)
         DS    CL8
IH&P.C   DS    0C
         AIF   ('&DSN' EQ '').WEI1
         DC    AL4(IH&P.E)                  ADR DS - NAME
.WEI1    ANOP
         AIF   ('&MEMBER' EQ '').WEI2
         DC    AL4(IH&P.F)                  ADR MEMBER - NAME
.WEI2    ANOP
         DC    AL1(128),AL3(IH&P.D)         ADR DD - NAME
IH&P.D   DC    X'00010001'
         DC    AL2(IH&P.D1)
IH&P.D2  DC    C'&DD'
IH&P.D1  EQU   *-IH&P.D2
         AIF   ('&DSN' EQ '').WEI3
IH&P.E   DC    X'00020001'
         DC    AL2(IH&P.E1)
IH&P.E2  DC    C'&DSN'
IH&P.E1  EQU   *-IH&P.E2
.WEI3    ANOP
         AIF   ('&MEMBER' EQ '').WEI4
IH&P.F   DC    X'00030001'
         DC    AL2(IH&P.F1)
IH&P.F2  DC    C'&MEMBER'
IH&P.F1  EQU   *-IH&P.F2
.WEI4    ANOP
         CNOP  0,4
IH&P.Z   EQU   *
         SVC 99
         MEND
./ ADD  NAME=LUGENMAC
         TITLE '   DEFINITIONS, COMMON TO ALL LUGENER ROUTINES'
*
*              EQUIVALENCES FOR REGISTERS AND IMMEDIATE OPERATORS
*
         SPACE 3
*
*        REGISTER USE
*
R0       EQU   0
R1       EQU   1
LIMIT    EQU   2             UPPER LIMIT FOR SCAN
PNT      EQU   3             POINTER ON INPUT-CARD
LEN      EQU   4             EXECUTION-REGISTER
FUNC     EQU   5             POINTER IN FUNCTION TABLE
SW       EQU   6             POINTS TO COMMUNICATION SWITCHES
WK1      EQU   7             WORK REG
WK2      EQU   8             WORK REG
MSG      EQU   9             POINTER TO MESSAGES
PRM      EQU   10            BASE FOR PARAMETERS
LNK      EQU   11            LINK REGISTER
BAS      EQU   12            BASE REGISTER FOR ALL LUGENER ROUTINES
R13      EQU   13            SAVEAREA POINTER
R14      EQU   14
R15      EQU   15
         SPACE 3
*
*        BIT   SWITCHES CONTAINED IN SWFUNC
*
WRNGEOD  EQU   128
NOTFOUND EQU   64
CNTFOUND EQU   32
NOFUNC   EQU   16
FUNCEND  EQU   8
FULL     EQU   4
ERR      EQU   2
WARNING  EQU   1
         SPACE 3
*
*              BIT SWITCHES IN BYTE 'SW2'
*
ISORG    EQU   128
IMSORG   EQU   64
COREFULL EQU   32
PSORG    EQU   16            INDICATES BSAM
SCANIS   EQU   8      SW2
SPECENT  EQU   4             INDICATES A SPECIAL ENTRY WITH NO UPDATING
         SPACE 3
*
*              BIT SWITCHES CONTAINED IN SWINPUT
*
EODADIN  EQU   4
FULLIND  EQU   8
ENDREQ   EQU   16
         SPACE 3
*
*        BIT SWITCHES CONTAINED IN SWITCH BYTE 'SWTAB'
*
TABNOTAB EQU   128
TABFULL  EQU   64
TABEODAD EQU   32
TABNOTOK EQU   128+64+32
TABINTPT EQU   16            TABLE INTERPRETATION IS REQUESTED
COMPAC   EQU   8             COMPARISON OF LITERAL-ACCUS IS REQUESTED
COMPAC2  EQU   4             COMPARISON OF LITERAL-ACCUS IS REQUESTED
         SPACE 3
*
*              BIT SWITCHES CONTAINED IN SWITCH BYTE 'SWOPEN'
*
PRTOPEN  EQU   128
INOPEN   EQU   64
UT2OPEN  EQU   32
INPOPEN  EQU   16
ALLOPEN  EQU   128+64+32+16
*
         SPACE 3
*
*              BIT SWITCHES CONTAINED IN SWITCH BYTE 'SWIPRT1'
*
*
NOFORMAT EQU   128
STARWAS  EQU   64
FMTEND   EQU   32
*
*              SWITCHES CONTAINED IN SWITCH-BYTE 'SWIPRT2'
*
HEX      EQU   64
NOMOVE   EQU   32
NOSPLIT  EQU   16
ODERWAS  EQU   8             INDICATES THE PRECENCE OF 'ODER' OR 'OR'
ONLYDIG  EQU   4
PDKONST  EQU   2
SAVING   EQU   1
         SPACE 3
*
*              SWITCHES CONTAINED IN SWITCH-BYTE 'SW3'
*
SUBTRACT EQU   1             INDICATES WHETHER A SUBTRACTION IS REQUIR.
MASKWAS  EQU   2             INDICATES A 'MOVEM' WAS PRECEDING AN EDIT
ISPUT    EQU   4
DONTPUT  EQU   8
LINCNTIS EQU   16
DOISACT  EQU   32            'DO' IS ACTIVE
         SPACE 3
*
*              BIT-SWITCHES CONTAINED IN SWITCH-BYTE 'SW4'
*
LASTWAS  EQU   1             INDICATES THE A 'LAST' FORMAT WAS
FIRSTWAS EQU   2             INDICATES THE A 'FIRST' FORMAT WAS
COUNTWAS EQU   4             INDICATES THE A 'COUNT' FORMAT WAS
FIRSTLIN EQU   8             INDICATES THE A 'FIRST' ENTRY IS IN USE
LASTIS   EQU   16            INDICATES THE A 'LAST' ENTRY IS IN USE
LASTREC  EQU   32
IRECFMV  EQU   64            INPUT RECFM = V
ORECFMV  EQU   128           OUTPUT RECFM= V
         SPACE 3
*              FUNCTION IDENTIFIERS
*
WTM      EQU   C'W'
FAULT    EQU   C'F'
UNLOAD   EQU   C'U'
REWIND   EQU   C'R'
BACKSP   EQU   C'B'
SKIP     EQU   C'S'
COPY     EQU   C'C'
TABLE    EQU   C'T'
ENDFUNC  EQU   C'E'
         SPACE 3
*
*              BYTE EQUIVALENCES
*
TAPE     EQU   X'81'         DCBDEVT, IF UNIT=TAPE WAS SPECIFIED
BLANK    EQU   C' '
POINTER  EQU   X'4F'
DOLLAR   EQU   C'$'
STERN    EQU   C'*'
KOMMA    EQU   C','
NULL     EQU   C'0'
EINS     EQU   C'1'
NEUN     EQU   C'9'
         SPACE 3
*
*              IMMEDIATE OPERATORS USED FOR DECISION MAKING
*
ODERENDE EQU   X'20'         INDICATES THE END OF A CHAIN OF OR'S
ORENTRY  EQU   X'40'
EQUAL    EQU   X'70'         BRANCH MASK IF 'EQUAL' IS REQUIRED
HIGH     EQU   X'D0'         BRANCH MASK IF 'HIGH'  IS REQUIRED
LOW      EQU   X'B0'         BRANCH MASK IF 'LOW'   IS REQUIRED
UNEQUAL  EQU   X'80'         BRANCH MASK IF 'UNEQUAL' IS REQUIRED
HIGHEQ   EQU   X'40'         BRANCH MASK IF 'GREATER THAN' IS REQUIRED
LOWEQ    EQU   X'20'         BRANCH MASK IF 'LESS THAN' IS REQUIRED
*
ENDINDIC EQU   128
TABENTLN EQU   10*8
CARDLEN  EQU   72
         TITLE ' DUMMY SECTIONS, USED BY LUGENER ROUTINES'
         DCBD  DSORG=(PS,IS)
         SPACE 3
*
*              PRINTLINE DESCRIPTION
*
AZEILE   DSECT               DESIGN OF THE OUTPUT-LINE
ASA      DS    CL1
AFLAG    DS    CL12          FLAGS
         DS    CL2
ACARDOUT DS    CL80          CARD IMAGE ON OUTPUT-LINE
         DS    CL2
AERRMSG  DS    0CL20          MESSAGES
AADVERB  DS    CL7           ADVERB OF MESSAGE
         DS    CL1
ASUBJECT DS    CL9           SUBJECT OF MESSAGE
         DS    CL3
         DS    CL1
AMSGSUB  DS    CL6           SUBJECTIVE OF SHORTENED MESSAGE
         DS    CL1
AACTION  DS    CL8           ACTION TAKEN WITH SUBJECTIVE
ALINELEN EQU   *-AFLAG       LENGTH OF THE LINE FOR BLANKING
*
         SPACE 3
*
*              DESCRIPTION OF A FUNCTION ENTRY
*
FUNCTION DSECT
FCOUNT   DS    PL8
FIDENT   DS    CL1
FCLEN    EQU   *-FUNCTION
         SPACE 3
FMTDSECT DSECT               FORMAT-FIELD DESCRIPTION
FMTINCR  DS    H             INCREMENT  (LENGTH OF THIS FIELD (+1))
FMTCODE  DS    H             FORMAT-CODE
FMTCNT   DS    H             FORMAT-COUNT (REPETITION-FAKTOR OR LENGTH)
FMTLITLN DS    H             LENGTH OF THE FOLLOWING LITERAL
FMTLIT   EQU   *             LITERAL FOLLOWS
         ORG   FMTLITLN
FMTKONST DS    PL8           DECIMAL CONSTANT (FOR ADD, COUNT, ETC.)
         ORG   FMTLITLN
FMTAKU#  DS    H             AKU-NUMBER SECOND AKU
         SPACE 3
*
*              DESCRIPTION OF THE COMMUNICATION VECTOR
*
MAINPARM DSECT
AGETROUT DS    0A            ADDRESS OF THE GET ROUTINE
APARM    DS    A             A(PARMS ON EXEC CARD)
AKARTE   DS    A             A(PARAMETER-DCB)
ALISTE   DS    A             A(PROTOKOLL-DCB)
PCBAD    DS    0F            ADDRESS OF THE PCB WHEN 'IMS' WAS
AINPUT   DS    A             A(EINGABE-DCB)
AOUTPUT  DS    A             A(AUSGABE-DCB)
AINBUF   DS    A             A(INPUT DATA-AREA)
INBUFLEN DS    A              LENGTH OF THE INPUT AREA
ASEPDCBS DS    A             A(LISTE WEITERER AUSGABE DCB'S)
*
AFUNC    DS    A             A(FUNKTIONS-TABELLE)
AFORMAT  DS    A             A(FORMAT-ENTRY-TABELLE)
AACTIONS DS    A             A(ACTIONS)
ATABENTR DS    A             A(TABELLEN-ENTRIES)
OUTREC   DS    A             OUTPUT RECORD START ADDRESS
ALIST    DS    A             A(AUSGABEBEREICH)
ACARD    DS    A             A(EINGABEBEREICH)
LFUNC    DS    A             A(OBERGRENZE DER FUNKTIONS-TABELLE)
LFORMAT  DS    A             A(OBERGRENZE DER FORMATTABELLE)
LACTIONS DS    A             A(OBERGRENZE DER AKTIONSTABELLE)
FNCPOWER DC    H'0'
FMTPOWER DC    H'0'
ENTPOWER DC    H'0'
*
*              SWITCH BYTES
*
SWFUNC   DS    CL1
SWINPUT  DS    CL1
SW2      DS    CL1
SW3      DS    CL1
SWOPEN   DS    CL1
SWTAB    DS    CL1
SWIPRT1  DS    CL1                     SWITCHES FOR THE
SWIPRT2  DS    CL1                     INTERPRETATION ROUTINE
SW4      DS    CL1
INRECANF DS    F             BEGINN DES EINGABE RECORDS
INRECEND DS    F             ENDE DES EINGABE RECORDS
SYSINCDS DS    F             COUNT FOR CARDS FROM SYSIN
INPRECS  DS    F             COUNT FOR INPUT RECORDS FROM SYSUT1
OUTCNT   DS    F             COUNT FOR OUTPUT RECORDS TO SYSUT2
AACCU    DS    F             ADDRESS OF THE ACCUMULATORS
SAVFLDS  DS    F             BEGIN OF SAVE-BER CHAIN
ASCAN    DS    F             ADDRESS OF THE SCAN ROUTINE-CSECT
LASTLINE DS    F             ADDRESS OF FORMAT ASSOCIATED TO 'LAST'
NEWPAGE  DS    F             ADDRESS OF THE FORMAT ASSOCIATED TO 'FIRST
*                                                          OR 'COUNT'
LINECOMP DS    F             WORD WITH MAXIMUM LINE COUNT IF 'COUNT'
LINECNT  DS    F             WORD FOR LINE COUNT PER PAGE
ERRCNT   DS    F             COUNT FOR I/O-ERRORS FROM SYSUT1
ERRCOMP  DS    F             SPECIFIED MAXIMIM COUNT FOR THESE I/O ERR
AGENDUMP DS    F             ADDRESS OF DUMP MODUL FOR A RECORD OR BLOK
INPBLKS  DS    F             NUMBER OF INPUT BLOCKS FROM SYSUT1
ACCUNUM  DS    H             NUMBER OF ACCUMULATORS NORMALLY 10
INLRECL  DS    H             INPUT LRECL
IMSEODAD DS    F             EODAD ADDRESS WHEN 'IMS' WAS
PRTCNT   DS    F             RECORD COUNT FOR SYSPRINT DATA-SET
PAGECNT  DS    F             PAGE COUNT FOR SYSPRINT
AAFTLAST DS    F             START OF FORMATS AFTER 'LAST'
AHEADPRT DS    F             ADDRESS OF HEADER PRINT ROUTINE
DMACCU   DS    PL16          ACCU FOR DIVISION AND MULTIPLICATION
ATIME    DS    CL8
ADATE    DS    CL10
MAXLINES DS    F
ALFDNR   DS    F             ADDRESS OF 'LFDNR' - SUBROUTINE
ALFDNRD  DS    F             ADDRESS OF 'LFDNRDEF' - SUBROUTINE
ACONVXE  DS    F             ADDRESS OF 'CONVXE' - SUBROUTINE
ASTRTKEY DS    F             ADDRESS OF KEY TO START WITH (IMS OR IS)
ADRUPS   DS    F             ADRESS OF UP-START-VECTOR ( DO '
ANZUPS   DS    H             MAXIMUM NUMBER OF UP'S (DOLLAR-FORMATS)
OUTRECLM DS    F             UPPER LIMIT OF OUTPUT RECORD
F1       DS    F             RESERVED FOR FUTURE USE
F2       DS    F
PARMEND  DS    0D
./ ADD  NAME=LUGJPI
** TITLE   MACRO FUER LUGJPI
** OWNER   DEMEL
** LCHNG   11/30/83 13:48:25   Z228359 DEMEL
         MACRO
&NM      LUGJPI &P=PI
&NM      DS    0CL120
&P.JOBNM DC    CL8' '                  JOBNAME
&P.STPNM DC    CL8' '                  STEPNAME
&P.PRCNM DC    CL8' '                  NAME DES PROZEDURSTEPS
&P.PGMNM DC    CL8' '                  LADEMODULNAME
&P.DATE  DC    CL10' '                 DATUM  TT.MM.19JJ
&P.TIME  DC    CL8' '                  ZEIT   HH,MM,SS
&P.ACCT  DS    0CL28
&P.ARBNR DC    CL4' '                  ARBEITSNUMMER
&P.SBNR  DC    CL3' '                  SACHBEARBEITERNUMMER
&P.JOBKZ DC    CL1' '                  JOBKENNZEICHEN
&P.BZEIT DC    CL15' '                 BERICHTSZEIT
&P.RKZ   DC    CL4' '                  ROUTINEKENNZEICHEN
         DC    C' '                    RESERVED
&P.PGMRN DC    CL20' '                 PROGRAMMIERERNAME
&P.ENV   DC    CL1' '                  UMGEBUNGSKENNZEICHEN
&P.BTS   DC    CL1' '                  BTS KENNZEICHEN
&P.IMS   DC    CL1' '                  IMS REGION-TYPE
&P.AVSB# DC    CL3' '                  AV-SACHBEARBEITER#
&P.SYSID DC    CL4' '                  SYSTEM-IDENDIFICATION
         DC    CL12' '                 SPACE
         MEND
./ ADD  NAME=MODE24
         MACRO
&LABEL   MODE24
         LCLC  &L
&L       SETC  'IHB&SYSNDX'
&LABEL   DS    0H
         L     15,16              .GET CVT
         TM    X'74'(15),X'80'    .CHECK IF MVS/XA
         BNO   &L.A
         LA    15,&L.A
         DC    X'0B0F'            .BSM  0,15
&L.A     DS    0H
         MEND
./ ADD  NAME=MODE31
         MACRO
&LABEL   MODE31
         LCLC  &L
&L       SETC  'IHB&SYSNDX'
&LABEL   DS    0H
         L     15,16              .GET CVT
         TM    X'74'(15),X'80'    .CHECK IF MVS/XA
         BNO   &L.A
         L     15,=A(X'80000000'+&L.A)
         DC    X'0B0F'            .BSM  0,15
&L.A     DS    0H
         MEND
./ ADD  NAME=MOVE
         MACRO
&NAME    MOVE  &T,&L,&F,&CPU=360
         GBLB  &FIRST
         GBLC  &GOTO1
         GBLC  &CSECT
         LCLC  &GOTO2
         LCLC  &GOTO3
         AIF   ('&CPU' EQ '370').CODE
         AIF   ('&CPU' EQ '360').C360
         MNOTE 12,'CPU=&CPU  INVALID, SPECIFY 360 OR 370'
.C360    AIF   (&FIRST).W11
&CSECT   SETC  '&SYSECT'
.W11     AIF   ('&T'(1,1) EQ '(').W1
&NAME    LA    1,&T .        LOAD ADDRESS OF RECEIVING FIELD
         AGO   .W2
.W1      ANOP
&NAME    LR    1,&T(1) .     LOAD ADDRESS OF RECEIVING FIELD
.W2      AIF   ('&L'(1,1) EQ '(').W3
         AIF   (T'&L NE 'N').W7
.W9      LA    15,&L .        GET LENGTH
         AGO   .W4
.W7      AIF   (T'&L EQ 'F').W8
         AIF   (T'&L NE 'H').W9
         LH    15,&L .       LENGTH IS IN HALFWORD
         AGO   .W4
.W8      L     15,&L .       LENGTH IS IN FULLWORD
         AGO   .W4
.W3      LR    15,&L(1) .    LENGTH IS IN REGISTER
.W4      AIF   ('&F'(1,1) EQ '(').W5
         LA    2,&F .        LOAD ADDRESS OF SENDING FIELD
         AGO   .W6
.W5      LR    2,&F(1) .     LOAD ADDRESS OF SENDING FIELD
.W6      AIF   ('&CSECT' EQ '&SYSECT').W12
&FIRST   SETB  0
&CSECT   SETC  '&SYSECT'
.W12     AIF   (&FIRST).W10
&FIRST   SETB  1
&GOTO1   SETC  'IBC&SYSNDX'
&GOTO2   SETC  'IAC&SYSNDX'
&GOTO3   SETC  'ICC&SYSNDX'
         LA    14,&GOTO2+2 .  LOAD ADDRESS OF NEXT INSTRUCTION
         LA    0,256 .          LOAD MAX. MVC-LENGTH
&GOTO1   CR    15,0 .           COMPARE WITH ACTUAL LENGTH
         BC    4,&GOTO3 .       IF LESS, BRANCH TO LTR
         MVC   0(256,1),0(2) . MOVE 256 BYTES
         SR    15,0 .           REDUCE ACTUAL LENGTH
         AR    1,0 .            RESET FIELD POINTERS
         AR    2,0
         BC    15,&GOTO1 .      GO TO COMPARE
         MVC   0(0,1),0(2) .   EXEC-MVC
&GOTO3   LTR   15,15 .          IS REMAINDER ZERO ?
         BC    8,&GOTO2 .       IF TRUE GO TO MEND
         BCTR  15,0 .           REDUCE FOR EXECUTE
         EX    15,&GOTO3-6 .    MOVE REMAINING BYTES
&GOTO2   BR    14 .           RETURN
         MEXIT
.W10     BAL   14,&GOTO1-4 .  BRANCH TO LOOP
         MEXIT
.CODE    AIF   ('&T'(1,1) EQ '(').C1
&NAME    LA    0,&T .        LOAD ADDRESS OF RECEIVING FIELD
         AGO   .C2
.C1      ANOP
&NAME    LR    0,&T(1) .     LOAD ADDRESS OF RECEIVING FIELD
.C2      AIF   ('&L'(1,1) EQ '(').C3
         AIF   (T'&L NE 'N').C7
.C9      LA    1,&L .        GET LENGTH
         AGO   .C4
.C7      AIF   (T'&L EQ 'F').C8
         AIF   (T'&L NE 'H').C9
         LH    1,&L .        LENGTH IS IN HALFWORD
         AGO   .C4
.C8      L     1,&L .        LENGTH IS IN FULLWORD
         AGO   .C4
.C3      LR    1,&L(1) .     LENGTH IS IN REGISTER
.C4      LR    15,1 .        LENGTH IS IN REGISTER
         AIF   ('&F'(1,1) EQ '(').C5
         LA    14,&F .       LOAD ADDRESS OF SENDING FIELD
         AGO   .C6
.C5      LR    14,&F(1) .    LOAD ADDRESS OF SENDING FIELD
.C6      MVCL  0,14 .        MOVE LONG
         MEND
./ ADD  NAME=MQCR
         MACRO
         MQCR
MQCR     DSECT
         SPACE 1
***      DISCRIPTION OF THE MASTER QUEUE CONTROL RECORD
         SPACE 1
ADDRMQCR DS CL8 ADDRESS (MBCCHHR) OF MASTER QCR
         DS CL1 RESERVED
FREETRK  DS CL2 POINTER TO FIRST LOGICAL TRK IN FREE TRK QUEUE
         DS CL1 RESERVED
TRKINQU  DS CL2 NUMBER OF LOGICAL TRACKS IN QUEUE DATA SET
TRKFREE  DS CL2 NUMBER OF LOGICAL TRACKS IN FREE TRACK QUEUE
TRKTERM  DS CL2 NUMBER OF LOGICAL TRACKS RESERVED FOR JOB TERM
TRKINIT  DS CL2 NUMBER OF LOGICAL TRACKS RESERVED FOR INITIATORS
LSTFREE  DS CL2 POINTER TO LAST LOGICAL TRACK IN FREE TRACK QUEUE
TT1STRK  DS CL2 TT OF FIRST PHYS TRK CONTAINING NO QCRS
QCRPTRK  DS CL2 NUMBER OF QCRS PER PHYSICAL TRACK
RECPTRK  DS CL2 NUMBER OF RECORDS PER PHYSICAL TRACK
N176PTRK DS CL2 NUMBER OF 176 BYTE RECORDS PER LOGICAL TRACK
TRKRESIN DS CL2 NUMBER OF LOGICAL TRACKS TO RESERVE PER INITIATOR
QCRMIX   DS CL2 NUMBER OF QCRS ON THE MIXED TRACK
RC1NOQCR DS CL2 PTR TO 1ST REC ON 1ST TRK CONTAINING NO QCRS
         MEND
./ ADD  NAME=MSG
         MACRO
&NM      MSG   &N,&M,&ROUTCDE=11,&DESC=6
         LCLC  &END,&CH
         LCLA  &I,&B,&P,&Z
         LCLA   &D(16)
         LCLA  &NR,&ND
         LCLB  &SW
&END     SETC  'E&SYSNDX'
&B       SETA  1
&NR      SETA  N'&ROUTCDE
&ND      SETA  N'&DESC
&SW      SETB  0
&NM      DC    AL2(&END-*) LENGTH OF BUFFER
         AIF   ('&N' NE '').DC
         MNOTE 8,'MSG NUMBER OMITTED'
         MEXIT
.DC      DC    AL2(&N)     ERROR NUMBER
.VGL1    ANOP
&B       SETA  1
         AIF   (T'&ROUTCDE EQ 'O').END  OPERAND WAS OMITTED
.VGL     ANOP
&P       SETA  &ROUTCDE(&B)
&D(&P)   SETA  1
         AIF   (&NR EQ &B).END
&B       SETA  &B+1
         AGO   .VGL
.END     DC    B'&D(1)&D(2)&D(3)&D(4)&D(5)&D(6)&D(7)&D(8)' ROUTING-CODE
         DC    B'&D(9)&D(10)&D(11)&D(12)&D(13)&D(14)&D(15)&D(16)'
.LOE     ANOP
&D(&B)   SETA  0
         AIF   (&B EQ 16).DESC
&B       SETA  &B+1
         AGO   .LOE
.DESC    ANOP
&B       SETA  1
         AIF   (T'&DESC EQ 'O').END2  OPERAND WAS OMITTED
.VGL2    ANOP
&P       SETA  &DESC(&B)
&D(&P)   SETA  1
         AIF   (&ND EQ &B).END2
&B       SETA  &B+1
         AGO   .VGL2
.END2    DC    B'&D(1)&D(2)&D(3)&D(4)&D(5)&D(6)&D(7)&D(8)'  DESC-CODE
         DC    B'&D(9)&D(10)&D(11)&D(12)&D(13)&D(14)&D(15)&D(16)'
.PRUEF   AIF   (N'&M NE 0).ANF
         DC    AL1(34)     LENGTH OF FOLLOWING TEXT
         DC    C'NO TEXT'
         MNOTE 4
         AGO   .ENDE
.ANF     ANOP
&I       SETA   &I+1  INDEX ERHOEHEN
&CH      SETC  '&M(&I)'(1,1)
         AIF   (T'&M(&I) EQ 'N').ZAHL
.CHAR    ANOP
         AIF   (NOT (&SW)).GETLEN FLIP FLOP BETWEEN STRING & LENGTH
         MNOTE 8,'NUMERIC VALUE EXPECTED, STRING FOUND'
         MEXIT
.GETLEN  ANOP
&SW      SETB  1
         DC    AL1(L'C&SYSNDX&Z)  LENGTH OF FOLLOWING TEXT
         AIF   ('&CH' EQ '''').HOCHK
C&SYSNDX&Z DC  C'&M(&I)'
         AGO   .FORTS
.HOCHK   ANOP
C&SYSNDX&Z DC  C&M(&I)
.FORTS   ANOP
&Z       SETA  &Z+1
         AGO   .ER
.ZAHL    ANOP
         AIF   (&SW).DOADDR
         MNOTE 8,'STRING EXPECTED, NUMERIC VALUE FOUND'
         MEXIT
.DOADDR  ANOP
&SW      SETB  0
         DC    AL1(&M(&I))  NUMBER OF CHARACTERS TO BE INSERTED
.ER      ANOP
         AIF   (&I EQ N'&M).ENDE
         AGO   .ANF
.ENDE    ANOP
&END     EQU   *
         MEND
./ ADD  NAME=MSGBUF
         MACRO
         MSGBUF
*
*        MESSAGE BUFFER LAYOUT
*
         DC    F'0'           FORCE WORD ALIGN
MSGBUF   DS    0XL129         TOTAL BUFFER LENGTH
MSGLNGTH DC    H'125'         MESSAGE LENGTH
MSGMCSFL DC    X'80'          MCS FLAGS INDICATOR
         DC    X'00'
MSGPREF  DS    0CL10          MESSAGE PREFIX
MSGLNCTL DC    C' '           LINE CONTROL CHAR
MSGIDENT DS    0CL7           MESSAGE IDENTIFIER
         DC    C'B'           FIXED INTITIAL (BASF)
MSGPGMID DC    C'XX'          PROGRAM ID
*                             A  - APPLICATION
*                             C  - CONTROL
*                             M  - MAINTENANCE
*                             S  - SERVICE
*                             U  - UTILITY
MSGNUMBR DC    C'000'         MESSAGE NUMBER
MSGTYPE  DC    C'X'           MESSAGE TYPE INDICATOR
*                             A  - ACTION            (RC=0)
*                             C  - CONDITIONAL ERROR (RC=8)
*                             D  - DECISION          (RC=0)
*                             E  - ERROR             (RC=12)
*                             I  - INFORMATION       (RC=0)
*                             T  - TERMINAL ERROR    (RC=16)
*                             W  - WARNING           (RC=4)
         DC    C'  '          SEPERATORS
MSGTEXT  DC    CL111' '       MESSAGE TEXT
MSGDESC  DC    X'0400'        DESCRIPTOR CODE (6)
MSGROUTC DC    X'0020'        ROUTING CODE (11)
         MEND
./ ADD  NAME=MSGBUFD
         MACRO
         MSGBUFD
MSGBUFD  DSECT
         MSGBUF
         SPACE 2
         MEND
./ ADD  NAME=MSGCALL
         MACRO
&NAME    MSGCALL &NR,&FIELD,&EP=,&MSG=,&MF=,&DSECT=
         LCLA  &NF,&IF
         LCLA  &A,&L
         LCLB  &IN,&LS,&EX,&SU
         LCLB  &ERR,&CHK
         LCLC  &SYM
         LCLC  &C
.* THIS MACRO WILL BE PROCESSED TWICE, FIRST IN CHECKING MODE, THEN
.* GENERATING CODE, IF NO ERROR HAS BEEN DETECTED
&NF      SETA  N'&FIELD
&CHK     SETB  (1)
&SYM     SETC  '&NAME'
.* TEST IF NAME CAN BE GENERATED, IF NECESSARY
         AIF   ('&NR' EQ '').SSYM
         AIF   ('&NR'(1,1) EQ '(').SSYM
&A       SETA  K'&NR
         AIF   ('&NR'(1,1) EQ '-').NEG
         AIF   (&A LT 4).VLD
         AIF   (&A GT 4).ENR
         AIF   ('&NR'(1,1) LT '0').VLD
.ENR     ANOP
         MNOTE 8,'INVALID NUMBER SPECIFICATION'
&ERR     SETB  (1)
&SYM     SETC  'MSGC0000'
         AGO   .SSYM
.VLD     ANOP
         AIF   ('&SYM' NE '').SSYM
&SYM     SETC  'MSGC'.'&NR'
         AGO   .SSYM
.NEG     ANOP
         AIF   (&A EQ 1 OR &A GT 5).ENR
         AIF   (&A LT 5).NEGC
         AIF   ('&NR'(2,1) GE '0').ENR
.NEGC    ANOP
         AIF   ('&SYM' NE '').SSYM
&SYM     SETC  'MSGC'.'&NR'(2,&A-1)
.SSYM    ANOP
.* DETERMINE MACRO FUNCTION
.START   ANOP
         AIF   ('&MF' EQ '').INLINE
&C       SETC  '&MF(1)'
         AIF   ('&C' EQ 'L').LIST
         AIF   ('&C' EQ 'E').EXEC
         AIF   ('&C' EQ 'S').SETUP
         MNOTE 8,'INVALID MACRO FUNCTION'
         MEXIT
.INLINE  ANOP
.* INLINE INITIALIZATION
&IN      SETB  (1)
         AIF   (&CHK).SINT
         CNOP  0,4
&SYM     BAL   1,MSGC&SYSNDX            BRANCH AROUND LIST
&SYM     SETC  ''
.SINT    ANOP
         AGO   .SMF
.* LISTFORM ENTRANCE
.LIST    ANOP
&LS      SETB  (1)
         AIF   ('&SYM' NE '').VSYM
         MNOTE 8,'NAME OR NUMBER REQUIRED FOR LISTFORM'
&ERR     SETB  (1)
.VSYM    ANOP
         AGO   .SMF
.* EXECUTE FORM
.EXEC    ANOP
&EX      SETB  (1)
         AGO   .GLIST
.* SETUP FUNCTION
.SETUP   ANOP
&SU      SETB  (1)
.* LIST ADDRESS PICKUP
.GLIST   ANOP
         AIF   ('&MF(2)' NE '').VLIST
         MNOTE 8,'LISTNAME/-ADDRESS REQUIRED WHEN MF=&C'
&ERR     SETB  (1)
         AGO   .SLIST
.VLIST   ANOP
         AIF   (&CHK).SLIST
         AIF   ('&MF(2)'(1,1) EQ '(').RLIST
&SYM     LA    1,&MF(2)                 LOAD LIST ADDRESS
&SYM     SETC  ''
         AGO   .SLIST
.RLIST   ANOP
         AIF   (K'&MF(2) EQ 3 AND '&MF(2)'(2,1) EQ '1').SLIST
&SYM     LR    1,&MF(2)                 LOAD LIST ADDRESS
&SYM     SETC  ''
.SLIST   ANOP
         AIF   (&EX).SXFR
         AIF   ('&MF(3)' NE '').SXFR
         MNOTE 8,'XFR ADDRESS REQUIRED FOR MF=S'
&ERR     SETB  (1)
.SXFR    ANOP
.SMF     ANOP
.* NUMBER GENERATION
         AIF   (&EX OR &SU).SNR
         AIF   ('&NR' EQ '').ONR
         AIF   ('&NR'(1,1) EQ '(').RNR
         AIF   (&CHK).SNR
&C       SETC  ''
         AIF   ('&NR'(1,1) NE '-').GNR
&C       SETC  '0'
.GNR     ANOP
&SYM     DC    A(&C&NR)                 MESSAGE NUMBER
         AGO   .NR0X
.RNR     ANOP
         AIF   (&IN).VRNR
         MNOTE 8,'REGISTER NOTATION INVALID FOR LISTFORM'
&ERR     SETB  (1)
         AGO   .SNR
.VRNR    ANOP
         AGO   .NR0
.ONR     ANOP
         AIF   (&LS).VONR
         MNOTE 8,'NUMBER REQUIRED FOR INLINE FUNCTION'
&ERR     SETB  (1)
         AGO   .SNR
.VONR    ANOP
.NR0     ANOP
         AIF   (&CHK).SNR
&SYM     DC    A(0)                     MESSAGE NUMBER
.NR0X    ANOP
&SYM     SETC  ''
         AIF   (NOT &IN).SNR
         DC    A(0)                     MODULE/MODADDR POINTER
         DC    A(0)                     MESSAGE BUFFER POINTER
         AIF   ('&DSECT' NE '').ANR0
         AIF   (&NF EQ 0).ANRL
         DC    A(*-10)                  NUMBER ADDRESS
         AGO   .ANR0C
.ANRL    ANOP
         DC    X'80'                    END OF LIST
         DC    AL3(*-11)                NUMBER ADDRESS
         AGO   .ANRX
.ANR0    ANOP
         DC    A(0)                     NUMBER ADDRESS
         AIF   (&NF EQ 0).ANRX
.ANR0C   ANOP
         DC    &NF.A(0)                 FIELD POINTERS
.ANRX    ANOP
MSGC&SYSNDX EQU   *
.SNR     ANOP
.* MODULE NAME / ENTRY POINT ADDRESS POINTER
         AIF   ('&EP' EQ '').OEP
         AIF   ('&EP'(1,1) EQ '(').REP
         AIF   (&CHK).SEP
         AIF   (NOT &LS).LDEP
         AIF   ('&DSECT' NE '').ANR0
         DC    A(&EP)                   MODULE/MODADDR POINTER
         AGO   .SEP
.AEP0    ANOP
         DC    A(0)                     MODULE/MODADDR POINTER
         AGO   .SEP
.LDEP    ANOP
&SYM     LA    0,&EP                    LOAD MODULE/MODADDR ADDR
&SYM     SETC  ''
         ST    0,4(0,1)                 STORE INTO LIST
         AGO   .SEP
.REP     ANOP
         AIF   (NOT &LS).VREP
         MNOTE 8,'REGISTER NOTATION INVALID FOR LISTFORM'
&ERR     SETB  (1)
         AGO   .SEP
.VREP    ANOP
         AIF   (&CHK).SEP
&SYM     ST    &EP,4(0,1)               STORE MODNM/-ADDR PTR INTO LIST
&SYM     SETC  ''
         AGO   .SEP
.OEP     ANOP
         AIF   (&EX OR &SU).SEP
         AIF   (&LS).VOEP
         MNOTE 8,'EP REQUIRED FOR INLINE FUNCTION'
&ERR     SETB  (1)
         AGO   .SEP
.VOEP    ANOP
         AIF   (&CHK).SEP
         DC    A(0)                     MODULE/MODADDR POINTER
.SEP     ANOP
.* MESSAGE BUFFER POINTER
         AIF   ('&MSG' EQ '').OMSG
         AIF   ('&MSG'(1,1) EQ '(').RMSG
         AIF   (&CHK).SMSG
         AIF   (NOT &LS).LDMSG
         AIF   ('&DSECT' NE '').ANR0
         DC    A(&MSG)                  MESSAGE BUFFER POINTER
         AGO   .SMSG
.AMSG0   ANOP
         DC    A(0)                     MESSAGE BUFFER POINTER
         AGO   .SMSG
.LDMSG   ANOP
&SYM     LA    0,&MSG                   LOAD MESSAGE BUFFER ADDR
&SYM     SETC  ''
         ST    0,8(0,1)                 STORE INTO LIST
         AGO   .SMSG
.RMSG    ANOP
         AIF   (NOT &LS).VRMSG
         MNOTE 8,'REGISTER NOTATION INVALID FOR LISTFORM'
&ERR     SETB  (1)
         AGO   .SMSG
.VRMSG   ANOP
         AIF   (&CHK).SMSG
&SYM     ST    &MSG,8(0,1)              STORE BUFFER ADDR INTO LIST
&SYM     SETC  ''
         AGO   .SMSG
.OMSG    ANOP
         AIF   (&EX OR &SU).SMSG
         AIF   (&LS).VOMSG
         MNOTE 8,'BUFFER ADDRESS REQUIRED FOR INLINE FUNCTION'
&ERR     SETB  (1)
         AGO   .SMSG
.VOMSG   ANOP
         AIF   (&CHK).SMSG
         DC    A(0)                     MESSAGE BUFFER POINTER
.SMSG    ANOP
.* NUMBER POINTER
         AIF   (&CHK).SANR
         AIF   (NOT &LS).LDANR
         AIF   ('&DSECT' NE '').ANR0
         AIF   (&NF EQ 0).ANRL0
         DC    A(*-10)                  NUMBER ADDRESS
         AGO   .SANR
.ANRL0   ANOP
         DC    X'80'                    END OF LIST
         DC    AL3(*-11)                NUMBER ADDRESS
         AGO   .SANR
.ANR00   ANOP
         DC    A(0)                     NUMBER ADDRESS
         AGO   .SANR
.LDANR   ANOP
         AIF   (&IN).SANR
         AIF   ('&EP' EQ '' AND '&MSG' EQ '').SANR
&SYM     LA    0,2(0,1)                 LOAD NUMBER ADDRESS
&SYM     SETC  ''
         XC    13(3,1),13(1)
         O     0,12(0,1)                SAVE END OF LIST, IF SET
         ST    0,12(0,1)                AND STORE INTO LIST
.SANR    ANOP
.* NUMBER PICKUP
         AIF   (&CHK).SNR0
         AIF   ('&NR' EQ '').SNR0
         AIF   ('&NR'(1,1) NE '(').LDNR
&SYM     ST    &NR,0(0,1)               STORE NUMBER INTO LIST
&SYM     SETC  ''
         AGO   .SNR0
.LDNR    ANOP
         AIF   (&IN OR &LS).SNR0
         AIF   ('&NR'(1,1) EQ '-').NEG0
&SYM     LA    0,&NR                    LOAD NUMBER
         AGO   .LDNRC
.NEG0    ANOP
&C       SETC  '&NR'(2,K'&NR-1)
&SYM     LA    0,&C                     LOAD NUMBER,
         LNR   0,0                      INVERT
.LDNRC   ANOP
&SYM     SETC  ''
         ST    0,0(0,1)                 AND STORE INTO LIST
.SNR0    ANOP
.* FIELD POINTERS
&IF      SETA  0
&A       SETA  12
&L       SETA  16
         AIF   (&CHK).FLD
         AIF   (&IN OR &LS).FLD
         AIF   (&NF EQ 0).FLD
&SYM     NI    12(1),X'7F'              RESET END OF LIST, IF ON
&SYM     SETC  ''
.FLD     ANOP
&IF      SETA  &IF+1
         AIF   (&IF GT &NF).XFLD
&A       SETA  &A+4
         AIF   ('&FIELD(&IF)' EQ '').OFLD
         AIF   ('&FIELD(&IF)'(1,1) EQ '(').RFLD
         AIF   (&CHK).FLD
         AIF   (&LS).AFLD
&SYM     LA    0,&FIELD(&IF)            LOAD FIELD ADDR
&SYM     SETC  ''
         ST    0,&A.(0,1)               STORE INTO LIST
.CLR     ANOP
         AIF   (&L EQ &A).CLRX
         NI    &L.(1),X'7F'             RESET END OF LIST, IF SET
&L       SETA  &L+4
         AGO   .CLR
.CLRX    ANOP
&L       SETA  &L+4
         AGO   .FLD
.AFLD    ANOP
         AIF   ('&DSECT' NE '').ANR0
         AIF   (&IF EQ &NF).AFLDL
         DC    A(&FIELD(&IF))           FIELD ADDRESS
         AGO   .FLD
.AFLDL   ANOP
         DC    X'80'                    END OF LIST
         DC    AL3(&FIELD(&IF))         FIELD ADDRESS
         AGO   .SFLD
.RFLD    ANOP
         AIF   (NOT &LS).VRFLD
         MNOTE 8,'REGISTER NOTATION INVALID FOR LISTFORM'
&ERR     SETB  (1)
         AGO   .FLD
.VRFLD   ANOP
         AIF   (&CHK).FLD
&SYM     ST    &FIELD(&IF),&A.(0,1)     STORE FIELD ADDR INTO LIST
&SYM     SETC  ''
         AGO   .CLR
.OFLD    ANOP
         AIF   (&CHK).FLD
         AIF   (&EX OR &SU).FLD
         AIF   (&IN).BACK
         DC    A(0)                     FIELD POINTER
         AGO   .FLD
.BACK    ANOP
&A       SETA  &A-4
         AGO   .FLD
.XFLD    ANOP
         AIF   (&CHK).SFLD
         AIF   (&LS).SFLD
         AIF   (&NF EQ 0).SFLD
&L       SETA  &L-4
         AIF   (&A NE &L).SFLD
&SYM     MVI   &A.(1),X'80'             SET END OF LIST FLAG
&SYM     SETC  ''
.SFLD    ANOP
.* GENERATION DECISION
         AIF   (NOT &CHK).CONT
&CHK     SETB  (0)
         AIF   (NOT &ERR).START
         MEXIT
.CONT    ANOP
.* EXIT PROCEDURES
         AIF   (&LS).DONE
         AIF   (NOT &SU).CALL
         AIF   ('&MF(3)'(1,1) EQ '(').RXFR
&SYM     B     &MF(3)                   BRANCH TO XFER ADDR
         AGO   .DONE
.RXFR    ANOP
&SYM     BR    &MF(3)                   BRANCH TO XFER REG
         AGO   .DONE
.CALL    ANOP
&SYM     LA    1,4(0,1)                 POINT REG TO PARM LIST
         L     15,=V(MSGGEN)            LOAD ROUTINE ADDRESS
         BALR  14,15                    LINK TO ROUTINE
.DONE    MEND
./ ADD  NAME=MULTWORK
** TITLE   LUMULT WORK AREA
** OWNER   128.FRANZ
** LCHNG   01/12/83 17:01:01   Z227128 FRANZ
         REG
         TITLE 'LUMULT WORK CONTROL BLOCK'
* DUMMY SECTION FOR A WORK CONTROL BLOCK,REQUIRED FOR
* REENTERABILITY OF THE PROGRAM.
* IT CONTAINS ALL DCBS,THE SWITCH BYTES,THE COUNTERS ETC.
*
Z        DC    D'0'
WRKTEMPD DC    D'0'  TEMPORARY STORAGE AREA
PARM     DC    5F'0'
WRKAFTER DC    F'0'               COUNT FOR BLOCKS WHEN PRT,NNN IS
WRKPRTCT DC    F'0'
WRKBUFF  DC    F'0'             INPUT-BUFFER
WRKECB   DC    F'0'
PARMS    DC    2F'0'
DCBLST   DC    X'80'
         DC    AL3(0)
RECB     DC    F'0'
TIMEINT  DC    X'7FFFFFFF'
EXITS    DC    F'0'
CNTBUFF  DC    F'0'
LSRCNT   DC    F'0'
WTORDOM  DC    F'0'          ADDRESS OF REPLY QUEUE ELEMENT
*
*                  THIS SECTION CONTAINS RESTART INFORMATION
*
BLKCNT   DC    F'0'
VOLCNT   DC    F'0'
INPCNT   DC    F'0'
OUTPCNT  DC    F'0'
CNTCNT   DC    F'0'
CRDCNT   DC    F'0'
WRKCURR  DC    F'0'
PREVCPU  DC    F'0'
TIMECNT  DC    F'0'          CPU-TIME IN TIMER-UNITS
*
*                  THIS SMF RECORD IS WRITTEN, WHENEVER A
*                  STANDERD LABEL TAPE IS TO BE PROCESSED
*                  WITH NO PRINTER CONTROL CHARACTER IN THE LABEL
*
FBASMF   DS    0F
         DC    AL2(FBAEND-FBASMF)
         DC    AL2(0)
         DC    X'0'
FBATYPE  DC    X'B1'
FBACOMM  DS    0CL12
FBATIME  DC    XL4'00'
FBADATE  DC    XL4'00'
FBASYST  DC    XL4'00'
FBAJOBNM DC    CL8' '
FBASTPNM DC    CL8' '
FBAABR#  DC    CL4' '
FBADSN   DC    CL44' '
FBACRDTE DC    CL6' '
FBAEND   EQU   *
DCKSMF   DS    0F
*              THIS SMF-RECORD IS TO BE WRITTEN, WHENEVER
*              A DATACHECK FROM PRINTER HAS OCCURRED
*              FOR AN ONLINE PRINTING 'LUMULT' TASK
DCKLEN   DC    AL2(DCKEND-DCKSMF)       LENGTH OF THE RECORD
         DC    AL2(0)                   FILLER
         DC    X'0'                     RESERVED
DCKTYPE  DC    AL1(250)                 TYPE OF SMF-RECORD
DCKCOMM  DS    0CL12
DCKTIME  DC    XL4'0'                   TIME RECORD WAS CREATED
DCKDATE  DC    XL4'0'                   DATE RECORD WAS CREATED
DCKSYSID DC    XL2'0'                   SYSTEM IDENTIFIER
DCKMODID DC    XL2'0'                   MODEL NUMBER
DCKJOBNM DC    CL8' '                   JOBNAME
DCKSTPNM DC    CL8' '                   STEPNAME
DCKABR#  DC    CL4' '                   ABRECHNUNGS-NUMMER
DCKUNIT  DC    XL2'0'                   UNIT INDICATING DATA-CHECKS
DCKEXCPS DC    XL4'0'                   NUMBER OF EXCPS TO UNIT
DCKCNT   DS    0F            COUNT FIELDS FOR DATACHECKS FROM PRINTER
DCKDCKS  DC    XL4'0'                   NUMBER OF EXCPS WITH DATA-CHEC
DCKBLK1  DC    F'0'
DCKBLK2  DC    F'0'
DCKBLK3  DC    F'0'
DCKFCB   DC    CL4' '        SPACE FOR THE FCB ID  (3211)
DCKEND   EQU   *
WRKBLKSI DC    H'0'               INPUT BLOCKSIZE
WRKLRECL DC    H'0'               INPUT LRECL
WRKCOLCT DC    H'0'
DISKSW   DC    X'0'
*        BIT-SWITCHES CONTAINED IN 'DISKSW'
*
FSRS     EQU   1
BSRS     EQU   2
NEWSW    DC    X'0'  SWITCH-BYTE FOR CONDITIONS WITH NEW VOLUME
*        BIT-SWITCHES CONTAINED IN 'NEWSW
*
PRT3211  EQU   1
TRA      EQU   2
UNREC    EQU   4
SYSTASK  EQU   8
RST      EQU   16
XBIT     EQU   32
TRUNC    EQU   64
WRTSMFOK EQU   128
*
WRKIOS   DC    X'0'
* BYTE 'WRKIOS' CONTAINS BITS FOR INPUT/OUTPUT INFORMATION.
*
ALL      EQU   1   PRINT THE WHOLE DATA SET
TAP      EQU   2   INPUT DATA SET IS ON TAPE
LST      EQU   4   LIST SELECTION IS REQUIRED
TPC      EQU   8   PARAMETER COMMAND IS A TAPE CONTROL
CDE      EQU   16  PARAMETER 'END' IS GOT
INV      EQU   32  OPERATOR INTERVENTION WAS
EOT      EQU   64  SET FOR RECOGNIZE EMPTY TAPES
NEW      EQU   128
*
WRKINF   DC    X'0'
* BYTE 'WRKINF' CONTAINS RECORD INFORMATIONS.
*
ASA      EQU   1   RECORD CONTAINS ASA CONTROL CHARACTERS
WOP      EQU   2   WTOR IS HANGING UP
LOK      EQU   4   UNEQUAL LIST SELECTION CHARACTER
MCC      EQU   8   RECORD CONTAINS MACHINE CONTROL CHARACTERS
NCC      EQU   16  RECORD CONTAINS NO CONTROL CHARACTERS
UNF      EQU   32  RECORD FORMAT IS VNDEFINED
VAR      EQU   64  RECORD FORMAT IS VARIABLE (BLOCKED)
SW2      DC    X'0'
NOCARDS  EQU   1
TOTALCL  EQU   2
NOCHECKP EQU   4
ACCT     EQU   8
NOT1     EQU   16
DEL      EQU   32
EOF      EQU   64
BRK      EQU   128
WRKSEL   DC    X'0'  LIST SELECTION CHARACTER
WRKZWI   DC    X'0'     WORCK-BYTE FO9&0G&H-&G
WRKLST   DC    X'0'
LSR      EQU   1
PRR      EQU   2
SMFWAS   EQU   32             INDICATES SMF WAS WRITTEN ON LAST RUN
NOWTRA   EQU   64            FROM NOW TRANSLATION IS REQUIRED
TERM     EQU   X'80'         CONTAINED IN 'ERRSW' MEANS TERMINATION
WRKCON   DC    X'0'
FSR      EQU   0
BSR      EQU   4
FSM      EQU   8
BSM      EQU   12
*
* DEFINITIONS AND TABLES.
*
MESSAG   DC    C'OPERATOR INTERVENTION WAS'
MSG      DC    C'GEGENWAERTIGE BLOCKNUMMER = '
MASK     DC    X'40204020202040202120'
LM       EQU   L'MSG+L'MASK
WRKTEMP1 DC    CL5' '
WRKTEMP2 DC    CL4' '
PARMKEEP DC    CL11' '
WRKREPLY DC    CL11' '
FORMTAB  DC    CL8' '
DUMMYDSN DC    XL5'7B7C7C7C7B'  DUMMY DSNAME IN PROCEDURE
FCBID    DC    CL4' '
LABR     DC    C'LABEL ON MOUNTED TAPE IS RUINED OR TAPE IS NOLABEL'
WVOL     DC    C'INCORRECT VOLUME MOUNTED'
WDSN     DC    C'INCORRECT DSNAME SPECIFIED'
NAMES    DC    CL8' '
         DC    CL8' '
         DC    CL8'  MULT'
JFCBAREA DS    0D
         DC    (2*176)X'00'  CLEAR THE JFCBS
         ORG   JFCBAREA
JFCB1    DS    0D            JFCB FOR INPUT DCB
         IEFJFCBN
JFCB2    DS    0D            JFCB FOR OUTPUT DCB
         ORG
REPTAB   DC    0A(0)
VOLUME   DC    CL6'V'
BLKSIZE  DC    CL6'B'
LRECL    DC    CL6'S'
RECFM    DC    CL6'R'
LABEL    DC    CL6'L'
FILE     DC    CL6'F'
DSN      DC    CL6'D'
FCB      DC    CL6'C'
         DC    X'FF'
MASKTAB  EQU   *
*                A B F M S T U V
         DC    X'00FFFF00FFFFFFFF'   A
         DC    X'FF00FFFFFFFF00FF'   B
         DC    X'FFFF00FFFFFF0000'   F
         DC    X'00FFFF00FFFFFFFF'   M
         DC    X'FFFFFFFF00FFFFFF'   S
         DC    X'FFFFFFFFFF00FFFF'   T
         DC    X'FF0000FFFFFF0000'   U
         DC    X'FFFF00FFFFFF0000'   V
*                A B F M S T U V
BITTAB   EQU   *
         DC    X'04'   A
         DC    X'10'   B
         DC    X'80'   F
         DC    X'02'   M
         DC    X'08'   S
         DC    X'20'   T
         DC    X'C0'   U
         DC    X'40'   V
TRTTABLE DS    0CL256        TRANSLATE TABLE FOR UNPRINTABLE CHARACTERS
*
         DC    X'00444444444444444444444444444444'    00-0F
         DC    X'44444444444444444444444444444444'    10-1F
         DC    X'44444444444444444444444444444444'    20-2F
         DC    X'44444444444444444444444444444444'    30-3F
         DC    X'00444444444444444444440000000000'    40-4F
         DC    X'00444444444444444444440000000000'    50-5F
         DC    X'00004444444444444444440000000000'    60-6F
         DC    X'44444444444444444444000000000000'    70-7F
         DC    X'44444444444444444444444444444444'    80-8F
         DC    X'44444444444444444444444444444444'    90-9F
         DC    X'44444444444444444444444444444444'    A0-AF
         DC    X'44444444444444444444444444444444'    B0-BF
         DC    X'44000000000000000000444444444444'    C0-CF
         DC    X'44000000000000000000444444444444'    D0-DF
         DC    X'44440000000000000000444444444444'    E0-EF
         DC    X'00000000000000000000444444444444'    F0-FF
*
*
TRTOCRA  DS    0CL256        TRANSLATE TABLE FOR UNPRINTABLE CHARACTERS
*                            FOR OCRA PRINTER TRAIN
*
         DC    X'00444444444444444444444444444444'    00-0F
         DC    X'44444444444444444444444444444444'    10-1F
         DC    X'44444444444444444444444444444444'    20-2F
         DC    X'44444444444444444444444444444444'    30-3F
         DC    X'00444444444444444444440044444444'    40-4F
         DC    X'00444444444444444444444400444444'    50-5F
         DC    X'00004444444444444444440000444444'    60-6F
         DC    X'44444444444444444444440044004444'    70-7F
         DC    X'44444444444444444444444444444444'    80-8F
         DC    X'44444444444444444444444444444444'    90-9F
         DC    X'44444444444444444444444444444444'    A0-AF
         DC    X'44444444444444444444444444444444'    B0-BF
         DC    X'44000000000000000000444400440044'    C0-CF
         DC    X'44000000000000000000444444444444'    D0-DF
         DC    X'44440000000000000000444400444444'    E0-EF
         DC    X'00000000000000000000444444444444'    F0-FF
*
*
CCTAB    DS    0CL256   TRANSLATE TABLE FOR ASA TO MCC
         DC    78X'09'  WRITE,SPACE 1 AFTER PRINT
         DC    X'0109'
         DC    X'01'    WRITE,NO SPACE
         DC    15X'09'
         DC    X'19'    WRITE,SPACE 3 AFTER PRINT
         DC    96X'09'
         DC    X'D1'    WRITE,SKIP TO CHANNEL 10 AFTER PRINT
         DC    X'D9'                          11
         DC    X'E1'                          12
         DC    44X'09'
         DC    X'11'    WRITE,SPACE 2 AFTER PRINT
         DC    X'89'    WRITE,SKIP TO CHANNEL 1 AFTER PRINT
         DC    X'91'                          2
         DC    X'99'                          3
         DC    X'A1'                          4
         DC    X'A9'                          5
         DC    X'B1'                          6
         DC    X'B9'                          7
         DC    X'C1'                          8
         DC    X'C9'                          9
         DC    6X'09'
TRATABLE DS    0CL256
***       TRANSLATETABLE FOR UNPRINTABLE CHARACTERS AND UNPACKED DIGITS
         DC    X'007C7C7C7C7C7C7C7C7C7C7C7C7C7C7C'         00
         DC    X'7C7C7C7C7C7C7C7C7C7C7C7C7C7C7C7C'         10
         DC    X'7C7C7C7C7C7C7C7C7C7C7C7C7C7C7C7C'         20
         DC    X'7C7C7C7C7C7C7C7C7C7C7C7C7C7C7C7C'         30
         DC    X'407C7C7C7C7C7C7C7C7C7C4B4C4D4E4F'         40
         DC    X'507C7C7C7C7C7C7C7C7C7C5B5C5D5E5F'         50
         DC    X'60617C7C7C7C7C7C7C7C7C6B6C6D6E6F'         60
         DC    X'7C7C7C7C7C7C7C7C7C7C7A7B7C7D7E7F'         70
         DC    X'7C7C7C7C7C7C7C7C7C7C7C7C7C7C7C7C'         80
         DC    X'7C7C7C7C7C7C7C7C7C7C7C7C7C7C7C7C'         90
         DC    X'7C7C7C7C7C7C7C7C7C7C7C7C7C7C7C7C'         A0
         DC    X'7C7C7C7C7C7C7C7C7C7C7C7C7C7C7C7C'         B0
         DC    X'4EC1C2C3C4C5C6C7C8C97C7C7C7C7C7C'         C0
         DC    X'60D1D2D3D4D5D6D7D8D97C7C7C7C7C7C'         D0
         DC    X'5C7CE2E3E4E5E6E7E8E97C7C7C7C7C7C'         E0
         DC    X'F0F1F2F3F4F5F6F7F8F97C7C7C7C7C7C'         F0
*
* DATA CONTROL BLOCKS.
*
CARD     DCB   DDNAME=SYSIN,                                           *
               DSORG=PS,                                               *
               EROPT=ACC,                                              *
               BUFNO=1,                                                *
               MACRF=(GL)
INPUT    DCB   DDNAME=LUMLTINP,                                        *
               DSORG=PS,                                               *
               EXLST=INEXIT,                                           *
               MACRF=(RC)
OUTPUT   DCB   DDNAME=LUMLTOUT,                                        *
               BFTEK=S,                                                *
               BUFNO=1,                                                *
               RECFM=FBM,                                              ,
               DSORG=PS,                                               *
               LRECL=133,                                              *
               EROPT=ABE,                                              *
               EXLST=OUTEXIT,                                          *
               MACRF=(PL)
         SPACE 3
         ORG   *-16
COUNTER  DCB   DDNAME=LUMLTCNT,                                        *
               DSORG=DA,                                               *
               MACRF=(RIC,WIC),                                        *
               BLKSIZE=176,                                            *
               RECFM=FB,                                               *
               OPTCD=WR
         SPACE 3
         ORG   *-16
COUNTER2 DCB   DDNAME=LUMLTCNT,                                        *
               DSORG=DA,                                               *
               MACRF=(RIC,WIC),                                        *
               BLKSIZE=176,                                            *
               RECFM=FB,                                               *
               OPTCD=WR
LABELDCB DCB   DDNAME=LABELCK,                                         *
               MACRF=(GL),                                             *
               RECFM=FB,BLKSIZE=80,                                    *
               DSORG=PS
SFDECB   READ  DECB,SF,MF=L       READ LIST-FORM
DADECB   READ  DECBDI,DI,,,'S',0,MF=L
INEXIT   DCBEXIT JFCB=JFCB1,                                           *
               EOV=EOVEXIT,                                            *
               BLOCK=BLEXIT
OUTEXIT  DCBEXIT JFCB=JFCB2,                                           *
               OPEN=0
LABEXIT  DC    F'0'
EOVEXIT  EQU   *
         L     R1,VOLCNT     GET THE VOLUME COUNT
         LA    R1,1(R1)      ADD ONE
         ST    R1,VOLCNT     RESET UPDATED COUNT
         SR    R15,R15       CLEAR REG
         ST    R15,WRKCURR   CLEAR THE BLOCKCOUNT IN WORK CSECT
         BR    14
BLEXIT   EQU   *
         STM   R0,R15,FIL    SAVE ALL REGISTERS
         CVD   R0,Z          BLOCKCOUNT FROM END LABEL
         OI    Z+7,X'0F'     MAKE PRINTABLE
         UNPK  WTO237+46(5),Z+5(3)   BRING COUNT TO WTO LIST FORM
         L     R0,INPUT+12   GET COUNT FROM DCB
         CVD   R0,Z          CONVERT THE COUNT
         OI    Z+7,X'0F'     MAKE PRINTABLE
         UNPK  WTO237+58(5),Z+5(3)   BRING COUNT TO WTO LIST FORM
         LA    R1,WTO237     POINT TO WTO LIST FORM
         WTO   MF=(E,(1))    WRITE TO OPERATOR
         LM    R0,R15,FIL    GET REGISTERS BACK
         LA    15,0          LET PGM ABEND WITH SCC 237
         BR    14
LWTOR    WTOR  'MULT ON INP/OUT,READY FOR COMMUNICATION,        ,      *
                 ',ROUTCDE=(1,7),MF=L
NEWWTOL  WTOR  'MULT ON INP/OUT,REPLY NEW VOLUME-IDENTIFICATION OR RST'*
               ,ROUTCDE=(1,7),MF=L
ERRWTO   WTO   'LUMULT-REPLY, ERROR IN       FIELD',ROUTCDE=(1,7),MF=L
ACCWTOR  WTOR  'MULT ON INP/OUT, REPLY ACCOUNTING INFORMATION',        *
               ROUTCDE=(1,7),MF=L
SMFWTO   WTO   'MULT ON INP/OUT, RETCODE FROM SMF-WRITE = XXX',        *
               ROUTCDE=(1,7),MF=L
ENDWTO   WTOR  'MULT ON INP/OUT,            COMPLETED, WHAT NOW ?',    *
               ROUTCDE=(1,7),MF=L
LABWTO   WTO   'MULT ON INP/OUT,                                       *
                                                 ',ROUTCDE=(1,7),MF=L
DCKWTO   WTO   'MULT ON INP/OUT, DCK ON PRINTER, INPUT BLOCK# =      ',*
               ROUTCDE=7,MF=L
INPWTO   WTO   'MULT ON INP/OUT,DCK FROM INPUT,BLOCK# =      ',        *
               ROUTCDE=(7,11),MF=L
WTO237   WTO   'MULT ON INP/OUT, LISTE UNBRAUCHBAR, TAPE =      ,DCB = *
                      WEGEN BLOCK-COUNT FEHLER',                       *
               ROUTCDE=(1,7,11,15),DESC=(2),MF=L
INAREA   DC    H'104,0'
         DC    CL100' '
JOBSMF   DS    0D
JOBLEN   DC    AL2(JOB05END-JOBSMF)    LENGTH FIELD
         DC    AL2(0)                  FILLER
         DC    X'0'
JOBTYPE  DC    X'5'                    TYPE OF THE RECORD
JOBENDTM DC    XL8'0'                  JOB END TIME
JOBIDMDL DC    XL4'0'                  SYSTEM-ID AND MODEL-NUMBER
JOBJOBNM DC    CL8'LUMULTC'            JOB NAME
JOBRDRTM DC    XL8'0'                  READER START TIME
JOBUSER  DS    0CL8                    USER FIELD
         DC    XL8'0'
JOBSTEP# DC    X'1'                    NUMBER OF STEPS
JOBINITM DC    XL8'0'                  INITIATION TIME
JOBINCRD DC    XL4'0'                  NUMBER OF INPUT CARDS
JOBCMPCD DC    XL2'4000'               JOB COMPLETION CODE = 0
JOBPRTY  DC    X'0'                    JOB PRIORITY
JOBRDSTP DC    XL8'0'                  READER STOP TIME
JOBTERMI DC    X'0'                    TERMINATION INDICATOR
JOBSOUT  DS    0CL5                    OUTPUT-CLASSES
         DC    X'1'                    INDICATE OUTPUT CLASS 'H'
         DC    4X'0'
JOBCKPRS DC    X'0'                    CHECK POINT RESTART INDICATOR
JOBRDRDV DC    XL2'0'                  READER DEVICE
JOBCLASS DC    C'H'                    JOB CLASS
JOBPROTK DC    X'0'                    PROTECTION KEY
         DC    XL19'0'                 RESERVED
*
JOBREST  DC    AL1(JOB05END-JOBPNAME)  LENGTH OF THE REMAINING RECORD
JOBPNAME DS    0CL20                   PROGRAMMER'S NAME
         DC    CL16'LUMULTC USED BY '
JOBSB#1  DC    CL3' '
         DC    C' '
JOBACC   DS    0CL15
JOBCPUTM DC    XL3'0'                  CPU-TIME
         DC    X'3'                    COUNT OF FOLLOWING FIELDS
         DC    X'4'
JOBARB#  DC    XL4'0'                  ARBEITSNUMMER
         DC    X'3'
JOBSB#   DC    XL3'0'                  SACHBEARBEITER NUMMER
         DC    X'1'
JOBRUN   DC    XL1'0'                  LAUFKENNZIFFER
JOB05END EQU   *
         TITLE 'STEP-TERMINATION RECORD DESCRIPTION'
STEPSMF  DS    0D
STPLEN   DC    AL2(STP04END-STEPSMF)   LENGTH FIELD
         DC    H'0'                    FILLER
STPBEGIN DC    X'0'
STPTYPE  DC    X'4'                    TYPE OF THE RECORD
STPENDTM DC    XL8'0'                  END TIME
STPIDMDL DC    XL4'0'                  SYSTEM-IDENTIFICATION & MODEL-#
STPJOBNM DC    CL8'LUMULTC'            JOB NAME
STPRDRTM DC    XL8'0'                  READER START TIME
STPUSER  DS    0CL8                    USER FIELD
STPDSKPV DC    X'0'                    NUMBER OF PRIVATE DISK UNITS
STPTAPPV DC    X'1'                    NUMBER OF TAPE UNITS
         DC    X'0'
STPJOBCL DC    C'H'                    JOBCLASS ON SMF
         DC    XL4'0'
STPNUM   DC    X'1'                    STEP NUMBER
STPINITM DC    XL8'0'                  INITIATION TIME
STPINCRD DC    XL4'0'                  NUMBER OF INPUT CARDS ON SYSIN
STPCMPCD DC    XL2'4000'               STEP COMPLETION CODE  = 0
STPPRTY  DC    X'0'                    STEP DISPATCHING PRIORITY
STPPGMNM DC    CL8'LUMULTC'            PROGRAM NAME
STPSTPNM DC    CL8'LUMULTC'            STEP NAME
*
STPRGN0  DC    AL2(30)                 REGION USED IN HIARCH 0, DEFAULT
STPRGN1  DC    AL2(0)                  REGION USED IN HIARCH 1
STPRGN0O DC    AL2(30)                 REGION OWNED
STPRGN0R DC    AL2(0)                  REGION BORROWED, ALWAYS ZERO
STPRGN1O DC    AL2(0)
STPRGN1R DC    AL2(0)
STPTCBPK DC    X'0'                    PROTECTION KEY
         DC    XL3'0'                  RESERVED
STPALOCT DC    XL4'0'                  TIME OF ALLOCATION
STPLDTIM DC    XL4'0'                  TIME OF PROGRAM FETCH
         DC    XL6'0'                  RESERVED
STPDISPL DC    AL2(STPMVS-STPBEGIN)  DISPL OF MVS SECTION
STPDEVLN DC    AL2(STPDVEND-STPDEVLN)  LENGTH FIELD OF DEVICE-ENTRIES
STPMLTIN DS    0CL8
STPINUCB DC    XL2'0'
STPINUNT DC    XL2'0'
STPINCNT DC    XL4'0'
STPMLTOU DS    0CL8
STPOUUCB DC    XL2'0'
STPOUUNT DC    XL2'0'
STPOUCNT DC    XL4'0'
STPMLTCT DS    0CL8
STPCTUCB DC    XL2'0'                  UCB-TYPE
STPCTUNT DC    XL2'0'                  UNIT ADDRESS
STPCTCNT DC    XL4'0'                  EXCP-COUNT
*
STPDVEND EQU   *
*
STPACCLN DC    AL1(STP04END-STPACC)    LENGTH OF ACCOUNTING FIELDS
STPACC   EQU   *
STPCPUTM DC    XL3'0'                  CPU TIME
         DC    X'3'                    COUNT OF FOLLOWING FIELDS
         DC    X'4'                    LENGTH
STPARB#  DC    XL4'0'                  ARBEITS-NUMMER
         DC    X'3'
STPSB#   DC    XL3'0'                  SACHBEARBEITER-NUMMER
         DC    X'1'
STPRUN#  DC    XL1'0'                  LAUFKENNZIFFER
STPMVS   DC    38X'00'        MVS RELOCATE  SECTION
*
STP04END EQU   *
SMF6     DS    0D
SMF6LEN  DC    AL2(SMF6END-SMF6),AL2(0)
         DC    X'02'
         DC    X'06'          TYPE
SMF6COMM DC    3XL4'0'        TIME STAMP AND SID
         DC    CL8'LUMULTC'   JOBNAME
SMF6RST  DC    XL8'0'         READER START TIM
         DC    XL8'0'
SMF6OWC  DC    C'O'
SMF6WST  DC    XL8'0'
SMF6NLR  DC    XL4'0'
         DC    X'0'
         DC    X'1'           DATASETS
SMF6FMN  DC    CL4'????'      FORM NUMMER
         DC    X'0'
         DC    X'0001'        SUB-SYSTEM
         DC    AL2(SMF6END-*) REST OF RECORD
         DC    XL2'0'
         DC    CL4'MULT'
SMF6OUT  DC    CL8' '
SMF6FCB  DC    CL4' '
SMF6UCS  DC    CL4' '
SMF6PGE  DC    XL4'0'         PAGE-COUNT
         DC    XL2'0'
SMF6END  EQU   *
         DS    0D
SVCREPLY DS    0F            WITH THIS REPLY LUMULT ANSWERS ITSELF
         DC    AL2(REPEND-SVCREPLY)
         DC    H'0'
         DC    C' R '
MSGNUM   DC    C'ZZ'         MSG-NUMBER FOUND IN REPLY QUEUE
         DC    X'6B'
NEWORFF  DC    CL3'...'
         DC    C' '          FILLER
REPEND   EQU   *
MSGWORK  DC    CL16' '
FIL      DC    32A(0)        FILLERS FOR COMMAND SVC  (SVC  34)
         DS    0D
         SYSDATE
./ ADD  NAME=NCCFINIT
         MACRO
&LABEL   NCCFINIT &INIT=CMD
*
* THIS MACRO IS USED TO INITIALISE EITHER:
*         AN NCCF COMMAND PROCESSOR(DEFAULT, OR
*         AN NCCF USER EXIT.
*
* IT ORGANISES:
*         A BASE REGISTER (R10),
*         SAVING OF THE REGISTERS,
*         ADRESSING FOR THE MAIN VECTOR TABLE AND
*         THE MOST USED NCCF CONTROL BLOCK DSECTS
*
* SPECIFY:
*
*    INIT= 'EXIT' FOR USER EXIT
*          'CMD' FOR A COMMAND PROCESSOR (DEFAULT)
*
* THE FOLLOWING REGISTERS ARE SET UP BY THE MACRO:
*
*     SAVEAREA ADDRESS.......................13
*     BASE REGISTER..........................10
*     MAIN VECTOR TABLE REGISTER(MVT)........ 9
*     TASK VCTOR BLOCK(TVB).................. 8
*
*   FOR A COMMAND PROCESSOR ONLY:
*     TASK INFORMATION BLOCK(TIB)............12
*     COMMAND WORK BLOCK REGISTER(CWB).......11
*
*   FOR AN EXIT ROUTINE ONLY:
*     USER EXIT PARAMETER LIST(USE)..........12
*     SERVICE ROUTINE WORK BLOCK REG.(SWB)...11
*
* OTHER REGISTERS USED ARE:
*     INPUT:  R1  MASTER DATA START ADDRESS
*             R13 SAVEAREA ADDRESS
*             R14 RETURN ADDRESS
*             R15 ENTRY ADDRESS
*
*     OUTPUT: R15 RETURN CODE
*             OTHERS SAME AS INPUT
*
*
* REGISTERS 0,1,14,15 USE BY MACRO EXPANSION, SO SHOULD NOT BE
* USED IN EXIT/CP.
*
         AIF  ('&LABEL' NE '').START
         MNOTE 4,'NO CSECT NAME SPECIFIED'
         MEXIT
.START   ANOP
&LABEL   CSECT
         PRINT OFF
         DSICBS DSICWB,DSIMVT,DSIPDB,DSISVL,DSISWB,DSITIB,DSITVB
         AIF   ('&INIT' EQ 'CMD').BYPASS
         DSICBS DSIUSE                   NEEDED FOR EXITS ONLY
.BYPASS  ANOP
         PRINT ON
         STM   14,12,12(13)              SAVE REGISTERS
         LR    10,15                     SET BASE REGISTER
         USING &LABEL,10
         AIF   ('&INIT' EQ 'EXIT').EXIT EXIT ROUTINE
*********************************
* COMMAND PROCESSOR             *
*********************************
* SET UP MVT ADDRESSABILITY FOR COMMAND, AND USE SAVE AREA
         LR  11,1                     LOAD REGISTER 11 WITH CWB ADDRESS
         USING DSICWB,11              R11 ADDRESSES DSICWB
         LA  2,CWBSAVEA               GET ADDRESS OF SAVEAREA
         ST  2,8(13)
         ST  13,4(2)
         LR  13,2                     R13 CONTAINE SAVE AREA ADDRESS
         L   12,CWBTIB
         USING DSITIB,12              R12 ADDRESSES DSITIB
         L   8,TIBTVB
         USING DSITVB,8               R8  ADDRESSES DSITVB
         L   9,TVBMVT
         USING DSIMVT,9               R9  ADDRESSES DSIMVT
         MEXIT
.EXIT    ANOP
********************************
* EXIT                         *
********************************
* SET UP MVT ADDRESSIBILITY FOR EXIT, AND USE SAVEAREA
         LR   12,1                   LOAD REGISTER 12 WITH USE ADDRESS
         USING DSIUSE,12             R12 ADDRESSES DSIUSE
         L    11,USERSWB             USE R11 TO ADDRESS SWB
         USING DSISWB,11
         LA   2,SWBSAVEA             GET ADDRESS OF SAVEREA
         ST   2,8(13)
         ST   13,4(2)
         LR   13,2                   R13 CONTAINS SAVE AREA ADDRESS
         L    8,USERTVB
         USING DSITVB,8              R8  ADDRESSES TVB
         L    9,TVBMVT
         USING DSIMVT,9              R9  ADRESSES MVT
         MEND
./ ADD  NAME=OCR
         MACRO
&NM      OCR   &LEN=0,&EXIT=,&STK1=1,&STK3=3,&TRANS=YES
         LCLA  &LOUT,&BOUT,&MBLK
         LCLA  &LENX,&PAGES
         LCLC  &NAME
*
*       AUTHOR OF STANDARD PROGRAM
*       H. FRANZ       1975
*       BASF AG  FLD/OS        TEL. 6390
*       UPDATE 28.09.1978 VON R.TRASCH
*  LAST UPDATE 25.06.1979 VON H. FRANZ
*
&LENX    SETA  &LEN
         AIF   (T'&NM EQ 'O').NONAME
&NAME    SETC  '&NM'
         AGO   .CHKSTK
.NONAME  ANOP
         MNOTE 12,'ASSIGN A NAME TO THE PROGRAM'
         MEXIT
.INVSTK  ANOP
         MNOTE 12,'STACKER SELECTION MUST BE 1 OR 3'
         MEXIT
.CHKSTK  ANOP
         AIF ('&STK1' NE '1' AND '&STK1' NE '3').INVSTK
         AIF ('&STK3' NE '1' AND '&STK3' NE '3').INVSTK
.CSECT   ANOP
         AIF   ('&LEN' NE '0').LENWAS
         MNOTE 12,'LENGTH OF INPUT AREA MUST BE SPECIFIED BY LEN=NNN'
         MEXIT
.LENWAS  ANOP
&LOUT    SETA  &LEN+1
&PAGES   SETA  (&LOUT/4096)+1
.ADDLRL  ANOP
&BOUT    SETA  &BOUT+&LOUT
         AIF   (&BOUT GE 4096).OKGEN1
&MBLK    SETA  &MBLK+1
         AIF   (&MBLK LT 11).ADDLRL
.OKGEN1  ANOP
         AIF   (&MBLK EQ 0).OKGEN
&BOUT    SETA  &BOUT-&LOUT
.OKGEN   ANOP
         PUNCH '     ORDER  &NAME.(P)'
         DCBD  DEVD=(OR,TA),DSORG=PS
         TITLE 'BASF STANDARD BELEG-LESEPROGRAMM'
&NAME    CSECT
*
*              AUTHOR : H. FRANZ
*
*        REG
         REG
*        XSAVE (R12,R11,R10,R9),OCRSVA,&NAME
         XSAVE (R12,R11,R10,R9),OCRSVA,&NAME
*
         SR    R7,R7
.ASKLEN  ANOP
         AIF   (&LENX GE 4096).GETLEN
         LA    R7,&LENX.(R7)
         AGO   .AGETLEN
.GETLEN  ANOP
         LA    R7,4095(R7)
&LENX    SETA  &LENX-4095
         AGO   .ASKLEN
.AGETLEN ANOP
         LR        R8,R7     GET LENGTH
         BCTR      R8,0      READY FOR CLEAR MOVE
         ST    R7,DOCLENM     SAVE LENGTH OF DOCUMENT
         ST    R8,DOCLENC     SAVE LENGTH OF DOCUMENT - 1
*
*        OPEN  (OCR,(INPUT),TAPE,(OUTPUT),MESSAG,(OUTPUT))
         OPEN  (OCR,(INPUT),TAPE,(OUTPUT),MESSAG,(OUTPUT))
TESTDCBS EQU   *
         TM    OCR+DCBOFLGS-IHADCB,ISOPEN IS OCR DD-CARD SPECIFIED ?
         BZ    RET12         NO, RETURN WITH CODE 12
         TM    TAPE+DCBOFLGS-IHADCB,ISOPEN IS TAPE-DD-CARD SPECIFIED ?
         BZ    RET12         IF NOT, RETURN WITH CODE 12
         LA    R0,176        LENGTH OF A JFCB
*        GETMAIN R,LV=(0)    GET CORE FOR A BUFFER
         GETMAIN R,LV=(0)    GET CORE FOR A BUFFER
         ST    R1,CHKBUF     SAVE THE ADDRESS
         ST    R1,JFCBEXIT   AND SET UP A DCB-JFCB-EXIT
         MVI   JFCBEXIT,X'87'  INDICATE JFCB EXIT
         XC    0(176,R1),0(R1) CLEAR THE BUFFER
         LR    R4,R1         SET REG 4 TO IT
*        OPEN  (CHECKP,(UPDATE))  OPEN THE CHECKPOINT DCB
         OPEN  (CHECKP,(UPDATE))  OPEN THE CHECKPOINT DCB
         TM    CHECKP+DCBOFLGS-IHADCB,ISOPEN  WAS A DD-CARD ?
         BZ    NOCHECKP      NO, DON'T TRY TO WRITE UPON
         LA    R3,21         SET MAXIMUM BLOCKCOUNT
         LA    R2,1          SET BLOCK POINTER TO 1
CLEARCHK EQU   *
         ST    R2,CHKCNT     SET THE BLOCKCOUNT
*        WRITE CHKDECB,DI,,(R4),,,,MF=E CLEAR THE CHECKPOINT DATA SET
         WRITE CHKDECB,DI,,(R4),,,,MF=E CLEAR THE CHECKPOINT DATA SET
         LA    R2,1(R2)      ADD ONE TO BLOCKCOUNT
*        CHECK CHKDECB       IS I/O COMPLETE ?
         CHECK CHKDECB       IS I/O COMPLETE ?
         CR    R2,R3         ARE ALL BLOCKS CLEARED ?
         BL    CLEARCHK      NO, GO ON CLEARING
*        TIOTSCAN TAPDCB     LOOK FOR TAPE DD-CARD
         TIOTSCAN TAPDCB     LOOK FOR TAPE DD-CARD
         LTR   R15,R15       DOES DD-CARD FOR TAPE EXIST ?
         BZ    NOCHECKP      NO RETURN WITH CODE 12
         SR    R14,R14       CLEAR REG 14
         LH    R14,18(R15)   GET UCB ADDRESS
         LTR   R14,R14       DOES UCB EXIST ?
         BZ    NOCHECKP      NO
         MVC   SAVEUCB(6),28(R14)   MOVE VOLSER# FROM UCB
         MVC   SAVEUCB+6(4),16(R14) MOVE DEVICE TYPE FROM UCB
NOCHECKP EQU   *
         MVI   IN,C' '      INIT CLEAR MOVE
         L     R7,DOCLENC          GET LENGTH FOR CLEAR
*        MOVE  IN+1,(R7),IN CLEAR THE INPUT AREA WITH BLANKS
         MOVE  IN+1,(R7),IN CLEAR THE INPUT AREA WITH BLANKS
*        RDJFCB TAPE         READ IN THE JOB FILE CONTROL BLOCK
         RDJFCB TAPE         READ IN THE JOB FILE CONTROL BLOCK
*        READ  DECB,SF,OCR,CCW         READ FIRST DOCUMENT
         READ  DECB,SF,OCR,CCW         READ FIRST DOCUMENT
         TM    CHECKP+DCBOFLGS-IHADCB,ISOPEN IS THE CHECKPOINT DCB OPEN
         BNO   READROUT                      NO
         LA    R1,20         SET BLOCK NUMBER TO 20
         ST    R1,CHKCNT     STORE TO BLOCKCOUNT ON CHECKPOINT DCB
         L     R4,CHKBUF      GET ADDRESS OF CHECKPOINT BUFFER
*        WRITE CHKDECB,DI,CHECKP,(R4),'S',0,CHKCNT+1,MF=E
         WRITE CHKDECB,DI,CHECKP,(R4),'S',0,CHKCNT+1,MF=E
*        CHECK CHKDECB
         CHECK CHKDECB
         LA    R1,21         SET BLOCK NUMBER TO 21
         ST    R1,CHKCNT     STORE TO BLOCK COUNT ON CHECKPOINT DCB
         L     R4,CHKBUF     GET ADDRESS OF CHECKPOINT BUFFER
         MVC   0(10,R4),SAVEUCB
         XC    10(166,R4),10(R4)  CLEAR REST OF BUFFER
         B     WRITECHK
READROUT EQU   *
         MVI   OUT,BLANK     SET INDICATOR BYTE TO 'NO ERROR' CONDITION
         LA    R1,1          PUT 1 INTO REG
         A     R1,INCOUNT    ADD PREVIOUS COUNT
         ST    R1,INCOUNT    AND STORE UPDATED COUNT
*        CHECK DECB          CHECK INPUT COMPLETE
         CHECK DECB          CHECK INPUT COMPLETE
         AIF   ('&EXIT' EQ '').NOEXIT
         BAL   R6,&EXIT       LINK TO USER'S ROUTINE
.NOEXIT  ANOP
DOCPROC  EQU   *             DOCUMENT IS NOW PROCESSED
         AIF   ('&TRANS' EQ 'NO').NOTRL
         L     R7,DOCLENM     GET CORRECT DOCUMENT LENGTH
         LA    R8,IN          POINT TO AREA TO BE TESTED (INPUT AREA)
CHARCHK  EQU       *         CHECK THE CHARS FOR PLAUSIBILITY
*        TRTL  (R8),(R7),TAB CHECK THE CHARATCTERS
         TRTL  (R8),(R7),TAB CHECK THE CHARATCTERS
         BZ    CHARCKE       ALL CHARACTERS VALID
         B     *(R2)         R2 CONTAINS 4 FOR X'00' OR 8 FOR INVALID
         B     CHNG00         CHARACTER WAS X'00'
         B     INVCH          INVALID CHARACTER
CHNG00   EQU   *
         MVI   0(R1),C' '     CHANGE X'00' TO BLANK
         LA    R2,1(R1)       POINT OVER CHAR
         LA    R14,IN         START OF DOCUMENT
         A     R14,DOCLENM    END OF DOCUMENT
         SR    R14,R2         RESTLENGTH OF DOCUMENT
         BNP   CHARCKE        IF NO REST, TERMINATE TEST
         LR    R8,R2          NEW START OF TEST
         LR    R7,R14         REST LENGTH FOR TEST
         B     CHARCHK        AND GO TO CHECK AGAIN
INVCH    EQU   *
         MVI   0(R1),C'@'     SET THE REJECT CHARACTER
         OI    OCRSW,INVCHAR  FLAG THE RECORD AS 'IN ERROR'
         LA    R2,1(R1)       POINT OVER CHAR
         LA    R14,IN         START OF DOCUMENT
         A     R14,DOCLENM    END OF DOCUMENT
         SR    R14,R2         RESTLENGTH OF DOCUMENT
         BNP   CHARCKE        IF NO REST, TERMINATE TEST
         LR    R8,R2          NEW START OF TEST
         LR    R7,R14         REST LENGTH FOR TEST
         B     CHARCHK        AND GO TO CHECK AGAIN
CHARCKE  EQU   *
         TM    OCRSW,INVCHAR  WAS AN INVALID CHARACTER ?
         BZ    CHARCKEE       NO,TRANSLATE ROUTINE FINISHED
         NI    OCRSW,255-INVCHAR CLEAR THE SWITCH BIT
         LA    R1,1           PUT 1 INTO COUNT REG
         A     R1,INVCHCNT    ADD PREVIOUS COUNT OF INV-CHAR DOCS
         ST    R1,INVCHCNT    AND RESTORE THE COUNT
         MVI   OUT,C'@'       FLAG THE OUTPUT RECORD
         B     REJECT2        AND GO TO REJECT THE DOCUMENT
CHARCKEE EQU   *              TOTAL END OF CHARACTER CHECK ROUTINE
.NOTRL   ANOP
         TM    OCRSW,ERRWAS  WAS AN ERROR WITHIN THIS DOCUMENT ?
         BZ    DOCUMOK       NO,GO TO EJECT
REJECT   EQU   *             IF YES, DOCUMENT MUST BE REJECTED
         MVI   OUT,STERN     FLAG RECORD ON TAPE
REJECT2  EQU   *
         NI    OCRSW,255-ERRWAS CLEAR ERROR SWITCH
         LA    R1,1          PUT 1 INTO COUNT REG
         A     R1,INPCNTWR   ADD NUMBER OF FAULTY DOCUMENTS
         ST    R1,INPCNTWR   STORE UPDATED COUNT
*        CNTRL OCR,ESD,&STK3     PUT DOCUMENT TO STACKER FOR ERRORS
         CNTRL OCR,ESD,&STK3     PUT DOCUMENT TO STACKER FOR ERRORS
         B     MOVTOOUT      GO TO MOVE THE RECORD
DOCUMOK  EQU   *             DOCUMENT IS WITHOUT ERRORS
         LA    R1,1          PUT 1 INTO REG
         A     R1,INPCNTOK   ADD COUNT OF DOCUMENTS WITHOUT ERRORS
         ST    R1,INPCNTOK   RESTORE UPDATED COUNT
*
*        CNTRL OCR,ESD,&STK1     EJECT DOCUMENT INTO NORMAL STACKER
         CNTRL OCR,ESD,&STK1     EJECT DOCUMENT INTO NORMAL STACKER
MOVTOOUT EQU   *             RECORD IS MOVED FROM INPUT AREA TO OUTPUT
         AIF   (&LEN GT 256).LONGMV
         MVC   OUT+1(&LEN),IN MOVE DATA FROM INPUT TO OUTPUT RECORD
         AGO   .SRTMOV
.LONGMV  ANOP
         L     R7,DOCLENM
*        MOVE  OUT+1,(R7),IN MOVE DATA FROM INPUT TO OUTPUT RECORD
         MOVE  OUT+1,(R7),IN MOVE DATA FROM INPUT TO OUTPUT RECORD
.SRTMOV  ANOP
         MVI   IN,C' '   INIT CLEAR MOVE
         L     R7,DOCLENC
*        MOVE  IN+1,(R7),IN CLEAR INPUT AREA WITH BLANKS
         MOVE  IN+1,(R7),IN CLEAR INPUT AREA WITH BLANKS
*        READ  DECB,SF,,MF=E START NEXT READ OPERATION
         READ  DECB,SF,,MF=E
*        PUT   TAPE,OUT      PUT THE OUTPUT AREA TO TAPE
         PUT   TAPE,OUT      PUT THE OUTPUT AREA TO TAPE
         LA    R1,1          PUT 1 INTO REG
         A     R1,OUTCNT     ADD PREVIOUS OUTPUT COUNT
         ST    R1,OUTCNT     RESTORE UPDATED COUNT
         CVD   R1,ASTOUT     IS RECORD COUNT A MULTIPLE OF 10
         TM    ASTOUT+7,X'F0' IF YES, ZONE BITS MUST BE OUT
         BNZ   READROUT      NO, GO TO READ ON
         TM    CHECKP+DCBOFLGS-IHADCB,ISOPEN IS CHECKPOINT DCB OPEN ?
         BZ    READROUT      NO, GO TO READ ON
         CHECK CHKDECB       WAIT FOR COMPLETION OF PREVIOUS WRITE
*        CHECK CHKDECB       WAIT FOR COMPLETION OF PREVIOUS WRITE
         L     R1,CHKCNT     GET LAST BLOCKCOUNT
         LA    R1,1(R1)      ADD ONE
         ST    R1,CHKCNT     AND STORE NEW COUNT BACK
         C     R1,CHKLIM     IS UPPER LIMIT REACHED ?
         BL    CHKWRITE      NO, GO TO WRITE
         LA    R0,1          BEGIN WITH BLOCK NUMBER 1
         ST    R0,CHKCNT      STORE IT TO BLOCKCOUNT
CHKWRITE EQU   *
         L     R4,CHKBUF     GET ADDRESS OF THE BUFFER FOR CHECKPOINT
         MVC   0(24,R4),INCOUNT        MOVE THE COUNTER S TO WORK AREA
         MVC   24(152,R4),OUT          AND BEGIN OF OUTPUT AREA
WRITECHK EQU   *
*        WRITE CHKDECB,DI,CHECKP,(R4),'S',0,CHKCNT+1    WRITE THE BLOCK
         WRITE CHKDECB,DI,CHECKP,(R4),'S',0,CHKCNT+1
         B     READROUT      AND GO TO CHECK INPUT COMPLETE
EOFIN    EQU   *
         BAL   R5,CLOSE      CLOSE ALL DATASETS
         LM    R0,R5,INCOUNT GET ALL COUNTERS INTO REGS
         BCTR  R0,0          SUBTRACT ONE FROM INPUT COUNT (EODAD)
         CVD   R0,ASTINCT    CONVERT THE COUNTS FOR SUBROUTINE RZASTBL
         LTR   R0,R0         TEST THE COUNT
         BNP   NOAST         DON'T CALL AST FOR NOTHING
         CVD   R1,ASTOKCT
         CVD   R2,ASTWRCT
         CVD   R3,ASTOUT
         CVD   R4,ASTREF
         CVD   R5,ASTNONR
         LR    R3,R2         NUMBER OF REJECTED DOCUMENTS
         SR    R2,R2         CLEAR REG
         MH    R3,H10000     * 100 + 2 DECIMALS
         DR    R2,R0         / BY TOTAL = PERCENTAGE
         CVD   R3,ASTPROZ    OF REJECTED OUT OF TOTAL
         L     R1,INVCHCNT    GET THE COUNT OF INV-CHAR DOCS
         CVD   R1,ASTINVCH    AND CONVERT IT FOR 'COBAST'
*        CALL  COBAST,(DW,&NM+5,ASTINCT),VL
         CALL  COBAST,(DW,&NM+5,ASTINCT),VL
         LH    R15,DW        GET RETURN CODE OF COBAST
NOAST    EQU   *
RETURN   EQU   *
*        XRETURN (R15)       TERMINATE THIS RUN
         XRETURN (R15)       TERMINATE THIS RUN
RET12    EQU   *
         BAL   R5,CLOSE      CLOSE ALL OPEN DCBS
         LA    R15,12        SET RETURN CODE 12
         B     RETURN        AND TERMINATE
*
CLOSE    EQU   *
*        CLOSE (OCR,,TAPE,,MESSAG,,CHECKP)
         CLOSE (OCR,,TAPE,,MESSAG,,CHECKP)
         BR    R5
*
ERRANAL  EQU   *
         STM   R0,R15,SYNADSAV  SAVE ALL REGISTERS
         LA    R13,SECNDSAV   POINT TO OWN SAVEAREA
         TM    OCR+DCBEIB-IHADCB,DCBORNRM
         BO    NOREFMRK      NO REFERENCE MARK FOUND
         TM    OCR+DCBEIB-IHADCB,DCBORDCK+DCBORECK+DCBORWLR
         BNZ   NOTREAD       DATACHECK EQUIP-CHECK OR WRONG REC LENGTH
         TM    OCR+DCBEIB-IHADCB,DCBORERR
         BO    NONRECOV      NON RECOVERY ERROR
         TM    OCR+DCBEIB-IHADCB,DCBORHPR
         BO    EMPTYHOP      HOPPER IS EMPTY
         TM    OCR+DCBEIB-IHADCB,DCBORREJ
         BO    ENDOFPAG       END OF PAGE IS REACHED
         CLI   OCR+DCBEIB+1-IHADCB,0   IS RETURN CODE FROM CHECK = 0 ?
         BNE   NONRECOV      GO TO REJECT DOCUMENT
*        ABEND 128,DUMP      NON OF ABOVE TAKE A DUMP
         ABEND 128,DUMP      NON OF ABOVE TAKE A DUMP
ASKOPER  EQU   *
         SR    R0,R0          CLEAR REG
         ST    R0,OCRECB      AND ECB
*        WTOR  'OCR101 10-MAL NO REFMARK, REPLY ''GO'' ODER ''ENDE''',
*              OCRREPLY,4,OCRECB,ROUTCDE=(7,11,15)
         WTOR  'OCR101 10-MAL NO REFMARK, REPLY ''GO'' ODER ''ENDE''', *
               OCRREPLY,4,OCRECB,ROUTCDE=(7,11,15)
         L         R1,NOREFLIM         GET MAX COUNT
         LA        R1,10(R1) ADD ANOTHER TEN
         ST        R1,NOREFLIM         AND STORE IT BACK
*        WAIT  1,ECB=OCRECB   WAIT FOR OPERATOR'S ANSWER
         WAIT  1,ECB=OCRECB
         CLI   OCRREPLY,C'G'  IS REPLY GO
         BE    SYNADRET       IF YES, GO ON
         CLI   OCRREPLY,C'E'  IS REPLY ENDE ?
         BNE   ASKOPER        IF NOT, ASK AGAIN
         LA    R15,EOFIN      POINT TO EODAD ROUTINE
         B     SYNADOUT       AND LEAVE SYNAD ROUTINE
SYNADRET EQU   *
         LM    R0,R15,SYNADSAV RELOAD REGS AS AT ENTRY
         SR    R15,R15       CLEAR REG
         BR    R14           AND RETURN TO DATA MANAGEMENT
SYNADSAV DC    16F'0'        SAVE AREA USED IN SYNAD ROUTINE
SECNDSAV DC    18F'0'        SAVE AREA DURING SYNAD PROCESSING
NOREFMRK EQU   *
         OI    OCRSW,ERRWAS  INDICATE ANERROR
         L     R1,INCOUNT    GET CURRENT DOCUMENT NUMBER
         CVD   R1,DW         CONVERT THE COUNT
         OI    DW+7,X'0F'     FORCE SIGN TO BE PRINTABLE
         LA    R1,2          GET MESSAGE ID
         UNPK  MSG2CNT,DW+5(3) COMPLETE THE MESSAGE
         BAL   R5,PUTMESSG   GO TO PUT THE MESSAGE
         L     R1,NOREFCNT   GET NUMBER OF THIS ERROR
         LA    R1,1(R1)      ADD ONE
         ST    R1,NOREFCNT   RESTORE UPDATED COUNT
         C     R1,NOREFLIM   IS LIMIT REACHED ?
         BH    ASKOPER        ASK THE OPERATOR TO CONTINUE
         LA    R15,REJECT    REJECT THIS DOCUMENT
SYNADOUT EQU   *             LEAVE SYNAD PROCESSING AND GO TO ROUTINE
*                            POINTED TO BY REG 15
         LM    R0,R14,SYNADSAV GET ALL REGS BUT NOT 15 AS AT ENTRY
         BR    R14           RETURN TO DATA MANAGEMENT
NOTREAD  EQU   *
         OI    OCRSW,ERRWAS  INDICATE ERROR IN THIS DOCUMENT
         L     R1,OCR+DCBIOBA-IHADCB   GET ADDRESS OF IOB
         L     R1,16(R1)     ADDRESS OF FAILING CCW + 8
         SH    R1,CCWLEN     RU POINTS NOW TO FAILING CCW
         CLI   0(R1),SERREFMK IS COMMAND A LOAD FORMAT ?
         BE    NONRECOV      IF YES, RECOVERY NOT POSSIBLE
         L     R2,0(R1)      GET ADDRESS OF FAULTY DATA
         TM    0(R1),COMPLBW IS COMMAND A READ BACKWARD ?
         BZ    MAYBEBCK      IF ZERO IT MAY BE
         TM    0(R1),COMPLFW IS COMMAND A READ FORWARD ?
         BZ    ADDFIELD      IF ZERO IT IS READ FORWARD
         B     NONRECOV      NO READ COMMAND ==> REJECT DOCUMENT
MAYBEBCK EQU   *
         TM    0(R1),BACKCMD IS COMMAND A READ BACKWARD ?
         BNO   NONRECOV      NO, REJECT DOCUMENT
         MVI   1(R2),STERN   FLAG THE FIELD
         B     SYNADRET      RETURN FROM SYNAD TO DATA MANAGEMENT
ADDFIELD EQU   *
         LA    R2,0(R2)      CLEAR COMMAND IN REG BYTE 1
         AH    R2,6(R1)      ADD FIELD LENGTH
         MVI   0(R2),STERN   FLAG THE FIELD
         B     SYNADRET      AND RETURN TO DATAMANAGEMENT (ACCEPT)
NONRECOV EQU   *
         OI    OCRSW,ERRWAS  INDICATE ERROR WITH THIS DOCUMENT
         L     R1,INCOUNT    GET NUMBER OF DOCUMENTS
         CVD   R1,DW         CONVERT THE COUNT
         OI    DW+7,X'0F'     FORCE SIGN TO BE PRINTABLE
         UNPK  MSG3CNT,DW+5(3) COMPLETE THE MESSAGE
         LA    R1,3          SET MESSAGE ID
         BAL   R5,PUTMESSG   GO TO MESSAGE PROCESSING ROUTINE
         LA    R1,1          PUT 1 INTO COUNT REG
         A     R1,NONRECCT   ADD COUNT OF NONRECOVERY ERRORS
         ST    R1,NONRECCT   AND RESTORE UPDATED COUNT
         LA    R15,REJECT
         B     SYNADOUT      LEAVE THE SYNAD TO REJECT DOCUMENT
EMPTYHOP EQU   *
         SR    R0,R0         CLEAR REG
         ST    R0,OCRECB     AND ECB
*        WTOR  'OCR100 HOPPER-EMPTY, REPLY ''GO'' ODER ''ENDE''',
*        OCRREPLY,4,OCRECB,ROUTCDE=(7,11,15)
         WTOR  'OCR100 HOPPER-EMPTY, REPLY ''GO'' ODER ''ENDE''',      *
               OCRREPLY,4,OCRECB,ROUTCDE=(7,11,15)
         WAIT  1,ECB=OCRECB  WAIT FOR REPLY FROM OPERATOR
         CLI   OCRREPLY,C'G' WAS REPLY = GO ?
         BE    SYNADRET      YES, GO ON
         CLI   OCRREPLY,C'E' WAS REPLY = ENDE ?
         BNE   EMPTYHOP      MUST BE ERROR REPEAT WTOR
         LA    R15,EOFIN     LOAD ADDRESS OF ENDROUTINE
         B     SYNADOUT      LEAVE SYNAD ROUTINE
ENDOFPAG EQU   *
         LA    R15,DOCPROC    ASSUME DOCUMENT PROCESSED
         B     SYNADOUT       LEAVE SYNAD
*
*
CCWLEN   DC    H'8'          LENGTH OF A CHANNEL COMMAND WORD
H10000   DC    H'10000'
PUTMESSG EQU   *             THIS IS THE MESSAGE PRINT ROUTINE
         MVC   MSGMSG,MSGMSG-1 CLEAR THE MESSAGE LINE
         CVD   R1,DW         CONVERT THE ID
         OI    DW+7,X'0F'     FORCE SIGN TO BE PRINTABLE
         UNPK  MSGNBR,DW+5(3) SET ID INTO MESSAGE
         SLL   R1,1          * 2 (FOR HALFWORDS)
         LH    R2,MSGLENGS-2(R1) SET LENGTH REG FOR EXECUTE
         SLL   R1,1          * 4 OF ORIGINAL (FOR FULLWORDS)
         L     R3,MSGADDRS-4(R1) GET ADDRESS OF THE MESSAGE
         EX    R2,MSGMOVE    MOVE THE MESSAGE TO LINE
         TM    MESSAG+DCBOFLGS-IHADCB,ISOPEN IS DCB OPEN ?
         BZ    WTOMSG        NO, WRITE TO OPERATOR AND JCL
*        PUT   MESSAG,MSGLINE PUT THE MESSAGE
         PUT   MESSAG,MSGLINE PUT THE MESSAGE
         BR    R5            AND RETURN
WTOMSG   EQU   *
         MVC   MSGWTO+4(80),MSGID      MOVE MESSAGE TO WTO LIST
         LA    R1,MSGWTO     SET PARM REG TO WTO LIST
*        WTO   MF=(E,(1))    ISSUE WTO
         WTO   MF=(E,(1))    ISSUE WTO
         BR    R5            AND RETURN
MESSAGES DS    0D
MSG1     DC    C'DUMMY-MSG'
MSG1E    EQU   *
MSG2     DC    C'NO REFERENCE MARK FOUND ON DOCUMENT # '
MSG2CNT  DC    CL5' '
MSG2E    EQU   *
MSG3     DC    C'NONRECOVERY ERROR WITH DOCUMENT # '
MSG3CNT  DC    CL5' '
MSG3E    EQU   *
MSGLENGS DS    0D            DEFINITION OF MESSAGE LENGTHS
         DC    AL2(MSG1E-MSG1-1)       LENGTH OF MESSAGE1
         DC    AL2(MSG2E-MSG2-1)       LENGTH OF MESSAGE2
         DC    AL2(MSG3E-MSG3-1)       LENGTH OF MESSAGE3
MSGADDRS DS    0D            DEFINITION OF MESSAGE ADDRESSES
         DC    A(MSG1)       ADDRESS OF MESSAGE 1
         DC    A(MSG2)       ADDRESS OF MESSAGE 2
         DC    A(MSG3)       ADDRESS OF MESSAGE 3
MSGMOVE  MVC   MSGMSG(0),0(R3) MOVE THE MESSAGE TO LINE
MSGWTO   WTO   '                                                       *
                                        ',ROUTCDE=(7,11),MF=L
MSGLINE  DS    0CL133
         DC    C' '           SPACE FOR CARRIAGE CONTROL CHARACTER
MSGID    DC    CL3'OCR'      MESSAGE IDENTIFICATION
MSGNBR   DC    CL3' '        MESSAGE NUMBER IS HERE INSERTED
         DC    CL2' '
MSGMSG   DC    CL100' '      SPACE FOR MESSAGE
         DC    CL25' '
OCRECB   DC    F'0'          ECB FOR WTOR
OCRREPLY DC    CL4' '        REPLY AREA FOR OPERATOR'S ANSWER TO WTOR
*
*              COUNTERS
*
INCOUNT  DC    F'0'          COUNT OF DOCUMENTS READ
INPCNTOK DC    F'0'          COUNT OF DOCUMENTS WITHOUT ANY READ ERROR
INPCNTWR DC    F'0'          COUNT FOR DOCUMENTS WITH READ ERRORS
OUTCNT   DC    F'0'          COUNT FOR DOCUMENTS WRITTEN TO TAPE
NOREFCNT DC    F'0'          COUNT FOR DOCUMENT WITH NO REF-MARK FOUND
NONRECCT DC    F'0'          COUNT FOR NONRECOVERY ERRORS
INVCHCNT DC    F'0'          COUNT FOR DOCUMENTS WITH INVALID CHARS
NOREFLIM DC    F'10'         LIMIT FOR THIS CONDITION
DW       DC    D'0'          WORK FIELD FOR CONVERSION
ASTINCT  DC    D'0'          TOTAL DOCUMENT COUNT FOR COBAST
ASTOKCT  DC    D'0'          COUNT OF GOOD DOCUMENTS
ASTWRCT  DC    D'0'          COUNT OF REJECTED DOCUMENTS
ASTOUT   DC    D'0'          COUNT OF RECORDS ON TAPE
ASTREF   DC    D'0'          COUNT OF NO REFERENCE MARK CONDITIONS
ASTNONR  DC    D'0'          COUNT OF NONRECOVERY ERRORS
ASTPROZ  DC    D'0'          PERCENTAGE OF REJECTS OUT OF TOTAL
ASTINVCH DC    D'0'          COUNT FOR DOCUMENTS WITH INV. CHARS
*
*              ERROR COUNTS (COUNTED BY DATA MANAGEMENT ROUTINES)
*
ERRORS   DS    0F
         DC    8F'0'
*
*
*              DATA CONTROL BLOCKS
*
*MESSAG  DCB   DDNAME=SYSPRINT,DSORG=PS,
*              MACRF=PM,
*              RECFM=FBA,
*              LRECL=133,
*              BLKSIZE=665
MESSAG   DCB   DDNAME=SYSPRINT,DSORG=PS,                               *
               MACRF=PM,                                               *
               RECFM=FBA,                                              *
               LRECL=133,                                              *
               BLKSIZE=665
*
*OCR     DCB   DDNAME=OCR,DSORG=PS,
*              DEVD=OR,
*              ERRCNT=ERRORS,
*              MACRF=(RC),
*              OPTCD=H,
*              RECFM=U,
*              SYNAD=ERRANAL,
*              EODAD=EOFIN
OCR      DCB   DDNAME=OCR,DSORG=PS,                                    *
               DEVD=OR,                                                *
               ERRCNT=ERRORS,                                          *
               MACRF=(RC),                                             *
               OPTCD=H,                                                *
               RECFM=U,                                                *
               SYNAD=ERRANAL,                                          *
               EODAD=EOFIN
*
*TAPE    DCB   DDNAME=TAPE,DSORG=PS,
*              MACRF=PM,
*              RECFM=FB,
*              EXLST=JFCBEXIT,
*              LRECL=&LOUT,          IS EQUAL LEN + 1
*              BLKSIZE=&BOUT         IS COMPUTED BY MACRO
TAPE     DCB   DDNAME=TAPE,DSORG=PS,                                   *
               MACRF=PM,                                               *
               RECFM=FB,                                               *
               EXLST=JFCBEXIT,                                         *
               LRECL=&LOUT,                                            *
               BLKSIZE=&BOUT
*CHECKP  DCB   DDNAME=CHECKPT,DSORG=DA,
*              MACRF=(WIC),
*              BLKSIZE=176,
*              RECFM=F,
*              OPTCD=WR
CHECKP   DCB   DDNAME=CHECKPT,DSORG=DA,                                *
               MACRF=(WIC),                                            *
               BLKSIZE=176,                                            *
               RECFM=F,                                                *
               OPTCD=WR
         DS    F
TAB      DS    0D
*                    0 1 2 3 4 5 6 7 8 9 A B C D E F
         DC    XL16'04080808080808080808080808080808'  00-0F
         DC    XL16'08080808080808080808080808080808'  10-1F
         DC    XL16'08080808080808080808080808080808'  20-2F
         DC    XL16'08080808080808080808080808080800'  30-3F
         DC    XL16'00080808080808080808080008000008'  40-4F
         DC    XL16'00080808080808080808080000000008'  50-5F
         DC    XL16'00000808080808080808080000080800'  60-6F
         DC    XL16'08080808080808080808000000000000'  70-7F
         DC    XL16'08080808080808080808080808080808'  80-8F
         DC    XL16'08080808080808080808080808080808'  90-9F
         DC    XL16'08080808080808080808080808080808'  A0-AF
         DC    XL16'08080808080808080808080808080808'  B0-BF
         DC    XL16'08000000000000000000080800080008'  C0-CF
         DC    XL16'08000000000000000000080808080808'  D0-DF
         DC    XL16'08080000000000000000080800080808'  E0-EF
         DC    XL16'00000000000000000000000808080808'  F0-FF
*                    0 1 2 3 4 5 6 7 8 9 A B C D E F
TAPDCB   DC    CL8'TAPE'
DOCLENC  DC    F'0'          LENGTH OF DOCUMENT -1 (FOR CLEAR)
DOCLENM  DC    F'0'          LENGTH OF DOCUMENT    (FOR MOVES)
SAVEUCB  DS    CL6           SAVE UCB FROM TAPE DATA SET
         DS    CL4           SAVE DEVICE TYPE FROM TAPE DATA SET
CHKCNT   DC    F'0'        FIELD FOR CURRENT BLOCK COUNT ON CHECKPOINT
CHKLIM   DC    F'16'         MAXIMUM BLOCK COUNT ON CHECK POINT
CHKBUF   DC    F'0'          ADDRESS OF BUFFER IS SAVED HERE
JFCBEXIT DC    F'0'          SPACE FOR DCB EXIT LIST
         DC    X'80',AL3(0)
OCRSW    DC    X'00'         SWITCH BYTE USED FOR FOLLOWING CONDITIONS
ERRWAS   EQU   1             INDICATES AN ERROR IN THIS DOCUMENT
INVCHAR  EQU   2             INDICATES AN INVALID CHAR IN DOCUMENT
*                            BIT IS SET IN SYNAD ROUTINE
*
         ORG   &NAME+4096
OUT      DS    CL&LOUT
*
         ORG   OUT+(&PAGES*4096)
ENDOFOCR DS    0D            FORCE PROGRAM END ON DOUBLEWORD BOUNDARY
*
*              OTHER EQUATES
*
CHAINBIT EQU   X'40'         INDICATES THAT CCW CHAIN IS CONTINUED
SERREFMK EQU   X'53'         COMMAND CODE FOR SEARCH REFERENCE MARK
COMPLBW  EQU   X'03'         COMPLEMENT OF READ BACKWARD
COMPLFW  EQU   X'0D'         COMPLEMENT OF READ FORWARD
BACKCMD  EQU   X'0C'         SPECIFIES READ BACKWARD
ISOPEN   EQU   X'10'         INDICATES THAT DCB WAS SUCCESSFULLY OPENED
BLANK    EQU   X'40'
STERN    EQU   X'5C'
         MEND
./ ADD  NAME=OCRDEFS
         TITLE 'LUKSL        DEFINITIONEN'
OCR      DCB   DDNAME=OCR,DSORG=PS,                                    *
               DEVD=OR,                                                *
               ERRCNT=ERRORS,                                          *
               MACRF=(RC),                                             *
               OPTCD=H,                                                *
               RECFM=U,                                                *
               EODAD=EOFIN
*
OCRCHECK  DC    F'0'
OCRECB   DC    F'0'          ECB FOR WTOR
OCRREPLY DC    CL4' '        REPLY AREA FOR OPERATOR'S ANSWER TO WTOR
OCRINDIC DC    X'0'           INDICATOR WHAT TO DO AFTER 'CHECK'
OCRINDNM EQU   0              NORMAL PROCEED
OCRINDRJ EQU   4              REJECT THE DOCUMENT
OCRINDEF EQU   8              DO EOF PROCESSING
OCRINDPR EQU   12             ASSUME DOCUMENT PROCESSED
OCRSW    DC    X'00'         SWITCH BYTE USED FOR FOLLOWING CONDITIONS
ERRWAS   EQU   1             INDICATES AN ERROR IN THIS DOCUMENT
INVCHAR  EQU   2             INDICATES AN INVALID CHAR IN DOCUMENT
*                            BIT IS SET IN SYNAD ROUTINE
*
*              COUNTERS
*
INCOUNT  DC    F'0'          COUNT OF DOCUMENTS READ
INPCNTOK DC    F'0'          COUNT OF DOCUMENTS WITHOUT ANY READ ERROR
INPCNTWR DC    F'0'          COUNT FOR DOCUMENTS WITH READ ERRORS
OUTCNT   DC    F'0'          COUNT FOR DOCUMENTS WRITTEN TO TAPE
NOREFCNT DC    F'0'          COUNT FOR DOCUMENT WITH NO REF-MARK FOUND
NONRECCT DC    F'0'          COUNT FOR NONRECOVERY ERRORS
INVCHCNT DC    F'0'          COUNT FOR DOCUMENTS WITH INVALID CHARS
NOREFLIM DC    F'10'         LIMIT FOR THIS CONDITION
DW       DC    D'0'          WORK FIELD FOR CONVERSION
ASTINCT  DC    D'0'          TOTAL DOCUMENT COUNT FOR COBAST
ASTOKCT  DC    D'0'          COUNT OF GOOD DOCUMENTS
ASTWRCT  DC    D'0'          COUNT OF REJECTED DOCUMENTS
ASTOUT   DC    D'0'          COUNT OF RECORDS ON TAPE
ASTREF   DC    D'0'          COUNT OF NO REFERENCE MARK CONDITIONS
ASTNONR  DC    D'0'          COUNT OF NONRECOVERY ERRORS
ASTPROZ  DC    D'0'          PERCENTAGE OF REJECTS OUT OF TOTAL
ASTINVCH DC    D'0'          COUNT FOR DOCUMENTS WITH INV. CHARS
*
*              ERROR COUNTS (COUNTED BY DATA MANAGEMENT ROUTINES)
*
ERRORS   DS    0F
         DC    8F'0'
MODNAME  DC    CL8' '         NAME OF CSECT WITH CCW'S
MODMOVE  MVC   MODNAME(0),2(R2)
*
*
*              DATA CONTROL BLOCKS
*
MESSAG   DCB   DDNAME=SYSPRINT,DSORG=PS,                               *
               MACRF=PM,                                               *
               RECFM=FBA,                                              *
               LRECL=133,                                              *
               BLKSIZE=665
*
TAPE     DCB   DDNAME=TAPE,DSORG=PS,                                   *
               MACRF=PM,                                               *
               RECFM=FB
CHECKP   DCB   DDNAME=CHECKPT,DSORG=DA,                                *
               MACRF=(WIC),                                            *
               BLKSIZE=176,                                            *
               RECFM=F,                                                *
               OPTCD=WR
         DS    F
TAB      DS    0D
*                    0 1 2 3 4 5 6 7 8 9 A B C D E F
         DC    XL16'04080808080808080808080808080808'  00-0F
         DC    XL16'08080808080808080808080808080808'  10-1F
         DC    XL16'08080808080808080808080808080808'  20-2F
         DC    XL16'08080808080808080808080808080800'  30-3F
         DC    XL16'00080808080808080808080008000008'  40-4F
         DC    XL16'00080808080808080808080000000008'  50-5F
         DC    XL16'00000808080808080808080000080800'  60-6F
         DC    XL16'08080808080808080808000000000000'  70-7F
         DC    XL16'08080808080808080808080808080808'  80-8F
         DC    XL16'08080808080808080808080808080808'  90-9F
         DC    XL16'08080808080808080808080808080808'  A0-AF
         DC    XL16'08080808080808080808080808080808'  B0-BF
         DC    XL16'08000000000000000000080800080008'  C0-CF
         DC    XL16'08000000000000000000080808080808'  D0-DF
         DC    XL16'08080000000000000000080800080808'  E0-EF
         DC    XL16'00000000000000000000000808080808'  F0-FF
*                    0 1 2 3 4 5 6 7 8 9 A B C D E F
TAPDCB   DC    CL8'TAPE'
HALBSPUR DC    H'6447'       MAXIMUM BLOCKSIZE (HALBSPUR 3330)
TAPBLKSI DC    H'0'          CALCULATED BLOCKSIZE FOR TAPE DCB
H10000   DC    H'10000'
DOCLENM  DC    F'0'          LENGTH OF DOCUMENT    (FOR MOVES)
SAVEUCB  DS    CL6           SAVE UCB FROM TAPE DATA SET
         DS    CL4           SAVE DEVICE TYPE FROM TAPE DATA SET
CHKCNT   DC    F'0'        FIELD FOR CURRENT BLOCK COUNT ON CHECKPOINT
CHKLIM   DC    F'16'         MAXIMUM BLOCK COUNT ON CHECK POINT
CHKBUF   DC    F'0'          ADDRESS OF BUFFER IS SAVED HERE
*
./ ADD  NAME=OPDMERG
         MACRO
&NM      OPDMERG &TYPE=CSECT
         LCLC  &N
&N       SETC  '&NM'
         AIF   ('&TYPE' NE 'DSECT').DEF
&N       DSECT
&N       SETC  ' '
.DEF     ANOP
*
*        DEFINITION DER MANUELL ERFASSTEN ERGAENZUNGEN
*        ZUM DRUCKMANAGEMENTSATZ
*
&N       DS    0D
OPDMERG  EQU   *
         DS    CL1
OPLIST#  DS    CL10        LISTEN-NUMMER
         DS    CL1
OPABLS   DS    CL6         ABLAUFSEITE
         DS    CL1
OPDSN    DS    CL14        DSNAME DER DRUCKDATEI
OPBURST  DS    CL1         3800 BURST PARAMETER
OPFLASH  DS    CL4         3800-MASKE FUER DIESE LISTE
         DS    CL1
OPINDEV  DS    CL7         INPUT DEVICE
OPFCB    DS    CL4         FCB-NAME
OPUCS    DS    CL5         UCS-NAME
         DS    CL1
OPPARM   DS    CL6         DRUCK-PARAMETER
         DS    CL2
OPOPTCD  DS    CL1         OPTION-CODE
         DS    CL1
OPKZ3800 DS    CL1         KZ FUER DRUCKBARKEIT AUF 3800
OPSKZ    DS    CL1         SONDER-KENNZEICHEN
         DS    CL1
OPFORM   DS    CL3         PAPIER-LAGERNUMMER
         DS    CL7
OPLIST#O DS    CL7
         DS    CL2
OPDRHW   DS    CL35        DRUCK-HINWEIS
         DS    CL7
OPERGEND DS    0C
OPERGLEN EQU   OPERGEND-OPDMERG
         MEND
./ ADD  NAME=OP023ARG
** TITLE   OP023AST PARAMETER LISTE
** OWNER   128.FRANZ
** LCHNG   06/23/83 17:09:36   Z227128 FRANZ
         MACRO
&NM      OP023ARG
         LCLC  &N
.*
.*       AUTOR:     H. FRANZ
.*
&N       SETC  '&NM'
&N       DSECT
         DS    0D
OP023ANF EQU   *
OPLIST#  DS    0CL12      LISTEN#
OPPGM    DS    CL9
OPLNR    DS    CL3
OPDSN    DS    CL44       DSNAME DER DRUCKDATEI
OPBERZ   DS    CL8        BERICHTSZEIT
OPERSTTG DS    CL10       ERSTELLUNGSTAG (TAG DES PROGRAMMLAUFS)
OPERSTTM DS    CL8        ERSTELLUNGSUHRZEIT
OPPAGES  DS    XL4        ANZAHL SEITEN DIESER LISTE
OPVOLCNT DS    XL2        ANZAHL VOLUMES DER DRUCKDATEI
OPVOLSER DS    5CL6       DIE ERSTEN 5 VOLSER#
OPDDN    DS    CL8        DDNAME DER DRUCKDATEI
OPPACKS  DS    XL4        ANZAHL PACKS BEI SUB-LISTEN
OPKZ     DS    X          SWITCH BYTE
OPROUT   EQU   1          INDICATES ROUTINE JOB
OPGESPG  DS    XL4        GESAMT SEITENZAHL BEI SVT
OP023END EQU   *-OP023ANF
         MEND
./ ADD  NAME=OP02301
** TITLE   OP023 DRUCK-AUFTRAG
** OWNER   H. FRANZ
** LCHNG   07/01/83 17:01:15   Z227128 FRANZ
*
*      AUFBAU DRUCKAUFTRAG
*      -------------------
*
*        GEAENDERT    H. FRANZ 12. 9. 1980
*        GEAENDERT    H. FRANZ  8. 11. 1982
DA#LINES DC    A((DAEND-DALINE1)/133) ANZAHL ZEILEN
DALINE1  DS    0CL133                  ==> LINE 1
         DC    C'1'
         DC    85C'*'
         DC    CL47' '
         SPACE
DALINE2  DS    0CL133                  ==> LINE 2
         DC    C' '
         DC    CL84'*'
         DC    CL48'*'
         SPACE
DALINE3  DS    0CL133                  ==> LINE 3
         DC    C' '
         DC    CL31'*   B A S F'
         DC    CL23'****************'
         DC    CL13'LISTEN-NR.:'
DALIST#  DC    CL10' '
         DC    CL7' '
         DC    CL48'*'
         SPACE
DALINE4  DS    0CL133                  ==> LINE 4
         DC    C' '
         DC    CL33'*'
         DC    CL37'DRUCKAUFTRAG'
DALIST#O DC    CL6' '    ALTE LISTEN NUMMER
         DC    CL8' '
         DC    CL48'*'
         SPACE
DALINE5  DS    0CL133                  ==> LINE 5
         DC    C' '
         DC    CL31'*     INFORMATIK'
         DC    CL23'****************'
         DC    CL13'BERICHTSZEIT:'
DABERZ   DC    CL8' '    BERICHTSZEITRAUM
         DC    CL9' '
         DC    CL48'*'
         SPACE
DALINE6  DS    0CL133                  ==> LINE 6
         DC    C' '
         DC    CL84'*',CL48'*'
         SPACE
DALINE7  DS    0CL133                  ==> LINE 7
         DC    C' '
         DC    CL04'*'
DAJOB#   DC    CL18' '   JOB NUMMER
         DC    CL35' '
         DC    CL13'DRUCKART:'
DADRART  DC    CL5' '    DRUCK-ART
         DC    CL9' '
         DC    CL48'*'
         SPACE
DALINE8  DS    0CL133                  ==> LINE 8
         DC    C' '
         DC    CL57'*   SB-NR.:'
         DC    CL27' '
         DC    CL48'*'
         SPACE
DALINE9  DS    0CL133                  ==> LINE 9
         DC    C' '
         DC    CL84'*',CL48'*'
         SPACE
DALINE10 DS    0CL133                  ==> LINE 10
         DC    C' '
         DC    C'*'
         DC    83C'-',CL48'*'
         SPACE
DALINE11 DS    0CL133                  ==> LINE 11
         DC    C' '
         DC    CL33'*  DRUCKDATEI'
         DC    CL51'DRUCK-ANGABEN'
         DC    CL48'*'
         SPACE
DALINE12 DS    0CL133                  ==> LINE 12
         DC    C' '
         DC    CL33'*  ----------'
         DC    CL15'-------------'
         DC    CL2' '
DAPAGES3 DC    CL6' '
         DC    CL28' '
         DC    CL48'*'
         SPACE
DALINE13 DS    0CL133                  ==> LINE 13
         DC    C' '
         DC    CL18'*  SACHGEBIET:'
DASG     DC    CL2' '    SACHGEBIET
         DC    CL13' '
         DC    CL16'BLATTANZAHL:'
DAPAGES  DC    CL6' '         SEITEN ZAHL
         DC    CL5' '
         DC    CL14'DRUCK-PARAM.:'
DAPARM   DC    CL5' '         DRUCK-PARAMETER
         DC    CL5' '
         DC    CL48'*'
         SPACE
DALINE14 DS    0CL133                  ==> LINE 14
         DC    C' '
         DC    CL18'*  ABLAUFBLATT:'
DAABLS   DC    CL8' '        ABLAUFSEITE
         DC    CL7' '
         DC    CL16'ARBEITS-NR.:'
DAARB#   DC    CL4' '    ARBEITSNUMMER
         DC    CL7' '
         DC    CL14'FORMULAR-NR.:'
DAFORM   DC    CL4' '         FORMULAR NUMMER
         DC    CL6' '
         DC    CL48'*'
         SPACE
DALINE15 DS    0CL133                  ==> LINE 15
         DC    C' '
         DC    CL18'*  MULT-EINS-NR:'
DAMULTNM DC    CL8' '        TERMIN SCHLUESSEL
         DC    CL7' '
         DC    CL16'LAUF-KENNZ.:'
DALKZ    DC    CL1' '         LAUF-KENNZIFFER
         DC    CL10' '
         DC    CL14'FORM-FORMAT:'
DADIN    DC    CL3' '         DIN-FORMAT
         DC    CL7' '
         DC    CL48'*'
         SPACE
DALINE16 DS    0CL133                  ==> LINE 16
         DC    C' '
         DC    CL18'*  ERST.-DATUM:'
DAERSTTG DC    CL10' '       ERSTELLUNGSDATUM
         DC    CL5' '
         DC    CL16'BURST:'
DABURST  DC    CL1' '        BURST PARAMETER
         DC    CL10' '
         DC    CL14'SATZ:'
DASATZ   DC    CL2' '         VIELFACHHEIT DES PAPIERS
         DC    CL8' '
         DC    CL48'*'
         SPACE
DALINE17 DS    0CL133                  ==> LINE 17
         DC    C' '
         DC    CL18'*  UHRZEIT:'
DAERSTTM DC    CL8' '        ERSTELLUNGS-UHRZEIT
         DC    CL7' '
         DC    CL16'FCB:'
DAFCB    DC    CL4' '         FCB-PARAMETER
         DC    CL7' '
         DC    CL24' '
         DC    CL48'*'
         SPACE
DALINE18 DS    0CL133                  ==> LINE 18
         DC    C' '
         DC    CL18'*  DRUCKHINWEIS:'
         DC    CL15' '
         DC    CL16'FLASH:'
DAFLASH  DC    CL4' '         FLASH-PARAMETER (NAME)
         DC    CL7' '
         DC    CL14'FLASH-COUNT:'
DAFLCNT  DC    CL3' '         FLASH-PARAMETER (COUNT)
         DC    CL7' '
         DC    CL48'*'
         SPACE
DALINE19 DS    0CL133                  ==> LINE 19
         DC    C' '
         DC    CL33'*'
         DC    CL16'MODIFY-PARAM.:'
DAMOD    DC    CL4' '         MODIFY-PARM (NAME OF COPYMOD)
         DC    CL7' '
         DC    CL14'MODIFY-AUSW.:'
DAMODA   DC    CL1' '
         DC    CL9' '
         DC    CL48'*' '
         SPACE
DALINE20 DS    0CL133                  ==> LINE 20
         DC    C' '
         DC    CL3'*'
DADRHW1  DC    CL30' '        DRUCKHINWEIS ERSTE PORTION
         DC    CL16'OPTION-CODE:'
DAOPTCD  DC    CL1' '         OPTION-CODE DCB-SUBPARAMETER
         DC    CL10' '
         DC    CL14'EXEMPLAR-ANZ:'
DAKOPIEN DC    CL3' '         ANZAHL EXEMPLARE
         DC    CL7' '
         DC    CL48'*'
         SPACE
DALINE21 DS    0CL133                  ==> LINE 21
         DC    C' '
         DC    CL18'*'
DADRHW2  DC    CL5' '
         DC    CL10' '
         DC    CL16'CHARS-PARAM.:'
DACH0    DC    CL4' '         1. CHARS-PARAMETER
         DC    C' '
DACH1    DC    CL4' '         2. CHARS-PARAMETER
         DC    C' '
DACH2    DC    CL4' '         3. CHARS-PARAMETER
         DC    C' '
DACH3    DC    CL4' '         4. CHARS-PARAMETER
         DC    CL16' '
         DC    CL48'*'
         SPACE
DALINE22 DS    0CL133                  ==> LINE 22
         DC    C' '
         DC    CL33'*  DS-NAME:'
         DC    CL16'COPY-PARAM.:'
DACOPY   DC    CL3' '         COPIES-PARAMETER (WITHOUT SUB-PARMS)
         DC    CL8' '
         DC    CL14'COPY-GR.-PARAM.:'
         DC    CL10' '
         DC    CL48'*'
         SPACE
DALINE23 DS    0CL133                  ==> LINE 23
         DC    C' '
         DC    CL03'*'
DADSN    DC    CL30' '        DSNAME DER DRUCK-DATEI
         DC    CL20''
DACOPGR0 DC    CL3' '         1. SUBPARM VON COPIES
         DC    C' '
DACOPGR1 DC    CL3' '         2. SUBPARM VON COPIES
         DC    C' '
DACOPGR2 DC    CL3' '         3. SUBPARM VON COPIES
         DC    C' '
DACOPGR3 DC    CL3' '         4. SUBPARM VON COPIES
         DC    C' '
DACOPGR4 DC    CL3' '         5. SUBPARM VON COPIES
         DC    C' '
DACOPGR5 DC    CL3' '         6. SUBPARM VON COPIES
         DC    C' '
DACOPGR6 DC    CL3' '         7. SUBPARM VON COPIES
         DC    C' '
DACOPGR7 DC    CL3' '         8. SUBPARM VON COPIES
         DC    CL48'*'
         SPACE
DALINE24 DS    0CL133                  ==> LINE 24
         DC    C' '
         DC    CL18'*  VOL-SER-NR.:'
DAVOLSER DC    CL14' '        DIE ERSTEN 2 VOLSERS
         DC    C' '
         DC    CL06'UCS:'
DAUCS    DC    CL4' '         UCS PARAMETER
         DC    CL17' '
         DC    CL24' '
         DC    CL48'*'
         SPACE
DALINE25 DS    0CL133                   ==> LINE 25
         DC    C' '
         DC    CL3'*'
DAVOLSC  DC    CL20' '
         DC    C' '
DAVOLF3  DC    CL5' '         EVTL. CONTINUATION FIELD
DAVOLF3F DC    CL4' '         COUNT OF VOLUMES NOT SHOWN
         DC    CL27''
         DC    CL24' '
         DC    CL48'*'
         SPACE
DALINE26 DS    0CL133                  ==> LINE 26
         DC    C' '
         DC    C'*',83C'-',CL48'*'
         SPACE
DALINE27 DS    0CL133                  ==> LINE 27
         DC    C' '
         DC    CL30'*   LISTENERSTELLUNG'
         DC    CL26'  AUSGANGSKONTROLLE'
         DC    CL28'  PAPIERBEARBEITUNG',CL48'*'
         SPACE
DALINE28 DS    0CL133                  ==> LINE 28
         DC    C' '
         DC    CL30'*'
         DC    CL26''
         DC    CL28'',CL48'*'
         SPACE
DALINE29 DS    0CL133                  ==> LINE 29
         DC    C' '
         DC    C'*   BIS      DATUM        '
         DC    CL25' '
         DC    CL28'  BEARBEITUNGSHINWEIS:'
         DC    CL48'*'
         SPACE
DALINE30 DS    0CL133                  ==> LINE 30
         DC    C' '
         DC    CL56'*   SEITEADR UHRZEIT SB-NR'
         DC    CL2''
DABEARB  DC    CL25' '        BEARBEITUNGS HINWEIS
         DC    C' '
         DC    CL48'*'
         SPACE
DALINE31 DS    0CL133                  ==> LINE 31
         DC    C' '
         DC    CL56'*  -----------------------'
         DC    CL28''
         DC    CL48'*'
         SPACE
DALINE32 DS    0CL133                  ==> LINE 32
         DC    C' '
         DC    CL56'*                         '
         DC    CL28'',CL48'*'
         SPACE
DALINE33 DS    0CL133                  ==> LINE 33
         DC    C' '
         DC    C'*                         '
         DC    CL25'  SB-NR.:'
         DC    CL28'',CL48'*'
         SPACE
DALINE34 DS    0CL133                  ==> LINE 34
         DC    C' '
         DC    CL56'*                         '
         DC    CL28'',CL48'*'
         SPACE
DALINE35 DS    0CL133                  ==> LINE 35
         DC    C' '
         DC    CL30'*'
         DC    CL26'  DATUM/UHRZEIT:'
         DC    CL28'  DATUM/UHRZEIT:'
         DC    CL48'*'
         SPACE
DALINE36 DS    0CL133                  ==> LINE 36
         DC    C' '
         DC    CL30'*'
         DC    CL26''
         DC    CL28'',CL48'*'
         SPACE
DALINE37 DS    0CL133                  ==> LINE 37
         DC    C' '
         DC    85C'*'
         DC    CL47' '
         SPACE
DALINE38 DS    0CL133                  ==> LINE 38
         DC    C'0'           ASA CARRIAGE 2 LINES
         DC    CL37' '
         DC    CL13'LISTEN-NR.:'
DALIST#2 DC    CL10' '
         DC    CL2' '
         DC    CL6'LFD#: '
DALFD#   DC    CL4' '
         DC    CL60' '
         SPACE
DALINE39 DS    0CL133                 ==> LINE 39
         DC    C' '           ASA CARRIAGE 1 LINE
         DC    CL37' '
         DC    CL15'BLATTANZAHL:'
DAPAGES2 DC    CL06' '
         DC    CL74' '
         SPACE
DALINE40 DS    0CL133                 ==> LINE 40
         DC    C'0'           ASA CARRIAGE 2 LINES
         DC    CL17' '
         DC    CL20'DRUCKERPOOL:'
         DC    CL15'DATUM UHRZEIT:'
         DC    CL80' '
         SPACE
DALINE41 DS    0CL133                 ==> LINE 41
         DC    C'0'           ASA CARRIAGE 2 LINES
         DC    CL17' '
         DC    CL20'PAPIERBEARBEITUNG:'
         DC    CL15'DATUM UHRZEIT:'
         DC    CL80' '
DAEND    EQU   *
./ ADD  NAME=OP02302
** TITLE   OP023 - LISTENBEGLEITSCHEIN
** OWNER   H. FRANZ
** LCHNG   03/06/84 16:40:34   Z227128 FRANZ
*
*      AUFBAU - LISTENBEGLEITSCHEIN
*      ----------------------------
*
*        GEAENDERT       H. FRANZ  12.  9. 1980
*        GEAENDERT       H. FRANZ   8. 11. 1982
*        GEAENDERT       H. FRANZ  18. 03. 1983
*        GEAENDERT       H. FRANZ  22. 08. 1983
*        GEAENDERT       H. FRANZ   4. 01. 1984
*        GEAENDERT       H. FRANZ   6. 03. 1984
*
LB#LINES DC    A((LBEND-LBLINE1)/133)
LBLINE1  DS    0CL133                  ==> LINE 1
         DC    C'1'
         DC    71C'-'
         DC    CL61' '
         SPACE
LBLINE2  DS    0CL133                  ==> LINE 2
         DC    C' '
         DC    CL70''
         DC    CL62''
         SPACE
LBLINE3  DS    0CL133                  ==> LINE 3
         DC    C' '
         DC    CL70'   B A S F'
         DC    CL62''
         SPACE
LBLINE4  DS    0CL133                  ==> LINE 4
         DC    C' '
         DC    CL40'   ZLI - INFORMATIK'
         DC    CL16'LISTEN-NR.:'
LBLIST#  DC    CL10' '                 LISTEN NUMMER
         DC    CL4' '
         DC    CL62''
         SPACE
LBLINE5  DS    0CL133                  ==> LINE 5
         DC    C' '
         DC    CL70''
         DC    CL62''
         SPACE
LBLINE6  DS    0CL133                  ==> LINE 6
         DC    C' '
         DC    CL08''
         DC    CL40'L  I  S  T  E  N  B  E  G  L  E  I  T  S'
         DC    CL22'  C  H  E  I  N'
         DC    CL62''
LBLINE7  DS    0CL133                  ==> LINE 7
         DC    C' '
         DC    CL70''
         DC    CL62''
         SPACE
LBLINE8  DS    0CL133                  ==> LINE 8
         DC    C' '
         DC    CL70''
         DC    CL62''
         SPACE
LBLINE9  DS    0CL133                  ==> LINE 9
         DC    C' '
         DC    CL11'  LFDNR.: '
LBLFD#   DC    CL05' '
         DC    CL54' '
         DC    CL62''
         SPACE
LBLINE10 DS    0CL133                  ==> LINE 10
         DC    C' '
         DC    CL70''
         DC    CL62''
         SPACE
LBLINE11 DS    0CL133                  ==> LINE 11
         DC    C' '
         DC    CL16'  BEZEICHNUNG:'
LBLISTBZ DC    CL50' '        LISTEN BEZEICHNUNG (TEXT)
         DC    CL04' '
         DC    CL62''
         SPACE
LBLINE12 DS    0CL133                  ==> LINE 12
         DC    C' '
         DC    CL70''
         DC    CL62''
         SPACE
LBLINE13 DS    0CL133                  ==> LINE 13
         DC    C' '
         DC    CL16'  BLATTANZAHL:'
LBPAGES  DC    CL7' '         SEITEN ANZAHL (AUS 'COBAST')
         DC    CL3' '
         DC    CL17'EXEMPLAR-ANZAHL:'
LBCOPY   DC    CL3' '         COPIES
         DC    CL2' '
LBCCOPY  DS    0CL20          CURRENT COPY CLEAR LABEL
*        BEI NORMAL VERTEILUNG IST DAS FELD UNINTERESSANT
         DC    CL17'EXEMPLAR-NUMMER:'
LBCURCOP DC    CL3' '        NUMMER DIESER KOPIE
         DC    CL02' '
         DC    CL62''
         SPACE
LBLINE14 DS    0CL133                  ==> LINE 14
         DC    C' '
         DC    CL70''
         DC    CL62''
         SPACE
LBLINE15 DS    0CL133                  ==> LINE 15
         DC    C' '
         DC    CL48''
LBCPACK  DS    0CL20
         DC    CL17'PACK-NUMMER:'
LBPACK   DC    CL3' '         PACK-NUMMER
         DC    CL2' '
         DC    CL62''
         SPACE
LBLINE16 DS    0CL133                  ==> LINE 16
         DC    C' '
         DC    CL01''
         DC    69C'-'
         DC    CL62''
         SPACE
LBLINE17 DS    0CL133                  ==> LINE 17
         DC    C' '
         DC    CL2''
         DC    CL67'  EMPFAENGER-ADRESSE:'
         DC    CL63''
         SPACE
LBLINE18 DS    0CL133                  ==> LINE 18
         DC    C' '
         DC    CL02''
         DC    CL67'  -------------------'
         DC    CL63''
         SPACE
LBLINE19 DS    0CL133                  ==> LINE 19
         DC    C' '
         DC    CL02''
         DC    CL67' '
         DC    CL63''
         SPACE
LBLINE20 DS    0CL133                  ==> LINE 20
         DC    C' '
         DC    CL04''
         DC    CL12'ORG-CODE'
         DC    CL2' '
         DC    CL10'O R T'
         DC    CL1' '
         DC    CL07'BAU-NR.'
         DC    CL3' '
         DC    CL10'ZIMMER-NR.'
         DC    CL6' '
         DC    CL11'TELEFON-NR.'
         DC    CL3' '
         DC    CL63''
         SPACE
LBLINE21 DS    0CL133                  ==> LINE 21
         DC    C' '
         DC    CL02''
         DC    CL67' '
         DC    CL63''
         SPACE
LBLINE22 DS    0CL133                  ==> LINE 22
         DC    C' '
         DC    CL04''
LBEMPFOR DC    CL12' '        ORGANISATORISCHE EINHEIT DES EMPFAENGERS
         DC    CL2' '
LBEMPORT DC    CL10' '        ORT = SITZ DER ORG EINHEIT
         DC    CL2' '
LBEMPFB  DC    CL4' '         BAU DES EMPFAENGERS
         DC    CL7' '
LBEMPFZ  DC    CL4' '         ZIMMMER DES EMPFAENGERS
         DC    CL11' '
LBEMPFTL DC    CL8' '         RUFNUMMER DES EMPFAENGERS
         DC    CL5' '
         DC    CL63''
         SPACE
LBLINE23 DS    0CL133                  ==> LINE 23
         DC    C' '
         DC    CL02''
         DC    CL67' '
         DC    CL63''
         SPACE
LBLINE24 DS    0CL133                  ==> LINE 24
         DC    C' '
         DC    CL02''
         DC    CL67' '
         DC    CL63''
         SPACE
LBLINE25 DS    0CL133                  ==> LINE 25
         DC    C' '
         DC    CL69'  SB.-NR.      SB.-NAME'
         DC    CL63''
         SPACE
LBLINE26 DS    0CL133                  ==> LINE 26
         DC    C' '
         DC    CL06''
LBEMPF#  DC    CL3' '         SACHBEARBEITER NUMMER DES EMPFAENGERS
         DC    CL8' '
LBEMPFNM DC    CL40' '        NAME DES EMPFAENGERS
         DC    CL12' '
         DC    CL63''
         SPACE
LBLINE27 DS    0CL133                  ==> LINE 27
         DC    C' '
         DC    CL02''
         DC    CL67' '
         DC    CL63''
         SPACE
LBLINE28 DS    0CL133                  ==> LINE 28
         DC    C' '
         DC    CL2''
         DC    67C'-'
         DC    CL63''
         SPACE
LBLINE29 DS    0CL133                  ==> LINE 29
         DC    C' '
         DC    CL70' HINWEIS FUER LISTENEMPFAENGER'
         DC    CL62''
         SPACE
LBLINE30 DS    0CL133                  ==> LINE 30
         DC    C' '
         DC    CL70' -----------------------------'
         DC    CL62''
         SPACE
LBLINE31 DS    0CL133                  ==> LINE 31
         DC    C' '
         DC    CL40' BEI AENDERUNGEN IM ANSCHRIFTENTEIL DER'
         DC    CL30' EMPFAENGER-ADRESSE GENUEGT,'
         DC    CL62''
         SPACE
LBLINE32 DS    0CL133                  ==> LINE 32
         DC    C' '
         DC    CL40' AUCH WENN DER EMPFAENGER MEHRERE LISTE'
         DC    CL30'N ERHAELT, DIE RUECKGABE'
         DC    CL62''
         SPACE
LBLINE33 DS    0CL133                  ==> LINE 33
         DC    C' '
         DC    CL40' EINES KORRIGIERTEN LISTENBEGLEITSCHEIN'
         DC    CL30'ES.'
         DC    CL62''
         SPACE
LBLINE34 DS    0CL133                  ==> LINE 34
         DC    C' '
         DC    CL40' AENDERUNGEN IM NAMENSTEIL DER EMPFAENG'
         DC    CL30'ER-ADRESSE ERFORDERN JEDOCH'
         DC    CL62''
         SPACE
LBLINE35 DS    0CL133                  ==> LINE 35
         DC    C' '
         DC    CL40' DIE KORREKTUR UND RUECKGABE SAEMTLICHE'
         DC    CL30'R LISTENBEGLEITSCHEINE AN:'
         DC    CL62''
         SPACE
LBLINE36 DS    0CL133                  ==> LINE 36
         DC    C' '
         DC    CL70' Z L I / KK    LU-HC,ZI.2206'
         DC    CL62''
         SPACE
LBLINE37 DS    0CL133                  ==> LINE 37
         DC    C' '
         DC    CL70''
         DC    CL62''
         SPACE
LBLINE38 DS    0CL133                  ==> LINE 38
         DC    C' '
         DC    CL50'  DATUM:         UNTERSCHRIFT:'
         DC    CL20'TELEFON-NR.:'
         DC    CL62''
         SPACE
LBLINE39 DS    0CL133                  ==> LINE 39
         DC    C' '
         DC    CL70''
         DC    CL62''
         SPACE
LBLINE40 DS    0CL133                  ==> LINE 40
         DC    C' '
         DC    CL70''
         DC    CL62''
         SPACE
LBLINE41 DS    0CL133                  ==> LINE 41
         DC    C' '
         DC    CL1''
         DC    59C'-'
LBPGMT   DC    CL8'--------'           ERSTELLUNGS-PROGRAMM
         DC    CL2'--'
         DC    CL62''
LBEND    EQU   *
         SPACE
LBLINE42 DS    0CL133                  ==> LINE 42
         DC    C'-'
         DC    CL22'BEARBEITUNGSHINWEIS :'
LBBEARB  DC    CL72' '
         DC    CL38' '
         SPACE
LBLINE43 DS    0CL133                  ==> LINE 43
         DC    C'0'
         DC    CL22' '
LBBEARB2 DC    CL72' '
         DC    CL38' '
./ ADD  NAME=OP02303
** TITLE   DEFINITION COM-AUFTRAG
** OWNER   128.FRANZ
** LCHNG   03/18/83 10:27:24   Z227128 FRANZ
*
*      AUFBAU COM-AUFTRAG
*      ------------------
*
*                     H. FRANZ 28. 9. 1981
*    MODIFIED :       H. FRANZ  8. 11.1982
CM#LINES DC    A((CMEND-CMLINE1)/133) ANZAHL ZEILEN
CMLINE1  DS    0CL133                  ==> LINE 1
         DC    C'1'
         DC    85C'*'
         DC    CL47' '
         SPACE
CMLINE2  DS    0CL133                  ==> LINE 2
         DC    C' '
         DC    CL84'*'
         DC    CL48'*'
         SPACE
CMLINE3  DS    0CL133                  ==> LINE 3
         DC    C' '
         DC    CL31'*   B A S F'
         DC    CL23'****************'
         DC    CL13'LISTEN-NR.:'
CMLIST#  DC    CL10' '
         DC    CL7' '
         DC    CL48'*'
         SPACE
CMLINE4  DS    0CL133                  ==> LINE 4
         DC    C' '
         DC    CL33'*'
         DC    CL37'COM -AUFTRAG'
CMLIST#O DC    CL6' '    ALTE LISTEN NUMMER
         DC    CL8' '
         DC    CL48'*'
         SPACE
CMLINE5  DS    0CL133                  ==> LINE 5
         DC    C' '
         DC    CL31'*     INFORMATIK'
         DC    CL23'****************'
         DC    CL13'BERICHTSZEIT:'
CMBERZ   DC    CL8' '    BERICHTSZEITRAUM
         DC    CL9' '
         DC    CL48'*'
         SPACE
CMLINE6  DS    0CL133                  ==> LINE 6
         DC    C' '
         DC    CL84'*',CL48'*'
         SPACE
CMLINE7  DS    0CL133                  ==> LINE 7
         DC    C' '
         DC    CL04'*'
CMJOB#   DC    CL18' '   JOB NUMMER
         DC    CL35' '
         DC    CL13' '
CMDRART  DC    CL14' '   DRUCK-ART
         DC    CL48'*'
         SPACE
CMLINE8  DS    0CL133                  ==> LINE 8
         DC    C' '
         DC    CL37'*   SB-NR.:'
CMPLOT   DS    0CL10
         DC    CL04'JOB.'
CMJOBNM  DS    0CL6
CMJOBSG  DC    CL2' '         SACHGEBIETS ANTEIL
CMJOBCM  DC    CL2' '         COM-EINSATZ TEIL
CMJOBL#  DC    CL2' '         LISTEN-NR. ANTEIL
         DC    CL37' '
         DC    CL48'*'
         SPACE
CMLINE9  DS    0CL133                  ==> LINE 9
         DC    C' '
         DC    CL84'*',CL48'*'
         SPACE
CMLINE10 DS    0CL133                  ==> LINE 10
         DC    C' '
         DC    C'*'
         DC    83C'-',CL48'*'
         SPACE
CMLINE11 DS    0CL133                  ==> LINE 11
         DC    C' '
         DC    CL33'*  COM-DATEI'
         DC    CL51''
         DC    CL48'*'
         SPACE
CMLINE12 DS    0CL133                  ==> LINE 12
         DC    C' '
         DC    CL33'*  ----------'
         DC    CL51'',CL48'*'
         SPACE
CMLINE13 DS    0CL133                  ==> LINE 13
         DC    C' '
         DC    CL18'*  SACHGEBIET:'
CMSG     DC    CL2' '    SACHGEBIET
         DC    CL13' '
         DC    CL16'ARBEITS-NR.:'
CMARB#   DC    CL4' '    ARBEITSNUMMER
         DC    CL31' '
         DC    CL48'*'
         SPACE
CMLINE14 DS    0CL133                  ==> LINE 14
         DC    C' '
         DC    CL18'*  ABLAUFBLATT:'
CMABLS   DC    CL8' '        ABLAUFSEITE
         DC    CL7' '
         DC    CL16'LAUF-KENNZ.:'
CMLKZ    DC    CL1' '         LAUF-KENNZIFFER
         DC    CL34' '
         DC    CL48'*'
         SPACE
CMLINE15 DS    0CL133                  ==> LINE 15
         DC    C' '
         DC    CL18'*  COM-EINSATZ:'
CMCOMEIN DC    CL8' '
         DC    CL7' '
         DC    CL51''
         DC    CL48'*'
         SPACE
CMLINE16 DS    0CL133                  ==> LINE 16
         DC    C' '
         DC    CL18'*  ERST.-DATUM:'
CMERSTTG DC    CL10' '       ERSTELLUNGSDATUM
         DC    CL5' '
         DC    CL16'BLATTANZAHL:'
CMPAGES  DC    CL6' '         SEITEN ZAHL
         DC    CL29'  '
         DC    CL48'*'
         SPACE
CMLINE17 DS    0CL133                  ==> LINE 17
         DC    C' '
         DC    CL18'*  UHRZEIT:'
CMERSTTM DC    CL8' '        ERSTELLUNGS-UHRZEIT
         DC    CL7' '
         DC    CL51''
         DC    CL48'*'
         SPACE
CMLINE18 DS    0CL133                  ==> LINE 18
         DC    C' '
         DC    CL33'*'
         DC    CL51''
         DC    CL48'*'
         SPACE
CMLINE19 DS    0CL133                  ==> LINE 19
         DC    C' '
         DC    CL33'*'
         DC    CL51''
         DC    CL48'*'
         SPACE
CMLINE20 DS    0CL133                  ==> LINE 20
         DC    C' '
         DC    CL33'*  DS-NAME:'
         DC    CL20' DUPLIZIER-FAKTOR:'
CMCOPY   DC    CL3' '         ANZAHL DER KOPIER-DURCHLAUEFE
         DC    CL28' '
         DC    CL48'*'
         SPACE
CMLINE21 DS    0CL133                  ==> LINE 21
         DC    C' '
         DC    CL03'*'
CMDSN    DC    CL30' '        DSNAME DER COM-DATEI
         DC    CL51''
         DC    CL48'*'
         SPACE
CMLINE22 DS    0CL133                  ==> LINE 22
         DC    C' '
         DC    CL18'*  VOL-SER-NR.:'
CMVOLSER DC    CL14' '        DIE ERSTEN 2 VOLSERS
         DC    C' '
         DC    CL2' '
CMGRAF   DS    0CL10
         DC    CL19'FICHES:'
         DC    CL6'LFD#: '
CMLFD#   DC    CL4' '         LAUFENDE NUMERIERUNG
         DC    CL20' '
         DC    CL48'*'
         SPACE
CMLINE23 DS    0CL133                   ==> LINE 23
         DC    C' '
         DC    CL3'*'
CMVOLSC  DC    CL20' '
         DC    C' '
CMVOLF3  DC    CL5' '         EVTL. CONTINUATION FIELD
CMVOLF3F DC    CL4' '         COUNT OF VOLUMES NOT SHOWN
         DC    CL51''
         DC    CL48'*'
         SPACE
CMLINE24 DS    0CL133                  ==> LINE 24
         DC    C' '
         DC    C'*',83C'-',CL48'*'
         SPACE
CMLINE25 DS    0CL133                  ==> LINE 25
         DC    C' '
         DC    CL30'*   FICHE-ERSTELLUNG'
         DC    CL26'  KOPIEN-ERSTELLUNG'
         DC    CL28'  AUSGANGSKONTROLLE'
         DC    CL48'*'
         SPACE
CMLINE26 DS    0CL133                  ==> LINE 26
         DC    C' '
         DC    CL30'*'
         DC    CL26''
         DC    CL28'',CL48'*'
         SPACE
CMLINE27 DS    0CL133                  ==> LINE 27
         DC    C' '
         DC    CL30'*    BIS   DATUM   '
         DC    CL26' BIS   DATUM   '
         DC    CL28''
         DC    CL48'*'
         SPACE
CMLINE28 DS    0CL133                  ==> LINE 28
         DC    C' '
         DC    CL30'*   FICHE# UHRZEIT SB-NR'
         DC    CL26'FICHE# UHRZEIT SB-NR'
         DC    CL28''
         DC    CL48'*'
         SPACE
CMLINE29 DS    0CL133                  ==> LINE 29
         DC    C' '
         DC    CL30'*   --------------------'
         DC    CL26'--------------------'
         DC    CL28''
         DC    CL48'*'
         SPACE
CMLINE30 DS    0CL133                  ==> LINE 30
         DC    C' '
         DC    CL30'*                       '
         DC    CL26'                    '
         DC    CL28'',CL48'*'
         SPACE
CMLINE31 DS    0CL133                  ==> LINE 31
         DC    C' '
         DC    CL30'*                       '
         DC    CL26'                    '
         DC    CL28'  SB-NR.:'
         DC    CL48'*'
         SPACE
CMLINE32 DS    0CL133                  ==> LINE 32
         DC    C' '
         DC    CL30'*                       '
         DC    CL26'                    '
         DC    CL28'',CL48'*'
         SPACE
CMLINE33 DS    0CL133                  ==> LINE 33
         DC    C' '
         DC    CL30'*'
         DC    CL26''
         DC    CL28'  DATUM/UHRZEIT:'
         DC    CL48'*'
         SPACE
CMLINE34 DS    0CL133                  ==> LINE 34
         DC    C' '
         DC    CL30'*'
         DC    CL26''
         DC    CL28'',CL48'*'
         SPACE
CMLINE35 DS    0CL133                  ==> LINE 35
         DC    C' '
         DC    85C'*'
         DC    CL47' '
         SPACE
CMLINE36 DS    0CL133                  ==> LINE 36
         DC    C' '
         DC    CL18' EMPF. ORIGINAL : '
CMEMPF#  DC    CL3' '      SB# EMPFAENGER
         DC    C' '
CMEMPFNM DC    CL20' '     NAME EMPFAENGER
         DC    CL7' BAU : '
CMEMPFB  DC    CL4' '
         DC    CL7' ZIM : '
CMEMPFZ  DC    CL4' '
         DC    CL7' TEL : '
CMEMPFTL DC    CL8' '      TELEFON EMPFAENGER
         DC    CL6' '
         DC    CL47' '
         SPACE
CMLINE37 DS    0CL133                  ==> LINE 37
         DC    C' '
         DC    85C'*'
         DC    CL47' '
         SPACE
CMEND    EQU   *
./ ADD  NAME=PFKDEF
         MACRO
&SYM     PFKDEF &CON=N,&CMD=
         GBLC  &CMDS(24),&CONS(24)
         LCLA  &N
&N       SETA  &SYSNDX
&CMDS(&N) SETC '&CMD'
&CONS(&N) SETC '80'
         AIF   ('&CON' NE 'Y').CONOK
&CONS(&N) SETC 'A0'
.CONOK   ANOP
         AIF   ('&CON' NE 'U').ENDE
&CONS(&N) SETC '00'
.ENDE    ANOP
         MEND
./ ADD  NAME=PFKGEN
         MACRO
         PFKGEN
         GBLC  &CMDS(24),&CONS(24)
         LCLA  &CURR
         LCLC  &CURRC
&CURR    SETA  1
&CURRC   SETC  '&CURR'
         PRINT OFF,NOGEN
PFKSTRT  CSECT
         DC    A(PFKEYS)
         DC    XL10'00'
PFKEYS   DC    AL2(PFKEND-PFKSTRT)
         DC    H'0'
.NEXT    ANOP
         AIF   (&CURR EQ 25).DONE
         DC    FL1'&CURRC'
         DC    X'&CONS(&CURR)'
         DC    CL108&CMDS(&CURR)
&CURR    SETA  &CURR+1
&CURRC   SETC  '&CURR'
         AGO   .NEXT
.DONE    ANOP
         DC    FL1'100'
         DS    0D
PFKEND   EQU   *
         END
         MEND
./ ADD  NAME=POS1PARM
** TITLE   DEFINITION PARAMETER FUER LUPOS1
** OWNER   128.FRANZ
** LCHNG   10/01/82 11:10:13   Z227368 PELIKAN
         MACRO
&NM      POS1PARM &TYPE=DEF,&PREF=POS
         LCLC  &N
&N       SETC  '&NM'
         AIF   ('&TYPE' NE 'DSECT').DEF
&N       DSECT
&N       SETC  ' '
.DEF     ANOP
         SPACE 3
*        DEFINITION DER PARAMETER FUER LUPOS1
*
&N        DS    0D
&PREF.ANZ DS    H          ANZAHL ELEMENTE IN TABELLE
&PREF.LEN DS    H          LAENGE EINES TABELLEN ELEMENTS
&PREF.ANF DS    H          POSITION SUCHBEGRIFF ANFANG
&PREF.END DS    H          POSITION SUCHBEGRIFF ENDE
&PREF.SUZ DS    H          ANZAHL SUCHSCHRITTE
&PREF.FST DS    H          ELEMENT NUMMER 1. VERGLEICH
&PREF.STA DS    F          A(ERSTES VERGLEICHS ELEMENT)
&PREF.BER DS    F          ERSTER BERICHTIGUNGSWERT BEI LOW
&PREF.BEH DS    H          ERSTER BERICHTIGUNGSWERT FUER # BEI HIGH
&PREF.BWH DS    H          ERSTE ADDRESS BERICHTIGUNG BEI HIGH
&PREF.FLN DS    H          VERGLEICHS LAENGE (-1) FUER EX
         MEND
./ ADD  NAME=POS2PARM
** TITLE   DEFINITION PARAMETER FUER LUPOS2
** OWNER   128.FRANZ
** LCHNG   10/01/82 12:05:01   Z227368 PELIKAN
         MACRO
&NM      POS2PARM &TYPE=DEF,&PREF=POS
         LCLC  &N
&N       SETC  '&NM'
         AIF   ('&TYPE' NE 'DSECT').DEF
&N       DSECT
&N       SETC  ' '
.DEF     ANOP
         SPACE 3
*        DEFINITION DER PARAMETER FUER LUPOS2
*
&N        DS    0D
&PREF.ANZ DS    F          ANZAHL ELEMENTE IN TABELLE
&PREF.LEN DS    F          LAENGE EINES TABELLEN ELEMENTS
&PREF.ANF DS    F          POSITION SUCHBEGRIFF ANFANG
&PREF.END DS    F          POSITION SUCHBEGRIFF ENDE
&PREF.SUZ DS    F          ANZAHL SUCHSCHRITTE
&PREF.FST DS    F          ELEMENT NUMMER 1. VERGLEICH
&PREF.STA DS    F          A(ERSTES VERGLEICHS ELEMENT)
&PREF.BER DS    F          ERSTER BERICHTIGUNGSWERT BEI LOW
&PREF.BEH DS    F          ERSTER BERICHTIGUNGSWERT FUER # BEI HIGH
&PREF.BWH DS    F          ERSTE ADDRESS BERICHTIGUNG BEI HIGH
&PREF.FLN DS    F          VERGLEICHS LAENGE (-1) FUER EX
         MEND
./ ADD  NAME=PR
         MACRO
&NAME    PR    &OP,&REG,&SYM
         GBLC  &BREG
         AIF   ('&BREG' NE '').BREGSET
&BREG    SETC  '12'
*** DEFAULT BASE REGISTER IS  12
.BREGSET ANOP
&NAME    &OP   &REG,0(&BREG)
         ORG   *-2
         DC    QL2(&SYM)
         MEND
./ ADD  NAME=PRBASE
         MACRO
&NAME    PRBASE &REG,&GF
         GBLC  &BREG
         LCLC  &GFA
&BREG    SETC  '&REG'
&GFA     SETC  '&GF'
         AIF   (('&GFA' EQ '') OR ('&GFA' EQ 'GM')).ASKBASE
         AIF   ('&GFA' EQ 'FM').ASKBASE
*** WRONG USAGE OF 2ND OPERAND, NO ACTION TAKEN ***
         AGO   .ENDM
.ASKBASE ANOP
         AIF   ('&BREG' NE '').BASESET
&BREG    SETC  '12'
*** DEFAULT BASE REGISTER FOR PR-MACRO IS 12 ***
         AGO   .GETFREE
.BASESET ANOP
&BREG    SETC  '&REG'
*** BASE REGISTER FOR PR-MACRO NOW SET ***
.GETFREE ANOP
         AIF   ('&GFA' EQ '').ENDM
         AIF   ('&GFA' EQ 'FM').NOGETM
         CNOP  0,4
         BAL   1,*+8 BRANCH AROUND CXD
         CXD
         L     0,0(0,1) LOAD DXD LENGTH INTO R0
         GETMAIN R,LV=(0)
         LR    &BREG,1 SET BASE REGISTER ONTO 1ST DXD
         AGO   .ENDM
.NOGETM  ANOP
         CNOP  0,4
         BAL   1,*+8 BRANCH AROUND CXD
         CXD
         L     0,0(0,1) LOAD DXD LENGTH INTO R0
         LR    1,&BREG GET ADR OF 1ST DXD
         FREEMAIN R,LV=(0),A=(1)
.ENDM    ANOP
         MEND
./ ADD  NAME=PREISTAB
         MACRO
         PREISTAB
         SPACE 3
PREISTAB DSECT
*
*
*   THIS DUMMY-SECTION DESCRIBES THE TABLE OF DEVICE INDEPENDENT
*   PRICES SUCH AS CPU-PRICE, ETC.
*
*   THE TABLE IS SEPERATLY ASSEMBLED AND LINKED UNDER THE NAME
*   PREISXX, WHERE XX REPRESENTS THE SMF-SYSTEM-ID (SID).
*
*
CPUPR    DS    F      PRICE FOR ONE CPU-HOUR IN PF.
KSPPR    DS    F      PRICE FOR 1K/H IN PF.
LZPR     DS    F      PRICE FOR 1 HOUR TPROC IN PF.
SINPR    DS    H      PRICE FOR 1 SYSIN CARD IN 1/1000 PF.
SOUTPR   DS    H      PRICE FOR 1 SYSOUT-LINE IN 1/1000 PF.
MNTTAP   DS    H      MOUNT TIME FOR 1 TAPE IN 1/100 SEC.
MNTDSK   DS    H      MOUNT TIME FOR 1 DISK IN 1/100 SEC.
MNTLST   DS    H      MOUNT TIME FOR 1 PAPER-TAPE IN 1/100 SEC.
CPULF    DS    H      CPU-POWER-FACTOR * 1000
MNTMSS   DS    H      MOUNT TIME FOR 1 MSS-VOLUME IN 1/100 SEC.
TSOCPUF  DS    H      CPU FACTOR FOR TSO * 100
JOBCHRG  DS    F      JOB-CHARGE FOR PRODUCTION-JOBS IN PF.
         SPACE 3
         MEND
./ ADD  NAME=PRIME
         MACRO
&NAME    PRIME &REG=12,&SAVE=,&ID=,&LV=0
.* PRIME WILL SAVE REGISTERS, CREATE A NEW SAVE AREA, CHAIN THE NEW
.* SAVE AREA TO THE CALLERS SAVE AREA, ESTABLISH ADDRESSABILITY,
.* OPTIONALLY OBTAIN ADDITIONAL STORAGE AND IN GENERAL PERFORM THE
.* NECESSARY ENTRY LINKAGE.
.* IF THE USER DOES NOT SPECIFY WHAT REGISTER HE REQUIRES FOR A BASE,
.* TWELVE IS USED.  NOTE..IF REG= IS SPECIFIED TO BE 0, 1, 13, 14, OR
.* 15  A WARNING MESSAGE IS ISSUED.
.* IF THE USER SPECIFIES A SAVE AREA VIA THE SAVE= OPERAND THEN PRIME
.* WILL CHAIN THE USERS SAVE AREA TO THE CALLERS SAVE AREA. IF THE
.* USER DOES NOT SPECIFY SAVE,THEN PRIME WILL OBTAIN A NEW SAVE AREA
.* VIA THE GETMAIN SVC.  AN ADDITIONAL AMOUNT OF STORAGE MAY BE
.* OBTAINED AT THIS TIME BY SPECIFIEING THE LV=, OPERAND.  IF LV IS NOT
.* SPECIFIED IN REGISTER NOTATION, 4023 IS THE MAXIMUM VALUE.
.* IF THE USER SPECIFIES SAVE=NONE, PRIME WILL NOT OBTAIN A NEW AREA.
.* REG 13 WILL POINT TO THE NEW 18 WORD SAVE AREA FOLLOWED BY THE EXTRA
.* STORAGE AREA.
         LCLA  &A,&B
         LCLC  &E,&F,&G,&H
         AIF   ('&NAME' EQ '').NONAME
&NAME    DS    0H
.NONAME  ANOP
         AIF   ('&ID' EQ '').CONT4
         AIF   ('&ID' EQ '*').SPEC
&A       SETA  ((K'&ID+2)/2)*2+4
         BAL   15,&A.(0,15)             GET PGM MASK AND BRANCH AROUND
         USING *,&REG
&A       SETA  K'&ID
         DC    AL1(&A)
.CONTB   AIF   (&A GT 32).SPLIT
.CONTAA  AIF   (&A GT 8).BRAK
&E       SETC  '&ID'(&B+1,&A)
         DC    CL&A'&E'
         AGO   .CONT1
.BRAK    ANOP
&E       SETC  '&ID'(&B+1,8)
         DC    CL8'&E'
&B       SETA  &B+8
&A       SETA  &A-8
         AGO   .CONTAA
.SPLIT   ANOP
&E       SETC  '&ID'(&B+1,8)
&F       SETC  '&ID'(&B+9,8)
&G       SETC  '&ID'(&B+17,8)
&H       SETC  '&ID'(&B+25,8)
         DC    CL32'&E.&F.&G.&H'
&B       SETA  &B+32
&A       SETA  &A-32
         AGO   .CONTB
.SPEC    AIF   ('&NAME' EQ '').CSECTN
&E       SETC  '&NAME'
&A       SETA  1
.CONTQ   AIF   ('&E'(1,&A) EQ '&E').LVE
&A       SETA  &A+1
         AGO   .CONTQ
.LVE     ANOP
&B       SETA  ((&A+2)/2)*2+4
         BAL   15,&B.(0,15)             GET PGM MASK AND BRANCH AROUND
         USING *,&REG
         DC    AL1(&A)
         DC    CL&A'&E'
         AGO   .CONT1
.CSECTN  AIF   ('&SYSECT' EQ '').E4
&E       SETC  '&SYSECT'
&A       SETA  1
         AGO   .CONTQ
.E4      IHBERMAC 78,360
.CONT4   ANOP
         BALR  15,0                     R15 NOW CONTAINS PGM MASK
         USING *,&REG
.CONT1   ANOP
         AIF   ('&REG' EQ '0' OR '&REG' EQ '1' OR '&REG' EQ '13').ERR1
         AIF   ('&REG' EQ '14' OR '&REG' EQ '15').ERR1
.CONT3   ANOP
         DS    0H
         STM   14,12,12(13)             SAVE REGS IN CALLERS AREA
         LR    &REG,15                  SET TRUE BASE EQUAL EP
         AIF ('&SAVE' EQ 'NONE').A
         AIF   ('&SAVE' EQ '').C
         AIF   ('&SAVE'(1,1) EQ '(').F
         LA    1,&SAVE                  SET R1 EQ USERS SAVE ADDRESS
         AGO   .D
.F       ANOP
         AIF   ('&SAVE' EQ '(1)').D
         LR    1,&SAVE(1)               PICK UP USERS SAVE AREA
         AGO   .D
.C       ANOP
         AIF   ('&LV'(1,1) EQ '(').E
         AIF   ('&LV' GT '4023').ERR2
         LA    0,&LV.+72(0,0)           PARAMETER FOR GETMAIN
         AGO   .CONT2
.E       ANOP
         AIF   ('&LV' EQ '(0)').CONT2
         LA    0,72(&LV(1).,0)          PARAMETER FOR GETMAIN
.CONT2   ANOP
         BAL   1,*+4                    INDICATE GETMAIN
         SVC   10                       ISSUE SVC 10
         ST    0,0(0,1)                 SAVE LENGTH IN 1ST WORD
.D       ANOP
         XC    4(68,1),4(1)             CLEAR AREA
         ST    1,8(0,13)                CHAIN FORWARD
         ST    13,4(0,1)                CHAIN BACKWARD
         LM    0,1,20(13)               RESET R0 AND R1
         L     13,8(0,13)               SET SAVE AREA REGISTER
.A       ANOP
         MEXIT
.ERR1    MNOTE 'ILLEGAL BASE REGISTER SPECIFIED'
         AGO   .CONT3
.ERR2    MNOTE 'LV GT 4023, LV REQUEST NOT HONORED'
         LA    0,72(0,0)                PARAMETER FOR GETMAIN
         AGO   .CONT2
         MEND
./ ADD  NAME=PRTATTCH
         TITLE 'PRTATTCH ENTHAELT DIE DEFINITIONEN DER ATTACH MAKROS'
*        DIESE COPY ENTHAELT DIE ZUR SUBTASK-ERZEUGUNG
*        NOETIGEN DEFINITIONEN
*
*        AUTOR :   H. FRANZ     MAERZ, APRIL 1978
*   LAST CHANGE:   H. FRANZ     FEBR   1984
*
ATWTOR1  ATTACH EP=PRTWTOR1,SF=L,STAI=STAIEXIT,LPMOD=1,GSPV=1
ATDRUCK  ATTACH EP=BASDRUCK,SF=L,STAI=STAIEXIT,LPMOD=2,GSPV=2
ATALLOC  ATTACH EP=BASALLOC,SF=L,STAI=STAIEXIT,LPMOD=3,GSPV=3
ATVSAMR  ATTACH EP=PRTVSAMR,SF=L,STAI=STAIEXIT,LPMOD=4,GSPV=4
ATPASSW  ATTACH EP=BASPASSW,SF=L,STAI=STAIEXIT,LPMOD=5,GSPV=5
EXTRACT  DC    A(EXTRANS)     EXTRACT CONTROL BLOCK
         DC    F'0'           TCB ADDRESS
         DC    AL1(1)         INDICATES FIELDS=(COMM)
         DC    AL1(0)
         DC    AL2(0)
EXTRANS  DC    2F'0'          EXTRACT ANSWER AREA
./ ADD  NAME=PRTMSGS
         TITLE 'PRTMSGS ENTHAELT DIE WTO- UND WTOR-DEFINITIONEN'
*        DIESE COPY ENTHAELT DIE ZUR OPERATOR-KOMMUNIKATION
*        NOETIGEN DEFINITIONEN
*
*        AUTOR :   H. FRANZ     MAERZ, APRIL 1978
*
MSGCONID DC    F'0'           CONSOLID
PRT001   WTOR  'PRT001 AUF ..., GEBEN SIE MIT O=... IHRE SACHBEARBEITER-
               -NUMMER EIN',RPRT001,9,ECB001,MCSFLAG=(REG0),MF=L
RPRT001  DC    CL9' '         REPLYAREA
ECB001   DC    F'0'           ECB FOR REPLY 001
PRT002   WTOR  'PRT002 AUF ..., GEBEN SIE MIT L=... DIE NAECHSTE LISTEN*
               NUMMER EIN',RPRT002,80,ECB002,MCSFLAG=(REG0),MF=L
RPRT002  DC    CL80' '        REPLYAREA FOR PRT002
ECB002   DC    F'0'           ECB FOR REPLY 002
PRT003   WTO   'PRT003 AUF ..., DIE LETZTE ANTWORT WAR FALSCH. (Z. B.  *
               FEHLENDE DRUCKERADRESSE)',                              *
               MCSFLAG=(REG0),MF=L
PRT005   WTO   'PRT005 AUF ..., UNGUELTIGE LISTEN-# ...........  ',    *
               MCSFLAG=(REG0),MF=L
PRT006   WTO   'PRT006 AUF ..., KEINE LISTE IN TABELLE',               *
               MCSFLAG=(REG0),MF=L
PRT007   WTO   'PRT007 AUF ..., L=.........., ,UCS=....,FCB=....,PAP=..*
               ..,PTY=.,CPY=...,SEI=.....,ERL=.....',                  *
               MCSFLAG=(REG0),MF=L
PRT008   WTO   'PRT008 AUF ..., LISTE .......... NICHT IN DM-DATEI',   *
               MCSFLAG=(REG0),MF=L
PRT009   WTO   'PRT009 AUF ..., DYN. ALLOCATION FEHLER FUER .......... *
               R15=.., RCDE=........',                                 *
               MCSFLAG=(REG0),MF=L
PRT010   WTOR  'PRT010 AUF ..., CONTROL-COMMANDS FUER ........, ....C*
               OPY  .... FUER EMPF ...',                               *
               RPRT010,13,ECB010,MCSFLAG=(REG0),MF=L
RPRT010  DC    CL13' '
         DC    C' '           FILLER WITH DELIMITER FUNCTION
ECB010   DC    F'0'           ECB FUER PRT010
PRT011   WTO   'PRT011 AUF ..., DSN=.................... FUER ....*
               ...... FALSCHER UNIT-TYP ........',                     *
               MCSFLAG=(REG0),MF=L
PRT012   WTOR  'PRT012 AUF ..., GEBEN SIE D=DSNAME, U=UNIT-TYP, V=VOLSE*
               R FUER .......... EIN',                                 *
               RPRT012,64,ECB012,                                      *
               MCSFLAG=(REG0),MF=L
RPRT012  DC    CL64' '
ECB012   DC    F'0'
PRT013   WTO   'PRT013 AUF ..., DSN=.................... FUER ....*
               ...... NICHT IM KATALOG',                               *
               MCSFLAG=(REG0),MF=L
PRT014   WTO   'PRT014 AUF ..., ............ FALSCHES CONTROL-COMMAND',*
               MCSFLAG=(REG0),MF=L
PRT015   WTO   'PRT015 AUF ..., RETURN-CODE FROM SMF SVC IS ..',       *
               MCSFLAG=(REG0),MF=L
PRT016   WTO   'PRT016 AUF ..., D=, U= ODER V= ERWARTET, .......... GEF*
               UNDEN',                                                 *
               MCSFLAG=(REG0),MF=L
PRT017   WTO   'PRT017 AUF ..., FUER L=.......... WERDEN NUR DIE ERSTEN*
                20 VOLUMES VERARBEITET',                               *
               MCSFLAG=(REG0),MF=L
PRT018   WTO   'PRT018 AUF ..., V=.......... FEHLERHAFT',              *
               MCSFLAG=(REG0),MF=L
PRT019   WTO   'PRT019 AUF ..., LESE-FEHLER IN DM-DATEI FUER ..........*
                VSAM-FDBK CODE = ......, R15=...',                     *
               MCSFLAG=(REG0),MF=L
PRT020   WTOR  'PRT020 AUF ..., GEBEN SIE MIT L=..........,P=. LISTEN# *
               UND PRIORITAET EIN',                                    *
               RPRT020,20,ECB020,                                      *
               MCSFLAG=(REG0),MF=L
RPRT020  DC    CL20' '
ECB020   DC    F'0'
PRT021   WTO   'PRT021 AUF ..., L=.......... NICHT IN TABELLE',        *
               MCSFLAG=(REG0),MF=L
PRT022   WTOR  'PRT022 AUF ..., GEBEN SIE MIT L=....DIE LISTEN# EIN, DI*
               E ZU CANCELN IST',                                      *
               RPRT022,16,ECB022,                                      *
               MCSFLAG=(REG0),MF=L
RPRT022  DC    CL16' '
ECB022   DC    F'0'
PRT023   WTO   'PRT023 AUF ..., .......... DRUCKT GERADE, SIEHE PRT010'*
               ,MCSFLAG=(REG0),MF=L
PRT024   WTO   'PRT024 AUF ..., DM-INFORMATION FUER ***..........***  '*
               ,MCSFLAG=(REG0),DESC=(2),MF=L
PRT025   WTO   'PRT025 AUF ..., DSN=........1........2........3....*
               ',MCSFLAG=(REG0),DESC=(2),MF=L
PRT026   WTO   'PRT026 AUF ..., BST=.,FCB=....,FLS=(....,...),MOD=(....*
               ,...),OPT=.',                                           *
               MCSFLAG=(REG0),DESC=(2),MF=L
PRT027   WTO   'PRT027 AUF ..., UCS=....,PRM=...,X,PAP=....,FRM=...,FCH*
               =.',                                                    *
               MCSFLAG=(REG0),DESC=(2),MF=L
PRT028   WTO   'PRT028 AUF ..., UNT=......,VOL=(......,......,......,..*
               ....,......)',                                          *
               MCSFLAG=(REG0),DESC=(2),MF=L
PRT029   WTOR  'PRT029 AUF ..., GEBEN SIE VERBESSERUNGEN ODER ''U'' EIN*
               ',RPRT029,80,ECB029,                                    *
               MCSFLAG=(REG0),MF=L
ECB029   DC    F'0'
RPRT029  DC    CL80' '
         DC    C' '           FILLER AS DILIMITER
PRT030   WTO   'PRT030 AUF ..., .......... FALSCHER PARAMETER',        *
               MCSFLAG=(REG0),MF=L
PRT031   WTOR  'PRT031 AUF ..., LIST# .......... IST SCHON GEDRUCKT, WI*
               EDERHOLUNG ? ''J'' ODER ''N''',                         *
               RPRT031,5,ECB031,                                       *
               MCSFLAG=(REG0),MF=L
RPRT031  DC    CL6' '
ECB031   DC    F'0'
PRT032   WTOR  'PRT032 AUF ..., A C H T U N G  ZUR DRUCKER EINSTELLUNG *
               REPLY ''U''',                                           *
               RPRT032,5,ECB032,                                       *
               MCSFLAG=(REG0),MF=L
RPRT032  DC    CL6' '
ECB032   DC    F'0'
PRT033   WTO   'PRT033 AUF ..., SPANNEN SIE PAPIER .... EIN ',         *
               DESC=(2),                                               *
               MCSFLAG=(REG0),MF=L
PRT034   WTO   'PRT034 AUF ...,            -WECHSEL',                  *
               MCSFLAG=(REG0),MF=L
PRT035   WTO   'PRT035 AUF ..., ENDE DER DATEI BEI SEITE# .......',    *
               MCSFLAG=(REG0),MF=L
PRT036   WTO   'PRT036 AUF ..., CHR=(....,....,....,....),CPY=(...,(...*
               ,222,333,444,555,666,777,888))',                        *
               MCSFLAG=(REG0),DESC=(2),MF=L
PRT037   WTO   'PRT037 AUF ..., SEI=......., ARB=...., LKZ=.',         *
               MCSFLAG=(REG0),DESC=(2),MF=L
PRT038   WTO   'PRT038 AUF ..., ........ ABENDED MIT CC= ....',        *
               MCSFLAG=(REG0),DESC=(2),MF=L
PRT039   WTO   'PRT039 AUF ..., ENDE DER LISTE .......... .... DURCHLAU*
               F, SEITE#=.......',DESC=(2),MCSFLAG=REG0,MF=L
PRT040   WTO   'PRT040 AUF ..., RESTART WAEHREND DER ARBEIT NICHT ERLAU*
               BT',MCSFLAG=REG0,MF=L
PRT041   WTO   'PRT041 AUF ..., CHECKPOINT SATZ WAR LEER',             *
               MCSFLAG=REG0,MF=L
PRT042   WTO   'PRT042 AUF ..., RESTART IN ARBEIT. .. LISTEN IN TABELLE*
               ',MCSFLAG=REG0,MF=L
PRT043   WTO   'PRT043 AUF ..., RESTART VON ... NICHT MOEGLICH, KEIN CH*
               ECKPOINT-SATZ',MCSFLAG=REG0,MF=L
PRT044   WTOR  'PRT044 AUF ..., RESTART MIT LISTE .........., .... DURC*
               HLAUF  ''J'' ODER ''N''',                               *
               RPRT044,05,ECB044,                                      *
               MCSFLAG=(REG0),MF=L
RPRT044  DC    CL05' '
ECB044   DC    F'0'
PRT045   WTO   'PRT045 AUF ..., DIESE ANGABEN FEHLEN DSN=,ARB=,LKZ=,PAP*
               =,PRM=,FCH=,CPY=',MCSFLAG=(REG0),MF=L
PRT046   WTOR  'PRT046 AUF ..., FEHLER AM DRUCKER, GEBEN SIE ''SET'' AU*
               F LETZTE GUTE SEITE ODER ''END''',                      *
               RPRT046,13,ECB046,                                      *
               MCSFLAG=(REG0),MF=L
RPRT046  DC    CL13' '
         DC    C' '           FILLER WITH DELIMITER FUNCTION
ECB046   DC    F'0'
PRT047   WTO   'PRT047 AUF ..., ...... UNGUELTIGER PARAMETER, LISTE ...*
               ....... GELOESCHT  ',MCSFLAG=REG0,MF=L,DESC=(2)
PRT048   WTO   'PRT048 AUF ..., CHECKPOINT NICHT GESCHRIEBEN',         *
               MCSFLAG=REG0,MF=L
PRT049   WTOR  'PRT049 AUF ..., LIST# .......... IST GESTARTET: CUA, WI*
               EDERHOLUNG ? ''J'' ODER ''N''',                         *
               RPRT049,5,ECB049,                                       *
               MCSFLAG=(REG0),MF=L
RPRT049  DC    CL6' '
ECB049   DC    F'0'
PRT050   WTO   'PRT050 AUF ..., FUER .......... IST KEIN CHECKPOINT-SAT*
               Z MEHR DA',MCSFLAG=REG0,MF=L,DESC=(2)
PRT051   WTO   'PRT051 AUF ..., FUER .......... BITTE PASSWORD EINGEBEN*
               ',MCSFLAG=REG0,DESC=(2),MF=L
PRT052   WTO   'PRT052 AUF ..., ..........     SAVED',                 *
               MCSFLAG=REG0,MF=L,DESC=(2)
PRT053   WTOR  'PRT053 AUF ..., .........., WIEVIELE COPIES FUER EMPF .*
               .. ?',                                                  *
               RPRT053,7,ECB053,                                       *
               MCSFLAG=(REG0),MF=L
RPRT053  DC    CL7' ',C' '    DELIMITER
ECB053   DC    F'0'
BLANKS   DC    CL80' '
PRT054   WTO   'PRT054 AUF ..., .......... DRUCKT V O R S P A N N',    *
               MCSFLAG=REG0,MF=L
PRT055   WTO   'PRT055 AUF ..., FUER .......... PASSWORD SYNTAX FALSCH *
               ',MCSFLAG=REG0,DESC=(2),MF=L
PRT056   WTO   'PRT056 AUF ..., FUER .......... UNGULTIGES PASSWORD. RC*
               =  ',MCSFLAG=REG0,DESC=(2),MF=L
PRT057   WTO   'PRT057 AUF ..., JOB=......,PRM=...,.',                 *
               MCSFLAG=(REG0),DESC=(2),MF=L
PRT058   WTO   'PRT058 AUF ..., .......... IST SCHON AUFGESETZT',      *
               MCSFLAG=(REG0),DESC=(2),MF=L
PRT059   WTOR  'PRT059 AUF ..., .........., GEBEN SIE DIE FICHE-NUMMER *
               EIN ',                                                  *
               RPRT010,9,ECB010,                                       *
               MCSFLAG=(REG0),MF=L
PRT060   WTOR  'PRT060 AUF ..., .........., GEBEN SIE TSS-PASSWORD EIN *
               ',                                                      *
               RPRT060,39,0,                                           *
               MCSFLAG=(REG0,NOCPY),MF=L
RPRT060  DC    CL40' '
         DS    0D
         SYSDATE
./ ADD  NAME=PRTSTAIE
STAIEXIT DS    0D
         XSAVE R12,,STAIEXIT,DLEN
         USING SDSECT,R13
         MVI   SW,0           CLEAR THE SWITCH
         CH    R0,=H'12'      IS A SDWA ?
         BE    NOSDWA
         LR    R10,R1         ADDRESS SDWA
         USING SDWA,R10
         L     R3,SDWAABCC    GET THE COMPLETION CODE
         B     LOOKCC         GO TO LOOK AT THE CODE
NOSDWA   EQU   *              NO SDWA WAS CREATED
         OI    SW,NSDWA       INDICATE MISSING SDWA
         LR    R3,R1          LOAD CC INTO REG 3
LOOKCC   EQU   *
         SLL   R3,8           SHIFT DUMP OPTIONS OUT OF REG
         SRL   R3,8           SHIFT BACK
         LR    R4,R3          SAVE CC
         SLL   R4,20          SHIFT OUT SYSTEM CC
         SRL   R4,20          SHIFT BACK
         CR    R4,R3          COMPARE NOW
         BNE   SYSCC          IF R4 IS EMPTY, MUST BE SYSTEM CODE
         CVD   R3,STDW        CONVERT USER CC
         OI    STDW+7,15      FORCE PRINTABLE
         UNPK  CC,STDW        UNPACK THE USER CC
         B     DOWTO          INFORM THE OPERATOR
         SPACE 2
CC913    DS    0F
         DC    XL4'00000913'
SYSCC    EQU   *
         SRL   R3,12          SHIFT SYSTEM CC TO RIGTHMOST BITS OF REG
         C     R3,CC913       IS THIS A 913-ABEND
         BE    RETURN         YES, DON'T TELL TO OPERATOR
         ST    R3,STDW        AND BRING IT TO STORAGE
         UNPK  CC(L'CC+1),STDW(5) UNPACK THE SYSTEM CC
         LA    R1,HEXTAB      PREPARE TR INSTRUCTION
         SH    R1,=H'240'
         TR    CC,0(R1)       TRANSLATE THE SYSTEM CC
DOWTO    EQU   *
         LOAD  EP=PRTMSGS     GET THE MESSAGE CSECT
         LR    R11,R0         ADDRESS IT
         USING PRTMSGS,R11
         TM    SW,NSDWA       IS A SDWA ?
         BO    NOMODUL        NO, DON'T TRY TO MOVE A MODULE NAME
         MVC   PRT038+20(8),SDWANAME MOVE MODUL NAME TO WTO
NOMODUL  EQU   *
         MVC   PRT038+45(L'CC),CC    MOVE CC TO WTO
         L     R0,MSGCONID    GET CONSOLID
         WTO   MF=(E,PRT038)  INFORM OPERATOR
         DELETE EP=PRTMSGS    DELETE THE MESSAGE CSECT
         SPACE 3
RETURN   EQU   *
         XRETURN 0,R          WEITER GEHTS NICHT
HEXTAB   DC    CL16'0123456789ABCDEF'
         LTORG
SDSECT   DSECT
         DS    18F            SAVEAREA
SW       DS    X
NSDWA    EQU   1              INDICATES SDWA IS NOT CREATED
STDW     DS    D
CC       DS    CL4            COMPLETION CODE
         DS    C
         DS    0D
DLEN     EQU   *-SDSECT
         IHASDWA
./ ADD  NAME=PRTTRPRM
** TITLE   TRACE PARMS FOR BASFPRT
** OWNER   128.FRANZ
** LCHNG   08/03/82 13:46:19   Z227128 FRANZ
         MACRO
&NM      PRTTRPRM &PREF=
&NM      DS   0D
&PREF.PACT     DS   F               ACTION TO BE LOGGED
&PREF.PL#      DS   CL12            CURRENT LIST#
&PREF.PTASK    DS   CL4             CURRENT TASK
         MEND
./ ADD  NAME=PRTWORK
         REG
         TITLE 'WORK CONTROL BLOCK FUER DAS DRUCKPROGRAMM BASFPRT'
*
         SPACE 1
SUBTECBS DS    0F             ECB'S FOR THE SUBTASKS
*        ECB'S FUER SUBTASKS
*
ECBWTOR1 DC    F'0'           WAIT FOR SUBTASK PRTWTOR1
ECBVSAMR DC    F'0'           WAIT FOR SUBTASK PRTVSAMR
ECBALLOC DC    F'0'           WAIT FOR SUBTASK PRTALLOC
ECBDRUCK DC    F'0'           WAIT FOR SUBTASK PRTDRUCK
ECBPASSW DC    F'0'           WAIT FOR SUBTASK PRTPASSW
SUBTECBE DS    0F             END OF SUBTASK ECB'S
         SPACE 1
ECBLIST  DS    0D
         DC    A(ECBWTOR1)
         DC    A(ECBVSAMR)
         DC    A(ECBALLOC)
         DC    A(ECBPASSW)
         DC    AL1(128)       END INDICATOR
         DC    AL3(ECBDRUCK)
         SPACE 1
*        ECB'S FUER SUBTASK KOMMUNIKATION
*                   TASK WAITING       TASK POSTING
ECBPSW   DC    F'0'  PRTPASSW          PRTALLOC 0   REQUEST PASSWORD
*                                       CSECT PRTVERIF
ECBDYNAL DC    F'0'  PRTDRUCK          PRTALLOC 0   REQUEST PRINT
*                                      PRTDRUCK 0   CONTINUE (ESTAE)
*                                      PRTPASSW 0   REQUEST PRINT
ECBNXTAL DC    F'0'  PRTALLOC          PRTVSAMR 0   ALLOCATE NEXT LIST
*                                      PRTDRUCK 0   ALLOCATE NEXT LIST
*                                      PRTDRUCK 4   DE-ALLOC EODAD
*                                      PRTDRUCK 8   WRITE SMF ON REST.
*                                      PRTDRUCK 12  DE-ALLOC ON ABEND
ECBSMFRS DC    F'0'  PRTDRUCK          PRTALLOC 0   SMF IS DONE
ECBLISDA DC    F'0'  PRTVSAMR          PRTALLOC 4   DELETE DMRECORD
ECBWRCHK DC    F'0'  PRTWTOR1          PRTVSAMR 0   CHECKPOINT COMPL.
         SPACE 1
SUBTTCBS DS    0D
TCBWTOR1 DC    F'0'
TCBVSAMR DC    F'0'
TCBALLOC DC    F'0'
TCBDRUCK DC    F'0'
TCBPASSW DC    F'0'
         SPACE 2
ADRMSGS  DC    F'0'           ADDRESS OF 'PRTMSGS'-CSECT
         SPACE 1
JOBNAME  DC    CL8' '
STEPNAME DC    CL8' '
INADR    DC    CL3' '
INDEVTYP DC    XL4'0'         DEVICE TYP FROM INPUT UCB
GLOBAL   DC    X'0'           SWITCH FOR COMMUNICATION
ENDREQ   EQU   128            TERMINATION IS REQUESTED
SHUTDOWN EQU   64             IMMEDIATE TERMINATION IS REQUESTED
PSWWAIT  EQU   16             PRTPASSW IS WAITING
WTORWAIT EQU   8              PRTWTOR1 IS WAITING
VSAMWAIT EQU   4              PRTVSAMR IS WAITING
ALOCWAIT EQU   2              PRTALLOC IS WAITING
DRUCWAIT EQU   1              PRTDRUCK IS WAITING
ALLWAIT  EQU   15             ALL SUBTASKS ARE WAITING
OUTADR   DC    CL3' '
OPER#    DC    CL3' '         OPERATOR SACHBEARBEITER NUMMER
DRLISTID DC    CL10' '        LIST# BEING PRINTED
CONSOLID DC    F'7'           CONSOL ID FOR WTOR AND WTO
PRTTIOT  DC    F'0'           ADDRESS OF THE TIOT
OUTUCBAD DC    F'0'           ADDRESS OF THE PRINTER UCB
*
WRRECADR DC    F'0'           POINTER TO RECORD ADDRESS
WRENTADR DC    F'0'           POINTER TO ENTRY ADDRESS
CONTRTAB DC    F'0'           CONTROL FIELD FOR TABLE ACCESS
RESERVED DC    F'0'
         SPACE 2
DRDMREC  DC    F'0'           POINTER TO DMRECORD OF LIST PRINTING
DRINDCB  DC    F'0'           POINTER TO CURRENT INPUT DCB
         DS    0D
TRACETAB DC    F'0'           ADDRESS OF INTERNAL TRACE TABLE
SAVWRITE DC    F'0'           ADDRESS OF BTAM ACCESS METHOD MODUL
BTAMDSAD DC    F'0'           ADDRESS OF PRTBTAM WORKAREA
INDCB    DC    F'0'           ADDRESS OF CURRENT INPUT DCB
EXTCOMM  DC    F'0'           ADDR OF COMMUNICATION AREA (EXTRACT)
TRACEADR DC    F'0'           ADDR OF TRACE ROUTINE PRTTRACE
SPARE    DC    6F'-1'
DOMWTOR  DC    F'0'           MSG-ID FOR WRTO010
CURINDCB DC    F'0'           CURRENT INPUT DCB FOR 'PRTPRINT'
CUROUDCB DC    F'0'           CURRENT OUTPUT DCB FOR 'PRTPRINT'
RSTADR   DC    CL3' '
FIRSTTIM DC    C' '           INDICATOR FOR INITIAL CHECKPOINT READ
         SPACE 1
JFCB1    DC    XL176'0'      JFCB FOR INPUT DCB
JFCB2    DC    XL176'0'      JFCB FOR OUTPUT DCB
JFCBEXTN DC    XL176'0'       JFCB EXTENSION
         DS    0D
DMAREA   DS    CL(DMLENGTH)   AREA FOR DMRECORD
         DS    0D
*
* DATA CONTROL BLOCKS.
*
INPUT    DCB   DDNAME=SYSUT1,                                          *
               DSORG=PS,                                               *
               EXLST=INEXIT,                                           *
               MACRF=(GL)
         DC    3F'0'          RESERVED FIELDS
         DC    F'1'           ALLOCATION COUNT FOR THIS DCB
DCBLEN   EQU   *-INPUT
OUTPUT   DCB   DDNAME=IEFRDER,                                         *
               BFTEK=S,                                                *
               BUFNO=1,                                                *
               DSORG=PS,                                               *
               EROPT=ABE,                                              *
               EXLST=OUTEXIT,                                          *
               MACRF=(PM)
         DS    0F
INEXIT   DC    X'07',AL3(JFCB1)
INEXEOV  DC    X'06',AL3(0)          EOVEXIT
INEXBL   DC    X'0B',AL3(0)          BLOCK COUNT EXIT
INEXAB   DC    X'91',AL3(0)          ABEND EXIT
OUTEXIT  DCBEXIT JFCB=JFCB2,                                           *
               OPEN=0
         SPACE 2
DMDDN    DC    CL8'OP023DM'   DDNAME DER DM-DATEI
DMEODAD  DC    H'0'
         TITLE 'STEP-TERMINATION RECORD DESCRIPTION'
SMF4REC  DS    0D
         DC    AL2(SMF4END-SMF4REC)    LENGTH FIELD
         DC    AL2(0)                  FILLER
SMF4FLG  DC    X'0'
SMF4RTY  DC    X'E4' 17.9.80 ='04'     TYPE OF THE RECORD
SMF4TME  DC    XL4'0'                  STEP TERMINATION TIME
SMF4DTE  DC    XL4'0'                  STEP TERMINATION DATE
SMF4SID  DC    XL4'0'                  SYSTEM-ID AND MODEL-NUMBER
SMF4JBN  DC    CL8'BASFPRT'            JOB NAME
SMF4RST  DC    XL4'0'                  READER START TIME
SMF4RSD  DC    XL4'0'                  READER START DATE
SMF4UIF  DC    XL8'0'                  USER FIELD
SMF4STN  DC    X'1'                    STEPNUMBER
SMF4SIT  DC    XL4'0'                  INITIATION TIME
SMF4STID DC    XL4'0'                  INITIATION DATE
SMF4NCI  DC    XL4'0'                  NUMBER OF INPUT CARDS
SMF4SCC  DC    XL2'4000'               STEP COMPLETION CODE = 0
SMF4PRTY DC    X'0'                    JOB PRIORITY
SMF4PGNM DC    CL8'BASFPRT'            PROGRAM NAME
SMF4STNM DC    CL8' '                  STEP-NAME
SMF4RSH0 DC    XL2'0'                  REGION SIZE
SMF4SYST DC    XL2'0'                  LSQA SIZE
SMF4H0ST DC    XL2'0'                  HIARCHY 0 STAORAGE
SMF4RV1  DC    XL6'0'
SMF4SPK  DC    XL1'8'                  STORAGE PROTECTION KEY
SMF4STI  DC    XL1'0'                  TERMINATION INDICATOR
SMF4RV2  DC    XL2'0'
SMF4AST  DC    XL4'0'                  ALLOCATION START TIME
SMF4PPST DC    XL4'0'                  PROGRAM START TIME
SMF4RV3  DC    XL1'0'
SMF4RBT  DC    XL3'0'                  CPU TIME UNDER SRB'S
SMF4RIN  DC    XL2'0'                  RECORD INDICATOR
SMF4RLCT DC    AL2(SMF4PGIN-SMF4FLG)   DISPLACEMENT OF RELOCATE SECTION
SMF4LENN DC    AL2(3*8+2)
SMF4ITYP DC    XL2'0'                  INPUT UNIT TYPE
SMF4ICUA DC    XL2'0'                  INPUT UNIT ADDRESS
SMF4IEXC DC    XL4'0'                  INPUT EXCP COUNT
SMF4OTYP DC    XL2'0'                  OUTPUT UNIT TYPE
SMF4OCUA DC    XL2'0'                  OUTPUT UNIT ADDRESS
SMF4OEXC DC    XL4'0'                  OUTPUT EXCP COUNT
SMF4CTYP DC    XL2'0'                  CHECKPOINT UNIT TYPE
SMF4CCUA DC    XL2'0'                  CHECKPOINT UNIT ADDRESS
SMF4CEXC DC    XL4'0'                  CHECKPOINT EXCP COUNT
SMF4LNTH DC    AL1(SMF4PGIN-*-1)       LENGTH OF ACCOUNTING FIELDS
SMF4SETM DC    XL3'0'                  CPU TIME UNDER TCB
SMF4NAF  DC    X'0'                   NUMBER OF ACCOUNTING FIELDS
SMF4PGIN DC    XL70'0'                 RELOCATE SECTION
SMF4END  EQU   *
         TITLE 'JOB-TERMINATION RECORD DESCRIPTION'
SMF5REC  DS    0D
SMF5LEN  DC    AL2(SMF5END-SMF5REC)   LENGTH FIELD
         DC    H'0'                    FILLER
SMF5FLG  DC    X'0'
SMF5RTY  DC    X'E5' 17.9.80 ='05'     TYPE OF THE RECORD
SMF5TME  DC    XL4'0'                  JOB END TIME
SMF5DTE  DC    XL4'0'                  JOB END DATE
SMF5SID  DC    CL4' '                  SYSTEM ID UND MODEL NUMBER
SMF5JBN  DC    CL8'BASFPRT'            JOB NAME
SMF5RST  DC    XL4'0'                  READER START TIME
SMF5RSD  DC    XL4'0'                  READER START DATE
SMF5UID  DS    XL8'0'                  USER FIELD
SMF5NST  DC    X'1'                    NUMBER OF STEPS
SMF5JIT  DC    XL4'0'                  JOB INITIATION TIME
SMF5JID  DC    XL4'0'                  JOB INITIATION DATE
SMF5NCI  DC    XL4'0'                  NUMBER OF INPUT CARDS ON SYSIN
SMF5JCC  DC    XL2'4000'               JOB COMPLETION CODE  = 0
SMF5PTY  DC    X'0'                    JOB PRIORITY
SMF5RSTT DC    XL4'0'                  READER  START TIME
SMF5RSTD DC    XL4'0'                  READER  START DATE
SMF5JBTI DC    XL1'0'                  JOB TERMINATION INDICATOR
SMF5SMCI DC    XL1'0'                  RESERVED
SMF5TRAN DC    XL4'0'                  JOB TRANSACTION RESIDENCE
SMF5CKRE DC    XL1'0'                  RESERVED
SMF5RDCL DC    XL1'0'                  READER DEVICE CLASS
SMF5RUTY DC    XL1'0'                  READER UNIT TYPE
SMF5JICL DC    C'P'                    INPUT CLASS
SMF5SPK  DC    X'8'                    PROTECTION KEY
SMF5SRBT DC    XL3'0'                  CPU TIME UNDER SRB
SMF5TJS  DC    XL4'0'                  SERVICE UNITS
SMF5TTAT DC    XL4'0'                  TRANSACTION ACTIVE TIME
SMF5RV2  DC    XL4'0'                  RESERVED
SMF5PGNO DC    XL2'0'                  PERFORMANCE GROUP NUMBER
SMF5RV3  DC    XL2'0'                  RESERVED
SMF5TLEN DC    AL1(SMF5END-*-1)        LENGTH OF REST OF RECORD
SMF5PRGN DC    CL20'BASFPRT FRANZ 6390' PROGRAMMERS NAME
SMF5JCPU DC    XL3'0'                  JOB CPU TIME UNDER TCB
SMF5ACTF DC    XL1'7'                  NUMBER OF ACCOUNTING FIELDS
         DC    AL1(L'SMF5ARB#)
SMF5ARB# DC    CL4' '                  ARBEITSNUMMER
         DC    AL1(L'SMF5ROUT)
SMF5ROUT DC    CL3'X99'       ROUTINE  SACHBEARBEITER NUMMER
         DC    AL1(L'SMF5LKZ)
SMF5LKZ  DC    C' '                    LAUFKENNZIFFER
         DC    3AL1(0)        4. 5. 6. ACCT-FIELD ABSENT
         DC    AL1(L'SMF5SB#) 7. PARM = OPERATOR
SMF5SB#  DC    CL3' '         OPERATOR'S IDENTIFIER
*
SMF5END  EQU   *
         TITLE 'BESCHREIBUNG OUTPUT WRITER SMF SATZ'
SMF6REC  DS    0D
         DC    AL2(SMF6END-SMF6REC)
         DC    XL2'0'
SMF6FLG  DC    X'0'
SMF6RTY  DC    X'E6' 13.3.80 USER SMF RECORD EQUAL TO SMF 6 REC
SMF6TME  DC    XL4'0'         TIME RECORD WAS CREATED
SMF6DTE  DC    XL4'0'         DATE RECORD WAS CREATED
SMF6SID  DC    XL4'0'         SYTEM ID UND MODELNUMBER
SMF6JBN  DC    CL8'BASFPRT'   JOBNAME
SMF6RST  DC    XL4'0'         READER START TIME
SMF6RSD  DC    XL4'0'         READER START DATE
SMF6UIF  DS    0CL8           USER INFORMATION
         DC    CL3'PRT'       PROGRAM ID
         DC    C' '           BLANK FIELD
SMF6L#   DC    CL3' '         LIST#
SMF6PFAK DC    X'0'           FAKTOR DES PAPIERSATZES
SMF6OWC  DC    C'P'           SYSOUT CLASS IS SET TO 'C' FOR COM
COMRUN   EQU   C'C'           THIS IS THE INDICATOR FOR 'COM'
SMF6WST  DC    XL4'0'         TIME OF PRINT START
SMF6WSD  DC    XL4'0'         DATE OF PRINT START
SMF6NLR  DC    XL4'0'         OUTPUT LINES
SMF6IOE  DC    X'0'           I/O STATUS INDICATOR
SMF6NDS  DC    X'1'           DATASET COUNT
SMF6FMN  DC    CL4'    '      FORM NUMMER
SMF6PAD1 DC    X'0'           3800 SECTION INDICATOR
SMF6SBS  DC    X'0001'        SUB-SYSTEM BASFPRT
SMF6LN1  DC    AL2(SMF6END-*) REST OF RECORD
SMF6DCI  DC    XL2'0'         DATA SET CONTROL INDICATORS
SMF6JNM  DC    CL4' '        JES2 JOB-NUMMER
SMF6OUT  DC    CL8' '         OUTPUT DEVICE NAME
SMF6FCB  DC    CL4' '
SMF6UCS  DC    CL4' '
SMF6PGE  DC    XL4'0'         PAGE-COUNT
SMF6RTE  DC    XL2'0100'      OUTPUT ROUTING IS LOCAL
SMF6END  EQU   *
*
*              THIS IS THE 3800 SUBSYSTEM SECTION
*
SMF6LN2  DC    AL2(SMF6END2-*) REST OF THE RECORD
SMF6CPS  DC    CL8' '         COPY GROUP PARAMETERS
SMF6CHR  DC    CL16' '        CHARACTER ARRANGEMANT TABLES
SMF6MID  DC    CL4' '         COPY MODIFICATION MODULE ID
SMF6FLI  DC    CL4' '         FLASH IDENTIFIER
SMF6FLC  DC    XL1'0'         FLASH COUNT
SMF6BID  DC    XL1'0'         OPTIONS
SMF6END2 EQU   *
SPARE2   DC    4F'0'
COMRF#   DC    F'0'           FICHE NUMMER BEI COM-OUTPUT RESTART
         DS    0D
         SPACE 1
*        TABELLE FUER LISTEN-NUMMERN
LISTQUE  DS    0D
L#MAXENT DC    H'20'          MAXIMUM ENTRIES DEFINED
L#CURENT DC    H'0'           CURRENT ENTRIES
L#ENTRY  EQU   *
L#LIST#  DC    CL10' '        LIST#
L#CPY    DC    H'0'           COPIES FOR THIS LIST
L#SEI    DC    F'0'           PAGES FOR THIS LIST
L#RSV    DC    F'0'           RESERVED
L#RECADR DC    F'0'           ADDRESS OF ASSOCIATED DMRECORD
L#JFCBAD DC    F'0'           ADDRESS OF ASSOCIATED JFCB + JFCBE
L#PSWCID DC    F'0'           CONSOL-ID FOR PASSWORD INPUT
L#PSWMID DC    F'0'           MESSAGE-ID OF PASSWORD INPUT
L#PSWFL  DC    X'0'           FLAG FOR PASSWORD HANDLING
PWSWTSS  EQU   X'80'          DATASET REQUIRES TSS-PASSWORD HANDLING
         DC    XL13'0'        RESERVED
L#UCS    DC    CL4' '         UCS
L#FORM#  DC    CL4' '         PAPIER#
L#FCB    DC    CL4' '         FCB
L#FLAG   DC    XL1'0'         FLAG BYTE
LSINIT   EQU   X'80'          INDICATES TABLE ENTRY INITIALIZED
LSREAD   EQU   X'40'          INDICATES DMRECORD READ
LSALLOC  EQU   X'20'          INDICATES DATA SET FOR LIST IS ALLOCATED
LSPSW    EQU   X'10'          INDICATES PASSWORD MUST BE VERIFIED
LSPRINT  EQU   X'08'          INDICATES LIST IS BEING PRINTED
LSDONE   EQU   X'04'          INDICATES LIST IS PRINTED
LSDEL    EQU   X'02'          LIST SHOULD BE DELETED
LSREST   EQU   X'01'          LIST IS RESTARTED FROM CHECKPOINT
L#PRTY   DC    XL1'0'         LISTEN PRIORITAET
L#END    DS    0D
L#ENTLEN EQU   *-L#ENTRY
         DC    19XL(L#ENTLEN)'0'      DIE NAECHSTEN 19 ENTRIES
OUTPUTC  DCB   DDNAME=IEFRDER,                                         *
               BFTEK=S,                                                *
               BUFNO=1,                                                *
               DSORG=PS,                                               *
               EROPT=ABE,                                              *
               EXLST=OUTEXIT,                                          *
               MACRF=(PM)
OUTLEN   EQU   *-OUTPUTC
BTAMDCB  DCB   DDNAME=IEFRDER,DSORG=CX,DEVD=BS,MACRF=(R,W),            *
               EXLST=OUTEXIT+4,                                        *
               EROPT=TC,LERB=BTAMERR
BTAMERR  LERB  1
PATCHES  DS    0D
DMMSG    EQU   *
         ORG   SUBTECBS+4088
         SYSDATE
./ ADD  NAME=PURGE
         MACRO
&NAME    PURGE   &LIST
         AIF   ('&LIST' EQ '').E1
&NAME    IHBINNRA  &LIST
         SVC   16                      ISSUE PURGE SVC
         MEXIT
.E1      IHBERMAC  01,147
         MEND
./ ADD  NAME=QSERV
         MACRO
&NAME    QSERV &OP,&CORE,&TTR,&SVC
         AIF   ('&OP' EQ 'JCT').X1
         AIF   ('&OP' EQ 'READ').X2
         MNOTE 8,'INVALID OPERATION'
         MEXIT
.X1      ANOP
&NAME    SR    0,0                INDICATE JCT REQUEST
         AGO   .M2
.X2      ANOP
&NAME    LA    0,&TTR             GET TTR INTO R0
.M2      LA    1,&CORE            GET CORE ADDRESS INTO R1
         LA    15,8               SET SVC SUB CODE
         SLL   15,24              SHIFT SUB CODE INTO LEFT POSITION
         OR    1,15               GET SVC SUB CODE INTO R1
         CNOP  0,4                ENSURE FULLWORD BOUNDARY
         B     *+8                BRANCH AROUND VCON
         DC    V(ARCHSVC)         EXTERNAL REFERENCE
         AIF   ('&SVC' EQ 'SVC').SVC251S
         L     15,*-4             PICK UP START OF ARCHSVC
         EX    0,0(15)            EXECUTE SVC 251
         MEXIT
.SVC251S EX    0,ARCHSVC      EXECUTE SVC 251
         MEND
./ ADD  NAME=RASP
;KJGRG
./ ADD  NAME=RBD
         MACRO
         RBD
RBD      DSECT
*
*        SYMBOLIC DEFINITION OF MVT REQUEST BLOCK FORMATS
*              +   DENOTES SIRB
*              -   DENOTES IRB
*              *   DENOTES PRB
*              .   DENOTES SVRB RESIDENT
*              ,   DENOTES SVRB TRANSIENT
*
RBEXTRNM DS    0XL8           +        ERROR EXIT ROUTINE NAME
*
RBTMFLD  DS    0XL1            -       INDICATORS FOR TIMER RTNS
RBPPSAV  DS    0A              -       PP SAVEAREA ADDR
         DS    0F               *.     RESERVED
RBTABNO  DS    H                  ,    DISPLACEMENT FOR TACT ENTRY
RBRTLNTH DS    H                  ,    ROUTINE LENGTH
*
RBABOPSW DS    F               -*.,    ZERO/RIGHT HALF USER PSW/RTN NM
*
RBWCSA   DS    XL1            +-*.,    WAITCOUNT SAVEAREA
RBSIZE   DS    XL1            +-*.,    SIZE OF RB
RBSTAB   DS    XL2            +-*.,    STATUS AND ATTRIBUTES
*
RBEP     DS    0A             +-       RTN ENTRYPOINT ADDR
RBCDFLGS DS    0XL1             *.     CDE CONTROL FLAGS
RBCDE    DS    0A               *.     ADDR OF CDE FOR MODULE
RBSVTQN  DS    A                  ,    NEXT RB ON TRANS USER QUE
*
RBOPSW   DS    D              +-*.,    OLD PSW
*
         DS    H              +-       RESERVED
RBIQE    DS    H              +-       RQE/IQE LIST ORIGIN
         ORG   *-4
RBUSE    DS    0XL1            -       ATTACH USE COUNT
         DS    0A              -       IQE LIST ORIGIN
         DS    0XL1             *.     RESERVED/ZERO
RBPGMQ   DS    0A               *.     NEXT RB FOR SAME REUS MODULE
RBTAWCSA DS    XL1                ,    OVERLAY WAITCOUNT SAVEAREA
RBSVTTR  DS    XL3                ,    TTR OF SVC ROUTINE
*
RBWCF    DS    0XL1           +-*.,    WAITCOUNT
RBLINK   DS    A              +-*.,    NEXT RB OR TCB ADDR
*
RBGRSAVE DS    16F            +- .,    GENERAL REGISTER SAVEAREA
*              OPTIONAL FIELDS
RBNEXAV  DS    0F              -       NEXT AVAIL IQE
RBEXSAVE DS    F                 .,    EXTENDED SAVEAREA
         DS    0XL1            -       WORK SPACE
         SPACE 2
         MEND
./ ADD  NAME=REG
         MACRO
         REG
*
*        REGISTER EQUATES
*
R0       EQU   0
R1       EQU   1
R2       EQU   2
R3       EQU   3
R4       EQU   4
R5       EQU   5
R6       EQU   6
R7       EQU   7
R8       EQU   8
R9       EQU   9
R10      EQU   10
RA       EQU   R10
R11      EQU   11
RB       EQU   R11
R12      EQU   12
RC       EQU   R12
R13      EQU   13
RD       EQU   R13
R14      EQU   14
RE       EQU   R14
R15      EQU   15
RF       EQU   R15
         SPACE 2
         MEND
./ ADD  NAME=REGI
         MACRO
&NAME    REGI  &A
*
***********************************************************************
*                                                                     *
*         REGISTER EQUATES                                            *
*                                                                     *
***********************************************************************
*
R0       EQU   0
R1       EQU   1
R2       EQU   2
R3       EQU   3
R4       EQU   4
R5       EQU   5
R6       EQU   6
R7       EQU   7
R8       EQU   8
R9       EQU   9
R10      EQU   10
R11      EQU   11
R12      EQU   12
R13      EQU   13
R14      EQU   14
R15      EQU   15
         MEND
./ ADD  NAME=RESTORE
         MACRO
&NAME    RESTORE &LIST
         AIF   ('&LIST' EQ '').E1
&NAME    IHBINNRA  &LIST
         SVC   17                      ISSUE RESTORE SVC
         MEXIT
.E1      IHBERMAC  01,150
         MEND
./ ADD  NAME=ROSFDB
         MACRO
&NM      ROSFDB &PRF=FDB
*        DIESES MACRO BESCHREIBT DIE FEEDBACK AREA DER
*        ROSCOE INTERFACE-ROUTINEN.
&PRF.MBR  DC   CL10' '        MEMBERNAME
&PRF.MOD  DC   CL8' '         NAME OF ACTING MODUL
&PRF.RETC DC   CL2' '         RETURN CODE (PRINTABLE)
&PRF.CNT  DC   XL4'0'         RECORD COUNT
&PRF.TEXT DC   CL26' '        ERROR TEXT FOR RETC ^ 0
         MEND
./ ADD  NAME=SAVEAREA
         MACRO
         SAVEAREA
SAVEAREA DSECT
*
*        FORMAT OF STANDARD SAVEAREA
*
SVERSV   DS    F                       RESERVED
* CHAIN WORDS
SVEHI    DS    A                       SAVEAREA UP CHAIN
SVELO    DS    A                       SAVEAREA DOWN CHAIN
* REGISTER AREA
SVER14   DS    0F                      R14 LOC
SVERE    DS    F
SVER15   DS    0F                      R15 LOC
SVERF    DS    F
SVER0    DS    F                       R0 LOC
SVER1    DS    F                       R1 LOC
SVER2    DS    F                       R2 LOC
SVER3    DS    F                       R3 LOC
SVER4    DS    F                       R4 LOC
SVER5    DS    F                       R5 LOC
SVER6    DS    F                       R6 LOC
SVER7    DS    F                       R7 LOC
SVER8    DS    F                       R8 LOC
SVER9    DS    F                       R9 LOC
SVER10   DS    0F                      R10 LOC
SVERA    DS    F
SVER11   DS    0F                      R11 LOC
SVERB    DS    F
SVER12   DS    0F                      R12 LOC
SVERC    DS    F
         SPACE 2
         MEND
./ ADD  NAME=SBNCOPY
         MACRO
&NM      SBNCOPY &TYPE=DEF,&D=S
         LCLC  &N
&N       SETC  '&NM'
         AIF   ('&TYPE' NE 'DSECT').DEF
&N       DSECT
&N       SETC  ' '
.DEF     ANOP
         SPACE 3
*        DEFINITION EINES EINTRAGS DER SBN-TABELLE
*
&N       DS    0D
&D.COPY   DS    0CL74
*
&D.SBN#   DC    CL3' '         SBN#
&D.SBNNM  DC    CL40' '        NAME OF SBN
&D.SBNB   DC    CL4' '         BAU
&D.SBNZ   DC    CL4' '         ZIMMER
&D.SBNOR  DC    CL12' '        ORG EINHEIT
&D.SBNTL  DC    CL8' '         TELEFON
&D.SBNF   DC    CL3' '         FACH#
*
&D.LGTH   EQU   *-&D.COPY      LENGTH OF TAB-ENTRY
         MEND
./ ADD  NAME=SCANTCB
         MACRO
         SCANTCB &NOSYM
*
*   SCAN TCB SUBTASK CHAIN SUBROUTINE
*
* INPUT  R0    MAIN TCB ADDR
*        R1    ADDR OF TCB HAVING BEEN PROCESSED (ZERO AT INIT ENTRY)
* OUTPUT R1    ADDR OF TCB TO BE PROCESSED NEXT
*        R2    CONTENTS DESTROYED
* EXIT   B     4(0,14) TO PROCESS TCB
*        B     0(0,14) NO MORE TCB'S
*
         AIF   ('&NOSYM' EQ 'NOSYM').NOSYM
* TCB FIELD OFFSETS
TCB      EQU   0                       FOR COMPATIBILITY WITH 'TCB' MAC
TCBNTC   EQU   X'80'                   NEXT TCB ON SAME LEVEL
TCBOTC   EQU   X'84'                   ORIGINATING TCB
TCBLTC   EQU   X'88'                   LAST SUBTASK TCB
*
.NOSYM   ANOP
         AIF   ('&SYSECT' EQ 'SCANTCB').NONAME
SCANTCB  DS    0H
.NONAME  ANOP
         LTR   R1,R1                   CHECK INPUT REG FOR TCB ADDR
         BNZ   SCANTCBT
* INITIAL ENTRY
         LR    R1,R0                   DUPLICATE INPUT REG
         LA    R1,0(0,R1)              ZERO HIGH ORDER BYTE
         LR    R0,R1                   RESTORE INPUT TCB ADDR
SCANTCBL EQU   *
         L     R2,TCBLTC-TCB(0,R1)     LOAD AND
         LA    R2,0(0,R2)              ZERO HIGH ORDER BYTE
         LTR   R2,R2                   CHECK LTC POINTER
         BZ    SCANTCBP                NO SUBTASK, PROCESS
SCANTCBC EQU   *
         LR    R1,R2                   RELOAD REG
         B     SCANTCBL                GO TEST LTC
* SECONDARY ENTRY
SCANTCBT EQU   *
         CLR   R1,R0                   MAIN TCB PROCESSED
         BE    0(0,R14)                YES, TAKE ALL-DONE-EXIT
         L     R2,TCBNTC-TCB(0,R1)     GET NTC PTR
         LA    R2,0(0,R2)              ZERO HIGH ORDER BYTE
         LTR   R2,R2                   MORE TASKS ON THIS LEVEL
         BNZ   SCANTCBC                GO TEST SUBTASKS
         L     R1,TCBOTC-TCB(0,R1)     GET ORIGINATING TASK
SCANTCBP EQU   *
         LA    R1,0(0,R1)              ZERO HIGH ORDER BYTE
         B     4(0,R14)                BRANCH TO PROCESS
         MEND
./ ADD  NAME=SDDB10A
SDDB10A  DSECT
HISTNR   DS    0CL32
SEGSCHL  DS    0CL9
KEN      DS    CL1
SID      DS    CL8
NRBIS    DS    PL4
MAXNR    DS    PL4
         ORG   MAXNR
EDATE    DS    PL4
DKZ      DS    CL1
         ORG   NRBIS
RPW      DS    CL8
UPW      DS    CL8
FILLER   DS    CL7
./ ADD  NAME=SDDB10B
SDDB10B  DSECT
HISTNR   DS    0CL32
SEGSCHL  DS    0CL9
KEN      DS    CL1
SID      DS    CL8
NRBIS    DS    PL4
MAXNR    DS    PL4
DKZ      DS    CL1
ABSTNR   DS    CL2
         ORG   MAXNR
EDATE    DS    PL4
         ORG   NRBIS
RPW      DS    CL8
UPW      DS    CL8
FILLER   DS    CL7
./ ADD  NAME=SDDB11A
SDDB11A  DSECT
IO       DS    CL256
IOE      DS    0CL1
         ORG   IO
IOHISTD  DS    0CL200
IOHISTR  DS    0H
RHDR     DS    0CL56
RLL      DS    AL2
RFF1     DS    AL2
RKEY     DS    0CL13
RHISTID  DS    0CL6
RSG      DS    CL2
RKZ      DS    CL2
RFF2     DS    CL2
RHISTNR  DS    CL7
RDATE    DS    CL10
RTIME    DS    CL8
RABSID   DS    CL8
RFF3     DS    CL6
RFF4     DS    CL7
RHISTDAT DS    CL200
         ORG   IOE
./ ADD  NAME=SDEQHDR
***********************************************************************
* FOD/KI       DATEIBESCHREIBUNG        16.01.1974                    *
* ARBEITSGEBIET : SD,    SACHINDEX: SD01                              *
* SEGMENT : EQHDR, COPY-MEMBER-NAME : SDEQHDR                         *
* SEGMENT-BEZEICHNUNG : VORGANGS-HEADER-SEGMENT                       *
***********************************************************************
         SPACE 2
SDEQHDR  DS    0H
EQHDR    DS    0H
EQLL     DS    H              LAENGENFELD
EQZZ     DS    H
EQTRAN   DS    0CL8           TRANSACTION-CODE
EQTC     DS    CL8            TRANSACTION-CODE
EQTRZCH  DS    C
EQKZPRIM DS    C              KENNZEICHEN PRIMAERNACHRICHT
EQAUSID  DS    CL2            AUSGABEIDENTIFICATION
EQEMPF   DS    CL8            EMPFAENGER NAME
EQABS    DS    CL8            ABSENDER NAME
EQKZINT  DS    C              KENNZEICHEN INTERNE NACHRICHT
EQEGFMT  DS    C              KENNZ. (1=FREIFORM,2=FESTFORM)
EQEPZEIT DS    0CL13          -- EINGANGSZEITPUNKT --
EQJH     DS    CL2                 JAHR      YY
EQTTT    DS    CL3                 TAG       DDD
EQSTD    DS    CL2                 STUNDE    HH
EQMIN    DS    CL2                 MINUTE    MM
EQSEC    DS    CL4                 SEKUNDE   SSTH
EQVTRAN  DS    CL8            VORHERGEHENDER TRANSACTIONCODE
EQLENGTH EQU   *-EQHDR        LAENGE DES COPY'S
         SPACE 5
./ ADD  NAME=SDFELZEI
** TITLE   FEHLER-KOPF-ZEILE
** OWNER   DFI/KS
** LCHNG   07/27/83 10:48:54   H907255 HUEGLY
***********************************************************************
* DFI/KS       DATEIBESCHREIBUNG        27.07.1983                    *
* ARBEITSGEBIET : SD,    SACHINDEX: SD01                              *
* SEGMENT : SDFELZEI     COPY-MEMBER-NAME : SDFELZEI                  *
* SEGMENT-BEZEICHNUNG :  FEHLER-KOPF-ZEILE                            *
***********************************************************************
         SPACE 2
SDFELZEI DS    0Y
FZHDR    DS    0Y
FZLL     DC    Y(157)                  LENGTH OF SEGMENT
FZZZ     DC    Y(0)
FZAUSID  DC    CL03' '                 AUS-ID
FZEMPF   DC    CL08' '                 EMPFAENGER
FZASASTZ DC    CL01' '                 ASA-STEUERZEICHEN
FZVG     DC    CL04' '                 VORGANG
         DC    CL08' '
FZTX1    DC    CL40' '                 TEXT-1
FZKZFELQ DC    CL01' '                 KENNZEICHEN FEHLERDATENBANK
FZTC     DC    CL08' '                 TRANSAKTION-CODE
FZTX2    DC    CL70' '                 TEXT-2
FZLISTNR DC    CL10' '                 LISTEN-NUMMER
FZLENGTH EQU   *-FZHDR
         SPACE 5
./ ADD  NAME=SDFFSECT
** TITLE   SDFFSECT : FREIFORM-STEUER-SCHABLONE
** OWNER   HUEGLY
** LCHNG   11/08/83 10:02:30   H907255 HUEGLY
         MACRO
         SDFFSECT &HDR=,&DED=,&FFZCH=,&FLGHDR=
         SPACE 3
***********************************************************************
*                                                                     *
*        FREIFORM -- STEUERSCHABLONEN -- BESCHREIBUNG                 *
*                                                                     *
***********************************************************************
         AIF   (T'&HDR EQ 'O').DED
         SPACE 2
*=====================================================================*
*                                                                     *
*        TEIL  1    HEADER -- BESCHREIBUNG                            *
*                                                                     *
*=====================================================================*
         SPACE 2
*---------------------------------------------------------------------*
*        TEIL  1.1       FIXE ANGABEN                                 *
*---------------------------------------------------------------------*
         SPACE 1
HEADER   DSECT ,
TABNAME  DS    CL8  NAME DER FREIFORM-STEUERSCHABLONE
GENINDEX DS    X    GENERIERUNGS--INDEX
GENDATE  DS    XL3  GENERIERUNGS--DATUM, FORM YYDDDF (GEPACKT)
FFTYP    DS    X    STELLENANZAHL DER FREIFORM--ZEICHEN
FFTYP1   EQU   X'F1' * 1-STELLIGE FREIFORMZEICHEN
FFTYP2   EQU   X'F2' * 2-STELLIGE FREIFORMZEICHEN
FFTYP3   EQU   X'F3' * 3-STELLIGE FREIFORMZEICHEN
SUBSEGM  DS    X    ANZAHL DER SEGMENTE IN DER IO-COBOL-COPY
SUBSEG0  EQU   X'F0' * NUR HAUPTSEGMENT VORHANDEN
SUBSEG1  EQU   X'F1' * SUBSEGMENT-1 VORHANDEN
SUBSEG2  EQU   X'F2' * SUBSEGMENT-2 VORHANDEN
SUBSEG3  EQU   X'F3' * SUBSEGMENT-3 VORHANDEN
FLDMK    DS    X    FELD-TRENNZEICHEN, DEFAULT X'7B'
SWTREN   DS    X    SCHLUESSELWORT-TRENNZEICHEN, DEFAULT X'7E'
TABMK    DS    X    TABULATOR-ZEICHEN, DEFAULT X'5B'
SEGMK    DS    X    SEGMENT-START-ZEICHEN, DEFAULT X'7C'
KEYSEGM  DS    H    ANZAHL DER FREIFORM--ZEICHEN
KEYTABLE DS    F    OFFSET DER FREIFORMZEICHEN-TABELLE ZU HEADER
DEDTABLE DS    F    OFFSET DED-TABELLE ZU HEADER
         SPACE 1
*---------------------------------------------------------------------*
*        TEIL  1.2       HAUPTSEGMENT--ANGABEN                        *
*---------------------------------------------------------------------*
         SPACE 1
HTYP     DS    X    SEGMENT-TYP-NR HAUPTSEGMENT, KONSTANT X'F0'
         DS    X
HOCCURS  DS    H    OCCURS-EINTRAGUNG, KONSTANT H'1'
HDATLNG  DS    H    LAENGE DES HAUPTSEGMENTES
HFLGLNG  DS    H    LAENGE DES FLAGSEGMENTES
HADRDAT  DS    H    OFFSET HAUPTSEGMENT ZU IO-BEREICH  (MUSS NULL SEIN)
HADRFLG  DS    H    OFFSET FLAGSEGMENT ZU FL-BEREICH
         SPACE 1
*---------------------------------------------------------------------*
*        TEIL  1.3       UNTERSEGMENT-1 -- ANGABEN                    *
*---------------------------------------------------------------------*
         SPACE 1
U1TYP    DS    X    SEGMENT-TYP-NR U1-SEGMENT, X'00'=FEHLT X'F1'=VORH.
         DS    X
U1OCCURS DS    H    OCCURS-EINTRAGUNG AUS IO-BEREICH
U1DATLNG DS    H    LAENGE DES U1-SEGMENTES
U1FLGLNG DS    H    LAENGE DES U1-FLAGSEGMENTES
U1ADRDAT DS    H    OFFSET DES 1. U1-SEGMENTES ZU IO-BEREICH
U1ADRFLG DS    H    OFFSET DES 1. U1-FLAGSEGMENTES ZU FL-BEREICH
         SPACE 1
*---------------------------------------------------------------------*
*        TEIL  1.4       UNTERSEGMENT-2 -- ANGABEN                    *
*---------------------------------------------------------------------*
         SPACE 1
U2TYP    DS    X    SEGMENT-TYP-NR U2-SEGMENT, X'00'=FEHLT X'F2'=VORH.
         DS    X
U2OCCURS DS    H    OCCURS-EINTRAGUNG AUS IO-BEREICH
U2DATLNG DS    H    LAENGE DES U2-SEGMENTES
U2FLGLNG DS    H    LAENGE DES U2-FLAGSEGMENTES
U2ADRDAT DS    H    OFFSET DES 1. U2-SEGMENTES ZU IO-BEREICH
U2ADRFLG DS    H    OFFSET DES 1. U2-FLAGSEGMENTES ZU FL-BEREICH
         SPACE 1
*---------------------------------------------------------------------*
*        TEIL  1.5       UNTERSEGMENT-3 -- ANGABEN                    *
*---------------------------------------------------------------------*
         SPACE 1
U3TYP    DS    X    SEGMENT-TYP-NR U3-SEGMENT, X'00'=FEHLT X'F3'=VORH.
         DS    X
U3OCCURS DS    H    OCCURS-EINTRAGUNG AUS IO-BEREICH
U3DATLNG DS    H    LAENGE DES U3-SEGMENTES
U3FLGLNG DS    H    LAENGE DES U3-FLAGSEGMENTES
U3ADRDAT DS    H    OFFSET DES 1. U3-SEGMENTES ZU IO-BEREICH
U3ADRFLG DS    H    OFFSET DES 1. U3-FLAGSEGMENTES ZU FL-BEREICH
.DED     AIF   (T'&DED EQ 'O').FFZCH
         SPACE 2
*=====================================================================*
*                                                                     *
*        TEIL  2    DATEN-ELEMENT-DESCRIPTOR (DED)--AUFBAU            *
*                                                                     *
*=====================================================================*
         SPACE 2
* START-ADRESSE AUS :  A(HEADER) + DEDTABLE
*
         SPACE 2
*---------------------------------------------------------------------*
*        TEIL  2.1       EMPFANGS-FELD DED                            *
*---------------------------------------------------------------------*
         SPACE 1
DED      DSECT ,
DEDLL    DS    H    LAENGE EMPFANGS-FELD + SENDEFELD DED
DEDEL    DS    H    LAENGE EMPFANGS-FELD DED
DEDECD   DS    X    FELD-CODE EMPFANGSFELD
*              ---> BIT (0 1)
DEDEFLD  EQU   X'80' KONSTANT 1 : EMPFANGSFELD-DED
DEDEJUST EQU   X'40' JUSTAGE  0 LINKSBUENDIG
*                             1 RECHTSBUENDIG
*              ---> BIT (2 3)          *RESERVED
*              ---> BIT (4 5 6 7)      ERWEITERUNG VON DEDSCD
DEDEIG9  EQU   X'08'                   ON : IGNORIERE FLAG(9)
*                                      OFF: SETZE FLAG(9)
DEDESEG  DS    X         SEGMENT--ZUORDNUNG
DEDESEG0 EQU   X'F0'     0 HAUPTSEGMENT
DEDESEG1 EQU   X'F1'     1 U1-SEGMENT
DEDESEG2 EQU   X'F2'     2 U2-SEGMENT
DEDESEG3 EQU   X'F3'     3 U3-SEGMENT
DEDEFLAG DS    H         OFFSET FLAGBYTE ZU U-X-SEGMENT
DEDEDAT  DS    H         OFFSET DATENFELD ZU U-X-SEGMENT
DEDEDTLG DS    H         LAENGE DATENFELD IN BYTES
DEDETYP  DS    X         DATENTYP EMPFANGSFELD
DEDETYPC EQU   C'C'      CHARACTER
DEDETYPF EQU   C'F'      BINAER,FESTKOMMA,WORT
DEDETYPH EQU   C'H'      BINAER,FESTKOMMA,HALBWORT
DEDETYPD EQU   C'D'      GLEITKOMMA,DOPPELWORT
DEDETYPE EQU   C'E'      GLEITKOMMA,WORT
DEDETYPP EQU   C'P'      DEZIMAL,GEPACKT
DEDETYPZ EQU   C'Z'      DEZIMAL,GEZONT
DEDEPREC DS    X         PRECISION, DEZIMAL-STELLEN NACH KOMMA
DEDELTXT DS    X         LAENGE DES MELDETEXTES (EXCL. LAENGE)
DEDETEXT DS    0C        MELDETEXT
         SPACE 1
*---------------------------------------------------------------------*
*        TEIL  2.2       SENDEFELD -- DED                             *
*---------------------------------------------------------------------*
*                        ADRESSIERUNG: A(DEDEL) + DEDEL
         SPACE 1
DEDSEND  DSECT ,
DEDSL    DS    H         LAENGE SENDEFELD-DED
DEDSCD   DS    X         FELD-CODE SENDEFELD 0ALZSVTX
DEDSFLD  EQU   X'80'     0    KONSTANT 0
DEDSFART EQU   X'40'     A    ART DER EINGABE
*                             0    ARITHMETISCH (AD  AB  AH)
*                             1    STRING BZW. TEXT (S  H  M1)
DEDSLDEF EQU   X'20'     L    LAENGENDEFINITION
*                             BEI A=0 (ARITHMETISCHE EINGABE-DATEN)
*                                  0    KEINE LAENGENVORSCHRIFT
*                                  1    MIN-ANGABE (VOR,NACH)-KOMMA
*                             BEI A=1 (STRING BZW TEXT)
*                                  0    L(MIN,MAX)-ANGABE
*                                  1    LFIX(P,Q)-ANGABE
DEDSZSCD EQU   X'10'     Z    ZEICHENSATZ-CODIERUNG
*                             0    ALTERNATIVEN  (H,...)
*                             1    KOMBINATIONEN (S,...  M1(...))
DEDSSCHA EQU   X'08'     S    SCHABLONENSTEUERUNG
*                             0    NEIN          (S,... )
*                             1    JA            (M1(...))
DEDSSTYP EQU   X'04'     V    VERWENDETER SCHABLONEN-TYP (WENN S=1)
*                             0    EINZEL-ZEICHEN (M1-DEFINITION)
*                             1    ZEICHEN-GRUPPEN---NICHT ANWENDBAR---
DEDSTXT  EQU   X'02'     T    TEXT-STEUERUNG (TABULATION  (..,TAB,..))
*                             0    NEIN
*                             1    JA
DEDSLMAX EQU   X'01'     X    MAXIMALE LAENGEN-VORSCHRIFT (WENN A=0)
*                             0    NEIN
*                             1    JA,  (VOR,NACH)-KOMMA
DEDSFST  EQU   X'01'     X    FIX STRING (WENN A=1,Z=1,S=0)
*                             0    NEIN  (BLANK ELIMINIEREN)
*                             1    JA    (BLANK NICHT ELIMINIEREN)
DEDSBED  DS    X         BEDINGUNGEN (BEI A=0)   EPN-----
DEDSEXP  EQU   X'80'     E    EXPONENTIAL-DARSTELLUNG (EXP ANGABE)
*                             0    NICHT ERLAUBT
*                             1    ERLAUBT
DEDSPOSI EQU   X'40'     P    POSITIVE WERTE (+ ANGABE)
*                             0    NICHT VORGESCHRIEBEN
*                             1    VORGESCHRIEBEN
DEDSNEGA EQU   X'20'     N    NEGATIVE WERTE (- ANGABE)
*                             0    NICHT VORGESCHRIEBEN
*                             1    VORGESCHRIEBEN
         ORG   DEDSBED
DEDSFILL DS    X         FUELLZEICHEN (BEI A=1), DEFAULT X'40'
         ORG
DEDSLL1  DS    X         LAENGE 1  STEHT IN DIESEM BYTE DER WERT 'NULL'
*                                  BEDEUTET DIES NICHT LAENGE 'NULL',
*                                  SONDERN 'KEINE ANGABE'.
*                             BEI FELD-CODE (A=0,L=1,X=0)
*                                  MINDESTANZAHL DER ZIFFERN VOR DEM
*                                  KOMMA
*                             BEI  (A=0,L=0,X=1)
*                                  MAX. ANZAHL ZIFFERN VOR KOMMA
*                             BEI  (A=1,L=0)
*                                  MINDEST-ZEICHENANZAHL
*                             BEI  (A=1,L=1)
*                                  FIXE ZEICHENZAHL
*
DEDSLL2  DS    X         LAENGE 2  STEHT IN DIESEM BYTE DER WERT 'NULL'
*                                  BEDEUTET DIES NICHT 'LAENGE NULL',
*                                  SONDERN 'KEINE ANGABE'.
*                             BEI FELD-CODE (A=0,L=1,X=0)
*                                  MINDESTANZAHL DER ZIFFERN NACH DEM
*                                  KOMMA
*                             BEI  (A=0,L=0,X=1)
*                                  MAX. ANZAHL ZIFFERN NACH KOMMA
*                                  LAENGE=0 : KEINE KOMMAST. ZULAESSIG
*                             BEI  (A=1,L=0)
*                                  HOECHST-ZEICHENANZAHL
*                             BEI  (A=1,L=1)
*                                  FIXE ZEICHENANZAHL
DEDSZS   DS    X         ZEICHENSATZ   BEI (A=0,Z=0) DBH-----
DEDSDEZ  EQU   X'80'          D    DEZIMALER ZEICHENSATZ (0-9)
DEDSBIN  EQU   X'40'          B    BINAERER ZEICHENSATZ (0,1)
DEDSHEX  EQU   X'20'          H    HEXADEZIMALER ZEICHENS. (0-9,A-F)
*                                  BEI (A=1,Z=0)
DEDSTHX  EQU   X'08'          HEXADEZIMAL-ZIFFERN, IN HALBBYTES UMSETZ.
*                             BEI  (A=1,Z=1) DGBSTUKN
DEDSZIFF EQU   X'80'          D    DEZIMAL-ZIFFERN (0-9)
DEDSUPCS EQU   X'40'          G    GROSS-BUCHSTABEN (A-Z)
DEDSYMB1 EQU   X'10'          S    SYMBOL1
DEDSYMB2 EQU   X'08'          T    SYMBOL2
DEDSYMB3 EQU   X'04'          U    SYMBOL3
DEDSLOCS EQU   X'02'          K    KLEIN-BUCHSTABEN
DEDSREST EQU   X'01'          N    RESTLICHE ZEICHEN DES ZEICHENSATZES
DEDSBLNK EQU   X'20'          B    BLANK, X'40'
*
DEDSNMSK DS    X         ANZAHL DER MASKENFELDER BEI (A=1,Z=1,S=1,T=0)
DEDSFFZC DS    H         OFFSET FREIFORM-ZEICHEN IN FFZCH-TABELLE
DEDSMASK DS    0X        EINZELZEICHEN-SCHABLONE BEI (V=0)
*                             FUER JEDES ZU TESTENDE EINGABE-ZEICHEN
*                             STEHT EIN SCHABLONEN-BYTE. DIE CODIERUNG
*                             DER EINZELNEN SCHABLONEN-BYTES ERFOLGT
*                             NACH (A=1,Z=1 DBGSTUKN)
.FFZCH   AIF   (T'&FFZCH EQ 'O').CHKFLG
         SPACE 2
*=====================================================================*
*                                                                     *
*        TEIL  3    FREIFORMZEICHEN -- TABELLE  (AUFSTEIGEND SORTIERT)*
*                                                                     *
*=====================================================================*
         SPACE 2
FFTABLE  DSECT ,    ADRESSIERUNG : A(HEADER) + KEYTABLE
*
FFZCH12  DS    CL2       1- UND 2-STELLIGE FREIFORM--ZEICHEN
FFDEDOFF DS    H         A(HEADER) + FFDEDOFF = A(DED)
FFELEM1  EQU   *-FFZCH12
         ORG   FFZCH12
FFZCH3   DS    CL4       3-STELLIGE FREIFORM--ZEICHEN
FFDEDOFS DS    H         A(HEADER) + FFDEDOFS = A(DED)
FFELEM2  EQU   *-FFZCH3
.CHKFLG  AIF   (T'&FLGHDR EQ 'O').END
         SPACE 2
*=====================================================================*
*                                                                     *
*        F L A G - H D R                                              *
*                                                                     *
*=====================================================================*
         SPACE 2
FLGHDR   DSECT ,
FLSUCODE DS    X
FLRCODE  DS    X
FLFFANZ  DS    X
FLFFZCH  DS    3CL3
*********
FL@1ANZ  DS    H
FL@1COD  DS    X
FL@1HIG  DS    X
*********
FL@2ANZ  DS    H
FL@2COD  DS    X
FL@2HIG  DS    X
*********
FL@3ANZ  DS    H
FL@3COD  DS    X
FL@3HIG  DS    X
*********
FLSTART  DS    0C
.END     ANOP
         MEND
./ ADD  NAME=SDFLHDRA
*        FOD/K-ZS   WEBER,G.             SATZBESCHREIBUNG     10.10.79
*        SACHGEBIET                      SD (SORTWARE-DATEN IMS)
*        SATZ                            FEHLER-SATZ HEADER ASM
FEHLHDR  DS    0F
FEHLID   DS    0CL6
SG       DS    CL2
SGNR     DS    CL2
         DC    CL2' '
NR       DC    CL7'0000000'
FELDATUM DS    PL4
ZEIT     DS    PL4
KZLOESCH DC    CL1' '
ABSID    DS    CL8
EMPFID   DS    CL8
KZFLG    DC    CL1' '
FLGNR    DC    CL2'00'
KZALL    DC    CL1' '
KZRPL    DC    CL1' '
./ ADD  NAME=SDFS
         MACRO
&NM      SDFS  &MBR=,&ID=,&GEN=
         GBLA  &N
         GBLB  &A,&B,&C
         GBLC  &NAMEN(256)
         LCLA  &I
         AIF   ('&GEN' EQ 'YES').GENER
         AIF   (NOT &B).PROC
  MNOTE 8,'SDFS--MACRO IGNORED, ALL SDFS-MACROES MUST PRECEED SDFS '
  MNOTE 8,' WITH GEN=YES.....'
         MEXIT
.PROC    ANOP
         AIF   (T'&MBR NE 'O' AND T'&ID NE 'O' AND                     X
               K'&MBR EQ 4 AND K'&ID EQ 2).SETNUM
  MNOTE  8,'SDFS--  MBR= AND/OR ID= KEYWORD INVALID...'
.ERR     ANOP
&C       SETB  1
         MEXIT
.SETNUM  ANOP
&A       SETB  1
&N       SETA  &N+1
         AIF   (&N GT 256).ERR
&NAMEN(&N) SETC '&MBR'.'FS'.'&ID'
         MEXIT
.GENER   ANOP
         AIF   (&A).ONES
  MNOTE 0,'SDFS--MACRO MISSING.....'
  MNOTE 8,'SDFS  WITH GEN=YES  IGNORED.....'
&A       SETB  0
&B       SETB  0
&C       SETB  0
&N       SETA  0
         MEXIT
.ONES    ANOP
&A       SETB  0
&B       SETB  1
         EJECT ,
SDFSXREF CSECT ,
         DC    A(&N)    NBR OF ELEMENTS
.LOOP    ANOP
&I       SETA  &I+1
         SPACE 2
         WXTRN &NAMEN(&I)
         DC    CL8'&NAMEN(&I)'
         DC    A(&NAMEN(&I)),A(0)
         AIF   (&I NE &N).LOOP
         MEND
./ ADD  NAME=SDHISTPM
SDHISTPM DSECT
RETCDE   DS    CL2
ID       DS    CL6
NR       DS    PL4
NRPCBADR DS    A
HIPCBADR DS    A
MESSADDR DS    A
NRFLD    DS    PL4
OLDID    DS    CL6
KZ       DS    CL1
CNTID    DS    CL3
./ ADD  NAME=SDMONRCD
         SPACE 5
         TITLE 'DC MONITOR RECORD FORMATS'
**********************************************************************
*  FORMAT OF BASIC SECTION USED BY ALL OUTPUT RECORDS
**********************************************************************
         SPACE 1
RECORD   DS    0D                       START OF TRACE RECORD
VBSLL    DS    H                        VBS
VBSZZ    DS    H                        RDW
X4E      DS    C                        MONITOR RECORD CODE    @BM03278
OUTCODE  DS    C                        OUTPUT RECORD CODE(SEE INCODE)
FLAGOUT  DS    C                        TRACING OPTIONS FLAG
*              1.......                 MONITOR DATA SET IS OPEN
*              .1......                 MONITOR MODULE HAS BEEN INITIAL
*              ..1.....                 NODE NAME ADDED TO RECORD
*              ...1....                 REGLIN IS A LINE NUMBER
*              ....1...                 TRACING LINE ACTIVITY
*              .....1..                 TRACING SCHEDULER ACTIVITY
*              ......1.                 TRACING APPL. PGM. TO MSG. QUE
*              .......1                 TRACING APPL. PGM. TO DB
REGLIN   DS    C                        REGION ID OR LINE NUMBER
TIME     DS    D                        ENTRY TIME TO MONITOR
GLOBDIS  DS    0F                       DISPATCHER ITASK NR.   @BIA1B
RECSTAT  DS    C                        STATUS FLAG            @BIA1B
STARTCH  EQU   X'01'                    START OF CHAIN STATUS B@BIA1B
         DS    AL3            LOW ORDER 24 BITS DISP. ITASK NUM@BIA1B
ENDBASE  EQU   *                        END OF BASIC MONITOR RECORD
         SPACE 1
***********************************************************************
* FORMAT OF THE TIME STAMP DOUBLE-WORD, USED FOR THE BEGINNING OF
* OF EVERY LOGICAL SEGMENT WHICH IS NOT THE START OF A CHAIN.
***********************************************************************
         SPACE 1
TIMCODE  DS    0CL8                                            @BIA1B
         DS    CL7                      FOR TIME STAMP         @BIA1B
CODEBYTE DS    C                        FOR SLOG CODE          @BIA1B
TIMELEN  EQU   *-TIMCODE                LENGTH OF TIMESTAMP FOR@BIA1B
         SPACE 1
*----------------------------------------------------------------------
* LATCH COUNTER AND IWAIT COUNTER EXTENSION FORMAT (90-L,91-L)
*----------------------------------------------------------------------
         SPACE 1
         ORG   ENDBASE                                         @BA66269
LATCHES  DS    CL22                     LATCHES(SCDLSTAT)      @BA66269
WTCNTIW  DS    CL4                      DISP IWAIT COUNTER     @BA66269
WTCNTIS  DS    CL4                      DISP ISERWAIT COUNTER  @BA66269
ENDLREC  EQU   *                        END OF THIS EXTENSION  @BA66269
         SPACE 5
**********************************************************************
*  MESSAGE SCHEDULER STARTED AND
*  BMP TERMINATION STARTED EXTENSION FORMATS
**********************************************************************
         SPACE 1
         ORG   ENDBASE
REGTIME  DS    XL4                      DEP REG CPU TIME       @BIA1B
MSGDEQ   DS    XL2                      PSTDQCNT(MSGS DQD)     @BIA1B
TLOGEND  EQU   *                        END OF THIS EXTENSION
         SPACE 1
         SPACE 1
**********************************************************************
*  DLA STARTED EXTENSION FORMAT
**********************************************************************
         SPACE 1
         ORG   ENDBASE
PCBNM    DS    CL8                      DBPCBDBD(PCB NAME) OR I/O PCB
FUNC     DS    C                        PSTFUNCT               @BM01253
DLALOGND EQU   *                        END OF THIS EXTENSION
         SPACE 1
**********************************************************************
*  DLA00 ENDED EXTENSION FORMAT
**********************************************************************
         SPACE 1
         ORG   ENDBASE
DLILEV   DS    CL2                      LEVEL REACHED
DLISTC   DS    CL2                      STATUS CODES
DLISEG   DS    CL8                      SEGMENT NAME
DLAEND   EQU   *                        END OF THIS EXTENSION
         SPACE 1
**********************************************************************
*  DLA30 ENDED EXTENSION FORMAT
**********************************************************************
         SPACE 1
         ORG   ENDBASE
DLISTAT  DS    CL2                      STATUS CODES
DLIOEND  EQU   *                        END OF THIS EXTENSION
         SPACE 5
**********************************************************************
*  INTENT FAILURE EXTENTION RECORD FORMAT
**********************************************************************
         SPACE 1
         ORG   ENDBASE
SSTPSB   DS    CL8                      PDIRSYM(PSB SYMBOLIC NAME)
SSTDMB   DS    CL8                      DDIRSYM(DMB SYMBOLIC NAME)
SSTEND   EQU   *                        END OF THIS EXTENSION
         SPACE 1
**********************************************************************
*  SCHEDULER ENDED EXTENSIONS FORMAT (MSG AND BMP)
**********************************************************************
         SPACE 1
         ORG   ENDBASE
SEPSB    DS    CL8                      PDIRSYM(PSB SYMBOLIC NAME)
SESMB    DS    CL8                      SMBTRNCD(TRAN CODE NAME)
SEQCNT   DS    H                        (SMBNQCNT-SMBDQCNT)
*                                       MESSAGES REMAINING QUEUED
MSGDEQ1  DS    F
JOBNAME  DS    CL8
SELN     EQU   *                        END OF THIS EXTENSION
         SPACE 1
**********************************************************************
*  START-UP EXTENSION RECORD FORMAT - SECTIONS 'S', 'E'
**********************************************************************
         SPACE 1
         ORG   ENDBASE
DATEX    DS    CL4                      DATE FROM TIME MACRO
TTIME    DS    CL4                      TIME FROM TIME MACRO
CONFIGX  DS    CL6                      SYSTEM CONFIGURATION DATA
WTONSAPS DS    CL4                      ECB WAIT ON SAPS COUNT
MSSIDN   DS    C                        NO. LOCAL SID'S
MSSIDX   DS    CL15                     VALUES OF LOCAL SIDS   @BIA1B
ENDSTA   EQU   *                        END OF THIS EXTENSION
         SPACE 1
**********************************************************************
*  SCHEDULER IWAIT STARTED EXTENSION FORMAT
**********************************************************************
         SPACE 1
         ORG   ENDBASE
SKIWCODE DS    C                        REASON FOR IWAIT (CODE)    S
SKIWEND  EQU   *                        END OF THIS EXTENSION
         SPACE 1
**********************************************************************
*  COMMUNICATION STARTED (X'40') EXTENSION FORMAT
**********************************************************************
         SPACE 1
         ORG   ENDBASE
COMOPS   DS    CL2                      CLBFLAGS2,3
COMLEN   DS    H                        CHARACTERS RECD./TRANS.
COMDEV   DS    C                        DEVICE CODE
COMPOST  DS    C                   POST-CODE FROM DECB         @BA69257
COMNODE  DS    CL8                      VTAM NODE NAME (OPTIONAL)
COMXEND  EQU   *                        END OF THIS EXTENSION
         SPACE 1
*--------------------------------------------------------------------
* PI ENQUEUE IWAIT STARTED EXTENSION FORMAT
*---------------------------------------------------------------------
         SPACE 1
         ORG   ENDBASE                                         @BA66269
PIWTDMB  DS    CL8                      DMB NAME(DDIRSYM)      @BA66269
PIWTPHYS DS    C                        PHYS SEG CODE          @BA66269
PIWTEND  EQU   *                        END OF THIS EXTENSION  @BA66269
         SPACE 5
**********************************************************************
*  DEADLOCK DETECTED EXTENSION FORMAT
**********************************************************************
         SPACE 1
         ORG   ENDBASE
DEADPST  DS    CL1                      REL ID OF LOSER'S PST
DEADSEG  DS    CL8                      SEGMENT INVOLVED
DEADEND  EQU   *                        END OF THIS EXTENSION
         SPACE 1
**********************************************************************
*  BLOCK LOADER IWAIT STARTED EXTENSION FORMAT
**********************************************************************
         SPACE 1
         ORG   ENDBASE
BLRNAME  DS    CL8                      NAME OF PSB OR DMB
SIZEBLK  DS    CL2                      SIZE OF BLOCK
DBDPSBIN DS    C                        PSB/DBD/INT INDIC. (PSTFNCTN)
*              .....001                 READ DMB FROM ACBLIB
*              .....010                 READ PSB FROM ACBLIB
*              .....011                 READ INTENT AND DMB NAME LISTS
*              .....100                 PI PROCESSING RQUIRED
BLRIOEND EQU   *                        END OF THIS EXTENSION
         SPACE 1
**********************************************************************
*  MESSAGE FORMAT SERVICES IWAIT STARTED EXTENSION FORMAT
**********************************************************************
         SPACE 1
         ORG   ENDBASE
FMTNAME  DS    CL8                      NAME OF MID/MOD/DIF/DOF
FMTSIZE  DS    CL2                      SIZE OF BLOCK
FMTCODE  DS    C                        INDICATOR OF IWAIT TYPE
*              .......0                 BUSY DCB
*              .......1                 I/O
FLOGEND  EQU   *                        END OF THIS EXTENSION
         SPACE 1
**********************************************************************
*  ISAM/OSAM/VSAM/QMGR/HSAM I/O IWAIT STARTED EXTENSION FORMAT
**********************************************************************
         SPACE 1
         ORG   ENDBASE
DDNAME   DS    CL8                      DDNAME OF DATA SET WAITED ON
*                                       OR DBD NAME IN CASE OF VSAM
IOEND    EQU   *                        END OF THIS EXTEN.     @BIA1B
         SPACE 5
**********************************************************************
* MS LINK EXTENSION FORMAT
**********************************************************************
         SPACE 1
         ORG   ENDBASE
MSLINK   DS    C                        REL. LINK ID (LLB NO.)
MSTYPE   DS    C                        LINK TYPE (CTTDEVIC)
MSPREF   DS    CL44                     MS MESSAGE PREFIX
**********************************************************************
*  POOL SPACE FAILURE AND STORAGE IWAIT STARTED EXTENSION RECORD FORMAT
**********************************************************************
         SPACE 1
         ORG   ENDBASE
PDMPOOL  DS    CL4                      POOL NAME (PSB/DMB)
PDMSIZE  DS    XL4                      SIZE BUFFER REQUESTED
PDMEND   EQU   *                        END OF THIS EXTENSION
         SPACE 1
**********************************************************************
*  POOL STATISTICS EXTENSION RECORD FORMAT
**********************************************************************
         SPACE 1
         ORG   ENDBASE
POOLREC  DS    60F                      FILLS OUT WRK AREA TO 256 BYTES
*  EXTENSION FORMATS : ISAM/OSAM : FROM STATVBH CALL
*                    : FORMAT    : FBPSTATS TO FBPNDDC
*                    : QPOOL     : QPOOL TO QPLOGND
*                    :   VSAM    : FROM STATVBH CALL
./ ADD  NAME=SDREGS
** TITLE   SDREGS -- REG,SCA,HC,CC-EQUATES
** OWNER   HUEGLY
** LCHNG   10/26/83 08:08:35   H907255 HUEGLY
*-----   REGISTER -- EQU'S
         MACRO
         SDREGS &SCA=,&ATTR=,&HCODE=,&CCODE=
.*  MACRO NAME=SDREGS,LIBRARY=LU.MACLIB,AUTHOR=(HUEGLY,20963)
         SPACE 1
A        EQU   2
B        EQU   3
C        EQU   4
D        EQU   5
E        EQU   6
F        EQU   7
G        EQU   8
H        EQU   9
I        EQU   10
J        EQU   11
BASE     EQU   12
S        EQU   13
         SPACE 4
         AIF   (T'&SCA EQ 'O').AC
*---------------------------------------------------------------------*
*              SCA-CODES                                              *
*---------------------------------------------------------------------*
@MUST    EQU   X'80'
@FORCE   EQU   X'40'                   FORCE FORMAT WRITE
@ERASE   EQU   X'20'                   ERASE UNPROT BEF. WRITE
@SOUND   EQU   X'10'                   SOUND DEVICE ALARM
@COPY    EQU   X'08'                   COPY TO CANDIDATE PRINTER
@NOPROT  EQU   X'04'                   DO NOT PROTECT SCREEN
.AC      AIF   (T'&ATTR EQ 'O').HC
*---------------------------------------------------------------------*
*              ATTRIBUT-CODES                                         *
*---------------------------------------------------------------------*
@AMUST   EQU   X'80'
@REPL    EQU   X'40'
@PROT    EQU   X'20'
@NUM     EQU   X'10'
@HIGH    EQU   X'08'
@NONDISP EQU   X'04'
@DETECT  EQU   X'02'
@MOD     EQU   X'01'
.HC      AIF   (T'&HCODE EQ 'O').CC
*---------------------------------------------------------------------*
*              HIGHLIGHTING-CODES                                     *
*---------------------------------------------------------------------*
@HCODE   EQU   X'C1'
@HD      EQU   X'00'
@HBLINK  EQU   X'F1'                   BLINK
@HREV    EQU   X'F2'                   REVERSE
@HUL     EQU   X'F4'                   UNDERLINED
.CC      AIF   (T'&CCODE EQ 'O').XEND
*---------------------------------------------------------------------*
*              COLOR-CODES                                            *
*---------------------------------------------------------------------*
@CCODE   EQU   X'C2'
@CD      EQU   X'00'
@BLUE    EQU   X'F1'
@RED     EQU   X'F2'
@PINK    EQU   X'F3'
@GREEN   EQU   X'F4'
@TURQ    EQU   X'F5'
@YELLOW  EQU   X'F6'
@NEUTRAL EQU   X'F7'
.*  MACRO-END
.XEND    ANOP
         MEND
./ ADD  NAME=SD070001
**********************************************************************
*        COPY  SD070001                                              *
*                                                                    *
*              AUTHOR  HUEGLY  D-DFI/KS                              *
**********************************************************************
         SPACE 3
*  CONSTANT----EQU'S
         SPACE 1
BLANK    EQU   X'40'
COMMA    EQU   X'6B'
POINT    EQU   X'4B'
EQUAL    EQU   X'7E'
PAROPEN  EQU   X'4D'
PARCLOSE EQU   X'5D'
         SPACE 3
*--------TABLE CONTROL-BLOCK           **  REGISTER  9  **
DW       DS    D
KORRMSG  DS    F    ADR. KORREKTUR-NACHRICHT = ADR. KEY
PARAMS   DS    F    PARAMETER-LISTE FUER KORRPGM
PTREQHDR DS    A    POINTER TO EQ-HDR (PASSED FROM FURA)
PTRTPCB  DS    A    POINTER TO MODIFY=YES TP-PCB
PTRDPCB  DS    A    POINTER TO DATABASE-PCB
PARM     DS    4F   PARAMETER FUER FURAMLD & TDATE & FURAMSG & CBLTDLI
SAVEAG   DS    7F   SAVE-REG A BIS G
SAVEX    DS    7F
SUBBEGIN DS    F
EBER     DS    F    ADR. EINGABE-BEREICH
LEBER    DS    F    LAENGE EINGABE-BEREICH
KOFFZCH  DS    F    ADR. LAUFENDES KORREKTUR-FFZCH INIT KOROUT
KONEXT   DS    F    NAECHSTES ZU VERARB. BYTE IM KORREKTUR-BEREICH
EBFFZCH  DS    F    FFZCH IM FEHLER-BEREICH
GETADR   DS    F    ADR. DES GETMAIN-ZWISCHEN-SPEICHERS
GETLNG   DS    F    LAENGE GETMAIN-ZWISCHEN-SPEICHER
SEGMADR  DS    F    GESETZT IN KOUSEGM INIT IN
LASTPARM DS    F    ADR LETZTER PARAMETER DER PARAMETERLISTE
GETEBER  DS    F    BEREICHSADR. DER FEHLER-NACHRICHT-ROOT
ENTRYCBL DS    F    ENTRY IN CBLTDLI
KORRBEG  DS    F
SUBLNG   DS    H
SUBRST   DS    H
RESTKO   DS    H    REST-LAENGE IM KORREKTUR-BEREICH INIT KOROUT
KOFFLNG  DS    H    LAENGE ELEMENT IM KORREKTUR-BEREICH
EBFFLNG  DS    H    LAENGE DES DATENELEMENTES
KORRLNG  DS    H    LAENGE KORREKTUR-NACHRICHT
DUMPLINE DS    H
DUMPPAGE DS    H
BLATT    DS    H    BLATT-ZAEHLER
PAGE     DS    H    ZEILEN-ZAEHLER
FFLENGTH DS    H    (1,2,3) - STELLIGE FREIFORM-ZEICHEN
COUNTER  DS    H    ZAEHLER FUER UNTERSEGMENTE
EBCOUNT  DS    H
ROOTLNG  DS    H
BEGINLNG DS    H
         SPACE 3
FURAZEIL DS    0CL86
LENGTH   DS    H    +0   WIRD INITIALISIERT IN KODEFINE
         DS    H    +2
AUSGID   DS    CL2  +4   INITIALISIERT IN KODEFINE
LISTKZ   DS    CL1  +6   INITIALISIERT IN KODEFINE
EMPFID   DS    CL8  +7   INITIALISIERT IN KODEFINE
ASA      DS    CL1  +15  VORSCHUBZEICHEN
ZEILE    DS    CL70 +16
         SPACE 3
         DS    0H
SVZEILE  DS    CL86      SAVE-AREA FUER FURAZEIL (CALLFURA)
         SPACE 3
         DS    0H
WORKQUE  DS    CL104     WORK-AREA BEI AUSGABE IN QUEUE
         SPACE 3
         DS    0H
AQZEILE  DS    0CL119    *
LL       DS    H          *
ZZ       DS    H           *
AUSID    DS    CL2          *   AUSGABE-ZEILE BEI AUSGABE
VERARBKZ DS    CL1          *   AUF DATEN BANK
ROOTKEY  DS    CL11        *
FFSTELL  DS    CL1        *
DATEN    DS    CL100     *
         SPACE 3
SSA      DS    0CL31     *
SEGNAME  DS    CL8        *
LEFTPAR  DS    CL1         *
SEGFLDNM DS    CL8          *      SSA FUER DLI-CALL
RELOP    DS    CL2         *
VALUE    DS    CL11       *
RIGTHPAR DS    CL1       *
         SPACE 3
KORRFSXF DS    CL8       NAME DER FREIFORM-STEUER-SCHABLONE
KORRFLXF DS    CL25      FLAG-SCHABLONE
GUFUNC   DS    CL4       *
GNFUNC   DS    CL4        *   DLI-CALLS
ISRTFU   DS    CL4       *
CHNG     DS    CL4
TRANSCDE DS    CL8       AUS FDB-ROOT (KOINPT) ANFANGSWERT : BLANK
FLAG     DS    CL1       CODE FUER KOERROR
FLDMK    DS    CL1       FELDMARKE (KOINPT)
SEGMK    DS    CL1       SEGMK (KOINPT)
ZEIT     DS    CL8       KOINPT  HH,MM,SS
DATUM    DS    CL10      KOINPT  TT.MM.JJJJ
LSTNUMBR DS    CL8       LISTEN-NUMMER ANFANGSWERT : BLANK (KOINPT)
TST1     DS    CL1       TEST-BYTE
*  BIT-SWITCHES   TST1
WASERROR EQU   1    FEHLERHAFTE KORREKTURDATEN SIND AUFGETRETEN
WASOK    EQU   2    GUELTIGE KORREKTURDATEN SIND AUFGETRETEN
WASLOE   EQU   4    LOESCHEN DER FEHLERNACHRICHT
WASWIED  EQU   8    NEUAUFNAHME FEHLERDATEN
WASONE   EQU   16   NUR EIN ZEICHEN IN DER KORR-MSG
WASMORE  EQU   32   MEHRERE ZEICHEN IN DER KORR-MSG
         SPACE 3
TST2     DS    CL1       TEST-BYTE
*  BIT-SWITCHES   TST2
WASFLDMK EQU   1    FELDMARKE IST AUFGETRETEN
WASUSEGM EQU   2    UNTERSEGMENT-KORREKTUR
WASMOVE  EQU   4    SD070SRT: DATEN SIND STAMMDATEN
         SPACE 3
SEGMZ    DS    CL1       SEGMENT-ZEICHEN (1-2-3)
KEY      DS    CL11      KEY AUS DER KORREKTURNACHRICHT
CBEND    DS    0D
**********************************************************************
DLIEPPRM DC    A(0)       EP-PARMS FROM   I M S
********
DLISWA   DC    X'00'      GLOBAL SWITCH
DLIVALID EQU   1          ......ISRT OUTPUT-MSG
MSGSTOP  EQU   2          ......EOM (STC=QD)
********
         DC    X'000000'    RESERVED
**********************************************************************
./ ADD  NAME=SD111CBL
***      COPY  SD111CBL
***      AUTHOR    HUEGLY, 3159
         SPACE 2
PCBADR   DC    A(0)  IMS-PARAMETER-ADDR.-LIST
PCBIO    DC    A(0)  ADDR. PCBIO
PCBALT   DC    A(0)   MODIFY-YES--PCB
PCBMAST  DC    A(0)  MASTER-TERMINAL-PCB
OPTLIST  DC    CL4' '  FUNKTIONSWAHL  'LIST'=LIST-ONLY, ISRT
EROPTLST DC    CL4' '   EROPT= ACC,SKP,EOV
DFSISDB  DC    CL7'DFSISDB'
DFSISDBV DC    C'0'          VERSION
         SPACE 1
./ ADD  NAME=SD111PRM
*              MASSENSPEICHERAUSLEGUNG :
         GBLA  &ZMSGE
*        ZMSGE     ZAHL DER MSGENTRY'S JE BLOCK => BLOCKL
         GBLA  &LMSGENT
*        LMSGENT   LAENGE EINES MSGENTRY'S
        LCLA   &BLOCKZ
*        BLOCKZ    ZAHL DER BLOECKE FUER TAB2
        LCLA   &BLOCKL
*        BLOCKL    BLOCKLAENGE AUF MASSENSPEICHER
         LCLA  &LBLKSZ
        LCLA   &BITMAP
*        BITMAP    ZAHL BYTES IM ERSTEN BLOCK FUER DIE FREIPLATZV.
*                  IMMER KLEINER ALS BLOCKL - 19  !
         LCLA  &RES
*        RES       NULL-BITS ZU ANFANG DER BITMAP (ZAHL BYTES)
        LCLA   &INITL
*        INITL     ZAHL DER MSGENTRY'S DIE INSTALLIERT WERDEN KOENNEN
         LCLA  &SMBZ
*        SMBZ      ZAHL DER SMB-ENTRY'S
         LCLA  &CNTZ
*        CNTZ      ZAHL DER CNT-ENTRY'S
         LCLA  &SMBL
*        SMBL      LAENGE EINES SMB-ENTRYS
         LCLA  &CNTL
*        CNTL      LAENGE EINES CNT-ENTRYS
*                  SMBL,CNTL  SIND IMS-VERSIONS-ABHAENGIG !!!
*                  SMBZ,CNTZ  SIND VON DER IMS-GENERIERUNG ABH. !!!
&SMBZ    SETA  700
&CNTZ    SETA  500
&SMBL    SETA  68
&CNTL    SETA  48
&LBLKSZ  SETA  1944          BLOCKSIZE DES LOGBANDES
&LMSGENT SETA  32     LAENGE DES MSGENTRY
&BITMAP  SETA  1132     BYTES IN BLOCK1 RESERVIERT
&INITL   SETA  &BITMAP*8
&ZMSGE   SETA  (&LBLKSZ/&LMSGENT)+1
&BLOCKL  SETA  &LMSGENT*&ZMSGE   BLOCKLAENGE  VIELFACHES VON LMSGENT
&BLOCKZ  SETA  (&INITL*&LMSGENT)/&BLOCKL+1
&RES     SETA  (&BLOCKZ/8)+1
*
BLOCKL   EQU   &BLOCKL       BLOCKLAENGE
BLOCKZ   EQU   &BLOCKZ
BITMAP   EQU   &BITMAP       BYTES IN BLOCK 1 RESERVIERT !
RES      EQU   &RES
LMSGENT  EQU   &LMSGENT      LAENGE DES MSGENTRY
INITL    EQU   &INITL            SOVIEL MSGENTRY'S WIE BITS IN MAP
SMBZ     EQU   &SMBZ
CNTZ     EQU   &CNTZ
CNTLNG   EQU   &CNTL
SMBLNG   EQU   &SMBL
LBLKSZ   EQU   &LBLKSZ
./ ADD  NAME=SD523COM
COMMON   DSECT
*********************************************************************
*        COMMON AREA TO ALL ROUTINES                                *
*********************************************************************
         PRINT OFF
         DS    A
SVA1     DC    2F'0',A(SVA2),15F'0'     FIRST SVA
SVA2     DC    F'0',A(SVA1),16F'0'      SECOND SVA
NOTAUT   DC    A(0)                     SEND NOT AUTORIZED MSG
DW       DC    D'0'
TPPCBA   DC    A(0)
PMAST    DC    A(0)                     PRIME MASTER PCB
SMAST    DC    A(0)                     SEC   MASTER PCB
SDCMDPCB DC    A(0)                     MY OWN TRAN PCB
SD524PCB DC    A(0)                     TRAN SD524 (OS-CMDS)
DBPCB1   DC    A(0)                     MY DATABASE
DBPCB2   DC    A(0)                     MY DATABASE AGAIN
*
IOAA     DC    A(0)           A(32K INPUT AREA)
IOSAVA   DC    A(0)           A(137 BYTES AREA)
WLINEA   DC    A(0)           A(137 BYTES AREA)
OUTSEGA  DC    A(0)           A(83  BYTES OUT-AREA)
FSEGA    DC    A(FSEG)        A(FORMAT SEGMENT)
GMA      DC    A(0)           A(45000 BYTES WORKAREA)
GMZ      DC    F'45000'       SIZE OF WORK AREA
GMS      DC    F'5000'        # 9-BYTE ENTRIES WORKAREA
GMA2     DC    A(0)           A(4K WORKAREA FOR DBR-CMD)
BLANK    DC    CL133' '       BLANK LINE
MASK3    DC    X'40202120'
CMDLIST  DS    0F       DESCRIBES THE DECODED COMMAND IN THE IOA
CMDCMD   DS    A,A      ADDR OF 1. CMD-BYTE, LENGTH OF CMD
CMDKEYWD DS    A,A      ADDR OF 1. KEYWORD-BYTE, LENGTH OF KEYWORD
CMDMOD1  DS    A,A      ADDR OF 1. MODIFIER-1 BYTE, LENGTH OF MODIFIER
CMDMOD2  DS    A,A      ADDR OF 1. MODIFIER-2 BYTE, LENGTH OF MODIFIER
CMDMOD3  DS    A,A      ADDR OF 1. MODIFIER-3 BYTE, LENGTH OF MODIFIER
CMDMOD4  DS    A,A      ADDR OF 1. MODIFIER-4 BYTE, LENGTH OF MODIFIER
CMDMOD5  DS    A,A      ADDR OF 1. MODIFIER-5 BYTE, LENGTH OF MODIFIER
CMDMOD6  DS    A,A      ADDR OF 1. MODIFIER-6 BYTE, LENGTH OF MODIFIER
CMDMOD7  DS    A,A      ADDR OF 1. MODIFIER-7 BYTE, LENGTH OF MODIFIER
CMDMOD8  DS    A,A      ADDR OF 1. MODIFIER-8 BYTE, LENGTH OF MODIFIER
CMDMOD9  DS    A,A      ADDR OF 1. MODIFIER-9 BYTE, LENGTH OF MODIFIER
CMDMOD10 DS    A,A      ADDR OF 1. MODIFIER-A BYTE, LENGTH OF MODIFIER
CMDLISTL EQU   *-CMDLIST
FMT      DC    CL8'SD523'
MO2      DC    CL8'DFSMO2'
SEQNR    DC    PL3'0'
GU       DC    CL4'GU'
ISRT     DC    CL4'ISRT'
GCMD     DC    CL4'GCMD'
ICMD     DC    CL4'CMD'
GN       DC    CL4'GN'
GNP      DC    CL4'GNP'
GHNP     DC    CL4'GHNP'
GHU      DC    CL4'GHU'
DLET     DC    CL4'DLET'
REPL     DC    CL4'REPL'
PURGE    DC    CL4'PURG'
SEGAUTH  DC    C'AUTHORIZ'
SEGLIST  DC    C'LIST'
SEGHELP  DC    C'HELP'
SSAHELP  DC    C'CMD     (SEGKEY   ='
SSAHELP1 DC    CL8' ',C')'
SSAHELP2 DC    CL8'HELP',C' '
SSAROOT  DC    CL8'CMD',C'(SEGKEY   ='
SSAROOTK DC    CL8' ',C')'
SSADEP   DC    CL8' '
SSADEPNK DC    C' '
         DC    C'SEGKEY   ='
SSADEPK  DC    CL12' ',C')'
SSAAUTH  DC    CL8'AUTHORIZ'
SSAAUTHN DC    C' '
         DC    C'SEGKEY   ='
SSAAUTHK DC    CL12' ',C')'
SSACOPY  DS    CL19
SSACOPYR DS    CL8,C
SSACOPYD DS    CL8,C
DBSW     DC    X'00'
XSWITSCH DC    X'00'
*
*
         DS    0F
PRFIX    DS    0CL10  *SET BY TRANSACTION INPUT EDIT ROUTINE
PRFXLINE DS    F
PRFXPTRM DS    F
         ORG   PRFIX
PRFXNODE DS    CL8
         ORG
PRFXFLAG DS    X
PRFXFLGB EQU   X'20' BTAM LINE
PRFXFLGV EQU   X'40' VTAM NODE
PRFXFLGM EQU   X'01' MSG FROM MASTER
PRFXFEDT DS    X
PRFXLTRM DS    CL8   LTERM NAME FROM IO-PCB
*
*
ERRORSEG DS    0CL60
         DC    AL2(60),AL2(0),X'15',C'SDCMD FEHLER : '
ERMSGTXT DS    CL40' '
ERRORSE1 DC  AL2(42,0),X'15',C'      FUER MEHR INFORMATION, EINGABE:'
ERRORSE2 DC  AL2(55,0),X'15',C'    ''CLEAR-TASTE'' SDCMD HILFE HILFE ''C
               ENTER-TASTE'''
FSEG     DS    0H
         DC    AL2(44,0),CL6' '
FSEGD    EQU   *
FSEGF    DC    CL9' '
FSEGP1   DC    CL9' '
FSEGP2   DC    CL9' '
FSEGP3   DC    CL9' '
FSEGK    DC    CL8' '
*
         DS    0H
NOTIFYSM DS    A              WRITE TO SEC MAST MSG IN IOA
ISRTMSG  DS    A              ISRT MSG A(MSG) IN R14
EXMVC    MVC   0(0,1),(2)
EXCLC    CLC   0(0,1),0(2)
PXMISS   DS    A              ERROMSG PARM MISSING  PARM# IN R14
ISRTCMD  DS    A              ISRT CMD  A(CMD) IN R14
GCMDCMD  DS    A              GCMD SEGM IN R14
DISMY    DS    A              DIS ASMT  LTERM R14=0=>OK,=4 ^OK
AB999    DS    A
EXITPROC DS    A             SEND PROCESSED MSG AND GU
CHKAUTH  DS    A             CHECK SECCURITY
CAL01 DS A  *CALL  CBLTDLI,(GU,(7),(14),SSAROOT,SSAAUTH),VL
CAL02 DS A  *CALL  CBLTDLI,(GU,(7),(14),SSAROOT,SSAAUTH),VL
CAL03 DS A  *CALL  CBLTDLI,(GU,(7),(14),SSAROOT),VL
CAL04 DS A  *CALL  CBLTDLI,(GNP,(7),(14),SSADEP),VL
CAL05 DS A  *CALL  CBLTDLI,(GN,(7),(14),VL
CAL06 DS A  *CALL  CBLTDLI,(ISRT,(7),(14),SSAROOT,SSADEP),VL
CAL07 DS A  *CALL  CBLTDLI,(ISRT,(7),(14),SSAROOT),VL
CAL08 DS A  *CALL  CBLTDLI,(ISRT,(7),(14),SSAROOT,SSADEP),VL
CAL09 DS A  *CALL  CBLTDLI,(GU,(7),(14),SSAROOT,SSADEP),VL
CAL10 DS A  *CALL  CBLTDLI,(GHU,(7),(14),SSAROOT),VL
CAL11 DS A  *CALL  CBLTDLI,(DLET,(7),(14)),VL
CAL12 DS A  *CALL  CBLTDLI,(GHNP,(7),(14),SSADEP),VL
CAL13 DS A  *CALL  CBLTDLI,(GHU,(7),(14),SSAROOT,SSADEP),VL
CAL14 DS A  *CALL  CBLTDLI,(GHU,(7),(14),SSAROOT,SSADEP),VL
CAL15 DS A  *CALL  CBLTDLI,(REPL,(7),(14),VL
CAL16 DS A  *CALL  CBLTDLI,(GU,(7),(14),SSAHELP),VL
CAL17 DS A  *CALL  CBLTDLI,(GN,(7),(14),SSAHELP),VL
CAL18 DS A  *CALL  CBLTDLI,(GNP,(7),(14),SSADEP),VL
CAL19 DS A  *CALL  CBLTDLI,(ISRT,(5),(14)),VL
CAL20 DS A  *CALL  CBLTDLI,(PURGE,(5)),VL
CAL21 DS A  *CALL  CBLTDLI,(GU,(7),(14),SSAROOT),VL
CAL22 DS A  *CALL  CBLTDLI,(GU,(5),(14),SSACOPY),VL
CAL23 DS A  *CALL  CBLTDLI,(GNP,(7),(14),SSAROOT,SSADEP),VL
CAL24 DS A  *CALL  CBLTDLI,(ISRT,(5),(14),SSACOPY,SSACOPYD),VL
GNSEG    DS  A      GET NEXT INPUT SEGMENT
CHKROOTK DS  A      CHECK ROOTKEY
MOVERK   DS  A      MOVE IT
MOVEDEPK DS  A      MOVE DEP SEGMENT KEY
CHKDEPNM DS  A      CHECK DEP SEGMENT NAME
MOVEDEPN DS  A      MOVE IT
SETLNG   DS  A      SET LENGTH IN OUTPUT SEGM
ROOTNOTF DS  A      SEND ROOT NOT FOUND MSG AND EXIT
DEPNOTF  DS  A      SEND DEP  NOT FOUND MSG AND EXIT
SD523PCB DS  A      SD523-PCB
MODIFPCB DS  A      MODIFY-PCB
PRELOAD  DS  X      1 SD523 IS PRELOADED, 0 NOT
         DS  X      RESERVED
TIMMSEG  DS  H      MAXIMUM TIMERSEGS HELD IN STORE
TIMSEGS  DS  H      ACTUAL  TIMERSEGS HELD IN STORE
TIMSEGA  DS  A      AREA OF TIMERSEGS HELD IN STORE
         EJECT
*
         IDLI  TPCBASE=0
         IDLI  DPCBASE=0
         DISPLAY TYPE=ALL
         USING DBPCB,7
         USING TPCB,10
AREAS    DSECT
IOASAV   DS    0CL138
IOASLL   DS    XL2
IOASZZ   DS    XL2
IOASDATA DS    CL134
*
WLINE    DS    0CL138
WLINELL  DS    XL2
WLINEZZ  DS    XL2
WLINDATA DS    CL134
*
OUTSEG   DS    0CL84
OUTLL    DS    XL2
OUTZZ    DS    XL2
OUTDATA  DS    CL80
*
IOA      DS    0CL138
IOALL    DS    XL2
IOAZZ    DS    XL2
IOADATA  DS    CL134
*
         PRINT ON
         USING COMMON,12
         USING AREAS,8
         USING ENTRY,6
         EJECT
./ ADD  NAME=SD910OLD
*
*        D S N A M E - E L E M E N T
*
VLTDSNDS DSECT
VLTD     DS    0CL22
VLTDSN   DS    CL15                    DSNAME
VLTALTYP DS    CL3                     ALLOCATION TYPE
VLTDSSPC DS    CL4                     SPACE
VLTDSNLN EQU   *-VLTDSNDS              LAENGE DSN-ELEMENT
         ORG   VLTDSN
VLTDSNKA DS    CL1                     KLAMMER AUF
VLTDSNK  DS    CL13                    DSNAME     UEBERLAUF-PLATTE
VLTDSNKZ DS    CL1                     KLAMMER ZU
         SPACE 3
*
*        V O L U M E - T A B E L L E
*
VOLTABDS DSECT
VLTNUM   DS    CL6                     VOLUME SERIAL NUMBER
VLTSPC   DS    CL6                     'SPACE='
VLTFSPC  DS    0CL9                    FREE SPACE ON VOLUME
VLTFCYL  DS    CL4                     CYLINDER
         DS    CL2                     ','
VLTFTRK  DS    CL3                     TRACKS
         DS    CL2                     ','
VLTEXT   DS    CL3                     NUMBER EXTENT ON VOLUME
         DS    CL1                     '/'
VLTBSPC  DS    0CL9                    LARGEST BLOCK ON VOLUME
VLTBCYL  DS    CL4                     CYLINDER
         DS    CL2                     ','
VLTBTRK  DS    CL3                     TRACKS
VLTDBCYL DS    CL4                     DATA BASE CYLINDER ON VOLUME
VLTDBTRK DS    CL4                     DATA BASE TRACKS   ON VOLUME
VLTPCYL  DS    CL4                     RESERVED CYLINDERS FOR DB-DESIGN
VLTPTRK  DS    CL4                     RESERVED TRACKS    FOR DB-DESIGN
VLTDBANZ DS    CL2                     NUMBER OF DATA BASES ON VOLUME
VLTDEVCD DS    CL2                     DEVICE CODE
VLTUADR  DS    CL3                     UNIT ADDRESS
VLTPRELL EQU   *-VOLTABDS              PREFIX LENGTH
VLTDSNAM DS    CL2200                  DSNAME TAB-ELEMENTS
VLTFLDLL EQU   *-VOLTABDS              LENGTH VOLTAB-ELEMENT
         SPACE 3
*
*        S A C H G E B I E T S - T A B E L L E
*
SGTABDS  DSECT
SGTSG    DS    CL4                     SACHGEBIETS NAME
SGTSPACE DS    BL4                     SPACE PRO SACHGEBIET
SGTABLL  EQU   *-SGTABDS               LAENGE SGTAB-ELEMENT
         SPACE 3
*
*        H I L F S - T A B E L L E
*
HITABDS  DSECT
HITNUM   DS    CL6                     VOLUME SERIAL NUMBER
         DS    CL2                     HALBWORTGRENZE
HITVLADR DS    CL4                     ZUGEH. ADR. VOLTAB-ELEMENT
HITABLL  EQU   *-HITABDS               LAENGE HITAB-ELEMENT
./ ADD  NAME=SD910TAB
*
*        D S N A M E - E L E M E N T
*
VLTDSNDS DSECT
VLTD     DS    0CL30
VLTDSN   DS    CL22                    DSNAME
VLTALTYP DS    CL3                     ALLOCATION TYPE
VLTDSSPC DS    CL4                     SPACE
         ORG   VLTDSN
VLTDSNKA DS    CL1                     KLAMMER AUF
VLTDSNK  DS    CL20                    DSNAME     UEBERLAUF-PLATTE
VLTDSNKZ DS    CL1                     KLAMMER ZU
         ORG
VLTNDBKZ DS    CL1                     KENNZEICHEN NON DATA BASE
VLTDSNLN EQU   *-VLTDSNDS              LAENGE DSN-ELEMENT
         SPACE 3
*
*        V O L U M E - T A B E L L E
*
VOLTABDS DSECT
VLTNUM   DS    CL6                     VOLUME SERIAL NUMBER
VLTSPC   DS    CL6                     'SPACE='
VLTFSPC  DS    0CL9                    FREE SPACE ON VOLUME
VLTFCYL  DS    CL4                     CYLINDER
         DS    CL2                     ','
VLTFTRK  DS    CL3                     TRACKS
         DS    CL2                     ','
VLTEXT   DS    CL3                     NUMBER EXTENT ON VOLUME
         DS    CL1                     '/'
VLTBSPC  DS    0CL9                    LARGEST BLOCK ON VOLUME
VLTBCYL  DS    CL4                     CYLINDER
         DS    CL2                     ','
VLTBTRK  DS    CL3                     TRACKS
VLTDBCYL DS    CL4                     DATA BASE CYLINDER ON VOLUME
VLTDBTRK DS    CL4                     DATA BASE TRACKS   ON VOLUME
VLTPCYL  DS    CL4                     RESERVED CYLINDERS FOR DB-DESIGN
VLTPTRK  DS    CL4                     RESERVED TRACKS    FOR DB-DESIGN
VLTDBANZ DS    CL2                     NUMBER OF DATA BASES ON VOLUME
VLTNDBAZ DS    CL2                     NUMBER OF NON DATA BASES
VLTDEVCD DS    CL2                     DEVICE CODE
VLTUADR  DS    CL3                     UNIT ADDRESS
VLTPRELL EQU   *-VOLTABDS              PREFIX LENGTH
VLTDSNAM DS    (TABDSELM*VLTDSNLN)CL1  DSNAME TAB-ELEMENTS
VLTFLDLL EQU   *-VOLTABDS              LENGTH VOLTAB-ELEMENT
         SPACE 3
*
*        S A C H G E B I E T S - T A B E L L E
*
SGTABDS  DSECT
SGTSG    DS    CL4                     SACHGEBIETS NAME
SGTSPACE DS    BL4                     SPACE PRO SACHGEBIET
SGTABLL  EQU   *-SGTABDS               LAENGE SGTAB-ELEMENT
         SPACE 3
*
*        H I L F S - T A B E L L E
*
HITABDS  DSECT
HITNUM   DS    CL6                     VOLUME SERIAL NUMBER
         DS    CL2                     HALBWORTGRENZE
HITVLADR DS    CL4                     ZUGEH. ADR. VOLTAB-ELEMENT
HITABLL  EQU   *-HITABDS               LAENGE HITAB-ELEMENT
./ ADD  NAME=SD929001
         MACRO
         SD929001 &PGM=UP
*   USER AND AUTHOR:  H. FRANZ TEL. 3159           JULY  1971
         AIF   ('&PGM' EQ  'MAIN').A
COMMON   DSECT
MAINSVA  DS    18F           MAIN PROGRAM SAVE AREA
         AGO   .B
.A       ANOP
         DS    0D
DUMSECT  DS    18F           MAIN PROGRAM SAVEAREA
.B       ANOP
DOUBLE   DS    D             WORK FIELD FOR DATA CONVERSION
DISCRIPT DS    0CL42         DISCRIPTION OF COBOL FIELD
DLVL     DS    CL2           LEVEL ON COPY CARD
LLVL     DS    CL2           LOGICAL LEVEL OF DATA
DISPLACM DS    CL2           DISPLACEMENT OF DATA FIELD
USAGE    DS    CL1           USAGE OF DATA FIELD
DATANAME DS    CL30          DATANAME ON COPY CARD
ADDRESS  DS    CL3           ACTUAL DISPLACEMENT ON OUTPUT DATA SET
DATALEN  DS    CL2           DATAFIELD LENGTH FOR MEMORY
DATALENG DS    H             DATAFIELD LENGTH  JUST CALCULATED
SAVADR   DS    F             SAVE WORD FOR MULTIPLE USE
DISPLACE DS    F             DISPLACEMENT COUNTER
LOCATION DS    F             LOCATION COUNTER
TABPOINT DS    F             POINTER TO LAST WRITTEN ELEMENT IN TABLE
OUTADDR  DS    F             DISPLACEMENT COUNTER ON OUTPUT DATASET
         AIF   ('&PGM' EQ 'MAIN').C
ADNAME   DS    F             A(COM) INITIATED BY MAIN PROGRAM
FLGDCB   DS    F             A(FLGDCB)
FLGPRTAD DS    F             A(FLGPRT)
TXTDCB   DS    F             A(TABDCB)
         AGO   .D
.C       ANOP
ADNAME   DC    A(NAME)
FLGDCBAD DC    A(FLGDCB)
FLGPRTAD DC    A(FLGPRT)
TXTDCB   DC    A(TABDCB)
.D       ANOP
FLGSEG   DS    F             SAVE WORD FOR FLAGBYTE SEGMENT START
SEGSTART DS    F             SAVE WORD FOR SEGMENT START ADDRESS
LOCA     DS    F
SAVHDSEG DS    F             SAVE WORD FOR SEGMENT HEADER ADDRESS
FLGDISPL DS    F             DISPLACEMENT IN FLAGBYTE TABLE
LOGLVL   DS    0H
LOGLVLPL DS    H             LOGICAL  EVEL OF LAST DATA FIELD
SEGMENT  DS    CL1           SEGMENT INDICATOR BYTE
HSW      DS    CL1           SWITCH BYTE
PRECIS   DS    CL1           BYTE FOR THE PRECISION OF NUMERIC DATA
DATTYP   DS    CL1           DATA TYPE (F,H,D,P,Z,C,...)
         DS    0F
TXTCARD  DS    0CL80         OUTPUT CARD READY FOR LKED INPUT
LKEDID   DS    CL1           (12-2-9)
LKEDID1  DS    CL3           (TXT,RLD,ESD)
         DS    CL1
TXTADR   DS    CL3           DISPLACEMENT OF FOLLOWING IN TXTTXT
         DS    CL2
TXTLEN   DS    CL2           LENGTH OF DATA FOLLOWING
         DS    CL2
TXTID    DS    CL2           ESD IDENTIFICATION (CSECT NUMBER)
TXTTXT   DS    CL56          TEXT
TXTCNT   DS   CL8            COUNT OF DATA CARDS
FLGCARD  DS    CL80
COPYCARD DS    CL80          COPY INPUT AREA
FFCARD   DS    0CL80          INPUT AREA OF FREIFORM STATEMENTS
COPYNAME DS    CL20
MLDTXT   DS    CL30          MELDETEXT
ETYP     DS    CL27          TYP SECIFICATION
FFZ      DS   CL3            FREIFORM-ZEICHEN
         AIF   ('&PGM' EQ 'MAIN').X
         DS    CL1
         AGO   .Y
.X       ANOP
         DC    C' '
.Y       ANOP
         DS    0D
SEGCB    DS    0CL12         SEGMENT CONTROL BLOCK
         AIF   ('&PGM' EQ 'MAIN').E
SEGNR    DS    CL1           SEGMENT NUMMER
SMAX     DS    CL1           MAXIMALE SEGMENT ZAHL
         AGO   .F
.E       ANOP
SEGNR    DC    C'0'
SMAX     DC    C'3'
.F       ANOP
OCCURCNT DS    H             OCCURS COUNT
LGDS     DS    H             LAENGE DES DATEN SEGMENTS
LGFS     DS    H             LAENGE DES FLAG- SEGMENTS
STARTDS  DS    H             START POINT OF DATASEGMENT
STARTFS  DS    H             START POINT OF FLAGSEGMENT
TABLE    DS    12CL42        SPACE FOR MEMORY TABLE
FLGCNT   DC    PL3'0'
         DS    0D
FELD0    DS    0CL56
LUF0     DS    H             LENGTH OF SUBFIELD
FC0      DS    CL1           FIELD CODE
COND     DS    CL1           CONDITIONS
LG1      DS    CL1           LENGTH 1
LG2      DS    CL1           LENGTH 2
ZCHS     DS    CL1           CHARACTER SET
ZSF      DS    CL1           NUMBER OF MASKFIELDS
ADKY     DS    H             RELATIVE ADDRESS OF ASSOCIATED FLAGBYTE
SCHA     DS    CL46          SPACE FOR MASKFIELDS
NAMPOINT DS    F
NAMTAB   DS    F             ADDRESS OF THE GETMAIN AREA FOR NAME-TABLE
NAMTXT   DS    CL10          SPACE FOR ONE ELEMENT OF NAMTAB
FFART    DS    H             FREIFORM ART
         DS    0D
FFTHDR   DS   0CL28          SPACE FOR TABLE HEADER
TABNAM   DS    CL8
GENX     DS    CL1           GENERATION INDEX
DAT      DS    CL3           DATE OF GENERATION
FFCODE   DS    CL1           FF-ART  CHARACTER FORM
TYPZ     DS    CL1           NUMBER OF SEGMENT TYPES
TRN      DS    CL1           FIELD SEPERATION CHARACTER
STRN     DS    CL1           KEYWORD SEPERATION CHARACTER
TAB      DS    CL1           TABULATOR CHARACTER
SEGS     DS    CL1           SUB-SEGMENT-START CHARACTER
KEYZ     DS    H             NUMBER OF ELEMENTS IN NAME TABLE
KADR     DS    F             RELATIVE ADDRESS OF NAME-TABLE
HADR     DS    F             RELATIVE ADDRESS OF MAIN-TABLE
CALLPARM DS    2F            ADDRESS-LIST FOR CALL LUSORT
ANZ      DS    H             NUMBER OF FIELDS TO BE SORTED
FLDLEN   DS    H             LENGTH OF FIELDS TO BE SORTED
ANFG     DS    H             START POINT OF SORT-EXPRESSION
AUFAB    DS    H             INDICATOR OF ORDER OF THE SORT
SORTLEN  DS    H             END POINT OF SORT EXPRESSION
PARAMEND DS    H             END OF SORT PARAMETER LIST
         DS    0D
JFCBAREA DS    CL176
HTAB     DS    F             A(OUTPUT MODULE)
CONDCODE DS    H             CONDITION-CODE
         MEND
./ ADD  NAME=SD933001
* LAST UPDTE  29.11.73  HUEGLY
*              ES ERFOLGT NUR EIN GETMAIN
* C00001:16/12/76:DEFINE LABEL 'MSGLL' (TYPE OF FFMSG-LENGTH)
* C00002:21/01/77:DEFINE NEW SWITCH-BITS FOR FFINSCAN
* C00003:03/02/77:DEFINE LABEL '@MSG' MSG-PRESENT-BIT
* C00004:06/06/77:ADD TWO TRT-TABLES (SKIP X'40' AND FLDMK,FIND FLDMK)
*
         SPACE 5
*  REGISTER----EQU'S
         SPACE 1
         SDREGS ,
         SPACE 5
*  CONSTANTS---EQU'S
         SPACE 1
POINT    EQU   X'4B'
PLUS     EQU   X'4E'
AMPERS   EQU   X'50'
MINUS    EQU   X'60'
COMMA    EQU   X'6B'
BLANK    EQU   X'40'
         SPACE 5
*  DUMMY-SECTIONS---FREIFORM
         SPACE 2
DUMMY    DSECT      -----ADRESSIERT DURCH REG 13-----
SAVEAREA DS    18F       MAIN-SAVEAREA
SAVADMSK DS    F          MASKTAB---ADR. TABCB
         DS    F          ------UNUSED----
TABEND   DS    0D
         SPACE 2
STAB     DS    0D    ----ADRESSIERT DURCH REG  9-----
DW       DS    2D
SAVEAD   DS    4F
OUTPTR   DS    F    WORT1 ADR AUSGABEFELD
FFVALUE  DS    F    WORT2 DATENADRESSE = FFZCH + FFLENGTH
INPTR    DS    F    WORT3 LAUFENDE INPUT-ADR
INCTR    DS    F    WORT4 LAUFENDE LAENGE INPUT
FFZCH    DS    F    WORT5 FF-ZEICHEN IM INPUT
INLNG    DS    F    WORT6 LAENGE DATEN IM INPUT (EBER)
OUTLNG   DS    F    WORT7 LAENGE AUSGABEFELD
WORT8    DS    F    LAENGE DATEN IN ZWBER (NACH ELIMINATION)
MAX      DS    F    FFSTRING  UEBERTRAGENE ZEICHENANZAHL
KOMMA    DS    F    ANZAHL KOMMASTELLEN EINGABE-FELD
EXP      DS    F    GLK-FORM  EXPONENT
ANZAHL   DS    F    FREIFORM-ZEICHEN IN KEY-TABELLE
ATTT     DS    F    LAUFENDES FF-ZEICHEN
ATTTA    DS    F    EMPFANGS-FELD DED
ATTTB    DS    F    SENDE-FELD DED
EBER     DS    F    ADR. INPUT-BEREICH
ABER     DS    F    OUTPUT-BEREICH
LEBER    DS    F    LAENGE INPUT-BEREICH
LABER    DS    F    LAENGE OUTPUT-BEREICH
AFLGTAB  DS    F    FLAG-COPY
TABELLE  DS    F    FREIFORM-STEUER-SCHABLONE
ADRFLAG  DS    F    ADR. FLAG-BYTE
AFFORNOT DS    F    ADR. OB FREIFORM - FESTFORM
CVBVALUE DS    F
COUNTH   DS    H
COUNT1   DS    H    OCCURS - COUNTER
COUNT2   DS    H
COUNT3   DS    H
ELEMEN   DS    H    LAENGE ELEMENTE IN DER KEY-TABELLE
FFLENGTH DS    H    LAENGE FREIFORM-ZEICHEN
PREC     DS    H    PRECISION BEI NUM DATENFELDERN (AUSGABE-FELD)
ZWBER    DS    CL256     ZWISCHEN - BER (FFNUMER, HEXACHAIN)
************************************************************
TST1     DS    CL1  TESTBYTE
*  BIT-SWITCHES IN TST1       FFNUMER
         SPACE 1
WASSIGN  EQU   1
WASPOINT EQU   2
WASZIF   EQU   4
ZIFSIGN  EQU   8
WASFLOAT EQU   32
EXPNEG   EQU   64
WASMIN   EQU   128
************************************************************
TST4     DS    CL1  ZWISCHENSPEICHER - BYTE  HEXA-CHAIN
************************************************************
TST5     DS    CL1
* BIT-SWITCHES IN TST5
         SPACE 1
GT256    EQU   1    DATENELEMENT GT 256 BYTES
NITMOEGL EQU   2    FFSTRING : MASKEN-AUSWAHL NICHT MOEGLICH
WASEND   EQU   4    FFSTRING : ENDE AUFGETRETEN
FIRST    EQU   8    FFSTRING  HEXACHAIN
@SEG     EQU   16   FFINSCAN: CHECK FOR @--PRES..
@DATA    EQU   32   FFINSCAN: DATA PRES. IN @--SEGMENTS
@MSG     EQU   64   FFINSCAN: DATA PRES. IN ENTIRE MSG
************************************************************
FLAG     DS    CL1  FLAG-BYTE
FILLER   DS    CL1
SEGMF    DS    CL1
SEGMZ    DS    X
************************************************************
LFEHL    DS    CL1  TESTBYTE
*  BIT-SWITCHES IN LFEHL
         SPACE 1
WASLOE   EQU   1    LOESCHUNG
WASLAUS  EQU   2    FFSTRING: EINGABE GT AUSGABE
WASGT    EQU   4    FESTFORM : EINGABE GT AUSGABE
WASFLDMK EQU   8    FALLS @ GT OCCURS:SUCHEN NAECHST.-GUELT.@
WASPKD   EQU   16   LIEGT GEPACKTES DATENELEMENT VOR
ENDLOE   EQU   32   LETZTE OCCURS-EINTRAGUNG IN FFLOESCH
WASHSEG  EQU   64
KOMMABIT EQU   128  KOMMASTELLEN EINGABE GT AUSGABE
************************************************************
FFORNOT  DS    CL1  1 = FREIFORM ; 2 = FESTFORM
         DS    X    -----RESERVED----.
         DS    0F
SVA      DS    20F
SVB      DS    18F
TABCB    DS    0D
TABLES   DS    4CL256         SPACE FOR FOUR TABLES
ATAB1    DS    F              A(TABLES)
ATAB2    DS    F
ATAB3    DS    F
ATAB4    DS    F
M1       DS    CL1            MASKS
M2X      DS    CL1
M3X      DS    CL1
M4X      DS    CL1
BLKCNT   DS    H              COUNT
MASKBYTE DS    CL1            PARAMETER MASK
         DS    X      -----RESERVED-----.
MSEND    DS    0D
MSGLL    DS    X      'H':FFMSG LL,ZZ,TEXT  .OR. 'F':FFMSG LLLL,TEXT
         DS    7X     -----RESERVED-----.
         DS    20D    -----RESERVED-----.
SKIPTAB  DS    CL256      SKIP ALL BLANK'S AND FLDMK'S           C00004
FINDTAB  DS    CL256      FIND NEXT FLDMK-CHAR                   C00004
CBEND    DS    0D
ROUT     DS    0D
         SPACE 5
*  HEADER-DUMMY-SECTION
         SPACE 2
HEADER   DSECT      -----ADRESSIERT DURCH REG 10-----...
HAEDER   EQU   *
TABNAME  DS    CL8       +0   TABELLEN-NAME
GENINDEX DS    CL1       +8   GENERIERUNGSINDEX
GENDATE  DS    CL3       +9              -DATUM
FFTYP    DS    CL1      +12   TYP-ANGABE  (1,2,3,S)
SUBSEGM  DS    CL1      +13   ANZAHL DER SUBSEGMENTE (0,1,2,3)
FLDMK    DS    CL1      +14   FELDMARKE  (E0)
SWTREN   DS    CL1      +15   SCHLUESSELWORTTRENNZEICHEN (=)
TABMK    DS    CL1      +16   TABULATOR  ($)
SEGMK    DS    CL1      +17   SEGMENT-START (@)
KEYSEGM  DS    H        +18   ANZAHL FF-ZEICHEN IN KEY-TABELLE
KEYTABLE DS    F        +20   ADR. KEYTABELLE RELAT ZUM HAEDER
DEDTABLE DS    F        +24   ADR. DED-TABELLE RELAT ZUM HAEDER
*  SEGMENT-BESCHREIBUNG
HTYP     DS    CL1      +28   SEGMENT-TYP-NR MUSS 'F0' SEIN
         DS    CL1
HOCCURS  DS    H        +30   OCCURS-EINTRAGUNG MUSS 0 SEIN
HDATLNG  DS    H        +32   LAENGE DATENSEGMENT
HFLGLNG  DS    H        +34         -FLAGSEGMENT
HADRDAT  DS    H        +36   REL. ADR. DAT--SEGM. ZU ABER
HADRFLG  DS    H        +38   REL. ADR. FLG--SEGM. ZU AFLGTAB
U1TYP    DS    CL1      +40                       'F1'
         DS    CL1
U1OCCURS DS    H        +42
U1DATLNG DS    H        +44
U1FLGLNG DS    H        +46
U1ADRDAT DS    H        +48
U1ADRFLG DS    H        +50
*
U2TYP    DS    CL1      +52                       'F2'
         DS    CL1
U2OCCURS DS    H        +54
U2DATLNG DS    H        +56
U2FLGLNG DS    H        +58
U2ADRDAT DS    H        +60
U2ADRFLG DS    H        +62
*
U3TYP    DS    CL1      +64                       'F3'
         DS    CL1
U3OCCURS DS    H        +66
U3DATLNG DS    H        +68
U3FLGLNG DS    H        +70
U3ADRDAT DS    H        +72
U3ADRFLG DS    H        +74
./ ADD  NAME=SD934001
**********                                                   **********
*        FECOPY     DSECT ZU FEHLMLD  --V.B--     02/04/1973          *
*                   DEFINITION DER VARIABLEN                          *
*                                                                     *
* C00001:07/12/76:ADD 20 LINES FOR FURAMLD-CALL, NEW SVA(SVH)         *
* C00002:09/12/76:ADD LABEL 'COMPDONE' FOR FLSHIFT--RTN               *
* C00003:09/12/76:DEFINE 'LINESPP' -- LINES PER PAGE, FILLED BY FLDEF *
* C00004:15/12/76:DEFINE 'MSGLL' TYPE OF FFMSG-LENGTH,FILLED BY FLDEF *
* C00005:25/01/77:DEFINE NEW SWITCHES FOR FLINSCAN(@SEG AND @DATA)    *
*                                                                     *
**********                                                   **********
         SPACE 3
         SDREGS
         SPACE 3
*--- EQU'S
         SPACE 2
BLANK    EQU   X'40'
FECOPY   DSECT
SVA      DS    18F       MAIN--SAVE AREA, BENUTZT IN FLMAIN
SVB      DS    18F       SAVE-AREA FLDEF
SVC      DS    18F                 FLINSCAN
SVD      DS    18F                 FLAGSCAN
SVE      DS    18F                 FLOUT
SVF      DS    18F                 FLSHIFT
SVG      DS    18F   SAVEAREA FOR SUBRTN SD934G                  210575
SVH      DS    18F   SAVEAREA FOR SBRTN SDFLBLD
KILLBEG  EQU   *
FUPARM   DS    F         ADR DER FURA-PARAMETER-LISTE
*
FFMSG    DS    F         A(FFMSG)       LL,ZZ,TEXT  OR  LLLL,TEXT
IOCOPY   DS    F         A(IOCOPY)      COBCOPY
FLCOPY   DS    F         A(FLCOPY)      FLCOPY
FSCOPY   DS    F         A(FSCOPY)      FSCOPY
AEQHDR   DS    F         A(EQHDR)
FEHLKZ   DS    F         A(FEHLKZ)
FURAMLD  DS    F         A(FURAMLD)     ENTRY-POINT ZU FURAMLD
XTABLE   DS    F  ADDR. OF USER FLAG-BYTE-TABLE,IF ZERO:NON      210575
CDETRACE DS    2X TRACE-INDICATOR PRINT TEXT '**  HAUPTSEGMENT..'251076
*                 OR NOT                                         25107
*
CDEOCC   DS    H  CONTAINS LAST OCC OF SUBSEGMENT-INDEX IN TEXT  251076
*                 '** IN SUBSEGMENT X (YY)......'                251076
LINESPP  DS    H                LINES PER PRINTER-PAGE
MSGLL    DS    X     FFMSG-LENGTH-INDICATOR : 'H' OR 'F'
         DS    X     ---UNUSED---
         DS    18F   FOR FUTURE USE                              251076
*
INPTR    DS    F         ADR. NAECHSTES ZEICHEN NACH FF---#
INCTR    DS    F         RESTLAENGE
FFZCH    DS    F         BEGINN FF ZEICHEN
INLNG    DS    F         LAENGE DES DATEN INHALTS
ATT      DS    F
ATTA     DS    F
ATTB     DS    F
ATTT     DS    F
ADRFLAG  DS    F
OUTPTR   DS    F
OUTLNG   DS    F
SUBBEG   DS    F
SUBLNG   DS    F
RTNSUB   DS    F
RTNKILL  DS    F
*
DEDBEG   DS    F
*
RTNUS    DS    F
HAEDEXIT DS    F
PARMA    DS    F
PARMB    DS    3F
DBPARM   DS    F
DW       DS    D
TXTADR   DS    F
FURAEXIT DS    16F
FIXEXIT  DS    F
SHIFTPTR DS    F
CDATA    DS    F
CTIME    DS    F
SHIFTLNG DS    F
FFLENGTH DS    H         LAENGE DER FF ZEICHEN
ELEMEN   DS    H
*
COUNTH   DS    H
COUNT1   DS    H
COUNT2   DS    H
COUNT3   DS    H
*
FLNGHS   DS    H
FLNGS1   DS    H
FLNGS2   DS    H
FLNGS3   DS    H
*
OCCU1    DS    H
OCCU2    DS    H
OCCU3    DS    H
*
PAGE     DS    H
LINE     DS    H
TXTLNG   DS    H
*
BRFLAG   DS    X
*
SWI      DS    X
WASFLDMK EQU   001
COMPDONE EQU   002               COMPACTION PERFORMED IN FLSHIFT
@SEG     EQU   004               VALID @-SUBSEGMENT FOUND
@DATA    EQU   008               DATA FOUND IN THIS @-SUBSEGMENT
*        EQU   016
*        EQU   032
*        EQU   064
*        EQU   128
         SPACE 3
SEGMZ    DS    X
         SPACE 3
SWA      DS    X
WKOPF    EQU   001
         DS    0H
KOPF1    DS    0CL86
HAED1    DS    0CL15
LL1      DS    H              +0   LL=86
         DS    H              +2   ZZ=0
AUSID1   DS    CL2            +4   AUSGABE-ID AUS EQ-HDR
LISTKZ1  DS    C              +6   LIST-KZ
EMPFID1  DS    CL8            +7   EMPFAENGER
ASA1     DS    C              +15  ASA=1
TEXT1    DS    CL40           +16  TEXT1 AUS FEHLKZ
         DS    C              +56
VAL1A    DS    CL10           +57  'EMPFAENGER'
         DS    CL2            +67
EMPF1    DS    CL8            +69  EMPFAENGER-NAME
         DS    CL3            +77
VAL1B    DS    CL3            +80  'BL.'
         DS    C              +83
SEITE    DS    CL2            +84  BLATT-NUMMER
*
*
*
         DS    0H
KOPF2    DS    0CL86
HAED2    DS    0CL15          AUFBAU WIE HAED1
         DS    H
         DS    H
         DS    CL2
         DS    CL1
         DS    CL8
ASA2     DS    C
TC       DS    CL8            TRANSACTION-CODE
         DS    CL2
VORG     DS    CL4            VORGANG
         DS    CL8
DATM     DS    CL10           DATUM   TTT.19JJ
         DS    CL2
UHRZ     DS    CL5
         DS    CL21
LISTNR   DS    CL10           LISTEN-NUMMER
*
*
         DS    0H
KOPF3    DS    0CL86
HAED3    DS    0CL15          AUFBAU WIE HAED1
         DS    H
         DS    H
         DS    CL2
         DS    C
         DS    CL8
ASA3     DS    C
TEXT2    DS    CL70           TEXT2 AUS FEHLKZ
*
*--MELDEZEILE FUER AUSGABE DER FEHLER-MELDUNGEN
*
         DS    0H
MELDZ    DS    0CL86
HAED4    DS    0CL15
         DS    H
         DS    H
         DS    CL2
         DS    C
         DS    CL8
ASA4     DS    C
FEHLAUS  DS    CL70
*
*--- AUSGABEZEILE AUF FEHLER-DATENBANK
*
         DS    0H
DBAUS    DS    0CL119
DBLL     DS    H              LL=119
         DS    H              ZZ=0
DB91     DS    CL2            CONSTANT '91'
DBKZ     DS    C              KENNZEICHEN 'E' ODER 'F'
DBROOT   DS    CL11           KEY AUF FEHLERDATENBANK
DBFFLNG  DS    C              STELLENANZAHL FF
DBTEXT   DS    CL100          --TEXT--  FFMSG
*
EXISNAP  DS    A           EXIT-ADDRESS
*
#LINESCT DS    F            NBR OF LINES FOR FURAMLD--CALL
#LINESPR DS    A            POINTS TO #LINESCT
#LINESAD DS    20A          POINTS TO #LINESDF(1) THRU #LINESDF(20)
#LINESDF DS    20CL120      RESERVE SPACE FOR 20 LINES
#LINESMX EQU   20
*
*
         DS    0D
KILLLNG  EQU   *-KILLBEG
FECPYLN  EQU   *-FECOPY
*
*
         SPACE 5
*
*---HAEDER DSECT   FS-SCHABLONE
*
HAEDER   DSECT      -----ADRESSIERT DURCH REGISTER 10 (I)-----
TABNAME  DS    CL8       +0   TABELLEN-NAME
GENINDEX DS    CL1       +8   GENERIERUNGSINDEX
GENDATE  DS    CL3       +9              -DATUM
FFTYP    DS    CL1       +12  TYP-ANGABE  (1,2,3,S)
SUBSEGM  DS    CL1       +13  ANZAHL DER SUBSEGMENTE (0,1,2,3)
FLDMK    DS    CL1       +14  FELDMARKE  (E0)
SWTREN   DS    CL1       +15  SCHLUESSELWORTTRENNZEICHEN (=)
TABMK    DS    CL1       +16  TABULATOR  ($)
SEGMK    DS    CL1       +17  SEGMENT-START (@)
KEYSEGM  DS    H         +18  ANZAHL FF-ZEICHEN IN KEY-TABELLE
KEYTABLE DS    F         +20  ADR. KEYTABELLE RELAT ZUM HAEDER
DEDTABLE DS    F         +24  ADR. DED-TABELLE RELAT ZUM HAEDER
*  SEGMENT-BESCHREIBUNG
HTYP     DS    CL1       +28  SEGMENT-TYP-NR MUSS 'F0' SEIN
         DS    CL1       +29
HOCCURS  DS    H         +30  OCCURS-EINTRAGUNG MUSS 0 SEIN
HDATLNG  DS    H         +32  LAENGE DATENSEGMENT
HFLGLNG  DS    H         +34        -FLAGSEGMENT
HADRDAT  DS    H         +36  REL. ADR. DAT--SEGM. ZU ABER (IOCOPY)
HADRFLG  DS    H         +38  REL. ADR. FLG--SEGM. ZU AFLGTAB (FLCOPY)
*
U1TYP    DS    CL1       +40                      'F1'
         DS    CL1
U1OCCURS DS    H         +42
U1DATLNG DS    H         +44
U1FLGLNG DS    H         +46
U1ADRDAT DS    H         +48
U1ADRFLG DS    H         +50
*
U2TYP    DS    CL1       +52                      'F2'
         DS    CL1
U2OCCURS DS    H         +54
U2DATLNG DS    H         +56
U2FLGLNG DS    H         +58
U2ADRDAT DS    H         +60
U2ADRFLG DS    H         +62
*
U3TYP    DS    CL1       +64
         DS    CL1
U3OCCURS DS    H         +66
U3DATLNG DS    H         +68
U3FLGLNG DS    H         +70
U3ADRDAT DS    H         +72
U3ADRFLG DS    H         +74
         SPACE 5
./ ADD  NAME=SD971WRK
** TITLE   COPY FUER SD971-SUBROUTINEN
** OWNER   HUEGLY
** LCHNG   02/24/84 14:47:09   H907255 HUEGLY
*=====================================================================*
*        COPY  SD971WRK                                               *
*                                                                     *
*        OWNER HUEGLY  ZLI/KS                                         *
*                                                                     *
*              COMMON WORK-AREA FOR SD971-SUBROUTINES                 *
*=====================================================================*
XEQCC    EQU   1
XEQMM    EQU   2
XEQRR    EQU   3
XEQDD    EQU   4
XEQXX    EQU   5
XEQOO    EQU   6
XEQI     EQU   7
XEQR     EQU   8
XEQC     EQU   9
XEQD     EQU   10
XEQO     EQU   11
XEQM     EQU   12
XEQX     EQU   13
XEQA     EQU   14
XEQB     EQU   15
XEQSSL   EQU   16
XEQSSR   EQU   17
XEQDSL   EQU   18
XEQDSR   EQU   19
XEQU     EQU   20
XEQUU    EQU   21
XEQT     EQU   22
XEQTT    EQU   23
*---------------------------------------------------------------------*
CLPSET   DS    0Y
         TM    GBSWA,GBSWACLP
         BOR   14
         CLC   $DKEY(4),$ACLP
         BNER  14
         OI    GBSWA,GBSWACLP
         MVC   NEWCLP(4),NEWD
         BR    14
*---------------------------------------------------------------------*
CLPSETP  DS    0Y
         TM    GBSWA,GBSWACLP
         BOR   14
         CLC   $DKEY(4),$ACLP
         BNER  14
         OI    GBSWA,GBSWACLP
         MVC   NEWCLP(4),NEWDP
         BR    14
*---------------------------------------------------------------------*
TRRMT001 DS    0F
TXRMT003 DS    0F
FIRMT003 DS    0F
PARMT001 CALL  ,(GHU,,$A,SSA),VL,MF=L
*---------------------------------------------------------------------*
TRRMT002 DS    0F
PARMT002 CALL  ,(DLET,,$A),VL,MF=L
*---------------------------------------------------------------------*
PARMT003 CALL  ,(ISRT,,$A,SSA),VL,MF=L
*---------------------------------------------------------------------*
CYRMT001 DS    0F
PARMT004 CALL  ,(ISRT,,$C,SSA,SSC),VL,MF=L
*---------------------------------------------------------------------*
RFRMT001 DS    0F
RTRMT001 DS    0F
TXRMT001 DS    0F
EDRMT008 DS    0F
FIRMT001 CALL  ,(GU,,$A,SSA),VL,MF=L
*---------------------------------------------------------------------*
FIRMT002 CALL  ,(ISRT,,$F,SSA,SSF),VL,MF=L
*---------------------------------------------------------------------*
RNRMT003 DS    0F                      REPLACE FROM ORIGINAL
TXRMT004 DS    0F
FIRMT004 CALL  ,(REPL,,$A),VL,MF=L
*---------------------------------------------------------------------*
CYRMT002 DS    0F
TXRMT002 CALL  ,(ISRT,,$D,SSA,SSC,SSD),VL,MF=L
*---------------------------------------------------------------------*
RFRMT002 CALL  ,(GNP,,$F,SSA,SSF),VL,MF=L
*---------------------------------------------------------------------*
RTRMT002 CALL  ,(GNP,,$C,SSA,SSC),VL,MF=L
RTRMT003 CALL  ,(GNP,,$D,SSA,SSC,SSD),VL,MF=L
*---------------------------------------------------------------------*
EDRMT001 CALL  ,(GHU,,$D,SSA,SSC,SSD),VL,MF=L
EDRMT002 CALL  ,(REPL,,$D),VL,MF=L
*---------------------------------------------------------------------*
RNRMT001 DS    0F
EDRMT003 CALL  ,(FUNC,,$D,SSA,SSC,SSD),VL,MF=L
*---------------------------------------------------------------------*
EDRMT004 CALL  ,(FUNC,,$F,SSA,SSC,SXD),VL,MF=L
QURMT002 DS    0F
EDRMT005 CALL  ,(FUNC,,$D,SSA,SSC,SXD),VL,MF=L
EDRMT006 CALL  ,(GHU,,$C,SSA,SSC),VL,MF=L
EDRMT007 CALL  ,(DLET,,$C),VL,MF=L
*---------------------------------------------------------------------*
RNRMT002 CALL  ,(GHU,,$F,SSA),VL,MF=L  READ IN DUMMY-AREA
RNRMT005 CALL  ,(ISRT,,,SD071E),VL,MF=L
*---------------------------------------------------------------------*
QURMT001 CALL  ,(CHNG,,$AQLTERM),VL,MF=L
QURMT003 CALL  ,(QUCOUNT,ISRT,,,SDA06003),VL,MF=L
*---------------------------------------------------------------------*
INADDR   DS    0A
IN@FCT   DC    A(0)
IN@RC    DC    A(0)
@PIO     DC    A(0)
@PMOD    DC    A(0)
@PDB13A  DC    A(0)
@PDB13B  DC    A(0)
@PLB13   DC    A(0)
@PDB15   DC    A(0)
@PLB15   DC    A(0)
INLAST   EQU   *-4
INADDRX  EQU   *-INADDR
*---------------------------------------------------------------------*
PAADDR   DS    0A
PA@FCT   DC    A(0)
PA@RC    DC    A(0)
PA@TRC   DC    A(0)
PA@UMSG  DC    A(0)
PA@PARMS DC    A(0)
PALAST   EQU   *-4
PAADDRX  EQU   *-PAADDR
*---------------------------------------------------------------------*
CMDCOUNT DC    A(0)
CMDLIST  DS    0A
CMDP001  DC    A(0,0)                  001
CMDP002  DC    A(0,0)                  002
CMDP003  DC    A(0,0)                  003
CMDP004  DC    A(0,0)                  004
CMDP005  DC    A(0,0)                  005
CMDP006  DC    A(0,0)                  006
CMDP007  DC    A(0,0)                  007
CMDP008  DC    A(0,0)                  008
CMDP009  DC    A(0,0)                  009
CMDP010  DC    A(0,0)                  010
CMDP011  DC    A(0,0)                  011
CMDP012  DC    A(0,0)                  012
CMDLISTP EQU   *
*---------------------------------------------------------------------*
IOPTR    DC    A(0)                    POINTER TO #IO-AREA
*---------------------------------------------------------------------*
CYNXTC   DC    A(0)
*---------------------------------------------------------------------*
NEWCLP   DC    A(0)                    NEW CLP AFTER COPYREC
NEWLAST  DC    A(0)                    NEW $ADKEY
NEWD     DC    A(0)                    NEW $DKEY,  AFT. COPYREC
NEWDP    DC    A(0)                    NEW $DKEYP, AFT. COPYREC
NEWRECS  DC    A(0)                    NEW $ANRECS, A.  COPYREC
*---------------------------------------------------------------------*
GBSWB    DC    X'0'
GBSWBPLI EQU   B'00000001'             INIT-CALLED WITH 'PL/I'
*
         DC    X'0'                    * RESERVED *
         DC    X'0'                    * RESERVED *
         DC    X'0'                    * RESERVED *
         DC    16A(0)                  * RESERVED *
*---------------------------------------------------------------------*
QUCOUNT  DC    A(0)
*---------------------------------------------------------------------*
LINMIN   DC    Y(4)
LINMAX   DC    Y(0)                    INIT BY SD971EDT (2331)
COLMIN   DC    Y(9)
COLMAX   DC    Y(80)
EDERRIX  DC    Y(0)
*---------------------------------------------------------------------*
X4040    DC    X'4040'
GU       DC    C'GU  '
GN       DC    C'GN  '
GNP      DC    C'GNP '
GHU      DC    C'GHU '
GHN      DC    C'GHN '
REPL     DC    C'REPL'
ISRT     DC    C'ISRT'
CHNG     DC    C'CHNG'
DLET     DC    C'DLET'
FUNC     DC    C'    '
SD071E   DC    C'SD071E  '
SDA06003 DC    C'SDA06003'             MFS-FORMAT-NAME FOR PRINT
*---------------------------------------------------------------------*
SSA      DS    0C
         DC    C'A       '
SSAOPN   DC    C'('
         DC    C'SEGKEY  '
         DC    C' ='
SSAKEY   DC    C'DSN=$$.EDIT.'
SSAKEYL  DC    CL8' '
         DC    CL38' '
         DC    C')'
*---------------------------------------------------------------------*
SSF      DS    0C
         DC    C'F       '
SSFOPN   DC    C'('
         DC    C'SEGKEY  '
         DC    C' ='
SSFKEY   DC    X'00000000'
         DC    C')'
*---------------------------------------------------------------------*
SSC      DS    0C
         DC    C'C       '
SSCOPN   DC    C'('
         DC    C'SEGKEY  '
         DC    C' ='
SSCKEY   DC    X'00000000'
         DC    C')'
*---------------------------------------------------------------------*
SSD      DS    0C
         DC    C'D       '
SSDOPN   DC    C'('
         DC    C'SEGKEY  '
SSDOPR   DC    C' ='
SSDKEY   DC    X'00000000'
         DC    C')'
*---------------------------------------------------------------------*
SXD      DS    0C
         DC    C'D       '
SXDOPN   DC    C'('
         DC    C'SEGKEY  '
SXDOPR   DC    C'>='
AXKEY    DC    X'00000000'
         DC    C')'
*---------------------------------------------------------------------*
GBSWA    DC    X'00'
GBSWAIN  EQU   B'00000001'
GBSWAPA  EQU   B'00000010'
GBSWARFI EQU   B'00000100'             ON: SECOND CALL 'RFIX'
GBSWARTI EQU   B'00001000'             ON: SECOND CALL 'RTXT'
GBSWACRE EQU   B'00010000'             PR.CMD='RES'
GBSWACYR EQU   B'00100000'             PR.CMD='REN'
GBSWACLP EQU   B'01000000'             ON: $ACLP IS SET
GBSWACMB EQU   B'10000000'             ON: LINE-CMD WAS 'B'
*---------------------------------------------------------------------*
CYSWA    DC    X'0'
CYSWACYC EQU   B'00000001'
CYSWLOST EQU   B'00000010'             EDT,TBX:ON:DATA LOST MSG
*---------------------------------------------------------------------*
$A       DS    0D
$ALL     DS    Y
$AKEY    DS    CL58
$APARM   DS    0C
$ASEQS   DS    Y
$ASEQL   DS    Y
$ASEQB   DS    Y
$ASEQI   DS    Y
$AUPPER  DS    C
$AFILL   DS    C
$ATAB    DS    C
$ATABC   DS    C
$ATABS01 DS    Y
$ATABSL  EQU   *-$ATABS01
$ATABS02 DS    Y
$ATABS03 DS    Y
$ATABS04 DS    Y
$ATABS05 DS    Y
$ATABS06 DS    Y
$ATABS07 DS    Y
$ATABS08 DS    Y
$ATABS09 DS    Y
$ATABS10 DS    Y
$ABNDF   DS    Y
$ABNDT   DS    Y
$ALRECL  DS    Y
$ARECFM  DS    C
$APARMX  EQU   *-$APARM
*
$ATRC    DS    CL8
$AUMSG   DS    CL43
         DS    X                       *RESERVED
         DS    X                       *RESERVED
*
$AEDIT   DS    0A
$ATDADD  DS    2A                      TDATE(ADD):=(HHMMSSTH00YYDDDF)
$ATDUPD  DS    2A                      TDATE(UPD):=(HHMMSSTH00YYDDDF)
$ACLP    DS    A                       CURRENT LINE-POINTER
$AFKEY   DS    A                       LAST KEY F-SEGMENT
$ACKEY   DS    A                       LAST KEY C-SEGMENT
$ADKEY   DS    A                       LAST KEY D-SEGMENT
$ACKEYD  DS    0A                      * OLD LABEL *
$ADKEYD  DS    28A                     KEYS OF DISPLAYED LINES
$ANFIX   DS    A                       0:=NO KEY, >0:=LAST KEY,
$ANRECS  DS    A                       NUMBER OF RECORDS IN DATASET
$ASCRO   DS    Y                       SCROLL-OFFSET
$AFID    DS    Y                       FIND-DIRECTION 0=N,4=P
$AFICS   DS    Y                       FIND-COL.START
$AFICE   DS    Y                       FIND-COL.END
$AFIL    DS    Y                       FIND-LENGTH
$AFIS    DS    CL64                    FIND-STRING
$ACHD    DS    Y                       CHANGE-DIRECTION 0=N,4=P
$ACHCS   DS    Y                       CHANGE-COL.START
$ACHCE   DS    Y                       CHANGE-COL.END
$ACHLF   DS    Y                       CHANGE-LENGTH FROM
$ACHLT   DS    Y                       CHANGE-LENGTH TO
$ACHSW   DS    X
$ACHDONE EQU   B'00000001'
$ACHSWX  EQU   B'00000010'
$ACHSWNX EQU   B'00000100'
$ACHALL  EQU   B'00001000'
$ASW     DS    X                       SWITCH
$ASWINC  EQU   B'00000001'             INCOMPLETE BLOCK CMD
$ASWRUNB EQU   B'00000010'             OFF = EDIT, ON = BROWSE
$ASWHEX  EQU   B'00000100'             OFF = CHAR, ON = HEXA-MODE
         DS    X                       *RESERVED
         DS    X                       *RESERVED
$ACHSF   DS    CL64                    CHANGE-STRING FROM
$ACHST   DS    CL64                    CHANGE-STRING TO
*
$AQLTERM DS    CL8                     PRINT: LTERM-NAME
$AQLF    DS    A                       PRINT: FROM-LINE
$AQLT    DS    A                       PRINT: TO-LINE
$AQCF    DS    A                       PRINT: FROM-COLUMN
$AQCT    DS    A                       PRINT: TO-COLUMN
$AQPL    DS    A                       PRINT: PAGE-LENGTH
$AQPLD   DS    A                       PRINT: DUMMY-FIELD
$AQCL    DS    A                       PRINT: NUMBER OF COLUMNS
*
$ACOLPTR DS    Y                       COL-CMD: LINE-NUMBER (1...2028)
$AMDL    DS    Y                       2028  LINES DISPLAYED
$ATABPTR DS    Y                       TAB-CMD: LINE-NUMBER (1...2028)
         DS    Y                       *RESERVED
*
$AISAVE  DS    CL63
         DS    X                       *RESERVED
$AFSAVE  DS    CL63
         DS    X                       *RESERVED
$ACSAVE  DS    CL63
         DS    X                       *RESERVED
$AQSAVE  DS    CL63
         DS    X                       *RESERVED
$ADHEX   DS    28X                     00=NORMAL DISP, 01=HEXA
         DS    44A                     *RESERVED
$AEDITX  EQU   *-$AEDIT
*
$AX      EQU   *-$A
         ORG   ,
*---------------------------------------------------------------------*
$F       DS    0D
$FLL     DS    Y
$FKEY    DS    XL4
$FPRFXL  EQU   *-$F
$FDATA   DS    0C
         ORG   $F+1024
$FLMAX   EQU   *-$FDATA
$FX      EQU   *-$F
         ORG   ,
*---------------------------------------------------------------------*
$C       DS    0D
$CLL     DS    Y
$CKEY    DS    XL4
$CKEYP   DS    XL4
$CDATA   DS    0C
$CX      EQU   *-$C
         ORG   ,
*---------------------------------------------------------------------*
$D       DS    0D
$DLL     DS    Y
$DKEY    DS    XL4
$DKEYP   DS    XL4
$DCMD    DS    Y
$DCOUNT  DS    Y
$DERR    DS    Y                       1:ERR 2:FND 3:CHA
$DERRERR EQU   1
$DERRFND EQU   2
$DERRCHA EQU   3
$DHC     DS    X                       HIGHL.(00 F1 F2 F4)
$DCC     DS    X                       COLOR (00 F1....F7)
$DSW     DS    X                       SWITCH
$DSWHEX  EQU   B'00000001'             ON: HEXA DATA IN $DDATA
         DS    XL5                     *RESERVED
$DPRFXL  EQU   *-$D
$DDATA   DS    0C
         ORG   $D+1024
$DLMAX   EQU   *-$DDATA                MAX. LENGTH OF DATA
$DX      EQU   *-$D
         ORG   ,
*=====================================================================*
#IO      DSECT ,
#IOLL    DS    Y                       LENGTH
#IOZZ    DS    Y
#IOTRC   DS    CL8                     TRANSACTION-CODE
#IOREQ   DS    CL4                     REQUEST: ' EDT'
#IOMDL   DS    CL2                     A2  A3 (24 OR 32 LINES)
#IOCFLD  DS    0C                      I: CURSOR (DEC,PACKED)
#IOLIN   DS    Y
#IOCOL   DS    Y
#IOPFK   DS    0CL2                    I: PFK-VALUE
#IOSCA   DS    Y                       O: SCA-VALUE
         DS    CL8                     ATTR/HIGHLIGHTING/COLOR/*RSVD
#IOCMD   DS    CL63                    I/O: INPUT-COMMAND
#IOCMDX  EQU   *-#IOCMD
         DS    CL8
#IOSAVE  DS    CL5                     I/O: SAVE-DATA
#IOEL    DS    0C                      ** START LINE-ELEMENTS **
         DS    CL8                        ATTR/HIGH/COLOR/*RSVD
#IOSEQX  DS    CL6                     I/O:--> SEQUENCE
         DS    CL8                        ATTR/HIGH/COLOR/*RSVD
#IOTEXT  DS    CL72                    I/O:--> INPUT-LINE-TEXT
#IOELX   EQU   *-#IOEL
         DS    27CL(8+6+8+72)          ELEMENTS 2....28
#IOELP   EQU   *                       ** ENDE  LINE-ELEMENTS **
         DS    CL8
#IOUMSG  DS    CL43                    O: USER-MESSAGE
         DS    CL8
#IOM001  DS    CL80                    O: MESSAGE-TEXT-001
         DS    CL8
#IOM002  DS    CL80                    O: MESSAGE-TEXT-002
#IOX     EQU   *-#IO
*---------------------------------------------------------------------*
./ ADD  NAME=SETAUTH
** TITLE   AUTHORIZE PGM TEMPORARY
** OWNER   RASP
** LCHNG   05/03/83 15:08:05   Z227128 FRANZ
         MACRO
&LABEL   SETAUTH &FORM,&SVC=235
.*       THIS MACRO SETS VIA USER SVC JSCBAUTH-BIT
.*       IN JSCBOPTS (JSCB + 236) X'01' = ON
.*                                X'00' = OFF
         AIF   ('&FORM' EQ 'OFF').OFF
         AIF   ('&FORM' EQ 'ON').ON
         MNOTE 8,'UNKNOWN FUNKTION'
         MEXIT
.ON      ANOP
&LABEL   LA    0,1            INDICATE 'ON'
         AGO   .SVCCALL
.OFF     ANOP
&LABEL   LA    0,2            INDICATE 'OFF'
.SVCCALL ANOP
         SVC   &SVC
         MEND
./ ADD  NAME=SMCAEXT
         MACRO
         SMCAEXT
SMCAEXT  DSECT
DJCONOFF DS    X                   DJC-SWITCH (ON=X'00'/OFF=X'FF')
IPLOVER  DS    X                   IPL-OVER SWITCH SET BY XCNTRL
*                                  AND REFERENCED BY IEECVXIT
SMCAINIT DS    X                   SWITCH FOR INHIBIT INITIATION
SMCALLAF DS    X                   SWITCH FOR LLA ACTIVE
LLAACT   EQU   128                 LLA ACTIVE FLAG
SMCALLAC DS    F                   A(SSB) FOR LLA ASCB
SMCALOCK DS    F                   LOCKWORD FOR DJC (USED IN SPDJC03)
SMCAJNCB DS    A                   ADDRESS OF JOBNET-CONTROL-BLOCK
SMCAJCMD DS    A                   ADDRESS OF DJC COMMAND TO SUBMIT
SMCAIMSF DS    CL4                 SYSTEM-ID FOR SYSAFF=IMS
SMCATSOF DS    CL4                 SYSTEM-ID FOR SYSAFF=TSO
SMCABTCH DS    CL4                 SYSTEM-ID FOR SYSAFF=BTCH
SMCAMAXU DS    F                   MAXIMUM TSO-USERS
SMCAACCT DS    F                   A(ACCOUNT-NO. TABLE)
         DS    10F                 UNUSED
         MEXIT
         MEND
./ ADD  NAME=STAIEXIT
STAIEXIT DS    0D
         XSAVE R12,,STAIEXIT,DLEN
         USING SDSECT,R13
         MVI   SW,0           CLEAR THE SWITCH
         CH    R0,=H'12'      IS A SDWA ?
         BE    NOSDWA
         LR    R10,R1         ADDRESS SDWA
         USING SDWA,R10
         L     R3,SDWAABCC    GET THE COMPLETION CODE
         B     LOOKCC         GO TO LOOK AT THE CODE
NOSDWA   EQU   *              NO SDWA WAS CREATED
         OI    SW,NSDWA       INDICATE MISSING SDWA
         LR    R3,R1          LOAD CC INTO REG 3
LOOKCC   EQU   *
         SLL   R3,8           SHIFT DUMP OPTIONS OUT OF REG
         SRL   R3,8           SHIFT BACK
         LR    R4,R3          SAVE CC
         SLL   R4,20          SHIFT OUT SYSTEM CC
         SRL   R4,20          SHIFT BACK
         CR    R4,R3          COMPARE NOW
         BNE   SYSCC          IF R4 IS EMPTY, MUST BE SYSTEM CODE
         CVD   R3,STDW        CONVERT USER CC
         OI    STDW+7,15      FORCE PRINTABLE
         UNPK  CC,STDW        UNPACK THE USER CC
         B     DOWTO          INFORM THE OPERATOR
         SPACE 2
CC913    DS    0F
         DC    XL4'00000913'
SYSCC    EQU   *
         SRL   R3,12          SHIFT SYSTEM CC TO RIGTHMOST BITS OF REG
         C     R3,CC913       IS THIS A 913-ABEND
         BE    RETURN         YES, DON'T TELL TO OPERATOR
         ST    R3,STDW        AND BRING IT TO STORAGE
         UNPK  CC(L'CC+1),STDW(5) UNPACK THE SYSTEM CC
         LA    R1,HEXTAB      PREPARE TR INSTRUCTION
         SH    R1,=H'240'
         TR    CC,0(R1)       TRANSLATE THE SYSTEM CC
DOWTO    EQU   *
         LOAD  EP=PRTMSGS     GET THE MESSAGE CSECT
         LR    R11,R0         ADDRESS IT
         USING PRTMSGS,R11
         TM    SW,NSDWA       IS A SDWA ?
         BO    NOMODUL        NO, DON'T TRY TO MOVE A MODULE NAME
         MVC   PRT038+20(8),SDWANAME MOVE MODUL NAME TO WTO
NOMODUL  EQU   *
         MVC   PRT038+45(L'CC),CC    MOVE CC TO WTO
         L     R0,MSGCONID    GET CONSOLID
         WTO   MF=(E,PRT038)  INFORM OPERATOR
         DELETE EP=PRTMSGS    DELETE THE MESSAGE CSECT
         SPACE 3
RETURN   EQU   *
         XRETURN 0,R          WEITER GEHTS NICHT
HEXTAB   DC    CL16'0123456789ABCDEF'
         LTORG
SDSECT   DSECT
         DS    18F            SAVEAREA
SW       DS    X
NSDWA    EQU   1              INDICATES SDWA IS NOT CREATED
STDW     DS    D
CC       DS    CL4            COMPLETION CODE
         DS    C
         DS    0D
DLEN     EQU   *-SDSECT
         IHASDWA
./ ADD  NAME=SUPSCR01
         MACRO
&SYMBOL  SUPSCR01 &DSN=,&VOL=
         LCLA  &INDVX
         LCLA  &INDX
         LCLA  &INDXX
         LCLA  &INDD
         LCLA  &LODOI
         LCLC  &HF1,&HF2
         LCLC  &DS(2500),&VO(2500)
         AIF   (N'&DSN LE 1000).AMSD
         MNOTE 8,'MEHR ALS 1000 DSN''S ANGEGEBEN'
         MEXIT
.AMSD    ANOP
         AIF   (N'&VOL LE 1000).AMSV
         MNOTE 8,'MEHR ALS 1000 VOL''S ANGEGEBEN'
         MEXIT
.AMSV    ANOP
&INDX    SETA  0
.INDS    ANOP
&INDX    SETA  &INDX+1
         AIF   (&INDX GT 1000).AIDS
&DS(&INDX) SETC (44)'X''FF'
         AGO   .INDS
.AIDS    ANOP
&INDX    SETA  0
.INVO    ANOP
&INDX    SETA  &INDX+1
         AIF   (&INDX GT 1000).AIVO
&VO(&INDX) SETC (6)'X''FF'
         AGO   .INVO
.AIVO    ANOP
&INDX    SETA  0
&INDD    SETA  0
.UIX     ANOP
&INDXX   SETA  1
&INDX    SETA  &INDX+1
         AIF   (&INDX GT N'&DSN).BEGCS
&HF1     SETC  '&DSN(&INDX)'.(44-K'&DSN(&INDX))' '
.BED     ANOP
         AIF   (K'&DS(&INDXX) LT 44).HF2SCD
&HF2     SETC  '&DS(&INDXX)'
         AGO   .AHF2SCD
.HF2SCD  ANOP
&HF2     SETC  '&DS(&INDXX)'.(44-K'&DS(&INDXX))' '
.AHF2SCD ANOP
         AIF   ('&HF1' EQ '&HF2').MN
         AIF   ('&HF1' GT '&HF2').UIXXC
&INDD    SETA  &INDD+1
&INDVX   SETA  &INDD
         AIF   (&INDVX EQ 1).SIVD
.LIVD    ANOP
&DS(&INDVX) SETC '&DS(&INDVX-1)'
&INDVX   SETA  &INDVX-1
         AIF   (&INDVX LE &INDXX).SIVD
         AGO   .LIVD
.SIVD    ANOP
&DS(&INDXX) SETC '&DSN(&INDX)'
         AGO   .UIX
.UIXXC   ANOP
&INDXX   SETA  &INDXX+1
         AGO   .BED
.MN      ANOP
         MNOTE 4,'DSN DOPPELT: &DSN(&INDX)'
         AGO   .UIX
.BEGCS   ANOP
&INDX    SETA  0
SPSCR01  CSECT
         DC    A(IND)
         DC    A(VOL)
IND      EQU   *
         DC    A((ENDE-ANF)/46)
ANF      EQU   *
.LOOPD   ANOP
&INDX    SETA  &INDX+1
&LODOI   SETA  K'&DS(&INDX)-1
         DC    H'&LODOI',CL44'&DS(&INDX)'
         AIF   (&INDX LT &INDD).LOOPD
ENDE     EQU   *
VOL      DC    A((E-A)/8)
A        EQU   *
&INDX    SETA  0
&INDD    SETA  0
.UIY     ANOP
&INDXX   SETA  1
&INDX    SETA  &INDX+1
         AIF   (&INDX GT N'&VOL).BECSE
&HF1     SETC  '&VOL(&INDX)'.(6-K'&VOL(&INDX))' '
.BEV     ANOP
         AIF   (K'&VO(&INDXX) LT 6).HF2SCV
&HF2     SETC  '&VO(&INDXX)'
         AGO   .AHF2SCV
.HF2SCV  ANOP
&HF2     SETC  '&VO(&INDXX)'.(6-K'&VO(&INDXX))' '
.AHF2SCV ANOP
         AIF   ('&HF1' EQ '&HF2').MNV
         AIF   ('&HF1' GT '&HF2').UIYYC
&INDD    SETA  &INDD+1
&INDVX   SETA  &INDD
         AIF   (&INDVX EQ 1).SIVV
.LIVV    ANOP
&VO(&INDVX) SETC '&VO(&INDVX-1)'
&INDVX   SETA  &INDVX-1
         AIF   (&INDVX LE &INDXX).SIVV
         AGO   .LIVV
.SIVV    ANOP
&VO(&INDXX) SETC '&VOL(&INDX)'
         AGO   .UIY
.UIYYC   ANOP
&INDXX   SETA  &INDXX+1
         AGO   .BEV
.MNV     ANOP
         MNOTE 4,'VOL DOPPELT: &VOL(&INDX)'
         AGO   .UIY
.BECSE   ANOP
&INDX    SETA  0
.LOOPV   ANOP
&INDX    SETA  &INDX+1
&LODOI   SETA  K'&VO(&INDX)-1
         DC    H'&LODOI',CL6'&VO(&INDX)'
         AIF   (&INDX LT N'&VOL).LOOPV
E        EQU   *
         END
         MEND
./ ADD  NAME=SVTREC
SVTRASA  DC    C'1'           ASA CARRIAGE CODE
SVTRID   DC    CL10'BASFPRTSVT'
SVTRL#   DC    CL10' '        LIST#
SVTREMPF DC    CL3' '         EMPFAENGER SB#
SVTRCPY  DC    CL3' '         COPIES FOR THIS EMPF
SVTRBHW  DC    CL2' '         BEARBEITUNGS HINWEIS
SVTRBL#  DC    CL5' '         BLATTANZAHL DIESER SUBLISTE
SVTRPK#  DC    CL5' '         PACK # DIESER SUBLISTE
SVTRFKZ  DC    CL1' '         X: FACHKENNZEICHEN
SVTRLEN  EQU   *-SVTRASA
./ ADD  NAME=SVTWORK
SVTID    DC    CL10'BASFPRTSVT'
SVTMSG   WTO   '                                                       *
                     ',MF=L,MCSFLAG=REG0
         PRINT NOGEN
SVTWDCB  DCB   DDNAME=WORK,DSORG=PS,MACRF=(PM,GL),EXLST=WKEXIT
         PRINT GEN
SVTLREC  DC    F'0'           POINTER TO LAST INPUT RECORD
SVTPGCNT DC    F'0'           PAGE COUNT FOR CURRENT SUBLIST
SVTDMREC DC    F'0'           POINTER TO CURRENT DMRECORD
SVTIDCB  DC    F'0'           POINTER TO INPUT DCB (TAPE OR MSS)
SVTODCB  DC    F'0'           POINTER TO OUTPUT DCB (PRINTER)
SVTIJFCB DC    F'0'           POINTER TO JFCB OF INPUT DCB
SVTWORK  DC    F'0'           POINTER TO COMMON WORK CSECT
SVTLIDR  DC    F'0'           POINTER TO LAST ID RECORD
         DC    09F'0'         RESERVED
WKEXIT   DC    X'07'          JFCB-EXIT
         DC    AL3(WKJFCB)
WKOUTEX  DC    F'0'           SPACE FOR SWITCH-OFF OPEN EXIT
         DC    X'85'          OPEN EXIT FOR OUTPUT
WKOPEX   DC    AL3(0)         MUST BE FILLED BY 'PRTCOPY'
         SPACE 2
WKJFCB   DS    0D
         DC    CL176' '       JFCB AREA
         SYSDATE
SVTWLEN  EQU   *-SVTID        LENGTH OF THIS AREA
./ ADD  NAME=SYSDATE
         MACRO
&NM      SYSDATE
&NM      DC    C'04/12/84'   MM/DD/YY             12.04.1984     84.103
         MEND
./ ADD  NAME=SYSPRINT
         MACRO
&SYM     SYSPRINT &HEADER1=,&HEADER2=,&LINES=56,&DDNAME=SYSPRINT,      X
               &RECFM=FBA,&LRECL=121,&BLKSIZE=0
         AIF   (K'&SYM EQ 0).NOSYM
         AIF   (K'&SYM GT 5).ERRSYM
         AIF   (K'&DDNAME GT 8).DDNERR
         AIF   ('&LRECL' GT '133').ERRLEN
         MNOTE *,'DCB = DDNAME=&DDNAME,LRECL=&LRECL,LINES=&LINES'
         AIF   ('&HEADER1' EQ '').HD1
         MNOTE *,'    &HEADER1 IS FIRST HEADER LINE'
         AIF   ('&HEADER2' EQ '').HD2
         MNOTE *,'    &HEADER2 IS SECOND HEADER LINE'
.HD2     MNOTE *,'    THE FIRST BYTE OF ANY BUFFER SPECIFIED WILL'
         MNOTE *,'    BE USED BY THIS ROUTINE FOR ASA CHARACTERS'
         MNOTE *,'    AND UNPREDICTABLE RESULTS MAY OCCUR IF USED.'
***********************************************************************
*        THIS MACRO COURTESY OF D.R.CHANEY, MILWAUKEE, FE-246         *
***********************************************************************
         DS    0H
&SYM     NOP   DRC&SYSNDX.C .          NOP BRANCH SET AFTER OPEN
         NOP   DRC&SYSNDX.D .          NOP BRANCH SET AFTER OPEN
         STM   14,2,DRC&SYSNDX.B .     SAVE USERS REGS
         LA    1,DRC&SYSNDX.A .        LOAD ADDRESS OF OPEN LIST
         SVC   19 .                    ISSUE OPEN SVC
         TM    &SYM.DCB+48,X'10' .     DID DCB OPEN
         BC    1,&SYM.1 .              YES
         LM    14,2,DRC&SYSNDX.B .     RESTORE REGISTERS
         BR    14
&SYM.1   DS    0H
         OI    &SYM.+5,C'0' .          SET NOP TO BRANCH
         OI    &SYM.+1,C'0' .          SET FIRST NOP TO BRANCH
         AIF   ('&HEADER1' EQ '').HD4
DRC&SYSNDX.F MVI &HEADER1,C'1' .       SET CARRIAGE CONTROL
         PUT   &SYM.DCB,&HEADER1
         AIF   ('&HEADER2' EQ '').HD5
         MVI   &HEADER2,C'-' .         SET TRIPLE SPACE AFTER SKIP
         PUT   &SYM.DCB,&HEADER2
         AGO   .HD5
.HD4     L     15,DRC&SYSNDX.B+12 .    GET POINTER TO RECORD
DRC&SYSNDX.E MVI 0(15),C'1' .            SKIP TO ONE FIRST TIME
         LA    2,&LINES.+1 .           GET LINE COUNT
         AGO   .HD55
.HD5     L     15,DRC&SYSNDX.B+12 .    PICK UP DATA POINTER
         MVI   0(15),C'0' .            SET DOUBLE SPACE AFTER SK97
         LA    2,&LINES.+1 .           PICK UP LINE COUNT
.HD55    ANOP
DRC&SYSNDX.G BCT 2,DRC&SYSNDX.H .      BR TO PRINT FOR NUMBER OF LINES
         AIF   ('&HEADER1' NE '').HD6
         B     DRC&SYSNDX.E .          START NEW PAGE
         AGO   .P4
.HD6     B     DRC&SYSNDX.F .          GO TO DO SKIP AND PRINT HDR
.P4      ANOP
DRC&SYSNDX.H PUT &SYM.DCB,(15)
         ST    2,DRC&SYSNDX.J .        SAVE THE LINE COUNT
         LM    14,2,DRC&SYSNDX.B .     RESTORE USERS REGS
         MVI   0(1),C' ' .             PLACE BLANK INTO CARRIAGE CONTR
         MVC   1(&LRECL.-1,1),0(1) .   CLEAR THE BUFFER
         BR    14 .                    RETURN
DRC&SYSNDX.D STM 14,2,DRC&SYSNDX.B .   SAVE REGS ALWAYS
         AIF   ('&HEADER1' EQ '').P6
         B     DRC&SYSNDX.F .          GO TO HEADER ROUTINE
         AGO   .P5
.P6     ANOP
         L     15,DRC&SYSNDX.B+12 .    PICK UP POINTER TO DATA
         B     DRC&SYSNDX.E .          GO TO HEADER RTN
.P5      ANOP
DRC&SYSNDX.C STM 14,2,DRC&SYSNDX.B .   SAVE REGS ALWAYS
         L     2,DRC&SYSNDX.J .        RESTORE THE LINE COUNTER
         L     15,DRC&SYSNDX.B+12 .    PICK UP POINTER TO DATA
         MVI   0(15),C' ' .            MOVE X'40' TO ASA
         B     DRC&SYSNDX.G .          GO TEST FOR LINE COUNT
DRC&SYSNDX.M CLC &SYM.DCB+62(2),=H'0' . IS BLOCK SIZE THERE
         BNE   DRC&SYSNDX.L .          IF SO SKIP
         MVC   &SYM.DCB+62(2),=H'&LRECL'  .     MOVE IN DEFAULT SIZE
DRC&SYSNDX.L BR 14 .               RETURN TO OPEN
DRC&SYSNDX.B DS 5F .                   PRINT RTNS SAVE AREA
DRC&SYSNDX.J DS 1F .                   SAVE FOR LINE COUNTER
DRC&SYSNDX.K DC X'85' .                EXIT LIST FOR OPEN
         DC    AL3(DRC&SYSNDX.M) .     POINTER TO THE EXIT ROUTINE
DRC&SYSNDX.A DC AL1(143) .             OPTION BYTE FOR OPEN
         DC    AL3(&SYM.DCB) .         DCB ADCON FOR OPEN
&SYM.DCB DCB   DDNAME=&DDNAME,LRECL=&LRECL,RECFM=&RECFM,DSORG=PS,      X
               MACRF=(PM),EXLST=DRC&SYSNDX.K,BLKSIZE=&BLKSIZE
         MEXIT
.HD1     AIF   ('&HEADER2' EQ '').HD2
         MNOTE 8,'8,*** HEADER2 INVALID WITHOUT HEADER1 SPECIFIED'
         MEXIT
.ERRLEN MNOTE 8,'8,*** LRECL TOO LARGE FOR SYSPRINT'
         MEXIT
.NOSYM  MNOTE 8,'8,*** SYSPRINT MACRO MUST HAVE A LABEL'
         MEXIT
.ERRSYM MNOTE 8,'8,*** LABEL ON SYSPRINT MACRO MUST BE LESS THAN SIX'
         MEXIT
.DDNERR MNOTE 8,'8 *** MAXIMUM DDNAME SIZE IS EIGHT CHARACTERS'
         MEXIT
.BUFERR  MNOTE 8,'8,*** NO BUFFER SUPPLIED, EXECUTION IMPOSSIBLE'
.END     MEND
./ ADD  NAME=SYSPUT
         MACRO
&SYM     SYSPUT &DDNAME=SYSPUNCH,&LRECL=80,&RECFM=,&BLKSIZE=80
         AIF   (K'&SYM GT 5).ERRSYM
         AIF   (K'&SYM EQ 0).NOSYM
         AIF   (K'&DDNAME GT 8).DDNERR
       MNOTE *,'DCB = DDNAME=&DDNAME,DSORG=PS,MACRF=PM'
       MNOTE *,'             DD CARD CHANGES WILL WORK FOR'
       MNOTE *,'      LRECL=&LRECL,BLKSIZE=&BLKSIZE,RECFM=&RECFM'
***********************************************************************
*        THIS MACRO COURTESY OF D.R.CHANEY, MILWAUKEE, FE-246         *
***********************************************************************
&SYM     DS    0H
         STM   14,1,&SYM.14 .          SAVE REGS
         TM    &SYM.DCB+48,X'10' .     IS DCB OPEN
         BC    1,&SYM.1 .              YES - BYPASS OPEN CODE
         OPEN  (&SYM.DCB,(OUTPUT))
         TM    &SYM.DCB+48,X'10' .     DID DCB OPEN
         BC    1,&SYM.1 .              YES
         B     &SYM.1S
&SYM.1   L     0,&SYM.14+12 .          SET DATA REG
         PUT   &SYM.DCB,(0)
&SYM.1S  DS    0H
         LM    14,1,&SYM.14 .          RESTORE REGS
         BR    14 .                    RETURN
&SYM.XIT CLC   &SYM.DCB+62(2),=H'0' .  IS BLKSIZE THERE
         BNE   &SYM.3 .                IF SO SKIP
         MVC   &SYM.DCB+62(2),=H'&BLKSIZE' MOVE IN BLKSIZE
&SYM.3   CLC   &SYM.DCB+82(2),=H'0' .  IS LRECL THERE
         BNE   &SYM.4 .                IF SO SKIP
         MVC   &SYM.DCB+82(2),=H'&LRECL' MOVE IN LRECL
&SYM.4   CLI   &SYM.DCB+36,X'00' .     IS RECFM THERE
         BNE   &SYM.5 .                BRANCH IF THERE
         MVI   &SYM.DCB+36,X'90' .     MOVE IN DEFAULT RECFM FB
&SYM.5   BR    14 .                    RETURN TO OPEN
&SYM.14  DS    4F .                    REG SAVE AREA
&SYM.LST DC    X'85' .                 OPEN EXIT LIST
         DC    AL3(&SYM.XIT) .         ENTRY FOR OPEN EXIT
&SYM.DCB DCB   DDNAME=&DDNAME,DSORG=PS,MACRF=(PM),EXLST=&SYM.LST,      X
               RECFM=&RECFM
         AGO   .END
.ERRSYM MNOTE 8,'8,*** LABEL ON SYSPUT MACRO MUST BE LESS THAN SIX'
         AGO   .END
.NOSYM  MNOTE 8,'8,*** SYSPUT MACRO MUST HAVE A LABEL'
         AGO   .END
.DDNERR MNOTE 8,'8,*** DDNAME LARGER THAN EIGHT CHARACTERS'
.END     MEND
./ ADD  NAME=TCBD
         MACRO
         TCBD
TCBD     DSECT
*
*        SYMBOLIC DEFINITION OF MVT (MFT) TCB FIELDS       REL.19
*
TCBRBP   DS    A                       CURRENT RB POINTER
TCBPIE   DS    A                       PIE ADDR
TCBDEB   DS    A                       FIRST DEB ADDR
TCBTIO   DS    A                       ADDR OF TIOT
TCBCMP   DS    F                       COMPLETION CODE
TCBTRN   DS    F                       TESTRAN FIELD
TCBNROC  DS    0XL1                    ROLLOUT FLAG
TCBMSS   DS    A                       MSS QUEUES (BOUNDARY BOX) PTR
TCBPKF   DS    XL1                     PROTECTION KEY
TCBFLGS  DS    5XL1                    FLAG BYTES
TCBLMP   DS    XL1                     LIMIT PRIORITY (ENQUEUE COUNT)
TCBDSP   DS    XL1                     DISPATCHING PRIORITY
TCBLLS   DS    A                       ADDR OF LLE (LOADED PGM RB PTR)
TCBJLB   DS    A                       JOBLIB DCB ADDR
TCBJPQ   DS    0A                      LAST CDE ADDR FOR JPA
TCBFTJST DS    A                       (ADDR OF JOBSTEP TCB)
TCBGRS   DS    16F                     GENERAL REGISTER SAVE AREA
TCBQEL   DS    0XL1                    ENQUEUE COUNT
TCBIDF   DS    0XL1                    (TCB IDENTIFIER)
TCBFSA   DS    A                       FIRST PP SAVE AREA ADDR
TCBTCB   DS    A                       NEXT LOWER PRIORITY TCB PTR
TCBTME   DS    A                       ADDR OF TIMER ELEMENT
TCBJSTCB DS    0A                      JOBSTEP TCB
TCBPIB   DS    A                       (PARTN TYPE AND PIB ADDR)
TCBNTC   DS    A                       PREVIONS TCB ON OTC SUBTASK QUE
TCBOTC   DS    A                       ORIGINATING TASK'S TCB
TCBLTC   DS    A                       LAST TCB ON SUBTASK QUEUE
TCBIQE   DS    A                       IQE FOR EXIT ROUTINE
TCBECB   DS    A                       TASK END ECB ADDR
         DS    F                       RESERVED
TCBPQE   DS    0A                      DUMMY PQE -8 ADDR
TCBFTLMP DS    XL1                     (LIMIT PRIORITY)
TCBFTFLG DS    3XL1                    (FLAG BYTES)
TCBAQE   DS    0A                      ADDR OF AQE
         DS    F                       (RESERVED)
TCBNSTAE DS    A                       CURRENT STAE CTL BLK FLAGS PTR
TCBTCT   DS    A                       ADDR OF TCT
TCBUSER  DS    F                       USER FIELD
TCBDAR   DS    XL1                     DAR FLAGS
TCBNDSP  DS    3XL1                    SECNDRY NONDISP FLAGS
         DS    F                       RESERVED
TCBJSCB  DS    A                       JSCB ADDR
         SPACE 2
         MEND
./ ADD  NAME=TERME
         MACRO
&NAME    TERME &OP=,&SAVE=,&LV=0
.* TERME WILL RESTORE REGISTERS, UNCHAIN SAVE AREAS, RELEASE DYNAMIC
.* STORAGE OBTAINED BY THE PRIME MACRO, RESET THE PGM MASK AND IN
.* GENERAL PERFORM THE NECESSARY EXIT LINKAGE.
.* TERME WILL FREE THE USERS SAVE AREA PLUS THE NUMBER OF BYTES
.* SPECIFIED BY THE LV OPERAND UNLESS THE USER IMPLIES THAT THE SAVE
.* AREA WAS NOT OBTAINED VIA A GETMAIN.  THE USER IMPLIES THIS BY
.* SPECIFYING SAVE= SOME VALUE OR SYMBOL.
.* IF THE USER SPECIFIED SAVE=NONE IN THE PRIME MACRO, HE SHOULD DO
.*  THE SAME FOR TERME.
.* THE USER MAY CHOOSE TO FOLLOW THE TERME MACRO WITH THE XCTL MACRO
.* RATHER THAN BRANCH ON 14.  THE USER ACCOMPLISHES THIS BY CODING
.* OP=XCTL.
         AIF   ('&NAME' EQ '').F
&NAME    DS    0H
.F       ANOP
         AIF ('&SAVE' EQ 'NONE').C
         L     13,4(0,13)              GET PTR TO USERS AREA
         STM   0,1,20(13)               TEMPORARY SAVE OF R0 AND R1
         AIF   ('&SAVE' NE '').C
         AIF   ('&LV'(1,1) EQ '(').E
         AIF   ('&LV' EQ '0').CONT
         AIF   ('&LV' GT '4023').ERR
         LA    0,&LV.+72(0,0)           PARAMETER FOR FREEMAIN
         AGO   .CONT
.E       ANOP
         AIF   ('&LV' EQ '(0)').CONT
         LA    0,72(&LV(1).,0)          PARAMETER FOR FREEMAIN
.CONT    ANOP
         L     1,8(0,13)                GET SAVE AREA ADDRESS
         LA    1,0(0,1)                 INDICATE FREEMAIN
         AIF   ('&LV' NE '0').CONTC
         L     0,0(0,1)                 LENGTH IS IN 1ST WORD OF AREA
.CONTC   ANOP
         SVC   10                       ISSUE SVC 10
.C       ANOP
         L     14,16(0,13)              RESET
         SPM   14                       PGM MASK
         L     14,12(0,13)              RESTORE
         LM    0,12,20(13)              REGISTERS
         XC    8(4,13),8(13)            DEQUEUE SAVE AREA
         AIF   ('&OP' EQ 'XCTL').D
         BR    14                       RETURN TO CALLER
         MEXIT
.D       ANOP
         BALR  15,0                     ESTABLISH ADDRESSABILITY
         USING *,15
         MEXIT
.ERR     MNOTE 'LV GT 4023, LV REQUEST NOT HONORED'
         LA    0,72(0,0)                PARAMETER FOR FREEMAIN
         AGO   .CONT
         MEND
         MACRO
&SYM     SYSGET &EODAD=EODAD,&DDNAME=SYSIN,&LRECL=80,&RECFM=,          X
               &BLKSIZE=80
         AIF   (K'&SYM EQ 0).NOSYM
         AIF   (K'&SYM GT 5).ERRSYM
         AIF   (K'&DDNAME GT 8).DDNERR
         AIF   (K'&EODAD GT 8).ERREOD
       MNOTE *,'DCB = DDNAME=&DDNAME,DSORG=PS,MACRF=GL,EODAD=&EODAD'
       MNOTE *,'          DD CARD CHANGES WILL WORK FOR '
       MNOTE *,'      LRECL=&LRECL,BLKSIZE=&BLKSIZE,RECFM=&RECFM'
***********************************************************************
*        THIS MACRO COURTESY OF D.R.CHANEY, MILWAUKEE, FE-246         *
***********************************************************************
         DS    0H
&SYM     ST    14,&SYM.14 .            SAVE RETURN REG
         TM    &SYM.DCB+48,X'10' .     IS DCB OPEN
         BC    1,&SYM.1 .              YES - BYPASS OPEN CODE
         OPEN  (&SYM.DCB,(INPUT))
         TM    &SYM.DCB+48,X'10' .     DID DCB OPEN
         BC    1,&SYM.1 .              YES
         WTO   '&SYM.DCB IS NOT OPEN - CHECK DD CARD'
         B     &SYM.EOD
&SYM.1   GET   &SYM.DCB
         L     14,&SYM.14 .            RESTORE RETURN REG
         BR    14 .                    RETURN
&SYM.XIT CLC   &SYM.DCB+62(2),=H'0' .  IS BLOCK SIZE THERE
         BNE   &SYM.3 .                IF SO SKIP
         MVC   &SYM.DCB+62(2),=H'&BLKSIZE' .MOVE IN SIZE
&SYM.3   CLC   &SYM.DCB+82(2),=H'0' .  IS LRECL HERE
         BNE   &SYM.4 .                IF SO SKIP
         MVC   &SYM.DCB+82(2),=H'&LRECL' .   MOVE IN LRECL
&SYM.4   CLI   &SYM.DCB+36,X'00' .     IS RECFM THERE
         BNE   &SYM.5 .                BRANCH IF THERE
         MVI   &SYM.DCB+36,X'90' .     MOVE IN DEFAULT RECFM FB
&SYM.5   BR    14 .                    RETURN TO OPEN
&SYM.EOD CLOSE &SYM.DCB
         FREEPOOL &SYM.DCB
         B     &EODAD .                GO TO USERS EODAD RTN
&SYM.14  DS    1F .                    RETURN REG SAVE AREA
&SYM.LST DC    X'85' .                 DCB OPEN EXIT
         DC    AL3(&SYM.XIT) .         POINTER TO XIT RTN
&SYM.DCB DCB   DDNAME=&DDNAME,DSORG=PS,MACRF=(GL),EODAD=&SYM.EOD,      ,
               EXLST=&SYM.LST,RECFM=&RECFM
         AGO   .END
.ERRSYM MNOTE 8,'8,*** LABEL ON SYSGET MACRO MUST BE LESS THAN SIX'
         AGO   .END
.NOSYM  MNOTE 8,'8,*** SYSGET MACRO MUST HAVE A LABEL'
         AGO   .END
.DDNERR MNOTE 8,'8,*** DDNAME LARGER THAN EIGHT CHARACTERS'
         AGO   .END
.ERREOD MNOTE 8,'8,*** MAXIMUM LABEL SIZE IS EIGHT CHARACTERS'
.END     MEND
./ ADD  NAME=TERMLST
         MACRO
&SYMAD   TERMLST &LINE=,&TERMANZ=,&VL=
         GBLA  &LNCNT
         GBLA  &GENPOLL
         GBLA  &SPECPOL
         GBLA  &SELECT
         LCLA  &ZL
         LCLA  &ANZAHL
         LCLA  &POINT
&ANZAHL  SETA  N'&TERMANZ
&POINT   SETA  1
&ZL      SETA  1
         AIF   (T'&LINE EQ 'O').ERR
         AIF   (T'&TERMANZ EQ 'O').ERR
&LNCNT   SETA  &LNCNT+1
         STM   6,9,ST&SYSNDX
         B     MV&SYSNDX
POLL&LINE&POINT  DFTRMLST  AUTOWLST,(40407F7F2D,3737373737)
SPEC&LINE&POINT&ZL EQU *
         DC    X'404040402D'
         PRINT GEN
         DFLIST TERMZHL=&TERMANZ(&POINT),CU=4040,ADR=SPEC&LINE&POINT
         PRINT NOGEN
SEL&LINE&POINT&ZL EQU *
         DC    X'606040402D'
         DFLIST TERMZHL=&TERMANZ(&POINT),CU=6060,ADR=SEL&LINE&POINT
         AIF   (&POINT EQ &ANZAHL).P1
&POINT   SETA  &POINT+1
POLL&LINE&POINT  DFTRMLST  AUTOWLST,(C1C17F7F2D,3737373737)
SPEC&LINE&POINT&ZL EQU *
         DC    X'C1C140402D'
         DFLIST TERMZHL=&TERMANZ(&POINT),CU=C1C1,ADR=SPEC&LINE&POINT
SEL&LINE&POINT&ZL EQU *
         DC    X'616140402D'
         DFLIST TERMZHL=&TERMANZ(&POINT),CU=6161,ADR=SEL&LINE&POINT
         AIF   (&POINT EQ &ANZAHL).P1
&POINT   SETA  &POINT+1
POLL&LINE&POINT  DFTRMLST  AUTOWLST,(C2C27F7F2D,3737373737)
SPEC&LINE&POINT&ZL EQU *
         DC    X'C2C240402D'
         DFLIST TERMZHL=&TERMANZ(&POINT),CU=C2C2,ADR=SPEC&LINE&POINT
SEL&LINE&POINT&ZL EQU *
         DC    X'E2E240402D'
         DFLIST TERMZHL=&TERMANZ(&POINT),CU=E2E2,ADR=SEL&LINE&POINT
         AIF   (&POINT EQ &ANZAHL).P1
&POINT   SETA  &POINT+1
POLL&LINE&POINT  DFTRMLST  AUTOWLST,(C3C37F7F2D,3737373737)
SPEC&LINE&POINT&ZL EQU *
         DC    X'C3C340402D'
         DFLIST TERMZHL=&TERMANZ(&POINT),CU=C3C3,ADR=SPEC&LINE&POINT
SEL&LINE&POINT&ZL EQU *
         DC    X'E3E340402D'
         DFLIST TERMZHL=&TERMANZ(&POINT),CU=E3E3,ADR=SEL&LINE&POINT
         AIF   (&POINT EQ &ANZAHL).P1
&POINT   SETA  &POINT+1
POLL&LINE&POINT  DFTRMLST  AUTOWLST,(C4C47F7F2D,3737373737)
SPEC&LINE&POINT&ZL EQU *
         DC    X'C4C440402D'
         DFLIST TERMZHL=&TERMANZ(&POINT),CU=C4C4,ADR=SPEC&LINE&POINT
SEL&LINE&POINT&ZL EQU *
         DC    X'E4E440402D'
         DFLIST TERMZHL=&TERMANZ(&POINT),CU=E4E4,ADR=SEL&LINE&POINT
         AIF   (&POINT EQ &ANZAHL).P1
         AGO   .ERR1
.ERR     MNOTE 8,'PARAMETER FEHLT'
         MEXIT
.ERR1    MNOTE 8,'MEHR ALS 5 STEUEREINHEITEN AN EINER LEITUNG'
.P1      ANOP
ST&SYSNDX  DS  4F
CUCNT&LINE DS  0F
         DC    8X'00'
MV&SYSNDX EQU  *
         LA    6,POLL&LINE&ZL
         ST    6,CUCNT&LINE+4
         MVI   CUCNT&LINE+4,X'00'
.LOOP2   ANOP
         MVI   CUCNT&LINE+&POINT-1,&TERMANZ(&POINT)
         AIF   (&POINT EQ 1).CUDONE
&POINT   SETA  &POINT-1
         AGO   .LOOP2
.CUDONE  ANOP
         LM    6,9,ST&SYSNDX
         MEND
./ ADD  NAME=TIOTSCAN
         MACRO
&NM      TIOTSCAN  &DDNM,&JOBNM,&PROCNM,&STEPNM,&TIOT=
.*  TIOTSCAN INFORMES ABOUT EXISTENCE OF DDNAME IN THE TIOT.
.*  WHEN ASKD,THIS MACRO CAN EXTRACT JOBNAME,PROCNAME,STEPNAME
.*  FROM TIOT AND STORE THEM IN THE OUTSIDE OF MACRO DEFINIED FIELDS
.*  THE TIOT ADDRESS MAY BE SPECIFIED IN A FULLWORD,
.*  WHEN MACRO EXTRACT USED BEFORE.
.*  &DDNAME-THE ADDRESS OF IT MAY BE SPECIFIED IN THE FORM:
.*          FULLWORD OR (REGISTER)
.*  &JOBNAME-THE ADDRESS OF THE ASSIGNED FIELD MUST BE SPECIFIED IN
.*           THE FORM:FULLWORD OR (REGISTER) OR DISPLACEMENT(REGISTER)
.*  THE SAME FOR &PROCNAME AND &STEPNAME.
         LCLA  &L
         LCLB  &DN,&JN,&PN,&SN,&COUNT,&CN,&TI
         LCLC  &GNAME,&GNAME1,&GNAME2,&REG,&FELD,&SYM,&NHM
&GNAME   SETC  'IHB'.'&SYSNDX'
&GNAME1  SETC  '&GNAME'.'A'
&GNAME2  SETC  '&GNAME'.'E'
         AIF   (T'&NM EQ 'O').PEDR
&NHM     SETC  '&NM'
&NHM     EQU   *
.PEDR    AIF   (T'&DDNM EQ 'O').ERROR
&DN      SETB  (1)
         SR    0,0           CLEAN  REG
         AIF   ('&DDNM'(1,1) NE '(').LOAD
         LR    1,&DDNM       LOAD A(DDNAME)
         AGO   .ERROR
.LOAD    LA    1,&DDNM       LOAD  A(DDNAME)
         AGO   .ERROR
.LAOP    AIF   (T'&TIOT EQ 'O').NFND
&TI      SETB  (1)
         L     14,&TIOT      LOAD A(TIOT)
         AIF   (NOT &DN).LOOK
.NFND    ANOP
         AIF   (&TI).LAST
         L     14,16         A(CVT)
         L     14,0(14)      A(CVTTCB)
         L     14,4(14)      A(CURRTCB)
         L     14,12(14)     A(TIOT)
         AIF   (NOT &DN).LOOK
.LAST    LA    15,24(14)     FIRST  TIOT  ENTRY
&GNAME1  CLC   4(8,15),0(1)  DDNAME  EQUAL?
         BE    &GNAME        YES,RETURN
         IC    0,0(15)       GET ENTRY LENGHT
         LTR   0,0           LAST  ONE
         BZ    &GNAME2       YES,RETURN WITH CODE 0
         AR    15,0          NO,DO NEXT ONE
         B     &GNAME1
&GNAME2  SR    15,15         CLEAR REG
&GNAME   EQU   *
.ERROR   ANOP
         AIF   (&CN).LOOK
&CN      SETB  (1)
         AIF   (T'&JOBNM NE 'O').PAL1
.XP      AIF   (T'&PROCNM NE 'O').PAL2
.XS      AIF   (T'&STEPNM NE 'O').PAL3
         AIF   (&DN OR &JN OR &PN).LAOP
         MNOTE 12,'ALL NAMES OMITTED'
         MEXIT
.PAL1    ANOP
&JN      SETB  (1)
&COUNT   SETB  (1)
         AGO   .XP
.PAL2    ANOP
&PN      SETB  (1)
&COUNT   SETB  (1)
         AGO   .XS
.PAL3    ANOP
&SN      SETB  (1)
&COUNT   SETB  (1)
         AGO   .LAOP
.LOOK    AIF   (NOT &JN).PROC
         AIF   (T'&JOBNM EQ 'U').POX
         AIF   ('&JOBNM'(1,1) EQ '(').POLX
&SYM     SETC  '&JOBNM'
         AIF   (T'&JOBNM EQ 'N').ERR
         MVC   &JOBNM,0(14)  MOVE  JOBNAME
         AGO   .PROC
.POLX    ANOP
&REG     SETC  '&JOBNM(1)'
         MVC   0(8,&REG),0(14)      MOVE  JOBNAME
         AGO   .PROC
.POX     ANOP
&L       SETA  K'&JOBNM
.KLAM    AIF   ('&JOBNM'(&L,1) EQ '(').FND
&L       SETA  &L-1
         AGO   .KLAM
.FND     ANOP
&FELD    SETC  '&JOBNM'(1,&L).'8,'
&FELD    SETC  '&FELD'.'&JOBNM'(&L+1,K'&JOBNM-&L)
         MVC   &FELD,0(14)   MOVE  JOBNAME
.PROC    AIF   (NOT &PN).STEP
         AIF   (T'&PROCNM EQ 'U').POY
         AIF   ('&PROCNM'(1,1) EQ '(').POLY
&SYM     SETC  '&PROCNM'
         AIF   (T'&PROCNM EQ 'N').ERR
         MVC   &PROCNM,8(14)      MOVE PROCNAME
         AGO   .STEP
.POLY    ANOP
&REG     SETC  '&PROCNM(1)'
         MVC   0(8,&REG),8(14)        MOVE  PROCNAME
         AGO   .STEP
.POY     ANOP
&L       SETA  K'&PROCNM
.KLM     AIF   ('&PROCNM'(&L,1) EQ '(').FOND
&L       SETA  &L-1
         AGO   .KLM
.FOND    ANOP
&FELD    SETC  '&PROCNM'(1,&L).'8,'
&FELD    SETC  '&FELD'.'&PROCNM'(&L+1,K'&PROCNM-&L)
         MVC   &FELD,8(14)           MOVE PROCNAME
.STEP    AIF   (NOT &SN).ENDO
         AIF   (T'&STEPNM EQ 'U').POZ
         AIF   ('&STEPNM'(1,1) EQ '(').POLZ
&SYM     SETC  '&STEPNM'
         AIF   (T'&STEPNM EQ 'N').ERR
         MVC   &STEPNM,16(14)  MOVE  STEPNAME
         AGO   .ENDO
.POLZ    ANOP
&REG     SETC  '&STEPNM(1)'
         MVC   0(8,&REG),16(14)       MOVE  STEPNAME
         AGO   .ENDO
.POZ     ANOP
&L       SETA  K'&STEPNM
.KLAME   AIF   ('&STEPNM'(&L,1) EQ '(').FOUND
&L       SETA  &L-1
         AGO   .KLAME
.FOUND   ANOP
&FELD    SETC  '&STEPNM'(1,&L).'8,'
&FELD    SETC  '&FELD'.'&STEPNM'(&L+1,K'&STEPNM-&L)
         MVC   &FELD,16(14)            MOVE  STEPNAME
         AGO   .ENDO
.ERR     ANOP
         MNOTE 8,'INCORRECT  SYMBOL &SYM'
.ENDO    MEND
./ ADD  NAME=TPDCB
         MACRO
&SYMAD   TPDCB &DDNAMEN=
         LCLA  &ANZAHL
         LCLA  &ZAHL
         LCLA  &ADDRESS
&ANZAHL  SETA  N'&DDNAMEN
&SYMAD   DS    0F
         AIF   (T'&DDNAMEN EQ 'O').ERR
         STM   6,7,ST&SYSNDX
         B     LIST&SYSNDX
.P1      ANOP
DCB&ANZAHL DCB DSORG=CX,MACRF=(R,W),DDNAME=&DDNAMEN(&ANZAHL),DEVD=BS,  *
               MODE=(,CNTRL),CODE=EBCDIC
         READ  DECB&ANZAHL,TIR,DCB&ANZAHL,MF=L
&ANZAHL  SETA  &ANZAHL-1
         AIF   ('&ANZAHL' EQ '0').P2
         AGO   .P1
.ERR     MNOTE 8,'PARAMETER FEHLT'
         MEXIT
.P2      ANOP
&ZAHL    SETA  N'&DDNAMEN
&ANZAHL  SETA  1
&ADDRESS SETA  0
LIST&SYSNDX EQU *
.LOOP1   ANOP
         LA    6,DCB&ANZAHL
         LA    7,DECB&ANZAHL
         ST    6,DCBADDR+&ADDRESS
         ST    7,DECBADDR+&ADDRESS
         AIF   (&ANZAHL EQ &ZAHL).OUT1
&ANZAHL  SETA  &ANZAHL+1
&ADDRESS SETA  &ADDRESS+4
         AGO   .LOOP1
.OUT1    ANOP
         MVI   DECBADDR+&ADDRESS,X'80'
         MVI   DCBADDR+&ADDRESS,X'80'
         B     OPEN&SYSNDX
DCBADDR  DS    (&ANZAHL)F
DECBADDR DS    (&ANZAHL)F
OPEN&SYSNDX EQU *
         LA    6,DCBADDR
NEXT&SYSNDX L  7,0(6)
         OPEN  ((7))
         TM    48(7),X'10'
         BO    OK&SYSNDX
OK&SYSNDX EQU  *
         TM    0(6),X'80'
         BO    FIN&SYSNDX
         LA    6,4(6)
         B     NEXT&SYSNDX
ST&SYSNDX DS   2F
FIN&SYSNDX LM  6,7,ST&SYSNDX
         MEND
./ ADD  NAME=TRACEGEN
         MACRO
         TRACEGEN  &ID=,               TRACE IDENT                     ,
               &ITEM=                  TRACE ITEMS
.*
         GBLA  &TRCLEN
         GBLB  &TRCGEN
         LCLA  &NID,&XID,&NITEM,&OFF,&LEN,&SYM
         LCLC  &CHAR,&XFERSYM,&CONTSYM,&ITEMSYM,&LN,&SM,&OP
.*   EXPANSION
         AIF   (&TRCGEN).GEN
         MNOTE *,'TRACE  &ID BYPASSED'
         AGO   .XIT
.GEN     ANOP
&NID     SETA  K'&ID
         AIF   (&NID NE 0).ID1
         MNOTE 4,'TRACE  ''NO ID'' BYPASSED'
         AGO   .XIT
.ID1     ANOP
         AIF   (&NID LT 5).ID2
         MNOTE 4,'TRACE  ID SHORTENED'
&NID     SETA  4
.ID2     ANOP
         AIF   (&NID LE &TRCLEN).ID3
&NID     SETA  &TRCLEN
.ID3     ANOP
&CHAR    SETC  '&ID'(1,&NID)
&XFERSYM SETC  'TRC'.'&CHAR'.'X'
&ITEMSYM SETC  'TRC'.'&CHAR'
&CONTSYM SETC  'TRC'.'&CHAR'.'C'
.XFER    ANOP
         ENTRY &XFERSYM
&XFERSYM B     &CONTSYM
.GETID   ANOP
&XID     SETA  &XID+1
         AIF   (&XID GT &NID).ITEM
&CHAR    SETC  '&ID'(&XID,1)
         MVI   &ITEMSYM-1+&XID,C'&CHAR'    MOVE ID
         AGO   .GETID
.ITEM    ANOP
&NITEM   SETA  N'&ITEM
         AIF   (&NITEM NE 0).NEXT
         MNOTE 0,'TRACE  NO ITEMS'
         AGO   .CALL
.NEXT    ANOP
&OFF     SETA  &SYM
&OFF     SETA  &OFF+1
&LEN     SETA  &OFF+1
&SYM     SETA  &OFF+2
         AIF   (&SYM GT &NITEM).CALL
&LN      SETC  '&ITEM(&LEN)'
&SM      SETC  '&ITEM(&SYM)'
         AIF   ('&SM'(1,1) EQ '(').REG
         MVC   &ITEMSYM+&ITEM(&OFF)(&LN),&SM
         AGO   .NEXT
.REG     ANOP
&OP      SETC  'ST'
         AIF   ('&LN' EQ '4' OR '&LN' EQ '').STORE
         AIF   ('&LN' EQ '2').HALF
&OP      SETC  'STC'
         AGO   .STORE
.HALF    ANOP
&OP      SETC  'STH'
.STORE   ANOP
         &OP   &SM,&ITEMSYM+&ITEM(&OFF)
         AGO   .NEXT
.CALL    ANOP
         CNOP  2,4
         L     15,=V(CTRACE)
         BALR  15,15
&ITEMSYM DC    XL(&TRCLEN)'00'
&CONTSYM EQU   *
.XIT     MEND
./ ADD  NAME=TRACEMOD
         MACRO
         TRACEMOD  &EP=,               EP SYMBOL OF MOD TO BE TRACED   ,
               &ID=,                   TRACE ID SYMBOLS                ,
               &LEN=16,                ENTRY LENGTH                    ,
               &N=255,                 NUMBER OF ENTRIES               ,
               &SP=0,                  SUBPOOL TO BE USED              ,
               &EXIT=FREE
.*
         GBLA  &TRCLEN
         GBLB  &TRCGEN
         LCLA  &L,&NT,&NID,&XID,&LID,&XT
         LCLC  &IDENT,&CALLSYM
.*   EXPANSION
         AIF   ('&EP' NE '').IDENT
         MNOTE 8,'TRACE  ENTRY OMITTED'
         AGO   .XIT
.IDENT   ANOP
&IDENT   SETC  'TRC'.'&EP'
&IDENT   CSECT
         AIF   (&TRCGEN).ENTRY
&L       SETA  &LEN
&TRCLEN  SETA  &L/2*2
         AIF   (&TRCLEN EQ &L).ENTRY
&TRCLEN  SETA  &TRCLEN+2
         MNOTE *,'TRACE  ENTRY LENGTH ADJUSTED'
.ENTRY   ANOP
         ENTRY CTRACE
*
*   TRACE INITIALIZATION
&NT      SETA  &N
         AIF   (&NT NE 0).EXEC
         MNOTE 0,'TRACE  DUMMY MODULE'
         USING *,15
         L     15,TRCENTRY             LOAD EP ADDR
         BR    15                      BRANCH TO ENTRYPOINT
         AGO   .EPADDR
.EXEC    ANOP
         B     12(0,15)                BRANCH AROUND ID
         DC    X'07'
         DC    CL7'&IDENT'
         STM   0,3,20(13)              SAVE REGS USED
         LR    3,15                    LOAD BASE
         USING &IDENT,3
         ST    14,TRCSAVE@             SAVE RETURN ADDR
         LH    1,TRCCOUNT+2            LOAD ENTRY NUMBER
         MH    1,CTRACE+2              COMPUTE AREA LENGTH
         LA    0,16(0,1)               ADD FIXED PART
         LR    2,0                     SAVE LENGTH
         GETMAIN LV=(0),MF=(E,TRCGMLST)
         LTR   15,15                   CHECK
         BZ    TRCINIT@
         WTO   MF=(E,TRCMSG@@)
         B     TRCENTER
TRCINIT@ EQU   *
         L     1,TRCPTR@@              LOAD AREA ADDR
         MVC   0(8,1),TRCIDENT         STORE ID
         LA    0,16(0,1)
         ST    0,8(0,1)                INIT FIRST
         LA    0,0(2,1)
         ST    0,12(0,1)               AND END POINTER
         LH    2,CTRACE+2              GET ENTRY LENGTH
         BCTR  2,0                     ADJUST
         STC   2,TRCMOVE@+1            STORE LEN INTO MOVE
         LA    1,16(0,1)               GET FIRST ENTRY ADDR
TRCCOUNT LA    0,&NT                   AND COUNT
TRCCLEAR EQU   *
         EX    2,TRCZERO@              ZERO ENTRY
         LA    1,1(2,1)                UPDATE PTR
         BCT   0,TRCCLEAR
         MVC   TRCEXIT@,CTRACE         DUPLICATE BRANCH
         LA    2,TRCCALLS              LOAD ADCON LIST PTR
TRCNOP@@ EQU   *
         TM    0(2),X'80'              TEST END-OF-LIST
         BO    TRCENTER
         L     1,0(0,2)                LOAD INSTRUCTION ADDR
         LA    1,0(0,1)
         LTR   1,1                     AND CHECK
         LA    2,4(0,2)                UPDATE POINTER
         BZ    TRCNOP@@                UNRESOLVED, SKIP
         MVI   1(1),X'00'              CHANGE TO NOP
         NI    CTRACE+1,X'0F'          RESET ENTRY SWITCH
         B     TRCNOP@@
TRCENTER EQU   *
         L     15,TRCENTRY             LOAD EP ADDR
         LM    0,3,20(13)              RESTORE REGS
         BALR  14,15                   LINK TO MODULE
         STM   0,3,20(13)              SAVE
         BALR  3,0                     RELOAD BASE
         USING *,3
         ST    15,TRCSAVE@+4           SAVE RETURN CODE
         NC    TRCPTR@@,TRCPTR@@       GOT AREA
         BZ    TRCRETRN
         AIF   ('&EXIT' NE 'LEAVE').FREE
&XT      SETA  15
.FREE    ANOP
         BC    &XT,TRCRETRN
         FREEMAIN MF=(E,TRCGMLST)
TRCRETRN EQU   *
         LM    14,15,TRCSAVE@          RELOAD REGS
         LM    0,3,20(13)
         SPM   14
         BR    14
*
TRCZERO@ XC    0(0,1),0(1)
*
*
TRCSAVE@ DC    2F'0'
*
TRCGMLST GETMAIN EC,A=TRCPTR@@,SP=&SP,MF=L
*
TRCMSG@@ DC    0F'0'
         DC    AL2(TRCMSG@#-*)
         DC    H'0'
         DC    C'*TRACE  '
TRCIDENT DC    CL8'&IDENT'
         DC    C'  CANCELLED - NO CORE'
TRCMSG@# EQU   *
*
TRCCALLS DC    0A(0)
&NID     SETA  N'&ID
         AIF   (&NID NE 0).CALLS
         MNOTE 4,'TRACE  NO EXITS'
         AGO   .ENDCALL
.CALLS   ANOP
&XID     SETA  &XID+1
         AIF   (&XID GT &NID).ENDCALL
&LID     SETA  K'&ID(&XID)
         AIF   (&LID LE &TRCLEN).TEST
&LID     SETA  &TRCLEN
.TEST    ANOP
         AIF   (&LID LT 5).SET
&LID     SETA  4
         AGO   .DEF
.SET     ANOP
         AIF   (&LID NE 0).DEF
         MNOTE 4,'TRACE  ''NO ID'' BYPASSED'
         AGO   .CALLS
.DEF     ANOP
&CALLSYM SETC  'TRC'.'&ID(&XID)'(1,&LID).'X'
         AIF   (&TRCGEN).NOTEXT
         EXTRN &CALLSYM
.NOTEXT  ANOP
         DC    A(&CALLSYM)
         AGO   .CALLS
.ENDCALL ANOP
         DC    X'FF'                   END-OF-LIST FLAG
.EPADDR  ANOP
*
TRCENTRY DC    V(&EP)
*
*   EXECUTE TRACE ROUTINE
CTRACE   DS    0H
         DC    X'47FF'                 BRANCH BACK
         DC    AL2(&TRCLEN)
         AIF   (&NT EQ 0).XIT
         STM   1,3,24(13)              SAVE REGS
         BALR  3,0
         USING *,3
         L     2,TRCPTR@@              LOAD AREA ADDR
         L     1,8(0,2)                AND ENTRY PTR
TRCMOVE@ MVC   0(0,1),0(15)            SAVE TRACE ITEMS
         AH    1,TRCEXIT@+2            UPDATE POINTER
         CL    1,12(0,2)               AND CHECK
         BL    *+8
         LA    1,16(0,2)               RESET TO FIRST ENTRY
         ST    1,8(0,2)                STORE POINTER
         LM    1,3,24(13)              RESTORE REGS
         SPM   15
TRCEXIT@ DS    XL4                     RETURN
*
TRCPTR@@ DC    A(0)                    TRACE AREA POINTER
.XIT     MEND
./ ADD  NAME=TRACESET
         MACRO
         TRACESET  &LEN=16             TRACE ENTRY LENGTH
.*
         GBLA  &TRCLEN
         GBLB  &TRCGEN
         LCLA  &L
.*   EXPANSION
&TRCGEN  SETB  (1)
&L       SETA  &LEN
&TRCLEN  SETA  &L/2*2
         AIF   (&TRCLEN EQ &L).XIT
&TRCLEN  SETA  &TRCLEN+2
         MNOTE *,'TRACE  ENTRY LENGTH ADJUSTED'
.XIT     MEND
./ ADD  NAME=TRL
         MACRO
&NAME    TRL   &T,&L,&F
         GBLB  &FIRSTR
         GBLC  &GOTOTR1
         GBLC  &CSECTR
         LCLC  &GOTOTR2
         LCLC  &GOTOTR3
         AIF   (&FIRSTR).W0
&CSECTR  SETC  '&SYSECT'
.W0      AIF   ('&T'(1,1) EQ '(').W1
&NAME    LA    1,&T      LOAD ADDRESS OF FIELD TO BE TRANSLATED
         AGO   .W2
.W1      ANOP
&NAME    LR    1,&T(1)   LOAD ADDRESS OF FIELD TO BE TRANSLATED
.W2      AIF   ('&L'(1,1) EQ '(').W6
         AIF   (T'&L NE 'N').W4
.W3      LA    15,&L      GET LENGTH
         AGO   .W7
.W4      AIF   (T'&L EQ 'F').W5
         AIF   (T'&L NE 'H').W3
         LH    15,&L     GET LENGTH
         AGO   .W7
.W5      L     15,&L     GET LENGTH
         AGO   .W7
.W6      LR    15,&L(1)  GET LENGTH
.W7      AIF   ('&F'(1,1) EQ '(').W8
         LA    2,&F      LOAD ADDRESS OF TRANSLATION TABLE
         AGO   .W9
.W8      LR    2,&F(1)   LOAD ADRESS OF TRANSLATION TABLE
.W9      AIF   ('&CSECTR' EQ '&SYSECT').W10
&FIRSTR  SETB  0
&CSECTR  SETC  'SYSECT'
.W10     AIF   (&FIRSTR).W11
&FIRSTR  SETB  1
&GOTOTR1 SETC  'TR1&SYSNDX'
&GOTOTR2 SETC  'TR2&SYSNDX'
&GOTOTR3 SETC  'TR3&SYSNDX'
         LA    14,&GOTOTR3+2 GET ADRESS OF NEXT INSTRUCTION
         LA    0,256
&GOTOTR1 CR    15,0
         BL    &GOTOTR2  BRANCH TO LTR
         TR    0(256,1),0(2) TRANSLATION OF 256 BYTES
         SR    15,0      REDUCEACTUAL LENGTH
         AR    1,0       RESET FIELD POINTER
         B     &GOTOTR1  GO TO COMPARE
         TR    0(0,1),0(2) EXEC - TR
&GOTOTR2 LTR   15,15
         BZ    &GOTOTR3  IF ZERO GO TO MEND
         BCTR  15,0
         EX    15,&GOTOTR2-6 TRANSLATE AND TEST REMAINING BYTES
&GOTOTR3 BR    14        RETURN
         MEXIT
.W11     BAL   14,&GOTOTR1-4 BRANCH TO TRANSLATION - LOOP
         MEND
./ ADD  NAME=TRTL
         MACRO
&NAME    TRTL  &T,&L,&F
         GBLB  &FIRSTT
         GBLC  &GOTOTT1
         GBLC  &CSECTT
         LCLC  &GOTOTT2
         LCLC  &GOTOTT3
         AIF   (&FIRSTT).W0
&CSECTT  SETC  '&SYSECT'
.W0      AIF   ('&T'(1,1) EQ '(').W1
&NAME    LA    1,&T      LOAD ADDRESS OF FIELD TO BE TRANSLATED
         AGO   .W2
.W1      ANOP
&NAME    LR    1,&T(1)   LOAD ADDRESS OF FIELD TO BE TRANSLATED
.W2      AIF   ('&L'(1,1) EQ '(').W6
         AIF   (T'&L NE 'N').W4
.W3      LA    15,&L      GET LENGTH
         AGO   .W7
.W4      AIF   (T'&L EQ 'F').W5
         AIF   (T'&L NE 'H').W3
         LH    15,&L     GET LENGTH
         AGO   .W7
.W5      L     15,&L     GET LENGTH
         AGO   .W7
.W6      LR    15,&L(1)  GET LENGTH
.W7      AIF   ('&F'(1,1) EQ '(').W8
         LA    2,&F      LOAD ADDRESS OF TRANSLATION T12L5
         AGO   .W9
.W8      LR    2,&F(1)   LOAD ADRESS OF TRANSLATION TABLE
.W9      AIF   ('&CSECTT' EQ '&SYSECT').W10
&FIRSTT  SETB  0
&CSECTT  SETC  '&SYSECT'
.W10     AIF   (&FIRSTT).W11
&FIRSTT  SETB  1
&GOTOTT1 SETC  'TT1&SYSNDX'
&GOTOTT2 SETC  'TT2&SYSNDX'
&GOTOTT3 SETC  'TT3&SYSNDX'
         LA    14,&GOTOTT3+10 GET ADDRESS OF NEXT INSTRUCTION
         LA    0,256
&GOTOTT1 CR    15,0
         BL    &GOTOTT2  BRANCH TO LTR
         TRT   0(256,1),0(2) TRANSLATE AND MAX 256 BYTES
         BNZ   &GOTOTT3
         SR    15,0      REDUCEACTUAL LENGTH
         AR    1,0       RESET FIELD POINTER
         B     &GOTOTT1  GO TO COMPARE
         TRT   0(0,1),0(2) EXEC TRT
&GOTOTT2 LTR   15,15
         BZ    &GOTOTT3  IF ZERO GO TO MEND
         BCTR  15,0
         EX    15,&GOTOTT2-6 TRANSLATE AND TEST REMAINING BYTES
&GOTOTT3 SLL   2,24
         SRL   2,24
         BR    14        RETURN
         MEXIT
.W11     BAL   14,&GOTOTT1-4 BRANCH TO TRANSLATION - LOOP
         MEND
./ ADD  NAME=TSOPARM
         MACRO
         TSOPARM   &USERID=,&SPACE=
         AIF   (T'&USERID EQ 'O' OR T'&SPACE EQ 'O' OR K'&USERID GT 7  *
               OR T'&SPACE NE 'N').ERROR
         PUNCH '//STEP&SYSNDX EXEC ASMFCL,CL=Z'
         PUNCH '//ASM.SYSIN DD *'
         PUNCH '&USERID   CSECT'
         PUNCH '          DC    F''&SPACE'' DIRECT-ACCESS-SPACE-LIMIT (*
               IN CYLS)'
         PUNCH '          DC    XL76''00''  RESERVED'
         PUNCH '          END'
         PUNCH '/*'
         PUNCH '//LKED.SYSLMOD DD DSN=OX.TSOPARM(&USERID),DISP=SHR'
         SPACE 3
         MEXIT
.ERROR   ANOP
         SPACE 2
         MNOTE 4,'ERROR IN PARAMETERS - NO CODE GENERATED'
         SPACE 2
         MEXIT
         MEND
./ ADD  NAME=TSOPRMDF
         MACRO
         TSOPRMDF
*
*      THIS MACRO DESCRIBES THE LAYOUT OF ONE MEMBER OF OX.TSOPARM.
*
TSOPARM  DS    0CL80
TSOSPACE DS    F        MAXIMUM DIRECT-ACCESS-SPACE (IN CYLS)
         DS    XL76     RESERVED
         MEXIT
         MEND
./ ADD  NAME=TVSD9101
TVSD9101 DS    0CL56
FQFFZCH  DS    CL1       STELLENANZ. FF-ZCH (1,2,3) BEI X'40' TRN=8*
FQLL     DS    XL2       LL-FELD
FQZZ     DS    XL2       ZZ-FELD
FQTRANS  DS    CL8       TRANSACTIONCODE
         DS    CL1       KONSTANT BLANK
FQKZPRIM DS    CL1       KZ PRIMAER-NACHRICHT
FQAUSID  DS    CL2       AUSGABE-IDENTIFICATION
FQEMPF   DS    CL8       EMPFAENGER-NAME
FQABS    DS    CL8       ABSENDER-NAME
FQKZINT  DS    CL1       KZ INTERNE NACHRICHT
FQKZFMT  DS    CL1       KZ FREIFORM/FESTFORM
FQEPZEIT DS    0CL13     EINGANGSZEITPUNKT
FQJJ     DS    CL2       JJ
FQKEY    DS    CL11      TTT,HH,MM,SS,ZH    ** KEY DER FEHLER-DB **
FQVTRANS DS    CL8       VORHERGEHENDER TRANSACTION-CODE
FQROOTLN EQU   *-TVSD9101
         SPACE 5
./ ADD  NAME=TVSD9102
TVSD9102 DS    0CL104
FDLL     DS    XL2       LL-FELD
FDZZ     DS    XL2       ZZ-FELD
FDTEXT   DS    CL100     FREIFORM-DATEN
FDDEPLN  EQU   *-TVSD9102
         SPACE 5
./ ADD  NAME=UADSCOPY
         MACRO
&NM      UADSCOPY &TYPE=DEF,&D=
         LCLC  &N
&N       SETC  '&NM'
         AIF   ('&TYPE' NE 'DSECT').DEF
&N       DSECT
&N       SETC  ' '
.DEF     ANOP
         SPACE 3
*        DEFINITION EINES EINTRAGS DER UADS-TABELLE
*           (USERID UND ALLE ARBEITSNUMMERN)
*
&N       DS    0D
&D.UCOPY  DS    0C
*
&D.USERID DC    CL8' '         USERID
&D.LUID   DC    X'00'          LGTH OF USERID + "." - 1
&D.USTTRN DC    CL4' '         TTR OF UADS PDS MEMBER
          ORG   &D.USTTRN
&D.ACCT#  DC    X'00'          NO ACCTNO
&D.ACCTNR DC    CL200' '       SPACE FOR 50 ACCT
*
&D.ACCTLG EQU   *-&D.ACCTNR    LENGTH OF ACCOUNT PART
&D.NOACCT EQU   &D.ACCTLG/4    MAX NO OF ACCOUNT NO
&D.UENTLG EQU   *-&D.USERID    TOTAL LGTH OF ENTRY
         MEND
./ ADD  NAME=UCBSCAN
         MACRO
&NAME    UCBSCAN &DEVTYPE=ALL,&VOLSER=,&STATUS=ONOFF
         GBLA  &N
         GBLC  &UCBW,&UCWA
         GBLC  &UCBC,&UCCA
         GBLC  &UCBA,&UCAA
         GBLC  &UCBM,&UCB,&UCPL
&N       SETA  &N+1
&UCBW    SETC  '$UCBWA'
&UCBC    SETC  '$UCBCL'
&UCBA    SETC  '$UCBAD'
&UCPL    SETC  '$UCBPL'
&UCWA    SETC  '$UCBPWA'
&UCCA    SETC  '$UCBPCA'
&UCAA    SETC  '$UCBPAA'
&UCBM    SETC  '$UCBM'
&UCB     SETC  '$UCBE'
&NAME    TM    &UCPL.&N,X'FF'
         BO    &UCBM.&N
         B     &UCAA.&N+4
         DS    0D
&UCBW.&N DC    XL100'00'
         DC    C'ENDUCBWK'
&UCBA.&N DC    F'0'
&UCBC.&N DC    X'00'
&UCPL.&N DC    X'00'
&UCWA.&N DC    F'0'
&UCCA.&N DC    F'0'
&UCAA.&N DC    F'0'
         AIF   ('&DEVTYPE' EQ '').PARML
         AIF   (('&DEVTYPE' EQ 'ALL') OR ('&DEVTYPE' EQ 'A')).PARML
         AIF   (('&DEVTYPE' NE 'DASD') AND ('&DEVTYPE' NE 'D')).DISPL
         MVI   &UCBC.&N,X'20'
         AGO   .PARML
.DISPL   ANOP
         AIF   ('&DEVTYPE' NE 'DISPLAY').COMM
         MVI   &UCBC.&N,X'10'
         AGO   .PARML
.COMM    ANOP
         AIF   ('&DEVTYPE' NE 'COMM').TAPE
         MVI   &UCBC.&N,X'40'
         AGO   .PARML
.TAPE    ANOP
         AIF   (('&DEVTYPE' NE 'TAPE') AND ('&DEVTYPE' NE 'T')).DEVERR
         MVI   &UCBC.&N,X'80'
         AGO   .PARML
.DEVERR  ANOP
         MNOTE 12,'DEVTYPE=DASD/D OR DISPLAY OR COMM OR TAPE/T OR ALL'
.PARML   ANOP
         LA    1,&UCBW.&N         . ADDRESS OF UCBSCAN WORK AREA
         ST    1,&UCWA.&N
         LA    1,&UCBC.&N         . ADDRESS OF BYTE CONT. DEVCLASS
         ST    1,&UCCA.&N
         LA    1,&UCBA.&N         . ADDRESS OF WORD TO RECEIVE UCB-AD.
         ST    1,&UCAA.&N
         OI    &UCAA.&N,B'10000000'
         OI    &UCPL.&N,X'FF'
&UCBM.&N L     1,16                   . GET CVT-ADDRESS
         L     15,X'434'(1)           . GET ADDRESS OF SCAN ROUT.
         LA    1,&UCWA.&N             . ADDRESS OF PARAMETER LIST
         BALR  14,15
         LTR   15,15
         BNZ   &UCB.&N
         L     1,&UCBA.&N       . LOAD UCB-ADDRESS IN REG. 1
         AIF   ('&VOLSER' EQ '').STATUS
         AIF   ('&VOLSER'(1,1) NE '(').VOLSERA
         CLC   28(6,1),0(&VOLSER(1))   .REG POINTS TO A VOLSER-FIELD
         BNE   &UCBM.&N
         AGO   .VOLSERE
.VOLSERA ANOP
         CLC   28(6,1),&VOLSER   .IMPLICIT ADDR. OF VOLSER
         BNE   &UCBM.&N
.VOLSERE ANOP
         MVI   &UCBW.&N,X'00'
         MVC   &UCBW.&N+1(99),&UCBW.&N   .SETS WORKAREA TO X'00'
.STATUS  ANOP
         AIF   ('&STATUS' EQ '').END
         AIF   (('&STATUS' EQ 'ONOFF') OR ('&STATUS' EQ 'OFFON')).END
         AIF   (('&STATUS' NE 'O') AND ('&STATUS' NE 'ONLINE')).STATERR
.STATUSO ANOP
         TM    3(1),X'80'    .IS DEVICE ONLINE?
         BNO   &UCBM.&N
         AGO   .END
.STATERR ANOP
         MNOTE 12,'STATUS=O OR ONLINE OR OFFON OR ONOFF'
.END     ANOP
         SR    0,0
         ICM   0,B'0011',4(1)    .DEV-ADDR. IN REG0
&UCB.&N  DS    0H
         MEND
./ ADD  NAME=USERASCB
         MACRO
         USERASCB
USERASCB DSECT
UAACRON  DS    CL8                 NAME OF CB (USERASCB)
UACATVOL DS    CL6                 FOR TSO: VOLSER OF CATALOG-VOLUME
*                                  THIS FIELD IS USED IN THE DYNAMIC
*                                  ALLOCATION INSTALLATION EXIT
*                                  WHEN ALLOCATING NEW DASD-DATASETS
UARSV1   DS    H                   RESERVED
UAECT    DS    F                   FOR TSO: ADDRESS OF ECT
UAUPT    DS    F                   FOR TSO: ADDRESS OF UPT
UAJIMWTR DS    F                   ADDRESS OF AREA FOR JIMWTR
UARSV    DS    CL52                RESERVED
         MEXIT
         MEND
./ ADD  NAME=VSAMFDBK
         MACRO
&NM      VSAMFDBK &TYPE=DEF
         LCLC  &N
&N       SETC  '&NM'
         AIF   ('&TYPE' NE 'DSECT').DEF
&N       DSECT
&N       SETC  ' '
.DEF     ANOP
         SPACE 3
*        SATZBESCHREIBUNG DER FEEDBACK-AREA FUER DAS
*        UNTERPROGRAMM VSAM (ZUGRIFF AUF VSAM-DATEIEN)
*
&N        DS    0D
FDBK      DS    0CL80
FCODE     DC    C' '      ERROR-CODE: V = VSAM, P = PROGRAMM-ERROR
FERR      DC    CL4' '    VSAM-CODE (FROM RPL) PRINTABLE FORM
FR15      DC    CL2' '    R15 PRINTABLE FORM
FJOBNAME  DC    CL8' '     JOBNAME       IF
FVOLSER   DC    CL6' '     VOLSER        FUNCTION
FACBADDR  DC    XL4'00'    ACB-ADDR      =
FUCBADDR  DC    XL4'00'    UCB-ADDR      OPEN
FTEXT     DC    CL51' '   ERROR TEXT, IF FCODE = P
         SPACE 3
*        ANGABEN, DIE BEIM ERSTEN AUFRUF DES PROGRAMMS
*        BENOETIGT WERDEN (FUNCTION = OPEN)
*
          ORG   FDBK
FDDNAME   DC    CL8' '    DD-NAME OF VSAM-DS
FQNAME    DC    CL8' '    QNAME OF VSAM-DS
FLRECLMN  DC    F'0'      MIN LRECL
FLRECLMX  DC    F'0'      MAX LRECL
FKEYLEN   DC    H'0'      MAX KEY-LENGTH
*
          DC    CL54' '
*
FDBKLGTH  EQU   *-FDBK    LENGTH OF FDBK
         SPACE 3
***************************************************************
         MEND
./ ADD  NAME=WTSO
         MACRO
&NAME    WTSO  &TEXT
         LCLC  &TSO,&EXT,&WTO,&TXT,&RET
&TSO     SETC  'TSO'.'&SYSNDX'
&EXT     SETC  'EXT'.'&SYSNDX'
&WTO     SETC  'WTO'.'&SYSNDX'
&TXT     SETC  'TXT'.'&SYSNDX'
&RET     SETC  'RET'.'&SYSNDX'
&NAME    EXTRACT &EXT,FIELDS=TSO
         L     1,&EXT
         TM    0(1),X'80'
         BO    &TSO
         LA    1,&WTO
         SVC   35
         B     &RET
&TSO     LA    0,L'TXT&SYSNDX
         LA    1,&TXT
         SVC   93
         B     &RET
&EXT     DS    F
&WTO     DC    AL2(L'TXT&SYSNDX+4),X'4000'  INDICATE MCSFLAG=REG0
&TXT     DC    C&TEXT
&RET     DS    0H
         MEND
./ ADD  NAME=XPARM
         MACRO
         XPARM
PARMAREA DSECT
REG4     DS    F
TEXT     DS    CL124
PRMLEN   EQU   *-PARMAREA
         MEND
./ ADD  NAME=XRETURN
** TITLE   BASF STANDARD RETURN
** OWNER   128.FRANZ
** LCHNG   11/01/81 07:39:06   Z227128 FRANZ
         MACRO
&SYM     XRETURN &RC,&MODE,&SP=0
.*
.*                 EXTENDED RETURN MACRO
.*                 RESTORES REGISTERS
.*                 MAY PROVIDE RETURNCODE
.*
         GBLB  &XSAVSA,&XSAVNSA,&XSAV
         GBLC  &XSAVSP,&XSAVNAM
         LCLA  &C
         LCLB  &NC,&CF,&OM,&OS
         LCLC  &R,&NM,&XMODE,&XSP
&OM      SETB  (T'&MODE NE 'O')
&XMODE   SETC  ''
         AIF   (T'&MODE EQ 'O' OR '&MODE' EQ 'R'                       *
                               OR '&MODE' EQ '0').CONT
         MNOTE 8,'UNKNOWN OPERAND'
         MEXIT
.CONT    ANOP
         AIF   (T'&SP EQ 'N').SPFIX
         MNOTE 8,'SUBPOOL NUMBER NOT A SELF-DEFINING TERM'
         MEXIT
.SPFIX   ANOP
         AIF   ('&SP' NE '0' AND '&MODE' NE 'R').SPERR
.XSA     ANOP
         AIF   (NOT &XSAV).SETS
.SETMODE ANOP
         AIF   (&OM OR '&SP' NE '0').TESTSP
&OS      SETB  (1)
         AIF   (NOT &XSAVNSA).SETMODA
&XMODE   SETC  '0'
         MNOTE *,'NO MODE SPECIFICATION, 0 ASSUMED'
         AGO   .TESTSP
.SETMODA ANOP
         AIF   (&XSAVSA).TESTSP
&XMODE   SETC  'R'
         MNOTE *,'NO MODE SPECIFICATION, R ASSUMED'
.TESTSP  ANOP
         AIF   ('&XSAVSP' EQ '&SP').BRANCH
         AIF   ('&SP' EQ '0').SETSP
         MNOTE 8,'SUBPOOL NUMBER &SP NOT EQUAL SUBPOOL NUMBER &XSAVSP I*
               N XSAVE &XSAVNAM'
         MEXIT
.SETSP   ANOP
         MNOTE *,'SUBPOOL NUMBER &XSAVSP FROM XSAVE &XSAVNAM ASSUMED'
.BRANCH  ANOP
&XSP     SETC  '&XSAVSP'
         AIF   (&OS).SETM
.TESTSVA ANOP
         AIF   (&XSAVNSA).TESTMOD
         AIF   (&XSAVSA AND T'&MODE EQ 'O').SETM
         AIF   (NOT &XSAVSA AND '&MODE' EQ 'R').SETM
         AGO   .ERRMODE
.TESTMOD ANOP
         AIF   ('&MODE' EQ '0').SETM
.ERRMODE ANOP
         MNOTE 8,'MODE SPECIFICATION INVALID WITH REGARD TO SAVE AREA S*
               PECIFICATION IN XSAVE &XSAVNAM'
         MEXIT
.SETS    ANOP
&XSP     SETC  '&SP'
.SETM    ANOP
&XSAV    SETB  (0)
         AIF   ('&XMODE' NE '').NOERR
&XMODE   SETC  '&MODE'
.NOERR   ANOP
&NM      SETC  '&SYM'
         AIF   (T'&RC NE 'O').CODE
&NC      SETB  (1)
         AGO   .NOCODE
.CODE    ANOP
&R       SETC  '15'
         AIF   ('&RC'(1,1) EQ '(').REG
         AIF   (T'&RC EQ 'N').FIX
&NM      L     15,&RC                  LOAD CODE
&NM      SETC  ''
         AGO   .NOCODE
.FIX     ANOP
&CF      SETB  (1)
         AGO   .NOCODE
.REG     ANOP
&R       SETC  '&RC'(2,K'&RC-2)
.NOCODE  ANOP
         AIF   ('&XMODE' EQ '0').NSVA
&NM      L     13,4(0,13)              GET HIGH SA ADDR
&NM      SETC  ''
.NSVA    ANOP
         AIF   (&NC OR &CF).NOSTORE
&NM      ST    &R,16(0,13)             STORE CODE
.NOSTORE ANOP
         AIF   ('&XMODE' NE 'R').NORENT
         L     1,8(0,13)               GET LOW SA ADDR
         XR    0,0
         ICM   0,3,2(1)                GET LENGTH
         AIF   ('&SP' NE '0').SP1
         FREEMAIN  RU,LV=(0),A=(1)
         AGO   .NORENT
.SP1     ANOP
         FREEMAIN RU,LV=(0),A=(1),SP=&SP
.NORENT  LM    14,12,12(13)            RESTORE REGS
         AIF   (NOT &CF).EXIT
         LA    15,&RC                  LOAD CODE
&C       SETA  &RC
         AIF   (&C/4*4 EQ &C).EXIT
         MNOTE 0,'UNUSUAL CODE'
.EXIT    MVI   12(13),X'FF'            FORTRAN REQUIREMENT
         SPM   14                      RESTORE PGM MASK AND CC
         BR    14
         MEXIT
.SPERR   ANOP
         MNOTE 4,'SUBPOOL SPECIFICATION INVALID WITHOUT FREEMAIN FUNCTI*
               ON, IGNORED'
         AGO   .XSA
         MEND
./ ADD  NAME=XSAVE
         MACRO
&SYM     XSAVE &BASE,&AREA,&ID,&LEN,&SP=0,&LOC=
*        LAST CHANGE  8. 5. 1984           H. FRANZ
.*
.*                 EXTENDED SAVE MACRO
.*                 ASSUMES ENTRYPOINT ADDRESS IN REGISTER 15
.*                 SAVES REGISTERS 14 THROUGH 12
.*                 LOADS BASE REGISTER AND CHAINES SAVEAREAS
.*                 MAY PRODUCE REENTRANT CODE
.*
         GBLB  &XSAVSA,&XSAVNSA,&XSAV
         GBLC  &XSAVSP,&XSAVNAM
         LCLA  &OFFSET,&BASEOFF,&LLID,&DISPL,&I
         LCLA  &NREG,&REGIX,&LCH
         LCLC  &NM,&REG,&BL
         LCLC  &PREV,&IT
&XSAV    SETB  (1)
&XSAVSA  SETB  (T'&AREA NE 'O')
&XSAVNSA SETB  ('&AREA' EQ '0')
&XSAVSP  SETC  '&SP'
&XSAVNAM SETC  '&SYM'
&OFFSET  SETA  4
&NM      SETC  '&SYM'
&REG     SETC  '15'
&BL      SETC  ''
&IT      SETC  '&ID'
         AIF   (T'&SP EQ 'N').SPFIX
         MNOTE 8,'SUBPOOL NUMBER NOT A SELF-DEFINING TERM'
         MEXIT
.SPFIX   ANOP
         AIF   ('&SP' NE '0' AND T'&AREA NE 'O').SPERR
.NOERR   ANOP
         AIF   (T'&ID EQ 'O').NOID
         AIF   ('&ID' NE '*').SETLL
&I       SETA  8
         AIF   ('&NM' EQ '').SECT
&IT      SETC  '&NM'.'          '
         AGO   .FINDL
.SECT    ANOP
&IT      SETC  '&SYSECT'.'          '
.FINDL   ANOP
         AIF   ('&IT'(&I,1) NE ' ').IDEND
&I       SETA  &I-1
         AIF   (&I NE 0).FINDL
&I       SETA  5
&IT      SETC  'XSAVE'
         AGO   .XID
.IDEND   ANOP
&IT      SETC  '&IT'(1,&I)
.XID     ANOP
&LLID    SETA  &I
         AGO   .ODDEV
.SETLL   ANOP
&LLID    SETA  K'&ID
.ODDEV   ANOP
         AIF   (&LLID NE &LLID/2*2).OVBL
&BL      SETC  ' '
&LLID    SETA  &LLID+1   BLANK
.OVBL    ANOP
&LLID    SETA  &LLID+16  DATE AND TIME
&DISPL   SETA  4+1+&LLID   B,X,(DATE,ID)
&NM      B     &DISPL.(0,15)
         DC    AL1(&LLID)
         AIF   ('&ID' NE '*' AND '&ID' NE '').IDDEF
         DC    C'&IT&BL'     PGM-ID.
         AGO   .SDATE
.IDDEF   ANOP
         DC    C'&ID&BL'     PGM-ID.
.SDATE   ANOP
         DC    C'&SYSDATE'       COMPILE DATE
         DC    C' '
         DC    CL7'&SYSTIME'     COMPILE TIME
&OFFSET  SETA  4+4+1+&LLID   B,STM,X,(DATE,ID)
&NM      SETC  ''
.NOID    ANOP
&NM      STM   14,12,12(13)            SAVE REGS
         AIF   (T'&BASE EQ 'O').NOBASE
         AIF   ('&BASE'(1,1) NE '(').LOAD
&REGIX   SETA  1
&NREG    SETA  N'&BASE
&REG     SETC  '&BASE(&REGIX)'
         LR    &REG,15
&OFFSET  SETA  &OFFSET+2
.LOOP    ANOP
         USING *-&OFFSET+&BASEOFF,&REG
&REGIX   SETA  &REGIX+1
         AIF   ('&REGIX' GT '&NREG').SETUSE
&PREV    SETC  '&REG'
&REG     SETC  '&BASE(&REGIX)'
         LA    &REG,X'FFF'
         LA    &REG,1(&REG,&PREV)
&OFFSET  SETA  &OFFSET+8
&BASEOFF SETA  &BASEOFF+4096
         AGO   .LOOP
.LOAD    LR    &BASE,15                LOAD BASE REG
&OFFSET  SETA  &OFFSET+2
&REG     SETC  '&BASE'
.NOBASE  ANOP
         USING *-&OFFSET,&REG
.SETUSE  ANOP
         AIF   (T'&AREA NE 'O').NORENT
         CNOP  0,4
         BAL   1,*+8         SKIP DEFINITION
         AIF   (T'&LEN NE 'O').SPEC
         DC    A(72)       LENGTH FOR 1 SAVE AREA
         AGO   .LOAD0
.SPEC    DC    A(&LEN)     SPECIFIED LENGTH INCLUDING SAVE AREA
.LOAD0   L     0,0(,1)       GET R0 READY FOR GETMAIN
         AGO   .COMP
.SEELEN  ANOP
         AIF   (T'&LEN NE 'O').NOTZERO
         LA    0,72                    GET LENGTH
         AGO   .COMP
.NOTZERO ANOP
         L     0,=A(&LEN)             GET LENGTH
.COMP    ANOP
         AIF   (T'&LOC EQ 'O').NORMGM
         AIF   (T'&SP NE 'O').SP1
         GETMAIN   RU,LV=(0),LOC=&LOC
         AGO   .GMOK
.SP1   ANOP
         GETMAIN   RU,LV=(0),LOC=&LOC,SP=&SP
         AGO   .GMOK
.NORMGM  ANOP
         AIF   (T'&SP NE 'O').SP2
         GETMAIN   RU,LV=(0)
         AGO   .GMOK
.SP2     ANOP
         GETMAIN   RU,LV=(0),SP=&SP
.GMOK    ANOP
         XC    0(3*4,1),0(1)           ZERO CHAIN ADDRESSES
         AIF   (T'&LEN NE 'O').GET
         LA    0,72                    GET LENGTH
         AGO   .NOSTH
.GET     ANOP
         L     0,=A(&LEN)              GET LENGTH
.NOSTH   ANOP
         STH   0,2(1)                  STORE LENGTH
         AGO   .COM
.NORENT  ANOP
         AIF   ('&AREA' NE '0').SVA
         MEXIT
.SVA     ANOP
         LA    1,&AREA                 GET SA ADDR
.COM     ST    1,8(0,13)               SA DOWN CHAIN
         ST    13,4(0,1)               SA UP CHAIN
         LR    13,1                    LOAD SA REG
         L     1,4(0,13)               GET HIGH SA
         LM    0,1,20(1)               RESTORE REGS 0 AND 1
         AIF   (T'&AREA NE 'O').DBL
         MEXIT
.DBL     AIF   (T'&LEN EQ 'O').TEST
         MNOTE 4,'SAVE AREA ID AND LENGTH MUTUALLY EXCLUSIVE, LENGTH IG*
               NORED'
.TEST    AIF   (T'&AREA EQ 'U').DEFINE
         MEXIT
.SPERR   ANOP
         MNOTE 4,'SUBPOOL SPECIFICATION INVALID WITHOUT GETMAIN FUNCTIO*
               N, IGNORED'
         AGO   .NOERR
.DEFINE  B     &AREA+72                BRANCH AROUND SAVEAREA
&AREA    DC    18F'0'                  SAVEAREA
         MEND
./ ADD  NAME=ZAPMOD
         MACRO
         ZAPMOD  &N
*
*        ZAP MODIFICATION AREA
*
         DC    0D'0'
ZAPID    DC    C' ZAPMOD '
ZAPDATE  SYSDATE
         DC    &N.F'0'
         MEND
./ ADD  NAME=ZPARC
         MACRO
&NAME    ZPARC
         SPACE
* DUMMY SECTION FOR EDITED PRINT INFORMATIONS
         SPACE
         AIF   ('&NAME' EQ '').A1
&NAME    DSECT
         AGO   .A2
.A1      ANOP
ZPARCH   DSECT
.A2      ANOP
PACFILID DS    CL03 .             FILE IDENTIFIER
PACSORT  DS    CL77 .             INTERNAL SORT FIELD
         ORG       PACSORT+50          BASF MODIFICATION
PACFLAG  DS        CL1       BASF MOD   TAPE DEFECTIVE FLAG
PACDATE  DS        CL4       BASF MOD   DATE LAST USED
PACUNIT  DS        CL3       BASF MOD   CREATING UNIT
PACJOBNM DS        CL8       BASF MOD   CREATING JOB
PACSTEPN DS        CL8       BASF MOD   CREATING STEP
         ORG
PACTEXT  EQU   * .                START OF TEXT
PACVOLS  DS    CL06 .             VOLUME SERIAL NO.
PACDSN   DS    CL44 .             DATA-SET-NAME
PACSTAT  DS    CL01 .             STATUS
PACFS    DS    CL03 .             FILE SEQUENCE NUMBER
PACVS    DS    CL05 .             VOLUME SEQUENECE NUMBER
PACCRDT  DS    CL06 .             CREATION DATE
PACEXDT  DS    CL06 .             EXPIRATION DATE
PACUCT   DS    CL04 .             USE COUNT
PACAUFT  DS    CL08 .             AUFTRAGSNUMMER
PACKOST  DS    CL04 .             KOSTENSTELLE
PACAGG   DS    CL03 .             ARBEITSGANG
PACORT1  DS    CL10 .             LAGERORT (NORMAL)
PACORT2  DS    CL10 .             LAGERORT (SICHERHEIT)
PACUSET  DS    PL03 .             LAGERDAUER IN TAGEN
PACUSFLD DS    0CL03 .            USER-FIELD
PACUSFC  DS    CL01 .              (CHARACTERS)
PACUSFH  DS    CL02 .              (HEXADECIMAL)
         DS    0F
PACEND   EQU   *
PACDLEN  EQU   *-PACVOLS
PACDSLEN EQU   *-PACFILID
         SPACE
         MEND
./ ADD  NAME=ZSCPR
.*       C O M P R E S S I O N - M A C R O
.*       ---------------------------------
         MACRO
&SEGNM   ZSCPR &TYP=,&NAME=,&START=,&BYTES=,&VALUE=,&NULLVAL=,&BWRD=NO
         GBLA  &FLDCNT
         GBLB  &FLG,&FLGCS,&GERR
         GBLC  &GSEGNM
         LCLB  &FLGST,&FLGBYT,&FLGVAL,&FLGNLV,&FLGBW,&LERR
         LCLA  &DVAL,&DNLV,&DBW,&DVALC,&DVALP,&DVALX,&DSTART
         LCLA  &DFLAG1,&DFLAG2,&DBYTES
&DVAL    SETA  0
&DNLV    SETA  0
&DBW     SETA  0
&DVALC   SETA  0
&DVALP   SETA  0
&DVALX   SETA  0
.* -----
         AIF   ('&TYP' EQ 'CSECT').L10
         AIF   ('&TYP' EQ 'CPRFLD').L30
         AIF   ('&TYP' EQ 'FINAL').L50
         MNOTE 12,'*** ERROR   TYP-OPERAND IS INVALID ***'
         MEXIT
.* ----- VERARBEITUNG MACRO-TYP  C S E C T --------------------------*
.L10     ANOP
&FLGCS   SETB  1
&SEGNM   &TYP
&GSEGNM  SETC  '&SEGNM'
         ORG   &GSEGNM+32
         SPACE 3
         AGO   .EX
.* ----- VERARBEITUNG MACRO-TYP  C P R F L D ------------------------*
.L30     ANOP
&FLDCNT  SETA  &FLDCNT+1
         AIF   (T'&NAME NE 'O').LNAME
         MNOTE 12,'*** ERROR   NAME-OPERAND MUST BE SPECIFIED ***'
&LERR    SETB  1
.LNAME   AIF   (K'&NAME LE 8).START
         MNOTE 12,'*** ERROR   NAME-OPERAND EXCEEDS 8 CHARACTERS ***'
&LERR    SETB  1
.START   AIF   (T'&START EQ 'O').BYTES
         AIF   (K'&START LE 5).SFLGST
         MNOTE 12,'*** ERROR   START-OPERAND EXCEEDS 5 CHARACTERS ***'
&LERR    SETB  1
         AGO   .BYTES
.SFLGST  ANOP
&FLGST   SETB  1
.BYTES   AIF   (T'&BYTES EQ 'O').VALUE
         AIF   (K'&BYTES LE 5).STDEF
         MNOTE 12,'*** ERROR   BYTES-OPERAND EXCEEDS 5 CHARACTERS ***'
&LERR    SETB  1
         AGO   .VALUE
.STDEF   AIF   (&FLGST).SFLGBYT
         MNOTE 12,'*** ERROR   BYTES-OPERAND ONLY VALID WITH START-OPERC
               AND ***'
&LERR    SETB  1
         AGO   .VALUE
.SFLGBYT ANOP
&FLGBYT  SETB  1
.VALUE   AIF   (T'&VALUE EQ 'O').NULLVAL
         AIF   ('&VALUE'(1,1) EQ 'C' OR '&VALUE'(1,1) EQ 'P' OR '&VALUEC
               '(1,1) EQ 'X').CVALUE
         MNOTE 12,'*** ERROR   VALUE-OPERAND IS INVALID ***'
&LERR    SETB  1
         AGO   .NULLVAL
.CVALUE  AIF   (K'&VALUE LE 5).SFLGVAL
         MNOTE 12,'*** ERROR   VALUE-OPERAND EXCEEDS 5 CHARACTERS ***'
&LERR    SETB  1
         AGO   .NULLVAL
.SFLGVAL ANOP
&FLGVAL  SETB  1
.NULLVAL ANOP
         AIF   (T'&NULLVAL EQ 'O').BWRD
         AIF   ('&NULLVAL'(1,1) EQ 'C' OR '&NULLVAL'(1,1) EQ 'X' OR '&NC
               ULLVAL'(1,1) EQ 'P').CNLV
         MNOTE 12,'*** ERROR   NULLVAL-OPERAND IS INVALID ***'
&LERR    SETB  1
         AGO   .BWRD
.CNLV    ANOP
         AIF   (K'&NULLVAL LE 5).SFLGNLV
         NMOTE 12,'*** ERROR   NULLVAL-OPERAND EXCEEDS 5 CHARACTERS ***C
               '
&LERR    SETB  1
         AGO   .BWRD
.SFLGNLV ANOP
&FLGNLV  SETB  1
.BWRD    ANOP
         AIF   (T'BWRD EQ 'O').CHCKERR
         AIF   ('&BWRD' EQ 'YES' OR '&BWRD' EQ 'NO').SFLGBW
         MNOTE 12,'*** ERROR   BWRD-OPERAND IS INVALID ***'
&LERR    SETB  1
         AGO   .CHCKERR
.SFLGBW  ANOP
&FLGBW   SETB  ('&BWRD' EQ 'YES')
.* ----- CHECK ERROR
.CHCKERR ANOP
         AIF   (NOT (&LERR)).TABDEF
&GERR    SETB  1
         MEXIT
.* ----- TABLE DEFINITION
.TABDEF  ANOP
         AIF   (&FLGCS).T10
         MNOTE 12,'*** ERROR   MACRO-TYP -CSECT- NOT SPECIFIED'
&GERR    SETB  1
         MEXIT
.T10     ANOP
         AIF   (&FLG).T101
&FLG     SETB  1
         DC    AL2(0),AL2(0),A(0)       ANZ. FLDTAB, FLDTAB-LL, RES.
.T101    ANOP
         DC    CL8'&NAME'               FIELDNAME
         AIF   (NOT (&FLGVAL)).T11
&DVAL    SETA  1
.T11     ANOP
         AIF   (NOT (&FLGNLV)).T12
&DNLV    SETA  2
.T12     ANOP
         AIF   (NOT (&FLGBW)).T13
&DBW     SETA  4
.T13     ANOP
&DFLAG1  SETA  &DVAL+&DNLV+&DBW
         DC    AL1(&DFLAG1)             FLAG1  1=VALUE 2=NULLVAL 4=BWRD
.* -----
         AIF   (&FLGVAL).T131
         DC    AL1(0)                   FLAG2  1=C     2=P     4=X
         AGO   .T18
.T131    AIF   ('&VALUE'(1,1) NE 'C').T14
&DVALC   SETA  1
.T14     ANOP
         AIF   ('&VALUE'(1,1) NE 'P').T15
&DVALP   SETA  2
.T15     ANOP
         AIF   ('&VALUE'(1,1) NE 'X').T16
&DVALX   SETA  4
.T16     ANOP
&DFLAG2  SETA  &DVALC+&DVALP+&DVALX
         DC    AL1(&DFLAG2)             FLAG2  1=C     2=P     4=X
.* -----
.T18     AIF   (&FLGST).T20
         DC    AL2(0)                   FIELD START OFFSET
         AGO   .T30
.T20     AIF   (&START GE 1).T22
         MNOTE 12,'*** ERROR   START-OPERAND IS INVALID ***'
         MEXIT
.T22     ANOP
&DSTART  SETA  &START-1
         DC    AL2(&DSTART)             FIELD START OFFSET
.T30     AIF   (&FLGBYT).T32
         DC    AL1(0)                   FIELD LENGTH
         AGO   .T40
.T32     AIF   (&BYTES GE 1).T34
         MNOTE 12,'*** ERROR   BYTES-OPERAND IS INVALID ***'
         MEXIT
.T34     ANOP
&DBYTES  SETA  &BYTES-1
         DC    AL1(&DBYTES)             FIELD LENGTH
.T40     AIF   (&FLGVAL).T42
         DC    AL1(0)                   VALUE CHARACTER
         AGO   .T50
.T42     ANOP
         DC    &VALUE                   VALUE CHARACTER
.T50     AIF   (&FLGNLV).T52
         DC    AL1(0)                   NULLVAL CHARACTER
         AGO   .T60
.T52     ANOP
         DC    &NULLVAL                 NULLVAL CHARACTER
.T60     DC    AL1(0)                   RESERVED
         SPACE 3
         AGO   .EX
.* ----- VERARBEITUNG MACRO-TYP  F I N A L --------------------------*
.L50     ANOP
&GSEGNM.E EQU   *
         ORG   &GSEGNM+26
         DC    AL2(&GSEGNM.E-&GSEGNM)   COMP. PARAMETER LENGTH
         DC    A(0)                     RESERVED
&FLG     SETB  0
         AIF   (&FLDCNT EQ 0).EX
         DC    AL2(&FLDCNT)             FIELD TAB COUNT
         DC    AL2(16)                  FIELD TAB LENGTH
         DC    A(0)                     RESERVED
.EX      ANOP
         MEND
./ ADD  NAME=ZSDBXREF
         EJECT
*---------------------------------------------------------------------*
*              H E A D E R                                            *
*---------------------------------------------------------------------*
         SPACE 1
$DBXHDR  DSECT
$HDXNAME DS    CL8           MODULE NAME (DBD-NAME)
$HDXGENV DS    CL5           VERSION
$HDXDATE DS    PL3           GENERATION DATE (YYDDDF)
$HDXDSTB DS    A             OFFSET FROM LOAD MODULE TO DATA SET TABLE
$HDXDSLL DC    AL2($DSXELL)  LENGTH OF EACH DATA SET TABLE ENTRY
$HDXDSNO DS    H             NUMBER OF DATA SET TABLE ENTRIES
$HDXDSMX EQU   16            MAX. # OF DATA SET TABLE ENTRIES
$HDXSGTB DS    A             OFFSET FROM LOAD MODULE TO SEGMENT TABLE
$HDXSGLL DS    AL2($SGXELL)  LENGTH OF EACH SEGMENT TABLE ENTRY
$HDXSGNO DS    H             NUMBER OF SEGMENT TABLE ENTRIES
$HDXSGMX EQU   256           MAX. # OF SEGMENT TABLE ENTRIES
         DS    8F            RESERVED
$HDXLL   EQU   *-$DBXHDR     LENGTH OF HEADER
         EJECT
*---------------------------------------------------------------------*
*              D A T A    S E T    T A B L E                          *
*---------------------------------------------------------------------*
         SPACE 1
$DSXTAB  DSECT
$DSXENTR DS    0CL1
$DSXDDN  DS    CL8           DATA SET DD-NAME
$DSXDSN  DS    CL44          DATA SET NAME
         DS    CL8           RESERVED
$DSXELL  EQU   *-$DSXENTR    LENGTH OF EACH DATA SET TABLE ENTRY
         EJECT
*---------------------------------------------------------------------*
*              S E G M E N T    T A B L E                             *
*---------------------------------------------------------------------*
         SPACE 1
$SGXTAB  DSECT
$SGXENTR DS    0CL1
$SGXSGNM DS    CL8           SEGMENT NAME
$SGXSGLL DS    H             SEGMENT LENGTH FROM DBD
$SGXCPNM DS    CL8           NAME OF SEGMENT'S DATA STRUCTURE
         DS    CL6           RESERVED
$SGXELL  EQU   *-$SGXENTR    LENGTH OF EACH SEGMENT TABLE ENTRY
./ ADD  NAME=ZSDB0301
*        FOD/K-ZS                  SATZBESCHREIBUNG    13.06.77
*        SACHGEBIET                SD (SOFTWARE-DATEN IMS)
*        SATZ                      SEGMENT: RSEG     (FEHLER-DATEN)
ZSDB0301 DSECT
RSEG     DS    0F
RLL      DS    CL2
RSEGKEY  DS    0CL13
RFEHLID  DS    0CL6
RSG      DS    CL2
RSGNR    DS    CL2
         DC    CL2' '
RNR      DC    CL7'0000000'
RDATUM   DS    PL4
RZEIT    DS    PL4
RKZLOE   DC    CL1' '
RABSID   DS    CL8
REMPFID  DS    CL8
RKZFLG   DC    CL1' '
RFLGNR   DC    CL2'00'
RFIL     DC    CL4'  '
RZAEHLER DC    BL2'00'
RSLEN    EQU   *-RSEG
RSEGM    EQU   *
./ ADD  NAME=ZSDB13A
***********************************************************************
* FLD/K-ZS               DATEIBESCHREIBUNG                 12.08.1980 *
* ARBEITSGEBIET          : ZS                                         *
* SEGMENT                : ZSDB13A                                    *
* SEGMENT-BEZEICHNUNG    : ROOT-SEGMENT + BEZ. ZU ANDEREN ROOTS       *
***********************************************************************
         SPACE 3
ZSDB13A  DSECT ,
ALEN     DS    H                                                    000
ASEGKEY  DS    0CL48                                                002
ASEGID   DS    CL4       KKK=................                       002
ADBD     DS    0CL8           DBD=      DATENBANK-NAME              006
APGM     DS    0CL8           PGM=      PROGRAMM-NAME               006
ATRC     DS    0CL8           TRC=      TRANSACTIONS-CODE           006
AICJ     DS    0CL8           ICJ=      IMAGE COPY JOB              006
ADBA     DS    0CL8           DBA=      DB-ANALYZER JOB             006
ADSN     DS    0CL16          DSN=      DB-DATASET                  006
AGDG     DS    0CL25          GDG=      IMAGE COPY GENERATION       006
AICG     DS    0CL1           ICG=      IMAGE COPY JOB GRUPPE       006
         SPACE 3
ASEGK1   DS    CL44                                                 006
ASEGISRT DS    CL5            DATUM NEUAUFNAHME                     050
ASEGUPDT DS    CL5            DATUM LETZTE AENDERUNG                055
         SPACE 3
ASEGC    DS    0CL1           START DER TYPE-ABHAENGIGEN DATEN      060
ASEGLEN  EQU   *-ALEN                                               060
./ ADD  NAME=ZSDB13AC
** TITLE   SEGMENT COPIES ZSDB13
** OWNER   ZS
** LCHNG   10/14/82 14:00:45   H905536 KISSEL
***********************************************************************
* FLD/K-ZS               DATEIBESCHREIBUNG                 14.10.1982 *
* ARBEITSGEBIET          : ZS                                         *
* SEGMENT                : ZSDB13AA                                   *
* SEGMENT-BEZEICHNUNG    : ROOT-SEGMENT + BEZ. ZU ANDEREN ROOTS       *
***********************************************************************
         SPACE 3
ZSDB13AC DSECT ,
ZSDB13A  DS    0C                                                   000
ALEN     DS    H                                                    000
ASEGKEY  DS    0CL48                                                002
ASEGID   DS    CL4       KKK=................                       002
ADBD     DS    0CL8           DBD=      DATENBANK-NAME              006
APGM     DS    0CL8           PGM=      PROGRAMM-NAME               006
ATRC     DS    0CL8           TRC=      TRANSACTIONS-CODE           006
AICJ     DS    0CL8           ICJ=      IMAGE COPY JOB              006
ADBA     DS    0CL8           DBA=      DB-ANALYZER JOB             006
ARDJ     DS    0CL8           RDJ=      RESTORE JOB                 006
ARCJ     DS    0CL8           RCJ=      RECOVERY JOB                006
AICS     DS    0CL8           ICS=      IMAGE-COPY STEP-NAME        006
ADSN     DS    0CL16          DSN=      DB-DATASET                  006
AGDG     DS    0CL25          GDG=      IMAGE COPY GENERATION       006
AICG     DS    0CL1           ICG=      IMAGE COPY JOB GRUPPE       006
ACOM     DS    0CL6           COM=      KOMMENTARE FUER DIE AV      006
         SPACE ,
ASEGK1   DS    CL44                                                 006
AMINLEN  EQU   *-ALEN                                               050
ASEGISRT DS    CL5            DATUM NEUAUFNAHME                     050
ASEGUPDT DS    CL5            DATUM LETZTE AENDERUNG                055
         SPACE ,
ASEGC    DS    0CL1           START DER TYPE-ABHAENGIGEN DATEN      060
ASEGLEN  EQU   *-ALEN                                               060
         SPACE 3
***********************************************************************
* LFD/K-ZS               DATEIBESCHREIBUNG                 12.03.1981 *
* ARBEITSGEBIET          : ZS                                         *
* SEGMENT                : ZSDB13C                                    *
* SEGMENT-BEZEICHNUNG    : TYPE ABHAENGIGE DATEN (HOCHGEZOGEN IN'S    *
*                                                  ROOTSEGMENT)       *
***********************************************************************
         SPACE 3
ZSDB13C  DS    0C                                                   000
CSEGKEY  DS    0CL2                                                 000
         SPACE 3
CP1SEG   EQU   *   ----------DESCR. FOR P1 SEGMENT----------
CKEYCP1  DS    CL2       'P1'      ALLGEM. DATEN PROGRAMMVERZEICHNIS000
CTEXTPGM DS    CL49                PROGRAMMBEZEICHNUNG              002
CPGMKAT  DS    CL1                 PROGRAMMKATEGORIE                051
CBEARB   DS    CL1                 BEARBEITUNGSSTAND                052
CPGMTYPX DS    CL1                 PGM-TYP (A=ANW,D=DIENST,U=UPGM)  053
CMASCH   DS    CL1                 DV-SYSTEM                        054
CLANG    DS    CL1                 PROGRAMMIERSPRACHE               055
CREGION  DS    CL3                 REGION-GROESSE IN K              056
CEROEFF  DS    CL6                 DATUM  EROEFFNUNG                059
CLUPDTE  DS    CL6                        LETZTE AENDERUNG          065
CINAKT   DS    CL6                        INAKTIVIERUNG             071
C#CHNG   DS    PL3                 ANZAHL AENDERUNGEN               077
CSBAUTH  DS    CL3                       AUTHOR                     080
CSBANAL  DS    CL3                       ANALYTIKER                 083
CIMSP1   DS    0CL19  -------------IMS ZUSATZDATEN------------------086
CRESP1   DS    CL1                 RESIDENT / DOPT                  086
CPSB     DS    CL8                 PSB-NAME                         087
CPGMTYP  DS    0CL4                PROGRAMM-TYP                     095
COVLY    DS    CL1                      OVERLAY                     095
CCLASS   DS    CL3                      CLASS                       096
CSCHDTYP DS    CL1                 SCHEDULE-TYP                     099
CIQF     DS    CL1                 IQF                              100
CFURA    DS    CL2                 FURA-VERSION                     101
CIN      DS    CL1                 INTERNE NACHRICHTEN              103
CGENIMS  DS    CL1                 Y/N FOR IMS-STAGE1-GEN           104
CP1LEN   EQU   *-CP1SEG                                             105
         SPACE 5
         ORG   ZSDB13C
CTCSEG   DS    0C  ----------DESCR. FOR TC SEGMENT----------
CKEYCTC  DS    CL2       'TC'      TRANSAKTIONSDATEN                000
CTEXTTC  DS    CL50                BESCHREIBUNG DER TRANSAKTION     002
CWFI     DS    CL1                 WAIT FOR INPUT TRANSAKTION       052
CPRTY    DS    0CL9                PRIORITAET                       053
CPRTYN   DS    CL2                      NORMAL                      053
CPRTYL   DS    CL2                      LIMIT                       055
CPRTYLC  DS    CL5                      LIMIT-COUNT                 057
CMSGTYPE DS    0CL5                MESSAGE-TYP                      062
CSEG     DS    CL1                      MULTSEG / SNGLSEG           062
CRESP    DS    CL1                      RESPONSE / NONRESPONSE      063
CTCCLASS DS    CL3                      TRANSACTION-CLASS           064
CPROCLIM DS    0CL10               PROCESSING LIMIT                 067
CPRLIMC  DS    CL5                      COUNT                       067
CPRLIMS  DS    CL5                      SECONDS                     072
CPARLIM  DS    CL5                                                  077
CSCHD    DS    CL1                 SCHEDULING OPTION                082
CINQ     DS    0CL2                INQUIRY                          083
CINQD    DS    CL1                      YES / NO                    083
CINQR    DS    CL1                      RECOVER / NONRECOVER        084
CMODE    DS    CL1                 MODE                             085
CEDIT    DS    0CL9                EDIT ROUTINE                     086
CEDITT   DS    CL1                      UC / ULC                    086
CEDITR   DS    CL8                      EDIT ROUTINE NAME           087
CSPA     DS    0CL7                SCRATCH PAD AREA                 095
CSIZE    DS    CL5                      SIZE                        095
CLOC     DS    CL1                      LOCATION  (BLANK=NONCONVERS.100
CFIXED   DS    CL1                      FIXED                       101
CSEGNO   DS    CL5                 NUMBER OF SEGMENTS               102
CSEGSIZE DS    CL5                 SIZE OF SEGMENTS                 107
CTCARBN  DS    CL4  ARBEITS--NUMMER                              N  112
CTCKSTYP DS    CL1  VERRECHNUNGS-TYP(T,B:TRANSACTION;L:LTERM)       116
CTCLEN   EQU   *-CTCSEG                                             117
         SPACE 5
         ORG   ZSDB13C
CDBSEG   DS    0C  ----------DESCR. FOR DB SEGMENT----------
CKEYCDB  DS    CL2       'DB'      ALLGEM. DATEN DATENBANK          000
CTEXTDB  DS    CL50                DATENBANKBEZEICHNUNG             002
CIMSDB   DS    0CL3                IMS ZUSATZDATEN                  052
CINDEX   DS    CL1                      INDEX                       052
CRESDB   DS    CL1                      RESIDENT                    053
CONL     DS    CL1                      ONLINE DATENBANK            054
CSICH    DS    CL1                     DATENSICHERUNG      J/N      055
CARBN    DS    CL4                     ARBEITSNUMMER       NNNN     056
CAKU     DS    CL1                     AKU-NR              N        060
CRHTM    DS    CL1                     RHYTHMUS DER DATENSICHERUNG  061
CSICPY   DS    CL1                     SICHERUNGS-COPY     N        062
CAUSL    DS    CL1                     SICHERHEITS-AUSLAG. J/N      063
CGDG     DS    CL2                     GDG                 NN       064
CRETPD   DS    CL4                     RETPD  ANGABE       NNNN     066
CDBLEN   EQU   *-CDBSEG                                             070
CDBZUSAT DS    CL64                    ZUSATZDATEN                  070
CDBLEN1  EQU   *-CDBSEG                                             134
         SPACE 5
         ORG   ZSDB13C
CDSSEG   DS    0C  ------DESCR. FOR DS SEGMENT---------------
CKEYCDSN DS    CL2     'DS'      ALLGEM. DATEN DB-DATEI             000
CDDNAME  DS    CL8     DD-NAME                                      002
CSPACE   DS    CL13    '...,(...,...)'   SPACE ANGABEN              010
CBLKSIZE DS    CL5     BLKSIZE DER DATEI                            023
CUNIT    DS    CL5     UNIT DER DATEI                               028
CVSAMKZ  DS    CL1     VSAM-DATASET KENNZEICHEN  'V'/' '            033
CDSKOPIE DS    CL1     BLANK, ODER 1-9, WENN ES EINE DB-KOPIE IST.  034
CDSEXTRA DS    CL1     UNBENUTZT                                    035
CDSLEN   EQU   *-CDSSEG                                             036
         SPACE 5
         ORG   ZSDB13C
CGDSEG   DS    0C  ------DESCR. FOR GDG SEGMENT---------------
CGDMSS   DS    CL1     GDG AUF MSS      J/N                         000
CGDGGS   DS    CL2     MSS-GRUPPE SPACE   Z.B. 02 -> GR...S02 .     001
*                      WENN BLANK, DANN DEFAULT AUS CSPACE ERRECHNET.
CGDLEN   EQU   *-CGDSEG                                             003
         SPACE 5
         ORG   ZSDB13C
CIJSEG   DS    0C  ------DESCR. FOR ICJ SEGMENT---------------
CIJICG   DS    CL1     IMAGE COPY GRUPPE                            000
CIJLEN   EQU   *-CIJSEG                                             001
CIJZUSAT DS    CL64    ZUSATZDATEN                                  001
CIJLEN1  EQU   *-CIJSEG                                             065
         SPACE 5
         ORG   ZSDB13C
CISSEG   DS    0C  ------DESCR. FOR ICS SEGMENT---------------
CISMSS   DS    CL1     MSS J/N   ODER BLANK --> CGDMSS IST DEFAULT  000
CISLEN   EQU   *-CISSEG                                             001
         SPACE 3
CIGLEN   EQU   0       LANGE ICG SEGMENT, TEIL C                    000
         SPACE 1
CDALEN   EQU   0       LANGE DBA SEGMENT, TEIL C                    000
         SPACE 1
CRDLEN   EQU   0       LANGE RDJ SEGMENT, TEIL C                    000
         SPACE 1
CRCLEN   EQU   0       LANGE RCJ SEGMENT, TEIL C                    000
AMAXLEN  EQU   1000    MAXIMALE LAENGE VON SEGMENT A
BMAXLEN  EQU   1000    MAXIMALE LAENGE VON SEGMENT B
ABMAXLEN EQU   1000    MAXIMALE LAENGE VON SEGMENT A BZW B
./ ADD  NAME=ZSDB13C
***********************************************************************
* LFD/K-ZS               DATEIBESCHREIBUNG                 12.08.1980 *
* ARBEITSGEBIET          : ZS                                         *
* SEGMENT                : ZSDB13C                                    *
* SEGMENT-BEZEICHNUNG    : TYPE ABHAENGIGE DATEN (HOCHGEZOGEN IN'S    *
*                                                  ROOTSEGMENT)       *
***********************************************************************
         SPACE 3
ZSDB13C  DSECT ,
CSEGKEY  DS    0CL2                                                 000
         SPACE 3
CP1SEG   EQU   *   ----------DESCR. FOR P1 SEGMENT----------
CKEYCP1  DS    CL2       'P1'      ALLGEM. DATEN PROGRAMMVERZEICHNIS000
CTEXTPGM DS    CL49                PROGRAMMBEZEICHNUNG              002
CPGMKAT  DS    CL1                 PROGRAMMKATEGORIE                051
CBEARB   DS    CL1                 BEARBEITUNGSSTAND                052
CPGMTYPX DS    CL1                 PGM-TYP (A=ANW,D=DIENST,U=UPGM)  053
CMASCH   DS    CL1                 DV-SYSTEM                        054
CLANG    DS    CL1                 PROGRAMMIERSPRACHE               055
CREGION  DS    CL3                 REGION-GROESSE IN K              056
CEROEFF  DS    CL6                 DATUM  EROEFFNUNG                059
CLUPDTE  DS    CL6                        LETZTE AENDERUNG          065
CINAKT   DS    CL6                        INAKTIVIERUNG             071
C#CHNG   DS    PL3                 ANZAHL AENDERUNGEN               077
CSBAUTH  DS    CL3                       AUTHOR                     080
CSBANAL  DS    CL3                       ANALYTIKER                 083
CIMSP1   DS    0CL19  -------------IMS ZUSATZDATEN------------------086
CRESP1   DS    CL1                 RESIDENT / DOPT                  086
CPSB     DS    CL8                 PSB-NAME                         087
CPGMTYP  DS    0CL4                PROGRAMM-TYP                     095
COVLY    DS    CL1                      OVERLAY                     095
CCLASS   DS    CL3                      CLASS                       096
CSCHDTYP DS    CL1                 SCHEDULE-TYP                     099
CIQF     DS    CL1                 IQF                              100
CFURA    DS    CL2                 FURA-VERSION                     101
CIN      DS    CL1                 INTERNE NACHRICHTEN              103
CGENIMS  DS    CL1                 Y/N FOR IMS-STAGE1-GEN           104
CP1LEN   EQU   *-CP1SEG                                             105
         EJECT ,
CTCSEG   DSECT ,   ----------DESCR. FOR TC SEGMENT----------
CKEYCTC  DS    CL2       'TC'      TRANSAKTIONSDATEN                000
CTEXTTC  DS    CL50                BESCHREIBUNG DER TRANSAKTION     002
CWFI     DS    CL1                 WAIT FOR INPUT TRANSAKTION       052
CPRTY    DS    0CL9                PRIORITAET                       053
CPRTYN   DS    CL2                      NORMAL                      053
CPRTYL   DS    CL2                      LIMIT                       055
CPRTYLC  DS    CL5                      LIMIT-COUNT                 057
CMSGTYPE DS    0CL5                MESSAGE-TYP                      062
CSEG     DS    CL1                      MULTSEG / SNGLSEG           062
CRESP    DS    CL1                      RESPONSE / NONRESPONSE      063
CTCCLASS DS    CL3                      TRANSACTION-CLASS           064
CPROCLIM DS    0CL10               PROCESSING LIMIT                 067
CPRLIMC  DS    CL5                      COUNT                       067
CPRLIMS  DS    CL5                      SECONDS                     072
CPARLIM  DS    CL5                                                  077
CSCHD    DS    CL1                 SCHEDULING OPTION                082
CINQ     DS    0CL2                INQUIRY                          083
CINQD    DS    CL1                      YES / NO                    083
CINQR    DS    CL1                      RECOVER / NONRECOVER        084
CMODE    DS    CL1                 MODE                             085
CEDIT    DS    0CL9                EDIT ROUTINE                     086
CEDITT   DS    CL1                      UC / ULC                    086
CEDITR   DS    CL8                      EDIT ROUTINE NAME           087
CSPA     DS    0CL7                SCRATCH PAD AREA                 095
CSIZE    DS    CL5                      SIZE                        095
CLOC     DS    CL1                      LOCATION  (BLANK=NONCONVERS.100
CFIXED   DS    CL1                      FIXED                       101
CSEGNO   DS    CL5                 NUMBER OF SEGMENTS               102
CSEGSIZE DS    CL5                 SIZE OF SEGMENTS                 107
CTCARBN  DS    CL4  ARBEITS--NUMMER                              N  112
CTCKSTYP DS    CL1  VERRECHNUNGS-TYP(T,B:TRANSACTION;L:LTERM)       116
CTCLEN   EQU   *-CTCSEG                                             117
         EJECT ,
CDBSEG   DSECT ,   ----------DESCR. FOR DB SEGMENT----------
CKEYCDB  DS    CL2       'DB'      ALLGEM. DATEN DATENBANK          000
CTEXTDB  DS    CL50                DATENBANKBEZEICHNUNG             002
CIMSDB   DS    0CL3                IMS ZUSATZDATEN                  052
CINDEX   DS    CL1                      INDEX                       052
CRESDB   DS    CL1                      RESIDENT                    053
CONL     DS    CL1                      ONLINE DATENBANK            054
CSICH    DS    CL1                     DATENSICHERUNG      J/N      055
CARBN    DS    CL4                     ARBEITSNUMMER       NNNN     056
CAKU     DS    CL1                     AKU-NR              N        060
CRHTM    DS    CL1                     RHYTHMUS DER DATENSICHERUNG  061
CSICPY   DS    CL1                     SICHERUNGS-COPY     N        062
CAUSL    DS    CL1                     SICHERHEITS-AUSLAG. J/N      063
CGDG     DS    CL2                     GDG                 NN       064
CRETPD   DS    CL4                     RETPD  ANGABE       NNNN     066
CDBEXTR1 DS    CL9                     2. SATZ RHTM BIS RETPD       070
CDBEXTR2 DS    CL9                     3. SATZ RHTM BIS RETPD       079
CDBLEN   EQU   *-CDBSEG                                             088
CDBREMAR DS    CL64                    BEMERKUNG                    088
CDBLEN1  EQU   *-CDBSEG                                             152
         EJECT ,
CDSSEG   DSECT ,   ------DESCR. FOR DS SEGMENT---------------
CKEYCDSN DS    CL2     'DS'      ALLGEM. DATEN DB-DATEI             000
CDDNAME  DS    CL8     DD-NAME                                      002
CSPACE   DS    CL13    '...,(...,...)'   SPACE ANGABEN              010
CBLKSIZE DS    CL5     BLKSIZE DER DATEI                            023
CUNIT    DS    CL6     UNIT DER DATEI                               028
CDSEXTRA DS    CL2     BYTE 1: ' '/1/2 (ZU CDBEXTR1 ODER CDBEXTR2)  034
*                      BYTE 2: ' '/*  (BEI * DAHINTER NOCH SONDERDATEN)
CDSLEN   EQU   *-CDSSEG                                             036
         SPACE 3
CGDSEG   DSECT ,   ------DESCR. FOR GDG SEGMENT---------------
CGDMSS   DS    CL1     GDG AUF MSS      J/N                         000
CGDEXTRA DS    CL2     BYTE 1: ' '/1/2 (ZU CDBEXTR1 ODER CDBEXTR2)  001
*                      BYTE 2: ' '/*  (BEI * DAHINTER NOCH SONDERDATEN)
CGDLEN   EQU   *-CGDSEG                                             003
         SPACE 3
CIJSEG   DSECT ,   ------DESCR. FOR ICJ SEGMENT---------------
CIJICG   DS    CL1     IMAGE COPY GRUPPE                            000
CIJLEN   EQU   *-CIJSEG                                             001
CIJREMAR DS    CL64    BEMERKUNG                                    001
CIJLEN1  EQU   *-CIJSEG                                             065
         SPACE 3
CIGLEN   EQU   0       LANGE ICG SEGMENT, TEIL C                    000
         SPACE 3
CDALEN   EQU   0       LANGE DBA SEGMENT, TEIL C                    000
./ ADD  NAME=ZSDS0301
*        FOD/K-ZS                 SATZBESCHREIBUNG    31.03.777
*        SACHGEBIET               SD (SOFTWARE-DATEN IMS)
*        SATZ                     SSA FUER SEGMENT: RSEG
ZSDS0301 DS   0F
SSARSEG  DS   0CL37
SEG      DC   CL8'RSEG    '
ANFCOM   DC   CL1'*'
COM      DS   0CL3
COM1     DC   CL1'-'
COM2     DC   CL1'-'
COM3     DC   CL1'-'
ANFQUAL  DC   CL1'('
SCHL     DC   CL8'SEG-KEY '
OPR      DC   CL2' ='
WERT     DS   0CL13
SFEHLID  DS   0CL6
SSG      DS   CL2
SSGNR    DS   CL2
         DC   CL2' '
SNR      DS   CL7
ENDQUAL  DC   CL1')'
./ ADD  NAME=ZSFLDCP
         EJECT
*---------------------------------------------------------------------*
*              H E A D E R                                            *
*---------------------------------------------------------------------*
         SPACE 1
$HEADER  DSECT
$HDRNAME DS    CL8           MODULE NAME
$HDRGENV DS    CL5           VERSION
$HDRDATE DS    PL3           GENERATION DATE (YYDDDF)
$HDRLVTB DS    A             OFFSET FROM LOAD MODULE TO LEVEL TABLE
$HDRLVLL DC    AL2($LEVELL)  LENGTH OF EACH LEVEL TABLE ENTRY
$HDRLVNO DS    H             NUMBER OF LEVEL TABLE ENTRIES
$HDRLVMX EQU   15            MAX. # OF LEVEL TABLE ENTRIES
$HDRFLTB DS    A             OFFSET FROM LOAD MODULE TO FIELD TABLE
$HDRFLLL DC    AL2($FLDELL)  LENGTH OF EACH FIELD TABLE ENTRY
$HDRFLNO DS    H             NUMBER OF FIELD TABLE ENTRIES
$HDRFLMX EQU   1024          MAX. # OF FIELD TABLE ENTRIES
$HDRFDTB DS    A             OFFSET FROM LOAD MODULE TO
*                            FIELD DEPENDENT SECTION
$HDRFDMX EQU   1024          MAX. LENGTH OF FIELD DPENDENT SECTIONS
         DS    8F            RESERVED
$HDRLL   EQU   *-$HEADER     LENGTH OF HEADER
         EJECT
*---------------------------------------------------------------------*
*              L E V E L    T A B L E                                 *
*---------------------------------------------------------------------*
         SPACE 1
$LEVTAB  DSECT
$LEVENTR DS    0CL1
$LEVFLD1 DS    A             OFFSET FROM LOAD MODULE TO 1ST FIELD
*                            IN FIELD TABLE AT THIS LEVEL
$LEVELL  EQU   *-$LEVENTR    LENGTH OF EACH LEVEL TABLE ENTRY
         EJECT
*---------------------------------------------------------------------*
*              F I E L D    T A B L E                                 *
*---------------------------------------------------------------------*
         SPACE 1
$FLDTAB  DSECT
$FLDENTR DS    0CL1
$FLDLVNO DS    X             LEVEL NUMBER
$FLDTYP  DS    X             FIELD TYPE
$TYPFLG  EQU   X'01'         FIXED LENGTH GROUP       GRP=01
$TYPAB   EQU   X'02'         ALPHABETIC               GRP=02
$TYPAN   EQU   X'03'         ALPHANUMERIC             GRP=02
$TYPVLG  EQU   X'04'         VARIABLE LENGTH GROUP    GRP=01
$TYPNE   EQU   X'05'         NUMERIC EDITED           GRP=02
$TYPSR   EQU   X'06'         STERLING REPORT          GRP=02
$TYPUI   EQU   X'07'         USAGE INDEX              GRP=04
$TYPED   EQU   X'08'         EXTERNAL DECIMAL         GRP=04
$TYPEF   EQU   X'09'         EXTERNAL FLOATING-POINT  GRP=02
$TYPIF   EQU   X'0A'         INTERNAL FLOATING-POINT  GRP=08
$TYPB    EQU   X'0B'         BINARY                   GRP=04
$TYPID   EQU   X'0C'         INTERNAL DECIMAL         GRP=04
$TYPSN   EQU   X'0D'         STERLING NONREPORT       GRP=02
$TYPANE  EQU   X'0E'         ALPHANUMERIC EDITED      GRP=02
$TYPREN  EQU   X'0F'         RENAMES (LEVEL-66)       GRP=10
$FLDGRP  DS    X             GROUP OF FIELD TYPE
$GRP01   EQU   X'01'         FOR FIELD TYPES:
*                                FIXED LENGTH GROUP
*                                VARIABLE LENGTH GROUP
$GRP02   EQU   X'02'         FOR FIELD TYPES:
*                                ALPHABETIC
*                                ALPHANUMERIC
*                                NUMERIC EDITED
*                                STERLING REPORT
*                                EXTERNAL FLOATING-POINT
*                                STERLING NONREPORT
*                                ALPHABETIC EDITED
$GRP04   EQU   X'04'         FOR FIELD TYPES:
*                                USAGE INDEX
*                                EXTERNAL DECIMAL
*                                BINARY
*                                INTERNAL DECIMAL
$GRP08   EQU   X'08'         FOR FIELD TYPES:
*                                INTERNAL FLOATING-POINT
$GRP10   EQU   X'10'         FOR FIELD TYPES:
*                                RENAMES (LEVEL-66)
$FLDJUSI DS    X             JUSTAGE AND SIGN SPECIFICATION
$JURIGHT EQU   X'01'         JUSTIFIED RIGHT
$JULEFT  EQU   X'02'         JUSTIFIED LEFT
$SILEAD  EQU   X'04'         LEADING SIGN
$SITRAIL EQU   X'08'         TRAILING SIGN
$SISEP   EQU   X'10'         SEPARATE SIGN
$SIOVER  EQU   X'20'         OVERPUNCH
$FLDLCFF DS    0X            FORWARD CHAIN FLAG
$LCFIRST EQU   X'0F'         FIRST FIELD AT THIS LEVEL
*                            UNDER THIS FIELD'S PARENT FIELD
$LCLAST  EQU   X'F0'         LAST FIELD AT THIS LEVEL
*                            UNDER THIS FIELD'S PARENT FIELD
$FLDSLVF DS    A             FORWARD CHAIN AT SAME LEVEL
$FLDLCBF DS    0X            BACKWARD CHAIN FLAG
*                            (SEE $FLDLCFF ABOVE)
$FLDSLVB DS    A             BACKWARD CHAIN AT SAME LEVEL
$FLDHILV DS    A             OFFSET FROM LOAD MODULE TO THIS FIELD'S
*                            PARENT-FIELD (GROUP LEVEL FIELD)
$FLDEPSC DS    0X            TYPE OF FIELD DEPENDENT SECTION
$FLDOCUR EQU   X'01'         OCCURS
$FLDDEP  DS    A             OFFSET FROM LOAD MODULE TO 1ST DEPENDENT
*                            SECTION OF THIS FIELD
         DS    8F            RESERVED
$FLDISPL DS    H             DISPLACEMENT FROM BEGIN OF DATA-
*                            STRUCTURE TO THIS FIELD
$FLDLL   DS    H             FIELD LENGTH
$FLDIGR  DS    H             NUMBER OF DIGITS RIGHT OF DECIMAL POINT
$FLDIGL  DS    H             NUMBER OF DIGITS LEFT  OF DECIMAL POINT
$FLDNMLL DS    H             LENGTH OF FIELD NAME
$FLDNAME DS    CL30          FIELD NAME
$FLDELL  EQU   *-$FLDENTR    LENGTH OF EACH FIELD TABLE ENTRY
         EJECT
*---------------------------------------------------------------------*
*              D E P E N D E N T    S E C T I O N                     *
*---------------------------------------------------------------------*
         SPACE 1
$DEPTAB  DSECT               DEPENDENT SECTIONS TABLE
$DEPTYPE DS    X             TYPE OF FIELD DEPENDENT SECTION
$DEPOCUR EQU   $FLDOCUR      OCCURS
$DEPLAST EQU   X'80'         LAST DEPENDENT SECTION OF SAME FIELD
$DEPLL   DS    AL1           LENGTH OF THIS DEPENDENT SECTION
         SPACE 1
*---------------------------------------------------------------------*
*        MULTIPLE OCCURRENCES (TYPE=X'01')                            *
*---------------------------------------------------------------------*
         SPACE 1
         ORG   $DEPTAB
$OCU     EQU   *
         DC    X'01'
$OCULL   DC    AL1($OCUELL)  LENGTH OF THIS SECTION
$OCUNO   DS    H             NUMBER OF OCCURRENCES
$OCUDISP DS    H             DISPLACEMENT TO NEXT OCCURRENCE
$OCUDEPF DS    A             OFFSET FROM LOAD MODULE TO DEPENDING ON
*                            FIELD, IF PRESENT
$OCUELL  EQU   *-$OCU        LENGTH OF TYPE 01 SECTION
./ ADD  NAME=ZSGENOUT
***********************************************************************
* FLD/K-ZS          FILE-BESCHREIBUNG                      26.06.1981 *
* ARBEITSGEBIET     : ZS                                              *
* FILE              : ZS.ZSGENOUT                                     *
* FILE-BEZEICHNUNG  : SEQUENTIELLE DATEI DER RECOVERY-JOB GENERIERUNG *
***********************************************************************
         SPACE 3
ZSGENOUT DSECT
GENOUTKZ DS    CL1  KENNZEICHEN                                     000
*        BLANK=NORMAL,  S=SONDER-DUMPS,  X=SONDER-RESTORES,
*        F=FIRST,       L=LAST,          C=KOMMENTARE FUER DIE AV
         DS    CL1      FREI                                        001
ICJNAME  DS    CL8      ICJ-NAME                                    002
         ORG   ICJNAME+7
ICJG     DS    CL1      ICJ-GRUPPE                                  009
         DS    CL1      FREI                                        010
FLDATEN  DS    0CL60    DATENFELD FUER GENOUTKZ = F ODER L          011
GDGNAME  DS    CL25     GDG-NAME                                    011
GDGMSS   DS    CL1      GDG AUF MSS        J/K/N                    036
GDGGS    DS    CL2      MSS-GRUPPE SPACE   Z.B. 02 -> GR...S02      037
RESTORE  DS    CL8      RESTORE-JOB                                 039
RECOVERY DS    CL8      RECOVERY-JOB                                047
DSNAME   DS    CL16     DATASET-NAME                                055
DDNAME   DS    CL8      DD-NAME                                     071
SPACE    DS    0CL13    SPACE-ANGABE       Z.B. CYL,(001,001)       079
SPACTYPE DS    CL3         CYL/TRK                                  079
         DS    CL2         ,(                                       082
PRIMSPAC DS    CL3         PRIMARY SPACE                            084
         DS    C           ,                                        087
SECSPAC  DS    CL3         SECONDARY SPACE                          088
         DS    C           )                                        091
BLKSIZE  DS    CL5      BLKSIZE DER DATEI                           092
UNIT     DS    CL5      UNIT ANGABE                                 097
VSAMKZ   DS    CL1      KZ OB VSAM         'V'/' '                  102
DSNKOPIE DS    CL1      BLANK, ODER 1-9, WENN ES EINE DB-KOPIE IST. 103
         DS    CL1      FREI                                        104
CLUSTER  DS    CL8      CLUSTER-NAME                                105
DBDNAME  DS    CL8      DBD-NAME                                    113
ARBEITSN DS    CL4      ARBEITSNUMMER                               121
ACKU     DS    CL1      ACKU-NUMMER                                 125
GDGATTR  DS    0CL9     ATTRIBUTE DER GDG-I.C.DATASETS              126
RHYTMUS  DS    C        RHYTHMUS DER DATENSICHERUNG                 126
KOPIE    DS    C        ANZAHL DER SICHERUNGSKOPIEN                 127
AUSLAGER DS    C        SICHERHEITSAUSLAGERUNG       J/N            128
GDG      DS    CL2      ANZAHL DER GDG-ENTRIES                      129
RETPD    DS    CL4      RETPD ANGABE                                131
IMS      DS    CL4      BLANK: IMS=IMS2 ,  IMS : IMS=IMS            135
DBANAME  DS    CL8      DB-ANALYZER-JOB                             139
COMMENT  DS    CL6      KOMMENTAR FUER DIE AV                       147
*      IMS ZUSATZDATEN
INDEXDB  DS    CL1      I = INDEX    DATENBANK, SONST BLANK         153
RESDB    DS    CL1      R = RESIDENT DATENBANK, SONST BLANK         154
ONLINDB  DS    CL1      O = ONLINE   DATENBANK, SONST BLANK         155
         DS    CL4      FREI                                        156
GENOUTLN EQU   *-ZSGENOUT                                           160
         SPACE 1
./ ADD  NAME=ZSGRAPH
*******************************************************************
*    5798-CRB  COPYRIGHT IBM CORP. 1977
*  LICENSED MATERIAL - PROGRAM PROPERTY OF IBM
*  REFER TO COPYRIGHT INSTRUCTIONS FORM NO. G120-2083
************************************************************
*   GRAPH MACRO.   USED TO CALL PLOT PROGRAM AND BUILD            *
*                  PARAMETER LIST                                 *
*******************************************************************
         MACRO
&LABEL   ZSGRAPH &WORK=0,&CHARS=72,&LINES=48,&STARTX=,&STARTY=,        X
               &ENDX=,&ENDY=,&INCX=,&INCY=,&CURVES=0,&LIST=,&MF=
         LCLA  &MASKSUM,&CRVCT,&CRVIX,&MASK
&MASKSUM SETA  0
&CRVCT   SETA  N'&CURVES
&CRVIX   SETA  1
&MASK    SETA  128
         AIF   (T'&STARTX EQ 'O').EX
&MASK    SETA  &MASK+32
&MASKSUM SETA  &MASKSUM+4
.EX      AIF   (T'&ENDX EQ 'O').INCX
&MASK    SETA  &MASK+16
&MASKSUM SETA  &MASKSUM+4
.INCX    AIF   (T'&INCX EQ 'O').STY
&MASK    SETA  &MASK+8
&MASKSUM SETA  &MASKSUM+4
.STY     AIF   (T'&STARTY EQ 'O').EY
&MASK    SETA  &MASK+4
&MASKSUM SETA  &MASKSUM+4
.EY      AIF   (T'&ENDY EQ 'O').INCY
&MASK    SETA  &MASK+2
&MASKSUM SETA  &MASKSUM+4
.INCY    AIF   (T'&INCY EQ 'O').LST
&MASK    SETA  &MASK+1
&MASKSUM SETA  &MASKSUM+4
.LST     ANOP
         CNOP  0,4
         AIF   (T'&LABEL EQ 'O').NOLAB
&LABEL   EQU   *
.NOLAB   ANOP
         AIF   ('&MF' EQ 'L').LIST
         AIF   ('&MF' EQ 'E').EXEC
         AIF   ('&WORK'(1,1) NE '(').WK0
         LA    1,&WORK
         ST    1,*+20
.WK0     ANOP
         BAL   1,20+*+&MASKSUM+4*&CRVCT
         AGO   .LIST
.EXEC    ANOP
         AIF   (T'&LIST EQ 'O').DONE
         LA    1,&LIST
         AGO   .DONE
.LIST    ANOP
         DC    AL4(*+4)
         DC    AL2(&CRVCT)
         DC    AL2(&MASK)
         DC    AL2(&CHARS)
         DC    AL2(&LINES)
         AIF   ('&WORK'(1,1) NE '(').WK1
         DC    AL4(0)
         AGO   .WK2
.WK1     ANOP
         DC    AL4(&WORK)
.WK2     ANOP
         AIF   (T'&STARTX EQ 'O').SX2
         DC    F'&STARTX'
.SX2     AIF   (T'&ENDX EQ 'O').EX2
         DC    F'&ENDX'
.EX2     AIF   (T'&INCX EQ 'O').INX2
         DC    F'&INCX'
.INX2    AIF   (T'&STARTY EQ 'O').SY2
         DC    F'&STARTY'
.SY2     AIF   (T'&ENDY EQ 'O').INY2
         DC    F'&ENDY'
.INY2    AIF   (T'&INCY EQ 'O').ENLST
         DC    F'&INCY'
.ENLST   ANOP
         DC    AL4(&CURVES(&CRVIX))
&CRVIX   SETA  &CRVIX+1
         AIF   (&CRVIX LE &CRVCT).ENLST
.DONE    AIF   ('&MF' EQ 'L').OUT
         L     15,=V(ZSGRAPH)
         BALR  14,15
.OUT     ANOP
         MEND
./ ADD  NAME=ZSHISHDR
** TITLE   COPY        Z S H I S H D R        (HISTORIE HEADER)
** OWNER   D-DFI/KS
** LCHNG   08/08/83 16:00:23   H902586 K.ZIMPELMANN
***********************************************************************
HISHDR   DSECT
HHLL     DS    H             A    SATZLAENGE INCL. HEADER
HHZZ     DS    H             H
HHTC     DS    0CL8          H    EMPF. TRAN.-CODE INTERNE NACHRICHT
HHTCSG   DS    CL2                    SACHGEBIET
HHTCTYP  DS    CL2                    TC-TYP
HHTCGR   DS    CL1                    GRUPPE
HHTCNR   DS    CL2                    LAUFENDE NUMMER
HHTCFILL DS    CL1                    KONSTANT '  '
HHKZREO  DS    CL1           H    KZ OB EINSP.DATUM SETZEN
HHJAREO  EQU   C'R'                   EINSP.DATUM NICHT SETZEN
HHVERS   DS    CL1           H    VERSIONS-NR. DER HISTORIEPROGRAMME
HHID     DS    0CL6          A    HISTORIE IDENTIFIKATION
HHIDSG   DS    CL2                    SACHGEBIET
HHIDGR   DS    CL1                    GRUPPE
HHIDNR   DS    CL2                    LAUFENDE NUMMER
HHIDFILL DS    CL1                    KONSTANT '  '
HHRSNR   DS    F             H    LAUFENDE HISTORIE SATZ-NUMMER
HHKZTYP  DS    CL1           H    KENNZEICHEN SATZTYP
HHD      EQU   C' '                   DATEN-SATZ
HHMDAT   EQU   C'D'                   MARKIERUNG NEUES SPEICHERDATUM
HHDATUM  DS    0CL6          H    EINSPEICHERUNGS-DATUM
HHJJ     DS    CL2                    JAHR
HHMO     DS    CL2                    MONAT
HHTT     DS    CL2                    TAG
HHZEIT   DS    0CL6          H    EINSPEICHERUNGS-ZEIT
HHHH     DS    CL2                    STUNDEN
HHMM     DS    CL2                    MINUTEN
HHSS     DS    CL2                    SEKUNDEN
HHKZVDAT DS    CL1         A/H    KENNZEICHEN VERFALLDATUM
HHKZATAG EQU   C'A'                   VERFALLDATUM = ARBEITSTAGE
HHKZKTAG EQU   C'K'                   VERFALLDATUM = KALENDERTAGE
HHKZKDAT EQU   C'D'                   VERFALLDATUM = KALENDERDATUM
HHKZSEQL EQU   C'L'                   LOESCHEN BEI SEQ. LESEN
HHKZUNB  EQU   C'U'                   VERFALLDATUM UNBESTIMMT
HHKZVLOE EQU   C'V'                   LOESCHEN BEI VERWALTUNGSLAUF
HHKZDEF  EQU   C' '                   UEBERNEHMEN DEFAULT (HID-DEF.)
HHVDAT   DS    0CL6        A/H    VERFALLDATUM
HHKALTAG DS    0CL6               KALENDERTAGE
HHARBTAG DS    0CL6               ARBEITSTAGE
HHKALDAT DS    0CL6               KALENDERDATUM
HHKDATJJ DS    CL2                    JAHR
HHKDATMM DS    CL2                    MONAT
HHKDATTT DS    CL2                    TAG
HHTRAN   DS    CL8           A    TRANSACTION CODE ABSENDER
HHLTERM  DS    CL8           A    LTERM-NAME ABSENDER
         DS    CL8           H    RESERVE
HISHDRL  EQU   *-HISHDR
*                          ---
*                           
* BEDEUTUNG:    <-----------
* ----------
*
*            WIRD GESETZT VON
*    A --->  ANWENDUNG
*    H --->  HISTORIE-PROGRAMMEN
*  A/H --->  ANWENDUNG ODER HISTORIE-PROGRAMMEN
*
***********************************************************************
./ ADD  NAME=ZSHISPRM
** TITLE   COPY        Z S H I S P R M        (HISTORIE PARAMETER)
** OWNER   D-DFI/KS
** LCHNG   12/06/83 09:58:32   H902586 K.ZIMPELMANN
***********************************************************************
HISPRM   DSECT
LL       DS    H                  MAX.SATZLAENGE INCL. HEADER
ANZPCB   DS    H                  ANZAHL PCBS IN USING LISTE
VERSNR   DS    CL1                HISTORIEPROGRAMM VERSIONSNUMMER
         DS    CL6                RESERVE
HID      DS    0CL6               HISTORIE-IDENTIFICATION
HIDSG    DS    CL2                    SACHGEBIET
HIDGR    DS    CL1                    GRUPPE
HIDNR    DS    CL2                    NUMMER
         DS    CL1                    KONSTANT '  '
KZINT    DS    CL1                KENNZEICHEN INT.NACHRICHT
KZINTJA  EQU   C'I'                   VERARBEITUNG UEBER INT.NACHRICHT
KZINTNO  EQU   C' '                   VERARBEITUNG OHNE INT. NACHRICHT
KZVERARB DS    CL1                KENNZEICHEN VERARBEITUNGSART
KZSEQ    EQU   C'S'                   SEQUENTIELLE VERARBEITUNG
KZDIR    EQU   C' '                   DIREKTE      VERARBEITUNG
KZFIL    EQU   C'F'                   FILE         VERARBEITUNG
HISPFIXL EQU   *-HISPRM           LAENGE UNVERAENDERBARER BEREICH
         ORG   HISPRM
HISPFIX  DS    CL(HISPFIXL)       NICHT VERAENDERBARER BEREICH
FUNC     DS    CL4                FUNKTIONSCODE (WIE DL/1)
KZZUGR   DS    CL1                KENNZEICHEN ZUGRIFF
KZIND    EQU   C'I'                   UEBER INDEX AUF PRIMAER-DB
KZPRIM   EQU   C'P'                   AUF PRIMAER-DB
KZNIND   EQU   C'X'                   NUR AUF INDEX
QUAL     DS    0CL74              QUALIFIKATION
KZQUAL   DS    CL1                     KENNZEICHEN QUALIFIKATION
KZINDQ   EQU   C'I'                      INDEX QUALIFIKATION
KZDATQ   EQU   C'D'                      DATUM QUALIFIKATION
KZADRQ   EQU   C'A'                      ADRESS QUALIFIKATION
KZUNQ    EQU   C'U'                      UNQUALIFIZIERT
INDNR    DS    CL2                    INDEXNUMMER
SCHLUGRZ DS    0CL30                  UNTERGRENZE (VON)
OPRVON   DS    CL2                        OPERATOR
SCHLVON  DS    CL28                       SCHLUESSEL
SCHLOGRZ DS    0CL30                  OBERGRENZE  (BIS)
OPRBIS   DS    CL2                        OPERATOR
SCHLBIS  DS    CL28                       SCHLUESSEL
KZPOS    DS    CL1                    KENNZEICHEN POSITIONIEREN
KZPNO    EQU   C' '                       NICHT POSITIONIEREN
KZPRSNR  EQU   C'R'                       AUF RELATIVE SATZ-NR. POS.
KZPADR   EQU   C'A'                       AUF ADRESSE POSITIONIEREN
POSRSNR  DS    F                      RELATIVE SATZNUMMER F. POS.
POSADR   DS    0CL6                   ADRESSE FUER POSITIONIERUNG
POSASEG  DS    F                          SEGMENT-NUMMER
POSASATZ DS    H                          SATZ-NUMMER IM SEGMENT
RETCD    DS    H                  RETURN-CODE
AUFRSNR  DS    F                  RELATIVE SATZNUMMER DES GESP. SATZES
AUFADR   DS    0CL6               ADRESSE DES GESP. SATZES
AUFASEG  DS    F                      SEGMENT-NUMMER
AUFASATZ DS    H                      SATZ-NUMMER IM SEGMENT
CONTID1  DS    CL2                1. KONTROLL-ID
PRMBCNT  DS    H                  PARM BLOCK COUNTER
*                                 (= INDEX FUER PARM BLOCK TABELLE)
CONTID2  DS    CL2                2. KONTROLL-ID
         DS    CL28               RESERVE
PHISPRML EQU   *-HISPRM           LAENGE HISPRM
./ ADD  NAME=ZSIXM
         MACRO
&NAME    ZSIXM &TYP=DSECT
         GBLB  &FLG
         AIF   ('&TYP' NE 'CSECT').L1
         LCLC  &XN
&XN      SETC  '&NAME'(4,3)
         EJECT
.L1      ANOP
         AIF   (&FLG).L2
&FLG     SETB  1
$PST     EQU   1
$ISEG    EQU   2
$PARMS   EQU   3
$ISSEG   EQU   4
         SPACE 3
.L2      ANOP
         AIF   ('&TYP' EQ 'DSECT').L3
&NAME    &TYP
         ORG   &NAME+28
         DC    AL2(&NAME.E-&NAME)      PARM LENGTH
         DC    H'0'                     RESERVED
@&XN.USER DS    0H                      START OF USER DATA
         USING @&XN.USER,15
         B     @&XN.CODE
@&XN.IYES EQU   *
         LA    15,0
         BR    14
@&XN.INO  EQU   *
         LA    15,4
         BR    14
@&XN.CODE EQU   *
         AGO   .EX
.L3      ANOP
@IMPRM   &TYP
@PTSEGNM DS    CL8
@PXFLDNM DS    CL8
@PIMROUT DS    CL8
@PIMRADR DS    A
@PRMLEN  DS    H
@PRES    DS    H
@PUSER   DS    0H
.EX      ANOP
         MEND
./ ADD  NAME=ZS018PRM
** TITLE   PARAMETERBEREICHE FUER ZS018 ERSTELLEN
** OWNER   D-DFI/KS
** LCHNG   01/20/84 12:36:22   H902586 K.ZIMPELMANN
         MACRO
&NAME    ZS018PRM &DS=,&SEG=,&DSECT=,&PREFIX=,&CMPR=,&DLET=
         LCLC  &FLGDS
         LCLA  &DSNO
         LCLC  &FLGSEG
         LCLA  &SEGNO
         LCLC  &FLGCMP
         LCLC  &FLGDLT
         LCLC  &TYP
         LCLC  &S
         LCLB  &DUMMYS
         AIF   (T'&NAME EQ 'O').INVNM
&FLGDS   SETC  '0'
&DSNO    SETA  10
         AIF   (T'&DS EQ 'O').DEFDS
         AIF   ('&DS(1)'(1,K'&DS(1)) NE 'NO'(1,K'&DS(1)) AND           *
               '&DS(1)'(1,K'&DS(1)) NE 'YES'(1,K'&DS(1))).INVDS
         AIF   ('&DS(1)'(1,K'&DS(1)) EQ 'NO'(1,K'&DS(1))).TSTDS
&FLGDS   SETC  '1'
.TSTDS   ANOP
         AIF   (N'&DS LT 2).DEFDS
         AIF   (T'&DS(2) NE 'N' OR &DS(2) GT 10).INVDS
&DSNO    SETA  &DS(2)
.DEFDS   ANOP
&FLGSEG  SETC  '0'
&SEGNO   SETA  10
         AIF   (T'&SEG EQ 'O').DEFSEG
         AIF   ('&SEG(1)'(1,K'&SEG(1)) NE 'NO'(1,K'&SEG(1)) AND        *
               '&SEG(1)'(1,K'&SEG(1)) NE 'YES'(1,K'&SEG(1))).INVSEG
         AIF   ('&SEG(1)'(1,K'&SEG(1)) EQ 'NO'(1,K'&SEG(1))).TSTSEG
&FLGSEG  SETC  '1'
.TSTSEG  ANOP
         AIF   (N'&SEG LT 2).DEFSEG
         AIF   (T'&SEG(2) NE 'N' OR &SEG(2) GT 255).INVSEG
&SEGNO   SETA  &SEG(2)
.DEFSEG  ANOP
&S       SETC  'Z18'
         AIF   (T'&PREFIX EQ 'O').DEFPX
         AIF   (K'&PREFIX GT 3).INVPX
&S       SETC  '&PREFIX'
.DEFPX   ANOP
&FLGCMP  SETC  '0'
         AIF   (T'&CMPR EQ 'O').DEFCMP
         AIF   ('&CMPR'(1,K'&CMPR) EQ 'NO'(1,K'&CMPR)).DEFCMP
         AIF   ('&CMPR'(1,K'&CMPR) NE 'YES'(1,K'&CMPR)).INVCMP
&FLGCMP  SETC  '1'
.DEFCMP  ANOP
&FLGDLT  SETC  '0'
         AIF   (T'&DLET EQ 'O').DEFDLT
         AIF   ('&DLET'(1,K'&DLET) EQ 'NO'(1,K'&DLET)).DEFDLT
         AIF   ('&DLET'(1,K'&DLET) NE 'YES'(1,K'&DLET)).INVDLT
&FLGDLT  SETC  '1'
.DEFDLT  ANOP
&DUMMYS  SETB  0
         AIF   (T'&DSECT EQ 'O').DEFTYP
         AIF   ('&DSECT'(1,K'&DSECT) EQ 'NO'(1,K'&DSECT)).DEFTYP
         AIF   ('&DSECT'(1,K'&DSECT) NE 'YES'(1,K'&DSECT)).INVTYP
&DUMMYS  SETB  1
.DEFTYP  ANOP
         AGO   .GEN
.INVNM   ANOP
         MNOTE 8,'*,***  ZS018PRM  MISSING  N A M E  PARAMETER.'
         AGO   .ENDMAC
.INVDS   ANOP
         MNOTE 8,'*,***  ZS018PRM INVALID  D S  PARAMETER.'
         AGO   .ENDMAC
.INVSEG  ANOP
         MNOTE 8,'*,***  ZS018PRM INVALID  S E G  PARAMETER.'
         AGO   .ENDMAC
.INVPX   ANOP
         MNOTE 8,'*,***  ZS018PRM INVALID  S U F F I X  PARAMETER.'
         AGO   .ENDMAC
.INVCMP  ANOP
         MNOTE 8,'*,***  ZS018PRM INVALID  C M P R  PARAMETER.'
         AGO   .ENDMAC
.INVDLT  ANOP
         MNOTE 8,'*,***  ZS018PRM INVALID  D L E T  PARAMETER.'
         AGO   .ENDMAC
.INVTYP  ANOP
         MNOTE 8,'*,***  ZS018PRM INVALID  D S E C T  PARAMETER.'
         AGO   .ENDMAC
.GEN     ANOP
*        Z S 0 1 8   (DBD-INFO) PARAMETER
         AIF   (&DUMMYS).DST1
&NAME    DS    0F
         AGO   .NODST1
.DST1    ANOP
&NAME    DSECT
.NODST1  ANOP
&S.LN    DC    AL2(&S.E-&NAME)    LAENGE PARAMETER BEREICH
&S.RC    DC    H'0'             RETURNCODE
&S.DBNM  DC    CL8' '           DB-NAME
&S.DSKZ  DC    CL1'&FLGDS'      KENNZ. DSTAB
&S.SEGKZ DC    CL1'&FLGSEG'     KENNZ. SEGTAB
&S.CMPKZ DC    CL1'&FLGCMP'     KENNZ. A(COMPR.ROUT.) + DBD NOT DEL.
&S.DLTKZ DC    CL1'&FLGDLT'     KENNZ. DBD DELETE IN V. MIT CMPKZ
&S.FILL1 DC    CL10' '          RESERVE
&S.ZGRM  DC    CL1' '           ZUGRIFFSMETHODE
&S.OSAM  EQU   C'0'             OSAM
&S.VSAM  EQU   C'1'             VSAM
&S.ORGF  DC    CL1' '           ORGANISATIONSFORM
&S.HDAM  EQU   C'0'             HDAM
&S.HIDAM EQU   C'1'             HIDAM
&S.INDEX EQU   C'2'             INDEX
&S.HISAM EQU   C'3'             HISAM
&S.RMR   DC    CL8' '           RANDOMIZING ROUTINE
&S.RAANO DC    F'0'             ANZAHL RAA BLOCKS
&S.FILL2 DC    CL2' '           RESERVE
&S.APNO  DC    H'0'             ANZAHL ANKERPUNKTE
&S.DSNO  DC    H'0'             ANZAHL DATASETS
&S.SGNO  DC    H'0'             ANZAHL SEGMENTE
&S.E     EQU   *
*
&S.DS    DSECT
&S.DDN   DS    CL8             DD NAME
&S.BLKSZ DS    H               BLKSIZE
&S.LRECL DS    H               RECORDSIZE
&S.SEGNO DS    H               SEGMENT ANZAHL/DATASET
&S.FILL3 DS    CL10            RESERVE
&S.DSTLN EQU   *-&S.DS         LAENGE TABELLEN EINTRAG
*
         AIF   (&DUMMYS).DST2
&SYSECT  CSECT
&S.DST   EQU   *
         AGO   .NODST2
.DST2    ANOP
&S.DST   DSECT
.NODST2  ANOP
&S.DSLN  DC    AL2(&S.DSTE-&S.DST)  LAENGE DATASET TABELLE
&S.DSTAB DS    &DSNO.CL(&S.DSTLN) DATASET TABELLE
&S.DSTE  EQU   *
*
&S.SEG   DSECT
&S.SEGNM DS    CL8             SEGMENT NAME
&S.SEGCD DS    H               SEGMENT CODE
&S.PSGCD DS    H               PARENT SEGMENT CODE
&S.SLMIN DS    H               SEGMENT LAENGE MIN
&S.SLPRX DS    H               PREFIX LAENGE
&S.SLMAX DS    H               SEGMENT LAENGE MAX
&S.FLDNO DS    H               FIELD ANZAHL
&S.KEYLN DS    H               KEY LAENGE
&S.KEYOF DS    H               KEY OFFSET
&S.KEYNM DS    CL8             NAME KEY ODER 1.FELD
&S.SDSNO DS    H               DATASET-NR
&S.FILL4 DS    CL2             RESERVE
&S.ACMPT DS    A               ADDR(COMPR. CSECT)
&S.FILL5 DS    CL8             RESERVE
&S.SGTLN EQU   *-&S.SEG        LAENGE TABELLEN EINTRAG
*
         AIF   (&DUMMYS).DST3
&SYSECT  CSECT
&S.SGT   EQU   *
         AGO   .NODST3
.DST3    ANOP
&S.SGT   DSECT
.NODST3  ANOP
&S.SGLN  DC    AL2(&S.SGTE-&S.SGT)  LAENGE DATASET TABELLE
&S.SGTAB DS    &SEGNO.CL(&S.SGTLN) DATASET TABELLE
&S.SGTE  EQU   *
         AIF   (NOT &DUMMYS).ENDMAC
&SYSECT  CSECT
.ENDMAC  ANOP
         SPACE 3
         MEND
./ ADD  NAME=ZS018TAB
         EJECT
***********************************************************************
*
*              TABELLEN ZUM GENERIEREN VON DDT'S AUS DBD UND COPY
*
***********************************************************************
         SPACE 2
TAB1DS   DSECT
ZE0TAB1  DS    H              ANZAHL TABELLENELEMENTE
OFFTAB1  DS    H              OFFSET ZUM 1. TABELLEN-ELEMENT
ELTAB1   DS    H              LAENGE EINES ELEMENTES
         DS    H
DBDNAMT1 DS    CL8            DBDNAME AUS PARAMETER
ELEMENT1 DS    0CL16          TABELLENELEMENTE   MAXIMAL 255
SEGMENT1 DS    CL8            SEGMENTNAME AUS PARAMETER
COPYT1   DS    CL8            COPYNAME    AUS PARAMETER
         SPACE 2
TAB2DS   DSECT
ZE0TAB2  DS    H              ANZAHL TABELLENELEMENTE
OFFTAB2  DS    H              OFFSET ZUM 1. TABELLENELEMENT
ELTAB2   DS    H              LAENGE EINES ELEMENTES
ZE1TAB2  DS    H              ANZAHL SEGMENTE MIT COPYVORGABE
DBDNAMT2 DS    CL8            DBDNAME
ACCESS2  DS    CL16           ACCESS-METHODE
DATASET2 DS    10CL8          DATASET-NAMEN DES DBD MAXIMAL 10
ELEMENT2 DS    0CL16          TABELLEN-ELEMENTE  MAXIMAL 255
SEGMENT2 DS    CL8            SEGMENTNAMEN  DES DBD
COPYT2   DS    CL8            COPYNAMEN DES SEGMENTES
         SPACE 2
TAB3DS   DSECT
ZE0TAB3  DS    H              ANZAHL TABELLENELEMENTE
OFFTAB3  DS    H              OFFSET ZUM 1. TABELLENELEMENT
ELTAB3   DS    H              ELEMENTLAENGE
ELEMENT3 DS    0CL20          ELEMENTE  MAXIMAL  200
COPYTAB3 DS    CL8            AEHNLICHE COPYNAMEN ( 6 STELLEN = DBDNAM)
TTRTAB3  DS    CL4            SPURADDRESSE
LEV01T3  DS    CL8            01 EINTRAG DES  COPYS
         SPACE 2
COBOLDS  DSECT
COBOLL1  DS    H
COBOLL2  DS    H
COBOLEL  DS    H
COBOL1   DS    CL80
         DS    CL80
         DS    CL80
         DS    CL80
         DS    CL80
COBOL2   DS    CL80
         DS    CL80
./ ADD  NAME=ZS152MSP
** TITLE   ZS152MSP   PARM FUER AUSGABE AUF OS/ ODER IMS-KONSOLE
** OWNER   D-DFI/KS
** LCHNG   05/15/84 10:26:41   H902586 K.ZIMPELMANN
         MACRO
&NAME    ZS152MSP &TYP=DSECT
         AIF      ('&TYP' EQ 'CSECT').L1
&NAME    &TYP
.L1      ANOP
MESSAGE  DS    0CL72                 MESSAGE
NACHNR   DS    CL4                     NACHRICHTEN-NUMMER
         DS    CL1
TC       DS    CL8                     TRANSAKTION CODE
         DS    CL1
LTERM    DS    CL8                     LTERM-NAME
         DS    CL1
STATCOD  DS    CL2                     STATUS-CODE
         DS    CL1
FEHLCOD  DS    CL8                     FEHLER-CODE
         DS    CL1
TEXT     DS    CL20                    TEXT
         DS    CL1
ACTION   DS    CL16                    AKTION
MESSROUT DS    0CL2                  MESSAGE ROUTING
MESKZ1   DS    CL1                     KZ AUSGABE IMS-KONSOLE
IMSKJA   EQU   C'M'                      JA
MESKZ2   DS    CL1                     KZ AUSGABE OS-KONSOLE
WTOJA    EQU   C'O'                      JA MIT WTO
WTORJA   EQU   C'R'                      JA MIT WTOR
RETCOD   DS    H                     RETURN-CODE
REPCNT   DS    CL1                   REPEAT COUNT
ROUTCOD  DS    CL2                   ROUTING CODE
IMSLTRM1 DS    CL8                   LTERM1 IMS-KONSOLE
IMSLTRM2 DS    CL8                   LTERM2 IMS-KONSOLE
         MEND
./ ADD  NAME=ZS905COM
** TITLE   COMMONBEREICH FUER ZS905
** OWNER   K. ZIMPELMANN
** LCHNG   10/23/81 13:43:37   H903586 K.ZIMPELMANN
         MACRO
&NAME    ZS905COM &TYP=DSECT
         LCLC  &XN
&XN      SETC  '&NAME'(1,2)
         AIF   ('&TYP' EQ 'CSECT').L1
&NAME    &TYP
.L1      ANOP
&XN.SVR1 DS    F           ADRESSE PARM-PARAMETER
&XN.SR15 DS    F           RET-CODE VSAM
&XN.TADR DS    F           ADRESSE EINGABE- + BLOCKTABELLE
&XN.ADDB DS    F           ADRESSE BLOCKPUFFER
&XN.RBLK DC    F'0'        NR DES ZU LESENDEN BLOCKS
&XN.WBLK DC    F'0'        NR DES ZU SCHREIBENDEN BLOCKS
&XN.ADAT DS    F           ADRESSE DATASET
&XN.ARMR DC    F'0'        ADRESSE RAND.ROUTINE
&XN.RAAB DC    F'0'        ANZAHL RAABS
         SPACE 2
&XN.BLKS DC    H'0'        BLKSIZE
&XN.AKPT DC    H'0'        ANZAHL ANKERPUNKTE
&XN.MSGC DC    H'0'        MESSAGE-CODE
&XN.ESIZ DC    H'240'      GROESSE DER EINGABE-TABELLE
&XN.TSIZ DC    H'512'      GROESSE DER BLOCK-TABELLE
&XN.COCO DC    H'0'        CONDITION-CODE
         SPACE 2
&XN.LCNT DC    PL3'+60'    ZEILENANGABE
         SPACE 2
&XN.TFLG DC    AL1(&XN.TNO)  TERM ODER BATCH ?
&XN.TNO  EQU   1
&XN.TYES EQU   2
         SPACE 2
&XN.TYPF DC    AL1(&XN.TDB)  DATENBANK ODER IMAGE-COPY ?
&XN.TDB  EQU   1
&XN.TIC  EQU   2
         SPACE 2
&XN.AFLG DC    AL1(&XN.AOS)  VSAM ODER OSAM ?
&XN.AOS  EQU   1
&XN.AVS  EQU   2
         SPACE 2
&XN.WFLG DC    AL1(&XN.WNO)  UEBER KONSOLE ?
&XN.WNO  EQU   1
&XN.WYES EQU   2
         SPACE 2
&XN.RTCE DC    AL1(&XN.RNO)  EIGENER RETURN-CODE
&XN.RNO  EQU   1
&XN.RYES EQU   2
&XN.RTRM EQU   3
         SPACE 2
&XN.POKZ DC    AL1(&XN.PNO)  POINT GESETZT ?
&XN.PNO  EQU   1
&XN.PYES EQU   2
         SPACE 2
&XN.CHNG DC    AL1(&XN.CHNO)  CHANGE-EINGABE ?
&XN.CHNO EQU   1
&XN.CHYE EQU   2
         SPACE 2
&XN.AEND DC    AL1(&XN.AENO)  IC-AUSGABE STOPPEN ?
&XN.AENO EQU   1
&XN.AEYE EQU   2
         SPACE 2
&XN.DATA DC    AL1(&XN.CLOS)  DATEI-AKTION
&XN.CLOS EQU   1
&XN.READ EQU   2
&XN.WRIT EQU   3
         SPACE 2
&XN.ARTD DC    AL1(&XN.DCLU)  CLUSTER,INDEX,DATEN ???
&XN.DCLU EQU   1
&XN.DDAT EQU   2
&XN.DIND EQU   3
         SPACE 2
&XN.VORS DC    AL1(&XN.YESV)  BLOCK/PRO SEITE
&XN.YESV EQU   1
&XN.NOV  EQU   2
         SPACE 2
&XN.FUEB DC    AL1(&XN.FNO)   FEHLERUEBERSCHRIFT
&XN.FNO  EQU   1
&XN.FYES EQU   2
         SPACE 2
&XN.SEIZ DC    PL3'0'        SEITENZAEHLER
         MEND
./ ADD  NAME=ZS910CLS
** TITLE   BCS + VVDS CELLS
** OWNER   DFI/KS
** LCHNG   10/21/83 09:02:11   H902344 WEBER.G
***********************************************************************
*                                                                     *
*   D S E C T ' S         B C S  +  V V D S - C E L L S               *
*                                                                     *
*   CELL-TYP  DSECT-NAME  CELL-INDENTIFICATION                        *
*   ----------------------------------------------------------------  *
*    C        VCNC        VSAM BASE CLUSTER                           *
*    D OR I   DINC        DATA- OR INDEX-COMPONENT OF A BASE CLUSTER  *
*    04 X     VOLCELL     VOLUME INFORMATION                          *
*    Z OR Q   VVR         VVR HEADER CELL                             *
*    21 X     VVRDSINF    VVR DATA SET INFORMATION CELL               *
*    23 X     VVRVOLIN    VVR VOLUME INFORMATION CELL                 *
*    60 X     VVRAMDCL    VVR AM DATA STATISTICS BLOCK CELL           *
*                                                                     *
***********************************************************************
         SPACE 3
VCNC     DSECT               VSAM CLUSTER NAME CELL
CLCELLN  DS    H             LENGTH OF VCNC INCLUDING ITSELF
CLTYPE   DS    CL1           TYPE 'C' FOR CLUSTER
CLCOMPLN DS    XL2           LENGTH OF THE CLUSTER COMPONENT
CLNOEXT  DS    XL1           NUMBER OF EXTENSION RECORDS
CLNMLEN  DS    XL1           LENGTH OF THE CLUSTER KEY (45)
CLNAME   DS    CL44          CLUSTER NAME PART OF KEY
CLNMPAD  DS    XL1           PAD VALUE, SET TO BINARY ZERO
CLNPEND  EQU   *             END OF CELL
         SPACE 3
DINC     DSECT               DATA OR INDEX NAME CELL
DIDLEN   DS    XL2           LENGTH OF DINC
DIDTYPE  DS    CL1           'D' OR 'I' FOR DATA OR INDEX
DIDCMPLN DS    XL2           LENGTH OF DINC COMPONENT
DIDIRFLG DS    XL1           INTERRUPTION RECOGNITION FLAGS
DIDELETE EQU   X'80'          DELETE IN PROGRESS
DIDUPDAT EQU   X'40'          UPDATE-EXTEND IN PROGRESS
DIDSRMU  EQU   X'20'          SUB-RECORD MOVE AND UPDATE IN PROGRESS
DIDKEYLN DS    XL1           CONDENSED KEY LENGTH
DIDKEY   DS    0XL1          CONDENSED KEY (VARIABLE LENGTH)
         SPACE 3
VOLCELL  DSECT               VOLUME CELL
VOLLEN   DS    XL2           LENGTH OF VOLCELL INCLUDING ITSELF
VOLTYPE  DS    XL1           TYPE X'04' FOR VOLUME CELL
VOLOFSET DS    XL1           NOT USED
VOLSERN  DS    CL6           VOLUME SERIAL NUMBER
VOLDEVTP DS    XL4           DEVICE TYPE
VOLFLAG1 DS    XL1           VOLUME FLAG 1
VOLPRIME EQU   X'80'          PRIME VOLUME-ALLOCATED SPACE
VOLCANDI EQU   X'40'          CANDIDATE VOLUME NO SPACE
VOLOFLOW EQU   X'20'          OVERFLOW KEYRANGE ONLY
VOLCONV  EQU   X'10'          CONVERTED VSAM DATA SET VOLUME
VOLNVSAM EQU   X'08'          NONVSAM VOLUME CELL
VOLKYRNG EQU   X'04'          KEYRANGE QUALIFIER PRESENT
VOLVPCI  EQU   X'02'          PRIMARY VVR CI
VOLSSQWD EQU   X'01'          SEQUENCE SET WITH DATA
VOLFLAG2 DS    XL1           RESERVED
VOLVVRBA DS    XL4           RELATIVE BYTE ADDRESS OF VVR
         ORG   VOLVVRBA
VOLDSTTR DS    XL3           NONVSAM FORMAT 1 DSCB TTR
         DS    XL1           RESERVED
VOLFLSEQ DS    XL2           NONVSAM FILE SEQUENCE NO.(TAPE)
VOLKRQL  DS    XL4           KEYRANGE QUALIFIER(VSAM ONLY)
VOLLKYLN DS    XL2           LENGTH OF LOW KEY RANGE KEY
VOLLOWKY DS    0XL1          1-64 BYTE LOW KEY (VARIABLE LENGTH)
VOLHKYLN DS    XL2           LENGTH OF HIGH KEY RANGE KEY
VOLHIKY  DS    0XL1          1-64 BYTE HIGH KEY (VARIABLE LENGTH)
         SPACE 3
VVR      DSECT               PRIMARY OR SECONDARY VVR HEADER CELL
VVRLEN   DS    XL2           LENGTH OF ENTIRE VVR
VVRHDR   DS    0XL9
VVRHDLEN DS    XL2           LENGTH OF HEADER CELL
VVRTYPE  DS    XL1           TYPE IS C'Z' OR C'Q'
VVRFLAG  DS    XL1           HEADER FLAG
VVRSEFD  EQU   X'40'          SELF DESCRIBING VVR FOR VVDS
VVRCATSD EQU   X'20'          CATALOG SELF DESCRIBING VVR
VVRCOMTP EQU   X'08'          COMPONENT TYPE 'D' (0) OR 'I' (1)
VVRKRQ   DS    XL4           KEY RANGE QUALIFIER
VVRV1    EQU   *
VVRCMPNL DS    XL1           COMPONENT NAME LENGTH
VVRCMPNM DS    0XL1          COMPONENT NAME (VARIABLE LENGTH)
VVRKEYL  DS    XL1           LENGTH OF KEY ( <= 45 )
VVRKEY   DS    0XL1          KEY ( CLUSTER NAME + PAD,VARIABLE LENGTH)
VVRCATNL DS    XL1           CATALOG NAME LENGTH
VVRCATNM DS    0XL1          CATALOG NAME (VARIABLE LENGTH)
VVRBSENL DS    XL1           LENGTH OF AIX NAME
VVRBSENM DS    0XL1          AIX NAME (VARIABLE LENGTH)
         SPACE 3
VVRDSINF DSECT               VVR DATA SET INFORMATION CELL
VVRDSLEN DS    XL2           DATA SET CELL LENGTH
VVRDSTYP DS    XL1           TYPE CODE IS X'21'
VVRDSATR DS    0XL2
VVRATTR1 DS    XL1           DATA SET ATTRIBUTES
VVRA1SPD EQU   X'80'          SPEED
VVRA1UNQ EQU   X'40'          UNIQUE
VVRA1REU EQU   X'20'          REUSABLE
VVRA1ERS EQU   X'10'          ERASE
VVRA1IUP EQU   X'04'          INHIBIT UPDATE
VVRA1TEX EQU   X'02'          TEMPORARY EXPORT
VVRA1TKO EQU   X'01'          TRACK OVERFLOW
VVRATTR2 DS    XL1           SHARE ATTRIBUTES
VVRA2REG EQU   X'C0'          REGIONAL SHARING ATTRIBUTES
VVRA2SYS EQU   X'30'          SYSTEM SHARING ATTRIBUTES
VVRA2INT EQU   X'02'          INTERNAL SYSTEM DATA SET
VVRA2NUS EQU   X'01'          COMPONENT IS NOT USABLE
VVROPIND DS    XL1           OPEN INDICATOR
VVRBUFSZ DS    XL4           MINIMUM BUFFER SIZE
VVRSPACE DS    0XL7
VVRPRISP DS    XL3           PRIMARY SPACE ALLOCATION
VVRSECSP DS    XL3           SECONDARY SPACE ALLOCATION
VVRSPCFG DS    XL1           SPACE FLAGS
VVRSPCOP EQU   X'C0'          SPACE OPTIONS
VVRDSHU  DS    XL4           DATA SET HI USED RBA
VVRDSHA  DS    XL4           DATA SET HI ALLOCATED RBA
VVRLRECL DS    XL4           AVERAGE LOGICAL RECORD LENGTH
         DS    XL2           RESERVED
VVREXCPX DS    CL8           EXCEPTION EXIT
VVRDSHK  DS    XL4           DATA SET HI KEY RBA
VVRCLFSG DS    XL1           CLUSTER ATTRIBUT FLAG
VVRCFSWS EQU   X'02'          CLUSTER DESCRIBES SWAPSPACE
VVRCFPGS EQU   X'01'          CLUSTER DESCRIBES PAGESPACE
VVRAIXFG DS    XL1           AIX ATTRIBUTE FLAG
VVRAIUPG EQU   X'80'          UPGRADE AIX
VVRTMSTP DS    XL8           TIMESTAMP (CATALOGUE ONLY)
VVRDSEND EQU   *
         SPACE 3
VVRVOLIN DSECT               VVR VOLUME INFORMATION CELL
VVRVOLLN DS    XL2           LENGTH OF VOLUME CELL
VVRVOLTP DS    XL1           TYPE CODE IS X'23'
VVRVOLFG DS    XL1           VOLUME FLAGS
VVRPRIME EQU   X'80'          PRIME VOLUME
VVROVFLW EQU   X'20'          OVERFLOW VOLUME
VVRNOEXT DS    XL1           NO OF EXTENTS ON VOLUME FOR DATA SET
VVRHKRBA DS    XL4           HIGH KEY RBA
VVRHURBA DS    XL4           HIGH USED RBA
VVRHARBA DS    XL4           HIGH ALLOCATED RBA
VVRBLKSZ DS    XL4           BLOCK SIZE
VVRBLKTK DS    XL2           NUMBER OF BLOCKS PER TRACKS
VVRTRKAU DS    XL2           TRACKS PER ALLOCATION UNIT
VVRTPEXT DS    XL1           EXTENT TYPE FLAG
VVRSSDAT EQU   X'80'          SEQUENCE SET WITH DATA
VVRNOPFM EQU   X'40'          EXTENTS NOT PREFORMATTED
VVRCONV  EQU   X'20'          CONVERTED VSAM DATA SET VOLUME
VVRTKCYL DS    XL2           TRACKS PER CYLINDER
VVRBYTTK DS    XL4           BYTE PER TRACK
VVRBYTAU DS    XL4           BYTE PER ALLOCATION UNIT
VVRLOKYL DS    XL2           LOW KEY LENGTH
VVRLOKYV DS    0XL1          LOW KEY ON VOLUME (VARIABLE LENGTH)
         DS    XL2           B A S F - DEFINITIONEN
*                            LAUT LAYOUT AUS 'PRINT VVDS' 2 STELLEN
*                            ZUWENIG DEFINIERT
         SPACE 1
VVRXTENT EQU   *             EXTENT DESCRIBTION
VVRXTNTL DS    XL2           LENGTH OF TOTAL EXTENT SECTION
VVRXTNT  EQU   *             EXTENTS (ONE OR MORE 20 BYTE SETS)
VVRX     DS    0XL20         INDIVIDUAL EXTENT
VVRXSEQN DS    XL2           SEQUENCE NUMBER
VVRXSCH  DS    0XL4          STARTING CCHH
VVRXSC   DS    XL2           STARTING CC
VVRXSH   DS    XL2           STARTING HH
VVRXECH  DS    0XL4          ENDING CCHH
VVRXEC   DS    XL2           ENDING CC
VVRXEH   DS    XL2           ENDING HH
VVRXNTRK DS    XL2           NUMBER OF TRACKS
VVRXSRBA DS    XL4           STARTING RBA
VVRXERBA DS    XL4           ENDING RBA
         SPACE 3
VVRAMDCL DSECT               VVR AMDSB CELL
VVRAMDCN DS    XL2           LENGTH OF ENTIRE AMDSB CELL
VVRAMCAT DS    0XL96
VVRAMSB1 DS    0XL6
VVRAMID  DS    XL1           TYPE CODE IS X'60'
VVRAMATR DS    XL1           ATTRIBUTES
VVRAMDST EQU   X'80'          1 KEY SEQUENCED, 0 ENTRY SEQUENCED
VVRAMWCK EQU   X'40'          WRITE CHECK
VVRAMSDT EQU   X'20'          SEQUENCE SET WITH DATA
VVRAMREP EQU   X'10'          REPLICATION
VVRAMORD EQU   X'08'          USE VOLUMES IN LIST ORDER
VVRAMRGE EQU   X'04'          KEY RANGE DATA SET
VVRAMRDS EQU   X'02'          RELATIVE RECORD DATA SET
VVRAMSPN EQU   X'01'          SPANNED RECORDS ARE ALLOWED
VVRAMLEN DS    XL2           LENGTH OF AMDSB
VVRAMNST DS    XL2           NUMBER OF ENTRIES IN INDEX SECTION
         ORG   VVRAMNST
VVRAMAKP DS    XL2           ALTERNATE KEY RKP
VVRAMKEY DS    0XL4
VVRAMRKP DS    XL2           RELATIVE KEY POSITION
VVRAMKLN DS    XL2           KEY LENGTH
VVRAMSB2 DS    0XL10
VVRAMPCA DS    XL1           % FREE CI IN CA
VVRAMPCI DS    XL1           % FREE BYTES IN CI
VVRAMCCA DS    XL2           NUMBER OF CI'S PER CA
VVRAMFCA DS    XL2           FREE CI'S PER CA
VVRAMFCI DS    XL4           FREE BYTES PER CI
VVRAMCIR DS    0XL8
VVRAMCIV DS    XL4           CONTROL INTERVAL SIZE
VVRAMLCL DS    XL4           MAXIMUM RECORD SIZE
VVRAMSB3 DS    0XL68
VVRAMHLR DS    XL4           RBA OF HI LEVEL INDEX RECORD
         ORG   VVRAMHLR
VVRAMSLT DS    XL4           RECORD SLOTS PER CI
VVRAMSSR DS    XL4           RBA OF FIRST SEQUENCE SET RECORD
         ORG   VVRAMSSR
VVRAMMRR DS    XL4           MAX RELATIVE RECORD NUMBER
VVRAMARD DS    XL4           POINTER TO FIRST ARDB
VVRAMAT3 DS    XL1           ATTRIBUTES
VVRAMUNQ EQU   X'80'          NON-UNIQUE OR UNIQUE KEYS
VVRAMFLT EQU   X'40'          CYLINDER FAULT MSS OR STAGE
VVRAMBND EQU   X'20'          BIND OR DO NOT BIND ON MSS
VVRAMWAT EQU   X'10'          WAIT OR NOT WAIT ON RELINQUISH
VVRAMLM  EQU   X'08'          LOAD MODE OR DATA SET LOADED
VVRAMSNO DS    XL1           NUMBER OF CONCURRENT REQUESTS
         DS    XL4           RESERVED
VVRAMBFI DS    XL2           NUMBER OF INDEX BUFFERS
         ORG   VVRAMBFI
VVRAMBFD DS    XL2           NUMBER OF DATA  BUFFERS
VVRAMSTS DS    XL8           SYSTEM TIME STAMP
VVRAMNIL DS    XL2           NUMBER OF INDEX LEVELS
VVRAMEXT DS    XL2           NUMBER OF EXTENTS
VVRAMNLR DS    XL4           NUMBER OF LOGICAL RECDS
VVRAMDLR DS    XL4           NUMBER OF DELETED RECDS
VVRAMINR DS    XL4           NUMBER OF INSERTED RECDS
VVRAMUPR DS    XL4           NUMBER OF UPDATED RECDS
VVRAMRTR DS    XL4           NUMBER OF RETRIEVED RECDS
VVRAMASP DS    XL4           BYTES OF FREE SPACE IN DATA SET
VVRAMCIS DS    XL4           NUMBER OF CI SPLITS
VVRAMCAS DS    XL4           NUMBER OF CA SPLITS
VVRAMEXC DS    XL4           NUMBER OF EXCP'S
VVRAMEND EQU   *
         SPACE 3
VVREXTD  DSECT               KOPIERTE DSECT AUS X'23' FUER EXT-LOOP
VVREXTDI DS    0XL20         INDIVIDUAL EXTENT
VVREXSEQ DS    XL2           SEQUENCE NUMBER
VVREXSCH DS    0XL4          STARTING CCHH
VVREXSC  DS    XL2           STARTING CC
VVREXSH  DS    XL2           STARTING HH
VVREXECH DS    0XL4          ENDING CCHH
VVREXEC  DS    XL2           ENDING CC
VVREXEH  DS    XL2           ENDING HH
VVREXTRK DS    XL2           NUMBER OF TRACKS
VVREXSRB DS    XL4           STARTING RBA
VVREXERB DS    XL4           ENDING RBA
./ ADD  NAME=ZS910PRM
** TITLE   PARAMETERBEREICH FUER ZS910DS ERSTELLEN
** OWNER   K.ZIMPELMANN
** LCHNG   01/31/84 12:12:28   H902586 K.ZIMPELMANN
         MACRO
&NAME    ZS910PRM &VOL=,&EXT=,&DSECT=,&VABKZ=,&PREFIX=
         LCLA  &VOLNO
         LCLA  &EXTNO
         LCLA  &EXTLL
         LCLB  &DUMMYS
         LCLC  &FLGVAB
         LCLC  &S
         LCLC  &N
         AIF   (T'&NAME EQ 'O').INVNM
&VOLNO   SETA  16
         AIF   (T'&VOL EQ 'O').DEFVOL
         AIF   (T'&VOL NE 'N' OR &VOL GT 16).INVVOL
&VOLNO   SETA  &VOL
.DEFVOL  ANOP
&EXTNO   SETA  16
         AIF   (T'&EXT EQ 'O').DEFEXT
         AIF   (T'&EXT NE 'N' OR &EXT GT 123).INVEXT
&EXTNO   SETA  &EXT
.DEFEXT  ANOP
&DUMMYS  SETB  0
         AIF   (T'&DSECT EQ 'O').DEFTYP
         AIF   ('&DSECT'(1,K'&DSECT) EQ 'NO'(1,K'&DSECT)).DEFTYP
         AIF   ('&DSECT'(1,K'&DSECT) NE 'YES'(1,K'&DSECT)).INVTYP
&DUMMYS  SETB  1
.DEFTYP  ANOP
&FLGVAB  SETC  '2'
         AIF   (T'&VABKZ EQ 'O').DEFVAB
         AIF   (T'&VABKZ NE 'N' OR &VABKZ GT 2).INVVAB
&FLGVAB  SETC  '&VABKZ'
.DEFVAB  ANOP
&S       SETC  'L'
         AIF   (T'&PREFIX EQ 'O').DEFPX
         AIF   (K'&PREFIX GT 1).INVPX
&S       SETC  '&PREFIX'
.DEFPX   ANOP
         AGO   .GEN
.INVNM   ANOP
         MNOTE 8,'*,***  ZS910PRM MISSING N A M E PARAMETER.'
         AGO   .ENDMAC
.INVVOL  ANOP
         MNOTE 8,'*,***  ZS910PRM INVALID V O L PARAMETER.'
         AGO   .ENDMAC
.INVEXT  ANOP
         MNOTE 8,'*,***  ZS910PRM INVALID E X T PARAMETER.'
         AGO   .ENDMAC
.INVTYP  ANOP
         MNOTE 8,'*,***  ZS910PRM INVALID D S E C T PARAMETER.'
         AGO   .ENDMAC
.INVVAB  ANOP
         MNOTE 8,'*,***  ZS910PRM INVALID V A B K Z PARAMETER.'
         AGO   .ENDMAC
.INVPX   ANOP
         MNOTE 8,'*,***  ZS910PRM INVALID P R E F I X PARAMETER.'
         AGO   .ENDMAC
.GEN     ANOP
&N       SETC  '&S'.'AREALEN'
*        Z S 9 1 0 D S   PARAMETER
         AIF   (&DUMMYS).DST1
&NAME    DS    0F
         AGO   .NODST1
.DST1    ANOP
&NAME    DSECT
&N       DS    H
         AGO   .VAB0
.NODST1  ANOP
         AIF   ('&FLGVAB' NE '0').VABNE0
&N       DC    AL2(&S.BEND1-&NAME)
         AGO   .VAB0
.VABNE0  ANOP
         AIF   ('&FLGVAB' NE '1').VABNE1
&N       DC    AL2(&S.BEND2-&NAME)
         AGO   .VAB0
.VABNE1  ANOP
&N       DC    AL2(&S.BEND3-&NAME)
.VAB0    ANOP
&S.DSN   DC    CL44' '
&N       SETC  '&S'.'DCMPNM'
&N       DC    CL44' '
&N       SETC  '&S'.'ICMPNM'
&N       DC    CL44' '
&S.MSSKZ DC    CL1'J'
&S.FILL  DC    CL1' '
&N       SETC  '&S'.'VOLCNT'
&N       DC    H'0'
&N       SETC  '&S'.'RETCOD'
&N       DC    H'0'
&N       SETC  '&S'.'MESSAGE'
&N       DC    CL32' '
         AIF   (&DUMMYS).DST5
         AIF   ('&FLGVAB' EQ '0').DST5
         AIF   ('&FLGVAB' EQ '1').DST5
&S.SPCL  DC    AL2(&EXTNO*&S.AREAL4)
         AGO   .NODST5
.DST5    ANOP
&S.SPCL  DC    H'0'
.NODST5  ANOP
&S.AREAL EQU   *-&NAME
*
&S.AREA1 DSECT
&N       SETC  '&S'.'VOLSER'
&N       DS    CL6
&N       SETC  '&S'.'DEVTYP'
&N       DS    CL5
&S.UADR  DS    CL3
&N       SETC  '&S'.'AREAL1'
&N       EQU   *-&S.AREA1
&N       SETC  '&S'.'VOLSEQ'
&N       DS    H
&S.CRJHR DS    PL2
&S.CRTAG DS    PL2
&S.EXJHR DS    PL2
&S.EXTAG DS    PL2
&S.VSAM  DS    CL1
&S.VSKZ  EQU   C'1'
&S.OSKZ  EQU   C'0'
&N       SETC  '&S'.'RESERVE'
&N       DS    CL1
&N       SETC  '&S'.'AREAL2'
&N       EQU   *-&S.AREA1
*
         AIF   (&DUMMYS).DST2
         AIF   ('&FLGVAB'  EQ '2').DST2
&SYSECT  CSECT
         AIF   ('&FLGVAB' NE '0').VABTNE0
&S.VOLTB DS    &VOLNO.CL(&S.AREAL1)
&S.BEND1 EQU   *
         AGO   .ENDMAC1
.VABTNE0 ANOP
&S.VOLTB DS    &VOLNO.CL(&S.AREAL2)
&S.BEND2 EQU   *
.DST2    ANOP
         AIF   ('&FLGVAB' EQ '0').ENDMAC1
         AIF   ('&FLGVAB' EQ '1').ENDMAC1
*
&N       SETC  '&S'.'DATORG'
&N       DS    CL1
&S.ODA   EQU   C'0'
&S.OIS   EQU   C'1'
&S.OPS   EQU   C'2'
&S.OESDS EQU   C'3'
&S.OKSDS EQU   C'4'
&S.ORRDS EQU   C'5'
&N       SETC  '&S'.'DATTYP'
&N       DS    CL1
&S.DTDAT EQU   C'D'
&S.DTIND EQU   C'I'
&S.RECFM DS    CL3
&S.BLK   DS    PL3
&S.RECL  DS    PL3
&S.NOEXT DS    PL2
&S.ALLOC DS    CL1
&S.SPCS  DS    PL2
&N       SETC  '&S'.'TRKANZ'
&N       DS    PL4
&N       SETC  '&S'.'TRKAZFS'
&N       DS    PL4
&S.CISPL DS    PL4
&S.CASPL DS    PL4
&N       SETC  '&S'.'AREAL3'
&N       EQU   *-&S.AREA1
&S.AREA2 DSECT
&S.SPCP  DS    PL3               SPACE JEDES EINZELNEN EXTENTS
&N       SETC  '&S'.'AREAL4'
&N       EQU   *-&S.AREA2
*
         AIF   (&DUMMYS).ENDMAC1
&SYSECT  CSECT
&S.VOLTB DS   &VOLNO.CL(&S.AREAL3+&S.AREAL4*&EXTNO)
&S.BEND3 EQU  *
.ENDMAC1 ANOP
         AIF  (NOT &DUMMYS).ENDMAC
&SYSECT  CSECT
.ENDMAC  ANOP
         SPACE 3
         MEND
./ ADD  NAME=ZS910VIA
** TITLE   VOLUME-INFO-AREA
** OWNER   ZLI/KS
** LCHNG   01/23/84 15:57:05   H902344 WEBER.G
*
*        VOLUME INFORMATION
*
VINFO    DS    0CL64
VOLSER   DS    CL6
RETC     DS    H
MSGTEXT  DS    CL32
         SPACE 1
VISPACE  DS    0CL20
FCYLS    DS    CL4                FREE CYLINDER ON VOLUME
FTRKS    DS    CL4                FREE TRACKS   ON VOLUME
EXT      DS    CL4                EXTENTS       ON VOLUME
LBCYLS   DS    CL4                LARGE BLOCK CYLINDER
LBTRKS   DS    CL4                LARGE BLOCK TRACKS
VIDEVINF DS    0CL4
CYLSU    DS    H                  # CYLINDER USABLE
TRKCYL   DS    H                  TRACKS PER CYLINDER

000100     /*   KOPFPRT = DRUCKEN LISTENSEPARATOR-BLAETTER   */
000200 KOPFPRT : PROC (PARM) OPTIONS (MAIN) ;
0003000DCL PARM CHAR(100) VARYING ;
000400 DCL PARMLAE   BIN FIXED (15) STATIC ;
000500 DCL SYSPRINT FILE PRINT ;
000600 DCL PARMX (4) CHAR (8)  STATIC INIT (' ', ' ', ' ', ' ') ;
000700 DCL ANZAHL    BIN FIXED (15) INIT (0) STATIC ;
000800 DCL SEITENGR BIN FIXED (15) INIT (0) STATIC ;
000900 DCL NP BIN FIXED(15) INIT (1) STATIC ;  /*  BYTENR IN PARM  */
001000 DCL N1 BIN FIXED(15) INIT (1) STATIC ;  /*  PARMNR IN PARMX */
001100 DCL N2 BIN FIXED(15) INIT (1) STATIC ;  /*  BYTENR IN PARMX */
001200 DCL PB        CHAR(1)   STATIC ;        /*  PARM-BYTE       */
001300 DCL COND BIN FIXED (31) INIT(0) STATIC ;
001400 DCL SEPARAT ENTRY ;
001500-    /*   P R O G R A M M   */
0016000ON ERROR BEGIN ; COND=16 ; GO TO EX ; END ;
001700    PARMLAE = LENGTH(PARM) ;
0018000H1: IF NP > PARMLAE THEN GO TO H6 ;
001900     PB = SUBSTR(PARM,NP,1) ;
002000     IF PB = ',' THEN GO TO H3 ;
002100     IF N2 = 9 THEN ; ELSE GO TO H2 ;
002200     N1 = N1 + 1 ;
002300     IF N1 > 6 THEN GO TO H6 ;
002400     N2 = 1 ;
002500 H2: IF N1 > 4 THEN GO TO H5 ;
002600     SUBSTR(PARMX(N1),N2,1) = PB ;
002700     N2 = N2 + 1 ;
002800     GO TO H4 ;
0029000H3: N1 = N1 + 1 ;
003000     IF N1 > 6 THEN GO TO H6 ;
003100     N2 = 1 ;
0032000H4: NP = NP + 1 ;
003300     GO TO H1 ;
0034000H5: IF PB < '0' THEN GO TO H6;
003500     IF PB > '9' THEN GO TO H6 ;
003600     IF N1 = 5 THEN
003700     ANZAHL =  ANZAHL * 10 + PB ;
003800     ELSE SEITENGR = SEITENGR * 10 + PB ;
003900     N2 = N2 + 1 ;
004000     GO TO H4 ;
0041000H6: IF ANZAHL = 0  THEN ANZAHL= 2 ;
004200     IF ANZAHL > 100 THEN ANZAHL = 100 ;
004300     IF SEITENGR = 0 THEN SEITENGR = 72 ;
004400     IF SEITENGR < 60 THEN SEITENGR = SEITENGR + SEITENGR ;
004500     OPEN FILE (SYSPRINT) PAGESIZE(SEITENGR) ;
004600 H7: CALL SEPARAT (SYSPRINT,PARMX,ANZAHL,SEITENGR) ;
004700 EX: CLOSE FILE (SYSPRINT) ;
004800     END KOPFPRT ;

000010 ID DIVISION.
000020 PROGRAM-ID. O40107.
000030 AUTHOR. OR401.
000040 INSTALLATION. DEUTSCHE BUNDESBANK.
000050 DATE-WRITTEN. JUNI 1976.
000060 DATE-COMPILED.
000070 REMARKS.
000080******************************************************************
000090*                                                                *
000100*             IMS ANTWORTZEITEN IM DC - BETRIEB                  *
000110*                                                                *
000120*    EINGABE :   REPORT AUS DFSILTA0                             *
000130*                                                                *
000140*    REPORT WIRD SORTIERT NACH "PROGRAM NAME"                    *
000150*                            (STELLE 35 DES REPORTS)             *
000160*                            (IN DER LAENGE 8)
000170*    AUSGABE :   DURCHSCHNITTSZEITEN PRO TRANSACTION.            *
000320*                                                                *
000330*    BEI RUECKFRAGEN BITTE WENDEN AN :                           *
000340*                                                                *
000350*    WOLFGANG SCHMINKE                                           *
000360*    C/O DEUTSCHE BUNDESBANK                                     *
000370*        POSTFACH 2633                                           *
000380*        6000 FRANKFURT / MAIN                                   *
000390*                                                                *
000400*    TEL. 0611 / 1582566                                         *
000410*                                                                *
000420*    ODER                                                        *
000430*                                                                *
000440*    HEINRICH TOMASCHEK                                          *
000450*    GLEICHE ANSCHRIFT                                           *
000460*                                                                *
000470*    TEL. 0611 / 1582564                                         *
000480*                                                                *
000490******************************************************************
000500     EJECT
           EJECT
001010 ENVIRONMENT DIVISION.
001020 CONFIGURATION SECTION.
001030 SOURCE-COMPUTER. IBM-370-J158.
001040 OBJECT-COMPUTER. IBM-370-J158.
           SKIP3
001060 INPUT-OUTPUT SECTION.
001070 FILE-CONTROL.
001080     SELECT    EBAS1        ASSIGN TO   UT-S-EBAS1.
001090     SELECT    ADRS1        ASSIGN TO   UT-S-ADRS1.
           EJECT
002010 DATA DIVISION.
002020 FILE SECTION.
002030 FD  EBAS1 RECORDING F BLOCK 0 RECORDS LABEL RECORDS OMITTED.
002040     1 EBS                   PIC X(133).
           SKIP3
002060 FD  ADRS1 RECORDING F BLOCK 0 RECORDS LABEL RECORDS OMITTED.
002070     1 ADS                   PIC X(133).
           EJECT
004010 WORKING-STORAGE SECTION.
004020 77  COIBM               PIC X(32) VALUE
004030     '5734-CB1 COPYRIGHT IBM CORP.1969'.
004040     1 ZAEHLER.
004050       3 FILLER              PIC X(7) VALUE 'ZAEHLER'.
004060       3 ZZ                  PIC 99   VALUE 80.
004070       3 SZ                  PIC 999  VALUE ZERO.
004080     01 STAPDEF.
004090       3 FILLER              PIC X(07) VALUE 'STAPDEF'.
004100       3 NS-ES               PIC X     VALUE '1'.
004110       3 ILES                PIC S9(4) COMP VALUE ZERO.
004120       3 AD                  PIC 9     VALUE      ZERO.
004130       3 IAW                 PIC S9(4) COMP VALUE ZERO.
009010     1 WSEB.
009020       3 FILLER              PIC X(01).
009030       3 B-SWEQ              PIC X(05).
009035       3 FILLER              PIC X.
009040       3 B-TRAN              PIC X(08).
009045       3 FILLER              PIC X.
009050       3 B-PRI               PIC X(01).
009055       3 FILLER              PIC X.
009060       3 B-CC                PIC X(03).
009065       3 FILLER              PIC X.
009070       3 B-IL                PIC X(02).
009080       3 B-TERIN             PIC X(02).
009085       3 FILLER              PIC X.
009090       3 B-OL                PIC X(02).
009100       3 B-TEROUT            PIC X(02).
009105       3 FILLER              PIC X.
009110       3 B-PRTYP             PIC X(01).
009115       3 FILLER              PIC X.
009120       3 B-PGM               PIC X(08).
009160       3 FILLER              PIC X(3).
009170       3 B-ENQ.
009171         5 B-ENQ-HH          PIC XX.
009172         5 FILLER            PIC X.
009173         5 B-ENQ-MM          PIC XX.
009180       3 FILLER              PIC X(54).
009190       3 B-INQT              PIC X(06).
009195       3 FILLER              PIC X.
009200       3 B-PROCT             PIC X(06).
009205       3 FILLER              PIC X.
010010       3 B-OUTQT             PIC X(06).
010015       3 FILLER              PIC X.
010020       3 B-TOTT              PIC X(06).
011000     1 ZABT.
011100      3 FILLER               PIC XX.
011200      3 ZWABT                PIC XXX.
011300     1 ZG.
011400      3 ZGR OCCURS 6.
011500       5 ZGRGW1.
011600        7 ZGRGW2.
011700         9 ZGRST             PIC X.
011800         9 ZGABT             PIC X(3).
011900        7 ZGPGM              PIC X(8).
012000       5 ZG-BCC              PIC XXX.
012100       5 ZG-PRI              PIC X.
013000     1 UE1.
013050      3 V1                   PIC X VALUE'1'.
013100      3 FILLER               PIC XXXX VALUE ' '.
013200       3 FILLER              PIC X(58) VALUE
013300     'PROGRAMM  OR40106  IMSVS   A N T W O R T Z E I T E N  IM I'.
013400       3 FILLER              PIC X(35) VALUE
013500     ' M S - D C - B E T R I E B   DATUM '.
013600       3 UE1-DAT             PIC X(11).
013700       3 UE1-TAG-ZEIT        PIC X(11) VALUE ' '.
013800       3 FILLER              PIC X(6) VALUE 'SEITE'.
013900       3 UE1-SZ              PIC ZZZ.
014000     1 UE2.
014050       3 V2                  PIC X VALUE '0'.
014100      3 FILLER               PIC X(58) VALUE
014200     '      PROGRAMM      PR   KL      ANZ     VERARBEITUNGSZEIT'.
014300      3 FILLER               PIC X(58) VALUE
014400     '    (SSSS.T)          EING.WS            EING.WS + VERARB.'.
014500      3 FILLER               PIC X(5)  VALUE 'ZEIT'.
014600     1 UE3.
014650      3 V3                   PIC X VALUE ' '.
014700      3 FILLER               PIC X(41) VALUE '      NAME'.
014800      3 FILLER               PIC X(58) VALUE
014900     'MIN   MITTEL      MAX     GES     MIN  MITTEL     MAX     '.
015000      3 FILLER               PIC X(20) VALUE
015100     'MIN  MITTEL     MAX'.
016000     1 ZWFELD.
016100      3 FILLER               PIC X(14) VALUE 'ZWISCHENFELDER'.
016200      3 ZW1.
016300       5 FILLER              PIC X(4).
016400       5 PKT                 PIC X.
016500       5 ZEHNTEL             PIC X.
016600      3 ZW2.
016700       5 Z-INQT              PIC 9(6).
016800       5 Z-PROCT             PIC 9(6).
016900       5 Z-TOTT              PIC 9(6).
017000     1 REFES.
017100      3 FILLER               PIC X(12) VALUE 'RECHENFELDER'.
017200      3 P31-ANZ-TRANS        PIC 9(6).
017300      3 P31-V-MIN            PIC X(6).
017400      3 P31-V-MAX            PIC X(6).
017500      3 P11-ANZ-TRANS        PIC 9(6).
017600      3 P11-V-MIN            PIC X(6).
017700      3 P11-V-MAX            PIC X(6).
017800      3 P31-INQT             PIC 9(7).
017900      3 P31-PROCT            PIC 9(7).
018000      3 P11-INQT             PIC 9(8).
018100      3 P11-PROCT            PIC 9(7).
018200      3 ZW-REFE              PIC 9(6).
018250      3 ZW-VER-GES-REFE      PIC 9(8).
018300      3 P31-I-MIN            PIC X(6).
018400      3 P31-I-MAX            PIC X(6).
018500      3 P31-GES-MIN          PIC 9(6).
018600      3 P31-GES-MAX          PIC 9(6).
018700      3 P31-GES-MAX-VERGL    PIC 9(6).
018800      3 P31-GES-MIN-VERGL    PIC 9(6).
019000      3 P19-ANZ-TRANS        PIC 9(6).
019100      3 P19-V-MIN            PIC X(6).
019200      3 P19-V-MAX            PIC X(6).
019300      3 P19-INQT             PIC 9(8).
019400      3 P19-PROCT            PIC 9(7).
019500      3 P19-I-MIN            PIC X(6).
019600      3 P19-I-MAX            PIC X(6).
019700      3 P19-GES-MIN          PIC 9(6) VALUE ZERO.
019800      3 P19-GES-MAX          PIC 9(6) VALUE ZERO.
019900      3 P19-GES-MIN-VERGL    PIC 9(6).
020000      3 P19-GES-MAX-VERGL    PIC 9(6).
020100      3 P11-GES-MIN-VERGL    PIC 9(6).
020200      3 P11-GES-MAX-VERGL    PIC 9(6).
020300      3 P11-GES-MIN          PIC 9(6).
020400      3 P11-GES-MAX          PIC 9(6).
020500      3 P11-I-MIN            PIC X(6).
020600      3 P11-I-MAX            PIC X(6).
021000     1 PZ.
021050      3 V-PZ                 PIC X VALUE '0'.
021200      3 FILLER               PIC X(6)  VALUE ' '.
021300      3 PZ-PGM               PIC X(15).
021400      3 PZ-PR                PIC XXX.
021500      3 PZ-CC                PIC X(4).
021600      3 PZ-ANZ               PIC Z(8).
021700      3 FILLER               PIC X(2) VALUE ' '.
021800      3 PZ-VER-MIN           PIC X(9).
021900      3 PZ-VER-MIT           PIC X(9).
022000      3 PZ-VER-MAX           PIC X(8).
022100      3 PZ-VER-GES           PIC Z(8).
022200      3 PZ-ES-MIN            PIC X(8).
022300      3 PZ-ES-MIT            PIC X(8).
022400      3 PZ-ES-MAX            PIC X(8).
022500      3 PZ-GES-MIN           PIC X(8).
022600      3 PZ-GES-MIT           PIC X(8).
022700      3 PZ-GES-MAX           PIC X(8).
022710     1 UE4.
022720      3 UE4-V                PIC X VALUE ' '.
022730      3 FILLER               PIC X(41) VALUE ' '.
022740      3 FILLER               PIC X(29) VALUE
022750     '-----------------------------'.
022760      3 FILLER               PIC X(5) VALUE ' '.
022770      3 FILLER               PIC X(19) VALUE
022780     '-------------------'.
022790      3 FILLER               PIC X(5) VALUE ' '.
022795      3 FILLER               PIC X(19) VALUE
022796     '-------------------'.
023000 LINKAGE SECTION.
023100     1 LKS.
023200      3 LKS-ZAE              PIC 9(4) COMP.
023300      3 VER-DAT.
023400       5 LS-DATUM            PIC X(8).
023500       5 FILLER              PIC X.
023600       5 GVN                 PIC X(10).
024000 PROCEDURE DIVISION USING LKS.
024100 VORLAUF.
024200     PERFORM P00 THRU P00-ENDE.
024300 EINGABE.
024400     IF ZGRST (1) = '0'
024500         PERFORM P01 THRU P01-ENDE.
024600 AUSWAHL.
024700     MOVE ZGR (1) TO ZGR (5).
024800     MOVE 1 TO IAW.
024900     MOVE IAW TO ILES.
025000 AWG1.
025100     ADD 1 TO IAW.
025200     IF IAW > AD
025300        GO TO AWG2.
025400     IF ZGR (IAW) < ZGR (5)
025500        MOVE ZGR (IAW) TO ZGR (5)
025600        MOVE IAW       TO ILES.
025700     GO TO AWG1.
025800 AWG2.
025900     MOVE '0' TO ZGRST (ILES).
026000 GRUPPE.
026100     IF NS-ES = '1'
026200       IF ZGRST (5) = '9'
026300          PERFORM P19 THRU P19-ENDE
026400          STOP RUN
026500       ELSE GO TO ERSTER.
026600     IF ZGRGW1 (5) = ZGRGW1 (6)
026700          GO TO POSTEN.
026800     PERFORM P11 THRU P11-ENDE.
026900     IF ZGRGW2 (5) = ZGRGW2 (6)
027000          GO TO ESG1.
027100     PERFORM P12 THRU P12-ENDE.
027200     IF ZGRST  (5) = ZGRST  (6)
027300          GO TO ESG2.
027400     PERFORM      P19 THRU P19-ENDE.
027500     STOP RUN.
028000 ERSTER.
028100     PERFORM P20 THRU P20-ENDE.
028200 ESG2.
028300     PERFORM P22 THRU P22-ENDE.
028400 ESG1.
028500     PERFORM P21 THRU P21-ENDE.
028600 POSTEN.
028700     IF ILES = 1
028800        PERFORM P31 THRU P31-ENDE
028900        GO TO EINGABE.
029000     STOP RUN.
030000 P00 SECTION.
030100     OPEN INPUT EBAS1.
030200     OPEN OUTPUT ADRS1.
030300     MOVE ZERO TO ZG.
030400     MOVE LS-DATUM TO UE1-DAT.
030500     MOVE GVN      TO UE1-TAG-ZEIT.
030550     IF LKS-ZAE < 9 MOVE ' ' TO UE1-TAG-ZEIT.
030600 P00-ENDE.
030700     EXIT.
031000 P01 SECTION.
031100     READ EBAS1 INTO WSEB AT END MOVE '9' TO ZGRST (1)
031150                                            GO TO P01-ENDE.
031155     EXAMINE B-PGM TALLYING ALL '*'.
031160     IF TALLY > ZERO GO TO P01.
031165     IF B-ENQ = ' ' GO TO P01.
031200     MOVE '5' TO ZGRST (1).
031300     MOVE B-PGM TO ZGPGM (1) ZABT.
031400     MOVE ZWABT TO ZGABT (1).
031500     MOVE B-CC  TO ZG-BCC (1).
031600     MOVE B-PRI TO ZG-PRI (1).
031700     IF B-PGM = ' ' GO TO P01.
031800 P01-ENDE.
031900     EXIT.
032000******************************************************************
032100 P31 SECTION.
032200     MOVE B-INQT    TO  ZW1.
032300     MOVE ZEHNTEL   TO  PKT.
032400     MOVE SPACE     TO  ZEHNTEL.
032500     MOVE ZW1       TO  Z-INQT.
032600     MOVE B-PROCT   TO  ZW1.
032700     MOVE ZEHNTEL   TO  PKT.
032800     MOVE SPACE     TO  ZEHNTEL.
032900     MOVE ZW1       TO  Z-PROCT.
033000     TRANSFORM Z-INQT   FROM SPACE TO ZERO.
033100     TRANSFORM Z-PROCT  FROM SPACE TO ZERO.
033200     ADD       Z-INQT   TO P31-INQT.
033300     ADD       Z-PROCT  TO P31-PROCT.
033400     ADD       1        TO P31-ANZ-TRANS.
034000     IF B-PROCT > P31-V-MAX
034100         MOVE B-PROCT TO P31-V-MAX.
034200     IF B-PROCT < P31-V-MIN
034300         MOVE B-PROCT TO P31-V-MIN.
034400     IF B-INQT  > P31-I-MAX
034500         MOVE B-INQT  TO P31-I-MAX.
034600     IF B-INQT < P31-I-MIN
034700         MOVE B-INQT  TO P31-I-MIN.
034800*
034900     ADD Z-INQT TO P31-GES-MIN P31-GES-MAX
035000     ADD Z-PROCT TO P31-GES-MIN P31-GES-MAX.
035100     IF P31-GES-MIN < P31-GES-MIN-VERGL
035200           MOVE P31-GES-MIN TO P31-GES-MIN-VERGL.
035300     IF P31-GES-MAX > P31-GES-MAX-VERGL
035400           MOVE P31-GES-MAX TO P31-GES-MAX-VERGL.
036000     IF P31-GES-MIN < P11-GES-MIN-VERGL
036100            MOVE P31-GES-MIN TO P11-GES-MIN-VERGL.
036200     IF P31-GES-MIN < P19-GES-MIN-VERGL
036300            MOVE P31-GES-MIN TO P19-GES-MIN-VERGL.
036400     IF P31-GES-MAX > P11-GES-MAX-VERGL
036500            MOVE P31-GES-MAX TO P11-GES-MAX-VERGL.
036600     IF P31-GES-MAX > P19-GES-MAX-VERGL
036700            MOVE P31-GES-MAX TO P19-GES-MAX-VERGL.
036800     IF B-PROCT > P19-V-MAX
036900            MOVE B-PROCT TO P19-V-MAX.
037000     IF B-PROCT > P11-V-MAX
037100            MOVE B-PROCT TO P11-V-MAX.
037200     IF B-PROCT < P19-V-MIN
037300            MOVE B-PROCT TO P19-V-MIN.
037400     IF B-PROCT < P11-V-MIN
037500            MOVE B-PROCT TO P11-V-MIN.
038000     IF B-INQT < P11-I-MIN
038100           MOVE B-INQT TO P11-I-MIN.
038200     IF B-INQT < P19-I-MIN
038300           MOVE B-INQT TO P19-I-MIN.
038400     IF B-INQT > P11-I-MAX
038500           MOVE B-INQT TO P11-I-MAX.
038600     IF B-INQT > P19-I-MAX
038700           MOVE B-INQT TO P19-I-MAX.
038800     MOVE ZERO TO P31-GES-MIN
038900                  P31-GES-MAX.
039000 P31-ENDE.
039100     EXIT.
040000******************************************************************
040100 P11 SECTION.
040300     MOVE P31-V-MAX     TO  PZ-VER-MAX.
040400     MOVE P31-V-MIN     TO  PZ-VER-MIN.
040500     COMPUTE ZW-VER-GES-REFE ROUNDED = P31-PROCT / 100.
040600     MOVE    ZW-VER-GES-REFE TO PZ-VER-GES.
041000     MOVE P31-ANZ-TRANS TO  PZ-ANZ.
041100     MOVE ZG-BCC (6)    TO  PZ-CC.
041200     MOVE ZG-PRI (6)    TO  PZ-PR.
041300     MOVE ZGPGM  (6)    TO  PZ-PGM.
041400     MOVE P31-I-MIN     TO  PZ-ES-MIN.
041500     MOVE P31-I-MAX     TO  PZ-ES-MAX.
041600     MOVE P31-GES-MIN-VERGL TO ZW1.
041700     MOVE PKT               TO ZEHNTEL.
041800     MOVE '.'               TO PKT.
042000     MOVE ZW1                TO PZ-GES-MIN.
042100     EXAMINE PZ-GES-MIN REPLACING LEADING '0' BY SPACES
042200     MOVE P31-GES-MAX-VERGL  TO ZW1.
042300     MOVE PKT                TO ZEHNTEL.
042500     MOVE ZW1                TO PZ-GES-MAX.
042550     EXAMINE PZ-GES-MAX REPLACING LEADING '0' BY ' '.
042600*            MITTLERE PROC-TIME
042700     COMPUTE ZW-REFE ROUNDED =
042800                P31-PROCT / P31-ANZ-TRANS.
042900     MOVE ZW-REFE TO ZW1.
043100     MOVE '.'     TO PKT.
043200     MOVE ZW1     TO PZ-VER-MIT.
043250     EXAMINE PZ-VER-MIT REPLACING LEADING '0' BY ' '.
043300*             MITTLERE INQ-TIME
043400     COMPUTE ZW-REFE ROUNDED =
043500                P31-INQT  / P31-ANZ-TRANS.
043600     MOVE ZW-REFE TO ZW1.
043700     MOVE PKT     TO ZEHNTEL
043800     MOVE '.'     TO PKT.
043900     MOVE ZW1     TO PZ-ES-MIT.
043950     EXAMINE PZ-ES-MIT REPLACING LEADING '0' BY ' '.
044000*              MITTLERE  VERWEIL-ZEIT
044100     COMPUTE ZW-REFE ROUNDED =
044200             ( P31-PROCT + P31-INQT) / P31-ANZ-TRANS.
044300     MOVE ZW-REFE TO     ZW1.
044400     MOVE PKT     TO     ZEHNTEL.
044500     MOVE '.'     TO     PKT.
044600     MOVE ZW1     TO     PZ-GES-MIT.
044650     EXAMINE PZ-GES-MIT REPLACING LEADING '0' BY ' '.
044700*
044800     ADD  P31-ANZ-TRANS TO P11-ANZ-TRANS.
044900     ADD  P31-INQT      TO P11-INQT.
045000     ADD  P31-PROCT     TO P11-PROCT.
045100     PERFORM SCHREIBEN.
045200 P11-ENDE.
045300     EXIT.
046000******************************************************************
046100 P12 SECTION.
046200*
046300*
046400     MOVE ' ' TO PZ-VER-MIN PZ-VER-MAX.
046500     COMPUTE ZW-VER-GES-REFE ROUNDED = P11-PROCT / 100.
046600     MOVE    ZW-VER-GES-REFE TO PZ-VER-GES.
047100     MOVE P11-ANZ-TRANS      TO PZ-ANZ.
047200     MOVE ' '                TO PZ-CC PZ-PR.
047300     MOVE ZGABT (6)          TO PZ-PGM.
047400     MOVE ' ' TO PZ-ES-MIN PZ-ES-MAX PZ-GES-MIN PZ-GES-MAX.
048600*                MITTL. PROC-TIME
048700     COMPUTE ZW-REFE ROUNDED =
048800                  P11-PROCT / P11-ANZ-TRANS.
048900     MOVE ZW-REFE TO ZW1.
049000     MOVE PKT     TO ZEHNTEL.
049100     MOVE '.'     TO PKT.
049300     EXAMINE PZ-VER-MIT REPLACING LEADING '0' BY SPACE.
049400*                MITTL  INQ-TIME
049500     COMPUTE ZW-REFE ROUNDED =
049600                  P11-INQT / P11-ANZ-TRANS.
049700     MOVE ZW-REFE TO ZW1.
049800     MOVE PKT     TO ZEHNTEL.
050000     MOVE '.'                TO PKT.
050100     MOVE ZW1                TO PZ-ES-MIT.
050200     EXAMINE PZ-ES-MIT REPLACING LEADING '0' BY SPACE.
050300*                MITTL. VERWEIL ZEIT
050400     COMPUTE ZW-REFE ROUNDED =
050500           (P11-PROCT + P11-INQT) / P11-ANZ-TRANS.
050600     MOVE ZW-REFE            TO ZW1.
050700     MOVE PKT                TO ZEHNTEL.
050800     MOVE '.'                TO PKT.
050900     MOVE ZW1                TO PZ-GES-MIT.
051000     EXAMINE PZ-GES-MIT REPLACING LEADING '0' BY SPACE.
051100     ADD P11-ANZ-TRANS       TO P19-ANZ-TRANS.
051200     ADD P11-INQT TO P19-INQT ON SIZE ERROR
051210                              MOVE P19-INQT TO PZ-VER-MIN
051220                              MOVE 'UEBERLAUF' TO PZ-PGM
051230                              PERFORM SCHREIBEN
051240                              GOBACK.
051300     ADD P11-PROCT           TO P19-PROCT.
051400     PERFORM SCHREIBEN.
051500*
051600*
051800 P12-ENDE.
051900     EXIT.
052000******************************************************************
052100 P19 SECTION.
052200*
052300*
052400     MOVE ' ' TO PZ-VER-MIN PZ-VER-MAX.
052500     COMPUTE ZW-VER-GES-REFE ROUNDED = P19-PROCT / 100.
052600     MOVE    ZW-VER-GES-REFE TO PZ-VER-GES.
053100     MOVE P19-ANZ-TRANS      TO PZ-ANZ.
053200     MOVE ' '                TO PZ-CC PZ-PR.
053300     MOVE 'GESAMT'           TO PZ-PGM.
053400     MOVE ' ' TO PZ-ES-MIN PZ-ES-MAX PZ-GES-MIN PZ-GES-MAX.
054600*                MITTL. PROC\
054700     COMPUTE ZW-REFE ROUNDED =
054800                P19-PROCT / P19-ANZ-TRANS.
054900     MOVE ZW-REFE            TO ZW1.
055000     MOVE PKT                TO ZEHNTEL.
055100     MOVE '.'                TO PKT.
055200     MOVE ZW1                TO PZ-VER-MIT.
055300     EXAMINE PZ-VER-MIT REPLACING LEADING '0' BY SPACE.
055400*                MITTL. INQT.
055500     COMPUTE ZW-REFE ROUNDED =
055600               P19-INQT / P19-ANZ-TRANS.
055700     MOVE ZW-REFE           TO ZW1.
055800     MOVE PKT               TO ZEHNTEL.
055900     MOVE '.'               TO PKT.
056000     MOVE ZW1 TO PZ-ES-MIT.
056100     EXAMINE PZ-ES-MIT REPLACING LEADING '0' BY ' '.
056200*                MITTL VERWEIL-ZEIT.
056300     COMPUTE ZW-REFE ROUNDED =
056400             (P19-PROCT + P19-INQT) / P19-ANZ-TRANS.
056500     MOVE ZW-REFE           TO ZW1.
056600     MOVE PKT               TO ZEHNTEL.
056700     MOVE '.'               TO PKT.
056800     MOVE ZW1               TO PZ-GES-MIT.
056900     EXAMINE PZ-GES-MIT REPLACING LEADING '0' BY SPACE.
057000     PERFORM UEBERSCHRIFT.
057100     PERFORM SCHREIBEN.
057200     CLOSE ADRS1.
057400*
057500*
057600*
057700*
057800 P19-ENDE.
057900     EXIT.
058000******************************************************************
058100 P20 SECTION.
058200     MOVE ZERO TO NS-ES.
058250     MOVE ZERO TO P19-GES-MAX-VERGL.
058251     MOVE ZERO TO P19-ANZ-TRANS P19-INQT P19-PROCT.
058252     MOVE LOW-VALUE TO P19-V-MAX  P19-I-MAX.
058253     MOVE HIGH-VALUE TO P19-V-MIN P19-I-MIN.
058260     MOVE 999999 TO P19-GES-MIN-VERGL.
058300 P20-ENDE.
058400     EXIT.
059000******************************************************************
059100 P21 SECTION.
059150     MOVE ZGR (5) TO ZGR (6).
059200     MOVE ZERO TO P31-ANZ-TRANS
059300                  P31-INQT
059400                  P31-PROCT
059450                  P31-GES-MIN
059460                  P31-GES-MAX
059500                  P31-GES-MAX-VERGL.
059600     MOVE 999999 TO P31-GES-MIN-VERGL.
059700     MOVE LOW-VALUE      TO P31-V-MAX P31-I-MAX.
059800     MOVE HIGH-VALUE     TO P31-V-MIN P31-I-MIN.
059900 P21-ENDE.
060000     EXIT.
063000******************************************************************
063100 P22 SECTION.
063200     MOVE ZERO TO P11-ANZ-TRANS
063300                  P11-INQT
063400                  P11-PROCT
063450                P11-GES-MIN
063460                P11-GES-MAX
063500                  P11-GES-MAX-VERGL.
063600     MOVE 999999 TO P11-GES-MIN-VERGL.
063700     PERFORM UEBERSCHRIFT.
063800     MOVE LOW-VALUE   TO P11-V-MAX P11-I-MAX.
063900     MOVE HIGH-VALUE  TO P11-V-MIN P11-I-MIN.
064000 P22-ENDE.
064100     EXIT.
065000 SCHREIBEN SECTION.
065100     ADD 2 TO ZZ.
065200     IF ZZ > 60 PERFORM UEBERSCHRIFT.
065300     WRITE ADS FROM PZ AFTER POSITIONING V-PZ.
065400 UEBERSCHRIFT SECTION.
065500     ADD 1 TO SZ.
065600     MOVE SZ TO UE1-SZ.
065700     WRITE ADS FROM UE1  AFTER POSITIONING V1.
065800     MOVE ZERO TO ZZ.
065900     WRITE ADS FROM UE2  AFTER POSITIONING V2.
066000     WRITE ADS FROM UE3  AFTER POSITIONING V3.
066100     WRITE ADS FROM UE4 AFTER POSITIONING UE4-V.
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
000010 ID DIVISION.
000020 PROGRAM-ID. O40108.
000030 AUTHOR. OR401.
000040 INSTALLATION. DEUTSCHE BUNDESBANK.
000050 DATE-WRITTEN. JUNI 1976.
000060 DATE-COMPILED.
000070 REMARKS.
000090*                                                                *
000120*    EINGABE :   REPRORT AUS DFSILTA0                            *
000130*                                                                *
000140*    REPORT WIRD SORTIERT NACH "TIME OF SMB ENQUEUE"             *
000150*                              (STELLE 46 DES REPORTS)           *
000160*                            (IN DER LAENGE 10)                  *
000170*    ES KANN NACH FOLGENDEN ZEITINTERVALLEN ( = GRUPPENBEGRIFF)  *
000180*    AUSGEGEBEN WERDEN:                                          *
000190*    15 MIN, 30 MIN, 45 MIN, 60 MIN, 90 MIN, 120 MIN, 180 MIN    *
000210*                                                                *
000220*    DER GEWUENSCHTE ZEITINTERVALL WIRD DURCH DIE PARM-ANWEISUNG *
000230*    IN DER EXEC-KARTE EIGEGEBEN.                                *
000240*    DIE PARM-ANWEISUNG HAT FOLGENDEN AUFBAU:                    *
000250*    STELLE             TEXT                                     *
000260*     1-8               DATUM (TT.MM.JJ)                         *
000270*       9               BLANK                                    *
000280*    10-19              BELIEBIG (Z.B. "GANZTAEGIG")             *
000290*    20-22              ZEITINTERVALL IN MINUTEN (Z.B. 015)      *
000300*                                                                *
000320*                                                                *
000330*    BEI RUECKFRAGEN BITTE WENDEN AN :                           *
000340*                                                                *
000350*    WOLFGANG SCHMINKE                                           *
000360*    C/O DEUTSCHE BUNDESBANK                                     *
000370*        POSTFACH 2633                                           *
000380*        6000 FRANKFURT / MAIN                                   *
000390*                                                                *
000400*    TEL. 0611 / 1582566                                         *
000410*                                                                *
000420*    ODER                                                        *
000430*                                                                *
000440*    HEINRICH TOMASCHEK                                          *
000450*    GLEICHE ANSCHRIFT                                           *
000460*                                                                *
000470*    TEL. 0611 / 1582564                                         *
000480*                                                                *
000490******************************************************************
000500     EJECT
           EJECT
001010 ENVIRONMENT DIVISION.
001020 CONFIGURATION SECTION.
001030 SOURCE-COMPUTER. IBM-370-J158.
001040 OBJECT-COMPUTER. IBM-370-J158.
           SKIP3
001060 INPUT-OUTPUT SECTION.
001070 FILE-CONTROL.
001080     SELECT    EBAS1        ASSIGN TO   UT-S-EBAS1.
001090     SELECT    ADRS1        ASSIGN TO   UT-S-ADRS1.
           EJECT
002010 DATA DIVISION.
002020 FILE SECTION.
002030 FD  EBAS1 RECORDING F BLOCK 0 RECORDS LABEL RECORDS OMITTED.
002040     1 EBS                   PIC X(133).
           SKIP3
002060 FD  ADRS1 RECORDING F BLOCK 0 RECORDS LABEL RECORDS OMITTED.
002070     1 ADS                   PIC X(133).
           EJECT
004010 WORKING-STORAGE SECTION.
004020 77  COIBM               PIC X(32) VALUE
004030     '5734-CB1 COPYRIGHT IBM CORP.1969'.
004040     1 ZAEHLER.
004050       3 FILLER              PIC X(7) VALUE 'ZAEHLER'.
004060       3 ZZ                  PIC 99   VALUE 80.
004070       3 SZ                  PIC 999  VALUE ZERO.
004071       3 I-Z                 PIC S9(4) VALUE ZERO COMP.
004072       3 SPRG-ZAE            PIC 99 VALUE ZERO.
004073       3 HILFS-IND           PIC 99 VALUE ZERO.
004074       3 ZW-I-Z              PIC S9(4) VALUE ZERO.
004075       3 LEER-IND            PIC S9(4) VALUE ZERO COMP.
004076       3 S-I                 PIC S9(4) VALUE ZERO COMP.
004077       3 LIX                 PIC S9(4) VALUE ZERO COMP.
004080     01 STAPDEF.
004090       3 FILLER              PIC X(07) VALUE 'STAPDEF'.
004100       3 NS-ES               PIC X     VALUE '1'.
004110       3 ILES                PIC S9(4) COMP VALUE ZERO.
004120       3 AD                  PIC 9     VALUE      ZERO.
004130       3 IAW                 PIC S9(4) COMP VALUE ZERO.
009020       3 FILLER              PIC X(01).
009030       3 B-SWEQ              PIC X(05).
009035       3 FILLER              PIC X.
009040       3 B-TRAN              PIC X(08).
009045       3 FILLER              PIC X.
009050       3 B-PRI               PIC X(01).
009055       3 FILLER              PIC X.
009060       3 B-CC                PIC X(03).
009065       3 FILLER              PIC X.
009070       3 B-IL                PIC X(02).
009080       3 B-TERIN             PIC X(02).
009085       3 FILLER              PIC X.
009090       3 B-OL                PIC X(02).
009100       3 B-TEROUT            PIC X(02).
009105       3 FILLER              PIC X.
009110       3 B-PRTYP             PIC X(01).
009115       3 FILLER              PIC X.
009120       3 B-PGM               PIC X(08).
009160       3 FILLER              PIC X(3).
009170       3 B-ENQ.
009171         5 B-ENQ-HH          PIC XX.
009172         5 FILLER            PIC X.
009173         5 B-ENQ-MM          PIC XX.
009180       3 FILLER              PIC X(54).
009190       3 B-INQT              PIC X(06).
009195       3 FILLER              PIC X.
009200       3 B-PROCT             PIC X(06).
009205       3 FILLER              PIC X.
010010       3 B-OUTQT             PIC X(06).
010015       3 FILLER              PIC X.
010020       3 B-TOTT              PIC X(06).
011000     1 ZABT.
011100      3 FILLER               PIC XX.
011200      3 ZWABT                PIC XXX.
011300     1 ZG.
011400      3 ZGR OCCURS 6.
011500       5 ZGRGW1.
011700         9 ZGRST             PIC X.
011800         9 ZGSPG             PIC S999.
011900     1 ZEIT-TABELLE.
011910      3 FILLER               PIC X(56) VALUE
011920     '00150030004501000115013001450200021502300245030003150330'.
011930      3 FILLER               PIC X(56) VALUE
011940     '03450400041504300445050005150530054506000615063006450700'.
011950      3 FILLER               PIC X(56) VALUE
011960     '07150730074508000815083008450900091509300945100010151030'.
011970      3 FILLER               PIC X(56) VALUE
011980     '10451100111511301145120012151230124513001315133013451400'.
011990      3 FILLER               PIC X(56) VALUE
012000     '14151430144515001515153015451600161516301645170017151730'.
012010      3 FILLER               PIC X(56) VALUE
012020     '17451800181518301845190019151930194520002015203020452100'.
012030      3 FILLER               PIC X(48) VALUE
012040     '211521302145220022152230224523002315233023452400'.
012050     1 Z-TAB          REDEFINES ZEIT-TABELLE.
012060      3 FELDER OCCURS 96.
012070       5 T-HH-MM             PIC 9999.
013000     1 UE1.
013050      3 V1                   PIC X VALUE'1'.
013100      3 FILLER               PIC XXXX VALUE ' '.
013200       3 FILLER              PIC X(58) VALUE
013300     'PROGRAMM  OR40108  IMSVS   A N T W O R T Z E I T E N  IM I'.
013400       3 FILLER              PIC X(35) VALUE
013500     ' M S - D C - B E T R I E B   DATUM '.
013600       3 UE1-DAT             PIC X(11).
013700       3 UE1-TAG-ZEIT        PIC X(11) VALUE ' '.
013800       3 FILLER              PIC X(6) VALUE 'SEITE'.
013900       3 UE1-SZ              PIC ZZZ.
014000     1 UE2.
014050       3 V2                  PIC X VALUE '0'.
014100      3 FILLER               PIC X(58) VALUE
014200     '   ZEITRAUM                      ANZ     VERARBEITUNGSZEIT'.
014300      3 FILLER               PIC X(58) VALUE
014400     '    (SSSS.T)          EING.WS            EING.WS + VERARB.'.
014500      3 FILLER               PIC X(5)  VALUE 'ZEIT'.
014600     1 UE3.
014650      3 V3                   PIC X VALUE ' '.
014700       3 FILLER              PIC X(41) VALUE ' '.
014800      3 FILLER               PIC X(58) VALUE
014900     'MIN   MITTEL      MAX     GES     MIN  MITTEL     MAX     '.
015000      3 FILLER               PIC X(20) VALUE
015100     'MIN  MITTEL     MAX'.
016000     1 ZWFELD.
016100      3 FILLER               PIC X(14) VALUE 'ZWISCHENFELDER'.
016200      3 ZW1.
016300       5 FILLER              PIC X(4).
016400       5 PKT                 PIC X.
016500       5 ZEHNTEL             PIC X.
016600      3 ZW2.
016700       5 Z-INQT              PIC 9(6).
016800       5 Z-PROCT             PIC 9(6).
016900       5 Z-TOTT              PIC 9(6).
017000     1 REFES.
017100      3 FILLER               PIC X(12) VALUE 'RECHENFELDER'.
017200      3 P31-ANZ-TRANS        PIC 9(6).
017300      3 P31-V-MIN            PIC X(6).
017400      3 P31-V-MAX            PIC X(6).
017500      3 P11-ANZ-TRANS        PIC 9(6).
017600      3 P11-V-MIN            PIC X(6).
017700      3 P11-V-MAX            PIC X(6).
017800      3 P31-INQT             PIC 9(7).
017900      3 P31-PROCT            PIC 9(7).
018000      3 P11-INQT             PIC 9(7).
018100      3 P11-PROCT            PIC 9(7).
018200      3 ZW-REFE              PIC 9(6).
018250      3 ZW-VER-GES-REFE      PIC 9(8).
018300      3 P31-I-MIN            PIC X(6).
018400      3 P31-I-MAX            PIC X(6).
018500      3 P31-GES-MIN          PIC 9(6).
018600      3 P31-GES-MAX          PIC 9(6).
018700      3 P31-GES-MAX-VERGL    PIC 9(6).
018800      3 P31-GES-MIN-VERGL    PIC 9(6).
019000      3 P19-ANZ-TRANS        PIC 9(6).
019100      3 P19-V-MIN            PIC X(6).
019200      3 P19-V-MAX            PIC X(6).
019300      3 P19-INQT             PIC 9(8).
019400      3 P19-PROCT            PIC 9(8).
019500      3 P19-I-MIN            PIC X(6).
019600      3 P19-I-MAX            PIC X(6).
019700      3 P19-GES-MIN          PIC 9(6) VALUE ZERO.
019800      3 P19-GES-MAX          PIC 9(6) VALUE ZERO.
019900      3 P19-GES-MIN-VERGL    PIC 9(6).
020000      3 P19-GES-MAX-VERGL    PIC 9(6).
020100      3 P11-GES-MIN-VERGL    PIC 9(6).
020200      3 P11-GES-MAX-VERGL    PIC 9(6).
020300      3 P11-GES-MIN          PIC 9(6).
020400      3 P11-GES-MAX          PIC 9(6).
020500      3 P11-I-MIN            PIC X(6).
020600      3 P11-I-MAX            PIC X(6).
021000     1 PZ.
021050      3 V-PZ                 PIC X VALUE '0'.
021200      3 FILLER               PIC X(3).
021300      3 PZ-V-B               PIC X(25).
021600      3 PZ-ANZ               PIC Z(8).
021700      3 FILLER               PIC X(2) VALUE ' '.
021800      3 PZ-VER-MIN           PIC X(9).
021900      3 PZ-VER-MIT           PIC X(9).
022000      3 PZ-VER-MAX           PIC X(8).
022100      3 PZ-VER-GES           PIC Z(8).
022200      3 PZ-ES-MIN            PIC X(8).
022300      3 PZ-ES-MIT            PIC X(8).
022400      3 PZ-ES-MAX            PIC X(8).
022500      3 PZ-GES-MIN           PIC X(8).
022600      3 PZ-GES-MIT           PIC X(8).
022700      3 PZ-GES-MAX           PIC X(8).
022710     1 UE4.
022720      3 UE4-V                PIC X VALUE ' '.
022730      3 FILLER               PIC X(41) VALUE ' '.
022740      3 FILLER               PIC X(29) VALUE
022750     '-----------------------------'.
022760      3 FILLER               PIC X(5) VALUE ' '.
022770      3 FILLER               PIC X(19) VALUE
022780     '-------------------'.
022790      3 FILLER               PIC X(5) VALUE ' '.
022795      3 FILLER               PIC X(19) VALUE
022796     '-------------------'.
022800     1 ZW-PZ-V-B.
022810      3 FILLER               PIC X(4) VALUE 'VON'.
022820      3 ZW-PZ-V-HH           PIC XX.
022830      3 FILLER               PIC X VALUE '.'.
022840      3 ZW-PZ-V-MM           PIC XXX.
022850      3 FILLER               PIC X(10) VALUE 'BIS UNTER'.
022860      3 ZW-PZ-B-HH           PIC XX.
022870      3 FILLER               PIC X VALUE '.'.
022880      3 ZW-PZ-B-MM           PIC XX.
022890     1 ZW-Z-VERGL.
022900      3 ZW-Z-VERGL-HH        PIC XX.
022910      3 ZW-Z-VERGL-MM        PIC XX.
022920     1 ZW-Z-VERGL-RED REDEFINES ZW-Z-VERGL.
022930      3 ZW-V-HH-MM           PIC 9(4).
022940     1 LEER-ZW.
022950      3 LEER-HH              PIC XX.
022960      3 LEER-MM              PIC XX.
023000 LINKAGE SECTION.
023100     1 LKS.
023200      3 LKS-ZAE              PIC 9(4) COMP.
023300      3 VER-DAT.
023400       5 LS-DATUM            PIC X(8).
023500       5 FILLER              PIC X.
023600       5 GVN                 PIC X(10).
023700       5 LKS-MM              PIC 999.
023710      EJECT
024000 PROCEDURE DIVISION USING LKS.
024100 VORLAUF.
024200     PERFORM P00 THRU P00-ENDE.
024300 EINGABE.
024400     IF ZGRST (1) = '0'
024500         PERFORM P01 THRU P01-ENDE.
024600 AUSWAHL.
024700     MOVE ZGR (1) TO ZGR (5).
024800     MOVE 1 TO IAW.
024900     MOVE IAW TO ILES.
025000 AWG1.
025100     ADD 1 TO IAW.
025200     IF IAW > AD
025300        GO TO AWG2.
025400     IF ZGR (IAW) < ZGR (5)
025500        MOVE ZGR (IAW) TO ZGR (5)
025600        MOVE IAW       TO ILES.
025700     GO TO AWG1.
025800 AWG2.
025900     MOVE '0' TO ZGRST (ILES).
026000 GRUPPE.
026100     IF NS-ES = '1'
026200       IF ZGRST (5) = '9'
026300          PERFORM P19 THRU P19-ENDE
026400          STOP RUN
026500       ELSE GO TO ERSTER.
026600     IF ZGRGW1 (5) = ZGRGW1 (6)
026700          GO TO POSTEN.
026800     PERFORM P11 THRU P11-ENDE.
027200     IF ZGRST  (5) = ZGRST  (6)
027300          GO TO ESG1.
027400     PERFORM      P19 THRU P19-ENDE.
027500     STOP RUN.
028000 ERSTER.
028100     PERFORM P20 THRU P20-ENDE.
028400 ESG1.
028500     PERFORM P21 THRU P21-ENDE.
028600 POSTEN.
028700     IF ILES = 1
028800        PERFORM P31 THRU P31-ENDE
028900        GO TO EINGABE.
029000     STOP RUN.
029010*
029020******************************************************************
029030*
030000 P00 SECTION.
030100     OPEN INPUT EBAS1.
030200     OPEN OUTPUT ADRS1.
030210     MOVE 4 TO SPRG-ZAE.
030220     IF LKS-MM = 15 MOVE 1 TO SPRG-ZAE.
030230     IF LKS-MM = 30 MOVE 2 TO SPRG-ZAE.
030240     IF LKS-MM   = 45 MOVE 3 TO SPRG-ZAE.
030250     IF LKS-MM   = 60 MOVE 4 TO SPRG-ZAE.
030260     IF LKS-MM   = 90 MOVE 6 TO SPRG-ZAE.
030270     IF LKS-MM = 120 MOVE 8 TO SPRG-ZAE.
030280     IF LKS-MM = 180 MOVE 12 TO SPRG-ZAE.
030300     MOVE ZERO TO ZG.
030400     MOVE LS-DATUM TO UE1-DAT.
030500     MOVE GVN      TO UE1-TAG-ZEIT.
030550     IF LKS-ZAE < 9 MOVE ' ' TO UE1-TAG-ZEIT.
030600 P00-ENDE.
030700     EXIT.
030710*
030720******************************************************************
030730*
031000 P01 SECTION.
031100     READ EBAS1 INTO WSEB AT END MOVE '9' TO ZGRST (1)
031150                                          GO TO P01-ENDE.
031151     EXAMINE B-PGM TALLYING ALL '*'.
031152     IF TALLY > ZERO GO TO P01.
031153     IF B-ENQ = ' ' GO TO P01.
031155     IF B-PGM = ' ' GO TO P01.
031200     MOVE '5' TO ZGRST (1).
031300     TRANSFORM B-ENQ-HH FROM SPACE TO ZERO.
031400     MOVE B-ENQ-HH TO ZW-Z-VERGL-HH.
031500     MOVE B-ENQ-MM TO ZW-Z-VERGL-MM.
031600     PERFORM SUCHEN THRU SUCHEN-ENDE.
031700     MOVE I-Z TO ZGSPG (1).
031750     MOVE ZERO TO I-Z.
031800 P01-ENDE.
031900     EXIT.
032000******************************************************************
032100 P31 SECTION.
032200     MOVE B-INQT    TO  ZW1.
032300     MOVE ZEHNTEL   TO  PKT.
032400     MOVE SPACE     TO  ZEHNTEL.
032500     MOVE ZW1       TO  Z-INQT.
032600     MOVE B-PROCT   TO  ZW1.
032700     MOVE ZEHNTEL   TO  PKT.
032800     MOVE SPACE     TO  ZEHNTEL.
032900     MOVE ZW1       TO  Z-PROCT.
033000     TRANSFORM Z-INQT   FROM SPACE TO ZERO.
033100     TRANSFORM Z-PROCT  FROM SPACE TO ZERO.
033200     ADD       Z-INQT   TO P31-INQT.
033300     ADD       Z-PROCT  TO P31-PROCT.
033400     ADD       1        TO P31-ANZ-TRANS.
034000     IF B-PROCT > P31-V-MAX
034100         MOVE B-PROCT TO P31-V-MAX.
034200     IF B-PROCT < P31-V-MIN
034300         MOVE B-PROCT TO P31-V-MIN.
034400     IF B-INQT  > P31-I-MAX
034500         MOVE B-INQT  TO P31-I-MAX.
034600     IF B-INQT < P31-I-MIN
034700         MOVE B-INQT  TO P31-I-MIN.
034800*
034900     ADD Z-INQT TO P31-GES-MIN P31-GES-MAX
035000     ADD Z-PROCT TO P31-GES-MIN P31-GES-MAX.
035100     IF P31-GES-MIN < P31-GES-MIN-VERGL
035200           MOVE P31-GES-MIN TO P31-GES-MIN-VERGL.
035300     IF P31-GES-MAX > P31-GES-MAX-VERGL
035400           MOVE P31-GES-MAX TO P31-GES-MAX-VERGL.
036200     IF P31-GES-MIN < P19-GES-MIN-VERGL
036300            MOVE P31-GES-MIN TO P19-GES-MIN-VERGL.
036600     IF P31-GES-MAX > P19-GES-MAX-VERGL
036700            MOVE P31-GES-MAX TO P19-GES-MAX-VERGL.
036800     IF B-PROCT > P19-V-MAX
036900            MOVE B-PROCT TO P19-V-MAX.
037200     IF B-PROCT < P19-V-MIN
037300            MOVE B-PROCT TO P19-V-MIN.
038200     IF B-INQT < P19-I-MIN
038300           MOVE B-INQT TO P19-I-MIN.
038600     IF B-INQT > P19-I-MAX
038700           MOVE B-INQT TO P19-I-MAX.
038800     MOVE ZERO TO P31-GES-MIN
038900                  P31-GES-MAX.
039000 P31-ENDE.
039100     EXIT.
040000******************************************************************
040100 P11 SECTION.
040300     MOVE P31-V-MAX     TO  PZ-VER-MAX.
040400     MOVE P31-V-MIN     TO  PZ-VER-MIN.
040500     COMPUTE ZW-VER-GES-REFE ROUNDED = P31-PROCT / 100.
040600     MOVE    ZW-VER-GES-REFE TO PZ-VER-GES.
041000     MOVE P31-ANZ-TRANS TO  PZ-ANZ.
041100     MOVE ZGSPG (6) TO I-Z.
041102     SUBTRACT SPRG-ZAE FROM I-Z.
041105      ADD SPRG-ZAE  I-Z TO S-I.
041110     MOVE T-HH-MM (I-Z) TO LEER-ZW.
041120     MOVE LEER-HH TO ZW-PZ-V-HH. MOVE LEER-MM TO ZW-PZ-V-MM.
041125     MOVE T-HH-MM (S-I) TO LEER-ZW.
041126     MOVE LEER-HH TO ZW-PZ-B-HH. MOVE LEER-MM TO ZW-PZ-B-MM.
041140     MOVE ZW-PZ-V-B TO PZ-V-B.
041400     MOVE P31-I-MIN     TO  PZ-ES-MIN.
041500     MOVE P31-I-MAX     TO  PZ-ES-MAX.
041600     MOVE P31-GES-MIN-VERGL TO ZW1.
041700     MOVE PKT               TO ZEHNTEL.
041800     MOVE '.'               TO PKT.
042000     MOVE ZW1                TO PZ-GES-MIN.
042100     EXAMINE PZ-GES-MIN REPLACING LEADING '0' BY SPACES
042200     MOVE P31-GES-MAX-VERGL  TO ZW1.
042300     MOVE PKT                TO ZEHNTEL.
042400     MOVE '.'                TO PKT.
042500     MOVE ZW1                TO PZ-GES-MAX.
042550     EXAMINE PZ-GES-MAX REPLACING LEADING '0' BY ' '.
042600*            MITTLERE PROC-TIME
042700     COMPUTE ZW-REFE ROUNDED =
042800                P31-PROCT / P31-ANZ-TRANS.
042900     MOVE ZW-REFE TO ZW1.
043000     MOVE PKT     TO ZEHNTEL.
043100     MOVE '.'     TO PKT.
043200     MOVE ZW1     TO PZ-VER-MIT.
043250     EXAMINE PZ-VER-MIT REPLACING LEADING '0' BY ' '.
043300*             MITTLERE INQ-TIME
043400     COMPUTE ZW-REFE ROUNDED =
043500                P31-INQT  / P31-ANZ-TRANS.
043600     MOVE ZW-REFE TO ZW1.
043700     MOVE PKT     TO ZEHNTEL
043800     MOVE '.'     TO PKT.
043900     MOVE ZW1     TO PZ-ES-MIT.
043950     EXAMINE PZ-ES-MIT REPLACING LEADING '0' BY ' '.
044000*              MITTLERE  VERWEIL-ZEIT
044100     COMPUTE ZW-REFE ROUNDED =
044200             ( P31-PROCT + P31-INQT) / P31-ANZ-TRANS.
044300     MOVE ZW-REFE TO     ZW1.
044400     MOVE PKT     TO     ZEHNTEL.
044500     MOVE '.'     TO     PKT.
044600     MOVE ZW1     TO     PZ-GES-MIT.
044650     EXAMINE PZ-GES-MIT REPLACING LEADING '0' BY ' '.
044700*
044800     ADD  P31-ANZ-TRANS TO P19-ANZ-TRANS.
044910     ADD P31-INQT TO P19-INQT ON SIZE ERROR
044920                              MOVE P19-INQT TO PZ-VER-MIN
044930                              MOVE 'UEBERLAUF' TO PZ-V-B
044940                              PERFORM SCHREIBEN
044950                              GOBACK.
045000     ADD  P31-PROCT     TO P19-PROCT.
045100     PERFORM SCHREIBEN.
045110     MOVE ZERO TO HILFS-IND.
045120     COMPUTE ZW-I-Z = (ZGSPG (1) - ZGSPG (6)) / SPRG-ZAE - 1.
045125     MOVE ZGSPG (6) TO LIX.
045126     SUBTRACT SPRG-ZAE FROM LIX.
045130     PERFORM LEER THRU LEER-ENDE ZW-I-Z TIMES.
045200 P11-ENDE.
045300     EXIT.
052000******************************************************************
052100 P19 SECTION.
052200*
052300*
052400     MOVE ' ' TO PZ-VER-MIN PZ-VER-MAX.
052500     COMPUTE ZW-VER-GES-REFE ROUNDED = P19-PROCT / 100.
052600     MOVE    ZW-VER-GES-REFE TO PZ-VER-GES.
053100     MOVE P19-ANZ-TRANS      TO PZ-ANZ.
053300     MOVE 'GESAMT' TO PZ-V-B.
053400     MOVE ' ' TO PZ-ES-MIN PZ-ES-MAX PZ-GES-MIN PZ-GES-MAX.
054600*                MITTL. PROC\
054700     COMPUTE ZW-REFE ROUNDED =
054800                P19-PROCT / P19-ANZ-TRANS.
054900     MOVE ZW-REFE            TO ZW1.
055000     MOVE PKT                TO ZEHNTEL.
055100     MOVE '.'                TO PKT.
055200     MOVE ZW1                TO PZ-VER-MIT.
055300     EXAMINE PZ-VER-MIT REPLACING LEADING '0' BY SPACE.
055400*                MITTL. INQT.
055500     COMPUTE ZW-REFE ROUNDED =
055600               P19-INQT / P19-ANZ-TRANS.
055700     MOVE ZW-REFE           TO ZW1.
055800     MOVE PKT               TO ZEHNTEL.
055900     MOVE '.'               TO PKT.
056000     MOVE ZW1 TO PZ-ES-MIT.
056100     EXAMINE PZ-ES-MIT REPLACING LEADING '0' BY ' '.
056200*                MITTL VERWEIL-ZEIT.
056300     COMPUTE ZW-REFE ROUNDED =
056400             (P19-PROCT + P19-INQT) / P19-ANZ-TRANS.
056500     MOVE ZW-REFE           TO ZW1.
056600     MOVE PKT               TO ZEHNTEL.
056700     MOVE '.'               TO PKT.
056800     MOVE ZW1               TO PZ-GES-MIT.
056900     EXAMINE PZ-GES-MIT REPLACING LEADING '0' BY SPACE.
057100     PERFORM SCHREIBEN.
057200     CLOSE ADRS1.
057300     CLOSE EBAS1.
057400*
057500*
057600*
057700*
057800 P19-ENDE.
057900     EXIT.
058000******************************************************************
058100 P20 SECTION.
058200     MOVE ZERO TO NS-ES.
058250     MOVE ZERO TO P19-GES-MAX-VERGL.
058251     MOVE ZERO TO P19-ANZ-TRANS P19-INQT P19-PROCT.
058252     MOVE LOW-VALUE TO P19-V-MAX  P19-I-MAX.
058253     MOVE HIGH-VALUE TO P19-V-MIN P19-I-MIN.
058260     MOVE 999999 TO P19-GES-MIN-VERGL.
058300 P20-ENDE.
058400     EXIT.
059000******************************************************************
059100 P21 SECTION.
059150     MOVE ZGR (5) TO ZGR (6).
059200     MOVE ZERO TO P31-ANZ-TRANS
059300                  P31-INQT
059400                  P31-PROCT
059450                  P31-GES-MIN
059460                  P31-GES-MAX
059465                  S-I       I-Z
059500                  P31-GES-MAX-VERGL.
059600     MOVE 999999 TO P31-GES-MIN-VERGL.
059700     MOVE LOW-VALUE      TO P31-V-MAX P31-I-MAX.
059800     MOVE HIGH-VALUE     TO P31-V-MIN P31-I-MIN.
059900 P21-ENDE.
060000     EXIT.
063000******************************************************************
065000 SCHREIBEN SECTION.
065100     ADD 2 TO ZZ.
065200     IF ZZ > 56 PERFORM UEBERSCHRIFT.
065300     WRITE ADS FROM PZ AFTER POSITIONING V-PZ.
065310*
065320******************************************************************
065330*
065400 UEBERSCHRIFT SECTION.
065500     ADD 1 TO SZ.
065600     MOVE SZ TO UE1-SZ.
065700     WRITE ADS FROM UE1  AFTER POSITIONING V1.
065800     MOVE ZERO TO ZZ.
065900     WRITE ADS FROM UE2  AFTER POSITIONING V2.
066000     WRITE ADS FROM UE3  AFTER POSITIONING V3.
066100     WRITE ADS FROM UE4 AFTER POSITIONING UE4-V.
066110*
066120******************************************************************
066130*
070000 SUCHEN SECTION.
070100 ADDIEREN.
070200     ADD SPRG-ZAE TO I-Z.
070210     IF I-Z > 96 MOVE I-Z TO PZ-ANZ
070220                 MOVE 'INDEX' TO PZ-V-B
070230                 PERFORM SCHREIBEN
070240                 GOBACK.
070300     IF ZW-V-HH-MM < T-HH-MM (I-Z) GO TO SUCHEN-ENDE.
070400     GO TO ADDIEREN.
070500 SUCHEN-ENDE.
070600     EXIT.
070610*
070620******************************************************************
070630*
075000 LEER SECTION.
075100     ADD SPRG-ZAE TO HILFS-IND LIX.
075200     COMPUTE LEER-IND = ZGSPG    (6) + HILFS-IND.
075300     MOVE T-HH-MM (LEER-IND) TO LEER-ZW.
075400     MOVE LEER-HH TO ZW-PZ-B-HH. MOVE LEER-MM TO ZW-PZ-B-MM.
075450     MOVE LIX       TO LEER-IND.
075460     MOVE T-HH-MM (LEER-IND) TO LEER-ZW.
075470     MOVE LEER-HH TO ZW-PZ-V-HH. MOVE LEER-MM TO ZW-PZ-V-MM.
075600     MOVE ZERO TO PZ-ANZ PZ-VER-GES.
075700     MOVE ' ' TO PZ-VER-MIN PZ-VER-MIT PZ-VER-MAX
075800                 PZ-ES-MIN  PZ-ES-MIT  PZ-ES-MAX
075900                 PZ-GES-MIN PZ-GES-MIT PZ-GES-MAX.
075950     MOVE ZW-PZ-V-B TO PZ-V-B.
076000     PERFORM SCHREIBEN.
076100 LEER-ENDE.
076200     EXIT.

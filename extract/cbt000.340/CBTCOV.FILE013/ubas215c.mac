000010* STAND 05/20/81
000020 IDENTIFICATION DIVISION.
000030 PROGRAM-ID.    OPV20.
000040 AUTHOR.        LINCK FOD/O.
000050 DATE-WRITTEN.  JULI 1974.
000060 DATE-COMPILED. JULI 1974.
000070 REMARKS.       INITIALISIEREN DER ABSTIMMSUMMEN-DATEI.
000080     SKIP3
000090 ENVIRONMENT DIVISION.
000100 INPUT-OUTPUT SECTION.
000110 FILE-CONTROL.
000120     SELECT D-ASTKOR   ASSIGN UT-S-ASTKOR.
000130     SELECT D-ASTPRINT ASSIGN UT-S-ASTPRINT.
000140     SELECT D-ASTSUM   ASSIGN DA-ASTSUM
000150                       ACCESS IS SEQUENTIAL
000160                 ORGANIZATION IS INDEXED
000170                       RECORD KEY IS ASUMNR IN S-ASTSUM.
000180     EJECT
000190 DATA DIVISION.
000200     SKIP2
000210 FILE SECTION.
000220     SKIP1
000230 FD  D-ASTKOR   BLOCK CONTAINS 0 RECORDS
000240                RECORD CONTAINS 80 CHARACTERS
000250                RECORDING MODE F
000260                LABEL RECORD STANDARD
000270                DATA RECORD S-ASTKOR.
000280     COPY ACKORDF.
000290     SKIP1
000300 FD  D-ASTPRINT BLOCK CONTAINS 0 RECORDS
000310                RECORD CONTAINS 120 CHARACTERS
000320                RECORDING MODE F
000330                LABEL RECORD STANDARD
000340                DATA RECORD S-ASTPRINT.
000350 01  S-ASTPRINT  PIC X(120).
000360     SKIP1
000370 FD  D-ASTSUM   BLOCK CONTAINS 1 RECORDS
000380                DATA RECORD S-ASTSUM.
000390     COPY ACSUMDFV.
000400 WORKING-STORAGE SECTION.
000410     COPY ACDATDF.
000420     COPY ACDRUDF.
000430     EJECT
000440 PROCEDURE DIVISION.
000450     SKIP1
000460 VORUEB.
000470     COPY ACVOR.
000480     MOVE 'OP020 01' TO PGM.
000490     MOVE 'INITIALISIERUNG' TO UEBTXT.
000500     OPEN INPUT D-ASTKOR.
000510     OPEN OUTPUT D-ASTSUM.
000520     MOVE ALL '-' TO STRICH.
000530     SKIP2
000540* H A U P T T E I L
000550* -----------------
000560 MAIN.
000570     PERFORM LESKOR.
000580     IF  NOT NEU-K MOVE 7 TO ERR.
000590     IF ERR NOT = 0  GO TO MAIN1.
000600     MOVE CORRESPONDING ASUMNRZ TO ASUMNR IN ZEILE1.
000610 HINZUF.
000620     COPY ACHINZ.
000630 MAIN1.
000640     PERFORM DRUCKEN.
000650     GO TO MAIN.
000660     SKIP2
000670* A B S C H L U S S
000680* -----------------
000690 ENDE.
000700     CLOSE D-ASTKOR, D-ASTSUM, D-ASTPRINT.
000710     STOP RUN.
000720     EJECT
000730* A U F G E R U F E N E  S E C T I O N S
000740* --------------------------------------
000750     SKIP2
000760 LESKOR SECTION.
000770     COPY ACKORRDV.
000780     SKIP2
000790* ABSTIMMSUMMEN-SATZ SCHREIBEN
000800 SCHRSUM SECTION.
000810     WRITE S-ASTSUM  INVALID KEY MOVE 3  TO ERR.
000820     SKIP2
000830 CARDTODISK SECTION.
000840* WERT U.BERICHTSZEIT AUS KARTE --> ASTSUM
000850     COPY ACCTD.
000860     SKIP2
000870 ZEROTODISK SECTION.
000880     COPY ACZTD.
000890 MOVELOG SECTION.
000900 MOVELOG-P.
000910     EXIT.
000920     SKIP2
000930     SKIP2
000940* EINGABEKARTEN MIT KOMMENTAR LISTEN
000950 DRUCKEN SECTION.
000960     COPY ACDRU.
000970*    UEBERSCHRIFT
000980 SCHR-UEB SECTION.
000990     COPY ACUEB.

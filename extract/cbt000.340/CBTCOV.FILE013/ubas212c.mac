000001* STAND 04/02/76
000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID.    RZ201
000030 AUTHOR.        LINCK FOD/O
000040 DATE-WRITTEN.  SEPTEMBER 1974.
000050 DATE-COMPILED. ABC.
000060 REMARKS.       ABSTIMMSUMMEN-DATEI KORR.+ERWEITERN.
000070     SKIP3
000080 ENVIRONMENT DIVISION.
000090 INPUT-OUTPUT SECTION.
000100 FILE-CONTROL.
000110     SELECT D-ASTKOR   ASSIGN UT-S-ASTKOR.
000120     SELECT D-ASTPRINT ASSIGN UT-S-ASTPRINT.
000130     SELECT D-ASTSUM   ASSIGN DA-I-ASTSUM
000140            RESERVE NO
000150                       ACCESS IS RANDOM
000160                       NOMINAL KEY IS ASUMNRZ
000170                       RECORD  KEY IS ASUMNR IN S-ASTSUM.
000180     SELECT D-ASTLOG   ASSIGN UT-S-ASTLOG.
000190     EJECT
000200 DATA DIVISION.
000210     SKIP2
000220 FILE SECTION.
000230     SKIP1
000240 FD  D-ASTKOR   BLOCK CONTAINS 0 RECORDS
000250                RECORD CONTAINS 80 CHARACTERS
000260                RECORDING MODE F
000270                LABEL RECORD STANDARD
000280                DATA RECORD S-ASTKOR.
000290 01  S-ASTKOR COPY ACKORDF.
000300     SKIP1
000310 FD  D-ASTPRINT BLOCK CONTAINS 0 RECORDS
000320                RECORD CONTAINS 120 CHARACTERS
000330                RECORDING MODE F
000340                LABEL RECORD STANDARD
000350                DATA RECORD S-ASTPRINT.
000360 01  S-ASTPRINT  PIC X(120).
000370     SKIP1
000380 FD  D-ASTSUM   BLOCK CONTAINS 1 RECORDS
000390                RECORD CONTAINS  92 CHARACTERS
000400                RECORDING MODE F
000410                LABEL RECORD STANDARD
000420                DATA RECORD S-ASTSUM.
000430 01  S-ASTSUM COPY ACSUMDF.
000440 FD  D-ASTLOG   BLOCK CONTAINS  0 RECORDS
000450                RECORD CONTAINS 48 CHARACTERS
000460                LABEL RECORD STANDARD
000470                RECORDING MODE F
000480                DATA RECORD S-ASTLOG.
000490 01  S-ASTLOG COPY ACLOGDF.
000500 WORKING-STORAGE SECTION.
000510 01  DATCOPY COPY ACDATDF.
000520 01  FELD-D.
000530     05  TAG                 PIC X(5).
000540     05  UHRG.
000550         10  UHR             PIC X(7).
000560         10  FILLER          PIC X.
000570         05  KE          PIC X  VALUE 'E'.
000580 01  DRUDEF COPY ACDRUDF.
000590     EJECT
000600 PROCEDURE DIVISION.
000610     SKIP1
000620 VORUEB.
000630     COPY ACVOR.
000640 VORSPANN.
000650     OPEN INPUT D-ASTKOR.
000660     CALL 'CENQAST' USING KE.
000670     OPEN I-O D-ASTSUM.
000680     OPEN OUTPUT D-ASTLOG.
000690     MOVE ALL '-' TO STRICH.
000700     MOVE 'RZ201 01' TO PGM.
000710     MOVE ' KORREKTURLISTE' TO UEBTXT.
000720     MOVE '(RZ L 201)' TO LNR.
000730     SKIP2
000740* H A U P T T E I L
000750* -----------------
000760 MAIN.
000770     PERFORM LESKOR.
000780     MOVE CORRESPONDING ASUMNRZ TO ASUMNR IN ZEILE1.
000790     IF ERR NOT = 0  GO TO MAIN1.
000800     IF  NEU-K   PERFORM HINZUF ELSE
000810     IF  REP-K   PERFORM KORR ELSE
000820     IF  DEL-K   PERFORM DELE ELSE
000830     IF  DLP-K   PERFORM DEL-PERIODE ELSE
000840     MOVE 7 TO ERR.
000850 MAIN1.
000860     PERFORM DRUCKEN.
000870     GO TO MAIN.
000880     SKIP2
000890* A B S C H L U S S
000900* -----------------
000910 ENDE.
000920     CLOSE D-ASTSUM.
000930     CLOSE D-ASTLOG.
000940     CALL 'CDEQAST'.
000950     CLOSE D-ASTKOR, D-ASTPRINT.
000960     STOP RUN.
000970     EJECT
000980* A U F G E R U F E N E  S E C T I O N S
000990* --------------------------------------
001000     SKIP2
001010 LESKOR SECTION.
001020     COPY ACKORRD.
001030     SKIP2
001040 HINZUF SECTION.
001050     COPY ACHINZ.
001060     SKIP3
001070 KORR SECTION.
001080     COPY ACKORR.
001090     SKIP3
001100 DELE SECTION.
001110     COPY ACDELE.
001120     SKIP3
001130 DEL-PERIODE SECTION.
001140     COPY ACDLP.
001150     SKIP3
001160 READSATZ SECTION.
001170     COPY ACSUMRD.
001180     SKIP2
001190 SCHRSUM SECTION.
001200     COPY ACSUMWT.
001210     SKIP3
001220 REWRITESATZ SECTION.
001230     COPY ACSUMRW.
001240     SKIP3
001250* LOGSATZ AUFBAUEN UND SCHREIBEN
001260 MOVELOG SECTION.
001270     MOVE CORRESPONDING S-ASTSUM TO S-ASTLOG.
001280     MOVE FLAG  IN S-ASTSUM (PIX) TO FLAG  IN LOGPER.
001290     MOVE BERZT IN S-ASTSUM (PIX) TO BERZT IN LOGPER.
001300     MOVE AWERT IN S-ASTSUM (PIX) TO AWERT IN LOGPER.
001310     SET I TO PIX.
001320     COMPUTE NPER IN S-ASTLOG = I - NPER IN S-ASTSUM.
001330     IF NEU-K MOVE NPER IN S-ASTSUM TO NPER IN S-ASTLOG.
001340     ACCEPT TAG   FROM DAY.
001350     ACCEPT UHR   FROM TIME.
001360     MOVE TAG   TO LOGDAT.
001370     MOVE UHR   TO LOGUHR.
001380     MOVE KTYP-ZWI TO KTYP IN S-ASTLOG.
001390 WRITELOG SECTION.
001400     WRITE S-ASTLOG.
001410     SKIP2
001420 CARDTODISK SECTION.
001430     COPY ACCTD.
001440     SKIP3
001450 ZEROTODISK SECTION.
001460     COPY ACZTD.
001470 RSHIFT SECTION.
001480     COPY ACRSHIFT.
001490     SKIP3
001500 DRUCKEN SECTION.
001510     COPY ACDRU.
001520     SKIP3
001530*  UEBERSCHRIFT
001540 SCHR-UEB SECTION.
001550     COPY ACUEB.

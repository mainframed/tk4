000100 ID DIVISION.
000200*************
000300     SKIP1
000400 PROGRAM-ID. SYE95501.
000500 AUTHOR. H.BUCHHOLZ   BWO.
000600 DATE-WRITTEN. 19. JUNI 1975.
000700     SKIP1
000800 REMARKS. AUS DEN DATEN VON SY.ACCTMOD ERSTELLT DIESES
000900          PROGRAMM EINE STATISTIK UEBER DIE TAEGLICHE
001000          VERWEILZEIT PRO USER AM TSO IN DER ZEIT VON
001100          7 BIS 17 UHR.
001200          DIE EINGABEDATEI WIRD SORTIERT NACH
001300              1. JOBSTARTDATUM
001400              2. USERID
001500              3. PROJEKTNUMMER
001600              4. JOBSTARTZEIT
001700          BEI DER AUSGABELISTE WIRD BEI JEDEM NEUEN TAG
001800          EIN BLATTWECHSEL VORGENOMMEN.
001900     SKIP3
002000 ENVIRONMENT DIVISION.
002100**********************
002200     SKIP1
002300 INPUT-OUTPUT SECTION.
002400     SKIP1
002500 FILE-CONTROL.
002600     SKIP1
002700     SELECT ACCTMOD   ASSIGN TO UT-S-EDATEI1.
002800     SELECT SORTDATEI ASSIGN TO UT-S-SDATEI1.
002900     SELECT LISTE     ASSIGN TO UT-S-ADATEI1.
003000     SKIP3
003100 DATA DIVISION.
003200***************
003300     SKIP1
003400 FILE SECTION.
003500     SKIP1
003600 FD  ACCTMOD RECORDING F LABEL RECORD STANDARD
003700     BLOCK 0 RECORDS DATA RECORD ACCSATZ.
003800 01  ACCSATZ.
003900     02 ACSA         PIC 99.
004000     02 ACSSZT       PIC S9(8)   COMP.
004100     02 ACSSDT       PIC S9(7)   COMP-3.
004200     02 FILLER       PIC X(4).
004300     02 ACJOB1-4     PIC X(4).
004400     02 FILLER       PIC X(4).
004500     02 ACJSZT       PIC S9(8)   COMP.
004600     02 ACJSDT       PIC S9(7)   COMP-3.
004700     02 FILLER       PIC X(9).
004800     02 ACSEZT       PIC S9(8)   COMP.
004900     02 ACSEDT       PIC S9(7)   COMP-3.
005000     02 FILLER       PIC X(15).
005100     02 ACSTEPN.
005200        03 ACSTEPN-2 PIC X(2).
005300        03 ACSTEPN-7 PIC X(5).
005400        03 ACSTEPN-8 PIC X.
005500     02 FILLER       PIC X(12).
005600     02 ACANR        PIC X(9).
005700     02 FILLER       PIC X(349).
005800     SKIP1
005900 SD  SORTDATEI RECORDING F DATA RECORD SORTSATZ.
006000 01  SORTSATZ.
006100     02 SORTFELD.
006200        03 JSDT      PIC S9(7)   COMP-3.
006300        03 USERID    PIC X(8).
006400        03 PRNR      PIC X(9).
006500        03 JSZT      PIC S9(8)   COMP.
006600     02 SSDT         PIC S9(7)   COMP-3.
006700     02 SSZT         PIC S9(8)   COMP.
006800     02 SEDT         PIC S9(7)   COMP-3.
006900     02 SEZT         PIC S9(8)   COMP.
007000     SKIP1
007100 FD  LISTE RECORDING F LABEL RECORD OMITTED
007200     BLOCK 0 RECORDS DATA RECORD ASATZ.
007300 01  ASATZ.
007400     02 VOR          PIC X.
007500     02 FILLER       PIC X(132).
007600     SKIP2
007700 WORKING-STORAGE SECTION.
007800*************************
007900     SKIP1
008000 77  ZZL             PIC 99          VALUE ZEROS.
008100 77  BLZL            PIC 999         VALUE ZEROS.
008200 77  SZAEHL          PIC 9(6)        VALUE ZEROS.
008300 77  AZAEHL          PIC 9(6)        VALUE ZEROS.
008400 77  IND1            PIC 99          VALUE ZEROS.
008500 77  IND3            PIC 99          VALUE ZEROS.
008600 77  IND2            PIC 99          VALUE ZEROS.
008700 77  RECHF1          PIC S9(8) COMP  VALUE ZEROS.
008800 77  RECHF2          PIC S9(8) COMP  VALUE ZEROS.
008900 77  RECHF3          PIC S9(8) COMP  VALUE ZEROS.
009000 77  IND4            PIC 99          VALUE 1.
009100 77  LZUSERID        PIC 9(8)  COMP  VALUE ZEROS.
009200 77  LZPROJNR        PIC 9(8)  COMP  VALUE ZEROS.
009300 77  SCHALTER1       PIC 9           VALUE ZERO.
009400 77  ZAEHLER         PIC 99          VALUE ZEROS.
009500     SKIP1
009600 01  DRUZEILE1.
009700     02 TEIL1.
009800        03 VOR1      PIC X           VALUE ' '.
009900        03 FILLER    PIC X           VALUE SPACES.
010000        03 DATUM.
010002           04 LTAG   PIC Z9.
010004           04 P1     PIC X.
010006           04 LMON   PIC 99.
010008           04 P2     PIC X.
010010           04 LJAR   PIC 99.
010100        03 FILLER    PIC X(6)        VALUE SPACES.
010200        03 USERID3   PIC X(7)        VALUE SPACES.
010300        03 FILLER    PIC X(12)       VALUE SPACES.
010400        03 PROJNR    PIC X(9)        VALUE SPACES.
010500        03 FILLER    PIC X(11)       VALUE SPACES.
010600     02 LOGONZT.
010610        03 LH        PIC Z9.
010620        03 FILLER    PIC X       VALUE '.'.
010630        03 LM        PIC 99.
010640        03 FILLER    PIC X       VALUE '.'.
010650        03 LS        PIC 99.
010660     02 FILLER       PIC X       VALUE SPACE.
010700     02 TEIL2.
010800        03 STERN     PIC X.
010900        03 FILLER    PIC X(5)        VALUE SPACES.
011000        03 VERTEIL   PIC X(61).
011100        03 FILLER    PIC XX          VALUE SPACES.
011200     SKIP1
011300 01  ZEILE1.
011400     02 FILLER       PIC X       VALUE '1'.
011500     02 FILLER       PIC X(19)   VALUE 'BOSCH-EDA3  JOB-NR '.
011600     02 JOBNR        PIC X(10).
011700     02 FILLER       PIC X(8)    VALUE 'LIST-NR '.
011800     02 PROGNR       PIC X(8).
011900     02 FILLER       PIC X       VALUE '/'.
012000     02 LISTNR       PIC 99.
012100     02 FILLER       PIC X(51)   VALUE ' STATISTIK DER TAEGLICHEN
012200-       'VERWEILZEIT AM TSO MONAT '.
012300     02 MONAT        PIC X(3).
012400     02 FILLER       PIC X       VALUE SPACES.
012500     02 JAHR         PIC 99.
012600     02 FILLER       PIC X(7)     VALUE ' DATUM '.
012700     02 EDATUM.
012800        03 ETAG      PIC Z9.
012900        03 FILLER    PIC X       VALUE '.'.
013000        03 EMON      PIC 99.
013100        03 FILLER    PIC X       VALUE '.'.
013200        03 EJAR      PIC 99.
013300     02 FILLER       PIC X(9)    VALUE '   BLATT '.
013400     02 BLNR         PIC ZZ9.
013500     SKIP1
013600 01  ZEILE2.
013700     02 FILLER       PIC X           VALUE '0'.
013800     02 FILLER       PIC X(7)        VALUE '  DATUM'.
013900     02 FILLER       PIC X(8)        VALUE SPACES.
014000     02 FILLER       PIC X(6)        VALUE 'USERID'.
014100     02 FILLER       PIC X(12)       VALUE SPACES.
014200     02 FILLER       PIC X(11)       VALUE 'PROJEKT-NR/'.
014300     02 FILLER       PIC X(9)        VALUE SPACES.
014400     02 FILLER       PIC X(10)       VALUE 'LOGON-ZEIT'.
014500     02 FILLER       PIC X(10)       VALUE SPACES.
014600     02 FILLER       PIC X(59)   VALUE 'VERBRACHTE ZEIT AM T S O I
014700-    'N DER ZEIT VON 7 BIS 17 UHR      '.
014800     SKIP1
014900 01  ZEILE3.
015000     02 FILLER       PIC X           VALUE ' '.
015100     02 FILLER       PIC X(33)       VALUE SPACES.
015200     02 FILLER       PIC X(11)       VALUE 'AUFTRAGS-NR'.
015300     02 FILLER       PIC X(11)       VALUE SPACES.
015400     02 FILLER       PIC X(5)        VALUE '(STD)'.
015500     02 FILLER       PIC X(72)       VALUE SPACES.
015600     SKIP1
015700 01  ZEILE4.
015800     02 FILLER       PIC X           VALUE ' '.
015900     02 FILLER       PIC X(69)       VALUE SPACES.
016000     02 FILLER       PIC X(63)       VALUE '7     8     9     10
016100-             '  11    12    13    14    15    16    17 '.
016200     SKIP1
016300 01  ZEILE5.
016400     02 FILLER       PIC X           VALUE ' '.
016500     02 FILLER       PIC X(69)       VALUE SPACES.
016600     02 FILLER       PIC X(63)       VALUE '/...../...../...../...
016700-             '../...../...../...../...../...../...../  '.
016800     SKIP1
016900 01  ZEILE6.
017000     02 FILLER       PIC X           VALUE ' '.
017100     02 FILLER       PIC X(69)       VALUE SPACES.
017200     02 DRUFELD      PIC X(63).
017300     SKIP1
017400 01  VEKTOR2         PIC X(63)       VALUE '×     ×     ×     ×
017500-             '  ×     ×     ×     ×     ×     ×     ×  '.
017600     SKIP1
017700 01  VEKTOR.
017800     02 FILLER       PIC X(61)       VALUE SPACES.
017900 01  FILLER REDEFINES VEKTOR.
018000     02 ELVEKTOR     PIC X       OCCURS 61 TIMES.
018100     SKIP1
018200 01  DISPDATUM.
018300     02 DISP-MM      PIC 99.
018400     02 FILLER       PIC X.
018500     02 DISP-TT      PIC 99.
018600     02 FILLER       PIC X.
018700     02 DISP-JJ      PIC 99.
018800     SKIP1
018900 01  MONATSTABELLE.
019000     02 FILLER      PIC X(9) VALUE 'JANFEBMRZ'.
019100     02 FILLER      PIC X(9) VALUE 'APRMAIJUN'.
019200     02 FILLER      PIC X(9) VALUE 'JULAUGSEP'.
019300     02 FILLER      PIC X(9) VALUE 'OKTNOVDEZ'.
019400 01  FILLER REDEFINES MONATSTABELLE.
019500     02 MON          PIC X(3)    OCCURS 12 TIMES.
019600     SKIP1
019700 01  UMRECHENFELDER.
019800     02 X-100        PIC S9(8)   COMP    VALUE +0.
019900     02 UHRZEIT      PIC 9(6)            VALUE ZEROS.
020000     02 FILLER REDEFINES UHRZEIT.
020100        03 UHR-H     PIC 99.
020200        03 UHR-M     PIC 99.
020300        03 FILLER REDEFINES UHR-M.
020400           04 UHR-M1 PIC 9.
020500           04 UHR-M2 PIC 9.
020600        03 UHR-S     PIC 99.
020700     02 UHR-H-M REDEFINES UHRZEIT    PIC 9(4).
020800     02 MASCHDAT     PIC 9(8)  SYNC  VALUE ZEROS.
020900     02 FILLER REDEFINES MASCHDAT.
021000        03 FILLER    PIC 999.
021100        03 MAJAR     PIC 99.
021200        03 MATAG     PIC 999.
021300     02 MONATSTAGE   PIC X(24) VALUE '312831303130313130313031'.
021400     02 FILLER REDEFINES MONATSTAGE.
021500        03 MTAG      PIC 99      OCCURS 12 TIMES.
021600     02 TAGESDATUM   PIC 9(6)    SYNC  VALUE ZEROS.
021700     02 FILLER REDEFINES TAGESDATUM.
021800        03 TAGTAG    PIC 99.
021900        03 TAGMON    PIC 99.
022000        03 TAGJAR    PIC 99.
022100     02 M-IND        PIC S9(4) SYNC  COMP  VALUE +0.
022200     SKIP1
022300 01  DISPL-AUS       PIC X(70).
022400 01  DISPLAY-FELDER.
022500     02 SATZTAB.
022600        03 DISPLAYSATZ OCCURS 5 TIMES.
022700           04 DISPL-FELD     PIC X(60).
022800           04 DISPL-ZAEHL    PIC ZZZBZZ9.
022900     02 DISPDAT.
023000        03 FILLER            PIC X(13)  VALUE SPACES.
023100        03 FILLER   PIC X(22) VALUE '   ERSTELLUNGSDATUM   '.
023200        03 DISPDAT1.
023300           04 DISPTT         PIC Z9.
023400           04 FILLER         PIC X      VALUE '.'.
023500           04 DISPMM         PIC Z9.
023600           04 FILLER         PIC X      VALUE '.'.
023700           04 DISPJJ         PIC 99.
023800     SKIP1
023900 01  DISP-LIT1       PIC X(60) VALUE ' *****  ABBRUCH  ABBRUCH  AB
024000-                              'BRUCH  ABBRUCH  ABBRUCH  *****  '.
024100 01  DISP-LIT2       PIC X(60) VALUE ' ********************  PROGR
024200-                              'AMMENDE  *********************  '.
024300 01  DISP-LIT3       PIC X(60) VALUE ' ******************  ENDE -
024400-                              'PROTOKOLL  *******************  '.
024500     SKIP1
024600 01  DATUMTAGES      PIC 9(6)  SYNC  VALUE ZEROS.
024700 01  FILLER REDEFINES DATUMTAGES.
024800     02 DATJAR       PIC 99.
024900     02 DATMON       PIC 99.
025000     02 DATTAG       PIC 99.
025100     SKIP1
025200 01  ACCGRW1.
025300     02 GRW1.
025400        03 JSDT1     PIC S9(7)   COMP-3.
025500        03 JSZT1     PIC S9(8)   COMP.
025600        03 USERID1   PIC X(8).
025700     02 PRNR1        PIC X(9).
025800     02 SEDT1        PIC S9(7)   COMP-3.
025900     02 SEZT1        PIC S9(8)   COMP.
026000     SKIP1
026100 01  ACCGRW2.
026200     02 GRW2.
026300        03 JSDT2     PIC S9(7)   COMP-3.
026400        03 JSZT2     PIC S9(8)   COMP.
026500        03 USERID2   PIC X(8).
026600     02 PRNR2        PIC X(9).
026700     02 SEDT2        PIC S9(7)   COMP-3.
026800     02 SEZT2        PIC S9(8)   COMP.
026900     SKIP1
027000 01  DISP-JOB        PIC X(8)    VALUE SPACES.
027100 01  DISP-STEP       PIC X(8)    VALUE SPACES.
027200 01  DISP-PROG       PIC X(8)    VALUE SPACES.
027300     SKIP3
027400 PROCEDURE DIVISION.
027500********************
027600     SKIP1
027700     MOVE ALL '-' TO VEKTOR.
027800     MOVE VEKTOR2 TO DRUFELD.
027900     SKIP1
028000     CALL 'JOBPROG' USING DISP-JOB, DISP-STEP, DISP-PROG.
028100     MOVE DISP-JOB TO JOBNR.
028200     MOVE DISP-PROG TO PROGNR.
028300     MOVE '01' TO LISTNR.
028400     SKIP1
028500*****    EROEFFNEN DER DATEIEN     *****
028600     SKIP1
028700     OPEN INPUT  ACCTMOD.
028800     OPEN OUTPUT LISTE.
028900     SKIP1
029000*****    ERSTELLUNGSDATUM UND ERSTELLUNGSMONAT    *****
029100     SKIP1
029200     MOVE CURRENT-DATE TO DISPDATUM.
029300     MOVE DISP-TT TO ETAG DISPTT.
029400     MOVE DISP-MM TO EMON DISPMM.
029500     MOVE DISP-JJ TO EJAR DISPJJ.
029600     IF DISP-MM < 02 SUBTRACT 1 FROM DISP-JJ.
029700     MOVE DISP-JJ TO JAHR.
029800     IF DISP-MM < 02 MOVE 12 TO IND1 ELSE
029900     COMPUTE IND1 = DISP-MM - 1.
030000     MOVE MON (IND1) TO MONAT.
030100     SKIP1
030200*****   SORTIEREN VON ACCTMOD NACH DATUM, USERID UND PROJEKTNR.
030300     SKIP1
030400     SORT SORTDATEI ASCENDING SORTFELD
030500         INPUT PROCEDURE EXIT-15
030600           OUTPUT PROCEDURE EXIT-35.
030700     SKIP1
030800     IF SORT-RETURN = ZEROS
030900        GO TO E1.
031000     GO TO E2.
031100     SKIP1
031200*****    ERSTELLEN DES ENDE-PROTOKOLLS   ****
031300     SKIP1
031400 E1.
031500     MOVE 'SAETZE VON SY.ACCTMOD' TO DISPL-FELD (1).
031600     MOVE ' DAVON VERWENDET     ' TO DISPL-FELD (2).
031700     MOVE AZAEHL TO DISPL-ZAEHL (1).
031800     MOVE SZAEHL TO DISPL-ZAEHL (2).
031900     MOVE SPACES TO DISPL-AUS.           PERFORM E12.
032000     MOVE DISP-LIT3 TO DISPL-AUS.        PERFORM E12.
032100     MOVE SPACES TO DISPL-AUS.           PERFORM E12.
032200     MOVE DISPDAT TO DISPL-AUS.          PERFORM E12.
032300     MOVE SPACES TO DISPL-AUS.           PERFORM E12.
032400     MOVE DISPLAYSATZ (1) TO DISPL-AUS.  PERFORM E12.
032500     MOVE DISPLAYSATZ (2) TO DISPL-AUS.  PERFORM E12.
032600     MOVE SPACES TO DISPL-AUS.           PERFORM E12.
032700     MOVE DISP-LIT2 TO DISPL-AUS.        PERFORM E12.
032800     GO TO E13.
032900 E12.
033000     CALL 'DISPLAY' USING DISPL-AUS.
033100 E13.
033200     CLOSE ACCTMOD.
033300     CLOSE LISTE.
033400     STOP RUN.
033500     SKIP1
033600******     ABBRUCH, DA SORT-RETURN UNGLEICH ZERO    *****
033700     SKIP1
033800 E2.
033900     CALL 'DISPLAY' USING DISP-LIT1.
034000 E3.
034100     PERFORM E2 5 TIMES.
034200     GO TO E13.
034300     SKIP1
034400*****    SORTEINGABE  ERSTELLEN DER SORTDATEI    *****
034500     SKIP1
034600 EXIT-15 SECTION.
034700*****************
034800     SKIP1
034900 LESEN1.
035000     READ ACCTMOD AT END GO TO ENDE-15.
035100     ADD 1 TO AZAEHL.
035200     IF ACSA NOT = '04' GO TO LESEN1.
035300     IF ACSTEPN-2 NOT = 'DI' GO TO LESEN1.
035400     IF ACSTEPN-8 NOT = SPACE GO TO LESEN1.
035500     MOVE ACJSZT TO JSZT.
035600     MOVE ACJSDT TO JSDT.
035700     IF ACANR = ZEROS MOVE ACJOB1-4 TO PRNR
035800        ELSE MOVE ACANR TO PRNR.
035900     MOVE ACSSZT TO SSZT.
036000     MOVE ACSSDT TO SSDT.
036100     MOVE ACSEZT TO SEZT.
036200     MOVE ACSEDT TO SEDT.
036300     MOVE ACSTEPN TO USERID.
036400     RELEASE SORTSATZ.
036500     GO TO LESEN1.
036600 ENDE-15.
036700     EXIT.
036800     SKIP1
036900 EXIT-35 SECTION.
037000*****************
037100     SKIP1
037200*****    LISTENKOPF     *****
037300     SKIP1
037400 KOPF.
037500     ADD 1 TO BLZL. MOVE BLZL TO BLNR.
037600     WRITE ASATZ FROM ZEILE1 AFTER POSITIONING VOR.
037700     WRITE ASATZ FROM ZEILE2 AFTER POSITIONING VOR.
037800     WRITE ASATZ FROM ZEILE3 AFTER POSITIONING VOR.
037900     WRITE ASATZ FROM ZEILE4 AFTER POSITIONING VOR.
038000     WRITE ASATZ FROM ZEILE5 AFTER POSITIONING VOR.
038100     MOVE 6 TO ZZL.
038200     SKIP1
038300******    SORTAUSGABE    *****
038400     SKIP1
038500 LESEN2.
038600     RETURN SORTDATEI AT END GO TO ENDE-35.
038700     ADD 1 TO SZAEHL.
038800     GO TO A4.
038900     SKIP1
039000*****    UMRECHNUNG DES DATUMS UND DER UHRZEIT   ****
039100     SKIP1
039200 A1. COPY SYMASDAT.
039300 A2. COPY SYUHRZET.
039400     SKIP1
039500 A4.
039600     IF SZAEHL NOT = 1 GO TO A41.
039700     PERFORM A42.
039800     GO TO LESEN2.
039900 A41.
040000     MOVE ACCGRW1 TO ACCGRW2.
040100 A42.
040200     MOVE JSDT TO JSDT1.
040300     MOVE JSZT TO JSZT1.
040400     MOVE PRNR TO PRNR1.
040500     MOVE USERID TO USERID1.
040600     MOVE SEDT TO SEDT1.
040700     MOVE SEZT TO SEZT1.
040800     SKIP1
040900*****    GRUPPENWECHSEL   ******
041000     SKIP1
041100 A43.
041200     IF GRW1 = GRW2 GO TO LESEN2.
041300     SKIP1
041400     IF JSDT1 = JSDT2 AND USERID1 = USERID2
041500        AND PRNR1 = PRNR2
041600        PERFORM B THRU B4
041700        GO TO LESEN2.
041800     SKIP1
041900     IF JSDT1 = JSDT2 AND USERID1 = USERID2
042000        PERFORM B THRU B4
042100        MOVE 1 TO SCHALTER1
042200        GO TO C.
042300     SKIP1
042400     IF JSDT1 = JSDT2
042500        PERFORM B THRU B4
042600        GO TO D.
042700     SKIP1
042800     PERFORM B THRU B4.
042900     GO TO E.
043000     SKIP1
043100*****    ENDE DER GRUPPENWECHSEL   *****
043200     SKIP2
043300*****    AUFFUELLEN DES VEKTORS    *****
043400     SKIP2
043500 B.
043600     IF SEDT2 > JSDT2 ADD 8640000 TO SEZT2.
043700     COMPUTE RECHF1 = SEZT2 - JSZT2.
043800     ADD RECHF1 TO LZPROJNR.
043900     SKIP1
044000*****    LOGON NACH 18 UHR    *****
044100     SKIP1
044200 B1.
044300     IF JSZT2 > 6120000 MOVE '*' TO ELVEKTOR (61)
044400     GO TO B4.
044500     SKIP1
044600*****    LOGON UND LOGOFF VOR 7 UHR    ****
044700     SKIP1
044800 B2.
044900     IF JSDT2 = SEDT2 AND
045000        JSZT2 < 2520000 AND
045100        SEZT2 < 2520000
045200     MOVE '*' TO ELVEKTOR (1) GO TO B4.
045300     SKIP1
045400*****    LOGON NACH 7 UHR    *****
045500     SKIP1
045600     IF JSZT2 < 2520000 GO TO B3.
045700     MOVE RECHF1 TO X-100.
045800     PERFORM SEC-100-UHRZEIT.
045900 B21.
046000     MOVE UHR-M1 TO IND1.
046100     IF UHR-M2 > 4 ADD 1 TO IND1.
046200     IF UHR-H = ZEROS AND UHR-M1 = ZERO AND UHR-M2 < 5
046300     MOVE 1 TO IND1.
046400     COMPUTE IND1 = IND1 + UHR-H * 6 + 1.
046500 B22.
046600     COMPUTE RECHF1 = JSZT2 - 2520000.
046700     MOVE IND1 TO IND2.
046800     MOVE RECHF1 TO X-100.
046900     PERFORM SEC-100-UHRZEIT.
047000     PERFORM B21.
047100     PERFORM B23 IND2 TIMES.
047200     GO TO B4.
047300 B23.
047400     MOVE '*' TO ELVEKTOR (IND1).
047500     IF IND1 > 60 GO TO B4.
047600     ADD 1 TO IND1.
047700     SKIP1
047800*****LOGON VOR 7 UHR, LOGOFF NACH 7 UHR    *****
047900     SKIP1
048000 B3.
048100     COMPUTE RECHF2 = 2520000 - JSZT2.
048200     COMPUTE RECHF3 = RECHF1 - RECHF2.
048300     MOVE RECHF3 TO X-100.
048400     PERFORM SEC-100-UHRZEIT.
048500     PERFORM B21.
048600     MOVE IND1 TO IND2.
048700     MOVE 1 TO IND1
048800     PERFORM B23 IND2 TIMES.
048900     SKIP1
049000 B4.
049100     EXIT.
049200     SKIP2
049300*****    NEUE SESSION:   GLEICHES DATUM, GLEICHE USERID       ****
049400*****                    PROJEKTNUMMER HAT SICH GEAENDERT     ****
049500     SKIP2
049600 C.
049700     IF USERID2 = USERID3 MOVE SPACES TO USERID3 DATUM
049800     GO TO C1 ELSE NEXT SENTENCE.
049900     MOVE USERID2 TO USERID3.
050000     MOVE JSDT2 TO MASCHDAT.
050100     PERFORM MASCH-TAG-DATUM THRU MASCH-AUS.
050200     MOVE TAGTAG TO LTAG.
050210     MOVE TAGMON TO LMON.
050220     MOVE TAGJAR TO LJAR.
050230     MOVE '.' TO P1 P2.
050300     MOVE PRNR2 TO PROJNR.
050400 C1.
050500     IF SCHALTER1 = ZERO GO TO D1.
050600     ADD LZPROJNR TO LZUSERID.
050700     MOVE LZPROJNR TO X-100.
050800     PERFORM SEC-100-UHRZEIT.
050900     MOVE UHR-H TO LH.
050910     MOVE UHR-M TO LM.
050920     MOVE UHR-S TO LS.
051000     MOVE ZEROES TO LZPROJNR.
051100     MOVE PRNR2 TO PROJNR.
051200     IF ZZL > 64 PERFORM KOPF.
051300     ADD 1 TO ZZL.
051400     MOVE SPACES TO STERN. MOVE VEKTOR2 TO VERTEIL.
051500     WRITE ASATZ FROM DRUZEILE1 AFTER POSITIONING VOR1.
051600     MOVE 1 TO SCHALTER1.
051700     MOVE USERID2 TO USERID3.
051710     MOVE TAGTAG TO LTAG.
051720     MOVE TAGMON TO LMON.
051730     MOVE TAGJAR TO LJAR.
051740     MOVE '.' TO P1 P2.
051800 C2.
051900     GO TO LESEN2.
052000     SKIP2
052100*****    EINGELESENER SATZ HAT GLEICHES DATUM UND NEUE USERID   **
052200     SKIP2
052300 D.
052400     IF SCHALTER1 = 0 MOVE LZPROJNR TO LZUSERID
052500     MOVE ZEROES TO LZPROJNR PERFORM C
052600     ELSE PERFORM C THRU C1.
052700 D1.
052800     MOVE LZUSERID TO X-100.
052900     PERFORM SEC-100-UHRZEIT.
053000     MOVE UHR-H TO LH.
053010     MOVE UHR-M TO LM.
053020     MOVE UHR-S TO LS.
053100     MOVE ZEROES TO LZUSERID.
053200     MOVE 1 TO ZAEHLER.
053300 D2.
053400     IF ELVEKTOR (ZAEHLER) = '-' MOVE '×' TO ELVEKTOR (ZAEHLER).
053500     IF ZAEHLER < 61 ADD 6 TO ZAEHLER GO TO D2.
053600     MOVE VEKTOR TO VERTEIL.
053700     MOVE ALL '-' TO VEKTOR.
053800     IF SCHALTER1 = 1 MOVE SPACES TO TEIL1 MOVE '*' TO STERN.
053900     IF ZZL > 64 PERFORM KOPF.
054000     WRITE ASATZ FROM DRUZEILE1 AFTER POSITIONING VOR1.
054100     WRITE ASATZ FROM ZEILE6 AFTER POSITIONING VOR.
054200     MOVE SPACES TO STERN.
054300     ADD 2 TO ZZL.
054400     MOVE ZERO TO SCHALTER1.
054500 D3.
054600     GO TO LESEN2.
054700     SKIP2
054800*****    EINGELESENER SATZ HAT NEUES DATUM     *****
054900     SKIP2
055000 E.
055100     PERFORM D THRU D2.
055200 E1.
055300     PERFORM KOPF.
055400     GO TO LESEN2.
055500     SKIP2
055600*****    ENDE    *****
055700     SKIP2
055800 ENDE-35.
055900     MOVE ACCGRW1 TO ACCGRW2.
056000     PERFORM B THRU B4.
056100     PERFORM D THRU D2.
056200 SCHLUSS.
056300     EXIT.

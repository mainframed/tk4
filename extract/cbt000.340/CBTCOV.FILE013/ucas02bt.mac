PROC 0
CSP1: -
     ISPEXEC DISPLAY PANEL(CSP1)
     IF &LASTCC = 8  THEN GOTO P999               /* PF3/PF15-TASTE  */
     IF &CAT    = 1  ×  -
        &CAT    = 3  THEN SET &MCAT = 13B         /* 3032            */
     IF &CAT    = 2  ×  -
        &CAT    = 4  THEN SET &MCAT = 13A         /*  158            */
     IF &CAT    < 3  THEN GOTO P100
     GOTO P200
P100: -
     IF &VOL    > A  THEN GOTO P110
     SET &OUT   = &STR(BITTE VOL SER EINGEBEN)
     GOTO CSP1
P110: -
CONTROL MSG
     DEF NVSAM (NAME('&DSN') DEVT(3350) VOL(&VOL) OWNER(&SYSUID) ) -
     CAT('SYS1.MCAT&MCAT')
     SET &OUT   = &STR(FUNKTION  &CAT  MIT CC &LASTCC BEENDET)
CONTROL MSG
     GOTO CSP1
P200: -
     IF &VOL    =    THEN GOTO P210
     SET &OUT   = &STR(VOL SER MUSS BLANK SEIN)
     GOTO CSP1
P210: -
CONTROL NOMSG
     DEL ('&DSN') NVSAM NSCR CAT('SYS1.MCAT&MCAT')
     SET &OUT   = &STR(FUNKTION  &CAT  MIT CC &LASTCC BEENDET)
CONTROL MSG
     GOTO CSP1
P999: -
END

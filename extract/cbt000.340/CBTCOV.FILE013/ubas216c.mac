000010* STAND 05/20/81
000020 IDENTIFICATION DIVISION.
000030 PROGRAM-ID.    OPV21
000040 AUTHOR.        LINCK FOD/O
000050 DATE-WRITTEN.  SEPTEMBER 1974.
000060 DATE-COMPILED. ABC.
000070 REMARKS.       ABSTIMMSUMMEN-DATEI KORR.+ERWEITERN.
000080     SKIP3
000090 ENVIRONMENT DIVISION.
000100 INPUT-OUTPUT SECTION.
000110 FILE-CONTROL.
000120     SELECT D-ASTKOR   ASSIGN UT-S-ASTKOR.
000130     SELECT D-ASTPRINT ASSIGN UT-S-ASTPRINT.
000140     SELECT D-ASTSUM   ASSIGN DA-ASTSUM
000150                       ACCESS IS RANDOM
000160                       ORGANIZATION IS INDEXED
000170                       FILE STATUS IS STAT
000180                       RECORD  KEY IS ASUMNR IN S-ASTSUM.
000190     SELECT D-ASTLOG   ASSIGN UT-S-ASTLOG.
000200     EJECT
000210 DATA DIVISION.
000220     SKIP2
000230 FILE SECTION.
000240     SKIP1
000250 FD  D-ASTKOR   BLOCK CONTAINS 0 RECORDS
000260                RECORD CONTAINS 80 CHARACTERS
000270                RECORDING MODE F
000280                LABEL RECORD STANDARD
000290                DATA RECORD S-ASTKOR.
000300 COPY ACKORDF.
000310     SKIP1
000320 FD  D-ASTPRINT BLOCK CONTAINS 0 RECORDS
000330                RECORD CONTAINS 120 CHARACTERS
000340                RECORDING MODE F
000350                LABEL RECORD STANDARD
000360                DATA RECORD S-ASTPRINT.
000370 01  S-ASTPRINT  PIC X(120).
000380     SKIP1
000390 FD  D-ASTSUM   BLOCK CONTAINS 1 RECORDS
000400                LABEL RECORD STANDARD
000410                DATA RECORD S-ASTSUM.
000420     COPY ACSUMDFV.
000430 FD  D-ASTLOG   BLOCK CONTAINS  0 RECORDS
000440                RECORD CONTAINS 48 CHARACTERS
000450                LABEL RECORD STANDARD
000460                RECORDING MODE F
000470                DATA RECORD S-ASTLOG.
000480     COPY ACLOGDF.
000490 WORKING-STORAGE SECTION.
000500 01  FELD-D.
000510     05  TAG                 PIC X(5).
000520     05  UHRG.
000530         10  UHR             PIC X(7).
000540         10  FILLER          PIC X.
000550         05  KE          PIC X  VALUE 'E'.
000560     COPY ACDATDF.
000570     COPY ACDRUDF.
000580 PROCEDURE DIVISION.
000590     SKIP1
000600 VORUEB.
000610     COPY ACVOR.
000620 VORSPANN.
000630     OPEN INPUT D-ASTKOR.
000640     CALL 'CENQAST' USING KE.
000650     OPEN I-O D-ASTSUM.
000660     OPEN OUTPUT D-ASTLOG.
000670     MOVE ALL '-' TO STRICH.
000680     MOVE 'OP021 01' TO PGM.
000690     MOVE ' KORREKTURLISTE' TO UEBTXT.
000700     SKIP2
000710* H A U P T T E I L
000720* -----------------
000730 MAIN.
000740     PERFORM LESKOR.
000750     MOVE CORRESPONDING ASUMNRZ TO ASUMNR IN ZEILE1.
000760     IF ERR NOT = 0  GO TO MAIN1.
000770     IF  NEU-K   PERFORM HINZUF ELSE
000780     IF  REP-K   PERFORM KORR ELSE
000790     IF  DEL-K   PERFORM DELE ELSE
000800     IF  PER-K   PERFORM CHANGE-PERIODE ELSE
000810     IF  DLP-K   PERFORM DEL-PERIODE ELSE
000820     IF  INS-K   PERFORM EINSCHIEBEN ELSE
000830     MOVE 7 TO ERR.
000840 MAIN1.
000850     PERFORM DRUCKEN.
000860     GO TO MAIN.
000870     SKIP2
000880* A B S C H L U S S
000890* -----------------
000900 ENDE.
000910     CLOSE D-ASTSUM.
000920     CLOSE D-ASTLOG.
000930     CALL 'CDEQAST'.
000940     IF REORG WRITE S-ASTPRINT FROM ENDZEILE1.
000950     CLOSE D-ASTKOR, D-ASTPRINT.
000960     STOP RUN.
000970     EJECT
000980* A U F G E R U F E N E  S E C T I O N S
000990* --------------------------------------
001000     SKIP2
001010 LESKOR SECTION.
001020     COPY ACKORRDV.
001030     SKIP2
001040 HINZUF SECTION.
001050     COPY ACHINZ.
001060     SKIP3
001070 KORR SECTION.
001080     COPY ACKORR.
001090     SKIP3
001100 DELE SECTION.
001110     COPY ACDELEV.
001120     SKIP3
001130 DEL-PERIODE SECTION.
001140     COPY ACDLP.
001150     SKIP3
001160 READSATZ SECTION.
001170     COPY ACSUMRD.
001180     SKIP2
001190 SCHRSUM SECTION.
001200     COPY ACSUMWT.
001210     SKIP3
001220 REWRITESATZ SECTION.
001230     COPY ACSUMRW.
001240     SKIP3
001250* LOGSATZ AUFBAUEN UND SCHREIBEN
001260 MOVELOG SECTION.
001270     MOVE CORRESPONDING S-ASTSUM TO S-ASTLOG.
001280     MOVE FLAG  IN S-ASTSUM (PIX) TO FLAG  IN LOGPER.
001290     MOVE BERZT IN S-ASTSUM (PIX) TO BERZT IN LOGPER.
001300     MOVE AWERT IN S-ASTSUM (PIX) TO AWERT IN LOGPER.
001310     IF FLAG IN LOGPER = INIT
001320         MOVE SPACES TO NWERT IN S-ASTLOG.
001330     SET I TO PIX.
001340     COMPUTE NPER IN S-ASTLOG = I - NPER IN S-ASTSUM.
001350     IF NEU-K OR PER-K MOVE NPER IN S-ASTSUM TO NPER IN S-ASTLOG.
001360     ACCEPT TAG   FROM DAY.
001370     ACCEPT UHR   FROM TIME.
001380     MOVE TAG   TO LOGDAT.
001390     MOVE UHR   TO LOGUHR.
001400     MOVE KTYP-ZWI TO KTYP IN S-ASTLOG.
001410 WRITELOG SECTION.
001420     WRITE S-ASTLOG.
001430     SKIP2
001440 CARDTODISK SECTION.
001450     COPY ACCTD.
001460     SKIP3
001470 ZEROTODISK SECTION.
001480     COPY ACZTD.
001490 RSHIFT SECTION.
001500     COPY ACRSHIFT.
001510     SKIP3
001520 DRUCKEN SECTION.
001530     COPY ACDRU.
001540     SKIP3
001550*  UEBERSCHRIFT
001560 SCHR-UEB SECTION.
001570     COPY ACUEB.
001580     SKIP3
001590 CHANGE-PERIODE SECTION.
001600 COPY ACCHGPER.
001610     SKIP3
001620 EINSCHIEBEN SECTION.
001630 COPY ACEIN.

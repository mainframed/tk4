*
*                          T A P E S C A N
*
* FUNCTION/OPERATION:
*        A) FOR STANDARD LABEL TAPES (SL)
*        TAPESCAN READS THE LABELS OF A 9-TRACK STANDARD LABEL MAGNETIC
*        TAPE UNTIL TWO CONSECUTIVE TAPEMARKS ARE FOUND BEHIND
*        A TRAILER LABEL. LABEL INFORMATION IS FORMATED AND LISTED,
*        ONE FILE PER LINE. ALL I/O IS DONE VIA EXCP, DATA-PART OF
*        FILES IS SKIPED ISSUING A FSF COMMAND.
*
*        B) FOR NL TAPES.
*        FOR NO-LABEL TAPES TAPESCAN COUNTS THE NUMBER OF FILES
*        UP TO TWO CONSECUTIVE TAPEMARKS.
*
*        COMMON:
*        TAPES ARE READ USING BLP. THE JFCB IS SWITCHED TO BLP SO
*        IN VS SYSTEMS TAPESCAN HAS TO BE LINKED WITH AC=1 INTO
*        AN AUTHORIZED LIBRARY.
*        THE JFCB IS ALSO USED TO CHECK VOLUME LABEL INFORMATION FOR
*        SL TAPES. IF THE VOLUME LABEL OF THE TAPE DOESN'T MATCH THE
*        LABEL INFORMATION OF THE JFCB (OBTAINED VIA THE TAPE-DD CARD)
*        THE OPERATOR IS ASKED TO REPLY TO MESSAGE 'TSC001'
*           'U' TO USE THE MOUNTED TAPE
*           'M' TO MOUNT ANOTHER TAPE
*           'C' TO CANCEL THE JOBSTEP
*        IN CASE OF THE REPLY 'M'  A MESSAGE IS ROUTED TO THE
*        TAPECONSOLE 'TSC011' (ROUTCODE 5,6) TO MOUNT A NEW TAPE'
*        MOST ERRORS LEAD TO AN ABEND USER1, WHICH IS ACCOMPANIED BY
*        AN INFORMATION ABOUT WHICH OPERATION FAILED.
*
*
* ENTRY POINTS:  TAPESCAN
*
*
* INPUT:  NONE
*
*
* OUTPUT:  NONE
*
*
* DD-STATEMENTS:  TAPE     DEFINES THE TAPE TO BE SCANNED, SHOULD
*                          CONTAIN ONLY 'UNIT=TAPE,VOL=SER=...'.
*
*                 SYSPRINT DEFINES THE OUTPUT DATA SET
*                          DCB=(RECFM=FBA,LRECL=121,BLKSIZE=3146)
*                          IS PROVIDED BY PROGRAM
*
* EXIT-NORMAL:  RETURN VIA REGISTERS 14
*
*
* EXIT-ERROR:  ABEND
*
*
* RETURN CODES:  NONE
*
* ABEND CODES:   1 = ALL ERRORS
*
*
* EXTERNAL ROUTINES:  NONE
*
*
* TABLES/WORK AREAS:  USES:
*        DCB, IOB, ECB, JFCB.
*
*
* ATTRIBUTES:  REUSABLE, NOT REENTERABLE; OUTPUT USES QSAM, INPUT USES
*        EXCP.
*
*
* RESTRICTIONS:  SHOULD BE LINKED WITH AC=1 IN VS SYSTEMS.
*
*
* RELATED PGMS:  TAPECOPY, TAPESKIM
*
*
* STORAGE:  TOTAL  < 40K
*
* STATUS:  CHANGE LEVEL 0.0, 03FEB71
*                       1.1, 15NOV74     H.KNOBLOCH
*                            COMPARE MOUNTED VOL-SER-# WITH
*                                   REQUIRED VOL-SER-# FOUND IN JFCB.
*                       1.2   12FEB76    B.SCHEID
*                            COUNTING FILES FOR NSL-TAPES
*                       1.3   27JUL76    BLASIUS/SCHEID
*                            READ LENGTH CHANGED TO AVOID ABEND
*                            WRITE TIME AND DATE
*                       1.4   25JAN77    SCHEID
*                            CORRECT CANCEL AND MOUNT PASSUS
*
* NOTES:  NONE
*
*
* AUTHOR:  VOLKER BLASIUS

./ ADD  NAME=UBOE01BC
000100 ID DIVISION.
000200 PROGRAM-ID. SY021.
000300 AUTHOR. GRUBER BOEHRINGER MANNHEIM.
000400 DATE-WRITTEN. JULI 1976.
000500 REMARKS. CICS-STATISTIK ANTWORTZEITVERHALTEN -----------
000600          DIE DATEI  DD STATEMENT SY0214I WIRD IM
000700          UNTERPROGRAMM 'XSY021' ERSTELLT
000800          ANTWORTZEITVERHALTEN IN STUNDEN-INTERVALLEN.
002005     --------------------------------------.
002010                 AENDERUNGEN ZUR ANPASSUNG AN
002015     CICS-PERFORMANCE-ANALYSER VERSION II
002020     UMDEFINITION DES EINGABEBEREICHS.
002025     ----------------------------------------------
002100 ENVIRONMENT DIVISION.
002200 CONFIGURATION SECTION.
002300 SPECIAL-NAMES.
002400     DECIMAL-POINT IS COMMA.
002500 INPUT-OUTPUT SECTION.
002600 FILE-CONTROL.
002700     SELECT E1-DATEI ASSIGN TO UT-S-SY0211I.
002800     SELECT A-DATEI ASSIGN TO UT-S-SY0212O.
002900     SELECT EINGABE ASSIGN TO UT-S-SY0214I.
003000     SELECT SORTDATEI ASSIGN TO UT-S-SY0213W.
003100         SKIP3
003200 DATA DIVISION.
003300 FILE SECTION.
003400         SKIP1
003500 FD  E1-DATEI, RECORDING F, RECORD 68, LABEL RECORD STANDARD,
003600     BLOCK 0 RECORDS, DATA RECORD E1-SATZ.
003700 01  E1-SATZ.
003800     03  E1-STAT      PIC XXX.
003900     03  REC1-ID       PIC X.
004000     03  E1-PROGNAME.
004100         05  E1-PROGNAME4.
004200             08  E1-PROGNAME2     PIC XX.
004300             08  FILLER           PIC XX.
004400         05  FILLER               PIC X(4).
004500     03  E1-TERMID    PIC X(4).
004600     03  FILLER       PIC X(4).
004700     03  FILLER       PIC X.
004800     03  E1-DATUM     PIC S9(5)  COMP-3.
004900     03  E1-ENDZEIT   PIC S9(9)  COMP.
005000     03  E1-CPUZEIT   PIC S9(9)  COMP.
005100     03  E1-WAITZEIT  PIC S9(9)  COMP.
005200     03  FILLER       PIC X(26).
005300     03  E1-EXCP      PIC S9(4)  COMP.
005400     03  FILLER       PIC X(4).
005500         SKIP1
005600 FD  A-DATEI, RECORDING F, RECORD 133, LABEL RECORD STANDARD,
005700     BLOCK 0 RECORDS, DATA RECORD ZEILE.
005800 01  ZEILE.
005900     03 ZVOR         PIC X.
006000     03 FILLER       PIC X(132).
006100         SKIP2
006200 FD  EINGABE RECORDING F RECORD 800 LABEL RECORD STANDARD
006300             BLOCK 0 RECORDS DATA RECORD EING-SATZ.
006400 01  EING-SATZ.
006500     02 E2-SATZART   PIC X(4).
006600     02 E2-DATUM.
006700       03 E2-JJ      PIC 99.
006800       03 E2-MM      PIC 99.
006900       03 E2-TT      PIC 99.
007000     02 E2-HH-SEK    OCCURS    11.
007100       03 E2-HH      PIC 99.
007200       03 E2-PROZ-SEK  OCCURS   7.
007300          04 E2-PROZ PIC 99.
007400          04 E2-SEK  PIC 9(4)V99.
007500     02 FILLER       PIC X(152).
007600     SKIP1
007700 SD  SORTDATEI, RECORDING F, RECORD 26,
007800     DATA RECORD S-SATZ.
007900 01  S-SATZ.
008000     03 S-TERMID     PIC X(4).
008100     03 S-PROGNAME   PIC X(8).
008200     03 S-WAITZEIT   PIC S9(9)   COMP.
008300     03 S-CPUZEIT    PIC S9(9)   COMP.
008400     03 S-ENDZEIT    PIC S9(9)   COMP.
008500     03 S-EXCP       PIC S9(4)   COMP.
008600         SKIP3
008700 WORKING-STORAGE SECTION.
008800 77  FILLER       PIC X(22)   VALUE 'ANFANG WORKING-STORAGE'.
008900 77  X1           PIC S9(4)   COMP    VALUE ZERO.
009000 77  Y1           PIC S9(4)   COMP    VALUE ZERO.
009100 77  Z1           PIC S9(4)   COMP    VALUE ZERO.
009200 77  RFELD1       PIC S9(9)   COMP    VALUE ZERO.
009300 77  RFELD2       PIC S9(12)  COMP    VALUE ZERO.
009400 77  RFELD3       PIC S9(9)   COMP    VALUE ZERO.
009500 77  RZWFELD      PIC S9(9)   COMP    VALUE ZERO.
009600 77  ZEILZAEHL    PIC S9(4)   COMP    VALUE +99.
009700 77  BLATTZAEHL   PIC S9(4)   COMP    VALUE ZERO.
009800 77  SATZZAEHL    PIC S9(12)  COMP    VALUE ZERO.
009900 77  GESZEIT      PIC S9(9)   COMP    VALUE ZERO.
010000 77  GESSUMME     PIC S9(12)  COMP    VALUE ZERO.
010100 77  QUADRSUMME   PIC S9(12)  COMP    VALUE ZERO.
010200 77  GESSEK       PIC S9(4)V99    COMP    VALUE ZERO.
010300 77  XZAEHLER     PIC S9(6)       COMP    VALUE ZERO.
010400 77  HIGHAWZ      PIC S9(4)V99    COMP    VALUE ZERO.
010500 77  GESSEKR      PIC S99V99      COMP    VALUE ZERO.
010600 77  DIFF         PIC S9(6)       COMP    VALUE ZERO.
010700 77  SCHRITT      PIC S9(5)       COMP    VALUE ZERO.
010800 77  KONST39      PIC S9(9)   COMP    VALUE +39.
010900 77  KONST1000    PIC S9(4)   COMP    VALUE +1000.
011000 77  KONST78125   PIC S9(5)   COMP    VALUE +78125.
011100 77  DIFF1        PIC S99V99  COMP    VALUE ZERO.
011200 77  DIFF2        PIC S99V99  COMP    VALUE ZERO.
011300 77  LOWANZ       PIC S9(6)   COMP    VALUE ZERO.
011400 77  IND          PIC S9(4)   COMP    VALUE ZERO.
011500 77  K100         PIC S9(4)   COMP    VALUE +100.
011600 77  PROZENT      PIC S9(4)   COMP    VALUE ZERO.
011700 77  K60          PIC S9(4)   COMP    VALUE +60.
011800 77  ERSTAWZ     PIC S9(4)V99    COMP    VALUE ZERO.
011900 77  TABEND       PIC S9(4)   COMP    VALUE +400.
012000 77  TRANSSU         PIC S9(12)  COMP-3 VALUE ZERO.
012100 77  VB1SU           PIC S9(12)  COMP-3  VALUE ZERO.
012200 77  IND-1           PIC S9(4)   COMP    VALUE ZERO.
012300 77  IND-2           PIC S9(4)   COMP    VALUE ZERO.
012400 77  ZZ              PIC S9(3)   COMP-3  VALUE +70.
012500 77  ZW-TAGDAT       PIC S9(5)   COMP-3 VALUE ZERO.
012510 77  ID-KONST        PIC S9(9)   COMP   VALUE +66052.
012600         SKIP1
012610 01  SATZSCHLUESSELFELD.
012620     03 ACR          PIC X.
012630     03 JCA          PIC X.
012640     03 TCP          PIC X.
012650     03 EOBF         PIC X.
012700 01  WORKFELDER.
012800     03 FILLER       PIC X(10)   VALUE 'WORKFELDER'.
012900     03 NGRU         PIC 9(6)   VALUE ZERO.
013000     03 AGRU         PIC 9(6)   VALUE ZERO.
013100     03 D-HIFE1      PIC S9(5)  COMP-3 VALUE ZERO.
013200     03 D-HIFE2.
013300        04 D-H2-TT   PIC 99     VALUE ZERO.
013400        04 D-H2-MM   PIC 99     VALUE ZERO.
013500        04 D-H2-JJ   PIC 99     VALUE ZERO.
013600     03 H-UE1DATUM   PIC X(8)   VALUE SPACE.
013700     03 D-PARAM.
013800        04 FILLER    PIC 9      VALUE 2.
013900        04 FILLER    PIC X      VALUE SPACE.
014000     03 DATUMN       PIC 9(6).
014100     03 PARAMETER.
014200        05 DEINGB    PIC 9   VALUE 1.
014300        05 FILLER    PIC X.
014400     03 TEXTSTAT     PIC X(56) VALUE '% DER TRANSAKTIONEN HABEN EI
014500-                    'NE KUERZERE ANTWORTZEIT ALS '.
014600     03 V-TERMID     PIC X(4)    VALUE LOW-VALUE.
014700     03 TEXTSU.
014800        05 FILLER    PIC X(8)    VALUE 'SUMME > '.
014900        05 TEXT-SU1  PIC Z9.
015000        05 FILLER    PIC X(10)   VALUE ' SEKUNDEN '.
015100         SKIP2
015200 01  TABELLEN.
015300     03 FILLER       PIC X(8)    VALUE 'TABELLEN'.
015400     03 TABANZAHL    OCCURS 400.
015500        05 TABANZ    PIC 9(6)    COMP.
015600        05 TABSEK    PIC S99V99  COMP.
015700     03 TABSCHRITTWEITE.
015800        05 TABSCHRITT    PIC 9(6)    COMP    OCCURS 30.
015900     SKIP1
016000 01  DURCHSCHN-TABELLE.
016100     02 DURCHSCHN-TAB    OCCURS   11.
016200        03 D-TAB-STD     PIC 99.
016300        03 D-TAB-SEK     PIC S9(4)V99 COMP-3.
016400         SKIP2
016500 01  W-DRZ.
016600     02 W-DRZ-VOR        PIC X.
016700     02 W-Z1       OCCURS   11.
016800      03 FILLER.
016900       05 W-DR-PROZ      PIC 99.
017000       05 FILLER         PIC X.
017100       05 W-DR-Z1        PIC X.
017200       05 FILLER         PIC X.
017300      03 W-DR-SEK-R.
017400       05 W-DR-SEK       PIC ZZZ9,99.
017500 01  ZEILEN.
017600         02 UEB1.
017700     03 VUEB1        PIC X   VALUE '1'.
017800     03 FILLER       PIC X(13)   VALUE 'LISTE NR 1788'.
017900     03 FILLER       PIC X(28)   VALUE SPACE.
018000     03 FILLER       PIC X(51)   VALUE 'C I C S  -  A N T W O R T
018100-                                'Z E I T V E R H A L T E N'.
018200     03 FILLER       PIC X(14)   VALUE '       DATUM  '.
018300     03 UE1DATUM     PIC X(8).
018400     03 FILLER       PIC X(11)   VALUE '    SEITE  '.
018500     03 UE1SEITE     PIC ZZ9.
018600     03 FILLER       PIC X(4)    VALUE SPACE.
018700         SKIP1
018800         02 UEB2.
018900     03 VUEB2        PIC X   VALUE ' '.
019000     03 FILLER       PIC X(41)   VALUE SPACE.
019100     03 FILLER       PIC X(51)   VALUE ALL '-'.
019200     03 FILLER       PIC X(40)   VALUE SPACE.
019300         SKIP1
019400         02 UEB3.
019500     03 VUEB3        PIC X   VALUE '0'.
019600     03 FILLER       PIC X(51)   VALUE SPACE.
019700     03 FILLER       PIC X(31)   VALUE 'PERFORMANCE ANALYZER AUSWE
019800-                                      'RTUNG'.
019900     03 FILLER       PIC X(50)   VALUE SPACE.
020000         SKIP1
020100     02 UEB4.
020200       03 VUEB4          PIC X     VALUE '0'.
020300       03 FILLER         PIC X(56) VALUE SPACE.
020400       03 FILLER         PIC X(15) VALUE 'TAGESUEBERBLICK'.
020500     02 UEB5.
020600       03 VUEB5          PIC X      VALUE '0'.
020700       03 FILLER         PIC XXX    VALUE SPACE.
020800       03 FILLER         PIC X(57)  VALUE
020900     '07-08 UHR   08-09 UHR   09-10 UHR   10-11 UHR   11-12 UHR'.
021000       03 FILLER         PIC X(57)  VALUE
021100     '   12-13 UHR   13-14 UHR   14-15 UHR   15-16 UHR   16-17 '.
021200       03 FILLER         PIC X(15) VALUE 'UHR   17-18 UHR'.
021300     02 UEB6.
021400       03 VUEB6          PIC X     VALUE ' '.
021500       03 FILLER         PIC XX    VALUE '% '.
021600       03 FILLER         PIC X(58) VALUE
021700     '       SEK         SEK         SEK         SEK         SEK'.
021800       03 FILER          PIC X(58) VALUE
021900     '         SEK         SEK         SEK         SEK         S'.
022000       03 FILLER         PIC X(14) VALUE 'EK         SEK'.
022100         02 KOPF1.
022200     03 K1VOR        PIC X   VALUE '0'.
022300     03 FILLER       PIC XX  VALUE SPACE.
022400     03 FILLER       PIC X(21)   VALUE 'ANZAHL  TRANSAKTIONEN'.
022500     03 FILLER       PIC X(109)  VALUE SPACE.
022600         SKIP1
022700         02 KOPF2.
022800     03 K2VOR        PIC X   VALUE '-'.
022900     03 FILLER       PIC X(4)    VALUE SPACE.
023000     03 FILLER       PIC X(37)   VALUE 'LONG LIFE  TRANSAKTIONEN
023100-                    '(AUSSER FS)'.
023200     03 FILLER       PIC X(8)    VALUE SPACE.
023300     03 FILLER       PIC X(24)   VALUE '- ANTWORTZEIT  GROESSER '.
023400     03 K2SEC        PIC ZZ9.
023500     03 FILLER       PIC X(11)   VALUE ' SEKUNDEN -'.
023600     03 FILLER       PIC X(45)   VALUE SPACE.
023700         SKIP1
023800         02 KOPF3.
023900     03 K3VOR        PIC X   VALUE '-'.
024000     03 FILLER       PIC X(14)   VALUE SPACE.
024100     03 FILLER       PIC X(89)   VALUE 'BILDSCHIRM   TRANSAKTION/
024200-    'WAIT-ZEIT    CPU-ZEIT    GESAMT    ENDEZEIT DER    ANZAHL EX
024300-    'CP'.
024400     03 FILLER       PIC X(29)   VALUE SPACE.
024500         SKIP1
024600         02 KOPF4.
024700     03 K4VOR        PIC X   VALUE SPACE.
024800     03 FILLER       PIC X(28)   VALUE SPACE.
024900     03 FILLER       PIC X(60)   VALUE 'PROGRAMM       IN SEK
025000-    '  IN SEK     IN SEK    TRANSAKTION'.
025100     03 FILLER       PIC X(44)   VALUE SPACE.
025200         SKIP1
025300         02 POSTEN.
025400     03 VORPOST      PIC X.
025500     03 FILLER       PIC X(17).
025600     03 PTERMID      PIC X(4).
025700     03 FILLER       PIC X(10).
025800     03 PPROGNAME    PIC X(8).
025900     03 FILLER       PIC XX.
026000     03 PWAITZEIT    PIC ZZZ9,99.
026100     03 FILLER       PIC X(6).
026200     03 PCPUZEIT     PIC ZZZ9,99.
026300     03 FILLER       PIC X(4).
026400     03 PGESZEIT     PIC ZZZ9,99.
026500     03 FILLER       PIC X(7).
026600     03 PSTD         PIC 99.
026700     03 PPKT1        PIC X.
026800     03 PMIN         PIC 99.
026900     03 PPKT2        PIC X.
027000     03 PSEC         PIC 99.
027100     03 FILLER       PIC X(9).
027200     03 PEXCP        PIC ZZZ9    BLANK WHEN ZERO.
027300     03 FILLER       PIC X(32).
027400         SKIP1
027500         02 STATZEILE.
027600     03 STATVOR      PIC X   VALUE '-'.
027700     03 FILLER       PIC X(9).
027800     03 STATBER      PIC X(24).
027900     03 FILLER       PIC XXX.
028000     03 STATFELD1.
028100        05 STATTEXT1     PIC X(30).
028200         05 STATWERT1    PIC ZZZ9,99.
028300        05 FILLER        PIC XX.
028400        05 STATTEXT2     PIC XXX.
028500        05 FILLER       PIC X(27).
028600        05 STATBER2  PIC     X(20).
028700        05 STATSUMME PIC     ZZZ.ZZ9.
028800     03 STATFELD2    REDEFINES STATFELD1.
028900        05 STATWERT2 PIC ZZZ9.
029000         05 STATTEXT3        PIC X(56).
029100        05 STATWERT3     PIC Z9.
029200        05 STATTEXT4     PIC X(9).
029300        05 FILLER    PIC     X(25).
029400     03 STATFELD3    REDEFINES STATFELD2.
029500        05 FILLER    PIC X(15).
029600        05 STATWERT4 PIC Z9.
029700        05 STATPROZ  PIC XX.
029800        05 FILLER    PIC X(5).
029900        05 STATVGL   PIC X.
030000        05 FILLER    PIC X(5).
030100        05 STATWERT5 PIC ZZZ9,99.
030200        05 FILLER    PIC XX.
030300        05 STATTEXT5 PIC XXX.
030400        05 FILLER    PIC     X(54).
030500         SKIP1
030600         02 XZEILE.
030700     03 XVOR         PIC X   VALUE SPACE.
030800     03 FILLER       PIC X(7)    VALUE SPACE.
030900     03 FILLER       PIC XX  VALUE '**'.
031000     03 FILLER       PIC X(102)  VALUE ALL '*+'.
031100     03 FILLER       PIC XX      VALUE '**'.
031200     03 FILLER       PIC X(17)   VALUE SPACE.
031300         SKIP1
031400         02 XWERTZEILE.
031500     03 XWERTVOR     PIC X   VALUE '0'.
031600     03 FILLER       PIC X(9)    VALUE SPACE.
031700     03 XWERTZ1      PIC Z9.
031800     03 FILLER       PIC X(18)   VALUE SPACE.
031900     03 XWERTZ2      PIC Z9.
032000     03 FILLER       PIC X(18)   VALUE SPACE.
032100     03 XWERTZ3      PIC Z9.
032200     03 FILLER       PIC X(18)   VALUE SPACE.
032300     03 XWERTZ4      PIC Z9.
032400     03 FILLER       PIC X(18)   VALUE SPACE.
032500     03 XWERTZ5      PIC Z9.
032600     03 FILLER       PIC X(18)   VALUE SPACE.
032700     03 XWERTZ6      PIC Z9.
032800     03 FILLER       PIC X(8)        VALUE  ' SEK   <'.
032900     03 XWERTZ7      PIC Z9.
033000     03 FILLER       PIC X(5)    VALUE '   > '.
033100     03 XWERTZ8      PIC Z9.
033200     03 FILLER       PIC X(4)    VALUE ' SEK'.
033300         SKIP1
033400         02 XPOSTEN.
033500     03 VORXPOST     PIC X.
033600     03 XPWERT       PIC ZZZZZ9.
033700     03 FILLER       PIC X.
033800     03 XSTERN       PIC X.
033900     03 FILLER       PIC X.
034000     03 XPFELDXX     PIC XX  OCCURS  50.
034100     03 FILLER       PIC X(8).
034200     03 XPFELDLOW    PIC XX.
034300     03 FILLER       PIC X(5).
034400     03 XPFELDHIGH   PIC XX.
034500     03 FILLER       PIC X(5).
034600 01  EOF             PIC 9 VALUE ZERO.
034605 01  E-SATZ.
034615       03  E-STAT      PIC XXX.
034620       03  REC-ID      PIC X.
034625       03  FILLER      PIC X(4).
034630       03  E-ENDZEIT   PIC S9(9)   COMP.
034635       03  E-CPUZEIT   PIC S9(9)   COMP.
034640       03  E-WAITZEIT  PIC S9(9)   COMP.
034645       03  E-EXCP      PIC S9(4)   COMP.
034650       03  FILLER      PIC XX.
034655       03 E-PROGNAME.
034660          05 E-PROGNAME4.
034665             08 E-PROGNAME2    PIC XX.
034670             08 FILLER         PIC XX.
034675          05 FILLER            PIC X(4).
034680       03  E-TERMID    PIC X(4).
034685       03  FILLER      PIC X.
034690       03  E-DATUM     PIC S9(5)   COMP-3.
034692       03  FILLER      PIC X(4).
034700 01  W-SATZ          PIC X(44)   VALUE SPACE.
034800 01  W-PARAM         PIC X(20)   VALUE SPACE.
034900         SKIP3
035000 LINKAGE SECTION.
035100 01  PARMDATEN.
035200     03 PARMLAENGE   PIC S9(4)   COMP.
035300     03 PXWERT1      PIC 99.
035400     03 PXWERT2      PIC 99.
035500     03 PMAXSEC      PIC 99.
035600     03 PYWERT1      PIC 9(6).
035700     03 PYWERT2      PIC 9(6).
035800         EJECT
035900 PROCEDURE DIVISION USING PARMDATEN.
035910     MOVE ID-KONST TO SATZSCHLUESSELFELD.
036000*    DISPLAY '*** PROGRAMMNAME    : SY021'.
036100*    DISPLAY '*** AENDERUNGSNR.   : 1'.
036200*    DISPLAY '*** AENDERUNGSDATUM : 23.10.79 .
036300         SKIP1
036400 B10001.
036500     IF PARMLAENGE IS NOT EQUAL TO 18
036600         GO TO B10020.
036700     IF PXWERT1 IS NUMERIC  AND PXWERT2 IS NUMERIC
036800     AND PMAXSEC IS NUMERIC AND PYWERT1 IS NUMERIC
036900     AND PYWERT2 IS NUMERIC
037000         NEXT SENTENCE
037100     ELSE GO TO B10020.
037200 B10010.
037300         IF PXWERT2 IS GREATER PXWERT1
037400     AND    PYWERT2 IS GREATER PYWERT1
037500         GO TO B10030.
037600 B10020.
037700         DISPLAY '***** PARMWERTE FALSCH HAPRO SY021SAP'.
037800         STOP RUN.
037900         SKIP2
038000 B10030.
038100         OPEN INPUT E1-DATEI, OUTPUT A-DATEI.
038200         PERFORM B87-LOESCH-TAB.
038300         MOVE PARMDATEN TO W-PARAM.
038400         SORT SORTDATEI
038500             ON ASCENDING KEY S-TERMID
038600             ON ASCENDING KEY S-ENDZEIT
038700                 INPUT PROCEDURE IS TEIL-1
038800                 OUTPUT PROCEDURE IS TEIL-2.
038900 B10050.
039000         STOP RUN.
039100         SKIP3
039200 TEIL-1 SECTION.
039300 B10100.
039400         PERFORM B61-ERM-SCHRITTWEITE.
039500         PERFORM B62-TABLOESCH VARYING X1 FROM 1 BY 1
039600                     UNTIL X1 GREATER TABEND.
039700         PERFORM B71-TABSEKFUELL.
039800         PERFORM B72-AUFBAU-XZEILE.
039900         MOVE SPACE TO STATZEILE, POSTEN.
040000         MOVE PMAXSEC TO K2SEC.
040100         SKIP1
040200 B21001.
040300         READ E1-DATEI AT END GO TO B49001.
               IF REC1-ID IS EQUAL TO EOBF
                 GO TO B21001.
               MOVE E1-STAT TO E-STAT.
               MOVE REC1-ID TO REC-ID.
               MOVE E1-PROGNAME TO E-PROGNAME.
               MOVE E1-TERMID TO E-TERMID.
               MOVE E1-DATUM TO E-DATUM.
               MOVE E1-ENDZEIT TO E-ENDZEIT.
               MOVE E1-CPUZEIT TO E-CPUZEIT.
               MOVE E1-WAITZEIT TO E-WAITZEIT.
               MOVE E1-EXCP TO E-EXCP.
040400         MOVE E-SATZ TO W-SATZ.
040500        SKIP1
040600***********************************************************
040700         SKIP1
040800         CALL 'XSY021' USING W-PARAM, W-SATZ, DURCHSCHN-TABELLE,
040900                             EOF.
041000       SKIP1
041100***********************************************************
041200        SKIP1
041300     IF REC-ID IS EQUAL TO TCP
041400         GO TO B21001.
           IF REC-ID IS EQUAL TO ACR
               GO TO B21001.
           IF REC-ID IS EQUAL TO JCA
               GO TO B21001.
041500     IF E-PROGNAME4 IS EQUAL TO 'þVB1'
041600         ADD 1 TO VB1SU.
041700         ADD 1 TO TRANSSU.
041800     IF E-PROGNAME4 IS NOT EQUAL TO 'RTBU'
041900         GO TO B21001.
042000     IF SATZZAEHL IS NOT EQUAL TO ZERO
042100         GO TO B21080.
042200 B21020.
042300       CALL 'DATUMF' USING E-DATUM, DATUMN, UE1DATUM, PARAMETER.
042400         MOVE E-CPUZEIT TO RZWFELD.
042500         PERFORM B63-ZEITUMRECHNUNG.
042600         MOVE RFELD3 TO GESZEIT.
042700         MOVE E-WAITZEIT TO RZWFELD.
042800         PERFORM B63-ZEITUMRECHNUNG.
042900         ADD  RFELD3 TO GESZEIT.
043000         DIVIDE GESZEIT BY K100 GIVING GESSEK ROUNDED.
043100         MOVE GESSEK TO ERSTAWZ.
043200         MOVE E-DATUM TO ZW-TAGDAT.
043300 B21080.
043400         ADD 1 TO SATZZAEHL.
043500 B21090.
043600         GO TO B51001.
043700         SKIP1
043800 B49001.
043900       MOVE 1 TO EOF.
044000     IF SATZZAEHL IS EQUAL TO ZERO
044100         DISPLAY 'SY021  KEINE EINGABE HAPRO SY021SAP'
044200         GO TO B59900.
044300         PERFORM B66-DRUCK-GRAPH.
044400         PERFORM B67-RECHN-STATZAHLEN.
044500       SKIP1
044600***********************************************************
044700       SKIP1
044800     CALL 'XSY021' USING W-PARAM, W-SATZ, DURCHSCHN-TABELLE, EOF.
044900       SKIP1
045000***********************************************************
045100      SKIP1
045200         CLOSE E1-DATEI.
045300     PERFORM B84-DRUCK.
045400         GO TO B59900.
045500         SKIP1
045600 B51001.
045700         MOVE E-CPUZEIT TO RZWFELD.
045800         PERFORM B63-ZEITUMRECHNUNG.
045900         MOVE RFELD3 TO GESZEIT.
046000         MOVE RFELD3 TO S-CPUZEIT.
046100         MOVE E-WAITZEIT TO RZWFELD.
046200         PERFORM B63-ZEITUMRECHNUNG.
046300         MOVE RFELD3 TO S-WAITZEIT.
046400         ADD RFELD3 TO GESZEIT.
046500         ADD GESZEIT TO GESSUMME.
046600 B51020.
046700         MULTIPLY GESZEIT BY GESZEIT GIVING RZWFELD.
046800         ADD RZWFELD TO QUADRSUMME.
046900         DIVIDE GESZEIT BY K100 GIVING GESSEK ROUNDED.
047000         MOVE PMAXSEC TO GESSEKR.
047100     IF GESSEK  IS GREATER GESSEKR
047200         PERFORM B64-ERST-SORTSATZ.
047300 B51030.
047400     IF GESSEK  IS GREATER PXWERT2
047500         ADD 1 TO XZAEHLER.
047600     IF GESSEK IS LESS PXWERT1
047700         ADD 1 TO LOWANZ GO TO B51040.
047800         PERFORM B65-ERST-TABANZAHL.
047900 B51040.
048000     IF GESSEK IS GREATER HIGHAWZ
048100         MOVE GESSEK TO HIGHAWZ.
048200 B51050.
048300         GO TO B21001.
048400 B59900.
048500 B59999.
048600     EXIT.
048700         SKIP3
048800 B61-ERM-SCHRITTWEITE SECTION.
048900 B61010.
049000         SUBTRACT PYWERT1 FROM PYWERT2
049100             GIVING DIFF.
049200         DIVIDE DIFF BY 30 GIVING SCHRITT ROUNDED.
049300         MOVE 1 TO X1.
049400         MOVE PYWERT1 TO DIFF.
049500 B61020.
049600     IF X1 GREATER 30
049700             GO TO B61090.
049800         MOVE DIFF TO TABSCHRITT (X1).
049900         ADD SCHRITT TO DIFF.
050000         ADD 1 TO X1.
050100         GO TO B61020.
050200 B61090.
050300     EXIT.
050400         SKIP1
050500 B62-TABLOESCH SECTION.
050600 B62010.
050700         MOVE ZERO TO TABANZ (X1), TABSEK (X1).
050800 B62090.
050900     EXIT.
051000         SKIP1
051100 B63-ZEITUMRECHNUNG SECTION.
051200 B63010.
051300         ADD RZWFELD, KONST39 GIVING RFELD1.
051400         MULTIPLY RFELD1 BY KONST1000 GIVING RFELD2.
051500         DIVIDE RFELD2 BY KONST78125 GIVING RFELD3
051600             ON SIZE ERROR MOVE ZERO TO RFELD3.
051700 B63090.
051800     EXIT.
051900         SKIP1
052000 B64-ERST-SORTSATZ SECTION.
052100 B64010.
052200         MOVE E-TERMID   TO S-TERMID.
052300         MOVE E-PROGNAME TO S-PROGNAME.
052400         MOVE E-EXCP     TO S-EXCP.
052500         MOVE E-ENDZEIT  TO RZWFELD.
052600         PERFORM B63-ZEITUMRECHNUNG.
052700         MOVE RFELD3 TO S-ENDZEIT.
052800             RELEASE S-SATZ.
052900 B64090.
053000     EXIT.
053100         SKIP1
053200 B65-ERST-TABANZAHL SECTION.
053300 B65001.
053400             MOVE GESSEK TO GESSEKR.
053500             MOVE 1 TO X1.
053600             MOVE 2 TO Y1.
053700 B65010.
053800     IF Y1 IS GREATER TABEND
053900             GO TO B65090.
054000     IF GESSEKR IS GREATER TABSEK (Y1)
054100             ADD 1 TO X1
054200             ADD 1 TO Y1
054300             GO TO B65010.
054400     IF GESSEKR IS EQUAL TO TABSEK (X1)
054500         ADD 1 TO TABANZ (X1)
054600         GO TO B65090.
054700     IF GESSEKR IS EQUAL TO TABSEK (Y1)
054800         ADD 1 TO TABANZ (Y1)
054900         GO TO B65090.
055000 B65020.
055100         SUBTRACT TABSEK (X1) FROM GESSEKR
055200             GIVING DIFF1.
055300         SUBTRACT GESSEKR FROM TABSEK (Y1)
055400             GIVING DIFF2.
055500     IF DIFF1 IS LESS DIFF2
055600         ADD 1 TO TABANZ (X1)
055700     ELSE ADD 1 TO TABANZ (Y1).
055800 B65090.
055900     EXIT.
056000         SKIP1
056100 B66-DRUCK-GRAPH SECTION.
056200 B66001.
056300         MOVE 1 TO UE1SEITE, BLATTZAEHL.
056400         MOVE UEB1 TO ZEILE.
056500         PERFORM B81-WRITE.
056600         MOVE UEB2 TO ZEILE.
056700         PERFORM B81-WRITE.
056800         MOVE UEB3 TO ZEILE.
056900         PERFORM B81-WRITE.
057000         MOVE KOPF1 TO ZEILE.
057100         PERFORM B81-WRITE.
057200 B66005.
057300         MOVE +6 TO IND.
057400         MOVE +30 TO Y1.
057500         MOVE SPACE TO XPOSTEN.
057600         MOVE '-' TO VORXPOST.
057700 B66010.
057800     IF Y1 IS LESS 1
057900         GO TO B66090.
058000     IF IND IS GREATER 5
058100         MOVE TABSCHRITT (Y1) TO XPWERT
058200         MOVE 1 TO IND
058300         MOVE '+' TO XSTERN
058400         ELSE MOVE '*' TO XSTERN.
058500     IF Y1 IS EQUAL TO 1
058600         MOVE TABSCHRITT (Y1) TO XPWERT
058700         MOVE '+' TO XSTERN.
058800         MOVE 1 TO X1.
058900 B66020.
059000     IF X1 IS GREATER +50
059100         GO TO B66070.
059200     IF TABANZ (X1) IS EQUAL TO ZERO GO TO B66040.
059300     IF TABANZ (X1) IS LESS TABSCHRITT (Y1)
059400         GO TO B66050.
059500 B66030.
059600         MOVE '**' TO XPFELDXX (X1).
059700 B66040.
059800         ADD 1 TO X1.
059900         GO TO B66020.
060000 B66050.
060100     IF Y1 IS LESS +2
060200         GO TO B66030.
060300         SUBTRACT 1 FROM Y1  GIVING Z1.
060400     IF TABANZ (X1) IS NOT GREATER TABSCHRITT (Z1)
060500         GO TO B66040.
060600         SUBTRACT TABSCHRITT (Z1) FROM TABANZ (X1)
060700                     GIVING DIFF.
060800         SUBTRACT TABANZ (X1) FROM TABSCHRITT (Y1)
060900                     GIVING SCHRITT.
061000     IF DIFF IS LESS SCHRITT
061100             GO TO B66040.
061200             GO TO B66030.
061300 B66070.
061400         IF XZAEHLER IS EQUAL TO ZERO
061500             GO TO B66088.
061600     IF XZAEHLER IS LESS TABSCHRITT (Y1)
061700         GO TO B66080.
061800 B66075.
061900         MOVE '**' TO XPFELDHIGH.
062000 B66076.
062100         GO TO B66088.
062200 B66080.
062300     IF Y1 IS LESS 2
062400         GO TO B66075.
062500         SUBTRACT 1 FROM Y1 GIVING Z1.
062600 B66081.
062700     IF XZAEHLER   LESS TABSCHRITT (Z1)
062800             GO TO B66076.
062900         SUBTRACT TABSCHRITT (Z1) FROM XZAEHLER
063000                 GIVING DIFF.
063100         SUBTRACT XZAEHLER FROM TABSCHRITT (Y1)
063200                 GIVING SCHRITT.
063300         IF DIFF IS LESS SCHRITT
063400             GO TO B66076.
063500             GO TO B66075.
063600 B66088.
063700         IF LOWANZ IS EQUAL TO ZERO
063800             GO TO B66089.
063900     IF LOWANZ IS NOT LESS TABSCHRITT (Y1)
064000         MOVE '**' TO XPFELDLOW.
064100         GO TO B66089.
064200     IF Y1 IS LESS 2
064300         MOVE '**' TO XPFELDLOW.
064400         GO TO B66089.
064500         SUBTRACT 1 FROM Y1 GIVING Z1.
064600     IF LOWANZ IS LESS TABSCHRITT (Z1)
064700         GO TO B66089.
064800         SUBTRACT TABSCHRITT (Z1) FROM LOWANZ
064900             GIVING DIFF.
065000         SUBTRACT LOWANZ FROM TABSCHRITT (Y1)
065100             GIVING SCHRITT.
065200         IF DIFF IS LESS SCHRITT
065300             GO TO B66089.
065400         MOVE '**' TO XPFELDLOW.
065500 B66089.
065600         MOVE XPOSTEN TO ZEILE.
065700         PERFORM B81-WRITE.
065800         MOVE SPACE TO XPOSTEN.
065900         ADD 1 TO IND.
066000         SUBTRACT 1 FROM Y1.
066100         GO TO B66010.
066200 B66090.
066300         MOVE XZEILE TO ZEILE.
066400         PERFORM B81-WRITE.
066500         MOVE XWERTZEILE TO ZEILE.
066600         PERFORM B81-WRITE.
066700 B66099.
066800     EXIT.
066900         SKIP1
067000 B67-RECHN-STATZAHLEN SECTION.
067100 B67001.
067200         DIVIDE GESSUMME BY SATZZAEHL
067300                 GIVING RFELD1.
067400         DIVIDE RFELD1 BY K100
067500                 GIVING GESSEKR.
067600             MOVE GESSEKR TO STATWERT1.
067700     MOVE 'DURCHSCHNITTLICHE ANTWORTZEIT' TO STATTEXT1.
067800     MOVE 'STATISTISCHE MASSZAHLEN' TO STATBER.
067900     MOVE 'SEK' TO STATTEXT2.
068000     MOVE '-'   TO STATVOR.
068100         MOVE 'SUMME TRANSAKT. GES' TO STATBER2.
068200         MOVE TRANSSU TO STATSUMME.
068300     MOVE STATZEILE TO ZEILE.
068400         PERFORM B81-WRITE.
068500         MOVE SPACE TO STATZEILE.
068600 B67010.
068700     COMPUTE RFELD2 =
068800     ((SATZZAEHL * QUADRSUMME - (GESSUMME ** 2)) ** 0,5)
068900         / SATZZAEHL
069000             ON SIZE ERROR MOVE ZERO TO RFELD2, GESSEKR
069100                         GO TO B67020.
069200         DIVIDE RFELD2 BY K100
069300             GIVING GESSEK
069400         ON SIZE ERROR
069500         MOVE ZERO TO GESSEK.
069600         MOVE GESSEK TO STATWERT1.
069700 B67020.
069800         MOVE PXWERT2 TO TEXT-SU1.
069900         MOVE TEXTSU TO STATBER2.
070000         MOVE XZAEHLER TO STATSUMME.
070100             MOVE 'STANDARDABWEICHUNG' TO STATTEXT1.
070200             MOVE 'SEK' TO STATTEXT2.
070300             MOVE '0' TO STATVOR.
070400             MOVE STATZEILE TO ZEILE.
070500             PERFORM B81-WRITE.
070600             MOVE SPACE TO STATZEILE.
070700 B67030.
070800         MOVE PMAXSEC TO GESSEKR.
070900         MOVE 1 TO X1.
071000         MOVE LOWANZ TO RFELD2.
071100     IF GESSEKR IS LESS TABSEK (TABEND)
071200         GO TO B67040.
071300         MOVE 'PARM-MAXWERT FALSCH' TO STATBER.
071400         MOVE 'KEINE AUSWERTUNG MOEGLICH' TO STATTEXT3.
071500         GO TO B67055.
071600 B67040.
071700     IF X1 IS GREATER TABEND
071800         GO TO B67050.
071900     IF TABSEK (X1) IS LESS GESSEKR
072000         ADD TABANZ (X1) TO RFELD2
072100         ADD 1 TO X1
072200         GO TO B67040.
072300         GO TO B67060.
072400 B67050.
072500 B67055. MOVE '0' TO STATVOR.
072600         MOVE STATZEILE TO ZEILE.
072700         PERFORM B81-WRITE.
072800         MOVE SPACE TO STATZEILE.
072900         GO TO B67100.
073000 B67060.
073100     COMPUTE PROZENT ROUNDED = K100 * RFELD2 / SATZZAEHL
073200             ON SIZE ERROR MOVE ZERO TO PROZENT.
073300         MOVE PROZENT TO STATWERT2.
073400         MOVE TEXTSTAT TO STATTEXT3.
073500         MOVE PMAXSEC TO STATWERT3.
073600         MOVE ' SEKUNDEN' TO STATTEXT4.
073700         GO TO B67055.
073800 B67100.
073900         MOVE +70 TO PROZENT.
074000         PERFORM B82-PROZRECHNG.
074100         PERFORM B83-DRUCKPROZ.
074200 B67110.
074300         MOVE +80 TO PROZENT.
074400         PERFORM B82-PROZRECHNG.
074500         PERFORM B83-DRUCKPROZ.
074600 B67120.
074700         MOVE +90 TO PROZENT.
074800         PERFORM B82-PROZRECHNG.
074900         PERFORM B83-DRUCKPROZ.
075000 B67130.
075100         MOVE +95 TO PROZENT.
075200         PERFORM B82-PROZRECHNG.
075300         PERFORM B83-DRUCKPROZ.
075400 B67140.
075500         MOVE +97 TO PROZENT.
075600         PERFORM B82-PROZRECHNG.
075700         PERFORM B83-DRUCKPROZ.
075800 B67150.
075900         MOVE +98 TO PROZENT.
076000         PERFORM B82-PROZRECHNG.
076100         PERFORM B83-DRUCKPROZ.
076200 B67160.
076300         MOVE +99 TO PROZENT.
076400         PERFORM B82-PROZRECHNG.
076500         MOVE 'SUMME TRANSAKT. SAP' TO   STATBER2.
076600         MOVE SATZZAEHL TO STATSUMME.
076700         PERFORM B83-DRUCKPROZ.
076800 B67190.
076900         MOVE ERSTAWZ TO STATWERT1.
077000         MOVE 'ERSTE ANTWORTZEIT' TO STATTEXT1.
077100         MOVE 'SEK' TO STATTEXT2.
077200         MOVE 'SUMME TRANSAKT. VB1' TO STATBER2.
077300         MOVE VB1SU TO STATSUMME.
077400         MOVE '0' TO STATVOR.
077500         MOVE STATZEILE TO ZEILE.
077600         PERFORM B81-WRITE.
077700 B67200.
077800         MOVE HIGHAWZ TO STATWERT1.
077900         MOVE 'LAENGSTE ANTWORTZEIT' TO STATTEXT1.
078000         MOVE 'SEK' TO STATTEXT2.
078100         SUBTRACT SATZZAEHL FROM TRANSSU.
078200         SUBTRACT VB1SU FROM TRANSSU.
078300         MOVE  'SUMME TRANS. SONST. ' TO STATBER2.
078400         MOVE TRANSSU TO STATSUMME.
078500         MOVE '0' TO STATVOR.
078600         MOVE STATZEILE TO ZEILE.
078700         PERFORM B81-WRITE.
078800 B67900.
078900     EXIT.
079000         SKIP2
079100 B71-TABSEKFUELL SECTION.
079200 B71010.
079300         MOVE 1 TO X1.
079400         MOVE PXWERT1 TO DIFF1.
079500         MOVE +0,10 TO DIFF2.
079600 B71020.
079700     IF X1 IS GREATER TABEND
079800         GO TO B71090.
079900         MOVE DIFF1 TO TABSEK (X1).
080000         ADD DIFF2 TO DIFF1.
080100         ADD 1 TO X1.
080200         GO TO B71020.
080300 B71090.
080400     EXIT.
080500         SKIP1
080600 B72-AUFBAU-XZEILE SECTION.
080700 B72010.
080800         MOVE PXWERT1 TO Z1.
080900         MOVE Z1 TO XWERTZ1, XWERTZ7.
081000         ADD 1 TO Z1.
081100         MOVE Z1 TO XWERTZ2.
081200         ADD 1 TO Z1.
081300         MOVE Z1 TO XWERTZ3.
081400         ADD 1 TO Z1.
081500         MOVE Z1 TO XWERTZ4.
081600         ADD 1 TO Z1.
081700         MOVE Z1 TO XWERTZ5.
081800         ADD 1 TO Z1.
081900         MOVE Z1 TO XWERTZ6, XWERTZ8.
082000 B72090.
082100     EXIT.
082200         SKIP2
082300 B81-WRITE SECTION.
082400 B81010.
082500         WRITE ZEILE AFTER POSITIONING ZVOR.
082600 B81090.
082700     EXIT.
082800         SKIP1
082900 B82-PROZRECHNG SECTION.
083000 B82010.
083100     COMPUTE RFELD2 = SATZZAEHL * PROZENT / K100
083200             ON SIZE ERROR MOVE ZERO TO RFELD2
083300                 MOVE ZERO TO GESSEK
083400                 GO TO B82090.
083500         MOVE LOWANZ TO QUADRSUMME.
083600         MOVE 1 TO X1.
083700 B82020.
083800     IF X1 IS GREATER TABEND
083900             MOVE ZERO TO GESSEK
084000             GO TO B82090.
084100         ADD TABANZ (X1) TO QUADRSUMME.
084200     IF QUADRSUMME IS NOT LESS RFELD2
084300             MOVE TABSEK (X1) TO GESSEK
084400         ADD +0,05 TO GESSEK
084500             GO TO B82090.
084600         ADD 1 TO X1.
084700         GO TO B82020.
084800 B82090.
084900     EXIT.
085000         SKIP1
085100 B83-DRUCKPROZ SECTION.
085200 B83010.
085300     IF GESSEK IS EQUAL TO ZERO
085400         GO TO B83090.
085500         MOVE PROZENT TO STATWERT4.
085600         MOVE ' %'    TO STATPROZ.
085700         MOVE '<'     TO STATVGL.
085800         MOVE GESSEK  TO STATWERT5.
085900         MOVE 'SEK'   TO STATTEXT5.
086000         MOVE '0'     TO STATVOR.
086100         MOVE STATZEILE TO ZEILE.
086200         PERFORM B81-WRITE.
086300         MOVE SPACE TO STATZEILE.
086400 B83090.
086500     EXIT.
086600         SKIP1
086700*
086800****************************************************************
086900*    TAGES-GESAMTUEBERBLICK IN STUNDEN-INTERVALLEN DRUCKEN
087000*****************************************************************
087100*
087200 B84-DRUCK SECTION.
087300 B84001.
087400     OPEN INPUT   EINGABE.
087500 B84010.
087600     READ  EINGABE     AT END GO TO B84199.
087700     MOVE E2-DATUM TO NGRU.
087800     IF NGRU = AGRU  GO TO B84020.
087900     MOVE E2-JJ TO D-H2-JJ.
088000     MOVE E2-MM TO D-H2-MM.
088100     MOVE E2-TT TO D-H2-TT.
088200     MOVE UE1DATUM TO H-UE1DATUM.
088300     CALL 'DATUMF' USING D-HIFE1, D-HIFE2, UE1DATUM, D-PARAM.
088400     IF D-HIFE1   NOT  =   ZW-TAGDAT   GO TO B84010.
088500     MOVE NGRU TO AGRU.
088600     MOVE +70 TO ZZ.
088700 B84020.
088800     MOVE SPACE TO W-DRZ.
088900     MOVE ZERO TO IND-2.
089000 B84030.
089100     ADD 1 TO IND-2.
089200     IF IND-2   >   7    GO TO B84060.
089300     MOVE ZERO TO IND-1.
089400 B84040.
089500     ADD 1 TO IND-1.
089600     IF IND-1   >   11     GO TO B84050.
089700     IF IND-1 NOT = 1 GO TO B84045.
089800     MOVE E2-PROZ (IND-1 IND-2) TO W-DR-PROZ (IND-1).
089900     MOVE '<' TO W-DR-Z1 (IND-1).
090000 B84045.
090100     MOVE E2-SEK (IND-1 IND-2) TO W-DR-SEK (IND-1).
090200     GO TO B84040.
090300 B84050.
090400     PERFORM B85-DRUCK.
090500     GO TO B84030.
090600 B84060.
090700     PERFORM B86-DRUCK-TAB.
090800     GO TO B84010.
090900 B84199.
091000     MOVE H-UE1DATUM TO UE1DATUM.
091100     CLOSE EINGABE.
091200 B84210.
091300     EXIT.
091400*
091500****************************************************************
091600*       D R U C K R O U T I N E
091700****************************************************************
091800*
091900 B85-DRUCK SECTION.
092000 B85001.
092100     IF ZZ NOT > 50 GO TO B85010.
092200     MOVE ZERO TO ZZ.
092300     ADD 1 TO BLATTZAEHL.
092400     MOVE BLATTZAEHL TO UE1SEITE.
092500     WRITE ZEILE FROM UEB1 AFTER POSITIONING VUEB1.
092600     WRITE ZEILE FROM UEB2 AFTER POSITIONING VUEB2.
092700     WRITE ZEILE FROM UEB3 AFTER POSITIONING VUEB3.
092800     WRITE ZEILE FROM UEB4 AFTER POSITIONING VUEB4.
092900     WRITE ZEILE FROM UEB5 AFTER POSITIONING VUEB5.
093000     WRITE ZEILE FROM UEB6 AFTER POSITIONING VUEB6.
093100     MOVE SPACE TO ZEILE.
093200     WRITE ZEILE   AFTER POSITIONING ZVOR.
093300     ADD 10 TO ZZ.
093400 B85010.
093500     MOVE '0' TO W-DRZ-VOR.
093600     WRITE ZEILE FROM W-DRZ AFTER POSITIONING W-DRZ-VOR.
093700     ADD 2 TO ZZ.
093800     MOVE SPACE TO W-DRZ.
093900 B85090.
094000     EXIT.
094100         SKIP3
094200*
094300***************************************************************
094400*  TABELLE DURCHSCHN. ANTWORTZEITEN IN STUNDEN-INTERVALLEN
094500*          AUSDRUCKEN
094600****************************************************************
094700*
094800 B86-DRUCK-TAB SECTION.
094900 B86001.
095000     MOVE '-DURCHSCHNITTLICHE ANTWORTZEITEN' TO W-DRZ.
095100     PERFORM B85-DRUCK.
095200     MOVE ZERO TO IND-1.
095300     MOVE '0' TO W-DRZ-VOR.
095400 B86010.
095500     ADD 1 TO IND-1.
095600     IF IND-1   >   11   GO TO B86090.
095700     MOVE D-TAB-SEK (IND-1) TO W-DR-SEK (IND-1).
095800     GO TO B86010.
095900 B86090.
096000     PERFORM B85-DRUCK.
096100 B86099.
096200     EXIT.
096300*
096400****************************************************************
096500*    TABELLE  'DURCHSCHN-TAB'  LOESCHEN
096600****************************************************************
096700*
096800 B87-LOESCH-TAB SECTION.
096900 B87001.
097000     MOVE ZERO TO IND-1.
097100 B87010.
097200     ADD 1 TO IND-1.
097300     IF IND-1 > 11 GO TO B87090.
097400     MOVE ZERO TO D-TAB-SEK (IND-1).
097500     GO TO B87010.
097600 B87090.
097700     EXIT.
097800     SKIP1
097900*
098000********************************************************
098100*   S O R T     OUTPUT-PROCEDURE
098200********************************************************
098300*
098400     SKIP2
098500 TEIL-2 SECTION.
098600 D21000.
098700 D21001.
098800         RETURN SORTDATEI AT END GO TO D49900.
098900         PERFORM D61-DRUCK-TEIL-2.
099000         GO TO D21001.
099100 D49900.
099200     CLOSE A-DATEI.
099300 D49999.
099400     EXIT.
099500         SKIP2
099600 D61-DRUCK-TEIL-2 SECTION.
099700 D61001.
099800     IF S-TERMID IS NOT EQUAL TO V-TERMID
099900         MOVE S-TERMID TO V-TERMID
100000         ADD 1 TO ZEILZAEHL
100100         MOVE '0' TO VORPOST
100200         MOVE S-TERMID TO PTERMID.
100300         MOVE S-PROGNAME TO PPROGNAME.
100400         MOVE S-EXCP TO PEXCP.
100500         DIVIDE S-WAITZEIT BY K100
100600             GIVING GESSEK.
100700             MOVE GESSEK TO HIGHAWZ.
100800             MOVE GESSEK TO PWAITZEIT.
100900 D61010.
101000         DIVIDE S-CPUZEIT BY K100
101100             GIVING GESSEK.
101200             MOVE GESSEK TO PCPUZEIT.
101300             ADD GESSEK TO HIGHAWZ.
101400         MOVE HIGHAWZ TO PGESZEIT.
101500 D61020.
101600         DIVIDE S-ENDZEIT BY K100
101700             GIVING RFELD1.
101800         DIVIDE RFELD1 BY K60
101900             GIVING RFELD3   REMAINDER PSEC.
102000         DIVIDE RFELD3 BY K60
102100             GIVING PSTD     REMAINDER PMIN.
102200         MOVE ':' TO PPKT1, PPKT2.
102300 D61030.
102400     IF ZEILZAEHL GREATER 50
102500             PERFORM D62-KOPF.
102600         MOVE POSTEN TO ZEILE.
102700         PERFORM B81-WRITE.
102800         MOVE SPACE TO POSTEN.
102900         ADD 1 TO ZEILZAEHL.
103000 D61090.
103100     EXIT.
103200         SKIP1
103300 D62-KOPF SECTION.
103400 D62001.
103500         ADD 1 TO BLATTZAEHL.
103600         MOVE BLATTZAEHL TO UE1SEITE.
103700         MOVE ZERO TO ZEILZAEHL.
103800 D62010.
103900         MOVE UEB1 TO ZEILE.
104000         PERFORM B81-WRITE.
104100         MOVE UEB2 TO ZEILE.
104200         PERFORM B81-WRITE.
104300         MOVE UEB3 TO ZEILE.
104400         PERFORM B81-WRITE.
104500         MOVE KOPF2 TO ZEILE.
104600         PERFORM B81-WRITE.
104700         MOVE KOPF3 TO ZEILE.
104800         PERFORM B81-WRITE.
104900         MOVE KOPF4 TO ZEILE.
105000         PERFORM B81-WRITE.
105100 D62090.
105200     EXIT.
105300         SKIP1

         MACRO
&NAME    EOJ   &CODE=0
         GBLC  &SAVE
         AIF   (T'&CODE NE 'N').NOTNUM
         AIF   (&CODE NE 0).NOTZERO
&NAME    XR    R15,R15 .                RETURN-CODE = 0
         AGO   .BEIDE
.NOTZERO ANOP
         AIF   (&CODE GT 4095).ZUGRO
&NAME    LA    R15,&CODE.(0,0) .        RETURN-CODE NOT 0
.BEIDE   L     R13,&SAVE+4 .            RELOAD ADDR. OF HIGH-SAVEAREA
         RETURN (14,12),RC=(15)
         MEXIT
.ZUGRO   MNOTE 2,'RETURN-CODE ZU HOCH, 4095 ANGENOMMEN'
&NAME    LA    R15,4095(0,0)
         AGO   .BEIDE
         MEXIT
.NOTNUM  MNOTE 2,'RETURN-CODE NICHT NUMERISCH, 9 ANGENOMMEN'
&NAME    LA    R15,9(0,0)
         AGO   .BEIDE
         MEND

         TITLE 'SEPACOB = DRUCKEN LISTENSEPARATOR-BLAETTER / COBOL'
***
***      AUFRUF IN COBOL-PROGRAMMEN:
***
***            ENTER LINKAGE.
***            CALL 'SEPACOB' USING FD-NAME, SEPARATOR-TEXT.
***            ENTER COBOL.
***
***      FD-NAME = NAME DES DRUCKBESTANDES.
***                (DER BESTAND MUSS EROEFFNET SEIN.)
***
***      SEPARATOR-TEXT = NAME EINES BEREICHES MIT 4 ZEICHENKETTEN
***                       VON JEWEILS 8 ZEICHEN LAENGE.
***                       Z.B.:  01 SEPARATOR-TEXT.
***                              02 T1 PICTURE X(8) VALUE 'MUE/WIES'.
***                              02 T2 PICTURE X(8) VALUE 'KRW-W/DV'.
***                              02 T3 PICTURE X(8) VALUE 'RENK    '.
***                              02 T4 PICTURE X(8) VALUE 'J0523400'.
***
***      AUTOR: ARNOLDS.   VERSION 00 VOM 20. 08. 1970.
***
         SECTION SEPACOB,BASE,ANFANG
         COPY  REGISTER
         SPACE 3
BASE     EQU   10   BASIS-REGISTER
Z        EQU   2    ZEICHEN
FA       EQU   3    FILE ADRESSE (DCB ADDR)
ZA       EQU   4    ZEICHENADRESSE
BN       EQU   5    BLATTNR
TN       EQU   6    TEXTNR
LN       EQU   7    LINIE NR
ZN       EQU   8    ZEICHEN NR
SN       EQU   9    SPALTEN NR
         SPACE 3
PMADR    DC    A(PM)
F8       DC    F'8'
H18      DC    H'18'
H12      DC    H'12'
H14      DC    H'14'
VERGL    DC    X'8040201008040201'
DBERVZ   DC    XL1'C9'
DBER     DC    132CL1' '
VZK1     EQU   137  VORSCHUB  KANAL1
VZK9     EQU   201  VORSCHUB  KANAL9
VZZT1    EQU   09   ZEILENTRANSPORT  1 ZEILE  NACH DEM DRUCKEN
VZZT2    EQU   17   ZEILENTRANSPORT  2 ZEILEN NACH DEM DRUCKEN
         USING IHADCB,FA
MACHCD   EQU   2         RECORD FORMAT = MASCHINENCODE
ANFANG   LM    FA,ZA,0(R1)         LADEN PARAMETER IN REGISTER
         SR    Z,Z                 LOESCHEN ZEICHEN-REGISTER
         LA    BN,3                EINSTELLEN ANZAHL DER BLAETTER = 2
HP1      TM    DCBRECFM,MACHCD
         BZ    HP12
         MVI   DBERVZ,VZK9
         MVI   DBER,C' '
         MVC   DBER+1(131),DBER
         BAL   R14,DRUCKEN         DR. LEERZEILE + VORSCHUB KANAL 9
HP12     MVI   DBER,C'*'           STERNE -> DBER
         MVC   DBER+1(131),DBER
         MVI   DBERVZ,C'9'         KANAL 9 ASA-CODE
         TM    DCBRECFM,MACHCD     TEST MASCH-CD ERFORDERLICH
         BZ    HP13
         MVI   DBERVZ,VZK1         KANAL 1 MASCHINEN-CODE
HP13     EQU   *
         BAL   R14,DRUCKEN         DR. STERNZEILE AUF FORMULAR-FALZ
         MVI   DBER,C' '           LOESCHEN DBER
         MVC   DBER+1(131),DBER
         TM    DCBRECFM,MACHCD
         BO    HP15
         MVI   DBERVZ,C'1'         VORSCHUB KANAL 1 ASA-CODE
         BAL   R14,DRUCKEN         DR. LEERZEILE + VORSCHUB KANAL 1
HP15     BCT   BN,HP17
         B     ENDE
HP17     LA    TN,5                EINSTELLEN ANZAHL DER TEXTE = 4
HP2      BCT   TN,HP21
         B     HP1
HP21     MVI   DBER,C' '           LOESCHEN DBER
         MVC   DBER+1(131),DBER
         MVI   DBERVZ,C'0'         ZEILENTRANSPORT 2 ZEILEN ASA-CODE
         TM    DCBRECFM,MACHCD
         BZ    HP23
         MVI   DBERVZ,VZZT2        ZEILENTRANSPORT 2 MASCHINEN-CODE
HP23     EQU   *
         BAL   R14,DRUCKEN         DR. LEERZEILE + ZEILENTRANSPORT
         LA    LN,13               EINSTELLEN LINIEN-NR = 12
HP3      BCT   LN,HP31
         B     HP2
HP31     MVI   DBER,C' '           LOESCHEN DBER
         MVC   DBER+1(131),DBER
         LA    ZN,9                EINSTELLEN ZEICHEN-NR = 8
HP4      BCT   ZN,HP41
         B     HP6
HP41     LA    R1,4                RECHNEN ZEICHENADRESSE IN PARM
         SR    R1,TN
         SLA   R1,3
         LA    R1,8(R1)
         SR    R1,ZN
         IC    Z,0(ZA,R1)          LADEN ZEICHEN IN REGISTER
         LA    SN,13               EINSTELLEN SPALTEN-NR. = 12
HP5      BCT   SN,HP51
         B     HP4
HP51     SR    R0,R0
         IC    R0,PMOFFSET(Z)      LADEN OFFSET PRINTMASKE
         MH    R0,H18
         A     R0,PMADR
         LR    R12,R0              LADEN PRINTMASK-ADR IN REG 12
         LA    R0,12               RECHNEN BITNR IN PRINTMASKE
         SR    R0,LN               (12-LN)*12+12-SN = BITNR
         MH    R0,H12
         SRDA  R0,32
         LA    R1,12(R1)
         SR    R1,SN
         D     R0,F8               BITNR : 8 = BYTENR IN PRINTMASKE
         AR    R12,R1                          REST = BITNR IM BYTE
         LR    R1,R0
         IC    R0,VERGL(R1)
         STC   R0,TEST+1
TEST     TM    0(R12),0            TEST 0B ZEICHEN ZU DRUCKEN IST
         BZ    HP5
         LA    R1,8
         SR    R1,ZN
         MH    R1,H14
         LA    R1,12(R1)
         SR    R1,SN
         STC   Z,DBER+1(R1)        LADEN ZEICHEN -> DBER
         B     HP5
HP6      MVI   DBERVZ,VZZT1
         TM    DCBRECFM,MACHCD
         BO    HP63
         MVI   DBERVZ,X'40'
HP63     EQU   *
         BAL   R14,DRUCKEN         DR. ZEILE 1 - 12 JE TEXT
         B     HP3
ENDE     L     R13,4(R13)          RESTORE SAVEAREA ADDRESS
         RETURN (14,12)
         COPY  THILFE
         SPACE 3
         DS    F
DRUCKEN  ST    R14,DRUCKEN-4       SICHERN RETURN-ADRESSE
         TM    DCBMACRF+1,X'08'    TEST AUF LOCATE MODE
         BZ    DRUCK01             BRANCH WENN NEIN (MOVE MODE)
         LH    R1,DCBLRECL
         BCTR  R1,0
         STC   R1,DRUCK02+1        EINSETZEN LAENGE IN MOVE-INSTRUKTION
         L     R1,DCBRECAD
DRUCK02  MVC   0(1,R1),DBERVZ      MOVE INTO LOCATE BUFFER
DRUCK01  PUT   (FA),DBERVZ         DRUCKEN
         L     R14,DRUCKEN-4
         BR    R14
         SPACE 3
PMOFFSET DC    75AL1((PMBL-PM)/18)
         DC    AL1((PMPT-PM)/18,(PMLT-PM)/18,(PMKA-PM)/18)
         DC    AL1((PMPT-PM)/18,(PMOR-PM)/18,(PMKU-PM)/18)
         DC    10AL1((PMBL-PM)/18)
         DC    AL1((PMDO-PM)/18,(PMST-PM)/18,(PMKZ-PM)/18)
         DC    AL1((PMSM-PM)/18,(PMNT-PM)/18,(PMMI-PM)/18)
         DC    AL1((PMSS-PM)/18)
         DC    9AL1((PMBL-PM)/18)
         DC    AL1((PMKO-PM)/18,(PMPZ-PM)/18,(PMUS-PM)/18)
         DC    AL1((PMGT-PM)/18,(PMFZ-PM)/18)
         DC    10AL1((PMBL-PM)/18)
         DC    AL1((PMDP-PM)/18,(PMNM-PM)/18,(PMKL-PM)/18)
         DC    AL1((PMHK-PM)/18,(PMEQ-PM)/18,(PMAZ-PM)/18)
         DC    65AL1((PMBL-PM)/18)
         DC    AL1((PMA-PM)/18,(PMB-PM)/18,(PMC-PM)/18)
         DC    AL1((PMD-PM)/18,(PME-PM)/18,(PMF-PM)/18)
         DC    AL1((PMG-PM)/18,(PMH-PM)/18,(PMI-PM)/18)
         DC    7AL1((PMBL-PM)/18)
         DC    AL1((PMJ-PM)/18,(PMK-PM)/18,(PML-PM)/18)
         DC    AL1((PMM-PM)/18,(PMN-PM)/18,(PMO-PM)/18)
         DC    AL1((PMP-PM)/18,(PMQ-PM)/18,(PMR-PM)/18)
         DC    8AL1((PMBL-PM)/18)
         DC    AL1((PMS-PM)/18,(PMT-PM)/18,(PMU-PM)/18)
         DC    AL1((PMV-PM)/18,(PMW-PM)/18,(PMX-PM)/18)
         DC    AL1((PMY-PM)/18,(PMZ-PM)/18)
         DC    6AL1((PMBL-PM)/18)
         DC    AL1((PM0-PM)/18,(PM1-PM)/18,(PM2-PM)/18)
         DC    AL1((PM3-PM)/18,(PM4-PM)/18,(PM5-PM)/18)
         DC    AL1((PM6-PM)/18,(PM7-PM)/18,(PM8-PM)/18,(PM9-PM)/18)
         DC    6AL1((PMBL-PM)/18)
         EJECT
***
***      TABELLE DER PRINTMASKEN  ( 12 * 12 BITS JE ZEICHEN )
***
PM       EQU   *
PMBL     DC    18X'00'                                      BLANK
PMA      DC    XL18'7FEFFFC03C03C03FFFFFFC03C03C03C03C03'   A
PMB      DC    XL18'FFEFFFC03C03C06FFCFFCC06C03C03FFFFFE'   B
PMC      DC    XL18'7FEFFFC03C00C00C00C00C00C00C03FFF7FE'   C
PMD      DC    XL18'FF8FFCC06C03C03C03C03C03C03C06FFCFF8'   D
PME      DC    XL18'FFFFFFC00C00C00FF0FF0C00C00C00FFFFFF'   E
PMF      DC    XL18'FFFFFFC00C00C00FF0FF0C00C00C00C00C00'   F
PMG      DC    XL18'7FEFFFC03C00C00C00C1FC1FC03C03FFF7FE'   G
PMH      DC    XL18'C03C03C03C03C03FFFFFFC03C03C03C03C03'   H
PMI      DC    XL18'7FE7FE0600600600600600600600607FE7FE'   I
PMJ      DC    XL18'3FF3FF030030030030030030C30C30FF07E0'   J
PMK      DC    XL18'C03C06C0CC18C30FE0FE0C30C18C0CC06C03'   K
PML      DC    XL18'C00C00C00C00C00C00C00C00C00C00FFFFFF'   L
PMM      DC    XL18'C03E07F0FD9BCF3C63C03C03C03C03C03C03'   M
PMN      DC    XL18'C03E03F03D83CC3C63C33C1BC0FC07C03C01'   N
PMO      DC    XL18'FFFFFFC03C03C03C03C03C03C03C03FFFFFF'   O
PMKO     DC    XL18'0000000000000000000000000F00F0030020'   ,
PMP      DC    XL18'FFEFFEC03C03C03FFFFFEC00C00C00C00C00'   P
PMQ      DC    XL18'7FEFFFC03C03C03C03C03C33C1EC0CFFE7E3'   Q
PMR      DC    XL18'FFEFFFC03C03C03FFFFFEC30C18C0CC06C03'   R
PMS      DC    XL18'7FEFFFC03C00E007FC3FE007003C03FFF7FE'   S
PMT      DC    XL18'FFFFFF060060060060060060060060060060'   T
PMU      DC    XL18'C03C03C03C03C03C03C03C03C03C03FFF7FE'   U
PMV      DC    XL18'C03C0360660630C30C1981980F00F0060060'   V
PMW      DC    XL18'C03C03C03C03C03C63CF3D9BF0FE07C03801'   W
PMX      DC    XL18'C03C0360630C1980F00F019830C606C03C03'   X
PMY      DC    XL18'C03C0360630C1980F0060060060060060060'   Y
PMZ      DC    XL18'FFFFFF00600C0180300600C01803007FFFFF'   Z
PM0      DC    XL18'3FC7FEC03C03C03C03C03C03C03C037FE3FC'   0
PM1      DC    XL18'0600E01E00600600600600600600607FE7FE'   1
PM2      DC    XL18'7FEFFFC03003003006018060180600FFFFFF'   2
PM3      DC    XL18'7FEFFFC0300300301E01E003003C03FFF7FE'   3
PM4      DC    XL18'0380780D81983187FFFFF018018018018018'   4
PM5      DC    XL18'FFFFFFC00C00C00FF8FFC006003003FFFFFE'   5
PM6      DC    XL18'7FEFFFC03C00C00FFEFFFC03C03C03FFF7FE'   6
PM7      DC    XL18'FFFFFEC0C018030060060060060060060060'   7
PM8      DC    XL18'7FEFFFC03C036063FC3FC606C03C03FFF7FE'   8
PM9      DC    XL18'7FEFFFC03C03C03FFFFFF003003C03FFF7FE'   9
PMSS     DC    XL18'00000600C0180300600C0180300600C00000'   /
PMHK     DC    XL18'060060060000000000000000000000000000'   '
PMEQ     DC    XL18'000000000FFFFFF000000FFFFFF000000000'   =
PMKZ     DC    XL18'0C00600300180180180180180180300600C0'   )
PMPT     DC    XL18'0000000000000000000000000000F00F00F0'   .
PMPL     DC    XL18'0000000600600607FE7FE060060060000000'   +
PMST     DC    XL18'000C0360630C198FFFFFF19830C606C0300'    *
PMDO     DC    XL18'0607FEFFFC60C60FFE7FF063063FFF7FE060'   $
PMMI     DC    XL18'0000000000000007FE7FE000000000000000'   -
PMKA     DC    XL18'0300600C01801801801801801800C0060030'   (
PMKU     DC    XL18'0F81FC18C0D80710730DE18C31C6367E33C3'   &
PMAZ     DC    XL18'198198198000000000000000000000000000'   "
PMUS     DC    XL18'000000000000000000000000000000FFFFFF'   _
PMDP     DC    XL18'0000F00F00F00F00000000F00F00F00F0000'   :
PMOR     DC    XL18'060060060060060060060060060060060060'   ×
PMGT     DC    XL18'F00FC00F003C00E00300300E03C0F0FC0F00'   >
PMFZ     DC    XL18'1F83FC30C0180F018030C3FC1F8000060060'   ?
PMNM     DC    XL18'198198198F9FF9F000000F9FF9F198198198'   #
PMPZ     DC    XL18'00060390690C9189306660C9189309609C06'   %
PMKL     DC    XL18'7FEFFFC030037E3FF3C33C33C33C33FFF7FE'   @
PMSM     DC    XL18'0000000000F00F00F00000000F00F0030020'   ;
PMLT     DC    XL18'00F03F0F03C0700C00C007003C00F003F00F'   <
PMNT     DC    XL18'000000000000000FFFFFF003003000000000'   ^
         DCBD  DSORG=PS
         END

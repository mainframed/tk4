PROC 0
GLOBAL &HEXVALUE
GLOBAL &VALUE
/**********************************************************************/
/*     H     H   EEEEEEE    AAAAA    DDDDDD    EEEEEEE   RRRRRR       */
/*     H     H   E         A     A   D     D   E         R     R      */
/*     HHHHHHH   EEEEEEE   AAAAAAA   D     D   EEEEEEE   RRRRRR       */
/*     H     H   E         A     A   D     D   E         R   R        */
/*     H     H   EEEEEEE   A     A   DDDDDD    EEEEEEE   R     R      */
/**********************************************************************/
/*  CLIST NAME: VTAM24            REL/DATE: 2.1/08.15.79              */
/*                                                                    */
/*  DOC:    THIS CLIST FINDS AND LISTS THE CRPL'S  LSCB'S  AND FSB'S. */
/*  SYMBOLS EQUATED: BPDTY=BUFFER POOL DIRECTORY,                     */
/*  SYMBOLS FOUND:                                                    */
/*  RETURN:                                                           */
/*  DEPENDENCIES: 1) THIS CLIST REQUIRES THAT COMMAND                 */
/*                   CLEAR BE INSTALLED IN YOUR ENVIRONMENT.        */
/*  USE:          2) THIS CLIST REQUIRES THAT CLIST 'HEX' BE          */
/*                   INSTALLED IN YOUR ENVIRONMENT.                   */
/*SJM******************************************************************/
         SETD NOTERMINAL PRINT
         SET &TERM=NOTERMINAL
         SETD NODISPLAY
         SETD DISPLAY(STORAGE)
         EQ BPDTY ATCVT+80%
         CLEAR
          WRITE THIS FUNCTION CURRENTLY LOOKS FOR:
          WRITE CRPL, LSCB, FSB.
          WRITE DO YOU WISH THE WHOLE CRPL DISPLAYED?
          WRITE (DEFAULT IS TO DISPLAY ONLY THE DAF AND TO
          WRITE  SEND THE WHOLE CRPL TO THE PRINT DATASET)
          WRITENR ENTER Y/(N) ===>
          READ &DIS
          IF &DIS=Y THEN DO
          SET &TERM=TERMINAL
          END
          CLEAR
          IF &DIS^=Y THEN +
          WRITE THIS FUNCTION WILL LIST DAF"S FOR ACTIVE CRPL"S.
NOTE 'THE FOLLOWING ARE THE ACTIVE CRPLS' PAGE &TERM PRINT
          SET &RPL07=0
          SET &RPL11=0
          SET &RPL12=0
          SET &RPL13=0
          SET &RPL15=0
          SET &RPL16=0
          SET &RPL17=0
          SET &RPL19=0
          SET &RPL1A=0
          SET &RPL1B=0
          SET &RPL1D=0
          SET &RPL1E=0
          SET &RPL1F=0
          SET &RPL21=0
          SET &RPL22=0
          SET &RPL23=0
          SET &RPL24=0
          SET &RPL25=0
          SET &RPL27=0
          SET &RPL28=0
         SETD  LEN(1)
          SET &CRPLCNT=0
          SET &CRPLOUT=0
          EQUATE BUFFACE1 408.%+80%+148%+8%
          EQUATE BUFFACE2 408.%+80%+148%+C%
          EQUATE BUFFCRPL1 408.%+80%+108%+8%
          EQUATE BUFFCRPL2 408.%+80%+108%+C%
          EQUATE BUFFIO1 408.%+80%+A8%+8%
          EQUATE BUFFIO2 408.%+80%+A8%+C%
          EQUATE BUFFNP01 408.%+80%+E8%+8%
          EQUATE BUFFNP02 408.%+80%+E8%+C%
          FIND X'FF0070' ADDR(BUFFCRPL1:BUFFCRPL2) MASK(X'FF0070')
          IF &LASTCC=4 THEN GOTO ENDCRPL
          EVAL X+44 LEN(1)
          IF &LASTCC^=255 THEN GOTO FINDCRPL
          SET &CRPLCNT=&CRPLCNT+1
         COMPARE VALUE(X'07') WITH(ADDRESS(X+1)) LENGTH(1)
         IF &LASTCC=0 THEN SET &RPL07=&RPL07+1
         COMPARE VALUE(X'11') WITH(ADDRESS(X+1)) LENGTH(1)
         IF &LASTCC=0 THEN SET &RPL11=&RPL11+1
         COMPARE VALUE(X'12') WITH(ADDRESS(X+1)) LENGTH(1)
         IF &LASTCC=0 THEN SET &RPL12=&RPL12+1
         COMPARE VALUE(X'13') WITH(ADDRESS(X+1)) LENGTH(1)
         IF &LASTCC=0 THEN SET &RPL13=&RPL13+1
         COMPARE VALUE(X'15') WITH(ADDRESS(X+1)) LENGTH(1)
         IF &LASTCC=0 THEN SET &RPL15=&RPL15+1
         COMPARE VALUE(X'16') WITH(ADDRESS(X+1)) LENGTH(1)
         IF &LASTCC=0 THEN SET &RPL16=&RPL16+1
         COMPARE VALUE(X'17') WITH(ADDRESS(X+1)) LENGTH(1)
         IF &LASTCC=0 THEN SET &RPL17=&RPL17+1
         COMPARE VALUE(X'19') WITH(ADDRESS(X+1)) LENGTH(1)
         IF &LASTCC=0 THEN SET &RPL19=&RPL19+1
         COMPARE VALUE(X'1A') WITH(ADDRESS(X+1)) LENGTH(1)
         IF &LASTCC=0 THEN SET &RPL1A=&RPL1A+1
         COMPARE VALUE(X'1B') WITH(ADDRESS(X+1)) LENGTH(1)
         IF &LASTCC=0 THEN SET &RPL1B=&RPL1B+1
         COMPARE VALUE(X'1D') WITH(ADDRESS(X+1)) LENGTH(1)
         IF &LASTCC=0 THEN SET &RPL1D=&RPL1D+1
         COMPARE VALUE(X'1E') WITH(ADDRESS(X+1)) LENGTH(1)
         IF &LASTCC=0 THEN SET &RPL1E=&RPL1E+1
         COMPARE VALUE(X'1F') WITH(ADDRESS(X+1)) LENGTH(1)
         IF &LASTCC=0 THEN SET &RPL1F=&RPL1F+1
         COMPARE VALUE(X'21') WITH(ADDRESS(X+1)) LENGTH(1)
         IF &LASTCC=0 THEN SET &RPL21=&RPL21+1
         COMPARE VALUE(X'22') WITH(ADDRESS(X+1)) LENGTH(1)
         IF &LASTCC=0 THEN SET &RPL22=&RPL22+1
         COMPARE VALUE(X'23') WITH(ADDRESS(X+1)) LENGTH(1)
         IF &LASTCC=0 THEN SET &RPL23=&RPL23+1
         COMPARE VALUE(X'24') WITH(ADDRESS(X+1)) LENGTH(1)
         IF &LASTCC=0 THEN SET &RPL24=&RPL24+1
         COMPARE VALUE(X'25') WITH(ADDRESS(X+1)) LENGTH(1)
         IF &LASTCC=0 THEN SET &RPL25=&RPL25+1
         COMPARE VALUE(X'27') WITH(ADDRESS(X+1)) LENGTH(1)
         IF &LASTCC=0 THEN SET &RPL27=&RPL27+1
         COMPARE VALUE(X'28') WITH(ADDRESS(X+1)) LENGTH(1)
         IF &LASTCC=0 THEN SET &RPL28=&RPL28+1
         COMPARE VALUE(X'FF') WITH(ADDRESS(X+43)) MASK(X'04') LENGTH(1)
          IF &LASTCC=0 THEN DO
               SET &DAF=&STR(NLST)
               GOTO NIBLIST1
               END
          EVAL X+25 LEN(2) BIT
          SET &CRPLDAF=&LASTCC
          %HEX &CRPLDAF
          SET &DAF=&HEXVALUE
          IF &DAF=0 THEN SET &DAF=&STR(0000)
NIBLIST1: EQUATE CRPL&DAF.X&CRPLCNT X-1 LEN(116)
          IF &DIS=Y THEN WRITE
          LIST CRPL&DAF.X&CRPLCNT &TERM PRINT
          IF &DIS^=Y THEN DO
          WRITENR &DAF
          END
          SET &CRPLOUT=&CRPLOUT+1
          IF &CRPLOUT >= 11 THEN DO
                WRITE
                SET &CRPLOUT=0
                END
FINDCRPL: FIND X'FF0070' ADDR(X+3:BUFFCRPL2) MASK(X'FF0070')
          IF &LASTCC=4 THEN GOTO ENDCRPL
          EVAL X+44 LEN(1)
          IF &LASTCC^=255 THEN GOTO FINDCRPL
          SET &CRPLCNT=&CRPLCNT+1
         COMPARE VALUE(X'07') WITH(ADDRESS(X+1)) LENGTH(1)
         IF &LASTCC=0 THEN SET &RPL07=&RPL07+1
         COMPARE VALUE(X'11') WITH(ADDRESS(X+1)) LENGTH(1)
         IF &LASTCC=0 THEN SET &RPL11=&RPL11+1
         COMPARE VALUE(X'12') WITH(ADDRESS(X+1)) LENGTH(1)
         IF &LASTCC=0 THEN SET &RPL12=&RPL12+1
         COMPARE VALUE(X'13') WITH(ADDRESS(X+1)) LENGTH(1)
         IF &LASTCC=0 THEN SET &RPL13=&RPL13+1
         COMPARE VALUE(X'15') WITH(ADDRESS(X+1)) LENGTH(1)
         IF &LASTCC=0 THEN SET &RPL15=&RPL15+1
         COMPARE VALUE(X'16') WITH(ADDRESS(X+1)) LENGTH(1)
         IF &LASTCC=0 THEN SET &RPL16=&RPL16+1
         COMPARE VALUE(X'17') WITH(ADDRESS(X+1)) LENGTH(1)
         IF &LASTCC=0 THEN SET &RPL17=&RPL17+1
         COMPARE VALUE(X'19') WITH(ADDRESS(X+1)) LENGTH(1)
         IF &LASTCC=0 THEN SET &RPL19=&RPL19+1
         COMPARE VALUE(X'1A') WITH(ADDRESS(X+1)) LENGTH(1)
         IF &LASTCC=0 THEN SET &RPL1A=&RPL1A+1
         COMPARE VALUE(X'1B') WITH(ADDRESS(X+1)) LENGTH(1)
         IF &LASTCC=0 THEN SET &RPL1B=&RPL1B+1
         COMPARE VALUE(X'1D') WITH(ADDRESS(X+1)) LENGTH(1)
         IF &LASTCC=0 THEN SET &RPL1D=&RPL1D+1
         COMPARE VALUE(X'1E') WITH(ADDRESS(X+1)) LENGTH(1)
         IF &LASTCC=0 THEN SET &RPL1E=&RPL1E+1
         COMPARE VALUE(X'1F') WITH(ADDRESS(X+1)) LENGTH(1)
         IF &LASTCC=0 THEN SET &RPL1F=&RPL1F+1
         COMPARE VALUE(X'21') WITH(ADDRESS(X+1)) LENGTH(1)
         IF &LASTCC=0 THEN SET &RPL21=&RPL21+1
         COMPARE VALUE(X'22') WITH(ADDRESS(X+1)) LENGTH(1)
         IF &LASTCC=0 THEN SET &RPL22=&RPL22+1
         COMPARE VALUE(X'23') WITH(ADDRESS(X+1)) LENGTH(1)
         IF &LASTCC=0 THEN SET &RPL23=&RPL23+1
         COMPARE VALUE(X'24') WITH(ADDRESS(X+1)) LENGTH(1)
         IF &LASTCC=0 THEN SET &RPL24=&RPL24+1
         COMPARE VALUE(X'25') WITH(ADDRESS(X+1)) LENGTH(1)
         IF &LASTCC=0 THEN SET &RPL25=&RPL25+1
         COMPARE VALUE(X'27') WITH(ADDRESS(X+1)) LENGTH(1)
         IF &LASTCC=0 THEN SET &RPL27=&RPL27+1
         COMPARE VALUE(X'28') WITH(ADDRESS(X+1)) LENGTH(1)
         IF &LASTCC=0 THEN SET &RPL28=&RPL28+1
         COMPARE VALUE(X'FF') WITH(ADDRESS(X+43)) MASK(X'04') LENGTH(1)
          IF &LASTCC=0 THEN DO
               SET &DAF=&STR(NLST)
               GOTO NIBLIST2
               END
          EVAL X+25 LEN(2) BIT
          SET &CRPLDAF=&LASTCC
  %HEX &CRPLDAF
  SET &DAF=&HEXVALUE
         IF &DAF=0 THEN SET &DAF=&STR(0000)
NIBLIST2: EQUATE CRPL&DAF.X&CRPLCNT X-1 LEN(116)
          IF &DIS=Y THEN WRITE
          LIST CRPL&DAF.X&CRPLCNT &TERM PRINT
          IF &DIS^=Y THEN DO
          WRITENR &DAF
          END
          SET &CRPLOUT=&CRPLOUT+1
          IF &CRPLOUT >= 11 THEN DO
                WRITE
                SET &CRPLOUT=0
                END
          GOTO FINDCRPL
ENDCRPL:  WRITE END OF CRPL SCAN.
         SETD LEN(4)
         NOTE 'CRPL SUMMARY BY TYPE:' PAGE
         NOTE '  JESFORMT = &RPL07 +
                 WRITE    = &RPL11 +
                 RESET    = &RPL12 +
                 DO       = &RPL13 +
               SETLOGON = &RPL15'
         NOTE '  SIMLOGON = &RPL16 +
                 OPNDST   = &RPL17 +
                 CHANGE   = &RPL19 +
                 INQUIRE  = &RPL1A +
               INTERPRT = &RPL1B '
         NOTE  ' READ     = &RPL1D +
                 SOLICIT  = &RPL1E +
                 CLSDST   = &RPL1F +
                 CLOSEACB = &RPL21 +
               SEND     = &RPL22 '
         NOTE  ' RECEIVE  = &RPL23  +
                 RESETSR  = &RPL24  +
                 SESSIONC = &RPL25  +
                 SENDCMD  = &RPL27  +
               RCVCMD   = &RPL28'
LSCB:    WRITE SEARCHING FOR LSCB'S.
         WRITE DO YOU WISH THE LSCBS DISPLAYED?
         WRITE (DEFAULT IS TO JUST GIVE A TOTAL AND
         WRITE  SEND THE LSCB TO THE PRINT DATASET)
         WRITENR ENTER Y/(N) ===>
         READ &DIS
         SET &TERM=NOTERMINAL
         IF &DIS=Y THEN DO
         SET &TERM=TERMINAL
         END
NOTE 'THE FOLLOWING ARE LSCBS ' PAGE &TERM PRINT
         SET &LSCBCNT=0
          FIND X'DF20' ADDR(BUFFACE1:BUFFACE2) BDY(4)
          IF &LASTCC=4 THEN GOTO ENDLSCB
          SET &LSCBCNT=&LSCBCNT+1
          EQUATE LSCB&LSCBCNT X LEN(32)
          IF &DIS=Y THEN WRITE
          LIST LSCB&LSCBCNT &TERM PRINT
FINDLSCB: FIND X'DF20' ADDR(X+1:BUFFACE2) BDY(4)
          IF &LASTCC=4 THEN GOTO ENDLSCB
          SET &LSCBCNT=&LSCBCNT+1
          EQUATE LSCB&LSCBCNT X LEN(32)
          IF &DIS=Y THEN WRITE
          LIST LSCB&LSCBCNT &TERM PRINT
          GOTO FINDLSCB
ENDLSCB:  WRITE END OF LSCB SCAN. NUMBER LSCB = &LSCBCNT .
FSB:     WRITE STARTING SEARCH OF IOBUF FOR FSB'S.
         WRITE DO YOU WISH THE FSBS DISPLAYED?
         SET &TERM=NOTERMINAL
         WRITE (DEFAULT IS TO SEND THE FSB TO THE PRINT DATASET
         WRITE  AND ONLY DISPLAY THE TOTAL NUMBER)
         WRITENR ENTER Y/(N) ===>
         READ &DIS
         IF &DIS=Y THEN DO
         SET &TERM=TERMINAL
         END
NOTE 'THE FOLLOWING ARE FSBS FROM THE IOBUFFER POOL' PAGE +
      &TERM PRINT
         SET &FSBCNT=0
          FIND X'022C' ADDR(BUFFIO1:BUFFIO2) BDY(4)
          IF &LASTCC=4 THEN GOTO ENDFSB
          SET &FSBCNT=&FSBCNT+1
         EVAL X+A LEN(2)
         SET &FSBDAF=&LASTCC
         %HEX &FSBDAF
         SET &DAF=&HEXVALUE
          EQUATE FSB&DAF.X&FSBCNT X+0 LEN(324)
          IF &DIS=Y THEN WRITE
          LIST FSB&DAF.X&FSBCNT &TERM PRINT
FINDFSB: FIND X'022C' ADDR(X+1:BUFFIO2) BDY(4)
          IF &LASTCC=4 THEN GOTO ENDFSB
          SET &FSBCNT=&FSBCNT+1
         EVAL X+A LEN(2)
         SET &FSBDAF=&LASTCC
         %HEX &FSBDAF
         SET &DAF=&HEXVALUE
          EQUATE FSB&DAF.X&FSBCNT X+0 LEN(324)
          IF &DIS=Y THEN WRITE
          LIST FSB&DAF.X&FSBCNT &TERM PRINT
          GOTO FINDFSB
ENDFSB:   WRITE END OF FSB SCAN OF IOBUF. NUMBER FSB = &FSBCNT .
FSB2:    WRITE STARTING SEARCH OF ACEBUF FOR FSB'S.
NOTE 'THE FOLLOWING ARE THE FSBS FROM THE ACE BUFFER POOL' PAGE +
      &TERM PRINT
         SET &FSBCNT=0
          FIND X'022C' ADDR(BUFFACE1:BUFFACE2) BDY(4)
          IF &LASTCC=4 THEN GOTO ENDFSB2
          SET &FSBCNT=&FSBCNT+1
         EVAL X+A LEN(2)
         SET &FSBDAF=&LASTCC
         %HEX &FSBDAF
         SET &DAF=&HEXVALUE
          EQUATE FSB&DAF.Y&FSBCNT X+0 LEN(44)
          IF &DIS=Y THEN WRITE
          LIST FSB&DAF.Y&FSBCNT &TERM PRINT
FNDFSB2: FIND X'022C' ADDR(X+1:BUFFACE2) BDY(4)
          IF &LASTCC=4 THEN GOTO ENDFSB2
          SET &FSBCNT=&FSBCNT+1
         EVAL X+A LEN(2)
         SET &FSBDAF=&LASTCC
         %HEX &FSBDAF
         SET &DAF=&HEXVALUE
          EQUATE FSB&DAF.Y&FSBCNT X+0 LEN(44)
          IF &DIS=Y THEN WRITE
          LIST FSB&DAF.Y&FSBCNT &TERM PRINT
          GOTO FNDFSB2
ENDFSB2:  WRITE END OF FSB ACEBUF SCAN. NUMBER FSB = &FSBCNT .
          GOTO FUNC5END
          SETD DISPLAY VERIFY
FUNC5END: WRITE VTAM24 COMPLETED.

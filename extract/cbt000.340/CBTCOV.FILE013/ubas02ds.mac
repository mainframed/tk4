ZS905FHL CSECT
         REG
         XSAVE (R11,R12),SVA,ZS905FHL ZIMPELMANN
         L     R3,0(R1)
         LA    R3,0(R3)
         USING Y1,R3
         LA    R5,8
         CH    R5,Y1MSGC
         BL    EKLFHL
         L     R4,Y1SVR1
         L     R8,0(R4)
         LH    R4,0(R8)
         LA    R5,2(R8)
         MVI   MESSAGE1,C' '
         MVC   MESSAGE1+1(L'MESSAGE1-1),MESSAGE1
         BCTR  R4,0
         EX    R4,EXMVC1
         CALL  ZS905WRF,((R3),MESSAGE),VL
EKLFHL   EQU   *
         LH    R4,Y1MSGC
         BCTR  R4,0
         SLL   R4,2                   MULTIPLY BY 4
         LA    R5,MSGADR(R4)
         L     R5,0(R5)
         MVI   MESSAGE1,C' '
         MVC   MESSAGE1+1(L'MESSAGE1-1),MESSAGE1
         IC    R7,0(R5)
         LA    R5,1(R5)
         L     R15,Y1SR15
         LTR   R15,R15
         BZ    MESSMOV
         MVC   RETFLD,=C'RET-CODE'
         ST    R15,VWORT
         UNPK  HEXAFLD(9),VWORT(5)
         NC    HEXAFLD,=8XL1'0F'
         TR    HEXAFLD,TRTAB1
         MVC   CONDCOD,HEXAFLD+4
MESSMOV  EQU   *
         BCTR  R7,0
         EX    R7,EXMVC1
         MVC   Y1COCO,=H'4'
         MVI   ASA,X'40'
         LA    R9,58
         CH    R9,Y1MSGC
         BNL   WRTROUT
         CLI   Y1FUEB,Y1FYES              UEBERSCHRIFT SCHON GEDRUCKT
         BE    NOUEBER
         CALL  TDATE,(ZEIT,DATUM)
         AP    Y1SEIZ,=P'+1'
         MVC   SEITNR,MASKE
         ED    SEITNR,Y1SEIZ
         CALL  ZS905WRF,((R3),ZEILE1),VL
         CALL  ZS905WRF,((R3),ZEILE2),VL
         CALL  ZS905WRF,((R3),ZEILE3),VL
         MVI   Y1FUEB,Y1FYES
NOUEBER  EQU   *
         MVI   ASA,C'-'
         MVC   Y1COCO,=H'8'
WRTROUT  EQU   *
         CALL  ZS905WRF,((R3),MESSAGE),VL
         XRETURN 0
         EJECT
MSGADR   DS    0F
         DC    A(MESS1)
         DC    A(MESS2)
         DC    A(MESS3)
         DC    A(MESS4)
         DC    A(MESS5)
         DC    A(MESS6)
         DC    A(MESS7)
         DC    A(MESS8)
         DC    A(MESS9)
         DC    A(MESS10)
         DC    A(MESS11)
         DC    A(MESS12)
         DC    A(MESS13)
         DC    A(MESS14)
         DC    A(MESS15)
         DC    A(MESS16)
         DC    A(MESS17)
         DC    A(MESS18)
         DC    A(MESS19)
         DC    A(MESS20)
         DC    A(MESS21)
         DC    A(MESS22)
         DC    A(MESS23)
         DC    A(MESS24)
         DC    A(MESS25)
         DC    A(MESS26)
         DC    A(MESS27)
         DC    A(MESS28)
         DC    A(MESS29)
         DC    A(MESS30)
         DC    A(MESS31)
         DC    A(MESS32)
         DC    A(MESS33)
         DC    A(MESS34)
         DC    A(MESS35)
         DC    A(MESS36)
         DC    A(MESS37)
         DC    A(MESS38)
         DC    A(MESS39)
         DC    A(MESS40)
         DC    A(MESS41)
         DC    A(MESS42)
         DC    A(MESS43)
         DC    A(MESS44)
         DC    A(MESS45)
         DC    A(MESS46)
         DC    A(MESS47)
         DC    A(MESS48)
         DC    A(MESS49)
         DC    A(MESS50)
         DC    A(MESS51)
         DC    A(MESS52)
         DC    A(MESS53)
         DC    A(MESS54)
         DC    A(MESS55)
         DC    A(MESS56)
         DC    A(MESS57)
         DC    A(MESS58)
         DC    A(MESS59)
         DC    A(MESS60)
         DC    A(MESS61)
         DC    A(MESS62)
         DC    A(MESS63)
         DC    A(MESS64)
         DC    A(MESS65)
         DC    A(MESS66)
         DC    A(MESS67)
         DC    A(MESS68)
         DC    A(MESS69)
         DC    A(MESS70)
         DC    A(MESS71)
         DC    A(MESS72)
         DC    A(MESS73)
         DC    A(MESS74)
         DC    A(MESS75)
         DC    A(MESS76)
         DC    A(MESS77)
         DC    A(MESS78)
MSGTXT   DS    0CL1
MESS1    DC    AL1(L'MSGTXT1)
MSGTXT1  DC    C'*ZS905 PARAMETER NICHT DURCH KOMMA GETRENNT'
MESS2    DC    AL1(L'MSGTXT2)
MSGTXT2  DC    C'*ZS905 FALSCHER PARAMETER IN DER PARAMETERKARTE'
MESS3    DC    AL1(L'MSGTXT3)
MSGTXT3  DC    C'*ZS905 LINES-PARAMETER GROESSER 4 STELLEN'
MESS4    DC    AL1(L'MSGTXT4)
MSGTXT4  DC    C'*ZS905 LINES-PARAMETER NICHT NUMERISCH'
MESS5    DC    AL1(L'MSGTXT5)
MSGTXT5  DC    C'*ZS905 EING-SIZE > 3 STELLEN'
MESS6    DC    AL1(L'MSGTXT6)
MSGTXT6  DC    C'*ZS905 EING-SIZE NICHT NUMERISCH ODER TAB-SIZE FEHLT'
MESS7    DC    AL1(L'MSGTXT7)
MSGTXT7  DC    C'*ZS905 TAB-SIZE GROESSER 4 STELLEN'
MESS8    DC    AL1(L'MSGTXT8)
MSGTXT8  DC    C'*ZS905 TAB-SIZE NICHT NUMERISCH'
MESS9    DC    AL1(L'MSGTXT9)
MSGTXT9  DC    C'*ZS905 SYSIN-DATEI FEHLT'
MESS10   DC    AL1(L'MSGTXT10)
MSGTXT10 DC    C'*ZS905 LEERE EINGABEKARTE'
MESS11   DC    AL1(L'MSGTXT11)
MSGTXT11 DC    C'*ZS905 2.HOCHKOMMA FEHLT'
MESS12   DC    AL1(L'MSGTXT12)
MSGTXT12 DC    C'*ZS905 KEIN ZEICHEN ZWISCHEN DEN HOCHKOMATA'
MESS13   DC    AL1(L'MSGTXT13)
MSGTXT13 DC    C'*ZS905 UNDEF.PARAMETER IN EINGABE-KARTE'
MESS14   DC    AL1(L'MSGTXT14)
MSGTXT14 DC    C'*ZS905 UNDEF.PARAMETER IN DBD-KARTE'
MESS15   DC    AL1(L'MSGTXT15)
MSGTXT15 DC    C'*ZS905 DBD-NAME > 8 STELLEN'
MESS16   DC    AL1(L'MSGTXT16)
MSGTXT16 DC    C'*ZS905 RANDOM.ROUT.-NAME > 8 STELLEN'
MESS17   DC    AL1(L'MSGTXT17)
MSGTXT17 DC    C'*ZS905 ANK-PKT-FELD > 3 STELLEN'
MESS18   DC    AL1(L'MSGTXT18)
MSGTXT18 DC    C'*ZS905 ANK-PKT-FELD NICHT NUMERISCH'
MESS19   DC    AL1(L'MSGTXT19)
MSGTXT19 DC    C'*ZS905 RAA-BLOCK-FELD > 6 STELLEN'
MESS20   DC    AL1(L'MSGTXT20)
MSGTXT20 DC    C'*ZS905 RAA-BLOCK-FELD NICHT NUMERISCH'
MESS21   DC    AL1(L'MSGTXT21)
MSGTXT21 DC    C'*ZS905 DBD-MEMBER NICHT GEFUNDEN'
MESS22   DC    AL1(L'MSGTXT22)
MSGTXT22 DC    C'*ZS905 POINT-KARTE LEER'
MESS23   DC    AL1(L'MSGTXT23)
MSGTXT23 DC    C'*ZS905 PARAMETER IN POINT-KARTE NICHT ZULAESSIG'
MESS24   DC    AL1(L'MSGTXT24)
MSGTXT24 DC    C'*ZS905 BLOCKNR > 7STELLEN'
MESS25   DC    AL1(L'MSGTXT25)
MSGTXT25 DC    C'*ZS905 POINT-KARTE HAT MEHRERE BLOECKE'
MESS26   DC    AL1(L'MSGTXT26)
MSGTXT26 DC    C'*ZS905 POINT-KARTE HAT MEHRERE PARAMETER'
MESS27   DC    AL1(L'MSGTXT27)
MSGTXT27 DC    C'*ZS905 RBA-NR > 10 STELLEN'
MESS28   DC    AL1(L'MSGTXT28)
MSGTXT28 DC    C'*ZS905 POINT-KARTE HAT MEHRERE RBAS'
MESS29   DC    AL1(L'MSGTXT29)
MSGTXT29 DC    C'*ZS905 DBD-KARTE FEHLT ODER RAND-ROUTINE NICHT EXIST.'
MESS30   DC    AL1(L'MSGTXT30)
MSGTXT30 DC    C'*ZS905 KEY LAENGER 257 STELLEN'
MESS31   DC    AL1(L'MSGTXT31)
MSGTXT31 DC    C'*ZS905 PRINT-KARTE LEER'
MESS32   DC    AL1(L'MSGTXT32)
MSGTXT32 DC    C'*ZS905 KEIN POINT GESETZT'
MESS33   DC    AL1(L'MSGTXT33)
MSGTXT33 DC    C'*ZS905 BLOCK-BIS < BLOCK-VON'
MESS34   DC    AL1(L'MSGTXT34)
MSGTXT34 DC    C'*ZS905 PARAMETER IN PRINT-KARTE NICHT ZULAESSIG'
MESS35   DC    AL1(L'MSGTXT35)
MSGTXT35 DC    C'*ZS905 LENGTH + OFFSET > BLOCKSIZE'
MESS36   DC    AL1(L'MSGTXT36)
MSGTXT36 DC    C'*ZS905 OFFSET-PARAMETER > 10 STELLEN'
MESS37   DC    AL1(L'MSGTXT37)
MSGTXT37 DC    C'*ZS905 LENGTH-PARAMETER > 7 STELLEN'
MESS38   DC    AL1(L'MSGTXT38)
MSGTXT38 DC    C'*ZS905 COUNT-PARAMETER > 7 STELLEN'
MESS39   DC    AL1(L'MSGTXT39)
MSGTXT39 DC    C'*ZS905 BEI KEY ODER RBA NUR LENGTH-PARAMETER ERLAUBT'
MESS40   DC    AL1(L'MSGTXT40)
MSGTXT40 DC    C'*ZS905 EINGEGEBENE NUMMER NICHT HEXADEZIMAL'
MESS41   DC    AL1(L'MSGTXT41)
MSGTXT41 DC    C'*ZS905 EINGEGEBENE NUMMER NICHT NUMERISCH'
MESS42   DC    AL1(L'MSGTXT42)
MSGTXT42 DC    C'*ZS905 EINGEGEBENER OFFSET > BLOCKSIZE'
MESS43   DC    AL1(L'MSGTXT43)
MSGTXT43 DC    C'*ZS905 CHANGE-KARTE LEER'
MESS44   DC    AL1(L'MSGTXT44)
MSGTXT44 DC    C'*ZS905 PARAMETER IN CHANGE-KARTE UNZULAESSIG'
MESS45   DC    AL1(L'MSGTXT45)
MSGTXT45 DC    C'*ZS905 CHANGE-KARTE HAT MEHRERE BLOECKE'
MESS46   DC    AL1(L'MSGTXT46)
MSGTXT46 DC    C'*ZS905 CHANGE-KARTE UNVOLLSTAENDIG'
MESS47   DC    AL1(L'MSGTXT47)
MSGTXT47 DC    C'*ZS905 CHANGE-KARTE HAT MEHRERE RBAS'
MESS48   DC    AL1(L'MSGTXT48)
MSGTXT48 DC    C'*ZS905 OFFSET FEHLT IN DER CHANGE-KARTE'
MESS49   DC    AL1(L'MSGTXT49)
MSGTXT49 DC    C'*ZS905 OLDVALUE-PARAMETER FEHLT'
MESS50   DC    AL1(L'MSGTXT50)
MSGTXT50 DC    C'*ZS905 OLDVALUE-PARAMETER > 256 STELLEN'
MESS51   DC    AL1(L'MSGTXT51)
MSGTXT51 DC    C'*ZS905 NEWVALUE-PARAMETER FEHLT'
MESS52   DC    AL1(L'MSGTXT52)
MSGTXT52 DC    C'*ZS905 NEWVALUE-PARAMETER > 256 STELLEN'
MESS53   DC    AL1(L'MSGTXT53)
MSGTXT53 DC    C'*ZS905 OLD-,NEWVALUE HABEN VERSCHIEDENE LAENGEN'
MESS54   DC    AL1(L'MSGTXT54)
MSGTXT54 DC    C'*ZS905 KEINE BLOCK-NR IN BLOCK-TABELLE'
MESS55   DC    AL1(L'MSGTXT55)
MSGTXT55 DC    C'*ZS905 HEXADEZIMALER AUSDRUCK NICHT GERADE'
MESS56   DC    AL1(L'MSGTXT56)
MSGTXT56 DC    C'*ZS905 OFFSET-BIS < OFFSET-VON'
MESS57   DC    AL1(L'MSGTXT57)
MSGTXT57 DC    C'*ZS905 RANDOM.-ROUTINE NUR BEI HDAM-DB'
MESS58   DC    AL1(L'MSGTXT58)
MSGTXT58 DC    C'*ZS905 RMR-MEMBER NICHT GEFUNDEN'
MESS59   DC    AL1(L'MSGTXT59)
MSGTXT59 DC    C'*ZS905 SIZE-PARAMETER ZU KLEIN'
MESS60   DC    AL1(L'MSGTXT60)
MSGTXT60 DC    C'*ZS905 OLD-VALUE EINTRAG NICHT IM OFFSET'
MESS61   DC    AL1(L'MSGTXT61)
MSGTXT61 DC    C'*ZS905 READ UNVOLLSTAENDIG'
MESS62   DC    AL1(L'MSGTXT62)
MSGTXT62 DC    C'*ZS905 DATENENDE ERREICHT'
MESS63   DC    AL1(L'MSGTXT63)
MSGTXT63 DC    C'*ZS905 FEHLER BEIM VSAM-GET'
MESS64   DC    AL1(L'MSGTXT64)
MSGTXT64 DC    C'*ZS905 WRITE UNVOLLSTAENDIG'
MESS65   DC    AL1(L'MSGTXT65)
MSGTXT65 DC    C'*ZS905 FEHLER BEIM VSAM-PUT'
MESS66   DC    AL1(L'MSGTXT66)
MSGTXT66 DC    C'*ZS905 DD-KARTE FUER DATENBANK FEHLT'
MESS67   DC    AL1(L'MSGTXT67)
MSGTXT67 DC    C'*ZS905 DD-KARTE FUER USERLIB(RDM) FEHLT'
MESS68   DC    AL1(L'MSGTXT68)
MSGTXT68 DC    C'*ZS905 DD-KARTE FUER DBDLIB FEHLT'
MESS69   DC    AL1(L'MSGTXT69)
MSGTXT69 DC    C'*ZS905 IMAGE-COPY MIT TERM(YES) NICHT ERLAUBT'
MESS70   DC    AL1(L'MSGTXT70)
MSGTXT70 DC    C'*ZS905 DD-KARTE FUER IMAGECOPY-DUMP FEHLT'
MESS71   DC    AL1(L'MSGTXT71)
MSGTXT71 DC    C'*ZS905 EINGABE-SIZE ZU KLEIN'
MESS72   DC    AL1(L'MSGTXT72)
MSGTXT72 DC    C'*ZS905 BLOECKE IM ICDUMP UNVOLLSTAENDIG'
MESS73   DC    AL1(L'MSGTXT73)
MSGTXT73 DC    C'*ZS905 FEHLER IM 1.SHOWCAT'
MESS74   DC    AL1(L'MSGTXT74)
MSGTXT74 DC    C'*ZS905 FEHLER IM 2.SHOWCAT'
MESS75   DC    AL1(L'MSGTXT75)
MSGTXT75 DC    C'*ZS905 BLOECKE LIEGEN AUSSERHALB DATASET'
MESS76   DC    AL1(L'MSGTXT76)
MSGTXT76 DC    C'*ZS905 FEHLER BEIM VSAM-GENCB'
MESS77   DC    AL1(L'MSGTXT77)
MSGTXT77 DC    C'*ZS905 BLOCK OUTSIDE DATASET'
MESS78   DC    AL1(L'MSGTXT78)
MSGTXT78 DC    C'*ZS905 BLOCKSIZE = 0'
         SPACE 2
EXMVC1   MVC   MESSAGE1(0),0(R5)
HEXAFLD  DS    CL8
         DC    CL1' '
VWORT    DS    F
         DC    CL1' '
TRTAB1   DC    CL16'0123456789ABCDEF'
MASKE    DC    XL6'402020202120'
MESSAGE  DS    0CL133
ASA      DC    CL1' '
MESSAGE1 DC    CL132' '
         ORG   MESSAGE1+X'25'
RETFLD   DS    CL8
         DS    CL2
CONDCOD  DS    CL4
         ORG
         SPACE 2
ZEILE1   DS    0CL133
         DC    CL1'1'
         DC    C'ZS905 L01     DB-DUMP-UTILITY     '
DATUM    DC    CL10' '
         DC    CL5' '
ZEIT     DC    CL8' '
         DC    C'     SEITE'
SEITNR   DC    CL6' '
         DC    CL59' '
         SPACE 2
ZEILE2   DS    0CL133
         DC    CL1'-'
         DC    C' FEHLERMELDUNG,COND.-CODEAUSGABE : '
         DC    CL98' '
ZEILE3   DS    0CL133
         DC    CL1' '
         DC    C'---------------------------------- '
         DC    CL98' '
         EJECT
         LTORG
         EJECT
Y1       ZS905COM
         END

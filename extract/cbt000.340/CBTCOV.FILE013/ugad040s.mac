         TITLE 'SYSTAPCH,FIEDLER,CHANGE MODELL INFORMATION'
SYSTAPCH CSECT
*  THIS MODEL CHANGES TAPE DEVICE ENTRIES FROM 1600 BPI
*   TO 6250 BPI
*   MODEL 7 TO MODEL 8
*  INPUT IS SYSOUT FROM IEHLIST OR SIMILAR
*  OUTPUT IS ERROR MESSAGES
         GADBEGIN
         OPEN  (SYSIN,,SYSOUT,(OUTPUT))
         MVI   NEWMOD,XF32   MAKE NEW TYPE MODELL 8
         MVI   OLDMOD,XF34   TEST TYPE IS MODELL 7
A00      MVC   TEXTN(14),=C'CHANGE CATALOG'
         PUT   SYSOUT,BER
A10      GET   SYSIN
         LA    R1,1(R1)     TO GO TO THE IDCAMS LIST
         CLI   3(R1),C'.'
         BNE   A10       IF NOT ALIAS TONOT USE
         MVC   DSN,0(R1)   MOVE DSNAME
         LOCATE INDX
         LTR   R15,R15  SEE IF FOUND
         BNZ   NOTF
         LH    R2,AREA   LOOP COUNTER
         LA    R3,AREA+2  ADDRES OF DEVICE TYPE AREA
B10      CLC   0(1,R3),OLDMOD  SEE IF OLD
         BNE   A10     NO DO NOT USE
         MVC   0(1,R3),NEWMOD   MAKE NEW MODELL
         LA    R3,12(R3)      NEXT VOLUME
         BCT   R2,B10         LOOP
         CATALOG CATAL
         LTR   R15,R15
         BNZ   NOTF
         AP    Z1,=P'1'    ADD COUNTER
         B     A10
NOTF     MVC   TEXTN,DSN
         MVC   TEXT,T1
         PUT   SYSOUT,BER
         B     A10
EOF      OI    Z1+2,XF0F
         XC    TEXTN,TEXTN
         XC    TEXT,TEXT
         UNPK  TEXT(5),Z1
         MVC   TEXTN(23),=C'CHANGED CATALOG ENTRIES'
         PUT   SYSOUT,BER
EXIT     CLOSE (SYSIN,,SYSOUT)
         GADEOJ
INDX     CAMLST NAME,DSN,,AREA
CATAL    CAMLST RECAT,DSN,,AREA
DSN      DS    CL44
         DC    C' '    DELIMITER
         DS    0D
AREA     DS    265C
*        DC    H'1'  VOL COUNT
*        DC    X'34008003'  MODEL 7 (32 EQU MODEL 8)
*        DC    C'VOLSER'   VOLUM SERIAL NUMBER
*        DC    H'0'  SEQU NUMBER
BER      DS    0CL133
         DC    X'09'
TEXTN    DC    CL44' '
         DC    CL10' '
TEXT     DC    CL19' '
         DC    CL49' '
         DC    CL20' '                  REST DRUCKBEREICH
T1       DC    CL19'NOT FOUND'
OLDMOD   DC    X'00'
NEWMOD   DC    X'00'
Z1       DC    PL3'0'
SYSOUT   DCB   DSORG=PS,MACRF=(PM),DDNAME=SYSOUT,LRECL=133,            *
               BLKSIZE=133,RECFM=FM
SYSIN    DCB   DSORG=PS,DDNAME=SYSIN,EODAD=EOF,MACRF=(GL)
         END

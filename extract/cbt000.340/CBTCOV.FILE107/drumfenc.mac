++USERMOD(DF00001). /* DRUM FENCE IEANUC01 ILRIODRV */
++VER(Z038) FMID(JBB1326) PRE(UZ55891) .
++ZAP(ILRIODRV) .
   EXPAND ILRIODRV(48)
*
*    THIS MOD RESERVES USE OF FIXED HEAD PAGING DEVICES
*    FOR TSO PRIVATE FRAMES
*    MODULE......ILRIODRV
*    ROUTINE.....PARTESEL
*                 SCAN FIXED HEAD DEVICES
*                 WHERE FIXED HEAD CIRCULAR QUEUE POINTER
*                 IS TESTED FOR ZERO - UNDER LABEL @DL00930
*
 NAME IEANUC01 ILRIODRV
 VER 13A0 ....                ...    .......,.......  FIXED HEAD Q?
 VER 13A2 ....,....           ..     ........    NO..MOVEABLE Q
* VERIFY PATCH AREA
 VER 1E88 ....,....
* INSERT DRUM-FENCE INSTRUCTIONS.
 REP 13A2 45E0,8E88           BAL    R14,DRUMFENC  GOTO PATCH
 REP 1E88 05F0       DRUMFENC BALR   R15,0         BASE REGISTER
*
                     DRUMFEN0 EQU    *    EXIT WHEN CONDCODE 0
 REP 1E8A ....,....      00   ..     ........  REPLACE INSTRUCTION
 REP 1E8E 5810,91D0      04   L      R1,PSELAIA   -- AIA
 REP 1E92 9120,1009      08   TM     AIAFLG1(R1),AIAVIO   VIO?
 REP 1E96 4770,F022      0C   BNZ    DRUMFENX     YES..SKIP DEVICE
 REP 1E9A 4B10,F026      10   SH     R1,PCBLEN        -- PCB
 REP 1E9E 5810,1020      14   L      R1,PCBASCB(R1)   -- ASCB
 REP 1EA2 5810,1090      18   L      R1,ASCBOUCB(R1)  -- OUCB
 REP 1EA6 9120,1012      1C   TM     OUCBFL(R1),OUCBLOG  TSO USER?
 REP 1EAA 071E           20   BCR    1,R14       YES..RETURN
*                    DRUMFENX EQU    *
 REP 1EAC 19FF           22   CR     R15,R15     SET CONDCODE 0
 REP 1EAE 07FF           24   BR     R15         GO TO DRUMFEN0
 REP 1EB0 0024       PCBLEN   DC     H'36'       LENGTH OF PCB
*
//SMPCNTL   DD *
REJECT S(DF00001).
RECEIVE S(DF00001).
APPLY S(DF00001).
//

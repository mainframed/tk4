*          DATA SET AM011600   AT LEVEL 003 AS OF 01/26/78
*          DATA SET AM011600   AT LEVEL 002 AS OF 05/24/76
         MACRO
         ESACOD
         GBLA  &DOCLVL,&DOCNO(10),&CASENO(10),&DOCELSE(10),&DOCNT
.*             AUTHOR.   DON HIGGINS.
.*             DATE.     07/02/74.
.*             REMARKS.  SELECTION CONTROL STRUCTURE.
.*                       SEE DOCASE, CASE, ESAC, AND ESACOD.
.*                       SEE 'STRUCTURED FORTRAN TRANSLATOR' IN
.*                       IN 1975 FEBRUARY ACM SIGPLAN NOTICES.
.*       REV1 01/04/78 DSH - ELIMINATE RLDS BY USING BRANCH TABLE
         LCLA  &C
         AIF   (&DOCLVL LT 1).ERR1
CASEA&DOCNO(&DOCLVL) DS 0F
         AIF   (&DOCELSE(&DOCLVL) GT 0).GENELSE
         B     DC&DOCNO(&DOCLVL).END
         AGO   .GENCASE
.GENELSE ANOP
         B     DC&DOCNO(&DOCLVL).ELSE
.GENCASE ANOP
&C       SETA  &C+1
         AIF   (&C GT &CASENO(&DOCLVL)).GEND
         B     DC&DOCNO(&DOCLVL).C&C
         AGO   .GENCASE
.GEND    ANOP
DC&DOCNO(&DOCLVL).END EQU *
&DOCLVL SETA &DOCLVL-1
         MEXIT
.ERR1    MNOTE 8,'ESACOD - MISSING DOCASE'
         MEND

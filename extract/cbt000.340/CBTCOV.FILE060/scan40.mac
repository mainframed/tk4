1
 SCAN40                                                  FJP/28DEC78

 ABSTRACT - A QUICK PROGRAM TO PROVIDE AN OVERVIEW OF THE DATA SETS ON
          A TAPE, COPY FILES AND RECOVER DATA PAST THE FIRST END OF
          VOLUME INDICATOR.  INFORMATION PRESENTED INCLUDES RECORD AND
          BYTE COUNT, LENGTH ESTIMATE, DISPLAY OF THE FIRST 100 BYTES
          OF THE FIRST FOUR RECORDS OF EACH DATA SET, AND THE PHYSICAL
          TAPE FILE NUMBER.

 WARNINGS - WHEN DATA IS RECOVERED PAST THE END OF VOLUME INDICATOR,
          THE FIRST RECORD MAY HAVE BEEN TRUNCATED.  IF ACCEPTED, IT
          MAY LEAD TO PROBLEMS EVEN AFTER IT IS COPIED.  WHEN COPYING
          DATA SETS FROM A STANDARD LABEL TAPE, THE DATA SET SEQUENCE
          NUMBER STORED IN THE HEADER RECORD IS NOT CHANGED.  THIS, SO
          FAR, HAS CAUSED NO PROBLEMS BUT IS NOT SUPPORTED BY IBM.
          SOME OPERATIONS ARE BASED ON THE NUMBER OF TAPE MARKS
          ENCOUNTERED.  SEE THE IBM MANUAL: "TAPE LABELS" (GC28-6680)
          FOR A DESCRIPTION OF TAPE FORMATS WITH DIFFERENT LABELS.

 RESTRICTIONS - FOR USE WITH TAPE DATA SETS ONLY.

 DDNAMES - SYSPRINT - A FILE WHICH CONTAINS THE TAPE OVERVIEW REPORT
                    AND ANY I/O ERROR MESSAGES.

         INPUT    - THE FILE WHICH REFERENCES THE TAPE TO BE SCANNED
                    OR COPIED.

         OUTPUT   - IF REQUIRED, WILL CONTAIN THE COPY OF THE DATA
                    SETS REQUESTED FROM INPUT.

 PARAMETERS - ALL THE PARAMETERS ARE KEYWORDS.  THEIR MEANINGS,
            DEFAULT VALUES AND KEY WORDS ARE:

      COPY      - CREATE A COPY OF THE INPUT DATA SETS, LABELS AND
                  TAPE MARKS REQUESTED ON OUTPUT.  THE OUTPUT DD
                  STATEMENT MUST BE INCLUDED.  NOCOUNT MAY NOT BE
                  SPECIFIED.  BY DEFAULT THE PARAMETER IS ASSUMED NOT
                  TO BE IN EFFECT.

      EOVMOD    - PLACES THE INPUT DATA TO BE COPIED AFTER THE LAST
                  DATA SET ON OUTPUT.  THE OUTPUT DD STATEMENT MUST BE
                  INCLUDED.  THIS PARAMETER IMPLIES COPY.  NOCOUNT MAY
                  NOT BE SPECIFIED.  BY DEFAULT THE PARAMETER IS
                  ASSUMED NOT TO BE IN EFFECT.

      ERRLIMN   - THE MAXIMUM NUMBER OF I/O ERRORS ALLOWED BEFORE
                  PROCESSING IS TERMINATED IS SPECIFIED BY "N".  THE
                  DEFAULT IS ERRLIM50.

      LISTN     - THE NUMBER OF BLOCKS WHICH HAVE ONE LINE PRODUCED ON
                  SYSPRINT IS SPECIFIED BY "N".  THE DEFAULT IS LIST4.

      MAXEOVN   - PROCESSING WILL CONTINUE UNTIL "N" END OF VOLUME
                  INDICATORS HAVE BEEN FOUND.  PROCESSING WILL STOP
                  WHEN EITHER MAXTMN OR MAXEOVN IS EXCEEDED.  THE
                  DEFAULT VALUE IS MAXEOV1 AND IF SKIPEOVN IS USED
                  THEN MAXEOVN MUST BE ONE GREATER THAN SKIPEOVN.

      MAXTMN    - STOP PROCESSING AFTER "N" TAPE MARKS HAVE BEEN
                  ENCOUNTERED.  THIS WILL NOT GO PAST THE END OF
                  VOLUME INDICATOR.  THE DEFAULT IS TO PROCESS TO
                  THE END OF THE VOLUME.

      NOCOUNT   - TO SAVE I/O TIME THE COUNTING FEATURE MAY BE TURNED
                  OFF BY THIS PARAMETER.  THE NUMBER OF PHYSICAL
                  BLOCKS, THE MAXIMUM, AVERAGE AND MINIMUM BLOCK
                  SIZES, THE TAPE LENGTH AND THE TOTAL NUMBER OF
                  BYTES PROCESSED WILL NOT BE REPORTED.  THIS
                  PARAMETER MAY NOT BE USED WITH COPY OR EOVMOD.  BY
                  DEFAULT THE PARAMETER IS ASSUMED
                  NOT TO BE IN EFFECT.

      NOHEX     - DO NOT PRODUCE THE HEXADECIMAL EQUIVALENT OF THE
                  FIRST FEW LINES ON SYSPRINT.  BY DEFAULT THE
                  PARAMETER IS ASSUMED TO BE OFF.

      NOLIST    - FUNCTIONS THE SAME AS LIST0.  BY DEFAULT THE
                  PARAMETER IS ASSUMED NOT TO BE IN EFFECT.

      NOSUMMARY - DO NOT PRODUCE THE SUMMARY OF DATA SETS FOR A
                  STANDARD LABEL TAPE ON SYSPRINT.  BY DEFAULT THE
                  PARAMETER IS ASSUMED NOT TO BE IN EFFECT.

      NOVOLSER  - DURING A COPY OPERATION BETWEEM TWO STANDARD LABEL
                  TAPES, THE VOLUME HEADER LABEL WILL NOT BE COPIED.
                  BY DEFAULT THE PARAMETER IS ASSUMED NOT TO BE IN
                  EFFECT.

      SKIPEOVN  - PROCESSING WILL START AFTER "N" NUMBER OF END OF
                  VOLUME INDICATORS HAVE BEEN ENCOUNTERED.  INSURE
                  THAT MAXEOVN IS AT LEAST ONE GREATER THAN
                  SKIPEOVN.  THE DEFAULT IS SKIPEOV0.

      SKIPTMN   - START PROCESSING AFTER "N" TAPE MARKS HAVE BEEN
                  ENCOUNTERED.  PROCESSING WILL NOT START PAST THE
                  END OF VOLUME INDICATOR.  WHEN BOTH SKIPTMN AND
                  SKIPEOVN ARE SPECIFIED THE MAXIMUM AMOUNT OF
                  SKIPPING IS DONE.  THE DEFAULT IS SKIPTM0.

 DEFAULT PARAMETERS - LIST4,SKIPTM0,MAXEOV1,SKIPEOV0,ERRLIM50

 CONTROL STATEMENTS - NONE.

 RETURN CODES - THE JOB STEP RETURN CODE IS SET IF TAPESCAN ABNORMALLY
              TERMINATES.  THIS MAY BE TESTED BY LATER JOB STEPS AND
              THEIR EXECUTION BASED ON TAPESCAN'S SUCCESS.  THE
              RETURN CODE IS:

              8 - TAPESCAN HAS TERMINATED BEFORE PROCESSING HAS BEEN
                  COMPLETED.  THIS IS USUALLY CAUSED BY I/O ERRORS
                  ON INPUT.

 PROCEDURE - A PROCEDURE CALLED TAPESCAN IS AVAILABLE:

        //TAPESCAN PROC COPT=,VOL1=,VOL2=
        //TAPESCAN EXEC PGM=TAPESCAN,PARM='&COPT'
        //SYSPRINT DD  SYSOUT=*
        //INPUT    DD  UNIT=TAPE,LABEL=EXPDT=98000,DISP=SHR,
                       VOL=SER=&VOL1
        //OUTPUT   DD  UNIT=(TAPE,,DEFER),LABEL=EXPDT=98000,DISP=(,KEEP)
        //             VOL=SER=&VOL2

  EXAMPLES - USING THE PROCEDURE ANALYZE A NINE TRACK TAPE USING THE
             DEFAULTS:

             //TAPESCAN EXEC TAPESCAN,VOL1=TAPENR

             USING THE PROCEDURE COPY ONE 9-TRACK TAPE TO ANOTHER:

             //TAPECOPY EXEC TAPESCAN,PARM=COPY,
             //             VOL1=INPUT1,VOL2=OUTPT2

             USING THE PROCEDURE COPY THE DATA BETWEEN THE FIRST AND
             SECOND END OF VOLUME INDICATORS OF A BLP TAPE SKIPPING ANY
             BAD BLOCKS, TO THE THIRD FILE OF ANOTHER BLP TAPE:

             //TAPECOPY EXEC TAPESCAN,VOL1=BADTP,VOL2=COPYTP,
             //             PARM=(COPY,MAXEOV2,SKIPEOV1)
             //INPUT    DD  DCB=(EROPT=SKIP)
             //OUTPUT   DD  LABEL=(3,BLP)

             COPY THE FOURTH AND FIFTH FILES OF A STANDARD LABEL SEVEN
             TRACK 556 BPI EVEN PARITY TAPE NEEDING TRANSLATION AND NO
             CONVERSION, TO THE SECOND AND THIRD FILES OF A TAPE WHICH
             HAD ONLY ONE FILE.  DO NOT COPY THE VOLUME HEADER RECORD
             OR PRODUCE THE HEXADECIMAL OUTPUT ON SYSPRINT.  LIST THE
             FIRST 20 RECORDS OF THE INPUT DATA SETS.  STOP PROCESSING
             AFTER 5 I/O ERRORS OCCUR.

             //COPYTAPE EXEC PGM=TAPESCAN,REGION=80K,PARM=(COPY,NOVOLSER
             //             EOVMOD,SKIPTM10,MAXTM16,LIST20,NOHEX)
             //SYSPRINT DD  SYSOUT=A
             //INPUT    DD  UNIT=TAPE,DISP=OLD,DCB=(TRTCH=ET,DEN=1,
             //             EROPT=ACC),VOL=SER=TRACK7
             //OUTPUT   DD  UNIT=TAPE,LABEL=2,VOL=SER=OTPTTP

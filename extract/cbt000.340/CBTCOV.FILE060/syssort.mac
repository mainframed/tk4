SYSSORT SUBROUTINE

1) DESCRIPTION

  SYSSORT IS AN ASSEMBLER LANGUAGE SUBROUTINE IMPLEMENTATION OF A
  VERSION OF THE SHELL SORT. IT IS A RELATIVELY FAST CORESORT, USEFUL
  FOR SORTING TABLES.

  NOTE THAT THIS IMPLEMENTATION SORTS ASCENDING ONLY.

  WARNING: THE SORT WILL MAINTAIN ORDER ONLY ON THE KEY PASSED TO IT.
  IT WILL NOT RETAIN ORDER FORM ONE SORT TO THE NEXT. FOR EXAMPLE, YOU
  SHOULD NOT SORT A TABLE ON ONE KEY, THEN A SECOND KEY AND EXPECT THE
  TABLE TO RETAIN ORDER ON THE FIRST KEY AS WELL AS THE SECOND. THE
  TABLE WILL BE ORDERED ON THE SECOND KEY ONLY.

  WARNING: BE VERY CAREFUL ABOUT SETTING UP THE PARAMETERS YOU PASS
  TO THE SORT, AS IT WILL NOT RESPECT YOUR PROGRAM AND WILL SORT WHAT
  YOU GIVE IT, INCLUDING EXECUTABLE CODE.

2) USE

  CONSIDER THE FOLLOWING TABLE:

    01  THE TABLE.
        03 ONE-ENTRY OCCURS 100 TIMES INDEXED BY TABLE-INDEX.
           05  THE-KEY     PIC X(5).
           05  THE-DATA    PIC X(20).

  AND THE FOLLOWING DESCRIPTIVE ARGUMENTS:

    77 ENTRY-LENGTH        PIC S9(8) COMP VALUE +25.
    77 NUM-ENTRIES         PIC S9(8) COMP.
    77 KEY-START           PIC S9(8) COMP VALUE +1.
    77 KEY-LENGTH          PIC S9(8) COMP VALUE +5.

  THE ENTRY-LENGTH CONTAINS THE LENGTH OF ONE ENTRY IN THE TABLE IN
  BYTES. THE NUMBER OF ENTRIES WILL CONTAIN A COUNT OF HOW MANY ENTRIES
  WERE LOADED. KEY-START IS THE OFFSET OF THE KEY TO BE SORTED, IN THIS
  CASE IT STARTS WITH THE FIRST BYTE OF THE ENTRY. KEY-LENGTH IS THE
  LENGTH OF THE KEY IN BYTES.

  TO INVOKE THE SORT ISSUE TO FOLLOWING CALL:

    CALL 'SYSSORT' USING THE-TABLE,ENTRY-LENGTH,NUM-ENTRIES,KEY-START,
         KEY-LENGTH.

++USERMOD(SR00087).
++VER(Z038) FMID(EJS1102) PRE(UZ25131).
++SRCUPD(IATGRWJ).
./ CHANGE NAME=IATGRWJ
         LA    R1,6                SPECIFY NUMBER OF CHAR P0216/SR00087
         BAL   R9,GETSLOT          GO GET THESE CHARS     P0216/SR00087
         MVC   0(6,R1),=C'),SYS('  INSERT NEW TEXT        P0216/SR00087
         SR    R9,R9               CLEAR REG9             P0216/SR00087
         IC    R9,RQMPSEQ          GET MAIN-PROC SEQ      P0216/SR00087
         L     R6,MAINDATA         GET A(FIRST MP-TABLE)  P0216/SR00087
         USING MPCSTART,R6         ESTABLISH ADDRESSING   P0216/SR00087
FMTMAINA EQU   *                   *                      P0216/SR00087
         BCT   R9,FMTMAINB         MAIN-PROC FOUND ?      P0216/SR00087
         LA    R1,1                YES, SPECIFY # OF CHAR P0216/SR00087
         BAL   R9,GETSLOT          GO GET THIS CHARACTER  P0216/SR00087
         MVC   0(1,R1),MPNAME      MOVE MAIN-PROC-NAME    P0216/SR00087
         B     FMTMAIND            END OF USERMOD - CONTN P0216/SR00087
FMTMAINB EQU   *                   *                      P0216/SR00087
         CLC   MPNEXT,TVTZERO      LAST MAIN-PROC-ENTRY ? P0216/SR00087
         BNE   FMTMAINC            BIN, CONTINUE          P0216/SR00087
         LA    R1,1                SPECIFY NUMBER OF CHAR P0216/SR00087
         BAL   R9,GETSLOT          GO GET THIS CHARACTER  P0216/SR00087
         MVI   0(R1),C'?'          INSERT UNKNOWN MAIN    P0216/SR00087
         B     FMTMAIND            END OF USERMOD - CONTN P0216/SR00087
FMTMAINC EQU   *                   *                      P0216/SR00087
         L     R6,MPNEXT           GET A(NEXT MAIN-PROC)  P0216/SR00087
         B     FMTMAINA            CHECK THIS MAIN-PROC   P0216/SR00087
FMTMAIND EQU   *                   *                      P0216/SR00087
         DROP  R6                  NO FURTHER USE OF MPC  P0216/SR00087

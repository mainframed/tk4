&RJCARD1
//  '&NAME',
//  TIME=&JTIME,MSGLEVEL=1,REGION=4096K,PRTY=&JPRTY,
//  MSGCLASS=&JMCLASS,NOTIFY=&ZUSER
//*MAIN SYSTEM=&JMAIN,LREGION=1024K,CLASS=&JCLASS
//*MAIN FAILURE=CANCEL
)SEL &DOMSS = Y && &CHECK ^= CHECK × &SMPOPT = ACCEPT  && &CHECK = &Z
//**********
//ALLOC EXEC PGM=IEHPROGM
//SYSPRINT DD SYSOUT=*
//SYSIN DD DUMMY
//ALLOCIT  DD DSN=&&APPLY,DISP=(NEW,PASS),
//  SPACE=(CYL,(&SPRIM,&SSEC)),UNIT=SYSDA,
//  DCB=(RECFM=FBA,LRECL=121,BLKSIZE=1210)
)ENDSEL
//*********************************************************************
//*
//* FILE TAILORING MEMBER NAMES = GIMISCGA, GIMISCGB, GIMISCGE,
//*                     GIMISCGG, GIMISCGM, GIMISCGS, GIMISCGZ
//* JCL TAILORED BY FUNCTION = GIMISCG
//* JCL DESCRIPTION = PERFORM APPLY CHECK, APPLY, ACCEPT CHECK OR
//*                     ACCEPT PROCESSING
//*
//*********************************************************************
//S1       EXEC PGM=GIMSMP,
//         PARM='PROCESS=WAIT',
//         DYNAMNBR=120
//*
//* NOTE:      SMP ZONE-RELATED FILES ARE DYNAMICALLY ALLOCATED,
//*            THIS INCLUDES THE SMPPTS, SMPLOG, AND SMPTLIB DATA SETS.
//*
//* SMP FILES
//*
//SMPCSI   DD DISP=SHR,DSN=JES3.SP134.CSI
//SMPOUT   DD SYSOUT=*
//SMPRPT   DD SYSOUT=*
//SMPLIST  DD SYSOUT=*
//*
//SYSTERM  DD SYSOUT=&SOC         /* ASSEMBLY ERROR MESSAGES */
//*
)SEL &DOMSS = N × &CHECK = CHECK
//SYSPRINT DD SYSOUT=&SOC
)ENDSEL
)SEL &DOMSS = Y && &CHECK ^= CHECK × &SMPOPT = ACCEPT && &CHECK = &Z
//SYSPRINT DD DSN=&&APPLY,DISP=(MOD,PASS),
//  SPACE=(CYL,(&SPRIM,&SSEC)),UNIT=SYSDA,
//  DCB=(RECFM=FBA,LRECL=121,BLKSIZE=1210)
)ENDSEL
)SEL &CCMC = NO × &CCMC = &Z
//SMPLOG   DD SYSOUT=&SOC
)ENDSEL
)SEL &CCMC = YES
//SMPLOG   DD DSN=&&SMPLOG,DISP=(,PASS),UNIT=SYSDA,
//         SPACE=(TRK,(120,120),RLSE)
)ENDSEL
//*
//*
//*      UTILITY WORK DATA SETS
//*      PANEL MEMBER GIM@UPRM CONTAINS THE DEFAULT INFORMATION
//*      FOR THESE DATA SETS
//*
//SYSUT1   DD UNIT=SYSDA,SPACE=(3120,(0380,0760))
//SYSUT2   DD UNIT=SYSDA,SPACE=(3120,(0380,0760))
//SYSUT3   DD UNIT=SYSDA,SPACE=(3120,(0380,0760))
//SYSUT4   DD UNIT=SYSDA,SPACE=(3120,(0038,0100)),
//         DCB=(LRECL=80,BLKSIZE=3120,RECFM=FB)
//*
//*      SMP TEMPORARY WORK DATA SETS
//*
//SMPWRK1  DD UNIT=SYSDA,
//            SPACE=(3120,(0364,0380,111)),
//            DCB=(RECFM=FB,LRECL=80,BLKSIZE=3120)
//SMPWRK2  DD UNIT=SYSDA,
//            SPACE=(3120,(0364,0380,111)),
//            DCB=(RECFM=FB,LRECL=80,BLKSIZE=3120)
//SMPWRK3  DD UNIT=SYSDA,
//            SPACE=(CYL,(5,5,111)),
//            DCB=(RECFM=FB,LRECL=80,BLKSIZE=3120)
//SMPWRK4  DD UNIT=SYSDA,
//            SPACE=(3120,(0364,0380,111)),
//            DCB=(RECFM=FB,LRECL=80,BLKSIZE=3120)
//SMPWRK5  DD UNIT=SYSDA,
//            SPACE=(6144,(0183,0380,195)),
//            DCB=(RECFM=U,BLKSIZE=6144)
//*
//*
//*      SMP EXCLUSIVE DATA SET FOR SERIAL PROCESSING
//*
//ENQ     DD DSN=JES3.SP134.ENQ,DISP=OLD
//*
//SMPHOLD  DD DUMMY
)SEL &SMPOPT = RECEIVE
//SMPPTFIN DD DSN=&RECDSN,DISP=SHR
)ENDSEL
//SMPCNTL  DD *
)SEL &SMPOPT = RECEIVE
  SET     BOUNDARY ( GLOBAL )
          OPTIONS  ( SP134 )
          .
)ENDSEL
)SEL &SMPOPT = RECEIVE && &SMPSEL = &Z
 RECEIVE .
)ENDSEL
)SEL &SMPOPT = RECEIVE && &SMPSEL ^= &Z
 RECEIVE &SMPSELO(&SMPSEL) .
)ENDSEL
)SEL &SMPOPT ^= RECEIVE
  SET     BOUNDARY ( SP134 )
          OPTIONS  ( SP134 )
          .
)ENDSEL
)SEL &SMPOPT = APPLY  && &SMPSEL = &Z
 APPLY
  APARS PTFS USERMODS
  RETRY(YES) ASSEM &CHECK. .
)ENDSEL
)SEL &SMPOPT = APPLY  && &SMPSEL ^= &Z
 APPLY
 &SMPSELO(&SMPSEL)
)SEL &SMPSELO = GROUP × &SMPSELO = EXCLUDE
  APARS PTFS USERMODS
)ENDSEL
        ASSEM  RETRY(YES) &CHECK..
)ENDSEL
)SEL &SMPOPT = ACCEPT && &SMPSEL = &Z
 ACCEPT
 APARS PTFS USERMODS
 RETRY(YES) &CHECK..
)ENDSEL
)SEL &SMPOPT = ACCEPT && &SMPSEL ^= &Z
 ACCEPT
  &SMPSELO(&SMPSEL)
)SEL &SMPSELO = GROUP × &SMPSELO = EXCLUDE
  APARS PTFS USERMODS
)ENDSEL
  RETRY(YES) &CHECK..
)ENDSEL
)SEL &SMPOPT = RESTORE && &SMPSEL = &Z
 RESTORE  RETRY(YES) &CHECK..
)ENDSEL
)SEL &SMPOPT = RESTORE && &SMPSEL ^= &Z
 RESTORE
  &SMPSELO(&SMPSEL)
)SEL &SMPSELO = GROUP × &SMPSELO = EXCLUDE
  APARS PTFS USERMODS
)ENDSEL
  RETRY(YES) &CHECK..
)ENDSEL
/*
)SEL &CHECK ^= CHECK
)IM CCMCTRAN
)ENDSEL
)SEL &DOMSS = Y && &CHECK ^= CHECK × &SMPOPT = ACCEPT && &CHECK = &Z
//SYSOUT EXEC PGM=SYSOUT,
)SEL &SUBMIT = Y  && &SMPOPT ^= ACCEPT
// PARM='NOSPL,MSVGP=&MSVGP,PREFIX=&LPREFIX,SUBMIT',
)ENDSEL
)SEL &SUBMIT = N  && &SMPOPT ^= ACCEPT
// PARM='NOSPL,MSVGP=&MSVGP,PREFIX=&LPREFIX',
)ENDSEL
)SEL &SMPOPT = ACCEPT
// PARM='NOSPL',
)ENDSEL
//  COND=EVEN
//STEPLIB  DD DSN=AOST.LOAD,DISP=SHR
//REPORT DD SYSOUT=&SOC
//OTHER  DD SYSOUT=&SOC
//SYSPRINT DD SYSOUT=*
//INPUT  DD DSN=&&APPLY,DISP=(OLD,DELETE)
)SEL &SUBMIT = Y && &SMPOPT ^= ACCEPT
//INTRDR DD SYSOUT=(A,INTRDR)
//SUBMITCC DD *
&SUBMITC1
)ENDSEL
)ENDSEL

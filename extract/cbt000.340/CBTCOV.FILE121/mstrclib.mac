./ ADD  NAME=CMNBS00
PROC 0
   /*     CONTROL MSG CON SYM LIST */
          SET CMNBSMS =
          ISPEXEC VGET (CMNBSVA CMNBSVB CMNCBVC CMNCSV1 +
              CMNCSV6 CMNCSV7) PROFILE
DISPLAY:  ISPEXEC DISPLAY PANEL(CMNBS00) &CMNBSMS
          SET DISPRC  = &LASTCC
          IF (&DISPRC NE 0) THEN +
              GOTO END
          SET CMNBSMS =
          ISPEXEC FTOPEN TEMP
          IF (&LASTCC NE 0) THEN DO
              SET CMNBSMS = STR(CMNBS101)
              GOTO DISPLAY
              END
          SET CMNBSCA = &SUBSTR(1:8,&CMNCSV1&STR(        )
          SET CMNBSCB = &SUBSTR(1:5,&CMNCSV2&STR(     )
          SET CMNBSCC = &SUBSTR(1:8,&CMNCSV3&STR(        )
          SET CMNBSCD = &SUBSTR(1:8,&CMNCSV4&STR(        )
          SET CMNBSCE = &STR(SYSPRINT)
          SET CMNBSCF = &CMNCSV8
          SET CMNBSC1 = &STR(&CMNBSCA&CMNBSCB&CMNBSCC&CMNBSCD)
          SET CMNBSC2 = &STR(&CMNBSCE&CMNBSCF)
          ISPEXEC FTINCL CMNBS00
          IF (&LASTCC NE 0) THEN DO
              SET CMNBSMS = STR(CMNBS102)
              GOTO DISPLAY
              END
          ISPEXEC FTCLOSE
          IF (&LASTCC NE 0) THEN DO
              SET CMNBSMS = STR(CMNBS103)
              GOTO DISPLAY
              END
          ISPEXEC VGET (ZTEMPF)
          SUB '&ZTEMPF'
          IF (&LASTCC = 0) THEN +
              GOTO DISPLAY
END:      IF (&DISPRC LT 9) THEN +
              ISPEXEC VPUT (CMNBSVA CMNBSVB CMNBSVC CMNCSV1 +
              CMNCSV6 CMNCSV7) PROFILE
          EXIT CODE(0)
./ ADD  NAME=CMNEI00
PROC 0
/*     CONTROL MSG SYM CON LIST   */
       ISPEXEC VGET (Z) SHARED
LOOP:  ISPEXEC DISPLAY PANEL(CMNEI00)
       IF &LASTCC NE 0 THEN EXIT
       IF &CMNEIOPT EQ &Z THEN GOTO LOOP
       IF &CMNEIOPT EQ A THEN GOTO ARCHIVE
       IF &CMNEIOPT EQ I THEN GOTO IREF
       IF &CMNEIOPT EQ S THEN GOTO SYSTEM
       IF &CMNEIOPT EQ U THEN GOTO USER
       GOTO LOOP
ARCHIVE: ALLOC DSN('PRODCAT.ASM2.INFO') SHR DD(VSAM)
       XEQ BLGOZD
       FREE DD(VSAM)
       ISPEXEC CONTROL DISPLAY REFRESH
       GOTO LOOP
IREF:  ALLOC DSN('PRODCAT.OZ.DBDCXREF') SHR DD(VSAM)
       XEQ BLGOZD 'D=A,P04=PRINT UP,P16=PRINT UP'
       FREE DD(VSAM)
       ISPEXEC CONTROL DISPLAY REFRESH
       GOTO LOOP
SYSTEM: ALLOC DSN('SYS1.OZ.VSAM') SHR DD(VSAM)
       XEQ BLGOZD
       FREE DD(VSAM)
       ISPEXEC CONTROL DISPLAY REFRESH
       GOTO LOOP
USER:  ALLOC DSN('TESTCAT.OZ.SOFTWARE') SHR DD(VSAM)
       XEQ OZD 'D=U'
       FREE DD(VSAM)
       ISPEXEC CONTROL DISPLAY REFRESH
       GOTO LOOP
./ ADD  NAME=CMNEJ00
PROC 0 PROBLEM() PARM(00)                                        DEBUG
ISPEXEC CONTROL DISPLAY REFRESH
IF &PROBLEM = THEN SET &P1 =
   ELSE SET &P1 = &STR(PROBLEM(&PROBLEM))
IF &PARM    = THEN SET &P2 =
   ELSE SET &P2 = &STR(PARM(&PARM))
%EXIPCS &P1 &P2
./ ADD  NAME=CMNEMI0
PROC 0
ALLOC DSN('PRODCAT.OZ.DBDCXREF') SHR DD(VSAM)
XEQ BLGOZD 'D=A,P04=PRINT UP,P16=PRINT UP'
FREE DD(VSAM)
ISPEXEC CONTROL DISPLAY REFRESH
./ ADD  NAME=CMNEMM0
PROC 0
           ISPEXEC DISPLAY PANEL(WMFSINIT)
           ISPEXEC VGET (CMNEMM1 CMNEMM2 CMNEMM3) PROFILE
LABELA:    ISPEXEC DISPLAY PANEL(CMNEMM0)
           IF &LASTCC NE 0  THEN  GOTO EXITCLST
           ISPEXEC VPUT (CMNEMM1 CMNEMM2 CMNEMM3) PROFILE
           IF &DEBUG NE DEBUG THEN CONTROL NOMSG NOCON NOSYM  PROMPT
                              ELSE CONTROL MSG CON SYM PROMPT NOFLUSH
           SET &PROJECT  = &CMNEMM1
           SET &LIBRARY  = &CMNEMM2
           SET &TYPE     = &CMNEMM3
           SET &OLDDATA  = &CMNEMM4
           SET &COPY     = &CMNEMM5
           SET &SPF      = &CMNEMM6
           SET &NEWDATA  = &CMNEMM7
           SET &SCR      = &CMNEMM8
           SET &MFSMCRO  = &CMNEMM9
           SET &GEN      = &CMNEMM10
           IF &CMNEMM11  = ^  THEN  SET &LID1 = NULL
           IF &CMNEMM12  = ^  THEN  SET &LID2 = NULL
ISPEXEC CONTROL DISPLAY LINE START(1)
IF &PROJECT EQ IMSVS AND +
   &LIBRARY EQ MFS   AND +
   (&TYPE EQ DATA OR &TYPE EQ MACROS) +
   THEN  +
       IF &SYSUID NE C@96494 AND   +
          &SYSUID NE D@96212 AND   +
          &SYSUID NE D@97014 AND   +
          &SYSUID NE D@97146 AND   +
          &SYSUID NE D@97198 AND   +
          &SYSUID NE E$21842       +
          THEN DO
               WRITE '** PROJECT LIBRARY TYPE FIELDS INVALID **'
               GOTO EXITCLST
               END
IF &COPY EQ YES THEN +
   DO
   %CMNEMM1  'IMSVS.MFS.DATA(&OLDDATA)' +
            '&PROJECT..&LIBRARY..&TYPE(&OLDDATA)' &DEBUG
   WRITE COPY OPTION REQUESTED AND COMPLETED
   END
IF &NEWDATA EQ ! THEN +
   DO
   SET &MFSDATA = &OLDDATA
   END
   ELSE +
   DO
   SET &MFSDATA = &NEWDATA
   END
IF &SPF EQ Y THEN +
   DO
   %CMNEMM2 &PROJECT &LIBRARY &TYPE &OLDDATA &MFSDATA &DEBUG
   SET &CC = &LASTCC
   END
   ELSE +
   DO
   WRITE SPF PROMPTER OPTION NOT REQUESTED; EXECUTION SKIPPED
   SET &CC = 00
   END
IF &CC LE 08 THEN +
   DO
   IF &SCR EQ Y OR &GEN EQ Y THEN +
      DO
      IF &MFSMCRO EQ ! THEN +
         DO
         IF &SCR EQ N THEN +
            DO
            SET &MFSNAME = &MFSDATA
            END
            ELSE +
            DO
            IF &PROJECT EQ IMSVS AND &LIBRARY EQ MFS +
                                 AND &TYPE EQ DATA THEN +
               DO
               SET &MFSNAME = &MFSDATA
               END
               ELSE +
               DO
               SET &M = M
               SET &MFSNAME = &MFSDATA&M
               WRITE +
               NO MACRO NAME SUPPLIED  ==> &MFSNAME <==  SUBSTITUTED
               END
            END
         END
         ELSE +
         DO
         SET &MFSNAME = &MFSMCRO
         END
      END
   IF &SCR EQ Y THEN +
      DO
      WRITE PRE-PROCESSOR OPTION REQUESTED EXECUTION STARTED
      %CMNEMM3  &PROJECT &LIBRARY &TYPE +
                &MFSDATA &MFSNAME &LID1 &DEBUG
      SET &CC = &LASTCC
      CLEAR
      END
      ELSE +
      DO
      WRITE PRE-PROCESSOR OPTION NOT REQUESTED; EXECUTION SKIPPED
      XEQ SYSWAIT '000001'
      END
   END
   ELSE +
   DO
   WRITE SPF-PROMPTER CONDITION CODE WAS &CC  CLIST WILL BE TERMINATED
   END
IF &CC LE 4 THEN +
   DO
   IF &GEN EQ Y THEN +
      DO
      WRITE MFS-GEN REQUESTED; EXECUTION STARTED
      %CMNEMMM5 &PROJECT &LIBRARY &TYPE &MFSNAME &LID2  &DEBUG
      CLEAR
      END
      ELSE +
      DO
      WRITE MFS-GEN NOT REQUESTED; EXECUTION SKIPPED
      XEQ SYSWAIT '000001'
      END
   END
   ELSE +
   DO
   IF &GEN EQ Y THEN +
      DO
      WRITE PRE-PROCESSOR RC = &CC,MFS-GEN WILL BE SKIPPED
      XEQ SYSWAIT '000001'
      END
    END
ENDLIST: CLEAR
GOTO LABELA
EXITCLST: EXIT
./ ADD  NAME=CMNEMM2
PROC 5 PROJECT LIBRARY TYPE OLDDATA MFSDATA TEST DEBUG
IF &DEBUG NE DEBUG THEN CONTROL NOMSG NOCON NOSYM   PROMPT
                   ELSE CONTROL MSG CON SYM   PROMPT NOFLUSH
FREE  DD(INREC)
IF &OLDDATA EQ ! THEN SET &INREC = NOINPUT
      ELSE +
      DO
      STATE '&PROJECT..&LIBRARY..&TYPE(&OLDDATA)' R
      IF &LASTCC EQ 0 THEN +
         DO
         ALLOC DD(INREC) DSN('&PROJECT..&LIBRARY..&TYPE(&OLDDATA)') SHR
         SET &INREC = INREC
         END
         ELSE SET &INREC = NOINPUT
      END
FREE  DD(OUTREC)
STATE #TEMPX R
IF &LASTCC NE 0 THEN +
   DO
   FREE ATTR(DCBTEMP)
   ATTRIB DCBTEMP LRECL(80) BLKSIZE(6160) RECFM(F B )
   ALLOC DD(OUTREC) DSN(#TEMPX) SHR +
         USING(DCBTEMP) NE CATALOG TRA SP(1 1)
   FREE ATTR(DCBTEMP)
   END
   ELSE +
   DO
   ALLOC DD(OUTREC) DSN(#TEMPX) SHR
   END
IF &TEST = TEST THEN +
   DO
   WRITE TEST PROGRAM WILL BE EXECUTED
   DADA017T
   END
   ELSE +
   DO
   DADA017B
   END
SET &CC = &LASTCC
CLEAR
IF &CC LE 08 THEN +
   %CMNEMPG  &PROJECT..&LIBRARY..&TYPE SYSUT1(#TEMPX)  MBR(&MFSDATA)
FREE  DD(OUTREC)
DELETE #TEMPX
IF &INREC EQ INREC THEN +
   DO
   FREE  DD(INREC)
   END
XEQ SYSWAIT '000001'
CLEAR
EXIT CODE(&CC)
./ ADD  NAME=CMNEMM3
THIS IS OBSOLETE USE ONLY FOR REFERENCE
PROC 6 PROJECT LIBRARY TYPE -
       MFSDATA MFSMCRO LID PROGRAM(DADA016B) TEST DEBUG
CONTROL NOMSG NOCON NOSYM NOPROMPT
IF &DEBUG NE DEBUG THEN CONTROL NOMSG NOCON NOSYM NOPROMPT
                   ELSE CONTROL MSG CON SYM NOPROMPT NOFLUSH
  FREE  DD(SYSIN SYSOUT SYSPRINT SORTCNTL)
  ALLOC DD(SYSIN) DSN('&PROJECT..&LIBRARY..&TYPE(&MFSDATA)') SHR
IF &LID NE NULL THEN +
   DO
   SET &PARM = NULL
   STATE &LID R
   IF &LASTCC EQ 0 THEN +
      DO
      ALLOC DD(SYSPRINT) DSN(&LID)
      SET &DSN = &SYSPREF..&LID
      WRITE PRE-PROCESSOR OUTPUT WILL BE WRITTEN TO DSN=&DSN
      END
      ELSE +
      DO
      CONTROL MSG
      ALLOC DD(SYSPRINT) DSN(&LID) NEW SP(1 1) TR
      CONTROL NOMSG
      SET &DSN = &SYSPREF..&LID
      WRITE PRE-PROCESSOR OUTPUT WILL BE WRITTEN TO DSN=&DSN
      END
   END
   ELSE +
   DO
   SET &PARM = SPFOUT
   ALLOC DSN(*) DD(SYSPRINT)
   END
  STATE MFS.UNSORT  R
  IF &LASTCC NE 0 THEN +
     DO
     FREE  ATTRLIST(MACOUT)
     ATTRIB MACOUT BLKSIZE(5950) RECFM(F B)
     CONTROL MSG
     ALLOC DD(SYSOUT) DSN(MFS.UNSORT) TR USING(MACOUT) +
     SP(10 10) TR  NEW CATALOG
     CONTROL NOMSG
     FREE  ATTRLIST(MACOUT)
     END
     ELSE ALLOC DD(SYSOUT) DSN(MFS.UNSORT) SHR
  STATE MFS.SORTIN  R
  IF &LASTCC NE 0 THEN +
     DO
     FREE  ATTRLIST(CNTLOUT)
     ATTRIB CNTLOUT BLKSIZE(80) RECFM(F B) LRECL(80)
     CONTROL MSG
     ALLOC DD(SORTCNTL) DSN(MFS.SORTIN) TR USING(CNTLOUT) +
     SP(1 1) TR NEW CATALOG
     CONTROL NOMSG
     FREE  ATTRLIST(CNTLOUT)
     END
     ELSE ALLOC DD(SORTCNTL) DSN(MFS.SORTIN) SHR
  IF &TEST = TEST THEN +
     DO
     WRITE TEST PROGRAM WILL BE EXECUTED
     CALL Z.LOAD(&PROGRAM) '&PARM'
     END
     ELSE XEQ &PROGRAM '&PARM'
  SET &CC = &LASTCC
  SET &SCRNCC = &CC
  FREE  DD(SYSIN SYSOUT SYSPRINT)
  FREE  ATTRLIST(MACOUT )
  IF &CC LE 4 THEN +
     DO
     FREE  DD(SYSIN SYSOUT SORTIN SORTOUT)
     ALLOC DD(SORTIN) DSN(MFS.UNSORT) OLD DELETE
     ALLOC DD(SYSOUT) DUMMY
     ALLOC DD(SYSIN) DSN(MFS.SORTIN) OLD DELETE
     IF &PROJECT EQ IMSVS AND &LIBRARY EQ MFS AND &TYPE EQ DATA +
        THEN +
        ALLOC DD(SORTOUT) DSN('IMSVS.MFS.MACROS(&MFSMCRO)')
        ELSE +
        ALLOC DD(SORTOUT) DSN('&PROJECT..&LIBRARY..&TYPE(&MFSMCRO)')
     WRITE +
     PRE-PROCESSOR ENDED WITH A RC = &CC  SORT WILL NOW BE EXECUTED
     XEQ ICEMAN
     FREE  DD(SYSIN SYSOUT SORTIN SORTOUT)
     END
     ELSE +
     DO
     WRITE +
     PRE-PROCESSOR ENDED WITH A RC = &CC
     WRITE +
     SORT WILL NOT BE EXECUTED AND FURTHER PROCESSING IS TERMINATED
     XEQ SYSWAIT '000001'
     END
  CLEAR
EXIT CODE(&SCRNCC)
./ ADD  NAME=CMNEMM4
THIS IS AN OBSOLETE CLIST USE ONLY FOR REFERRENCE
PROC 5 PROJECT LIBRARY TYPE MEMBER LID DEBUG
CONTROL NOMSG NOCON NOSYM NOPROMPT NOFLUSH
DELETE SEQBLKS
DELETE TEMPPDS
DELETE TEXTPASS
DELETE TEMPPRNT
IF &DEBUG NE DEBUG THEN CONTROL NOMSG NOCON NOSYM NOPROMPT
                   ELSE CONTROL MSG CON SYM NOPROMPT NOFLUSH
FREE  DD(SYSIN REFIN REFOUT REFRD SYSTEXT SEQBLKS SYSPRINT)
FREE ATTRLIST(B4000 FB133)
CONTROL MSG
ALLOC DD(REFIN) DSN(TEMPREF) NEW SPACE(1 1) TR  DIR(01) DELETE
ALLOC DD(REFOUT) DSN(TEMPPDS) NEW SPACE(1 1) TR  DIR(01) DELETE
ALLOC DD(REFRD) DSN(TEMPPDS) SHR DELETE
ALLOC DD(SEQBLKS) DSN(SEQBLKS) NEW SPACE(9 1) TR CATALOG
ATTR B4000 BLKSIZE(4000)
ALLOC DD(SYSTEXT) DSN(TEXTPASS) NEW SPACE(9 1) TR CATALOG USING(B4000)
ATTR FB133 LRECL(133) BLKSIZE(6118) RECFM(F B)
ALLOC DD(SYSPRINT) DSN(TEMPPRNT) NEW CATALOG SP(2 1) TR USING(FB133)
FREE ATTRLIST(B4000 FB133)
IF &PROJECT EQ IMSVS AND &LIBRARY EQ MFS +
   THEN +
   ALLOC DD(SYSIN) DSN('&PROJECT..&LIBRARY..MACROS(&MEMBER)') SHR
   ELSE +
   ALLOC DD(SYSIN) DSN('&PROJECT..&LIBRARY..&TYPE(&MEMBER)') SHR
PROF WTPMSG
XEQ DFSUPAA0 -
     'NOXREF,NOCOMP,NOSUBS,NODIAG,NOCOMPRESS,LINECNT=55,STOPRC=8'
SET &CC = &LASTCC
CONTROL NOMSG
FREE  DD(SYSIN REFIN REFOUT REFRD SYSTEXT SEQBLKS SYSPRINT)
IF &SUBSTR(1:1,&CC) EQ U OR &SUBSTR(1:1,&CC) EQ S OR &CC GT 8 THEN +
   DO
      WRITE MFS EDIT ENDED WITH A RC = &CC TFORMAT WILL NOT BE UPDATED
   IF &LID NE NULL THEN +
      DO
      WRITE MFS-EDIT OUTPUT WILL BE WRITTEN TO DSN=&SYSPREF..&LID
      %CMNEMPR  TEMPPRNT &LID ALL &DEBUG OUTPUT(NOTERM)
      END
      ELSE +
      DO
      %CMNEMPR  TEMPPRNT &LID ALL &DEBUG OUTPUT(TERM)
      END
   DELETE TEXTPASS
   DELETE TEMPPRNT
   END
   ELSE +
   DO
   WRITE MFS EDIT ENDED WITH A RC = &CC TFORMAT WILL NOW BE UPDATED
   IF &LID NE NULL THEN +
      DO
      WRITE MFS-EDIT OUTPUT WILL BE WRITTEN TO DSN=&SYSPREF..&LID
      %CMNEMPR  TEMPPRNT &LID MFS &DEBUG OUTPUT(NOTERM)
      END
   CONTROL NOMSG
   DELETE TEMPPRNT
   FREE  DD(FORMAT SEQBLKS UTPRINT)
   CONTROL MSG
   ALLOC DD(SEQBLKS) DSN(SEQBLKS) DELETE
   ALLOC DD(UTPRINT) DSN(*)
   ALLOC DD(FORMAT) DSN('IMSVS.TFORMAT') SHR
   CONTROL NOMSG
   XEQ DFSUNUB0 'TEST'
   SET &CC = &LASTCC
   WRITE MFS UPDT ENDED WITH A RC = &CC
   FREE  DD(FORMAT SEQBLKS UTPRINT)
   END
CLEAR
./ ADD  NAME=CMNEMPA
PROC 4 PRJ1 LIB1 TYPE MBR OUTPUT(TERM)  DEBUG
IF &DEBUG EQ DEBUG THEN CONTROL MSG SYM CON LIST
                   ELSE CONTROL NOMSG NOSYM NOCON NOPROMPT
 DELETE #ACBCNTL
 FREE DD(PARMSWTR )
 ALLOC DSN(#ACBCNTL) NEW CATALOG SP(1) TRA DD(PARMSWTR)
 XEQ PARMSWTR ' BUILD PSB=&MBR'
 FREE DD(IMSACB SYSIN SYSPRINT IMS)
 DEL UT1.LIST
 FREE ATTR(ACBATTR)
 ATTR ACBATTR RECFM(U) BLKSIZE(13030)
 ALLOC  DSN(UT1.LIST) NE DEL +
 SP(10 10) TRA DD(IMSACB) DIR(10) USING(ACBATTR)
 IF &LIB1 = PSBS THEN +
        DO
        SET &DSN = '&PRJ1..PSBLIB'
        ALLOC  DD(IMS) DSN( &DSN '&PRJ1..DBDLIB' ) SHR
        END
        ELSE +
        DO
        SET &DSN = '&PRJ1..&LIB1..LOAD'
        ALLOC  DD(IMS) DSN( &DSN 'IMSVS.DBDLIB' ) SHR
        END
 IF &OUTPUT = TERM THEN +
    DO
    ALLOC DD(SYSPRINT) DSN(*) SHR
    END
    ELSE +
    DO
    STATE #TEMP7  R
    IF &LASTCC NE 0 THEN +
       DO
       FREE ATTR(ACBTEMP)
       ATTRIB ACBTEMP LRECL(133) BLKSIZE(6118) RECFM(F B A)
       ALLOC DD(SYSPRINT) DSN(#TEMP7) SHR +
             USING(ACBTEMP) NE CATALOG TRA SP(1 1)
       FREE ATTR(ACBTEMP)
       END
       ELSE +
       ALLOC DSN(#TEMP7) SHR DD(SYSPRINT)
    END
 ALLOC  DD(SYSIN) DSN(#ACBCNTL) SHR
 XEQ DFSRRC00 'UPB'
 FREE DD(IMSACB SYSIN SYSPRINT IMS)
 FREE ATTR(ACBATTR)
 DELETE #ACBCNTL
./ ADD  NAME=CMNEMPC
PROC 4 PRJ1 LIB1 TYPE MBR    GEN(NOGEN)       DEBUG
IF &DEBUG EQ DEBUG THEN CONTROL MSG SYM CON LIST NOFLUSH
                   ELSE CONTROL NOMSG NOSYM NOCON NOPROMPT FLUSH
FREE DD(SYSLIB SYSUT1 SYSUT2 SYSUT3 SYSLIN SYSPRINT SYSIN SYSTERM)
      STATE #NOGEN R
      IF &LASTCC NE 0 THEN +
         DO
         FREE ATTR(NOGEN)
         ATTR NOGEN LRECL(80) BLKSIZE(6160) RECFM(F B) DSORG(PS)
         ALLOC DSN(#NOGEN) DD(SYSUT2) NEW CATALOG +
         TRA SP(1 1)  USING(NOGEN)
         FREE ATTR(NOGEN)
         ALLOC DSN('IMSVS.SYSSPRT.SYSIN(ASMNOGEN)') DD(SYSUT1) SHR
         XEQ DADA012B
         FREE DD(SYSUT1 SYSUT2)
         END
      ALLOC DSN(*) DD(SYSTERM)
      ALLOC DSN('IMSVS.MACLIB' 'SYST.MACLIB')  SHR DD(SYSLIB)
      STATE  UT1.LIST R
      IF &LASTCC NE 0 +
         THEN +
         DO
         ALLOC DSN(UT1.LIST) NE DEL SP(10 10) TRA DD(SYSUT1)
         END
         ELSE ALLOC DSN(UT1.LIST) DD(SYSUT1)
      STATE  Z.OBJ  R
      IF &LASTCC NE 0 +
         THEN +
         DO
         FREE ATTR(OBJATTR)
         ATTR OBJATTR RECFM(F B) BLKSIZE(3200) LRECL(80)
         ALLOC DSN(Z.OBJ(&MBR)) DD(SYSLIN) NEW CATALOG +
         TRA SP(10 10) DIR(28) USING(OBJATTR)
         FREE ATTR(OBJATTR)
         END
         ELSE +
         ALLOC DSN(Z.OBJ(&MBR)) SHR DD(SYSLIN)
      STATE &LIB1.ASM.LIST R
      IF &LASTCC NE 0 THEN +
         DO
         FREE ATTR(F121X50)
         ATTR F121X50 LRECL(121) BLKSIZE(6050) RECFM(F B)
         ALLOC DSN(&LIB1.ASM.LIST) DD(SYSPRINT) NE +
              TRA SP(10 10)  USING(F121X50)
         FREE ATTR(F121X50)
         END
         ELSE
         ALLOC DSN(&LIB1.ASM.LIST) SHR DD(SYSPRINT)
      ALLOC DSN(#NOGEN '&PRJ1..&LIB1..&TYPE.(&MBR)') SHR DD(SYSIN)
      CONTROL MSG
      CLEAR
      XEQ IEV90 +
      'OBJECT,NODECK,NORLD,NOXREF,NOESD,SYSPARM=&GEN '
      SET &CC = &LASTCC
      WRITE ASM RETURN CODE = &CC
      CONTROL NOMSG
      FREE DD(SYSLIB SYSUT1 SYSUT2 SYSUT3 SYSLIN SYSPRINT SYSIN)
      ALLOC DSN(*) DD(SYSIN)
      ALLOC DSN(*) DD(SYSPRINT)
      EXIT CODE(&CC)
./ ADD  NAME=CMNEMPG
PROC  1 SYSUT2 SYSUT1() MBR(NULL) DEBUG
IF &DEBUG EQ DEBUG THEN CONTROL MSG SYM CON LIST
                   ELSE CONTROL NOMSG NOSYM NOCON NOPROMPT
FREE  DD(SYSUT1 SYSUT2)
ALLOC DD(SYSUT1) DSN(&SYSUT1)SHR
IF &MBR = NULL THEN +
   DO
   STATE &SYSUT2 R
   IF &LASTCC NE 0 THEN +
      DO
      FREE ATTR(UTLTEMP)
      ATTRIB UTLTEMP LRECL(133) BLKSIZE(6118) RECFM(F B A)
      CONTROL MSG
      ALLOC DD(SYSUT2) DSN(&SYSUT2) SHR +
            USING(UTLTEMP) NE CATALOG TRA SP(1 1)
      CONTROL NOMSG
      FREE ATTR(UTLTEMP)
      END
      ELSE +
      ALLOC DD(SYSUT2) SHR DSN(&SYSUT2)
   END
   ELSE +
   DO
   ALLOC DD(SYSUT2) DSN('&SYSUT2(&MBR)') SHR
   END
XEQ  DADA012B
FREE  DD(SYSUT1 SYSUT2)
./ ADD  NAME=CMNEMPL
PROC 3 PRJ1 LIB1 MBR            DEBUG
IF &DEBUG EQ DEBUG THEN CONTROL MSG SYM CON LIST
                   ELSE CONTROL NOMSG NOSYM NOCON NOPROMPT
 FREE DD(SYSLIN SYSLMOD SYSPRINT SYSUT1 )
 DEL UT1.LIST
 ALLOC  DD(SYSLIN) DSN(Z.OBJ(&MBR)) SHR
 IF &LIB1 = DBDS +
    THEN +
    DO
    ALLOC  DD(SYSLMOD) DSN('&PRJ1..DBDLIB(&MBR)') SHR
    END
    ELSE +
    IF &LIB1 = PSBS +
       THEN +
       DO
       ALLOC  DD(SYSLMOD) DSN('&PRJ1..PSBLIB(&MBR)') SHR
       END
       ELSE +
       DO
       ALLOC  DD(SYSLMOD) DSN('&PRJ1..&LIB1..LOAD(&MBR)') SHR
       END
 ALLOC  DD(SYSPRINT) DSN(*) SHR
 ALLOC DSN(UT1.LIST) NE DEL SP(10 10) TRA DD(SYSUT1)
 XEQ  DFSILNK0  'NOXREF,NOLIST'
 SET &CC = &LASTCC
 WRITE LINKEDIT RC = &CC
 XEQ SYSWAIT '000002'
 FREE DD(SYSLIN SYSLMOD SYSPRINT SYSUT1 )
 CLEAR
./ ADD  NAME=CMNEMPM
PROC 4 PRJ1 LIB1 TYPE MBR OUTPUT(TERM) DEBUG
IF &DEBUG EQ DEBUG THEN CONTROL MSG SYM CON LIST
                   ELSE CONTROL NOMSG NOSYM NOCON NOPROMPT
 FREE DD(PARMSWTR)
 DELETE #PSBCNTL
 ALLOC DSN(#PSBCNTL) NEW CATALOG SP(1) TRA DD(PARMSWTR)
 XEQ PARMSWTR '  &MBR      '
 FREE DD(DBDLIB PSBLIB SYSOUT SYSPRINT SYSIN IMSMAP)
 IF &LIB1 = PSBS  +
    THEN +
         DO
         ALLOC  DD(PSBLIB) DSN('&PRJ1..PSBLIB') SHR
         ALLOC  DD(DBDLIB) DSN('&PRJ1..DBDLIB') SHR
         END
    ELSE +
         DO
         ALLOC  DD(PSBLIB) DSN('&PRJ1..&LIB1..LOAD') SHR
         ALLOC DD(DBDLIB) DSN('IMSVS.DBDLIB') SHR
         END
 ALLOC DD(SYSPRINT)  DSN(*) SHR
 ALLOC DD(SYSIN)     DSN(#PSBCNTL) SHR
 IF &OUTPUT = TERM THEN +
    DO
    ALLOC DD(SYSOUT) DSN(*) SHR
    ALLOC DD(IMSMAP) DSN(*) SHR
    END
    ELSE +
    DO
    STATE #TEMP2  R
    IF &LASTCC NE 0 THEN +
       DO
       FREE ATTR(DCBTEMP)
       ATTRIB DCBTEMP LRECL(133) BLKSIZE(6118) RECFM(F B A)
       ALLOC DD(SYSOUT) DSN(#TEMP2) SHR +
             USING(DCBTEMP) NE CATALOG TRA SP(1 1)
       FREE ATTR(DCBTEMP)
       END
       ELSE +
       ALLOC DSN(#TEMP2) SHR DD(SYSOUT)
    STATE #TEMP3  R
    IF &LASTCC NE 0 THEN +
       DO
       FREE ATTR(DCBTEMP)
       ATTRIB DCBTEMP LRECL(133) BLKSIZE(6118) RECFM(F B A)
       ALLOC DD(IMSMAP) DSN(#TEMP3) SHR +
             USING(DCBTEMP) NE CATALOG TRA SP(1 1)
       FREE ATTR(DCBTEMP)
       END
       ELSE +
       ALLOC DSN(#TEMP3) SHR DD(IMSMAP)
    END
 XEQ PSBMAP
 WRITE PSBMAP COMPLETED
 DELETE #PSBCNTL
 FREE DD(DBDLIB PSBLIB SYSOUT SYSPRINT SYSIN IMSMAP)
 IF &OUTPUT NE TERM  +
    THEN +
    DO
    %CMNEMPR  #TEMP2 #TEMP4 MAP &DEBUG OUTPUT(&OUTPUT)
    %CMNEMPR  #TEMP3 #TEMP5 MAP &DEBUG OUTPUT(&OUTPUT)
    END
 CLEAR
./ ADD  NAME=CMNEMPP
PROC 4 PRJ1 LIB1 TYPE MBR    DEBUG  OUTPUT(TERM)
IF &DEBUG EQ DEBUG THEN +
                   DO
                   CONTROL MSG SYM CON LIST  NOFLUSH
                   END
                   ELSE CONTROL NOMSG NOSYM NOCON NOPROMPT FLUSH
 %CMNEMPC   &PRJ1 &LIB1 &TYPE &MBR &DEBUG
 SET &ASMCC = &LASTCC
 IF &ASMCC LE 4 THEN +
    DO
    %CMNEMPL   &PRJ1 &LIB1 &MBR &DEBUG
    %CMNEMPR  &LIB1.ASM.LIST #TEMP1 GEN &DEBUG OUTPUT(&OUTPUT)
    %CMNEMPM &PRJ1 &LIB1 &TYPE &MBR &DEBUG OUTPUT(&OUTPUT)
    IF &OUTPUT NE TERM AND &OUTPUT EQ SAVE AND &LIB1 EQ PSBS  THEN +
       DO
       %CMNEMPG  SYST.IMSVS.PSBDOC MBR(&MBR) +
                 SYSUT1('#TEMP1 #TEMP4 #TEMP5') &DEBUG
       DELETE (#TEMP1 #TEMP2 #TEMP3 #TEMP4 #TEMP5)
       END
    IF &OUTPUT NE TERM AND &OUTPUT NE SAVE THEN +
       DO
       %CMNEMPG  &OUTPUT..PSBGEN.OUTLIST MBR(NULL) +
                 SYSUT1('#TEMP1 #TEMP4 #TEMP5') &DEBUG
       WRITE PSBGEN OUTPUT WRITTEN TO +
             &SYSUID..&OUTPUT..PSBGEN.OUTLIST
       DELETE (#TEMP1 #TEMP2 #TEMP3 #TEMP4 #TEMP5)
       END
    WRITE  DO YOU NEED THE ACBGEN RUN  (YES/NO)
    READ &ACBANS
    IF &ACBANS EQ YES THEN +
       DO
       %CMNEMPA &PRJ1 &LIB1 &TYPE +
        &MBR OUTPUT(&OUTPUT) &DEBUG
        IF &OUTPUT NE TERM AND &OUTPUT EQ SAVE THEN +
           DO
           %CMNEMPG ACBGEN.OUTLIST MBR(NULL) +
                     SYSUT1('#TEMP7') &DEBUG
           WRITE ACBGEN OUTPUT WRITTEN TO &SYSUID..ACBGEN.OUTLIST
           DELETE (#TEMP7)
           END
        IF &OUTPUT NE TERM AND &OUTPUT NE SAVE THEN +
           DO
           %CMNEMPG  &OUTPUT..ACBGEN.OUTLIST MBR(NULL) +
                     SYSUT1('#TEMP7') &DEBUG
           WRITE ACBGEN OUTPUT WRITTEN TO +
                 &SYSUID..&OUTPUT..ACBGEN.OUTLIST
           DELETE (#TEMP7)
           END
       END
    END
    ELSE WRITE ASM FAILED SEE &SYSUID.ASM.PSBLIST FOR ERRORS
./ ADD  NAME=CMNEMPR
PROC  3  SYSIN SYSPDS FUNCTION OUTPUT(TERM) DEBUG
IF &DEBUG EQ DEBUG THEN CONTROL MSG SYM CON LIST
                   ELSE CONTROL NOMSG NOSYM NOCON NOPROMPT
FREE  DD(SYSPRINT SYSIN SYSPDS)
ALLOC DD(SYSPRINT) DSN(*) SHR
ALLOC DD(SYSIN) DSN(&SYSIN) SHR
IF &OUTPUT = TERM +
   THEN +
   ALLOC DSN(*) DD(SYSPDS)
   ELSE +
   DO
   STATE &SYSPDS R
   IF &LASTCC NE 0 THEN +
      DO
      FREE ATTR(DCBTEMP)
      CONTROL MSG
      ATTRIB DCBTEMP LRECL(133) BLKSIZE(6118) RECFM(F B A)
      ALLOC DD(SYSPDS) DSN(&SYSPDS) SHR +
            USING(DCBTEMP) NE CATALOG TRA SP(1 1)
      CONTROL NOMSG
      FREE ATTR(DCBTEMP)
      END
      ELSE +
      ALLOC DSN(&SYSPDS) SHR DD(SYSPDS)
   END
XEQ  DADA003B '&FUNCTION'
FREE  DD(SYSPRINT SYSIN SYSPDS)
./ ADD  NAME=CMNEMPU
PROC  2 SYSUT1 SYSUT2  DEBUG
IF &DEBUG EQ DEBUG THEN CONTROL MSG SYM CON LIST
                   ELSE CONTROL NOMSG NOSYM NOCON NOPROMPT
STATE &SYSUT1
IF &LASTCC EQ 0 THEN +
   DO
   FREE  DD(SYSUT1 SYSUT2)
   ALLOC DD(SYSUT1) DSN(&SYSUT1)SHR
   ALLOC DD(SYSUT2) DSN(&SYSUT2)SHR
   XEQ  DADA012B
   WRITE COPY OF &SYSUT1 TO &SYSUT2 COMPLETED
   FREE  DD(SYSUT1 SYSUT2)
   END
   ELSE +
   WRITE COPY OF &SYSUT1 TO &SYSUT2 TERMINATED
./ ADD  NAME=CMNEMP3
PROC 0
        ISPEXEC VGET (CMNEMP31 CMNEMP32 CMNEMP33) PROFILE
LABELA: ISPEXEC DISPLAY PANEL(CMNEMP3)
        IF &LASTCC NE 0  THEN  GOTO EXITCLST
        IF &DEBUG NE DEBUG THEN CONTROL NOMSG NOCON NOSYM NOPROMPT
                           ELSE CONTROL MSG CON SYM   PROMPT NOFLUSH
        ISPEXEC VPUT (CMNEMP31 CMNEMP32 CMNEMP33) PROFILE
        SET &PROJECT  = &CMNEMP31
        SET &LIBRARY  = &CMNEMP32
        SET &TYPE     = &CMNEMP33
        SET &MBR      = &CMNEMP34
        SET &OUTPUT   = &CMNEMP36
        IF &CMNEMP35 = 1  THEN  SET &FUNCTION = PSBGEN
        IF &CMNEMP35 = 2  THEN  SET &FUNCTION = PSBMAP
        IF &CMNEMP35 = 3  THEN  SET &FUNCTION = ACBGEN
IF &LIBRARY = PSBS OR +
   &LIBRARY = DBDS    THEN +
   IF &SYSUID NE C@96494 AND +
      &SYSUID NE D@96212 AND +
      &SYSUID NE D@97014 AND +
      &SYSUID NE D@97146 AND +
      &SYSUID NE D@97198 AND +
      &SYSUID NE E$21482   THEN  GOTO EXITCLST

   IF &CMNEMP35 = D  THEN  GOTO EXDBDGEN

ISPEXEC CONTROL DISPLAY LINE START(1)

IF &FUNCTION = PSBGEN THEN +
   DO
   %CMNEMPP &PROJECT &LIBRARY &TYPE &MBR OUTPUT(&OUTPUT) &DEBUG
   END
   ELSE +
   DO
   IF &FUNCTION = PSBMAP THEN +
      DO
      %CMNEMPM &PROJECT &LIBRARY &TYPE &MBR OUTPUT(&OUTPUT) &DEBUG
         IF &OUTPUT NE TERM AND &OUTPUT EQ SAVE THEN +
            DO
            %CMNEMPG &SYSUID..PSBMAP.OUTLIST MBR(NULL) +
                      SYSUT1('#TEMP4 #TEMP5') &DEBUG
            WRITE PSBMAP OUTPUT WRITTEN TO &SYSUID..PSBMAP.OUTLIST
            DELETE (#TEMP2 #TEMP3 #TEMP4 #TEMP5)
            END
         IF &OUTPUT NE TERM AND &OUTPUT NE SAVE THEN +
            DO
            %CMNEMPG &OUTPUT..PSBMAP.OUTLIST MBR(NULL) +
                      SYSUT1('#TEMP4 #TEMP5') &DEBUG
            WRITE PSBMAP OUTPUT WRITTEN TO +
                  &SYSUID..&OUTPUT..PSBMAP.OUTLIST
            DELETE (#TEMP2 #TEMP3 #TEMP4 #TEMP5)
            END
      END
      ELSE +
      DO
      IF &FUNCTION = ACBGEN THEN +
         DO
         %CMNEMPA &PROJECT &LIBRARY &TYPE &MBR OUTPUT(&OUTPUT) &DEBUG
         IF &OUTPUT NE TERM AND &OUTPUT EQ SAVE THEN +
            DO
            %CMNEMPG CMNEMPA.OUTLIST MBR(NULL) +
                      SYSUT1('#TEMP7') &DEBUG
            WRITE CMNEMPA OUTPUT WRITTEN TO &SYSUID..CMNEMPA.OUTLIST
            DELETE (#TEMP7)
            END
         IF &OUTPUT NE TERM AND &OUTPUT NE SAVE THEN +
            DO
            %CMNEMPG &OUTPUT..CMNEMPA.OUTLIST MBR(NULL) +
                      SYSUT1('#TEMP7') &DEBUG
            WRITE CMNEMPA OUTPUT WRITTEN TO +
                  &SYSUID..&OUTPUT..CMNEMPA.OUTLIST
            DELETE (#TEMP7)
            END
         END
         ELSE WRITE OPTION &FUNCTION NOT AVAILABLE AS YET
      END
   END
   GOTO LABELA
EXDBDGEN: %IMSEMPD &PROJECT &LIBRARY &TYPE &MBR TERM(&OUTPUT) &DEBUG
          GOTO LABELA
EXITCLST: EXIT
./ ADD  NAME=CMNEMV0
PROC 0    DEBUG( )
          ISPEXEC VGET (CMNEMV1 CMNEMV2 CMNEMV3 CMNEMV4 CMNEMV5 -
              CMNEMV6 CMNEMV7 CMNEMV8) PROFILE
LABELA:   ISPEXEC DISPLAY PANEL(CMNEMV0)
          IF LASTCC NE 0  THEN  GOTO EXITCLST
          IF &DEBUG EQ DEBUG THEN CONTROL MSG CON SYM   PROMPT NOFLUSH
                             ELSE CONTROL NOMSG NOCON NOSYM NOPROMPT
          ISPEXEC VPUT (CMNEMV1 CMNEMV2 CMNEMV3 CMNEMV4 CMNEMV5 -
              CMNEMV6 CMNEMV7 CMNEMV8) PROFILE
          ISPEXEC CONTROL DISPLAY LINE START(1)
          CONTROL NOFLUSH
          PROF WTPMSG
          SET &DSN=CMNEMV
          SET &N = 0
             DO WHILE &N LT 8
             SET &N = &N + 1
             SET &DS = &STR(&&&DSN&N)
             IF &DS NE  +
                THEN DO
                     SET &RC = 0
                     VERIFY DS('&DS')
                     SET &RC = &LASTCC
                     IF &RC NE 0 +
                      THEN  WRITE RC=&RC  DSN='&DS'
                     END
             END
          PROF NOWTPMSG
          CONTROL FLUSH
          GOTO LABELA
EXITCLST: EXIT
./ ADD  NAME=CMNEMZ0
PROC 0    PROC( )
          ISPEXEC VGET (CMNEMZ2 CMNEMZ3 CMNEMZ4 CMNEMZ5 -
                  CMNEMZ6 CMNEMZ7 CMNEMZ8 CMNEMZ9 CMNEMZ10 CMNEMZ11 -
                  CMNEMZ12 CMNEMZ13 CMNEMZ14 CMNEMZ15 CMNEMZ16) PROFILE
LABELA:   ISPEXEC DISPLAY PANEL(CMNEMZ0)
          IF &LASTCC NE 0  THEN  GOTO EXITCLST
          IF &DEBUG NE DEBUG +
                      THEN CONTROL NOMSG NOCON NOSYM NOPROMPT
                      ELSE CONTROL MSG CONLIST SYM NOPROMPT NOFLUSH LIST
          ISPEXEC VPUT (CMNEMZ2 CMNEMZ3 CMNEMZ4 CMNEMZ5 -
                  CMNEMZ6 CMNEMZ7 CMNEMZ8 CMNEMZ9 CMNEMZ10 CMNEMZ11 -
                  CMNEMZ12 CMNEMZ13 CMNEMZ14 CMNEMZ15 CMNEMZ16) PROFILE
          SET &TYPE    = &CMNEMZ2
          SET &LOG     = &CMNEMZ3
           IF &LOG = YES  THEN  SET &LOG = Y
           IF &LOG = NO   THEN  SET &LOG = N
          SET &IND2    = &CMNEMZ4
           IF &IND2 = YES  THEN  SET &IND2 = Y
           IF &IND2 = NO   THEN  SET &IND2 = N
          SET &DBD     = &CMNEMZ5
          SET &SEG     = &CMNEMZ6
          SET &LPSB    = &CMNEMZ7
          SET &DPSB    = &CMNEMZ8
          SET &DDN1DD  = &CMNEMZ9
          SET &DSN1DD  = &CMNEMZ10
          SET &DDN1PD  = &CMNEMZ11
          SET &DSN1PD  = &CMNEMZ12
          SET &DDN12D  = &CMNEMZ13
          SET &DSN12D  = &CMNEMZ14
          SET &DDN13D  = &CMNEMZ15
          SET &DSN13D  = &CMNEMZ16
          ISPEXEC CONTROL DISPLAY LINE START(1)
CLEAR
CONTROL NOFLUSH
IF &TYPE = HIDAM +
   THEN IF &DDN1PD =    +
           THEN DO
                WRITE ENTER INDEX DDNAME
                READ &DDN1PD
                IF &DSN1PD =    +
                   THEN DO
                        WRITE ENTER INDEX DSNAME
                        READ &DSN1PD
                        END
                END
IF &IND2 = Y +
   THEN IF &DDN12D =    +
           THEN DO
                WRITE ENTER 2ND INDEX DDNAME
                READ &DDN12D
                IF &DSN12D =    +
                   THEN DO
                        WRITE ENTER 2ND INDEX DSNAME
                        READ &DSN12D
                        END
                END
FREE DD(SYSPRINT)
ALLOC DD(SYSPRINT) DSN(*) SHR
REPRO IDS('NULLFILE') ODS('&DSN1DD') REUSE COUNT(0)
SET &RC = &LASTCC
IF &RC EQ 0 +
    THEN DO
         WRITE **** REPRO ON &DSN1DD  SUCCESSFUL
         END
    ELSE DO
         WRITE **************************************************
         WRITE ...... REPRO ON &DSN1DD FAILED ....... RC=&RC
         WRITE **************************************************
         GOTO FAILED
         END
IF &DSN1PD NE    +
   THEN DO
        REPRO IDS('NULLFILE') ODS('&DSN1PD') REUSE COUNT(0)
        SET &RC = &LASTCC
        IF &RC EQ 0 +
           THEN DO
                WRITE **** REPRO ON &DSN1PD  SUCCESSFUL
                END
           ELSE DO
                WRITE *************************************************
                WRITE ...... REPRO ON &DSN1PD FAILED ...... RC=&RC
                WRITE *************************************************
                GOTO FAILED
                END
        END
IF &DSN12D NE    +
   THEN DO
        REPRO IDS('NULLFILE') ODS('&DSN12D') REUSE COUNT(0)
        SET &RC = &LASTCC
        IF &RC EQ 0 +
           THEN DO
                WRITE **** REPRO ON &DSN12D  SUCCESSFUL
                END
           ELSE DO
                WRITE *************************************************
                WRITE ...... REPRO ON &DSN12D FAILED ...... RC=&RC
                WRITE *************************************************
                GOTO FAILED
                END
        END
IF &DSN13D NE    +
   THEN DO
        REPRO IDS('NULLFILE') ODS('&DSN13D') REUSE COUNT(0)
        SET &RC = &LASTCC
        IF &RC EQ 0 +
           THEN DO
                WRITE **** REPRO ON &DSN13D  SUCCESSFUL
                END
           ELSE DO
                WRITE *************************************************
                WRITE ...... REPRO ON &DSN13D FAILED ...... RC=&RC
                WRITE *************************************************
                GOTO FAILED
                END
        END
IF &IND2 = Y OR &LOG = Y +
   THEN DO
        %CMNEMZ1  DBIL DBD(&DBD) &DEBUG
        IF &LASTCC NE 0 +
           THEN  GOTO FAILED
        END
%CMNEMZ2  DD1('&DDN1DD') DSN1('&DSN1DD') +
          DD2('&DDN1PD') DSN2('&DSN1PD') +
          DD3('&DDN12D') DSN3('&DSN12D') +
          DD4('&DDN13D') DSN4('&DSN13D')
FREE DD(IMS PROCLIB IEFRDER DFSVSAMP)
ALLOC DD(IMS) DSN('IMSVS.DBDLIB' 'IMSVS.PSBLIB') SHR
ALLOC DD(PROCLIB) DSN('IMSVS.PARMLIB') SHR
ALLOC DD(IEFRDER) DUMMY
ALLOC DD(DFSVSAMP) DSN('IMSVS.SYSSPRT.SYSIN(DFSVSM08)') SHR
WRITE **  DLT0 LOAD -  STARTED EXECUTION **
IF &LPSB = &STR() THEN +
   DO
   SET &LPSB = &SUBSTR(1:4,&DBD)L&SUBSTR(5:6,&DBD)Y
   WRITE **  DEFAULT LOAD PSB TO BE USED IS &LPSB  **
   END
%CMNEMZ3  PSB(&LPSB) PCBNO(1) FUNC(ISRT) DATA('') +
         SSA1(&SEG) SSA2(×) SSA3(×) SSA4(×) SSA5(×) NUM(0) LISTID('') +
         DSNMEM('IMSVS.SYSSPRT.SYSIN(DBZEROLD)') DEBUG('&DEBUG')
SET &RC = &LASTCC
IF &RC NE 0 +
   THEN DO
        WRITE *******************************************
        WRITE ...... DLT0 LOAD  FAILED ...... RC=&RC
        WRITE *******************************************
        GOTO FAILED
        END
FREE DD(IMS PROCLIB IEFRDER DFSVSAMP)
FREE DD(SYSPRINT &DDN1DD )
IF &IND2 = Y +
   THEN DO
        %CMNEMZ4 DLT0WF1 #PRERORG &DEBUG
        IF &LASTCC NE 0 +
           THEN GOTO FAILED
           ELSE +
                DO
                FREE DD(&DDN12D)
                %CMNEMZ5  #RESOLVE &DDN12D &DSN12D &DEBUG
                IF &LASTCC NE 0 +
                   THEN GOTO FAILED
                   ELSE +
                        DO
                        %CMNEMZ6  #UNLOAD &DDN12D &DSN12D &DEBUG
                        IF &LASTCC NE 0 +
                           THEN GOTO FAILED
                        END
                IF &DDN13D NE        +
                   THEN  DO
                         FREE DD(&DDN13D)
                         %CMNEMZ5  #RESOLVE &DDN13D &DSN13D &DEBUG
                         IF &LASTCC NE 0 +
                            THEN GOTO FAILED
                            ELSE +
                                 DO
                                 %CMNEMZ6  #UNLOAD &DDN13D &DSN13D +
                                                               &DEBUG
                                 IF &LASTCC NE 0 +
                                    THEN GOTO FAILED
                                 END
                        END
                DELETE #RESOLVE
                END
        END
IF &TYPE NE SHISAM -
   THEN DO
   IF &DPSB NE SKIPDLET -
      THEN DO
           %CMNEMZ2  DD1('&DDN1DD') DSN1('&DSN1DD') +
                     DD2('&DDN1PD') DSN2('&DSN1PD') +
                     DD3('&DDN12D') DSN3('&DSN12D') +
                     DD4('&DDN13D') DSN4('&DSN13D')
           FREE DD(IMS PROCLIB IEFRDER DFSVSAMP)
           ALLOC DD(IMS) DSN('IMSVS.DBDLIB' 'IMSVS.PSBLIB') SHR
           ALLOC DD(PROCLIB) DSN('IMSVS.PARMLIB') SHR
           ALLOC DD(IEFRDER) DUMMY
           ALLOC DD(DFSVSAMP) DSN('IMSVS.SYSSPRT.SYSIN(DFSVSM08)') SHR
           WRITE **  DLT0 DELETE - STARTED EXECUTION  **
           IF &DPSB = &STR() THEN +
              DO
              SET &DPSB = &SUBSTR(1:4,&DBD)P&SUBSTR(5:6,&DBD)Y
              WRITE **  DEFAULT DELETE PSB TO BE USED IS &DPSB  **
              END
           %CMNEMZ3  PSB(&DPSB) PCBNO(1) FUNC(DLET) DATA('') +
                    SSA1(&SEG) SSA2(×) SSA3(×) SSA4(×) SSA5(×) +
                    NUM(0) LISTID('') DSNMEM('') DEBUG('&DEBUG')
           SET &RC = &LASTCC
           IF &RC EQ 0 +
              THEN DO
                   WRITE *****  DLTO DELETE  -  SUCCESSFUL  ******
                   FREE DD(IMS PROCLIB IEFRDER DFSVSAMP)
                   END
              ELSE DO
                   WRITE **********************************************
                   WRITE ...... DLT0 DELETE STEP FAILED ...... RC=&RC
                   WRITE **********************************************
                   END
           END
      ELSE DO
           WRITE * * * * * * * * * * * * * * * * * * *
           WRITE * * * * * DLT0 DELETE STEP  * * * * *
           WRITE * * * * *      SKIPPED      * * * * *
           WRITE * * * * * * * * * * * * * * * * * * *
           GOTO CLISTOK
           END
        END

CLISTOK: WRITE * * * * * * * * * * * * * * * * * * * * * *
         WRITE * * * * *  &TYPE ZERO LOAD ENDED  * * * * *
         WRITE * * * * *          FOR            * * * * *
         WRITE * * * * *      &DBD DATABASE  * * * * *
         WRITE * * * * * * * * * * * * * * * * * * * * * *
GOTO ENDCLIST
FAILED: WRITE * * * * * * * * * * * * * * * * * * * * * *
        WRITE * * * * *  &TYPE ZERO LOAD FAILED * * * * *
        WRITE * * * * *          FOR            * * * * *
        WRITE * * * * *      &DBD DATABASE  * * * * *
        WRITE * * * * * * * * * * * * * * * * * * * * * *
ENDCLIST: FREEALL
CONTROL FLUSH
GOTO LABELA
EXITCLST: EXIT
./ ADD  NAME=CMNEMZ1
PROC 1 FUNCTION DBD(NULL)   DEBUG
IF &DEBUG EQ DEBUG THEN CONTROL MSG SYM CON LIST NOFLUSH
                   ELSE CONTROL NOMSG NOSYM NOCON NOPROMPT
WRITE PREREORG CLIST ENTERED
STATE #PRECNTL R
IF &LASTCC EQ 0 +
   THEN DELETE #PRECNTL
 FREE DD(PARMSWTR )
 ALLOC DSN(#PRECNTL) NEW CATALOG SP(1) TRA DD(PARMSWTR)
 SET &DBDS = &STR(&DBD)
 XEQ PARMSWTR '/&FUNCTION=&DBDS/OPTIONS=(NOPUNCH,STAT,SUMM) '
 FREE DD(PARMSWTR )
 FREE DD(IMS DFSURCDS SYSPRINT SYSIN)
 FREE ATTR(PREATTR)
 ALLOC DD(SYSIN) DSN(#PRECNTL) SHR
 ALLOC DD(IMS) DSN('IMSVS.DBDLIB') SHR
 ALLOC DD(SYSPRINT) DSN(*) SHR
 ATTR  PREATTR LRECL(1600) BLKSIZE(3200) RECFM(F B)
STATE #PRERORG R
IF &LASTCC EQ 0 +
   THEN ALLOC DD(DFSURCDS) DSN(#PRERORG) SHR
   ELSE ALLOC DD(DFSURCDS) DSN(#PRERORG) NEW +
              TR SP(1 1) USING(PREATTR) CATALOG
 FREE ATTR(PREATTR)
 WRITE ** PREREORG -  STARTED EXECUTION **
 XEQ DFSRRC00 'ULU,DFSURPR0'
 SET &RC = &LASTCC
 IF &RC EQ 0 +
    THEN WRITE ** PREREORG -  SUCCESSFUL **
    ELSE DO
         WRITE ****************************
         WRITE .... PREREORG  FAILED ...... RC=&RC
         WRITE ****************************
         END
 FREE DD(IMS SYSPRINT)
 DELETE #PRECNTL
 SET &LASTCC = &RC
./ ADD  NAME=CMNEMZ2
PROC 0  DD1(?) DSN1( ) DD2(?) DSN2( ) DD3(?) DSN3( ) DD4(?) DSN4( ) -
  DD5(?) DSN5( ) DD6(?) DSN6( ) DD7(?) DSN7( ) DD8(?) DSN8( ) -
  DD9(?) DSN9( ) DD10(?) DSN10( ) DD11(?) DSN11( ) DD12(?) DSN12( ) -
  DD13(?) DSN13( ) DD14(?) DSN14( ) DD15(?) DSN15( ) DD16(?) DSN16( ) -
  DD17(?) DSN17( ) DEBUG
IF &DEBUG EQ DEBUG THEN CONTROL MSG CON SYM   PROMPT NOFLUSH
                   ELSE CONTROL NOMSG NOCON NOSYM NOPROMPT
PROF NOPAUSE
SET &MYCC=0
SET &N = 0
   DO WHILE &N LT 17
   SET &N = &N + 1
   SET &D = &STR(&&DD&N)
   SET &DS = &STR(&&DSN&N)
   IF &D NE &STR(?) THEN +
      DO
      FREE DD(&D)
      ALLOC DD(&D) DSN('&DS') OLD
      SET &TEMPCC=&LASTCC
      IF &TEMPCC NE 0 THEN -
         DO
         WRITE ALLOCATION ERROR.  &D  &DS
         IF &TEMPCC GT &MYCC THEN SET &MYCC=&TEMPCC
         END
      END
   END
PROF PAUSE
EXIT CODE(&MYCC)
./ ADD  NAME=CMNEMZ3
PROC 0 PSB() PCBNO(1) FUNC( ) DATA( ) SSA1( ) SSA2(×) SSA3(×) SSA4(×) +
       SSA5(×) NUM( ) LISTID( ) DSNMEM( ) DEBUG()
IF &DEBUG NE DEBUG +
               THEN CONTROL NOMSG NOCON NOSYM NOPROMPT
               ELSE CONTROL MSG CONLIST SYM NOPROMPT NOFLUSH LIST
STATE DLT0WF1 R
IF &LASTCC EQ 0 +
   THEN DELETE DLT0WF1
FREE DD(PRINTDD)
IF &LISTID EQ    +
THEN DO
     ALLOC DD(PRINTDD) DSN(*) SHR
     WRITE NO OUTLIST WILL BE GENERATED
     END
ELSE +
     DO
     STATE &LISTID..OUTLIST R
     IF &LASTCC EQ 0 +
        THEN DO
             ALLOC DD(PRINTDD) DSN(&LISTID..OUTLIST) SHR
             WRITE &SYSUID..&LISTID..OUTLIST WILL BE GENERATED
             END
        ELSE +
             DO
             ALLOC DD(PRINTDD) DSN(&LISTID..OUTLIST) +
                   NEW CATALOG SP(20 10) TRA
             WRITE &SYSUID..&LISTID..OUTLIST WILL BE GENERATED
             END
     END
FREE DD(DFSURWF1)
FREE ATTR(WF1)
ATTRIB WF1 LRECL(300) BLKSIZE(6000) RECFM(V B)
IF &FUNC = ISRT +
   THEN DO
        ALLOC DD(DFSURWF1) DSN(DLT0WF1) +
              NEW SP(2 1) TRA USING(WF1) CATALOG
        END
   ELSE DO
        ALLOC DD(DFSURWF1) DUMMY USING(WF1)
        END
FREE DD(SYSUDUMP)
ALLOC DD(SYSUDUMP) DUMMY
FREE DD(SYSIN)
IF &FUNC EQ   +
   THEN +
     DO
     IF &DSNMEM EQ   +
        THEN +
          DO
          WRITE ENTER DLT0 CONTROL CARDS DATASET (FULLY QUALIFIED NAME):
          READ &DSNMEM
          ALLOC DSN('&DSNMEM') OLD DD(SYSIN)
          GOTO EXECDLT0
          END
        ELSE +
          DO
          ALLOC DSN('&DSNMEM') OLD DD(SYSIN)
          GOTO EXECDLT0
          END
     END
FREE DD(PARMSWTR)
STATE #DLT0 R
IF &LASTCC EQ 0 +
   THEN DO
        ALLOC DSN(#DLT0) DD(PARMSWTR) SHR
        END
   ELSE +
        DO
        FREE ATTR(DLT01)
        ATTRIB DLT01 LRECL(80) BLKSIZE(6160) RECFM(F B)
        ALLOC DSN(#DLT0) NEW CATALOG SP(1) TRA DD(PARMSWTR) +
                                                   USING(DLT01)
        END
IF &FUNC EQ GU OR +
   &FUNC EQ GN OR +
   &FUNC EQ GNP +
   THEN DO
        SET &FU = &STR(GU  )
        SET &S = &STR(OK)
        IF &NUM =   +
           THEN DO
                SET &T = U
                SET &NUMB =
                SET &FUNC =
                END
           ELSE +
                IF &LENGTH(&NUM) = 1 +
                   THEN DO
                        SET &T = &STR(L )
                        SET &U = U000
                        SET &NUMB = &U&NUM
                        END
                   ELSE +
                        IF &LENGTH(&NUM) = 2 +
                           THEN DO
                                SET &T = &STR(L )
                                SET &U = U00
                                SET &NUMB = &U&NUM
                                END
                           ELSE +
                                IF &LENGTH(&NUM) = 3 +
                                   THEN DO
                                        SET &T = &STR(L )
                                        SET &U = U0
                                        SET &NUMB = &U&NUM
                                        END
                                   ELSE +
                                        IF &LENGTH(&NUM) = 4 +
                                           THEN DO
                                                SET &T = &STR(L )
                                                SET &U = U
                                                SET &NUMB = &U&NUM
                                                END
        END
IF &FUNC EQ DLET +
   THEN +
        DO
        SET &FU = &STR(GHU )
        SET &S = &STR(  )
        SET &T = &STR(L )
        SET &NUMB = &STR(     )
        END
IF &FUNC EQ ISRT +
   THEN +
        DO
        SET &FU = ISRT
        END
XEQ PARMSWTR '×-
S 1 1 1 1 1           &PCBNO×-
L  U0001 &FU  &SSA1     ,×&SSA2     ,×&SSA3     ,×&SSA4     ,×&SSA5 '
IF &FUNC = ISRT  +
  THEN +
    IF &DATA NE     +
      THEN DO
           FREE DD(PARMSWTR)
           ALLOC DSN(#DLT0) MOD SP(1) TRA DD(PARMSWTR)
           XEQ PARMSWTR '×L        DATA  &DATA '
           SET &S = &STR(  )
           SET &T = &STR(U )
           SET &NUMB =
           SET &FUNC =
           END
      ELSE +
           DO
           FREE DD(PARMSWTR)
           ALLOC DSN('&DSNMEM') DD(SYSUT1) SHR
           ALLOC DSN(#DLT0) MOD SP(1) TRA DD(SYSUT2)
           XEQ GENER
           FREE DD(SYSUT1 SYSUT2)
           SET &S = &STR(  )
           SET &T = &STR(U )
           SET &NUMB =
           SET &FUNC =
           END
FREE DD(PARMSWTR)
ALLOC DSN(#DLT0) MOD SP(1) TRA DD(PARMSWTR)
XEQ PARMSWTR '×-
EH8    &S          ×-
&T &NUMB &FUNC  '
FREE DD(PARMSWTR)
ALLOC DSN(#DLT0) OLD DD(SYSIN)
PROF WTPMSG
EXECDLT0: XEQ DFSRRC00 'DLI,DFSDDLT0,&PSB'
SET &RC = &LASTCC
PROF NOWTPMSG
STATE #DLT0 R
IF &LASTCC EQ 0 +
   THEN DELETE #DLT0
FREE DD(IMS PROCLIB IEFRDER DFSVSAMP DFSURWF1)
SET &LASTCC = &RC
./ ADD  NAME=CMNEMZ4
PROC 2 DLT0WF1 PREREORG DEBUG
IF &DEBUG NE DEBUG +
   THEN CONTROL NOMSG NOCON NOSYM NOPROMPT
   ELSE CONTROL MSG CONLIST SYM NOPROMPT NOFLUSH LIST
FREE DD(SORTIN SYSUDUMP SYSPRINT SYSOUT SORTIN DFSURWF2 DFSURWF3 +
        DFSURCDS DFSURIDX)
FREE ATTR(WF)
STATE #WF2 R
IF &LASTCC EQ 0 +
   THEN DELETE #WF2
STATE #WF3 R
IF &LASTCC EQ 0 +
   THEN DELETE #WF3
STATE #RESOLVE R
IF &LASTCC EQ 0 +
   THEN DELETE #RESOLVE
ATTRIB WF LRECL(300) BLKSIZE(6000) RECFM(V B)
ALLOC DD(SYSUDUMP) DUMMY
ALLOC DD(SYSPRINT) DSN(*) SHR
ALLOC DD(SYSOUT) DSN(*) SHR
ALLOC DD(SORTIN) DSN(&DLT0WF1) OLD DELETE
ALLOC DD(DFSURCDS) DSN(&PREREORG) OLD DELETE
ALLOC DD(DFSURWF2) DSN(#WF2) NEW SP(2 1) TRA USING(WF) DELETE
ALLOC DD(DFSURWF3) DSN(#WF3) NEW SP(2 1) TRA USING(WF) DELETE
ALLOC DD(DFSURIDX) DSN(#RESOLVE) NEW SP(2 1) TRA USING(WF) CATALOG
WRITE ** RESOLVE -  STARTED EXECUTION **
XEQ DFSURG10
SET &RC = &LASTCC
IF &RC EQ 0 +
   THEN WRITE ** RESOLVE  SUCCESSFUL **
   ELSE DO
        WRITE *************************
        WRITE .... RESOLVE  FAILED .... RC=&RC
        WRITE *************************
        END
FREE DD(SORTIN SYSUDUMP SYSPRINT SYSOUT DLT0WF1 DFSURWF2 DFSURWF3 +
        PREREORG DFSURIDX)
FREE ATTR(WF)
SET &LASTCC = &RC
./ ADD  NAME=CMNEMZ5
PROC 3 INDEXWK DBDNAME DBDSN DEBUG
IF &DEBUG NE DEBUG +
   THEN CONTROL NOMSG NOCON NOSYM NOPROMPT
   ELSE CONTROL MSG CONLIST SYM NOPROMPT NOFLUSH LIST
STATE #CDS R
IF &LASTCC EQ 0 +
   THEN DELETE #CDS
STATE #UNLOAD R
IF &LASTCC EQ 0 +
   THEN DELETE #UNLOAD
 FREE DD(PARMSWTR )
 ALLOC DD(PARMSWTR) DSN(#CDS) NEW TRA SP(1) CATALOG
 XEQ PARMSWTR '/X1M&DBDNAME &DBDNAME WKOUTDD           INDEXWK   '
 FREE DD(PARMSWTR )
 FREE DD(IMS SYSPRINT WKOUTDD INDEXWK DFSVSAMP &DBDNAME SYSIN)
 ALLOC DD(IMS) DSN('IMSVS.DBDLIB') SHR
 ALLOC DD(SYSPRINT) DSN(*) SHR
 ALLOC DD(WKOUTDD) DSN(#UNLOAD) NEW SP(1 1) TRA CATALOG
 ALLOC DD(INDEXWK) DSN(&INDEXWK) OLD KEEP
 ALLOC DD(DFSVSAMP) DSN('IMSVS.SYSSPRT.SYSIN(DFSVSM08)') SHR
 ALLOC DD(&DBDNAME) DSN('&DBDSN') OLD
 ALLOC DD(SYSIN) DSN(#CDS) SHR
 WRITE ** UNLOAD -  STARTED EXECUTION **
 XEQ DFSRRC00 'ULU,DFSURUL0'
 SET &RC = &LASTCC
 IF &RC LE 4 +
    THEN WRITE ** UNLOAD -  SUCCESSFUL **
    ELSE DO
         WRITE **************************
         WRITE .... UNLOAD  FAILED ...... RC=&RC
         WRITE **************************
         END
 FREE DD(IMS SYSPRINT WKOUTDD INDEXWK DFSVSAMP &DBDNAME)
 DELETE #CDS
 SET &LASTCC = &RC
./ ADD  NAME=CMNEMZ6
PROC 3 INDSN DBDNAME DBDSN DEBUG
IF &DEBUG NE DEBUG +
   THEN CONTROL NOMSG NOCON NOSYM NOPROMPT
   ELSE CONTROL MSG CONLIST SYM NOPROMPT NOFLUSH LIST
 FREE DD(IMS SYSPRINT DFSUIN01 &DBDNAME)
 ALLOC DD(IMS) DSN('IMSVS.DBDLIB') SHR
 ALLOC DD(SYSPRINT) DSN(*) SHR
 ALLOC DD(DFSUIN01) DSN(&INDSN) OLD DELETE
 ALLOC DD(&DBDNAME) DSN('&DBDSN') OLD
 ALLOC DD(DFSVSAMP) DSN('IMSVS.SYSSPRT.SYSIN(DFSVSM08)') SHR
 WRITE ** RELOAD -  STARTED EXECUTION **
 XEQ DFSRRC00 'ULU,DFSURRL0'
 SET &RC = &LASTCC
 IF &RC LE 4 +
    THEN WRITE ** RELOAD -  SUCCESSFUL **
    ELSE DO
         WRITE *************************
         WRITE ....RELOAD  FAILED ...... RC=&RC
         WRITE *************************
         END
 FREE DD(IMS SYSPRINT DFSUIN01 &DBDNAME)
 SET &LASTCC = &RC
./ ADD  NAME=CMNEUL0
PROC 0
/*      CONTROL MSG CONLIST SYM LIST */
        ISPEXEC VGET (CMNEULVL CMNEULDS Z ZPREFIX) SHARED
        IF &CMNEULVL EQ &Z AND &CMNEULDS EQ &Z THEN +
           SET &CMNEULVL = &ZPREFIX
LOOP1:  ISPEXEC DISPLAY PANEL(CMNEUL0)
        IF &LASTCC NE 0 THEN GOTO END
        IF &CMNEULEX NE &Z THEN SET &EX = EX
           ELSE SET &EX = &Z
        IF &CMNEULVL NE &Z THEN GOTO LEVEL
        LISTSPC DA(&CMNEULDS) &EX
        GOTO LOOP1
LEVEL:  LISTSPC LEVEL(&CMNEULVL) &EX
        GOTO LOOP1
END:   ISPEXEC CONTROL DISPLAY REFRESH
./ ADD  NAME=CMNEUQ0
PROC 0
Q
ISPEXEC CONTROL DISPLAY REFRESH
./ ADD  NAME=CMNEVA0
PROC 0 DEBUG()
LOOP:+
     SET &OPT =
     ISPEXEC DISPLAY PANEL(CMNEVA0)
     IF LASTCC NE 0 THEN EXIT
     IF &DEBUG EQ DEBUG THEN CONTROL MSG CONLIST SYM LIST
     GOTO LABEL&OPT
/* ARCHIVE INQUIRY */
LABEL: +
        $AI U(&QUAL) COM
        GOTO LOOP
/* ARCHIVE REQUEST */
LABELA: +
        IF &DSN1 ^= THEN $AR &DSN1
        IF &DSN2 ^= THEN $AR &DSN2
        IF &DSN3 ^= THEN $AR &DSN3
        IF &DSN4 ^= THEN $AR &DSN4
        IF &DSN5 ^= THEN $AR &DSN5
        IF &DSN6 ^= THEN $AR &DSN6
        IF &DSN7 ^= THEN $AR &DSN7
        IF &DSN8 ^= THEN $AR &DSN8
        GOTO LOOP
/* ARCHIVE RETRIEVAL */
LABELR: $RA &DSN1 &DSN2 &DSN3 &DSN4 &DSN5 &DSN6 &DSN7 &DSN8
        GOTO LOOP
/* DELETE ARCHIVE */
LABELD: $DA &DSN1 &DSN2 &DSN3 &DSN4 &DSN5 &DSN6 &DSN7 &DSN8
        GOTO LOOP
/* BROWSE $RA PROCESSED MESSAGE */
LABELB: ISPEXEC BROWSE DATASET('SYST.DSS.$RAMSG')
        GOTO LOOP
./ ADD  NAME=CMNEVS0
PROC 0
LOOP: +
 ISPEXEC DISPLAY PANEL(CMNEVS0)
 IF &LASTCC NE 0 THEN EXIT
 CLEAR
 ALLOC DD($RSOUT) DSN(*) SHR
 IF &ID = ALL -
 THEN-
 $RSVP-
  VOL(&VOL)-
  NOTBEGIN(SYST.VOLUME VSAMDSET Z9999)-
  LIMIT(CDATE LE *-&DAYS) AND1(ALLOC GT 0)-
  HEADING1(' &SYSDATE              DATA SETS MORE THAN &DAYS DAYS OLD')-
  PRINT(NEW (DSNAME CDATE ALLOC USED VOL))  TRKS-
  LINES(26) CHARS(80)
 ELSE-
 $RSVP-
  VOL(&VOL)-
  BEGIN(&ID)-
  LIMIT(CDATE LE *-&DAYS) AND1(ALLOC GT 0)-
  HEADING1(' &SYSDATE              DATA SETS MORE THAN &DAYS DAYS OLD')-
  PRINT(NEW (DSNAME CDATE ALLOC USED VOL))  TRKS-
  LINES(26) CHARS(80)
 FREE FILE($RSOUT)
 GOTO LOOP
./ ADD  NAME=DEBUG
IF &DEBUG EQ DEBUG THEN CONTROL MSG SYM CON LIST
                   ELSE CONTROL NOMSG NOSYM NOCON NOPROMPT
./ ADD  NAME=IMSEMF2
PROC 0
        ISPEXEC VGET (IMSEMF21 IMSEMF22 IMSEMF23) PROFILE
LABELA: ISPEXEC DISPLAY PANEL(IMSEMF2)
        IF &LASTCC NE 0  THEN  GOTO EXITCLST
        IF &DEBUG NE DEBUG THEN CONTROL NOMSG NOCON NOSYM NOPROMPT
                           ELSE CONTROL MSG CON SYM   PROMPT NOFLUSH
        ISPEXEC VPUT (IMSEMF21 IMSEMF22 IMSEMF23) PROFILE
        SET &PRJ1     = &IMSEMF21
        SET &LIB1     = &IMSEMF22
        SET &TYPE     = &IMSEMF23
        SET &MBR      = &IMSEMF24
        SET &TERM     = &IMSEMF26

IF &DEBUG EQ DEBUG THEN CONTROL MSG SYM CON LIST  NOFLUSH
                   ELSE CONTROL NOMSG NOSYM NOCON NOPROMPT FLUSH
        %CMNEMPC  &PRJ1 &LIB1 &TYPE &MBR &DEBUG
        SET &ASMCC = &LASTCC
        IF &ASMCC LE 4 THEN +
           DO
           %CMNEMPL  &PRJ1 &LIB1 &MBR &DEBUG
           %CMNEMPR &LIB1.ASM.LIST #TEMP1 GEN OUTPUT(&TERM) &DEBUG
           %IMSEMPM &PRJ1 &LIB1 &MBR TERM(&TERM) &DEBUG
           IF &TERM EQ NOTERM AND &LIB1 EQ DBDS  THEN +
              DO
              %CMNEMPG SYST.IMSVS.DBDDOC MBR(&MBR) +
                        SYSUT1('#TEMP1 #TEMP3') &DEBUG
              DELETE (#TEMP1 #TEMP2 #TEMP3)
              END
           END
           ELSE WRITE ASM FAILED SEE &SYSUID..ASM.DBDLIST FOR ERRORS
        GOTO LABELA
EXITCLST: EXIT
./ ADD  NAME=IMSEMM1
PROC  2 SYSUT1 SYSUT2  DEBUG
IF &DEBUG EQ DEBUG THEN CONTROL MSG SYM CON LIST
                   ELSE CONTROL NOMSG NOSYM NOCON NOPROMPT
FREE  DD(SYSUT1 SYSUT2)
CONTROL MSG
ALLOC DD(SYSUT1) DSN(&SYSUT1)SHR
ALLOC DD(SYSUT2) DSN(&SYSUT2)SHR
CONTROL NOMSG
XEQ  DADA012B
FREE  DD(SYSUT1 SYSUT2)
./ ADD  NAME=IMSEMM3
PROC 3 INDSN OUTDSN LID DEBUG
CONTROL NOMSG NOCON NOSYM NOPROMPT
IF &DEBUG NE DEBUG THEN CONTROL NOMSG NOCON NOSYM NOPROMPT
                   ELSE CONTROL MSG CON SYM NOPROMPT NOFLUSH LIST
  FREE  DD(SYSIN SYSOUT SYSPRINT SORTCNTL)
  ALLOC DD(SYSIN) DSN('&INDSN') SHR
IF &LID NE NULL THEN +
   DO
   SET &PARM = NULL
   STATE &LID R
   IF &LASTCC EQ 0 THEN +
      DO
      ALLOC DD(SYSPRINT) DSN(&LID..LIST)
      SET &DSN = &SYSPREF..&LID..LIST
      WRITE PRE-PROCESSOR OUTPUT WILL BE WRITTEN TO DSN=&DSN
      END
      ELSE +
      DO
      CONTROL MSG
      ALLOC DD(SYSPRINT) DSN(&LID..LIST) NEW SP(1 1) TR
      CONTROL NOMSG
      SET &DSN = &SYSPREF..&LID..LIST
      WRITE PRE-PROCESSOR OUTPUT WILL BE WRITTEN TO DSN=&DSN
      END
   END
   ELSE +
   DO
   SET &PARM = SPFOUT
   ALLOC DSN(*) DD(SYSPRINT)
   END
  STATE MFS.UNSORT  R
  IF &LASTCC NE 0 THEN +
     DO
     FREE  ATTRLIST(MACOUT)
     ATTRIB MACOUT BLKSIZE(5950) RECFM(F B)
     CONTROL MSG
     ALLOC DD(SYSOUT) DSN(MFS.UNSORT) TR USING(MACOUT) +
     SP(10 10) TR  NEW CATALOG
     CONTROL NOMSG
     FREE  ATTRLIST(MACOUT)
     END
     ELSE ALLOC DD(SYSOUT) DSN(MFS.UNSORT) SHR
  STATE MFS.SORTIN  R
  IF &LASTCC NE 0 THEN +
     DO
     FREE  ATTRLIST(CNTLOUT)
     ATTRIB CNTLOUT BLKSIZE(80) RECFM(F B) LRECL(80)
     CONTROL MSG
     ALLOC DD(SORTCNTL) DSN(MFS.SORTIN) TR USING(CNTLOUT) +
     SP(1 1) TR NEW CATALOG
     CONTROL NOMSG
     FREE  ATTRLIST(CNTLOUT)
     END
     ELSE ALLOC DD(SORTCNTL) DSN(MFS.SORTIN) SHR
  XEQ DADA016B '&PARM'
  SET &CC = &LASTCC
  SET &SCRNCC = &CC
  FREE  DD(SYSIN SYSOUT SYSPRINT)
  FREE  ATTRLIST(MACOUT )
  IF &SUBSTR(1:1,&CC) EQ U OR &SUBSTR(1:1,&CC) EQ S OR &CC GT 4 THEN +
     DO
     WRITE +
     PRE-PROCESSOR ENDED WITH A RC = &CC
     WRITE +
     SORT WILL NOT BE EXECUTED AND FURTHER PROCESSING IS TERMINATED
     XEQ SYSWAIT '000001'
     IF &SUBSTR(1:1,&CC) EQ U OR &SUBSTR(1:1,&CC) EQ S THEN +
        SET &CC = &SUBSTR(2:4,&CC)
     END
     ELSE +
     DO
     FREE  DD(SYSIN SYSOUT SORTIN SORTOUT)
     ALLOC DD(SORTIN) DSN(MFS.UNSORT) OLD DELETE
     ALLOC DD(SYSOUT) DUMMY
     ALLOC DD(SYSIN) DSN(MFS.SORTIN) OLD DELETE
     ALLOC DD(SORTOUT) DSN('&OUTDSN') SHR
     WRITE +
     PRE-PROCESSOR ENDED WITH A RC = &CC  SORT WILL NOW BE EXECUTED
     XEQ ICEMAN
     FREE  DD(SYSIN SYSOUT SORTIN SORTOUT)
     END
  CLEAR
EXIT CODE(&SCRNCC)
./ ADD  NAME=IMSEMM4
PROC 3 MACROLIB FMTLIB LID DEBUG
CONTROL NOMSG NOCON NOSYM NOPROMPT NOFLUSH
DELETE SEQBLKS
DELETE TEMPPDS
DELETE TEXTPASS
DELETE TEMPPRNT
IF &DEBUG NE DEBUG THEN CONTROL NOMSG NOCON NOSYM NOPROMPT
                   ELSE CONTROL MSG CON SYM NOPROMPT NOFLUSH LIST
FREE  DD(SYSIN REFIN REFOUT REFRD SYSTEXT SEQBLKS SYSPRINT)
FREE ATTRLIST(B4000 FB133)
CONTROL MSG
ALLOC DD(SYSIN) DSN('&MACROLIB') SHR
ALLOC DD(REFIN) DSN(TEMPREF) NEW SPACE(1 1) TR  DIR(01) DELETE
ALLOC DD(REFOUT) DSN(TEMPPDS) NEW SPACE(1 1) TR  DIR(01) DELETE
ALLOC DD(REFRD) DSN(TEMPPDS) SHR DELETE
ALLOC DD(SEQBLKS) DSN(SEQBLKS) NEW SPACE(9 1) TR CATALOG
ATTR B4000 BLKSIZE(4000)
ALLOC DD(SYSTEXT) DSN(TEXTPASS) NEW SPACE(9 1) TR CATALOG USING(B4000)
ATTR FB133 LRECL(133) BLKSIZE(6118) RECFM(F B)
ALLOC DD(SYSPRINT) DSN(TEMPPRNT) NEW CATALOG SP(2 1) TR USING(FB133)
FREE ATTRLIST(B4000 FB133)
PROF WTPMSG
XEQ DFSUPAA0 -
     'NOXREF,NOCOMP,NOSUBS,NODIAG,NOCOMPRESS,LINECNT=55,STOPRC=8'
SET &CC = &LASTCC
CONTROL NOMSG
FREE  DD(SYSIN REFIN REFOUT REFRD SYSTEXT SEQBLKS SYSPRINT)
IF &SUBSTR(1:1,&CC) EQ U OR &SUBSTR(1:1,&CC) EQ S OR &CC GT 8 THEN +
   DO
      WRITE MFS EDIT ENDED WITH A RC = &CC TFORMAT WILL NOT BE UPDATED
   IF &LID NE NULL THEN +
      DO
      SET &DSN = &LID..LIST
      WRITE MFS-EDIT OUTPUT WILL BE WRITTEN TO DSN=&SYSPREF..&DSN
      %CMNEMPR  TEMPPRNT &DSN ALL &DEBUG OUTPUT(NOTERM)
      END
      ELSE +
      DO
      %CMNEMPR  TEMPPRNT &LID ALL &DEBUG OUTPUT(TERM)
      END
   DELETE TEXTPASS
   DELETE TEMPPRNT
   END
   ELSE +
   DO
   WRITE MFS EDIT ENDED WITH A RC = &CC TFORMAT WILL NOW BE UPDATED
   IF &LID NE NULL THEN +
      DO
      SET &DSN = &LID..LIST
      WRITE MFS-EDIT OUTPUT WILL BE WRITTEN TO DSN=&SYSPREF..&DSN
      %CMNEMPR  TEMPPRNT &DSN MFS &DEBUG OUTPUT(NOTERM)
      END
   CONTROL NOMSG
   DELETE TEMPPRNT
   FREE  DD(FORMAT SEQBLKS UTPRINT)
   CONTROL MSG
   ALLOC DD(SEQBLKS) DSN(SEQBLKS) DELETE
   ALLOC DD(UTPRINT) DSN(*)
   STATE '&FMTLIB' R
   IF &LASTCC EQ 0 THEN +
      DO
      ALLOC DD(FORMAT) DSN('&FMTLIB') SHR
      END
   ELSE +
      DO
      FREE ATTR(FMTATR1)
      ATTRIB FMTATR1 BLKSIZE(19069) LRECL(19069) RECFM(U) DSORG(PO)
      ALLOC DD(FORMAT) DSN('&FMTLIB') SP(2,1) TRA DIR(3)  +
         USING(FMTATR1) NEW
      FREE ATTR(FMTATR1)
      END
   CONTROL NOMSG
   XEQ DFSUNUB0 'TEST'
   SET &CC = &LASTCC
   WRITE MFS UPDT ENDED WITH A RC = &CC
   FREE  DD(FORMAT SEQBLKS UTPRINT)
   DELETE TEXTPASS
   END
DONE: +
CLEAR
./ ADD  NAME=IMSEMPD
PROC 4 PRJ1 LIB1 TYPE MBR  TERM(NOTERM) DEBUG
IF &DEBUG EQ DEBUG THEN CONTROL MSG SYM CON LIST  NOFLUSH
                   ELSE CONTROL NOMSG NOSYM NOCON NOPROMPT FLUSH
        %CMNEMPC  &PRJ1 &LIB1 &TYPE &MBR &DEBUG
        SET &ASMCC = &LASTCC
        IF &ASMCC LE 4 THEN +
           DO
           %CMNEMPL  &PRJ1 &LIB1 &MBR &DEBUG
           %CMNEMPR &LIB1.ASM.LIST #TEMP1 GEN OUTPUT(&TERM) &DEBUG
           %IMSEMPM &PRJ1 &LIB1 &MBR TERM(&TERM) &DEBUG
           IF &TERM EQ NOTERM AND &LIB1 EQ DBDS  THEN +
              DO
              %CMNEMPG SYST.IMSVS.DBDDOC MBR(&MBR) +
                        SYSUT1('#TEMP1 #TEMP3') &DEBUG
              DELETE (#TEMP1 #TEMP2 #TEMP3)
              END
           END
           ELSE WRITE ASM FAILED SEE &SYSUID..ASM.DBDLIST FOR ERRORS
./ ADD  NAME=IMSEMPM
PROC 3 PRJ1 LIB1 MBR TERM(NOTERM) DEBUG
IF &DEBUG EQ DEBUG THEN CONTROL MSG SYM CON LIST
                   ELSE CONTROL NOMSG NOSYM NOCON NOPROMPT
 FREE DD(PARMSWTR)
 DELETE #DBDCNTL
 ALLOC DSN(#DBDCNTL) NEW CATALOG SP(1) TRA DD(PARMSWTR)
 XEQ PARMSWTR '  &MBR      '
 FREE DD(DBDLIB SYSOUT  SYSIN )
 IF &LIB1 = DBDS +
    THEN +
    DO
    ALLOC  DD(DBDLIB) DSN('&PRJ1..DBDLIB') SHR
    END
    ELSE +
    DO
    ALLOC  DD(DBDLIB) DSN(Z.LOAD) SHR
    END
 ALLOC DD(SYSIN)     DSN(#DBDCNTL) SHR
 IF &TERM = NOTERM +
    THEN +
    DO
    STATE #TEMP2  R
    IF &LASTCC NE 0 THEN +
       DO
       FREE ATTR(DCBTEMP)
       ATTRIB DCBTEMP LRECL(133) BLKSIZE(6118) RECFM(F B A)
       ALLOC DD(SYSOUT) DSN(#TEMP2) SHR +
             USING(DCBTEMP) NE CATALOG TRA SP(1 1)
       FREE ATTR(DCBTEMP)
       END
       ELSE +
       ALLOC DSN(#TEMP2) SHR DD(SYSOUT)
    END
    ELSE +
    DO
    ALLOC DD(SYSOUT) DSN(*) SHR
    END
 XEQ DBDMAP
 WRITE DBDMAP COMPLETED
 DELETE #DBDCNTL
 FREE DD(DBDLIB SYSOUT SYSOUT SYSIN )
 IF &TERM = NOTERM +
    THEN +
    DO
    %CMNEMPR #TEMP2 #TEMP3 MAP OUTPUT(&TERM) &DEBUG
    END
 CLEAR
./ ADD  NAME=IMSEMP3
PROC 0
        ISPEXEC VGET (CMNEMP31 CMNEMP32 CMNEMP33) PROFILE
LABELA: ISPEXEC DISPLAY PANEL(CMNEMP3)
        IF &LASTCC NE 0  THEN  GOTO EXITCLST
        IF &DEBUG NE DEBUG THEN CONTROL NOMSG NOCON NOSYM NOPROMPT
                           ELSE CONTROL MSG CON SYM   PROMPT NOFLUSH
        ISPEXEC VPUT (CMNEMP31 CMNEMP32 CMNEMP33) PROFILE
        SET &PROJECT  = &CMNEMP31
        SET &LIBRARY  = &CMNEMP32
        SET &TYPE     = &CMNEMP33
        SET &MBR      = &CMNEMP34
        SET &OUTPUT   = &CMNEMP36
        IF &CMNEMP35 = 1  THEN  SET &FUNCTION = PSBGEN
        IF &CMNEMP35 = 2  THEN  SET &FUNCTION = PSBMAP
        IF &CMNEMP35 = 3  THEN  SET &FUNCTION = ACBGEN
IF &LIBRARY = PSBS OR +
   &LIBRARY = DBDS    THEN +
   IF &SYSUID NE C@96494 AND +
      &SYSUID NE D@96212 AND +
      &SYSUID NE D@97014 AND +
      &SYSUID NE D@97146 AND +
      &SYSUID NE D@97198 AND +
      &SYSUID NE E$21482   THEN  GOTO EXITCLST

   IF &CMNEMP35 = D  THEN  GOTO EXDBDGEN

ISPEXEC CONTROL DISPLAY LINE START(1)

IF &FUNCTION = PSBGEN THEN +
   DO
   %CMNEMPP &PROJECT &LIBRARY &TYPE &MBR OUTPUT(&OUTPUT) &DEBUG
   END
   ELSE +
   DO
   IF &FUNCTION = PSBMAP THEN +
      DO
      %CMNEMPM &PROJECT &LIBRARY &TYPE &MBR OUTPUT(&OUTPUT) &DEBUG
         IF &OUTPUT NE TERM AND &OUTPUT EQ SAVE THEN +
            DO
            %CMNEMPG &SYSUID..PSBMAP.OUTLIST MBR(NULL) +
                      SYSUT1('#TEMP4 #TEMP5') &DEBUG
            WRITE PSBMAP OUTPUT WRITTEN TO &SYSUID..PSBMAP.OUTLIST
            DELETE (#TEMP2 #TEMP3 #TEMP4 #TEMP5)
            END
         IF &OUTPUT NE TERM AND &OUTPUT NE SAVE THEN +
            DO
            %CMNEMPG &OUTPUT..PSBMAP.OUTLIST MBR(NULL) +
                      SYSUT1('#TEMP4 #TEMP5') &DEBUG
            WRITE PSBMAP OUTPUT WRITTEN TO +
                  &SYSUID..&OUTPUT..PSBMAP.OUTLIST
            DELETE (#TEMP2 #TEMP3 #TEMP4 #TEMP5)
            END
      END
      ELSE +
      DO
      IF &FUNCTION = ACBGEN THEN +
         DO
         %CMNEMPA &PROJECT &LIBRARY &TYPE &MBR OUTPUT(&OUTPUT) &DEBUG
         IF &OUTPUT NE TERM AND &OUTPUT EQ SAVE THEN +
            DO
            %CMNEMPG CMNEMPA.OUTLIST MBR(NULL) +
                      SYSUT1('#TEMP7') &DEBUG
            WRITE CMNEMPA OUTPUT WRITTEN TO &SYSUID..CMNEMPA.OUTLIST
            DELETE (#TEMP7)
            END
         IF &OUTPUT NE TERM AND &OUTPUT NE SAVE THEN +
            DO
            %CMNEMPG &OUTPUT..CMNEMPA.OUTLIST MBR(NULL) +
                      SYSUT1('#TEMP7') &DEBUG
            WRITE CMNEMPA OUTPUT WRITTEN TO +
                  &SYSUID..&OUTPUT..CMNEMPA.OUTLIST
            DELETE (#TEMP7)
            END
         END
         ELSE WRITE OPTION &FUNCTION NOT AVAILABLE AS YET
      END
   END
   GOTO LABELA
EXDBDGEN: %IMSEMPD &PROJECT &LIBRARY &TYPE &MBR TERM(&OUTPUT) &DEBUG
          GOTO LABELA
EXITCLST: EXIT
./ ADD  NAME=MVSEC00
PROC 0
CONSOLE
ISPEXEC CONTROL DISPLAY REFRESH
./ ADD  NAME=MVSEH00
PROC 0
RMFMON
ISPEXEC CONTROL DISPLAY REFRESH
./ ADD  NAME=MVSEI00
PROC 0
ALLOC DSN('SYS1.OZ.VSAM') SHR DD(VSAM)
ALLOC DSN('PRODCAT.ASM2.INFO') SHR DD(VSAM2)
XEQ BLGOZD
FREE DD(VSAM)
FREE DD(VSAM2)
ISPEXEC CONTROL DISPLAY REFRESH
./ ADD  NAME=MVSES00
PROC 0
      ISPEXEC VGET (MVSES1DP MVSES1VP MVSES1VS MVSES1VD) PROFILE
      SET &CC = 0
DISP: ISPEXEC DISPLAY PANEL(MVSES00)
      IF &LASTCC NE 0 THEN GOTO VPUT
      IF &DEBUG NE DEBUG THEN CONTROL NOMSG NOCON NOSYM NOLIST NOPROMPT
                         ELSE CONTROL   MSG   CON   SYM   LIST NOPROMPT
      FREE  DD(SMPPTS SMPCDS SMPCRQ SMPMTS SMPSTS SMPACDS SMPACRQ -
               SMPLOG SMPOUT SMPRPT SMPCNTL SMPLIST)
      SET &MAXCC = 0
      CONTROL MSG
      IF &LENGTH(&MVSES1VP) NE 0 THEN -
         ALLOC DSN('&MVSES1DP.SMPPTS') DD(SMPPTS)  VOL(&MVSES1VP) -
         SHR UNIT(SYSALLDA)
      IF &LENGTH(&MVSES1VS) EQ 0 THEN GOTO NOSYS
      IF &LENGTH(&MVSES1V1) EQ 0 THEN -
         SET &MVSES1V1 = &MVSES1VS
         ALLOC DSN('&MVSES1DP.SMPCDS') DD(SMPCDS)  VOL(&MVSES1V1) -
         SHR UNIT(SYSALLDA)
      IF &LENGTH(&MVSES1V2) EQ 0 THEN -
         SET &MVSES1V2 = &MVSES1VS
         ALLOC DSN('&MVSES1DP.SMPCRQ') DD(SMPCRQ)  VOL(&MVSES1V2) -
         SHR UNIT(SYSALLDA)
      IF &LENGTH(&MVSES1V3) EQ 0 THEN -
         SET &MVSES1V3 = &MVSES1VS
         ALLOC DSN('&MVSES1DP.SMPMTS') DD(SMPMTS)  VOL(&MVSES1V3) -
         SHR UNIT(SYSALLDA)
      IF &LENGTH(&MVSES1V4) EQ 0 THEN -
         SET &MVSES1V4 = &MVSES1VS
         ALLOC DSN('&MVSES1DP.SMPSTS') DD(SMPSTS)  VOL(&MVSES1V4) -
         SHR UNIT(SYSALLDA)
NOSYS: -
      IF &LENGTH(&MVSES1VD) EQ 0 THEN GOTO NODLB
      IF &LENGTH(&MVSES1V8) EQ 0 THEN -
         SET &MVSES1V8 = &MVSES1VD
         ALLOC DSN('&MVSES1DP.SMPACDS') DD(SMPACDS) VOL(&MVSES1V8) -
         SHR UNIT(SYSALLDA)
      IF &LENGTH(&MVSES1V9) EQ 0 THEN -
         SET &MVSES1V9 = &MVSES1VD
         ALLOC DSN('&MVSES1DP.SMPACRQ') DD(SMPACRQ) VOL(&MVSES1V9) -
         SHR UNIT(SYSALLDA)
NODLB: -
      IF &MAXCC NE 0 THEN GOTO DISP
      ALLOC DD(SMPLOG)   DUMMY
      ALLOC DD(SMPOUT)   DSN(*)
      ALLOC DD(SMPLIST)  DSN(*)
      ALLOC DD(SMPRPT)   DSN(*)
      ALLOC DD(SMPCNTL)  DSN(*)
      XEQ HMASMP 'DATE=U'
      SET &CC = &LASTCC
      CONTROL NOMSG
      FREE  DD(SMPPTS SMPCDS SMPCRQ SMPMTS SMPSTS SMPACDS SMPACRQ -
               SMPLOG SMPOUT SMPRPT SMPCNTL SMPLIST)
VPUT: CONTROL NOMSG
      ISPEXEC VPUT (MVSES1DP MVSES1VP MVSES1VS MVSES1VD) PROFILE
      EXIT CODE(&CC)
./ ADD  NAME=MVSEUA0
PROC 0
ALLOC DSN('SYS1.UADS') SHR DD(SYSUADS)
ISPEXEC CONTROL DISPLAY LINE START(1)
ACCOUNT
./ ADD  NAME=MVSEUT0
PROC 0
/*                                                                    */
/* CONTROL MSG SYM CON LIST                                           */
   CONTROL MSG NOSYM NOCON NOLIST
       ISPEXEC VGET (MVSEUT1 MVSEUT2 MVSEUT3 MVSEUT4 MVSEUT5 +
                     MVSEUT6 MVSEUT7 MVSEUT8 MVSEUT9 MVSEUTA +
                     MVSEUTB MVSEUTC MVSEUTD MVSEUTE) PROFILE
       ISPEXEC VGET (ZUSER Z) SHARED
       SET &FIRST EQ YES
/*--------------------------------------------------------------------*/
/*            DISPLAY THE PANEL                                       */
/*--------------------------------------------------------------------*/
LOOP:  ISPEXEC DISPLAY PANEL(MVSEUT0)
       IF &LASTCC NE 0 THEN GOTO END
/*--------------------------------------------------------------------*/
/*            ALLOCATE UADS AND INVOKE ACCOUNT COMMAND                */
/*--------------------------------------------------------------------*/
      IF &FIRST EQ NO THEN GOTO TYPE
      ALLOC DSN('SYS1.UADS') SHR DD(SYSUADS)
      SET &FIRST EQ NO
/*--------------------------------------------------------------------*/
/*            DETERMINE REQUEST TYPE - ADD CHG DEL                    */
/*--------------------------------------------------------------------*/
TYPE: IF &MVSEUTE EQ ADD THEN GOTO ADD
/*    IF &MVSEUTE EQ CHG THEN GOTO CHG */
      IF &MVSEUTE EQ DEL THEN GOTO DEL
      SET &MSGID EQ CMN018
      ISPEXEC DISPLAY PANEL(MVSEUT0) MSG(MSGID)
      IF &LASTCC NE 0 THEN GOTO END
      GOTO TYPE
/*--------------------------------------------------------------------*/
/*            DEL USER-ID FROM UADS                                   */
/*--------------------------------------------------------------------*/
/*                                                                    */
DEL:  ACCOUNT
      DEL (&MVSEUT1)
      END
      PROF PRE(&MVSEUT1)
LC:   ISPEXEC CONTROL DISPLAY LINE START(1)
      LISTC
WNR:  WRITENR ENTER DELETE REQUESTS, LIST OR NULL
      READ &A1 &A2 &A3 &A4 &A5 &A6 &A7 &A8 &A9
      IF &A1 EQ &Z THEN GOTO RESET
      IF &A1 EQ LIST THEN GOTO LC
      DEL (&A1 &A2 &A3 &A4 &A5 &A6 &A7 &A8 &A9)
      GOTO LC
RESET:  PROF PRE(&ZUSER)
  GOTO LOOP
/*--------------------------------------------------------------------*/
/*            ADD USER-ID TO UADS                                     */
/*--------------------------------------------------------------------*/
ADD:  ACCOUNT
      ADD (&MVSEUT1 &MVSEUT2 &MVSEUT3 &MVSEUT4) UNIT(&MVSEUT5) +
           USER(&MVSEUT6) DEST(&MVSEUT7) &MVSEUT8 &MVSEUT9 +
           &MVSEUTA &MVSEUTB
      END
  IF &LASTCC NE 0 THEN GOTO FAIL
/*--------------------------------------------------------------------*/
/*            SET UP                                                  */
/*--------------------------------------------------------------------*/
FREE ATTR(F80X77)
FREE ATTR(F80X40)
FREE ATTR(U19069X0)
ATTR F80X77 BLK(6160) LRECL(80) RECFM(F B)
ATTR F80X40 BLK(3200) LRECL(80) RECFM(F B)
ATTR U19069X0 BLK(19069) LRECL(0) RECFM(U)
/*--------------------------------------------------------------------*/
/*            ADD ALIAS IN MCAT FOR USERID POINTING TO THE            */
/*            CVOL CATLG ON THE INDICATED DISK                        */
/*--------------------------------------------------------------------*/
SET &CDISK=&MVSEUTC
IF &MVSEUTC=TSO352 THEN SET &CDISK=TSO351
IF &MVSEUTC=RJE355 THEN SET &CDISK=RJE356
DEF ALIAS (NAME('&MVSEUT1') RELATE('SYSCTLG.V&CDISK')
/*                                                                    */
/*            ALLOCATE Z.ASM                                          */
/*                                                                    */
ALLOC DSN('&MVSEUT1..Z.ASM') NE USING(F80X77) SP(10 10) DIR(50) -
      TRA VOL(&MVSEUTC) UNIT(3350)
/*                                                                    */
/*            ALLOCATE Z.COBOL                                        */
/*                                                                    */
ALLOC DSN('&MVSEUT1..Z.COBOL') NE USING(F80X77) SP(10 10) DIR(50) -
      TRA VOL(&MVSEUTC) UNIT(3350)
/*                                                                    */
/*            ALLOCATE Z.DATA                                         */
/*                                                                    */
ALLOC DSN('&MVSEUT1..Z.DATA') NE USING(F80X77) SP(10 10) DIR(50) -
      TRA VOL(&MVSEUTC) UNIT(3350)
/*                                                                    */
/*            ALLOCATE Z.OBJ                                          */
/*                                                                    */
ALLOC DSN('&MVSEUT1..Z.OBJ') NE USING(F80X40) SP(10 10) DIR(50) -
      TRA VOL(&MVSEUTC) UNIT(3350)
/*                                                                    */
/*            ALLOCATE Z.LOAD                                         */
/*                                                                    */
ALLOC DSN('&MVSEUT1..Z.LOAD') NE USING(U19069X0) SP(10 10) DIR(50) -
      TRA VOL(&MVSEUTC) UNIT(3350)
/*                                                                    */
/*            ALLOCATE Z.CNTL                                         */
/*                                                                    */
ALLOC DSN('&MVSEUT1..Z.CNTL') NE US(F80X77) SP(10 10) DIR(50) -
      TRA VOL(&MVSEUTC) UNIT(3350)
/*                                                                    */
/*            ALLOC DUMMY SOURCE LIBRARY FOR PLS                      */
/*                                                                    */
EDIT 'A@96390.Z.CNTL(PLSLIB)' CN
V ON
C 10 99999 /Ö/&MVSEUT1/
C 10 99999 /!/&MVSEUTC/
SUBMIT
END
/*                                                                    */
/*            UPDATE DATA SETS                                        */
/*                                                                    */
FREE DD(SYSUT1 SYSUT2)
ALLOC F(SYSUT1) DA('ISP.R1M0.ISPPARM(TSMODEL)') SHR
ALLOC F(SYSUT2) DA('ISP.R1M0.ISPPARM(&MVSEUT1)') SHR
WRITE SPFBUILD '&MVSEUTD'
XEQ SPFBUILD '&MVSEUTD'
FREE DD(SYSUT1 SYSUT2)
ISPEXEC EDIT DATASET('SYST.SYSIN(SYSACT02)')
ISPEXEC EDIT DATASET('SYST.DSS.PARMLIB')
/*                                                                    */
/*            CLEAN UP                                                */
/*                                                                    */
    FREE ATTR(F80X77)
    FREE ATTR(F80X40)
    FREE ATTR(U19069X0)
    PROF PRE(&MVSEUT1)
    LISTC
    PROF PRE(&SYSUID)
    ISPEXEC CONTROL DISPLAY REFRESH
    GOTO LOOP
FAIL: WRITE ACCOUNT COMMAND FAILED
      GOTO LOOP
END:  ISPEXEC VPUT (MVSEUT1 MVSEUT2 MVSEUT3 MVSEUT4 MVSEUT5 +
                    MVSEUT6 MVSEUT7 MVSEUT8 MVSEUT9 MVSEUTA +
                    MVSEUTB MVSEUTC MVSEUTD MVSEUTE) PROFILE
./ ADD  NAME=OPRES00
PROC 0
Q SLOG SYSLOG
ISPEXEC CONTROL DISPLAY REFRESH
./ ADD  NAME=OPRETI0
PROC 0 R(5) D(NODSN)
XEQ TSOTIQ '&R.,&D'
ISPEXEC CONTROL DISPLAY REFRESH
./ ADD  NAME=PDAEC00
PROC 0
       ISPEXEC VGET (ZUSER Z) SHARED
LOOP:  ISPEXEC DISPLAY PANEL(PDAEC00)
       IF &LASTCC NE 0 THEN EXIT
       IF &PDAECSTA EQ &Z THEN GOTO CAN
       STATUS
       SET &PDAECSTA EQ &Z
       GOTO DONE
CAN:   IF &PDAECJBN EQ &Z THEN GOTO CAN2
       CANCEL &ZUSER.&PDAECJBC(&PDAECJBN) &PDAECPUR
       GOTO DONE
CAN2:  CANCEL &ZUSER.&PDAECJBC &PDAECPUR
DONE:  SET &PDAECJBC EQ &Z
       SET &PDAECJBN EQ &Z
       SET &PDAECPUR EQ &Z
       SET &PDAECSTA EQ &Z
       GOTO LOOP
./ ADD  NAME=PDAEI00
PROC 0
ALLOC DSN('TESTCAT.OZ.SOFTWARE') SHR DD(VSAM)
XEQ OZD 'D=U'
FREE DD(VSAM)
ISPEXEC CONTROL DISPLAY REFRESH
./ ADD  NAME=PDAETI0
PROC 0 R(2) D(DSN)
XEQ TSOTIQ '&R.,&D'
ISPEXEC CONTROL DISPLAY REFRESH
./ ADD  NAME=PDAEW00
PROC 0
/*     CONTROL MSG SYM CON LIST   */
       ISPEXEC VGET (Z) SHARED
LOOP:  ISPEXEC DISPLAY PANEL(PDAEW00)
       IF &LASTCC NE 0 THEN EXIT
       IF &PDAEWUSR EQ &Z THEN GOTO OPER
       SEND '&PDAEWMSG',U(&PDAEWUSR),LOGON
       GOTO LOOP
OPER:  IF &PDAEWCON EQ &Z THEN GOTO NOCON
       SEND '&PDAEWMSG',CN(&PDAEWCON)
       GOTO LOOP
NOCON: SEND '&PDAEWMSG'
       GOTO LOOP
       SET &PDAECSTA EQ &Z
./ ADD  NAME=PRELOAD
GSAMRRR,DFSMRCL0,                                                CLEAN
IGG019AA,IGG019AQ,                                                OPEN
IGG019BA,IGG019BB,IGG019BH,IGG019BI,                              OPEN
IGX00017,ICEMAN,SORT,ICEDEF,ICEDEC,ICEDEG,ICEDEV,                 SORT
ICECRE,ICECRO,ICEVRE,ICEVRO,ICECKP,ICEPAR,ICERED,                 SORT
ICEVED,ICELIM,ICELIV,ICEVIP,ICEVIM,ICEERR,                        SORT
PCFTBLS,                                                          PCF
FMTCLIST,                                                         IPCS
IKJGETL,IKJCB831,                                                 TSO
ALLOC,ALLOCATE,                                                   TSO
DEL,DELETE,                                                       TSO
IDCAM01,IDCAM02,                                                  TSO
LISTC,LISTCAT,                                                    TSO
OUT,OUTPUT,                                                       TSO
ST,STATUS,IKJEFFCA,                                               TSO
SUB,SUBMIT,IKJEFF10,                                              TSO
JOBPARMS,SYS#0045,ABDATES                                         USER
./ ADD  NAME=SQDEUL0
PROC 0
/*     CONTROL MSG CONLIST SYM LIST */
       ISPEXEC VGET (CMNEULLV CMNEULDS CMNEULVO Z ZPREFIX) SHARED
       IF &CMNEULLV EQ &Z AND &CMNEULDS EQ &Z AND &CMNEULVO EQ &Z THEN +
         SET &CMNEULLV = &ZPREFIX
LOOP1: ISPEXEC DISPLAY PANEL(CMNEUL0)
       IF &LASTCC NE 0 THEN GOTO END
       IF &CMNEULEX NE &Z THEN SET &EX = EX
                          ELSE SET &EX = &Z
       IF &CMNEULLV NE &Z THEN DO
                               SET &POSP = &STR(LEVEL(&CMNEULLV))
                               GOTO LISTS
                               END
       IF &CMNEULDS NE &Z THEN DO
                               SET &POSP = &STR(DATASET(&CMNEULDS))
                               GOTO LISTS
                               END
       IF &CMNEULVO NE &Z THEN SET &POSP = &STR(VOLUME(&CMNEULVO))
LISTS: LISTSPC &POSP &EX &CMNEULTP
       GOTO LOOP1
END:   ISPEXEC CONTROL DISPLAY REFRESH
./ ADD  NAME=SQDEW00
PROC 0
/*     CONTROL MSG SYM CON LIST   */
       ISPEXEC VGET (Z) SHARED
LOOP:  ISPEXEC DISPLAY PANEL(CMNEW00)
       IF &LASTCC NE 0 THEN EXIT
       IF &STR(&CMNEWUSR) EQ &Z THEN GOTO OPER
       SEND '&CMNEWMS1',U(&CMNEWUSR),LOGON
       IF &CMNEWMS2 EQ &Z THEN GOTO LOOP
       SEND '&CMNEWMS2',U(&CMNEWUSR),LOGON
       IF &CMNEWMS3 EQ &Z THEN GOTO LOOP
       SEND '&CMNEWMS3',U(&CMNEWUSR),LOGON
       IF &CMNEWMS4 EQ &Z THEN GOTO LOOP
       SEND '&CMNEWMS4',U(&CMNEWUSR),LOGON
       IF &CMNEWMS5 EQ &Z THEN GOTO LOOP
       SEND '&CMNEWMS5',U(&CMNEWUSR),LOGON
       IF &CMNEWMS6 EQ &Z THEN GOTO LOOP
       SEND '&CMNEWMS6',U(&CMNEWUSR),LOGON
       IF &CMNEWMS7 EQ &Z THEN GOTO LOOP
       SEND '&CMNEWMS7',U(&CMNEWUSR),LOGON
       IF &CMNEWMS8 EQ &Z THEN GOTO LOOP
       SEND '&CMNEWMS8',U(&CMNEWUSR),LOGON
       GOTO LOOP
OPER:  IF &CMNEWCON EQ &Z THEN GOTO NOCON
       SEND '&CMNEWMS1',CN(&CMNEWCON)
       IF &CMNEWMS2 EQ &Z THEN GOTO LOOP
       SEND '&CMNEWMS2',CN(&CMNEWCON)
       IF &CMNEWMS3 EQ &Z THEN GOTO LOOP
       SEND '&CMNEWMS3',CN(&CMNEWCON)
       IF &CMNEWMS4 EQ &Z THEN GOTO LOOP
       SEND '&CMNEWMS4',CN(&CMNEWCON)
       IF &CMNEWMS5 EQ &Z THEN GOTO LOOP
       SEND '&CMNEWMS5',CN(&CMNEWCON)
       IF &CMNEWMS6 EQ &Z THEN GOTO LOOP
       SEND '&CMNEWMS6',CN(&CMNEWCON)
       IF &CMNEWMS7 EQ &Z THEN GOTO LOOP
       SEND '&CMNEWMS7',CN(&CMNEWCON)
       IF &CMNEWMS8 EQ &Z THEN GOTO LOOP
       SEND '&CMNEWMS8',CN(&CMNEWCON)
       GOTO LOOP
NOCON: SEND '&CMNEWMS1'
       IF &CMNEWMS2 EQ &Z THEN GOTO LOOP
       SEND '&CMNEWMS2'
       IF &CMNEWMS3 EQ &Z THEN GOTO LOOP
       SEND '&CMNEWMS3'
       IF &CMNEWMS4 EQ &Z THEN GOTO LOOP
       SEND '&CMNEWMS4'
       IF &CMNEWMS5 EQ &Z THEN GOTO LOOP
       SEND '&CMNEWMS5'
       IF &CMNEWMS6 EQ &Z THEN GOTO LOOP
       SEND '&CMNEWMS6'
       IF &CMNEWMS7 EQ &Z THEN GOTO LOOP
       SEND '&CMNEWMS7'
       IF &CMNEWMS8 EQ &Z THEN GOTO LOOP
       SEND '&CMNEWMS8'
       GOTO LOOP
       SET &CMNECSTA EQ &Z
./ ADD  NAME=TPSEG12
PROC 1  A VOL()
CONTROL NOMSG NOPROMPT MAIN
FREE    DD(SYSPRINT SYSIN SPFCOMP)
CONTROL MSG
IF &SUBSTR(1:7,&A) EQ &SYSUID THEN +
   ALLOC DD(SPFCOMP) DSN('&A') SHR RELEASE
ELSE +
   DO
   IF &LENGTH(&VOL) EQ 0 THEN +
      ALLOC DD(SPFCOMP) DSN('&A') SHR
   ELSE +
      ALLOC DD(SPFCOMP) DSN('&A') VOLUME(&VOL) SHR
   END
IF &LASTCC EQ 0 THEN +
   DO
   ALLOC DD(SYSPRINT) DSN(*)
   ALLOC DD(SYSIN) DSN('ISP.MSTR.ISPSLIB(CMNBA10)') SHR
   XEQ   IEBCOPY
   END
CONTROL NOMSG
FREE  DD(SYSIN SYSPRINT SPFCOMP)
ALLOC DD(SYSIN) DSN(*)
ALLOC DD(SYSPRINT) DSN(*)
./ ADD  NAME=TPSEM00
PROC 0
LOOP: ISPEXEC DISPLAY PANEL(TPSEM00)
      IF &LASTCC NE 0 THEN EXIT
      FREE DD(PARMSWTR SYSLIB)
      ALLOC DD(SYSLIB) DSN(&TPSZLIB)SHR
      DEL (ZAPVIN.LIST ZAPRIN.LIST) PURGE
      ATTRIB ZAPATR1 BLKSIZE(80) LRECL(80) RECFM(F) DSORG(PS)
      ALLOC DD(PARMSWTR) DSN(ZAPVIN.LIST) SP(100) BL(80) -
         USING(ZAPATR1) NEW CATALOG
      XEQ PARMSWTR '+ NAME &TPSMEM &TPSCSCT '
      FREE DD(PARMSWTR)
      ALLOC DD(PARMSWTR) DSN(ZAPRIN.LIST) SP(100) BL(80) -
         USING(ZAPATR1) NEW CATALOG
      FREE ATTR(ZAPATR1)
      FREE DD(PARMSWTR)
BLDL: ISPEXEC DISPLAY PANEL(TPSEM10)
      IF &LASTCC NE 0 THEN GOTO LOOP
      ALLOC DD(PARMSWTR) DSN(ZAPVIN.LIST) MOD
      IF &LENGTH(&STR(&V0)) GT 0 THEN +
         DO
         XEQ PARMSWTR '+ &V0 '
         END
      IF &LENGTH(&STR(&V1)) GT 0 THEN +
         DO
         XEQ PARMSWTR '+ &V1 '
         END
      IF &LENGTH(&STR(&V2)) GT 0 THEN +
         DO
         XEQ PARMSWTR '+ &V2 '
         END
      IF &LENGTH(&STR(&V3)) GT 0 THEN +
         DO
         XEQ PARMSWTR '+ &V3 '
         END
      IF &LENGTH(&STR(&V4)) GT 0 THEN +
         DO
         XEQ PARMSWTR '+ &V4 '
         END
      IF &LENGTH(&STR(&V5)) GT 0 THEN +
         DO
         XEQ PARMSWTR '+ &V5 '
         END
      IF &LENGTH(&STR(&V6)) GT 0 THEN +
         DO
         XEQ PARMSWTR '+ &V6 '
         END
      IF &LENGTH(&STR(&V7)) GT 0 THEN +
         DO
         XEQ PARMSWTR '+ &V7 '
         END
      FREE DD(PARMSWTR)
      ALLOC DD(PARMSWTR) DSN(ZAPRIN.LIST) MOD
      IF &LENGTH(&STR(&R0)) GT 0 THEN +
         DO
         XEQ PARMSWTR '+ &R0 '
         END
      IF &LENGTH(&STR(&R1)) GT 0 THEN +
         DO
         XEQ PARMSWTR '+ &R1 '
         END
      IF &LENGTH(&STR(&R2)) GT 0 THEN +
         DO
         XEQ PARMSWTR '+ &R2 '
         END
      IF &LENGTH(&STR(&R3)) GT 0 THEN +
         DO
         XEQ PARMSWTR '+ &R3 '
         END
      IF &LENGTH(&STR(&R4)) GT 0 THEN +
         DO
         XEQ PARMSWTR '+ &R4 '
         END
      IF &LENGTH(&STR(&R5)) GT 0 THEN +
         DO
         XEQ PARMSWTR '+ &R5 '
         END
      IF &LENGTH(&STR(&R6)) GT 0 THEN +
         DO
         XEQ PARMSWTR '+ &R6 '
         END
      IF &LENGTH(&STR(&R7)) GT 0 THEN +
         DO
         XEQ PARMSWTR '+ &R7 '
         END
      FREE DD(PARMSWTR)
      IF &LENGTH(&STR(&R7&V7)) GT 0 THEN GOTO BLDL
      FREE DD(SYSIN)
      ALLOC DD(SYSIN) DSN(ZAPVIN.LIST ZAPRIN.LIST)
      XEQ IMASPZAP
      FREE DD(SYSIN SYSLIB)
      ALLOC DD(SYSIN) DSN(*)
      ISPEXEC CONTROL DISPLAY LINE START(1)
      WRITENR DO YOU WISH TO SAVE ZAP INPUT FOR LATER USE? :
      READ
      IF &SYSDVAL EQ N OR &SYSDVAL EQ NO THEN +
         DO
         DEL (ZAPVIN.LIST ZAPRIN.LIST) PURGE
         WRITE VERIFY AND REPLACE DATASETS DELETED.
         END
      ELSE +
         DO
       WRITE VER AND REP DATASETS SAVED (ZAPVIN.LIST AND ZAPRIN.LIST)
         END
      ISPEXEC CONTROL DISPLAY REFRESH
      GOTO LOOP
./ ADD  NAME=XIMSEMM4
PROC 3 MACROLIB FMTLIB LID DEBUG
CONTROL NOMSG NOCON NOSYM NOPROMPT NOFLUSH
DELETE SEQBLKS
DELETE TEMPPDS
DELETE TEXTPASS
DELETE TEMPPRNT
IF &DEBUG NE DEBUG THEN CONTROL NOMSG NOCON NOSYM NOPROMPT
                   ELSE CONTROL MSG CON SYM NOPROMPT NOFLUSH LIST
FREE  DD(SYSIN REFIN REFOUT REFRD SYSTEXT SEQBLKS SYSPRINT)
FREE ATTRLIST(B4000 FB133)
CONTROL MSG
ALLOC DD(SYSIN) DSN('&MACROLIB') SHR
ALLOC DD(REFIN) DSN(TEMPREF) NEW SPACE(1 1) TR  DIR(01) DELETE
ALLOC DD(REFOUT) DSN(TEMPPDS) NEW SPACE(1 1) TR  DIR(01) DELETE
ALLOC DD(REFRD) DSN(TEMPPDS) SHR DELETE
ALLOC DD(SEQBLKS) DSN(SEQBLKS) NEW SPACE(9 1) TR CATALOG
ATTR B4000 BLKSIZE(4000)
ALLOC DD(SYSTEXT) DSN(TEXTPASS) NEW SPACE(9 1) TR CATALOG USING(B4000)
ATTR FB133 LRECL(133) BLKSIZE(6118) RECFM(F B)
ALLOC DD(SYSPRINT) DSN(TEMPPRNT) NEW CATALOG SP(2 1) TR USING(FB133)
FREE ATTRLIST(B4000 FB133)
PROF WTPMSG
XEQ DFSUPAA0 -
     'NOXREF,NOCOMP,NOSUBS,NODIAG,NOCOMPRESS,LINECNT=55,STOPRC=8'
SET &CC = &LASTCC
CONTROL NOMSG
FREE  DD(SYSIN REFIN REFOUT REFRD SYSTEXT SEQBLKS SYSPRINT)
IF &SUBSTR(1:1,&CC) EQ U OR &SUBSTR(1:1,&CC) EQ S OR &CC GT 8 THEN +
   DO
      WRITE MFS EDIT ENDED WITH A RC = &CC TFORMAT WILL NOT BE UPDATED
   IF &LID NE NULL THEN +
      DO
      SET &DSN = &LID..LIST
      WRITE MFS-EDIT OUTPUT WILL BE WRITTEN TO DSN=&SYSPREF..&DSN
      %CMNEMPR  TEMPPRNT &DSN ALL &DEBUG OUTPUT(NOTERM)
      END
      ELSE +
      DO
      %CMNEMPR  TEMPPRNT &LID ALL &DEBUG OUTPUT(TERM)
      END
   DELETE TEXTPASS
   DELETE TEMPPRNT
   END
   ELSE +
   DO
   WRITE MFS EDIT ENDED WITH A RC = &CC TFORMAT WILL NOW BE UPDATED
   IF &LID NE NULL THEN +
      DO
      SET &DSN = &LID..LIST
      WRITE MFS-EDIT OUTPUT WILL BE WRITTEN TO DSN=&SYSPREF..&DSN
      %CMNEMPR  TEMPPRNT &DSN MFS &DEBUG OUTPUT(NOTERM)
      END
   CONTROL NOMSG
   DELETE TEMPPRNT
   FREE  DD(FORMAT SEQBLKS UTPRINT)
   CONTROL MSG
   ALLOC DD(SEQBLKS) DSN(SEQBLKS) DELETE
   ALLOC DD(UTPRINT) DSN(*)
   ALLOC DD(FORMAT) DSN('&FMTLIB') SHR
   CONTROL NOMSG
   XEQ DFSUNUB0 'TEST'
   SET &CC = &LASTCC
   WRITE MFS UPDT ENDED WITH A RC = &CC
   FREE  DD(FORMAT SEQBLKS UTPRINT)
   DELETE TEXTPASS
   END
DONE: +
CLEAR
./ ADD  NAME=XX
ALLOC DSN('I@99321.Z.ASM') NE CAT SP(1 1) TRA
ALLOC DSN('I@99321.Z.OBJ') NE CAT SP(1 1) TRA
ALLOC DSN('I@99321.Z.DATA') NE CAT SP(1 1) TRA
ALLOC DSN('I@99321.Z.CNTL') NE CAT SP(1 1) TRA
ALLOC DSN('I@99321.Z.LOAD') NE CAT SP(1 1) TRA

Year 2000 mods for PDS command.


Author:
----------------------------------------------------------------------
John Kalinich
USA Logistics Systems
 Support Center
AMSEL-SE-BSD-LS-TD, Room 7.103
1222 Spruce Street
St. Louis, MO.  63103-2834

314-331-4521
314-331-4455 (FAX)
mailto:kalinichj@primary.net


Update Log:
----------------------------------------------------------------------
Note:  All mods are marked with a "Y2K mmmyy" tag in right margin.

1.  Updated ATTRIB, HIST, and MEMLIST to handle SPF year 2000 dates.
Changed the check of 00yyddd to 0cyyddd for valid SPF dates.
OR'ed the first character of YY/MM/DD dates with x'F0' in ATTRIB
and HIST for source members.

2.  Updated @DIAFIND/MEML/WRK to properly sort Y2K dates in MEMLIST.
The x'01'/x'00' century date byte is carried in the table as a
character value (x'F1'/x'F0') for sorting purposes, but it is
never displayed (like ISPF Edit/Browse).  Added ISPF variables
MEML(CCEN/MCEN/LCEN) and MEM2(CCEN/MCEN/LCEN).

3.  Updated #PDSGEN and @GLOBAL to define/use the &WIN19XX variable.
This variable is used for the start of the 19xx date window when
processing LKEDDATEs.

4.  Updated VRTDATE section of @PARSE to nullify date relationship
checking.  For example, CHANGED(97001:00100) is now valid because
of year 2000 dates.  Updated @IF coding to compare dates using a 4
byte date field ('ccyymmdd' for load and 'ccyydddf' for source).
The &WIN19XX variable was used to determine century (cc) values:

  x'00' = 19xx
  x'01' = 20xx

5.  Updated @IF to ignore check of 1st date if set by a BEFORE/TO
verb (00000F date for source and 000100 date for load).

6.  Updated @DIAFIND/LSTC/WRK to properly sort Y2K dates in LISTC.
The century date byte is carried in the table as a character value
(x'F1'/x'F0') for sorting purposes, but it is never displayed (like
ISPF Edit/Browse).  Added ISPF variables SPFC(CCEN/RCEN).

7.  Used the following JCL to change the version number of PDS
to the 8.5 level.  A group of members identified below had to be
changed manually with ISPF Edit.

//TRIDJKPD JOB (DOCTOR-K),'KALINICH, JOHN',
//             CLASS=B,
//             NOTIFY=TRIDJK,
//             MSGCLASS=R
/*JOBPARM R=7K03,T=9999,L=9999
/*ROUTE XEQ   APROD
/*ROUTE PRINT APROD
//JCL      JCLLIB  ORDER=AD.PROCLIB
//JOB      OUTPUT  NAME='KALINICH, JOHN',
//             TITLE='PDS VERSION 8.5',
//             DEPT='DATA TECHNOLOGIES',
//             BUILDING='ROBERT A. YOUNG',
//             ADDRESS=('LSSC',
//             'AMSEL-SE-BSD-LS-TD, ROOM 7.103',
//             '1222 SPRUCE STREET',
//             'ST. LOUIS, MISSOURI  63103-2834'),
//             JESDS=ALL,
//             DEFAULT=YES
//TSO      EXEC  PGM=IKJEFT01,REGION=3M,DYNAMNBR=50
//*
//*  MANUALLY MODIFY THESE MEMBERS WITH ISPF EDIT:
//*
//*  @PDSMAIN, #PDSMODS, P84PN@P, P84PN@PH, P84PN@PN,
//*  SMPINST, PDSHELP, $$$CUSTM, $$$DOC, $$$Y2K,
//*  PDSTRAPT, PDSJCL, PDSJCLHL
//*
//STEPLIB  DD  DSN=AD.CMDLIB,DISP=SHR
//SYSTSPRT DD  SYSOUT=*
//SYSTSIN  DD  *
PDS    'AD.FILE182.PDS414'
REPLACE PDSHELP   '-PDS84-' '-PDS85-'   WRITE
REPLACE M$ENTER   'V8.4' 'V8.5'   WRITE
REPLACE @PDSMAIN  'VERSION 8.4' 'VERSION 8.5'   WRITE
REPLACE #PDSGEN:  'P84' 'P85'   WRITE
REPLACE #PDSGEN:  'M84' 'M85'   WRITE
REPLACE #PDSGEN   'PDS82' 'PDS85'   WRITE
REPLACE P84LOHE1  'PDS82' 'PDS85'   WRITE
REPLACE P84OPHE1  'PDS82' 'PDS85'   WRITE
REPLACE @GLOBAL   'P83' 'P85'   WRITE
REPLACE @GLOBAL   'M83' 'M85'   WRITE
REPLACE EQUAL/    'P84' 'P85'   WRITE
REPLACE PDSHJCL   'PDS84' 'PDS85'   WRITE
REPLACE $$$C:$$$U 'PDS84' 'PDS85'   WRITE
REPLACE $$$C:     'P84' 'P85'   WRITE
REPLACE $$$D:     'P84' 'P85'   WRITE
REPLACE $$$E:     'P84' 'P85'   WRITE
REPLACE $$$I:     'P84' 'P85'   WRITE
REPLACE $$$I:     '8.4' '8.5'   WRITE
REPLACE $$$M:     'P84' 'P85'   WRITE
REPLACE $$$T:     'P84' 'P85'   WRITE
REPLACE $$$U:     'P84' 'P85'   WRITE
REPLACE P84:      'P84' 'P85'   WRITE
REPLACE P84:      'M84' 'M85'   WRITE
REPLACE PDSM84    'P83' 'P85'   WRITE
REPLACE PDSM84    'M84' 'M85'   WRITE
REPLACE PDSPJCL   'P84' 'P85'   WRITE
REPLACE PDSPJCL   'P83' 'P84'   WRITE
REPLACE PDSPJCL   'M84' 'M85'   WRITE
REPLACE PDSPJCL   'M83' 'M84'   WRITE
REPLACE PDSPJCL   '8.4' '8.5'   WRITE
REPLACE PDSPJCL   '8.3' '8.4'   WRITE
RENAME  P84 P85 GROUP
RENAME  PDSM84 PDSM85
/*


LSSC Test System:
----------------------------------------------------------------------
TASID Snapshot - TASID Version 5.05b                     (9710061639)

Current time  08:42 on 97/09/03         +-------------------------+
Last IPL time 20:41 on 97/08/19         × TSO Users            25 ×
                                        × Started Tasks        93 ×
OS/390   R.2      JES Version  JES2     × Jobs                  2 ×
SMF ID   A1VS     JES ........ 1.1.0    × System Addrs         19 ×
User ID  TRIDJK   ACF2 ....... 6.1      × Free Initiators      49 ×
Nodename APROD    TSO ........ 2.05.0   ×-------------------------×
Vtamaddr TCP00001 VTAM ....... 4.3.     × Total               188 ×
Procname $LOGDED  DFP ........ 1.3.0    +-------------------------+
Region   3M                               CPU utilization    54%
ACF2 Grp ISSO     DSF ........ 1.16.0     CPU 5890          2 CPUs
Mode     PR/SM    ISPF ....... 4.3.0      Real Storage       215,040K
MVS acct DOCTOR-K                         ENQ Contention     None

MVS Information: OS/390 R.2
JES Information: OS 1.1.0


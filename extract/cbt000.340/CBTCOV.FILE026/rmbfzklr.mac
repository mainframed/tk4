)ATTR
   /* Dummy PDF menu has ALL TEXT/OUTPUT fields defined as INPUT */
   /* This was done to allow for easy tabbing to select field.   */
   /* TEXT fields converted to allow for use of testing .CURSOR  */
   /* Note that TEXT fields could have been output for  .CURSOR  */
   /* Because OUTPUT fields converted to INPUT, default color    */
   /* and COLOR? NO were "faked" by assigning RED,WHITE,BLUE.    */
 _ TYPE(INPUT)  INTENS(HIGH)   CAPS(ON)    JUST(LEFT)
 \ TYPE(INPUT)  INTENS(HIGH)   CAPS(OFF)
 + TYPE(TEXT)   INTENS(LOW)
 | TYPE(INPUT)  INTENS(HIGH)   CAPS(OFF)
 ~ TYPE(INPUT)  INTENS(LOW)
 ` TYPE(INPUT)  INTENS(LOW)    CAPS(OFF)
 { TYPE(INPUT)  INTENS(LOW)    CAPS(OFF)   JUST(LEFT)
 } TYPE(INPUT)  INTENS(LOW)    CAPS(ON)    JUST(LEFT)
 @ TYPE(INPUT)  INTENS(LOW)                JUST(ASIS)
 Ö TYPE(INPUT)  INTENS(HIGH)   CAPS(ON)    JUST(RIGHT)
 ! TYPE(TEXT)   INTENS(HIGH)
 " TYPE(TEXT)   INTENS(LOW)
 ? TYPE(INPUT)  INTENS(HIGH)
 < TYPE(INPUT)  INTENS(LOW)    CAPS(OFF)   JUST(ASIS)
 × TYPE(INPUT)  INTENS(HIGH)   CAPS(OFF)   JUST(ASIS)
)BODY
!------------------ Set Menu Customized Color Palettes -----------------
!COMMAND ===>_ZCMD
!
!  P  "0  !===>?ZKOLOR0    "    8  !===>?ZKOLOR8    "    16  !===>?ZKOLO
!  a  "1  !===>?ZKOLOR1    "    9  !===>?ZKOLOR9    "    17  !===>?ZKOLO
!  l  "2  !===>?ZKOLOR2    "   10  !===>?ZKOLOR10   "    18  !===>?ZKOLO
!  e  "3  !===>?ZKOLOR3    "   11  !===>?ZKOLOR11   "    19  !===>?ZKOLO
!  t  "4  !===>?ZKOLOR4    "   12  !===>?ZKOLOR12   "    20  !===>?ZKOLO
!  t  "5  !===>?ZKOLOR5    "   13  !===>?ZKOLOR13   "    21  !===>?ZKOLO
!  e  "6  !===>?ZKOLOR6    "   14  !===>?ZKOLOR14   "    22  !===>?ZKOLO
!  #  "7  !===>?ZKOLOR7    "   15  !===>?ZKOLOR15   "    23  !===>?ZKOLO
!
"Current Palette #!===>?Z "     (0-23) " Rotate thru Palettes!===>?Z  "(
"Save New Palettes!===>?ZKLRUPD"(Y,N)    Restore SYS Palettes!===>?Z  "(
!Colors:"W=White G=Green R=Red B=Blue Y=Yellow P=Pink T=Turq *=default
!
!MOVE CURSOR TO PANEL FIELD AND PRESS ENTER TO FIND COLOR POSITION IN PA
!
|ZKLRSY×ZKLRDD1      \ZKLRTI                               ×ZKLRDD2    |
×ZKLROPT     _ZKMD
×ZKLR<ZKLRO        `ZKLRD                                    +<ZKLRMSB ~
%ÖZ +}ZKLRSD1    }Z{ZKLRLD1                                  +<ZKLRSYSC_
<ZK1  ×ZK2<ZK3                              ×ZKLRISCN        +<ZKLRMSB1
+
)INIT
  &ZPRIM = YES
  .ZVARS = '(Z$PRMHUE,Z$PRMROT,ZKLRUNDO,ZKLRO1,ZKLRD1)'
  IF (&Z$PRMROT = &Z) &Z$PRMROT = NO
  IF (&Z$PRMHUE = &Z) &Z$PRMHUE = 1
  IF (&Z$PRMCLR = DEFINE) &Z$PRMCLR = YES
  &ZKLRUNDO = NO
  &ZKLRMSB1='MBFMSB - &ZJDATE' &ZKMD='opt.opt'  &ZKLRPRE = &ZPREFIX
  &ZKLRSYSC = &Z$SYSC  &ZKLRSY  = &Z$SYS  &ZKLRMNG = &RMBFMNG
  &ZKLRISCN='ISC Message'
  &ZKLRO1=M &ZKLRSD1=MBF  &ZKLRD1='-' &ZKLRLD1='Options added by Menu BU
  IF (&RMBF@VER = SYS )         &ZKLRTI=' ISPF/PDF V2.2.0 PRIMARY OPTION
  IF (&RMBF@VER = AOST)
    IF (&RMBF@PNL = 'ISR@PRIM') &ZKLRTI='    ISPF/PDF PRIMARY OPTION MEN
    IF (&RMBF@PNL = 'AOSTMSTR') &ZKLRTI='    AOST Master Application Men
  &ZKLRMSB='PREFIX -' &ZKLRDD1='-------------'  &ZKLRDD2 ='------------'
  &ZKLROPT='OPTION  ===>'   &ZKLR    ='  S'   &ZKLRO='STANDARD    -'
  &ZKLRD  ='Standard PDF Menu options'
  &ZK1='Enter'  &ZK2='END' &ZK3='command to terminate PDF'

  IF (&ZKOLORS   = &Z) /* Set default color palettes */
    &ZKOLOR0  = WYGTBGBGTT* &ZKOLOR1  = RYTRTBTBWW* &ZKOLOR2  = BYYTTBTB
    &ZKOLOR3  = BRWBWTWTWW* &ZKOLOR4  = PGRPRYRYWW* &ZKOLOR5  = TBGTGWGW
    &ZKOLOR6  = YPBYBRBRWW* &ZKOLOR7  = WTPWPGPGWW* &ZKOLOR8  = GWYGYPYP
    &ZKOLOR9  = WPTGTYTYWW* &ZKOLOR10 = WPTTRGRGTTY &ZKOLOR11 = BYYTTBTB
    &ZKOLOR12 = TYGBBGBGTTW &ZKOLOR13 = GWYGGPGPWWY &ZKOLOR14 = WRTGGYGY
    &ZKOLOR15 = GGGGGGGGGGY &ZKOLOR16 = RRRRRRRRRRP &ZKOLOR17 = BBBBBBBB
    &ZKOLOR18 = WWWWWWWWWWR &ZKOLOR19 = PPPPPPPPPPR &ZKOLOR20 = TTTTTTTT
    &ZKOLOR21 = YYYYYYYYYYG &ZKOLOR22 = RWBWWBWBRRW &ZKOLOR23 = ********
    IF (&RMBF@VER = SYS ) IF (&RMBF@PNL = ISR@PRIM) &ZKOLOR1  = RYTRTBTB
    IF (&RMBF@VER = AOST) IF (&RMBF@PNL = ISR@PRIM) &ZKOLOR1  = RYTYTGTG
    IF (&RMBF@VER = AOST) IF (&RMBF@PNL = AOSTMSTR) &ZKOLOR1  = RTGYGBGB

  /* See if color menu desired. If color get color palette number */
  &ZKLRSYSC = 'COLOR? -'  &Z$SYSC= &ZKLRSYSC
  IF (&Z$PRMCLR ^= YES,NO)  &Z$PRMCLR = YES
    /* Do even if NO Color */
  IF (&Z$PRMROT = YES) &Z$PRMHUE=TRANS(&Z$PRMHUE 0,1 1,2 2,3 3,4 4,5 5,6
     6,7 7,8 8,9 9,10 10,11 11,12 12,13 13,14 14,15 15,16 16,17 17,18 18
     19,20 20,21 21,22 22,23 23,0 *,1)
    IF (&Z$PRMHUE ^= 1) &ZKLRSYSC = 'COLOR&Z$PRMHUE?-' &Z$SYSC = &ZKLRSY
  &ZPALETTE = TRANS(&Z$PRMHUE
      0,&ZKOLOR0   1,&ZKOLOR1   2,&ZKOLOR2   3,&ZKOLOR3   4,&ZKOLOR4
      5,&ZKOLOR5   6,&ZKOLOR6   7,&ZKOLOR7   8,&ZKOLOR8   9,&ZKOLOR9
     10,&ZKOLOR10 11,&ZKOLOR11 12,&ZKOLOR12 13,&ZKOLOR13 14,&ZKOLOR14
     15,&ZKOLOR15 16,&ZKOLOR16 17,&ZKOLOR17 18,&ZKOLOR18 19,&ZKOLOR19
     20,&ZKOLOR20 21,&ZKOLOR21 22,&ZKOLOR22 23,&ZKOLOR23  *,'***********
  IF (&Z$PRMCLR  = NO)   &ZPALETTE='***********' /* Fake NO Color */
  IF (&Z$PRMROT  = YES)  .CURSOR = Z$PRMROT
  .CURSOR   = TRANS(&Z$PRMHUE
      0,ZKOLOR0    1,ZKOLOR1    2,ZKOLOR2    3,ZKOLOR3    4,ZKOLOR4
      5,ZKOLOR5    6,ZKOLOR6    7,ZKOLOR7    8,ZKOLOR8    9,ZKOLOR9
     10,ZKOLOR10  11,ZKOLOR11  12,ZKOLOR12  13,ZKOLOR13  14,ZKOLOR14
     15,ZKOLOR15  16,ZKOLOR16  17,ZKOLOR17  18,ZKOLOR18  19,ZKOLOR19
     20,ZKOLOR20  21,ZKOLOR21  22,ZKOLOR22  23,ZKOLOR23   *,Z$PRMHUE)

  /* Stop the field blinking if last cursor was at top COMMAND */
  /* The blinking is also stopped later if cursor in different palette*/
  IF (&ZKLRCSR = S) &ZKLRPPOS = &Z  &ZKLRCSR = &Z  &ZKLRCUR = &Z

  &ZKLRS10 = TRUNC(&ZPALETTE,10) &ZKLRS11 = .TRAIL
  IF (&ZKLRPPOS ^= '?',&Z)
    IF (&ZKLRPPOS = 11)  IF (&ZKLRS11 = '*',&Z)  &ZKLRPPOS = 1
    .CSRPOS = &ZKLRPPOS

  &ZKR01=TRANS(TRUNC(&ZPALETTE,1) W,WHITE G,GREEN R,RED B,BLUE Y,YELLOW
       P,PINK T,TURQ *,RED)   &ZPALETTE = .TRAIL
  &ZKR02=TRANS(TRUNC(&ZPALETTE,1) W,WHITE G,GREEN R,RED B,BLUE Y,YELLOW
       P,PINK T,TURQ *,WHITE) &ZPALETTE = .TRAIL
  &ZKR03=TRANS(TRUNC(&ZPALETTE,1) W,WHITE G,GREEN R,RED B,BLUE Y,YELLOW
       P,PINK T,TURQ *,WHITE) &ZPALETTE = .TRAIL
  &ZKR04=TRANS(TRUNC(&ZPALETTE,1) W,WHITE G,GREEN R,RED B,BLUE Y,YELLOW
       P,PINK T,TURQ *,BLUE)  &ZPALETTE = .TRAIL
  &ZKR05=TRANS(TRUNC(&ZPALETTE,1) W,WHITE G,GREEN R,RED B,BLUE Y,YELLOW
       P,PINK T,TURQ *,BLUE)  &ZPALETTE = .TRAIL
  &ZKR06=TRANS(TRUNC(&ZPALETTE,1) W,WHITE G,GREEN R,RED B,BLUE Y,YELLOW
       P,PINK T,TURQ *,BLUE)  &ZPALETTE = .TRAIL
  &ZKR07=TRANS(TRUNC(&ZPALETTE,1) W,WHITE G,GREEN R,RED B,BLUE Y,YELLOW
       P,PINK T,TURQ *,BLUE)  &ZPALETTE = .TRAIL
  &ZKR08=TRANS(TRUNC(&ZPALETTE,1) W,WHITE G,GREEN R,RED B,BLUE Y,YELLOW
       P,PINK T,TURQ *,BLUE)  &ZPALETTE = .TRAIL
  &ZKR09=TRANS(TRUNC(&ZPALETTE,1) W,WHITE G,GREEN R,RED B,BLUE Y,YELLOW
       P,PINK T,TURQ *,WHITE) &ZPALETTE = .TRAIL
  &ZKR10=TRANS(TRUNC(&ZPALETTE,1) W,WHITE G,GREEN R,RED B,BLUE Y,YELLOW
       P,PINK T,TURQ *,WHITE) &ZPALETTE = .TRAIL
       .ATTRCHAR(%) = 'COLOR(&ZKR)'
  &ZKR11=TRANS(TRUNC(&ZPALETTE,1) W,WHITE G,GREEN R,RED B,BLUE Y,YELLOW
       P,PINK T,TURQ *,&ZKR01)

  &ZKLRH01='HILITE()' &ZKLRH02='HILITE()' &ZKLRH03='HILITE()'
  &ZKLRH04='HILITE()' &ZKLRH05='HILITE()' &ZKLRH06='HILITE()'
  &ZKLRH07='HILITE()' &ZKLRH08='HILITE()' &ZKLRH09='HILITE()'
  &ZKLRH10='HILITE()' &ZKLRH11='HILITE()'
  IF (&ZKLRCUR ^= &Z) IF (&ZKLRCSR  = Y)
    IF (&ZKLRPPOS =  1) &ZKLRH01 = 'HILITE(BLINK)'
    IF (&ZKLRPPOS =  2) &ZKLRH02 = 'HILITE(BLINK)'
    IF (&ZKLRPPOS =  3) &ZKLRH03 = 'HILITE(BLINK)'
    IF (&ZKLRPPOS =  4) &ZKLRH04 = 'HILITE(BLINK)'
    IF (&ZKLRPPOS =  5) &ZKLRH05 = 'HILITE(BLINK)'
    IF (&ZKLRPPOS =  6) &ZKLRH06 = 'HILITE(BLINK)'
    IF (&ZKLRPPOS =  7) &ZKLRH07 = 'HILITE(BLINK)'
    IF (&ZKLRPPOS =  8) &ZKLRH08 = 'HILITE(BLINK)'
    IF (&ZKLRPPOS =  9) &ZKLRH09 = 'HILITE(BLINK)'
    IF (&ZKLRPPOS = 10) &ZKLRH10 = 'HILITE(BLINK)'
    IF (&ZKLRPPOS = 11) &ZKLRH11 = 'HILITE(BLINK)'

  .ATTRCHAR(_)   = 'COLOR(&ZKR01) &ZKLRH01'
  .ATTRCHAR(|)   = 'COLOR(&ZKR02) &ZKLRH02'
  .ATTRCHAR(\)   = 'COLOR(&ZKR03) &ZKLRH03'
  .ATTRCHAR(~)   = 'COLOR(&ZKR04) &ZKLRH04'
  .ATTRCHAR(+)   = 'COLOR(&ZKR05) &ZKLRH05'
  .ATTRCHAR('<') = 'COLOR(&ZKR05) &ZKLRH05'
  .ATTRCHAR(`)   = 'COLOR(&ZKR06) &ZKLRH06'
  .ATTRCHAR(})   = 'COLOR(&ZKR07) &ZKLRH07'
  .ATTRCHAR({)   = 'COLOR(&ZKR08) &ZKLRH08'
  .ATTRCHAR(Ö)   = 'COLOR(&ZKR09) &ZKLRH09'
  .ATTRCHAR(%)   = 'COLOR(&ZKR10) &ZKLRH10'
  .ATTRCHAR(×)   = 'COLOR(&ZKR10) &ZKLRH10'
  .ATTR(ZKMD)    = 'COLOR(&ZKR11) &ZKLRH11'

)REINIT
  REFRESH(*)
)PROC

  &ZSAVCUR = &ZKLRCUR  &ZSAVCSR = &ZKLRCSR &ZKLRCUR = .CURSOR
  /* Cursor P:Palette 1-23, Y:Color Menu, N:Other field, S:Stop Blinking
  &ZKLRCSR = TRANS(TRUNC(&ZKLRCUR,6) ZKOLOR,P Z$PRMH,N Z$PRMR,N ZCMD,S *
  IF (&ZKLRCSR  = P)
    IF (&ZKLRPPOS ^= &Z,'?') .CSRPOS = &ZKLRPPOS
    IF (&ZSAVCSR = P) IF (&ZKLRCUR ^= &ZSAVCUR) &ZKLRCSR = S /*Stop Blin
  IF (&ZKLRCSR  = Y)
    &ZKLRPPOS = TRANS(&ZKLRCUR ZKMD,11 Z$PRMCLR,1 ZKLRSD1,7 ZKLRLD1,8
                  ZKLRO1,9  ZKLRD1,7 ZKLRSY,2 ZKLRMNG,2 ZKLRSYSC,5 ZKLRP
                  ZKLRMSB1,5 ZKLRISCN,10 ZKLRDD1,10 ZKLRTI,3 ZKLRDD2,10
                  ZKLROPT,10 ZKLR,10 ZKLRO,5 ZKLRD,6 ZKLRMSB,5 ZK1,5  ZK
                  ZK3,5 *,'?')
    IF (&ZKLRPPOS = '?')  &ZKLRCSR = N  &ZKLRPPOS = &Z

  &Z$PRMCLR = TRUNC(&Z$PRMCLR,'.')
  IF (.TRAIL  = R)    &Z$PRMROT = YES      &Z$PRMHUE = 0
  IF (.TRAIL ^= R,&Z) &Z$PRMHUE = .TRAIL   &Z$PRMROT = NO
  &Z$PRMCLR=TRANS(TRUNC(&Z$PRMCLR,1) Y,YES N,NO  *,*)
  IF (&Z$PRMCLR ^= NO,YES)
    &SHORT='NO or YES'
    &LONG='NO:none, YES×YES.n:multi-color (n=0-23,R)'  .MSG = SYS010
  IF (&Z$PRMCLR  = NO) &Z$PRMROT=NO &ZPALETTE='***********' /* Fake NO C
  &Z$PRMHUE = TRANS(&Z$PRMHUE
              00,0 01,1 02,2 03,3 04,4 05,5 06,6 07,7 08,8 09,9 *,*)
  VER (&Z$PRMHUE,RANGE,0,23)
  &Z$PRMROT = TRANS(TRUNC(&Z$PRMROT,1) Y,YES N,NO *,*)
  VER (&Z$PRMROT,NB,LIST,YES,NO)
  &ZKLRUNDO = TRANS(TRUNC(&ZKLRUNDO,1) Y,YES N,NO *,*)
  VER (&ZKLRUNDO,NB,LIST,YES,NO)
  IF (&ZKLRUNDO ^= YES)  &ZKOLORS = CUSTOM
  IF (&ZKLRUNDO  = YES)  &ZKOLORS = &Z
  IF (&ZKLRUPD   = YES,Y)
    VPUT (ZKOLOR0 ,ZKOLOR1 ,ZKOLOR2 ,ZKOLOR3 ,ZKOLOR4 ,ZKOLOR5 ,ZKOLOR6
          ZKOLOR7 ,ZKOLOR8 ,ZKOLOR9 ,ZKOLOR10,ZKOLOR11,ZKOLOR12,ZKOLOR13
          ZKOLOR14,ZKOLOR15,ZKOLOR16,ZKOLOR17,ZKOLOR18,ZKOLOR19,ZKOLOR20
          ZKOLOR21,ZKOLOR22,ZKOLOR23,
          Z$PRMHUE,Z$PRMCLR,ZKOLORS) PROFILE

  &ZSEL = TRANS (&ZCMD
          ' ',' '
           X ,'EXIT'
           * ,'?')

  IF (&ZVERB = END,RETURN) &ZKLRXIT = YES
  IF (&ZSEL  = EXIT)       &ZKLRXIT = YES
  IF (&ZKLRXIT = YES)
    &ZKLRCUR = &Z  &ZKLRCSR = &Z &ZKLRPPOS = &Z  &ZKLRXIT = &Z
    IF (&ZKLRUPD ^= YES,NO,Y,N)
      &SHORT = 'Save NEW Palettes?'
      &LONG  = 'Do you want to save new color palette definitions? +
                Must enter YES or NO!'
      .MSG   = SYS010     .RESP = ENTER
    IF (&ZKLRUPD  = YES,NO,Y,N)  &ZKLRUPD = &Z
)END

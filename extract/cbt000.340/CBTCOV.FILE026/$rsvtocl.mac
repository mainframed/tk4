)ATTR DEFAULT(×+_)
 \ TYPE(TEXT)   INTENS(HIGH) COLOR(RED)
 ^ TYPE(TEXT)   INTENS(HIGH) COLOR(turq)
 ~ TYPE(OUTPUT) INTENS(LOW) JUST(RIGHT) PAD(' ')
 ` TYPE(OUTPUT) INTENS(LOW) JUST(LEFT)  PAD(' ')
 @ TYPE(OUTPUT) INTENS(HIGH)
 ! TYPE(INPUT)  INTENS(LOW) CAPS(ON)    PAD('_') COLOR(TURQ)
)BODY EXPAND(||)
@Z$SYS ×------------------- Extended VTOC Dialog×-----------------------
×COMMAND ===>_CMD                                             ×SCROLL ==
^S+DataSet List  +M+Map by CCHH  +C+Cluster List  ^V+Vol Summary  ^X+Exc
×-------- V O L U M E -------  - V T O C -  ------------- F R E E ------
×  Serial Adr Unit   Mnt Used  Size Used I  DSCBs Exts Cyls  (Max) Track
)MODEL
!Z`Z     `Z  `Z     `Z  ~Z   +~Z   ~Z   `Z ~Z    ~Z   ~Z   +~Z    ~Z
)INIT
 &AMT = &ZSCML
 .HELP  = TRSVTOC1
 .ZVARS = '(VOLSEL,VOLUME,CUU,UNIT,VMA,VOLUSED, +
            VTOCL,VTOCUSED,VTOCX, +
            DSREC,NXT,NCYL,LCYL,TTRK,MTRK)'
 &ZTDMARK=     '*---------------------------> +
 End of VTOC list <------------------------------*'
)PROC
 VER (&VOLSEL,LIST,S,V,X,M,C,MSG=RSVT015)
 IF (&VOLSEL = 'M','C') .MSG=RSVT016
 &RSVCMD = TRUNC (&CMD,' ')
 &RSVPARM= .TRAIL
 &RSVCMD = TRANS(&RSVCMD
    L,LOCVOL LOC,LOCVOL LOCATE,LOCVOL LV,LOCVOL VOLUME,LOCVOL VOL,LOCVOL
    LA,LOCADR ADR,LOCADR CUU,LOCADR
    *,*)
 VER(&RSVCMD,LIST,SORT,SUMMARY,CANCEL,REPORT,ONLY,SCAN, +
     DEBUG,NODEBUG, +
     SHOW,RESET,LOCVOL,LOCADR,MSG=RSVT020)
 /* IF (&RSVCMD='REPORT') .MSG=RSVT021 */
 IF (&RSVCMD = 'ONLY')
   VER(&RSVPARM,NB,MSG=RSVT029)
 IF (&RSVCMD = 'SORT')
   &RSVPARM = TRANS(&RSVPARM
     SERIAL,VOLUME VOLSER,VOLUME VOL,VOLUME
     TYPE,UNIT
     MNT,VOLATTR VOLMNT,VOLATTR MOUNT,VOLATTR
     VOLUSED,VOLPCT
     VTOCUSED,VTOCPCT
     DSCBS,DSREC FREEDSCB,DSREC FREEDSCBS,DSREC
     EXTS,NXT VOLEXT,NXT EXTENT,NXT EXTENTS,NXT
     FREESPAC,FREE FREESPACE,FREE FREECYLS,FREE NCYL,FREE CYLS,FREE
     MAXCYLS,LARGEST MCYLS,LARGEST LCYL,LARGEST
     VTOCI,VTOCX X,VTOCX I,VTOCX INDEXVTOC,VTOCX INDEXED,VTOCX INDEXEDVT
     VTOCSIZE,VTOCL VTOCLEN,VTOCL
     *,*)
   VER(&RSVPARM,NB,LIST,+
   VOLUME,UNIT,VOLATTR,VOLPCT,VTOCPCT,DSREC,NXT,FREE,LARGEST,VTOCX,+
   VTOCL,MSG=RSVT022)
   IF (&RSVPARM='VOLUME')
     &SORTPARM = 'VOLUME,C,A'
   IF (&RSVPARM='UNIT')
     &SORTPARM = 'UNIT,C,A'
   IF (&RSVPARM='VOLATTR')
     &SORTPARM = 'VOLATTR,C,A'
   IF (&RSVPARM='VOLPCT')
     &SORTPARM = 'VOLPCT,N,D'
   IF (&RSVPARM='VTOCPCT')
     &SORTPARM = 'VTOCPCT,N,D'
   IF (&RSVPARM='DSREC')
     &SORTPARM = 'DSREC,N,A'
   IF (&RSVPARM='NXT')
     &SORTPARM = 'NXT,N,D'
   IF (&RSVPARM='FREE')
     &SORTPARM = 'NCYL,N,D,NTRK,N,D'
   IF (&RSVPARM='LARGEST')
     &SORTPARM = 'LCYL,N,D,LTRK,N,D'
   IF (&RSVPARM='VTOCX')
     &SORTPARM = 'VTOCX,C,D'
   IF (&RSVPARM='VTOCL')
     &SORTPARM = 'VTOCL,N,A'
 &SCANCOND=' '
 IF (&RSVCMD=SCAN)
   &VOLUME = &Z
   &CUU    = &Z
   &VOLPCTN= &Z
   &VOLATTR= &Z
   &NCYLN  = &Z
   &LCYLN  = &Z
   &NXTN   = &Z
   &SCANPARM = &RSVPARM
   IF (&SCANPARM  = &Z) .MSG = RSVT025
   IF (&SCANPARM ^= &Z)
     &SN1=TRUNC(&SCANPARM,' ')
     &SN1=TRANS(&SN1 ADR,CUU MOUNT,VOLATTR MNT,VOLATTR
                     VOLUSED,VOLPCTN VOLPCT,VOLPCTN
                     EXTS,NXTN EXTENTS,NXTN EXT,NXTN
                     VOL,VOLUME SERIAL,VOLUME VOLSER,VOLUME
                     FREE,NCYLN FREECYLS,NCYLN
                     LARGEST,LCYLN MAXCYLS,LCYLN
                     *,*)
     VER(&SN1,NB,LIST, +
     VOLUME,CUU,NXTN,VOLPCTN,NCYLN,LCYLN,VOLATTR,MSG=RSVT026)
     &SCANPARM=.TRAIL
     &ST1=TRUNC(&SCANPARM,' ')
     &ST1=TRANS(&ST1 '=',EQ '^=',NE '<',LT '<=',LE '>',GT '>=',GE *,*)
     VER(&ST1,NB,LIST,EQ,NE,LT,LE,GT,GE,MSG=RSVT027)
     &SCANPARM=.TRAIL
     &SV1=TRUNC(&SCANPARM,' ')
     IF (&SN1=VOLATTR)
       &SV1=TRANS(&SV1 PRIVATE,PRI PRV,PRI STORAGE,STO STG,STO
                       PUBLIC,PUB *,*)
       VER(&SV1,NB,LIST,PRI,STO,PUB,MSG=RSVT006)
     IF (&SN1=VOLPCTN)
       VER(&SV1,NB,RANGE,0,100)
     IF (&SN1=LCYLN)
       VER(&SV1,NB,RANGE,0,99999)
     IF (&SN1=NCYLN)
       VER(&SV1,NB,RANGE,0,9999)
     IF (&SN1=NXTN)
       VER(&SV1,NB,RANGE,0,9999)
     &SCANCOND='&SN1,&ST1'
     IF (&SN1 = VOLUME ) &VOLUME = &SV1
     IF (&SN1 = CUU    ) &CUU    = &SV1
     IF (&SN1 = VOLPCTN) &VOLPCTN= &SV1
     IF (&SN1 = VOLATTR) &VOLATTR= &SV1
     IF (&SN1 = NCYLN  ) &NCYLN  = &SV1
     IF (&SN1 = LCYLN  ) &LCYLN  = &SV1
     IF (&SN1 = NXTN   ) &NXTN   = &SV1
     &SCANPARM=.TRAIL
     IF (&SCANPARM^=&Z)
       &SN2=TRUNC(&SCANPARM,' ')
       &SN2=TRANS(&SN2 ADR,CUU MOUNT,VOLATTR MNT,VOLATTR
                       VOLUSED,VOLPCTN VOLPCT,VOLPCTN
                       EXTS,NXTN EXTENTS,NXTN EXT,NXTN
                       VOL,VOLUME SERIAL,VOLUME VOLSER,VOLUME
                       FREE,NCYLN FREECYLS,NCYLN
                       LARGEST,LCYLN MAXCYLS,LCYLN
                       *,*)
       VER(&SN2,NB,LIST, +
       VOLUME,CUU,VOLPCTN,NXTN,NCYLN,LCYLN,VOLATTR,MSG=RSVT026)
       &SCANPARM=.TRAIL
       &ST2=TRUNC(&SCANPARM,' ')
       &ST2=TRANS(&ST2 '=',EQ '^=',NE '<',LT '<=',LE '>',GT '>=',GE *,*)
       VER(&ST2,NB,LIST,EQ,NE,LT,LE,GT,GE,MSG=RSVT027)
       &SCANPARM=.TRAIL
       &SV2=TRUNC(&SCANPARM,' ')
       IF (&SN2=VOLATTR)
         &SV2=TRANS(&SV2 PRIVATE,PRI PRV,PRI STORAGE,STO STG,STO
                         PUBLIC,PUB *,*)
         VER(&SV2,NB,LIST,PRI,STO,PUB,MSG=RSVT006)
       IF (&SN2=VOLPCTN)
         VER(&SV2,NB,RANGE,0,100)
       IF (&SN2=LCYLN)
         VER(&SV2,NB,RANGE,0,99999)
       IF (&SN2=NCYLN)
         VER(&SV2,NB,RANGE,0,9999)
       IF (&SN2=NXTN)
         VER(&SV2,NB,RANGE,0,9999)
       &SCANCOND='&SCANCOND,&SN2,&ST2'
       IF (&SN2 = VOLUME ) &VOLUME = &SV2
       IF (&SN2 = CUU    ) &CUU    = &SV2
       IF (&SN2 = VOLPCTN) &VOLPCTN= &SV2
       IF (&SN2 = VOLATTR) &VOLATTR= &SV2
       IF (&SN2 = NCYLN  ) &NCYLN  = &SV2
       IF (&SN2 = LCYLN  ) &LCYLN  = &SV2
       IF (&SN2 = NXTN   ) &NXTN   = &SV2
       &SCANPARM=.TRAIL
       IF (&SCANPARM^=&Z)
         &SN3=TRUNC(&SCANPARM,' ')
         &SN3=TRANS(&SN3 ADR,CUU MOUNT,VOLATTR MNT,VOLATTR
                         VOLUSED,VOLPCTN VOLPCT,VOLPCTN
                         EXTS,NXTN EXTENTS,NXTN EXT,NXTN
                         VOL,VOLUME SERIAL,VOLUME VOLSER,VOLUME
                         FREE,NCYLN FREECYLS,NCYLN
                         LARGEST,LCYLN MAXCYLS,LCYLN
                         *,*)
         VER(&SN3,NB,LIST,+
         VOLUME,CUU,VOLPCTN,NCYLN,LCYLN,NXTN,VOLATTR,MSG=RSVT026)
         &SCANPARM=.TRAIL
         &ST3=TRUNC(&SCANPARM,' ')
         &ST3=TRANS(&ST3 '=',EQ '^=',NE '<',LT '<=',LE '>',GT '>=',GE *,
         VER(&ST3,NB,LIST,EQ,NE,LT,LE,GT,GE,MSG=RSVT027)
         &SCANPARM=.TRAIL
         &SV3=TRUNC(&SCANPARM,' ')
         IF (&SN3=VOLATTR)
           &SV3=TRANS(&SV3 PRIVATE,PRI PRV,PRI STORAGE,STO STG,STO
                           PUBLIC,PUB *,*)
         IF (&SN3=VOLPCTN)
           VER(&SV3,NB,RANGE,0,100)
         IF (&SN3=LCYLN)
           VER(&SV3,NB,RANGE,0,99999)
         IF (&SN3=NCYLN)
           VER(&SV3,NB,RANGE,0,9999)
         IF (&SN3=NXTN)
           VER(&SV3,NB,RANGE,0,9999)
         &SCANCOND='&SCANCOND,&SN3,&ST3'
         IF (&SN3 = VOLUME ) &VOLUME = &SV3
         IF (&SN3 = CUU    ) &CUU    = &SV3
         IF (&SN3 = VOLPCTN) &VOLPCTN= &SV3
         IF (&SN3 = VOLATTR) &VOLATTR= &SV3
         IF (&SN3 = NCYLN  ) &NCYLN  = &SV3
         IF (&SN3 = LCYLN  ) &LCYLN  = &SV3
         IF (&SN3 = NXTN   ) &NXTN   = &SV3
         &SCANPARM=.TRAIL
         IF (&SCANPARM^=&Z) .MSG=RSVT025
     VPUT (VOLUME,CUU,VOLPCTN,VOLATTR,NCYLN,LCYLN,NXTN)
     &SCANCOND='&SCANCOND.'
 VPUT (SCANCOND)
 VPUT (RSVCMD,RSVPARM,SORTPARM)
)END

./ ADD NAME=RI001                                  12SEP93 18.26 --
00001000/* Rexx  Rexx  Rexx  Rexx  Rexx  Rexx  Rexx  Rexx  Rexx  Rexx  R
00002000Address 'TSO'
00003000Arg p1
00020000"ISREDIT MACRO NOPROCESS (P1)"
00030000Upper p1
00031000Address 'ISPEXEC'
00032000"VGET (JCL1 JCL2 JCL3 JCL4 JCL4 JCL5 JCL6 JCL7 JCL8) PROFILE"
00032100If rc ^= 0 Then Do
00032200   Call Initialize_jc_variables
00032300   End
00032400Select
00032500   When Length(p1) > 0 THEN DO
00032600      Select
00032700         When abbrev('DISPLAY',p1) | ABBREV('LIST',p1) THEN DO
00032800            JCTITLE = 'Displaying JOB CONTROL statements'
00032900            TYPE = 'TEXT'
00033000           "DISPLAY PANEL(JCEX)"
00034000            exit
00035000            End
00036000         When ABBREV('MODIFY',p1) | ABBREV('CHANGE',p1) THEN DO
00037000            JCTITLE = 'Modifying JOB CONTROL statements'
00038000            TYPE = 'INPUT'
00039000            If jcl1 = '//* ' Then Call Initialize_jc_variables
00040000           "DISPLAY PANEL(JCEX)"
00050000            "VPUT (JCL1 JCL2 JCL3 JCL4 ",
00051000                   "JCL4 JCL5 JCL6 JCL7 JCL8) PROFILE"
00052000            End
00052100         Otherwise
00052200         End
00052300      End
00052400   Otherwise
00052500   End /* End of Select ... */
00052800Address "ISREDIT"
00052901"(MEM) = MEMBER "
00053101Select;
00053201   When length(mem) = 8 Then,
00053301      member = Substr(mem,1,1)Substr(mem,4,2)Substr(mem,8,1)
00053401   When length(mem) = 7 Then,
00053501      member = Substr(mem,1,1)Substr(mem,4,2)Substr(mem,7,1)
00053601   When length(mem) = 6 Then member = Substr(mem,1,2)Substr(mem,
00053701   When length(mem) = 5 Then member = Substr(mem,1,2)Substr(mem,
00053801   When length(mem) = 4 Then member = mem
00053901   When length(mem) = 3 Then member = mem'1'
00054001   When length(mem) = 2 Then member = mem'01'
00054101   Otherwise member = Space(Substr(Userid(),5,3,' '),0)mem
00054201   End /* End of Select ... */
00054301jobname = Substr(userid(),1,4,' ')Substr(member,1,4,'1')
00054401jcl1 = "//"jobname Subword(jcl1,Wordpos('JOB',jcl1))
00054500'LINE_AFTER 0 = "'jcl1'"'
00054600'LINE_AFTER 1 = "'jcl2'"'
00054700'LINE_AFTER 2 = "'jcl3'"'
00054800'LINE_AFTER 3 = "'jcl4'"'
00055000'LINE_AFTER 4 = "'jcl5'"'
00055100If Wordpos('CREATED',jcl6) > 0 Then,
00055200   Address TSO  "ACFVPUTT"
00055400   jcl6 = "//* Created in "center" on "Date()" at "Time()"."
00055500'LINE_AFTER 5 = "'jcl6'"'
00056000'LINE_AFTER 6 = "'jcl7'"'
00057000'LINE_AFTER 7 = "'jcl8'"'
00058000Return
00059000Initialize_jc_variables:
00060000   Address TSO  "ACFVPUTT"
00061100   xname = "'"ACFNAME"'"
00061200   jcl1 = "//"Userid()"1 JOB ("curacct","acfroom"),"xname","
00061300   jcl2 = "//       MSGCLASS=X,NOTIFY="Userid()",PRTY=14"
00061400   jcl3 = "//*MAIN EXEC="execntr",USER="Userid()",ORG="acfdest
00061500   jcl4 = "//*MAIN LINES=(5,W)"
00061600   jcl5 = "//*  "
00061700   jcl6 = "//* Created in "center" on "Date()" at "Time()"."
00061800   jcl7 = "//*  "
00061900   jcl8 = "//*JSTTEST EXEC PGM=JSTTEST /* JCL TEST */"
00062000Return
./ ADD NAME=RI002                                  12SEP93 18.26 --
00010000/* Rexx  Rexx  Rexx  Rexx  Rexx  Rexx  Rexx  Rexx  Rexx  Rexx  R
00020001Trace OFF
00030000Address 'TSO'
00040000Arg p1
00050000If Words(p1) = 0 Then Do
00060000   Say 'You must enter the NAME of the table to be processed.'
00070000   Exit
00080000   End
00090005Call Get_tbl_data
00100011If rc = 0 Then Do
00110011   Call Process_tbl_data
00120011   Call Rebuild_tbl
00130011   End;
00140000Exit
00150005Process_tbl_data:
00170005/*
00180005   Call Stemsort "TBGET.",,,"(1,6,CH,D,8,8,CH,A)"
00190005   Call Stemdisp "BROWSE","TBGET.",,,'List of Table('tblnam')'
00200005*/
00210011   Call Build_temp_tbl
00220005   spannam = pannam
00230005   pannam  = 'PSICMDIS'
00231013   Address 'ISPEXEC'
00232017   zscan = "ALL"
00233016   "VPUT (ZSCAN)"
00234017   "TBTOP   " tblnam
00240006   "TBDISPL " tblnam "PANEL("pannam")"
00250005   tbdcc = rc
00260006   pannamd = 'PSICMIN1'
00270011   Call Make_selection
00280005   pannam = spannam
00290005   names  = snames
00300005   tblnam = stblnam
00310005   keys   = ''
00320005   Return
00330011Make_selection:
00350011   Do i_tbdisp = 1 By 1 While tbdcc < 8
00360011      Call Process_options
00370011      Select;
00380011         When ztdsels > 1 Then Do
00390011            "TBDISPL " tblnam
00400011            End
00410011         Otherwise Do
00420011            "TBDISPL " tblnam "PANEL("pannam")"
00430011            tbdcc = rc
00440011            End
00450011         End /* End of Select ... */
00460011      End i_tbdisp
00470011   Return
00480011Process_options:
00500011   Select;
00510011      When Pos(zsz,'BIS') \= 0 Then Do
00520011         "DISPLAY PANEL("pannamd")"
00530011         End
00540011      When Pos(zsz,'CM') \= 0 Then Do
00550011         "DISPLAY PANEL("pannamd")"
00560021         sortf = Word(zctact,1)
00580019         "TBMOD "tblnam "ORDER"
00590011         zedsmsg = zctverb 'modified'
00600011         zedlmsg = ''
00610011         "SETMSG MSG(ISRZ000)"
00620011         End
00630011      When Pos(zsz,'D') \= 0 Then Do
00640011         "TBDELETE "tblnam
00650011         zedsmsg = zctverb 'deleted'
00660011         zedlmsg = ''
00670011         "SETMSG MSG(ISRZ000)"
00680011         End
00690011      When Pos(zsz,'A') \= 0 Then Do
00700011         "DISPLAY PANEL("pannamd")"
00701021         sortf = Word(zctact,1)
00710018         "TBADD "tblnam "ORDER"
00720011         zedsmsg = zctverb 'added'
00730011         zedlmsg = ''
00740011         "SETMSG MSG(ISRZ000)"
00750011         End
00760011      Otherwise Do
00770011         zedsmsg = zsz 'invalid'
00780011         zedlmsg = 'Valid options are Browse, Inquiry, Select,',
00790011                   'Change, Modify, Delete, Add.'
00800011         "SETMSG MSG(ISRZ000)"
00810011         End
00820011      End; /* End of Select ... */
00830011   Return
00840001Rebuild_tbl:
00860001   Call Alloc_isptabl
00870006   Address 'ISPEXEC'
00880011/*
00890001   "TBSTATS "tblnam "CDATE(CDATNAME)    CTIME(CTIMNAME)    ",
00900001            "UDATE(UDATNAME)    UTIME(UTIMNAME)    ",
00910001            "USER(USERNAME)     ROWCREAT(RCRTNAME) ",
00920001            "ROWCURR(RCURNAME)  ROWUPD(RUPDNAME)   ",
00930001            "TABLEUPD(TUPDNAME) SERVICE(SERVNAME)  ",
00940001            "RETCODE(RETCNAME)  STATUS1(STA1NAME)  ",
00950001            "STATUS2(STA2NAME)  STATUS3(STA3NAME)  "
00960001   Say       tblnam "CDATE("CDATNAME") CTIME("CTIMNAME")  ",
00970001            "UDATE("UDATNAME")  UTIME("UTIMNAME")  ",
00980001            "USER("USERNAME")   ROWCREAT("RCRTNAME") ",
00990001            "ROWCURR("RCURNAME") ROWUPD("RUPDNAME") ",
01000001            "TABLEUPD("TUPDNAME") SERVICE("SERVNAME") ",
01010001            "RETCODE("RETCNAME") STATUS1("STA1NAME") ",
01020001            "STATUS2("STA2NAME") STATUS3("STA3NAME") "
01030001  Say "TBSTATS rc("rc")"
01040001*/
01050012   "TBERASE " tblnam           /* Delelet original table */
01060014   "TBCREATE" tblnam "KEYS("keys") NAMES"names
01080011   If rc \= 0 Then Do
01090012/*    Say 'TBOPEN rc('rc') *** Error for table('tblnam').'
01100012*/    zedsmsg = 'Table error';
01110013      zedlmsg = 'Table('tblnam') can not be created.'
01120011      "SETMSG MSG(ISRZ001)"
01130011      rc = 4;
01140011      Return;
01150011      End
01151017/* "TBSORT  " tblnam "FIELDS(ZCTACT,C,A ZCTVERB,C,A)"
01152017*/
01160011   "TBTOP  TEMPTBL" /* Position CRP to 1st row */
01170011   "TBSKIP TEMPTBL"         /*                         */
01180011   tbgrc = rc
01190012
01200011   Do While tbgrc = 0;
01210015      "TBADD "tblnam "MULT("rownum") ORDER"
01220011      "TBSKIP TEMPTBL"
01230011      tbgrc =rc;
01240011      End;
01260011   "TBCLOSE "tblnam
01270011   "TBCLOSE  TEMPTBL"
01280011   Address "TSO" "FREE FI(ISPTABL)"
01290001   Return
01300001Alloc_isptabl:
01320001   x = Outtrap(aisp.)
01330001   Address TSO 'WHATLIB 'tblnam "ISPTLIB"
01340001   x = Outtrap('OFF')
01350001   Parse Var aisp.1 '(' atblnam ')' . '(' adsnam ')' .
01360001   Address 'TSO' "ALLOC FI(ISPTABL) DA("adsnam") SH REUSE"
01370001   Return
01380005Get_tbl_data:
01400004   tblnam = Word(p1,1)  /* First entry is the TABLE name*/
01410004   pannam = cmdtbldi
01420004   appldesc = 'Table 'tblnam
01421020   entries = 'Add Browse Change Delete'
01430004   Address 'ISPEXEC'
01440004   "TBOPEN " tblnam  "NOWRITE"
01450011   If rc \= 0 Then Do
01460012/*    Say 'TBOPEN rc('rc') *** Error for table('tblnam').'
01470012*/    zedsmsg = 'Table error';
01480011      zedlmsg = 'Table('tblnam') can not be opened.'
01490011      "SETMSG MSG(ISRZ001)"
01500011      rc = 4;
01510011      Return
01520004      End
01530004   "TBQUERY" tblnam "KEYS(KEYS) NAMES(NAMES) ROWNUM(ROWNUM)"
01540004   If rc \= 0 Then Do
01550012/*    Say 'TBQUERY rc('rc') **** Error for table('tblnam').'
01560012*/    zedsmsg = 'Table error';
01570012      zedlmsg = 'TBQUERY rc('rc') table('tblnam').'
01580012      "SETMSG MSG(ISRZ001)"
01590012      rc = 4;
01600012      Return;
01610004      End
01620004   xnames = Substr(names,2,Length(names)-1)
01630012/* Say 'KEYS('keys') NAMES('xnames') ROWNUM('rownum')'
01640012*/
01650012   "TBTOP " tblnam
01660004   "TBSKIP" tblnam
01670012   "TBGET " tblnam /*"SAVENAME(XNAMES)"*/
01680004   tbgcc = rc
01690004   Do i_tbget = 1 By 1 While tbgcc = 0
01700004      sort_fld = Word(zctact,1)
01710004      Select
01720017         When sort_fld = 'ALIAS' Then sort_fld = ''
01730004         Otherwise Nop
01740004         End /* End of Select ... */
01750004      tbget.i_tbget = Left(sort_fld,7)Left(zctverb,9),
01760004                      Left(zcttrunc,3)Left(zctact,50)Left(zctdes
01770004      "TBSKIP" tblnam
01780004      "TBGET "tblnam /*"SAVENAME(XNAMES)" */
01790004      tbgcc = rc
01800004      End i_tbget;
01810004   tbget.0 = rownum
01820011   "TBCLOSE " tblnam  /* Close input table */
01830004   Return
01840011Build_temp_tbl:
01860011   Address 'ISPEXEC'
01870011   stblnam = tblnam  /* Save this table name */
01880011   tblnam  = 'TEMPTBL'
01890011   snames  = names   /* Save Names of variables */
01900011   keys    = '(SORTF ZCTVERB)'
01910011   names   = '(ZCTTRUNC ZCTACT ZCTDESC)'
01920013   "TBCREATE "tblnam "NOWRITE KEYS"keys "NAMES"names
01921016   "TBSORT "tblnam "FIELDS(SORTF,C,A ZCTVERB,C,A)"
01930011   mult = "MULT("rownum")"
01940011   Do i_tbadd = 1 By 1 While i_tbadd <= rownum
01950011      Parse Var tbget.i_tbadd sortf +7 zctverb +9 zcttrunc +3 zc
01960011                +50 zctdesc +60 .
01970011     sortf    = Space(sortf)
01980011     zctverb  = Space(zctverb)
01990011     zcttrunc = Space(zcttrunc)
02000011     zctact   = Space(zctact)
02010011     zctdesc  = Space(zctdesc)
02020015     "TBADD "tblnam mult "ORDER"
02030011     mult = ''
02040011     End i_tbadd
02050011   Return
./ ADD NAME=RI003                                  12SEP93 18.26 --
00010000/* Rexx  Rexx  Rexx  Rexx  Rexx  Rexx  Rexx  Rexx  Rexx  Rexx  R
00020000Trace OFF
00030000Address 'TSO'
00040000Arg p1
00050000Call Initialize
00060001If rc = 0 Then   Call Process_tbl_data
00070001Call Eoj
00080000Exit
00090002Process_tbl_data:
00100002   tempnam1 = 'TEMPNAM1'
00110002   tempnam2 = 'TEMPNAM2'
00111006   Address 'TSO' "ALLOC FI(TLIB1) DA("tlib1") SH REUSE"
00111106   Address 'TSO' "ALLOC FI(TLIB2) DA("tlib2") SH REUSE"
00120006   Call Create_keyed_table "TLIB1" tblnam1 tempnam1
00130006   Call Create_keyed_table "TLIB2" tblnam2 tempnam2
00150001   Address "ISPEXEC"
00160007   "TBTOP  TEMPNAM2"
00170007   "TBSKIP TEMPNAM2"
00180007   "TBGET  TEMPNAM2"
00190002   tbgrc = 0
00200002   dupes = 0
00210002   diffs = 0
00220002   Do While tbgrc = 0
00230008/*    Say zctverb dupes 'and 'diffs
00231008*/
00240007      "TBDELETE TEMPNAM1"
00250002      If rc = 0 Then dupes = dupes + 1
00260008      Else Do
00261008         diffs = diffs + 1
00262008         "TBADD  TEMPNAM1"  /* add if this is a NEW SYSTEM funct
00263008         End;
00270007      "TBSKIP TEMPNAM2"
00271006      tbgrc = rc
00280007      "TBGET  TEMPNAM2"
00300001      End /* End of Do While ... */
00320002   /* Display the differences table */
00330007/* "TBDISPL TEMPNAM1  PANEL(CMDTBLDI)"
00331007*/
00340002   Call Build_difference_table
00350000   Return
00351007Copy_tblnam1:
00352006   Select;
00353006      When tlib1 = tlib2 Then Nop
00354006      Otherwise Do
00355006         End
00356006      End /* End of Select ... */
00360006   Return
00560003Create_keyed_table:
00570003   Arg tlib tblnam tempname
00590003   Address 'ISPEXEC'
00600003   "TBCREATE "tempname "NOWRITE KEYS(ZCTVERB)",
00610003       "NAMES( ZCTTRUNC ZCTACT ZCTDESC)"
00620006   "TBOPEN "tblnam "LIBRARY("tlib") NOWRITE"
00630003   tborc = rc
00640003   "TBTOP "tblnam
00650003   "TBSKIP "tblnam
00651009   tbgrc = rc
00660003   "TBGET  "tblnam
00680003   Do While tbgrc = 0
00690003      "TBADD  "tempname "ORDER"
00700003      "TBSKIP "tblnam
00701009      tbgrc = rc
00710003      "TBGET  "tblnam
00730003      End;
00740004   If tborc = 0 Then Do
00750006      "TBCLOSE "tblnam "LIBRARY("tlib")"
00760005      End
00780003   Return;
00790003Build_difference_table:
00810003   "TBERASE "tblnamd "LIBRARY(TLIB1)"
00820003   "TBCREATE "tblnamd  "WRITE",
00830003       "NAMES(ZCTVERB ZCTTRUNC ZCTACT ZCTDESC)",
00840003       "LIBRARY(TLIB1)"
00850007   "TBTOP  TEMPNAM1"
00860007   "TBSKIP TEMPNAM1"
00861006   tbgrc = rc
00870007   "TBGET  TEMPNAM1"
00890003   Do While tbgrc = 0
00900008/*    Say zctverb
00901008*/
00910003      "TBADD "tblnamd
00920007      "TBSKIP TEMPNAM1"
00921006      tbgrc = rc
00930007      "TBGET  TEMPNAM1"
00950003      End /* End of Do While ... */
00950108   appldesc = 'Command table differences between 'tblnam1' and '
00951008   select = ' No selectable options'
00952008   shad1  = ' '
00960008   "TBTOP   "tblnamd
00970008   "TBDISPL "tblnamd "PANEL(CMDTBLDI)"
00971008/* */
00980004   Address "TSO" "ALLOC FI(ISPTABL) DA("tlib1") SH REUSE"
00990003   "TBCLOSE "tblnamd
01000003   Address "TSO" "FREE  FI(ISPTABL) "
01010003   Return
01020006Eoj:
01030006   Address 'ISPEXEC'
01040006   "TBCLOSE TEMPNAM1"
01050006   "TBCLOSE TEMPNAM2"
01060006   Address "TSO" "FREE FI(TLIB1 TLIB2)"
01070006   Return
01080006Initialize:
01090006   If Sysvar(Sysispf) \= 'ACTIVE' Then Do
01100006      Parse Source environement . exec_name .
01110006      "ISPF CMD(%"exec_name p1")"
01120006      Exit
01130006      End
01140006   appldesc = 'Create a differences table'
01140208   select = ' Options: Add Change Delete Modify Browse '
01141008   shad1  = ' %+=====% !+=%!+====%!+====%!+====%!+==== '
01150006   Address 'ISPEXEC'
01160006   "CONTROL DISPLAY SAVE"
01170006   "ADDPOP"
01180006   "DISPLAY PANEL(CMDTBLD1)"
01190006   irc = rc
01200006   "REMPOP"
01210006   If irc \= 0 Then rc = irc
01220006   Return;
./ ADD NAME=RI004                                  12SEP93 18.26 --
/** BRSUB *************************************************** Rexx **/
/*  Submit from BROWSE.                                             */
/*  By R Iappini                      05/92                         */
/********************************************************************/
Address 'ISPEXEC'
'vget zscreen '
If zscreen = 2 then  do
'vget (zdsn2 zmemb2 ztitle2) Shared '
zdsn = zdsn2
zmemb = zmemb2
ztitle = ztitle2
end
else 'vget (zdsn zmemb ztitle) shared  '
if zmemb = '' then  dsname = zdsn
else   dsname = zdsn'('zmemb')'
If dsname ^= '' & Dsname ^= 'DSNAME' then do
  If sysdsn("'"dsname"'") = 'OK' then do
  Address 'TSO'
  "SUB  '"space(dsname,0)"'"
  zedsmsg = 'Dsn submitted'
  zedlmsg = dsname 'submitted'
  Address 'ISPEXEC'
  'SETMSG MSG(ISRZ001)'
  End
End
./ ADD NAME=RI005                                  12SEP93 18.26 --
00010000/* Rexx  Rexx  Rexx  Rexx  Rexx  Rexx  Rexx  Rexx  Rexx  Rexx  R
00011000Address 'TSO'
00020000Trace 'OFF'
00030000Address 'TSO'
00040000Arg parms
00050002debug = Keywordv('DEBUG',parms);
00051002If debug ^= '' Then Do
00052002   Trace ?i
00053002   x = Wordpos('DEBUG',parms)
00054002   If x \= 0 Then parms = Delword(parms,x,1)
00055002   End
00060000Call Initialize_env
00070000Call Check_table
00080000Call Main_process
00090000Call Eoj     /* End of Job routine */
00100000/**************************************************************/
00110001/*                      ISPFCMDS SUBROUTINE(S)                */
00120000/**************************************************************/
00130000Eoj:
00140000   Address 'ISPEXEC'
00150001   "TBEND   "tblnam
00160000   Exit
00170000Initialize_env:
00171001   Parse Source environment . exec_name .
00180001   If Sysvar(Sysispf) ^= ACTIVE Then Do
00190001      "ISPF CMD(%"exec_name  parms")"
00200000      Exit
00210000      End
00220000   Address 'ISPEXEC'
00230000   pwelcome = Center(,
00240001              'Welcome: ISPF Command Table List processor',80)
00250000   "CONTROL DISPLAY LOCK"
00260001   appldesc = Center('Your ISPF Command Table List',80)
00270000   "DISPLAY PANEL(PWELCOME)"
00280000   Return
00290000Check_table:
00300000/**************************************************************/
00310001/* Create a List of ISPF commands for this execution          */
00320000/**************************************************************/
00321001   tblnam = 'MYCURISP'
00321101   Address 'ISPEXEC'
00322001   "TBCREATE "tblnam "KEYS(CMDNAME) ",
00323001      " NAMES(",
00324001         "CMDTXT1, CMDTXT2, DESC",
00328001         ") ",
00329001      "NOWRITE "
00340001   "VGET (ZAPPLID) "
00341002   appl_ids = parms zapplid "ISP"
00350002   Do i_appl_ids = 1 By 1 To Words(appl_ids)
00370002      Call Build_work_table Word(appl_ids,i_appl_ids)
00371002      End i_appl_ids;
00380000   entries = 'Browse,Select,Help'
00390000   If Keywordv('UPDATE',parms) = '' Then Do
00390100      Write = 'NOWRITE'
00390200      End
00390300   Else Do
00390400      entries = 'U,D,C,M,'entries
00390500      Write = 'Write'
00390600      End
00390800   scmds = 'FIND, LOCATE' /* SUPPORTED COMMANDS */
00390901   appldesc = Center('Your ISPF Command Table List',80)
00391000   appldesc = Space(appldesc)
00392001   applhelp = "#ISPFCMDS"
00392100   Address 'ISPEXEC'
00392200   "VPUT (entries applhelp appldesc) SHARED"
00400001   "TBSORT "tblnam "FIELDS(CMDNAME,C,A)"
00410000   Return
00555400Main_process:
00555600   Address 'ISPEXEC'
00555701   "TBTOP "tblnam
00555801   "TBDISPL "tblnam"    PANEL(PDIRTSOS)"
00555900   tcc = rc
00556001   If zcmd = 'END' Then tcc = 5
00556100   Do While tcc <= 4
00556200      Select
00557000         When zcmd = '' Then Call No_zcmd_process
00558000         Otherwise Call zcmd_process
00559000         End /* End of Select ... */
00560001      If ztdsels > 1 Then "TBDISPL "tblnam /* Multiple SELECTION
00570001      Else "TBDISPL "tblnam "PANEL(PDIRTSOS)"
00580000      tcc = rc
00581001      If zcmd = 'END' Then tcc = 5
00590000      End    /*  End of Do W... */
00600000   Return
00610000No_zcmd_process:
00620001   Upper popt
00630000   Select
00640000     When POPT = 'H' Then Do
00650000        "CONTROL DISPLAY SAVE"
00660000         Address 'TSO'"HLP "cmdname
00670000        "CONTROL DISPLAY RESTORE"
00680000         End
00690000     When POPT = 'B' Then Do
00691003         Say cmdtxt1 cmdtxt2 desc
00830000         End
00840000     When POPT = 'S' Then Do
00850003        Parse Var cmdtxt1 x_s1 '&' x_s2 x_rest
00850203        Select;
00850303           When ^Abbrev('ZPARM)',x_s2) Then Nop
00850403           Otherwise Do
00850503              "CONTROL DISPLAY SAVE"
00850703              If Right(x_s2,1) = ')' Then
00850803                 x_s2 = cmdopts')'
00850903              Else x_s2  = cmdopts
00851003              x_s1 x_s2 x_rest          /* execute this dialog c
00870003              "CONTROL DISPLAY RESTORE"
00871003              End
00872003           End /* End of Select ... */
00880003         End     /* End of When   ... */
00890000     Otherwise Do
00900000        smsg = 'Invalid option'
00910000        lmsg = 'Option('popt') not supported; valid options are
00920000        "SETMSG MSG(CMN000)"
00930000        End
00940000     End /* End Of Select ... */
00950000Return
00960001Zcmd_process:
00970001   Parse Upper Var zcmd func parms
00980000   Select
00990001      When abbrev('END',func) Then Do
00991001         rc = 5
01080000         End
01090000      When abbrev('FIND',func) Then Do
01100000         rowopt = 'ALL'
01110000         parse var parms cmdname .
01120001         "TBEXIST  "tblnam
01130000          If rc ^= 0 Then Do
01140000             smsg = 'Row does not EXIST'
01150000             lmsg = 'Row('cmdname') missing,',
01160000                    'display reset to the TOP'
01170000             "SETMSG MSG(CMN000)"
01180000             End
01190000         End
01200000      When abbrev('DEBUG',func) Then Do
01210000         If Word(parms,1) = 'ON' Then Trace ?I
01220000         Else Trace 'OFF'
01230000         End
01240000      Otherwise Do
01250000         smsg = 'Invalid command'
01260000         lmsg = 'Command('zcmd') not supported;'scmds' are suppo
01270000         "SETMSG MSG(CMN000)"
01280000         End
01290000      End /* End of Select ... */
01300000   Return
01300101Build_work_table:
01300301   Arg applid
01300401   xtblnam = applid"CMDS"
01300501   "TBSTATS " xtblnam,
01300601            "CDATE(CDATNAME)    CTIME(CTIMNAME)    ",
01300701            "UDATE(UDATNAME)    UTIME(UTIMNAME)    ",
01300801            "USER(USERNAME)     ROWCREAT(RCRTNAME) ",
01300901            "ROWCURR(RCURNAME)  ROWUPD(RUPDNAME)   ",
01301001            "TABLEUPD(TUPDNAME) SERVICE(SERVNAME)  ",
01301101            "RETCODE(RETCNAME)  STATUS1(STA1NAME)  ",
01301201            "STATUS2(STA2NAME) STATUS3(STA3NAME)  "
01301301/* Say      xtblnam "CDATE("CDATNAME") CTIME("CTIMNAME")  ",
01301401            "UDATE("UDATNAME")  UTIME("UTIMNAME")  ",
01301501            "USER("USERNAME")   ROWCREAT("RCRTNAME") ",
01301601            "ROWCURR("RCURNAME") ROWUPD("RUPDNAME") ",
01301701            "TABLEUPD("TUPDNAME") SERVICE("SERVNAME") ",
01301801            "RETCODE("RETCNAME") STATUS1("STA1NAME") ",
01301901            "STATUS2("STA2NAME") STATUS3("STA3NAME") "
01302001  Say "TBSTATS rc("rc")"
01302101*/
01302301  Select;
01302401     When sta1name \= 1 Then Do
01302701         zedsmsg = xtblnam' missing.'
01302803         zedlmsg = xtblnam 'does not exist for this function.'
01302901         "SETMSG MSG(ISRZ001)"
01303101         Return;
01303201         End
01303401     When sta2name = 1 Then Do
01303501        "TBOPEN " xtblnam "NOWRITE"
01303601        If rc \= 0 Then Do
01303701           zedsmsg = xtblnam' missing.'
01303801           zedlmsg = 'This procedure does not have a command tab
01303901           "SETMSG MSG(ISRZ001)"
01304001        /* Say 'TBOPEN rc('rc') for table('xtblnam') **** Error.
01304101        */ Return;
01304201           End
01304301        End
01304401      Otherwise Nop
01304501      End  /* End of Select ... */
01304601   "TBTOP"  xtblnam
01304701   "TBSKIP" xtblnam
01304801   "TBGET " xtblnam /* read from specified command table */
01304901   tbgcc = rc
01305001   Do i_tbget = 1 By 1 While tbgcc = 0
01305101      cmdname = zctverb
01305201      cmdtxt1 = zctact
01305301      cmdtxt2 = zcttrunc
01305401      desc    = zctdesc
01305501      "TBADD "  tblnam /* add to work_table */
01305601      "TBSKIP" xtblnam
01305701      "TBGET " xtblnam /* read from specified command table */
01305801      tbgcc = rc
01306001      End i_tbget;
01310001   If sta2name = 1 Then "TBCLOSE " xtblnam
01320001   Return;
./ ADD NAME=RI007                                  12SEP93 18.26 --
00010000/* Rexx  Rexx  Rexx  Rexx  Rexx  Rexx  Rexx  Rexx  Rexx  Rexx  R
00011000Address 'TSO'
00020000Trace 'OFF'
00030000Address 'TSO'
00040000Arg parms
00050002debug = Keywordv('DEBUG',parms);
00051002If debug ^= '' Then Do
00052002   Trace ?i
00053002   x = Wordpos('DEBUG',parms)
00054002   If x \= 0 Then parms = Delword(parms,x,1)
00055002   End
00060000Call Initialize_env
00070000Call Check_table
00080000Call Main_process
00090000Call Eoj     /* End of Job routine */
00100000/**************************************************************/
00110001/*                      ISPFCMDS SUBROUTINE(S)                */
00120000/**************************************************************/
00130000Eoj:
00140000   Address 'ISPEXEC'
00150001   "TBEND   "tblnam
00160000   Exit
00170000Initialize_env:
00171001   Parse Source environment . exec_name .
00180001   If Sysvar(Sysispf) ^= ACTIVE Then Do
00190001      "ISPF CMD(%"exec_name  parms")"
00200000      Exit
00210000      End
00220000   Address 'ISPEXEC'
00230000   pwelcome = Center(,
00240001              'Welcome: ISPF Command Table List processor',80)
00250000   "CONTROL DISPLAY LOCK"
00260001   appldesc = Center('Your ISPF Command Table List',80)
00270000   "DISPLAY PANEL(PWELCOME)"
00280000   Return
00290000Check_table:
00300000/**************************************************************/
00310001/* Create a List of ISPF commands for this execution          */
00320000/**************************************************************/
00321001   tblnam = 'MYCURISP'
00321101   Address 'ISPEXEC'
00322001   "TBCREATE "tblnam "KEYS(CMDNAME) ",
00323001      " NAMES(",
00324001         "CMDTXT1, CMDTXT2, DESC",
00328001         ") ",
00329001      "NOWRITE "
00340001   "VGET (ZAPPLID) "
00341002   appl_ids = parms zapplid "ISP"
00350002   Do i_appl_ids = 1 By 1 To Words(appl_ids)
00370002      Call Build_work_table Word(appl_ids,i_appl_ids)
00371002      End i_appl_ids;
00380000   entries = 'Browse,Select,Help'
00390000   If Keywordv('UPDATE',parms) = '' Then Do
00390100      Write = 'NOWRITE'
00390200      End
00390300   Else Do
00390400      entries = 'U,D,C,M,'entries
00390500      Write = 'Write'
00390600      End
00390800   scmds = 'FIND, LOCATE' /* SUPPORTED COMMANDS */
00390901   appldesc = Center('Your ISPF Command Table List',80)
00391000   appldesc = Space(appldesc)
00392001   applhelp = "#ISPFCMDS"
00392100   Address 'ISPEXEC'
00392200   "VPUT (entries applhelp appldesc) SHARED"
00400001   "TBSORT "tblnam "FIELDS(CMDNAME,C,A)"
00410000   Return
00555400Main_process:
00555600   Address 'ISPEXEC'
00555701   "TBTOP "tblnam
00555801   "TBDISPL "tblnam"    PANEL(PDIRTSOS)"
00555900   tcc = rc
00556001   If zcmd = 'END' Then tcc = 5
00556100   Do While tcc <= 4
00556200      Select
00557000         When zcmd = '' Then Call No_zcmd_process
00558000         Otherwise Call zcmd_process
00559000         End /* End of Select ... */
00560001      If ztdsels > 1 Then "TBDISPL "tblnam /* Multiple SELECTION
00570001      Else "TBDISPL "tblnam "PANEL(PDIRTSOS)"
00580000      tcc = rc
00581001      If zcmd = 'END' Then tcc = 5
00590000      End    /*  End of Do W... */
00600000   Return
00610000No_zcmd_process:
00620001   Upper popt
00630000   Select
00640000     When POPT = 'H' Then Do
00650000        "CONTROL DISPLAY SAVE"
00660000         Address 'TSO'"HLP "cmdname
00670000        "CONTROL DISPLAY RESTORE"
00680000         End
00690000     When POPT = 'B' Then Do
00691003         Say cmdtxt1 cmdtxt2 desc
00830000         End
00840000     When POPT = 'S' Then Do
00850003        Parse Var cmdtxt1 x_s1 '&' x_s2 x_rest
00850203        Select;
00850303           When ^Abbrev('ZPARM)',x_s2) Then Nop
00850403           Otherwise Do
00850503              "CONTROL DISPLAY SAVE"
00850703              If Right(x_s2,1) = ')' Then
00850803                 x_s2 = cmdopts')'
00850903              Else x_s2  = cmdopts
00851003              x_s1 x_s2 x_rest          /* execute this dialog c
00870003              "CONTROL DISPLAY RESTORE"
00871003              End
00872003           End /* End of Select ... */
00880003         End     /* End of When   ... */
00890000     Otherwise Do
00900000        smsg = 'Invalid option'
00910000        lmsg = 'Option('popt') not supported; valid options are
00920000        "SETMSG MSG(CMN000)"
00930000        End
00940000     End /* End Of Select ... */
00950000Return
00960001Zcmd_process:
00970001   Parse Upper Var zcmd func parms
00980000   Select
00990001      When abbrev('END',func) Then Do
00991001         rc = 5
01080000         End
01090000      When abbrev('FIND',func) Then Do
01100000         rowopt = 'ALL'
01110000         parse var parms cmdname .
01120001         "TBEXIST  "tblnam
01130000          If rc ^= 0 Then Do
01140000             smsg = 'Row does not EXIST'
01150000             lmsg = 'Row('cmdname') missing,',
01160000                    'display reset to the TOP'
01170000             "SETMSG MSG(CMN000)"
01180000             End
01190000         End
01200000      When abbrev('DEBUG',func) Then Do
01210000         If Word(parms,1) = 'ON' Then Trace ?I
01220000         Else Trace 'OFF'
01230000         End
01240000      Otherwise Do
01250000         smsg = 'Invalid command'
01260000         lmsg = 'Command('zcmd') not supported;'scmds' are suppo
01270000         "SETMSG MSG(CMN000)"
01280000         End
01290000      End /* End of Select ... */
01300000   Return
01300101Build_work_table:
01300301   Arg applid
01300401   xtblnam = applid"CMDS"
01300501   "TBSTATS " xtblnam,
01300601            "CDATE(CDATNAME)    CTIME(CTIMNAME)    ",
01300701            "UDATE(UDATNAME)    UTIME(UTIMNAME)    ",
01300801            "USER(USERNAME)     ROWCREAT(RCRTNAME) ",
01300901            "ROWCURR(RCURNAME)  ROWUPD(RUPDNAME)   ",
01301001            "TABLEUPD(TUPDNAME) SERVICE(SERVNAME)  ",
01301101            "RETCODE(RETCNAME)  STATUS1(STA1NAME)  ",
01301201            "STATUS2(STA2NAME) STATUS3(STA3NAME)  "
01301301/* Say      xtblnam "CDATE("CDATNAME") CTIME("CTIMNAME")  ",
01301401            "UDATE("UDATNAME")  UTIME("UTIMNAME")  ",
01301501            "USER("USERNAME")   ROWCREAT("RCRTNAME") ",
01301601            "ROWCURR("RCURNAME") ROWUPD("RUPDNAME") ",
01301701            "TABLEUPD("TUPDNAME") SERVICE("SERVNAME") ",
01301801            "RETCODE("RETCNAME") STATUS1("STA1NAME") ",
01301901            "STATUS2("STA2NAME") STATUS3("STA3NAME") "
01302001  Say "TBSTATS rc("rc")"
01302101*/
01302301  Select;
01302401     When sta1name \= 1 Then Do
01302701         zedsmsg = xtblnam' missing.'
01302803         zedlmsg = xtblnam 'does not exist for this function.'
01302901         "SETMSG MSG(ISRZ001)"
01303101         Return;
01303201         End
01303401     When sta2name = 1 Then Do
01303501        "TBOPEN " xtblnam "NOWRITE"
01303601        If rc \= 0 Then Do
01303701           zedsmsg = xtblnam' missing.'
01303801           zedlmsg = 'This procedure does not have a command tab
01303901           "SETMSG MSG(ISRZ001)"
01304001        /* Say 'TBOPEN rc('rc') for table('xtblnam') **** Error.
01304101        */ Return;
01304201           End
01304301        End
01304401      Otherwise Nop
01304501      End  /* End of Select ... */
01304601   "TBTOP"  xtblnam
01304701   "TBSKIP" xtblnam
01304801   "TBGET " xtblnam /* read from specified command table */
01304901   tbgcc = rc
01305001   Do i_tbget = 1 By 1 While tbgcc = 0
01305101      cmdname = zctverb
01305201      cmdtxt1 = zctact
01305301      cmdtxt2 = zcttrunc
01305401      desc    = zctdesc
01305501      "TBADD "  tblnam /* add to work_table */
01305601      "TBSKIP" xtblnam
01305701      "TBGET " xtblnam /* read from specified command table */
01305801      tbgcc = rc
01306001      End i_tbget;
01310001   If sta2name = 1 Then "TBCLOSE " xtblnam
01320001   Return;
./ ADD NAME=RI008                                  12SEP93 18.26 --
00010000 SELECT PGM(ISPOPT) PARM(ISPOPT1) 6 ISPF Terminal Options panel
./ ADD NAME=RI009                                  12SEP93 18.26 --
00010000 SELECT PGM(ISPOPT) PARM(ISPOPT2) 5 ISPF LIST/LOG PARAMETERS
./ ADD NAME=RI010                                  12SEP93 18.26 --
00010000/* Rexx  Rexx  Rexx  Rexx  Rexx  Rexx  Rexx  Rexx  Rexx  Rexx  R
00020000Trace OFF
00030000Address 'TSO'
00040000Arg p1
00050000Call Initialize
00060000If rc = 0 Then   Call Process_tbl_data
00070000Call Eoj
00080000Exit
00090000Process_tbl_data:
00100000   tempnam1 = 'TEMPNAM1'
00110000   tempnam2 = 'TEMPNAM2'
00111001   Address 'TSO' "ALLOC FI(TLIB1) DA("tlib1m") SH REUSE"
00112001   Address 'TSO' "ALLOC FI(TLIB2) DA("tlib2m") SH REUSE"
00113001   Call Create_keyed_table "TLIB1" tblnam1m tempnam1
00114001   Call Merge_keyed_table "TLIB2" tblnam2m tempnam1
00300001   Call Build_merge_table
00310000   Return
00320001Copy_tblnam1m:
00330000   Select;
00340000      When tlib1 = tlib2 Then Nop
00350000      Otherwise Do
00351000         End
00352000      End /* End of Select ... */
00353000   Return
00354000Create_keyed_table:
00355000   Arg tlib tblnam tempname
00356000   Address 'ISPEXEC'
00357002   "TBCREATE "tempname "NOWRITE KEYS(SORTFL ZCTVERB)",
00358000       "NAMES( ZCTTRUNC ZCTACT ZCTDESC)"
00358104   "TBSORT "tempname "FIELDS(SORTFL,C,A ZCTVERB,C,A)"
00359000   "TBOPEN "tblnam "LIBRARY("tlib") NOWRITE"
00360000   tborc = rc
00361003   "TBQUERY "tblnam   "KEYS(KEYS) NAMES(NAMES)"
00362003   keys = Translate(Translate(keys,' ','('),' ',')');
00363003   names = Translate(Translate(names,' ','('),' ',')');
00370000   "TBTOP "tblnam
00380000   "TBSKIP "tblnam
00390000   tbgrc = rc
00410000   Do While tbgrc = 0
00412002      sortfl = Word(zctact,1)
00420000      "TBADD  "tempname "ORDER"
00430000      "TBSKIP "tblnam
00440000      tbgrc = rc
00460000      End;
00470000   If tborc = 0 Then Do
00480000      "TBCLOSE "tblnam "LIBRARY("tlib")"
00490000      End
00491005/* "TBDISPL "tempname "PANEL(CMDTBLDI)"
00492005*/
00500000   Return;
00510001Build_merge_table:
00511003   Address 'ISPEXEC';
00520002   "TBERASE "tblnamdm "LIBRARY(TLIB1)"
00530001   "TBCREATE "tblnamdm "WRITE",
00540000       "NAMES(ZCTVERB ZCTTRUNC ZCTACT ZCTDESC)",
00550002       "LIBRARY(TLIB1)"
00560000   "TBTOP  TEMPNAM1"
00570000   "TBSKIP TEMPNAM1"
00580000   tbgrc = rc
00600000   Do While tbgrc = 0
00630001      "TBADD "tblnamdm
00640000      "TBSKIP TEMPNAM1"
00650000      tbgrc = rc
00670000      End /* End of Do While ... */
00671005   "TBCLOSE TEMPNAM1"
00680001   appldesc = 'Merge command tables 'tblnam1m' and 'tblnam2m
00690000   select = ' No selectable options'
00700000   shad1  = ' '
00710001   "TBTOP   "tblnamdm
00720005   "TBDISPL "tblnamdm "PANEL(CMDTBLDI)"
00730005/* */
00740001   Address "TSO" "ALLOC FI(ISPTABL) DA("tlib1m") SH REUSE"
00750001   "TBCLOSE "tblnamdm
00760000   Address "TSO" "FREE  FI(ISPTABL) "
00770000   Return
00780000Eoj:
00820000   Address "TSO" "FREE FI(TLIB1 TLIB2)"
00830000   Return
00840000Initialize:
00841003   Parse Source environement . exec_name .
00850000   If Sysvar(Sysispf) \= 'ACTIVE' Then Do
00870003      "ISPF CMD(%"exec_name p1") NEWAPPL(CMDT)"
00880000      Exit
00890000      End
00891003   Address 'ISPEXEC'
00892003   "VGET (ZAPPLID)"
00893003   If zapplid \= 'CMDT' Then Do
00894003      "SELECT CMD(%"exec_name p1") NEWAPPL(CMDT)"
00895003      Exit
00896003      End
00900001   appldesc = 'Create a merged table'
00910000   select = ' Options: Add Change Delete Modify Browse '
00920000   shad1  = ' %+=====% !+=%!+====%!+====%!+====%!+==== '
00940000   "CONTROL DISPLAY SAVE"
00950000   "ADDPOP"
00960001   "DISPLAY PANEL(CMDTBLME)"
00970000   irc = rc
00980000   "REMPOP"
00990000   If irc \= 0 Then rc = irc
01000000   Return;
01000102Merge_keyed_table:
01000601   Address "ISPEXEC"
01000702   "TBOPEN "tblnam2m "NOWRITE LIBRARY(TLIB2)"
01000802   "TBTOP  " tblnam2m
01000902   "TBSKIP " tblnam2m
01001001   tbgrc = 0
01001101   dupes = 0
01001201   new_ones = 0
01001301   Do While tbgrc = 0
01001702      sortfl = Word(zctact,1)
01001805      "TBADD TEMPNAM1 ORDER"
01001901      If rc = 0 Then dupes = dupes + 1
01002001      Else new_ones = new_ones + 1
01002302      "TBSKIP " tblnam2m
01002401      tbgrc = rc
01002601      End /* End of Do While ... */
01002701   /* Display the merged table */
01002805   "TBDISPL TEMPNAM1 PANEL(CMDTBLDI)"
01003005/* */
01010001   Return;
./ ADD NAME=RI011                                  12SEP93 18.26 --
00010006/* Rexx  Rexx  Rexx  Rexx  Rexx Rexx Rexx  Rexx  Rexx Rexx Rexx
00020006Address 'TSO'
00030006Parse Source environment .  exec_name .
00040006Trace "OFF"
00060007Arg r_ddname r_dsns r_vols  .
00070007@tcb = Storage(21c,4);                   /*get tcb address from
00080007@tiot = Storage(D2x(C2d(@tcb)+12),4);    /* add 12 to TIOT addre
00090007@1stdd = D2x(C2d(@tiot)+28);             /* point to 1st DD in T
00100007@1stddlen = Storage(D2x(C2d(@tiot)+24), 1);/* get 1st length */
00110007@tiot = D2x(C2d(@tiot)+24);              /* point to 1st TIOT DD
00120007@jfcb = Storage(D2x(X2d(@tiot)+12),3);   /* get JFCB address fro
00130006found = 0;
00140006ll_dsns = '';
00150007ll_vols = '';
00160006DO while C2d(@1stddlen) \=0 /* loop through entire TIOT */
00170004   If Storage(@1stdd,1)/='00'x then Do
00180005      ddname = Storage(@1stdd,8)
00190006      If ^found Then,
00200007      If ddname = r_ddname Then found = 1
00210007      If found Then Do
00220007         volser =  Storage(D2x(C2d(@jfcb)+134),6)
00230007         dsn    =  Storage(D2x(C2d(@jfcb)+16),44)
00240007         Select
00250007            When ddname = ' ' Then Do
00260007               ll_dsns =  ll_dsns dsn
00270007               ll_vols =  ll_vols volser
00280007               End
00290007            When ddname = r_ddname  Then Do
00300007               ll_dsns = ll_dsns dsn
00310007               ll_vols =  ll_vols volser
00320007               End
00330007            Otherwise Do
00340007              rc =  Words(ll_dsns)
00350007              If r_vols \= '' Then,
00360007                 Return (r_dsns' = 'lldsns';'r_vols' = 'll_volse
00380007              Else Return (r_dsns' = 'Space(ll_dsns))
00390007              End                       /* End of Otherwise ...
00391007           End                          /* End of Select  ... */
00400007         End                            /* End of If found ... *
00410007      End                                  /* End of If Storage
00420006   @tiot = D2x(X2d(@tiot)+C2d(@1stddlen )) /*point to next TIOT
00430007   @1stddlen = Storage(@tiot,1)            /*get length of TIOT
00440007   @1stdd = D2x(X2d(@tiot)+4)              /* point at DDname in
00450007   @jfcb = Storage(D2x(X2d(@tiot)+12),3)   /* get next JFCB addr
00460007   End                                     /* End of Do While ..
00470007If Words(ll_dsns) = 0 Then rc = 4          /* must not be alloca
00480006Else rc = 0
00490007If r_vols \= '' Then,
00500007   Return (r_dsns' = 'lldsns';'r_vols' = 'll_volser';')
00510007Else Return (r_dsns' = 'Space(ll_dsns))
./ ADD NAME=RI012                                  12SEP93 18.26 --
00001000/* Rexx  Rexx  Rexx  Rexx  Rexx  Rexx  Rexx  Rexx  Rexx  Rexx  R
00002000Address 'TSO'
00003000Arg p1
00020000/* Comments are located at the bottom of this program..........
00050000KEYWORDV:
00060000TRACE  'OFF'
00070000If Arg() = 1 Then
00080000   Arg match against
00090000Else ,
00100000   Arg match, against
00110000If Length(against) = 0 Then Return('')
00120000#keyw = Words(against)
00130000If #keyw = 0 Then Return('')
00140000found_match = 0
00150000Do j = 1 by 1 While Length(against) > 0
00160000   against = Strip(against,'L')
00170000   X = Word(against,1)
00180000   y = Pos('(',x)
00190000   Select
00200000      When y > 0 Then Do  /* found a keyword with value */
00210000         test_Word.j = Substr(against,1,Y-1)
00220000         z = Pos(')',against)
00230000         value.j = Substr(against,y+1,z-y)
00240000         against = Substr(against,z+1)
00250000         y1 = Pos('(',value.j)
00260000         prev_Y1 = 0
00270000         Do While y1 > 0 & Length(against) > 0
00280000            prev_y1 = y1 + prev_y1 + 1
00290000            z = Pos(')',against)
00300000            value.j = value.j || Substr(against,1,z)
00310000            against = Substr(against,z+1)
00320000            y1 = Pos('(',Substr(value.j,prev_y1))
00330000            End
00340000         value.j = Strip(value.j)
00350000         y1 = lastpos(')',value.j)
00360000         If y1 = Length(value.j) Then
00370000            value.j = Substr(value.j,1,y1-1) /* lose last ) */
00380000         End
00390000      Otherwise Do
00400000         test_Word.j = x
00410000         value.j = ''
00420000         against = Delstr(against,1,Length(test_Word.j))
00430000         End /* End of Otherwise */
00440000      End /* End of Select ... */
00450000      against = Strip(against,'L')
00460000   End j /* End of Do j ... */
00470000Do i = 1 to j
00480000   Select
00490001      When  Abbrev(match,test_Word.i) Then Do
00500000        If value.i ^= '' Then
00510000           Return(value.i)
00520000        Else Return(match)
00530000        End /* End of When (i ... */
00540000      Otherwise
00550000      End /* End of Select */
00560000   End i /* End of Do i ... */
00570000Return('')
00580000/**************************************************************/
00590000/*                                                            */
00600000/*  MODIFIED BY: IAPPINI,R.                                   */
00610000/*         When: 07/16/90                                     */
00620000/*  DESCRIPTION: ACCEPTS REXX DELIMITED STRINGS IN PARENTHESIS*/
00630000/*                                                            */
00640000/*                                                            */
00650000/**************************************************************/
00660000/**************************************************************/
00670000/*                                                            */
00680000/*  MODIFIED BY: IAPPINI,R.                                   */
00690000/*         When: 10/25/89                                     */
00700000/*  DESCRIPTION: Accepts the following syntax:                */
00710000/*               KEYWORDV(match against)                      */
00720000/*               KEYWORDV(match,against)                      */
00730000/*                                                            */
00740000/**************************************************************/
00750000/*                                                            */
00760000/*   CREATED BY: IAPPINI,R.                                   */
00770000/*         When: 07/06/89                                     */
00780000/*         WHAT: Returns a KEYWORD or KEYWORD Value           */
00790000/*               or a NULL string                             */
00800000/*                                                            */
00810000/**************************************************************/
./ ADD NAME=RI013                                  12SEP93 18.26 --
00001000/* Rexx  Rexx  Rexx  Rexx  Rexx  Rexx  Rexx  Rexx  Rexx  Rexx  R
00002000Address 'TSO'
00003000Parse Source environment . exec_name .
00030000Trace OFF
00040000Arg ddname
00050000If Words(ddname) > 1 Then Do
00060000   Call exec_name Subword(ddname,1,Words(ddname)-1)
00070000/* Return  */
00080000   End
00081000If Words(ddname) = 0 Then Do
00082000   Say 'Required option ddname missing.'
00083000   Exit
00084000   End
00085000xddn = Word(ddname,Words(ddname))
00085102trace ?i
00085200Select
00085300   When Wordpos(xddn,'LINKLIST LINKLST') > 0 Then Do
00085400      rdsns = Lldsns()
00085500      End
00085602   Otherwise Do
00085703      Call Listdd xddn rdsns
00085802      Interpret Result;
00085902      End
00086002   End /* End of Select ... */
00086100Select
00086201  When Words(rdsns) > 0 Then Do
00087000     Say 'The following DataSets are ALLOCATED to 'xddn':'
00088000     Say
00089000     Do i = 1 to Words(rdsns)
00090000      /*Say  Right(i,4,' ') Word(rdsns,i)*/
00100000        Say Right(' ',12,' ') Translate(Word(rdsns,i),' ',"'")
00110000        End
00120000     End  /* End of When 0    ... */
00130000  When (rc=4) Then Do
00140000     Say
00150001     Say '**** ddname('xddn') not PRE-ALLOCATED, Terminating 'ex
00160000     Return
00170000     End
00180000  Otherwise Do
00190000     Say
00200001     Say '**** Severe ERROR('rc') occurred, Terminating 'exec_na
00210000     Return
00220000     End   /* End of Otherwise ... */
00230000  End     /* End of Select    ... */
00240000Return
00250000/***************************************************************
00260000/* Modified by Phong H. Vu on May/29/90
00270000/* Changes: Take out sequencing numbers on listing of datasets
00280000/***************************************************************
./ ADD NAME=RI014                                  12SEP93 18.26 --
00110000/* REXX ** REXX ** REXX ** REXX ** REXX ** REXX ** REXX ** REXX
00120001lldsns:
00130000ADDRESS 'TSO'
00140000ARG p1
00150000DEBUG = KEYWORDV('DEBUG',p1)
00160000IF DEBUG ^= '' Then TRACE ?I
00170000@cvt  = Storage(D2X(16),4)             /* CVT pointer */
00180000@ll   = Storage(D2X(C2D(@cvt)+1244),4)  /* Link List pointer */
00190000@1stdd = D2X(C2D(@ll)+9)
00200000ll_dsns = ''
00210000Do count = 0 By 1 While Datatype(Storage(@1stdd),'M')
00220000   ll_dsns = ll_dsns Storage(@1stdd,44)
00230000   @1stdd  = D2X(X2D(@1stdd)+45)
00240000   end count
00260000rc = count
00270000Return (Space(ll_dsns))
./ ADD NAME=RI015                                  12SEP93 18.26 --
00001000/* Rexx  Rexx  Rexx  Rexx  Rexx  Rexx  Rexx  Rexx  Rexx  Rexx  R
00002000Address 'TSO'
00003000Arg p1
00030000@tcb = Storage(21c,4)                   /*get tcb address from P
00040000@TIOT = Storage(D2x(C2d(@TCB)+12),4)    /* add 12 to TIOT addres
00050000@1stdd = D2x(C2d(@tiot)+28)             /* point to 1st DD in TI
00060000@1stddlen = Storage(D2x(C2d(@tiot)+24),1) /* get 1st length */
00070000@tiot = D2x(C2d(@tiot)+24)              /* point to 1st TIOT DDN
00080000@jfcb = Storage(D2x(X2d(@tiot)+12),3)   /* get JFCB address from
00090000say ' DDNAME  VOLSER DATASET NAME'
00100000SAY '-------- ------ -------------------------------------------
00110000DO while C2d(@1stddlen) \=0  /* loop through entire TIOT */
00120000   If Storage(@1stdd,1)/='00'x then,
00130000      say Storage(@1stdd,8),               /* display ddname*/
00140000          Storage(D2x(C2d(@JFCB)+134),6),  /* display VOLSER */
00150000          Storage(D2x(C2d(@jfcb)+16),44)   /* display DSN */
00160000   @tiot = D2x(X2d(@tiot)+C2d(@1stddlen)) /*point to next TIOT e
00170000   @1stddlen = Storage(@tiot,1)         /*get length of TIOT ent
00180000   @1stdd = D2x(X2d(@tiot)+4)           /* point at DDname in TI
00190000   @jfcb = Storage(D2x(X2d(@tiot)+12),3) /* get next JFCB addres
00200000   end

         MACRO
&NAME    TERMINAL  &QBY=,&DCB=,&RLN=,&COMP=NO,&TERM=,&QUEUES=,         X
               &ADDR=,&LEVEL=(0),&CLOCK=,&ALIAS=,&ALTDEST=,&SECTERM=NO,X
               &BUFSIZE=,&BFDELAY=,&OPDATA=,                           X
               &QS=(DN,DR,TS,MO,MR,MN,34,18,2,66,82,98),&FEATURE=,     X
               &TBLKSZ=,&DIALNO=,&NTBLKSZ=,&CINTVL=,&UTERM=NO,         X
               &DVCID=,&QCNTRL=,&LMD=NO,&CTBMAX=,&MB=NO,               X
               &SCRSIZE=(12,40),&GROUP=,&RETRY=,&ACTIVE=,        Y06327X
               &SPECOUT=,&GPCLSTR=,&TCMSESN=,&USS=NONE,&FMPROF=,       *
               &TSPROF=,&BKUPNME=,&IPLTXID=,&IPLAUTO=NO,&DUMPDCB=,     *
               &DMPAUTO=NO,&BACKUP=NO,&BRINGUP=NO,&CKPTDCB=    @Y17XAFF
.*A000000-999999                                               @X31X8F0
.*C244680                                                      @OY16095
.*
         GBLA  &IEDQCH(128),&IEDQAR(64),&IEDQZF
         GBLA  &IEDQCH1(128),&IEDQRL                           @Y17XAFF
         GBLB  &IEDQFL(16),&IEDQZA(64),&IEDQNO,&IEDQIHB(2),&IEDQZZ(16)
         GBLB  &IEDQRN(8),&IEDQCOD(8)                          @Y17XAFF
         GBLB  &IEDQQEF(8) .                                     S22025
         GBLB  &IEDQMHF(64)                                    @OZ37662
         GBLB  &IEDQTAC                                        @OZ41718
         GBLC  &IEDQAD(5),&IEDQSV(8),&IEDQCTM                   SA57685
         GBLC  &IEDQSV1(50),&IEDQGN                            @Y17XAFF
         LCLA  &A,&S,&L,&P,&LP,&CTBCNT .                         S22025
         LCLB  &NO,&NB,&B(8),&CONC .                           @OZ41718
         LCLB  &GPT,&SPCO,&BFRD                                  S22024
         LCLB  &LUNT,&LINEMSG,&QBYMSG                          @ZM04782
         LCLC  &CHA,&IEDQID(2),&IEDQCTB(2) .                     S22025
         LCLC  &CHB,&CHC,&CHD                                    S22024
         LCLC  &SAVE                                           @OZ37662
.******************* MICROFICHE FLAGS *********************** SUPT CODE
.*C638400,646000,655000                                          S22027
.*A636000-637800                                                 S22027
.*A042000-044400,777500                                          S99528
.*C771700-773100                                                 S99528
.*A043600                                                        S99228
.*C027000,030000,044100,139890-140540,262500,264000,265500       S99228
.*C267000,270000,777000-777500                                   S99228
.*A039000,2888000-XXXXXX,669600-671400                           S22029
.*C023400,261000-266500,285000,312000,780000                     S22029
.*D041000,300000-306000,669600-671400                            S22029
.*A019000,022000,127000-128000,138020-139840,152000-155400       S22025
.*A184000,196000,199000,202000-203000,246000-259800,310000       S22025
.*A475200-476960,582500-583000,595000,621200-622600,658000       S22025
.*A706000,712000                                                 S22025
.*C021000,162000,201000                                          S22025
.*C030000-030800,138000,150000-151000,174000-175000              S22025
.*C189000-192600,300000-301000,339000-350200,576000-578200       S22025
.*C591000,627000,633000,645000-646000,654000-655000,669000       S22025
.*C738000,768000-770200                                          S22025
.*D033000-039000                                                 S22025
.*A474000                                                        A50220
.*A042000                                                        A47143
.*C738000                                                        A47143
.*C747000                                                        S21101
.*C108000-114000                                                 A42365
.*C474000                                                       SA56918
.*C381000,384000                                                SA50203
.*A594000                                                       SA50203
.*C738000                                                        A52954
.*C043200,044160-044260,384700,594400                           SA56318
.*C030200,030826-041500,771000     SEE IEDQCKO/IEDQGCH          SA57685
.*D022000,030850,042000,706000,712000,                          SA57685
.*C021000,030820,147000,159000,165000,171000,186000              S22024
.*C189000-192000,193200-194400,194640-194760,204000-207000       S22024
.*C282000,576000,579000,594000,642000,651000,657000-663000       S22024
.*C669000,594200                                                 S22024
.*A024000,027000,030200,030600,128000,396000,399000,637800       S22024
.*A696000,699000                                                 S22024
.*A103000,738000,738500,753000                                   Y05330
.*C006000-012000,030823,108000-126000,138100-138130,381000,      Y05330
.*C408000,429000,450000,474090,480000,483000,495000,585000,      Y05330
.*C765000-770200                                                 Y05330
.*D138140,354000,387000-393000,411000-423000,432000-444000,      Y05330
.*D453000-462000,474180,474360,474540-474810,486000-487000,      Y05330
.*D498000,555000-561000                                          Y05330
.*C171000,732600                                                 Y06327
.*A172000                                                        Y06327
.*A738300                                                        X01004
.*D738500                                                        X01004
.*A246000                                                      SA66363
.*C594000                                                       OX01432
.*D585000                                                       OX01432
.*A475200                                                       SA66922
.*C475200                                                       SA66922
.*A030700,147250,147650,696150                                   X03039
.*C030823,147400,148200,384700,594400,638020,696400,696650       X03039
.*C144000,148350,165000,216000,219000,289000,324000,369000     @Z30X8FG
.*C543000                                                      @Z30X8FG
.*A396000,475100                                                 X03039
.*C173100                                                      @XA06352
.*A107400,477000,480000,655000,669000                          @X50X9FH
.*C022000,655000,669000                                        @X50X9FH
.*D045000                                                      @X50X9FH
.*C696400                                                      @ZA03106
.*A657050                                                      @XA09782
.*C285000,290000                                               @SA75764
.*D173100-173130                                               @OY11968
.*A771000                                                      @Y17XAFF
.*D477200-479000                                               @Y17XAFF
.*C600000,159950,140440,655000-656000                          @Y17XAFF
.*C022000,027050,030250,024050,107400,147700,675000,670000     @Y17XAFF
.*C696000-700000,711000,147950,148000-148050,159100,159050     @Y17XAFF
.*C159200,172400,186600,202500,475200,594200,637900,357000     @Y17XAFF
.*C669000                                                      @SA05843
.*C594680                                                      @OY16376
.*A656600                                                      @OZ31432
.*A001816                                                      @OZ37276
.*C001824                                                      @OZ37276
.*A002768                                                      @OZ36902
.*A001138,001194,577000,697000                                 @OZ37662
.*C337000,656640-656800                                        @OZ37662
.*A001141,001864,474700,475320                                 @OZ41718
.*C001166,731000                                               @OZ41718
.*C656740                                                      @OZ43705
.*C109000-113000                                               @OZ46458
.*C718000                                                      @OZ44387
.*A002264                                                      @OZ48027
.*D474770-474910                                               @OZ49094
.*A730000                                                      @OZ49094
.*PACKAGE ERROR                                                @OZ49699
.*A475000                                                      @OZ52041
.*D730250-730750                                               @OZ52041
.*A001824                                                      @OX27983
.*D001832                                                      @OX27983
&A       SETA  N'&ALIAS+1                                        Y05330
         AIF   (NOT &IEDQZA(21)).GO                              S99228
         MNOTE 12,'*** IED901 ALL TERMINAL MACROS MUST PRECEDE TSINPUT'
.GO      AIF   ('&TERM' EQ 'LUNT').RESETSK                     @OZ37276
&IEDQAR(41)  SETA 0                     CLOCK                  @OZ37276
&IEDQAR(42)  SETA 0                     CINTVL                 @OZ37276
.RESETSK ANOP                                                  @OZ48100
         AIF   ('&TERM' EQ '').COK                             @OX27983
         AIF   ((&IEDQRN(4) AND NOT &IEDQRN(3)) OR (NOT &IEDQRN(4)     *
               AND NOT &IEDQRN(3))).AR        MIXSNA OR NOSNA? @OZ48100
         AIF   ('&TERM' EQ 'LINE' OR '&TERM' EQ 'LUNT' OR              *
               '&TERM' EQ 'PUNT' OR T'&GROUP NE 'O').AR        @OZ48100
         MNOTE 12,'PRE-SNA DEVICE CODED BUT INTRO HAS ONLYSNA CODED'
.*                                                             @OZ48100
.AR      ANOP                                                  @OZ48100
         AIF   ('&SECTERM' NE 'YES' OR '&TERM'(4,1) NE 'C').COK  S99228
         AIF   ('&TERM'(1,4) EQ '274C').COK                      S99228
         MNOTE 12,'*** IED902 TYPE=&TERM AND SECTERM=YES ARE MUTUALLY E*
               XCLUSIVE'                                        SA56318
.COK     ANOP  .                                                 S99228
&IEDQSV1(17) SETC '&TERM'                                      @OZ41718
.A1      AIF   (&IEDQAR(10) EQ 0).C0
         AIF   (&IEDQAR(10) EQ 3 AND '&NAME' EQ '&IEDQSV(1)').OPT
         IEDQGCH 3
.C0      AIF   (&IEDQZA(55)).C1
         AIF   ('&IEDQZA(54)' EQ '&IEDQZA(55)' AND '&IEDQZA(53)'       X
               EQ '&IEDQZA(55)').A3
         MNOTE 12,'***IHB315 SEQUENCE ERROR-MUST PRECEDE LAST ENTRY    X
               SPEC. BY TTABLE MACRO'
         AGO   .A4
.A3      MNOTE 12,'***  IHB070 SEQUENCE ERROR-MUST FOLLOW TTABLE MACRO'
.A4      ANOP
&IEDQNO  SETB  1
.C1      AIF   ('&NAME' NE '').C1A
         MNOTE 12,'*** IHB076 MACRO NAME FIELD BLANK- NAME REQUIRED'
&IEDQNO  SETB  1
.C1A     AIF   (K'&NAME LE &IEDQAR(1)-3).C1B
&S       SETA  &IEDQAR(1)-3
         MNOTE 4,'*** IHB302 NAME FIELD LONG- TRUNCATED TO &S CHARACTER*
               S'
.C1B     ANOP                                                    Y05330
&A       SETA  &A-1                                              Y05330
         AIF   (&A EQ 0).C1B1                                    Y05330
         AIF   (K'&ALIAS(&A) LE &IEDQAR(1)-3).C1B                Y05330
         AIF   (K'&ALIAS(&A) LE &IEDQAR(1)+&IEDQAR(1)-4 AND '&ALIAS(&A)X
               '(K'&ALIAS(&A)-1,1) EQ '''').C1B                  Y05330
 MNOTE 4,'*** IHB302 ALIAS &ALIAS(&A) LONG-TRUNCATED TO &S CHARACTERS'
         AGO   .C1B                                              Y05330
.C1B1    ANOP                                                  @Y17XAFF
.*       IF 270X ONLY, DO NOT ALLOW TERM=LINE,LNCP,PUNT, SSCP, OR LUNT
         AIF   (&IEDQRN(1)).A001                               @Y17XAFF
         AIF   ('&TERM' NE 'LINE' AND '&TERM' NE 'LNCP' AND            *
                '&TERM' NE 'PUNT' AND '&TERM' NE 'SSCP' AND            *
                '&TERM' NE 'LUNT').A001                        @PI02879
         MNOTE 12,'*** IED950  TERM=&TERM INVALID FOR DEFINED SYSTEM.'
.*                                                             @Y17XAFF
.A001    AIF   ('&TERM' EQ 'LNCP').A003                        @Y17XAFF
.*                                                             @Y17XAFF
.*       NCP ONLY OPERANDS SHOULD NOT BE CODED IF TERM NE LNCP @Y17XAFF
.*                                                             @Y17XAFF
         AIF   (T'&BKUPNME NE 'O' AND T'&IPLTXID NE 'O' AND            *
               T'&DUMPDCB NE 'O' AND T'&CKPTDCB NE 'O').A002   @Y17XAFF
         AIF   ('&IPLAUTO' EQ 'NO' AND '&DMPAUTO' EQ 'NO' AND          *
               '&BACKUP' EQ 'NO' AND '&BRINGUP' EQ 'NO').A003  @Y17XAFF
.A002    MNOTE 4,'*** IED952 UNNECESSARY OPERAND(S) CODED FOR TERM=&TER*
               M'                                              @YM08519
.*       ONLY LOOK AT NEW TERM EQ VALUES                       @Y17XAFF
.A003    AIF   ('&TERM' NE 'LNCP' AND '&TERM' NE 'SSCP' AND            *
                '&TERM' NE 'PUNT' AND '&TERM' NE 'LINE').A401  @Y17XAFF
.*                                                             @Y17XAFF
.*       INSURE THAT NO UNNECESSARY OPERANDS HAVE BEEN CODED   @Y17XAFF
.*                                                             @Y17XAFF
&IEDQFL(9) SETB 0               RESET CONCENTRATOR BIT OFF FOR @OZ48027
.*                              TERM= LNCP,SSCP,LINE,PUNT      @OZ48027
         AIF   (T'&QBY     EQ 'O' AND T'&ALTDEST EQ 'O' AND            *
                T'&QUEUES  EQ 'O' AND T'&ADDR    EQ 'O' AND            *
                T'&CLOCK   EQ 'O').A005                        @Y17XAFF
.A004    MNOTE 4,'*** IED952 UNNECESSARY OPERAND(S) CODED FOR TERM=&TER*
               M'                                              @YM08519
         AGO   .A006
.A005    AIF   (T'&BUFSIZE NE 'O' OR  T'&BFDELAY NE 'O' OR             *
                T'&FEATURE NE 'O' OR  T'&TBLKSZ  NE 'O' OR             *
                T'&DIALNO  NE 'O' OR  T'&NTBLKSZ NE 'O').A004  @Y17XAFF
         AIF   (T'&CINTVL  NE 'O' OR  T'&DVCID   NE 'O' OR             *
                T'&QCNTRL  NE 'O' OR  T'&CTBMAX  NE 'O' OR             *
                T'&RETRY   NE 'O' OR  T'&SPECOUT NE 'O').A004  @Y17XAFF
         AIF   (T'&GPCLSTR NE 'O' OR  T'&ACTIVE(2) NE 'O').A004
.*                                                             @Y17XAFF
         AIF   ('&COMP'    NE 'NO'  OR '&LEVEL'    NE '(0)' OR         *
                '&SECTERM' NE 'NO'  OR '&UTERM'    NE 'NO'  OR         *
                '&LMD'     NE 'NO'  OR '&MB'       NE 'NO').A004
.*                                                             @Y17XAFF
         AIF   ('&SCRSIZE' NE '(12,40)').A004                  @Y17XAFF
.*                                                             @Y17XAFF
.*       IF LNCP CHECK FOR MORE UNNECESSARY OPERANDS           @Y17XAFF
.*                                                             @Y17XAFF
.A006    AIF   ('&TERM' NE 'LNCP').A101                        @Y17XAFF
         AIF   (T'&GROUP   EQ 'O' AND T'&TCMSESN EQ 'O' AND            *
                T'&RLN     EQ 'O' AND '&USS'     EQ 'NONE').A007
.*                                                             @Y17XAFF
         MNOTE 4,'*** IED952 UNNECESSARY OPERAND(S) CODED FOR TERM=&TER*
               M'                                              @YM08519
.*                                                             @Y17XAFF
.*                                                             @Y17XAFF
.*       VALIDATE  LNCP OPERANDS                               @Y17XAFF
.*                                                             @Y17XAFF
.A007    AIF   (T'&DCB NE 'O').A008     IS DCB CODED           @Y17XAFF
         MNOTE 8,'*** IED953 DCB OPERAND MISSING.'             @Y17XAFF
&IEDQNO  SETB  1                        SET NO GO SWITCH       @Y17XAFF
.A008    ANOP                                                  @Y17XAFF
&IEDQSV1(1) SETC '&BKUPNME'             WORK WITH BKUPNME      @Y17XAFF
&IEDQSV1(2) SETC '&IPLTXID'             WORK WITH IPLTXID      @Y17XAFF
&IEDQSV1(3) SETC '&DUMPDCB'             WORK WITH DUMPDCB      @Y17XAFF
&IEDQSV1(4) SETC '&CKPTDCB'             WORK WITH CKPTDCB      @Y17XAFF
         AIF   ('&IPLAUTO' EQ 'YES').A013 WORK WITH IPLAUTO    @Y17XAFF
         AIF   ('&IPLAUTO' EQ 'NO').A014                       @Y17XAFF
         MNOTE 4,'*** IED954 INVALID IPLAUTO OPERAND, WILL USE DEFAULT'
.*                                                             @Y17XAFF
         AGO   .A014                                           @Y17XAFF
.A013    ANOP
&IEDQZA(56) SETB 1                      SET GLOBAL             @Y17XAFF
.A014    AIF   ('&DMPAUTO' EQ 'YES').A015 WORK WITH DMPAUTO    @Y17XAFF
         AIF   ('&DMPAUTO' EQ 'NO').A016                       @Y17XAFF
         MNOTE 4,'*** IED955 INVALID DMPAUTO OPERAND, WILL USE DEFAULT'
.*                                                             @Y17XAFF
         AGO   .A016                                           @Y17XAFF
.A015    ANOP                                                  @Y17XAFF
&IEDQZA(57) SETB 1                      SET GLOBAL             @Y17XAFF
.A016    AIF   ('&BACKUP' EQ 'YES').A017 WORK WITH BACKUP      @Y17XAFF
         AIF   ('&BACKUP' EQ 'NO').A018                        @Y17XAFF
         MNOTE 4,'*** IED956 INVALID BACKUP OPERAND, WILL USE DEFAULT'
.*                                                             @Y17XAFF
         AGO   .A018                                           @Y17XAFF
.A017    ANOP                                                  @Y17XAFF
&IEDQZA(59) SETB 1                                             @Y17XAFF
.A018    AIF   ('&BRINGUP' EQ 'YES').A019  WORK WITH BRINGUP   @Y17XAFF
         AIF   ('&BRINGUP' EQ 'NO').A020                       @Y17XAFF
         MNOTE 4,'*** IED957 INVALID BRINGUP OPERAND, WILL USE DEFAULT'
.*                                                             @Y17XAFF
         AGO   .A020                                           @OZ36902
.A019    ANOP                                                  @Y17XAFF
&IEDQZA(58) SETB 1                      SET GLOBAL             @Y17XAFF
.A020    AIF   (&IEDQNO).EXIT           IF SERIOUS ERROR, BRCH @Y17XAFF
.*       SET LNCP GLOBALS                                      @Y17XAFF
&IEDQFL(13) SETB 1                      DEV DEP FLAG           @Y17XAFF
&IEDQCOD(4) SETB 1                      NCP CODED              @Y17XAFF
&IEDQZA(63) SETB 1                      TTE PREFIX NEEDED      @Y17XAFF
.*       GO CREATE LNCP QCB                                    @Y17XAFF
         IEDQTQ &DCB,TERM=LNCP                                 @Y17XAFF
.*       GO CREATE LNCP DCT ENTRY                              @Y17XAFF
         IEDQCHI LNCP,FMPROF=&FMPROF,TSPROF=&TSPROF            @Y17XAFF
         AGO   .NOBFR                   GO GENERATE TNT & TTE  @Y17XAFF
.A101    AIF   ('&TERM' NE 'SSCP').A200                        @Y17XAFF
.*                                                             @Y17XAFF
.*       VALIDATE SSCP OPERANDS                                @Y17XAFF
.*
         AIF   (NOT &IEDQCOD(5)).A102                          @Y17XAFF
         MNOTE 12,'*** IED958 ONLY ONE SSCP TTE SHOULD BE CODED.'
.*                                                             @Y17XAFF
         MEXIT                                                 @Y17XAFF
.A102    AIF   (T'&GROUP   NE 'O' OR  T'&TCMSESN   NE 'O' OR           *
                T'&RLN     NE 'O' OR  T'&DCB       NE 'O' OR           *
                T'&ACTIVE  NE 'O').A103                        @Y17XAFF
         AIF   (T'&FMPROF  EQ 'O' AND T'&TSPROF    EQ 'O' AND          *
                '&USS'     EQ 'NONE').A104                     @Y17XAFF
.A103    MNOTE 4,'*** IED952 UNNECESSARY OPERAND(S) CODED FOR TERM=&TER*
               M'                                              @YMO8519
.A104    ANOP                                                  @Y17XAFF
&IEDQCOD(5) SETB 1                      SET SSCP CODED BIT     @Y17XAFF
&IEDQZA(63) SETB 1                      TTE PREFIX NEEDED      @Y17XAFF
         AIF   (&IEDQNO).EXIT                                  @ZM04784
         IEDQCHI SSCP                                          @PI05737
         AGO   .NOBFR                   GO GENERATE TNT AND TTE@Y17XAFF
.A200    AIF   ('&TERM' NE 'LINE').A301                        @Y17XAFF
.*                                                             @Y17XAFF
.*       VALIDATE TERM=LINE OPERANDS                           @Y17XAFF
.*                                                             @Y17XAFF
         AIF   (T'&FMPROF  EQ 'O' AND T'&TSPROF  EQ 'O' AND            *
                T'&TCMSESN EQ 'O' AND '&USS'     EQ 'NONE' AND         *
                T'&DCB     EQ 'O').A201                        @Y17XAFF
         MNOTE 4,'*** IED952 UNNECESSARY OPERAND(S) CODED FOR TERM=&TER*
               M'                                              @YM08519
.*                                                             @Y17XAFF
.A201    AIF   (T'&RLN NE 'O').A202                            @Y17XAFF
         MNOTE 12,'*** IHB001 NEED RLN OPERAND.'               @Y17XAFF
&IEDQNO  SETB  1                        SET NO GO SWITCH       @Y17XAFF
         AGO   .A206                                           @Y17XAFF
.A202    AIF   (&RLN GE 1 AND &RLN LE 255).A203  VALIDATE RLN  @Y17XAFF
.A204    MNOTE 12,'*** IED913 INVALID RLN OPERAND.'            @Y17XAFF
&IEDQNO  SETB  1                        SET NO GO SWITCH       @Y17XAFF
         AGO   .A205                                           @Y17XAFF
.A203    AIF   (&RLN NE &IEDQRL).A204   IS RLN CONTIGUOUS      @Y17XAFF
&IEDQRL  SETA  &IEDQRL+1                UPDATE COUNTER         @Y17XAFF
.A205    AIF   (T'&GROUP NE 'O').A206   VALIDATE GROUP OPERAND @Y17XAFF
         MNOTE 12,'*** IED961 NEED GROUP OPERAND.'
&IEDQNO  SETB  1                        SET NO GO SWITCH       @Y17XAFF
         AGO   .A207                                           @Y17XAFF
.A206    AIF   ('&GROUP' EQ '&IEDQGN').A207                    @Y17XAFF
         MNOTE 12,'*** IED912 SEQ ERR-MUST FOLLOW APPROPRIATE GROUP MAC*
               RO.'                                            @Y17XAFF
&IEDQNO  SETB  1                        SET NO GO SWITCH       @Y17XAFF
.A207    AIF   (&IEDQNO).EXIT           IF SERIOUS ERROR, BRCH @Y17XAFF
.*       GO CREATE QCB                                         @Y17XAFF
         IEDQTQ &GROUP,,,&RLN,TERM=LINE                        @Y17XAFF
.*       SET APPROPRIATE INDICATORS                            @Y17XAFF
&NB      SETB  1                        SET LINE IND BIT       @Y17XAFF
&IEDQCOD(2) SETB 1                      TERM=LINE CODED        @Y17XAFF
&IEDQZA(63) SETB 1                      TTE PREFIX NEEDED      @Y17XAFF
&IEDQCOD(3) SETB 0                      RESET PUNT CODED IND   @Y17XAFF
.*       GO CREATE DCT ENTRY,IF NECESSARY                      @Y17XAFF
         IEDQCHI LINE
         AGO   .NOBFR                                          @Y17XAFF
.A301    AIF   ('&TERM' NE 'PUNT').A401                        @Y17XAFF
.*                                                             @Y17XAFF
.*       VALIDATE TERM=PUNT OPERANDS                           @Y17XAFF
.*                                                             @Y17XAFF
         AIF   (T'&GROUP   EQ 'O' AND T'&TCMSESN EQ 'O' AND            *
                T'&RLN     EQ 'O' AND T'&DCB     EQ 'O' AND            *
                '&USS'     EQ 'NONE').A302                     @Y17XAFF
         MNOTE 4,'*** IED952 UNNECESSARY OPERAND(S) CODED FOR TERM=&TER*
               M'                                              @YM08519
.*                                                             @Y17XAFF
.A302    AIF   (&IEDQCOD(2)).A303                              @Y17XAFF
         MNOTE 12,'*** IED963 SEQ ERR-PUNT TTE MUST FOLLOW A LINE TERMI*
               NAL MACRO AND A GROUP MACRO.'                   @Y17XAFF
         AGO   .EXIT                    FINISH MACRO           @Y17XAFF
.A303    ANOP                                                  @Y17XAFF
.*       GO CREATE QCB                                         @Y17XAFF
         IEDQTQ TERM=PUNT                                      @Y17XAFF
.*       SET GLOBAL VARIABLES                                  @Y17XAFF
&IEDQZA(63) SETB 1                      TTE PREFIX NEEDED      @Y17XAFF
&IEDQCOD(3) SETB 1                      PUNT HAS BEEN CODED    @Y17XAFF
.*       GO CREATE DCT ENTRY                                   @Y17XAFF
         IEDQCHI PUNT,FMPROF=&FMPROF,TSPROF=&TSPROF
         AGO   .NOBFR                                          @Y17XAFF
.A401    AIF   ('&TERM' NE 'LUNT').A1000                       @Y17XAFF
.*                                                             @Y17XAFF
.*       VALIDATE TERM=LUNT OPERANDS                           @Y17XAFF
.*                                                             @Y17XAFF
         AIF   (T'&DCB     EQ 'O').A402                        @Y17XAFF
         MNOTE 4,'*** IED952 UNNECESSARY OPERAND(S) CODED FOR TERM=&TER*
               M'                                              @YM08519
.*                                                             @Y17XAFF
.A402    AIF   (&IEDQCOD(2) AND &IEDQCOD(3)).A403              @Y17XAFF
         MNOTE 12,'*** IED964 SEQ ERR-LUNT MUST FOLLOW A PUNT AND LINE *
               TERMINAL MACRO AND A GROUP MACRO.'              @Y17XAFF
&IEDQNO  SETB  1                        SET NO GO SWITCH       @Y17XAFF
.A403    AIF   (T'&TCMSESN EQ 'O').A1002                       @Y17XAFF
         AIF   ('&TCMSESN' EQ 'LUINIT' OR '&TCMSESN' EQ 'LUTERM' OR    *
                '&TCMSESN' EQ 'NORMAL').A1002                  @Y17XAFF
         MNOTE 4,'*** IED965 INVALID TCMSESN OPERAND, WILL USE DEFAULT'
.*                                                             @Y17XAFF
         AGO   .A1002                                          @Y17XAFF
.A1000   AIF   (T'&FMPROF EQ 'O'  AND T'&TSPROF EQ 'O' AND             *
                '&USS'    EQ 'NONE' AND T'&TCMSESN EQ 'O' AND          *
                T'&ACTIVE(2) EQ 'O').A1002 SNA ONLY OPERANDS   @Y17XAFF
         MNOTE 4,'*** IED952 UNNECESSARY OPERAND(S) CODED FOR TERM=&TER*
               M'                                              @YM08519
.*                                                             @Y17XAFF
.A1002   AIF   ('&UTERM' EQ 'NO').C1F                          @Y17XAFF
         AIF   ('&TERM' EQ 'LUNT').C1Z                         @X50X9FH
         AIF   ('&LEVEL' NE '(0)' OR '&CLOCK' NE '' OR '&COMP' NE 'NO' X
               ).C1Z                                           @OZ46458
         AIF   ('&DIALNO' EQ 'NONE' OR '&DIALNO' EQ '').CONT   @OZ46458
         AGO   .C1Z                                            @OZ46458
.CONT    ANOP                                                  @OZ46458
         AIF   ('&CINTVL' NE '' OR '&SECTERM' NE 'NO').C1Z     @OZ46458
         AIF   ('&NTBLKSZ' NE '' OR '&TBLKSZ' NE '' OR '&BFDELAY' NE   X
               '').C1Z                                           Y05330
         AIF   ('&QCNTRL' NE '' OR '&LMD' NE 'NO' OR '&DVCID' NE '' OR X
               '&CTBMAX' NE '' ).C1Z .                           S22025
         AIF   ('&GPCLSTR' NE '').C1Z                            S22024
         AIF   ('&COMP' EQ 'NO' OR '&GROUP' NE '').C2A           S22024
         AGO   .C1F
.C1Z     MNOTE 12,'***IHB342 INVALID OPERANDS SPECIFIED'
         AGO   .C5M
.C1F     AIF   ('&DVCID' EQ '').TERM .                           S22025
         AIF   (&IEDQZA(13)).CSPEC .                             S22025
         MNOTE 8,'*** IHB233 INCONSISTENT WITH FEATURE OPERAND OF THE IX
               NTRO MACRO' .                                     S22025
&IEDQNO  SETB  1 .                                               S22025
.CSPEC   AIF   ('&BFDELAY' EQ '' AND '&DIALNO' EQ '' AND '&CINTVL' EQ  X
               '' AND '&CLOCK' EQ '').CHKDID                     Y05330
&IEDQNO  SETB  1 .                                               S22025
         MNOTE 12,'*** IHB342 INVALID OPERANDS SPECIFIED' .      S22025
.CHKDID  AIF   ('&DVCID(1)' NE 'CONC').TAC .                     S22025
&IEDQID(1)  SETC  '&DVCID(1)' .                                  S22025
&IEDQAR(46) SETA 254 .                                           S22025
&IEDQFL(9) SETB 0 .                                              S22025
&CONC    SETB  1 .                                               S22025
&IEDQAR(47) SETA 1 .                                             S22025
&IEDQQEF(3) SETB 0 .                                             S22025
         AIF   ('&QUEUES' EQ '' AND '&LEVEL' EQ '(0)' AND '&ALTDEST'   X
               EQ '' AND '&SECTERM' EQ 'NO' ).NONERR .           S22025
         AGO   .ANERR .                                          S22025
.NONERR  AIF   ('&COMP' EQ 'NO' AND '&LMD' EQ 'NO' AND '&QCNTRL' EQ    X
               '' AND '&MB' EQ 'NO' ).CHKCONC .                  S22025
.ANERR   MNOTE 12,'*** IHB342 INVALID OPERANDS SPECIFIED' .      S22025
&IEDQNO  SETB  1 .                                               S22025
.CHKCONC AIF   ('&QBY' EQ 'T').QBYCHK                            S22025
&IEDQNO  SETB  1 .                                               S22025
         AIF   ('&QBY' NE '' ).QBYO .                            S22025
         MNOTE 12,'*** IHB001 QBY OPERAND REQ''D- NOT SPECIFIED' S22025
         AGO   .QBYCHK .                                         S22025
.QBYO    AIF   (&QBYMSG).QBYCHK                                @ZM04776
&QBYMSG  SETB  1                                               @ZM04776
         MNOTE 12,'*** IHB002 INVALID QBY OPERAND SPECIFIED- &QBY'
.*                                                               S22025
.QBYCHK  AIF   (N'&DVCID EQ 1 ).VID .                            S22025
         AIF   ( N'&DVCID EQ 2).SCC .                            S22025
&IEDQNO  SETB  1 .                                               S22025
.DVCERR  MNOTE 12,'*** IHB002 INVALID DVCID OPERAND SPECIFIED- &DVCID'
.*                                                               S22025
.SCC     AIF   ('&DVCID(2)' EQ '' ).VID .                        S22025
DVCID    IEDQCKO &DVCID(2),,31,R=(1,8) .                         S22025
.VID     ANOP .                                                  S22025
&IEDQAR(47) SETA &IEDQAR(47)+3 .                                 S22025
&CTBCNT  SETA  0 .                                               S22025
         AIF   ('&CTBMAX' EQ '').CONCSET .                       S22025
         AIF   ( T'&CTBMAX EQ 'N' AND '&CTBMAX' GE '1' AND '&CTBMAX'   X
               LE '255').CTBOK .                                 S22025
         MNOTE 12,'*** IHB002 INVALID CTBMAX OPERAND SPECIFIED- &CTBMAXX
               '                                                 S22025
&IEDQNO  SETB  1 .                                               S22025
         AGO   .CONCSET .                                        S22025
.CTBOK   ANOP .                                                  S22025
&CTBCNT  SETA  &CTBMAX .                                         S22025
.CONCSET AIF   (&IEDQNO).C2A .                                   S22025
&IEDQFL(9) SETB 1 .                                              S22025
         AGO   .C2A .                                            S22025
.TAC     AIF   ( &IEDQFL(9) ).CDEF .                             S22025
&IEDQAR(47) SETA 4 .                                             S22025
         MNOTE 12,'*** IHB070 SEQUENCE ERROR- MUST FOLLOW CONC TERMINALX
                MACRO' .                                         S22025
&IEDQNO  SETB  1 .                                               S22025
.CDEF    ANOP .                                                  S22025
&IEDQTAC   SETB 1 .                                              S22025
         AIF   ('&QBY' EQ '' AND '&CTBMAX' EQ '' ).ATTOK .       S22025
&IEDQNO  SETB  1 .                                               S22025
         MNOTE 12,'*** IHB342 INVALID OPERANDS SPECIFIED' .      S22025
.ATTOK   AIF   ('&DVCID(1)' NE 'FF' AND N'&DVCID EQ 1).IDFINE .  S22025
&IEDQNO  SETB  1 .                                               S22025
         MNOTE 12,'*** IHB002 INVALID DVCID OPERAND SPECIFIED- &DVCID'
.*                                                               S22025
.IDFINE  ANOP .                                                  S22025
&IEDQID(1) SETC 'FF' .                                           S22025
         AIF   ('&DVCID(1)' EQ 'NONE').TERM2 .                   S22025
&LP      SETA  K'&DVCID .                                        S22025
         AIF   ((K'&DVCID(1)/2)*2 EQ K'&DVCID(1)).IDC .          S22025
         MNOTE 4,'*** IHB154 DEVICE ID NOT MULT. OF 2, POSSIBLE ERROR'
.*                                                               S22025
.IDC     AIF   ((K'&DVCID(1)+1)/2 LE &IEDQAR(47)-3).IDOK .       S22025
&LP      SETA  &IEDQAR(47)-3 .                                   S22025
         MNOTE 4,'*** IHB302 DEVICE ID TOO LONG - TRUNCATED TO &LP CHARX
               '                                                 S22025
&LP      SETA  &LP*2 .                                           S22025
.IDOK    ANOP .                                                  S22025
&L       SETA  0 .                                               S22025
         AIF   ( &LP LE 8).FIRP .                                S22025
&L       SETA  &LP-8 .                                           S22025
&IEDQID(2) SETC '&DVCID'(9,&L) .                                 S22025
.FIRP    ANOP .                                                  S22025
&IEDQID(1) SETC '&DVCID'(1,&LP-&L) .                             S22025
         AGO   .TERM2 .                                          S22025
.TERM    AIF   ('&QCNTRL' EQ '' AND '&CTBMAX' EQ '').TERM3 .     S22025
         MNOTE 12,'*** IHB342 INVALID OPERANDS SPECIFIED' .      S22025
&IEDQNO  SETB  1 .                                               S22025
.TERM3   ANOP .                                                  S22025
&IEDQFL(9) SETB 0 .                                              S22025
.TERM2   ANOP                                                    S99228
         AIF   ('&TERM' EQ '').D1 .                              S99228
         AIF   ('&TERM'(1,4) EQ '367C' OR '&TERM'(1,4) EQ '274C').D1
         AIF   ('&ADDR' EQ '' OR ('&ADDR' NE '' AND '&TERM'(4,1) NE    X
               'C')).D1                                          S99228
&IEDQNO  SETB  1                                                 S99228
         MNOTE 12,'*** IHB346 ADDR AND TERM=&TERM MUTUALLY EXCLUSIVE'
.D1      AIF   (T'&GROUP EQ 'O' OR  '&TERM' NE '327L').D11     @Y17XAFF
         MNOTE 12,'*** IHB346 GROUP AND TERM=327L MUTUALLY EXCLUSIVE'
&IEDQNO  SETB  1                                               @Y17XAFF
.D11     ANOP                                                  @Y17XAFF
         AIF   ('&COMP' EQ 'NO').C2A                             S99228
         AIF   ( '&GROUP' NE '' ).C2A .                          S22024
         AIF   ('&UTERM' EQ 'NO' AND '&COMP' EQ 'YES').C2B
         MNOTE 12,'IHB002 INVALID COMP OPERAND SPECIFIED - &COMP'
.*                                                             @Z30X8FG
.C2A     AIF   ('&DCB' NE '' AND '&GROUP' NE '').CR2  ERROR      S22024
         AIF   ('&DCB' EQ '' AND '&GROUP' EQ '').CR1  ERROR      S22024
         AIF   ('&DCB' EQ '').CR4                                S22024
&CHB     SETC  '&DCB'                                            S22024
&IEDQCOD(2) SETB 0     RESET, DCB OPERAND SIGNALS END OF GROUP @PI06956
&CHC     SETC  'DCB'                                             S22024
&IEDQFL(12) SETB 0                                               S22024
         AIF   ('&TERM' NE 'LUNT').NOLUNT                        X03039
         MNOTE 4,'***  IED973  3705-ONLY OPERAND SPECIFIED ON NON-3705 *
               TERMINAL ENTRY'                                   X03039
&IEDQNO  SETB  1
         AGO   .CR5                                              X03039
.NOLUNT  ANOP                                                    X03039
         AIF   ('&ACTIVE' EQ '' AND '&SPECOUT' EQ '' AND               *
               '&GPCLSTR' EQ '').CR5                             S22024
         MNOTE 4,'***  IED973  3705-ONLY OPERAND SPECIFIED ON NON-3705 *
               TERMINAL ENTRY'                                   S22024
         AGO   .CR5                                              S22024
.CR4     ANOP                                                    S22024
&CHB     SETC  '&GROUP'                                          S22024
&CHC     SETC  'GROUP'                                           S22024
.CR4B    ANOP
         AIF   ('&SPECOUT' NE 'YES').SETVTAM                     X03039
         AIF   ('&TERM' NE '327L' AND '&TERM' NE 'LUNT').SETVTAM X03039
         MNOTE 12,'IHB346 SPECOUT=YES AND TERM=&TERM MUTUALLY EXCLUSIVE*
               '                                                 X03039
&IEDQNO  SETB  1                                                 X03039
.SETVTAM ANOP                                                    X03039
&IEDQZA(63) SETB 1                      TTE PREFIX NEEDED      @Y17XAFF
         AIF   ('&UTERM' NE 'NO' OR '&TERM' EQ 'LUNT').A1010   @Y17XAFF
&IEDQFL(12) SETB 1                      NEED MODE FIELD IF     @Y17XAFF
.A1010   ANOP                             3705 PRE-SNA TERMINAL@Y17XAFF
         AIF   (NOT &IEDQRN(1)).CR4A                             S22024
.CR5     ANOP                                                    S22024
         AIF   ('&UTERM' NE 'NO' AND '&UTERM' NE 'YES' AND '&UTERM'    *
               NE 'IDLE').CR6                                    S22024
         AIF   ('&UTERM' EQ 'IDLE' AND (NOT &IEDQZA(63))).CR6  @Y17XAFF
         AIF   (&IEDQZA(63) AND '&QBY' NE 'T' AND '&UTERM' EQ 'NO'     *
               ).CR6B                                          @Y17XAFF
         AGO   .CR7                                              S22024
.CR4A    MNOTE 12,'***  IED911  GROUP=&GROUP MUST FOLLOW INTRO MACRO WIX
               TH FEATURE=(,,,,MIXD3705/ONLY3705) OPERAND'       X03039
&IEDQNO  SETB  1                                                 S22024
         AGO   .CR7                                              S22024
.CR6     MNOTE 12,'IHB002 INVALID UTERM OPERAND SPECIFIED - &UTERM'
.*                                                             @Z30X8FG
         AGO   .CR6C                                             S22024
.CR6B    AIF   (&QBYMSG).CR7                                   @ZM04776
&QBYMSG  SETB  1                                               @ZM04776
         MNOTE 12,'***  IHB002  INVALID QBY OPERAND SPECIFIED- &QBY'
.CR6C    ANOP                                                    S22024
&IEDQNO  SETB  1                                                 S22024
.CR7     ANOP                                                    S22024
         AIF   ('&TERM' EQ '' AND '&GROUP' EQ '').CR1  ERROR     S22024
         AIF   ('&RLN' EQ '' AND (NOT &IEDQZA(63))).CR1        @Y17XAFF
         AIF   ('&RLN' EQ '' AND '&UTERM' EQ 'NO').CR1           S22024
         AGO   .C1C                                              S22024
.CR2     MNOTE 12,'***  IHB346  DCB AND GROUP MUTUALLY EXCLUSIVE'
         AGO   .C5M                                              S22024
.CR1     ANOP                                                    S22024
         AIF   (&IEDQTAC).C2B .                                  S22025
         AIF   ('&DCB' NE '').CHKRLN .                           S22025
&IEDQNO  SETB  1 .                                               S22025
         AIF   ('&TERM' EQ 'LUNT' AND '&GROUP' EQ '').NDCB     @OX16396
         MNOTE 12,'*** IHB001 DCB OPERAND REQ''D- NOT SPECIFIED'
         AGO   .CHKRLN                                         @OX16396
.NDCB    ANOP                                                  @OX16396
         MNOTE 12,'*** IHB001 GROUP OPERAND REQ''D- NOT SPECIFIED'
.*                                                             @OX16396
.CHKRLN  AIF   ('&RLN' NE '' ).C1C .                             S22025
         MNOTE 12,'*** IHB001 RLN OPERAND REQ''D- NOT SPECIFIED' S22025
&IEDQNO  SETB  1 .                                               S22025
         AGO   .C2B .                                            S22025
.C1C     ANOP
         AIF   ('&UTERM' EQ 'NO').GA1                            S22024
         AIF   (&IEDQZA(63) AND NOT &IEDQCOD(1)).GA5           @Y17XAFF
         AIF   (NOT &IEDQZA(63)).GA6                           @Y17XAFF
         AIF   ('&GROUP' NE '&IEDQGN').GA5                       S22024
.GA9     AIF   (NOT &IEDQZA(63)).GA6                           @Y17XAFF
         AIF   ('&RLN' EQ '').GA2                                S22024
         AIF   (&RLN NE &IEDQRL).GA7                             S22024
.GA2     ANOP                                                    S22024
&CHD     SETC  '&IEDQRL'                                         S22024
&IEDQRL  SETA  &IEDQRL+1                                         S22024
         AGO   .GA3                                              S22024
.GA5     MNOTE 12,'***  IED912  SEQUENCE ERROR-MUST FOLLOW APPROPRIATE *
               GROUP MACRO'                                      S22024
&IEDQNO  SETB  1                                                 S22024
         AGO   .GA9                                              S22024
.GA7     MNOTE 12,'***  IED913  RLN OPERAND INCORRECTLY SPECIFIED'
&IEDQNO  SETB  1                                                 S22024
         AGO   .GA6                                              S22024
.GA1     ANOP                                                    S22024
         AIF   ('&TERM' EQ 'LUNT').GA6                         @YM08518
&IEDQCOD(1) SETB 0                                             @Y17XAFF
.GA6     ANOP                                                    S22024
&A       SETA  &RLN                                              S22024
&CHD     SETC  '&A'                                              S22024
.GA3     ANOP                                                    S22024
&A       SETA  &CHD                                              S22024
         AIF   (&A LE 255).C2B .                                 S22025
         MNOTE 12,'IHB002 INVALID RLN OPERAND SPECIFIED - &CHD'
.*                                                             @Z30X8FG
&IEDQNO  SETB  1
.C2B     AIF   ('&TERM' NE '').C2 .                              Y06327
         AIF   ('&UTERM' EQ 'YES' OR '&UTERM' EQ 'IDLE'                X
               AND (&IEDQZA(63))).C2 .                         @Y17XAFF
         MNOTE 12,'*** IHB001 TERM OPERAND REQ''D- NOT SPECIFIED'
.*                                                               S22025
&IEDQNO  SETB  1 .                                               S22025
         AGO   .C5M
.C2      ANOP
&A       SETA  0
         AIF   (&IEDQTAC).TERM5 .                                S22025
         AIF   ('&COMP' EQ 'NO' ).C3A .
         AIF   (NOT &IEDQZA(63)).TERM5 .                       @Y17XAFF
         MNOTE 12,'*** IHB002 INVALID COMP OPERAND SPECIFIED- &COMP'
.*                                                               S22024
&IEDQNO  SETB  1 .                                               S22024
.TERM5   AIF   ('&CHB' EQ '' AND '&CHD' EQ '').BOPS              S22024
         AIF   ('&CHB' EQ '&IEDQSV(6)').BOPSA                    S22024
&IEDQNO  SETB  1 .                                               S22025
         MNOTE 12,'*** IHB002 INVALID DCB OPERAND SPECIFIED- &CHB'
.*                                                               S22024
.BOPSA   AIF   ('&CHD' EQ '&IEDQSV(8)').BOPS                     S22024
&IEDQNO  SETB  1 .                                               S22025
         MNOTE 12,'*** IHB002 INVALID RLN OPERAND SPECIFIED- &CHD'
.*                                                               S22024
         AIF   (&IEDQTAC).C3A .                                  S22025
         MNOTE 12,'*** IHB002 DCB AND RLN OPERANDS INCORRECTLY SPEC'
         AGO   .C5M
.BOPS    AIF   ( NOT &IEDQTAC).C6 .                              S22025
.C3A     AIF   (&CONC).C4B .                                     S22025
         AIF   ('&QUEUES' NE '').C4 .                            S22025
&A       SETA  2                                               @YM07798
         AIF   ('&TERM' EQ '327C').C4B                         @YM07798
         AIF   (&IEDQZA(63) AND '&UTERM' NE 'NO').QCB          @Y17XAFF
         AIF   ( &IEDQTAC).TAC11 .                               S22025
         AIF   ('&QBY' EQ 'L' AND '&CHB' EQ '&IEDQSV(6)' AND           *
               '&CHD' EQ '&IEDQSV(8)').C4B                       S22024
         MNOTE 12,'***  IHB001 QUEUES OPERAND REQ''D NOT SPECIFIED'
         AGO   .C5M
.INX     MNOTE 12,'IHB002 INVALID MSUNITS OPERAND SPECIFIED - 0'
.*                                                             @Z30X8FG
.IN      MNOTE 12,'IHB002 INVALID QUEUES OPERAND SPECIFIED - &QUEUES'
.*                                                             @Z30X8FG
.C5M     ANOP
&IEDQNO  SETB  1
         AIF   ('&UTERM' EQ 'NO').C5
         AGO   .EXIT
.C4      AIF   (&A GT 5 OR K'&QUEUES GT 3 OR K'&QUEUES LT 2).IN  S22029
         AIF   (&A GT 2 AND NOT &IEDQZA(42)).INX
&A       SETA  &A+1
         AIF   ('&QUEUES'(1,2) NE '&QS(&A)').C4
&A       SETA  &QS(&A+6)
         AIF   ('&QUEUES'(1,2) EQ 'TS' AND '&SECTERM' EQ 'YES').C4A
.*                                                             SA66363
         AIF   ('&TERM' NE '327C').C4Z                         @YM07658
&A       SETA  2                                               @YM07658
         MNOTE 4,'*** IHB314 QUEUES=&QUEUES INVALID WITH TERM=&TERM. IG*
               NORED'                                          @YM07658
         AGO   .C4B                                            @YM07658
.C4A     MNOTE 12,'*** IHB346 QUEUES=TS AND SECTERM=YES MUTUALLY EXCLUS*
               IVE'
.*                                                             SA66363
.C4Z     ANOP                                                   SA66363
         AIF   ( NOT &IEDQTAC ).QEND .                           S22025
         AIF   ('&QCNTRL' NE '').QC1 .                           S22025
         MNOTE 12,'*** IHB001 QCNTRL OPERAND REQ''D- NOT SPECIFIED'
.*                                                               S22025
&IEDQNO  SETB  1 .                                               S22025
         AGO   .QEND .                                           S22025
.TAC11   AIF   ('&QCNTRL' EQ '' ).C6 .                           S22025
&IEDQNO  SETB 1 .                                                S22025
         MNOTE 12,'*** IHB001 QUEUES OPERAND REQ''D NOT SPECIFIED'
.*                                                               S22025
         AIF   ('&DCB' NE '' AND '&RLN' NE '' ).QC1 .            S22025
         MNOTE 12,'*** IHB004 REQUIRED OPERAND(S) NOT SPECIFIED' S22025
&IEDQNO  SETB  1 .                                               S22025
         AGO   .C4B .                                            S22025
.QC1     ANOP .                                                  S22025
&IEDQQEF(1) SETB 0 .                                             S22025
&IEDQQEF(2) SETB 0 .                                             S22025
&IEDQQEF(3) SETB 0 .                                             S22025
&IEDQAR(48) SETA 1 .                                             S22025
&IEDQCTB(1)  SETC  'FF' .                                        S22025
&L       SETA  1 .                                               S22025
         AIF ( '&QCNTRL(1)' EQ '').Q4 .                          S22025
         AIF   ( T'&QCNTRL(1) NE 'N').Q2 .                       S22025
&IEDQQEF(2) SETB 1 .                                             S22025
QCNTRL   IEDQCKO &QCNTRL(1),,32,R=(1,32767) .                    S22025
         AGO   .Q4 .                                             S22025
.Q2      ANOP .                                                  S22025
&LP      SETA  K'&QCNTRL(1) .                                    S22025
         AIF   ( &LP NE 3).Q3 .                                  S22025
&CHA     SETC  '&QCNTRL(1)' .                                    S22025
         AIF   ( '&CHA' EQ 'MSG').Q4 .                           S22025
         AIF   ('&CHA' NE 'ALL').Q7 .                            S22025
&IEDQAR(48) SETA 0 .                                             S22025
         AGO  .Q4 .                                              S22025
.Q7      MNOTE 12,'*** IHB002 INVALID QCNTRL OPERAND SPECIFIED- &QCNTRLX
               (&L)' .                                           S22025
&IEDQNO  SETB  1 .                                               S22025
         AGO   .QEND .                                           S22025
.Q3      AIF   ('&QCNTRL(1)'(1,1) NE '(' OR '&QCNTRL(1)'(&LP,1) NE     X
               ')' ).Q7 .                                        S22025
         AIF   ( '&QCNTRL(1)'(2,3) NE 'MSG' ).Q7 .               S22025
         AIF   ( &LP    EQ 5).Q4 .                               S22025
         AIF   ( '&QCNTRL(1)'(5,1) NE ',' ).Q7 .                 S22025
         AIF   ( &LP    EQ 6).Q4 .                               S22025
&CHA     SETC  '&QCNTRL(1)'(6,&LP-6) .                           S22025
QCNTRL   IEDQCKO &CHA,,32,R=(1,255) .                            S22025
.Q4      AIF   ( N'&QCNTRL EQ &L).QEND .                         S22025
&L       SETA  &L+1 .                                            S22025
         AIF   ( '&QCNTRL(&L)' EQ '' ).QL1 .                     S22025
         AIF   ( '&QCNTRL(&L)' NE 'L' ).Q7 .                     S22025
         AIF   ( &IEDQAR(48) NE 1 ).Q7 .                         S22025
&IEDQQEF(3) SETB 1 .                                             S22025
.QL1     AIF   ( N'&QCNTRL EQ &L ).QEND .                        S22025
&L       SETA  &L+1 .                                            S22025
         AIF   ( '&QCNTRL(&L)' EQ '').Q5 .                       S22025
         AIF   ( '&QCNTRL(&L)'  NE 'STATUS').Q7 .                S22025
         AIF   ( &IEDQQEF(2)  EQ 0 AND &IEDQAR(48) NE 1).Q7 .    S22025
&IEDQQEF(1)  SETB 1 .                                            S22025
.Q5      AIF   ( N'&QCNTRL EQ &L).QEND .                         S22025
&L       SETA  &L+1 .                                            S22025
         AIF   ( '&QCNTRL(&L)' EQ '').QEND .                     S22025
         AIF   ( K'&QCNTRL(&L)/2  GT 8).Q7 .                     S22025
         AIF   ((K'&QCNTRL(&L)/2)*2 EQ K'&QCNTRL(&L)).Q8 .       S22025
         MNOTE 4,'*** IHB154 CTB CHAR. NOT A MULT. OF 2, POSSIBLE ERRORX
               ' .                                               S22025
.Q8      ANOP .                                                  S22025
&LP      SETA  0 .                                               S22025
         AIF   (K'&QCNTRL(&L) LT 8).CTB1 .                       S22025
&IEDQCTB(2) SETC '&QCNTRL(&L)'(9,K'&QCNTRL(&L)-8) .              S22025
&LP      SETA  K'&QCNTRL(&L)-8 .                                 S22025
.CTB1    ANOP .                                                  S22025
&IEDQCTB(1) SETC '&QCNTRL(&L)'(1,K'&QCNTRL(&L)-&LP) .            S22025
.QEND    ANOP .                                                  S22025
         AIF   (K'&QUEUES EQ 2).TSO0010                          S22029
         AIF   ('&QUEUES'(3,1) NE 'T').IN                        S22029
         AIF   ('&QUEUES'(1,2) EQ 'TS').IN                       S22029
&IEDQZZ(8) SETB 1                                                S99228
         AGO   .TSO0020                                          S22029
.TSO0010 ANOP                                                    S22029
&IEDQZZ(8) SETB ('&QUEUES' EQ 'TS')                              S99228
.TSO0020 ANOP                                                    S22029
&IEDQZA(17) SETB ('&QUEUES'(1,2) NE 'TS')                        S22029
         AIF   (NOT &IEDQZZ(8)).TSO0030                          S99228
&A       SETA  &A+128                                            S22029
.TSO0030 ANOP                                                    S22029
         AIF   (&IEDQZZ(8) AND &IEDQZA(51)).C4B                  S99228
         AIF   ((NOT &IEDQZZ(8)) AND &IEDQZA(52)).C4B            S99228
         MNOTE 12,'***  IHB110  QUEUES=&QUEUES MUST FOLLOW INTRO MACRO -
               WITH APPROPRIATE ENVIRON OPERAND'                    TSO
&IEDQNO  SETB  1
.C4B     AIF   ('&UTERM' EQ 'YES' OR '&UTERM' EQ 'IDLE').QCB     S22024
         AIF   (&IEDQZZ(8) AND '&QBY' EQ 'L').C5A              @SA75764
.C5      AIF   (&IEDQFL(9) OR &CONC OR &IEDQTAC ).C5B .          S22029
         AIF   ( '&QBY' EQ 'T' OR '&QBY' EQ 'L').C5B .           S22029
.C5A     AIF   (&QBYMSG).C5B                                   @ZM04776
&QBYMSG  SETB  1                                               @ZM04776
         MNOTE 12,'IHB002 INVALID QBY OPERAND SPECIFIED - &QBY'
.*                                                             @Z30X8FG
&NO      SETB  1                                                 S22029
.C5B     AIF   ('&QUEUES' EQ 'TS' AND '&LEVEL' NE '(0)').C4D   @SA75764
         AGO   .C6                                               S22029
.C4D     MNOTE 8,'*** IHB314 LEVEL=&LEVEL INVALID WITH QUEUES=TS. IGN  X
               ORED'                                                TSO
         AGO   .C8                                                  TSO
.C6      ANOP
&L       SETA  0 .                                               S22025
.C7      ANOP                                                    S22029
         AIF   (&L+1 GT N'&LEVEL-1).C8
&L       SETA  &L+1
         AIF   ('&LEVEL(&L+1)' GT '&LEVEL(&L)').C7
         MNOTE 12,'IHB002 INVALID LEVEL OPERAND SPECIFIED - &LEVEL(&L)'
.*                                                             @Z30X8FG
&NO      SETB  1
         AGO   .C7
.NAL     DC    AL2(0) .                 NO ALTERNATE DESTINATION
         AGO   .ST
.CKT     AIF   ('&QBY' EQ 'T').QBYT                            @OZ37662
         AIF   (NOT &IEDQMHF(10) AND '&TERM'(4,1) NE 'C').GO1  @OZ37662
         AIF   ('&QBY' NE 'T' AND NOT &IEDQFL(9) AND ('&TERM'(4,1)     *
               NE 'C')).NQ                                     @OZ37662
&SAVE    SETC  '&IEDQSV(2)'                                    @OZ37662
         AIF   ('&IEDQSV1(19)' EQ ' ' AND '&TERM'(4,1) EQ 'C').QCB
&IEDQSV(2) SETC '&IEDQSV1(19)'                                 @OZ37662
         AIF   ('&IEDQSV1(19)' NE ' ' AND '&TERM'(4,1) EQ 'C').NQ
&IEDQSV(2) SETC '&SAVE'                                        @OZ37662
.QBYT    ANOP                                                  @OZ37662
         AIF   ( &IEDQFL(9) AND NOT &IEDQTAC).QCB .              S22025
         AIF   ( NOT &IEDQTAC ).SCB1 .                           S22025
         AIF   ('&COMP' EQ 'NO').SCB2 .                          S22025
&NO      SETB  1 .                                               S22025
         AGO   .SCB1 .                                           S22025
.SCB2    AIF   ('&QCNTRL' EQ '').SCB1 .                          S22025
&L       SETA  1 .                                               S22025
.SCB1    AIF   ( NOT &IEDQFL(7) AND NOT &IEDQFL(10)).QCB .       S22025
&L       SETA  &L+1 .                                            S22025
         AIF   ('&QCNTRL' NE '' OR NOT &IEDQTAC).QCB .           S22025
&NO      SETB  1 .                                               S22025
         AGO   .QCB .                                            S22025
.C8      ANOP
         IEDQCHI &TERM,&FEATURE,FMPROF=&FMPROF,TSPROF=&TSPROF,         *
               USS=&USS                                        @Y17XAFF
.C9      AIF   ('&SECTERM' EQ 'NO').C10
&B(8)    SETB  1
         AIF   ('&SECTERM' EQ 'YES').C10
         MNOTE 12,'IHB002 INVALID SECTERM OPERAND SPECIFIED - &SECTERM'
.*                                                             @Z30X8FG
&NO      SETB  1
.C10     ANOP
BUFSIZE  IEDQCKO  &BUFSIZE,,1,R=(36,65535)
         AIF   ('&DIALNO' EQ '').MAC3                            Y05330
         AIF   (&IEDQZA(60) EQ 0).MAC2                          SA50203
         MNOTE 12,'*** IED903 FEATURE=NODIAL SPECIFIED ON INTRO' X03039
.*                                                              SA50203
         AGO   .MAC3                                            SA50203
.MAC2    ANOP
         AIF   ('&TERM' NE 'LUNT' OR '&DIALNO' EQ '').MAC2B      X03039
         MNOTE 12,'*** IHB346 TERM=LUNT AND DIALNO MUTUALLY EXCLUSIVE'
.*                                                               X03039
&IEDQNO  SETB  1                                                 X03039
         AGO   .MAC3                                             X03039
.MAC2B   ANOP                                                    X03039
         AIF   ('&DIALNO' EQ 'REMOTE').MAC2A                     S22024
DIALNO   IEDQCKO &DIALNO,NONE,2
         AGO   .MAC3                                             S22024
.MAC2A   ANOP                                                    S22024
DIALNO   IEDQCKO F,,2                                            S22024
.MAC3    ANOP
ADDR     IEDQCKO  &ADDR,,3,C=1
         AIF   ('&NTBLKSZ(1)' EQ '').TEST6                       Y05330
NTBLOCK  IEDQCKO &NTBLKSZ(1),,4,R=(1,65535)
.TEST6   AIF   ('&NTBLKSZ(2)' EQ '').TEST7                       Y05330
NTSUBLK  IEDQCKO &NTBLKSZ(2),,5,R=(1,255)
.TEST7   AIF   ('&TBLKSZ' EQ '').MAC11                           Y05330
.MAC10   ANOP
TBLKSZ   IEDQCKO &TBLKSZ,,6,R=(1,65535)
.MAC11   ANOP
BFDELAY  IEDQCKO &BFDELAY,,7,R=(0,65535)                        SA56918
         AIF   ('&BFDELAY' EQ '' OR '&DIALNO' EQ '').CHKDONE     Y05330
&IEDQNO  SETB  1 .                                               A50220
         MNOTE 12,'*** IHB346 DIALNO AND BFDELAY MUTUALLY EXCLUSIVE'
.CHKDONE ANOP .                                                  A50220
SCRSIZE  IEDQCKO &SCRSIZE,,8,R=(1,255)                              TSO
&IEDQSV1(21) SETC '&SCRSIZE(1)'                                @OZ52041
&IEDQSV1(22) SETC '&SCRSIZE(2)'                                @OZ52041
&IEDQMHF(5) SETB 1                                             @OZ52041
LMD      IEDQCKO  &LMD,NO,10 .                                   S22025
         AIF   ( '&MB' EQ 'NO' ).SKPMB .                         S22025
         AIF   ('&TERM' NE 'LUNT').MAC4                          X03039
         MNOTE 12,'*** IHB346 TERM=LUNT AND MB MUTUALLY EXCLUSIVE'
.*                                                               X03039
&IEDQNO  SETB  1                                                 X03039
         AGO   .SKPMB                                            X03039
.MAC4    ANOP                                                    X03039
MB       IEDQCKO &MB,NO,10 .                                     S22025
.SKPMB   AIF   (&IEDQTAC OR &IEDQZA(63)).LMDOK                 @Y17XAFF
&IEDQFL(10) SETB  0                                             SA66922
.LMDOK   ANOP                                                   SA66922
RETRY    IEDQCKO &RETRY,,11,R=(1,255)                            S22025
         AIF   ('&RETRY' EQ '').NORET                          @OZ41718
&IEDQAR(27) SETA &RETRY                                        @OZ41718
.NORET   ANOP                                                  @OZ41718
         AIF   ('&RETRY' NE '' AND '&CINTVL' EQ '' AND '&CLOCK' EQ '').X
               RETERR                                            S22025
         AGO   .NORTERR                                          S22025
.RETERR  ANOP                                                    S22025
         MNOTE 12,'*** IHB232 CLOCK= OR CINTVL= REQD WHEN RETRY SPECIFIX
               ED'                                               S22025
&IEDQNO  SETB  1                                                 S22025
.NORTERR ANOP                                                    S22025
         AIF   ('&LMD' EQ 'NO' AND '&MB' EQ 'NO').NOLMD          S22025
&IEDQFL(7)  SETB 1                                               S22025
.NOLMD   ANOP                                                    S22025
&L       SETA  0
         AIF   ('&CLOCK' EQ '' AND '&CINTVL' EQ '').QOK          Y05330
         AIF   ('&TCMSESN' NE 'LUINIT').NOTLUIN                @X50X9FH
         MNOTE 12,'***IHB346  TCMSESN=LUINIT  AND CLOCK  OR  CINTVL  MU*
               TUALLY EXCLUSIVE'                               @X50X9FH
.NOTLUIN ANOP                                                  @X50X9FH
         AIF   ('&TERM' EQ 'LUNT').NOCLL                       @X50X9FH
         AIF   ('&DIALNO' NE '' AND '&DIALNO' NE 'NONE').NOCLL   Y05330
         MNOTE 12,'*** IHB345 DIALNO= REQD WHEN CINTVL OR CLOCK SPECIFI*
               ED'
         AGO   .EXIT
.NOCLL   AIF   ('&CLOCK' EQ '' OR '&CINTVL' EQ '').CLOC          Y05330
         MNOTE 12,'*** IHB346 CLOCK AND CINTVL MUTUALLY EXCLUSIVE'
         AGO   .EXIT
.CLOC    AIF   ('&CLOCK' EQ '').INOK
         AIF   ('&CLOCK' LT '1' OR '&CLOCK' GT '2359').CLER
&B(6)    SETB  1
&P       SETA  0
&CHA     SETC  '&CLOCK'
         AIF   (K'&CLOCK LE 2).NOH
&CHA     SETC  '&CLOCK'(1,K'&CLOCK-2)
&P       SETA  &CHA*3600
&CHA     SETC  '&CLOCK'(K'&CLOCK-1,2)
.NOH     ANOP
&P       SETA  (&P+(&CHA*60))/2
         AGO   .QOK
.CLER    MNOTE 12,'IHB002 INVALID CLOCK OPERAND SPECIFIED - &CLOCK'
.*                                                             @Z30X8FG
         AGO   .EXIT
.INOK    ANOP
&P       SETA  0
.QOL     AIF   ('&CINTVL' EQ '').QOK
&P       SETA  &CINTVL
.QOK     AIF   (&NO OR &IEDQNO).EXIT
&IEDQZA(54) SETB 1
         AIF   ('&COMP' EQ 'YES' AND NOT &IEDQTAC ).NQ
         AIF   (&IEDQTAC AND '&QCNTRL' EQ '' AND '&LMD' EQ 'NO' AND    X
               '&MB' EQ 'NO' ).NQ .                              S22025
         AIF   (&IEDQTAC AND '&CHB' EQ '' AND '&CHD' EQ '').CKT  S22024
         AIF   ('&IEDQSV(6)' EQ '&CHB' AND '&IEDQSV(8)' EQ '&CHD').CKT
&IEDQSV1(19)  SETC   ' '                                       @OZ37662
&IEDQMHF(10)  SETB   0                  NO QCB FOR NON CLUSTER @OZ37662
.GO1     AIF    ('&TERM'(4,1) EQ 'C').GO2                      @OZ37662
&IEDQMHF(10)  SETB  1              QCB CREATED FOR NON CLUSTER @OZ37662
.GO2     ANOP                                                  @OZ37662
.*                                                               S22024
&IEDQAR(13) SETA 0
         AIF   (&IEDQTAC ).CKT .                                 S22025
         AIF   (&IEDQFL(9)).CMSCB .                              S22025
.CMSCB   ANOP
&L       SETA  &L+1 .                                            S22025
.QCB     AIF   ('&DIALNO' EQ '').QCB0                           OX01432
&L       SETA  0                                                OX01432
.QCB0    AIF   ('&UTERM' EQ 'NO').CF                            OX01432
&L       SETA  0                                                 S22024
.ZZ1     AIF   ('&UTERM' EQ 'NO').CF                             S22024
         AIF   (NOT &IEDQZA(60) OR &IEDQZA(63)).QCB1           @Y17XAFF
         MNOTE 12,'*** IED903 FEATURE=NODIAL SPECIFIED ON INTRO' X03039
.*                                                              SA50203
.QCB1    ANOP
         AIF   (NOT &IEDQCOD(2)).QCB11                         @PI02860
         AIF   (&LINEMSG).QCB12                                @ZM04782
&LINEMSG SETB  1                                               @ZM04782
         MNOTE 4,'IED999 ALL LINES WITHIN GROUP SHOULD BE DEFINED AS   *
               TERM=LINE, MACRO WILL DEFINE A TERMINAL'        @PI02860
         AGO   .QCB12                                          @PI02860
.QCB11   ANOP                                                  @PI02860
&NB      SETB  1 .                                               S22025
.QCB12   ANOP                                                  @PI02860
&IEDQZA(12) SETB 1                                                  TSO
         IEDQCHI &TERM,&FEATURE,FMPROF=&FMPROF,TSPROF=&TSPROF,         *
               USS=&USS                                        @Y17XAFF
&IEDQZA(12) SETB 0                                                  TSO
BUFSIZE  IEDQCKO &BUFSIZE,,1,R=(36,65535)                           TSO
ADDR    IEDQCKO  &ADDR,,3,C=1
         AIF   (&IEDQNO).EXIT
&IEDQZA(54) SETB 1
         AIF   (NOT &IEDQCOD(2)).NOTX1                         @PI02860
         AIF   (&LINEMSG).CF                                   @ZM04782
&LINEMSG SETB  1                                               @AM04782
         MNOTE 4,'IED999 ALL LINES WITHIN A GROUP SHOULD BE DEFINED AS *
               TERM=LINE, MACRO WILL DEFINE A TERMINAL.'       @PI02860
         AGO   .CF                                             @PI02860
.NOTX1   ANOP                                                  @PI02860
&NB      SETB  1
.CF      ANOP
         AIF   ( NOT &IEDQFL(9) ).NOTX .                         S22025
         AIF   ( &IEDQTAC ).GQUE .                               S22025
&A       SETA  4 .                                               S22025
.GQUE    ANOP .                                                  S22025
&CHA       SETC '20' .                                           S22025
&IEDQNO  SETB  (&B(6)) .                                         S22025
         AGO   .GQB .                                            S22025
.NOTX    ANOP .                                                  S22025
&IEDQNO  SETB  (&B(6))
&CHA       SETC  '0E' .                                          S22025
         AIF   (T'&BFDELAY EQ 'O').GQB                           S22025
         AIF   (NOT &IEDQFL(7)).GQB
&CHA       SETC  '1A' .                                          S22025
.GQB     ANOP                                                    S22027
         AIF   ('&TERM' NE '367C').SETFLG                        S22027
&A       SETA  0 .                                               S22027
.SETFLG  ANOP                                                    S22027
         AIF   (NOT &IEDQZA(63)).GQC                           @Y17XAFF
&CHA     SETC  '22'                                              S22024
.*       AIF   ('&TERM' EQ '327C').EXIT                        @PI04616
         AIF   ('&UTERM' EQ 'NO').GQC                            S22024
.NQ3705  ANOP                                                    S22024
&A       SETA  2 .                                               S22024
.GQC     ANOP                                                    S22024
.MAC14   IEDQTQ &CHB,&A,&P,&CHD,&LEVEL,&UTERM,CALL=&DIALNO,C=&L,       *
               ST=&CHA,QT=&QBY,CLOCK=&B(6),CTB=&IEDQCTB(1)&IEDQCTB(2), X
               TAC=&IEDQTAC,QUE=&NO,MAX=&CTBCNT,TERM=&TERM     @Y17XAFF
.NQ      AIF   ('&UTERM' EQ 'YES' OR '&UTERM' EQ 'IDLE').ZF      S22024
         AIF   (&IEDQTAC AND '&CHB' EQ '' AND '&CHD' EQ '').ZF   S22024
         AIF   ('&COMP' EQ 'YES').ZF                           @XA09782
&IEDQSV(6) SETC '&CHB'                                           S22024
&IEDQSV(8) SETC '&CHD'                                         @OZ37662
         AIF   ('&TERM' NE '327C' OR '&QBY' NE 'L').ZF         @OZ43705
&IEDQSV1(19) SETC '&IEDQSV(2)'        SAVE CLUSTER QCB         @OZ37662
.ZF      ANOP
         AIF   (T'&BFDELAY NE 'O').NOBFR                         S22025
&IEDQFL(7)  SETB  0                                              S22025
.NOBFR   ANOP                                                    S22025
&NAME    IEDQTT TAC=&IEDQTAC,ACTV=&ACTIVE,GPCU=&GPCLSTR,       @SA05843*
               ALIAS=&ALIAS,TCMSESN=&TCMSESN,TERM=&TERM,SPECOUT=&SPECOU*
               T,UTERM=&UTERM                                  @Y17XAFF
&B(7)    SETB  ('&OPDATA' NE '')
         DC    B'&NB.00&IEDQZA(63).10&B(7)&B(8)' . TRMSTATE    @Y17XAFF
         AIF   ('&TERM' NE 'SSCP').A1050                       @Y17XAFF
         DC    AL3(IEDOPCOB) .          TRMDESTQ               @Y17XAFF
         AGO   .A1051                                          @Y17XAFF
.A1050   DC    AL3(&IEDQSV(2)) .        TRMDESTQ               @Y17XAFF
.A1051   DC    H'1' .                   TRMINSEQ               @Y17XAFF
         DC    H'1' .                   TRMOUTSQ               @Y17XAFF
         AIF   ('&ALTDEST' EQ '').NAL
&S       SETA  82-&IEDQAR(1)
         DC    AL2((&ALTDEST-IEDQTNT-&S)/&IEDQAR(1))
.ST      DC    BL1'&IEDQFL(1)&IEDQFL(2)&IEDQFL(3)&IEDQFL(4)&IEDQFL(5)&IX
               EDQFL(6)&IEDQFL(7)&IEDQFL(8)'
         DC    BL1'&IEDQFL(9)&IEDQFL(10)&IEDQFL(11)&IEDQFL(12)&IEDQFL(1X
               3)&IEDQFL(14)&IEDQFL(15)&IEDQFL(16)'
         DC    XL4'0' .                 TRMSTAT                @Y17XAFF
         DC    AL1(&IEDQAR(12)) .       TRMCHCIN               @Y17XAFF
         AIF   ('&SAVE' EQ '').PASS                            @OZ37662
&IEDQSV(2) SETC  '&SAVE'              RESTORE NON CLUSTER QCB  @OZ37662
.PASS    ANOP                                                  @OZ37662
         AIF   (&IEDQAR(12) LE &IEDQAR(11)).OLD
&IEDQAR(11)  SETA  &IEDQAR(12)
IEDQSTCS CSECT
         DC    AL4(&IEDQCH(&IEDQAR(11))) .DEV CHARACTERISTIC   @Y17XAFF
         DC    AL2(&IEDQCH1(&IEDQAR(11)))  .TABLE ENTRY        @Y17XAFF
IEDQTRMC CSECT
.OLD     AIF   (N'&OPDATA EQ 0).CSE
.OPT     ANOP                                                  @OZ44387
&NAME    IEDQTO  &OPDATA                                       @OZ44387
         AIF   (&IEDQAR(5) EQ 0).CSE
&IEDQAR(10) SETA 3
         AGO   .EXIT
.CSE     ANOP
         IEDQGCH                                               @OZ41718
&IEDQTAC SETB 0                                                @OZ41718
&IEDQSV1(21) SETC ''                                           @OZ41718
&IEDQSV1(22) SETC ''                                           @OZ41718
         AIF   (NOT &IEDQFL(9)).OUT
&NAME    IEDQDID &IEDQID(1)&IEDQID(2)
.OUT     AIF   ('&NAME' NE '&IEDQSV(5)').EXIT
&IEDQZA(55) SETB 0
         IEDNOL ,                                                S99529
         AIF   (&IEDQAR(14) NE 0).GOTSCB                         Y05330
&IEDQAR(14) SETA 1                                               Y05330
.GOTSCB  ANOP                                                    Y05330
IEDQSCBC CSECT                                                   X01004
IEDQTRME DC    AL2(&IEDQAR(11)),AL2((&IEDQAR(14)+7)/8)
IEDQTNT  CSECT                                                   X02004
         DC    A(IEDQTRMC)                                       X02004
         AIF   (&IEDQAR(3) EQ 0).CKDS
IEDQOPC  CSECT
         DC    X'FF'                    END OF TABLE             Y05330
IEDQOPT  CSECT
IEDQOPTN DC    AL2(&IEDQAR(15))
.CKDS    ANOP
&IEDQSV(4) CSECT
IEDOCQE  EQU   &IEDQZA(53)*255                                   Y05330
      AIF (NOT &IEDQZA(52) OR (&IEDQFL(9) AND NOT &IEDQTAC)).EXIT
.*                                                               A52954
&A       SETA  0                                                 Y05330
&L       SETA  0                                                 Y05330
         AIF   (&IEDQAR(33) EQ 0 AND &IEDQAR(34) EQ 0).CXXG      Y05330
&A       SETA  (&IEDQAR(34)*4+1)                                 Y05330
&L       SETA  (&IEDQAR(33)*4+3)                                 Y05330
.CXXG    ANOP                                                    Y05330
IEDQNADN EQU   &A                                                Y05330
IEDQNADR EQU   &L                                                Y05330
.EXIT    ANOP                                                   SA57685
&IEDQZA(63) SETB 0                      RESET PREFIX INDICATOR @Y17XAFF
&IEDQNO  SETB  0
&IEDQZZ(8) SETB 0                                                S99228
&IEDQZZ(2) SETB 0                                                S99228
&IEDQZA(17) SETB 0                                               S22029
         MEND

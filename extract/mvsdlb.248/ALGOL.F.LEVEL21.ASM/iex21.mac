X21      TITLE 'IEX21 - ERROR MESSAGE EDITING, ALGOL F'
*
*        COMPONENT ID - 360S-AL-531 ALGOL F COMPILER
*
*        FUNCTION/OPERATION -
*        THE ERROR PATTERNS GENERATED DURING SCANI/II AND ITAB
*        MANIPULATION ARE HANDLED AND THE CORRESPONDING
*        DIAGNOSTIC MESSAGES ARE GENERATED
*
*        ENTRY POINT -
*        IEX21000 - ERROR MESSAGE EDITING XCTL EP=IEX21
*        THE MODULE IS ENTERED FROM IEX20
*
*        INPUT - N/A
*
*        OUTPUT -
*        THE DIAGNOSTIC MESSAGES ARE PUT OUT ON SYSPRINT
*        IF SYSPRINT IS NOT AVAILABLE A WTO IS ISSUED
*
*        EXTERNAL ROUTINE -
*        THE PRINT ROUTINE IN IEX00 IS USED
*
*        EXIT - NORMAL -
*        IF NO TERMINATING ERROR HAS OCCURRED, CONTROL IS GIVEN
*        TO THE NEXT PHASE BY MEANS OF XCTL EP=IEX30000
*
*        EXIT - ERROR -
*        IF A TERMINATING ERROR HAS OCCURRED (IN THIS MODULE OR
*        ONE OF THE PRECEDING) CONTROL IS GIVEN TO THE
*        TERMINATING MODULE BY MEANS OF XCTL EP=IEX51002
*
*        TABLES/WORKAREAS -
*        THE MESSAGE TEXTS WITH CORRESPONDING ADDR TABLE ARE
*        IN THE LOAD MODULE IEX21M
*        THE ERROR MESSAGE EDITING ROUTINE, CSECT IEX60000, ALSO
*        USES THE FOLLOWING TABLES -
*        WINTEBC  - TRANSLATION OF INTERNAL CHARACTERS TO EBCDIC
*        WSYMBSRC - TRANSLATION OF SOURCE OPERATORS
*        WSYMBSTK - TRANSLATION OF STACK OPERATORS
*        WORDSEBC - TRANSLATION OF COMPOUND SYMBOLS IF SOURCE IN
*                   EBCDIC
*        WORDSISO - TRANSLATION OF COMPOUND SYMBOLS IF SOURCE IN
*                   ISOCODE
*        WEBCDIC  - TRANSLATION EBCDIC EBCDIC
*        A WORKAREA OF 270 BYTES, WAREA, IS USED FOR BUILDING
*        THE MESSAGES
*
*        NOTES -
*        CHARACTER CODE DEPENDENCE - FOR THE BUILDING OF A MESSAGE
*        (CODE PART BETWEEN COT03 AND COT12) THE FOLLOWING
*        APPLIES, IN CASE NO SOURCE INFORMATION IS TO BE INSERTED
*        (COT31), OR IF THE INFORMATION IS EBCDIC CHARACTERS
*        (COT07), THE OPERATION OF CSECT IEX60000 DEPENDS UPON AN
*        INTERNAL REPRESENTATION OF THE EXTERNAL CHARACTER SET
*        WHICH IS EQUIVALENT TO THE ONE USED AT ASSEMBLY TIME.
*        IF THE SOURCE INFORMATION TO BE INSERTED IS INTERNAL
*        CHARACTERS (COT33) THE OPERATION OF CSECT IEX60000
*        DEPENDS UPON A TRANSLATION FROM THE INTERNAL
*        REPRESENTATION TO THE EBCDIC CHARACTER SET BY MEANS OF
*        THE TABLE WINTEBC.
*        IF THE SOURCE INFORMATION TO BE INSERTED IS INTERNAL
*        ALGOL SYMBOLS (COT10) THE OPERATION OF CSECT IEX60000
*        DEPENDS UPON A TRANSLATION FROM THE INTERNAL
*        REPRESENTATION TO THE EBCDIC CHARACTER SET BY MEANS OF
*        THE TABLES 'WSYMBSTK'/'WSYMBSRC' AND 'WORDSISO'/
*        'WORDSEBC'.
*        FOR THE OUTPUT OF A MESSAGE (CODE PART BETWEEN COT12
*        AND COT21) THE FOLLOWING APPLIES -
*        WHEN A MESSAGE HAS BEEN BUILT IN EBCDIC, AN EBCDIC TO
*        EBCDIC TRANSLATION IS PERFORMED BEFORE OUTPUT BY MEANS
*        OF THE TABLE WEBCDIC. THUS THE OUTPUT MAY BE MODIFIED
*        BY MAKING CHANGES IN THIS TABLE
*
*        THE OPERATION OF CSECT IEX21000 DOES NOT DEPEND UPON A
*        PARTICULAR INTERNAL REPRESENTATION OF THE EXTERNAL
*        CHARACTER SET
*
*        THIS MODULE IS LINKED WITH THE MODULE IEX21M TO FORM
*        MODULE IEX21
*
*        THIS MODULE IS ONLY INTENDED TO BE EXECUTED IN
*        CONNECTION WITH THE OTHER MODULES OF THE ALGOL COMPILER
*        IN PARTICULAR IT REQUIRES THE COMMON WORKAREA.
*
IEX21000 CSECT
*
         IEXENTRY 'IEX21000 LEVEL 2.1 &SYSDATE &SYSTIME'
*
         USING IEX21000,R15
*
         L     R2,=A(IEX60000)         ADDR ERROR MSG EDIT ROUTINE
         LA    R14,SCAN3               LOAD RETURN ADDR
         LA    R1,ERRINFO              ADDR INFO FOR ERROR ED ROUTINE
         BR    R2                      GOTO ERROR MESSAGE EDITING
*
SCAN3    XCTL  EP=IEX30000
*
ERRINFO  DC    V(IEX21M00)             ADDR OF MESSAGE TEXTS
         DC    V(IEX21M01)             ADDR OF ADDR TABLE
         DC    H'152'                  MODIFICATION NUMBER
*
         LTORG
*
         COPY  IEX60000
*
WORKAREA DSECT
*
         COPY  WORKAREA
*
*        REGISTER EQUATES
*
         IEZREGS
*
         END

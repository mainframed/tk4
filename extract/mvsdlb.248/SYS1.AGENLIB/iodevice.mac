         MACRO
&NAME  IODEVICE  &UNIT=,&ADDRESS=,&MODEL=,&FEATURE=,&OFFLINE=NO,       *
               &OPTCHAN=,&ADAPTER=,&SETADDR=,&EXPBFR=,&TCU=,&AP=NO,    *
               &GCU=,&PCU=,&DEVTYPE=,&ERRTAB=,&NUMSECT=,&OBRCNT=,      *
               &ERROR                                          @ZA32966
         COPY  SGGBLPAK
         LCLA  &A,&I,&ML,&CB,&Q,&H
         LCLA  &X,&L,&M,&MM
         LCLA  &OP,&FC                                          G64HSPD
         LCLB  &IOC,&MULT,&CHKSW,&QUIT
         LCLB  &ALT(15),&LOC,&G,&S
         LCLB  &DSPRSW1                                         G64HSPD
         LCLB  &AB,&BB,&DB,&EB,&FB,&KB7,&KB8,&DOC
         LCLC  &BUF,&D,&E,&F,&ID,&N,&ADDR,&DENS
         LCLC  &O,&OA,&OB,&OC,&OD,&OE,&OF,&OG,&OH
         LCLC  &CH,&CL,&DF,&UT                                  G64HSPD
         ACTR  10000                                           OY03398
.***** START OF SPECIFICATIONS **************************************
.*
.* MODULE NAME - IODEVICE
.*
.* DESCRIPTIVE NAME - INPUT OUTPUT DEVICE GENERATION
.*
.* COPYRIGHT - NONE
.*
.* STATUS - CHANGE LEVEL 04
.* ADD 247921
.*
.* FUNCTION -
.*       THE IODEVICE MACRO DESCRIBES THE CHARACTERISTICS OF AN
.*       INPUT/OUTPUT DEVICE AND ITS OPERATING SYSTEM REQUIREMENTS.
.*       EACH UNIQUELY ADDRESSABLE I/O DEVICE IN THE SYSTEM MUST
.*       BE SPECIFIED IN AN IODEVICE MACRO INSTRUCTION.
.*
.* NOTES - N/A
.*
.* MODULE TYPE - MACRO
.*
.* ENTRY POINT - N/A
.*
.* INPUT - THE FOLLOWING PARAMETERS ARE ALLOWED ON THE IODEVICE MACRO
.*             &UNIT    - THE IBM SUPPLIED NAME OF THE DEVICE.
.*             &OFFLINE - SPECIFIES THE DEVICE IS CONSIDERED OFFLINE
.*                        AT IPL.
.*             &AP      - SPECIFIES THAT THE DEVICES WITH THIS
.*                        FEATURE WILL HAVE AP
.*                        (TAPE AND DIRECT ACCESS ONLY)
.*             &ADDRESS - SPECIFIES THE ADDRESS OR ADDRESSES OF
.*                        DEVICES OR TELECOMMUNICATION LINES.
.*             &ERROR   - CHECK FOR POSITIONAL PARAMETER.
.*             &ERRTAB  - SPECIFIES THAT AN ERROR ROUTINE, OTHER
.*                        THAN THE STANDARD IS TO BE USED.
.*             &DEVTYPE - ANY ADDITIONAL CHARACTERISTICS OF THE
.*                        DEVICE. MUST BE 8 HEX DIGITS.
.*             &MODEL   - SPECIFIES THE MODEL NUMBER, IF ANY, FOR
.*                        THE DEVICE.
.*             &FEATURE - SPECIFIES THE OPTIONAL FEATURES PRESENT
.*                        ON THE DEVICE.
.*             &TCU     - SPECIFIES THE TELEPROCESSING CONTROL UNIT
.*                        FOR A TELECOMMUNICATIONS LINE.
.*             &EXPBFR  - SPECIFIES THE AMOUNT OF BUFFER SPACE, IN
.*                        BYTES, REQUIRED BY PROGRAMS WRITTEN FOR
.*                        A 2250 MOD 1 USING EXPRESS ATTN HANDLING.
.*             &GCU     - SPECIFIES THE TYPE OF GRAPHICS CONTROL
.*                        UNIT TO WHICH A 2260 MOD 2 IS ATTACHED.
.*             &ADAPTER - SPECIFIES THE TERMINAL CONTROL UNIT OR
.*                        ADAPTER USED TO CONNECT A TELECOMMUNICATIONS
.*                        DEVICE TO A TRANSMISSION CONTROL UNIT.
.*             &NUMSECT - SPECIFIES THE NUMBER OF 256 BYTE BUFFER
.*                        SECTIONS IN THE 2840 CONTROL UNIT TO BE
.*                        AVAILABLE TO THE 2250 MOD 3.
.*             &OBRCNT  - THE NUMBER OF AREA STATIONS CONNECTED TO
.*                        THE 2715 TRANSMISSION CONTROL IN A 2790
.*                        DATA COMMUNICATIONS SYSTEM.
.*             &OPTCHAN - SPECIFIES THE OPTIONAL CHANNEL THROUGH
.*                        WHICH A 2305, 2314,3330,2401,2420,
.*                        3420 OR DUMMY MAY BE ADDRESSED.
.*             &PCU     - SPECIFIES THE NUMBER ASSIGNED TO THE
.*                        CONTROL UNIT TO WHICH THIS 2250 IS
.*                        ATTACHED.
.*             &SETADDR - SPECIFIES WHICH OF THE FOUR SET ADDRESS
.*                        COMMANDS IS TO BE ISSUED TO THE TRANS-
.*                        MISSION CONTROL UNIT FOR OPERATIONS ON
.*                        THE SPECIFIED LINE.
.*             &SIOF    - THE START I/O FAST RELEASE INSTRUCTION
.*                        MAY BE USED ON THIS DEVICE.
.*
.* OUTPUT -
.*       THE GLOBALS USED ARE -
.*             &SGMENTB(4)     - IODEVICE MACRO CALLED
.*             &SGCNTRA(2)     - COUNT OF 2840'S
.*             &SGCNTRA(3)     - DEVICE COUNT
.*             &SGDADRA(1-1917) - DEVICE ADDRESS AND RELATED SUBSCRIPTS
.*             &SGDASPA(1-1917) - SWITCH POINTER
.*             &SGQUITB        - QUIT SWITCH
.*             &SGDFXXB(1-1917) - FEATURE SWITCHES (XX = 01 THROUGH 15)
.*             01- 7-TRACK    02- 9-TRACK   03- READWRITE 04- DUALDENS
.*                 ALKYB2250      SHARED        PRGMKYBD      ABSLTVEC
.*                 ALKYB2260      LIGHTPEN      DEKYB2260     SCONTROL
.*                 CARDIMAGE      NMKYB2260     AUTOANSR      NUMLOCK
.*                 24ADDPOS       UNVCHSET      TWOLINE       370
.*                 AUTOPOLL       SELCHSET      MAGCDRD
.*                 AUDALRM        AUTOCALL      PERMRES
.*                 RPS            MULTILINE     3330V
.*                 CGS1           SELPEN
.*                                SHAREDUP
.*                                CGS2
.*
.*             05- MDECOMPAT  06- BUFFER8K  07- CHARGNTR  08- INTERRUPT
.*                 BUFFER4K       CHECKING      OIU           FRCHAR
.*                 XCONTROL       DUALCOMM      UKCHAR        AP
.*                 DUALCODE       ASCBCHAR      BURSTER
.*                 ASACHAR        OPT1600
.*                 MOD 4,6,8
.*                 OLTEP
.*                 SHAREDUP
.*
.*             09- DESIGNFT   10- EBKY3277  11- ASKY3277 12- DEKY3277
.*                 GRCHAR         ERRORLOG
.*                 SHAREABLE
.*
.*             13- OCKY3277   14- KB78KEY   15- KACHAR
.*                                KB81KEY   16- PTREAD         @ZA41353
.*
.*
.*             &SGDTXXB(1-1023) - DEVICE TYPE (XX = 1 THROUGH 12)
.*             &SGDUXXB(1-1023) - UNIT TYPE (XX = 1 THROUGH 13)
.*
.* DUXX DT01  DT02     DT03 DT04 DT05 DT06 DT07  DT08 DT09 DT10 DT12
.*   01 24XX  WTTA       *  1052 2250 1403 1442  1030   *  3838 2740X
.*   02   *  1287/2741P  *    *  2260 1404 2501  1050   *  7443 2740C
.*   03 34XX 1288/2741C  *  3210 1053 1443 2520  1060   *    *  2265
.*   04   *  1050X       *  3215   *  1419 2540R 2260   *    *  7770
.*   05   *     *        *    *    *  1275 2540P 115A   *    *  2955
.*   06   *   BSC1     2314   *  3066 3211 2671  83B3   *    *  3705
.*   07   *   BSC2     3330   *  3286 2245 2495  TWX    *    *  3704
.*   08   *   BSC3     2305   *  3277 3213 3505  2740   *    *    *
.*   09   *     *      3340   *  3284 3895 3525    *  CTC    *    *
.*   10   *     *      3350   *  3158 3800 3886    *    *    *  3791L
.*   11   *     *        *    *    *       3890    *    *    *    *
.*   12   *     *        *    *    *       3540    *    *    *    *
.*   13   *     *        *    *  3036      3851    *    *    *    *
.*
.*             &SG3410B(1-1917)- A 3410 IF &SGDT01B AND &SGDU03B
.*             &SG2305A        - NUMBER OF 2305'S SPECIFIED
.*             &SG2314A        - NUMBER OF 2314/2319'S SPECIFIED-9
.*             &SG3330A        - NUMBER OF 3330 DEVICES
.*             &SG3505A        - COUNT OF 3505 DEVICES
.*             &SG3525A        - COUNT OF 3525 DEVICES
.*             &SGDASDA        - COUNT OF DIRECT ACCESS DEVICES
.*             &SGBSCA         - OBRCNT= VALUE - MAX IS 800
.*             &SGBRSTB(1-1917)- BURST DEVICE ON CHANNEL
.*             &SGDEVB         - DEVTYPE SPECIFIES ENTRY SWITCH
.*             &SGDEVTP(1-1917)- ERRTAB=VALUE PLUS LAST 2 DIGITS OF
.*                               DEVTYPE.
.*             &SGDNBFA(1-1917)- NUMSECT=VALUE FOR 2250-3
.*             &SGDUMMY(1-1917)- UNIT=DUMMY
.*             &SGDOFFB(1-1917)- OFFLINE SPECIFIED
.*             &SGSIOF(1-1917) - SIOF INSTRUCTION CAN BE USED
.*             &SGOPCHA        - COUNT OF OPTIONAL CHANNEL PATHS
.*             &SGDAPXB(1-1917)- CHANNEL X ALTERNATE (X IS 1 THROUGH F)
.*             SGOPSUB(1-1917) - OPT.CHANNEL ON 2870 SELECTOR-SUBCHAN
.*
.*                             MODEL NO.  SAD CMDS.  2314/3330 NO.MODS
.*             &SGDM01B(1-1917) 1 N1 B1 B     0              1
.*             &SGDM02B(1-1917) 2 N2 B2 C     1              2
.*             &SGDM03B(1-1917) 3             2              3
.*             &SGDM04B(1-1917) 4             3              4
.*             &SGDM05B(1-1917) 5                            5
.*             &SGDM06B(1-1917) 6                            6
.*             &SGDM07B(1-1917) 7                            7
.*             &SGDM08B(1-1917) 8                            8
.*             &SGDM09B(1-1917)                              9
.*             &SGDM11B(1-1917) 3330 MODEL-11
.*
.*             &SGDAD1B(1-1917) - ADAPTER IBM1
.*             &SGDAD2B(1-1917) - ADAPTER IBM2
.*             &SGDAD3B(1-1917) - ADAPTER IBMT
.*             &SGDAD4B(1-1917) - ADAPTER TELE1
.*             &SGDAD5B(1-1917) - ADAPTER TELE2
.*             &SGDAD6B(1-1917) - ADAPTER IBM3
.*             &SGDAD7B(1-1917) - ADAPTER BSCA
.*             &SGDAD8B(1-1917) - ADAPTER TELEW
.*
.*             &SGCUN1A(1-1917) - EXPRESS BUFFERS ON 2840 FOR 2250-3
.*             &SGUNM1B(1-1917) - GRAPHICS CONTROL UNIT FOR 2260-2
.*             &SGUNM2B(1-1917) - GRAPHICS CONTROL UNIT FOR 2260-2
.*             &SGUNM3B(1-1917) - GRAPHICS CONTROL UNIT FOR 2260-1
.*             &SGUNM4B(1-1917) - GRAPHICS CONTROL UNIT FOR 2260-2
.*             &SGUNM5B(1-1917) - GRAPHICS CONTROL UNIT FOR 2260-2
.*                       &SGUNT1B   &SGUNT2B  &SGUNT3B
.*             &SGUNU1B      *      TCU=2701  TCU=2703
.*             &SGUNU2B      *      TCU=2702     *
.*             &SGUNF1B(1-1917) - CARDIMAGE, LINEADDR
.*             &SGUNF2B(1-1917) - DATACONV,NODESCUR
.*             &SGUNF5B(1-1917) - SHARED
.*
.*             &SGDCLSB(3)     - 24XX TAPE DRIVES
.*             &SGDCLSB(4)     - 3704 COMMUNICATIONS CONTROLLER
.*             &SGDCLSB(5)     - 3705 COMMUNICATIONS CONTROLLER
.*             &SGDCLSB(6)     - CONSOLE KEYBOARD-PRINTERS
.*             &SGDCLSB(8)     - GRAPHIC (CRT) TYPE DEVICES
.*             &SGDCLSB(9)     - 2250 DISPLAY STATIONS
.*             &SGDCLSB(10)    - 2260 DISPLAY STATIONS
.*             &SGDCLSB(12)    - READER-PUNCH UNITS
.*             &SGDCLSB(16)    - 2501 CARD READER
.*             &SGDCLSB(17)    - 2520 CARD PUNCH
.*             &SGDCLSB(18)    - 2520 CARD PUNCH
.*             &SGDCLSB(19)    - 2540 CARD READER
.*             &SGDCLSB(20)    - 2540 CARD PUNCH
.*             &SGDCLSB(21)    - 2671 PAPER TAPE READER
.*             &SGDCLSB(22)    - 3350                          @ZM41663
.*             &SGDLCSB(23)    - 1403 PRINTER
.*             &SGDCLSB(25)    - 1443 PRINTER
.*             &SGDCLSB(26)    - 3895 DOC READER/INSCRIBER     G30HSVN
.*             &SGDCLSB(26)    - 3895
.*             &SGDCLSB(27)    - 3540 DISKETTE                 @Y30OS
.*             &SGDCLSB(28)    - 3851 DISK                     @Y30LBOS
.*             &SGDCLSB(29)    - 3838 ARRAY PROCESSOR           G29ASVN
.*             &SGDCLSB(33)    - TELECOMMUNICATIONS CLASS DEVICES
.*             &SGDCLSB(39)    - 1053 PRINTER ON 2848 CONTROL
.*             &SGDCLSB(40)    - RECORD OVERFLOW DEVICES
.*             &SGDCLSB(41)    - 2314 DISK DRIVE
.*             &SGDCLSB(43)    - 3036 CONSOLE                   G51DSPD
.*             &SGDCLSB(44)    - 7443 SYSTEM RECORD FILE        G51DSPD
.*             &SGDCLSB(50)    - 2740 COMMUNICATIONS TERMINAL
.*             &SGDCLSB(54)    - SHARED DIRECT ACCESS DEVICES
.*             &SGDCLSB(55)    - 1403 UCS FEATURE
.*             &SGDCLSB(56)    - 3791L LOCAL CHANNEL ATTACHMENT Z40KSVN
.*             &SGDCLSB(57)    - 2420 TAPE
.*             &SGDCLSB(58)    - 1287 OPTICAL CHARACTER READER
.*             &SGDCLSB(59)    - 1288 OPTICAL PAGE READER
.*             &SGDCLSB(60)    - 3066 OPERATOR CONSOLE
.*             &SGDCLSB(61)    - 2495 TAPE CARTRIDGE READER
.*             &SGDCLSB(62)    - 1050X TERMINAL
.*             &SGDCLSB(63)    - 2740X TERMINAL
.*             &SGDCLSB(64)    - 2740C TERMINAL
.*             &SGDCLSB(65)    - 1419 MAGNATIC CHECK READER
.*             &SGDCLSB(66)    - 1275 OPTICAL CHECK READER
.*             &SGDCLSB(67)    - 7770 AUDIO RESPONSE DEVICE
.*             &SGDCLSB(68)    - 2265 DESPLAY DEVICE
.*             &SGDCLSB(69)    - 3330, 3330V DISK FACILITY
.*             &SGDCLSB(70)    - 2305 FIXED HEAD DISK FILE
.*             &SGDCLSB(71)    - 3211 PRINTER
.*             &SGDCLSB(72)    - 2955 REMOTE ANALYSIS TERMINAL
.*             &SGDCLSB(73)    - 3420 TAPE DRIVE
.*             &SGDCLSB(74)    - 2245 PRINTER
.*             &SGDCLSB(75)    - 2305 MOD 1
.*             &SGDCLSB(76)    - 2305 MOD 2
.*             &SGDCLSB(77)    - 3410 IN SYSTEM
.*             &SGDCLSB(78)    - 3505 IN SYSTEM
.*             &SGDCLSB(79)    - 3525 IN SYSTEM
.*             &SGDCLSB(80)    - ANR DEVICE IN SYSTEM
.*             &SGDCLSB(81)    - 3800 DEVICE IN SYSTEM
.*             &SGDCLSB(82)    - HASB DEVICE IN SYSTEM
.*             &SGDCLSB(83)    - CTC  DEVICE IN SYSTEM
.*             &SGDCLSB(84)    - 3340
.*             &SGDCLSB(85)    - 3330 MODEL 11
.*             &SGDCLSB(86)    - 3890
.*             &SGDCLSB(87)    - 3886
.*             &SGDCLSB(88)    - RPS 3340
.*
.*
.*    GLOBALS USED TO PASS IODEVICE SPECIFICATION PARAMETERS
.*    TO DSP MACRO EXITS  -
.*             &SGADRPC(1)   - DEVICE ADDRESS SPECIFICATION
.*             &SGADRPC(2)   - ADDRESS MULTIPLIER
.*             &SGFCNTA      - NUMBER OF FEATURES PARMS
.*             &SGFETPC(20)  - FEATURES SPECIFIED
.*             &SGOPCTA      - NUMBER OF OPTIONAL CHANNELS
.*             &SGDVTPC      - DEVICE TYPE SPECIFICATION
.*             &SGERTPC      - ERRTAB ERROR ROUTINE SUFFIX
.*             &SGAPPMC      - ALTERNATE POWER SOURCE PARM
.*             &SGOFLPC      - OFFLINE PARM
.*             &SGMDLPC      - MODEL PARM
.*             &SGADPTR      - ADAPTER FOR TELECOMMUNICATIONS LINES
.*
.*       LOCALS USED ARE -
.*             &A    - COUNTER FOR SUBLIST
.*             &I    - POINTER FOR SETTING SWITCHES
.*             &ML   - NUMBER OF OPTCHANS
.*             &Q    - COUNTER
.*             &CB   -
.*             &H    - CHANNEL ADDRESS
.*             &X    - COUNT OF CHARACTERS IN DEVICE TYPE
.*             &L    -
.*             &M    - NUMBER OF UNITS
.*             &MM   - NUMBER OF UNITS
.*             &IOC  - CONTROL UNIT
.*             &MULT - MULTIPLE DEVICES IN SPECIFICATION
.*             &CHKSW- ERROR CREATE ONE SGDADRA
.*             &QUIT - ERROR, SET QUIT SWITCH
.*             &ALT  - OPTIONAL CHANNEL WITH SELECTOR SUBCHANNEL
.*             &LOC  - MOD LOCAL
.*             &G    - 2740
.*             &S    - NO FEATURES
.*             &AB   - DOM. CHAR GENERATOR SW, AUTOPOLL ONLY VALID
.*             &BB   - AUTOPOLL INVALID
.*             &DB   - AUTOANSR ONLY VALID FEATURE
.*             &EB   - IBM1 ADAPTER
.*             &FB   - 2740C, 2740X
.*             &KB8  - 81 KEY KEYBOARD
.*             &DOC  - DOMESTIC CHARACTER GENERATOR
.*             &ID   - USERS CALL NAME OR NUMBER FOR MNOTES
.*             &ADDR - DEVICE ADDRESS
.*             &O    - COMBINATION OF CHARS OF DEVICE TYPE
.*             &OA   - FIRST CHARACTER OF DEVICE TYPE
.*             &OB   - SECOND CHARACTER OF DEVICE TYPE
.*             &OC   - THIRD CHARACTER OF DEVICE TYPE
.*             &OD   - FOURTH CHARACTER OF DEVICE TYPE
.*             &OE   - FIFTH CHARACTER OF DEVICE TYPE
.*             &OF   - SIXTH CHARACTER OF DEVICE TYPE
.*             &OG   - SEVENTH CHARACTER OF DEVICE TYPE
.*             &OH   - EIGHTH CHARACTER OF DEVICE TYPE
.*             &CH   - WORK STOR. FOR TESTING ADDRESS OPTIONS
.*             &CL   - WORK STOR. FOR TESTING ADDRESS OPTIONS
.*             &DF   - WORK STOR. FOR TESTING ADDRESS OPTIONS
.*             &FC   - WORK STOR. FOR TESTING ADDRESS OPTIONS
.*             &UT   - WORK STOR. FOR TESTING ADDRESS OPTIONS
.*             &OP   - WORK STOR. FOR COUNTING OP. CHANNELS
.*
.* EXIT, NORMAL - N/A
.*
.* EXIT, ERROR - N/A
.*
.* EXTERNAL REFERENCES - N/A
.*
.* TABLES - N/A
.*
.* MACROS - CONVERT - CONVERTS A NUMBER FROM HEX TO DECIMAL
.*        - SGSETDIT - BUILDS THE DIT FOR OLD DEVICES
.*
.*        - SGDSPDIT - INVOKES THE MACRO EXITS THAT BUILD THE DIT
.*                     FOR NEW DEVICES
.*
.*        - SGDSPDFT - INVOKES THE MACRO EXITS THAT BUILD THE DFT
.*                     FOR NEW DEVICES
.*
.* CHANGE ACTIVITY  ZA00805,ZM00043,ZM33354,X40MSTG,Z30RSTA,
.*                  Z40KSVN,VS40488,G30HSVN,G29ASVN,
.*                  OZ07710,OZ15968,@ZA16005,@ZA30097,@ZA30241,
.*                  @ZA32966,@ZA37298,@ZA41353,@ZA44226,@ZA44022
.*                  G64HSPD,@ZA71929
.*
.***** END OF SPECIFICATIONS ****************************************
         AIF   (&SGMENTB(4)).START      IODEVICE USED BEFORE
.*   INVOKE  SGSETDIT  TO INITIALIZE THE DASD ENTRIES
         SGSETDIT
.*
&SGDITDA     SETA  200                  SET DIT HIGHEST INDEX   G64HSPD
&SGCPRGB(8)  SETB  1                    INDICATE VS2 GEN
&SGMENTB(4)  SETB  1                    SET ENTRY SW FOR 1ST IODEV CALL
    MNOTE *,'    MAXIMUM OF 1917 I/O DEVICES ALLOWED'           Z40ASVN
.START   ANOP
&SGCNTRA(3) SETA &SGCNTRA(3)+1          COUNT OF DEVICES TO BE SYSGENED
&I       SETA  &SGCNTRA(3)              SET LCLA PTR FOR SETTING SWT.S
         AIF   ('&NAME' EQ '').INSERT   DID USER SUPPLY MACRO-CALL NAME
&ID      SETC  '&NAME'                  PUT USER'S CALL-NAME IN MNOTES
         AGO   .TESTCNT                 GO TEST FOR MAX DEV.S SYSGENED
.INSERT  ANOP                           ENTER RTN TO PLUG IN MACRO NO.
&ID      SETC  'DEV.#&I'                PUT MACRO-CALL-NO. INTO MNOTES
.TESTCNT AIF   (&SGCNTRA(3) GT 1917).MX                         Z40ASVN
         AIF   (T'&UNIT EQ 'O').AA      IF UNIT OMITTED GO TO ERROR RTN
         AIF   (T'&MODEL EQ 'O').R4     IF MOD OMIT,PUT UNT ONLY IN &&C
&LOC     SETB  1                        MOD LOCAL USED LATER FOR TESTNG
.**********************************************************************
.**********************************************************************
.**                                                                  **
.**                DEVICES SUPPORTED IN VS2 RELEASE 4                **
.**                                                                  **
.**********************************************************************
.**********************************************************************
.R4      AIF   ('&ERROR' EQ '').SYNTAX  SYNTAX CHECK.          @ZA32966
    MNOTE 5,'* * *&ERROR SPECIFIED AS A POSITIONAL PARAMETER'  @ZA32966
&SGQUITB  SETB  1                                              @ZA37298
.SYNTAX  ANOP                                                  @ZA32966
         AIF   ('&UNIT' EQ '2401').T2400
         AIF   ('&UNIT' EQ '2420').T2400
         AIF   ('&UNIT' EQ '3410').T3410
         AIF   ('&UNIT' EQ '3420').T3420
         AIF   ('&UNIT' EQ '2495').T2495
         AIF   ('&UNIT' EQ '1287').OPTCHAR
         AIF   ('&UNIT' EQ '1288').OPTCHAR
         AIF   ('&UNIT' EQ '2305').D2305
         AIF   ('&UNIT' EQ '2314').D2314
         AIF   ('&UNIT' EQ '2319').D2314
         AIF   ('&UNIT' EQ '3330').D3330
         AIF   ('&UNIT' EQ '3330V').D3330V                    @Y30LS04
         AIF   ('&UNIT' EQ '3340').D3340
         AIF   ('&UNIT' EQ '3350').D3350                       @Z30RSTA
         AIF   ('&UNIT' EQ '3540').DIS3540                     @Y30OS
.*                                                             @G64HSPD
.*    CHECK THIS DEVICE FOR POST RESTRUCTURE IMPLEMENTATION    @G64DSPD
         SGDSPDIT UNIT=&UNIT,ID=&ID                            @G64HDPD
.*    IF POST RESTRUCTURE, GO PREPARE IODEVICE PARMS FOR DSP   @G64DSPD
         AIF   (&SGDITXA(&SGCNTRA(3)) NE 0).DSPADR             @G64DSPD
.*                                                             @G64HSPD
         AIF   ('&UNIT' EQ '1052').K1052
         AIF   ('&UNIT' EQ '3210').K3210
         AIF   ('&UNIT' EQ '3215').K3215
         AIF   ('&UNIT' EQ '3066').DIS3066
         AIF   ('&UNIT' EQ '3158').DIS3158
         AIF   ('&UNIT' EQ '2250').DIS2250
         AIF   ('&UNIT' EQ '1053').DIS1053
         AIF   ('&UNIT' EQ '3036').DIS3036                      G51DSPD
         AIF   ('&UNIT' EQ '3277').DC3277
         AIF   ('&UNIT' EQ '3284').DC3284
         AIF   ('&UNIT' EQ '3286').DC3286
         AIF   ('&UNIT' EQ '1403').PRT1403
         AIF   ('&UNIT' EQ '1404').PRT1404
         AIF   ('&UNIT' EQ '1443').PRT1443
         AIF   ('&UNIT' EQ '3211').PRT3211
         AIF   ('&UNIT' EQ '3800').PRT3800                     @Z40MSTG
         AIF   ('&UNIT' EQ '3213').PRT3213
         AIF   ('&UNIT' EQ '1419').CHKRDR
         AIF   ('&UNIT' EQ '1275').CHKRDR
         AIF   ('&UNIT' EQ '2501').CR2501
         AIF   ('&UNIT' EQ '2520').CRP2520
         AIF   ('&UNIT' EQ '2540R').CR2540
         AIF   ('&UNIT' EQ '2540P').CP2540
         AIF   ('&UNIT' EQ '3505').CR3505
         AIF   ('&UNIT' EQ '3525').CP3525
         AIF   ('&UNIT' EQ '2671').RDR2671
         AIF   ('&UNIT' EQ '3886').RD3886   IF 3886 RDR GO TO RTN
         AIF   ('&UNIT' EQ '3890').RD3890   IF 3890 RDR GO TO RTN
         AIF   ('&UNIT' EQ '3838').A3838    IF 3838 ARRAY PROC  G29ASVN
         AIF   ('&UNIT' EQ '7443').S7443    IF SRF              G51DSPD
         AIF   ('&UNIT' EQ '1030').TP1030
         AIF   ('&UNIT' EQ '1050').TP1050
         AIF   ('&UNIT' EQ '1050X').TP1050X
         AIF   ('&UNIT' EQ '1060').TP1060
         AIF   ('&UNIT' EQ '2260' AND '&ADAPTER' EQ '').DS2260 2260GR
         AIF   ('&UNIT' EQ '2260' AND '&ADAPTER' NE '').TP2260
         AIF   ('&UNIT' EQ '2265').TP2265
         AIF   ('&UNIT' EQ '115A').TP115A
         AIF   ('&UNIT' EQ '2740').TP2740
         AIF   ('&UNIT' EQ '2740C').TP2740C
         AIF   ('&UNIT' EQ '2740X').TP2740X
         AIF   ('&UNIT' EQ '2741P').TP2741P
         AIF   ('&UNIT' EQ '2741C').TP2741C
         AIF   ('&UNIT' EQ '83B3').TP83B3
         AIF   ('&UNIT' EQ 'TWX').TPTWX
         AIF   ('&UNIT' EQ 'WTTA').TPWTTA
         AIF   ('&UNIT' EQ 'BSC1').TPBSC1
         AIF   ('&UNIT' EQ 'BSC2').TPBSC2
         AIF   ('&UNIT' EQ 'BSC3').TPBSC3
         AIF   ('&UNIT' EQ '7770').TP7770
         AIF   ('&UNIT' EQ '2955').TP2955
         AIF   ('&UNIT' EQ '3704').TP3704
         AIF   ('&UNIT' EQ '3705').TP3705
         AIF   ('&UNIT' EQ '3791L').TP3791                      Z40KSVN
         AIF   ('&UNIT' EQ 'CTC').TPCTC
         AIF   ('&UNIT' EQ '3851').D3851                       @Y30LBOS
         AIF   ('&UNIT' EQ '3895').D3895                        G30HSVN
         AIF   ('&UNIT' EQ 'DUMMY').DD  IF DUMMY DEV SPEC, BR DUMMY RTN
    MNOTE 5,'* * * IEIIOD101 &ID-UNIT VALUE &UNIT INVALID'
         AGO   .BADUNIT                 INVALID UNIT SPCFD-GO ERROR RTN
.*****    THE FOLLOWING DEVICES ARE NOT SUPPORTED FOR VS2-2   ****
.*       AIF   ('&UNIT' EQ '2415').T2400
.*       AIF   ('&UNIT' EQ '2245').PRT2245
.*       AIF   ('&UNIT' EQ '1442').CRP1442
.AA MNOTE 5,'* * * IEIIOD102 &ID-UNIT VALUE NOT SPECIFIED'
.BADUNIT ANOP
&SGDASPA(&I)   SETA  &I                                         Z40ASVN
&SGQUITB SETB  1
         AGO   .AP
.**********************************************************************
.**********           TAPE DRIVES                            **********
.**********************************************************************
.T2400   ANOP                           SET ONE GLOBAL TYP SW FOR 2400
&ML      SETA  1                        2400 W/NO READWRT,MAX OPTCHAN=1
.F6 MNOTE *,'     &UNIT MAGNETIC TAPE DRIVE '
&SGDU01B(&I)   SETB 1                   GLOBAL UNIT SWITCH 1 FOR 2400TP
&SGDF04B(&I)   SETB ('&UNIT' EQ '2415')
&SGDT01B(&I)   SETB 1                   GLOBAL TYPE SW 1 FOR TAPE
&SGDCLSB(3)  SETB  1                    A 2400 TAPE DRIVE WAS SPECD
 AIF ('&UNIT' EQ '2420').T2420
         AIF (NOT &LOC).AB              BR ERROR RTN IF MOD VALUE OMITD
         AIF   (T'&MODEL NE 'N').XX
         AIF   (&MODEL EQ 1 OR &MODEL EQ 2 OR &MODEL EQ 3 OR &MODEL EQ *
               4 OR &MODEL EQ 5 OR &MODEL EQ 6).AC
         AIF   (&MODEL EQ 8 AND '&UNIT' EQ '2401').AC
.XX MNOTE 5,'* * * IEDIIOD103 &ID-MODEL VALUE &MODEL INVALID'
&SGQUITB SETB  1
         AGO   .TFEATRE
.T3410 MNOTE *,'     3410 MAGNETIC TAPE DRIVE'
&SGDT01B(&I)   SETB  1             TAPE
&SGDU03B(&I)   SETB  1             3400
&SG3410B(&I)   SETB  1             3410
&SGDCLSB(77)   SETB  1             3410 CLASS
&SGDF10B(&I)   SETB  1             ERROR LOG PRESENT           @Z40MSTG
         AIF   (T'&MODEL EQ 'O').AB
         AIF ('&MODEL' EQ '1' OR '&MODEL' EQ '2' OR '&MODEL' EQ '3').AC
         AGO   .XX
.T3420 MNOTE *,'     3420 MAGNETIC TAPE DRIVE'
&SGDT01B(&I)   SETB  1             TAPE
&SGDU03B(&I)   SETB  1             3400
&SGDCLSB(73)   SETB  1             3420 CLASS
&SGDF10B(&I)   SETB  1             ERROR LOG PRESENT           @Z40MSTG
&ML      SETA  1                  ONE OPTIONAL CHANNEL ALLOWED
         AIF   (T'&MODEL EQ 'O').AB
         AIF ('&MODEL' EQ '3' OR '&MODEL' EQ '5' OR '&MODEL' EQ '7' OR *
               '&MODEL' EQ '4' OR '&MODEL' EQ '6' OR '&MODEL' EQ '8').A*
               C
         AGO   .XX
.**********************     TAPE MODEL     ***************************
.AC MNOTE *,'     MODEL &MODEL'
&SGDM01B(&I)  SETB (&MODEL EQ 1)   GLOBAL MODEL SWITCH 1
&SGDM02B(&I)  SETB (&MODEL EQ 2)   GLOBAL MODEL SWITCH 2
&SGDM03B(&I)  SETB (&MODEL EQ 3)   GLOBAL MODEL SWITCH 3
&SGDM04B(&I)  SETB (&MODEL EQ 4)   GLOBAL MODEL SWITCH 4
&SGDM05B(&I)  SETB (&MODEL EQ 5)   GLOBAL MODEL SWITCH 5
&SGDM06B(&I)  SETB (&MODEL EQ 6)   GLOBAL MODEL SWITCH 6
&SGDM07B(&I)  SETB (&MODEL EQ 7)   GLOBAL MODEL SWITCH 7
&SGDM08B(&I)  SETB (&MODEL EQ 8)   GLOBAL MODEL SWITCH 8
         AIF  (('&UNIT' EQ '3420') AND ('&MODEL' EQ '4' OR '&MODEL' EQ *
               '6' OR '&MODEL' EQ '8')).ACACA
         AGO   .TFEATRE
.ACACA   ANOP
&SGDF05B(&I)   SETB 1
         AGO   .TFEATRE
.AB MNOTE 5,'* * * IEIIOD104 &ID-MODEL VALUE NOT SPECIFIED'
&SGQUITB SETB  1
.***********************    TAPE FEATURES   **************************
.TFEATRE  AIF  (T'&FEATURE EQ 'O').HEADTST
    MNOTE *,'     FEATURE(S) '
.MORE1 AIF (N'&FEATURE EQ &A).HEADTST   DONE WITH FEATURES YET
&A       SETA  &A+1
         AIF   ('&FEATURE(&A)' EQ '7-TRACK').F1 WAS 7-TRACK HD SPECD
         AIF   ('&FEATURE(&A)' EQ '9-TRACK').F2 WAS 9-TRACK HD SPECD
 AIF ('&FEATURE(&A)' EQ 'READWRITE' AND('&UNIT' EQ '2401' OR '&UNIT' EQX
                '2402')).F3             RDWT VALID OPTL FEAT ON 2401/02
         AIF   ('&FEATURE(&A)' EQ 'DUALDENS').F4  WAS DUALDENS SPECD
         AIF   ('&FEATURE(&A)' EQ 'SHARABLE').F5A WAS SHARABLE SPECD
         AIF   ('&FEATURE(&A)' EQ 'OPT1600').F5   WAS OPT1600 SPECD
         AIF   ('&FEATURE(&A)' EQ 'MDECOMPAT').F7 WAS MDECOMPAT SPECD
         AIF   ('&FEATURE(&A)' EQ 'DATACONV').F8
         AIF   ('&FEATURE(&A)' EQ 'ALTCTRL').F9
    MNOTE 5,'* * * IEIIOD105 &ID-FEATURE VALUE &FEATURE(&A) INVALID'
&SGQUITB SETB  1
         AGO   .MORE1
.F1 MNOTE *,'        7-TRACK HEAD '
&SGDF01B(&I) SETB 1                     GLOBAL FEAT. SW 1 FOR 7-TRK HED
         AIF  (('&UNIT' EQ '3420') AND ('&MODEL' NE '3' AND '&MODEL' NE*
               '5' AND '&MODEL' NE '7')).MM
.*     NEXT TWO LINES ADDED FOR OZ16005                        @ZA16005
         AIF  (('&UNIT' EQ '2401') AND ('&MODEL' NE '1' AND '&MODEL' NE*
               '2' AND '&MODEL' NE '3' AND '&MODEL' NE '8')).MM
.F1A     AIF   (&SGDF02B(&I)).AD        7-TRK & 9-TRK MUTUALLY EXCLUSVE
         AGO   .MORE1
.F2 MNOTE *,'        9-TRACK HEAD '
&SGDF02B(&I) SETB 1                     GLOBAL FEAT. SW 2 FOR 9-TRK HED
         AIF   ('&MODEL' EQ '8' AND '&UNIT' NE '3420').F2A
         AIF   (&SGDF01B(&I)).AD        7-TRK & 9-TRK MUTUALLY EXCLUSVE
         AGO   .MORE1
.AD MNOTE 5,'* * * IEIIOD115 &ID-7-TRACK/9-TRACK MUTUALLY EXCLUSIVE'
&SGQUITB  SETB  1
   AGO   .MORE1
.F2A MNOTE 5,'* * * IEIIOD113 2401 MODEL 8 EXCLUSIVELY 7-TRACK'
&SGQUITB SETB  1
         AGO   .MORE1
.F3 MNOTE *,'        SIMULATANEOUS READ WHILE WRITE '
&SGDF03B(&I)   SETB 1                   GLOBAL FEATURE SWITCH 3
&ML      SETA  1                        2401,-02 W/RDWT,ONLY 1 OPCH REQ
         AGO   .MORE1
.F4      AIF   ('&UNIT' EQ '3410').BI   ALL 3410 MODELS VALID
         AIF   ('&UNIT' EQ '3420').F4A
     AIF  ('&MODEL' EQ '4' OR '&MODEL' EQ '5' OR '&MODEL' EQ '6').BI
.MM MNOTE 5,'* * * IEIIOD108 FEATURE &FEATURE(&A) INVALID FOR &UNIT MOD*
               EL &MODEL'
&SGQUITB SETB  1
         AGO   .MORE1
.F4A  AIF  ('&MODEL' EQ '3' OR '&MODEL' EQ '5' OR '&MODEL' EQ '7').BI
         AGO   .MM
.BI MNOTE *,'       DUAL DENSITY FEATURE'
&SGDF04B(&I)   SETB 1                        DUALDENS FEATURE SW
         AIF   (&SGDF06B(&I)).F8A             OPT1600 FEATURE SW
         AGO   .MORE1
.F5A     AIF   ('&UNIT' EQ '3420').F5B
    MNOTE 5,'* * * IEIIOD106 &ID-FEATURE SHARABLE INVALID FOR &UNIT'
         AGO   .MORE1
.F5B     ANOP
     MNOTE *,'       DEVICE SHARABILITY FEATURE'
&SGDF09B(&I)    SETB   1
         AGO   .MORE1
.F5      AIF   ('&UNIT' NE '3420').MM        3420 ONLY VALID UNIT
      AIF  ('&MODEL' EQ '3' OR '&MODEL' EQ '5' OR '&MODEL' EQ '7').MM
    MNOTE *,'        OPT1600 SPECIFIED'
&SGDF06B(&I)   SETB 1
         AIF   (&SGDF04B(&I)).F8A            DUALDENS SPECIFIED
         AGO   .MORE1
.F7      AIF   ('&UNIT' EQ '3420').MM        INVALID GO TO ERROR
         AIF   ('&UNIT' EQ '3410').MM        INVALID GO TO ERROR
         AIF   ('&MODEL' EQ '4' OR '&MODEL' EQ '5' OR '&MODEL' EQ '6'  *
               OR '&MODEL' EQ '8' OR '&UNIT' EQ '2415').MM
    MNOTE *,'        MODE COMPATIBILITY FEATURE'
&SGDF05B(&I)   SETB 1
         AGO   .MORE1
.F8      AIF   (('&MODEL' EQ '4' OR '&MODEL' EQ '5' OR '&MODEL' EQ '6')*
                AND ('&UNIT' NE '2415')).MM
    MNOTE *,'        DATA CONVERSION'
&SGUNF2B(&I)  SETB  1
         AGO   .MORE1
.F8A     ANOP
  MNOTE 5,'* * * IEIIOD114 &ID DUALDENS AND OPT1600 MUTUALLY EXCLUSIVE'
&SGQUITB SETB  1
         AGO   .MORE1
.F9      ANOP
&SGUNF6B(&I) SETB 1
    MNOTE *,'        ALTERNATE CONTROL UNIT'
         AGO   .MORE1
.*****************        TAPE HEAD TYPE      ************************
.HEADTST AIF   ('&UNIT' EQ '3410').HEDTST2
         AIF   ('&UNIT' EQ '3420').HEDTST2
         AIF   (&SGDF01B(&I) OR &SGDF02B(&I)).AP
         AIF   ('&UNIT' EQ '2401' AND '&MODEL' EQ '8').HTST
&SGDF02B(&I)  SETB  1
    MNOTE *,'        9-TRACK HEAD ASSUMED'
         AGO   .AP
.HTST MNOTE *,'        7-TRACK HEAD ASSUMED'
&SGDF01B(&I)  SETB  1
         AGO   .AP
.HEDTST2 AIF   (&SGDM04B(&I) OR &SGDM06B(&I) OR &SGDM08B(&I)).HEADDEN
         AIF   (&SGDF01B(&I) OR &SGDF04B(&I)).TRKTST  7-TRK OR DUALDENS
&DENS    SETC  '1600'
.DF MNOTE *,'    9-TRACK &DENS BPI DEFAULTED'
&SGDF02B(&I) SETB 1
         AGO   .TRKTST
.HEADDEN AIF   (&SGDF01B(&I) OR &SGDF04B(&I) OR &SGDF06B(&I)).TRKTST
&DENS    SETC  '6250'
         AGO   .DF
.TRKTST  AIF   (NOT(&SGDF01B(&I) AND &SGDF04B(&I))).TRKTSTA
    MNOTE 5,'* * * IEIIOD150 &ID 7-TRACK/DUALDENS MUTUALLY EXCLUSIVE FO*
               R THE &UNIT TAPE DRIVE'
&SGQUITB SETB  1
         AGO   .AP
.TRKTSTA AIF   (NOT(&SGDF01B(&I) AND &SGDF06B(&I))).AP
    MNOTE 5,'* * * IEIIOD151 &ID  7-TRACK/OPT1600 MUTUALLY EXCLUSIVE FO*
               R THE &UNIT TAPE DRIVE'
&SGQUITB SETB  1
         AGO   .AP
.T2420   ANOP
&SGDM04B(&I) SETB 1                    MODEL 4 SWITCH
&SGDF02B(&I) SETB 1                    9 TRACK
&SGDCLSB(57)  SETB  1
         AIF   (T'&MODEL NE 'O').E2420                          ZM32768
         AIF   (T'&FEATURE EQ 'O').AP                           ZM32768
&A       SETA  1                                                ZM32768
         AIF   ('&FEATURE(&A)' NE 'ALTCTRL').E2420              ZM32768
&SGUNF6B(&I) SETB 1                                             ZM32768
    MNOTE *,'        ALTERNATE CONTROL UNIT'                    ZM32768
         AGO   .AP
.E2420 MNOTE 5,'IEIIOD153 MODEL AND/OR FEATURE NOT VALID FOR 2420 TAPE *
               UNIT'
&SGQUITB SETB  1
         AGO   .AP
.*******************    TAPE CARTRIDGE READER     *******************
.T2495 MNOTE *,'     2495 TAPE CARTRIDGE READER'
&SGDT07B(&I)   SETB  1                 DEVICE TYPE SWITCH
&SGDU07B(&I)   SETB  1                 UNIT TYPE SWITCH
&SGDCLSB(61)   SETB  1                 2495 CLASS SWITCH
         AGO   .CHECKX
.*******************    OPTICAL CHARACTER READER    ******************
.OPTCHAR MNOTE *,'     &UNIT OPTICAL CHARACTER READER'
&SGDT02B(&I)  SETB  1     DEVICE TYPE FOR OPTICAL READER
.XOPT   AIF  ('&UNIT' NE '1287').YOPT
&SGDU02B(&I)  SETB  1
&SGDCLSB(58)  SETB  1
   AGO  .ZOPT
.YOPT  ANOP
&SGDU03B(&I)  SETB  1
&SGDCLSB(59)  SETB  1
.ZOPT   ANOP
&SGDCLSB(12)  SETB  1
         AGO   .CHECKX
.**********************************************************************
.********************  DIRECT ACCESS DEVICES  *************************
.********************    FIXED HEAD STORAGE   *************************
.**********************************************************************
.D2305 MNOTE *,'     2305 FIXED HEAD STORAGE'
&SGDCLSB(70) SETB 1
&SGDCLSB(40)   SETB  1             OVERFLOW CLASS SWITCH
&SGDF10B(&I)   SETB  1             ERROR LOG PRESENT           @Z40MSTG
&SGDU08B(&I) SETB 1
&SG2305A SETA &SG2305A+1
&ML      SETA  1              ONE OPTIONAL CHANNEL ALLOWED      ZM33354
&MM      SETA  8
         AIF   (T'&MODEL EQ 'O').D2305E1
         AIF   ('&MODEL' EQ '2').D2305M2
         AIF   ('&MODEL' NE '1').D2305E2
         MNOTE *,'     MODEL 1'
&SGDM01B(&I)  SETB  1
&SGDCLSB(75)  SETB  1
         AGO   .DASD
.D2305M2 MNOTE *,'     MODEL 2'
&SGDM02B(&I)  SETB  1
&SGDCLSB(76)  SETB  1
         AGO   .DASD
.D2305E1 MNOTE 5,'* * * IEIIOD104 &ID-MODEL VALUE NOT SPECIFIED'
&SGQUITB SETB 1
         AGO   .DASD               GO TO COMMON DASD ROUTINE
.D2305E2 MNOTE 5,'* * * IEIIOD103 &ID-MODEL VALUE &MODEL INVALID'
&SGQUITB SETB 1
         AGO   .DASD               GO TO COMMON DASD ROUTINE
.**********************************************************************
.************               DISK STORAGE                   ************
.**********************************************************************
.D2314 MNOTE *,'     &UNIT DISK STORAGE'
&SGDU06B(&I)   SETB 1              GLOBAL UNIT SWITCH 6
&SGDCLSB(41)   SETB 1              A 2314 WAS SPECIFIED
&SGDCLSB(40)  SETB  1    OVERFLOW CLASS SWITCH
&ML      SETA  1        ALLOW ONE OPTCHAN PATH                  ZM33354
&MM      SETA  8
         AGO   .DASD               GO TO COMMON DASD ROUTINE
.D3330V MNOTE *,'     3330V DISK STORAGE'
&SGDF03B(&I) SETB   1
&SGDCLSB(69) SETB 1                3330 - MODEL 1
         AGO   .D3330D
.D3330 MNOTE *,'     3330 DISK STORAGE'
&MM      SETA  2                   DEFAULT NO. OF UNITS         G29ASVN
&SGDF10B(&I)   SETB  1             ERROR LOG PRESENT           @Z40MSTG
         AIF   (T'&MODEL NE 'O').D3330A
&SGDCLSB(69) SETB 1                3330 - MODEL 1              AY03612
     MNOTE *,'   MODEL 1 ASSUMED'
         AGO   .D3330D                                         AY03612
.D3330E  MNOTE 5,'* * * IEIOD103 &ID-MODEL VALUE &MODEL INVALID'
&SGQUITB SETB  1
         AGO   .DASD
.D3330A  AIF   ('&MODEL' EQ '1').D3330B
         AIF   ('&MODEL' NE '11').D3330E
&SGDM11B(&I)   SETB   1                 SET MODEL =11
&SGDCLSB(85)   SETB   1                 3330-11 SUPPORT
         AGO .D3330C                                           AY03612
.D3330B  ANOP                                                  AY03612
&SGDCLSB(69) SETB 1                     3330 - MODEL 1         AY03612
.D3330C  MNOTE *,'     MODEL &MODEL'                           AY03612
.D3330D  ANOP                                                  AY03612
&SGDU07B(&I) SETB 1
&SGDCLSB(40)   SETB  1             OVERFLOW CLASS SWITCH
&ML      SETA  1             ALLOW ONE OPTCHAN                  ZM33354
         AGO  .DASD
.D3851   ANOP                                                  @Y30LBOS
&SGDU13B(&I) SETB   1                                          @Y30LBOS
&SGDT07B(&I) SETB   1                                          @Y30LBOS
&SGDCLSB(28) SETB   1                                          @Y30LBOS
&ML      SETA  1               ALLOW ONE OPTCHAN               @ZA00689
         AGO   .DASDA                                          @Y30LBOS
.D3340   MNOTE *,'      3340 DISK STORAGE'
&SGDU09B(&I)   SETB  1                 GLOBAL UNIT SWITCH 9
&SGDF10B(&I)   SETB  1                 ERROR LOG PRESENT       @Z40MSTG
&SGDCLSB(84)   SETB  1                 A 3340 IS SPECIFIED
&SGDCLSB(40)   SETB  1                 OVERFLOW CLASS BIT
&ML      SETA  1                  ALLOW ONE OPTIONAL CHANNEL    ZM33354
&MM      SETA  2
         AGO   .DASD                                           @Z30RSTA
.D3350   MNOTE *,'      3350 DISK STORAGE'                     @Z30RSTA
&SGDCLSB(22)   SETB  1                 A 3350 IS SPECIFIED     @ZM41663
&SGDCLSB(40)   SETB  1                 OVERFLOW CLASS BIT      @Z30RSTA
&SGDU10B(&I)   SETB  1                 GLOBAL UNIT SW 10       @Z30RSTA
&ML      SETA  1                       ALLOW ONE OPT CHANNEL   @ZA30097
&MM      SETA  2                       DEFAULT NUM OF DEVICES  @Z30RSTA
.**********************************************************************
.************       THE FOLLOWING CODE IS COMMON FOR DASD       *******
.**********************************************************************
.DASD    ANOP
&SGDT03B(&I)  SETB  1         SET DEVICE TYPE
.DASDA   ANOP
&SGDASDA  SETA  &SGDASDA+1    COUNT D.A. DEVICES
         AIF   (T'&FEATURE EQ 'O').AP
 MNOTE *,'      FEATURES'
.DASDF   AIF   (&A EQ N'&FEATURE).AP
&A  SETA  &A+1
         AIF   ('&FEATURE(&A)' EQ 'SHARED').DA1
         AIF   ('&FEATURE(&A)' EQ 'RECOFLO').DA2
         AIF   ('&FEATURE(&A)' EQ '2-CHANSW').DA3
         AIF   ('&FEATURE(&A)' EQ 'RPS').DA4
         AIF   ('&FEATURE(&A)' EQ 'ALTCTRL').DA5
         AIF   ('&FEATURE(&A)' EQ 'OLTEP').DA6
         AIF   ('&FEATURE(&A)' EQ 'SHAREDUP').DA7               ZA00805
.*       AGO   .DASDF REMOVED TO ALLOW INVAL FEAT CHECK        @ZA08031
.ERR MNOTE 5,'* * * IEIIOD105 &ID-FEATURE VALUE &FEATURE(&A) INVALID'
&SGQUITB  SETB  1
         AGO   .DASDF
.DA1     AIF   (&SGDF05B(&I)).SHRERR         UP MODE?           ZA00805
     MNOTE *,'        SHARED DASD'
&SGDF02B(&I)  SETB  1
&SGDCLSB(54)  SETB  1
&SGUNF5B(&I)  SETB  1
.* SHARED DASDI AND OFFLINE=YES RESTRCTION REMOVED FOR PTM VS30406
.* LINES 25840002 THRU 26000002 REMOVED FOR THE ABOVE PTM       VS30406
         AGO   .DASDF
.DA2 MNOTE *,'        RECORD OVERFLOW'
&SGUNF2B(&I)  SETB  1
&SGDCLSB(40)  SETB  1
         AGO   .DASDF
.DA3 MNOTE *,'         TWO CHANNEL SWITCH'
&SGDF01B(&I) SETB 1
         AGO   .DASDF
.DA4     AIF   (NOT &SGDU09B(&I)).DA4A       RPS FEATURE FOR 3340
     MNOTE *,'        RPS'
&SGDF01B(&I)   SETB 1
&SGDCLSB(88)   SETB 1
         AGO   .DASDF
.DA4A  MNOTE 5,'* * *IEIIOD205  RPS FEATURE ONLY VALID FOR 3340 '
&SGQUITB   SETB   1
         AGO   .DASDF
.*       2314, 3330, 3340 OR 3350                              @Z30RSTA
.DA5     AIF   (NOT (&SGDT03B(&I) AND (&SGDU06B(&I) OR &SGDU07B(&I)    *
               OR &SGDU09B(&I) OR &SGDU10B(&I)))).ERR          @Z30RSTA
        MNOTE *,'     ALTERNATE CONTROL FEATURE'
&SGDF04B(&I)   SETB 1                   ALTCTRL FOR THIS DEVICE
&SGMENTB(86)   SETB 1                   ALTCTRL SPECIFIED DURING SYSGEN
         AGO   .DASDF
.DA6     AIF   (&SGDT03B(&I) AND &SGDU07B(&I)).DA6A     3330?
     MNOTE 5,'* * *IEIIOD215 &ID-FEATURE VALUE &FEATURE(&A) INVALID, RE*
               QUIRES A 3330'
&SGQUITB   SETB   1                     SET QUIT BIT
         AGO   .DASDF
.DA6A   MNOTE *,'     OLTEP FEATURE'
&SGDF05B(&I) SETB   1                   SET OLTEP FEATURE BIT
         AGO   .DASDF
.DA7     AIF   (&SGDF02B(&I)).SHRERR         SHARED SPECIFIED?  ZA00805
     MNOTE   *,'     UP MODE SUPPORTED FOR THIS DEVICE'         ZA00805
&SGDF05B(&I) SETB   1  UP MODE                                  ZA00805
&SGDF02B(&I) SETB   1  SHARED                                   ZA00805
          AGO   .DASDF                                          ZA00805
.SHRERR MNOTE 5,'IEIIOD250 * * * SHARED DASD AND SHAREDUP MODE ARE MUTU*
               ALLY EXCLUSIVE'
&SGQUITB SETB   1                                               ZA00805
         AGO   .DASDF                                           ZA00805
.**********************************************************************
.*********************** AP CHECKING FOR ******************************
.******************** TAPE AND DIRECT ACCESS  *************************
.**********************************************************************
.AP       AIF   ('&AP' EQ 'NO').CHECKX
          AIF   ('&AP' NE 'YES').PW
&SGDF08B(&I)  SETB  1
&SGCPRGB(13)  SETB  1
    MNOTE *,'     AP SUPPORTED FOR THIS &UNIT'
          AGO   .CHECKX
.PW MNOTE 5,'* * * IEIIOD202 AP VALUE INVALID - MUST BE YES OR NO'
&SGQUITB       SETB 1
          AGO   .CHECKX
.**********************************************************************
.***********         CONSOLES AND DISPLAY UNITS            ************
.**********************************************************************
.K1052 MNOTE *,'     1052 PRINTER KEYBOARD'
&SGDU01B(&I)   SETB 1                   GLOBAL UNIT SWITCH 1
         AIF   (NOT &LOC).AN
         AIF   ('&MODEL' NE '7').AO
&SGDM01B(&I)  SETB  1
    MNOTE *,'      MODEL &MODEL'
         AGO   .CFEAT
.AO MNOTE 5,'* * * IEIIOD103 &ID-MODEL VALUE &MODEL INVALID'
&SGQUITB SETB  1
         AGO   .CFEAT
.AN MNOTE 5,'* * * IEIIOD104 &ID-MODEL VALUE NOT SPECIFIED'
&SGQUITB  SETB  1
         AGO   .CFEAT
.K3210 MNOTE *,'     3210 CONSOLE'
&SGDU03B(&I)  SETB  1
         AGO   .CFEAT
.K3215 MNOTE *,'     3215 CONSOLE'
&SGDU04B(&I)  SETB  1
.CFEAT   ANOP
&SGDT04B(&I)   SETB 1                   GLOBAL TYPE SWITCH 4
&SGDCLSB(6)   SETB  1    CONSOLE PRINTER CLASS
         AGO   .CHECKX
.DIS3036 MNOTE *,'     3036 DISPLAY CONSOLE'                    G51DSPD
&SGDU13B(&I)  SETB 1                    3036 CONSOLE            G51DSPD
&SGDT05B(&I)  SETB 1                    DISPLAY CLASS           G51DSPD
&SGDCLSB(43)  SETB 1                    A 3036 IS PRESENT       G51DSPD
&SGDCLSB(8)   SETB 1                    GRAPHICS DEVICE PRESENT G51DSPD
&SGDCLSB(80)  SETB 1                    ANR DEVICE IN SYSTEM    G51DSPD
&SGDF01B(&I)  SETB 1                    AUDALARM FEATURE        G51DSPD
&SGDF13B(&I)  SETB 1                    OCKY3277 FEATURE        G51DSPD
&SGDF14B(&I)  SETB 1                    KB78KEY FEATURE         G51DSPD
              AGO  .CHECKX              TO COMMON PROCESSING    G51DSPD
&SGDT06B(&I)  SETB  1                   GLOBAL TYPE SWITCH/PRINTER
.DIS3066 MNOTE *,'     3066 DISPLAY CONSOLE'
&SGDT05B(&I) SETB 1
&SGDU06B(&I) SETB 1
&SGDCLSB(8)    SETB  1
&SGDCLSB(60)   SETB  1
&SGDF01B(&I)   SETB  1
         AGO   .CHECKX
.DIS3158 MNOTE *,'     3158 DISPLAY UNIT'
&SGDU10B(&I)   SETB  1                  3158 DEVICE
&SGDCLSB(8)    SETB  1                  GRAPHICS CLASS
&SGDF01B(&I)   SETB  1                  AUDALRM                 OX01412
&SGDF02B(&I)   SETB  1                  SELECTOR PEN
&SGDF13B(&I)   SETB  1                  66-KEY OPERATOR CONSOLE
         AIF   (T'&MODEL EQ 'O').F3158    NO MODEL SPECIFIED
  MNOTE 5,'* * * IEIIOD103 MODEL VALUE &MODEL INVALID;NO MODEL ALLOWED'
&SGQUITB SETB  1
.F3158   AIF   (T'&FEATURE EQ 'O').DCCOM       NO FEATURES FOR 3158
   MNOTE 5,'IEIIOD201 FEATURE(S) SPECIFIED - INVALID THERE ARE NO SPECI*
               AL FEATURES'
&SGQUITB SETB   1
         AGO   .DCCOM
.DIS2250 MNOTE *,'     2250 DISPLAY UNIT'
&SGDT05B(&I) SETB 1                     SET TYPE SWT FOR DISPLAY CONSLE
&SGDU01B(&I) SETB 1                     SET UNIT SWT FOR 2250
&SGDCLSB(8)  SETB  1                    A GRAPHIC TYPE DEV WAS SPECD
&SGDCLSB(9)  SETB  1                    A 2250 DISPLAY STA. WAS SPECD
         AIF   (T'&MODEL EQ 'O').AR     BR ERROR RTN IF MOD VALUE OMITD
         AIF   ('&MODEL' EQ '1' OR '&MODEL' EQ '3').V1
    MNOTE 5,'* * * IEIIOD103 &ID-MODEL VALUE &MODEL INVALID'
&SGQUITB SETB  1
   AGO  .I2
.AR MNOTE 5,'* * * IEIIOD104 &ID-MODEL VALUE NOT SPECIFIED'
&SGQUITB SETB  1                        MOD=INVLD/OMIT-TURN ON ERROR SW
   AGO  .I2
.V1 MNOTE *,'     MODEL &MODEL'
&SGDM01B(&I)  SETB  ('&MODEL' EQ '1')
&SGDM03B(&I)  SETB  ('&MODEL' EQ '3')
         AIF   (&SGDM01B(&I)).I2
         AIF   (T'&PCU EQ 'O').I01
         AIF   (T'&PCU NE 'N').I02
         AIF   (&PCU LT 1 OR &PCU GT 255).I02                  @ZA41353
      MNOTE *,'     &PCU IS PHYSICAL CONTROL UNIT NUMBER'
&SGCNTRA(2)   SETA  &PCU
&IOC     SETB  1       SET LOCAL FOR C.U. OF SGDADRA
         AGO   .I2
.I01 MNOTE 5,'* * * IEIIOD160 &ID-PCU VALUE NOT SPECIFIED'
&SGQUITB SETB  1
         AGO   .I2
.I02 MNOTE 5,'* * * IEIIOD161 &ID-PCU VALUE &PCU INVALID'
&SGQUITB SETB  1
.***********        CONSOLE AND DISPLAY UNIT FEATURES        **********
.I2 AIF (N'&FEATURE EQ 0).NUMSECT
    MNOTE *,'     FEATURE(S) '
.F2250M1 AIF (&Q EQ N'&FEATURE).NUMSECT
&Q       SETA  &Q+1                     IF NOT FINISHD,BUMP CTR & GO ON
  AIF ('&FEATURE(&Q)' EQ 'ALKYB2250').Z1 IS ALPHMERIC KEYBD SPEC'D
  AIF ('&FEATURE(&Q)' EQ 'PRGMKYBD').Z3  IS PRGRMED FNCTN KEYBD SPECFYD
  AIF (&SGDM03B(&I)).AQ  ALL OF FEATURES FOR MODEL 3
  AIF ('&FEATURE(&Q)' EQ 'LIGHTPEN').Z2  IS LIGHT PEN SPECIFIED
  AIF ('&FEATURE(&Q)' EQ 'ABSLTVEC').Z4  IS ABSLTVEC SPECIFIED
  AIF ('&FEATURE(&Q)' EQ 'BUFFER4K').Z5  IS 4K-BYTE BUFFER SPECFYD
  AIF ('&FEATURE(&Q)' EQ 'BUFFER8K').Z6  IS 8K-BYTE BUFFER SPECFYD
  AIF ('&FEATURE(&Q)' EQ 'CHARGNTR').Z7  IS CHRCTR GNRTR SPECFYD
  AIF ('&FEATURE(&Q)' EQ 'DESIGNFEAT').Z8   DESIGNFEAT SPECFYD
.AQ MNOTE 5,'* * * IEIIOD105 &ID-FEATURE VALUE &FEATURE(&Q) INVALID'
&SGQUITB SETB  1
         AGO   .F2250M1                 GO TEST FOR END OF 2250 FEAT.S
.Z1 MNOTE *,'        ALPHAMERIC KEYBOARD '
&SGDF01B(&I) SETB 1                     SET FEAT SW 1 FOR ALPHAMRC KYBD
         AGO   .F2250M1                 GO TEST FOR END OF 2250 FEAT.S
.Z2 MNOTE *,'        LIGHT PEN '
&SGDF02B(&I) SETB 1                     SET FEAT SW 2 FOR LIGHT PEN
         AGO   .F2250M1                 GO TEST FOR END OF 2250 FEAT.S
.Z3 MNOTE *,'        PROGRAMMED FUCNTION KEYBOARD '
&SGDF03B(&I) SETB 1                     SET FEAT SW 3 FOR PRGM FNCT KYB
         AGO   .F2250M1                 GO TEST FOR END OF 2250 FEAT.S
.Z4 MNOTE *,'        ABSOLUTE VECTORS AND CONTROL '
&SGDF04B(&I) SETB 1                     SET FEAT SW 4 FOR ABSLT VEC/CTL
         AGO   .F2250M1                 GO TEST FOR END OF 2250 FEAT.S
.Z5 MNOTE *,'        4K BUFFER '
&SGDF05B(&I) SETB 1                     SET FEAT SW 5 FOR 4K-BYTE BUFER
         AIF   (&SGDF06B(&I)).AQ        IF 8K BUF SPEC THIS DV-GO ER RT
         AGO   .F2250M1                 GO TEST FOR END OF 2250 FEAT.S
.Z6 MNOTE *,'        8K BUFFER '
&SGDF06B(&I) SETB 1                     SET FEAT SW 6 FOR 8K-BYTE BUFFR
         AIF   (&SGDF05B(&I)).AQ        IF 4K BUF SPEC THIS DV-GO ER RT
         AGO   .F2250M1
.Z7 MNOTE *,'        CHARACTER GENERATOR '
&SGDF07B(&I) SETB 1                     SET FEAT SW 7 FOR CHAR GENRATOR
         AGO   .F2250M1                 GO TEST FOR END OF 2250 FEAT.S
.Z8 MNOTE *,'        GRAPHIC DESIGN'
&SGDF09B(&I)  SETB  1
  AGO  .F2250M1
.NUMSECT AIF (T'&NUMSECT EQ 'O').EXPBFR
         AIF    (&SGDM01B(&I)).I3
 AIF (T'&NUMSECT NE 'N').I4
&SGDNBFA(&I) SETA  &NUMSECT
    MNOTE *,'      NUMBER OF 256-BUFFER SECTIONS IS &NUMSECT'
         AGO   .EXPBFR
.I3 MNOTE 5,'* * * IEIIOD136 &ID-NUMSECT INVALID ON 2250 MODEL 1'
&SGQUITB  SETB  1
         AGO   .EXPBFR
.I4 MNOTE 5,'* * * IEIIOD137 &ID-NUMSECT VALUE &NUMSECT INVALID'
&SGQUITB   SETB  1
.EXPBFR  AIF   (T'&EXPBFR NE 'O').ZA
         AIF   (&SGDM01B(&I)).CHECKX
&SGCUN1A(&I)  SETA  4096           SET DEFAULT
&BUF     SETC  'ASSUMED'
         AGO   .ZB
.ZA      AIF   (&SGDM01B(&I)).I5
         AIF   (T'&EXPBFR NE 'N').I6
         AIF   (&EXPBFR LE 0 OR &EXPBFR GT 8192).I6
&SGCUN1A(&I)  SETA  &EXPBFR
.ZB MNOTE *,'     &SGCUN1A(&I) BYTES OF BUFFER SPACE &BUF'
         AGO   .CHECKX
.I5 MNOTE 5,' * * * IEIIOD138 &ID-EXPBFR INVALID ON 2250 MODEL 1'
&SGQUITB  SETB  1
         AGO   .CHECKX
.I6 MNOTE 5,'* * * IEIIOD139 &ID-EXPBFR VALUE &EXPBFR INVALID'
&SGQUITB  SETB  1
         AGO   .CHECKX
.DS2260 MNOTE *,'     2260 DISPLAY STA. FOR ATTACHMENT TO 2848 CTRL'
&SGDT05B(&I)  SETB  1                   SET 5TH TYPE GLBL FOR GRAPHIC
&SGDU02B(&I)  SETB  1                   SET 2ND UNIT GLBL FOR 2260 GRPH
&SGDCLSB(8)  SETB  1                    A DISPLAY TYPE DEV WAS SPECD
&SGDCLSB(10) SETB  1                    A 2260 DISPLAY STATION WAS SPEC
  AIF (T'&MODEL EQ 'O').WA GO TO ERROR ROUTINE IF MODEL OMITTED
  AIF (('&MODEL' EQ '1') OR ('&MODEL' EQ '2')).WB
   MNOTE 5,'* * * IEIIOD103   &ID-MODEL VALUE &MODEL INVALID'
&SGQUITB SETB 1
       AGO   .WZ
.WA MNOTE 5,'* * * IEIIOD104   &ID-MODEL VALUE NOT SPECIFIED'
&SGQUITB SETB 1
        AGO   .WZ
.WB     ANOP
&SGDM01B(&I) SETB ('&MODEL' EQ '1') IF MOD 1 SET 1ST GLOBAL SW
&SGDM02B(&I) SETB ('&MODEL' EQ '2') IF MOD 2 SET 2ND GLOBAL SW
  MNOTE *,'        MODEL &MODEL-DISPLAY STATION'
         AIF   (&SGDM02B(&I)).WB1
&SGUNM3B(&I)  SETB  1              2848-3 FOR 2260-1
    MNOTE *,'     2848-3 GRAPHIC CONTROL UNIT ASSUMED'
         AGO   .WZ
.WB1     AIF   (T'&GCU EQ 'O').WB01
         AIF   ('&GCU' EQ '2848-1' OR '&GCU' EQ '2848-2' OR '&GCU' EQ '*
               2848-21' OR '&GCU' EQ '2848-22').WB2
    MNOTE 5,'* * * IEIIOD171 &ID-GCU VALUE &GCU INVALID'
&SGQUITB SETB  1
         AGO   .WZ
.WB01 MNOTE 5,'* * * IEIIOD170 &ID-GCU VALUE NOT SPECIFIED'
&SGQUITB SETB  1
         AGO   .WZ
.WB2 MNOTE *,'     &GCU GRAPHIC CONTROL UNIT'
&SGUNM1B(&I)  SETB  ('&GCU' EQ '2848-1')
&SGUNM2B(&I)  SETB  ('&GCU' EQ '2848-2')
&SGUNM4B(&I)  SETB  ('&GCU' EQ '2848-21')
&SGUNM5B(&I)  SETB  ('&GCU' EQ '2848-22')
.WZ      AIF   (T'&FEATURE EQ 'O').CHECKX
    MNOTE *,'     FEATURE '
.RELOOP  AIF (&Q EQ N'&FEATURE).CHECKX
&Q     SETA   &Q+1
  AIF  ('&FEATURE(&Q)' EQ 'ALKYB2260').W3
  AIF  ('&FEATURE(&Q)' EQ 'NMKYB2260').W4
 AIF ('&FEATURE(&Q)' EQ 'DEKYB2260').W45
         AIF   ('&FEATURE(&Q)' EQ 'LINEADDR').W46
         AIF   ('&FEATURE(&Q)' EQ 'NODESCUR').W47
.W5 MNOTE 5,'* * * IEIIOD105 &ID-FEATURE VALUE &FEATURE(&Q) INVALID'
&SGQUITB  SETB  1
         AGO   .RELOOP
.W3 MNOTE *,'        ALPHAMERIC KEYBOARD '
&SGDF01B(&I)  SETB  1
 AIF (&SGDF02B(&I) OR &SGDF03B(&I)).W5
         AGO   .RELOOP
.W4 MNOTE *,'        NUMERIC KEYBOARD '
&SGDF02B(&I)  SETB  1
 AIF (&SGDF01B(&I) OR &SGDF03B(&I)).W5
 AGO .RELOOP
.W45 MNOTE *,'       DATA ENTRY KEYBOARD'
&SGDF03B(&I) SETB 1
         AIF   (&SGDF01B(&I) OR &SGDF02B(&I)).W5
         AGO   .RELOOP
.W46 MNOTE *,'        LINE ADDRESSING'
&SGUNF1B(&I)  SETB  1
         AGO   .RELOOP
.W47 MNOTE *,'        NON-DESTRUCTIVE CURSOR'
&SGUNF2B(&I)  SETB  1
         AGO   .RELOOP
.DIS1053 MNOTE *,'     1053 PRINTER ATTACHED TO 2848 CONTROL UNIT'
&SGDT05B(&I)  SETB  1    GRAPHIC
&SGDU03B(&I)  SETB  1    1053
&SGDCLSB(8)   SETB  1    DISPLAY DEVICE
&SGDCLSB(39)  SETB  1    1053/2848 CLASS SWITCH
         AIF   (T'&MODEL EQ 'O').V3
         AIF   ('&MODEL' NE '4').V4
&SGDM04B(&I)  SETB  1
         AGO   .CHECKX
.V3 MNOTE 5,'* * * IEIIOD104 &ID-MODEL VALUE NOT SPECIFIED'
&SGQUITB  SETB  1
         AGO   .CHECKX
.V4 MNOTE 5,'* * * IEIIOD103 &ID-MODEL VALUE &MODEL INVALID'
&SGQUITB SETB  1
         AGO   .CHECKX
.DC3277 MNOTE *,'     3277 DISPLAY UNIT'
&SGDU08B(&I)   SETB  1
&SGDCLSB(8)  SETB  1          GRAPHICS CLASS
         AGO   .DCMOD
.DC3284 MNOTE *,'     3284 PRINTER'
&SGDU09B(&I)   SETB  1
         AGO   .DCMOD
.DC3286 MNOTE *,'     3286 PRINTER'
&SGDU07B(&I)   SETB  1
.DCMOD   AIF   (T'&MODEL EQ 'O').DCE1
         AIF   ('&MODEL' EQ '1' OR '&MODEL' EQ '2').DCM
    MNOTE 5,'* * * IEIIOD103 MODEL VALUE &MODEL INVALID'
&SGQUITB SETB  1
         AGO   .DCCOM
.DCE1  MNOTE 5,'* * * IEIIOD104 &ID-MODEL VALUE NOT SPECIFIED'
&SGQUITB SETB  1
         AGO   .DCCOM
.DCM MNOTE *,'     MODEL &MODEL'
&SGDM01B(&I)  SETB  ('&MODEL' EQ '1')
&SGDM02B(&I)  SETB  ('&MODEL' EQ '2')
.DCCOM    ANOP      COMMON TO 3158, 3277, 3284, 3286
&SGDT05B(&I)  SETB  1                           TYPE SWITCH
&SGDCLSB(80)  SETB  1                           CLASS SWITCH
         AIF   (&SGDU10B(&I)).CHECKX           3158
.DCFCHK  AIF   (NOT &SGDU08B(&I)).FEATCK       NOT 3277
         AIF   (T'&FEATURE EQ 'O').DCXF
     MNOTE *,'     FEATURE(S)'
.DCFT    AIF   (&Q EQ N'&FEATURE).DCXF
&Q       SETA  &Q+1
         AIF   ('&FEATURE(&Q)' EQ 'AUDALRM').DC01
         AIF   ('&FEATURE(&Q)' EQ 'SELPEN').DC02
         AIF   ('&FEATURE(&Q)' EQ 'MAGCDRD').DC03
         AIF   ('&FEATURE(&Q)' EQ 'NUMLOCK').DC04
         AIF   ('&FEATURE(&Q)' EQ 'DOCHAR').DC045
         AIF   ('&FEATURE(&Q)' EQ 'ASCACHAR').DC05
         AIF   ('&FEATURE(&Q)' EQ 'ASCBCHAR').DC06
         AIF   ('&FEATURE(&Q)' EQ 'UKCHAR').DC07
         AIF   ('&FEATURE(&Q)' EQ 'FRCHAR').DC08
         AIF   ('&FEATURE(&Q)' EQ 'GRCHAR').DC09
         AIF   ('&FEATURE(&Q)' EQ 'KACHAR').DC09A
         AIF   ('&FEATURE(&Q)' EQ 'EBKY3277').DC10
         AIF   ('&FEATURE(&Q)' EQ 'ASKY3277').DC11
         AIF   ('&FEATURE(&Q)' EQ 'DEKY3277').DC12
         AIF   ('&FEATURE(&Q)' EQ 'OCKY3277').DC13
         AIF   ('&FEATURE(&Q)' EQ 'KB70KEY').DC13A
         AIF   ('&FEATURE(&Q)' EQ 'KB78KEY').DC14
         AIF   ('&FEATURE(&Q)' EQ 'KB81KEY').DC14A
         AIF   ('&FEATURE(&Q)' EQ 'PTREAD').DC16               @ZA41353
     MNOTE 5,'* * * IEIIOD105 &ID-FEATURE VALUE &FEATURE(&Q) INVALID'
&SGQUITB SETB  1
         AGO   .DCFT
.DC01 MNOTE *,'        AUDIBLE ALARM'
&SGDF01B(&I)   SETB  1
         AGO   .DCFT
.DC02 MNOTE *,'        SELECTOR PEN'
&SGDF02B(&I)   SETB  1
         AGO   .DCFT
.DC03 MNOTE *,'        MAGNETIC CARD READER ADAPTER'
&SGDF03B(&I)   SETB  1
         AGO   .DCFT
.DC04 MNOTE *,'        NUMERIC LOCK'
&SGDF04B(&I)   SETB  1
         AGO   .DCFT
.DC045   AIF   (&SGDF05B(&I) OR &SGDF06B(&I) OR &SGDF07B(&I) OR &SGDF08*
               B(&I) OR &SGDF09B(&I) OR &SGDF15B(&I)).DCE2
    MNOTE *,'        DOMESTIC CHARACTER GENERATOR'
&AB      SETB  1
         AGO   .DCFT
.DC05    AIF   (&SGDF06B(&I) OR &SGDF07B(&I) OR &SGDF08B(&I) OR &SGDF09*
               B(&I) OR &SGDF15B(&I) OR &AB).DCE2
      MNOTE *,'        ASCII A CHARACTER GENERATOR'
&SGDF05B(&I)   SETB  1
         AGO   .DCFT
.DC06    AIF   (&SGDF05B(&I) OR &SGDF07B(&I) OR &SGDF08B(&I) OR &SGDF09*
               B(&I) OR &SGDF15B(&I) OR &AB).DCE2
      MNOTE *,'        ASCII B CHARACTER GENERATOR'
&SGDF06B(&I)   SETB  1
         AGO   .DCFT
.DC07    AIF   (&SGDF05B(&I) OR &SGDF06B(&I) OR &SGDF08B(&I) OR &SGDF09*
               B(&I) OR &SGDF15B(&I) OR &AB).DCE2
      MNOTE *,'        UNITED KINGDOM CHARACTER GENERATOR'
&SGDF07B(&I)   SETB  1
         AGO   .DCFT
.DC08    AIF   (&SGDF05B(&I) OR &SGDF06B(&I) OR &SGDF07B(&I) OR &SGDF09*
               B(&I) OR &SGDF15B(&I) OR &AB).DCE2
      MNOTE *,'        FRENCH CHARACTER GENERATOR'
&SGDF08B(&I)   SETB  1
         AGO   .DCFT
.DC09    AIF   (&SGDF05B(&I) OR &SGDF06B(&I) OR &SGDF07B(&I) OR &SGDF08*
               B(&I) OR &SGDF15B(&I) OR &AB).DCE2
      MNOTE *,'        GERMAN CHARACTER GENERATOR'
&SGDF09B(&I)   SETB 1
         AGO   .DCFT
.DC09A   AIF   (&SGDF05B(&I) OR &SGDF06B(&I) OR &SGDF07B(&I) OR &SGDF08*
               B(&I) OR &SGDF09B(&I) OR &AB).DCE2
    MNOTE *,'        KATAKANA CHARACTER GENERATOR'
&SGDF15B(&I)   SETB  1
         AGO   .DCFT
.DC10    AIF   (&SGDF11B(&I) OR &SGDF12B(&I) OR &SGDF13B(&I)).DCE3
         AIF   (&KB7).DCE5                   70-KEY INVALID
    MNOTE *,'        EBCDIC TYPEWRITER KEYBOARD'
&SGDF10B(&I)   SETB  1
         AGO   .DCFT
.DC11    AIF   (&SGDF10B(&I) OR &SGDF12B(&I) OR &SGDF13B(&I)).DCE3
         AIF   (&KB7 OR &KB8).DCE7           70/81-KEY INVALID
    MNOTE *,'        ASCII TYPEWRITER KEYBOARD'
&SGDF11B(&I)   SETB  1
         AGO   .DCFT
.DC12    AIF   (&SGDF10B(&I) OR &SGDF11B(&I) OR &SGDF13B(&I)).DCE3
         AIF   (&SGDF14B(&I)).DCE4           78-KEY INVALID
         AIF   (&KB8).DCE8                   81-KEY INVALID
    MNOTE *,'        DATA ENTRY KEYBOARD'
&SGDF12B(&I)   SETB  1
         AGO   .DCFT
.DC13    AIF   (&SGDF10B(&I) OR &SGDF11B(&I) OR &SGDF12B(&I)).DCE3
         AIF   (&KB7 OR &KB8).DCE10          70/81-KEY INVALID
    MNOTE *,'        78-KEY OPERATOR CONSOLE KEYBOARD'
&SGDF13B(&I)   SETB  1
&SGDF14B(&I)   SETB 1                78-KEY DEFAULTED
         AGO   .DCFT
.DC13A   AIF   (&KB8 OR &SGDF14B(&I)).DCE11
         AIF   (&SGDF10B(&I) OR &SGDF11B(&I) OR &SGDF13B(&I)).DCE12
    MNOTE *,'        70-KEY KEYBOARD'
&KB7     SETB  1
         AGO   .DCFT
.DC14    AIF   (&SGDF12B(&I)).DCE4
         AIF   (&SGDF15B(&I)).DCE14
         AIF   (&KB7 OR &KB8).DCE11
    MNOTE *,'        78-KEY KEYBOARD'
&SGDF14B(&I)   SETB 1
         AGO   .DCFT
.DC14A   AIF   (&KB7 OR &SGDF14B(&I)).DCE11
         AIF   (&SGDF11B(&I) OR &SGDF12B(&I) OR &SGDF13B(&I)).DCE13
    MNOTE *,'        81-KEY KEYBOARD'
&KB8     SETB  1
&SGDF14B(&I)   SETB 1
         AGO   .DCFT
.DC16    ANOP                                                  @ZA41353
.*                    FEATURE INDICATES A 3274-1D CONTROL UNIT @ZA41353
    MNOTE *,'        PTREAD FEATURE'                           @ZA41353
&SGDF16B(&I)   SETB 1                                          @ZA41353
         AGO   .DCFT                                           @ZA41353
.DCE2 MNOTE 5,'* * * IEIIOD129 ONLY ONE CHARACTER GENERATOR ALLOWED'
         AGO   .DCEZ
.DCE3 MNOTE 5,'* * * IEIIOD130 ONLY ONE KEYBOARD ALLOWED'
         AGO   .DCEZ
.DCE4 MNOTE 5,'* * * IEIIOD131 KB78KEY INVALID WITH DEKY3277'
         AGO   .DCEZ
.DCE5 MNOTE 5,'* * * IEIIOD132 KB70KEY INVALID WITH EBKY3277'
         AGO   .DCEZ
.DCE6 MNOTE 5,'* * * IEIIOD142 81-KEY EBCDIC KEYBOARD IS VALID ONLY IF *
               KACHAR HAS BEEN SPECIFIED'
&SGQUITB SETB  1
         AGO   .DCXF5
.DCE7 MNOTE 5,'* * * IEIIOD143 ASCII KEYBOARD NOT VALID WITH 70-KEY OR *
               81-KEY KEYBOARD'
         AGO   .DCEZ
.DCE8 MNOTE 5,'* * * IEIIOD144 KB81KEY INVALID WITH DEKY3277'
         AGO   .DCEZ
.DCE9 MNOTE 5,'* * * IEIIOD146 70-KEY DATA ENTRY KEYBOARD IS VALID ONLY*
                IF KACHAR HAS BEEN SPECIFIED'
&SGQUITB SETB  1
         AGO   .DCXF5
.DCE10 MNOTE 5,'* * * IEIIOD147 OPERATOR CONSOLE KEYBOARD NOT VALID WIT*
               H 70-KEY OR 81-KEY KEYBOARD'
         AGO   .DCEZ
.DCE11 MNOTE 5,'* * * IEIIOD148 MULTIPLE KEYBOARD KEY TYPES - INVALID -*
                ONLY ONE KEYBOARD KEY TYPE ALLOWED'
         AGO   .DCEZ
.DCE12 MNOTE 5,'* * * IEIIOD149 KB70KEY VALID ONLY WITH DEKY3277'
         AGO   .DCEZ
.DCE12A MNOTE 5,'* * * IEIIOD149 KB70KEY VALID ONLY WITH DEKY3277'
&SGQUITB SETB  1
         AGO   .DCXF5
.DCE13 MNOTE 5,'* * * IEIIOD154 KB81KEY VALID ONLY WITH EBKY3277'
         AGO   .DCEZ
.DCE13A MNOTE 5,'* * * IEIIOD154 KB81KEY VALID ONLY WITH EBKY3277'
&SGQUITB SETB  1
         AGO   .DCXF5
.DCE14 MNOTE 5,'* * * IEIIOD155 KB78KEY INVALID WITH KACHAR'
.DCEZ    ANOP
&SGQUITB SETB  1
         AGO   .DCFT
.DCXF    AIF   (&AB OR &SGDF05B(&I) OR &SGDF06B(&I) OR &SGDF07B(&I) OR *
               &SGDF08B(&I) OR &SGDF09B(&I) OR &SGDF15B(&I)).DCXF1
    MNOTE 0,'IEIIODW05 NO CHARACTER GENERATOR SPECIFIED - DOMESTIC ASSU*
               MED'
.DCXF1   AIF   (T'FEATURE EQ 'O').CHECKX
         AIF   (&SGDF15B(&I)).DCXF2          KACHAR
         AIF   (&KB7).DCXF3                  KB70KEY
         AIF   (&KB8).DCXF4                  KB81KEY
         AGO   .DCXF5
.DCXF2   AIF   ((&KB7 AND &SGDF12B(&I)) OR (&KB8 AND &SGDF10B(&I))).DCX*
               F5
         AIF   (NOT (&SGDF10B(&I) OR &SGDF11B(&I) OR &SGDF12B(&I) OR &S*
               GDF13B(&I) OR &KB7 OR &KB8 OR &SGDF14B(&I))).DCXF5
       MNOTE 5,'* * * IEIIOD156 KATAKANA CHARACTER GENERATOR IS VALID O*
               NLY WITH 70-KEY DATA ENTRY KEYBOARD AND/OR 81-KEY EBCDIC*
                KEYBOARD'
&SGQUITB SETB  1
         AGO   .DCXF5
.DCXF3   AIF   (NOT &SGDF12B(&I)).DCE12A     DATA ENTRY KEYBOARD
         AIF   (NOT &SGDF15B(&I)).DCE9       KACHAR
         AGO   .DCXF5
.DCXF4   AIF   (NOT &SGDF10B(&I)).DCE13A     EBCDIC KEYBOARD
         AIF   (NOT &SGDF15B(&I)).DCE6       KACHAR
.DCXF5   AIF   (NOT &SGDF01B(&I)).CHECKX     AUDALRM
         AIF   (&SGDF10B(&I) OR &SGDF11B(&I) OR &SGDF12B(&I) OR &SGDF13*
               B(&I)).CHECKX
    MNOTE 5,'* * * IEIIOD157 AUDALRM INVALID WITHOUT A KEYBOARD'
&SGQUITB SETB  1
         AGO   .CHECKX
.FEATCK  AIF   (T'&FEATURE EQ 'O').PRXF
    MNOTE *,'     FEATURE(S)'
.PRFT    AIF   (&Q EQ N'&FEATURE).PRXF
&Q       SETA  &Q+1
         AIF   ('&FEATURE(&Q)' EQ 'UKCHAR').FEAT1
         AIF   ('&FEATURE(&Q)' EQ 'FRCHAR').FEAT2
         AIF   ('&FEATURE(&Q)' EQ 'GRCHAR').FEAT3
         AIF   ('&FEATURE(&Q)' EQ 'KACHAR').FEAT4
         AIF   ('&FEATURE(&Q)' EQ 'DOCHAR').FEAT5
         AIF   ('&FEATURE(&Q)' EQ 'PTREAD').FEAT6              @ZA41353
    MNOTE 5,'* * * IEIIOD158 &ID-FEATURE VALUE &FEATURE(&Q) INVALID'
&SGQUITB SETB  1
         AGO   .PRFT
.FEAT1   AIF (&SGDF08B(&I) OR &SGDF09B(&I) OR &SGDF15B(&I) OR &DOC).MCG
    MNOTE *,'        UNITED KINGDOM CHARACTER GENERATOR'
&SGDF07B(&I)   SETB 1
         AGO   .PRFT
.FEAT2   AIF (&SGDF07B(&I) OR &SGDF09B(&I) OR &SGDF15B(&I) OR &DOC).MCG
    MNOTE *,'        FRENCH CHARACTER GENERATOR'
&SGDF08B(&I)   SETB 1
         AGO   .PRFT
.FEAT3   AIF (&SGDF07B(&I) OR &SGDF08B(&I) OR &SGDF15B(&I) OR &DOC).MCG
    MNOTE *,'        GERMAN CHARACTER GENERATOR'
&SGDF09B(&I)   SETB 1
         AGO   .PRFT
.FEAT4   AIF (&SGDF07B(&I) OR &SGDF08B(&I) OR &SGDF09B(&I) OR &DOC).MCG
    MNOTE *,'        KATAKANA CHARACTER GENERATOR'
&SGDF15B(&I)   SETB 1
         AGO   .PRFT
.FEAT5   AIF (&SGDF07B(&I) OR &SGDF08B(&I) OR &SGDF09B(&I) OR &SGDF15B(*
               &I)).MCG
    MNOTE *,'        DOMESTIC CHARACTER GENERATOR'
&DOC     SETB  1
         AGO   .PRFT
.FEAT6   ANOP            PTREAD FEATURE IF ATTACHED TO 3274-1D @ZA41353
    MNOTE *,'        PTREAD FEATURE'                           @ZA41353
&SGDF16B(&I)   SETB  1                                         @ZA41353
         AGO   .PRFT                                           @ZA41353
.PRXF    AIF (&SGDF07B(&I) OR &SGDF08B(&I) OR &SGDF09B(&I) OR &SGDF15B(*
               &I) OR &DOC).CHECKX
    MNOTE 0,'* * * IEIIODW05 NO CHARACTER GENERATOR SPECIFIED WITH PRIN*
               TER; DOMESTIC ASSUMED'
         AGO   .CHECKX
.MCG MNOTE 5,'* * * IEIIOD105 MULTIPLE CHARACTER GENERATORS - INVALID -*
                ONLY ONE CHARACTER GENERATOR ALLOWED'
&SGQUITB SETB  1
         AGO   .PRFT
.**********************************************************************
.************                   PRINTERS                     **********
.**********************************************************************
.PRT2245 MNOTE *,'     2245 PRINTER'
&SGDT06B(&I) SETB 1                     SET TYPE SW
&SGDU07B(&I) SETB 1                     SET UNIT SW
&SGDCLSB(74) SETB 1                     2245 PRINTER
         AIF (T'&MODEL NE 'O').KJ1      ERROR IF MODEL SPECD
.KJF     AIF (T'&FEATURE NE 'O').KJ2    ERROR IF FEATURE SPECD
         AGO   .CHECKX
.KJ1 MNOTE 5,'* * * IEIIOD200 MODEL VALUE SPECIFIED - INVALID; THERE AR*
               E NO MODEL NUMBERS'
&SGQUITB SETB 1
         AGO   .KJF
.KJ2 MNOTE 5,'* * * IEIIOD201 FEATURE(S) SPECIFIED - INVALID; THERE ARE*
                NO SPECIAL OR OPTIONAL FEATURES'
&SGQUITB SETB 1
         AGO   .CHECKX
.PRT1403 MNOTE *,'     1403 PRINTER'
&SGDU01B(&I)  SETB  1    UNIT SWITCH
&SGDCLSB(23)  SETB  1    1403 PRINTER
         AIF   (NOT &LOC).AS  MODEL SPECIFIED
         AIF   ('&MODEL' EQ 'N1' OR '&MODEL' EQ '2' OR '&MODEL' EQ '7')*
               .N1
    MNOTE 5,'* * * IEIIOD103 &ID-MODEL VALUE &MODEL INVALID'
&SGQUITB SETB  1
         AGO   .CHECKX
.AS MNOTE 5,'* * * IEIIOD104 &ID-MODEL VALUE NOT SPECIFIED'
&SGQUITB SETB  1                        MOD=INVLD/OMIT-TURN ON ERROR SW
   AGO  .CHECKX
.N1 MNOTE *,'     MODEL &MODEL'
&SGDM01B(&I)  SETB  ('&MODEL' EQ 'N1')
&SGDM02B(&I)  SETB  ('&MODEL' EQ '2')
&SGDM04B(&I)  SETB  ('&MODEL' EQ '7')
         AIF   (T'&FEATURE EQ 'O').COMPRT
    MNOTE *,'     FEATURE'
.FMOD123 AIF   (&Q EQ N'&FEATURE).COMPRT
&Q       SETA  &Q+1
         AIF   (&SGDM04B(&I)).N2  NO FEATURES FOR MODEL 7
         AIF   ('&FEATURE(&Q)' EQ 'UNVCHSET').N3
.N2 MNOTE 5,'* * * IEIIOD105 &ID-FEATURE VALUE &FEATURE(&Q) INVALID'
&SGQUITB  SETB  1
         AGO   .FMOD123
.N3 MNOTE *,'        UNIVERSAL CHARACTER SET'
&SGDF02B(&I)  SETB  1
&SGDCLSB(55)  SETB  1
         AGO   .FMOD123
.PRT1404 MNOTE *,'     1404 PRINTER'
&SGDU02B(&I)  SETB  1    UNIT SWITCH
&SGDCLSB(24)  SETB  1    1404 PRINTER
         AIF   (T'&MODEL EQ 'O').O1     GO TO ERROR RTN IF MODEL OMITTD
         AIF   ('&MODEL' EQ '2').O2
    MNOTE 5,'* * * IEIIOD103 &ID-MODEL VALUE &MODEL INVALID'
&SGQUITB SETB  1
         AGO   .COMPRT
.O1 MNOTE 5,'* * * IEIIOD104 &ID-MODEL VALUE NOT SPECIFIED'
&SGQUITB SETB  1                        MOD=INVLD/OMIT-TURN ON ERROR SW
         AGO   .COMPRT
.O2 MNOTE *,'     MODEL 2 '
&SGDM02B(&I) SETB 1
         AGO   .COMPRT
.PRT1443 MNOTE *,'     1443 PRINTER'
&SGDU03B(&I)  SETB  1     UNIT=1443
&SGDCLSB(25)  SETB  1    1443 CLASS
         AIF   (NOT &LOC).AT     MODEL MUST BE SPECIFIED
         AIF   ('&MODEL' EQ 'N1').P1
    MNOTE 5,'* * * IEIIOD103 &ID-MODEL VALUE &MODEL INVALID'
&SGQUITB SETB  1
         AGO   .PRTFEAT
.AT MNOTE 5,'* * * IEIIOD104 &ID-MODEL VALUE NOT SPECIFIED'
&SGQUITB SETB  1
         AGO   .PRTFEAT
.P1 MNOTE *,'     MODEL N1'
&SGDM01B(&I)  SETB  1
.PRTFEAT AIF   (T'&FEATURE EQ 'O').COMPRT
    MNOTE *,'     FEATURE(S)'
.F1443M1 AIF   (&Q EQ N'&FEATURE).COMPRT
&Q       SETA  &Q+1
         AIF ('&FEATURE(&Q)' EQ 'SELCHSET').P2
         AIF ('&FEATURE(&Q)' EQ '24ADDPOS').P3
    MNOTE 5,'* * * IEIIOD105 &ID-FEATURE VALUE &FEATURE(&Q) INVALID'
&SGQUITB SETB  1
         AGO   .F1443M1
.P2 MNOTE *,'        SELECTIVE CHARACTER SET'
&SGDF02B(&I)  SETB  1
         AGO   .F1443M1
.P3 MNOTE *,'        24 ADDITIONAL PRINT POSITIONS'
&SGDF01B(&I)  SETB  1
         AGO   .F1443M1
.PRT3211 MNOTE *,'     3211 PRINTER'
&SGDU06B(&I)  SETB  1    UNIT SWITCH
&SGDCLSB(71)  SETB  1    3211 PRINTER
.COMPRT  ANOP
&SGDT06B(&I)  SETB  1    DEVICE TYPE - PRINTER
         AGO   .CHECKX
.PRT3800 MNOTE *,'     3800 PRINTER'                           @Z40MSTG
         MNOTE *,'          FEATURES'                          @Z40MSTG
&SGDT06B(&I)  SETB  1                                          @Z40MSTG
&SGDU10B(&I)  SETB  1                                          @Z40MSTG
&SGDCLSB(81)  SETB  1                                          @Z40MSTG
&SGDF10B(&I)  SETB  1                                          @Z40MSTG
&ML      SETA  1         ALLOW ONLY ONE ALTERNATE CHANNEL      @Z40MSTG
.PRT38FE AIF   (&Q EQ N'&FEATURE).PRT38DF                      @Z40MSTG
&Q       SETA  &Q+1                                            @Z40MSTG
         AIF   ('&FEATURE(&Q)' EQ 'BURSTER').PRT38F1           @Z40MSTG
         AIF   ('&FEATURE(&Q)' EQ 'CGS1').PRT38F2              @Z40MSTG
         AIF   ('&FEATURE(&Q)' EQ 'CGS2').PRT38F3              @Z40MSTG
         MNOTE 5,'* * * IEIIOD105 &ID-FEATURE VALUE &FEATURE(&Q) INVALIX
               D'                                              @Z40MSTG
&SGQUITB SETB  1                                               @Z40MSTG
         AGO   .PRT38FE                                        @Z40MSTG
.PRT38F1 MNOTE *,'              BURSTER/TRIMMER/SHEET STACKER' @Z40MSTG
&SGDF07B(&I)  SETB  1                                          @Z40MSTG
         AGO   .PRT38FE                                        @Z40MSTG
.PRT38F2 AIF   (&SGDF02B(&I)).PRT38ER                          @Z40MSTG
         MNOTE *,'               BASIC CHARACTER GENERATION STORAGE INSX
               TALLED'                                         @Z40MSTG
&SGDF01B(&I)  SETB  1                                          @Z40MSTG
         AGO   .PRT38FE                                        @Z40MSTG
.PRT38F3 AIF   (&SGDF01B(&I)).PRT38ER                          @Z40MSTG
         MNOTE *,'               ADDITIONAL CHARACTER GENERATION STORAGX
               E INSTALLED'                                    @Z40MSTG
&SGDF02B(&I)  SETB  1                                          @Z40MSTG
         AGO   .PRT38FE                                        @Z40MSTG
.PRT38ER MNOTE 5,'* * * IEIIOD105 MULTIPLE SPECIFICATION OF CHARACTER GX
               ENERATION STORAGE - INVALID - ONLY ONE SPECIFICATION ALLX
               OWED'                                           @Z40MSTG
&SGQUITB  SETB  1                                              @Z40MSTG
         AGO   .PRT38FE                                        @Z40MSTG
.PRT38DF AIF   (&SGDF01B(&I) OR &SGDF02B(&I)).CHECKX           @Z40MSTG
         MNOTE *,'               BASIC CHARACTER GENERATION STORAGE DEFX
               AULTED'                                         @Z40MSTG
&SGDF01B(&I)  SETB  1                                          @Z40MSTG
         AGO   .CHECKX                                         @Z40MSTG
.PRT3213 MNOTE *,'     3213 CONSOLE'
&SGDU08B(&I)  SETB  1                   3213 DEVICE
&SGDT06B(&I)  SETB  1                   PRINTER TYPE SWITCH 4
&SGDCLSB(6)   SETB  1                   CONSOLE PRINTER CLASS
         AGO   .CHECKX
.**********************************************************************
.***************         READERS AND PUNCHES           ****************
.**********************************************************************
.CHKRDR  ANOP
&CHKSW  SETB  1
&SGDT06B(&I) SETB 1
   AIF  ('&UNIT' EQ '1275').CHK1275
&SGDU04B(&I) SETB 1
&SGDCLSB(65) SETB 1
   MNOTE *,'      1419 MAGNETIC CHECK READER'
         AGO   .CHECKX
.D3895  MNOTE *,'      3895 DOCUMENT READER-INSCRIBER'         G30HSVN
&SGDT06B(&I) SETB   1                                          G30HSVN
&SGDU09B(&I) SETB   1                                          G30HSVN
&SGDCLSB(26) SETB   1                                          G30HSVN
&SGDF10B(&I) SETB   1                                          G30HSVN
         AGO   .CHECKX                                         G30HSVN
.CHK1275  ANOP
&SGDU05B(&I)  SETB  1
&SGDCLSB(66)  SETB  1
    MNOTE *,'      1275 OPTICAL CHECK READER'
         AGO   .CHECKX
.CRP1442 MNOTE *,'     1442 CARD DEVICE'
&SGDU01B(&I)  SETB  1
         AIF   (NOT &LOC).M4
         AIF   ('&MODEL' EQ 'N1').M1
         AIF   ('&MODEL' EQ 'N2').M2
.M3 MNOTE 5,'* * * IEIIOD103 &ID-MODEL VALUE &MODEL INVALID'
&SGQUITB  SETB 1
         AGO   .SAMEFET
.M4 MNOTE 5,'* * * IEIIOD104 &ID-MODEL VALUE NOT SPECIFIED'
&SGQUITB  SETB 1
         AGO   .SAMEFET
.M1 MNOTE *,'     MODEL &MODEL-CARD READER PUNCH'
&SGDM01B(&I)  SETB  1
         AIF   ('&UNIT' EQ '1442').MM1
&SGDCLSB(17)  SETB  1         2520
         AGO   .SAMEFET
.MM1     ANOP
&SGDCLSB(14)  SETB  1
         AGO   .SAMEFET
.M2 MNOTE *,'     MODEL &MODEL-CARD PUNCH'
&SGDM02B(&I)  SETB  1
         AIF   ('&UNIT' EQ '1442').MM2
&SGDCLSB(18)  SETB  1         2520
         AGO   .SAMEFET
.MM2     ANOP
&SGDCLSB(15)  SETB  1
         AGO   .SAMEFET
.CR2501 MNOTE *,'     2501 CARD READER'
&SGDU02B(&I)  SETB  1
&SGDCLSB(16)  SETB  1
         AIF   (NOT &LOC).M4
         AIF   ('&MODEL' NE 'B1' AND '&MODEL' NE 'B2').M3
&SGDM01B(&I)  SETB  ('&MODEL' EQ 'B1')
&SGDM02B(&I)  SETB  ('&MODEL' EQ 'B2')
         AGO   .SAMEFET
.CRP2520 MNOTE *,'     2520 CARD DEVICE'
&SGDU03B(&I)  SETB  1
         AIF   (NOT &LOC).M4
         AIF   ('&MODEL' EQ 'B1').M1
         AIF   ('&MODEL' EQ 'B2').M2
         AIF   ('&MODEL' NE 'B3').M3
    MNOTE *,'     MODEL B3 CARD PUNCH'
&SGDM03B(&I)  SETB  1
&SGDCLSB(18)  SETB  1
         AGO   .SAMEFET
.CR2540 MNOTE *,'     2540 CARD READER'
&SGDU04B(&I)  SETB  1
&SGDCLSB(19)  SETB  1
         AGO   .MODCHK
.CP2540 MNOTE *,'     2540 CARD PUNCH'
&SGDU05B(&I)  SETB  1
&SGDCLSB(20)  SETB  1
.MODCHK  AIF   (NOT &LOC).M4
         AIF   ('&MODEL' NE '1').M3
&SGDM01B(&I)  SETB  1
    MNOTE *,'     MODEL 1'
         AGO   .SAMEFET
.CR3505 MNOTE *,'      3505 CARD READER'
&SG3505A SETA  &SG3505A+1               COUNT OF 3505 RDRS
&SGDU08B(&I)   SETB 1                   3505 RDR
&SGDCLSB(78)   SETB 1                   3505 IN SYSTEM
         AIF   (T'&MODEL EQ 'O').SAMEFET
.NO  MNOTE 5,'* * * IEIIOD200 MODEL VALUE SPECIFIED - INVALID THERE ARE*
               NO MODEL NUMBERS'
&SGQUITB SETB 1
         AGO   .SAMEFET
.CP3525 MNOTE *,'      3525 CARD PUNCH'
&SG3525A SETA  &SG3525A+1               COUNT OF 3525 PCHS
&SGDU09B(&I)   SETB 1                   3525 PCH
&SGDCLSB(79)   SETB 1                   3525 IN SYSTEM
         AIF   (T'&MODEL NE 'O').NO
         AGO   .SAMEFET
.DIS3540 MNOTE *,'     3540 DISKETTE'                            @Y30OS
&SGDT07B(&I) SETB   1                                            @Y30OS
&SGDU12B(&I) SETB   1                                            @Y30OS
&SGDCLSB(27) SETB   1                                            @Y30OS
         AGO   .CHECKX                                           @Y30OS
.RDR2671 MNOTE *,'     2671 PAPER TAPE READER'
&SGDU06B(&I)  SETB  1
&SGDCLSB(21)  SETB  1
         AGO   .MODCHK
.RD3886  MNOTE *,'     3886 OPTICAL MARK READER'
&SGDU10B(&I)   SETB   1
&SGDCLSB(87)   SETB   1
               AGO  .TYPCLAS
.RD3890  MNOTE *,'     3890 MAGNETIC READER/SORTER'
&SGDU11B(&I)   SETB   1
&SGDCLSB(86)   SETB   1
               AGO    .TYPCLAS
.SAMEFET AIF   ('&UNIT' EQ '2671').TYPCLAS
         AIF   (T'&FEATURE EQ 'O').TYPCLAS
    MNOTE *,'     FEATURE'
.T1      AIF   (&Q EQ N'&FEATURE).TYPCLAS
&Q       SETA  &Q+1
         AIF   ('&FEATURE(&Q)' EQ 'CARDIMAGE').T2
         AIF   (NOT &SGDU09B(&I)).TERR
         AIF   ('&FEATURE(&Q)' EQ 'TWOLINE').T3
         AIF   ('&FEATURE(&Q)' EQ 'MULTILINE').T4
.TERR MNOTE 5,' * * * IEIIOD105 &ID-FEATURE VALUE &FEATURE(&Q) INVALID'
&SGQUITB SETB  1
         AGO   .T1
.T3 MNOTE *,'        TWOLINE PRINT'
         AIF   (&SGDF02B(&I)).TERR1
&SGDF03B(&I)   SETB 1
         AGO   .T1
.T4 MNOTE *,'        MULTILINE PRINT'
         AIF   (&SGDF03B(&I)).TERR1
&SGDF02B(&I)   SETB 1
         AGO   .T1
.TERR1 MNOTE 5,'* * * IEIIOD107 TWOLINE/MULTILINE MUTUALLY EXCLUSIVE'
&SGQUITB SETB  1
         AGO   .T1
    MNOTE 5,' * * * IEIIOD105 &ID-FEATURE VALUE &FEATURE INVALID'
&SGQUITB SETB  1
         AGO   .T1
.T2 MNOTE *,'        CARDIMAGE'
&SGDF01B(&I)  SETB  1
&SGUNF1B(&I)  SETB  1
         AGO   .T1
.TYPCLAS ANOP            THIS ROUTINE IS COMMON FOR READERS/PUNCHES
&SGDT07B(&I)  SETB  1    DEVICE TYPE
&SGDCLSB(12)  SETB  1    READER/PUNCH
         AGO   .CHECKX
.**********************************************************************
.*******               MISCELLANEOUS DEVICES********
.**********************************************************************
.S7443  MNOTE *,'       7443 SERVICE RECORD FILE'
&SGDT10B(&I) SETB 1                      UNIT-RECORD CLASS      G51DSPD
&SGDU02B(&I) SETB 1                      7443 DEVICE            G51DSPD
&SGDCLSB(44) SETB 1                      A 7443   IS PRESENT    G51DSPD
         AGO   .CHECKX
.A3838  MNOTE *,'     3838 ARRAY PROCESSOR'
&SGDT10B(&I) SETB 1                      UNIT-RECORD CLASS      G29ASVN
&SGDU01B(&I) SETB 1                      3838 DEVICE            G29ASVN
&SGDCLSB(29) SETB 1                      A GUSHER IS PRESENT    G29ASVN
&MM          SETA 8                      NUMBER OF UNITS        G29ASVN
         AIF ('&ADDRESS(1)'(3,1) EQ '0').CHECKX    LOW DIGIT    G29ASVN
      MNOTE 5,'* * * IEIIOD109 - 3838 ADDRESS MUST END IN ZERO' G29ASVN
&SGQUITB     SETB 1                      QUIT SWITCH            G29ASVN
         AGO   .CHECKX                   GO DO ADDRESSES,ETC    G29ASVN
.**********************************************************************
.*******      TELECOMMUNICATIONS - START/STOP DEVICES          ********
.**********************************************************************
.TP1030 MNOTE *,'     1030 COMMUNICATION SYSTEM'
&SGDU01B(&I)  SETB  1
&AB      SETB  1         AUTOPOLL ONLY VALID FEATURE
         AGO   .TPCOM
.TP1050 MNOTE *,'     1050 COMMUNICATION SYSTEM'
&SGDU02B(&I)  SETB  1
&EB      SETB  1          IBM1 ADAPTER
         AGO   .TPCOM
.TP1050X MNOTE *,'     1050X COMMUNICATION SYSTEM'
&SGDT02B(&I)  SETB  1
&SGDU04B(&I)  SETB  1
&SGDCLSB(62)  SETB  1
&EB      SETB  1          IBM1 ADAPTER
&BB      SETB  1         AUTOPOLL INVALID
         AGO   .TPCOM1
.TP1060 MNOTE *,'     1060 COMMUNICATION SYSTEM'
&SGDU03B(&I)  SETB  1
&EB      SETB  1          IBM1 ADAPTER
&AB      SETB  1         AUTOPOLL ONLY VALID FEATURE
         AGO   .TPCOM
.TP2260 MNOTE *,'     2260 REMOTE DISPLAY STATION'
&SGDU04B(&I)  SETB  1    UNIT
&SGDCLSB(10)  SETB  1    2260
&SGDT08B(&I)  SETB  1    DEVICE TYPE
         AGO   .TPDISP
.TP2265 MNOTE *,'     2265 REMOTE DISPLAY STATION'
&SGDT12B(&I)  SETB  1    DEVICE TYPE
&SGDU03B(&I)  SETB  1    UNIT
&SGDCLSB(68)  SETB  1    2265 CLASS
.TPDISP  ANOP       COMMON FOR 2260/2265 REMOTE
&SGDCLSB(33)  SETB  1
         AIF   (T'&TCU EQ 'O').E1
         AIF   ('&TCU' EQ '2701').G1
    MNOTE 5,'* * * IEIIOD159 &ID- TCU VALUE &TCU INVALID'
&SGQUITB  SETB  1
         AGO   .G2
.E1 MNOTE 5,'* * * IEIIOD162 &ID-TCU VALUE NOT SPECIFIED'
&SGQUITB  SETB  1
         AGO   .G2
.G1 MNOTE *,'     2701 TRANSMISSION CONTROL UNIT'
&SGUNT2B(&I)  SETB  1
&SGUNU1B(&I)  SETB  1
.G2      AIF   (T'&ADAPTER EQ 'O').E2
         AIF   ('&ADAPTER' EQ 'IBM3').G3
    MNOTE 5,'* * * IEIIOD119 &ID-ADAPTER VALUE &ADAPTER INVALID'
&SGQUITB  SETB  1
         AGO   .CHECKX
.E2 MNOTE 5,'* * * IEIIOD163 &ID-ADAPTER VALUE NOT SPECIFIED'
&SGQUITB  SETB  1
         AGO   .CHECKX
.G3 MNOTE *,'     IBM TERMINAL ADAPTER - TYPE III'
&SGDAD6B(&I)  SETB  1
         AGO   .CHECKX
.TP115A MNOTE *,'     115A WESTERN UNION POLLING STATION'
&SGDU05B(&I)  SETB  1
&S       SETB  1         NO FEATURES
         AGO   .TPCOM
.TP2740 MNOTE *,'     2740 COMMUNICATION TERMINAL'
&SGDU08B(&I)  SETB  1
&SGDCLSB(50)  SETB  1
&G       SETB  1          2740
&EB      SETB  1          IBM1 ADAPTER
         AGO   .TPCOM
.TP2740C MNOTE *,'     2740C COMMUNICATION TERMINAL'
&SGDT12B(&I)  SETB  1
&SGDU02B(&I)  SETB  1
&SGDCLSB(64)  SETB  1
&FB      SETB  1         2740C,2740X
&EB      SETB  1          IBM1 ADAPTER
&BB      SETB  1         AUTOPOLL INVALID
         AGO   .TPCOM1
.TP2740X MNOTE *,'     2740X COMMUNICATION TERMINAL'
&SGDT12B(&I)  SETB  1
&SGDU01B(&I)  SETB  1
&SGDCLSB(63)  SETB  1
&FB      SETB  1         2740C,2740X
&EB      SETB  1          IBM1 ADAPTER
&BB      SETB  1         AUTOPOLL INVALID
         AGO   .TPCOM1
.TP2741P MNOTE *,'     2741P COMMUNICATION TERMINAL'
&SGDU02B(&I)  SETB  1
         AGO   .T2741A
.TP2741C MNOTE *,'     2741C COMMUNICATION TERMINAL'
&SGDU03B(&I)  SETB  1
.T2741A  ANOP
&SGDT02B(&I)  SETB  1    DEVICE TYPE
&BB      SETB  1         AUTOPOLL INVALID
&DB      SETB  1         AUTOANSR ONLY VALID FEATURE
&EB      SETB  1          IBM1 ADAPTER
         AGO   .TPCOM1
.TP83B3 MNOTE *,'     83B3 AT&&T CALLING TERMINAL'
&SGDU06B(&I)  SETB  1
&S       SETB  1         NO FEATURES
         AGO   .TPCOM
.TPTWX  MNOTE *,'     TWX COMMUNICATIONS SYSTEM'
&SGDU07B(&I)  SETB  1
&BB      SETB  1         AUTOPOLL INVALID
         AGO   .TPCOM
.TPWTTA MNOTE *,'     WORLD TRADE TELETYPE TERMINAL'
&SGDT02B(&I)  SETB  1
&SGDU01B(&I)  SETB  1
&S       SETB  1         NO FEATURES
         AGO   .TPCOM1
.TPCOM   ANOP       THIS CODE IS COMMON
&SGDT08B(&I)  SETB  1    DEVICE TYPE
.TPCOM1  ANOP
&SGDCLSB(33)  SETB  1    TP DEVICE
.ADPTR   AIF   (T'&ADAPTER EQ 'O').K2
         AIF   ('&ADAPTER' EQ 'IBM1').TLA
         AIF   ('&ADAPTER' EQ 'IBM2').TLB
         AIF   ('&ADAPTER' EQ 'IBMT').TLC
         AIF   ('&ADAPTER' EQ 'TELE1').TLD
         AIF   ('&ADAPTER' EQ 'TELE2').TLE
         AIF   ('&ADAPTER' EQ 'TELEW').TLF
.K1 MNOTE 5,'* * * IEIIOD119 &ID-ADAPTER VALUE &ADAPTER INVALID'
&SGQUITB  SETB 1
         AGO   .TCU
.K2 MNOTE 5,'* * * IEIIOD118 &ID-ADAPTER VALUE NOT SPECIFIED'
&SGQUITB  SETB 1
         AGO   .TCU
.TLA     AIF   (NOT &EB).K1
&SGDAD1B(&I)  SETB  1 INVALID FOR 1030,115A,83B3,TWX,WTTA
    MNOTE *,'     IBM TERMINAL ADAPTER, TYPE I'
         AGO   .TCU
.TLB     AIF   ('&UNIT' NE '1030').K1
&SGDAD2B(&I)  SETB  1
    MNOTE *,'     IBM TERMINAL ADAPTER, TYPE II'
         AGO   .TCU
.TLC     AIF   ('&UNIT' NE '1050' AND '&UNIT' NE '1050X').K1
&SGDAD3B(&I)  SETB  1
    MNOTE *,'     IBM TELEGRAPH ADAPTER'
         AGO   .TCU
.TLD     AIF   ('&UNIT' NE '115A' AND '&UNIT' NE '83B3').K1
&SGDAD4B(&I)  SETB  1
    MNOTE *,'     TELEGRAPH ADAPTER, TYPE I'
         AGO   .TCU
.TLE     AIF   ('&UNIT' NE 'TWX').K1
&SGDAD5B(&I)  SETB  1
    MNOTE *,'     TELEGRAPH ADAPTER, TYPE II'
         AGO   .TCU
.TLF     AIF   ('&UNIT' NE 'WTTA').K1
&SGDAD8B(&I)  SETB  1
    MNOTE *,'     TELEW ADAPTER'
.TCU     AIF   (T'&TCU EQ 'O').H2
         AIF   ('&TCU' EQ '2701').C1
         AIF   ('&TCU' EQ '2702').C2
         AIF   ('&TCU' EQ '2703').C3
    MNOTE 5,'* * * IEIIOD154 &ID-TCU VALUE &TCU INVALID'
&SGQUITB  SETB  1
         AGO   .TPFEAT
.H2 MNOTE 5,'* * * IEIIOD155 &ID-TCU VALUE NOT SPECIFIED'
&SGQUITB  SETB  1
         AGO   .TPFEAT
.C1 MNOTE *,'     2701 TRANSMISSION CONTROL UNIT'
&SGUNT2B(&I)  SETB  1
&SGUNU1B(&I)  SETB  1
         AGO   .TPFEAT
.C2      AIF   (NOT &SGDAD3B(&I)).C2A
    MNOTE 5,'* * * IEIIOD152 &ID-ADAPTER=IBMT INVALID WITH TCU=2702'
&SGQUITB SETB  1
         AGO   .TPFEAT
.C2A MNOTE *,'     2702 TRANSMISSION CONTROL UNIT'
&SGUNT2B(&I)  SETB  1
&SGUNU2B(&I)  SETB  1
         AGO   .TPFEAT
.C3 MNOTE *,'     2703 TRANSMISSION CONTROL UNIT'
&SGUNT3B(&I)  SETB  1
&SGUNU1B(&I)  SETB  1
.TPFEAT  AIF   (&S).SADTEST   NO FEATURES ON 115A,83B3,WITA
         AIF   (T'&FEATURE EQ 'O').SADTEST
    MNOTE *,'     FEATURE(S)'
.FTURE   AIF   (N'&FEATURE EQ &Q).FTP
&Q  SETA  &Q+1
         AIF   ('&FEATURE(&Q)' EQ 'AUTOPOLL').APOLL
         AIF   (&AB).F1E           INVALID FOR 1030,1060
         AIF   ('&FEATURE(&Q)' EQ 'AUTOANSR').ANSR
         AIF   (&DB).F1E     INVALID FOR 2741C/P
         AIF   ('&FEATURE(&Q)' EQ 'AUTOCALL').ACALL
         AIF   (NOT (&G OR &FB)).F1E  2740, 2740C, 2740X ONLY
         AIF   ('&FEATURE(&Q)' EQ 'CHECKING').CKING
         AIF   (NOT &G).F1E   FOLLOWING FEATURES VALID FOR 2740 ONLY
         AIF   ('&FEATURE(&Q)' EQ 'SCONTROL').SCTRL
         AIF   ('&FEATURE(&Q)' EQ 'XCONTROL').XCTRL
         AIF   ('&FEATURE(&Q)' EQ 'OIU').OIU
         AIF   ('&FEATURE(&Q)' EQ 'INTERRUPT').INT
.F1E MNOTE 5,'* * * IEIIOD105 &ID-FEATURE VALUE &FEATURE(&Q) INVALID'
&SGQUITB  SETB  1
         AGO   .FTURE
.APOLL   AIF   (&BB).F1E      INVALID FOR 2741C/P,TWX
         AIF   ('&TCU' NE '2701').AP1
    MNOTE 5,'* * * IEIIOD105 &ID  AUTOPOLL INVALID WITH TCU=2701'
&SGQUITB SETB  1
         AGO   .FTURE
.AP1   MNOTE *,'        AUTOMATIC POLLING'
&SGDF01B(&I)  SETB  1
         AGO   .FTURE
.ANSR MNOTE *,'        AUTOMATIC ANSWERING'
&SGDF03B(&I)  SETB  1
         AGO   .FTURE
.ACALL MNOTE *,'        AUTOMATIC CALLING'
&SGDF02B(&I)  SETB  1
         AGO   .FTURE
.CKING MNOTE *,'        RECORD CHECKING'
&SGDF06B(&I)  SETB  1
         AGO   .FTURE
.SCTRL MNOTE *,'        STATION CONTROL'
&SGDF04B(&I)  SETB  1
         AGO   .FTURE
.XCTRL MNOTE *,'        TRANSMIT CONTROL'
&SGDF05B(&I)  SETB  1
         AGO   .FTURE
.OIU MNOTE *,'        OPTICAL IMAGE UNIT'
&SGDF07B(&I)  SETB  1
         AGO   .FTURE
.INT MNOTE *,'        INTERRUPT **RPQ S30031**'
&SGDF08B(&I)  SETB  1
         AGO   .FTURE
.FTP     AIF   (&SGDF01B(&I) AND (&SGDF02B(&I) OR &SGDF03B(&I))).F2E
         AIF   (NOT (&G OR &FB)).SADTEST   NOT 2740, 2740C, OR 2740X
         AIF   (&FB AND NOT &SGDF06B(&I)).F8E
         AIF   (NOT &G).SADTEST
.FTP1    AIF   (&SGDF01B(&I) AND NOT &SGDF04B(&I)).F3E AUTOPOLL/SCONTRL
.FTP2    AIF   (&SGDF07B(&I) AND NOT &SGDF06B(&I)).F4E  CHECKING/OIU
.FTP3    AIF   (&SGDF07B(&I) AND (&SGDF04B(&I) OR &SGDF05B(&I))).F5E
.FTP4    AIF   (&SGDF04B(&I) AND (&SGDF05B(&I) OR &SGDF02B(&I) OR &SGDF*
               03B(&I))).F6E
         AIF (&SGDF05B(&I) AND (NOT(&SGDF02B(&I) OR &SGDF03B(&I)))).F7E
         AGO   .SADTEST
.F2E MNOTE 5,'* * * IEIIOD164 AUTOPOLL INVALID WITH AUTOCALL, AUTOANSR'
&SGQUITB SETB  1
         AIF   (&G).FTP1
         AGO   .SADTEST
.F3E MNOTE 5,'* * * IEIIOD165 AUTOPOLL REQUIRES SCONTROL'
&SGQUITB SETB  1
         AGO   .FTP2
.F4E MNOTE 5,'* * * IEIIOD166 CHECKING REQUIRED WITH OIU'
&SGQUITB SETB  1
         AGO   .FTP3
.F5E MNOTE 5,'* * * IEIIOD167 SCONTROL OR XCONTROL INVALID WITH OIU'
&SGQUITB SETB  1
         AGO   .FTP4
.F6E MNOTE 5,'* * * IEIIOD168 XCONTROL, AUTOCALL, OR AUTOANSR INVALID W*
               ITH SCONTROL'
&SGQUITB SETB  1
         AGO   .SADTEST
.F7E MNOTE 5,'* * * IEIIOD169 AUTOCALL, AUTOANSR OR BOTH REQUIRED WITH *
               XCONTROL'
&SGQUITB SETB  1
         AGO   .SADTEST
.F8E MNOTE 5,'* * * IEIIOD172 CHECKING REQUIRED WITH 2740C AND 2740X'
&SGQUITB SETB  1
.SADTEST AIF   ('&TCU' NE '2702').CHECKX
         AIF   (T'&SETADDR EQ 'O').J1
         AIF   (T'&SETADDR NE 'N' OR K'&SETADDR GT 1).J2
         AIF   (&SETADDR GE 0 AND &SETADDR LE 3).SAD
.J2 MNOTE 5,'* * * IEIIOD121 &ID-SETADDR VALUE &SETADDR INVALID'
&SGQUITB SETB  1
         AGO   .CHECKX
.J1 MNOTE 5,'* * * IEIIOD173 &ID-SETADDR VALUE NOT SPECIFIED'
&SGQUITB SETB  1
         AGO   .CHECKX
.SAD MNOTE *,'     SET-ADDRESS-COMMAND &SETADDR SPECIFIED'
&SGDM01B(&I)  SETB  ('&SETADDR' EQ '0')
&SGDM02B(&I)  SETB  ('&SETADDR' EQ '1')
&SGDM03B(&I)  SETB  ('&SETADDR' EQ '2')
&SGDM04B(&I)  SETB  ('&SETADDR' EQ '3')
         AGO   .CHECKX
.TPBSC1  MNOTE *,'    BINARY SYNCHRONOUS COMMUNICATION SYSTEM, TYPE 1'
&SGDU06B(&I) SETB 1
         AGO   .S12COM
.TPBSC2 MNOTE *,'     BINARY SYNCHRONOUS COMMUNICATION SYSTEM, TYPE 2'
&SGDU07B(&I)  SETB  1
         AGO   .S12COM
.TPBSC3  MNOTE *,'    BINARY SYNCHRONOUS COMMUNICATIONS SYSTEM, TYPE 3'
&SGDU08B(&I)  SETB  1
.S12COM  ANOP
&SGDT02B(&I)  SETB  1         DEVICE TYPE
&SGDCLSB(33)  SETB  1         TP CLASS
         AIF   (T'&ADAPTER EQ 'O').S12E1     ADAPTER REQUIRED
 AIF ('&ADAPTER' EQ 'BSCA').S12AD
 MNOTE 5,'* * * IEIIOD119 &ID-ADAPTER VALUE &ADAPTER INVALID'
&SGQUITB SETB 1
         AGO   .BSTCU
.S12AD MNOTE *,'      BINARY SYNCHRONOUS ADAPTER'
&SGDAD7B(&I) SETB 1
         AGO   .BSTCU
.S12E1 MNOTE 5,'* * * IEIIOD118 &ID-ADAPTER VALUE NOT SPECIFIED'
&SGQUITB SETB 1
.BSTCU   AIF   (T'&TCU EQ 'O').BSE1
         AIF   ('&TCU' EQ '2701').T01
         AIF   ('&TCU' EQ '2702').T02
         AIF   ('&TCU' EQ '2703').T03
    MNOTE 5,'* * * IEIIOD154 &ID-TCU VALUE &TCU INVALID'
&SGQUITB SETB  1
         AGO   .S12FET
.BSE1 MNOTE 5,'* * * IEIIOD155 &ID-TCU VALUE NOT SPECIFIED'
&SGQUITB SETB  1
         AGO   .S12FET
.T01 MNOTE *,'     2701 TRANSMISSION CONTROL UNIT'
&SGUNT2B(&I)  SETB  1
&SGUNU1B(&I)  SETB  1
         AGO   .S12FET
.T02 MNOTE *,'     2702 TRANSMISSION CONTROL UNIT'
&SGUNT2B(&I)  SETB  1
&SGUNU2B(&I)  SETB  1
         AGO   .S12FET
.T03 MNOTE *,'     2703 TRANSMISSION CONTROL UNIT'
&SGUNT3B(&I)  SETB  1
&SGUNU1B(&I)  SETB  1
.S12FET  AIF   (T'&FEATURE EQ 'O').CNTEST1
.S12MORE AIF   (N'&FEATURE EQ &Q).CNTEST1
&Q SETA &Q+1        FEATURE INDEX
 AIF ('&FEATURE(&Q)' EQ 'AUTOCALL').S12AUTC
 AIF ('&FEATURE(&Q)' EQ 'AUTOANSR').S12AUTA
 AIF ('&FEATURE(&Q)' EQ 'AUTOPOLL').S12AUTP
 AIF ('&FEATURE(&Q)' EQ 'DUALCOMM').S12DCOM
 AIF ('&FEATURE(&Q)' EQ 'DUALCODE').S12DCOD
.INVFET ANOP
 MNOTE 5,'* * * IEIIOD105 &ID-FEATURE VALUE &FEATURE(&Q) INVALID'
&SGQUITB SETB 1
 AGO .S12MORE
.S12AUTC AIF   (&SGDU06B(&I) OR &SGDU08B(&I)).INVFET
         MNOTE *,'       AUTOMATIC CALLING'
&SGDF02B(&I) SETB 1
 AGO .S12MORE
.S12AUTA AIF   (&SGDU06B(&I) OR &SGDU08B(&I)).INVFET
         MNOTE *,'       AUTOMATIC ANSWERING'
&SGDF03B(&I) SETB 1
 AGO .S12MORE
.S12AUTP AIF   (&SGDU06B(&I) OR &SGDU07B(&I)).INVFET
         MNOTE *,'       AUTOMATIC POLLING'
&SGDF01B(&I) SETB 1
 AGO .S12MORE
.S12DCOM AIF   (NOT(&SGUNT2B(&I) AND &SGUNU1B(&I))).INVFET  2701 O
 MNOTE *,'      DUAL COMMUNICATION STATIONS'
&SGDF06B(&I) SETB 1
 AGO .S12MORE
.S12DCOD AIF   (NOT(&SGUNT2B(&I) AND &SGUNU1B(&I))).INVFET  2701
 MNOTE *,'      DUAL COMMUNICATION CODE SETS'
&SGDF05B(&I) SETB 1
 AGO .S12MORE
.CNTEST1 AIF   (NOT &SGDU08B(&I)).CNTEST
         AIF   (&SGDF01B(&I)).CNTEST
&SGDF01B(&I)  SETB  1
    MNOTE *,'     AUTOMATIC POLLING ASSUMED FOR BSC3'
.CNTEST  AIF   (T'&OBRCNT EQ 'O').CHECKX
         AIF   (&OBRCNT GT 800).A
  MNOTE *,'    OBRCNT SPECIFIED IS &OBRCNT'
&SGBSCA  SETA  &SGBSCA+&OBRCNT              ACCUMULATE OBRCNT
         AIF   (&SGBSCA LE 800).CHECKX
.A MNOTE 0,'* * * IEIIOD901 MAXIMUM ACCUMULATED VALUE FOR OBRCNT OF 800*
                HAS BEEN EXCEEDED - 800 IS THE DEFAULT VALUE'
&SGBSCA  SETA  800
         AGO   .CHECKX
.TP7770 MNOTE *,'     7770 AUDIO RESPONSE UNIT'
&SGDT12B(&I)  SETB  1         TP DEVICE
&SGDU04B(&I)  SETB  1         UNIT
&SGDCLSB(33)  SETB 1          TP CLASS
&SGDCLSB(67)  SETB  1         7770 CLASS
         AIF   (T'&MODEL EQ 'O').T7E1
         AIF   ('&MODEL' EQ '3').T7M3
    MNOTE 5,'* * * IEIIOD103 &ID-MODEL VALUE &MODEL INVALID'
&SGQUITB SETB  1
         AGO   .CHECKX
.T7M3 MNOTE *,'     MODEL 3'
&SGDM03B(&I)   SETB 1                   SET MODEL 3 GLOBAL
         AGO   .CHECKX
.T7E1 MNOTE 5,'* * * IEIIODU04 &ID-MODEL VALUE NOT SPECIFIED'
&SGQUITB SETB  1
         AGO   .CHECKX
.TP2955 MNOTE *,'     2955 FIELD ENGINEERING DATA ADAPTER UNIT'
&SGDT12B(&I)  SETB  1    TP DEVICE TYPE
&SGDU05B(&I)  SETB  1    2955 REMOTE ANALYSIS DEVICE
&SGDCLSB(72)  SETB  1    2955 CLASS
         AGO   .CHECKX
.TP3704 MNOTE *,'      3704 COMMUNICATION CONTROL UNIT'
&SGDT12B(&I)   SETB 1          TP CLASS
&SGDU07B(&I)   SETB 1          3704
&SGDCLSB(4)    SETB  1         3704 TP DEVICE IN SYSTEM
&ML      SETA  1               ALLOW ONE OPTCHAN
         AGO   .NOMOD
.TP3705 MNOTE *,'      3705 COMMUNICATION CONTROL UNIT'
&SGDT12B(&I)   SETB 1          TP CLASS
&SGDU06B(&I)   SETB 1          3705
&SGDCLSB(5)    SETB  1         3705 TP DEVICE IN SYSTEM
&ML      SETA  1               ALLOW ONE OPTCHAN
.NOMOD   AIF   (T'&MODEL NE 'O').AERR1  MODEL INVALID THIS DEVICE
.FEAT37  AIF   (T'&FEATURE NE 'O').AERR3  FEATURE INVALID THIS DEVICE
.FEAT37A AIF   (T'&ADAPTER EQ 'O').AD3704
         AIF   ('&ADAPTER' EQ 'CA1').CA1
         AIF   ('&ADAPTER' EQ 'CA2').CA2
.AERR4  MNOTE 5,'* * * IEIIOD119 &ID-ADAPTER VALUE &ADAPTER INVALID'
         AGO   .AERR2
.AERR   MNOTE 5,'* * * IEIIOD118 &ID-ADAPTER VALUE NOT SPECIFIED'
.AERR2   ANOP
&SGQUITB SETB  1
         AGO   .CHECKX
.AD3704  AIF   (NOT &SGDU07B(&I)).AERR       NOT 3704
        MNOTE *,'     CHANNEL ADAPTER - TYPE 1 - ASSUMED FOR 3704'
&SGDAD1B(&I)   SETB 1
         AGO   .CHECKX
.CA1    MNOTE *,'     CHANNEL ADAPTER - TYPE 1'
&SGDAD1B(&I)   SETB 1
         AGO   .CHECKX
.CA2     AIF   ('&UNIT' EQ '3704').AERR4      CA2 INVALID FOR 3704
        MNOTE *,'     CHANNEL ADAPTER - TYPE 2'
&SGDAD2B(&I)   SETB 1
         AGO   .CHECKX
.AERR1 MNOTE 5,'* * * IEIIOD200 MODEL VALUE SPECIFIED - INVALID, THERE *
               ARE NO MODEL NUMBERS'
&SGQUITB SETB  1
         AGO   .FEAT37
.AERR3 MNOTE 5,'* * *IEIIOD201 FEATURE(S) SPECIFIED -INVALID THERE ARE *
               NO SPECIAL FEATURES'
&SGQUITB SETB  1
         AGO   .FEAT37A
.TP3791 MNOTE *,'      3791L  LOCAL CHANNEL ATTACHMENT'         Z40KSVN
&SGDT12B(&I)   SETB 1                   TP CLASS                Z40KSVN
&SGDU10B(&I)   SETB 1                   3791L                   Z40KSVN
&SGDCLSB(56)   SETB 1                   3791L IS PRESENT        Z40KSVN
         AIF   ('&MODEL' EQ '' AND '&FEATURE' EQ '' AND '&ADAPTER' EQ  X
               '').CHECKX               DO COMMON CODE          Z40KSVN
 MNOTE 0,'*** IEIIOD199 - MODEL, FEATURE, ADAPTER NOT ALLOWED.' Z40KSVN
         AGO   .CHECKX                  GO DO COMMON            Z40KSVN
.TPCTC  MNOTE *,'      CHANNEL TO CHANNEL DEVICE'
&SGDT09B(&I)   SETB 1          TP CLASS                         ZM00043
&SGDU09B(&I)   SETB 1          CTC
&SGDCLSB(83)   SETB 1          CHANNEL TO CHANNEL DEVICE SPECIFIED
         AIF   (T'&MODEL EQ 'O').FEATCTC     NO MODEL
    MNOTE 0,'     MODEL INVALID FOR CTC DEVICE-IT WILL BE IGNORED'
.FEATCTC AIF   (T'&FEATURE EQ 'O').CHECKX    NO FEATURE
&Q       SETA 1                                                @ZA30241
         AIF   ('&FEATURE(&Q)' NE '370').CTCERR  FEAT NOT 370  @ZA30241
&SGDF04B(&I)   SETB 1
    MNOTE *,'     370 FEATURE SPECIFIED '
         AGO   .CHECKX
.CTCERR  ANOP
 MNOTE 5,'* * * IEIIOD105 &ID-FEATURE VALUE &FEATURE INVALID'
         AGO   .CHECKX
.DD MNOTE *,'     DUMMY DEVICE'
&SGDUMMY(&I)  SETB  1
&ML      SETA  1                   ALLOW 1 OPTCHAN
.**********************************************************************
.****************     CHECK OPTIONAL PARAMETERS     *******************
.**********************************************************************
.CHECKX  AIF   ('&AP' EQ 'NO').CHECKX1
         AIF   ('&UNIT' EQ '2314' OR '&UNIT' EQ '3330' OR '&UNIT' EQ '3*
               340' OR '&UNIT' EQ '3350').CHECKX1              @Z30RSTA
         AIF   ('&UNIT' EQ '2401' OR '&UNIT' EQ '2415' OR '&UNIT' EQ '2*
               420' OR '&UNIT' EQ '3420' OR '&UNIT' EQ '3410').CHECKX1
     MNOTE 5,'* * * IEIOD203 AP INVALID FOR &UNIT'
&SGQUITB SETB   1
.CHECKX1 AIF   (T'&DEVTYPE EQ 'O').OFFLINE   NO PARM
.*                                                             @G64HSPD
.DSPCKX1 ANOP     ENTRY POINT FOR DSP DEV CHECK                @G64HSPD
.*                                                             @G64HSPD
&SGDEVB(1)   SETB  1    SET  FOR DEV TAB INSP
&X       SETA  K'&DEVTYPE               COUNT OF DEVTYPE
         AIF   (&X NE 8).O8
&OA      SETC  '&DEVTYPE'(1,1)
&OB      SETC  '&DEVTYPE'(2,1)
&OC      SETC  '&DEVTYPE'(3,1)
&OD      SETC  '&DEVTYPE'(4,1)
&OE      SETC  '&DEVTYPE'(5,1)
&OF      SETC  '&DEVTYPE'(6,1)
&OG      SETC  '&DEVTYPE'(7,1)
&OH      SETC  '&DEVTYPE'(8,1)
         AIF   (NOT((('&OA' GE 'A') AND ('&OA' LE 'F')) OR (('&OA' GE 'X
               0') AND ('&OA' LE '9')))).O8
         AIF   (NOT((('&OB' GE 'A') AND ('&OB' LE 'F')) OR (('&OB' GE 'X
               0') AND ('&OB' LE '9')))).O8
         AIF   (NOT((('&OC' GE 'A') AND ('&OC' LE 'F')) OR (('&OC' GE 'X
               0') AND ('&OC' LE '9')))).O8
         AIF   (NOT((('&OD' GE 'A') AND ('&OD' LE 'F')) OR (('&OD' GE 'X
               0') AND ('&OD' LE '9')))).O8
         AIF   (NOT((('&OE' GE 'A') AND ('&OE' LE 'F')) OR (('&OE' GE 'X
               0') AND ('&OE' LE '9')))).O8
         AIF   (NOT((('&OF' GE 'A') AND ('&OF' LE 'F')) OR (('&OF' GE 'X
               0') AND ('&OF' LE '9')))).O8
         AIF   (NOT((('&OG' GE 'A') AND ('&OG' LE 'F')) OR (('&OG' GE 'X
               0') AND ('&OG' LE '9')))).O8
         AIF   ((('&OH' GE 'A') AND ('&OH' LE 'F')) OR (('&OH' GE '0') X
               AND ('&OH' LE '9'))).VT
.O8 MNOTE 5,'* * * IEIIOD140 &ID DEVTYPE VALUE &DEVTYPE INVALID'
&SGQUITB  SETB  1
         AIF   (&DSPRSW1).DSPRTE1           DSP ERROR RETURN   @G64HSPD
         AGO   .OFFLINE       CHECK OFFLINE
.VT      AIF   ('&OE' NE '2').VTT
&SGDASDA SETA  &SGDASDA+1
.VTT MNOTE *,'     UCB DEVICE TYPE &DEVTYPE SET FOR THIS UNIT'
&O       SETC  '&DEVTYPE'(1,6)          FIRST SIX CHAR DEVTYPE
         CONVERT  TO=HEX,VALUE=&O,DIGITS=6
&SGDEVTP(&I)  SETA  &HEX
&O       SETC  '&DEVTYPE'(7,2)          LAST TWO CHAR
         CONVERT  TO=HEX,VALUE=&O,DIGITS=2
&SGETABA(&I)  SETA  &HEX                PASSED IN ERRTAB BOX
         AIF   (&DSPRSW1).DSPRTN1           DSP GOOD RETURN    @G64HSPD
.**********************************************************************
.*                        OFFLINE  PROCESSING
.**********************************************************************
.OFFLINE AIF   ('&OFFLINE' EQ 'NO').OFF3420                     ZM00043
         AIF   ('&OFFLINE' NE 'YES').OFFERR                     ZM00043
     MNOTE *,'     OFFLINE SPECIFIED FOR THIS DEVICE'           ZM00043
&SGDOFFB(&I) SETB  1
         AGO   .ERRTAB                                          ZM00043
.OFF3420 AIF   ('&UNIT' NE '3420').ERRTAB                       ZM00043
         AIF   (NOT &SGDF09B(&I)).ERRTAB                        ZM00043
     MNOTE 0,'     SHARABLE SPECIFIED - OFFLINE=YES DEFAULTED'  ZM00043
&SGDOFFB(&I) SETB  1                                            ZM00043
         AGO   .ERRTAB                                          ZM00043
.OFFERR  ANOP                                                   ZM00043
    MNOTE 5,'***  IEIIOD144 &ID OFFLINE VALUE &OFFLINE INVALID' ZM00043
&SGQUITB SETB 1                                                 ZM00043
.**********************************************************************
.*                        ERRTAB  PROCESSING
.**********************************************************************
.ERRTAB  AIF   (T'&ERRTAB EQ 'O').CHECKAD    NOT SPECIFIED
&SGDEVB(1)  SETB  1         SET FOR SERRTAB INSPECTION
         AIF   (T'&ERRTAB EQ 'N' AND (&ERRTAB GE 0 AND &ERRTAB LE 254))X
               .VE                      NOT PROPERLY SPECIFIED
    MNOTE 5,'***  IEIIOD141 &ID ERRTAB VALUE &ERRTAB INVALID'
&SGQUITB SETB 1
         AGO   .CHECKAD
.VE MNOTE *,'   UCB ERROR TAB INDEX &ERRTAB SET FOR THIS UNIT'
&SGETABA(&I)  SETA  (&ERRTAB+1)*256+&SGETABA(&I)   ERRTAB & DEVTAB
.CHECKAD  AIF (&MULT).NLOOP
         AIF (T'&ADDRESS EQ 'O').AZ  NO ADDRESS-ERROR
         AIF (K'&ADDRESS(1) NE 3).B2
&ADDR    SETC  '&ADDRESS(1)'
 AIF (NOT(&SGDT06B(&I) AND (&SGDU04B(&I) OR &SGDU05B(&I)))).NLOOP 1419,
.*                                                                 1275
   CONVERT TO=HEX,VALUE=&ADDR,DIGITS=3   ADDR OR 1419 OR 1275 MUST
         AIF   (&HEX/2*2 EQ &HEX).NLOOP
   MNOTE 5,'* * * IEIIOD145 1419 AND/OR 1275 REQUIRE AN EVEN NUMBERED  *
               ADDRESS'
&SGQUITB SETB 1
&CHKSW  SETB  0      ERROR CREATE ONE SGDADRA
.NLOOP   AIF   ('&ADDR' EQ 'FFF').B2
&D       SETC  '&ADDR'(1,1)        DIGIT REPRESENTING CHANNEL
&E       SETC  '&ADDR'(2,1)        DIGIT REPRESENTING CTRL UNIT
&F       SETC  '&ADDR'(3,1)        DIGIT REPRESENTING UNIT
         AIF   (NOT((('&D' GE 'A')AND('&D' LE 'F'))OR(('&D' GE '0')AND(*
               '&D' LE '9')))).B2
 AIF (NOT((('&E' GE 'A')AND('&E' LE 'F'))OR(('&E' GE '0')AND('&E' LE '9X
               ')))).B2                 IS 2ND ADDRESS DIGIT 0-F
         AIF   ((('&F' GE 'A') AND ('&F' LE 'F')) OR (('&F' GE '0') ANDX
                ('&F' LE '9'))).VAL1    IS 3RD ADDRESS DIGIT 0-F
.B2 MNOTE 5,'* * * IEIIOD110 &ID-ADDRESS VALUE &ADDRESS INVALID'
         AGO   .AZZ
.AZ MNOTE 5,'* * * IEIIOD111 &ID-ADDRESS VALUE NOT SPECIFIED'
         AGO   .AZZ
.BM2 MNOTE 5,'* * * IEIIOD112 &ID-ADDRESS MULTIPLIER VALUE &ADDRESS(2) X
               INVALID'
.AZZ     ANOP
&SGQUITB SETB  1
&QUIT    SETB  1
&SGDASPA(&I) SETA &I                                            Z40ASVN
         AGO   .OPTCHAN
.VAL1    AIF (&MULT).VALIDX
         AIF (&MM NE 0).VAL2                 IF DEFAULT NE 1    Z40RSVN
&M       SETA  1
.VAL2    AIF (N'&ADDRESS EQ 1).VALIDX        NOT A MULTIPLE ADDRESS
         AIF (N'&ADDRESS NE 2).B2
         AIF (T'&ADDRESS(2) EQ 'O').VALIDX
         AIF (&ADDRESS(2) LT 1).BM2
         AIF ('&UNIT' EQ '2305').VALIDX      IF 2305, 8 UNITS   G29ASVN
         AIF ('&UNIT' EQ '3838').VALIDX      IF 3838, 8 UNITS   G29ASVN
&M       SETA  &ADDRESS(2)
.VALIDX  ANOP
         CONVERT  TO=HEX,VALUE=&ADDR,DIGITS=3
&SGDADRA(&I) SETA 4096*&IOC*&SGCNTRA(2)+&HEX                    Z40ASVN
&SGDASPA(&I) SETA &I                                            Z40ASVN
    MNOTE *,'     ADDRESS &ADDR SPECIFIED '
         AIF   (NOT(&SGDT01B(&I) OR &SGDT03B(&I) OR (&SGDT05B(&I) AND &*
               SGDU01B(&I)))).CHKER     TEST FOR TAPE, DA, OR 2250
&H   SETA  &HEX/256                     USE CHN ADR FOR BRST DEV SUBSPT
&SGBRSTB(&H+1)  SETB  1                 TURN ON SW FOR CHAN W/BRST DEV
         AIF   (NOT &SGDT03B(&I)).B1A   DIRECT ACCESS
&SGDISKB(&H+1)  SETB  1
.B1A     AIF   (NOT &SGDT01B(&I)).B1B   TAPES
&SGTAPEB(&H+1)  SETB  1
.B1B     AIF   (NOT (&SGDT05B(&I) AND &SGDU01B(&I))).B1C   2250 DEVICE
&SG2250B(&H+1)  SETB   1
.B1C     AGO   .OPTCHAN
.CHKER   AIF   (NOT &CHKSW).OPTCHAN  HAS 1419, OR 1275 BEEN SPECIFIED
.**********************************************************************
.*                                                                    *
.*   SGSETDIT IS CALLED HERE TO SET UP THE DIT FOR THE FIRST        *
.*   ADDRESS FOR THE 1419 OR 1275.                                    *
.*                                                            @G64HSPD*
.**********************************************************************
         SGSETDIT   UNIT=&UNIT,ID=&ID
.*                                                             @G64HSPD
&HEX  SETA  &HEX+1                   YES
&SGDADRA(&I+1) SETA 4096*&IOC*&SGCNTRA(2)+&HEX                  Z40ASVN
&SGDASPA(&I+1) SETA &I                                          Z40ASVN
&SGCNTRA(3)  SETA  &SGCNTRA(3)+1
&CHKSW  SETB  0
.OPTCHAN AIF (T'&OPTCHAN EQ 'O').RDWT   IF OMIT GO SEE IF 2400-RDWT DEV
         AIF   (&ML EQ 0).B3            OPTCHAN PERMITTED?      ZM33354
         AIF   (&SGDT03B(&I) AND '&UNIT' EQ '2305' AND &SGDF02B(&I)).IN*
               CFET2
         AIF (N'&OPTCHAN LE &ML).B5     OPTCHAN SPEC EXCEED ALLWBLE NO.
    MNOTE 5,'* * * IEIIOD123 &ID-TOO MANY OPTCHAN VALUES'
&SGQUITB SETB  1
.B5      ANOP
.DSPOPS  ANOP          DSP OPTIONAL CHANNELS                   @G64HSPD
.* .DSPOPS -- THE ENTRY POINT TO PROCESS THE OPTIONAL          @G64HSPD
.*            CHANNEL PARAMETERS FOR THE MVS RESTRUCTURE       @G64HSPD
.*            INTERFACE.                                       @G64HSPD
&A       SETA  0
.NEXTOPT AIF   (&A EQ N'&OPTCHAN).ON15  ALL OPTCHAN PARAMETERS CHECKED.
&A       SETA  &A+1
&N SETC '&OPTCHAN(&A)'
 AIF (N'&OPTCHAN EQ 1 AND (K'&OPTCHAN EQ 2 OR K'&OPTCHAN EQ 4)).SUBOPT
 AIF (N'&OPTCHAN EQ 2 AND K'&OPTCHAN EQ 7).SUBOPT
 AIF (N'&OPTCHAN EQ 3 AND K'&OPTCHAN EQ 10).SUBOPT
         AIF   ((('&N' GE '1')AND('&N' LE '9'))OR(('&N' GE 'A')AND('&N'*
                LE 'F'))).OK
 AGO .BG           INVALID OPTCHAN ON SELECTOR OR MULTIPLEXOR
.SUBOPT  ANOP
&N SETC '&OPTCHAN(&A)'(1,1)              CHANNEL PORTION
&F SETC '&ADDR'(1,1)
 AIF ('&N' NE '&F').B6
&N SETC '&OPTCHAN(&A)'(2,1)            GET C.U. PORTION
&F SETC '&ADDR'(2,1)
 AIF ('&F' LE 'B' OR '&F' GE 'F').B6
 AIF ('&N' LE '&F').BG             INVALID OPTCHAN FOR THIS ADDRESS
 AIF ('&N' EQ 'D').B5D
 AIF ('&N' EQ 'E').B5E
 AIF ('&N' EQ 'F').B5F
.BG MNOTE 5,'* * * IEIIOD124 &ID-OPTCHAN VALUE &OPTCHAN(&A) INVALID'
&SGQUITB SETB  1
         AGO   .NEXTOPT
.B5D ANOP
&ALT(2) SETB 1             OPTCHAN WITH SELECTOR SUB D
.BH MNOTE *,'     OPTIONAL CHANNEL PATH &OPTCHAN(&A)'
&SGOPSUB(&I) SETB 1   OPTCHAN ON SELECTOR SUB CH FOR THIS DEVICE
 AGO .B7ALT
.B5E ANOP
&ALT(3) SETB 1             OPTCHAN WITH SELECTOR SUB E
 AGO .BH
.B5F ANOP
&ALT(4) SETB 1             OPTCHAN WITH SELECTOR SUB F
 AGO .BH
.OK      AIF  ('&D' EQ 'F').BG
         CONVERT  TO=HEX,DIGITS=1,VALUE=&D
&CB      SETA  &HEX
         CONVERT  TO=HEX,DIGITS=1,VALUE=&OPTCHAN(&A)
&H       SETA  &HEX
         AIF   (&CB GT &H).BG
    MNOTE *,'     OPTIONAL CHANNEL PATH &OPTCHAN(&A) '
&ALT(&H) SETB 1
.B7ALT ANOP
&SGOPCHA SETA &SGOPCHA+1
         AIF   (&SGOPCHA LE 1917).NEXTOPT                       Z40ASVN
    MNOTE 5,'* * * IEIIOD125 MAXIMUM OF 1917 OPTIONAL PATHS EXCEEDED'  *
                                                                Z40ASVN
&SGQUITB SETB 1
         AGO   .NEXTOPT
.ON15    ANOP
.*            TEST FOR DSP (MVS RESTRUCTURE) PROCESSING        @G64HSPD
         AIF   (NOT(&DSPRSW1)).NOTDSP                          @G64HSPD
&SGOPCSB(1)    SETB (&ALT(1))           GLOBAL ALTERNATE PATH  @G64HSPD
&SGOPCSB(2)    SETB (&ALT(2))           SWITCHES 1-6           @G64HSPD
&SGOPCSB(3)    SETB (&ALT(3))                                  @G64HSPD
&SGOPCSB(4)    SETB (&ALT(4))                                  @G64HSPD
&SGOPCSB(5)    SETB (&ALT(5))                                  @G64HSPD
&SGOPCSB(6)    SETB (&ALT(6))                                  @G64HSPD
&SGOPCSB(7)    SETB (&ALT(7))                                  @G64HSPD
&SGOPCSB(8)    SETB (&ALT(8))                                  @G64HSPD
&SGOPCSB(9)    SETB (&ALT(9))                                  @G64HSPD
&SGOPCSB(10)   SETB (&ALT(10))                                 @G64HSPD
&SGOPCSB(11)   SETB (&ALT(11))                                 @G64HSPD
&SGOPCSB(12)   SETB (&ALT(12))                                 @G64HSPD
&SGOPCSB(13)   SETB (&ALT(13))                                 @G64HSPD
&SGOPCSB(14)   SETB (&ALT(14))                                 @G64HSPD
&SGOPCSB(15)   SETB (&ALT(15))                                 @G64HSPD
&SGOPCSB(16)   SETB (&SGOPSUB(&I))                             @G64HSPD
&SGOPSUB(&I)   SETB 0          RESTORE PREMATURE SETTING       @ZA44022
         AGO   .SECOND                                         @G64HSPD
.NOTDSP  ANOP  CONT. OLD DEVICE PROCESSING                     @G64HSPD
&SGDAP1B(&I)   SETB (&ALT(1))           GLOBAL ALTERNATE PATH
&SGDAP2B(&I)   SETB (&ALT(2))           SWITCHES 1-6
&SGDAP3B(&I)   SETB (&ALT(3))
&SGDAP4B(&I)   SETB (&ALT(4))
&SGDAP5B(&I)   SETB (&ALT(5))
&SGDAP6B(&I)   SETB (&ALT(6))
&SGDAP7B(&I)   SETB (&ALT(7))
&SGDAP8B(&I)   SETB (&ALT(8))
&SGDAP9B(&I)   SETB (&ALT(9))
&SGDAPAB(&I)   SETB (&ALT(10))
&SGDAPBB(&I)   SETB (&ALT(11))
&SGDAPCB(&I)   SETB (&ALT(12))
&SGDAPDB(&I)   SETB (&ALT(13))
&SGDAPEB(&I)   SETB (&ALT(14))
&SGDAPFB(&I)   SETB (&ALT(15))
         AGO   .SECOND
.INCFET2 MNOTE 5,'* * * IEIIOD126 &ID-OPTCHAN AND SHARED/SHAREDUP MUTUA*
               LLY EXCLUSIVE'                           VS32758,ZA00805
&SGQUITB SETB 1
         AGO   .SECOND
.B3 MNOTE 5,'* * * IEIIOD127 &ID-OPTCHAN VALUES INVALID ON &UNIT'
&SGQUITB SETB  1
         AGO   .SECOND
.B6 MNOTE 5,'* * * IEIIOD124 &ID-OPTCHAN VALUE &OPTCHAN(&A) INVALID'
&SGQUITB  SETB   1
         AGO   .SECOND
.RDWT AIF (NOT(&SGDT01B(&I) AND &SGDF03B(&I))).SECOND
&SGQUITB SETB   1                       IF 2400RDWT,1 AND ONLY 1 OP RQD
    MNOTE 5,'* * * IEIIOD128 &ID-OPTCHAN VALUE OMITTED'
         AGO   .SECOND
.MX MNOTE 5,'* * * IEIIOD135 &ID-MAXIMUM NUMBER OF DEVICES EXCEEDED'
&SGQUITB  SETB 1
         AGO   .MEND
.SECOND  ANOP                                                  @G64HSPD
.*               TEST FOR DSP - RETURN TO DSP PROCESSING IF    @G64HSPD
.*               DSP SWITCH IS ON                              @G64HSPD
         AIF   (&DSPRSW1).OPCRETN      CONTINUE DSP PROCESSING @G64HSPD
.**********************************************************************
.*                                                                    *
.*    SGSETDIT IS CALLED HERE TO SETUP THE DIT. A DIT ENTRY WILL      *
.*    BE INITIALIZED FOR THE CURRENT VALUE OF &UNIT.                  *
.*                                                            @G64HSPD*
.**********************************************************************
         SGSETDIT    UNIT=&UNIT,ID=&ID
.*                                                             @G64HSPD
         AIF   (&MULT).Z00
         AIF   (&QUIT).MEND
&L       SETA  1
.Z00     AIF   (&MM EQ 0).Z02     IF NO DEFAULT UNITS           G29ASVN
         AIF   (&M NE 0).Z01
&M       SETA  &MM
.Z01     AIF ((&M LT 1 OR &M GE 9) AND ('&UNIT' NE '3330'  AND         *
               '&UNIT' NE '3340' AND '&UNIT' NE '3350')).Z03   @Z30RSTA
         AIF (&M LT 1 OR &M GT 32).Z03
.Z02     AIF   (&L EQ &M).MEND
&MULT    SETB  1
&L       SETA  &L+1
         CONVERT  TO=HEX,VALUE=&ADDR,DIGITS=3
&HEX     SETA  &HEX+1
         CONVERT  TO=EBCDIC,DIGITS=3,VALUE=&HEX
&ADDR    SETC  '&EBCDIC'
&A       SETA  0
&Q       SETA  0
         AGO   .START
.Z03   MNOTE 5,'* * * IEIIOD133 &ID-ADDRESS MULTIPLIER VALUE &M INVALIDX
               FOR &UNIT'
&SGQUITB SETB  1
         MEXIT
.**********************************************************************
.*                                                                    *
.* THIS SECTION PREPARES THE IODEVICE SPECIFICATION PARAMETERS FOR    *
.* THE DEVICE SUPPORT PRODUCT MACROS. THE SPECIFICATIONS ARE CHECKED  *
.* FOR SYNTAX AND PLACED IN GLOBALS PRIOR TO INVOKING SGDSPDFT.       *
.*                                                                    *
.*                                                                    *
.*             FICHE FLAG - - -@G64HSPD - - -COVERS THE               *
.*             THE  REMAINDER OF THE THIS MACRO UNTIL                 *
.*             OVER RIDING MODIFICATIONS OCCUR.                       *
.*                                                                    *
.**********************************************************************
.*
.* * *                                                            * * *
.*  PROCESS THE &ADDRESS PARAMETER                                    *
.* * *                                                            * * *
.DSPADR  ANOP
&SGADRPC(1) SETC 'FFF'                  INIT.ADDRESS -INVALID
&SGADRPC(2) SETC '1'                    INIT MULTIPLIER
         AIF   (T'&ADDRESS EQ 'O').PRDSPE2   NO ADDRESS-ERROR
         AIF   (K'&ADDRESS(1) NE 3).PRDSPE1   3 CHARS.?
&ADDR    SETC  '&ADDRESS(1)'
&CH      SETC  '&ADDR'(1,1)             CHANNEL DIGIT
&CL      SETC  '&ADDR'(2,1)             CNTRL UNIT DIGIT
&UT      SETC  '&ADDR'(3,1)             UNIT DIGIT
.*   CHECK FOR VALID HEX DIGITS
         AIF   (NOT((('&CH' GE 'A') AND ('&CH' LE 'F'))                X
               OR   (('&CH' GE '0') AND ('&CH' LE '9')))).PRDSPE1
         AIF   (NOT((('&CL' GE 'A') AND ('&CL' LE 'F'))                X
               OR   (('&CL' GE '0') AND ('&CL' LE '9')))).PRDSPE1
         AIF   (NOT((('&UT' GE 'A') AND ('&UT' LE 'F'))                X
               OR   (('&UT' GE '0') AND ('&UT' LE '9')))).PRDSPE1
         AIF   ('&ADDR' EQ 'FFF').PRDSPE1
         AIF   (N'&ADDRESS EQ 1).ONEADR       MULTI ADDRESS
         AIF   (N'&ADDRESS NE 2).PRDSPE1
         AIF   (T'&ADDRESS(2) EQ 'O').ONEADR  MULTI OMITTED
         AIF   (&ADDRESS(2) LT 1).PRDSPE3     POS DIGIT ?
&SGADRPC(2)    SETC '&ADDRESS(2)'             SET MULTIPLIER
.ONEADR  ANOP
&SGADRPC(1)    SETC '&ADDRESS(1)'             SET ADDRESS
         AGO   .VALADD                        UPDATE DADRA/DASPD
.PRDSPE1   MNOTE 5,'* * * IEIIOD110 &ID-ADDRESS VALUE &ADDRESS INVALID'
         AGO   .ADERR
.PRDSPE2   MNOTE 5,'* * * IEIIOD111 &ID-ADDRESS VALUE NOT SPECIFIED'
         AGO   .ADERR
.PRDSPE3   MNOTE 5,'* * * IEIIOD112 &ID-ADDRESS MULTIPLIER VALUE &ADDREX
               SS(2) INVALID'
.ADERR   ANOP
&SGQUITB SETB 1                                SET ERROR
         AGO   .DSPFETS                      GO DO FEATURES
.VALADD  ANOP   UPDATE DADRA/DASPA
         CONVERT TO=HEX,VALUE=&ADDR,DIGITS=3
&SGDADRA(&I)   SETA 4096*&IOC*&SGCNTRA(2)+&HEX  SET ADDRESS ARRAY
&SGDASPA(&I)   SETA (&I)                        SET POINTER ARRAY
    MNOTE *,'     ADDRESS &ADDR SPECIFIED '                    @ZA44226
.*
.* * *                                                            * * *
.*             PREPARE THE &FEATURES PARAMETER                        *
.* * *                                                            * * *
.DSPFETS ANOP
&FC      SETA   0                             START AT ZERO
&SGFCNTA SETA   0
         AIF   (T'&FEATURE EQ 'O').DSPOPC   ANY FEATURES ?
&SGFCNTA SETA   N'&FEATURE                  SET NUMBER OF FEATURES
.UPFETC  ANOP                               UPDATE FEATURE COUNT
&FC      SETA   &FC+1
&SGFETPC(&FC)  SETC '&FEATURE(&FC)'
         AIF   (&FC NE  &SGFCNTA).UPFETC    END OF FEATURES?
.*                                                                  * *
.*   PREPARE OPTIONAL CHANNEL PARAMETERS FOR DSP MACROS           * * *
.*                                                                  * *
.DSPOPC ANOP
&SGOPCTA SETA  0             INIT OPTIONAL CHANL COUNT
             AIF   (T'&OPTCHAN EQ 'O').DSPDVTP  ANY OPT. CHNLS. ?
.*   SETUP CHANNEL ADDRESS FOR OPTIONAL CHANNEL PROCESSING     @ZA71929
&D       SETC  '&ADDR'(1,1)                                    @ZA71929
.*              SET RETURN SWITCH FOR OPTIONAL CHANNEL
.*              PROCESSING
&DSPRSW1     SETB 1
             AGO  .DSPOPS    PROCESS OPTIONAL CHANNELS
.OPCRETN     ANOP            RETURN FROM OPTIONAL CHANNELS
&DSPRSW1     SETB 0          RESET RETURN DSP RETURN SWITCH
&SGOPCTA SETA  &A            SET OPTIONAL CHANL COUNT
.*                                                                  * *
.*             PROCESS &DEVTYPE PARM FOR DSP MACROS               * * *
.*                                                                  * *
.DSPDVTP ANOP
&SGDVTPC SETC  ''
         AIF   (T'&DEVTYPE EQ 'O').DSPERRT   DEVTYPE OMITTED?
&DSPRSW1 SETB  1                         SET DSP RETURN SWITCH
         AGO  .DSPCKX1                   VALIDATE HEX CHARACTERS
.DSPRTE1 ANOP                            ERROR RETURN
&DSPRSW1 SETB  0                         RESET DSP RETURN SWITCH
         AGO  .DSPERRT                   GO DO ERRTAB
.DSPRTN1 ANOP                            HEX CHECK GOOD RETURN
&DSPRSW1 SETB  0                         RESET DSP RETURN SWITCH
&SGDVTPC SETC  '&DEVTYPE'                SET INPUT PARAMETERS
.*
.*
.*   PROCESS THE &ERRTAB PARAMETER FOR THE DSP MACROS
.*
.DSPERRT ANOP
&SGERTPC SETC  ''                       INIT PARM FIELD
         AIF  (T'&ERRTAB EQ 'O').DSPAPP ERRTAB OMITTED?
&SGDEVB(1)   SETB 1        SET FOR &ERRTAB INSPECTION
         AIF  (T'&ERRTAB EQ 'N' AND (&ERRTAB GE 0                      X
               AND  &ERRTAB LE 254)).VER  INCORRECTLY SPECIFIED?
    MNOTE 5, '***  IEIIOD141 &ID ERRTAB VALUE &ERRTAB INVALID'
&SGQUITB SETB 1
         AGO   .DSPAPP
.VER     ANOP                           ERRTAB CHARS. VERIFIED
&SGERTPC SETC  '&ERRTAB'                SET DSP ERRTAB CHARS
&SGETABA(&I)  SETA  (&ERRTAB+1)*256+&SGETABA(&I)   ERRTAB & DEVTAB
.*
.*  * * *  PREPARE THE &AP PARAMETER FOR THE DSP MACROS
.*
.DSPAPP  ANOP                           CHECK AUX POWER SUPPLY
&SGAPPMC SETC  'NO'                     SET DEFAULT
         AIF  ('&AP' EQ 'YES' OR '&AP' EQ 'NO').VER4
     MNOTE 5,'* * * IEIIOD203 AP INVALID FOR &UNIT'
&SGQUITB SETB 1
         AGO  .DSPOFFL
.VER4    ANOP                           VALID AP APRM
&SGAPPMC SETC  '&AP'                    SET &AP FOR DSP
.*                                                                  * *
.*   * * *   PREPARE THE &OFFLINE PARAMETER FOR THE DSP MACROS    * * *
.*                                                                  * *
.DSPOFFL ANOP                           DO &OFFLINE FOR DSP
&SGOFLPC SETC  'NO'                     INIT OFFLINE PARM
         AIF  ('&OFFLINE' EQ 'NO' OR '&OFFLINE' EQ 'YES').VER5
    MNOTE 5, '***  IEIIOD144 &ID OFFLINE VALUE &OFFLINE INVALID'
&SGQUITB SETB 1
         AGO .DSPMODL
.VER5    ANOP
&SGOFLPC SETC  '&OFFLINE'
.*                                                                    *
.* * *      PREPARE THE &MODEL PARAMETER FOR THE DSP MACROS       * * *
.*                                                                    *
.DSPMODL ANOP
&SGMDLPC SETC  '&MODEL'                 SET MODEL FOR DSP
.*
.*   INVOKE SGDSPDFT TO SELECT THE DSP MACRO FOR THIS UNIT
.*
         SGDSPDFT  UNIT=&UNIT,ID=&ID
.*         ***********************************************
.*         *       END OF DSP INTERFACE SECTION          *
.*         *                                     @G64HSPD*
.*         ***********************************************
.MEND    MEND

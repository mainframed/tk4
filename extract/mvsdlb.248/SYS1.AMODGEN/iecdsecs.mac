*/*   INCLUDE SYSLIB(IECDSECS)                                 Y02134*/
*   % GOTO PLSDSECS;                   /*GO TO THE PLS VERSION Y02134*/
*/*            IECDSECS O/C/E CONTROL BLOCK MAPPING MACRO        Y02134
         MACRO
         IECDSECS &PARMS,&EXPAND=
.*
***********************************************************************
*
* CHANGE ACTIVITY = SEE BELOW
*
*        VS2 RELEASE 03.8 DELETIONS/CHANGES
*
*A185750                                                       @ZA51573
*$01=OZ72725,EDM1102,,STLBS: ADD NEW RESOURCE TO DADSM AUDIT TRAIL @01A
*$02=OZ81924,EDM1102,,FEGHA: BAD COMMENT CAUSING MSGIEV144         @02C
*
***********************************************************************
*
.**********************************************************************
.*
.* MODULE NAME = IECDSECS (VS2-2)
.*
.* DESCRIPTIVE NAME = O/C/E CONTROL BLOCK ADDRESSING MACRO
.*
.* COPYRIGHT = NONE.
.*
.* STATUS = CHANGE LEVEL 000
.*
.* FUNCTION = O/C/E MACRO USED TO PROVIDE ADDRESSABILITY TO SYSTEM
.*            CONTROL BLOCKS.
.*            PLS VERSION: TO PROVIDE MAPPING OF EOV PORTION OF  Y02134
.*            O/C/E WORKAREA, PREFIX TO WTG TABLE AND WORKAREA,  Y02134
.*            RESIDENT ROUTINE WORKAREA, USER PARM LIST, WTG     Y02134
.*            TABLE.                                             Y02134
.*
.* NOTES = THIS MACRO IS CALLED BY O/C/E CSECTS TO PROVIDE
.*         ADDRESSABILITY TO SYSTEM CONTROL BLOCKS. THIS MACRO MAY
.*         BE CALLED SEVERAL TIMES WITHIN ONE CSECT. INDICATORS
.*         AND PARAMETERS ARE ACCUMULATED FROM EACH CALL AND ARE
.*         EXPANDED AS DSECTS ON THE FINAL CALL OF THIS MACRO AT
.*         THE END OF THE CALLING CSECT WHEN THE KEYWORD PARAMETER
.*         EXPAND=YES IS SPECIFIED.
.*         THE ABOVE DOES NOT APPLY TO THE PLS VERSION. THE      Y02134
.*         MACRO MAY BE INCLUDED ONLY ONCE.                      Y02134
.*
.*      DEPENDENCIES = PLS: IECDSECT MUST BE INCLUDED IN         Y02134
.*                     THE CSECT THAT IECDSECS IS INCLUDED       Y02134
.*
.*      RESTRICTIONS = EXPAND=ATEND AND EXPAND=ENDALL CAN ONLY BE
.*                     USED WITH THE ASSEMBLER H AND MAY NOT BE
.*                     USED WITH ASSEMBLER F OR ASSEMBLER XF.
.*
.*                     THE PARAMETERS 'DEB' AND/OR 'DEBX'        Y02134
.*                     MAY NOT BE CODED IF 'IEZDEB' IS CODED, AS Y02134
.*                     DUPLICATELY DEFINED SYMBOLS WILL RESULT.  Y02134
.*                     IF 'IEZDEB' IS CODED THEN THE MACRO,      Y02134
.*                     IECEQU, MAY BE EXPANDED IN THE SAME       Y02134
.*                     CSECT ONLY IF IEZDEB=YES IS CODED AS      Y02134
.*                     A PARAMETER.                              Y02134
.*
.*      REGISTER CONVENTIONS = NOT APPLICABLE.
.*
.* PATCH LABEL = NOT APPLICABLE.
.*
.* MODULE TYPE = MACRO.
.*
.*      PROCESSOR = ASSEMBLER LANGUAGE/PLS                       Y02134
.*
.*      MODULE SIZE = DESCRIBED BY THE LABELS:
.*
.*                    OPEN  & OPEN  TYPE=J WORK AREA SIZE = DXOWAEND.
.*                    CLOSE & CLOSE TYPE=T WORK AREA SIZE = DXCWAEND.
.*                    EOV   & FEOV         WORK AREA SIZE = DXEWAEND.
.*
.*                OTHER SIZES GIVEN BY INDIVIDUAL CONTROL BLOCK MACROS.
.*
.*      ATTRIBUTES = DSECT FIELDS.
.*
.* ENTRY POINT = AS DEFINED BY EACH CONTROL BLOCK MACRO.
.*
.*      PURPOSE = THIS MACRO DEFINES THE CONTROL BLOCKS AND WORK
.*                AREAS USED BY O/C/E CSECTS.
.*
.*      LINKAGE = IECDSECS PARM1,PARM2,...,
.*                         EXPAND=(YES/NOPRINT/NO/ATEND/ENDALL)
.*                FOR PLS THE LINKAGE IS                         Y02134
.*                % INCLUDE(IECDSECS);                           Y02134
.*
.*      INPUT =
.*
.*              EXPAND=YES
.*
.*              THIS PARAMETER WILL CAUSE THIS MACRO TO EXPAND THE
.*              CONTROL BLOCKS AND WORK AREAS SPECIFIED BY THE
.*              GLOBAL PARAMETERS IECDSCT & IECDSPM WHICH ARE SET
.*              FROM PREVIOUS CALLS AND THE CURRENT CALL OF THIS
.*              MACRO VIA THE POSITIONAL PARAMETERS, BELOW. A LATER
.*              SPECIFICATION OF THE SAME CONTROL BLOCK WILL CAUSE
.*              THE EXPANSION TO BE GENERATED WITH THE LATER OPTIONS.
.*              THIS OPTION IS THE DEFAULT IF A NULL PARAMETER IS
.*              SPECIFIED OR IF AN INVALID PARAMETER IS SPEDIFIED.
.*
.*              EXPAND=NOPRINT
.*
.*              THIS OPTION WILL BE THE SAME AS EXPAND=YES EXCEPT THAT
.*              THE EXPANDED DSECTS WILL NOT BE PRINTED. THIS OPTION
.*              MAY ALSO BE SPECIFIED EXTERNALLY VIA THE SYSPARM
.*              PARAMETER IN THE ASSEMBLER PARM FIELD:
.*
.*              PARM='SYSPARM(IECDSECS=NOPRINT)'
.*
.*              THIS OPTION WILL OVERIDE ALL EXPAND=YES CALLS.
.*
.*              EXPAND=NO
.*
.*              THIS PARAMETER WILL CAUSE THE SPECIFIED POSITIONAL
.*              PARAMETERS TO BE SAVED FOR A LATER EXPAND=YES CALL.
.*
.*              EXPAND=ATEND/ENDALL
.*
.*              EXPAND=ATEND,ENDALL CAN BE USED TO OVERIDE THE END
.*              CARD DURING ASSEMBLY, SO THAT SEVERAL CSECTS MAY BE
.*              CONCATENATED TOGETHER AND ASSEMBLED TOGETHER TO PRODUCE
.*              ONE ASSEMBLY AND ONE LOAD MODULE CONSISTING OF SEVERAL
.*              CSECTS. EACH CSECT MUST BE PRECEDED BY THE FOLLOWING
.*              STATEMENTS TO ACHIEVE THIS RESULT.
.*
.*              IECDSECS EXPAND=ATEND     IGNORE EXPAND=YES & END CARDS
.*              MACRO                     MACRO HEADER
.*              END   &PARM               MACRO DEFINITION FOR END CARD
.*              PRINT ON,NODATA,GEN       RESTORE PRINT OPTIONS
.*              DROP  ,                   DROP ALL PREVIOUS USINGS
.*              MEND
.*
.*              THE LAST CSECT IN THE ASSEMBLY SHOULD BE FOLLOWED WITH
.*
.*              IECDSECS EXPAND=ENDALL    EXPAND ALL DSECTS HERE
.*              ENDALL  ,                 END CARD FOR ASSEMBLY
.*
.*              PARM1,PARM2,...,
.*
.*              PARAMETERS TO IECDSECS ARE SPECIFIED AS POSITIONAL
.*              PARAMETERS AND MAY BE CODED IN ANY ORDER SEPARATED BY
.*              COMMAS. THE PARAMETERS REPRESENT CONTROL BLOCK NAMES
.*              WHICH ARE TO BE EXPANDED AS DSECTS. THE CONTROL BLOCKS
.*              SPECIFIED MUST BE ONES WHICH ARE IDENTIFIED BELOW IN
.*              THE CONTROL BLOCK DEFINITION TABLE. ALSO, THE
.*              PARAMETERS MAY BE SPECIFIED AS PARENTHETICAL
.*              EXPRESSIONS SO THAT PARAMETERS MAY BE PASSED TO THE
.*              CONTROL BLOCK MACROS TO EXPAND DIFFERENT OPTIONS. THE
.*              PARENTHETICAL EXPRESSIONS MAY BE USED IF IT IS
.*              DEFINED FOR A CONTROL BLOCK MACRO. SEE CONTROL BLOCK
.*              DESCRIPTIONS AND ACCEPTABLE PARAMETERS WITHIN EACH
.*              CONTROL BLOCK SECTION, BELOW. THE PARENTHETICAL
.*              EXPRESSIONS ARE IN THE FOLLOWING FORM:
.*
.*              (CBNAME,PP1,PP2,...,(KWDP1,P1),(KWDP2,P2),...)
.*
.*              CBNAME
.*
.*              AN ACCEPTABLE CONTROL BLOCK NAME AS DEFINED IN THE
.*              CONTROL BLOCK TABLE BELOW.
.*
.*              PP1,PP2,...
.*
.*              ACCEPTABLE POSITIONAL PARAMETERS AS DEFINED WITHIN
.*              EACH CONTROL BLOCK SECTION.
.*
.*              (KWD1,P1),(KWD2,P2),...
.*
.*              KWD IS AN ACCEPTABLE KEYWORD PARAMETER AND P IS AN
.*              ACCEPTABLE KEYWORD PARAMETER AS DEFINED WITHIN
.*              EACH CONTROL BLOCK SECTION.
.*
.*              FOR PLS THERE ARE NO OPERANDS TO THE CALL        Y02134
.*
.*      OUTPUT = MAPPING OF SPECIFIED CONTROL BLOCKS AND WORK AREAS.
.*               SEE INPUT= ABOVE.
.*               FOR PLS THE OUTPUT IS THE CONTROL BLOCK         Y02134
.*               STRUCTURES LISTED IN 'NOTES' ABOVE.             Y02134
.*
.* EXIT NORMAL = MEND STATEMENT
.*
.* EXIT ERROR = MNOTE 4,'** INVALID PARAMETER SPECIFIED - X'
.*
.* EXTERNAL REFERENCES = SEE CONTROL BLOCK NAMES BELOW.
.*
.*      ROUTINES = SEE CONTROL BLOCK NAMES BELOW.
.*
.*      DATA AREAS = SEE CONTROL BLOCK NAMES BELOW.
.*
.*      CONTROL BLOCKS = SEE CONTROL BLOCK NAMES BELOW.
.*
.* TABLES = CONTROL BLOCK NAME TABLE (LIMIT = 99 NAMES).
.*
.* MACROS = SEE CONTROL BLOCK NAMES BELOW.
.*
.**********************************************************************
.*
.**********************************************************************
.*
.*       VARIABLES USED WITHIN THIS MACRO
.*
.**********************************************************************
.*
         GBLB  &IECDSCT(100)            CUMULATIVE CONTROL BLOCK Y02080
         GBLC  &IECDSPM(100)            CB MACRO PARMS           Y02080
         LCLA  &N,&NB,&M                INDEXES TO ARRAYS
         LCLA  &LIMIT                   LIMIT=MAX NO. OF PARMS   Y02080
         LCLB  &EXPRNT                  EXPAND=NOPRINT OPTION SW Y02080
         LCLC  &NOPRINT                 SYSPARM NOPRINT STRING   Y02080
         LCLC  &A(99)                   CONTROL BLOCK NAMES      Y02080
         LCLA  &C0,&C1,&C2,&C3,&C4,&C5  NUMERICAL CONSTANTS      Y02080
         LCLA  &C6,&C7,&C8,&C9,&C10     NUMERICAL CONSTANTS      Y02080
         LCLA  &C100                    NUMERICAL CONSTANTS      Y02080
         LCLC  &KWD,&KWD0,&KWD1,&KWD2,&KWD3,&KWD4 KEYWORD PARMS  Y02080
         LCLC  &KWD5,&KWD6,&KWD7,&KWD8,&KWD9 KEYWORD PARMS       Y02080
         LCLC  &PP,&PP0,&PP1,&PP2,&PP3,&PP4 POSITIONAL PARMS     Y02080
         LCLC  &PP5,&PP6,&PP7,&PP8,&PP9 POSITIONAL PARMS         Y02080
         LCLC  &NULL                    NULL CHARACTER STRING    Y02080
         LCLC  &YES,&NO,&ATEND,&ENDALL  EXPAND PARAMETERS        Y02080
.*
.**********************************************************************
.*
.*       CONSTANTS
.*
.**********************************************************************
.*
&C0      SETA  0                        CONSTANT 0               Y02080
&C1      SETA  1                        CONSTANT 1               Y02080
&C2      SETA  2                        CONSTANT 2               Y02080
&C3      SETA  3                        CONSTANT 3               Y02080
&C4      SETA  4                        CONSTANT 4               Y02080
&C5      SETA  5                        CONSTANT 5               Y02080
&C6      SETA  6                        CONSTANT 6               Y02080
&C7      SETA  7                        CONSTANT 7               Y02080
&C8      SETA  8                        CONSTANT 8               Y02080
&C9      SETA  9                        CONSTANT 9               Y02080
&C10     SETA  10                       CONSTANT 10              Y02080
&C100    SETA  100                      CONSTANT 100             Y02080
&LIMIT   SETA  99                       LIMIT=MAX NO. OF PARMS   Y02080
&NOPRINT SETC  'IECDSECS=NOPRINT'       SYSPARM PRINT OPTION     Y02080
&NULL    SETC  ''                       NULL CHARACTER STRING    Y02080
&NO      SETC  'NO'                     KEYWORD                  Y02080
&YES     SETC  'YES'                    KEYWORD                  Y02080
&ATEND   SETC  'ATEND'                  EXPAND KEYWORD AT END    Y02080
&ENDALL  SETC  'ENDALL'                 EXPAND KEYWORD END ALL   Y02080
.*
.**********************************************************************
.*
.*       CONTROL BLOCK NAMES ASSOCIATED WITH THIS MACRO
.*
.**********************************************************************
.*
&A(1)    SETC  'CVT'                    MACRO = CVT              Y02080
&A(2)    SETC  'TCB'                    MACRO = IKJTCB           Y02080
&A(3)    SETC  'RB'                     MACRO = IKJRB            Y02080
&A(4)    SETC  'TIOT'                   MACRO = IEFTIOT1         Y02080
&A(5)    SETC  'SMF'                    MACRO = IEESMCA          Y02080
&A(6)    SETC  'SMFRCD'                 MACRO = IFASMFR          Y02080
&A(7)    SETC  'SMFTCT'                 MACRO = IEFTCT           Y02080
&A(8)    SETC  'JMR'                    MACRO = IEFJMR           Y02080
&A(9)    SETC  'ICB'                    MACRO = NONE             Y02080
&A(10)   SETC  'JSCB'                   MACRO = IEZJSCB          Y02080
&A(11)   SETC  'PSCB'                   MACRO = IKJPSCB          Y02080
&A(12)   SETC  'UPT'                    MACRO = IKJUPT           Y02080
&A(13)   SETC  'ASCB'                   MACRO = IHAASCB          Y02080
&A(14)   SETC  'TSENQ'                  MACRO = NONE             Y02080
&A(15)   SETC  'TSB'                    MACRO = IKJTSB           Y02080
&A(16)   SETC  'DSAB'                   MACRO = IHADSAB          Y02080
&A(17)   SETC  'BASE'                   MACRO = IEEBASEA         Y02080
&A(18)   SETC  'PSA'                    MACRO = IHAPSA           Y02080
&A(19)   SETC  'IOB'                    MACRO = IEZIOB           Y02080
&A(20)   SETC  'DCB'                    MACRO = DCBD             Y02080
&A(21)   SETC  'DEB'                    MACRO = NONE             Y02080
&A(22)   SETC  'DEBX'                   MACRO = NONE             Y02080
&A(23)   SETC  'UCB'                    MACRO = IEFUCBOB         Y02080
&A(25)   SETC  'DSCB1'                  MACRO = IECSDSL1         Y02080
&A(26)   SETC  'DSCB2'                  MACRO = IECSDSL1         Y02080
&A(27)   SETC  'DSCB3'                  MACRO = IECSDSL1         Y02080
&A(28)   SETC  'DSCB4'                  MACRO = IECSDSL1         Y02080
&A(29)   SETC  'DSCB5'                  MACRO = IECSDSL1         Y02080
&A(30)   SETC  'MAIN'                   MACRO = IECDSECT         Y02080
&A(31)   SETC  'UNITTAB'                MACRO = NONE             Y02080
&A(32)   SETC  'USERLAB'                MACRO = NONE             Y02080
&A(33)   SETC  'USERTOT'                MACRO = NONE             Y02080
&A(34)   SETC  'WTG'                    MACRO = NONE             Y02080
&A(35)   SETC  'SECCORE'                MACRO = NONE             Y02080
&A(36)   SETC  'PREFX'                  MACRO = NONE             Y02080
&A(37)   SETC  'IDAPDPRM'               MACRO = IDAPDRPM         X02898
&A(38)   SETC  'SCVT'                   MACRO = IHASCVT          Y02080
&A(39)   SETC  'RRPL'                   MACRO = NONE             Y02080
&A(40)   SETC  'RMPL'                   MACRO = IHARMPL          Y02080
&A(41)   SETC  'ACB'                    MACRO = IFGACB           Y02080
&A(42)   SETC  'QDB'                    MACRO = IHAQDB           Y02134
&A(43)   SETC  'IEZDEB'                 MACRO = IEZDEB           Y02134
&A(44)   SETC  'APP'                    DSECT = APPNMTBL         Y02082
&A(45)   SETC  'EOVLAST'                DSECT = EOVLAST          Y02082
&A(46)   SETC  'DSMADT'                 MACRO = NONE             Y02144
&A(47)   SETC  'CDE'                    MACRO = IHACDE           Y02080
&A(48)   SETC  'LPDE'                   MACRO = IHALPDE          Y02080
&A(49)   SETC  'PDAB'                   MACRO = PDABD           YL03123
&A(50)   SETC  'ICHACHKL'               MACRO = ICHACHKL       @Z40RSRJ
&A(51)   SETC  'RACVT'                  MACRO = ICHPRCVT       @G32DSMI
.**********************************************************************
.*
.*       POSITIONAL PARAMETER ANALYSIS
.*
.**********************************************************************
.*
&NB      SETA  N'&SYSLIST               NUMBER OF PARAMETERS IN PARMS
&N       SETA  &C0                      INDEX TO PARAMETERS      Y02080
.*
.IEC0010 ANOP                           LOOP FOR MORE PARMS      Y02080
&N       SETA  &N+&C1                   INCREMENT INDEX          Y02080
         AIF   (&N GT &NB).IEC0050      MORE PARMS?              Y02080
         AIF   ('&SYSLIST(&N,&C1)' EQ '&NULL').IEC0010 NULL?     Y02080
.*
&M       SETA  &C0                      INDEX TO CB NAMES        Y02080
.*
.IEC0020 ANOP                           LOOP FOR MORE NAMES      Y02080
&M       SETA  &M+&C1                   INCREMENT INDEX          Y02080
         AIF   (&M GT &LIMIT).IEC0030   MORE NAMES?              Y02080
         AIF   ('&A(&M)' EQ '&NULL').IEC0020 NULL?               Y02080
         AIF   ('&A(&M)' EQ '&SYSLIST(&N,&C1)').IEC0040 MATCH?   Y02080
         AGO   .IEC0020                 LOOP                     Y02080
.*
.IEC0030 MNOTE &C4,'** INVALID PARAMETER SPECIFIED - &SYSLIST(&N)'
         AGO   .IEC0010                 LOOP                     Y02080
.*
.IEC0040 ANOP                           MATCH                    Y02080
&IECDSCT(&M) SETB 1                     SET GLOBAL SWITCH        Y02080
&IECDSPM(&M) SETC '&SYSLIST(&N)'        SET UP CALL PARAMETERS   Y02080
         AGO   .IEC0010                 LOOP                     Y02080
.*
.**********************************************************************
.*
.*       KEYWORD PARAMETER ANALYSIS
.*
.**********************************************************************
.*
.IEC0050 AIF   ('&EXPAND' EQ '&ENDALL').IEC0110 EXPAND DSECTS?   Y02080
         AIF   (&IECDSCT(&C100)).IEC0090 IF IGNORING EXPAND=YES  Y02080
         AIF   ('&EXPAND' EQ '&ATEND').IEC0080 SET SW TO IGNORE? Y02080
         AIF   ('&EXPAND' EQ '&NO').IEC0090 EXPAND DSECTS?       Y02080
         AIF   ('&EXPAND' EQ '&NULL').IEC0090 DEFAULT=YES        Y02080
         AIF   ('&EXPAND' EQ 'NOPRINT').IEC0100 PRINT DSECTS?    Y02080
.*
.**********************************************************************
.*
.*       SYSPARM OVERRIDE PRINT PARAMETER
.*       IF SYSPARM(IECDSECS=NOPRINT) THEN DSECTS REPRESENTED IN
.*       IECDSECS WILL NOT BE PRINTED BUT WILL BE GENERATED.
.*
.**********************************************************************
.*
&N       SETA  &C1                      SET N=1                  Y02080
.IEC0060 AIF   (K'&NOPRINT+&N-&C1 GT K'&SYSPARM).IEC0070         Y02080
         AIF   ('&SYSPARM'(&N,K'&NOPRINT) EQ '&NOPRINT').IEC0100 Y02080
&N       SETA  &N+&C1                   N=N+1                    Y02080
         AGO   .IEC0060                 LOOP                     Y02080
.*
.IEC0070 AIF   ('&EXPAND' EQ '&YES').IEC0110 EXPAND DSECTS?      Y02080
         MNOTE &C4,'** INVALID PARAMETER SPECIFIED - &EXPAND'
         AGO   .IEC0110                 DEFAULT=YES              Y02080
.*
.**********************************************************************
.*
.*       END CARD OVERRIDE
.*
.**********************************************************************
.*
.IEC0080 ANOP                           SINGLE SOURCE ASSEMBLY   Y02080
&IECDSCT(&C100) SETB 1                  IGNORE EXPAND=YES        Y02080
ENDALL   OPSYN&NULL END                 ENDALL = END CARD        Y02080
END      OPSYN&NULL DROP                END = DROP (IF NO MACRO) Y02080
.*
.**********************************************************************
.*
.*       DELAY EXPANSION UNTIL LATER TIME.
.*
.**********************************************************************
.*
.IEC0090 MEXIT                          SAVE EXPANSION FOR LATER Y02080
.*
.**********************************************************************
.*
.*       EXPAND=NOPRINT OR SYSPARM=NOPRINT SETS PRINT OFF
.*
.**********************************************************************
.*
.IEC0100 EJECT
&EXPRNT  SETB  1                        SET PRINT OFF SW         Y02080
         PUSH  PRINT                                             Y02080
         PRINT OFF                                               Y02080
         AGO   .IEC0120                 GO TO GENERATE DSECTS    Y02080
.*
.**********************************************************************
.*
.*       EXPAND=YES
.*
.**********************************************************************
.*
.IEC0110 EJECT
.IEC0120 ANOP                           GENERATE DSECTS          Y02080
.*
         AIF  (NOT &IECDSCT(1)).SKIPCVT     BYPASS CVT IF NOT REQUESTED
         SPACE 1
***********************************************************************
*              COMMUNICATIONS VECTOR TABLE DEFINITION                 *
***********************************************************************
*
CVT      DSECT
*        CVT                           INVOKE CVT DSECT MACRO
         CVT
*
**********
         EJECT
.SKIPCVT ANOP                          ENTRANCE LABEL ONLY
         AIF  (NOT &IECDSCT(38)).SKPSCVT SCVT REQUESTED?         Y02080
         SPACE 1
***********************************************************************
*        SECONDARY COMMUNICATIONS VECTOR TABLE DEFINITION
***********************************************************************
         SPACE 1
*        IHASCVT                        INVOKE SCVT MACRO        Y02080
         IHASCVT
*
***********************************************************************
         EJECT
.SKPSCVT ANOP                          ENTRANCE LABEL ONLY
         AIF  (NOT &IECDSCT(13)).SKIPASC ASCB REQUESTED?         Y02080
         SPACE 1
***********************************************************************
*        ADDRESS SPACE CONTROL BLOCK
***********************************************************************
*
*        IHAASCB                        INVOKE ASCB MACRO        Y02080
         IHAASCB
*
***********************************************************************
         EJECT
.SKIPASC ANOP                          ENTRANCE LABEL ONLY
         AIF  (NOT &IECDSCT(2)).SKIPTCB     BYPASS TCB IF NOT REQUESTED
         SPACE 1
***********************************************************************
*              TASK CONTROL BLOCK DEFINITION                          *
***********************************************************************
*
*        IKJTCB                         INVOKE TCB DSECT MACRO
         IKJTCB  SYS=BOTH
*
DXTCB    EQU   TCB                      IECDSECS EQUS TO BE REMOVED
TCBPRB   EQU   TCBRBP                   MAYBE
TCBTTRN  EQU   TCBTRN
TCBPRTK  EQU   TCBPKF
         DS    X'00'
TCBFLG   EQU   TCBFLGS
TCBLODPT EQU   TCBLLS
TCBINACT EQU   TCBJPQ
TCBSIZ   EQU   TCBPIBT
TCBPRTY  EQU   TCBTCB
TCBTIME  EQU   TCBTME
TCBJSE   EQU   TCBJPQ                   LIST OF INACTIVE PROGRAMS ADDR
         DS    CL24
*
TCBTCT0M EQU   TCBTCT-TCB
TCBTIOTC EQU   TCBTIO-TCB
*
**********
         EJECT
.SKIPTCB ANOP                           ENTRANCE LABEL ONLY
         AIF  (NOT &IECDSCT(3)).SKIPRB  BYPASS RB IF NOT REQUESTED
         SPACE 1
***********************************************************************
*              REQUEST BLOCK DEFINITION                               *
***********************************************************************
*
*        IKJRB                          INVOKE RB DSECT MACRO
         IKJRB
*
RBLOCK   EQU   RBSECT                   IECDSECS EQUS
RBSTABYT EQU   RBFTCKPT+X'08'
SVRB34   EQU   RBTRSVRB
PRBSIZE  EQU   PRBEND-RBSECT
SVRBOFF4 EQU   RBEXSAVE-RBSECT
SVRBOFF2 EQU   RBGRS2-RBSECT
NOTPRB   EQU   RBFTSVRB
*
**********
         EJECT
.SKIPRB  ANOP                           ENTRANCE LABEL ONLY
         AIF   (NOT &IECDSCT(16)).SKIPDSA DSAB REQUESTED?        Y02080
         SPACE 1
***********************************************************************
*        DATA SET ASSOCIATION BLOCK
***********************************************************************
*
*        IHADSAB                        INVOKE IHADSAB MACRO     Y02080
         IHADSAB                                                 Y02080
*
***********************************************************************
         EJECT
.SKIPDSA ANOP                           ENTRANCE LABEL ONLY
         AIF   (NOT &IECDSCT(15)).SKIPTSB TSB REQUESTED?         Y02080
         SPACE 1
***********************************************************************
*        TIME SHARING BLOCK
***********************************************************************
*
*        IKJTSB                         INVOKE IKJTSB MACRO      Y02080
         IKJTSB                                                  Y02080
*
***********************************************************************
         EJECT
.SKIPTSB ANOP                           ENTRANCE LABEL ONLY
         AIF   (NOT &IECDSCT(14)).SKIPTSO TSOENQ AREA REQUESTED? Y02080
         SPACE 1
***********************************************************************
*        TSO ENQ WORK AREA DEFINITION                                 *
***********************************************************************
*
TSOENQ   DSECT                                                   Y01018
ENQMFL   DS    CL12                     LIST FORM OF ENQ MACRO   Y01018
TSQNAME  DS    CL8                      QNAME FOR ENQ OR DEQ     Y01018
TSRNAME  DS    CL4                      RNAME FOR ENQ OR DEQ     Y01018
*
***********************************************************************
.SKIPTSO ANOP
         AIF   (NOT &IECDSCT(4)).SKIPTIO BYPASS TIOT IF NOT REQ'ED
         SPACE 1
***********************************************************************
*              TASK INPUT/OUTPUT TABLE DEFINITION                     *
***********************************************************************
*
TIOT     DSECT
*        IEFTIOT1                       INVOKE TIOT DSECT MACRO
         IEFTIOT1
*
*  IECDSECS EQUS
TIOSPOUT EQU   X'40'                    INDICATES 'SPOOLED' SYSOUT
TIOSPLIN EQU   X'20'                    INDICATES 'SPOOLED' SYSIN
*
**********
         EJECT
.SKIPTIO ANOP                           ENTRANCE LABEL ONLY
         AIF   (NOT &IECDSCT(5)).SKIPSMF BYPASS SMF IF NOT REQ'D
         SPACE 1
*        IEESMCA                        INVOKE SYSTEMS MANAGEMENT
*                                       FACILITIES DSECT MACRO
         IEESMCA
*
**********
         EJECT
.SKIPSMF ANOP                           ENTRANCE LABEL ONLY
         AIF   (NOT &IECDSCT(6)).SKIPRCD BYPASS SMF RCD IF NOT REQ'D
         SPACE 1
SMF14RCD DSECT
*        IFASMFR (14)             INVOKE SMF RECORD-BUILDING MACRO @02C
         IFASMFR (14)
*
REGSAVE  EQU   SMF14UCB
*
**********
         EJECT
.SKIPRCD ANOP                           ENTRANCE LABEL ONLY
         AIF   (NOT &IECDSCT(7)).SKIPTCT BYPASS SMF TCT IF NOT REQ'D
         SPACE 1
*
*        IEFTCT                   INVOKE SMF TIMING CONTROL MACRO DSECT
         IEFTCT
*
**********
         EJECT
.SKIPTCT ANOP                           ENTRANCE LABEL ONLY
         AIF   (NOT &IECDSCT(8)).SKIPJMR BYPASS JMR IF NOT REQUIRED
         SPACE 1
*        IEFJMR                         INVOKE JOB MANAGEMENT RCD MACRO
         IEFJMR
*
**********
         EJECT
.SKIPJMR ANOP                           ENTRANCE LABEL ONLY
         AIF   (NOT &IECDSCT(11)).SKPPSCB  BYPASS PSCB IF NOT REQUESTED
         SPACE 1
***********************************************************************
*              PROTECTED STEP CONTROL BLOCK DEFINITION                *
***********************************************************************
*
*        IKJPSCB                        INVOKE PSCB DSECT MACRO
         IKJPSCB
*
**********
         EJECT
.SKPPSCB ANOP                           ENTRANCE LABEL ONLY
         AIF   (NOT &IECDSCT(18)).SKPPSA PSA REQUESTED?          Y02080
         SPACE 1
***********************************************************************
*        PREFIXED SAVE AREA DEFINITION
***********************************************************************
         SPACE 1
*        IHAPSA                                                  Y02080
         IHAPSA
*
***********************************************************************
         EJECT
.SKPPSA  ANOP                           ENTRANCE LABEL ONLY
         AIF   (NOT &IECDSCT(9)).SKIPICB  BYPASS ICB IF NOT REQUIRED
         SPACE 1
***********************************************************************
*              INTERRUPT CONTROL BLOCK DEFINITION                     *
***********************************************************************
*
ICB      DSECT
ICBLNKAD DS    F                        ADDRESS OF NEXT ICB
ICBECB   DS    F                        ECB FOR THIS ICB
ICBFLAG1 DS    C                        FLAG BYTE 1
ICBFLAG2 DS    C                        FLAG BYTE 2
ICBSNS1  DS    C                        SENSE BYTE 1
ICBSNS2  DS    C                        SENSE BYTE 2
ICBECBAD DS    F                        ECB ADDRESS
ICBFLAG3 DS    C                        FLAG BYTE 3
ICBCSW   DS    CL7                      LOW ORDER 7 BYTES OF LAST CSW
ICBCPPTR DS    F                        PT TO START OF CHAN PROGRAM
ICBINCR  DS    H                        FOR TAPE- USED TO INCR BLK CT
ICBINDIC DS    H                        TWO BYTES OF INDICATOR BITS
ICBMBBCC DS    D                        SEEK ADDR- DA DEVICE ONLY
*
**********
         EJECT
.SKIPICB ANOP                           ENTRANCE LABEL ONLY
         AIF   (NOT &IECDSCT(10)).SKPJSCB  BYPASS JSCB IF NOT REQUESTED
         SPACE 1
*        IEZJSCB                   INVOKE JOB/STEP CONTROL BLOCK MACRO
         IEZJSCB
*
**********
         EJECT
.SKPJSCB ANOP                           ENTRANCE LABEL ONLY
         AIF   (NOT &IECDSCT(12)).SKIPUPT  BYPASS UPT IF NOT REQUIRED
         SPACE 1
***********************************************************************
*              USER PROFILE TABLE DEFINITION                          *
***********************************************************************
*
*        IKJUPT                         INVOKE USER PROFILE TABLE MACRO
         IKJUPT
*
**********
         EJECT
.SKIPUPT ANOP                           ENTRANCE LABEL ONLY
         AIF   (NOT &IECDSCT(17)).SKIPBAS    SKIP IEEBASEA IF NOT REQ'D
         SPACE 1
***********************************************************************
*        IEEBASE DSECT DEFINITION                                     *
***********************************************************************
*
*        IEEBASEA                       INVOKE IEEBASE DSECT MACRO
         IEEBASEA
*
***********************************************************************
*
         EJECT
.SKIPBAS ANOP                           ENTRANCE LABEL ONLY
         AIF   (NOT &IECDSCT(40)).SKIPRMP RMPL REQUESTED?        Y02080
         SPACE 1
***********************************************************************
*        RECOVERY TERMINATION MANAGER LIST DEFINITION
***********************************************************************
         SPACE 1
*        IHARMPL                        INVOKE RMPL MACRO        Y02080
         IHARMPL
*
***********************************************************************
*
         EJECT
.SKIPRMP ANOP                           ENTRANCE LABEL ONLY
         AIF   (NOT &IECDSCT(49)).SKIPDAB BYPASS PDAB IF NOT REQUESTED
***********************************************************************
*              PARALLEL DATA ACCESS BLOCK DEFINITION
***********************************************************************
*
*        PDABD                          INVOKE THE PDAB DSECT   YL03123
         PDABD
*
**********
         EJECT
.SKIPDAB ANOP                           ENTRANCE LABEL ONLY
         AIF   (NOT &IECDSCT(20)).SKIPDCB   BYPASS DCB IF NOT REQUESTED
         SPACE 1
***********************************************************************
*              DATA CONTROL BLOCK DEFINITION                          *
***********************************************************************
*
*        DCBD  DSORG=(PS,IS,DA,TQ)                             @ZA05616
         DCBD  DSORG=(PS,IS,DA,TQ)                             @ZA05616
*
DCBMCRF1 EQU   DCBMACRF+1               BYTE 2 OF DCBMACRF FIELD  OC038
*
**********
         EJECT
.SKIPDCB ANOP                           ENTRANCE LABEL ONLY
         AIF   (NOT &IECDSCT(41)).SKIPACB ACB REQUESTED?         Y02080
         SPACE 1
***********************************************************************
*        ADVANCED CONTROL BLOCK DEFINITION
***********************************************************************
*
*        IFGACB                                                  Y02080
         IFGACB
*
***********************************************************************
         EJECT
.SKIPACB ANOP                           ENTRANCE LABEL ONLY      Y02080
         AIF   (NOT &IECDSCT(19)).SKIPIOB IOB REQUESTED?         Y02080
         SPACE 1
***********************************************************************
*        INPUT/OUTPUT BLOCK DEFINITION
***********************************************************************
         SPACE 1
IOB      DSECT                                                   Y02080
*        IEZIOB                         INVOKE THE IOB MACRO     Y02080
         IEZIOB
*
***********************************************************************
         EJECT
.SKIPIOB ANOP                           ENTRANCE LABEL ONLY
         AIF   (NOT &IECDSCT(21)).SKIPDEB    BYPASS DEB IF NOT REQ' ED
         SPACE 1
***********************************************************************
*              DATA EXTENT BLOCK DEFINITION                           *
***********************************************************************
*
IHADEB   DSECT
DEB      EQU   IHADEB
DEBAMID  DS    0CL1                                            @ZA51573
DEBNMSUB DS    0CL1
DEBTCBAD DS    CL4
DEBAMLNG DS    0CL1
DEBAMDEP DS    0CL1
DEBDEBAD DS    CL4
DEBOFLGS DS    0CL1
DEBIRBAD DS    CL4
DEBOPATB DS    CL1                      TYPE OF I/O
DEBQSCNT DS    CL1                      PURGE - QUIESCE COUNT
DEBFLGS1 DS    CL1                      DATA SET FLAGS
         DS    CL1                      RESERVED
DEBSYSPG DS    0CL4
DEBNMEXT DS    0CL1
DEBUSRPC DS    0A
DEBUSRPG DS    CL4
DEBPRIOR DS    0CL1
DEBECBAD DS    CL4
DEBPROTG DS    0CL1
DEBDEBID DS    0CL1
DEBDCBAD DS    CL4
DEBSCALE DS    0CL1
DEBEXSCL DS    0CL1
DEBAPPAD DS    CL4
DEBMODIF DS    0CL1
DEBDVMOD DS    0CL1
DEBUCBAD DS    CL4
DEBTVLSQ DS    0CL2
DEBBINUM DS    CL2
DEBTVLNM DS    0CL2
DEBSTRCC DS    CL2
DEBSTRHH DS    CL2
DEBENDCC DS    CL2
DEBENDHH DS    CL2
DEBNMTRK DS    CL2
DEBVOLSQ DS    H
DEBVOLNM DS    H
DEBSUBID DS    H
         DS    F
         ORG   DEBDVMOD
DEBNIEE  DS    0CL1
DEBFIEAD DS    CL4
DEBNPEE  DS    0CL1
DEBFPEAD DS    CL4
DEBNOEE  DS    0CL1
DEBFOEAD DS    CL4
DEBDISAD DS    CL4
*
**********
         EJECT
.SKIPDEB ANOP                           ENTRANCE LABEL ONLY
         AIF   (NOT &IECDSCT(22)).SKIPDBX BYPASS DEB EXTENSION   Y02134
         SPACE 1
***********************************************************************
*              DEB EXTENSION DEFINITION                               *
***********************************************************************
*
DEBXTN   DSECT
DEBXLNGH DS    H                        LENGTH OF DEB EXTENSION
DEBXFLG1 DS    XL1                      RESERVED
DEBXRV48 DS    XL1                      RESERVED
DEBXDSAB DS    A                        ADDRESS OF DSAB
DEBXDCBM DS    XL4                      DCB MODIFICATION MASK
DEBXDBPR DS    A                        DEB POINTER
DEBXDSO1 DS    XL1                      FIRST BYTE OF DSORG
DEBXDSO2 DS    XL1                      SECOND BYTE OF DSORG
DEBXMCF1 DS    XL1                      FIRST BYTE OF MACRF
DEBXMCF2 DS    XL1                      SECOND BYTE OF MACRF
DEBXXARG DS    A                        ADDR OF BDAM READ EXCL LIST
DEBXRV39 DS    A                        RESERVED
DEBXRV40 DS    A                        RESERVED
DEBXOPET DS    XL8                      DATASET OPEN TIME      @ZA39299
         EJECT
.SKIPDBX ANOP
         AIF   (NOT &IECDSCT(43)).SKIPZDB SKIP IEZDEB            Y02134
*        IEZDEB
         IEZDEB
         EJECT
.SKIPZDB ANOP                                                    Y02134
         AIF   (NOT &IECDSCT(50)).SKIPICH SKIP ICHACHKL        @Z40RSRJ
*        ICHACHKL                                              @Z40RSRJ
         ICHACHKL                                              @Z40RSRJ
         EJECT                                                 @Z40RSRJ
.SKIPICH ANOP                                                  @Z40RSRJ
         AIF   (NOT &IECDSCT(51)).SKIPRAC SKIP RAC CVT         @G32DSMI
*        ICHPRCVT                                              @G32DSMI
         ICHPRCVT                                              @G32DSMI
         EJECT                                                 @G32DSMI
.SKIPRAC ANOP                                                  @G32DSMI
         AIF  (NOT &IECDSCT(23)).SKIPUCB    BYPASS UCB IF NOT REQUESTED
         SPACE 1
***********************************************************************
*              UNIT CONTROL BLOCK DEFINITION                          *
***********************************************************************
*
.****************************************************************Y02134
.*                                                               Y02134
.*       IF PREFIX=NO OR PREFIX=, (DEFAULT) IS SPECIFIED,        Y02134
.*       DEFINED FIELDS IN THE UCB ARE GENERATED, BUT THE        Y02134
.*       FIELDS IN THE UCB PREFIX ARE NOT GENERATED.             Y02134
.*       TO GENERATE FIELDS IN THE UCB PREFIX,                   Y02134
.*       SPECIFY PREFIX=YES USING THE FORMAT DESCRIBED IN        Y02134
.*       THE DESCRIPTION OF PARMS IN THE PROLOGUE OF THIS MACRO. Y02134
.*                                                               Y02134
.*       EXAMPLE: IECDSECS (UCB,(PREFIX,YES))                    Y02134
.*                                                               Y02134
.****************************************************************Y02134
.*                                                               Y02134
&N       SETA  &C1                      SET N=1                  Y02134
&KWD1    SETC  '&NULL'                  SET KEYWORD TO DEFAULT   Y02134
.IEC2300 AIF   (&N+&C6-&C1+&C1 GT K'&IECDSPM(23)).IEC2330 LENGTH Y02134
         AIF   ('&IECDSPM(23)'(&N,&C6) EQ 'PREFIX').IEC2310 KWD  Y02134
&N       SETA  &N+&C1                   N=N+1                    Y02134
         AGO   .IEC2300                 LOOP                     Y02134
.*                                                               Y02134
.IEC2310 ANOP                           KEYWORD SPECIFIED        Y02134
&N       SETA  &N+&C6+&C1               SKIP OVER DELIMITER      Y02134
&KWD1    SETC  '&NULL'                  INITIALIZE TO NULL       Y02134
.IEC2320 AIF   (&N GT K'&IECDSPM(23)).IEC2330 CHECK THE LENGTH   Y02134
         AIF   ('&IECDSPM(23)'(&N,&C1) LT 'A').IEC2330 DELIMITER Y02134
&KWD1    SETC  '&KWD1'.'&IECDSPM(23)'(&N,&C1) MOVE CHAR TO PARM  Y02134
&N       SETA  &N+&C1                   N=N+1                    Y02134
         AGO   .IEC2320                 LOOP                     Y02134
.*                                                               Y02134
.IEC2330 SPACE 1                                                 Y02134
         AIF   ('&KWD1' EQ '&YES').IEC2340 CHECK FOR PREFIX      Y02134
UCB      DSECT
SRT      EQU   UCB
.IEC2340 MNOTE '         IEFUCBOB PREFIX=&KWD1,LIST=YES'         Y02134
         IEFUCBOB PREFIX=&KWD1,LIST=YES                          Y02134
         SPACE 1                                                 Y02134
*
*  IECDSECS EQUS
UCBPRTCT EQU   X'02' -                  FILE PROTECT RING INSTALLED
*
***********************************************************************
         EJECT
.SKIPUCB ANOP                           ENTRANCE LABEL ONLY
         AIF   (NOT &IECDSCT(25)).SKIPDS1  BYPASS DSCB1 IF NOT REQUESTD
         SPACE 1
***********************************************************************
*              DATA SET CONTROL BLOCK -- FORMAT 1                     *
***********************************************************************
*
DSCB1    DSECT
*        IECSDSL1 (1)                   INVOKE DCSB FMT 1 DSECT MACRO
         IECSDSL1 (1)
*
***********************************************************************
         EJECT
.SKIPDS1 ANOP                           ENTRANCE LABEL ONLY
         AIF   (NOT &IECDSCT(26)).SKIPDS2  BYPASS DSCB2 IF NOT REQUESTD
         SPACE 1
***********************************************************************
*              DATA SET CONTROL BLOCK -- FORMAT 2                     *
***********************************************************************
*
DSCB2    DSECT
*        IECSDSL1 (2)                   INVOKE DCSB FMT 2 DSECT MACRO
         IECSDSL1 (2)
*
***********************************************************************
         EJECT
.SKIPDS2 ANOP                           ENTRANCE LABEL ONLY
         AIF   (NOT &IECDSCT(27)).SKIPDS3  BYPASS DSCB3 IF NOT REQUESTD
         SPACE 1
***********************************************************************
*              DATA SET CONTROL BLOCK -- FORMAT 3                     *
***********************************************************************
*
DSCB3    DSECT
*        IECSDSL1 (3)                   INVOKE DCSB FMT 3 DSECT MACRO
         IECSDSL1 (3)
*
***********************************************************************
         EJECT
.SKIPDS3 ANOP                           ENTRANCE LABEL ONLY
         AIF   (NOT &IECDSCT(28)).SKIPDS4  BYPASS DSCB4 IF NOT REQUESTD
         SPACE 1
***********************************************************************
*              DATA SET CONTROL BLOCK -- FORMAT 4                     *
***********************************************************************
*
DSCB4    DSECT
*        IECSDSL1 (4)                   INVOKE DCSB FMT 4 DSECT MACRO
         IECSDSL1 (4)
*
***********************************************************************
         EJECT
.SKIPDS4 ANOP                           ENTRANCE LABEL ONLY
         AIF   (NOT &IECDSCT(29)).SKIPDS5  BYPASS DSCB5 IF NOT REQUESTD
         SPACE 1
***********************************************************************
*              DATA SET CONTROL BLOCK -- FORMAT 5                     *
***********************************************************************
*
DSCB5    DSECT
*        IECSDSL1 (5)                   INVOKE DCSB FMT 5 DSECT MACRO
         IECSDSL1 (5)
*
***********************************************************************
         EJECT
.SKIPDS5 ANOP                           ENTRANCE LABEL ONLY
         AIF   (NOT &IECDSCT(42)).SKIPQDB  BYPASS QDB IF NOT REQ Y02134
         SPACE 1
***********************************************************************
*              DSAB QUEUE DESCRIPTOR BLOCK                            *
***********************************************************************
*
QDB      DSECT
*        IHAQDB                         INVOKE DSAB QDB DSECT MACRO
         IHAQDB
*
***********************************************************************
         EJECT
.SKIPQDB ANOP                           ENTRANCE LABEL ONLY      Y02134
         AIF   (NOT &IECDSCT(30)).SKIPMN     BYPASS MAIN IF NOT REQ'D
.**********************************************************************
.*       O/C/E WORK AREAS
.**********************************************************************
.*
.*       IF IOB=YES OR IOB=, (DEFAULT) IS SPECIFIED, INTERNALLY
.*       DEFINED FIELDS IN THE IOB ARE GENERATED. THE LABELS
.*       FOR THESE FIELDS ARE MUTUALLY EXCLUSIVE OF THE LABELS
.*       GENERATED BY THE IEZIOB MACRO. CODE IOB=NO TO BYPASS
.*       IOB LABELS IN IECDSECT. SEE DESCRIPTION OF PARMS IN
.*       THE PROLOGUE OF THIS MACRO.
.*
.*       EXAMPLE: IECDSECS (MAIN,(IOB,YES))
.*
&N       SETA  &C1                      SET N=1                  Y02080
&KWD1    SETC  '&YES'                   SET KEYWORD TO DEFAULT   Y02080
.IEC3000 AIF   (&N+&C3-&C1+&C1 GT K'&IECDSPM(30)).IEC3030 LENGTH Y02080
         AIF   ('&IECDSPM(30)'(&N,&C3) EQ 'IOB').IEC3010 KEYWORD Y02080
&N       SETA  &N+&C1                   N=N+1                    Y02080
         AGO   .IEC3000                 LOOP                     Y02080
.*
.IEC3010 ANOP                           KEYWORD SPECIFIED        Y02080
&N       SETA  &N+&C3+&C1               SKIP OVER DELIMITER      Y02080
&KWD1    SETC  '&NULL'                  INITIALIZE TO NULL       Y02080
.IEC3020 AIF   (&N GT K'&IECDSPM(30)).IEC3030 CHECK THE LENGTH   Y02080
         AIF   ('&IECDSPM(30)'(&N,&C1) LT 'A').IEC3030 DELIMITER Y02080
&KWD1    SETC  '&KWD1'.'&IECDSPM(30)'(&N,&C1) MOVE CHAR TO PARM  Y02080
&N       SETA  &N+&C1                   N=N+1                    Y02080
         AGO   .IEC3020                 LOOP                     Y02080
.*
.IEC3030 SPACE 1
FORCORE  DSECT
         MNOTE '         IECDSECT IOB=&KWD1'                     Y02080
         IECDSECT IOB=&KWD1                                      Y02080
         SPACE 1
***********************************************************************
*        ADDITIONAL O/C/E FIELDS
***********************************************************************
         SPACE 1
         ORG   DXCCW5
DXDSNAME DS    CL17                     TEMP SAVE AREA FOR DSNAME OF
*                                       GENERATION DATA GROUP DATA SET
         SPACE 1
         ORG   DXCCW8
DXREGSAV DS    0CL32                    REG SAVE AREA FOR RES RTN
DXREG9   DS    F                        REGISTER 9
DXREGA   DS    F                        REGISTER 10
DXREGB   DS    F                        REGISTER 11
DXREGC   DS    F                        REGISTER 12
DXREGD   DS    F                        REGISTER 13
DXREGE   DS    F                        REGISTER 14
DXREG0   DS    F                        REGISTER 0
DXREG1   DS    F                        REGISTER 1
         SPACE 1
         ORG   DXCCW12                                           Y02134
DXIDENT  DS    0CL8                     MODULE IDENTIFIERS
DXCALLID DS    CL2                      ID OF CALLING MODULE
DXRETMOD DS    0CL5                     ID AND EPA OF RET MODULE
DXRETID  DS    CL2                      ID OF RETURN MODULE
DXRETTTR DS    CL3                      VCON OF RETURN MODULE    Y02134
DXRETCOD DS    CL1                      RET CODE ISSUED TO USER  Y02134
*                                       BY PROBLEM DETERMINATION Y02134
*                                       AT ABEND                 Y02134
*                                       ALSO USED AS INTERFACE   Y02134
*                                       TO SUBROUTINES           Y02134
         ORG   DXXCTL                                            Y02134
DXABCODE DS    CL2                      SYSTEM ABEND CODE ISSUED BY
*                                       PROBLEM DETERMINATION ROUTINE
DXSAVMOD DS    0CL5                     SAVED RETURN ADDRESS     Y02134
DXSAVID  DS    CL2                      ID OF SAVED RETURN MOD   Y02134
DXSAVADR DS    CL3                      SAVED VCON RETURN ADDRSS Y02134
DXSAVOFF DS    CL1                      SAVED RETURN OFFSET      Y02134
         SPACE 1                                                 Y02134
         ORG   DXRESSW                                           Y02134
DXRESIND DS    X                        INDIC USED BY IFG019RA   Y02134
         SPACE 1
         ORG   DXREG1
DXBTAMX  DS    CL1                      SET TO 0 BY IFG0196V AND YM0947
*                                       USED BY BTAM EXECUTORS
         EJECT
***********************************************************************
*
*        END-OF-VOLUME WHERE-TO-GO TABLE
*
*        NOTE- CHANGES TO THIS TABLE OR TO THE WHERE-TO-GO TABLE
*              DSECT SHOULD BE COORDINATED, BECAUSE THE TWO TABLES
*              ARE VIRTUALLY IDENTICAL IN USAGE AND ORGANIZATION.
*
***********************************************************************
         SPACE 1
         ORG   FORCORE+DSECTSIZ                                  Y02080
DXXWTG   DS    0F                       EOV WTG TABLE            Y02080
DXXWTOPR DC    AL2(12),AL2(0)           WTG WTO PREFIX           Y02080
DXXAREA  DS    0CL29                    WTG TABLE BASIC SECTION
DXXMODNM DS    0CL8                     MODULE NAME
         DS    CL6                      FIRST 6 BYTES OF MODULE NAME
DXXMODID DS    CL2                      MODULE ID
DXXMODEP DS    CL4                      USED FOR MODULE ADDRESS  Y02080
         DS    CL2                      NOT USED                 Y02080
DXXTTR   DS    0CL3                     ADR OF CSECT EP          Y02080
         DS    CL2
DXXPREFX DS    CL4                      POINTER TO PREFIX        Y02080
         DS    CL2
DXXATTRB DS    CL2                      NOT USED                 Y02080
DXXMODSZ DS    CL3                      NOT USED                 Y02080
DXXTXTLN DS    CL2                      NOT USED                 Y02080
DXXLNG   DS    0C                       NOT USED                 Y02080
DXOPCLSW DS    C                        SWITCHES FOR COMMUNICATING
*                                       BETWEEN OPEN, CLOSE AND E-O-V
DXXPATHS DS    CL2                      (NOT USED BY E-O-V)
DXXENTRY DS    0CL8                     FIRST ENTRY IN WTG TABLE
DXXIDTTR DS    CL5                      ID & VCON OF NEXT CSECT  Y02080
DXXCORE  DS    CL3                      ADDRESS OF MAIN WORK AREA
DXXLAST  DS    CL2,XL3,AL3              LAST ENTRY IN TABLE      Y02080
DXXEND   EQU   *-FORCORE                END OF PSEUDO WTG TABLE  Y02080
         SPACE 1
DXOWAEND EQU   FORCORE+DSECTSIZ         END OF OPEN  WORK AREA   Y02080
DXCWAEND EQU   FORCORE+DSECTSIZ         END OF CLOSE WORK AREA   Y02080
DXEWAEND EQU   FORCORE+DXXEND           END OF EOV   WORK AREA   Y02080
OPENSIZE EQU   DSECTSIZ                 SIZE OF OPEN  WORK AREA  Y02080
CLOSSIZE EQU   DSECTSIZ                 SIZE OF CLOSE WORK AREA  Y02080
EOVSIZE  EQU   DSECTSIZ                 SIZE OF EOV   WORK AREA  Y02080
*
***********************************************************************
         EJECT
.SKIPMN  ANOP                           ENTRANCE LABEL ONLY
         AIF   (NOT &IECDSCT(36)).SKIPPRE PREFIX REQUESTED?      Y02080
&PP1     SETC  'DS'                     SET DEFAULT FIRST PARM   Y02080
&PP2     SETC  '0D'                     SET DEFAULT SECOND PARM  Y02080
         AIF   (NOT &IECDSCT(34)).IEC3600 WTG REQUESTED?         Y02080
&PP1     SETC  'DSECT'                  SET DSECT INDICATOR      Y02080
&PP2     SETC  '&NULL'                  SET NULL                 Y02080
.IEC3600 ANOP                           GENERATE PREFIX AREA     Y02080
         SPACE 1
***********************************************************************
*        O/C/E/D WORK AREA PREFIX                                Y02080
***********************************************************************
         SPACE 1
IECPREFX &PP1  &PP2                     PREFIX TO ALL WORK AREAS Y02080
IECCORID DS    AL4                      4-CHAR ID OF THIS AREA   Y02080
         DS    AL4                                               Y02080
IECCORLN DS    AL4                      LENGTH OF THIS AREA      Y02080
IECCORAD DS    AL4                      POINTER TO THIS AREA     Y02080
IECCORKY DS    AL1                      STORAGE PROT KEY OF AREA Y02080
         DS    AL2                                               Y02080
IECCORSP DS    AL1                      SUBPOOL OF THIS WORK AREAY02080
IECCORPS DS    AL4                      PTR TO INIT BASE PREFIX  Y02080
IECCORP1 DS    AL4                      POINTER TO PREV PREFIX   Y02080
IECCORP2 DS    AL4                      POINTER TO NEXT PRFX     Y02080
IECSTART DS    0D                       START OF WORK AREA       Y02080
*
***********************************************************************
         SPACE 1
***********************************************************************
*        EXTENDED PREFIX DEFINITION
*              THE FOLLOWING AREA IS ONLY ONCE WHEN
*              FIRST O/C/E/D IECRES GET IS ISSUED.
***********************************************************************
         SPACE 1
*        REGISTER 1 POINTS HERE ON RETURN FROM IECRES GET        Y02080
IECEXTPR DS    0D                       EXTENDED PRFX (1ST AREA) Y02080
IECREGSV DS    18F                      18 WORD REG SAVE AREA    Y02080
IECWTGTB DS    AL4                      POINTER TO WTG TABLE     Y02080
IECRRPRM DS    AL4                      PTR TO RECOVERY ROUTINE  Y02080
*                                       PARAMETER LIST
IECDAEND DS    0D                       PREFIX END (EOV/DADSM)   Y02080
         AIF   ('&PP1' NE 'DSECT').IEC3610 TEST FOR DADSM CALL   Y02080
IECDCBNO DS    0C                       NUMBER OF DCBS           Y02144
IECUPRML DS    AL4                      MOVED PARM LIST POINTER  Y02080
IECRESWA DS    AL4                      IFG019RA WORK AREA PTR   Y02080
IECMSGQA DS    AL4                      MESSAGE WORK AREA        Y02080
IECQMNGR DS    AL4                      QMNGRIO WORK AREA        Y02134
IECOCEND DS    0D                       END OF PREFIX FOR O/C/E  Y02080
.IEC3610 ANOP                                                    Y02080
*
***********************************************************************
         AIF   ('&PP1' EQ 'DSECT').IEC3620 TEST FOR DADSM CALL   Y02080
         SPACE 1
***********************************************************************
*        DADSM WHERE-TO-GO TABLE DEFINITION                           *
***********************************************************************
         SPACE 1
WTGWTOPR DC    AL2(12),AL2(0)           PREFIX FOR RES WTO       Y02080
WTG      EQU   *                        IECWTGTB POINTS HERE     Y02080
WTGMODNM DS    CL8                      MODULE NAME              Y02080
WTGMODEP DS    AL4                      MODULE ENTRY POINT ADDR  Y02080
*
***********************************************************************
         EJECT                                                   Y02080
.IEC3620 ANOP                           RECOVERY ROUTINE AREA    Y02080
         AIF   ('&PP1' NE 'DSECT').SKIPPRE TEST FOR DADSM CALL   Y02080
         SPACE 1
***********************************************************************
*        RESIDENT ROUTINE WORK AREA
***********************************************************************
         SPACE 1
RWARESWA DSECT                          RESIDENT ROUTINE ECBLIST Y02080
RWAPREFX DS    0CL12                    PREFIX TO ECB LIST       Y02080
RWATRACE DS    AL4                      POINTER TO TRACE ROUTINE Y02080
RWATRBUF DS    AL4                      POINTER TO TRACE BUFFER  Y02080
RWAPARM  DS    AL4                      PARAMETER LIST ADDRESS   Y02080
RWALIST  DS    0F                       LIST OF ECB POINTERS     Y02080
*                                       - 1 ECB/DCB IN PARM LIST Y02080
*
***********************************************************************
         SPACE 1
***********************************************************************
*        USER PARAMETER LIST (COPY)
***********************************************************************
         SPACE 1
USERPRML DSECT                                                   Y02080
DXDCBLST DS    F                        PSEUDO DCB PARAMETER LIST (SO
*                                       THAT EOV CAN INTERFACE WITH THE
*                                       RES RTN LIKE OPEN AND CLOSE)
*
*        THIS AREA IS VARIABLE IN LENGTH, DEPENDING
*        ON THE LENGTH OF THE USERS PARAMETER LIST.
*
***********************************************************************
         EJECT
.SKIPPRE ANOP                           ENTRANCE LABEL ONLY      Y02080
         AIF   (NOT &IECDSCT(39)).SKPRRPL RRPL REQUESTED?        Y02080
         SPACE 1
***********************************************************************
*        RECOVERY ROUTINE PARAMETER LIST
***********************************************************************
         SPACE 1
IECRRPL  DSECT                                                   Y02080
RRPLIST  DS    0F                       PARM LIST FOR RECOVERY   Y02144
RRFUNCTN DS    C                        OPEN/CLOSE/EOV/DADSM     Y02144
*                                       ..FUNCTION IN CONTROL    Y02144
RRFOPEN  EQU   X'13'                    OPEN FUNCTION INDICATOR  Y02144
RRFOPENJ EQU   X'16'                    OPEN TYPE=J INDICATOR    Y02144
RRFCLOS  EQU   X'14'                    CLOSE FUNCTION INDICATOR Y02144
RRFTCLOS EQU   X'17'                    OPEN TYPE=J INDICATOR    Y02144
RRFEOV   EQU   X'37'                    EOV FUNCTION INDICATOR   Y02144
RRFFEOV  EQU   X'1F'                    FEOV FUNCTION INDICATOR  Y02144
RRFRJFCB EQU   X'40'                    RDJFCB INDICATOR         Y02144
RRFDADSM EQU   X'80'                    DADSM FUNCTION INDICATOR Y02144
RRFALLOC EQU   X'A0'                    DADSM ALLOCATE           YM8515
RRFEXTND EQU   X'B7'                    DADSM EXTEND             YM8515
RRFPRLSE EQU   X'94'                    DADSM PARTIAL RELEASE    YM8515
RRFLSPAC EQU   X'CE'                    DADSM LSPACE             YM8515
RRFOBTN  EQU   X'9B'                    DADSM OBTAIN             YM8515
RRFRENAM EQU   X'9E'                    DADSM RENAME             YM8515
RRFSCRTH EQU   X'9D'                    DADSM SCRATCH            YM8515
*                                                                Y02144
RRFLAGS1 DS    C                        OPEN/CLOSE/EOV RECOVERY  Y02144
*                                       ..ROUTINE INDICATORS     Y02144
*****    RRFLAGS1 INDICATORS                                     Y02144
RRFUSREX EQU   X'40'                    USER EXIT IN CONTROL     Y02144
RRFAMEXG EQU   X'20'                    A.M. EXECUTOR IN CONTROL Y02144
RRFAMEXR EQU   X'10'                    A.M. EXEC RETURNED CNTRL Y02144
RRFAMSTR EQU   X'08'                    A.M. STRING IN CONTROL   Y02144
RRFNSL   EQU   X'04'                    NSL RTN GIVEN CONTROL    Y02144
RRFSMF   EQU   X'02'                    SMF IN CONTROL           Y02144
RRFTRACE EQU   X'01'                    TRACE ROUTINE IN CONTROL Y02144
*                                                                Y02144
RRFLAGS2 DS    C                        OPEN/CLOSE/EOV RECOVERY  Y02144
*                                       ..ROUTINE INDICATORS     Y02144
*****    RRFLAGS2 INDICATORS                                     Y02144
RRFFIN1  EQU   X'80'                    1ST LOAD OF FUNC DONE    Y02144
RRFENQPW EQU   X'20'                    ENQ ON PASSWORD DATA SET Y02144
RRFQMNGR EQU   X'10'                    QUEUE MANAGER IN CONTROL Y02144
RRFPRDET EQU   X'02'                    PROB DETERM IN CONTROL   Y02144
RRFENQUL EQU   X'01'                    ENQ ON UL TRACK          Y02144
*                                                                Y02144
RRFLAGS3 DS    C                        OPEN/CLOSE/EOV RECOVERY  Y02144
*                                       ..ROUTINE INDICATORS     Y02144
*****    RRFLAGS3 INDICATORS                                     Y02144
RRFNRTCA EQU   X'40'                    NO RTCA EXISTS           Y02144
RRFFINFC EQU   X'20'                    FINAL FORCE CLOSE PASS   Y02144
RRFFCEXC EQU   X'10'                    FORCE CLOSE EXEC IN CTRL Y02144
RRFTERM  EQU   X'08'                    TERM ENTRY               Y02144
*                                                                Y02144
RR1WRKAR DS    AL4                      RECOVERY ROUTINE WORK    Y02144
*                                       ..AREA ADDRESS           Y02144
RR1RETRY DS    AL4                      1ST LEVEL RECOVERY RTN   Y02144
*                                       ..BYPASS ADDRESS         Y02144
RRXRETRY DS    AL4                      FOR OPEN/CLOSE/EOV:      Y02144
*                                       ..RECOVERY RTN EXECUTOR  Y02144
*                                       ..BYPASS ADDRESS         Y20144
RRUCBPTR EQU   RRXRETRY                 FOR DADSM: UCB ADDRESS   Y02144
RRMLRTRY DS    AL4                      OPEN/CLOSE/EOV RETRY PTR Y02144
RRFWORK  DS    AL4                      WORK WORD                Y02144
RRPLEND  EQU   *                        DEFINE END OF AREA       Y02080
*
***********************************************************************
         EJECT
.SKPRRPL ANOP                                                    Y02080
         AIF   (NOT &IECDSCT(46)).SKIPDSM   DSMADT REQUESTED?    Y02144
         SPACE 1
***********************************************************************
*        DADSM RECOVERY ROUTINE AUDIT TRAIL AREA
***********************************************************************
         SPACE 1
DSMADTW1 DS    0F                       DADSM SWITCHES           Y02144
DSMADTB1 DS    B                        GENERAL STATUS SWITCHES  Y02144
*                                                                Y02144
DSMISAM  EQU   X'80'                    ISAM ALLOCATE            Y02144
DSMVIO   EQU   X'40'                    VIO ALLOCATE             Y02144
DSMLOCK  EQU   X'08'                    LOCAL MEMORY LOCK GOTTEN Y02144
DSMRPSAP EQU   X'04'                    RPS APPENDAGE LOADED     Y02144
DSMUCBAL EQU   X'02'                    UCB DYNAMICALLY ALLOCATD Y02144
DSMASWAP EQU   X'01'                    SYSEVENT OKSWAT INDICATR YM8511
*                                                                Y02144
DSMADTB2 DS    B                        ENQ STATUS SWITCHES      Y02144
*                                                                Y02144
DSMVTOCR EQU   X'80'                    ENQ'ED ON SYSVTOC        Y02144
DSMSMCE  EQU   X'40'                    ENQ'ED SMC ON SYSVTOC    Y02144
DSMTIOTE EQU   X'20'                    ENQ'ED ON SYSZTIOT       Y02144
DSMDSNE  EQU   X'10'                    ENQ'ED ON SYSDSN         Y02144
DSMDMNTE EQU   X'08'                    ENQ'D  ON SYSZDMNT         @01A
*                                                                Y02144
DSMADTB3 DS    B                        RESERVED                 Y02144
DSMADTB4 DS    B                        RESERVED                 Y02144
DSMADTW2 DS    F                        POINTER TO SYSZTIOT ENQ  Y02144
*                                       MINOR NAME FOR OBTAIN,   Y02144
*                                       RENAME, AND SCRATCH      Y02144
*                                       POINTER TO SYSZDMNT ENQ    @01A
*                                       MINOR NAME FOR OBTAIN,     @01A
*                                       AND LSPACE IF DSMADTB2     @01A
*                                       EQUALS DSMDMNTE (X'08')    @01A
DSMADTW3 DS    F                        POINTER TO DSNAME FOR    Y02144
*                                       OBTAIN (SEARCH OPTION),  Y02144
*                                       RENAME, AND SCRATCH.     Y02144
*                                       POINTER TO THE VDSCB FOR Y02144
*                                       VIO ALLOCATE             Y02144
DSMADTW4 DS    F                        DSAB ADDRESS FOR RENAME  Y02144
*                                       AND SCRATCH              Y02144
*                                       DSAB LIST ADDRESS FOR    Y02144
*                                       ISAM ALLOCATE            Y02144
DSMADTW5 DS    F                        RESERVED                 Y02144
DSMADTW6 DS    F                        RESERVED                 Y02144
*                                                                Y02144
***********************************************************************
.SKIPDSM       ANOP                                              Y02144
         AIF   (NOT &IECDSCT(34)).SKIPWTG   BYPASS WTG IF NOT REQUESTED
         SPACE 1
***********************************************************************
*              WHERE-TO-GO TABLE DEFINITION                           *
***********************************************************************
*
*        NOTE- CHANGES TO THIS TABLE OR THE END-OF-VOLUME WTG TABLE
*              IN THE 'FORCORE' DSECT SHOULD BE COORDINATED, SINCE
*              THE TWO TABLES ARE VIRTUALLY IDENTICAL IN USAGE AND
*              ORGANIZATION.
*
***********************************************************************
         SPACE 1
WTGTABLE DSECT
WTGWTOPR DC    AL2(12),AL2(0)           WTG WTO PREFIX           Y02080
WTG      EQU   *                        IECWTGTB POINTS HERE     Y02080
WTGAREA  DS    0CL29                    WTG TABLE BASIC SECTION
WTGMODNM DS    0CL8                     MODULE NAME
         DS    CL6                      FIRST 6 BYTES OF MODULE NAME
WTGMODID DS    CL2                      MODULE ID
WTGMODEP DS    AL4                      CSECT EPA                Y02080
         DS    CL2                      NOT USED                 Y02080
WTGTTR   DS    0CL3                     NOT USED                 Y02080
         DS    CL2
WTGPREFX DS    CL4                      POINTER TO PREFIX        Y02080
         DS    CL2
WTGATTRB DS    CL2                      NOT USED                 Y02080
WTGMODSZ DS    CL3                      NOT USED                 Y02080
WTGTXTLN DS    CL2                      NOT USED                 Y02080
WTGLNG   DS    C                        NOT USED                 Y02080
WTGPATHS DS    CL2                      'OPEN'/'CLOSE' PROCESSING INDS
*** WTGPATHS INDICATORS
WTGPRLSE EQU   X'80' -                  DA PARTIAL RELEASE WAS REQ'D
WTGNSL   EQU   X'40' -                  NSL TAPE INPUT PROCESSING
*                                       ..REQUIRES THE DSNAME WTO MOD
WTGTCLOS EQU   X'20' -                  TCLOSE XCTL'D TO NSL ROUTINES
WTGSMF   EQU   X'10'                    SMF IS ACTIVE AND REQUIRED
*                                       ..FOR THIS DATA SET
WTGJFCBW EQU   X'08'                    JFCB HAS BEEN ALTERED AND MUST
*                                       ..BE WRITTEN BACK TO JOBQUEUE
WTGSPMSG EQU   X'04'                    SUPPRESS ADDITIONAL     YA02128
*                                       ..3270 NOT READY MSGS   YA02128
*                                       ..FOR BTAM OPEN         YA02128
*** WTGPATHS+1 INDICATORS
WTGTSENQ EQU   X'04' -                  WAS TSO ENQ SUCCESSFUL?  Y01018
WTGTRACE EQU   X'80' -                  OPTIONAL TRACE FACILITY REQ'D
WTGRECHK EQU   X'02' -                  INCORRECT NSL VOL WAS MOUNTED
WTGOPD   EQU   X'01' -                  LAST LOAD OF OPEN REQUIRES
*                                       ..PROBLEM DETERMINATION, BUT
*                                       ..ADD'L DCB'S MUST FIRST
*                                       ..BE COMPLETED
WTGENTRY DS    0CL8 -                   FIRST ENTRY IN WTG TABLE
WTGIDTTR DS    CL5 -                    ID AND TTR OF NEXT MODULE
WTGCORE  DS    CL3 -                    ADDRESS OF MAIN WORK AREA
WTGEND   EQU   * -                      END OF THE WHERE-TO-GO TABLE
*
         AIF   (NOT &IECDSCT(36) OR NOT &IECDSCT(39) OR                *
               NOT &IECDSCT(34)).SKIPWTG PREFIX, WTG, & RRPLIST  Y02080
WTGFIXED EQU   IECOCEND-IECEXTPR+WTGEND-WTGTABLE+RRPLEND-IECRRPL+RWALIS*
               T-RWARESWA               STATIC LEN OF 1ST W/A    Y02080
***********************************************************************
         EJECT
.SKIPWTG ANOP                           ENTRANCE LABEL ONLY
         AIF  (NOT &IECDSCT(33)).SKIPUT  BYPASS USERTOT IF NOT REQ'D
         SPACE 1
***********************************************************************
*              USER TOTALING FACILITY SAVE AND WORK AREA              *
***********************************************************************
*
TOTSAVWA DSECT
TOTSVPTR DS    F                        ADDR OF THE SAVE RTN
TOTCURNT DS    F                        ADDR OF CURRENT SAVE SEGMENT
TOTSTART DS    F                        BEGINNING ADDR OF SAVE SEGMENTS
TOTENDAD DS    F                        ADDR OF LAST SAVE SEGMENT
TOTSVLNG DS    F                        LENGTH OF THE USER'S SAVE AREA
TOTUSRWA DS    F                        ADDR OF THE USERS TOT AREA
TOTTOTLN DS    F                        TOTAL LENGTH OF GETMAIN
TOTEOVPT DS    F                        POINTER TO EOV SEG
TOTREGSV DS    D                        SAVE AREA FOR R11 & R12
         DS    D                        SAVE AREA  FOR REG'S
*
**********
         EJECT
.SKIPUT  ANOP                           ENTRANCE LABEL ONLY
         AIF  (NOT &IECDSCT(32)).SKIPUL BYPASS USERLAB IF NOT REQ'D
         SPACE 1
***********************************************************************
*    USER LABEL WORK AREA DEFINITION FOR DATA MANAGEMENT ROUTINESY02082
***********************************************************************
*
ULDMWK   DSECT                                                   Y02082
ULREGSAV DS    0F                       SAVE AREA FOR CALLER'S REGS
ULREG5   DS    F                        SAVE AREA FOR REGISTER 5
ULREG6   DS    F                        SAVE AREA FOR REGISTER 6
ULREG7   DS    F                        SAVE AREA FOR REGISTER 7
ULREG8   DS    F                        SAVE AREA FOR REGISTER 8
ULREG9   DS    F                        SAVE AREA FOR REGISTER 9
ULREG10  DS    F                        SAVE AREA FOR REGISTER 10
ULREG11  DS    F                        SAVE AREA FOR REGISTER 11
ULREQ    DS    F                        SAVE AREA FOR REGISTER 12,
*                                       CONTAINS UL DCB EXIT LIST ENTRY
*
ULWK1    DS    1F                       WORK AREA
ULRETCOD EQU   ULWK1+3                  SAVE AREA FOR USER RETURN CODE
ULWK2    DS    1F                       BYTE 0 USED FOR SWITCH
ULCNT    EQU   ULWK2+2
ULWK3    DS    1F                       WORK AREA
ULWK4    DS    1F                       WORK AREA
ULWK5    DS    1F                       WORK AREA
ULWK6    DS    1F                       WORK AREA
ULWK7    DS    1F                       WORK AREA
ULWK8    DS    1F                       WORK AREA
ULWK9    DS    1F                       WORK AREA
ULWK10   DS    1F                       WORK AREA
*
ULDMBUFR DS    CL80                     USER LABEL BUFFER FOR    Y02082
ULDMEND  EQU   *                        DATA MANAGEMENT ROUTINES Y02082
*****************************************************************Y02082
*    USER LABEL WORK AREA DEFINITION FOR USER                    Y02082
*****************************************************************Y02082
ULUWK    DSECT                                                   Y02082
ULBUFR   DS    CL80                     USER LABEL BUFFER
*
ULPARM   DS    0CL16                    PARAMETER LIST
ULBUFPTR DS    F                        POINTER TO USER LABEL BUFFER
ULDCBPTR DS    F                        ADDR OF USER'S DCB
ULERRPTR DS    F                        POINTER TO WORK IOB ERROR INFO
ULTOTPTR DS    F                        POINTER TO USER TOTALING AREA
ULUEND   EQU   *                                                 Y02082
*
*****    USER LABEL EXIT RETURN CODES
*
READNEXT EQU   4 *                      USER LABEL RETURN CODE- READ
*                                       ..NEXT LABEL AND REURN TO USER
WRITNEXT EQU   8 *                      USER LABEL RETURN CODE- WRITE
*                                       ..LABEL AND REURN TO USER
*
USERLU   EQU   ULUEND-ULUWK             USER'S UL AREA LENGTH    Y02082
USERLDM  EQU   ULDMEND-ULDMWK           DATA MGT UL AREA LENGTH  Y02082
RDNEXT   EQU   READNEXT
WRITEUPD EQU   WRITNEXT
WRITERET EQU   WRITNEXT
*
**********
         EJECT
.SKIPUL  ANOP                           ENTRANCE LABEL ONLY
         AIF  (NOT &IECDSCT(31)).SKIPTAB BYPASS UNITTAB IF NOT REQ'D
         SPACE 1
***********************************************************************
*              UNIT TABLE WORK AREA DEFINITION                        *
***********************************************************************
*
UNITABLE DSECT
UNITSICC DS    H
UNITSIHH DS    H
UNITTRLN DS    H
UNITDVHI DS    CL1
UNITOVHL DS    CL1
UNITOVHK DS    CL1
UNITFLAG DS    CL1
UNITTOLR DS    H
UNITTULR DS    H
UNITTVLR DS    H
*
**********
         EJECT
.SKIPTAB ANOP                           ENTRANCE LABEL ONLY
         AIF   (NOT &IECDSCT(35)).SKIPSEC  BYPASS SEC IF NOT REQ'D
         SPACE 1
***********************************************************************
*              SECURITY WORK AREA DEFINITION                          *
***********************************************************************
*
SECCORE  DSECT
*                                                                Y02134
MYPREFIX DS    0F                       BEGINNING OF PREFIX      Y02134
*                                                                Y02134
         ORG   SECCORE+IECOCEND-IECSTART                         Y02134
*                                                                Y02134
MYVSAMWA DS    4F                       WORK AREA FOR VSAM       Y02134
*                                                                Y02134
MYCODE1  DS    X                        CALLER INDICATOR         Y02134
*                                       0 = OPEN                 Y02134
*                                       1 = EOV                  Y02134
*                                       2 = RENAME               Y02134
*                                       3 = SCRATCH              Y02134
*                                       4 = RESTART DA           Y02134
*                                       5 = RESTART TAPE         Y02134
MYCODE2  DS    X                        TRY COUNT                Y02134
*                                                                Y02134
MYERRCOD DS    X                        ERROR RETURN CODE        Y02134
MYRETCOD DS    X                        RETURN LOAD OFFSET       Y02134
MYRETMOD DS    0CL12,CL8,A              RETURN LOAD NAME AND EP  Y02134
MYRETURN DS    A                        CALLER SAVE AREA         Y02134
         DS    0D                       ALIGN BOUNDARY           Y02134
*                                                                Y02134
*****************************************************************Y02134
*                                                                Y02134
*        THE FOLLOWING FIELDS IN THIS DSECT MUST BE              Y02134
*        COORDINATED WITH FIELDS IN THE IECDSECT MACRO           Y02134
*                                                                Y02134
*****************************************************************Y02134
*                                                                Y02134
MYDSCB   DS    0CL96                    DSCB AREA                Y02134
MYRPLLTH DS    0X'08'                   WTOR REPLY LENGTH = 8    Y02134
MYRPLADR DS    A                        WTOR REPLY ADDR          Y02134
MYRPLECB DS    A                        WTOR REPLY ECB ADDR      Y02134
MYMSIZE  DS    H                        WTO/R MESSAGE LENGTH     Y02134
MYMCSFLG DS    X'8000'                  WTO/R MCS FLAG           Y02134
MYMAREA  DS    0CL64                    TEXT AND MCS CODES       Y02134
MYMIEC   DS    C'IEC301A '              MESSAGE ID AND A BLANK   Y02134
MYMNOID  DS    C'S JOB '                FIXED PART OF MESSAGE    Y02134
MYMJOBN  DS    CL8                      TIOT JOB NAME HERE       Y02134
MYMSTEP  DS    C',STEP '                FIXED PART OF MESSAGE    Y02134
MYMSTEPN DS    CL8                      TIOT STEP NAME HERE      Y02134
MYMDDNM  DS    C',DDNAME '              FIXED PART OF MESSAGE    Y02134
MYMDDNMN DS    CL8                      TIOT DDNAME HERE         Y02134
MYMCONC  DS    C',CONC'                 FIXED PART OF MESSAGE    Y02134
MYMCONCN DS    C'000'                   CONCATENATION NO. HERE   Y02134
MYMFLAGC DS    XL4                      MCS ROUTCDE & DESC CODES Y02134
MYMDSN   EQU   MYMNOID+2                'DSNAME ' FIXED          Y02134
MYMDSNN  EQU   MYMDSN+7                 DSNAME INSERTED HERE     Y02134
*                                                                Y02134
         ORG   MYDSCB+DXJBF-FORCORE                              Y02134
*                                                                Y02134
MYAREA   DS    0CL176                   176 BYTE PASSWORD AREA   Y02134
MYDSN    DS    CL44                     DATA SET NAME            Y02134
MYREPLY  DS    CL8                      PASSWORD READ AREA       Y02134
*                                                                Y02134
MYLOGFLD DS    0CL80                    PASSWORD RECORD          Y02134
*                                                                Y02134
MYCNTR   DS    H                        BINARY USE COUNT         Y02134
MYMODE   DS    X                        PROTECTION MODE INDICATR Y02134
         DS    77C                      LOGGING FIELD (OPTIONAL) Y02134
*                                                                Y02134
MYSYSDSN DS    CL44                     DSNAME WORK AREA         Y02134
*                                                                Y02134
         ORG   MYDSCB+DXECB-FORCORE                              Y02134
*                                                                Y02134
MYECB    DS    F                        ECB FOR I/O              Y02134
MYIOB    DS    CL32                     IOB FOR I/O              Y02134
MYDAADDR DS    D                        MBBCCHHR                 Y02134
MYYYY    DS    0F                       ALIGN WORK DEB TO FULL WORD
MYDEB    EQU   MYYYY-4                  BASE ADDR OF THIS WORK DEB
MYDEBDEB DS    A                        ADDRESS OF NEXT DEB (NOT USED)
MYDEBIRB DS    A                        ADDRESS OF IRB (NOT USED)
MYDEBSYS DS    F                        ATTRIBUTES (NOT USED)    Y02134
MYDEBNMX DS    0X'01'                   NO. OF EXTENTS = 1
MYDEBUSR DS    A                        ADDR IOB PURGE CHAIN (NOT USED)
MYDEBECB DS    A                        ADDRESS PURGE ECB (NOT USED)
MYDEBID  DS    0X'0F'                   0 PROTECT KEY, DEB ID
MYDEBDCB DC    A(MYDCB)                 ADDRESS OF WORK DCB      Y02134
MYDCBAD  EQU   MYDEBDCB                 DCB ADDRESS              Y02134
MYDEBAPP DS    A                        ADDR SYS1.SVCLIB APP VECTOR TBL
MYDEBMOD DS    0X                       DIRECT ACCESS FILE MASK
MYDEBUCB DS    A                        ADDRESS OF UCB
MYDEBBIN DS    H                        BIN NUMBER
MYDEBSCC DS    H                        CYLINDER START ADDRESS
MYDEBSHH DS    H                        HEAD START ADDRESS
MYDEBECC DS    H                        CYLINDER END ADDRESS
MYDEBEHH DS    H                        HEAD END ADDRESS
MYDEBNTR DS    H                        NO. OF TRACKS IN EXTENT
*
MYXXX    DS    0F                       SHORT DCB                Y02134
MYDCB    EQU   MYXXX-44                 DCB ADDRESS              Y02134
MYDCBDEB DC    A(MYDEB)                 ADDRESS OF DEB           Y02134
*                                                                Y02134
MYCCW    DS    CL96                     12 CCWS                  Y02134
*                                                                Y02134
MYXCTL   DS    0D                       XCTL PARAMETER LIST      Y02134
*                                                                Y02134
MYENQSW1 DS    F                        ENQ/DEQ CONSTANT         Y02134
MYENQSW2 DS    A                        POINTER TO 8 BYTE QNAME  Y02134
MYENQSW3 DS    A                        POINTER TO 44 BYTE RNAME Y02134
MYENQSW4 DC    C'SYSZPSWD'              8 BYTE QNAME = SYSZPSWD  Y02134
*                                                                Y02134
         ORG   MYDSCB+DXASCBAD-FORCORE                           Y02134
*                                                                Y02134
MYASCB   DS    A                        ASCB ADDRESS             Y02134
MYTCB    DS    A                        TCB ADDRESS              Y02134
MYJSCB   DS    A                        JSCB ADDRESS             Y02134
MYDSABQD DS    A                        DSAB QDB ADDRESS         Y02134
MYDSABAD DS    A                        FIRST DSAB (CONCATNATN)  Y02134
MYDSAB   DS    A                        CURRENT DSAB             Y02134
MYTIOT   DS    A                        TIOT ADDRESS             Y02134
MYUCB    DS    A                        UCB ADDRESS              Y02134
*                                                                Y02134
         ORG   MYDSCB+DXOWAEND-FORCORE                           Y02134
*                                                                Y02134
MYWTGWTO DC    0XL4'00',AL2(12),AL2(0)  MODULE TRACE WTO PREFIX  Y02134
MYWTG    DS    0CL32                    WTG TABLE                Y02134
MYWTGNM  DS    CL8                      CURRENT MODULE NAME      Y02134
MYWTGEP  DS    A                        CURRENT MODULE ENTRY PT  Y02134
         DS    A                        NOTUSED                  Y02134
MYPREFX  DC    A(MYPREFIX)              POINTER TO PREFIX        Y02134
*                                                                Y02134
         ORG   MYDSCB+DXEWAEND-FORCORE                           Y02134
*                                                                Y02134
SECSIZE  EQU   *-SECCORE                LENGTH OF THIS DSECT
*
***********************************************************************
         EJECT
.SKIPSEC ANOP                           ENTRANCE LABEL ONLY
         AIF   (NOT &IECDSCT(37)).SKIPVSP BYPASS VSAM PARM LIST  X02898
         SPACE 1
***********************************************************************
*        VSAM WORK AREA DEFINITION                               Y02080
***********************************************************************
         SPACE 1
*        IDAPDPRM                                                Y02080
         IDAPDPRM                                                X02989
*
***********************************************************************
         EJECT
.SKIPVSP ANOP                                                    X02989
         AIF   (NOT &IECDSCT(44)).SKIPAPP  BYPASS APP NAME TBL   Y02082
         SPACE 1                                                 Y02082
***********************************************************************
*              APPENDAGE NAME TABLE DEFINITION                   Y02082
***********************************************************************
*                                                                Y02082
APPNMTBL DSECT                          APPENDAGE NAME TABLE     Y02082
APPBAL   DS    H                        BALANCE OF UNUSED CORE   Y02082
APPSIZE  DS    H                        SIZE OF APP NAME TABLE   Y02082
APPENTRY DS    5F                       ENTRY FOR EACH APP TYPE  Y02082
APPNAMID DS    0C                       LIST OF VALID APP IDS    Y02082
*                                                                Y02082
APPTYPE  DSECT                          DEFINITION OF ONE ENTRY  Y02082
APPCOUNT DS    H                        COUNT OF APPENDAGE IDS   Y02082
APPOFFST DS    H                        OFFSET TO IDS, THIS TYPE Y02082
*                                                                Y02082
***********************************************************************
         EJECT                                                   Y02082
.SKIPAPP ANOP                           ENTRANCE LABEL ONLY      Y02082
         AIF   (NOT &IECDSCT(45)).SKIPEVL BYPASS EOV LAST W/A    Y02082
         SPACE 1                                                 Y02082
***********************************************************************
*        EOV LAST LOAD WORK AREA                                      *
***********************************************************************
*                                                                Y02082
EOVLAST  DSECT                          EOV SPECIAL WORK AREA    Y02082
EOVREGSV DS    18F                      REGISTER SAVE AREA       Y02082
EOVDEBAD DS    F                        DEB ADDRESS              Y02082
EOVUKEY  DS    CL1                      USER KEY                 Y02082
         DS    AL3                      DEAD SPACE               Y02082
EOVVOLSW DS    F                        VOL SWITCH INDR          Y02082
EOVENT1  DS    F                        BDAM/VS FIRST ENTRY INDR Y02082
EOVURGSV DS    F                        ADDR USER REG SAVE AREA  Y02082
*                                                                Y02082
***********************************************************************
         EJECT                                                   Y02082
.SKIPEVL ANOP                           ENTRANCE LABEL ONLY      Y02082
         AIF   (NOT &IECDSCT(47)).SKIPCDE BYPASS CDE             Y02080
         SPACE 1                                                 Y02080
***********************************************************************
*        CONTENTS DIRECTORY ENTRY                                     *
***********************************************************************
         IHACDE                                                  Y02080
*                                                                Y02080
***********************************************************************
         EJECT                                                   Y02080
.SKIPCDE ANOP                                                    Y02080
         AIF   (NOT &IECDSCT(48)).SKIPLPD BYPASS LPDE            Y02080
         SPACE 1                                                 Y02080
***********************************************************************
*        LINK PACK DIRECTORY ENTRY                                    *
***********************************************************************
         IHALPDE                                                 Y02080
*                                                                Y02080
***********************************************************************
         EJECT                                                   Y02080
.SKIPLPD ANOP                                                    Y02080
         AIF   (NOT &EXPRNT).EXIT       TEST FOR PRINT OFF       Y02080
         POP   PRINT                                             Y02080
.EXIT    ANOP                                                    Y02080
.*
.**********************************************************************
.*       FORGET PREVIOUS PARMS
.**********************************************************************
.*
&N       SETA  &C1                      N=1                      Y02080
&M       SETA  &LIMIT+&C1               M=LIMIT+1                Y02080
.EXIT010 AIF   (&N GT &M).EXIT020       IF N GT LIMIT+1, EXIT    Y02080
&IECDSCT(&N) SETB 0                     INITIALIZE GLOBAL SWITCH Y02080
&IECDSPM(&N) SETC '&NULL'               INITIALIZE CALL PARMS    Y02080
&N       SETA  &N+&C1                   N=N+1                    Y02080
         AGO   .EXIT010                 LOOP                     Y02080
.*
.EXIT020 MEND
.*                                                             Y02134*/
*%PLSDSECS:;                            /*                     Y02134*/
*
*/*            EOV PORTION OF O/C/E WORKAREA                         */
*
*DCL 1 DXXWTG BDY(WORD) DEFINED(DSECTSIZ), /*EOV WTG TABLE           */
*      2 DXXWTOPR CHAR(4);              /*IFG019RA WTO PREFIX AREA   */
*DCL 1 DXXAREA DEFINED(DSECTSIZ) POS(5) BDY(WORD), /*MAIN WTG TABLE  */
*      2 DXXMODNM CHAR(8),              /*MODULE NAME                */
*        3 *        CHAR(6),            /*FIRST 6 BYTES OF MODULE NM */
*        3 DXXMODID CHAR(2),            /*MODULE ID                  */
*      2 DXXMODEP PTR(31),              /*MODULE ENTRY POINT         */
*      2 *        CHAR(4),              /*NOT USED                   */
*      2 DXXPREFX PTR(31),              /*ADDRESS OF PREFIX          */
*      2 *        CHAR(2),              /*NOT USED                   */
*      2 DXXATTRB CHAR(2),              /*NOT USED                   */
*      2 DXXMODSZ CHAR(3),              /*NOT USED                   */
*      2 DXXTXTLN CHAR(2),              /*NOT USED                   */
*      2 DXXLNG   CHAR(1),              /*NOT USED                   */
*        3 DXOPCLSW CHAR(1),            /*SWITCHES FOR COMMUNICATING
*                                         BETWEEN OPEN/CLOSE/EOV     */
*      2 DXXPATHS CHAR(2),              /*NOT USED BY EOV            */
*      2 DXXENTRY CHAR(8) BDY(WORD),    /*FIRST ENTRY IN WTG TABLE   */
*        3 DXXIDTTR CHAR(5),            /*ID & TTR/VCON OF NEXT CSECT*/
*          4 DXEID   CHAR(2),           /*ID OF NEXT CSECT           */
*          4 DXETTR  CHAR(3),           /*TTR/VCON OF NEXT CSECT     */
*        3 DXXCORE  PTR(24),            /*ADDRESS OF MAIN WORK AREA  */
*      2 DXXLAST CHAR(8) BDY(WORD),     /*LAST ENTRY IN WTG TABLE    */
*      2 DXXEND CHAR(0);                /*END OF WTG TABLE (EOV)     */
*
*/*            O/C/E/D WORK AREA PREFIX DEFINITION                   */
*
*DCL 1 IECPREFX BASED(WTGPREFX) BDY(WORD),
*      2 IECCORID CHAR(4),              /*ID OF THIS AREA            */
*      2 *        CHAR(4),
*      2 IECCORLN PTR(31),              /*LENGTH OF THIS AREA        */
*      2 IECCORAD PTR(31),              /*POINTER TO THIS AREA       */
*      2 IECCORKY CHAR(1),              /*KEY OF THIS AREA           */
*      2 *        CHAR(2),
*      2 IECCORSP CHAR(1),              /*SUBPOOL OF THIS AREA       */
*      2 IECCORPS PTR(31),              /*POINTER TO INITIAL PREFIX  */
*      2 IECCORP1 PTR(31),              /*POINTER TO PREVIOUS PREFIX */
*      2 IECCORP2 PTR(31),              /*POINTER TO NEXT PREFIX     */
*
*/*            EXTENDED PREFIX DEFINITION                            */
*/*            THE FOLLOWING AREA IS ONLY OBTAINED ONCE WHEN         */
*/*            FIRST O/C/E/D IECRES GET IS ISSUED.                   */
*
*      2 IECEXTPR BDY(WORD),            /*EXTENDED PREFIX            */
*        3 IECREGSV CHAR(72),           /*18 WORD SAVE AREA          */
*        3 IECWTGTB PTR(31),            /*POINTER TO WTG TABLE       */
*        3 IECRRPRM PTR(31),            /*POINTER TO RR PARM LIST    */
*/*            END OF PREFIX FOR DADSM/EOV                           */
*        3 IECUPRML PTR(31),            /*MOVED PARM LIST POINTER    */
*          4 IECDCBNO FIXED(8),         /*NUMBER OF DCBS             */
*        3 IECRESWA PTR(31),            /*IFG019RA WORK AREA PTR     */
*        3 IECMSGQA PTR(31),            /*MESSAGE WORK AREA          */
*        3 IECQMNGR PTR(31);            /*QMNGRIO WORK AREA          */
*
*/*            RESIDENT ROUTINE (IFG019RA) WORK AREA                 */
*
*DCL 1 RWARESWA BASED(IECRESWA) BDY(WORD),
*      2 RWAPREFX CHAR(12) BDY(WORD),   /*PREFIX TO ECB LIST         */
*        3 RWATRACE PTR(31),            /*POINTER TO TRACE ROUTINE   */
*        3 RWATRBUF PTR(31),            /*POINTER TO TRACE BUFFER    */
*        3 RWAPARM  PTR(31),            /*PARAMETER LIST ADDRESS     */
*      2 RWALIST PTR(31);               /*LIST OF ECB POINTERS       */
*
*/*            USER PARAMETER LIST (COPY)                            */
*
*DCL 1 USERPRML PTR(31) BDY(WORD) BASED,
*      2 DXDCBLST PTR(31);              /*PSUEDO DCB PARM LIST FOR   */
*                                       /*EOV                        */
*
*/*            RECOVERY ROUTINE PARAMETER LIST                       */
*
*DCL 1 IECRRPL BASED BDY(WORD),
*      2 RRPLIST,                       /*PARM LIST FOR RECOVERY     */
*        3 RRFUNCTN     CHAR(1),        /*OPEN/CLOSE/EOV/DADSM
*                                         FUNCTION IN CONTROL        */
*/* DEFINITION OF RRFUNCTN FIELD BY FUNCTION FOLLOWS THIS STRUCTURE  */
*          4 RRFDADSM   BIT(1),         /*DADSM FUNCTION INDICATOR   */
*          4 RRFRJFCB   BIT(1),         /*RDJFCB INDICATOR           */
*        3 RRFLAGS1     CHAR(1),        /*OPEN/CLOSE/EOV RECOVERY
*                                         ROUTINE INDICATORS         */
*          4 *          BIT(1),         /*RESERVED                   */
*          4 RRFUSREX   BIT(1),         /*USER EXIT IN CONTROL       */
*          4 RRFAMEXG   BIT(1),         /*A.M. EXECUTOR GIVEN CONTROL*/
*          4 RRFAMEXR   BIT(1),         /*A.M. EXEC RETURNED CONTROL */
*          4 RRFAMSTR   BIT(1),         /*A.M. STRING IN CONTROL     */
*          4 RRFNSL     BIT(1),         /*NSL RTN GIVEN CONTROL      */
*          4 RRFSMF     BIT(1),         /*SMF IN CONTROL             */
*          4 RRFTRACE   BIT(1),         /*TRACE ROUTINE IN CONTROL   */
*        3 RRFLAGS2     CHAR(1),        /*OPEN/CLOSE/EOV RECOVERY
*                                         ROUTINE INDICATORS         */
*          4 RRFFIN1    BIT(1),         /*1ST LOAD OF FUNCTION DONE  */
*          4 *          BIT(1),         /*RESERVED                   */
*          4 RRFENQPW   BIT(1),         /*ENQ'D ON PASSWORD DATA SET */
*          4 RRFQMNGR   BIT(1),         /*QUEUE MANAGER IN CONTROL   */
*          4 *          BIT(2),         /*RESERVED                   */
*          4 RRFPRDET   BIT(1),         /*PROBLEM DETERM IN CONTROL  */
*          4 RRFENQUL   BIT(1),         /*ENQ'D ON UL TRACK          */
*        3 RRFLAGS3     CHAR(1),        /*OPEN/CLOSE/EOV RECOVERY
*                                         ROUTINE INDICATORS         */
*          4 *          BIT(1),         /*RESERVED                   */
*          4 RRFNRTCA   BIT(1),         /*NO RTCA EXISTS             */
*          4 RRFFINFC   BIT(1),         /*FINAL FORCE CLOSE PASS     */
*          4 RRFFCEXC   BIT(1),         /*FORCE CLOSE EXEC IN CONTROL*/
*          4 RRFTERM    BIT(1),         /*TERM ENTRY                 */
*          4 *          BIT(3),         /*RESERVED                   */
*        3 RR1WRKAR     PTR(31),        /*RECOVERY RTN WORK AREA PTR */
*        3 RR1RETRY     PTR(31),        /*1ST LEVEL RECOVERY ROUTINE
*                                         BYPASS ADDRESS             */
*        3 RRXRETRY     PTR(31),        /*FOR OPEN/CLOSE/EOV:
*                                         RECOVERY ROUTINE EXECUTOR
*                                         BYPASS ADDRESS             */
*          4 RRUCBPTR   PTR(31),        /*FOR DADSM: UCB ADDRESS     */
*        3 RRMLRTRY     PTR(31),        /*OPEN/CLOSE/EOV RETRY ADDR  */
*        3 RRFWORK      PTR(31);        /*WORK WORD                  */
*
*/*   DEFINITION OF RRFUNCTN FIELD BY FUNCTION                       */
*
*DCL (RRFOPEN  CONSTANT('13'X),         /*OPEN FUNCTION              */
*     RRFOPENJ CONSTANT('16'X),         /*OPEN TYPE=J FUNCTION       */
*     RRFCLOS  CONSTANT('14'X),         /*CLOSE FUNCTION             */
*     RRFTCLOS CONSTANT('17'X),         /*CLOSE TYPE=T FUNCTION      */
*     RRFEOV   CONSTANT('37'X),         /*EOV FUNCTION               */
*     RRFFEOV  CONSTANT('1F'X),         /*FEOV FUNCTION              */
*     RRFALLOC CONSTANT('A0'X),         /*DADSM ALLOCATE FUNCTION    */
*     RRFEXTND CONSTANT('B7'X),         /*DADSM EXTEND FUNCTION      */
*     RRFPRLSE CONSTANT('94'X),         /*DADSM PARTIAL RELEASE      */
*     RRFLSPAC CONSTANT('CE'X),         /*DADSM LSPACE FUNCTION      */
*     RRFOBTN  CONSTANT('9B'X),         /*DADSM OBTAIN FUNCTION      */
*     RRFRENAM CONSTANT('9E'X),         /*DADSM RENAME FUNCTION      */
*     RRFSCRTH CONSTANT('9D'X)) BIT(8); /*DADSM SCRATCH FUNCTION     */
*
*/*            DADSM RECOVERY ROUTINE AUDIT TRAIL AREA               */
*
*DCL 1 DSMADTRL BASED BDY(WORD),
*      2 DSMADTW1,                      /*DADSM AUDIT TRAIL SWITCHES */
*        3 DSMADTB1    CHAR(1),         /*GENERAL STATUS SWITCHES    */
*          4 DSMISAM    BIT(1),         /*ISAM ALLOCATE              */
*          4 DSMVIO     BIT(1),         /*VIO ALLOCATE               */
*          4 *          BIT(2),         /*RESERVED                   */
*          4 DSMLOCK    BIT(1),         /*LOCAL MEMORY LOCK OBTAINED */
*          4 DSMRPSAP   BIT(1),         /*RPS APPENDAGE LOADED       */
*          4 DSMUCBAL   BIT(1),         /*UCB DYNAMICALLY ALLOCATED  */
*          4 DSMASWAP   BIT(1),         /*SYSEVENT OKSWAP IND  YM8511*/
*        3 DSMADTB2     CHAR(1),        /*ENQ STATUS SWITCHES        */
*          4 DSMVTOCR   BIT(1),         /*ENQ'ED ON SYSVTOC          */
*          4 DSMSMCE    BIT(1),         /*ENQ'ED SMC ON SYSVTOC      */
*          4 DSMTIOTE   BIT(1),         /*ENQ'ED ON SYSZTIOT         */
*          4 DSMDSNE    BIT(1),         /*ENQ'ED ON SYSDSN           */
*          4 DSMDMNTE   BIT(1),         /*ENQ'ED ON SYSZDMNT     @01A*/
*          4 *          BIT(3),         /*RESERVED               @01C*/
*        3 DSMADTB4    CHAR(1),         /*RESERVED                   */
*      2 DSMADTW2      PTR(31),         /*POINTER TO SYSZTIOT ENQ
*                                         MINOR NAME FOR OBTAIN,
*                                         RENAME, AND SCRATCH. OR -  */
*                                       /*POINTER TO SYSZDMNT ENQ
*                                         MINOR NAME FOR OBTAIN, AND
*                                         LSPACE IF DSMADTB2 EQUALS
*                                         DSMDMNTE (X'08')       @01A*/
*      2 DSMADTW3      PTR(31),         /*POINTER TO DSNAME FOR
*                                         OBTAIN (SEARCH OPTION),
*                                         RENAME, AND SCRATCH.
*                                         POINTER TO THE VDSCB FOR
*                                         VIO ALLOCATE               */
*      2 DSMADTW4      PTR(31),         /*DSAB ADDRESS FOR RENAME
*                                         AND SCRATCH                */
*      2 DSMADTW5      CHAR(4),         /*RESERVED                   */
*      2 DSMADTW6      CHAR(4);         /*RESERVED                   */
*
*/*            WHERE-TO-GO-TABLE                                     */
*
*DCL 1 WTGTABLE BASED(RWTG-LENGTH(WTGWTOPR)) BDY(WORD),
*                                       /*WTG TABLE                  */
*      2 WTGWTOPR CHAR(4);              /*IFG019RA WTO TRACE PREFIX  */
*DCL 1 WTG BASED(RWTG) BDY(WORD),       /*WTG TABLE MAIN SECTION     */
*      2 WTGAREA  CHAR(29) BDY(WORD),   /*WTG TABLE BASIC SECTION    */
*        3 WTGMODNM CHAR(8),            /*MODULE NAME                */
*          4 *        CHAR(6),          /*FIRST 6 BYTES OF MODULE NM */
*          4 WTGMODID CHAR(2),          /*MODULE ID                  */
*        3 WTGMODEP PTR(31),            /*CSECT ENTRY POINT ADDRESS  */
*        3 *        CHAR(4),            /*NOT USED                   */
*        3 WTGPREFX PTR(31),            /*POINTER TO PREFIX          */
*        3 *        CHAR(2),
*        3 WTGATTRB CHAR(2),            /*NOT USED                   */
*        3 WTGMODSZ CHAR(3),            /*NOT USED                   */
*        3 WTGTXTLN CHAR(2),            /*NOT USED                   */
*      2 WTGLNG   CHAR(1),              /*NOT USED                   */
*      2 WTGPATHS CHAR(2),              /*OPEN/CLOSE PROCESSING BITS */
*        3 WTGPRLSE BIT(1),             /*DA PARTIAL RELEASE REQUIRED*/
*        3 WTGNSL   BIT(1),             /*NSL TAPE INPUT             */
*        3 WTGTCOS  BIT(1),             /*TCLOSE XCTL'D TO NSL ROUTNS*/
*        3 WTGSMF   BIT(1),             /*SMF IS ACTIVE AND REQUIRED */
*        3 WTGJFCBW BIT(1),             /*JFCB HAS BEEN ALTERED AND
*                                         MUST BE REWRITTEN          */
*        3 *        BIT(3),             /*RESERVED                   */
*        3 WTGTRACE BIT(1),             /*OPTIONAL TRACE FACILITY RQD*/
*        3 *        BIT(4),             /*RESERVED                   */
*        3 WTGTSENQ BIT(1),             /*TSO ENQ SUCCESSFUL         */
*        3 WTGRECHK BIT(1),             /*INCORRECT NSL VOLUME MNTD  */
*        3 WTGOPD   BIT(1);             /*LAST LOAD OF OPEN REQUIRES:
*                                         PROBLEM DETERMINATION BUT
*                                         ADDITIONAL DCBS TO BE
*                                         PROCESSED                  */
*
*/*            WHERE TO GO TABLE ENTRY                               */
*
*DCL 1 WTGENTRY BASED(RWTGC) BDY(WORD), /*FIRST ENTRY IN WTG TABLE   */
*      2 WTGIDTTR CHAR(5),              /*ID AND TTR OF NEXT MODULE  */
*        3 WTGEID   CHAR(2),            /*ID OF NEXT MODULE          */
*        3 WTGETTR  CHAR(3),            /*TTR/CORE ADDRESS OF NEXT
*                                         MODULE                     */
*      2 WTGCORE  PTR(24);              /*ADDRESS OF WORKAREA        */
*
*/*            ADDITIONAL O/C/E FIELDS                               */
*
*DCL DXDSNAME CHAR(17) DEFINED(DXCCW5); /*TEMP SAVE AREA FOR DSNAME OF
*                                         GENERATION DATA GROUP DATA
*                                         SET                        */
*
*DCL 1 DXREGSAV DEFINED(DXCCW8),        /*REG SAVE AREA FOR RES RTN  */
*      2 DXREG9   CHAR(4),              /*REGISTER 9                 */
*      2 DXREGA   CHAR(4),              /*REGISTER 10                */
*      2 DXREGB   CHAR(4),              /*REGISTER 11                */
*      2 DXREGC   CHAR(4),              /*REGISTER 12                */
*      2 DXREGD   CHAR(4),              /*REGISTER 13                */
*      2 DXREGE   CHAR(4),              /*REGISTER 14                */
*      2 DXREG0   CHAR(4),              /*REGISTER 0                 */
*      2 DXREG1   CHAR(4);              /*REGISTER 1                 */
*
*DCL 1 DXIDENT DEFINED(DXCCW12),        /*PROB DETERMINATION AREAS
*                                         AND SUBRTN LINK AREA       */
*      2 DXCALLID CHAR(2),              /*ID OF CALLING MODULE       */
*      2 DXRETMOD CHAR(5),              /*ID AND TTR OF RET MODULE   */
*        3 DXRETID  CHAR(2),            /*ID OF RETURN MODULE        */
*        3 DXRETTTR CHAR(3),            /*TTR/VCON OF RETURN MODULE  */
*      2 DXRETCOD CHAR(1);              /*RETURN CODE ISSUED TO USER
*                                         BY PROBLEM DETERMINATION
*                                         AT ABEND
*                                         ALSO MOD ENTRY OFFSET      */
*
*DCL 1 *       DEFINED(DXXCTL),         /*SUBRTN LINKAGE AREA        */
*      2 DXABCODE CHAR(2),              /*SYSTEM ABEND CODE ISSUED BY
*                                         PROBLEM DETERMINATION RTN  */
*      2 DXSAVMOD CHAR(5),              /*SAVED MODULE ID/VCON       */
*        3 DXSAVID  CHAR(2),            /*SAVED MODULE ID            */
*        3 DXSAVADR CHAR(3),            /*SAVED MODULE ADDRESS       */
*      2 DXSAVOFF CHAR(1);              /*SAVED RETURN OFFSET        */
*
*DCL 1 *       DEFINED(DXRESSW),        /*RESIDENT ROUTINE INDICATOR */
*      2 DXRESIND CHAR(1);              /*INDICATORS FOR THE RES RTN */
*
*DCL DXBTAMX  CHAR(1) DEFINED(DXREG1);  /*SET TO 0 BY IFG0196V AND
*                                         USED BY BTAM EXECUTORS     */
*
*    DCL 1 APPNMTBL BASED,             /* APPENDAGE NAME TABLE       */
*          2 APPBAL  FIXED (15),       /* BALANCE OF UNUSED CORE     */
*          2 APPSIZE FIXED (15),       /* SIZE OF TABLE              */
*          2 APPENTRY (5) FIXED (31),  /* HEADER FOR ONE ENTRY       */
*            3 APPCOUNT FIXED (15),    /* COUNT OF NAMES, THIS TYPE  */
*            3 APPOFFST FIXED (15),    /* OFFSET TO 1ST NAME         */
*          2 APPNAMID CHAR (104);      /* LIST OF NAME IDS           */
*

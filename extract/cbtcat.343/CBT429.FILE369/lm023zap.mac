++ USERMOD(NZPIO01) /* I.O COUNTS IN IEF285I */.
++ VER(Z038) FMID(EBB1102) PRE(JBB1329 UZ84610)
  /*  THIS ZAP ALSO WORKS FOR IEFAB4A2 AT THE UZ75725 LEVEL.
      FOR OTHER LEVELS, LOOK IN FICHE FOR NAME DSABPTR, AND
      PLEASE SEE REMARKS BELOW  (FIND THE NAME "DSABPTR" IN
      THIS CODE).  ANOTHER NOTE.  MODULE IEFAB4B0 HASN'T
      CHANGED SINCE MVS 3.8, BUT MODULE IEFAB4A2, WHICH
      POINTS TO THE DSAB CONTROL BLOCK, AND WHICH IS NEEDED
      BY THIS ZAP, DOES CHANGE.  THEREFORE PLEASE DO THE
      FOLLOWING UCLIN TO NOTICE ANY IBM CHANGES TO MODULE
      IEFAB4A2.

   UCLIN CDS.
   REP MOD(IEFAB4A2) RMID(NZPIO01)
   ENDUCL.
          (WHERE THE RMID IS THE NAME OF THIS USERMOD)
  */
.
++ ZAP (IEFAB4B0).
 NAME IEFAB4B0
 EXPAND IEFAB4B0(128)
*                            ORG   CLRKEY
VER 0052 4220,B10B           STC   @02,@OLDKEY
*                            ORG   CLRTXT
VER 0076 D248,B0C1,B0C0      MVC   MSGBUFFR+1(73),MSGBUFFR  BLANK ENTIRE
*                            ORG   STEAL
VER 0156 9240,B0F8           MVI   MSGDISP+1,C' '      DISPLACED INSTRUC
*                            ORG   @EL00001
VER 02EE 4320,B10B           IC    @02,@OLDKEY
*                            ORG   @SIZDATD
VER 03E8 E600,010C           DC    AL1(230),AL3(@ENDATD-@DATD)
*                            ORG   PATCH
VER 045C 0000,0000,0000,0000 DC    4F'0'
VER 0464 0000,0000,0000,0000
*                            ORG   CLRKEY
REP 0052 4220,B120           STC   @02,@NEWKEY
*                            ORG   CLRTXT
REP 0076 D24D,B0C1,B0C0      MVC   MSGBUFFR+1(78),MSGBUFFR  BLANK ENTIRE
*                            ORG   STEAL
REP 0156 47F0,C440           B     PATCH
*                   MAINLINE EQU   *
*                            ORG   @EL00001
REP 02EE 4320,B120           IC    @02,@NEWKEY
*                            ORG   @SIZDATD
REP 03E8 E600,0130           DC    AL1(230),AL3(@NEWDATD-@DATD)
*
*                            ORG   PATCH
*                   PATCHOUT EQU   *
REP 045C 924F,B0B7           MVI   MSGLNGTH+3,79       SET MSGLNGTH TO 7
REP 0460 58A0,B048           L     @10,@PC00001        ADDR OF MSGID
REP 0464 9101,A000           TM    0(@10),X'01'        MSGID=1 ?
REP 0468 47E0,C4C6           BNO   PATEXIT                 NO ==> WE EXI
REP 046C 58A0,D004           L     @10,4(,@13)         ADDR OF IEFAB4A2'
REP 0470 58A0,A03C           L     @10,X'3C'(,@10)     IEFAB4A2'S R10
*        ICM   @10,15,X'13C'(@10)  ADDR OF DSAB (IEFAB4A2 DSABPTR
*                                       LEVEL JBB1326)
REP 0474 BFAF,A138           ICM   @10,15,X'138'(@10)  ADDR OF DSAB (IEF
*                                   LEVELS UZ75725 AND UZ84610)
REP 0478 4780,C4C6           BZ    PATEXIT             EXIT IF NO DSAB
REP 047C 58A0,A010           L     @10,DSABTIOT(,@10)  ADDR OF TIOT ENTR
REP 0480 1F66                SLR   @06,@06             CLEAR WORK REG
REP 0482 4960,A012           CH    @06,TIOPSTTB(,@10)  IS THERE A UCB EN
REP 0486 4780,C4C6           BZ    PATEXIT                NO ==> WE QUIT
REP 048A 5810,B058           L     @01,@PC00001+16     ADDR OF JSCB PTR
REP 048E 5810,1000           L     @01,0(,@01)         ADDR OF JSCB
REP 0492 5840,10D0           L     @04,JSCBTCBP(,@01)  ADDR OF INIT'S TC
REP 0496 5810,114C           L     @01,JSCTMCOR(,@01)  ADDR OF TIOT MGMT
REP 049A 5BA0,1018           S     @10,X'18'(,@01)     CALC TIOT ENTRY O
REP 049E BF4F,40A4           ICM   @04,15,TCBTCT(@04)  ADDR OF TIMING CO
REP 04A2 4780,C4C6           BZ    PATEXIT             EXIT IF NONE
REP 04A6 5840,400C           L     @04,TCTIOTBL(,@04)  ADDR OF TCT I/O T
REP 04AA 4150,4008           LA    @05,TCTDCBTD(,@04)  ADDR OF 1ST DD LO
*                   PATDDLOP EQU   *
REP 04AE 4960,5000           CH    @06,0(,@05)         LAST ENTRY IS ZER
REP 04B2 4780,C4C6           BZ    PATEXIT                  EXIT IF ZERO
REP 04B6 49A0,5000           CH    @10,0(,@05)         DO THE TIOT DISPL
REP 04BA 4780,C4AA           BE    PATPRINT                 YES ==> PRIN
REP 04BE 4150,5004           LA    @05,4(,@05)         BUMP TO NEXT DD T
REP 04C2 47F0,C492           B     PATDDLOP
*                   PATPRINT EQU   *
REP 04C6 4A40,5002           AH    @04,TCTIOTSD(,@05)  OFFSET TO THE DEV
*                                  (TCTDDENT OR TCBUCBP)
REP 04CA 5860,4004           L     @06,TCTDCTR(,@04)   GET THE I/O COUNT
REP 04CE 4E60,B0F8           CVD   @06,MSGDISP+1       INTO PACKED FORMA
REP 04D2 D209,B105,C4CE      MVC   MSGCOUNT(L'EDMSK1),EDMSK1 PREPARE TO
REP 04D8 DE09,B105,B0FC      ED    MSGCOUNT(L'EDMSK1),MSGDISP+5 STICK IN
REP 04DE 925C,B105           MVI   MSGCOUNT,C'*'       MARK WITH A SPLAT
*                   PATEXIT  EQU   *
REP 04E2 9240,B0F8           MVI   MSGDISP+1,C' '      DISPLACED INSTRUC
REP 04E6 47F0,C13E           B     MAINLINE
*
*                   EDMSK1   EQU   *
REP 04EA 6020,6B20,2020,6B20 DC    X'60206B2020206B202120'
REP 04F2 2120
* DECK PRODUCED BY THE ASMTOZAP UTILITY 86/12/23 104029

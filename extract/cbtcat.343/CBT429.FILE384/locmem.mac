./       ADD   NAME=$ASMJCL
//XXXASM JOB (XXXXXXX),'ASSEMBLER',CLASS=A,MSGCLASS=A,
//   NOTIFY=XXX
//*
//ASM PROC MEM=,DSN=
//ASM EXEC  PGM=IEV90,PARM=OBJECT,REGION=1200K
//SYSLIB DD DSN=SYS1.MACLIB,DISP=SHR
//       DD DSN=SYS1.AMODGEN,DISP=SHR
//SYSUT1   DD  UNIT=(SYSDA,SEP=SYSLIB),SPACE=(CYL,(10,5)),DSN=&SYSUT1
//SYSPUNCH DD  DUMMY,DCB=BLKSIZE=80
//SYSPRINT DD SYSOUT=(Y,,DS02),
//   DCB=(BLKSIZE=3509),UNIT=(,SEP=(SYSUT1,SYSPUNCH))
//SYSLIN   DD  DISP=(MOD,PASS),UNIT=SYSDA,SPACE=(CYL,(5,5,0)),
//             DSN=&&LOADSET
//SYSIN DD DSN=XXXXXX.DOR.&DSN.(&MEM),DISP=SHR
// PEND
//*------------------------------------------------------------
//SOURCE   EXEC ASM,MEM=LISTPDSI,DSN=LOCMEM
//*------------------------------------------------------------
//LKED EXEC  PGM=IEWL,PARM='MAP,LET,LIST,NCAL',
//        REGION=1000K
//SYSLIN   DD  DSN=&&LOADSET,DISP=(OLD,DELETE)
//         DD  DDNAME=SYSIN
//SYSLMOD  DD DSN=XXXXXX.DOR.LINKLIB2,DISP=SHR
//SYSISPF  DD DSN=ISP.V2R2M0.ISPLOAD,DISP=SHR
//SYSPRINT DD SYSOUT=(Y,,DS02)
//SYSIN DD *
     INCLUDE SYSISPF(ISPLINK)
     NAME LISTPDSI(R)
/*
./       ADD   NAME=$INSTALL
THE PROGRAM TO LIST MEMBER OF ANY PDS BY ISPF DATE ON EITHER
CREATED OR MODIFIED FORMAT.

TO INSTALL LOCMEM:

1. ASM AND LINKED LISTPDSI SOURCE. BE SURE TO INCLUDE ISPLINK
   MODULE FROM YOUR ISPF/PDF LOAD LIBRARY.  (SEE $ASMJCL).
2. COPY LOCMEM#P, LOCMEM#T AND LOCMEM#R PANELS TO ISPPLIB LIBRARY.
3. COPY TLOCMEM, TLOCMEM1, TLOCMEM2, AND TLOCMEM3 TUTORIAL PANELS TO
         ISPPLIB LIBRARY.
4. COPY LOCMEM$S  CLIST TO YOUR   SYSPROC/CLIST LIBRARY
5. ADD YOUR ISR OR ISP PROFILE COMMANDS WITH THE FOLLOWING CODE:
   BY ISPF OPTION 3.9.

   VERB      T      ACTION
   -------   -      --------------------------------------------
   LOCMEM    0      SELECT NEWAPPL(ISR) PANEL(LOCMEM#P)
                       LOCATE MEMBERS OF PDS BY ISPF DATE

NOTICE:  USE ISPF OPTION 3.3 TO COPY ISPCMDS OR ISRCMDS TO
         TSTCMDS OF YOUR PROFILE  LIBRARY.  AND THEN ADD THE
         NEW VERB BY ISPF OPTION 3.9 OF TST APPLICATION ID.
         AND ENTER "END" OF 3.9. AND THEN USE 3.3 TO COPY
         TSTCMDS BACK TO ISRCMDS OR ISPCMDS. AND RELOGON.

./       ADD   NAME=LISTPDSI
         MACRO
.*                                                      RON MURA, TPD
&LBL     ISPCALL &LIST,        CALL PARAMETERS                         X
               &EP=ISPLINK,                                            X
               &LISTLBL=,      LABEL FOR PARAMETER LIST (NON-REENT)    X
               &WKAREA=,       TO BUILD CALL LIST (REENTERANT CODE)    X
               &WKREG=,        WORK REGISTER (DEFAULT 1)               X
               &TRACE=         'OFF' OR BIT FOR TRACE MODE
.*  ONCE WKAREA, WKREG, AND TRACE ARE SPECIFIED, THEY ARE USED IN ALL
.*  SUBSEQUENT OCCURRENCES OF THIS MACRO, UNLESS THE PARAMETER IS
.*  EXPLICITLY CODED.
.*  NOTE: FIRST 4 BYTES OF WKAREA ARE USED TO STORE NUMERIC VALUES,
.*  WHICH ARE PRIMARILY LENGTH FIELDS.
         LCLA  &S,&T,&U,&TRCEMSK
         LCLB  &NUMSW
         LCLC  &NDX,&WKAR,&WKRG
         GBLC  &ISPRREG,&ISPRAR,&ISPTRC1
         GBLA  &ISPTRC2
&NDX     SETC  '&SYSNDX'
&S       SETA  1               SUBSCRIPT FOR GOING THRU &LIST
***********************************************************************
         AIF   (T'&LBL NE 'O').L1
*                  ISPCALL  -  INVOKE ISPF DIALOG SERVICES      ISPCALL
         AGO   .L2
.L1      ANOP
&LBL     DS    0H  ISPCALL  -  INVOKE ISPF DIALOG SERVICES      ISPCALL
.L2      ANOP
         AIF   (T'&LIST NE 'O').A1
         MNOTE 12,'*** ISPCALL PARAMETERS MUST BE PROVIDED ***'
         AGO   .EXIT
.A1      AIF   ('&LIST'(1,1) EQ '(').CHKTRCE
         MNOTE 12,'*** ISPCALL PARAMETERS MUST BE ENCLOSED IN PARENTHESX
               ES ***'
         AGO   .EXIT
.****************** ANALYZE "TRACE" PARAMETER *************************
.CHKTRCE AIF   (T'&TRACE EQ 'O' AND '&ISPTRC1' NE '').TRCE4
         AIF   (T'&TRACE EQ 'O' AND '&ISPTRC1' EQ '').TRCEOFF
         AIF   ('&TRACE'(1,1) EQ '(').TRCEON
         AIF   ('&TRACE' EQ 'OFF').TRCEOFF
         MNOTE 12,'*** INVALID TRACE PARAMETERS ***'
         AGO   .EXIT
.TRCEON  AIF   (T'&TRACE(2) EQ 'N').TRCE2
.TRCE8   MNOTE 12,'*** TRACE BIT (2ND PARAMETER) MUST BE 0 - 7 ***'
         AGO   .EXIT
.TRCE2   AIF   (&TRACE(2) GE 0 OR &TRACE(2) LE 7).TRCE3
         AGO   .TRCE8
.TRCE3   ANOP
&ISPTRC1 SETC  '&TRACE(1)'     SET GLOBAL VARIABLE
&ISPTRC2 SETA  &TRACE(2)       SET GLOBAL VARIABLE
.TRCE4   ANOP
&U       SETA  0
&TRCEMSK SETA  255
&T       SETA  128
.TRCE5   AIF   (&U GT 7).CHKREG
         AIF   (&ISPTRC2 NE &U).TRCE7
.TRCE6   ANOP
&U       SETA  &U+1
&T       SETA  &T/2
         AGO   .TRCE5
.TRCE7   ANOP
&TRCEMSK SETA  &TRCEMSK-&T
         AGO   .TRCE6
.TRCEOFF ANOP
&ISPTRC1 SETC  ''              SET GLOBAL VARIABLE
.****************** ANALYZE "WKREG" PARAMETER *************************
.CHKREG  AIF   (T'&WKREG EQ 'O').A2
&ISPRREG SETC  '&WKREG'        SET GLOBAL VARIABLE
.A2      AIF   ('&ISPRREG' EQ '').A3
&WKRG    SETC  '&ISPRREG'
         AGO   .CHKAREA
.A3      ANOP
&ISPRREG SETC  '1'             SET GLOBAL VARIABLE
         AGO   .A2
.****************** SEE IF USING PROVIDED WORKAREA ********************
.CHKAREA AIF   (T'&WKAREA NE 'O' OR '&ISPRAR' NE '').RENT
         AIF   (T'&LISTLBL EQ 'O').B1
&WKAR    SETC  '&LISTLBL'
         AGO   .B2
.B1      ANOP
&WKAR    SETC  'ISPC&NDX'      LABEL FOR MACRO WORKAREA
.B2      ANOP
&T       SETA  4*(N'&LIST+1)   LENGTH OF MACRO WORKAREA
         B     &WKAR.+&T             BRANCH AROUND DATA         ISPCALL
&T       SETA  N'&LIST+1
&WKAR    DC    &T.F'0'               PARAMETER LIST             ISPCALL
.******************** BUILD PARAMETER LIST ****************************
.LOOP    AIF   (&S GT N'&LIST).ENDLOOP
         AIF   ('&LIST(&S)'(1,1) EQ '''').C1 TEST FOR LITERAL
         AIF   (T'&LIST(&S) EQ 'N').NUM      TEST FOR NUMERIC
         AIF   ('&LIST(&S)'(1,1) EQ '(').REG TEST FOR REG NOTATION
         LA    &WKRG,&LIST(&S)       LOAD DATA ADDR             ISPCALL
.ST      ANOP
&T       SETA  4*&S
         ST    &WKRG,&WKAR.+&T       STORE IN PARAM LIST        ISPCALL
         AIF   ('&ISPTRC1' EQ '' OR &S GT 1).C3           TRACE
         TM    &ISPTRC1,&TRCEMSK     IS TRACE BIT ON?     TRACE ISPCALL
         BZ    ISPT&NDX                                   TRACE ISPCALL
         AIF   ('&WKRG' EQ '1' OR '&WKRG' EQ 'R1').C4     TRACE
         LR    1,&WKRG               LOAD SRVC NAME ADDR  TRACE ISPCALL
.C4      AIF   ('&LIST(&S)'(1,1) EQ '''').C5 LITERAL?     TRACE
         LA    0,8                   LOAD LENGTH          TRACE ISPCALL
         AGO   .C6                                        TRACE
.C5      ANOP                                             TRACE
&U       SETA  K'&LIST(&S)-2   LENGTH OF SERVICE NAME     TRACE
         LA    0,&U                  LOAD LENGTH          TRACE ISPCALL
.C6      ANOP                                             TRACE
         SVC   93                    ISSUE TPUT SVC       TRACE ISPCALL
ISPT&NDX EQU   *                                          TRACE ISPCALL
.C3      ANOP
&S       SETA  &S+1
         AGO   .LOOP
.C1      AIF   (&S EQ 1).C2    SPF SERVICE NAME - LENGTH IS OK
&T       SETA  K'&LIST(&S)-2
         AIF   (&T GT 7).C2    LENGTH 8 OR GREATER IS OK
&T       SETA  &T+1            ADD FOR ONE BLANK
         LA    &WKRG,=CL&T.&LIST(&S) LOAD DATA ADDR             ISPCALL
         AGO   .ST
.C2      ANOP
         LA    &WKRG,=C&LIST(&S)     LOAD DATA ADDR             ISPCALL
         AGO   .ST
.NUM     AIF   (&NUMSW).NUM2
.*  NOTE: SPF WILL MODIFY LENGTH FIELDS, SO THEY CANNOT BE IN
.*  REENTERANT CODE.
         MVC   &WKAR.(4),=F'&LIST(&S)'                                 X
                                     MOVE NUMERIC VALUE         ISPCALL
&NUMSW   SETB  1
         AGO   .LA
.NUM2    MNOTE 12,'*** ONLY ONE NUMERIC ALLOWED PER ISPCALL MACRO - LISX
               T ITEM &S --&LIST(&S)-- IS SECOND OCCURRENCE ***'
         AGO   .EXIT
.LA      ANOP
         LA    &WKRG,&WKAR           LOAD DATA ADDR             ISPCALL
         AGO   .ST
.REG     ANOP
&T       SETA  4*&S
         ST    &LIST(&S),&WKAR.+&T                              ISPCALL
         AGO   .C3
.******************** USING PROVIDED WORKAREA *************************
.RENT    AIF   (T'&WKAREA EQ 'O').RENT2
&ISPRAR  SETC  '&WKAREA'       SET GLOBAL VARIABLE
.RENT2   ANOP
&WKAR    SETC  '&ISPRAR'
         AGO   .LOOP
.****************** GENERATE STATEMENTS FOR CALL **********************
.ENDLOOP ANOP
         OI    &WKAR.+&T,X'80'       TURN ON VL BIT             ISPCALL
         LA    1,&WKAR.+4                                       ISPCALL
         L     15,=V(&EP)                                       ISPCALL
         BALR  14,15                                            ISPCALL
.EXIT    ANOP
***********************************************************************
         SPACE 2
         MEND
* ABEND CODES  1111  JFCB READ INCORRECTLY
*              1112  TEMP WHEN DIR READ ERROR
*              1113  ISPF TABLE CANT OPEN
*              1114  ISPF TABLE CANT CREATE
* REMODIFIED FOR SPECIAL APPLICATION:
* FUNCTION: TO LIST MEMBERS OF A PDS BY ISPF DATE (MODIFIED OR/AND
*            CREATED) AND GIVE TO ISPF TABLE. USER MAY BROWSE OR
*            EDIT THE SELECTED MEMBER  BY ISPF OPTION.
*------------------------------------------------------------------
* REWRITTEN BY: DAVID RIKER
*               COMPUTER DATA SYSTEMS, INC.
*               1 CURIE COURT
*               ROCKVILLE, MD 20850
*               (202) 362 1160
*------------------------------------------------------------------
* REQUIRED TO INSTALL LOCMEM#P AND LOCMEM#R ON ISPPLIB LIBRARY.
*
*
*
*
*
         SPACE
LISTPDSI START
         USING *,R12
         B     @PROLOG-*(,15)
         DC    AL1(11),CL11'LISTPDSI'
         DC    CL16' &SYSDATE &SYSTIME '
@SIZE    DC    AL1(1),AL3(@DATAL)
@PROLOG  STM   14,12,12(13)
         LR    R12,15
         LR    R4,R1
         L     R0,@SIZE
         GETMAIN R,LV=(0)
         LR    R8,R1
         USING @DATA,R8
         SPACE
         SPACE
         ST    R13,4(,R8)          CHAIN FORWARD
         ST    R8,8(,R13)          CHAIN BACK
         LR    R13,R8              SET SAVEAREA POINTER
         SPACE
*POPRT    SAVREGS
         ISPCALL ('VDEFINE','LOCMNME',SMEMNME,'CHAR',8),WKAREA=WKAREA
         ISPCALL ('VDEFINE','LOCMINF',SMEMINF,'CHAR',66)
         ISPCALL ('VDEFINE','LOCMSTR',SMEMSTR,'CHAR',78)
         ISPCALL ('VDEFINE','LOCMCMD',SMEMCMD,'CHAR',48)
         ISPCALL ('VDEFINE','LOCMDSN',DSN,'CHAR',44)
         ISPCALL ('VDEFINE','LOCMSEL',SMEMSEL,'CHAR',1)
         ISPCALL ('VDEFINE','QKEYV',SKEYV,'CHAR',10)
         ISPCALL ('VDEFINE','QVARS',SVARS,'CHAR',10)
         ISPCALL ('VDEFINE','QROW',SROW,'FIXED',4)
         ISPCALL ('VDEFINE','QKEY',SKEY,'FIXED',4)
         ISPCALL ('VDEFINE','QNAME',SNAME,'FIXED',4)
         ISPCALL ('VDEFINE','QCRP',SCRP,'FIXED',4)
         LA    R1,XLINE
         ST    R4,XADDR
*   INSERT TIME DATE ON INDEX LINE
         TIME  DEC                GET DATE IN R1 IN FORM 00YYJJJF
         ST    R0,BADLNGTH        SAVE TIME WHILE YOU'RE AT IT
         LR    R2,R1              PUT IN R2 TO PASS TO DATE SUBROUTINE
         LA    R1,DATERSLT    PTR TO PTR TO DATE'S RESULT FIELD
         L     R15,=V(DATE)       IRSS DATE SUBROUTINE (DATECONV)
         BALR  R14,R15            CONVERT 00YYJJJF TO MM/DD/YY
         ED    TIMERSLT,BADLNGTH  EDIT INTO PAGE HEADER LINE BUFFER
RELOC    LR    R1,R4
         MVC   PARMLCT(2),=CL2'60'
         LA    R9,60
         ST    R1,PARMPTR
         L     R1,0(0,R1)   GET PARM FLD
         MVC   SPARMSTR(80),BLANKS
         SR    R10,R10
         LH    R10,0(0,R1)  GET THE PARM COUNT
         STH   R10,PARMLEN
         STC   R10,PARMMVC+1
         LTR   R10,R10    SEE IF PARM FLD EMPTY
         BZ    STARTUP     NO NEED TO CALCULATE COUNT
PARMMVC  MVC   SPARMSTR(*-*),2(R1)
         CNOP  0,4
         BAL   R1,PARMPARM
PARMPTR  DC    F'0'           POINTER TO PO RECORD
PARMLEN  DC    H'0'           PARM LENGTH
PARMLCT  DC    CL2'60'        LINE COUNT
PBEGNPTR DC    F'0'           PARM TABLE BEGIN ADDRESS
PENDPTR  DC    F'0'           PARM TABLE END ADDRESS
PARMSKIP DC    F'0'           PARM TABLE END ADDRESS
PARMPARM L     R15,=V(PARM)
         BALR  R14,R15
         LA    R9,PARMLCT
         PACK  WORK,0(2,R9)
         CVB   R9,WORK  CONVERT INTO A USEABLE FORM
STARTUP  STH   R9,NLINES    LINES PER PAGE
         SH    R9,H5  SUB 5 FM LINE COUNT
         STH   R9,NLINES1
         MVI   FIRST,X'FF'   SET FIRST TIME FLAG
         ISPCALL ('TBCREATE','LOCMEM','LOCMNME','LOCMINF',             *
               'NOWRITE','REPLACE')
         LTR   R15,R15
         BZ    TBCRTEOK
         C     R15,=F'4'
         BE    TBCRTEOK
         ABEND 1114,DUMP
TBCRTEOK LA    R1,6   INITIALIZE
         STH   R1,XCNT   THE INDEX MEMBER COUNTER
         RDJFCB  (PODCB)    READ  J F C B  FOR   DSNAME
         LTR   R15,R15      TEST FOR A GOOD READ  JFCB
         BZ    JFCBOK      IF  ZERO    O K
         ABEND 1111,DUMP    SOMETHING IS WRONG  ABORT
JFCBOK   MVC   DSN(44),POJFCB  MOVE DSNAME  INTO THE TITLE
         MVC   DSN01(44),POJFCB  MOVE IN DSNAME INTO INDEX
         OPEN  (PODCB,(INPUT)) OPEN IT ALL
         B     TBOPNOK
TBABEND  ABEND   1113,DUMP
         USING IHADCB,R10
TBOPNOK  LA    R10,PODCB
*  ROUND UP BLKSIZE TO A MULTIPLE OF 8
         LH    R6,DCBBLKSI
         LA    R5,7
         AR    R6,R5
         OR    R6,R5
         XR    R6,R5
         LA    R6,0(0,R6)
         LR    R0,R6
         ST    R6,POBUFFSI
         LH    R6,DCBBLKSI
         TM    DCBRECFM,X'90' IS RECFM=FB
         BNO   SET     YES
         LH    R6,DCBBLKSI
         LH    R7,DCBLRECL
SET      SR    R3,R3   SET MEMBER COUNT TO ZERO
         LA    R3,1(R3)   KEEP MEMBER COUNT
READIR   CLOSE PODCB
         MVC   ORG1(2),DCBDSORG  SAVE DCB DATA FROM INPUT DATA SET.
         MVC   FOR1(1),DCBRECFM
         MVC   REC1(2),DCBLRECL
         MVC   SIZ1(2),DCBBLKSI
         MVC   DCBDSORG(2),ORG2  SET DCB DATA TO READ DIRECTORY.
         MVC   DCBRECFM(1),FOR2
         MVC   DCBLRECL(2),REC2
         MVC   DCBBLKSI(2),SIZ2
         OPEN  PODCB
NEXREC   READ  DRDECB,SF,PODCB,BUFFER
         CHECK DRDECB
         LA    2,BUFFER
         AH    R2,BUFFER   DIR BLK COUNT
         ST    2,BUFEND            END OF THE  BUFFER
         LA    2,BUFFER+2
NEXMEM   C     2,BUFEND
         BNL   NEXREC    BRANCH TO GET NEXT RECORD
STONAM   EQU   *
         MVC   MNAME(8),0(R2)    SET UP MEMBER NAME IN HEADER
         CLI   0(R2),X'FF'       IS THAT ALL OF THE MEMBERS
         BE    RESDCB            THAT'S ALL FOLKS
         LR    R6,R2             SAVE MEMBER ADDRESS
         LA    R3,1(R3)          KEEP MEMBER COUNT.
LTTRC    L     R5,8(0,R2)        TTRC TO REG. 5
         SLL   5,27
         SRL   5,26
         AR    2,5
         AH    2,CON12
         ST    R2,SAVEDIR
         BAL   R2,INDMEM
         L     R2,SAVEDIR
         B     NEXMEM    GET THE NEXT MEMEBER
RESDCB   CLOSE PODCB
         MVC   DCBDSORG(2),ORG1
         MVC   DCBRECFM(1),FOR1
         MVC   DCBLRECL(2),REC1
         MVC   DCBBLKSI(2),SIZ1
         SR   R15,R15
         B    PDSDONE
LOADAD   EQU   *
NEXT     B     CLOSE    GET OUT
*
CLEAR1   EQU   *
         BR    R1     RETURN
*
*****  INDEX LINE DISPLAY  ROUTINE
INDMEM   LH    R1,XADDR+4    MEMBER COUNT
         BCT   R1,INDMEMX    SET UP TO PUT MEMBE  NAME INTO RIGHT SLOT
PRNTINDX LH    R1,XCNT        CHECK LINE COUNT
         CH    R1,NLINES       60 FOR R3
         BNH   INDXOK          LEXX THAN 60
         LA    R1,6
         STH   R1,XCNT        SAVE INDEX LINE COUNT
INDXOK   EQU   *
         L     R5,PBEGNPTR
         LTR   R5,R5
         BZ    INDXOK2         DEFAULT ALL
         CLI   2(R5),C'+'
         BNE   STOLOOP
         C     R3,PARMSKIP
         BH    STOLOOP
         B     INDXOK2
STOLOOP  ICM   R4,1,0(R5)
         TM    1(R5),X'04'    MEMBER OR DATE SEARCH
         BO    SEARCHM
         L     R7,YYMMCRE
         LTR   R7,R7
         BZ    INDXNOP
         TM    1(R5),X'C0' DATE= OR M= PARM INDICATED
         BNM   CHECKMOD    EITHER 80 OR 40
         TM    1(R5),X'18' COMPARISON  PARM INDICATED
         BM    COMPAR      EITHER 80 OR 40
         STC   R4,STOMOD+1
STOMOD   CLC  2(8,R5),0(R7)
         BE    INDXOK2
         B     CHECKMOD
*----------------------------------------------------------
*        MEMBER SEARCH REQUEST
SEARCHM  STC   R4,SERMOD+1
SERMOD   CLC  2(8,R5),XLINE
         BE    INDXOK2
         B     CHECKALL       IGNORE  AND CHECK OTHER REQUEST
*----------------------------------------------------------
*        COMPARISON FEATURE
COMPAR   STC   R4,STOMOGE+1
         TM    1(R5),X'10'   GE COMPARISON FLAG
         BNO   COMPLE
STOMOGE  CLC  0(8,R7),2(R5)
         BH    INDXOK2
         B     CHECKMOD
COMPLE   STC   R4,STOMOLE+1
         TM    1(R5),X'08'   LE COMPARISON FLAG
         BNO   CHECKMOD
STOMOLE  CLC  0(8,R7),2(R5)
         BL    INDXOK2
         B     CHECKMOD
*        COMPARISON FEATURE
COMPAR2  STC   R4,STOMOGE2+1
         TM    1(R5),X'10'   GE COMPARISON FLAG
         BNO   COMPLE2
STOMOGE2 CLC  0(8,R7),2(R5)
         BH    INDXOK2
         B     CHECKALL
COMPLE2  STC   R4,STOMOLE2+1
         TM    1(R5),X'08'   LE COMPARISON FLAG
         BNO   CHECKALL
STOMOLE2 CLC  0(8,R7),2(R5)
         BL    INDXOK2
         B     CHECKALL
* ------------------------------------------------------
CHECKMOD L     R7,YYMMMOD
         LTR   R7,R7
         BZ    INDXNOP
         TM    1(R5),X'A0' DATE= OR C= PARM INDICATED
         BNM   CHECKALL    EITHER 80 OR 20
         TM    1(R5),X'18' COMPARISON  PARM INDICATED
         BM    COMPAR2
         STC   R4,STOMOD2+1
STOMOD2  CLC  2(8,R5),0(R7)
         BE    INDXOK2
CHECKALL CLC   2(3,R5),=CL3'ALL'
         BE    INDXOK2
         LA    R5,10(R5)
         CLI   0(R5),X'FF'
         BNE   STOLOOP
         MVC   YYMMMOD(4),=F'0' RESET TO ZEROS FOR NEXT MEMBER
         MVC   YYMMCRE(4),=F'0' RESET TO ZEROS FOR NEXT MEMBER
         B     INDXNOP
INDXOK2  LA    R1,2(0,R1)          UP THE COUNT BY TWO
         STH   R1,XCNT        SAVE INDEX LINE COUNT
         MVC   SMEMINF(66),XLINE+9
         ISPCALL ('TBADD','LOCMEM')
INDXNOP  MVI   XLINE,C' '
         MVC   XLINE+1(79),XLINE BLANK OUT THE LINE
         LA    R1,XLINE     FIRST INDEX MEMBER NAME
         ST    R1,XADDR     SAVE
         LH    R1,XADDR+6   H'10'
         STH   R1,XADDR+4   SAVE
         B     INDMEM1
INDMEMX  STH   R1,XADDR+4        NEXT MEMBER SLOT
INDMEM1  L     R1,XADDR          NEXT MEMBER SLOT
         ST    R1,AXADDR
         MVC   0(8,R1),MNAME     MEMBER NAME IN INDEX
         MVC   SMEMNME(8),MNAME
         C     R5,=F'0'
         BE    INDMEM2
         C     R5,=F'4'
         BE    INDMEM2
         CNOP  0,4
         BAL   R1,ISPFINFO
YYMMCRE  DC    F'0'           POINTER TO YYMM CREATE FIELD
YYMMMOD  DC    F'0'           POINTER TO YYMM MODIFIED FIELD
AMNAME   DC    A(MNAME)       POINTER TO MEMBER NAME FIELD
AXADDR   DC    F'0'           POINTER TO XADDR FIELD
HALFWORD DC    X'00'          PDS DIR MEMBER HALFWORD LENGTH
         DC    XL3'00' RESERVED
ISPFINFO L     R15,=V(ISPFINF)
         BALR  R14,R15
         B     INDMEM2       EXIT FOR NOT APPROVE ISPF INFO
*DOR    APPROVED ISPF INFORMATION STRING
         MVC   SMEMINF(66),XLINE+9
INDMEM2  EQU   *                 NEXT MEMBER
         L     R1,AXADDR
         SR    R3,R3
         IC    R3,HALFWORD
         SLL   R3,1              MULTIPLE BY 2 BYTES
         LA    R3,10(R3)         INCREMENT BY 10 BYTES
         AR    R1,R3
         ST    R1,XADDR          SAVE
         ST    R1,AXADDR
         BR    R2                RETURN
ERR      BAL   R1,CLEAR1
         ABEND   1112,DUMP
CLOSE    CLOSE (PODCB)
PDSDONE  EQU   *
         CLI   TRACESWT,X'FF'
         BE    TRACEON
         MVI   TRACESWT,X'FF'
         CALL TRACE       ASM TRACE (MUST INCLUDE ASMTRACE MODULE)
TRACEON  EQU   *
         MVC   SMEMSTR(78),SPARMSTR
         ISPCALL ('TBTOP','LOCMEM')
TBDISP   MVI   SMEMSEL,X'6D'
         ISPCALL ('TBDISPL','LOCMEM','LOCMEM#T')
         LTR   R15,R15
         BNZ   TBEND
         CLI   SELCODE,C'R'
         BNE   NOCMD
         MVC   SMEMSTR(78),SPARMSTR
         ISPCALL ('DISPLAY','LOCMEM#R')
         C     R15,=F'0'
         BE    NEWREQ
         C     R15,=F'8'
         BNE   TBDISP
NEWREQ   CLI   SMEMCMD,C' '
         BE    NOCMD
         B     RELOCATE
NEXTCMD2 CLC   SMEMCMD(2),=CL2'D='
         BE    RELOCATE
         CLC   SMEMCMD(2),=CL2'M='
         BE    RELOCATE
         CLC   SMEMCMD(2),=CL2'C='
         BE    RELOCATE
         CLC   SMEMCMD(2),=CL2'S='
         BE    RELOCATE
         CLC   SMEMCMD(3),=CL3'LC='
         BE    RELOCATE
         CLI   SMEMCMD,C'L'
         BE    LOCATE
         CLI   SMEMCMD,C'F'
         BE    LOCATE
         CLI   SMEMCMD,C'='
         BNE   NOCMD
         MVC   XOPT(60),BLANKS
         MVC   XOPT(4),=CL4'CMD('
         MVC   XOPT+4(48),SMEMCMD
         MVI   XOPT+55,C')'
         ISPCALL ('SELECT',60,XOPT)
         B     TBDISP
RELOCATE LA    R4,PARMCMD
         ST    R4,SPARMPTR
         LA    R4,SPARMPTR
         MVC   PARMCMD,=H'60'
         B     RELOC
NOCMD    MVC   SELCODE(1),SMEMSEL
         ISPCALL ('TBQUERY','LOCMEM','QKEYV','QVARS',                ***
               'QROW','QKEY','QNAME','QCRP')
         MVC   SCRPT,SCRP
         MVC   SCRPN,=F'1'
         CLI   SELCODE,X'6D'
         BE    TBDISP
         MVC   DSNM(60),BLANKS
         LA    R1,DSNM
         LA    R3,DSN
         LA    R2,44
         MVI   0(R1),X'7D'   INSERT QUOTE FOR DSN QUALIFIER
         LA    R1,1(R1)
NEXTDSN  CLI   0(R3),X'40'
         BE    ENDDSN
         MVC   0(1,R1),0(R3)
         LA    R1,1(R1)
         LA    R3,1(R3)
         BCT   R2,NEXTDSN
ENDDSN   MVI   0(R1),C'('
         LA    R1,1(R1)
         LA    R2,8
         LA    R3,SMEMNME
NEXTMEM  CLI   0(R3),X'40'
         BE    ENDMEM
         MVC   0(1,R1),0(R3)
         LA    R1,1(R1)
         LA    R3,1(R3)
         BCT   R2,NEXTMEM
ENDMEM   MVI   0(R1),C')'
         LA    R1,1(R1)
         MVI   0(R1),X'7D'   INSERT QUOTE FOR DSN QUALIFIER
         CLI   SELCODE,C'E'
         BE    ISPFEDIT
         CLI   SELCODE,C'B'
         BE    ISPFBROW
         B     TBDISP
ISPFEDIT ISPCALL ('EDIT',DSNM)
         B     TBDISP
ISPFBROW ISPCALL ('BROWSE',DSNM)
         B     TBDISP
LOCATE   LA    R1,SMEMCMD+1
         LA    R2,40
NEXTSTR  CLI   0(R1),C' '
         BNE   LOCATE2
         LA    R1,1(R1)
         BCT   R2,NEXTSTR
         B     TBDISP
LOCATE2  LA    R3,SMEMNME
         LA    R2,8
NEXTSTR2 MVC   0(1,R3),0(R1)
         LA    R1,1(R1)
         LA    R3,1(R3)
         CLI   0(R1),C' '
         BE    LOCATE3
         BCT   R2,NEXTSTR2
LOCATE3  ISPCALL ('TBEXIST','LOCMEM')
         LTR   R15,R15
         BZ    TBDISP
         C     R15,=F'8'
         BNE   TBDISP
*        MVC   LOCMSG(8),=C'LOCMEM8'
         B     TBDISP
TBEND    ISPCALL ('TBEND','LOCMEM')
EXITX    LR    R1,R13
         L     0,@SIZE
         L     13,4(,13)
         ST    15,16(,13)
         FREEMAIN R,A=(1),LV=(0)
         LM    14,12,12(13)
         BR    14
         EJECT
P1       DC    PL1'1'
PNO      DC    PL3'1'
H3       DC    H'3'
H5       DC    H'5'
CON12    DC    H'12'
XADDR    DC    A(*),H'1',H'1'   POINTER TO XLINE
         DS    0D
         DS    1H
ORG2     DC    BL2'0100000000000000'
REC2     DC    BL2'0000000100000000'
SIZ2     DC    BL2'0000000100000000'
FOR2     DC    BL1'10000000'
         DS    0F
PODCB    DCB   DSORG=PO,MACRF=R,DDNAME=PDS,EODAD=NEXT,SYNAD=ERR,       X
               EXLST=POEXLST
POEXLST  DS    0F
         DC    BL1'10000111',AL3(POJFCB)
POJFCB   DC    22D'0'   176 BYTE AREA FOR J F C B
NOMBR    DC    C' MEMBER NOT FOUND OR IO ERROR READING DIRECTORY'
ERRMES   DC    C' ERROR READING DIRECTORY     '
ENDTASK  DC    C' *****  TASK COMPLETED  *****'
NODATA   DC    C' *** SYSIN DATA NOT INPUT ***'
INDEX    DC    CL1'1',8CL1'-'
DATERSLT DC    CL8'MM/DD/YY',CL2'  '
TIMERSLT DC    XL11'4021207A20207A20204B20'
MNAME    DC    CL8' '    MEMBER NAME
BLANKS   DC    CL80' '
         DS    0D
BUFFER   DS    128H
         LTORG
         PRINT  NOGEN
         DCBD  DSORG=PO,DEVD=DA
R0       EQU   0
R1       EQU   1
R2       EQU   2
R3       EQU   3
R4       EQU   4
R5       EQU   5
R6       EQU   6
R7       EQU   7
R8       EQU   8
R9       EQU   9
R10      EQU   10
R11      EQU   11
R12      EQU   12
R13      EQU   13
R14      EQU   14
R15      EQU   15
         SPACE
@DATA    DSECT
         DS    18F                 REGISTER SAVEAREA
DOUBLE   DS    D
LINKAREA DS    2F
SNAP1    EQU   *
QAREA    DC    A(*) DUMP                      AREA
SNAP2    DC    0F'0',X'80',AL3(*)
SNAPSWT  DC    X'00'
QUOTESWT  DC    X'00'
LEAVESW   DC    X'00'
SPACEW   DS    CL5
SMEMSEL  DS    CL1
SELCODE  DS    CL1
SHOWSWT  DS    CL1
SMEMNME  DS    CL8
SMEMINF  DS    CL60
XOPT     DS    CL60
SMEMDSN  DS    CL44
         DS    0F
SPARMPTR DS    F
PARMCMD  DS    H
SMEMCMD  DS    CL60
SMEMSTR  DS    CL80
SPARMSTR DS    CL256 PARM STRING MAX 256 BYTES
         DS    0F
SROW     DS    F
SKEY     DS    F
SNAME    DS    F
SCRP     DS    F
SCRPT    DS    F
SCRPN    DS    F
SKEYV    DS    CL10
SVARS    DS    CL10
FIRST    DC    X'00'    FIRST TIME FLAG  =X'FF'  IF SET FIRST TIME
         DS    0H
NLINES   DC    H'0'   NO. LINES   DEFAULT IS  60
NLINES1  DC    H'0'      5 LESS THAN THE   NLINES PARAMETER
LCNT     DC    H'0'
XCNT     DC    H'0'   LINE COUNT OF INDEX
TEMP     DC    F'0'
BUFEND   DC    F'0'
SAVEDIR  DC    F'0'
POBUFFSI DC    F'0'
DUMMY    DC    F'0'
         DS    0F
WORK     DC    D'0'
WKAREA   DS    8D
TRACESWT DC    X'00'
         DS    0D
BADLNGTH DC    D'0'
         DS    0D
DSN      DC    CL45' '
PAGENO   DC    CL4' '                            109
PAGEX    DC    CL6' '    INDEX LINE
XLINE    DC    CL80' '      INDEX LINE
DSN01    DC    44CL1' ',8CL1'-'
DSNM     DC    60CL1' '
ORG1     DS    BL2
REC1     DS    BL2
SIZ1     DS    BL2
FOR1     DS    BL1
@DATAL   EQU   *-@DATA
         SPACE
DATE     CSECT
         SAVE  (14,12),T,*
*      R1 = ADDR FOR OUTPUT (DS CL8'MM/DD/YY')
*      R2 = R1 FROM THE TIME MACRO
         LR    R12,R15
         USING DATE,R12
         LA    R11,4095(R12)   SECOND BASE
         LA    R11,1(,R11)     MAKE IT 4096 X'1000'
         USING DATE+4096,R11
         LA    R3,DATESAVE
         ST    R13,4(,R3)
         ST    R3,8(,R13)
         LR    R13,R3
         USING PARMAREA,R1
         ST    R2,W2                    STORE DATE (00YYDDDF)
         SR     R2,R2
         IC    R2,W2+1              PICK YY FROM 00YYDDDF
         SLL   R2,4                 SHIFT 00YY TO 0YY0
         O     R2,=X'0000900F' 0YY0 TO 9YYF
         ST    R2,OVERLAP
         MVC   WRKPKYR+1(2),OVERLAP+2
         OI    WRKPKYR,X'01'         009YYF TO 019YYF
         ZAP   WRKPKNUM(8),WRKPKYR(3)
         DP    WRKPKNUM(8),=PL1'4'   DIVISABLE BY FOUR
         ZAP   WRKLEAPS,WRKPKNUM(7)  SAVE QUOTIENT
         ZAP   WRKLEAPR,WRKPKNUM+7(1)  SAVE REMAINDER
         MVI   MONTHTBL+5,28            SETUP FEB NONLEAP YEAR
         CP    WRKLEAPR,=PL1'0'  IF ZEROS THEN ITS A LEAP YEAR
         BNE   NOLEAP
         MVI   MONTHTBL+5,29            SETUP FEB LEAP YEAR
NOLEAP   UNPK  MMDDYY(3),W2+1(2)           UNPK YR
         XC    W1(6),W1                  CLEAR YR FOR DAY RTN.
         CVB   R4,W1                    GET DAY
         LA    R5,MONTHTBL-4            SET BACK PTR
MONLUPE  LA    R5,4(R5)                 INCR THRU MON TBL
         SH    R4,0(R5)                 DROP DOWN THRU MONTBL
         BH    MONLUPE                  NOT YET, TRY AGAIN
         AH    R4,0(R5)                 ADD BACK THE DAY
         CVD   R4,W1                    MAKE
         OI    W2+3,X'0F'                  THE DAY
         UNPK  MMDDYY+5(3),W2+2(2)            PRINTABLE
         MVI   MMDDYY+5,C'/'            RESTORE SLASH
         MVC   MMDDYY+3(2),2(R5)          MOVE THE MONTH
         MVI   MMDDYY+2,C'/'  RESTORE SLASH
         MVC   THEDATE,MMDDYY         MOVE DATE TO USER
RETURN   DS    0H
         L     R13,4(,R13)
         RETURN (14,12),,RC=0 RESTORE REGS AND RETURN
         EJECT
         SPACE 2
MONTHTBL DS    0CL48
MTK      DC    H'31',C'01' JAN
         DC    H'28',C'02' FEB
         DC    H'31',C'03' MAR
         DC    H'30',C'04' APR
         DC    H'31',C'05' MAY
         DC    H'30',C'06' JUN
         DC    H'31',C'07' JLY
         DC    H'31',C'08' AUG
         DC    H'30',C'09' SEP
         DC    H'31',C'10' OCT
         DC    H'30',C'11' NOV
         DC    H'255',C'12' DEC
         SPACE 2
DATESAVE     DS    9D
W1       DS    F              WORKARE1
W2       DS    F              WORKAREA2
OVERLAP  DS    F
MMDDYY   DS    CL9
WRKPKYR  DS    PL3                YEAR TO BE CHECKED BY LEAP YEAR RTN
WRKPKNUM DS    PL8                GENERAL USE PACKED DECIMAL FIELD
WRKLEAPS DS    PL2                PACKED - YEAR / 4   - TRUNCATED
WRKLEAPR DS    PL2                PACKED - REMAINDER AFTER DIVIDE BY 4
         DS    0F
         LTORG
         DS    0F                          BOUNDARY OF FULLWORDS
PARMAREA DSECT
THEDATE  DS    CL8
         SPACE 5
         DROP R11
         DROP R12
         EJECT
         PRINT  GEN
         DS    0F                          BOUNDARY OF FULLWORDS
PARM     CSECT
         SAVE  (14,12),T,*
*      R1 = ADDR OF RECORD POINTER
         LR    R12,R15
         USING PARM,R12
         LA    R11,4095(R12)   SECOND BASE
         LA    R11,1(,R11)     MAKE IT 4096 X'1000'
         USING PARM+4096,R11
         LA    R3,PARMSAVE
         ST    R13,4(,R3)
         ST    R3,8(,R13)
         LR    R13,R3
         LR    R7,R1        SAVE R1
         USING PARMPTAB,R7
         CLI   PRMSWT,X'FF'
         BE    PRMSKIP
         MVI   PRMSWT,X'FF'
PRMOK    GETMAIN R,LV=1010           GET PARM TABLE STORAGE
         ST    R1,BEGNPRM              SAVE PARM TABLE ADDRESS
         A     R1,=F'1010'  DOR       COMPUTE END ADDR
         ST    R1,ENDPRM               STORE TBL END ADDR
PRMSKIP  EQU   *
         L     R6,BEGNPRM
         MVI   0(R6),X'FF'             TABLE END INDIC
         MVI   1(R6),X'00'             TABLE END INDIC
         LH    R5,PRMLENX
         LTR   R5,R5
         BZ    NOTPARM
         L     R1,PRMPTRX
         LA    R1,0(0,R1)
         L     R2,0(R1)
         LH    R4,0(0,R2)
         LA    R2,2(R2)
PARMLOOP CLI   0(R2),C','
         BNE   ANYMORE
         SH    R4,=H'01'
         LA    R2,1(R2)
ANYMORE  CH    R4,=H'00'
         BE    ENDPARMS
         CLC   0(3,R2),=C'LC='
         BE    LINECT
         CLC   0(2,R2),=C'D='
         BE    DATEQU
         CLC   0(2,R2),=C'M='
         BE    MODEQU
         CLC   0(2,R2),=C'C='
         BE    CREEQU
         CLC   0(2,R2),=C'S='
         BE    MEMEQU
         B     BADPARMS
LINECT   MVC   PRMLCTX(2),3(R2)
         LA    R2,5(R2)
         SH    R4,=H'05'
         B     PARMLOOP
* -------------------------------------------------------
DATEQU   EQU   *
         SH    R4,=H'02'
         LA    R2,2(R2)
         CLC   0(1,R2),=C'('
         BNE   DATEQU2
         SH    R4,=H'01'
         LA    R2,1(R2)
DATEQU2  ST    R2,PTRBEGN
DATLOOP  CLC   0(1,R2),=C','
         BE    DATSEP
         CLC   0(1,R2),=C')'
         BE    DATEND
         CLC   0(1,R2),=C'>'
         BE    DATGE
         CLC   0(1,R2),=C'<'
         BE    DATLE
         CLC   0(1,R2),=C'+'
         BE    DATSKIP
         CLC   0(1,R2),=C'*'
         BNE    DATSTAR
         MVI   DATFLAG,X'01'
DATSTAR  LA    R2,1(R2)
         SH    R4,=H'01'
         CH    R4,=H'00'
         BE    DATEND
DATSTAR2 CLI   DATSWT,X'FF'
         BE    PARMLOOP
         B     DATLOOP
DATGE    OI    1(R6),X'10' FLAG INDICATOR FOR GREATER THAN
         B     DATCOMP
DATLE    OI    1(R6),X'08' FLAG INDICATOR FOR LESS THAN
DATCOMP  LA    R2,1(R2)
         SH    R4,=H'01'
         CH    R4,=H'00'
         BE    DATEND
         B     DATLOOP
DATSKIP  MVI   DATSKP,X'FF'
         B     DATSTAR
DATEND   MVI   DATSWT,X'FF'
DATSEP   LR    R3,R2
         S     R3,PTRBEGN
         BCTR  R3,0            DROP DELIMITER
         L     R5,PTRBEGN
         TM    1(R6),X'18'
         BNM   DATMVCM
         LA    R5,1(R5)       DROP COMPARISON SIGN
         BCTR  R3,0            DROP DELIMITER
DATMVCM  CLI   DATFLAG,X'01'
         BNE   DATMVCX
         MVI   DATFLAG,X'00'
         BCTR  R3,0             DROP ASKERISK
DATMVCX  STC   R3,DATMVC+1
DATMVC   MVC   2(8,R6),0(R5)
         OI    1(R6),X'80'
         STC   R3,0(R6)
         CLI   DATSKP,X'FF'
         BE    DATSKIP2
         LA    R6,10(R6)
         C     R6,ENDPRM
         BNL   PRMFULL
         MVI   0(R6),X'FF'             TABLE END INDIC
         MVI   1(R6),X'00'             TABLE END INDIC
         CLI   DATSWT,X'FF'
         BE    ENDPARMS
         LA    R2,1(R2)
         SH    R4,=H'01'
         ST    R2,PTRBEGN
         B     DATSTAR2
DATSKIP2 EQU   *
         IC    R9,DATMVC+1
         N     R9,=F'15'     TREAT AS X'0F'
         IC    R7,DATSKPK+1
         N     R7,=F'240'    TREAT AS X'F0'
         OR    R7,R9
         STC   R7,DATSKPK+1
         LR    R9,R6
DATSKPK  PACK  MEMWORK,1(7,R9)
         CVB   R9,MEMWORK  CONVERT INTO A USEABLE FORM
         ST    R9,PRMXSKIP  LINES PER PAGE
         B     DATSTAR2
* -------------------------------------------------------
MEMEQU   EQU   *
         SH    R4,=H'02'
         LA    R2,2(R2)
         CLC   0(1,R2),=C'('
         BNE   MEMEQU2
         SH    R4,=H'01'
         LA    R2,1(R2)
MEMEQU2  ST    R2,PTRBEGN
MEMLOOP  CLC   0(1,R2),=C','
         BE    MEMSEP
         CLC   0(1,R2),=C')'
         BE    MEMEND
         CLC   0(1,R2),=C'>'
         BE    MEMGE
         CLC   0(1,R2),=C'<'
         BE    MEMLE
         CLC   0(1,R2),=C'+'
         BE    MEMSKIP
         CLC   0(1,R2),=C'*'
         BNE    MEMSTAR
         MVI   MEMFLAG,X'01'
MEMSTAR  LA    R2,1(R2)
         SH    R4,=H'01'
         CH    R4,=H'00'
         BE    MEMEND
MEMSTAR2 CLI   MEMSWT,X'FF'
         BE    PARMLOOP
         B     MEMLOOP
MEMGE    OI    1(R6),X'10' FLAG INDICATOR FOR GREATER THAN
         B     MEMCOMP
MEMLE    OI    1(R6),X'08' FLAG INDICATOR FOR LESS THAN
MEMCOMP  LA    R2,1(R2)
         SH    R4,=H'01'
         CH    R4,=H'00'
         BE    MEMEND
         B     MEMLOOP
MEMSKIP  MVI   MEMSKP,X'FF'
         B     MEMSTAR
MEMEND   MVI   MEMSWT,X'FF'
MEMSEP   LR    R3,R2
         S     R3,PTRBEGN
         BCTR  R3,0            DROP DELIMITER
         L     R5,PTRBEGN
         TM    1(R6),X'18'
         BNM   MEMMVCM
         LA    R5,1(R5)       DROP COMPARISON SIGN
         BCTR  R3,0            DROP DELIMITER
MEMMVCM  CLI   MEMFLAG,X'01'
         BNE   MEMMVCX
         MVI   MEMFLAG,X'00'
         BCTR  R3,0             DROP ASKERISK
MEMMVCX  STC   R3,MEMMVC+1
MEMMVC   MVC   2(8,R6),0(R5)
         OI    1(R6),X'04'
         STC   R3,0(R6)
         CLI   MEMSKP,X'FF'
         BE    MEMSKIP2
         LA    R6,10(R6)
         C     R6,ENDPRM
         BNL   PRMFULL
         MVI   0(R6),X'FF'             TABLE END INDIC
         MVI   1(R6),X'00'             TABLE END INDIC
         CLI   MEMSWT,X'FF'
         BE    ENDPARMS
         LA    R2,1(R2)
         SH    R4,=H'01'
         ST    R2,PTRBEGN
         B     MEMSTAR2
MEMSKIP2 EQU   *
         IC    R9,MEMMVC+1
         N     R9,=F'15'     TREAT AS X'0F'
         IC    R7,MEMSKPK+1
         N     R7,=F'240'    TREAT AS X'F0'
         OR    R7,R9
         STC   R7,MEMSKPK+1
         LR    R9,R6
MEMSKPK  PACK  MEMWORK,1(7,R9)
         CVB   R9,MEMWORK  CONVERT INTO A USEABLE FORM
         ST    R9,PRMXSKIP  LINES PER PAGE
         B     MEMSTAR2
* -------------------------------------
MODEQU   EQU   *          MODIFIED DATE
         SH    R4,=H'02'
         LA    R2,2(R2)
         CLC   0(1,R2),=C'('
         BNE   MODEQU2
         SH    R4,=H'01'
         LA    R2,1(R2)
MODEQU2  ST    R2,PTRBEGN
MODLOOP  CLC   0(1,R2),=C','
         BE    MODSEP
         CLC   0(1,R2),=C')'
         BE    MODEND
         CLC   0(1,R2),=C'>'
         BE    MODGE
         CLC   0(1,R2),=C'<'
         BE    MODLE
         CLC   0(1,R2),=C'+'
         BE    MODSKIP
         CLC   0(1,R2),=C'*'
         BNE    MODSTAR
         MVI   MODFLAG,X'01'
MODSTAR  LA    R2,1(R2)
         SH    R4,=H'01'
         CH    R4,=H'00'
         BE    MODEND
MODSTAR2 CLI   MODSWT,X'FF'
         BE    PARMLOOP
         B     MODLOOP
MODGE    OI    1(R6),X'10' FLAG INDICATOR FOR GREATER THAN
         B     MODCOMP
MODLE    OI    1(R6),X'08' FLAG INDICATOR FOR LESS THAN
MODCOMP  LA    R2,1(R2)
         SH    R4,=H'01'
         CH    R4,=H'00'
         BE    MODEND
         B     MODLOOP
MODSKIP  MVI   MODSKP,X'FF'
         B     MODSTAR
MODEND   MVI   MODSWT,X'FF'
MODSEP   LR    R3,R2
         S     R3,PTRBEGN
         BCTR  R3,0            DROP DELIMITER
         L     R5,PTRBEGN
         TM    1(R6),X'18'
         BNM   MODMVCM
         LA    R5,1(R5)       DROP COMPARISON SIGN
         BCTR  R3,0            DROP DELIMITER
MODMVCM  CLI   MODFLAG,X'01'
         BNE   MODMVCX
         MVI   MODFLAG,X'00'
         BCTR  R3,0             DROP ASKERISK
MODMVCX  STC   R3,MODMVC+1
MODMVC   MVC   2(8,R6),0(R5)
         OI    1(R6),X'20'
         STC   R3,0(R6)
         CLI   MODSKP,X'FF'
         BE    MODSKIP2
         LA    R6,10(R6)
         C     R6,ENDPRM
         BNL   PRMFULL
         MVI   0(R6),X'FF'             TABLE END INDIC
         MVI   1(R6),X'00'             TABLE END INDIC
         CLI   MODSWT,X'FF'
         BE    ENDPARMS
         LA    R2,1(R2)
         SH    R4,=H'01'
         ST    R2,PTRBEGN
         B     MODSTAR2
MODSKIP2 EQU   *
         IC    R9,MODMVC+1
         N     R9,=F'15'     TREAT AS X'0F'
         IC    R7,MODSKPK+1
         N     R7,=F'240'    TREAT AS X'F0'
         OR    R7,R9
         STC   R7,MODSKPK+1
         LR    R9,R6
MODSKPK  PACK  MEMWORK,1(7,R9)
         CVB   R9,MEMWORK  CONVERT INTO A USEABLE FORM
         ST    R9,PRMXSKIP  LINES PER PAGE
         B     MODSTAR2
* -------------------------------------
CREEQU   EQU   *
         SH    R4,=H'02'
         LA    R2,2(R2)
         CLC   0(1,R2),=C'('
         BNE   CREEQU2
         SH    R4,=H'01'
         LA    R2,1(R2)
CREEQU2  ST    R2,PTRBEGN
CRELOOP  CLC   0(1,R2),=C','
         BE    CRESEP
         CLC   0(1,R2),=C')'
         BE    CREEND
         CLC   0(1,R2),=C'>'
         BE    CREGE
         CLC   0(1,R2),=C'<'
         BE    CRELE
         CLC   0(1,R2),=C'+'
         BE    CRESKIP
         CLC   0(1,R2),=C'*'
         BNE    CRESTAR
         MVI   CREFLAG,X'01'
CRESTAR  LA    R2,1(R2)
         SH    R4,=H'01'
         CH    R4,=H'00'
         BE    CREEND
CRESTAR2 CLI   CRESWT,X'FF'
         BE    PARMLOOP
         B     CRELOOP
CREGE    OI    1(R6),X'10' FLAG INDICATOR FOR GREATER THAN
         B     CRECOMP
CRELE    OI    1(R6),X'08' FLAG INDICATOR FOR LESS THAN
CRECOMP  LA    R2,1(R2)
         SH    R4,=H'01'
         CH    R4,=H'00'
         BE    CREEND
         B     CRELOOP
CRESKIP  MVI   CRESKP,X'FF'
         B     CRESTAR
CREEND   MVI   CRESWT,X'FF'
CRESEP   LR    R3,R2
         S     R3,PTRBEGN
         BCTR  R3,0            DROP DELIMITER
         L     R5,PTRBEGN
         TM    1(R6),X'18'
         BNM   CREMVCM
         LA    R5,1(R5)       DROP COMPARISON SIGN
         BCTR  R3,0            DROP DELIMITER
CREMVCM  CLI   CREFLAG,X'01'
         BNE   CREMVCX
         MVI   CREFLAG,X'00'
         BCTR  R3,0             DROP ASKERISK
CREMVCX  STC   R3,CREMVC+1
CREMVC   MVC   2(8,R6),0(R5)
         OI    1(R6),X'40'
         STC   R3,0(R6)
         CLI   CRESKP,X'FF'
         BE    CRESKIP2
         LA    R6,10(R6)
         C     R6,ENDPRM
         BNL   PRMFULL
         MVI   0(R6),X'FF'             TABLE END INDIC
         MVI   1(R6),X'00'             TABLE END INDIC
         CLI   CRESWT,X'FF'
         BE    ENDPARMS
         LA    R2,1(R2)
         SH    R4,=H'01'
         ST    R2,PTRBEGN
         B     CRESTAR2
CRESKIP2 EQU   *
         IC    R9,CREMVC+1
         N     R9,=F'15'     TREAT AS X'0F'
         IC    R7,CRESKPK+1
         N     R7,=F'240'    TREAT AS X'F0'
         OR    R7,R9
         STC   R7,CRESKPK+1
         LR    R9,R6
CRESKPK  PACK  MEMWORK,1(7,R9)
         CVB   R9,MEMWORK  CONVERT INTO A USEABLE FORM
         ST    R9,PRMXSKIP  LINES PER PAGE
         B     CRESTAR2
* -------------------------------------------------------
BADPARMS EQU  *
         WTO  'PARMLIST INVALID PARMETER STRING JOB TERMINATED'
         B    RETPARM
*
NOTPARM EQU  *
         LH    R5,=CL2'60'   PRE SET LINES TO  60
         STH   R5,PRMLCTX
ENDPARMS EQU   *
         SH    R4,=H'01'      LESS PREVIOUS CHARACTER
         LA    R2,1(R2)       BUMP NEXT CHARACTER
         CH    R4,=H'00'      END OF PARM STRING ?
         BNE   PARMLOOP       NOT YET GO TO NEXT PARM  CHARACTER
RETPARM  DS    0H
         L     R13,4(,R13)
         RETURN (14,12),,RC=0 RESTORE REGS AND RETURN
         EJECT
PRMFULL EQU   *
         ABEND 1116,DUMP,STEP           ABEND
*
*
*
*                 *** DATA AND WORK AREAS ***
****************************************************************
*
* FOLLOWING FIELDS: COMMPARM THRU COMMEND ARE COMMON AREAS SHARED
* BY THIS, AND CALLED SUB-PROGRAMS. ALL CHANGES MUST BE COORDINTAED
* WITH ALL OTHER PROGRAMS.
*
****************************************************************
*
         DS    0D
COMPPARM EQU   *                       COMMON AREAS
PRMSWT   DC    X'00'
DATSWT   DC    X'00'
DATSKP   DC    X'00'
DATFLAG  DC    X'00'
MEMSWT   DC    X'00'
MEMSKP   DC    X'00'
MEMFLAG  DC    X'00'
MODSWT   DC    X'00'
MODSKP   DC    X'00'
MODFLAG  DC    X'00'
CRESWT   DC    X'00'
CRESKP   DC    X'00'
CREFLAG  DC    X'00'
         DS    0F
MEMWORK  DC    D'0'
PTRBEGN  DC    F'0'
PARMSAVE DS 18F
*
COMPEND  EQU   *
         LTORG
         DROP R11
         DROP R12
         EJECT
         DS    0F                          BOUNDARY OF FULLWORDS
ISPFINF  CSECT
         SAVE  (14,12),T,*
*      R1 = ADDR OF RECORD POINTER
         LR    R12,R15
         USING ISPFINF,R12
         LA    R11,4095(R12)   SECOND BASE
         LA    R11,1(,R11)     MAKE IT 4096 X'1000'
         USING ISPFINF+4096,R11
         LA    R3,ISPFSAVE
         ST    R13,4(,R3)
         ST    R3,8(,R13)
         LR    R13,R3
         LR    R7,R1        SAVE R1
         USING ISPFPTAB,R7
         L     R1,PAXADDR
         ST    R2,SAVER2
         ST    R1,SAVER1
         ST    R10,SAVER10
*-----------------------------------------
         CLC   8(2,R6),=XL2'0010'  NO ISPF INFORMATION
         BE    ISPRETR
         CLI   11(R6),X'00'    NO ISPF INFORMATION
         BE    ISPRETR
         SR    R3,R3
         IC    R3,11(R6)     PICK UP INDICATOR
         STC   R3,HALFLEN
         STC   R3,NUMTTR
         NI    HALFLEN,X'1F'  STRIP OFF XXX.....
         NI    NUMTTR,X'60'    STRIP OFF X..XXXXX
         MVI   ALIASWT,X'00'
         TM    11(R6),X'80'    ALIAS INDICATOR
         BZ    NOALIAS
         MVI   ALIASWT,X'FF'
NOALIAS  EQU   *
         CLI   HALFLEN,X'0F' CHECK IF ISPF INFO HAVE 30 BYTES
         BL    ISPRETR
         SR    R3,R3
         IC    R3,13(R6)        RELEASE NUMBER
         CVD   R3,PWORK
         SR    R3,R3
         IC    R3,12(R6)        VERSION NUMBER
         CVD   R3,PWORK2
         SR    R3,R3
         NI    PWORK2+7,X'F0'   REMOVE ZONE BITS
         ICM   R3,15,PWORK2+4
         SLL   R3,8             MOVE TO TWO DIGITS
         O     R3,PWORK+4
         ST    R3,PWORK+4
         OI    PWORK+7,X'0F'
         MVC   9(7,R1),EDMSKV
         ED    9(7,R1),PWORK+5
*-----------------------------------------
         MVC   PWORKF,16(R6) CREATED 00YYDDDF
         L     R2,PWORKF
         LA    R1,17(R1)    BUMP ADDRESS
         ST    R1,PYYMMCRE
         L     R15,=V(DATE)
         BALR  R14,R15
*-----------------------------------------
         MVC   PWORKF,20(R6) MODIFIED 00YYDDDF
         L     R2,PWORKF
         LA    R1,10(R1)    BUMP ADDRESS
         ST    R1,PYYMMMOD
         L     R15,=V(DATE)
         BALR  R14,R15
*-----------------------------------------
         L     R1,SAVER1
         SR    R3,R3
         CVD   R3,PWORK     MAKE 0000000F
         MVC   PWORKF(2),24(R6)   HH.MM
         LH    R3,PWORKF
         SLL   R3,4
         O     R3,PWORK+4
         ST    R3,PWORK+4
         OI    PWORK+7,X'0F'
         MVC   36(7,R1),EDMSKH
         ED    36(7,R1),PWORK+5
*-----------------------------------------
         L     R2,SAVER2
         L     R1,SAVER1
         L     R10,SAVER10
*-----------------------------------------
         MVC   PWORKF(2),26(R6) SIZE (NO OF LINES)
         LH    R3,PWORKF
         CVD   R3,PWORK
         MVC   43(6,R1),EDMSK
         ED    43(6,R1),PWORK+5
*-----------------------------------------
         MVC   PWORKF(2),28(R6) INIT SIZE (NO OF LINES)
         LH    R3,PWORKF
         CVD   R3,PWORK
         MVC   50(6,R1),EDMSK
         ED    50(6,R1),PWORK+5
*-----------------------------------------
         MVC   PWORKF(2),30(R6) MOD FIELD
         LH    R3,PWORKF
         CVD   R3,PWORK
         MVC   57(6,R1),EDMSKM
         ED    57(6,R1),PWORK+5
*-----------------------------------------
         MVC   65(8,R1),32(R6)    USERID
*-----------------------------------------
         L     R13,4(,R13)
         LM    R14,R12,12(R13)
         LA    R15,0
         LA    R14,4(R14)
         BR    R14
ISPRETR  DS    0H
         L     R13,4(,R13)
         RETURN (14,12),,RC=0 RESTORE REGS AND RETURN
         EJECT
EDMSK    DC    XL6'402020202021'
EDMSKM   DC    XL6'402020202120'
EDMSKV   DC    XL7'402020214B2020'
EDMSKH   DC    XL7'402020217A2020'
ALIASWT  DC    X'00'
NUMTTR   DC    X'00'
         DS    0F
PWORKF   DC    F'0'
PWORK    DC    D'0'
PWORK2   DC    D'0'
SAVER1   DC    F'0'
SAVER2   DC    F'0'
SAVER10  DC    F'0'
ISPFSAVE DS    18F
         LTORG
         DROP R11
         DROP R12
         EJECT
*
*
*
ISPFPTAB DSECT
PYYMMCRE DS    F
PYYMMMOD DS    F
PAMNAME  DS    F
PAXADDR  DS    F
HALFLEN  DS    X
         DS    CL3
*
*
*
PARMPTAB DSECT
PRMPTRX  DS    F
PRMLENX  DS    XL2
PRMLCTX  DS    H
BEGNPRM  DS    F                       CURRENT SYM TBL ADDR
ENDPRM   DS    F                       SYM TBL END ADDR
PRMXSKIP DS    F                       SYM TBL END ADDR
PADATA   EQU   X'80'                   D= (COMBINED M= AND C=)
PMDATA   EQU   X'40'                   M= (ISPF MODIFIED DATE FIELD)
PCDATA   EQU   X'20'                   C= (ISPF CREATED DATE DIELD)
PGE      EQU   X'10'                   GREATER THAN
PLE      EQU   X'08'                   LESS THAN
PMEMBER  EQU   X'04'                   LOOK FOR MEMBER NAME
*
         END   LISTPDSI
./       ADD   NAME=LOCMEM$S
PROC 0 DEBUG
/*  AUTHOR:  DAVID RIKER   5/4/88                      */
/*           COMPUTER DATA SYSTEMS, INC.               */
/*           1 CURIE COURT                             */
/*           ROCKVILLE, MD 20850                       */
/*           (202) 362 1160                            */
 CONTROL NOMSG PROMPT
 IF &DEBUG = DEBUG THEN CONTROL MSG LIST CONLIST SYMLIST PROMPT NOFLUSH
 IF &SYSPREF  EQ  &STR() THEN DO
     SET &DSPRFX EQ &SYSUID
     END
     ELSE IF &SYSPREF  EQ  &SYSUID THEN DO
          SET &DSPRFX EQ &SYSUID
          END
          ELSE DO
               SET &DSPRFX EQ &STR(&SYSPREF..&SYSUID)
               END
 ISPEXEC VGET (MVOL MUNIT MDSN MDATE CDATE ADATE AMEM)
 SET &SMDSN  = &MDSN
 ISPEXEC VPUT (SMDSN)
 ISPEXEC SELECT PGM(FIXUPDSN) PARM(SMDSN)
 ISPEXEC VGET (SMDSN)
 ISPEXEC VPUT (MDSN MVOL MUNIT MDATE CDATE ADATE AMEM) PROFILE
 SET &SMDSN  = &SMDSN
 SET &PARM = &STR(LC=60)
 IF &STR(&MDATE) ^= &STR() THEN SET &PARM =&STR(&PARM,M=(&MDATE))
 IF &STR(&CDATE) ^= &STR() THEN SET &PARM =&STR(&PARM,C=(&CDATE))
 IF &STR(&ADATE) ^= &STR() THEN SET &PARM =&STR(&PARM,D=(&ADATE))
 IF &STR(&AMEM ) ^= &STR() THEN SET &PARM =&STR(&PARM,S=(&AMEM))
 IF &MVOL ^=  &Z THEN +
    SET &SMDSN =&STR(&SMDSN. VOL(&MVOL) UNIT(&MUNIT) )
IFALC F(PDS)
SET LCC = &LASTCC
IF &LCC = 0 THEN  FREE  FI(PDS)
 ALLOC FI(PDS) DA(&MDSN) SHR
 CALL 'XXXXXX.DOR.LINKLIB2(LISTPDSI)' '&PARM'
 FREE FI(PDS)
./       ADD   NAME=LOCMEM#P
%-------------- LOCATE MEMBER BY ISPF DATE OR MEMBER STRING ------------
%COMMAND ===>_ZCMD
+
+ ENTER DATE IN FORMAT OF YY/MM/DD: (I.E., 88/, 88/06/, OR 87/,88/)
+ ENTER %<+ FOR DATES    LESS THAN THE ENTERED DATE VALUE.
+ ENTER %>+ FOR DATES GREATER THAN THE ENTERED DATE VALUE.
+    (I.E., >87 WILL LOCATE MEMBERS THAT HAVE GREATER THAN 87/12/31.)
+        OR <87 WILL LOCATE MEMBERS THAT HAVE LESS THAN 87/01/01.)
+
+ CREATED DATE %===>_CDATE
+MODIFIED DATE %===>_MDATE
+   BOTH DATES %===>_ADATE
+    MEMBER(S) %===>_AMEM
+
+DSN %>_MDSN                                       +VOL%=>_MVOL  +UNIT%=
+
+ ----------------------------------------------------------------------
+   IF NO DATE ENTRIES, DEFAULT "BOTH DATES" = ALL.
+   FOR MULTIPLE DATE ENTRIES, ENTER COMMA DELIMITER BETWEEN THE DATES.
+   (I.E.,  87/04,87/06,88/02,...,ETC.)
+_DEBUG
)INIT
/*  AUTHOR: DAVID RIKER   5/4/88               */
/*          COMPUTER DATA SYSTEMS, INC.        */
/*          1 CURIE COURT                      */
/*          ROCKVILLE, MD 20850                */
/*          202- 362 1160                      */
 .HELP  = TLOCMEM
 .CURSOR = ZCMD
)PROC
VER (&MDSN,NONBLANK,MSG=LCM001)    VER (&MDSN,DSNAME,MSG=LCM002)
IF (&AMEM =  &Z )
  IF (&MDATE = &Z )
   IF (&CDATE = &Z )
      IF (&ADATE = &Z )
         &ADATE = ALL
&ZSEL = 'CMD(%LOCMEM$S &DEBUG)'
)END
./       ADD   NAME=LOCMEM#R
%------------- LOCATE MEMBER BY ISPF DATE OR MEMBER STRING -------------
%COMMAND ===>_ZCMD
+
+ ENTER DATE IN FORMAT OF YY/MM/DD: (I.E., 88/, 88/06/, OR 87/,88/)
+ ENTER %<+ FOR DATES    LESS THAN THE ENTERED DATE VALUE.
+ ENTER %>+ FOR DATES GREATER THAN THE ENTERED DATE VALUE.
+    (I.E., >87 WILL LOCATE MEMBERS THAT HAVE GREATER THAN 87/12/31.)
+        OR <87 WILL LOCATE MEMBERS THAT HAVE LESS THAN 87/01/01.)
+
+ CREATED DATE %===>_CDATE
+MODIFIED DATE %===>_MDATE
+   BOTH DATES %===>_ADATE
+      MEMBERS %===>_AMEM
+
+ ANY CHANGE OF REQUEST FOR &LOCMDSN
+&LOCMSTR
+ ----------------------------------------------------------------------
+   IF NO DATE ENTRIES, DEFAULT "BOTH DATES" = ALL.
+   FOR MULTIPLE DATE ENTRIES, ENTER COMMA DELIMITER BETWEEN THE DATES.
+   (I.E.,  87/04,87/06,88/02,...,ETC.)
+_DEBUG
)INIT
/*  AUTHOR: DAVID RIKER   5/4/88               */
/*          COMPUTER DATA SYSTEMS, INC.        */
/*          1 CURIE COURT                      */
/*          ROCKVILLE, MD 20850                */
/*          202- 362 1160                      */
 .HELP  = T
 .CURSOR = ZCMD
)PROC
IF (&AMEM = &Z )
  IF (&MDATE = &Z )
   IF (&CDATE = &Z )
      IF (&ADATE = &Z )
         &ADATE = ALL
&LOCMCMD = ' '
IF (&MDATE ^= &Z)
   &LOCMCMD = 'M=(&MDATE)'
IF (&CDATE ^= &Z)
   IF (&LOCMCMD ^= &Z)
   &LOCMCMD = '&LOCMCMD,C=(&CDATE),'
   IF (&LOCMCMD = &Z)
   &LOCMCMD = 'C=(&CDATE)'
IF (&ADATE ^= &Z)
   IF (&LOCMCMD ^= &Z)
   &LOCMCMD = '&LOCMCMD,M=(&MDATE),'
   IF (&LOCMCMD = &Z)
   &LOCMCMD = 'M=(&MDATE)'
IF (&AMEM  ^= &Z)
   IF (&LOCMCMD ^= &Z)
   &LOCMCMD = '&LOCMCMD,S=(&AMEM),'
   IF (&LOCMCMD = &Z)
   &LOCMCMD = 'S=(&AMEM)'
)END
./       ADD   NAME=LOCMEM#T
)ATTR DEFAULT(%+?)
/*********************************************************************/
/*                                                                   */
/*    DAVID RIKER                                                    */
/*    COMPUTER DATA SYSTEMS, INC                                     */
/*    1 CURIE COURT                                                  */
/*    ROCKVILLE MD 20850                                             */
/*    (202) 362 - 1160                                               */
/*                                                                   */
/*********************************************************************/
/*                                                                   */
/*    THIS PANEL SUPPORTS THE BROWSE BY LOCMEM FUNCTION.             */
/*                                                                   */
/*********************************************************************/
  ! TYPE(OUTPUT) INTENS(HIGH)
  # TYPE(INPUT) CAPS(ON) INTENS(HIGH) PAD('_')
  ^ TYPE(INPUT) CAPS(ON) INTENS(HIGH)
  @ TYPE(OUTPUT) INTENS(LOW)
)BODY
%---------- MEMBERS LOCATED ON &LOCMDSN --------------------------------
%COMMAND ===>?ZCMD                                            %SCROLL ==
%
%@LOCMSTR
+%B+- BROWSE Dsn/Member  %E+-EDIT Dsn/Member +
%
 S
E                   CREATED  LAST MODIFIED                     
L   MEMBER  VER.MOD   DATE  DATE        TIME SIZE INIT  MOD  
---------------------------------------------------------------
)MODEL
+#Z+ @LOCMNME @LOCMINF
)INIT
 .ZVARS = '(LOCMSEL)'
 &AMT=CSC
.HELP=TLOCM1
  &ZTDMARK = '***************** END OF LOCATED MEMBERS FOR &LOCMDSN +
              ***************************'
  &ZTDMARK = TRUNC (&ZTDMARK,79)
)PROC
IF (&ZCMD = &Z)
 IF (&ZTDSELS ^= 0)
   VER (&LOCMSEL,LIST,E,B,R)
&ZCMD=&ZCMD
)END
./       ADD   NAME=TLOCMEM
%TUTORIAL ----------------- LOCATE MEMBER -----------------------------T
%NEXT SELECTION ===>_ZCMD

+ THE COMMAND WILL SEEK MEMBERS OF THE DSN. IT WILL FIND MEMBERS
+ THAT MATCH TO ISPF DATE (CREATED DATE OR MODIFIED DATE.)
%
% 1+- MORE INFORMATION FOR CREATE DATE
% 2+- MORE INFORMATION FOR MODIFIED DATE
% 3+- OTHER INFORMATION
%
%
%
)PROC
  &SEL = TRANS( &ZCMD
                1,TLOCMEM1
                2,TLOCMEM2
                3,TLOCMEM3
                *,'?' )
)END
)PROC
 &ZCONT = TLOCMEM1
)END
./       ADD   NAME=TLOCMEM1
%TUTORIAL ----------------- LOCATE MEMBER ( CREATE DATE )--------------T
%NEXT SELECTION ===>_ZCMD

% THE CREATE DATE IS THE DATE THAT THE MEMBER IS CREATED BY ISPF.
%
)PROC
)END
)PROC
 &ZCONT = TLOCMEM2
 &ZUP   = TLOCMEM
)END
./       ADD   NAME=TLOCMEM2
%TUTORIAL ----------------- LOCATE MEMBER ( MODIFIED DATE) ------------T
%NEXT SELECTION ===>_ZCMD

% THE MODIFIED DATE IS THE DATE THAT THE MEMBER IS LAST MODIFIED.
%
)PROC
)END
)PROC
 &ZCONT = TLOCMEM3
 &ZUP   = TLOCMEM1
)END
./       ADD   NAME=TLOCMEM3
%TUTORIAL ----------------- LOCATE MEMBER -----------------------------T
%NEXT SELECTION ===>_ZCMD

% NO INFORMATION HERE. PLEASE CONTINUE TO NEXT TUTORIAL.
%
)PROC
)END
)PROC
 &ZCONT = TLOCMEM
 &ZUP   = TLOCMEM2
)END

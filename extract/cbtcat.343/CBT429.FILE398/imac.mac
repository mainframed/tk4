/* REXX
 ×
 × Name: IMAC
 ×
 × Author: David Alcock
 ×         davea@ticnet.com
 ×
 × Purpose: This is an ISPF edit macro that inserts IBM macro
 ×          DSECT assembler statements into an assembler source file.
 ×
 × Thanks: This edit macro was inspired by the CBT tape file 398
 ×         which is an Assembler MACRO that invokes the IBM macros
 ×         during assembly and not during edit.
 ×
 × Syntax: IMAC ACB
 ×         IMAC DSCB4
 ×         IMAC DYNALLOC
 ×
 × Note: The code that selects the Assembler DSECT statement
 ×       was generated by the IMACBLD Rexx Exec.
 ×
 × Disclaimer: This REXX exec is FREEWARE.  Use at your own risk.  It
 ×             is provided for your enjoyment and neither David
 ×             Alcock or his employer provides any warranty for it's
 ×             use.  I'd like to hear how it works on your system.
 */

address ISPEXEC

'ISREDIT MACRO (RMAC) NOPROCESS'
rmac = translate(rmac)

/* Process line commands. Ensure that "A" or "B" was specified */
'CONTROL ERRORS RETURN'
'ISREDIT PROCESS DEST'

select
  when rc = 0  then 'ISREDIT (ZDEST) = LINENUM .ZDEST'
  when rc <= 8 then do /* No A or B entered */
       zedsmsg = 'Enter "A" or "B" on an ISPF line'
       zedlmsg = 'IMAC requires an "A" or "B" line command'
       'SETMSG MSG(ISRZ001)'
       exit 12
       end
  when rc < 20 then exit 12 /* Conflicting line commands */
  when rc = 20 then zdest = 0
  otherwise
    exit 12
    end

'CONTROL ERRORS CANCEL'

/* Start of IMACBLD generated code - - - - - - - - - - - - */

select
  when rmac = 'ACB' then do
       aline = '         IFGACB   ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'ACEE' then do
       aline = '         IHAACEE  ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'ASCB' then do
       aline = '         IHAASCB DSECT=YES,LIST=YES'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'ASVT' then do
       aline = '         IHAASVT DSECT=YES,LIST=YES'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'ASSB' then do
       aline = '         IHAASSB LIST=YES'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'ASXB' then do
       aline = '         IHAASXB DSECT=YES,LIST=YES'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'ATTACH' then do
       aline = '         IEZATTCH LIST=YES'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'BASEA' then do
       aline = '         IEEBASEA ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'CDE' then do
       aline = '         IHACDE   ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'CSCB' then do
       aline = '         IEECHAIN ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'CSD' then do
       aline = '         IHACSD DSECT=YES'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'CTXT' then do
       aline = '         IEZVX100 DSECT=YES'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'CVT' then do
       aline = '         CVT DSECT=YES,LIST=YES,PREFIX=YES'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'DCB' then do
       aline = '         DCBD  DSORG=PS'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'DCBDA' then do
       aline = '         DCBD  DSORG=DA'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'DCE' then do
       aline = '         IECDDCE  ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'DECB' then do
       aline = '         IHADECB DSECT=YES'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'DFA' then do
       aline = '         IHADFA DSECT=YES'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'DSAB' then do
       aline = '         IHADSAB  ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'DSCB1' then do
       aline = '         IECSDSL1 1'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'DSCB4' then do
       aline = '         DS    44X'04''
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       aline = '         IECSDSL1 4'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'DYNALL' then do
       aline = '         IEFZB4D0 ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       aline = '         IEFZB4D2 ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'DEB' then do
       aline = '         IEZDEB LIST=YES'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'DVA' then do
       aline = '         IHADVA DSECT=YES'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'DVCT' then do
       aline = '         IHADVCT DSECT=YES'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'ECT' then do
       aline = '         IKJECT   ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'ECVT' then do
       aline = '         IHAECVT LIST=YES'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'EPIE' then do
       aline = '         IHAEPIE  ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'GDA' then do
       aline = '         IHAGDA   ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'IOB' then do
       aline = '         IEZIOB DSECT=YES'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'IOCOM' then do
       aline = '         IECDIOCM ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'IPA' then do
       aline = '         IHAIPA   ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'JCT' then do
       aline = '         JCT      DSECT'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       aline = '         IEFAJCTB ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'JCTX' then do
       aline = '         JCTX     DSECT'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       aline = '         IEFJCTX  ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'JESCT' then do
       aline = '         IEFJESCT ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'JFCB' then do
       aline = '         JFCB     DSECT'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       aline = '         IEFJFCBN LIST=YES'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'JMR' then do
       aline = '         IEFJMR   ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'JSAB' then do
       aline = '         IAZJSAB  ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'JSCB' then do
       aline = '         IEZJSCB  ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'JSCVT' then do
       aline = '         IEFJSCVT ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'LCCA' then do
       aline = '         IHALCCA DSECT=YES'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'LCT' then do
       aline = '         IEFALLCT ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'LDA' then do
       aline = '         IHALDA   ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'LLE' then do
       aline = '         IHALLE   ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'LPDE' then do
       aline = '         IHALPDE  ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'LWA' then do
       aline = '         IKJEFLWA ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'OCE' then do
       aline = '         IECDSECS ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       aline = '         IECDSECT ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'ORE' then do
       aline = '         IHAORE DSECT=YES'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'OUCB' then do
       aline = '         IRAOUCB DSECT=YES'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'OUXB' then do
       aline = '         IHAOUXB DSECT=YES'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       aline = '         IEZBITS  ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'PCCA' then do
       aline = '         IHAPCCA DSECT=YES'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'PDS2' then do
       aline = '         IHAPDS DSECT=YES,PDSBLDL=YES'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'PSA' then do
       aline = '         IHAPSA DSECT=YES,LIST=YES'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'PSCB' then do
       aline = '         IKJPSCB  ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'RAX' then do
       aline = '         IARRAX   ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'RCE' then do
       aline = '         IARRCE   ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'RCVT' then do
       aline = '         ICHPRCVT ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'RD' then do
       aline = '         IHARD    ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'RMCT' then do
       aline = '         IRARMCT DSECT=YES'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'RB' then do
       aline = '         IKJRB DSECT=YES,LIST=YES'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'REXX' then do
       aline = '         IRXARGTB ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       aline = '         IRXCMPTB ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       aline = '         IRXDSIB  ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       aline = '         IRXEFPL  ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       aline = '         IRXENVB  ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       aline = '         IRXENVT  ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       aline = '         IRXEVALB ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       aline = '         IRXEXECB ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       aline = '         IRXEXTE  ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       aline = '         IRXFPDIR ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       aline = '         IRXINSTB ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       aline = '         IRXMODNT ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       aline = '         IRXPACKT ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       aline = '         IRXPARMB ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       aline = '         IRXSHVB  ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       aline = '         IRXSUBCT ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       aline = '         IRXWORKB ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'RIB' then do
       aline = '         ISGRIB   ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'RPL' then do
       aline = '         IFGRPL   ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       aline = '         IDARMRCD ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'SCA' then do
       aline = '         IHASCA   ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'SCB' then do
       aline = '         IHASCB DSECT=YES'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'SCCB' then do
       aline = '         IHASCCB  ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'SCT' then do
       aline = '         SCT      DSECT'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       aline = '         IEFASCTB ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'SCTX' then do
       aline = '         IEFSCTX DSECT=YES'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'SCVT' then do
       aline = '         IHASCVT DSECT=YES,LIST=YES'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'SDWA' then do
       aline = '         IHASDWA DSECT=YES,VRAMAP=YES'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'SIOT' then do
       aline = '         SIOT     DSECT'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       aline = '         IEFASIOT ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'SMCA' then do
       aline = '         IEESMCA  ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'SNAP' then do
       aline = '         IHASNAP DSECT=YES'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'SPIE' then do
       aline = '         IHASCA   ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       aline = '         IHAEPIE  ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       aline = '         IHAPIE   ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       aline = '         IHAPICA  ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'SPQE' then do
       aline = '         IHASPQE  ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       aline = '         IHAFBQE  ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       aline = '         IHASPQA  ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       aline = '         IHADQE   ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       aline = '         IHAFQE   ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       aline = '         IHASPT   ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'SSOB' then do
       aline = '         IEFJSSOB (AL,SO)'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'SSIB' then do
       aline = '         IEFJSSIB ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'SSSA' then do
       aline = '         IEFSSSA  ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'SSVT' then do
       aline = '         IEFJSSVT ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'STCB' then do
       aline = '         IHASTCB LIST=YES'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'SVT' then do
       aline = '         IHASVT LIST=YES'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'SWB' then do
       aline = '         IEFSWB   ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'TAXE' then do
       aline = '         IKJTAXE  ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'TCAS' then do
       aline = '         IKTTCAST DSECT=YES'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'TCB' then do
       aline = '         IKJTCB DSECT=YES,LIST=YES'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'TCT' then do
       aline = '         IEFTCT   ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'TIOT' then do
       aline = '         TIOT     DSECT'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       aline = '         IEFTIOT1 ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'TMPWA' then do
       aline = '         IKJTMPWA ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'TPC' then do
       aline = '         IEAVVTPC ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'TQE' then do
       aline = '         IHATQE   ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'TSB' then do
       aline = '         IKJTSB LIST=YES,EXT=YES'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'TSVT' then do
       aline = '         IKJTSVT  ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'UCB' then do
       aline = '         **       IEFUCBOB LIST=YES,PREFIX=YES,SSMD=YES'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       aline = '         IEFUCBOB LIST=YES,PREFIX=YES'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'UCM' then do
       aline = '         IEECUCM LIST=YES,DSECT=YES'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'UPT' then do
       aline = '         IKJUPT   ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'VLD' then do
       aline = '         IGDVLD   ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'XCF' then do
       aline = '         IXCYQUAA DSECT=YES'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
  when rmac = 'XL' then do
       aline = '         IHAXTLST ,'
       'VPUT (ALINE)'
       'ISREDIT LINE_AFTER 'zdest' = DATALINE (ALINE)'
       end
otherwise
  say 'Macro 'rmac' is not supported by IMAC.  We support:'
  say ' '
  say 'ACB    ACEE   ASCB   ASVT   ASSB   ASXB   ATTACH BASEA  CDE    '
  say 'CSCB   CSD    CTXT   CVT    DCB    DCBDA  DCE    DECB   DFA    '
  say 'DSAB   DSCB1  DSCB4  DYNALL DEB    DVA    DVCT   ECT    ECVT   '
  say 'EPIE   GDA    IOB    IOCOM  IPA    JCT    JCTX   JESCT  JFCB   '
  say 'JMR    JSAB   JSCB   JSCVT  LCCA   LCT    LDA    LLE    LPDE   '
  say 'LWA    OCE    ORE    OUCB   OUXB   PCCA   PDS2   PSA    PSCB   '
  say 'RAX    RCE    RCVT   RD     RMCT   RB     REXX   RIB    RPL    '
  say 'SCA    SCB    SCCB   SCT    SCTX   SCVT   SDWA   SIOT   SMCA   '
  say 'SNAP   SPIE   SPQE   SSOB   SSIB   SSSA   SSVT   STCB   SVT    '
  say 'SWB    TAXE   TCAS   TCB    TCT    TIOT   TMPWA  TPC    TQE    '
  say 'TSB    TSVT   UCB    UCM    UPT    VLD    XCF    XL     '
  end
/* End of IMACBLD generated code - - - - - - - - - - - - - */

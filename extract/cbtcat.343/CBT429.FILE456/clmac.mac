         MACRO           ACD FORMAT.
        #ACD   &R=YES
         SPACE 1
*        ACCOUNTING CARD DESCRIPTION.
*        ----------------------------
         SPACE 1
ACDSECT  DSECT
         SPACE 1
ACDATE   DS    CL5 .               DATE (YYDDD).
ACDSN    DS    CL44 .              DATA-SET NAME.
ACVLS    DS    CL6 .               VOLUME SERIAL NUMBER.
ACTYP    DS    CL2 .               DIRECT-ACCESS VOLUME TYPE.
ACTRKS   DS    CL5 .               DATA-SET SPACE (TRACKS UNITS).
ACFILL   EQU   80-(*-ACDSECT) .
         DS    (ACFILL)C' ' .      NOT USED(BLANKS).
         SPACE 1
ACLGTH   EQU   *-ACDSECT .         LENGTH OF CARD.
         AIF   ('&R' EQ 'NO').A
         SPACE 1
&SYSECT  CSECT  .                  RESTORE ORIGINAL CSECT.
.A       SPACE 2
         MEND
         MACRO
        #BYPRDS     &DUMMY
BYPRDS   DSECT           BYPRACF TABLE ELEMENT DESCRIPTION. ----------
         SPACE 1
BYPRLG   DS    XL1       LENGTH OF PREFIX
BYPRDC   DS    XL3       DISCRETE COUNT
BYPRFL   DS    XL1       FLAGS
BYPRGC   DS    XL3       GENERIC COUNT
BYPRL    EQU   X'01'               BYPASS RACF - NOLIST FLAG
BYPRS    EQU   X'02'               BYPASS RACF - SKIP FLAG
BYPRPX   DS    CL44      PREFIX (VARIABLE LENGTH)
         MEND
         MACRO
        #DEFSZ &DUMMY
*              --------------------------
*                    DEFAULT SIZES.
*              --------------------------
         SPACE 1
NEV      EQU   50        MAX. NO. OF ELIGIBLE VOLUMES
NCV      EQU   50        MAX. NO. OF CATALOG VOLUMES
NNC      EQU   50        MAX. NO. OF N-CAT. VOLUMES
NGV      EQU   2000      MAX. NO. OF CVOL POINTERS
NDV      EQU   100       MAX. NO. OF NOT-DECLARED VOLUMES
NDD      EQU   100       MAX. NO. OF DDNAME'S IN TABLE
NIX      EQU   200       MAX. NO. OF NULL INDEXES
NSK      EQU   50        MAX. NO. OF SKIP NAMES
NGD      EQU   2000      MAX. NO. OF HIGH-LEVELS NAMES (RACF PROFILES)
NVG      EQU   8000      MAX. NO. OF GENERIC NAMES (RACF PROFILES)
NRE      EQU   10000     MAX. NO. OF DSNAME'S IN TABLE
NW1      EQU   2000      1ST RACF WORK AREA LENGTH (BYTES)
NW2      EQU   800       2ND RACF WORK AREA LENGTH (BYTES)
NBR      EQU   50        MAX. NO. OF BYPASS RACF NAMES
NWI      EQU   100       NO. OF CARDS IN IDCAMS SINGLE ARRAY
         MEND
         MACRO
        #FPRL  &DUMMY
FPRL     DSECT           DSNAME'S LIST LINE DESCRIPTION. -------------
         SPACE 1
         DS    C ----------------> ASA CONTROL
ZDSN     DS    CL44      DATA-SET NAME
         DS    C
ZDSO     DS    CL1       DATA-SET ORGANIZATION ---> M/F/
         DS    C
ZDSM     DS    CL2       DATA-SET MULTI-VOLUME COUNT / FILE SEQ. NO.
         DS    C
ZDSU     DS    CL3       ---> MDL/GDG/NGI/---
         DS    C
ZDSV     DS    CL8       D.S. OR RACF VOL. SER./ ......
         DS    C
ZDST     DS    CL4       ---> VSAM/VS-L/----
         DS    C
ZDSP     DS    CL3       ---> SET/---
         DS    C
ZC       DS    CL5       ---> R-CAT/L-CAT/I-CAT/-----
         DS    C
ZR       DS    CL5       ---> RACF P-DIS/P-GEN/-----
         DS    C
ZRT      DS    CL5       ---> VSAM/-----
         DS    C
ZRU      DS    CL3       ---> MDL/---
         DS    C
ZAV      DS    CL8       CAT. OR RACF VOL. SER./ ......
         DS    C
ZACT     DS    CL9       ---> SCRATCH/SC. TEMP./SC. DISK/UNCATALOG/
*                             DEL. RACF/ADD RACF/CH. RACF/OFF VTOC/
*                             ON VTOC/VTOC+RACF/CATALOG/MOD. RACF/
*                             ---------
         DS    C
ZSEP     DS    C         ---> U/
         DS    C
ZRCVRY   DS    CL7       ---> C. RACF/A. RACF/M-VOL/S-VOL/EXEMPT/
*                             *ERROR*/CONTROL/-------
         SPACE 1
FPRLL    EQU   *-FPRL              LINE LENGTH
FPRLLC   EQU   0+L'LINE-FPRLL      LINE LENGTH CONTROL
         MEND
         MACRO
        #LALNE &DUMMY
LALNE    DSECT           RACF USER'S LIST LINE DESCRIPTION. ----------
         SPACE 1
         DS    C ----------------> ASA CONTROL
LAUS     DS    CL8       USER
         DS    C
LASPO    DS    CL1       '('
LAOW     DS    CL8       OWNER OF THE USER
LASPT    DS    CL1       ')'
         DS    C
LADFT    DS    CL1       ':'
         DS    C
LADF     DS    CL8       DEFAULT GROUP
         DS    C
LAVAR    DS    0CL1      VARIOUS INFORMATION
LASPG    DS    CL11      '- CONNECT :'
         DS    C
LACN     DS    CL8       CONNECT GROUP NAME
         DS    C
LCSPO    DS    CL1       '('
LCOW     DS    CL8       OWNER OF THE CONNECT
LCSPT    DS    CL1       ')'
         DS    C
LCSPU    DS    CL1       '-'
         DS    C
LCAUT    DS    CL22      'DEFAULT UNIV. ACCESS :'
         DS    C
LCAU     DS    CL8       ACC. ---> ALTER/CONTROL/UPDATE/READ/NONE/
*                                  X'..'
         DS    C
LCSPA    DS    CL1       '('
LCSI     DS    CL6       ACCESS COUNT
LCSPB    DS    CL1       ')'
         SPACE 1
         ORG   LCAUT
         SPACE 1
LCLAST   DS    0CL50     LAST CONNECT AT ...
LCATTR   DS    CL7       'ATTR. :'
         DS    C
LCFLGS   DS    CL44      FLAGS ---> ADSP/SPECIAL/OPERATIONS/REVOKE/
*                                   GRPACC/X'..'
         SPACE 1
         ORG   LASPG
         SPACE 1
LASPU    DS    CL1       '-'
         DS    C
LAATTR   DS    CL7       'ATTR. :'
         DS    C
LAFLGS   DS    CL50      FLAGS ---> ADSP/SPECIAL/OPERATIONS/REVOKE/
*                                   GRPACC/X'..'
         DS    C
LANOGRP  DS    0CL22     '---> (NO GROUP ACCESS)'
         SPACE 1
         ORG   LAATTR
         SPACE 1
LADS     DS    CL44      DATA-SET NAME
         DS    C
LASPV    DS    CL1       '('
LADSOW   DS    CL8' '    OWNER OF THE DATA-SET
LASPW    DS    CL1       ')'
         DS    C
LAACT    DS    CL1       '- ...'
         DS    C
LAAC     DS    CL8       USER NAME
         DS    C
LASPA    DS    CL1       ':'
         DS    C
LAAU     DS    CL8       ACC. ---> ALTER/CONTROL/UPDATE/READ/NONE/
*                                  X'..'
         DS    C
LADLM    DS    CL8       '(DELETE)'
         DS    CL8       ...
         SPACE 1
         ORG   ,
         SPACE 1
LLALNE   EQU   *-LALNE             LINE LENGTH
LLALNEC  EQU   0+L'LINE-LLALNE     LINE LENGTH CONTROL
         MEND
         MACRO
        #LGLNE &DUMMY
LGLNE    DSECT           RACF GROUP'S LIST LINE DESCRIPTION. ---------
         SPACE 1
         DS    C ----------------> ASA CONTROL
LGGN     DS    CL8       GROUP
         DS    C
LGSPO    DS    CL1       '('
LGOW     DS    CL8       OWNER OF THE GROUP
LGSPT    DS    CL1       ')'
         DS    C
LGSPS    DS    CL1       ':'
         DS    C
LGSG     DS    CL8       SUPERIOR GROUP
         DS    C
LGVAR    DS    0CL80     VARIOUS INFORMATION
LGSPG    DS    CL11      '- SGRP(S) :'
         DS    C
LGSN     DS    8CL9      SUBGROUP NAMES
NLGSN    EQU   (*-LGSN)/L'LGSN
         SPACE 1
         ORG   LGSPG
         SPACE 1
LGSPU    DS    CL11      '- USER(S) :'
         DS    C
LGUN     DS    3CL24     USER NAMES
NLGUN    EQU   (*-LGUN)/L'LGUN
         SPACE 1
         ORG   LGUN
         SPACE 1
LGUS     DS    CL8       USER NAME
         DS    C
LGSPA    DS    CL1       '-'
         DS    C
LGAC     DS    CL8       AUTH. ---> JOIN/CONNECT/CREATE/USE/X'..'
         SPACE 1
         ORG   LGSPG
         SPACE 1
LGSPD    DS    CL1       '-'
         DS    C
LGDS     DS    CL44      DATA-SET NAME
         DS    C
LGSPV    DS    CL1       '('
LGDSOW   DS    CL8       OWNER OF THE DATA-SET
LGSPW    DS    CL1       ')'
         DS    C
LGACT    DS    CL1       '- ...'
         DS    C
LGACC    DS    CL8       USER NAME
         DS    C
LGSPB    DS    CL1       ':'
         DS    C
LGAU     DS    CL8       ACC. ---> ALTER/CONTROL/UPDATE/READ/NONE/
*                                  X'..'
         DS    C
         DS    CL16      ...
         SPACE 1
         ORG   ,
         SPACE 1
LLGLNE   EQU   *-LGLNE             LINE LENGTH
LLGLNEC  EQU   0+L'LINE-LLGLNE     LINE LENGTH CONTROL
         MEND
         MACRO
        #WKDS  &DUMMY
WKDS     DSECT           RACF WORK AREAS DESCRIPTION. ----------------
         SPACE 1
WORK     DS    F         LENGTH OF ENTIRE USER AREA
WORKRBA  DS    XL8
WORKDDC  DS    F         DUPLICATE DATA-SET NAME COUNT
WORKRES  DS    XL8
WORKTL   DS    F         LENGTH OF DATA RETURNED INTO WORK AREA
WORKBS   EQU   *-WORK
WORKBSL  EQU   (*-WORKRES)+2
WORKBSLL EQU   (*-WORKRBA)+3
WORKVRA  DS    XL1       FIELD VALUE RETURN AREA (VARIABLE)
         MEND
         MACRO
        @COMM  &M=
         AIF   ('&M' NE 'MAIN').A
COMMON   DS    0D
        $HEDIT COMMON
         AGO   .C
.A       AIF   ('&M' NE 'SERVICES').B
         PRINT NOGEN
.B       ANOP
COMMON   DSECT
.C       SPACE 1
*        CONSTANTS AND WORK-AREAS.
         SPACE 1
WORKD    DC    D'0'
ATIOT    DC    A(*-*)
JNMEA    DC    A(*-*)
SCIN     DC    A(CARDIN,1,CARDIN+71)    INPUT CARD SCAN
LISCAN   DC    A(*-*,1,LINE+91)    ALTERNATE INPUT CARD SCAN
RCODES   DC    2F'0'               DYN. ALL. RETURN CODES
SVSNAP   DC    7F'0'
COUNTER  DC    F'0'
TYDD     DC    F'0'
USID     DC    CL8' '              CURRENT RACF USERID
         SPACE 1
COPYDS   DC    CL44' '             COPY : DATA-SET NAME
CPYCMD   DC    F'0'                COPY : START COMMAND BUFFER
CPYCMDT  DC    CL60' '
COPYCNME DC    CL44' ' <---------I
CPYCVOL  DC    CL6' '            I
CPYCAT   DC    H'1'              I----- C001 : PARM.LIST
CPYTY    DC    XL4'0'            I
CPYVOL   DC    CL6'USER00' <-----I COPY : VOLUME SERIAL NUMBER
         DC    H'0'
         EJECT
*        TABLES SPACES ADDRESSES, SIZES AND CONTROLS.
         SPACE 1
SPSTRT   DS    0F
         SPACE 1
TBEVOL   DC    A(*-*)              EL. VOL. TABLE ADDRESS
TBEVOLT  DC    A(SPEV)             TOTAL SPACE FOR EL. VOL. TABLE
TBEVOLE  DC    A(*-*)              END OF EL. VOL. TABLE ADDRESS
         SPACE 1
TBCVOL   DC    A(*-*)              CAT. VOL. TABLE
TBCVOLT  DC    A(SPCV)             TOTAL SPACE FOR CAT. VOL. TABLE
TBCVOLE  DC    A(*-*)              END OF CAT. VOL. TABLE
         SPACE 1
TBNVOL   DC    A(*-*)              N-CAT. VOL. TABLE
TBNVOLT  DC    A(SPCN)             TOTAL SPACE FOR N-CAT. VOL. TABLE
TBNVOLE  DC    A(*-*)              END OF N-CAT. VOL. TABLE
         SPACE 1
TBGVOL   DC    A(*-*)              CVOL PTR. TABLE
TBGVOLT  DC    A(SPGV)             TOTAL SPACE FOR CVOL PTR. TABLE
TBGVOLE  DC    A(*-*)              END OF CVOL PTR. TABLE
         SPACE 1
TBDVOL   DC    A(*-*)              NOT-DECLARED VOL. TABLE
TBDVOLT  DC    A(SPDV)             TOTAL SPACE FOR NOT-D. VOL. TABLE
TBDVOLE  DC    A(*-*)              END OF NOT-DECLARED VOL. TABLE
         SPACE 1
TBDDN    DC    A(*-*)              DDNAME TABLE ADDRESS
TBDDNT   DC    A(SPDD)             TOTAL SPACE FOR DDNAME TABLE
TBDDNE   DC    A(*-*)              END OF DDNAME TABLE ADDRESS
         SPACE 1
TBNIX    DC    A(*-*)              NULL INDEXES TABLE ADDRESS
TBNIXT   DC    A(SPNX)             TOTAL SPACE FOR NULL INDEXES TABLE
TBNIXE   DC    A(*-*)              END OF NULL INDEXES TABLE ADDRESS
         SPACE 1
TBSKP    DC    A(*-*)              SKIP NAMES TABLE ADDRESS
TBSKPT   DC    A(SPSK)             TOTAL SPACE FOR SKIP NAMES TABLE
TBSKPE   DC    A(*-*)              END OF SKIP NAMES TABLE ADDRESS
         SPACE 1
DSTAB    DC    A(*-*)              DSNAME TABLE ADDRESS
DSTABT   DC    A(SPDS)             TOTAL SPACE FOR DSNAME'S TABLE
DSTABOV  DC    A(NRE+1)            DSNAME'S TABLE OVERFLOW CONTROL
DSTABCT  DC    A(NRE+1)            NO. OF EL. CONTROL
DSTABNE  DC    F'0'                NO. OF ELEMENTS IN DSNAME'S TABLE
         SPACE 1
TBBYR    DC    A(*-*)              BYPASS RACF NAMES TABLE ADDRESS
TBBYRT   DC    A(SPNB)             BYPASS RACF NAMES TABLE SPACE
TBBYRE   DC    A(*-*)              END OF BYPASS RACF NAMES TABLE ADDR.
         SPACE 1
TBAVOL   DC    A(*-*)              ACC. VOL. TABLE ADDRESS
TBAVOLT  DC    A(SPEV)             TOTAL SPACE FOR ACC. VOL. TABLE
TBAVOLE  DC    A(*-*)              END OF ACC. VOL. TABLE ADDRESS
         EJECT
TBRGDS   DC    A(*-*)              HLQ NAMES TABLE ADDRESS
TBRGDST  DC    A(SPGD)             TOTAL SPACE FOR HLQ NAMES TABLE
TBRGDSE  DC    A(*-*)              END OF HLQ NAMES TABLE ADDRESS
         SPACE 1
TBVRGN   DC    A(*-*)              GENERIC NAMES TABLE ADDRESS
TBVRGNT  DC    A(SPVR)             TOTAL SPACE FOR GENERIC NAMES TABLE
TBVRGNE  DC    A(*-*)              END OF GENERIC NAMES TABLE ADDRESS
         SPACE 1
WK1A     DC    A(*-*)              1ST RACF WORK AREA ADDRESS
WK1T     DC    A(NW1L)             1ST RACF WORK AREA SPACE
WK2A     DC    A(*-*)              2ND RACF WORK AREA ADDRESS
WK2T     DC    A(NW2L)             2ND RACF WORK AREA SPACE
         SPACE 1
DALLS    DS    0F                  DYNAMIC ALLOCATION AREAS ADDRESSES
DALIST   DC    A(*-*)              SYSLIST DYN. ALL.
DADATA   DC    A(*-*)              SYSDATA DYN. ALL.
DACOPY   DC    A(*-*)              SYSCOPY DYN. ALL.
DACTLG   DC    A(*-*)              ICF CATALOG DYN. ALL.
DAIDIN   DC    A(*-*)              IDCAMS SYSIN DYN. ALL.
DAIDOUT  DC    A(*-*)              IDCAMS SYSPRINT DYN. ALL.
DALLN    EQU   (*-DALLS)/4
DALLT    DC    A(SPDA)             TOTAL SPACE FOR DYN. ALLOC. AREAS
         SPACE 1
TOTSPCE  DC    A(SPTOT)            TOTAL ARRAYS SPACE
AGIDST   DC    A(*-*)              IDCAMS ARRAY(S) STARTING POINTER
LGIDST   DC    A(NWIL)             IDCAMS SINGLE ARRAY LENGTH
         SPACE 1
TOTSL    EQU   *-SPSTRT
         EJECT
NSSV     EQU   5                   MAX. NUMBER OF STACKED SAVE AREAS
SVARL    EQU   18*4                STACK SAVE AREA LENGTH
STIDL    EQU   8                   STACK IDENTIFIER LENGTH
STCKL    EQU   SVARL+STIDL         SINGLE STACK LENGTH
NSSVL    EQU   NSSV*STCKL          STACK SAVE AREAS SPACE
         SPACE 1
SVSTACK  DC    0H'0',AL2(NSSV)     NUMBER OF STACK SAVE AREAS
STACKNO  DC    H'1'                CURRENT NO. OF THE STACK
MNAME    DC    CL8' '
         SPACE 1
DYNPLS  $DYNALL ,RCODES,MF=L
RDIPLS  $READ  CARDIN,MF=L
MOPPLS  $MOPEN WORKD,MF=L
MRDPLS  $MREAD LINE+20,MF=L
CU1PLS  $EDITH CUST1,MF=L
CU2PLS  $EDITH CUST2,MF=L
UDDPLS  $UCLOSE DDDATA,MF=L
         EJECT
DDSNAP   DC    CL8'SYSSNAP'
DDDATA   DC    CL8'SYSDATA'
DSNDATA  DC    CL44' '             ACCOUNT : DATA-SET NAME
VADATA   DC    CL6'USER00'         ACCOUNT : VOLUME SERIAL NUMBER
ZERODS   DC    AL1(L'ZERODSN)
ZERODSN  DC    XL44'0'
CTYPE    DC    XL1'0'              / ---> MUST BE IN SEQUENCE WHEN
WORKDS   DC    CL44' '             /      READING CATALOGS.
JNMEL    DC    XL1'0'
GRNMEL   DC    AL1(L'GRNAME)
GRNAME   DC    CL8' '
USNMEL   DC    AL1(L'USNAME)
USNAME   DC    CL8' '
ACL      DS    0CL11               ACCESS LIST ENTRY
ACCNAM   DC    CL8' '
         DC    AL1(ACEEREAD)       READ ACCESS
         DC    XL2'0000'           ACCESS COUNT
USER     DC    CL8' '
         SPACE 1
CLINE    DC    PL2'+60',PL3'+0'
LLINE    DC    PL2'+60',PL3'+0'
PLINE    DC    PL2'+60',PL3'+0'
SYDD     DC    CL5' '              YYDDD
TODAYD   DC    CL6' '              YYMMDD
TODAYA   DC    CL6' '              DDMMYY
THMS     DC    CL6' '              HHMMSS
VSNERR   DC    CL6' '
MASKERR  DC    XL4'40202120'
TRTAB    DC    CL16'0123456789ABCDEF'
FILLDT   DC    CL20' '
         SPACE 1
IDCPARM  DS    0F             IDCAMS FUNCTION INFORMATION REQUEST
IDCDSN   DC    A(*-*)              DATA-SET NAME POINTER
IDCPLS   DC    A(*-*)              PARM.LIST POINTER
IDCFUN   DC    CL1' '              IDCAMS FUNCTION
         EJECT
*        PRINT LINES.
         SPACE 1
         DC    AL1(L'CUST1)
CUST1    DC    CL8' '
         DC    AL1(CUST2L)
CUST2    DC    CL16' ',CL16'   CLEAN - UP   ',CL16' '
CUST2A   DC    CL5'START'
CUST2L   EQU   *-CUST2
         DC    AL1(LTITLE)
TIT      DC    C'1CLEAN-UP RUN -- START AT '
TITTIM   DC    CL8'  .  .  '       TIME
         DC    C' OF '
TITDAT   DC    CL20' ',C' '        DATE
TITTEST  DC    CL10' ',C' '        INDICATE TEST
TITSP    EQU   111-(*-TIT)
TITCOM   DC    (TITSP)C' '
         DC    C'PAGE'
TITPAG   DC    CL6' '              PAGE
LTITLE   EQU   *-TIT
         DC    AL1(TMTL)
TMT      DC    C'0',CL73' '
         DC    CL14'TIME-OF-DAY : '
TMTA     DC    CL8'  .  .  ',CL18' ----> START OF : '
TMTB     DC    CL8' '
TMTL     EQU   *-TMT
         DC    AL1(L'SPACE)
SPACE    DC    CL2' '
         DC    AL1(MSGENDL)
MSGEND   DC    C'0-+-+-+-+- '
MSGENDT  DC    CL8'  .  .  ',C' : CLEAN-UP ENDED -+-+-+-+-'
MSGENDL  EQU   *-MSGEND
         DC    AL1(DFMSGL)
DFMSG    DC    C'0===== DYNAM '
DFOPER   DC    CL4' ',C' ('
DFNAME   DC    CL8' ',C') FAILED : R15 = X'''
DFRC15   DC    CL8' ',C''', ERC = X'''
DFERC    DC    CL4' ',C''', INFO = X'''
DFINFO   DC    CL4' ',C''' ====='
DFMSGL   EQU   *-DFMSG
         DC    AL1(L'USUPT+L'USUPTT)
USUPT    DC    C'0USER''S RACF PROCESSING : '
USUPTT   DC    CL16' '
         DC    AL1(SNAPIDL)
SNAPID   DC    C'0----> SNAP POINT : '
SNAPTFI  DC    CL3' ',C' / STACK : '
SNAPTFN  DC    CL8' '
SNAPIDL  EQU   *-SNAPID
         SPACE 1
DAYT     DC    CL3'MON',C'TUEWEDTHUFRISATSUN'
         DC    AL1(FMOFF)
         EJECT
*        PROCESSING INDICATORS.
         SPACE 1
RUNIND   DC    XL1'0'    - PROCESS -
         SPACE 1
RUTEST   EQU   X'01'     TEST RUN
RUNOLIST EQU   X'02'     SUPPRESS DETAIL LIST
RUDSH    EQU   X'04'     DSNAME'S SHORT LIST
RUCSH    EQU   X'08'     DON'T LIST DSNAME'S ENTRIES FROM CATALOGS
RUNOSCR  EQU   X'10'     NO SCRATCH OF DATA-SETS
RUNOCAT  EQU   X'20'     DON'T MODIFY CATALOGS
RUNORACF EQU   X'40'     DON'T MODIFY THE RACF PROFILES
RUCATMIS EQU   X'80'     MISSING CATALOG(S), DON'T SCRATCH FOR NOT
*                                  CATALOGED
         SPACE 1
RUNOPT   DC    XL1'0'    - PROCESS -
         SPACE 1
RUNOHT   EQU   X'01'     SUPPRES HEADER AND TRAILER PAGE PRINT
RUNLU    EQU   X'02'     SUPPRESS RACF USERS/DATA-SETS DETAIL LIST
RUNLG    EQU   X'04'     SUPPRESS RACF GROUPS/DATA-SETS DETAIL LIST
RUTMT    EQU   X'08'     TIME STAMP REQUEST
RUNOSET  EQU   X'10'     DON'T MODIFY VTOC'S (RACF SET)
RUNOACC  EQU   X'20'     ACCOUNTING PROCESSING SUPPRESS
RUABORT  EQU   X'40'     ACCOUNTING PROCESSING ABORTED
RUGDGL   EQU   X'80'     ALSO GDG WHEN SHORT LIST REQUEST
         SPACE 1
WHAT     DC    XL1'0'    - DATA-SETS STATUS -
         SPACE 1
WHIN     EQU   X'01'     "SYSIN" OPENED
WHCD     EQU   X'02'     "SYSIN" CARD ALREADY READ
WHEOF    EQU   X'04'     "SYSIN" END-OF-FILE
WHDATA   EQU   X'08'     "SYSDATA" OPENED
WHPDSA   EQU   X'10'     "SYSPDS" ALLOCATED
WHPDSO   EQU   X'20'     "SYSPDS" OPENED
WHCOPY   EQU   X'40'     "SYSCOPY" ALLOCATED
WHCHECK  EQU   X'80'     "SYSIN" CHECK RUN
         SPACE 1
WHATS    DC    XL1'0'    - DATA-SETS STATUS -
         SPACE 1
WHPERR   EQU   X'01'     "SYSPRINT" - PRINT ERROR
WHIDIN   EQU   X'02'     "XQIDIN" OPENED
WHIDOUT  EQU   X'04'     "XQIDOUT" OPENED
         EJECT
STATUS   DC    XL1'0'    - STATUS -
         SPACE 1
STCISI   EQU   X'01'     CURRENT IN-STREAM INPUT
STUPT    EQU   X'02'     RACF USERS LIST TITLE
STUNDER  EQU   X'04'     UNDERLINE (OUTPUT ROUTINE)
STCOPY   EQU   X'08'     COPY OPTION ACTIVE
STSCPY   EQU   X'10'     SCRATCH COPY REQUEST DUE TO ERROR
STGCVL   EQU   X'20'     CVOL POINTER'S STATUS LIST INDICATOR
STBRACF  EQU   X'40'     BYPASS ALL RACF PROCESSES INDICATOR
STONLY   EQU   X'80'     ONLY ELIGIBLE VOLUME(S) ANALYSIS
         SPACE 1
RUNSF    DC    XL1'0'    - SNAPS -
         SPACE 1
SFTWA    EQU   X'01'     ALL TABLES ADDRESSES AND LENGTHS (A001)
SFRRD    EQU   X'02'     RACF/DS DEFINITIONS REQUEST (A007)
SFLOC    EQU   X'04'     LOCATE REQUEST (A008)
SFOBT    EQU   X'08'     OBTAIN REQUEST (A008)
SFRUS    EQU   X'10'     RACF/USR REQUEST (A014)
SFRDS    EQU   X'20'     RACF/DS-USR REQUEST (B007)
SFRGR    EQU   X'40'     RACF/GRP REQUEST (A015)
SFRCO    EQU   X'80'     RACF/CON REQUEST (B006)
         SPACE 1
RUNSN    DC    XL1'0'    - SNAPS -
         SPACE 1
SNGDS    EQU   X'01'     RACF/DS-GRP REQUEST (B008)
SNRRO    EQU   X'02'     RACF/DS OWNER DEFINITIONS REQUEST (A007)
SNRAE    EQU   X'04'     RACF/DS OWNER ALTER ERROR REQUEST (A007)
SNGCV    EQU   X'08'     LOCATE CATALOG VOLUME REQUEST (B005)
SNECV    EQU   X'10'     LOCATE CAT. VOLUME NOT FOUND REQ. (B005)
SNSCR    EQU   X'20'     SCRATCH DATA-SET - RACF ACCESSS (A013)
SNINX    EQU   X'40'     LOCATE MAIN INDEX (A010)
SNDBG    EQU   X'80'     ALL ARRAYS ON ERROR (MAIN)
         SPACE 1
ACCIND   DC    XL1'0'    - ACCOUNT -
         SPACE 1
AFVOL    EQU   X'01'     VOLUME(S) PRESENT
AFFULL   EQU   X'02'     DATA-SETS ACCOUNTING FULL LIST
         SPACE 1
RUSREQ   DC    XL1'0'    - SPECIAL REQUESTS -
         SPACE 1
RUSABND  EQU   X'01'     ABEND/DUMP ALLOWED.
RUSKOFF  EQU   X'02'     SUPPRESS LIST OF UNPROCESSED VOLUMES.
RUSSCR   EQU   X'04'     SCRATCH COPY DATA-SET DUE TO ERROR.
RUSVSAM  EQU   X'08'     LIST ALL VSAM DATA-SETS INFORMATION
         EJECT
*        BUFFERS.
         SPACE 1
LOCAREA  DC    0D'0',XL256'0',XL16'0'   LOCATE WORK AREA
LOCAREAL EQU   *-LOCAREA           LOCATE WORK AREA LENGTH
DVTYP    DC    5F'0'
DVALT    DC    H'0'
DVVLSN   DC    CL6' '
ADDREC   DC    XL8'0'              VTOC RECORD ADDRESS (MBBCCHHR)
VTRDBUF  DC    0F'0',XL140'0'      VTOC READ BUFFER
         SPACE 1
         DC    AL1(L'PRCAR+L'CARDIN)
PRCAR    DC    CL6' '
CARDIN   DC    CL80' '             CARD INPUT BUFFER
         DC    AL1(L'CARDOU)
CARDOU   DC    CL80' '             CARD OUTPUT BUFFER
         DC    AL1(L'LINE)
LINE     DC    CL133' '            LINE PRINT BUFFER
         DC    AL1(*-*)
UNDRL    DC    CL133' '            UNDERLINE PRINT BUFFER
         SPACE 2
         AIF   ('&M' EQ 'MAIN').D
        #DEFSZ
         AGO   .E
.D       ANOP
CMMNL    EQU   *-COMMON            COMMON LENGTH
.E       EJECT
DSTABDS  DSECT                     DSNAME'S TABLE DESCRIPTION
         SPACE 1
* NOTE : FIELDS (1), (2), (3) AND (4) MUST BE IN THIS ORDER (B004).
         SPACE 1
DSNME    DS    CL44            (1) DATA-SET NAME
DSMVCNT  DS    H               (2) MULTI-VOLUME COUNT
DSDDN    DS    0CL8,CL2        (3) DDNAME OF VTOC (FORM : 'VT'+VOLSER)
DSVOLSN  DS    CL6             (4) DATA-SET VOLUME
DSUCBTY  DS    XL4                 UCB TYPE OF VOLUME
DSCBCC   DS    XL8                 DSCB FORMAT 1 ADDRESS (MBBCCHHR)
DSVORG   DS    CL1                 DATA-SET VOLUME ORGANIZATION
XOM      EQU   C'M'                     M = MULTI-VOL.
XOF      EQU   C'F'                     F = FILE SEQ.
*                                       X'0' = SINGLE-VOL.
DSUSE    DS    CL1                 DATA-SET USAGE
XUM      EQU   C'M'                     M = MODEL GDG
XUG      EQU   C'G'                     G = GDG
XUI      EQU   C'I'                     I = NULL GDG INDEX
*                                       X'0' = NORMAL
DSTYPE   DS    CL1                 DATA-SET TYPE
XTV      EQU   C'V'                     V = VSAM (VTOC)
XTL      EQU   C'L'                     L = VSAM (LOCATE)
*                                       X'0' = NON-VSAM
DSPROT   DS    CL1                 DATA-SET PROTECTION
XPR      EQU   C'R'                     R = RACF (VTOC FLAG)
*                                       X'0' = NOT PROTECTED
DSCAT    DS    CL1                 DATA-SET CATALOG STATUS
XCSR     EQU   C'R'                     R = BY READ O.S. CATALOG
XCSI     EQU   C'I'                     I = BY READ ICF CATALOG
XCSL     EQU   C'L'                     L = BY LOCATE
*                                       X'0' = NOT CATALOGED
DSRACF   DS    CL1                 DATA-SET RACF STATUS
XRD      EQU   C'D'                     D = DISCRETE PROFILE
XRG      EQU   C'G'                     G = GENERIC PROFILE
*                                       X'0' = NOT RACF DEFINED
DSRUSE   DS    CL1                 DATA-SET RACF USE
XRUM     EQU   C'M'                     M = MODEL
*                                       X'0' = NORMAL
DSRTYPE  DS    CL1                 DATA-SET RACF TYPE
XRTV     EQU   C'V'                     V = VSAM
*                                       X'0' = NON-VSAM
DSALTVO  DS    CL6                 CAT. OR RACF VOLUME IF NOT MATCH
DSCVOL   DS    CL6                 VOLUME ON WHICH CAT. INFO FOUND
DSACTION DS    CL1                 DATA-SET ACTION
YS       EQU   C'S'                     S = SCRATCH REQ.
YT       EQU   C'T'                     T = SCRATCH TEMPORARY REQ.
YD       EQU   C'D'                     D = SCRATCH DISK REQ.
YU       EQU   C'U'                     U = UNCATALOG REQ.
YC       EQU   C'C'                     C = CATALOG REQ.
YR       EQU   C'R'                     R = DELETE FROM RACF REQ.
YA       EQU   C'A'                     A = ADD TO RACF REQ.
YF       EQU   C'F'                     F = CHANGE RACF REQ.
YY       EQU   C'Y'                     Y = MODIFY RACF REQ.
YN       EQU   C'N'                     N = OFF RACF (VTOC FLAG)
YV       EQU   C'V'                     V = ON RACF (VTOC FLAG)
YW       EQU   C'W'                     W = ON RACF (VTOC FLAG)
*                                           + CHANGE RACF REQ.
YE       EQU   C'E'                     E = ACTION EXEMPTED
YM       EQU   C'M'                     M = MANUAL CONTROL SIGNAL
YZ       EQU   C'Z'                     Z = UNKNOWN STATUS SIGNAL
*                                       X'0' = NO ACTION (ALL O.K.)
DSRCVRY  DS    CL1                 DATA-SET RECOVERY
YRR      EQU   C'R'                     R = CHANGE RACF
YRA      EQU   C'A'                     A = ADD RACF
YRU      EQU   C'U'                     U = USE FOR ADD RACF
YRM      EQU   C'M'                     M = DEF. MULTI-VOL RACF
YRS      EQU   C'S'                     S = DEF. SINGLE-VOL RACF
*                                       X'0' = NO RECOVERY (ALL O.K.)
DSFLGS   DS    XL1                 DATA-SET ACTION FLAGS
ZFADD    EQU   X'01'                    ADD RACF ALTER
ZFCHG    EQU   X'02'                    CHANGE RACF TO ALTER
ZFTNU    EQU   X'04'                    TRUE NAME USED BY RACF
         DS    XL1                 RESERVED
DSANME   DS    CL44                DATA-SET TRUE NAME (ALIAS)
         SPACE 1
DSTABL   EQU   *-DSTABDS           DSNAME TABLE ENTRY LENGTH
         EJECT
DDNT     DSECT                     DDNAME'S TABLE DESCRIPTION
         SPACE 1
DDNNME   DS    0CL8,CL2            DDNAME (FORM : 'VT'+VOLSER)
DDNVOL   DS    CL6                 VOLSER
DDNDTY   DS    XL4                 DEVICE TYPE
DDNALL   DS    XL1                 INDICATORS
DDNXA    EQU   X'01'                    DD IS ALLOCATED
DDNXQ    EQU   X'02'                    VTOCQ IS OPENED
DDNXD    EQU   X'04'                    VTOCD IS OPENED
DDNCT    EQU   X'10'                    VOLUME CONTAIN AN O.S. CATALOG
DDNCI    EQU   X'20'                    VOLUME CONTAIN AN ICF CATALOG
DDNLUT   DS    XL1                 LENGTH OF UNIT TYPE
DDNUTY   DS    CL8                 UNIT TYPE
         SPACE 1
DDNL     EQU   *-DDNT              DDNAME TABLE ENTRY LENGTH
         SPACE 2
CVLT     DSECT                     CAT. VOL. TABLE DESCRIPTION
         SPACE 1
CVLVOL   DS    CL6                 VOLSER
CVLNME   DS    CL44                DATA-SET NAME
CVLIND   DS    XL1                 INDICATORS
CVLICF   EQU   X'01'                    OFF = O.S. CATALOG TYPE
*                                       ON = ICF CATALOG TYPE
CVLCSO   EQU   X'02'                    OFF = CATALOG IS CLOSED
*                                       ON = CATALOG IS OPENED
CVLMIS   EQU   X'10'                    CATALOG VOLUME MISSING
CVLCTP   EQU   X'20'                    VOLUME CONTAIN THE CATALOG
CVLPWL   DS    XL1                 MASTER PASSWORD LENGTH-1
CVLPW    DS    CL8                 MASTER PASSWORD
         SPACE 1
CVLL     EQU   *-CVLT              CAT. VOL. TABLE ENTRY LENGTH
         EJECT
CVPDS    DSECT           CVOL POINTER ELEMENT DESCRIPTION. -----------
         SPACE 1
CVPNAME  DS    CL8       CVOL POINTER NAME
CVPVOL   DS    CL6       VOLUME ID POINTED
CVPFL    DS    XL1       FLAGS
CVPOS    EQU   X'01'               O.S. CVOL POINTER
CVPICF   EQU   X'02'               ICF ALIAS NAME
CVPLOC   EQU   X'04'               BY LOCATE
CVPRACF  EQU   X'08'               RACF USER-ID
         SPACE 1
CVPL     EQU   *-CVPDS             CVOL POINTER TABLE ENTRY LENGTH
         SPACE 2
         AIF   ('&M' EQ 'MAIN').F
        $DYNLIST R=NO
         AGO   .G
.F      $DYNLIST L=NO,R=NO
.G       EJECT
*        COMPUTE ARRAYS SPACES.
         SPACE 1
TBEVOLL  EQU   L'UCBVOLI+1         EL. VOL. ENTRY LENGTH
SPEV     EQU   (((TBEVOLL*(NEV+1))+7)/8)*8   EL. VOL. TABLE SPACE
SPCV     EQU   (((CVLL*(NCV+1))+7)/8)*8      CAT. VOL. TABLE SPACE
TBNVOLL  EQU   L'UCBVOLI+1         N-CAT. VOL. ENTRY LENGTH
SPCN     EQU   (((TBNVOLL*(NNC+1))+7)/8)*8   N-CAT. VOL. TABLE SPACE
SPGV     EQU   (((CVPL*(NGV+1))+7)/8)*8      CVOL PTR. TABLE SPACE
TBDVOLL  EQU   L'UCBVOLI           NOT-DECLARED VOLUME ENTRY LENGTH
SPDV     EQU   (((TBDVOLL*(NDV+1))+7)/8)*8   NOT-D. VOL. TABLE SPACE
SPDD     EQU   (((DDNL*(NDD+1))+7)/8)*8      DDNAME'S TABLE SPACE
NIXL     EQU   0+L'DSNME+L'DDNVOL  NULL INDEX ENTRY LENGTH
SPNX     EQU   ((((NIXL)*(NIX*1))+7)/8)*8    NULL INDEXES TABLE SPACE
SPSK     EQU   (NSK+1)*8           SKIP NAMES TABLE SPACE
SPDS     EQU   (((DSTABL*(NRE+1))+7)/8)*8    DSNAME'S TABLE SPACE
NBRL     EQU   5+L'DSNME           BYPASS RACF TABLE ENTRY LENGTH
SPNB     EQU   ((((NBRL)*(NBR+1))+7)/8)*8    BYPASS RACF SPACE
SPAV     EQU   SPEV                ACC. VOL. TABLE SPACE
NGDL     EQU   12                  HLQ NAME ENTRY LENGTH
SPGD     EQU   ((((NGDL)*(NGD+1))+7)/8)*8    HLQ NAMES TABLE SPACE
NVRL     EQU   1+L'DSNME           GEN. NAME ENTRY LENGTH
SPVR     EQU   ((((NVRL)*(NVG+1))+7)/8)*8    GEN. NAMES SPACE
NW1L     EQU   ((NW1+7)/8)*8       1ST RACF WORK AREA SPACE
NW2L     EQU   ((NW2+7)/8)*8       2ND RACF WORK AREA SPACE
SPDA     EQU   DYNLGTH*DALLN       DYNAMIC ALLOCATIONS SPACE
         SPACE 2
*        TOTAL ARRAYS SPACE.
         SPACE 1
SPTOT@1  EQU   SPEV+SPCV+SPCN+SPGV+SPDV+SPDD+SPNX+SPSK+SPDS+SPNB
SPTOT    EQU   SPTOT@1+SPAV+SPGD+SPVR+NW1L+NW2L+SPDA
         SPACE 2
NWIL     EQU   (NWI*80)+8          IDCAMS SINGLE ARRAY SPACE LENGTH
         SPACE 1
ON       EQU   X'F0'               SET BRANCH
OFF      EQU   X'0F'               SET NO-OPERATION
FMON     EQU   X'FF'               FULL FINAL MARKER
FMOFF    EQU   X'00'               NULL FINAL MARKER
         SPACE 2
*       IHAACEE - IEFUCBOB(UCBDSECT)
         AIF   ('&M' EQ 'SERVICES').H
        PRINT  NOGEN
.H      IHAACEE
UCBDSECT DSECT
        IEFUCBOB
         MEND
         MACRO
&NAME   @COPY  &LINE,&SPCNA,&UNDL
         AIF   ('&LINE' NE '').A
         MNOTE 8,' OPERAND MISSING **********************************'
         MEXIT
.A       AIF   ('&LINE'(1,1) NE '(').B
         AIF   ('&LINE' EQ '(1)').E
         AIF   ('&LINE' EQ '(R1)').E
&NAME    LR    R1,&LINE(1)
         AGO   .C
.B       ANOP
&NAME    LA    R1,&LINE
.C       AIF   ('&SPCNA' EQ '').D
         LA    R15,&SPCNA
         AGO   .G
.D       XR    R15,R15
         AGO   .G
.E       AIF   ('&SPCNA' EQ '').F
&NAME    LA    R15,&SPCNA
         AGO   .G
.F       ANOP
&NAME    XR    R15,R15
.G       AIF   ('&UNDL' EQ 'U').H
         BAS   R14,COPY
         MEXIT
.H       BAS   R14,COPYU
         MEND
         MACRO
        @DOC   &DUMMY
         EJECT
* CALL OF THE PROGRAM :
* ---------------------
*
*        //MAINT  EXEC PGM=CLEAN,PARM=...
*        //SYSCMD   DD ... OPTIONAL COMMANDS CARDS ...
*        //SYSIN    DD ... CONTROL CARDS ...
*        //SYSPRINT DD SYSOUT=A    (ACTION LIST)
*        //SYSLIST  DD SYSOUT=A    (DETAIL LIST)
*        //SYSSNAP  DD SYSOUT=A    (OPTIONAL SNAP REQUESTS)
*
* EXEC PARM. FIELD DESCRIPTION : A COMMA MUST SEPARATE THE REQUESTS.
* ------------------------------
*
*        T OR TEST : NORMAL RUN, BUT FORCE ALL MODIFICATIONS TO
*              VTOC'S, CATALOGS AND RACF TO BE BYPASSED, SUPPRESS
*              THE HEADER AND TRAILER PAGE PRINT, AND, WHEN AN
*              ERROR IS DETECTED, ABENDS (U0033) WITH DUMP ('SYSUDUMP'
*              OR 'SYSABEND' DD-CARD IS NEEDED).
*
*        C OR CHECK : REDUCED RUN, IT ALLOWS THE INPUT DATA TO BE
*              SCANNED ONLY (SYNTAX CHECKER), AND SUPPRESS THE HEADER
*              AND TRAILER PAGE PRINT. USING THIS KEYWORD, THE 'TEST'
*              (UNLESS DUMP DESIRED) AND 'SKIP' OPTIONS ARE NOT NEEDED
*              (IF CODED, THEY ARE JUST SCANNED).
*
* COMMANDS CARDS : OPTIONAL (SYSCMD DD-CARD).
* ================
*
*    PROCESSED BY : "A003".
*
*    CODING RULES :
*              COLUMNS 1 TO 72 OF CARDS CAN BE USED FOR OPERATORS
*              COMMANDS CODING, NO FIXED COLUMNS NOR CONTINUATION
*              ARE PROVIDED, AND AN ASTERISK (*) IN COLUMN 1 IS
*              INTERPRETED AS A COMMENT CARD IN THE INPUT STREAM.
*
* CONTROL CARDS :
* ===============
*
*        THE CONTROL CARDS MUST BE GIVEN BY GROUP IN THE SAME ORDER
*        AS THEY ARE DESCRIBED BELOW, EACH GROUP STARTING ALWAYS ON
*        A NEW CARD. NO COMMENT CARDS ARE PROVIDED.
         EJECT
* 1. OPTIONS SELECTION : OPTIONAL.
* ----------------------
*
*    PROCESSED BY : "B001".
*
*    CODING RULES :
*              KEYWORDS AND EVENTUAL ARGUMENTS ARE ACCEPTED ANYWHERE
*              FROM COLUMN 1 UP TO COLUMN 72 INCLUDED. THEY MUST BE
*              SEPARATED EACH FROM THE OTHER BY AT LEAST ONE BLANK AND
*              THEY CAN BE IN ANY ORDER (THE LAST ONE IS IN EFFECT IF
*              THERE IS SOME KEYWORDS CONFLICT).
*
*    KEYWORDS :
*        - LISTALL
*              COMPLETE DETAIL LIST ('SYSLIST') REQUEST. ALL THE
*              CATALOGS ENTRIES, THE DATA-SETS STATUS AND THE RACF
*              USER'S/DATA-SETS ACCESSES, GROUP'S/DATA-SETS ACCESSES
*              ARE LISTED.
*
*        - DS-SHORT
*              ONLY THE STATUS OF DATA-SETS WITH ACTIONS SCHEDULED ARE
*              LISTED ('SYSLIST').
*              NOTE : THIS IS THE DEFAULT OPTION.
*
*        - DS-SHGDG
*              THE STATUS OF DATA-SETS WITH ACTIONS SCHEDULED AND THE
*              GDG'S INFORMATION ARE LISTED ('SYSLIST').
*
*        - DS-VSAM
*              THE STATUS OF DATA-SETS WITH ACTIONS SCHEDULED, THE
*              GDG'S AND ALL VSAM INFORMATION ARE LISTED ('SYSLIST').
*
*        - DS-SKOFF
*              SUPPRESS THE LIST ('SYSLIST') OF ALL REFERENCES TO
*              UNPROCESSED VOLUMES.
*
*        - CT-SHORT
*              SUPPRESS THE LIST ('SYSLIST') OF THE CATALOGS DSNAME'S
*              AND O.S. CVOL POINTERS ENTRIES.
*              NOTE : THIS IS THE DEFAULT OPTION.
*
*        - NL-USERS ( ... ... )
*              SUPPRESS THE LIST ('SYSLIST') OF THE RACF USER'S/DATA-
*              SETS ACCESSES PROFILES, UNLESS THE ACTUAL DAY NAME
*              MATCHES ONE SPECIFIED IN THE EVENTUAL FOLLOWING LIST
*              ( ... ... ). VALUE(S) WHERE ... MAY BE : MON, TUE,
*              WED, THU, FRI, SAT AND SUN.
*
*        - NL-GROUPS ( ... ... )
*              SUPPRESS THE LIST ('SYSLIST') OF THE RACF GROUP'S/
*              DATA-SETS ACCESSES PROFILES, UNLESS THE ACTUAL DAY
*              NAME MATCHES ONE SPECIFIED IN THE EVENTUAL FOLLOWING
*              LIST ( ... ... ). VALUE(S) WHERE ... MAY BE : MON,
*              TUE, WED, THU, FRI, SAT AND SUN.
         EJECT
*        - COPY ( ...DATA-SET NAME... )
*        - COPY ( ...DATA-SET NAME... / ...START COMMAND... )
*              GENERATE A COPY OF THE RACF USER'S/DATA-SETS ACCESSES
*              AND THE RACF GROUP'S/DATA-SETS ACCESSES ('SYSLIST')
*              IN A NEW DATA-SET AUTOMATICALLY CREATED WITH THE
*              SPECIFIED NAME. SEPARATED BY A SLASH (/), AN EVENTUAL
*              START COMMAND MAY BE GIVEN, WHICH WILL BE INTERNALLY
*              ISSUED AT THE END (THIS ALLOWS THE START OF ANOTHER JOB
*              TO HANDLE THE COPY DATA-SET).
*              NOTE : THIS OPTION IS UNDER THE CONTROL OF 'NOLIST',
*                     'NL-USERS' AND 'NL-GROUPS' OPTIONS.
*              CODING RULES : THE DATA-SET NAME AND THE START COMMAND
*                     MAY BE SPECIFIED ON SEPARATE CARDS, BUT EACH MUST
*                     BE COMPLETE WITHIN THE 72 COLUMNS RANGE.
*
*        - COPYVOL ( ... )
*              VOLUME SERIAL NUMBER WHERE THE COPY DATA-SET WILL BE
*              ALLOCATED.
*
*        - NOLIST
*              SUPPRESS THE DETAIL LIST ('SYSLIST').
*
*        - NOACCOUNT
*              SUPPRESS THE ACCOUNTING PROCESSING.
*
*        - NOSCRATCH
*              NORMAL RUN, BUT BYPASS THE SCRATCH OF DATA-SETS
*              (CATALOG , RACF AND VTOC ACTIONS ARE EXECUTED).
*
*        - NOCATALOG
*              NORMAL RUN, BUT BYPASS ANY CATALOG CHANGE (DATA-SET,
*              RACF AND VTOC ACTIONS ARE EXECUTED).
*
*        - NORACF
*              NORMAL RUN, BUT BYPASS ANY RACF PROFILES CHANGE
*              (DATA-SET, CATALOG AND VTOC ACTIONS ARE EXECUTED).
*
*        - NOSET
*              NORMAL RUN, BUT BYPASS ANY VTOC'S CHANGE (DATA-SET,
*              CATALOG AND RACF ACTIONS ARE EXECUTED).
*
*        - ONLY
*              FORCE THE ANALYSIS OF ONLY THOSE VOLUMES SPECIFIED
*              AS ELIGIBLE (SEE EL.VOL.).
         EJECT
*        - TIME
*              PRINT THE TIME-OF-DAY AT START OF MODULE'S (PROCESS)
*              EXECUTION (SEE MACRO @XS).
*
*        - CHECK
*              REDUCED RUN ALLOWING THE INPUT DATA TO BE SCANNED
*              ONLY (SYNTAX CHECKER). USING THIS OPTION, THE 'TEST'
*              (UNLESS DUMP DESIRED) AND 'SKIP' OPTIONS ARE NOT NEEDED
*              (IF CODED, THEY ARE JUST SCANNED).
*
*        - TEST
*              NORMAL RUN, BUT FORCE ALL MODIFICATIONS TO VTOC'S,
*              CATALOGS AND RACF TO BE BYPASSED, AND, WHEN AN ERROR
*              IS DETECTED, ABENDS (U0033) WITH DUMP ('SYSUDUMP' OR
*              'SYSABEND' DD-CARD IS NEEDED).
*
*        - SNAP ( ... )
*              SNAP REQUESTS LIST, WHERE ... INDICATES AT WHICH
*              PROCESSING POINT AND MAY BE :
*                  TWA : AT TABLES ADDRESSES AND LENGTHS (A001).
*                  RRD : AT RACF/DS DEFINITIONS (A007).
*                  LOC : AT LOCATE OF DSNAME (A008).
*                  OBT : AT OBTAIN OF DSNAME (A008).
*                  RUS : AT RACF/USR PROCESSING (A014).
*                  RDS : AT RACF/DS-USR PROCESSING (B007).
*                  RGR : AT RACF/GRP PROCESSING (A015).
*                  RCO : AT RACF/CON PROCESSING (B006).
*                  GDS : AT RACF/DS-GRP PROCESSING (B008).
*                  RRO : AT RACF/DS OWNER DEFINITIONS (A007).
*                  RAE : AT RACF/DS OWNER ALTER ERROR (A007).
*                  GCV : AT LOCATE CATALOG VOLUME (B005).
*                  ECV : AT LOCATE CATALOG VOLUME NOT FOUND (B005).
*                  SCR : AT SCRATCH DATA-SET - RACF ACCESS (A013).
*                  INX : AT LOCATE MAIN INDEX (A010).
*                  DBG : ALL ARRAYS ON ERROR (MAIN)
*              NOTE : 'SYSSNAP' DD-CARD IS NEEDED.
         EJECT
*        - NEV .. NCV .. NNC .. NGV .. NDV .. NDD .. NIX .. NSK ..
*          NRE .. NW1 .. NW2 .. NBR .. NWI .. :
*              WHERE .. IS A NUMBER (FROM 1 TO 5 DIGITS) WHICH ALLOWS
*              DYNAMIC CHANGE OF THE DEFAULT VALUES ASSIGNED TO THE
*              CORRESPONDING ASSEMBLY VARIABLES (SEE BELOW).
         SPACE 1
        #DEFSZ
         EJECT
* 2. SKIP PROCESSING REQUESTS : OPTIONAL.
* -----------------------------
*
*    PROCESSED BY : "A002".
*
*    KEYWORD :
*        - SKIP ( XXXXXX XXXXXX ... )
*              WHERE XXXXXX ARE NAMES OF MODULES (@X CALL FEATURE)
*              WHICH EXECUTION IS TO BE BYPASSED.
*              NOTE : - BE CAREFULL WHEN USING THIS OPTION,
*                       UNPREDICTABLE RESULTS MAY OCCURS (LIKE
*                       CONTROL CARDS ORDER MISPLACED).
*
*    CODING RULES :
*              THE MODULES NAMES ARE ACCEPTED ANYWHERE FROM COLUMN
*              1 UP TO COLUMN 72 INCLUDED. THEY MUST BE SEPARATED
*              EACH FROM THE OTHER BY AT LEAST ONE BLANK, AND MAY BE
*              FROM 1 TO 8 CHARACTERS LONG. A NAME MUST BE ALWAYS
*              COMPLETE WITHIN THE 72 COLUMNS RANGE.
         EJECT
* 3. BYPASS ANY RACF PROCESS : OPTIONAL.
* ----------------------------
*
*    PROCESSED BY : "A002".
*
*    PURPOSE : EVENTUALLY ADD ALTER ACCESS FOR OWNER IN THE D.M.S.
*              ARCHIVED DATA-SETS PROFILES IN ORDER TO ALLOW THE
*              USERS "DRESTORE" REQUESTS SUCCESSFULLY COMPLETE.
*
*    KEYWORD :
*        - BYPRACF ( XXXXXX / NOLIST  XXXXXX / N
*                    XXXXXX / SKIP  XXXXXX / S  XXXXXX  ... )
*              WHERE XXXXXX ARE DATA-SETS NAMES PREFIXES FOR WHICH THE
*              NORMAL RACF PROCESSING IS TO BE REPLACED BY AN EVENTUAL
*              ADD ALTER ACCESS OF OWNER IN THE DATA-SET'S ACCESS LIST
*              PROFILES.
*              OPTIONALLY, MAY BE SPECIFIED AFTER A PREFIX :
*                   - '/NOLIST' OR '/N' TO SUPPRESS THESE ACTIONS BE
*                     SIGNAL ON THE STANDARD OUTPUT LIST.
*                   - '/SKIP' OR '/S' TO SKIP THE RACF PROCESSING
*                     RELATIVE TO IT.
*              I.E. : BYPRACF ( DMS. )
*                     WILL APPLY THE ALTERNATE PROCESS TO THE DATA-
*                     SETS PROFILES HAVING THE NAME STARTING BY THE
*                     PREFIX "DMS.".
*
*    CODING RULES :
*              THE DATA-SETS NAMES PREFIXES ARE ACCEPTED ANYWHERE
*              FROM COLUMN 1 UP TO COLUMN 72 INCLUDED. THEY MUST BE
*              SEPARATED EACH FROM THE OTHER BY AT LEAST ONE BLANK
*              (MAXIMUM IS 44 CHARACTERS LONG). A NAME MUST BE ALWAYS
*              COMPLETE WITHIN THE 72 COLUMNS RANGE.
         EJECT
* 4. ACCOUNT REQUESTS : OPTIONAL.
* ---------------------
*
*    PROCESSED BY : "A002".
*
*    KEYWORD :
*        - ACCOUNT ( Y... / ZZZ ZZZ ... ) OR
*        - ACCOUNT ( / ZZZ ZZZ ... ) OR
*        - ACCOUNT * :
*              WHERE ZZZ ARE MEMBER NAMES OF THE CATALOGED PARTITIONED
*              DATA-SET Y... WHICH WILL CONTAIN THE DESIRED ACCOUNTING
*              REQUIREMENTS CONTROL STATEMENTS. IF Y... IS OMITTED,
*              THE PREVIOUS DATA-SET NAME IS USED.
*              THE USE OF 'ACCOUNT *' FORM ASSUMES THAT THE ACCOUNTING
*              REQUIREMENTS CONTROL STATEMENTS CODING FOLLOWS IN THE
*              CURRENT INPUT-STREAM. THE END OF THESE REQUIREMENTS IS
*              DETECTED BY ANOTHER 'ACCOUNT' KEYWORD OR THE 'EL.VOL.'
*              NEXT MANDATORY GROUP KEYWORD IN A NEW CONTROL CARD.
*
*    CODING RULES :
*              THE MEMBER NAME MAY BE FROM 1 TO 8 CHARACTERS LONG, AND
*              MUST BE ALWAYS COMPLETE WITHIN THE 72 COLUMNS RANGE.
         EJECT
*        ACCOUNTING REQUIREMENTS CONTROL STATEMENTS :
*        --------------------------------------------
*
*    CODING RULES :
*
*        THE REQUEST STATEMENTS ARE FREE FORMAT, THEY MAY START
*        ANYWHERE FROM COLUMN 1 UP TO COLUMN 72 INCLUDED OF THE
*        CARDS, AND A CARD MAY CONTAIN MORE THAN ONE STATEMENT.
*        EACH STATEMENT IS COMPOSED OF A COMMAND AND EVENTUALLY
*        OPERANDS AS DESCRIBED IN COMMANDS, AND MUST BE ALWAYS
*        COMPLETE WITHIN THE 72 COLUMNS RANGE, THUS NO CONTINUATION
*        IS PROVIDED, BUT A COMMAND MAY BE REPEATED TO SUPPLY ALL
*        REQUIREMENTS. AT LEAST ONE BLANK MUST SEPARATE STATEMENTS,
*        COMMANDS AND OPERANDS.
*
*    COMMANDS :
*
*        VOLUME ( ... ... ... )      : DECLARE ALL THE VOLUME SERIAL
*        V                             NUMBERS FOR ACCOUNT PROCESSING.
*                                      THE VOLUME SERIAL NUMBERS MAY
*                                      BE FROM 1 TO 6 CHARACTERS LONG
*                                      (WHEN SHORTER THAN 6 CHARACTERS
*                                      IT MEANS A GROUP OF VOLUMES,
*                                      WHICH SERIAL NUMBERS OBVIOUSLY
*                                      START BY THIS PREFIX).
*
*        JUMP ( ... ... ... )        : BYPASS ACCOUNTING PROCESSING AT
*        J                             PREDETERMINED DAYS. THE DAY'S
*                                      LIST IS ACCPETED BY DATE DDMMYY
*                                      OR BY DAY NAME ('MON', 'TUE',
*                                      'WED' 'THU', 'FRI', 'SAT' AND
*                                      'SUN').
*
*        LIST                        : ACCOUNTING PROCESSING DATA-SETS
*        L                             FULL LIST ('SYSLIST'). THIS IS
*                                      ALSO FORCED BY 'LISTALL' OPTION.
*
*        ACCVOL ( ... )              : VOLUME SERIAL NUMBER WHERE THE
*        A                             DAY-ACCOUNTING DATA-SET WILL
*                                      BE ALLOCATED.
*
*        PREFIX ( ... )              : DS-NAME FIRST LEVEL INDEX TO
*        P                             USE FOR THE DAY-ACCOUNTING
*                                      DATA-SET.
         EJECT
* 5. ELIGIBLE VOLUMES NAMES : MANDATORY.
* ---------------------------
*
*    PROCESSED BY : "A003".
*
*    KEYWORD :
*        - EL.VOL. ( XXXXXX XXXXXX ... )
*              WHERE XXXXXX ARE VOLUME SERIAL NUMBER NAMES OF THE
*              DISKS TO BE ANALYZED.
*
*    CODING RULES :
*              THE VOLUME SERIAL NUMBER NAMES ARE ACCEPTED ANYWHERE
*              FROM COLUMN 1 UP TO COLUMN 72 INCLUDED. THEY MUST BE
*              SEPARATED EACH FROM THE OTHER BY AT LEAST ONE BLANK,
*              AND MAY BE FROM 1 TO 6 CHARACTERS LONG (WHEN SHORTER
*              THAN 6 CHARACTERS IT MEANS A GROUP OF VOLUME SERIAL
*              NUMBERS, OBVIOUSLY STARTING BY THIS PREFIX). A NAME
*              MUST BE ALWAYS COMPLETE WITHIN THE 72 COLUMNS RANGE.
         EJECT
* 6. CATALOGS VOLUMES NAMES : MANDATORY.
* ---------------------------
*
*    PROCESSED BY : "A003".
*
*    KEYWORD :
*        - CAT.VOL. ( XXXXXX XXXXXX ...
*                     XXXXXX / Y... XXXXXX / Y... ... )
*              WHERE XXXXXX IS THE FORM TO INDICATE THE VOLUME SERIAL
*              NUMBER NAMES OF THE DISKS CONTAINING AN O.S. CATALOG
*              (DATA-SET NAME IS 'SYSCTLG', THUS KNOWN), AND XXXXXX /
*              Y... IS THE FORM TO INDICATE THE VOLUME SERIAL NUMBER
*              NAMES OF THE DISKS CONTAINING AN ICF CATALOG (DATA-SET
*              NAME IS Y...).
*
*    CODING RULES :
*              THE VOLUME SERIAL NUMBER NAMES ARE ACCEPTED ANYWHERE
*              FROM COLUMN 1 UP TO COLUMN 72 INCLUDED. THEY MUST BE
*              SEPARATED EACH FROM THE OTHER BY AT LEAST ONE BLANK,
*              AND MUST BE 6 CHARACTERS LONG. A DATA-SET NAME IS 44
*              CHARACTERS LONG AT MAXIMUM. A NAME, EVENTUALLY FOLLOWED
*              BY A DATA-SET NAME (ICF), MUST BE ALWAYS COMPLETE
*              WITHIN THE 72 COLUMNS RANGE.
         EJECT
* 7. NO-LOCATE REQUESTS : OPTIONAL.
* -----------------------
*
*    PROCESSED BY : "A008".
*
*    KEYWORD :
*        - N-LOC.VOL. ( Y... / XXXXXX XXXXXX ... ) OR
*        - N-LOC.VOL. ( / XXXXXX XXXXXX ... ) OR
*        - N-LOC.VOL. ( * XXXXXX ... ... ... ) :
*              WHERE XXXXXX ARE VOLUME SERIAL NUMBER NAMES ALSO USED
*              AS MEMBER NAMES (PREFIXED BY THE CHARACTER L : LXXXXXX)
*              OF THE CATALOGED PARTITIONED DATA-SET Y... WHICH WILL
*              CONTAIN THE DATA-SET NAMES FOR WHICH THE EVENTUAL
*              LOCATE IS TO BE SKIPED WHEN THE SPECIFIED VOLUME IS
*              NOT ON-LINE (THESE DATA-SETS ARE MARKED AS EXEMPTED).
*              IF Y... IS OMITTED, THE PREVIOUS DATA-SET NAME IS USED.
*              THE ASTERISK (*) FORM ASSUMES THE DATA-SET NAMES FOLLOW
*              THE VOLUME SERIAL NUMBER NAME (XXXXXX) IN THE CURRENT
*              INPUT-STREAM. THE MEMBER OR INPUT-STREAM MAY CONTAIN
*              COMPLETE OR GENERIC DATA-SET NAMES, SPECIFIED AS BELOW :
*                   1) AAAA.BBBB.CCCC : AN EVENTUAL LOCATE OF THIS
*                                       DATA-SET IS BYPASSED.
*                   2) AAAA./ : AN EVENTUAL LOCATE OF ANY DATA-SETS
*                               STARTING WITH THE PREFIX "AAAA." IS
*                               BYPASSED.
*                   THE DATA-SETS NAMES OR PREFIXES MUST BE SEPARATED
*                   EACH FROM THE OTHER BY AT LEAST ONE BLANK (MAXIMUM
*                   IS 44 CHARACTERS LONG), AND THEY MUST BE ALWAYS
*                   COMPLETE WITHIN THE 72 COLUMNS RANGE.
*              THE PURPOSE IS TO SKIP THE MOUNT REQUEST OF A VOLUME
*              CONTAINING A VSAM-CATALOG WHICH IS NEEDED TO LOCATE
*              DATA-SETS RESIDING ON ANALYZED VOLUMES (ELIGIBLES).
*
*    CODING RULES :
*              THE VOLUME SERIAL NUMBER NAMES ARE ACCEPTED ANYWHERE
*              FROM COLUMN 1 UP TO COLUMN 72 INCLUDED. THEY MUST BE
*              SEPARATED EACH FROM THE OTHER BY AT LEAST ONE BLANK,
*              AND MUST BE 6 CHARACTERS LONG. A NAME MUST BE ALWAYS
*              COMPLETE WITHIN THE 72 COLUMNS RANGE.
         EJECT
* 8. SCRATCH NOT-CATALOGED DATA-SETS ON VOLUMES NAMES : OPTIONAL.
* -----------------------------------------------------
*
*    PROCESSED BY : "A009".
*
*    KEYWORD :
*        - N-CAT.VOL. ( XXXXXX XXXXXX ... )
*              WHERE XXXXXX ARE VOLUME SERIAL NUMBER NAMES OF THE
*              DISKS WHERE ANY NOT-CATALOGED DATA-SET IS TO BE
*              SCRATCHED.
*
*    CODING RULES :
*              THE VOLUME SERIAL NUMBER NAMES ARE ACCEPTED ANYWHERE
*              FROM COLUMN 1 UP TO COLUMN 72 INCLUDED. THEY MUST BE
*              SEPARATED EACH FROM THE OTHER BY AT LEAST ONE BLANK,
*              AND MAY BE FROM 1 TO 6 CHARACTERS LONG (WHEN SHORTER
*              THAN 6 CHARACTERS IT MEANS A GROUP OF VOLUME SERIAL
*              NUMBERS, OBVIOUSLY STARTING BY THIS PREFIX). A NAME
*              MUST BE ALWAYS COMPLETE WITHIN THE 72 COLUMNS RANGE.
         EJECT
* 9. SPECIAL REQUESTS : OPTIONAL.
* ---------------------
*
*    PROCESSED BY : "A009".
*
*    KEYWORDS :
*        - SCRATCH ( XXXXXX XXXXXX ... ) :
*              WHERE XXXXXX ARE VOLUME SERIAL NUMBER NAMES OF THE DISKS
*              TO FULLY SCRATCH, DELETE CATALOG AND RACF REFERENCES.
*              NOTE : SCRATCH OF AN OFF-LINE DISK MEANS DELETE ALL THE
*                     CATALOG AND RACF REFERENCES TO THIS VOLUME SERIAL
*                     NUMBER.
*
*        - EXEMPT ( Y... / XXXXXX XXXXXX ... ) OR
*        - EXEMPT ( / XXXXXX XXXXXX ... ) OR
*        - EXEMPT ( * XXXXXX ... ... ... ) :
*              WHERE XXXXXX ARE VOLUME SERIAL NUMBER NAMES ALSO USED
*              AS MEMBER NAMES (PREFIXED BY THE CHARACTER E : EXXXXXX)
*              OF THE CATALOGED PARTITIONED DATA-SET Y... WHICH WILL
*              CONTAIN THE DATA-SET NAMES FOR WHICH ANY ACTION IS TO
*              BE SKIPED (THIS APPLY ONLY ON THE SPECIFIED VOLUME).
*              IF Y... IS OMITTED, THE PREVIOUS DATA-SET NAME IS USED.
*              THE ASTERISK (*) FORM ASSUMES THE DATA-SET NAMES FOLLOW
*              THE VOLUME SERIAL NUMBER NAME (XXXXXX) IN THE CURRENT
*              INPUT-STREAM. THE MEMBER OR INPUT-STREAM MAY CONTAIN
*              COMPLETE OR GENERIC DATA-SET NAMES, SPECIFIED AS BELOW :
*                   1) AAAA.BBBB.CCCC : ANY ACTION ON THIS DATA-SET IS
*                                       BYPASSED.
*                   2) AAAA./ : ANY ACTIONS ON DATA-SETS STARTING WITH
*                               THE PREFIX "AAAA." ARE BYPASSED.
*                   THE DATA-SETS NAMES OR PREFIXES MUST BE SEPARATED
*                   EACH FROM THE OTHER BY AT LEAST ONE BLANK (MAXIMUM
*                   IS 44 CHARACTERS LONG), AND THEY MUST BE ALWAYS
*                   COMPLETE WITHIN THE 72 COLUMNS RANGE.
*              AN EXEMPT REQUEST OVERRIDES ALWAYS A SCRATCH REQUEST.
*
*    CODING RULES :
*              THE VOLUME SERIAL NUMBER NAMES ARE ACCEPTED ANYWHERE
*              FROM COLUMN 1 UP TO COLUMN 72 INCLUDED. THEY MUST BE
*              SEPARATED EACH FROM THE OTHER BY AT LEAST ONE BLANK,
*              AND MAY BE FROM 1 TO 6 CHARACTERS LONG (WHEN SHORTER
*              THAN 6 CHARACTERS IT MEANS A GROUP OF VOLUME SERIAL
*              NUMBERS, OBVIOUSLY STARTING BY THIS PREFIX). A NAME
*              MUST BE ALWAYS COMPLETE WITHIN THE 72 COLUMNS RANGE.
         MEND
         MACRO
&NAME   @FILL  &WHERE,&LGTH
         AIF   ('&LGTH' EQ '').A
&NAME    LA    R0,0+((L'&LGTH-2)/2)
         LA    R1,&WHERE+L'&LGTH-2
         AGO   .B
.A       ANOP
&NAME    LA    R0,0+((L'&WHERE-2)/2)
         LA    R1,&WHERE+L'&WHERE-2
.B       BAS   R14,FILL
         MEND
         MACRO
&NAME   @LIST  &LINE,&SPCNA,&UNDL
         AIF   ('&LINE' NE '').A
         MNOTE 8,' OPERAND MISSING **********************************'
         MEXIT
.A       AIF   ('&LINE'(1,1) NE '(').B
         AIF   ('&LINE' EQ '(1)').E
         AIF   ('&LINE' EQ '(R1)').E
&NAME    LR    R1,&LINE(1)
         AGO   .C
.B       ANOP
&NAME    LA    R1,&LINE
.C       AIF   ('&SPCNA' EQ '').D
         LA    R15,&SPCNA
         AGO   .G
.D       XR    R15,R15
         AGO   .G
.E       AIF   ('&SPCNA' EQ '').F
&NAME    LA    R15,&SPCNA
         AGO   .G
.F       ANOP
&NAME    XR    R15,R15
.G       AIF   ('&UNDL' EQ 'U').H
         BAS   R14,LIST
         MEXIT
.H       BAS   R14,LISTU
         MEND
         MACRO
&NAME   @OUT   &LINE,&SPCNA,&UNDL
         AIF   ('&LINE' NE '').A
         MNOTE 8,' OPERAND MISSING **********************************'
         MEXIT
.A       AIF   ('&LINE'(1,1) NE '(').B
         AIF   ('&LINE' EQ '(1)').E
         AIF   ('&LINE' EQ '(R1)').E
&NAME    LR    R1,&LINE(1)
         AGO   .C
.B       ANOP
&NAME    LA    R1,&LINE
.C       AIF   ('&SPCNA' EQ '').D
         LA    R15,&SPCNA
         AGO   .G
.D       XR    R15,R15
         AGO   .G
.E       AIF   ('&SPCNA' EQ '').F
&NAME    LA    R15,&SPCNA
         AGO   .G
.F       ANOP
&NAME    XR    R15,R15
.G       AIF   ('&UNDL' EQ 'U').H
         BAS   R14,OUT
         MEXIT
.H       BAS   R14,OUTU
         MEND
         MACRO
        @SERV  &M=
         AIF   ('&M' NE 'SERVICES').A
SERVICES START 0
        $HEDIT SERVICES
         USING *,R11
         USING COMMON,R10
         SPACE 1
        $DEFREG
         EJECT
         AGO   .B
.A       PRINT NOGEN
SERVICES DSECT
         SPACE 1
.B       ANOP
*        SERVICES VECTOR ACCESS.
         SPACE 1
         AIF   ('&M' NE 'SERVICES').C
MAINAB   B     *-*
MAINABE  B     *-*
SUBTLA   DC    A(*-*)              SUB-TITLE ADDRESS (SET BY USER)
         DC    A(MAXERR)           HIGHEST MESSAGE NO.
         DC    A(ERRTAB)           MESSAGES TABLE ADDRESS
         SPACE 1
         B     SKIPT     SKIP PROCESSING ROUTINE
         B     TIMET     TIME PROCESSING ROUTINE
         B     OUT       'SYSPRINT' OUTPUT ROUTINE
         B     OUTU      'SYSPRINT' OUTPUT ROUTINE
         B     LIST      'SYSLIST' OUTPUT ROUTINE
         B     LISTU     'SYSLIST' OUTPUT ROUTINE
         B     COPY      'SYSCOPY' OUTPUT ROUTINE
         B     COPYU     'SYSCOPY' OUTPUT ROUTINE
         B     FILL      FILL ROUTINE
         B     IDCIAR    IDCAMS INPUT ALLOCATION ROUTINE
         B     IDCOAR    IDCAMS OUTPUT ALLOCATION ROUTINE
         B     DYNFAIL   DYNAM FAIL ROUTINE
         B     XIDCAMS   EXECUTE IDCAMS ROUTINE
         B     8(,R14)   SNAPS ROUTINE SWITCH
         B     SNAPS     SNAPS ROUTINE
         B     DMPRTN    DUMP A BYTE ROUTINE
         B     DMPRTS    DUMP A BYTE ROUTINE
         B     AUDITF    AUDIT FLAG ANALYSIS ROUTINE
         AGO   .F
.C       AIF   ('&M' NE 'MAIN').D
ABADD    B     *-*
ABEADD   B     *-*
SUBTLA   DC    A(*-*)              SUB-TITLE ADDRESS (SET BY USER)
MAXERR   DC    A(*-*)              HIGHEST MESSAGE NO.
ERRTAB   DC    A(*-*)              MESSAGES TABLE ADDRESS
         AGO   .E
.D       B     *-*
         B     *-*
SUBTLA   DC    A(*-*)              SUB-TITLE ADDRESS (SET BY USER)
MAXERR   DC    A(*-*)              HIGHEST MESSAGE NO.
ERRTAB   DC    A(*-*)              MESSAGES TABLE ADDRESS
.E       SPACE 1
SKIPT    B     *-*       SKIP PROCESSING ROUTINE
TIMET    B     *-*       TIME PROCESSING ROUTINE
OUT      B     *-*       'SYSPRINT' OUTPUT ROUTINE
OUTU     B     *-*       'SYSPRINT' OUTPUT ROUTINE
LIST     B     *-*       'SYSLIST' OUTPUT ROUTINE
LISTU    B     *-*       'SYSLIST' OUTPUT ROUTINE
COPY     B     *-*       'SYSCOPY' OUTPUT ROUTINE
COPYU    B     *-*       'SYSCOPY' OUTPUT ROUTINE
FILL     B     *-*       FILL ROUTINE
IDCIAR   B     *-*       IDCAMS INPUT ALLOCATION ROUTINE
IDCOAR   B     *-*       IDCAMS OUTPUT ALLOCATION ROUTINE
DYNFAIL  B     *-*       DYNAM FAIL ROUTINE
XIDCAMS  B     *-*       EXECUTE IDCAMS ROUTINE
SNAPS    B     8(,R14)   SNAPS ROUTINE SWITCH
         B     *-*       SNAPS ROUTINE
DMPRTN   B     *-*       DUMP A BYTE ROUTINE
DMPRTS   B     *-*       DUMP A BYTE ROUTINE
AUDITF   B     *-*       AUDIT FLAG ANALYSIS ROUTINE
.F       EJECT
*        ERRORS EXIT.
         SPACE 1
ERR1     BCTR  R9,0      "GDATE" OR "SDATE" ERROR
ERR2     BCTR  R9,0      EL.VOL. (...) NOT FOUND OR SYNTAX ERROR
ERR3     BCTR  R9,0      EL. VOL. NAME .GT. 6 CHAR. LONG
ERR4     BCTR  R9,0      EL. VOL. TABLE OVERFLOW (NEV)
ERR5     BCTR  R9,0      EL. VOL. TABLE EMPTY
ERR6     BCTR  R9,0      CAT.VOL. (...) NOT FOUND OR SYNTAX ERROR
ERR7     BCTR  R9,0      CAT. VOL. NAME NOT 6 CHAR. LONG
ERR8     BCTR  R9,0      CAT. OR N-CAT. VOL. TABLE OVERFLOW (NCV)
ERR9     BCTR  R9,0      CAT. VOL. TABLE EMPTY
ERR10    BCTR  R9,0      "DARSCA" ERROR
ERR11    BCTR  R9,0      DDNAME'S TABLE OVERFLOW (NDD)
ERR12    BCTR  R9,0      "DAUNTY" ERROR
ERR13    BCTR  R9,0      DDNAME'S TABLE EMPTY
ERR14    BCTR  R9,0      "DAVALL" ERROR
ERR15    BCTR  R9,0      "VTOCQO" ERROR
ERR16    BCTR  R9,0      "VTOCQR" ERROR
ERR17    BCTR  R9,0      DSNAME'S TABLE OVERFLOW (NRE)
ERR18    BCTR  R9,0      "VTOCQC" ERROR
ERR19    BCTR  R9,0      "CATSR" UNEXPECTED CATALOG INDICATOR
ERR20    BCTR  R9,0      "ICHEINTY" (RACF READ) ERROR
ERR21    BCTR  R9,0      "READ" FROM 'SYSIN' ERROR
ERR22    BCTR  R9,0      CONTROL CARD ERROR
ERR23    BCTR  R9,0      "DYNALL" OR "MOPEN" OF 'SYSPDS' ERROR
ERR24    BCTR  R9,0      "MFIND" FROM 'SYSPDS' ERROR
ERR25    BCTR  R9,0      "MREAD" FROM 'SYSPDS' ERROR
ERR26    BCTR  R9,0      "MCLOSE" OR "DYNALL" OF 'SYSPDS' ERROR
ERR27    BCTR  R9,0      "VTOCDO" ERROR
ERR28    BCTR  R9,0      "VTOCDR" ERROR
ERR29    BCTR  R9,0      FMT1 DSCB DSNAME MATCH ERROR
ERR30    BCTR  R9,0      "VTOCDW" ERROR
ERR31    BCTR  R9,0      "VTOCDC" ERROR
ERR32    BCTR  R9,0      JOB-NAME ERROR (MISSING)
ERR33    BCTR  R9,0      LOCATE BY TTR ERROR
ERR34    BCTR  R9,0      "CATSO" ERROR
ERR35    BCTR  R9,0      "CATSR" ERROR
ERR36    BCTR  R9,0      "CATSC" ERROR
ERR37    BCTR  R9,0      PARM. FIELD SYNTAX ERROR
ERR38    BCTR  R9,0      "INSORT" ERROR
ERR39    BCTR  R9,0      "GETMAIN" ERROR - REGION SPACE TOO SMALL
ERR40    BCTR  R9,0      "READ" FROM 'SYSCMD' ERROR
ERR41    BCTR  R9,0      'EXEMPT' - DSNAME .GT. 44 CHAR. LONG
ERR42    BCTR  R9,0      STACK SAVE AREAS ERROR
ERR43    BCTR  R9,0      N-CAT.VOL. (...) SYNTAX ERROR
ERR44    BCTR  R9,0      N-CAT. VOL. NAME .GT. 6 CHAR. LONG
ERR45    BCTR  R9,0      "EDITH" ERROR
ERR46    BCTR  R9,0      COMPUTED SPACE VALUE TOO BIG
ERR47    BCTR  R9,0      "SNAP" ERROR
ERR48    BCTR  R9,0      SKIP MODULE NAME .GT. 8 CHAR. LONG
ERR49    BCTR  R9,0      SKIP MODULE NAMES TABLE OVERFLOW (NSK)
ERR50    BCTR  R9,0      NOT-DECLARED VOL. TABLE OVERFLOW (NDV)
ERR51    BCTR  R9,0      N-LOC.VOL. NAME NOT 6 CHAR. LONG
ERR52    BCTR  R9,0      N-LOC.VOL. - DSNAME .GT. 44 CHAR. LONG
ERR53    BCTR  R9,0      BYPASS RACF NAME .GT. 44 CHAR. LONG OR SYNTAX
ERR54    BCTR  R9,0      BYPASS RACF NAMES TABLE OVERFLOW (NBR)
ERR55    BCTR  R9,0      "ICFSO" ERROR
ERR56    BCTR  R9,0      "ICFSR" ERROR
ERR57    BCTR  R9,0      "ICFSC" ERROR
ERR58    BCTR  R9,0      CATALOG VOLUME NOT FOUND - LOGIC ERROR
ERR59    BCTR  R9,0      "ACCOUNT" - ACC. VOL. TABLE OVERFLOW (NEV)
ERR60    BCTR  R9,0      "DYNALL" OR "PUNCH" TO 'SYSDATA' ERROR
ERR61    BCTR  R9,0      COPY DSNAME MISSING OR .GT. 44 CHAR. LONG
ERR62    BCTR  R9,0      COPY START COMMAND TEXT ERROR OR TOO LONG
ERR63    BCTR  R9,0      UNEXPECTED DDNAME'S TABLE STATUS ERROR
ERR64    BCTR  R9,0      CVOL PTR. TABLE OVERFLOW (NGV)
ERR65    BCTR  R9,0      WRONG FIRST LEVEL INDEX
ERR66    BCTR  R9,0      DYNAMIC ALLOCATION OF A CATALOG ERROR
ERR67    BCTR  R9,0      ALLOCATED ICF CATALOG IS NOT THAT REQUESTED
ERR68    BCTR  R9,0      UNEXPECTED ICF CATALOG INDICATOR RECEIVED
ERR69    BCTR  R9,0      "GETMAIN" ERROR - IDCAMS ARRAY(S) SPACE
ERR70    BCTR  R9,0      ICF CATALOG NAME NOT FOUND - IDCAMS GENERATE
ERR71    BCTR  R9,0      "DYNALL" OR "PUNCH" TO 'XQIDIN' ERROR
ERR72    BCTR  R9,0      "DYNALL" OR "VREAD" TO 'XQIDOUT' ERROR
ERR73    BCTR  R9,0      'XQIDOUT' - INVALID LOGICAL RECORD LENGTH
ERR74    BCTR  R9,0      VTOC ERROR - MULTIPLE FORMAT 4 DSCB
ERR75    BCTR  R9,0      HIGH-LEVEL QUALIFIER (HLQ) NAME TOO LONG
ERR76    BCTR  R9,0      HLQ NAMES TABLE OVERFLOW
ERR77    BCTR  R9,0      GENERIC NAMES TABLE OVERFLOW
ERR78    BCTR  R9,0      COPYVOL(...) ERROR - INVALID CODING
ERR79    BCTR  R9,0      IDCAMS FUNCTION - INVALID FUNCTION CODE
ERR80    BCTR  R9,0      IDCAMS FUNCTION - INVALID DEVICE TYPE
         AIF   ('&M' NE 'SERVICES').G
MAXERR   EQU   ((*-ERR1)/2)+1
         B     MAINAB
         MEXIT
.G       B     *-*
         MEND
         MACRO
&NAME   @SNAPS &IND,&LIST,&TEST
         AIF   ('&IND' EQ '').A
         AIF   ('&LIST' EQ '').A
         AIF   ('&TEST' EQ '').A
&NAME    TM    RUN&IND,&IND&TEST
         BZ    *+L'*+12
         BAS   R14,SNAPS
         DC    AL4(&LIST),XL1'0',CL3'&TEST'
         MEXIT
.A       MNOTE 8,' OPERAND MISSING **********************************'
         MEND
         MACRO
&NAME   @X     &WHERE
         AIF   ('&WHERE' EQ '').A
&NAME    L     R15,=V(&WHERE)
         BASR  R14,R15
         MEXIT
.A       MNOTE 8,' OPERAND MISSING **********************************'
         MEND
         MACRO
&NAME   @XE    &DUMMY
&NAME    LH    R15,STACKNO         BACKWARD STACK
         BCT   R15,*+L'*+4
         B     ERR42
         STH   R15,STACKNO
         L     R13,4(R13)          BACK TO PREVIOUS SAVE AREA
         LM    R14,R12,12(R13)     RESTORE ENTRY REGISTERS
         MVI   12(R13),X'FF'       SET RETURN INDICATOR
         MVC   MNAME(STIDL),SVARL(R13)  RESTORE PREVIOUS ID
         BR    R14                 RETURN
         DROP  R8                  KILL LOCAL ADDRESSABILITY
         DROP  R10                 KILL COMMON ADDRESSABILITY
         SPACE 1
        LTORG
         MEND
         MACRO
&NAME   @XS    &ALIAS=
         AIF   ('&NAME' EQ '').E
&NAME    START 0
        $HEDIT
         AIF   ('&ALIAS' EQ '').A
        $HEDIT &ALIAS              MODULE ALIAS NAME
.A      $DEFREG
         EJECT
* REGISTERS USE :  R8  = LOCAL BASE REGISTER
* ---------------  R9  = ERROR NUMBER REGISTER
*                  R10 = COMMON BASE REGISTER
*                  R11 = SERVICES BASE REGISTER
*                  R12 = MAIN BASE REGISTER
         SPACE 1
         USING COMMON,R10          COMMON ADDRESSABILITY
         USING SERVICES,R11        SERVICES ADDRESSABILITY
         USING *,R15               TEMPORARY ADDRESSABILITY
         SPACE 1
         STM   R14,R12,12(R13)     SAVE ENTRY REGISTERS
         B     *+L'*+(4*8)         BRANCH AROUND ID-TEXT
         DROP  R15
         SPACE 1
         DC    CL8'&NAME'          MODULE IDENTIFIER
         AIF   ('&ALIAS' EQ '').B
         DC    CL8'&ALIAS'         MODULE ALIAS NAME
         AGO   .C
.B       DC    CL8' '              NO MODULE ALIAS NAME
.C       DC    C'-'
         DC    CL8'&SYSDATE'       ASSEMBLY DATE (MM/DD/YY)
         DC    C'-',CL5'&SYSTIME',C'-'  ASSEMBLY TIME (HH.MM)
         SPACE 1
         LR    R8,R15              SET BASE REGSITER
         USING &NAME,R8            LOCAL ADDRESSABILITY
         BAS   R14,SKIPT           CONTROL IF SKIP REQUESTED
         MVC   MNAME(STIDL),8(R8)  SET MODULE ID
         LH    R15,STACKNO         CONTROL STACK AVAILABILITY
         LA    R15,1(R15)
         CH    R15,SVSTACK
         BH    ERR42
         STH   R15,STACKNO
         LR    R15,R13
         LA    R13,STCKL(R13)      PUSH SAVE AREA STACK
         XC    0(SVARL,R13),0(R13) CLEAR NEW SAVE AREA
         ST    R13,8(R15)          CHAIN SAVE AREAS
         ST    R15,4(R13)
         MVC   SVARL(STIDL,R13),MNAME   SET STACK ID
         AIF   ('&ALIAS' EQ '').D
         BAS   R14,TIMET           STARTING TIME STAMP
.D       SPACE 1
         MEXIT
.E       MNOTE 8,' LABEL MISSING ************************************'
         MEND

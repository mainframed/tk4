//MINISYST JOB 1,MINISYST,MSGLEVEL=(1,1),MSGCLASS=X,CLASS=A,
//    NOTIFY=&SYSUID,COND=(4,LT),REGION=8000K   RESTART=IODF17
//*
//* CREATING A ONE-PACK PRODUCTION MINI-SYSTEM - CBT432
//* TESTED BY T.FALISSARD ON A P/390 WITH OS/390 V2R7.
//* SEE ALSO ARTICLE "CREATING AN MVS MINI SYSTEM FOR OS/390"
//* PUBLISHED IN MVS/UPDATE (JUNE 1999).
//*
//* PARAMETERS THAT MUST/MAY BE CHANGED ('CHANGE' COMMAND) :
//*
//*   MINISY : VOLSER OF THE ONE-PACK MINI-SYSTEM
//*   MINIS  : VOLSER OF THE ONE-PACK MINI-SYSTEM : 5 FIRST OCTETS
//*   0700   : MASTER CONSOLE ADDRESS FOR MINI SYSTEM
//*   012A   : DISK ADDRESS FOR MINI-SYSTEM
//*   ICFCAT.MINISY : MASTERCAT NAME FOR THE MINI-SYSTEM
//*   SYS1.IODF06.CLUSTER : YOUR CURRENT IODF DSNAME (WILL BE COPIED)
//*            (D IOS,CONFIG WILL DISPLAY IT)
//*
//* WARNINGS :
//*
//* - ADAPT STEP 'COPY5' ACCORDING TO YOUR SYSTEM FILES DSNAMES
//* - IT MAY BE NECESSARY TO DEFINE A MINI.* RACF PROFILE IF YOU
//*   HAVE PROTECTALL SET ON. (MINI.* IS USED FOR A TEMPORARY RENAME)
//* - PROGRAM MVSCMD USED IN STEPS OFF/ON IS ALSO DELIVERED IN CBT432.
//*-----------------------------------------------------------------*
//*  INIT1   : INITIALIZE THE DISK
//*-----------------------------------------------------------------*
//OFF       EXEC PGM=MVSCMD,PARM='V 012A,OFFLINE'
//DD        DD   DISP=SHR,DSN=SYS1.LINKLIB
//INIT1     EXEC PGM=ICKDSF
//SYSPRINT  DD   SYSOUT=*
//*VOLUME   DD   UNIT=SYSALLDA,VOL=SER=MINISY,DISP=SHR
//DDI       DD   DSN=SYS1.SAMPLIB(IEAIPL00),DISP=SHR
//SYSIN     DD   *
  /*INIT DDNAME(VOLUME) IPLDD(DDI) VERIFY(MINISY)    - */
    INIT UNIT(012A)     IPLDD(DDI) VERIFY(MINISY)    -
       VTOC(1,0,60) INDEX(0,1,14)   NOCONTINUE  PURGE NOCHECK
  /*REFORMAT DDNAME(VOLUME) VERIFY(MINISY) IPLDD(DDI)  */
//ON        EXEC PGM=MVSCMD,PARM='V 012A,ONLINE'
//*-----------------------------------------------------------------*
//*  ALLOCS2 : ALLOCATE SOME SYSTEM FILES
//*-----------------------------------------------------------------*
//ALLOCS2   EXEC PGM=IEFBR14
//DD1       DD   DISP=(NEW,KEEP),VOL=SER=MINISY,UNIT=SYSALLDA,
//   SPACE=(CYL,(1,1,2)),DCB=(LRECL=80,BLKSIZE=9040,RECFM=FB),
//   DSN=MINI.PARMLIB
//DD2       DD   DISP=(NEW,KEEP),VOL=SER=MINISY,UNIT=SYSALLDA,
//   DCB=DSORG=PSU,SPACE=(CYL,20),
//   DSN=MINI.HASPACE
//DD3       DD   DISP=(NEW,KEEP),VOL=SER=MINISY,UNIT=SYSALLDA,
//   DCB=SYS1.LOGREC,SPACE=(TRK,2),
//   DSN=MINI.LOGREC
//DD4       DD   DISP=(NEW,KEEP),VOL=SER=MINISY,UNIT=SYSALLDA,
//   SPACE=(CYL,5),
//   DSN=MINI.HASPCKPT
//DD5       DD   DISP=(NEW,KEEP),VOL=SER=MINISY,UNIT=SYSALLDA,
//   SPACE=(CYL,(1,1,2)),DCB=(LRECL=80,BLKSIZE=9040,RECFM=FB),
//   DSN=MINI.PROCLIB
//DD6       DD   DISP=(NEW,KEEP),VOL=SER=MINISY,UNIT=SYSALLDA,
//   SPACE=(CYL,(1,1,2)),DCB=SYS1.UADS,
//   DSN=MINI.UADS
//DD7       DD   DISP=(NEW,KEEP),VOL=SER=MINISY,UNIT=SYSALLDA,
//   SPACE=(TRK,(1,1)),DCB=SYS1.BRODCAST,
//   DSN=MINI.BRODCAST
//*-----------------------------------------------------------------*
//*  RENAME3 : RENAME SYSTEM FILES
//*-----------------------------------------------------------------*
//RENAME3   EXEC PGM=IEHPROGM
//DD1       DD   DISP=SHR,UNIT=SYSALLDA,VOL=SER=MINISY
//SYSPRINT  DD   SYSOUT=*
//SYSIN     DD   *
 RENAME DSNAME=MINI.PARMLIB,VOL=SYSALLDA=MINISY,NEWNAME=SYS1.PARMLIB
 RENAME DSNAME=MINI.HASPACE,VOL=SYSALLDA=MINISY,NEWNAME=SYS1.HASPACE
 RENAME DSNAME=MINI.LOGREC,VOL=SYSALLDA=MINISY,NEWNAME=SYS1.LOGREC
 RENAME DSNAME=MINI.HASPCKPT,VOL=SYSALLDA=MINISY,NEWNAME=SYS1.HASPCKPT
 RENAME DSNAME=MINI.PROCLIB,VOL=SYSALLDA=MINISY,NEWNAME=SYS1.PROCLIB
 RENAME DSNAME=MINI.UADS,VOL=SYSALLDA=MINISY,NEWNAME=SYS1.UADS
 RENAME DSNAME=MINI.BRODCAST,VOL=SYSALLDA=MINISY,NEWNAME=SYS1.BRODCAST
//*-----------------------------------------------------------------*
//*  DEFMCAT4 : DEFINE THE MASTERCATALOG FOR THE MINI-SYSTEM
//*-----------------------------------------------------------------*
//DEFMCAT4  EXEC PGM=IDCAMS
//SYSPRINT  DD   SYSOUT=*
//CATVOL    DD   VOL=SER=MINISY,UNIT=SYSALLDA,
//             DISP=OLD
//SYSIN     DD   *
  DELETE ICFCAT.MINISY               UCAT RECOVERY
  SET MAXCC = 0
 /********************************************/
 /*    DEFINE ICF MASTER CATALOG             */
 /********************************************/
  DEFINE UCAT (ICFCAT -
  NAME(ICFCAT.MINISY) -
  FILE(CATVOL) VOL(MINISY) CYL(1 1) SHR(3 3))
//*
//*-----------------------------------------------------------------*
//*  COPY5 : COPY ALL SYSTEM DATA SETS FROM CURRENT SYSTEM TO MINI
//*-----------------------------------------------------------------*
//COPY5     EXEC PGM=ADRDSSU
//SYSPRINT  DD   SYSOUT=*
//SYSIN     DD   *
 COPY DS(INC(SYS1.LINKLIB,SYS1.LPALIB,SYS1.SVCLIB,SYS1.CMDLIB,   -
             SYS1.NUCLEUS,SYS1.CSSLIB,SYS1.MIGLIB,               -
             SYS1.VTAMLIB,SYS1.VTAMLST,SYS1.SISTCLIB,            -
             SYS1.SHASLINK,                                      -
             ISP.SISPEXEC,ISP.SISPLOAD,                          -
             ISP.SISPMENU,ISP.SISPPENU,                          -
             ISP.SISPSENU,ISP.SISPTENU,                          -
             ISP.SISPSLIB,ISP.SISPCLIB,                          -
             SYS1.SISPLPA))  -
         ODY(MINISY) TOL(ENQF) WAIT(0,0) SHR BYPASSACS(**)
//*-----------------------------------------------------------------*
//*  SYSCATL6 : UPDATE SYSCATXX IN NUCLEUS
//*-----------------------------------------------------------------*
//SYSCATL6  EXEC PGM=IEBGENER
//SYSUT2    DD   DISP=SHR,UNIT=SYSALLDA,VOL=SER=MINISY,
//          DSN=SYS1.NUCLEUS(SYSCATLG)
//SYSPRINT  DD   SYSOUT=*
//SYSIN     DD   DUMMY
//SYSUT1    DD   *
MINISY1
//*-----------------------------------------------------------------*
//*  DEFINE PAGE DATA SETS
//*-----------------------------------------------------------------*
//DEFPGSP7  EXEC PGM=IDCAMS
//STEPCAT   DD   DISP=SHR,DSN=ICFCAT.MINISY
//SYSPRINT  DD   SYSOUT=*
//DD1       DD   VOL=SER=MINISY,UNIT=SYSALLDA,DISP=OLD
//SYSIN     DD   *
  DEF  PGSPC  (NAME(SYS1.PAGE.VMINISY.PLPA) -
               VOL(MINISY) FILE(DD1) CYL(30)  UNIQUE ) -
               CAT(ICFCAT.MINISY)
  DEF  PGSPC  (NAME(SYS1.PAGE.VMINISY.COMMON) -
               VOL(MINISY) FILE(DD1) CYL(20) UNIQUE ) -
               CAT(ICFCAT.MINISY)
  DEF  PGSPC  (NAME(SYS1.PAGE.VMINISY.LOCAL) -
               VOL(MINISY) FILE(DD1) CYL(20) UNIQUE ) -
               CAT(ICFCAT.MINISY)
//*-----------------------------------------------------------------*
//*  CATALOG SYSTEM FILES
//*-----------------------------------------------------------------*
//DEFNVSA8  EXEC PGM=IDCAMS
//STEPCAT   DD   DISP=SHR,DSN=ICFCAT.MINISY
//SYSPRINT  DD   SYSOUT=*
//SYSIN     DD   *
  DEF NVSAM(NAME(SYS1.RACFMINI) DEVT(0000) VOL(******)) -
               CAT(ICFCAT.MINISY)
  DEF NVSAM(NAME(SYS1.LINKLIB) DEVT(0000) VOL(******)) -
               CAT(ICFCAT.MINISY)
  DEF NVSAM(NAME(SYS1.LPALIB) DEVT(0000) VOL(******)) -
               CAT(ICFCAT.MINISY)
  DEF NVSAM(NAME(SYS1.CSSLIB) DEVT(0000) VOL(******)) -
               CAT(ICFCAT.MINISY)
  DEF NVSAM(NAME(SYS1.SVCLIB) DEVT(0000) VOL(******)) -
               CAT(ICFCAT.MINISY)
  DEF NVSAM(NAME(SYS1.CMDLIB) DEVT(0000) VOL(******)) -
               CAT(ICFCAT.MINISY)
  DEF NVSAM(NAME(SYS1.MIGLIB) DEVT(0000) VOL(******)) -
               CAT(ICFCAT.MINISY)
  DEF NVSAM(NAME(SYS1.NUCLEUS) DEVT(0000) VOL(******)) -
               CAT(ICFCAT.MINISY)
  DEF NVSAM(NAME(SYS1.PARMLIB) DEVT(0000) VOL(******)) -
               CAT(ICFCAT.MINISY)
  DEF NVSAM(NAME(SYS1.PROCLIB) DEVT(0000) VOL(******)) -
               CAT(ICFCAT.MINISY)
  DEF NVSAM(NAME(SYS1.UADS) DEVT(0000) VOL(******)) -
               CAT(ICFCAT.MINISY)
  DEF NVSAM(NAME(SYS1.BRODCAST) DEVT(0000) VOL(******)) -
               CAT(ICFCAT.MINISY)
  DEF NVSAM(NAME(SYS1.VTAMLIB) DEVT(0000) VOL(******)) -
               CAT(ICFCAT.MINISY)
  DEF NVSAM(NAME(SYS1.SISTCLIB) DEVT(0000) VOL(******)) -
               CAT(ICFCAT.MINISY)
  DEF NVSAM(NAME(SYS1.VTAMLST) DEVT(0000) VOL(******)) -
               CAT(ICFCAT.MINISY)
  DEF NVSAM(NAME(  SYS1.SHASLINK       ) DEVT(0000) VOL(******)) -
               CAT(ICFCAT.MINISY)
  DEF NVSAM(NAME( SYS1.SISPLPA         ) DEVT(0000) VOL(******)) -
               CAT(ICFCAT.MINISY)
  DEF NVSAM(NAME(  ISP.SISPLOAD        ) DEVT(0000) VOL(******)) -
               CAT(ICFCAT.MINISY)
  DEF NVSAM(NAME(  ISP.SISPPENU        ) DEVT(0000) VOL(******)) -
               CAT(ICFCAT.MINISY)
  DEF NVSAM(NAME(  ISP.SISPSLIB        ) DEVT(0000) VOL(******)) -
               CAT(ICFCAT.MINISY)
  DEF NVSAM(NAME(  ISP.SISPMENU        ) DEVT(0000) VOL(******)) -
               CAT(ICFCAT.MINISY)
  DEF NVSAM(NAME(  ISP.SISPTENU        ) DEVT(0000) VOL(******)) -
               CAT(ICFCAT.MINISY)
  DEF NVSAM(NAME(  ISP.SISPSENU        ) DEVT(0000) VOL(******)) -
               CAT(ICFCAT.MINISY)
  DEF NVSAM(NAME(  ISP.SISPCLIB        ) DEVT(0000) VOL(******)) -
               CAT(ICFCAT.MINISY)
  DEF NVSAM(NAME(  ISP.SISPEXEC        ) DEVT(0000) VOL(******)) -
               CAT(ICFCAT.MINISY)
//*-----------------------------------------------------------------*
//*  MODIFY PARMLIB : CREATE ONLY NEEDED MEMBERS
//*-----------------------------------------------------------------*
//MAJPARM9  EXEC PGM=IEBUPDTE,PARM=NEW
//SYSPRINT  DD   SYSOUT=*
//SYSUT2    DD   DISP=SHR,DSN=SYS1.PARMLIB,UNIT=SYSALLDA,VOL=SER=MINISY
//SYSIN     DD   DATA,DLM=$$
./  ADD NAME=IEASYS00
CVIO,                        CLPA OU CVIO
CMB=(UNITR,COMM,GRAPH,CHRDR), ADDITIONAL CMB ENTRIES
CMD=00,
CON=00,                      SELECT CONSOL00           TF***    DEFAULT
CSA=(2000,30000),
GRS=NONE,                    NO COORDINATION OF GRS REQUESTS
PROG=00,
PROD=00,
LNKAUTH=LNKLST,              MVS/XA 2.1.1 DEFAULT, APFTAB IS ALT
LOGCLS=L,                    WILL NOT BE PRINTED BY DEFAULT
LOGLMT=999999,               MUST BE 6 DIGITS, MAX WTL MESSAGES QUEUED
MAXUSER=250,                 (SYS TASKS + INITS + TSOUSERS)
PAGTOTL=(9,2),               ALLOW ADDITION 3 PAGE D/S AND 2 SWAP D/S
OPI=YES,                     ALLOW OPERATOR OVERRIDE TO IEASYS00
PAGE=(SYS1.PAGE.VMINISY.PLPA,
      SYS1.PAGE.VMINISY.COMMON,
      SYS1.PAGE.VMINISY.LOCAL,L),
REAL=128,                    ALLOWS 2 64K JOBS OR 1 128K JOB TO RUN V=R
RSU=0,                       NO RECONFIG STORAGE UNITS          DEFAULT
RSVSTRT=5,                   RESERVED ASVT ENTRIES              DEFAULT
RSVNONR=5,                   RESERVED ASVT ENTRIES              DEFAULT
SSN=00,
VAL=00,
SYSNAME=MINI,                RAJOUT TF 23-01-1989
VIODSN=IGNORE,
VRREGN=64                    DEFAULT REAL-STORAGE REGION SIZE   DEFAULT
./  ADD NAME=IFAPRD00
   WHEN (HWNAME(*))
PRODUCT OWNER('IBM CORP')
        NAME(OS/390)
        ID(5647-A01)
        VERSION(*) RELEASE(*) MOD(*)
        FEATURENAME(OS/390)
        STATE(ENABLED)
PRODUCT OWNER('IBM CORP')
        NAME(OS/390)
        ID(5647-A01)
        VERSION(*) RELEASE(*) MOD(*)
        FEATURENAME(DFSMSDSS)
        STATE(ENABLED)
PRODUCT OWNER('IBM CORP')
        NAME(OS/390)
        ID(5647-A01)
        VERSION(*) RELEASE(*) MOD(*)
        FEATURENAME('SECURITY SERVER')
        STATE(ENABLED)
./  ADD NAME=PROG00
APF FORMAT(DYNAMIC)
APF ADD  DSNAME(SYS1.LINKLIB)           VOLUME(MINISY)
APF ADD  DSNAME(SYS1.SHASLINK)          VOLUME(MINISY)
APF ADD  DSNAME(SYS1.VTAMLIB)           VOLUME(MINISY)
APF ADD  DSNAME(SYS1.SISPLPA)           VOLUME(MINISY)
APF ADD  DSNAME(SYS1.SISTCLIB)          VOLUME(MINISY)
APF ADD  DSNAME(ISP.SISPLOAD)           VOLUME(MINISY)
LNKLST DEFINE NAME(LNKLST00)
LNKLST ADD NAME(LNKLST00) DSN(SYS1.LINKLIB)
LNKLST ADD NAME(LNKLST00) DSN(SYS1.MIGLIB)
LNKLST ADD NAME(LNKLST00) DSN(SYS1.CSSLIB)
LNKLST ADD NAME(LNKLST00) DSN(SYS1.CMDLIB)
LNKLST ACTIVATE NAME(LNKLST00)
./  ADD NAME=LOAD00
IODF     00 SYS1     CBIPO    00
NUCLEUS  1
SYSCAT   MINISY113CICFCAT.MINISY
SYSPARM  00
./  ADD NAME=VATLST00
VATDEF IPLUSE(PRIVATE) SYSUSE(PRIVATE)
MINISY,1,0,3380    ,N  STORAGE     ** STORAGE POUR IBMUSER SOUS ISPF
./  ADD NAME=IEFSSN00
JES2,,,PRIMARY,NOSTART
./  ADD NAME=IGDDFPKG
DFSMS_OFFERING=(MINI,FULL)
./  ADD NAME=COMMND00
COM='D T'
COM='S JES2,PARM='WARM,NOREQ''
COM='S NET,,,(LIST=01)             START VTAM FOR LOCAL TERMINALS'
COM='S TSO                         AUTOMATIC START OF TSO'
./  ADD NAME=JES2PARM
CONDEF   AUTOCMD=52,BUFNUM=300,BUFWARN=80,CONCHAR=$,
         MASMSG=200,RDRCHAR=$
SMFDEF   BUFNUM=10,BUFWARN=80
CKPTDEF  CKPT1=(DSN=SYS1.HASPCKPT,VOL=MINISY,INUSE=YES)
SPOOLDEF BUFSIZE=3992,DSNAME=SYS1.HASPACE,FENCE=NO,
         SPOOLNUM=32,TGBPERVL=10,TGNUM=32576,TGSIZE=30,
         TGWARN=90,TRKCELL=3,VOLUME=MINIS
INITDEF  PARTNUM=5
I1       START,NAME=A,CLASS=X
I2       START,NAME=B,CLASS=X
I3       START,NAME=C,CLASS=X
I4       START,NAME=D,CLASS=X
I5       START,NAME=E,CLASS=X
INTRDR   CLASS=B,RDINUM=25
JOBDEF   ACCTFLD=IGNORE,JCLERR=NO,JOBNUM=3000,JOBWARN=80,
         PRTYHIGH=10,PRTYJECL=NO,PRTYJOB=NO,PRTYLOW=1,
         PRTYRATE=0,RANGE=(1-9999)
JOBCLASS(A-Y) ACCT=NO,PGMRNAME=NO,TIME=(60,0),REGION=8M,
         COMMAND=DISPLAY,BLP=YES,AUTH=ALL,MSGLEVEL=(1,1),
         JOURNAL=NO
STCCLASS TIME=(60,00),REGION=8M,COMMAND=DISPLAY,BLP=YES,
         AUTH=ALL,MSGLEVEL=(1,1),IEFUJP=YES,IEFUSO=YES,
         LOG=NO,OUTPUT=YES,PERFORM=0,PROCLIB=00,
         TYPE6=YES,TYPE26=YES,MSGCLASS=Z
TSUCLASS TIME=(60,00),REGION=8M,COMMAND=DISPLAY,BLP=YES,
         AUTH=ALL,MSGLEVEL=(1,1),IEFUJP=YES,IEFUSO=YES,
         LOG=NO,OUTPUT=YES,PERFORM=0,PROCLIB=00,
         TYPE6=YES,TYPE26=YES,MSGCLASS=Z
OUTDEF   COPIES=30,DMNDSET=NO,JOENUM=3000,JOEWARN=80,
         PRTYHIGH=0,PRTYLOW=0,PRTYOUT=NO,STDFORM=STD,USERSET=NO
OUTCLASS(X) OUTDISP=(HOLD),OUTPUT=PRINT,TRKCELL=YES
./  ADD NAME=TSOKEY00
USERMAX=100,                                                           +
RECONLIM=10,                                                           +
BUFRSIZE=132,                                                          +
HIBFREXT=6600,                                                         +
LOBFREXT=3300,                                                         +
CHNLEN=4,                                                              +
SCRSIZE=1920
./  ADD NAME=SMFPRM00
   NOACTIVE                       /*ACTIVE SMF RECORDING*/
   NOPROMPT                    /*DO NOT PROMPT OPERATOR FOR OPTIONS*/
./  ADD NAME=COUPLE00
 COUPLE SYSPLEX(LOCAL)
./  ADD NAME=CONSOL00
INIT PFK(00) MONITOR(DSNAME) MLIM(1500) RLIM(10) UEXIT(N)
        CMDDELIM(;)
DEFAULT ROUTCODE(ALL)
/********************************************************************/
/*                                                                  */
/* MASTER AND ALTERNATE CONSOLES                                    */
/*                                                                  */
/********************************************************************/
/* LIB: SYS1.PARMLIB(CONSOL00)                                       */
/* GDE: CBIPO MVS CUSTOMIZATION                                      */
/* DOC: THIS MEMBER CONTAINS THE MVS CUSTOM-BUILT IPO                */
/*      SUPPLIED CONSOLE DEFINITIONS FOR THE MASTER                  */
/*      CONSOLE AND THE ALTERNATE CONSOLES                           */
/*                                                                   */
CONSOLE DEVNUM(0700) ALTERNATE(F07) ROUTCODE(ALL) /* MCONS - 660    */
        PFKTAB(PFKTAB1)
        AUTH(MASTER)
        UNIT(3277-2)
        MONITOR(JOBNAMES-T)
        CON(N) SEG(9) DEL(RD) RNUM(19) RTME(1) MFORM(J,T) AREA(NONE)
/*                                                                  */
CONSOLE DEVNUM(F07) ALTERNATE(9A1) ROUTCODE(ALL)  /* SECONS - 820   */
        PFKTAB(PFKTAB1)
        AUTH(ALL)
        UNIT(3277-2)
        MONITOR(JOBNAMES-T)
        CON(N) SEG(9) DEL(RD) RNUM(19) RTME(1) MFORM(J,T) AREA(NONE)
CONSOLE DEVNUM(9A1) ALTERNATE(0700) ROUTCODE(ALL) /* SECONS - 820   */
        PFKTAB(PFKTAB1)
        AUTH(ALL)
        UNIT(3277-2)
        MONITOR(JOBNAMES-T)
        CON(N) SEG(9) DEL(RD) RNUM(19) RTME(1) MFORM(J,T) AREA(NONE)
./  ENDUP
$$
//*-----------------------------------------------------------------*
//*  MODIFY PROCLIB
//*-----------------------------------------------------------------*
//MAJPRC10  EXEC PGM=IEBUPDTE,PARM=NEW
//SYSPRINT  DD   SYSOUT=*
//SYSUT2    DD   DISP=SHR,DSN=SYS1.PROCLIB,UNIT=SYSALLDA,VOL=SER=MINISY
//SYSIN     DD   DATA,DLM=$$
./  ADD NAME=TSO
//TSO     PROC MBR=TSOKEY00
//STEP1   EXEC PGM=IKTCAS00,TIME=1440
//PARMLIB  DD  DSN=SYS1.PARMLIB(&MBR),DISP=SHR,FREE=CLOSE
//PRINTOUT DD  SYSOUT=*,FREE=CLOSE
//*
./  ADD NAME=JES2
//JES2    PROC M=JES2PARM
//IEFPROC EXEC PGM=HASJES20,TIME=1440,DPRTY=(15,15)
//HASPLIST  DD DDNAME=IEFRDER
//HASPPARM  DD DSN=SYS1.PARMLIB(&M),DISP=SHR
//PROC00    DD DSN=SYS1.PROCLIB,DISP=SHR
//STEPLIB   DD DSN=SYS1.SHASLINK,DISP=SHR
./  ADD NAME=NET
//VTMLCL PROC
//VTMLCL  EXEC PGM=ISTINM01,REGION=2048K,
//             DPRTY=(15,15),TIME=1440,PERFORM=8
//VTAMLST   DD DSN=SYS1.VTAMLST,DISP=SHR
//VTAMLIB   DD DSN=SYS1.VTAMLIB,DISP=SHR
//SISTCLIB  DD DSN=SYS1.SISTCLIB,DISP=SHR
//SYSABEND  DD SYSOUT=*,HOLD=YES
./  ADD NAME=IKJS
//IKJACCNT PROC
//IKJACCT EXEC PGM=IKJEFT01,DYNAMNBR=50,REGION=6000K,TIME=1440,
//  PARM=ISPF
//STEPLIB  DD  DSN=ISP.SISPLOAD,DISP=SHR
//         DD  DSN=SYS1.SISPLPA,DISP=SHR
//ISPLLIB  DD  DSN=ISP.SISPLOAD,DISP=SHR
//         DD  DSN=SYS1.SISPLPA,DISP=SHR
//ISPPLIB  DD  DSN=ISP.SISPPENU,DISP=SHR
//ISPSLIB  DD  DSN=ISP.SISPPENU,DISP=SHR  ON TRICHE
//*ISPSLIB  DD  DSN=ISP.SISPSLIB,DISP=SHR
//*         DD  DSN=ISP.SISPSENU,DISP=SHR
//ISPMLIB  DD  DSN=ISP.SISPMENU,DISP=SHR
//ISPTLIB  DD  DSN=ISP.SISPTENU,DISP=SHR
//SYSPROC  DD  DSN=ISP.SISPCLIB,DISP=SHR
//ISPPROF  DD  DISP=(NEW,DELETE),UNIT=SYSALLDA,VOL=SER=MINISY,
//         SPACE=(TRK,(5,1,1)),DCB=(LRECL=80,BLKSIZE=6160,RECFM=FB)
//ISPTABL  DD  DDNAME=ISPPROF
//SYSPRINT DD  TERM=TS,SYSOUT=*
//SYSTERM  DD  TERM=TS,SYSOUT=*
//SYSIN    DD  TERM=TS
$$
//*-----------------------------------------------------------------*
//*  COPY ONLY NEEDED MEMBERS FROM PROCLIB
//*-----------------------------------------------------------------*
//COPPRC11  EXEC PGM=IEBCOPY
//SYSUT3    DD  UNIT=SYSALLDA,SPACE=(CYL,(1,1))
//SYSUT4    DD  UNIT=SYSALLDA,SPACE=(CYL,(1,1))
//PROCIN    DD  DISP=SHR,DSN=SYS1.PROCLIB
//PROCOUT   DD  DISP=SHR,DSN=SYS1.PROCLIB,UNIT=SYSALLDA,VOL=SER=MINISY
//SYSPRINT  DD  SYSOUT=*
//SYSIN     DD  *
    COPY I=PROCIN,O=PROCOUT
    S    M=LLA
    S    M=DUMPSRV
    S    M=IEESYSAS
    S    M=IEEVMPCR
    S    M=INIT
//*-----------------------------------------------------------------*
//* REASSEMBLE ICHRDSNT FOR RACF
//*-----------------------------------------------------------------*
//RACF12A   EXEC PGM=ASMA90,PARM='OBJECT,NODECK,ALIGN'
//SYSPRINT  DD  SYSOUT=*
//SYSUDUMP  DD  SYSOUT=*
//SYSUT1    DD  UNIT=SYSALLDA,SPACE=(CYL,(4,3))
//SYSUT2    DD  UNIT=SYSALLDA,SPACE=(CYL,(4,3))
//SYSUT3    DD  UNIT=SYSALLDA,SPACE=(CYL,(4,3))
//SYSLIB    DD  DSN=SYS1.MACLIB,DISP=SHR
//SYSLIN    DD  DSN=&&OBJ,DISP=(,PASS),
//      UNIT=SYSALLDA,SPACE=(CYL,(1,1))
//SYSIN    DD  *
ICHRDSNT CSECT
         DC    AL1(1)             INDICATES ONE RACF DATA SET
         DC    CL44'SYS1.RACFMINI' PRIMARY RACF DS NAME
         DC    CL44' '            BACKUP RACF DS NAME
         DC    AL1(255)           # RESIDENT INDEX AND DATA BLOCKS
         DC    X'81'               UPDATES DUPLICATED ON BACKUP DS, X
         END
//*-----------------------------------------------------------------*
//* LINK-EDIT ICHRDSNT
//*-----------------------------------------------------------------*
//RACF12B  EXEC PGM=IEWL,PARM='XREF,LIST'
//SYSPRINT DD  SYSOUT=*
//SYSUT1   DD  UNIT=SYSALLDA,SPACE=(CYL,(1,1))
//SYSLIN   DD  DSN=*.RACF12A.SYSLIN,DISP=(OLD,DELETE)
//         DD  *
      NAME ICHRDSNT(R)
//SYSLIB   DD  DSN=SYS1.LINKLIB,DISP=SHR,
//      UNIT=SYSALLDA,VOL=SER=MINISY
//SYSLMOD  DD  DSN=SYS1.LINKLIB,DISP=SHR,
//      UNIT=SYSALLDA,VOL=SER=MINISY
//*-----------------------------------------------------------------*
//*  CREATE RACF DATABASE
//*-----------------------------------------------------------------*
//RACF13   EXEC PGM=IRRMIN00,PARM='NEW'
//SYSPRINT DD  SYSOUT=*
//SYSTEMP  DD  DSN=SYS1.MODGEN(IRRTEMP1),DISP=SHR
//SYSRACF  DD  DSN=SYS1.RACFMINI,DISP=(NEW,KEEP,DELETE),
//             UNIT=SYSALLDA,VOL=SER=MINISY,
//             SPACE=(TRK,(30),,CONTIG),
//             DCB=(RECFM=F,BLKSIZE=4096,DSORG=PSU)
//*-----------------------------------------------------------------*
//*  ZAP IEAVTRML JUST TO AVOID ABEND S806 AT IPL
//*-----------------------------------------------------------------*
//ZAP14    EXEC PGM=AMASPZAP
//SYSPRINT DD  SYSOUT=*
//SYSLIB   DD  DISP=SHR,DSN=SYS1.LPALIB,UNIT=SYSALLDA,VOL=SER=MINISY
//SYSIN    DD *
  NAME IGC0001C IEAVTRML
  REP 0000 00000000,00000000,00000000,00000000,00000000
  REP 0018 00000000,00000000,00000000,00000000,00000000
//*-----------------------------------------------------------------*
//*  CREATE TSO USERID IBMUSER
//*-----------------------------------------------------------------*
//UADS15   EXEC PGM=IKJEFT01
//SYSTSIN  DD  *
 ACCOUNT
 A (IBMUSER S A IKJS) SIZE(4000) JCL OPER NOMOUNT ACCT UNIT(SYSALLDA)
 L (IBMUSER)
 END
//SYSTSPRT DD  SYSOUT=*
//SYSUADS  DD  DISP=SHR,DSN=SYS1.UADS,UNIT=SYSALLDA,VOL=SER=MINISY
//SYSLBC   DD  DISP=SHR,DSN=SYS1.BRODCAST,UNIT=SYSALLDA,VOL=SER=MINISY
//*-----------------------------------------------------------------*
//*  INITIALIZE LOGREC
//*-----------------------------------------------------------------*
//LOGREC16 EXEC PGM=IFCDIP00
//SERERDS  DD  DSN=SYS1.LOGREC,UNIT=SYSALLDA,DISP=SHR,VOL=SER=MINISY
//FRAMES   DD  DDNAME=IEFRDER
//*-----------------------------------------------------------------*
//*  IODF17 : COPY CURRENT IODF ONTO A SEQUENTIAL WORK DATA SET
//*-----------------------------------------------------------------*
//IODF17   EXEC PGM=IDCAMS
//SYSPRINT DD  SYSOUT=*
//IODFOLD  DD  DISP=SHR,DSN=SYS1.IODF04.CLUSTER
//OUT      DD  DSN=&&OUT,DISP=(NEW,PASS),SPACE=(CYL,(2,2)),
//         UNIT=SYSALLDA,DSORG=PS,LRECL=4096,RECFM=F
//SYSIN    DD  *
  REPRO  INFILE(IODFOLD)     OUTFILE(OUT)
//*-----------------------------------------------------------------*
//*  IODF18 : CREATE IODF00 FROM CURRENT IODF
//*-----------------------------------------------------------------*
//IODF18   EXEC PGM=IDCAMS
//STEPCAT  DD  DISP=SHR,DSN=ICFCAT.MINISY
//SYSPRINT DD  SYSOUT=*
//OUT      DD  DSN=&&OUT,DISP=(OLD,DELETE)
//SYSIN    DD  *
  DEL         SYS1.IODF00.CLUSTER -
     CAT(ICFCAT.MINISY)
  SET MAXCC = 0
  DEF CL(NAME(SYS1.IODF00.CLUSTER) LINEAR TRACKS(8 1) VOLUME(MINISY)) -
         DATA(NAME(SYS1.IODF00)) -
     CAT(ICFCAT.MINISY)
  IF LASTCC = 0 THEN -
       REPRO    ODS(SYS1.IODF00.CLUSTER)   INFILE(OUT)
//*-----------------------------------------------------------------*
//* CREATE ICHRIN03 TABLE FOR RACF
//*-----------------------------------------------------------------*
//RACF19A  EXEC PGM=ASMA90,PARM='OBJECT,NODECK,ALIGN'
//SYSPRINT DD  SYSOUT=*
//SYSUDUMP DD  SYSOUT=*
//SYSUT1   DD  UNIT=SYSALLDA,SPACE=(CYL,(4,3))
//SYSUT2   DD  UNIT=SYSALLDA,SPACE=(CYL,(4,3))
//SYSUT3   DD  UNIT=SYSALLDA,SPACE=(CYL,(4,3))
//SYSLIB   DD  DSN=SYS1.MACLIB,DISP=SHR
//SYSLIN   DD  DSN=&&OBJ,DISP=(,PASS),
//      UNIT=SYSALLDA,SPACE=(CYL,(1,1))
//SYSIN    DD  *
ICHRIN03 CSECT
         DC    X'8001'
         DC    CL8'*'
         DC    CL8'='
         DC    CL8'SYS1'
         DC    14X'00'
         END
//*-----------------------------------------------------------------*
//* LINK ICHRIN03 TABLE FOR RACF
//*-----------------------------------------------------------------*
//RACF19B  EXEC PGM=IEWL,PARM='XREF,LIST'
//SYSPRINT DD  SYSOUT=*
//SYSUT1   DD  UNIT=SYSALLDA,SPACE=(CYL,(1,1))
//SYSLIN   DD  DSN=*.RACF19A.SYSLIN,DISP=(OLD,DELETE)
//         DD *
      NAME ICHRIN03(R)
//SYSLIB  DD DSN=SYS1.LPALIB,DISP=SHR,
//      UNIT=SYSALLDA,VOL=SER=MINISY
//SYSLMOD DD DSN=SYS1.LPALIB,DISP=SHR,
//      UNIT=SYSALLDA,VOL=SER=MINISY
//*-----------------------------------------------------------------*
//*  DUMMY IEFACTRT
//*-----------------------------------------------------------------*
//*ACTRT17  EXEC PGM=IEBCOPY
//*SYSUT3 DD  UNIT=SYSALLDA,SPACE=(CYL,(1,1))
//*SYSUT4 DD  UNIT=SYSALLDA,SPACE=(CYL,(1,1))
//*PROCIN DD  DISP=SHR,DSN=SYS1.LPALIB   CURRENT LPALIB
//*PROCOUT DD DISP=SHR,DSN=SYS1.LPALIB,UNIT=SYSALLDA,VOL=SER=MINISY
//*SYSPRINT DD SYSOUT=*
//*SYSIN   DD *
//* COPY I=PROCIN,O=PROCOUT
//* S    M=((IEFBR14,IEFACTRT,R))
//*
//*END OF JOB
//
//*=================================================================
//*
//*  CREATE A DFSMSDSS STAND-ALONE TAPE : 1ST FILE = DFSMSDSS PROGRAM
//*
//DFDSSSA    EXEC PGM=ADRDSSU,PARM='UTILMSG=YES'
//SAMODS     DD  DSN=SYS1.SADRYLIB,DISP=SHR
//CARDDD     DD  UNIT=3480,LABEL=(1,NL,EXPDT=98000),DISP=(,KEEP),
//  DCB=(RECFM=F,LRECL=80,BLKSIZE=80),VOL=(,RETAIN,SER=CART00),
//  DSN=MINI.FILE1
//SYSPRINT   DD  SYSOUT=*
//SYSIN      DD  *
  BUILDSA INDD(SAMODS) OUTDD(CARDDD)
//*
//*  CREATE A DFSMSDSS STAND-ALONE TAPE : 2ND FILE = MINI SYSTEM
//*
//SECUDISK   EXEC  PGM=ADRDSSU
//SYSPRINT   DD  SYSOUT=*
//CART       DD  DSN=MINI.MINISY,VOL=SER=CART00,DCB=TRTCH=COMP,
//           DISP=(NEW,KEEP),UNIT=3480,LABEL=(2,NL,EXPDT=98000)
//DASD       DD  UNIT=SYSALLDA,VOL=SER=MINISY,DISP=SHR
//SYSIN      DD  *
  DUMP  FULL  INDD(DASD)  OUTDD(CART)  CANCELERROR               -
  OPT(4)
  IF LASTCC = 0 -
      THEN WTO '** BACKUP OF DISK MINISY SUCCESSFULLY COMPLETED **'

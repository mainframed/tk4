000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID.    KDSNNAM.
000030 AUTHOR.        BRUCE LOMAR.
000031 INSTALLTION.   CNA INSURANCE.
000040
000050 ENVIRONMENT DIVISION.
000060 CONFIGURATION SECTION.
000070 SOURCE-COMPUTER.
000080     IBM-370.
000090*    IBM-370 WITH DEBUGGING MODE.
000100 INPUT-OUTPUT SECTION.
000110 FILE-CONTROL.
000120
000130 DATA DIVISION.
000140
000150 WORKING-STORAGE SECTION.
000160
000170 01  ONE-QUOTE                        PIC X   VALUE ''''.
000180 01  ONE-BLANK                        PIC X   VALUE SPACES.
000190
000200/
000210 LINKAGE SECTION.
000220
000230 01  DSN-ARRAY.
000240     03  DSNAME                       PIC X(44)
000250                                      OCCURS 50 TIMES
000260                                      INDEXED BY DSN-INX.
000270 01  DSNAME-STRING                    PIC X(220).
000280 01  STRING-LENGTH                    PIC S9(4) COMP.
000290
000300/
000310 PROCEDURE DIVISION USING DSN-ARRAY DSNAME-STRING STRING-LENGTH.
000320 0100-MAIN-ROUTINE.
000330*    BUILD QUOTED DSNAMES INTO A STRING
000340     MOVE SPACES TO DSNAME-STRING.
000350     MOVE +1 TO STRING-LENGTH.
000360     PERFORM 0200-STRING-DSN THRU 0200-EXIT
000370         VARYING DSN-INX FROM 1 BY 1
000380         UNTIL DSNAME (DSN-INX) = SPACES OR DSN-INX > 50
000390     MOVE ZERO TO RETURN-CODE.
000400     GOBACK.
000410
000420 0200-STRING-DSN.
000430     IF DSNAME (DSN-INX) = 'TERMFILE'
000440         STRING '*'       DELIMITED BY SIZE
000450                ONE-BLANK DELIMITED BY SIZE
000460             INTO DSNAME-STRING
000470         WITH POINTER STRING-LENGTH
000480         OVERFLOW GO TO 0225-STRING-ERROR
000490     ELSE
000500         STRING ONE-QUOTE            DELIMITED BY SIZE
000510                DSNAME (DSN-INX)     DELIMITED BY SPACES
000520                ONE-QUOTE            DELIMITED BY SIZE
000530                ONE-BLANK            DELIMITED BY SIZE
000540             INTO DSNAME-STRING
000550         WITH POINTER STRING-LENGTH
000560         OVERFLOW GO TO 0225-STRING-ERROR.
000570 0200-EXIT.  EXIT.
000580
000590 0225-STRING-ERROR.
000600     MOVE 99 TO RETURN-CODE.
000610     GOBACK.

        /* DATA SET S963P75    AT LEVEL 003 AS OF 04/02/81    */
         /*   LEVEL 2 - .................... BW . 010879    */
 P963P75: PROC OPTIONS(MAIN) REORDER;
 /******************************************************************/
 /*                                                                */
 /*    PROGRAM NAME: P963P75         - XMIT SPACE MANAGEMENT JOB   */
 /*                                                                */
 /*      WRITTEN BY: BILL WILLIAMS ................05 DEC. 1978    */
 /*      LEVEL 2 - CREATE HISTORY FILE ....... BW .01 AUG. 1979    */
 /*                                                                */
 /* PROGRAM PURPOSE: TO CHECK DASDMON OUTLOG DATASET (INLOG-F120)  */
 /*                  FOR ANY DATASET FOUND UNCATALOG, SCRATCH,     */
 /*                  UNUSED OR PAST EXPDT ON MSVGP=XMIT. DATASETS  */
 /*                  FOUND THEN ARE MATCHED WITH INSCR (F115).     */
 /*                  IF MATCH FOUND THEN WRITE NEWSCR DATASET(F116)*/
 /*                                                                */
 /* HISTORY FILE   : HOLDS 27 CYCLES OF DATASET SIZE HISTORY FOR   */
 /*                  ALL FCI1 AND FCI2 XMIT DATASETS.HISTORY       */
 /*                  HELD -- EXTENTS, ALLOCATED TRKS, USED TRKS,   */
 /*                  AND DATE CREATED OF MOFIFIED. REPORT IS       */
 /*                  PRINTED WEEKLY.                               */
 /*                                                                */
 /*            I/O : INLOG (FCI2.A00963.F0963.F120) CREATED IN     */
 /*                  DASDMON HAS LISTED ALL DATASETS ON DASD WITH  */
 /*                  FLAGS (UNAUTH,UNCAT,UNUSED,TOOBIG,EXPIR,      */
 /*                  OVERALL,PASTRETPD).                           */
 /*                                                                */
 /*                  INSCR (FCI2.A00963.F0963.F115) CREATED IN     */
 /*                  DASDMON HAS LISTED ALL DATASETS SELETED FOR   */
 /*                  SCRATCH.                                      */
 /*                                                                */
 /*                  NEWSCR (FCI2.A00963.F0963.F116) HAS LISTED    */
 /*                  ALL DATASETS TO BE AUTOMATICLY SCRATCHED BY   */
 /*                  C963S999.                                     */
 /*                                                                */
 /*                  INHIST/OUTHIST (FCI1.A00963.F0963.F121.GDG)   */
 /*                  DATASET HISTORY FILE UPDATED ON EACH RUN.     */
 /*                                                                */
 /*                                                                */
 /*         COMMENT: INPUT IS CHECKED FOR ASCENDING ORDER. IF      */
 /*                  INPUT IS FOUND OUT OF ORDER ABEND IS CALLED   */
 /*                  WITH USER CODE 1024, PGM DISPLAY F120 OR F115 */
 /*                  NOT ASCENDING.                                */
 /*                  OUTPUT DATASET NEWSCR TO BE AUTO SCRATCH IN   */
 /*                  NEXT JOB STEP.                                */
 /*                                                                */
 /******************************************************************/
1/******************************************************************/
 /*                                                                */
 /*         OUTLINE:         - OPEN,SET ENDFILE,READ DATE CARD     */
 /*                  LOG     - READ F20 FIND RECORD FOR SCRACTH    */
 /*                  SCR     - MATCH RECORD 1 TO SCRATCH DATASET   */
 /*                  WRTERR  - NO FOUND WRITE TO SYSPRINT          */
 /*                  READ15  - READ IN SCRATCH CHECK ASCENDING     */
 /*                  READ20  - READ IN LOG CHECK ASCENDING         */
 /*                  EOF15   - EOF SCR IF LOG REC READ AND CHECK   */
 /*                  EOF20   - EOF LOG IF SCR REC READ AND WRITE   */
 /*                  ERRF15  - SCR FILE NOT ASCENDING - ABEND      */
 /*                  ERRF20  - LOG FILE NOT ASCENDING - ABEND      */
 /*                  ERRHEAD - NO DATE CARD ON SCR FILE - ABEND    */
 /*                  EOJ     - CLOSE AND IF ABEND CALL ABEND       */
 /*                                                                */
 /******************************************************************/

1DCL ABEND ENTRY;                         /* ABEND IF BAD DATA     */

 DCL INSCR  FILE                          /* DASDMON SCRATCH DATA  */
            RECORD
            INPUT;

 DCL INLOG  FILE                          /* DASDMON ALLOC DATASET */
            RECORD
            INPUT;

 DCL NEWSCR FILE                          /* MATCH-MERGE NEWSCR    */
            RECORD
            OUTPUT;

1DCL 1 IN_SCR,              /* DASDMON OUTSCR DATA USED FOR MATCH */
       2 IS_DSN      CHAR(44)     INIT(' '),
       2 IS_VOL      CHAR(6)      INIT(' '),
       2 IS_FLAG     CHAR(2)      INIT(' '),
       2 IS_BILLTO   CHAR(8)      INIT(' '),
       2 IS_LASTUSE  CHAR(5)      INIT(' '),
       2 IS_USER     CHAR(8)      INIT(' '),
       2 IS_DEVICE   CHAR(7)      INIT(' ');

 DCL 1 IN_LOG,              /* DASDMON OUTLOG DATA USED FOR MATCH */
       2 DSNAME      CHAR(44)         INIT(' '),
       2 MSVGP       CHAR(8)          INIT(' '),
       2 VOLUME      CHAR(6)          INIT(' '),
       2 DEVICE      CHAR(8)          INIT(' '),
       2 DISKTYPE    CHAR(1)          INIT(' '),
       2 EXTNTS      BIT(8)           INIT((8)'0'B),
       2 DSORG       CHAR(3)          INIT(' '),
       2 RECFM       CHAR(4)          INIT(' '),
       2 SALLC_TYPE  CHAR(1)          INIT(' '),
       2 SALLC_QTY   FIXED BIN(15,0)  INIT(0),
       2 LRECL       FIXED BIN(15,0)  INIT(0),
       2 BLKSIZE     FIXED BIN(15,0)  INIT(0),
       2 TRK_ALLOC   FIXED BIN(15,0)  INIT(0),
       2 TRK_USED    FIXED BIN(15,0)  INIT(0),
       2 DIR_ALLOC   FIXED BIN(15,0)  INIT(0),
       2 DIR_USED    FIXED BIN(15,0)  INIT(0),
       2 USE_COUNT   FIXED BIN(15,0)  INIT(0),
       2 DAYS_UNUSED FIXED BIN(15,0)  INIT(0),
       2 CREATED     FIXED DEC(5)     INIT(0),
       2 LAST_USED   FIXED DEC(5)     INIT(0),
       2 LAST_MOD    FIXED DEC(5)     INIT(0),
       2 LAST_MOD_TIME BIT(16)        INIT((16)'0'B),
       2 EXP_DATE    FIXED DEC(5)     INIT(0),
       2 MOD_USER    CHAR(8)          INIT(' '),
       2 BILL_TO     CHAR(8)          INIT(' '),
       2 UAUTH       CHAR(1)          INIT(' '),
       2 UCAT        CHAR(1)          INIT(' '),
       2 UUSED       CHAR(1)          INIT(' '),
       2 OTHFLAGS    CHAR(3)          INIT(' '),
       2 RETPD       CHAR(1)          INIT(' '),
       2 NOFLAG      CHAR(1)          INIT(' '),
       2 SCRFLAG     CHAR(1)          INIT(' '),
       2 PC_USED     FIXED DEC(5)     INIT(0),
       2 EXPIRES     PIC'ZZZZZZ'      INIT(0);

1DCL 1 NEW_REC,                   /* NEWSCR RECORD - MATCH FOUND   */
       2 N_DSN       CHAR(44)     INIT(' '),
       2 N_VOL       CHAR(6)      INIT(' '),
       2 N_FLAG      CHAR(2)      INIT(' '),
       2 N_BILLTO    CHAR(8)      INIT(' '),
       2 N_LASTUSE   CHAR(5)      INIT(' '),
       2 N_USER      CHAR(8)      INIT(' '),
       2 N_DEVICE    CHAR(7)      INIT(' ');


 DCL 1 SCRPARM,                 /* NEWSCR - FIRST RECORD SCR DATE  */
       2 FILL1       CHAR(9)      INIT(' '),
       2 RUN_DATE    CHAR(8)      INIT(' '),
       2 FILL2       CHAR(10)     INIT(' '),
       2 SCR_HEAD    CHAR(8)      INIT(' '),
       2 SCR_DATE    CHAR(8)      INIT(' '),
       2 FILL3       CHAR(37)     INIT(' ');

 DCL INHIST FILE        /* HISTORY FILE - BILL WILLIAMS */
            RECORD      /* MODIFY TO XMITSCR ON AUG. 01, 1979 */
            INPUT;

 DCL OUTHIST FILE       /* UPDATED HISTORY FILE  */
            RECORD
            OUTPUT;

 DCL 1 IN_HI,                          /* INPUT HISTORY FILE      */
       2 II_DSNAME   CHAR(44)          INIT(' '),
       2 II_MSVGP    CHAR(8)           INIT(' '),
       2 II_USER     CHAR(8)           INIT(' '),
       2 II_ORG      CHAR(3)           INIT(' '),
       2 II_FLAGS    BIT(16)           INIT((16)'0'B),
       2 II_EXT      BIT(280)          INIT((280)'0'B),
       2 II_ALLOC_01 FIXED BIN(15,0)   INIT(0),
       2 II_ALLOC_02 FIXED BIN(15,0)   INIT(0),
       2 II_ALLOC_03 FIXED BIN(15,0)   INIT(0),
       2 II_ALLOC_04 FIXED BIN(15,0)   INIT(0),
       2 II_ALLOC_05 FIXED BIN(15,0)   INIT(0),
       2 II_ALLOC_06 FIXED BIN(15,0)   INIT(0),
       2 II_ALLOC_07 FIXED BIN(15,0)   INIT(0),
       2 II_ALLOC_08 FIXED BIN(15,0)   INIT(0),
       2 II_ALLOC_09 FIXED BIN(15,0)   INIT(0),
       2 II_ALLOC_10 FIXED BIN(15,0)   INIT(0),
       2 II_ALLOC_11 FIXED BIN(15,0)   INIT(0),
       2 II_ALLOC_12 FIXED BIN(15,0)   INIT(0),
       2 II_ALLOC_13 FIXED BIN(15,0)   INIT(0),
       2 II_ALLOC_14 FIXED BIN(15,0)   INIT(0),
       2 II_ALLOC_15 FIXED BIN(15,0)   INIT(0),
       2 II_ALLOC_16 FIXED BIN(15,0)   INIT(0),
       2 II_ALLOC_17 FIXED BIN(15,0)   INIT(0),
       2 II_ALLOC_18 FIXED BIN(15,0)   INIT(0),
       2 II_ALLOC_19 FIXED BIN(15,0)   INIT(0),
       2 II_ALLOC_20 FIXED BIN(15,0)   INIT(0),
       2 II_ALLOC_21 FIXED BIN(15,0)   INIT(0),
       2 II_ALLOC_22 FIXED BIN(15,0)   INIT(0),
       2 II_ALLOC_23 FIXED BIN(15,0)   INIT(0),
       2 II_ALLOC_24 FIXED BIN(15,0)   INIT(0),
       2 II_ALLOC_25 FIXED BIN(15,0)   INIT(0),
       2 II_ALLOC_26 FIXED BIN(15,0)   INIT(0),
       2 II_ALLOC_27 FIXED BIN(15,0)   INIT(0),
       2 II_ALLOC_28 FIXED BIN(15,0)   INIT(0),
       2 II_USED_01  FIXED BIN(15,0)   INIT(0),
       2 II_USED_02  FIXED BIN(15,0)   INIT(0),
       2 II_USED_03  FIXED BIN(15,0)   INIT(0),
       2 II_USED_04  FIXED BIN(15,0)   INIT(0),
       2 II_USED_05  FIXED BIN(15,0)   INIT(0),
       2 II_USED_06  FIXED BIN(15,0)   INIT(0),
       2 II_USED_07  FIXED BIN(15,0)   INIT(0),
       2 II_USED_08  FIXED BIN(15,0)   INIT(0),
       2 II_USED_09  FIXED BIN(15,0)   INIT(0),
       2 II_USED_10  FIXED BIN(15,0)   INIT(0),
       2 II_USED_11  FIXED BIN(15,0)   INIT(0),
       2 II_USED_12  FIXED BIN(15,0)   INIT(0),
       2 II_USED_13  FIXED BIN(15,0)   INIT(0),
       2 II_USED_14  FIXED BIN(15,0)   INIT(0),
       2 II_USED_15  FIXED BIN(15,0)   INIT(0),
       2 II_USED_16  FIXED BIN(15,0)   INIT(0),
       2 II_USED_17  FIXED BIN(15,0)   INIT(0),
       2 II_USED_18  FIXED BIN(15,0)   INIT(0),
       2 II_USED_19  FIXED BIN(15,0)   INIT(0),
       2 II_USED_20  FIXED BIN(15,0)   INIT(0),
       2 II_USED_21  FIXED BIN(15,0)   INIT(0),
       2 II_USED_22  FIXED BIN(15,0)   INIT(0),
       2 II_USED_23  FIXED BIN(15,0)   INIT(0),
       2 II_USED_24  FIXED BIN(15,0)   INIT(0),
       2 II_USED_25  FIXED BIN(15,0)   INIT(0),
       2 II_USED_26  FIXED BIN(15,0)   INIT(0),
       2 II_USED_27  FIXED BIN(15,0)   INIT(0),
       2 II_USED_28  FIXED BIN(15,0)   INIT(0),
       2 II_CREAT_01 FIXED DEC(5)      INIT(0),
       2 II_CREAT_02 FIXED DEC(5)      INIT(0),
       2 II_CREAT_03 FIXED DEC(5)      INIT(0),
       2 II_CREAT_04 FIXED DEC(5)      INIT(0),
       2 II_CREAT_05 FIXED DEC(5)      INIT(0),
       2 II_CREAT_06 FIXED DEC(5)      INIT(0),
       2 II_CREAT_07 FIXED DEC(5)      INIT(0),
       2 II_CREAT_08 FIXED DEC(5)      INIT(0),
       2 II_CREAT_09 FIXED DEC(5)      INIT(0),
       2 II_CREAT_10 FIXED DEC(5)      INIT(0),
       2 II_CREAT_11 FIXED DEC(5)      INIT(0),
       2 II_CREAT_12 FIXED DEC(5)      INIT(0),
       2 II_CREAT_13 FIXED DEC(5)      INIT(0),
       2 II_CREAT_14 FIXED DEC(5)      INIT(0),
       2 II_CREAT_15 FIXED DEC(5)      INIT(0),
       2 II_CREAT_16 FIXED DEC(5)      INIT(0),
       2 II_CREAT_17 FIXED DEC(5)      INIT(0),
       2 II_CREAT_18 FIXED DEC(5)      INIT(0),
       2 II_CREAT_19 FIXED DEC(5)      INIT(0),
       2 II_CREAT_20 FIXED DEC(5)      INIT(0),
       2 II_CREAT_21 FIXED DEC(5)      INIT(0),
       2 II_CREAT_22 FIXED DEC(5)      INIT(0),
       2 II_CREAT_23 FIXED DEC(5)      INIT(0),
       2 II_CREAT_24 FIXED DEC(5)      INIT(0),
       2 II_CREAT_25 FIXED DEC(5)      INIT(0),
       2 II_CREAT_26 FIXED DEC(5)      INIT(0),
       2 II_CREAT_27 FIXED DEC(5)      INIT(0),
       2 II_CREAT_28 FIXED DEC(5)      INIT(0);

 DCL 1 OUT_HI,                         /* INPUT HISTORY FILE      */
       2 OO_DSNAME   CHAR(44)          INIT(' '),
       2 OO_MSVGP    CHAR(8)           INIT(' '),
       2 OO_USER     CHAR(8)           INIT(' '),
       2 OO_ORG      CHAR(3)           INIT(' '),
       2 OO_FLAGS    BIT(16)           INIT((16)'0'B),
       2 OO_EXT      BIT(280)          INIT((280)'0'B),
       2 OO_ALLOC_01 FIXED BIN(15,0)   INIT(0),
       2 OO_ALLOC_02 FIXED BIN(15,0)   INIT(0),
       2 OO_ALLOC_03 FIXED BIN(15,0)   INIT(0),
       2 OO_ALLOC_04 FIXED BIN(15,0)   INIT(0),
       2 OO_ALLOC_05 FIXED BIN(15,0)   INIT(0),
       2 OO_ALLOC_06 FIXED BIN(15,0)   INIT(0),
       2 OO_ALLOC_07 FIXED BIN(15,0)   INIT(0),
       2 OO_ALLOC_08 FIXED BIN(15,0)   INIT(0),
       2 OO_ALLOC_09 FIXED BIN(15,0)   INIT(0),
       2 OO_ALLOC_10 FIXED BIN(15,0)   INIT(0),
       2 OO_ALLOC_11 FIXED BIN(15,0)   INIT(0),
       2 OO_ALLOC_12 FIXED BIN(15,0)   INIT(0),
       2 OO_ALLOC_13 FIXED BIN(15,0)   INIT(0),
       2 OO_ALLOC_14 FIXED BIN(15,0)   INIT(0),
       2 OO_ALLOC_15 FIXED BIN(15,0)   INIT(0),
       2 OO_ALLOC_16 FIXED BIN(15,0)   INIT(0),
       2 OO_ALLOC_17 FIXED BIN(15,0)   INIT(0),
       2 OO_ALLOC_18 FIXED BIN(15,0)   INIT(0),
       2 OO_ALLOC_19 FIXED BIN(15,0)   INIT(0),
       2 OO_ALLOC_20 FIXED BIN(15,0)   INIT(0),
       2 OO_ALLOC_21 FIXED BIN(15,0)   INIT(0),
       2 OO_ALLOC_22 FIXED BIN(15,0)   INIT(0),
       2 OO_ALLOC_23 FIXED BIN(15,0)   INIT(0),
       2 OO_ALLOC_24 FIXED BIN(15,0)   INIT(0),
       2 OO_ALLOC_25 FIXED BIN(15,0)   INIT(0),
       2 OO_ALLOC_26 FIXED BIN(15,0)   INIT(0),
       2 OO_ALLOC_27 FIXED BIN(15,0)   INIT(0),
       2 OO_ALLOC_28 FIXED BIN(15,0)   INIT(0),
       2 OO_USED_01  FIXED BIN(15,0)   INIT(0),
       2 OO_USED_02  FIXED BIN(15,0)   INIT(0),
       2 OO_USED_03  FIXED BIN(15,0)   INIT(0),
       2 OO_USED_04  FIXED BIN(15,0)   INIT(0),
       2 OO_USED_05  FIXED BIN(15,0)   INIT(0),
       2 OO_USED_06  FIXED BIN(15,0)   INIT(0),
       2 OO_USED_07  FIXED BIN(15,0)   INIT(0),
       2 OO_USED_08  FIXED BIN(15,0)   INIT(0),
       2 OO_USED_09  FIXED BIN(15,0)   INIT(0),
       2 OO_USED_10  FIXED BIN(15,0)   INIT(0),
       2 OO_USED_11  FIXED BIN(15,0)   INIT(0),
       2 OO_USED_12  FIXED BIN(15,0)   INIT(0),
       2 OO_USED_13  FIXED BIN(15,0)   INIT(0),
       2 OO_USED_14  FIXED BIN(15,0)   INIT(0),
       2 OO_USED_15  FIXED BIN(15,0)   INIT(0),
       2 OO_USED_16  FIXED BIN(15,0)   INIT(0),
       2 OO_USED_17  FIXED BIN(15,0)   INIT(0),
       2 OO_USED_18  FIXED BIN(15,0)   INIT(0),
       2 OO_USED_19  FIXED BIN(15,0)   INIT(0),
       2 OO_USED_20  FIXED BIN(15,0)   INIT(0),
       2 OO_USED_21  FIXED BIN(15,0)   INIT(0),
       2 OO_USED_22  FIXED BIN(15,0)   INIT(0),
       2 OO_USED_23  FIXED BIN(15,0)   INIT(0),
       2 OO_USED_24  FIXED BIN(15,0)   INIT(0),
       2 OO_USED_25  FIXED BIN(15,0)   INIT(0),
       2 OO_USED_26  FIXED BIN(15,0)   INIT(0),
       2 OO_USED_27  FIXED BIN(15,0)   INIT(0),
       2 OO_USED_28  FIXED BIN(15,0)   INIT(0),
       2 OO_CREAT_01 FIXED DEC(5)      INIT(0),
       2 OO_CREAT_02 FIXED DEC(5)      INIT(0),
       2 OO_CREAT_03 FIXED DEC(5)      INIT(0),
       2 OO_CREAT_04 FIXED DEC(5)      INIT(0),
       2 OO_CREAT_05 FIXED DEC(5)      INIT(0),
       2 OO_CREAT_06 FIXED DEC(5)      INIT(0),
       2 OO_CREAT_07 FIXED DEC(5)      INIT(0),
       2 OO_CREAT_08 FIXED DEC(5)      INIT(0),
       2 OO_CREAT_09 FIXED DEC(5)      INIT(0),
       2 OO_CREAT_10 FIXED DEC(5)      INIT(0),
       2 OO_CREAT_11 FIXED DEC(5)      INIT(0),
       2 OO_CREAT_12 FIXED DEC(5)      INIT(0),
       2 OO_CREAT_13 FIXED DEC(5)      INIT(0),
       2 OO_CREAT_14 FIXED DEC(5)      INIT(0),
       2 OO_CREAT_15 FIXED DEC(5)      INIT(0),
       2 OO_CREAT_16 FIXED DEC(5)      INIT(0),
       2 OO_CREAT_17 FIXED DEC(5)      INIT(0),
       2 OO_CREAT_18 FIXED DEC(5)      INIT(0),
       2 OO_CREAT_19 FIXED DEC(5)      INIT(0),
       2 OO_CREAT_20 FIXED DEC(5)      INIT(0),
       2 OO_CREAT_21 FIXED DEC(5)      INIT(0),
       2 OO_CREAT_22 FIXED DEC(5)      INIT(0),
       2 OO_CREAT_23 FIXED DEC(5)      INIT(0),
       2 OO_CREAT_24 FIXED DEC(5)      INIT(0),
       2 OO_CREAT_25 FIXED DEC(5)      INIT(0),
       2 OO_CREAT_26 FIXED DEC(5)      INIT(0),
       2 OO_CREAT_27 FIXED DEC(5)      INIT(0),
       2 OO_CREAT_28 FIXED DEC(5)      INIT(0);



1/******************************************************************/


 DCL HIGH_VAL        CHAR(44)     INIT((44)'9');   /* ON EOF INSCR */
 DCL HIGH_VAL121     CHAR(44)     INIT((44)'9');   /* ON EOF HIST  */

 DCL IS_HOLD         CHAR(44)     INIT(' '),       /* HOLD FOR CHK */
     IL_HOLD         CHAR(44)     INIT(' '),       /* HOLD FOR CHK */
     IH_HOLD         CHAR(44)     INIT(' ');       /* HOLD FOR CHK */

 DCL (READ_FLAG,HOLD_FLAG,LOOP_FLAG,GDG_FLAG)  /* HIST FLAGES */
                     BIT(1)   INIT('0'B);

 DCL     H_EXT_01   BIT(272)          INIT((272)'0'B); /* EXT HOLD */

 DCL L             FIXED BIN(15) INIT(0),
     M             FIXED BIN(15) INIT(0),
     COUNT_FG      FIXED BIN(15) INIT(0),
     COUNT_NW      FIXED BIN(15) INIT(0);

 DCL DUMP          FIXED BIN(31,0) INIT(1024),     /* ABEND DUMP   */
     CODE          FIXED BIN(31,0) INIT(1024);     /* ABEND ASCEND */

 DCL ERR_CNT       FIXED BIN(15) INIT(0),          /* NO MATCH ERR */
       T_CNT       FIXED BIN(15) INIT(0);          /* NO MATCH ERR */

 DCL NO_ACEND      FIXED BIN(15) INIT(0);          /* ERR ON ASCEND*/

 /******************************************************************/
1/*----------------------------------------------------------------*/
 /*  OPEN AND CHECK FOR EOF -                                      */
 /*----------------------------------------------------------------*/
     ON ENDFILE(INLOG)   GO TO EOF20;              /* EOF F020     */
     ON ENDFILE(INSCR)   GO TO EOF15;              /* EOF F015     */
     ON ENDFILE(INHIST)  GO TO EOFHIST;            /* EOF F120     */
     OPEN FILE (INLOG) INPUT ,
          FILE (INSCR) INPUT ,
          FILE (NEWSCR) OUTPUT,
          FILE (INHIST) INPUT ,
          FILE (OUTHIST) OUTPUT;


 /*----------------------------------------------------------------*/
 /*  READ SCRATCH HEADER - WRITE NEW SCRATCH HEADER CARD           */
 /*----------------------------------------------------------------*/
     READ FILE(INSCR)  INTO (SCRPARM);    /* READ INSCR DATE RECORD*/
     IF SCR_HEAD ^= 'SCRATCH='            /* IS THIS A HEADER CARD */
         THEN GO TO ERRHEAD;              /* NO THEN ABEND         */
      SCR_DATE = RUN_DATE            ;  /* CREATE NOW SCR DATE CARD*/
     WRITE FILE(NEWSCR) FROM(SCRPARM);  /* WRITE OUTPUT-NEWSCR DATE*/
 /*----------------------------------------------------------------*/
 /* CHECK LOG DATASET FOR OK TO SCRATCH RECORD                     */
 /*----------------------------------------------------------------*/
 LOG:
     CALL READLOG  ;                      /* READ DATASET          */

     IF  SCRFLAG  =  'S'  THEN            /* DATASET MUST BE       */
        DO;                               /*  FLAGED FOR SCRATCH   */
          IF  UCAT     =  'C'   ×        /* IS DS UNCATALOGED  OR */

              DAYS_UNUSED > 6   ×        /* IS DS UNUSED       OR */

              RETPD    =  'R'            /* IS DS PAST RETPD  THEN*/

              THEN  GO TO SCR;           /* THEN SCRATCH IT       */
        END;
     CALL HIST;                                 /*CALL HIST UPDATE*/
      GO TO LOG;                            /* NO GO - TRY AGAIN   */

1/*----------------------------------------------------------------*/
 /* FOUND DSNAME TO SCRATCH NOW MATCH TO IN SCRATCH DATASET        */
 /*----------------------------------------------------------------*/
 SCR:
     IF ERR_CNT  >  0   THEN              /* CHECK FOR READ ERROR  */
              ERR_CNT =  0;
      ELSE
              CALL  READSCR   ;              /* OK READ SCR        */

     IF  DSNAME     <  IS_DSN  THEN  GO  TO  WRTERR; /*NO SCR CARD */
     IF  DSNAME     =  IS_DSN                        /*SCR NOW     */
             &
         VOLUME      =  IS_VOL
            THEN  DO;
                N_DSN      =   IS_DSN     ;          /* MOVE WRITE */
                N_VOL      =   IS_VOL     ;
                N_FLAG     =   IS_FLAG    ;
                N_BILLTO   =   IS_BILLTO  ;
                N_LASTUSE  =   IS_LASTUSE ;
                N_USER     =   IS_USER    ;
                N_DEVICE   =   IS_DEVICE  ;
                WRITE FILE(NEWSCR) FROM(NEW_REC);
                GO TO LOG;                           /*DONE DID IT */
               END;
       GO TO SCR;
 /*----------------------------------------------------------------*/
 /* WRITE ERROR                                                    */
 /*----LOG SCR HAS NO MATCH ON IN-SCR CARD PUT TO SYSOUT-----------*/
 /*----------------------------------------------------------------*/
 WRTERR:

     PUT FILE(SYSPRINT) EDIT(' DSN=',DSNAME,' VOL=',
       VOLUME,' NOT FOUND IN SCRATCH CARD DATASET  F015')
           (SKIP(2),X(5),A,A(44),A,A(6),A);
       ERR_CNT = ERR_CNT + 1  ;
       T_CNT = T_CNT + 1  ;
    IF T_CNT = 20 THEN GO TO EOJ;
       GO TO LOG;                              /* LOOP TRY AGAIN  */

1/*----------------------------------------------------------------*/
 /* READ SCRATCH DATASET CHECK FOR ASCENDING ORDER                 */
 /*----------------------------------------------------------------*/
 READSCR: PROC;
 READ15:

     READ FILE(INSCR) INTO (IN_SCR);      /* READ SCRATCH  RECORD  */

     IF IS_DSN  <  IS_HOLD  THEN          /* CHECK IF ASCENDING    */
              GO  TO  ERRF15;             /* NO GO - ABEND         */

     IS_HOLD  =  IS_DSN;                  /* LOOKS GOOD            */

 END READSCR;
 /*----------------------------------------------------------------*/
 /* READ LOG DATASET CHECK FOR ASCENDING ORDER                     */
 /*----------------------------------------------------------------*/
 READLOG: PROC;
 READ20:

     READ FILE(INLOG) INTO (IN_LOG);      /* READ LOG RECORD       */

     IF DSNAME  <  IL_HOLD  THEN          /* CHECK IF ASCENDING    */
              GO  TO  ERRF20;             /* NO GO - ABEND         */

     IL_HOLD  =  DSNAME;                  /* LOOKS GOOD            */

 END READLOG;
1/*----------------------------------------------------------------*/
 /* END OF FILE INLOG - CHECK EOF INSCR - NO READ REST INSCR       */
 /*----------------------------------------------------------------*/
 EOF15:
     IF DSNAME = HIGH_VAL   THEN          /* CHECK INLOG EOF       */
           GO TO EOJ;

     IS_DSN     =  HIGH_VAL   ;           /* MOVE HIGH VALUE TO SCR*/
           GO TO WRTERR ;                 /* WRT ERROR-NO MATCH F20*/

 /*----------------------------------------------------------------*/
 /* END OF FILE INLOG - CHECK EOF INSCR - NO READ REST INSCR       */
 /*----------------------------------------------------------------*/
 EOF20:


     IF IS_DSN = HIGH_VAL   THEN          /* CHECK INSCR EOF       */
           GO TO EOJ;

     DSNAME     =  HIGH_VAL   ;
           GO TO SCR   ;              /* READ REST OF SCR CARDS */

1/*----------------------------------------------------------------*/
 /* IN SCR FILE NOT ASCENDING DISPLAY                              */
 /*----------------------------------------------------------------*/
 ERRF15:
     NO_ACEND  =  1 ;
     DISPLAY('** ABEND ******** DMPTRN01 ************* ABEND **');
     DISPLAY('                                                 ');
     DISPLAY('**** F115 SCR NOT ASCENDING - CALL SPACEMAN *****');
     DISPLAY('                                                 ');
     DISPLAY('*************************************************');
     GO TO EOJ;                                        /* GO ABEND */

 /*----------------------------------------------------------------*/
 /* IN LOG FILE NOT ASCENDING DISPLAY                              */
 /*----------------------------------------------------------------*/
 ERRF20:
     NO_ACEND  =  1 ;
     DISPLAY('** ABEND ******** DMPTRN01 ************* ABEND **');
     DISPLAY('                                                 ');
     DISPLAY('**** F120 LOG NOT ASCENDING - CALL SPACEMAN *****');
     DISPLAY('                                                 ');
     DISPLAY('*************************************************');
     GO TO EOJ;                                        /* GO ABEND */

 /*----------------------------------------------------------------*/
 /* IN SCR FILE NO HEADER DATE CARD FOUND                          */
 /*----------------------------------------------------------------*/
 ERRHEAD:
     NO_ACEND  =  1 ;
     DISPLAY('** ABEND ******** DMPTRN01 ************* ABEND **');
     DISPLAY('                                                 ');
     DISPLAY('** SCRATCH CARD HEADER NO FOUND - CALL SPACEMAN *');
     DISPLAY('                                                 ');
     DISPLAY('*************************************************');
     GO TO EOJ;                                        /* GO ABEND */

1/*----------------------------------------------------------------*/
 /*  UPDATE TO XMITSCR ON AUG 01, 1979 BY BILL WILLIAMS TO PROVIDE */
 /*  A HISTORY FILE OF ALL XMIT DATASETS. THE HIST FILE HOLDS THE  */
 /*  LAST 27 ALOCATIONS ( TRACKS ALLOC, TRACKS USED, EXTENTS USED, */
 /*  AND DATE MODIFIED OR CREATED.  NOTE THIS HISTORY FILE ONLY    */
 /*  HOLDS DATASETS ON MSVGP XMIT.                                 */
 /*----------------------------------------------------------------*/

 HIST: PROC;
 HIST_ORY:

 IF READ_FLAG  = '0'B  THEN  CALL  READHIS;  /* READ INPUT HIST */

 LOOP_FLAG  =  '0'B;                   /* SET FLAGS - TO ZERO */
 GDG_FLAG  =  '0'B;
 DO  L  =  44  TO  1  BY - 1;         /*SET UP FOR POINTER     */
 IF  SUBSTR(DSNAME,L - 6,2)  =  '.G'  /*  AND  A GDG           */
        &
     SUBSTR(DSNAME,L,3)     =  'V00'
     THEN  DO;
         GDG_FLAG  =  '1'B;                   /* FOUND GDG SET FLAG*/
         M  =  L - 5;
         DSNAME     =  SUBSTR(DSNAME,1,M)  ××  '*';
     END;                       /* DATASET NAME ONLY - NO GOOGOO */
 END;
 DO  L  =  44  TO  1  BY - 1;         /*SET UP FOR POINTER     */
 IF  SUBSTR(DSNAME,L - 7,2)  =  '.D'  /*  AND  A DATE STAMP    */
        &
     SUBSTR(DSNAME,L,2)     =  '.T'   /*  AND A TIME STAMP     */
     THEN  DO;
         GDG_FLAG  =  '1'B;           /* FOUND DATE SET FLAG */
         M  =  L - 6;
         DSNAME     =  SUBSTR(DSNAME,1,M)  ××  '*';
     END;                       /* DATASET NAME ONLY - NO GOOGOO */
 END;

 IF  DSNAME   =   II_DSNAME        /* LOG = HIST INPUT */
   THEN  DO;
       IF (  CREATED   >  II_CREAT_01 )      ×  /* IS IT UPDATE*/
          (  LAST_MOD  >  II_CREAT_01 )
         THEN  DO;
             IF COUNT_NW  > 0        /* IS IT NEW */
               THEN  DO;
                   COUNT_NW = 0;     /* YES WRITE */
                   CALL WRT_OUT;
               END;
             COUNT_FG  =  COUNT_FG + 1;    /* FOUND UPDATE FROM LOG */
             CALL MV_DW;                   /* UPDATE OUT HISTORY */
             READ_FLAG  =  '1'B;           /* DONT READ HISTORY */
             RETURN;                       /* RETURN TO READ NEXT LOG*/
         END;
         ELSE  DO;
             IF COUNT_NW  > 0              /* NO UPDATE FROM LOG BUT */
               THEN  DO;                   /* NEW DATASET FROM LOG   */
                   COUNT_NW = 0;           /* ZERO OUT FLAG          */
                   CALL WRT_OUT;           /* WRITE NEW RECORD       */
               END;
             READ_FLAG  =  '1'B;           /* OLD RECORD RETURN TO   */
             RETURN;                       /* READ NEXT LOG RECORD   */
         END;
   END;


 IF  DSNAME   >   II_DSNAME              /* LOG GREATER THAN IN HIST */
   THEN  DO;
       LOOP_FLAG  =  '1'B;               /* ZERO FLAGS               */
       READ_FLAG  =  '0'B;
       IF    COUNT_NW  >  0              /* IS NEW FLAG ON           */
         THEN  DO;
             CALL WRT_OUT;               /* YES WRITE IT             */
             COUNT_NW   =   0;
         END;
       IF    COUNT_FG  >  0              /* IS OLD FLAG ON           */
         THEN  DO;
             CALL WRT_OUT;               /* YES WRITE IT             */
             COUNT_FG   =   0;
         END;
         ELSE  DO;                       /* OLD FLAG NOT ON MUST BE  */
             CALL WRT_IN;                /* NO UPDATE FOR THIS RECORD*/
         END;
   END;


 IF  DSNAME   <   II_DSNAME             /* IS LOG LT HIST   */
   THEN  DO;
       IF DSNAME  =  OO_DSNAME          /* IF LOG = OUT HIST */
         THEN  DO;
             CALL MV_DW;                 /* MOVE IT TO OUTPUT */
             READ_FLAG  =  '1'B;           /* DONT READ HIST  */
             COUNT_NW  =  COUNT_NW + 1;    /* MUST BE NEW     */
         END;
         ELSE  DO;
             IF COUNT_NW > 0              /* IF NEW ON WRITE IT */
               THEN  DO;
                   CALL WRT_OUT;
                   COUNT_NW   =   0;
               END;
             CALL MV_NW;                  /* CREATE NEW HIST REC */
             READ_FLAG  =  '1'B;
             COUNT_NW  =  COUNT_NW + 1;
             LOOP_FLAG  =  '0'B;
         END;
   END;
 /******************************************************************/

   IF LOOP_FLAG  =  '1'B                  /* IF LOOP GO BACK TO READ */
     THEN GO TO HIST_ORY;

 /******************************************************************/

  RETURN;
 END HIST;
1/*----------------------------------------------------------------*/
 /*                                                                */
 /*----------------------------------------------------------------*/

 MV_DW: PROC;

     IF HOLD_FLAG   =   '0'B      /* FIRST TIME FOUND - MOVE INPUT */
       THEN DO;                   /* TO OUPUT AND UPDATE WITH LOG  */
        OO_DSNAME   =   DSNAME   ;    /* THEN SET HOLD FLAG ON     */
        OO_MSVGP    =   MSVGP    ;
        OO_USER     =   MOD_USER ;
        OO_ORG      =   DSORG    ;
        OO_ALLOC_28 =   II_ALLOC_28 + TRK_ALLOC  ;
        OO_ALLOC_28 =   OO_ALLOC_28 - II_ALLOC_27;
        OO_USED_28  =   II_USED_28  + TRK_USED   ;
        OO_USED_28  =   OO_USED_28  - II_USED_27 ;
        OO_EXT      =   EXTNTS     ×× SUBSTR(II_EXT,1,272);
        OO_ALLOC_27 =   II_ALLOC_26;
        OO_ALLOC_26 =   II_ALLOC_25;
        OO_ALLOC_25 =   II_ALLOC_24;
        OO_ALLOC_24 =   II_ALLOC_23;
        OO_ALLOC_23 =   II_ALLOC_22;
        OO_ALLOC_22 =   II_ALLOC_21;
        OO_ALLOC_21 =   II_ALLOC_20;
        OO_ALLOC_20 =   II_ALLOC_19;
        OO_ALLOC_19 =   II_ALLOC_18;
        OO_ALLOC_18 =   II_ALLOC_17;
        OO_ALLOC_17 =   II_ALLOC_16;
        OO_ALLOC_16 =   II_ALLOC_15;
        OO_ALLOC_15 =   II_ALLOC_14;
        OO_ALLOC_14 =   II_ALLOC_13;
        OO_ALLOC_13 =   II_ALLOC_12;
        OO_ALLOC_12 =   II_ALLOC_11;
        OO_ALLOC_11 =   II_ALLOC_10;
        OO_ALLOC_10 =   II_ALLOC_09;
        OO_ALLOC_09 =   II_ALLOC_08;
        OO_ALLOC_08 =   II_ALLOC_07;
        OO_ALLOC_07 =   II_ALLOC_06;
        OO_ALLOC_06 =   II_ALLOC_05;
        OO_ALLOC_05 =   II_ALLOC_04;
        OO_ALLOC_04 =   II_ALLOC_03;
        OO_ALLOC_03 =   II_ALLOC_02;
        OO_ALLOC_02 =   II_ALLOC_01;
        OO_USED_27  =   II_USED_26 ;
        OO_USED_26  =   II_USED_25 ;
        OO_USED_25  =   II_USED_24 ;
        OO_USED_24  =   II_USED_23 ;
        OO_USED_23  =   II_USED_22 ;
        OO_USED_22  =   II_USED_21 ;
        OO_USED_21  =   II_USED_20 ;
        OO_USED_20  =   II_USED_19 ;
        OO_USED_19  =   II_USED_18 ;
        OO_USED_18  =   II_USED_17 ;
        OO_USED_17  =   II_USED_16 ;
        OO_USED_16  =   II_USED_15 ;
        OO_USED_15  =   II_USED_14 ;
        OO_USED_14  =   II_USED_13 ;
        OO_USED_13  =   II_USED_12 ;
        OO_USED_12  =   II_USED_11 ;
        OO_USED_11  =   II_USED_10 ;
        OO_USED_10  =   II_USED_09 ;
        OO_USED_09  =   II_USED_08 ;
        OO_USED_08  =   II_USED_07 ;
        OO_USED_07  =   II_USED_06 ;
        OO_USED_06  =   II_USED_05 ;
        OO_USED_05  =   II_USED_04 ;
        OO_USED_04  =   II_USED_03 ;
        OO_USED_03  =   II_USED_02 ;
        OO_USED_02  =   II_USED_01 ;
        OO_CREAT_28 =   II_CREAT_27;
        OO_CREAT_27 =   II_CREAT_26;
        OO_CREAT_26 =   II_CREAT_25;
        OO_CREAT_25 =   II_CREAT_24;
        OO_CREAT_24 =   II_CREAT_23;
        OO_CREAT_23 =   II_CREAT_22;
        OO_CREAT_22 =   II_CREAT_21;
        OO_CREAT_21 =   II_CREAT_20;
        OO_CREAT_20 =   II_CREAT_19;
        OO_CREAT_19 =   II_CREAT_18;
        OO_CREAT_18 =   II_CREAT_17;
        OO_CREAT_17 =   II_CREAT_16;
        OO_CREAT_16 =   II_CREAT_15;
        OO_CREAT_15 =   II_CREAT_14;
        OO_CREAT_14 =   II_CREAT_13;
        OO_CREAT_13 =   II_CREAT_12;
        OO_CREAT_12 =   II_CREAT_11;
        OO_CREAT_11 =   II_CREAT_10;
        OO_CREAT_10 =   II_CREAT_09;
        OO_CREAT_09 =   II_CREAT_08;
        OO_CREAT_08 =   II_CREAT_07;
        OO_CREAT_07 =   II_CREAT_06;
        OO_CREAT_06 =   II_CREAT_05;
        OO_CREAT_05 =   II_CREAT_04;
        OO_CREAT_04 =   II_CREAT_03;
        OO_CREAT_03 =   II_CREAT_02;
        OO_CREAT_02 =   II_CREAT_01;
        HOLD_FLAG   =   '1'B     ;
        END;
       ELSE DO;                    /* NOT ON MOVE OUT TO OUT AND LOG */
        OO_DSNAME   =   DSNAME   ;     /* TO OUTPUT                  */
        OO_USER     =   MOD_USER ;
        OO_ALLOC_28 =   OO_ALLOC_28 + TRK_ALLOC  ;
        OO_ALLOC_28 =   OO_ALLOC_28 - OO_ALLOC_27;
        OO_USED_28  =   OO_USED_28  + TRK_USED   ;
        OO_USED_28  =   OO_USED_28  - OO_USED_27 ;
        OO_EXT      =   EXTNTS     ×× SUBSTR(OO_EXT,1,272);
        OO_ALLOC_27 =   OO_ALLOC_26;
        OO_ALLOC_26 =   OO_ALLOC_25;
        OO_ALLOC_25 =   OO_ALLOC_24;
        OO_ALLOC_24 =   OO_ALLOC_23;
        OO_ALLOC_23 =   OO_ALLOC_22;
        OO_ALLOC_22 =   OO_ALLOC_21;
        OO_ALLOC_21 =   OO_ALLOC_20;
        OO_ALLOC_20 =   OO_ALLOC_19;
        OO_ALLOC_19 =   OO_ALLOC_18;
        OO_ALLOC_18 =   OO_ALLOC_17;
        OO_ALLOC_17 =   OO_ALLOC_16;
        OO_ALLOC_16 =   OO_ALLOC_15;
        OO_ALLOC_15 =   OO_ALLOC_14;
        OO_ALLOC_14 =   OO_ALLOC_13;
        OO_ALLOC_13 =   OO_ALLOC_12;
        OO_ALLOC_12 =   OO_ALLOC_11;
        OO_ALLOC_11 =   OO_ALLOC_10;
        OO_ALLOC_10 =   OO_ALLOC_09;
        OO_ALLOC_09 =   OO_ALLOC_08;
        OO_ALLOC_08 =   OO_ALLOC_07;
        OO_ALLOC_07 =   OO_ALLOC_06;
        OO_ALLOC_06 =   OO_ALLOC_05;
        OO_ALLOC_05 =   OO_ALLOC_04;
        OO_ALLOC_04 =   OO_ALLOC_03;
        OO_ALLOC_03 =   OO_ALLOC_02;
        OO_ALLOC_02 =   OO_ALLOC_01;
        OO_USED_27  =   OO_USED_26 ;
        OO_USED_26  =   OO_USED_25 ;
        OO_USED_25  =   OO_USED_24 ;
        OO_USED_24  =   OO_USED_23 ;
        OO_USED_23  =   OO_USED_22 ;
        OO_USED_22  =   OO_USED_21 ;
        OO_USED_21  =   OO_USED_20 ;
        OO_USED_20  =   OO_USED_19 ;
        OO_USED_19  =   OO_USED_18 ;
        OO_USED_18  =   OO_USED_17 ;
        OO_USED_17  =   OO_USED_16 ;
        OO_USED_16  =   OO_USED_15 ;
        OO_USED_15  =   OO_USED_14 ;
        OO_USED_14  =   OO_USED_13 ;
        OO_USED_13  =   OO_USED_12 ;
        OO_USED_12  =   OO_USED_11 ;
        OO_USED_11  =   OO_USED_10 ;
        OO_USED_10  =   OO_USED_09 ;
        OO_USED_09  =   OO_USED_08 ;
        OO_USED_08  =   OO_USED_07 ;
        OO_USED_07  =   OO_USED_06 ;
        OO_USED_06  =   OO_USED_05 ;
        OO_USED_05  =   OO_USED_04 ;
        OO_USED_04  =   OO_USED_03 ;
        OO_USED_03  =   OO_USED_02 ;
        OO_USED_02  =   OO_USED_01 ;
        OO_CREAT_28 =   OO_CREAT_27;
        OO_CREAT_27 =   OO_CREAT_26;
        OO_CREAT_26 =   OO_CREAT_25;
        OO_CREAT_25 =   OO_CREAT_24;
        OO_CREAT_24 =   OO_CREAT_23;
        OO_CREAT_23 =   OO_CREAT_22;
        OO_CREAT_22 =   OO_CREAT_21;
        OO_CREAT_21 =   OO_CREAT_20;
        OO_CREAT_20 =   OO_CREAT_19;
        OO_CREAT_19 =   OO_CREAT_18;
        OO_CREAT_18 =   OO_CREAT_17;
        OO_CREAT_17 =   OO_CREAT_16;
        OO_CREAT_16 =   OO_CREAT_15;
        OO_CREAT_15 =   OO_CREAT_14;
        OO_CREAT_14 =   OO_CREAT_13;
        OO_CREAT_13 =   OO_CREAT_12;
        OO_CREAT_12 =   OO_CREAT_11;
        OO_CREAT_11 =   OO_CREAT_10;
        OO_CREAT_10 =   OO_CREAT_09;
        OO_CREAT_09 =   OO_CREAT_08;
        OO_CREAT_08 =   OO_CREAT_07;
        OO_CREAT_07 =   OO_CREAT_06;
        OO_CREAT_06 =   OO_CREAT_05;
        OO_CREAT_05 =   OO_CREAT_04;
        OO_CREAT_04 =   OO_CREAT_03;
        OO_CREAT_03 =   OO_CREAT_02;
        OO_CREAT_02 =   OO_CREAT_01;
        END;


        OO_ALLOC_01 =   TRK_ALLOC  ;
        OO_USED_01  =   TRK_USED   ;
        IF  CREATED > LAST_MOD            /* MOVE LATEST DATE */
           THEN  OO_CREAT_01  =  CREATED ;
           ELSE  OO_CREAT_01  =  LAST_MOD;

  RETURN;
 END MV_DW;

1/*----------------------------------------------------------------*/
 /*   CREATE NEW RECORD IN HISTORY FILE                            */
 /*----------------------------------------------------------------*/

 MV_NW: PROC;     /* NEW DATASET -- CREATE RECORD */

        OO_DSNAME   =   DSNAME   ;
        OO_MSVGP    =   MSVGP    ;
        OO_USER     =   MOD_USER ;
        OO_ORG      =   DSORG    ;
        HOLD_FLAG   =   '1'B     ;
        H_EXT_01    =   '0'B     ;
        OO_ALLOC_02 =    0       ;
        OO_ALLOC_03 =    0       ;
        OO_ALLOC_04 =    0       ;
        OO_ALLOC_05 =    0       ;
        OO_ALLOC_06 =    0       ;
        OO_ALLOC_07 =    0       ;
        OO_ALLOC_08 =    0       ;
        OO_ALLOC_09 =    0       ;
        OO_ALLOC_10 =    0       ;
        OO_ALLOC_11 =    0       ;
        OO_ALLOC_12 =    0       ;
        OO_ALLOC_13 =    0       ;
        OO_ALLOC_14 =    0       ;
        OO_ALLOC_15 =    0       ;
        OO_ALLOC_16 =    0       ;
        OO_ALLOC_17 =    0       ;
        OO_ALLOC_18 =    0       ;
        OO_ALLOC_19 =    0       ;
        OO_ALLOC_20 =    0       ;
        OO_ALLOC_21 =    0       ;
        OO_ALLOC_22 =    0       ;
        OO_ALLOC_23 =    0       ;
        OO_ALLOC_24 =    0       ;
        OO_ALLOC_25 =    0       ;
        OO_ALLOC_26 =    0       ;
        OO_ALLOC_27 =    0       ;
        OO_ALLOC_28 =    0       ;
        OO_USED_02  =    0       ;
        OO_USED_03  =    0       ;
        OO_USED_04  =    0       ;
        OO_USED_05  =    0       ;
        OO_USED_06  =    0       ;
        OO_USED_07  =    0       ;
        OO_USED_08  =    0       ;
        OO_USED_09  =    0       ;
        OO_USED_10  =    0       ;
        OO_USED_11  =    0       ;
        OO_USED_12  =    0       ;
        OO_USED_13  =    0       ;
        OO_USED_14  =    0       ;
        OO_USED_15  =    0       ;
        OO_USED_16  =    0       ;
        OO_USED_17  =    0       ;
        OO_USED_18  =    0       ;
        OO_USED_19  =    0       ;
        OO_USED_20  =    0       ;
        OO_USED_21  =    0       ;
        OO_USED_22  =    0       ;
        OO_USED_23  =    0       ;
        OO_USED_24  =    0       ;
        OO_USED_25  =    0       ;
        OO_USED_26  =    0       ;
        OO_USED_27  =    0       ;
        OO_USED_28  =    0       ;
        OO_CREAT_02 =    0       ;
        OO_CREAT_03 =    0       ;
        OO_CREAT_04 =    0       ;
        OO_CREAT_05 =    0       ;
        OO_CREAT_06 =    0       ;
        OO_CREAT_07 =    0       ;
        OO_CREAT_08 =    0       ;
        OO_CREAT_09 =    0       ;
        OO_CREAT_10 =    0       ;
        OO_CREAT_11 =    0       ;
        OO_CREAT_12 =    0       ;
        OO_CREAT_13 =    0       ;
        OO_CREAT_14 =    0       ;
        OO_CREAT_15 =    0       ;
        OO_CREAT_16 =    0       ;
        OO_CREAT_17 =    0       ;
        OO_CREAT_18 =    0       ;
        OO_CREAT_19 =    0       ;
        OO_CREAT_20 =    0       ;
        OO_CREAT_21 =    0       ;
        OO_CREAT_22 =    0       ;
        OO_CREAT_23 =    0       ;
        OO_CREAT_24 =    0       ;
        OO_CREAT_25 =    0       ;
        OO_CREAT_26 =    0       ;
        OO_CREAT_27 =    0       ;
        OO_CREAT_28 =    0       ;


        OO_EXT      =   EXTNTS     ××  H_EXT_01;
        OO_ALLOC_01 =   TRK_ALLOC  ;
        OO_USED_01  =   TRK_USED   ;
        OO_CREAT_01 =   CREATED    ;
        OO_ALLOC_28 =   TRK_ALLOC  ;
        OO_USED_28  =   TRK_USED   ;

  RETURN;
 END MV_NW;

 /*----------------------------------------------------------------*/
 /* WRITE OUTPUT FROM INPUT -- NO UPDAT ON THIS RECORD             */
 /*----------------------------------------------------------------*/
 WRT_IN: PROC;
 WRITEI:

        WRITE FILE(OUTHIST) FROM(IN_HI);

  RETURN;
 END WRT_IN ;
 /*----------------------------------------------------------------*/
 /* WRITE OUTPUT WITH UPDATE OR MAY BE A NEW RECORD                */
 /*----------------------------------------------------------------*/
 WRT_OUT: PROC;
 WRITEO:

        WRITE FILE(OUTHIST) FROM(OUT_HI);
        HOLD_FLAG  =  '0'B;

  RETURN;
 END WRT_OUT ;
 /*----------------------------------------------------------------*/
 /* READ LOG DATASET CHECK FOR ASCENDING ORDER                     */
 /*----------------------------------------------------------------*/
 READHIS: PROC;
 READ28:


     IF II_DSNAME = HIGH_VAL121
       THEN RETURN;


     READ FILE(INHIST) INTO (IN_HI);     /* READ HISTORY RECORD   */

     IF II_DSNAME < IH_HOLD THEN          /* CHECK IF ASCENDING    */
          GO TO  ERRF120;               /* NO GO - ABEND         */

     IH_HOLD  =  II_DSNAME;               /* LOOKS GOOD            */

  RETURN;
 END READHIS ;
 /*----------------------------------------------------------------*/
 /* ON EOF HISTORY CHECK LOG IF OK EOJ                             */
 /*----------------------------------------------------------------*/
 EOFHIST:

     IF DSNAME = HIGH_VAL
       THEN DO;
          GO TO EOF20;
       END;

     II_DSNAME =  HIGH_VAL121;

          READ_FLAG  =  '1'B;
          GO TO SCR;

 /*----------------------------------------------------------------*/
 /* IN HIS FILE NOT ASCENDING DISPLAY                              */
 /*----------------------------------------------------------------*/
 ERRF120:
     DISPLAY('*                                               *');
     DISPLAY('*   FILE FCI1.A00963.F0963.F121.G0000V000       *');
     DISPLAY('*   HISTORY NOT ASCENDING                       *');
     DISPLAY('*             CALL SPACEMAN                     *');
     DISPLAY('*                                               *');
1/*----------------------------------------------------------------*/
 /* THATS IT CLOSE IT DOWN  -  CHECK CONDITION                     */
 /*----------------------------------------------------------------*/
 EOJ:

        CLOSE FILE (INSCR),
              FILE (INLOG),
              FILE (NEWSCR),
              FILE (INHIST),
              FILE (OUTHIST);



        IF  NO_ACEND  =  1  THEN                       /* IF ABEND */
              CALL ABEND(DUMP,CODE);                   /*THEN ABEND*/

 END P963P75 ;                         /* END OF MAIN PROGRAM */

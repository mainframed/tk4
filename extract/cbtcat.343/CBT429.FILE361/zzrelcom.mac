         MACRO
&NAME    ZZRELCOM
         TITLE 'Z Z R E L C O M  -  ZZRELINK COMMUNICATIONS AREA'
**********       C O M M U N I C A T I O N    A R E A        **********
**********               Z Z R E L I N K                     **********
*
* THE FOLLOWING DESCRIPTION IS FOR ZZRELINK.
* IT IS BASICALLY THE SAME FOR THE IEBCOPY PROCEDURE EXCEPT THAT
* IT DOES NOT GO THROUGH ALL THE SORTING STEPS. IT ALSO DOES NOT BUILD
* MULTIPLE DD TABLES AND IT DOES NOT ALLOW FOR RENAMES.
*
         SPACE 2
         SPACE 2
* ABBREVIATIONS USED FREQUENTLY -
*        ODE = OUTPUT DIRECTORY ENTRY
*        IDE = INPUT DIRECTORY ENTRY
         SPACE 2
*
* SETAB = SELECT/EXCLUDE TABLE
*        THE SETAB CONSISTS OF 10-BYTE ENTRIES.  ENTRIES ARE MADE TO
*        THIS TABLE WHEN -
*              1) A SELECTIVE LINK HAS BEEN SPECIFIED.  EACH ENTRY IS
*              FOR THE NAME OF A MEMBER TO BE SELECTED.  IF A MEMBER IS
*              TO BE RENAMED, TWO 10-BYTE ENTRIES ARE MADE IN THE SETAB
*              2) AN EXCLUSIVE LINK HAS BEEN SPECIFIED.  EACH ENTRY IS
*              FOR THE NAME OF A MEMBER TO BE EXCLUDED.
*        NOTE- IN THE CASE OF A SELECTIVE LINK (AND ONLY IN THIS CASE),
*              THE SETAB WILL ALSO BE USED AS THE CTLTAB.  IN ALL OTHER
*              CASES, A SEPARATE CTLTAB WILL BE CONSTRUCTED.
*        BYTE 0 OF AN ENTRY IS DESIGNATED AS SEFLAG1.  WITHIN THIS BYTE
*        THE FOLLOWING BITS HAVE MEANING -
SEBIT1   EQU   X'80' ON=THIS IS A NEWNAME ENTRY
SEBIT2   EQU   X'40' ON=THIS IS A RENAMED ENTRY
SEBIT3   EQU   X'20' ON=REPLACE OPTION WAS SPECIFIED FOR THIS MEMBER
SEBIT4   EQU   X'10' ON=DONTLINK FLAG...DO NOT PROCESS THIS ENTRY
SEBIT5   EQU   X'08' ON= THIS MEMBER HAS BEEN ''FOUND'' ON INPUT D.S.
SEBIT6   EQU   X'04' ON= THIS IS LAST ENTRY IN SETAB/CTLTAB
*        LO ORDER 2 BITS NOT USED
*        NOTE THE DEFINITION OF SEBIT3.  IF, IN THE INDD TABLE, BYTE 0
*              BIT 2 IS ON, THIS MEANS THAT THE REPLACE OPTION WAS SPE-
*              CIFIED FOR ALL MEMBERS COPIED FROM THIS INDD.  IT IS
*              VALID FOR BOTH OF THESE BITS TO BE ON AT THE SAME TIME,
*              ALTHOUGH IF THE BIT IS ON IN THE INDD TABLE, IT IS UN-
*              NECESSARY FOR SEBIT3 TO ALSO BE ON IN THE SETAB.
         EJECT
* FOLLOWING IS A DESCRIPTION OF THE CONTROL TABLE -CTLTAB-
* (REMEMBER THAT THIS TABLE IS PHYSICALLY THE SAME TABLE AS SETAB WHEN
* A SELECTIVE LINK OPERATION IS SPECIFIED, BUT IS PHYSICALLY INDEPEN-
* DENT AND DISTINCT FROM THE SETAB FOR AN EXCLUSIVE LINK OPERATION.
* THERE IS NO SETAB FOR A FULL LINK OPERATION, AND THE CTLTAB IN THIS
* CASE IS CONSTRUCTED SIMILARLY TO WHEN AN EXCLUSIVE LINK IS SPECIFIED.
* SINCE THE SETAB AND CTLTAB ARE ONE AND THE SAME FOR A SEL. LINK, THIS
*  DESCRIPTION WILL ASSUME THAT A SELECTIVE LINK IS BEING DONE, FOR THE
*  PURPOSE OF SETTING UP THE TABLE INITIALLY.)....
         SPACE 2
*        INITIAL TABLE, FOLLOWING CCSCAN PROCESSING OF ''SELECT'' -
***********************************************************************
*SEFLAG1 *SEFLAG2 * NAME OF MEMBER TO BE SELECTED, OR, IF SPECIFIED,  *
*(DESCR. *(UNUSED)* NEWNAME.  IF NEWNAME WAS SPECIFIED, THE TABLE WILL*
* ABOVE) *        * CONTAIN 1 ENTRY FOR OLDNAME AND ANOTHER FOR NEW.  *
***********************************************************************
* 1 BYTE * 1 BYTE *----------------------8 BYTES----------------------*
         SPACE 2
* OLDNAME/NEWNAME PAIRS ARE NOW EXTRACTED FROM THE SETAB.  THEN THE
* CTLTAB IS SORTED ALPH. BY MBRNAME, AND A NEWNAME PTRTABLE SET UP.
* WHEN THIS HAS BEEN DONE, THE INPUT DATA SET'S DIRECTORY IS SEARCHED
* FOR MATCHING NAMES (THE NEWNAME ENTRIES IN THE TABLE ARE NOT USED FOR
* THIS COMPARISON).  WHEN A MATCHING MEMBERNAME IS FOUND, THE DIRECTORY
* ENTRY IS RETAINED IN CORE (IF SPACE PERMITS), OR IT IS SPILLED ONTO
* SYSUT3.  IN EITHER CASE, THE CORE ADDRESS OR THE TTR+INDICATOR ARE
* PUT INTO THE CTLTAB, OVERLAYING THE HIGH-ORDER 4 BYTES OF 'OLDNAME'.
* THE MEMBER-TTR IS EXTRACTED FROM THE DIRECTORY ENTRY, AND OVERLAYS
* THE LOW-ORDER 4 BYTES OF 'OLDNAME' IN THE CTLTAB.  SEBIT5 IS TURNED
* ON.  IF THIS IS AN ALIAS ENTRY, SEFLAG2 IS SET AS FOLLOWS -
ALIAS    EQU   X'80'         TO TEST FOR AND SET ALIAS DIRECTORY ENTRY
         SPACE 2
*        CTLTAB ENTRY FOR A ''FOUND'' MEMBER -
         SPACE 2
***********************************************************************
*SEFLAG1 *SEFLAG2 * INDIC. * ADDR OF THE IN-* ZEROES *   MEMBER TTR   *
*        *        *  BYTE  * PUT DIR. ENTRY *        *                *
***********************************************************************
*-1 BYTE-*-1 BYTE-*-1 BYTE-*-----3 BYTES----*-1 BYTE-*-----3 BYTES----*
         SPACE 2
* THE INDICATOR BYTE IS ZEROES IF THE DIRECTORY ENTRY IS IN CORE, OR IT
* IS HEX '01' IF THE DIRECTORY ENTRY WAS SPILLED TO SYSUT3.
* NOTE THAT CTLTAB ENTRIES FOR A ''NEWNAME'' ARE NOT OVERLAYED OR AL-
* TERED AT ANY TIME.  ONCE THE ENTIRE INPUT DIRECTORY HAS BEEN SCANNED,
* (OR AT LEAST ALL ENTRIES FOR MEMBERS TO BE COPIED FROM THIS INPUT
* DATA SET HAVE BEEN BUILT), THE OUTPUT DATA SET DIRECTORY IS READ.
* MEMBERNAMES OF MEMBERS CURRENTLY IN THE OUTPUT DATA SET ARE COMPARED
* AGAINST MEMBERNAMES OF MEMBERS REFERENCED IN THE CTLTAB FOR THE CUR-
* RENT INPUT DATA SET, UNLESS THE LATTER WERE RENAMED.  IF THE INPUT
* MEMBER IS RENAMED, THEN THE NEWNAME IS COMPARED AGAINST THE OUTPUT.
* IF DUPLICATE NAMES ARE ENCOUNTERED, AND IF THE REPLACE OPTION WAS NOT
* SPECIFIED ON EITHER THE INDD LEVEL OR THE MEMBERNAME LEVEL, THEN THE
* DONT-LINK BIT (SEBIT4) IS SET IN THE FLAG BYTE OF THE APPROPRIATE
* CTLTAB ENTRY, AND THE INDIC. BYTE (BYTE 3) OF THIS ENTRY IS SET TO
* HEX 'FF'.
* THINK OF THE LOW-ORDER 8-BYTES OF EACH ''FOUND'' CTLTAB ENTRY AS BE-
* ING DIVIDED INTO A LEFT HALF (INDIC. + DIR. ENTRY ADDR.) AND A RIGHT
* HALF (ZEROES + MBR. TTR).  THE LEFT HALF NOW REPRESENTS DIRECTORY
* ENTRIES FOUND IN THE CURRENT INPUT DATA SET, AND IS IN ALPHAMERIC
* SEQUENCE.
         EJECT
* THE NEXT STEP IN CTLTAB PROCESSING CAUSES THE ''FOUND'' ENTRIES TO BE
* MANIPULATED, WITH THE RESULT BEING THAT THE LEFT HALF CONTAINS (IN-
* DIC + ADDR OF DIR. ENTRY) IN SEQUENCE BY MEMBER TTR, AND THE RIGHT
* HALF CONTAINS THIS SAME INFORMATION (INDIC. + ADDR OF DIR. ENTRY) IN
* ALPHAMERIC SEQUENCE, OVERLAYING THE ACTUAL MEMBER TTR.  ANOTHER RE-
* SULT OF THIS MANIPULATION OF THE CTLTAB IS THAT MAIN-MEMBER ENTRIES
* PRECEDE THE CORRESPONDING ALIAS ENTRIES.  NOTE THAT THE BITS SET IN
* SEFLAG1 ARE NOW ONLY USEFUL FOR THE ''RIGHT HALF'' OF THE CTLTAB,
* SINCE THEY ARE NOT MANIPULATED AND THUS REMAIN IN THE ORIGINAL (AL-
* PHABETIC) SEQUENCE.
         SPACE 2
*        CTLTAB ENTRY FOR A FOUND MEMBER FOLLOWING TTR SORT -
         SPACE 2
***********************************************************************
*SEFLAG1 *SEFLAG2 * INDIC. * ADDR OF IN. DE * INDIC. * ADDR OF IN. DE *
*        *        *  BYTE  *                *  BYTE  *                *
*        *        *IN SEQ BY MEMBER TTR     *IN SEQ ALPHAMERICALLY    *
***********************************************************************
* 1 BYTE-*-1 BYTE-*-1 BYTE-*-----3 BYTES----*-1 BYTE-*-----3 BYTES----*
         SPACE 2
* AT THIS POINT, THERE IS NO LOGICAL RELATIONSHIP BETWEEN THE LEFT AND
* RIGHT HALVES OF THE RELEVANT CTLTAB ENTRIES.  BOTH HALVES CONTAIN THE
* SAME INFORMATION, BUT IT IS IN TWO DIFFERENT SEQUENCES.  NOTE THAT,
* IF A MEMBER BEING LOOKED FOR IS NOT ''FOUND'', ITS CTLTAB ENTRY RE-
* MAINS UNALTERED - THE NAME IS STILL UN-OVERLAYED.
* FROM THIS POINT ON, THOSE MEMBERS OF THE INPUT DATA SET WHOSE DIREC-
* TORY ENTRIES ARE REFERENCED IN THE CTLTAB WILL BE COPIED, PROVIDED
* THAT THEY ARE ''FOUND'' AND NOT FLAGGED AS ''DONT-LINK''.  THEN THE
* DIRECTORY ENTRIES WILL BE MERGED.  AS THE MERGE IS PERFORMED, WHEN AN
* INPUT DE IS MERGED, IF THIS IS A SELECTIVE LINK, THE DONT-LINK BIT
* (SEBIT4) IS TURNED ON, THUS ALLOWING FOR THESE ENTRIES IN THE CTLTAB
* TO BE IGNORED IN SUBSEQUENT PASSES THROUGH THE SAME TABLE FOR THE EN-
* SUING INPUT DATA SETS.
JSTCPD   EQU   X'10'              IF ON IN THE 2ND BYTE OF A CTLTAB EN-
*                                 TRY (SEFLAG2), THERE IS A NAME (CON-
*                                 TAINED IN THE 3RD THROUGH 10TH BYTES
*                                 OF THIS ENTRY) OF AN INPUT MEMBER
*                                 WHICH HAS BEEN SUCCESSFULLY COPIED.
*                                 THIS MEMBERNAME WILL BE PRINTED BY
*                                 THE TERMINATION MODULE (ZZRVTM) UNDER
*                                 APPROPRIATE CONDITIONS, AT WHICH TIME
*                                 THIS BIT WILL BE TURNED OFF.
***********************************************************************
         TITLE 'Z Z R E L I N K  -  CONTROL, DDNAME, AND SELECT TABLES'
*XXXXXXXXXX    EVERY CONSTANT BETW. HERE AND NXT X'S MUST BE CONTIGUOUS
* ALL CONSTANTS BETWEEN X'S ARE SET TO ZERO FOR EVERY INPUT DATA SET.
* THE NAMES OF THE CONSTANTS WHICH ARE INCLUDED IN THIS CONTIG. AREA -
* CDCT, FCT, NNTCT, OLDTTR, FLG5
* ICPT,SVLSTO,SVFSTO,FLG2,FLG6,SWITCH1,UTTRFLAG,OBCT
         SPACE 2
***********************************************************************
INBEGIN  DC    F'0'          ADDRESS OF START OF INDD TABLE
REPLACOP EQU   SEBIT3        IF ON IN HI-ORDER BYTE OF AN INDD-TABLE
*                            ENTRY, THE REPLACE OPTION WAS SPECIFIED
*                            FOR THIS INPUT DATA SET.
SEBEGIN  DC    AL4(0)        ADDR OF BEGINNING OF SETAB
SESTOP   DC    F'0'          IF SELECTIVE OR EXCLUSIVE LINK, THIS IS
*                            THE ADDRESS (+1) OF THE END OF THE SETAB.
*                            IF FULL LINK, ADDR (+1) OF END OF INDDTAB.
ADNNPTRT DS    AL4           ADDR OF NEWNAME POINTER TABLE
CTAD     DS    AL4           ADDR OF CONTROL TABLE - IF SELECTIVE LINK,
*                            THIS WILL BE SAME AS SEBEGIN.
ENCT     DC    HL2'0'        COUNT OF NBR OF ENTRIES IN CTLTAB (TOTAL)
*              IF THIS IS A SELECTIVE LINK, THIS COUNT WILL BE INI-
*              TIALIZED TO THE NUMBER OF ENTRIES IN SETAB.
COUNT    DC    HL2'0'        COUNT OF NBR OF ENTRIES IN SETAB IF SEL OR
*                            EXCL LINK, OR ZERO IF FULL LINK.
INDDCT   DC    AL2(0)        COUNT OF NO. INDD'S IN CURRENT STEP
NNCT1    DC    AL2(0)        NBR OF NEWNAMES SPECIFIED IN CURRENT SE-
*                            LECTIVE LINK STEP (IF NOT SEL CPY, = 0)
         DS    0D
OUTNAME  DC    CL8' '        NAME OF CURRENT OUTPUT DD
         SPACE 2
CCIMAGE  DS    10D                     SCAN CONTROL CARD BUFFER
         SPACE 2
WKA1     DC    10F'0'        VOLATILE WORK AREA FOR GENERAL USE
*
*****   PLEASE NOTE---    ZZRESCAN IS NOT THE ONLY MODULE WHICH USES
**                WKA1 FOR TEMPORARY WORK SPACE.
*                 HOWEVER, THE FOLLOWING 4 EQUATES ARE USED ONLY BY
*                 ZZRESCAN -
*
SARG     EQU   WKA1          TEMPORARY WORK AREA USED BY ZZRESCAN
*                            TO HOLD SEARCH ARGUMENT 8 BYTES LONG
SAVEPAPR EQU   WKA1+8        TEMPORARY WORK AREA USED BY ZZRESCAN
*                            TO HOLD PARTIAL PARAMETERS IF CONTROL CARD
*                            IS CONTINUED, 8 BYTES LONG.
LEFTPCNT EQU   WKA1+16       TEMPORARY WORK AREA USED BY ZZRESCAN
*                            TO HOLD COUNT OF LEFT PARENTHESIS SCANNED.
RGHTPCNT EQU   WKA1+18       TEMPORARY WORK AREA USED BY ZZRESCAN
*                            TO HOLD COUNT OF RIGHT PARENTHESIS SCANNED
*                            BOTH LEFTPCNT AND RGHTPCNT 2 BYTES EACH
*                            AND MUST BE CONTIGUOUS STORAGE.
CSTOREG  DC    3F'0'         SAVE AREA USED BY ZZRESCAN
         SPACE 2
*        REGISTER SAVE AREAS
SV1      DC    18F'0'        REGISTER SAVE AREA FOR MAINFLOW
SV2      DC    18F'0'        REGISTER SAVE AREA FOR NON-RESIDENT RTNES
MCAMOD   DC    10F'0'             ZZRELCOM CHANGE AREA
* MCAMOD IS A PATCH-AREA FOR USE IN MAINTENANCE OF THIS PROGRAM
         TITLE 'POINTERS FOR INTER-MODULE COMMUNICATION'
VZZRSCN  DC    V(ZZRESCAN)         ADDR OF CONTROL CARD SCAN ROUTINE
VZZRLEOF DC    V(ZZRLEOF) EP ADDRESS OF SYSIN EODAD EXIT IN ZZRESCAN
VZZRLMES DC    V(ZZMESAGE)         ADDRESS OF MESSAGE WRITER ROUTINE
VZZRTERM DC    V(ZZRTERM)         ADDRESS OF TERMINATION ROUTINE
         ORG   VZZRTERM
AZZRTERM DS    F                  ADDRESS OF TERMINATION ROUTINE
         TITLE 'S Y S I N    D A T A    C O N T R O L    B L O C K'
*CARDCB  DCB   DDNAME=SYSIN,RECFM=FB,LRECL=80,EODAD=VZZRLEOF,
*              MACRF=(GM),DSORG=PS
CARDCB   DCB   DDNAME=SYSIN,RECFM=FB,LRECL=80,EODAD=VZZRLEOF,          X
               MACRF=(GM),DSORG=PS
         TITLE 'S Y S P R I N T    D A T A    C O N T R O L    B L O C X
               K'
* PRTDCB DCB   DDNAME=SYSPRINT,DSORG=PS,MACRF=(PM),RECFM=FBA,
*              LRECL=121,BLKSIZE=121
PRTDCB   DCB   DDNAME=SYSPRINT,DSORG=PS,MACRF=(PM),RECFM=FBA,          X
               LRECL=121,BLKSIZE=121
         TITLE 'SWITCH AND WORK AREA DEFINITIONS FOR ZZRESCAN'
* THE FOLLOWING SWITCHES (PARMSWCH, CCSWITCH, COMDCDSW, CPARAMSW, CCDE-
* LIM, CCDELIM2) ARE PRIMARILY BUT NOT SOLELY USED BY ZZRESCAN -
*
         SPACE 1
PARMSWCH DC    XL1'0'    SCAN INTERNAL INDD AND MEMBER SWITCHES
SCANNAME EQU   X'80'         SCANNING NAME
SET4REPL EQU   X'40'         MULTIPLE ( EXPECT REPLACE
ONELEFT  EQU   X'20'         FIRST LEFT PARENTHESIS
LINKNOW  EQU   X'10'         NOW SCANNING LINK CARD
STOPSCAN EQU   X'08'         BLANK ENCOUNTERED
FLUSHSW  EQU   X'04'                   FLUSH TO NEXT LINK RE/SET ALONE
HASNEWNM EQU   X'02'         HAVE A NEW NAME WITH MEMBER
COMDPART EQU   X'01'         PARTIAL COMMAND- CONTINUED ON NEXT CARD
*
         SPACE 1
CCSWITCH DC    XL1'0'                  CONTROL CARD SWITCHES- EXTERNAL
CARDPRTD EQU   X'80'         ON = CONTROL STATEMENT HAS BEEN PRINTED
SYSINEOF EQU   X'40'         END OF FILE ON SYSIN
UNECPARN EQU   X'20'         INDD/MEMBER NAMES IMBEDDED IN PARENTHESIS
ZZRLINKC EQU   X'10'         ZZRLINK CONTROL CARDS
COMDNOW  EQU   X'08'         COMMAND WORD
LASTPARM EQU   X'04'         LAST PARAMETER- BYPASS SWITCH
MULTSE   EQU   X'02' MULTIPLE SELECT/EXCLUDE STATEMENTS
FIRSTSCN EQU   X'01' ON=ZZRESCAN HAS BEEN CALLED FOR THE FIRST TIME
*
         SPACE 2
COMDCDSW DC    XL1'0'           SOME EXTERNAL SWITCHES
LINKDONE EQU   X'80'         LINK COMMAND SCANNED ALL OK
SELECTSC EQU   X'40'         SELECT COMMAND SCANNED
EXCLUDES EQU   X'20'         EXCLUDE COMMAND SCANNED
NEWOUT   EQU   X'10'         OUTDD KEYWORD PRESENT
NEWINDD  EQU   X'08'         INDD KEYWORD PRESENT
LISTSW   EQU   X'04'         DO NOT LIST MEMBERS COPIED (LIST=NO)
COMPRESS EQU   X'02'                   COMPRESS LINK DATA SET
MEMBRCD1 EQU   X'01'         MEMBER STATEMENT
*
         SPACE 2
CPARAMSW DC    XL1'0'       INTERNAL SCAN SWITCHES
DELIMEND EQU   X'80'         DELIMITER IN COLUMN 71
CONTINY  EQU   X'40'         CONTINUATION
PARMCOME EQU   X'20'         PARAMETER FOLLOWS
PARTPARM EQU   X'10'         PARTIAL PARAMETER
READ1    EQU   X'08'         READ ANOTHER CONTROL STATEMENT
COMDPARM EQU   X'04'         COMMAND FOLLOWED BY PARAMETER
COL72BLK EQU   X'02'         COLUMN 72 NOT BLANK
PARMZERO EQU   X'01'         PARAMETER LENGTH ZERO
*
         SPACE 2                                                 A48742
SCANSWCH DC    XL1'0'        INTERNAL SCAN SWITCHES              A48742
NOCMMEXP EQU   X'80'         DON'T SCAN COMMAND ON CONTIN CARDS  A48742
*              LOW ORDER 7 BITS NOT USED - RESERVED              A48742
*
         SPACE 2
CCDELIM  DC    XL1'0'        INTERNAL SCAN SWITCHES
EQUALSGN EQU   X'80'         EQUAL SIGN
COMMASGN EQU   X'40'         COMMA
LEFTPRSG EQU   X'20'         LEFT PARENTHESIS
RIGHTPRS EQU   X'10'         RIGHT PARENTHESIS
BLANKSGN EQU   X'08'         BLANK
LASTCOMA EQU   X'04'         LAST DELIMITER A COMMA- READ A CARD
BADBLOCK EQU   X'02' VALIDATE-ZZRDV0 SETS IF SYSIN/SYSPRINT BLOCKSIZE
*          IS BAD.
*              LO ORDER BIT NOT USED
*
         SPACE 2
CCDELIM2 DC    XL1'0'  USED TO SAVE SETTINGS OF CCDELIM ON CONTINUATION
*
         TITLE 'ERROR FLAG DEFINITIONS USED BY OPEN FAILURE ROUTINE'
IOEF2    DC    X'00'              FLAGS DESCRIBING NATURE/TYPE OF I/O
*                                 ERROR
ERF9     EQU   X'80'         ON = 'HARD' ERROR WRITING MERGED OUTPUT
*                                 DIRECTORY TO SYSUT4
ERF10    EQU   X'40'         ON = ERROR READING FROM SYSUT4.  IF 'ERF4'
*                                 OFF, ERROR OCCURRED DURING MERGE
*                                 PHASE OF PROGRAM - IF 'ERF4' ON, SEE
*                                 DESCRIPTION OF 'ERF4'.
NOSYSIN  EQU   X'20'         ON = SYSIN COULD NOT BE OPENED OR WAS IN-
*                                 VALID, OR BECAME UNUSABLE DUE TO AN
*                                 I/O ERROR
SPRNOPN  EQU   X'10'         SYSPRINT COULD NOT BE OPENED, WAS INVALID-
*                                 LY SPECIFIED, OR AN I/O ERROR OCCUR-
*                                 RED MAKING SYSPRINT UNAVAILABLE
*              LOW ORDER 4 BITS NOT USED - RESERVED
*
         TITLE 'SWITCH AND WORK AREA DEFINITIONS FOR ZZMESAGE'
         DS    0H
MSGLIST  DC    4H'0'              AREA FOR PARAMETRIC INPUT TO ZZMESAGE
MSG1     EQU   MSGLIST
MSG2     EQU   MSG1+2
MSG3     EQU   MSG2+2
MSG4     EQU   MSG3+2
* THE FOLLOWING BITS WILL BE SET ON BY THE CALLER OF ZZMESAGE (MESSAGE
* WRITING ROUTINE) IN THE HIGH ORDER BYTE OF EACH APPROPRIATE HALFWORD
* IN THE MSGLIST PARAMETER(S) BEING USED -
LASTMSG  EQU   X'80'         ON = LAST PARAMETER IN MSGLIST
CTLCD    EQU   X'40'         ON = A CONTROL CARD IS TO BE PRINTED
IOERF    EQU   X'20'         ON = A MESSAGE IS IN THE MESSAGE BUFFER -
*                                 AND IS TO BE PRINTED.  NO MSG CODE IS
*                                 ASSOCIATED WITH THIS MESSAGE, AND IT
*                            USUALLY WILL BE A SYNADAF MESSAGE.
RCODE    EQU   X'10'         ON = PUT RETURN CODE INTO THIS MSG TEXT
PBIT     EQU   X'08'         ON = USE PARAM LIST WITH THIS MSG TEXT
*              LO ORDER 3 BITS NOT USED - RESERVED
         SPACE 2
MSGPARAM DS    9H                 THIS FIELD IS TO CONTAIN PARAMETERS
*                                 TO BE PLACED IN MESSAGES
         ORG   MSGPARAM
NAMEDISP DC    X'00'              THE DISPLACEMENT OF A NAME
*                                 PARAMETER FROM THE BEGINNING OF
*                                 THE MESSAGE IT IS TO BE PLACED IN
*                                 THIS BYTE
NODISP   DC    X'00'              THE DISPLACEMENT OF A NUMBER
*                                 PARAMETER FROM THE BEGINNING OF
*                                 THE MESSAGE IT IS TO BE PLACED IN
*                                 THIS BYTE
DDNMDISP DC    X'00'              DISPLACEMENT OF DDNAME FROM MSG START
         DS    0D
NAMEFLD  DC    CL8' '        AREA CONTAINING NAME TO BE PUT INTO MSG
DDNMFLD  DC    CL8' '        AREA CONTAINING DDNAME TO INSERT IN MSG
DDVALNM  EQU   NAMEFLD       USED BY VALIDATE TO SAVE DD NAME
PARAMS   DC    X'00'
NAME     EQU   X'80'         ON = THERE IS A NAME PARAMETER
NBR      EQU   X'40'         ON = THERE IS A NUMBER PARAMETER
DDNM     EQU   X'20'         ON = THERE IS A DDNAME PARAMETER
NOFLD    DC    CL7'0'        AREA CONTAINING NUMBER TO BE PUT INTO MSG
         TITLE 'MESSAGE CODE DEFINITIONS USED BY ALL ZZRELINK MODULES'
***********************************************************************
*        THE FOLLOWING MESSAGE CODES ARE USED BY ZZRELINK, ZZRESCAN,  *
*    AND ZZMESAGE TO IDENTIFY AND PRODUCE ALL ZZRELINK MESSAGES.      *
***********************************************************************
INALCNTR EQU     01                INVALID COMMAND OR KEYWORD
INVALSPR EQU     02                INVALID PARAMETER
ONEQPARN EQU     03                UNEQUAL PARENTHESIS
INVALCON EQU     04                INVALID CONTINUATION
MEMNOSE  EQU     05                MEMBER WITHOUT SELECT/EXCLUDE
MULTSSEE EQU     06                ONLY ONE SELECT/EXCLUDE PER INDD
INVALREP EQU     07                INVALID REPLACE SPECIFIED
NULLPARM EQU     08                NULL PARAMETERS
NORREN   EQU     09                CANNOT RENAME/REPLACE ON EXCLUDE
NOINDD   EQU     10                OUTDD OR INDD NOT SPECIFIED
INVALIST EQU   11                  OUTDD/LIST NOT ON LINK STATEMENT
ENDMESS  EQU   12                  END OF CONTROL CARDS
MODEERR  EQU   13                  MIXING ZZRLINKAND ZZRDSCPY MODE
NOOVLYS  EQU   14                  WARNING - OVERLAYS NOT SUPPORTED
SCANMSG  EQU   15                  CONTROL STATEMENT ERROR
SEQERROR EQU   16                  STATEMENT SEQUENCE ERROR
GENERUAL EQU   17                  GENERAL VALIDATION MESSAGE
OPENERRX EQU   18                  OPEN ERROR MESSAGE
OBTAINER EQU   19                  OBTAIN ERROR
NOTPDSER EQU   20                  OBTAIN NOT PDS
INVALREC EQU   21                  INVALID LRECL
INVALBLK EQU   22                  INVALID BLOCKSIZE
UNMOVEDS EQU   23                  DATA SET UNMOVABLE
RECFMINC EQU   24                  RECFM INCOMPATIBLE
NODIR    EQU   25                  UNABLE TO OPEN DIRECTORY DCB
DIRERR01 EQU   26                  ALIAS NAME X OCCURS MORE THAN ONCE
ATABFULL EQU   27                  ALIAS TABLE FULL
EPAERR01 EQU   28                  UNABLE TO LOCATE EPA OF MODULE X
DIRERR02 EQU   29                  I/O ERROR READING DIRECTORY FOR X
REPERR01 EQU   30                  MEMBER X NOT RELINKED - NO REP OPT
M39      EQU   31                  CANNOT COMPRESS WITH SELECT OR
*                                  EXLCUDE
CESDIOER EQU   32                  I/O ERROR READING CESD RECORDS
NE       EQU   33                  LOAD MODULE IS 'NOT EDITABLE'
*                                  BUFFERS FOR COMPRESS
M42      EQU   34 CANNOT SPECIFY DUPLICATE NAME FOR SEL/EXCL/RENAME
M43      EQU   35                  CANNOT PROCESS ALL OLD/NEW NAMES
*                                  SPECIFIED
M45      EQU   36                  (DATA SET NAME) REFERENCES A NULL
*                                  INPUT DATA SET
M46      EQU   37                  CANNOT RE/DE BLOCK WITH
*                                  NOTE-LIST/USER TTRN IN MEMBER
*                                  (MEMBER NAME)
M47      EQU   38                  CANNOT CONTINUE TO BUILD CTLTAB
M48      EQU   39                 ALL SELECTED MEMBERS COPIED - DID NOT
*                                 USE ALL SPECIFIED INDD'S
M49      EQU   40                  (NUMBER) UNUSED TRKS IN OUTPUT DATA
*                                  SET REFERENCED BY (DDNAME)
M50      EQU   41                  CANNOT COMPRESS TRACK OVERFLOW DATA
*                                  SET
M51      EQU   42                  CANNOT COMPRESS WITH RE/DE BLOCKING
M53      EQU   43                  END OF JOB (0,4,8) WAS HIGHEST
*                                  SEVERITY CODE
NORMOD   EQU   44                  NO SPACE IN OUTPUT DIRECTORY FOR
*                                  DIRECTORY ENTRIES FROM DATA SET
*                                  (DATA SET NAME)
UNUSDDB  EQU   45                  THERE ARE (NUMBER) UNUSED DIRECTORY
*                                  BLOCKS IN THE OUTPUT DIRECTORY
TMDBTR   EQU   46     **WARNING** THE OUTPUT DS REF BY XXXXXXXX  A36049
*                     CONTAINS TOO MANY DIRECTORY BLOCKS PER     A36049
*                     TRACK                                      A36049
M58      EQU   47                  ERROR FORCES JOB TO TERMINATE
M59      EQU   48                  (MEMBER NAME) COMPRESSED- WAS
*                                  ALREADY IN PLACE
M60      EQU   49                  ALL MEMBERS COMPRESSED-
*                                  ALL WERE ORIGINALLY COMPRESSED
MEMCOP   EQU   50                  (MEMBERNAME) HAS BEEN SUCCESSFULLY
*                                  COPIED
RNMEMCOP EQU   51                  (MEMBER NAME) HAS BEEN RENAMED AND
*                                  SUCCESSFULLY COPIED
NOTDA    EQU   52                 DATA SET NOT DIRECT ACCESS
NODDCARD EQU   53                 DD CARD NOT FOUND
UNITER01 EQU   54                 UNIT TYPE DEFINED BY X NOT SUPPORTED
NOMBCPDM EQU   55                 NO MBRS COPIED FROM INPUT DATASET RE-
*                                 FERENCED BY (XXXXXXXX)
CONCATBD EQU   56                 CONCATENATED DATA SETS
IMPCOMPR EQU   57                 IMPLIED COMPRESS
NOCMPOSS EQU   58                 CANNOT COMPRESS
NOLINK   EQU   59                 NO MEMBERS FOR PARTIAL LINK,
*                                 WILL NOT LINK
DOFULLCP  EQU  60                 TOTAL LINK ASSUMED
MFBNC    EQU   61 MEMBER FOUND BUT NOT COPIED - I/O ERROR READING
*                 INPUT DIRECTORY
NONELINK EQU   62 NO MEMBERS COPIED
FOLLMCPD EQU   63 FOLLOWING MBRS COPIED FROM INPUT DS REF BY XXXXXXXX
PLAMPID  EQU   64 POSSIBLE LOSS OF ACCESS TO MEMBER AND/OR INCOMPLETE
*                 DIRECTORY
WODINC   EQU   65 SYSUT4 I/O ERROR - OUTPUT DIRECTORY MAY BE INCOMPLETE
WONTCOM  EQU   66 I/O ERROR ON SYSUT3 - COMPRESS IN PLACE NOT DONE
BADPRINT EQU   67 SYSPRINT COULD NOT BE OPENED
SMNF    EQU   68                  (MBRNAME) WAS SELECTED BUT NOT FOUND
PA       EQU   69                  LOAD MODULE IS PAGE ALIGNED        $
         SPACE 2
RCBUF    DC    C'0'               COMPLETION-CODE AREA...CONTAINS CHAR-
*                                 ACTER REPRESENTATION OF HIGHEST
*                                 COMPLETION CODE SET BY UTILITY PGM
LINECT   DC   X'0'                COUNT OF NBR LINES WRITTEN ON ONE PG
PGLIMIT  EQU   56                 MAX NBR OF LINES TO BE PUT ON ONE PG
         SPACE 2
MSGBUF   DC    121C' '            MESSAGE BUFFER
PGNO     DC    C'0001'            STARTING PAGE NUMBER FOR MSG OUTPUT
*************              END OF COMMUNICATION AREA   ****************
***   KEEP CARD  'MCAEND' LAST IN COMMUNICATION AREA JUST BEFORE THE **
****  EQUATE THAT DETERMINES THE COMMUNICATIONS AREA SIZE 'MCASIZE'  **
         SPACE 1
MCAEND   DS    0D        END OF COMMUNICATION AREA
MCASIZE  EQU   MCAEND-ZZRELCOM    SIZE OF COMMUNICATIONS AREA FOR SNAPS
         MEND

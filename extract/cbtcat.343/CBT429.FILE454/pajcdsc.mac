PROC     0 DDSN DVOL LPARM OPARM
         CONTROL MSG
         ISPEXEC VGET (PRJO LIBO TYPO DDSN DVOL LPARM OPARM)
         IF &OPARM = THEN GOTO DSLL
         IF &DDSN = THEN GOTO ANDS
         IF &DVOL = THEN GOTO TTDS
         CDSCB &DDSN VOL(&DVOL) &OPARM
         GOTO DSTL
TTDS:    CDSCB &DDSN &OPARM
         GOTO DSTL
ANDS:    IF &PRJO = &SYSUID THEN GOTO OWDS
         IF &DVOL = THEN GOTO VLDS
         CDSCB '&PRJO..&LIBO..&TYPO' VOL(&DVOL) &OPARM
         GOTO DSTL
VLDS:    CDSCB '&PRJO..&LIBO..&TYPO' &OPARM
         GOTO DSTL
OWDS:    IF &DVOL = THEN GOTO NVDS
         CDSCB &LIBO..&TYPO VOL(&DVOL) &OPARM
         GOTO DSTL
NVDS:    CDSCB &LIBO..&TYPO &OPARM
         GOTO DSTL
DSLL:    IF &LPARM ^= NO THEN GOTO DSSL
         SET &LBL = &STR( )
         GOTO DSXL
DSTL:    IF &LPARM = NO THEN GOTO DSEX
DSSL:    SET &LBL = &STR(LABEL)
DSXL:    IF &DDSN = THEN GOTO ANDL
         IF &DVOL ^= THEN GOTO DSAL
         LISTDS &DDSN &LBL
         GOTO DSEX
DSAL:    ALLOC DSN(&DDSN) VOL(&DVOL) SHR
         LISTDS &DDSN &LBL
         FREE DSN(&DDSN)
         GOTO DSEX
ANDL:    IF &PRJO = &SYSUID THEN GOTO OWDL
         LISTDS '&PRJO..&LIBO..&TYPO' &LBL
         GOTO DSEX
OWDL:    LISTDS &LIBO..&TYPO &LBL
DSEX:    CONTROL MSG

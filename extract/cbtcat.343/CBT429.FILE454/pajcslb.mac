PROC     0
         ISPEXEC CONTROL ERRORS RETURN
         SET &SLBMD = NO
         ISPEXEC VGET (SLBN1 SLBN2 SLBN3 SLBN4 SLBN5 SLBN6 SLBN7 +
           SLBN8 SLBN9 SLBN10 SLBN11) PROFILE
         SET &SLBNME = &SLBN1
SLB1:    SET &SLBCC =
         SET &SLBEN =
SLB2:    IF &SLBNME = &SLBN1 THEN SET &SLBCS = 1
         ELSE IF &SLBNME = &SLBN2 THEN SET &SLBCS = 2
         ELSE IF &SLBNME = &SLBN3 THEN SET &SLBCS = 3
         ELSE IF &SLBNME = &SLBN4 THEN SET &SLBCS = 4
         ELSE IF &SLBNME = &SLBN5 THEN SET &SLBCS = 5
         ELSE IF &SLBNME = &SLBN6 THEN SET &SLBCS = 6
         ELSE IF &SLBNME = &SLBN7 THEN SET &SLBCS = 7
         ELSE IF &SLBNME = &SLBN8 THEN SET &SLBCS = 8
         ELSE IF &SLBNME = &SLBN9 THEN SET &SLBCS = 9
         ELSE IF &SLBNME = &SLBN10 THEN SET &SLBCS = 10
         ELSE IF &SLBNME = &SLBN11 THEN SET &SLBCS = 11
         ELSE IF &SLBNME = &SLBNN THEN SET &SLBCS = N
         ELSE SET &SLBCS = 1
SLB3:    SET &SLBPN1 = &SLBN1
         SET &SLBPN2 = &SLBN2
         SET &SLBPN3 = &SLBN3
         SET &SLBPN4 = &SLBN4
         SET &SLBPN5 = &SLBN5
         SET &SLBPN6 = &SLBN6
         SET &SLBPN7 = &SLBN7
         SET &SLBPN8 = &SLBN8
         SET &SLBPN9 = &SLBN9
         SET &SLBPN10 = &SLBN10
         SET &SLBPN11 = &SLBN11
         SET &SLBPNN = &SLBNN
         ISPEXEC DISPLAY PANEL(PAJSLB)
         SET &SLBCC = &LASTCC
         IF &SLBCC = 8 THEN GOTO SLB99
         IF &SLBCC ^= 0 THEN GOTO SLB10
         IF &SLBPN1 ^= &SLBN1 THEN SET &SLBNME = &SLBN1
         ELSE IF &SLBPN2 ^= &SLBN2 THEN SET &SLBNME = &SLBN2
         ELSE IF &SLBPN3 ^= &SLBN3 THEN SET &SLBNME = &SLBN3
         ELSE IF &SLBPN4 ^= &SLBN4 THEN SET &SLBNME = &SLBN4
         ELSE IF &SLBPN5 ^= &SLBN5 THEN SET &SLBNME = &SLBN5
         ELSE IF &SLBPN6 ^= &SLBN6 THEN SET &SLBNME = &SLBN6
         ELSE IF &SLBPN7 ^= &SLBN7 THEN SET &SLBNME = &SLBN7
         ELSE IF &SLBPN8 ^= &SLBN8 THEN SET &SLBNME = &SLBN8
         ELSE IF &SLBPN9 ^= &SLBN9 THEN SET &SLBNME = &SLBN9
         ELSE IF &SLBPN10 ^= &SLBN10 THEN SET &SLBNME = &SLBN10
         ELSE IF &SLBPN11 ^= &SLBN11 THEN SET &SLBNME = &SLBN11
         ELSE IF &SLBNN = THEN DO
           ISPEXEC SELECT PGM(ISPCDSN) PARM(SLBNME)
           SET &SLBCC = &LASTCC
           IF &SLBCC NE 0 THEN GOTO SLB11
           ISPEXEC VGET (SLBNME) SHARED
           END
         ELSE SET &SLBNME = &SLBNN
         IF &SLBMD = YES THEN GOTO SLB4
         ISPEXEC BROWSE DATASET(&SLBNME)
         SET &SLBCC = &LASTCC
         IF &SLBCC NE 0 THEN GOTO SLB12
         GOTO SLB1
SLB4:    ISPEXEC EDIT DATASET(&SLBNME)
         SET &SLBCC = &LASTCC
         IF &SLBCC GT 4 THEN GOTO SLB13
         GOTO SLB1
SLB10:   SET &SLBEN = DISPLAY
         GOTO SLB2
SLB11:   SET &SLBEN = ISPCDSN
         IF &SLBPN1 ^= &SLBN1 THEN SET &SLBCS = 1
         ELSE IF &SLBPN2 ^= &SLBN2 THEN SET &SLBCS = 2
         ELSE IF &SLBPN3 ^= &SLBN3 THEN SET &SLBCS = 3
         ELSE IF &SLBPN4 ^= &SLBN4 THEN SET &SLBCS = 4
         ELSE IF &SLBPN5 ^= &SLBN5 THEN SET &SLBCS = 5
         ELSE IF &SLBPN6 ^= &SLBN6 THEN SET &SLBCS = 6
         ELSE IF &SLBPN7 ^= &SLBN7 THEN SET &SLBCS = 7
         ELSE IF &SLBPN8 ^= &SLBN8 THEN SET &SLBCS = 8
         ELSE IF &SLBPN9 ^= &SLBN9 THEN SET &SLBCS = 9
         ELSE IF &SLBPN10 ^= &SLBN10 THEN SET &SLBCS = 10
         ELSE IF &SLBPN11 ^= &SLBN11 THEN SET &SLBCS = 11
         ELSE IF &SLBPNN ^= &SLBNN THEN SET &SLBCS = N
         ELSE SET &SLBCS = 1
         GOTO SLB3
SLB12:   SET &SLBEN = BROWSE
         GOTO SLB2
SLB13:   SET &SLBEN = EDIT
         GOTO SLB2
SLB99:   ISPEXEC VPUT (SLBN1 SLBN2 SLBN3 SLBN4 SLBN5 SLBN6 SLBN7 +
           SLBN8 SLBN9 SLBN10 SLBN11) PROFILE
         ISPEXEC CONTROL ERRORS CANCEL

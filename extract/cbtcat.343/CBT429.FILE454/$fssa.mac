         MACRO
&LABEL  $FSSA
.*
.* MACRO : INTERNALLY USED BY $FS MACRO.
.* -------
.*
.* AUTHOR :    MOINIL P.A.
.* --------    COMPUTING CENTRE
.*             J.R.C. - ISPRA ESTABLISHMENT
.*             21020 ISPRA (VA), ITALY
.*
         GBLA  &GMFCI
         GBLB  &GFUSW,&GFESW,&GFISW,&GFWSW
         GBLC  &GFSMF,&GFSMI,&GFSOP,&GFWTY,&GFWVA
         LCLA  &NR
         LCLC  &RG,&TY,&VA
         AIF   (NOT &GFUSW).USEERR
&GFSOP   SETC  '28'
         AIF   ('&SYSLIST(1)' EQ 'RESET').RST
         AIF   (N'&SYSLIST(1) NE 2).ARGERR
&TY      SETC  '&SYSLIST(1,1)'
&VA      SETC  '&SYSLIST(1,2)'
        $FS$TV &TY,&VA
         AIF   (NOT &GFWSW).TGX
         MEXIT
.RST     ANOP
&GFWTY   SETC  '00'
&GFWVA   SETC  '00'
.TGX     AIF   (&GFISW).MVI
         AIF   (&GFESW).MVL
&LABEL   DC    XL3'&GFSOP&GFWTY&GFWVA'
         MEXIT
.MVL     ANOP
&LABEL   MVC   0(3,&GFSMF),=XL3'&GFSOP&GFWTY&GFWVA'
         LA    &GFSMF,3(,&GFSMF)
         MEXIT
.MVI     AIF   ('&GFSMI'(1,1) EQ '(').MVIR
&LABEL   MVC   &GFSMI+&GMFCI.(3),=XL3'&GFSOP&GFWTY&GFWVA'
&GMFCI   SETA  &GMFCI+3
         MEXIT
.MVIR    ANOP
&NR      SETA  K'&GFSMI-2
&RG      SETC  '&GFSMI'(2,&NR)
&LABEL   MVC   &GMFCI.(3,&RG),=XL3'&GFSOP&GFWTY&GFWVA'
&GMFCI   SETA  &GMFCI+3
         MEXIT
.ARGERR  MNOTE 8,'--- SA=(...) INVALID CODING'
         MEXIT
.USEERR  MNOTE 8,'--- INVALID MACRO USAGE'
         MEND

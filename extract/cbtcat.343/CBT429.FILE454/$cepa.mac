         MACRO           SMF - COMMON EXIT PARAMETER AREA.
        $CEPA       &DUMMY
         SPACE 2
*        ==========================
*        COMMON EXIT PARAMETER AREA
*        ==========================
.*
.* AUTHOR :    P.A. MOINIL
.* --------    COMPUTING CENTRE
.*             J.R.C. - ISPRA ESTABLISHMENT
.*             21020 ISPRA (VA), ITALY
.*
         SPACE 2
*        WHEN A USER-WRITTEN EXIT ROUTINE RECEIVES CONTROL, REGISTER
* 1 POINTS TO A LIST OF FOUR BYTE ADDRESSES. THE FIRST ENTRY IN THIS
* LIST IS COMMON TO ALL EXIT ROUTINES EXCEPT IEFU83, IEFU84, AND
* IEFU29. THE FIRST ENTRY POINTS TO A PARAMETER AREA THAT IS 36 BYTES
* LONG. EACH JOB HAS ITS OWN COMMON EXIT PARAMETER AREA. NOTE THAT
* THE FIELDS IN THIS PARAMETER AREA ARE FILLED CHRONOLOGICALLY,
* THEREFORE, NOT ALL FIELDS ARE MEANINGFUL FOR ALL USER-WRITTEN EXIT
* ROUTINES.
         SPACE 2
CEPA     DSECT             COMMON EXIT PARAMETER AREA DESCRIPTION.
         SPACE 2
CEPAJOBN DS    CL8 .       JOB NAME.
         SPACE 1
CEPATIME DS    F .         TIME, IN HUNDREDTHS OF A SECOND, READER
*                          RECOGNIZED THE JOB CARD FOR THIS JOB.
         SPACE 1
CEPADATE DS    PL4 .       DATE READER RECOGNIZED THE JOB CARD FOR
*                          THE JOB, IN THE FORM 00YYDDDF WHERE F IS
*                          THE SIGN.
         SPACE 1
CEPASID  DS    CL4 .       SYSTEM IDENTIFICATION (TAKEN FROM SID
*                          PARAMETER).
         SPACE 1
CEPAUSER DS    CL8 .       USER IDENTIFICATION. SMF PLACES THIS DATA
*                          IN ALL SUBSEQUENT RECORDS FOR THIS JOB.
*                          THIS FIELD IS INITIALIZED TO EBCDIC BLANKS
*                          WHEN EACH JOB IS READ.
         SPACE 1
CEPASTPN DS    XL1 .       NUMBER OF THE STEP BEING PROCESSED.
         EJECT
CEPAIND  DS    XL1 .       INDICATOR OF SMF OPTIONS SELECTED BY THE
*                          USER :
*                            BIT  MEANING WHEN SET
*                            ---  -----------------------------------
*                            0-2  RESERVED.
*                             3   DATA SET ACCOUNTING. IF ONE OF THE
*                                 RECORDS TYPES 14, 15, 17, 18, 62,
*                                 63, 64, 67 OR 68 IS SELECTED, THIS
*                                 BIT IS SET ON.
*                             4   VOLUME ACCOUNTING. RECORD TYPES 19
*                                 OR 69 SELECTED.
*                             5   RESERVED.
*                             6   TYPE 17 RECORDS WILL BE WRITTEN
*                                 FOR TEMPORARY DATA SET (REC(ALL)).
*                             7   IF 0, BACKGROUND JOB.
*                                 IF 1, FOREGROUND JOB.
         SPACE 1
CEPARES  DS    XL1 .       RESTART INDICATOR :
*                            BIT  MEANING WHEN SET
*                            ---  -----------------------------------
*                             0   STEP RESTART.
*                             1   CHECKPOINT/RESTART.
*                             2   CONTINUE RESTART.
*                             3   RESERVED.
*                             4   WARM RESTART.
*                            5-7  RESERVED.
         SPACE 1
CEPAJC   DS    CL1 .       JOB CLASS.
         SPACE 1
CEPAUCOM DS    XL4 .       USER-COMMUNICATION FIELD. THIS FIELD IS
*                          INTENDED FOR COMMUNICATION AMONG USER-
*                          WRITTEN EXIT ROUTINES WITHIN A UNIQUE JOB.
*                          THE FIELD IS INITIALIZED TO ZEROS BY THE
*                          JOB ENTRY SUBSYSTEM WHEN A JOB BEGINS
*                          EXECUTION.
         EJECT
* COMMUNICATING BETWEEN EXIT ROUTINES :
* -------------------------------------
*
*        USER-WRITTEN EXIT ROUTINES CAN COMMUNICATE WITH EACH OTHER,
*        EXECUTING WITHIN THE SAME JOB, IN TWO WAYS : BY USING THE
*        THE USER-COMMUNICATION FIELD ('CEPAUCOM') OR BY USING THE
*        USER-IDENTIFICATION FIELD ('CEPAUSER'). BOTH OF THESE FIELDS
*        ARE CONTAINED IN THE COMMON EXIT PARAMETER AREA, WHICH IS
*        PASSED TO ALL USER-WRITTEN EXIT ROUTINES EXCEPT 'IEFU83',
*        'IEFU84' AND 'IEFU29'. EITHER DATA OR THE ADDRESS OF A DATA
*        AREA CAN BE PLACED IN THE COMMUNICATION FIELD. HOWEVER,
*        PASSING THE ADDRESS OF A DATA AREA CAN CAUSE A PROBLEM.
*        FOR EXAMPLE, ASSUME THE USER EXIT 'IEFUJV' RUNS ON THE GLOBAL
*        PROCESSOR WITH JES3. THE EXIT ISSUES A GETMAIN, AND STORES
*        THE ADDRESS OF THE DATA AREA IN THE USER COMMUNICATION FIELD.
*        UNLESS THE RELATED JOB RUNS ON THE SAME PROCESSOR, IT WILL
*        TERMINATE ABNORMALLY. THE SAME PROBLEM CAN OCCUR IF A SYSTEM
*        RESTART OCCURS AFTER 'IEFUJV' SETS THE ADDRESS BUT BEFORE THE
*        RELATED JOB TRIES TO USE THE ADDRESS. ADDITIONALLY, JOBS THAT
*        ARE REQUEUED FOR EXECUTION OR WARM START THROUGH THE $E
*        COMMAND ALSO CONTAIN INVALID DATA.
         SPACE 2
* IBM REFERENCE MANUAL : SYSTEM MANAGEMENT FACILITIES (SMF).
* ----------------------
         AIF   ('&SYSECT' EQ 'IEFUJV').SKIP
         SPACE 1
* USER-COMMUNICATION FIELD USE DESCRIPTION :
* ------------------------------------------
*
* CEPAUCOM +0-1 - NOT USED.
*          +2-3 - JOB I/O REQUEST IN 1/1000 :
*                 0 (X'0000') = NO I/O NUMBER LIMIT,
*                 2 HOURS IN SEC. (X'1C20') = MAXIMUM.
.SKIP    SPACE 2
&SYSECT  CSECT  .                  RESTORE ORIGINAL CSECT.
         SPACE 2
         MEND

*          DATA SET IEECB800   AT LEVEL 001 AS OF 04/21/76
         TITLE 'DISPLAY / TRACK COMMON PROCESSOR - BASE'
IEECB800 CSECT                                                     0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP00001-@MAINENT)
         DC    AL1(16)                                             0001
         DC    C'IEECB800  74.354'                                 0001
STAEXIT  DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL2(@EP00661-STAEXIT)
         ENTRY STAEXIT
         DROP  @15
@PROLOG  BALR  @11,0                                               0001
@PSTART  LA    @04,4095(,@11)                                      0001
         USING @PSTART,@11                                         0001
         USING @PSTART+4095,@04                                    0001
         LR    @10,@15                                             0001
         LR    @05,@01                                             0001
         L     @00,@SIZDATD                                        0001
         GETMAIN  R,LV=(0)
         LR    @12,@01                                             0001
         USING @DATD,@12                                           0001
         LR    @15,@10                                             0001
         LR    @01,@05                                             0001
         ST    @13,@SA00001+4                                      0001
         LR    @13,@12                                             0001
         AH    @15,4(,@15)                                         0001
         BR    @15                                                 0001
@EP00001 MVC   @PC00001(4),0(@01)                                  0001
*   CSCBPTR=R1;                     /* ESTABLISH CSCB ADDRESSABILITY */
         LR    CSCBPTR,R1                                          0093
*   R1=ADDR(WORKAREA);              /* GET ADDRESS OF WORKAREA       */
         LA    R1,WORKAREA                                         0094
*   R2=R1;                          /* AND USE IT FOR ESTAE PARM LIST*/
         LR    R2,R1                                               0095
*   REGDATA=R12;                    /* SAVE DATA REG                 */
         ST    R12,REGDATA(,R1)                                    0096
*   REGCODE1=R4;                    /* SAVE BASE REG         @ZA00073*/
         ST    R4,REGCODE1(,R1)                                    0097
*   REGCODE2=R11;                   /* SAVE BASE REG         @ZA00073*/
         ST    R11,REGCODE2(,R1)                                   0098
*   RTNADDR=R14;                    /* SAVE RETURN ADDRESS           */
         ST    R14,RTNADDR(,R1)                                    0099
*   R14SAVE=R14;                    /* SAVE RETURN ADDRESS   @ZA00073*/
         ST    R14,R14SAVE                                         0100
*   CSCBPASS=CSCBPTR;               /* PUT CSCB ADDRESS IN PARM LIST */
         ST    CSCBPTR,CSCBPASS(,R1)                               0101
*   RESPECIFY                                                      0102
*    (R8) RESTRICTED;                                              0102
*   RESPECIFY                                                      0103
*    (R11,                                                         0103
*     R12,                                                         0103
*     R14) UNRESTRICTED;                                           0103
*   IF CHVCD='C4'X THEN             /* IS THIS FOR A TRACK COMMAND?  */
         CLI   CHVCD(CSCBPTR),X'C4'                                0104
         BNE   @RF00104                                            0104
*     R8=ADDR(TCOMM);               /* YES, ADDR AND LENGTH OF TRACK */
         LA    R8,TCOMM                                            0105
*   ELSE                                                           0106
*     R8=ADDR(DCOMM);               /* NO, ADDR AND LENGTH OF DISPLAY*/
         B     @RC00104                                            0106
@RF00104 LA    R8,DCOMM                                            0106
*   COMMAND=R8;                     /* PUT COMMAND ADDR IN PARM LIST */
@RC00104 ST    R8,COMMAND(,R1)                                     0107
*   RESPECIFY                                                      0108
*    (CSCBPTR,                                                     0108
*     R8) UNRESTRICTED;                                            0108
*   GEN( LOAD EP=IEECB860 );        /* LOAD ESTAE CREATION MODULE    */
          LOAD EP=IEECB860
*   RESPECIFY                                                      0110
*    (R0,                                                          0110
*     R15) RESTRICTED;                                             0110
*   R15=R0;                         /* PUT ESTAE ENTRY ADDRESS IN R15*/
         LR    R15,R0                                              0111
*   R1=R2;                          /* RESTORE PARM LIST POINTER     */
         LR    R1,R2                                               0112
*   RESPECIFY                                                      0113
*    (R0,                                                          0113
*     R2) UNRESTRICTED;                                            0113
*   GEN(BALR R14,R15);              /* ESTABLISH ESTAE ENVIRONMENT   */
         BALR R14,R15
*                                                                  0115
*/*********************************************************************
**  THE DATA, MODULE, CSCB BASE REGS AND RETURN ADDRESS ARE RESTORED. *
**  IF ESTAE ENVIRONMENT WAS NOT SUCCESSFULLY ESTABLISHED     @YM4795P*
**    (A) FOR DISPLAY ACTIVE                                  @YM4795P*
**     1) MGCR IS INVOKED WITH REGISTER 1 POINTING TO THE CSCB WITH A *
**        BIT ON INDICATING THAT THE CSCB IS TO FREED.                *
**     2) UPON COMPLETION, REGISTER 14 IS RESTORED WITH THE RETURN    *
**        ADDRESS AND CONTROL IS RETURNED TO THE SYSTEM.              *
**    (B) FOR THE TRACK COMMAND                               @YM4795P*
**      1) INITIALIZE FOR STAEFAIL                            @YM4795P*
**         A REG 7=0  NO ECB FOR DIDOCS TO POST               @YM4795P*
**         B NO SDWA,TURN HAVESDWA BIT OFF                    @YM4795P*
**      2) GO TO STAEFAIL                                     @YM4795P*
**         A CLEAR TRACK BITS IN SACB                         @YM4795P*
**         B ISSUE MGCR TO FREE THE CSCB                      @YM4795P*
**         C RETURN TO THE SYSTEM                             @YM4795P*
**  IF SUCCESSFUL, COMMAND PROCESSING CONTINUES.                      *
**  IN ALL CASES, IEECB860 IS DELETED.                                *
**********************************************************************/
*                                                                  0115
*   RESPECIFY                                                      0115
*    (CSCBPTR,                                                     0115
*     R4,                                                          0115
*     R11,                                                         0115
*     R12) RESTRICTED;                                             0115
*   R4=REGCODE1;                    /* RESTORE SECONDARY BASE REG  0116
*                                                            @ZA00073*/
         L     R4,REGCODE1(,R1)                                    0116
*   R11=REGCODE2;                   /* RESTORE BASE REG      @ZA00073*/
         L     R11,REGCODE2(,R1)                                   0117
*   R12=REGDATA;                    /* RESTORE DATA REG              */
         L     R12,REGDATA(,R1)                                    0118
*   CSCBPTR=CSCBPASS;               /* RESTORE CSCB BASE REG         */
         L     CSCBPTR,CSCBPASS(,R1)                               0119
*   PARMADDR=R1;                    /* REINITIALIZE WORK AREA BASE   */
         ST    R1,PARMADDR                                         0120
*   RESPECIFY                                                      0121
*     STAELIST BASED(PARMADDR);                                    0121
*   RESPECIFY                                                      0122
*    (R7) RSTD;                     /*                       @YM4795P*/
*   IF R15^=0 THEN                  /* BAD RETURN CODE FROM ESTAE?   */
         LTR   R15,R15                                             0123
         BZ    @RF00123                                            0123
*     DO;                           /* YES, REQUEST SVC34 TO FREE  0124
*                                      CSCB, RETURN                  */
*       RESPECIFY                                                  0125
*        (R15) UNRESTRICTED;                                       0125
*       GEN(DELETE EP=IEECB860);                                   0126
         DELETE EP=IEECB860
*       IF CHVCD='C4'X THEN         /* IS THIS A TRACK CMD?  @YM4795P*/
         CLI   CHVCD(CSCBPTR),X'C4'                                0127
         BNE   @RF00127                                            0127
*         DO;                       /* YES,ZERO OUT REG 7 AND      0128
*                                                            @YM4795P*/
*           UCMECBAD=0;             /*                       @YM4795P*/
         SLR   @10,@10                                             0129
         L     @06,PARMADDR                                        0129
         ST    @10,UCMECBAD(,@06)                                  0129
*           R7=0;                   /* TURN OFF SDWA SWITCH  @YM4795P*/
         LR    R7,@10                                              0130
*           HAVESDWA='0'B;          /* FOR STEAFAIL ROUTINE  @YM4795P*/
         NI    HAVESDWA,B'11101111'                                0131
*           CALL FINDSACB;          /* LOCATE TRACKS SACB    @YM4795P*/
         BAL   @14,FINDSACB                                        0132
*           R7=UCMECBAD;            /* FOR POST TO DIDOCS    @YM4795P*/
         L     @10,PARMADDR                                        0133
         L     R7,UCMECBAD(,@10)                                   0133
*           GO TO STAEFAIL;         /* FOR CLEAN EXIT        @YM4795P*/
         B     STAEFAIL                                            0134
*         END;                      /*                       @YM4795P*/
*       ELSE                        /*                       @YM4795P*/
*         GO TO ALLDONE;            /* FREE CSCB AND RETURN  @YM4795P*/
*     END;                                                         0137
*   RESPECIFY                                                      0138
*    (R14) UNRESTRICTED;                                           0138
@RF00123 DS    0H                                                  0139
*   PARMLIST=PARMLIST&&PARMLIST;    /* INITIALIZE IEECB801   @ZA00055
*                                      PARAMETER LIST        @ZA00055*/
         XC    PARMLIST(16),PARMLIST                               0139
*   GEN(DELETE EP=IEECB860);                                       0140
         DELETE EP=IEECB860
*                                                                  0141
*/*********************************************************************
**  IF THE COMMAND IS DISPLAY, DROP THROUGH TO 'DISPLAY'.             *
**  IF THE COMMAND BEING PROCESSED IS TRACK:                          *
**     1) FOR CLEAN UP PURPOSES, ANOTHER LOWER LEVEL ESTAE            *
**        ENVIRONMENT IS CREATED FOR THE TRACK COMMAND.               *
**        AN ESTAE IS ISSUED SPECIFYING THAT THE ROUTINE 'STAEXIT'    *
**        SHOULD GET CONTROL WITH ADDRESSABILITY TO 'STAELIST' IF     *
**        AN UNPREDICTABLE ERROR OCCURS.                              *
**     2) IF ESTAE WAS NOT SUCCESSFULLY CREATED THEN          @YM4795P*
**        A INITIALIZE FOR STAEFAIL                           @YM4795P*
**          1 REG 7=0 NO ECB FOR DIDOCS TO POST               @YM4795P*
**          2 NO SDWA, TURN HAVESDWA BIT OFF                  @YM4795P*
**          3 R14SAVE=0 FORCE RETURN TO ABEND102 LABEL        @YM4795P*
**        B GO TO STAEFAIL                                    @YM4795P*
**          1 CLEAR TRACK BITS IN SACB                        @YM4795P*
**          2 ISSUE MGCR TO FREE THE CSCB                     @YM4795P*
**          3 RETURN TO ABEND102 LABEL. THIS WILL RESULT IN   @YM4795P*
**            THE STORAGE FOR IEECB800 TO BE FREEMAINED       @YM4795P*
**            BEFORE ISSUING A 102 ABEND.                     @YM4795P*
**        C ISSUE 102 ABEND. THIS WILL RESULT IN A COMMAND    @YM4795P*
**          FAILED MESSAGE ON THE CONSOLE                     @YM4795P*
**     3) A FLAG 'FIRSTRAK' IS TURNED ON TO INDICATE THAT THIS IS     *
**        THE FIRST TIME THROUGH THIS CODE FOR THIS TRACK COMMAND.    *
**********************************************************************/
*                                                                  0141
*   IF CHVCD='C4'X THEN             /* IS THIS A TRACK COMMAND?      */
         CLI   CHVCD(CSCBPTR),X'C4'                                0141
         BNE   @RF00141                                            0141
*     DO;                           /* YES, CONTINUE                 */
*       RESPECIFY                                                  0143
*        (R9,                                                      0143
*         R8) RESTRICTED;                                          0143
*       ESTAELST=ESTAELST&&ESTAELST;/* ESTAE INTERFACE               */
         XC    ESTAELST(24),ESTAELST                               0144
*       SACBADDR=0;                 /* ZERO THESE ADDR FOR ESTAE     */
         SLR   @10,@10                                             0145
         L     @06,PARMADDR                                        0145
         ST    @10,SACBADDR(,@06)                                  0145
*       UCMECBAD=0;                 /* INTERFACE - TO BE SET LATER   */
         ST    @10,UCMECBAD(,@06)                                  0146
*       R1=ADDR(ESTAELST);          /* REQUIRED FOR ESTAE MACRO      */
         LA    R1,ESTAELST                                         0147
*       R8=ADDR(STAEXIT);           /* THIS TASK'S STAE RTN ADDR     */
         L     R8,@CA02587                                         0148
*       R9=ADDR(STAELIST);          /* INPUT TO THIS TASK'S STAE RTN */
         LR    R9,@06                                              0149
*       GEN(ESTAE (8),RECORD=YES,PARAM=(9),MF=(E,(1)));            0150
         ESTAE (8),RECORD=YES,PARAM=(9),MF=(E,(1))
*       RESPECIFY                                                  0151
*        (R8,                                                      0151
*         R9) UNRESTRICTED;                                        0151
*       RESPECIFY                                                  0152
*        (R15) RESTRICTED;                                         0152
*       IF R15^=0 THEN              /* SUCCESSFYLLY CREATED?         */
         SLR   @14,@14                                             0153
         CR    R15,@14                                             0153
         BE    @RF00153                                            0153
*         DO;                       /* ESTAE FAILED          @YM4795P*/
*           HAVESDWA='0'B;          /* TURN SDWA BIT OFF     @YM4795P*/
         NI    HAVESDWA,B'11101111'                                0155
*           R14SAVE=0;              /* ZERO OUT RETURN ADDR  @ZA00073*/
         ST    @14,R14SAVE                                         0156
*           CALL FINDSACB;          /* LOCATE TRACKS SACB    @YM4795P*/
         BAL   @14,FINDSACB                                        0157
*           R7=UCMECBAD;            /* FOR POST TO DIDOCS    @YM4795P*/
         L     @14,PARMADDR                                        0158
         L     R7,UCMECBAD(,@14)                                   0158
*           GO TO STAEFAIL;         /* FREE CSCB,CLEAR SACB  @YM4795P*/
         B     STAEFAIL                                            0159
*ABEND102:                          /* RETURN FROM STAEFAIL  @YM4795P*/
*           GEN(ABEND 102);         /* USER ABEND IEECB66    @YM4795P*/
ABEND102 ABEND 102
*         END;                      /* WILL ISSUE CMD FAIL MSG     0161
*                                                            @YM4795P*/
*       ELSE                                                       0162
*         ;                         /* YES, CONTINUE                 */
@RF00153 DS    0H                                                  0163
*       RESPECIFY                                                  0163
*        (R7,                                                      0163
*         R15) UNRSTD;              /*                       @YM4795P*/
*       FIRSTRAK='1'B;              /* SWITCH FOR DCMADEND CHECK   0164
*                                                            @YM01918*/
         OI    FIRSTRAK,B'10000000'                                0164
*                                                                  0165
*/*********************************************************************
**     2) THE CMS AND LOCAL LOCKS ARE OBTAINED TO INSURE SERIALIZATION*
**        OF THE TRACK TERMINATION BITS IN THE SACB AND THE POSTING OF*
**        THE ECB IN THE CSCB.                                        *
**     CONTROL IS ALSO PASSED HERE WHEN THE WAIT ISSUED AT 'ECBWAIT'  *
**     IS SATISFIED.I.E. WHEN THE TERMINATION ECB OR THE STIMER ECB   *
**     IS POSTED.                                                     *
** NOTE: REGISTER 12 MUST BE SAVED SEPARATELY SINCE IT IS THE BASE    *
**       REGISTER FOR 'LOCKSAVE'.                                     *
**********************************************************************/
*                                                                  0165
*AWAKE:                                                            0165
*       RESPECIFY                                                  0165
*        (R6) RESTRICTED;                                          0165
AWAKE    DS    0H                                                  0166
*       GENERATE;                                                  0166
             STM     R11,R14,LOCKSAVE    SAVE REGISTERS ACROSS SETLOCK
             LR      R6,R12              SAVE DATA REGISTER
             SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                    X
               RELATED=LOCKSOFF
             SETLOCK OBTAIN,TYPE=CMS,MODE=UNCOND,                      X
               RELATED=LOCKSOFF
             LR      R12,R6              RESTORE DATA REGISTER
             LM      R11,R14,LOCKSAVE    RESTORE REGISTERS
*       RESPECIFY                                                  0167
*        (R6) UNRESTRICTED;                                        0167
*                                                                  0168
*/*********************************************************************
**  THE SACB AND CSCB BASE REGISTERS MUST BE RESTORED FROM THE        *
**  STAELIST EACH TIME THE TRACK PROCESSOR IS REACTIVATED.            *
**     3) IF THE TRACK ECB IN THE CSCB HAS BEEN POSTED BY CONSOLE     *
**        CLOSE OR BY DIDOCS: COMPLETION CODE = 0                     *
**        A) THE LOCKS ARE RELEASED.                                  *
**        B) MGCR IS INVOKED WITH REGISTER 1 POINTING TO THE CSCB     *
**           WITH THE BIT ON INDICATING THAT THE CSCB CORE IS TO BE   *
**           FREED.                                                   *
**        C) UPON COMPLETION, CONTROL IS RETURN TO THE SYSTEM         *
**           VIA REG 14.                                              *
**********************************************************************/
*                                                                  0168
*ECBPOST:                           /* SHOULD TASK BE TERMINATED?    */
*       RESPECIFY                                                  0168
*        (SACBPTR) RESTRICTED;                                     0168
ECBPOST  DS    0H                                                  0169
*       CSCBPTR=CSCBPASS;           /* TO INSURE PROPER CSCB ADDRESS */
         L     @10,PARMADDR                                        0169
         L     CSCBPTR,CSCBPASS(,@10)                              0169
*       SACBPTR=SACBADDR;           /* RESTORE SACB BASE             */
         L     SACBPTR,SACBADDR(,@10)                              0170
*       IF CHCECB=POSTED THEN       /* WAS ECB POSTED BY DIDOCS?     */
         CLC   CHCECB(4,CSCBPTR),POSTED                            0171
         BNE   @RF00171                                            0171
*         DO;                       /* YES, RELEASE LOCKS, REQUEST 0172
*                                      SVC34 TO FREE CSCB AND RETURN */
*           CHCECB=0;               /* ZERO OUT DIDOCS/PT/K D,U ECB
*                                                            @YM2779P*/
         SLR   @10,@10                                             0173
         ST    @10,CHCECB(,CSCBPTR)                                0173
*           CALL LOCKSOFF;          /* RELEASE THE LOCKS             */
         BAL   @14,LOCKSOFF                                        0174
*           GO TO ALLDONE;          /* BRANCH TO EXIT CODE           */
         B     ALLDONE                                             0175
*         END;                                                     0176
*       ELSE                                                       0177
*         ;                                                        0177
@RF00171 DS    0H                                                  0178
*                                                                  0178
*/*********************************************************************
**     4) IF THIS IS THE FIRST PASS THROUGH (SACBADDR WILL STILL BE   *
**        ZERO) THE ADDRESS OF THE SACB (SCREEN AREA CONTROL BLOCK)   *
**        WHICH DEFINES THE AREA INTO WHICH THE TRACK DISPLAY SHOULD  *
**        BE PLACED IS OBTAINED.                                      *
**        A) ITS ADDRESS AND THE CORRESPONDING UCmE ECB ADDRESSes ARE *
**           SAVED IN THE ESTAE PARMLIST (STAELIST) for RECOVERY      *
**           PURPOSES.                                                *
**********************************************************************/
*                                                                  0178
*       IF SACBADDR=0 THEN          /* WILL BE 0 1ST TIME THRU       */
         L     @10,PARMADDR                                        0178
         ICM   @02,15,SACBADDR(@10)                                0178
         BNZ   @RF00178                                            0178
*         CALL FINDSACB;            /* LOCATE TRACKS SACB    @YM4795P*/
         BAL   @14,FINDSACB                                        0179
*       ELSE                                                       0180
*         ;                                                        0180
@RF00178 DS    0H                                                  0181
*                                                                  0181
*/*********************************************************************
**     5) IF THE TRACK ECB IN THE CSCB HAS BEEN POSTED AS THE RESULT  *
**        OF A STOPTR COMMAND: COMPLETION CODE = 4                    *
**        A) THE TRACK OPTIONS BITS, TIME INTERVAL AND ADDRESS OF THE *
**           TRACK ECB ARE CLEARED IN THE SACB.                       *
**        B) THE LOCKS ARE RELEASED.                                  *
**        C) MGCR IS INVOKED WITH REGISTER 1 POINTING TO THE CSCB     *
**           WITH THE BIT ON INDICATING THAT THE CSCB CORE IS TO BE   *
**           FREED.                                                   *
**        D) UPON COMPLETION, CONTROL IS RETURN TO THE SYSTEM         *
**           VIA REG 14.                                              *
**     6) OTHERWISE, THE MOST RECENT TRACK OPTIONS AND TIME INTERVAL  *
**        ARE MOVED FROM THE SACB TO THE CSCB.                        *
**********************************************************************/
*                                                                  0181
*       IF CHCECB=PTPOSTED          /* WAS ECB POSTED BY STOPTR?     */
*           ×DCMATRCK='00'X         /* ANY TRACK OPTION      @ZA00073*/
*           ×DCMAUTME='0000'X THEN  /* TIME INTERVAL?        @ZA00073*/
         CLC   CHCECB(4,CSCBPTR),PTPOSTED                          0181
         BE    @RT00181                                            0181
         CLI   DCMATRCK(SACBPTR),X'00'                             0181
         BE    @RT00181                                            0181
         ICM   @10,3,DCMAUTME(SACBPTR)                             0181
         BNZ   @RF00181                                            0181
@RT00181 DS    0H                                                  0182
*         DO;                       /* YES, CLEAR TRACK FIELDS IN  0182
*                                      SACB, RELEASE LOCKS, REQUEST
*                                      SVC34 TO FREE CSCB AND RETURN */
*           CHCECB=0;               /* ZERO OUT DIDOCS/PT/K D,U ECB
*                                                            @YM2779P*/
         SLR   @10,@10                                             0183
         ST    @10,CHCECB(,CSCBPTR)                                0183
*           DCMADFLG=DCMADFLG&'20'X;/* TURN ALL OFF BUT DIDOCS BIT   */
         NI    DCMADFLG(SACBPTR),X'20'                             0184
*           DCMATRCK='00'X;         /* TURN OFF TRACK OPTIONS        */
         MVI   DCMATRCK(SACBPTR),X'00'                             0185
*           DCMAUTME='0000'X;       /* CLEAR TRACK TIME INTERVAL     */
         SLR   @10,@10                                             0186
         STH   @10,DCMAUTME(,SACBPTR)                              0186
*           DCMATECB='00000000'X;   /* CLEAR TRACK CANCEL ECB ADDR   */
         SLR   @10,@10                                             0187
         ST    @10,DCMATECB(,SACBPTR)                              0187
*           CALL LOCKSOFF;          /* RELEASE THE LOCKS             */
         BAL   @14,LOCKSOFF                                        0188
*           GO TO ALLDONE;          /* BRANCH TO EXIT CODE           */
         B     ALLDONE                                             0189
*         END;                                                     0190
*       ELSE                                                       0191
*         ;                         /* NO, ATTEMPT TO UPDATE DISPLAY */
@RF00181 DS    0H                                                  0192
*       RESPECIFY                                                  0192
*        (R14) UNRESTRICTED;                                       0192
*       CHTRSTAT=DCMATRCK;          /* SAVE TRACK REQUEST INDICATORS */
         MVC   CHTRSTAT(1,CSCBPTR),DCMATRCK(SACBPTR)               0193
*       CHPEND=DCMAUTME*100;        /* SAVE TRACK TIME INTERVAL      */
         LH    @10,DCMAUTME(,SACBPTR)                              0194
         MH    @10,@CH00921                                        0194
         ST    @10,CHPEND(,CSCBPTR)                                0194
*       CHCECB=0;                   /* ZERO OUT DIDOCS/PT/K D,U ECB
*                                                            @YM2779P*/
         SLR   @10,@10                                             0195
         ST    @10,CHCECB(,CSCBPTR)                                0195
**        A) IF ON, MEANING THE DISPLAY SHOULD NOT BE UPDATED:        *
**           1) THE LOCKS ARE RELEASED.                               *
**           2) THE STIMER MACRO IS ISSUED WITH THE UPDATED TIME      *
**              INTERVAL.                                             *
**           3) AND A WAIT MACRO IS ISSUED AT 'ECBWAIT' AGAINST THE   *
**              TRACK ECBS.                                           *
**********************************************************************/
*                                                                  0197
*HOLDMODE:                                                         0197
*       IF DCMAHOLD='1'B THEN       /* IS TRACK DISPLAY IN HOLD MODE?*/
HOLDMODE TM    DCMAHOLD(SACBPTR),B'01000000'                       0197
         BNO   @RF00197                                            0197
*         DO;                       /* YES                           */
*           CALL LOCKSOFF;          /* RELEASE THE LOCKS             */
         BAL   @14,LOCKSOFF                                        0199
*           R1=ADDR(CHPEND);        /* ADDRESS OF TIME INTERVAL      */
         LA    R1,CHPEND(,CSCBPTR)                                 0200
*           GEN(STIMER REAL,TIMEPOP,BINTVL=(1),ERRET=ALLDONE);     0201
         STIMER REAL,TIMEPOP,BINTVL=(1),ERRET=ALLDONE
*           GOTO ECBWAIT;           /* WAIT ON ECB'S                 */
         B     ECBWAIT                                             0202
*         END;                                                     0203
*       ELSE                                                       0204
*         ;                         /* NO, CONTINUE                  */
@RF00197 DS    0H                                                  0205
*                                                                  0205
*/*********************************************************************
**     8) OTHERWISE, THE SACB FLAGS ARE NEXT INTERROGATED TO SEE IF   *
**        DIDOCS HAS FINISHED WRITING THE PREVIOUS TRACK DISPLAY TO   *
**        THE SCREEN. FIRSTRAK WILL BE ON IF THIS IS THE FIRST        *
**        DISPLAY AND THERE IS NO PREVIOUS DISPLAY. DCMADEND WILL     *
**        BE ON IF DIDOCS HAS FINISHED ITS I/O.                       *
**           IF NOT:                                                  *
**           1) THE LOCKS ARE RELEASED.                               *
**           2)  'IEE920I NO TR A UPDATE AT HH.MM.SS' WILL BE ISSUED  *
**          A ------------------------------------------------------  *
**  WPL      × MESSAGE LENGTH + 4 =     × MCS FLAGS =              ×  *
**            ------------------------------------------------------  *
**           ×    'IEE920I NO TRACK UPDATE AT HH.MM.SS'            ×  *
**            ------------------------------------------------------  *
**  WPLFLGS  × DESCRIPTOR CODES =      × ROUTING CODES =           ×  *
**            ------------------------------------------------------  *
**  WPLLS01  × LINE TYPE =   × AREA ID =   × NUMBER OF LINES =     ×  *
**          B ------------------------------------------------------  *
**           3) THE STIMER MACRO IS ISSUED WITH THE UPDATED TIME      *
**              INTERVAL.                                             *
**           4) AND A WAIT MACRO IS ISSUED AT 'ECBWAIT' AGAINST THE   *
**              TRACK ECBS.                                           *
**     9) OTHERWISE, THE 'FIRSTRAK' FLAG IS TURNED OFF INDICATING     *
**        THAT FROM NOW ON IT IS PROBABLE THAT A TRACK DISPLAY WILL   *
**        BE IN THE AREA, THE LOCKS ARE RELEASED, THE STIMER ISSUED   *
**        AND PROCESSING CONTINUES AS IF IT WERE A DISPLAY COMMAND.   *
**********************************************************************/
*                                                                  0205
*       IF FIRSTRAK^='1'B&          /* IS THIS NOT FIRST TRACK &   0205
*                                                            @YM01918*/
*           DCMADEND^='1'B&         /* HAS DIDOCS NOT FINISHED?      */
*           DCMAFULL^='1'B THEN     /* THE AREA IS NOT FULL  @YM2772P*/
         TM    FIRSTRAK,B'10000000'                                0205
         BO    @RF00205                                            0205
         TM    DCMADEND(SACBPTR),B'00101000'                       0205
         BNZ   @RF00205                                            0205
*         DO;                       /* RIGHT ON                      */
*           RESPECIFY                                              0207
*            (SACBPTR) UNRESTRICTED;                               0207
*           CALL LOCKSOFF;          /* RELEASE THE LOCKS             */
         BAL   @14,LOCKSOFF                                        0208
*           RESPECIFY                                              0209
*            (WPLPTR) RESTRICTED;                                  0209
*           WTOBUF(1:NOUPLGTH)=NOUPDATE(1:NOUPLGTH);/* IEE920I       */
         SLR   @10,@10                                             0210
         IC    @10,NOUPLGTH                                        0210
         BCTR  @10,0                                               0210
         EX    @10,@SM02671                                        0210
*           WPLPTR=ADDR(CHSWT)+16;  /* SET FOR TIME STAMP    @YM01918*/
         LA    WPLPTR,CHSWT(,CSCBPTR)                              0211
         AH    WPLPTR,@CH00950                                     0211
*           CALL TIMESNAP;          /* GO GET TIME STAMP             */
         BAL   @14,TIMESNAP                                        0212
*           R1=ADDR(PARMLIST);      /* PARM LIST TO IEECB801         */
         LA    R1,PARMLIST                                         0213
*           CSCBADDR=CSCBPTR;       /* ADDR OF THIS TASK'S CSCB      */
         ST    CSCBPTR,CSCBADDR                                    0214
*           MESSADDR=ADDR(CHSWT);   /* ADDRESS OF MESSAGE            */
         LA    @10,CHSWT(,CSCBPTR)                                 0215
         STCM  @10,7,MESSADDR                                      0215
*           NOUPFLAG='1'B;          /* INDICATE IEE920I TO BE ISSUED */
         OI    NOUPFLAG,B'01000000'                                0216
*           CALL IEECB801;          /* HAVE MESSAGE ISSUED           */
         L     @15,@CV02408                                        0217
         BALR  @14,@15                                             0217
*           RESPECIFY                                              0218
*            (WPLPTR) UNRESTRICTED;                                0218
*           R1=ADDR(CHPEND);        /* ADDRESS OF TIME INTERVAL      */
         LA    R1,CHPEND(,CSCBPTR)                                 0219
*           GEN(STIMER REAL,TIMEPOP,BINTVL=(1),ERRET=ALLDONE);     0220
         STIMER REAL,TIMEPOP,BINTVL=(1),ERRET=ALLDONE
*           GOTO ECBWAIT;           /* WAIT ON ECB'S                 */
         B     ECBWAIT                                             0221
*         END;                                                     0222
*       ELSE                                                       0223
*         DO;                       /* EVERYTHING IS A-OK            */
@RF00205 DS    0H                                                  0224
*           RESPECIFY                                              0224
*            (SACBPTR) UNRESTRICTED;                               0224
*           FIRSTRAK='0'B;          /* IEE920I SITUATION NOW VALID 0225
*                                                            @YM01918*/
         NI    FIRSTRAK,B'01111111'                                0225
*           CALL LOCKSOFF;          /* RELEASE THE LOCKS             */
         BAL   @14,LOCKSOFF                                        0226
*           R1=ADDR(CHPEND);        /* ADDRESS OF TIME INTERVAL      */
         LA    R1,CHPEND(,CSCBPTR)                                 0227
*           GEN(STIMER REAL,TIMEPOP,BINTVL=(1),ERRET=ALLDONE);     0228
         STIMER REAL,TIMEPOP,BINTVL=(1),ERRET=ALLDONE
*         END;                                                     0229
*     END;                                                         0230
*                                                                  0231
*/*********************************************************************
**  FOR BOTH DISPLAY AND TRACK COMMANDS A GETMAIN IS ISSUED FOR THE   *
**  MAXIMUM LENGTH OF 10 MLWTO LINES (MAXMLWTO).                      *
**  IF THIS GETMAIN FAILS:                                            *
**     1) THE MAIN HEADER AND ERR LINE ARE BUILT IN THE CSCB COMMAND  *
**        BUFFER AREA.                                                *
**          A ------------------------------------------------------  *
**  WPL      × MESSAGE LENGTH + 4 =     × MCS FLAGS =              ×  *
**            ------------------------------------------------------  *
**           ×    'IEE102I HH.MM.SS ACTIVE TASKS'                  ×  *
**            ------------------------------------------------------  *
**  WPLFLGS  × DESCRIPTOR CODES =      × ROUTING CODES =           ×  *
**            ------------------------------------------------------  *
**  WPLLS01  × LINE TYPE =   × AREA ID =   × NUMBER OF LINES =     ×  *
**          B ------------------------------------------------------  *
**  WPLML    × MESSAGE LENGTH + 4 =     × MCS FLAGS =              ×  *
**            ------------------------------------------------------  *
**           ×   'DISPLAY TRUNCATED - INSUFFICIENT STORAGE'        ×  *
**          C ------------------------------------------------------  *
**        A) THE TIME MACRO IS ISSUED TO GET THE CURRENT TIME VALUE   *
**           WHICH IS UNPACKED AND ADDED TO THE HEADER TEXT.          *
**           1) IF ERR IN TIME MACRO, TIME IN MSG TEXT WILL BE ZERO.  *
**        B) THE AREA ID IS OBTAINED FROM THE CSCB.                   *
**        C) THE NUMBER OF LINES TO BE WRITTEN IS 2.                  *
**     2) IEECB801 IS INVOKED TO ISSUE THE MESSAGES WITH THE PARMLIST *
**        POINTED TO BY REGISTER 1 CONTAINING THE ADDRESS OF THIS     *
**        TASK'S CSCB, THE ADDRESS OF THE MESSAGE BUFFER, AND AN      *
**        INDICATOR THat THE MESSAGE BUFFER IS IN THE CSCB.           *
**     3) CONTROL THEN PASSES TO 'TERMCODE' TO FREE THE CSCB AND      *
**        RETURN FOR DISPLAY OR ISSUE THE WAIT FOR TRACK.             *
**********************************************************************/
*                                                                  0231
*DISPLAY:                                                          0231
*   SPECIAL1='0'B;                  /* HEADER FOR NON-FIRST 10 SWITCH
*                                                            @YM01918*/
@RF00141 DS    0H                                                  0231
DISPLAY  DS    0H                                                  0232
*   SPECIAL2='0'B;                  /* ZERO OUT SECOND LINE INDICATOR
*                                                            @ZA00055*/
         NI    SPECIAL1,B'10011111'                                0232
*   FIRSTIME='1'B;                  /* 1ST 10-AT-A-TIME SWITCH       */
         OI    FIRSTIME,B'00100000'                                0233
*   RESPECIFY                                                      0234
*    (R6,                                                          0234
*     R15) RESTRICTED;                                             0234
*   GETLIST(1:GETLGTH)=GETAREA(1:GETLGTH);/* BUILD GETMAIN LIST      */
         LH    @14,GETLGTH                                         0235
         BCTR  @14,0                                               0235
         EX    @14,@SM02676                                        0235
*   GENLGTH=MAXMLWTO;               /* THE CORE SIZE NEEDED IS     0236
*                                      INITIALIZED                   */
         LH    @14,MAXMLWTO                                        0236
         ST    @14,GENLGTH                                         0236
*   R6=ADDR(BUFPTR);                /* SAVE ORIGINAL GOTTEN CORE   0237
*                                      ADDRESS                       */
         LA    R6,BUFPTR                                           0237
*   R1=ADDR(GETLIST);               /* REG 1 POINTS TO GETMAIN LIST  */
         LA    R1,GETLIST                                          0238
*   GEN(GETMAIN MF=(E,(1)),A=(6));                                 0239
         GETMAIN MF=(E,(1)),A=(6)
*   RESPECIFY                                                      0240
*    (WPLPTR) RESTRICTED;                                          0240
*   IF R15^=0 THEN                  /* WAS IT SUCCESSFUL?            */
         LTR   R15,R15                                             0241
         BZ    @RF00241                                            0241
*     DO;                           /* NO, MOVE MAIN & ERR INTO CSCB */
*       RESPECIFY                                                  0243
*        (R6,                                                      0243
*         R15) UNRESTRICTED;                                       0243
*       WPLPTR=ADDR(CHSWT);         /* ESTABLISH ADDRESSABILITY FOR
*                                      MESSAGE TEXT                  */
         LA    WPLPTR,CHSWT(,CSCBPTR)                              0244
*       WPL(1:HEADLGTH)=HEADTEXT(1:HEADLGTH);/* MAIN HEADER  @YM01918*/
         SLR   @10,@10                                             0245
         IC    @10,HEADLGTH                                        0245
         BCTR  @10,0                                               0245
         EX    @10,@SM02678                                        0245
*       CALL TIMESNAP;              /* GO GET TIME STAMP             */
         BAL   @14,TIMESNAP                                        0246
*       WPLMCSFJ='1'B;              /* MULTI-LINE WTO FLAG           */
         OI    WPLMCSFJ(WPLPTR),B'01000000'                        0247
*       WPLPTR=WPLPTR+WPLLGH+LENGTH(WPLFLGS)-4;                    0248
         LR    @10,WPLPTR                                          0248
         AH    @10,WPLLGH(,WPLPTR)                                 0248
         SH    @10,@CH02663                                        0248
         LR    WPLPTR,@10                                          0248
*       WPLAREA=CHARID;             /* GET AREA ID FOR CRT (Z=PAPER) */
         MVC   WPLAREA(1,WPLPTR),CHARID(CSCBPTR)                   0249
*       WPLLINES=2;                 /* NUMBER OF LINES = 2           */
         MVI   WPLLINES(WPLPTR),X'02'                              0250
*       WPLPTR=WPLPTR+LENGTH(WPLLS01);/*                     @YM01918*/
         AH    WPLPTR,@CH00034                                     0251
*       WPLML(1:ERRLGTH)=ERRTEXT(1:ERRLGTH);/* ERR LINE      @YM01918*/
         SLR   @10,@10                                             0252
         IC    @10,ERRLGTH                                         0252
         BCTR  @10,0                                               0252
         EX    @10,@SM02680                                        0252
*NOTIME:                                                           0253
*       R1=ADDR(PARMLIST);          /* PARM LIST FOR IEECB801        */
NOTIME   LA    R1,PARMLIST                                         0253
*       CSCBADDR=CSCBPTR;           /* PUT CSCB ADDR IN PARM LIST    */
         ST    CSCBPTR,CSCBADDR                                    0254
*       CSCBFLAG='1'B;              /* INDICATE MSG IN CSCB          */
         OI    CSCBFLAG,B'10000000'                                0255
*       MESSADDR=ADDR(CHSWT);       /* ADDR OF MSG IN PARM LIST      */
         LA    @10,CHSWT(,CSCBPTR)                                 0256
         STCM  @10,7,MESSADDR                                      0256
*       CALL IEECB801;              /* GO TO IEECB801 TO ISSUE MSG   */
         L     @15,@CV02408                                        0257
         BALR  @14,@15                                             0257
*       GO TO TERMCODE;             /* TERMINATE THIS CYCLE          */
         B     TERMCODE                                            0258
*     END;                                                         0259
*                                                                  0260
*/*********************************************************************
**    IF INITIAL GETMAIN WAS SUCCESSFUL.                              *
**       1) THE NUMBER OF LINE COUNT IS INITIALIZED TO 0.             *
**       2) THE MAIN HEADER IS MOVED INTO THE GOTTEN AREA.            *
**          A ------------------------------------------------------  *
**  WPL      × MESSAGE LENGTH + 4 =     × MCS FLAGS =              ×  *
**            ------------------------------------------------------  *
**           ×    'IEE102I HH.MM.SS ACTIVE TASKS'                  ×  *
**            ------------------------------------------------------  *
**  WPLFLGS  × DESCRIPTOR CODES =      × ROUTING CODES =           ×  *
**            ------------------------------------------------------  *
**  WPLLS01  × LINE TYPE =   × AREA ID =   × NUMBER OF LINES =     ×  *
**          B ------------------------------------------------------  *
**       3) ISSUE TIME MACRO TO GET CURRENT TIME VALUE, UNPACK AND PUT*
**          IN MESSAGE.                                               *
**          A) IF ERR IN TIME MACRO, TIME IN MSG TEXT WILL BE ZERO.   *
**       4) THE MLWTO INDICATOR IS SET.                               *
**       5) THE LINE COUNT IS INCREMENTED BY 1.                       *
**********************************************************************/
*                                                                  0260
*   RESPECIFY                                                      0260
*    (R6,                                                          0260
*     R15) UNRESTRICTED;                                           0260
@RF00241 DS    0H                                                  0261
*   COUNT=0;                        /* INITIALIZE LINE COUNT TO 0    */
         MVI   COUNT,X'00'                                         0261
*   WPLPTR=BUFPTR;                  /* GET ADDRESS OF GOTTEN CORE    */
         L     WPLPTR,BUFPTR                                       0262
*   WPL(1:HEADLGTH)=HEADTEXT(1:HEADLGTH);/* MOVE MAIN HEADER         */
         SLR   @10,@10                                             0263
         IC    @10,HEADLGTH                                        0263
         BCTR  @10,0                                               0263
         EX    @10,@SM02678                                        0263
*   CALL TIMESNAP;                  /* GET TIME STAMP                */
         BAL   @14,TIMESNAP                                        0264
*   WPLMCSFJ='1'B;                  /* MULTI-LINE WTO FLAG           */
         OI    WPLMCSFJ(WPLPTR),B'01000000'                        0265
*   WPLPTR=WPLPTR+WPLLGH+LENGTH(WPLFLGS)-4+LENGTH(WPLLS01);/*      0266
*                                                            @YM01918*/
         LR    @10,WPLPTR                                          0266
         AH    @10,WPLLGH(,WPLPTR)                                 0266
         AH    @10,@CH00196                                        0266
         LR    WPLPTR,@10                                          0266
*   COUNT=COUNT+1;                  /* INCREMENT LINE COUNT          */
         LA    @10,1                                               0267
         SLR   @09,@09                                             0267
         IC    @09,COUNT                                           0267
         ALR   @10,@09                                             0267
         STC   @10,COUNT                                           0267
*                                                                  0268
*/*********************************************************************
**    ENQUEUING SHARED ON THE CSCB CHAIN, THE NUMBER OF ACTIVE TASKS  *
**    IS DETERMINED AND CATEGORIZED (THE DEQUEUE IS ISSUED AT         *
**    CLEANUP).                                                       *
**       1) IF THE OPTION WAS 'JOBS' OR 'JOBS,LIST' OR 'A' OR         *
**          'A,LIST':                                                 *
**          A) THE JOBS COUNTER IS INCREMENTED EACH TIME A JOB OR     *
**             TASK CSCB IS ENCOUNTERED.                              *
**          B) THE INIT COUNTER IS INCREMENTED EACH TIME AN INIT      *
**             CSCB IS ENCOUNTERED.                                   *
**       2) IF THE OPTION WAS 'TS' OR 'TS,LIST' OR 'A' OR 'A,LIST':   *
**          THE TS COUNTER IS INCREMENTED EACH TIME A TS USER         *
**          CSCB IS ENCOUNTERED.                                      *
**    THE JOBS, INIT, AND TS COUNTERS, IF THEY CONTAIN A VALID NUMBER *
**    (NON-ZERO), ARE THEN CONVERTED-TO-DECIMAL AND UNPACKED AND THE  *
**    RESULTING VALUE IS PLACED IN THE APPROPIATE SUB-HEADER.         *
**********************************************************************/
*                                                                  0268
*TIMEROUT:                                                         0268
*   ENQDEQL(1:ELEN)=EENQ(1:ELEN);   /* BUILD ENQ LIST                */
TIMEROUT LH    @10,ELEN                                            0268
         BCTR  @10,0                                               0268
         EX    @10,@SM02682                                        0268
*   R1=ADDR(ENQDEQL);               /* WORKAREA ADDRESSED BY REG 1   */
         LA    R1,ENQDEQL                                          0269
*   GEN(ENQ MF=(E,(1)));                                           0270
         ENQ MF=(E,(1))
*   CSCBPTR=BACHN;                  /* GET ADDR OF 1ST CSCB FROM   0271
*                                      BASEA                         */
         L     @10,CVTPTR                                          0271
         L     @10,CVTMSER(,@10)                                   0271
         L     CSCBPTR,BACHN(,@10)                                 0271
*   JOBNUM=0;                       /* INIT ACTIVE JOBS & TASK     0272
*                                      COUNTER                       */
         SLR   @10,@10                                             0272
         ST    @10,JOBNUM                                          0272
*   INITNUM=0;                      /* INIT ACTIVE INIT COUNTER      */
         ST    @10,INITNUM                                         0273
*   TSNUM=0;                        /* INIT ACTIVE TS USERS COUNTER  */
         ST    @10,TSNUM                                           0274
*   RESPECIFY                                                      0275
*    (TASKCSCB) RESTRICTED;                                        0275
*   TASKCSCB=CSCBPASS;              /* INIT THIS TASK'S CSCB BASE    */
         L     @09,PARMADDR                                        0276
         L     TASKCSCB,CSCBPASS(,@09)                             0276
*   DO WHILE CSCBPTR^=0;            /* LOOP THRU ENTIRE CSCB CHAIN   */
         B     @DE00277                                            0277
@DL00277 DS    0H                                                  0278
*     IF TASKCSCB->CHJOBS='1'B×     /* JOBS OR JOBS,LIST             */
*         TASKCSCB->CHJOBSL='1'B THEN/* OPTION SPECIFIED?            */
         TM    CHJOBS(TASKCSCB),B'11000000'                        0278
         BZ    @RF00278                                            0278
*       DO;                                                        0279
*         IF CHTRKID='02'X THEN     /* YES, IS THIS JOB OR TASK CSCB?*/
         CLI   CHTRKID(CSCBPTR),X'02'                              0280
         BNE   @RF00280                                            0280
*           JOBNUM=JOBNUM+1;        /* YES, INCREMENT COUNTER        */
         LA    @09,1                                               0281
         AL    @09,JOBNUM                                          0281
         ST    @09,JOBNUM                                          0281
*         ELSE                                                     0282
*           ;                                                      0282
@RF00280 DS    0H                                                  0283
*         IF CHTRKID='03'X THEN     /* IS THIS INIT CSCB?            */
         CLI   CHTRKID(CSCBPTR),X'03'                              0283
         BNE   @RF00283                                            0283
*           INITNUM=INITNUM+1;      /* YES, INCREMENT COUNTER        */
         LA    @09,1                                               0284
         AL    @09,INITNUM                                         0284
         ST    @09,INITNUM                                         0284
*         ELSE                                                     0285
*           ;                                                      0285
@RF00283 DS    0H                                                  0286
*       END;                                                       0286
*     ELSE                                                         0287
*       ;                                                          0287
@RF00278 DS    0H                                                  0288
*     IF TASKCSCB->CHTS='1'B×       /* TS OR TS,LIST                 */
*         TASKCSCB->CHTSL='1'B THEN /* OPTION SPECIFIED?             */
         TM    CHTS(TASKCSCB),B'00001100'                          0288
         BZ    @RF00288                                            0288
*       IF CHTRKID='01'X THEN       /* YES, IS THIS TS USER?         */
         CLI   CHTRKID(CSCBPTR),X'01'                              0289
         BNE   @RF00289                                            0289
*         TSNUM=TSNUM+1;            /* YES, INCREMENT COUNTER        */
         LA    @09,1                                               0290
         AL    @09,TSNUM                                           0290
         ST    @09,TSNUM                                           0290
*       ELSE                                                       0291
*         ;                                                        0291
@RF00289 DS    0H                                                  0292
*     ELSE                                                         0292
*       ;                                                          0292
@RF00288 DS    0H                                                  0293
*     CSCBPTR=CHPTR;                /* POINTER TO NEXT CSCB          */
         L     CSCBPTR,CHPTR(,CSCBPTR)                             0293
*   END;                            /* WHEN 0, LAST ONE              */
@DE00277 SLR   @09,@09                                             0294
         CR    CSCBPTR,@09                                         0294
         BNE   @DL00277                                            0294
*                                                                  0295
*/*********************************************************************
**      1) IF 'JOBS' OR 'A' OPTIONS IS REQUESTED THE JOBS SUB HEADER  *
**         IS REQUIRED:                                               *
**         A) '00000 ACTIVE JOBS' IS ADDED TO THE BUFFER.             *
**          B ------------------------------------------------------  *
**  WPLML    × MESSAGE LENGTH + 4 =     × MCS FLAGS =              ×  *
**            ------------------------------------------------------  *
**           ×   '00000 ACTIVE JOBS'                               ×  *
**          C ------------------------------------------------------  *
**         B) THE DATA LINE INDICATOR IS SET.                         *
**         C) THE JOBS COUNT IS CONVERTED AND INSERTED INTO THE LINE  *
**         D) THE LINE COUNT IS INCREMENTED BY 1.                     *
**********************************************************************/
*                                                                  0295
*   RESPECIFY                                                      0295
*    (R6,                                                          0295
*     R7) RESTRICTED;                                              0295
*   IF TASKCSCB->CHJOBS='1'B×       /* JOBS ON JOBS, LIST            */
*       WPLMLLTC='1'B;              /* DATA LINE                     */
         OI    WPLMLLTC(WPLPTR),B'00100000'                        0299
*       IF JOBNUM^=0 THEN           /* ANY JOBS CSCB'S?              */
         L     @05,JOBNUM                                          0300
         CR    @05,@09                                             0300
         BE    @RF00300                                            0300
*         DO;                       /* YES                           */
*           R7=JOBNUM;              /* SAVE # OF ACTIVE JOBS & TASKS */
         LR    R7,@05                                              0302
*           R6=WPLPTR+4;            /* JOBS SUB-HEADER ADDRESS       */
         LA    R6,4                                                0303
         ALR   R6,WPLPTR                                           0303
*           CALL CVDCOUNT;          /* CONVERT NUMBER TO DECIMAL     */
         BAL   @14,CVDCOUNT                                        0304
*         END;                                                     0305
*       ELSE                                                       0306
*         ;                                                        0306
@RF00300 DS    0H                                                  0307
*       COUNT=COUNT+1;              /* INCREMENT LINE COUNT          */
         LA    @09,1                                               0307
         SLR   @05,@05                                             0307
         IC    @05,COUNT                                           0307
         ALR   @09,@05                                             0307
         STC   @09,COUNT                                           0307
*                                                                  0308
*/*********************************************************************
** 2) IF 'JOBS,LIST' OR 'A,LIST' WAS AN OPTION THE CSCB CHAIN IS      *
**    SEARCHING FOR EACH JOB OR TASK CSCB.                            *
**    WHEN 'SPECIAL2' IS ON OR BOTH 'SPECIAL1' & 'SPECIAL2' ARE OFF:  *
**          B ------------------------------------------------------  *
**  WPLML    × MESSAGE LENGTH + 4 =     × MCS FLAGS =              ×  *
**            ------------------------------------------------------  *
**           ×   'STARTING STARTING    V=R      00000K - 00000K'   ×  *
**           ×                         OR                          ×  *
**           ×   'STARTING STARTING    V=V'                        ×  *
**          C ------------------------------------------------------  *
**    WHEN 'SPECIAL1' IS ON:                                          *
**         A' ------------------------------------------------------  *
**  WPL      × MESSAGE LENGTH + 4 =     × MCS FLAGS =              ×  *
**            ------------------------------------------------------  *
**           ×   'STARTING STARTING    V=R      00000K - 00000K'   ×  *
**           ×                         OR                          ×  *
**           ×   'STARTING STARTING    V=V'                        ×  *
**            ------------------------------------------------------  *
**  WPLLS01  × LINE TYPE =   × AREA ID =   × NUMBER OF LINES =     ×  *
**         B' ------------------------------------------------------  *
**    A) DETERMINE THE JOBNAME, STEPNAME AND PROC STEPNAME    @YM6960P*
**       1. IF THE JOB IS A START OR MOUNT THEN THE JOBNAME   @YM6960P*
**          IS IN CHCLS, THE STEPNAME IS IN CHKEY AND THE     @YM6960P*
**          PROC STEPNAME IS IN CHPROCSN.                     @YM6960P*
**       2. IF THE JOB IS EXECUTING THEN THE JOBNAME IS IN    @YM6960P*
**          CHKEY, THE STEPNAME IS IN CHSTEP AND THE PROC     @YM6960P*
**          STEPNAME IS IN CHPROCSN.                          @YM6960P*
**       3. IF JOBNAME OR STEPNAME IS NOT SPECIFIED THEN      @YM6960P*
**          THE DEFAULT IS STARTING.                          @YM6960P*
**       4. IF PROC STEPNAME IS NOT SPECIFIED THE DEFAULT     @YM6960P*
**          ARE BLANKS.                                       @YM6960P*
**    B) IF BOTH THE JOB REGION BEGINNING ADDRESS (CHRGNAD) AND       *
**       JOB REGION SIZE (CHRGNSZ) ARE VALID (NON-ZERO), THE JOB      *
**       REGION ENDING ADDRESS IS CALCULATED. THE TWO ADDRESSES       *
**       ARE CONVERTED TO K MULTIPLES, CONVERTED TO-DECIMAL,          *
**       UNPACKED, AND PLACED IN THE MESSAGE TEXT. IF CHRGNDA IS      *
**       ZERO THE DEFAULT IS V=V                                      *
**********************************************************************/
*                                                                  0308
*       IF TASKCSCB->CHJOBSL='1'B&JOBNUM^=0 THEN                   0308
         TM    CHJOBSL(TASKCSCB),B'01000000'                       0308
         BNO   @RF00308                                            0308
         ICM   @09,15,JOBNUM                                       0308
         BZ    @RF00308                                            0308
*         DO;                                                      0309
*           CSCBPTR=BACHN;                                         0310
         L     @09,CVTPTR                                          0310
         L     @09,CVTMSER(,@09)                                   0310
         L     CSCBPTR,BACHN(,@09)                                 0310
*           DO WHILE CSCBPTR^=0;                                   0311
         B     @DE00311                                            0311
@DL00311 DS    0H                                                  0312
*             IF CHTRKID='02'X THEN                                0312
         CLI   CHTRKID(CSCBPTR),X'02'                              0312
         BNE   @RF00312                                            0312
*               DO;                                                0313
*                 IF SPECIAL1='1'B THEN/* 1ST LINE           @YM01918*/
         TM    SPECIAL1,B'01000000'                                0314
         BNO   @RF00314                                            0314
*                   DO;             /*                       @YM01918*/
*                     IF CHRGNAD=0×CHCLS='0000000000000000'X THEN/*
*                                                            @YM7265P*/
         ICM   @09,15,CHRGNAD(CSCBPTR)                             0316
         BZ    @RT00316                                            0316
         CLC   CHCLS(8,CSCBPTR),@CB02612                           0316
         BNE   @RF00316                                            0316
@RT00316 DS    0H                                                  0317
*                       WPL(1:JOBLGTHV)=JOBLISTV(1:JOBLGTHV);/*    0317
*                                      LENGTH JOB,L V=V WTO  @YM7265P*/
         SLR   @09,@09                                             0317
         IC    @09,JOBLGTHV                                        0317
         BCTR  @09,0                                               0317
         EX    @09,@SM02686                                        0317
         BAL   14,CBTSTAT                                        CBTMOD
*                     ELSE          /*                       @YM7265P*/
*                       WPL(1:JOBLLGTH)=JOBLIST(1:JOBLLGTH);/*     0318
*                                                            @YM7265P
*                                      LENGTH JOB,L V=R WTO  @YM7265P*/
         B     @RC00316                                            0318
@RF00316 SLR   @09,@09                                             0318
         IC    @09,JOBLLGTH                                        0318
         BCTR  @09,0                                               0318
         EX    @09,@SM02688                                        0318
         BAL   14,CBTASID                                        CBTMOD
*                     WPLMCSFJ='1'B;/* MLWTO                 @YM01918*/
@RC00316 OI    WPLMCSFJ(WPLPTR),B'01000000'                        0319
*                   END;            /*                       @YM01918*/
*                 ELSE              /*                       @YM01918*/
*                   DO;             /*                       @YM01918*/
         B     @RC00314                                            0321
@RF00314 DS    0H                                                  0322
*                     IF SPECIAL2='1'B THEN/* 2ND LINE       @YM01918*/
         TM    SPECIAL2,B'00100000'                                0322
         BNO   @RF00322                                            0322
*                       SPECIAL2='0'B;/*                     @YM01918*/
         NI    SPECIAL2,B'11011111'                                0323
*                     ELSE          /*                       @YM01918*/
*                       WPLPTR=WPLPTR+WPLMLLEN;                    0324
         B     @RC00322                                            0324
@RF00322 SLR   @09,@09                                             0324
         IC    @09,WPLMLLEN(,WPLPTR)                               0324
         ALR   WPLPTR,@09                                          0324
*                     IF CHRGNAD=0×CHCLS='0000000000000000'X THEN/*
*                                                            @YM7265P*/
@RC00322 ICM   @09,15,CHRGNAD(CSCBPTR)                             0325
         BZ    @RT00325                                            0325
         CLC   CHCLS(8,CSCBPTR),@CB02612                           0325
         BNE   @RF00325                                            0325
@RT00325 DS    0H                                                  0326
*                       WPLML(1:JOBLGTHV)=JOBLISTV(1:JOBLGTHV);/*  0326
*                                      LENGTH JOB,L V=V WTO  @YM7265P*/
         SLR   @09,@09                                             0326
         IC    @09,JOBLGTHV                                        0326
         BCTR  @09,0                                               0326
         EX    @09,@SM02691                                        0326
         BAL   14,CBTSTAT                                        CBTMOD
*                     ELSE          /*                       @YM7265P*/
*                       WPLML(1:JOBLLGTH)=JOBLIST(1:JOBLLGTH);/*   0327
*                                                            @YM7265P
*                                      LENGTH JOB,L V=R WTO  @YM7265P*/
         B     @RC00325                                            0327
@RF00325 SLR   @09,@09                                             0327
         IC    @09,JOBLLGTH                                        0327
         BCTR  @09,0                                               0327
         EX    @09,@SM02693                                        0327
         BAL   14,CBTASID                                        CBTMOD
*                     WPLMLLTC='1'B;/* DATA LINE                     */
@RC00325 OI    WPLMLLTC(WPLPTR),B'00100000'                        0328
*                   END;            /*                       @YM01918*/
*                                                                  0329
*                 /***************************************************/
*                 /*                                                 */
*                 /* DETERMINE THE JOBNAME, STEPNAME AND     @YM6960P*/
*                 /* THE PROC STEPNAME                       @YM6960P*/
*                 /* 1. IF THE JOB IS A START OR MOUNT THEN  @YM6960P*/
*                 /* THE JOBNAME IS IN CHCLS, THE STEP-      @YM6960P*/
*                 /* NAME IS IN CHKEY AND THE PROC STEP-     @YM6960P*/
*                 /* NAME IS IN CHPROCSN                     @YM6960P*/
*                 /* 2. IF IT IS AN EXECUTING JOB THEN THE   @YM6960P*/
*                 /* JOBNAME IS IN CHKEY,THE STEPNAME IS     @YM6960P*/
*                 /* IN CHSTEP AND THE PROC STEPNAME IS      @YM6960P*/
*                 /* IN CHPROCSN.                            @YM6960P*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0330
*                 IF CHVCD='04'X×CHVCD='0C'X THEN/*          @YM6960P
*                                      START OR MOUNT ?      @YM6960P*/
@RC00314 CLI   CHVCD(CSCBPTR),X'04'                                0330
         BE    @RT00330                                            0330
         CLI   CHVCD(CSCBPTR),X'0C'                                0330
         BNE   @RF00330                                            0330
@RT00330 DS    0H                                                  0331
*                   DO;             /* YES                   @YM6960P*/
*                     IF CHCLS^='0000000000000000'X THEN/* IS IT ZERO
*                                                            @YM6960P*/
         CLC   CHCLS(8,CSCBPTR),@CB02612                           0332
         BE    @RF00332                                            0332
*                       JOBNM=CHCLS;/* NO MOVE IN JOBNAME    @YM6960P*/
         MVC   JOBNM(8,WPLPTR),CHCLS(CSCBPTR)                      0333
*                     ELSE                                         0334
*                       ;           /* DEFAULT=STARTING      @YM6960P*/
@RF00332 DS    0H                                                  0335
*                     IF CHKEY^='0000000000000000'X THEN/* IS IT ZERO
*                                                            @YM6960P*/
         CLC   CHKEY(8,CSCBPTR),@CB02612                           0335
         BE    @RF00335                                            0335
*                       STEPNM=CHKEY;/* NO MOVE IN STEPNAME  @YM6960P*/
         MVC   STEPNM(8,WPLPTR),CHKEY(CSCBPTR)                     0336
*                     ELSE                                         0337
*                       ;           /* DEFAULT=STARTING      @YM6960P*/
@RF00335 DS    0H                                                  0338
*                   END;            /*                       @YM6960P*/
*                 ELSE              /* EXECUTING JOB         @YM6960P*/
*                   DO;             /*                       @YM6960P*/
         B     @RC00330                                            0339
@RF00330 DS    0H                                                  0340
*                     IF CHKEY^='0000000000000000'X THEN/* IS IT   0340
*                                      ZERO?                 @YM6960P*/
         CLC   CHKEY(8,CSCBPTR),@CB02612                           0340
         BE    @RF00340                                            0340
*                       JOBNM=CHKEY;/* NO MOVE IN JOBNAME    @YM6960P*/
         MVC   JOBNM(8,WPLPTR),CHKEY(CSCBPTR)                      0341
*                     ELSE                                         0342
*                       ;           /* DEFAULT=STARTING      @YM6960P*/
@RF00340 DS    0H                                                  0343
*                     IF CHSTEP^='0000000000000000'X THEN/* IS IT  0343
*                                      ZERO?                 @YM6960P*/
         CLC   CHSTEP(8,CSCBPTR),@CB02612                          0343
         BE    @RF00343                                            0343
*                       STEPNM=CHSTEP;/* NO MOVE IN STEPNAME@YM6960P */
         MVC   STEPNM(8,WPLPTR),CHSTEP(CSCBPTR)                    0344
*                     ELSE                                         0345
*                       ;           /* DEFAULT=STARTING      @YM6960P*/
@RF00343 DS    0H                                                  0346
*                   END;            /*                       @YM6960P*/
*                 IF CHPROCSN^='0000000000000000'X THEN/* IS IT    0347
*                                      ZEROES                @YM6960P*/
@RC00330 CLC   CHPROCSN(8,CSCBPTR),@CB02612                        0347
         BE    @RF00347                                            0347
*                   PROCSNM=CHPROCSN;/* NO PROC STEPNAME     @YM6960P*/
         MVC   PROCSNM(8,WPLPTR),CHPROCSN(CSCBPTR)                 0348
*                 ELSE                                             0349
*                   ;               /* DEFAULT=BLANKS        @YM6960P*/
@RF00347 DS    0H                                                  0350
*                 IF JOBNM^=STARTING THEN                          0350
         CLC   JOBNM(8,WPLPTR),STARTING                            0350
         BE    @RF00350                                            0350
*                   DO;             /* OUT OF SYSTEM TASK CONTROL    */
*                     JREGION=CHRGNAD;/* REGION START ADDR           */
         L     @09,CHRGNAD(,CSCBPTR)                               0352
         ST    @09,JREGION                                         0352
*                     JSIZE=CHRGNSZ;/* REGION SIZE                   */
         L     @05,CHRGNSZ(,CSCBPTR)                               0353
         ST    @05,JSIZE                                           0353
*                     IF JREGION^=0&/* NOT BEING INITIALED           */
*                         JSIZE^=0 THEN/* OR TERMINATED              */
         SLR   @02,@02                                             0354
         CR    @09,@02                                             0354
         BE    @RF00354                                            0354
         CR    @05,@02                                             0354
         BE    @RF00354                                            0354
*                       DO;                                        0355
*                         R7=JREGION;/* BEGINNING ADDRESS            */
         LR    R7,@09                                              0356
*                         R7=R7/1024;/* # OF K                       */
         LR    @14,R7                                              0357
         SRDA  @14,32                                              0357
         D     @14,@CF02616                                        0357
         LR    R7,@15                                              0357
*                         R6=ADDR(STRADDR)-3;/*              @YM01918*/
         LA    R6,STRADDR(,WPLPTR)                                 0358
         SH    R6,@CH00412                                         0358
*                         CALL CVDCOUNT;/* PUT VALUE IN MSG          */
         BAL   @14,CVDCOUNT                                        0359
*                         R7=JREGION+JSIZE;/* ENDING ADDRESS         */
         L     R7,JREGION                                          0360
         AL    R7,JSIZE                                            0360
*                         R7=R7/1024;/* # OF K                       */
         LR    @14,R7                                              0361
         SRDA  @14,32                                              0361
         D     @14,@CF02616                                        0361
         LR    R7,@15                                              0361
*                         R6=ADDR(ENDADDR)-3;/*              @YM01918*/
         LA    R6,ENDADDR(,WPLPTR)                                 0362
         SH    R6,@CH00412                                         0362
*                         CALL CVDCOUNT;/* PUT VALUE IN MSG          */
         BAL   @14,CVDCOUNT                                        0363
*                       END;                                       0364
*                     ELSE                                         0365
*                       ;                                          0365
@RF00354 DS    0H                                                  0366
*                   END;                                           0366
*                 ELSE                                             0367
*                   ;                                              0367
@RF00350 DS    0H                                                  0368
*                 IF SPECIAL1='1'B THEN/*                    @YM01918*/
         TM    SPECIAL1,B'01000000'                                0368
         BNO   @RF00368                                            0368
*                   DO;             /*                       @YM01918*/
*                     WPLPTR=WPLPTR+WPLLGH;/*                @YM01918*/
         AH    WPLPTR,WPLLGH(,WPLPTR)                              0370
*                     WPLLTFC='1'B; /* DATA LINE             @YM01918*/
         OI    WPLLTFC(WPLPTR),B'00100000'                         0371
*                     WPLPTR=WPLPTR+LENGTH(WPLLS01);/*       @YM01918*/
         AH    WPLPTR,@CH00034                                     0372
*                     SPECIAL1='0'B;/*                       @YM01918*/
*                     SPECIAL2='1'B;/*                       @YM01918*/
         OI    SPECIAL2,B'00100000'                                0374
         NI    SPECIAL1,B'10111111'                                0374
*                   END;            /*                       @YM01918*/
*                 ELSE                                             0376
*                   ;               /*                       @YM01918*/
@RF00368 DS    0H                                                  0377
*                 COUNT=COUNT+1;    /* INCREMENT LINE COUNT          */
         LA    @09,1                                               0377
         SLR   @05,@05                                             0377
         IC    @05,COUNT                                           0377
         ALR   @09,@05                                             0377
         STC   @09,COUNT                                           0377
*                 IF COUNT='0A'X THEN/* IS MSG BUFFER FULL?          */
         CLI   COUNT,10                                            0378
         BNE   @RF00378                                            0378
*                   DO;             /* YES                           */
*                     CALL CALL801;                                0380
         BAL   @14,CALL801                                         0380
*                     SPECIAL1='1'B;/* BEGINNING             @YM01918*/
         OI    SPECIAL1,B'01000000'                                0381
*                   END;                                           0382
*                 ELSE                                             0383
*                   ;                                              0383
@RF00378 DS    0H                                                  0384
*               END;                                               0384
*             ELSE                                                 0385
*               ;                                                  0385
@RF00312 DS    0H                                                  0386
*             CSCBPTR=CHPTR;        /* POINT TO NEXT CSCB, IF 0      */
         L     CSCBPTR,CHPTR(,CSCBPTR)                             0386
*           END;                    /* FALL THROUGH - END OF CHAIN   */
@DE00311 LTR   CSCBPTR,CSCBPTR                                     0387
         BNZ   @DL00311                                            0387
*         END;                                                     0388
*       ELSE                                                       0389
*         ;                                                        0389
@RF00308 DS    0H                                                  0390
*                                                                  0390
*/*********************************************************************
**      3) IF 'JOBS', 'A', 'JOBS,LIST', OR 'A,LIST' OPTIONS WAS       *
**         REQUESTED, THE 'INIT' SUB HEADER IS REQUIRED:              *
**         A) '00000 ACTIVE INITIATORS' IS ADDED TO THE BUFFER.       *
**    WHEN 'SPECIAL2' IS ON OR BOTH 'SPECIAL1' & 'SPECIAL2' ARE OFF:  *
**          B ------------------------------------------------------  *
**  WPLML    × MESSAGE LENGTH + 4 =     × MCS FLAGS =              ×  *
**            ------------------------------------------------------  *
**           ×   '00000 ACTIVE INITIATORS'                         ×  *
**          C ------------------------------------------------------  *
**    WHEN 'SPECIAL1' IS ON:                                          *
**         A' ------------------------------------------------------  *
**  WPL      × MESSAGE LENGTH + 4 =     × MCS FLAGS =              ×  *
**            ------------------------------------------------------  *
**           ×   '00000 ACTIVE INITIATORS'                         ×  *
**            ------------------------------------------------------  *
**  WPLLS01  × LINE TYPE =   × AREA ID =   × NUMBER OF LINES =     ×  *
**         B' ------------------------------------------------------  *
**         B) THE DATE LINE INDICATOR IS SET.                         *
**         C) THE INITS COUNT IS CONVERTED AND INSERTED INTO THE LINE *
**         D) THE LINE COUNT IS INCREMENTED BY 1.                     *
**********************************************************************/
*                                                                  0390
*       IF SPECIAL1='1'B THEN       /*                       @YM01918*/
         TM    SPECIAL1,B'01000000'                                0390
         BNO   @RF00390                                            0390
*         DO;                       /*                       @YM01918*/
*           WPL(1:INITLGTH)=INITEXT(1:INITLGTH);/*           @YM01918*/
         SLR   @09,@09                                             0392
         IC    @09,INITLGTH                                        0392
         BCTR  @09,0                                               0392
         EX    @09,@SM02695                                        0392
*           WPLMCSFJ='1'B;          /* MLWTO                 @YM01918*/
         OI    WPLMCSFJ(WPLPTR),B'01000000'                        0393
*         END;                      /*                       @YM01918*/
*       ELSE                        /*                       @YM01918*/
*         DO;                       /*                       @YM01918*/
         B     @RC00390                                            0395
@RF00390 DS    0H                                                  0396
*           IF SPECIAL2='1'B THEN   /*                       @YM01918*/
         TM    SPECIAL2,B'00100000'                                0396
         BNO   @RF00396                                            0396
*             SPECIAL2='0'B;        /*                       @YM01918*/
         NI    SPECIAL2,B'11011111'                                0397
*           ELSE                    /*                       @YM01918*/
*             WPLPTR=WPLPTR+WPLMLLEN;/*                      @YM01918*/
         B     @RC00396                                            0398
@RF00396 SLR   @09,@09                                             0398
         IC    @09,WPLMLLEN(,WPLPTR)                               0398
         ALR   WPLPTR,@09                                          0398
*           WPLML(1:INITLGTH)=INITEXT(1:INITLGTH);                 0399
@RC00396 SLR   @09,@09                                             0399
         IC    @09,INITLGTH                                        0399
         BCTR  @09,0                                               0399
         EX    @09,@SM02697                                        0399
*           WPLMLLTC='1'B;          /* DATA LINE                     */
         OI    WPLMLLTC(WPLPTR),B'00100000'                        0400
*         END;                      /*                       @YM01918*/
*       IF INITNUM^=0 THEN          /* ANY JOBS CSCB'S?              */
@RC00390 L     @09,INITNUM                                         0402
         LTR   @09,@09                                             0402
         BZ    @RF00402                                            0402
*         DO;                       /* YES                           */
*           R7=INITNUM;             /* NUMBER OF ACTIVE INITS        */
         LR    R7,@09                                              0404
*           R6=WPLPTR+4;            /* JOBS SUB-HEADER ADDRESS       */
         LA    R6,4                                                0405
         ALR   R6,WPLPTR                                           0405
*           CALL CVDCOUNT;                                         0406
*           WPLPTR=WPLPTR+WPLLGH;   /*                       @YM01918*/
         AH    WPLPTR,WPLLGH(,WPLPTR)                              0411
*           WPLLTFC='1'B;           /* DATA LINE             @YM01918*/
         OI    WPLLTFC(WPLPTR),B'00100000'                         0412
*           WPLPTR=WPLPTR+LENGTH(WPLLS01);/*                 @YM01918*/
         AH    WPLPTR,@CH00034                                     0413
*           SPECIAL1='0'B;          /*                       @YM01918*/
*           SPECIAL2='1'B;          /*                       @YM01918*/
         OI    SPECIAL2,B'00100000'                                0415
         NI    SPECIAL1,B'10111111'                                0415
*         END;                      /*                       @YM01918*/
*       ELSE                                                       0417
*         ;                         /*                       @YM01918*/
@RF00409 DS    0H                                                  0418
*       COUNT=COUNT+1;                                             0418
         LA    @09,1                                               0418
         SLR   @05,@05                                             0418
         IC    @05,COUNT                                           0418
         ALR   @09,@05                                             0418
         STC   @09,COUNT                                           0418
*       IF COUNT='0A'X THEN         /*                       @YM01918*/
         CLI   COUNT,10                                            0419
         BNE   @RF00419                                            0419
*         DO;                       /*                       @YM01918*/
*           CALL CALL801;           /*                       @YM01918*/
         BAL   @14,CALL801                                         0421
*           SPECIAL1='1'B;          /*                       @YM01918*/
         OI    SPECIAL1,B'01000000'                                0422
*         END;                      /*                       @YM01918*/
*       ELSE                                                       0424
*         ;                         /*                       @YM01918*/
@RF00419 DS    0H                                                  0425
*     END;                                                         0425
*                                                                  0426
*/*********************************************************************
**      4) IF 'TS', 'A', 'TS,LIST', OR 'A,LIST' OPTIONS WAS REQUESTED *
**         THE TS SUB HEADER IS REQUIRED:                             *
**         A) '00000 ACTIVE INITIATORS' IS ADDED TO THE BUFFER.       *
**    WHEN 'SPECIAL2' IS ON OR BOTH 'SPECIAL1' & 'SPECIAL2' ARE OFF:  *
**          B ------------------------------------------------------  *
**  WPLML    × MESSAGE LENGTH + 4 =     × MCS FLAGS =              ×  *
**            ------------------------------------------------------  *
**           ×   '00000 ACTIVE TIME SHARING USERS'                 ×  *
**          C ------------------------------------------------------  *
**    WHEN 'SPECIAL1' IS ON:                                          *
**         A' ------------------------------------------------------  *
**  WPL      × MESSAGE LENGTH + 4 =     × MCS FLAGS =              ×  *
**            ------------------------------------------------------  *
**           ×   '00000 ACTIVE INITIATORS'                         ×  *
**            ------------------------------------------------------  *
**  WPLLS01  × LINE TYPE =   × AREA ID =   × NUMBER OF LINES =     ×  *
**         B' ------------------------------------------------------  *
**         B) THE INITS COUNT IS CONVERTED AND INSERTED INTO THE LINE *
**         C) THE LINE COUNT IS INCREMENTED BY 1.                     *
**********************************************************************/
*                                                                  0426
*   IF TASKCSCB->CHTS='1'B×         /* TS OR TS, LIST                */
*       TASKCSCB->CHTSL='1'B THEN   /* OPTION SPECIFIED              */
@RF00296 TM    CHTS(TASKCSCB),B'00001100'                          0426
         BZ    @RF00426                                            0426
*     DO;                           /* YES                           */
*       IF SPECIAL1='1'B THEN       /*                       @YM01918*/
         TM    SPECIAL1,B'01000000'                                0428
         BNO   @RF00428                                            0428
*         DO;                       /*                       @YM01918*/
*           WPL(1:TSLGTH)=TSTEXT(1:TSLGTH);/*                @YM01918*/
         SLR   @09,@09                                             0430
         IC    @09,TSLGTH                                          0430
         BCTR  @09,0                                               0430
         EX    @09,@SM02699                                        0430
*           WPLMCSFJ='1'B;          /* DATA LINE             @YM01918*/
         OI    WPLMCSFJ(WPLPTR),B'01000000'                        0431
*         END;                      /*                       @YM01918*/
*       ELSE                        /*                       @YM01918*/
*         DO;                       /*                       @YM01918*/
         B     @RC00428                                            0433
@RF00428 DS    0H                                                  0434
*           IF SPECIAL2='1'B THEN   /*                       @YM01918*/
         TM    SPECIAL2,B'00100000'                                0434
         BNO   @RF00434                                            0434
*             SPECIAL2='0'B;        /*                       @YM01918*/
         NI    SPECIAL2,B'11011111'                                0435
*           ELSE                    /*                       @YM01918*/
*             WPLPTR=WPLPTR+WPLMLLEN;/*                      @YM01918*/
         B     @RC00434                                            0436
@RF00434 SLR   @09,@09                                             0436
         IC    @09,WPLMLLEN(,WPLPTR)                               0436
         ALR   WPLPTR,@09                                          0436
*           WPLML(1:TSLGTH)=TSTEXT(1:TSLGTH);/*              @YM01918*/
@RC00434 SLR   @09,@09                                             0437
         IC    @09,TSLGTH                                          0437
         BCTR  @09,0                                               0437
         EX    @09,@SM02701                                        0437
*           WPLMLLTC='1'B;          /* DATA LINE             @YM01918*/
         OI    WPLMLLTC(WPLPTR),B'00100000'                        0438
*         END;                      /*                       @YM01918*/
*       IF TSNUM^=0 THEN            /* ANY TS CSCB'S ?               */
@RC00428 L     @09,TSNUM                                           0440
         LTR   @09,@09                                             0440
         BZ    @RF00440                                            0440
*         DO;                       /* YES                           */
*           R7=TSNUM;                                              0442
         LR    R7,@09                                              0442
*           R6=WPLPTR+4;            /* TS SUB-HEADER                 */
         LA    R6,4                                                0443
         ALR   R6,WPLPTR                                           0443
*           CALL CVDCOUNT;                                         0444
         BAL   @14,CVDCOUNT                                        0444
*         END;                                                     0445
*       ELSE                                                       0446
*         ;                                                        0446
@RF00440 DS    0H                                                  0447
*       IF SPECIAL1='1'B THEN       /*                       @YM01918*/
         TM    SPECIAL1,B'01000000'                                0447
         BNO   @RF00447                                            0447
*         DO;                       /*                       @YM01918*/
*           WPLPTR=WPLPTR+WPLLGH;   /*                       @YM01918*/
         AH    WPLPTR,WPLLGH(,WPLPTR)                              0449
*           WPLLTFC='1'B;           /* DATA LINE             @YM01918*/
         OI    WPLLTFC(WPLPTR),B'00100000'                         0450
*           WPLPTR=WPLPTR+LENGTH(WPLLS01);/*                 @YM01918*/
         AH    WPLPTR,@CH00034                                     0451
*           SPECIAL1='0'B;          /*                       @YM01918*/
*           SPECIAL2='1'B;          /*                       @YM01918*/
         OI    SPECIAL2,B'00100000'                                0453
         NI    SPECIAL1,B'10111111'                                0453
*         END;                      /*                       @YM01918*/
*       ELSE                                                       0455
*         ;                         /*                       @YM01918*/
@RF00447 DS    0H                                                  0456
*       COUNT=COUNT+1;                                             0456
         LA    @09,1                                               0456
         SLR   @05,@05                                             0456
         IC    @05,COUNT                                           0456
         ALR   @09,@05                                             0456
         STC   @09,COUNT                                           0456
*       IF COUNT='0A'X THEN         /*                       @YM01918*/
         CLI   COUNT,10                                            0457
         BNE   @RF00457                                            0457
*         DO;                       /*                       @YM01918*/
*           CALL CALL801;           /*                       @YM01918*/
         BAL   @14,CALL801                                         0459
*           SPECIAL1='1'B;          /*                       @YM01918*/
         OI    SPECIAL1,B'01000000'                                0460
*         END;                      /*                       @YM01918*/
*       ELSE                                                       0462
*         ;                         /*                       @YM01918*/
@RF00457 DS    0H                                                  0463
*     END;                                                         0463
*                                                                  0464
*/*********************************************************************
**     5) IF 'TS,LIST' OR 'A,LIST' OPTION WAS SPECIFIED AND IF THE    *
**        USER COUNT IS NON-ZERO SCAN THROUGH THE CSCB CHAIN          *
**        SEARCHING FOR EACH TS USER CSCB.                            *
**    WHEN 'SPECIAL2' IS ON OR BOTH 'SPECIAL1' & 'SPECIAL2' ARE OFF:  *
**          B ------------------------------------------------------  *
**  WPLML    × MESSAGE LENGTH + 4 =     × MCS FLAGS =              ×  *
**            ------------------------------------------------------  *
**           ×   'STARTING STARTING STARTING STARTING STARTING'    ×  *
**          C ------------------------------------------------------  *
**    WHEN 'SPECIAL1' IS ON:                                          *
**         A' ------------------------------------------------------  *
**  WPL      × MESSAGE LENGTH + 4 =     × MCS FLAGS =              ×  *
**            ------------------------------------------------------  *
**           ×   'STARTING STARTING STARTING STARTING STARTING'    ×  *
**            ------------------------------------------------------  *
**  WPLLS01  × LINE TYPE =   × AREA ID =   × NUMBER OF LINES =     ×  *
**         B' ------------------------------------------------------  *
**           A) WHEN FOUND THE USER ID IS MOVED FROM CHKEY TO THE     *
**              MESSAGE TEXT. IF CHKEY IS ZEROES OR BLANKS 'STARTING' *
**              IS THE DEFAULT. FIVE USER ID'S FIT ON EACH LINE.      *
**********************************************************************/
*                                                                  0464
*   IF TASKCSCB->CHTSL='1'B&TSNUM^=0 THEN                          0464
@RF00426 TM    CHTSL(TASKCSCB),B'00000100'                         0464
         BNO   @RF00464                                            0464
         SLR   @09,@09                                             0464
         C     @09,TSNUM                                           0464
         BE    @RF00464                                            0464
*     DO;                                                          0465
*       CSCBPTR=BACHN;              /* BEGIN CSCB CHAIN              */
         L     @05,CVTPTR                                          0466
         L     @05,CVTMSER(,@05)                                   0466
         L     CSCBPTR,BACHN(,@05)                                 0466
*       MSGCTR=0;                   /* INIT COUNTER                  */
         ST    @09,MSGCTR                                          0467
*       IF SPECIAL1='1'B THEN       /* 1ST LINE              @YM01918*/
         TM    SPECIAL1,B'01000000'                                0468
         BNO   @RF00468                                            0468
*         DO;                       /*                       @YM01918*/
*           WPL(1:TSLLGTH)=TSLIST(1:TSLLGTH);/*              @YM01918*/
         SLR   @09,@09                                             0470
         IC    @09,TSLLGTH                                         0470
         BCTR  @09,0                                               0470
         EX    @09,@SM02703                                        0470
*           WPLMCSFJ='1'B;          /* MLWTO INDICATOR       @YM6867P*/
         OI    WPLMCSFJ(WPLPTR),B'01000000'                        0471
*           COUNT=COUNT+1;          /* INCREMENT LINE COUNT  @YM01918*/
         LA    @09,1                                               0472
         SLR   @05,@05                                             0472
         IC    @05,COUNT                                           0472
         ALR   @09,@05                                             0472
         STC   @09,COUNT                                           0472
*         END;                      /*                       @YM01918*/
*       ELSE                        /*                       @YM01918*/
*         DO;                       /*                       @YM01918*/
         B     @RC00468                                            0474
@RF00468 DS    0H                                                  0475
*           IF SPECIAL2='1'B THEN   /* 2ND LINE              @YM01918*/
         TM    SPECIAL2,B'00100000'                                0475
         BNO   @RF00475                                            0475
*             SPECIAL2='0'B;        /*                       @YM01918*/
         NI    SPECIAL2,B'11011111'                                0476
*           ELSE                    /*                       @YM01918*/
*             WPLPTR=WPLPTR+WPLMLLEN;                              0477
         B     @RC00475                                            0477
@RF00475 SLR   @09,@09                                             0477
         IC    @09,WPLMLLEN(,WPLPTR)                               0477
         ALR   WPLPTR,@09                                          0477
*           WPLML(1:TSLLGTH)=TSLIST(1:TSLLGTH);/*            @YM01918*/
@RC00475 SLR   @09,@09                                             0478
         IC    @09,TSLLGTH                                         0478
         BCTR  @09,0                                               0478
         EX    @09,@SM02705                                        0478
*           WPLMLLTC='1'B;          /* DATA LINE             @YM01918*/
         OI    WPLMLLTC(WPLPTR),B'00100000'                        0479
*           COUNT=COUNT+1;          /* INCREMENT LINE COUNT  @YM01918*/
         LA    @09,1                                               0480
         SLR   @05,@05                                             0480
         IC    @05,COUNT                                           0480
         ALR   @09,@05                                             0480
         STC   @09,COUNT                                           0480
*         END;                                                     0481
*       DO WHILE CSCBPTR^=0;                                       0482
@RC00468 B     @DE00482                                            0482
@DL00482 DS    0H                                                  0483
*         IF MSGCTR=5 THEN                                         0483
         CLC   MSGCTR(4),@CF01010                                  0483
         BNE   @RF00483                                            0483
*           DO;                                                    0484
*             IF COUNT='0A'X THEN   /* IF THE                @YM01918*/
         CLI   COUNT,10                                            0485
         BNE   @RF00485                                            0485
*               DO;                 /*                       @YM01918*/
*                 CALL CALL801;     /* BUFFER FULL           @YM01918*/
         BAL   @14,CALL801                                         0487
*                 SPECIAL1='1'B;    /* 1ST LINE              @YM01918*/
         OI    SPECIAL1,B'01000000'                                0488
*                 WPL(1:TSLLGTH)=TSLIST(1:TSLLGTH);/*        @YM01918*/
         SLR   @09,@09                                             0489
         IC    @09,TSLLGTH                                         0489
         BCTR  @09,0                                               0489
         EX    @09,@SM02703                                        0489
*                 WPLMCSFJ='1'B;    /* MLWTO                 @YM01918*/
         OI    WPLMCSFJ(WPLPTR),B'01000000'                        0490
*                 COUNT=COUNT+1;    /* INCREMENT LINE COUNT  @YM01918*/
         LA    @09,1                                               0491
         SLR   @05,@05                                             0491
         IC    @05,COUNT                                           0491
         ALR   @09,@05                                             0491
         STC   @09,COUNT                                           0491
*               END;                /*                       @YM01918*/
*             ELSE                  /*                       @YM01918*/
*               DO;                 /*                       @YM01918*/
         B     @RC00485                                            0493
@RF00485 DS    0H                                                  0494
*                 IF SPECIAL1='1'B THEN/* 1ST LINE           @YM01918*/
         TM    SPECIAL1,B'01000000'                                0494
         BNO   @RF00494                                            0494
*                   DO;             /* FINISHED              @YM01918*/
*                     WPLPTR=WPLPTR+WPLLGH;/*                @YM01918*/
         AH    WPLPTR,WPLLGH(,WPLPTR)                              0496
*                     WPLLTFC='1'B; /* DATA LINE             @YM01918*/
         OI    WPLLTFC(WPLPTR),B'00100000'                         0497
*                     WPLPTR=WPLPTR+LENGTH(WPLLS01);/*       @YM01918*/
         AH    WPLPTR,@CH00034                                     0498
*                     SPECIAL1='0'B;/*                       @YM01918*/
*                     SPECIAL2='1'B;/*                       @YM01918*/
         OI    SPECIAL2,B'00100000'                                0500
         NI    SPECIAL1,B'10111111'                                0500
*                   END;            /*                       @YM01918*/
*                 IF SPECIAL2='1'B THEN/* 2ND LINE           @YM01918*/
@RF00494 TM    SPECIAL2,B'00100000'                                0502
         BNO   @RF00502                                            0502
*                   SPECIAL2='0'B;  /* FINISHED              @YM01918*/
         NI    SPECIAL2,B'11011111'                                0503
*                 ELSE              /*                       @YM01918*/
*                   WPLPTR=WPLPTR+WPLMLLEN;/*                @YM01918*/
         B     @RC00502                                            0504
@RF00502 SLR   @09,@09                                             0504
         IC    @09,WPLMLLEN(,WPLPTR)                               0504
         ALR   WPLPTR,@09                                          0504
*                 WPLML(1:TSLLGTH)=TSLIST(1:TSLLGTH);/*      @YM01918*/
@RC00502 SLR   @09,@09                                             0505
         IC    @09,TSLLGTH                                         0505
         BCTR  @09,0                                               0505
         EX    @09,@SM02705                                        0505
*                 WPLMLLTC='1'B;    /* DATA LINE             @YM01918*/
         OI    WPLMLLTC(WPLPTR),B'00100000'                        0506
*                 COUNT=COUNT+1;    /* INCREMENT LINE COUNT  @YM01918*/
         LA    @09,1                                               0507
         SLR   @05,@05                                             0507
         IC    @05,COUNT                                           0507
         ALR   @09,@05                                             0507
         STC   @09,COUNT                                           0507
*               END;                /*                       @YM01918*/
*             MSGCTR=0;             /* REINITIALIZE COUNTER          */
@RC00485 SLR   @09,@09                                             0509
         ST    @09,MSGCTR                                          0509
*           END;                                                   0510
*         ELSE                                                     0511
*           ;                                                      0511
@RF00483 DS    0H                                                  0512
*         IF CHTRKID='01'X THEN     /* IS THIS A TS CSCB?            */
         CLI   CHTRKID(CSCBPTR),X'01'                              0512
         BNE   @RF00512                                            0512
*           DO;                     /* YES                           */
*             TSNAMPTR=ADDR(TSID1)+ /* POSITION ON LINE              */
*                 (LENGTH(TSID1)*MSGCTR);                          0514
         LA    @09,TSID1(,WPLPTR)                                  0514
         L     @05,MSGCTR                                          0514
         MH    @05,@CH01380                                        0514
         ALR   @09,@05                                             0514
         ST    @09,TSNAMPTR                                        0514
*             IF CHKEY^='4040404040404040'X&CHKEY^='0000000000000000'X
*               THEN                                               0515
         CLC   CHKEY(8,CSCBPTR),@CB02618                           0515
         BE    @RF00515                                            0515
         CLC   CHKEY(8,CSCBPTR),@CB02612                           0515
         BE    @RF00515                                            0515
*               TSID=CHKEY;         /* TS USERID                     */
         MVC   TSID(8,@09),CHKEY(CSCBPTR)                          0516
*             ELSE                  /* DEFAULT = STARTING            */
*               TSID=STARTING;                                     0517
         B     @RC00515                                            0517
@RF00515 L     @09,TSNAMPTR                                        0517
         MVC   TSID(8,@09),STARTING                                0517
*             TSBL=' ';             /* INSERT BLANK                  */
@RC00515 L     @09,TSNAMPTR                                        0518
         MVI   TSBL(@09),C' '                                      0518
*             MSGCTR=MSGCTR+1;      /* INCREMENT ID COUNT PER LINE   */
         LA    @09,1                                               0519
         AL    @09,MSGCTR                                          0519
         ST    @09,MSGCTR                                          0519
*             WPLMLLEN=(LENGTH(TSID1)*MSGCTR)+6;/*           @YM7264P
*                                      LENGTH MINOR LINE     @YM7264P*/
         MH    @09,@CH01380                                        0520
         AH    @09,@CH01212                                        0520
         STC   @09,WPLMLLEN(,WPLPTR)                               0520
*           END;                                                   0521
*         ELSE                                                     0522
*           ;                                                      0522
@RF00512 DS    0H                                                  0523
*         CSCBPTR=CHPTR;            /* POINT TO NEXT CSCB, IF 0      */
         L     CSCBPTR,CHPTR(,CSCBPTR)                             0523
*       END;                        /* FULL THROUGH, END OF CHAIN    */
@DE00482 LTR   CSCBPTR,CSCBPTR                                     0524
         BNZ   @DL00482                                            0524
*     END;                                                         0525
*                                                                  0526
*/*********************************************************************
**       1) WHEN FINISHED THE LAST LINE IS MARKED THE END LINE        *
**     WHEN 'SPECIAL1' IS ON AND 'COUNT' IS 0:                        *
**         A' ------------------------------------------------------  *
**  WPL      × MESSAGE LENGTH + 4 =  4  × MCS FLAGS =  0040        ×  *
**            ------------------------------------------------------  *
**  WPLLS01  × LINE TYPE =  1000 × AREA ID =   × # OF LINES =  1   ×  *
**         B' ------------------------------------------------------  *
**       2) IEECB801 IS INVOKED TO ISSUE THE MESSAGES WITH REGISTER 1 *
**          ADDRESSING THE PARMLIST.                                  *
**    IF 'LIST' WAS NOT AN OPTION, THE INITIATOR SUB HEADER IS        *
**    THE LAST LINE OF THE DISPLAY.                                   *
**********************************************************************/
*                                                                  0526
*   IF SPECIAL1='1'B THEN           /* 1ST LINE              @YM01918*/
@RF00464 TM    SPECIAL1,B'01000000'                                0526
         BNO   @RF00526                                            0526
*     DO;                           /*                       @YM01918*/
*       IF COUNT=0 THEN             /* BLANK END LINE        @YM01918*/
         CLI   COUNT,0                                             0528
         BNE   @RF00528                                            0528
*         DO;                       /*                       @YM01918*/
*           WPLLGH=4;               /* LENGTH = MCS FLAG LENGTH    0530
*                                                            @YM01918*/
         LA    @09,4                                               0530
         STH   @09,WPLLGH(,WPLPTR)                                 0530
*           WPLMCSFJ='1'B;          /* MLWTO                 @YM01918*/
         OI    WPLMCSFJ(WPLPTR),B'01000000'                        0531
*           COUNT=COUNT+1;          /* INCREMENT COUNTER     @YM01918*/
         LA    @05,1                                               0532
         SLR   @02,@02                                             0532
         IC    @02,COUNT                                           0532
         ALR   @05,@02                                             0532
         STC   @05,COUNT                                           0532
*           WPLPTR=WPLPTR+WPLLGH;   /* GO TO WPL             @ZA02599*/
         ALR   WPLPTR,@09                                          0533
*         END;                      /*                       @YM01918*/
*       ELSE                        /*                       @YM01918*/
*         DO;                       /*                       @YM01918*/
         B     @RC00528                                            0535
*   ELSE                            /*                       @YM01918*/
*     DO;                           /*                       @YM01918*/
         B     @RC00526                                            0541
@RF00526 DS    0H                                                  0542
*       IF SPECIAL2='1'B THEN       /* 2ND LINE              @YM01918*/
         TM    SPECIAL2,B'00100000'                                0542
         BNO   @RF00542                                            0542
*         DO;                       /*                       @YM01918*/
*           WPLPTR=WPLPTR-LENGTH(WPLLS01);/* BACK SPACE      @YM01918*/
         SH    WPLPTR,@CH00034                                     0544
*           WPLLTFD='1'B;           /* END LINE              @YM01918*/
         OI    WPLLTFD(WPLPTR),B'00010000'                         0545
*         END;                      /*                       @YM01918*/
*       ELSE                        /*                       @YM01918*/
*         DO;                       /*                       @YM01918*/
         B     @RC00542                                            0547
@RF00542 DS    0H                                                  0548
*           WPLMLLTD='1'B;          /* END LINE              @YM01918*/
         OI    WPLMLLTD(WPLPTR),B'00010000'                        0548
*         END;                      /*                       @YM01918*/
*     END;                          /*                       @YM01918*/
@RC00542 DS    0H                                                  0551
*   CALL CALL801;                                                  0551
@RC00526 BAL   @14,CALL801                                         0551
*                                                                  0552
*/*********************************************************************
**     THIS CODE FREES THE CORE OBTAINED FOR THE MESSAGE BUFFER.      *
**          REG1 POINTS TO THE BEGINNING OF THE AREA TO BE FREED      *
**          REG2 CONTAINS THE LENGTH                                  *
**********************************************************************/
*                                                                  0552
*BUFFREE:                                                          0552
*   RESPECIFY                                                      0552
*    (R2) RESTRICTED;                                              0552
BUFFREE  DS    0H                                                  0553
*   R2=MAXMLWTO;                    /* PLACE LENGTH IN R2            */
         LH    R2,MAXMLWTO                                         0553
*   R1=BUFPTR;                      /* PLACE BEGINNING ADDRESS IN R1 */
         L     R1,BUFPTR                                           0554
*   GEN(FREEMAIN R,SP=229,LV=(2),A=(1));                           0555
         FREEMAIN R,SP=229,LV=(2),A=(1)
*   RESPECIFY                                                      0556
*    (R2) UNRSTD;                                                  0556
*                                                                  0557
*/*********************************************************************
**     THIS CODE RECEIVES CONTROL AFTER THE CORE HAS BEEN FREED, OR   *
**     IF ALL GETMAINS FAILED AND THE HEADER AND ERROR LINES WERE     *
**     BUILT IN THE CSCB.                                             *
**     1) A DEQ IS ISSUED AGAINST THE CSCB CHAIN                      *
**     2) ADDRESSIBILITY IS RESTORED TO THIS TASK'S CSCB.             *
**          A) IF THIS IS A TRACK COMMAND A WAIT IS ISSUED AGAINST    *
**             AN ECB LIST                                            *
**             THESE ECB'S CAN BE POSTED IF                           *
**               1) THE TIMER POPS FOR THE TASK TO BE REACTIVATED     *
**                  (STIMECB) COMPLETION CODE = 4                     *
**               2) A STOPTR WAS ISSUED TO TERMINATE THE TRACK DIS-   *
**                  PLAY, COMPLETION CODE = 4, OR CONSOLE CLOSE HAS   *
**                  POSTED THE TRACK PROCESS OR TO TERMINATE (CHCECB) *
**                  COMPETION CODE = 0                                *
**               3) A K D,U WAS ISSUED TO A TRACK DISPLAY IN THE      *
**                  HOLD MODE. CHCECB IS POSTED WITH A COMPLETION     *
**                  CODE OF 8 BY SVC 34 (IEE6703D).                   *
**          B) THIS WAIT IS ALSO ISSUED IF THE PROCESSOR DISCOVERS    *
**             THAT THE TRACK DISPLAY IS IN HOLD MODE FROM 'HOLDMODE'.*
**             (AS THE RESULT OF A K D,H) THE DISPLAY CAN NOT BE      *
**             UPDATED UNTIL A K D,U IS ISSUED AND CHCECB IS POSTED   *
**             WITH COMPLETION CODE OF 8).                            *
**          C) CONTROL IS THEN GIVEN TO AWAKE TO DETERMINE WHICH ECB  *
**             WAS POSTED AND TO TAKE THE REQUIRED ACTION.            *
**          D) IF THIS IS A DISPLAY COMMAND THE TASK WILL TERMINATE.  *
**             THE CSCB IS FREED VIA MGCR.                            *
**             REGISTER 14 IS RESTORED AND CONTROL IS RETURNED TO THE *
**             SYSTEM.                                                *
**********************************************************************/
*                                                                  0557
*CLEANUP:                                                          0557
*   ENQDEQL(1:DLEN)=DDEQ(1:DLEN);   /* BUILD DEQ LIST                */
CLEANUP  LH    @09,DLEN                                            0557
         BCTR  @09,0                                               0557
         EX    @09,@SM02708                                        0557
*   R1=ADDR(ENQDEQL);               /* WITH REG 1 ADDRESSING IT      */
         LA    R1,ENQDEQL                                          0558
*   GEN(DEQ ,MF=(E,(1)));           /* DEQ FROM THE CSCB CHAIN       */
         DEQ ,MF=(E,(1))
*   CSCBPTR=CSCBPASS;               /* RESTORE THIS TASK'S CSCB    0560
*                                      ADDRESS                       */
         L     @09,PARMADDR                                        0560
         L     CSCBPTR,CSCBPASS(,@09)                              0560
*TERMCODE:                                                         0561
*   IF CHVCD='C4'X THEN             /* IS THIS A TRACK COMMAND?      */
TERMCODE CLI   CHVCD(CSCBPTR),X'C4'                                0561
         BNE   @RF00561                                            0561
*     DO;                           /* YES, WAIT ON ECB LIST         */
*ECBWAIT:                           /* ALSO GETS CONTROL FROM      0563
*                                      HOLDMODE                      */
*       ECB1=ADDR(STIMECB);         /* BUILD ECB LIST                */
ECBWAIT  L     @09,PARMADDR                                        0563
         LA    @09,STIMECB(,@09)                                   0563
         ST    @09,ECB1                                            0563
*       ECB2=ADDR(CHCECB);                                         0564
         LA    @09,CHCECB(,CSCBPTR)                                0564
         ST    @09,ECB2                                            0564
*       ECB2=ECB2×HIMASK;           /* INDICATE LAST ECB ON LIST     */
         O     @09,HIMASK                                          0565
         ST    @09,ECB2                                            0565
*       R1=ADDR(ECBS);              /* PLACE ADDRESS OF LIST IN R1   */
         LA    R1,ECBS                                             0566
*       GEN(WAIT 1,ECBLIST=(1));                                   0567
         WAIT 1,ECBLIST=(1)
*       GOTO AWAKE;                 /* RETURN TO AWAKE WHEN POSTED   */
         B     AWAKE                                               0568
*     END;                                                         0569
*   ELSE                            /* NO, THIS IS A DISPLAY COMMAND */
*ALLDONE:                           /* ALSO ERROR EXIT FOR STIMER    */
*     DO;                           /* CLEANUP AND EXIT              */
@RF00561 DS    0H                                                  0570
ALLDONE  DS    0H                                                  0571
*       R1=CSCBPTR;                 /* RESTORE CSCB ADDRESS          */
         LR    R1,CSCBPTR                                          0571
*       CHFC='1'B;                  /* INDICATE TO FREE CSCB CORE    */
         OI    CHFC(CSCBPTR),B'00000010'                           0572
*       GEN(MGCR (1),CHAIN);        /* HAVE CSCB FREED BY SVC 34     */
         MGCR (1),CHAIN
*       RESPECIFY                                                  0574
*        (R14) RESTRICTED;                                         0574
*       R14=R14SAVE;                /* RESTORE THE RETURN ADDRESS  0575
*                                                            @ZA00073*/
         L     R14,R14SAVE                                         0575
*       RETURN;                     /* RETURN TO THE SYSTEM          */
@EL00001 L     @13,4(,@13)                                         0576
@EF00001 L     @00,@SIZDATD                                        0576
         LR    @01,@12                                             0576
         FREEMAIN R,LV=(0),A=(1)
@ER00001 BR    @14                                                 0576
*     END;                                                         0577
*                                                                  0578
*/*********************************************************************
**   THIS PROCEDURE ISSUES THE TIME MACRO, UNPACKS THE RESULTING      *
**   TIME VALUE AND INSERTS IT INTO THE MESSAGE TEXT.                 *
**      IEE102I HH.MM.SS ACTIVE TASKS                                 *
**      IEE921I NO TR    UPDATE AT HH.MM.SS                           *
**   THE BUFFERS CONTAINING THE ABOVE MESSAGES ARE MAPPED BY DSECT    *
**   'CLWTO' BASED ON WPLPTR. FOR IEE921I WPLPTR MUST BE ADVANCED     *
**   16 BYTES TO MAP IN HRS, MIN, SEC PROPERLY.                       *
**********************************************************************/
*                                                                  0578
*TIMESNAP:                                                         0578
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0578
TIMESNAP DS    0H                                                  0579
*   RESPECIFY                                                      0579
*    (WPLPTR) RESTRICTED;                                          0579
*   GEN(TIME DEC,ERRET=NOTIME);                                    0580
         TIME DEC,ERRET=NOTIME
*   RESPECIFY                                                      0581
*    (R0) RESTRICTED;                                              0581
*   SAVETIME=R0;                    /* SAVE TIME STAMP VALUE         */
         ST    R1,SAVETIME                                       CBTMOD
         UNPK  UNPACK(8),SAVETIME(4)                             CBTMOD
         MVC   CBTYR(2,WPLPTR),UNPACK+3                          CBTMOD
         MVC   CBTDY(3,WPLPTR),UNPACK+5                          CBTMOD
         ST    R0,SAVETIME                                         0582
*   RESPECIFY                                                      0583
*    (R0) UNRESTRICTED;                                            0583
*   UNPK(UNPACK(1:8),SAVETIME(1:4));/* UNPACK TIME VALUE             */
         UNPK  UNPACK(8),SAVETIME(4)                               0584
*   HRS=HOURS;                      /* FILL IN HOURS                 */
         MVC   HRS(2,WPLPTR),HOURS                                 0585
*   MIN=MINUTES;                    /* FILL IN MINUTES               */
         MVC   MIN(2,WPLPTR),MINUTES                               0586
*   SEC=SECONDS;                    /* FILL IN SECONDS               */
         MVC   SEC(2,WPLPTR),SECONDS                               0587
*   RETURN;                         /* RETURN TO MAIN LINE           */
@EL00002 DS    0H                                                  0588
@EF00002 DS    0H                                                  0588
@ER00002 BR    @14                                                 0588
*   END TIMESNAP;                                                  0589
*                                                                  0590
*/*********************************************************************
**   THIS PROCEDURE CONVERTS THE NUMBERS TO DECIMAL, UNPACKS THEM     *
**   AND INSERTS THEM INTO THE MESSAGE TEXT.                          *
**      R7 = CONTAINS THE COUNT TO BE CONVERTED                       *
**           (JOBNUM,INITNUM,TSNUM,JREGION/1024,JREGION+JSIZE/1024)   *
**      R6 = CONTAINS THE ADDRESS WITHIN THE MESSAGE BUFFER WHERE     *
**           THE RESULTING VALUE IS TO BE PLACED                      *
**           (WPLPTR+4 FOR 00000 ACTIVE JOBS                          *
**                         00000 ACTIVE INITIATORS                    *
**                         00000 ACTIVE TIME SHARING USERS            *
**           STRADDR - 3 FOR 00000K                                   *
**           ENDADDR - 3 FOR 00000K)                                  *
**********************************************************************/
*                                                                  0590
*CVDCOUNT:                                                         0590
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0590
CVDCOUNT DS    0H                                                  0591
*   RESPECIFY                                                      0591
*    (R6,                                                          0591
*     R7,                                                          0591
*     WPLPTR) RESTRICTED;                                          0591
*   CVD(R7,UNPACK);                 /* CONVERT THE VALUE TO DECIMAL  */
         CVD   R7,UNPACK                                           0592
*   UNPK(CONVERT(4:8),UNPACK(4:8)); /* UNPACK THE VALUE              */
         UNPK  CONVERT+3(5,R6),UNPACK+3(5)
*   GEN(OI 7(R6),X'F0');            /* MAKE LAST DIGIT VALID NUMBERS */
         OI    7(R6),X'F0'
*   RETURN;                         /* RETURN TO MAIN LINE           */
@EL00003 DS    0H                                                  0595
@EF00003 DS    0H                                                  0595
@ER00003 BR    @14                                                 0595
*   END CVDCOUNT;                                                  0596
*                                                                  0597
*/*********************************************************************
**   THIS PROCEDURE INVOKES IEECB801 TO ISSUE THE TPUT'S OR MLWTO'S.  *
**       IEECB801 IS INVOKED TO ISSUE THE MESSAGES WITH REGISTER 1    *
**   ADDRESSING THE PARMLIST CONTAINING THE ADDRESS OF THIS           *
**   TASK'S CSCB, AND THE ADDRESS OF THE MESSAGE.                     *
**   THE WTO PARM LIST BASE REGISTER IS REINITIALIZED TO POINT TO     *
**   THE 1ST LINE IN IT. IF THIS IS THE 1ST TIME IEECB801 IS BEING    *
**   INVOKED, THE FIRST LINE IS THE CONTROL LINE WHICH CONTAINS THE   *
**   DC & RC, OTHERWISE IT WILL BE A DATA LINE. THE # OF LINES IS     *
**   INITIALIZED FROM THE 'COUNT' AND THE AREA ID FROM THE            *
**   CSCB(CHARID).                                                    *
**   IEECB801 IS INVOKED                                              *
**   UPON RETURN THE RETURN CODE FIELD IN THE PARMLIST IS             *
**   INTERROGATED. IF NOT ZERO ALL PROCESSING CEASES CONTROL IS       *
**   PASSED TO 'BUFFREE'. OTHERWISE THE LINE COUNT FIELD  IS          *
**   REINITIALIZED TO 0, THE MESSAGE BUFFER IS SET TO ZEROES.         *
**********************************************************************/
*                                                                  0597
*CALL801:                                                          0597
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0597
CALL801  DS    0H                                                  0598
*   RESPECIFY                                                      0598
*    (R1,                                                          0598
*     TASKCSCB,                                                    0598
*     R9,                                                          0598
*     R14) RESTRICTED;                                             0598
*   R9=R14;                         /* SAVE RETURN TO MAIN LINE      */
         LR    R9,R14                                              0599
*   RESPECIFY                                                      0600
*    (R14) UNRESTRICTED;                                           0600
*   R1=ADDR(PARMLIST);              /* PARMLIST TO IEECB801          */
         LA    R1,PARMLIST                                         0601
*   CSCBADDR=CSCBPASS;              /* THIS TASK'S CSCB              */
         L     @05,PARMADDR                                        0602
         MVC   CSCBADDR(4),CSCBPASS(@05)                           0602
*   MESSADDR=BUFPTR;                /* ADDRESS OF MESSAGE BUFFER     */
         L     @05,BUFPTR                                          0603
         STCM  @05,7,MESSADDR                                      0603
*   WPLPTR=BUFPTR;                  /* REINIT CSECT BASE REG         */
         LR    WPLPTR,@05                                          0604
*   IF FIRSTIME='1'B THEN           /* 1ST BUFFER FULL?              */
         TM    FIRSTIME,B'00100000'                                0605
         BNO   @RF00605                                            0605
*     WPLPTR=WPLPTR+WPLLGH+4;       /* YES, 1ST LINE IS      @YM01918*/
         LR    @05,WPLPTR                                          0606
         AH    @05,WPLLGH(,WPLPTR)                                 0606
         AH    @05,@CH00034                                        0606
         LR    WPLPTR,@05                                          0606
*   ELSE                            /* CONTROL LINE          @YM01918*/
*     WPLPTR=WPLPTR+WPLLGH;         /* NO, 1ST LINE IS DATA LINE     */
         B     @RC00605                                            0607
@RF00605 AH    WPLPTR,WPLLGH(,WPLPTR)                              0607
*   WPLLINES=COUNT;                 /* NUMBER OF LINES IN BUFFER     */
@RC00605 MVC   WPLLINES(1,WPLPTR),COUNT                            0608
*   WPLAREA=TASKCSCB->CHARID;       /* GET AREA ID FOR CRT(Z=PAPER)
*                                                            @YM01918*/
         MVC   WPLAREA(1,WPLPTR),CHARID(TASKCSCB)                  0609
*   CALL IEECB801;                  /* HAVE LINK WRITTEN             */
         L     @15,@CV02408                                        0610
         BALR  @14,@15                                             0610
*   IF RETCODE^=0 THEN              /* WAS ALL SUCCESSFUL?           */
         ICM   @05,15,RETCODE                                      0611
         BZ    @RF00611                                            0611
*     RETURN TO BUFFREE;            /* NO, FULL BUFFER               */
         LA    @14,BUFFREE                                         0612
@EL00004 DS    0H                                                  0612
@EF00004 DS    0H                                                  0612
@ER00004 BR    @14                                                 0612
*   ELSE                                                           0613
*     ;                             /* YES                           */
@RF00611 DS    0H                                                  0614
*   COUNT=0;                        /* REINIT LINE COUNT TO 0        */
         MVI   COUNT,X'00'                                         0614
*   WPLPTR=BUFPTR;                  /* REINIT CSECT BASE             */
         L     WPLPTR,BUFPTR                                       0615
*   CLEARBUF(1:MAXCLEAR)=CLEARBUF(1:MAXCLEAR)&&/*            @YM01918*/
*       CLEARBUF(1:MAXCLEAR);       /* CLEAR 1ST 256         @YM01918*/
         LH    @05,MAXCLEAR                                        0616
         LR    @02,@05                                             0616
         BCTR  @02,0                                               0616
         EX    @02,@SX02711                                        0616
*   CLEARBUF=CLEARBUF+MAXCLEAR;     /*                       @YM01918*/
         AL    @05,CLEARBUF(,WPLPTR)                               0617
         ST    @05,CLEARBUF(,WPLPTR)                               0617
*   CLEARBUF(1:MAXCLEAR)=CLEARBUF(1:MAXCLEAR)&&/*            @YM01918*/
*       CLEARBUF(1:MAXCLEAR);       /* CLEAR 2ND 256         @YM01918*/
         EX    @02,@SX02711                                        0618
*   RESPECIFY                                                      0619
*    (R14) RESTRICTED;                                             0619
*   R14=R9;                         /* RESTORE MAIN LINE ADDRESS     */
         LR    R14,R9                                              0620
*   RESPECIFY                                                      0621
*    (R1,                                                          0621
*     WPLPTR,                                                      0621
*     R9) UNRSTD;                                                  0621
*   RETURN;                         /* RETURN TO MAIN LINE           */
         B     @EL00004                                            0622
*   END CALL801;                                                   0623
*                                                                  0624
*/*********************************************************************
**        IF THIS IS THE FIRST PASS THROUGH (SACBADDR WILL STILL BE   *
**        ZERO) THE ADDRESS OF THE SACB (SCREEN AREA CONTROL BLOCK)   *
**        WHICH DEFINES THE AREA INTO WHICH THE TRACK DISPLAY SHOULD  *
**        BE PLACED IS OBTAINED.                                      *
**        A) ITS ADDRESS AND THE CORRESPONDING UCME ECB ADDRESSES ARE *
**           SAVED IN THE ESTAE PARMLIST (STAELIST) FOR RECOVERY      *
**           PURPOSES.                                                *
**********************************************************************/
*                                                                  0624
*FINDSACB:                                                         0624
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0624
FINDSACB DS    0H                                                  0625
*   RESPECIFY                                                      0625
*     SACBPTR RESTRICTED;                                          0625
*   DISPLACE=UCMVEZ*(CHCNID-1);     /* INDEX TO UCME                 */
         L     @15,CVTPTR                                          0626
         L     @15,UCMBASPT(,@15)                                  0626
         SLR   @02,@02                                             0626
         IC    @02,CHCNID(,CSCBPTR)                                0626
         BCTR  @02,0                                               0626
         LR    @01,@02                                             0626
         M     @00,UCMVEZ(,@15)                                    0626
         ST    @01,DISPLACE                                        0626
*   UCMDVEPT=UCMVEA+DISPLACE;       /* PROPER UCME ADDRESS           */
         AL    @01,UCMVEA(,@15)                                    0627
         ST    @01,UCMDVEPT                                        0627
*   SACBPTR=DCMADSDS;               /* FIRST SACB ADDRESS            */
         L     @15,DCMTSPTR(,@01)                                  0628
         L     SACBPTR,DCMADSDS(,@15)                              0628
*   DO WHILE DCMAID^=CHARID;        /* LOOP THROUGH SACB CHAIN       */
         B     @DE00629                                            0629
@DL00629 DS    0H                                                  0630
*     SACBPTR=DCMACBNX;             /* FOR ONE WITH TRACK            */
         L     SACBPTR,DCMACBNX(,SACBPTR)                          0630
*   END;                                                           0631
@DE00629 CLC   DCMAID(1,SACBPTR),CHARID(CSCBPTR)                   0631
         BNE   @DL00629                                            0631
*   SACBADDR=SACBPTR;               /* SAVE ADDRESS OF SACB          */
         L     @15,PARMADDR                                        0632
         ST    SACBPTR,SACBADDR(,@15)                              0632
*   UCMECBAD=ADDR(UCMECB);          /* SAVE DIDOCS ECB IN UCME       */
         MVC   UCMECBAD(4,@15),UCMDVEPT                            0633
*   RESPECIFY                                                      0634
*     SACBPTR UNRESTRICTED;                                        0634
*   END FINDSACB;                                                  0635
@EL00005 DS    0H                                                  0635
@EF00005 DS    0H                                                  0635
@ER00005 BR    @14                                                 0635
*                                                                  0636
*/*********************************************************************
**     THIS PROCEDURE ISSUES SETLOCK RELEASE FOR THE CMS AND LOCAL    *
**   LOCKS OBTAINED AT LABEL 'AWAKE' FOR THE TRACK COMMAND PROCESSING.*
**   IT IS INVOKED VIA 'CALL' FROM LABEL 'ECBPOST' (2 CALLS)          *
**                                       'HOLDMODE' (2 CALLS)         *
**                                       'STAELOCK'                   *
**   NOTE: REGISTER 12 MUST BE SAVED SEPARATELY BECAUSE IT IS THE     *
**         BASE REGISTER FOR 'LOCKSAVE'.                              *
**********************************************************************/
*                                                                  0636
*LOCKSOFF:                                                         0636
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0636
LOCKSOFF DS    0H                                                  0637
*   RESPECIFY                                                      0637
*    (R1,                                                          0637
*     CSCBPTR,                                                     0637
*     R4,                                                          0637
*     R6,                                                          0637
*     R11,                                                         0637
*     R12) RESTRICTED;                                             0637
*   GENERATE;                                                      0638
         STM     R11,R14,LOCKSAVE SAVE REGISTERS ACROSS SETLOCK
         LR      R6,R12           SAVE DATA REGISTER
         SETLOCK RELEASE,TYPE=CMS,RELATED=(AWAKE,STAELOCK)
         SETLOCK RELEASE,TYPE=LOCAL,RELATED=(AWAKE,STAELOCK)
         LR      R12,R6           RESTORE DATA REGISTER
         LM      R11,R14,LOCKSAVE RESTORE REGISTERS
*   RETURN;                         /* RETURN TO MAIN LINE           */
@EL00006 DS    0H                                                  0639
@EF00006 DS    0H                                                  0639
@ER00006 BR    @14                                                 0639
*   END LOCKSOFF;                                                  0640
*                                                                  0641
*/*********************************************************************
**   THIS ROUTINE RECEIVES CONTROL WHEN THE STIMER EXPIRES.   @YM8271P*
**   IT RECEIVES CONTROL UNDER THE IRB SCHEDULED BY THE       @YM8271P*
**   STIMER. AT THIS POINT IEECB800 MUST RESTORE ITS          @YM8271P*
**   ADDRESSIBILITY AND WAKE ITSELF UP BY POSTING ITS OWN     @YM8271P*
**   ECB.                                                     @YM8271P*
**       1. REGISTER 15 HAS THE ADDRESS OF TIMEPOP. IT WILL   @YM8271P*
**          BE USED AS THE BASE REGISTER.                     @YM8271P*
**          SUPERVISOR.                                       @YM8271P*
**       7. DROP REGISTER 15 AS THE BASE REGISTER.            @YM8271P*
**********************************************************************/
*                                                                  0641
*TIMEPOP:                                                          0641
*   RESPECIFY                                                      0641
*    (R1,                                                          0641
*     R6,                                                          0641
*     R15) RESTRICTED;              /*                       @YM8271P*/
TIMEPOP  DS    0H                                                  0642
*   GEN(USING  *,R15);              /* ESTABLISH EXIT ROUTINE      0642
*                                                            @YM8271P*/
         USING  *,R15
*   R6=ADDR(STAEXIT);               /* TRACK STAE EXIT ADDRESS     0643
*                                                            @YM8271P*/
         L     R6,@CA02587                                         0643
*   R1=ADDR(SCB);                   /* FIND 1ST SCB          @YM8271P*/
         L     @05,CVTPTR                                          0644
         L     @05,CVTTCBP(,@05)                                   0644
         L     @05,TCBPTR(,@05)                                    0644
         L     R1,SCBPTR(,@05)                                     0644
*   DO WHILE R1^=0;                 /* SCAN SCB CHAIN        @YM8271P*/
         B     @DE00645                                            0645
@DL00645 DS    0H                                                  0646
*     IF R1->SCBEXIT=R6 THEN        /* IF TRACK              @YM8271P*/
         C     R6,SCBEXIT(,R1)                                     0646
         BNE   @RF00646                                            0646
*       DO;                         /* SCB THEN:             @YM8271P*/
*         R1=SCBPARM;               /* ADDRESS OF STAE PARMLIST    0648
*                                                            @YM8271P*/
         L     @05,CVTPTR                                          0648
         L     @05,CVTTCBP(,@05)                                   0648
         L     @05,TCBPTR(,@05)                                    0648
         L     @05,SCBPTR(,@05)                                    0648
         L     R1,SCBPARM(,@05)                                    0648
*         RESPECIFY                                                0649
*           STAELIST BASED(R1);     /*                       @YM8271P*/
*         R1=ADDR(STIMECB);         /* ADDRESS OF THE ECB IN SCB   0650
*                                                            @YM8271P*/
         LA    @05,STIMECB(,R1)                                    0650
         LR    R1,@05                                              0650
*         GEN(POST (1),4);          /* POST WITH CODE OF 4   @YM8271P*/
         POST (1),4
*         GEN(BR R14);              /* RETURN TO THE SUPERVISOR SO 0652
*                                      THAT THE IRB WILL BE        0652
*                                      ELIMINATED TO ALLOW THE MAIN
*                                      LINE TO RECEIVE CONTROL.    0652
*                                                            @YM8271P*/
         BR R14
*       END;                        /*                       @YM8271P*/
*     ELSE                          /*                       @YM8271P*/
*       R1=R1->SCBCHAIN;            /* ADDR NEXT SCB         @YM8271P*/
         B     @RC00646                                            0654
@RF00646 L     R1,SCBCHAIN(,R1)                                    0654
*   END;                            /*                       @YM8271P*/
@RC00646 DS    0H                                                  0655
@DE00645 LTR   R1,R1                                               0655
         BNZ   @DL00645                                            0655
*   GEN(BR R14);                    /* NONE FOUND. RETURN    @YM8271P*/
         BR R14
*   GEN(DROP  R15);                 /* RESTORE R11 AS BASE REGISTER
*                                                            @YM8271P*/
         DROP  R15
*   RESPECIFY                                                      0658
*    (R1,                                                          0658
*     R6,                                                          0658
*     R15) UNRESTRICTED;            /*                       @YM8271P*/
*   RESPECIFY                                                      0659
*     STAELIST BASED(PARMADDR);     /*                       @YM8271P*/
*                                                                  0660
*/*********************************************************************
**                                                                    *
**                            STAE EXIT                               *
**                                                                    *
**     THIS ROUTINE IN GIVEN CONTROL AS THE RESULT OF AN UNPREDICTABLE*
**   ERROR ENCOUNTERED WHILE PROCESSING A TRACK COMMAND.              *
**   ON ENTRY IF REG 0 CONTAINS 12 - REG 1 CONTAINS THE ABEND CODE    *
**                                   REG 2 ADDRESSES THE STAE PARM    *
**                                   LIST (STAELIST)                  *
**            IF REG 0 DOES NOT CONTAIN 12 - REG 1 ADDRESSES THE SDWA *
**                                   IN WHICH SDWAPARM ADDRESSES THE  *
**                                   STAE PARM LIST (STAELIST)        *
**            REG 14 CONTAINS THE ADDRESS TO WHICH CONTROL SHOULD BE  *
**                RETURNED WHEN THIS TASK'S ESTAE PROCESSING HAS      *
**                COMPLETED (IT IS SAVED IN REG 4).                   *
**   THE STAE PARM LIST CONTAINS THE FOLLOWING INFORMATION:           *
**            1) THE MODULE'S BASE REGISTER                           *
**            2) THE DATA AREA'S BASE REGISTER                        *
**            3) THE SACB'S BASE REGISTER - THE TRACK FIELDS NEED TO  *
**                                   BE CLEARED AS SOON AS POSSIBLE   *
**            4) THE UCME'S ECB ADDRESS - NEEDED TO POST DIDOCS TO    *
**                                   CLEAR THE SCREEN AREA IN WHICH   *
**                                   THE TRACK DISPLAY APPEARS        *
**   THIS INFORMATION IS RECOVERED.                                   *
**   SDUMP IS NOT ISSUED IF PERCOLATED TO BY A LOWER LEVEL ESTAE,     *
**   SINCE THE DUMP SHOULD HAVE BEEN TAKEN AT THE EXIT CLOSER TO THE  *
**   ERROR.                                                           *
**********************************************************************/
*                                                                  0660
*   RESPECIFY                                                      0660
*    (R0,                                                          0660
*     R1,                                                          0660
*     R2,                                                          0660
*     CSCBPTR,                                                     0660
*     R4,                                                          0660
*     SACBPTR,                                                     0660
*     R7,                                                          0660
*     R11,                                                         0660
*     R12,                                                         0660
*     R14) RESTRICTED;                                             0660
*STAEXIT:                                                          0661
*   ENTRY;                          /*                       @YM4795P*/
@EP00661 DS    0H                                                  0662
*   IF R0=12 THEN                   /* IS THERE AN SDWA?             */
         CH    R0,@CH00035                                         0662
         BNE   @RF00662                                            0662
*     DO;                           /* NO, R2 ADDRESSES STAE PARM  0663
*                                      LIST                          */
*       RESPECIFY                                                  0664
*        (R0) UNRESTRICTED;                                        0664
*       R4=R2->REGCODE1;            /* RESTORE SECONDARY BASEREG   0665
*                                                            @ZA00073*/
         L     R4,REGCODE1(,R2)                                    0665
*       R11=R2->REGCODE2;           /* RESTORE THIS CODE'S BASE REG
*                                                            @ZA00073*/
         L     R11,REGCODE2(,R2)                                   0666
*       R12=R2->REGDATA;            /* RESTORE THE DATA AREA'S REG   */
         L     R12,REGDATA(,R2)                                    0667
*       SACBPTR=R2->SACBADDR;       /* RESTORE THE SACB BASE REG     */
         L     SACBPTR,SACBADDR(,R2)                               0668
*       R7=R2->UCMECBAD;            /* RESTORE THE UCME ECB ADDR     */
         L     R7,UCMECBAD(,R2)                                    0669
*       HAVESDWA='0'B;              /* INDICATE THERE WAS NO SDWA  0670
*                                                            @YM01918*/
         NI    HAVESDWA,B'11101111'                                0670
*       CSCBPTR=CSCBPASS;           /* RESTORE CSCB BASE REG         */
         L     @15,PARMADDR                                        0671
         L     CSCBPTR,CSCBPASS(,@15)                              0671
*       WTOBUF(1:SLEN)=SLIST(1:SLEN);/* BUILD SDUMP LIST IN          */
         LH    @15,SLEN                                            0672
         BCTR  @15,0                                               0672
         EX    @15,@SM02713                                        0672
*       R1=ADDR(CHSWT);             /* CSCB BUFFER ADDRESSED BY R1   */
         LA    R1,CHSWT(,CSCBPTR)                                  0673
*       GEN(SDUMP MF=(E,(1)));      /* GET DUMP AS SOON AS POSSIBLE  */
         SDUMP MF=(E,(1))
*       RESPECIFY                                                  0675
*        (R2) UNRESTRICTED;                                        0675
*     END;                                                         0676
*   ELSE                            /* HAVE SDWA                     */
*     DO;                           /* STAE PARM PTR IN SDWA         */
         B     @RC00662                                            0677
@RF00662 DS    0H                                                  0678
*       RESPECIFY                                                  0678
*        (R0) UNRESTRICTED;                                        0678
*       RESPECIFY                                                  0679
*        (R8) RESTRICTED;                                          0679
*       R8=R1;                      /* SAVE BASE OF SDWA             */
         LR    R8,R1                                               0680
*       R4=SDWAPARM->REGCODE1;      /* RESTORE SECONDARY BASE      0681
*                                                            @ZA00073*/
         L     @15,SDWAPARM(,R1)                                   0681
         L     R4,REGCODE1(,@15)                                   0681
*       R11=SDWAPARM->REGCODE2;     /* RESTORE THIS CODE'S BASE    0682
*                                                            @ZA00073*/
         L     R11,REGCODE2(,@15)                                  0682
*       R12=SDWAPARM->REGDATA;      /* RESTORE DATA AREA'S BASE      */
         L     R12,REGDATA(,@15)                                   0683
*       SACBPTR=SDWAPARM->SACBADDR; /* RESTORE SACB BASE REG         */
         L     SACBPTR,SACBADDR(,@15)                              0684
*       R7=SDWAPARM->UCMECBAD;      /* RESTORE UCME ECB ADDR         */
         L     R7,UCMECBAD(,@15)                                   0685
*       HAVESDWA='1'B;              /* INDICATE THERE IS A SDWA    0686
*                                                            @YM01918*/
         OI    HAVESDWA,B'00010000'                                0686
*       IF SDWAPERC='0'B&           /* IS THERE STAE PERCULATION?    */
*           SDWAMCHK='0'B THEN      /* WAS THERE A MACHINE CHECK?    */
         TM    SDWAPERC(R1),B'00010000'                            0687
         BNZ   @RF00687                                            0687
         TM    SDWAMCHK(R1),B'10000000'                            0687
         BNZ   @RF00687                                            0687
*         DO;                       /* NO                            */
*           CSCBPTR=CSCBPASS;       /* RESTORE CSCB BASE REG         */
         L     @15,PARMADDR                                        0689
         L     CSCBPTR,CSCBPASS(,@15)                              0689
*           WTOBUF(1:SLEN)=SLIST(1:SLEN);/* BUILD SDUMP LIST IN      */
         LH    @15,SLEN                                            0690
         BCTR  @15,0                                               0690
         EX    @15,@SM02713                                        0690
*           R1=ADDR(CHSWT);         /* CSCB BUFFER ADDRESSED BY R1   */
         LA    R1,CHSWT(,CSCBPTR)                                  0691
*           GEN(SDUMP MF=(E,(1)));  /* GET DUMP AS SOON AS POSSIBLE  */
         SDUMP MF=(E,(1))
*         END;                                                     0693
*       ELSE                                                       0694
*         ;                         /* THERE IS PERCULATION, SO NO 0694
*                                      SDUMP                         */
@RF00687 DS    0H                                                  0695
*     END;                                                         0695
*   R14SAVE=R14;                    /* SAVE RETURN ADDRESS   @ZA00073*/
@RC00662 ST    R14,R14SAVE                                         0696
*                                                                  0697
*/*********************************************************************
**   NOTE: REGISTER 12 MUST BE SAVED SEPARATELY BECAUSE IT IS THE     *
**         BASE REGISTER FOR 'LOCKSAVE'.                              *
**  1) THE LOCAL AND CMS LOCKS ARE OBTAINED TO SERIALIZE ON THE SACB. *
**  2) IF AN SACB IS PRESENT AND THIS TASK WAS NOT POSTED BY DIDOCS,  *
**     THE TRACK FIELDS IN THE SACB ARE CLEARED TO PREVENT ANY        *
**     FURTHER PROCESSING BY SVC 34 OR DIDOCS.                        *
**  3)  THE LOCKS ARE RELEASED.                                       *
**  4)  IF THERE IS A VALID (NON-ZERO) UCME ECB ADDRESS,       @YM4795P
**      THEN ISSUE A K E,D,L=A (AREA TRACK IS IN). THIS WILL   @YM4795P
**      INDICATE TO DIDOCS TO CLEAR THE SCREEN                 @YM4795P
**   5) THE TRACK CSCB IS FREED VIA MGCR.                             *
**   6) IF AN SDWA EXISTS, A SETRP IS ISSUED TO INDICATE THE ACTION   *
**      TO BE TAKEN BY ASIR (ABEND - STAE INTERFACE ROUTINE)          *
**   7) OTHERWISE REG 15 IS SET WITH A 0 RETURN CODE, REGISTER 14     *
**      IS RESTORED AND CONTROL RETURNED TO ASIR.                     *
**********************************************************************/
*                                                                  0697
*   RESPECIFY                                                      0697
*    (R6) RESTRICTED;                                              0697
*STAEFAIL:                          /*                       @YM4795P*/
*   GENERATE;                                                      0698
STAEFAIL DS    0H                                                  0698
         STM     R11,R14,LOCKSAVE    SAVE REGISTERS ACROSS SETLOCK
         LR      R6,R12              SAVE DATA REGISTER
         SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                        X
               RELATED=(PTISSUED,HOLDMODE)
         SETLOCK OBTAIN,TYPE=CMS,MODE=UNCOND,                          X
               RELATED=(PTISSUED,HOLDMODE)
         LR      R12,R6              RESTORE DATA REGISTER
         LM      R11,R14,LOCKSAVE    RESTORE REGISTERS
*   RESPECIFY                                                      0699
*    (R6) RESTRICTED;                                              0699
*   IF SACBPTR^=0&CHCECB^=POSTED THEN/* SACB EXISTS &                */
         LTR   SACBPTR,SACBPTR                                     0700
         BZ    @RF00700                                            0700
         CLC   CHCECB(4,CSCBPTR),POSTED                            0700
         BE    @RF00700                                            0700
*     DO;                           /* DIDOCS DID NOT POST           */
*       DCMADFLG=DCMADFLG&'20'X;    /* CLEAR ALL BUT DIDOCS DIDOCS 0702
*                                      BIT                           */
         NI    DCMADFLG(SACBPTR),X'20'                             0702
*       DCMATRCK='00'X;             /* CLEAR TRACK OPTIONS INDICATORS*/
         MVI   DCMATRCK(SACBPTR),X'00'                             0703
*       DCMAUTME='0000'X;           /* CLEAR TRACK TIME INTERVAL     */
         SLR   @15,@15                                             0704
         STH   @15,DCMAUTME(,SACBPTR)                              0704
*       DCMATECB='00000000'X;       /* CLEAR TRACK CANCEL ECB ADDR   */
         SLR   @15,@15                                             0705
         ST    @15,DCMATECB(,SACBPTR)                              0705
*     END;                                                         0706
*   ELSE                                                           0707
*     ;                                                            0707
@RF00700 DS    0H                                                  0708
*   CMDBUFR(1:KEDLGTH)=KED(1:KEDLGTH);/* MOVE COMMAND IN CSCB      0708
*                                                            @YM4795P*/
         SLR   @15,@15                                             0708
         IC    @15,KEDLGTH                                         0708
         BCTR  @15,0                                               0708
         EX    @15,@SM02715                                        0708
*   R7SAVE=R7;                      /* SAVE REG 7 ACROSS CALL TO   0709
*                                      CVDRTN                @ZA00073*/
         ST    R7,R7SAVE                                           0709
*   R7=CHCNID;                      /* PICK UP CONSOLE ID FOR MSG  0710
*                                      CONVERT               @ZA00073*/
         SLR   R7,R7                                               0710
         IC    R7,CHCNID(,CSCBPTR)                                 0710
*   R6=ADDR(CNIDAREA);              /* ADDR OF AREA FOR UNPACK     0711
*                                                            @ZA00073*/
         LA    R6,CNIDAREA                                         0711
*   CALL CVDCOUNT;                  /* PROCESS CONSOLE ID FOR MSG  0712
*                                      TEXT                  @ZA00073*/
         BAL   @14,CVDCOUNT                                        0712
*   R7=R7SAVE;                      /* RESTORE REG 7 CONTENTS      0713
*                                                            @ZA00073*/
         L     R7,R7SAVE                                           0713
*   CNSID=CNID;                     /* INIT MSG WITH CONSOLE ID    0714
*                                                            @ZA00073*/
         LA    @15,64                                              0714
         ALR   @15,CSCBPTR                                         0714
         MVC   CNSID(2,@15),CNID                                   0714
*   CNSLAREA=DCMAID;                /* SCREEN AREA ID        @YM4795P*/
         MVC   CNSLAREA(1,@15),DCMAID(SACBPTR)                     0715
*   RESPECIFY                                                      0716
*    (SACBPTR) UNRESTRICTED;                                       0716
*   CALL LOCKSOFF;                  /* REGARDLESS RELEASE LOCKS      */
         BAL   @14,LOCKSOFF                                        0717
*   IF R7^=0 THEN                   /* VALID UCME ECB ADDRESS?       */
         LTR   R7,R7                                               0718
         BZ    @RF00718                                            0718
*     DO;                           /* YES                           */
*       RESPECIFY                                                  0720
*         R0 RESTRICTED;                                           0720
*       R0=UCMID;                   /* CONSOLE ID            @YM4795P*/
         L     @15,UCMDVEPT                                        0721
         SLR   R0,R0                                               0721
         IC    R0,UCMID(,@15)                                      0721
*       R1=ADDR(CHSWT);             /* CMD BUFFER IN REG1    @YM4795P*/
         LA    R1,CHSWT(,CSCBPTR)                                  0722
*       GEN(WTO MF=(E,(R1)));       /* ISSUE WTO             @YM4795P*/
         WTO MF=(E,(R1))
*       RESPECIFY                                                  0724
*         R0 UNRESTRICTED;                                         0724
*     END;                                                         0725
*   R1=CSCBPTR;                     /* RESTORE CSCB PTR              */
@RF00718 LR    R1,CSCBPTR                                          0726
*   CHFC='1'B;                      /* INDICATE TO FREE CSCB CORE    */
         OI    CHFC(CSCBPTR),B'00000010'                           0727
*   GEN(MGCR (1),CHAIN);            /* HAVE CSCB CORE FREED BY SVC 34*/
         MGCR (1),CHAIN
*   RESPECIFY                                                      0729
*    (CSCBPTR) UNRESTRICTED;                                       0729
*   IF HAVESDWA='1'B THEN           /* WAS THERE AN SDWA?    @YM01918*/
         TM    HAVESDWA,B'00010000'                                0730
         BNO   @RF00730                                            0730
*     DO;                           /* YES, ISSUE SETPR              */
*       R1=R8;                      /* REINIT BASE OF SDWA           */
         LR    R1,R8                                               0732
*       RESPECIFY                                                  0733
*        (R1,                                                      0733
*         R8) UNRESTRICTED;                                        0733
*       DO;                         /* SETRP                       0734
*                                      RECORD(YES)RECPARM(LRECINF)   */
*         RESPECIFY                                                0735
*          (GPR00P,                                                0735
*           GPR01P,                                                0735
*           GPR14P,                                                0735
*           GPR15P) RSTD;                                          0735
*         GPR01P->SDWARCDE=0;       /* SAVE RC VALUE                 */
         MVI   SDWARCDE(GPR01P),X'00'                              0736
*         GPR01P->SDWARCRD='1'B;    /* TURN ON RECORD INDICATOR      */
         OI    SDWARCRD(GPR01P),B'10000000'                        0737
*         GPR15P=ADDR(LRECINF);     /* ACCESS RECORD PARAMETER LIST  */
         LA    GPR15P,LRECINF                                      0738
*         GPR01P->SDWARECP=GPR15P->I256C(1:24);/* COPY RECORD      0739
*                                      PARAMETERS                    */
         MVC   SDWARECP(24,GPR01P),I256C(GPR15P)                   0739
*         RESPECIFY                                                0740
*          (GPR00P,                                                0740
*           GPR01P,                                                0740
*           GPR14P,                                                0740
*           GPR15P) UNRSTD;                                        0740
*       END;                                                       0741
*     END;                                                         0742
*   ELSE                            /* NO SDWA                       */
*     DO;                                                          0743
         B     @RC00730                                            0743
@RF00730 DS    0H                                                  0744
*       RESPECIFY                                                  0744
*        (R15) RESTRICTED;                                         0744
*       R15=0;                      /* SET RETURN CODE = 0           */
         SLR   R15,R15                                             0745
*     END;                                                         0746
*   RESPECIFY                                                      0747
*    (R14) RESTRICTED;                                             0747
@RC00730 DS    0H                                                  0748
*   R14=R14SAVE;                    /* RESTORE RETURN ADDRESS      0748
*                                                            @ZA00073*/
         L     R14,R14SAVE                                         0748
*   IF R14=0 THEN                   /* TRACK ESTAE FAILED    @YM4795P*/
         LTR   R14,R14                                             0749
         BNZ   @RF00749                                            0749
*     RETURN TO ABEND102;           /* RETURN TO ISSUE ABEND @YM4795P*/
         L     @13,4(,@13)                                         0750
         L     @00,@SIZDATD                                        0750
         LR    @01,@12                                             0750
         FREEMAIN R,LV=(0),A=(1)
         LA    @14,ABEND102                                        0750
         BR    @14                                                 0750
*   ELSE                            /* RETURN                @YM4795P*/
*     RETURN;                       /* TO THE SYSTEM         @YM4795P*/
*   DECLARE                         /* GENERAL PURPOSE REGISTERS     */
*     GPR00P PTR(31) REG(0),                                       0752
*     GPR01P PTR(31) REG(1),                                       0752
*     GPR14P PTR(31) REG(14),                                      0752
*     GPR15P PTR(31) REG(15);                                      0752
*   DECLARE                         /* COMMON VARIABLES              */
*     I256C CHAR(256) BASED,                                       0753
*     I031F FIXED(31) BASED,                                       0753
*     I031P PTR(31) BASED,                                         0753
*     I015F FIXED(15) BASED,                                       0753
*     I015P PTR(15) BASED,                                         0753
*     I008P PTR(8) BASED,                                          0753
*     I001C CHAR(1) BASED;                                         0753
*   END IEECB800                                                   0754
*                                                                  0754
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (IEERDCM )                                       */
*/*%INCLUDE SYSLIB  (CVT     )                                       */
*/*%INCLUDE SYSLIB  (IEECUCM )                                       */
*/*%INCLUDE SYSLIB  (IEEBASEA)                                       */
*/*%INCLUDE SYSLIB  (IEECHAIN)                                       */
*/*%INCLUDE SYSLIB  (IEFPTRS )                                       */
*/*%INCLUDE SYSLIB  (IKJTCB  )                                       */
*/*%INCLUDE SYSLIB  (IHASDWA )                                       */
*/*%INCLUDE SYSLIB  (IHASCB  )                                       */
*/*%INCLUDE SYSLIB  (IEZWPL  )                                       */
*                                                                  0754
@CH00950 DC    H'16'
@CH00921 DC    H'100'
@CH02663 DC    H'-4'
@SM02671 MVC   WTOBUF(0,CSCBPTR),NOUPDATE
@SM02676 MVC   GETLIST(0),GETAREA
@SM02678 MVC   WPL(0,WPLPTR),HEADTEXT
@SM02680 MVC   WPLML(0,WPLPTR),ERRTEXT
@SM02682 MVC   ENQDEQL(0),EENQ
@SM02684 MVC   WPLML(0,WPLPTR),JOBTEXT
@SM02686 MVC   WPL(0,WPLPTR),JOBLISTV
@SM02688 MVC   WPL(0,WPLPTR),JOBLIST
@SM02691 MVC   WPLML(0,WPLPTR),JOBLISTV
@SM02693 MVC   WPLML(0,WPLPTR),JOBLIST
@SM02695 MVC   WPL(0,WPLPTR),INITEXT
@SM02697 MVC   WPLML(0,WPLPTR),INITEXT
@SM02699 MVC   WPL(0,WPLPTR),TSTEXT
@SM02701 MVC   WPLML(0,WPLPTR),TSTEXT
@SM02703 MVC   WPL(0,WPLPTR),TSLIST
@SM02705 MVC   WPLML(0,WPLPTR),TSLIST
@SM02708 MVC   ENQDEQL(0),DDEQ
@SX02711 XC    CLEARBUF(0,WPLPTR),CLEARBUF(WPLPTR)
@SM02713 MVC   WTOBUF(0,CSCBPTR),SLIST
@SM02715 MVC   CMDBUFR+64(0,CSCBPTR),KED
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@PC00001 DS    1F
IEECB800 CSECT
         DS    0F
@CF01010 DC    F'5'
@CF02616 DC    F'1024'
@DATD    DSECT
         DS    0D
UCMEXTPT DS    A
UCMMCSPT DS    A
UCMEILPT DS    A
UCMUEWPT DS    A
UCMDVEPT DS    A
MSGCTR   DS    F
TSNUM    DS    F
JOBNUM   DS    F
INITNUM  DS    F
BUFPTR   DS    A
TSNAMPTR DS    A
R14SAVE  DS    A
DISPLACE DS    F
R7SAVE   DS    A
JREGION  DS    F
JSIZE    DS    F
PARMADDR DS    A
COUNT    DS    AL1
CNIDAREA DS    CL8
         ORG   CNIDAREA
@NM00153 DS    CL6
CNID     DS    CL2
         ORG   CNIDAREA+8
SWITCHES DS    CL1
         ORG   SWITCHES
FIRSTRAK DS    BL1
SPECIAL1 EQU   SWITCHES+0
SPECIAL2 EQU   SWITCHES+0
HAVESDWA EQU   SWITCHES+0
         ORG   SWITCHES+1
         DS    CL2
SAVETIME DS    CL4
GETLIST  DS    CL12
         ORG   GETLIST
GENLGTH  DS    AL4
COREADDR DS    AL4
GETFLAGS DS    AL2
GETSUBP  DS    AL2
         ORG   GETLIST+12
PARMLIST DS    CL16
         ORG   PARMLIST
CSCBADDR DS    AL4
MSGFLAGS DS    CL1
         ORG   MSGFLAGS
CSCBFLAG DS    BL1
NOUPFLAG EQU   MSGFLAGS+0
FIRSTIME EQU   MSGFLAGS+0
         ORG   PARMLIST+5
MESSADDR DS    AL3
MLID     DS    CL4
         ORG   MLID
MLWTOID  DS    CL3
CONSOLID DS    CL1
         ORG   PARMLIST+12
RETCODE  DS    CL4
         ORG   PARMLIST+16
WORKAREA DS    CL40
         ORG   WORKAREA
@NM00154 DS    CL32
UNPACK   DS    CL8
         ORG   UNPACK
UNPCKRSV DS    CL1
HOURS    DS    CL2
MINUTES  DS    CL2
SECONDS  DS    CL2
UNPCKRS2 DS    CL1
         ORG   WORKAREA+40
ENQDEQL  DS    CL12
ECBS     DS    CL8
         ORG   ECBS
ECB1     DS    AL4
ECB2     DS    AL4
         ORG   ECBS+8
ESTAELST DS    CL24
LOCKSAVE DS    CL16
IEECB800 CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
@CA02587 DC    A(STAEXIT)
@CV02408 DC    V(IEECB801)
         DS    0D
HIMASK   DC    XL4'80000000'
POSTED   DC    XL4'40000000'
PTPOSTED DC    XL4'40000004'
DELINE   DC    XL2'3000'
MAXMLWTO DC    XL2'324'
MAXCLEAR DC    XL2'100'
@CB02612 DC    X'0000000000000000'
@CB02618 DC    X'4040404040404040'
STARTING DC    CL8'STARTING'
DCOMM    DS    CL8
         ORG   DCOMM
DCLEN    DC    X'07'
DCOM     DC    CL7'DISPLAY'
         ORG   DCOMM+8
TCOMM    DS    CL8
         ORG   TCOMM
TCLEN    DC    X'06'
TCOM     DC    CL7'TRACK'
         ORG   TCOMM+8
LRECINF  DS    CL24
         ORG   LRECINF
MODNAME  DC    CL8'IEECB800'
@NM00155 DC    CL8'IEECB800'
@NM00156 DC    CL8' '
         ORG   LRECINF+24
@DATD    DSECT
         IHAPSA
IEECB800 CSECT
         DS    0F
HEADTEXT WTO   ('IEE102I 00.00.00 YY.DDD ACTIVE TASKS',C),             *
               MF=L,DESC=(5,8,9,10),MCSFLAG=(REG0,RESP),AREAID=Z CBTMOD
HEADLGTH DC    AL1(*-HEADTEXT)    LENGTH OF MAIN HEADER
JOBTEXT  WTO   ('   00000 ACTIVE JOBS'),MF=L
JOBLGTH  DC    AL1(*-JOBTEXT)     LENGTH OF JOBS SUB-HEADER
INITEXT  WTO   ('   00000 ACTIVE INITIATORS'),MF=L
INITLGTH DC    AL1(*-INITEXT)     LENGTH OF INIT SUB-HEADER
TSTEXT   WTO   ('   00000 ACTIVE TIME SHARING USERS'),MF=L
TSLGTH   DC    AL1(*-TSTEXT)      LENGTH OF TS SUB-HEADER
JOBLIST  WTO   ('  STARTING STARTING            V=R  AS(0000)  00000K -*
                00000K'),MF=L                                    CBTMOD
JOBLLGTH DC    AL1(*-JOBLIST)     LENGTH OF INDIVIDUAL JOBS WTO
ERRTEXT  WTO   ('DISPLAY TRUNCATED - INSUFFICIENT STORAGE'),MF=L
ERRLGTH  DC    AL1(*-ERRTEXT)     LENGTH OF ERR MESSAGE
JOBLISTV WTO   ('  STARTING STARTING            V=V  AS(0000)  XXYYY  M*
               MM.SS.TH      '),MF=L                             CBTMOD
JOBLGTHV DC    AL1(*-JOBLISTV)    LENGTH OF VIRTUAL JOB WTO    @YM7265P
TSLIST   WTO   ('                                              '),MF=L
TSLLGTH  DC    AL1(*-TSLIST)      LENGTH OF INDIVIDUAL TS WTO
NOUPDATE WTO   ('IEE920I NO TR UPDATE AT 00.00.00 YY.DDD'),MF=L,       *
               DESC=(5),MCSFLAG=(REG0,RESP)                      CBTMOD
NOUPLGTH DC    AL1(*-NOUPDATE)    LENGTH OF NO UPDATE MESSAGE
         DS    0F
EENQ     ENQ   (MAJOR,MINOR,S,3,SYSTEM),RET=HAVE,MF=L
         DS    0H
ELEN     DC    AL2(*-EENQ)
DDEQ     DEQ   (MAJOR,MINOR,3,SYSTEM),RET=HAVE,MF=L
         DS    0H
DLEN     DC    AL2(*-DDEQ)
MAJOR    DC    CL8'SYSIEFSD'
MINOR    DC    CL3'Q10'
         DS    0F
GETAREA  GETMAIN EC,LV=0,A=AWAKE,SP=229,MF=L
         DS    0H
GETLGTH  DC    AL2(*-GETAREA)
         DS    0F
SLIST    SDUMP HDR='IEECB800 - TRACK COMMAND',SDATA=(SQA,PSA,NUC,LSQA, *
               RGN,LPA,TRT,CSA,ALLPSA),MF=L
         DS    0H
SLEN     DC    AL2(*-SLIST)
KED      WTO   ('IEE713I TRACK COMMAND PROCESSOR FAILED-ISSUE K E,D,L=CC
               CA TO DELETE'),MF=L,DESC=(5),MCSFLAG=(REG0,RESP)
KEDLGTH  DC    AL1(*-KED)     LENGTH OF TEXT                   @ZA00073
PATCH    DC    CL100'*****PATCH AREA - IEECB800*****'          @ZA00073
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IEECB800 CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
SACBPTR  EQU   @05
CSCBPTR  EQU   @03
R1       EQU   @01
WPLPTR   EQU   @08
R0       EQU   @00
R2       EQU   @02
R4       EQU   @04
R6       EQU   @06
R7       EQU   @07
R8       EQU   @08
R9       EQU   @09
TASKCSCB EQU   @10
R11      EQU   @11
R12      EQU   @12
R14      EQU   @14
R15      EQU   @15
GPR00P   EQU   @00
GPR01P   EQU   @01
GPR14P   EQU   @14
GPR15P   EQU   @15
R13      EQU   @13
CVTPTR   EQU   16
DCMTSRT  EQU   0
DCMRFLGS EQU   DCMTSRT+5
@NM00008 EQU   DCMTSRT+14
DCMDEVTY EQU   DCMTSRT+15
DCMADSDS EQU   DCMTSRT+16
DCMR2FLG EQU   DCMTSRT+44
DCMR3FLG EQU   DCMTSRT+45
DCMPACB  EQU   DCMTSRT+60
DCMACB   EQU   0
DCMACBNX EQU   DCMACB
DCMAID   EQU   DCMACB+4
DCMASACB EQU   DCMACB+5
DCMACLR  EQU   DCMACB+9
DCMAFLG1 EQU   DCMACLR+17
DCMADEND EQU   DCMAFLG1
DCMAFULL EQU   DCMAFLG1
DCMAFLG2 EQU   DCMACLR+18
DCMATFLG EQU   DCMACLR+19
DCMADFLG EQU   DCMATFLG
DCMAHOLD EQU   DCMADFLG
DCMATRCK EQU   DCMATFLG+1
DCMAUTME EQU   DCMATFLG+2
DCMATECB EQU   DCMACLR+23
CVTMAP   EQU   0
CVTTCBP  EQU   CVTMAP
CVTDAR   EQU   CVTMAP+72
CVTFLGS1 EQU   CVTDAR
CVTCUCB  EQU   CVTMAP+100
CVTDCB   EQU   CVTMAP+116
CVTIERLC EQU   CVTMAP+144
CVTMSER  EQU   CVTMAP+148
CVTOPTA  EQU   CVTMAP+182
CVTOPTB  EQU   CVTMAP+183
CVTGTF   EQU   CVTMAP+236
CVTGTFST EQU   CVTGTF
CVTGTFS  EQU   CVTGTFST
CVTSTATE EQU   CVTGTFST
CVTTMODE EQU   CVTGTFST
CVTFORM  EQU   CVTGTFST
CVTAQAVT EQU   CVTMAP+240
CVTTCMFG EQU   CVTAQAVT
CVTVOLM2 EQU   CVTMAP+244
CVTTATA  EQU   CVTVOLM2
CVTTSKS  EQU   CVTTATA
CVTVOLF2 EQU   CVTTSKS
CVTTAT   EQU   CVTTATA+1
CVTATER  EQU   CVTMAP+248
CVTEXT1  EQU   CVTMAP+252
CVTPURG  EQU   CVTMAP+260
CVTQMSG  EQU   CVTMAP+268
CVTDMSR  EQU   CVTMAP+272
CVTERPV  EQU   CVTMAP+316
CVTINTLA EQU   CVTMAP+320
CVTAPF   EQU   CVTMAP+324
CVTEXT2  EQU   CVTMAP+328
CVTHJES  EQU   CVTMAP+332
CVTPGSIA EQU   CVTMAP+348
CVTA1F1  EQU   CVTMAP+356
CVTSYSK  EQU   CVTMAP+357
CVTVOLM1 EQU   CVTMAP+380
CVTVOLF1 EQU   CVTVOLM1
CVTATMCT EQU   CVTMAP+388
CVTXTNT1 EQU   0
CVTXTNT2 EQU   0
CVTDSSV  EQU   CVTXTNT2
CVTFLGBT EQU   CVTXTNT2+5
CVTQID   EQU   CVTXTNT2+24
CVTRV400 EQU   CVTXTNT2+52
CVTRV409 EQU   CVTXTNT2+53
CVTATCVT EQU   CVTXTNT2+64
CVTRV429 EQU   CVTXTNT2+84
CVTRV438 EQU   CVTXTNT2+85
CVTRV457 EQU   CVTXTNT2+112
CVTRV466 EQU   CVTXTNT2+113
CVTFIX   EQU   0
CVTRELNO EQU   CVTFIX+252
UCM2EXT  EQU   0
UCM2STA  EQU   UCM2EXT+8
UCM2SFLG EQU   UCM2STA
UCMPRFX  EQU   0
UCMSAVE0 EQU   UCMPRFX+4
UCMSFLGS EQU   UCMPRFX+84
UCMSFLG1 EQU   UCMSFLGS
UCMSFLG2 EQU   UCMSFLGS+1
UCMXSA   EQU   UCMPRFX+104
UCMSDS1  EQU   UCMPRFX+156
UCM      EQU   0
UCMDECB  EQU   UCM+12
UCMRPYI  EQU   UCM+32
UCMPXB   EQU   UCM+68
UCMMODE  EQU   UCMPXB
UCMVDATA EQU   UCM+72
UCMVEA   EQU   UCMVDATA
UCMVEZ   EQU   UCMVDATA+4
UCMRSV42 EQU   UCM+300
UCMRSV51 EQU   UCM+301
UCMEIL   EQU   0
UCMRECBA EQU   UCMEIL+24
UCMEXIT  EQU   0
UCMLIST  EQU   0
UCMECB   EQU   UCMLIST
UCMSTS   EQU   UCMLIST+24
UCMATR   EQU   UCMLIST+25
UCMXA    EQU   UCMLIST+26
UCMID    EQU   UCMXA
UCMXB    EQU   UCMLIST+28
UCMAUTH  EQU   UCMLIST+40
UCMAUTHA EQU   UCMAUTH
UCMDISP  EQU   UCMLIST+42
UCMDISP1 EQU   UCMDISP
UCMDISP2 EQU   UCMDISP+1
UCMMSG   EQU   UCMLIST+60
UCMMSG1  EQU   UCMMSG
UCMDEVC  EQU   UCMLIST+63
UCMRCT   EQU   UCMLIST+68
UCMSDS5  EQU   UCMRCT
BASE     EQU   0
BACHN    EQU   BASE
@NM00050 EQU   BASE+13
BALGSTAT EQU   BASE+24
BALOG    EQU   BALGSTAT+4
BASFL    EQU   BASE+36
BARSW    EQU   BASFL
MSLOGST  EQU   BASE+46
BASPBYTE EQU   BASE+47
BAMONITR EQU   BASE+56
@NM00072 EQU   BASE+104
MSLGCLOZ EQU   BASE+108
MSCLOSSW EQU   MSLGCLOZ
MSLGWLOG EQU   BASE+112
MSWLOGSW EQU   MSLGWLOG
MSLGWTR  EQU   BASE+116
MSWTRSW  EQU   MSLGWTR
MSLGSTRT EQU   BASE+120
MSSTRTSW EQU   MSLGSTRT
MS1BASEX EQU   BASE+136
BASES01  EQU   0
MSNTAL   EQU   BASES01
MSSSB    EQU   BASES01+1
MSBTN    EQU   MSSSB
MSPFG    EQU   BASES01+2
MSECBFL  EQU   BASES01+3
MSTUS    EQU   BASES01+4
MSSSA    EQU   MSTUS
MSINLSW  EQU   MSSSA
MSREOF   EQU   MSSSA
MSNWP    EQU   MSSSA
MSFHF    EQU   BASES01+5
CHAIN    EQU   0
CHPTR    EQU   CHAIN
CHFLG    EQU   CHAIN+4
CHVCD    EQU   CHFLG
CHSTS    EQU   CHFLG+2
CHFC     EQU   CHSTS
CHACT    EQU   CHFLG+3
CHKEY    EQU   CHAIN+8
CHCLS    EQU   CHAIN+16
CHPKE    EQU   CHAIN+28
CHTRKID  EQU   CHPKE
CHTJID   EQU   CHAIN+30
CHPROCSN EQU   CHAIN+32
CHACT1   EQU   CHPROCSN+3
CHASM    EQU   CHAIN+40
CHCIBP   EQU   CHASM+4
CHRGNSZ  EQU   CHASM+8
CHRGNAD  EQU   CHASM+12
CHCECB   EQU   CHASM+20
CHSTEP   EQU   CHASM+24
CHSWT    EQU   CHSTEP
CHSHORT  EQU   CHASM+32
TCBCPP   EQU   TCBCMPF
TCBSTCC  EQU   TCBCMPF
TCBCDBL  EQU   TCBCMPF
TCBCWTO  EQU   TCBCMPF
TCBCIND  EQU   TCBCMPF
TCBCMSG  EQU   TCBCMPF
TCBTRN   EQU   TCB+20
TCBABF   EQU   TCBTRN
TCBMSS   EQU   TCB+24
TCBPKF   EQU   TCB+28
TCBFLGS  EQU   TCB+29
TCBFLGS1 EQU   TCBFLGS
TCBFLGS2 EQU   TCBFLGS+1
TCBFLGS3 EQU   TCBFLGS+2
TCBFLGS4 EQU   TCBFLGS+3
TCBFLGS5 EQU   TCBFLGS+4
TCBABWF  EQU   TCBFLGS5
TCBJPQ   EQU   TCB+44
TCBPURGE EQU   TCBJPQ
TCBGRS   EQU   TCB+48
TCBFSA   EQU   TCB+112
TCBTME   EQU   TCB+120
TCBJSTCB EQU   TCB+124
TCBTSFLG EQU   TCB+148
TCBTSTSK EQU   TCBTSFLG
TCBSTAB  EQU   TCB+160
TCBNSTAE EQU   TCBSTAB
TCBTCT   EQU   TCB+164
TCBTCTGF EQU   TCBTCT
TCBSCNDY EQU   TCB+172
TCBNDSP  EQU   TCBSCNDY
TCBNDSP1 EQU   TCBNDSP+1
TCBNDSP2 EQU   TCBNDSP+2
TCBNDSP3 EQU   TCBNDSP+3
TCBJSCB  EQU   TCB+180
TCBRECDE EQU   TCBJSCB
TCBEXT1  EQU   TCB+196
TCBBITS  EQU   TCB+200
TCBNDSP4 EQU   TCBBITS
TCBNDSP5 EQU   TCBBITS+1
TCBFLGS6 EQU   TCBBITS+2
TCBFLGS7 EQU   TCBBITS+3
TCBDAR   EQU   TCB+204
TCBDARC  EQU   TCBDAR
TCBEXT2  EQU   TCB+208
TCBFOE   EQU   TCB+244
TCBESTAE EQU   TCB+264
TCBESTRM EQU   TCBESTAE+1
TCBFBYT1 EQU   TCB+276
TCBFBYT2 EQU   TCB+277
TCBRV124 EQU   TCB+278
TCBRV133 EQU   TCB+279
TCBXTNT2 EQU   0
TCBGTF   EQU   TCBXTNT2
TCBTFLG  EQU   TCBGTF
TCBRV146 EQU   TCBXTNT2+28
TCBRV155 EQU   TCBXTNT2+29
TCBRV164 EQU   TCBXTNT2+30
TCBRV173 EQU   TCBXTNT2+31
SDWA     EQU   0
SDWAPARM EQU   SDWA
SDWAFIOB EQU   SDWA+4
SDWAABCC EQU   SDWAFIOB
SDWACMPF EQU   SDWAABCC
SDWACTL1 EQU   SDWA+8
SDWACMKA EQU   SDWACTL1
SDWAMWPA EQU   SDWACTL1+1
SDWAPMKA EQU   SDWACTL1+4
SDWACTL2 EQU   SDWA+16
SDWACMKP EQU   SDWACTL2
SDWAMWPP EQU   SDWACTL2+1
SDWAPMKP EQU   SDWACTL2+4
SDWAGRSV EQU   SDWA+24
SDWANAME EQU   SDWA+88
SDWAEC1  EQU   SDWA+104
SDWAEMK1 EQU   SDWAEC1
SDWAMWP1 EQU   SDWAEC1+1
SDWAINT1 EQU   SDWAEC1+2
SDWANXT1 EQU   SDWAEC1+4
SDWAAEC1 EQU   SDWA+112
SDWAILC1 EQU   SDWAAEC1+1
SDWAINC1 EQU   SDWAAEC1+2
SDWAICD1 EQU   SDWAINC1+1
SDWAEC2  EQU   SDWA+120
SDWAEMK2 EQU   SDWAEC2
SDWAMWP2 EQU   SDWAEC2+1
SDWAINT2 EQU   SDWAEC2+2
SDWANXT2 EQU   SDWAEC2+4
SDWAAEC2 EQU   SDWA+128
SDWAILC2 EQU   SDWAAEC2+1
SDWAINC2 EQU   SDWAAEC2+2
SDWAICD2 EQU   SDWAINC2+1
SDWASRSV EQU   SDWA+136
SDWAIDNT EQU   SDWA+200
SDWAMCH  EQU   SDWA+204
SDWASTCK EQU   SDWAMCH
SDWAMCHI EQU   SDWAMCH+8
SDWAMCHS EQU   SDWAMCHI
SDWAMCHD EQU   SDWAMCHI+1
SDWARSR1 EQU   SDWAMCH+12
SDWARSR2 EQU   SDWAMCH+13
SDWAFLGS EQU   SDWA+232
SDWAERRA EQU   SDWAFLGS
SDWAMCHK EQU   SDWAERRA
SDWAERRB EQU   SDWAFLGS+1
SDWAERRC EQU   SDWAFLGS+2
SDWAPERC EQU   SDWAERRC
SDWAERRD EQU   SDWAFLGS+3
SDWAIOFS EQU   SDWA+238
SDWACPUA EQU   SDWA+248
SDWAPARQ EQU   SDWA+252
SDWARCDE EQU   SDWAPARQ
SDWAACF2 EQU   SDWAPARQ+1
SDWARCRD EQU   SDWAACF2
SDWAACF3 EQU   SDWAPARQ+2
SDWAACF4 EQU   SDWAPARQ+3
SDWALKWA EQU   SDWA+256
SDWALKWS EQU   SDWALKWA
SDWARECP EQU   SDWA+292
SDWASNPA EQU   SDWA+320
SDWADUMP EQU   SDWASNPA
SDWADPFS EQU   SDWADUMP+1
SDWADDAT EQU   SDWASNPA+4
SDWASDAT EQU   SDWADDAT
SDWAPDAT EQU   SDWADDAT+2
SDWADPSA EQU   SDWA+328
SDWADPSL EQU   SDWADPSA
SDWARA   EQU   SDWA+400
SDWADPVA EQU   SDWARA+2
SCB      EQU   0
SCBCHAIN EQU   SCB
SCBEXIT  EQU   SCB+4
SCBPARM  EQU   SCB+8
SCBFLGS1 EQU   SCBPARM
SCBIOPRC EQU   SCBFLGS1
SCBOWNR  EQU   SCB+12
SCBFLGS2 EQU   SCBOWNR
SCBDATA  EQU   SCB+16
SCBFLGS3 EQU   SCBDATA
WPLRF    EQU   0
WPLRPTR  EQU   WPLRF
WPL      EQU   0
WPLLGH   EQU   WPL
WPLMCSF  EQU   WPL+2
WPLMCSF1 EQU   WPLMCSF
WPLMCSF2 EQU   WPLMCSF+1
WPLMCSFJ EQU   WPLMCSF2
WPLTXT   EQU   WPL+4
WPLFLGS  EQU   0
WPLDESC  EQU   WPLFLGS
WPLDESC1 EQU   WPLDESC
WPLDESC2 EQU   WPLDESC+1
WPLROUT  EQU   WPLFLGS+2
WPLROUT1 EQU   WPLROUT
WPLROUT2 EQU   WPLROUT+1
WPLMSGTY EQU   WPLFLGS+4
WPLMSGT1 EQU   WPLMSGTY
WPLMSGT2 EQU   WPLMSGTY+1
WPLLS01  EQU   0
WPLLTF   EQU   WPLLS01
WPLLTF1  EQU   WPLLTF
WPLLTFC  EQU   WPLLTF1
WPLLTFD  EQU   WPLLTF1
WPLAREA  EQU   WPLLS01+2
WPLLINES EQU   WPLLS01+3
WPLML    EQU   0
WPLMLLEN EQU   WPLML+1
WPLMLLTF EQU   WPLML+2
WPLMLLT1 EQU   WPLMLLTF
WPLMLLTC EQU   WPLMLLT1
WPLMLLTD EQU   WPLMLLT1
CONVERT  EQU   0
STAELIST EQU   0
CSCBPASS EQU   STAELIST
COMMAND  EQU   STAELIST+4
RTNADDR  EQU   STAELIST+8
REGDATA  EQU   STAELIST+12
REGCODE1 EQU   STAELIST+16
REGCODE2 EQU   STAELIST+20
UCMECBAD EQU   STAELIST+24
SACBADDR EQU   STAELIST+28
STIMECB  EQU   STAELIST+32
CLEARBUF EQU   0
CLWTO    EQU   0
CLMSG    EQU   CLWTO+4
CLTIME   EQU   CLMSG+8
HRS      EQU   CLTIME
MIN      EQU   CLTIME+3
SEC      EQU   CLTIME+6
CLDATE   EQU   CLMSG+17                                          CBTMOD
CBTYR    EQU   CLDATE                                            CBTMOD
CBTDY    EQU   CLDATE+3                                          CBTMOD
JOBBUILD EQU   0
JOBSTEXT EQU   JOBBUILD+4
JOBNM    EQU   JOBSTEXT+2
STEPNM   EQU   JOBSTEXT+11
PROCSNM  EQU   JOBSTEXT+20
STRADDR  EQU   WPL+50                                            CBTMOD
ENDADDR  EQU   WPL+59                                            CBTMOD
CBTOASID EQU   WPL+43                                            CBTMOD
CBTOSTAT EQU   WPL+50                                            CBTMOD
CBTOTIME EQU   WPL+56                                            CBTMOD
CBTOMINS EQU   WPL+56                                            CBTMOD
CBTOSECS EQU   WPL+61                                            CBTMOD
CBTOHUNS EQU   WPL+64                                            CBTMOD
CBTOLIMT EQU   WPL+66                                            CBTMOD
TSBUILD  EQU   0
TSLTEXT  EQU   TSBUILD+4
TSID1    EQU   TSLTEXT+2
TSNAME   EQU   0
TSID     EQU   TSNAME
TSBL     EQU   TSNAME+8
CMDBUFR  EQU   0
TEXTWTO  EQU   CMDBUFR+4
CNSID    EQU   TEXTWTO+53
CNSLAREA EQU   TEXTWTO+55
I256C    EQU   0
DCMREND  EQU   0
I001C    EQU   0
I008P    EQU   0
I015F    EQU   0
I015P    EQU   0
I031F    EQU   0
I031P    EQU   0
UCMPRFXP EQU   0
UCM2PTR  EQU   0
DMY      EQU   0
DCMTSPTR EQU   UCMXB
CVTS01   EQU   CVTPGSIA
CVTLPDIA EQU   CVTS01+12
CVTDIRST EQU   CVTLPDIA
CVTSLIDA EQU   CVTS01+24
CVTCTLFG EQU   CVTS01+50
CVTRV210 EQU   CVTS01+424
CVTRV219 EQU   CVTS01+425
CVTRV228 EQU   CVTS01+426
CVTRV237 EQU   CVTS01+427
CVTMFRTR EQU   CVTS01+452
CVTRV262 EQU   CVTS01+468
CVTRV271 EQU   CVTS01+469
CVTRV280 EQU   CVTS01+470
CVTRV289 EQU   CVTS01+471
CVTGSDA  EQU   CVTS01+600
UCMBASPT EQU   CVTCUCB
UCMIECBA EQU   UCMRECBA+4
CHAINS01 EQU   CHASM
CHTYPE   EQU   CHAINS01+124
CHTRSTAT EQU   CHAINS01+125
CHJOBS   EQU   CHTRSTAT
CHJOBSL  EQU   CHTRSTAT
CHTS     EQU   CHTRSTAT
CHTSL    EQU   CHTRSTAT
CHCNID   EQU   CHAINS01+126
CHARID   EQU   CHAINS01+127
CHPEND   EQU   CHAINS01+128
CHCSYSO  EQU   CHAINS01+134
SCBPTR   EQU   TCBSTAB
WTOBUF   EQU   CHSWT
CHLAST   EQU   CHAINS01+136
CHSPA    EQU   CHAINS01+135
CHUSERID EQU   CHCSYSO
CHJB     EQU   CHCSYSO
CHDUMP   EQU   CHCSYSO
CHQUE    EQU   CHCSYSO
CHHOLD   EQU   CHCSYSO
CHOUT    EQU   CHCSYSO
CHINN    EQU   CHCSYSO
CHALL    EQU   CHCSYSO
CHINC    EQU   CHAINS01+132
@NM00092 EQU   CHTRSTAT
CHINITL  EQU   CHTRSTAT
CHINIT   EQU   CHTRSTAT
CHDEF    EQU   CHTYPE
CHHIAR   EQU   CHTYPE
CHARSV29 EQU   CHTYPE
CHARSV28 EQU   CHTYPE
CHARSV27 EQU   CHTYPE
CHARSV26 EQU   CHTYPE
CHARSV25 EQU   CHTYPE
CHDSTAT  EQU   CHTYPE
CHBUF    EQU   CHAINS01
UCMIECBP EQU   UCMIECBA+1
UCMIECBF EQU   UCMIECBA
CVTRV628 EQU   CVTS01+728
CVTRV627 EQU   CVTS01+724
CVTRV626 EQU   CVTS01+720
CVTRV625 EQU   CVTS01+716
CVTRV624 EQU   CVTS01+712
CVTRV623 EQU   CVTS01+708
CVTRV622 EQU   CVTS01+704
CVTRV621 EQU   CVTS01+700
CVTRV620 EQU   CVTS01+696
CVTRV619 EQU   CVTS01+692
CVTRV618 EQU   CVTS01+688
CVTRV617 EQU   CVTS01+684
CVTRV616 EQU   CVTS01+680
CVTRV615 EQU   CVTS01+676
CVTRV614 EQU   CVTS01+672
CVTRV613 EQU   CVTS01+668
CVTRV612 EQU   CVTS01+664
CVTRV611 EQU   CVTS01+660
CVTRV610 EQU   CVTS01+656
CVTRV609 EQU   CVTS01+652
CVTRV608 EQU   CVTS01+648
CVTRV607 EQU   CVTS01+644
CVTRV606 EQU   CVTS01+640
CVTRV605 EQU   CVTS01+636
CVTRV604 EQU   CVTS01+632
CVTEFF02 EQU   CVTS01+628
CVTCBBR  EQU   CVTS01+624
CVTSSCR  EQU   CVTS01+620
CVTEVENT EQU   CVTS01+616
CVTCRCA  EQU   CVTS01+612
CVTTPIO  EQU   CVTS01+608
CVTADV   EQU   CVTS01+604
CVTGSDAB EQU   CVTGSDA
CVTQV3   EQU   CVTS01+596
CVTQV2   EQU   CVTS01+592
CVTQV1   EQU   CVTS01+588
CVTRPT   EQU   CVTS01+584
CVTSSRB  EQU   CVTS01+580
CVTCSDRL EQU   CVTS01+576
CVTEXP1  EQU   CVTS01+572
CVTRMPMT EQU   CVTS01+568
CVTRMPTT EQU   CVTS01+564
CVTVPSA  EQU   CVTS01+560
CVTVSTOP EQU   CVTS01+556
CVTGTFR8 EQU   CVTS01+552
CVTQUIT  EQU   CVTS01+548
CVTVACR  EQU   CVTS01+544
CVTWTCB  EQU   CVTS01+540
CVTSTPRS EQU   CVTS01+536
CVT0PT02 EQU   CVTS01+532
CVTDARCM EQU   CVTS01+528
CVTIRECM EQU   CVTS01+524
CVTJRECM EQU   CVTS01+520
CVTVEMS0 EQU   CVTS01+516
CVTSPFRR EQU   CVTS01+512
CVTRLSTG EQU   CVTS01+508
CVT0TC0A EQU   CVTS01+504
CVTGMBR  EQU   CVTS01+500
CVTLFRM  EQU   CVTS01+496
CVTRMBR  EQU   CVTS01+492
CVTVIOP  EQU   CVTS01+488
CVTRV307 EQU   CVTS01+486
CVTRV306 EQU   CVTS01+484
CVTRV305 EQU   CVTS01+482
CVTRV304 EQU   CVTS01+480
CVTRV303 EQU   CVTS01+478
CVTRV302 EQU   CVTS01+476
CVTTRCA  EQU   CVTS01+472
CVTRV297 EQU   CVTRV289
CVTRV296 EQU   CVTRV289
CVTRV295 EQU   CVTRV289
CVTRV294 EQU   CVTRV289
CVTRV293 EQU   CVTRV289
CVTRV292 EQU   CVTRV289
CVTRV291 EQU   CVTRV289
CVTRV290 EQU   CVTRV289
CVTRV288 EQU   CVTRV280
CVTRV287 EQU   CVTRV280
CVTRV286 EQU   CVTRV280
CVTRV285 EQU   CVTRV280
CVTRV284 EQU   CVTRV280
CVTRV283 EQU   CVTRV280
CVTRV282 EQU   CVTRV280
CVTRV281 EQU   CVTRV280
CVTRV279 EQU   CVTRV271
CVTRV278 EQU   CVTRV271
CVTRV277 EQU   CVTRV271
CVTRV276 EQU   CVTRV271
CVTRV275 EQU   CVTRV271
CVTRV274 EQU   CVTRV271
CVTRV273 EQU   CVTRV271
CVTRV272 EQU   CVTRV271
CVTRV270 EQU   CVTRV262
CVTRV269 EQU   CVTRV262
CVTRV268 EQU   CVTRV262
CVTRV267 EQU   CVTRV262
CVTRV266 EQU   CVTRV262
CVTRV265 EQU   CVTRV262
CVTRV264 EQU   CVTRV262
CVTRV263 EQU   CVTRV262
CVTVFP   EQU   CVTS01+464
CVTVSI   EQU   CVTS01+460
CVTVPSIB EQU   CVTS01+456
CVTMFACT EQU   CVTMFRTR
CVTMFCTL EQU   CVTS01+448
CVTPVBP  EQU   CVTS01+444
CVTPWI   EQU   CVTS01+440
CVTRV254 EQU   CVTS01+438
CVTRV253 EQU   CVTS01+436
CVTRV252 EQU   CVTS01+434
CVTRV251 EQU   CVTS01+433
CVTRV250 EQU   CVTS01+432
CVTRV249 EQU   CVTS01+431
CVTRV248 EQU   CVTS01+430
CVTRV247 EQU   CVTS01+429
CVTRV246 EQU   CVTS01+428
CVTRV245 EQU   CVTRV237
CVTRV234 EQU   CVTRV228
CVTRV233 EQU   CVTRV228
CVTRV232 EQU   CVTRV228
CVTRV231 EQU   CVTRV228
CVTRV230 EQU   CVTRV228
CVTRV229 EQU   CVTRV228
CVTRV227 EQU   CVTRV219
CVTRV226 EQU   CVTRV219
CVTRV225 EQU   CVTRV219
CVTRV224 EQU   CVTRV219
CVTRV223 EQU   CVTRV219
CVTRV222 EQU   CVTRV219
CVTRV221 EQU   CVTRV219
CVTRV220 EQU   CVTRV219
CVTRV218 EQU   CVTRV210
CVTRV217 EQU   CVTRV210
CVTRV216 EQU   CVTRV210
CVTRV215 EQU   CVTRV210
CVTRV214 EQU   CVTRV210
CVTRV213 EQU   CVTRV210
CVTRV212 EQU   CVTRV210
CVTRV211 EQU   CVTRV210
CVTLCCAT EQU   CVTS01+420
CVTPCCAT EQU   CVTS01+416
CVTIPCRP EQU   CVTS01+412
CVTIPCRI EQU   CVTS01+408
CVTIPCDS EQU   CVTS01+404
CVTAIDVT EQU   CVTS01+400
CVTSSAP  EQU   CVTS01+396
CVTEHCIR EQU   CVTS01+392
CVTEHDEF EQU   CVTS01+388
CVTDAIR  EQU   CVTS01+384
CVTPERFM EQU   CVTS01+380
CVT044R2 EQU   CVTS01+376
CVTFETCH EQU   CVTS01+372
CVTRSTWD EQU   CVTS01+368
CVTSPOST EQU   CVTS01+364
CVTIOBP  EQU   CVTS01+360
CVTASMVT EQU   CVTS01+356
CVTRECRQ EQU   CVTS01+352
CVTWSAC  EQU   CVTS01+348
CVTRV149 EQU   CVTS01+344
CVTWSAL  EQU   CVTS01+340
CVTSPSA  EQU   CVTS01+336
CVTGLMN  EQU   CVTS01+332
CVTVEAC0 EQU   CVTS01+328
CVT062R1 EQU   CVTS01+324
CVTRPOST EQU   CVTS01+320
CVTDQIQE EQU   CVTS01+316
CVTCSD   EQU   CVTS01+312
CVTLKRMA EQU   CVTS01+308
CVTRSPIE EQU   CVTS01+304
CVTRENQ  EQU   CVTS01+300
CVTLQCB  EQU   CVTS01+296
CVTFQCB  EQU   CVTS01+292
CVTQCS01 EQU   CVTS01+288
CVTAPFT  EQU   CVTS01+284
CVTPARRL EQU   CVTS01+280
CVTVWAIT EQU   CVTS01+276
CVTGSPL  EQU   CVTS01+272
CVTLSMQ  EQU   CVTS01+268
CVTGSMQ  EQU   CVTS01+264
CVTEXPRO EQU   CVTS01+260
CVTOPCTP EQU   CVTS01+256
CVTSIC   EQU   CVTS01+252
CVTTPIOS EQU   CVTS01+248
CVTRTMS  EQU   CVTS01+244
CVTSDBF  EQU   CVTS01+240
CVTSCBP  EQU   CVTS01+236
CVTSDMP  EQU   CVTS01+232
CVTSV60  EQU   CVTS01+228
CVTRTMCT EQU   CVTS01+224
CVTASCBL EQU   CVTS01+220
CVTASCBH EQU   CVTS01+216
CVTGDA   EQU   CVTS01+212
CVTASVT  EQU   CVTS01+208
CVTVVMDI EQU   CVTS01+204
CVTAQTOP EQU   CVTS01+200
CVTIOSCS EQU   CVTS01+196
CVTSDRM  EQU   CVTS01+192
CVTOPTE  EQU   CVTS01+188
CVTSTXU  EQU   CVTS01+184
CVTQUIS  EQU   CVTS01+180
CVTPARS  EQU   CVTS01+176
CVTS1EE  EQU   CVTS01+172
CVTFRAS  EQU   CVTS01+168
CVTQSAS  EQU   CVTS01+164
CVTCRAS  EQU   CVTS01+160
CVTCRMN  EQU   CVTS01+156
CVTDELCP EQU   CVTS01+152
CVTFRECL EQU   CVTS01+148
CVTGETCL EQU   CVTS01+144
CVTBLDCP EQU   CVTS01+140
CVTAUTHL EQU   CVTS01+136
CVTSCAN  EQU   CVTS01+132
CVTRV144 EQU   CVTS01+130
CVTMAXMP EQU   CVTS01+128
CVTSTCK  EQU   CVTS01+124
CVTRV139 EQU   CVTS01+123
CVTDSSAC EQU   CVTS01+122
CVTRV513 EQU   CVTS01+121
CVTIOSPL EQU   CVTS01+120
CVTPTGT  EQU   CVTS01+116
CVTCSPIE EQU   CVTS01+112
CVTSMFEX EQU   CVTS01+108
CVTOLT0A EQU   CVTS01+104
CVTSRBRT EQU   CVTS01+100
CVTPUTL  EQU   CVTS01+96
CVTRV519 EQU   CVTS01+92
CVTRV327 EQU   CVTS01+88
CVTRV326 EQU   CVTS01+84
CVTRV325 EQU   CVTS01+80
CVTRV324 EQU   CVTS01+76
CVT0VL01 EQU   CVTS01+72
CVTSHRVM EQU   CVTS01+68
CVTRV332 EQU   CVTS01+64
CVTTAS   EQU   CVTS01+60
CVTRSCN  EQU   CVTS01+56
CVTTRAC2 EQU   CVTS01+54
CVTTRACE EQU   CVTS01+52
CVTAPG   EQU   CVTS01+51
CVTSDTRC EQU   CVTCTLFG
CVTGTRCE EQU   CVTCTLFG
CVTNOMP  EQU   CVTCTLFG
CVTRSV79 EQU   CVTCTLFG
CVTDSTAT EQU   CVTCTLFG
CVTRSV78 EQU   CVTCTLFG
CVTRV333 EQU   CVTCTLFG
CVTRV323 EQU   CVTCTLFG
CVTSPVLK EQU   CVTS01+49
CVTRSV77 EQU   CVTS01+48
CVTRV331 EQU   CVTS01+44
CVTRV330 EQU   CVTS01+40
CVTRV329 EQU   CVTS01+36
CVTRV328 EQU   CVTS01+32
CVTRV322 EQU   CVTS01+28
CVTSLID  EQU   CVTSLIDA+1
CVTSYLK  EQU   CVTSLIDA
CVTRV321 EQU   CVTS01+20
CVTRV320 EQU   CVTS01+16
CVTLPDIR EQU   CVTLPDIA+1
CVTRSV69 EQU   CVTDIRST
CVTRSV68 EQU   CVTDIRST
CVTRSV67 EQU   CVTDIRST
CVTRSV66 EQU   CVTDIRST
CVTRSV65 EQU   CVTDIRST
CVTRSV64 EQU   CVTDIRST
CVTRSV63 EQU   CVTDIRST
CVTDICOM EQU   CVTDIRST
CVTPVTP  EQU   CVTS01+8
CVTLPDSR EQU   CVTS01+4
CVTGETL  EQU   CVTS01
DESCRTC  EQU   CMDBUFR+69
@NM00162 EQU   TEXTWTO+56
@NM00161 EQU   TEXTWTO
FLAGWTO  EQU   CMDBUFR+2
LGTHWTO  EQU   CMDBUFR
@NM00160 EQU   TSLTEXT
@NM00159 EQU   TSBUILD
SECONDK  EQU   JOBSTEXT+64                                       CBTMOD
FIRSTK   EQU   JOBSTEXT+55                                       CBTMOD
JTEXT    EQU   JOBSTEXT+28
SBLANK   EQU   JOBSTEXT+19
JBLANK   EQU   JOBSTEXT+10
@NM00158 EQU   JOBSTEXT
@NM00157 EQU   JOBBUILD
CLNMBR   EQU   CLWTO+40
CLAREAID EQU   CLWTO+39
CLLTYPE  EQU   CLWTO+37
CLROUT   EQU   CLWTO+35
CLDESC   EQU   CLWTO+33
CLTITLE  EQU   CLMSG+16
PER2     EQU   CLTIME+5
PER1     EQU   CLTIME+2
CLID     EQU   CLMSG
CLMCS    EQU   CLWTO+2
CLLENG   EQU   CLWTO
WPLMLTXT EQU   WPLML+4
WPLMLLT2 EQU   WPLMLLTF+1
WPLRSV24 EQU   WPLMLLT1
WPLRSV23 EQU   WPLMLLT1
WPLRSV22 EQU   WPLMLLT1
WPLRSV21 EQU   WPLMLLT1
WPLMLLTB EQU   WPLMLLT1
WPLMLLTA EQU   WPLMLLT1
WPLML0   EQU   WPLML
WPLLTF2  EQU   WPLLTF+1
WPLRSV20 EQU   WPLLTF1
WPLRSV19 EQU   WPLLTF1
WPLRSV18 EQU   WPLLTF1
WPLRSV17 EQU   WPLLTF1
WPLLTFB  EQU   WPLLTF1
WPLLTFA  EQU   WPLLTF1
WPLQID   EQU   WPLFLGS+6
WPLRSV32 EQU   WPLMSGT2
WPLRSV31 EQU   WPLMSGT2
WPLRSV30 EQU   WPLMSGT2
WPLRSV29 EQU   WPLMSGT2
WPLRSV28 EQU   WPLMSGT2
WPLRSV27 EQU   WPLMSGT2
WPLRSV26 EQU   WPLMSGT2
WPLRSV25 EQU   WPLMSGT2
WPLRSV16 EQU   WPLMSGT1
WPLRSV15 EQU   WPLMSGT1
WPLMSGTF EQU   WPLMSGT1
WPLRSV14 EQU   WPLMSGT1
WPLMSGTD EQU   WPLMSGT1
WPLMSGTC EQU   WPLMSGT1
WPLMSGTB EQU   WPLMSGT1
WPLMSGTA EQU   WPLMSGT1
WPLRSV13 EQU   WPLROUT2
WPLROUTO EQU   WPLROUT2
WPLROUTN EQU   WPLROUT2
WPLROUTM EQU   WPLROUT2
WPLROUTL EQU   WPLROUT2
WPLROUTK EQU   WPLROUT2
WPLROUTJ EQU   WPLROUT2
WPLROUTI EQU   WPLROUT2
WPLROUTH EQU   WPLROUT1
WPLROUTG EQU   WPLROUT1
WPLROUTF EQU   WPLROUT1
WPLROUTE EQU   WPLROUT1
WPLROUTD EQU   WPLROUT1
WPLROUTC EQU   WPLROUT1
WPLROUTB EQU   WPLROUT1
WPLROUTA EQU   WPLROUT1
WPLRSV12 EQU   WPLDESC2
WPLRSV11 EQU   WPLDESC2
WPLRSV10 EQU   WPLDESC2
WPLRSV09 EQU   WPLDESC2
WPLRSV08 EQU   WPLDESC2
WPLRSV07 EQU   WPLDESC2
WPLDESCJ EQU   WPLDESC2
WPLDESCI EQU   WPLDESC2
WPLDESCH EQU   WPLDESC1
WPLDESCG EQU   WPLDESC1
WPLDESCF EQU   WPLDESC1
WPLDESCE EQU   WPLDESC1
WPLDESCD EQU   WPLDESC1
WPLDESCC EQU   WPLDESC1
WPLDESCB EQU   WPLDESC1
WPLDESCA EQU   WPLDESC1
WPLTXTL  EQU   WPLTXT+125
@NM00152 EQU   WPLTXT
WPLRSV05 EQU   WPLMCSF2
WPLRSV04 EQU   WPLMCSF2
WPLMCSFN EQU   WPLMCSF2
WPLRSV03 EQU   WPLMCSF2
WPLNOWTP EQU   WPLMCSF2
WPLMCSFK EQU   WPLMCSF2
WPLMCSFI EQU   WPLMCSF2
WPLMCSFH EQU   WPLMCSF1
WPLMCSFG EQU   WPLMCSF1
WPLMCSFF EQU   WPLMCSF1
WPLMCSFE EQU   WPLMCSF1
WPLMCSFD EQU   WPLMCSF1
WPLMCSFC EQU   WPLMCSF1
WPLMCSFB EQU   WPLMCSF1
WPLMCSFA EQU   WPLMCSF1
WPLRECB  EQU   WPLRF+4
WPLRPTRA EQU   WPLRPTR+1
WPLRLN   EQU   WPLRPTR
SCBRSVRE EQU   SCBDATA+3
SCBID    EQU   SCBDATA+2
SCBPKEY  EQU   SCBDATA+1
@NM00151 EQU   SCBFLGS3
SCBTERMO EQU   SCBFLGS3
SCBBRNTR EQU   SCBFLGS3
SCBPRNTR EQU   SCBFLGS3
SCBCNCEL EQU   SCBFLGS3
SCBRECRD EQU   SCBFLGS3
SCBTERMI EQU   SCBFLGS3
@NM00150 EQU   SCBFLGS3
SCBOWNRA EQU   SCBOWNR+1
SCBSUPER EQU   SCBFLGS2
SCBKEY0  EQU   SCBFLGS2
@NM00149 EQU   SCBFLGS2
@NM00148 EQU   SCBFLGS2
SCBINUSE EQU   SCBFLGS2
@NM00147 EQU   SCBFLGS2
SCBXCTL2 EQU   SCBFLGS2
@NM00146 EQU   SCBFLGS2
SCBPARMA EQU   SCBPARM+1
SCBHALT  EQU   SCBIOPRC
SCBNOIOP EQU   SCBIOPRC
SCBASYNC EQU   SCBFLGS1
@NM00145 EQU   SCBFLGS1
SCBESTAE EQU   SCBFLGS1
SCBDUMMY EQU   SCBFLGS1
SCBSTAR  EQU   SCBFLGS1
SCBSTAI  EQU   SCBFLGS1
@NM00144 EQU   SDWA+512
SDWAVRA  EQU   SDWARA+4
SDWAURAL EQU   SDWARA+3
@NM00143 EQU   SDWADPVA
SDWAEBC  EQU   SDWADPVA
SDWAHEX  EQU   SDWADPVA
SDWAVRAL EQU   SDWARA
@NM00142 EQU   SDWA+396
SDWACOMP EQU   SDWA+392
SDWARCPL EQU   SDWA+364
@NM00141 EQU   SDWADPSA+32
SDWATO4  EQU   SDWADPSL+28
SDWAFRM4 EQU   SDWADPSL+24
SDWATO3  EQU   SDWADPSL+20
SDWAFRM3 EQU   SDWADPSL+16
SDWATO2  EQU   SDWADPSL+12
SDWAFRM2 EQU   SDWADPSL+8
SDWATO1  EQU   SDWADPSL+4
SDWAFRM1 EQU   SDWADPSL
@NM00140 EQU   SDWADDAT+3
@NM00139 EQU   SDWAPDAT
SDWAUSPL EQU   SDWAPDAT
SDWADPSW EQU   SDWAPDAT
SDWATJPA EQU   SDWAPDAT
SDWATLPA EQU   SDWAPDAT
SDWADREG EQU   SDWAPDAT
SDWADSAH EQU   SDWAPDAT
SDWADSAS EQU   SDWAPDAT
@NM00138 EQU   SDWADDAT+1
@NM00137 EQU   SDWASDAT
SDWAQQS  EQU   SDWASDAT
SDWACBS  EQU   SDWASDAT
SDWAGTF  EQU   SDWASDAT
SDWASWA  EQU   SDWASDAT
SDWALSQA EQU   SDWASDAT
SDWASQA  EQU   SDWASDAT
SDWANUC  EQU   SDWASDAT
@NM00136 EQU   SDWADUMP+2
@NM00135 EQU   SDWADPFS
SDWASLST EQU   SDWADPFS
@NM00134 EQU   SDWADPFS
SDWADLST EQU   SDWADPFS
SDWADPT  EQU   SDWADPFS
SDWADPID EQU   SDWADUMP
SDWADPLA EQU   SDWA+316
SDWAREXN EQU   SDWARECP+16
SDWACSCT EQU   SDWARECP+8
SDWAMODN EQU   SDWARECP
@NM00133 EQU   SDWALKWA+32
SDWATALW EQU   SDWALKWS+28
SDWATDLW EQU   SDWALKWS+24
SDWATNLW EQU   SDWALKWS+20
SDWAAPLW EQU   SDWALKWS+16
SDWAIPLW EQU   SDWALKWS+12
SDWAILLW EQU   SDWALKWS+8
SDWAIULW EQU   SDWALKWS+4
SDWAICLW EQU   SDWALKWS
SDWAFLLK EQU   SDWAACF4
SDWACMS  EQU   SDWAACF4
SDWAOPTM EQU   SDWAACF4
SDWATADB EQU   SDWAACF4
SDWATDNB EQU   SDWAACF4
SDWATNCB EQU   SDWAACF4
SDWAILCH EQU   SDWAACF4
SDWAIUCB EQU   SDWAACF4
SDWAICAT EQU   SDWAACF3
SDWAIPRG EQU   SDWAACF3
SDWASALL EQU   SDWAACF3
SDWAASMP EQU   SDWAACF3
SDWADISP EQU   SDWAACF3
@NM00132 EQU   SDWAACF3
@NM00131 EQU   SDWAACF2
SDWAFREE EQU   SDWAACF2
SDWAUPRG EQU   SDWAACF2
@NM00130 EQU   SDWAACF2
SDWASPIN EQU   SDWAACF2
@NM00129 EQU   SDWAACF2
SDWALCPU EQU   SDWACPUA+2
@NM00128 EQU   SDWACPUA
SDWARECA EQU   SDWA+244
SDWARTYA EQU   SDWA+240
@NM00127 EQU   SDWA+239
@NM00126 EQU   SDWAIOFS
SDWANIOP EQU   SDWAIOFS
SDWANOIO EQU   SDWAIOFS
SDWAIOHT EQU   SDWAIOFS
SDWAIOQR EQU   SDWAIOFS
SDWAFMID EQU   SDWA+236
@NM00125 EQU   SDWAERRD
SDWAMCIV EQU   SDWAERRD
SDWARPIV EQU   SDWAERRD
SDWAMABD EQU   SDWAERRD
SDWACTS  EQU   SDWAERRD
SDWASTAE EQU   SDWAERRD
SDWANRBE EQU   SDWAERRD
SDWACLUP EQU   SDWAERRD
@NM00124 EQU   SDWAERRC
SDWAEAS  EQU   SDWAERRC
SDWAIRB  EQU   SDWAERRC
SDWASTAI EQU   SDWAERRC
SDWASTAF EQU   SDWAERRC
SDWASRBM EQU   SDWAERRB
SDWALDIS EQU   SDWAERRB
SDWAENRB EQU   SDWAERRB
SDWATYP1 EQU   SDWAERRB
@NM00123 EQU   SDWAERRB
SDWAPGIO EQU   SDWAERRA
SDWATEXC EQU   SDWAERRA
SDWASVCE EQU   SDWAERRA
SDWAFLSQ EQU   SDWARSR2
SDWAFSQA EQU   SDWARSR2
SDWANUCL EQU   SDWARSR2
SDWASPER EQU   SDWARSR2
SDWAINTC EQU   SDWARSR2
SDWAOFLN EQU   SDWARSR2
SDWACHNG EQU   SDWARSR1
SDWAMSER EQU   SDWARSR1
@NM00121 EQU   SDWARSR1
SDWACPID EQU   SDWAMCH+10
SDWATERR EQU   SDWAMCHD
SDWAFPRX EQU   SDWAMCHD
SDWAINSF EQU   SDWAMCHD
SDWAACR  EQU   SDWAMCHD
SDWASCK  EQU   SDWAMCHD
SDWAPSWU EQU   SDWAMCHD
SDWAREGU EQU   SDWAMCHD
SDWASKYF EQU   SDWAMCHD
@NM00120 EQU   SDWAMCHS
SDWARSRF EQU   SDWAMCHS
SDWARSRC EQU   SDWAMCHS
SDWAINVP EQU   SDWAMCHS
SDWATSVL EQU   SDWAMCHS
SDWARCDF EQU   SDWAMCHS
SDWASRVL EQU   SDWAMCHS
SDWASCKE EQU   SDWASTCK+4
SDWASCKB EQU   SDWASTCK
SDWALNTH EQU   SDWAIDNT+1
SDWASPID EQU   SDWAIDNT
SDWASR15 EQU   SDWASRSV+60
SDWASR14 EQU   SDWASRSV+56
SDWASR13 EQU   SDWASRSV+52
SDWASR12 EQU   SDWASRSV+48
SDWASR11 EQU   SDWASRSV+44
SDWASR10 EQU   SDWASRSV+40
SDWASR09 EQU   SDWASRSV+36
SDWASR08 EQU   SDWASRSV+32
SDWASR07 EQU   SDWASRSV+28
SDWASR06 EQU   SDWASRSV+24
SDWASR05 EQU   SDWASRSV+20
SDWASR04 EQU   SDWASRSV+16
SDWASR03 EQU   SDWASRSV+12
SDWASR02 EQU   SDWASRSV+8
SDWASR01 EQU   SDWASRSV+4
SDWASR00 EQU   SDWASRSV
SDWATRN2 EQU   SDWAAEC2+4
SDWAIPC2 EQU   SDWAICD2
SDWAIMC2 EQU   SDWAICD2
SDWAIPR2 EQU   SDWAICD2
@NM00119 EQU   SDWAINC2
@NM00118 EQU   SDWAILC2
SDWAIL2  EQU   SDWAILC2
@NM00117 EQU   SDWAILC2
@NM00116 EQU   SDWAAEC2
SDWAADD2 EQU   SDWANXT2+1
@NM00115 EQU   SDWANXT2
@NM00114 EQU   SDWAEC2+3
SDWASGN2 EQU   SDWAINT2
SDWAEXP2 EQU   SDWAINT2
SDWADEC2 EQU   SDWAINT2
SDWAFPO2 EQU   SDWAINT2
SDWACC2  EQU   SDWAINT2
@NM00113 EQU   SDWAINT2
SDWAPGM2 EQU   SDWAMWP2
SDWAWAT2 EQU   SDWAMWP2
SDWAMCK2 EQU   SDWAMWP2
SDWAECT2 EQU   SDWAMWP2
SDWAKEY2 EQU   SDWAMWP2
SDWAEXT2 EQU   SDWAEMK2
SDWAIO2  EQU   SDWAEMK2
SDWATRM2 EQU   SDWAEMK2
@NM00112 EQU   SDWAEMK2
SDWAPER2 EQU   SDWAEMK2
@NM00111 EQU   SDWAEMK2
SDWATRAN EQU   SDWAAEC1+4
SDWAIPC1 EQU   SDWAICD1
SDWAIMC1 EQU   SDWAICD1
SDWAIPR1 EQU   SDWAICD1
@NM00110 EQU   SDWAINC1
@NM00109 EQU   SDWAILC1
SDWAIL1  EQU   SDWAILC1
@NM00108 EQU   SDWAILC1
@NM00107 EQU   SDWAAEC1
SDWAADD1 EQU   SDWANXT1+1
@NM00106 EQU   SDWANXT1
@NM00105 EQU   SDWAEC1+3
SDWASGN1 EQU   SDWAINT1
SDWAEXP1 EQU   SDWAINT1
SDWADEC1 EQU   SDWAINT1
SDWAFPO1 EQU   SDWAINT1
SDWACC1  EQU   SDWAINT1
@NM00104 EQU   SDWAINT1
SDWAPGM1 EQU   SDWAMWP1
SDWAWAT1 EQU   SDWAMWP1
SDWAMCK1 EQU   SDWAMWP1
SDWAECT1 EQU   SDWAMWP1
SDWAKEY1 EQU   SDWAMWP1
SDWAEXT1 EQU   SDWAEMK1
SDWAIO1  EQU   SDWAEMK1
SDWATRM1 EQU   SDWAEMK1
@NM00103 EQU   SDWAEMK1
SDWAPER1 EQU   SDWAEMK1
@NM00102 EQU   SDWAEMK1
SDWAIOBR EQU   SDWA+100
SDWAEPA  EQU   SDWA+96
@NM00101 EQU   SDWANAME+4
SDWARBAD EQU   SDWANAME
SDWAGR15 EQU   SDWAGRSV+60
SDWAGR14 EQU   SDWAGRSV+56
SDWAGR13 EQU   SDWAGRSV+52
SDWAGR12 EQU   SDWAGRSV+48
SDWAGR11 EQU   SDWAGRSV+44
SDWAGR10 EQU   SDWAGRSV+40
SDWAGR09 EQU   SDWAGRSV+36
SDWAGR08 EQU   SDWAGRSV+32
SDWAGR07 EQU   SDWAGRSV+28
SDWAGR06 EQU   SDWAGRSV+24
SDWAGR05 EQU   SDWAGRSV+20
SDWAGR04 EQU   SDWAGRSV+16
SDWAGR03 EQU   SDWAGRSV+12
SDWAGR02 EQU   SDWAGRSV+8
SDWAGR01 EQU   SDWAGRSV+4
SDWAGR00 EQU   SDWAGRSV
SDWANXTP EQU   SDWACTL2+5
SDWASGP  EQU   SDWAPMKP
SDWAEUP  EQU   SDWAPMKP
SDWADOP  EQU   SDWAPMKP
SDWAFPP  EQU   SDWAPMKP
SDWACCP  EQU   SDWAPMKP
SDWAILP  EQU   SDWAPMKP
SDWAINTP EQU   SDWACTL2+2
SDWASPVP EQU   SDWAMWPP
SDWAWATP EQU   SDWAMWPP
SDWAMCKP EQU   SDWAMWPP
@NM00100 EQU   SDWAMWPP
SDWAKEYP EQU   SDWAMWPP
SDWAEXTP EQU   SDWACMKP
SDWAIOP  EQU   SDWACMKP
SDWANXTA EQU   SDWACTL1+5
SDWASGA  EQU   SDWAPMKA
SDWAEUA  EQU   SDWAPMKA
SDWADOA  EQU   SDWAPMKA
SDWAFPA  EQU   SDWAPMKA
SDWACCA  EQU   SDWAPMKA
SDWAILA  EQU   SDWAPMKA
SDWAINTA EQU   SDWACTL1+2
SDWASPVA EQU   SDWAMWPA
SDWAWATA EQU   SDWAMWPA
SDWAMCKA EQU   SDWAMWPA
@NM00099 EQU   SDWAMWPA
SDWAKEYA EQU   SDWAMWPA
SDWAEXTA EQU   SDWACMKA
SDWAIOA  EQU   SDWACMKA
SDWACMPC EQU   SDWAABCC+1
@NM00098 EQU   SDWACMPF
SDWASTCC EQU   SDWACMPF
@NM00097 EQU   SDWACMPF
SDWASTEP EQU   SDWACMPF
SDWAREQ  EQU   SDWACMPF
@NM00096 EQU   TCBXTNT2+32
TCBRV181 EQU   TCBRV173
TCBRV180 EQU   TCBRV173
TCBRV179 EQU   TCBRV173
TCBRV178 EQU   TCBRV173
TCBRV177 EQU   TCBRV173
TCBRV176 EQU   TCBRV173
TCBRV175 EQU   TCBRV173
TCBRV174 EQU   TCBRV173
TCBRV172 EQU   TCBRV164
TCBRV171 EQU   TCBRV164
TCBRV170 EQU   TCBRV164
TCBRV169 EQU   TCBRV164
TCBRV168 EQU   TCBRV164
TCBRV167 EQU   TCBRV164
TCBRV166 EQU   TCBRV164
TCBRV165 EQU   TCBRV164
TCBRV163 EQU   TCBRV155
TCBRV162 EQU   TCBRV155
TCBRV161 EQU   TCBRV155
TCBRV160 EQU   TCBRV155
TCBRV159 EQU   TCBRV155
TCBRV158 EQU   TCBRV155
TCBRV157 EQU   TCBRV155
TCBRV156 EQU   TCBRV155
TCBRV154 EQU   TCBRV146
TCBRV153 EQU   TCBRV146
TCBRV152 EQU   TCBRV146
TCBRV151 EQU   TCBRV146
TCBRV150 EQU   TCBRV146
TCBRV149 EQU   TCBRV146
TCBRV148 EQU   TCBRV146
TCBRV147 EQU   TCBRV146
TCBRV145 EQU   TCBXTNT2+26
TCBRV144 EQU   TCBXTNT2+24
TCBRV143 EQU   TCBXTNT2+20
TCBRV142 EQU   TCBXTNT2+16
TCBRSV49 EQU   TCBXTNT2+12
TCBEVENT EQU   TCBXTNT2+8
TCBRCMP  EQU   TCBXTNT2+5
TCBRSVAB EQU   TCBXTNT2+4
TCBGTFA  EQU   TCBGTF+1
TCBRSV47 EQU   TCBTFLG
TCBRSV46 EQU   TCBTFLG
TCBRSV45 EQU   TCBTFLG
TCBRSV44 EQU   TCBTFLG
TCBRSV43 EQU   TCBTFLG
TCBDSPIT EQU   TCBTFLG
TCBERRTN EQU   TCBTFLG
TCBASYNC EQU   TCBTFLG
@NM00095 EQU   TCB+296
TCBRV185 EQU   TCB+292
TCBSWASA EQU   TCB+288
TCBDBTB  EQU   TCB+284
TCBRPT   EQU   TCB+280
TCBRV141 EQU   TCBRV133
TCBRV140 EQU   TCBRV133
TCBRV139 EQU   TCBRV133
TCBRV138 EQU   TCBRV133
TCBRV137 EQU   TCBRV133
TCBRV136 EQU   TCBRV133
TCBRV135 EQU   TCBRV133
TCBRV134 EQU   TCBRV133
TCBRV132 EQU   TCBRV124
TCBRV131 EQU   TCBRV124
TCBRV130 EQU   TCBRV124
TCBRV129 EQU   TCBRV124
TCBRV128 EQU   TCBRV124
TCBRV127 EQU   TCBRV124
TCBRV126 EQU   TCBRV124
TCBRV125 EQU   TCBRV124
TCBRV123 EQU   TCBFBYT2
TCBRV122 EQU   TCBFBYT2
TCBECBNV EQU   TCBFBYT2
TCBSSSYN EQU   TCBFBYT2
TCBFPRAP EQU   TCBFBYT2
TCBFDW   EQU   TCBFBYT2
TCBFMW   EQU   TCBFBYT2
TCBCNCB  EQU   TCBFBYT2
TCBLLH   EQU   TCBFBYT1
TCBRV113 EQU   TCBFBYT1
TCBEOT   EQU   TCBFBYT1
TCBRTM2  EQU   TCBFBYT1
TCBPGNLY EQU   TCBFBYT1
TCBNDIOS EQU   TCBFBYT1
TCBACTIV EQU   TCBFBYT1
TCBEOTFM EQU   TCBFBYT1
TCBAFFN  EQU   TCB+274
TCBCCPVI EQU   TCB+272
TCBUKYSP EQU   TCB+268
TCBMODE  EQU   TCBESTAE+3
TCBERTYP EQU   TCBESTAE+2
TCBRV314 EQU   TCBESTRM
TCBRV313 EQU   TCBESTRM
TCBRV312 EQU   TCBESTRM
TCBRV311 EQU   TCBESTRM
TCBRV310 EQU   TCBESTRM
TCBRV309 EQU   TCBESTRM
TCBRV308 EQU   TCBESTRM
TCBETERM EQU   TCBESTRM
TCBSCBKY EQU   TCBESTAE
TCBRTM12 EQU   TCB+260
TCBTCBID EQU   TCB+256
TCBRSV96 EQU   TCB+252
TCBSWA   EQU   TCB+248
TCBFOEA  EQU   TCBFOE+1
TCBRSV42 EQU   TCBFOE
TCBRV306 EQU   TCB+240
TCBRSV41 EQU   TCB+239
TCBTID   EQU   TCB+238
TCBRSVAA EQU   TCB+237
TCBABCUR EQU   TCB+236
TCBTMSAV EQU   TCB+232
TCBIOTIM EQU   TCB+228
TCBRTWA  EQU   TCB+224
TCBBACK  EQU   TCB+220
TCBTIRB  EQU   TCB+216
TCBAECB  EQU   TCB+212
TCBEXT2A EQU   TCBEXT2+1
TCBRSV39 EQU   TCBEXT2
TCBSTMCT EQU   TCB+207
TCBSYSCT EQU   TCB+206
TCBRSV37 EQU   TCB+205
TCBEXSVC EQU   TCBDAR
TCBRSV36 EQU   TCBDAR
TCBDARWT EQU   TCBDAR
TCBDARO  EQU   TCBDAR
TCBDARMC EQU   TCBDARC
TCBDARD  EQU   TCBDAR
TCBDARS  EQU   TCBDAR
TCBDARP  EQU   TCBDAR
TCBGTOFM EQU   TCBFLGS7
TCBADMP  EQU   TCBFLGS7
TCBRSTSK EQU   TCBFLGS7
TCBRSV35 EQU   TCBFLGS7
TCBSTACK EQU   TCBFLGS7
TCBRSV34 EQU   TCBFLGS7
TCBRSV33 EQU   TCBFLGS7
TCBGPECB EQU   TCBFLGS7
TCBNTJS  EQU   TCBFLGS6
TCBAPG   EQU   TCBFLGS6
TCBMIGR  EQU   TCBFLGS6
TCBRV303 EQU   TCBFLGS6
TCBSPVLK EQU   TCBFLGS6
TCBCPU   EQU   TCBFLGS6
TCBPIE17 EQU   TCBFLGS6
TCBRV    EQU   TCBFLGS6
TCBRSV79 EQU   TCBNDSP5
TCBRSV78 EQU   TCBNDSP5
TCBRSV77 EQU   TCBNDSP5
TCBRSV76 EQU   TCBNDSP5
TCBRSV75 EQU   TCBNDSP5
TCBRSV74 EQU   TCBNDSP5
TCBRSV95 EQU   TCBNDSP5
TCBRSV94 EQU   TCBNDSP5
TCBRSV93 EQU   TCBNDSP4
TCBRSV92 EQU   TCBNDSP4
TCBRSV91 EQU   TCBNDSP4
TCBRSV90 EQU   TCBNDSP4
TCBRSV89 EQU   TCBNDSP4
TCBRSV88 EQU   TCBNDSP4
TCBRSV87 EQU   TCBNDSP4
TCBRSV86 EQU   TCBNDSP4
TCBEXT1A EQU   TCBEXT1+1
TCBRSV32 EQU   TCBEXT1
TCBEXCPD EQU   TCB+192
TCBIOBRC EQU   TCB+188
TCBDDWTC EQU   TCB+186
TCBDDEXC EQU   TCB+184
TCBJSCBB EQU   TCBJSCB+1
@NM00094 EQU   TCBRECDE
TCBREC   EQU   TCBRECDE
TCBMDIDS EQU   TCB+176
TCBNDINT EQU   TCBNDSP3
TCBRSV27 EQU   TCBNDSP3
TCBRSV26 EQU   TCBNDSP3
TCBRSV25 EQU   TCBNDSP3
TCBRSV24 EQU   TCBNDSP3
TCBSRBND EQU   TCBNDSP3
TCBRV302 EQU   TCBNDSP3
TCBLJSND EQU   TCBNDSP3
TCBABE   EQU   TCBNDSP2
TCBDSS   EQU   TCBNDSP2
TCBOWAIT EQU   TCBNDSP2
TCBIWAIT EQU   TCBNDSP2
TCBNDTS  EQU   TCBNDSP2
TCBNDSVC EQU   TCBNDSP2
TCBSTPP  EQU   TCBNDSP2
TCBABD   EQU   TCBNDSP2
TCBRSV22 EQU   TCBNDSP1
TCBPIEND EQU   TCBNDSP1
TCBTPSP  EQU   TCBNDSP1
TCBDDRND EQU   TCBNDSP1
TCBRSPND EQU   TCBNDSP1
TCBRSTND EQU   TCBNDSP1
TCBDARPN EQU   TCBNDSP1
TCBDARTN EQU   TCBNDSP1
TCBNDSP0 EQU   TCBNDSP
TCBUSER  EQU   TCB+168
TCBTCTB  EQU   TCBTCT+1
TCBRSV9C EQU   TCBTCTGF
TCBRSV9B EQU   TCBTCTGF
TCBRSV9A EQU   TCBTCTGF
TCBRSV99 EQU   TCBTCTGF
TCBRSV98 EQU   TCBTCTGF
TCBRSV97 EQU   TCBTCTGF
TCBRSV20 EQU   TCBTCTGF
TCBSMFGF EQU   TCBTCTGF
TCBSTABB EQU   TCBSTAB+1
TCBSTCUR EQU   TCBNSTAE
TCBRV301 EQU   TCBNSTAE
TCBSYNCH EQU   TCBNSTAE
TCBHALT  EQU   TCBNSTAE
TCBPPSUP EQU   TCBNSTAE
TCB33E   EQU   TCBNSTAE
TCBQUIES EQU   TCBNSTAE
TCBSTABE EQU   TCBNSTAE
TCBAQE   EQU   TCB+156
TCBPQE   EQU   TCB+152
TCBTSDP  EQU   TCB+151
TCBTSLP  EQU   TCB+150
TCBSTPCT EQU   TCB+149
TCBCPUBN EQU   TCBTSFLG
TCBDYDSP EQU   TCBTSFLG
TCBRSV18 EQU   TCBTSFLG
TCBRSV17 EQU   TCBTSFLG
TCBTIOTG EQU   TCBTSFLG
TCBATT   EQU   TCBTSFLG
TCBSTPPR EQU   TCBTSFLG
TCBRV300 EQU   TCBTSTSK
TCBECB   EQU   TCB+144
TCBIQE   EQU   TCB+140
TCBLTC   EQU   TCB+136
TCBOTC   EQU   TCB+132
TCBNTC   EQU   TCB+128
TCBJSTCA EQU   TCBJSTCB+1
TCBRSV16 EQU   TCBJSTCB
TCBTQET  EQU   TCBTME
TCBTCB   EQU   TCB+116
TCBFSAB  EQU   TCBFSA+1
TCBQEL   EQU   TCBFSA
TCBGRS6  EQU   TCBGRS+24
TCBGRS5  EQU   TCBGRS+20
TCBGRS4  EQU   TCBGRS+16
TCBGRS3  EQU   TCBGRS+12
TCBGRS2  EQU   TCBGRS+8
TCBGRS1  EQU   TCBGRS+4
TCBGRS0  EQU   TCBGRS
TCBJPQB  EQU   TCBJPQ+1
TCBRSV15 EQU   TCBPURGE
TCBRSV14 EQU   TCBPURGE
TCBRSV13 EQU   TCBPURGE
TCBRSV12 EQU   TCBPURGE
TCBRSV11 EQU   TCBPURGE
TCBRSV10 EQU   TCBPURGE
TCBRSV09 EQU   TCBPURGE
TCBJPQF  EQU   TCBPURGE
TCBJLB   EQU   TCB+40
TCBLLS   EQU   TCB+36
TCBDSP   EQU   TCB+35
TCBLMP   EQU   TCB+34
TCBPNDSP EQU   TCBFLGS5
TCBFCD1  EQU   TCBFLGS5
TCBSTP   EQU   TCBFLGS5
TCBSYS   EQU   TCBFLGS5
TCBANDSP EQU   TCBFLGS5
TCBPAGE  EQU   TCBFLGS5
TCBUXNDF EQU   TCBABWF
TCBFC    EQU   TCBFLGS5
TCBONDSP EQU   TCBFLGS4
TCBMPCND EQU   TCBFLGS4
TCBMPCVQ EQU   TCBFLGS4
TCBUXNDV EQU   TCBFLGS4
TCBHNDSP EQU   TCBFLGS4
TCBRQENA EQU   TCBFLGS4
TCBSER   EQU   TCBFLGS4
TCBNDUMP EQU   TCBFLGS4
TCBDWSTA EQU   TCBFLGS3
TCBRSV08 EQU   TCBFLGS3
TCBRSV07 EQU   TCBFLGS3
TCBRSV06 EQU   TCBFLGS3
TCBABGM  EQU   TCBFLGS3
TCBABTRM EQU   TCBFLGS3
TCBADINP EQU   TCBFLGS3
TCBFSM   EQU   TCBFLGS3
TCBFTS   EQU   TCBFLGS2
TCBFETXR EQU   TCBFLGS2
TCBFDSOP EQU   TCBFLGS2
TCBFJMC  EQU   TCBFLGS2
TCBFSMC  EQU   TCBFLGS2
TCBFABOP EQU   TCBFLGS2
TCBFSTI  EQU   TCBFLGS2
TCBFOINP EQU   TCBFLGS2
TCBFX    EQU   TCBFLGS1
TCBFS    EQU   TCBFLGS1
TCBFT    EQU   TCBFLGS1
TCBPDUMP EQU   TCBFLGS1
TCBRSV04 EQU   TCBFLGS1
TCBFERA  EQU   TCBFLGS1
TCBFE    EQU   TCBFLGS1
TCBFA    EQU   TCBFLGS1
TCBZERO  EQU   TCBPKF
TCBFLAG  EQU   TCBPKF
TCBMSSB  EQU   TCBMSS+1
TCBRSV03 EQU   TCBMSS
TCBTRNB  EQU   TCBTRN+1
TCBRSV02 EQU   TCBABF
TCBOLTEP EQU   TCBABF
TCBTCP   EQU   TCBABF
TCBTCPP  EQU   TCBABF
TCBRSV01 EQU   TCBABF
TCBGRPH  EQU   TCBABF
TCBNOCHK EQU   TCBABF
TCBMOD91 EQU   TCBABF
TCBCMPC  EQU   TCBCMP+1
TCBRV318 EQU   TCBCMSG
TCBRV317 EQU   TCBCIND
TCBRV316 EQU   TCBCWTO
TCBCASID EQU   TCBCDBL
TCBNOCC  EQU   TCBSTCC
TCBDMPO  EQU   TCBCPP
TCBCSTEP EQU   TCBCMPF
TCBCREQ  EQU   TCBCMPF
TCBTIO   EQU   TCB+12
TCBDEB   EQU   TCB+8
TCBPIEA  EQU   TCBPIE+1
TCBPM    EQU   TCBPMASK
@NM00093 EQU   TCBPMASK
TCBRBP   EQU   TCB
TCBFRS6  EQU   TCBFRS+24
TCBFRS4  EQU   TCBFRS+16
TCBFRS2  EQU   TCBFRS+8
TCBFRS0  EQU   TCBFRS
ASCBPTR  EQU   TCBASCB+12
ASCBNEXT EQU   TCBASCB+8
TCBNEXT  EQU   TCBASCB
CHARSV16 EQU   CHSHORT+100
CHARSV15 EQU   CHSHORT+96
CHJSCBVS EQU   CHSHORT+92
CHUSCVS  EQU   CHSHORT+88
@NM00091 EQU   CHSHORT+84
@NM00090 EQU   CHSHORT+80
CHSQA    EQU   CHSHORT+44
CHQPA    EQU   CHSHORT+8
CHJCL    EQU   CHSHORT+4
CHSPC    EQU   CHSHORT
CHSPB    EQU   CHSTEP+4
CHTCB    EQU   CHSTEP+1
CHARSV23 EQU   CHSWT
CHARSV22 EQU   CHSWT
CHARSV21 EQU   CHSWT
CHAC     EQU   CHSWT
CHPSF    EQU   CHSWT
CHPSD    EQU   CHSWT
CHJCT    EQU   CHSWT
CHARSV20 EQU   CHSWT
CHECB    EQU   CHASM+16
CHARSV18 EQU   CHRGNSZ+1
CHRPRTY  EQU   CHRGNSZ
@NM00089 EQU   CHCIBP
CHEND    EQU   CHCIBP
CHECBP   EQU   CHASM
CHDER    EQU   CHPROCSN+4
CHARSV10 EQU   CHACT1
CHARSV09 EQU   CHACT1
CHARSV08 EQU   CHACT1
CHARSV07 EQU   CHACT1
CHARSV06 EQU   CHACT1
CHARSV05 EQU   CHACT1
CHARSV04 EQU   CHACT1
CHRDWTR  EQU   CHACT1
CHARSV30 EQU   CHPROCSN+2
CHQID    EQU   CHPROCSN
CHASID   EQU   CHTJID
CHUCMP   EQU   CHAIN+29
CHCIBCTR EQU   CHAIN+27
CHUNIT   EQU   CHAIN+24
CHPARM   EQU   CHKEY
CHIFY    EQU   CHACT
CHAIFX   EQU   CHACT
CHCLD    EQU   CHACT
CHCL     EQU   CHACT
CHDSI    EQU   CHACT
CHDISC   EQU   CHACT
CHTERM   EQU   CHACT
CHSWAP   EQU   CHACT
CHABTERM EQU   CHSTS
CHDL     EQU   CHSTS
CHAD     EQU   CHSTS
CHQSPC   EQU   CHSTS
CHSOUT   EQU   CHSTS
CHSYS    EQU   CHSTS
CHAP     EQU   CHSTS
CHSZE    EQU   CHFLG+1
MSSPARE  EQU   BASES01+48
MSUCBAL  EQU   BASES01+44
MSUCBPR  EQU   BASES01+40
MSBOBECB EQU   BASES01+36
MSSJQ    EQU   BASES01+32
MSECB    EQU   BASES01+28
MSPBP    EQU   BASES01+24
MSERM    EQU   BASES01+22
MSPASS   EQU   BASES01+14
MSVRB    EQU   BASES01+6
MSQHR    EQU   MSFHF
@NM00088 EQU   MSFHF
MSPSDT   EQU   MSFHF
MSREPLYB EQU   MSFHF
MSFAX    EQU   MSFHF
MSTTT    EQU   MSFHF
MSCSD    EQU   MSFHF
MSNMF    EQU   MSFHF
MSJNF    EQU   MSSSA
MSYOUT   EQU   MSNWP
MSNRP    EQU   MSSSA
MSSRDR   EQU   MSREOF
MSWRLOG  EQU   MSSSA
MSNUPSW  EQU   MSSSA
MSWRPEN  EQU   MSSSA
MSSSSIPL EQU   MSINLSW
MSSUM    EQU   MSECBFL
MSMCR    EQU   MSECBFL
MSYSOUT  EQU   MSECBFL
MSYSIN   EQU   MSECBFL
MSATTN   EQU   MSECBFL
MSWTL    EQU   MSECBFL
MSWTO    EQU   MSECBFL
MSEXT    EQU   MSECBFL
MSCCS    EQU   MSPFG
MSBSP    EQU   MSPFG
MSSYT    EQU   MSPFG
MSSYN    EQU   MSPFG
MSICR    EQU   MSPFG
MSCMC    EQU   MSPFG
MSPNB    EQU   MSPFG
MSDATE   EQU   MSPFG
@NM00087 EQU   MSBTN
MSTN     EQU   MSBTN
@NM00086 EQU   MSBTN
@NM00085 EQU   MSBTN
MSSO     EQU   MSBTN
MSROLFLG EQU   MSBTN
MSCANFLG EQU   MSBTN
MSCONFLG EQU   MSBTN
MSPNIP   EQU   MSNTAL
MSQNIP   EQU   MSNTAL
MSCURE34 EQU   MSNTAL
@NM00084 EQU   MSNTAL
@NM00083 EQU   MSNTAL
@NM00082 EQU   MSNTAL
@NM00081 EQU   MSNTAL
MSNIP    EQU   MSNTAL
@NM00080 EQU   MS1BASEX+40
@NM00079 EQU   MS1BASEX+20
@NM00078 EQU   MS1BASEX
@NM00077 EQU   BASE+128
MSLGJSCB EQU   BASE+124
@NM00076 EQU   MSSTRTSW
MSSTRTP  EQU   MSSTRTSW
MSSTRTW  EQU   MSSTRTSW
@NM00075 EQU   MSWTRSW
MSWTRP   EQU   MSWTRSW
MSWTRW   EQU   MSWTRSW
@NM00074 EQU   MSWLOGSW
MSWLOGP  EQU   MSWLOGSW
MSWLOGW  EQU   MSWLOGSW
@NM00073 EQU   MSCLOSSW
MSCLOSP  EQU   MSCLOSSW
MSCLOSW  EQU   MSCLOSSW
MSLOGLMT EQU   @NM00072+1
MSLOGCLS EQU   @NM00072
BAASCB   EQU   BASE+100
MSSMFPRM EQU   BASE+96
MSCOMMND EQU   BASE+92
BASP12   EQU   BASE+90
BASTCNT  EQU   BASE+88
BASESCT  EQU   BASE+86
BAJNCNT  EQU   BASE+84
BASUBECB EQU   BASE+80
BALOGCOM EQU   BASE+76
BADACNT  EQU   BASE+74
BATACNT  EQU   BASE+72
BAJBNR   EQU   BASE+64
BASP11   EQU   BASE+62
BALCCNT  EQU   BASE+61
BADUMPID EQU   BASE+60
BABCMAX  EQU   BASE+58
BAMONTR2 EQU   BASE+57
@NM00071 EQU   BAMONITR
BAMACTVE EQU   BAMONITR
@NM00070 EQU   BAMONITR
@NM00069 EQU   BAMONITR
@NM00068 EQU   BAMONITR
@NM00067 EQU   BAMONITR
BASPACE  EQU   BAMONITR
BADSN    EQU   BAMONITR
BADSO    EQU   BASE+52
BALOGECB EQU   BASE+48
@NM00066 EQU   BASPBYTE
@NM00065 EQU   BASPBYTE
@NM00064 EQU   BASPBYTE
@NM00063 EQU   BASPBYTE
@NM00062 EQU   BASPBYTE
BAMASCH  EQU   BASPBYTE
BATRACE  EQU   BASPBYTE
BAMSSTAR EQU   BASPBYTE
@NM00061 EQU   MSLOGST
@NM00060 EQU   MSLOGST
MSLOGSTA EQU   MSLOGST
MSLOGIPL EQU   MSLOGST
MSLOGDAR EQU   MSLOGST
MSLOGCOM EQU   MSLOGST
MSLOGTHD EQU   MSLOGST
MSLOGENQ EQU   MSLOGST
BAMIPAR2 EQU   BASE+44
BAMINPAR EQU   BASE+42
BAPKES   EQU   BASE+40
BAICTR   EQU   BASE+38
@NM00059 EQU   BASE+37
BADSET   EQU   BARSW
BANOSET  EQU   BARSW
BAMIDNT  EQU   BARSW
BAHR     EQU   BARSW
BAVU     EQU   BARSW
BAINTSET EQU   BARSW
MSTODWTO EQU   BARSW
BAIN     EQU   BARSW
BACV     EQU   BASE+32
@NM00058 EQU   BALOG
@NM00057 EQU   BALOG
@NM00056 EQU   BALOG
@NM00055 EQU   BALOG
@NM00054 EQU   BALOG
@NM00053 EQU   BALOG
@NM00052 EQU   BALOG
BALOGINT EQU   BALOG
MSLOGSVC EQU   BALGSTAT
BAPRC    EQU   BASE+20
BAQ      EQU   BASE+16
BAIPLCC  EQU   @NM00050+2
@NM00051 EQU   @NM00050
BAIPL    EQU   BASE+12
BALAD    EQU   BASE+8
BATRM    EQU   BASE+4
UCMRCTA  EQU   UCMRCT+1
UCMRSV31 EQU   UCMSDS5
UCMSDS5G EQU   UCMSDS5
UCMSDS5F EQU   UCMSDS5
UCMRSV30 EQU   UCMSDS5
UCMRSV29 EQU   UCMSDS5
UCMSDS5C EQU   UCMSDS5
UCMSDS5B EQU   UCMSDS5
UCMSDS5A EQU   UCMSDS5
UCMMLAST EQU   UCMLIST+64
UCMVHRSN EQU   UCMDEVC
UCMDEVG  EQU   UCMDEVC
UCMDEVF  EQU   UCMDEVC
UCMDEVE  EQU   UCMDEVC
UCMDEVD  EQU   UCMDEVC
UCMDEVCC EQU   UCMDEVC
UCMDEVB  EQU   UCMDEVC
UCMDEVA  EQU   UCMDEVC
UCMXOR   EQU   UCMLIST+62
UCMMSG2  EQU   UCMMSG+1
UCMRSV27 EQU   UCMMSG1
UCMRSV26 EQU   UCMMSG1
UCMMSGF  EQU   UCMMSG1
UCMMSGE  EQU   UCMMSG1
UCMMSGD  EQU   UCMMSG1
UCMMSGC  EQU   UCMMSG1
UCMMSGB  EQU   UCMMSG1
UCMMSGA  EQU   UCMMSG1
UCMCOMPC EQU   UCMLIST+56
UCMWLAST EQU   UCMLIST+52
UCMOAOEN EQU   UCMLIST+48
UCMALTEN EQU   UCMLIST+44
UCMRV007 EQU   UCMDISP2
UCMRV006 EQU   UCMDISP2
UCMRV005 EQU   UCMDISP2
UCMRV004 EQU   UCMDISP2
UCMRV003 EQU   UCMDISP2
UCMDISPK EQU   UCMDISP2
UCMDISPJ EQU   UCMDISP2
UCMDISPI EQU   UCMDISP2
UCMDISPH EQU   UCMDISP1
UCMDISPG EQU   UCMDISP1
UCMDISPF EQU   UCMDISP1
UCMDISPE EQU   UCMDISP1
UCMDISPD EQU   UCMDISP1
UCMDISPC EQU   UCMDISP1
UCMDISPB EQU   UCMDISP1
UCMDISPA EQU   UCMDISP1
UCMAUTHB EQU   UCMAUTH+1
UCMRSV23 EQU   UCMAUTHA
UCMRSV22 EQU   UCMAUTHA
UCMRSV21 EQU   UCMAUTHA
UCMRSV20 EQU   UCMAUTHA
UCMRSV19 EQU   UCMAUTHA
UCMAUTH3 EQU   UCMAUTHA
UCMAUTH2 EQU   UCMAUTHA
UCMAUTH1 EQU   UCMAUTHA
UCMOUTQ  EQU   UCMLIST+36
UCMRSV18 EQU   UCMLIST+34
UCMRTCD  EQU   UCMLIST+32
@NM00049 EQU   UCMXA+1
UCMRSV17 EQU   UCMATR
UCMRSV16 EQU   UCMATR
UCMAT04  EQU   UCMATR
UCMLF    EQU   UCMATR
UCMUF    EQU   UCMATR
UCMXF    EQU   UCMATR
UCMIF    EQU   UCMATR
UCMOF    EQU   UCMATR
UCMTC    EQU   UCMSTS
UCMTD    EQU   UCMSTS
UCMTB    EQU   UCMSTS
UCMTA    EQU   UCMSTS
UCMCF    EQU   UCMSTS
UCMBF    EQU   UCMSTS
UCMPF    EQU   UCMSTS
UCMAF    EQU   UCMSTS
UCMNAME  EQU   UCMLIST+16
UCMUCB   EQU   UCMLIST+12
UCMDCB   EQU   UCMLIST+8
UCMSBR   EQU   UCMLIST+4
UCMTPSAV EQU   UCMEXIT+208
UCMXTSAV EQU   UCMEXIT+136
UCMDESCD EQU   UCMEXIT+132
UCMROUTC EQU   UCMEXIT+128
UCMMSTXT EQU   UCMEXIT
UCMDECBA EQU   UCMEIL+20
UCMOECBA EQU   UCMEIL+16
UCMAECBA EQU   UCMEIL+12
UCMXECBA EQU   UCMEIL+8
UCMNIPTR EQU   UCMEIL+4
UCMRSV15 EQU   UCMEIL+3
UCMRTCT  EQU   UCMEIL+2
UCMRPYL  EQU   UCMEIL+1
@NM00048 EQU   UCMEIL
UCMRSV60 EQU   UCM+302
UCMRSV59 EQU   UCMRSV51
UCMRSV48 EQU   UCMRSV42
UCMRSV47 EQU   UCMRSV42
UCMRSV46 EQU   UCMRSV42
UCMRSV45 EQU   UCMRSV42
UCMRSV44 EQU   UCMRSV42
UCMRSV43 EQU   UCMRSV42
UCMRSV41 EQU   UCM+296
UCMWAKUP EQU   UCM+292
UCMFRRAD EQU   UCM+288
UCMSWCH  EQU   UCM+284
UCMASCB  EQU   UCM+280
UCMWQECP EQU   UCM+276
UCMORECP EQU   UCM+272
UCMOECBT EQU   UCM+268
UCMOECBH EQU   UCM+264
UCMWECBT EQU   UCM+260
UCMWECBH EQU   UCM+256
UCMMBEND EQU   UCM+252
UCMCTID  EQU   UCM+250
UCMRSV61 EQU   UCM+248
UCMRP2AD EQU   UCM+244
UCMCRAAD EQU   UCM+240
UCMWQLM1 EQU   UCM+238
UCMRV001 EQU   UCM+237
UCMRQLM1 EQU   UCM+236
UCMMBPTR EQU   UCM+232
UCMMQNXT EQU   UCM+228
UCMMQEND EQU   UCM+224
UCMMQPTR EQU   UCM+220
UCMTRECB EQU   UCM+216
UCMMNECB EQU   UCM+212
UCMMNTR  EQU   UCM+208
UCMR9SV  EQU   UCM+204
UCMSAVE4 EQU   UCM+140
UCMSAVE3 EQU   UCM+84
UCMVEL   EQU   UCMVDATA+8
UCMINCR  EQU   UCM+71
UCMMODEL EQU   UCM+70
UCMCORE  EQU   UCM+69
UCMFIX   EQU   UCMMODE
UCMMCS   EQU   UCMMODE
UCMOGCE  EQU   UCMMODE
UCMAMFA  EQU   UCMMODE
UCMRSV14 EQU   UCMMODE
UCMTPUTA EQU   UCMMODE
UCMNOCON EQU   UCMMODE
UCMRSV11 EQU   UCMMODE
UCMPXA   EQU   UCM+64
UCMWQEND EQU   UCM+60
UCMWQNR  EQU   UCM+58
UCMRQNR  EQU   UCM+56
UCMWQECB EQU   UCM+52
UCMRQECB EQU   UCM+48
UCMWQLM  EQU   UCM+46
UCMRQLM  EQU   UCM+45
@NM00047 EQU   UCMRPYI
UCMRPYQ  EQU   UCM+28
UCMWTOQ  EQU   UCM+24
UCMLSTP  EQU   UCM+20
UCMARECB EQU   UCM+16
UCMLECB  EQU   UCMDECB
UCMOECB  EQU   UCM+8
UCMAECB  EQU   UCM+4
UCMXECB  EQU   UCM
UCMGMCNT EQU   UCMPRFX+158
UCMSDS2  EQU   UCMPRFX+157
UCMRSV09 EQU   UCMSDS1
UCMRSV08 EQU   UCMSDS1
UCMRSV07 EQU   UCMSDS1
UCMRSV06 EQU   UCMSDS1
UCMRSV05 EQU   UCMSDS1
UCMRSV04 EQU   UCMSDS1
UCMSDS1B EQU   UCMSDS1
UCMSDS1A EQU   UCMSDS1
UCMDTINT EQU   UCMPRFX+152
UCMLOGAD EQU   UCMPRFX+148
UCMNPECB EQU   UCMPRFX+144
UCMTPPTR EQU   UCMPRFX+140
UCMDOMRT EQU   UCMPRFX+136
UCMRUTCK EQU   UCMPRFX+132
UCMQRTN  EQU   UCMPRFX+128
UCM6WD   EQU   UCMXSA+20
UCM5WD   EQU   UCMXSA+16
UCM4WD   EQU   UCMXSA+12
UCM3WD   EQU   UCMXSA+8
UCM2WD   EQU   UCMXSA+4
UCM1WD   EQU   UCMXSA
UCMRSV03 EQU   UCMPRFX+102
UCMHRDRT EQU   UCMPRFX+100
UCMUEXIT EQU   UCMPRFX+97
UCMXCT   EQU   UCMPRFX+96
UCMHCUCM EQU   UCMPRFX+92
UCMCMID  EQU   UCMPRFX+88
UCMOWTOR EQU   UCMPRFX+86
UCMRSV02 EQU   UCMSFLG2
UCMSYSO  EQU   UCMSFLG2
UCMSYSN  EQU   UCMSFLG2
UCMSYSM  EQU   UCMSFLG2
UCMSYSL  EQU   UCMSFLG2
UCMSYSK  EQU   UCMSFLG2
UCMSYSJ  EQU   UCMSFLG2
UCMSYSI  EQU   UCMSFLG2
UCMRSV35 EQU   UCMSFLG1
UCMSYSG  EQU   UCMSFLG1
UCMSYSF  EQU   UCMSFLG1
UCMSYSE  EQU   UCMSFLG1
UCMSYSD  EQU   UCMSFLG1
UCMSYSC  EQU   UCMSFLG1
UCMSYSB  EQU   UCMSFLG1
UCMRSV01 EQU   UCMSFLG1
UCMWTOX  EQU   UCMPRFX+80
UCMDOME  EQU   UCMPRFX+76
UCMSVR0  EQU   UCMSAVE0+68
UCMSVQ0  EQU   UCMSAVE0+64
UCMSVP0  EQU   UCMSAVE0+60
UCMSVO0  EQU   UCMSAVE0+56
UCMSVN0  EQU   UCMSAVE0+52
UCMSVM0  EQU   UCMSAVE0+48
UCMSVL0  EQU   UCMSAVE0+44
UCMSVK0  EQU   UCMSAVE0+40
UCMSVJ0  EQU   UCMSAVE0+36
UCMSVI0  EQU   UCMSAVE0+32
UCMSVH0  EQU   UCMSAVE0+28
UCMSVG0  EQU   UCMSAVE0+24
UCMSVF0  EQU   UCMSAVE0+20
UCMSVE0  EQU   UCMSAVE0+16
UCMSVD0  EQU   UCMSAVE0+12
UCMSVC0  EQU   UCMSAVE0+8
UCMSVB0  EQU   UCMSAVE0+4
UCMSVA0  EQU   UCMSAVE0
UCMMCENT EQU   UCMPRFX
UCM2PAD  EQU   UCM2EXT+12
UCM2STAA EQU   UCM2STA+1
UCMRV008 EQU   UCM2SFLG
UCMRSV34 EQU   UCM2SFLG
UCMRSV33 EQU   UCM2SFLG
UCMRSV32 EQU   UCM2SFLG
UCM2DSTR EQU   UCM2SFLG
UCM2DTAK EQU   UCM2SFLG
UCM2SENT EQU   UCM2SFLG
UCM2SDWA EQU   UCM2SFLG
UCM2PST  EQU   UCM2EXT+4
UCM2RID  EQU   UCM2EXT+2
UCM2WID  EQU   UCM2EXT
CVTLEVL  EQU   CVTRELNO+2
CVTNUMB  EQU   CVTRELNO
CVTMDL   EQU   CVTFIX+250
@NM00046 EQU   CVTFIX+248
@NM00045 EQU   CVTFIX
CVTRV482 EQU   CVTXTNT2+128
CVTRV481 EQU   CVTXTNT2+124
CVTRV480 EQU   CVTXTNT2+120
CVTRV479 EQU   CVTXTNT2+118
CVTRV478 EQU   CVTXTNT2+117
CVTRV477 EQU   CVTXTNT2+116
CVTRV476 EQU   CVTXTNT2+115
CVTRV475 EQU   CVTXTNT2+114
CVTRV474 EQU   CVTRV466
CVTRV473 EQU   CVTRV466
CVTRV472 EQU   CVTRV466
CVTRV471 EQU   CVTRV466
CVTRV470 EQU   CVTRV466
CVTRV469 EQU   CVTRV466
CVTRV468 EQU   CVTRV466
CVTRV467 EQU   CVTRV466
CVTRV465 EQU   CVTRV457
CVTRV464 EQU   CVTRV457
CVTRV463 EQU   CVTRV457
CVTRV462 EQU   CVTRV457
CVTRV461 EQU   CVTRV457
CVTRV460 EQU   CVTRV457
CVTRV459 EQU   CVTRV457
CVTRV458 EQU   CVTRV457
CVTRV456 EQU   CVTXTNT2+108
CVTRV455 EQU   CVTXTNT2+104
CVTRV454 EQU   CVTXTNT2+100
CVTRV453 EQU   CVTXTNT2+96
CVTRV452 EQU   CVTXTNT2+94
CVTRV451 EQU   CVTXTNT2+92
CVTRV450 EQU   CVTXTNT2+90
CVTRV449 EQU   CVTXTNT2+88
CVTRV448 EQU   CVTXTNT2+87
CVTRV447 EQU   CVTXTNT2+86
CVTRV446 EQU   CVTRV438
CVTRV445 EQU   CVTRV438
CVTRV444 EQU   CVTRV438
CVTRV443 EQU   CVTRV438
CVTRV442 EQU   CVTRV438
CVTRV441 EQU   CVTRV438
CVTRV440 EQU   CVTRV438
CVTRV439 EQU   CVTRV438
CVTRV437 EQU   CVTRV429
CVTRV436 EQU   CVTRV429
CVTRV435 EQU   CVTRV429
CVTRV434 EQU   CVTRV429
CVTRV433 EQU   CVTRV429
CVTRV432 EQU   CVTRV429
CVTRV431 EQU   CVTRV429
CVTRV430 EQU   CVTRV429
CVTRV428 EQU   CVTXTNT2+80
CVTRV427 EQU   CVTXTNT2+76
CVTRV426 EQU   CVTXTNT2+72
CVTRV425 EQU   CVTXTNT2+68
CVTATACT EQU   CVTATCVT
CVTRV423 EQU   CVTXTNT2+62
CVTRV422 EQU   CVTXTNT2+60
CVTRV421 EQU   CVTXTNT2+58
CVTRV420 EQU   CVTXTNT2+56
CVTRV419 EQU   CVTXTNT2+55
CVTRV418 EQU   CVTXTNT2+54
CVTRV417 EQU   CVTRV409
CVTRV416 EQU   CVTRV409
CVTRV415 EQU   CVTRV409
CVTRV414 EQU   CVTRV409
CVTRV413 EQU   CVTRV409
CVTRV412 EQU   CVTRV409
CVTRV411 EQU   CVTRV409
CVTRV410 EQU   CVTRV409
CVTRV408 EQU   CVTRV400
CVTRV407 EQU   CVTRV400
CVTRV406 EQU   CVTRV400
CVTRV405 EQU   CVTRV400
CVTRV404 EQU   CVTRV400
CVTRV403 EQU   CVTRV400
CVTRV402 EQU   CVTRV400
CVTRV401 EQU   CVTRV400
CVTICB   EQU   CVTXTNT2+48
CVTSKTA  EQU   CVTXTNT2+44
CVTRSV99 EQU   CVTXTNT2+40
CVTRSV98 EQU   CVTXTNT2+36
CVTRSV97 EQU   CVTXTNT2+34
CVTRSV96 EQU   CVTXTNT2+32
CVTOLTEP EQU   CVTXTNT2+28
CVTQIDA  EQU   CVTQID+1
CVTRSV95 EQU   CVTQID
CVTRSV94 EQU   CVTXTNT2+20
CVTRSV93 EQU   CVTXTNT2+16
CVTRSV92 EQU   CVTXTNT2+12
CVTDEBVR EQU   CVTXTNT2+8
CVTRSV91 EQU   CVTXTNT2+6
CVTRSV9H EQU   CVTFLGBT
CVTRSV9G EQU   CVTFLGBT
CVTRSV9F EQU   CVTFLGBT
CVTRSV9E EQU   CVTFLGBT
CVTRSV9D EQU   CVTFLGBT
CVTRSV9C EQU   CVTFLGBT
CVTVME   EQU   CVTFLGBT
CVTNPE   EQU   CVTFLGBT
CVTNUCLS EQU   CVTXTNT2+4
CVTDSSVA EQU   CVTDSSV+1
CVTRSV89 EQU   CVTDSSV
CVTRSV88 EQU   CVTXTNT1+8
CVTRSV87 EQU   CVTXTNT1+4
CVTFACHN EQU   CVTXTNT1
CVTRV488 EQU   CVTMAP+412
CVTRV487 EQU   CVTMAP+408
CVTRV486 EQU   CVTMAP+404
CVTRV485 EQU   CVTMAP+400
CVTACTAP EQU   CVTMAP+396
CVTAUTH  EQU   CVTMAP+392
CVTATMCA EQU   CVTATMCT+1
CVTATMST EQU   CVTATMCT
CVTRSV61 EQU   CVTMAP+384
CVTVOLT1 EQU   CVTVOLM1+1
CVTVOLI1 EQU   CVTVOLF1
CVTSTOA  EQU   CVTMAP+376
CVTRSV58 EQU   CVTMAP+374
CVTRSV57 EQU   CVTMAP+372
CVTDDCE  EQU   CVTMAP+368
CVTPNWFR EQU   CVTMAP+364
CVTSMF   EQU   CVTMAP+360
CVTSULK  EQU   CVTMAP+358
CVTSLKO  EQU   CVTSYSK
CVTSLKP  EQU   CVTSYSK
CVTSLKQ  EQU   CVTSYSK
CVTSLKR  EQU   CVTSYSK
CVTRSV56 EQU   CVTSYSK
CVTRSV55 EQU   CVTSYSK
CVTRSV54 EQU   CVTSYSK
CVTRSV53 EQU   CVTSYSK
CVTRSV52 EQU   CVTA1F1
CVTRSV51 EQU   CVTA1F1
CVTRSV50 EQU   CVTA1F1
CVTRSV49 EQU   CVTA1F1
CVTRSV48 EQU   CVTA1F1
CVTRSV47 EQU   CVTA1F1
CVTSRSW  EQU   CVTA1F1
CVTPFSW  EQU   CVTA1F1
CVTPCVT  EQU   CVTMAP+352
CVTRSV46 EQU   CVTMAP+344
CVTRSV45 EQU   CVTMAP+340
CVTRSV44 EQU   CVTMAP+338
CVTRSV43 EQU   CVTMAP+336
CVTHJESA EQU   CVTHJES+1
CVTRSV42 EQU   CVTHJES
CVTEXT2A EQU   CVTEXT2+1
CVTRSV41 EQU   CVTEXT2
CVTAPFA  EQU   CVTAPF+1
CVTRSV40 EQU   CVTAPF
CVTRV518 EQU   CVTINTLA
CVTRV517 EQU   CVTERPV
CVTEORM  EQU   CVTMAP+312
CVTMCHPR EQU   CVTMAP+308
CVTTZ    EQU   CVTMAP+304
CVTJEPS  EQU   CVTMAP+300
CVTJESCT EQU   CVTMAP+296
CVTMODE  EQU   CVTMAP+292
CVTPTRV  EQU   CVTMAP+288
CVTREAL  EQU   CVTMAP+284
CVTRSV39 EQU   CVTMAP+280
CVTRSV38 EQU   CVTMAP+276
CVTDMSRA EQU   CVTDMSR+1
CVTRSV37 EQU   CVTDMSR
CVTQMSGA EQU   CVTQMSG+1
CVTRSV36 EQU   CVTQMSG
CVTAMFF  EQU   CVTMAP+264
CVTPURGA EQU   CVTPURG+1
CVTRSV35 EQU   CVTPURG
CVTCBSP  EQU   CVTMAP+256
CVTATERA EQU   CVTATER+1
CVTSYST  EQU   CVTATER
CVTVOLT2 EQU   CVTTAT
CVTVOLI2 EQU   CVTVOLF2
CVTAQAVB EQU   CVTAQAVT+1
CVTRSV34 EQU   CVTTCMFG
CVTRSV33 EQU   CVTTCMFG
CVTRSV32 EQU   CVTTCMFG
CVTRSV31 EQU   CVTTCMFG
CVTRSV30 EQU   CVTTCMFG
CVTRSV29 EQU   CVTTCMFG
CVTRSV28 EQU   CVTTCMFG
CVTTCRDY EQU   CVTTCMFG
CVTGTFA  EQU   CVTGTF+1
CVTRSV27 EQU   CVTGTFST
CVTRNIO  EQU   CVTGTFST
CVTUSR   EQU   CVTGTFST
CVTRV318 EQU   CVTFORM
CVTRV317 EQU   CVTTMODE
CVTRV316 EQU   CVTSTATE
CVTRV315 EQU   CVTGTFS
CVTGTFAV EQU   CVTGTFS
CVT0SCR1 EQU   CVTMAP+232
CVTRV515 EQU   CVTMAP+228
CVTRMS   EQU   CVTMAP+224
CVTPATCH EQU   CVTMAP+220
CVTTSCE  EQU   CVTMAP+216
CVTLNKSC EQU   CVTMAP+214
CVTQABST EQU   CVTMAP+212
CVTMDLDS EQU   CVTMAP+208
CVTUSER  EQU   CVTMAP+204
CVTABEND EQU   CVTMAP+200
CVTSMCA  EQU   CVTMAP+196
CVTRSV18 EQU   CVTMAP+192
CVTQLPAQ EQU   CVTMAP+188
CVTQCDSR EQU   CVTMAP+184
CVTRSV17 EQU   CVTOPTB
CVTRSV16 EQU   CVTOPTB
CVTFP    EQU   CVTOPTB
CVTAPTHR EQU   CVTOPTB
CVTNLOG  EQU   CVTOPTB
CVTTOD   EQU   CVTOPTB
CVTCTIMS EQU   CVTOPTB
CVTPROT  EQU   CVTOPTB
CVTXPFP  EQU   CVTOPTA
CVTASCII EQU   CVTOPTA
CVTRSV13 EQU   CVTOPTA
CVTRSV12 EQU   CVTOPTA
CVTNIP   EQU   CVTOPTA
CVTDDR   EQU   CVTOPTA
CVTAPR   EQU   CVTOPTA
CVTCCH   EQU   CVTOPTA
CVTSNCTR EQU   CVTMAP+180
CVTQMWR  EQU   CVTMAP+176
CVTQOCR  EQU   CVTMAP+172
CVT1EF00 EQU   CVTMAP+168
CVTMZ00  EQU   CVTMAP+164
CVTHEAD  EQU   CVTMAP+160
CVTRSV11 EQU   CVTMAP+156
CVT0PT01 EQU   CVTMAP+152
CVTRV516 EQU   CVTIERLC
CVTILCH  EQU   CVTMAP+140
CVT0DS   EQU   CVTMAP+136
CVTFBOSV EQU   CVTMAP+132
CVTNUCB  EQU   CVTMAP+128
CVTIXAVL EQU   CVTMAP+124
CVTIOQET EQU   CVTMAP+120
CVTDCBA  EQU   CVTMAP+117
CVTMVS2  EQU   CVTDCB
CVT6DAT  EQU   CVTDCB
CVT4MPS  EQU   CVTDCB
CVTRSV09 EQU   CVTDCB
CVT4MS1  EQU   CVTDCB
CVT2SPS  EQU   CVTDCB
CVT1SSS  EQU   CVTDCB
CVTRSV08 EQU   CVTDCB
CVTSTB   EQU   CVTMAP+112
CVTQTD00 EQU   CVTMAP+108
CVTQTE00 EQU   CVTMAP+104
CVTSJQ   EQU   CVTMAP+96
CVTPBLDL EQU   CVTMAP+92
CVTRSV04 EQU   CVTFLGS1
CVTRSV03 EQU   CVTFLGS1
CVTRSV02 EQU   CVTFLGS1
CVTRSV01 EQU   CVTFLGS1
CVTDMPLK EQU   CVTFLGS1
CVTXITP  EQU   CVTMAP+68
CVTZDTAB EQU   CVTMAP+64
CVTMSLT  EQU   CVTMAP+60
CVTDATE  EQU   CVTMAP+56
CVTBTERM EQU   CVTMAP+52
CVTSYSAD EQU   CVTMAP+48
CVTXTLER EQU   CVTMAP+44
CVTILK2  EQU   CVTMAP+40
CVTILK1  EQU   CVTMAP+36
CVTPRLTV EQU   CVTMAP+32
CVTPCNVT EQU   CVTMAP+28
CVT0VL00 EQU   CVTMAP+24
CVTXAPG  EQU   CVTMAP+20
CVTBUF   EQU   CVTMAP+16
CVTJOB   EQU   CVTMAP+12
CVTLINK  EQU   CVTMAP+8
CVT0EF00 EQU   CVTMAP+4
CVT      EQU   CVTMAP
DCMACBND EQU   DCMACB+40
DCMAPAD  EQU   DCMACLR+27
@NM00044 EQU   DCMATRCK
@NM00043 EQU   DCMATRCK
DCMATTSL EQU   DCMATRCK
DCMATTS  EQU   DCMATRCK
@NM00042 EQU   DCMATRCK
@NM00041 EQU   DCMATRCK
DCMATJBL EQU   DCMATRCK
DCMATJOB EQU   DCMATRCK
@NM00040 EQU   DCMADFLG
@NM00039 EQU   DCMADFLG
@NM00038 EQU   DCMADFLG
@NM00037 EQU   DCMADFLG
@NM00036 EQU   DCMADFLG
DCMACSIB EQU   DCMADFLG
DCMADD   EQU   DCMADFLG
@NM00035 EQU   DCMAFLG2
@NM00034 EQU   DCMAFLG2
@NM00033 EQU   DCMAFLG2
@NM00032 EQU   DCMAFLG2
DCMAMJFR EQU   DCMAFLG2
DCMARCON EQU   DCMAFLG2
DCMAWCON EQU   DCMAFLG2
DCMALMIN EQU   DCMAFLG2
@NM00031 EQU   DCMAFLG1
@NM00030 EQU   DCMAFLG1
DCMABL   EQU   DCMAFLG1
DCMAFRPR EQU   DCMAFLG1
DCMADISP EQU   DCMAFLG1
@NM00029 EQU   DCMAFLG1
DCMAMT   EQU   DCMACLR+15
DCMATIME EQU   DCMACLR+11
DCMAMIN  EQU   DCMACLR+7
DCMAMJWQ EQU   DCMACLR+3
DCMAFR   EQU   DCMACLR+1
DCMAROW  EQU   DCMACLR
DCMATOP  EQU   DCMACB+8
DCMALN   EQU   DCMACB+6
DCMAGM   EQU   DCMASACB
DCMAUSE  EQU   DCMASACB
DCMPLNPR EQU   DCMPACB+2
DCMPLN   EQU   DCMPACB
DCMMSGSV EQU   DCMTSRT+56
@NM00028 EQU   DCMTSRT+52
DCMRQDEL EQU   DCMTSRT+48
@NM00027 EQU   DCMTSRT+46
@NM00026 EQU   DCMR3FLG
@NM00025 EQU   DCMR3FLG
DCMRXHMT EQU   DCMR3FLG
DCMR3PKA EQU   DCMR3FLG
DCMRXSCN EQU   DCMR3FLG
DCMCLPR  EQU   DCMR3FLG
DCMKVIP  EQU   DCMR3FLG
DCMSTSWT EQU   DCMR3FLG
@NM00024 EQU   DCMR2FLG
DCMRXTIM EQU   DCMR2FLG
@NM00023 EQU   DCMR2FLG
DCMRXDEL EQU   DCMR2FLG
DCMRXRLL EQU   DCMR2FLG
DCMRXTMR EQU   DCMR2FLG
DCMRXUNV EQU   DCMR2FLG
DCMRXSFL EQU   DCMR2FLG
DCMTMCTR EQU   DCMTSRT+42
DCMINTVL EQU   DCMTSRT+40
DCMADPFK EQU   DCMTSRT+36
DCMSUBAD EQU   DCMTSRT+32
DCMDOMKY EQU   DCMTSRT+30
DCMRMSAL EQU   DCMTSRT+28
DCMWLAST EQU   DCMTSRT+24
DCMADRMS EQU   DCMTSRT+21
DCMRMS   EQU   DCMTSRT+20
@NM00022 EQU   DCMDEVTY
@NM00021 EQU   DCMDEVTY
@NM00020 EQU   DCMDEVTY
@NM00019 EQU   DCMDEVTY
@NM00018 EQU   DCMDEVTY
@NM00017 EQU   DCMDEVTY
DCMTY50  EQU   DCMDEVTY
DCMTY60  EQU   DCMDEVTY
@NM00016 EQU   @NM00008
@NM00015 EQU   @NM00008
@NM00014 EQU   @NM00008
@NM00013 EQU   @NM00008
@NM00012 EQU   @NM00008
@NM00011 EQU   @NM00008
@NM00010 EQU   @NM00008
@NM00009 EQU   @NM00008
DCMTOPDS EQU   DCMTSRT+13
DCMTOPAR EQU   DCMTSRT+12
DCMADKP  EQU   DCMTSRT+8
DCMLEN   EQU   DCMTSRT+6
@NM00007 EQU   DCMRFLGS
@NM00006 EQU   DCMRFLGS
@NM00005 EQU   DCMRFLGS
DCMNIPP  EQU   DCMRFLGS
DCMDOM   EQU   DCMRFLGS
@NM00004 EQU   DCMRFLGS
@NM00003 EQU   DCMRFLGS
@NM00002 EQU   DCMRFLGS
@NM00001 EQU   DCMTSRT+4
DCMADTRN EQU   DCMTSRT
@RF00127 EQU   ALLDONE
@RF00749 EQU   @EL00001
@ENDDATA EQU   *
*        ***   IEECB800,(C'PLS1941',0603,74354)IX                CBTMOD
         TITLE 'CBT MODIFICATION MAINLINE CODE'
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
*                                                                     *
*       FUNCTION -     TO CREATE REVISED OUTPUT FOR D A,LIST,         *
*                      D JOBS,LIST, TR A,LIST, AND TR JOBS,LIST       *
*                                                                     *
*       ADDED INFORMATION -                                           *
*                                                                     *
*       ASID (NNNN)   ST - XXXYY    JT - MMM.SS.TH                    *
*                                                                     *
*       WHERE -                                                       *
*             XXX -                                                   *
*                 IN  -   IN CORE - SWAPPED IN                        *
*                 NSW -   NON-SWAPPABLE                               *
*                 PVL -   PRIVILEDGED (NSW EXCEPT FOR LONG WAIT)      *
*                 OUT -   SWAPPED OUT                                 *
*                 GOO -   IN PROCESS OF BEING SWAPPED OUT             *
*                 GOI -   IN PROCESS OF BEING SWAPPED IN              *
*                 GOB -   CURRENTLY CHANGING STATUS                   *
*                 ENQ -   CURRENTLY TEMPORARILY NSW DUE TO ENQ        *
*                 RT0 -   RTB=0                                       *
*             YY -                                                    *
*                 LW  -   LONG WAIT STATUS -  EXPLICIT OR IMPLICIT    *
*                 MW  -   LONG WAIT STATUS DETECTED BY MSO (MS6)      *
*                 CP  -   SIGNIFICANT CPU USER - SET BY IRARMCPM      *
*                 CT  -   CONTROL ALGORITHM URGES SWAPOUT             *
*                                                                     *
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
         EJECT
CBTSTAT  L     9,CVTPTR            CVT ADDR
         L     9,CVTASVT(0,9)      ASVT ADDR
         LH    2,CHASID(0,CSCBPTR) ASID
         SLL   2,2                 MULTIPLY BY 4
         L     2,524(2,9)          ASCB ADDR
         LR    5,14                SAVE RETURN ADDR
         LM    14,15,64(2)         LOAD ASCBEJST (CPU TIME)
         SRDL  14,12               SHIFT OUT UNUSED BITS
         LR    9,15                SAVE CPU TIME
         LM    14,15,200(2)        LOAD ASCBSRBT (SRB TIME)
         SRDL  14,12               SHIFT OUT UNUSED BITS
         AR    15,9                ADD CPU AND SRB TIME
         SR    14,14               CLEAR FOR DIVIDE
         D     14,=F'10000'        CONVERT TO HUNDREDTHS
         SR    14,14               CLEAR FOR DIVIDE
         D     14,=F'100'          CONVERT TO SECONDS
         MVC   CBTOTIME(10,WPLPTR),=X'402021204B40404B4040'
         CVD   14,LOCKSAVE+4       CONVERT HUNDREDTHS
         UNPK  CBTOHUNS(2,WPLPTR),LOCKSAVE+10(2)
         OI    CBTOHUNS+1(WPLPTR),X'F0'
         SR    14,14               CLEAR FOR DIVIDE
         D     14,=F'60'           CONVERT TO MINUTES
         CVD   14,LOCKSAVE+4       CONVERT SECONDS
         UNPK  CBTOSECS(2,WPLPTR),LOCKSAVE+10(2)
         OI    CBTOSECS+1(WPLPTR),X'F0'
         CVD   15,LOCKSAVE+4       CONVERT MINUTES
         ED    CBTOMINS(4,WPLPTR),LOCKSAVE+10
         L     15,80(0,2)          LOAD CPU TIME LIMIT
         LTR   15,15               ANY PRESENT
         BZ    CBTSTAT0            NO, BYPASS
         SR    14,14               CLEAR FOR DIVIDE
         SLDL  14,20               MULTIPLY 1 MEG
         D     14,=F'60000000'     CALC MINUTES
         LA    15,1(0,15)          ROUND UP
         CVD   15,LOCKSAVE+4       CONVERT MINUTES
         MVC   CBTOLIMT(6,WPLPTR),=X'402020202120'
         ED    CBTOLIMT(6,WPLPTR),LOCKSAVE+9
CBTSTAT0 LR    14,5                RELOAD RETURN ADDR
         L     2,144(0,2)          LOAD OUCB ADDR
         USING OUCB,2
         MVC   CBTOSTAT(5,WPLPTR),DEFAULT DEFAULT STATUS
         SPACE
CBTSTAT1 LA    5,CBTSTAB1          LOAD STATUS TABLE ADDR
         LA    7,3                 LOAD TABLE INCREMENT
         LA    9,CBTMVST1          LOAD MOVE ROUTINE ADDR
         TM    OUCBSFL,OUCBNSW
         BCR   1,9
         AR    5,7
         TM    OUCBSFL,OUCBPVL
         BCR   1,9
         AR    5,7
         TM    OUCBQFL,OUCBOUT
         BCR   1,9
         AR    5,7
         TM    OUCBQFL,OUCBGOO
         BCR   1,9
         AR    5,7
         TM    OUCBQFL,OUCBGOI
         BCR   1,9
         AR    5,7
         TM    OUCBQFL,OUCBGOB
         BCR   1,9
         AR    5,7
         TM    OUCBSFL,OUCBENQ
         BCR   1,9
         AR    5,7
         TM    OUCBAFL,OUCBRMA
         BCR   14,9
         EJECT
CBTSTAT2 CLC   CBTOSTAT(3,WPLPTR),=C'OUT'
         BNE   NOTOUT
         CLI   OUCBPFL,X'C0'
         BNH   NOTOUT
         CLI   OUCBPFL,C'R'
         BE    NOTOUT
         MVC   CBTOSTAT+3(1,WPLPTR),OUCBPFL
         B     CBTASID
NOTOUT   LA    5,CBTSTAB2          TABLE 2
         LA    7,2
         LA    9,CBTMVST2
         TM    OUCBEFL,OUCBMWT
         BCR   1,9
         AR    5,7
         TM    OUCBEFL,OUCBLWT
         BCR   1,9
         SR    5,7
         TM    OUCBAFL,OUCBNWT
         BCR   1,9
         LA    5,2(7,5)
         TM    OUCBAFL,OUCBCPL
         BCR   1,9
         AR    5,7
         TM    OUCBYFL,OUCBCTU
         BCR   1,9
         B     CBTASID
         SPACE 3
CBTMVST1 MVC   CBTOSTAT(3,WPLPTR),0(5)
         B     CBTSTAT2
         SPACE 3
CBTMVST2 MVC   CBTOSTAT+3(2,WPLPTR),0(5)
         B     CBTASID
         EJECT
CBTASID  LR    2,14                SAVE RETURN ADDR
         LA    5,CBTOASID(0,WPLPTR) LOAD OUTPUT ADDR
         LA    7,4                 LOAD OUTPUT LENGTH
         IC    15,CHASID(0,CSCBPTR) LOAD
         SLL   15,8                   ASID TO UPPER
         IC    15,CHASID+1(0,CSCBPTR)   HALFWORD OF
         SLL   15,16                        REG 15
         SPACE
CBTAS1   SR    14,14               CLEAR 14
         SLDL  14,4                SHIFT IN ONE DIGIT
         CH    14,=H'9'            F SIGN REQUIRED
         BH    CBTAS2              NO, GO USE C SIGN
         AH    14,=H'240'          SET F SIGN
         B     CBTAS3              GO MOVE DIGIT
         SPACE
CBTAS2   AH    14,=H'183'          SET C SIGN
         SPACE
CBTAS3   STC   14,0(0,5)           STORE DIGIT
         LA    5,1(0,5)            INCR INTO OUTPUT
         BCT   7,CBTAS1            NEXT DIGIT
         LR    14,2                RELOAD RETURN ADDR
         BR    14                  RETURN
         EJECT
CBTSTAB1 DC    C'NSWPVLOUTGOOGOIGOBENQRT0'
CBTSTAB2 DC    C'MWLWCPCT'
DEFAULT  DC    CL5'IN'
         SPACE 5
         LTORG
         EJECT
OUCB     DSECT
OUCBNAME DS    F
OUCBFWD  DS    F
OUCBBCK  DS    F
OUCBTMA  DS    F
         SPACE
OUCBQFL  DS    C
OUCBGOO  EQU   X'80'
OUCBGOI  EQU   X'40'
OUCBGOB  EQU   X'20'
OUCBQF3  EQU   X'10'
OUCBOFF  EQU   X'08'
OUCBOUT  EQU   X'04'
OUCBOTM  EQU   X'02'
OUCBQF7  EQU   X'01'
         SPACE
OUCBSFL  DS    C
OUCBNSW  EQU   X'80'
OUCBCTI  EQU   X'40'
OUCBWMA  EQU   X'20'
OUCBSF3  EQU   X'10'
OUCBGOA  EQU   X'08'
OUCBPVL  EQU   X'04'
OUCBENQ  EQU   X'02'
OUCBSCN  EQU   X'01'
         SPACE
OUCBYFL  DS    C
OUCBVLD  EQU   X'80'
OUCBSTT  EQU   X'40'
OUCBLOG  EQU   X'20'
OUCBMNT  EQU   X'10'
OUCBCTU  EQU   X'08'
OUCBAXS  EQU   X'04'
OUCBDTA  EQU   X'02'
OUCBYF7  EQU   X'01'
         SPACE
OUCBAFL  DS    C
OUCBWLM  EQU   X'80'
OUCBAPG  EQU   X'40'
OUCBRMA  EQU   X'20'
OUCBCPL  EQU   X'10'
OUCBVSW  EQU   X'08'
OUCBVRP  EQU   X'04'
OUCBNWT  EQU   X'02'
OUCBASW  EQU   X'01'
         EJECT
OUCBTFL  DS    C
OUCBATR  EQU   X'80'
OUCBSTR  EQU   X'40'
OUCBNTR  EQU   X'20'
OUCBRTR  EQU   X'10'
OUCBPCH  EQU   X'08'
OUCBMAR  EQU   X'04'
OUCBINP  EQU   X'02'
OUCBINC  EQU   X'01'
         SPACE
OUCBEFL  DS    C
OUCBLWT  EQU   X'80'
OUCBTRM  EQU   X'40'
OUCBOWT  EQU   X'20'
OUCBCIM  EQU   X'10'
OUCBNQF  EQU   X'08'
OUCBQSS  EQU   X'04'
OUCBQSC  EQU   X'02'
OUCBMWT  EQU   X'01'
         DS    CL49
OUCBPFL  DS    C
         DS    CL24
         END

000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID. PRESTA4.
000500 ENVIRONMENT DIVISION.
000600 CONFIGURATION SECTION.
000700 SOURCE-COMPUTER. IBM-3031.
000800 OBJECT-COMPUTER. IBM-3031.
000900 SPECIAL-NAMES.
001000     DECIMAL-POINT IS COMMA
001100     C01 IS SALTO-PAG.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT  SALIDA    ASSIGN DA-S-SALIDA.
       DATA DIVISION.
       FILE SECTION.
       FD   SALIDA
            LABEL RECORDS ARE STANDARD,
            BLOCK  0  RECORDS,
            RECORDING MODE IS F.
       01  R-SALIDA  PIC X(80).
002200 WORKING-STORAGE SECTION.
003400 01  R-SPACES PIC X(80) VALUE SPACES.
003400 01  W-SALIDA PIC X(80).
003400 01  DATOS.
003500     03  CPENDANT      PIC 9(10)V9(8).
003600     03  CNUEVOPEN     PIC S9(10)V9(8).
003700     03  CCAPITAL      PIC 9(10)V9(8).
003800     03  CINTERES      PIC 9(10)V9(8).
003900     03  WCUOTA        PIC 9(10)V9(8).
008500     03  ZCUOTA        PIC ZZZ.ZZZ.ZZ9,99.
004000     03  NRECIBS       PIC 9999.
004100     03  NRECI         PIC 9999 VALUE ZEROS.
004200     03  TOTCAP        PIC 9(10)V9(8) VALUE ZEROS.
004300     03  TOTINT        PIC 9(10)V9(8) VALUE ZEROS.
004400     03  ACUCAP        PIC 9(10)V9(8) VALUE ZEROS.
004500     03  ACUINT        PIC 9(10)V9(8) VALUE ZEROS.
004600     03  ANNO          PIC 9999 VALUE 01.
004700     03  CPRI          PIC 9999 VALUE ZEROS.
004800     03  WRECI         PIC 9999 VALUE ZEROS.
004900     03  CONTA         PIC 9999 VALUE ZEROS.
005000     03  W1            PIC 9(10)V9(8).
005100     03  W2            PIC 9(10)V9(8).
005200     03  W3            PIC 9(10)V9(8).
005300     03  W4            PIC 9(10)V9(8).
005400     03  W5            PIC 9(10)V9(8).
005500     03  W6            PIC 9(10)V9(8).
008100 01  DETA1.
008300     03  MES-DETA1     PIC XXX.
008300     03  ANO-DETA1     PIC XX.
008300     03  PRECI         PIC ZZZ9.
008400     03  FILLER        PIC XXX VALUE SPACES.
008500     03  PPENDANT      PIC ZZZ.ZZZ.ZZ9,99.
008600     03  FILLER        PIC XXX VALUE SPACES.
008700     03  PNUEVOPEN     PIC ZZZ.ZZZ.ZZ9,99-.
008800     03  FILLER        PIC XX   VALUE SPACES.
008900     03  PCAPITAL      PIC ZZZ.ZZZ.ZZ9,99.
009000     03  FILLER        PIC X(1) VALUE SPACES.
009100     03  PINTERES      PIC ZZZ.ZZZ.ZZ9,99.
010400 01  DETA3.
010500     03  FILLER        PIC X(16) VALUE
010600         'TOTAL ACUMULADO'.
010700     03  FILLER        PIC X(30) VALUE
010800         '. . . . . . . . . . . . .'.
010900     03  PACUCAP       PIC ZZZ.ZZZ.ZZ9,99.
011000     03  FILLER        PIC X  VALUE SPACES.
011100     03  PACUINT       PIC ZZZ.ZZZ.ZZ9,99.
       01  MESES.
           03 FILLER PIC XXX VALUE 'ENE'.
           03 FILLER PIC XXX VALUE 'FEB'.
           03 FILLER PIC XXX VALUE 'MAR'.
           03 FILLER PIC XXX VALUE 'ABR'.
           03 FILLER PIC XXX VALUE 'MAY'.
           03 FILLER PIC XXX VALUE 'JUN'.
           03 FILLER PIC XXX VALUE 'JUL'.
           03 FILLER PIC XXX VALUE 'AGO'.
           03 FILLER PIC XXX VALUE 'SET'.
           03 FILLER PIC XXX VALUE 'OCT'.
           03 FILLER PIC XXX VALUE 'NOV'.
           03 FILLER PIC XXX VALUE 'DIC'.
       01  FILLER REDEFINES MESES.
           03 TMES PIC XXX OCCURS 12 TIMES.
002200 LINKAGE SECTION.
002300 01  TARJETA.
002400     03  FILLER        PIC XX.
002400     03  CCONCE        PIC 9(8).
002600     03  PLAZO         PIC 9999.
002800     03  INTE          PIC 999999.
003000     03  CUOTA         PIC 9(6)99.
003200     03  NPRI          PIC 99.
008300     03  ANO-W         PIC 99.
008300     03  MES-W         PIC 99.
011300 PROCEDURE DIVISION USING TARJETA.
011400 PROGRAMA.
012300     OPEN OUTPUT SALIDA.
012300     COMPUTE INTE ROUNDED = INTE / 10000.
012300     COMPUTE CUOTA ROUNDED = CUOTA / 100.
011800     IF CUOTA = ZEROS
011900          NEXT SENTENCE
012000     ELSE
012100          MOVE CUOTA TO WCUOTA
012200          GO TO SIGO.
012300     COMPUTE W1 ROUNDED = INTE / 1200.
012400     COMPUTE W2 ROUNDED = 1 / (1 + W1).
012500     COMPUTE W3 ROUNDED = W2 ** PLAZO.
012600     COMPUTE W4 ROUNDED = 1 - W3.
012700     COMPUTE W5 ROUNDED = CCONCE * W1.
012800     COMPUTE W6 ROUNDED = W5 / W4.
012900     MOVE    W6 TO WCUOTA.
012900     MOVE WCUOTA TO ZCUOTA.
012900     WRITE R-SALIDA FROM ZCUOTA.
013000 SIGO.
013100     MOVE PLAZO TO NRECIBS.
013200     MOVE CCONCE TO CPENDANT CNUEVOPEN.
013400 MAS.
013500     ADD 1 TO NRECI.
013600     IF NRECI > NRECIBS
013700          GO TO ACABO.
013800     MOVE NRECI TO PRECI.
013800     PERFORM MOVER-FECHA.
013900     MOVE CPENDANT TO PPENDANT.
014000     COMPUTE W1 ROUNDED = CPENDANT * INTE.
014100     COMPUTE W2 ROUNDED = W1 / 1200.
014200     MOVE    W2 TO CINTERES PINTERES.
014300     COMPUTE W3 ROUNDED = WCUOTA - W2.
014400     MOVE    W3 TO CCAPITAL PCAPITAL.
014500     COMPUTE W4 ROUNDED = CPENDANT - CCAPITAL.
014600     MOVE W4 TO CNUEVOPEN.
014700     MOVE CNUEVOPEN TO PNUEVOPEN CPENDANT.
014800     WRITE R-SALIDA FROM DETA1.
014900     ADD CCAPITAL TO TOTCAP ACUCAP.
015000     ADD CINTERES TO TOTINT ACUINT.
019000     GO TO MAS.
019100 ACABO.
020000     MOVE ACUCAP TO PACUCAP.
020100     MOVE ACUINT TO PACUINT.
022400     WRITE R-SALIDA FROM R-SPACES.
020200     WRITE R-SALIDA FROM DETA3.
020300 TERMINO.
012300     CLOSE SALIDA.
020500     STOP RUN.
020300 MOVER-FECHA.
012300     MOVE ANO-W TO ANO-DETA1.
012300     MOVE TMES(MES-W) TO MES-DETA1.
012300     IF MES-W = 12
012300        ADD 1 TO ANO-W
012300        MOVE 0 TO MES-W.
012300     ADD 1 TO MES-W.

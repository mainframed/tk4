         MACRO
&NAME    ELSE  &DOGROUP=,&MNAME=ELSE  END OF POSITIVE TEST, START OF
         COPY  $MGBLDEF            . NEGATIVE
         LCLC  &X                  SET TO 'IF-FAILED' TAG
         AIF   (&$MDGLVL GT 0).OK02
         MNOTE 8,'''&MNAME'' IS VALID ONLY WITHIN AN IF-GROUP'
         MNOTE 0,' - MACRO GENERATION TERMINATED'
         MEXIT
.OK02    $MENDDO1 DOGROUP=&DOGROUP
         AIF   (&$MDGERR NE 0).QUIT GIVE UP IF ERROR
         AIF  ('&$MLTAG(&$MDGLVL)' EQ '').SKIP30
         MNOTE 8,'''&MNAME'' INVALID FOR ''DO'' - ENDO ASSUMED'
         $MENDDO2 ,                PRETEND NO 'ELSEDO'
         MEXIT
.SKIP30  AIF   ('&$MIFELS(&$MDGLVL)' NE 'S').SKIP40
         MNOTE 8,'''&MNAME'' INVALID FOLLOWING ''&MNAME'' -'
         MNOTE '''ENDO'' INVOKED'
         $MENDDO2                 JUST LIKE NO 'ELSEDO'
         MEXIT
.SKIP40  B     $MDS&$MDGSEQ(&$MDGLVL) BRANCH AROUND ELSE-GROUP
&X       SETC  '$MDF&$MDGSEQ(&$MDGLVL)' 'IF-FAILED' TAG
         AIF   ('&NAME' EQ '').SKIP50
&NAME    DC    0H'0'              DEFINE TAG
.SKIP50  ANOP
&X       DC    0H'0'              TAG FOR 'IF' FAILURE
&$MIFELS(&$MDGLVL) SETC 'S'       SET FOR 'ENDELSE'
.QUIT    MEND

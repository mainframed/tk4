./     ADD     NAME=##DOC
1                                                          DOC - Page 1

    Following is the documentation to install the fun and versatile
  Space War Game "KLINGON".

    Complete, ready to print rules are in member #RULES. You may print
  it using the PRINTDS TSO command, as e.g. :

    TSO PRINTDS DA('______________________________________(#RULES)')
                CCHAR CLASS(A) DEST(________)

    Program KLINGON : a Space War Game
    By : Larry WILLIAMS
    With consulting and assistance : Mark STEVENS
    This version updated by : MOINIL P.A. - J.R.C. Ispra, Italy.
                              (April 1993)

    Programmer's notes
    ==================

    KLINGON is a Space War Game written for Control Data Corporation
  machines 6000 or higher with FORTRAN 5 (ANSI 1977 standard).
    Version 1.2 was updated in 1987 - MARCH to operate under MVS/TSO
  on 3270 24, 32 or 43 lines terminals in fullscreen mode and via
  FORTRAN I/O (UNITS 5/6) for non 3270.
    This version is now with Assembler H and FORTRAN VS compiler, and
  operates under MVS/XA 2.2.3.

    Copyright notice :
    ------------------
    Permission is hereby granted for the copying, distribution,
  modification and use of this program and associated documentation
  for recreational purposes, provided that all references to the author
  are retained.
    However, permission is not and will not be granted for the SALE or
  PROMOTIONAL use of this program or program documentation, or for use
  in any situation in which PROFIT may be considered on objective,
  since it is the desire of the author to respect the copyrights of
  the originators of STAR TREK.

    STAR TREK is a trademark of Paramount Pictures.

    This program was finished in JANUARY, 1983.
1                                                          DOC - Page 2

    INSTALLATION INSTRUCTIONS
    =========================

  (1) - Assuming Assembler H and FORTRAN VS compiler are available.
        If you do not have a version of FORTRAN available, a job has
        been provided (#GETFORT) in the original PDS (file 38 of CBT 92
        MAR tape) to unload the compiler and callib from that CBT tape.

        ( ) - FORTRAN VS is already installed
              Write DS-names of FORTRAN VS libraries below :

              COMPILER _______________________________________________

              LNK-CALL _______________________________________________


  (2) - Allocate a PDS (your choice of name) that is able to hold all
        data, i.e. : SPACE=(CYL,(3,1,30)
                     BLKSIZE=3120
                     LRECL=80
        for use as a work OBJECT library.

        ( ) - Write DS-name here _____________________________________


  (3) - Review the member SHIFTAB, and decide when KLINGON should be
        allowed to be played, the default is to allow play anytime.
        Update this member if exclusions are to be made.


  (4) - Decide what load library you would like the modules "KL" (main
        routine) and "INITKL" (file init routine) to be installed into.

        ( ) - Write DS-name here _____________________________________


  (5) - Edit Member #JCLFULL and modify the data-sets names as needed.
        Data-sets names that need to be modified are marked with "<-"
        at the right margin.
        Please note : the JCL marked with a '$' in column 1 is the
        prototype JCL to actually assembly/compile/link KLINGON, do not
        change any parms except the work unit name (VIO is default).
        You should change the JOB card in the $ jcl to meet with your
        standards, the card may be continued if needed.

        If FORTRAN VS is not the desired FORTRAN, modify the compiler
        program name as needed.

        If you wish to review the JCL before submitting it, modify the
        FT14F001 DD card to NOT use the internal reader.
1                                                          DOC - Page 3

  (6) - Run the #JCLFULL JOB.
        This job will feed a job to the internal reader to assemble and
        link KLINGON.

  (7) - Copy the graphics file to a sequential data-set.
        Allocate a LRECL 80 data-set to hold the graphics data, and
        copy member #GRAFICS to that file.

        ( ) - Write DS-name here _____________________________________

        Note : a PDS should not be used since the DSN-ENQ will tie up
               the whole file, also, IBM access methods used by old
               FORTRAN can be confused opening two members at the same
               time.

  (8) - Copy the rules file to a sequential data-set.
        Allocate a LRECL 80 data-set to hold the rules data, and copy
        member #RULES to that file.

        ( ) - Write DS-name here _____________________________________


  (9) - Copy the help file to a sequential data-set.
        Allocate a LRECL 80 data-set to hold the help data, and copy
        member #KLHELP to that file.

        ( ) - Write DS-name here _____________________________________

        ( ) - Be sure to modify the comments in the help file to say
              where the rules "manual" is stored (member #RULES).

        Note : a PDS should not be used since the DSN-ENQ will tie up
               the whole file, also, IBM access methods used by old
               FORTRAN can be confused opening two members at the same
               time.

  (10)- Modify the CLIST for the game.
        Modify CLIST #KLPROC to meet your requirements (see steps 4-9).

        The default UNIT type for the "high-speed work files" is VIO,
        if desired, this may be changed to SYSDA instead.

        ( ) - Move the modified CLIST to the library of your choice.

  (11)- Try the game × Should work great.

  (12)- At this point, the object file may be deleted (if desired).
1                                                          DOC - Page 4

    DEBUGGING INFORMATION
    =====================

    KLINGON is a rather advanced game program, and sometimes data for
  debugging needs to be collected.

    To collect bebugging data the FT10F001 file must be pre-allocated
  for the users who are allowed to do it (see step 10, CLIST #KLPROC).

    To activate debugging trace :
       - at the "COMMAND ?" prompt in KLINGON, enter "XDEBUG" command,
       - the password to activate/deactivate XDEBUG is "NONA".

 ----------------------------------------------------------------------

    If you have any questions/comments, etc... address your mail to :

         Larry Williams
         P.O. Box 8069
         Bartlett, IL  60103

    or : MOINIL P.A. -- Phone number : (0332) 789442
         Computing Centre (TP 361)
         J.R.C. - Ispra Establishment
         21020 ISPRA (VA), ITALY

 ----------------------------------------------------------------------
./     ADD     NAME=##NEW
1
  File 038
  ========

    The changes to "KLINGON" provide the same level of graphics support
  to MODEL-3 (32 by 80) screens as is currently available to MODEL-2
  (24 by 80) and MODEL-4 (43 by 80) screen.

    To produce this enhancement, the following members were changed and
  are supplied in this file :
       #GRAFICS
       CPAGE
       FSIO1
       FSIO2
       INTRO

    These changes added 03/27/90 to file 038. They are from Mr Greg
  PRICE of Australia, see file 001 of the CBT MVS MODS tape for Greg's
  address in Australia.

                                        Arnie CASINGHINO (03/27/90)
1
  Changes to original file 038 (from CBT 92 MAR tape)
  ===================================================

  The following changes were applied on April 28th 1993 :
    1. Member MEMLPG deleted (unused).
    2. Member IWV deleted (was an exact copy of member IW), so use of
       IWV has been replaced everywhere by IW.
    3. Member SZTERM deleted (his process and more has been included
       in member GAINIT).
    4. Member STIMER deleted (his process has been included in member
       FSIO2).
    5. Member CPAGE deleted (his process and more has been inserted in
       members FSIO1 and FSIO2).
    6. Assembler member INSFOR added (routine).
    7. Members #GETFORT and #SRULES deleted (we don't use them), and
       member #RULES modified to be printed A4 paper format.
       Also member ##DOC reworked to reflect changes.
    8. Member #KLSEQ and #KL3270 replaced by member #KLPROC (now unique
       procedure to invoke "KLINGON").
    9. Member #ERASE added (TSO command needed by new the procedure
       #KLPROC, which allows to run also under ISPF).
       Note : this TSO command is identical to the one distributed in
              the ->.SOURCE.FILE0 (don't install if already linked in
              the LPALIB).
   10. Member #JCLPROG modified to generate only one job.
   11. Member #JCLFULL modified to use our JOB and JOBPARM cards, the
       Assembler H and the FORTRAN VS compiler (MVS/XA 2.2.3 version),
       and now, all steps are given a zero return code.

  Data-sets names :
  =================

  Here follows the list of all the data-sets names defined to generate
  and use KLINGON at our installation (see member ##DOC and the various
  other members where they appear to make your changes) :
       <User-id>....                 <Group-id>....
       ->.USER.KL.CNTL               ->.GROUP.KL.GRAPH
       ->.USER.KL.DATA               ->.GROUP.KL.HELP
       ->.USER.KL.OBJ                ->.GROUP.KL.LOAD
                                     ->.GROUP.KL.RULES
       <System-id>....               <System-id>....
       SYS1.MACLIB                   SYS1.VF23COMP
       SYS1.MODGEN                   SYS1.VF23FORT

                              G O O D     L U C K

                                        MOINIL P.A. (04/28/93)
                                        Computing Centre (TP 361)
                                        J.R.C. - Ispra Establishment
                                        21020 ISPRA (VA), ITALY
./     ADD     NAME=#ERASE
//ERASE    JOB (........),'INSTALL -ERASE-',
//             MSGLEVEL=(1,1),MSGCLASS=A,REGION=1M,TIME=(,20)
/*JOBPARM L=2
//ASS     EXEC PGM=IEV90,PARM='XREF(SHORT),NODECK,OBJECT,RENT'
//SYSLIB    DD DSN=SYS1.MACLIB,DISP=SHR
//          DD DSN=SYS1.MODGEN,DISP=SHR
//SYSUT1    DD UNIT=VIO,DSN=&&SYSUT1,SPACE=(CYL,(10,5))
//SYSLIN    DD UNIT=SYSDA,SPACE=(CYL,(1,1)),DSN=&LOADSET,
//             DCB=(BLKSIZE=800),DISP=(,PASS,DELETE)
//SYSPRINT  DD SYSOUT=*
//SYSIN     DD *
TESR     TITLE '--- TERMINAL ERASE SCREEN SUBROUTINE/TSO COMMAND ---'
ERASE    START 0
         SPACE 1
* PURPOSE : ERASE THE SCREEN OF A TERMINAL AND SET CURSOR AT THE TOP
*               OF IT (ROW 1 - COLUMN 1).
* MAY BE USED : 1. AS TSO COMMAND : ERASE
*               2. AS PROGRAM ROUTINE : CALL ERASE
* AUTHOR : MOINIL P.A.
*               COMPUTING CENTRE
*               J.R.C. - ISPRA ESTABLISHMENT
*               21020 ISPRA (VA), ITALY
         SPACE 1
        YREGS
         SPACE 1
        SAVE   (14,12),,*          SAVE REGISTERS
         LR    R12,R15             ESTABLISH ADDRESSABILITY
         USING ERASE,R12           WE GOT IT
        GETMAIN R,LV=72            GET SAVE AREA
         LR    R15,R13             PREVIOUS SAVE AREA
         LR    R13,R1              CURRENT SAVE AREA
         XC    0(18*4,R13),0(R13)  CLEAR SAVE AREA
         ST    R13,8(R15)          LINK SAVE AREAS
         ST    R15,4(R13)
        GTSIZE
         LTR   R4,R0               IS IT A SCREEN TERMINAL?
         BZ    EXIT                NO, BYPASS
         USING PSA,R0              WE HAVE TO GET IT FROM ASXB
         L     R3,PSAAOLD          GET OUR ASCB ADDRESS
         DROP  R0
         USING ASCB,R3
         L     R3,ASCBASXB         GET ASXB ADDRESS
         DROP  R3
         USING ASXB,R3
         L     R2,ASXBMPST         VTAM MEMORY PROCESS SCHED. TABLE
         DROP  R3
         LTR   R2,R2               CHECK IF VTAM OR TCAM?
         BZ    TCAM                ADDRESS DOESN'T EXIST : TCAM
         CLM   R4,B'0001',SZ24     NORMAL SCREEN SIZE?
         BNE   ALTSZ               NO
         LA    R0,CLERNL           NORMAL SIZE
         LA    R1,CLERN            NORMAL CLEAR
         B     SEND
ALTSZ    LA    R0,CLERAL           ALTERNATE SIZE
         LA    R1,CLERA            ALTERNATE CLEAR
SEND     ICM   R1,B'1000',FUSCR
        TPUT   (1),(0),R
        STLINENO LINE=1
        STTMPMD OFF
         B     EXIT
TCAM    TPUT   ERBUF,ERBUFL,ASIS   ERASE SCREEN AND SET CURSOR
EXIT     LR    R1,R13              CURRENT SAVE AREA
         L     R13,4(R13)          PREVIOUS SAVE AREA
        FREEMAIN R,LV=72,A=(1)     FREE SAVE AREA
        RETURN (14,12),T,RC=0      RESTORE REGISTER AND BACK TO CALLER
         SPACE 1
*------- FIXED CONSTANTS
         SPACE 1
ERBUF    DC    X'401140403C40400013'
ERBUFL   EQU   *-ERBUF
CLERN    DC    X'27F5C111404013'
CLERNL   EQU   *-CLERN
CLERA    DC    X'277EC111404013'
CLERAL   EQU   *-CLERA
SZ24     DC    AL1(24)             24 LINES SCREEN
FUSCR    DC    XL1'03'
         SPACE 1
        PRINT  NOGEN
        IHAPSA
        IHAASCB
        IHAASXB
         SPACE 1
         END
/*
//LNK     EXEC PGM=HEWL,PARM='XREF,LIST,RENT',COND=(4,LT)
//SYSLMOD   DD DSN=SYS1.CMDLIB,DISP=OLD
//* --------> OR : SYS1.LPALIB
//SYSUT1    DD UNIT=VIO,SPACE=(CYL,(1,1))
//SYSPRINT  DD SYSOUT=*
//SYSLIN    DD DSN=&LOADSET,DISP=(OLD,DELETE,DELETE)
//          DD *
  ENTRY   ERASE
  NAME    ERASE(R)
/*
./     ADD     NAME=#GRAFICS
MOVE43000100 ===========================================================
                    .   .                 .    .          .     .   .
  .     .   .                 .                             .         .
                  .       .         .                .
  .                                        .      .              .
      .   .      .    .         .                         .            .
                   .      .          .
      .      .                          .    .
  .               .    . .       .     .   .      .     .    .
     .                                                             .
        .
           .    .      .                   .             .
      .                     .    .                .           .    .
               .     .                 .

   .     .                                   .         .       .      .
      .
             .   .    .      .    .                               .
    .                                    .       .
       .    .                                                    .    .
                                                          .
                  .      .      .              .     .             .
             .
    .                                     .
                                                                .    .
            .       .            .                      .
                                        .   .      .
         .                .                                      .   .
               .                  .     .                 .
                   .                                          .
         .                                     .         .
          .               .        .                 .              .
   .          .                                                .
     .   .     .     .            .    .     .            .
    .                                               .             .  .
                           .
          .   .                  .      .   .
                      .                                .
   .                                                                .  .
                                     .               .
             .              .                               .   . .
  .                   .               .
         .                       .                  .              .
                                                           .
MOVE43000000 ===========================================================
 â     â   â    â       â    â    â                    /     /         /
â                â       â         â         /      / /            /
 â  â   â      â    â         â             /      /        /     /
     â   â      ââ   â  â      â                           /
    â      â      â      â                /    /
â    â      â   â    â â       â         /   //     /     /    /
 â â             â    â â       â       /   /      /     /    /      /
    â â                                                             /
       â â    â      â                       /             /
    â     â    â      â   â    â            /       /     /     /    /
     â       â     â       â    â        /         /           /    /
              â     â                   /
 â     â                                       /         /       /
  â â   â                                     /         /       /      /
     â     â   â    â      â    â                                   /
  â         â   â    â      â    â         /       /               /
   â â    â                               /       /                /
      â    â                                                /     /    /
                                                           /



            /
   /       /                               â
  /                                         â                    â    â
           /       /            /                        â        â    â
          /       /            /         â   â      â     â
        /                /                â   â      â            â   â
       /      /         /        /       â                 â       â   â
             /    /             /         â                 â  â
        /        /                              â         â     â
       / /               /        /              â    â    â         â
  /     /    /          /        /                     â        â     â
 /  /   /   / /     /            /      â     â            â     â
   /   /     /     /            /        â     â     â      â      â  â
                          /                           â             â  â
         /   /           /      /        â   â
        /   /        /         /          â   â         â
  /                 /                                    â           â
 /                                                    â               â
            /              /                           â     â   â â
 /         /         /    /            â                      â   â â
/       /           /           /       â            â              â
MOVE43000000 ===========================================================
 â     â   â    â       â    â    â           /      / /     /      /  /
â  â   â      â  â â     â   â     â         /      / /      /     /
 â  â   â      ââ   â  â      â             /      /        /     /
   â â   ââ     ââ   â  â      â                /          /
    â      â   â  â â â  â    â           /   //     /     /    /
â â  â      â   â    â â       â         /   //     /     /    /      /
 â â â           â    â â       â       /   /      /     /    /      /
    â â â    â      â                         /             /       /
   â   â â    â      â   â    â              /       /     /     /    /
    â     â â  â  â   â   â    â          / /       /     /     /    /
     â       â     â       â    â        /         /           /    /
â     â       â     â                   /       /         /       /
 â â   â                                       /         /       /
  â â   â â   â    â      â    â              /         /       /    / /
 â   â     â   â    â      â    â           /       /               /
  â â    â  â   â    â      â    â         /       /               //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /



            /
   /       /                               â
  /       /                                 â                    â    â
 /         /       /            /            â           â        â    â
          /       /            /         â   â      â     â        â
        //       /       /    /           â   â      â     â      â   â
       /      /         /        /       â â   â      â    â       â   â
      /      /    /    /        /         â                 â  â    â
        /   /    /             /           â    â         â  â  â
       / /      /        /        /              â    â    â     â   â
  /   / /    /          /        /                â    â    â   â     â
 /  /  //   / /     /  /        //      â     â         â  â     â     â
/  /   /   / /     /            /        â     â     â      â     ââ  â
  /   /     /     /       /    /          â     â     â      â      â  â
         /   /           /      /        â   â         â             â
        /   /        /  /      /          â   â         â
  /    /   /        /         /            â   â         â           â
 /                 /                                  â   â           â
/           /              /                           â     â   â â   â
 /         /         /    /            â                â     â   â â
/       / /         /    /      /       â            â         â   âââ
MOVE43000000 ===========================================================
 ââ   ââ   â â  â â     â   ââ    â           /      / /     //     /  /
â  â   â      ââ â â  â  â   â     â         /      / /      /     /
 ââ â   ââ     ââ   â  â      â             /    / /        /     /
   â â   ââ   â ââ â â  â    â â           /   //     /    //    /
 â  â      â   â  â â â  â    â           /   //     /     /    /      /
â â ââ      â   â    â â       â         /   //     /     /    /      /
 â â â â    â    â â  â â       â       /   /  /   /     /   //      /
  â â â â    â      â   â    â                /       /     /     / /  /
   â   â â â  â  â   â   â    â            / /       /     /     /    /
    â     â â  â  â   â   â    â          / /       /     /     /    /
     â       â     â       â    â        /       / /       /   /   //
â â   â       â     â                   /       /         /       /
 â â   â â   â    â      â    â                /         /       /    /
â â â   â â   â    â      â    â             //      /  /       /    / /
 â â â  â  â   â    â      â    â           /       /               //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /



            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/         /       /            /         â   ââ     â     â        â
        //       /       /    /           â   â      â     â      â â â
       //     / /       /    /   /       â â   â      â    ââ      â   â
      /      /    /    /        /         â â   â      â    â  â    â
     /  /   /    /    /        /           â    â         â  â  â    â
       / / /    /        /    /   /         â    â    â    â  â  â   â
  /   / /    / /        /    /   /                â    â    â   â â   â
 /  // //   / /     /  /        //      â     â    â    â  â â   â     â
/  /  //   / /     /  /        //        â     â     â   â  â     ââ  â
  /   /   / /     /       /    /          â     â     â      â     ââ  â
 /   /   /   /   /       /    / /        â â â   â     â      â      â
        /   /        /  /      /          â   â         â             â
  /    /   /        /  /      /            â   â         â           â
 /        /        /         /              â   â     â   â           â
/           /     /        /                           â     â   â â   â
 /         /         /    /            â                â     â   â â
/       / /         /    /      /       â            â   â     â   âââ
MOVE43000000 ===========================================================
 ââ   ââ   â ââ â â  â  â   ââ    â           /      / /     //     /  /
ââ â   ââ     ââ â â  â  â   â     â         /    / / /      /     /
 ââ â   ââ   â ââ â â  â    â â             /   // /   /    //    /
â  â â   ââ   â ââ â â  â    â â           /   //     /    //    /
 â ââ      â   â  â â â  â    â           /   //     /     /    /      /
â â âââ    ââ   â â  â â       â         /   // /   /     /   //      /
 â â â â    â    â â  âââ   â   â       /   /  /   /   / /   //    / /
  â â â â â  â  â   â   â    â              / /       /     /     / /  /
   â   â â â  â  â   â   â    â            / /       /     /     /    /
    â     â â  â  â   â   â    â          / /     / /     / /   /   //
 â   â       â     â       â    â        /       / /       /   /   //
â â   â â   â â  â  â   â    â          /       /         /       /    /
 â â   â â   â    â      â    â               //      /  /       /    /
â â â  ââ â   â    â      â    â             //      /  /       /    ///
 â â â  â  â   â    â      â    â           /       /          /    //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /



            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/       / /       /            /         â   ââ     â     â        â
        //       /       /    /           â   ââ     â     â      â â â
       //     / /       /    /   /       â â   â      â    ââ      â â â
      //     / /  /    /    /   /         â â   â      â    ââ â    â
     /  /   /    /    /        /           â â  ââ      â â  â  â    â
    /  / / /    /    /   /    /   /         â    â    â    â  â  â   ââ
  /   / / /  / /        /    /   /           â    â    â    â  ââ â   â
 /  // //   / /     /  /        //      â     â    â    â  â â   â â   â
/  // //   / /     /  /        //        â     â    ââ   â  â â   ââ  â
  /  //   / /     /  /    /   //          â     â     â   â  â     ââ  â
 /   /   /   /   /       /    / /        â â â   â     â      â     ââ
/   /   /   /   /    /  /    / /          â â â         â      â      â
  /    /   /        /  /      /            â   â         â           â â
 /        /        /  /      /              â   â     â   â           â
/        /  /     /        //                â   â     â     â   â â   â
 /         /     /   /    /            â                â     â   â â
/       / /         /    /      /       â            â   â     â   âââ
MOVE43000000 ===========================================================
 ââ   ââ   â ââ â â  â  â   ââ    â           /    / / /     //     /  /
ââ â   ââ   â ââ â â  â  â â â     â         /   // / / /    //    /
 ââ â   ââ   â ââ â â  â    â â             /   // /   /    //    /
â ââ â   ââ   â ââ â â  â    â â           /   //     /    //    /
 â âââ    ââ   â ââ â â  â    â           /   // /   /     /   //      /
â â âââ    ââ   â â  âââ   â   â         /   // /   /   / /   //    / /
 â â â â â  â  â â â  âââ   â   â       /   // /   /   / /   //    / /
  â â â â â  â  â   â   â    â              / /       /     /     / /  /
   â   â â â  â  â   â   â    â            / /     / /     / /   /    /
â   â     â â  â  â   â   â    â          / /     / /     / /   /   //
 â   â â   â â  â  â   â   ââ   â        /       / /       /   /   //
â â   â â   â â  â  â   â    â          /      //      /  /       /    /
 â â  ââ â   â    â      â    â               //      /  /       /    //
â â â  ââ â   â    â      â    â             //      /  /       /    ///
 â â â  â  â   â    â      â    â           /       /          /    //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /



            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/       / /       /            /         â   ââ     â     â        â
       ///       /       /    /           â   ââ     â     â      â â â
       //     / /       /    /   /       â â   ââ     â    ââ      â â â
      //     / /  /    /    /   /         â â   â      â    ââ â    â â
     // /   / /  /    /    /   /           â â  ââ      â â  ââ â    â
    /  / / /    /    /   /    /   /         â â  ââ   â  â â  â  â   ââ
  //  / / /  / /    /   /    /   /           â    â    â    â  ââ â   ââ
 /  // ///  / /     /  /    /   //      â     â    â    â  â â  ââ â   â
/  // //   / /     /  /        //        â     â    ââ   â  â â   âââ â
  // //   / /     /  /    /   //          â     â    ââ   â  â â   ââ  â
 /  //   /   /   /  /    /   // /        â â â   â     â   â  â     ââ
/   /   /   /   /    /  /    / /          â â â         â      â      â
  /    /   /   /    /  /    / /            â â â         â      â    â â
 /        /        /  /      /              â   â     â   â           â
/        /  /     /  /     //                â   â     â     â   â â   â
 /      /  /     /   /    //           â      â   â     â     â   â â
/       / /         /    /      /       â            â   â     â   âââ
MOVE43000000 ===========================================================
 ââ   ââ   â ââ â â  â  â â ââ    â           /   // / / /   ///    /  /
ââ â   ââ   â ââ â â  â  â â â     â         /   // / / /    //    /
 ââ â   ââ   â ââ â â  â    â â             /   // /   /    //    /
â ââââ   ââ   â ââ â â  â    â â           /   // /   /    //   //
 â âââ    ââ   â ââ âââ  ââ   â           /   // /   /   / /   //    / /
â â âââ â  ââ â â â  âââ   â   â         /   // /   /   / /   //    / /
 â â â â â  â  â â â  âââ   â   â       /   // /   /   / /   //    / /
  â â â â â  â  â   â   â    â              / /     / /     / /   / /  /
   â   â â â  â  â   â   â    â            / /     / /     / /   /   //
â   â â   â â  â  â   â   ââ   â          / /     / /     / /   /   //
 â   â â   â â  â  â   â   ââ   â        /      // /    /  /   /   //
â â  ââ â   â â  â  â   â    â          /      //      /  /       /    /
 â â  ââ â   â    â      â    â               //      /  /       /    //
â â â  ââ â   â    â      â    â             //      /  /       /    ///
 â â â  â  â   â    â      â    â           /       /          /    //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /



            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/       / /       /            /         â   ââ     â     â        â
       ///       /       /    /           â   ââ     â     â      â â â
      ///     / /       /    /   /       â â   ââ     â    ââ      â â â
      //     / /  /    /    /   /         â â   ââ     â    ââ â    â â
     // /   / /  /    /    /   /           â â  ââ      â â  ââ â    â â
    // / / / /  /    /   //   /   /         â â  ââ   â  â â  ââ â   ââ
  //  / / /  / /    /   //   /   /           â â  ââ   â  â â  ââ â   ââ
 /  // ///  / /    //  /    /   //      â     â    â    â  â â  ââ â   â
/  // ///  / /     /  /    /   //        â     â    ââ   â  â â  ââââ â
  // //   / /     /  /    /   //          â     â    ââ   â  â â   ââ  â
 // //   /   /   /  /    /   // /        â â â   â    ââ   â  â â   ââ
/  //   /   /   /  / /  /   // /          â â â         â   â  â      â
  /    /   /   /    /  /    / /            â â â         â      â    â â
 /        /   /    /  /    / /              â â â     â   â           â
/        /  /     /  /     //                â   â     â   â â   â â   â
 /      /  /     /   /    //           â      â   â     â     â   â â
/      // /     /   /    //     /       â      â   â â   â     â   âââ
MOVE43000000 ===========================================================
âââ   ââ   â ââ â â  â  â â ââ    â           /   // / / /   ///    /  /
ââ â   ââ   â ââ â â  â  â â â     â         /   // / / /    //    /
 ââââ   ââ   â ââ â â  â    â â             /   // /   /    //   //
â ââââ   ââ   â ââ â â  ââ   â â           /   // /   /   ///   //    /
 â âââ â  ââ â â ââ âââ  ââ   â           /   // /   /   / /   //    / /
â â âââ â  ââ â â â  âââ   â   â         /   // /   /   / /   //    / /
 â â â â â  â  â â â  âââ   â   â       /   // /   / / / /   ///   / /
  â â â â â  â  â   â   â    â              / /     / /     / /   / / //
   â â â â â  â  â   â   ââ   â            / /     / /     / /   /   //
â   â â   â â  â  â   â   ââ   â          / /    // /    // /   /   //
 â  ââ â   â â  â  â   â   ââ   â        /      // /    /  /   /   //
â â  ââ â   â â  â  â   â    â          /      //      /  /       /    /
 â â  ââ â   â    â      â    â               //      /  /       /    //
â â â  ââ â   â    â      â    â             //      /  /       /    ///
 â â â  â  â   â    â      â    â           /       /          /    //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /



            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/       / /       /            /         â   ââ     â     â        â
       ///       /       /    /           â   ââ     â     â      â â â
      ///     / /       /    /   /       â â   ââ     â    ââ      â â â
     ///     / /  /    /    /   /         â â   ââ     â    ââ â    â â
     // /   / /  /    /    /   /           â â  âââ     â â  ââ â    â â
    // / / / /  /    /   //   /   /         â â  ââ   â  â â  ââ â   ââ
  /// / / / // /    /   //   /   /           â â  ââ   â  â â  ââ â   ââ
 // // ///  / /    //  //   /   //      â     â â  ââ   â  â â  ââ â   â
// // ///  / /    //  /    /   //        â     â    ââ   â  â â  ââââ â
  // ///  / /     /  /    /   //          â     â    ââ   â  â â  ââââ â
 // //   / / /   /  /    /   // /        â â â   â    ââ   â  â â   âââ
// //   /   /   /  / /  /   // /          â â â   â    ââ   â  â â   ââ
  //   /   /   /  / /  /   // /            â â â         â   â  â    â â
 //   /   /   /    /  /    / /              â â â     â   â      â    â
//       /  //    /  /    ///                â â â     â   â â   â â   â
 /      /  /     /  //    //           â      â   â     â   â â   â â
/      // /     /   /    //     /       â      â   â â   â     â   âââ
MOVE43000000 ===========================================================
âââ   ââ   â ââ â â  â  â â ââ    â           /   // / / /   ///    /  /
ââââ   ââ   â ââ â â  â  â â â     â         /   // / / /    //   //
 ââââ   ââ   â ââ â â  ââ   â â             /   // /   /   ///   //    /
â âââââ  ââ â â ââ âââ  ââ   â â           /   // /   /   ///   //    /
 â âââ â  ââ â â ââ âââ  ââ   â           /   // /   /   / /   //    / /
â â âââ â  ââ â â â  âââ   â   â         /   // /   / / / /   ///   / /
 â â â â â  â  â â â  âââ   â   â       /   // /   / / / /   ///   / / /
  â â â â â  â  â   â   â    â              / /     / /     / /   / / //
   â â â â â  â  â   â   ââ   â            / /    // /    // /   /   //
â  ââ â   â â  â  â   â   ââ   â          / /    // /    // /   /   //
 â  ââ â   â â  â  â   â   ââ   â        /      // /    /  /   /   //
â â  ââ â   â â  â  â   â    â          /      //      /  /       /    /
 â â  ââ â   â    â      â    â               //      /  /       /    //
â â â  ââ â   â    â      â    â             //      /  /       /    ///
 â â â  â  â   â    â      â    â           /       /          /    //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /



            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/       / /       /            /         â   ââ     â     â        â
       ///       /       /    /           â   ââ     â     â      â â â
      ///     / /       /    /   /       â â   ââ     â    ââ      â â â
     ///     / /  /    /    /   /         â â   ââ     â    ââ â    â â
    /// /   / /  /    /    /   /           â â  âââ     â â  ââ â    â â
    // / / / /  /    /   //   /   /         â â  âââ  â  â â  ââ â   ââ
  /// / / / // /    /   //   /   /           â â  ââ   â  â â  ââ â   ââ
 ///// /// // /    //  //   /   //      â     â â  ââ   â  â â  ââ â   â
// // ///  / /    //  //   /   //        â     â â  ââ   â  â â  ââââ â
/ // ///  / /    //  /    /   //          â     â    ââ   â  â â  ââââ â
 // ///  / / /   /  /    /   // /        â â â   â    ââ   â  â â  ââââ
// //   / / /   /  / /  /   // /          â â â   â    ââ   â  â â   âââ
/ //   /   /   /  / /  /   // /            â â â   â     â   â  â â  âââ
 //   /   /   /  / /  /   // /              â â â     â   â   â  â    â
//   /   /  //    /  /    ///                â â â     â   â â   âââ   â
//      /  //    /  //   ///           â      â â â     â   â â   â â
/      // /     /  //    //     /       â      â   â â   â   â â   âââ
MOVE43000000 ===========================================================
âââ   ââ   â ââ â â  â  â â ââ    â           /   // / / /   ///   //  /
ââââ   ââ   â ââ â â  ââ â â â     â         /   // / / /   ///   //
 âââââ  ââ â â ââ âââ  ââ   â â             /   // /   /   ///   //    /
â âââââ  ââ â â ââ âââ  ââ   â â           /   // /   /   ///   //    /
 â âââ â  ââ â â ââ âââ  ââ   â           /   // /   / / / /   ///   / /
â â âââ â  ââ â â â  âââ   â   â         /   // /   / / / /   ///   / /
 â â â â â  â  â â â  âââ   â   â       /   // /   / / / /   ///   / / /
  â â â â â  â  â   â   â    â              / /    // /    // /   / / //
  ââ â â â â  â  â   â   ââ   â            / /    // /    // /   /   //
â  ââ â   â â  â  â   â   ââ   â          / /    // /    // /   /   //
 â  ââ â   â â  â  â   â   ââ   â        /      // /    /  /   /   //
â â  ââ â   â â  â  â   â    â          /      //      /  /       /    /
 â â  ââ â   â    â      â    â               //      /  /       /    //
â â â  ââ â   â    â      â    â             //      /  /       /    ///
 â â â  â  â   â    â      â    â           /       /          /    //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /



            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/       / /       /            /         â   ââ     â     â        â
       ///       /       /    /           â   ââ     â     â      â â â
      ///     / /       /    /   /       â â   ââ     â    ââ      â â â
     ///     / /  /    /    /   /         â â   ââ     â    ââ â    â â
    /// /   / /  /    /    /   /           â â  âââ     â â  ââ â    â â
   /// / / / /  /    /   //   /   /         â â  âââ  â  â â  ââ â   ââ
  /// / / / // /    /   //   /   /           â â  âââ  â  â â  ââ â   ââ
 ///// /// // /    //  //   /   //      â     â â  ââ   â  â â  ââ â   â
///// /// // /    //  //   /   //        â     â â  ââ   â  â â  ââââ â
/ // ///  / /    //  //   /   //          â     â â  ââ   â  â â  ââââ â
 // ///  / / /  //  /    /   // /        â â â   â    ââ   â  â â  ââââ
// ///  / / /   /  / /  /   // /          â â â   â    ââ   â  â â  ââââ
/ //   / / /   /  / /  /   // /            â â â   â    ââ   â  â â  âââ
 //   /   /   /  / /  /   // /              â â â   â â   â   â  â â  ââ
//   /   /  //  / /  /   ////                â â â     â   â â â âââ   â
//  /   /  //    /  //   ///           â      â â â     â   â â â âââ
/      // //    /  //   ///     /       â      â â â â   â   â â   âââ
MOVE43000000 ===========================================================
âââ   ââ   â ââ â â  ââ â â ââ    â           /   // / / /   ///   //  /
âââââ  ââ â â ââ âââ  ââ â â â     â         /   // / / /   ///   //
 âââââ  ââ â â ââ âââ  ââ   â â             /   // /   /   ///   //    /
â âââââ  ââ â â ââ âââ  ââ   â â           /   // /   / / ///   ///   /
 â âââ â  ââ â â ââ âââ  ââ   â           /   // /   / / / /   ///   / /
â â âââ â  ââ â â â  âââ   â   â         /   // /   / / / /   ///   / /
 â â â â â  â  â â â  âââ   â   â       /   // /   /// / /  ////   / / /
 ââ â â â â  â  â   â   ââ   â              / /    // /    // /   / / //
  ââ â â â â  â  â   â   ââ   â            / /    // /    // /   /   //
â  ââ â   â â  â  â   â   ââ   â          / /    // /    // /   /   //
 â  ââ â   â â  â  â   â   ââ   â        /      // /    /  /   /   //
â â  ââ â   â â  â  â   â    â          /      //      /  /       /    /
 â â  ââ â   â    â      â    â               //      /  /       /    //
â â â  ââ â   â    â      â    â             //      /  /       /    ///
 â â â  â  â   â    â      â    â           /       /          /    //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /



            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/       / /       /            /         â   ââ     â     â        â
       ///       /       /    /           â   ââ     â     â      â â â
      ///     / /       /    /   /       â â   ââ     â    ââ      â â â
     ///     / /  /    /    /   /         â â   ââ     â    ââ â    â â
    /// /   / /  /    /    /   /           â â  âââ     â â  ââ â    â â
   /// / / / /  /    /   //   /   /         â â  âââ  â  â â  ââ â   ââ
  /// / / / // /    /   //   /   /           â â  âââ  â  â â  ââ â   ââ
 ///// /// // /    //  //   /   //      â     â â  âââ  â  â â  ââ â   â
///// /// // /    //  //   /   //        â     â â  ââ   â  â â  ââââ â
//// /// // /    //  //   /   //          â     â â  ââ   â  â â  ââââ â
 // ///  / / /  //  //   /   // /        â â â   â â  ââ   â  â â  ââââ
// ///  / / /  //  / /  /   // /          â â â   â    ââ   â  â â  ââââ
/ ///  / / /   /  / /  /   // /            â â â   â    ââ   â  â â  âââ
 //   / / /   /  / /  /   // /              â â â   â â  ââ   â  â â  ââ
//   /   /  //  / /  /   ////                â â â   â â   â â â ââââ  â
//  /   /  //  / /  //  ////           â      â â â     â   â â â âââ
/  /   // //    /  //   ///     /       â      â â â â   â   â â â âââ
MOVE43000000 ===========================================================
ââââ  ââ â â ââ âââ  ââ â â ââ    â           /   // / / /// ///  //// /
âââââ  ââ â â ââ âââ  ââ â â â     â         /   // / / /// ///  ////
 âââââ  ââ â â ââ âââ  ââ   â â             /   // /   /// ///  ////   /
â âââââ  ââ â â ââ âââ  ââ   â â           /   // /   /// ///  ////   /
 â âââ â  ââ â â ââ âââ  ââ   â           /   // /   /// / /  ////   / /
â â âââ â  ââ â â â  âââ   â   â         /   // /   /// / /  ////   / /
 â â â â â  â  â â â  âââ   â   â       /   // /   /// / /  ////   / / /
 ââ â â â â  â  â   â   ââ   â              / /    // /    // /   / / //
  ââ â â â â  â  â   â   ââ   â            / /    // /    // /   /   //
â  ââ â   â â  â  â   â   ââ   â          / /    // /    // /   /   //
 â  ââ â   â â  â  â   â   ââ   â        /      // /    /  /   /   //
â â  ââ â   â â  â  â   â    â          /      //      /  /       /    /
 â â  ââ â   â    â      â    â               //      /  /       /    //
â â â  ââ â   â    â      â    â             //      /  /       /    ///
 â â â  â  â   â    â      â    â           /       /          /    //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /



            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/       / /       /            /         â   ââ     â     â        â
       ///       /       /    /           â   ââ     â     â      â â â
      ///     / /       /    /   /       â â   ââ     â    ââ      â â â
     ///     / /  /    /    /   /         â â   ââ     â    ââ â    â â
    /// /   / /  /    /    /   /           â â  âââ     â â  ââ â    â â
   /// / / / /  /    /   //   /   /         â â  âââ  â  â â  ââ â   ââ
  /// / / / // /    /   //   /   /           â â  âââ  â  â â  ââ â   ââ
 ///// /// // /    //  //   /   //      â     â â  âââ  â  â â  ââ â   â
///// /// // /    //  //   /   //        â     â â  âââ  â  â â  ââââ â
//// /// // /    //  //   /   //          â     â â  âââ  â  â â  ââââ â
/// /// // / /  //  //   /   // /        â â â   â â  âââ  â  â â  ââââ
// /// // / /  //  ///  /   // /          â â â   â â  ââ   â  â â  ââââ
/ /// // / /  //  ///  /   // /            â â â   â â  ââ   â  â â  âââ
 ///  / / /  //  ///  /   // /              â â â   â â  ââ   â  â â  ââ
///  / / /  //  / /  /   ////                â â â   â â  ââ â â ââââ  â
//  / / /  //  / /  //  ////           â      â â â   â â  ââ â â ââââ
/  / / // //  / /  //  ////     /       â      â â â â â â  ââ â â ââââ
MOVE43000000 ===========================================================
ââââ  ââ â â ââ âââ  ââ â â ââ    â           /   // / / /// ///  //// /
âââââ  ââ â â ââ âââ  ââ â â â     â         /   // / / /// ///  ////
 âââââ  ââ â â ââ âââ  ââ   â â             /   // /   /// ///  ////   /
â âââââ  ââ â â ââ âââ  ââ   â â           /   // /   /// ///  ////   /
 â âââ â  ââ â â ââ âââ  ââ   â           /   // /   /// / /  ////   / /
â â âââ â  ââ â â â  âââ   â   â         /   // /   /// / /  ////   / /
ââ â â â â  â  â â â  âââ   â   â       /   // /   /// / /  ////   / / /
 ââ â â â â  â  â   â   ââ   â              / /    // /    // /   / / //
  ââ â â â â  â  â   â   ââ   â            / /    // /    // /   /   //
â  ââ â   â â  â  â   â   ââ   â          / /    // /    // /   /   //
 â  ââ â   â â  â  â   â   ââ   â        /      // /    /  /   /   //
â â  ââ â   â â  â  â   â    â          /      //      /  /       /    /
 â â  ââ â   â    â      â    â               //      /  /       /    //
â â â  ââ â   â    â      â    â             //      /  /       /    ///
 â â â  â  â   â    â      â    â           /       /          /    //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /



            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/       / /       /            /         â   ââ     â     â        â
       ///       /       /    /           â   ââ     â     â      â â â
      ///     / /       /    /   /       â â   ââ     â    ââ      â â â
     ///     / /  /    /    /   /         â â   ââ     â    ââ â    â â
    /// /   / /  /    /    /   /           â â  âââ     â â  ââ â    â â
   /// / / / /  /    /   //   /   /         â â  âââ  â  â â  ââ â   ââ
  /// / / / // /    /   //   /   /           â â  âââ  â  â â  ââ â   ââ
 ///// /// // /    //  //   /   //      â     â â  âââ  â  â â  ââ â   â
///// /// // /    //  //   /   //        â     â â  âââ  â  â â  ââââ â
//// /// // /    //  //   /   //          â     â â  âââ  â  â â  ââââ â
/// /// // / /  //  //   /   // /        â â â   â â  âââ  â  â â  ââââ
// /// // / /  //  ///  /   // /          â â â   â â  âââ  â  â â  ââââ
/ /// // / /  //  ///  /   // /            â â â   â â  âââ  â  â â  âââ
 /// // / /  //  ///  /   // /              â â â   â â  âââ  â  â â  ââ
/// // / /  //  ///  /   ////                â â â   â â  ââââ â ââââ  â
// // / /  //  ///  //  ////           â      â â â   â â  ââââ â ââââ
/ // / // //  ///  //  ////     /       â      â â â â â â  ââââ â ââââ
MOVE43000000 ===========================================================
ââââ  ââ â â ââ âââ  ââ   â â                 /   // /   /// ///  ////
âââ â  ââ â â ââ âââ  ââ   â                 /   // /   /// / /  ////
 âââ â  ââ â â â  âââ   â   â               /   // /   /// / /  ////   /
â â â â  â  â â â  âââ   â   â             /   // /   /// / /  ////   /
 â â â â  â  â   â   ââ   â                    / /    // /    // /   / /
â â â â â  â  â   â   ââ   â                  / /    // /    // /   /
ââ â   â â  â  â   â   ââ   â                / /    // /    // /   /   /
 ââ â   â â  â  â   â   ââ   â              /      // /    /  /   /   //
  ââ â   â â  â  â   â    â                /      //      /  /       /
â  ââ â   â    â      â    â                     //      /  /       /
 â  ââ â   â    â      â    â                   //      /  /       /
â â  â  â   â    â      â    â                 /       /          /    /
 â    â  â   â    â      â    â               /       /          /    //
â â    â                                     /       /          /     /
   â    â                                                      /     /
                                                              /









         /
/       /                                     â
       /                                       â                    â
      / /       /            /                  â           â        â
     / /       /            /               â   ââ     â     â        â
    ///       /       /    /                 â   ââ     â     â      â â
   ///     / /       /    /   /             â â   ââ     â    ââ      â
  ///     / /  /    /    /   /               â â   ââ     â    ââ â    â
 /// /   / /  /    /    /   /                 â â  âââ     â â  ââ â
/// / / / /  /    /   //   /   /               â â  âââ  â  â â  ââ â
// / / / // /    /   //   /   /                 â â  âââ  â  â â  ââ â
/// /// // /    //  //   /   //            â     â â  âââ  â  â â  ââ â
// /// // /    //  //   /   //              â     â â  âââ  â  â â  ââââ
/ /// // /    //  //   /   //                â     â â  âââ  â  â â  âââ
 /// // / /  //  //   /   // /              â â â   â â  âââ  â  â â  ââ
/// // / /  //  ///  /   // /                â â â   â â  ââââ â  â â  â
// // / /  //  ///  /   // /                  â â â   â â  ââââ â  â â
/ // / // //  ///  /   // /                    â â â   â â  ââââ â  â â
MOVE43000000 ===========================================================
 â â  â  â   â   ââ   â                            / /    // /    // /
  â â  â  â   â   ââ   â                          /      // /    // /
   â â  â  â   â    â                            /      //      /  /
â   â    â      â    â                                 //      /  /
 â   â    â      â    â                               //      /  /
  â   â    â      â    â                             /       /
â  â   â    â      â    â                           /       /          /
 â                                                 /                  /
  â                                                                  /
                                                                    /





















   /
  /                                                 â
 /                                                   â
/ /       /            /                              â           â
 /       /            /                           â   ââ     â     â
/       /       /    /                             â   ââ     â     â
     / /       /    /   /                         â â   ââ     â    ââ
    / /  /    /    /   /                           â â   ââ     â    ââ
   / /  /    /    /   /                             â â  âââ     â â  ââ
/ / /  /    /   //   /   /                           â â  âââ  â  â â  â
 / // /    /   //   /   /                             â â  âââ  â  â â
/ // /  / //  //   /   /                         â     â â  âââ  â  â â
MOVE43000150 ===========================================================











































NEWQ43000100 ===========================================================
   .           .        .   .    .    .       .       .      .   .   .
         .   .     .   .          .                         .
    .                     .                    .      .           .
            .     .              .   .   .          .           .   .
     .               .     .
.     .                                        .     .    .    .
          .    .                   .                           .    .
                        .    .           .          .
   .     .        .
 .            .           .         .          .          .     .
        .            .        .
   .                                    .                            .
            .    .                .           .      .           .
                         .                                 .
  .      .      .   .                   .
            .         .         .              .     .    .       .
      .        .          .  .
                                   .   .                     .
         .   .     .    .    .             .                       .
    .                         .                         .
                  .                 .       .   .           .
  .     .    .                          .                     .     .
                        .                            .
    .                          .     .     .    .
          .       .                                      .
                          .                                    .     .
 .      .     .       .         .                  .     .       .
                                     .     .
           .      .                                      .             .
    .                     .                         .       .    .
 .      .                       .     .   .    .                      .
           .  .                                      .
   .                  .                    .                .
          .      .                                .      .        .
    .  .      .            .       .                                  .
           .                                           .
                              .            .      .           .
 .      .          .                 .                             .
              .             .                     .     .  .    .
                                  .      .     .                      .
           .           .             .                             .
                             .                       .        .
                 .
REDA43000000 ===========================================================











                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /                                                       â
          +                                                         +
           â                                                       /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------











REDA43000000 ===========================================================











                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           />>                                                   <<â
          + >>>                                                 <<< +
           â>>                                                   <</
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------











REDA43000000 ===========================================================











                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /   >>                                             <<   â
          +    >>>                                           <<<    +
           â   >>                                             <<   /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------











REDA43000000 ===========================================================











                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /      >>                                       <<      â
          +       >>>                                     <<<       +
           â      >>                                       <<      /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------











REDA43000000 ===========================================================











                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /         >>                                 <<         â
          +          >>>                               <<<          +
           â         >>                                 <<         /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------











REDA43000000 ===========================================================











                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /            >>                           <<            â
          +             >>>                         <<<             +
           â            >>                           <<            /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------











REDA43000000 ===========================================================











                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /               >>                     <<               â
          +                >>>                   <<<                +
           â               >>                     <<               /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------











REDA43000000 ===========================================================











                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /                  >>               <<                  â
          +                   >>>             <<<                   +
           â                  >>               <<                  /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------











REDA43000000 ===========================================================











                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /                     >>         <<                     â
          +                      >>>       <<<                      +
           â                     >>         <<                     /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------











REDA43000000 ===========================================================











                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /                        >>   <<                        â
          +                         >>> <<<                         +
           â                        >>   <<                        /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------











REDA43000000 ===========================================================











                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /                                                       â
          +                                                         +
           â                                                       /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------











REDB43000000 ===========================================================











                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /                                                       â
          +                                                         +
           â                                                       /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------
                        B A T T L E     S T A T I O N S










REDB43000000 ===========================================================











                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           />>                                                   <<â
          + >>>                                                 <<< +
           â>>                                                   <</
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------
                        B A T T L E     S T A T I O N S










REDB43000000 ===========================================================











                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /   >>                                             <<   â
          +    >>>                                           <<<    +
           â   >>                                             <<   /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------
                        B A T T L E     S T A T I O N S










REDB43000000 ===========================================================











                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /      >>                                       <<      â
          +       >>>                                     <<<       +
           â      >>                                       <<      /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------
                        B A T T L E     S T A T I O N S










REDB43000000 ===========================================================











                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /         >>                                 <<         â
          +          >>>                               <<<          +
           â         >>                                 <<         /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------
                        B A T T L E     S T A T I O N S










REDB43000000 ===========================================================











                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /            >>                           <<            â
          +             >>>                         <<<             +
           â            >>                           <<            /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------
                        B A T T L E     S T A T I O N S










REDB43000000 ===========================================================











                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /               >>                     <<               â
          +                >>>                   <<<                +
           â               >>                     <<               /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------
                        B A T T L E     S T A T I O N S










REDB43000000 ===========================================================











                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /                  >>               <<                  â
          +                   >>>             <<<                   +
           â                  >>               <<                  /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------
                        B A T T L E     S T A T I O N S










REDB43000000 ===========================================================











                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /                     >>         <<                     â
          +                      >>>       <<<                      +
           â                     >>         <<                     /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------
                        B A T T L E     S T A T I O N S










REDB43000000 ===========================================================











                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /                        >>   <<                        â
          +                         >>> <<<                         +
           â                        >>   <<                        /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------
                        B A T T L E     S T A T I O N S










REDB43000000 ===========================================================











                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /                                                       â
          +                                                         +
           â                                                       /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------
                        B A T T L E     S T A T I O N S










INTR43000300 ===========================================================
                    .   .                 .    .          .     .   .
  .     .   .                 .                             .         .
                  .       .         .                .
  .                                        .      .              .
      .   .      .    .         .                         .            .
                   .      .          .
      .      .                          .    .
  .               .    . .       .     .   .      .     .    .
     .                                                             .
        .
           .    .      .                   .             .
      .                     .    .                .           .    .
               .     .                 .

   .     .                                   .         .       .      .
      .
             .   .    .      .    .                               .
    .                                    .       .
       .    .                                                    .    .
                                                          .
                  .      .      .              .     .             .
             .
    .                                     .
                                                                .    .
            .       .            .                      .
                                        .   .      .
         .                .                                      .   .
               .                  .     .                 .
                   .                                          .
         .                                     .         .
          .               .        .                 .              .
   .          .                                                .
     .   .     .     .            .    .     .            .
    .                                               .             .  .
                           .
          .   .                  .      .   .
                      .                                .
   .                                                                .  .
                                     .               .
             .              .                               .   . .
  .                   .               .
         .                       .                  .              .
                                                           .
INTR43000000 ===========================================================
 â     â   â    â       â    â    â                    /     /         /
â                â       â         â         /      / /            /
 â  â   â      â    â         â             /      /        /     /
     â   â      ââ   â  â      â                           /
    â      â      â      â                /    /
â    â      â   â    â â       â         /   //     /     /    /
 â â             â    â â       â       /   /      /     /    /      /
    â â                                                             /
       â â    â      â                       /             /
    â     â    â      â   â    â            /       /     /     /    /
     â       â     â       â    â        /         /           /    /
              â     â                   /
 â     â                                       /         /       /
  â â   â                                     /         /       /      /
     â     â   â    â      â    â                                   /
  â         â   â    â      â    â         /       /               /
   â â    â                               /       /                /
      â    â                                                /     /    /
                                                           /



            /
   /       /                               â
  /                                         â                    â    â
           /       /            /                        â        â    â
          /       /            /         â   â      â     â
        /                /                â   â      â            â   â
       /      /         /        /       â                 â       â   â
             /    /             /         â                 â  â
        /        /                              â         â     â
       / /               /        /              â    â    â         â
  /     /    /          /        /                     â        â     â
 /  /   /   / /     /            /      â     â            â     â
   /   /     /     /            /        â     â     â      â      â  â
                          /                           â             â  â
         /   /           /      /        â   â
        /   /        /         /          â   â         â
  /                 /                                    â           â
 /                                                    â               â
            /              /                           â     â   â â
 /         /         /    /            â                      â   â â
/       /           /           /       â            â              â
INTR43000000 ===========================================================
 â     â   â    â       â    â    â           /      / /     /      /  /
â  â   â      â  â â     â   â     â         /      / /      /     /
 â  â   â      ââ   â  â      â             /      /        /     /
   â â   ââ     ââ   â  â      â                /          /
    â      â   â  â â â  â    â           /   //     /     /    /
â â  â      â   â    â â       â         /   //     /     /    /      /
 â â â           â    â â       â       /   /      /     /    /      /
    â â â    â      â                         /             /       /
   â   â â    â      â   â    â              /       /     /     /    /
    â     â â  â  â   â   â    â          / /       /     /     /    /
     â       â     â       â    â        /         /           /    /
â     â       â     â                   /       /         /       /
 â â   â                                       /         /       /
  â â   â â   â    â      â    â              /         /       /    / /
 â   â     â   â    â      â    â           /       /               /
  â â    â  â   â    â      â    â         /       /               //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /



            /
   /       /                               â
  /       /                                 â                    â    â
 /         /       /            /            â           â        â    â
          /       /            /         â   â      â     â        â
        //       /       /    /           â   â      â     â      â   â
       /      /         /        /       â â   â      â    â       â   â
      /      /    /    /        /         â                 â  â    â
        /   /    /             /           â    â         â  â  â
       / /      /        /        /              â    â    â     â   â
  /   / /    /          /        /                â    â    â   â     â
 /  /  //   / /     /  /        //      â     â         â  â     â     â
/  /   /   / /     /            /        â     â     â      â     ââ  â
  /   /     /     /       /    /          â     â     â      â      â  â
         /   /           /      /        â   â         â             â
        /   /        /  /      /          â   â         â
  /    /   /        /         /            â   â         â           â
 /                 /                                  â   â           â
/           /              /                           â     â   â â   â
 /         /         /    /            â                â     â   â â
/       / /         /    /      /       â            â         â   âââ
INTR43000000 ===========================================================
 ââ   ââ   â â  â â     â   ââ    â           /      / /     //     /  /
â  â   â      ââ â â  â  â   â     â         /      / /      /     /
 ââ â   ââ     ââ   â  â      â             /    / /        /     /
   â â   ââ   â ââ â â  â    â â           /   //     /    //    /
 â  â      â   â  â â â  â    â           /   //     /     /    /      /
â â ââ      â   â    â â       â         /   //     /     /    /      /
 â â â â    â    â â  â â       â       /   /  /   /     /   //      /
  â â â â    â      â   â    â                /       /     /     / /  /
   â   â â â  â  â   â   â    â            / /       /     /     /    /
    â     â â  â  â   â   â    â          / /       /     /     /    /
     â       â     â       â    â        /       / /       /   /   //
â â   â       â     â                   /       /         /       /
 â â   â â   â    â      â    â                /         /       /    /
â â â   â â   â    â      â    â             //      /  /       /    / /
 â â â  â  â   â    â      â    â           /       /               //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /



            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/         /       /            /         â   ââ     â     â        â
        //       /       /    /           â   â      â     â      â â â
       //     / /       /    /   /       â â   â      â    ââ      â   â
      /      /    /    /        /         â â   â      â    â  â    â
     /  /   /    /    /        /           â    â         â  â  â    â
       / / /    /        /    /   /         â    â    â    â  â  â   â
  /   / /    / /        /    /   /                â    â    â   â â   â
 /  // //   / /     /  /        //      â     â    â    â  â â   â     â
/  /  //   / /     /  /        //        â     â     â   â  â     ââ  â
  /   /   / /     /       /    /          â     â     â      â     ââ  â
 /   /   /   /   /       /    / /        â â â   â     â      â      â
        /   /        /  /      /          â   â         â             â
  /    /   /        /  /      /            â   â         â           â
 /        /        /         /              â   â     â   â           â
/           /     /        /                           â     â   â â   â
 /         /         /    /            â                â     â   â â
/       / /         /    /      /       â            â   â     â   âââ
INTR43000000 ===========================================================
 ââ   ââ   â ââ â â  â  â   ââ    â           /      / /     //     /  /
ââ â   ââ     ââ â â  â  â   â     â         /    / / /      /     /
 ââ â   ââ   â ââ â â  â    â â             /   // /   /    //    /
â  â â   ââ   â ââ â â  â    â â           /   //     /    //    /
 â ââ      â   â  â â â  â    â           /   //     /     /    /      /
â â âââ    ââ   â â  â â       â         /   // /   /     /   //      /
 â â â â    â    â â  âââ   â   â       /   /  /   /   / /   //    / /
  â â â â â  â  â   â   â    â              / /       /     /     / /  /
   â   â â â  â  â   â   â    â            / /       /     /     /    /
    â     â â  â  â   â   â    â          / /     / /     / /   /   //
 â   â       â     â       â    â        /       / /       /   /   //
â â   â â   â â  â  â   â    â          /       /         /       /    /
 â â   â â   â    â      â    â               //      /  /       /    /
â â â  ââ â   â    â      â    â             //      /  /       /    ///
 â â â  â  â   â    â      â    â           /       /          /    //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /



            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/       / /       /            /         â   ââ     â     â        â
        //       /       /    /           â   ââ     â     â      â â â
       //     / /       /    /   /       â â   â      â    ââ      â â â
      //     / /  /    /    /   /         â â   â      â    ââ â    â
     /  /   /    /    /        /           â â  ââ      â â  â  â    â
    /  / / /    /    /   /    /   /         â    â    â    â  â  â   ââ
  /   / / /  / /        /    /   /           â    â    â    â  ââ â   â
 /  // //   / /     /  /        //      â     â    â    â  â â   â â   â
/  // //   / /     /  /        //        â     â    ââ   â  â â   ââ  â
  /  //   / /     /  /    /   //          â     â     â   â  â     ââ  â
 /   /   /   /   /       /    / /        â â â   â     â      â     ââ
/   /   /   /   /    /  /    / /          â â â         â      â      â
  /    /   /        /  /      /            â   â         â           â â
 /        /        /  /      /              â   â     â   â           â
/        /  /     /        //                â   â     â     â   â â   â
 /         /     /   /    /            â                â     â   â â
/       / /         /    /      /       â            â   â     â   âââ
INTR43000000 ===========================================================
 ââ   ââ   â ââ â â  â  â   ââ    â           /    / / /     //     /  /
ââ â   ââ   â ââ â â  â  â â â     â         /   // / / /    //    /
 ââ â   ââ   â ââ â â  â    â â             /   // /   /    //    /
â ââ â   ââ   â ââ â â  â    â â           /   //     /    //    /
 â âââ    ââ   â ââ â â  â    â           /   // /   /     /   //      /
â â âââ    ââ   â â  âââ   â   â         /   // /   /   / /   //    / /
 â â â â â  â  â â â  âââ   â   â       /   // /   /   / /   //    / /
  â â â â â  â  â   â   â    â              / /       /     /     / /  /
   â   â â â  â  â   â   â    â            / /     / /     / /   /    /
â   â     â â  â  â   â   â    â          / /     / /     / /   /   //
 â   â â   â â  â  â   â   ââ   â        /       / /       /   /   //
â â   â â   â â  â  â   â    â          /      //      /  /       /    /
 â â  ââ â   â    â      â    â               //      /  /       /    //
â â â  ââ â   â    â      â    â             //      /  /       /    ///
 â â â  â  â   â    â      â    â           /       /          /    //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /



            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/       / /       /            /         â   ââ     â     â        â
       ///       /       /    /           â   ââ     â     â      â â â
       //     / /       /    /   /       â â   ââ     â    ââ      â â â
      //     / /  /    /    /   /         â â   â      â    ââ â    â â
     // /   / /  /    /    /   /           â â  ââ      â â  ââ â    â
    /  / / /    /    /   /    /   /         â â  ââ   â  â â  â  â   ââ
  //  / / /  / /    /   /    /   /           â    â    â    â  ââ â   ââ
 /  // ///  / /     /  /    /   //      â     â    â    â  â â  ââ â   â
/  // //   / /     /  /        //        â     â    ââ   â  â â   âââ â
  // //   / /     /  /    /   //          â     â    ââ   â  â â   ââ  â
 /  //   /   /   /  /    /   // /        â â â   â     â   â  â     ââ
/   /   /   /   /    /  /    / /          â â â         â      â      â
  /    /   /   /    /  /    / /            â â â         â      â    â â
 /        /        /  /      /              â   â     â   â           â
/        /  /     /  /     //                â   â     â     â   â â   â
 /      /  /     /   /    //           â      â   â     â     â   â â
/       / /         /    /      /       â            â   â     â   âââ
INTR43000000 ===========================================================
 ââ   ââ   â ââ â â  â  â â ââ    â           /   // / / /   ///    /  /
ââ â   ââ   â ââ â â  â  â â â     â         /   // / / /    //    /
 ââ â   ââ   â ââ â â  â    â â             /   // /   /    //    /
â ââââ   ââ   â ââ â â  â    â â           /   // /   /    //   //
 â âââ    ââ   â ââ âââ  ââ   â           /   // /   /   / /   //    / /
â â âââ â  ââ â â â  âââ   â   â         /   // /   /   / /   //    / /
 â â â â â  â  â â â  âââ   â   â       /   // /   /   / /   //    / /
  â â â â â  â  â   â   â    â              / /     / /     / /   / /  /
   â   â â â  â  â   â   â    â            / /     / /     / /   /   //
â   â â   â â  â  â   â   ââ   â          / /     / /     / /   /   //
 â   â â   â â  â  â   â   ââ   â        /      // /    /  /   /   //
â â  ââ â   â â  â  â   â    â          /      //      /  /       /    /
 â â  ââ â   â    â      â    â               //      /  /       /    //
â â â  ââ â   â    â      â    â             //      /  /       /    ///
 â â â  â  â   â    â      â    â           /       /          /    //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /



            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/       / /       /            /         â   ââ     â     â        â
       ///       /       /    /           â   ââ     â     â      â â â
      ///     / /       /    /   /       â â   ââ     â    ââ      â â â
      //     / /  /    /    /   /         â â   ââ     â    ââ â    â â
     // /   / /  /    /    /   /           â â  ââ      â â  ââ â    â â
    // / / / /  /    /   //   /   /         â â  ââ   â  â â  ââ â   ââ
  //  / / /  / /    /   //   /   /           â â  ââ   â  â â  ââ â   ââ
 /  // ///  / /    //  /    /   //      â     â    â    â  â â  ââ â   â
/  // ///  / /     /  /    /   //        â     â    ââ   â  â â  ââââ â
  // //   / /     /  /    /   //          â     â    ââ   â  â â   ââ  â
 // //   /   /   /  /    /   // /        â â â   â    ââ   â  â â   ââ
/  //   /   /   /  / /  /   // /          â â â         â   â  â      â
  /    /   /   /    /  /    / /            â â â         â      â    â â
 /        /   /    /  /    / /              â â â     â   â           â
/        /  /     /  /     //                â   â     â   â â   â â   â
 /      /  /     /   /    //           â      â   â     â     â   â â
/      // /     /   /    //     /       â      â   â â   â     â   âââ
INTR43000000 ===========================================================
âââ   ââ   â ââ â â  â  â â ââ    â           /   // / / /   ///    /  /
ââ â   ââ   â ââ â â  â  â â â     â         /   // / / /    //    /
 ââââ   ââ   â ââ â â  â    â â             /   // /   /    //   //
â ââââ   ââ   â ââ â â  ââ   â â           /   // /   /   ///   //    /
 â âââ â  ââ â â ââ âââ  ââ   â           /   // /   /   / /   //    / /
â â âââ â  ââ â â â  âââ   â   â         /   // /   /   / /   //    / /
 â â â â â  â  â â â  âââ   â   â       /   // /   / / / /   ///   / /
  â â â â â  â  â   â   â    â              / /     / /     / /   / / //
   â â â â â  â  â   â   ââ   â            / /     / /     / /   /   //
â   â â   â â  â  â   â   ââ   â          / /    // /    // /   /   //
 â  ââ â   â â  â  â   â   ââ   â        /      // /    /  /   /   //
â â  ââ â   â â  â  â   â    â          /      //      /  /       /    /
 â â  ââ â   â    â      â    â               //      /  /       /    //
â â â  ââ â   â    â      â    â             //      /  /       /    ///
 â â â  â  â   â    â      â    â           /       /          /    //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /



            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/       / /       /            /         â   ââ     â     â        â
       ///       /       /    /           â   ââ     â     â      â â â
      ///     / /       /    /   /       â â   ââ     â    ââ      â â â
     ///     / /  /    /    /   /         â â   ââ     â    ââ â    â â
     // /   / /  /    /    /   /           â â  âââ     â â  ââ â    â â
    // / / / /  /    /   //   /   /         â â  ââ   â  â â  ââ â   ââ
  /// / / / // /    /   //   /   /           â â  ââ   â  â â  ââ â   ââ
 // // ///  / /    //  //   /   //      â     â â  ââ   â  â â  ââ â   â
// // ///  / /    //  /    /   //        â     â    ââ   â  â â  ââââ â
  // ///  / /     /  /    /   //          â     â    ââ   â  â â  ââââ â
 // //   / / /   /  /    /   // /        â â â   â    ââ   â  â â   âââ
// //   /   /   /  / /  /   // /          â â â   â    ââ   â  â â   ââ
  //   /   /   /  / /  /   // /            â â â         â   â  â    â â
 //   /   /   /    /  /    / /              â â â     â   â      â    â
//       /  //    /  /    ///                â â â     â   â â   â â   â
 /      /  /     /  //    //           â      â   â     â   â â   â â
/      // /     /   /    //     /       â      â   â â   â     â   âââ
INTR43000000 ===========================================================
âââ   ââ   â ââ â â  â  â â ââ    â           /   // / / /   ///    /  /
ââââ   ââ   â ââ â â  â  â â â     â         /   // / / /    //   //
 ââââ   ââ   â ââ â â  ââ   â â             /   // /   /   ///   //    /
â âââââ  ââ â â ââ âââ  ââ   â â           /   // /   /   ///   //    /
 â âââ â  ââ â â ââ âââ  ââ   â           /   // /   /   / /   //    / /
â â âââ â  ââ â â â  âââ   â   â         /   // /   / / / /   ///   / /
 â â â â â  â  â â â  âââ   â   â       /   // /   / / / /   ///   / / /
  â â â â â  â  â   â   â    â              / /     / /     / /   / / //
   â â â â â  â  â   â   ââ   â            / /    // /    // /   /   //
â  ââ â   â â  â  â   â   ââ   â          / /    // /    // /   /   //
 â  ââ â   â â  â  â   â   ââ   â        /      // /    /  /   /   //
â â  ââ â   â â  â  â   â    â          /      //      /  /       /    /
 â â  ââ â   â    â      â    â               //      /  /       /    //
â â â  ââ â   â    â      â    â             //      /  /       /    ///
 â â â  â  â   â    â      â    â           /       /          /    //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /



            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/       / /       /            /         â   ââ     â     â        â
       ///       /       /    /           â   ââ     â     â      â â â
      ///     / /       /    /   /       â â   ââ     â    ââ      â â â
     ///     / /  /    /    /   /         â â   ââ     â    ââ â    â â
    /// /   / /  /    /    /   /           â â  âââ     â â  ââ â    â â
    // / / / /  /    /   //   /   /         â â  âââ  â  â â  ââ â   ââ
  /// / / / // /    /   //   /   /           â â  ââ   â  â â  ââ â   ââ
 ///// /// // /    //  //   /   //      â     â â  ââ   â  â â  ââ â   â
// // ///  / /    //  //   /   //        â     â â  ââ   â  â â  ââââ â
/ // ///  / /    //  /    /   //          â     â    ââ   â  â â  ââââ â
 // ///  / / /   /  /    /   // /        â â â   â    ââ   â  â â  ââââ
// //   / / /   /  / /  /   // /          â â â   â    ââ   â  â â   âââ
/ //   /   /   /  / /  /   // /            â â â   â     â   â  â â  âââ
 //   /   /   /  / /  /   // /              â â â     â   â   â  â    â
//   /   /  //    /  /    ///                â â â     â   â â   âââ   â
//      /  //    /  //   ///           â      â â â     â   â â   â â
/      // /     /  //    //     /       â      â   â â   â   â â   âââ
INTR43000000 ===========================================================
âââ   ââ   â ââ â â  â  â â ââ    â           /   // / / /   ///   //  /
ââââ   ââ   â ââ â â  ââ â â â     â         /   // / / /   ///   //
 âââââ  ââ â â ââ âââ  ââ   â â             /   // /   /   ///   //    /
â âââââ  ââ â â ââ âââ  ââ   â â           /   // /   /   ///   //    /
 â âââ â  ââ â â ââ âââ  ââ   â           /   // /   / / / /   ///   / /
â â âââ â  ââ â â â  âââ   â   â         /   // /   / / / /   ///   / /
 â â â â â  â  â â â  âââ   â   â       /   // /   / / / /   ///   / / /
  â â â â â  â  â   â   â    â              / /    // /    // /   / / //
  ââ â â â â  â  â   â   ââ   â            / /    // /    // /   /   //
â  ââ â   â â  â  â   â   ââ   â          / /    // /    // /   /   //
 â  ââ â   â â  â  â   â   ââ   â        /      // /    /  /   /   //
â â  ââ â   â â  â  â   â    â          /      //      /  /       /    /
 â â  ââ â   â    â      â    â               //      /  /       /    //
â â â  ââ â   â    â      â    â             //      /  /       /    ///
 â â â  â  â   â    â      â    â           /       /          /    //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /



            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/       / /       /            /         â   ââ     â     â        â
       ///       /       /    /           â   ââ     â     â      â â â
      ///     / /       /    /   /       â â   ââ     â    ââ      â â â
     ///     / /  /    /    /   /         â â   ââ     â    ââ â    â â
    /// /   / /  /    /    /   /           â â  âââ     â â  ââ â    â â
   /// / / / /  /    /   //   /   /         â â  âââ  â  â â  ââ â   ââ
  /// / / / // /    /   //   /   /           â â  âââ  â  â â  ââ â   ââ
 ///// /// // /    //  //   /   //      â     â â  ââ   â  â â  ââ â   â
///// /// // /    //  //   /   //        â     â â  ââ   â  â â  ââââ â
/ // ///  / /    //  //   /   //          â     â â  ââ   â  â â  ââââ â
 // ///  / / /  //  /    /   // /        â â â   â    ââ   â  â â  ââââ
// ///  / / /   /  / /  /   // /          â â â   â    ââ   â  â â  ââââ
/ //   / / /   /  / /  /   // /            â â â   â    ââ   â  â â  âââ
 //   /   /   /  / /  /   // /              â â â   â â   â   â  â â  ââ
//   /   /  //  / /  /   ////                â â â     â   â â â âââ   â
//  /   /  //    /  //   ///           â      â â â     â   â â â âââ
/      // //    /  //   ///     /       â      â â â â   â   â â   âââ
INTR43000000 ===========================================================
âââ   ââ   â ââ â â  ââ â â ââ    â           /   // / / /   ///   //  /
âââââ  ââ â â ââ âââ  ââ â â â     â         /   // / / /   ///   //
 âââââ  ââ â â ââ âââ  ââ   â â             /   // /   /   ///   //    /
â âââââ  ââ â â ââ âââ  ââ   â â           /   // /   / / ///   ///   /
 â âââ â  ââ â â ââ âââ  ââ   â           /   // /   / / / /   ///   / /
â â âââ â  ââ â â â  âââ   â   â         /   // /   / / / /   ///   / /
 â â â â â  â  â â â  âââ   â   â       /   // /   /// / /  ////   / / /
 ââ â â â â  â  â   â   ââ   â              / /    // /    // /   / / //
  ââ â â â â  â  â   â   ââ   â            / /    // /    // /   /   //
â  ââ â   â â  â  â   â   ââ   â          / /    // /    // /   /   //
 â  ââ â   â â  â  â   â   ââ   â        /      // /    /  /   /   //
â â  ââ â   â â  â  â   â    â          /      //      /  /       /    /
 â â  ââ â   â    â      â    â               //      /  /       /    //
â â â  ââ â   â    â      â    â             //      /  /       /    ///
 â â â  â  â   â    â      â    â           /       /          /    //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /



            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/       / /       /            /         â   ââ     â     â        â
       ///       /       /    /           â   ââ     â     â      â â â
      ///     / /       /    /   /       â â   ââ     â    ââ      â â â
     ///     / /  /    /    /   /         â â   ââ     â    ââ â    â â
    /// /   / /  /    /    /   /           â â  âââ     â â  ââ â    â â
   /// / / / /  /    /   //   /   /         â â  âââ  â  â â  ââ â   ââ
  /// / / / // /    /   //   /   /           â â  âââ  â  â â  ââ â   ââ
 ///// /// // /    //  //   /   //      â     â â  âââ  â  â â  ââ â   â
///// /// // /    //  //   /   //        â     â â  ââ   â  â â  ââââ â
//// /// // /    //  //   /   //          â     â â  ââ   â  â â  ââââ â
 // ///  / / /  //  //   /   // /        â â â   â â  ââ   â  â â  ââââ
// ///  / / /  //  / /  /   // /          â â â   â    ââ   â  â â  ââââ
/ ///  / / /   /  / /  /   // /            â â â   â    ââ   â  â â  âââ
 //   / / /   /  / /  /   // /              â â â   â â  ââ   â  â â  ââ
//   /   /  //  / /  /   ////                â â â   â â   â â â ââââ  â
//  /   /  //  / /  //  ////           â      â â â     â   â â â âââ
/  /   // //    /  //   ///     /       â      â â â â   â   â â â âââ
INTR43000000 ===========================================================
ââââ  ââ â â ââ âââ  ââ â â ââ    â           /   // / / /// ///  //// /
âââââ  ââ â â ââ âââ  ââ â â â     â         /   // / / /// ///  ////
 âââââ  ââ â â ââ âââ  ââ   â â             /   // /   /// ///  ////   /
â âââââ  ââ â â ââ âââ  ââ   â â           /   // /   /// ///  ////   /
 â âââ â  ââ â â ââ âââ  ââ   â           /   // /   /// / /  ////   / /
â â âââ â  ââ â â â  âââ   â   â         /   // /   /// / /  ////   / /
 â â â â â  â  â â â  âââ   â   â       /   // /   /// / /  ////   / / /
 ââ â â â â  â  â   â   ââ   â              / /    // /    // /   / / //
  ââ â â â â  â  â   â   ââ   â            / /    // /    // /   /   //
â  ââ â   â â  â  â   â   ââ   â          / /    // /    // /   /   //
 â  ââ â   â â  â  â   â   ââ   â        /      // /    /  /   /   //
â â  ââ â   â â  â  â   â    â          /      //      /  /       /    /
 â â  ââ â   â    â      â    â               //      /  /       /    //
â â â  ââ â   â    â      â    â             //      /  /       /    ///
 â â â  â  â   â    â      â    â           /       /          /    //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /



            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/       / /       /            /         â   ââ     â     â        â
       ///       /       /    /           â   ââ     â     â      â â â
      ///     / /       /    /   /       â â   ââ     â    ââ      â â â
     ///     / /  /    /    /   /         â â   ââ     â    ââ â    â â
    /// /   / /  /    /    /   /           â â  âââ     â â  ââ â    â â
   /// / / / /  /    /   //   /   /         â â  âââ  â  â â  ââ â   ââ
  /// / / / // /    /   //   /   /           â â  âââ  â  â â  ââ â   ââ
 ///// /// // /    //  //   /   //      â     â â  âââ  â  â â  ââ â   â
///// /// // /    //  //   /   //        â     â â  âââ  â  â â  ââââ â
//// /// // /    //  //   /   //          â     â â  âââ  â  â â  ââââ â
/// /// // / /  //  //   /   // /        â â â   â â  âââ  â  â â  ââââ
// /// // / /  //  ///  /   // /          â â â   â â  ââ   â  â â  ââââ
/ /// // / /  //  ///  /   // /            â â â   â â  ââ   â  â â  âââ
 ///  / / /  //  ///  /   // /              â â â   â â  ââ   â  â â  ââ
///  / / /  //  / /  /   ////                â â â   â â  ââ â â ââââ  â
//  / / /  //  / /  //  ////           â      â â â   â â  ââ â â ââââ
/  / / // //  / /  //  ////     /       â      â â â â â â  ââ â â ââââ
INTR43000000 ===========================================================
ââââ  ââ â â ââ âââ  ââ â â ââ    â           /   // / / /// ///  //// /
âââââ  ââ â â ââ âââ  ââ â â â     â         /   // / / /// ///  ////
 âââââ  ââ â â ââ âââ  ââ   â â             /   // /   /// ///  ////   /
â âââââ  ââ â â ââ âââ  ââ   â â           /   // /   /// ///  ////   /
 â âââ â  ââ â â ââ âââ  ââ   â           /   // /   /// / /  ////   / /
â â âââ â  ââ â â â  âââ   â   â         /   // /   /// / /  ////   / /
ââ â â â â  â  â â â  âââ   â   â       /   // /   /// / /  ////   / / /
 ââ â â â â  â  â   â   ââ   â              / /    // /    // /   / / //
  ââ â â â â  â  â   â   ââ   â            / /    // /    // /   /   //
â  ââ â   â â  â  â   â   ââ   â          / /    // /    // /   /   //
 â  ââ â   â â  â  â   â   ââ   â        /      // /    /  /   /   //
â â  ââ â   â â  â  â   â    â          /      //      /  /       /    /
 â â  ââ â   â    â      â    â               //      /  /       /    //
â â â  ââ â   â    â      â    â             //      /  /       /    ///
 â â â  â  â   â    â      â    â           /       /          /    //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /



            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/       / /       /            /         â   ââ     â     â        â
       ///       /       /    /           â   ââ     â     â      â â â
      ///     / /       /    /   /       â â   ââ     â    ââ      â â â
     ///     / /  /    /    /   /         â â   ââ     â    ââ â    â â
    /// /   / /  /    /    /   /           â â  âââ     â â  ââ â    â â
   /// / / / /  /    /   //   /   /         â â  âââ  â  â â  ââ â   ââ
  /// / / / // /    /   //   /   /           â â  âââ  â  â â  ââ â   ââ
 ///// /// // /    //  //   /   //      â     â â  âââ  â  â â  ââ â   â
///// /// // /    //  //   /   //        â     â â  âââ  â  â â  ââââ â
//// /// // /    //  //   /   //          â     â â  âââ  â  â â  ââââ â
/// /// // / /  //  //   /   // /        â â â   â â  âââ  â  â â  ââââ
// /// // / /  //  ///  /   // /          â â â   â â  âââ  â  â â  ââââ
/ /// // / /  //  ///  /   // /            â â â   â â  âââ  â  â â  âââ
 /// // / /  //  ///  /   // /              â â â   â â  âââ  â  â â  ââ
/// // / /  //  ///  /   ////                â â â   â â  ââââ â ââââ  â
// // / /  //  ///  //  ////           â      â â â   â â  ââââ â ââââ
/ // / // //  ///  //  ////     /       â      â â â â â â  ââââ â ââââ
INTR43000000 ===========================================================
ââââ  ââ â â ââ âââ  ââ   â â                 /   // /   /// ///  ////
âââ â  ââ â â ââ âââ  ââ   â                 /   // /   /// / /  ////
 âââ â  ââ â â â  âââ   â   â               /   // /   /// / /  ////   /
â â â â  â  â â â  âââ   â   â             /   // /   /// / /  ////   /
 â â â â  â  â   â   ââ   â                    / /    // /    // /   / /
â â â â â  â  â   â   ââ   â                  / /    // /    // /   /
ââ â   â â  â  â   â   ââ   â                / /    // /    // /   /   /
 ââ â   â â  â  â   â   ââ   â              /      // /    /  /   /   //
  ââ â   â â  â  â   â    â                /      //      /  /       /
â  ââ â   â    â      â    â                     //      /  /       /
 â  ââ â   â    â      â    â                   //      /  /       /
â â  â  â   â    â      â    â                 /       /          /    /
 â    â  â   â    â      â    â               /       /          /    //
â â    â                                     /       /          /     /
   â    â                                                      /     /
                                                              /









         /
/       /                                     â
       /                                       â                    â
      / /       /            /                  â           â        â
     / /       /            /               â   ââ     â     â        â
    ///       /       /    /                 â   ââ     â     â      â â
   ///     / /       /    /   /             â â   ââ     â    ââ      â
  ///     / /  /    /    /   /               â â   ââ     â    ââ â    â
 /// /   / /  /    /    /   /                 â â  âââ     â â  ââ â
/// / / / /  /    /   //   /   /               â â  âââ  â  â â  ââ â
// / / / // /    /   //   /   /                 â â  âââ  â  â â  ââ â
/// /// // /    //  //   /   //            â     â â  âââ  â  â â  ââ â
// /// // /    //  //   /   //              â     â â  âââ  â  â â  ââââ
/ /// // /    //  //   /   //                â     â â  âââ  â  â â  âââ
 /// // / /  //  //   /   // /              â â â   â â  âââ  â  â â  ââ
/// // / /  //  ///  /   // /                â â â   â â  ââââ â  â â  â
// // / /  //  ///  /   // /                  â â â   â â  ââââ â  â â
/ // / // //  ///  /   // /                    â â â   â â  ââââ â  â â
INTR43000000 ===========================================================
 â â  â  â   â   ââ   â                            / /    // /    // /
  â â  â  â   â   ââ   â                          /      // /    // /
   â â  â  â   â    â                            /      //      /  /
â   â    â      â    â                                 //      /  /
 â   â    â      â    â                               //      /  /
  â   â    â      â    â                             /       /
â  â   â    â      â    â                           /       /          /
 â                                                 /                  /
  â                                                                  /
                                                                    /





















   /
  /                                                 â
 /                                                   â
/ /       /            /                              â           â
 /       /            /                           â   ââ     â     â
/       /       /    /                             â   ââ     â     â
     / /       /    /   /                         â â   ââ     â    ââ
    / /  /    /    /   /                           â â   ââ     â    ââ
   / /  /    /    /   /                             â â  âââ     â â  ââ
/ / /  /    /   //   /   /                           â â  âââ  â  â â  â
 / // /    /   //   /   /                             â â  âââ  â  â â
/ // /  / //  //   /   /                         â     â â  âââ  â  â â
INTR43000300 ===========================================================












            K     K L        IIIII  N     N  GGGGG   OOOOO  N     N
            K    K  L          I    NN    N G     G O     O NN    N
            K   K   L          I    N N   N G       O     O N N   N
            KKKK    L          I    N  N  N G       O     O N  N  N
            K   K   L          I    N   N N G   GGG O     O N   N N
            K    K  L          I    N    NN G     G O     O N    NN
            K     K LLLLLLL  IIIII  N     N  GGGGG   OOOOO  N     N


                                       A

                     S P A C E   W A R   A D V E N T U R E


                              W R I T T E N   B Y

                          L A R R Y   W I L L I A M S














MOVE32000100 ===========================================================
                   .      .          .
      .      .                          .    .
  .               .    . .       .     .   .      .     .    .
     .                                                             .
        .
           .    .      .                   .             .
      .                     .    .                .           .    .
               .     .                 .

   .     .                                   .         .       .      .
      .
             .   .    .      .    .                               .
    .                                    .       .
       .    .                                                    .    .
                                                          .
                  .      .      .              .     .             .
    .                                     .
                                                                .    .
            .       .            .                      .
                                        .   .      .
         .                .                                      .   .
               .                  .     .                 .
                   .                                          .
         .                                     .         .
          .               .        .                 .              .
   .          .                                                .
     .   .     .     .            .    .     .            .
    .                                               .             .  .
                           .
          .   .                  .      .   .
                      .                                .
   .                                                                .  .
MOVE32000000 ===========================================================
â    â      â   â    â â       â         /   //     /     /    /
 â â             â    â â       â       /   /      /     /    /      /
    â â                                                             /
       â â    â      â                       /             /
    â     â    â      â   â    â            /       /     /     /    /
     â       â     â       â    â        /         /           /    /
              â     â                   /
 â     â                                       /         /       /
  â â   â                                     /         /       /      /
     â     â   â    â      â    â                                   /
  â         â   â    â      â    â         /       /               /
   â â    â                               /       /                /
      â    â                                                /     /    /
                                                           /


            /
   /       /                               â
  /                                         â                    â    â
           /       /            /                        â        â    â
          /       /            /         â   â      â     â
        /                /                â   â      â            â   â
       /      /         /        /       â                 â       â   â
             /    /             /         â                 â  â
        /        /                              â         â     â
       / /               /        /              â    â    â         â
  /     /    /          /        /                     â        â     â
 /  /   /   / /     /            /      â     â            â     â
   /   /     /     /            /        â     â     â      â      â  â
                          /                           â             â  â
         /   /           /      /        â   â
        /   /        /         /          â   â         â
MOVE32000000 ===========================================================
â â  â      â   â    â â       â         /   //     /     /    /      /
 â â â           â    â â       â       /   /      /     /    /      /
    â â â    â      â                         /             /       /
   â   â â    â      â   â    â              /       /     /     /    /
    â     â â  â  â   â   â    â          / /       /     /     /    /
     â       â     â       â    â        /         /           /    /
â     â       â     â                   /       /         /       /
 â â   â                                       /         /       /
  â â   â â   â    â      â    â              /         /       /    / /
 â   â     â   â    â      â    â           /       /               /
  â â    â  â   â    â      â    â         /       /               //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /


            /
   /       /                               â
  /       /                                 â                    â    â
 /         /       /            /            â           â        â    â
          /       /            /         â   â      â     â        â
        //       /       /    /           â   â      â     â      â   â
       /      /         /        /       â â   â      â    â       â   â
      /      /    /    /        /         â                 â  â    â
        /   /    /             /           â    â         â  â  â
       / /      /        /        /              â    â    â     â   â
  /   / /    /          /        /                â    â    â   â     â
 /  /  //   / /     /  /        //      â     â         â  â     â     â
/  /   /   / /     /            /        â     â     â      â     ââ  â
  /   /     /     /       /    /          â     â     â      â      â  â
         /   /           /      /        â   â         â             â
        /   /        /  /      /          â   â         â
MOVE32000000 ===========================================================
â â ââ      â   â    â â       â         /   //     /     /    /      /
 â â â â    â    â â  â â       â       /   /  /   /     /   //      /
  â â â â    â      â   â    â                /       /     /     / /  /
   â   â â â  â  â   â   â    â            / /       /     /     /    /
    â     â â  â  â   â   â    â          / /       /     /     /    /
     â       â     â       â    â        /       / /       /   /   //
â â   â       â     â                   /       /         /       /
 â â   â â   â    â      â    â                /         /       /    /
â â â   â â   â    â      â    â             //      /  /       /    / /
 â â â  â  â   â    â      â    â           /       /               //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /


            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/         /       /            /         â   ââ     â     â        â
        //       /       /    /           â   â      â     â      â â â
       //     / /       /    /   /       â â   â      â    ââ      â   â
      /      /    /    /        /         â â   â      â    â  â    â
     /  /   /    /    /        /           â    â         â  â  â    â
       / / /    /        /    /   /         â    â    â    â  â  â   â
  /   / /    / /        /    /   /                â    â    â   â â   â
 /  // //   / /     /  /        //      â     â    â    â  â â   â     â
/  /  //   / /     /  /        //        â     â     â   â  â     ââ  â
  /   /   / /     /       /    /          â     â     â      â     ââ  â
 /   /   /   /   /       /    / /        â â â   â     â      â      â
        /   /        /  /      /          â   â         â             â
MOVE32000000 ===========================================================
â â âââ    ââ   â â  â â       â         /   // /   /     /   //      /
 â â â â    â    â â  âââ   â   â       /   /  /   /   / /   //    / /
  â â â â â  â  â   â   â    â              / /       /     /     / /  /
   â   â â â  â  â   â   â    â            / /       /     /     /    /
    â     â â  â  â   â   â    â          / /     / /     / /   /   //
 â   â       â     â       â    â        /       / /       /   /   //
â â   â â   â â  â  â   â    â          /       /         /       /    /
 â â   â â   â    â      â    â               //      /  /       /    /
â â â  ââ â   â    â      â    â             //      /  /       /    ///
 â â â  â  â   â    â      â    â           /       /          /    //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /


            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/       / /       /            /         â   ââ     â     â        â
        //       /       /    /           â   ââ     â     â      â â â
       //     / /       /    /   /       â â   â      â    ââ      â â â
      //     / /  /    /    /   /         â â   â      â    ââ â    â
     /  /   /    /    /        /           â â  ââ      â â  â  â    â
    /  / / /    /    /   /    /   /         â    â    â    â  â  â   ââ
  /   / / /  / /        /    /   /           â    â    â    â  ââ â   â
 /  // //   / /     /  /        //      â     â    â    â  â â   â â   â
/  // //   / /     /  /        //        â     â    ââ   â  â â   ââ  â
  /  //   / /     /  /    /   //          â     â     â   â  â     ââ  â
 /   /   /   /   /       /    / /        â â â   â     â      â     ââ
/   /   /   /   /    /  /    / /          â â â         â      â      â
MOVE32000000 ===========================================================
â â âââ    ââ   â â  âââ   â   â         /   // /   /   / /   //    / /
 â â â â â  â  â â â  âââ   â   â       /   // /   /   / /   //    / /
  â â â â â  â  â   â   â    â              / /       /     /     / /  /
   â   â â â  â  â   â   â    â            / /     / /     / /   /    /
â   â     â â  â  â   â   â    â          / /     / /     / /   /   //
 â   â â   â â  â  â   â   ââ   â        /       / /       /   /   //
â â   â â   â â  â  â   â    â          /      //      /  /       /    /
 â â  ââ â   â    â      â    â               //      /  /       /    //
â â â  ââ â   â    â      â    â             //      /  /       /    ///
 â â â  â  â   â    â      â    â           /       /          /    //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /


            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/       / /       /            /         â   ââ     â     â        â
       ///       /       /    /           â   ââ     â     â      â â â
       //     / /       /    /   /       â â   ââ     â    ââ      â â â
      //     / /  /    /    /   /         â â   â      â    ââ â    â â
     // /   / /  /    /    /   /           â â  ââ      â â  ââ â    â
    /  / / /    /    /   /    /   /         â â  ââ   â  â â  â  â   ââ
  //  / / /  / /    /   /    /   /           â    â    â    â  ââ â   ââ
 /  // ///  / /     /  /    /   //      â     â    â    â  â â  ââ â   â
/  // //   / /     /  /        //        â     â    ââ   â  â â   âââ â
  // //   / /     /  /    /   //          â     â    ââ   â  â â   ââ  â
 /  //   /   /   /  /    /   // /        â â â   â     â   â  â     ââ
/   /   /   /   /    /  /    / /          â â â         â      â      â
MOVE32000000 ===========================================================
â â âââ â  ââ â â â  âââ   â   â         /   // /   /   / /   //    / /
 â â â â â  â  â â â  âââ   â   â       /   // /   /   / /   //    / /
  â â â â â  â  â   â   â    â              / /     / /     / /   / /  /
   â   â â â  â  â   â   â    â            / /     / /     / /   /   //
â   â â   â â  â  â   â   ââ   â          / /     / /     / /   /   //
 â   â â   â â  â  â   â   ââ   â        /      // /    /  /   /   //
â â  ââ â   â â  â  â   â    â          /      //      /  /       /    /
 â â  ââ â   â    â      â    â               //      /  /       /    //
â â â  ââ â   â    â      â    â             //      /  /       /    ///
 â â â  â  â   â    â      â    â           /       /          /    //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /


            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/       / /       /            /         â   ââ     â     â        â
       ///       /       /    /           â   ââ     â     â      â â â
      ///     / /       /    /   /       â â   ââ     â    ââ      â â â
      //     / /  /    /    /   /         â â   ââ     â    ââ â    â â
     // /   / /  /    /    /   /           â â  ââ      â â  ââ â    â â
    // / / / /  /    /   //   /   /         â â  ââ   â  â â  ââ â   ââ
  //  / / /  / /    /   //   /   /           â â  ââ   â  â â  ââ â   ââ
 /  // ///  / /    //  /    /   //      â     â    â    â  â â  ââ â   â
/  // ///  / /     /  /    /   //        â     â    ââ   â  â â  ââââ â
  // //   / /     /  /    /   //          â     â    ââ   â  â â   ââ  â
 // //   /   /   /  /    /   // /        â â â   â    ââ   â  â â   ââ
/  //   /   /   /  / /  /   // /          â â â         â   â  â      â
MOVE32000000 ===========================================================
â â âââ â  ââ â â â  âââ   â   â         /   // /   /   / /   //    / /
 â â â â â  â  â â â  âââ   â   â       /   // /   / / / /   ///   / /
  â â â â â  â  â   â   â    â              / /     / /     / /   / / //
   â â â â â  â  â   â   ââ   â            / /     / /     / /   /   //
â   â â   â â  â  â   â   ââ   â          / /    // /    // /   /   //
 â  ââ â   â â  â  â   â   ââ   â        /      // /    /  /   /   //
â â  ââ â   â â  â  â   â    â          /      //      /  /       /    /
 â â  ââ â   â    â      â    â               //      /  /       /    //
â â â  ââ â   â    â      â    â             //      /  /       /    ///
 â â â  â  â   â    â      â    â           /       /          /    //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /


            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/       / /       /            /         â   ââ     â     â        â
       ///       /       /    /           â   ââ     â     â      â â â
      ///     / /       /    /   /       â â   ââ     â    ââ      â â â
     ///     / /  /    /    /   /         â â   ââ     â    ââ â    â â
     // /   / /  /    /    /   /           â â  âââ     â â  ââ â    â â
    // / / / /  /    /   //   /   /         â â  ââ   â  â â  ââ â   ââ
  /// / / / // /    /   //   /   /           â â  ââ   â  â â  ââ â   ââ
 // // ///  / /    //  //   /   //      â     â â  ââ   â  â â  ââ â   â
// // ///  / /    //  /    /   //        â     â    ââ   â  â â  ââââ â
  // ///  / /     /  /    /   //          â     â    ââ   â  â â  ââââ â
 // //   / / /   /  /    /   // /        â â â   â    ââ   â  â â   âââ
// //   /   /   /  / /  /   // /          â â â   â    ââ   â  â â   ââ
MOVE32000000 ===========================================================
â â âââ â  ââ â â â  âââ   â   â         /   // /   / / / /   ///   / /
 â â â â â  â  â â â  âââ   â   â       /   // /   / / / /   ///   / / /
  â â â â â  â  â   â   â    â              / /     / /     / /   / / //
   â â â â â  â  â   â   ââ   â            / /    // /    // /   /   //
â  ââ â   â â  â  â   â   ââ   â          / /    // /    // /   /   //
 â  ââ â   â â  â  â   â   ââ   â        /      // /    /  /   /   //
â â  ââ â   â â  â  â   â    â          /      //      /  /       /    /
 â â  ââ â   â    â      â    â               //      /  /       /    //
â â â  ââ â   â    â      â    â             //      /  /       /    ///
 â â â  â  â   â    â      â    â           /       /          /    //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /


            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/       / /       /            /         â   ââ     â     â        â
       ///       /       /    /           â   ââ     â     â      â â â
      ///     / /       /    /   /       â â   ââ     â    ââ      â â â
     ///     / /  /    /    /   /         â â   ââ     â    ââ â    â â
    /// /   / /  /    /    /   /           â â  âââ     â â  ââ â    â â
    // / / / /  /    /   //   /   /         â â  âââ  â  â â  ââ â   ââ
  /// / / / // /    /   //   /   /           â â  ââ   â  â â  ââ â   ââ
 ///// /// // /    //  //   /   //      â     â â  ââ   â  â â  ââ â   â
// // ///  / /    //  //   /   //        â     â â  ââ   â  â â  ââââ â
/ // ///  / /    //  /    /   //          â     â    ââ   â  â â  ââââ â
 // ///  / / /   /  /    /   // /        â â â   â    ââ   â  â â  ââââ
// //   / / /   /  / /  /   // /          â â â   â    ââ   â  â â   âââ
MOVE32000000 ===========================================================
â â âââ â  ââ â â â  âââ   â   â         /   // /   / / / /   ///   / /
 â â â â â  â  â â â  âââ   â   â       /   // /   / / / /   ///   / / /
  â â â â â  â  â   â   â    â              / /    // /    // /   / / //
  ââ â â â â  â  â   â   ââ   â            / /    // /    // /   /   //
â  ââ â   â â  â  â   â   ââ   â          / /    // /    // /   /   //
 â  ââ â   â â  â  â   â   ââ   â        /      // /    /  /   /   //
â â  ââ â   â â  â  â   â    â          /      //      /  /       /    /
 â â  ââ â   â    â      â    â               //      /  /       /    //
â â â  ââ â   â    â      â    â             //      /  /       /    ///
 â â â  â  â   â    â      â    â           /       /          /    //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /


            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/       / /       /            /         â   ââ     â     â        â
       ///       /       /    /           â   ââ     â     â      â â â
      ///     / /       /    /   /       â â   ââ     â    ââ      â â â
     ///     / /  /    /    /   /         â â   ââ     â    ââ â    â â
    /// /   / /  /    /    /   /           â â  âââ     â â  ââ â    â â
   /// / / / /  /    /   //   /   /         â â  âââ  â  â â  ââ â   ââ
  /// / / / // /    /   //   /   /           â â  âââ  â  â â  ââ â   ââ
 ///// /// // /    //  //   /   //      â     â â  ââ   â  â â  ââ â   â
///// /// // /    //  //   /   //        â     â â  ââ   â  â â  ââââ â
/ // ///  / /    //  //   /   //          â     â â  ââ   â  â â  ââââ â
 // ///  / / /  //  /    /   // /        â â â   â    ââ   â  â â  ââââ
// ///  / / /   /  / /  /   // /          â â â   â    ââ   â  â â  ââââ
MOVE32000000 ===========================================================
â â âââ â  ââ â â â  âââ   â   â         /   // /   / / / /   ///   / /
 â â â â â  â  â â â  âââ   â   â       /   // /   /// / /  ////   / / /
 ââ â â â â  â  â   â   ââ   â              / /    // /    // /   / / //
  ââ â â â â  â  â   â   ââ   â            / /    // /    // /   /   //
â  ââ â   â â  â  â   â   ââ   â          / /    // /    // /   /   //
 â  ââ â   â â  â  â   â   ââ   â        /      // /    /  /   /   //
â â  ââ â   â â  â  â   â    â          /      //      /  /       /    /
 â â  ââ â   â    â      â    â               //      /  /       /    //
â â â  ââ â   â    â      â    â             //      /  /       /    ///
 â â â  â  â   â    â      â    â           /       /          /    //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /


            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/       / /       /            /         â   ââ     â     â        â
       ///       /       /    /           â   ââ     â     â      â â â
      ///     / /       /    /   /       â â   ââ     â    ââ      â â â
     ///     / /  /    /    /   /         â â   ââ     â    ââ â    â â
    /// /   / /  /    /    /   /           â â  âââ     â â  ââ â    â â
   /// / / / /  /    /   //   /   /         â â  âââ  â  â â  ââ â   ââ
  /// / / / // /    /   //   /   /           â â  âââ  â  â â  ââ â   ââ
 ///// /// // /    //  //   /   //      â     â â  âââ  â  â â  ââ â   â
///// /// // /    //  //   /   //        â     â â  ââ   â  â â  ââââ â
//// /// // /    //  //   /   //          â     â â  ââ   â  â â  ââââ â
 // ///  / / /  //  //   /   // /        â â â   â â  ââ   â  â â  ââââ
// ///  / / /  //  / /  /   // /          â â â   â    ââ   â  â â  ââââ
MOVE32000000 ===========================================================
â â âââ â  ââ â â â  âââ   â   â         /   // /   /// / /  ////   / /
 â â â â â  â  â â â  âââ   â   â       /   // /   /// / /  ////   / / /
 ââ â â â â  â  â   â   ââ   â              / /    // /    // /   / / //
  ââ â â â â  â  â   â   ââ   â            / /    // /    // /   /   //
â  ââ â   â â  â  â   â   ââ   â          / /    // /    // /   /   //
 â  ââ â   â â  â  â   â   ââ   â        /      // /    /  /   /   //
â â  ââ â   â â  â  â   â    â          /      //      /  /       /    /
 â â  ââ â   â    â      â    â               //      /  /       /    //
â â â  ââ â   â    â      â    â             //      /  /       /    ///
 â â â  â  â   â    â      â    â           /       /          /    //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /


            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/       / /       /            /         â   ââ     â     â        â
       ///       /       /    /           â   ââ     â     â      â â â
      ///     / /       /    /   /       â â   ââ     â    ââ      â â â
     ///     / /  /    /    /   /         â â   ââ     â    ââ â    â â
    /// /   / /  /    /    /   /           â â  âââ     â â  ââ â    â â
   /// / / / /  /    /   //   /   /         â â  âââ  â  â â  ââ â   ââ
  /// / / / // /    /   //   /   /           â â  âââ  â  â â  ââ â   ââ
 ///// /// // /    //  //   /   //      â     â â  âââ  â  â â  ââ â   â
///// /// // /    //  //   /   //        â     â â  âââ  â  â â  ââââ â
//// /// // /    //  //   /   //          â     â â  âââ  â  â â  ââââ â
/// /// // / /  //  //   /   // /        â â â   â â  âââ  â  â â  ââââ
// /// // / /  //  ///  /   // /          â â â   â â  ââ   â  â â  ââââ
MOVE32000000 ===========================================================
â â âââ â  ââ â â â  âââ   â   â         /   // /   /// / /  ////   / /
ââ â â â â  â  â â â  âââ   â   â       /   // /   /// / /  ////   / / /
 ââ â â â â  â  â   â   ââ   â              / /    // /    // /   / / //
  ââ â â â â  â  â   â   ââ   â            / /    // /    // /   /   //
â  ââ â   â â  â  â   â   ââ   â          / /    // /    // /   /   //
 â  ââ â   â â  â  â   â   ââ   â        /      // /    /  /   /   //
â â  ââ â   â â  â  â   â    â          /      //      /  /       /    /
 â â  ââ â   â    â      â    â               //      /  /       /    //
â â â  ââ â   â    â      â    â             //      /  /       /    ///
 â â â  â  â   â    â      â    â           /       /          /    //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /


            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/       / /       /            /         â   ââ     â     â        â
       ///       /       /    /           â   ââ     â     â      â â â
      ///     / /       /    /   /       â â   ââ     â    ââ      â â â
     ///     / /  /    /    /   /         â â   ââ     â    ââ â    â â
    /// /   / /  /    /    /   /           â â  âââ     â â  ââ â    â â
   /// / / / /  /    /   //   /   /         â â  âââ  â  â â  ââ â   ââ
  /// / / / // /    /   //   /   /           â â  âââ  â  â â  ââ â   ââ
 ///// /// // /    //  //   /   //      â     â â  âââ  â  â â  ââ â   â
///// /// // /    //  //   /   //        â     â â  âââ  â  â â  ââââ â
//// /// // /    //  //   /   //          â     â â  âââ  â  â â  ââââ â
/// /// // / /  //  //   /   // /        â â â   â â  âââ  â  â â  ââââ
// /// // / /  //  ///  /   // /          â â â   â â  âââ  â  â â  ââââ
MOVE32000000 ===========================================================
â â â â â  â  â   â   ââ   â                  / /    // /    // /   /
ââ â   â â  â  â   â   ââ   â                / /    // /    // /   /   /
 ââ â   â â  â  â   â   ââ   â              /      // /    /  /   /   //
  ââ â   â â  â  â   â    â                /      //      /  /       /
â  ââ â   â    â      â    â                     //      /  /       /
 â  ââ â   â    â      â    â                   //      /  /       /
â â  â  â   â    â      â    â                 /       /          /    /
 â    â  â   â    â      â    â               /       /          /    //
â â    â                                     /       /          /     /
   â    â                                                      /     /
                                                              /








         /
/       /                                     â
       /                                       â                    â
      / /       /            /                  â           â        â
     / /       /            /               â   ââ     â     â        â
    ///       /       /    /                 â   ââ     â     â      â â
   ///     / /       /    /   /             â â   ââ     â    ââ      â
  ///     / /  /    /    /   /               â â   ââ     â    ââ â    â
 /// /   / /  /    /    /   /                 â â  âââ     â â  ââ â
/// / / / /  /    /   //   /   /               â â  âââ  â  â â  ââ â
// / / / // /    /   //   /   /                 â â  âââ  â  â â  ââ â
/// /// // /    //  //   /   //            â     â â  âââ  â  â â  ââ â
// /// // /    //  //   /   //              â     â â  âââ  â  â â  ââââ
MOVE32000000 ===========================================================
â   â    â      â    â                                 //      /  /
 â   â    â      â    â                               //      /  /
  â   â    â      â    â                             /       /
â  â   â    â      â    â                           /       /          /
 â                                                 /                  /
  â                                                                  /
                                                                    /
















   /
  /                                                 â
 /                                                   â
/ /       /            /                              â           â
 /       /            /                           â   ââ     â     â
/       /       /    /                             â   ââ     â     â
     / /       /    /   /                         â â   ââ     â    ââ
    / /  /    /    /   /                           â â   ââ     â    ââ
   / /  /    /    /   /                             â â  âââ     â â  ââ
MOVE32000150 ===========================================================
































NEWQ32000100 ===========================================================
.     .                                        .     .    .    .
          .    .                   .                           .    .
                        .    .           .          .
   .     .        .
 .            .           .         .          .          .     .
        .            .        .
   .                                    .                            .
            .    .                .           .      .           .
                         .                                 .
  .      .      .   .                   .
            .         .         .              .     .    .       .
      .        .          .  .
                                   .   .                     .
         .   .     .    .    .             .                       .
    .                          .                        .
  .     .    .                          .                     .     .
                        .                            .
    .                          .     .     .    .
          .       .                                      .
                          .                                    .     .
 .      .     .       .         .                  .     .       .
                                     .     .
           .      .                                      .             .
    .                     .                         .       .    .
 .      .                       .     .   .    .                      .
           .  .                                      .
   .                  .                    .                .
          .      .                                .      .        .
    .  .      .            .       .                                  .
           .                                           .
                              .            .      .           .
 .      .          .                 .                             .
REDA32000000 ===========================================================





                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /                                                       â
          +                                                         +
           â                                                       /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------






REDA32000000 ===========================================================





                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           />>                                                   <<â
          + >>>                                                 <<< +
           â>>                                                   <</
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------






REDA32000000 ===========================================================





                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /   >>                                             <<   â
          +    >>>                                           <<<    +
           â   >>                                             <<   /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------






REDA32000000 ===========================================================





                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /      >>                                       <<      â
          +       >>>                                     <<<       +
           â      >>                                       <<      /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------






REDA32000000 ===========================================================





                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /         >>                                 <<         â
          +          >>>                               <<<          +
           â         >>                                 <<         /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------






REDA32000000 ===========================================================





                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /            >>                           <<            â
          +             >>>                         <<<             +
           â            >>                           <<            /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------






REDA32000000 ===========================================================





                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /               >>                     <<               â
          +                >>>                   <<<                +
           â               >>                     <<               /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------






REDA32000000 ===========================================================





                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /                  >>               <<                  â
          +                   >>>             <<<                   +
           â                  >>               <<                  /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------






REDA32000000 ===========================================================





                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /                     >>         <<                     â
          +                      >>>       <<<                      +
           â                     >>         <<                     /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------






REDA32000000 ===========================================================





                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /                        >>   <<                        â
          +                         >>> <<<                         +
           â                        >>   <<                        /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------






REDA32000000 ===========================================================





                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /                                                       â
          +                                                         +
           â                                                       /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------






REDB32000000 ===========================================================





                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /                                                       â
          +                                                         +
           â                                                       /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------
                        B A T T L E     S T A T I O N S





REDB32000000 ===========================================================





                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           />>                                                   <<â
          + >>>                                                 <<< +
           â>>                                                   <</
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------
                        B A T T L E     S T A T I O N S





REDB32000000 ===========================================================





                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /   >>                                             <<   â
          +    >>>                                           <<<    +
           â   >>                                             <<   /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------
                        B A T T L E     S T A T I O N S





REDB32000000 ===========================================================





                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /      >>                                       <<      â
          +       >>>                                     <<<       +
           â      >>                                       <<      /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------
                        B A T T L E     S T A T I O N S





REDB32000000 ===========================================================





                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /         >>                                 <<         â
          +          >>>                               <<<          +
           â         >>                                 <<         /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------
                        B A T T L E     S T A T I O N S





REDB32000000 ===========================================================





                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /            >>                           <<            â
          +             >>>                         <<<             +
           â            >>                           <<            /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------
                        B A T T L E     S T A T I O N S





REDB32000000 ===========================================================





                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /               >>                     <<               â
          +                >>>                   <<<                +
           â               >>                     <<               /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------
                        B A T T L E     S T A T I O N S





REDB32000000 ===========================================================





                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /                  >>               <<                  â
          +                   >>>             <<<                   +
           â                  >>               <<                  /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------
                        B A T T L E     S T A T I O N S





REDB32000000 ===========================================================





                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /                     >>         <<                     â
          +                      >>>       <<<                      +
           â                     >>         <<                     /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------
                        B A T T L E     S T A T I O N S





REDB32000000 ===========================================================





                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /                        >>   <<                        â
          +                         >>> <<<                         +
           â                        >>   <<                        /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------
                        B A T T L E     S T A T I O N S





REDB32000000 ===========================================================





                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /                                                       â
          +                                                         +
           â                                                       /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------
                        B A T T L E     S T A T I O N S





INTR32000300 ===========================================================
                   .      .          .
      .      .                          .    .
  .               .    . .       .     .   .      .     .    .
     .                                                             .
        .
           .    .      .                   .             .
      .                     .    .                .           .    .
               .     .                 .

   .     .                                   .         .       .      .
      .
             .   .    .      .    .                               .
    .                                    .       .
       .    .                                                    .    .
                                                          .
                  .      .      .              .     .             .
    .                                     .
                                                                .    .
            .       .            .                      .
                                        .   .      .
         .                .                                      .   .
               .                  .     .                 .
                   .                                          .
         .                                     .         .
          .               .        .                 .              .
   .          .                                                .
     .   .     .     .            .    .     .            .
    .                                               .             .  .
                           .
          .   .                  .      .   .
                      .                                .
   .                                                                .  .
INTR32000000 ===========================================================
â    â      â   â    â â       â         /   //     /     /    /
 â â             â    â â       â       /   /      /     /    /      /
    â â                                                             /
       â â    â      â                       /             /
    â     â    â      â   â    â            /       /     /     /    /
     â       â     â       â    â        /         /           /    /
              â     â                   /
 â     â                                       /         /       /
  â â   â                                     /         /       /      /
     â     â   â    â      â    â                                   /
  â         â   â    â      â    â         /       /               /
   â â    â                               /       /                /
      â    â                                                /     /    /
                                                           /


            /
   /       /                               â
  /                                         â                    â    â
           /       /            /                        â        â    â
          /       /            /         â   â      â     â
        /                /                â   â      â            â   â
       /      /         /        /       â                 â       â   â
             /    /             /         â                 â  â
        /        /                              â         â     â
       / /               /        /              â    â    â         â
  /     /    /          /        /                     â        â     â
 /  /   /   / /     /            /      â     â            â     â
   /   /     /     /            /        â     â     â      â      â  â
                          /                           â             â  â
         /   /           /      /        â   â
        /   /        /         /          â   â         â
INTR32000000 ===========================================================
â â  â      â   â    â â       â         /   //     /     /    /      /
 â â â           â    â â       â       /   /      /     /    /      /
    â â â    â      â                         /             /       /
   â   â â    â      â   â    â              /       /     /     /    /
    â     â â  â  â   â   â    â          / /       /     /     /    /
     â       â     â       â    â        /         /           /    /
â     â       â     â                   /       /         /       /
 â â   â                                       /         /       /
  â â   â â   â    â      â    â              /         /       /    / /
 â   â     â   â    â      â    â           /       /               /
  â â    â  â   â    â      â    â         /       /               //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /


            /
   /       /                               â
  /       /                                 â                    â    â
 /         /       /            /            â           â        â    â
          /       /            /         â   â      â     â        â
        //       /       /    /           â   â      â     â      â   â
       /      /         /        /       â â   â      â    â       â   â
      /      /    /    /        /         â                 â  â    â
        /   /    /             /           â    â         â  â  â
       / /      /        /        /              â    â    â     â   â
  /   / /    /          /        /                â    â    â   â     â
 /  /  //   / /     /  /        //      â     â         â  â     â     â
/  /   /   / /     /            /        â     â     â      â     ââ  â
  /   /     /     /       /    /          â     â     â      â      â  â
         /   /           /      /        â   â         â             â
        /   /        /  /      /          â   â         â
INTR32000000 ===========================================================
â â ââ      â   â    â â       â         /   //     /     /    /      /
 â â â â    â    â â  â â       â       /   /  /   /     /   //      /
  â â â â    â      â   â    â                /       /     /     / /  /
   â   â â â  â  â   â   â    â            / /       /     /     /    /
    â     â â  â  â   â   â    â          / /       /     /     /    /
     â       â     â       â    â        /       / /       /   /   //
â â   â       â     â                   /       /         /       /
 â â   â â   â    â      â    â                /         /       /    /
â â â   â â   â    â      â    â             //      /  /       /    / /
 â â â  â  â   â    â      â    â           /       /               //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /


            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/         /       /            /         â   ââ     â     â        â
        //       /       /    /           â   â      â     â      â â â
       //     / /       /    /   /       â â   â      â    ââ      â   â
      /      /    /    /        /         â â   â      â    â  â    â
     /  /   /    /    /        /           â    â         â  â  â    â
       / / /    /        /    /   /         â    â    â    â  â  â   â
  /   / /    / /        /    /   /                â    â    â   â â   â
 /  // //   / /     /  /        //      â     â    â    â  â â   â     â
/  /  //   / /     /  /        //        â     â     â   â  â     ââ  â
  /   /   / /     /       /    /          â     â     â      â     ââ  â
 /   /   /   /   /       /    / /        â â â   â     â      â      â
        /   /        /  /      /          â   â         â             â
INTR32000000 ===========================================================
â â âââ    ââ   â â  â â       â         /   // /   /     /   //      /
 â â â â    â    â â  âââ   â   â       /   /  /   /   / /   //    / /
  â â â â â  â  â   â   â    â              / /       /     /     / /  /
   â   â â â  â  â   â   â    â            / /       /     /     /    /
    â     â â  â  â   â   â    â          / /     / /     / /   /   //
 â   â       â     â       â    â        /       / /       /   /   //
â â   â â   â â  â  â   â    â          /       /         /       /    /
 â â   â â   â    â      â    â               //      /  /       /    /
â â â  ââ â   â    â      â    â             //      /  /       /    ///
 â â â  â  â   â    â      â    â           /       /          /    //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /


            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/       / /       /            /         â   ââ     â     â        â
        //       /       /    /           â   ââ     â     â      â â â
       //     / /       /    /   /       â â   â      â    ââ      â â â
      //     / /  /    /    /   /         â â   â      â    ââ â    â
     /  /   /    /    /        /           â â  ââ      â â  â  â    â
    /  / / /    /    /   /    /   /         â    â    â    â  â  â   ââ
  /   / / /  / /        /    /   /           â    â    â    â  ââ â   â
 /  // //   / /     /  /        //      â     â    â    â  â â   â â   â
/  // //   / /     /  /        //        â     â    ââ   â  â â   ââ  â
  /  //   / /     /  /    /   //          â     â     â   â  â     ââ  â
 /   /   /   /   /       /    / /        â â â   â     â      â     ââ
/   /   /   /   /    /  /    / /          â â â         â      â      â
INTR32000000 ===========================================================
â â âââ    ââ   â â  âââ   â   â         /   // /   /   / /   //    / /
 â â â â â  â  â â â  âââ   â   â       /   // /   /   / /   //    / /
  â â â â â  â  â   â   â    â              / /       /     /     / /  /
   â   â â â  â  â   â   â    â            / /     / /     / /   /    /
â   â     â â  â  â   â   â    â          / /     / /     / /   /   //
 â   â â   â â  â  â   â   ââ   â        /       / /       /   /   //
â â   â â   â â  â  â   â    â          /      //      /  /       /    /
 â â  ââ â   â    â      â    â               //      /  /       /    //
â â â  ââ â   â    â      â    â             //      /  /       /    ///
 â â â  â  â   â    â      â    â           /       /          /    //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /


            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/       / /       /            /         â   ââ     â     â        â
       ///       /       /    /           â   ââ     â     â      â â â
       //     / /       /    /   /       â â   ââ     â    ââ      â â â
      //     / /  /    /    /   /         â â   â      â    ââ â    â â
     // /   / /  /    /    /   /           â â  ââ      â â  ââ â    â
    /  / / /    /    /   /    /   /         â â  ââ   â  â â  â  â   ââ
  //  / / /  / /    /   /    /   /           â    â    â    â  ââ â   ââ
 /  // ///  / /     /  /    /   //      â     â    â    â  â â  ââ â   â
/  // //   / /     /  /        //        â     â    ââ   â  â â   âââ â
  // //   / /     /  /    /   //          â     â    ââ   â  â â   ââ  â
 /  //   /   /   /  /    /   // /        â â â   â     â   â  â     ââ
/   /   /   /   /    /  /    / /          â â â         â      â      â
INTR32000000 ===========================================================
â â âââ â  ââ â â â  âââ   â   â         /   // /   /   / /   //    / /
 â â â â â  â  â â â  âââ   â   â       /   // /   /   / /   //    / /
  â â â â â  â  â   â   â    â              / /     / /     / /   / /  /
   â   â â â  â  â   â   â    â            / /     / /     / /   /   //
â   â â   â â  â  â   â   ââ   â          / /     / /     / /   /   //
 â   â â   â â  â  â   â   ââ   â        /      // /    /  /   /   //
â â  ââ â   â â  â  â   â    â          /      //      /  /       /    /
 â â  ââ â   â    â      â    â               //      /  /       /    //
â â â  ââ â   â    â      â    â             //      /  /       /    ///
 â â â  â  â   â    â      â    â           /       /          /    //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /


            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/       / /       /            /         â   ââ     â     â        â
       ///       /       /    /           â   ââ     â     â      â â â
      ///     / /       /    /   /       â â   ââ     â    ââ      â â â
      //     / /  /    /    /   /         â â   ââ     â    ââ â    â â
     // /   / /  /    /    /   /           â â  ââ      â â  ââ â    â â
    // / / / /  /    /   //   /   /         â â  ââ   â  â â  ââ â   ââ
  //  / / /  / /    /   //   /   /           â â  ââ   â  â â  ââ â   ââ
 /  // ///  / /    //  /    /   //      â     â    â    â  â â  ââ â   â
/  // ///  / /     /  /    /   //        â     â    ââ   â  â â  ââââ â
  // //   / /     /  /    /   //          â     â    ââ   â  â â   ââ  â
 // //   /   /   /  /    /   // /        â â â   â    ââ   â  â â   ââ
/  //   /   /   /  / /  /   // /          â â â         â   â  â      â
INTR32000000 ===========================================================
â â âââ â  ââ â â â  âââ   â   â         /   // /   /   / /   //    / /
 â â â â â  â  â â â  âââ   â   â       /   // /   / / / /   ///   / /
  â â â â â  â  â   â   â    â              / /     / /     / /   / / //
   â â â â â  â  â   â   ââ   â            / /     / /     / /   /   //
â   â â   â â  â  â   â   ââ   â          / /    // /    // /   /   //
 â  ââ â   â â  â  â   â   ââ   â        /      // /    /  /   /   //
â â  ââ â   â â  â  â   â    â          /      //      /  /       /    /
 â â  ââ â   â    â      â    â               //      /  /       /    //
â â â  ââ â   â    â      â    â             //      /  /       /    ///
 â â â  â  â   â    â      â    â           /       /          /    //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /


            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/       / /       /            /         â   ââ     â     â        â
       ///       /       /    /           â   ââ     â     â      â â â
      ///     / /       /    /   /       â â   ââ     â    ââ      â â â
     ///     / /  /    /    /   /         â â   ââ     â    ââ â    â â
     // /   / /  /    /    /   /           â â  âââ     â â  ââ â    â â
    // / / / /  /    /   //   /   /         â â  ââ   â  â â  ââ â   ââ
  /// / / / // /    /   //   /   /           â â  ââ   â  â â  ââ â   ââ
 // // ///  / /    //  //   /   //      â     â â  ââ   â  â â  ââ â   â
// // ///  / /    //  /    /   //        â     â    ââ   â  â â  ââââ â
  // ///  / /     /  /    /   //          â     â    ââ   â  â â  ââââ â
 // //   / / /   /  /    /   // /        â â â   â    ââ   â  â â   âââ
// //   /   /   /  / /  /   // /          â â â   â    ââ   â  â â   ââ
INTR32000000 ===========================================================
â â âââ â  ââ â â â  âââ   â   â         /   // /   / / / /   ///   / /
 â â â â â  â  â â â  âââ   â   â       /   // /   / / / /   ///   / / /
  â â â â â  â  â   â   â    â              / /     / /     / /   / / //
   â â â â â  â  â   â   ââ   â            / /    // /    // /   /   //
â  ââ â   â â  â  â   â   ââ   â          / /    // /    // /   /   //
 â  ââ â   â â  â  â   â   ââ   â        /      // /    /  /   /   //
â â  ââ â   â â  â  â   â    â          /      //      /  /       /    /
 â â  ââ â   â    â      â    â               //      /  /       /    //
â â â  ââ â   â    â      â    â             //      /  /       /    ///
 â â â  â  â   â    â      â    â           /       /          /    //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /


            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/       / /       /            /         â   ââ     â     â        â
       ///       /       /    /           â   ââ     â     â      â â â
      ///     / /       /    /   /       â â   ââ     â    ââ      â â â
     ///     / /  /    /    /   /         â â   ââ     â    ââ â    â â
    /// /   / /  /    /    /   /           â â  âââ     â â  ââ â    â â
    // / / / /  /    /   //   /   /         â â  âââ  â  â â  ââ â   ââ
  /// / / / // /    /   //   /   /           â â  ââ   â  â â  ââ â   ââ
 ///// /// // /    //  //   /   //      â     â â  ââ   â  â â  ââ â   â
// // ///  / /    //  //   /   //        â     â â  ââ   â  â â  ââââ â
/ // ///  / /    //  /    /   //          â     â    ââ   â  â â  ââââ â
 // ///  / / /   /  /    /   // /        â â â   â    ââ   â  â â  ââââ
// //   / / /   /  / /  /   // /          â â â   â    ââ   â  â â   âââ
INTR32000000 ===========================================================
â â âââ â  ââ â â â  âââ   â   â         /   // /   / / / /   ///   / /
 â â â â â  â  â â â  âââ   â   â       /   // /   / / / /   ///   / / /
  â â â â â  â  â   â   â    â              / /    // /    // /   / / //
  ââ â â â â  â  â   â   ââ   â            / /    // /    // /   /   //
â  ââ â   â â  â  â   â   ââ   â          / /    // /    // /   /   //
 â  ââ â   â â  â  â   â   ââ   â        /      // /    /  /   /   //
â â  ââ â   â â  â  â   â    â          /      //      /  /       /    /
 â â  ââ â   â    â      â    â               //      /  /       /    //
â â â  ââ â   â    â      â    â             //      /  /       /    ///
 â â â  â  â   â    â      â    â           /       /          /    //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /


            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/       / /       /            /         â   ââ     â     â        â
       ///       /       /    /           â   ââ     â     â      â â â
      ///     / /       /    /   /       â â   ââ     â    ââ      â â â
     ///     / /  /    /    /   /         â â   ââ     â    ââ â    â â
    /// /   / /  /    /    /   /           â â  âââ     â â  ââ â    â â
   /// / / / /  /    /   //   /   /         â â  âââ  â  â â  ââ â   ââ
  /// / / / // /    /   //   /   /           â â  âââ  â  â â  ââ â   ââ
 ///// /// // /    //  //   /   //      â     â â  ââ   â  â â  ââ â   â
///// /// // /    //  //   /   //        â     â â  ââ   â  â â  ââââ â
/ // ///  / /    //  //   /   //          â     â â  ââ   â  â â  ââââ â
 // ///  / / /  //  /    /   // /        â â â   â    ââ   â  â â  ââââ
// ///  / / /   /  / /  /   // /          â â â   â    ââ   â  â â  ââââ
INTR32000000 ===========================================================
â â âââ â  ââ â â â  âââ   â   â         /   // /   / / / /   ///   / /
 â â â â â  â  â â â  âââ   â   â       /   // /   /// / /  ////   / / /
 ââ â â â â  â  â   â   ââ   â              / /    // /    // /   / / //
  ââ â â â â  â  â   â   ââ   â            / /    // /    // /   /   //
â  ââ â   â â  â  â   â   ââ   â          / /    // /    // /   /   //
 â  ââ â   â â  â  â   â   ââ   â        /      // /    /  /   /   //
â â  ââ â   â â  â  â   â    â          /      //      /  /       /    /
 â â  ââ â   â    â      â    â               //      /  /       /    //
â â â  ââ â   â    â      â    â             //      /  /       /    ///
 â â â  â  â   â    â      â    â           /       /          /    //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /


            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/       / /       /            /         â   ââ     â     â        â
       ///       /       /    /           â   ââ     â     â      â â â
      ///     / /       /    /   /       â â   ââ     â    ââ      â â â
     ///     / /  /    /    /   /         â â   ââ     â    ââ â    â â
    /// /   / /  /    /    /   /           â â  âââ     â â  ââ â    â â
   /// / / / /  /    /   //   /   /         â â  âââ  â  â â  ââ â   ââ
  /// / / / // /    /   //   /   /           â â  âââ  â  â â  ââ â   ââ
 ///// /// // /    //  //   /   //      â     â â  âââ  â  â â  ââ â   â
///// /// // /    //  //   /   //        â     â â  ââ   â  â â  ââââ â
//// /// // /    //  //   /   //          â     â â  ââ   â  â â  ââââ â
 // ///  / / /  //  //   /   // /        â â â   â â  ââ   â  â â  ââââ
// ///  / / /  //  / /  /   // /          â â â   â    ââ   â  â â  ââââ
INTR32000000 ===========================================================
â â âââ â  ââ â â â  âââ   â   â         /   // /   /// / /  ////   / /
 â â â â â  â  â â â  âââ   â   â       /   // /   /// / /  ////   / / /
 ââ â â â â  â  â   â   ââ   â              / /    // /    // /   / / //
  ââ â â â â  â  â   â   ââ   â            / /    // /    // /   /   //
â  ââ â   â â  â  â   â   ââ   â          / /    // /    // /   /   //
 â  ââ â   â â  â  â   â   ââ   â        /      // /    /  /   /   //
â â  ââ â   â â  â  â   â    â          /      //      /  /       /    /
 â â  ââ â   â    â      â    â               //      /  /       /    //
â â â  ââ â   â    â      â    â             //      /  /       /    ///
 â â â  â  â   â    â      â    â           /       /          /    //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /


            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/       / /       /            /         â   ââ     â     â        â
       ///       /       /    /           â   ââ     â     â      â â â
      ///     / /       /    /   /       â â   ââ     â    ââ      â â â
     ///     / /  /    /    /   /         â â   ââ     â    ââ â    â â
    /// /   / /  /    /    /   /           â â  âââ     â â  ââ â    â â
   /// / / / /  /    /   //   /   /         â â  âââ  â  â â  ââ â   ââ
  /// / / / // /    /   //   /   /           â â  âââ  â  â â  ââ â   ââ
 ///// /// // /    //  //   /   //      â     â â  âââ  â  â â  ââ â   â
///// /// // /    //  //   /   //        â     â â  âââ  â  â â  ââââ â
//// /// // /    //  //   /   //          â     â â  âââ  â  â â  ââââ â
/// /// // / /  //  //   /   // /        â â â   â â  âââ  â  â â  ââââ
// /// // / /  //  ///  /   // /          â â â   â â  ââ   â  â â  ââââ
INTR32000000 ===========================================================
â â âââ â  ââ â â â  âââ   â   â         /   // /   /// / /  ////   / /
ââ â â â â  â  â â â  âââ   â   â       /   // /   /// / /  ////   / / /
 ââ â â â â  â  â   â   ââ   â              / /    // /    // /   / / //
  ââ â â â â  â  â   â   ââ   â            / /    // /    // /   /   //
â  ââ â   â â  â  â   â   ââ   â          / /    // /    // /   /   //
 â  ââ â   â â  â  â   â   ââ   â        /      // /    /  /   /   //
â â  ââ â   â â  â  â   â    â          /      //      /  /       /    /
 â â  ââ â   â    â      â    â               //      /  /       /    //
â â â  ââ â   â    â      â    â             //      /  /       /    ///
 â â â  â  â   â    â      â    â           /       /          /    //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /


            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/       / /       /            /         â   ââ     â     â        â
       ///       /       /    /           â   ââ     â     â      â â â
      ///     / /       /    /   /       â â   ââ     â    ââ      â â â
     ///     / /  /    /    /   /         â â   ââ     â    ââ â    â â
    /// /   / /  /    /    /   /           â â  âââ     â â  ââ â    â â
   /// / / / /  /    /   //   /   /         â â  âââ  â  â â  ââ â   ââ
  /// / / / // /    /   //   /   /           â â  âââ  â  â â  ââ â   ââ
 ///// /// // /    //  //   /   //      â     â â  âââ  â  â â  ââ â   â
///// /// // /    //  //   /   //        â     â â  âââ  â  â â  ââââ â
//// /// // /    //  //   /   //          â     â â  âââ  â  â â  ââââ â
/// /// // / /  //  //   /   // /        â â â   â â  âââ  â  â â  ââââ
// /// // / /  //  ///  /   // /          â â â   â â  âââ  â  â â  ââââ
INTR32000000 ===========================================================
â â â â â  â  â   â   ââ   â                  / /    // /    // /   /
ââ â   â â  â  â   â   ââ   â                / /    // /    // /   /   /
 ââ â   â â  â  â   â   ââ   â              /      // /    /  /   /   //
  ââ â   â â  â  â   â    â                /      //      /  /       /
â  ââ â   â    â      â    â                     //      /  /       /
 â  ââ â   â    â      â    â                   //      /  /       /
â â  â  â   â    â      â    â                 /       /          /    /
 â    â  â   â    â      â    â               /       /          /    //
â â    â                                     /       /          /     /
   â    â                                                      /     /
                                                              /








         /
/       /                                     â
       /                                       â                    â
      / /       /            /                  â           â        â
     / /       /            /               â   ââ     â     â        â
    ///       /       /    /                 â   ââ     â     â      â â
   ///     / /       /    /   /             â â   ââ     â    ââ      â
  ///     / /  /    /    /   /               â â   ââ     â    ââ â    â
 /// /   / /  /    /    /   /                 â â  âââ     â â  ââ â
/// / / / /  /    /   //   /   /               â â  âââ  â  â â  ââ â
// / / / // /    /   //   /   /                 â â  âââ  â  â â  ââ â
/// /// // /    //  //   /   //            â     â â  âââ  â  â â  ââ â
// /// // /    //  //   /   //              â     â â  âââ  â  â â  ââââ
INTR32000000 ===========================================================
â   â    â      â    â                                 //      /  /
 â   â    â      â    â                               //      /  /
  â   â    â      â    â                             /       /
â  â   â    â      â    â                           /       /          /
 â                                                 /                  /
  â                                                                  /
                                                                    /
















   /
  /                                                 â
 /                                                   â
/ /       /            /                              â           â
 /       /            /                           â   ââ     â     â
/       /       /    /                             â   ââ     â     â
     / /       /    /   /                         â â   ââ     â    ââ
    / /  /    /    /   /                           â â   ââ     â    ââ
   / /  /    /    /   /                             â â  âââ     â â  ââ
INTR32000300 ===========================================================







            K     K L        IIIII  N     N  GGGGG   OOOOO  N     N
            K    K  L          I    NN    N G     G O     O NN    N
            K   K   L          I    N N   N G       O     O N N   N
            KKKK    L          I    N  N  N G       O     O N  N  N
            K   K   L          I    N   N N G   GGG O     O N   N N
            K    K  L          I    N    NN G     G O     O N    NN
            K     K LLLLLLL  IIIII  N     N  GGGGG   OOOOO  N     N


                                       A

                     S P A C E   W A R   A D V E N T U R E


                              W R I T T E N   B Y

                          L A R R Y   W I L L I A M S








MOVE24000100 ===========================================================
        .
           .    .      .                   .             .
      .                     .    .                .           .    .
               .     .                 .

   .     .                                   .         .       .      .
      .
             .   .    .      .    .                               .
    .                                    .       .
       .    .                                                    .    .
                                                          .
                  .      .      .              .     .             .
             .
    .                                     .
                                                                .    .
            .       .            .                      .
                                        .   .      .
         .                .                                      .   .
               .                  .     .                 .
                   .                                          .
         .                                     .         .
          .               .        .                 .              .
   .          .                                                .
     .   .     .     .            .    .     .            .
MOVE24000000 ===========================================================
    â     â    â      â   â    â            /       /     /     /    /
     â       â     â       â    â        /         /           /    /
              â     â                   /
 â     â                                       /         /       /
  â â   â                                     /         /       /      /
     â     â   â    â      â    â                                   /
  â         â   â    â      â    â         /       /               /
   â â    â                               /       /                /
      â    â                                                /     /    /
                                                           /



            /
   /       /                               â
  /                                         â                    â    â
           /       /            /                        â        â    â
          /       /            /         â   â      â     â
        /                /                â   â      â            â   â
       /      /         /        /       â                 â       â   â
             /    /             /         â                 â  â
        /        /                              â         â     â
       / /               /        /              â    â    â         â
  /     /    /          /        /                     â        â     â
MOVE24000000 ===========================================================
    â     â â  â  â   â   â    â          / /       /     /     /    /
     â       â     â       â    â        /         /           /    /
â     â       â     â                   /       /         /       /
 â â   â                                       /         /       /
  â â   â â   â    â      â    â              /         /       /    / /
 â   â     â   â    â      â    â           /       /               /
  â â    â  â   â    â      â    â         /       /               //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /



            /
   /       /                               â
  /       /                                 â                    â    â
 /         /       /            /            â           â        â    â
          /       /            /         â   â      â     â        â
        //       /       /    /           â   â      â     â      â   â
       /      /         /        /       â â   â      â    â       â   â
      /      /    /    /        /         â                 â  â    â
        /   /    /             /           â    â         â  â  â
       / /      /        /        /              â    â    â     â   â
  /   / /    /          /        /                â    â    â   â     â
MOVE24000000 ===========================================================
    â     â â  â  â   â   â    â          / /       /     /     /    /
     â       â     â       â    â        /       / /       /   /   //
â â   â       â     â                   /       /         /       /
 â â   â â   â    â      â    â                /         /       /    /
â â â   â â   â    â      â    â             //      /  /       /    / /
 â â â  â  â   â    â      â    â           /       /               //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /



            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/         /       /            /         â   ââ     â     â        â
        //       /       /    /           â   â      â     â      â â â
       //     / /       /    /   /       â â   â      â    ââ      â   â
      /      /    /    /        /         â â   â      â    â  â    â
     /  /   /    /    /        /           â    â         â  â  â    â
       / / /    /        /    /   /         â    â    â    â  â  â   â
  /   / /    / /        /    /   /                â    â    â   â â   â
MOVE24000000 ===========================================================
    â     â â  â  â   â   â    â          / /     / /     / /   /   //
 â   â       â     â       â    â        /       / /       /   /   //
â â   â â   â â  â  â   â    â          /       /         /       /    /
 â â   â â   â    â      â    â               //      /  /       /    /
â â â  ââ â   â    â      â    â             //      /  /       /    ///
 â â â  â  â   â    â      â    â           /       /          /    //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /



            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/       / /       /            /         â   ââ     â     â        â
        //       /       /    /           â   ââ     â     â      â â â
       //     / /       /    /   /       â â   â      â    ââ      â â â
      //     / /  /    /    /   /         â â   â      â    ââ â    â
     /  /   /    /    /        /           â â  ââ      â â  â  â    â
    /  / / /    /    /   /    /   /         â    â    â    â  â  â   ââ
  /   / / /  / /        /    /   /           â    â    â    â  ââ â   â
MOVE24000000 ===========================================================
â   â     â â  â  â   â   â    â          / /     / /     / /   /   //
 â   â â   â â  â  â   â   ââ   â        /       / /       /   /   //
â â   â â   â â  â  â   â    â          /      //      /  /       /    /
 â â  ââ â   â    â      â    â               //      /  /       /    //
â â â  ââ â   â    â      â    â             //      /  /       /    ///
 â â â  â  â   â    â      â    â           /       /          /    //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /



            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/       / /       /            /         â   ââ     â     â        â
       ///       /       /    /           â   ââ     â     â      â â â
       //     / /       /    /   /       â â   ââ     â    ââ      â â â
      //     / /  /    /    /   /         â â   â      â    ââ â    â â
     // /   / /  /    /    /   /           â â  ââ      â â  ââ â    â
    /  / / /    /    /   /    /   /         â â  ââ   â  â â  â  â   ââ
  //  / / /  / /    /   /    /   /           â    â    â    â  ââ â   ââ
MOVE24000000 ===========================================================
â   â â   â â  â  â   â   ââ   â          / /     / /     / /   /   //
 â   â â   â â  â  â   â   ââ   â        /      // /    /  /   /   //
â â  ââ â   â â  â  â   â    â          /      //      /  /       /    /
 â â  ââ â   â    â      â    â               //      /  /       /    //
â â â  ââ â   â    â      â    â             //      /  /       /    ///
 â â â  â  â   â    â      â    â           /       /          /    //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /



            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/       / /       /            /         â   ââ     â     â        â
       ///       /       /    /           â   ââ     â     â      â â â
      ///     / /       /    /   /       â â   ââ     â    ââ      â â â
      //     / /  /    /    /   /         â â   ââ     â    ââ â    â â
     // /   / /  /    /    /   /           â â  ââ      â â  ââ â    â â
    // / / / /  /    /   //   /   /         â â  ââ   â  â â  ââ â   ââ
  //  / / /  / /    /   //   /   /           â â  ââ   â  â â  ââ â   ââ
MOVE24000000 ===========================================================
â   â â   â â  â  â   â   ââ   â          / /    // /    // /   /   //
 â  ââ â   â â  â  â   â   ââ   â        /      // /    /  /   /   //
â â  ââ â   â â  â  â   â    â          /      //      /  /       /    /
 â â  ââ â   â    â      â    â               //      /  /       /    //
â â â  ââ â   â    â      â    â             //      /  /       /    ///
 â â â  â  â   â    â      â    â           /       /          /    //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /



            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/       / /       /            /         â   ââ     â     â        â
       ///       /       /    /           â   ââ     â     â      â â â
      ///     / /       /    /   /       â â   ââ     â    ââ      â â â
     ///     / /  /    /    /   /         â â   ââ     â    ââ â    â â
     // /   / /  /    /    /   /           â â  âââ     â â  ââ â    â â
    // / / / /  /    /   //   /   /         â â  ââ   â  â â  ââ â   ââ
  /// / / / // /    /   //   /   /           â â  ââ   â  â â  ââ â   ââ
MOVE24000000 ===========================================================
â  ââ â   â â  â  â   â   ââ   â          / /    // /    // /   /   //
 â  ââ â   â â  â  â   â   ââ   â        /      // /    /  /   /   //
â â  ââ â   â â  â  â   â    â          /      //      /  /       /    /
 â â  ââ â   â    â      â    â               //      /  /       /    //
â â â  ââ â   â    â      â    â             //      /  /       /    ///
 â â â  â  â   â    â      â    â           /       /          /    //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /



            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/       / /       /            /         â   ââ     â     â        â
       ///       /       /    /           â   ââ     â     â      â â â
      ///     / /       /    /   /       â â   ââ     â    ââ      â â â
     ///     / /  /    /    /   /         â â   ââ     â    ââ â    â â
    /// /   / /  /    /    /   /           â â  âââ     â â  ââ â    â â
    // / / / /  /    /   //   /   /         â â  âââ  â  â â  ââ â   ââ
  /// / / / // /    /   //   /   /           â â  ââ   â  â â  ââ â   ââ
MOVE24000000 ===========================================================
â  ââ â   â â  â  â   â   ââ   â          / /    // /    // /   /   //
 â  ââ â   â â  â  â   â   ââ   â        /      // /    /  /   /   //
â â  ââ â   â â  â  â   â    â          /      //      /  /       /    /
 â â  ââ â   â    â      â    â               //      /  /       /    //
â â â  ââ â   â    â      â    â             //      /  /       /    ///
 â â â  â  â   â    â      â    â           /       /          /    //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /



            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/       / /       /            /         â   ââ     â     â        â
       ///       /       /    /           â   ââ     â     â      â â â
      ///     / /       /    /   /       â â   ââ     â    ââ      â â â
     ///     / /  /    /    /   /         â â   ââ     â    ââ â    â â
    /// /   / /  /    /    /   /           â â  âââ     â â  ââ â    â â
   /// / / / /  /    /   //   /   /         â â  âââ  â  â â  ââ â   ââ
  /// / / / // /    /   //   /   /           â â  âââ  â  â â  ââ â   ââ
MOVE24000000 ===========================================================
â  ââ â   â â  â  â   â   ââ   â          / /    // /    // /   /   //
 â  ââ â   â â  â  â   â   ââ   â        /      // /    /  /   /   //
â â  ââ â   â â  â  â   â    â          /      //      /  /       /    /
 â â  ââ â   â    â      â    â               //      /  /       /    //
â â â  ââ â   â    â      â    â             //      /  /       /    ///
 â â â  â  â   â    â      â    â           /       /          /    //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /



            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/       / /       /            /         â   ââ     â     â        â
       ///       /       /    /           â   ââ     â     â      â â â
      ///     / /       /    /   /       â â   ââ     â    ââ      â â â
     ///     / /  /    /    /   /         â â   ââ     â    ââ â    â â
    /// /   / /  /    /    /   /           â â  âââ     â â  ââ â    â â
   /// / / / /  /    /   //   /   /         â â  âââ  â  â â  ââ â   ââ
  /// / / / // /    /   //   /   /           â â  âââ  â  â â  ââ â   ââ
MOVE24000000 ===========================================================
â  ââ â   â    â      â    â                     //      /  /       /
 â  ââ â   â    â      â    â                   //      /  /       /
â â  â  â   â    â      â    â                 /       /          /    /
 â    â  â   â    â      â    â               /       /          /    //
â â    â                                     /       /          /     /
   â    â                                                      /     /
                                                              /









         /
/       /                                     â
       /                                       â                    â
      / /       /            /                  â           â        â
     / /       /            /               â   ââ     â     â        â
    ///       /       /    /                 â   ââ     â     â      â â
   ///     / /       /    /   /             â â   ââ     â    ââ      â
  ///     / /  /    /    /   /               â â   ââ     â    ââ â    â
MOVE24000150 ===========================================================
























NEWQ24000100 ===========================================================
 .            .           .         .          .          .     .
        .            .        .
   .                                    .                            .
            .    .                .           .      .           .
                         .                                 .
  .      .      .   .                   .
            .         .         .              .     .    .       .
      .        .          .  .
                                   .   .                     .
         .   .     .    .    .             .                       .
    .                         .                         .
                  .                 .       .   .           .
  .     .    .                          .                     .     .
                        .                            .
    .                          .     .     .    .
          .       .                                      .
                          .                                    .     .
 .      .     .       .         .                  .     .       .
                                     .     .
           .      .                                      .             .
    .                     .                         .       .    .
 .      .                       .     .   .    .                      .
           .  .                                      .
   .                  .                    .                .
REDA24000000 ===========================================================


                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /                                                       â
          +                                                         +
           â                                                       /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------

REDA24000000 ===========================================================


                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           />>                                                   <<â
          + >>>                                                 <<< +
           â>>                                                   <</
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------

REDA24000000 ===========================================================


                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /   >>                                             <<   â
          +    >>>                                           <<<    +
           â   >>                                             <<   /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------

REDA24000000 ===========================================================


                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /      >>                                       <<      â
          +       >>>                                     <<<       +
           â      >>                                       <<      /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------

REDA24000000 ===========================================================


                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /         >>                                 <<         â
          +          >>>                               <<<          +
           â         >>                                 <<         /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------

REDA24000000 ===========================================================


                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /            >>                           <<            â
          +             >>>                         <<<             +
           â            >>                           <<            /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------

REDA24000000 ===========================================================


                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /               >>                     <<               â
          +                >>>                   <<<                +
           â               >>                     <<               /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------

REDA24000000 ===========================================================


                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /                  >>               <<                  â
          +                   >>>             <<<                   +
           â                  >>               <<                  /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------

REDA24000000 ===========================================================


                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /                     >>         <<                     â
          +                      >>>       <<<                      +
           â                     >>         <<                     /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------

REDA24000000 ===========================================================


                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /                        >>   <<                        â
          +                         >>> <<<                         +
           â                        >>   <<                        /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------

REDA24000000 ===========================================================


                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /                                                       â
          +                                                         +
           â                                                       /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------

REDB24000000 ===========================================================


                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /                                                       â
          +                                                         +
           â                                                       /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------
                        B A T T L E     S T A T I O N S
REDB24000000 ===========================================================


                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           />>                                                   <<â
          + >>>                                                 <<< +
           â>>                                                   <</
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------
                        B A T T L E     S T A T I O N S
REDB24000000 ===========================================================


                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /   >>                                             <<   â
          +    >>>                                           <<<    +
           â   >>                                             <<   /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------
                        B A T T L E     S T A T I O N S
REDB24000000 ===========================================================


                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /      >>                                       <<      â
          +       >>>                                     <<<       +
           â      >>                                       <<      /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------
                        B A T T L E     S T A T I O N S
REDB24000000 ===========================================================


                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /         >>                                 <<         â
          +          >>>                               <<<          +
           â         >>                                 <<         /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------
                        B A T T L E     S T A T I O N S
REDB24000000 ===========================================================


                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /            >>                           <<            â
          +             >>>                         <<<             +
           â            >>                           <<            /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------
                        B A T T L E     S T A T I O N S
REDB24000000 ===========================================================


                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /               >>                     <<               â
          +                >>>                   <<<                +
           â               >>                     <<               /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------
                        B A T T L E     S T A T I O N S
REDB24000000 ===========================================================


                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /                  >>               <<                  â
          +                   >>>             <<<                   +
           â                  >>               <<                  /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------
                        B A T T L E     S T A T I O N S
REDB24000000 ===========================================================


                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /                     >>         <<                     â
          +                      >>>       <<<                      +
           â                     >>         <<                     /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------
                        B A T T L E     S T A T I O N S
REDB24000000 ===========================================================


                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /                        >>   <<                        â
          +                         >>> <<<                         +
           â                        >>   <<                        /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------
                        B A T T L E     S T A T I O N S
REDB24000000 ===========================================================


                    _______________________________________
                   /                                       â
                  /         RRRRRR  FEEEEEE DDDDDD          â
                 /          R     R E       D     D          â
                /           R     R E       D     D           â
               /            RRRRRR  EEEEE   D     D            â
              /             R   R   E       D     D             â
             /              R    R  E       D     D              â
            /               R     R EEEEEEE DDDDDD                â
           /                                                       â
          +                                                         +
           â                                                       /
            â        AAAAA  L       FEEEEEE RRRRRR  TTTTTTT       /
             â      A     A L       E       R     R    T         /
              â     A     A L       E       R     R    T        /
               â    A     A L       EEEEE   RRRRRR     T       /
                â   AAAAAAA L       E       R   R      T      /
                 â  A     A L       E       R    R     T     /
                  â A     A LLLLLLL EEEEEEE R     R    T    /
                   â                                       /
                    ---------------------------------------
                        B A T T L E     S T A T I O N S
INTR24000300 ===========================================================
        .
           .    .      .                   .             .
      .                     .    .                .           .    .
               .     .                 .

   .     .                                   .         .       .      .
      .
             .   .    .      .    .                               .
    .                                    .       .
       .    .                                                    .    .
                                                          .
                  .      .      .              .     .             .
             .
    .                                     .
                                                                .    .
            .       .            .                      .
                                        .   .      .
         .                .                                      .   .
               .                  .     .                 .
                   .                                          .
         .                                     .         .
          .               .        .                 .              .
   .          .                                                .
     .   .     .     .            .    .     .            .
INTR24000000 ===========================================================
    â     â    â      â   â    â            /       /     /     /    /
     â       â     â       â    â        /         /           /    /
              â     â                   /
 â     â                                       /         /       /
  â â   â                                     /         /       /      /
     â     â   â    â      â    â                                   /
  â         â   â    â      â    â         /       /               /
   â â    â                               /       /                /
      â    â                                                /     /    /
                                                           /



            /
   /       /                               â
  /                                         â                    â    â
           /       /            /                        â        â    â
          /       /            /         â   â      â     â
        /                /                â   â      â            â   â
       /      /         /        /       â                 â       â   â
             /    /             /         â                 â  â
        /        /                              â         â     â
       / /               /        /              â    â    â         â
  /     /    /          /        /                     â        â     â
INTR24000000 ===========================================================
    â     â â  â  â   â   â    â          / /       /     /     /    /
     â       â     â       â    â        /         /           /    /
â     â       â     â                   /       /         /       /
 â â   â                                       /         /       /
  â â   â â   â    â      â    â              /         /       /    / /
 â   â     â   â    â      â    â           /       /               /
  â â    â  â   â    â      â    â         /       /               //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /



            /
   /       /                               â
  /       /                                 â                    â    â
 /         /       /            /            â           â        â    â
          /       /            /         â   â      â     â        â
        //       /       /    /           â   â      â     â      â   â
       /      /         /        /       â â   â      â    â       â   â
      /      /    /    /        /         â                 â  â    â
        /   /    /             /           â    â         â  â  â
       / /      /        /        /              â    â    â     â   â
  /   / /    /          /        /                â    â    â   â     â
INTR24000000 ===========================================================
    â     â â  â  â   â   â    â          / /       /     /     /    /
     â       â     â       â    â        /       / /       /   /   //
â â   â       â     â                   /       /         /       /
 â â   â â   â    â      â    â                /         /       /    /
â â â   â â   â    â      â    â             //      /  /       /    / /
 â â â  â  â   â    â      â    â           /       /               //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /



            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/         /       /            /         â   ââ     â     â        â
        //       /       /    /           â   â      â     â      â â â
       //     / /       /    /   /       â â   â      â    ââ      â   â
      /      /    /    /        /         â â   â      â    â  â    â
     /  /   /    /    /        /           â    â         â  â  â    â
       / / /    /        /    /   /         â    â    â    â  â  â   â
  /   / /    / /        /    /   /                â    â    â   â â   â
INTR24000000 ===========================================================
    â     â â  â  â   â   â    â          / /     / /     / /   /   //
 â   â       â     â       â    â        /       / /       /   /   //
â â   â â   â â  â  â   â    â          /       /         /       /    /
 â â   â â   â    â      â    â               //      /  /       /    /
â â â  ââ â   â    â      â    â             //      /  /       /    ///
 â â â  â  â   â    â      â    â           /       /          /    //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /



            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/       / /       /            /         â   ââ     â     â        â
        //       /       /    /           â   ââ     â     â      â â â
       //     / /       /    /   /       â â   â      â    ââ      â â â
      //     / /  /    /    /   /         â â   â      â    ââ â    â
     /  /   /    /    /        /           â â  ââ      â â  â  â    â
    /  / / /    /    /   /    /   /         â    â    â    â  â  â   ââ
  /   / / /  / /        /    /   /           â    â    â    â  ââ â   â
INTR24000000 ===========================================================
â   â     â â  â  â   â   â    â          / /     / /     / /   /   //
 â   â â   â â  â  â   â   ââ   â        /       / /       /   /   //
â â   â â   â â  â  â   â    â          /      //      /  /       /    /
 â â  ââ â   â    â      â    â               //      /  /       /    //
â â â  ââ â   â    â      â    â             //      /  /       /    ///
 â â â  â  â   â    â      â    â           /       /          /    //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /



            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/       / /       /            /         â   ââ     â     â        â
       ///       /       /    /           â   ââ     â     â      â â â
       //     / /       /    /   /       â â   ââ     â    ââ      â â â
      //     / /  /    /    /   /         â â   â      â    ââ â    â â
     // /   / /  /    /    /   /           â â  ââ      â â  ââ â    â
    /  / / /    /    /   /    /   /         â â  ââ   â  â â  â  â   ââ
  //  / / /  / /    /   /    /   /           â    â    â    â  ââ â   ââ
INTR24000000 ===========================================================
â   â â   â â  â  â   â   ââ   â          / /     / /     / /   /   //
 â   â â   â â  â  â   â   ââ   â        /      // /    /  /   /   //
â â  ââ â   â â  â  â   â    â          /      //      /  /       /    /
 â â  ââ â   â    â      â    â               //      /  /       /    //
â â â  ââ â   â    â      â    â             //      /  /       /    ///
 â â â  â  â   â    â      â    â           /       /          /    //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /



            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/       / /       /            /         â   ââ     â     â        â
       ///       /       /    /           â   ââ     â     â      â â â
      ///     / /       /    /   /       â â   ââ     â    ââ      â â â
      //     / /  /    /    /   /         â â   ââ     â    ââ â    â â
     // /   / /  /    /    /   /           â â  ââ      â â  ââ â    â â
    // / / / /  /    /   //   /   /         â â  ââ   â  â â  ââ â   ââ
  //  / / /  / /    /   //   /   /           â â  ââ   â  â â  ââ â   ââ
INTR24000000 ===========================================================
â   â â   â â  â  â   â   ââ   â          / /    // /    // /   /   //
 â  ââ â   â â  â  â   â   ââ   â        /      // /    /  /   /   //
â â  ââ â   â â  â  â   â    â          /      //      /  /       /    /
 â â  ââ â   â    â      â    â               //      /  /       /    //
â â â  ââ â   â    â      â    â             //      /  /       /    ///
 â â â  â  â   â    â      â    â           /       /          /    //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /



            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/       / /       /            /         â   ââ     â     â        â
       ///       /       /    /           â   ââ     â     â      â â â
      ///     / /       /    /   /       â â   ââ     â    ââ      â â â
     ///     / /  /    /    /   /         â â   ââ     â    ââ â    â â
     // /   / /  /    /    /   /           â â  âââ     â â  ââ â    â â
    // / / / /  /    /   //   /   /         â â  ââ   â  â â  ââ â   ââ
  /// / / / // /    /   //   /   /           â â  ââ   â  â â  ââ â   ââ
INTR24000000 ===========================================================
â  ââ â   â â  â  â   â   ââ   â          / /    // /    // /   /   //
 â  ââ â   â â  â  â   â   ââ   â        /      // /    /  /   /   //
â â  ââ â   â â  â  â   â    â          /      //      /  /       /    /
 â â  ââ â   â    â      â    â               //      /  /       /    //
â â â  ââ â   â    â      â    â             //      /  /       /    ///
 â â â  â  â   â    â      â    â           /       /          /    //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /



            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/       / /       /            /         â   ââ     â     â        â
       ///       /       /    /           â   ââ     â     â      â â â
      ///     / /       /    /   /       â â   ââ     â    ââ      â â â
     ///     / /  /    /    /   /         â â   ââ     â    ââ â    â â
    /// /   / /  /    /    /   /           â â  âââ     â â  ââ â    â â
    // / / / /  /    /   //   /   /         â â  âââ  â  â â  ââ â   ââ
  /// / / / // /    /   //   /   /           â â  ââ   â  â â  ââ â   ââ
INTR24000000 ===========================================================
â  ââ â   â â  â  â   â   ââ   â          / /    // /    // /   /   //
 â  ââ â   â â  â  â   â   ââ   â        /      // /    /  /   /   //
â â  ââ â   â â  â  â   â    â          /      //      /  /       /    /
 â â  ââ â   â    â      â    â               //      /  /       /    //
â â â  ââ â   â    â      â    â             //      /  /       /    ///
 â â â  â  â   â    â      â    â           /       /          /    //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /



            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/       / /       /            /         â   ââ     â     â        â
       ///       /       /    /           â   ââ     â     â      â â â
      ///     / /       /    /   /       â â   ââ     â    ââ      â â â
     ///     / /  /    /    /   /         â â   ââ     â    ââ â    â â
    /// /   / /  /    /    /   /           â â  âââ     â â  ââ â    â â
   /// / / / /  /    /   //   /   /         â â  âââ  â  â â  ââ â   ââ
  /// / / / // /    /   //   /   /           â â  âââ  â  â â  ââ â   ââ
INTR24000000 ===========================================================
â  ââ â   â â  â  â   â   ââ   â          / /    // /    // /   /   //
 â  ââ â   â â  â  â   â   ââ   â        /      // /    /  /   /   //
â â  ââ â   â â  â  â   â    â          /      //      /  /       /    /
 â â  ââ â   â    â      â    â               //      /  /       /    //
â â â  ââ â   â    â      â    â             //      /  /       /    ///
 â â â  â  â   â    â      â    â           /       /          /    //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /



            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/       / /       /            /         â   ââ     â     â        â
       ///       /       /    /           â   ââ     â     â      â â â
      ///     / /       /    /   /       â â   ââ     â    ââ      â â â
     ///     / /  /    /    /   /         â â   ââ     â    ââ â    â â
    /// /   / /  /    /    /   /           â â  âââ     â â  ââ â    â â
   /// / / / /  /    /   //   /   /         â â  âââ  â  â â  ââ â   ââ
  /// / / / // /    /   //   /   /           â â  âââ  â  â â  ââ â   ââ
INTR24000000 ===========================================================
â  ââ â   â â  â  â   â   ââ   â          / /    // /    // /   /   //
 â  ââ â   â â  â  â   â   ââ   â        /      // /    /  /   /   //
â â  ââ â   â â  â  â   â    â          /      //      /  /       /    /
 â â  ââ â   â    â      â    â               //      /  /       /    //
â â â  ââ â   â    â      â    â             //      /  /       /    ///
 â â â  â  â   â    â      â    â           /       /          /    //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /



            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/       / /       /            /         â   ââ     â     â        â
       ///       /       /    /           â   ââ     â     â      â â â
      ///     / /       /    /   /       â â   ââ     â    ââ      â â â
     ///     / /  /    /    /   /         â â   ââ     â    ââ â    â â
    /// /   / /  /    /    /   /           â â  âââ     â â  ââ â    â â
   /// / / / /  /    /   //   /   /         â â  âââ  â  â â  ââ â   ââ
  /// / / / // /    /   //   /   /           â â  âââ  â  â â  ââ â   ââ
INTR24000000 ===========================================================
â  ââ â   â â  â  â   â   ââ   â          / /    // /    // /   /   //
 â  ââ â   â â  â  â   â   ââ   â        /      // /    /  /   /   //
â â  ââ â   â â  â  â   â    â          /      //      /  /       /    /
 â â  ââ â   â    â      â    â               //      /  /       /    //
â â â  ââ â   â    â      â    â             //      /  /       /    ///
 â â â  â  â   â    â      â    â           /       /          /    //
  â â    â  â   â    â      â    â         /       /          /    //
   â â    â                               /       /          /     /
      â    â                                                /     /    /
                                                           /



            /
   /       /                               â
  /       /                                 â                    â    â
 /       / /       /            /            â           â        â    â
/       / /       /            /         â   ââ     â     â        â
       ///       /       /    /           â   ââ     â     â      â â â
      ///     / /       /    /   /       â â   ââ     â    ââ      â â â
     ///     / /  /    /    /   /         â â   ââ     â    ââ â    â â
    /// /   / /  /    /    /   /           â â  âââ     â â  ââ â    â â
   /// / / / /  /    /   //   /   /         â â  âââ  â  â â  ââ â   ââ
  /// / / / // /    /   //   /   /           â â  âââ  â  â â  ââ â   ââ
INTR24000000 ===========================================================
â  ââ â   â    â      â    â                     //      /  /       /
 â  ââ â   â    â      â    â                   //      /  /       /
â â  â  â   â    â      â    â                 /       /          /    /
 â    â  â   â    â      â    â               /       /          /    //
â â    â                                     /       /          /     /
   â    â                                                      /     /
                                                              /









         /
/       /                                     â
       /                                       â                    â
      / /       /            /                  â           â        â
     / /       /            /               â   ââ     â     â        â
    ///       /       /    /                 â   ââ     â     â      â â
   ///     / /       /    /   /             â â   ââ     â    ââ      â
  ///     / /  /    /    /   /               â â   ââ     â    ââ â    â
INTR24000000 ===========================================================
                                                                    /





















   /
  /                                                 â
INTR24000300 ===========================================================



            K     K L        IIIII  N     N  GGGGG   OOOOO  N     N
            K    K  L          I    NN    N G     G O     O NN    N
            K   K   L          I    N N   N G       O     O N N   N
            KKKK    L          I    N  N  N G       O     O N  N  N
            K   K   L          I    N   N N G   GGG O     O N   N N
            K    K  L          I    N    NN G     G O     O N    NN
            K     K LLLLLLL  IIIII  N     N  GGGGG   OOOOO  N     N


                                       A

                     S P A C E   W A R   A D V E N T U R E


                              W R I T T E N   B Y

                          L A R R Y   W I L L I A M S




./     ADD     NAME=#JCLFULL
//GENERATE JOB (........),'GENERATE -KLINGON-',
//             MSGLEVEL=(1,1),MSGCLASS=A,REGION=3M,TIME=(,10)
/*JOBPARM L=2
//*=========   G E N E R A T O R     E X E C U T I O N   ============*
//*-- -- -->   1. COMPILE (FORTRAN VS)                   <-- -- -- --*
//FORT    EXEC PGM=FORTVS2,PARM='NODECK,NOLIST,NOTERM,NOTF,OPT(0)'
//STEPLIB   DD DSN=SYS1.VF23COMP,DISP=SHR
//SYSLIN    DD UNIT=SYSDA,DSN=&&OBJ,DISP=(,PASS,DELETE),
//             SPACE=(CYL,(1,1)),DCB=(RECFM=FB,BLKSIZE=3440,LRECL=80)
//SYSPRINT  DD SYSOUT=*
//SYSIN     DD DSN=->.USER.KL.DATA(#JCLPROG),DISP=SHR
//*-- -- -->   2. LOAD AND GO                            <-- -- -- --*
//LOADGO  EXEC PGM=LOADER,PARM='CALL,MAP',COND=(8,LE)
//STEPLIB   DD DSN=SYS1.VF23FORT,DISP=SHR
//SYSLIB    DD DSN=SYS1.VF23FORT,DISP=SHR
//SYSLIN    DD DSN=&&OBJ,DISP=(OLD,DELETE,DELETE)
//SYSLOUT   DD SYSOUT=*
//FT06F001  DD SYSOUT=*
//*            FOLLOWING DD CARD CONTAINS THE NAME OF THE MEMBERS <--*
//*            THAT ARE TO BE ASSEMBLED.                          <--*
//FT10F001  DD *
FSIO1
FSIO2
GAINIT
INSFOR
JULIAN
SHIFT
SHIFTAB
STAX
TIME
/*
//*            FOLLOWING DD CARD CONTAINS THE NAME OF THE MEMBERS <--*
//*            THAT ARE TO HAVE LINK JCL CREATED FOR THEM.        <--*
//FT11F001  DD *
#LINK
#LNKINIT
/*
//*            FOLLOWING DD POINTS AT THE MEMLIST TO CREATE       <--*
//*            COMPILE JCL FROM.                                  <--*
//FT12F001  DD DSN=->.USER.KL.DATA(#MEMLIST),DISP=SHR
//*            FOLLOWING DD POINTS CONTAINS INFO TO CREATE THE    <--*
//*            JOBS JCL FROM.                                     <--*
//FT13F001  DD *
$/INSTALL  JOB (........),'INSTALL -KLINGON-',
$/             MSGLEVEL=(1,1),MSGCLASS=A,REGION=3M,TIME=(,20)
$*JOBPARM L=20
$/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*
$/KLASM   PROC WORK=VIO,MBR=UNKNOWN,
$/             INDS='->.USER.KL.DATA',                 <- INPUT SOURCE
$/             OBJDS='->.USER.KL.OBJ'                 <- OUTPUT OBJECT
$/*  PROCEDURE TO INVOKE ASSEMBLER H.
$/*  DDNAMES USED BY THIS STEP :
$/*  SYSLIB   - ASSEMBLER MACLIB, STANDARD "SYS1.MACLIB"
$/*                               AND "SYS1.MODGEN" (IEFTIOT1)
$/*  SYSUT1   - ASSEMBLER WORK SPACE
$/*  SYSPRINT - WHERE LISTINGS ARE PRODUCED
$/*  SYSLIN   - OBJECT DECKS PRODUCED HERE
$/*  SYSIN    - INPUT TO THE ASSEMBLER
$/ASH     EXEC PGM=IEV90,PARM='XREF(SHORT),NODECK,OBJECT'
$/SYSLIB    DD DSN=SYS1.MACLIB,DISP=SHR
$/          DD DSN=SYS1.MODGEN,DISP=SHR
$/SYSUT1    DD UNIT=&WORK,DSN=&&SYSUT1,SPACE=(CYL,(10,5))
$/SYSPRINT  DD SYSOUT=*
$/SYSLIN    DD DSN=&OBJDS(&MBR),DISP=OLD
$/SYSIN     DD DSN=&INDS(&MBR),DISP=SHR
$/        PEND
$/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*
$/KLFORT  PROC OPT=2,MBR=UNKNOWN,
$/             FORTLIB='SYS1.VF23COMP',             <- FORTRAN COMPILE
$/             INDS='->.USER.KL.DATA',                 <- INPUT SOURCE
$/             OBJDS='->.USER.KL.OBJ'                 <- OUTPUT OBJECT
$/*  PROCEDURE TO INVOKE FORTRAN VS COMPILER.
$/*  DDNAMES USED BY THIS STEP :
$/*  STEPLIB  - LIBRARY WHERE THE FORTRAN COMPILER LOAD MODULE IS
$/*  SYSLIN   - WHERE GENERATED OBJECT MODULE IS PUT
$/*  SYSPRINT - WHERE FORTRAN LISTINGS ARE PRODUCED TO
$/*  SYSIN    - INPUT TO THE FORTRAN
$/FORT    EXEC PGM=FORTVS2,
$/             PARM='NODECK,NOLIST,NOTERM,NOTF,OPT(&OPT)'
$/STEPLIB   DD DISP=SHR,DSN=&FORTLIB
$/SYSLIN    DD DISP=OLD,DSN=&OBJDS(&MBR)
$/SYSPRINT  DD SYSOUT=*
$/SYSIN     DD DISP=SHR,DSN=&INDS(&MBR)
$/        PEND
$/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*
$/KLLINK  PROC WORK=VIO,MBR=UNKNOWN,
$/             FORTLNK='SYS1.VF23FORT',                <- FORTRAN LINK
$/             INDS='->.USER.KL.DATA',                 <- INPUT SOURCE
$/             OBJDS='->.USER.KL.OBJ',                <- OUTPUT OBJECT
$/             OUTDS='->.GROUP.KL.LOAD'                 <- OUTPUT LOAD
$/*  PROCEDURE TO INVOKE THE LINKAGE EDITOR.
$/*  TWO STEP PROCEDURE, THE FIRST STEP COPIES THE LINKAGE EDITOR
$/*  CONTROL CARDS FROM THE KLINGON CONTROL FILE (WHICH MAY HAVE A
$/*  BLKSIZE GREATER THAN ALLOWED BY LINKAGE EDITOR 3200 MAX) TO A
$/*  WORK FILE.
$/*  DDNAMES USED BY THE REBLOCK STEP ARE IEBGENER STANDARD.
$/*  LKED DDNAMES :
$/*  SYSLIB   - FORTRAN CALLLIB
$/*  SYSLMOD  - OUTPUT LOAD MODULE LIBRARY
$/*  SYSOBJ   - OBJECT LIBRARY, ADDED TO BY KLASM AND KLFORT STEPS
$/*  SYSUT1   - WORK FILE FOR LKED
$/*  SYSPRINT - WHERE LISTINGS FOR LKED
$/*  SYSLIN   - WHERE LINKAGE EDITOR CONTROL CARDS ARE READ FROM
$/REBLOCK EXEC PGM=IEBGENER
$/SYSUT1    DD DSN=&INDS(&MBR),DISP=SHR
$/SYSUT2    DD DSN=&&LINK,SPACE=(TRK,(1,1)),UNIT=&WORK,
$/             DISP=(NEW,PASS,DELETE),DCB=(LRECL=80,BLKSIZE=80,RECFM=F)
$/SYSPRINT  DD DUMMY
$/SYSIN     DD DUMMY
$/LKED    EXEC PGM=HEWL,PARM='LIST,XREF',COND=(4,LT)
$/SYSLIB    DD DISP=SHR,DSN=&FORTLNK
$/SYSLMOD   DD DISP=OLD,DSN=&OUTDS
$/SYSOBJ    DD DISP=SHR,DSN=&OBJDS
$/SYSUT1    DD UNIT=&WORK,SPACE=(CYL,(1,1))
$/SYSPRINT  DD SYSOUT=*
$/SYSLIN    DD DSN=&&LINK,DISP=(OLD,DELETE,DELETE)
$/        PEND
$/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*
/*
//*            THE FOLLOWING DD IS THE ONE WHERE THE JOBS WILL    <--*
//*            BE SUBMITTED TO.                                   <--*
//*            ORIGINAL WAS : FT14F001  DD SYSOUT=(A,INTRDR)
//FT14F001  DD DSN=->.USER.KL.CNTL(JOBS),DISP=OLD
./     ADD     NAME=#JCLPROG
C*********************************************************************
C     PROGRAM TO GENERATE JCL FOR COMPILING MEMBERS
C         (FORTRAN G/H/VS COMPATIBLE)
C*********************************************************************
      COMMON /PARMS/ IASMC, ILNKC, ICCNT, ISTEP, IMEM(2),
     *    IASML(100,2), ILNKL(100,2), ICARDS(100,20)
      CALL ASMLIS
      CALL LNKLIS
      REWIND 13
      ICCNT = 0
100   READ (13,10000,END=101) (ICARDS(ICCNT+1,N),N=1,20)
      ICCNT = ICCNT + 1
      IF (ICCNT.LT.100) GO TO 100
      WRITE (6,10002)
      GO TO 999
101   ISTEP = 10000
      REWIND 12
102   READ (12,10001,END=103) IMEM
      CALL MEMPR
      GO TO 102
103   CALL LINKPR
999   STOP
10000 FORMAT (1X,A3,19A4)
10001 FORMAT (2A4)
10002 FORMAT (' ','*** SCRAMBLE *** - MORE THAN 100 JCL CARDS'/
     *        ' ','OVERFLOW OF ARRAY, USE LESS JCL CARDS')
      END
C*********************************************************************
      SUBROUTINE ASMLIS
C*********************************************************************
      COMMON /PARMS/ IASMC, ILNKC, ICCNT, ISTEP, IMEM(2),
     *    IASML(100,2), ILNKL(100,2), ICARDS(100,20)
      IASMC = 0
      REWIND 10
100   READ (10,11000,END=999) (IASML(IASMC+1,N),N=1,2)
      IASMC = IASMC + 1
      IF (IASMC.LT.100) GO TO 100
      WRITE (6,11001)
999   RETURN
11000 FORMAT (2A4)
11001 FORMAT (' ','*** WARNING *** - MORE THAN 100 ASMLIST ENTRIES'/
     *        ' ','EXCESS ENTRIES INGORED')
      END
C*********************************************************************
      SUBROUTINE LNKLIS
C*********************************************************************
      COMMON /PARMS/ IASMC, ILNKC, ICCNT, ISTEP, IMEM(2),
     *    IASML(100,2), ILNKL(100,2), ICARDS(100,20)
      ILNKC = 0
      REWIND 11
100   READ (11,11000,END=999) (ILNKL(ILNKC+1,N),N=1,2)
      ILNKC = ILNKC + 1
      IF (ILNKC.LT.100) GO TO 100
      WRITE (6,11001)
999   RETURN
11000 FORMAT (2A4)
11001 FORMAT (' ','*** WARNING *** - MORE THAN 100 LINKMEM ENTRIES'/
     *        ' ','EXCESS ENTRIES INGORED')
      END
C*********************************************************************
      SUBROUTINE MEMPR
C*********************************************************************
      COMMON /PARMS/ IASMC, ILNKC, ICCNT, ISTEP, IMEM(2),
     *    IASML(100,2), ILNKL(100,2), ICARDS(100,20)
      IF (ISTEP.NE.10000) GO TO 200
      DO 100 J=1,ICCNT
          WRITE (14,12000) (ICARDS(J,N),N=1,20)
100   CONTINUE
200   ISTEP  = ISTEP + 1
      ILANG = 0
      DO 201 J=1,IASMC
          IF (IMEM(1).EQ.IASML(J,1).AND.IMEM(2).EQ.IASML(J,2)) ILANG = 1
201   CONTINUE
      IF (ILANG.EQ.1) GO TO 202
      WRITE (14,12001) ISTEP, IMEM
      GO TO 900
202   WRITE (14,12002) ISTEP, IMEM
900   CONTINUE
      RETURN
12000 FORMAT ('/',A3,19A4)
12001 FORMAT ('//ST',I5,' EXEC KLFORT,MBR=',2A4)
12002 FORMAT ('//ST',I5,' EXEC KLASM,MBR=',2A4)
      END
C*********************************************************************
      SUBROUTINE LINKPR
C*********************************************************************
      COMMON /PARMS/ IASMC, ILNKC, ICCNT, ISTEP, IMEM(2),
     *    IASML(100,2), ILNKL(100,2), ICARDS(100,20)
      ISTEP = 10000
      DO 100 J=1,ILNKC
          ISTEP = ISTEP + 1
          WRITE (14,12001) ISTEP, (ILNKL(J,N),N=1,2)
100   CONTINUE
      RETURN
12001 FORMAT ('//LK',I5,' EXEC KLLINK,MBR=',2A4)
      END
./     ADD     NAME=#KLHELP
LOGONMSG              This is the IBM version of "K L I N G O N"
LOGONMSG          Users are reminded this is not productive work ×××
LOGONMSG
INTRO       Welcome to KLINGON, a game of space war and conquest.
INTRO       This section is intended as a brief introduction to KLINGON,
INTRO       complete rules are available in the "->.GROUP.KL.RULES" data
INTRO       You may print it using the PRINTDS TSO command, as e.g. :
INTRO            TSO PRINTDS DA('->.GROUP.KL.RULES') CCHAR CLASS(A) DEST
INTRO       During a game, if you forget a command, type HELP.
INTRO       In the NOT too distant future : it is the time of STAR TREK
INTRO       you are the commander of the flagship of the KLINGON empire,
INTRO       supercommander KAZH.
INTRO       Your ship is the most powerful in the known galaxy, your mis
INTRO       break thru the Federation defenses and destroy as many Feder
INTRO       starbases as you can ...
INTRO       Your weaponry is awesome, a back of 150 disruptor torpedos ×
INTRO       Your fleet : the mightiest the KLINGON empire has ever gathe
INTRO       ready to help defend you from attacks from Federation starsh
INTRO
INTRO       Some brief information on your ship :
INTRO       Weaponry :   disruptor torpedos (150)
INTRO       Shields :    pulsed energy - reflective type
INTRO       Engines :    WARP - dilithium energizer - stress field type
INTRO                    IMPULSE - hydrogen conversion type
INTRO       Top speeds : maximum safe speed - WARP FACTOR (WF) 10
INTRO                    emergency speed    - WARP FACTOR (WF) 12
INTRO                    IMPULSE            - .95C
INTRO       Other :      ANTI-PHOTON device
INTRO                    emergency field dampening system
INTRO                    TRACTOR BEAM
INTRO       If you wish to stop your game early, type STOP or TERMINATE.
INTRO
INTRO       You may have noticed that KLINGON does not have different le
INTRO       of games, that is because all of them are short and nasty ×
INTRO
INTRO       Have fun ×××
INTRO
INTROHLP
INTROHLP    At this point, you are being asked if you would like introdu
INTROHLP    instructions, please reply YES or NO or just hit ENTER (defa
INTROHLP
ONHELP
ONHELP      At this point, you are being asked if you would like an OLD
ONHELP      game : OLD = continue a Frozen game
ONHELP             NEW = start a new game
ONHELP
LEVHELP
LEVHELP     You are being asked how good a player you are :
LEVHELP       GOOD     = Starting player, this is the easiest,
LEVHELP       EXPERT   = Good player, has some experience,
LEVHELP       EMERITUS = World class, best player will only win 5% of th
LEVHELP
TOURHELP    At this point, you are being asked whether you would like a
TOURHELP    or TOURNAMENT game.
TOURHELP    REGULAR    = Start the random number generator with a number
TOURHELP                 on the time of day.
TOURHELP    TOURNAMENT = Start the random number generator with a user s
TOURHELP                 key, the same key will cause the same game to b
TOURHELP                 generated. This option allows players to compet
TOURHELP                 the starting setup will be the same for all pla
TOURHELP
SRSCAN      SHORT-RANGE SCAN
SRSCAN        Mnemonic              : SRSCAN
SRSCAN        Shortest abbreviation : S
SRSCAN        Full commands         : SRSCAN
SRSCAN                                SRSCAN NO
SRSCAN      Note for TSO 3270 users ---> See Help Catagory FS3270
SRSCAN        The SHORT-RANGE SCAN gives you a considerable amount of
SRSCAN      information about the quadrant your starship is in.
SRSCAN      A SHORT-RANGE SCAN is best described by an example.
SRSCAN        1 2 3 4 5 6 7 8 9 10
SRSCAN       1 * . . . . . . . . . TORPEDOES    150 CONDITION: READY
SRSCAN       2 . . . F . . . . . . POSITION    5 - 1, 4 - 4
SRSCAN       3 . . . . . * . B . . STARDATE    4300.00
SRSCAN       4 . . . S . . . . . . REMAINING      6.93
SRSCAN       5 . . . . . . . . . . CONDITION   RED   A.P.D.  ARMED
SRSCAN       6 . . . # . . . . * . ENERGY      2176.25
SRSCAN       7 . . . . . P . . . . SHIELDS   UP  3472 PCT 11800 UNTS
SRSCAN       8 . . . . * . . . . . WARP FACTOR   10.00
SRSCAN       9 . * . . * . . . C . FEDERATION  BASES 6  STARSHIPS 4
SRSCAN      10 . . . . . . . . . . KLINGON    COMMANDERS  4
SRSCAN      The left part is a picture of the quadrant. The S at sector
SRSCAN        4 - 4 represents the supercommander KAZH; the B at sector
SRSCAN        3 - 8 is a starbase.
SRSCAN      There is a KLINGON commander (C) at sector 9 - 9, and a plan
SRSCAN        sector 7 - 6. Other features in the quadrant are a Federat
SRSCAN        starship (F), at 2 - 4, and a black hole at 6 - 4 (#).
SRSCAN      The stars (*) are located at 1 - 1, 3 - 6, 6 - 9, 8 - 5,
SRSCAN        9 - 2, and 9 - 5.
SRSCAN      The periods (.) are just empty space--they are printed to he
SRSCAN        you get your bearings.
SRSCAN      The information on the right is assorted STATUS information.
SRSCAN      The STATUS information will be absent if you type NO after
SRSCAN      SRSCAN. Otherwise, STATUS information will be presented.
SRSCAN        SHORT-RANGE SCANs are free. That is, they use up no energy
SRSCAN      and no time. If you are in battle, doing a SHORT-RANGE SCAN
SRSCAN      not give the enemies another chance to hit you. You can safe
SRSCAN      do a SHORT-RANGE SCAN anytime you like.
STATUS      STATUS REPORT
STATUS        Mnemonic              : STATUS
STATUS        Shortest abbreviation : ST
STATUS      Note for TSO 3270 users ---> See Help Catagory FS3270
STATUS        This command gives you information about the current state
STATUS      your starship, as follows :
STATUS        STARDATE - the current date. A stardate is the same as a d
STATUS        CONDITION - there are four possible conditions :
STATUS             RED = in battle, YELLOW = low on energy (0/1000 units
STATUS             GREEN = none of the above.
STATUS        EMERGENCY - in battle and less than 1000 units of energy.
STATUS        POSITION - quadrant is given first, then sector.
STATUS        FEDERATION - gives the numbers on how many starships and s
STATUS             are left for the Federation.
STATUS        WARP FACTOR - what your warp factor is currently set to.
STATUS        ENERGY - the amount of energy you have left. If it drops t
STATUS             one dose of 750.0 units of energy will be taken from
STATUS             batteries, provided your battle computer is working,
STATUS             batteries are charged.
STATUS
STATUS        TORPEDOES - how many disruptor torpedoes you have left. Al
STATUS             what the status of your disruptor torpedo tubes are :
STATUS             OUT = no torpedoes left, READY = torpedoes standing b
STATUS             fire, DAMAGED = torpedo tubes are damaged.
STATUS        SHIELDS - whether your shields are up or down, how strong
STATUS             (what percent of a hit they can deflect), and shield
STATUS        KLINGON - how many of your friendly ships are out there.
STATUS        REMAINING - how long you have to crush the Federation. If
STATUS             reaches zero, the Federation wins, and you will then
STATUS             opening sealed orders.
STATUS        Status information is free--it uses no time or energy, and
STATUS      are in battle, the Federation is not given another chance to
STATUS      you.
STATUS
STATUS        Status information can also be obtained by doing a SHORT-R
STATUS      SCAN (see the SRSCAN command for details).
LRSCAN      LONG-RANGE SCAN
LRSCAN        Mnemonic              : LRSCAN
LRSCAN        Shortest abbreviation : L
LRSCAN
LRSCAN      Note for TSO 3270 users ---> See Help Catagory FS3270
LRSCAN
LRSCAN        A LONG-RANGE SCAN gives you general information about wher
LRSCAN      are and what is around you. Here is an example output.
LRSCAN
LRSCAN
LRSCAN       LONG RANGE SCAN FOR AREA: 1 - 4
LRSCAN         ****   ****   ****
LRSCAN          102      2   9999
LRSCAN         1007      3     19
LRSCAN       PLANET DETECTED IN QUADRANT: 2 - 5
LRSCAN        This scan says that you are in row 1, column 4 of the 8 by
LRSCAN      galaxy. The numbers in the scan indicate how many of each ki
LRSCAN      thing there is in your quadrant and all adjacent quadrants.
LRSCAN      The digits are interpreted as follows :
LRSCAN
LRSCAN
LRSCAN
LRSCAN        Thousands digit = 1000 indicates a KLINGON commander,
LRSCAN        Hundreds digit  = number of Federation starships,
LRSCAN        Tens digit      = number of starbases present,
LRSCAN        Ones gigit      = number of stars present,
LRSCAN        9999            = indicates supernova,
LRSCAN        ****            = edge of Federation space.
LRSCAN
LRSCAN
LRSCAN        For example, in your quadrant (1 - 4) the number is 2, whi
LRSCAN      indicates 2 stars, you, and nothing else (you are always in
LRSCAN      center quadrant of these scans). There is a Federation stars
LRSCAN      quadrant 1 - 3 (102), a commander and seven stars in quadran
LRSCAN      (1007), a supernova in quadrant 1 - 5 (9999) and starbase, a
LRSCAN      stars in 2 - 5 (19).
LRSCAN        You might also notice a report on a planet in quadrant 2 -
LRSCAN      unlike super STAR TREK, planets are detectable by LONG RANGE
LRSCAN      so that if they are in your flight path, you can stop and ki
LRSCAN      if you wish.
LRSCAN        Since you are in row 1, there are no quadrants above you.
LRSCAN      The ****'s indicate the border of Federation space, which yo
LRSCAN      not permitted to cross.
LRSCAN        LONG-RANGE SCANs are free. They use up no energy or time,
LRSCAN      can be done safely regardless of battle conditions.
LRSCAN        For 3270 TSO users, the information given is in a less ver
LRSCAN       fashion.
CHART       STAR CHART
CHART         Mnemonic              : CHART
CHART         Shortest abbreviation : C
CHART         As you proceed in the game, you learn more and more about
CHART       things are where in the galaxy. This information is automati
CHART       recorded for you in your star chart.
CHART         The chart looks like an 8 by 8 array of numbers. These num
CHART       are interpreted exactly as they are on a LONG-RANGE SCAN. A
CHART       (.) in place of a digit means you do not know that informati
CHART       For example, ... means you know nothing about the quadrant.
CHART         Looking at the star chart is a free operation. It costs yo
CHART       neither time nor energy, and can be done safely whether in o
CHART       of battle.
DAMAGE      DAMAGE REPORT
DAMAGE        Mnemonic              : DAMAGES
DAMAGE        Shortest abbreviation : DA
DAMAGE        At any time you may ask for a damage report to find out wh
DAMAGE      devices are damaged and how long it will take to repair them
DAMAGE        If you suffer damages while moving, it is possible that a
DAMAGE      subsequent damage report will not show any damage. This happ
DAMAGE      if the time spent on the move exceeds the repair time, since
DAMAGE      this case the damaged devices were fixed en route.
DAMAGE
DAMAGE        Damage reports are free. They use no energy or time, and c
DAMAGE      be done safely even in the midst of battle.
MOVE        MOVE UNDER WARP DRIVE
MOVE          Mnemonic              : MOVE
MOVE          Shortest abbreviation : M
MOVE          Full command          : MOVE MANUAL (DISPLACEMENT)
MOVE                                  MOVE AUTOMATIC (DESTINATION)
MOVE          This command is the usual way to move from one place to an
MOVE        within the galaxy. You move under warp drive, according to t
MOVE        current warp factor (see WARP FACTOR).
MOVE          There are two command modes for movement; MANUAL and AUTOM
MOVE
MOVE        The MANUAL mode requires the following format :
MOVE               MOVE MANUAL (DELTX),(DELTY)
MOVE        (DELTX) and (DELTY) are the horizontal and vertical displace
MOVE        for your starship, in quadrants; a displacement of one secto
MOVE        0.1 quadrants. Specifying (DELTX) and (DELTY) causes your sh
MOVE        move in a straight line to the specified destination. If (DE
MOVE        is omitted, it is assumed zero. For example, the shortest po
MOVE        command to move 1 sector to the right would be : M M .1
MOVE          The following examples of MANUAL movement refer to the
MOVE        SHORT-RANGE SCAN example.
MOVE          Destination sector      MANUAL movement command
MOVE                3 - 1                    M M -.3 .1
MOVE                2 - 1                    M M -.3 .2
MOVE                1 - 2                    M M -.2 .3
MOVE                3 - 4                    M M 0 .1
MOVE          (leaving quadrant)             M M .7
MOVE                3 - 5                    M M .1 .1
MOVE                4 - 10                   M M .6
MOVE                6 - 6                    M M .2 -.2
MOVE                5 - 4                    M M 0 -.1
MOVE        The AUTOMATIC mode is as follows :
MOVE               MOVE AUTOMATIC (QROW),(QCOL),(SROW),(SCOL)
MOVE        where (QROW) and (QCOL) are the row and column numbers of th
MOVE        destination quadrant, and (SROW) and (SCOL) are the row and
MOVE        numbers of the destination sector within that quadrant.
MOVE        This command also moves your ship in a straight line path to
MOVE        destination. For moving within a quadrant, (QROW) and (QCOL)
MOVE        be omitted. For example, to move to sector 2 - 9 in the curr
MOVE        quadrant, the shortest command would be : M A 2 9
MOVE
MOVE        To move to quadrant 3 - 7, sector 5 - 8, type : M A 3 7 5 8
MOVE        and it will be done. In AUTOMATIC mode, either two or four n
MOVE        must be supplied.
MOVE          AUTOMATIC mode utilizes the ship's BATTLE COMPUTER. If the
MOVE        computer is damaged, MANUAL movement must be used. If warp e
MOVE        are damaged less than 5 stardates you can still go WARP 5.
MOVE          It uses time and energy to move. How much time and how muc
MOVE        depends on your current warp factor and the distance you mov
MOVE        higher the warp factor, the faster you move, but higher warp
MOVE        require more energy.
MOVE        Your warp engines are most efficient at warp factor 10, as y
MOVE        away from this speed, you use more energy in proportion to t
MOVE        distance moved.
WARP        WARP FACTOR
WARP          Mnemonic              : WARP
WARP          Shortest abbreviation : W
WARP          Full command          : WARP (NUMBER)
WARP          Your WARP FACTOR controls the speed of your starship. The
WARP        the warp factor, the faster you go and the more energy you u
WARP          Your minimum warp factor is 1.0 and your maximum warp fact
WARP        is 12.0. At speeds above warp 10 there is some danger of cau
WARP        damage to your warp engines; this damage is larger at higher
WARP        factors and also depends on how far you go at that warp fact
IMPULSE     IMPULSE ENGINES
IMPULSE       Mnemonic              : IMPULSE
IMPULSE       Shortest abbreviation : I
IMPULSE       Full command   IMPULSE (MANUAL or AUTOMATIC),
IMPULSE                              (DISPLACEMENT or DESTINATION)
IMPULSE       The impulse engines give you a way to move when your warp
IMPULSE     are damaged. They move you at a speed of 0.95 sectors per ST
IMPULSE     which is the equivalent of a WARP FACTOR of about 0.975, so
IMPULSE     are much too slow to use except in emergencies.
IMPULSE       Movement commands are indicated just as in the MOVE comman
IMPULSE       The impulse engines require 20 units of energy to engage,
IMPULSE     10 units per sector (100 units per quadrant) travelled.
IMPULSE       The player should note, the impulse engines are in a rathe
IMPULSE     vunerable part of the ship, are damaged easily.
SHIELDS     DEFLECTOR SHIELDS
SHIELDS       Mnemonic              : SHIELDS
SHIELDS       Shortest abbreviation : SH
SHIELDS       Full commands         : SHIELDS UP
SHIELDS                               SHIELDS DOWN
SHIELDS                               SHIELDS TRANSFER (AMOUNT OF ENERGY
SHIELDS                                                 TRANSFER)
SHIELDS       Your DEFLECTOR SHIELDS are a defensive device to protect y
SHIELDS     from Federation attacks (and nearby novas).
SHIELDS
SHIELDS       As the shields protect you, they gradually weaken. A shiel
SHIELDS     strength of 75 percent, for example, means that the next tim
SHIELDS     are attacked, your shields will deflect 75 percent of the hi
SHIELDS     let 25 percent get through to hurt you. It costs 50 units of
SHIELDS     to raise shields, nothing to lower them. You should never ha
SHIELDS     raise or lower shields manually, as your automatic deflector
SHIELDS     control will do this for you, as you go into battle, and lea
SHIELDS     battle. If your energy level is questionable (as to if you m
SHIELDS     not want to raise shields, if they would do little or no goo
SHIELDS     will be prompted as to if you wish shields raised.
SHIELDS       You may transfer energy between the ship's energy (given a
SHIELDS     (ENERGY) in STATUS) and the shields. (TRANSFER) may be abbre
SHIELDS     (T). (AMOUNT OF ENERGY TO TRANSFER) is the number of units o
SHIELDS     energy you wish to take from the ship's energy and put into
SHIELDS     shields. If you specify a negative number, energy is drained
SHIELDS     the shields to the ship. Transferring energy constitutes a t
SHIELDS     If you transfer energy to the shields while under attack, th
SHIELDS     be at the new energy level when you are next hit.
SHIELDS       Enemy torpedoes hitting your ship explode on your shields
SHIELDS     are up) and have essentially the same effect as phaser hits.
SHIELDS       If you wish to override automatic shield control, specify
SHIELDS     DOWN in the command.
COMPUTE     SHIPS COMPUTER
COMPUTE       Mnemonic              : COMPUTER
COMPUTE       Shortest abbreviation : CO
COMPUTE       Full commands         : COMPUTE AUTOMATIC <ROWSEC> <COLSEC
COMPUTE                               COMPUTE AUTOMATIC <RQUAD> <CQUAD>
COMPUTE                                                 <RSEC> <CSEC>
COMPUTE                               COMPUTE MANUAL <X-DISP> <Y-DISP>
COMPUTE       The ship's computer allows you to get some information abo
COMPUTE     movement, before you actually move.
COMPUTE
COMPUTE       You enter the destination you are considering in the same
COMPUTE     as MOVE. The computer will then calculate and report to you
COMPUTE     and energy required for such a trip.
COMPUTE       This command requires no time or energy, so you may use it
COMPUTE     your ship's computer is undamaged.
PHOTON      PHOTON TORPEDOES
PHOTON
PHOTON      See DISRUPTOR TORPEDOES command.
DISRUPTOR   DISRUPTOR TORPEDOES
DISRUPTOR     Mnemonic              : DISRUPTOR
DISRUPTOR     Shortest abbreviation : DIS
DISRUPTOR     Full commands         : DISRUPTOR (NUMBER) (TARG1) (TARG2)
DISRUPTOR                                                (TARG3) (TARG4)
DISRUPTOR     DISRUPTOR TORPEDOES are projectile weapons--you either hit
DISRUPTOR   you aim at, or you don't. There are no PARTIAL HITS.
DISRUPTOR     You may fire DISRUPTOR TORPEDOES singly, or in bursts of t
DISRUPTOR   three or four. Each torpedo is individually targetable.
DISRUPTOR
DISRUPTOR     The computer will prompt you, asking for the target sector
DISRUPTOR   each torpedo. Alternately, you may specify each target in th
DISRUPTOR   command line. If more than one torpedo is fired and only one
DISRUPTOR   sector is specified, all torpedoes are fired at that sector.
DISRUPTOR   example, to fire two torpedoes at sector 3 - 4, you type :
DISRUPTOR          DIS 2 3 4   (or)   DIS 2 3 4 3 4
DISRUPTOR   To fire torpedoes at, consecutively, sectors 2 - 6, 1 - 10,
DISRUPTOR   4 - 7, type : DIS 3 2 6 1 10 4 7
DISRUPTOR   There is no restriction to fire directly at a sector. For ex
DISRUPTOR   you can enter : DIS 1 3 2.5 to aim between two sectors.
DISRUPTOR     However, sector numbers must be 1 to 10 inclusive.
DISRUPTOR     Torpedoes going within 0.5 sectors of a black hole are swa
DISRUPTOR   If your DISRUPTOR TORPEDO tubes are damaged less than 3 STAR
DISRUPTOR   you can still fire 2 torpedoes (instead of 4).
REST        REST
REST          Mnemonic              : REST
REST          Shortest abbreviation : RES
REST          Full command          : REST (NUMBER OF STARDATES)
REST          This command simply allows the specified number of STARDAT
REST        go by. This is useful if you have suffered damages and wish
REST        until repairs are made before you go back into battle. Note
REST        your energy level will be raised by 1024 units a STARDATE, a
REST        REST. It is not generally advisable to REST while you are un
REST        attack by the Federation.
HELP        HELP
HELP          Mnemonic              : HELP
HELP          (no abbreviation)
HELP          HELP command connects you with the KLINGON help data base,
HELP        quick help on using a command.
ABANDON     ABANDON SHIP
ABANDON       Mnemonic              : ABANDON
ABANDON       (no abbreviation)
ABANDON       You may not ABANDON ship, that is unworthy of a KLINGON.
DESTRUCT    SELF-DESTRUCT
DESTRUCT      Mnemonic              : DESTRUCT
DESTRUCT      (no abbreviation)
DESTRUCT      You may self-DESTRUCT, thus killing yourself and ending th
TERMINATE   TERMINATE THE CURRENT GAME
TERMINATE     Mnemonic              : TERMINATE
TERMINATE     (no abbreviation)
TERMINATE     Immediately CANCEL the current game. No conclusion is reac
TERMINATE   no score is computed. You will be given an opportunity to st
TERMINATE   new game or to leave the KLINGON program.
SENSOR      SENSOR-SCAN
SENSOR        Mnemonic              : SENSORS
SENSOR        Shortest abbreviation : SE
SENSOR        Utilizing the SHORT-RANGE SENSORS, your first officer give
SENSOR      readout on any planet in your quadrant.
A.P.D.      ANTI-PHOTON DEVICE
A.P.D.        Mnemonic              : ANTI PHOTON
A.P.D.        Shortest abbreviation : A P
A.P.D.        Full command          : ANTI PHOTON
A.P.D.        Like all KLINGON commanders, your ship is equipped with an
A.P.D.      ANTI-PHOTON device. This A.P.D. will protect you from one ro
A.P.D.      Federation photon torpedoes (3). The A.P.D. requires 500 uni
A.P.D.      shield energy to activate it.
A.P.D.
A.P.D.
A.P.D.        Two things can disarm the ANTI-PHOTON device :
A.P.D.      1. it absorbs a full round of torpedoes, or
A.P.D.      2. a Federation starship fires phasers at you (the A.P.D. is
A.P.D.         the ship's main computer, not the battle computer, and as
A.P.D.         not affected when the battle computer is damaged and can
A.P.D.         even if your shields are down).
A.P.D.        The use of the ANTI PHOTON device does not count as a turn
A.P.D.      be activated instantly, even during battle, at no cost in ti
A.P.D.      does not allow enemies to attack.
BATTERY     BATTERY
BATTERY       Mnemonic              : BATTERY
BATTERY       Shortest abbreviation : BATT
BATTERY       The BATTERY command provides information of whether your b
BATTERY     (used if you fall below zero energy) are charged or not, onc
BATTERY     batteries are drained there is no way to recharge them. They
BATTERY     750.0 units of energy.
TRACTOR     TRACTOR BEAM
TRACTOR       Mnemonic              : TRACTOR
TRACTOR       Shortest abbreviation : TRAC
TRACTOR       Full command          : TRACTOR (TARGET QUADRANT)
TRACTOR       The TRACTOR command allows you to pull a ship across some
TRACTOR     in space. When this command is issued you will be prompted w
TRACTOR     amount of energy it would take to pull a ship that far, and
TRACTOR     you still wish to engage the TRACTOR BEAM, if a ship is foun
TRACTOR     target quadrant it will be pulled to your quadrant. If there
TRACTOR     then one at the target quadrant, one will be selected random
TRACTOR       If there is no ship at the target quadrant, you will be no
TRACTOR     of this fact, and the power drain caused by the TRACTOR BEAM
TRACTOR     cut by 50%. It is possible to TRACTOR either commanders (to
TRACTOR     in a fight perhaps) or Federation starships. Starbases, plan
TRACTOR     stars, and black holes are not effected by the TRACTORS.
TRACTOR       The use of the TRACTOR BEAM constitutes a turn, and enemie
TRACTOR     attack.
FREEZE      FREEZE
FREEZE        Mnemonic              : FREEZE
FREEZE        (no abbreviation)
FREEZE        The purpose of the FREEZE command is to allow a player to
FREEZE      current state of the game, so that it can be finished later.
FREEZE      file FT26F001 is written with all the information about the
FREEZE      progress.
FREEZE        To restart a game created by the FREEZE command, the user
FREEZE      only type OLD in response to the initial question about the
FREEZE      game desired.
FREEZE        Note : a TOURNAMENT game is like a frozen game, with the
FREEZE      following differences :
FREEZE      (1) TOURNAMENT games always start from the beginning, while
FREEZE          frozen game can start at any point,
FREEZE      (2) TOURNAMENT games require only that the player remember t
FREEZE          name or number of the TOURNAMENT, while the information
FREEZE          a frozen game must be kept on a file.
GRAPHICS    EXTERNAL
GRAPHICS      Mnemonic              : EXTERNAL
GRAPHICS      Shortest abbreviation : EX
GRAPHICS      (This command is valid for Full-screen users only)
GRAPHICS      The EXTERNAL command toggles the display of external views
GRAPHICS    is, the graphics features of KLINGON.
GRAPHICS      To turn the displays OFF, if displays are "ON" enter the E
GRAPHICS    command, to turn them back ON, enter the command again.
HINTS         The rules for KLINGON are very much like SUPER STAR TREK,
HINTS       following exceptions :
HINTS       - MAX SAFE WARP is 10,
HINTS       - you have a TRACTOR BEAM which can be activated by typing :
HINTS         TRAC TARGET where TARGET is the two number quadrant number
HINTS         tractoring to ... it will pull in any kind of ship,
HINTS       - you do not have phasers,
HINTS       - you may fire 4 torpedoes at a time,
HINTS       - you have an ANTI-PHOTON device which will protect you from
HINTS         of Federation torpedoes (3 torps),
HINTS       - you may not ORBIT, SHUTTLE, CRYSTAL, or use PLANETS comman
HINTS       - you may not ABANDON ×
HINTS       If you are looking for a place to REFUEL (RECHARGE) you can'
HINTS       are two weeks away from HOME. Your energy is replenished by
HINTS       warp energizers at the rate of 1024 units/stardate (i.e. RES
HINTS       MOVE slower than WARP 7 to get more energy).
HINTS       Run out of time and you will die.
HINTS       On the SHORT RANGE SCAN # is a black hole, try not to hit th
HINTS       The object of the game is to kill all the starbases, do so,
HINTS       win. You need not kill any of the starships to win.
HINTS       The CHART and LONG RANGE SCAN key is :
HINTS         1000's digit = KLINGONs (your guys)
HINTS         100's digit  = Federation starships (the enemy)
HINTS         10's digit   = starbases (kill these)
HINTS         1's digit    = stars
HINTS       Your ANTI PHOTON device is disarmed by any hit from a Federa
HINTS         starship ... to rearm it (at a cost of 500 units of energy
HINTS         in A P command.
HINTS       LONG RANGE SCANs show planets.
FS3270      ========================
FS3270      Notes for TSO 3270 users
FS3270      ========================
FS3270
FS3270      For TSO 3270 users, KLINGON is a full screen application.
FS3270      The major differences are :
FS3270
FS3270      The SRSCAN, LRSCAN, and STATUS commands cannot be explicitel
FS3270      entered, since this information is on the screen at all time
FS3270
FS3270      The format of the screen is : ...........  ++++++++++   LRSC
FS3270                                    ...........  ++++++++++   and
FS3270                                    ... SRS ...  + status +
FS3270                                    ...........  ++ info ++   PLAN
FS3270                                    ...........  ++++++++++   info
FS3270      SRS and STATUS : the format of this information is the same
FS3270      standard version. The LRSCAN and PLANET information is the s
FS3270      described in the LRSCAN command, however, the information is
FS3270      sented in a "compressed" form, to allow for the smaller amou
FS3270      space available on the screen.
FS3270      The full screen mode will work only on 24, 32 and 43 lines 3
FS3270      devices. If you wish to experiment with other devices, the G
FS3270      FSIO1 and FSIO2 assembler routines supplied in source are th
FS3270      which must be verified/modified by the user.
BUGS        At the present time, please report any bugs to :
BUGS             Larry Williams
BUGS             P.O. Box 8069
BUGS             Bartlett, IL  60103
BUGS        or : MOINIL P.A. -- Phone number : (0332) 789442
BUGS             Computing Centre (TP 361)
BUGS             J.R.C. - Ispra Establishment
BUGS             21020 ISPRA (VA), ITALY
NEWS                            ××× No News ×××
./     ADD     NAME=#KLPROC
PROC     0 LOADLIB(->.GROUP.KL.LOAD) -
           FREEZEDS(KL.FREEZE) UNM(DISK) VSN(......)  -
           HELPFILE(->.GROUP.KL.HELP) GRAPHIC(->.GROUP.KL.GRAPH)
/*********************************************************************/
/*  COMMENTS ON PARMS PASSED TO THIS CLIST :                         */
/*  ----------------------------------------                         */
/*  LOADLIB  = NAME OF LOAD LIBRARY WHERE THE "KL" AND "KLINIT"      */
/*             PROGRAMS ARE LINKED IN.                               */
/*  FREEZEDS = THE NAME (UNQUALIFIED) FOR THE FREEZE FILE, IN CASE   */
/*             GAME FROZEN.                                          */
/*  UNM/VSN  = UNIT TYPE AND VOLUME SERIAL NUMBER WHERE ALLOCATE     */
/*             THE FREEZE FILE (FT27F001).                           */
/*  HELPFILE = NAME OF DATA-SET WHERE "KLINGON" HELP DATA IS KEPT.   */
/*                                                                   */
/*  GRAPHIC  = "GRAPHICS" IMAGES FOR 3270 TYPE TERMINALS.            */
/*           = (NULLFILE) - NOT USED FOR SEQUENTIAL MODE             */
/*********************************************************************/
         CONTROL NOFLUSH NOMSG
         ERASE
         ERROR DO
           WRITE => NOW ALLOCATING THE FREEZE FILE, PLEASE STAND BY ...
/*       ----> NOTICE THE FREEZE FILE IS ALLOC WITHOUT QUALIFIER, SO */
/*             PROPER PREFIX WILL BE USED.                           */
           ALLOC DD(FT27F001) DA(&FREEZEDS) UNIT(&UNM) VOLUME(&VSN) -
             SP(1 1) TRACKS REL
           WRITE => NOW INITIALIZING FREEZE FILE, PLEASE STAND BY ...
/*       ----> CALL THE INITIALIZATION PROGRAM TO MAKE ZEROES        */
           CALL '&LOADLIB(INITKL)'
           GOTO ALLOCD
           END
/*       ----> FT06F001 IS NOT USED, BUT SOME VERSIONS OF FORTRAN    */
/*             INSIST ON IT, SO ALLOCATED HERE.                      */
         ALLOC DD(FT06F001) DA(*) REUSE
         WRITE => NOW ATTEMPTING TO ALLOCATE YOUR FREEZE FILE
         WRITE => IF NOT FOUND, IT WILL BE CREATED
         ALLOC DD(FT27F001) DA(&FREEZEDS) OLD
ALLOCD:  WRITE => FREEZE FILE ALLOCATION COMPLETE
         ERROR OFF
         FREE ATTR(F)
         ATTR F RECFM(F B) LRECL(80) BLKSIZE(3200) DSORG(PS)
         WRITE => NOW CREATING HIGH SPEED WORK FILES
         ALLOC DD(FT99F001) UNIT(VIO) USING(F) SP(1 1) CYL REUSE
         ALLOC DD(FT98F001) UNIT(VIO) USING(F) SP(1 1) CYL REUSE
         ALLOC DD(FT97F001) UNIT(VIO) USING(F) SP(1 1) CYL REUSE
/*       ----> UNIT=10 IS THE DEBUG FILE, WILL NOT ACTUALLY BE       */
/*             USED UNLESS DEBUG MODE IS ACTIVATED (ACTIVATED BY     */
/*             XDEBUG COMMAND WITH PASSWORD)                         */
/*             N.B. - LIMITED HERE TO ALLOCATE ONLY IF MATCHES       */
/*                    SPECIFIC LOGONID BEING USED                    */
         IF ((&SYSUID = SYSPAJA) OR (&SYSUID = AZC10)) THEN -
           ALLOC DD(FT10F001) SYSOUT(X) HOLD REUSE
/*       ----> UNIT 8  = SYSOUT TO SEND CERTIFICATES OF MERIT TO     */
/*                       (FOR WINNERS OF EXPERT AND EMERITUS GAMES)  */
         ALLOC DD(FT08F001) SYSOUT(A) DEST(RMT41) REUSE NOHOLD
/*       ----> UNIT 26 = KLINGON HELP FILE (NOT IBM STANDARD HELP)   */
         ALLOC DD(FT26F001) DA('&HELPFILE') SHR REUSE INPUT
         WRITENR => DO YOU WISH TO RUN SEQUENTIAL LINE MODE (Y/N) ?
         READ SLM
/*       ----> UNIT 5  = INPUT FROM TERMINAL                         */
/*       ----> UNIT 25 = FILES WHERE GRAPHICS FILES ARE KEPT,        */
/*                       COPIED TO HIGH SPEED WORK FILES             */
         IF &SLM EQ Y OR &SLM EQ YES THEN DO
           ALLOC DD(FT05F001) DA(*) SHR REUSE
           ALLOC DD(FT25F001) DA('NULLFILE') SHR REUSE
           END
         ELSE ALLOC DD(FT25F001) DA('&GRAPHIC') SHR REUSE
         CALL '&LOADLIB(KL)'
         FREE DA('&HELPFILE')
         FREE DA('&LOADLIB')
         FREE DD(FT27F001,FT08F001,FT26F001,FT99F001,FT98F001,FT06F001)
         FREE DD(FT25F001,FT97F001,FT10F001)
         IF &SLM EQ Y OR &SLM EQ YES THEN FREE DD(FT05F001)
         ERASE
         WRITE * = = = = = = = = = = = = = = = = = = = = = = = = = = =*
         WRITE * PLEASE ONLY KEEP THE FREEZE FILE IF YOU FROZE A GAME *
         WRITE * = = = = = = = = = = = = = = = = = = = = = = = = = = =*
         WRITENR => DO YOU WISH TO KEEP THE FREEZE FILE (Y/N) ?
         READ OPT
         IF &OPT EQ Y OR &OPT EQ YES THEN -
           WRITE => FREEZE FILE KEPT
         ELSE DO
           DELETE &FREEZEDS
           WRITE => FREEZE FILE DELETED
           END
         FREE ATTR(F)
         EXIT CODE(0)
./     ADD     NAME=#LINK
 ORDER   MAIN(P)
 ORDER   OUTUNT
 ORDER   TRACKR
 ORDER   TERMSZ
 ORDER   INFOSH
 ORDER   INFO
 ORDER   MISC
 ORDER   TRACOM
 ORDER   NUMBER
 ORDER   SHIPS
 ORDER   CPU
 ORDER   DEVICE
 ORDER   HURT
 ORDER   SSINFO
 ORDER   CWORD
 ORDER   SRCOPY
 ORDER   DEBUG
 ORDER   Z3270
 ORDER   PHASE
 ORDER   EXTRA
 ORDER   SHIFTF
 ORDER   IW
 ORDER   IWI
 ORDER   BRIDGE
 ORDER   ICROG
 ORDER   ISGN
 ORDER   LRSCAN
 ORDER   NUMREC
 ORDER   PRHIT
 ORDER   PRMIM
 ORDER   PRMRM
 ORDER   PRMSG
 ORDER   PRMSM
 ORDER   RAND
 ORDER   RANDF
 ORDER   READIN
 ORDER   SETFOR
 ORDER   SRSCAN
 ORDER   SR3270
 ORDER   SRS
 ORDER   XDEBUG
 ORDER   XFILLB
 ORDER   XCHEAD
 ORDER   DBUGRN
 INCLUDE SYSOBJ(ABANMS)
 INCLUDE SYSOBJ(ABSORB)
 INCLUDE SYSOBJ(ADDQUE)
 INCLUDE SYSOBJ(APDEV)
 INCLUDE SYSOBJ(AROUND)
 INCLUDE SYSOBJ(BATTCK)
 INCLUDE SYSOBJ(BATTLE)
 INCLUDE SYSOBJ(BEEP)
 INCLUDE SYSOBJ(BEEP2)
 INCLUDE SYSOBJ(BLOCKD)
 INCLUDE SYSOBJ(BRIDGE)
 INCLUDE SYSOBJ(BSTAT)
 INCLUDE SYSOBJ(CERT)
 INCLUDE SYSOBJ(COMOVE)
 INCLUDE SYSOBJ(COPVEC)
 INCLUDE SYSOBJ(CORAND)
 INCLUDE SYSOBJ(DAMAGE)
 INCLUDE SYSOBJ(DAMAGR)
 INCLUDE SYSOBJ(DBUGCH)
 INCLUDE SYSOBJ(DBUGIA)
 INCLUDE SYSOBJ(DBUGIN)
 INCLUDE SYSOBJ(DBUGRA)
 INCLUDE SYSOBJ(DBUGRN)
 INCLUDE SYSOBJ(DEBUGX)
 INCLUDE SYSOBJ(DEATHR)
 INCLUDE SYSOBJ(DESMSG)
 INCLUDE SYSOBJ(DISPIN)
 INCLUDE SYSOBJ(DIST)
 INCLUDE SYSOBJ(DOCK)
 INCLUDE SYSOBJ(DRAGIN)
 INCLUDE SYSOBJ(EMPLAC)
 INCLUDE SYSOBJ(ENGUSE)
 INCLUDE SYSOBJ(ENGYST)
 INCLUDE SYSOBJ(ESCAPE)
 INCLUDE SYSOBJ(FREEZE)
 INCLUDE SYSOBJ(FSIO1)
 INCLUDE SYSOBJ(FSIO2)
 INCLUDE SYSOBJ(GAINIT)
 INCLUDE SYSOBJ(GRAFIC)
 INCLUDE SYSOBJ(HELP)
 INCLUDE SYSOBJ(HELPRT)
 INCLUDE SYSOBJ(ICROG)
 INCLUDE SYSOBJ(IDENT)
 INCLUDE SYSOBJ(IFEDST)
 INCLUDE SYSOBJ(IFWIN)
 INCLUDE SYSOBJ(IN3270)
 INCLUDE SYSOBJ(INITCH)
 INCLUDE SYSOBJ(INITCT)
 INCLUDE SYSOBJ(INITDM)
 INCLUDE SYSOBJ(INITGR)
 INCLUDE SYSOBJ(INSFOR)
 INCLUDE SYSOBJ(INTERC)
 INCLUDE SYSOBJ(INTRO)
 INCLUDE SYSOBJ(ISBSET)
 INCLUDE SYSOBJ(ISGN)
 INCLUDE SYSOBJ(ITERPT)
 INCLUDE SYSOBJ(IW)
 INCLUDE SYSOBJ(IWI)
 INCLUDE SYSOBJ(JULIAN)
 INCLUDE SYSOBJ(KILLER)
 INCLUDE SYSOBJ(KL)
 INCLUDE SYSOBJ(LINEF)
 INCLUDE SYSOBJ(LOCATE)
 INCLUDE SYSOBJ(LONINT)
 INCLUDE SYSOBJ(LRSCAN)
 INCLUDE SYSOBJ(MAININ)
 INCLUDE SYSOBJ(M2FAST)
 INCLUDE SYSOBJ(NOVKIL)
 INCLUDE SYSOBJ(NUMREC)
 INCLUDE SYSOBJ(OLDNEW)
 INCLUDE SYSOBJ(ORBIT)
 INCLUDE SYSOBJ(PERHIT)
 INCLUDE SYSOBJ(PHASER)
 INCLUDE SYSOBJ(PHOTON)
 INCLUDE SYSOBJ(PLACE)
 INCLUDE SYSOBJ(PLAGAN)
 INCLUDE SYSOBJ(PLANET)
 INCLUDE SYSOBJ(PRCHRT)
 INCLUDE SYSOBJ(PRHIT)
 INCLUDE SYSOBJ(PRMIM)
 INCLUDE SYSOBJ(PRMRM)
 INCLUDE SYSOBJ(PRMSG)
 INCLUDE SYSOBJ(PRMSGC)
 INCLUDE SYSOBJ(PRMSG1)
 INCLUDE SYSOBJ(PRMSM)
 INCLUDE SYSOBJ(PROMOT)
 INCLUDE SYSOBJ(PRSC)
 INCLUDE SYSOBJ(PRTEND)
 INCLUDE SYSOBJ(RAND)
 INCLUDE SYSOBJ(RANDF)
 INCLUDE SYSOBJ(RANSET)
 INCLUDE SYSOBJ(READIN)
 INCLUDE SYSOBJ(REPAIR)
 INCLUDE SYSOBJ(RESORT)
 INCLUDE SYSOBJ(SCAN)
 INCLUDE SYSOBJ(SCORE)
 INCLUDE SYSOBJ(SECSET)
 INCLUDE SYSOBJ(SENDEC)
 INCLUDE SYSOBJ(SETFED)
 INCLUDE SYSOBJ(SETFOR)
 INCLUDE SYSOBJ(SHECON)
 INCLUDE SYSOBJ(SHIP)
 INCLUDE SYSOBJ(SHIFT)
 INCLUDE SYSOBJ(SHIFTC)
 INCLUDE SYSOBJ(SHIFTAB)
 INCLUDE SYSOBJ(SRS)
 INCLUDE SYSOBJ(SR3270)
 INCLUDE SYSOBJ(SRSCAN)
 INCLUDE SYSOBJ(SSDEST)
 INCLUDE SYSOBJ(SSFIND)
 INCLUDE SYSOBJ(SSINIT)
 INCLUDE SYSOBJ(SSMOVI)
 INCLUDE SYSOBJ(SSMOVO)
 INCLUDE SYSOBJ(SSPRNT)
 INCLUDE SYSOBJ(SSTART)
 INCLUDE SYSOBJ(STARTM)
 INCLUDE SYSOBJ(STAX)
 INCLUDE SYSOBJ(TARSET)
 INCLUDE SYSOBJ(TIME)
 INCLUDE SYSOBJ(TIMMSG)
 INCLUDE SYSOBJ(TIMUSE)
 INCLUDE SYSOBJ(TRACK)
 INCLUDE SYSOBJ(TSMSG)
 INCLUDE SYSOBJ(XFILLB)
 INCLUDE SYSOBJ(XCHEAD)
 INCLUDE SYSOBJ(XDEBUG)
 INCLUDE SYSOBJ(YESNO)
 ENTRY MAIN
 NAME KL(R)
./     ADD     NAME=#LNKINIT
 INCLUDE SYSOBJ(INITKL)
 NAME INITKL(R)
./     ADD     NAME=#MEMLIST
INITKL
KL
ABANMS
ABSORB
ADDQUE
APDEV
AROUND
BATTCK
BATTLE
BEEP
BEEP2
BLOCKD
BRIDGE
BSTAT
CERT
COMOVE
COPVEC
CORAND
DAMAGE
DAMAGR
DBUGCH
DBUGIA
DBUGIN
DBUGRA
DBUGRN
DEATHR
DEBUGX
DESMSG
DISPIN
DIST
DOCK
DRAGIN
EMPLAC
ENGUSE
ENGYST
ESCAPE
FREEZE
FSIO1
FSIO2
GAINIT
GRAFIC
HELP
HELPRT
ICROG
IDENT
IFEDST
IFWIN
INITCH
INITCT
INITDM
INITGR
INSFOR
INTERC
INTRO
IN3270
ISBSET
ISGN
ITERPT
IW
IWI
JULIAN
KILLER
LINEF
LOCATE
LONINT
LRSCAN
MAININ
M2FAST
NOVKIL
NUMREC
OLDNEW
ORBIT
PERHIT
PHASER
PHOTON
PLACE
PLAGAN
PLANET
PRCHRT
PRHIT
PRMIM
PRMRM
PRMSG
PRMSGC
PRMSG1
PRMSM
PROMOT
PRSC
PRTEND
RAND
RANDF
RANSET
READIN
REPAIR
RESORT
SCAN
SCORE
SECSET
SENDEC
SETFED
SETFOR
SHECON
SHIFT
SHIFTAB
SHIFTC
SHIP
SRS
SRSCAN
SR3270
SSDEST
SSFIND
SSINIT
SSMOVI
SSMOVO
SSPRNT
SSTART
STARTM
STAX
TARSET
TIME
TIMMSG
TIMUSE
TRACK
TSMSG
XCHEAD
XDEBUG
XFILLB
YESNO
./     ADD     NAME=#RULES
1
0                                                                Page 1
0                                 K L I N G O N
+                                 _____________
0                A  S P A C E   W A R   S T A R   T R E K   G A M E
0                                      by
0                                LARRY WILLIAMS
0        Rules adapted from a game "SUPER STAR TREK", written by David
         MATUSZEK and  Paul REYNOLDS, rewritten for the HARRIS 220
         at PENN STATE UNIVERSITY by Rod HILLS and extended by John
         MCLAUGHLIN.
0        No portion of the code from SUPER STAR TREK was used in
         writing KLINGON.
0        Permission is hereby granted for the copying, distribution,
         modification and use of this program and associated
         documentation for recreational purposes, provided that all
         references to the author are retained. However, permission
         is not and will not be granted for the sale or promotional
         use of this program or program documentation, or for use in
         any situation in which profit may be considered an objective,
         since it is the desire of the author to respect the copyrights
         of the originators of STAR TREK.
0        ---------------------------------------------------------------
0        The Organian Peace Treaty has collapsed, and the Federation
         is at war with the KLINGON empire, and you are the commander
         of the flagship of the KLINGON empire : the supercommander
         KAZH, the mighest ship in the known galaxy.
0        Your battleground is Federation space, which for convenience
         is divided up into eight rows of eight quadrants each, like
         a checkerboard. Rows are numbered from top to bottom, and
         columns are numbered left to right, so quadrant 1 - 8 would
         be in the upper right hand corner of the galaxy.
0        During battle you will be concerned only with those enemies,
         that is to say, Federation starbases, and Federation
         starships, that occupy the same quadrant as yourself.
         Quadrants are divided up into sectors, ten rows of ten sectors
         each. Sectors are numbered in the same way as quadrants, so
         the sector in the upper right corner is sector 1 - 10. You
         have a SHORT-RANGE SCANNER which allows you to look at the
         entire quadrant in a single display.
0        Enemies recharge during your absence. If you leave a quadrant
         containing a weakened enemy, when you return to that quadrant
         he will be strong again. Also, each time you enter a quadrant,
         the positions of everything in the quadrant (except your ship)
         are randomized, to save you the trouble of trying to remember
         where everything in the quadrant is. Notice that this refers
         only to the positions of things in the quadrant--the numbers
         of each kind of thing are not changed (except black holes)
         if you kill something, it stays dead.
1
0                                                                Page 2
0        There are two kinds of KLINGONs commanders, and yourself, the
         supercommander KAZH, the commanders are not quite a match for
         a Federation starship, but they can do quite a bit of damage.
0        Your ship contains the most advanced KLINGON engineering
         features, including a LONG RANGE TRACTOR BEAM, an ANTI-PHOTON
         device, and a DILITHIUM RE-ENERGIZER that can refocus energy
         from your main energy cells, back into the MATTER-ANTIMATTER
         CONVERTERS to create energy at a rate of 1024 units/stardates,
         recharging your ship. This recharging is essential to your home
         possibility of success for you and your strike force, since
         is two weeks away, and you can't stop anyplace for energy.
0        There is yet another problem, too, you don't have the element
         of surprise forever, you must break through the Federation
         defenses, and destroy all starbases before the Federation has
         time to muster a defense to your strike force, in about 7
         stardates.
0        In light of this energy shortage, your ship is not equipped
         with any kind of energy weapons, such as phasers, but instead
         is equipped with ULTRA HIGH POWER DISRUPTOR TORPEDOES, each
         containing over ten grams of anti-matter.
0        If you succeed in your mission, which is not an easy one, then
         many riches of the galaxy will be yours, and you will have
         complete control over all Federation space, making the galaxy
         safe for treachery forever.
0        Space is vast, and it takes precious time to move from one
         place to another. In comparison, other things happen so quickly
         that we assume they take no time at all. Two ways that time can
         pass are when you move, or when you issue a command to sit
         still and REST for a period of time. You will sometimes want to
         do the latter, since the various devices aboard your starship
         may be damaged and require time to repair.
0        In addition to starships and starbases, the galaxy contains
         (surprise) stars. Mostly, stars are a nuisance and just get in
         your way. However, stars can be very useful when next to an
         intended target, as they can then be made to go NOVA, causing
         heavy damage to any nearby ships or starbases. If another star
         is adjacent to a NOVA, it too will go NOVA. Stars may also
         occasionally go SUPERNOVA; a SUPERNOVA in a quadrant destroys
         everything in the quadrant and makes the quadrant permanently
         uninhabitable. You may "JUMP OVER" a quadrant containing a
         SUPERNOVA when you MOVE, but you should not STOP there.
1
0                                                                Page 3
0        SUPERNOVAs are a rare natural event, the most likely way for a
         start to go SUPERNOVA is for one of your DISRUPTOR TORPEDOES
         to set it off. In the event you do set off a star (10%) and it
         goes SUPERNOVA, navigational control of your ship will be
         taken over by your battle computer, and you will be piloted
         out of the quadrant, picking as a target quadrant, one of the
         following : (in order of preference)
0             1. the nearest quadrant that does not contain an enemy
                 starbase or starship,
0             2. a quadrant slightly more distant that does not contain
                 an enemy,
0             3. the nearest quadrant to which the path is clear,
0             4. any quadrant to which you can move.
0        If your BATTLE COMPUTER is damaged, you will be given a random
         course to a random nearby quadrant.
0        Also a few PLANETs are scattered through the galaxy. These can
         be very helpful, and you get time bonus (which can be turned
         into energy by RESTing,  which increases your energy supply)
         depending on the billions of people killed and whether the
         planet had dilithium when you blow up these planets. Planets
         can be detected on the LONG RANGE SCANNERS.
0        Finally, each quadrant will contain from 0 to 3 black holes.
         These can swallow TORPEDOES passing near them. They are just
         something to get in your way, and serve no useful purpose.
1
0                                                                Page 4
0                  --------- HOW TO ISSUE COMMANDS ---------
0        (IBM 327X TSO users should refer to "Appendix T - Notes for
         TSO full screen users")
0        When the game is waiting for you to enter a command, it will
         print out :
                   COMMAND - ?
         you may then type in your command. All you have to remember
         for each command is the mnemonic. For example, if you want to
         MOVE straight up for one quadrant, you can type in the
         mnemonic "MOVE" and the computer will prompt you with :
                   MANUAL OR AUTOMATIC?
         say you type in 'MANUAL'. The computer then responds :
                   X AND Y DISPLACEMENTS-
         now you type in 0 1 which specifies an X movement of zero and
         a Y movement of 1.
         When you have learned the commands, you can avoid being
         prompted by simply typing in the information without waiting
         to be asked for it. For example, in the above example, you
         could simply type in :
                   MOVE MANUAL 0 1
         and it will be done. Or you could type in :
                   MOVE MANUAL
         and when the computer responds with :
                   X AND Y DISPLACEMENTS-
         you can type in :
                   0 1
         and it will understand. You can abbreviate most mnemonics.
         For "MOVE", you can use any of :
                   MOVE     MOV     MO     M
         successfully. For your safety, certain critical commands (such
         as to TERMINATE) must be written out in full. Also, in a few
         cases two or more commands begin with the same letter, and in
         this case that letter refers to a particular one of the
         commands; to get the other, your abbreviation must be two or
         more letters long. This sounds complicated, but you will learn
         the abbreviations quickly enough.
0        What this all boils down to is :
              (1) you can abbreviate practically anything,
              (2) if you forget, the computer will prompt you,
              (3) if you remember, you can type it all on one line.
         If you are part way through entering a command and you change
         your mind, you can cancel the command by typing a -1 as one of
         the parameters, with the exception of the MANUAL MOVE command
         (type X and Y of 0 0 to cancel a MOVE MANUAL).
0        If anything is not clear to you, experiment. The worst you can
         do is lose a game or two.
1
0                                                                Page 5
0                ---------  C  O  M  M  A  N  D  S  ---------
0        ABANDON SHIP
+        ____________
0        Mnemonic : ABANDON
         (No abbreviation)
0        You may not ABANDON ship, that is unworthy of a KLINGON.
0
0        ANTI-PHOTON DEVICE
+        __________________
0        Mnemonic : ANTI PHOTON
         Shortest abbreviation : A P
         Full command : ANTI PHOTON
0        Like all KLINGON commanders, your ship is equipped with an
         ANTI-PHOTON device. This A.P.D. will protect you from one
         round of Federation PHOTON TORPEDOES (3). The A.P.D. requires
         500 units of shield energy to activate it. Two things can
         disarm the ANTI-PHOTON device, 1. it absorbs a full round of
         TORPEDOES or 2. a Federation starship fires phasers at you
         (the A.P.D. is run by the ship's main computer, not the battle
         computer, and as such is not affected when the battle computer
         is damaged and can be used even if your shields are down).
0        The use of the ANTI PHOTON device does not count as a turn and
         can be activated instantly, even during battle, at no cost in
         time, and does not allow enemies to attack.
0
0        BATTERY
+        _______
0        Mnemonic :BATTERY
         Shortest abbreviation :BATT
0        The BATTERY command provides information of whether your
         batteries (used if you fall below zero energy) are charged or
         not, once the batteries are drained there is no way to recharge
         them. They contain 750.0 units of energy.
1
0                                                                Page 6
0        CHART
+        _____
0        Mnemonic : CHART
         Shortest abbreviation : C
0        As you proceed in the game, you learn more and more about what
         things are where in the galaxy. This information is automati-
         cally recorded for you in your star CHART.
0        The CHART looks like an 8 by 8 array of numbers. These numbers
         are interpreted exactly as they are on a LONG-RANGE SCAN.
         A period (.) in place of a digit means you do not know that
         information yet. For example, ... means you know nothing about
         the quadrant.
0        Looking at the star CHART is a free operation. It costs you
         neither time nor energy, and can be done safely whether in or
         out of battle.
0
0        COMPUTE MOVEMENT
+        ________________
0        Mnemonic : COMPUTE
         Shortest abbreviation : CO
         Full commands : COMPUTE AUTOMATIC <ROWSEC> <COLSEC>
                         COMPUTE AUTOMATIC <RQUAD> <CQUAD> <RSEC> <CSEC>
                         COMPUTE MANUAL <X-DISP> <Y-DISP>
0        The ship's COMPUTER allows you to get some information about
         movement, before you actually move. You enter the destination
         you are considering in the same format as MOVE.
         The COMPUTER will then calculate and report to you the time
         and energy required for such a trip.
0        This command requires no time or energy, so you may use it
         anytime your ship's COMPUTER is undamaged.
1
0                                                                Page 7
0        COMPUTER (BATTLE)
+        _________________
0        Mnemonic : -none-
         (Not a command)
0        While not a command, this section is to document what functions
         are handled by the "SHIP'S COMPUTER" which is in the heart of
         the ship and not open to attack, and what is controlled by the
         "BATTLE COMPUTER" (can't do everything on one COMPUTER×).
0        Usually the functions controlled by the BATTLE COMPUTER are
         less critical.
0        Controlled by the BATTLE COMPUTER :
0             Compute of movement
              Compute of path out of way of SUPERNOVA
              Control of battery if power below zero
              Move automatic functions
0        Functions handled by "SHIP'S COMPUTER" (not open to attack)
0             DEFLECTOR SCREEN control (considered vital)
              Control of ship's energy allowing transfer of energy
              Automating Dampening System (when DISRUPTOR TORPEDOES
                   explode in the firing tubes)
              Star CHART
              WARP engine control
              ANTI-PHOTON device
1
0                                                                Page 8
0        DAMAGE REPORT
+        _____________
0        Mnemonic : DAMAGES
         Shortest abbreviation : DA
0        At any time you may ask for a damage report to find out what
         devices are damaged and how long it will take to repair them.
0        If you suffer damages and MOVE, it is possible that a subse-
         quent damage report will not show any damage. This happens if
         the time spent on the MOVE exceeds the repair time, since in
         this case the damaged devices were fixed en route.
0        Damage reports are free. They use no energy or time, and can
         be done safely even in the midst of battle.
0
0        DEFLECTOR SHIELDS
+        _________________
0        Mnemonic : SHIELDS
         Shortest abbreviation : SH
         Full commands : SHIELDS UP
                         SHIELDS DOWN
                         SHIELDS TRANSFER (AMOUNT OF ENERGY TO TRANSFER)
0        Your DEFLECTOR SHIELDS are a defensive device to protect you
         from Federation attacks (and nearby NOVAs). As the shields
         protect you, they gradually weaken. A shield strength of 75
         percent, for example, means that the next time you are
         attacked, your shields will deflect 75 percent of the hit, and
         let 25 percent get through to hurt you.
0        It costs 50 units of energy to raise shields, nothing to lower
         them.
0        You should never have to raise or lower shields manually, as
         your automatic DEFLECTOR SCREEN CONTROL will do this for you,
         as you go into battle, and leave battle.
0        You may transfer energy between the ship's energy (given as
         (ENERGY) in STATUS) and the shields. (TRANSFER) may be
         abbreviated (T). (AMOUNT OF ENERGY TO TRANSFER) is the number
         of units of energy you wish to take from the ship's energy and
         put into the shields. If you specify a negative number, energy
         is drained from the shields to the ship.
         Transferring energy constitutes a turn. If you transfer energy
         to the shields while under attack, they will be at the new
         energy level when you are next hit.
0        Enemy TORPEDOES hitting your ship explode on your shields (if
         they are up) and have essentially the same effect as phaser
         hits.
1
0                                                                Page 9
0        DISRUPTOR TORPEDOES
+        ___________________
0        Mnemonic : DISRUPTOR
         Shortest abbreviation : DIS
         Full commands : DISRUPTOR (NUMBER),(T1),(T2),(T3),(T4)
                                   (T1, T2... means "TARGET NUMBER")
0        DISRUPTOR TORPEDOES are projectile weapons--you either hit
         what you aim at, or you don't. There are no 'PARTIAL HITS'.
0        You may fire DISRUPTOR TORPEDOES singly, or in bursts of two,
         three or four. Each TORPEDO is individually targettable
         The computer will prompt you, asking for the target sector
         for each TORPEDO. Alternately, you may specify each taraget
         in the command line.
0        If more than one TORPEDO is fired and only one target sector
         is specified, all TORPEDOES are fired at that sector. For
         example, to fire two TORPEDOES at sector 3 - 4, you type :
0             DIS 2 3 4           (or)           DIS 2 3 4 3 4
0        To fire TORPEDOES at, consecutively, sectors 2 - 6,  1 - 10,
         and 4 - 7, type :
0             DIS 3 2 6 1 10 4 7
0        There is no restriction to fire directly at a sector. For
         example, you can enter :
0             DIS 1 3 2.5
0        to aim between two sectors. However, sector numbers must be
         1 to 10 inclusive.
0        TORPEDOES going within 0.5 sectors of a black hole are
         swallowed. If your DISRUPTOR TORPEDO tubes are damaged less
         than 3 stardates, you can still fire 2 TORPEDOES (instead of
         4).
0
0        DESTRUCT
+        ________
0        Mnemonic : DESTRUCT
0        (No abbreviation)
0        You may self-DESTRUCT, thus killing yourself and ending the
         game.
1
0                                                               Page 10
0        EXTERNAL
+        ________
0        Mnemonic : EXTERNAL
         Shortest abbreviation : EX
0        (This command is valid for Full-screen users only)
0        The "EXTERNAL" command toggles the display of external views,
         that is, the graphics features of KLINGON.
0        To turn the displays OFF, if displays are "ON" enter the
         "EXTERNAL" command, to turn them back ON, enter the command
         again.
0
0        FREEZE
+        ______
0        Mnemonic : FREEZE
         (No abbreviation)
0        The purpose of the "FREEZE" command is to allow a player to
         save the current state of the game, so that it can be finished
         later. All pertinant information about the game is written to
         a FREEZE file, saved on the users catalog, and the game stops.
0        To restart a game created by the 'FREEZE' command, the user
         need only type 'OLD' in response to the initial question about
         the type of game desired, followed by the (FILE NAME).
0        Note : a 'TOURNAMENT' game is like a frozen game, with the
         following differences : (1) TOURNAMENT games always start from
         the beginning, While a frozen game can start at any point,
         (2) TOURNAMENT games require only that the player remember the
         name or number of the TOURNAMENT, while the information about
         a frozen game must be kept on a file.
0
0        HELP
+        ____
0        Mnemonic : HELP
         (No abbreviation)
0        HELP command connects you with the KLINGON help data base, for
         quick help on using a command.
1
0                                                               Page 11
0        IMPULSE ENGINES
+        _______________
0        Mnemonic : IMPULSE
         Shortest abbreviation : I
         Full command : IMPULSE (MANUAL or AUTOMATIC),(DISP or DEST)
                                            ("DISP" means displacement,
                                             "DEST" is destination)
0        The IMPULSE ENGINES give you a way to MOVE when your WARP
         engines are damaged. They move you at a speed of 0.95 sectors
         per stardate, which is the equivalent os a WARP FACTOR of about
         0.975, so they are much too slow to use except in emergencies.
0        Movement commands are indicated just as in the 'MOVE' command.
0        The IMPULSE ENGINES require 20 units of energy to engage, plus
         10 units per sector (100 units per quadrant) travelled.
0
0        LONG-RANGE SCAN
+        _______________
0        Mnemonic : LRSCAN
         Shortest abbreviation : L
0        A LONG-RANGE SCAN gives you general information about where
         you are and what is around you. Here is an example output :
0             LONG RANGE SCAN FOR AREA:  1 - 4
0                ****   ****   ****
0                 102      2   9999
0                1007      3     19
0             PLANET DETECTED IN QUADRANT:  2 - 5
0        This scan says that you are in row 1, column 4 of the 8 by 8
         galaxy. The numbers in the scan indicate how many of each kind
         of thing there is in your quadrant and all adjacent quadrants.
         The digits are interpreted as follows :
0             THOUSANDs digit = 1000 indicates a KLINGON commander,
              HUNDREDs digit  = number of Federation starships,
              TENs digit      = number of starbases present,
              ONEs digit      = number of stars present,
              9999            = indicates SUPERNOVA,
              ****            = edge of Federation space.
1
0                                                               Page 12
0        For example, in your quadrant (1 - 4) the number is 2, which
         indicates 2 stars, you, and nothing else (you are always in
         the center quadrant of these scans). There is a Federation
         starship in quadrant 1 - 3 (102),  a commander and seven stars
         in quadrant 2 - 3 (1007), a SUPERNOVA in quadrant 1 - 5 (9999)
         and a starbase, and nine stars in 2 - 5 (19).
0        You might also notice a report on a planet in quadrant 2 - 5
         unlike SUPER STAR TREK, planets are detectable by LONG RANGE
         SCAN, so that if they are in your flight path, you can stop
         and kill it if you wish.
0        Since you are in row 1, there are no quadrants above you.
         The  ****'s indicate the border of Federation space, which
         you are not permitted to cross.
0        LONG-RANGE SCANs are free. They use up no energy or time, and
         can be done safely regardless of battle conditions.
0
0        MOVE UNDER WARP DRIVE
+        _____________________
0        Mnemonic : MOVE
         Shortest abbreviation : M
         Full command : MOVE MANUAL (DISPLACEMENT)
                        MOVE AUTOMATIC (DESTINATION)
0        This command is the usual way to MOVE from one place to
         another within the galaxy. You MOVE under WARP DRIVE,
         according to the current WARP FACTOR (see 'WARP FACTOR').
0        There are two command modes for movement; MANUAL and
         AUTOMATIC. The MANUAL mode requires the following format :
0                  MOVE MANUAL (DELTX),(DELTY)
0        (DELTX) and (DELTY) are the horizontal and vertical
         displacements for your starship, in quadrants; a displacement
         of one sector is 0.1 quadrants. Specifying (DELTX) and (DELTY)
         causes your ship to MOVE in a straight line to the specified
         destination. If (DELTY) is omitted, it is assumed zero. For
         example, the shortest possible command to MOVE 1 sector to the
         right would be :
0                  M M .1
1
0                                                               Page 13
0        The following examples of MANUAL movement refer to the
         SHORT-RANGE SCAN example.
0             DESTINATION SECTOR      MANUAL MOVEMENT COMMAND
0                   3 - 1                    M M -.3 .1
                    2 - 1                    M M -.3 .2
                    1 - 2                    M M -.2 .3
                    3 - 4                    M M 0 .1
              (LEAVING QUADRANT)             M M .7
                    3 - 5                    M M .1 .1
                    4 - 10                   M M .6
                    6 - 6                    M M .2 -.2
                    5 - 4                    M M 0 -.1
0        The AUTOMATIC mode is as follows :
0                  MOVE AUTOMATIC (QROW),(QCOL),(SROW),(SCOL)
0        where (QROW) and (QCOL) are the row and column numbers of the
         destination quadrant, and (SROW) and (SCOL) are the row and
         column numbers of the destination sector within that quadrant.
         This command also MOVEs your ship in a straight line path to
         the destination. For moving within a quadrant, (QROW) and
         (QCOL) may be omitted. For example, to MOVE to sector 2 - 9
         in the current quadrant, the shortest command would be :
0                  M A 2 9
0        To MOVE to quadrant 3 - 7, sector 5 - 8, type :
0                  M A 3 7 5 8
0        and it will be done. In AUTOMATIC mode, either two or four
         numbers must be supplied.
0        AUTOMATIC mode utilizes the ship's 'BATTLE COMPUTER'. If the
         COMPUTER is damaged, MANUAL movement must be used.
0        If WARP ENGINES are damaged less than 5 stardates you can
         still go WARP five.
0        It uses time and energy to MOVE. How much time and how much
         energy depends on your current WARP FACTOR and the distance you
         MOVE. The higher the WARP FACTOR, the faster you MOVE, and the
         more energy you use, but the WARP ENGINES are more efficient at
         high speeds.
0        In other words, to get there twice as fast does not use twice
         as much energy.
0        The suggested WARP speed is WARP 10, the fastest "SAFE" speed.
1
0                                                               Page 14
0        PHOTON TORPEDOES
+        ________________
0        See DISRUPTOR TORPEDO command.
0
0        REST
+        ____
0        Mnemonic : REST
         Shortest abbreviation : RES
         Full command : REST (NUMBER OF STARDATES)
0        This command simply allows the specified number of stardates
         to go by. This is useful if you have suffered damages and wish
         to wait until repairs are made before you go back into battle,
         or you wish to REST to restore energy (1024 units/stardate).
0        It is not generally advisable to REST while you are under
         attack by the Federation.
0
0        SENSOR-SCAN
+        ___________
0        Mnemonic : SENSORS
         Shortest abbreviation : SE
0        Utilizing the SHORT-RANGE SENSORS, your first officer gives
         you a readout on any planet in your quadrant.
1
0                                                               Page 15
0        SHORT-RANGE SCAN
+        ________________
0        Mnemonic : SRSCAN
         Shortest abbreviation : S
         Full commands : SRSCAN
                         SRSCAN NO
         (TSO 327X users should refer to "Appendix T - Notes for TSO
         full screen users")
0        The SHORT-RANGE SCAN gives you a considerable amount of
         information about the quadrant your starship is in. A SHORT
         RANGE SCAN is best described by an example.
0              1 2 3 4 5 6 7 8 9 10
             1 * . . . . . . . . .  TORPEDOES    150 CONDITION: READY
             2 . . . F . . . . . .  POSITION    5 - 1, 4 - 4
             3 . . . . . * . B . .  STARDATE    4300.00
             4 . . . S . . . . . .  REMAINING      6.93
             5 . . . . . . . . . .  CONDITION   RED   A.P.D.  ARMED
             6 . . . # . . . . * .  ENERGY      2176.25
             7 . . . . . P . . . .  SHIELDS   UP  3472 PCT 11800 UNTS
             8 . . . . * . . . . .  WARP FACTOR   10.00
             9 . * . . * . . . C .  FEDERATION  BASES 6  STARSHIPS 4
            10 . . . . . . . . . .  KLINGON     COMMANDERS  4
0        The left part is a picture of the quadrant.
         The S at sector 4 - 4 represents the supercommander KAZH; the
         B at sector 3 - 8 is a starbase. There is a KLINGON commander
         (C) at sector 9 - 9, and a planet at sector 7 - 6.
         Other features in the quadrant are a Federation starship (F),
         at 2 - 4, and a black hole at 6 - 4 (#). The stars (*) are
         located at 1 - 1, 3 - 6, 6 - 9, 8 - 5, 9 - 2, and 9 - 5.
0        The periods (.) are just empty space--they are printed to help
         you get your bearings.
0        The information on the right is assorted STATUS information.
         The STATUS information will be absent if you type NO after
         SRSCAN. Otherwise, STATUS information will be presented.
0        SHORT-RANGE SCANs are free. That is, they use up no energy and
         no time. If you are in battle, doing a SHORT-RANGE SCAN does
         not give the enemies another chance to hit you. You can safely
         do a SHORT-RANGE SCAN anytime you like.
1
0                                                               Page 16
0        STATUS REPORT
+        _____________
0        Mnemonic : STATUS
         Shortest abbreviation : ST
         (TSO 327X users should refer to "Appendix T - Notes for TSO
         full screen users")
0        This command gives you information about the current state of
         your starship, as follows :
0             STARDATE - the current date. A stardate is the same as
                   a day.
0             CONDITION - there are four possible conditions :
0                  RED    - in battle,
                   YELLOW - low on energy (0/1000 units),
                   GREEN  - none of the above.
0             POSITION - quadrant is given first, then sector.
0             FEDERATION - gives the numbers on how many starships and
                   starships are left for the Federation.
0             WARP FACTOR - what your WARP FACTOR is currently set to.
0             ENERGY - the amount of energy you have left. If it drops
                   to zero, one dose of 750.0 units of energy will be
                   taken from your batteries, provided your BATTLE
                   COMPUTER is working, and the batteries are charged.
0             TORPEDOES - how many DISRUPTOR TORPEDOES you have left.
                   Also tells what the STATUS of your DISRUPTOR TORPEDO
                   tubes are :
0                       OUT - no TORPEDOES left,
                        READY - TORPEDOES standing by to fire,
                        DAMAGED - TORPEDO tubes are damaged.
0             SHIELDS - whether your shields are up or down, how strong
                   they are (what percent of a hit they can deflect),
                   and shield energy.
0             KLINGON - how many of your friendly ships are out there.
0             REMAINING - how long you have to crush the Federation if
                   it reaches zero, the Federation wins, and you will
                   then be opening sealed orders.
0        STATUS information is free--it uses no time or energy, and if
         you are in battle, the Federation is not given another chance
         to hit you.
0        STATUS information can also be obtained by doing a SHORT-RANGE
         SCAN. See the (SRSCAN) command for details.
1
0                                                               Page 17
0        TERMINATE THE CURRENT GAME
+        __________________________
0        Mnemonic : TERMINATE
         (No abbreviation)
0        Immediately CANCEL the current game. No conclusion is reached
         and no score is computed. You will be given an opportunity to
         start a new game or to leave the STAR TREK program.
0
0        TRACTOR BEAM
+        ____________
0        Mnemonic : TRACTOR
         Shortest abbreviation : TRAC
         Full command : TRACTOR (TARGET QUADRANT)
0        The TRACTOR command allows you to pull a ship across some
         distance in space. When this command is issued you will be
         prompted with the amount of energy it would take to pull a
         ship that far, and asked if you still wish to engage the
         TRACTOR BEAM, if a ship is found at the target quadrant it
         will be pulled to your quadrant. If there is more than one at
         the target quadrant, one will be selected randomly.
0        If there is no ship at the target quadrant, you will be
         notified of this fact, and the power drain caused by the
         TRACTOR BEAM will be cut by 50%.
0        It is possible to TRACTOR either commanders (to help out in a
         fight perhaps) or Federation starships, starbases, planets,
         stars, and black holes are not effected by the TRACTORs.
0        The use of the TRACTOR BEAM constitutes a turn, and enemies
         will attack.
0
0        WARP FACTOR
+        ___________
0        Mnemonic : WARP
         Shortest abbreviation : W
         Full command : WARP (NUMBER)
0        Your WARP FACTOR controls the speed of your starship. The
         larger the WARP FACTOR, the faster you go and the more energy
         you use.
0        Your minimum WARP FACTOR is 1.0 and your maximum WARP FACTOR
         is 12.0. At speeds above WARP 10 there is some danger of
         causing damage to your WARP ENGINES; this damage is larger
         at higher WARP FACTORs and also depends on how far you go at
         that WARP FACTOR.
1
0                                                               Page 18
0        XDEBUG
+        ______
0        Mnemonic : XDEBUG
         Shortest abbreviation : XDEBUG
         Full command : XDEBUG
0        The Extended Debugging feature is used (under advisment of the
         user maintaining the game program) to provide trace information
         on routine flow.
0        If you enter this command by mistake, enter any random
         PASSWORD, the program will then reject the command and proceed
         with play.
0
0
0                  --------- MISCELLANEOUS NOTES ---------
0        If a Federation starbase or planet is attacked, but not
         destroyed (and there is anyone alive to do it), a subspace
         radio call on the star fleet priority one channel will go out,
         meaning that if there are any Federation starships nearby, you
         will soon have lots of company ...
0        BLACK HOLEs move about, randomly.
0        The type of DISRUPTOR TORPEDOES you carry have been known to
         explode in the firing tube, but that is rather rare.
0        When hits are shot at the supercommander KAZH, the hit is
         shown as two numbers, example :
0             (112,1832)  UNIT HIT FROM FEDERATION STARSHIP AT 1 - 1
0        this means that your shields absorbed 1832 units, and your
         ship got hit with 112 units.
1
0                                                               Page 19
0                         --------- SCORING ---------
0        Scoring is fairly simple. You get points for good things, and
         you lose points for bad things.
0        You gain :
0             (1) 200 points for each Federation starbase,
              (2) 100 points for each Federation starship you destroy,
              (3) you get a win bonus based on your skill level,
                  10000-GOOD, 20000-EXPERT, 30000-EMERITUS,
              (4) a special win bonus for time remaining,
              (5) a promotion to the next level, for any win,
              (6) a point bonus for billions of people killed on
                  planets, and an extra bonus for dilithium.
0        You lose :
0             (7) 75 points for each commander destroyed,
              (8) 1000 points if you get yourself killed.
0        You can be promoted from any level. There is a special
         promotion available if you go beyond the 'EXPERT' range.
         You can also have a certificate of merit printed with your
         name, and date provided you are promoted from either the
         'EXPERT' or 'EMERITUS' levels.
0        You should probably start out at the GOOD level, even if you
         are already familiar with one of the other versions of the
         STAR TREK GAME--but, of course, the level of game you play
         is up to you. If you want to start at the EXPERT level, go
         ahead. It's your funeral. The EMERITUS game is considered
         impossible by some (although it is rumored that the author
         wins about 10 percent of the time).
1
0                                                               Page 20
0                  --------- HANDY REFERENCE PAGE ---------
         Abbrev.   Full command                      Device used
         --------  --------------------------------  -------------------
         A P       ANTI PHOTON                       (none)
         BATT      BATTERY                           (none)
         C         CHART                             (none)
         CO        COMPUTE AUTO (DESTINATION)        COMPUTER
                   COMPUTE MANUAL (X-DISP) (Y-DISP)   " "
         DA        DAMAGES                           (none)
         DIS       DISRUPTOR (NUMBER) (TARGETS)      DISRUPTOR TORPEDOES
         DESTRUCT  DESTRUCT                          (none)
         EXT       EXTERNAL (Turn off graphics)      (none)
         FREEZE    FREEZE                            (none)
         HELP      HELP                              (none)
         I         IMPULSE MANUAL (DISPLACEMENT)     IMPULSE ENGINES
                   IMPULSE AUTOMATIC (DESTINATION)   IMPULSE ENGINES/
                                                             COMPUTER
         L         LRSCAN                            LONG-RANGE SENSORS
         M         MOVE MANUAL (DISPLACEMENT)        WARP ENGINES
                   MOVE AUTOMATIC (DESTINATION)      WARP ENGINES/
                                                          COMPUTER
         P         SAME AS DISRUPTOR                  - -
         RES       REST (NUMBER OF STARDATES)        (none)
         SE        SENSORS                           SHORT-RANGE SENSORS
         SH        SHIELDS (UP, DOWN, OR TRANSFER)   DEFLECTOR SHIELDS
         S         SRSCAN (NO)                       SHORT-RANGE
                                                       SENSORS
         ST        STATUS                            (none)
         TERMINATE TERMINATE                         (none)
0        L. R. SCAN : THOUSANDs digit = commanders
                      HUNDREDs digit  = Federation starships
                      TENs digit      = starbases
                      ONEs digit      = stars
                      ****            = edge of Federation space
                      9999            = SUPERNOVA
                      PERIOD (.)      = digit not known
                                        (star CHART only)
0        Courses are given in MANUAL mode in X - Y displacements; in
         AUTOMATIC mode as destination quadrant and/or sector.
         Distances are given in quadrants. A distance of one sector is
         0.1 quadrant. Starbases require 4 to 6 TORPEDOES to kill,
         while a Federation requires 2-4 TORPEDOES to kill, and planets
         anywhere from 1-4 TORPEDOES depending on population and
         presence of dilithium.
0        WARP 10 is the fastest safe speed. At higher speeds, engine
         damage may occur. Shields cost 50 units of energy to raise.
1
0                                                               Page 21
0                       --------- ACKNOWLEDGMENTS ---------
0        The author would like to thank Mark STEVENS of GOVERNER'S
         STATE UNIVERSITY, located in PARK FOREST, ILLINOIS, for
         programming assistance and support. Other thanks go to Tim
         LYON of NORTHERN ILLINOIS UNIVERSITY, and Raymond POWERS for
         extensive playtesting of the prototypes of the game (they
         found most of the bugs, firsthand).
0        And deepest thanks go to David MATUSZEK and Paul REYNOLDS
         (whom I have never met) for giving permission in the rules
         of SUPER STAR TREK, the game on which this one is based, for
         allowing the copying or modification of their rules without
         charge. A majority of these rules are taken directly from
         the text of their rules, word for word.
0        And thanks as well to Wes PALMER of the EDUCATIONAL
         COMPUTING NETWORK, for putting up with my questions about
         the program "SUPER STAR TREK".
0             Thanks all ...
                                       Yours truly,
0                                     LARRY WILLIAMS
                                      Author of the KLINGON program.
0
0                       --------- REFERENCES ---------
0        1. STAR TREK (the original television series), produced by
            Gene RODENBERRY.
0        2. STAR TREK (the animated television series), produced by
            Gene RODENBERRY and Hal SUTHERLAND.
0        3. The making of STAR TREK, by Steven E. WHITFIELD and Gene
            RODENBERRY. The best and most complete readily available
            book about STAR TREK (BALLANTINE books).
0        4. The world of STAR TREK, by David GERROLD. Similar in scope
            to the above book (BANTAM).
0        5. The STAR TREK guide, third revision 4/17/67, by Gene
            RODENBERRY. The original writer's guide for the television
            series, but less comprehensive than (3) above (NORWAY
            productions).
0        6. The TROUBLE with TRIBBLES, by David GERROLD. Includes the
            complete script of this popular show (BALLANTINE books).
0        7. STAR TREK, STAR TREK 2, ..., STAR TREK 12,  by James BLISH.
            The original shows in short story form (BANTAM).
0        8. SPOCK MUST DIE, by James BLISH. An original novel, but
            rather similar to the show 'THE ENEMY WITHIN' (BANTAM).
1
0                                                               Page 22
0                       --------- Appendix T ---------
0        Notes for TSO full screen users.
+        ________________________________
0        For TSO 3270 users, KLINGON is a full screen application.
         The major differences are :
0        The SRSCAN, LRSCAN, and STATUS commands cannot be explictly
         entered, since this information is on the screen at all times.
0        The format of the screen is :
0              ...........  ++++++++++   LRSCAN
               ...........  ++++++++++   and
               ... SRS ...  + status +
               ...........  ++ info ++   PLANET
               ...........  ++++++++++   info
0        SRS and STATUS - the format of this information is the same as
         the standard version.
0        The LRSCAN and PLANET information is the same as described in
         the LRSCAN command, however, the information is presented in
         a "compressed" form, to allow for the smaller amount of space
         available on the screen.
0        The full screen mode will work only on 24, 32 and 43 lines
         327X devices.
0        If you wish to experiment with other devices, the GAINIT,
         FSIO1 and FSIO2 assembler routines supplied in source are
         those which must be verified/modified by the user.
./     ADD     NAME=ABANMS
C*********************************************************************
      SUBROUTINE ABANMS
C PURPOSE : PRINT "YOU CAN'T ABANDON" MSG
C*********************************************************************
      CALL DBUGIN ('ABANMS ENTERED',IW(14),0)
      CALL LINEF
      CALL PRMSG ('ABANDON × THAT''S SOMETHING A SOFT SLIMY',IW(39))
      CALL PRMSG ('''EARTHER'' WOULD DO, NOT A KLINGON ×',IW(35))
      CALL DBUGIN ('ABANMS EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=ABSORB
C*********************************************************************
      SUBROUTINE ABSORB (HHIT,SHIPO,SHEO)
C PURPOSE : DETERMINE HOW MUCH HIT IS TO BE ABSORBED BY THE SHIELDS,
C           AND HOW MUCH BY THE SHIP
C*********************************************************************
      COMMON /INFO/ ICOND(2),ENERGY,ISHUPD,ISHENG,IAPDEV,IPOF,IOVER
      CHARACTER *4 CZDAMG , CZDOWN
      EQUIVALENCE (CZDAMG,IZDAMG) , (CZDOWN,IZDOWN)
      DATA CZDAMG /'DAMG'/ , CZDOWN /'DOWN'/
      CALL DBUGIN ('ABSORB ENTERED',IW(14),0)
      CALL DBUGCH ('CURRENT SHIELD STATUS',IW(21),ISHUPD,IW(4))
      CALL DBUGRN ('HIT TO ABSORB ',IW(14),HIT)
      CALL DBUGIN ('SHIELD ENERGY',IW(13),ISHENG)
      HIT = HHIT
      IF (ISHUPD.EQ.IZDAMG.OR.ISHUPD.EQ.IZDOWN.OR.ISHENG.EQ.0) GO TO 10
      IF (ISHENG.GT.2500) GO TO 20
      GO TO 40
10    CALL DBUGIN ('SHIP FULL HIT',IW(13),0)
      SHE = 0.0
      SHIP = HIT
      GO TO 50
20    IF (HIT.GT.ISHENG) GO TO 30
      CALL DBUGIN ('SHLD FULL HIT',IW(13),0)
      SHIP = 0.0
      SHE = HIT
      GO TO 50
30    HIT = HIT-FLOAT(ISHENG)
      SHE = FLOAT(ISHENG)
      SHIP = HIT
      GO TO 50
40    PCT = FLOAT(ISHENG)/25.0
      XPCT = 100.0-PCT
      SHIP = HIT*(XPCT/100.0)
      SHE = HIT*(PCT/100.0)
50    ENERGY = ENERGY-SHIP
      ISHENG = ISHENG-IFIX(SHE+.5)
      IF (ISHENG.LT.0) ISHENG = 0
      SHEO = SHE
      SHIPO = SHIP
      CALL DBUGRN ('SHIP ABSORB   ',IW(14),SHIPO)
      CALL DBUGRN ('SHIELD ABSORB ',IW(14),SHEO)
      CALL DBUGIN ('ABSORB EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=ADDQUE
C*********************************************************************
      SUBROUTINE ADDQUE (ITEM)
C PURPOSE : ADD A VALUE TO THE GRAFICS QUE
C*********************************************************************
      COMMON /WORKQ/ IGCNT, INQUE(10)
      CALL DBUGIN ('ADDQUE ENTERED',IW(14),0)
      CALL DBUGCH ('ADDQUE ITEM',IW(12),ITEM,IW(4))
      IGCNT = IGCNT + 1
      CALL DBUGIN ('IGCNT IS NOW',IW(12),IGCNT)
      INQUE(IGCNT) = ITEM
      CALL DBUGIN ('ADDQUE EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=APDEV
C*********************************************************************
      SUBROUTINE APDEV
C  PURPOSE : ACTIVATE THE ANTI PHOTON DEVICE IS NOT SET, ELSE
C            DISPLAY MSG SAYING "IT'S ON"
C*********************************************************************
      COMMON /INFO/ ICOND(2),ENERGY,ISHUPD,ISHENG,IAPDEV,IPOF,IOVER
      COMMON /DEVICE/ XCDC,XSRDC,XIEDC,XLRDC,XWEDC,XDSDC,XSSDC,XPTDC
      CALL DBUGIN ('APDEV ENTERED',IW(13),0)
      CALL DBUGIN ('AT ENTRY, THE DEVICE FLAG=',IW(26),IAPDEV)
      IF (IAPDEV.EQ.1) GO TO 270
      IF (XDSDC.LE.0.001) GO TO 260
      CALL LINEF
      CALL PRMSG (
     *     'ANTI-PHOTON DEVICE IS POWERED BY THE SHIELDS, AND CANNOT',
     *     IW(56))
      CALL PRMSG (
     *     'BE USED IF THE SHIELDS ARE NOT WORKING, LORD COMMANDER',
     *     IW(54))
      GO TO 150
260   IF (ISHENG.GT.500) GO TO 280
      CALL LINEF
      CALL PRMSG (
     *'INSUFFICENT ENERGY IN SHIELDS TO USE ANTI-PHOTON DEVICE',IW(55))
      GO TO 150
270   CALL LINEF
      CALL PRMSG (
     *'THE ANTI-PHOTON DEVICE IS ALREADY ARMED, LORD COMMANDER',IW(55))
      GO TO 150
280   CALL LINEF
      CALL PRMSG ('ANTI-PHOTON DEVICE ARMED, LORD COMMANDER',IW(40))
      ISHENG = ISHENG-500
      IAPDEV = 1
      CALL DBUGIN ('THE DEVICE FLAG IS NOW=',IW(23),IAPDEV)
150   CALL DBUGIN ('APDEV EXITED',IW(12),0)
      RETURN
      END
./     ADD     NAME=AROUND
C*********************************************************************
      SUBROUTINE AROUND (IIX,IIY)
C PURPOSE : HANDLE THE NOVA OF STARS IN A "RING" AROUND
C           A NOVA STAR
C*********************************************************************
      CALL DBUGIN ('AROUND ENTERED',IW(14),0)
      IX = IIX
      IY = IIY
      CALL PRMSM (
     *  '*** STAR AT SECTOR: ',20,IW(20),IY,IX,'NOVAS',5,IW(5))
      ILOX = IX-ISGN(IX-1)
      IHIX = ISGN(10-IX)+IX
      ILOY = IY-ISGN(IY-1)
      IHIY = ISGN(10-IY)+IY
      DO 20 I = ILOY, IHIY
           DO 10 J = ILOX, IHIX
                CALL NOVKIL (J,I)
10         CONTINUE
20    CONTINUE
      CALL DBUGIN ('AROUND EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=BATTCK
C*********************************************************************
      SUBROUTINE BATTCK
C PURPOSE : CHECK TO SEE IF THE BATTERIES ARE CHARGED,
C           DISPLAY THE STATUS
C*********************************************************************
      COMMON /MISC/ BATTER,ISSAVE,IDUM,WFACT,IDATF,ILEV,CSDATE,TGIVEN
      CALL DBUGIN ('BATTCK ENTERED',IW(14),0)
      CALL LINEF
      IF (BATTER.GT.0.9) GO TO 100
      CALL PRMSG ('RUBIDIUM ENERGY STORAGE CELLS DRAINED',IW(37))
      GO TO 110
100   CALL LINEF
      CALL PRMSG ('RUBIDUM ENERGY STORAGE CELLS COMPLETELY CHARGED',
     *    IW(47))
110   CALL DBUGIN ('BATTCK EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=BATTLE
C*********************************************************************
      SUBROUTINE BATTLE
C PURPOSE : CHECK TO SEE IF WE ARE CURRENTLY IN BATTLE, IF SO,
C           LET THE ENEMY ATTACK, THEN TALLY UP THE RESULTS
C           NEXT, OUR FRIENDS (COMMANDERS) WILL FIRE AT ANYTHING HANDY
C*********************************************************************
      COMMON /MISC/ BATTER,ISSAVE,IDUM,WFACT,IDATF,ILEV,CSDATE,TGIVEN
      COMMON /INFO/ ICOND(2),ENERGY,ISHUPD,ISHENG,IAPDEV,IPOF,IOVER
      COMMON /TRACOM/ TARX,TARY,ISCPX2,ISCPY2,NSECE(10,10),IHIT,ISBC,
     *     IFSC,IKCC,ITORCT,ISB,IFS,IKC,IPR,ISCPX1,ISCPY1,ICHC,IPLC,ISTC
     *     ,ET,ISECT(10,10),TVX,TVY,ICMC
      COMMON /PADDED/ IPAD1(9),ICHART(8,8),IPAD2(9),IPLNET(8,8),
     *     IKY(8,8),INPUT(50),IPAD3
      COMMON /NUMBER/ NSTARS,NPLNTS,NSBASE,NFED,NCOMM,IFX(9),IFY(9),NCX(
     *     9),NCY(9)
      COMMON /SHIPS/ IUSFED(15,13)
      DIMENSION NFX(9),NFY(9),IDMSG(11)
      CHARACTER *4 CZGRE , CZCLER , CZRDOT , CZKZF , CZKZB , CZKZC
      CHARACTER *4 CZMSG(11)
      EQUIVALENCE (CZGRE,IZGRE) , (CZCLER,IZCLER) , (CZRDOT,ICRDOT) ,
     *            (CZKZF,KZF) , (CZKZB,KZB) , (CZKZC,KZC)
      EQUIVALENCE (CZMSG,IDMSG)
      DATA CZGRE /'GREE'/ , CZCLER /'CLEA'/ , CZRDOT /'.'/ ,
     *     CZKZF /'F'/ , CZKZB /'B'/ , CZKZC /'C'/
      DATA CZMSG(1) /'** S'/ , CZMSG(2) /'TARS'/ , CZMSG(3) / 'HIP '/ ,
     *     CZMSG(4) /'U.S.'/ , CZMSG(5) /'S.  '/ ,
     *     CZMSG(9) /'AT S'/ , CZMSG(10) /'ECTO'/ , CZMSG(11) /'R:  '/
      DATA IDMSG(6) /0/ , IDMSG(7) /0/ , IDMSG(8) /0/
      CALL DBUGIN ('BATTLE ENTERED',IW(14),0)
      CALL SHECON
      IF (ICROG(ICHART(ISCPX1,ISCPY1)).EQ.IZGRE) GO TO 250
      NMCALL = 0
10    CALL ITERPT
      IF (NFED.EQ.0) GO TO 80
      CALL LOCATE (KZF,INONE,INONE2)
      CALL RESORT (IFX,IFY,NFX,NFY,NFED)
      DO 70 J = 1, NFED
           MFX = NFX(J)
           MFY = NFY(J)
           CALL INTERC (MFX,MFY,IRTN)
           IF (IRTN.EQ.IZCLER) GO TO 30
20         IAFIRE = NSECE(MFX,MFY)/2
           IF (IPOF.EQ.1) IAFIRE = IAFIRE*1.2
           FIRE = IAFIRE*PERHIT(ISCPX2,ISCPY2,MFX,MFY)
           CALL ABSORB (FIRE,SHIP,SHE)
           JS = IFIX(SHIP+.5)
           JE = IFIX(SHE+.5)
           CALL LINEF
           CALL PRHIT (
     *     JS,JE,'UNIT HIT FROM FEDERATION STARSHIP AT: ',
     *          38,IW(38),MFY,MFX)
           CALL DAMAGE (SHIP)
           NSECE(MFX,MFY) = NSECE(MFX,MFY)-IAFIRE/3
           GO TO 60
30         IF (RAND(100.0).LT.20.0.OR.IPOF.EQ.1) GO TO 20
           IF (PERHIT(ISCPX2,ISCPY2,MFX,MFY).LT..6) GO TO 20
           CALL LINEF
           CALL PRMSM ('=== INCOMING PHOTON TORPEDOS FROM: ',
     *          35,IW(35),MFY,MFX,' ',0,1)
           DO 50 N = 1, 3
                CALL LINEF
                CALL PRMSG ('### TRACKING INCOMING PHOTON TORPEDO',
     *                       IW(36))
                IF (IAPDEV.EQ.1) GO TO 40
                CALL ABSORB (RAND(50.0)+650.0,SHIP,SHE)
                JS = IFIX(SHIP+.5)
                JE = IFIX(SHE+.5)
                CALL LINEF
                CALL PRHIT (JS,JE,'UNIT HIT, PHOTON TORPEDO FROM ',
     *               30,IW(30),MFY,MFX)
                CALL DAMAGE (SHIP)
                GO TO 50
40              CALL PRMSG (
     *            '*** ANTI-PHOTON DEVICE ABSORBS PHOTON TORPEDO',
     *            IW(45))
50         CONTINUE
60         IAPDEV = 0
70    CONTINUE
80    IF (NSBASE.EQ.0) GO TO 100
      CALL LOCATE (KZB,IIXB,IIYB)
      FIRE = (RAND(50.0)+750.0)*PERHIT(ISCPX2,ISCPY2,IIXB,IIYB)
      CALL ABSORB (FIRE,SHIP,SHE)
      JS = IFIX(SHIP+.5)
      JE = IFIX(SHE+.5)
      CALL LINEF
      CALL PRHIT (
     *     JS,JE,'UNIT HIT FROM STARBASE AT: ',27,IW(27),IIYB,IIXB)
      CALL DAMAGE (SHIP)
100   IF (NCOMM.EQ.0) GO TO 150
      CALL LOCATE (KZC,NONE,NONE2)
      DO 140 M = 1, NCOMM
           IIXC = NCX(M)
           IIYC = NCY(M)
           IFA = -NSECE(IIXC,IIYC)/2
           IF (NFED.EQ.0) GO TO 120
           IFA = IFA/NFED
           DO 110 NF = 1, NFED
                JFX = NFX(NF)
                JFY = NFY(NF)
                FIRE = IFA*PERHIT(IIXC,IIYC,JFX,JFY)
                IP1 = IFIX(FIRE)/3
                IP2D = IP1*2
                CALL LINEF
                CALL PRHIT (
     *               IP2D,IP1,'HIT ON FEDERATION STARSHIP AT: ',
     *               31,IW(31),JFY,JFX)
                CALL PRMSM (
     *              'FROM COMMANDER AT: ',19,IW(19),
     *              IIYC,IIXC,' ',0,1)
                NSECE(JFX,JFY) = NSECE(JFX,JFY)-IFIX(FIRE)
                IF (NSECE(JFX,JFY).GT.0) GO TO 110
                ET = ET+.3
                IFS = IFS-1
                IFSC = IFSC+1
                ICHART(ISCPX1,ISCPY1) = ICHART(ISCPX1,ISCPY1)-100
                NSECE(JFX,JFY) = 0
                ISECT(JFX,JFY) = ICRDOT
                CALL SSDEST (IUSFED,ISCPX1,ISCPY1,JFX,JFY,IDMSG(6))
                CALL PRMSM (
     *          IDMSG,44,IW(44),JFY,JFX,'DESTROYED',9,IW(9))
                CALL ITERPT
                GO TO 140
110        CONTINUE
           GO TO 140
120        IF (NSBASE.EQ.0) GO TO 140
           CALL LOCATE (KZB,IIXB,IIYB)
           FIRE = IFA*PERHIT(IIXC,IIYC,IIXB,IIYB)
           IP1 = IFIX(FIRE)/3
           IP2D = IP1*2
           CALL LINEF
           CALL PRHIT (
     *         IP2D,IP1,'HIT ON STARBASE AT: ',20,IW(20),IIYB,IIXB)
           CALL PRMSM (
     *         'FROM COMMANDER AT: ',19,IW(19),IIYC,IIXC,' ',0,1)
           NSECE(IIXB,IIYB) = NSECE(IIXB,IIYB)-IFIX(FIRE)
           IF (NSECE(IIXB,IIYB).GT.0) GO TO 130
           CALL PRMSM ('*** STARBASE AT: ',17,IW(17),IIYB,IIXB,
     *          'DESTROYED',9,IW(9))
           NSECE(IIXB,IIYB) = 0
           ISECT(IIXB,IIYB) = ICRDOT
           ET = ET+.5
           ISB = ISB-1
           ISBC = ISBC+1
           ICHART(ISCPX1,ISCPY1) = ICHART(ISCPX1,ISCPY1)-10
           CALL ITERPT
           GO TO 140
130        IF (NMCALL.EQ.1) GO TO 140
           IF (ILEV.NE.3) GO TO 140
           CALL DRAGCC
           NMCALL = 1
           CALL ITERPT
           IF (NFED.GT.0) GO TO 10
140   CONTINUE
150   CALL ITERPT
      CALL LOCATE (KZF,IDUM,IDUM2)
      CALL LOCATE (KZC,IDUM,IDUM2)
      IF (NFED.EQ.0.AND.NSBASE.EQ.0) GO TO 250
      IF (IPOF.NE.1) GO TO 240
160   IF (NCOMM.EQ.0.OR.NFED.EQ.0) GO TO 230
      MC = MIN0(NFED,NCOMM)
      DO 220 N = 1, MC
           IF (NSECE(IFX(N),IFY(N))+NSECE(NCX(N),NCY(N))) 200 , 210 ,
     *           210
200        ICHART(ISCPX1,ISCPY1) = ICHART(ISCPX1,ISCPY1)-100
           NSECE(IFX(N),IFY(N)) = 0
           ISECT(IFX(N),IFY(N)) = ICRDOT
           ET = ET+.3
           IFS = IFS-1
           IFSC = IFSC+1
           CALL SSDEST (IUSFED,ISCPX1,ISCPY1,IFX(N),IFY(N),IDMSG(6))
           CALL PRMSM (
     *        IDMSG,44,IW(44),IFY(N),IFX(N),'DESTROYED IN BATTLE',
     *        19,IW(19))
           GO TO 220
210        CALL PRMSM ('*** COMMANDER AT ',17,IW(17),NCY(N),NCX(N),
     *          'DESTROYED IN BATTLE',19,IW(19))
           ICHART(ISCPX1,ISCPY1) = ICHART(ISCPX1,ISCPY1)-1000
           NSECE(NCX(N),NCY(N)) = 0
           ISECT(NCX(N),NCY(N)) = ICRDOT
           IKC = IKC-1
220   CONTINUE
      CALL ITERPT
      CALL LOCATE (KZC,IDUM,IDUM2)
      CALL LOCATE (KZF,IDUM,IDUM2)
      GO TO 160
230   CALL ITERPT
      IF (NSBASE.EQ.0.OR.NCOMM.EQ.0) GO TO 240
      CALL LOCATE (KZB,IIXB,IIYB)
      CALL PRMSM ('*** STARBASE AT ',16,IW(16),IIYB,IIXB,
     *     'DESTROYED BY COMMANDER',22,IW(22))
      ISB = ISB-1
      ISBC = ISBC+1
      ET = ET+.5
      ICHART(ISCPX1,ISCPY1) = ICHART(ISCPX1,ISCPY1)-10
      ISECT(IIXB,IIYB) = ICRDOT
      NSECE(IIXB,IIYB) = 0
240   IPCT = IFIX((FLOAT(ISHENG)/25.0)+.5)
      CALL BSTAT (ENERGY,ISHUPD,IPCT)
      IF (ENERGY.LE.-500.0) IPAD1(1) = -1000000
250   CALL DBUGIN ('BATTLE EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=BEEP
C*********************************************************************
      SUBROUTINE BEEP
C PURPOSE : THIS ROUTINE IS CALLED WHEN SOMETHING URGENT HAPPENS,
C           AT THE PRESENT TIME, NOT USED
C*********************************************************************
      CALL LINEF
      CALL DBUGIN ('BEEP CALLED (NOT USED)',IW(22),0)
      RETURN
      END
./     ADD     NAME=BEEP2
C*********************************************************************
      SUBROUTINE BEEP2
C PURPOSE : THIS ROUTINE IS CALLED WHEN SOMETHING VERY URGENT HAPPENS,
C           AT THE PRESENT TIME, NOT USED
C*********************************************************************
      CALL LINEF
      CALL DBUGIN ('BEEP2 CALLED (NOT USED)',IW(23),0)
      RETURN
      END
./     ADD     NAME=BLOCKD
C*********************************************************************
      BLOCK DATA
C*********************************************************************
      COMMON /CHARS/ KZA,KZB,KZC,KZD,KZE,KZF,KZG,
     +KZH,KZI,KZJ,KZK,KZL,KZM,KZN,
     +KZO,KZP,KZQ,KZR,KZS,KZT,KZU,
     +KZV,KZW,KZX,KZY,KZZ,
     +ICRDOT,ICRPLS,ICRCRH,ICRSTR,ICRMIN,ICRZER,KZ1,
     +KZ2,KZ3,KZ4,KZ5,KZ6,KZ7,
     +KZ8,KZ9,ICRBLK
      CHARACTER *4 CZKZA,CZKZB,CZKZC,CZKZD,CZKZE,CZKZF,CZKZG,
     +CZKZH,CZKZI,CZKZJ,CZKZK,CZKZL,CZKZM,CZKZN,
     +CZKZO,CZKZP,CZKZQ,CZKZR,CZKZS,CZKZT,CZKZU,
     +CZKZV,CZKZW,CZKZX,CZKZY,CZKZZ,
     +CZRDOT,CZRPLS,CZRCRH,CZRSTR,CZRMIN,CZRZER,CZKZ1,
     +CZKZ2,CZKZ3,CZKZ4,CZKZ5,CZKZ6,CZKZ7,
     +CZKZ8,CZKZ9,CZRBLK
      EQUIVALENCE (CZKZA,KZA),(CZKZB,KZB),(CZKZC,KZC),(CZKZD,KZD),
     +(CZKZE,KZE),(CZKZF,KZF),(CZKZG,KZG),(CZKZH,KZH),(CZKZI,KZI),
     +(CZKZJ,KZJ),(CZKZK,KZK),(CZKZL,KZL),(CZKZM,KZM),(CZKZN,KZN),
     +(CZKZO,KZO),(CZKZP,KZP),(CZKZQ,KZQ),(CZKZR,KZR),(CZKZS,KZS),
     +(CZKZT,KZT),(CZKZU,KZU),(CZKZV,KZV),(CZKZW,KZW),(CZKZX,KZX),
     +(CZKZY,KZY),(CZKZZ,KZZ),(CZRDOT,ICRDOT),(CZRPLS,ICRPLS),
     +(CZRCRH,ICRCRH),(CZRSTR,ICRSTR),(CZRMIN,ICRMIN),
     +(CZRZER,ICRZER),(CZKZ1,KZ1),(CZKZ2,KZ2),(CZKZ3,KZ3),(CZKZ4,KZ4),
     +(CZKZ5,KZ5),(CZKZ6,KZ6),(CZKZ7,KZ7),(CZKZ8,KZ8),(CZKZ9,KZ9),
     +(CZRBLK,ICRBLK)
      COMMON /PADDED/ IPAD1(9),ICHART(8,8),IPAD2(9),IPLNET(8,8),
     +IKY(8,8),INPUT(50),IPAD3
      CHARACTER *4 CZPAD3
      EQUIVALENCE (CZPAD3,IPAD3)
      DATA CZKZA/'A'/,CZKZB/'B'/,CZKZC/'C'/,
     +CZKZD/'D'/,CZKZE/'E'/,CZKZF/'F'/,CZKZG/'G'/,CZKZH/'H'/,
     +CZKZI/'I'/,CZKZJ/'J'/,CZKZK/'K'/,CZKZL/'L'/,CZKZM/'M'/,
     +CZKZN/'N'/,CZKZO/'O'/,CZKZP/'P'/,CZKZQ/'Q'/,CZKZR/'R'/,
     +CZKZS/'S'/,CZKZT/'T'/,CZKZU/'U'/,CZKZV/'V'/,CZKZW/'W'/,
     +CZKZX/'X'/,CZKZY/'Y'/,CZKZZ/'Z'/,CZRDOT/'.'/,CZRPLS/'+'/,
     +CZRCRH/'#'/,CZRSTR/'*'/,CZRMIN/'-'/ ,CZRZER/'0'/,CZKZ1/'1'/,
     +CZKZ2/'2'/,CZKZ3/'3'/,CZKZ4/'4'/,CZKZ5/'5'/,CZKZ6/'6'/,
     +CZKZ7/'7'/,CZKZ8/'8'/,CZKZ9/'9'/,CZRBLK/' '/
      COMMON /STRING/ IZSUPN, IZBLKH, IZMISS, IZNOVA, IZCDAM, IZCDES,
     * IZFDAM, IZFDES, IZBDAM, IZBDES, IZPDES,
     * IZP100, IZP200, IZP300, IZP400, IZERR
      CHARACTER *4 CZSUPN, CZBLKH, CZMISS, CZNOVA, CZCDAM, CZCDES,
     * CZFDAM, CZFDES, CZBDAM, CZBDES, CZPDES,
     * CZP100, CZP200, CZP300, CZP400, CZERR
      EQUIVALENCE (CZSUPN,IZSUPN),(CZBLKH,IZBLKH),(CZMISS,IZMISS),
     *(CZNOVA,IZNOVA),(CZCDAM,IZCDAM),(CZCDES,IZCDES),(CZFDAM,IZFDAM),
     *(CZFDES,IZFDES),(CZBDAM,IZBDAM),(CZBDES,IZBDES),(CZPDES,IZPDES),
     *(CZP100,IZP100),(CZP200,IZP200),(CZP300,IZP300),(CZP400,IZP400),
     *(CZERR,IZERR)
      DATA IPAD1 /9* 999999/, IPAD2 /9* 999999/
      DATA CZPAD3 /')'/
      DATA CZSUPN / 'SNOV'/
      DATA CZBLKH / 'BHOL'/
      DATA CZMISS / 'MISS'/
      DATA CZNOVA / '*NOV'/
      DATA CZCDAM / 'CDAM'/
      DATA CZCDES / 'CDES'/
      DATA CZFDAM / 'FDAM'/
      DATA CZFDES / 'FDES'/
      DATA CZBDAM / 'BDAM'/
      DATA CZBDES / 'BDES'/
      DATA CZPDES / 'PDES'/
      DATA CZP100 / 'P100'/
      DATA CZP200 / 'P200'/
      DATA CZP300 / 'P300'/
      DATA CZP400 / 'P400'/
      DATA CZERR  / 'ERRO'/
      END
./     ADD     NAME=BRIDGE
C*********************************************************************
      SUBROUTINE BRIDGE (IIPNTR)
C PURPOSE : POINT POINTER AT NEXT NON-BLANK CHARACTER AFTER A
C           BLANK IN THE COMMAND LINE
C*********************************************************************
      COMMON /PADDED/ IPAD1(9),ICHART(8,8),IPAD2(9),IPLNET(8,8),
     *     IKY(8,8),INPUT(51)
      CHARACTER *4 CZRBLK
      EQUIVALENCE (CZRBLK,ICRBLK)
      DATA CZRBLK /' '/
      CALL DBUGIN ('BRIDGE ENTERED',IW(14),0)
      IPNTR = IIPNTR
      DO 10 N = IPNTR, 51
           IF (INPUT(N).EQ.ICRBLK) GO TO 20
10    CONTINUE
20    IPNTR = N
      CALL DBUGIN ('(BRIDGE), BLANK FOUND AT ',IW(25),N)
      GO TO 30
C*********************************************************************
      ENTRY GAP (IIPNTR)
C PURPOSE : POINT POINTER AT FIRST NON-BLANK IN COMMAND LINE
C*********************************************************************
      IPNTR = 1
30    CALL DBUGIN ('GAP ENTERED',IW(11),0)
      DO 40 N = IPNTR, 51
           IF (INPUT(N).NE.ICRBLK) GO TO 50
40    CONTINUE
50    IIPNTR = N
      CALL DBUGIN ('(GAP), NON-BLANK FOUND AT',IW(25),N)
      CALL DBUGIN ('BRIDGE/GAP EXITED',IW(17),0)
      RETURN
      END
./     ADD     NAME=BSTAT
C*********************************************************************
      SUBROUTINE BSTAT (ENERGY,ISHUPD,IPCT)
C PURPOSE : DISPLAY INFORMATION ON ENERGY AND SHIELDS
C*********************************************************************
      COMMON /OUTUNT/ IOUTT
      CALL DBUGIN ('BSTAT ENTERED',IW(13),0)
      CALL LINEF
      WRITE (IOUTT,50000) ENERGY,ISHUPD,IPCT
      CALL LINEF
      CALL DBUGIN ('BSTAT EXITED',IW(12),0)
      RETURN
50000 FORMAT (' ENERGY: ',F9.2,' SHIELDS  ',A4,2X,I3,' PCT')
      END
./     ADD     NAME=CERT
C*********************************************************************
      SUBROUTINE CERT (NAME,INDIM,IRNK,IRDIM)
C PURPOSE : PRINT A "YOU WIN" CERTIFICATE IF EXPERT OR EMERITUS
C*********************************************************************
      COMMON /CPU/ IBMT
      DIMENSION IRNK(IRDIM),MSG1(7),MSG2(4),MSG3(3),IPL(20)
      DIMENSION NAME(INDIM)
      CHARACTER *4 CZMSG1(7),CZMSG2(4),CZMSG3(3),CZIPL(20)
      EQUIVALENCE (CZMSG1,MSG1),(CZMSG2,MSG2),(CZMSG3,MSG3)
      EQUIVALENCE (CZIPL,IPL)
      DATA CZIPL / 20*' '/
      DATA CZMSG1 / '  TH','E KL','INGO','N HI','GH C','OMMA','ND'/
      DATA CZMSG2 /        'AWAR','DS T','O YO','U   '/
      DATA CZMSG3 /        ' THE',' RAN','K OF'/
      CALL DBUGIN ('CERT ENTERED',IW(12),0)
      IF (IBMT.EQ.1) GO TO 10
      CALL PRMSG ('SET PRINTER TO TOP OF PAGE',IW(26))
      CALL READIN ('THEN HIT RETURN',IW(15),15,1,EOFF)
      GO TO 12
10    CALL PRMSG ('YOUR AWARD IS NOW BEING WRITTEN TO FT08F001  ',
     *                 IW(43))
      CALL PRMSGC(' ',IW(1))
      CALL PRMSGC(' ',IW(1))
      CALL PRMSGC(' ',IW(1))
      CALL PRMSGC(' ',IW(1))
      CALL SHIP
      CALL PRMSGC(' ',IW(1))
      CALL PRMSGC(' ',IW(1))
      CALL PRMSGC(' ',IW(1))
      CALL PRMSGC(' ',IW(1))
      DO 11 N=1,7
           IPL(N+7) = MSG1(N)
11    CONTINUE
12    CALL PRMSGC(IPL,IW(80))
      CALL PRMSGC(' ',IW(1))
      DO 13 N=8,14
           IPL(N) = IPL(1)
13    CONTINUE
      IPL(10)= MSG2(1)
      IPL(11)= MSG2(2)
      IPL(12)= MSG2(3)
      IPL(13)= MSG2(4)
      CALL PRMSGC(IPL,IW(80))
      CALL PRMSGC(' ',IW(1))
      DO 14 N=2,20
           IPL(N) = IPL(1)
14    CONTINUE
      DO 15 N=1,INDIM
           IPL(N+9) = NAME(N)
15    CONTINUE
      CALL PRMSGC(IPL,IW(80))
      CALL PRMSGC(' ',IW(1))
      DO 16 N=2,20
           IPL(N) = IPL(1)
16    CONTINUE
      IPL(10)= MSG3(1)
      IPL(11)= MSG3(2)
      IPL(12)= MSG3(3)
      CALL PRMSGC(IPL,IW(80))
      CALL PRMSGC(' ',IW(1))
      DO 17 N=2,20
           IPL(N) = IPL(1)
17    CONTINUE
      DO 18 N=1,IRDIM
           IPL(N+6) = IRNK(N)
18    CONTINUE
      CALL PRMSGC(IPL,IW(80))
      DO 19 N=1,45
           CALL PRMSGC(' ',IW(1))
19    CONTINUE
      CALL DBUGIN ('CERT EXITED',IW(11),0)
      RETURN
      END
./     ADD     NAME=COMOVE
C*********************************************************************
      SUBROUTINE COMOVE
C PURPOSE : CHECK TO SEE IF A COMMANDER NEEDS TO MOVE AROUND
C*********************************************************************
      COMMON /TRACOM/ TARX,TARY,ISCPX2,ISCPY2,NSECE(10,10),IHIT,ISBC,
     *     IFSC,IKCC,ITORCT,ISB,IFS,IKC,IPR,ISCPX1,ISCPY1,ICHC,IPLC,ISTC
     *     ,ET,ISECT(10,10),TVX,TVY,ICMC
      COMMON /PADDED/ IPAD1(9),ICHART(8,8),IPAD2(9),IPLNET(8,8),
     *     IKY(8,8),INPUT(50),IPAD3
      COMMON /DEVICE/ XCDC,XSRDC,XIEDC,XLRDC,XWEDC,XDSDC,XSSDC,XPTDC
      CHARACTER *4 CZRDOT , CZKZC , CZRED
      EQUIVALENCE (CZRDOT,ICRDOT) , (CZKZC,KZC) , (CZRED,IZRED)
      DATA CZRDOT /'.'/ , CZKZC /'C'/ , CZRED /'RED'/
      CALL DBUGIN ('COMOVE ENTERED',IW(14),0)
      DO 40 IY = 1, 8
           DO 30 IX = 1, 8
                J = ICHART(IX,IY)
                IF (J.EQ.9999.OR.J.LT.1000.OR.(IX.EQ.ISCPX1.AND.IY.EQ.
     *               ISCPY1)) GO TO 30
                IXM = 1
                IYM = 1
                IF (RAND(2.0).GT.1.0) IXM = -IXM
                IF (RAND(2.0).GT.1.0) IYM = -IYM
                IXM = IXM+IX
                IYM = IYM+IY
                IF (IXM.NE.ISCPX1.OR.IYM.NE.ISCPY1) GO TO 20
                IF (XLRDC.GT.0.001.AND.XSRDC.GT.001) GO TO 10
                CALL LINEF
      CALL PRMSG (
     *  'LORD COMMANDER, SENSORS INDICATE ONE OF OUR COMMANDERS IS',
     *  IW(57))
                CALL PRMSG ('ENTERING THE QUADRANT',IW(21))
10              M1 = RAND(10.0)+1.0
                M2 = RAND(10.0)+1.0
                IF (ISECT(M1,M2).NE.ICRDOT) GO TO 10
                ISECT(M1,M2) = KZC
                NSECE(M1,M2) = -4500
                ICHART(IX,IY) = ICHART(IX,IY)-1000
                ICHART(IXM,IYM) = ICHART(IXM,IYM)+1000
                GO TO 30
20              IF (IXM.LT.1.OR.IXM.GT.8.OR.IYM.LT.1.OR.IYM.GT.8.OR.
     *               ICROG(ICHART(IXM,IYM)).EQ.IZRED.OR.ICHART(IXM,IYM)
     *               .GT.1000) GO TO 30
                ICHART(IX,IY) = ICHART(IX,IY)-1000
                ICHART(IXM,IYM) = ICHART(IXM,IYM)+1000
30         CONTINUE
40    CONTINUE
      CALL DBUGIN ('COMOVE EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=COPVEC
C*********************************************************************
      SUBROUTINE COPVEC (VEC2,VEC1,IXL,IXH,IYL,IYH)
C PURPOSE : SELECTIVELY COPY PARTS OF AN ARRAY TO ANOTHER ARRAY
C*********************************************************************
      DIMENSION VEC1(8,8),VEC2(8,8)
      CALL DBUGIN ('COPVEC ENTERED',IW(14),0)
      DO 20 N = IYL, IYH
           DO 10 M = IXL, IXH
                VEC2(M,N) = VEC1(M,N)
10         CONTINUE
20    CONTINUE
      CALL DBUGIN ('COPVEC EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=CORAND
C*********************************************************************
      SUBROUTINE CORAND (TME)
C PURPOSE : GENERATE A RANDOM PLACE FOR A COMMANDER TO MOVE TO
C*********************************************************************
      DATA ACCUM / 0.0 / ,TMIX / 0.0 /
      CALL DBUGIN ('CORAND ENTERED',IW(14),0)
      ACCUM = ACCUM+TME
      IF (ABS(TMIX).GT.0.0001) GO TO 10
      X = RAND(0.5)-.25
      TMIX = X+.50
10    IF (ACCUM.LT.TMIX) GO TO 20
      ACCUM = ACCUM-TMIX
      TMIX = 0.0
      CALL COMOVE
20    CALL DBUGIN ('CORAND EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=DAMAGE
C*********************************************************************
      SUBROUTINE DAMAGE (UHIT)
C PURPOSE : DAMAGE A PART OF THE SHIP IF GREATER THAN 400 UNIT
C           HIT ABSORBED PAST SHIELDS
C*********************************************************************
      COMMON /DEVICE/ XCDC,XSRDC,XIEDC,XLRDC,XWEDC,XDSDC,XSSDC,XPTDC
      COMMON /INFO/ ICOND(2),ENERGY,ISHUPD,ISHENG,IAPDEV,IPOF,IOVER
      CHARACTER *4 CZDAMG , CZUP
      EQUIVALENCE (CZDAMG,IZDAMG) , (CZUP,IZUP)
      DATA CZDAMG / 'DAMG'/ ,CZUP / 'UP'/
      CALL DBUGIN ('DAMAGE ENTERED',IW(14),0)
      UNHIT = UHIT
      IBY = 0
10    UNIHIT = UNHIT-(RAND(30.0)+170.0)
      IF (UNIHIT.LE.0.0) GO TO 200
      IF (UNIHIT.GT.400.0) UNIHIT = 400.0
      IF (IBY.EQ.1) GO TO 20
      CALL LINEF
      CALL PRMSG ('*** DAMAGE CONTROL REPORTS',IW(26))
20    HIT = RAND(0.25)+(UNIHIT*.005)
      IIX = (IFIX(UNIHIT*RAND(3.5))/100)
      IIX = IIX+1
      IF (IIX.LT.4.OR.IIX.GT.14) GO TO 120
      IF (IIX.LT.5) GO TO 30
      IF (IIX.LT.7) GO TO 40
      IF (IIX.LT.9) GO TO 50
      IF (IIX.LT.11) GO TO 60
      IF (IIX.LT.12) GO TO 70
      IF (IIX.LT.13) GO TO 80
      IF (IIX.LT.14) GO TO 90
      IF (IIX.LT.15) GO TO 100
30    CALL PRMSG ('*** IMPULSE ENGINES DAMAGED, LORD COMMANDER.',
     *    IW(44))
      XIEDC = XIEDC+HIT
      GO TO 190
40    CALL PRMSG ('*** SUBSPACE RADIO DAMAGED, LORD COMMANDER.',
     *    IW(43))
      XSRDC = XSRDC+HIT
      GO TO 190
50    CALL PRMSG ('*** LONG RANGE SCANNERS DAMAGED, LORD COMMANDER.',
     *    IW(48))
      XLRDC = XLRDC+HIT
      GO TO 190
60    CALL PRMSG ('*** BATTLE COMPUTER DAMAGED, LORD COMMANDER.',
     *    IW(44))
      XCDC = XCDC+HIT
      GO TO 190
70    CALL PRMSG ('*** WARP ENGINES DAMAGED, LORD COMMANDER.',IW(41))
      XWEDC = XWEDC+HIT
      GO TO 190
80    CALL PRMSG ('*** SHORT RANGE SCANNERS DAMAGED, LORD COMMANDER.',
     *   IW(49))
      XSSDC = XSSDC+HIT
      GO TO 190
90    CALL PRMSG (
     *  '*** DISRUPTOR TORPEDO TUBES DAMAGED, LORD COMMANDER.',
     *   IW(52))
      XPTDC = XPTDC+HIT
      GO TO 190
100   CALL PRMSG ('*** DEFLECTOR SHIELDS DAMAGED',IW(29))
      IF (ISHUPD.NE.IZUP) GO TO 110
      CALL PRMSG (
     *  '*** DEFLECTOR SHIELDS ARE NOW DOWN, LORD COMMANDER.',
     *     IW(51))
110   XDSDC = XDSDC+HIT
      ISHUPD = IZDAMG
      GO TO 190
120   ID20 = IFIX(RAND(19.0)+2.0)
      ID15 = IFIX(RAND(6.0)+15.0)
      J = RAND(6.0)+1.0
      IF (J.EQ.1) GO TO 130
      IF (J.EQ.2) GO TO 140
      IF (J.EQ.3) GO TO 150
      IF (J.EQ.4) GO TO 160
      IF (J.EQ.5) GO TO 170
      IF (J.EQ.6) GO TO 180
130   CALL PRMIM ('--- MINOR DAMAGE TO BULKHEADS ON DECK ',
     *      38,IW(38),ID20,' ',0,1)
      GO TO 190
140   CALL PRMIM ('--- MINOR DAMAGE TO FOOD INTEGRATERS ON DECK ',
     *     45,IW(45),ID20,' ',0,1)
      GO TO 190
150   CALL PRMIM ('--- MINOR DAMAGE TO RE-PROCESSING CENTER ON DECK ',
     *     49,IW(49),ID15,' ',0,1)
      GO TO 190
160   CALL PRMIM ('--- MINOR DAMAGE TO STORAGE HOLDS ON DECK ',
     *     42,IW(42),ID15,' ',0,1)
      GO TO 190
170   CALL PRMIM (
     * '--- ENGINEERING REPORTS NON-CRITICAL POWER LOSS ON DECK ',
     * 56,IW(56),ID20,' ',0,1)
      GO TO 190
180   ID = RAND(10.0)+1.0
      CALL PRMIM ('--- ',4,IW(4),ID,
     *            'CASUALTIES FROM THIS HIT',24,IW(24))
      CALL PRMIM ('     ON DECK ',13,IW(13),ID20,' ',0,1)
190   IF (UNHIT.LT.600.0) GO TO 200
      UNHIT = UNHIT-400.0
      CALL PRMSG ('AND',IW(3))
      IBY = 1
      GO TO 10
200   CALL DBUGIN ('DAMAGE EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=DAMAGR
C*********************************************************************
      SUBROUTINE DAMAGR
C PURPOSE : DISPLAY STATUS OF DEVICES ON THE SHIP
C*********************************************************************
      COMMON /DEVICE/ XCDC,XSRDC,XIEDC,XLRDC,XWEDC,XDSDC,XSSDC,XPTDC
      CALL DBUGIN ('DAMAGR ENTERED',IW(14),0)
      CALL LINEF
      CALL PRMSG ('    DAMAGE REPORT FOLLOWS:',IW(26))
      CALL LINEF
      IF (XCDC.GT.0.001.OR. XSRDC.GT.0.001.OR.XIEDC.GT.0.001.OR.
     *    XLRDC.GT.0.001.OR.XWEDC.GT.0.001.OR.XDSDC.GT.0.001.OR.
     *    XSSDC.GT.0.001.OR.XPTDC.GT.0.001) GO TO 100
      GO TO 110
100   IF (XCDC.GT.0.001)  CALL PRMRM ('COMPUTER           ',19,IW(19),
     *     XCDC,' ',0,1)
      IF (XSRDC.GT.0.001) CALL PRMRM ('SUBSPACE RADIO     ',19,IW(19),
     *     XSRDC,' ',0,1)
      IF (XIEDC.GT.0.001) CALL PRMRM ('IMPULSE ENGINES    ',19,IW(19),
     *     XIEDC,' ',0,1)
      IF (XLRDC.GT.0.001) CALL PRMRM ('LONG RANGE SENSORS ',19,IW(19),
     *     XLRDC,' ',0,1)
      IF (XWEDC.GT.0.001) CALL PRMRM ('WARP ENGINES       ',19,IW(19),
     *     XWEDC,' ',0,1)
      IF (XDSDC.GT.0.001) CALL PRMRM ('DEFLECTOR SCREENS  ',19,IW(19),
     *     XDSDC,' ',0,1)
      IF (XSSDC.GT.0.001) CALL PRMRM ('SHORT RANGE SENSORS',19,IW(19),
     *     XSSDC,' ',0,1)
      IF (XPTDC.GT.0.001) CALL PRMRM ('DISRUPTOR TORPEDOES',19,IW(19),
     *     XPTDC,' ',0,1)
      GO TO 120
110   CALL LINEF
      CALL PRMSG ('SHIP FULLY OPERATIONAL, LORD COMMANDER',IW(38))
120   CALL DBUGIN ('DAMAGR EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=DBUGCH
C*********************************************************************
      SUBROUTINE DBUGCH(MSG,MSGDIM,ICHAR,IDIM)
C PURPOSE : IF TRACE IS ACTIVE, DISPLAY DEBUGGING INFORMATION
C*********************************************************************
      COMMON /DEBUG/ IDEBUG
      COMMON /DBUGUN/ IUDBUG
      DIMENSION MSG(MSGDIM), ICHAR(IDIM)
      IF (IDEBUG.NE.1) GO TO 100
          J = MSGDIM
          IF (J.GT.10) J = 10
          WRITE (IUDBUG,10000) (MSG(N),N=1,J)
          WRITE (IUDBUG,10001)
          WRITE (IUDBUG,10002) ICHAR
          WRITE (IUDBUG,10003) (MSG(N),N=1,J)
100   RETURN
10000 FORMAT (' *DEBUG* BEGIN',1X,10A4)
10001 FORMAT ('         ----+----1----+----2----+----3',
     *                 '----+----4----+----5 ')
10002 FORMAT ('         ',5A10)
10003 FORMAT (' *DEBUG* END  ',1X,10A4)
      END
./     ADD     NAME=DBUGIA
C*********************************************************************
      SUBROUTINE DBUGIA(MSG,MSGDIM,INTEG,IDIM)
C PURPOSE : IF TRACE IS ACTIVE, DISPLAY DEBUGGING INFORMATION
C*********************************************************************
      COMMON /DEBUG/ IDEBUG
      COMMON /DBUGUN/ IUDBUG
      DIMENSION MSG(MSGDIM), INTEG(IDIM)
      IF (IDEBUG.NE.1) GO TO 100
          J = MSGDIM
          IF (J.GT.10) J = 10
          WRITE (IUDBUG,10000) (MSG(N),N=1,J)
          WRITE (IUDBUG,10001) INTEG
          WRITE (IUDBUG,10002) (MSG(N),N=1,J)
100   RETURN
10000 FORMAT (' *DEBUG* BEGIN',1X,10A4)
10001 FORMAT (' ',I12,1X,I12,1X,I12,1X,I12)
10002 FORMAT (' *DEBUG* END  ',1X,10A4)
      END
./     ADD     NAME=DBUGIN
C*********************************************************************
      SUBROUTINE DBUGIN(MSG,MSGDIM,INTEG)
C PURPOSE : IF TRACE IS ACTIVE, DISPLAY DEBUGGING INFORMATION
C*********************************************************************
      COMMON /DEBUG/ IDEBUG
      COMMON /DBUGUN/ IUDBUG
      DIMENSION MSG(MSGDIM)
      DIMENSION IDFORM (8)
      CHARACTER *4 CZDFORM(8)
      EQUIVALENCE (CZDFORM,IDFORM)
      DATA CZDFORM(1) /'('' *'/ , CZDFORM(2) /'DEBU'/ ,
     *     CZDFORM(3) /'G*'','/ , CZDFORM(4) /'I20,'/ ,
     *     CZDFORM(5) /'1X,'/ , CZDFORM(8) /')'/
      DATA IDFORM(6) /-1/ , IDFORM(7) /-1/
      IF (IDEBUG.NE.1) GO TO 100
          I = IWI(IDUMMY)
          CALL SETFOR (I,IDFORM(6),IDFORM(7),IMX)
          IF (IMX.EQ.0) WRITE (IUDBUG,IDFORM) INTEG
          IF (IMX.NE.0) WRITE (IUDBUG,IDFORM) INTEG, (MSG(N),N=1,IMX)
100   RETURN
      END
./     ADD     NAME=DBUGRA
C*********************************************************************
      SUBROUTINE DBUGRA(MSG,MSGDIM,REALN,IDIM)
C PURPOSE : IF TRACE IS ACTIVE, DISPLAY DEBUGGING INFORMATION
C*********************************************************************
      COMMON /DEBUG/ IDEBUG
      COMMON /DBUGUN/ IUDBUG
      DIMENSION MSG(MSGDIM), REALN(IDIM)
      IF (IDEBUG.NE.1) GO TO 100
          J = MSGDIM
          IF (J.GT.10) J = 10
          WRITE (IUDBUG,10000) (MSG(N),N=1,J)
          WRITE (IUDBUG,10001) REALN
          WRITE (IUDBUG,10002) (MSG(N),N=1,J)
100   RETURN
10000 FORMAT (' *DEBUG* BEGIN',1X,10A4)
10001 FORMAT (' ',F12.7,1X,F12.7,1X,F12.7,1X,F12.7)
10002 FORMAT (' *DEBUG* END  ',1X,10A4)
      END
./     ADD     NAME=DBUGRN
C*********************************************************************
      SUBROUTINE DBUGRN(MSG,MSGDIM,REALN)
C PURPOSE : IF TRACE IS ACTIVE, DISPLAY DEBUGGING INFORMATION
C*********************************************************************
      COMMON /DEBUG/ IDEBUG
      COMMON /DBUGUN/ IUDBUG
      DIMENSION MSG(MSGDIM)
      IF (IDEBUG.NE.1) GO TO 100
          J = MSGDIM
          IF (J.GT.10) J = 10
          WRITE (IUDBUG,10000) REALN, (MSG(N),N=1,J)
100   RETURN
10000 FORMAT (' *DEBUG*',F20.7,1X,10A4)
      END
./     ADD     NAME=DEATHR
C*********************************************************************
      SUBROUTINE DEATHR
C PURPOSE : TO SAY DEATHRAY (SSTREK COMMAND) NOT AVAIL
C*********************************************************************
      CALL DBUGIN ('DEATHR ENTERED',IW(14),0)
      CALL PRMSG (
     *  'KLINGONS DON''T NEED "TOY" WEAPONS LIKE A DEATHRAY    ',
     *     IW(49))
      CALL PRMSG ('TO DO THEIR FIGHTING FOR THEM.',IW(30))
      CALL DBUGIN ('DEATHR EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=DEBUGX
C*********************************************************************
      SUBROUTINE DEBUGX
C PURPOSE : WRITE GAME VARIABLES TO THE EXTENDED DEBUGGING FILE
C*********************************************************************
      COMMON /SHIPS/ IUSFED(15,13)
      COMMON /TRACOM/ TARX,TARY,ISCPX2,ISCPY2,NSECE(10,10),IHIT,ISBC,
     *     IFSC,IKCC,ITORCT,ISB,IFS,IKC,IPR,ISCPX1,ISCPY1,ICHC,IPLC,ISTC
     *     ,ET,ISECT(10,10),TVX,TVY,ICMC
      COMMON /PADDED/ IPAD1(9),ICHART(8,8),IPAD2(9),IPLNET(8,8),
     *     IKY(8,8),INPUT(50),IPAD3
      COMMON /DEVICE/ XCDC,XSRDC,XIEDC,XLRDC,XWEDC,XDSDC,XSSDC,XPTDC
      COMMON /NUMBER/ NSTARS,NPLNTS,NSBASE,NFED,NCOMM,NFX(9),NFY(9),NCX(
     *     9),NCY(9)
      COMMON /INFO/ ICOND(2),ENERGY,ISHUPD,ISHENG,IAPDEV,IPOF,IOVER
      COMMON /HURT/ NOCALL,IPLENG,IPBASE,IFED2,ICOMM2
      COMMON /MISC/ BATTER,ISSAVE,IDUM,WFACT,IDATF,ILEV,CSDATE,TGIVEN
      COMMON /DBUGUN/ IUDBUG
      WRITE (IUDBUG,09999)
09999 FORMAT (/' ================== XSNAP BEGIN')
      WRITE (IUDBUG,10000)
     *     CSDATE,TGIVEN,ILEV,WFACT,IDATF,BATTER,ISSAVE,IDUM,TARX
10000 FORMAT (' CSDATE=',F14.3/' TGIVEN=',F14.3/' ILEV  =',I14  /
     *        ' WFACT =',F14.3/' IDATF =',I14  /' BATTER=',F14.3/
     *        ' ISSAVE=',I14  /' IDUM  =',I14  /' TARX  =',F14.3)
      WRITE (IUDBUG,10001)
     *     TARY,ISCPX2,ISCPY2,NSECE,IHIT,ISBC,IFSC,IKCC,ITORCT,ISB,IFS
10001 FORMAT (' TARY  =',F14.3/' ISCPX2=',I14  /' ISCPY2=',I14  /
     *        ' NSECE = (10 * 10)',20(/5I15)/
     *                         ' IHIT  =',A4   /' ISBC  =',I14  /
     *        ' IFSC  =',I14  /' IKCC  =',I14  /' ITORCT=',I14  /
     *        ' ISB   =',I14  /' IFS   =',I14  )
      WRITE (IUDBUG,10002)
     *     IKC,IPR,ISCPX1,ISCPY1,ICHC,IPLC,ISTC,ET,ISECT,TVX,TVY,ICMC
10002 FORMAT (' IKC   =',I14  /' IPR   =',I14  /' ISCPX1=',I14  /
     *        ' ISCPY1=',I14  /' ICHC  =',I14  /' IPLC  =',I14  /
     *        ' ISTC  =',I14  /' ET    =',F14.3/
     *        ' ISECT = (10 * 10)',10(/10A4)/
     *        ' TVX   =',F14.3/' TVY   =',F14.3/' ICMC  =',I14  )
      WRITE (IUDBUG,10003)
     *     ICHART,IPLNET,IKY,IPAD3,XCDC,XSRDC,XIEDC,XLRDC,XWEDC,XDSDC
10003 FORMAT (' ICHART= (8 * 8)',16(/4I15)/
     *        ' IPLNET= (8 * 8)',16(/4I15)/
     *        ' IKY   = (8 * 8)',16(/4I15)/
     *                                          ' IPAD3 =',I14  /
     *        ' XCDC  =',F14.3/' XSRDC =',F14.3/' XIEDC =',F14.3/
     *        ' XLRDC =',F14.3/' XWEDC =',F14.3/' XDSDC =',F14.3)
      WRITE (IUDBUG,10004)
     *     XSSDC,XPTDC,NSTARS,NPLNTS,NSBASE,NFED,NCOMM,ICOND,ENERGY
10004 FORMAT (' XSSDC =',F14.3/' XPTDC =',F14.3/' NSTARS=',I14  /
     *        ' NPLTS =',I14  /' NSBASE=',I14  /' NFED  =',I14  /
     *        ' NCOMM =',F14.3/' ICOND =',2A4  /' ENERGY=',F14.3)
      WRITE (IUDBUG,10005)
     *     ISHUPD,ISHENG,IAPDEV,IPOF,IOVER,NOCALL,IPLENG,IPBASE,IFED2
10005 FORMAT (' ISHUPD=',A4   /' ISHENG=',I14  /' IAPDEV=',I14  /
     *        ' IPOF  =',I14  /' IOVER =',I14  /' NOCALL=',I14  /
     *        ' IPLENG=',I14  /' IPBASE=',I14  /' IFED2 =',I14  )
      WRITE (IUDBUG,10006)
     *     ICOMM2,IUSFED
10006 FORMAT (' ICOMM2=',I14  /
     *        ' IUSFED= (15 * 13)',13(/4I3,11A4))
      WRITE (IUDBUG,10007) NFX,NFY,NCX,NCY
10007 FORMAT (' NFX   =',5I15/' ',4I15/
     *        ' NFY   =',5I15/' ',4I15/
     *        ' NCX   =',5I15/' ',4I15/
     *        ' NCY   =',5I15/' ',4I15)
      WRITE (IUDBUG,10099)
10099 FORMAT (/' ================== XSNAP END')
      RETURN
      END
./     ADD     NAME=DESMSG
C*********************************************************************
      SUBROUTINE DESMSG
C PURPOSE : DISPLAY "YOU BLEW UP MSG"
C*********************************************************************
      CALL DBUGIN ('DESMSG ENTERED',IW(14),0)
      CALL LINEF
      CALL PRMSG ('  #CLICK#',IW(10))
      CALL LINEF
      CALL PRMSG (
     *     '*********************************************************',
     *     IW(57))
      CALL PRMSG (
     *     '****         SUPERCOMMANDER KAZH DESTROYED           ****',
     *     IW(57))
      CALL PRMSG (
     *     '*********************************************************',
     *     IW(57))
      CALL DBUGIN ('DESMSG EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=DISPIN
C*********************************************************************
      SUBROUTINE DISPIN
C PURPOSE : DISPLAY INFORMATION ABOUT INITIAL SETUP
C           NUMBERS (I.E. FEDERATION AND KLINGON STRENGTHS)
C*********************************************************************
      COMMON /TRACOM/ TARX,TARY,ISCPX2,ISCPY2,NSECE(10,10),IHIT,ISBC,
     *    IFSC,IKCC,ITORCT,ISB,IFS,IKC,IPR,ISCPX1,ISCPY1,ICHC,IPLC,
     * ISTC,ET,ISECT(10,10),TVX,TVY,ICMC
      CALL DBUGIN ('DISPIN ENTERED',IW(14),0)
      CALL LINEF
      CALL PRMIM (' ',0,IW(1),ISB,'FEDERATION STARBASES',20,IW(20))
      CALL PRMIM (' ',0,IW(1),IFS,'FEDERATION STARSHIPS',20,IW(20))
      CALL LINEF
      CALL PRMIM ('YOU WILL HAVE ',14,IW(14),IKC,
     *     'COMMANDERS TO ASSIST YOU',24,IW(24))
      CALL PRMSG ('GOOD LUCK. ALL OF KLINGON GOES WITH YOU',IW(39))
      CALL LINEF
      CALL DBUGIN ('DISPIN EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=DIST
C*********************************************************************
      REAL FUNCTION DIST (TQX,TSX,TQY,TSY,PQX,PSX,PQY,PSY)
C*********************************************************************
C     DIST IS DISTANCE IN QUADRANTS
C     TQX - IS TARGET QUADRANT X VALUE.
C     TSX - IS TARGET SECTOR X VALUE.
C     TQY - IS TARGET QUADRANT Y VALUE
C     TSY - IS TARGET SECTOR Y VALUE
C     PQX - IS PRESENT QUADRANT X VALUE
C     PSX - IS PRESENT SECTOR X VALUE
C     PQY - IS PRESENT QUADRANT Y VALUE
C     PSY - IS PRESENT SECTOR Y VALUE.
C     ----------------------------------------------------------------
C     TARGET IS AREA YOU WISH TO GO TO.
C     PRESENT IS AREA WHERE YOU ARE NOW.
C     OTHER VARIABLES ARE USED AS INTERMEDIATE RESULT AREAS
C     ----------------------------------------------------------------
      INTEGER TQX,TSX,TQY,TSY,PQX,PSX,PQY,PSY
      REAL XTP,XPP,YTP,YPP
      CALL DBUGIN ('FUNC DIST ENTERED',IW(17),0)
      CALL DBUGRN ('(DIST) PQX=',IW(11),PQX)
      CALL DBUGRN ('(DIST) PQY=',IW(11),PQY)
      CALL DBUGRN ('(DIST) PSX=',IW(11),PSX)
      CALL DBUGRN ('(DIST) PSY=',IW(11),PSY)
      CALL DBUGRN ('(DIST) TQX=',IW(11),TQX)
      CALL DBUGRN ('(DIST) TQY=',IW(11),TQY)
      CALL DBUGRN ('(DIST) TSX=',IW(11),TSX)
      CALL DBUGRN ('(DIST) TSY=',IW(11),TSY)
      XTP = TQX+(.1*(TSX-1))
      XPP = PQX+(.1*(PSX-1))
      YTP = TQY+(.1*(TSY-1))
      YPP = PQY+(.1*(PSY-1))
      D = SQRT(((XTP-XPP)**2)+((YTP-YPP)**2))
      DIST = D
      CALL DBUGRN ('(DIST) DIST=',IW(12),D)
      CALL DBUGIN ('FUNC DIST EXITED',IW(16),0)
      RETURN
      END
./     ADD     NAME=DOCK
C*********************************************************************
      SUBROUTINE DOCK
C PURPOSE : PRINT MSG SAYING DOCK NOT AVAIL
C*********************************************************************
      CALL DBUGIN ('DOCK ENTERED',IW(12),0)
      CALL LINEF
      CALL PRMSG ('WHAT ARE YOU PLANNING TO DO, DOCK WITH',IW(38))
      CALL PRMSG ('A FEDERATION STARBASE ???',IW(25))
      CALL DBUGIN ('DOCK EXITED',IW(11),0)
      RETURN
      END
./     ADD     NAME=DRAGIN
C*********************************************************************
      SUBROUTINE DRAGIN
C PURPOSE : HANDLE CONDITION OF STARBASE CALLING FOR HELP, PULL IN
C           HELPERS IF AVAILABLE
C*********************************************************************
      COMMON /CHARS/ KZA,KZB,KZC,KZD,KZE,KZF,KZG,KZH,KZI,KZJ,KZK,KZL,KZM
     *     ,KZN,KZO,KZP,KZQ,KZR,KZS,KZT,KZU,KZV,KZW,KZX,KZY,KZZ,ICRDOT,
     *     ICRPLS,ICRCRH,ICRSTR,ICRMIN,ICRZER,KZ1,KZ2,KZ3,KZ4,KZ5,KZ6,
     *     KZ7,KZ8,KZ9,ICRBLK
      COMMON /HURT/ NOCALL,IPLENG,IPBASE,IFED2,ICOMM2
      COMMON /TRACOM/ TARX,TARY,ISCPX2,ISCPY2,NSECE(10,10),IHIT,ISBC,
     *     IFSC,IKCC,ITORCT,ISB,IFS,IKC,IPR,ISCPX1,ISCPY1,ICHC,IPLC,ISTC
     *     ,ET,ISECT(10,10),TVX,TVY,ICMC
      COMMON /SHIPS/ IUSFED(15,13)
      COMMON /PADDED/ IPAD1(9),ICHART(8,8),IPAD2(9),IPLNET(8,8),
     *     IKY(8,8),INPUT(50),IPAD3
      COMMON /DEVICE/ XCDC,XSRDC,XIEDC,XLRDC,XWEDC,XDSDC,XSSDC,XPTDC
      COMMON /NUMBER/ NSTARS,NPLNTS,NSBASE,NFED,NCOMM,NFX(9),NFY(9),NCX(
     *     9),NCY(9)
      COMMON /INFO/ ICOND(2),ENERGY,ISHUPD,ISHENG,IAPDEV,IPOF,IOVER
      COMMON /SSINFO/ IOXQ(9),IOYQ(9),INXS(9),INYS(9)
      CALL DBUGIN ('DRAGIN ENTERED',IW(14),0)
      ICTFLG = 0
      GO TO 10
C*********************************************************************
      ENTRY DRAGCC
C*********************************************************************
      ICTFLG = 1
10    CALL DBUGIN ('DRAGCC ENTERED',IW(14),0)
      CALL ITERPT
      IF (NFED.GT.0.OR.(NSBASE.EQ.0.AND.NPLNTS.EQ.0)) GO TO 200
      IF (NOCALL.EQ.1) GO TO 200
      IDAMG = 0
      IF (NPLNTS.EQ.0) GO TO 20
      CALL LOCATE (KZP,IIXP,IIYP)
      M1 = NSECE(IIXP,IIYP)
      IF (M1.NE.IPLENG.AND.M1.LE.-200000000) IDAMG = 2
20    IF (NSBASE.EQ.0) GO TO 30
      CALL LOCATE (KZB,IIXB,IIYB)
      IF (NSECE(IIXB,IIYB).NE.IPBASE) IDAMG = 1
30    IF (IDAMG.EQ.0) GO TO 200
      ILOX = ISCPX1-ISGN(ISCPX1-1)
      IHIX = ISGN(8-ISCPX1)+ISCPX1
      ILOY = ISCPY1-ISGN(ISCPY1-1)
      IHIY = ISGN(8-ISCPY1)+ISCPY1
      IF (XSRDC.GT.0.001) GO TO 80
      CALL LINEF
      CALL PRMSG (
     *  'LORD COMMANDER, WE HAVE INTERCEPTED A SUBSPACE RADIO',
     *  IW(52))
      CALL PRMSG (
     *  'TRANSMISSION ON A FEDERATION FREQUENCY:',IW(39))
      CALL LINEF
      CALL PRMSG (
     *  '# PRIORITY ONE # CALL TO ANY FEDERATION STARSHIP:',IW(49))
      CALL LINEF
      NOCALL = 1
      IF (IDAMG.EQ.2) GO TO 40
      CALL PRMSM (
     *  'FROM STARBASE IN QUADRANT: ',27,IW(27),
     *  ISCPY1,ISCPX1,' ',0,1)
      GO TO 50
40    CALL PRMSM (
     *  'FROM FEDERATION PLANET IN QUADRANT: ',36,IW(36),ISCPY1,
     *     ISCPX1,' ',0,1)
50    IF (ICTFLG.EQ.0) GO TO 60
      CALL PRMSG (
     *  'WE ARE CURRENTLY UNDER ATTACK FROM A KLINGON COMMANDER',
     *  IW(54))
      GO TO 70
60    CALL PRMSG (
     *  'WE ARE UNDER ATTACK FROM THE KLINGON SUPER-COMMANDER',
     *  IW(52))
70    CALL PRMSG ('       ... PLEASE RESPOND.',IW(26))
80    CALL LINEF
C     --- FIND IF THERE ARE ANY STARSHIPS HANDY ---
      IRESP = 0
      ISSCNT = 1
      DO 120 I = ILOY, IHIY
           DO 110 J = ILOX, IHIX
                IF (ISCPX1.EQ.J.AND.ISCPY1.EQ.I) GO TO 110
                CALL SCAN (ICHART(J,I))
                IF (IFED2.EQ.0) GO TO 110
                CALL ITERPT
                IF (NFED.EQ.9) GO TO 130
                IF (XLRDC.LE.0.001) CALL PRMSM (
     *               'INCOMING FEDERATION STARSHIP(S) FROM: ',
     *               38,IW(38),I,J,' ',0,1)
                IRESP = IRESP+1
                ICHART(J,I) = ICHART(J,I)-(100*IFED2)
                ICHART(ISCPX1,ISCPY1)=ICHART(ISCPX1,ISCPY1)+(100*IFED2)
                DO 100 M = 1, IFED2
90                   M1 = RAND(10.0)+1.0
                     M2 = RAND(10.0)+1.0
                     IF (ISECT(M1,M2).NE.ICRDOT) GO TO 90
                     ISECT(M1,M2) = KZF
                     NSECE(M1,M2) = IFEDST(DUMMY)
                     IOXQ(ISSCNT) = J
                     IOYQ(ISSCNT) = I
                     INXS(ISSCNT) = M1
                     INYS(ISSCNT) = M2
                     ISSCNT = ISSCNT+1
100             CONTINUE
110        CONTINUE
120   CONTINUE
130   IF (IRESP.GT.0) GO TO 140
      CALL LINEF
      CALL PRMSG ('NO FEDERATION STARSHIPS RESPOND',IW(31))
      CALL LINEF
      GO TO 200
140   CALL SSPRNT (1)
      IF (XSRDC.GT.0.001) GO TO 200
      CALL LINEF
      CALL PRMSG (
     *  'TOP ALERT CALL FROM SUPER-COMMANDER KAZH:',IW(41))
      CALL LINEF
      CALL PRMSG (
     *  'ALL COMMANDERS IN RANGE ARE ORDERED TO CONVERGE ',IW(48))
      CALL PRMSM ('ON QUADRANT: ',13,IW(13),ISCPY1,ISCPX1,' ',0,1)
      CALL LINEF
      IRESP = 0
      DO 190 I = ILOY, IHIY
           DO 180 J = ILOX, IHIX
                IF (J.EQ.ISCPX1.AND.I.EQ.ISCPY1) GO TO 180
                CALL SCAN (ICHART(J,I))
                IF (ICOMM2.EQ.0) GO TO 180
                CALL ITERPT
                IF (NCOMM.EQ.9) GO TO 200
                CALL PRMSM ('COMMANDER(S) IN QUADRANT: ',26,IW(26),
     *               I,J,'RESPOND',7,IW(7))
                IRESP = IRESP+1
                ICHART(J,I) = ICHART(J,I)-(1000*ICOMM2)
                ICHART(ISCPX1,ISCPY1)=ICHART(ISCPX1,ISCPY1)+
     *                                            (1000*ICOMM2)
                DO 170 M = 1, ICOMM2
160                  M1 = RAND(10.0)+1.0
                     M2 = RAND(10.0)+1.0
                     IF (ISECT(M1,M2).NE.ICRDOT) GO TO 160
                     ISECT(M1,M2) = KZC
                     NSECE(M1,M2) = -4500
170             CONTINUE
180        CONTINUE
190   CONTINUE
      IF (IRESP.GT.0) GO TO 200
      CALL LINEF
      CALL PRMSG ('NO COMMANDERS RESPONDED, LORD COMMANDER',IW(39))
      CALL LINEF
200   CALL DBUGIN ('DRAGIN/DRAGCC EXITED',IW(20),0)
      RETURN
      END
./     ADD     NAME=EMPLAC
C*********************************************************************
      SUBROUTINE EMPLAC (NFS)
C PURPOSE : PLACE FEDERATION STARSHIPS (FOR EMERITUS ONLY) SO
C           THAT ALL STARBASES ARE GUARDED BY A STARSHIP, AND
C           "EXTRA" STARSHIPS ARE PUT NEAR STARBASES TOO.
C*********************************************************************
      COMMON /SHIPS/ IUSFED(15,13)
      COMMON /PADDED/ IPAD1(9),ICHART(8,8),IPAD2(9),IPLNET(8,8),
     *     IKY(8,8),INPUT(50),IPAD3
      CALL DBUGIN ('EMPLAC ENTERED',IW(14),0)
      IRF = 0
      DO 30 J = 1, 8
           DO 20 I = 1, 8
                IF (MOD(ICHART(I,J)/10,10).EQ.0) GO TO 20
                IRF = IRF+1
10              IX = (IFIX(RAND(3.0)+1.0)-2)+I
                IY = (IFIX(RAND(3.0)+1.0)-2)+J
                IF (IX.LT.1.OR.IX.GT.8.OR.IY.LT.1.OR.IY.GT.8) GO TO 10
                ICHART(IX,IY) = ICHART(IX,IY)+100
                CALL SSINIT (IUSFED,IX,IY)
20         CONTINUE
30    CONTINUE
      IFMORE = NFS-IRF
      DO 90 J = 1, IFMORE
40         IX = RAND(8.0)+1.0
           IY = RAND(8.0)+1.0
           ILOX = IX-ISGN(IX-1)
           IHIX = ISGN(8-IX)+IX
           ILOY = IY-ISGN(IY-1)
           IHIY = ISGN(8-IY)+IY
           DO 60 N = ILOY, IHIY
                DO 50 I = ILOX, IHIX
                     IF (MOD(ICHART(I,N)/10,10).NE.0) GO TO 70
50              CONTINUE
60         CONTINUE
           IOK = 0
           GO TO 80
70         IOK = 1
80         IF (IOK.EQ.0) GO TO 40
           ICHART(IX,IY) = ICHART(IX,IY)+100
           CALL SSINIT (IUSFED,IX,IY)
90    CONTINUE
      CALL DBUGIN ('EMPLAC EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=ENGUSE
C*********************************************************************
      FUNCTION ENGUSE (D,WF)
C PURPOSE : COMPUTE HOW MUCH ENERGY USED TO MOVE AT A CERTAIN
C           WARP FACTOR
C*********************************************************************
C     D IS DISTANCE IN QUADRANTS
C     WF IS CURRENT WARP FACTOR
C ----------------------------------------------------------------
      CALL DBUGIN ('ENGUSE ENTERED',IW(14),0)
      E = D*(WF**(2.0+((12.0-WF)*.1)))
      CALL DBUGRN ('ENGUSE VALUE=',IW(13),E)
      ENGUSE = E
      CALL DBUGIN ('ENGUSE EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=ENGYST
C*********************************************************************
      SUBROUTINE ENGYST (IENGST,IZRED)
C PURPOSE : TEST LEVEL OF ENERGY LEFT IN SHIP
C           SET IENGST = -1 IF OUT OF ENERGY, 0 IF OK TO CONTINUE
C*********************************************************************
      COMMON /PADDED/ IPAD1(9),ICHART(8,8),IPAD2(9),IPLNET(8,8),
     *    IKY(8,8), INPUT(50),IPAD3
      COMMON /DEVICE/ XCDC,XSRDC,XIEDC,XLRDC,XWEDC,XDSDC,XSSDC,XPTDC
      COMMON /INFO/ ICOND(2),ENERGY,ISHUPD,ISHENG,IAPDEV,IPOF,IOVER
      COMMON /MISC/ BATTER,ISSAVE,IDUM,WFACT,IDATF,ILEV,CSDATE,TGIVEN
      COMMON /TRACOM/ TARX,TARY,ISCPX2,ISCPY2,NSECE(10,10),IHIT,ISBC,
     *    IFSC,IKCC,ITORCT,ISB,IFS,IKC,IPR,ISCPX1,ISCPY1,ICHC,IPLC,ISTC
     *     ,ET,ISECT(10,10),TVX,TVY,ICMC
      CALL DBUGIN ('ENGYST ENTERED',IW(14),0)
      IENGST = 0
      IF (ENERGY.GT.0.0) GO TO 190
      CALL LINEF
      IF (XCDC.GT.0.001) GO TO 160
      CALL PRMSG (
     * 'MAIN ENERGY BANKS HAVE FALLEN TO ZERO, BATTLE COMPUTER',IW(54))
      CALL PRMSG (
     * 'LOCKED INTO EMERGENCY ENERGY CIRCUITS, CROSS-CIRCUITING',IW(55)
     * )
      CALL PRMSG ('TO EMERGENCY RUBIDIUM ENERGY STORAGE CELLS',IW(42))
      CALL LINEF
      ENERGY = ENERGY+BATTER
      BATTER = 0.0
      IF (ENERGY.GT.0.0) GO TO 190
160   IF (ICROG(ICHART(ISCPX1,ISCPY1)).EQ.IZRED) GO TO 170
      CALL LINEF
      CALL PRMSG ('YOUR COMPUTER WAS UNABLE TO RESTORE YOUR ENERGY,',
     *     IW(48))
      CALL PRMSG ('YOU AND YOUR CREW DIE IN THE CRUEL COLDNESS OF SPACE'
     *     ,IW(52))
      GO TO 180
170   CALL LINEF
      CALL PRMSG ('THE SUPERCOMMANDER KAZH IS DESTROYED IN BATTLE',
     *     IW(46))
      CALL PRMSG ('AS FAR AS A KLINGON IS CONCERNED, THIS IS THE ONLY',
     *     IW(50))
      CALL PRMSG ('WAY TO DIE!',IW(11))
180   IENGST = -1
190   CALL DBUGIN ('ENGYST EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=ESCAPE
C*********************************************************************
      SUBROUTINE ESCAPE (INX,INY,IOUTX,IOUTY)
C PURPOSE : COMPUTE A RANDOM LOCATION TO MOVE TO FOR SUPERNOVA IF
C           COMPUTER DAMAGED
C*********************************************************************
      CALL DBUGIN ('ESCAPE ENTERED',IW(14),0)
10    IXX = (IFIX(RAND(3.0)+1.0)-2)+INX
      IYY = (IFIX(RAND(3.0)+1.0)-2)+INY
      IF (IXX.EQ.INX.AND.IYY.EQ.INY) GO TO 10
      IF (IXX.GT.8.OR.IXX.LT.1.OR.IYY.GT.8.OR.IYY.LT.1) GO TO 10
      IOUTX = IXX
      IOUTY = IYY
      CALL DBUGIN ('ESCAPE EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=FREEZE
C*********************************************************************
      SUBROUTINE FREEZE
C PURPOSE : WRITE GAME VARIABLES TO A FREEZE FILE
C*********************************************************************
      COMMON /SHIPS/ IUSFED(15,13)
      COMMON /TRACOM/ TARX,TARY,ISCPX2,ISCPY2,NSECE(10,10),IHIT,ISBC,
     *     IFSC,IKCC,ITORCT,ISB,IFS,IKC,IPR,ISCPX1,ISCPY1,ICHC,IPLC,ISTC
     *     ,ET,ISECT(10,10),TVX,TVY,ICMC
      COMMON /PADDED/ IPAD1(9),ICHART(8,8),IPAD2(9),IPLNET(8,8),
     *     IKY(8,8),INPUT(50),IPAD3
      COMMON /DEVICE/ XCDC,XSRDC,XIEDC,XLRDC,XWEDC,XDSDC,XSSDC,XPTDC
      COMMON /NUMBER/ NSTARS,NPLNTS,NSBASE,NFED,NCOMM,NFX(9),NFY(9),NCX(
     *     9),NCY(9)
      COMMON /INFO/ ICOND(2),ENERGY,ISHUPD,ISHENG,IAPDEV,IPOF,IOVER
      COMMON /HURT/ NOCALL,IPLENG,IPBASE,IFED2,ICOMM2
      COMMON /MISC/ BATTER,ISSAVE,IDUM,WFACT,IDATF,ILEV,CSDATE,TGIVEN
      COMMON /SRCOPY/ ISCOP(10,10)
      CHARACTER *4 CZRBLK
      EQUIVALENCE (CZRBLK,ICRBLK)
      DATA CZRBLK /' '/
      CALL DBUGIN ('FREEZE ENTERED',IW(14),0)
      IDATF = 0
      REWIND 27
      WRITE (27) CSDATE,TGIVEN,ILEV,WFACT,IDATF,BATTER,ISSAVE,IDUM,TARX,
     *     TARY,ISCPX2,ISCPY2,NSECE,IHIT,ISBC,IFSC,IKCC,ITORCT,ISB,IFS,
     *     IKC,IPR,ISCPX1,ISCPY1,ICHC,IPLC,ISTC,ET,ISECT,TVX,TVY,ICMC,
     *     ICHART,IPLNET,IKY,IPAD3,XCDC,XSRDC,XIEDC,XLRDC,XWEDC,XDSDC,
     *     XSSDC,XPTDC,NSTARS,NPLNTS,NSBASE,NFED,NCOMM,ICOND,ENERGY,
     *     ISHUPD,ISHENG,IAPDEV,IPOF,IOVER,NOCALL,IPLENG,IPBASE,IFED2,
     *     ICOMM2,IUSFED
      ENDFILE 27
      REWIND 27
      CALL PRMSG ('GAME NOW ON FROZEN FILE (TAPE27/FT27F001)',IW(41))
      CALL DBUGIN ('FREEZE EXITED',IW(13),0)
      GO TO 30
C*********************************************************************
      ENTRY GET
C PURPOSE : READ THE VARIABLES BACK FROM THE FROZEN FILE
C*********************************************************************
C     PLEASE NOTE, IPAD1(1) IS USED AS AN ERROR FLAG SINCE
C     IT IS NOT OF GREAT IMPORTANCE TO THE MAIN PROGRAM.
C     ----------------------------------------------------------------
      CALL DBUGIN ('GET ENTERED',IW(11),0)
      IPAD1(1) = 999999
      REWIND 27
      READ (27,END=20,ERR=20)
     *     CSDATE,TGIVEN,ILEV,WFACT,IDATF,BATTER,ISSAVE,IDUM,
     *     TARX,TARY,ISCPX2,ISCPY2,NSECE,IHIT,ISBC,IFSC,IKCC,ITORCT,ISB,
     *     IFS,IKC,IPR,ISCPX1,ISCPY1,ICHC,IPLC,ISTC,ET,ISECT,TVX,TVY,
     *     ICMC,ICHART,IPLNET,IKY,IPAD3,XCDC,XSRDC,XIEDC,XLRDC,XWEDC,
     *     XDSDC,XSSDC,XPTDC,NSTARS,NPLNTS,NSBASE,NFED,NCOMM,ICOND,
     *     ENERGY,ISHUPD,ISHENG,IAPDEV,IPOF,IOVER,NOCALL,IPLENG,IPBASE,
     *     IFED2,ICOMM2,IUSFED
      DO 10 I=1, 10
         DO 10 J=1,10
            ISCOP(I,J) = ICRBLK
10    CONTINUE
      CALL DBUGIN ('GET EXITED',IW(10),0)
      GO TO 30
20    CALL PRMSG ('ERROR WHILE READING FILE, TRY AGAIN',IW(35))
      IPAD1(1) = -99999
30    RETURN
      END
./     ADD     NAME=FSIO1
FSR1     TITLE '--- FSIO1 - DO FULLSCREEN TPUT/TGET ROUTINE ---'
FSIO1    START 0
*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*
* PURPOSE : ROUTINE FSIO1 - DO FULLSCREEN TPUT/TGET                 *
*           INPUT  - BUFFERS IN COMMON "FSBUFF"                     *
*           OUTPUT - A LINE OF INPUT, 50 CHARACTERS LONG RETURNED   *
*                    IN COMMOM "FSBUFF"                             *
*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*
        YREGS
        SAVE   (14,12),,*          SAVE REGISTERS
         LR    R12,R15             ESTABLISH ADDRESSABILITY
         USING FSIO1,R12           WE GOT IT
         ST    R13,SAVEAREA+4      NON-RENT, NO BIG DEAL HERE
         LA    R15,SAVEAREA        SET FORWARD/BACKWORD POINTERS
         ST    R15,8(,R13)           " " "
         LA    R13,SAVEAREA          " " "
* 1) INIT THE COUNTERS FOR PROGRAM (AT LEAST MAKE PROGRAM "REUS")
         XC    COUNTER,COUNTER     ZERO OUT COUNTER
         XC    BUFFDISP,BUFFDISP   DISP TO CURRENT $WORK
         XC    LNCNT,LNCNT         ZERO OUT LINE COUNTER
         L     R11,=V(FSBUFF)      COMMON "FSBUFF"
         USING $FSBUFF,R11         ADDRESS IT
* 2) OBTAIN INFO ABOUT TERMINAL (IBM3270) IT IS 24, 32 OR 43 LINES
*    AND PREPARE THE CLEAR SCREEN SEQUENCE FOR OUR DATA
         L     R3,=V(TERMSZ)       COMMON "TERMSZ"
         LM    R0,R1,0(R3)         GET VARIABLES "IILINE" AND "IILLEN"
         LTR   R15,R0              DETERMINE IF DISPLAY TERMINAL
         BZ    QUIT                IF R0=0, WE IN WRONG PLACE, OUT
         CLI   CLRSCR+5,0          ALREADY GOT SCREEN SIZE ?
         BNE   NOCSIZE             YES, SKIP, ALREADY DONE
         MR    R0,R0               GET THE SCREEN SIZE
         BCTR  R1,0                GET LAST SCREEN LOCATION
         STC   R1,CLRSCR+6         SAVE LOW-ORDER
         SRL   R1,6
         STC   R1,CLRSCR+5         SAVE HIGH-ORDER
         NC    CLRSCR+5(2),=XL2'3F3F' CONVERT TO 3270 12-BIT
         TR    CLRSCR+5(2),TBL12BIT ADDRESS FORMAT
NOCSIZE  BCTR  R15,0               DECREMENT FOR CONTIN LINE
         ST    R15,LNCNTMS         USE DISPLAY SIZE VALUE
* 3) SET AN INITIAL CLEAR OF THE SCREEN FOR OUR DATA
         L     R9,=V(BUFFER)       INIT THE POINTER TO BUFFER AREA
         MVC   0(L'CLRSCR,R9),CLRSCR CLEAR SEQUENCE STRING
         LA    R8,L'CLRSCR         AND SET "CURRENT" BUFFER LENGTH
         LA    R9,L'CLRSCR(,R9)    SET R9 TO CURRENT BUFFER
* 4) INIT THE BUFFER POINTERS AND COUNTERS, R9 IS CURRENT BUFFER
*    POSITION, R8 IS CURRENT LENGTH OF USED BUFFER
         MVC   LNCNT,LNCNTMS       INIT LINE COUNTER
         MVC   0(LINELEN,R9),WAITUP FILL IN WITH "WAITING" MSG
         LA    R9,LINELEN(,R9)     PUSH UP BUFFER ADDRESS
         LA    R8,LINELEN(,R8)     PUSH UP LENGTH VALUE
* 5) FILL IN HEADER FROM FSBUFF AREA FOR IT
         LA    R3,HEADLEN          LENGTH TO MOVE TO BUFFER
         LR    R5,R3               COPY LENGTH TO 2ND REG
         LR    R2,R9               "TO" BUFFER ADDRESS
         LA    R4,$HEADER          "FROM" TEXT ADDRESS
         MVCL  R2,R4               BUILD HEADING LINE
         LA    R8,HEADLEN(,R8)     INCR BUFFER SIZE
         LA    R9,HEADLEN(,R9)     INCR POSITION OF NEXT LINE
         L     R10,LNCNT           GET LINE COUNTER
         SH    R10,=AL2(HEADLINE+1) DECREMENT LINE COUNTER (HEADER
         ST    R10,LNCNT           PLUS STATUS LINE)
* 6) LOOK TO SEE IF ALL LINES DISPLAYED ... IF SO EXIT
*    OTHERWISE LOOK TO SEE IF THE PAGE IS FULL, DISPLAY IT
*    OTHERWISE KEEP FILLING IN THE PAGE BUFFER
*    TOP OF DISPLAY LOOP
PUTLOOP  CLC   COUNTER,$LINECNT    ALL LINES BEEN DISPLAYED ?
         BE    DONE                IF YES, ALL DONE
         LTR   R10,R10             IS THIS ZERO
         BP    FILLBUFF            KEEP FILLING THIS PAGE IF POS
         MVC   LNCNT,LNCNTMS       RESET LINE COUNTER
         MVC   0(L'CNTMSG,R9),CNTMSG INDICATE MORE TO COME
         MVC   L'CNTMSG(L'INCURS,R9),INCURS AND SET CURSOR
         LA    R8,L'CNTMSG+L'INCURS(,R8) INCR FOR CONTIN MESSAGE
         SR    R1,R1               NO PARMS
         L     R15,=V(GRAFIC)      ADDRESS OF GRAFICS RTN
         BALR  R14,R15             GO DO PRETTY PICTURES
         LR    R0,R8               SETUP TPUT FULLSCR REQ
         L     R1,=V(BUFFER)
         ICM   R1,8,TPUTFLG        SETUP TPUT FLAGS
        TPUT   (1),(0),R           ISSUE FULLSCREEN TPUT
        TGET   INBUF,0             DUMMY TGET, JUST FOR WAIT
         L     R9,=V(BUFFER)
         MVC   0(L'CLRSCR,R9),CLRSCR CLEAR SEQUENCE STRING
         LA    R8,L'CLRSCR         AND SET "CURRENT" BUFFER LENGTH
         LA    R9,L'CLRSCR(,R9)    SET R9 TO CURRENT BUFFER
         MVC   0(LINELEN,R9),WAITUP FILL IN WITH "WAITING" MSG
         LA    R9,LINELEN(,R9)     PUSH UP BUFFER ADDRESS
         LA    R8,LINELEN(,R8)     PUSH UP LENGTH VALUE
         LA    R8,HEADLEN(,R8)     INCR BUFFER SIZE (ALLOW HEADER)
         LA    R9,HEADLEN(,R9)     INCR POSITION OF NEXT LINE
         L     R10,LNCNT           GET LINE COUNTER
         SH    R10,=AL2(HEADLINE+1) DECREMENT LINE COUNTER
         ST    R10,LNCNT           STORE IT BACK
         B     PUTLOOP             DROP TO BOTTOM OF LOOP
FILLBUFF L     R2,BUFFDISP         LOAD WITH CURRENT BUFFER DISP
         LA    R1,$WORK            AND WORK ADDRESS
         LA    R1,0(R1,R2)         ADD THEM TOGETHER
         LA    R2,LINELEN(,R2)     ADD TO POINTER
         ST    R2,BUFFDISP         STORE IT BACK
         MVC   0(LINELEN,R9),0(R1) BUILD BUFFER ENTRY
         LA    R8,LINELEN(,R8)     INCR BUFFER SIZE
         LA    R9,LINELEN(,R9)     INCR A(NEXT BUFFER ENTRY)
         L     R1,COUNTER          LOAD COUNTER VALUE
         LA    R1,1(,R1)           INCR FOR NEXT ENTRY
         ST    R1,COUNTER          STORE BACK
         L     R10,LNCNT           DECREMENT LINE COUNTER
         BCTR  R10,0               SUBTRACT ONE
         ST    R10,LNCNT           STORE IT BACK
         B     PUTLOOP             DO THE NEXT SCREEN
* 7) THIS INVOKE OF THE ROUTINE DONE, READ THE NEXT LINE
*    OF INPUT FROM THE USER
DONE     L     R15,=V(XCHEAD)      PREPARE TO FILL IN BUFFERS
         SR    R1,R1               NO PARMS
         BALR  R14,R15             CALL ROUTINE
         L     R1,=V(BUFFER)
         MVC   0(L'CLRSCR,R1),CLRSCR CLEAR SEQUENCE STRING
         LA    R1,L'CLRSCR(,R1)    PUSH UP POINTER
         MVC   0(LINELEN,R1),CURRMSG FILL IN WITH "CURRENT" MSG
         L     R5,=V(PHASE)        ADDRESS TO "PHASE"
         ICM   R5,B'1111',0(R5)    AND IT'S VALUE
         BZ    *+L'*+6             IF ZERO, NOT IN INIT
         MVC   0(LINELEN,R1),INITMSG INIT MSG
         LA    R1,LINELEN(,R1)     PUSH UP BUFFER ADDRESS
         LA    R3,HEADLEN          LENGTH TO MOVE TO BUFFER
         LR    R5,R3               COPY LENGTH TO 2ND REG
         LR    R2,R1               "TO" BUFFER ADDRESS
         LA    R4,$HEADER          "FROM" TEXT ADDRESS
         MVCL  R2,R4               BUILD HEADING LINE
         SR    R1,R1               NO PARMS
         L     R15,=V(GRAFIC)      ADDRESS OF GRAFICS RTN
         BALR  R14,R15             GO DO PRETTY PICTURES
* 8) PULL IN THE "PROMPT" FOR THE LAST LINE
         L     R2,$PROMLEN         LENGTH OF MESSAGE
         LA    R1,$PROMPT          ADDRESS OF MESSAGE
         BCT   R2,*+L'*+6          SUBTRACT FOR 360 MOVE INST
         MVC   0(*-*,R9),0(R1)     <<EXECUTED>>
         EX    R2,*-6              FILL IN PROMPT MESSAGE
         L     R2,$PROMLEN         LENGTH OF PROMPT
         LA    R2,0(R2,R9)         ADDRESS TO FILL IN " ?"
         MVC   0(2,R2),=CL2' ?'    ADD ? TO PROMPT
         L     R2,$PROMLEN         LOAD LENGTH OF MSG
         LA    R2,2(R2)            ADD TWO FOR " ?"
         LA    R8,0(R2,R8)         INCR LENGTH OF END MSG
         LA    R9,0(R2,R9)         AND BUFFER POINTER
         MVC   0(L'UNLOCK,R9),UNLOCK FILL IN UNLOCK STRING
         LA    R8,L'UNLOCK(,R8)     ADD LENGTH OF UNLOCK
         LA    R9,L'UNLOCK(,R9)     AND BUFFER ADDRESS
         LR    R0,R8               SETUP TPUT FULLSCR REQ
         L     R1,=V(BUFFER)       ADDRESS OF BUFFER
         ICM   R1,8,TPUTFLG        SETUP TPUT FLAGS
        TPUT   (1),(0),R           FULLSCREEN
         L     R1,=V(BUFFER)       REUSE BUFFER FOR INPUT
         LA    R0,BUFFLEN          AND SET LENGTH
         MVI   $RETURN,C' '        FILL IN RETURN BUFFER W/BLANKS
         MVC   $RETURN+1(L'$RETURN-1),$RETURN       "     "
        TGET   (1),(0),EDIT,WAIT   GET INPUT FROM USER
         LTR   R15,R15             RETURN CODE ZERO ?
         BNZ   AROUND              IF NOT, BLANKS LEFT ALONE
* 9) COMPRESS AND UPPER CASE THE RECEIVED INPUT
         LR    R3,R1               SAVE LENGTH
         L     R1,=V(BUFFER)       ADDRESS BUFFER
         LA    R2,$RETURN          ADDRESS RETURN AREA
         LA    R4,L'$RETURN        RETURN AREA LENGTH
GTXT1    OI    0(R1),C' '          UPPER CASE
         CLI   0(R1),C' '
         BNE   GTXT3
GTXT2    LA    R1,1(R1)
         BCT   R3,*+L'*+4
         B     PASSIN
         OI    0(R1),C' '          UPPER CASE
         CLI   0(R1),C' '
         BE    GTXT2
         MVI   0(R2),C' '
         B     GTXT4
GTXT3    MVC   0(1,R2),0(R1)       FILL IN RETURN AREA
         LA    R1,1(R1)
         BCT   R3,*+L'*+4
         B     PASSIN
GTXT4    LA    R2,1(R2)
         BCT   R4,GTXT1            CHECK NOT TOO LONG
         MVI   $RETURN,C' '        FILL IN RETURN BUFFER W/BLANKS
         MVC   $RETURN+1(L'$RETURN-1),$RETURN       "     "
AROUND  TCLEARQ INPUT              FLUSH THE TRASH
PASSIN   XC    $LINECNT,$LINECNT   ZERO THE LINE COUNTER
         L     R3,=V(Z3270)        COMMON "Z3270"
         USING $Z3270,R3           ADDRESS OF 13A4 AND 50A1 AREA
         MVC   $A12,$RETURN        MOVE FROM RETURN AREA IN "IF12"
         LA    R4,$RETURN          ADDRESS OF RETURN
         LA    R5,$A50             ADDRESS OF "IF50"
         LA    R6,50               HOW MANY CHARS ?
FILLIN   MVC   0(4,R5),=CL4' '     BLANK OUT
         MVC   0(1,R5),0(R4)       MOVE CHAR
         LA    R4,1(R4)            PUSH UP POINTERS
         LA    R5,4(R5)
         BCT   R6,FILLIN
* 10) RESTORE REGS AND RETURN
QUIT     L     R13,SAVEAREA+4      GET ORIGINAL REGISTER 13
        RETURN (14,12),T,RC=0      RESTORE REGISTERS AND RETURN ...
         EJECT
*------- WORK AREAS (NON-RENT CODE)
         SPACE 1
SAVEAREA DC    9D'0'               REGISTERS SAVE AREA
LNCNT    DC    F'0'                LINE COUNTER
LNCNTMS  DC    F'0'                MAX # LINES/PAGE (24, 32 OR 43)
COUNTER  DC    F'0'                WORK COUNTER
BUFFDISP DC    A(0)                DISPLACEMENT TO CURRENT $WORK
INBUF    DC    XL1'0'              DUMMY BUFFER
         SPACE 1
CNTMSG   DC    C' PRESS ENTER TO SEE NEXT PAGE '
UNLOCK   DC    X'1D4113'           UNLOCK KEYBOARD STRING
INCURS   EQU   UNLOCK+L'UNLOCK-1,1
CLRSCR   DC    X'C31140403C0000001D60114040' CLEAR SCREEN
TPUTFLG  DC    X'03'          TPUT FLAGS (FULLSCR,WAIT,NOHOLD,NOBREAK)
         SPACE 1
TBL12BIT DS    0F
         DC    X'40C1C2C3C4C5C6C7C8C94A4B4C4D4E4F'
         DC    X'50D1D2D3D4D5D6D7D8D95A5B5C5D5E5F'
         DC    X'6061E2E3E4E5E6E7E8E96A6B6C6D6E6F'
         DC    X'F0F1F2F3F4F5F6F7F8F97A7B7C7D7E7F'
         SPACE 1
LINELEN  EQU   80                  LENGTH OF ONE LINE
INITMSG  DC    CL(LINELEN)' K L I N G O N     V E R S I O N    1.2.0'
CURRMSG  DC    CL(LINELEN)' TACTICAL DISPLAY IS: *CURRENT*'
WAITUP   DC    CL(LINELEN)' TACTICAL DISPLAY IS: WAITING TO BE UPDATED'
         SPACE 1
         LTORG
         EJECT
BUFFER   CSECT
LBUFF    EQU   (((L'CLRSCR+(LINELEN*43))+7)/8)*8
         DS    XL(LBUFF)           BYTES CNTL + 43 LINES
BUFFLEN  EQU   *-BUFFER            BUFFER LENGTH
         SPACE 1
$FSBUFF  DSECT ,                   START OF MAP FOR COMMON "FSBUFF"
$PROMLEN DS    F                   ("NPROML") AMOUNT OF PROMPT FILLED
$PROMPT  DS    CL80                ("NPROMT") BUFFER FOR PROMPT
$RETURN  DS    CL52                ("NREAD") RETURN AREA READ FROM USER
HEADLINE EQU   12                  NUMBER OF LINES IN HEADER
$HEADER  DS    (HEADLINE*LINELEN)CL1 ("NHEAD") SPACE FOR HEADER AREA
HEADLEN  EQU   *-$HEADER           LENGTH OF HEADER AREA
$LINECNT DS    F                   ("NCOUNT") NUMBER OF ITEMS ON $WORK
$WORK    DS    CL(200*80)          ("NWORK") WORK AREA FOR DISPLAY
$FSBUFFL EQU   *-$PROMLEN          TOTAL LENGTH
         SPACE 1
$Z3270   DSECT
$A12     DS    CL52                13A4 FORMAT ("IF12")
$A50     DS    50A                 50A1 FORMAT ("IF50")
         SPACE 1
         END
./     ADD     NAME=FSIO2
FSR2     TITLE '--- FSIO2 - DO FULLSCREEN TPUT GRAPHICS ROUTINES ---'
FSIO2    START 0
*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*
* PURPOSE : ROUTINE FSIO2 - DO FULLSCREEN TPUT FOR GRAPHICS         *
*                           ROUTINES                                *
*                   PARM. = 1) WAIT TIME (IN 0.01 OF SECOND)        *
*                           2) FULLSCREEN OPERATION FLAG :          *
*                              + = INITIAL (FIRST)                  *
*                              0 = CONTINUE (INTERMEDIATE)          *
*                              - = FINAL (LAST)                     *
*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*
        YREGS
        SAVE   (14,12),,*          SAVE REGISTERS
         LR    R12,R15             ESTABLISH ADDRESSABILITY
         USING FSIO2,R12           WE GOT IT
         ST    R13,SAVEAREA+4      NON-RENT, NO BIG DEAL HERE
         LA    R15,SAVEAREA        SET FORWARD/BACKWORD POINTERS
         ST    R15,8(,R13)           " " "
         LA    R13,SAVEAREA          " " "
         LM    R9,R10,0(R1)        WAIT TIME AND FLAG ADDRESSES
         ICM   R0,B'1111',0(R9)    GET TIME VALUE
         ST    R0,TIMESC
         ICM   R4,B'1111',0(R10)   FLAG VALUE
* 1) ADDRESS WORK BUFFER
         L     R11,=V(DISPLY)      COMMON "DISPLY"
         USING $DSBUFF,R11         ADDRESS IT
* 2) OBTAIN INFO ABOUT TERMINAL (IBM3270) IT IS 24, 32 OR 43 LINES
         L     R3,=V(TERMSZ)       COMMON "TERMSZ" (CHECK "IILINE")
         ICM   R3,B'1111',0(R3)    DETERMINE IF DISPLAY TERMINAL
         BZ    QUIT                IF R0=0, WE IN WRONG PLACE, OUT
* 3) DO INITIAL CLEAR OF THE SCREEN FOR OUR DATA
         LTR   R4,R4               FIRST TIME ?
         BNP   SDFSW               NO
        STFSMODE ON
         LA    R0,L'CLRSCR         SETUP LENGTH
         LA    R1,CLRSCR           CLEAR SCREEN
         ICM   R1,8,TPUTFLG        SETUP TPUT FLAGS
        TPUT   (1),(0),R           ISSUE FULLSCREEN TPUT
* 4) DO FULLSCREEN OF OUR DATA AND "WAIT" IF REQUESTED
SDFSW    MH    R3,=AL2(LINELEN)    LINES LENGTH
         LA    R3,L'WRTSCR(,R3)
         LR    R0,R3               SETUP LENGTH
         LA    R1,$PREFXL-L'WRTSCR(,R11) ADDRESS OF BUFFER
         MVC   0(L'WRTSCR,R1),WRTSCR WRITE SEQUENCE
         OC     TIMESC,TIMESC      WAIT TIME ?
         BZ     NOWTT              NO, NO WAIT
         ICM   R1,8,TPUTFLH        YES, SETUP TPUT FLAGS
        TPUT   (1),(0),R           ISSUE FULLSCREEN TPUT
        STIMER  WAIT,,BINTVL=TIMESC AND WAIT A BIT
         B     TSTFN
NOWTT    ICM   R1,8,TPUTFLG        SETUP TPUT FLAGS
        TPUT   (1),(0),R           ISSUE FULLSCREEN TPUT
* 5) DO FINAL CLEAR OF THE SCREEN OF OUR DATA
TSTFN    LTR   R4,R4
         BNM   QUIT
         LA    R0,L'CLRSCR         SETUP LENGTH
         LA    R1,CLRSCR           CLEAR SCREEN
         ICM   R1,8,TPUTFLG        SETUP TPUT FLAGS
        TPUT   (1),(0),R           ISSUE FULLSCREEN TPUT
        STFSMODE OFF
        STLINENO LINE=1
        TCLEARQ INPUT              FLUSH THE TRASH
* 6) RESTORE REGS AND RETURN
QUIT     L     R13,SAVEAREA+4      GET ORIGINAL REGISTER 13
        RETURN (14,12),T,RC=0      RESTORE REGISTERS AND RETURN ...
         EJECT
*------- WORK AREAS (NON-RENT CODE)
         SPACE 1
SAVEAREA DC    9D'0'               REGISTERS SAVE AREA
TIMESC   DC    F'0'
CLRSCR   DC    X'27F5401140401D6013' CLEAR SCREEN
WRTSCR   DC    X'27F1401140401D6013114040' WRITE SCREEN
TPUTFLG  DC    X'03'          TPUT FLAGS (FULLSCR,WAIT,NOHOLD,NOBREAK)
TPUTFLH  DC    X'0B'          TPUT FLAGS (FULLSCR,WAIT,HOLD,NOBREAK)
         SPACE 1
         LTORG
         SPACE 1
$DSBUFF  DSECT                     START OF MAP FOR DSBUFF DSECT
$PREFIX  DS    4F                  ROOM FOR CLEAR SEQUENCE ("IDPAD")
$PREFXL  EQU   *-$PREFIX
LINELEN  EQU   80                  LENGTH OF ONE LINE
$AREA    DS    (43*LINELEN)CL1     TPUT WORK AREA
         END
./     ADD     NAME=GAINIT
GAIR     TITLE '--- GAINIT - SET VARIABLES FOR GRAPHICS ROUTINE ---'
GAINIT   START 0
*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*
* PURPOSE : THIS ROUTINE INITS THE GAME VARIABLES FOR GRAPHICS AND  *
*           IF 3270/IBM TSO SUPPORTED                               *
*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*
        YREGS
        SAVE   (14,12),,*          SAVE REGISTERS
         LR    R12,R15             SET BASE REGISTER
         USING GAINIT,R12
         ST    R13,SAVEAREA+4      NON-RENT, NO BIG DEAL HERE
         LA    R15,SAVEAREA        SET FORWARD/BACKWORD POINTERS
         ST    R15,8(,R13)           " " "
         LA    R13,SAVEAREA          " " "
*------- DETERMINE ENVIRONMENT
        EXTRACT ATIOT,'S',FIELDS=(TIOT,TSO)
         L     R1,ATSO             CHECK TSO RUNNING
         TM    0(R1),X'80'
         BZ    NOTTSO              NOT TSO
         XR    R1,R1
         L     R2,ATIOT            CHECK SEQ. LINE MODE REQUESTED
         USING TIODSECT,R2
SEARCH   CLC   TIOELNGH(4),=F'0'
         BE    NSLMRQ
         CLC   TIOEDDNM,=CL8'FT05F001'
         BE    YSLMRQ
         IC    R1,TIOELNGH
         ALR   R2,R1
         B     SEARCH
         DROP  R2
NOTTSO  WTO    '=> SORRY, ONLY TSO-FOREGROUND RUN IS ALLOWED',         X
               ROUTCDE=11,DESC=7
         B     RSZALL
YSLMRQ   XR    R6,R6               SET IBMTSO = 0
         LR    R7,R6               AND IGRAFC = 0
         B     FTTSS
NSLMRQ   LA    R6,1                SET IBMTSO = 1
         LR    R7,R6               AND IGRAFC = 1
*------- FIND TSO TERMINAL SCREEN SIZE
*        OBTAIN INFO ABOUT TERMINAL (IBM3270/ 24, 32 OR 43 LINES)
FTTSS   GTSIZE ,                   OBTAIN IBM TERMINAL INFO
         LR    R5,R1               GET LINE LENGTH
         CL    R5,=F'80'           EXACTLY 80 COLUMNS ?
         BE    OKCOLS              OK
         BL    LSHORT              LOW, UNACCEPTABLE
         LTR   R6,R6               HIGH, HAS REQUESTED SEQ. LINE MODE ?
         BNZ   LHIGH               NO
         XR    R4,R4               YES, SET AS SEQUENTIAL LINE MODE
         B     SETVAR
LHIGH    LA    R1,MSG80HGH         LET USER KNOW
         LA    R0,LEN80HGH         WE CAN'T HANDLE THEM
        TPUT   (1),(0),R           NON-FS TPUT
         B     REQMSG
LSHORT   LA    R1,MSG80LOW         LET USER KNOW
         LA    R0,LEN80LOW         WE CAN'T HANDLE THEM
        TPUT   (1),(0),R           NON-FS TPUT
         B     RSZALL
OKCOLS   LTR   R4,R0               DETERMINE IF DISPLAY TERMINAL
         BZ    NOTDST              IF R0=0, WE ARE WRONG PLACE, OUT
         CL    R4,=F'24'           EXACTLY 24 LINES ?
         BE    STDSCR              OK
         CL    R4,=F'32'           EXACTLY 32 LINES ?
         BE    STDSCR              OK
         CL    R4,=F'43'           EXACTLY 43 LINES ?
         BNE   NOTSTD              NO, NOT STANDARD
STDSCR   LTR   R6,R6               HAS REQUESTED SEQ. LINE MODE ?
         BNZ   SETVAR              NO, OK
         LA    R6,1                YES, BUT SCREEN STANDARD, SO USE IT
         B     SETVAR
NOTSTD   LA    R1,MSG24#48         OTHERWISE LET USER KNOW
         LA    R0,LEN24#48         WE CAN'T HANDLE THEM
        TPUT   (1),(0),R           NON-FS TPUT
         LTR   R6,R6               HAS REQUESTED SEQ. LINE MODE ?
         BNZ   REQMSG              NO
         XR    R4,R4               YES, SET AS SEQUENTIAL LINE MODE
         B     SETVAR
NOTDST   LTR   R6,R6               HAS REQUESTED SEQ. LINE MODE ?
         BZ    SETVAR              YES, OK
         LA    R1,MSGNOTDT         NO, INFORM USER
         LA    R0,LENNOTDT
        TPUT   (1),(0),R           NON-FS TPUT
REQMSG   LA    R1,MSGSLMRQ         INFORM USER
         LA    R0,LENSLMRQ
        TPUT   (1),(0),R           NON-FS TPUT
RSZALL   XR    R4,R4               RESET ALL
         LR    R5,R4
         LR    R6,R4
         LR    R7,R4
         BCTR  R4,0                WHEN GO BACK, ASK TO EXIT GAME
         SPACE 1
* USE OF THE VARIABLES IN COMMON "INITVR" :
* =========================================
*        FLAG IBMTSO : 0 = SEQUENTIAL LINE MODE,
*                      1 = FULL 3270 TSO SUPPORT.
*        FLAG IGRAFC : 0 = GRAPHICS BORE ME, OR MY 3270 LOOKALIKES ARE
*                          SOOO ... SLOW, GRAPHICS DON'T LOOK GOOD,
*                      1 = FULL 3270 GRAPHICS USE.
*        IF IBMTSO IS SET TO ZERO, IGRAFC IS IGNORED, OR
*        IF IBMTSO IS SET TO ONE, IT WILL ASSUME YOU ARE 3278
*             MODEL 2 OR MODEL 4, OR SOMETHING THAT RUNS LIKE IT.
*        IF IGRAFC FLAG IS SET TO ZERO, IT SUPPRESS ALL GRAPHICS
*             DISPLAYS (WHICH YOU MAY WANT TO DO IF IT DOES NOT LOOK
*             PRETTY ...).
*        THE IGRAFC FLAG CAN BE SET TO ZERO, BY ENTERING THE "EXT"
*             COMMAND (FOR "EXTERNAL VIEW") ANYTIME YOU ARE PROMPTED
*             WITH A "COMMAND - " PROMPT.
*        NOTE : IF IGRAFC FLAG IS SET TO ZERO, THE PLAYER CANNOT TURN
*               IT ON (SET TO ONE) ANYMORE.
         SPACE 1
SETVAR   L     R3,=V(TERMSZ)       COMMON "TERMSZ"
         STM   R4,R5,0(R3)         SET VARIABLES "IILINE" AND "IILLEN"
         L     R3,=V(INITVR)       COMMON "INITVR"
         STM   R6,R7,0(R3)         SET VARIABLES "IBMTSO" AND "IGRAFC"
         SPACE 1
         LTR   R4,R4               EXIT FORCED ?
         BNM   QUIT                NO
         LA    R1,MSGTERM          YES, LET USER READ MESSAGES
         LA    R0,LENTERM
        TPUT   (1),(0),R           NON-FS TPUT
        TGET   INBUF,0             DUMMY TGET, JUST FOR WAIT
QUIT     L     R13,SAVEAREA+4      GET ORIGINAL REGISTER 13
        RETURN (14,12),T,RC=0      RESTORE REGISTERS AND RETURN ...
         SPACE 1
SAVEAREA DC    9D'0'
ATIOT    DC    A(*-*)
ATSO     DC    A(*-*)
INBUF    DC    XL1'0'              DUMMY BUFFER
MSG80HGH DC    C'=> THIS TERMINAL HAS A LINE LENGTH GREATER THAN 80'
LEN80HGH EQU   *-MSG80HGH          LENGTH OF MSG
MSG80LOW DC    C'=> SORRY, CAN''T RUN WITH A LINE LENGTH LESS THAN 80'
LEN80LOW EQU   *-MSG80LOW          LENGTH OF MSG
MSG24#48 DC    C'=> YOU ARE RUNNING ON A NON 24, 32 OR 43 LINES 3270'
LEN24#48 EQU   *-MSG24#48          LENGTH OF MSG
MSGNOTDT DC    C'=> YOU ARE RUNNING ON A NON DISPLAY TERMINAL'
LENNOTDT EQU   *-MSGNOTDT          LENGTH OF MSG
MSGSLMRQ DC    C'=> SO, YOU MAY ONLY RUN UNDER SEQUENTIAL LINE MODE'
LENSLMRQ EQU   *-MSGSLMRQ          LENGTH OF MSG
MSGTERM  DC    C'=> HIT ENTER TO TERMINATE PROGRAM'
LENTERM  EQU   *-MSGTERM           LENGTH OF MSG
         SPACE 1
         LTORG
         SPACE 1
         PRINT NOGEN
TIODSECT DSECT ,
        IEFTIOT1 ,
         SPACE 1
         END
./     ADD     NAME=GRAFIC
C*********************************************************************
      SUBROUTINE GRAFIC
C PURPOSE : HANDLE THE DISPLAY FOR "MOVING" IMAGES ON THE SCREEN
C*********************************************************************
      COMMON /WORKQ/ IGCNT, INQUE(10)
      COMMON /DISPLY/ IDPAD(4), IGOUT(20,43)
      COMMON /TERMSZ/ IILINE, IILLEN
      COMMON /GRAPH/ IOK
      DIMENSION ITIMER(50)
      DIMENSION INCORE (20,43,50)
      CHARACTER *4 CZIEOF , CZNVAL
      EQUIVALENCE (CZIEOF,IEOF) , (CZNVAL,INVAL)
      DATA CZIEOF /'*EOF'/
      DATA CZNVAL /'    '/
      CALL DBUGIN ('GRAFIC ENTERED',IW(14),0)
      IF (IOK.EQ.0) IGCNT = 0
      IF (IGCNT.EQ.0.OR.IOK.NE.1) GO TO 200
      I = 1
      IF (INVAL.EQ.INQUE(I)) GO TO 100
      K = 0
10    IF (I.GT.IGCNT) GO TO 100
      REWIND 97
20    READ (97,10000,END=60) NTYPE, INLNEC, ITIME2
      IF (NTYPE.EQ.IEOF) GO TO 60
      IF (NTYPE.NE.INQUE(I)) GO TO 40
      IF (IILINE.NE.INLNEC) GO TO 40
      INVAL = NTYPE
      K = K + 1
      IF (K.GT.50) K = 50
      ITIMER(K) = ITIME2
      DO 30 J=1, INLNEC
          READ (97,10001,END=60) (INCORE(M,J,K),M=1,20)
30    CONTINUE
      GO TO 20
40    DO 50 J=1, INLNEC
          READ (97,10002,END=60) IDUMMY
50    CONTINUE
      GO TO 20
60    I = I + 1
      GO TO 10
100   DO 120 J=1, K
          DO 110 M=1, IILINE
              DO 110 L=1,20
                  IGOUT (L,M) = INCORE (L,M,J)
110       CONTINUE
          IFLAG = 0
          IF (J.EQ.1) IFLAG = 1
          IF (J.EQ.K) IFLAG = -1
          ITIME2 = ITIMER(J)
          CALL FSIO2 (ITIME2,IFLAG)
120   CONTINUE
      IGCNT = 0
200   CALL DBUGIN ('GRAFIC EXITED',IW(13),0)
      RETURN
10000 FORMAT (A4,I2,I6)
10001 FORMAT (20A4)
10002 FORMAT (A4)
      END
./     ADD     NAME=HELP
C*********************************************************************
      SUBROUTINE HELP
C PURPOSE : DISPLAY THE HELP MENU AND CALL THE HELP ROUTINE
C*********************************************************************
      COMMON /PADDED/ IPAD1(9),ICHART(8,8),IPAD2(9),IPLNET(8,8),
     *    IKY(8,8),INPUT(50),IPAD3
      COMMON /CPU/ IBMT
      COMMON /PHASE/ INIT
      DIMENSION ICATAL(40,3)
      DIMENSION ILINE(15)
      DIMENSION ISTWRK(3)
      DIMENSION IST001(3)
      DIMENSION IST002(3)
      DIMENSION IST003(3)
      DIMENSION IST004(3)
      DIMENSION IST005(3)
      DIMENSION IST006(3)
      DIMENSION IST007(3)
      DIMENSION IST008(3)
      DIMENSION IST009(3)
      DIMENSION IST010(3)
      DIMENSION IST011(3)
      DIMENSION IST012(3)
      DIMENSION IST013(3)
      DIMENSION IST014(3)
      DIMENSION IST015(3)
      DIMENSION IST016(3)
      DIMENSION IST017(3)
      DIMENSION IST018(3)
      DIMENSION IST019(3)
      DIMENSION IST020(3)
      DIMENSION IST021(3)
      DIMENSION IST022(3)
      DIMENSION IST023(3)
      DIMENSION IST024(3)
      DIMENSION IST025(3)
      DIMENSION IST026(3)
      DIMENSION IST027(3)
      DIMENSION IST028(3)
      DIMENSION IST029(3)
      DIMENSION IST030(3)
      CHARACTER *4 CZT001(3),CZT002(3),CZT003(3),CZT004(3),CZT005(3),
     *CZT006(3),CZT007(3),CZT008(3),CZT009(3),CZT010(3),CZT011(3),
     *CZT012(3),CZT013(3),CZT014(3),CZT015(3),CZT016(3),CZT017(3),
     *CZT018(3),CZT019(3),CZT020(3),CZT021(3),CZT022(3),CZT023(3),
     *CZT024(3),CZT025(3),CZT026(3),CZT027(3),CZT028(3),CZT029(3),
     *CZT030(3)
      EQUIVALENCE (CZT001,IST001),(CZT002,IST002),(CZT003,IST003),
     *(CZT004,IST004),(CZT005,IST005),(CZT006,IST006),(CZT007,IST007),
     *(CZT008,IST008),(CZT009,IST009),(CZT010,IST010),(CZT011,IST011),
     *(CZT012,IST012),(CZT013,IST013),(CZT014,IST014),(CZT015,IST015),
     *(CZT016,IST016),(CZT017,IST017),(CZT018,IST018),(CZT019,IST019),
     *(CZT020,IST020),(CZT021,IST021),(CZT022,IST022),(CZT023,IST023),
     *(CZT024,IST024),(CZT025,IST025),(CZT026,IST026),(CZT027,IST027),
     *(CZT028,IST028),(CZT029,IST029),(CZT030,IST030)
      DATA CZT001 /'A.P.','D.  ','    '/
      DATA CZT002 /'ABAN','DON ','    '/
      DATA CZT003 /'BATT','ERY ','    '/
      DATA CZT004 /'BUGS','    ','    '/
      DATA CZT005 /'CHAR','T   ','    '/
      DATA CZT006 /'COMP','UTE ','    '/
      DATA CZT007 /'DAMA','GE  ','    '/
      DATA CZT008 /'DEST','RUCT','    '/
      DATA CZT009 /'DISR','UPTO','R   '/
      DATA CZT010 /'FREE','ZE  ','    '/
      DATA CZT011 /'GRAP','HICS','    '/
      DATA CZT012 /'HINT','S   ','    '/
      DATA CZT013 /'HELP','    ','    '/
      DATA CZT014 /'IMPU','LSE ','    '/
      DATA CZT015 /'INTR','O   ','    '/
      DATA CZT016 /'LRSC','AN  ','    '/
      DATA CZT017 /'MOVE','    ','    '/
      DATA CZT018 /'NEWS','    ','    '/
      DATA CZT019 /'PHOT','ON  ','    '/
      DATA CZT020 /'REST','    ','    '/
      DATA CZT021 /'SENS','OR  ','    '/
      DATA CZT022 /'SHIE','LDS ','    '/
      DATA CZT023 /'SRSC','AN  ','    '/
      DATA CZT024 /'FS32','70  ','    '/
      DATA CZT025 /'STAT','US  ','    '/
      DATA CZT026 /'TERM','INAT','E   '/
      DATA CZT027 /'TRAC','TOR ','    '/
      DATA CZT028 /'WARP','    ','    '/
      DATA CZT029 /'    ','    ','    '/
      DATA CZT030 /'    ','    ','    '/
      CHARACTER *4 CZATAL(40,3) , CZHELP , CZH1 , CZH2 , CZE1 ,
     *             CZL1 , CZLIST , CZEND , CZBLK
      EQUIVALENCE (CZATAL,ICATAL) , (CZHELP,IHELP) , (CZH1,IH1)     ,
     *            (CZH2,IH2)      , (CZE1,IE1)     , (CZL1,IL1)     ,
     *            (CZLIST,ILIST)  , (CZEND,IEND)   , (CZBLK,IBLK)
      DATA CZATAL / 120 * ' ' /
      DATA CZHELP /'*HEL'/ , CZLIST /'*LIS'/ , CZEND /'*END'/
      DATA CZH1   /'*H  '/ , CZH2   /'*   '/ , CZE1  /'*E  '/
      DATA CZL1   /'*L  '/ , CZBLK  /' '/
      CALL DBUGIN ('HELP ENTERED',IW(12),0)
      IHOLDI = INIT
      INIT = 1
      ICATAL(1,1)  = IST001(1)
      ICATAL(1,2)  = IST001(2)
      ICATAL(1,3)  = IST001(3)
      ICATAL(2,1)  = IST002(1)
      ICATAL(2,2)  = IST002(2)
      ICATAL(2,3)  = IST002(3)
      ICATAL(3,1)  = IST003(1)
      ICATAL(3,2)  = IST003(2)
      ICATAL(3,3)  = IST003(3)
      ICATAL(4,1)  = IST004(1)
      ICATAL(4,2)  = IST004(2)
      ICATAL(4,3)  = IST004(3)
      ICATAL(5,1)  = IST005(1)
      ICATAL(5,2)  = IST005(2)
      ICATAL(5,3)  = IST005(3)
      ICATAL(6,1)  = IST006(1)
      ICATAL(6,2)  = IST006(2)
      ICATAL(6,3)  = IST006(3)
      ICATAL(7,1)  = IST007(1)
      ICATAL(7,2)  = IST007(2)
      ICATAL(7,3)  = IST007(3)
      ICATAL(8,1)  = IST008(1)
      ICATAL(8,2)  = IST008(2)
      ICATAL(8,3)  = IST008(3)
      ICATAL(9,1)  = IST009(1)
      ICATAL(9,2)  = IST009(2)
      ICATAL(9,3)  = IST009(3)
      ICATAL(10,1) = IST010(1)
      ICATAL(10,2) = IST010(2)
      ICATAL(10,3) = IST010(3)
      ICATAL(11,1) = IST011(1)
      ICATAL(11,2) = IST011(2)
      ICATAL(11,3) = IST011(3)
      ICATAL(12,1) = IST012(1)
      ICATAL(12,2) = IST012(2)
      ICATAL(12,3) = IST012(3)
      ICATAL(13,1) = IST013(1)
      ICATAL(13,2) = IST013(2)
      ICATAL(13,3) = IST013(3)
      ICATAL(14,1) = IST014(1)
      ICATAL(14,2) = IST014(2)
      ICATAL(14,3) = IST014(3)
      ICATAL(15,1) = IST015(1)
      ICATAL(15,2) = IST015(2)
      ICATAL(15,3) = IST015(3)
      ICATAL(16,1) = IST016(1)
      ICATAL(16,2) = IST016(2)
      ICATAL(16,3) = IST016(3)
      ICATAL(17,1) = IST017(1)
      ICATAL(17,2) = IST017(2)
      ICATAL(17,3) = IST017(3)
      ICATAL(18,1) = IST018(1)
      ICATAL(18,2) = IST018(2)
      ICATAL(18,3) = IST018(3)
      ICATAL(19,1) = IST019(1)
      ICATAL(19,2) = IST019(2)
      ICATAL(19,3) = IST019(3)
      ICATAL(20,1) = IST020(1)
      ICATAL(20,2) = IST020(2)
      ICATAL(20,3) = IST020(3)
      ICATAL(21,1) = IST021(1)
      ICATAL(21,2) = IST021(2)
      ICATAL(21,3) = IST021(3)
      ICATAL(22,1) = IST022(1)
      ICATAL(22,2) = IST022(2)
      ICATAL(22,3) = IST022(3)
      ICATAL(23,1) = IST023(1)
      ICATAL(23,2) = IST023(2)
      ICATAL(23,3) = IST023(3)
      ICATAL(24,1) = IST024(1)
      ICATAL(24,2) = IST024(2)
      ICATAL(24,3) = IST024(3)
      ICATAL(25,1) = IST025(1)
      ICATAL(25,2) = IST025(2)
      ICATAL(25,3) = IST025(3)
      ICATAL(26,1) = IST026(1)
      ICATAL(26,2) = IST026(2)
      ICATAL(26,3) = IST026(3)
      ICATAL(27,1) = IST027(1)
      ICATAL(27,2) = IST027(2)
      ICATAL(27,3) = IST027(3)
      ICATAL(28,1) = IST028(1)
      ICATAL(28,2) = IST028(2)
      ICATAL(28,3) = IST028(3)
      ICATAL(29,1) = IST029(1)
      ICATAL(29,2) = IST029(2)
      ICATAL(29,3) = IST029(3)
      ICATAL(30,1) = IST030(1)
      ICATAL(30,2) = IST030(2)
      ICATAL(30,3) = IST030(3)
      NUMCAT = 30
      IF (IBMT.EQ.1) GO TO 110
10    CALL LINEF
      CALL READIN ('ENTER COMMAND NAME OR *HELP',IW(27),27,0,EOFF)
      IF (EOFF.GT..1) GO TO 10
      I = INPUT(1)
      IF (I.EQ.IBLK) GO TO 10
      IF (I.EQ.IEND) GO TO 300
      IF (I.EQ.IE1) GO TO 300
      IF (I.EQ.IHELP) GO TO 20
      IF (I.EQ.IH1) GO TO 20
      IF (I.NE.IH2) GO TO 100
20    CALL LINEF
      CALL PRMSG ('*HELP SUPPLIES YOU WITH THIS LISTING.',IW(37))
      CALL PRMSG
     *     ('*LIST GIVES YOU A COMMAND LIST TO CHOOSE FROM ',IW(45))
      CALL PRMSG ('*END RETURNS YOU TO THE GAME IN PROGRESS ',IW(40))
      CALL LINEF
      GO TO 10
100   IF (I.EQ.ILIST) GO TO 110
      IF (I.NE.IL1) GO TO 200
110   CALL LINEF
      CALL PRMSG ('YOU MAY SELECT FROM THE FOLLOWING: ',IW(34))
120   CALL LINEF
      DO 130 N = 1, NUMCAT, 5
           ILINE(1) = ICATAL(N,1)
           ILINE(2) = ICATAL(N,2)
           ILINE(3) = ICATAL(N,3)
           ILINE(4) = ICATAL(N+1,1)
           ILINE(5) = ICATAL(N+1,2)
           ILINE(6) = ICATAL(N+1,3)
           ILINE(7) = ICATAL(N+2,1)
           ILINE(8) = ICATAL(N+2,2)
           ILINE(9) = ICATAL(N+2,3)
           ILINE(10) = ICATAL(N+3,1)
           ILINE(11) = ICATAL(N+3,2)
           ILINE(12) = ICATAL(N+3,3)
           ILINE(13) = ICATAL(N+4,1)
           ILINE(14) = ICATAL(N+4,2)
           ILINE(15) = ICATAL(N+4,3)
           CALL PRMSG (ILINE,IW(60))
130   CONTINUE
      CALL LINEF
      GO TO 10
200   DO 210 N = 1, 28
           IF (I.NE.ICATAL(N,1)) GO TO 210
           ILINE(1) = ICATAL(N,1)
           ILINE(2) = ICATAL(N,2)
           ILINE(3) = ICATAL(N,3)
           GO TO 220
210   CONTINUE
      CALL PRMSG ('INVALID HELP CATEGORY, THE LIST TO CHOOSE FROM IS  ',
     *    IW(49))
      GO TO 120
220   CALL HELPRT (ILINE,IW(12))
      CALL LINEF
      IF (IBMT.EQ.1) GO TO 110
      GO TO 10
300   INIT = IHOLDI
      CALL DBUGIN ('HELP EXITED',IW(11),0)
      RETURN
      END
./     ADD     NAME=HELPRT
C*********************************************************************
      SUBROUTINE HELPRT (ITYPE,ILEN)
C PURPOSE : REWIND THE HELP FILE, AND READ THE HELP ENTRIES FOR
C           REQUESTED CATAGORY
C*********************************************************************
      DIMENSION ITEXT(20),ITYPE(ILEN)
      CALL DBUGIN ('HELPRT ENTERED',IW(14),0)
      REWIND 26
      IFLAG = 0
10    IF (IFLAG.EQ.-1) GO TO 40
      READ (26,10000,END=40) ITEXT
      IF   (ITYPE(1).NE.ITEXT(1).OR.ITYPE(2).NE.ITEXT(2).OR.
     *      ITYPE(3).NE.ITEXT(3)) GO TO 20
      CALL PRMSG (ITEXT(4),IW(17*4))
      FLAG = 1
      GO TO 10
20    IF (IFLAG.EQ.1) IFLAG = -1
      GO TO 10
40    CALL DBUGIN ('HELPRT EXITED',IW(13),0)
      RETURN
10000 FORMAT (20A4)
      END
./     ADD     NAME=ICROG
C*********************************************************************
      FUNCTION ICROG (J)
C PURPOSE : DETERMINE IF THE GIVEN QUADRANT IS AT BATTLE STATIONS
C*********************************************************************
      CHARACTER *4 CZGRE , CZRED
      EQUIVALENCE (CZGRE,IZGRE) , (CZRED,IZRED)
      DATA CZGRE / 'GREE'/ ,CZRED / 'RED'/
      CALL DBUGIN ('ICROG ENTERED',IW(13),0)
      I = MOD(J,1000)
      II = IZGRE
      IF (I.GT.9) II = IZRED
      ICROG = II
      CALL DBUGCH ('ICROG VALUE ',IW(12),II,IW(4))
      CALL DBUGIN ('ICROG EXITED',IW(12),0)
      RETURN
      END
./     ADD     NAME=IDENT
C*********************************************************************
      SUBROUTINE IDENT (INPUT,IERROR,IOUT)
C PURPOSE : WITH A GIVEN CHARACTER STRING, SEE WHAT NUMBER IT IS
C (JUL-1-87 REMOVED CALLS TO DEBUG ROUTINE DUE TO VOLUME OF OUTPUT)
C*********************************************************************
      DIMENSION IKEY(10)
      COMMON /CHARS/ KZA,KZB,KZC,KZD,KZE,KZF,KZG,KZH,KZI,KZJ,KZK,KZL,KZM
     *     ,KZN,KZO,KZP,KZQ,KZR,KZS,KZT,KZU,KZV,KZW,KZX,KZY,KZZ,ICRDOT,
     *     ICRPLS,ICRCRH,ICRSTR,ICRMIN,ICRZER,KZ1,KZ2,KZ3,KZ4,KZ5,KZ6,
     *     KZ7,KZ8,KZ9,ICRBLK
      EQUIVALENCE (IKEY(1),ICRZER)
      IERROR = 0
      DO 10 N = 1,10
           IF (INPUT.EQ.IKEY(N)) GO TO 20
10    CONTINUE
      IERROR = 1
      GO TO 30
20    IOUT = N-1
30    RETURN
      END
./     ADD     NAME=IFEDST
C*********************************************************************
      FUNCTION IFEDST (DUMMY)
C PURPOSE : ASSIGN A RANDOM STRENGTH TO A GIVEN FEDERATION STARSHIP
C*********************************************************************
      CALL DBUGIN ('IFEDST ENTERED',IW(14),0)
      XXX = RAND(1.0)
      XOUT = 7500.0
      IF (XXX.GT..8) XOUT = XOUT-RAND(500.0)-2400.0
      IF (XXX.LT..18) XOUT = XOUT+RAND(500.0)+900.0
      IFEDST = IFIX(XOUT)
      CALL DBUGIN ('IFEDST EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=IFWIN
C*********************************************************************
      SUBROUTINE IFWIN (IWIN)
C PURPOSE : CHECK IF ALL STARBASES HAVE BEEN KILLED
C*********************************************************************
C     IWIN
C     ----
C     0 - NOT ALL DEAD YET
C     1 - ALL DEAD WE HAVE A WINNER (ALSO SET IDIE = 0)
C     ----------------------------------------------------------------
      COMMON /MISC/ BATTER,ISSAVE,IDUM,WFACT,IDATF,ILEV,CSDATE,TGIVEN
      COMMON /TRACOM/ TARX,TARY,ISCPX2,ISCPY2,NSECE(10,10),IHIT,ISBC,
     *    IFSC,IKCC,ITORCT,ISB,IFS,IKC,IPR,ISCPX1,ISCPY1,ICHC,IPLC,ISTC
     *     ,ET,ISECT(10,10),TVX,TVY,ICMC
      COMMON /EXTRA/ N2,ITTY,IDIE
      CALL DBUGIN ('IFWIN ENTERED',IW(13),0)
      IWIN = 0
      IF (ISB.GT.0) GO TO 100
      CALL BEEP2
      CALL PRMSG ('YOU HAVE DONE IT!, YOU HAVE SMASHED THE FEDERATION',
     *     IW(50))
      CALL PRMSG (
     *     'FORCES TO THEIR KNEES! THE RICHES OF CONQUEST ARE YOURS',
     *     IW(55))
      CALL LINEF
      IDIE = 0
      CALL PROMOT (ILEV)
      IWIN = 1
100   CALL DBUGIN ('IFWIN EXITED',IW(12),0)
      RETURN
      END
./     ADD     NAME=INITCH
C*********************************************************************
      SUBROUTINE INITCH
C PURPOSE : INIT THE ICHART
C           AND OTHER 8 X 8 ARRAYS TO PROPER STARTING VALUES
C*********************************************************************
      COMMON /PADDED/ IPAD1(9),ICHART(8,8),IPAD2(9),IPLNET(8,8),
     *    IKY(8,8), INPUT(50),IPAD3
      CALL DBUGIN ('INITCH ENTERED',IW(14),0)
      DO 20 I = 1, 8
           DO 10 J = 1, 8
                ICHART(I,J) = RAND(10.0)
                IKY(I,J) = 0
                IPLNET(I,J) = 0
10         CONTINUE
20    CONTINUE
      CALL DBUGIN ('INITCH EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=INITCT
C*********************************************************************
      SUBROUTINE INITCT (IZNOHT,IZRED,IZDOWN)
C PURPOSE : INITIALIZE COUNTERS FOR GAME
C*********************************************************************
      COMMON /PADDED/ IPAD1(9),ICHART(8,8),IPAD2(9),IPLNET(8,8),
     *     IKY(8,8), INPUT(50),IPAD3
      COMMON /INFO/ ICOND(2),ENERGY,ISHUPD,ISHENG,IAPDEV,IPOF,IOVER
      COMMON /MISC/ BATTER,ISSAVE,IDUM,WFACT,IDATF,ILEV,CSDATE,TGIVEN
      COMMON /TRACOM/ TARX,TARY,ISCPX2,ISCPY2,NSECE(10,10),IHIT,ISBC,
     *    IFSC,IKCC,ITORCT,ISB,IFS,IKC,IPR,ISCPX1,ISCPY1,ICHC,IPLC,ISTC
     *     ,ET,ISECT(10,10),TVX,TVY,ICMC
      CALL DBUGIN ('INITCT ENTERED',IW(14),0)
      IPOF = 0
      ISSAVE = 0
      IHIT = IZNOHT
      IAPDEV = 1
      ET = 0.0
      ICMC = 0
      IPLC = 0
      ISTC = 0
      ISBC = 0
      IFSC = 0
      IKCC = 0
      BATTER = 750.0
      IF (ILEV.EQ.1) GO TO 70
      IF (ILEV.EQ.2) GO TO 80
      IF (ILEV.EQ.3) GO TO 90
C     --- COMMENT LABEL 70    IS BRANCHED TO FOR "GOOD" GAME ---
70    ISB = RAND(2.0)+5.0
      IFS = RAND(3.0)+4.0
      IKC = RAND(3.0)+3.0
      GO TO 100
C     --- COMMENT LABEL 80    IS FOR "EXPERT" GAME ---
80    ISB = RAND(2.0)+10.0
      IFS = RAND(2.0)+12.0
      IKC = RAND(2.0)+6.0
      GO TO 100
C     --->COMMENT LABEL 90    IS FOR "EMERITUS" GAME ---
90    ISB = 11
      IFS = 13
      IKC = 7
C     --- PLACE STARBASES ---
100   CALL PLACE (ISB,10,9)
C     --- PLACE STARSHIPS ---
      IF (ILEV.NE.3) GO TO 110
      CALL EMPLAC (IFS)
      GO TO 120
110   CALL PLACE (IFS,100,99)
C     --- PLACE COMMANDERS ---
120   CALL PLACE (IKC,1000,9)
C     --- PLACE PLANETS ---
      IPR = RAND(12.0)+4.0
      DO 150 N = 1, IPR
130        I = RAND(8.0)+1.0
           J = RAND(8.0)+1.0
           IF (IPLNET(I,J).NE.0) GO TO 130
           IF (RAND(1.0).LT.0.40) GO TO 140
           IPLNET(I,J) = RAND(10000.0)
140        IPLNET(I,J) = ((IPLNET(I,J)*10)+1)
           IF (RAND(1.0).LT.0.52) IPLNET(I,J) = IPLNET(I,J)+100000
150   CONTINUE
C     --- PLACE SUPER-COMMANDER (US) ---
160   ISCPX1 = RAND(8.0)+1.0
      ISCPY1 = RAND(8.0)+1.0
      IF (ISCPX1.NE.1.AND.ISCPX1.NE.8.AND.ISCPY1.NE.1.AND.ISCPY1.NE.
     *     8.OR.ICROG(ICHART(ISCPX1,ISCPY1)).EQ.IZRED) GO TO 160
      ISCPX2 = RAND(10.0)+1.0
      ISCPY2 = RAND(10.0)+1.0
C     --- INIT MISC VARIABLES, TORPEDO COUNT, STARDATE, GIVEN TIME,
C                              ENERGY, SHIELD STATUS, WARP FACTOR,
C                              SHIELD ENERGY
      ITORCT = 150
      CSDATE = 3500.0 + FLOAT(IFIX(RAND(10.0))*100)
      TGIVEN = CSDATE + 7.0
      ENERGY = 6000.0
      ISHUPD = IZDOWN
      WFACT  = 10.0
      ISHENG = 12500
      CALL DBUGIN ('INITCT EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=INITDM
C*********************************************************************
      SUBROUTINE INITDM
C PURPOSE : INIT DAMAGE
C           CONTROLS TO ALL ZEROES (ALL FIXED)
C*********************************************************************
      COMMON /DEVICE/ XCDC,XSRDC,XIEDC,XLRDC,XWEDC,XDSDC,XSSDC,XPTDC
      CALL DBUGIN ('INITDM ENTERED',IW(14),0)
      XCDC  = 0.00
      XSRDC = 0.00
      XIEDC = 0.00
      XLRDC = 0.00
      XWEDC = 0.00
      XDSDC = 0.00
      XSSDC = 0.00
      XPTDC = 0.00
      CALL DBUGIN ('INITDM EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=INITGR
C*********************************************************************
      SUBROUTINE INITGR
C PURPOSE : INIT GRAFICS VARIABLES AND SETUP WORK FILE 97
C*********************************************************************
      COMMON /WORKQ/ IGCNT, INQUE(10)
      COMMON /GRAPH/ IOK
      DIMENSION I(20)
      IGCNT = 0
      REWIND 25
      REWIND 97
10    READ (25,10000,END=100) I
      WRITE (97,10000) I
      GO TO 10
100   CALL ADDQUE ('INTR')
      RETURN
10000 FORMAT (20A4)
      END
./     ADD     NAME=INITKL
C*********************************************************************
C PURPOSE : PROGRAM TO INITAILIZE FILE27 (FREEZE FILE) FOR KLINGON
C*********************************************************************
      INTEGER I(1000)
      DATA I/1000*0/
      REWIND 27
      WRITE (27) I
      ENDFILE 27
      REWIND 27
      STOP
      END
./     ADD     NAME=INSFOR
INSF     TITLE '--- INSFOR - INTEGER SIZE SET ROUTINE ---'
INSFOR   START 0
*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*
* PURPOSE : THIS ROUTINE SETS THE EDIT SIZE FOR A GIVEN INTEGER     *
*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*
        YREGS
        SAVE   (14,12),,*          SAVE REGISTERS
         LR    R12,R15
         USING INSFOR,R12
         LM    R1,R2,0(R1)         GET PARM ADDRESSES
         L     R0,0(R1)            GET INTEGER VALUE
         LTR   R0,R0               GET ABSOLUTE VALUE
         BNM   *+L'*+18
         CL    R0,=F'-1'
         BNE   *+L'*+8
         LA    R0,1
         B     *+L'*+2
         LPR   R0,R0
         LA    R1,2
         LM    R3,R5,=A(SVLCP,L'SVLCP,EVLCP)
         CL    R0,0(R3)
         BL    *+L'*+8
         LA    R1,1(R1)
         BXLE  R3,R4,*-12
         CVD   R1,WORKD
         MVC   WORKD(5),=XL5'4020212040'
         ED    WORKD(4),WORKD+L'WORKD-2
         CLI   WORKD,C' '
         BNE   *+L'*+10
         MVC   WORKD(4),WORKD+1
         B     *-14
         MVC   0(4,R2),WORKD       STORE IT BACK
         MVC   TRCE+10(4),WORKD
        WTL    MF=(E,TRCE)
        RETURN (14,12),T,RC=0      RESTORE REGISTERS AND RETURN ...
         SPACE 1
TRCE    WTL    ' ===> **** <- ',MF=L
         SPACE 1
WORKD    DC    D'0'
SVLCP    DC    A(10)
         DC    A(100)
         DC    A(1000)
         DC    A(10000)
         DC    A(100000)
         DC    A(1000000)
         DC    A(10000000)
         DC    A(100000000)
EVLCP    DC    A(1000000000)
         SPACE 1
        LTORG
         SPACE 1
         END
./     ADD     NAME=INTERC
C*********************************************************************
      SUBROUTINE INTERC (IIX,IIY,IRTN)
C PURPOSE : CHECK TO SEE IF THE PATH BETWEEN THE CURRENT SUPER
C           COMMANDER AND IIX, AND IIY (QUADRANT POSITION) IS CLEAR
C           IRTN IS "CLEA" IF CLEAR, OR THE CHARACTER REPRESENTAION
C           OF WHAT IS IN THE WAY OTHERWISE (I.E. "C", "F",ETC.)
C*********************************************************************
      INTEGER LRUDD,CSEC
      COMMON /TRACOM/ TARX,TARY,ISCPX2,ISCPY2,NSECE(10,10),IHIT,ISBC,
     *     IFSC,IKCC,ITORCT,ISB,IFS,IKC,IPR,ISCPX1,ISCPY1,ICHC,IPLC,ISTC
     *     ,ET,CSEC(10,10),TVX,TVY,ICMC
      COMMON /CHARS/ KZA,KZB,KZC,KZD,KZE,KZF,KZG,KZH,KZI,KZJ,KZK,KZL,KZM
     *     ,KZN,KZO,KZP,KZQ,KZR,KZS,KZT,KZU,KZV,KZW,KZX,KZY,KZZ,ICRDOT,
     *     ICRPLS,ICRCRH,ICRSTR,ICRMIN,ICRZER,KZ1,KZ2,KZ3,KZ4,KZ5,KZ6,
     *     KZ7,KZ8,KZ9,ICRBLK
      CHARACTER *4 CZCLER
      EQUIVALENCE (CZCLER,IZCLER)
      DATA CZCLER / 'CLEA'/
      CALL DBUGIN ('INTERC ENTERED',IW(14),0)
      DPRESX = FLOAT(IIX)
      DPRESY = FLOAT(IIY)
      TVX = DPRESX
      TVY = DPRESY
      SCX = FLOAT(ISCPX2)
      SCY = FLOAT(ISCPY2)
      CALL TARSET (DPRESX,DPRESY,SCX,SCY,ITRCON,LRUDD,SC)
      XLRUD = FLOAT(LRUDD)
10    IF (ITRCON.EQ.KZX) GO TO 20
      TVY = TVY+XLRUD
      TVX = TVX+SC
      GO TO 30
20    TVX = TVX+XLRUD
      TVY = TVY+SC
30    ITX = IFIX(TVX+0.5001)
      ITY = IFIX(TVY+0.5001)
      IF (CSEC(ITX,ITY).EQ.KZS) GO TO 40
      IF (CSEC(ITX,ITY).EQ.ICRDOT) GO TO 10
      IRTN = CSEC(ITX,ITY)
      CALL DBUGCH ('INTERC - BLOCKED BY',IW(19),IRTN,IW(4))
      GO TO 50
40    IRTN = IZCLER
      CALL DBUGCH ('INTERC - CLEAR',IW(14),IRTN,IW(4))
50    CALL DBUGIN ('INTERC EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=INTRO
C*********************************************************************
      SUBROUTINE INTRO
C PURPOSE : INTRODUCE THE GAME, ASK IF INTRUCTIONS ARE WANTED,
C           AND CONTINUE
C*********************************************************************
      COMMON /PADDED/ IPAD1(9),ICHART(8,8),IPAD2(9),IPLNET(8,8),
     *     IKY(8,8),INPUT(50),IPAD3
      COMMON /CPU/ IBMT
      COMMON /TERMSZ/ IILINE, IILLEN
      COMMON /EXTRA/ N2,ITTY,IDIE
      COMMON /CHARS/ KZA,KZB,KZC,KZD,KZE,KZF,KZG,KZH,KZI,KZJ,KZK,KZL,KZM
     *     ,KZN,KZO,KZP,KZQ,KZR,KZS,KZT,KZU,KZV,KZW,KZX,KZY,KZZ,ICRDOT,
     *     ICRPLS,ICRCRH,ICRSTR,ICRMIN,ICRZER,KZ1,KZ2,KZ3,KZ4,KZ5,KZ6,
     *     KZ7,KZ8,KZ9,ICRBLK
      CALL DBUGIN ('INTRO ENTERED',IW(13),0)
      CALL LINEF
      CALL PRMSG ('                        KLINGON  ',IW(33))
      CALL PRMSG ('               WRITTEN BY LARRY WILLIAMS ',IW(41))
      CALL LINEF
      CALL HELPRT ('LOGONMSG    ',IW(12))
10    CALL READIN ('INSTRUCTIONS - ',IW(15),15,1,EOFF)
      IF (EOFF.GT..1) GO TO 20
      CALL GAP (N2)
      IF (N2.GT.50) GO TO 20
      IF (INPUT(N2).EQ.ICRBLK) GO TO 10
      IF (INPUT(N2).EQ.KZH) GO TO 100
      IF (INPUT(N2).NE.KZY) GO TO 20
      CALL LINEF
      CALL HELPRT ('INTRO       ',IW(12))
20    IF (IBMT.EQ.1) GO TO 30
      CALL LINEF
      CALL YESNO ('ARE YOU USING A SMALL SCREEN TERMINAL ',
     *            IW(38),38,IYES)
      ITTY = 0
      IF (IYES.EQ.1) ITTY = 1
30    IF (IBMT.EQ.1.AND.IILINE.LT.43) ITTY = 1
      CALL DBUGIN ('INTRO EXITED',IW(12),0)
      RETURN
C     --- USER ENTERED "HELP" - TELL HIM WHERE HE IS ---
100   CALL HELPRT ('INTROHLP    ',IW(12))
      GO TO 10
      END
./     ADD     NAME=IN3270
C*********************************************************************
      SUBROUTINE IN3270
C PURPOSE : FOR 3270 MVS/TSO INIT THE HEADER BUFFER AND LINECOUNT
C*********************************************************************
      COMMON /FSBUFF/ NPROML, NPROMT(20), NREAD(13),
     *     NHEAD(20,12), NCOUNT, NWORK(20,200)
      COMMON /OUTUNT/ IOUTT
      COMMON /CHARS/ KZA,KZB,KZC,KZD,KZE,KZF,KZG,KZH,KZI,KZJ,KZK,KZL,KZM
     *     ,KZN,KZO,KZP,KZQ,KZR,KZS,KZT,KZU,KZV,KZW,KZX,KZY,KZZ,ICRDOT,
     *     ICRPLS,ICRCRH,ICRSTR,ICRMIN,ICRZER,KZ1,KZ2,KZ3,KZ4,KZ5,KZ6,
     *     KZ7,KZ8,KZ9,ICRBLK
      CALL DBUGIN ('IN3270 ENTERED',IW(14),0)
      IOUTT = 99
      NCOUNT = 0
      DO 10 I = 1, 12
          DO 10 J = 1, 20
              NHEAD (J,I) = ICRBLK
10    CONTINUE
      CALL DBUGIN ('IN3270 EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=ISBSET
C*********************************************************************
      FUNCTION ISBSET (DUMMY)
C PURPOSE : SET RANDOM STRENGTH OF FEDERATION STARBASE,
C           THIS WILL DETERMINE WHETHER 4, 5 OR 6 TORPEDOES
C           NEEDED TO KILL THE BASE
C*********************************************************************
      CALL DBUGIN ('ISBSET ENTERED',IW(14),0)
      XOUT = 12400.0
      XXX = RAND(1.0)
      IF (XXX.GT..8) XOUT = XOUT-2800.0
      IF (XXX.LT..2) XOUT = XOUT+2000.0
      ISBSET = IFIX(XOUT)
      CALL DBUGIN ('ISBSET EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=ISGN
C*********************************************************************
      FUNCTION ISGN (IVAL)
C PURPOSE : SET FUNCTION ACCORDING TO SIGN  1 = POSITIVE
C                                           0 = ZERO
C                                          -1 = NEGATIVE
C*********************************************************************
      IF (IVAL) 10 , 20 , 30
10    ISGN = -1
      GO TO 40
20    ISGN = 0
      GO TO 40
30    ISGN = +1
40    RETURN
      END
./     ADD     NAME=ITERPT
C*********************************************************************
      SUBROUTINE ITERPT
C PURPOSE : RETURN COUNTERS FOR NUMBER OF THINGS IN THIS QUADRANT
C*********************************************************************
      INTEGER PLCHT,CHRT
      COMMON /NUMBER/ NSTARS,NPLNTS,NSBASE,NFED,NCOMM,NFX(9),NFY(9),
     *     NCX(9),NCY(9)
      COMMON /TRACOM/ TARX,TARY,ISCPX2,ISCPY2,NSECE(10,10),IHIT,ISBC,
     *     IFSC,IKCC,ITORCT,ISB,IFS,IKC,IPR,ISCPX1,ISCPY1,ICHC,IPLC,ISTC
     *     ,ET,ISECT(10,10),TVX,TVY,ICMC
      COMMON /PADDED/ IPAD1(9),CHRT(8,8),IPAD2(9),IPLNET(8,8),IKY(8,8),
     *     INPUT(50),IPAD3
      CALL DBUGIN ('ITERPT ENTERED',IW(14),0)
      ICHART = CHRT(ISCPX1,ISCPY1)
      PLCHT = IPLNET(ISCPX1,ISCPY1)
      NPLNTS = MOD(PLCHT,10)
      NCOMM = ICHART/1000
      NFED = MOD(ICHART/100,10)
      NSBASE = MOD(ICHART/10,10)
      NSTARS = MOD(ICHART,10)
      CALL DBUGIN ('ITERPT EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=IW
C*********************************************************************
      FUNCTION IW(ILEN)
C PURPOSE : RETURN THE NUMBER OF WORDS NEEDED FOR A CERTAIN STRING
C           *IBM* DEPENDANT MODULE
C*********************************************************************
      COMMON  /CWORD/ IHOLD
      IHOLD = ILEN
      IW = (ILEN+3)/4
      RETURN
      END
./     ADD     NAME=IWI
C*********************************************************************
      FUNCTION IWI(IDUMMY)
C PURPOSE : RETURN LAST LEN VALUE PASSED TO IW...
C*********************************************************************
      COMMON  /CWORD/ IHOLD
      IWI = IHOLD
      RETURN
      END
./     ADD     NAME=JULIAN
JULR     TITLE '--- JULIAN - JULIAN/GREGORIAN DAY OF WEEK ROUTINE ---'
JULIAN   START 0
*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*
* PURPOSE : JULIAN/GREGORIAN DAY OF WEEK ROUTINE, TAKEN FROM CBT    *
*           TAPE FILE 336                                           *
*           MODIFIED TO NOT USE FILE 336 MACROS IN ASSEMBLY         *
*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*
        YREGS
        SAVE   (14,12),,*          SAVE REGISTERS
         LR    R12,R15             ESTABLISH ADDRESSABILITY
         USING JULIAN,R12          WE GOT IT
         ST    R13,SAVEAREA+4      NON-RENT, NO BIG DEAL HERE
         LA    R15,SAVEAREA        SET FORWARD/BACKWORD POINTERS
         ST    R15,8(,R13)           " " "
         LA    R13,SAVEAREA          " " "
         LM    R2,R3,0(R1)         GET THE PARMS
         SLR   R9,R9               ASSUME ONLY TWO PARMS       *MW82098
         LTR   R3,R3               SECOND PARM LAST?           *MW82098
         BM    *+L'*+8             NO:                         *MW82098
         L     R9,8(,R1)           --SAVE WEEKDAY ADDRESS      *MW82098
         MVI   0(R9),C'0'          --FLAG UNKNOWN WEEKDAY      *MW82098
         ZAP   DMONTH,=P'0'
         ZAP   DDAY,=P'0'
         ZAP   DYEAR,=P'0'
         ZAP   JDAY,=P'0'
*------- COMPUTE JULIAN DATE FROM GREGORIAN DATE
*        R1 CONTAINS THE ADDRESS OF THE IDENTIFIER LIST.
*        R2 AND R3 POINT TO THE BEGINNING OF JDATE AND GDATE,
*              RESPECTIVELY.  JDATE
*        JDATE IS 5 BYTES LONG AND GDATE IS 6 BYTES LONG.
         PACK  DMONTH,0(2,R3)
         CVB   R4,DMONTH
         SR    R5,R5
         CR    R4,R5
         BE    GREG                BRANCH TO GREG IF ZERO MONTH
         LA    R5,12
         CR    R4,R5
         BH    QUIT                BRANCH IF MONTH > 12        *MW82098
         SLL   R4,1                MULTIPLY BY 2 TO INDEX ON HALFWORDS
         PACK  DDAY,2(2,R3)
         PACK  DYEAR,4(2,R3)
         CVB   R5,DDAY
         DP    DYEAR,=PL1'4'
         L     R6,DYEAR+4
         N     R6,MASK1            ELIMINATE SIGN BITS OF REMAINDER
         BZ    *+L'*+8
         AH    R5,NORM(R4)
         B     *+L'*+4
         AH    R5,LEAP(R4)
         CVD   R5,JDAY
         UNPK  2(3,R2),JDAY        JULIAN DATE IS IN YYDDD FORMAT
         OI    4(R2),X'F0'
         MVC   0(2,R2),4(R3)
*------- COMPUTE DAY OF WEEK IF REQUESTED?                     *MW82098
GOBACK   LTR   R9,R9               FOURTH PARMS?               *MW82098
         BZ    QUIT                YES:                        *MW82098
         PACK  DYEAR,0(2,R2)       --RECREATE YEAR             *MW82098
         CVB   R4,DYEAR            --R4 = YY                   *MW82098
         LR    R5,R4               --R5 = YY                   *MW82098
         BCTR  R5,0                --R5 = YY-1                 *MW82098
         SRL   R5,2                --R5 = (YY-1)/2             *MW82098
         AR    R5,R4               --R5 = YY+(YY-1)/4          *MW82098
         PACK  JDAY,2(3,R2)        --RECREATE DAYS             *MW82098
         CVB   R4,JDAY             --R4 = DDD                  *MW82098
         AR    R5,R4               --R5 = YY+(YY-1)/4+DDD      *MW82098
         SLR   R4,R4               --PREPARE FOR DIVIDE        *MW82098
         D     R4,SEVEN            --R4 = (YY+(YY-1)/4+DDD)MOD *MW82098
         LA    R4,1(,R4)           --UP ONE FOR COBOL          *MW82098
         STC   R4,0(R9)            --SAVE FOR CALLER           *MW82098
         OI    0(R9),C'0'          --PRETTY IT UP              *MW82098
*------- RESTORE REGS AND RETURN
QUIT     L     R13,SAVEAREA+4      GET ORIGINAL REGISTER 13
        RETURN (14,12),T,RC=0      RESTORE REGISTERS AND RETURN ...
*------ COMPUTE GREGORIAN DATE FROM JULIAN DATE
GREG     PACK  JDAY,2(3,R2)
         CVB   R4,JDAY             R4 CONTAINS BINARY JULIAN DAY
         CR    R4,R5
         BE    CURDAT              GET CURRENT DATE IF BOTH DATES ZERO
         PACK  DYEAR,0(2,R2)
GREGL    LA    R5,24               R5 IS THE 'MONTH' INDEX
         L     R6,MTWO             INCREMENT BACKWARDS BY HALFWORDS
         SR    R7,R7               STOP AT ZERO
         DP    DYEAR,=PL1'4'
         L     R8,DYEAR+4
         N     R8,MASK1            ELIMINATE SIGN BITS OF REMAINDER
         BZ    LEAPL
LOOP     CH    R4,NORM(R5)
         BH    *+L'*+4             BRANCH IF JULIAN DAY (R4) HIGH
         BXH   R5,6,LOOP
         SH    R4,NORM(R5)
BOXL     SRL   R5,1                DIVIDE BY 2 TO GET MONTH
         CVD   R5,DMONTH
         CVD   R4,DDAY
         UNPK  0(2,R3),DMONTH
         OI    1(R3),X'F0'         REMOVE ZONE SIGNS
         UNPK  2(2,R3),DDAY
         OI    3(R3),X'F0'
         MVC   4(2,R3),0(R2)       YEAR
         B     GOBACK
LEAPL    CH    R4,LEAP(R5)
         BH    *+L'*+4
         BXH   R5,6,LEAPL
         SH    R4,LEAP(R5)
         B     BOXL
*------- OBTAIN CURRENT DATE
CURDAT  TIME
         SR    R6,6
         LR    R5,R1
         N     R1,MASK2            R1 = 0000DDDC
         ST    R6,JDAY
         ST    R1,JDAY+4
         SRL   R5,12
         ST    R6,DYEAR
         ST    R5,DYEAR+4
         OI    DYEAR+7,X'0F'       FIX UP SIGN                 *MW82098
         UNPK  2(3,R2),JDAY        STORE JULIAN CURRENT DATE
         OI    4(R2),X'F0'
         UNPK  0(2,R2),DYEAR
         OI    1(R2),X'F0'
         CVB   R4,JDAY
         B     GREGL               OBTAIN GREGORIAN CURRENT DATE
         EJECT
SAVEAREA DC    9D'0'
DMONTH   DC    D'0'
DDAY     DC    D'0'
DYEAR    DC    D'0'
JDAY     DC    D'0'
TWO      DC    F'2'
MTWO     DC    F'-2'
SEVEN    DC    F'7'                # DAYS IN WEEK              *MW82098
MASK1    DC    A(X'000000F0')
MASK2    DC    A(X'0000FFFF')
NORM     DC    F'0'
         DC    H'31'
         DC    H'59'
         DC    H'90'
         DC    H'120'
         DC    H'151'
         DC    H'181'
         DC    H'212'
         DC    H'243'
         DC    H'273'
         DC    H'304'
         DC    H'334'
LEAP     DC    F'0'
         DC    H'31'
         DC    H'60'
         DC    H'91'
         DC    H'121'
         DC    H'152'
         DC    H'182'
         DC    H'213'
         DC    H'244'
         DC    H'274'
         DC    H'305'
         DC    H'335'
         SPACE 1
         LTORG
         SPACE 1
         END
./     ADD     NAME=KILLER
C*********************************************************************
      SUBROUTINE KILLER
C PURPOSE : SEE IF A DISRUPTOR TORPEDO HIT SOMETHING, KILL THE
C           OBJECT AS NEEDED
C*********************************************************************
      INTEGER CSEC
      COMMON /SHIPS/ IUSFED(15,13)
      COMMON /TRACOM/ TARX,TARY,PRESX,PRESY,NSECE(10,10),IHIT,ISBC,IFSC,
     *     IKCC,ITORCT,ISB,IFS,IKC,IPR,ISCPX1,ISCPY1,ICHC,IPLC,ISTC,ET,
     *     CSEC(10,10),TVX,TVY,ICMC
      COMMON /NUMBER/ NSTARS,NPLNTS,NSBASE,NFED,NCOMM,NFX(9),NFY(9),
     *     NCX(9),NCY(9)
      COMMON /PADDED/ IPAD1(9),ICHART(8,8),IPAD2(9),IPLNET(8,8),
     *     IKY(8,8),INPUT(50),IPAD3
      COMMON /CHARS/ KZA,KZB,KZC,KZD,KZE,KZF,KZG,KZH,KZI,KZJ,KZK,KZL,
     *  KZM,KZN,KZO,KZP,KZQ,KZR,KZS,KZT,KZU,KZV,KZW,KZX,KZY,KZZ,ICRDOT,
     *  ICRPLS,ICRCRH,ICRSTR,ICRMIN,ICRZER,KZ1,KZ2,KZ3,KZ4,KZ5,KZ6,
     *  KZ7,KZ8,KZ9,ICRBLK
      COMMON /STRING/ IZSUPN, IZBLKH, IZMISS, IZNOVA, IZCDAM, IZCDES,
     * IZFDAM, IZFDES, IZBDAM, IZBDES, IZPDES,
     * IZP100, IZP200, IZP300, IZP400, IZERR
      DIMENSION ISAVX(10),ISAVY(10),IDMSG(11)
      CHARACTER *4 CZMSG(11)
      EQUIVALENCE (CZMSG,IDMSG)
      DATA CZMSG(1) /'** S'/ , CZMSG(2) /'TARS'/ , CZMSG(3) / 'HIP '/ ,
     *     CZMSG(4) /'U.S.'/ , CZMSG(5) /'S.  '/ ,
     *     CZMSG(9) /'AT S'/ , CZMSG(10) /'ECTO'/ , CZMSG(11) /'R:  '/
      DATA IDMSG(6) /0/ , IDMSG(7) /0/ , IDMSG(8) /0/
      CALL DBUGIN ('KILLER ENTERED',IW(14),0)
      ITX = IFIX(TVX+0.5001)
      ITY = IFIX(TVY+0.5001)
      IF (ITX.GT.10.OR.ITX.LT.1.OR.ITY.GT.10.OR.ITY.LT.1) GO TO 270
      IF (CSEC(ITX,ITY).EQ.ICRDOT) GO TO 300
      CALL PRTEND
      IF (CSEC(ITX,ITY).NE.ICRCRH) GO TO 10
      CALL PRMSG (
     *  '*** SENSOR CONTROL REPORTS DISRUPTOR TORPEDO SUCKED',
     *  IW(51))
      CALL PRMSM ('INTO BLACK HOLE AT: ',20,IW(20),ITY,ITX,' ',0,1)
      IHIT = IZBLKH
      GO TO 300
10    IF (CSEC(ITX,ITY).NE.ICRSTR) GO TO 100
      XXX = RAND(1.0)
      IF (XXX.LE.0.05) GO TO 20
      IF (XXX.LE.0.90) GO TO 40
      GO TO 30
20    CALL PRMSM (
     *  '*** LORD COMMANDER, THE STAR AT: ',33,IW(33),ITY,ITX,' ',0,1)
      CALL PRMSG ('WAS NOT AFFECTED BY OUR DISRUPTOR TORPEDO',IW(41))
      IHIT = IZMISS
      GO TO 300
30    CALL BEEP
      CALL ADDQUE ('REDA')
      CALL PRMSG ('RED ALERT---RED ALERT',IW(21))
      CALL PRMSM ('SUPERNOVA OF STAR AT: ',22,IW(22),ITY,ITX,' ',0,1)
      CALL PRMSG (
     *  'AUTOMATIC SUPERNOVA NAVIGATIONAL CONTROL ACTIVATING',IW(51))
      CALL PRMSG ('STARSHIP ON FULL AUTOMATIC',IW(26))
      CALL LINEF
      IHIT = IZSUPN
      GO TO 300
40    IHIT = IZNOVA
      CSEC(ITX,ITY) = ICRDOT
      ICHART(ISCPX1,ISCPY1) = ICHART(ISCPX1,ISCPY1)-1
      CALL AROUND (ITX,ITY)
      ICNTR = 1
      ISAVX(1) = ITX
      ISAVY(1) = ITY
      N3 = 1
50    ILOX = ISAVX(N3)-ISGN(ISAVX(N3)-1)
      IHIX = ISGN(10-ISAVX(N3))+ISAVX(N3)
      ILOY = ISAVY(N3)-ISGN(ISAVY(N3)-1)
      IHIY = ISGN(10-ISAVY(N3))+ISAVY(N3)
      DO 80 I = ILOY, IHIY
           DO 70 J = ILOX, IHIX
                IF (CSEC(J,I).NE.ICRSTR) GO TO 70
                ICNTR = ICNTR+1
                ISAVX(ICNTR) = J
                ISAVY(ICNTR) = I
                IF (RAND(100.0).LT.10) GO TO 60
                CSEC(J,I) = ICRDOT
                CALL AROUND (J,I)
                ICHART(ISCPX1,ISCPY1) = ICHART(ISCPX1,ISCPY1)-1
                NSECE(J,I) = 0
                GO TO 70
60              ITX = J
                ITY = I
                GO TO 30
70         CONTINUE
80    CONTINUE
      N3 = N3+1
      IF (N3.LE.ICNTR) GO TO 50
      GO TO 300
100   IF (CSEC(ITX,ITY).NE.KZC) GO TO 130
      XXX = RAND(1.0)
      CALL PRMSG (
     *  '*** LORD COMMANDER, SENSOR CONTROL REPORTS WE''VE HIT AND...',
     *  IW(59))
      IF (XXX.GT..2) GO TO 120
      CALL PRMSM (
     * 'DAMAGED OUR COMMANDER AT SECTOR: ',33,IW(33),ITY,ITX,' ',0,1)
      NSECE(ITX,ITY) = NSECE(ITX,ITY)+2500
      IHIT = IZCDAM
      IF (NSECE(ITX,ITY).LT.0) GO TO 300
      CALL PRMSG (
     *  'NEW UPDATE LORD COMMANDER, COMMANDER DESTROYED',IW(46))
110   NSECE(ITX,ITY) = 0
      CSEC(ITX,ITY) = ICRDOT
      IHIT = IZCDES
      IKCC = IKCC+1
      ICHART(ISCPX1,ISCPY1) = ICHART(ISCPX1,ISCPY1)-1000
      IKC = IKC-1
      GO TO 300
120   CALL PRMSM (
     *  'DESTROYED OUR COMMANDER AT SECTOR: ',35,IW(35),ITY,ITX,' '
     *     ,0,1)
      GO TO 110
130   IF (CSEC(ITX,ITY).NE.KZF) GO TO 150
      NSECE(ITX,ITY) = NSECE(ITX,ITY)-2500
      IF (NSECE(ITX,ITY).LE.0) GO TO 140
      IHIT = IZFDAM
      CALL PRMSM (
     *  '*** HIT ON FEDERATION STARSHIP AT: ',35,IW(35),ITY,ITX,' '
     *     ,0,1)
      GO TO 300
140   NSECE(ITX,ITY) = 0
      CSEC(ITX,ITY) = ICRDOT
      IHIT = IZFDES
      ET = ET+0.3
      IFS = IFS-1
      IFSC = IFSC+1
      ICHART(ISCPX1,ISCPY1) = ICHART(ISCPX1,ISCPY1)-100
      CALL SSDEST (IUSFED,ISCPX1,ISCPY1,ITX,ITY,IDMSG(6))
      CALL PRMSM (IDMSG,44,IW(44),ITY,ITX,'DESTROYED',9,IW(9))
      GO TO 300
150   IF (CSEC(ITX,ITY).NE.KZB) GO TO 170
      NSECE(ITX,ITY) = NSECE(ITX,ITY)-2500
      IF (NSECE(ITX,ITY).LE.0) GO TO 160
      IHIT = IZBDAM
      CALL PRMSM (
     *  '*** HIT ON FEDERATION STARBASE AT: ',35,IW(35),ITY,ITX,' '
     *     ,0,1)
      GO TO 300
160   NSECE(ITX,ITY) = 0
      CSEC(ITX,ITY) = ICRDOT
      IHIT = IZBDES
      ET = ET+.5
      ISB = ISB-1
      ISBC = ISBC+1
      ICHART(ISCPX1,ISCPY1) = ICHART(ISCPX1,ISCPY1)-10
      CALL PRMSM (
     *  '*** STARBASE AT: ',17,IW(17),ITY,ITX,'DESTROYED',9,IW(9))
      GO TO 300
170   IF (CSEC(ITX,ITY).NE.KZP) GO TO 280
      NSECE(ITX,ITY) = NSECE(ITX,ITY)+100000000
      IF (NSECE(ITX,ITY).GE.0) GO TO 180
      IF (NSECE(ITX,ITY).EQ.-100000000) GO TO 210
      IF (NSECE(ITX,ITY).EQ.-200000000) GO TO 240
      IF (NSECE(ITX,ITY).EQ.-300000000) GO TO 250
      GO TO 260
180   CALL PRMSM (
     *  '*** PLANET AT: ',15,IW(15),ITY,ITX,'DESTROYED',9,IW(9))
      CSEC(ITX,ITY) = ICRDOT
      IPR = IPR-1
      NSECE(ITX,ITY) = 0
      IHIT = IZPDES
      IPLNET(ISCPX1,ISCPY1) = IPLNET(ISCPX1,ISCPY1)/10
      IF (IPLNET(ISCPX1,ISCPY1).GT.9999) GO TO 190
      IPLC = IPLC+100
      GO TO 200
190   IPLC = IPLC+600
      ET = ET+.25
200   IPLNET(ISCPX1,ISCPY1) = 0
      GO TO 300
210   CALL PRMSM (
     *  '*** THE ATMOSPHERE OF THE PLANET AT ',36,IW(36),ITY,ITX,
     *     'HAS',3,IW(3))
      CALL PRMSG (
     *  'BEEN RIPPED AWAY, ALL LIFE FORMS ON THE PLANET HAVE',
     *     IW(51))
      CALL PRMSG ('BEEN WIPED OUT',IW(14))
      IHIT = IZP100
      IF (IPLNET(ISCPX1,ISCPY1).GT.99999) GO TO 220
      IPOP = IPLNET(ISCPX1,ISCPY1)/10
      IPLNET(ISCPX1,ISCPY1) = 1
      GO TO 230
220   IPOP = (IPLNET(ISCPX1,ISCPY1)-100000)/10
      IPLNET(ISCPX1,ISCPY1) = 100001
230   ET = ET+.000025*IPOP
      GO TO 300
240   CALL PRMSG (
     *  '*** SENSOR CONTROL REPORTS THE DEFENSE SYSTEM OF',IW(48))
      CALL PRMSM (
     *  'THE PLANET AT: ',15,IW(15),ITY,ITX,'HAS BEEN KNOCKED OUT',
     *     20,IW(20))
      IHIT = IZP200
      GO TO 300
250   CALL PRMSG (
     *  '*** SENSOR CONTROL REPORTS THE DEFENSES OF THE PLANET',
     *  IW(53))
      CALL PRMSM (
     *  'AT: ',4,IW(4),ITY,ITX,'HAVE BEEN WEAKENED',18,IW(18))
      IHIT = IZP300
      GO TO 300
260   CALL PRMSG (
     *  '*** SENSOR CONTROL REPORTS PLANETARY DEFENSES OF',IW(48))
      CALL PRMSM (
     *  'PLANET AT: ',11,IW(11),ITY,ITX,
     *  'ARE HOLDING STRONG',18,IW(18))
      IHIT = IZP400
      GO TO 300
270   CALL PRTEND
      CALL PRMSG ('TORPEDO MISSED, LORD COMMANDER',IW(30))
      IHIT = IZMISS
      RETURN
280   CALL PRMSG ('INTERNAL ERROR, ROUTINE=KILLER (ERROR 04)',IW(41))
      CALL PRMSG ('NOW CALLING FREEZE ROUTINE TO SAVE DATA',IW(39))
      CALL FREEZE
      IHIT = IZERR
300   CALL DBUGCH ('KILLER IHIT',IW(11),IHIT,IW(4))
      CALL DBUGIN ('KILLER EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=KL
C*********************************************************************
C                     P R O G R A M     K L I N G O N
C====================================================================*
C    PROGRAM KLINGON          A SPACE WAR GAME                       *
C    BY LARRY WILLIAMS                                               *
C    WITH CONSULTING AND ASSISTANCE: MARK STEVENS                    *
C    PROGRAMMER'S NOTES                                              *
C    ------------------                                              *
C    KLINGON IS A SPACE WAR GAME WRITTEN FOR CONTROL                 *
C    DATA CORPORATION MACHINES 6000 OR HIGHER WITH                   *
C    FORTRAN 5 (ANSI 1977 STANDARD)                                  *
C    VERSION 1.1 WAS UPDATED IN 1987 - MARCH TO OPERATE UNDER        *
C    MVS/TSO ON 3270 24 OR 43 LINE TERMINALS IN FULLSCREEN MODE      *
C    AND VIA FORTRAN I/O (UNITS 5/6) FOR NON 3270                    *
C    COPYRIGHT NOTICE                                                *
C    ----------------                                                *
C    PERMISSION IS HEREBY GRANTED FOR THE COPYING, DISTRIBUTION,     *
C    MODIFICATION AND USE OF THIS PROGRAM AND ASSOCIATED             *
C    DOCUMENTATION FOR RECREATIONAL PURPOSES, PROVIDED THAT ALL      *
C    REFERENCES TO THE AUTHOR ARE RETAINED. HOWEVER, PERMISSION      *
C    IS NOT AND WILL NOT BE GRANTED FOR THE SALE OR PROMOTIONAL      *
C    USE OF THIS PROGRAM OR PROGRAM DOCUMENTATION, OR FOR USE IN     *
C    IN ANY SITUATION IN WHICH PROFIT MAY BE CONSIDERED AN           *
C    OBJECTIVE, SINCE IT IS THE DESIRE OF THE AUTHOR TO RESPECT      *
C    THE COPYRIGHTS OF THE ORIGINATORS OF STAR TREK.                 *
C    THIS PROGRAM WAS FINISHED IN JANUARY, 1983.                     *
C====================================================================*
      COMMON /CHARS/ KZA,KZB,KZC,KZD,KZE,KZF,KZG,KZH,KZI,KZJ,KZK,KZL,KZM
     *     ,KZN,KZO,KZP,KZQ,KZR,KZS,KZT,KZU,KZV,KZW,KZX,KZY,KZZ,ICRDOT,
     *     ICRPLS,ICRCRH,ICRSTR,ICRMIN,ICRZER,KZ1,KZ2,KZ3,KZ4,KZ5,KZ6,
     *     KZ7,KZ8,KZ9,ICRBLK
      COMMON /SHIPS/ IUSFED(15,13)
      COMMON /TRACOM/ TARX,TARY,ISCPX2,ISCPY2,NSECE(10,10),IHIT,ISBC,
     *    IFSC,IKCC,ITORCT,ISB,IFS,IKC,IPR,ISCPX1,ISCPY1,ICHC,IPLC,ISTC
     *     ,ET,ISECT(10,10),TVX,TVY,ICMC
      COMMON /PADDED/ IPAD1(9),ICHART(8,8),IPAD2(9),IPLNET(8,8),
     *    IKY(8,8), INPUT(50),IPAD3
      COMMON /DEVICE/ XCDC,XSRDC,XIEDC,XLRDC,XWEDC,XDSDC,XSSDC,XPTDC
      COMMON /NUMBER/ NSTARS,NPLNTS,NSBASE,NFED,NCOMM,NFX(9),NFY(9),NCX(
     *     9),NCY(9)
      COMMON /INFO/ ICOND(2),ENERGY,ISHUPD,ISHENG,IAPDEV,IPOF,IOVER
      COMMON /HURT/ NOCALL,IPLENG,IPBASE,IFED2,ICOMM2
      COMMON /MISC/ BATTER,ISSAVE,IDUM,WFACT,IDATF,ILEV,CSDATE,TGIVEN
      COMMON /CPU/ IBMT
      COMMON /TERMSZ/ IILINE, IILLEN
      COMMON /INITVR/ IBMTSO, IGRAFC
      COMMON /PHASE/ INIT
      COMMON /OUTUNT/ IOUTT
      COMMON /DBUGUN/ IUDBUG
      COMMON /DEBUG/ IDEBUG
      COMMON /EXTRA/ N2,ITTY,IDIE
      COMMON /SRCOPY/ ISCOP(10,10)
      COMMON /GRAPH/ IOK
      COMMON /TRACKR/ ITRKC, RTRK(15,2)
      DIMENSION IVALS(4),
     * MSG3(9),MSG4(9),MSG5A(6),MSG5B(8),IDMSG2(15),IDMSG3(15)
      DIMENSION NUMS(10), ICHAR(26)
      EQUIVALENCE  (NUMS(1),ICRZER)
      EQUIVALENCE  (ICHAR(1),KZA)
      CHARACTER *4 CZMSG3(9) , CZMSG4(9) , CZMSG5A(6) , CZMSG5B(8) ,
     *             CZDMSG2(15) , CZDMSG3(15)
      EQUIVALENCE (CZMSG3,MSG3) , (CZMSG4,MSG4) , (CZMSG5A,MSG5A) ,
     *       (CZMSG5B,MSG5B) , (CZDMSG2,IDMSG2) , (CZDMSG3,IDMSG3)
      DATA LNAVXX / 0 /
      DATA CZMSG3(1)/'THE '/,CZMSG3(2)/'PATH'/,CZMSG3(3)/' TO '/,
     *     CZMSG3(4)/'THE '/,CZMSG3(5)/'TARG'/,CZMSG3(6)/'ET I'/,
     *     CZMSG3(7)/'S:'/
      DATA MSG3(8) /0/ , MSG3(9) /0/
      DATA CZMSG4(1)/'WOUL'/,CZMSG4(2)/'D CA'/,CZMSG4(3)/'USE '/,
     *     CZMSG4(4)/'YOUR'/,CZMSG4(5)/' ENE'/,CZMSG4(6)/'RGY '/,
     *     CZMSG4(7)/'TO  '/
      DATA MSG4(8) /0/ , MSG4(9) /0/
      DATA CZMSG5A(1)/'SHIE'/,CZMSG5A(2)/'LDS '/,CZMSG5A(3)/'CURR'/,
     *     CZMSG5A(4)/'ENTL'/,CZMSG5A(5)/'Y'/
      DATA MSG5A(6) /0/
      DATA CZMSG5B(1)/'DO Y'/,CZMSG5B(2)/'OU W'/,CZMSG5B(3)/'ISH '/,
     *     CZMSG5B(4)/'TO '/,CZMSG5B(7)/'SHIE'/,CZMSG5B(8)/'LDS '/
      DATA MSG5B(5) /0/ , MSG5B(6) /0/
      DATA CZDMSG2(1)/'HAS '/,CZDMSG2(2)/'BEEN'/,CZDMSG2(3)/' IDE'/,
     *     CZDMSG2(4)/'NTIF'/,CZDMSG2(5)/'IED '/,CZDMSG2(6)/'AS T'/,
     *     CZDMSG2(7)/'HE F'/,CZDMSG2(8)/'EDER'/,CZDMSG2(9)/'ATIO'/,
     *     CZDMSG2(10)/'N '/,CZDMSG2(14)/'U.S.'/,CZDMSG2(15)/'S.'/
      DATA IDMSG2(11) /0/ , IDMSG2(12) /0/ , IDMSG2(13) /0/
      DATA IDMSG3(1) /0/ , IDMSG3(2) /0/ , IDMSG3(3) /0/
      DATA CZDMSG3(4) /',CAP'/ , CZDMSG3(5) /'TAIN'/ ,
     *     CZDMSG3(6) /' '/ , CZDMSG3(7) /' '/ , CZDMSG3(8) /' '/ ,
     *     CZDMSG3(9) /' '/ , CZDMSG3(10) /' '/ , CZDMSG3(11) /' '/ ,
     *     CZDMSG3(12) /' '/ , CZDMSG3(13) /' '/ , CZDMSG3(14) /' '/ ,
     *     CZDMSG3(15) /' '/
      CHARACTER *4 CZRED , CZGRE , CZCLER , CZDAMG , CZDOWN , CZUP ,
     *             CZYELL , CZNOHT , CZYEL2 , CZLOW , CZRAIS , CZSUPN ,
     *             CZBLOC , CZBLC2 , CZINCR , CZDECR , CZEASE
      EQUIVALENCE (CZRED,IZRED) , (CZGRE,IZGRE) , (CZCLER,IZCLER) ,
     *            (CZDAMG,IZDAMG) , (CZDOWN,IZDOWN) , (CZUP,IZUP) ,
     *        (CZYELL,IZYELL) , (CZNOHT,IZNOHT) , (CZYEL2,IZYEL2) ,
     *          (CZLOW,IZLOW) , (CZRAIS,IZRAIS) , (CZSUPN,IZSUPN) ,
     *        (CZBLOC,IZBLOC) , (CZBLC2,IZBLC2) , (CZINCR,IZINCR) ,
     *            (CZDECR,IZDECR) , (CZEASE,IZEASE)
      DATA CZRED  / 'RED'/
      DATA CZGRE  / 'GREE'/
      DATA CZCLER / 'CLEA'/
      DATA CZDAMG / 'DAMG'/
      DATA CZDOWN / 'DOWN'/ ,CZUP / 'UP'/
      DATA CZYELL / 'YELL'/ ,CZNOHT / 'NOHT'/
      DATA CZYEL2 / 'OW'/
      DATA CZLOW / 'LOWE'/
      DATA CZRAIS / 'RAIS'/
      DATA CZSUPN / 'SNOV'/
      DATA CZBLOC / 'BLOC'/
      DATA CZBLC2 / 'KED'/
      DATA CZINCR / 'INCR'/ ,CZDECR / 'DECR'/
      DATA CZEASE / 'EASE'/
C     === CYBER*CYBER*CYBER === === === === === === === ===> *BEGIN*
C     --- SET IBMT = ZERO IF MACHINE IS A CYBER
C                    (OR TSO SEQUENTIAL LINE MODE),
C                    ONE FOR IBM TSO-3270 (24-43 LINES ONLY)
      CALL GAINIT
      IF (IILINE.EQ.-1) GO TO 9999
      IBMT = IBMTSO
      IOK  = IGRAFC
C     === CYBER*CYBER*CYBER === === === === === === === ===> *EXIT*
      ITRKC = 0
      NQFLAG = 0
      IOUTT = 6
      IUDBUG = 10
      INIT = 1
C     --- AT THIS POINT IF THIS IS IBM TSO, CALL THE IN3270 ROUTINE
      IF (IBMT.NE.1) GO TO 10
      CALL STAX(0)
      CALL INITGR
      CALL IN3270
C     --- CHECK TO SEE IF THE PLAYER IS IN THE ALLOWED SHIFT
C         FOR PLAYING
      CALL SHIFTC (I)
      IF (I.NE.1) GO TO 2680
C     --- CALL INIT ROUTINES
C         AT THIS POINT CALL THE INTRO ROUTINE TO
C         SEE IF INSTRUCTIONS ARE NEEDED
10    CALL INTRO
C     --- THEN CHECK IF OLD OR NEW GAME REQUESTED
20    CALL OLDNEW (I)
C         -1 = OLD GAME REQUESTED, ERROR IN GET (STOP)
C          1 = OLD GAME, GET OK    (TO PROMPT FOR COMMAND)
C          0 = NEW GAME REQUESTED  (CONTINUE INIT ROUTINES)
      IF (I.EQ.-1) GO TO 2680
      IF (I.EQ.1)  GO TO 100
      CALL MAININ (IZNOHT,IZRED,IZDOWN)
C     --- INIT COMPLETE... THIS LABEL BELOW IS THE TOP OF THE
C         COMMAND DRIVER LOOP
100   CALL LINEF
      INIT = 0
C     --- CHECK TO SEE IF ENERGY HAS RUN OUT, IF IT HAS, CHECK TO
C         SEE IF COMPUTER AVAIL AND BATTERIES CHARGED, IF SO GIVE
C         HIM A LITTLE JOLT
C               I
C             ------
C              -1  = OUT OF ENERGY
C               0  = O.K.
      CALL ENGYST (I,IZRED)
      IF (I.LT.0) GO TO 2560
C     --- SEE IF THE PLAYER WON THE GAME, IF NO BASES LEFT,
C         PLAYER HAS WON
      CALL IFWIN (I)
      IF (I.EQ.1) GO TO 2570
C     --- SET THE CURRENT STATUS OF THE USER (RED, GREEN OR YELLOW)
C         SET CURRENT SHIELD STATUS IF SHIELD WERE DAMAGED
      ICOND(2) = ICRBLK
      ICOND(1) = ICROG(ICHART(ISCPX1,ISCPY1))
      IF (ICOND(1).EQ.IZGRE) ICOND(2) = KZN
      IF (ENERGY.GT.1000.0.OR.ICOND(1).NE.IZGRE) GO TO 200
      ICOND(1) = IZYELL
      ICOND(2) = IZYEL2
200   IF (XDSDC.GT.0.001) ISHUPD = IZDAMG
      IHIT = IZNOHT
C     --- NOW CHECK IF THE USER HAS RUN OUT OF TIME
C         NOTE THE DIVIDE BY 2.1 FACTOR, I DECIDED THE GAME WAS
C         TOO EASY WITH ORIGINAL ET (EXTRA TIME) VALUES, SO SHAVED
C         IT IN ABOUT HALF
C         IF USER RUNS OUT OF TIME, GO TO SAME ROUTINE THAT HANDLES
C         SELF-DESTRUCT (CALL TIMMSG TO SAY WHAT HAPPENED)
      TGIVEN = TGIVEN+(ET/2.1)
      ET = 0.0
      NOCNG = 0
      REMAIN = TGIVEN-CSDATE
      IF (REMAIN.GT.0.0) GO TO 210
      CALL TIMMSG
      GO TO 380
C     --- EVERYTHING IS READY TO PROMPT FOR NEXT COMMAND
210   CALL READIN ('COMMAND - ',IW(10),10,1,EOFF)
      IF (EOFF.GT.0.9) GO TO 220
      CALL GAP (N2)
      IF (N2.LE.50) GO TO 230
220   CALL LINEF
      CALL PRMSG ('DID YOU SAY SOMETHING, LORD COMMANDER ?',IW(39))
      CALL LINEF
      GO TO 210
C     --- FIND FIRST LETTER OF COMMAND, BRANCH TO :
C         1)--- PROPER ROUTINE TO EXECUTE COMMAND IF IT CAN BE
C               DETERMINED FROM FIRST LETTER.
C               I IS SET TO AVOID ARRAY REFERENCE.
C         2)--- ROUTINE TO FIND REMAINING LETTERS AS NEEDED.
230   I = INPUT(N2)
      DO 240 J=1,26
          N = J
          IF (I.EQ.ICHAR(N)) GO TO 250
240   CONTINUE
      GO TO 1720
C     ===>    A    B    C    D    E    F    G    H    I    J    K
250   GO TO (270, 260, 310, 320, 1630,300, 1720,2660,1470,1720,1720,
C     ===>    L    M    N    O    P    Q    R    S    T    U    V
     *       1610,1740,1720,2510,790, 1720,490, 410, 390, 1720,1720,
C     ===>    W    X    Y    Z
     *       2420,2700,1720,1720),N
C     --- --- --- --- --- --- --- --- --- --- *** "B" COMMANDS
C         CALL BATTERY ROUTINE
260   CALL BATTCK
      GO TO 100
C     --- --- --- --- --- --- --- --- --- --- *** "A" COMMANDS
C         "ABANDON"
C         "ANTI PHOTON"
270   CALL BRIDGE (N2)
      IF (N2.GT.50) GO TO 280
      IF (INPUT(N2).NE.KZP) GO TO 1720
C     --- CALL ROUTINE TO HANDLE ANTI-PHOTON
      CALL APDEV
      GO TO 100
C     --- CALL ROUTINE TO SAY "YOU CAN'T ABANDON"
280   CALL ABANMS
      GO TO 100
C     --- --- --- --- --- --- --- --- --- --- *** "F" COMMANDS
C         "FREEZE"
300   IF (INPUT(N2+1).NE.KZR.OR.INPUT(N2+2).NE.KZE.OR.INPUT(N2+3).NE.KZE
     *     .OR.INPUT(N2+4).NE.KZZ.OR.INPUT(N2+5).NE.KZE) GO TO 1720
      CALL FREEZE
      CALL LINEF
      CALL PRMSG ('KLINGON STOPPED BY FREEZE',IW(25))
      GO TO 2680
C     --- --- --- --- --- --- --- --- --- --- *** "C" COMMANDS
C         "CHART"
C         "COMPUTE"
310   N2 = N2+1
C     --- FOLLOWING IF IS FOR CHART
      IF (INPUT(N2).NE.ICRBLK.AND.INPUT(N2).NE.KZH) GO TO 311
      CALL PRCHRT
      GO TO 100
C     --- FOLLOWING IF IS FOR COMPUTE
311   IF (INPUT(N2).EQ.KZO) GO TO 1810
      GO TO 1720
C     --- --- --- --- --- --- --- --- --- --- *** "D" COMMANDS
C         "DESTRUCT"
C         "DEATHRAY"
C         "DAMAGE"
C         "DISRUPTOR"
C         "DOCK"
320   N2 = N2+1
      IF (INPUT(N2).EQ.KZA) GO TO 330
      IF (INPUT(N2).EQ.KZE) GO TO 370
      IF (INPUT(N2).EQ.KZI) GO TO 800
      IF (INPUT(N2).EQ.KZO.OR.INPUT(N2).EQ.ICRBLK) GO TO 331
      GO TO 1720
C     --- CALL ROUTINE TO SAY DOCK NOT AVAIL
331   CALL DOCK
      GO TO 100
C     --- CALL THE DAMAGE ROUTINE
330   CALL DAMAGR
      GO TO 100
C     --- LOOK FURTHER AT "DE" STRING
370   N2 = N2+1
      IF (INPUT(N2).EQ.KZA) GO TO 381
      IF (INPUT(N2).NE.KZS.OR.INPUT(N2+1).NE.KZT.OR.INPUT(N2+2).NE.
     *    KZR.OR.INPUT(N2+3).NE.KZU.OR.INPUT(N2+4).NE.KZC.OR.INPUT(N2+5)
     *    .NE.KZT) GO TO 1720
C     --- THIS PORTION CHECKS IF THE PLAYER REALLY WANTS TO KILL SELF
      CALL PRMSG ('SELF-DESTRUCT SEQUENCE BEGIN:',IW(29))
      CALL LINEF
      CALL YESNO ('DID YOU SAY # DESTRUCT # LORD COMMANDER ',
     *         IW(40),40,IYES)
      IF (IYES.NE.1) GO TO 100
C    --- CONTINUE BELOW MUST BE KEPT FOR "RUN OUT OF OF TIME" ROUTINE
C        ABOVE
380   CALL DESMSG
      GO TO 2560
C     --- CALL ROUTINE TO SAY DEATHRAY (SSTREK COMMAND) NOT AVAIL
381   CALL DEATHR
      GO TO 100
C     --- --- --- --- --- --- --- --- --- --- *** "T" COMMANDS
C         "TRACTOR"
C         "TERMINATE"
C         "TRANSPORTER"
C     --- LOOK FOR T-R-A
390   IF (INPUT(N2+1).NE.KZR.OR.INPUT(N2+2).NE.KZA) GO TO 400
C     --- FALL THRU TO HERE MEANS IT DOES START WITH T-R-A
      IF (INPUT(N2+3).EQ.KZN) GO TO 399
C     --- FALL THRU TO HERE, MEANS MAY BE TRACTOR COMMAND
      IF (INPUT(N2+3).EQ.KZC) GO TO 1500
      GO TO 1720
C     --- CALL ROUTINE TO SAY WE DON'T HAVE SHUTTLE OR TRANSPORTER
399   CALL TSMSG
      GO TO 100
C     --- AT THIS POINT THE COMMAND MIGHT BE "TERMINATE"
400   IF (INPUT(N2+1).EQ.KZE.AND.INPUT(N2+2).EQ.KZR.AND.INPUT(N2+3).EQ.
     *     KZM.AND.INPUT(N2+4).EQ.KZI.AND.INPUT(N2+5).EQ.KZN.AND.
     *     INPUT(N2+6).EQ.KZA.AND.INPUT(N2+7).EQ.KZT.AND.INPUT(N2+8).EQ.
     *     KZE.AND.INPUT(N2+9).EQ.ICRBLK) GO TO 2640
      GO TO 1720
C     --- --- --- --- --- --- --- --- --- --- *** "S" COMMANDS
410   N2 = N2+1
      IF (INPUT(N2).EQ.KZR.OR.INPUT(N2).EQ.ICRBLK) GO TO 430
      IF (INPUT(N2).EQ.KZE) GO TO 420
      IF (INPUT(N2).EQ.KZT.AND.INPUT(N2+1).EQ.KZA) GO TO 431
      IF (INPUT(N2).EQ.KZH.AND.INPUT(N2+1).EQ.KZU) GO TO 419
      IF (INPUT(N2).EQ.KZH.AND.(INPUT(N2+1).EQ.KZE.OR.INPUT(N2+1).EQ.KZI
     *     .OR.(INPUT(N2+1).EQ.ICRBLK))) GO TO 580
      IF (INPUT(N2).EQ.KZT.AND.INPUT(N2+1).EQ.KZO.AND.INPUT(N2+2).EQ.KZP
     *     ) GO TO 2680
      GO TO 1720
C     --- CALL ROUTINE TO SAY WE DON'T HAVE SHUTTLE OR TRANSPORTER
419   CALL TSMSG
      GO TO 100
C     --- CALL ROUTINE TO DISPLAY INFO ON SENSOR SCAN
420   CALL SENDEC (IPLNET(ISCPX1,ISCPY1))
      GO TO 100
C     --- CALL ROUTINE TO DISPLAY SRSCAN
430   IF (IBMT.EQ.1) GO TO 432
      CALL SRS
      GO TO 100
432   CALL PRMSG ('YOUR FIRST OFFICER GREETS YOU WITH A PUZZLED ',
     *                                                         IW(44))
      CALL PRMSG ('LOOK AND SAYS: "ALL SHORT RANGE DATA IS ON THE ',
     *                                                         IW(46))
      CALL PRMSG ('FORWARD TACTICAL SCREEN, LORD COMMANDER"  ',IW(41))
      GO TO 100
C     --- CALL ROUTINE FOR STATUS ONLY
431   IF (IBMT.EQ.1) GO TO 433
      CALL SRSCAN(1,0,ISECT)
      GO TO 100
433   CALL PRMSG ('YOUR FIRST OFFICER GREETS YOU WITH A PUZZLED ',
     *                                                         IW(44))
      CALL PRMSG ('LOOK AND SAYS: "ALL STATUS INFORMATION IS ON THE  ',
     *                                                         IW(48))
      CALL PRMSG ('FORWARD TACTICAL SCREEN, LORD COMMANDER"  ',IW(42))
      GO TO 100
C     --- --- --- --- --- --- --- --- --- --- *** "R" COMMANDS
490   IF (INPUT(N2+1).NE.KZE) GO TO 1720
      IF (INPUT(N2+2).EQ.KZS) GO TO 510
      GO TO 1720
500   CALL READIN ('HOW LONG ',IW(9),9,1,EOFF)
      IF (EOFF.GT..1) GO TO 500
      CALL GAP (N2)
      GO TO 520
510   CALL BRIDGE (N2)
520   IF (N2.GT.50) GO TO 500
      CALL NUMREC (INPUT,N2,IERR,REST)
      IF (IERR.NE.0.OR.REST.LT.0.0) GO TO 1720
      IF (ABS(REST).LT..0001) GO TO 540
      IF (REST.LT.REMAIN) GO TO 530
      CALL PRMSG ('LORD COMMANDER, WE DON''T HAVE THAT MUCH TIME LEFT',
     *     IW(49))
      CALL YESNO ('DO YOU STILL WANT TO REST ',IW(26),26,IYES)
      IF (IYES.NE.1) GO TO 540
      CALL TIMMSG
      GO TO 380
530   CALL LINEF
      IF (ICROG(ICHART(ISCPX1,ISCPY1)).EQ.IZGRE) GO TO 570
      CALL LINEF
      CALL PRMSG ('LORD COMMANDER, WE ARE CURRENTLY IN BATTLE,',IW(43))
      CALL YESNO ('ARE YOU SURE YOU WANT TO REST?',IW(30),30,IYES)
      IF (IYES.EQ.1) GO TO 550
540   CALL PRMSG ('NO REST TAKEN',IW(13))
      GO TO 100
550   K = REST*20.0
      DO 560 J = 1, K
           CALL BATTLE
560   CONTINUE
570   CALL REPAIR (REST)
      CSDATE = CSDATE+REST
      ENERGY = ENERGY+(REST*1024.0)
      T = TGIVEN-CSDATE
      CALL PRMRM ('STARDATES REMAINING ',20,IW(20),T,' ',0,1)
      GO TO 100
580   CALL LINEF
      CALL BRIDGE (N2)
      IF (N2.GT.50) GO TO 610
      IF (INPUT(N2).NE.KZT) GO TO 660
      CALL BRIDGE (N2)
      IF (N2.GT.50) GO TO 620
590   CALL NUMREC (INPUT,N2,IERR,RTN)
      IF (IERR.NE.0) GO TO 1720
      IF (ABS(RTN).LT..5) GO TO 100
      J = ISHENG+ IFIX(RTN)
      IF (ENERGY-RTN.LT.0.0) GO TO 650
      IF (ABS(RTN).LT.0.001) GO TO 100
      IF (J.LT.0.OR.J.GT.12500) GO TO 630
      IF (RTN.LT.0.0) GO TO 591
      ENERGY = ENERGY-RTN
      GO TO 592
591   ENERGY = ENERGY-(FLOAT(IFIX(RTN)))
592   ISHENG = J
600   CALL PRMRM ('MAIN ENERGY BANKS NOW AT: ',26,IW(26),ENERGY,
     *             ' ',0,1)
      CALL PRMIM ('SHIELDS NOW AT: ',16,IW(16),ISHENG,'UNITS',5,IW(5))
      GO TO 780
610   CALL LINEF
      CALL YESNO('DO YOU WISH TO CHANGE SHIELD ENERGY ',IW(36),36,IYES)
      IF (IYES.EQ.1) GO TO 620
      IF (IYES.EQ.0) GO TO 750
620   CALL READIN ('ENERGY TO TRANSFER TO SHIELDS (NEGATIVE TO DRAIN) ',
     *     IW(50),50,1,EOFF)
      IF (EOFF.GT..1) GO TO 100
      CALL GAP (N2)
      GO TO 590
630   CALL LINEF
      IF (J.GT.12500) GO TO 640
      CALL PRMSG ('ALL SHIELD ENERGY TRANSFERED TO MAIN ENERGY BANKS',
     *           IW(49))
      CALL LINEF
      ENERGY = ENERGY+FLOAT(ISHENG)
      ISHENG = 0
      GO TO 600
640   CALL PRMSG (
     *     'SHIELD ENERGY MAXIMIZED, EXCESS RETURNED TO MAIN ENERGY',
     *     IW(55))
      CALL LINEF
      ENERGY = ENERGY-FLOAT(12500-ISHENG)
      ISHENG = 12500
      GO TO 600
650   CALL PRMSG (
     *     'LORD COMMANDER, ENGINEERING REPORTS THE ENERGY LEVEL YOU',
     *     IW(56))
      CALL PRMSG('HAVE REQUESTED WOULD DROP OUR MAIN POWER BANKS TO 0.'
     *     ,IW(52))
      GO TO 100
660   IF (INPUT(N2).NE.KZU.AND.INPUT(N2).NE.KZD) GO TO 1720
      IF (ISHUPD.NE.IZDAMG) GO TO 680
670   CALL PRMSG ('SHIELDS ARE DAMAGED AND DOWN.',IW(29))
      GO TO 100
680   IF (INPUT(N2).EQ.KZU.AND.ISHUPD.EQ.IZUP) GO TO 690
      GO TO 700
690   CALL PRMSG ('SHIELDS ALREADY UP.',IW(19))
      GO TO 100
700   IF (INPUT(N2).EQ.KZD.AND.ISHUPD.EQ.IZDOWN) GO TO 710
      GO TO 720
710   CALL PRMSG ('SHIELDS ALREADY DOWN.',IW(21))
      GO TO 100
720   IF (INPUT(N2).EQ.KZD) GO TO 740
      IF (ENERGY.GT.50.0) GO TO 730
      CALL PRMSG ('INSUFFICENT ENERGY TO RAISE SHIELDS.',IW(36))
      GO TO 100
730   ENERGY = ENERGY-50.0
      IOVER = 1
      ISHUPD = IZUP
      CALL PRMSG ('AUTOMATIC CONTROL OVERRIDDEN.',IW(29))
      CALL PRMSG ('SHIELDS RAISED',IW(14))
      GO TO 780
740   IOVER = 1
      ISHUPD = IZDOWN
      CALL PRMSG ('AUTOMATIC CONTROL OVERRIDDEN.',IW(28))
      CALL PRMSG ('SHIELDS DROPPED',IW(15))
      GO TO 780
750   IF (ISHUPD.EQ.IZDAMG) GO TO 670
      J = ISHUPD
      K = IZRAIS
      K2 = KZE
      IF (J.EQ.IZUP) K = IZLOW
      IF (J.EQ.IZUP) K2 = KZR
      MSG5A(6) = J
      MSG5B(5) = K
      MSG5B(6) = K2
      CALL PRMSG (MSG5A,IW(24))
760   CALL READIN (MSG5B,IW(37),37,1,EOFF)
      IF (EOFF.GT..1) GO TO 760
      CALL GAP (N2)
      IF (INPUT(N2).EQ.KZN) GO TO 100
      IF (INPUT(N2).EQ.KZY) GO TO 770
      CALL PRMSG ('YES OR NO PLEASE',IW(16))
      GO TO 760
770   N2 = 1
      INPUT(1) = KZU
      IF (J.EQ.IZUP) INPUT(1) = KZD
      GO TO 720
780   CALL BATTLE
      GO TO 100
790   IF (INPUT(N2+1).EQ.ICRBLK) GO TO 800
      IF (INPUT(N2+1).EQ.KZL) GO TO 799
      IF (INPUT(N2+1).NE.KZH) GO TO 1720
      IF (INPUT(N2+2).EQ.KZO.OR.INPUT(N2+2).EQ.ICRBLK) GO TO 800
      IF (INPUT(N2+2).NE.KZA) GO TO 1720
C     --- CALL ROUTINE TO SAY WE DON'T HAVE PHASERS
      CALL PHASER
      GO TO 100
C     --- CALL ROUTINE TO SAY PLANET RECORD NOT KEPT (WE JUST
C         BLOW THEM UP)
799   CALL PLANET
      GO TO 100
800   CALL PHOTON (IRETRN,ITQX,ITSX,ITQY,ITSY,N2)
C     --- 100-PROMPT, 1720-N2.GT.50, 2560-DIE, 1950-MOVE.
      IF (IRETRN.EQ.0) GO TO 100
      IF (IRETRN.EQ.1) GO TO 1720
      IF (IRETRN.EQ.2) GO TO 2560
      IF (IRETRN.EQ.3) GO TO 1950
      GO TO 100
1470  IF (XIEDC.GT.0.001) GO TO 1490
      IF (ENERGY.GT.50.0) GO TO 1480
      CALL LINEF
      CALL PRMSG ('INSUFFIENT ENERGY TO ACTIVATE IMPULSE ENGINES',
     * IW(45))
      GO TO 100
1480  IMPULS = 1
      GO TO 1800
1490  CALL LINEF
      CALL PRMSG ('IMPULSE ENGINES DAMAGED',IW(23))
      GO TO 100
1500  CALL LINEF
      GO TO 1520
1510  CALL READIN ('TARGET QUADRANT ',IW(16),16,1,EOFF)
      IF (EOFF.GT..1) GO TO 1510
      CALL GAP (N2)
      IF (N2.GT.50) GO TO 100
      GO TO 1530
1520  CALL BRIDGE (N2)
      IF (N2.GT.50) GO TO 1510
1530  CALL IDENT (INPUT(N2),IERR,ITRACY)
      IF (IERR.NE.0) GO TO 1720
      CALL BRIDGE (N2)
      IF (N2.GT.50) GO TO 1720
      CALL IDENT (INPUT(N2),IERR,ITRACX)
      IF (IERR.NE.0) GO TO 1720
      IF (ITRACX.GT.8.OR.ITRACY.GT.8) GO TO 1720
      IF (ITRACX.LT.1.OR.ITRACY.LT.1) GO TO 100
      IF (ITRACX.EQ.ISCPX1.AND.ITRACY.EQ.ISCPY1) GO TO 100
      TRENG = DIST(ITRACX,5,ITRACY,5,ISCPX1,ISCPX2,ISCPY1,ISCPY2)*650.0
      IF (TRENG.GE.ENERGY) GO TO 1590
      CALL PRMRM ('THAT WOULD REQUIRE ',19,IW(19),TRENG,
     *    'UNITS OF ENERGY,',16,IW(16))
      CALL YESNO ('DO YOU STILL WISH TO ENGAGE THE TRACTOR BEAM ',
     *     IW(45),45,IYES)
      IF (IYES.NE.1) GO TO 100
      CALL LINEF
      CALL PRMSG ('AS YOU SO ORDER, LORD COMMANDER...',IW(34))
      CALL LINEF
      CALL PRMSG ('TRACTOR BEAM ON FULL POWER, LORD COMMANDER',IW(42))
      CALL LINEF
      ENERGY = ENERGY-TRENG
      IF (ICHART(ITRACX,ITRACY).LT.100.OR.ICHART(ITRACX,ITRACY).
     *      EQ.9999) GO TO 1600
      ICCNT = ICHART(ITRACX,ITRACY)/1000
      IFCNT = MOD(ICHART(ITRACX,ITRACY)/100,10)
      CP = (RAND(1.0)+.1)*ICCNT
      FP = (RAND(1.0)+.1)*IFCNT
1540  IX = RAND(10.0)+1.0
      IY = RAND(10.0)+1.0
      IF (ISECT(IX,IY).NE.ICRDOT) GO TO 1540
      IF (CP.LT.FP) GO TO 1550
      FLAG = 1000
      GO TO 1560
1550  FLAG = 100
1560  ICHART(ISCPX1,ISCPY1) = ICHART(ISCPX1,ISCPY1)+FLAG
      ICHART(ITRACX,ITRACY) = ICHART(ITRACX,ITRACY)-FLAG
      CALL LINEF
      CALL PRMSG('WE''VE LOCKED ONTO SOMETHING, LORD COMMANDER',IW(43))
      CALL LINEF
      IF (FLAG.GT.999.9) GO TO 1570
      CALL PRMSG (
     *  '*** FEDERATION STARSHIP CAUGHT IN LONG RANGE TRACTOR BEAM',
     *     IW(57))
      CALL PRMSG ('ALL HANDS... BATTLE STATIONS!',IW(29))
      CALL ADDQUE ('REDA')
      ISECT(IX,IY) = KZF
      NSECE(IX,IY) = IFEDST(DUMMY)
      CALL LINEF
      CALL SSMOVI (IUSFED,ISCPX1,ISCPY1,IX,IY,ITRACX,ITRACY,IDMSG3(1),
     *     IDMSG3(6),IDMSG2(12))
      CALL PRMSG ('...LORD COMMANDER, THE SHIP WE TRACTORED IN',IW(43))
      CALL PRMSG (IDMSG2,IW(60))
      CALL PRMSG (IDMSG3,IW(60))
      CALL PRMSG ('LAST KNOWN TO BE IN COMMAND.',IW(28))
      CALL LINEF
      GO TO 1580
1570  CALL PRMSG ('*** COMMANDER CAUGHT IN LONG RANGE TRACTOR BEAM',
     *   IW(47))
      ISECT(IX,IY) = KZC
      NSECE(IX,IY) = -4500
1580  CALL LINEF
      CALL PRMSG ('TRACTORS "OFF", LORD COMMANDER',IW(30))
      CALL BATTLE
      GO TO 100
1590  CALL PRMSG ('WE DON''T HAVE THE ENERGY TO PULL A SHIP THAT FAR,',
     *     IW(48))
      CALL PRMSG ('LORD COMMANDER',IW(14))
      GO TO 100
1600  ENERGY = ENERGY+(TRENG*.5)
      CALL PRMSG ('OUR TRACTOR BEAM WAS UNABLE TO LOCK ONTO ANYTHING,',
     *    IW(50))
      CALL PRMSG ('LORD COMMANDER',IW(14))
      GO TO 1580
1610  IF (IBMT.EQ.1) GO TO 1620
      CALL LRSCAN
      GO TO 100
1620  CALL PRMSG ('YOUR FIRST OFFICER GREETS YOU WITH A PUZZLED   ',
     *                                                         IW(44))
      CALL PRMSG ('LOOK AND SAYS: "ALL LONG RANGE DATA IS ON THE  ',
     *                                                         IW(45))
      CALL PRMSG ('FORWARD TACTICAL SCREEN, LORD COMMANDER"  ',IW(42))
      GO TO 100
1630  IF (INPUT(N2+1).NE.KZX) GO TO 1720
      CALL LINEF
      IF (IGRAFC.EQ.0) GO TO 1640
      IF (IOK.EQ.1) GO TO 1640
      IOK = 1
      CALL PRMSG ('EXTERNAL VISUAL DISPLAYS WILL BE DISPLAYED',IW(42))
      GO TO 1650
1640  IOK = 0
      CALL PRMSG ('EXTERNAL VISUAL DISPLAYS NOW "OFF"        ',IW(42))
1650  CALL PRMSG ('LORD COMMANDER',IW(14))
      GO TO 100
1720  CALL PRMSG (
     *  'BEGGING YOUR LEAVE, LORD COMMANDER, BUT I DO NOT UNDERSTAND'
     *     ,IW(59))
      CALL PRMSG ('THE COMMAND:',IW(12))
      CALL PRMSG1 (INPUT,50)
      GO TO 100
1730  CALL PRMSG (
     *  'THE SUPERCOMMANDER KAZH CANNOT USE DILITHIUM CRYSTALS',IW(53))
      GO TO 100
1740  IF (INPUT(N2+1).NE.KZI) GO TO 1800
      GO TO 1730
1750  CALL LINEF
      CALL READIN ('MANUAL OR AUTOMATIC ',IW(20),20,1,EOFF)
      IF (EOFF.GT..1) GO TO 1780
      CALL GAP (N2)
      IF (N2.GT.50) GO TO 1780
      GO TO 1830
1760  CALL LINEF
      CALL READIN ('ENTER QUADRANT AND/OR SECTOR ',IW(29),29,1,EOFF)
      IF (EOFF.GT..1) GO TO 1780
      NCO = 0
      CALL GAP (N2)
      IF (N2.GT.50) GO TO 1780
      GO TO 1840
1770  CALL LINEF
      CALL READIN ('ENTER X AND Y DISPLACEMENTS: ',IW(29),29,1,EOFF)
      IF (EOFF.GT..1) GO TO 1780
      CALL GAP (N2)
      IF (N2.GT.50) GO TO 1780
      GO TO 1900
1780  CALL LINEF
      CALL PRMSG ('MOVE OR COMPUTE COMMAND ABORTED.',IW(31))
      GO TO 100
1790  CALL LINEF
      CALL PRMSG ('COMPUTER DAMAGED, MANUAL MOVE ONLY.',IW(35))
      GO TO 100
1800  LNAVXX = 0
      GO TO 1820
1810  LNAVXX = 1
      IF (XCDC.GT..001) GO TO 1819
      GO TO 1820
C     --- THIS IS THE COMPTER DAMAGED ROUTINE, COMES HERE IF
C         FUNCTION UNDER COMPUTER CONTROL AND IT'S BROKEN
1819  CALL LINEF
      CALL PRMSG ('COMPUTER DAMAGED',IW(16))
      GO TO 100
1820  ITQY = ISCPY1
      ITQX = ISCPX1
      CALL BRIDGE (N2)
      IF (N2.GT.50) GO TO 1750
1830  IF (INPUT(N2).EQ.KZM) GO TO 1890
      IF (INPUT(N2).NE.KZA) GO TO 1720
      IF (XCDC.GT.0.001) GO TO 1790
      CALL BRIDGE (N2)
      IF (N2.GT.50) GO TO 1760
      NCO = 0
1840  IF (N2.GT.50) GO TO 1870
      CALL IDENT (INPUT(N2),IERR,IOUT)
      IF (IERR.NE.0) GO TO 1720
      IF (IOUT.NE.1) GO TO 1850
      IF (INPUT(N2+1).EQ.ICRBLK) GO TO 1850
      IF (INPUT(N2+1).NE.ICRZER) GO TO 1720
      IVALUE = 10
      GO TO 1860
1850  IVALUE = IOUT
1860  NCO = NCO+1
      IVALS(NCO) = IVALUE
      CALL BRIDGE (N2)
      GO TO 1840
1870  IF (NCO.NE.2.AND.NCO.NE.4) GO TO 1720
      IF (NCO.EQ.2) GO TO 1880
      ITQY = IVALS(1)
      ITQX = IVALS(2)
      ITSY = IVALS(3)
      ITSX = IVALS(4)
      GO TO 1930
1880  ITSY = IVALS(1)
      ITSX = IVALS(2)
      GO TO 1930
1890  CALL BRIDGE (N2)
      IF (N2.GT.50) GO TO 1770
1900  CALL NUMREC (INPUT,N2,IERR,RTN)
      IF (IERR.NE.0) GO TO 1720
      XVAL = RTN
      CALL BRIDGE (N2)
      IF (N2.GT.50) GO TO 1910
      CALL NUMREC (INPUT,N2,IERR,RTN)
      IF (IERR.NE.0) GO TO 1720
      YVAL = RTN
      GO TO 1920
1910  YVAL = 0.0
1920  YVAL = -YVAL
      IDISPX = IFIX(XVAL*100.0)
      IDISPY = IFIX(YVAL*100.0)
      IDISPX = (IDISPX+ISGN(IDISPX))/10
      IDISPY = (IDISPY+ISGN(IDISPY))/10
      ISCX = (ISCPX1*10+ISCPX2-1)+IDISPX
      ISCY = (ISCPY1*10+ISCPY2-1)+IDISPY
      ITQX = ISCX/10
      ITSX = MOD(ISCX,10)+1
      ITQY = ISCY/10
      ITSY = MOD(ISCY,10)+1
1930  IF (ITQX.EQ.ISCPX1.AND.ITQY.EQ.ISCPY1.AND.ITSX.EQ.ISCPX2.AND.
     *     ITSY.EQ.ISCPY2) GO TO 1780
      IF (ITQY.GT.8.OR.ITQY.LT.1.OR.ITQX.GT.8.OR.ITQX.LT.1.OR.ITSY.GT.
     *     10.OR.ITSY.LT.1.OR.ITSX.LT.1.OR.ITSX.GT.10) GO TO 1940
      GO TO 1950
1940  CALL PRMSG ('LORD COMMANDER, I DO NOT THINK IT WISE TO LEAVE',
     *   IW(47))
      CALL PRMSG ('FEDERATION SPACE UNTIL OUR MISSION IS COMPLETE.',
     *   IW(47))
      GO TO 100
1950  IF (IMPULS.EQ.1.OR.XWEDC.LE.0.001.OR.LNAVXX.EQ.1) GO TO 1970
      IF (XWEDC.LE.5.0.AND.WFACT.LE.5.0) GO TO 1970
      IF (XWEDC.GT.5.0) GO TO 1960
      CALL LINEF
      CALL PRMSG ('LORD COMMANDER, WE MUST REDUCE SPEED TO WARP 5.',
     *  IW(47))
      GO TO 100
1960  CALL LINEF
      CALL PRMSG ('WARP ENGINES NON-OPERATIONAL',IW(28))
      GO TO 100
1970  WFDDST = DIST(ITQX,ITSX,ITQY,ITSY,ISCPX1,ISCPX2,ISCPY1,ISCPY2)
      IF (LNAVXX.NE.1) CALL M2FAST (WFACT,WFDDST,WFDAMG)
      IF (ITQY.EQ.ISCPY1.AND.ITQX.EQ.ISCPX1) GO TO 2050
      IF (ICHART(ITQX,ITQY).NE.9999.OR.XCDC.GT.0.001.OR.LNAVXX.EQ.1)
     *      GO TO 1980
      CALL BEEP2
      CALL PRMSG ('EMERGENCY NAVIGATIONAL OVERRIDE BY COMPUTER',
     *   IW(43))
      CALL PRMSG (
     *  'TARGET QUADRANT CONTAINS SUPERNOVA, ENGINES SHUT DOWN',IW(53))
      IF (IHIT.NE.IZSUPN) GO TO 100
      CALL PRMSG ('YOUR SHIP LANDED IN A QUADRANT WITH A SUPERNOVA',
     *                                                         IW(47))
      CALL PRMSG ('YOU AND YOUR  SHIP ARE BURNED TO A CRISP',IW(40))
      GO TO 2560
1980  IF (LNAVXX.EQ.1) GO TO 2040
      IF (IHIT.EQ.IZSUPN) GO TO 2010
      IPOF = 1
      CALL BATTLE
      IPOF = 0
      CALL LOCATE (KZF,J,J)
      IF (NFED.EQ.0) GO TO 2000
      DO 1990 J = 1, NFED
           CALL SSMOVO(IUSFED,ISCPX1,ISCPY1,NFX(J),NFY(J),ISCPX1,ISCPY1
     *          ,I)
1990  CONTINUE
2000  IF (IMPULS.EQ.1) GO TO 2030
2010  IF (ISHUPD.NE.IZUP) GO TO 2020
      CALL BEEP2
      CALL PRMSG ('AUTOMATIC NAVIGATION CONTROL LOCKED IN',IW(38))
      CALL PRMSG ('SHIELDS DROPPED.',IW(16))
      CALL LINEF
      ISHUPD = IZDOWN
2020  CALL LINEF
      CALL PRMSM ('COURSE PLOTTED FOR QUADRANT ',28,IW(28),
     *            ITQY,ITQX,',',1,1)
      CALL PRMSM (
     *  'SECTOR ',7,IW(7),ITSY,ITSX,'AND LOCKED IN',13,IW(13))
      CALL LINEF
      CALL PRMRM ('COURSE LAID IN, WARP FACTOR ',28,IW(28),
     *            WFACT,' ',0,1)
      CALL ADDQUE ('MOVE')
      NQFLAG = 1
      GO TO 2040
2030  CALL PRMSM ('COURSE PLOTTED FOR ',19,IW(19),ITQY,ITQX,' ',0,1)
      CALL PRMSM (' ',0,1,ITSY,ITSX,'AND LOCKED IN',13,IW(13))
      CALL LINEF
      CALL PRMSG ('COURSE LAID IN, MAXIMUM IMPULSE FACTOR',IW(38))
2040  CALL LONINT (ITQX,ITQY,ITSX,ITSY,IRTN,IIX,IIY)
      LNAVC1 = IRTN
      IF (IRTN.EQ.IZCLER.OR.LNAVXX.EQ.1) GO TO 2330
      GO TO 2170
2050  IF (LNAVXX.EQ.1) GO TO 2100
      IF (IMPULS.EQ.1.OR.ISHUPD.NE.IZUP) GO TO 2090
      IF (ICROG(ICHART(ISCPX1,ISCPY1)).EQ.IZGRE) GO TO 2060
      F = ENGUSE(DIST(5,ITSX,5,ITSY,5,ISCPX2,5,ISCPY2),WFACT)
      IF (F.LE.50.0) GO TO 2080
2060  CALL BEEP2
      CALL PRMSG ('SHIELDS DROPPED FOR IN-QUADRANT MOVE',IW(36))
      CALL LINEF
      ISHUPD = IZDOWN
      CALL PRMSM ('MOVING TO SECTOR ',17,IW(17),ITSY,ITSX,
     *     'LORD COMMANDER',14,IW(14))
      IF (ICROG(ICHART(ISCPX1,ISCPY1)).EQ.IZGRE) GO TO 2100
      IF (ENERGY.GT.800.0.AND.ISHENG.GT.1250) GO TO 2070
      CALL PRMRM ('CURRENT ENERGY = ',17,IW(17),ENERGY,' ',0,1)
      CALL PRMIM ('CURRENT SHIELD ENERGY = ',24,IW(24),ISHENG,' ',0,1)
      CALL YESNO ('DO YOU WISH TO RAISE SHIELDS',IW(28),28,IYES)
      IF (IYES.EQ.0) GO TO 2100
      IF (IYES.EQ.1) GO TO 2070
2070  CALL LINEF
      CALL PRMSG ('SHIELDS RE-RAISED',IW(17))
      ISHUPD = IZUP
      CALL LINEF
      ENERGY = ENERGY-50.0
      GO TO 2100
2080  ENERGY = ENERGY-F
      IF (ISHUPD.EQ.IZUP) ENERGY = ENERGY-F
2090  CALL PRMSM ('MOVING TO SECTOR: ',18,IW(18),ITSY,ITSX,
     *     'LORD COMMANDER',14,IW(14))
2100  IIX = ITSX
      IIY = ITSY
      DPRESX = ISCPX2
      DPRESY = ISCPY2
      TVX = DPRESX
      TVY = DPRESY
      STX = FLOAT(IIX)
      STY = FLOAT(IIY)
      CALL TARSET (DPRESX,DPRESY,STX,STY,ITRCON,LRUDD,SC)
      XLRUD = FLOAT(LRUDD)
2110  IF (ITRCON.EQ.KZX) GO TO 2120
      TVY = TVY+XLRUD
      TVX = TVX+SC
      GO TO 2130
2120  TVX = TVX+XLRUD
      TVY = TVY+SC
2130  ITX = IFIX(TVX+0.5001)
      ITY = IFIX(TVY+0.5001)
      IF (ISECT(ITX,ITY).NE.ICRDOT) GO TO 2140
      IF (ITX.EQ.IIX.AND.ITY.EQ.IIY) GO TO 2150
      GO TO 2110
2140  IIX = ITX
      IIY = ITY
      IRTN = ISECT(ITX,ITY)
      GO TO 2160
2150  IRTN = IZCLER
2160  LNAVC1 = IRTN
      IF (LNAVXX.EQ.1) GO TO 2330
      NOCNG = 1
      ISECT(ISCPX2,ISCPY2) = ICRDOT
      ISECT(ITSX,ITSY) = KZS
      LNAVC1 = IRTN
      IF (IRTN.EQ.IZCLER) GO TO 2330
2170  CALL BEEP
      CALL ADDQUE('REDA')
      IF (IRTN.NE.ICRSTR) GO TO 2180
      CALL PRMSM ('KAZH CAUSES HYPERSPACE RUPTURE OF STAR AT: ',
     *    43,IW(43),IIY,IIX,' ',0,1)
      CALL LINEF
      CALL PRMSM ('*** STAR AT: ',13,IW(13),IIY,IIX,' NOVAS',6,IW(6))
      CALL LINEF
      CALL PRMSG ('YOU HAVE BEEN BURNED TO A FINE INTERSTELLAR DUST',
     *    IW(48))
      CALL PRMSG ('BY A NOVA.  NO DEFLECTOR SHIELD KNOWN WOULD HAVE',
     *    IW(48))
      CALL PRMSG ('MADE ANY DIFFERENCE',IW(19))
      GO TO 2560
2180  IF (IRTN.NE.ICRCRH) GO TO 2250
      CALL ADDQUE('REDA')
      CALL PRMSG ('EMERGENCY -- DOUBLE RED ALERT',IW(29))
      CALL PRMSM ('KAZH BEING PULLED INTO BLACK HOLE AT: ',38,IW(38),
     *     IIY,IIX,' ',0,1)
      IF (XWEDC.GT.0.001.OR.ENERGY.LT.3000.0) GO TO 2230
      CALL PRMSG (
     *  'ALL ENGINES AT FULL EMERGENCY REVERSE, LORD COMMANDER',IW(53))
      CALL PRMSG (
     *  'ALL POWER CHANNELED TO WARP AND IMPULSE ENGINES',IW(47))
      IBLOWT = IFIX(RAND(5000.0)+7400.5)
      CALL PRMSG (
     *  'MATTER ANTI MATTER CONVERTERS OVERHEATING, LORD COMMANDER',
     *  IW(57))
      CALL LINEF
      IBLOWL = IFIX(8900.0+RAND(1050.0))
      DO 2190 I = 7400, IBLOWT, 200
           IF (IBMT.EQ.1) GO TO 2191
           CALL PRMIM ('TEMPERATURE NOW, ',17,IW(17),I,
     *                                         'AND RISING',10,IW(10))
2191       IF (I.GT.IBLOWL) GO TO 2320
2190  CONTINUE
      ENERGY = ENERGY-(RAND(500.0)+2500.0)
      XWEDC = RAND(2.0)+1.0
      XIEDC = RAND(5.0)+1.0+XIEDC
      CALL LINEF
      CALL PRMSG ('WE''RE BREAKING FREE, LORD COMMANDER!  ',IW(36))
      CALL LINEF
      CALL PRMSG ('YOUR BLACK HOLE VEERING HAS SENT YOU WHIPPING',
     *             IW(45))
      CALL PRMSG ('AROUND THE BLACK HOLE AT GREATER THAN WARP 15',
     *             IW(45))
      CALL PRMSG ('YOU HAVE BEEN THROWN CLEAR',IW(26))
      CALL LINEF
      CALL PRMSG ('*** KAZH ENTERS TIME-SPACE DISTORTION GAP',IW(41))
      CALL LINEF
      CALL PRMSG ('TIME HAS STOPPED MOMENTARILY, YOU ARE TRAVELING',
     *             IW(47))
      XR = RAND(3.0)+15.0
      CALL PRMRM ('AT WARP FACTOR, ',16,IW(16),XR,
     *     'PROPELLED BY THE BLACK HOLE',27,IW(27))
      XX = RAND(1.0)
      IF (XX.LT..7) GO TO 2200
      CALL LINEF
      CALL PRMSG ('*** KAZH SLAMS INTO THE GALACTIC ENERGY BARRIER',
     *  IW(47))
      CALL PRMRM ('AT WARP: ',9,IW(9),XR,'AND BREAKS UP.',14,IW(14))
      CALL LINEF
      GO TO 2560
2200  CALL LOCATE (KZF,J,J)
      IF (NFED.EQ.0) GO TO 2220
      DO 2210 J = 1, NFED
           CALL SSMOVO (IUSFED,ISCPX1,ISCPY1,NFX(J),NFY(J),ISCPX1,ISCPY1
     *          ,I)
2210  CONTINUE
2220  ISCPX1 = RAND(8.0)+1.0
      ISCPY1 = RAND(8.0)+1.0
      ISCPY2 = RAND(10.0)+1.0
      ISCPX2 = RAND(10.0)+1.0
      CALL PRMSM ('YOUR SHIP HAS COME TO REST IN QUADRANT: ',
     *     40,IW(40),ISCPY1,ISCPX1,' ',0,1)
      CALL PRMSM ('SECTOR: ',8,IW(8),ISCPY2,ISCPX2,' ',0,1)
      CALL LINEF
      CALL PRMSG ('*** WARP AND IMPULSE ENGINES DAMAGED',IW(36))
      CALL LINEF
      CALL ITERPT
      CALL SECSET
      GO TO 100
2230  CALL PRMSM ('*** KAZH PULLED INTO BLACK HOLE AT: ',36,IW(36),
     *    IIY,IIX,' ',0,1)
      IF (XWEDC.GT.0.001) GO TO 2240
      CALL PRMSG ('YOU DID NOT HAVE THE AVAILABLE ENGERY NEEDED.',
     *    IW(45))
      GO TO 2560
2240  CALL PRMSG ('(WARP ENGINES NOT USABLE)',IW(25))
      GO TO 2560
2250  IF (IRTN.NE.KZC) GO TO 2260
      CALL PRMSM ('*** KAZH RAMS COMMANDER AT: ',28,IW(28),
     *            IIY,IIX,' ',0,1)
      CALL PRMSM ('*** KAZH AND COMMANDER AT: ',
     *     27,IW(27),IIY,IIX,'DESTROYED',9,IW(9))
      IKCC = IKCC+1
      GO TO 2560
2260  IF (IRTN.NE.KZB) GO TO 2280
      CALL PRMSM ('*** KAZH RAMS STARBASE AT: ',27,IW(27),
     *          IIY,IIX,' ',0,1)
      CALL LINEF
      IF (ITORCT.GT.0) GO TO 2270
      CALL PRMSG ('SINCE YOU HAD NO DISRUPTOR TORPEDOS LEFT,',IW(41))
      CALL PRMSG ('THAT WAS THE BEST THING YOU COULD HAVE DONE',IW(43))
      CALL LINEF
2270  CALL PRMSG ('*** KAZH AND STARBASE DESTROYED',IW(31))
      ISB = ISB-1
      ISBC = ISBC+1
      GO TO 2560
2280  IF (IRTN.NE.KZF) GO TO 2290
      CALL PRMSM ('*** KAZH RAMS FEDERATION STARSHIP AT: ',
     *           38,IW(38),IIY,IIX,' ',0,1)
      CALL PRMSM ('*** KAZH AND STARSHIP AT ',
     *            25,IW(25),IIY,IIX,'DESTROYED',9,IW(9))
      IFSC = IFSC+1
      IFS = IFS-1
      GO TO 2560
2290  IF (IRTN.EQ.KZP) GO TO 2291
      CALL PRMSG ('PLEASE REPORT ERROR ROUTINE=KL (ERROR 01)',IW(40))
      CALL PRMSG ('NOW CALLING FREEZE TO SAVE DATA',IW(30))
      CALL FREEZE
2291  CALL LINEF
      CALL PRMSM ('*** KAZH HITS PLANET AT ',24,IW(24),IIY,IIX,' ',0,1)
      CALL LINEF
      CALL PRMSG ('THE BLAST FROM THE ANTI-MATTER IN YOUR ENGINES',
     *           IW(46))
      CALL PRMSG ('DESTROYS THE PLANET... AND YOU AS WELL. ',IW(39))
      CALL LINEF
      IPR = IPR-1
      J = IPLNET(ISCPX1,ISCPY1)/10
      IF (J.GT.9999) GO TO 2300
      IPLC = IPLC+100+(J/100.0+.5)
      ET = ET+.000025*J
      GO TO 2310
2300  IPLC = IPLC+600+((J-10000)/100.0+.5)
      ET = ET+.25+.000025*((J-10000)/100.0+.5)
2310  IPLNET(ISCPX1,ISCPY1) = 0
      GO TO 2560
2320  CALL LINEF
      CALL PRMSG ('THE INTERNAL SHIELDS ON YOUR ENGINES BREAK DOWN DUE',
     *     IW(51))
      CALL PRMSG (
     *'TO THE HEAT, AND YOUR WARP AND IMPULSE ENGINES DETONATE',IW(55))
      GO TO 2560
2330  DISTT = DIST(ITQX,ITSX,ITQY,ITSY,ISCPX1,ISCPX2,ISCPY1,ISCPY2)
      IF (LNAVXX.EQ.1) GO TO 2340
      CALL PRMRM ('DISTANCE TRAVELED: ',19,IW(19),DISTT,' ',0,1)
      IF (NQFLAG.EQ.0) GO TO 2340
      NQFLAG = 0
      CALL ADDQUE ('NEWQ')
2340  DTNAV = DISTT
      IF (IMPULS.EQ.1) GO TO 2350
      E = ENGUSE(DISTT,WFACT)-(TIMUSE(DISTT,WFACT)*1024.0)
      T = TIMUSE(DISTT,WFACT)
      GO TO 2360
2350  E = (DISTT*100+50)-(1.052632*DISTT*1024.0)
      T = 1.052632*DISTT
      IMPULS = 0
2360  IF (LNAVXX.EQ.0) GO TO 2380
      LNAVXX = 0
      MSG3(8) = IZBLOC
      MSG3(9) = IZBLC2
      IF (LNAVC1.NE.IZCLER) GO TO 2365
      MSG3(8) = IZCLER
      MSG3(9) = KZR
2365  IMPULS = 0
      MSG4(8) = IZINCR
      MSG4(9) = IZEASE
      IF (E.GT.0.0) MSG4(8) = IZDECR
      CALL LINEF
      CALL PRMSM ('TO MOVE TO QUADRANT ',20,IW(20),ITQY,ITQX,' ',0,1)
      CALL PRMSM ('TARGET SECTOR ',14,IW(14),ITSY,ITSX,' ',0,1)
      CALL PRMRM ('AT WARP FACTOR ',15,IW(15),WFACT,' ',0,1)
      CALL PRMRM ('(DISTANCE - ',12,IW(12),DTNAV,')',1,1)
      CALL PRMRM (MSG4,36,IW(36),ABS(E),'UNITS',5,IW(5))
      CALL PRMRM ('AND USE UP ',11,IW(11),T,'STARDATES.',10,IW(10))
      IF (XSSDC.GT..001) GO TO 100
      CALL LINEF
      CALL PRMSG (MSG3,IW(36))
      GO TO 100
2380  ENERGY = ENERGY-E
      CSDATE = CSDATE+T
      ISCPX1 = ITQX
      ISCPY1 = ITQY
      ISCPX2 = ITSX
      ISCPY2 = ITSY
      ISSAVE = 0
      CALL REPAIR (T)
      IF (WFACT.LT.10.0001) GO TO 2390
      IF (RAND(100.0).GE.WFDAMG) GO TO 2390
      XWEDC = XWEDC+(WFDDST*(WFACT-10.0))+RAND(.113)
      CALL LINEF
      CALL PRMSG ('WARP ENGINES HAVE BEEN DAMAGED, LORD COMMANDER',
     *   IW(46))
2390  IF (NOCNG.NE.1) GO TO 2400
      CALL BATTLE
      IF (ICHART(ISCPX1,ISCPY1).NE.9999) GO TO 100
      CALL LINEF
      CALL PRMSM ('KAZH HITS SUPERNOVA IN QUADRANT ',32,IW(32),
     *            ISCPY1,ISCPX1,' ',0,1)
      CALL LINEF
      CALL PRMSG ('YOU ARE INSTANTLY BURNED TO INTERSTELLAR ASH BY',
     *             IW(47))
      CALL PRMSG ('A SUPERNOVA, THAT WAS VERY SLOPPY NAVIGATING',
     *             IW(44))
      GO TO 2560
2400  CALL ITERPT
      CALL SECSET
      GO TO 100
2420  IF (XWEDC.GT.5.0) GO TO 2490
      CALL BRIDGE (N2)
      IF (N2.GT.50) GO TO 2430
      CALL NUMREC (INPUT,N2,IERR,RTN)
      IF (IERR.NE.0) GO TO 1720
      WVAL = RTN
      GO TO 2440
2430  CALL PRMSG ('ENTER -1 TO ABORT THIS COMMAND.',IW(31))
      CALL READIN ('ENTER NEW WARP FACTOR - ',IW(24),24,1,EOFF)
      IF (EOFF.GT..1) GO TO 2450
      CALL GAP (N2)
      CALL NUMREC (INPUT,N2,IERR,RTN)
      IF (IERR.NE.0) GO TO 2450
      WVAL = RTN
2440  IF (WVAL.LT.0.0001) GO TO 2450
      IF (WVAL.LT.1.0.OR.WVAL.GT.12.0) GO TO 2460
      IF (WVAL.GT.5.0.AND.XWEDC.GT.0.001) GO TO 2480
      IF (WVAL.GT.10.0) GO TO 2470
      CALL PRMRM ('WARP FACTOR NOW ',16,IW(16),WVAL,
     *     'AS PER YOUR ORDER LORD COMMANDER',32,IW(32))
      WFACT = WVAL
      GO TO 100
2450  CALL PRMSG ('WARP FACTOR CHANGE ABORTED.',IW(27))
      GO TO 100
2460  CONTINUE
      CALL PRMRM ('WARP FACTOR OF ',15,IW(15),WVAL,'NOT ALLOWED',
     *     11,IW(11))
      GO TO 100
2470  CALL PRMSG ('ALTHOUGH THERE IS A VERY GOOD CHANCE',IW(36))
      CALL PRMSG ('OF WARP DRIVE FAILURE AT THIS SPEED',IW(35))
      CALL PRMSG ('YOUR ORDER WILL BE IMPLEMENTED IMMEDIATELY',IW(42))
      CALL PRMRM ('LORD COMMANDER, WARP FACTOR NOW AT ',
     *            35,IW(35),WVAL,' ',0,1)
      WFACT = WVAL
      GO TO 100
2480  CALL PRMSG ('WARP ENGINES PARTIALY DAMAGED',IW(29))
      CALL PRMSG ('WARP 5 IS THE MAXIMUM',IW(21))
      GO TO 2430
2490  CALL PRMSG ('WARP ENGINES NOT USEABLE',IW(24))
      GO TO 100
C     --- CALL ROUTINE FOR DEBUG MODE ACTIVATION
2700  IF (INPUT(N2+1).NE.KZD.OR.INPUT(N2+2).NE.KZE.OR.INPUT(N2+3).NE.KZB
     *     .OR.INPUT(N2+4).NE.KZU.OR.INPUT(N2+5).NE.KZG) GO TO 2705
      CALL XDEBUG
      GO TO 100
2705  IF (INPUT(N2+1).NE.KZS.OR.INPUT(N2+2).NE.KZN.OR.INPUT(N2+3).NE.KZA
     *     .OR.INPUT(N2+4).NE.KZP.OR.IDEBUG.NE.1)    GO TO 1720
      CALL DEBUGX
      CALL PRMSG ('XSNAP COMPLETE',IW(14))
      GO TO 100
C     --- CALL ROUTINE TO SAY ORBIT NOT DONE
2510  CALL ORBIT
      GO TO 100
C     --- CALL ROUTINE TO GET HELP FOR USER
2660  CALL HELP
      GO TO 100
C     --- SET IDIE = 1 IF USER DIED, 0 IF HE WON
2560  CALL LINEF
      IDIE = 1
2570  CALL SCORE (REMAIN)
2640  INIT = 1
      CALL PLAGAN (I)
      IF (I.NE.1) GO TO 2645
      I = 1
      IF (IBMT.EQ.1) CALL SHIFTC (I)
      IF (I.NE.1) GO TO 2680
      GO TO 20
2645  CALL LINEF
      CALL PRMSG ('MAY THE GLORY OF ALL KLINGON GO WITH YOU',IW(40))
2680  CALL LINEF
      INIT = 1
      CALL LINEF
      IF (IBMT.NE.1) GO TO 2690
      CALL READIN('HIT ENTER TO TERMINATE PROGRAM',IW(30),30,1,EOFF)
2690  CALL STAX(1)
9999  STOP
      END
./     ADD     NAME=LINEF
C*********************************************************************
      SUBROUTINE LINEF
C PURPOSE : DISPLAY A BLANK LINE
C*********************************************************************
      CALL PRMSG (' ',IW(1))
      RETURN
      END
./     ADD     NAME=LOCATE
C*********************************************************************
      SUBROUTINE LOCATE (ITYPE,IX,IY)
C PURPOSE : LOCATE THE FEDERATION STARSHIPS AND COMMANDERS IN QUADRANT
C*********************************************************************
      COMMON /TRACOM/ TARX,TARY,ISCPX2,ISCPY2,NSECE(10,10),IHIT,ISBC,
     *     IFSC,IKCC,ITORCT,ISB,IFS,IKC,IPR,ISCPX1,ISCPY1,ICHC,IPLC,
     *     ISTC,ET,ISECT(10,10),TVX,TVY,ICMC
      COMMON /PADDED/ IPAD1(9),ICHART(8,8),IPAD2(9),IPLNET(8,8),
     *     IKY(8,8),INPUT(50),IPAD3
      COMMON /NUMBER/ NSTARS,NPLNTS,NSBASE,NFED,NCOMM,NFX(9),NFY(9),
     * NCX(9),NCY(9)
      COMMON /CHARS/ KZA,KZB,KZC,KZD,KZE,KZF,KZG,KZH,KZI,KZJ,KZK,KZL,KZM
     *     ,KZN,KZO,KZP,KZQ,KZR,KZS,KZT,KZU,KZV,KZW,KZX,KZY,KZZ,ICRDOT,
     *     ICRPLS,ICRCRH,ICRSTR,ICRMIN,ICRZER,KZ1,KZ2,KZ3,KZ4,KZ5,KZ6,
     *     KZ7,KZ8,KZ9,ICRBLK
      CALL DBUGIN ('LOCATE ENTERED',IW(14),0)
      IF (ITYPE.NE.KZF) GO TO 30
      J = 1
      DO 20 I = 1, 10
           DO 10 N = 1, 10
                IF (ISECT(N,I).NE.KZF) GO TO 10
                NFX(J) = N
                NFY(J) = I
                J = J+1
10         CONTINUE
20    CONTINUE
      GO TO 90
30    IF (ITYPE.NE.KZC) GO TO 60
      M = 1
      DO 50 I = 1, 10
           DO 40 N = 1, 10
                IF (ISECT(N,I).NE.KZC) GO TO 40
                NCX(M) = N
                NCY(M) = I
                M = M+1
40         CONTINUE
50    CONTINUE
      GO TO 90
60    DO 80 I = 1, 10
           DO 70 N = 1, 10
                IF (ISECT(N,I).NE.ITYPE) GO TO 70
                IX = N
                IY = I
                GO TO 90
70         CONTINUE
80    CONTINUE
      CALL PRMSG ('REPORT ERROR 03-LOCATE  ',IW(23))
      CALL PRMSG ('CALLING FREEZE TO SAVE DATA',IW(29))
      CALL FREEZE
90    CALL DBUGIN ('LOCATE EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=LONINT
C*********************************************************************
      SUBROUTINE LONINT (ITQX,ITQY,ITSX,ITSY,IRTN,IIX,IIY)
C PURPOSE : CHECK TO SEE IF USER IS ABOUT TO MOVE THRU AN OBJECT
C           (NOT ALLOWED)
C*********************************************************************
      COMMON /TRACOM/ TARX,TARY,ISCPX2,ISCPY2,NSECE(10,10),IHIT,ISBC,
     *     IFSC,IKCC,ITORCT,ISB,IFS,IKC,IPR,ISCPX1,ISCPY1,ICHC,IPLC,ISTC
     *     ,ET,ISECT(10,10),TVX,TVY,ICMC
      COMMON /CHARS/ KZA,KZB,KZC,KZD,KZE,KZF,KZG,KZH,KZI,KZJ,KZK,KZL,KZM
     *     ,KZN,KZO,KZP,KZQ,KZR,KZS,KZT,KZU,KZV,KZW,KZX,KZY,KZZ,ICRDOT,
     *     ICRPLS,ICRCRH,ICRSTR,ICRMIN,ICRZER,KZ1,KZ2,KZ3,KZ4,KZ5,KZ6,
     *     KZ7,KZ8,KZ9,ICRBLK
      CHARACTER *4 CZCLER
      EQUIVALENCE (CZCLER,IZCLER)
      DATA CZCLER / 'CLEA'/
      CALL DBUGIN ('LONINT ENTERED',IW(14),0)
      PRESX = ISCPX1+((ISCPX2-1)*.1)
      PRESY = ISCPY1+((ISCPY2-1)*.1)
      TVX = ITQX+((ITSX-1)*.1)
      TVY = ITQY+((ITSY-1)*.1)
      CALL TARSET (PRESX,PRESY,TVX,TVY,ITARCN,ILRUD,SC)
      TVX = FLOAT(ISCPX2)
      TVY = FLOAT(ISCPY2)
      XLRUD = FLOAT(ILRUD)
10    IF (ITARCN.NE.KZX) GO TO 20
      TVX = TVX+XLRUD
      TVY = TVY+SC
      GO TO 30
20    TVX = TVX+SC
      TVY = TVY+XLRUD
30    ITVX = IFIX(TVX+.5001)
      ITVY = IFIX(TVY+.5001)
      IF (ITVX.GT.10.OR.ITVX.LT.1.OR.ITVY.GT.10.OR.ITVY.LT.1) GO TO 40
      IF (ISECT(ITVX,ITVY).EQ.ICRDOT) GO TO 10
      IRTN = ISECT(ITVX,ITVY)
      IIX = ITVX
      IIY = ITVY
      GO TO 50
40    IRTN = IZCLER
50    CALL DBUGCH ('LONINT RTN',IW(10),IRTN,IW(4))
      CALL DBUGIN ('LONINT EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=LRSCAN
C*********************************************************************
      SUBROUTINE LRSCAN
C PURPOSE : FOR CPU=0 DISPLAY LRS SCAN, FOR CPU=1, FILL THE IOUTT
C           UNIT WITH LRS INFO TO BE READ LATER
C*********************************************************************
      COMMON /TRACOM/ TARX,TARY,ISCPX2,ISCPY2,NSECE(10,10),IHIT,ISBC,
     *    IFSC,IKCC,ITORCT,ISB,IFS,IKC,IPR,ISCPX1,ISCPY1,ICHC,IPLC,ISTC
     *     ,ET,ISECT(10,10),TVX,TVY,ICMC
      COMMON /PADDED/ IPAD1(9),ICHART(8,8),IPAD2(9),IPLNET(8,8),
     *    IKY(8,8), INPUT(50),IPAD3
      COMMON /DEVICE/ XCDC,XSRDC,XIEDC,XLRDC,XWEDC,XDSDC,XSSDC,XPTDC
      COMMON /CPU/ IBMT
      COMMON /OUTUNT/ IOUTT
      DIMENSION JPLAN (9,2)
      DATA NONE /999999/
      CALL DBUGIN ('LRSCAN ENTERED',IW(14),0)
      IOUT = IOUTT
      IF (IBMT.EQ.1) IOUT = IOUT - 1
      IF (XLRDC.GT.0.001) GO TO 220
      IX = ISCPX1
      IY = ISCPY1
      IT2 = IY+1
      IT = IY-1
      N50 = IX-1
      N51 = IX+1
      IDXXX = 0
      IF (IBMT.EQ.1) GO TO 100
      CALL LINEF
      CALL PRMSM ('LONG RANGE SCAN FOR AREA: ',24,IW(24),IY,IX,' ',0,1)
      CALL LINEF
      GO TO 110
100   WRITE (IOUT,10000)
110   IF (IX.EQ.1) GO TO 120
      IF (IX.EQ.8) GO TO 130
      GO TO 140
120   WRITE (IOUT,10001) NONE,ICHART(IX,IT),  ICHART(N51,IT),
     *                   NONE,ICHART(IX,IT+1),ICHART(N51,IT+1),
     *                   NONE,ICHART(IX,IT+2),ICHART(N51,IT+2)
      GO TO 150
130   WRITE (IOUT,10001) ICHART(N50,IT),  ICHART(IX,IT),  NONE,
     *                   ICHART(N50,IT+1),ICHART(IX,IT+1),NONE,
     *                   ICHART(N50,IT+2),ICHART(IX,IT+2),NONE
      GO TO 150
140   WRITE (IOUT,10001)
     *            ICHART(N50,IT),  ICHART(N50+1,IT),  ICHART(N51,IT),
     *            ICHART(N50,IT+1),ICHART(N50+1,IT+1),ICHART(N51,IT+1),
     *            ICHART(N50,IT+2),ICHART(N50+1,IT+2),ICHART(N51,IT+2)
150   IF (N50.EQ.0) N50 = 1
      IF (N51.EQ.9) N51 = 8
      IF (IT2.EQ.9) IT2 = 8
      IF (IT.EQ.0) IT = 1
      IF (IBMT.EQ.0) CALL LINEF
      DO 210 N60 = N50, N51
           DO 200 N70 = IT, IT2
                IKY(N60,N70) = 1
                IF (IPLNET(N60,N70).EQ.0) GO TO 200
                IF (IBMT.EQ.0)
     *               CALL PRMSM (
     *               'PLANET DETECTED IN QUADRANT: ',29,IW(29),N70,N60,
     *               ' ',0,1)
                IDXXX = IDXXX + 1
                JPLAN (IDXXX,1) = N70
                JPLAN (IDXXX,2) = N60
200        CONTINUE
210   CONTINUE
      IF (IDXXX.EQ.0) GO TO 900
      IF (IBMT.EQ.0) GO TO 900
      WRITE(IOUT,10002) ((JPLAN(I,J),J=1,2),I=1,IDXXX)
      GO TO 900
220   WRITE (IOUT,10003)
900   CALL DBUGIN ('LRSCAN EXITED',IW(13),0)
      RETURN
10000 FORMAT (1X,'LONG RANGE SCAN'/1X,'---------------')
10001 FORMAT (1X,3(I4,1X)//1X,3(I4,1X)//1X,3(I4,1X))
10002 FORMAT (1X,'PLANET(S) IN:'/(I2,'-',I2,3X,I2,'-',I2))
10003 FORMAT (/' *LRS DAMAGED*')
      END
./     ADD     NAME=MAININ
C*********************************************************************
      SUBROUTINE MAININ (IZNOHT,IZRED,IZDOWN)
C PURPOSE : DRIVE ALL INITIALIZATION ROUTINES
C*********************************************************************
C     VARIABLES IDUM, AND IDUM2 WERE ONCE PART OF FEATURES
C     OF KLINGON, NO LONGER USED, HOWEVER, IF THEY ARE DELETED
C     CERTAIN ROUTINES WOULD NEED RE-WRITES.
C     CALL ROUTINE TO SET THE LEVEL OF PLAYER
C     ----------------------------------------------------------------
      COMMON /MISC/ BATTER,ISSAVE,IDUM,WFACT,IDATF,ILEV,CSDATE,TGIVEN
      COMMON /EXTRA/ N2,ITTY,IDIE
      CALL DBUGIN ('MAININ ENTERED',IW(14),0)
      CALL STARTM
C     --- INITIALIZE THE SHIPS AND CAPTAINS FOR THE FEDERATION
      CALL SSTART
C     --- SET DAMAGE CONTROLS TO ZERO AND INIT GAME VARIABLES
      CALL INITDM
C     --- INITIALIZE THE CHART STUFF, AND THE COUNTERS
      CALL INITCH
      CALL INITCT (IZNOHT,IZRED,IZDOWN)
C     --- DISPLAY INFO ON INITIAL GAME SETUP
      CALL DISPIN
C     --- SET UP INFORMATION ABOUT POPULATION IN SECTOR
      CALL ITERPT
      CALL SECSET
      CALL DBUGIN ('MAININ EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=M2FAST
C*********************************************************************
      SUBROUTINE M2FAST (WFACT,DIST,WDAMG)
C PURPOSE : SEE IF THE USER HAS WARP SPEED SET TOO HIGH, IF SO
C           WARN THEM AND ASK IF THEY WANT TO SLOW DOWN
C*********************************************************************
      COMMON /PADDED/ IPAD1(9),ICHART(8,8),IPAD2(9),IPLNET(8,8),
     *     IKY(8,8),INPUT(50),IPAD3
      CALL DBUGIN ('M2FAST ENTERED',IW(14),0)
      IF (WFACT.LT.10.0001) GO TO 20
      W = WFACT
      WD = (DIST/6.0*(W-10.0))*100.0
      IF (WD.GT.99.0) WD = 99.0
      WDAMG = WD
      CALL LINEF
      CALL PRMRM (
     * 'LORD COMMANDER, THERE IS A',26,IW(26),WD,'% CHANCE OF ',11,
     *     IW(11))
      CALL PRMSG (
     *  'OUR WARP ENGINES BEING DAMAGED IF WE CONTINUE ',IW(45))
      CALL PRMSG ('AT OUR PRESENT COURSE AND SPEED',IW(31))
      CALL LINEF
      CALL YESNO ('DO YOU WISH TO REDUCE SPEED ',IW(28),28,IYES)
      CALL LINEF
      IF (IYES.NE.1) GO TO 10
      CALL PRMSG (
     *  'REDUCING SPEED TO WARP FACTOR 10, LORD COMMANDER',IW(48))
      WFACT = 10.0
      GO TO 20
10    CALL PRMSG ('AS YOU SO ORDER, LORD COMMANDER',IW(31))
20    CALL DBUGIN ('M2FAST EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=NOVKIL
C*********************************************************************
      SUBROUTINE NOVKIL (IIX,IIY)
C PURPOSE : KILL AND DAMAGE THINGS AROUND A STAR THAT NOVAS
C*********************************************************************
      COMMON /SHIPS/ IUSFED(15,13)
      INTEGER CSEC
      COMMON /TRACOM/ TARX,TARY,PRESX,PRESY,NSECE(10,10),IHIT,ISBC,IFSC,
     *     IKCC,ITORCT,ISB,IFS,IKC,IPR,ISCPX1,ISCPY1,ICHC,IPLC,ISTC,ET,
     *     CSEC(10,10),TVX,TVY,ICMC
      COMMON /PADDED/ IPAD1(9),ICHART(8,8),IPAD2(9),IPLNET(8,8),
     *     IKY(8,8),INPUT(50),IPAD3
      COMMON /CHARS/ KZA,KZB,KZC,KZD,KZE,KZF,KZG,KZH,KZI,KZJ,KZK,KZL,KZM
     *     ,KZN,KZO,KZP,KZQ,KZR,KZS,KZT,KZU,KZV,KZW,KZX,KZY,KZZ,ICRDOT,
     *     ICRPLS,ICRCRH,ICRSTR,ICRMIN,ICRZER,KZ1,KZ2,KZ3,KZ4,KZ5,KZ6,
     *     KZ7,KZ8,KZ9,ICRBLK
      DIMENSION IDMSG(11)
      CHARACTER *4 CZMSG(11) , CZNOVD
      EQUIVALENCE (CZMSG,IDMSG) , (CZNOVD,IZNOVD)
      DATA CZMSG(1) /'** S'/ , CZMSG(2) /'TARS'/ , CZMSG(3) /'HIP '/ ,
     *     CZMSG(4) /'U.S.'/ , CZMSG(5) /'S. '/ , CZMSG(9) /'AT S'/ ,
     *     CZMSG(10) /'ECTO'/ , CZMSG(11) /'R: '/
      DATA IDMSG(6) /0/ , IDMSG(7) /0/ , IDMSG(8) /0/
      DATA CZNOVD / 'NOVA'/
      CALL DBUGIN ('NOVKIL ENTERED',IW(14),0)
      IY = IIY
      IX = IIX
      IF (CSEC(IX,IY).EQ.ICRCRH.OR.CSEC(IX,IY).EQ.ICRDOT) GO TO 100
      IF (CSEC(IX,IY).EQ.ICRSTR) GO TO 100
      IF (CSEC(IX,IY).NE.KZC) GO TO 10
      CALL PRMSM (
     *  '*** COMMANDER AT:',17,IW(17),IY,IX,
     *  'DESTROYED BY NOVA',17,IW(17))
      ICHART(ISCPX1,ISCPY1) = ICHART(ISCPX1,ISCPY1)-1000
      NSECE(IX,IY) = 0
      CSEC(IX,IY) = ICRDOT
      IKCC = IKCC+1
      IKC = IKC-1
      GO TO 100
10    IF (CSEC(IX,IY).NE.KZP) GO TO 40
      CALL PRMSM (
     *  '*** PLANET AT: ',15,IW(15),IY,IX,
     *  'DESTROYED BY NOVA',17,IW(17))
      IPR = IPR-1
      IPLNET(ISCPX1,ISCPY1) = IPLNET(ISCPX1,ISCPY1)/10
      IF (IPLNET(ISCPX1,ISCPY1).GT.9999) GO TO 20
      IPLC = IPLC+100+(IPLNET(ISCPX1,ISCPY1)/100.0+.5)
      ET = ET+.000025*IPLNET(ISCPX1,ISCPY1)
      GO TO 30
20    IPLC = IPLC+600+((IPLNET(ISCPX1,ISCPY1)-10000)/100.0+.5)
      ET = ET+.25+.000025*((IPLNET(ISCPX1,ISCPY1)-10000)/100.0+.5)
30    IPLNET(ISCPX1,ISCPY1) = 0
      NSECE(IX,IY) = 0
      CSEC(IX,IY) = ICRDOT
      GO TO 100
40    IF (CSEC(IX,IY).NE.KZF) GO TO 60
      NSECE(IX,IY) = NSECE(IX,IY)-5100
      IF (NSECE(IX,IY).LE.0) GO TO 50
      CALL PRMSM ('*** FEDERATION STARSHIP AT: ',28,IW(28),IY,IX,
     *     'DAMAGED BY NOVA',15,IW(15))
      GO TO 100
50    ET = ET+.3
      IFS = IFS-1
      IFSC = IFSC+1
      ICHART(ISCPX1,ISCPY1) = ICHART(ISCPX1,ISCPY1)-100
      NSECE(IX,IY) = 0
      CSEC(IX,IY) = ICRDOT
      CALL SSDEST (IUSFED,ISCPX1,ISCPY1,IX,IY,IDMSG(6))
      CALL PRMSM (
     *  IDMSG,44,IW(44),IY,IX,'DESTROYED BY NOVA',17,IW(17))
      GO TO 100
60    IF (CSEC(IX,IY).NE.KZB) GO TO 80
      NSECE(IX,IY) = NSECE(IX,IY)-5100
      IF (NSECE(IX,IY).LE.0) GO TO 70
      CALL PRMSM (
     *  '*** STARBASE AT: ',17,IW(17),IY,IX,
     *  'DAMAGED BY NOVA',15,IW(15))
      GO TO 100
70    ET = ET+.5
      ISB = ISB-1
      ISBC = ISBC+1
      CSEC(IX,IY) = ICRDOT
      ICHART(ISCPX1,ISCPY1) = ICHART(ISCPX1,ISCPY1)-10
      CALL PRMSM ('*** STARBASE AT: ',17,IW(17),IY,IX,
     *  'DESTROYED BY NOVA',17,IW(17))
      GO TO 100
80    CALL BEEP
      CALL ADDQUE('REDA')
      IF (CSEC(IX,IY).EQ.KZS) GO TO 90
      CALL PRMSG ('PLEASE REPORT NOVKIL ERROR 5   ',IW(28))
      CALL PRMSG ('CALLING FREEZE TO SAVE DATA',IW(29))
90    CALL PRMSG ('*** KAZH HIT BY BLAST OF NOVA',IW(29))
      IHIT = IZNOVD
100   CALL DBUGIN ('NOVKIL EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=NUMREC
C*********************************************************************
      SUBROUTINE NUMREC (ICOMSC,IPNTRO,IERRCD,RTN)
C PURPOSE : TAKE A CHARACTER STRING CONTAINING A NUMBER, AND TURN
C           IT INTO A REAL NUMBER, WHOLE  NUMBERS ARE COMPLETELY
C           ACCURATE, DECIMAL NUMBERS CAN BE AS MUCH AS .001 OFF
C*********************************************************************
      DIMENSION ICOMSC(50),IWORK(26), IWRK2(26)
      COMMON /CHARS/ KZA,KZB,KZC,KZD,KZE,KZF,KZG,KZH,KZI,KZJ,KZK,KZL,KZM
     *     ,KZN,KZO,KZP,KZQ,KZR,KZS,KZT,KZU,KZV,KZW,KZX,KZY,KZZ,ICRDOT,
     *     ICRPLS,ICRCRH,ICRSTR,ICRMIN,ICRZER,KZ1,KZ2,KZ3,KZ4,KZ5,KZ6,
     *     KZ7,KZ8,KZ9,ICRBLK
      CALL DBUGIN ('NUMREC ENTERED',IW(14),0)
      IPNTR = IPNTRO
      IERRCD = 0
      IERCD = 0
      NEGFLG = 1
      DO 10 N=1,26
           IWORK(N) = ICRBLK
           IWRK2(N) = ICRZER
10    CONTINUE
20    IF (ICOMSC(IPNTR).NE.ICRPLS) GO TO 30
      IPNTR = IPNTR+1
      GO TO 20
30    IF (ICOMSC(IPNTR).NE.ICRMIN) GO TO 40
      NEGFLG = -1
      IPNTR = IPNTR+1
      GO TO 30
40    IF (ICOMSC(IPNTR).EQ.ICRBLK) GO TO 210
      N = IPNTR
      J = 1
      IDOTPS = 0
50    IF (ICOMSC(N).EQ.ICRBLK.OR.J.GT.20) GO TO 60
           IF (ICOMSC(N).EQ.ICRDOT) IDOTPS = J
           IWORK(J) = ICOMSC(N)
           N = N + 1
           J = J + 1
           GO TO 50
60    IF (J.GT.20) GO TO 210
      IF (IDOTPS.GT.0) GO TO 70
           IDOTPS = J
           IWORK(J) = ICRDOT
           J = J + 1
70    IDOTCT = 0
      DO 100 N = 1,21
           IF (IWORK(N).EQ.ICRDOT) IDOTCT = IDOTCT + 1
100   CONTINUE
      IF (IDOTCT.NE.1) GO TO 210
      IF (IWORK(IDOTPS+4).EQ.ICRBLK) IWORK(IDOTPS+4) = ICRZER
      IF (IWORK(IDOTPS+3).EQ.ICRBLK) IWORK(IDOTPS+3) = ICRZER
      IF (IWORK(IDOTPS+2).EQ.ICRBLK) IWORK(IDOTPS+2) = ICRZER
      IF (IWORK(IDOTPS+1).EQ.ICRBLK) IWORK(IDOTPS+1) = ICRZER
      IWRK2(25) = IWORK(IDOTPS+4)
      IWRK2(24) = IWORK(IDOTPS+3)
      IWRK2(23) = IWORK(IDOTPS+2)
      IWRK2(22) = IWORK(IDOTPS+1)
      N = IDOTPS - 1
      J = 21
110   IF (N.LT.1) GO TO 120
          IWRK2(J) = IWORK(N)
          J = J - 1
          N = N - 1
          GO TO 110
120   DO 130 N=1,25
          CALL IDENT(IWRK2(N),IERR,IRTN)
          IF (IERR.NE.0) GO TO 210
130   CONTINUE
      R = 0.0
      CALL IDENT(IWRK2(22),IERR,IRTN)
      R = R + .1 * FLOAT(IRTN)
      CALL IDENT(IWRK2(23),IERR,IRTN)
      R = R + .01 * FLOAT(IRTN)
      CALL IDENT(IWRK2(24),IERR,IRTN)
      R = R + .001 * FLOAT(IRTN)
      CALL IDENT(IWRK2(25),IERR,IRTN)
      R = R + .0001 * FLOAT(IRTN)
      N = 1000000
      J = 0
      DO 200 I=15,21
           CALL IDENT (IWRK2(I),IERR,IRTN)
           J = J + (IRTN*N)
           N = N/10
200   CONTINUE
      RTN = FLOAT(J) + R
      RTN = RTN * NEGFLG
      GO TO 220
210   IERRCD = 1
      RTN = 0.0
220   CALL DBUGRN ('NUMREC RETURN VALUE',IW(19),RTN)
      CALL DBUGIN ('NUMREC EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=OLDNEW
C*********************************************************************
      SUBROUTINE OLDNEW (IOLDNW)
C PURPOSE : FIND OUT IF USER WANTS OLD OR NEW GAME
C     SET IOLDNW
C     -1 = OLD GAME REQUESTED, ERROR IN GET
C      1 = OLD GAME, GET OK
C      0 = NEW GAME REQUESTED
C*********************************************************************
      COMMON /PADDED/ IPAD1(9),ICHART(8,8),IPAD2(9),IPLNET(8,8),
     *     IKY(8,8), INPUT(50),IPAD3
      COMMON /CHARS/ KZA,KZB,KZC,KZD,KZE,KZF,KZG,KZH,KZI,KZJ,KZK,KZL,KZM
     *     ,KZN,KZO,KZP,KZQ,KZR,KZS,KZT,KZU,KZV,KZW,KZX,KZY,KZZ,ICRDOT,
     *     ICRPLS,ICRCRH,ICRSTR,ICRMIN,ICRZER,KZ1,KZ2,KZ3,KZ4,KZ5,KZ6,
     *     KZ7,KZ8,KZ9,ICRBLK
      COMMON /EXTRA/ N2,ITTY,IDIE
      CALL DBUGIN ('OLDNEW ENTERED',IW(14),0)
10    IOLDNW = -100
      CALL LINEF
      CALL PRMSG ('DO YOU WISH TO START A NEW GAME OR RESUME',IW(41))
      CALL READIN ('AN OLD ONE (NEW OR OLD) ',IW(24),24,1,EOFF)
      IF (EOFF.GT..1) GO TO 10
      CALL GAP (N2)
      IF (INPUT(N2).EQ.KZO) IOLDNW = 1
      IF (INPUT(N2).EQ.KZN) IOLDNW = 0
      IF (INPUT(N2).EQ.KZH) CALL HELPRT('ONHELP      ',IW(12))
      IF (IOLDNW.EQ.-100) GO TO 10
      IF (IOLDNW.EQ.1)   CALL GET
      IF (IPAD1(1).LT.0) IOLDNW = -1
      IF (IOLDNW.EQ.1)  CALL PRMSG ('NOW RESUMING FROZEN GAME.',IW(25))
      CALL DBUGIN ('OLDNEW EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=ORBIT
C*********************************************************************
      SUBROUTINE ORBIT
C PURPOSE : PRINT MSG SAYING ORBIT NOT AVAIL
C*********************************************************************
      CALL DBUGIN ('ORBIT ENTERED',IW(13),0)
      CALL LINEF
      CALL PRMSG (
     *'YOUR JOB IS NOT TO ORBIT PLANETS, JUST DESTROY THE ONES',IW(55))
      CALL PRMSG ('MOST USEFUL TO THE FEDERATION.',IW(30))
      CALL DBUGIN ('ORBIT EXITED',IW(12),0)
      RETURN
      END
./     ADD     NAME=PERHIT
C*********************************************************************
      FUNCTION PERHIT (IFX,IFY,ITX,ITY)
C PURPOSE : USING DISTANCE TO "WEAKEN" A PHASER SHOT FROM A FEDERATION
C           STARSHIP, DETERMINE HOW MUCH OF THE SHOT HITS US
C*********************************************************************
      CALL DBUGIN ('PERHIT ENTERED',IW(14),0)
      DISTC = DIST(5,ITX,5,ITY,5,IFX,5,IFY)
      P = ABS(1.0-(DISTC/1.3))
      PERHIT = P
      CALL DBUGRN ('PERHIT VALUE',IW(12),P)
      CALL DBUGIN ('PERHIT EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=PHASER
C*********************************************************************
      SUBROUTINE PHASER
C PURPOSE : PRINT MSG SAYING WE DON'T HAVE PHASERS
C*********************************************************************
      CALL DBUGIN ('PHASER ENTERED',IW(14),0)
      CALL LINEF
      CALL PRMSG (
     *'PHASERS ARE A FEDERATION WEAPON... YOUR SHIP IS EQUIPPED',IW(56))
      CALL PRMSG (
     *'WITH DISRUPTOR TORPEDOS, AND YOUR COMMANDERS ARE EQUIPPED',
     *     IW(57))
      CALL PRMSG ('WITH TIGHT BEAM DISRUPTOR MOUNTS.',IW(33))
      CALL DBUGIN ('PHASER EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=PHOTON
C*********************************************************************
      SUBROUTINE PHOTON (IRETRN,ITQX,ITSX,ITQY,ITSY,N2)
C PURPOSE : TRACK AND REPORT TARGETS HIT BY OUR DISRUPTOR TORPEDOS
C           (THE TERM PHOTON AND DISTRUPTOR ARE USED INTERCHAGABLY)
C*********************************************************************
      COMMON /CHARS/ KZA,KZB,KZC,KZD,KZE,KZF,KZG,KZH,KZI,KZJ,KZK,KZL,KZM
     *     ,KZN,KZO,KZP,KZQ,KZR,KZS,KZT,KZU,KZV,KZW,KZX,KZY,KZZ,ICRDOT,
     *     ICRPLS,ICRCRH,ICRSTR,ICRMIN,ICRZER,KZ1,KZ2,KZ3,KZ4,KZ5,KZ6,
     *     KZ7,KZ8,KZ9,ICRBLK
      COMMON /SHIPS/ IUSFED(15,13)
      COMMON /TRACOM/ TARX,TARY,ISCPX2,ISCPY2,NSECE(10,10),IHIT,ISBC,
     *     IFSC,IKCC,ITORCT,ISB,IFS,IKC,IPR,ISCPX1,ISCPY1,ICHC,IPLC,ISTC
     *     ,ET,ISECT(10,10),TVX,TVY,ICMC
      COMMON /PADDED/ IPAD1(9),ICHART(8,8),IPAD2(9),IPLNET(8,8),
     *     IKY(8,8),INPUT(50),IPAD3
      COMMON /DEVICE/ XCDC,XSRDC,XIEDC,XLRDC,XWEDC,XDSDC,XSSDC,XPTDC
      COMMON /NUMBER/ NSTARS,NPLNTS,NSBASE,NFED,NCOMM,NFX(9),NFY(9),NCX(
     *     9),NCY(9)
      COMMON /INFO/ ICOND(2),ENERGY,ISHUPD,ISHENG,IAPDEV,IPOF,IOVER
      COMMON /HURT/ NOCALL,IPLENG,IPBASE,IFED2,ICOMM2
      COMMON /MISC/ BATTER,ISSAVE,IDUM,WFACT,IDATF,ILEV,CSDATE,TGIVEN
      DIMENSION IRG(8,8), FIRE(8), DISVEC(8,8), VECD2(8,8), NUMS(10),
     * MSGX(11), IDMSG(11)
      EQUIVALENCE (NUMS(1),ICRZER)
      CHARACTER *4 CZMSGX(11) , CZMSG(11)
      EQUIVALENCE (CZMSGX,MSGX) , (CZMSG,IDMSG)
      DATA CZMSGX(1)/'ENTE'/,CZMSGX(2)/'R TA'/,CZMSGX(3)/'RGET'/,
     *     CZMSGX(4)/' SEC'/,CZMSGX(5)/'TOR '/,CZMSGX(6)/'FOR '/,
     *     CZMSGX(7)/'TORP'/,CZMSGX(8)/'EDO '/,CZMSGX(9)/'NUMB'/,
     *     CZMSGX(10)/'ER '/
      DATA MSGX(11) /0/
      DATA CZMSG(1) /'** S'/ , CZMSG(2) /'TARS'/ , CZMSG(3) /'HIP '/ ,
     *     CZMSG(4) /'U.S.'/ , CZMSG(5) /'S. '/ , CZMSG(9) /'AT S'/ ,
     *     CZMSG(10) /'ECTO'/ , CZMSG(11) /'R: '/
      DATA IDMSG(6) /0/ , IDMSG(7) /0/ , IDMSG(8) /0/
      CHARACTER *4 CZRED , CZSUPN , CZGRE , CZNOVD , CZCLER , CZDAMG ,
     *             CZDOWN , CZBLOW
      EQUIVALENCE (CZRED,IZRED) , (CZSUPN,IZSUPN) , (CZGRE,IZGRE) ,
     *        (CZNOVD,IZNOVD) , (CZCLER,IZCLER) , (CZDAMG,IZDAMG) ,
     *            (CZDOWN,IZDOWN) , (CZBLOW,IZBLOW)
      DATA CZRED  / 'RED'/, CZSUPN /'SNOV'/
      DATA CZGRE  / 'GREE'/
      DATA CZNOVD / 'NOVA'/
      DATA CZCLER / 'CLEA'/
      DATA CZDAMG / 'DAMG'/
      DATA CZDOWN / 'DOWN'/
      DATA CZBLOW / 'BLOW'/
      CALL DBUGIN ('PHOTON ENTERED',IW(14),0)
      IRETRN = 0
      CALL LINEF
      IMAXT = 4
      IF (XPTDC.GT.0.001) GO TO 1450
810   IF (ITORCT.EQ.0) GO TO 1430
      IFRCNT = 0
      CALL BRIDGE (N2)
      IF (N2.GT.50) GO TO 850
      IF (INPUT(N2).EQ.ICRMIN.OR.INPUT(N2).EQ.ICRZER) GO TO 150
      IF (INPUT(N2+1).NE.ICRBLK) GO TO 1720
      CALL IDENT (INPUT(N2),IERR,IFIRE)
      IF (IERR.NE.0) GO TO 850
      IF (IFIRE.GT.IMAXT) GO TO 860
      CALL BRIDGE (N2)
      IF (N2.GT.50) GO TO 870
820   IF (N2.GT.50) GO TO 830
      CALL NUMREC (INPUT,N2,IERR,RTN)
      IF (IERR.NE.0) GO TO 1720
      IF (ABS(RTN).LT.0.000001) GO TO 150
      IFRCNT = IFRCNT+1
      IF (RTN.LT.0.5.OR.RTN.GT.10.5) GO TO 1720
      FIRE(IFRCNT) = RTN
      CALL BRIDGE (N2)
      GO TO 820
830   IF (IFRCNT.NE.2.AND.IFRCNT/2.NE.IFIRE) GO TO 1720
      IF (IFRCNT.NE.2) GO TO 890
      RX = FIRE(2)
      RY = FIRE(1)
      DO 840 J = 3, 8, 2
           FIRE(J) = RY
           FIRE(J+1) = RX
840   CONTINUE
      GO TO 890
850   CALL PRMSG ('TO ABORT THIS COMMAND ENTER 0 0 (ZERO,ZERO)',IW(43))
      CALL READIN ('NUMBER OF TORPEDOES TO FIRE - ',IW(30),30,1,EOFF)
      IF (EOFF.GT..1) GO TO 150
      CALL GAP (N2)
      CALL IDENT (INPUT(N2),IERR,IFIRE)
      IF (IERR.NE.0) GO TO 1720
      IF (IFIRE.LE.0) GO TO 150
      IF (IFIRE.GT.ITORCT) GO TO 1440
      IF (IFIRE.LE.IMAXT) GO TO 870
860   CALL PRMIM ('MAXIMUM OF ',11,IW(11),IMAXT,
     *           'TORPEDOES PER BURST',20,IW(20))
      IF (IMAXT.NE.4) CALL PRMSG ('(DUE TO TUBE DAMAGE)',IW(20))
      GO TO 850
870   DO 880 J = 1, IFIRE
           NX = J*2
           MSGX(11) = NUMS(J+1)
           CALL LINEF
           CALL READIN (MSGX,IW(44),44,1,EOFF)
           IF (EOFF.GT..1) GO TO 150
           CALL GAP (N2)
           IF (N2.GT.50) GO TO 150
           CALL NUMREC (INPUT,N2,IERR,FIRE(NX-1))
           IF (IERR.NE.0) GO TO 1720
           CALL BRIDGE (N2)
           IF (N2.GT.50) GO TO 150
           CALL NUMREC (INPUT,N2,IERR,FIRE(NX))
           IF (IERR.NE.0) GO TO 1720
           IF (FIRE(NX).LT..01.OR.FIRE(NX-1).LT..01) GO TO 150
           IF (FIRE(NX).LT..5.OR.FIRE(NX).GT.10.5.OR.FIRE(NX-1).LT..
     *          5.OR.FIRE(NX-1).GT.10.5) GO TO 1720
880   CONTINUE
890   IFIRE2 = IFIRE*2
      IF (IFIRE.GT.ITORCT) GO TO 1440
      DO 900 J = 1, IFIRE2, 2
           I3Y = FIRE(J)+0.500001
           I3X = FIRE(J+1)+0.500001
           IF (ISECT(I3X,I3Y).EQ.KZS) GO TO 1420
900   CONTINUE
      IEMXC = 0
      DO 910 J = 1, IFIRE2, 2
           TARY = FIRE(J)
           TARX = FIRE(J+1)
           CALL TRACK
           ITORCT = ITORCT-1
           IEMXC = IEMXC+1
           IF (J+2.GT.IFIRE2) GO TO 910
           IF (IHIT.EQ.IZNOVD.OR.IHIT.EQ.IZBLOW.OR.IHIT.EQ.IZSUPN) GO TO
     *           920
910   CONTINUE
      IF (IHIT.EQ.IZNOVD.OR.IHIT.EQ.IZBLOW.OR.IHIT.EQ.IZSUPN) GO TO 920
      GO TO 1410
920   CALL PRMSG ('REMAINDER OF BURST ABORTED',IW(26))
      IEMXC2 = IFIRE-IEMXC
      IF (IEMXC2.LT.1) GO TO 925
      CALL PRMIM ('(THE REMAINING ',15,IW(15),IEMXC2,
     *     'TORPEDOS WERE DUMPED INTO SPACE)',32,IW(32))
      ITORCT = ITORCT-IEMXC2
925   IF (IHIT.NE.IZSUPN) GO TO 1300
      CALL LINEF
      ITX = IFIX(TVX+.5001)
      ITY = IFIX(TVY+.5001)
      BLOWD = DIST(5,ITX,5,ITY,5,ISCPX2,5,ISCPY2)
      IF (BLOWD.GT..2001) GO TO 930
      CALL PRMSG ('EMERGENCY DROP IN...',IW(20))
      CALL LINEF
      CALL PRMSG (
     *  'YOU WERE CLOSER THAN 2 SECTORS AWAY FROM THE SUPERNOVA,',
     *   IW(55))
      CALL PRMSG (
     *  'YOUR SHIP''S COMPUTER DIDN''T HAVE TIME TO GET YOU AWAY.',
     *   IW(53))
      CALL PRMSG ('(PROVIDED IT WAS WORKING)',IW(25))
      GO TO 2560
930   IF (BLOWD.GT..5.OR.XWEDC.LE.0.001) GO TO 950
940   CALL PRMSG ('EMERGENCY DROP INTO HYP...',IW(26))
      CALL LINEF
      CALL PRMSG (
     *  'YOUR SHIP IS CREMATED BY A SUPERNOVA (YOUR WARP ENGINES',
     *    IW(55))
      CALL PRMSG (
     *  'WERE DAMAGED AND YOU COULD NOT MAKE THE JUMP INTO HYPER-',
     *    IW(56))
      IF (XWEDC.GT.5.0) CALL PRMSG ('SPACE).',IW(7))
      IF (XWEDC.LE.5.0) CALL PRMSG ('SPACE FAST ENOUGH).',IW(19))
      GO TO 2560
950   IF (XWEDC.GT.5.0) GO TO 940
      CALL PRMSG ('EMERGENCY DROP INTO HYPERSPACE COMPLETE',IW(39))
      CALL LINEF
      IF (ENERGY.GT.50.0) GO TO 960
      CALL PRMSG (
     *  'YOUR SHIP DID NOT HAVE THE ENERGY NEEDED TO HOLD YOU'
     *     ,IW(52))
      CALL PRMSG (
     *  'IN HYPERSPACE, YOUR SHIP DROPS BACK INTO NORMAL SPACE',IW(53))
      CALL PRMSG ('AND GETS BURNED TO ASHES',IW(24))
      GO TO 2560
960   ENERGY = ENERGY-50.0
      IF (XCDC.LE.0.001) GO TO 980
      CALL PRMSG ('COMPUTER DAMAGED -- SETTING RANDOM COURSE',IW(41))
      CALL LINEF
970   RFX = RAND(0.9)+1.0
      RFY = RAND(0.9)+1.0
      IF (RAND(10.0).GT.5.0) RFX = -RFX
      IF (RAND(10.0).GT.5.0) RFY = -RFY
      IDISPX = IFIX(RFX*100.0)
      IDISPY = IFIX(RFY*100.0)
      IDISPX = (IDISPX+ISGN(IDISPX))/10
      IDISPY = (IDISPY+ISGN(IDISPY))/10
      ISCX = (ISCPX1*10+ISCPX2-1)+IDISPX
      ISCY = (ISCPY1*10+ISCPY2-1)+IDISPY
      MTX = ISCX/10
      MTY = ISCY/10
      IF (MTX.GT.8.OR.MTX.LT.1.OR.MTY.GT.8.OR.MTY.LT.1) GO TO 970
      ITQX = MTX
      ITQY = MTY
      ITSX = MOD(ISCX,10)+1
      ITSY = MOD(ISCY,10)+1
      GO TO 1170
980   CALL PRMSG ('COMPUTER CONTROL ACTIVATED',IW(26))
      CALL LINEF
      ILOX = ISCPX1-ISGN(ISCPX1-1)
      IHIX = ISGN(8-ISCPX1)+ISCPX1
      ILOY = ISCPY1-ISGN(ISCPY1-1)
      IHIY = ISGN(8-ISCPY1)+ISCPY1
      IAQ = 0
      IAQFLG = 0
      DO 1000 I = ILOX, IHIX
           DO 990 J = ILOY, IHIY
                IAQ = IAQ+1
                D = DIST(I,5,J,5,ISCPX1,ISCPX2,ISCPY1,ISCPY2)
                DISVEC(I,J) = D
990        CONTINUE
1000  CONTINUE
      DISVEC(ISCPX1,ISCPY1) = 999.5
      IRG(ISCPX1,ISCPY1) = IZRED
C     --- SUBTRACT ONE FROM IAQ, TO ACCOUNT FOR PRESENT QUADRANT
      IAQ = IAQ-1
      CALL COPVEC (VECD2,DISVEC,ILOX,IHIX,ILOY,IHIY)
      IAQ2 = IAQ
      IF (XLRDC.LE.0.001) CALL PRMSG (
     *  'LONG RANGE SCANNER DATA PLOTTED INTO COMPUTER',IW(45))
      IF (XLRDC.GT.0.001) CALL PRMSG (
     *  'LONG RANGE SCANNER DATA NOT AVAILABLE',IW(37))
      DO 1020 I = ILOX, IHIX
           DO 1010 J = ILOY, IHIY
                IRG(I,J) = IZGRE
                IF (XLRDC.LE.0.001) IRG(I,J) = ICROG(ICHART(I,J))
1010       CONTINUE
1020  CONTINUE
      CALL LINEF
      IF (XSSDC.LE.0.001) CALL PRMSG (
     *  'SHORT RANGE SCANNER DATA PLOTTED INTO COMPUTER',IW(46))
      IF (XSSDC.GT.0.001) CALL PRMSG (
     *  'SHORT RANGE SCANNER DATA NOT AVAILABLE',IW(38))
1030  IF (IAQFLG.NE.-1.OR.IAQ2.GT.0) GO TO 1050
1040  CALL PRMSG (
     *  'COMPUTER UNABLE TO FIND PATH OUT OF QUADRANT, YOU ARE',
     *     IW(53))
      CALL PRMSG ('BURNED TO A FINE INTERSTELLAR DUST BY THE SUPERNOVA',
     *     IW(51))
      GO TO 2560
1050  IF (XLRDC.GT.0.001) IAQFLG = -1
1060  DO 1080 I = ILOX, IHIX
           DO 1070 J = ILOY, IHIY
                IF (IRG(I,J).EQ.IZGRE) GO TO 1070
                VECD2(I,J) = 999.0
                IAQ2 = IAQ2-1
1070       CONTINUE
1080  CONTINUE
      IF (IAQ2.EQ.0) GO TO 1110
      RMIN = 1000.0
      DO 1100 I = ILOX, IHIX
           DO 1090 J = ILOY, IHIY
                IF (RMIN.LT.VECD2(I,J)) GO TO 1090
                RMIN = VECD2(I,J)
                NQX = I
                NQY = J
1090       CONTINUE
1100  CONTINUE
1110  IF (IAQ2.GT.0) GO TO 1140
      DO 1130 I = ILOX, IHIX
           DO 1120 J = ILOY, IHIY
                IRG(I,J) = IZGRE
                IF (ICHART(I,J).EQ.9999) IRG(I,J) = IZRED
1120       CONTINUE
1130  CONTINUE
      CALL COPVEC (VECD2,DISVEC,ILOX,IHIX,ILOY,IHIY)
      IAQ2 = IAQ
      IAQFLG = -1
      GO TO 1060
1140  IF (XSSDC.GT.0.001) GO TO 1150
      CALL LONINT (NQX,NQY,5,5,IRTN,IIX,IIY)
      IF (IRTN.EQ.IZCLER) GO TO 1150
      IRG(NQX,NQY) = IZRED
      IAQ2 = IAQ
      GO TO 1030
1150  IF (WFACT.GT.10.0) WFACT = 10.0
      IF (WFACT.GT.7.0) GO TO 1160
      WFACT = 7.0
1160  CALL LINEF
      IF (XWEDC.GT.0.001) WFACT = 5.0
      CALL PRMRM ('WARP FACTOR NOW - ',18,IW(18),WFACT,' ',0,1)
      CALL LINEF
      CALL PRMSG ('HELM CONTROL NOW LOCKED INTO BATTLE COMPUTER',
     *     IW(44))
      CALL LINEF
      CALL PRMSG ('STAND BY TO LEAVE QUADRANT ',IW(26))
      CALL LINEF
      IF (ICHART(NQX,NQY).EQ.9999) GO TO 1040
      ITQY = NQY
      ITQX = NQX
      ITSX = 5
      ITSY = 5
1170  CALL ITERPT
      IF (NFED.EQ.0) GO TO 1210
      CALL LOCATE (KZF,IDUM,IDUM2)
      DO 1200 M = 1, NFED
           XXX = RAND(100.0)
           IF (XXX.GT.55.0) GO TO 1190
           I = 0
1180       CALL ESCAPE (ISCPX1,ISCPY1,IX,IY)
           I = I+1
           IF (I.GT.7) GO TO 1190
           IF (ICHART(IX,IY).GT.999) GO TO 1180
           CALL LINEF
           CALL SSMOVO (IUSFED,ISCPX1,ISCPY1,NFX(M),NFY(M),IX,IY,IDMSG(6
     *          ))
           CALL PRMSM (IDMSG,44,IW(44),NFY(M),NFX(M),' ',0,1)
           CALL PRMSM ('ESCAPES TO QUADRANT ',20,IW(20),IY,IX,' ',0,1)
           ICHART(IX,IY) = ICHART(IX,IY)+100
           GO TO 1200
1190       CALL LINEF
           CALL SSDEST (IUSFED,ISCPX1,ISCPY1,NFX(M),NFY(M),IDMSG(6))
           CALL PRMSM(IDMSG,44,IW(44),NFY(M),NFX(M),
     *          'DESTROYED BY SUPERNOVA'
     *          ,22,IW(22))
           ET = ET+.3
           IFS = IFS-1
           IFSC = IFSC+1
1200  CONTINUE
1210  IF (NCOMM.EQ.0) GO TO 1250
      CALL LOCATE (KZC,IDUM,IDUM2)
      DO 1240 M = 1, NCOMM
           XXX = RAND(100.0)
           IF (XXX.GT.65.0) GO TO 1230
           I = 0
1220       CALL ESCAPE (ISCPX1,ISCPY1,IX,IY)
           I = I+1
           IF (I.GT.7) GO TO 1230
           IF (ICHART(IX,IY).GT.9) GO TO 1220
           CALL LINEF
           CALL PRMSM ('*** COMMANDER AT ',17,IW(17),
     *               NCY(M),NCX(M),' ',0,1)
           CALL PRMSM ('ESCAPES TO QUADRANT ',20,IW(20),IY,IX,' ',0,1)
           ICHART(IX,IY) = ICHART(IX,IY)+1000
           GO TO 1240
1230       CALL LINEF
           CALL PRMSM ('*** COMMANDER AT ',17,IW(17),NCY(M),NCX(M),
     *          'DESTROYED BY SUPERNOVA',22,IW(22))
           IKC = IKC-1
           IKCC = IKCC+1
1240  CONTINUE
1250  IF (NPLNTS.EQ.0) GO TO 1280
      CALL LOCATE (KZP,IXP,IYP)
      IPR = IPR-1
      IPLNET(ISCPX1,ISCPY1) = IPLNET(ISCPX1,ISCPY1)/10
      IF (IPLNET(ISCPX1,ISCPY1).GT.9999) GO TO 1260
      IPLC = IPLC+100+(IPLNET(ISCPX1,ISCPY1)/100.0+.5)
      ET = ET+.000025*IPLNET(ISCPX1,ISCPY1)
      GO TO 1270
1260  IPLC = IPLC+600+((IPLNET(ISCPX1,ISCPY1)-10000)/100.0+.5)
      ET = ET+.25+.000025*((IPLNET(ISCPX1,ISCPY1)-10000)/100.0+.5)
1270  IPLNET(ISCPX1,ISCPY1) = 0
      CALL LINEF
      CALL PRMSM ('*** PLANET AT ',14,IW(14),IYP,IXP,
     *     'DESTROYED BY SUPERNOVA',
     *     22,IW(22))
1280  IF (NSBASE.EQ.0) GO TO 1290
      CALL LOCATE (KZB,IXB,IYB)
      ET = ET+.5
      ISB = ISB-1
      ISBC = ISBC+1
      CALL LINEF
      CALL PRMSM ('*** STARBASE AT ',16,IW(16),IYB,IXB,
     *     'DESTROYED BY SUPERNOVA',22,IW(22))
1290  IKY(ISCPX1,ISCPY1) = 1
      ICHART(ISCPX1,ISCPY1) = 9999
      CALL LINEF
      GO TO 1950
1300  IF (IHIT.NE.IZBLOW) GO TO 1350
      CALL LINEF
      CALL PRMSG ('EMERGENCY -- EMERGENCY',IW(22))
      CALL LINEF
      CALL PRMSG (
     *  'AUTOMATIC EMERGENCY FIELD DAMPENING SYSTEM ACTIVATED',
     *   IW(52))
      CALL LINEF
      UNHIT = RAND(400.0)+2200.0
      IF (ISHUPD.NE.IZDAMG) GO TO 1310
      CALL PRMSG ('SHIELDS NOT USABLE, STAND BY FOR SHOCK WAVE',IW(43))
      GO TO 1330
1310  J = ISHENG-IFIX(UNHIT)
      IF (J.GT.0) GO TO 1320
      CALL PRMSG ('SHIELD ENERGY LOW, STAND BY FOR SHOCK WAVE',IW(42))
      UNHIT = UNHIT-FLOAT(ISHENG)
      ISHENG = 0
      GO TO 1330
1320  CALL PRMSG (
     *  'AUTOMATIC FIELD DAMPENING SYSTEM TAKES FULL IMPACT OF',
     *  IW(53))
      CALL PRMSG ('BLAST, NO DAMAGE TO SHIP',IW(24))
      ISHENG = ISHENG-IFIX(UNHIT)
      GO TO 1340
1330  CALL DAMAGE (UNHIT)
1340  CALL LINEF
      CALL PRMIM ('SHIELDS NOW AT: ',16,IW(16),ISHENG,'UNITS.',6,IW(6))
      GO TO 1410
1350  CALL LINEF
      CALL PRMSG ('EMERGENCY -- EMERGENCY',IW(22))
      CALL LINEF
      CALL PRMSG (
     *  'THE LIGHTS OF YOUR BRIDGE GO OUT AS YOU AND YOUR BRIDGE',
     *     IW(55))
      CALL PRMSG (
     *  'PERSONNEL ARE THROWN TO THE FLOOR BY THE FORCE OF THE NOVA',
     *     IW(58))
      CALL PRMSG (
     *  'YOU STAGGER TO YOUR FEET AS THE LIGHTS COME BACK UP SLOWLY',
     *     IW(58))
      CALL LINEF
      CALL PRMSG (
     *  'YOUR FIRST OFFICER CALLS FOR DAMAGE REPORTS FROM ALL DECKS',
     *     IW(58))
      CALL LINEF
      HIT = RAND(300.0)+1700.0
      IF (ISHUPD.NE.IZDOWN.AND.ISHUPD.NE.IZDAMG) GO TO 1360
      ENERGY = ENERGY-HIT
      IF (ENERGY.LE.0.0) GO TO 1390
      CALL DAMAGE (HIT)
      GO TO 1400
1360  IF (HIT.GT.FLOAT(ISHENG)) GO TO 1380
      CALL PRMSG (
     *  'SHIELDS TAKE FULL FORCE OF BLAST, NO DAMAGE TO SHIP',
     *     IW(51))
      CALL LINEF
      ISHENG = ISHENG-IFIX(HIT)
1370  CALL PRMIM ('SHIELDS NOW AT: ',16,IW(16),ISHENG,'UNITS.',6,IW(6))
      GO TO 1400
1380  CALL PRMSG (
     *  'SHIELD ENERGY LOW, FORCE OF NOVA PARTIALLY ABSORBED BY',
     *    IW(54))
      CALL PRMSG ('SHIELDS, DAMAGE REPORTS COMING IN',IW(33))
      ENERGY = ENERGY-(HIT-ISHENG)
      IF (ENERGY.LE.0.0) GO TO 1390
      ISHENG = 0
      IF (HIT-ISHENG.GT.300.0) CALL DAMAGE (HIT-ISHENG)
      IF (HIT-ISHENG.LE.300.0) CALL PRMSG ('*** NO DAMAGE',IW(13))
      GO TO 1370
1390  CALL PRMSG ('YOUR MAIN ENERGY HAS GONE TO 0',IW(30))
      GO TO 2560
1400  CALL LINEF
1410  CALL DRAGIN
      CALL BATTLE
      GO TO 150
1420  CALL LINEF
      CALL PRMSG (
     * 'I WOULDN''T DO THAT TOO OFTEN OR YOUR FIRST OFFICER MIGHT ',
     *   IW(56))
      CALL PRMSG ('GET SOME IDEAS ABOUT BEING "LORD COMMANDER".',
     *     IW(43))
      GO TO 150
1430  CALL PRMSG ('LORD COMMANDER, TORPEDO FIRE CONTROL REPORTS WE',
     *     IW(47))
      CALL PRMSG ('DON''T HAVE ANY DISRUPTOR TORPEDOES LEFT',
     *     IW(39))
      GO TO 150
1440  CALL PRMSG ('LORD COMMANDER, TORPEDO FIRE CONTROL REPORTS WE',
     *     IW(47))
      CALL PRMSG (
     * 'DON''T HAVE ENOUGH TORPEDOES FOR THE ORDERED SPREAD     ',
     *     IW(50))
      GO TO 150
1450  IF (XPTDC.GT.1.5) GO TO 1460
      IF (XPTDC.LE.1.5) IMAXT = 1
      IF (XPTDC.LE.1.0) IMAXT = 2
      IF (XPTDC.LE.0.5) IMAXT = 3
      GO TO 810
1460  IMAXT = 0
      CALL PRMSG (
     *  'DISRUPTOR TORPEDO TUBES DAMAGED,  ',IW(32))
      CALL PRMSG ('TRY FIRING LESS TORPEDOES',IW(25))
      GO TO 150
1720  IRETRN = 1
      GO TO 150
2560  IRETRN = 2
      GO TO 150
1950  IRETRN = 3
150   CALL DBUGIN ('PHOTON EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=PLACE
C*********************************************************************
      SUBROUTINE PLACE (NUMBER,ITEM,ILIMIT)
C PURPOSE : THIS IS A ROUTINE FOR PLACING NUMBERS IN THE PRIMARY
C           CHART
C           NUMBER IS HOW MANY OF THE ITEM THAT HAS BEEN SELECTED
C           ITEM IS THE QUANITY OF WHAT IS BE BE ADDED TO THE CHART
C           ILIMIT IS THE LIMIT OF HOW HIGH THE CHART COULD BE
C           AND STILL PUT THE ITEM AT THAT LOCATION.
C           THE SSINIT (STAR SHIP LIST INIT) WILL BE CALLED
C           IF ITEM = 100 (FEDERATION STARSHIP)
C*********************************************************************
      COMMON /SHIPS/ IUSFED(15,13)
      COMMON /PADDED/ IPAD1(9),ICHART(8,8),IPAD2(9),IPLNET(8,8),IKY(8,8)
     *     ,INPUT(50),IPAD3
      CALL DBUGIN ('PLACE ENTERED',IW(13),0)
      DO 20 N = 1, NUMBER
10         INDEX = RAND(8.0)+1.0
           INDEY = RAND(8.0)+1.0
           IF (ICHART(INDEX,INDEY).GT.ILIMIT) GO TO 10
           ICHART(INDEX,INDEY) = ICHART(INDEX,INDEY)+ITEM
           IF (ITEM.NE.100) GO TO 20
           CALL SSINIT (IUSFED,INDEX,INDEY)
20    CONTINUE
      CALL DBUGIN ('PLACE EXITED',IW(12),0)
      RETURN
      END
./     ADD     NAME=PLAGAN
C*********************************************************************
      SUBROUTINE PLAGAN (IYES)
C PURPOSE : PROMPT USER TO SEE IF THEY WISH TO PLAY ANOTHER GAME
C*********************************************************************
      CALL DBUGIN ('PLAGAN ENTERED',IW(14),0)
      CALL PRMSG ('=====================================',IW(37))
      CALL LINEF
      CALL YESNO ('DO YOU WISH TO PLAY AGAIN  ',IW(26),26,IYES)
      CALL DBUGIN ('PLAGAN EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=PLANET
C*********************************************************************
      SUBROUTINE PLANET
C PURPOSE : PRINT MSG SAYING WE DON'T KEEP PLANET RECORD
C*********************************************************************
      CALL DBUGIN ('PLANET ENTERED',IW(14),0)
      CALL LINEF
      CALL PRMSG ('BEGGING YOUR LEAVE, LORD COMMANDER, OUR COMPUTER IS',
     *     IW(51))
      CALL PRMSG ('NOT PROGRAMMED TO KEEP A RECORD OF PLANETS FOUND',
     *     IW(48))
      CALL DBUGIN ('PLANET EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=PRCHRT
C*********************************************************************
      SUBROUTINE PRCHRT
C PURPOSE : DISPLAY INFORMATION ON THE CURRENT STATUS OF THE GALAXY
C           OWNED BY THE FEDERATION
C*********************************************************************
      COMMON /DEVICE/ XCDC,XSRDC,XIEDC,XLRDC,XWEDC,XDSDC,XSSDC,XPTDC
      COMMON /TRACOM/ TARX,TARY,ISCPX2,ISCPY2,NSECE(10,10),IHIT,ISBC,
     *    IFSC,IKCC,ITORCT,ISB,IFS,IKC,IPR,ISCPX1,ISCPY1,ICHC,IPLC,ISTC
     *     ,ET,ISECT(10,10),TVX,TVY,ICMC
      COMMON /PADDED/ IPAD1(9),ICHART(8,8),IPAD2(9),IPLNET(8,8),
     *    IKY(8,8), INPUT(50),IPAD3
      COMMON /EXTRA/ N2,ITTY,IDIE
      COMMON /OUTUNT/ IOUTT
      COMMON /CPU/ IBMT
      COMMON /TERMSZ/ IILINE, IILLEN
      DIMENSION LINE(8),IFORM(21),ICHR(2),IINT(2)
      CHARACTER *4 CZFORM(21) , CZICHR(2) , CZDOTS , CZIINT(2)
      EQUIVALENCE (CZFORM,IFORM) , (CZICHR,ICHR) , (CZDOTS,IDOTS) ,
     *            (CZIINT,IINT)
      DATA CZFORM(1) /'(I2,'/ , CZFORM(2) /'6H -'/ ,
     *     CZFORM(3) /'--  '/ , CZFORM(4) /','/ , CZFORM(21) /')'/
      DATA CZICHR(1) /'A4, '/ , CZICHR(2) /'3X, '/
      DATA CZDOTS /'....'/
      DATA CZIINT(1) /'I4,'/ , CZIINT(2) /'3X,'/
      CALL DBUGIN ('PRCHRT ENTERED',IW(14),0)
      IF (ITTY.EQ.1) GO TO 5
      CALL LINEF
      CALL PRMSG ('CHART FOR KNOWN FEDERATION SPACE:',IW(33))
      CALL LINEF
5     CALL PRMSG (
     *  '         1      2      3      4      5      6      7      8'
     *     ,IW(59))
      IF (IBMT.EQ.1.AND.ITTY.EQ.1) GO TO 6
      CALL PRMSG (
     *'      --------------------------------------------------------'
     *  ,IW(62))
6     DO 30 N = 1, 8
           DO 20 M = 1, 8
                IC = ICHART(M,N)
                IF (IKY(M,N).EQ.1) GO TO 10
                IF (IC/1000.EQ.0.AND.IKY(M,N).LT.0) IKY(M,N) = 0
                IF (IC/1000.GT.0) IKY(M,N) = -1
                IF (IKY(M,N).EQ.-1.AND.XSRDC.GT.0.001) IKY(M,N) = 0
10              LINE(M) = IDOTS
                IFORM(3+(2*M)) = ICHR(1)
                IFORM(4+(2*M)) = ICHR(2)
                IF (IKY(M,N).EQ.0) GO TO 20
                LINE(M) = ICHART(M,N)
                IFORM(3+(2*M)) = IINT(1)
                IFORM(4+(2*M)) = IINT(2)
20         CONTINUE
           WRITE (IOUTT,IFORM) N,LINE
           IF (ITTY.NE.1) CALL LINEF
30    CONTINUE
      IF (ITTY.NE.1) CALL LINEF
      IF (IBMT.EQ.1.AND.ITTY.EQ.1) GO TO 40
      CALL PRMSM (
     *  'THE SUPERCOMMANDER KAZH CURRENTLY IN QUADRANT ',46,IW(46),
     *     ISCPY1,ISCPX1,' ',0,1)
40    CALL DBUGIN ('PRCHRT EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=PRHIT
C*********************************************************************
      SUBROUTINE PRHIT (IHIT1,IHIT2,MSG,MSGLEN,MSGDIM,ISEC1,ISEC2)
C PURPOSE : DISPLAY INFORMATION ON INCOMING FIRE, NAMELY HOW
C           STRONG WAS IT
C*********************************************************************
      COMMON /OUTUNT/ IOUTT
      DIMENSION MSG(MSGDIM),IFORM(17)
      CHARACTER *4 CZFORM(17)
      EQUIVALENCE (CZFORM,IFORM)
      DATA CZFORM(1)  /'(2H '/ , CZFORM(2)  /'( ,I'/ ,
     *     CZFORM(4)  /',1H,'/ , CZFORM(5)  /',  I'/ ,
     *     CZFORM(7)  /',2H)'/ , CZFORM(8)  /' ,  '/ ,
     *     CZFORM(11) /',1X,'/ , CZFORM(12) /'   I'/ ,
     *     CZFORM(14) /',3H '/ , CZFORM(15) /'- ,I'/ ,
     *     CZFORM(17) /')   '/
      DATA IFORM(3) /0/ , IFORM(6) /0/ , IFORM(9) /-1/ ,
     *     IFORM(10) /-1/ , IFORM(13) /0/ , IFORM(16) /0/
      CALL SETFOR (MSGLEN,IFORM(9),IFORM(10),IMX)
      CALL INSFOR(IHIT1,IFORM(3))
      CALL INSFOR(IHIT2,IFORM(6))
      CALL INSFOR(ISEC1,IFORM(13))
      CALL INSFOR(ISEC2,IFORM(16))
      IF (IMX.EQ.0) WRITE (IOUTT,IFORM) IHIT1,IHIT2,ISEC1,ISEC2
      IF (IMX.NE.0) WRITE (IOUTT,IFORM) IHIT1,IHIT2,(MSG(N),N=1,IMX),
     *                                  ISEC1,ISEC2
      RETURN
      END
./     ADD     NAME=PRMIM
C*********************************************************************
      SUBROUTINE PRMIM (MSG1,MSG1L,MSG1D,INUM,MSG2,MSG2L,MSG2D)
C PURPOSE : PRINT A NUMBER IN THE FORM "MSG" INTEGER "MSG"
C           NOTE THAT CALLERS WILL PASS A SINGLE BLANK FOR A MSG,
C           IF THEY WANT JUST A MSG FOLLOWED BY NUMBER OR NUMBER
C           FOLLOWED BY MSG (I.E. BOTH MESSAGES ARE ALWAYS PRESENT,
C           BUT ONE MAY BE BLANK)
C*********************************************************************
      COMMON /OUTUNT/ IOUTT
      DIMENSION MSG1(MSG1D),MSG2(MSG2D),IFORM(9)
      CHARACTER *4 CZFORM(9)
      EQUIVALENCE (CZFORM,IFORM)
      DATA CZFORM(1) /'(1X,'/ , CZFORM(4) /',  I'/ ,
     *     CZFORM(6) /',1X,'/ , CZFORM(9) /')   '/
      DATA IFORM(2) /-1/ , IFORM(3) /-1/ , IFORM(5) /0/ ,
     *     IFORM(7) /-1/ , IFORM(8) /-1/
      CALL SETFOR (MSG1L,IFORM(2),IFORM(3),IMX1)
      CALL SETFOR (MSG2L,IFORM(7),IFORM(8),IMX2)
      CALL INSFOR(INUM,IFORM(5))
      IF (IMX1.EQ.0) GO TO 10
      IF (IMX2.EQ.0) GO TO 30
      WRITE (IOUTT,IFORM) (MSG1(N1),N1=1,IMX1),INUM,(MSG2(N2),N2=1,IMX2)
      GO TO 40
10    IF (IMX2.EQ.0) GO TO 20
      WRITE (IOUTT,IFORM) INUM,(MSG2(N2),N2=1,IMX2)
      GO TO 40
20    WRITE (IOUTT,IFORM) INUM
      GO TO 40
30    WRITE (IOUTT,IFORM) (MSG1(N1),N1=1,IMX1),INUM
40    RETURN
      END
./     ADD     NAME=PRMRM
C*********************************************************************
      SUBROUTINE PRMRM (MSG1,MSG1L,MSG1D,RNUM,MSG2,MSG2L,MSG2D)
C PURPOSE : PRINT A LINE IN THE FORM "MSG" REAL NUMBER "MSG"
C*********************************************************************
      COMMON /OUTUNT/ IOUTT
      DIMENSION MSG1(MSG1D),MSG2(MSG2D),IFORM(10),NUMS(20)
      CHARACTER *4 CZFORM(10) , CZNUMS(20)
      EQUIVALENCE (CZFORM,IFORM) , (CZNUMS,NUMS)
      DATA CZFORM(1) /'(1X,'/ , CZFORM(4) /',F'/ , CZFORM(6) /'.3,'/ ,
     *     CZFORM(7) /'1X,'/ , CZFORM(10) /')'/
      DATA IFORM(2) /-1/ , IFORM(3) /-1/ , IFORM(5) /0/ ,
     *     IFORM(8) /-1/ , IFORM(9) /-1/
      DATA CZNUMS / '0','1','2','3','4','5','6','7','8','9','10','11',
     *              '12','13','14','15','16','17','18','19'/
      CALL SETFOR (MSG1L,IFORM(2),IFORM(3),IMX1)
      CALL SETFOR (MSG2L,IFORM(8),IFORM(9),IMX2)
      IF (ABS(RNUM).LT..0000001) GO TO 10
      GO TO 20
10    IFORM(5) = NUMS(7)
      GO TO 40
20    RL = ALOG10(ABS(RNUM))
      IF (RL.LT.0) GO TO 30
      IFORM(5) = NUMS(IFIX(RL)+7)
      GO TO 40
30    IFORM(5) = NUMS(7)
40    IF (IMX1.EQ.0) GO TO 110
      IF (IMX2.EQ.0) GO TO 130
      WRITE (IOUTT,IFORM) (MSG1(N1),N1=1,IMX1),RNUM,(MSG2(N2),N2=1,IMX2)
      GO TO 140
110   IF (IMX2.EQ.0) GO TO 120
      WRITE (IOUTT,IFORM) RNUM,(MSG2(N2),N2=1,IMX2)
      GO TO 140
120   WRITE (IOUTT,IFORM) RNUM
      GO TO 140
130   WRITE (IOUTT,IFORM) (MSG1(N1),N1=1,IMX1),RNUM
140   RETURN
      END
./     ADD     NAME=PRMSG
C*********************************************************************
      SUBROUTINE PRMSG (IMSG,IDIM)
C PURPOSE : DISPLAY A CHARACTER MSG TO OUT UNIT
C*********************************************************************
      COMMON /OUTUNT/ IOUTT
      DIMENSION IMSG(IDIM)
      DIMENSION IFORM (4)
      CHARACTER *4 CZFORM(4)
      EQUIVALENCE (CZFORM,IFORM)
      DATA CZFORM(1) /'(1X,'/ , CZFORM(4) /')'/
      DATA IFORM(2) /-1/ , IFORM(3) /-1/
      I = IWI(IDUMMY)
      CALL SETFOR (I,IFORM(2),IFORM(3),IMX)
      IF (IMX.EQ.0) WRITE (IOUTT,IFORM)
      IF (IMX.NE.0) WRITE (IOUTT,IFORM) (IMSG(N),N=1,IMX)
      RETURN
      END
./     ADD     NAME=PRMSGC
C*********************************************************************
      SUBROUTINE PRMSGC(IMSG,IDIM)
C PURPOSE : DISPLAY MSG TO CERTIFICATE FILE (FT08F001)
C*********************************************************************
      COMMON /CPU/ IBMT
      COMMON /OUTUNT/ IOUTT
      DIMENSION IMSG(IDIM)
      DIMENSION IFORM (4)
      CHARACTER *4 CZFORM(4)
      EQUIVALENCE (CZFORM,IFORM)
      DATA CZFORM(1) /'(1X,'/ , CZFORM(4) /')'/
      DATA IFORM(2) /-1/ , IFORM(3) /-1/
      I = IWI(IDUMMY)
      CALL SETFOR (I,IFORM(2),IFORM(3),IMX)
      IF (IBMT.NE.0) GO TO 10
      IF (IMX.EQ.0) WRITE (IOUTT,IFORM)
      IF (IMX.NE.0) WRITE (IOUTT,IFORM) (IMSG(N),N=1,IMX)
10    IF (IBMT.NE.1) GO TO 20
      IF (IMX.EQ.0) WRITE (8,IFORM)
      IF (IMX.NE.0) WRITE (8,IFORM) (IMSG(N),N=1,IMX)
20    RETURN
      END
./     ADD     NAME=PRMSG1
C*********************************************************************
      SUBROUTINE PRMSG1 (IMSG,IDIM)
C PURPOSE : DISPLAY AN ARRAY IN A1 FORMAT
C*********************************************************************
      COMMON /OUTUNT/ IOUTT
      DIMENSION IMSG(IDIM)
      I = IDIM
      IF (I.GT.80) I = 80
      WRITE (IOUTT,10000) (IMSG(N),N=1,I)
      RETURN
10000 FORMAT (' ',80A1)
      END
./     ADD     NAME=PRMSM
C*********************************************************************
      SUBROUTINE PRMSM (MSG1,MSG1L,MSG1D,ISEC1,ISEC2,MSG2,MSG2L,MSG2D)
C PURPOSE : DISPLAY A LINE IN THE FORM "MSG" SECTOR#, SECTOR# "MSG"
C*********************************************************************
      COMMON /OUTUNT/ IOUTT
      DIMENSION MSG1(MSG1D),MSG2(MSG2D),IFORM(12),NUMS(2)
      CHARACTER *4 CZFORM(12) , CZNUMS(2)
      EQUIVALENCE (CZFORM,IFORM) , (CZNUMS,NUMS)
      DATA CZFORM(1) /'(1X,'/ , CZFORM(4) /',I'/ , CZFORM(6) /',3H '/ ,
     *     CZFORM(7) /'- ,I'/ , CZFORM(9) /',1X,'/ , CZFORM(12) /')'/
      DATA IFORM(2) /-1/ , IFORM(3) /-1/ , IFORM(5) /0/ ,
     *     IFORM(8) /0/ , IFORM(10) /-1/ , IFORM(11) /-1/
      DATA CZNUMS / '1','2'/
      CALL SETFOR (MSG1L,IFORM(2),IFORM(3),IMX1)
      CALL SETFOR (MSG2L,IFORM(10),IFORM(11),IMX2)
      IFORM(5) = NUMS(1)
      IFORM(8) = NUMS(1)
      IF (ISEC1.GT.9) IFORM(5) = NUMS(2)
      IF (ISEC2.GT.9) IFORM(8) = NUMS(2)
      IF (IMX1.EQ.0) GO TO 10
      IF (IMX2.EQ.0) GO TO 30
      WRITE (IOUTT,IFORM) (MSG1(N1),N1=1,IMX1),ISEC1,ISEC2,
     *                    (MSG2(N2),N2=1,IMX2)
      GO TO 40
10    IF (IMX2.EQ.0) GO TO 20
      WRITE (IOUTT,IFORM) ISEC1,ISEC2,(MSG2(N2),N2=1,IMX2)
      GO TO 40
20    WRITE (IOUTT,IFORM) ISEC1,ISEC2
      GO TO 40
30    WRITE (IOUTT,IFORM) (MSG1(N1),N1=1,IMX1),ISEC1,ISEC2
40    RETURN
      END
./     ADD     NAME=PROMOT
C*********************************************************************
      SUBROUTINE PROMOT (ILEV)
C PURPOSE : IF A PLAYER WINS A GAME, PROMOTE THEM TO NEXT LEVEL
C*********************************************************************
      COMMON /PADDED/ IPAD1(9),ICHART(8,8),IPAD2(9),IPLNET(8,8),
     *     IKY(8,8),INPUT(50),IPAD3
      DIMENSION NAME(10)
      CALL DBUGIN ('PROMOT ENTERED',IW(14),0)
      ILEVB = ILEV-2
      CALL LINEF
      CALL PRMSG (
     *  'FOR YOUR OUTSTANDING WORK, THE KLINGON HIGH COMMAND',
     *  IW(51))
      CALL PRMSG ('AWARDS YOU THE NEW RANK OF: ',IW(28))
      CALL LINEF
      IF (ILEVB) 10 , 20 , 30
10    CALL PRMSG ('      FLEET VICE-ADMIRAL EMERITUS       ',IW(40))
      GO TO 80
20    CALL PRMSG ('      FLEET ADMIRAL EMERITUS            ',IW(40))
      GO TO 40
30    CALL PRMSG ('      SUPREME FLEET ADMIRAL EMERITUS    ',IW(40))
40    CALL LINEF
      CALL YESNO ('DO YOU WANT YOUR CERTIFICATE OF MERIT PRINTED',
     *    IW(45),45,IYES)
      IF (IYES.EQ.0) GO TO 80
50    CALL LINEF
      CALL READIN ('ENTER THE NAME YOU WANT ON THE CERTIFICATE ',
     *     IW(43),43,0,EOFF)
      IF (EOFF.GT..1) GO TO 50
      NAME(1) = INPUT(1)
      NAME(2) = INPUT(2)
      NAME(3) = INPUT(3)
      NAME(4) = INPUT(4)
      NAME(5) = INPUT(5)
      NAME(6) = INPUT(6)
      NAME(7) = INPUT(7)
      NAME(8) = INPUT(8)
      NAME(9) = INPUT(9)
      NAME(10)= INPUT(10)
      IF (ILEVB) 80 , 60 , 70
60    CALL CERT (NAME,IW(40),
     * '      FLEET ADMIRAL EMERITUS            ',IW(40))
      GO TO 80
70    CALL CERT (NAME,IW(40),
     * '      SUPREME FLEET ADMIRAL EMERITUS    ',IW(40))
80    CALL DBUGIN ('PROMOT EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=PRSC
C*********************************************************************
      SUBROUTINE PRSC (NUM,MSG,MLEN,MDIM,ISCORE)
C PURPOSE : PRINT A SCORE NUMBER FOR A PLAYER
C*********************************************************************
      COMMON /OUTUNT/ IOUTT
      DIMENSION MSG(MDIM),IVEC(7)
      CHARACTER *4 CZIVEC(7)
      EQUIVALENCE (CZIVEC,IVEC)
      DATA CZIVEC(1) /'(1X,'/ , CZIVEC(2) /'I2,'/ , CZIVEC(3) /'1X,'/ ,
     *     CZIVEC(6) /',T49'/ , CZIVEC(7) /',I7)'/
      DATA IVEC(4) /-1/ , IVEC(5) /-1/
      CALL SETFOR (MLEN,IVEC(4),IVEC(5),IMX)
      IF (IMX.EQ.0) WRITE (IOUTT,IVEC) NUM,ISCORE
      IF (IMX.NE.0) WRITE (IOUTT,IVEC) NUM,(MSG(N),N=1,IMX),ISCORE
      RETURN
      END
./     ADD     NAME=PRTEND
C*********************************************************************
      SUBROUTINE PRTEND
C PURPOSE : DISPLAY THE OUTGOING TORPEDO INFO IN TRACKR ARRAY
C*********************************************************************
      COMMON /OUTUNT/ IOUTT
      COMMON /TRACKR/ ITRKC, RTRK(15,2)
      IF (ITRKC.LT.1) GO TO 10
      WRITE (IOUTT,10000) ((RTRK(N,J),J=1,2),N=1,ITRKC)
      ITRKC = 0
      CALL LINEF
10    RETURN
10000 FORMAT (' ',F6.3,' - ',F6.3,5X,F6.3,' - ',F6.3,5X,
     *            F6.3,' - ',F6.3,5X,F6.3,' - ',F6.3)
      END
./     ADD     NAME=RAND
C*********************************************************************
      REAL FUNCTION RAND (VAL)
C PURPOSE : RANDOM NUMBER GENERATOR,
C           GENERATES A NUMBER BETWEEN 0.0 AND VAL
C*********************************************************************
      RAND = VAL*RANDF(1.0)
      CALL DBUGRN('INPUT TO RAND',IW(13),VAL)
      CALL DBUGRN('OUTPUT FROM RAND',IW(16),RAND)
      RETURN
      END
./     ADD     NAME=RANDF
C*********************************************************************
      FUNCTION RANDF (VALUE)
C PURPOSE : GENERATE A REAL NUMBER (RANDOM) BETWEEN 0.0 AND 1.0,
C           NOTE THIS SUBROUTINE IS PSEUDO-RANDOM, TO INIT TO GET A
C           NICE SPREAD OF DIFFERENT NUMBERS, CALL THIS ROUTINE A
C           RANDOM NUMBER OF TIMES (SEE ROUTINE RANSET) FOR EXAMPLE,
C           IF YOU GET A CLOCK FROM THE SYSTEM, GENERATE SOME INTEGER
C           NUMBER FROM THAT CLOCK, AND CALL THIS ROUTINE "N" TIMES,
C           THE RESULT WILL BE DIFFERENT SEQUENCES OF NUMBERS BASED
C           ON THE TIME OF DAY.
C           *NOTE* THE BASE NUMBERS IN THE DATA STATEMENT BELOW ARE
C           VERY CAREFULLY SELECTED TO GIVE A GOOD DISTRIBUTION OF
C           RANDOM NUMBERS, DO NOT CHANGE THESE NUMBERS.
C*********************************************************************
      REAL VALUE
      INTEGER B,IS,NUM
      DATA IS,M,B /8,10000,2821/
      I1 = IS * B + 1
      IS = I1 - (I1/M)*M
      RNUM = FLOAT(IS/100 + 1)
      RNUM = (RNUM / 100.0) * VALUE
      IF (RNUM.GE.VALUE) RNUM=VALUE - .0001
      RANDF = RNUM
      GO TO 10
      ENTRY RANFIN
      IS = 8
      M  = 10000
      B  = 2821
10    RETURN
      END
./     ADD     NAME=RANSET
C*********************************************************************
      SUBROUTINE RANSET (ICOUNT)
C PURPOSE : KICK THE RANDOM NUMBER GENERATOR TO GET DIFFERENT STRINGS
C           OF RANDOM NUMBERS BASED ON "ICOUNT"
C*********************************************************************
      CALL RANFIN
      I = MOD(ICOUNT,1000)
      DO  10 N=1,I
           CALL RAND(1.0)
10    CONTINUE
      RETURN
      END
./     ADD     NAME=READIN
C*********************************************************************
      SUBROUTINE READIN (IPROM,IPDIM,IPLENC,IALEN,EOFF)
C PURPOSE : GET A STRING FROM THE USER, BASED ON IALEN SEE WHETHER
C           THEY WANT A4 FORMAT OR A1 FORMAT
C*********************************************************************
      COMMON /FSBUFF/ NPROML, NPROMT(20), NREAD(13),
     *     NHEAD(20,12), NCOUNT, NWORK(20,200)
      COMMON /CHARS/ KZA,KZB,KZC,KZD,KZE,KZF,KZG,KZH,KZI,KZJ,KZK,KZL,KZM
     *     ,KZN,KZO,KZP,KZQ,KZR,KZS,KZT,KZU,KZV,KZW,KZX,KZY,KZZ,ICRDOT,
     *     ICRPLS,ICRCRH,ICRSTR,ICRMIN,ICRZER,KZ1,KZ2,KZ3,KZ4,KZ5,KZ6,
     *     KZ7,KZ8,KZ9,ICRBLK
      COMMON /PADDED/ IPAD1(9),ICHART(8,8),IPAD2(9),IPLNET(8,8),
     *     IKY(8,8),INPUT(50),IPAD3
      COMMON /CPU/ IBMT
      COMMON /Z3270/ IF12(13), IF50(50)
      DIMENSION IPROM(IPDIM)
      CALL DBUGIN ('READIN ENTERED',IW(14),0)
      EOFF = 0.0
      IF (IBMT.EQ.1) GO TO 100
      CALL PRMSG (IPROM,IW(IPDIM*4))
      CALL PRMSG ('?   ',IW(4))
      IF (IALEN.NE.1) GO TO 30
      READ (5,10000,END=40) (INPUT(N),N=1,50)
C     --- KLUDGE BELOW TO GET AROUND CHEAP FORTRAN COMPILER BUG
C         NOT BEING TO HANDLE INPUT PROPERLY
      N = 50
10    IF (INPUT(N).NE.ICRBLK) GO TO 20
      N = N - 1
      GO TO 10
20    IF (INPUT(N).EQ.ICRMIN) INPUT(N) = ICRBLK
C     --- END OF KLUDGE (REMOVE IF NOT NEEDED)
      CALL DBUGCH('READIN-50A1',IW(11),INPUT,50)
      GO TO 150
30    READ (5,10010,END=40) (INPUT(N),N=1,12)
      CALL DBUGCH('READIN-12A4',IW(11),INPUT,12)
      GO TO 150
40    EOFF = 1.0
      GO TO 150
100   DO 110 N=1, IPDIM
          NPROMT(N) = IPROM(N)
110   CONTINUE
      NPROML = IPLENC
      CALL XFILLB
      CALL FSIO1
      IF (IALEN.NE.1) GO TO 130
      DO 120 N=1, 50
          INPUT(N) = IF50(N)
120   CONTINUE
      CALL DBUGCH('READIN-50A1',IW(11),INPUT,50)
      GO TO 150
130   DO 140 N=1, 12
          INPUT(N) = IF12(N)
140   CONTINUE
      CALL DBUGCH('READIN-12A4',IW(11),INPUT,12)
150   CALL DBUGIN ('READIN EXITED',IW(13),0)
      RETURN
10000 FORMAT (50A1)
10010 FORMAT (12A4)
      END
./     ADD     NAME=REPAIR
C*********************************************************************
      SUBROUTINE REPAIR (TME)
C PURPOSE : BASED ON THE TIME USED UP, REPAIR BROKEN DEVICES ON
C           THE SHIP
C*********************************************************************
      COMMON /DEVICE/ XCDC,XSRDC,XIEDC,XLRDC,XWEDC,XDSDC,XSSDC,XPTDC
      COMMON /INFO/ ICOND(2),ENERGY,ISHUPD,ISHENG,IAPDEV,IPOF,IOVER
      DIMENSION DEV(8)
      EQUIVALENCE (DEV(1),XCDC)
      CHARACTER *4 CZDAMG , CZDOWN
      EQUIVALENCE (CZDAMG,IZDAMG) , (CZDOWN,IZDOWN)
      DATA CZDAMG /'DAMG'/ , CZDOWN /'DOWN'/
      CALL DBUGIN ('REPAIR ENTERED',IW(14),0)
      CALL CORAND (TME)
      DO 10 N = 1, 8
           DEV(N) = DEV(N)-TME
           IF (DEV(N).GT..0009999) GO TO 10
           DEV(N) = 0.0
10    CONTINUE
      IF (XDSDC.LE.0.001.AND.ISHUPD.EQ.IZDAMG) ISHUPD = IZDOWN
      CALL DBUGIN ('REPAIR EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=RESORT
C*********************************************************************
      SUBROUTINE RESORT (IARX,IARY,IACX,IACY,ILEN)
C PURPOSE : CHANGE THE ORDER IN WHICH INCOMING FEDERATION FIRE IS
C           RECEIVED SO USER CANNOT GUESS WHICH SHIP WILL FIRE FIRST
C           (SO IT IS MORE LIKE REAL BATTLE "FIRE AT WILL")
C*********************************************************************
      DIMENSION IARX(9),IARY(9),IACX(9),IACY(9)
      CALL DBUGIN ('RESORT ENTERED',IW(14),0)
      IR = RAND(FLOAT(ILEN))+1.0
      ICP = 1
      DO 10 N = IR, ILEN
           IACX(ICP) = IARX(N)
           IACY(ICP) = IARY(N)
           ICP = ICP+1
10    CONTINUE
      IF (IR.EQ.1) GO TO 30
      IR = IR-1
      DO 20 N = 1, IR
           IACX(ICP) = IARX(N)
           IACY(ICP) = IARY(N)
           ICP = ICP+1
20    CONTINUE
30    CALL DBUGIN ('RESORT EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=SCAN
C*********************************************************************
      SUBROUTINE SCAN (IN)
C PURPOSE : IF A QUADRANT HAS A SUPERNOVA IN IT, MAKE SURE THAT
C           "GHOST" SHIPS ARE NOT GENERATED
C           (RESET THOSE COUNTERS TO ZERO)
C*********************************************************************
      COMMON /HURT/ NOCALL,IPLENG,IPBASE,IFED2,ICOMM2
      CALL DBUGIN ('SCAN ENTERED',IW(12),0)
      ICOMM2 = IN/1000
      IFED2 = MOD(IN/100,10)
      IF (IN.NE.9999) GO TO 10
      ICOMM2 = 0
      IFED2 = 0
10    CALL DBUGIN ('SCAN EXITED',IW(11),0)
      RETURN
      END
./     ADD     NAME=SCORE
C*********************************************************************
      SUBROUTINE SCORE (REMAIN)
C PURPOSE : DISPLAY THE USER'S SCORE BASED ON WHAT THEY KILLED
C*********************************************************************
      COMMON /TRACOM/ TARX,TARY,ISCPX2,ISCPY2,NSECE(10,10),IHIT,ISBC,
     *     IFSC,IKCC,ITORCT,ISB,IFS,IKC,IPR,ISCPX1,ISCPY1,ICHC,IPLC,ISTC
     *     ,ET,ISECT(10,10),TVX,TVY,ICMC
      COMMON /MISC/ BATTER,ISSAVE,IDUM,WFACT,IDATF,ILEV,CSDATE,TGIVEN
      COMMON /EXTRA/ N2,ITTY,IDIE
      CALL DBUGIN ('SCORE ENTERED',IW(13),0)
      CALL LINEF
      CALL PRMSG ('YOUR SCORE:',IW(11))
      CALL LINEF
      ISCORE = 0
      IF (IKCC.EQ.0) GO TO 100
      IKCCS = -75*IKCC
      CALL PRSC (IKCC,'COMMANDERS DESTROYED',20,IW(20),IKCCS)
      ISCORE = ISCORE+IKCCS
100   IF (IFSC.EQ.0) GO TO 110
      IFSCS = IFSC*100
      CALL PRSC (
     *  IFSC,'FEDERATION STARSHIPS DESTROYED ',31,IW(31),IFSCS)
      ISCORE = ISCORE+IFSCS
110   IF (ISBC.EQ.0) GO TO 120
      ISBCS = ISBC*200
      CALL PRSC (
     *  ISBC,'FEDERATION STARBASES DESTROYED ',31,IW(31),ISBCS)
      ISCORE = ISCORE+ISBCS
120   IF (IPLC.EQ.0) GO TO 130
      IPLCS = IPLC/3
      CALL PRMIM (
     *  'SCORE FOR PLANETS DESTROYED                       ',
     *  50,IW(50),IPLCS,' ',0,1)
      ISCORE = ISCORE+IPLCS
130   IF (IDIE.EQ.1) GO TO 140
      TBONUS = REMAIN*2000.0
      IT = IFIX(TBONUS)
      IT2 = ILEV*10000
      ISCORE = ISCORE+IT+IT2
      CALL PRMIM (
     *  'TIME BONUS                                        ',
     *     50,IW(50),IT,' ',0,1)
      CALL PRMIM (
     *  'WIN BONUS                                         ',
     *     50,IW(50),IT2,' ',0,1)
      GO TO 150
140   ISCORE = ISCORE-1000
      IP = -1000
      CALL PRMIM (
     *  'PENALTY FOR LOSING YOUR SHIP AND DYING            ',
     *     50,IW(50),IP,' ',0,1)
150   CALL LINEF
      CALL PRMIM (
     *  'YOUR SCORE                                        ',
     *     50,IW(50),ISCORE,' ',0,1)
      CALL LINEF
      CALL LINEF
      CALL DBUGIN ('SCORE EXITED',IW(12),0)
      RETURN
      END
./     ADD     NAME=SECSET
C*********************************************************************
      SUBROUTINE SECSET
C PURPOSE : AT ENTRY TO SECTOR, CREATE THE MAP OF THE SECTOR FOR
C           THE PLAYER
C*********************************************************************
      DIMENSION ISECDT(100),NSEC(100),IC2(7),NUMS(7)
      DIMENSION ISECCY(100),ICLIST(5),NLIST(5)
      COMMON /NUMBER/ NSTARS,NPLNTS,NSBASE,NFED,NCOMM,NFX(9),NFY(9),NCX(
     *     9),NCY(9)
      COMMON /TRACOM/ TARX,TARY,ISCPX2,ISCPY2,NSECE(10,10),IHIT,ISBC,
     *     IFSC,IKCC,ITORCT,ISB,IFS,IKC,IPR,ISCPX1,ISCPY1,ICHC,IPLC,ISTC
     *     ,ET,ISECT(10,10),TVX,TVY,ICMC
      COMMON /PADDED/ IPAD1(9),ICHART(8,8),IPAD2(9),IPLNET(8,8),
     *     IKY(8,8),INPUT(50),IPAD3
      COMMON /INFO/ ICOND(2),ENERGY,ISHUPD,ISHENG,IAPDEV,IPOF,IOVER
      COMMON /HURT/ NOCALL,IPLENG,IPBASE,IFED2,ICOMM2
      EQUIVALENCE (ISECCY(1),ISECT(1,1)) , (NLIST(1),NSTARS) , (NSEC(1),
     *     NSECE(1,1)) , (ISECDT(1),ISECT(1,1))
      CHARACTER *4 CZIC2(7) , CZLIST(5) , CZRDOT
      EQUIVALENCE (CZIC2,IC2) , (CZLIST,ICLIST) , (CZRDOT,ICRDOT)
      DATA CZIC2 /'*','S','#','C','F','P','B'/
      DATA NUMS / -200000000,100000000,-99999999,-5800,0,0,0 /
      DATA CZLIST /'*','P','B','F','C'/
      DATA CZRDOT /'.'/
      CALL DBUGIN ('SECSET ENTERED',IW(14),0)
      NUMS(7) = ISBSET(DUMMY)
      DO 10 N1 = 1, 100
           ISECCY(N1) = ICRDOT
10    CONTINUE
      IX1 = (ISCPY2-1)*10+ISCPX2
      ISECCY(IX1) = IC2(2)
      DO 40 N = 1, 5
           IF (NLIST(N).EQ.0) GO TO 40
           J = NLIST(N)
           DO 30 NX = 1, J
20              IXX = IFIX(RAND(100.0)+1.0)
                IF (ISECCY(IXX).NE.ICRDOT) GO TO 20
                ISECCY(IXX) = ICLIST(N)
30         CONTINUE
40    CONTINUE
      IF (RAND(1.0).LE.0.6) GO TO 70
      NBH = RAND(3.0)+1.0
      DO 60 N4 = 1, NBH
50         IX1 = RAND(100.0)+1.0
           IF (ISECCY(IX1).NE.ICRDOT) GO TO 50
           ISECCY(IX1) = IC2(3)
60    CONTINUE
70    INPL = IPLNET(ISCPX1,ISCPY1)
      INPLC = INPL
      IF (INPLC.EQ.0) GO TO 80
      IPOP = 0
      IDIL = 0
      INPLC = INPLC/10
      NUMS(6) = -100000000
      IF (INPLC.GT.9999) IDIL = 1
      IPOP = INPLC
      IF (INPLC.GT.9999) IPOP = (INPLC-10000)
      IF (IPOP.GT.0) NUMS(6) = NUMS(6)-200000000
      IF (IPOP.GT.7000) NUMS(6) = NUMS(6)-100000000
      IF (IPOP.GT.0.AND.IDIL.EQ.1) NUMS(6) = NUMS(6)-100000000
      GO TO 90
80    NUMS(6) = 0
90    NUMS(5) = IFEDST(DUMMY)
      DO 120 N5 = 1, 100
           IF (ISECDT(N5).EQ.ICRDOT) GO TO 110
           DO 100 N6 = 1, 7
                IF (ISECDT(N5).NE.IC2(N6)) GO TO 100
                NSEC(N5) = NUMS(N6)
                GO TO 120
100        CONTINUE
110        NSEC(N5) = 0
120   CONTINUE
      IPLENG = NUMS(6)
      IPBASE = NUMS(7)
      IOVER = 0
      NOCALL = 0
      CALL SSPRNT (0)
      CALL BATTLE
      CALL DBUGIN ('SECSET EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=SENDEC
C*********************************************************************
      SUBROUTINE SENDEC (IPLVLD)
C PURPOSE : DISPLAY INFORMATION ABOUT A PLANET IN THE QUADRANT
C*********************************************************************
      COMMON /CHARS/ KZA,KZB,KZC,KZD,KZE,KZF,KZG,KZH,KZI,KZJ,KZK,KZL,KZM
     *     ,KZN,KZO,KZP,KZQ,KZR,KZS,KZT,KZU,KZV,KZW,KZX,KZY,KZZ,ICRDOT,
     *     ICRPLS,ICRCRH,ICRSTR,ICRMIN,ICRZER,KZ1,KZ2,KZ3,KZ4,KZ5,KZ6,
     *     KZ7,KZ8,KZ9,ICRBLK
      CALL DBUGIN ('SENDEC ENTERED',IW(14),0)
      IPLVAL = IPLVLD
      CALL LINEF
      IF (IPLVAL.EQ.0) GO TO 10
      CALL LOCATE (KZP,IIXP,IIYP)
      CALL PRMSM ('PLANET AT: ',11,IW(11),IIYP,IIXP,' ',0,1)
      POP = 0.0
      IPLVAL = IPLVAL/10
      IF (IPLVAL.GT.9999) POP = FLOAT(IPLVAL-10000)
      IF (IPLVAL.LE.9999) POP = FLOAT(IPLVAL)
      POP = POP/1000.0
      CALL PRMRM (
     *  'HAS A POPULATION OF ',20,IW(20),POP,'BILLION,',8,IW(8))
      IF (IPLVAL.GT.9999)
     *          CALL PRMSG ('AND HAS DILITHIUM CRYSTALS',IW(26))
      IF (IPLVAL.LE.9999)
     *          CALL PRMSG ('AND HAS NO DILITHIUM CRYSTALS',IW(29))
      GO TO 20
10    CALL PRMSG ('NO PLANET IN THIS QUADRANT',IW(26))
20    CALL DBUGIN ('SENDEC EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=SETFED
C*********************************************************************
      SUBROUTINE SETFED (LQX,LQY,LSX,LSY,NAME,ICAPTN,ITYPE,ISEQ,
     *                   IDNAME,IDCAPT,IDTYPE)
C PURPOSE : INIT THE INFO ABOUT SHIP NAMES AND CAPTAIN NAMES
C*********************************************************************
      COMMON /SHIPS/ IUSFED(15,13)
      DIMENSION NAME(IDNAME),ICAPTN(IDCAPT),ITYPE(IDTYPE)
      CALL DBUGIN ('SETFED ENTERED',IW(14),0)
      IUSFED (1,ISEQ) = LQX
      IUSFED (2,ISEQ) = LQY
      IUSFED (3,ISEQ) = LSX
      IUSFED (4,ISEQ) = LSY
      IUSFED (5,ISEQ) = NAME(1)
      IUSFED (6,ISEQ) = NAME(2)
      IUSFED (7,ISEQ) = NAME(3)
      IUSFED (8,ISEQ) = ICAPTN(1)
      IUSFED (9,ISEQ) = ICAPTN(2)
      IUSFED (10,ISEQ)= ICAPTN(3)
      IUSFED (11,ISEQ)= ICAPTN(4)
      IUSFED (12,ISEQ)= ICAPTN(5)
      IUSFED (13,ISEQ)= ITYPE(1)
      IUSFED (14,ISEQ)= ITYPE(2)
      IUSFED (15,ISEQ)= ITYPE(3)
      CALL DBUGIN ('SETFED EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=SETFOR
C*********************************************************************
      SUBROUTINE SETFOR (ILEN,IPOS1C,IPOS2C,IMX)
C PURPOSE : SET FORMAT STATEMENT FOR A GIVEN LENGTH STRING
C*********************************************************************
      DIMENSION IXA4(25),IAX(3)
      CHARACTER *4 CZIXA4(25) , CZIAX(3) , CZBLK , CZOLDR
      EQUIVALENCE (CZIXA4,IXA4) , (CZIAX,IAX) , (CZBLK,IBLK) ,
     *            (CZOLDR,IHOLDR)
      DATA CZIXA4 /'1A4','2A4','3A4','4A4','5A4','6A4',
     *     '7A4','8A4','9A4','10A4','11A4','12A4','13A4','14A4',
     *     '15A4','16A4','17A4','18A4','19A4','20A4','21A4','22A4',
     *     '23A4','24A4','25A4'/
      DATA CZIAX /',A1 ',',A2 ',',A3 '/
      DATA CZBLK /' '/ , CZOLDR /'1X'/
      IL = ILEN
      IPOS1 = IHOLDR
      IPOS2 = IBLK
      IMX = 0
      IF (IL.EQ.0) GO TO 20
      N = 0
      IF (IL.GE.4) N = IL / 4
      M = IL
      IF (N.NE.0) M = IL - (N * 4)
      IMX = 1
      IF (N.EQ.0) GO TO 10
      IF (N.GT.25) N = 25
      IPOS1 = IXA4(N)
      IMX = N
      IF (M.EQ.0) GO TO 20
      IMX = IMX + 1
10    IPOS2 = IAX(M)
20    IPOS1C = IPOS1
      IPOS2C = IPOS2
      RETURN
      END
./     ADD     NAME=SHECON
C*********************************************************************
      SUBROUTINE SHECON
C PURPOSE : AUTOMATIC SHIELD CONTROL TO RAISE AND LOWER SHIELDS
C*********************************************************************
      COMMON /INFO/ ICOND(2),ENERGY,ISHUPD,ISHENG,IAPDEV,IPOF,IOVER
      COMMON /TRACOM/ TARX,TARY,ISCPX2,ISCPY2,NSECE(10,10),IHIT,ISBC,
     *     IFSC,IKCC,ITORCT,ISB,IFS,IKC,IPR,ISCPX1,ISCPY1,ICHC,IPLC,ISTC
     *     ,ET,ISECT(10,10),TVX,TVY,ICMC
      COMMON /PADDED/ IPAD1(9),ICHART(8,8),IPAD2(9),IPLNET(8,8),
     *    IKY(8,8),INPUT(50),IPAD3
      COMMON /DEVICE/ XCDC,XSRDC,XIEDC,XLRDC,XWEDC,XDSDC,XSSDC,XPTDC
      CHARACTER *4 CZGRE , CZDOWN , CZRED , CZUP , CZDAMG
      EQUIVALENCE (CZGRE,IZGRE) , (CZDOWN,IZDOWN) , (CZRED,IZRED) ,
     *            (CZUP,IZUP) , (CZDAMG,IZDAMG)
      DATA CZGRE /'GREE'/ , CZDOWN /'DOWN'/
      DATA CZRED /'RED'/ , CZUP /'UP'/
      DATA CZDAMG /'DAMG'/
      CALL DBUGIN ('SHECON ENTERED',IW(14),0)
      IF (IOVER.NE.0) GO TO 100
      J = ICROG(ICHART(ISCPX1,ISCPY1))
      IF (J.EQ.IZGRE.AND.ISHUPD.EQ.IZDOWN) GO TO 100
      IF (J.EQ.IZRED.AND.ISHUPD.EQ.IZUP) GO TO 100
      CALL LINEF
      IF (J.EQ.IZGRE) GO TO 50
      CALL PRMSG ('ENTERING BATTLE ZONE - BATTLE STATIONS',IW(38))
      CALL ADDQUE ('REDB')
      IF (ISHUPD.EQ.IZDAMG.OR.ISHENG.EQ.0.OR.ENERGY.LT.50.0) GO TO 30
      IF (ISHENG.LT.1250) GO TO 40
      IF (ENERGY.LT.800.0) GO TO 40
10    CALL LINEF
      CALL PRMSG (
     *  'AUTOMATIC DEFLECTOR SHIELD CONTROL ACTIVATED',IW(44))
      CALL PRMSG ('SHIELDS RAISED.',IW(15))
      ENERGY = ENERGY-50.0
      ISHUPD = IZUP
      IOVER = 1
20    CALL LINEF
      GO TO 100
30    CALL PRMSG ('SHIELDS NOT CURRENTLY USABLE.',IW(29))
      IOVER = 1
      GO TO 20
40    CALL PRMRM ('CURRENT ENERGY = ',17,IW(17),ENERGY,' ',0,1)
      CALL PRMIM ('CURRENT SHIELD ENERGY = ',24,IW(24),
     *        ISHENG,' ',0,1)
      CALL YESNO ('DO YOU WISH TO RAISE SHIELDS',IW(28),28,IYES)
      IF (IYES.EQ.0) GO TO 20
      IF (IYES.EQ.1) GO TO 10
50    IF (ISHUPD.EQ.IZDAMG) GO TO 100
      CALL PRMSG (
     *  'AUTOMATIC DEFLECTOR SCREEN CONTROL ACTIVATING',IW(45))
      CALL PRMSG ('SHIELDS DROPPED.',IW(16))
      ISHUPD = IZDOWN
      GO TO 20
100   CALL DBUGIN ('SHECON EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=SHIFT
SHFT     TITLE '--- SHIFT - COMPUTE ALLOWED TIME ROUTINE ---'
SHIFT    START 0
*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*
* PURPOSE : ROUTINE SHIFT - COMPUTE ALLOWED TIME TO PLAY GAME       *
*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*
        YREGS
        SAVE   (14,12),,*          SAVE REGISTERS
         LR    R12,R15             ESTABLISH ADDRESSABILITY
         USING SHIFT,R12           WE GOT IT
         ST    R13,SAVEAREA+4      NON-RENT, NO BIG DEAL HERE
         LA    R15,SAVEAREA        SET FORWARD/BACKWORD POINTERS
         ST    R15,8(,R13)           " " "
         LA    R13,SAVEAREA          " " "
* 1) INIT THE COUNTERS FOR PROGRAM (AT LEAST MAKE PROGRAM "REUS")
         MVC   JULDAT,=C'000000'   DISPLAY ZERO
         MVC   GREGDAT,=C'000000'    " " "
         MVI   DAY,C'0'
* 2) CALL JULIAN ROUTINE TO GET DAY OF WEEK
         OI    PARMS+8,X'80'       FLIP ON VL BIT
         LA    R1,PARMS            SET UP CALL
         L     R15,=V(JULIAN)      AND THE JULIAN ROUTINE
         BALR  R14,R15             GO GET THE DATE/DAY
* 3) GET THE DAY OF THE WEEK
         SR    R3,R3               CLEAR REG FOR IC
         IC    R3,DAY              GET ONE BYTE DAY
         S     R3,=X'000000F0'     STRIP OFF FIRST NIBBLE
         LTR   R3,R3               CHECK RESULT
         BZ    OKSHIFT             IF DAY UNKNOWN, LET THEM GO
         BCTR  R3,0                SUBTRACT ONE
         LR    R4,R3               COPY VALUE
         MH    R4,=AL2($TABELEN)   AND NOW IT'S DISPLACEMENT
         L     R3,=V(SHIFTAB)      LOAD ADDRESS OF SHIFT TABLE
         L     R9,=V(INFOSH)       ADDRESS OF INFO SHIFT TABLE
         USING $DISPLAY,R9
         MVC   $DSTART,=CL8'00:00   '
         MVC   $DSTOP,=CL8'00:00   '
         LA    R3,0(R3,R4)         POINT AT ENTRY
         USING $TIMETAB,R3
         LH    R1,$STARTOK
         ST    R1,FWORD
         UNPK  DUMMY(9),FWORD(5)
         TR    DUMMY(8),TRANTAB
         MVC   $DSHOUR,DUMMY+4     FILL IN HOURS
         MVC   $DSMIN,DUMMY+6      AND MINUTES
         LH    R1,$STOPOK
         ST    R1,FWORD
         UNPK  DUMMY(9),FWORD(5)
         TR    DUMMY(8),TRANTAB
         MVC   $DPHOUR,DUMMY+4
         MVC   $DPMIN,DUMMY+6
         MVC   $ITYPE,$IFLAG
        TIME   DEC
         ST    R0,WORKTIME         SAVE THE TIME
         CLC   WORKTIME(2),$STARTOK IN OK TIME?
         BNH   OUTSHIFT            CURRENT TIME MUST BE > START
         CLC   WORKTIME(2),$STOPOK BEFORE STOP TIME?
         BH    OUTSHIFT            CUREENT TIME MUST BE < STOP
OKSHIFT  CLC   $IFLAG,=C'EXCL'     IS EXCLUDE FLAG SET
         BE    SETOUT              OVERRIDE OK, HE'S INSIDE EXCL
SETOK    L     R1,=V(SHIFTF)       COMMON TO RETURN SHIFT IN
         MVC   0(4,R1),=F'1'       MUST BE OK SET TO ONE
         B     QUIT
OUTSHIFT CLC   $IFLAG,=C'EXCL'     IS EXCLUDE FLAG SET
         BE    SETOK               IF SO, OVERRIDE OUTSHIFT
SETOUT   L     R1,=V(SHIFTF)       COMMON TO RETURN SHIFT IN
         XC    0(4,R1),0(R1)       SET ZERO
* 9) RESTORE REGS AND RETURN
QUIT     L     R13,SAVEAREA+4      GET ORIGINAL REGISTER 13
        RETURN (14,12),T,RC=0      RESTORE REGISTERS AND RETURN ...
         EJECT
*------- WORK AREAS (NON-RENT CODE)
SAVEAREA DC    9D'0'               REGISTERS SAVE AREA
JULDAT   DC    CL5' '              USAGE IS DISPLAY
GREGDAT  DC    CL6' '              USAGE IS DISPLAY
DAY      DC    CL1' '              USAGE IS DISPLAY
PARMS    DC    A(JULDAT,GREGDAT,DAY)
WORKTIME DC    A(0)
TRANTAB  DC    CL(X'F0')' '
         DC    C'0123456789ABCDEF'
FWORD    DC    F'0',CL1' '
DUMMY    DC    CL9' '
         SPACE 1
        LTORG
         SPACE 1
$TIMETAB DSECT
$STARTOK DS    XL2
$STOPOK  DS    XL2
$IFLAG   DS    CL4
$TABELEN EQU   *-$STARTOK
$WHOLET  EQU   $TABELEN*7
         SPACE 1
$DISPLAY DSECT
$DSTART  DS    0CL8
$DSHOUR  DS    CL2
$C1      DS    CL1
$DSMIN   DS    CL2
$FILL1   DS    CL3
$DSTOP   DS    0CL8
$DPHOUR  DS    CL2
$C2      DS    CL1
$DPMIN   DS    CL2
$FILL2   DS    CL3
$ITYPE   DS    CL4
         SPACE 1
         END
./     ADD     NAME=SHIFTAB
SHTB     TITLE '--- SHIFTAB - INIT VARIABLES FOR GRAPHICS ROUTINE ---'
SHIFTAB  START 0
*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*
* PURPOSE : SHIFT TABLE DATA CSECT                                  *
*           INSTRUCTIONS FOR CODING AND USE :                       *
*           THERE ARE SEVEN ENTRIES BELOW, ONE FOR EACH DAY OF THE  *
*           WEEK (SUNDAY IS ALWAYS FIRST AND THE LABEL IS FOR       *
*                DOCUMENTATION ONLY)                                *
*           THE FORMAT OF EACH TABLE ENTRY :                        *
*                FIRST TWO BYTES = HEX FORM HOUR AND MINUTE         *
*                    (EXAMPLE X'1200'=NOON)                         *
*                    FOR THE START TIME FOR THE "SHIFT" TODAY       *
*                SECOND TWO BYTES = HEX FORM "HHMM" FOR THE STOP    *
*                    TIME FOR THE "SHIFT" TODAY                     *
*                +4 BYTES, LENGTH 4 = MODIFIER FOR THE SHIFT,       *
*                    "INCL" MEANS THE GIVEN SHIFT IS THE SHIFT IN   *
*                           WHICH PLAY IS ALLOWED.                  *
*                    "EXCL" MEANS THIS IS THE SHIFT IN WHICH PLAY   *
*                           IS *NOT* ALLOWED.                       *
*           EXAMPLES :                                              *
*           =========                                               *
*           SUN  DC  XL2'0000',XL2'2400',C'INCL'                    *
*                = ALLOW PLAY ALL DAY                               *
*           MON  DC  XL2'0000',XL2'2400',C'EXCL'                    *
*                = PREVENT PLAY ALL DAY                             *
*           TUE  DC  XL2'0800',XL2'1700',C'ECXL'                    *
*                = PREVENT PLAY FROM 8 TO 5                         *
*           THE SUPPLIED DEFAULT IS ALLOW PLAY ALL THE TIME.        *
*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*
         SPACE 1
SUN      DC  XL2'0000',XL2'2400',C'INCL'     MIDNIGHT TO 2400
MON      DC  XL2'0000',XL2'2400',C'INCL'     MIDNIGHT TO 2400
TUE      DC  XL2'0000',XL2'2400',C'INCL'     MIDNIGHT TO 2400
WED      DC  XL2'0000',XL2'2400',C'INCL'     MIDNIGHT TO 2400
THU      DC  XL2'0000',XL2'2400',C'INCL'     MIDNIGHT TO 2400
FRI      DC  XL2'0000',XL2'2400',C'INCL'     MIDNIGHT TO 2400
SAT      DC  XL2'0000',XL2'2400',C'INCL'     MIDNIGHT TO 2400
         DC  XL2'FFFF',XL2'FFFF',C'    '     END OF TABLE
         SPACE 1
         END
./     ADD     NAME=SHIFTC
C*********************************************************************
      SUBROUTINE SHIFTC (IFLAG)
C PURPOSE : CHECK THE SHIFT TO SEE IF A PLAYER CAN PLAY DURING
C           THIS TIME
C*********************************************************************
      COMMON /SHIFTF/ ISHIFT
      COMMON /OUTUNT/ IOUTT
      COMMON /INFOSH/ ISTART(2), ISTOP(2), IXC
      CALL DBUGIN ('SHIFTC ENTERED',IW(14),0)
      CALL SHIFT
      IF (ISHIFT.EQ.1) GO TO 100
      CALL LINEF
      CALL PRMSG ('YOU ARE NOT IN THE ALLOWED SHIFT ',IW(33))
      CALL PRMSG ('TRY AGAIN NON-PRIME TIME.        ',IW(33))
      CALL LINEF
      CALL LINEF
      CALL PRMSG
     * ('VALID HOURS FOR TODAY  INCL=INCLUSIVE,EXCL=EXCLUSIVE ',IW(52))
      CALL LINEF
      CALL PRMSG ('START TIME:',IW(11))
      CALL PRMSG (ISTART,IW(8))
      CALL LINEF
      CALL PRMSG ('STOP  TIME:',IW(11))
      CALL PRMSG (ISTOP,IW(8))
      CALL LINEF
      CALL PRMSG (IXC,IW(4))
      CALL LINEF
100   IFLAG = ISHIFT
      CALL DBUGIN ('SHIFTC EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=SHIP
C*********************************************************************
      SUBROUTINE SHIP
C PURPOSE : WRITE A PRETTY KLINGON SHIP TO THE CERTIFICATE FILE
C*********************************************************************
      CALL DBUGIN ('SHIP ENTERED',IW(12),0)
      WRITE (8,10000)
      WRITE (8,10010)
      WRITE (8,10020)
      WRITE (8,10030)
      WRITE (8,10040)
      WRITE (8,10050)
      WRITE (8,10060)
      WRITE (8,10070)
      WRITE (8,10080)
      WRITE (8,10090)
      WRITE (8,10090)
      WRITE (8,10080)
      CALL DBUGIN ('SHIP EXITED',IW(11),0)
      RETURN
10000 FORMAT (3X,7X,'*****************')
10010 FORMAT (3X,4X,'**********************',42X,'*****')
10020 FORMAT (3X,1X,'***********************',40X,'***********')
10030 FORMAT (3X,4X,'********',
     *12X,'*********************************',
     *'*******           *')
10040 FORMAT (3X,10X,'*',13X,'*********************************',
     *19X,'*')
10050 FORMAT (3X,9X,'**************',34X,'******',13X,'*')
10060 FORMAT (3X,11X,'*',11X,'*',39X,'*******',5X,'*')
10070 FORMAT (3X,13X,'*',10X,'*',45X,'*****')
10080 FORMAT (3X,5X,'***********************')
10090 FORMAT (3X,5X,'*',22X,'*')
      END
./     ADD     NAME=SRS
C*********************************************************************
      SUBROUTINE SRS
C PURPOSE : CHECK FOR SRSCAN PARMS AND ISSUE THE CALLS
C           THIS ROUTINE WILL *NOT* BE CALLED IF CPU=1 (TSO)
C*********************************************************************
      COMMON /PADDED/ IPAD1(9),ICHART(8,8),IPAD2(9),IPLNET(8,8),
     *    IKY(8,8), INPUT(50),IPAD3
      COMMON /DEVICE/ XCDC,XSRDC,XIEDC,XLRDC,XWEDC,XDSDC,XSSDC,XPTDC
      COMMON /EXTRA/ N2,ITTY,IDIE
      COMMON /SRCOPY/ ISCOP(10,10)
      COMMON /MISC/ BATTER,ISSAVE,IDUM,WFACT,IDATF,ILEV,CSDATE,TGIVEN
      COMMON /TRACOM/ TARX,TARY,ISCPX2,ISCPY2,NSECE(10,10),IHIT,ISBC,
     * IFSC,IKCC,ITORCT,ISB,IFS,IKC,IPR,ISCPX1,ISCPY1,ICHC,IPLC,ISTC,
     * ET,ISECT(10,10),TVX,TVY,ICMC
      CALL DBUGIN ('SRS ENTERED',IW(11),0)
      IF (XSSDC.GT.0.001) GO TO 470
      IKY(ISCPX1,ISCPY1) = 1
      CALL BRIDGE (N2)
      IF (N2.GT.50) GO TO 440
      CALL SRSCAN (0,1,ISECT)
      GO TO 450
440   CALL SRSCAN (1,1,ISECT)
450   DO 460 J = 1, 10
           DO 460 I = 1, 10
                ISCOP(I,J) = ISECT(I,J)
460   CONTINUE
      ISSAVE = 1
      GO TO 150
470   CALL PRMSG ('SHORT RANGE SCANNERS NON-OPERATIONAL  ',IW(36))
      CALL LINEF
      IF (ISSAVE.NE.1) GO TO 150
      CALL PRMSG ('***** COPY OF LAST SHORT RANGE SCAN *****',IW(41))
      CALL SRSCAN (0,1,ISCOP)
      GO TO 150
150   CALL DBUGIN ('SRS EXITED',IW(10),0)
      RETURN
      END
./     ADD     NAME=SRSCAN
C*********************************************************************
      SUBROUTINE SRSCAN (ISTAT,ISRS,ISCAN)
C PURPOSE : DISPLAY FORMATED INFORMATION ABOUT THE QUADRANT WE ARE IN
C           IF ISTAT = -1 AND ISCAN = -1 THEN THIS IS "COPY" OF
C           LAST SRS
C*********************************************************************
      COMMON /DEVICE/ XCDC,XSRDC,XIEDC,XLRDC,XWEDC,XDSDC,XSSDC,XPTDC
      COMMON /TRACOM/ TARX,TARY,ISCPX2,ISCPY2,NSECE(10,10),IHIT,ISBC,
     *     IFSC,IKCC,ITORCT,ISB,IFS,IKC,IPR,ISCPX1,ISCPY1,ICHC,IPLC,ISTC
     *     ,ET,ISECT(10,10),TVX,TVY,ICMC
      COMMON /INFO/ ICOND(2),ENERGY,ISHUPD,ISHENG,IAPDEV,IPOF,IOVER
      COMMON /MISC/ BATTER,ISSAVE,IDUM,WFACT,IDATF,ILEV,CSDATE,TGIVEN
      COMMON /CPU/ IBMT
      COMMON /OUTUNT/ IOUTT
      DIMENSION ISCAN(10,10)
      DIMENSION IAPIND(2),IPTZ(2),IZARM(2), IZREAD(2),IZDAMG(2)
      DATA IYES /1/
      CHARACTER *4 CZBLK , CZOFF , CZOUT , CZARM(2) , CZREAD(2) ,
     *             CZDAMG(2)
      EQUIVALENCE (CZBLK,IBLK) , (CZOFF,IZOFF) , (CZOUT,IZOUT) ,
     *            (CZARM,IZARM) , (CZREAD,IZREAD) , (CZDAMG,IZDAMG)
      DATA CZBLK /' '/ , CZOFF /'OFF'/ , CZOUT /'OUT'/
      DATA CZARM /'ARME','D'/
      DATA CZREAD /'READ','Y'/
      DATA CZDAMG /'DAMA','GED'/
      CALL DBUGIN ('SRSCAN ENTERED',IW(14),0)
      NSDAM = 0
      IF (IBMT.EQ.0) CALL LINEF
      IOUT = IOUTT
      IF (IBMT.EQ.1) IOUT = IOUT - 1
      IPTZ(1) = IZREAD(1)
      IPTZ(2) = IZREAD(2)
      IF (XPTDC.LE.0.001) GO TO 5
      IPTZ(1) = IZDAMG(1)
      IPTZ(2) = IZDAMG(2)
5     IF (ITORCT.NE.0) GO TO 6
      IPTZ(1) = IZOUT
      IPTZ(2) = IBLK
6     REMAIN = TGIVEN-CSDATE
      IAPIND(1) = IZARM(1)
      IAPIND(2) = IZARM(2)
      IF (IAPDEV.EQ.1) GO TO 7
      IAPIND(1) = IZOFF
      IAPIND(2) = IBLK
7     ISHPCT = IFIX(FLOAT(ISHENG)/25.0)
      IF (ISTAT.NE.-1.OR.ISRS.NE.-1) GO TO 8
      NSDAM = IYES
      GO TO 30
8     IF (ISTAT.EQ.IYES.AND.ISRS.EQ.IYES) GO TO 30
      IF (ISTAT.NE.IYES.AND.ISRS.EQ.IYES) GO TO 20
      IF (ISTAT.EQ.IYES.AND.ISRS.NE.IYES) GO TO 10
      GO TO 30
C     --- STATUS ONLY AT THIS POINT
10    WRITE (IOUT,10010)
     *     ITORCT,IPTZ,ISCPY1,ISCPX1,ISCPY2,ISCPX2,CSDATE,
     *     REMAIN,ICOND,IAPIND,ENERGY,ISHUPD,ISHPCT,ISHENG,WFACT,ISB,IFS
     *     ,IKC
      GO TO 40
C     --- SHORT FORM SRS
20    WRITE (IOUT,10000)
      WRITE (IOUT,10020) ((ISCAN(J,I),J=1,10),I=1,10)
      GO TO 40
C     --- LONG FORM SRS
30    WRITE (IOUT,10000)
      WRITE (IOUT,10030)
     *      (ISCAN(J,1),J=1,10),ITORCT,IPTZ,(ISCAN(J,2),J=1,10),
     *     ISCPY1,ISCPX1,ISCPY2,ISCPX2,(ISCAN(J,3),J=1,10),CSDATE,
     *     (ISCAN(J,4),J=1,10),REMAIN,(ISCAN(J,5),J=1,10),ICOND,IAPIND,
     *    (ISCAN(J,6),J=1,10),ENERGY,(ISCAN(J,7),J=1,10),ISHUPD,ISHPCT,
     *     ISHENG,(ISCAN(J,8),J=1,10),WFACT,(ISCAN(J,9),J=1,10),ISB,IFS,
     *     (ISCAN(J,10),J=1,10),IKC
      IF (NSDAM.EQ.IYES) WRITE (IOUT,10040)
      WRITE (IOUT,10050)
40    CALL DBUGIN ('SRSCAN EXITED',IW(13),0)
      RETURN
10000 FORMAT (1X,'   1 2 3 4 5 6 7 8 9 10 ')
10010 FORMAT (2X,'TORPEDOES',4X,I3,2X,'CONDITION:',2X,
     * A4,A3/ 2X,'POSITION',4X,I2,' - ',I2,',',I2,
     *' - ',I2/2X,'STARDATE',3X,F8.2/
     * 2X,'REMAINING',3X,F8.2/2X,'CONDITION',3X,2A4,
     * '  A.P.D. ',A4,A1/2X,'ENERGY',6X,F9.2/
     * 2X,'SHIELDS',6X,A4,2X,I3,' PCT ',I5,' UNTS'/
     * 2X,'WARP FACTOR ',F6.2/2X,
     * 'FEDERATION BASES ',I2,'  STARSHIPS ',I2/2X,
     * 'COMMANDERS   ',I2//)
10020 FORMAT (' 1  ',10(A1,1X)
     * / ' 2  ',10(A1,1X)/
     * ' 3  ',10(A1,1X)/' 4  ',10(A1,1X)/
     * ' 5  ',10(A1,1X)/
     * ' 6  ',10(A1,1X)/' 7  ',10(A1,1X)/
     * ' 8  ',10(A1,1X)/' 9  ',10(A1,1X)/
     * ' 10 ',10(A1,1X))
10030 FORMAT (' 1  ',10(A1,1X),2X,'TORPEDOES',4X,I3,2X,'CONDITION:',2X,
     * A4,A3/ ' 2  ',10(A1,1X),2X,'POSITION',4X,I2,' - ',I2,',',I2,
     *' - ',I2/' 3  ',10(A1,1X),2X,'STARDATE',3X,F8.2/' 4  ',10(A1,1X),
     * 2X,'REMAINING',3X,F8.2/' 5  ',10(A1,1X),2X,'CONDITION',3X,2A4,
     * '  A.P.D. ',A4,A1/' 6  ',10(A1,1X),2X,'ENERGY',6X,F9.2/' 7  ',
     * 10(A1,1X),2X,'SHIELDS',6X,A4,2X,I3,' PCT ',I5,' UNTS'/' 8  ',
     * 10(A1,1X),2X,'WARP FACTOR ',F6.2/' 9  ',10(A1,1X),2X,
     * 'FEDERATION BASES ',I2,'  STARSHIPS ',I2/' 10 ',10(A1,1X),2X,
     * 'COMMANDERS   ',I2)
10040 FORMAT
     *(' +++ SCANNERS DAMAGED, COPY OF LAST SCAN *** (STATUS CURRENT)')
10050 FORMAT (//)
      END
./     ADD     NAME=SR3270
C*********************************************************************
      SUBROUTINE SR3270
C PURPOSE : SET UP CALL TO SRSCAN ROUTINE FOR 3270 TSO TERM
C           THIS ROUTINE WILL ONLY BE CALLED IF CPU=1 (TSO)
C*********************************************************************
      COMMON /PADDED/ IPAD1(9),ICHART(8,8),IPAD2(9),IPLNET(8,8),
     *    IKY(8,8), INPUT(50),IPAD3
      COMMON /DEVICE/ XCDC,XSRDC,XIEDC,XLRDC,XWEDC,XDSDC,XSSDC,XPTDC
      COMMON /EXTRA/ N2,ITTY,IDIE
      COMMON /SRCOPY/ ISCOP(10,10)
      COMMON /MISC/ BATTER,ISSAVE,IDUM,WFACT,IDATF,ILEV,CSDATE,TGIVEN
      COMMON /TRACOM/ TARX,TARY,ISCPX2,ISCPY2,NSECE(10,10),IHIT,ISBC,
     * IFSC,IKCC,ITORCT,ISB,IFS,IKC,IPR,ISCPX1,ISCPY1,ICHC,IPLC,ISTC,
     * ET,ISECT(10,10),TVX,TVY,ICMC
      CALL DBUGIN ('SR3270 ENTERED',IW(14),0)
      IF (XSSDC.GT.0.001) GO TO 470
      IKY(ISCPX1,ISCPY1) = 1
      CALL SRSCAN (1,1,ISECT)
      DO 460 J = 1, 10
           DO 460 I = 1, 10
                ISCOP(I,J) = ISECT(I,J)
460   CONTINUE
      GO TO 150
470   CALL SRSCAN (-1,-1,ISCOP)
150   CALL DBUGIN ('SR3270 EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=SSDEST
C*********************************************************************
      SUBROUTINE SSDEST (ISHIPS,IQX,IQY,ISX,ISY,INAME)
C PURPOSE : GET NAME OF DESTROYED FEDERATION STARSHIP, AND MARK
C           THE SHIP "DESTROYED" (POSITION ZERO)
C*********************************************************************
      DIMENSION ISHIPS(15,13)
      DIMENSION INAME(3)
      CALL DBUGIN ('SSDEST ENTERED',IW(14),0)
      CALL SSFIND (ISHIPS,IQX,IQY,ISX,ISY,NDX)
      ISHIPS(1,NDX) = 0
      ISHIPS(2,NDX) = 0
      ISHIPS(3,NDX) = 0
      ISHIPS(4,NDX) = 0
      INAME(1) = ISHIPS(5,NDX)
      INAME(2) = ISHIPS(6,NDX)
      INAME(3) = ISHIPS(7,NDX)
      CALL DBUGIN ('SSDEST EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=SSFIND
C*********************************************************************
      SUBROUTINE SSFIND (ISHIPS,LQX,LQY,LSX,LSY,NDXR)
C PURPOSE : LOCATE A SHIP IN THE SHIPS VECTOR GIVEN IT'S POSITION
C*********************************************************************
      DIMENSION ISHIPS(15,13)
      CALL DBUGIN ('SSFIND ENTERED',IW(14),0)
      NDX = 1
10    IF (NDX.GT.13.OR.(ISHIPS(1,NDX).EQ.LQX.AND.ISHIPS(2,NDX).EQ.
     *     LQY.AND.ISHIPS(3,NDX).EQ.LSX.AND.ISHIPS(4,NDX).EQ.LSY))
     *                                                  GO TO 20
      NDX = NDX+1
      GO TO 10
20    IF (NDX.LE.13) GO TO 30
      CALL PRMSG ('PLEASE REPORT ERROR 02 IN SSFIND  ',IW(34))
      CALL PRMSG ('CALLING FREEZE TO SAVE DATA',IW(29))
      CALL FREEZE
      NDX = 1
30    NDXR = NDX
      CALL DBUGIN ('SSFIND EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=SSINIT
C*********************************************************************
      SUBROUTINE SSINIT (ISHIPS,IQX,IQY)
C PURPOSE : INITIALIZE THE QUADRANT POSITION FOR A FEDERATION STARSHIP
C*********************************************************************
      DIMENSION ISHIPS(15,13)
      CALL DBUGIN ('SSINIT ENTERED',IW(14),0)
      CALL SSFIND (ISHIPS,0,0,0,0,NDX)
      ISHIPS(1,NDX) = IQX
      ISHIPS(2,NDX) = IQY
      CALL DBUGIN ('SSINIT EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=SSMOVI
C*********************************************************************
      SUBROUTINE SSMOVI (ISHIPS,IQX,IQY,ISX,ISY,NQX,NQY,INAME,IPILOT,
     *     ITYPE)
C PURPOSE : MOVE A FEDERATION STARSHIP FROM OUTSIDE THE QUADRANT
C           TO INSIDE IT
C*********************************************************************
      DIMENSION ISHIPS(15,13),IPILOT(5)
      DIMENSION INAME(3), ITYPE(3)
      CALL DBUGIN ('SSMOVI ENTERED',IW(14),0)
      CALL SSFIND (ISHIPS,NQX,NQY,0,0,NDX)
      ISHIPS(1,NDX) = IQX
      ISHIPS(2,NDX) = IQY
      ISHIPS(3,NDX) = ISX
      ISHIPS(4,NDX) = ISY
      INAME(1) = ISHIPS(5,NDX)
      INAME(2) = ISHIPS(6,NDX)
      INAME(3) = ISHIPS(7,NDX)
      IPILOT(1) = ISHIPS(8,NDX)
      IPILOT(2) = ISHIPS(9,NDX)
      IPILOT(3) = ISHIPS(10,NDX)
      IPILOT(4) = ISHIPS(11,NDX)
      IPILOT(5) = ISHIPS(12,NDX)
      ITYPE(1) = ISHIPS(13,NDX)
      ITYPE(2) = ISHIPS(14,NDX)
      ITYPE(3) = ISHIPS(15,NDX)
      CALL DBUGIN ('SSMOVI EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=SSMOVO
C*********************************************************************
      SUBROUTINE SSMOVO (ISHIPS,IQX,IQY,ISX,ISY,NQX,NQY,INAME)
C PURPOSE : MOVE A FEDERATION STARSHIP FROM INSIDE A QUADRANT TO
C           OUTSIDE THE QUADRANT
C*********************************************************************
      DIMENSION ISHIPS(15,13)
      DIMENSION INAME(3)
      CALL DBUGIN ('SSMOVO ENTERED',IW(14),0)
      CALL SSFIND (ISHIPS,IQX,IQY,ISX,ISY,NDX)
      ISHIPS(1,NDX) = NQX
      ISHIPS(2,NDX) = NQY
      ISHIPS(3,NDX) = 0
      ISHIPS(4,NDX) = 0
      INAME(1) = ISHIPS(5,NDX)
      INAME(2) = ISHIPS(6,NDX)
      INAME(3) = ISHIPS(7,NDX)
      CALL DBUGIN ('SSMOVO EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=SSPRNT
C*********************************************************************
      SUBROUTINE SSPRNT (IFLAG)
C PURPOSE : PRINT STATS ON A FEDERATION STARSHIP IN THE QUADRANT
C*********************************************************************
      COMMON /NUMBER/ NSTARS,NPLNTS,NSBASE,NFED,NCOMM,NFX(9),NFY(9),
     *     NCX(9),NCY(9)
      COMMON /SSINFO/ IOXQ(9),IOYQ(9),INXS(9),INYS(9)
      COMMON /TRACOM/ TARX,TARY,ISCPX2,ISCPY2,NSECE(10,10),IHIT,ISBC,
     *     IFSC,IKCC,ITORCT,ISB,IFS,IKC,IPR,ISCPX1,ISCPY1,ICHC,IPLC,ISTC
     *     ,ET,ISECT(10,10),TVX,TVY,ICMC
      COMMON /SHIPS/ IUSFED(15,13)
      COMMON /CHARS/ KZA,KZB,KZC,KZD,KZE,KZF,KZG,KZH,KZI,KZJ,KZK,KZL,KZM
     *     ,KZN,KZO,KZP,KZQ,KZR,KZS,KZT,KZU,KZV,KZW,KZX,KZY,KZZ,ICRDOT,
     *     ICRPLS,ICRCRH,ICRSTR,ICRMIN,ICRZER,KZ1,KZ2,KZ3,KZ4,KZ5,KZ6,
     *     KZ7,KZ8,KZ9,ICRBLK
      DIMENSION IDMSG2(15),IDMSG3(15)
      CHARACTER *4 CZMSG2(15) , CZMSG3(15)
      EQUIVALENCE (CZMSG2,IDMSG2) , (CZMSG3,IDMSG3)
      DATA CZMSG2(1)/'HAS '/,CZMSG2(2)/'BEEN'/,CZMSG2(3)/' IDE'/,
     *     CZMSG2(4)/'NTIF'/,CZMSG2(5)/'IED '/,CZMSG2(6)/'AS T'/,
     *     CZMSG2(7)/'HE F'/,CZMSG2(8)/'EDER'/,CZMSG2(9)/'ATIO'/,
     *     CZMSG2(10)/'N '/,CZMSG2(14)/'U.S.'/,CZMSG2(15)/'S. '/
      DATA IDMSG2(11) /0/ , IDMSG2(12) /0/ , IDMSG2(13) /0/
      DATA CZMSG3(4)/'CAPT'/,CZMSG3(5)/'AIN '/,CZMSG3(6)/' '/,
     *     CZMSG3(7)/' '/,CZMSG3(8)/' '/,CZMSG3(9)/' '/,
     *     CZMSG3(10)/' '/,CZMSG3(11)/' '/,CZMSG3(12)/' '/,
     *     CZMSG3(13)/' '/,CZMSG3(14)/' '/,CZMSG3(15)/' '/
      DATA IDMSG3(1) /0/ , IDMSG3(2) /0/ , IDMSG3(3) /0/
C     --- IFLAG = 1 MEANS THE RTN MUST USE THE SSINFO QUADRANT INFO
C         VECTORS FOR THE MOVES, = 0 MEANS USE CURRENT QUADRANT INFO
      CALL DBUGIN ('SSPRNT ENTERED',IW(14),0)
      CALL ITERPT
      IF (NFED.EQ.0) GO TO 50
      CALL LINEF
      CALL PRMSG ('THE STATISTICS ON THE FEDERATION STARSHIPS IN',
     *         IW(45))
      CALL PRMSG ('OUR QUADRANT, TO FOLLOW:',IW(23))
      IF (IFLAG.EQ.0) CALL LOCATE (KZF,N,N)
      DO 40 N = 1, NFED
           CALL LINEF
           IF (IFLAG) 50 , 10 , 20
10         IFX = NFX(N)
           IFY = NFY(N)
           IOX = ISCPX1
           IOY = ISCPY1
           GO TO 30
20         IFX = INXS(N)
           IFY = INYS(N)
           IOX = IOXQ(N)
           IOY = IOYQ(N)
30         CALL PRMSM ('THE STARSHIP AT SECTOR: ',
     *     24,IW(24),IFY,IFX,' ',0,1)
           CALL SSMOVI (IUSFED,ISCPX1,ISCPY1,IFX,IFY,IOX,IOY,IDMSG3(1),
     *          IDMSG3(6),IDMSG2(11))
           CALL PRMSG (IDMSG2,IW(60))
           CALL PRMSG (IDMSG3,IW(60))
           CALL PRMSG ('LAST KNOWN TO BE IN COMMAND',IW(27))
40    CONTINUE
50    CALL DBUGIN ('SSPRNT EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=SSTART
C*********************************************************************
      SUBROUTINE SSTART
C PURPOSE : SET SHIP NAMES AND CAPTAIN NAMES FOR SHIPS
C*********************************************************************
      CALL DBUGIN ('SSTART ENTERED',IW(14),0)
      CALL SETFED (0,0,0,0,'ENTERPRISE  ',
     * 'WILLIAM DECKER      ','CRUISER     ',1,IW(10),IW(20),IW(12))
      CALL SETFED (0,0,0,0,'POTEMPKIN   ',
     * 'MARK STEVENS        ','CRUISER     ',2,IW(10),IW(20),IW(12))
      CALL SETFED (0,0,0,0,'YORKTOWN    ',
     * 'TIMOTHY LYON        ','CRUISER     ',3,IW(10),IW(20),IW(12))
      CALL SETFED (0,0,0,0,'EXCALIBUR   ',
     * 'JEFF LAURENCE       ','CRUISER     ',4,IW(10),IW(20),IW(12))
      CALL SETFED (0,0,0,0,'LEXINGTON   ',
     * 'RAYMOND POWERS      ','CRUISER     ',5,IW(10),IW(20),IW(12))
      CALL SETFED (0,0,0,0,'KUBLIA      ',
     * 'HOI SUEN            ','DESTROYER   ',6,IW(10),IW(20),IW(12))
      CALL SETFED (0,0,0,0,'SARGON      ',
     * 'ANNE DREADEN        ','DESTROYER   ',7,IW(10),IW(20),IW(12))
      CALL SETFED (0,0,0,0,'MONITOR     ',
     * 'LARRY WILLIAMS      ','SCOUT       ',8,IW(10),IW(20),IW(12))
      CALL SETFED (0,0,0,0,'HOOD        ',
     * 'HERBERT RUBIN       ','CRUISER     ',9,IW(10),IW(20),IW(12))
      CALL SETFED (0,0,0,0,'EXETER      ',
     * 'WILLIAM RUDD        ','CRUISER     ',10,IW(10),IW(20),IW(12))
      CALL SETFED (0,0,0,0,'DARIUS      ',
     * 'MARIANNE ANDREAS    ','DESTROYER   ',11,IW(10),IW(20),IW(12))
      CALL SETFED (0,0,0,0,'ALARIC      ',
     * 'GAVIN PATTON        ','DESTROYER   ',12,IW(10),IW(20),IW(12))
      CALL SETFED (0,0,0,0,'SHAITAN     ',
     * 'JACK FISCHRUP       ','DESTROYER   ',13,IW(10),IW(20),IW(12))
      CALL DBUGIN ('SSTART EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=STARTM
C*********************************************************************
      SUBROUTINE STARTM
C PURPOSE : PROMPT FOR INFO ABOUT GAME, LEVEL, OLDNEW, AT STARTUP
C*********************************************************************
      IMPLICIT INTEGER (A-Z)
      REAL EOFF
      COMMON /PADDED/ IPAD1(9),ICHART(8,8),IPAD2(9),IPLNET(8,8),
     *    IKY(8,8),INPUT(50),IPAD3
      COMMON /CHARS/ KZA,KZB,KZC,KZD,KZE,KZF,KZG,KZH,KZI,KZJ,KZK,KZL,KZM
     *     ,KZN,KZO,KZP,KZQ,KZR,KZS,KZT,KZU,KZV,KZW,KZX,KZY,KZZ,ICRDOT,
     *     ICRPLS,ICRCRH,ICRSTR,ICRMIN,ICRZER,KZ1,KZ2,KZ3,KZ4,KZ5,KZ6,
     *     KZ7,KZ8,KZ9,ICRBLK
      COMMON /EXTRA/ N2,ITTY,IDIE
      COMMON /MISC/ BATTER,ISSAVE,IDUM,WFACT,IDATF,ILEV,CSDATE,TGIVEN
      CALL DBUGIN ('STARTM ENTERED',IW(14),0)
      ILEV = 0
      TOURN = 0
10    CALL LINEF
      CALL READIN ('ARE YOU RATED GOOD, EXPERT, OR EMERITUS ',
     *     IW(40),40,1,EOFF)
      IF (EOFF.GT..1) GO TO 10
      CALL GAP (N2)
      IF (N2.GT.50) GO TO 10
      IF (INPUT(N2).EQ.KZG) GO TO 40
      IF (INPUT(N2).EQ.KZE.AND.INPUT(N2+1).EQ.KZX) GO TO 30
      IF (INPUT(N2).EQ.KZE.AND.INPUT(N2+1).EQ.KZM) GO TO 20
      CALL HELPRT('LEVHELP     ',IW(16))
      GO TO 10
20    ILEV = 3
      GO TO 50
30    ILEV = 2
      GO TO 50
40    ILEV = 1
50    CALL LINEF
      CALL READIN ('DO YOU WANT A TOURNAMENT OR REGULAR GAME ',
     *     IW(41),41,1,EOFF)
      IF (EOFF.GT..1) GO TO 50
      CALL GAP (N2)
      IF (N2.GT.50) GO TO 50
      IF (INPUT(N2).EQ.KZR) GO TO 60
      IF (INPUT(N2).EQ.KZT) GO TO 70
      CALL HELPRT('TOURHELP    ',IW(12))
      GO TO 50
60    TOURN = 0
      GO TO 80
70    TOURN = 1
80    IF (TOURN.EQ.0) GO TO 100
90    CALL LINEF
      CALL READIN ('PLEASE SUPPLY NAME OR NUMBER OF TOURNAMENT ',
     *     IW(43),43,0,EOFF)
      NAME = IFIX(ABS(FLOAT(INPUT(1))/98765.0))
      IF (EOFF.GT..1) GO TO 90
100   IF (TOURN.EQ.1) CALL RANSET (NAME)
      I = TIME(DUMMY)
      IF (TOURN.NE.1) CALL RANSET (I)
      CALL DBUGIN ('STARTM EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=STAX
STAX     TITLE '--- STAX - DEFER INTERUPTS ROUTINE ---'
STAX     START 0
*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*
* PURPOSE : FUNCTION TO CANCEL "STAE" AND DEFER INTERUPTS IF        *
*           DESIRED (TURNED OFF AT THIS POINT, TO USE,              *
*           UNCOMMENT THE "STAX" MACROS)                            *
*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*
        YREGS
        SAVE   (14,12),,*          SAVE REGISTERS
         LR     R12,R15
         USING  STAX,R12
         L      R1,0(,R1)
         ICM    R1,B'1111',0(R1)   GET PARM 0=DEFER ON ^=0=DEFER OFF
         BZ     DEFON
*       STAX    DEFER=NO           DEFER INTERUPTS
         B      QUIT
DEFON    DS     0H
*       STAX    DEFER=YES
        STAE    0
QUIT    RETURN (14,12),T,RC=0      RESTORE REGISTERS AND RETURN ...
         SPACE 1
         END
./     ADD     NAME=TARSET
C*********************************************************************
      SUBROUTINE TARSET (DPRECX,DPRECY,TACX,TACY,ITRCON,LRUDD,C)
C PURPOSE : DETERMINE IF A GIVEN DESTINATION IS FURTHER AWAY ON
C           THE X AXIS OR THE Y AXIS, NEEDED TO BREAK UP CHECKS
C           FOR OBJECTS IN THE WAY (I.E. TARGETS FOR PHOTON TORPEOES
C           AND MOVEMENT) SO THAT THINGS ARE NOT HOPPED OVER
C  EXAMPLE :
C  =========
C        X-AXIS
C  1 2 3 4 5 6 7 8 9 10           TARCON Y WOULD BE RETURNED
C  . . . . . . . . . . 1          SINCE THERE IS A GREATER Y
C                                 DISTANCE THAN X, HENCE X4-Y5
C  . . . . . . . . . . 2          AND X5-Y6 WOULD BE CHECKED FOR
C                                 THINGS IN THE WAY, IF X
C  . . . . . . . . . . 3          WERE ACCIDENTLY RETURNED, THEN
C                                 ONLY ONE POINT (EITHER X4-Y5 OR
C  . . . 1 . . . . . . 4          X5-Y6) WOULD BE CHECKED (WRONGLY)
C                         Y-AXIS
C  . . . . . . . . . . 5          THIS MAY NOT BE COMPLETELY
C                                 CLEAR, IN SHORT:
C  . . . . . . . . . . 6          IF CHECKING FOR OBJECTS BETWEEN
C                                 TWO OBJECTS, IT IS IMPORTANT TO
C  . . . . 2 . . . . . 7          KNOW WHETHER IS IS FURTHER "X"
C                                 AWAY OR FURTHER "Y" AWAY.
C  . . . . . . . . . . 8
C                                 POINTS INBETWEEN TWO OBJECTS
C  . . . . . . . . . . 9          NEED TO HAVE ALL POINTS WITHIN
C                                 .5 SECTORS OF THE PATH BE CONSIDERED
C  . . . . . . . . . . 10         "IN THE WAY"
C  1 = OBJECT ONE / 2 = OBJECT TWO
C*********************************************************************
      INTEGER LRUDD
      COMMON /CHARS/ KZA,KZB,KZC,KZD,KZE,KZF,KZG,KZH,KZI,KZJ,KZK,KZL,KZM
     *     ,KZN,KZO,KZP,KZQ,KZR,KZS,KZT,KZU,KZV,KZW,KZX,KZY,KZZ,ICRDOT,
     *     ICRPLS,ICRCRH,ICRSTR,ICRMIN,ICRZER,KZ1,KZ2,KZ3,KZ4,KZ5,KZ6,
     *     KZ7,KZ8,KZ9,ICRBLK
      CALL DBUGIN ('TARSET ENTERED',IW(14),0)
      DPRESX = DPRECX
      DPRESY = DPRECY
      TARX = TACX
      TARY = TACY
      ADELTX = DPRESX-TARX
      ADELTY = DPRESY-TARY
      IF (ADELTX.LT.0.0) ADELTX = -ADELTX
      IF (ADELTY.LT.0.0) ADELTY = -ADELTY
      ITRCON = KZY
      IF (ADELTX.GE.ADELTY) ITRCON = KZX
      IF (ITRCON.EQ.KZX) GO TO 10
C     --- CONDITIONS FOR ITRCON 'Y'      ****************
      LRUDD = 1
      IF (TARY.LT.DPRESY) LRUDD = -1
      SC = 0.0
      IF (TARX.GT.DPRESX) SC = ADELTX/ADELTY
      IF (TARX.LT.DPRESX) SC = -(ADELTX/ADELTY)
      GO TO 20
C     --- CONDITIONS FOR ITRCON 'X'      ****************
10    LRUDD = 1
      IF (TARX.LT.DPRESX) LRUDD = -1
      SC = 0.0
      IF (TARY.GT.DPRESY) SC = ADELTY/ADELTX
      IF (TARY.LT.DPRESY) SC = -(ADELTY/ADELTX)
20    C = SC
      DPRECX = DPRESX
      DPRECY = DPRESY
      TACX = TARX
      TACY = TARY
      CALL DBUGCH ('TARSET RTN=',IW(11),ITRCON,IW(4))
      CALL DBUGIN ('TARSET EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=TIME
TIME     TITLE '--- TIME - FORTRAN TIME FUNCTION ---'
TIME     START 0
*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*
* PURPOSE : TIME FUNCTION FOR FORTRAN - RETURN TIME IN R0           *
*                                       (FUNCTION FORM)             *
*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*
        YREGS
        SAVE   (14,12),,*          SAVE REGISTERS
        TIME    BIN                GET TIME IN BINARY
         ST    R0,20(R13)          PASS R0 BACK
        RETURN (14,12),T,RC=0      RESTORE REGISTERS AND RETURN ...
         SPACE 1
         END
./     ADD     NAME=TIMMSG
C*********************************************************************
      SUBROUTINE TIMMSG
C PURPOSE : PRINT THE MSGS THAT SAY THE USER HAS RUN OUT OF TIME.
C*********************************************************************
      CALL DBUGIN ('TIMMSG ENTERED',IW(14),0)
      CALL LINEF
      CALL PRMSG ('YOU HAVE RUN OUT OF TIME, THE FEDERATION FORCES HAVE'
     *     ,IW(52))
      CALL PRMSG ('HAD ENOUGH TIME TO BUILD UP A SOLID DEFENSE',IW(43))
      CALL PRMSG ('YOUR ORDERS WERE VERY CLEAR... IF YOU FAILED.',
     *     IW(45))
      CALL DBUGIN ('TIMMSG EXITED',IW(13),0)
      RETURN
      END
./     ADD     NAME=TIMUSE
C*********************************************************************
      FUNCTION TIMUSE (D,WF)
C PURPOSE : DETERMINE HOW MUCH TIME IS USED MOVING FROM PLACE TO PLACE
C           NOTE THAT IS STAR TREK THE SPEED IS WARP CUBED, THERE IS A
C           FUDGE FACTOR IN HERE TO BE ABOUT WARP**1.5 DEPENDING ON
C           WARP SPEED (ROUTINE CANNOT HANDLE WARP GREATER THAN 12)
C           D IS DISTANCE TRAVELED
C           WF IS CURRENT WARP FACTOR
C*********************************************************************
      T      = D/(WF**(1.5-((12.0-WF)*.1)))
      CALL DBUGRN ('TIMUSE RTN=',IW(11),T)
      TIMUSE = T
      RETURN
      END
./     ADD     NAME=TRACK
C*********************************************************************
      SUBROUTINE TRACK
C PURPOSE : DETERMINE PATH AND TRACK OUTGOING PHOTON TORPEDO
C*********************************************************************
      INTEGER PRESX,PRESY,NSECE,IHIT,LRVDP,ITRCON,ISBC,IFSC,IKCC,ICHART,
     *     IPLNET,ISCPX1,ISCPY1,ICHC,IPLC,ISTC
      REAL TARX,TARY,DPRESX,DPRESY,DELTX,DELTY,ADELTX,ADLETY,DISP,SL,
     *     TVX,TVY
      COMMON /TRACKR/ ITRKC, RTRK(15,2)
      COMMON /TRACOM/ TARX,TARY,PRESX,PRESY,NSECE(10,10),IHIT,ISBC,IFSC,
     *     IKCC,ITORCT,ISB,IFS,IKC,IPR,ISCPX1,ISCPY1,ICHC,IPLC,ISTC,ET,
     *     CSEC(10,10),TVX,TVY,ICMC
      COMMON /PADDED/ IPAD1(9),ICHART(8,8),IPAD2(9),IPLNET(8,8),
     *     IKY(8,8),INPUT(50),IPAD3
      COMMON /CHARS/ KZA,KZB,KZC,KZD,KZE,KZF,KZG,KZH,KZI,KZJ,KZK,KZL,KZM
     *     ,KZN,KZO,KZP,KZQ,KZR,KZS,KZT,KZU,KZV,KZW,KZX,KZY,KZZ,ICRDOT,
     *     ICRPLS,ICRCRH,ICRSTR,ICRMIN,ICRZER,KZ1,KZ2,KZ3,KZ4,KZ5,KZ6,
     *     KZ7,KZ8,KZ9,ICRBLK
      CHARACTER *4 CZBLOW , CZNOHT
      EQUIVALENCE (CZBLOW,IZBLOW) , (CZNOHT,IZNOHT)
      DATA CZBLOW /'BLOW'/ , CZNOHT /'NOHT'/
      CALL DBUGIN ('TRACK ENTERED',IW(13),0)
      IF (RAND(150.0).GT.1.0) GO TO 10
      CALL BEEP
      CALL LINEF
      CALL ADDQUE ('REDA')
      CALL PRMSG ('*** DISRUPTOR TORPEDO EXPLODES IN FIRING TUBE',
     *    IW(45))
      CALL LINEF
      IHIT = IZBLOW
      GO TO 50
10    DPRESY = PRESY
      DPRESX = PRESX
      TVX = DPRESX
      TVY = DPRESY
      IHIT = IZNOHT
      CALL LINEF
      CALL PRMSG ('### TORPEDO FIRED -- TRACKING',IW(29))
      CALL LINEF
      CALL TARSET (DPRESX,DPRESY,TARX,TARY,ITRCON,LRUDD,SC)
      XXX = RAND(1.0)
      IF (XXX.LT.0.25) DISP = RAND(0.005)+.045
      IF (XXX.LT.0.5.AND.XXX.GE.0.25) DISP = RAND(0.005)+.015
      IF (XXX.LT.0.75.AND.XXX.GE.0.5) DISP = RAND(0.02)+.0075
      IF (XXX.GE.0.75) DISP = RAND(.0075)
      IF (RAND(1.0).GE..5) DISP = -DISP
20    IF (IHIT.NE.IZNOHT) GO TO 50
      IF (ITRCON.EQ.KZX) GO TO 30
      TVY = TVY+LRUDD
      TVX = TVX+SC+DISP
      GO TO 40
30    TVX = TVX+LRUDD
      TVY = TVY+SC+DISP
40    V1 = TVY
      V2 = TVX
      IF (V1.LT..5.OR.V1.GT.10.5.OR.V2.LT..5.OR.V2.GT.10.5) GO TO 900
      ITRKC = ITRKC + 1
      RTRK (ITRKC,1) = V1
      RTRK (ITRKC,2) = V2
900   CALL KILLER
      GO TO 20
50    CALL DBUGIN ('TRACK EXITED',IW(12),0)
      RETURN
      END
./     ADD     NAME=TSMSG
C*********************************************************************
      SUBROUTINE TSMSG
C PURPOSE : PRINT WE DON'T HAVE TRANSPORTER OR SHUTTLE MSG
C*********************************************************************
      CALL DBUGIN ('TSMSG ENTERED',IW(13),0)
      CALL LINEF
      CALL PRMSG ('THE SUPERCOMMANDER KAZH HAS NO SHUTTLE CRAFT OR',
     *      IW(47))
      CALL PRMSG ('PLANETARY TRANSPORTER, AS IT HAS NO USE FOR EITHER.',
     *      IW(51))
      CALL DBUGIN ('TSMSG EXITED',IW(12),0)
      RETURN
      END
./     ADD     NAME=XCHEAD
C*********************************************************************
      SUBROUTINE XCHEAD
C PURPOSE : FILL IN THE HEADER INFO FOR SRS AND LRS SCANS ON THE TOP
C           OF THE SCREEN
C*********************************************************************
      COMMON /FSBUFF/ NPROML, NPROMT(20), NREAD(13),
     *     NHEAD(20,12), NCOUNT, NWORK(20,200)
      COMMON /OUTUNT/ IOUTT
      COMMON /CPU/ IBMT
      COMMON /PHASE/ INIT
      COMMON /CHARS/ KZA,KZB,KZC,KZD,KZE,KZF,KZG,KZH,KZI,KZJ,KZK,KZL,KZM
     *     ,KZN,KZO,KZP,KZQ,KZR,KZS,KZT,KZU,KZV,KZW,KZX,KZY,KZZ,ICRDOT,
     *     ICRPLS,ICRCRH,ICRSTR,ICRMIN,ICRZER,KZ1,KZ2,KZ3,KZ4,KZ5,KZ6,
     *     KZ7,KZ8,KZ9,ICRBLK
      IOUT = IOUTT - 1
      DO 5  I = 1, 12
          DO 5  J = 1, 20
              NHEAD (J,I) = ICRBLK
5     CONTINUE
      IF (INIT.EQ.1) GO TO 500
      REWIND IOUT
      CALL SR3270
      REWIND IOUT
      DO 10 N=1,12
          READ (IOUT,10000,END=15) (NHEAD(J,N),J=1,16)
10    CONTINUE
15    REWIND IOUT
      CALL LRSCAN
      REWIND IOUT
      DO 20 N=1,12
          READ (IOUT,10010,END=25) (NHEAD(J,N),J=17,20)
20    CONTINUE
25    REWIND IOUT
500   RETURN
10000 FORMAT (1X,16A4)
10010 FORMAT (1X,4A4)
      END
./     ADD     NAME=XDEBUG
C*********************************************************************
      SUBROUTINE XDEBUG
C PURPOSE : ACTIVATE AND DE-ACTIVATE THE TRACE FLAG AFTER GETTING
C           A DEBUG PASSWORD (WHICH EQUALS NONA) AND CAUSE ROUTINES
C           WITH DEBUG CALLS IN THEY TO DISPLAY DIAGNOSTIC INFO
C*********************************************************************
      COMMON /DEBUG/ IDEBUG
      COMMON /PADDED/ IPAD1(9),ICHART(8,8),IPAD2(9),IPLNET(8,8),
     *    IKY(8,8), INPUT(50),IPAD3
      COMMON /EXTRA/ N2,ITTY,IDIE
      COMMON /CHARS/ KZA,KZB,KZC,KZD,KZE,KZF,KZG,KZH,KZI,KZJ,KZK,KZL,KZM
     *     ,KZN,KZO,KZP,KZQ,KZR,KZS,KZT,KZU,KZV,KZW,KZX,KZY,KZZ,ICRDOT,
     *     ICRPLS,ICRCRH,ICRSTR,ICRMIN,ICRZER,KZ1,KZ2,KZ3,KZ4,KZ5,KZ6,
     *     KZ7,KZ8,KZ9,ICRBLK
      CALL PRMSG ('KLINGON DEBUGGING ACTIVATION ROUTINE',IW(36))
      CALL PRMSG ('ENTER DEBUG ACCESS PASSWORD BELOW',IW(33))
100   CALL READIN ('PASSWORD - ',IW(11),11,1,EOFF)
      IF (EOFF.GT.0.9) GO TO 220
      CALL GAP (N2)
      IF (N2.GT.50) GO TO 220
      GO TO 225
220   CALL LINEF
      CALL PRMSG ('*BLANK LINE IGNORED* ',IW(20))
      CALL LINEF
      GO TO 100
225   IF (INPUT(N2).EQ.KZN.AND.INPUT(N2+1).EQ.KZO.AND.
     *    INPUT(N2+2).EQ.KZN.AND.INPUT(N2+3).EQ.KZA) GO TO 500
      CALL PRMSG ('*PASSWORD NOT MATCHED*',IW(22))
      GO TO 600
500   CALL PRMSG ('*PASSWORD ACCEPTED*',IW(20))
      IF (IDEBUG.EQ.1) GO TO 510
          IDEBUG = 1
          CALL PRMSG('TRACE IS NOW ACTIVE  ',IW(19))
          GO TO 600
510       IDEBUG = 0
          CALL PRMSG('TRACE IS NOW INACTIVE ',IW(21))
600   RETURN
      END
./     ADD     NAME=XFILLB
C*********************************************************************
      SUBROUTINE XFILLB
C PURPOSE : FOR 3270 MVS/TSO REWIND THE WORK FILE AND READ THE RECORD
C           IN A4 FORMAT
C*********************************************************************
      COMMON /FSBUFF/ NPROML, NPROMT(20), NREAD(13),
     *     NHEAD(20,12), NCOUNT, NWORK(20,200)
      COMMON /OUTUNT/ IOUTT
      COMMON /CPU/ IBMT
      COMMON /CHARS/ KZA,KZB,KZC,KZD,KZE,KZF,KZG,KZH,KZI,KZJ,KZK,KZL,KZM
     *     ,KZN,KZO,KZP,KZQ,KZR,KZS,KZT,KZU,KZV,KZW,KZX,KZY,KZZ,ICRDOT,
     *     ICRPLS,ICRCRH,ICRSTR,ICRMIN,ICRZER,KZ1,KZ2,KZ3,KZ4,KZ5,KZ6,
     *     KZ7,KZ8,KZ9,ICRBLK
      NCOUNT = 0
      REWIND IOUTT
      IF (IBMT.NE.1) GO TO 100
10    NCOUNT = NCOUNT + 1
C     --- FOLLOWING LINE IS TO PREVENT OVERFLOW
      IF (NCOUNT.GT.200) GO TO 20
      READ (IOUTT,10000,END=20) (NWORK(N,NCOUNT),N=1,20)
      GO TO 10
20    NCOUNT = NCOUNT - 1
100   REWIND IOUTT
      RETURN
10000 FORMAT (1X,19A4,A3)
      END
./     ADD     NAME=YESNO
C*********************************************************************
      SUBROUTINE YESNO (IMSG,MSGDIM,MSGLEN,IYES)
C PURPOSE : PROMPT USER FOR YES OR NO RESPONSE
C*********************************************************************
      COMMON /PADDED/ IPAD1(9),ICHART(8,8),IPAD2(9),IPLNET(8,8),
     *     IKY(8,8),INPUT(50),IPAD3
      DIMENSION IMSG(MSGDIM)
      CHARACTER *4 CZY, CZYES , CZN, CZNO
      EQUIVALENCE (CZY,IZY) , (CZYES,IZYES) , (CZN,IZN) , (CZNO,IZNO)
      DATA CZY /'Y'/ , CZYES /'YES'/ , CZN /'N'/ , CZNO /'NO'/
      CALL DBUGIN ('YESNO ENTERED',IW(13),0)
      IYES = 0
10    CALL READIN (IMSG,MSGDIM,MSGLEN,0,EOFF)
      IF (EOFF.NE.0) GO TO 10
      IF (INPUT(1).EQ.IZY.OR.INPUT(1).EQ.IZN) GO TO 20
      IF (INPUT(1).EQ.IZYES.OR.INPUT(1).EQ.IZNO) GO TO 20
      CALL PRMSG ('Y(ES) OR N(O), PLEASE.  ',IW(24))
      GO TO 10
20    IF (INPUT(1).EQ.IZY) IYES = 1
      IF (INPUT(1).EQ.IZYES) IYES = 1
      CALL DBUGIN ('YESNO EXITED',IW(12),0)
C     --- ... KICK THE IW FUNCTION TO RETURN IHOLD TO CORRECT VALUE
      IDUMMY = IW(MSGLEN)
      RETURN
      END
./     ENDUP

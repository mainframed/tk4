CHCK     TITLE 'CHECK FIELD FOR ONLY DIGIT(S) ...'
CHECK    START 0
         SPACE 1
*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*
*                                                                     *
* NOTE : A WXTRN FOR THE SYMBOL PLIBASE IS USED TO CONTROL THE METHOD *
* ------ OF ACCESS TO VARYING CHARACTER STRING VARIABLES.             *
*        IF THE EXTERNAL REFERENCE WAS RESOLVED BY THE LINKAGE        *
*        EDITOR, ITS VALUE WILL NON-ZERO. USING THIS TECHNIQUE        *
*        THE SUBROUTINE TO FUNCTION PROPERLY WITH CODE GENERATED BY   *
*        EITHER THE F-LEVEL OR OPTIMIZING/CHECKOUT COMPILER.          *
*                                                                     *
* AUTHOR : MOINIL P.A.                                                *
* -------- COMPUTING CENTRE                                           *
*          J.R.C. - ISPRA ESTABLISHMENT                               *
*          21020 ISPRA (VA), ITALY                                    *
*                                                                     *
*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*
         SPACE 1
         WXTRN PLISTART
         SPACE 1
        $DEFREG
         EJECT
         USING *,R15               ESTABLISH ADDRESSABILITY
         STM   R0,R4,20(R13)       SAVE SOME OF THE REGISTERS
         LM    R2,R3,0(R1)         LOAD ADDRESSES OF VARIABLES PASSED
         USING DSDV,R2
         L     R4,CMPSW            SET COMPILER SWITCH
         XR    R0,R0
         L     R1,SDVADDR          STRING ADDRESS
         LTR   R4,R4               COMPILER SWITCH ?
         BZ    *+L'*+12            BRANCH IF F-LEVEL COMPILER
         ICM   R0,B'0011',0(R1)    SET CURRENT LENGTH FOR CHECK
         LA    R1,2(R1)            POINT TO DATA
         B     *+L'*+4
         ICM   R0,B'0011',SDVCSL   BUFFER SIZE=CURRENT STRING LENGTH
         LTR   R0,R0
         BNP   QUIT
LOOP     CLI   0(R1),C'0'
         BL    NULL
         CLI   0(R1),C'9'
         BH    NULL
         LA    R1,1(R1)
         BCT   R0,LOOP
         B     QUIT
NULL     XC    0(2,R3),0(R3)       ERROR, NULLIFY STRING LENGTH
QUIT     LM    R0,R4,20(R13)       RE-ESTABLISH USER REGISTERS
         BR    R14                 GO BACK
         DROP  R2,R15
         SPACE 1
CMPSW    DC    A(PLISTART)         COMPILER SWITCH
         SPACE 1
*------- DSECTS
         SPACE 1
DSDV     DSECT
SDVADDR  DS    F
SDVMSL   DS    H
SDVCSL   DS    H
         SPACE 1
         END

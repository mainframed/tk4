SK       TITLE 'SEIKO - FULL SCREEN DISPLAY CLOCK TIME.'
        PRINT  OFF
         MACRO
&LAB    @GTB
         LCLA  &I,&L,&M,&N,&N1,&N2,&N3,&N4
         LCLB  &SW
         LCLC  &C1,&C2
&N       SETA  N'&SYSLIST
         AIF   (&N EQ 11).A
         MNOTE 8,'--- WRONG NUMBER OF OPERAND(S) : MUST BE 11 ---'
         MEXIT
.A       ANOP
&I       SETA  1
&SW      SETB  0
.LOOP    ANOP
&L       SETA  K'&SYSLIST(&I)
         AIF   (&L EQ 11).B
         MNOTE 8,'--- WRONG LENGTH OPERAND &I : MUST BE 9 ---'
         MEXIT
.B       AIF   ('&SYSLIST(&I)'(1,1) EQ '''').C
         MNOTE 8,'--- OPERAND &I : STARTING QUOTE MISSING ---'
         MEXIT
.C       AIF   ('&SYSLIST(&I)'(&L,1) EQ '''').D
         MNOTE 8,'--- OPERAND &I : ENDING QUOTE MISSING ---'
         MEXIT
.D       ANOP
&L       SETA  1
&M       SETA  2
&N1      SETA  0
&N2      SETA  0
&N3      SETA  0
&N4      SETA  0
&C1      SETC  ' '
&C2      SETC  ' '
.E       AIF   ('&SYSLIST(&I)'(&M,1) NE ' ').F
&L       SETA  &L+1
&M       SETA  &M+1
         AIF   (&M LT 11).E
         AGO   .GEN
.F       ANOP
&N1      SETA  &L
&C1      SETC  '&SYSLIST(&I)'(&M,1)
.G       ANOP
&N2      SETA  &N2+1
&L       SETA  &L+1
&M       SETA  &M+1
         AIF   (&M EQ 11).GEN
         AIF   ('&SYSLIST(&I)'(&M,1) NE ' ').G
.H       ANOP
&L       SETA  &L+1
&M       SETA  &M+1
         AIF   (&M EQ 11).GEN
         AIF   ('&SYSLIST(&I)'(&M,1) EQ ' ').H
&N3      SETA  &L
&C2      SETC  '&SYSLIST(&I)'(&M,1)
.I       ANOP
&N4      SETA  &N4+1
&L       SETA  &L+1
&M       SETA  &M+1
         AIF   (&M EQ 11).GEN
         AIF   ('&SYSLIST(&I)'(&M,1) NE ' ').I
.GEN     AIF   (&SW).OTH
&LAB     DC    AL1(&N1,&N2,&N3,&N4),CL2'&C1&C2'
&SW      SETB  1
         AGO   .NXT
.OTH     DC    AL1(&N1,&N2,&N3,&N4),CL2'&C1&C2'
.NXT     ANOP
&I       SETA  &I+1
         AIF   (&I LE &N).LOOP
         DC    AL1(255)
         MEND
        PRINT  ON
         SPACE 1
SEIKO    START 0
         SPACE 1
* ------------------------------------------------------------------- *
*                                                                     *
*  PURPOSE :   FULL SCREEN DISPLAY CLOCK TIME (TSO COMMAND).          *
*  ---------                                                          *
*                                                                     *
*  COMMAND :   SYNTAX : SEIKO INTERVAL(...)                           *
*  ---------       OR : SEIKO I(...)                                  *
*              WHERE ... IS THE INTERVAL TIME EXPRESSED IN SECONDS    *
*              (MAY RANGE FROM 1 UP TO 60). THE DEFAULT VALUE IS 1    *
*              (EVERY SECONDS).                                       *
*                                                                     *
*  AUTHOR :    RAVARANI N. - MOINIL P.A.                              *
*  --------    COMPUTING CENTRE (TP 361)                              *
*              J.R.C. - ISPRA ESTABLISHMENT                           *
*              21020 ISPRA (VA), ITALY                                *
*                                                                     *
*-------------------------------------------------------------------- *
         SPACE 1
        $DEFREG
SCBUFL   EQU   4*1024              SCREEN BUFFER LENGTH
         EJECT
        $XENT  BASE=(R11,R12),LV=WRKL,TYPE=RENT
         LR    R10,R13             SET WORK AREAS ADDRESSABILITY
         USING WRKDSECT,R10
        $TEW$EC NOTTSO=(,ONLY),MSG=PUTMSG,ERR=SETRC
        $TEW$PP PARM=PARMLST,REG=R3
         LA    R1,100              SET DEFAULT INTERVAL (1 SEC)
         CLI   PDIN+1,0            INTERVAL SPECIFIED ?
         BE    DEFLT               NO
         TM    SDIN+6,X'80'        VALUE PRESENT ?
         BZ    DEFLT               NO
         LH    R14,SDIN+4          GET LENGTH
         LTR   R14,R14             LENGTH ZERO ?
         BNP   DEFLT               YES
         L     R1,SDIN             POINT TO VALUE
         BCT   R14,*+L'*+6
         PACK  CONV,0(0,R1)        << EXECUTED >>
         EX    R14,*-6
         CVB   R1,CONV             GET BINARY VALUE
         CH    R1,=H'60'           VALID INTERVAL REQUESTED ?
         BH    INVREQ              NO
         MH    R1,=H'100'          COMPUTE WAIT VALUE
DEFLT    ST    R1,INTVAL           SET WAIT INTERVAL
         DROP  R3
        IKJRLSA #TSANSW
         SPACE 1
*------- CHECK CALLER TERMINAL.
         SPACE 1
         XC    SZLINE(L'SZLINE+L'SZSCRN),SZLINE
         MVI   SWITCH,0
        GTSIZE ,                   GET ORIGINAL SCREEN SIZE
         LTR   R0,R0               IS IT A SCREEN ?
         BZ    NOTSCR              IF ZERO, NOT A SCREEN
         CH    R0,=H'24'           STANDARD NUMBER OF LINES ?
         BL    NOTSTD              LESS
         BE    TSTLNL              YES
         CH    R1,=H'80'           STANDARD LINE LENGTH ?
         BL    NOTSTD              LESS
SETSSZ   ST    R0,SZSCRN           SAVE SCREEN SIZE
         ST    R1,SZLINE           SAVE LINE SIZE
         OI    SWITCH,SCRST        INDICATE SCREEN SIZE TO BE SET
         B     GO
TSTLNL   CH    R1,=H'80'           STANDARD LINE LENGTH ?
         BL    NOTSTD              LESS
         BH    SETSSZ              MORE
         SPACE 1
*------- START SCREEN PROCESSING.
         SPACE 1
GO      $GFDATE TITDTE,TITTIM+2,MF=(L,GFDTEL)
         MVI   DITYNU,0
        STFSMODE ON,INITIAL=YES
         TM    SWITCH,SCRST        SCREEN SIZE TO SET
         BZ    STPCOFF             NO
        STSIZE SIZE=80,LINE=24     SET STANDARD SCREEN SIZE
         OI    SWITCH,SCRRS        INDICATE SCREEN SIZE TO BE RESET
STPCOFF  NI    SWITCH,255-SCREC
         MVC   OSFRQ(LSF),OSFN
RSTRT    XR    R1,R1
         IC    R1,DITYNU
         SLL   R1,2
         AL    R1,=A(LSTB)
         MVC   ADDTB(L'ADDTB),0(R1)
         LA    R1,FULLSC
         L     R0,=A(FULLSCL)
         MVC   0(256,R1),FULLSCP
         MVC   256(FULLSCL-256,R1),FULLSCP+256
         AL    R1,=A(FULLSCL)
         TM    SWITCH,SCREC
         BO    RSCON
         MVC   0(CMDNTL,R1),CMDNT
         AL    R1,=A(CMDNTL)
         AL    R0,=A(CMDNTL)
         B     RSPTR
RSCON    MVC   0(CMDSTL,R1),CMDST
         AL    R1,=A(CMDSTL)
         AL    R0,=A(CMDSTL)
RSPTR    STM   R0,R1,SCBSLG
         XC    PRVDTE,PRVDTE
         XC    PRVTIM,PRVTIM
         NI    SWITCH,255-SCRPI    RESET PRESERVE INPUT
         SPACE 1
*------- GET DATE AND CLOCK TIME.
         SPACE 1
GETTME  $GFDATE MF=(E,GFDTEL)      GET DATE/TIME
         MVC   TITTIM(2),TITTIM+2  HHMMSS
         MVC   TITTIM+3(2),TITTIM+4
         MVI   TITTIM+2,C':'
         MVI   TITTIM+5,C':'
         L     R2,SCDATA           RESET BUFFER VARIABLE LENGTH AREA
         L     R3,=A(SCBUFL)
         SL    R3,SCBSLG
         LA    R14,*
         XR    R15,R15
         MVCL  R2,R14
         SPACE 1
*------- EDIT THE DATE IF NEEDED.
         SPACE 1
         CLC   TITDTE,PRVDTE
         BE    *+L'*+20
         CLI   PRVDTE,0
         BNE   RSTRT
         MVC   FULLSC+FULLSCT(L'TITDTE),TITDTE
         MVC   PRVDTE,TITDTE
         SPACE 1
*------- EDIT THE CLOCK TIME.
         SPACE 1
         LA    R2,TITTIM
         LA    R7,PRVTIM
         L     R3,SCDATA
         XR    R4,R4
         BAS   R8,EDIT             H
         BAS   R8,EDIT             HH
         BAS   R8,EDITS            HH:
         BAS   R8,EDIT             HH:M
         BAS   R8,EDIT             HH:MM
         BAS   R8,EDITS            HH:MM:
         BAS   R8,EDIT             HH:MM:S
         BAS   R8,EDIT             HH:MM:SS
         MVC   PRVTIM,TITTIM
         SPACE 1
*------- DISPLAY CLOCK TIME.
         SPACE 1
         L     R1,SCDATA
         LR    R0,R3
         SLR   R0,R1
         AL    R0,SCBSLG
         LA    R1,FULLSC
         TM    SWITCH,SCRPI        PRESERVE INPUT ?
         BO    PRSVIN              YES
         AL    R0,=A(WSPTL)        NO
         MVC   0(WSPTL,R3),WSPT
        $FS    WCC=(KBR,RMDT),MF=(I,FULLWCC)
         B     TSTFTD
PRSVIN   NI    SWITCH,255-SCRPI    RESET PRESERVE INPUT
        $FS    WCC=(KBR),MF=(I,FULLWCC)
TSTFTD   TM    SWITCH,SCRST+SCRRS  FIRST TPUT DONE ?
         BNO   SNDWR               YES
        $FS    CC=EW,MF=(I,(R1))   SET ERASE/WRITE
SNDWR    ICM   R1,B'1000',=X'03'   INDICATE FULL SCREEN
        TPUT   (1),(0),R
         TM    SWITCH,SCRST+SCRRS  FIRST TPUT DONE ?
         BNO   SNDRD               YES
        $FS    CC=W,MF=(I,FULLSC)  RESTORE WRITE
         NI    SWITCH,255-SCRST    SET FIRST TPUT DONE
         SPACE 1
*------- SEE IF STOP REQUESTED. THIS 'TGET' IS NECESSARY WHEN
*        WORKING IN 'SNA', BECAUSE THE KEYBOARD RESTORE ORDER
*        (SEE WCC OF 'TPUT') IS SET IN A PENDING STATE UNTIL A
*        'TGET' IS EXECUTED. SO THIS AVOIDS THE KEYBOARD LOCK
*        DURING THE WAIT INTERVAL TIME WHICH FOLLOWS.
         SPACE 1
SNDRD    L     R0,=A(SHRTSCL)
         CL    R0,SCBSLG
         BE    *+L'*+10
         LA    R1,FULLSC
         ALR   R1,R0
         STM   R0,R1,SCBSLG
         BAS   R8,ANYPDG           ANYTHING PENDING ...
         SPACE 1
*------- WAIT FOR REQUESTED INTERVAL.
         SPACE 1
TIMER   STIMER WAIT,BINTVL=INTVAL
         SPACE 1
*------- SEE IF OUTPUT COMPLETE (TASK MAY BE SWAP-OUT OR TERMINAL
*        IN REMOTE ATTACHMENT MAY BE SLOWER THAN WAIT INTERVAL).
         SPACE 1
        ZEROKEY
         USING PSA,R0
         L     R14,PSAAOLD         ASCB
         DROP  R0
         USING ASCB,R14
         L     R15,ASCBTSB         TSB
         DROP  R14
         USING TSB,R15
         ICM   R2,B'1111',TSBNOBF  TSBNOBF+TSBOBFP
         DROP  R15
        RESETKEY
         LTR   R2,R2
         BNZ   TIMER
         SPACE 1
*------- SEE IF SOMETHING REQUESTED.
         SPACE 1
         BAS   R8,ANYPDG           ANYTHING PENDING ...
         OI    SWITCH,SCRPI        NORMAL NOWAIT, SET PRESERVE INPUT
         B     GETTME
ANYPDG   XC    PFREPLY,PFREPLY     ANYTHING PENDING ...
        TGET   PFREPLY,L'PFREPLY,ASIS,NOWAIT
         LTR   R15,R15
         BZ    ANLZ                SOMETHING HAS BEEN ENTERED ...
         CH    R15,=H'4'
         BNE   QUIT                NOT NORMAL WAIT ...
         BR    R8
ANLZ     CLI   PFCODE,X'F3'        PF 3 ENTERED ?
         BE    QUIT                YES, EXIT
         CLI   PFCODE,X'C3'        PF 15 ENTERED (ALT. PF 3) ?
         BE    QUIT                YES, EXIT
         CLI   PFCODE,X'F1'        PF 1 ENTERED ?
         BE    DHLP                YES, GO DISPLAY TUTORIAL
         CLI   PFCODE,X'C1'        PF 13 ENTERED (ALT. PF 1) ?
         BE    DHLP                YES, GO DISPLAY TUTORIAL
         CLI   PFCODE,X'F2'        PF 2 ENTERED ?
         BE    CHGD                YES, GO CHANGE DISPLAY
         CLI   PFCODE,X'C2'        PF 14 ENTERED (ALT. PF 2) ?
         BE    CHGD                YES, GO CHANGE DISPLAY
         OC    PFTEXT(8),=CL8' '   YES, UPPER CASE TEXT
         LA    R0,8
         LA    R1,PFTEXT
         LA    R2,PFTEXT
ANLTX    CLI   0(R1),C' '          COMPRESS TEXT TO LEFT SIDE
         BE    *+L'*+16
         CLR   R1,R2
         BE    *+L'*+6
         MVC   0(1,R2),0(R1)
         LA    R2,1(R2)
         LA    R1,1(R1)
         BCT   R0,ANLTX
         CLR   R2,R1
         BNL   *+L'*+12
         MVI   0(R2),C' '
         LA    R2,1(R2)
         B     *-14
         CLC   PFTEXT(8),=CL8' '   ANY TEXT ?
         BE    RSTRT               NONE
         CLC   PFTEXT(4),=CL4'END '     END TYPED ?
         BE    QUIT                YES, EXIT
         CLC   PFTEXT(5),=CL5'STOP '    STOP TYPED ?
         BE    QUIT                YES, EXIT
         CLC   PFTEXT(5),=CL5'HELP '    HELP TYPED ?
         BE    DHLP                YES, GO DISPLAY TUTORIAL
         CLC   PFTEXT(7),=CL7'CHANGE '  CHANGE TYPED ?
         BE    CHGD                YES, GO CHANGE DISPLAY
         CLI   PFTEXT,C'0'         NUMERIC ENTERED ?
         BNL   INTREQ              YES, GO GET NEW INTERVAL
         CLC   PFTEXT(4),=CL4'CON '
         BE    STPCON
         TM    SWITCH,SCREC
         BO    XCLR
         CLC   PFTEXT(2),=CL2'I '
         BE    STPI
         CLC   PFTEXT(2),=CL2'N '
         BE    STPN
         B     GETTME              IGNORE ANYTHING ELSE
CHGD     XR    R1,R1
         CLI   DITYNU,LSTN
         BE    *+L'*+8
         IC    R1,DITYNU
         LA    R1,1(R1)
         STC   R1,DITYNU
         B     RSTRT
STPN     MVC   OSFRQ(LSF),OSFN
         B     RSTRT
STPI     MVC   OSFRQ(LSF),OSFI
         B     RSTRT
XCLR     CLC   PFTEXT(5),=CL5'COFF '
         BE    STPCOFF
         CLC   PFTEXT(2),=CL2'I '
         BE    STPEI
         CLC   PFTEXT(2),=CL2'N '
         BE    STPEN
         CLI   PFTEXT+L'OSFETS-1,C' '
         BNE   GETTME              IGNORE TOO LONG
         LA    R14,L'OSFETS-1
         LA    R15,PFTEXT
         CLI   0(R15),C'N'
         BE    XCLR1
         LA    R15,1(R15)
         BCT   R14,*-12
         B     XCLR1+L'XCLR1
         MVC   0(*-*,R15),1(R15)
XCLR1    EX    R14,*-6
         LA    R14,L'OSFETS-1
         LA    R15,PFTEXT
         LR    R0,R15
XCLR2    CLI   0(R15),C'+'
         BE    XCLR3
         CLI   0(R15),C'-'
         BE    XCLR3
         LA    R15,1(R15)
         BCT   R14,XCLR2
         B     XCLR4
XCLR3    CLR   R15,R0
         BE    XCLR4
         XC    PFTEXT(1),0(R15)
         XC    0(1,R15),PFTEXT
         XC    PFTEXT(1),0(R15)
XCLR4    LA    R14,L'OSFETS-1
         LA    R15,PFTEXT
         LR    R1,R15
         CLI   0(R15),C'+'
         BE    *+L'*+8
         CLI   0(R15),C'-'
         BNE   XCLR6
         LA    R1,1(R1)
XCLR5    LA    R15,1(R15)
         BCT   R14,XCLR6
         B     XCLR7
XCLR6    CLI   0(R15),C'I'
         BNE   XCLR5
         CLR   R15,R1
         BE    XCLR7
         XC    0(1,R1),0(R15)
         XC    0(1,R15),0(R1)
         XC    0(1,R1),0(R15)
XCLR7    L     R1,=A(OSFETS)
         LA    R14,OSFETL
         L     R15,=A(OSFETE)
         CLC   PFTEXT(L'OSFETS),0(R1)
         BE    *+L'*+8
         BXLE  R1,R14,*-10
         B     GETTME              IGNORE ANYTHING ELSE
         MVC   OSFERQ(LESF),L'OSFETS(R1)
         B     RSTRT
STPEN    MVC   OSFERQ(LESF),OSFEN
         B     RSTRT
STPEI    MVC   OSFERQ(LESF),OSFEI
         B     RSTRT
STPCON   OI    SWITCH,SCREC
         MVC   OSFERQ(LESF),OSFEN
         B     RSTRT
INTREQ   XR    R1,R1
         LA    R0,15
         CLI   PFTEXT,C'0'         TEST NUMERIC RANGE
         BL    GETTME              NO, IGNORE ANYTHING ELSE
         CLI   PFTEXT,C'9'
         BH    GETTME              NO, IGNORE ANYTHING ELSE
         IC    R1,PFTEXT
         NR    R1,R0
         CLI   PFTEXT+1,C' '
         BE    NEWINT
         CLI   PFTEXT+1,C'0'       TEST NUMERIC RANGE
         BL    GETTME              NO, IGNORE ANYTHING ELSE
         CLI   PFTEXT+1,C'9'
         BH    GETTME              NO, IGNORE ANYTHING ELSE
         CLI   PFTEXT+2,C' '       TEST NOT MORE THAN 2 DIGITS
         BNE   GETTME              NO, IGNORE ANYTHING ELSE
         XR    R2,R2
         IC    R2,PFTEXT+1
         NR    R2,R0
         MH    R1,=H'10'
         AR    R1,R2
NEWINT   CH    R1,=H'60'           VALID INTERVAL REQUESTED ?
         BH    GETTME              NO, IGNORE ANYTHING ELSE
         MH    R1,=H'100'          COMPUTE WAIT VALUE
         ST    R1,INTVAL           SET NEW WAIT INTERVAL
         B     GETTME
DHLP     LM    R0,R1,=A(HELPSCL,HELPSC)
         ICM   R1,B'1000',=X'03'   INDICATE FULL SCREEN
        TPUT   (1),(0),R
         XC    PFHRPLY,PFHRPLY
        TGET   PFHRPLY,L'PFHRPLY,ASIS,WAIT
         LTR   R15,R15
         BNZ   QUIT                SOMETHING GOES WRONG ...
         CLI   PFCODE,X'F3'        PF 3 ENTERED ?
         BE    DHLPX               YES, EXIT
         CLI   PFCODE,X'C3'        PF 15 ENTERED (ALT. PF 3) ?
         BE    DHLPX               YES, EXIT
         OC    PFHTXT(2),=CL8' '   YES, UPPER CASE TEXT
         CLI   PFHTXT+1,C' '
         BE    *+L'*+18
         CLI   PFHTXT,C' '
         BNE   *+L'*+10
         MVC   PFHTXT(1),PFHTXT+1
         MVI   PFHTXT+1,C' '
         CLC   PFHTXT(2),=CL8' '   ANY TEXT ?
         BE    DHLP                NONE, REPEAT HELP
         CLC   PFHTXT(2),=CL2'E '  E(ND) TYPED ?
         BE    DHLPX               YES, GO BACK
         CLC   PFHTXT(2),=CL2'S '  S(TOP) TYPED ?
         BNE   DHLP                NO, REPEAT HELP
DHLPX    XC    PFREPLY,PFREPLY
         B     RSTRT
         SPACE 1
*------- TERMINATE PROCESSING.
         SPACE 1
QUIT     MVC   FULLSC(CLEARL),CLEAR     SET CLEAR SEQUENCE
         TM    SWITCH,SCRRS        WAS SCREEN SIZE CHANGED ?
         BZ    ENDCL               NO
        STSIZE SIZELOC=SZLINE,LINELOC=SZSCRN RESTORE ORIGINAL SIZE
        $FS    CC=EWA,MF=(I,FULLSC)
ENDCL    LA    R1,FULLSC
         LA    R0,CLEARL
         ICM   R1,B'1000',=X'03'   INDICATE FULL SCREEN
        TPUT   (1),(0),R
        STFSMODE OFF
         XR    R15,0               RC = 0 -----------------------------
LEAVE   $XRET  CC=(R15),LV=WRKL,TYPE=RENT
INVREQ  IKJRLSA #TSANSW
         LA    R1,INVMS
         B     FINISH
NOTSCR   LA    R1,SCRMS
         B     FINISH
NOTSTD   LA    R1,STDMS
FINISH   BAS   R14,PUTMSG
SETRC    LA    R15,16              RC = 16 ----------------------------
         B     LEAVE
         EJECT
*------- EDIT A CLOCK DIGIT ROUTINE.
*              R0  = WORK REGISTER.
*              R1  = WORK REGISTER.
*              R2  = TIME DIGIT POINTER
*              R3  = CURRENT BUFFER ADDRESS POINTER / UPDATED.
*              R4  = RELATIVE POSITION IN BUFFER LINE / UPDATED.
*              R5  = WORK REGISTER.
*              R6  = WORK REGISTER.
*              R7  = PREVIOUS TIME DIGIT POINTER
*              R8  = LINK REGISTER.
*              R14 = CALL REGISTER.
*              R15 = WORK REGISTER.
         SPACE 1
EDIT     CLC   0(1,R2),0(R7)
         BNE   EDIT1
         LA    R2,1(R2)
         LA    R7,1(R7)
         AH    R4,=H'10'
         BR    R8
EDIT1    MVC   CONV(1),0(R2)
         LA    R2,1(R2)
         LA    R7,1(R7)
         NI    CONV,X'0F'
         XR    R15,R15
         IC    R15,CONV
         SLL   R15,2
         AL    R15,ADDTB
         L     R6,4(R15)
         B     EDIT3
EDITS    CLC   0(1,R2),0(R7)
         BNE   EDIT2
         LA    R2,1(R2)
         LA    R7,1(R7)
         AH    R4,=H'10'
         BR    R8
EDIT2    LA    R2,1(R2)
         LA    R7,1(R7)
         L     R15,ADDTB
         L     R6,0(R15)
EDIT3    LA    R5,6
EDIT4    CLI   0(R6),255
         BNE   *+L'*+6
         AH    R4,=H'10'
         BR    R8
         STC   R5,RCSBA
         LR    R0,R4
         AH    R0,=H'1'
         STC   R0,RCSBA+1
         BAS   R14,GNSBA           GENERATE SBA
         LR    R0,R4
         AH    R0,=H'11'
         STC   R0,RCSBA+1
         BAS   R14,GNRA            GENERATE RA
         CLI   0(R6),0
         BNE   EDIT5
         LR    R0,R4
         AH    R0,=H'1'
         STC   R0,RCSBA+1
         BAS   R14,GNSBA           GENERATE SBA
         MVC   0(LSF,R3),OSFN
         LA    R3,LSF(R3)
         B     EDIT7
EDIT5    CLI   0(R6),1
         BE    EDIT6
         LR    R0,R4
         AH    R0,=H'1'
         STC   R0,RCSBA+1
         BAS   R14,GNSBA           GENERATE SBA
         MVC   0(LSF,R3),OSFN
         LA    R3,LSF(R3)
EDIT6    XR    R0,R0
         IC    R0,0(R6)
         AR    R0,R4
         STC   R0,RCSBA+1
         BAS   R14,GNSBA           GENERATE SBA
         MVC   LCSF(1),1(R6)
         MVC   LCSF+1(1),4(R6)
         XR    R0,R0
         LR    R1,R0
         IC    R0,0(R6)
         IC    R1,1(R6)
         BAS   R14,GNSF            GENERATE SF
         CLI   2(R6),0
         BE    EDIT7
         STC   R5,RCSBA
         XR    R0,R0
         IC    R0,2(R6)
         AR    R0,R4
         STC   R0,RCSBA+1
         BAS   R14,GNSBA           GENERATE SBA
         MVC   LCSF(1),3(R6)
         MVC   LCSF+1(1),5(R6)
         XR    R0,R0
         LR    R1,R0
         IC    R0,2(R6)
         IC    R1,3(R6)
         BAS   R14,GNSF            GENERATE SF
EDIT7    LA    R6,6(R6)
         LA    R5,1(R5)
         B     EDIT4
         SPACE 1
*------- GENERATE SET BUFFER ADDRESS ROUTINE.
*        GENERATE RESET TO ADDRESS ROUTINE.
*              R0  = WORK REGISTER.
*              R1  = WORK REGISTER.
*              R3  = CURRENT BUFFER ADDRESS POINTER / UPDATED.
*              R14 = LINK REGISTER.
*              R15 = WORK REGISTER.
         SPACE 1
GNRA     OI    SWITCH,GRASO
         B     GNSBA+L'GNSBA
GNSBA    NI    SWITCH,255-GRASO
         XR    R0,R0
         LR    R1,R0
         IC    R0,RCSBA+1          COLUMN
         SH    R0,=H'1'
         IC    R1,RCSBA            ROW
         SH    R1,=H'1'
         BZ    *+L'*+4
         MH    R1,=H'80'
         AR    R1,R0
         LR    R15,R1
         XR    R0,R0
         CL    R1,TRSBAM
         BNL   *+L'*+6
         XR    R1,R1
         B     *+L'*+6
         D     R0,TRSBAM
         LR    R0,R1
         MH    R0,TRSBAM+2
         SR    R15,R0
         LA    R0,TRSBA
         AR    R1,R0
         AR    R15,R0
         TM    SWITCH,GRASO
         BO    *+L'*+10
         MVC   0(L'OSBA,R3),OSBA
         B     *+L'*+6
         MVC   0(L'ORA,R3),ORA
         MVC   1(1,R3),0(R1)
         MVC   2(1,R3),0(R15)
         TM    SWITCH,GRASO
         BO    *+L'*+6
         LA    R3,L'OSBA(R3)
         BR    R14
         LA    R3,L'ORA(R3)
         BR    R14
         SPACE 1
*------- GENERATE SET FIELD ROUTINE.
*              R0  = WORK REGISTER.
*              R1  = WORK REGISTER.
*              R3  = CURRENT BUFFER ADDRESS POINTER / UPDATED.
*              R14 = LINK REGISTER.
*              R15 = WORK REGISTER.
         SPACE 1
GNSF     TM    SWITCH,SCREC
         BO    *+L'*+14
         MVC   0(LSF,R3),OSFRQ
         LA    R3,LSF(R3)
         B     *+L'*+10
         MVC   0(LESF,R3),OSFERQ
         LA    R3,LESF(R3)
         XR    R15,R15
         IC    R15,LCSF
         MVC   0(1,R3),LCSF+1
         LA    R3,1(R3)
         BCT   R15,*-10
         AR    R0,R1
         CH    R0,=H'10'
         BER   R14
         MVC   0(LSF,R3),OSFN
         LA    R3,LSF(R3)
         BR    R14
         EJECT
*------- CONSTANTS.
         SPACE 1
         PRINT NOGEN
INVMS    WTO   ' -> Interval value must range from 1 to 60',           X
               ROUTCDE=11,DESC=7,MF=L
SCRMS    WTO   ' -> Sorry, run only on a screen terminal',             X
               ROUTCDE=11,DESC=7,MF=L
STDMS    WTO   ' -> Sorry, need a screen sized 24 x 80',               X
               ROUTCDE=11,DESC=7,MF=L
         PRINT GEN
TRSBA    DC    XL16'40C1C2C3C4C5C6C7C8C94A4B4C4D4E4F'
         DC    XL16'50D1D2D3D4D5D6D7D8D95A5B5C5D5E5F'
         DC    XL16'6061E2E3E4E5E6E7E8E96A6B6C6D6E6F'
         DC    XL16'F0F1F2F3F4F5F6F7F8F97A7B7C7D7E7F'
TRSBAL   EQU   *-TRSBA
TRSBAM   DC    A(TRSBAL)
         SPACE 1
OSBA    $FS    SBA=(1,1),MF=L
ORA     $FS    RA=(1,1,00),MF=L
OSFN    $FS    SF=(PROT),MF=L
LSF      EQU   *-OSFN
OSFI    $FS    SF=(PROT,INT),MF=L
OSFEN   $FS    SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,DEFAULT),MF=L
LESF     EQU   *-OSFEN
OSFEI   $FS    SFE=(ATTR,(PROT,INT),HILITE,DEFAULT,COLOUR,DEFAULT),MF=L
         SPACE 1
FULLSCP $FS    CC=W,MF=L
        $FS    WCC=(KBR,RMDT),SBA=(24,80),MF=L
        $FS    SBA=(1,1),MF=L
SHRTSCL  EQU   *-FULLSCP
        $FS    SF=(PROT,INT),TEXT='===>',MF=L
        $FS    SF=NORMAL,RA=(1,15,00),MF=L
        $FS    SF=(PROT),RA=(1,60,00),MF=L
        $FS    SF=(PROT,INT),MF=L
FULLSCT  EQU   *-FULLSCP
        $FS    TEXT=(' ',20),MF=L
        $FS    SF=(PROT,INT),RA=(2,80,6D),MF=L
        $FS    SF=(PROT),RA=(6,1,00),MF=L
        $FS    SBA=(17,1),SF=(PROT),RA=(20,1,00),MF=L
        $FS    SF=(PROT,INT),RA=(20,80,6D),MF=L
        $FS    SF=(PROT),TEXT=' You may enter a new interval time',MF=L
        $FS    SF=(PROT,INT),TEXT='(1 up to 60)',MF=L
        $FS    SF=(PROT),TEXT='in seconds, or use',MF=L
        $FS    SF=(PROT,INT),TEXT='PF-3',MF=L
        $FS    SF=(PROT),TEXT='(or',RA=(22,1,00),MF=L
        $FS    SF=(PROT),TEXT='enter',MF=L
        $FS    SF=(PROT,INT),TEXT='STOP',MF=L
        $FS    SF=(PROT),TEXT='or',MF=L
        $FS    SF=(PROT,INT),TEXT='END',MF=L
        $FS    SF=(PROT),TEXT='keyword) to terminate. Tutorial :',MF=L
        $FS    SF=(PROT,INT),TEXT='PF-1',MF=L
        $FS    SF=(PROT),TEXT='or',MF=L
        $FS    SF=(PROT,INT),TEXT='HELP',MF=L
        $FS    SF=(PROT),TEXT='keyword.',RA=(23,1,00),MF=L
        $FS    SF=(PROT),TEXT='Change display type :',MF=L
        $FS    SF=(PROT,INT),TEXT='PF-2',MF=L
        $FS    SF=(PROT),TEXT='or',MF=L
        $FS    SF=(PROT,INT),TEXT='CHANGE',MF=L
        $FS    SF=(PROT),TEXT='keyword.',RA=(24,1,00),MF=L
FULLSCL  EQU   *-FULLSCP
         SPACE 1
CMDNT   $FS    SF=(PROT),TEXT='Commands :',MF=L
        $FS    SF=(PROT,INT),TEXT='N',MF=L
        $FS    SF=(PROT),TEXT='and',MF=L
        $FS    SF=(PROT,INT),TEXT='I',MF=L
        $FS    SF=(PROT),TEXT='(enter',MF=L
        $FS    SF=(PROT,INT),TEXT='CON',MF=L
        $FS    SF=(PROT),TEXT='for colours commands).',MF=L
        $FS    SF=(PROT),RA=(1,1,00),MF=L
CMDNTL   EQU   *-CMDNT
         SPACE 1
CMDST   $FS    SF=(PROT),TEXT='Commands :',MF=L
        $FS    SF=(PROT,INT),TEXT='N, I, +, -, B, R, P, G, T, Y',MF=L
        $FS    SF=(PROT),TEXT='and',MF=L
        $FS    SF=(PROT,INT),TEXT='W',MF=L
        $FS    SF=(PROT),TEXT='(enter',MF=L
        $FS    SF=(PROT,INT),TEXT='COFF',MF=L
        $FS    SF=(PROT),TEXT='to reset colours).',MF=L
        $FS    SF=(PROT),RA=(1,1,00),MF=L
CMDSTL   EQU   *-CMDST
         SPACE 1
WSPT    $FS    SBA=(1,6),SF=NORMAL,RA=(1,15,00),MF=L
        $FS    SBA=(1,1),SF=(PT,IC),MF=L
WSPTL    EQU   *-WSPT
         SPACE 1
*------- TURN OFF FULL SCREEN (SPF), CLEAR
*        AND RESET CURSOR TO ROW 1, COL 1.
         SPACE 1
CLEAR   $FS    CC=EW,WCC=(AL,KBR,RMDT),SBA=(24,79),MF=L
        $FS    SBA=(1,1),RA=(1,1,00),MF=L
        $FS    SBA=(1,1),SF=(IC),MF=L
CLEARL   EQU   *-CLEAR
         SPACE 1
        LTORG
         SPACE 1
         DROP  R11,R12             END OF BASES ADDRESSABILITY
         EJECT
        PRINT  NOGEN
HELPSC  $FS    CC=W,MF=L
        $FS    WCC=(KBR,RMDT),SBA=(1,1),RA=(1,1,00),MF=L
        $FS    SBA=(1,1),SF=(PROT,INT),TEXT='Tutorial',MF=L
        $FS    SF=(PROT),TEXT='<------------------------',MF=L
        $FS    SF=(PROT,INT),TEXT='S E I K O',MF=L
        $FS    SF=(PROT),TEXT='------------------------>',MF=L
        $FS    SF=(PROT,INT),TEXT='Tutorial',MF=L
        $FS    SBA=(2,1),SF=(PROT,INT),TEXT='===>',MF=L
        $FS    SF=NORMAL,MF=L
        $FS    SBA=(2,9),SF=(PROT),MF=L
        $FS    SBA=(4,1),SF=(PROT),RA=(4,80,-),MF=L
        $FS    SBA=(5,1),SF=(PROT),TEXT=' Normal commands :',MF=L
        $FS    SF=(PROT,INT),TEXT='N',MF=L
        $FS    SF=(PROT),TEXT=': normal display',MF=L
        $FS    SBA=(5,50),SF=(PROT,INT),TEXT='I',MF=L
        $FS    SF=(PROT),TEXT=': intensive display',MF=L
        $FS    SBA=(6,1),SF=(PROT),RA=(6,80,-),MF=L
        $FS    SBA=(7,1),SF=(PROT),TEXT='Colours commands :',MF=L
        $FS    SF=(PROT,INT),TEXT='+',MF=L
        $FS    SF=(PROT),TEXT=': blink display',MF=L
        $FS    SBA=(7,50),SF=(PROT,INT),TEXT='-',MF=L
        $FS    SF=(PROT),TEXT=': reverse display',MF=L
        $FS    SBA=(8,20),SF=(PROT,INT),TEXT='B',MF=L
        $FS    SF=(PROT),TEXT=': blue display',MF=L
        $FS    SBA=(8,50),SF=(PROT,INT),TEXT='G',MF=L
        $FS    SF=(PROT),TEXT=': green display',MF=L
        $FS    SBA=(9,20),SF=(PROT,INT),TEXT='P',MF=L
        $FS    SF=(PROT),TEXT=': pink display',MF=L
        $FS    SBA=(9,50),SF=(PROT,INT),TEXT='R',MF=L
        $FS    SF=(PROT),TEXT=': red display',MF=L
        $FS    SBA=(10,20),SF=(PROT,INT),TEXT='T',MF=L
        $FS    SF=(PROT),TEXT=': turquoise display',MF=L
        $FS    SBA=(10,50),SF=(PROT,INT),TEXT='W',MF=L
        $FS    SF=(PROT),TEXT=': white display',MF=L
        $FS    SBA=(11,20),SF=(PROT,INT),TEXT='Y',MF=L
        $FS    SF=(PROT),TEXT=': yellow display',MF=L
        $FS    SBA=(12,1),SF=(PROT),RA=(12,80,-),MF=L
        $FS    SBA=(15,1),SF=(PROT,INT),TEXT='I.E. : 1.',MF=L
        $FS    SF=(PROT),TEXT='entering',MF=L
        $FS    SF=(PROT,INT),TEXT='T',MF=L
        $FS    SF=(PROT),TEXT='means normal turquoise display',MF=L
        $FS    SBA=(16,8),SF=(PROT,INT),TEXT='2.',MF=L
        $FS    SF=(PROT),TEXT='entering',MF=L
        $FS    SF=(PROT,INT),TEXT='+P',MF=L
        $FS    SF=(PROT),TEXT='means blinking pink display',MF=L
        $FS    SBA=(17,8),SF=(PROT,INT),TEXT='3.',MF=L
        $FS    SF=(PROT),TEXT='entering',MF=L
        $FS    SF=(PROT,INT),TEXT='-Y',MF=L
        $FS    SF=(PROT),TEXT='means reverse yellow display',MF=L
        $FS    SBA=(20,1),SF=(PROT),TEXT='Alternate',MF=L
        $FS    SF=(PROT,INT),TEXT='PF-keys',MF=L
        $FS    SF=(PROT),TEXT='allowed :',MF=L
        $FS    SF=(PROT,INT),TEXT='PF-1 = PF-13',MF=L
        $FS    SF=(PROT),TEXT='-',MF=L
        $FS    SF=(PROT,INT),TEXT='PF-2 = PF-14',MF=L
        $FS    SF=(PROT),TEXT='-',MF=L
        $FS    SF=(PROT,INT),TEXT='PF-3 = PF-15',MF=L
        $FS    SBA=(23,1),SF=(PROT),TEXT='Use',MF=L
        $FS    SF=(PROT,INT),TEXT='PF-3',MF=L
        $FS    SF=(PROT),TEXT='(or enter',MF=L
        $FS    SF=(PROT,INT),TEXT='S',MF=L
        $FS    SF=(PROT),TEXT='or',MF=L
        $FS    SF=(PROT,INT),TEXT='E',MF=L
        $FS    SF=(PROT),TEXT='keyword) to exit the',MF=L
        $FS    SF=(PROT,INT),TEXT='Tutorial',MF=L
        $FS    SF=(PROT),TEXT='process.',MF=L
        $FS    SBA=(1,1),SF=(PT,IC),MF=L
HELPSCL  EQU   *-HELPSC
         EJECT
OSFETS   DC    CL4'B   '
        $FS    SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,BLUE),MF=L
OSFETL   EQU   *-OSFETS
         DC    CL4'G   '
        $FS    SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,GREEN),MF=L
         DC    CL4'P   '
        $FS    SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,PINK),MF=L
         DC    CL4'R   '
        $FS    SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,RED),MF=L
         DC    CL4'T   '
        $FS    SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,TURQ),MF=L
         DC    CL4'W   '
        $FS    SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,WHITE),MF=L
         DC    CL4'Y   '
        $FS    SFE=(ATTR,(PROT),HILITE,DEFAULT,COLOUR,YELLOW),MF=L
         DC    CL4'+   '
        $FS    SFE=(ATTR,(PROT),HILITE,BLINK,COLOUR,DEFAULT),MF=L
         DC    CL4'-   '
        $FS    SFE=(ATTR,(PROT),HILITE,REVERSE,COLOUR,DEFAULT),MF=L
         DC    CL4'+B  '
        $FS    SFE=(ATTR,(PROT),HILITE,BLINK,COLOUR,BLUE),MF=L
         DC    CL4'+G  '
        $FS    SFE=(ATTR,(PROT),HILITE,BLINK,COLOUR,GREEN),MF=L
         DC    CL4'+P  '
        $FS    SFE=(ATTR,(PROT),HILITE,BLINK,COLOUR,PINK),MF=L
         DC    CL4'+R  '
        $FS    SFE=(ATTR,(PROT),HILITE,BLINK,COLOUR,RED),MF=L
         DC    CL4'+T  '
        $FS    SFE=(ATTR,(PROT),HILITE,BLINK,COLOUR,TURQ),MF=L
         DC    CL4'+W  '
        $FS    SFE=(ATTR,(PROT),HILITE,BLINK,COLOUR,WHITE),MF=L
         DC    CL4'+Y  '
        $FS    SFE=(ATTR,(PROT),HILITE,BLINK,COLOUR,YELLOW),MF=L
         DC    CL4'-B  '
        $FS    SFE=(ATTR,(PROT),HILITE,REVERSE,COLOUR,BLUE),MF=L
         DC    CL4'-G  '
        $FS    SFE=(ATTR,(PROT),HILITE,REVERSE,COLOUR,GREEN),MF=L
         DC    CL4'-P  '
        $FS    SFE=(ATTR,(PROT),HILITE,REVERSE,COLOUR,PINK),MF=L
         DC    CL4'-R  '
        $FS    SFE=(ATTR,(PROT),HILITE,REVERSE,COLOUR,RED),MF=L
         DC    CL4'-T  '
        $FS    SFE=(ATTR,(PROT),HILITE,REVERSE,COLOUR,TURQ),MF=L
         DC    CL4'-W  '
        $FS    SFE=(ATTR,(PROT),HILITE,REVERSE,COLOUR,WHITE),MF=L
         DC    CL4'-Y  '
        $FS    SFE=(ATTR,(PROT),HILITE,REVERSE,COLOUR,YELLOW),MF=L
         DC    CL4'IB  '
        $FS    SFE=(ATTR,(PROT,INT),HILITE,DEFAULT,COLOUR,BLUE),MF=L
         DC    CL4'IG  '
        $FS    SFE=(ATTR,(PROT,INT),HILITE,DEFAULT,COLOUR,GREEN),MF=L
         DC    CL4'IP  '
        $FS    SFE=(ATTR,(PROT,INT),HILITE,DEFAULT,COLOUR,PINK),MF=L
         DC    CL4'IR  '
        $FS    SFE=(ATTR,(PROT,INT),HILITE,DEFAULT,COLOUR,RED),MF=L
         DC    CL4'IT  '
        $FS    SFE=(ATTR,(PROT,INT),HILITE,DEFAULT,COLOUR,TURQ),MF=L
         DC    CL4'IW  '
        $FS    SFE=(ATTR,(PROT,INT),HILITE,DEFAULT,COLOUR,WHITE),MF=L
         DC    CL4'IY  '
        $FS    SFE=(ATTR,(PROT,INT),HILITE,DEFAULT,COLOUR,YELLOW),MF=L
         DC    CL4'+I  '
        $FS    SFE=(ATTR,(PROT,INT),HILITE,BLINK,COLOUR,DEFAULT),MF=L
         DC    CL4'-I  '
        $FS    SFE=(ATTR,(PROT,INT),HILITE,REVERSE,COLOUR,DEFAULT),MF=L
         DC    CL4'+IB '
        $FS    SFE=(ATTR,(PROT,INT),HILITE,BLINK,COLOUR,BLUE),MF=L
         DC    CL4'+IG '
        $FS    SFE=(ATTR,(PROT,INT),HILITE,BLINK,COLOUR,GREEN),MF=L
         DC    CL4'+IP '
        $FS    SFE=(ATTR,(PROT,INT),HILITE,BLINK,COLOUR,PINK),MF=L
         DC    CL4'+IR '
        $FS    SFE=(ATTR,(PROT,INT),HILITE,BLINK,COLOUR,RED),MF=L
         DC    CL4'+IT '
        $FS    SFE=(ATTR,(PROT,INT),HILITE,BLINK,COLOUR,TURQ),MF=L
         DC    CL4'+IW '
        $FS    SFE=(ATTR,(PROT,INT),HILITE,BLINK,COLOUR,WHITE),MF=L
         DC    CL4'+IY '
        $FS    SFE=(ATTR,(PROT,INT),HILITE,BLINK,COLOUR,YELLOW),MF=L
         DC    CL4'-IB '
        $FS    SFE=(ATTR,(PROT,INT),HILITE,REVERSE,COLOUR,BLUE),MF=L
         DC    CL4'-IG '
        $FS    SFE=(ATTR,(PROT,INT),HILITE,REVERSE,COLOUR,GREEN),MF=L
         DC    CL4'-IP '
        $FS    SFE=(ATTR,(PROT,INT),HILITE,REVERSE,COLOUR,PINK),MF=L
         DC    CL4'-IR '
        $FS    SFE=(ATTR,(PROT,INT),HILITE,REVERSE,COLOUR,RED),MF=L
         DC    CL4'-IT '
        $FS    SFE=(ATTR,(PROT,INT),HILITE,REVERSE,COLOUR,TURQ),MF=L
         DC    CL4'-IW '
        $FS    SFE=(ATTR,(PROT,INT),HILITE,REVERSE,COLOUR,WHITE),MF=L
OSFETE   DC    CL4'-IY '
        $FS    SFE=(ATTR,(PROT,INT),HILITE,REVERSE,COLOUR,YELLOW),MF=L
        PRINT  GEN
         SPACE 1
LSTB     DC    A(ATB,ARTB,BTB,BRTB)
LSTN     EQU   (*-LSTB)/L'LSTB-1   MAX. ALLOWED = 255
         EJECT
ATB      DC    A(ATB$,ATB0,ATB1,ATB2,ATB3,ATB4)
         DC    A(ATB5,ATB6,ATB7,ATB8,ATB9)
        PRINT  NOGEN
         SPACE 1
ATB$    @GTB   '         ',                                            1
               '         ',                                            2
               '    **   ',                                            3
               '    **   ',                                            4
               '         ',                                            5
               '         ',                                            6
               '         ',                                            7
               '    **   ',                                            8
               '    **   ',                                            9
               '         ',                                            A
               '         '
         SPACE 1
ATB0    @GTB   '  00000  ',                                            1
               ' 0000000 ',                                            2
               '000   000',                                            3
               '000   000',                                            4
               '000   000',                                            5
               '000   000',                                            6
               '000   000',                                            7
               '000   000',                                            8
               '000   000',                                            9
               ' 0000000 ',                                            A
               '  00000  '
         SPACE 1
ATB1    @GTB   '    11   ',                                            1
               '   111   ',                                            2
               '  1111   ',                                            3
               '    11   ',                                            4
               '    11   ',                                            5
               '    11   ',                                            6
               '    11   ',                                            7
               '    11   ',                                            8
               '    11   ',                                            9
               '    11   ',                                            A
               '  111111 '
         SPACE 1
ATB2    @GTB   '  22222  ',                                            1
               ' 2222222 ',                                            2
               '22     22',                                            3
               '      22 ',                                            4
               '     22  ',                                            5
               '    22   ',                                            6
               '   22    ',                                            7
               '  22     ',                                            8
               ' 22      ',                                            9
               '222222222',                                            A
               '222222222'
         EJECT
ATB3    @GTB   '  33333  ',                                            1
               ' 3333333 ',                                            2
               '33     33',                                            3
               '       33',                                            4
               '      33 ',                                            5
               '     33  ',                                            6
               '      33 ',                                            7
               '       33',                                            8
               '33     33',                                            9
               ' 3333333 ',                                            A
               '  33333  '
         SPACE 1
ATB4    @GTB   '     44  ',                                            1
               '    44   ',                                            2
               '   44    ',                                            3
               '  44     ',                                            4
               ' 44      ',                                            5
               '44   44  ',                                            6
               '444444444',                                            7
               '444444444',                                            8
               '     44  ',                                            9
               '     44  ',                                            A
               '     44  '
         SPACE 1
ATB5    @GTB   '55555555 ',                                            1
               '55555555 ',                                            2
               '55       ',                                            3
               '55       ',                                            4
               '5555555  ',                                            5
               '55555555 ',                                            6
               '      555',                                            7
               '       55',                                            8
               '55     55',                                            9
               ' 5555555 ',                                            A
               '  55555  '
         SPACE 1
ATB6    @GTB   '  666666 ',                                            1
               ' 66666666',                                            2
               '666      ',                                            3
               '66       ',                                            4
               '66666666 ',                                            5
               '666666666',                                            6
               '66    666',                                            7
               '66     66',                                            8
               '666   666',                                            9
               ' 6666666 ',                                            A
               '  66666  '
         EJECT
ATB7    @GTB   '777777777',                                            1
               '777777777',                                            2
               '       77',                                            3
               '      77 ',                                            4
               '     77  ',                                            5
               '    77   ',                                            6
               '   77    ',                                            7
               '  77     ',                                            8
               ' 77      ',                                            9
               ' 77      ',                                            A
               ' 77      '
         SPACE 1
ATB8    @GTB   '  88888  ',                                            1
               ' 8888888 ',                                            2
               '888   888',                                            3
               '88     88',                                            4
               '888   888',                                            5
               ' 8888888 ',                                            6
               '888   888',                                            7
               '88     88',                                            8
               '888   888',                                            9
               ' 8888888 ',                                            A
               '  88888  '
         SPACE 1
ATB9    @GTB   '  99999  ',                                            1
               ' 9999999 ',                                            2
               '999   999',                                            3
               '99     99',                                            4
               '999    99',                                            5
               ' 99999999',                                            6
               '  9999999',                                            7
               '       99',                                            8
               '      999',                                            9
               '99999999 ',                                            A
               ' 999999  '
        PRINT  GEN
         EJECT
ARTB     DC    A(ARTB$,ARTB0,ARTB1,ARTB2,ARTB3,ARTB4)
         DC    A(ARTB5,ARTB6,ARTB7,ARTB8,ARTB9)
        PRINT  NOGEN
         SPACE 1
ARTB$   @GTB   '         ',                                            1
               '         ',                                            2
               '         ',                                            3
               '         ',                                            4
               '   **    ',                                            5
               '         ',                                            6
               '   **    ',                                            7
               '         ',                                            8
               '         ',                                            9
               '         ',                                            A
               '         '
         SPACE 1
ARTB0   @GTB   '         ',                                            1
               '         ',                                            2
               ' 00000   ',                                            3
               '00   00  ',                                            4
               '00   00  ',                                            5
               '00   00  ',                                            6
               '00   00  ',                                            7
               '00   00  ',                                            8
               ' 00000   ',                                            9
               '         ',                                            A
               '         '
         SPACE 1
ARTB1   @GTB   '         ',                                            1
               '         ',                                            2
               '   11    ',                                            3
               '  111    ',                                            4
               '   11    ',                                            5
               '   11    ',                                            6
               '   11    ',                                            7
               '   11    ',                                            8
               '  1111   ',                                            9
               '         ',                                            A
               '         '
         SPACE 1
ARTB2   @GTB   '         ',                                            1
               '         ',                                            2
               ' 22222   ',                                            3
               '22   22  ',                                            4
               '    22   ',                                            5
               '   22    ',                                            6
               '  22     ',                                            7
               ' 22      ',                                            8
               '2222222  ',                                            9
               '         ',                                            A
               '         '
         EJECT
ARTB3   @GTB   '         ',                                            1
               '         ',                                            2
               ' 33333   ',                                            3
               '33   33  ',                                            4
               '     33  ',                                            5
               '    33   ',                                            6
               '     33  ',                                            7
               '33   33  ',                                            8
               ' 33333   ',                                            9
               '         ',                                            A
               '         '
         SPACE 1
ARTB4   @GTB   '         ',                                            1
               '         ',                                            2
               '   44    ',                                            3
               '  44     ',                                            4
               ' 44      ',                                            5
               '44  44   ',                                            6
               '4444444  ',                                            7
               '    44   ',                                            8
               '    44   ',                                            9
               '         ',                                            A
               '         '
         SPACE 1
ARTB5   @GTB   '         ',                                            1
               '         ',                                            2
               '555555   ',                                            3
               '55       ',                                            4
               '55       ',                                            5
               '555555   ',                                            6
               '     55  ',                                            7
               '55   55  ',                                            8
               ' 55555   ',                                            9
               '         ',                                            A
               '         '
         SPACE 1
ARTB6   @GTB   '         ',                                            1
               '         ',                                            2
               ' 66666   ',                                            3
               '66       ',                                            4
               '66       ',                                            5
               '666666   ',                                            6
               '66   66  ',                                            7
               '66   66  ',                                            8
               ' 66666   ',                                            9
               '         ',                                            A
               '         '
         EJECT
ARTB7   @GTB   '         ',                                            1
               '         ',                                            2
               '7777777  ',                                            3
               '     77  ',                                            4
               '    77   ',                                            5
               '   77    ',                                            6
               '  77     ',                                            7
               ' 77      ',                                            8
               '77       ',                                            9
               '         ',                                            A
               '         '
         SPACE 1
ARTB8   @GTB   '         ',                                            1
               '         ',                                            2
               ' 88888   ',                                            3
               '88   88  ',                                            4
               '88   88  ',                                            5
               ' 88888   ',                                            6
               '88   88  ',                                            7
               '88   88  ',                                            8
               ' 88888   ',                                            9
               '         ',                                            A
               '         '
         SPACE 1
ARTB9   @GTB   '         ',                                            1
               '         ',                                            2
               ' 99999   ',                                            3
               '99   99  ',                                            4
               '99   99  ',                                            5
               ' 999999  ',                                            6
               '     99  ',                                            7
               '     99  ',                                            8
               ' 99999   ',                                            9
               '         ',                                            A
               '         '
        PRINT  GEN
         EJECT
BTB      DC    A(BTB$,BTB0,BTB1,BTB2,BTB3,BTB4)
         DC    A(BTB5,BTB6,BTB7,BTB8,BTB9)
        PRINT  NOGEN
         SPACE 1
BTB$    @GTB   '         ',                                            1
               '         ',                                            2
               '    **   ',                                            3
               '    **   ',                                            4
               '         ',                                            5
               '         ',                                            6
               '         ',                                            7
               '    **   ',                                            8
               '    **   ',                                            9
               '         ',                                            A
               '         '
         SPACE 1
BTB0    @GTB   '00000000 ',                                            1
               '00    00 ',                                            2
               '00    00 ',                                            3
               '00    00 ',                                            4
               '00    00 ',                                            5
               '00    00 ',                                            6
               '00    00 ',                                            7
               '00    00 ',                                            8
               '00    00 ',                                            9
               '00    00 ',                                            A
               '00000000 '
         SPACE 1
BTB1    @GTB   '    11   ',                                            1
               '    11   ',                                            2
               '    11   ',                                            3
               '    11   ',                                            4
               '    11   ',                                            5
               '    11   ',                                            6
               '    11   ',                                            7
               '    11   ',                                            8
               '    11   ',                                            9
               '    11   ',                                            A
               '    11   '
         SPACE 1
BTB2    @GTB   '22222222 ',                                            1
               '      22 ',                                            2
               '      22 ',                                            3
               '      22 ',                                            4
               '      22 ',                                            5
               '22222222 ',                                            6
               '22       ',                                            7
               '22       ',                                            8
               '22       ',                                            9
               '22       ',                                            A
               '22222222 '
         EJECT
BTB3    @GTB   '33333333 ',                                            1
               '      33 ',                                            2
               '      33 ',                                            3
               '      33 ',                                            4
               '      33 ',                                            5
               '33333333 ',                                            6
               '      33 ',                                            7
               '      33 ',                                            8
               '      33 ',                                            9
               '      33 ',                                            A
               '33333333 '
         SPACE 1
BTB4    @GTB   '44    44 ',                                            1
               '44    44 ',                                            2
               '44    44 ',                                            3
               '44    44 ',                                            4
               '44    44 ',                                            5
               '44444444 ',                                            6
               '      44 ',                                            7
               '      44 ',                                            8
               '      44 ',                                            9
               '      44 ',                                            A
               '      44 '
         SPACE 1
BTB5    @GTB   '55555555 ',                                            1
               '55       ',                                            2
               '55       ',                                            3
               '55       ',                                            4
               '55       ',                                            5
               '55555555 ',                                            6
               '      55 ',                                            7
               '      55 ',                                            8
               '      55 ',                                            9
               '      55 ',                                            A
               '55555555 '
         SPACE 1
BTB6    @GTB   '66666666 ',                                            1
               '66       ',                                            2
               '66       ',                                            3
               '66       ',                                            4
               '66       ',                                            5
               '66666666 ',                                            6
               '66    66 ',                                            7
               '66    66 ',                                            8
               '66    66 ',                                            9
               '66    66 ',                                            A
               '66666666 '
         EJECT
BTB7    @GTB   '77777777 ',                                            1
               '      77 ',                                            2
               '      77 ',                                            3
               '      77 ',                                            4
               '      77 ',                                            5
               '      77 ',                                            6
               '      77 ',                                            7
               '      77 ',                                            8
               '      77 ',                                            9
               '      77 ',                                            A
               '      77 '
         SPACE 1
BTB8    @GTB   '88888888 ',                                            1
               '88    88 ',                                            2
               '88    88 ',                                            3
               '88    88 ',                                            4
               '88    88 ',                                            5
               '88888888 ',                                            6
               '88    88 ',                                            7
               '88    88 ',                                            8
               '88    88 ',                                            9
               '88    88 ',                                            A
               '88888888 '
         SPACE 1
BTB9    @GTB   '99999999 ',                                            1
               '99    99 ',                                            2
               '99    99 ',                                            3
               '99    99 ',                                            4
               '99    99 ',                                            5
               '99999999 ',                                            6
               '      99 ',                                            7
               '      99 ',                                            8
               '      99 ',                                            9
               '      99 ',                                            A
               '99999999 '
        PRINT  GEN
         EJECT
BRTB     DC    A(BRTB$,BRTB0,BRTB1,BRTB2,BRTB3,BRTB4)
         DC    A(BRTB5,BRTB6,BRTB7,BRTB8,BRTB9)
        PRINT  NOGEN
         SPACE 1
BRTB$   @GTB   '         ',                                            1
               '         ',                                            2
               '         ',                                            3
               '         ',                                            4
               '   **    ',                                            5
               '         ',                                            6
               '   **    ',                                            7
               '         ',                                            8
               '         ',                                            9
               '         ',                                            A
               '         '
         SPACE 1
BRTB0   @GTB   '         ',                                            1
               '         ',                                            2
               '0000000  ',                                            3
               '00   00  ',                                            4
               '00   00  ',                                            5
               '00   00  ',                                            6
               '00   00  ',                                            7
               '00   00  ',                                            8
               '0000000  ',                                            9
               '         ',                                            A
               '         '
         SPACE 1
BRTB1   @GTB   '         ',                                            1
               '         ',                                            2
               '   11    ',                                            3
               '   11    ',                                            4
               '   11    ',                                            5
               '   11    ',                                            6
               '   11    ',                                            7
               '   11    ',                                            8
               '   11    ',                                            9
               '         ',                                            A
               '         '
         SPACE 1
BRTB2   @GTB   '         ',                                            1
               '         ',                                            2
               '2222222  ',                                            3
               '     22  ',                                            4
               '     22  ',                                            5
               '2222222  ',                                            6
               '22       ',                                            7
               '22       ',                                            8
               '2222222  ',                                            9
               '         ',                                            A
               '         '
         EJECT
BRTB3   @GTB   '         ',                                            1
               '         ',                                            2
               '3333333  ',                                            3
               '     33  ',                                            4
               '     33  ',                                            5
               '3333333  ',                                            6
               '     33  ',                                            7
               '     33  ',                                            8
               '3333333  ',                                            9
               '         ',                                            A
               '         '
         SPACE 1
BRTB4   @GTB   '         ',                                            1
               '         ',                                            2
               '44   44  ',                                            3
               '44   44  ',                                            4
               '44   44  ',                                            5
               '4444444  ',                                            6
               '     44  ',                                            7
               '     44  ',                                            8
               '     44  ',                                            9
               '         ',                                            A
               '         '
         SPACE 1
BRTB5   @GTB   '         ',                                            1
               '         ',                                            2
               '5555555  ',                                            3
               '55       ',                                            4
               '55       ',                                            5
               '5555555  ',                                            6
               '     55  ',                                            7
               '     55  ',                                            8
               '5555555  ',                                            9
               '         ',                                            A
               '         '
         SPACE 1
BRTB6   @GTB   '         ',                                            1
               '         ',                                            2
               '6666666  ',                                            3
               '66       ',                                            4
               '66       ',                                            5
               '6666666  ',                                            6
               '66   66  ',                                            7
               '66   66  ',                                            8
               '6666666  ',                                            9
               '         ',                                            A
               '         '
         EJECT
BRTB7   @GTB   '         ',                                            1
               '         ',                                            2
               '7777777  ',                                            3
               '     77  ',                                            4
               '     77  ',                                            5
               '     77  ',                                            6
               '     77  ',                                            7
               '     77  ',                                            8
               '     77  ',                                            9
               '         ',                                            A
               '         '
         SPACE 1
BRTB8   @GTB   '         ',                                            1
               '         ',                                            2
               '8888888  ',                                            3
               '88   88  ',                                            4
               '88   88  ',                                            5
               '8888888  ',                                            6
               '88   88  ',                                            7
               '88   88  ',                                            8
               '8888888  ',                                            9
               '         ',                                            A
               '         '
         SPACE 1
BRTB9   @GTB   '         ',                                            1
               '         ',                                            2
               '9999999  ',                                            3
               '99   99  ',                                            4
               '99   99  ',                                            5
               '9999999  ',                                            6
               '     99  ',                                            7
               '     99  ',                                            8
               '9999999  ',                                            9
               '         ',                                            A
               '         '
        PRINT  GEN
         EJECT
*------- PARSE PARAMETER'S LIST (COMMAND SYNTAX).
         SPACE 1
        PRINT  NOGEN
PARMLST IKJPARM
PDIN    IKJKEYWD
        IKJNAME 'INTERVAL',SUBFLD=SFIN,ALIAS=('I')
SFIN    IKJSUBF
SDIN    IKJIDENT 'INTERVAL IN SECONDS',FIRST=NUMERIC,OTHER=NUMERIC,    C
               MAXLNTH=2
        IKJENDP
        PRINT  GEN
         SPACE 1
WRKDSECT DSECT                     WORK AREAS DESCRIPTION
         SPACE 1
SVA      DS    18F                 SAVE AREA
         SPACE 1
CONV     DS    D
        $TEW$WA
GFDTEL  $GFDATE *-*,*-*,MF=L       GET DATE/TIME PARAMETER LIST
         SPACE 1
INTVAL   DS    F
SZLINE   DS    F
SZSCRN   DS    F
SCBSLG   DS    F
SCDATA   DS    F
ADDTB    DS    F
         SPACE 1
RCSBA    DS    H
LCSF     DS    H
TITDTE   DS    CL20
PRVDTE   DS    CL20
TITTIM   DS    CL8
PRVTIM   DS    CL8
OSFRQ    DS    XL(LSF)
OSFERQ   DS    XL(LESF)
PFREPLY  DS    0CL14
PFHRPLY  DS    0CL8
PFCODE   DS    CL6
PFHTXT   DS    0CL3
PFTEXT   DS    CL9
DITYNU   DS    XL1                 DISPLAY TYPE NUMBER (0-255)
SWITCH   DS    XL1
SCRST    EQU   X'80'               SCREEN SIZE TO BE SET
SCRRS    EQU   X'40'               SCREEN SIZE TO BE RESET
SCRPI    EQU   X'20'               SCREEN PRESERVE INPUT
SCREC    EQU   X'10'               SCREEN EXTENDED COLOURS
GRASO    EQU   X'01'               GENERATE RA SCREEN ORDER
         SPACE 1
         DS    0F                  START OF SCREEN BUFFER
FULLSC   DS    (SCBUFL)X
FULLWCC  EQU   FULLSC+L'FULLSCP,1
         SPACE 1
WRKL     EQU   (((*-SVA)+7)/8)*8   WORK AREAS LENGTH
         SPACE 1
        PRINT  NOGEN
        $TEW$DS
        IHAPSA
        IHAASCB
        IKJTSB LIST=YES
        PRINT  GEN
         SPACE 1
         END

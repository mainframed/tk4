//E0115DMS JOB EDPCSBS1,'SASD',MSGCLASS=X,CLASS=1,NOTIFY=ED115DM
//*
//SAS     EXEC SAS,OPTIONS=NODATE
//DATLIB  DD DSN=SYS1.MAN1,DISP=SHR
//SYSIN   DD *
TITLE SMF 80;
  DATA;
  RETAIN V;
  INFILE DATLIB JFCB=JF MISSOVER;
  IF _N_ = 1 THEN DO;
                  INPUT @;
                  IF INDEX(JF,'SYS1.MAN') ^=0 THEN V=4; ELSE V=0;
                  END;
  IF V=4 THEN
      INPUT    SMFXXLEN PIB2. SMFXXSEG PIB2. @ ;
  INPUT    SMFXXFLG PIB1. SMFXXRTY PIB1.
                       @;
  IF SMFXXRTY = 212 THEN DO;
                        *PUT '212 DETECTED - SKIPPING';
                         DELETE;
                         END;
  INPUT    TIMEOUT SMFSTAMP8.
      SMFXXSID $CHAR4. @;
  IF SMFXXRTY = 80;
  INPUT     SMF80DES   PIB2.  SMF80EVT PIB1.    SMF80EVQ PIB1.
            SMF80USR  $CHAR8. SMF80GRP $CHAR8.  SMF80REL PIB2.
            SMF80CNT  PIB2.   SMF80ATH  PIB1.   SMF80REA PIB1.
            SMF80TLV  PIB1.   SMF80ERR  PIB1.   SMF80TRM $CHAR8.
          SMF80JBN  $CHARZB8. SMF80RST  PIB4.   @ ;
      IF SMF80RST =0 THEN INPUT SMF80RSD PIB4. @;
                     ELSE INPUT  SMF80RSD PD4. @;
   INPUT  SMF80UID  $CHARZB8. SMF80VER  PIB1.
            @ ;
    PUT     SMF80DES   @10    SMF80EVT   +1     SMF80EVQ +1
            SMF80USR   +1     SMF80GRP   @40    SMF80REL +1
            SMF80CNT   @48    SMF80ATH   +1     SMF80REA +1
            SMF80TLV   +1     SMF80ERR   @64    SMF80TRM +1
            SMF80JBN   @88    SMF80RST   +1     SMF80RSD +1
            SMF80UID   @115   SMF80VER
              ;
OFF=SMF80REL+1;
IF SMF80CNT>0 THEN DO;
DO I=0 TO (SMF80CNT-1);
INPUT @OFF SMF80DTP PIB1. SMF80DLN PIB1. @ ;
   PUT      SMF80DTP +2    SMF80DLN ;
   OFF = OFF + 2 + SMF80DLN;
END;
END;

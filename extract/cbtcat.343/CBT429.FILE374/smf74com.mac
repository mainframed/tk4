//C4SYSDM4 JOB EDPCSBS1,'RMF74',MSGCLASS=X,CLASS=1,NOTIFY=ED115DM
//** XA FORMAT
//*
//SAS     EXEC SAS606,OPTIONS=NODATE
//*ATLIB  DD DSN=C4H1.PROD.SMFDUMPW.HOLD,DISP=SHR
//DATLIB  DD DSN=SYS1.MAN1,DISP=SHR
//SYSIN   DD *
TITLE 'SMF 74';
DATA T74 (KEEP = TIMEOUT SMFXXSID
        SMF74SSI          SMF74STY        SMF74TRN
        SMF74RV1          SMF74PRS        SMF74PRL
        SMF74PRN          SMF74DCS        SMF74DCL
        SMF74DCN          SMF74DDS        SMF74DDL
        SMF74DDN)
     PRODUCT (KEEP = TIMEOUT
             SMF74MFV          SMF74PRD           SMF74IST
             SMF74DAT          SMF74INT           SMF74MFL
             SMF74SAM          SMF74RV2           SMF74FLA
             SMF74RLS          SMF74CYC           SMF74MVS
             SMF74IML          SMF74RV9
             )
     DCONTROL (KEEP = TIMEOUT
             SMF74NXT          SMF74TOT           SMF74GEN
             SMF74SUB
             )
     DEVICE   (KEEP = TIMEOUT
             SMF74NUM          SMF74LCU           SMF74RV3
             SMF74CNF          SMF74SER
             SMF74NUX          SMF74SSC           SMF74MEC
             SMF74CNN          SMF74PEN           SMF74ATV
             SMF74DIS          SMF74QUE           SMF74UTL
             SMF74RSV          SMF74DSO           SMF74ALC
             SMF74MTP          SMF74NRD           SMF74COF
             SMF74RV8
             )
          ;
  RETAIN V;
  INFILE DATLIB JFCB=JF; * MISSOVER;
  IF _N_ = 1 THEN DO;
                  INPUT @;
                  IF INDEX(JF,'SYS1.MAN') ^=0 THEN V=4; ELSE V=0;
                  END;
  IF V=4 THEN
      INPUT    SMFXXLEN PIB2. SMFXXSEG PIB2. @ ;
  INPUT    SMFXXFLG PIB1. SMFXXRTY PIB1.
                       @;
  IF SMFXXRTY = 212 THEN DO;
                        *PUT '212 DETECTED - SKIPPING';
                         DELETE;
                         END;
  IF SMFXXRTY = 74;
  INPUT    TIMEOUT SMFSTAMP8.
      SMFXXSID $CHAR4. @;
  IF TIMEPART(TIMEOUT) > '12:00'T THEN STOP;
  INPUT SMF74SSI $CHAR4.  SMF74STY PIB2.  SMF74TRN PIB2.
        SMF74RV1 PIB2.    SMF74PRS PIB4.  SMF74PRL PIB2.
        SMF74PRN PIB2.    SMF74DCS PIB4.  SMF74DCL PIB2.
        SMF74DCN PIB2.    SMF74DDS PIB4.  SMF74DDL PIB2.
        SMF74DDN PIB2. @;
  *UTPUT T74;
  DO I=1 TO SMF74PRN;
  OFF = V -3 + SMF74PRS + (I-1)*SMF74PRL;
  INPUT @OFF SMF74MFV $CHAR2.  SMF74PRD $CHAR8.   SMF74IST PD4.
             SMF74DAT PD4.     SMF74INT RMFDUR.   SMF74MFL PIB2.
             SMF74SAM PIB4.    SMF74RV2 PIB2.     SMF74FLA PIB2.
             SMF74RLS $CHAR4.  SMF74CYC PD4.      SMF74MVS $CHAR8.
             SMF74IML PIB1.    SMF74RV9 PIB3.
  @;
  *UTPUT PRODUCT;
  END;
  DO I=1 TO SMF74DCN;
  OFF = V -3 + SMF74DCS + (I-1)*SMF74DCL;
  INPUT @OFF SMF74NXT PIB2.    SMF74TOT PIB2.     SMF74GEN PIB2.
             SMF74SUB PIB2.
  @;
  *UTPUT DCONTROL;
  END;
  DO I=1 TO SMF74DDN;
  OFF = V -3 + SMF74DDS + (I-1)*SMF74DDL;
  INPUT @OFF SMF74NUM PIB2.    SMF74LCU PIB2.     SMF74RV3 PIB1.
             SMF74CNF PIB1.    SMF74SER $CHAR6.   SMF74TYP PIB4.
             SMF74NUX PIB4.    SMF74SSC PIB4.     SMF74MEC PIB4.
             SMF74CNN PIB4.    SMF74PEN PIB4.     SMF74ATV PIB4.
             SMF74DIS PIB4.    SMF74QUE PIB4.     SMF74UTL PIB4.
             SMF74RSV PIB4.    SMF74DSO PIB4.     SMF74ALC PIB4.
             SMF74MTP PIB4.    SMF74NRD PIB4.     SMF74COF PIB2.
             SMF74RV8 PIB2.
  @;
        SMF74CNN = SMF74CNN * 128 / 1000000;
        SMF74PEN = SMF74PEN * 128 / 1000000;
        SMF74ATV = SMF74ATV * 128 / 1000000;
        SMF74DIS = SMF74DIS * 128 / 1000000;
  IF SMF74TYP = 1342193905 THEN OUTPUT DEVICE;
  *F SMF74SER = 'C48078'   THEN OUTPUT DEVICE;
  END;
RETURN;
*ROC PRINT DATA=T74;
*ORMAT TIMEOUT DATETIME.;
*ROC PRINT DATA=PRODUCT;
*ORMAT TIMEOUT DATETIME.;
*ORMAT SMF74INT TIME.;
*ROC PRINT DATA=DCONTROL;
*ORMAT TIMEOUT DATETIME.;
PROC PRINT DATA=DEVICE;
FORMAT TIMEOUT DATETIME.;
FORMAT SMF74CNN TIME.;
FORMAT SMF74PEN TIME.;
FORMAT SMF74ATV TIME.;
FORMAT SMF74DIS TIME.;
FORMAT SMF74NUM HEX4.;

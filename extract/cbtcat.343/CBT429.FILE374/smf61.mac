//C4SYSDM1 JOB EDPCSBS1,'SMF61',MSGCLASS=X,CLASS=L,NOTIFY=ED115DM
//*
//SAS     EXEC EDSAS608,OPTIONS=NODATE
//DATLIB  DD DSN=EDH1.PROD.SMFDUMPW.HOLD,DISP=SHR
//*ATLIB  DD DSN=C4H1.PROD.SMFDUMPW,DISP=SHR
//*ATLIB  DD DSN=SYS1.MAN4,DISP=SHR
//*ATLIB  DD DSN=C4H1.PROD.C4#1.SMFDAILY.COPY1,DISP=OLD,UNIT=CART,
//* VOL=SER=(600658,603061)
//SYSIN   DD *
TITLE SMF 61;
  DATA  INIT (KEEP =   TIMEOUT SMFXXSID
        SMF61SBS       SMF61SUB
        SMF61POF       SMF61PLN       SMF61PNO
        SMF61DOF       SMF61DLN       SMF61DNO )
      PROD (KEEP = SMF61VER
                   SMF61PNM )
      DAT  (KEEP = SMF61JNM
                   SMF61DT
                   SMF61UID
                   SMF61FNC
                   SMF61CNM
                   SMF61TYP
                   SMF61ENM )
        ;
  RETAIN V;
  INFILE DATLIB      JFCB=JF MISSOVER;
  IF _N_ = 1 THEN DO;
                  INPUT @;
                  IF INDEX(JF,'SYS1.MAN') ^=0 THEN V=4; ELSE V=0;
                  END;
  IF V=4 THEN
      INPUT    SMFXXLEN PIB2. SMFXXSEG PIB2. @ ;
  INPUT    SMFXXFLG PIB1. SMFXXRTY PIB1.
                       @;
  IF SMFXXRTY = 212 THEN DO;
                        *PUT '212 DETECTED - SKIPPING';
                         DELETE;
                         END;
  INPUT    TIMEOUT SMFSTAMP8.
      SMFXXSID $CHAR4. @;
  IF SMFXXRTY = 61;
  INPUT SMF61SBS PIB4. SMF61SUB $CHAR2.
        SMF61POF PIB4. SMF61PLN PIB2. SMF61PNO PIB2.
        SMF61DOF PIB4. SMF61DLN PIB2. SMF61DNO PIB2.  @;
   IF SMF61PNO > 0 THEN DO;
      DO I = 0 TO (SMF61PNO - 1);
        OFF = SMF61POF -3+V + I*SMF61PLN;
        INPUT @OFF SMF61VER   $CHAR2.
                   SMF61PNM   $CHAR8.
        @ ;
      END;
   END;
   IF SMF61DNO > 0 THEN DO;
      DO I = 0 TO (SMF61DNO - 1);
        OFF = SMF61DOF -3+V + I*SMF61DLN;
        INPUT @OFF SMF61JNM   $CHAR8.
                   SMF61DT    SMFSTAMP8.
                   SMF61UID   $CHAR8.
                   SMF61FNC   PIB1.
                   SMF61CNM   $CHAR44.
                   SMF61TYP   $CHAR1.
                   SMF61ENM   $CHAR44.
        @ ;
      END;
   END;
RETURN;
PROC PRINT DATA=INIT;
FORMAT TIMEOUT DATETIME.;
PROC PRINT DATA=PROD;
FORMAT TIMEOUT DATETIME.;
PROC PRINT DATA=DAT;
FORMAT TIMEOUT DATETIME.;
FORMAT SMF61DT DATETIME.;

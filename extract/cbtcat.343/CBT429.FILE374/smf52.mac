//E0115DMS JOB EDPCSBS1,'SASD',MSGCLASS=X,CLASS=1,NOTIFY=ED115DM
//*
//SAS     EXEC SAS,OPTIONS=NODATE
//DATLIB  DD DSN=SYS1.MAN1,DISP=SHR
//SYSIN   DD *
TITLE SMF 52;
  DATA;
  RETAIN V;
  INFILE DATLIB JFCB=JF MISSOVER;
  IF _N_ = 1 THEN DO;
                  INPUT @;
                  IF INDEX(JF,'SYS1.MAN') ^=0 THEN V=4; ELSE V=0;
                  END;
  IF V=4 THEN
      INPUT    SMFXXLEN PIB2. SMFXXSEG PIB2. @ ;
  INPUT    SMFXXFLG PIB1. SMFXXRTY PIB1.
                       @;
  IF SMFXXRTY = 212 THEN DO;
                        *PUT '212 DETECTED - SKIPPING';
                         DELETE;
                         END;
  INPUT    TIMEOUT SMFSTAMP8.
      SMFXXSID $CHAR4. @;
  IF SMFXXRTY = 52;
  INPUT SMFPROFF   PIB2. SMFPRLEN PIB2.    SMFPRNUM PIB2.
        SMFIDOFF   PIB2. SMFIDLEN PIB2.    SMFIDNUM PIB2.
   @ ;
    PUT SMFPROFF   +5    SMFPRLEN +5       SMFPRNUM +5
        SMFIDOFF   +5    SMFIDLEN +5       SMFIDNUM +5
     ;
   IF SMFPRNUM > 0 THEN DO;
      DO I = 0 TO (SMFPRNUM - 1);
        OFF = SMFPROFF -3 + I*SMFPRLEN;
        INPUT @OFF SMFSUBID PIB2. SMFVERNO $CHAR2.
        SMFSYSNM $CHAR8.
        @ ;
          PUT SMFSUBID +5 SMFVERNO +5
        SMFSYSNM
         ;
      END;
   END;
   IF SMFIDNUM > 0 THEN DO;
      DO I = 0 TO (SMFIDNUM - 1);
        OFF = SMFIDOFF -3 + I*SMFIDLEN;
        INPUT @OFF SMF52RMT $CHAR8. SMF52LIN $CHAR8.
        SMF52PSW $CHAR8.
        @ ;
          PUT SMF52RMT +5 SMF52LIN +5
        SMF52PSW
         ;
      END;
   END;

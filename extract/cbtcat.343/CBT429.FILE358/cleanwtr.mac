//CLEANWTR PROC PREFIX='SYS2.OPSWTR',
//             MSGC=H
//*
//*   CLEANWTR IS TH FACILITY USED TO CLEAN UP THE JOURNAL VSAM
//*   FILE. USING THE PARM, IT WILL DELETE VSAM RECORDS BASED ON
//*   ON THE NUMBER OF DAYS(OLD). IT WILL ALSO MONITOR THE AMOUNT
//*   OF VALID REPORTS ON EACH DISKWTR DATASET (DAILY AND ARCHIVE)
//*   AND WILL DYNAMICALLY DELETE ANY DISK OR TAPE DATASET THAT
//*   NO LONGER CONTAINS ANY VALID REPORTS. ADDITIONALLY, ANY JOURNAL
//*   RECORD THAT POINTS TO A NON-EXISTING DAILY/ARCHIVE DATASET
//*   WILL BE DELETED.(SYNC PROCESSING)
//*
//*   THIS PROGRAM WILL OPTIONALLY, BASED ON THE PARM, REPORT ON
//*   LARGE REPORTS IN THE DISKWTR SYSTEM THAT HAVE BEEN CREATED IN
//*   THE LAST 7 DAYS. A THREE(3) DIGIT PARM IS USED AND IS MULTIPLIED
//*   BY 1000 (IE: 020 --> WILL REPORT ON ANY REPORT OVER 20,000 LINES)
//*
//*
//*   THIS PROC ALSO INCORPORATES THE "LOCK" DATASET TO KEEP MULTIPLE
//*   DISKWTR AND SAVEWTR JOBS FROM EXECUTING AT THE SAME TIME.
//*
//*
//*   THIS PROC ALSO EXECUTES IDCAMS TO EXPORT AND IMPORT THE VSAM
//*   JOURNAL FOR REORGANIZATION.
//*
//*   THIS PROC WILL STOP DISKWTR, PERFORM ITS TASKS AND THEN
//*   START SAVEWTR TO OFFLOAD THE ACTIVE AND RESTART DISKWTR
//*
//*
//*
//*   THE FOLLOWING INSURES THAT DISKWTR IS STOPPED
//*   AND FREES THE LOCK DATASET
//*   (CHECK YOUR INSTALLATION STANDARDS FOR THE USE OF "STOP")
//*
//    STOP DISKWTR     <=============== STOP DISKWTR
//*
//*
//*
//*
//STEP01   EXEC PGM=SOUTCLN,
//             PARM='CLEAN,00060,020'
//*            PARM='TEST,00060,020'  <=== SIMULATE DELETES ONLY
//SYSUDUMP DD  SYSOUT=Q
//SYSPRINT DD  SYSOUT=&MSGC
//DELDSN   DD  SYSOUT=&MSGC  <== LISTS DATASET DELETED / KEPT
//BIGRPT   DD  SYSOUT=&MSGC  <== LISTS LARGE SYSOUT REPORTS
//DELREC   DD  SYSOUT=&MSGC  <== LISTS EVERY VSAM RECORD DELETED
//*
//* USE THE FOLLOWING TO DELETE UNWANTED REPORTS / OR DELETE LINE
//*SPECLDEL DD  DSN=XXXX.PARMLIB(XXXXXXXX),DISP=SHR
//*
//*
//* USE THE FOLLOWING TO DELETE ALL VSAM RECORDS FOR THE ACTIVE FILE.
//* BE SURE TO RUN SAVEWTR FIRST AND DO NOT RESTART DISKWTR
//*ACTDEL  DD  DSN=&&DELACT,DISP=(,DELETE),UNIT=SYSDA,SPACE=(TRK,0)
//*
//JOURNAL  DD  DSN=&PREFIX..JOURNAL,DISP=SHR,
//             AMP='AMORG,BUFND=10,BUFNI=2'
//PREFIX   DD  DSN=&PREFIX,                  <== KEEP DISKWTR AND
//             VOL=REF=&PREFIX..ACTIVE,          SAVEWTR FROM STARTING
//             DISP=(OLD,KEEP,KEEP)              USING LOCK DATASET.
//*
//OLDPFX   DD  DSN=SYS2.OPSTAPE.DATA,DISP=(,DELETE),
//             UNIT=SYSDA,SPACE=(TRK,0)
//*
//* OLDPFX IS THE OLD DISKWTRS SECONDARY PREFIX,
//* IT IS USED TO DELETE OLD ENTRIES ONLY
//*
//*
//*
//* ************************************************** */
//* ***  LISTC THE JOURNAL FOR REFERENCE           *** */
//* ************************************************** */
//*
//STEP02   EXEC PGM=PARMSWTR,
//             PARM='@ LISTCAT  ENT(&PREFIX..JOURNAL) ALL'
//PARMSWTR DD  DSN=&&TEMP1,DISP=(,PASS),
//             UNIT=SYSDA,SPACE=(80,5),
//             DCB=(RECFM=FB,LRECL=80,BLKSIZE=6160)
//*
//STEP03   EXEC PGM=IDCAMS
//SYSPRINT DD  SYSOUT=&MSGC
//SYSIN    DD  DSN=&&TEMP1,DISP=(OLD,DELETE)
//*
//*
//* ************************************************** */
//* ***  EXPORT THE JOURNAL                        *** */
//* ************************************************** */
//*
//STEP04   EXEC PGM=PARMSWTR,
//             PARM=('@ EXPORT &PREFIX..JOURNAL -',
//             '@@@ OFILE(EXPOUT) TEMPORARY')
//PARMSWTR DD  DSN=&&TEMP2,DISP=(,PASS),
//             UNIT=SYSDA,SPACE=(80,5),
//             DCB=(RECFM=FB,LRECL=80,BLKSIZE=6160)
//*
//STEP05   EXEC PGM=IDCAMS
//SYSPRINT DD  SYSOUT=&MSGC
//EXPOUT   DD  DSN=&PREFIX..EXPORT,DISP=(,CATLG,DELETE),
//             UNIT=SYSDA,SPACE=(CYL,(25,25),RLSE)
//SYSIN    DD  DSN=&&TEMP2,DISP=(OLD,DELETE)
//*
//STEP06   EXEC PGM=PARMSWTR,
//             PARM=('@ IMPORT INFILE(IMPORTIN) -',
//             '@@@ ODS(&PREFIX..JOURNAL)')
//PARMSWTR DD  DSN=&&TEMP3,DISP=(,PASS),
//             UNIT=SYSDA,SPACE=(80,5),
//             DCB=(RECFM=FB,LRECL=80,BLKSIZE=6160)
//*
//STEP07   EXEC PGM=IDCAMS
//SYSPRINT DD  SYSOUT=&MSGC
//IMPORTIN DD  DSN=&PREFIX..EXPORT,DISP=OLD
//LOCK     DD  DSN=&PREFIX..JOURNAL,DISP=OLD,AMP='AMORG'
//SYSIN    DD  DSN=&&TEMP3,DISP=(OLD,DELETE)
//*
//STEP08   EXEC PGM=IEFBR14,COND=(0,NE,STEP07)
//DD1      DD  DSN=&PREFIX..EXPORT,DISP=(OLD,DELETE)
//*
//*
//START    EXEC PGM=COMMAND,                 <== START SAVEWTR AFTER
//             COND=(0,NE,STEP07),
//             PARM='S SAVEWTR.SAVEWTR'          REORG IS COMPLETE
//*

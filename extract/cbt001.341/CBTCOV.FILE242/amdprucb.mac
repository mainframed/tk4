AMDPRUCB TITLE     'AMDAHL AMDPRDMP UNIT CONTROL BLOCK SCANNING EXIT.'
         MACRO
         REGISTER
         LCLA  &N
.LOOP    ANOP
R&N      EQU   &N
&N       SETA  &N+1
         AIF   (&N LE 15).LOOP
         MEND
         SPACE 2
         MACRO
&L       PRINTBUF &TEXT
         LCLC  &L2
&L2      SETC  '&L'
         AIF   ('&TEXT' EQ '').NOMOVE
&L2      L     R15,ADPLBUF         GET BUFFER ADDRESS.
         MVC   0(L'&TEXT,R15),&TEXT MOVE ITEM INTO BUF'R.
&L2      SETC  ''
.NOMOVE  ANOP
&L2      LA    R1,ABDPL            ADDRESS PARAMETER LIST.
         L     R15,ADPLPRNT        LOAD PRINT ROUTINE ADDRESS.
         BALR  R14,R15             BRANCH TO PRINT SUBROUTINE.
         MEND
         SPACE 2
         MACRO
&LABEL   LOAD  &RESULT,&INPUT,&BADRC=
&LABEL   LA    R0,&INPUT           ADDRESS INPUT AREA.
         LA    R1,ABDPL            ADDRESS PARAMETER LIST.
         L     R15,ADPLMEMA        LOAD MEMORY ROUTINE ADDRESS.
         BALR  R14,R15             BRANCH TO MEMORY SUBROUTINE.
         LTR   R15,R15             TEST RETURN CODE.
         BNZ   &BADRC              NON-ZERO; BRANCH TO EXIT.
         LR    R1,R0               LOAD RESULT POINTER INTO R1.
         ICM   &RESULT,B'1111',0(R1) LOAD AND TEST ACQUIRED STORAGE.
         MEND
         EJECT
         MACRO
&TAG     SYMBL &TEXT
         LCLC  &LABEL
&LABEL   SETC  '&TAG'
         AIF   ('&TAG' NE '').DOIT
&LABEL   SETC  'L&SYSNDX'
.DOIT    ANOP
&LABEL   DC    0C&TEXT,AL1(L'&LABEL),C&TEXT '
         MEND
         SPACE 2
         MACRO
&LABEL   SPECIFIC &FLAG=00,&DISP=00,&VALUE=00,&MSG1=,&MSG2=
         AIF   ('&FLAG' EQ 'ENDTABLE').ENDTAB
         AIF   ('&FLAG' EQ 'ENDGEN').ENDGEN
         AIF   ('&MSG2' NE '').DOUBLE
&LABEL   DC    X'&FLAG&DISP&VALUE.00',AL4(&MSG1)
         MEXIT
.DOUBLE  ANOP
&LABEL   DC    X'&FLAG&DISP&VALUE.F0',AL4(&MSG1),AL4(&MSG2)
         MEXIT
.EXIT    MEXIT
.ENDTAB  ANOP
&LABEL   DC    X'FF'
         MEXIT
.ENDGEN  ANOP
&LABEL   DC    X'FE'
         MEND
         EJECT
***********************************************************************
*                                                                     *
*     THIS PROGRAM IS DESIGNED TO EXECUTE AS AN AMDPRDMP USER EXIT    *
*     OR IPCS VERB EXIT TO FORMAT SELECTED PORTIONS OF THE UNIT       *
*     CONTROL BLOCK.                                                  *
*                                                                     *
*     THE PROGRAM MAY BE EXECUTED WHENEVER THE AMDPRDMP USER VERB     *
*     "UCBSCAN" IS ENCOUNTERED IN THE AMDPRDMP SYSIN FILE.  IN ORDER  *
*     TO RECOGNIZE THE "UCBSCAN" COMMAND, A USER ENTRY MUST BE MADE   *
*     IN THE AMDPRECT USER EXIT MODULE.  APPENDIX "C" OF THE "OS/VS2  *
*     S.P.L.:  SERVICE AIDS" MANUAL DESCRIBES HOW TO PERFORM THIS     *
*     FUNCTION.  NOTE, FOR TESTING PURPOSES, THE USER MAY SUPPLY HIS  *
*     OWN EXIT CONTROL TABLE MODULE IN THE STEPLIB OR JOBLIB.         *
*                                                                     *
*     THE EXIT MAY ALSO BE EXECUTED FROM IPCS BY USING THE IPCS       *
*     "VERBEXIT" SUBCOMMAND FOLLOWED BY THE MODULES NAME (AMDPRUCB).  *
*                                                                     *
*     THE USER MAY SELECT EITHER AN ABBREVIATED LISTING OF ALL THE    *
*     UNIT CONTROL BLOCKS IN THE SYSTEM, OR A DETAILED LISTING OF     *
*     SELECTED UNIT CONTROL BLOCKS.  SYNTAX IS AS FOLLOWS:            *
*                                                                     *
*          UCBSCAN   (NO OPERANDS) - AN ABBREVIATED LIST OF ALL THE   *
*                    U.C.B.S IS PRODUCED.                             *
*                                                                     *
*          UCBSCAN   CCU <-CCU> <,CCU <-CCU> > - DETAILED LISTINGS    *
*                    OF SELECTED U.C.B.S OR RANGES OF U.C.B.S ARE     *
*                    PRODUCED WHERE "CCU" IS THE DEVICE NUMBER OR     *
*                    ADDRESS OF THE UNIT TO BE LISTED.  NOTE THAT     *
*                    IF THE EXIT IS INVOKED AS AN IPCS VERBEXIT,      *
*                    THE OPERANDS MUST BE ENCLOSED IN APOSTROPHES.    *
*                                                                     *
*     THIS PROGRAM FOLLOWS ALL CONVENTIONS SPECIFIED IN THE ABOVE-    *
*     MENTIONED MANUAL.  IT IS REENTRANT AND MAY BE PLACED IN THE     *
*     LINK PACK AREA IF DESIRED.  FOR TESTING, THIS PROGRAM MAY BE    *
*     IN THE USER'S JOB OR STEP LIBRARY.                              *
*                                                                     *
***********************************************************************
         SPACE 1
         REGISTER
         EJECT
***********************************************************************
*                                                                     *
*     PERFORM BASIC HOUSEKEEPING AND ACQUIRE USED-DEPENDENT AREA.     *
*                                                                     *
***********************************************************************
         SPACE 1
AMDPRUCB CSECT ,                   PROGRAM ENTRY POINT.
         USING AMDPRUCB,R15        TEMPORARY ADDRESSABILITY.
         B     START               BRANCH AROUND PROGRAM I.D.
         DROP  R15                 DONE WITH TEMPORARY BASE.
         SPACE 1
         SYMBL 'AMDPRUCB V03M00 &SYSDATE &SYSTIME COPYRIGHT 1985 AMDAHL*
                CORP., SE TOOLS - SETT010, AMDIPCSE'
         SPACE 1
START    STM   R14,R12,12(R13)     SAVE CALLER'S REGISTERS.
         LR    R12,R15             LOAD PROGRAM BASE.
         USING AMDPRUCB,R12        MAKE CODE ADDRESSABLE.
         LR    R10,R1              LOAD PARAMETER ADDRESS IN R10.
         USING ABDPL,R10           MAKE PARM LIST ADDRESSABLE.
         L     R0,DSECTLEN         LOAD LENGTH TO BE GETMAINED.
         ICM   R0,8,ADPLSBPL       GET SUBPOOL # FROM PARM LIST.
         GETMAIN RC,LV=(0)         GET USER DEPENDANT STORAGE.
         LTR   R15,R15             TEST RETURN CODE FROM GETMAIN.
         BNZ   BADGETMN            NON-ZERO, BAD GETMAIN.
         LR    R2,R1               LOAD ADDRESS INTO EVEN REG.
         L     R3,DSECTLEN         LOAD LENGTH TO BE ZEROED.
         XR    R5,R5               SET FILL CHARACTER.
         MVCL  R2,R4               ZERO THE GETMAINED AREA.
         LR    R11,R1              LOAD USER AREA BASE.
         USING $DSECT,R11          MAKE AREA ADDRESSABLE.
         ST    R13,$SAVE+4         FORWARD CHAIN SAVE AREAS.
         LR    R2,R13              HOLD ADDRESS OF OLD.
         LA    R13,$SAVE           ADDRESS NEW SAVE AREA.
         ST    R13,8(,R2)          BACK CHAIN SAVE AREAS.
         SPACE 2
         PRINTBUF TITLE            PRINT OUT THE TITLE LINE.
         PRINTBUF ,                PRINT A BLANK LINE.
         EJECT
***********************************************************************
*                                                                     *
*        A SORTED MAP IS BUILT WITH A FULL-WORD POINTER TO EACH       *
*        UCB IN THE DUMP (THE ADDRESS IS ZERO IF THE UCB IS NOT       *
*        PRESENT).  EVEN THOUGH 370/XA CAN SUPPORT UP TO 65,536       *
*        DEVICES, MVS/XA'S UCB ALLOWS ONLY 3 DIGITS, SO WE WILL       *
*        BUILD ONLY 4,096 ENTRIES IN THE TABLE.                       *
*                                                                     *
***********************************************************************
         SPACE 1
         ICM   R2,15,ADPLCVT       GET CVT ADDRESS FROM PARM LIST.
         BZ    BADCVT              NONE TO BE HAD?  ERROR.
         LOAD  R3,CVTDCB(,R2),BADRC=BADCVT GET LOGREC DCB POINTER.
         BNM   MODE370             HIGH BIT OFF, 370-MODE DUMP.
         SPACE 1
         LOAD  R2,CVTUCBA(,R2),BADRC=BADCVT LOAD POINTER TO FIRST UCB.
XALOOP   DS    0H
         BZ    MAPDONE             ZERO POINTER, MAP IS BUILT.
         LOAD  R3,12(,R2),BADRC=BADUCBP GET DEVICE NUMBER FROM UCB+12.
         ST    R3,$WORD            SAVE RESULT IN A HOLDING AREA.
         TR    $WORD,TRTBL1-C'A'   TRANSLATE TO ZONED.
         PACK  $DOUBLE(5),$WORD(5) PACK INTO BINARY.
         L     R3,$DOUBLE          RE-LOAD INTO REGISTER 3.
         N     R3,=X'00000FFF'     TURN OFF ANY UNWANTED GARBAGE.
         SLL   R3,2                MULTIPLY BY 4.
         ST    R2,$UCBMAP(R3)      SAVE IN CORRESPONDING ADDRESS WORD.
         LOAD  R2,8(,R2),BADRC=BADUCBP LOAD POINTER TO NEXT UCB.
         B     XALOOP              CONTINUE UNTIL ALL UCBS TOUCHED.
         SPACE 1
MODE370  DS    0H
         LOAD  R2,CVTILK2(,R2),BADRC=BADCVT GET PTR. TO LOOKUP TABLE.
LOOP370  DS    0H
         XR    R4,R4               ZONK!
         XI    $FLAG2,1            FLIP/FLOP FLAG BYTE.
         BZ    NOGET               RESULT IS ZERO, DON'T GET WORD.
         LOAD  R5,0(,R2),BADRC=BADLUT LOAD NEXT WORD OF LOOKUP TABLE.
         AH    R2,=H'4'            BUMP LOOKUP-TABLE WORD POINTER.
NOGET    DS    0H
         SLDL  R4,16               SHIFT HALFWORD POINTER TO R4.
         LTR   R4,R4               POINTER = ZERO?
         BZ    LOOP370             YES, SKIP IT.
         CL    R4,=X'0000FFFF'     END-OF-TABLE MARKER?
         BE    MAPDONE             YES, DONE WITH TABLE-BUILD.
         LOAD  R3,12(,R4),BADRC=BADUCBP GET UCB ADDRESS FROM UCB+12.
         ST    R3,$WORD            SAVE RESULT IN A HOLDING AREA.
         TR    $WORD,TRTBL1-C'A'   TRANSLATE TO ZONED.
         PACK  $DOUBLE(5),$WORD(5) PACK INTO BINARY.
         L     R3,$DOUBLE          RE-LOAD INTO REGISTER 3.
         N     R3,=X'00000FFF'     TURN OFF ANY UNWANTED GARBAGE.
         SLL   R3,2                MULTIPLY BY 4.
         ST    R4,$UCBMAP(R3)      SAVE IN CORRESPONDING ADDRESS WORD.
         B     LOOP370             CONTINUE UNTIL ALL UCBS TOUCHED.
         SPACE 1
MAPDONE  DS    0H
         LA    R9,$UCBAREA         ADDRESS U.C.B. WORK AREA.
         USING UCB,R9              MAKE DSECT ADDRESSABLE.
         SPACE 2
***********************************************************************
*                                                                     *
*        IF AN AB/DUMP PARM EXTENSION WAS NOT SPECIFIED, THEN PRINT   *
*        HEADER INFORMATION FOR ALL U.C.B.S.  OTHERWISE, CALL THE     *
*        OPERAND SCANNING SUBROUTINE TO EXTRACT UCB ADDRESS PAIRS.    *
*                                                                     *
***********************************************************************
         SPACE 1
         L     R14,ADPLEXT         LOAD EXTENSION ADDRESS.
         ICM   R14,15,0(R14)       LOAD AND TEST OPERAND POINTER.
         BZ    NOOPERND            NONE, GO DO TOTAL TABLE PRINT.
         ST    R14,$@NEXTOP        SAVE AS NEXT OPERAND ADDRESS.
         SPACE 1
OPLOOP   BAL   R14,SCANOPS         GET NEXT ADDRESS(ES) TO PRINT.
         SPACE 1
         LH    R2,$LOWUCB          GET ADDRESS OF LOWEST UCB
UCBLOOP  DS    0H
         CH    R2,$HIGHUCB         PAST HIGH POINT YET?
         BH    OPLOOP              YES, GET ANOTHER OPERAND.
         LR    R3,R2               LOAD UCB ADDRESS INTO ANOTHER REG.
         LA    R2,1(,R2)           BUMP FOR NEXT PASS.
         SLL   R3,2                MULTIPLY UCB NUMBER BY 4.
         L     R3,$UCBMAP(R3)      LOAD CORRESPONDING POINTER.
         LTR   R3,R3               NON-ZERO POINTER?
         BNZ   FOUNDIT             VALUE FOUND, PROCEED.
         OI    $FLAG,$MISSED1      INDICATE THAT ONE WAS MISSED.
         B     UCBLOOP             AND CONTINUE WITH SCAN.
FOUNDIT  DS    0H
         ST    R3,$WORD            SAVE FOR EXTRACTION ROUTINES.
         ST    R3,$@THIS1          ALSO SAVE FOR DECODING.
         BAL   R14,BUILDUCB        GO CONSTRUCT A U.C.B.
         BAL   R14,PRINTUCB        PRINT OUT THE DETAILS.
         B     UCBLOOP             RETURN THROUGH U.C.B. SCAN.
         SPACE 1
ENDOPS   DS    0H
         TM    $FLAG,$MISSED1      DID WE MISS ANY?
         BNO   NORMLEOJ            NO, JUST EXIT NORMALLY
         PRINTBUF ,                PRINT A NULL LINE.
         PRINTBUF MSG2             PRINT WARNING MESSAGE.
         B     NORMLEOJ            THAT'S ALL FOLKS.
         EJECT
***********************************************************************
*                                                                     *
*       NO OPERANDS WERE SPECIFIED.  PRINT A HEADER FOR EACH U.C.B.   *
*                                                                     *
***********************************************************************
        SPACE 1
NOOPERND DS    0H
         L     R5,ADPLBUF          ADDRESS OUTPUT BUFFER
         XR    R6,R6               ZERO ENTRIES/LINE COUNTER.
         XR    R2,R2               START WITH UCB ADDRESS ZERO.
NOOPLOOP DS    0H
         CH    R2,=H'4096'         AT TOP OF UNIT CONTROL BLOCKS?
         BE    ENDNOOP             YES, WE'RE FINISHED WITH SCAN.
         LR    R1,R2               COPY ADDRESS.
         LA    R2,1(,R2)           INCREMENT FOR NEXT PASS.
         SLL   R1,2                MULTIPLY BY 4.
         L     R1,$UCBMAP(R1)      LOAD ADDRESS OF U.C.B.
         LTR   R1,R1               WAS IT ZERO?
         BZ    NOOPLOOP            POINTER=0, SKIP ENTRY.
         ST    R1,$WORD            SAVE FOR SERVICE ROUTINE.
         BAL   R14,BUILDUCB        GO LOAD UP 10 WORDS OF UCB.
         BAL   R14,BUILDHDR        BUILD SHORT ENTRY.
         LR    R4,R6               LOAD LINE-OFFSET COUNTER.
         MH    R4,=H'20'           MULTIPLY BY ENTRY SIZE.
         LA    R4,0(R5,R4)         DISPLACE INTO OUTPUT BUFFER.
         MVC   0(20,R4),$BUF       MOVE FORMATTED ENTRY INTO BUFFER.
         CH    R6,=H'5'            BUFFER FULL?
         BE    PRINTLNE            YES, PRINT THE LINE.
         MVI   18(R4),C'×'         NO, MOVE IN SEPARATOR.
         LA    R6,1(,R6)           INCREMENT OFFSET COUNTER.
         B     NOOPLOOP            GET NEXT UCB.
         SPACE 1
PRINTLNE DS    0H
         PRINTBUF ,                PRINT THE FORMATTED BUFFER.
         XR    R6,R6               ZERO THE OFFSET COUNTER.
         B     NOOPLOOP            GET THE NEXT UCB.
         SPACE 1
ENDNOOP  DS    0H
         LTR   R6,R6               ANYTHING LEFT IN THE BUFFER?
         BZ    NORMLEOJ            NO, RETURN TO CALLER.
         PRINTBUF ,                YES, PRINT THE BUFFER.
         SPACE 1
NORMLEOJ DS    0H
         L     R0,DSECTLEN         LOAD LENGTH TO FREE.
         ICM   R0,8,ADPLSBPL       LOAD SUBPOOL NUMBER.
         LR    R1,R11              LOAD ADDRESS TO BE FREED.
         L     R13,4(,R13)         BACK UP ONE SAVE AREA.
         FREEMAIN R,A=(1),LV=(0)   FREE THE USER DEPENDANT AREA.
         LM    R14,R12,12(R13)     RESTORE CALLER'S REGISTERS.
         BR    R14                 RETURN TO CALLER.
         EJECT
***********************************************************************
*                                                                     *
*     ERROR MESSAGE AND ABNORMAL RETURN ROUTINES.                     *
*                                                                     *
***********************************************************************
         SPACE 1
BADCVT   DS    0H
         PRINTBUF MSG1             PRINT CVT MISSING MESSAGE.
         B     SETRC4              AND SET BAD RETURN CODE.
         SPACE 1
SCANER12 DS    0H
         PRINTBUF MSG3             PRINT OPERAND SCANNING ERROR MSG.
         LA    R15,12              SET COMPLETION CODE.
         B     SETCC               AND MOVE IT INTO OP. PTR.
         SPACE 1
SCANERR4 DS    0H
         PRINTBUF MSG4             PRINT OPERAND SCANNING ERROR MSG.
         LA    R15,4               SET COMPLETION CODE.
         B     SETCC               AND MOVE IT INTO OP. PTR.
         SPACE 1
SCANERR8 DS    0H
         PRINTBUF MSG5             PRINT OPERAND SCANNING ERROR MSG.
         LA    R15,8               SET COMPLETION CODE.
SETCC    DS    0H
         L     R14,ADPLEXT         GET ADDRESS OF EXTENSION.
         ST    R15,0(,R14)         REPLACE OPERAND POINTER.
         B     NORMLEOJ            AND TERMINATE.
         SPACE 1
BADLUT   DS    0H
         PRINTBUF MSG6             PRINT LOOK-UP ERROR MSG.
         B     SETRC4              AND SET BAD RETURN CODE.
         SPACE 1
BADUCBP  DS    0H
         PRINTBUF MSG7             PRINT U.C.B. ACCESS ERROR MSG.
         B     SETRC4              AND SET BAD RETURN CODE.
         SPACE 1
BADGETMN DS    0H
         L     R13,4(,R13)         RESTORE POINTER TO SAVE AREA.
         LM    R14,R12,12(R13)     RESTORE CALLER'S REGISTERS.
         LA    R15,4               SET RETURN CODE (STG. NOT AVAIL.)
         BR    R14                 RETURN TO CALLER.
         SPACE 1
SETRC4   DS    0H
         LA    R15,4               SET RETURN CODE.
         L     R14,4(,R13)         GET CALLER'S SAVE AREA ADDR.
         ST    R15,8(,R14)         SAVE RETURN CODE IN SAVE AREA.
         B     NORMLEOJ            AND WRAP IT UP.
         EJECT
***********************************************************************
*                                                                     *
*     THIS SUBROUTINE WILL PARSE THE INPUT BUFFER PROVIDED BY THE     *
*     USER ON THE SYSIN FILE, CONSOLE INPUT OR IPCS VERBEXIT PARM.    *
*                                                                     *
*     ON INPUT:                                                       *
*          THE USER VARIABLE "$@NEXTOP" POINTS TO THE NEXT AVAILABLE  *
*          BYTE IN THE INPUT BUFFER.  AT THE FIRST INVOCATION OF      *
*          THE SUBROUTINE, THIS WILL BE THE FIRST BYTE OF THE "CCU"   *
*          U.C.B. SPECIFICATION.  ON SUCCEEDING CALLS, IT WILL POINT  *
*          PAST THE DELIMITING COMMA OF THE PREVIOUS "CCU".           *
*                                                                     *
*     ON OUTPUT:                                                      *
*          IF ONLY ONE "CCU" IS FOUND, IT'S HEXADECIMAL VALUE WILL    *
*          BE STORED IN BOTH THE "$LOWUCB" AND "$HIGHUCB" VARIABLE.   *
*          IF A RANGE OF UCBS ARE SPECIFIED ("CCU-CCU"), THEN THE     *
*          "$LOWUCB" AND "$HIGHUCB" HALFWORD VARIABLES WILL BE SET TO *
*          THE FIRST AND LAST UCBS TO BE PRINTED, RESPECTIVELY.       *
*                                                                     *
*     REGISTER USE:                                                   *
*          ALL REGISTERS ARE SAVED ON ENTRY AND RESTORED ON EXIT.     *
*                                                                     *
*     NORMAL RETURN:                                                  *
*          BRANCH REGISTER R14.                                       *
*                                                                     *
*     UNUSUAL RETURNS:                                                *
*          BRANCH TO "NORMLEOJ" IF NO MORE OPERANDS.                  *
*          BRANCH TO "SCANER12" IF NON-HEXADECIMAL "CCU".             *
*          BRANCH TO "SCANERR4" IF INVALID DELIMITER.                 *
*          BRANCH TO "SCANERR8" IF "CCU" NOT 3 BYTES LONG.            *
*                                                                     *
***********************************************************************
         SPACE 2
SCANOPS  DS    0H
         STM   R14,R12,12(R13)     SAVE CALLER'S REGISTERS.
         NI    $FLAG,255-$THRUFLG  TURN OFF THE RANGE FLAG.
         L     R2,$@NEXTOP         POINT R2 AT NEXT AVAILABLE BYTE.
         CLI   0(R2),C' '          END OF BUFFER?
         BE    ENDOPS              YES, NO MORE TO BE DONE.
         SPACE 1
SCANLOOP DS    0H
         LR    R1,R2               MOVE NEXT BYTE POINTER TO R1.
SCANTXT  DS    0H
         CLI   0(R1),C','          END OF THIS GROUP?
         BE    COMMA               YES, CONVERT IT AND RETURN.
         CLI   0(R1),C'-'          THRU-RANGE SPECIFICATION?
         BE    DASH                YES, CHECK IT OUT.
         CLI   0(R1),C' '          TRAILING BLANK?
         BE    COMMA               YES, TREAT AS IF IT'S A COMMA.
         CLI   0(R1),C'A'          VALID HEXADECIMAL CHARACTER.
         BL    SCANER12            NOT IF LESS THAN "A".
         CLI   0(R1),C'F'          VALID HEXADECIMAL CHARACTER?
         BNH   OKCHAR              YES IF NOT OVER "F".
         CLI   0(R1),C'0'          VALID HEXADECIMAL CHARACTER?
         BL    SCANER12            NOT IF LESS THAN "0".
         CLI   0(R1),C'9'          VALID HEXADECIMAL CHARACTER?
         BH    SCANER12            NOT IF GREATER THAN "9".
OKCHAR   DS    0H
         LA    R1,1(,R1)           CHECK NEXT BYTE.
         B     SCANTXT             LOOP THRU INPUT DATA.
         SPACE 1
DASH     DS    0H
         TM    $FLAG,$THRUFLG      HAVE WE SEEN A DASH YET?
         BO    SCANERR4            YES, DELIMITER ERROR.
         OI    $FLAG,$THRUFLG      NO, TURN ON DASH FLAG.
COMMA    DS    0H
         SR    R1,R2               COMPUTE OPERAND LENGTH.
         CH    R1,=H'3'            CORRECT OPERAND LENGTH?
         BNE   SCANERR8            NO, LENGTH ERROR.
         MVC   $WORD+1(3),0(R2)    MOVE OPERAND TO WORK AREA.
         TR    $WORD,TRTBL1-C'A'   MAKE IT UNPACKED HEX.
         PACK  $DOUBLE(5),$WORD(5) PACK "CCU" TO HEX VALUE.
         L     R15,$DOUBLE         INSERT VALUE INTO A REGISTER.
         N     R15,=X'00000FFF'    TURN OFF ANY GARBAGE.
         CLI   3(R2),C'-'          WAS DELIMITER A DASH?
         BNE   COMMA2              NO, MORE CHECKS TO DO.
         STH   R15,$LOWUCB         LOW VALUE OF THRU-RANGE.
         LA    R2,4(,R2)           POINT TO NEXT OPERAND.
         B     SCANLOOP            AND TRY FOR HIGH VALUE.
COMMA2   DS    0H
         TM    $FLAG,$THRUFLG      COMMA AFTER RANGE SPECIFICATION?
         BNO   LOWSTORE            NO, SAVE IN LOW VALUE.
         STH   R15,$HIGHUCB        YES, HIGH VALUE OF THRU-RANGE.
         B     ENDSCAN             DONE WITH THIS PASS OF SCANNER.
LOWSTORE DS    0H
         STH   R15,$LOWUCB         SAVE VALUE IN LOW POINTER.
         STH   R15,$HIGHUCB        SAVE SAME VALUE IN HIGH POINTER.
ENDSCAN  DS    0H
         LA    R2,4(,R2)           BUMP NEXT OPERAND POINTER.
         ST    R2,$@NEXTOP         SAVE FOR NEXT PASS.
         LM    R14,R12,12(R13)     RESTORE CALLER'S REGISTERS.
         BR    R14                 RETURN TO CALLING ROUTINE.
         EJECT
***********************************************************************
*                                                                     *
*     THIS ROUTINE WILL BUILD A COPY OF A SELECTED UNIT CONTROL       *
*     BLOCK IN THE USER'S WORK AREA.  THIS IS REQUIRED SINCE THE      *
*     370-MODE PRDMP MEMORY ACCESS ROUTINE WILL ONLY RETURN ONE       *
*     BYTE, WORD OR PAGE DEPENDING ON THE BOUNDARY OF THE REQUEST     *
*     ADDRESS.  THIS ROUTINE WILL FIND THE U.C.B. FROM THE LOOK-UP    *
*     TABLE INPUT ADDRESS, AND RETURN TEN CONSECUTIVE WORDS THUS      *
*     BUILDING AS MUCH OF A U.C.B. AS THIS PROGRAM NEEDS (AND MAYBE   *
*     EVEN MORE).                                                     *
*                                                                     *
*     ON INPUT:                                                       *
*          VARIABLE "$WORD" CONTAINS THE ADDRESS OF THE REQUESTED     *
*          U.C.B. IN THE DUMP.                                        *
*                                                                     *
*     ON OUTPUT:                                                      *
*          "$UCBAREA" USER WORK AREA CONTAINS TEN BYTES OF UNIT       *
*          CONTROL BLOCK.  THIS MAY INCLUDE  ANOTHER U.C.B. OR IT MAY *
*          BE INCOMPLETE, HOWEVER, THIS PROGRAM ONLY NEEDS THE 1ST    *
*          40 BYTES OF THE U.C.B. AND OPTIMIZATION BASED ON VARIABLE  *
*          LENGTH U.C.B.S WAS NOT A DESIGN CONSIDERATION.             *
*                                                                     *
*     REGISTER USE:                                                   *
*          ALL REGISTERS ARE SAVED ON ENTRY AND RESTORED ON EXIT.     *
*                                                                     *
*     NORMAL RETURN:                                                  *
*          BRANCH TO REGISTER R14.                                    *
*                                                                     *
*     ABNORMAL RETURNS:                                               *
*          NONE.                                                      *
*                                                                     *
***********************************************************************
         SPACE 2
BUILDUCB DS    0H
         STM   R14,R12,12(R13)     SAVE CALLER'S REGISTERS.
         ST    R13,$SAVE2+4        FORWARD CHAIN.
         LR    R2,R13              HOLD A SECOND.
         LA    R13,$SAVE2          ADDRESS NEW SAVE AREA.
         ST    R13,8(,R2)          BACK CHAIN.
         SPACE 1
         LA    R2,10               PRIME 10-WORD COUNTER.
         LA    R3,$UCBAREA         PRIME OUTPUT POINTER.
         L     R1,$WORD            LOAD VALUE INTO REGISTER.
TOP10    DS    0H
         LOAD  R0,0(,R1),BADRC=BADUCBP LOAD REQUESTED WORD FROM DUMP.
         ST    R0,0(,R3)           SAVE VALUE IN WORK AREA.
         L     R1,$WORD            GET ACCESSED-DATA ADDRESS.
         AH    R1,=H'4'            BUMP POINTER TO NEXT WORD.
         ST    R1,$WORD            SAVE BACK IN WORD.
         LA    R3,4(,R3)           BUMP OUTPUT POINTER.
         BCT   R2,TOP10            LOOP THRU 10 TIMES.
         SPACE 1
         L     R13,4(,R13)         RESTORE SAVE AREA POINTER.
         LM    R14,R12,12(R13)     RESTORE CALLER'S REGISTERS.
         BR    R14                 RETURN TO CALLER.
         EJECT
***********************************************************************
*                                                                     *
*     THIS SUBROUTINE WILL BUILD A "HEADER" BUFFER FOR A UNIT-        *
*     CONTROL-BLOCK WHICH WILL CONTAIN THE 3 CHARACTER U.C.B. NAME,   *
*     AND A DESCRIPTION OF THE DEVICE-TYPE FIELDS.  IF THE U.C.B. IS  *
*     FOR A TAPE OR DISK DRIVE, THE DESCRIPTION FIELD WILL BE A 6     *
*     CHARACTER DEVICE DESCRIPTION AND A 6 CHARACTER VOLUME SERIAL.   *
*     IF THE DESCRIPTION IS FOR A NON-DASD OR NON-TAPE DEVICE, THE    *
*     DESCRIPTION WILL BE AN EXTENDED 14 CHARACTER DEVICE DETAIL.     *
*     THESE HEADER BUFFERS (BUILT IN USER AREA "$BUF") ARE USED BOTH  *
*     FOR SPECIFIC U.C.B. LISTING AND TOTAL ABBREVIATED LISTINGS.     *
*                                                                     *
*     ON ENTRY:                                                       *
*          R9 POINTS TO U.C.B. COPY IN "$UCBAREA".                    *
*                                                                     *
*     ON RETURN:                                                      *
*          R8 POINTS TO THE TOP OF A "SPECIFIC-INFORMATION-TABLE"     *
*               FOR THIS DEVICE TYPE.                                 *
*          "$BUF" CONTAINS HEADER TEXT FOR THIS U.C.B.                *
*                                                                     *
*     REGISTER USAGE:                                                 *
*          WITH THE EXCEPTION OF REGISTER R8, ALL REGISTERS ARE       *
*          SAVED AND RESTORED ON ENTRY AND EXIT RESPECTIVELY.         *
*                                                                     *
*     NORMAL (AND ONLY) RETURN:                                       *
*          BRANCH ON REGISTER R14.                                    *
*                                                                     *
***********************************************************************
         SPACE 2
BUILDHDR DS    0H
         STM   R14,R12,12(R13)     STORE CALLER'S REGISTERS
         LA    R8,GENTBL           ADDRESS "GENERIC" LOOK-UP TABLE.
         USING GENDSECT,R8         MAKE ITS LABELS ADDRESSABLE.
         LA    R1,LGENTBL          LOAD NUMBER OF ENTRIES IN TABLE.
BUILD1   DS    0H
         CLC   UCBTBYT3,GENDEVTP   DOES U.C.B. MATCH GENERIC DEV-TYPE?
         BE    BUILD2              YES, STOP LOOKING.
         LA    R8,LGENENT(,R8)     NO, POINT TO NEXT ENTRY.
         BCT   R1,BUILD1           LOOP THRU 'TILL MATCH.
BUILD2   DS    0H
         MVC   $BUF,BLANKS         CLEAR THE BUFFER.
         MVC   $BUF(3),UCBNAME     MOVE IN EBCDIC U.C.B. NAME.
         ICM   R6,B'1111',GENNADDR ADDRESS DEVICE-NAME TABLE.
         LA    R15,12              ASSUME LONG TEXT LENGTH.
         TM    GENFLAGS,TELCOM     COMMUNICATIONS DEVICE?
         BO    COMMLOOP            YES, SPECIAL LOOK-UP REQUIRED.
         TM    GENFLAGS,VOLSER     VOLUME SERIAL REQUIRED?
         BNO   BUILD3              NO, LENGTH ASSUMPTION CORRECT.
         LA    R15,5               USE SHORT DEVICE NAME LENGTH.
BUILD3   DS    0H
         CLI   0(R6),X'FF'         END OF TABLE?
         BE    MOVENAME            YES, USE DUMMY NAME.
         CLC   UCBTBYT4,0(R6)      DEVICE TYPE MATCHED?
         BE    MOVENAME            YES, WE'VE GOTTA WINNER.
         LA    R6,6(,R6)           POINT TO NEXT DEVICE-TYPE SLOT.
         B     BUILD3              LOOP THRU 'TILL ONE IS FOUND.
MOVENAME DS    0H
         L     R6,2(,R6)           GET ADDRESS OF TEXT TO BE MOVED.
         EX    R15,MVC1            MOVE DATA INTO BUFFER.
         TM    GENFLAGS,VOLSER     VOLUME REQUIRED?
         BNO   ENDBHDR             NO, RETURN.
         MVC   $BUF+11(6),UCBVOLI  MOVE IN VOLUME SERIAL.
         OC    $BUF+11(6),BLANKS   MAKE IT PRINTABLE.
ENDBHDR  DS    0H
         ICM   R8,B'1111',GENSADDR GET SPECIFIC-INFO. TOP OF LIST.
         DROP  R8                  DONE WITH GENERIC TABLE.
         LM    R14,R7,12(R13)      RESTORE A FEW REGISTERS.
         LM    R9,R12,56(R13)      RESTORE ALL EXCEPT R8.
         BR    R14                 RETURN TO CALLER.
         SPACE 2
*** TELECOMMUNICATIONS DEVICES REQUIRE SPECIAL LOOKUP SINCE THEIR
*** DEVICE TYPE IS NOT SIMPLY DETERMINED BY "UCBTBYT4", BUT RATHER,
*** A COMBINATION OF BITS IN "UCBTBYT1" AND "UCBTBYT4".
         SPACE 1
COMMLOOP DS    0H
         CLI   0(R6),X'FF'         END OF TABLE?
         BE    MOVENAME            YES, USE DUMMY NAME.
         L     R4,UCBTBYT1         LOAD UCBTYPE FIELD INTO R4.
         N     R4,=X'0F0000F0'     TURN OFF ALL BUT MODEL AND ADAPTER.
         CLM   R4,B'1000',0(R6)    DO WE MATCH THE MODEL FIELD?
         BNE   BUMPR6              NOPE, SKIP TO NEXT ENTRY.
         CLM   R4,B'0001',1(R6)    DOES THE ADAPTER FIELD MATCH?
         BE    MOVENAME            YES, WE'VE GOT A WINNER.
BUMPR6   DS    0H
         LA    R6,6(,R6)           NO, TRY NEXT TABLE ENTRY.
         B     COMMLOOP            AND LOOP THRY TABLE.
         EJECT
***********************************************************************
*                                                                     *
*     THIS SUBROUTINE WILL DETAIL THE SPECIFIC BITS IN THE UNIT-      *
*     CONTROL BLOCK, AND INVOKE THE PRINT-SERVICES SUBROUTINE TO      *
*     PRINT THE INFORMATION.  THIS ROUTINE IS ONLY USED WHEN INFOR-   *
*     MATION PERTAINING TO SPECIFIC U.C.B.S IS REQUESTED VIA THE      *
*     OPERANDS ON THE USER CONTROL CARD.                              *
*                                                                     *
*     ON ENTRY:                                                       *
*          R9 POINTS TO THE UNIT CONTROL BLOCK COPIED INTO THE        *
*               "$UCBAREA" FIELD OF THE USER WORK AREA.               *
*                                                                     *
*     ON RETURN:                                                      *
*          SPECIFIC INFORMATION WILL BE PRINTED FOR THE SELECTED      *
*          UNIT CONTROL BLOCK.                                        *
*                                                                     *
*     REGISTERS USED:                                                 *
*          ALL REGISTERS ARE SAVED ON ENTRY AND RESTORED ON EXIT.     *
*                                                                     *
*     NORMAL (AND ONLY) RETURN:                                       *
*          BRANCH ON REGISTER R14.                                    *
*                                                                     *
***********************************************************************
         SPACE 2
PRINTUCB DS    0H
         STM   R14,R12,12(R13)     SAVE CALLER'S REGISTERS.
         ST    R13,$SAVE2+4        FORWARD CHAIN.
         LR    R2,R13              HOLD A SECOND.
         LA    R13,$SAVE2          ADDRESS NEW SAVE AREA.
         ST    R13,8(,R2)          BACK CHAIN.
         SPACE 1
         L     R2,ADPLBUF          ADDRESS OUTPUT BUFFER.
         MVC   0(120,R2),BLANKS    MAKE SURE BUFFER IS CLEARED.
         PRINTBUF ,                PRINT BLANK LINE.
         SPACE 1
         BAL   R14,BUILDHDR        BUILD HEADER INFORMATION LINE.
         SPACE 1
*** R8 NOW POINTS TO THE TOP OF THE SPECIFIC INFORMATION TABLE FOR
*** THE SELECTED DEVICE TYPE.  FIRST WE WILL PRINT OUT INFORMATION
*** WHICH IS SPECIFIC TO THIS DEVICE TYPE.
         SPACE 1
         PRINTBUF $BUF             PRINT THE FORMATTED BUFFER.
         MVC   $DOUBLE(4),$@THIS1  SAVE U.C.B. MEMORY ADDRESS.
         MVC   $BUF,BLANKS         BLANK OUT THE BUFFER.
         UNPK  $BUF+14(9),$DOUBLE(5) UNPACK U.C.B. ADDRESS.
         TR    $BUF+14(8),TRTBL2-C'0' MAKE IT PRINTABLE.
         MVI   $BUF+22,C' '        CLEAR OUT SIGN.
         MVC   $BUF(L'UCB@MSG),UCB@MSG MOVE IN MSG. TEXT.
         PRINTBUF $BUF             PRINT THE TEXT.
         SPACE 1
         ICM   R5,3,UCBCHAN        LOAD UP THE DEVICE ADDRESS.
         N     R5,=X'00000FFF'     TURN OFF ANY OTHER GARBAGE.
         ST    R5,$DOUBLE          SAVE R5 IN WORK AREA.
         MVI   $DOUBLE+4,X'F0'     MOVE IN VALID PACKED SIGN.
         MVC   $BUF,BLANKS         CLEAR OUT THE BUFFER AGAIN.
         UNPK  $BUF+11(5),$DOUBLE+2(3) UNPACK DEVICE ADDRESS.
         TR    $BUF+11(4),TRTBL2-C'0' MAKE RESULT PRINTABLE.
         CLC   UCBNAME,$BUF+12     DEVICE AND ALTERNATE THE SAME?
         BE    SKIPALTM            YES, SKIP ALTERNATE PATH MESSAGE.
         MVI   $BUF+15,C' '        CLEAR OUT PACKED SIGN.
         MVC   $BUF(L'ALTMSG),ALTMSG MOVE IN ALTERNATE PATH MSG.
         PRINTBUF $BUF             PRINT THE ALTERNATE PATH INFO.
SKIPALTM DS    0H
         SPACE 1
         PRINTBUF DEVDMSG          SEND "DEVICE-DEPENDENT" MESSAGE.
         USING SPFDSECT,R8         MAKE SPECIFIC INFORMATION AVAIL.
SPFLOOP  DS    0H
         CLI   SPFFLAG,X'00'       NORMAL ENTRY?
         BE    REGULAR             YES, NO PROBLEM.
         CLI   SPFFLAG,X'FE'       END OF SPECIFIC TABLE?
         BNE   DONESPF             NO, MUST BE END OF ALL TABLES.
         PRINTBUF COMMMSG          TELL USER HE'S SEEING COMMON.
         LA    R8,SPFKOMM          ADDRESS DEVICE COMMON TABLE.
         B     SPFLOOP             AND TEST COMMON BITS.
REGULAR  DS    0H
         XR    R6,R6               ZONK R6 FOR INSERT.
         IC    R6,SPFDISP          GET DISPLACEMENT IN U.C.B.
         LA    R6,$UCBAREA(R6)     GET OFFSET INTO U.C.B.
         IC    R5,SPFVALUE         GET BIT VALUE TO TEST.
         EX    R5,TM1              TEST FOR BIT(S) ON IN U.C.B.
         BO    PUTMSG1             BIT ON, ISSUE MESSAGE.
         CLI   SPFFLAG2,X'F0'      IS THERE A MESSAGE FOR BIT-OFF?
         BNE   NEXTSPF             NO, TEST NEXT BIT PATTERN.
         L     R5,SPFMSG2          YES, GET ADDRESS OF SECOND MESSAGE.
         B     PUTMSG              BRANCH AROUND NORMAL LOAD.
PUTMSG1  DS    0H
         L     R5,SPFMSG1          LOAD ADDRESS OF NORMAL MESSAGE.
PUTMSG   DS    0H
         L     R4,ADPLBUF          GET ADDRESS OF OUTPUT BUFFER.
         IC    R3,0(,R5)           INSERT MESSAGE LENGTH.
         BCTR  R3,0                DECREMENT FOR MACHINE MOVE.
         EX    R3,MVC2             MOVE MESSAGE INTO BUFFER.
         PRINTBUF ,                PRINT THE MESSAGE.
         CLI   SPFFLAG2,X'F0'      ALTERNATE MESSAGE EXTENSION?
         BNE   NEXTSPF             NO, DO NORMAL TABLE ADJUST.
         LA    R8,LSPFEXT(,R8)     BUMP PAST EXTENSION.
NEXTSPF  LA    R8,LSPFENT(,R8)     BUMP PAST SPECIFIC ENTRY.
         B     SPFLOOP             AND TRY FOR ANOTHER.
         SPACE 1
DONESPF  DS    0H
         L     R13,4(,R13)         RESTORE SAVE AREA POINTER.
         LM    R14,R12,12(R13)     RESTORE CALLER'S REGISTERS.
         BR    R14                 RETURN TO CALLER.
         EJECT
***********************************************************************
*                                                                     *
*     PROGRAM CONSTANTS, LITERALS AND EXECUTED INSTRUCTIONS.          *
*                                                                     *
***********************************************************************
         SPACE 2
TITLE    DC    C'AMDAHL UNIT CONTROL BLOCK SCANNING PROGRAM.'
MSG1     DC    C'CVT COULD NOT BE ACCESSED.'
MSG2     DC    C'ONE OR MORE UCBS SPECIFIED NOT FOUND IN DUMP.'
MSG3     DC    C'UCB ADDRESS NOT VALID HEXADECIMAL.'
MSG4     DC    C'SYNTAX ERROR ON UCB RANGE SPECIFICATION.'
MSG5     DC    C'UCB ADDRESS NOT 3 CHARACTERS.'
MSG6     DC    C'UCB LOOKUP TABLE COULD NOT BE ACCESSED.'
MSG7     DC    C'UCB COULD NOT BE ACCESSED.'
         SPACE 1
UCB@MSG  DC    C'UCB ADDRESS = '
ALTMSG   DC    C'ALT. PATH = '
COMMMSG  DC    C'COMMON U.C.B. FLAGS:'
DEVDMSG  DC    C'DEVICE-DEPENDENT U.C.B. FLAGS:'
         SPACE 1
BLANKS   DC    CL120' '            A FEW HANDY BLANKS.            84240
         SPACE 1
TRTBL1   DC    X'0A0B0C0D0E0F',42X'00',X'010203040506070809'
TRTBL2   DC    C'0123456789ABCDEF'
         SPACE 1
MVC1     MVC   $BUF+4(0),0(R6)
MVC2     MVC   3(0,R4),1(R5)
TM1      TM    0(R6),0
         SPACE 1
DSECTLEN DC    A($LENGTH)          LENGTH TO BE GETMAINED.
         SPACE 1
CVTILK2  EQU   X'28'               OFFSET IN CVT OF 370-MODE LOOKUP.
CVTDCB   EQU   X'74'               OFFSET IN CVT OF LOGREC DCB ADDR.
CVTUCBA  EQU   X'4E4'              OFFSET IN CVT OF XA'S FIRST UCB.
         SPACE 1
         LTORG ,                   GENERATE LITERAL POOL.
         EJECT
***********************************************************************
*                                                                     *
*     VARIOUS DSECTS USED THROUGHOUT THE CODE:                        *
*                                                                     *
*          1.  $DSECT IS A DSECT MAPPING THE USER DEPENDANT AREA      *
*              WHICH IS GETMAINED AND FREEMAINED EACH TIME THIS       *
*              PRINT DUMP EXIT IS INVOKED.  IT IS USED TO PRESERVE    *
*              REENTRANCY.  IT IS ACQUIRED OUT OF A SUBPOOL WHOSE     *
*              NUMBER IS PASSED VIA THE ABDPL.                        *
*                                                                     *
*          2.  GENDSECT IS USED TO MAP A TABLE OF GENERIC DEVICE      *
*              CLASSES (E.G., DASD, TAPE, ETC.) AND ASSOCIATE         *
*              A SET OF ADDRESSES WITH THESE CLASSES.    THE TWO      *
*              ASSOCIATED ADDRESSES ARE THE ADDRESS OF A DEVICE       *
*              NAME TABLE, AND A SPECIFIC CHARACTERISTICS TABLE.      *
*                                                                     *
*          3.  SPFDSECT IS USED TO MAP A TABLE OF SPECIFIC ATTRIBUTE  *
*              BITS AND ADDRESSES OF MESSAGES TO PRINT IF THE BIT IS  *
*              ON (AND OPTIONALLY, OFF).                              *
*                                                                     *
*          4.  IEFUCBOB MAPS THE UNIT CONTROL BLOCK.                  *
*                                                                     *
*          5.  IHAABDPL MAPS THE ABEND/DUMP PARAMETER LIST.           *
*                                                                     *
***********************************************************************
         SPACE 2
$DSECT   DSECT ,                   USER DEPENDANT AREA.
$SAVE    DS    18A                 SUB-ROUTINE SAVE AREA.
$SAVE2   DS    18A                 2ND-LEVEL SUB-ROUTINE SAVE AREA.
$DOUBLE  DS    D                   CONVERSION WORK AREA.
$WORD    DS    F                   CONVERSION WORK AREA.
$BUF     DS    CL24                TEMPORARY BUFFER.
$UCBAREA DS    10F                 U.C.B. COPY AREA.
$@NEXTOP DS    A                   ADDRESS OF NEXT INPUT OPERAND.
$NEXTUCB DS    A                   ADDRESS OF NEXT LOOKUP TABLE ENTRY.
$@THIS1  DS    A                   ADDRESS OF UCB BEING EXAMINED.
$LOWUCB  DS    H                   LOW UCB COMPARAND AREA.
$HIGHUCB DS    H                   HIGH UCB COMPARAND AREA.
$FLAG    DS    X                   VARIOUS FLAGS AS FOLLOWS:
$THRUFLG EQU   X'80'                - RANGE OF U.C.B.S TO BE PROCESSED.
$MISSED1 EQU   X'40'                - MISSED AT LEAST 1 U.C.B.
$FLAG2   DS    X                   370-MODE LOOKUP TABLE FLIPFLOP FLAG.
         SPACE 1
$UCBMAP  DS    4096A               UCB LOOKUP MAP.
         SPACE 1
$LENGTH  EQU   *-$DSECT            LENGTH TO GETMAIN.
         EJECT
GENDSECT DSECT ,                   GENERIC DEVICE-CLASS TABLE MAP.
GENDEVTP DS    X                   DEVICE CLASS.
GENFLAGS DS    X                   SPECIAL FLAGS.
GENNADDR DS    AL4                 ADDRESS OF DEVICE NAMES.
GENSADDR DS    AL4                 ADDRESS OF SPECIFIC INFO TABLE.
         SPACE 4
SPFDSECT DSECT ,                   SPECIFIC INFORMATION TABLE.
SPFFLAG  DS    X                   FLAG - 00=NORMAL,  F0=EXTRA MSG.,
*                                  FE=END OF SPECIFIC FF=END OF TABLE.
SPFDISP  DS    X                   DISPLACEMENT OF DATA IN UCB.
SPFVALUE DS    X                   COMPARAND VALUE TO BE TESTED.
SPFFLAG2 DS    X                   OPTIONAL EXTRA MESSAGE FLAG.
SPFMSG1  DS    AL4                 ADDRESS OF MESSAGE IF BIT IS ON.
LSPFENT  EQU   *-SPFDSECT          LENGTH OF STANDARD SECTION.
SPFMSG2  DS    AL4                 ADDRESS OF MESSAGE IF BIT IS OFF.
LSPFEXT  EQU   *-SPFMSG2           LENGTH OF EXTENSION.
         SPACE 4
         PRINT ON,NOGEN,NODATA
UCB      DSECT ,                   UNIT CONTROL BLOCK MAP.
         IEFUCBOB ,                GENERATE UCB BLOCK.
         EJECT
         PRINT ON,GEN,NODATA
         IHAABDPL DSECT=YES        GENERATE AB-DUMP PARM LIST.
         EJECT
         PRINT ON,NOGEN,NODATA
AMDPRUCB CSECT ,                   RESUME PROGRAM CONTROL SECTION.
         SPACE 1
GENTBL   DS    0F                  GENERIC DEVICE CLASS TABLE.
         DC    X'8080',AL4(TAPETBL),AL4(SPFTAPE)
LGENENT  EQU   *-GENTBL            LENGTH OF ONE ENTRY.
         DC    X'4100',AL4(CTCATBL),AL4(SPFCTCA)
         DC    X'4040',AL4(COMMTBL),AL4(SPFCOMM)
         DC    X'2080',AL4(DASDTBL),AL4(SPFDASD)
         DC    X'1000',AL4(GRAPTBL),AL4(SPFGRAP)
         DC    X'0800',AL4(UNITTBL),AL4(SPFUNIT)
         DC    X'0400',AL4(CHARTBL),AL4(SPFCHAR)
LGENTBL  EQU   (*-GENTBL)/LGENENT  NUMBER OF ENTRIES.
         DC    X'0200',AL4(DUMMYTBL),AL4(SPFDUMMY)
         SPACE 1
VOLSER   EQU   X'80'               HEADER NEEDS VOLUME SERIAL.
TELCOM   EQU   X'40'               COMMUNICATIONS DEVICE.
         SPACE 4
DASDTBL  DS    0F                 DASD GENERIC TABLE.
         DC    X'0600',AL4(DASD2305)
         DC    X'0700',AL4(DASD23X5)
         DC    X'0800',AL4(DASD2314)
         DC    X'0900',AL4(DASD3330)
         DC    X'0A00',AL4(DASD3340)
         DC    X'0B00',AL4(DASD3350)
         DC    X'0C00',AL4(DASD3375)
         DC    X'0D00',AL4(DASD333X)
         DC    X'0E00',AL4(DASD3380)
         DC    X'FF00',AL4(UNKNOWN)
         SPACE 4
TAPETBL  DS    0F                 TAPE GENERIC TABLE.
         DC    X'0100',AL4(TAPE2400)
         DC    X'0300',AL4(TAPE3400)
         DC    X'8000',AL4(TAPE3480)
         DC    X'FF00',AL4(UNKNOWN)
         SPACE 4
UNITTBL  DS    0F                  UNIT-RECORD GENERIC TABLE.
         DC    X'0100',AL4(UNIT254R)
         DC    X'0200',AL4(UNIT254P)
         DC    X'0300',AL4(UNIT1442)
         DC    X'0400',AL4(UNIT2501)
         DC    X'0500',AL4(UNIT2520)
         DC    X'0600',AL4(UNIT3505)
         DC    X'0800',AL4(UNIT1403)
         DC    X'0900',AL4(UNIT3211)
         DC    X'0A00',AL4(UNIT1443)
         DC    X'0B00',AL4(UNIT3203)
         DC    X'0C00',AL4(UNIT3525)
         DC    X'0E00',AL4(UNIT3800)
         DC    X'1000',AL4(UNIT2671)
         DC    X'1100',AL4(UNIT3263)
         DC    X'1600',AL4(UNIT3890)
         DC    X'1700',AL4(UNIT3886)
         DC    X'1800',AL4(UNIT2495)
         DC    X'1900',AL4(UNIT3895)
         DC    X'1B00',AL4(UNIT1287)
         DC    X'1C00',AL4(UNIT1288)
         DC    X'1D00',AL4(UNIT1419)
         DC    X'1E00',AL4(UNIT14X9)
         DC    X'1F00',AL4(UNIT1275)
         DC    X'2000',AL4(UNIT1052)
         DC    X'2200',AL4(UNIT3210)
         DC    X'2300',AL4(UNIT3215)
         DC    X'3000',AL4(UNIT3213)
         DC    X'3D00',AL4(UNIT7443)
         DC    X'4200',AL4(UNITMSC)
         DC    X'4400',AL4(UNIT3540)
         DC    X'4C00',AL4(UNIT3838)
         DC    X'F100',AL4(UNIT3791)
         DC    X'FF00',AL4(UNKNOWN)
         SPACE 4
COMMTBL  DS    0F                  COMMUNICATIONS GENERIC TABLE.
*** FIRST DIGIT IS BITS 4-7 OF MODEL COMPARAND (UCB+16).
*** SECOND DIGIT IS ADAPTER COMPARAND (UCB+19).
         DC    X'0910',AL4(COM2740B)
         DC    X'0810',AL4(COM2740X)
         DC    X'0790',AL4(COMBSC3)
         DC    X'0710',AL4(COM1050X)
         DC    X'0690',AL4(COMBSC2)
         DC    X'0610',AL4(COM2741P)
         DC    X'0590',AL4(COMBSC1)
         DC    X'0510',AL4(COM2741C)
         DC    X'0410',AL4(COM2740)
         DC    X'0310',AL4(COM2740C)
         DC    X'0240',AL4(COM115A)
         DC    X'0210',AL4(COM1060)
         DC    X'0180',AL4(COM2260)
         DC    X'0160',AL4(COMWTTA)
         DC    X'0150',AL4(COMTWX)
         DC    X'0140',AL4(COM83B3)
         DC    X'0130',AL4(COM1050A)
         DC    X'0120',AL4(COM1030)
         DC    X'0110',AL4(COM1050)
         DC    X'00F0',AL4(COM3791)
         DC    X'0010',AL4(COM2955)
         DC    X'FFFF',AL4(UNKNOWN)
         SPACE 4
GRAPTBL  DS    0F                  GRAPHICS GENERIC TABLE.
         DC    X'0200',AL4(GRAP2250)
         DC    X'0300',AL4(GRAP2260)
         DC    X'0400',AL4(GRAP1053)
         DC    X'0800',AL4(GRAP3066)
         DC    X'0900',AL4(GRAP3277)
         DC    X'0A00',AL4(GRAP3284)
         DC    X'0B00',AL4(GRAP3286)
         DC    X'0C00',AL4(GRAP3158)
         DC    X'0D00',AL4(GRAP3036)
         DC    X'FF00',AL4(UNKNOWN)
         SPACE 4
CHARTBL  DS    0F                   CHARACTER READER GENERIC TABLE.
         DC    X'FF00',AL4(CHARRDR)
         SPACE 4
CTCATBL  DS    0F                  CHANNEL ADAPTER GENERIC TABLE.
         DC    X'FF00',AL4(CTCADAPT)
         SPACE 4
DUMMYTBL DS    0F                  DUMMY U.C.B. GENERIC TABLE.
         DC    X'FF00',AL4(DUMMY)
         SPACE 4
*** SPECIFIC TABLES.
         SPACE 2
SPFTAPE  DS    0F                  SPECIFIC TAPE TABLE.
         SPECIFIC DISP=10,VALUE=40,MSG1=TAPE1040
         SPECIFIC DISP=10,VALUE=20,MSG1=TAPE1020,MSG2=TAPE102X
         SPECIFIC DISP=10,VALUE=10,MSG1=TAPE1010
         SPECIFIC DISP=10,VALUE=04,MSG1=TAPE1004
         SPECIFIC DISP=10,VALUE=02,MSG1=TAPE1002
         SPECIFIC DISP=11,VALUE=80,MSG1=TAPE1180
         SPECIFIC DISP=11,VALUE=40,MSG1=TAPE1140
         SPECIFIC DISP=11,VALUE=20,MSG1=TAPE1120
         SPECIFIC DISP=11,VALUE=10,MSG1=TAPE1110
         SPECIFIC DISP=11,VALUE=08,MSG1=TAPE1108
         SPECIFIC DISP=13,VALUE=02,MSG1=TAPE1302
         SPECIFIC DISP=13,VALUE=01,MSG1=TAPE1301
         SPECIFIC DISP=22,VALUE=80,MSG1=TAPE2280
         SPECIFIC DISP=22,VALUE=20,MSG1=TAPE2220
         SPECIFIC DISP=22,VALUE=10,MSG1=TAPE2210
         SPECIFIC DISP=22,VALUE=08,MSG1=TAPE2208
         SPECIFIC DISP=22,VALUE=04,MSG1=TAPE2204
         SPECIFIC DISP=22,VALUE=02,MSG1=TAPE2202
         SPECIFIC DISP=22,VALUE=01,MSG1=TAPE2201
         SPECIFIC DISP=23,VALUE=80,MSG1=TAPE2380,MSG2=TAPE238X
         SPECIFIC DISP=2B,VALUE=80,MSG1=TAPE2B80
         SPECIFIC DISP=2B,VALUE=40,MSG1=TAPE2B40
         SPECIFIC DISP=2B,VALUE=20,MSG1=TAPE2B20
         SPECIFIC DISP=2C,VALUE=80,MSG1=TAPE2C80
         SPECIFIC DISP=2C,VALUE=40,MSG1=TAPE2C40,MSG2=TAPE2C4X
         SPECIFIC DISP=2C,VALUE=10,MSG1=TAPE2C10
         SPECIFIC DISP=2C,VALUE=08,MSG1=TAPE2C08
         SPECIFIC FLAG=ENDGEN
         SPACE 2
SPFCTCA  DS    0F                  CHANNEL ADAPTER SPECIFIC TABLE.
         SPECIFIC FLAG=ENDGEN
         SPACE 2
SPFCOMM  DS    0F                  COMMUNICATIONS SPECIFIC TABLE.
         SPECIFIC DISP=03,VALUE=02,MSG1=COMM0302
         SPECIFIC DISP=03,VALUE=01,MSG1=COMM0301
         SPECIFIC DISP=10,VALUE=40,MSG1=COMM1040
         SPECIFIC DISP=10,VALUE=20,MSG1=COMM1020,MSG2=COMM102X
         SPECIFIC DISP=10,VALUE=10,MSG1=COMM1010
         SPECIFIC DISP=11,VALUE=80,MSG1=COMM1180
         SPECIFIC DISP=11,VALUE=40,MSG1=COMM1140
         SPECIFIC DISP=11,VALUE=20,MSG1=COMM1120
         SPECIFIC DISP=11,VALUE=10,MSG1=COMM1110
         SPECIFIC FLAG=ENDGEN
         SPACE 2
SPFDASD  DS    0F                  DASD SPECIFIC TABLE.
         SPECIFIC DISP=01,VALUE=40,MSG1=DASD0140
         SPECIFIC DISP=03,VALUE=02,MSG1=DASD0302
         SPECIFIC DISP=10,VALUE=40,MSG1=DASD1040
         SPECIFIC DISP=10,VALUE=20,MSG1=DASD1020,MSG2=DASD102X
         SPECIFIC DISP=10,VALUE=10,MSG1=DASD1010
         SPECIFIC DISP=11,VALUE=40,MSG1=DASD1140
         SPECIFIC DISP=11,VALUE=20,MSG1=DASD1120
         SPECIFIC DISP=11,VALUE=10,MSG1=DASD1110
         SPECIFIC DISP=11,VALUE=08,MSG1=DASD1108
         SPECIFIC DISP=11,VALUE=02,MSG1=DASD1102
         SPECIFIC DISP=11,VALUE=01,MSG1=DASD1101
         SPECIFIC DISP=22,VALUE=80,MSG1=DASD2280
         SPECIFIC DISP=22,VALUE=40,MSG1=DASD2240
         SPECIFIC DISP=22,VALUE=20,MSG1=DASD2220
         SPECIFIC DISP=22,VALUE=10,MSG1=DASD2210
         SPECIFIC DISP=22,VALUE=08,MSG1=DASD2208
         SPECIFIC DISP=22,VALUE=04,MSG1=DASD2204
         SPECIFIC DISP=22,VALUE=02,MSG1=DASD2202
         SPECIFIC DISP=22,VALUE=01,MSG1=DASD2201
         SPECIFIC DISP=23,VALUE=80,MSG1=DASD2380,MSG2=DASD238X
         SPECIFIC DISP=25,VALUE=80,MSG1=DASD2580
         SPECIFIC DISP=25,VALUE=40,MSG1=DASD2540
         SPECIFIC DISP=25,VALUE=20,MSG1=DASD2520
         SPECIFIC DISP=25,VALUE=10,MSG1=DASD2510
         SPECIFIC DISP=25,VALUE=08,MSG1=DASD2508
         SPECIFIC DISP=25,VALUE=04,MSG1=DASD2504
         SPECIFIC DISP=25,VALUE=02,MSG1=DASD2502
         SPECIFIC FLAG=ENDGEN
         SPACE 2
SPFGRAP  DS    0F                  GRAPHICS SPECIFIC TABLE.
         SPECIFIC DISP=01,VALUE=40,MSG1=GRAP0140
         SPECIFIC DISP=03,VALUE=02,MSG1=GRAP0302
         SPECIFIC DISP=03,VALUE=01,MSG1=GRAP0301
         SPECIFIC DISP=18,VALUE=80,MSG1=GRAP1880
         SPECIFIC DISP=18,VALUE=40,MSG1=GRAP1840
         SPECIFIC DISP=18,VALUE=20,MSG1=GRAP1820
         SPECIFIC DISP=18,VALUE=10,MSG1=GRAP1810
         SPECIFIC DISP=1B,VALUE=80,MSG1=GRAP1B80
         SPECIFIC DISP=1B,VALUE=08,MSG1=GRAP1B08
         SPECIFIC DISP=1B,VALUE=04,MSG1=GRAP1B04
         SPECIFIC DISP=1B,VALUE=02,MSG1=GRAP1B02
         SPECIFIC DISP=1B,VALUE=01,MSG1=GRAP1B01
         SPECIFIC DISP=1D,VALUE=80,MSG1=GRAP1D80
         SPECIFIC DISP=1D,VALUE=40,MSG1=GRAP1D40
         SPECIFIC DISP=1D,VALUE=20,MSG1=GRAP1D20
         SPECIFIC DISP=1D,VALUE=10,MSG1=GRAP1D10
         SPECIFIC DISP=1D,VALUE=08,MSG1=GRAP1D08
         SPECIFIC DISP=1D,VALUE=04,MSG1=GRAP1D04
         SPECIFIC DISP=1D,VALUE=02,MSG1=GRAP1D02
         SPECIFIC FLAG=ENDGEN
         SPACE 2
SPFUNIT  DS    0F                  UNIT-RECORD SPECIFIC TABLE.
         SPECIFIC DISP=03,VALUE=02,MSG1=UNIT0302
         SPECIFIC DISP=03,VALUE=01,MSG1=UNIT0301
         SPECIFIC DISP=10,VALUE=40,MSG1=UNIT1040
         SPECIFIC DISP=10,VALUE=20,MSG1=UNIT1020,MSG2=UNIT102X
         SPECIFIC DISP=10,VALUE=10,MSG1=UNIT1010
         SPECIFIC DISP=10,VALUE=01,MSG1=UNIT1001,MSG2=UNIT10X1
         SPECIFIC DISP=11,VALUE=80,MSG1=UNIT1180
         SPECIFIC DISP=11,VALUE=20,MSG1=UNIT1120
         SPECIFIC DISP=11,VALUE=10,MSG1=UNIT1110
         SPECIFIC DISP=11,VALUE=01,MSG1=UNIT1101
         SPECIFIC FLAG=ENDGEN
         SPACE 2
SPFCHAR  DS    0F                  CHARACTER-READER SPECIFIC TABLE.
         SPECIFIC FLAG=ENDGEN
         SPACE 2
SPFDUMMY DS    0F                  DUMMY U.C.B. SPECIFIC TABLE.
         SPECIFIC FLAG=ENDGEN
         SPACE 2
SPFKOMM  DS    0F                  COMMON SPECIFIC TABLE.
         SPECIFIC DISP=00,VALUE=80,MSG1=KOMM0080
         SPECIFIC DISP=00,VALUE=40,MSG1=KOMM0040
         SPECIFIC DISP=00,VALUE=20,MSG1=KOMM0020
         SPECIFIC DISP=00,VALUE=10,MSG1=KOMM0010
         SPECIFIC DISP=00,VALUE=08,MSG1=KOMM0008
         SPECIFIC DISP=00,VALUE=04,MSG1=KOMM0004
         SPECIFIC DISP=00,VALUE=02,MSG1=KOMM0002
         SPECIFIC DISP=00,VALUE=01,MSG1=KOMM0001
         SPECIFIC DISP=01,VALUE=80,MSG1=KOMM0180
         SPECIFIC DISP=01,VALUE=20,MSG1=KOMM0120
         SPECIFIC DISP=01,VALUE=10,MSG1=KOMM0101
         SPECIFIC DISP=01,VALUE=08,MSG1=KOMM0108
         SPECIFIC DISP=01,VALUE=04,MSG1=KOMM0104
         SPECIFIC DISP=01,VALUE=02,MSG1=KOMM0102
         SPECIFIC DISP=01,VALUE=01,MSG1=KOMM0101
         SPECIFIC DISP=03,VALUE=80,MSG1=KOMM0380
         SPECIFIC DISP=03,VALUE=40,MSG1=KOMM0340
         SPECIFIC DISP=03,VALUE=20,MSG1=KOMM0320
         SPECIFIC DISP=03,VALUE=10,MSG1=KOMM0310
         SPECIFIC DISP=03,VALUE=08,MSG1=KOMM0308
         SPECIFIC DISP=03,VALUE=04,MSG1=KOMM0304
         SPECIFIC DISP=06,VALUE=80,MSG1=KOMM0680
         SPECIFIC DISP=06,VALUE=40,MSG1=KOMM0640
         SPECIFIC DISP=06,VALUE=20,MSG1=KOMM0620
         SPECIFIC DISP=06,VALUE=10,MSG1=KOMM0610
         SPECIFIC DISP=06,VALUE=08,MSG1=KOMM0608
         SPECIFIC DISP=06,VALUE=04,MSG1=KOMM0604
         SPECIFIC DISP=06,VALUE=02,MSG1=KOMM0602
         SPECIFIC DISP=06,VALUE=01,MSG1=KOMM0601
         SPECIFIC DISP=07,VALUE=80,MSG1=KOMM0780
         SPECIFIC DISP=07,VALUE=40,MSG1=KOMM0740
         SPECIFIC DISP=07,VALUE=20,MSG1=KOMM0720
         SPECIFIC DISP=07,VALUE=10,MSG1=KOMM0710
         SPECIFIC DISP=07,VALUE=08,MSG1=KOMM0708
         SPECIFIC DISP=07,VALUE=04,MSG1=KOMM0704
         SPECIFIC DISP=07,VALUE=02,MSG1=KOMM0702
         SPECIFIC DISP=07,VALUE=01,MSG1=KOMM0701
         SPECIFIC DISP=08,VALUE=80,MSG1=KOMM0880
         SPECIFIC DISP=08,VALUE=40,MSG1=KOMM0840
         SPECIFIC DISP=08,VALUE=20,MSG1=KOMM0820
         SPECIFIC DISP=08,VALUE=10,MSG1=KOMM0810
         SPECIFIC DISP=0C,VALUE=80,MSG1=KOMM0C80
         SPECIFIC DISP=0C,VALUE=40,MSG1=KOMM0C40
         SPECIFIC DISP=0C,VALUE=20,MSG1=KOMM0C20
         SPECIFIC DISP=0C,VALUE=10,MSG1=KOMM0C10
         SPECIFIC DISP=0C,VALUE=08,MSG1=KOMM0C08
         SPECIFIC DISP=0C,VALUE=04,MSG1=KOMM0C04
         SPECIFIC DISP=0C,VALUE=02,MSG1=KOMM0C02
         SPECIFIC DISP=14,VALUE=80,MSG1=KOMM1480
         SPECIFIC DISP=14,VALUE=40,MSG1=KOMM1440
         SPECIFIC DISP=14,VALUE=20,MSG1=KOMM1420
         SPECIFIC DISP=14,VALUE=10,MSG1=KOMM1410
         SPECIFIC DISP=14,VALUE=08,MSG1=KOMM1408
         SPECIFIC DISP=14,VALUE=04,MSG1=KOMM1404
         SPECIFIC DISP=14,VALUE=02,MSG1=KOMM1402
         SPECIFIC DISP=14,VALUE=01,MSG1=KOMM1401
         SPECIFIC FLAG=ENDTABLE
         EJECT
*** MESSAGE TEXTS AND SUCH.
*** FIRST THE GENERIC MESSAGES.
TAPE2400 DC    CL6'2400'
TAPE3400 DC    CL6'3420'
TAPE3480 DC    CL6'3480'
         SPACE 1
CTCADAPT DC    CL14'CHANNL ADAPTR'
         SPACE 1
COM2955  DC    CL14'2955   IBMTA1'
COM1050  DC    CL14'1050   IBMTA1'
COM1030  DC    CL14'1030   IBMTA2'
COM1050A DC    CL14'1050   IBMTGH'
COM83B3  DC    CL14'83B3   TGH1'
COMTWX   DC    CL14'TWX    TGH2'
COMWTTA  DC    CL14'WTTA   WTTA'
COM2260  DC    CL14'2260   IBMTA3'
COM1060  DC    CL14'1060   IBMTA1'
COM115A  DC    CL14'115A   TGH1'
COM2740C DC    CL14'2740-C IBMTA1'
COM2740  DC    CL14'2740   IBMTA1'
COM2741C DC    CL14'2741-C IBMTA1'
COMBSC1  DC    CL14'BSC1   SYNCH2'
COM2741P DC    CL14'2741-P IBMTA1'
COMBSC2  DC    CL14'BSC2   SYNCH2'
COM1050X DC    CL14'1050X  IBMTA1'
COMBSC3  DC    CL14'BSC3   SYNCH2'
COM2740X DC    CL14'2740-X IBMTA1'
COM2740B DC    CL14'2740-B IBMTA1'
COM3791  DC    CL14'3791   LOC-CU'
         SPACE 2
DASD2305 DC    CL6'2305-1'
DASD23X5 DC    CL6'2305-2'
DASD2314 DC    CL6'2314/9'
DASD3330 DC    CL6'3330'
DASD3340 DC    CL6'3340'
DASD3350 DC    CL6'3350'
DASD3375 DC    CL6'3375'
DASD333X DC    CL6'3330-1'
DASD3380 DC    CL6'3380'
         SPACE 2
GRAP2250 DC    CL14'2250   DISPLY'
GRAP2260 DC    CL14'2260   DISPLY'
GRAP1053 DC    CL14'1053   PRINTR'
GRAP3036 DC    CL14'3036   CONSOL'
GRAP3066 DC    CL14'3066   CONSOL'
GRAP3277 DC    CL14'3277   DISPLY'
GRAP3284 DC    CL14'3284   PRINTR'
GRAP3286 DC    CL14'3286   PRINTR'
GRAP3158 DC    CL14'3158   CONSOL'
         SPACE 2
UNIT254R DC    CL14'2540   READER'
UNIT254P DC    CL14'2540   PUNCH'
UNIT1442 DC    CL14'1442   RD/PCH'
UNIT2501 DC    CL14'2501   READER'
UNIT2520 DC    CL14'2520   RD/PCH'
UNIT3505 DC    CL14'3505   READER'
UNIT1403 DC    CL14'1403/4 PRINTR'
UNIT3211 DC    CL14'3211   PRINTR'
UNIT1443 DC    CL14'1443N1 PRINTR'
UNIT3203 DC    CL14'3203   PRINTR'
UNIT3525 DC    CL14'3525   PUNCH'
UNIT3800 DC    CL14'3800   SUBSYS'
UNIT2671 DC    CL14'2671   TAPERD'
UNIT3263 DC    CL14'3263   PRINTR'
UNIT2495 DC    CL14'2495   TAPERD'
UNIT1287 DC    CL14'1287   OPT.RD'
UNIT1288 DC    CL14'1288   OPGRDR'
UNIT1419 DC    CL14'1419   MCR/CU'
UNIT14X9 DC    CL14'1419   MAG.RD'
UNIT1275 DC    CL14'1275   OPT.RD'
UNIT1052 DC    CL14'1052   CONSOL'
UNIT3210 DC    CL14'3210   CONSOL'
UNIT3215 DC    CL14'3215   CONSOL'
UNIT3213 DC    CL14'3213   PRINTR'
UNITMSC  DC    CL14'3851   MSC'
UNIT3791 DC    CL14'3791   SUBSYS'
UNIT3890 DC    CL14'3890   DOC.PR'
UNIT3886 DC    CL14'3886   OCR'
UNIT3895 DC    CL14'3895   DOC.RD'
UNIT7443 DC    CL14'7443   SRV.UN'
UNIT3540 DC    CL14'3540   FLOPPY'
UNIT3838 DC    CL14'3838   ARRAYP'
         SPACE 2
CHARRDR  DC    CL14'CHAR   READER'
         SPACE 2
UNKNOWN  DC    CL14'????? UNKNOWN'
         SPACE 2
DUMMY    DC    CL14'DUMMY  DUMMY'
         SPACE 4
*** SPECIFIC CHARACTERISTIC TEXTS.
         SPACE 2
TAPE0301 SYMBL 'UCBDADI  - STANDARD TAPE LABELS HAVE BEEN VERIFIED FOR *
               THIS VOLUME'
TAPE1040 SYMBL 'MT1HEX40 - OVERRUNNABLE DEVICE'
TAPE1020 SYMBL 'MT1HEX20 - BURST MODE'
TAPE102X SYMBL 'MT1HEX20 - BYTE MODE'
TAPE1010 SYMBL 'MT1HEX10 - DATA CHAINING'
TAPE1004 SYMBL 'MT1HEX04 - 1600 BPI'
TAPE1002 SYMBL 'MT1HEX02 - 6250 BPI'
TAPE1180 SYMBL 'MT2HEX80 - 7-TRACK COMPATIBILITY'
TAPE1140 SYMBL 'MT2HEX40 - DATA CONVERSION'
TAPE1120 SYMBL 'MT2HEX20 - DUAL DENSITY (800/1600 BPI)'
TAPE1110 SYMBL 'MT2HEX10 - DUAL DENSITY (1600/6250 BPI)'
TAPE1108 SYMBL 'MT2HEX08 - READ/WRITE TAPE CONTROL'
TAPE1302 SYMBL 'MT4HEX03 - 3400 SERIES UNIT'
TAPE1301 SYMBL 'MT4HEX01 - 2400 SERIES UNIT'
TAPE2280 SYMBL 'UCBDVSHR - DEVICE NOT SHARABLE AMONG SEVERAL CPU''S'
TAPE2220 SYMBL 'UCBBALB  - ADDITIONAL VOLUME LABEL PROCESSING'
TAPE2210 SYMBL 'UCBBPRV  - PRIVATE VOLUME'
TAPE2208 SYMBL 'UCBBPUB  - PUBLIC USE VOLUME'
TAPE2204 SYMBL 'UCBBSTR  - STORAGE USE VOLUME'
TAPE2202 SYMBL 'UCBSHAR  - VOLUME SHARABLE AMONG JOB STEPS'
TAPE2201 SYMBL 'UCBBNUL  - DEMOUNT OR MOUNT REQUESTS HAVE BEEN ISSUED T*
               O MCS'
TAPE2380 SYMBL 'UCBMOUNT - MULTIPLE FUNCTION LABEL PROCESSING FLAG = 1'
TAPE238X SYMBL 'UCBMOUNT - MULTIPLE FUNCTION LABEL PROCESSING FLAG = 0'
TAPE2B80 SYMBL 'UCBNLTP  - TAPE VOLUME DOES NOT CONTAIN LABELS'
TAPE2B40 SYMBL 'UCBNSLTP - TAPE CONTAINS NON-STANDARD LABELS'
TAPE2B20 SYMBL 'UCBDQDSP - DEQUEUE TAPE VOLUME WHEN DEMOUNTED'
TAPE2C80 SYMBL 'UCBESV   - ERROR STATISTICS BY VOLUME (ESV) RECORDS KEP*
               T'
TAPE2C40 SYMBL 'UCBESVC  - ESV RECORDS SENT TO CONSOLE'
TAPE2C4X SYMBL 'UCBESVC  - ESV RECORDS SENT TO SYS1.MAN (X OR Y)'
TAPE2C10 SYMBL 'UCBERPC  - AN ERROR RECOVERY PROCEDURE HAS CONTROL'
TAPE2C08 SYMBL 'UCBESVE  - AN ESV RECORD HAS BEEN ISSUED FOR THIS VOLUM*
               E BECAUSE OF AN EOV CONDITION'
         SPACE 1
COMM0302 SYMBL 'UCBSYSR  - PRIMARY CONSOLE OR ACTIVE CONSOLE'
COMM0301 SYMBL 'UCBDADI  - SECONDARY CONSOLE OR CONSOLE STATUS CHANGING*
               '
COMM1040 SYMBL 'CE1HEX40 - OVERRUNNABLE DEVICE'
COMM1020 SYMBL 'CE1HEX20 - BURST MODE'
COMM102X SYMBL 'CE1HEX20 - BYTE MODE'
COMM1010 SYMBL 'CE1HEX10 - DATA CHAINING'
COMM1180 SYMBL 'CE2HEX80 - AUTOMATIC CALLING'
COMM1140 SYMBL 'CE2HEX40 - AUTOMATIC POLLING'
COMM1120 SYMBL 'CE2HEX20 - CHECKING (2740 ONLY) OR DUAL COMMUNICATIONS *
               INTERFACE (2701 SDA-II)'
COMM1110 SYMBL 'CE2HEX10 - AUTOMATIC ANSWERING'
         SPACE 1
DASD0140 SYMBL 'UCBAMV   - SUCCESSFUL COMPARISON CHECKING OF THE ACCESS*
               METHOD CATALOG AND THE VTOC'
DASD0302 SYMBL 'UCBSYSR  - SYSTEM RESIDENCE VOLUME'
DASD1040 SYMBL 'DA1HEX40 - OVERRUNNABLE DEVICE'
DASD1020 SYMBL 'DA1HEX20 - BURST MODE'
DASD102X SYMBL 'DA1HEX20 - BYTE MODE'
DASD1010 SYMBL 'DA1HEX10 - DATA CHAINING'
DASD1140 SYMBL 'DA2HEX40 - TRACK OVERFLOW'
DASD1120 SYMBL 'DA2HEX20 - DEVICE SHARABLE BY TWO OR MORE PROCESSORS'
DASD1110 SYMBL 'DA2HEX10 - ROTATIONAL POSITION SENSING DEVICE'
DASD1108 SYMBL 'DA2HEX08 - VIRTUAL DASD'
DASD1102 SYMBL 'DA2HEX02 - VOLUME REQUIRES ALTERNATE POWER SOURCE DEVIC*
               E'
DASD1101 SYMBL 'DA2HEX01 - DEVICE HAS ALTERNATE POWER SOURCE'
DASD2280 SYMBL 'UCBBSVL  - VOLUME DEMOUNTABLE BY DATA MANAGEMENT'
DASD2240 SYMBL 'UCBPGFL  - UCB IS OPEN AND IS BEING USED AS A PAGE FILE*
               '
DASD2220 SYMBL 'UCBPRSRS - VOLUME ATTRIBUTE PROCESSING:  UCB MARKED PER*
               ANTLY IN ERROR OR OPERATOR SELECTED FOR VOLUME MOUNT'
DASD2210 EQU   TAPE2210
DASD2208 EQU   TAPE2208
DASD2204 EQU   TAPE2204
DASD2202 EQU   TAPE2202
DASD2201 SYMBL 'UCBBNUL  - A CATALOG DATASET IS ON THIS VOLUME'
DASD2380 SYMBL 'UCBMOUNT - A MOUNT REQUEST HAS BEEN ISSUED'
DASD238X SYMBL 'UCBMOUNT - MOUNT VERIFICATION HAS BEEN PERFORMED'
DASD2580 SYMBL 'UCBDAVV  - DIRECT ACCESS VOLUME VERIFICATION IN CONTROL*
               '
DASD2540 SYMBL 'UCBWDAV  - DAVV WAITING FOR MOUNT'
DASD2520 SYMBL 'UCBRESVP - RESERVE CHANNEL PROGRAM PENDING'
DASD2510 SYMBL 'UCBDSS   - READ HOME ADDRESS AND READ RECORD ZERO OPERA*
               TIONS HAVE BEEN PERFORMED BY DYNAMIC SUPPORT SYSTEM (DSS*
               )'
DASD2508 SYMBL 'UCBATTN  - 3330V ATTENTION RECEIVED'
DASD2504 SYMBL 'UCBHOLD  - 3330V CYLINDER-FAULT PENDING'
DASD2502 SYMBL 'UCBMAT   - 3330V ATTENTION OVERDUE'
         SPACE 1
GRAP0140 SYMBL 'UCBAF    - ATTENTION FOR THIS CONSOLE IS TO BE PROCESSE*
               D BY THE COMMUNICATIONS TASK'
GRAP0302 EQU   COMM0302
GRAP0301 EQU   COMM0301
GRAP1880 SYMBL 'UCBOFMCR - 3270 ONLY:  MAGNETIC CARD READER ADAPTER FEA*
               TURE'
GRAP1840 SYMBL 'UCBOFSP  - 3270 ONLY:  SELECTOR PEN FEATURE'
GRAP1820 SYMBL 'UCBOFNL  - 3270 ONLY:  NUMERIC LOCK FEATURE'
GRAP1810 SYMBL 'UCBOFPTR - 3270 ONLY:  PREPARE TO READ FEATURE'
GRAP1B80 SYMBL 'UCBOLTEP - 3270 ONLY:  OLTEP IN CONTROL OF DEVICE'
GRAP1B08 SYMBL 'UCBRTIAC - 3270 ONLY:  READ TI ACTIVE'
GRAP1B04 SYMBL 'UCBRIPND - 3270 ONLY:  READ INITIAL PENDING'
GRAP1B02 SYMBL 'UCBSKPFG - 3270 ONLY:  SKIP FLAG SET'
GRAP1B01 SYMBL 'UCBATRCD - 3270 ONLY:  ATTENTION RECEIVED FROM DEVICE'
GRAP1D80 SYMBL 'UCBOIP   - 3270 ONLY:  OPEN IN PROGRESS'
GRAP1D40 SYMBL 'UCBDRO   - 3270 ONLY:  DEVICE READY, IN OPEN'
GRAP1D20 SYMBL 'UCBDRNO  - 3270 ONLY:  DEVICE READY, NOT IN OPEN'
GRAP1D10 SYMBL 'UCBBTAM  - 3270 ONLY:  USE BTAM IGG019UP'
GRAP1D08 SYMBL 'UCBUPM   - 3270 ONLY:  USE PROVIDED MODULE'
GRAP1D04 SYMBL 'UCBRPND  - 3270 ONLY:  READY PROCESSING NOT DONE'
GRAP1D02 SYMBL 'UCBDWNR  - 3270 ONLY:  DEVICE WENT NOT READY'
         SPACE 1
UNIT0302 EQU   GRAP0302
UNIT0301 EQU   GRAP0301
UNIT1040 SYMBL 'UR1HEX40 - OVERRUNNABLE DEVICE'
UNIT1020 SYMBL 'UR1HEX20 - BURST MODE'
UNIT102X SYMBL 'UR1HEX20 - BYTE MODE'
UNIT1010 SYMBL 'UR1HEX10 - DATA CHAINING'
UNIT1001 SYMBL 'UR1HEX01 - IF 1442 OR 2520, THEN CARD READ PUNCH'
UNIT10X1 SYMBL 'UR1HEX00 - IF 1442 OR 2520, THEN CARD PUNCH ONLY'
UNIT1180 SYMBL 'UR2HEX80 - UNIVERSAL CHARACTER SET'
UNIT1120 SYMBL 'UR2HEX20 - IF 3525, THEN TWO-LINE PRINT FEATURE'
UNIT1110 SYMBL 'UR2HEX10 - IF 3525, THEN MULTI-LINE PRINT FEATURE'
UNIT1101 SYMBL 'UR2HEX01 - CARD IMAGE (BINARY MODE)'
         SPACE 1
KOMM0080 SYMBL 'UCBVRDEV - UCB FOR VIO DEVICE'
KOMM0040 SYMBL 'UCBJES3  - ALL MOUNTING AND DEVICE MANAGEMENT CONTROLLE*
               D BY JES3'
KOMM0020 SYMBL 'UCBDUC   - DISPLAY DEVICE UNIT CHECK IPL'
KOMM0010 SYMBL 'UCBBOX   - IF UCBIORST IS ON, THEN DEVICE BOXED DUE TO *
               ERROR'
KOMM0008 SYMBL 'UCBOLDSM - OLTEP COMMUNICATING DIRECTLY WITH MSC'
KOMM0004 SYMBL 'UCBMMSGP - MOUNT MESSAGE PENDING'
KOMM0002 SYMBL 'UCBURINP - UNCONDITIONAL RESERVE IN PROGRESS'
KOMM0001 SYMBL 'UCBMONT  - VOLUME TO BE MOUNTED IS TO BE RETAINED'
KOMM0180 SYMBL 'UCBDCC   - DISCONNECT COMMAND CHAIN DEVICE'
KOMM0120 SYMBL 'UCBSASK  - DEVICE REQUIRED STAND-ALONE SEEK'
KOMM0110 SYMBL 'UCBVSDR  - DEVICE HAS VARIABLE LENGTH SDR''S'
KOMM0108 SYMBL 'UCBENVRD - DEVICE RETURNS ENVIRONMENTAL DATA'
KOMM0104 SYMBL 'UCBNALOC - THIS OFFLINE DEVICE IS BEING USED BY A SYSTE*
               M COMPONENT'
KOMM0102 SYMBL 'UCBALTCU - DEVICE HAS ALTERNATE CONTROL UNIT ADDRESS'
KOMM0101 SYMBL 'UCBALTPH - DEVICE HAS ALTERNATE PATH'
KOMM0380 SYMBL 'UCBONLI  - DEVICE IS ONLINE'
KOMM0340 SYMBL 'UCBCHGS  - DEVICE STATUS IS TO BE CHANGED FROM ONLINE T*
               O OFFLINE'
KOMM0320 SYMBL 'UCBRESV  - MOUNT STATUS OF THE VOLUME ON THIS DEVICE IS*
                RESERVED'
KOMM0310 SYMBL 'UCBUNLD  - UNLOAD OPERATOR COMMAND HAS BEEN ADDRESSED T*
               O THIS DEVICE'
KOMM0308 SYMBL 'UCBALOC  - DEVICE IS ALLOCATED'
KOMM0304 SYMBL 'UCBPRES  - MOUNT STATUS OF THE VOLUME ON THIS DEVICE IS*
                PERMANENTLY RESIDENT'
KOMM0680 SYMBL 'UCBBSY   - (370 MODE) DEVICE IS BUSY / UCBDEFER - (XA M*
               ODE) UCB IS TEMPORARILY UNUSABLE'
KOMM0640 SYMBL 'UCBNRY   - DEVICE NOT READY'
KOMM0620 SYMBL 'UCBPST   - (370 MODE) POST FLAG / UCBPERM - (XA MODE) S*
               UBCHANNEL FOR THE DEVICE IS UNUSABLE'
KOMM0610 SYMBL 'UCBPSNS  - PENDING SENSE OPERATION'
KOMM0608 SYMBL 'UCBCUB   - (370 MODE) CONTROL UNIT BUSY / UCBSTRT - (XA*
                MODE) IOS HAS ISSUED A START SUBCHANNEL'
KOMM0604 SYMBL 'UCBSAP   - (370 MODE) STAND ALONE ACTIVE ON DEVICE / UC*
               BHALT - IOS HAS ISSUED A HALT SUBCHANNEL'
KOMM0602 SYMBL 'UCBACTV  - (370 MODE) CHANNEL PROGRAM ACTIVE ON DEVICE *
               / UCBCLEAR - (XA MODE) IOS HAS ISSUED A CLEAR SUBCHANNEL*
               '
KOMM0601 SYMBL 'UCBQISCE - (370 MODE) DEVICE QUIESCED / UCBBOX - (XA MO*
               DE) DEVICE HAS BEEN FORCED OFFLINE DUE TO AN ERROR'
KOMM0780 SYMBL 'UCBIORST - (370 MODE) DEVICE REMOVED FROM CONFIG. BY AL*
               T. CPU RECOVERY / UCBINCPT - (XA MODE) INTERCEPT CONDITI*
               N'
KOMM0740 SYMBL 'UCBASNS  - (370 MODE) SENSE ACTIVE ON DEVICE / UCBNOPTH*
                - (XA MODE) DEVICE HAS NO OPEATIONAL PATHS'
KOMM0720 SYMBL 'UCBSPST  - (370 MODE) SENSE POST INDICATOR / UCBNOCON -*
                (XA MODE) DEVICE IS NOT CONNECTEC TO A SUBCHANNEL'
KOMM0710 SYMBL 'UCBRESVH - (370 MODE) DEVICE RESERVED INDICATOR / UCBHI*
               LVL - (XA MODE) NON-NORMAL UCBLEVEL VALUE'
KOMM0708 SYMBL 'UCBCRHRV - (370 MODE) RESERVED PATH THRU CRH CONNECTION*
                / UCBHDET - (XA MODE) HOT I/O DETECTED - DEVICE BOXED'
KOMM0704 SYMBL 'UCBCRHSN - SENSE PENDING FROM INOPERATIVE CPU'
KOMM0702 SYMBL 'UCBVALPH - PATH VALIDATION FLAG SET'
KOMM0701 SYMBL 'UCBDPTH  - DYNAMIC PATHING FEATURE OPERATIONAL'
KOMM0880 SYMBL 'UCBPPA   - PRIMARY PATH, CPU 0 UNAVAILABLE'
KOMM0840 SYMBL 'UCBSPA   - SECONDARY PATH, CPU 0 UNAVAILABLE'
KOMM0820 SYMBL 'UCBPPB   - PRIMARY PATH, CPU 1 UNAVAILABLE'
KOMM0810 SYMBL 'UCBSPB   - SECONDARY PATH, CPU 1 UNAVAILABLE'
KOMM0C80 SYMBL 'UCBIN    - SYSIN'
KOMM0C40 SYMBL 'UCBOUT   - SYSOUT'
KOMM0C20 SYMBL 'UCBPUB   - ASSUMED THAT THIS DEVICE WILL BE ALLOCATED F*
               OR A PUBLIC VOLUME REQUEST.'
KOMM0C10 SYMBL 'UCBREW   - REWIND COMMAND HAS BEEN ADDRESSED TO THIS DE*
               VICE'
KOMM0C08 SYMBL 'UCBMTPXP - MULTIPLE EXPOSURE DEVICE'
KOMM0C04 SYMBL 'UCBVORSN - VARY COMMAND OPERATOR REASON INDICATOR SET'
KOMM0C02 SYMBL 'UCBVHRSN - VARY COMMAND HIERARCHY REASON INDICATOR SET'
KOMM1480 SYMBL 'UCBATTP  - ATTENTION PENDING'
KOMM1440 SYMBL 'UCBWAA   - (370 MODE) WORK AREA APPENDED / UCBITFP - (X*
               A MODE) INTERCEPT CONDITION'
KOMM1420 SYMBL 'UCBIDE   - UNSOLICITED DEVICE END'
KOMM1410 SYMBL 'UCBITF   - INTEREPT CONDITION'
KOMM1408 SYMBL 'UCBIVRS  - INTERVENTION-REQUIRED MESSAGE ISSUED'
KOMM1404 SYMBL 'UCBIVRR  - INTERVENTION-REQUIRED MESSAGE IS NEEDED'
KOMM1402 SYMBL 'UCBTICBT - CHANNEL-END AND/OR DEVICE-END OR MOUNT CONDI*
               TION PENDING'
KOMM1401 SYMBL 'UCBDDRSW - DDR SWITCH PENDING ON THIS DEVICE'
         SPACE 4
         END   AMDPRUCB

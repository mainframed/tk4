OPTIONS PS=60 S=72 SKIP=0 NODATE ERROR=3 ;
TITLE1 CAPACITY .. MANAGEMENT .. SYSTEM  ;
TITLE2 PLOTS OF DAILY VALUES ;
TITLE3 ;
TITLE4 R A N G E    O F   D A Y S ;
DATA RAW; KEEP S_BUSY S_BATCH S_STC S_TSO S_TOT SHIFT DATE CPU_ID;
SET CMSDATA.S_CPU;
RUN;
DATA PRIME; KEEP S_BUSY S_BATCH S_STC S_TSO S_TOT SHIFT DATE CPU_ID;
SET CMSDATA.S_CPU;
IF SHIFT ^= 1 THEN DELETE;
RUN;
PROC SORT DATA=RAW; BY DATE CPU_ID;
*PROC PRINT DATA=RAW;
*VAR DATE CPU_ID SHIFT S_BUSY S_TSO S_BATCH S_TOT;
RUN;
PROC SORT DATA=PRIME; BY DATE CPU_ID;
*PROC PRINT DATA=PRIME;
*VAR DATE CPU_ID SHIFT S_BUSY S_TSO S_BATCH S_TOT;
RUN;
PROC MEANS DATA=RAW MEAN NOPRINT ; BY DATE CPU_ID;
VAR S_BUSY S_BATCH S_STC S_TSO S_TOT ;
OUTPUT OUT=DAYSUM MEAN=S_BUSY S_BATCH S_STC S_TSO S_TOT;
PROC SORT DATA=DAYSUM; BY DATE CPU_ID;
*PROC PRINT DATA=DAYSUM;
*VAR DATE CPU_ID S_BUSY S_TSO S_BATCH S_TOT ;
RUN;
TITLE4 PRIME SHIFT CPU UTILIZATION;
PROC PLOT DATA=PRIME;
PLOT S_BUSY*DATE=CPU_ID /        VAXIS = 0.0 TO 1.0 BY .1
VREF = .85 .95 HAXIS = 120   TO 207 ;
LABEL S_BUSY=CPU BUSY BY PROCESSOR;
LABEL DATE = JULIAN DAY OF YEAR;
* PLOT OF DAY SHIFT CPU USE BY PROCESSOR BY DAY;
TITLE4 DAILY AVERAGE CPU UTILIZATION;
PROC PLOT DATA=DAYSUM;
PLOT S_BUSY*DATE=CPU_ID /        VAXIS = 0.0 TO 1.0 BY .1
VREF = .85 .95 HAXIS = 120   TO 207  ;
LABEL S_BUSY=CPU BUSY BY PROCESSOR;
LABEL DATE = JULIAN DAY OF YEAR;
* PLOT OF AVERAGE  CPU USE BY PROCESSOR BY DAY;
PROC SORT DATA=PRIME; BY DATE;
PROC MEANS DATA=PRIME MEAN MAX NOPRINT; BY DATE;
VAR S_TSO S_BATCH S_TOT;
OUTPUT OUT=ASIDS MEAN=A_TSO A_BATCH A_TOT
MAX=M_TSO M_BATCH M_TOT;

PROC PLOT DATA=ASIDS;
PLOT M_TSO*DATE='M' A_TSO*DATE='A' / OVERLAY VAXIS =0 TO 100 BY 10
VREF = 40 60 HAXIS = 120   TO 207  ;
LABEL M_TSO= MAXIMUM TSO USER LEVEL;
LABEL A_TSO= AVERAGE TSO USER LEVEL;
RUN;

DATA _NULL_;
SET CMSDATA.S_CPU ;
PROC SORT ; BY DATE;
PROC MEANS MIN MAX NOPRINT;
VAR DATE ; OUTPUT OUT=DAY_DIST MAX=MAX_DAY MIN=MIN_DAY;
*RETAIN LODAY HIDAY DAYNUM;
RUN;
PROC PRINT DATA=DAY_DIST;
VAR MAX_DAY MIN_DAY;
RUN;
PROC CONTENTS DATA=CMSDATA._ALL_ ;
RUN;

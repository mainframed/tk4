*-------------------------------------------------------------------*
×   SMF DATA REDUCTION IN AN MVS/RMF II ENVIRONMENT                 ×
×                                                                   ×
×   THE PURPOSE OF THIS JOB IS TO PROVIDE A DASD I/O SUMMARY BY     ×
×   CPU. DATA IS EXTRACTED FROM THE RMF TYPE 74 RECORDS.            ×
×   THIS PROGRAM IS CURRENTLY RUNNING IN AN RMF II, MVS-MP          ×
×   ENVIRONMENT AND CONTAINS NO CPU-DEPENDENT CODE. HOWEVER,        ×
×   IT IS STRONGLY SUGGESTED THAT ONE HAVE A THOROUGH UNDERSTANDING ×
×   OF THE PROGRAM BEFORE UTILIZING IT.  BECAUSE EACH INSTALLATION  ×
×   POSSESSES ITS OWN UNIQUE REQUIREMENTS, THIS PROGRAM IS PRIMARILY×
×   INTENDED TO DEMONSTRATE THE FLEXIBILITY AND CAPABILITY OF SAS   ×
×   IN THE ANALYSIS OF SMF DATA. RATHER THAN BEING UTILIZED IN ITS  ×
×   CURRENT FORM, IT BEST SERVES AS A STARTING POINT FOR THE        ×
×   DEVELOPMENT OF FACILITIES THAT BEST SUIT THE INDIVIDUAL         ×
×   INSTALLATION                                                    ×
×                                                                   ×
×   KENNETH C. TUCKER                                               ×
×   UNION CARBIDE CORPORATION                                       ×
×   P.O. BOX 8361                                                   ×
×   SOUTH CHARLESTON, W VA. 25303                                   ×
×                                                                   ×
*-------------------------------------------------------------------*
;
   MACRO INPUTIT
   DATA
        SAS.T74 (KEEP=CPUID TIME_REC JDATE
                      DEVADDR IO_COUNT)
        ;
   INFILE SMF LENGTH=L;
   INPUT @2 ID PIB1. @;
   IF ID = 74 THEN LINK X74;
   RETURN;
X74:
   INPUT @11 CPUID $4.
         @15 LEN_CDS PIB2.
         @17 TIME_REC PD4.
         @21 JDATE PD4.
         @31 SMF74SUB PIB2.
         @LEN_CDS+17 NUMDDSEC PIB2. @;
   CT=NUMDDSEC;
   LOOP=1;
   INPUT @LEN_CDS+25 DEV PIB2. @;
L: IF CT LT LOOP THEN GO TO OUT;
   INPUT DEV PIB2. @;
   INPUT+14 IO_COUNT PIB4. @;
   INPUT+60 SMF74RDL PIB4. @;
   LOOP+1;
   DEVADDR=INT(DEV/16);
   IF ^MOD(FLOOR(SMF74SUB/32),2) THEN GO TO L; * ELIM ALL BUT DASD;
   IF IO_COUNT=0 THEN GO TO L;
   OUTPUT SAS.T74;
   GO TO L;
OUT:
   RETURN;
   PROC SORT DATA=SAS.T74; BY CPUID DEVADDR;
   %
   INPUTIT;
DATA D;
INPUT CARD $CHAR72.;
CARDS4;
TERM           DEFINITION

JDATE          JULIAN DATE OF RECORD
DEVADDR        DEVICE ADDRESS
IO_COUNT       I/O ACTIVITY COUNT
;;;;
   PROC PRINT;
   ID CARD;
TITLE1 LIST OF TERMINOLOGY;
   PROC MEANS NOPRINT DATA=SAS.T74; BY CPUID DEVADDR;
   VARIABLES IO_COUNT;
   FORMAT DEVADDR HEX4.;
   OUTPUT OUT=A N=NUMRECS SUM= IO_COUNT;
TITLE1 RMF TYPE 74 I/O COUNT;
   PROC MEANS NOPRINT DATA=SAS.T74; BY CPUID;
   VARIABLES IO_COUNT;
   FORMAT DEVADDR HEX4.;
   OUTPUT OUT=B N=NUMRECS SUM= IO_COUNT;
TITLE1 RMF TYPE 74 I/O COUNT - SUMMARY;
   DATA C; SET A B;
   IF DEVADDR=. THEN DEVADDR=9999;
   PROC SORT; BY CPUID DEVADDR;
   PROC PRINT PAGE; BY CPUID; ID DEVADDR;
        VARIABLES  IO_COUNT;
   FORMAT DEVADDR HEX4.;
TITLE1 RMF TYPE 74 I/O COUNT SUMMARY REPORT;

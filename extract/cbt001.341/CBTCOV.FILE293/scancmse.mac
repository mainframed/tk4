&TRACE OFF
&IF &N NE 0 &IF &1 = ? &GOTO -HELP
SET CMSTYPE HT
ERASE SCANEXEC EXEC    A
ERASE CMS      EXEC    A
ERASE SCANCMS  LISTING A
SET CMSTYPE RT
*
&FNAME = X
&ALLRC = 999
&LOOP -LOOP WHILE .&FNAME ^= .
  &TYPE Enter FILE NAME, FILE TYPE and FILE MODE as for LISTFILE.
  &TYPE OR NULL TO END
  &READ VARS &FNAME &FTYPE &FMODE
  &IF .&FNAME = . &SKIP 2
  LISTFILE  &FNAME &FTYPE &FMODE (DATE APPEND)
  &IF &RC = 0 &ALLRC = 0
-LOOP
&IF &ALLRC NE 0 &EXIT 999
*
GLOBAL TXTLIB PLILIB
FILEDEF SYSIN TERM (RECFM F LRECL 80 BLKSIZE 80  PERM
FILEDEF SYSPRINT TERM (RECFM FA LRECL 80 BLKSIZE 80  PERM
FILEDEF PRINT    DISK SCANCMS  LISTING (RECFM FBA LRECL 133 BLOCK 1330)
FILEDEF SCANEX   DISK SCANEXEC EXEC    (RECFM FB  LRECL  80 BLOCK  800)
SCANCMS / &1
&SRC = &RETCODE
&TYPE
&TYPE TYPE OR EDIT SCANCMS LISTING? ( NULL FOR NEITHER)
&READ VARS &TYPIT
VMFCLEAR
&TYP = &SUBSTR OF &TYPIT 1 1
&IF .&TYP EQ .T &ARGS TYPE
&IF .&TYP EQ .E &ARGS XEDIT
&IF .&TYP NE .E &IF .&TYP NE .E &ARGS CP *
&1 &2 SCANCMS LISTING
*
&TYPE
&TYPE TYPE OR EDIT SCANEXEC EXEC? ( NULL FOR NEITHER)
&READ VARS &TYPIT
VMFCLEAR
&TYP = &SUBSTR OF &TYPIT 1 1
&IF .&TYP EQ .T &ARGS TYPE
&IF .&TYP EQ .E &ARGS XEDIT
&IF .&TYP NE .E &IF .&TYP NE .E &ARGS CP *
&1 &2 SCANEXEC EXEC
-EXIT
&EXIT &RETCODE
-HELP &CONTINUE
&SPACE
&BEGTYPE -END
SCANCMS WILL SCAN THE CMS FILES YOU SPECIFY FOR UP TO 20 CHARACTER STRIN
that you enter. The maximum character string length is 50 bytes.
TO INVOKE SIMPLY ENTER 'SCANCMS' WITH NO PARAMETERS AND FOLLOW THE
instructions given.

SCANCMS WILL ONLY LOOK AT CMS FILES WITH FIXED OR VARIABLE LENGTH RECORD
with a maximum record length of 256 bytes. MODE 4 files will work incorr
FOR FIXED LENGTH FILES THE MAXIMUM BLOCKING FACTOR IS 20. SCANCMS WILL N
scan files named 'DCSCAN LISTING A', 'CMS2 EXEC A', or 'SCANEXEC EXEC A'
in fact will actually destroy any files on the a disk by those names.
SCANCMS CREATES A FILE NAMED 'SCANCMS LISTING A1'. IT IS 133 BYTES IN
length and has headers and carriage control characters to enable it
to be printed.

SCANCMS CREATES A SECOND FILE NAMED 'SCANEXEC EXEC A'. THIS FILE IS
in the exact same format as a 'CMS EXEC', and contains the names of
each of the files selected that had equal arguments during the run.
-END

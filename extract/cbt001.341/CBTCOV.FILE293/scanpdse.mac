&TRACE OFF
&IF .&1 = .? EXEC SCANPDSX
&IF .&1 = .? &EXIT
&SUBS = NO
&IF .&1 = .SUBSET &SUBS = YES
&TYPE ENTER DATASET QUALIFIER1 QUALIFIER2 ...
&READ ARGS
-FILEDEFS
&TYPE  SCAN WILL BE ON DSN ===>  &1 &2 &3 &4 &5 &6 &7 &8 &9 &10 &11 &12
&TYPE
&IF &SUBS = YES &CALL -SUBSET
GLOBAL TXTLIB PLILIB
FI SYSIN TERM
FI SYSPRINT TERM
FI PRINT    DISK SCANPDS  LISTING A (RECFM FBA LRECL 133 BLKSIZE 1330
FI PRINT2   DISK SCANPDS2 LISTING A (RECFM FBA LRECL 133 BLKSIZE 1330
FI PRINT3   DISK SCANPDS3 LISTING A (RECFM FBA LRECL 133 BLKSIZE 1330
FI STRINGS  TERM (BLKSIZE 80 LRECL 80 RECFM F
FI CONTROL  TERM (BLKSIZE 80 LRECL 80 RECFM F
&DCB = &STRING OF (LRECL 256 BLKSIZE 256 RECFM F
FI PDSDIR   DISK SCANPDS DIRECT  A DSN &1 &2 &3 &4 &5 &6 &7 &8 &9 &DCB
FI PDSENTRY DISK SCANPDS ENTRY   * DSN &1 &2 &3 &4 &5 &6 &7 &8 &9
FI PLIDUMP  DUMMY
STATE SCANPDS ENTRY
&IF &RETCODE = 0 &SKIP 2
  &TYPE DATASET >>> &1 &2 &3 &4 &5 &6 &7 &8 &9 <<< NOT ON ACCESSED DISK.
  &GOTO -EXIT
&IF &N > 1 &D1 = .
&IF &N > 2 &D2 = .
&IF &N > 3 &D3 = .
&IF &N > 4 &D4 = .
&IF &N > 5 &D5 = .
&IF &N > 6 &D6 = .
&IF &N > 7 &D7 = .
&IF &N > 8 &D8 = .
&IF .&SUBFN = .TERM & = SUBSTERM
FI STRINGS  DISK SCANPDS STRINGS A
*
SCANPDS / & &1 &D1 &2 &D2 &3 &D3 &4 &D4 &5 &D5 &6 &D6 &7 &D7 &8
*
SET CMSTYPE HT
COPYFILE SCANPDS2 LISTING A SCANPDS LISTING A ( APPEND
ERASE    SCANPDS2 LISTING A
COPYFILE SCANPDS3 LISTING A SCANPDS LISTING A ( APPEND
ERASE    SCANPDS3 LISTING A
SET CMSTYPE RT
&TYPE
&TYPE TYPE OR EDIT SCANPDS LISTING? ( NULL FOR NEITHER)
&READ VARS &TYPIT
CLEAR
&IF .&TYPIT EQ . &TYPIT = .
&TYP = &SUBSTR OF &TYPIT 1 1
&IF .&TYP EQ . &TYP = .
&ARGS CP *
&IF &TYP EQ T &ARGS TYPE
&IF &TYP EQ E &ARGS XEDIT
&1 SCANPDS LISTING
VMFCLEAR
-EXIT
&EXIT 0
*
-SUBSET
&TYPE ENTER MEMBER SUBSET FNAME AND FTYPE OR NULL IF NONE.
&READ VARS &SUBFN &SUBFT
&IF .&SUBFN = . &GOTO -SUBRET
&IF  &SUBFN = TERM &GOTO -SUBTERM
&IF .&SUBFT = . &GOTO -SUBRET
SET CMSTYPE HT
STATE &SUBFN &SUBFT A
&SRC = &RC
SET CMSTYPE RT
&IF &SRC ^= 0 &GOTO -SUBRET
FILEDEF SUBSET DISK &SUBFN &SUBFT A (RECFM F LRECL 80 BLKSIZE 80
&GOTO -SUBRET
-SUBTERM
FILEDEF SUBSET TERM (RECFM F LRECL 80 BLKSIZE 80
-SUBRET
&RETURN

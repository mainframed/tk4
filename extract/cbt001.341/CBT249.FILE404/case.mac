*          DATA SET AM011400   AT LEVEL 003 AS OF 05/24/76
         MACRO
         CASE
         GBLA  &DOCLVL,&DOCNO(10),&CASENO(10),&DOCELSE(10),&DOCNT
         LCLA  &N,&M,&L,&H
.*             AUTHOR.   DON HIGGINS.
.*             DATE.     07/02/74.
.*             REMARKS.  SELECTION CONTROL STRUCTURE.
.*                       SEE DOCASE, CASE, ESAC, AND ESACOD.
.*                       SEE 'STRUCTURED FORTRAN TRANSLATOR' IN
.*                       IN 1975 FEBRUARY ACM SIGPLAN NOTICES.
.*             REV1 05/24/76 DSH - ALLOW SYMBOLIC FOR CASE VALUE.
         AIF   (&DOCLVL LT 1).ERR1
&N       SETA  N'&SYSLIST
         AIF   (&N GT 1).CHKN
&N       SETA  N'&SYSLIST(1)
         AIF   (&N GT 1).CHKN
         AIF   ('&SYSLIST(1)' EQ 'ELSE').ELSE
         AIF   ('&SYSLIST(1)' NE 'MISC').CHKN
.ELSE    AIF   (&DOCELSE(&DOCLVL) GT 0).ERR3
&DOCELSE(&DOCLVL) SETA 1
DC&DOCNO(&DOCLVL)ELSE DS 0H
         MEXIT
.CHKN    ANOP
         AIF   (&CASENO(&DOCLVL) EQ 63).ERR7
&CASENO(&DOCLVL) SETA &CASENO(&DOCLVL)+1
.MLOOP   ANOP
&M       SETA  &M+1
         AIF   (&M GT &N).GENL
&L       SETA  N'&SYSLIST(&M)
         AIF   (&L LT 1).MLOOP
         AIF   (&L GT 2).ERR4
         AIF   (&L EQ 1).GEN1
         AIF   (T'&SYSLIST(&M,1) NE 'N').ERR5
         AIF   (T'&SYSLIST(&M,2) NE 'N').ERR5
&L       SETA  &SYSLIST(&M,1)
&H       SETA  &SYSLIST(&M,2)
         AIF   (&L GT &H).ERR6
         AIF   (&H GT 255).ERR6
         AIF   (&L LT 1).ERR6
         ORG   CASEI&DOCNO(&DOCLVL)+&L
         DC    (&H-&L+1)AL1(&CASENO(&DOCLVL)*4)
         AGO   .MLOOP
.GEN1    ANOP
         ORG   CASEI&DOCNO(&DOCLVL)+&SYSLIST(&M)
         DC    AL1(&CASENO(&DOCLVL)*4)
         AGO   .MLOOP
.GENL    ANOP
         ORG
DC&DOCNO(&DOCLVL)C&CASENO(&DOCLVL) DS 0H
         MEXIT
.ERR1    MNOTE 8,'CASE - MISSING DOCASE'
         MEXIT
.ERR2    MNOTE 8,'CASE - INVALID OPERAND'
         MEXIT
.ERR3    MNOTE 8,'CASE - DUPLICATE ELSE CASE'
         MEXIT
.ERR4    MNOTE 8,'CASE - MORE THAN 2 SUBLIST OPERANDS'
         MEXIT
.ERR5    MNOTE 8,'CASE - OPERAND NOT SELF DEFINING TERM'
         MEXIT
.ERR6    MNOTE 8,'CASE - OPERAND NOT IN RANGE 1-255'
         MEXIT
.ERR7    MNOTE 8,'CASE - MAXIMUM OF 63 CASES EXCEEDED'
         MEXIT
         MEND

000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.   SSP510.
000300
000400 ENVIRONMENT DIVISION.
000500 CONFIGURATION SECTION.
000600 SOURCE-COMPUTER.  IBM-370.
000700 OBJECT-COMPUTER.  IBM-370.
000800 SPECIAL-NAMES.
000900     C01 IS TO-TOP.
001000     SKIP2
001100 INPUT-OUTPUT SECTION.
001200     SKIP1
001300 FILE-CONTROL.
001600     SELECT OUTPUT-REPORT
001700            ASSIGN TO UT-S-DMSRPT.
002200     SELECT DSN-MASTER
002300            ASSIGN TO DMSDSN
002400            ORGANIZATION IS INDEXED
002500            ACCESS MODE IS SEQUENTIAL
002600            RECORD KEY IS DSM-KEY
002700            FILE STATUS IS VSAM-STATUS.
002800
002900 DATA DIVISION.
003000
003100 FILE SECTION.
003200
007700 FD  OUTPUT-REPORT
007800     RECORDING MODE IS F
007900     LABEL RECORDS ARE STANDARD
008000     RECORD CONTAINS 133 CHARACTERS
008100     BLOCK CONTAINS 1 RECORDS
008200     DATA RECORD IS REPORT-REC.
008300
008400 01  REPORT-REC                  PIC X(133).
010400
010500 FD  DSN-MASTER
010600     LABEL RECORDS ARE STANDARD
010700     RECORD CONTAINS 300 CHARACTERS
010800     DATA RECORD IS DSM-RECORD.
010900
011000     COPY SSP507C1.
011300     EJECT
011400 WORKING-STORAGE SECTION.
011500
011600 01  DSN-SUB                     PIC S9(4)  VALUE +0    COMP.
011700
011800 01  ABEND-CODE                  PIC S9(4)  VALUE +333  COMP.
011900
012000 01  LINE-CNT                    PIC S9(5)  VALUE +99 COMP-3.
012100
012200 01  PAGE-CNT                    PIC S9(5)  VALUE ZEROS COMP-3.
012300
014200 01  HOLD-JULIAN                 PIC S9(7)  VALUE ZEROS.
014300
014400 01  VSAM-STATUS-AREA.
014500     03  VSAM-STATUS.
014600         05  VSAM-STAT-BYTE1     PIC X(1).
014700             88  STATUS-OK                  VALUE '0'.
014800             88  STATUS-AT-END              VALUE '1'.
014900             88  STATUS-INVALID-KEY         VALUE '2'.
015000             88  STATUS-ERROR               VALUE '3'.
015100             88  STATUS-OTHER               VALUE '9'.
015200             88  STATUS-ABORT               VALUE '1' '3' '9'.
015300         05  VSAM-STAT-BYTE2     PIC X(1).
015400     03  VSAM-STAT-BOTH REDEFINES VSAM-STATUS PIC X(2).
015500         88  DUPLICATE-RECORD               VALUE '22'.
015710
015720 01  TIME-WORK.
015800     02  TIME-WK1                PIC XX.
015900     02  TIME-WK2                PIC XX.
016000     02  TIME-WK3                PIC XX.
016100
016200 01  OLD-DATE-NUM                PIC 9(6).
016300 01  OLD-DATE REDEFINES OLD-DATE-NUM.
016400     05  OLD-DATE-YY             PIC 99.
016500     05  OLD-DATE-MM             PIC 99.
016600     05  OLD-DATE-DD             PIC 99.
017400
017500 01  HOLD-DATE-2.
017600
017700     05  HOLD-DATE-NUM           PIC 9(7).
017800     05  HOLD-DATE-GRP  REDEFINES HOLD-DATE-NUM.
017900         10  FILLER              PIC X.
018000         10  HOLD-DATE-MDY.
018100             15  HOLD-DATE-GRP-MM    PIC 9(2).
018200             15  HOLD-DATE-GRP-DD    PIC 9(2).
018300             15  HOLD-DATE-GRP-YY    PIC 9(2).
018400
018500 01  HOLD-DATE.
018600     05  HOLD-MM                 PIC 99.
018700     05  FILLER                  PIC X.
018800     05  HOLD-DD                 PIC 99.
018900     05  FILLER                  PIC X.
019000     05  HOLD-YY                 PIC 99.
019300
019400 01  HOLD-DATE-3.
019500     05  HOLD-3-YYYY.
019600         10  FILLER              PIC X(2).
019700         10  HOLD-3-YY           PIC 9(2).
019800     05  HOLD-3-DDD              PIC S9(3).
023600
023700 01  HEADING-LINE-1.
023800
023900     02  FILLER                  PIC X(25) VALUE
024000         'MUNICIPALITY OF ANCHORAGE'.
024100     02  FILLER                  PIC X(14) VALUE SPACES.
024200     02  FILLER                  PIC X(02) VALUE SPACES.
024300     02  FILLER                  PIC X(49)
024400         VALUE '   D I S K   M A N A G E M E N T   S Y S T E M'.
024500     02  FILLER                  PIC X(02) VALUE SPACES.
024600     02  FILLER                  PIC X(26) VALUE SPACES.
024700     02  FILLER                  PIC X(09) VALUE 'PAGE NO: '.
024800     02  PAGE-NO-HL1             PIC Z(5).
024900
025000 01  HEADING-LINE-2.
025100
025200     02  FILLER                  PIC X(25) VALUE
025300         'INFORMATION SYSTEMS DEPT.'.
025400     02  FILLER                  PIC X(93) VALUE SPACES.
025500     02  FILLER                  PIC X(06) VALUE 'DATE: '.
025600     02  DATE-HL2                PIC X(8)  VALUE SPACES.
025700
025800 01  HEADING-LINE-3.
025900
026000     02  FILLER                  PIC X(17) VALUE
026100         'REPORT: SSP510-R1'.
026200     02  FILLER                  PIC X(06) VALUE SPACES.
026300     02  FILLER                  PIC X(16) VALUE SPACES.
026400     02  REPORT-NAME-HL3         PIC X(53)
026500         VALUE '            DATA SET AUTHORIZATION MASTER   '.
026600     02  FILLER                  PIC X(26) VALUE SPACES.
026700     02  FILLER                  PIC X(09) VALUE 'TIME:    '.
026800     02  TIME1-HL3               PIC X(2)  VALUE SPACES.
026900     02  FILLER                  PIC X(1)  VALUE ':'.
027000     02  TIME2-HL3               PIC X(2)  VALUE SPACES.
027300
027400 01  DETAIL-HEADING-1.
027500
027600     05  FILLER                   PIC X(46)
027700         VALUE SPACES.
028600
028700 01  DETAIL-HEADING-2.
028800
028900     10  FILLER                   PIC X(46)
029000         VALUE SPACES.
030000
030100 01  PRINT-WORK.
030110
030200     10  FILLER                  PIC X(1).
030400
033100     EJECT
033200 PROCEDURE DIVISION.
033300
033400 START-IT.
033700     OPEN OUTPUT OUTPUT-REPORT.
033900
034000     OPEN I-O DSN-MASTER.
034100
034200     IF STATUS-ABORT
034300         DISPLAY 'CANNOT OPEN DSN MASTER  FILE STATUS='
034400                 VSAM-STATUS
034500         GO TO CLOSE-FILES.
034600
035300
035400     MOVE TIME-OF-DAY TO TIME-WORK.
035500     MOVE TIME-WK1 TO TIME1-HL3.
035600     MOVE TIME-WK2 TO TIME2-HL3.
035700     MOVE CURRENT-DATE TO DATE-HL2.
036400
036500     PERFORM WRITE-HEADINGS.
038100
038200 PROCESS-INPUT.
038300
038400     READ  DSN-MASTER.
038410
038420     IF STATUS-AT-END
038500        GO TO EOJ.
054910
054920     IF STATUS-OK
054921         NEXT SENTENCE
054930         ELSE DISPLAY 'ERROR READING DSN MASTER  FILE STATUS='
054940                      VSAM-STATUS
054950              GO TO CLOSE-FILES.
057210
057211     MOVE 'FB' TO DSM-RECFM.
057212     MOVE ZEROS TO DSM-LRECL.
057213     MOVE ZEROS TO DSM-BLKSIZE.
057214     MOVE ZEROS TO DSM-NUM-RECS
057215
057216     REWRITE DSM-RECORD.
057217
057218     IF STATUS-OK
057219         GO TO PROCESS-INPUT
057220         ELSE DISPLAY 'ERROR REWRITING DSN MASTER  FILE STATUS='
057221                      VSAM-STATUS
057222              GO TO CLOSE-FILES.
057300
059300 WRITE-HEADINGS SECTION.
059400
059500     ADD 1 TO PAGE-CNT.
059600     MOVE PAGE-CNT TO PAGE-NO-HL1.
059700     WRITE REPORT-REC FROM HEADING-LINE-1 AFTER TO-TOP.
059800     MOVE ZEROS TO LINE-CNT.
059900     WRITE REPORT-REC FROM HEADING-LINE-2 AFTER 1.
060000     WRITE REPORT-REC FROM HEADING-LINE-3 AFTER 1.
060100     MOVE ALL '-' TO REPORT-REC.
060200     WRITE REPORT-REC AFTER 1.
060300     WRITE REPORT-REC FROM DETAIL-HEADING-1 AFTER 1.
060400     WRITE REPORT-REC FROM DETAIL-HEADING-2 AFTER 1.
060500     MOVE ALL '-' TO REPORT-REC.
060600     WRITE REPORT-REC AFTER 1.
060700     MOVE SPACES TO REPORT-REC.
060800     WRITE REPORT-REC AFTER 1.
060900
061000 EOJ SECTION.
061100
063100
063200 CLOSE-FILES.
063300
063400     CLOSE OUTPUT-REPORT
063800           DSN-MASTER.
063900
064000     STOP RUN.

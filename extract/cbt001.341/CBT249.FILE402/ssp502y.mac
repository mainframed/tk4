000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.    SSP502.
000300 AUTHOR.        MOA ANCHORAGE.
000310
000320
000330*****************************************************************
000340*****************************************************************
000350**                                                             **
000360**                                                             **
000370**             SSSSSSSSSS   MM        MM   SSSSSSSSSS          **
000380**            SSSSSSSSSSSS  MMM      MMM  SSSSSSSSSSSS         **
000390**            SS        SS  MMMM    MMMM  SS        SS         **
000391**            SS            MM MM  MM MM  SS                   **
000392**            SSS           MM  MMMM  MM  SSS                  **
000393**             SSSSSSSSS    MM   MM   MM   SSSSSSSSS           **
000394**              SSSSSSSSS   MM        MM    SSSSSSSSS          **
000395**                     SSS  MM        MM           SSS         **
000396**                      SS  MM        MM            SS         **
000397**            SS        SS  MM        MM  SS        SS         **
000398**            SSSSSSSSSSSS  MM        MM  SSSSSSSSSSSS         **
000399**             SSSSSSSSSS   MM        MM   SSSSSSSSSS          **
000400**                                                             **
000401**                                                             **
000402**        M U N I C I P A L I T Y   O F   A N C H O R A G E    **
000403**                                                             **
000404**          S P A C E   M A N A G E M E N T   S Y S T E M      **
000405**                                                             **
000406*****************************************************************
000407*****************************************************************
000408
000409
000410 ENVIRONMENT DIVISION.
000500 CONFIGURATION SECTION.
000600 SOURCE-COMPUTER.  IBM-370.
000700 OBJECT-COMPUTER.  IBM-370.
000710
000800 SPECIAL-NAMES.
000900     C01 IS TO-TOP.
000910
001000 INPUT-OUTPUT SECTION.
001010
001100 FILE-CONTROL.
001110
001200     SELECT EXTRACT-INPUT
001300         ASSIGN TO UT-DMSEXT.
001310
001400     SELECT REPORT-FILE
001500         ASSIGN TO UT-DMSRPT.
001501
001502     SELECT SUMMARY-FILE
001503         ASSIGN TO UT-DMSSUMM.
001510
001600     SELECT SORT-FILE
001700         ASSIGN TO UT-S-SORTWK01.
001800
001900 DATA DIVISION.
002000 FILE SECTION.
002100
002200 FD  EXTRACT-INPUT
002300     RECORDING MODE IS F
002400     LABEL RECORDS ARE STANDARD
002500     RECORD CONTAINS 105 CHARACTERS
002600     BLOCK CONTAINS 0 RECORDS
002700     DATA RECORD IS EXTRACT-FILE-RECORD.
002710
002800 01  EXTRACT-FILE-RECORD         PIC X(105).
002900
003000 FD  REPORT-FILE
003100     RECORDING MODE IS F
003200     LABEL RECORDS ARE STANDARD
003300     RECORD CONTAINS 133 CHARACTERS
003400     BLOCK CONTAINS 0 RECORDS
003500     DATA RECORD IS REPORT-REC.
003510
003600 01  REPORT-REC.
003700     05  FILLER                  PIC X(133).
003710
003720 FD  SUMMARY-FILE
003730     RECORDING MODE IS F
003740     LABEL RECORDS ARE STANDARD
003750     RECORD CONTAINS 53 CHARACTERS
003760     BLOCK CONTAINS 0 RECORDS
003770     DATA RECORD IS SUMMARY-REC.
003780
003790 01  SUMMARY-REC.
003791     05  SR-NODE                 PIC X(17).
003792     05  SR-TYPE                 PIC X(4).
003793     05  SR-DATE                 PIC X(8).
003794     05  SR-TOT-3340             PIC X(6).
003795     05  SR-TOT-3350             PIC X(6).
003796     05  SR-TOT-3375             PIC X(6).
003797     05  SR-TOT-3380             PIC X(6).
003800
003900 SD  SORT-FILE
004000     DATA RECORD IS SORT-RECORD.
004010
004100 01  SORT-RECORD.
004200     05  SORT-DSNAME             PIC X(44).
004300     05  FILLER                  PIC X(26).
004400     05  SORT-VOLUME             PIC X(6).
004500     05  FILLER                  PIC X(29).
004600     05  SORT-AGE                PIC 9(5).
004700     EJECT
004800 WORKING-STORAGE SECTION.
004900 77  VOL-SAVE                    PIC X(6)       VALUE SPACES.
005000 77  DEV-SAVE                    PIC X(4)       VALUE SPACES.
005100 77  LINE-CNT                    PIC S9(3)      COMP-3
005200                                                VALUE +999.
005300 77  PAGE-CNT                    PIC S9(3)      COMP-3
005400                                                VALUE ZEROS.
005500 77  TOTAL-SPACE-ALLOC           PIC S9(7)      VALUE ZEROS
005600                                                COMP-3.
005700 77  TOTAL-SPACE-USED            PIC S9(7)      VALUE ZEROS
005710                                                COMP-3.
005720 77  NODE-SPACE-ALLOC-TOTAL      PIC S9(6)      VALUE ZEROS
005730                                                COMP-3.
005740 77  NODE-SPACE-USED-TOTAL       PIC S9(6)      VALUE ZEROS
005800                                                COMP-3.
005900 77  NODE-DS-COUNT               PIC S9(4)      VALUE ZEROS
006000                                                COMP-3.
006100 77  VSAM-SPACE-CNTR             PIC S9(6)      VALUE ZEROS
006110                                                COMP-3.
006120 77  SUMM-3340                   PIC S9(6)      VALUE ZEROS
006130                                                COMP-3.
006140 77  SUMM-3350                   PIC S9(6)      VALUE ZEROS
006150                                                COMP-3.
006160 77  SUMM-3375                   PIC S9(6)      VALUE ZEROS
006170                                                COMP-3.
006180 77  SUMM-3380                   PIC S9(6)      VALUE ZEROS
006200                                                COMP-3.
006300 77  PERIOD-LITERAL              PIC X          VALUE '.'.
006310
006400 77  WORK-PCT-FREE               PIC S9(3)V9999 COMP-3
006500                                     VALUE ZEROS.
006600     SKIP2
006700 01  NODE-SAVE.
006800     05  NODE2-SAVE              PIC X(8)       VALUE SPACES.
006900     05  FILLER                  PIC X(9)       VALUE SPACES.
007000     SKIP2
007100 01  WS-NODE-SAVE-ONE.
007200     05  WS-NODE-SAVE-1          OCCURS 17 TIMES
007300                                 INDEXED BY NODE1-INDEX
007400                                 PIC X(1).
007500
007600 01  TIME-WORK.
007700     02  TIME-WK1                PIC XX.
007800     02  TIME-WK2                PIC XX.
007900     02  TIME-WK3                PIC XX.
008000
008100 01  HOLD-DATE.
008200     05  HOLD-MM                 PIC 99.
008300     05  FILLER                  PIC X.
008400     05  HOLD-DD                 PIC 99.
008500     05  FILLER                  PIC X.
008600     05  HOLD-YY                 PIC 99.
008700
008800 01  OLD-DATE-NUM                PIC 9(6).
008900 01  OLD-DATE REDEFINES OLD-DATE-NUM.
009000     05  OLD-DATE-YY             PIC 99.
009100     05  OLD-DATE-MM             PIC 99.
009200     05  OLD-DATE-DD             PIC 99.
009300
009400 01  S630-LIST.
009500     05   S630-REQUEST     PICTURE  9(1).
009600     05   S630-DATE-1      PICTURE  S9(6) COMP-3.
009700     05   S630-DATE-2      PICTURE  S9(6) COMP-3.
009800     05   S630-NO-DAYS     PICTURE  S9(6) COMP-3.
009900     05   S630-RETURN-CODE PICTURE  X(1).
010000
010100 01  HOLD-DATE-2.
010200
010300     05  HOLD-DATE-NUM           PIC 9(7).
010400     05  HOLD-DATE-GRP  REDEFINES HOLD-DATE-NUM.
010500         10  FILLER              PIC X.
010600         10  HOLD-DATE-GRP-MM    PIC 9(2).
010700         10  HOLD-DATE-GRP-DD    PIC 9(2).
010800         10  HOLD-DATE-GRP-YY    PIC 9(2).
010900
011000     COPY SSP500C1.
011100
011200 01  REPORT1-ID.
011300     05  FILLER                  PIC X(53)
011400         VALUE '               DETAIL BY DATA SET NAME'.
011500
011600 01  REPORT2-ID.
011700     05  FILLER                  PIC X(53)
011800         VALUE '             TOTALS ONLY REPORT BY NODE'.
011810
011820 01  REPORT3-ID.
011830     05  FILLER                  PIC X(53)
011840         VALUE '               DETAIL BY VOLUME SERIAL'.
012300
012400 01  REPORT4-ID.
012500     05  FILLER                  PIC X(53)
012600         VALUE '                VOLUME ANALYSIS SUMMARY'.
012700
012800 01  REPORT5-ID.
012900     05  FILLER                  PIC X(53)
013000         VALUE '                 DATA SET AGING REPORT'.
013100
013200 01  HEADING-LINE-1.
013300
013400     02  FILLER                  PIC X(25) VALUE
013500         'MUNICIPALITY OF ANCHORAGE'.
013600     02  FILLER                  PIC X(14) VALUE SPACES.
013700     02  FILLER                  PIC X(02) VALUE SPACES.
013800     02  FILLER                  PIC X(49)
013900         VALUE '  S P A C E   M A N A G E M E N T   S Y S T E M'.
014000     02  FILLER                  PIC X(02) VALUE SPACES.
014100     02  FILLER                  PIC X(26) VALUE SPACES.
014200     02  FILLER                  PIC X(09) VALUE 'PAGE NO: '.
014300     02  PAGE-NO-HL1             PIC Z(5).
014400
014500 01  HEADING-LINE-2.
014600
014700     02  FILLER                  PIC X(25) VALUE
014800         'INFORMATION SYSTEMS DEPT.'.
014900     02  FILLER                  PIC X(93) VALUE SPACES.
015000     02  FILLER                  PIC X(06) VALUE 'DATE: '.
015100     02  DATE-HL2                PIC X(8)  VALUE SPACES.
015200
015300 01  HEADING-LINE-3.
015400
015500     02  FILLER                  PIC X(16) VALUE
015600         'REPORT: SSP502-R'.
015700     02  REPORT-NO-HL3           PIC X(02) VALUE SPACES.
015800     02  FILLER                  PIC X(05) VALUE SPACES.
015900     02  FILLER                  PIC X(16) VALUE SPACES.
016000     02  REPORT-NAME-HL3         PIC X(53) VALUE SPACES.
016100     02  FILLER                  PIC X(26) VALUE SPACES.
016200     02  FILLER                  PIC X(09) VALUE 'TIME:    '.
016300     02  TIME1-HL3               PIC X(2)  VALUE SPACES.
016400     02  FILLER                  PIC X(1)  VALUE ':'.
016500     02  TIME2-HL3               PIC X(2)  VALUE SPACES.
016600 01  PRINT-LINES.
016700
016800     05  DETAIL-HEADING-1.
016900         10  FILLER              PIC X(47) VALUE SPACES.
016910         10  FILLER              PIC X(40)
017000*                   1...5....1....5....2....5....3....5....4
017100             VALUE 'CREATE   LAST USED         DS           '.
017200         10  FILLER              PIC X(40)
017300*                   1...5....1....5....2....5....3....5....4
017400             VALUE '             ALC      <--TRACKS-->  PCT '.
017500         10  FILLER              PIC X(5)
017600*                   1...5....1....5....2....5....3....5....4
017700             VALUE ' C  R'.
019700     SKIP1
019800     05  DETAIL-HEADING-2.
020000         10  FILLER              PIC X(47)
020100             VALUE 'DATA SET NAME'.
020110         10  FILLER              PIC X(40)
020200*                   1...5....1....5....2....5....3....5....4
020300             VALUE ' DATE       DATE   VOLSER  ORG  REC   LR'.
020400         10  FILLER              PIC X(40)
020500*                   1...5....1....5....2....5....3....5....4
020600             VALUE 'ECL  BLKSIZ  TYP  EXT   ALOC  USED  FREE'.
020700         10  FILLER              PIC X(5)
020800*                   1...5....1....5....2....5....3....5....4
020900             VALUE ' T  B'.
023000     05  DET-HEAD-R4-1.
023100         10  FILLER              PIC X(40)
023200*                   1...5....1....5....2....5....3....5....4
023300             VALUE '         <---DEVICE CHARACTERISTICS---->'.
023400         10  FILLER              PIC X(40)
023500*                   1...5....5....5....6....5....7....5....8
023600             VALUE '    <---USAGE STATISTICS--->            '.
023700         10  FILLER              PIC X(40)
023800*                   1...5....9....5....0....5....1....5....2
023900             VALUE '                                        '.
024000         10  FILLER              PIC X(12)
024100*                   1...5....3.2
024200             VALUE '            '.
024300     05  DET-HEAD-R4-2.
024400         10  FILLER              PIC X(40)
024500*                   1...5....1....5....2....5....3....5....4
024600             VALUE '         DEV                TRK/   TRACK'.
024700         10  FILLER              PIC X(40)
024800*                   1...5....5....5....6....5....7....5....8
024900             VALUE '    TRACKS    TRACKS     NO.            '.
025000         10  FILLER              PIC X(40)
025100*                   1...5....9....5....0....5....1....5....2
025200             VALUE '                                        '.
025300         10  FILLER              PIC X(12)
025400*                   1...5....3.2
025500             VALUE '            '.
025600     05  DET-HEAD-R4-3.
025700         10  FILLER              PIC X(40)
025800*                   1...5....1....5....2....5....3....5....4
025900             VALUE 'VOLUME   TYPE      CYLS     CYL    SIZE '.
026000         10  FILLER              PIC X(40)
026100*                   1...5....5....5....6....5....7....5....8
026200             VALUE '     ALLOC     USED      DSN            '.
026300         10  FILLER              PIC X(40)
026400*                   1...5....9....5....0....5....1....5....2
026500             VALUE '                                        '.
026600         10  FILLER              PIC X(12)
026700*                   1...5....3.2
026800             VALUE '            '.
026900     05  DET-HEAD-R5-1.
027000         10  FILLER              PIC X(40)
027100*                   1...5....1....5....2....5....3....5....4
027200             VALUE '                                        '.
027300         10  FILLER              PIC X(40)
027400*                   1...5....5....5....6....5....7....5....8
027500             VALUE '      CREATE   LAST USED              TY'.
027600         10  FILLER              PIC X(40)
027700*                   1...5....9....5....0....5....1....5....2
027800             VALUE 'P   <---TRACKS-->  NO  CAT  PCT         '.
027900         10  FILLER              PIC X(12)
028000*                   1...5....3.2
028100             VALUE '            '.
028200     05  DET-HEAD-R5-2.
028300         10  FILLER              PIC X(40)
028400*                   1...5....1....5....2....5....3....5....4
028500             VALUE 'DATA SET NAME                           '.
028600         10  FILLER              PIC X(40)
028700*                   1...5....5....5....6....5....7....5....8
028800             VALUE '       DATE       DATE   AGE  VOLSER  AL'.
028900         10  FILLER              PIC X(40)
029000*                   1...5....9....5....0....5....1....5....2
029100             VALUE 'C    ALLOC   USED  EX  STA  FREE        '.
029200         10  FILLER              PIC X(12)
029300*                   1...5....3.2
029400             VALUE '            '.
029500     05  TOTALS-DTL-HDG-1.
029600         10  FILLER              PIC X(100)     VALUE SPACES.
029700         10  FILLER              PIC X(6)
029800             VALUE 'TRACKS'.
029900         10  FILLER              PIC X(5)       VALUE SPACES.
030000         10  FILLER              PIC X(6)
030100             VALUE 'TRACKS'.
030200         10  FILLER              PIC X(16)      VALUE SPACES.
030300     SKIP1
030400     05  TOTALS-DTL-HDG-2.
030500         10  FILLER              PIC X(97)      VALUE SPACES.
030600         10  FILLER              PIC X(9)
030700             VALUE 'ALLOCATED'.
030800         10  FILLER              PIC X(7)       VALUE SPACES.
030900         10  FILLER              PIC X(4)
031000             VALUE 'USED'.
031100         10  FILLER              PIC X(16)      VALUE SPACES.
031200     SKIP1
031300     05  DETAIL-LINE-1.
031500         10  DETAIL-DATA-SET-NAME
031600                                 PIC X(44).
031700         10  FILLER              PIC X(2)       VALUE SPACES.
031800         10  DETAIL-CREATE-DATE.
031900             15  DETAIL-CRT-MM   PIC Z9.
032000             15  FILLER          PIC X          VALUE '/'.
032100             15  DETAIL-CRT-DD   PIC 99.
032200             15  FILLER          PIC X          VALUE '/'.
032300             15  DETAIL-CRT-YY   PIC 99.
032400         10  FILLER              PIC X(2)       VALUE SPACES.
032500         10  DETAIL-EXPIR-DATE.
032600             15  DETAIL-EXP-MM   PIC Z9.
032700             15  FILLER          PIC X          VALUE '/'.
032800             15  DETAIL-EXP-DD   PIC 99.
032900             15  FILLER          PIC X          VALUE '/'.
033000             15  DETAIL-EXP-YY   PIC 99.
033100         10  FILLER              PIC X(2)       VALUE SPACES.
033200         10  DETAIL-RES-VOLUME   PIC X(6).
033210         10  FILLER              PIC X(2)       VALUE SPACES.
033220         10  DETAIL-DSORG        PIC X(3).
033230         10  FILLER              PIC X(2)       VALUE SPACES.
033240         10  DETAIL-RECFM        PIC X(3).
033310         10  FILLER              PIC X(2)       VALUE SPACES.
033320         10  DETAIL-LRECL        PIC ZZ,Z(3).
033340         10  FILLER              PIC X(2)       VALUE SPACES.
033350         10  DETAIL-BLKSIZE      PIC ZZ,Z(3).
033360         10  FILLER              PIC X(2)       VALUE SPACES.
033400         10  DETAIL-ALLOC-PARM   PIC X(3).
033500         10  FILLER              PIC X(2)       VALUE SPACES.
033600         10  DETAIL-NUM-EXTENTS  PIC Z9.
033700         10  FILLER              PIC X(2)       VALUE SPACES.
033800         10  DETAIL-TRKS-ALLOC   PIC ZZ,ZZ9.
033900         10  DETAIL-TRKS-USED    PIC ZZ,ZZ9.
034000         10  FILLER              PIC X(2)       VALUE SPACES.
034010         10  DETAIL-PCT-FREE     PIC ZZ9.
034020         10  DETAIL-X-PCT-FREE
034030             REDEFINES DETAIL-PCT-FREE   PIC X(3).
034040         10  FILLER              PIC X(2)       VALUE SPACES.
034100         10  DETAIL-CATALOG-STAT PIC X(1).
034200         10  FILLER              PIC X(2)       VALUE SPACES.
034300         10  DETAIL-RACF         PIC X(1).
034700
034800     05  R4-LINE.
034900
035000         10  R4-RES-VOLUME       PIC X(6).
035100         10  FILLER              PIC X(3)        VALUE SPACES.
035200         10  R4-DEV              PIC X(4).
035300         10  FILLER              PIC X(3)        VALUE SPACES.
035400         10  R4-CYLS-PER-DEV     PIC ZZ,ZZ9.
035500         10  FILLER              PIC X(3)        VALUE SPACES.
035600         10  R4-TRKS-PER-CYL     PIC ZZ,ZZ9.
035700         10  FILLER              PIC X(3)        VALUE SPACES.
035800         10  R4-TRK-SIZE         PIC ZZ,ZZ9.
035900         10  FILLER              PIC X(3)        VALUE SPACES.
036000         10  R4-SPC-ALLOC        PIC ZZZ,ZZ9.
036100         10  FILLER              PIC X(3)        VALUE SPACES.
036200         10  R4-SPC-USED         PIC ZZZ,ZZ9.
036300         10  FILLER              PIC X(3)        VALUE SPACES.
036400         10  R4-DS-COUNT         PIC Z,ZZ9.
036500         10  FILLER              PIC X(3)        VALUE SPACES.
036600         10  R4-SPC-AVAIL        PIC ZZZ,ZZ9.
036700
036800     05  R5-LINE.
036900
037000         10  R5-DSN              PIC X(44).
037100         10  FILLER              PIC X(1)       VALUE SPACES.
037200         10  R5-CREATE-DATE.
037300             15  R5-CRT-MM       PIC Z9.
037400             15  FILLER          PIC X          VALUE '/'.
037500             15  R5-CRT-DD       PIC 99.
037600             15  FILLER          PIC X          VALUE '/'.
037700             15  R5-CRT-YY       PIC 99.
037800         10  FILLER              PIC X(2)       VALUE SPACES.
037900         10  R5-EXPIR-DATE.
038000             15  R5-EXP-MM       PIC Z9.
038100             15  FILLER          PIC X          VALUE '/'.
038200             15  R5-EXP-DD       PIC 99.
038300             15  FILLER          PIC X          VALUE '/'.
038400             15  R5-EXP-YY       PIC 99.
038500         10  FILLER              PIC X(2)       VALUE SPACES.
038600         10  R5-AGE              PIC Z(3).
038700         10  FILLER              PIC X(2)       VALUE SPACES.
038800         10  R5-RES-VOLUME       PIC X(6).
038900         10  FILLER              PIC X(2)       VALUE SPACES.
039000         10  R5-ALLOC-PARM       PIC X(3).
039100         10  FILLER              PIC X(2)       VALUE SPACES.
039200         10  R5-TRKS-ALLOC       PIC ZZZ,ZZ9.
039300         10  R5-TRKS-USED        PIC ZZZ,ZZ9.
039400         10  FILLER              PIC X(2)       VALUE SPACES.
039500         10  R5-NUM-EXTENTS      PIC Z9.
039600         10  FILLER              PIC X(2)       VALUE SPACES.
039700         10  R5-CATALOG-STAT     PIC X(3).
039800         10  FILLER              PIC X(2)       VALUE SPACES.
039900         10  R5-PCT-FREE         PIC ZZ9.
040000         10  R5-X-PCT-FREE
040100             REDEFINES R5-PCT-FREE   PIC X(3).
040200         10  FILLER              PIC X(3)       VALUE SPACES.
040300     SKIP1
040400     05  TOTAL-LINE-1.
040500         10  FILLER              PIC X(43)      VALUE SPACES.
040600         10  FILLER              PIC X(10)
040700             VALUE 'TOTAL FOR '.
040800         10  TOTAL-LINE-TYPE     PIC X(7).
040900         10  TOTAL-LINE-NODE-VOL.
041000             15  FILLER          PIC X(11).
041100             15  TOTAL-LINE-DEV  PIC X(6).
041200         10  FILLER              PIC X(18)      VALUE SPACES.
041300         10  TOTAL-LINE-SPC-ALLOC PIC ZZZ,ZZZ,ZZ9.
041400         10  TOTAL-LINE-SPC-USED  PIC ZZZ,ZZZ,ZZ9.
041500         10  FILLER              PIC X(16)      VALUE SPACES.
041600     EJECT
041700 01  TOTAL-TYPE      PIC X(05).
041800         88  TOTALS-ONLY                  VALUE 'TOTAL'.
041900
042000 01  PARM-KEY-02.
042100
042200     03  FILLER          PIC S9(4)   COMP VALUE 1.
042300     03  FILLER          PIC S9(4)   COMP VALUE 6.
042400     03  FILLER          PIC S9(4)   COMP VALUE 6.
042500     03  FILLER          PIC X(06)        VALUE 'REPORT'.
042600     03  PK02-REPT       PIC X(06).
042700         88  R01-OPTION                   VALUE 'R01'.
042800         88  R02-OPTION                   VALUE 'R02'.
042900         88  R03-OPTION                   VALUE 'R03'.
043000         88  R04-OPTION                   VALUE 'R04'.
043100         88  R05-OPTION                   VALUE 'R05'.
043200
043300 01  PARM-KEY-03.
043400
043500     03  FILLER          PIC S9(4)   COMP VALUE 1.
043600     03  FILLER          PIC S9(4)   COMP VALUE 5.
043700     03  FILLER          PIC S9(4)   COMP VALUE 5.
043800     03  FILLER          PIC X(05)        VALUE 'TOTAL'.
043900     03  PK03-SUMM       PIC X(05).
044000         88  EJECT-OPTION                 VALUE 'EJECT'.
044100
044200 01  PARM-KEY-04.
044300
044400     03  FILLER          PIC S9(4)   COMP VALUE 1.
044500     03  FILLER          PIC S9(4)   COMP VALUE 3.
044600     03  FILLER          PIC S9(4)   COMP VALUE 3.
044700     03  FILLER          PIC X(03)        VALUE 'AGE'.
044800     03  PK04-AGE        PIC 9(03).
044900
045000 LINKAGE SECTION.
045100
045200 01  PROG-PARMS.
045300     03  FILLER          PIC X(102).
045400     EJECT
045500 PROCEDURE DIVISION USING PROG-PARMS.
045600
045700     CALL 'SSP634' USING PROG-PARMS
045800                         PARM-KEY-02
045900                         PARM-KEY-03
046000                         PARM-KEY-04.
046100
046200 0010-START-PROCESS SECTION.
046300
046400     MOVE TIME-OF-DAY TO TIME-WORK.
046500     MOVE TIME-WK1 TO TIME1-HL3.
046600     MOVE TIME-WK2 TO TIME2-HL3.
046700     MOVE CURRENT-DATE TO DATE-HL2.
046800
046900     MOVE CURRENT-DATE TO HOLD-DATE.
047000     MOVE HOLD-YY TO OLD-DATE-YY.
047100     MOVE HOLD-MM TO OLD-DATE-MM.
047200     MOVE HOLD-DD TO OLD-DATE-DD.
047300     MOVE OLD-DATE-NUM TO S630-DATE-2.
047400
047410     OPEN OUTPUT REPORT-FILE.
047420
047500     IF R01-OPTION
047600         MOVE '01' TO REPORT-NO-HL3
047700         MOVE REPORT1-ID TO REPORT-NAME-HL3
047710         GO TO 0020-DSNAME-SORT.
047800
047900     IF R02-OPTION
048000         MOVE '02' TO REPORT-NO-HL3
048100         MOVE 'TOTAL' TO TOTAL-TYPE
048200         MOVE REPORT2-ID TO REPORT-NAME-HL3
048201         OPEN OUTPUT SUMMARY-FILE
048210         GO TO 0020-DSNAME-SORT.
048300
048400     IF R03-OPTION
048500         MOVE '03' TO REPORT-NO-HL3
048600         MOVE REPORT3-ID TO REPORT-NAME-HL3
048610         GO TO 0030-VOLUME-SORT.
048700
048800     IF R04-OPTION
048900         MOVE '04' TO REPORT-NO-HL3
049000         MOVE 'TOTAL' TO TOTAL-TYPE
049100         MOVE REPORT4-ID TO REPORT-NAME-HL3
049110         GO TO 0030-VOLUME-SORT.
049200
049300     IF R05-OPTION
049400         MOVE '05' TO REPORT-NO-HL3
049500         MOVE REPORT5-ID TO REPORT-NAME-HL3
049510         GO TO 0040-AGE-SORT.
049600
051000
051100
051200 0020-DSNAME-SORT SECTION.
051300*
051400*
051500*     SORT FOR DATA SET NAME PROCESSING
051600*
051700*
051800     SORT SORT-FILE
051900         ASCENDING SORT-DSNAME SORT-VOLUME
052000             USING EXTRACT-INPUT
052100             OUTPUT PROCEDURE IS 0021-DSNAME-PROCESS.
052110
052120     IF R02-OPTION
052130         CLOSE SUMMARY-FILE.
052140
052200     STOP RUN.
052300
052400 0021-DSNAME-PROCESS SECTION.
052410
052500     RETURN SORT-FILE INTO EXTRACT-RECORD
052600         AT END
052700             GO TO 0028-END-OF-INPUT.
052710
052800     MOVE SPACES TO WS-NODE-SAVE-ONE.
052810
052900     IF EXTRACT-DSN-1ST-4 EQUAL 'SYS8'
053000         MOVE 'TEMPDS' TO WS-NODE-SAVE-ONE
053200         GO TO 0023-END-OF-NODE.
053300
053400     IF EXTRACT-DSN-1ST-4 EQUAL 'SSP.'
053401         MOVE 'SSP.' TO WS-NODE-SAVE-ONE
053402         SET DSNAME-INDEX TO 5
053403         GO TO 0022-SYS2-NODE-LOOP.
053410
053420     IF EXTRACT-DSN-1ST-5 EQUAL 'SICT.'
053430         MOVE 'SICT.' TO WS-NODE-SAVE-ONE
053440         SET DSNAME-INDEX TO 6
053450         GO TO 0022-SYS2-NODE-LOOP.
053460
053470     SET DSNAME-INDEX TO 1.
053500
053600 0022-NODE-LOOP.
053610
053700     IF EXTRACT-DSN-OCCURS (DSNAME-INDEX) = PERIOD-LITERAL
053800        OR EXTRACT-DSN-OCCURS (DSNAME-INDEX) = SPACES
053900         GO TO 0023-END-OF-NODE.
053910
054000     SET NODE1-INDEX TO DSNAME-INDEX.
054100     MOVE EXTRACT-DSN-OCCURS (DSNAME-INDEX) TO
054200         WS-NODE-SAVE-1 (NODE1-INDEX).
054210
054300     SET DSNAME-INDEX UP BY 1.
054400     GO TO 0022-NODE-LOOP.
054500
054600 0022-SYS2-NODE-LOOP.
054610
054700     IF EXTRACT-DSN-OCCURS (DSNAME-INDEX) = PERIOD-LITERAL
054800        OR EXTRACT-DSN-OCCURS (DSNAME-INDEX) = SPACES
054900         GO TO 0023-END-OF-NODE.
054910
055000     SET NODE1-INDEX TO DSNAME-INDEX.
055100     MOVE EXTRACT-DSN-OCCURS (DSNAME-INDEX) TO
055200         WS-NODE-SAVE-1 (NODE1-INDEX).
055300     SET DSNAME-INDEX UP BY 1.
055400     GO TO 0022-SYS2-NODE-LOOP.
055500
055600 0023-END-OF-NODE.
055610
055700     IF NODE-SAVE EQUAL SPACES
055800         MOVE WS-NODE-SAVE-ONE TO NODE-SAVE
055900         PERFORM 0300-PRINT-DETAIL-LINE
056000         GO TO 0021-DSNAME-PROCESS.
056010
056100     IF WS-NODE-SAVE-ONE EQUAL NODE-SAVE
056200         PERFORM 0300-PRINT-DETAIL-LINE
056300         GO TO 0021-DSNAME-PROCESS.
056310
056400     IF NODE2-SAVE = 'Z9999992         '
056500         MOVE 'VSAM' TO TOTAL-LINE-TYPE
056600         MOVE 'DSPACE' TO TOTAL-LINE-NODE-VOL
056700     ELSE
056800         IF NODE2-SAVE = 'Z9999994         '
056900             MOVE 'VSAM' TO TOTAL-LINE-TYPE
057000             MOVE 'USERCAT' TO TOTAL-LINE-NODE-VOL
057100         ELSE
057200             IF NODE2-SAVE = 'Z9999996         '
057300                 MOVE 'VSAM' TO TOTAL-LINE-TYPE
057400                 MOVE 'MASTCAT' TO TOTAL-LINE-NODE-VOL
057500             ELSE
057600                 MOVE 'NODE' TO TOTAL-LINE-TYPE
057700                 MOVE NODE-SAVE TO TOTAL-LINE-NODE-VOL.
057710
057800     MOVE NODE-SPACE-ALLOC-TOTAL TO TOTAL-LINE-SPC-ALLOC.
057900     MOVE NODE-SPACE-USED-TOTAL  TO TOTAL-LINE-SPC-USED.
058000     PERFORM 0500-PRINT-TOTAL-LINE.
058100     MOVE SPACES TO NODE-SAVE.
058200     GO TO 0023-END-OF-NODE.
058300
058400 0028-END-OF-INPUT.
058410
058500     IF NODE2-SAVE = 'Z9999992'
058600         MOVE 'VSAM' TO TOTAL-LINE-TYPE
058700         MOVE 'DSPACE' TO TOTAL-LINE-NODE-VOL
058800     ELSE
058900         IF NODE2-SAVE = 'Z9999994'
059000             MOVE 'VSAM' TO TOTAL-LINE-TYPE
059100             MOVE 'USERCAT' TO TOTAL-LINE-NODE-VOL
059200         ELSE
059300             IF NODE2-SAVE = 'Z9999996'
059400                 MOVE 'VSAM' TO TOTAL-LINE-TYPE
059500                 MOVE 'MASTCAT' TO TOTAL-LINE-NODE-VOL
059600             ELSE
059700                 MOVE 'NODE' TO TOTAL-LINE-TYPE
059800                 MOVE NODE2-SAVE TO TOTAL-LINE-NODE-VOL.
059810
059900     MOVE NODE-SPACE-ALLOC-TOTAL TO TOTAL-LINE-SPC-ALLOC.
060000     MOVE NODE-SPACE-USED-TOTAL  TO TOTAL-LINE-SPC-USED.
060100     PERFORM 0500-PRINT-TOTAL-LINE.
060200
060300 0029-DSNAME-EXIT.
060400     EXIT.
060500     EJECT
060600 0030-VOLUME-SORT SECTION.
060700*
060800*
060900*     SORT FOR VOLUME PROCESSING
061000*
061100*
061200     SORT SORT-FILE
061300         ASCENDING SORT-VOLUME SORT-DSNAME
061400             USING EXTRACT-INPUT
061500             OUTPUT PROCEDURE IS 0031-VOLUME-PROCESS.
061510
061520     DISPLAY 'TOTAL TRACKS ALLOC=>' TOTAL-SPACE-ALLOC.
061530     DISPLAY 'TOTAL TRACKS USED==>' TOTAL-SPACE-USED.
061540
061600     STOP RUN.
061700
061800 0031-VOLUME-PROCESS SECTION.
061900
062000     RETURN SORT-FILE INTO EXTRACT-RECORD
062100         AT END
062200             GO TO 0038-END-OF-INPUT.
062300
062400     IF R04-OPTION
062500         GO TO 0035-R4-REPORT.
062600
062700 0022-NEXT-VOL.
062800
062900     IF VOL-SAVE EQUAL SPACES
063000         MOVE EXTRACT-RES-VOL-SER TO VOL-SAVE
063100         MOVE EXTRACT-VOLUME-TYPE TO DEV-SAVE
063200         PERFORM 0300-PRINT-DETAIL-LINE
063300         GO TO 0031-VOLUME-PROCESS.
063400
063500     IF VOL-SAVE EQUAL EXTRACT-RES-VOL-SER
063600         PERFORM 0300-PRINT-DETAIL-LINE
063700         GO TO 0031-VOLUME-PROCESS.
063800
063900     MOVE 'VOLUME' TO TOTAL-LINE-TYPE.
064000     MOVE VOL-SAVE TO TOTAL-LINE-NODE-VOL.
064100     MOVE DEV-SAVE TO TOTAL-LINE-DEV.
064200     MOVE NODE-SPACE-ALLOC-TOTAL TO TOTAL-LINE-SPC-ALLOC.
064300     MOVE NODE-SPACE-USED-TOTAL  TO TOTAL-LINE-SPC-USED.
064400     PERFORM 0500-PRINT-TOTAL-LINE.
064500     MOVE SPACES TO VOL-SAVE.
064600     GO TO 0022-NEXT-VOL.
064700
064800 0035-R4-REPORT.
064900
065000     IF LINE-CNT IS GREATER THAN 48
065100         PERFORM 0400-PRINT-HEADINGS.
065200
065300     IF VOL-SAVE EQUAL SPACES
065400         MOVE EXTRACT-RES-VOL-SER TO VOL-SAVE
065500         MOVE EXTRACT-VOLUME-TYPE TO DEV-SAVE
065600         ADD EXTRACT-SPACE-ALLOC TO NODE-SPACE-ALLOC-TOTAL
065700         ADD EXTRACT-SPACE-USED  TO NODE-SPACE-USED-TOTAL
065800         ADD 1 TO NODE-DS-COUNT
065900         GO TO 0031-VOLUME-PROCESS.
066000
066100     IF VOL-SAVE IS NOT EQUAL TO EXTRACT-RES-VOL-SER
066200         PERFORM 0036-R4-TOTAL.
066300
066400     MOVE EXTRACT-RES-VOL-SER TO VOL-SAVE.
066500     MOVE EXTRACT-VOLUME-TYPE TO DEV-SAVE.
066600
066700     ADD EXTRACT-SPACE-ALLOC TO NODE-SPACE-ALLOC-TOTAL.
066800     ADD EXTRACT-SPACE-USED  TO NODE-SPACE-USED-TOTAL.
066900     ADD 1 TO NODE-DS-COUNT.
067000     GO TO 0031-VOLUME-PROCESS.
067100
067200 0036-R4-TOTAL.
067300
067400     MOVE VOL-SAVE TO R4-RES-VOLUME.
067500     MOVE DEV-SAVE TO R4-DEV.
067600     MOVE NODE-SPACE-ALLOC-TOTAL TO R4-SPC-ALLOC.
067700     MOVE NODE-SPACE-USED-TOTAL  TO R4-SPC-USED.
067800     MOVE NODE-DS-COUNT          TO R4-DS-COUNT.
067900
068000     IF DEV-SAVE IS EQUAL TO '3340'
068100         MOVE 698 TO R4-CYLS-PER-DEV
068200         MOVE 12 TO R4-TRKS-PER-CYL
068300         MOVE 8535 TO R4-TRK-SIZE.
068400
068500     IF DEV-SAVE IS EQUAL TO '3350'
068600         MOVE 555 TO R4-CYLS-PER-DEV
068700         MOVE 30 TO R4-TRKS-PER-CYL
068800         MOVE 19069 TO R4-TRK-SIZE.
068900
069000     IF DEV-SAVE IS EQUAL TO '3375'
069100         MOVE 959 TO R4-CYLS-PER-DEV
069200         MOVE 12 TO R4-TRKS-PER-CYL
069300         MOVE 35616 TO R4-TRK-SIZE.
069400
069500     WRITE REPORT-REC FROM R4-LINE AFTER 2.
069600
069610     ADD NODE-SPACE-ALLOC-TOTAL TO TOTAL-SPACE-ALLOC.
069620     ADD NODE-SPACE-USED-TOTAL TO TOTAL-SPACE-USED.
069630
069700     MOVE ZEROS TO NODE-SPACE-ALLOC-TOTAL
069800                   NODE-SPACE-USED-TOTAL
069900                   NODE-DS-COUNT.
070000
070100     MOVE SPACES TO R4-LINE.
070200
070300     ADD 2 TO LINE-CNT.
070400
070500 0038-END-OF-INPUT.
070600
070610     IF R04-OPTION
070620         PERFORM 0036-R4-TOTAL
070630
070640         ELSE
070650
070700             MOVE 'VOLUME' TO TOTAL-LINE-TYPE
070800             MOVE VOL-SAVE TO TOTAL-LINE-NODE-VOL
070900             MOVE DEV-SAVE TO TOTAL-LINE-DEV
071000             MOVE NODE-SPACE-ALLOC-TOTAL TO TOTAL-LINE-SPC-ALLOC
071100             MOVE NODE-SPACE-USED-TOTAL  TO TOTAL-LINE-SPC-USED
071200             PERFORM 0500-PRINT-TOTAL-LINE.
071300
071400 0039-VOLUME-EXIT.
071500     EXIT.
071600     EJECT
071700 0040-AGE-SORT SECTION.
071800*
071900*
072000*     SORT FOR AGE PROCESSING
072100*
072200*
072300     SORT SORT-FILE
072400         DESCENDING  SORT-AGE SORT-DSNAME SORT-VOLUME
072500             INPUT  PROCEDURE IS 0041-AGE-INPUT
072600             OUTPUT PROCEDURE IS 0044-AGE-PROCESS.
072700     STOP RUN.
072800
072900 0041-AGE-INPUT SECTION.
073000
073100     OPEN INPUT EXTRACT-INPUT.
073200
073300 0042-AGE-READ.
073400
073500     READ EXTRACT-INPUT INTO EXTRACT-RECORD
073600         AT END GO TO 0043-AGE-READ-EXIT.
073700
073710     IF EXTRACT-DSN-1ST-4 IS EQUAL TO 'SSP.'
073720         GO TO 0042-AGE-READ.
073730
073740     IF EXTRACT-DSN-1ST-4 IS EQUAL TO 'SYS1'
073750         GO TO 0042-AGE-READ.
073760
073770     IF EXTRACT-DSN-1ST-4 IS EQUAL TO 'SYS3'
073780         GO TO 0042-AGE-READ.
073790
073800     MOVE EXTRACT-RECORD TO SORT-RECORD.
073900     MOVE EXTRACT-EXPIR-DATE TO HOLD-DATE-NUM
074000     MOVE HOLD-DATE-GRP-MM TO OLD-DATE-MM
074100     MOVE HOLD-DATE-GRP-DD TO OLD-DATE-DD
074200     MOVE HOLD-DATE-GRP-YY TO OLD-DATE-YY.
074300     MOVE OLD-DATE-NUM TO S630-DATE-1.
074400     MOVE '4' TO S630-REQUEST.
074500     MOVE ' ' TO S630-RETURN-CODE.
074600     MOVE ZEROS TO SORT-AGE.
074700
074800     IF EXTRACT-EXPIR-DATE IS NOT EQUAL TO ZEROS
074900         CALL 'SSP630' USING S630-LIST
075000         MOVE S630-NO-DAYS TO SORT-AGE.
075100
075200     IF S630-RETURN-CODE IS NOT EQUAL TO SPACES
075300         DISPLAY 'SSP502 - BAD DATE'.
075400
075500     IF SORT-AGE IS GREATER THAN PK04-AGE
075600         RELEASE SORT-RECORD.
075700
075800     GO TO 0042-AGE-READ.
075900
076000 0043-AGE-READ-EXIT.
076100
076200     EXIT.
076300
076400 0044-AGE-PROCESS SECTION.
076500
076600     RETURN SORT-FILE INTO EXTRACT-RECORD
076700         AT END GO TO 0049-AGE-PROCESS-EXIT.
076800     IF LINE-CNT GREATER THAN 48
076900         PERFORM 0400-PRINT-HEADINGS.
077000     IF EXTRACT-DSN-1ST-8 = 'Z9999992'
077100         MOVE EXTRACT-SPACE-ALLOC TO EXTRACT-SPACE-USED
077200         MOVE 'V S A M   D A T A   S P A C E' TO
077300             R5-DSN
077400     ELSE
077500         IF EXTRACT-DSN-1ST-8 = 'Z9999994'
077600             MOVE EXTRACT-SPACE-ALLOC TO EXTRACT-SPACE-USED
077700             MOVE 'V S A M   U S E R   C A T A L O G ( S )'
077800                  TO R5-DSN
077900         ELSE
078000             IF EXTRACT-DSN-1ST-8 = 'Z9999996'
078100                 MOVE EXTRACT-SPACE-ALLOC TO EXTRACT-SPACE-USED
078200                 MOVE 'V S A M   M A S T E R   C A T A L O G'
078300                      TO R5-DSN
078400             ELSE
078500                 MOVE EXTRACT-DSN TO R5-DSN.
078600     MOVE EXTRACT-RES-VOL-SER TO R5-RES-VOLUME.
078700     MOVE EXTRACT-NUM-EXTENTS TO R5-NUM-EXTENTS.
078800     MOVE EXTRACT-SPACE-ALLOC TO R5-TRKS-ALLOC.
078900     MOVE EXTRACT-SPACE-USED  TO R5-TRKS-USED.
079000     MOVE EXTRACT-CREATE-DATE TO HOLD-DATE-NUM.
079100     MOVE HOLD-DATE-GRP-MM TO R5-CRT-MM.
079200     MOVE HOLD-DATE-GRP-DD TO R5-CRT-DD.
079300     MOVE HOLD-DATE-GRP-YY TO R5-CRT-YY.
079400     IF EXTRACT-EXPIR-DATE = ZEROS
079500         MOVE 'NVR OPEN' TO R5-EXPIR-DATE
079600     ELSE
079700         MOVE EXTRACT-EXPIR-DATE TO HOLD-DATE-NUM
079800         MOVE '  /  /  ' TO R5-EXPIR-DATE
079900         MOVE HOLD-DATE-GRP-MM TO R5-EXP-MM
080000         MOVE HOLD-DATE-GRP-DD TO R5-EXP-DD
080100         MOVE HOLD-DATE-GRP-YY TO R5-EXP-YY.
080200     MOVE SORT-AGE TO R5-AGE.
080300     MOVE EXTRACT-ALLOC-PARM TO R5-ALLOC-PARM.
080400     IF EXTRACT-CATALGD-VOLSER EQUAL 'NOTCAT'
080500             MOVE 'NO ' TO R5-CATALOG-STAT
080600     ELSE
080700         MOVE 'YES' TO R5-CATALOG-STAT.
080750
080800     IF EXTRACT-SPACE-USED EQUAL ZEROS
080900         MOVE +100 TO R5-PCT-FREE
081000     ELSE
081100         COMPUTE WORK-PCT-FREE =
081200               (EXTRACT-SPACE-ALLOC - EXTRACT-SPACE-USED) /
081300                     EXTRACT-SPACE-ALLOC                * 100
081400         MOVE WORK-PCT-FREE TO R5-PCT-FREE.
081500
081600     IF EXTRACT-DSN-1ST-4 = 'Z999'
081700         MOVE 'N/A' TO R5-X-PCT-FREE.
081800
081900     WRITE REPORT-REC FROM R5-LINE AFTER 2
082000     ADD 2 TO LINE-CNT.
082100
082200     GO TO 0044-AGE-PROCESS.
082300
082400 0049-AGE-PROCESS-EXIT.
082500     EXIT.
082600
082700 0300-PRINT-SECTION SECTION.
082800
082900 0300-PRINT-DETAIL-LINE.
082910
083000     IF LINE-CNT GREATER THAN 48
083100         PERFORM 0400-PRINT-HEADINGS.
083110
083200     IF EXTRACT-DSN-1ST-8 = 'Z9999992'
083300         MOVE EXTRACT-SPACE-ALLOC TO EXTRACT-SPACE-USED
083400         MOVE 'V S A M   D A T A   S P A C E' TO
083500             DETAIL-DATA-SET-NAME
083600     ELSE
083700         IF EXTRACT-DSN-1ST-8 = 'Z9999994'
083800             MOVE EXTRACT-SPACE-ALLOC TO EXTRACT-SPACE-USED
083900             MOVE 'V S A M   U S E R   C A T A L O G ( S )'
084000                  TO DETAIL-DATA-SET-NAME
084100         ELSE
084200             IF EXTRACT-DSN-1ST-8 = 'Z9999996'
084300                 MOVE EXTRACT-SPACE-ALLOC TO EXTRACT-SPACE-USED
084400                 MOVE 'V S A M   M A S T E R   C A T A L O G'
084500                      TO DETAIL-DATA-SET-NAME
084600             ELSE
084700                 MOVE EXTRACT-DSN TO DETAIL-DATA-SET-NAME.
084710
084800     MOVE EXTRACT-RES-VOL-SER TO DETAIL-RES-VOLUME.
084810     MOVE EXTRACT-DSORG TO DETAIL-DSORG.
084811     MOVE EXTRACT-RECFM TO DETAIL-RECFM.
084820     MOVE EXTRACT-LRECL TO DETAIL-LRECL.
084830     MOVE EXTRACT-BLKSIZE TO DETAIL-BLKSIZE.
084900     MOVE EXTRACT-NUM-EXTENTS TO DETAIL-NUM-EXTENTS.
085000     ADD EXTRACT-SPACE-ALLOC TO NODE-SPACE-ALLOC-TOTAL
085100     ADD EXTRACT-SPACE-USED  TO NODE-SPACE-USED-TOTAL
085110
085120     IF EXTRACT-VOLUME-TYPE IS EQUAL TO '3340'
085130         ADD EXTRACT-SPACE-ALLOC TO SUMM-3340.
085131
085132     IF EXTRACT-VOLUME-TYPE IS EQUAL TO '3350'
085133         ADD EXTRACT-SPACE-ALLOC TO SUMM-3350.
085134
085135     IF EXTRACT-VOLUME-TYPE IS EQUAL TO '3375'
085136         ADD EXTRACT-SPACE-ALLOC TO SUMM-3375.
085137
085138     IF EXTRACT-VOLUME-TYPE IS EQUAL TO '3380'
085139         ADD EXTRACT-SPACE-ALLOC TO SUMM-3380.
085140
085200     ADD 1 TO NODE-DS-COUNT.
085300     MOVE EXTRACT-SPACE-ALLOC TO DETAIL-TRKS-ALLOC.
085400     MOVE EXTRACT-SPACE-USED  TO DETAIL-TRKS-USED.
085500     MOVE EXTRACT-CREATE-DATE TO HOLD-DATE-NUM.
085600     MOVE HOLD-DATE-GRP-MM TO DETAIL-CRT-MM.
085700     MOVE HOLD-DATE-GRP-DD TO DETAIL-CRT-DD.
085800     MOVE HOLD-DATE-GRP-YY TO DETAIL-CRT-YY.
085810
085900     IF EXTRACT-EXPIR-DATE = ZEROS
086000         MOVE 'NVR OPEN' TO DETAIL-EXPIR-DATE
086100     ELSE
086200         MOVE EXTRACT-EXPIR-DATE TO HOLD-DATE-NUM
086300         MOVE '  /  /  ' TO DETAIL-EXPIR-DATE
086400         MOVE HOLD-DATE-GRP-MM TO DETAIL-EXP-MM
086500         MOVE HOLD-DATE-GRP-DD TO DETAIL-EXP-DD
086600         MOVE HOLD-DATE-GRP-YY TO DETAIL-EXP-YY.
086610
086700     MOVE EXTRACT-ALLOC-PARM TO DETAIL-ALLOC-PARM.
086800     IF EXTRACT-CATALGD-VOLSER EQUAL 'NOTCAT'
086900             MOVE 'N' TO DETAIL-CATALOG-STAT
087000     ELSE
087100         MOVE 'Y' TO DETAIL-CATALOG-STAT.
087101
087102     MOVE EXTRACT-RACF TO DETAIL-RACF.
087110
087200     IF EXTRACT-SPACE-USED EQUAL ZEROS
087300         MOVE +100 TO DETAIL-PCT-FREE
087400     ELSE
087500         COMPUTE WORK-PCT-FREE =
087600               (EXTRACT-SPACE-ALLOC - EXTRACT-SPACE-USED) /
087700                     EXTRACT-SPACE-ALLOC                * 100
087800         MOVE WORK-PCT-FREE TO DETAIL-PCT-FREE.
087900
088000     IF EXTRACT-DSN-1ST-4 = 'Z999'
088100         MOVE 'N/A' TO DETAIL-X-PCT-FREE.
088200
088300     IF TOTALS-ONLY
088400         NEXT SENTENCE
088500     ELSE
088600         WRITE REPORT-REC FROM DETAIL-LINE-1 AFTER 1
088700         ADD 1 TO LINE-CNT.
088800
088900 0400-PRINT-HEADINGS.
089000
089100     ADD 1 TO PAGE-CNT.
089200     MOVE PAGE-CNT TO PAGE-NO-HL1.
089300     WRITE REPORT-REC FROM HEADING-LINE-1 AFTER TO-TOP.
089400     MOVE ZEROS TO LINE-CNT.
089500     WRITE REPORT-REC FROM HEADING-LINE-2 AFTER 1.
089600     WRITE REPORT-REC FROM HEADING-LINE-3 AFTER 1.
089700     MOVE ALL '-' TO REPORT-REC.
089800     WRITE REPORT-REC AFTER 1.
089900
090000     IF R01-OPTION
090100
090200         WRITE REPORT-REC FROM DETAIL-HEADING-1 AFTER 1
090300         WRITE REPORT-REC FROM DETAIL-HEADING-2 AFTER 1.
090400
090500     IF R02-OPTION
090600
090700         WRITE REPORT-REC FROM TOTALS-DTL-HDG-1 AFTER 1
090800         WRITE REPORT-REC FROM TOTALS-DTL-HDG-2 AFTER 1.
090900
091000     IF R03-OPTION
091100
091200         WRITE REPORT-REC FROM DETAIL-HEADING-1 AFTER 1
091300         WRITE REPORT-REC FROM DETAIL-HEADING-2 AFTER 1.
091400
091500     IF R04-OPTION
091600
091700         WRITE REPORT-REC FROM DET-HEAD-R4-1 AFTER 1
091800         WRITE REPORT-REC FROM DET-HEAD-R4-2 AFTER 1
091810         WRITE REPORT-REC FROM DET-HEAD-R4-3 AFTER 1.
091900
092000     IF R05-OPTION
092100
092200         WRITE REPORT-REC FROM DET-HEAD-R5-1 AFTER 1
092300         WRITE REPORT-REC FROM DET-HEAD-R5-2 AFTER 1.
092400
092500     MOVE ALL '-' TO REPORT-REC.
092600     WRITE REPORT-REC AFTER 1.
092700
092800     MOVE SPACES TO REPORT-REC.
092900     WRITE REPORT-REC AFTER 1.
093000
093100 0500-PRINT-TOTAL-LINE.
093200
093300     WRITE REPORT-REC FROM TOTAL-LINE-1 AFTER 2.
093400
093500     IF TOTALS-ONLY
093600         ADD 2 TO LINE-CNT
093700     ELSE
093800         MOVE SPACES TO REPORT-REC
093900         WRITE REPORT-REC AFTER 1
094000         ADD 3 TO LINE-CNT.
094100
094200     IF EJECT-OPTION
094300         PERFORM 0400-PRINT-HEADINGS.
094310
094320     IF R02-OPTION
094330         PERFORM 0450-SUMMARY-PROCESS.
094400
094500     MOVE ZEROS TO NODE-SPACE-ALLOC-TOTAL
094600                   NODE-DS-COUNT
094700                   NODE-SPACE-USED-TOTAL.
094800
094900 0450-SUMMARY-PROCESS.
095000
095100     MOVE NODE-SAVE TO SR-NODE.
095200     MOVE 'SEQ' TO SR-TYPE.
095300     MOVE CURRENT-DATE TO SR-DATE.
095400     MOVE SUMM-3340 TO SR-TOT-3340.
095500     MOVE SUMM-3350 TO SR-TOT-3350.
095600     MOVE SUMM-3375 TO SR-TOT-3375.
095700     MOVE SUMM-3380 TO SR-TOT-3380.
095800
095900     WRITE SUMMARY-REC.
096000
096100     MOVE ZEROS TO SUMM-3340.
096200     MOVE ZEROS TO SUMM-3350.
096300     MOVE ZEROS TO SUMM-3375.
096400     MOVE ZEROS TO SUMM-3380.

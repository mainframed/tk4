000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.   SSP507.
000300
000400 ENVIRONMENT DIVISION.
000500 CONFIGURATION SECTION.
000600 SOURCE-COMPUTER.  IBM-370.
000700 OBJECT-COMPUTER.  IBM-370.
000800 SPECIAL-NAMES.
000900     C01 IS TO-TOP.
001000     SKIP2
001100 INPUT-OUTPUT SECTION.
001200     SKIP1
001300 FILE-CONTROL.
001600     SELECT OUTPUT-REPORT
001700         ASSIGN TO UT-S-DMSRPT.
002200     SELECT DSN-MASTER
002300         ASSIGN TO DMSDSN
002400         ORGANIZATION IS INDEXED
002500         ACCESS MODE IS SEQUENTIAL
002600         RECORD KEY IS DSM-KEY
002700         FILE STATUS IS VSAM-STATUS.
002800
002900 DATA DIVISION.
003000
003100 FILE SECTION.
003200
007700 FD  OUTPUT-REPORT
007800     RECORDING MODE IS F
007900     LABEL RECORDS ARE STANDARD
008000     RECORD CONTAINS 133 CHARACTERS
008100     BLOCK CONTAINS 1 RECORDS
008200     DATA RECORD IS REPORT-REC.
008300
008400 01  REPORT-REC                  PIC X(133).
010400
010500 FD  DSN-MASTER
010600     LABEL RECORDS ARE STANDARD
010700     RECORD CONTAINS 300 CHARACTERS
010800     DATA RECORD IS DSM-RECORD.
010900
011000     COPY SSP507C1.
011300     EJECT
011400 WORKING-STORAGE SECTION.
011500
011600 01  DSN-SUB                     PIC S9(4)  VALUE +0    COMP.
011700
011800 01  ABEND-CODE                  PIC S9(4)  VALUE +333  COMP.
011900
012000 01  LINE-CNT                    PIC S9(5)  VALUE +99 COMP-3.
012100
012200 01  PAGE-CNT                    PIC S9(5)  VALUE ZEROS COMP-3.
012300
014200 01  HOLD-JULIAN                 PIC S9(7)  VALUE ZEROS.
014300
014400 01  VSAM-STATUS-AREA.
014500     03  VSAM-STATUS.
014600         05  VSAM-STAT-BYTE1     PIC X(1).
014700             88  STATUS-OK                  VALUE '0'.
014800             88  STATUS-AT-END              VALUE '1'.
014900             88  STATUS-INVALID-KEY         VALUE '2'.
015000             88  STATUS-ERROR               VALUE '3'.
015100             88  STATUS-OTHER               VALUE '9'.
015200             88  STATUS-ABORT               VALUE '1' '3' '9'.
015300         05  VSAM-STAT-BYTE2     PIC X(1).
015400     03  VSAM-STAT-BOTH REDEFINES VSAM-STATUS PIC X(2).
015500         88  DUPLICATE-RECORD               VALUE '22'.
015710
015720 01  TIME-WORK.
015800     02  TIME-WK1                PIC XX.
015900     02  TIME-WK2                PIC XX.
016000     02  TIME-WK3                PIC XX.
016100
016200 01  OLD-DATE-NUM                PIC 9(6).
016300 01  OLD-DATE REDEFINES OLD-DATE-NUM.
016400     05  OLD-DATE-YY             PIC 99.
016500     05  OLD-DATE-MM             PIC 99.
016600     05  OLD-DATE-DD             PIC 99.
017400
017500 01  HOLD-DATE-2.
017600
017700     05  HOLD-DATE-NUM           PIC 9(7).
017800     05  HOLD-DATE-GRP  REDEFINES HOLD-DATE-NUM.
017900         10  FILLER              PIC X.
018000         10  HOLD-DATE-MDY.
018100             15  HOLD-DATE-GRP-MM    PIC 9(2).
018200             15  HOLD-DATE-GRP-DD    PIC 9(2).
018300             15  HOLD-DATE-GRP-YY    PIC 9(2).
018400
018500 01  HOLD-DATE.
018600     05  HOLD-MM                 PIC 99.
018700     05  FILLER                  PIC X.
018800     05  HOLD-DD                 PIC 99.
018900     05  FILLER                  PIC X.
019000     05  HOLD-YY                 PIC 99.
019300
019400 01  HOLD-DATE-3.
019500     05  HOLD-3-YYYY.
019600         10  FILLER              PIC X(2).
019700         10  HOLD-3-YY           PIC 9(2).
019800     05  HOLD-3-DDD              PIC S9(3).
019900
023100 01  SYS-COMPARE.
023200     05  FILLER                  PIC X(3)       VALUE 'SYS'.
023300     05  SYS-YY                  PIC 9(2).
023400     05  SYS-DDD                 PIC 9(3).
023500     EJECT
023600
023700 01  HEADING-LINE-1.
023800
023900     02  FILLER                  PIC X(25) VALUE
024000         'MUNICIPALITY OF ANCHORAGE'.
024100     02  FILLER                  PIC X(14) VALUE SPACES.
024200     02  FILLER                  PIC X(02) VALUE SPACES.
024300     02  FILLER                  PIC X(49)
024400         VALUE '   D I S K   M A N A G E M E N T   S Y S T E M'.
024500     02  FILLER                  PIC X(02) VALUE SPACES.
024600     02  FILLER                  PIC X(26) VALUE SPACES.
024700     02  FILLER                  PIC X(09) VALUE 'PAGE NO: '.
024800     02  PAGE-NO-HL1             PIC Z(5).
024900
025000 01  HEADING-LINE-2.
025100
025200     02  FILLER                  PIC X(25) VALUE
025300         'INFORMATION SYSTEMS DEPT.'.
025400     02  FILLER                  PIC X(93) VALUE SPACES.
025500     02  FILLER                  PIC X(06) VALUE 'DATE: '.
025600     02  DATE-HL2                PIC X(8)  VALUE SPACES.
025700
025800 01  HEADING-LINE-3.
025900
026000     02  FILLER                  PIC X(17) VALUE
026100         'REPORT: SSP507-R1'.
026200     02  FILLER                  PIC X(06) VALUE SPACES.
026300     02  FILLER                  PIC X(16) VALUE SPACES.
026400     02  REPORT-NAME-HL3         PIC X(53)
026500         VALUE '            DATA SET AUTHORIZATION MASTER   '.
026600     02  FILLER                  PIC X(26) VALUE SPACES.
026700     02  FILLER                  PIC X(09) VALUE 'TIME:    '.
026800     02  TIME1-HL3               PIC X(2)  VALUE SPACES.
026900     02  FILLER                  PIC X(1)  VALUE ':'.
027000     02  TIME2-HL3               PIC X(2)  VALUE SPACES.
027100
027200 01  PRINT-LINES.
027300
027400     05  DETAIL-HEADING-1.
027500
027600         10  FILLER              PIC X(46)
027700             VALUE SPACES.
027800         10  FILLER              PIC X(10)
027900             VALUE 'CREATE'.
028000         10  FILLER              PIC X(10)
028100             VALUE 'CHANGE'.
028200         10  FILLER              PIC X(6)
028300             VALUE SPACES.
028400         10  FILLER              PIC X(7)
028500             VALUE SPACES.
028510         10  FILLER              PIC X(5)
028520             VALUE SPACES.
028530         10  FILLER              PIC X(4)
028540             VALUE SPACES.
028550         10  FILLER              PIC X(6)
028560             VALUE 'DEV'.
028570         10  FILLER              PIC X(8)
028580             VALUE SPACES.
028590         10  FILLER              PIC X(10)
028591             VALUE 'RETAIN'.
028600
028700     05  DETAIL-HEADING-2.
028800
028900         10  FILLER              PIC X(46)
029000             VALUE 'DATA SET NAME'.
029100         10  FILLER              PIC X(10)
029200             VALUE ' DATE '.
029300         10  FILLER              PIC X(10)
029400             VALUE ' DATE '.
029500         10  FILLER              PIC X(6)
029600             VALUE 'STR'.
029700         10  FILLER              PIC X(7)
029800             VALUE 'SIZE'.
029900         10  FILLER              PIC X(5)
029910             VALUE 'GRO'.
029920         10  FILLER              PIC X(4)
029930             VALUE 'GDG'.
029940         10  FILLER              PIC X(6)
029950             VALUE 'TYPE'.
029960         10  FILLER              PIC X(8)
029970             VALUE 'VOLSER'.
029980         10  FILLER              PIC X(10)
029990             VALUE ' DATE '.
030000
030100 01  PRINT-WORK.
030110
030200     10  DSN-PW                  PIC X(44).
030201     10  FILLER                  PIC X(2).
030210     10  CREATE-DATE-MM-PW       PIC X(2).
030211     10  CREATE-DATE-D1-PW       PIC X(1).
030220     10  CREATE-DATE-DD-PW       PIC X(2).
030221     10  CREATE-DATE-D2-PW       PIC X(1).
030230     10  CREATE-DATE-YY-PW       PIC X(2).
030231     10  FILLER                  PIC X(2).
030240     10  CHG-DATE-MM-PW          PIC X(2).
030250     10  CHG-DATE-D1-PW          PIC X(1).
030260     10  CHG-DATE-DD-PW          PIC X(2).
030270     10  CHG-DATE-D2-PW          PIC X(1).
030280     10  CHG-DATE-YY-PW          PIC X(2).
030281     10  FILLER                  PIC X(2).
030290     10  STRUCTURE-PW            PIC X(4).
030291     10  FILLER                  PIC X(2).
030292     10  SIZE-PW                 PIC Z(5).
030293     10  FILLER                  PIC X(2).
030294     10  GROWTH-PW               PIC Z(3).
030295     10  FILLER                  PIC X(2).
030296     10  GDG-PW                  PIC Z(2).
030297     10  FILLER                  PIC X(2).
030298     10  DEV-TYPE-PW             PIC X(4).
030299     10  FILLER                  PIC X(2).
030300     10  VOLSER-PW               PIC X(6).
030301     10  FILLER                  PIC X(2).
030302     10  RETAIN-DATE-MM-PW       PIC X(2).
030303     10  RETAIN-DATE-D1-PW       PIC X(1).
030304     10  RETAIN-DATE-DD-PW       PIC X(2).
030305     10  RETAIN-DATE-D2-PW       PIC X(1).
030310     10  RETAIN-DATE-YY-PW       PIC X(2).
030320     10  FILLER                  PIC X(2).
030330     10  RECFM-PW                PIC X(3).
030340     10  FILLER                  PIC X(1).
030350     10  LRECL-PW                PIC Z(5).
030360     10  FILLER                  PIC X(1).
030370     10  BLKSIZE-PW              PIC Z(5).
030380     10  FILLER                  PIC X(1).
030400
033100     EJECT
033200 PROCEDURE DIVISION.
033300
033400 START-IT.
033700     OPEN OUTPUT OUTPUT-REPORT.
033900
034000     OPEN INPUT DSN-MASTER.
034100
034200     IF STATUS-ABORT
034300         DISPLAY 'CANNOT OPEN DSN MASTER  FILE STATUS='
034400                 VSAM-STATUS
034500         GO TO CLOSE-FILES.
034600
035300
035400     MOVE TIME-OF-DAY TO TIME-WORK.
035500     MOVE TIME-WK1 TO TIME1-HL3.
035600     MOVE TIME-WK2 TO TIME2-HL3.
035700     MOVE CURRENT-DATE TO DATE-HL2.
036400
036500     PERFORM WRITE-HEADINGS.
038100
038200 PROCESS-INPUT.
038300
038400     READ  DSN-MASTER
038500          AT END   GO TO EOJ.
054910
055000     IF LINE-CNT GREATER THAN 48
055100         PERFORM WRITE-HEADINGS.
055110     MOVE SPACES TO PRINT-WORK.
055200
055300     MOVE DSM-KEY TO DSN-PW.
055400     MOVE DSM-CREATE-DATE-MM TO CREATE-DATE-MM-PW
055410     MOVE '/' TO CREATE-DATE-D1-PW.
055500     MOVE DSM-CREATE-DATE-DD TO CREATE-DATE-DD-PW
055510     MOVE '/' TO CREATE-DATE-D2-PW.
055600     MOVE DSM-CREATE-DATE-YY TO CREATE-DATE-YY-PW
055700     MOVE DSM-CHG-DATE-MM TO CHG-DATE-MM-PW.
055710     MOVE '/' TO CHG-DATE-D1-PW.
055800     MOVE DSM-CHG-DATE-DD TO CHG-DATE-DD-PW.
055810     MOVE '/' TO CHG-DATE-D2-PW.
055900     MOVE DSM-CHG-DATE-YY TO CHG-DATE-YY-PW.
056000     MOVE DSM-STRUCTURE TO STRUCTURE-PW.
056100     MOVE DSM-SIZE TO SIZE-PW.
056200     MOVE DSM-GROWTH TO GROWTH-PW.
056300     MOVE DSM-GDG TO GDG-PW.
056400     MOVE DSM-DEV-TYPE TO DEV-TYPE-PW.
056500     MOVE DSM-VOLSER TO VOLSER-PW.
056600     MOVE DSM-RETAIN-DATE-MM TO RETAIN-DATE-MM-PW.
056610     MOVE '/' TO RETAIN-DATE-D1-PW.
056700     MOVE DSM-RETAIN-DATE-DD TO RETAIN-DATE-DD-PW.
056710     MOVE '/' TO RETAIN-DATE-D2-PW.
056800     MOVE DSM-RETAIN-DATE-YY TO RETAIN-DATE-YY-PW.
056900     MOVE DSM-RECFM TO RECFM-PW.
056910     MOVE DSM-LRECL TO LRECL-PW.
056920     MOVE DSM-BLKSIZE TO BLKSIZE-PW.
057000
057100     WRITE REPORT-REC FROM PRINT-WORK AFTER 2.
057200     ADD 2 TO LINE-CNT.
057210
057220     GO TO PROCESS-INPUT.
057300
059300 WRITE-HEADINGS SECTION.
059400
059500     ADD 1 TO PAGE-CNT.
059600     MOVE PAGE-CNT TO PAGE-NO-HL1.
059700     WRITE REPORT-REC FROM HEADING-LINE-1 AFTER TO-TOP.
059800     MOVE ZEROS TO LINE-CNT.
059900     WRITE REPORT-REC FROM HEADING-LINE-2 AFTER 1.
060000     WRITE REPORT-REC FROM HEADING-LINE-3 AFTER 1.
060100     MOVE ALL '-' TO REPORT-REC.
060200     WRITE REPORT-REC AFTER 1.
060300     WRITE REPORT-REC FROM DETAIL-HEADING-1 AFTER 1.
060400     WRITE REPORT-REC FROM DETAIL-HEADING-2 AFTER 1.
060500     MOVE ALL '-' TO REPORT-REC.
060600     WRITE REPORT-REC AFTER 1.
060700     MOVE SPACES TO REPORT-REC.
060800     WRITE REPORT-REC AFTER 1.
060900
061000 EOJ SECTION.
061100
063100
063200 CLOSE-FILES.
063300
063400     CLOSE OUTPUT-REPORT
063800           DSN-MASTER.
063900
064000     STOP RUN.

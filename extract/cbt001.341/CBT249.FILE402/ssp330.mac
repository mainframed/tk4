       ID DIVISION.
       PROGRAM-ID.         SSP330.
       AUTHOR.
                 RON KOHL.
       REMARKS.
                 THIS PROGRAM IS USED TO RETURN CURRENT-DATE TO
                 A CICS USER.  THE USER CALLS THIS PROGRAM USING
                 THE EIB FIELD EIBDATE AND A DATE-AREA OF 98 BYTES.
                 THIS PROGRAM ACTUALLY CALLS 'SSP301' TO PERFORM
                 THE DATE FUNCTION.  THE ONLY REASON THIS PROGRAM
                 IS WRITTEN IS TO ENCOURAGE THE PROGRAMMER TO USE IT
                 INSTEAD OF USING 'CURRENT-DATE' FUNCTION.

                 TO USE IT===>   CALL 'SSP330' USING EIBDATE DATE-AREA.
       SKIP1
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SOURCE-COMPUTER. IBM-370.
       OBJECT-COMPUTER. IBM-370.
       DATA DIVISION.
       WORKING-STORAGE SECTION.

       01  DATE-AREA.
           05  GREGORIAN-MMDDYY    PIC X(6).
           05  GREGORIAN-MMDDYYYY  PIC X(8).
           05  JULIAN-YYYYDDD      PIC 9(7).
           05  INCREMENT-MONTHS    PIC S9(3).
           05  INCREMENT-DAYS      PIC S9(3).
           05  GREGORIAN-EDITED    PIC X(8).
      *           XX/XX/XX
           05  MMM-YYYY-EDITED     PIC X(9).
      *           MMM  YYYY
           05  MMM-DD-YYYY-EDITED  PIC X(12).
      *           MMM DD, YYYY
           05  DAY-OF-WEEK         PIC X(9).
           05  ERROR-CODE          PIC X(2).
           05  ERROR-DESCRIPTION   PIC X(31).

       LINKAGE SECTION.

       01  EIBDATE    COMP-3       PIC S9(7).
      *    FORMAT IS 00YYDDD

       01  PASSED-DATE-AREA        PIC X(98).

       PROCEDURE DIVISION USING EIBDATE PASSED-DATE-AREA.

           MOVE SPACES TO DATE-AREA.
           MOVE 0 TO INCREMENT-MONTHS INCREMENT-DAYS.
           MOVE EIBDATE TO JULIAN-YYYYDDD.
           ADD 1900000 TO JULIAN-YYYYDDD.
           CALL 'SSP301' USING DATE-AREA.
           MOVE DATE-AREA TO PASSED-DATE-AREA.
           GOBACK.

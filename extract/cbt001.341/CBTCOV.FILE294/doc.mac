1
-
-
-
-
-
                          Program Documentation
                                   for
                                  MACROS
-
-
-
-
-
-
-
-
0                              PREPARED BY:
                              HANS J. BECKER
                    ENERGY INFORMATION ADMINISTRATION
-

-
-
                              DATE PREPARED:
                               May 10, 1985
1                           TABLE_OF_CONTENTS
+                           _____ __ ________

0I.__INTRODUCTION
+__  ____________
0II.__JOB_CONTROL_LANGUAGE
+___  ___ _______ ________
   A.  EXEC
   B.  STEPLIB
   C.  SYSPRINT
   D.  SYSOUT
   E.  MACROS
   F.  SYSIN
   G.  PDSLIST
   H.  MEMBERS
   I.  EDIT
   J.  PDSCOPY
   K.  INPUT
0III.__INPUT_FILE_STREAM
+____  _____ ____ ______
   A.  Control Record Format
     1.  CASE 1:  &PARM="NEW OR CHANGED OPTIONS"
     2.  CASE 2:  &GLOBAL SELECTION CRITERIA AND/OR CHANGES.
     3.  CASE 3:  &MEMBER PDSNAME CHANGES, SELECTION CRITERIA.
     4.  CASE 4:  &MEMBER CHANGE TARGET TO REPLACEMENT
   B.  Selection Criteria
     1.  INCLUDE:  syntax INC=(5/80) or INCLUDE=(6-66)
     2.  EXCLUDE:  syntax EXC=(5-55) or EXCLUDE=(5/55)
     3.  EXTRACT:  syntax SEL=(any pattern)
     4.  DELETE syntax DEL=(any pattern)
     5.  FROM/TO:  syntax FROM=(any pattern), TO=(any pattern)
   C.  Logical Variables
     1.  ANYPDS (default=false)
     2.  BLANKLINE (default=true)
     3.  DTS (default=false)
     4.  INTRDR (default=false)
     5.  LIST or LISTPDS (default=false)
     6.  LONG (default=true) and SHORT (default=false)
     7.  NAME (default=false)
     8.  NEST (default=true)
     9.  OPTN (default=true)
     10.  NUM (default=true)
     11.  PRINT (default=false)
     12.  PROFILE (default=false)
     13.  RENUM (default=false)
     14.  WYLFMT (default=false)
     15.  OR (default=true), AND (default=false)
     16.  LOAD (default=false)
     17.  UNLOAD (default=fasle)
   D.  Data Variables
     1.  CN or CONTINUATION (default = '+'):
     2.  CUTOFF (default = 32000):
     3.  DSNAME:
     4.  GLOBAL:
     5.  NESTOVFLO (default = 5):
     6.  PARM:
     7.  PGSIZE (default = 60):
     8.  RC or REFERENCE_CHARACTER (default = '&'):
0
                                   -i-
1IV.__PROGRAMMING_CONSIDERATIONS                                       1
+___  ___________ ______________
   A.  Subroutines                                                     1
   B.  Processing                                                      1
   C.  Future Enhancements                                             1
   D.  Shortcommings                                                   1
0V.__EXAMPLES                                                          1
+__  ________
     1.  Example 1                                                     1
     2.  Example 2                                                     1
     3.  Example 3                                                     1
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-

                                  -ii-
1
                                  MACROS
 _______________________________________________________________________


                             I.__INTRODUCTION
+                            __  ____________
0
      It  seems  that all of the ad hoc requests that I have written wer
 sufficiently different that I could not simply reuse old ones.  Yet  al
 seemed  to  have  had  some  things  in  common.  It became clear that
 mechanism was required that could pull  bits  and  pieces  from  variou
 sources together to satisfy a particular request.  This mechanism had t
 be  very  general  and  flexible  in  nature  since it could potentiall
 accomodate a number of different languages or program products.

      Basically what was needed was  a  program  that  could  dynamicall
 include source code or data into a data set or job stream.  Furthermore
 it  was  desirable to change this included code or place some condition
 on it.

      As it turned  out,  this  program  immediately  showed  promise  i
 providing  a  very  general  tool  with  very  broad applications.  Man
 features were suggested by Dick Heddinger, and I would like  to  expres
 my appreciation.

-
-
-
-
-
-
-
-
-
-

 _______________________________________________________________________

                                   -1-
1
                                  MACROS
 _______________________________________________________________________


                        II.__JOB_CONTROL_LANGUAGE
+                       ___  ___ _______ ________
0
  //MACROS  EXEC PGM=MACROS,REGION=330K,
  // PARM='/RC=''&'',NAME,INTRDR,NEST,PROFILE,PRINT,REWRITE,    +
  //   NOOPNT,CN=''+'',LIST,NONUM,SHORT,AND,OR,WYLFMT,CUTOFF=50'
  //STEPLIB  DD  DISP=SHR,DSN=FEA.LINKLIB
  //SYSPRINT DD  SYSOUT=A
  //SYSOUT   DD  SYSOUT=A,DCB=BLKSIZE=80
  //PDSLIST  DD  SYSOUT=V
  //MACROS   DD  DISP=SHR,DSN=CNaaaa.uuu.ANY.PDSIN  ***LIBRARY***
  //PDSCOPY  DD  DISP=SHR,DSN=CNaaaa.uuu.ANY.PDSOUT ***LIBRARY***
  //INPUT    DD  DISP=SHR,DSN=CNaaaa.uuu.ANY.DSN
  //SYSIN    DD  *
          .
      control statements
          .
  //MEMBERS  DD  *
  member1
  member2

                                  Figure 1.




      A.__EXEC
+     __  ____

      Two  things  should  be  noted.   The  region parameter needs to b
 adjusted depending on the number of records in the members  of  the  PD
 being  processed.   The  user should be aware that the entire member, o
 several members if they are nested, reside in  memory.   Therefore,  th
 more  records  per member, the larger the region parameter must be.  Th
 PARM may be used to set initial values in the program.  Any variable  i
 the program may be changed, but in practice only a few will be addresse
 at  any  one time.  As will be shown later, the user may actually code
 PARM in the input stream to make any subsequent changes as required.  I
 may be helpful at this point to describe  the  coding  convention  used
 First  of  all,  all  variables may be classified as logical or alpha o
 numeric.  In the first case the user simply codes the variable name  an
 the  program  will  assign  a "true" value to the variable.  Conversely
 coding the variable preceded by a "NO" caused the assignment of  "false
 to this variable, as, for example "NOLIST".  For all the other variable
 a  simple  assignment  causes  this  variable  to assume this value; fo
 example, CUTOFF=50 causes the assignment of 50 to the variable cutoff.

      B.__STEPLIB
+     __  _______

      This is the load library for the MACROS program.

0
 _______________________________________________________________________

                                   -2-
1
                                  MACROS
 _______________________________________________________________________


      C.__SYSPRINT
+     __  ________

      This  is a print file used to display control information and erro
 messages.  It can also be used  for  paginated  output  instead  of  th
 sysout file.

      D.__SYSOUT
+     __  ______

      This  file  contains  the stream output of the program.  The outpu
 may be directed to a file for later use,  to  the  printer,  or  to  th
 internal reader.

      E.__MACROS
+     __  ______

      This is the input PDS.  Members referenced in the input stream wil
 come  from  this  PDS.   The program captures the data set name and thi
 name will remain in effect unless changed  by  the  use  of  the  ANYPD
 option  or  by a PARM statement in the input stream.  These options wil
 be explored more fully in chapter III.

      It should be noted  that  the  DCB  attributes  of  this  file  ar
 virtually arbitrary.  The only restriction at this time is that a recor
 not  exceed  6233 characters.  Typically, the PDS may contain card imag
 source code, clists or Superwylbur text, or even data.

      F.__SYSIN
+     __  _____

      This is the input stream to the program.  Statements in this strea
 may  be  categorized  as  two  types.   The  first type has no referenc
 character in  the  first  position;  they  will  simply  be  transmitte
 unchanged  to  the  output stream unless an option has been specified t
 process all or a specific subset of the members of  the  PDS.   In  thi
 case,  the  SYSIN  data  would be considered as control statements.  Th
 second type, one with a control character in the  first  position,  wil
 cause  the  program  to  take  special  action.   The  default referenc
 character ("RC") is the ampersand, but this may by changed in the  PARM
 Normally  a member name follows the RC.  This caused the program to rea
 this member from the PDS, make changes as directed,  and  then  transmi
 this member to the output stream.  So, simply by coding the member name
 the  entire  member  may  be included in the output stream.  The notabl
 exceptions are the &PARM and the &GLOBAL statements.   These  statement
 will be discussed more fully later.

      G.__PDSLIST
+     __  _______

      One fundamental function of the program is to list members of a PD
 in  a  report.   PDSLIST  is a print file displaying the contents of th
 members of the PDS.

-
 _______________________________________________________________________

                                   -3-
1
                                  MACROS
 _______________________________________________________________________


      H.__MEMBERS
+     __  _______

      Some of the functions provided in the program deal with all member
 of  the  PDS.   MEMBERS  on the other hand allows the user to address a
 ordered subset of the members of the PDS.  For example, using MEMBERS i
 conjunction with PDSLIST causes only those members listed in MEMBERS  t
 be printed in the report PDSLIST.

      I.__EDIT
+     __  ____

      Normally  SYSOUT contains the output stream.  But if the user code
 WYLFMT in the PARM, then the output will be directed to the DDName=EDIT
 and    the    file    will    be    a    Superwylbur    file,     (wher
 DCB=(RECFM=U,LRECL=6233,BLKSIZE=6233)).

      J.__PDSCOPY
+     __  _______

      Whenever  this  DDName is coded, the assumption is that the progra
 is to copy members from one PDS to another.  Typically  the  user  woul
 use  this  DDName in conjunction with DDName=MEMBERS and also the GLOBA
 statement to copy selected  members  from  one  PDS  to  another  makin
 "global" changes.  Note that in order to copy all members, the user mus
 specify the PROFILE option.

      K.__INPUT
+     __  _____

      This  DDName is used in conjunction with the LOAD option.  The fil
 is a sequential file that has IEBUPDT-like control records  that  denot
 the beginning of a member.
-
-
-
-
-
-
-
0
 _______________________________________________________________________

                                   -4-
1
                                  MACROS
 _______________________________________________________________________


                         III.__INPUT_FILE_STREAM
+                        ____  _____ ____ ______
0
      A.__Control_Record_Format
+     __  _______ ______ ______

           ×&MEMBER× ×PDSNAME× ×T1=R1× ×,T2=R2× ... ×,S=(Q)×

                             Figure 2.


           ×&MEMBER× CHANGE ×'target'× ×col1××/col2×
                         TO 'REPLACEMENT' ×IN line1××/line2×

                             Figure 3.


      Figure  2  and Figure 3 show the syntax for control cards.  Contro
 cards are records that have a reference  character  (RC)  in  the  firs
 position.   All  other  records  are simply transmitted unchanged to th
 output stream.  The exception occurs when  the  LIST,  PROFILE  or  COP
 options  have  been  specified,  in  which  case  the control record ma
 contain only qualifiers and/or changes that will be applied globally.

      1.__CASE_1:__&PARM="NEW_OR_CHANGED_OPTIONS"
+     __  ____ __  __________ __ _______ ________

      The  user  may  have  a need to change some of the variables in th
 program during the execution of the program.   The  &PARM  causes  thes
 changes  to  be made.  Normally we don't expect a member named parm, bu
 in the event it becomes necessary to process a member named  parm,  the
 the  user  must code NOOPTN in the execute statement of the JCL to allo
 the program to process PARM as a member rather than  a  special  contro
 statement.

      2.__CASE_2:__&GLOBAL_SELECTION_CRITERIA_AND/OR_CHANGES.
+     __  ____ __  _______ _________ ________ ______ ________

      The  GLOBAL  statement  is  read  and  the  options  coded  on thi
 statement are saved for later use.  Specifically, when members of a  PD
 are processed, the options stated in the GLOBAL statement are applied t
 each  member until the GLOBAL statement is changed.  Also as in the PAR
 statement, coding NOOPTN in the JCL causes GLOBAL  to  be  considered
 member of a PDS rather than a special control statement.

      3.__CASE_3:__&MEMBER_PDSNAME_CHANGES,_SELECTION_CRITERIA.
+     __  ____ __  _______ _______ ________ _________ _________

      If  ANYPDS  has  a logical value of "true", then the member will b
 read from the pds name listed in  the  control  card.   Changes  to  th
 member  are  coded as simple assign statements.  To avoid ambiguity, us
 quotes and double quotes.  Similarly, code selection criteria as  assig
 statements  with  the  criteria appearing in parenthesis.  The selectio
 criteria take the following forms.


 _______________________________________________________________________

                                   -5-
1
                                  MACROS
 _______________________________________________________________________


              A) INCLUDE OR EXTRACT
              C) FROM  and/or TO
              C) DELETE OR EXCLUDE


      INC, EXC, EXTR, SEL, DEL are abbreviations that may be used.  LIST
 FIND,  SELECT  and  SEL  are  synomyms  for EXTRACT.  Generally, contro
 records are card images.  For the SYSIN stream however, control  record
 may  be  expanded  to  255  character  records  by coding a Continuatio
 Character as the last nonblank character in the line.  In this way  car
 images may be concatenated.

      4.__CASE_4:__&MEMBER_CHANGE_TARGET_TO_REPLACEMENT
+     __  ____ __  _______ ______ ______ __ ___________

      A member of a PDS gets read into memory.  The change stated in thi
 control  card  is  then  applied.   And the result is transmitted to th
 output file.  The target may consist of a literal, or a column referenc
 or a literal starting with a column reference.   The  replacement  is
 literal.  All this may be restricted by a line reference.


      B.__Selection_Criteria
+     __  _________ ________

      As  a  member  is read into memory, a logical vector is establishe
 that will be used on output to  determine  if  a  particular  record  i
 eligible  for  output or not.  The vector is initialized to logical tru
 for all records unless the selection criteria INCLUDE  or  EXTRACT  hav
 been specified.  A description of each criterion follows.

      1.__INCLUDE:__syntax_INC=(5/80)_or_INCLUDE=(6-66)
+     __  ________  ______ __________ __ ______________

      This  means  that if the line numbers of the records in the curren
 member fall within this range, then these records will be transmitted t
 the output file.

      2.__EXCLUDE:__syntax_EXC=(5-55)_or_EXCLUDE=(5/55)
+     __  ________  ______ __________ __ ______________

      This  is  the  converse of the INCLUDE definition, that is, record
 that fall within this range  will  not  be  transmitted  to  the  outpu
 stream.   Note  that in both of the above cases we are dealing with lin
 numbers.

      3.__EXTRACT:__syntax_SEL=(any_pattern)
+     __  ________  ______ ________ ________

      Each record within the member is searched, and if the given patter
 occurs then this line will be transmitted to the output file.

-
0
 _______________________________________________________________________

                                   -6-
1
                                  MACROS
 _______________________________________________________________________


      4.__DELETE_syntax_DEL=(any_pattern)
+     __  ______ ______ ________ ________

      This  is  the  converse  of the EXTRACT criterion, i.e. all record
 with the pattern will not be transmitted to the output file.   The  las
 two examples dealt with the content of a member.

      5.__FROM/TO:__syntax_FROM=(any_pattern),_TO=(any_pattern)
+     __  ________  ______ _________ _________ _______ ________

      These criteria may be used seperately or together.  All lines prio
 to  the  pattern  specified  by FROM will be ignored, unless there is n
 FROM statement.  And all records after the pattern specified by TO  wil
 be  ignored.  In each case the first match establishes what lines in th
 member are invloved.


      C.__Logical_Variables
+     __  _______ _________


      1.__ANYPDS_(default=false)  When  this  variable  is true, then th
+     __  ______ _______________
 dataset name of the PDS is obtained  from  the  second  operand  of  th
 control  statement.   In  this  way  the  user  may  vary the PDS' bein
 accessed.

      2.__BLANKLINE_(default=true)  Blank  lines  generally are used onl
+     __  _________ ______________
 for readability.  But they waste a lot of memory.  The user  may  ignor
 blank lines on input by coding NOBLANKLINE.

      3.__DTS_(default=false)  When  this  variable is set to true durin
+     __  ___ _______________
 program initialization, then the "date-time-stamp" of the  program  wil
 be  printed.   This  is the date and time this particular version of th
 program was last updated.

      4.__INTRDR_(default=false)  As  noted before, the SYSOUT stream ma
+     __  ______ _______________
 be directed to a printer, a file or the internal reader.  In the  latte
 case this stream must look like a job to the system.

      5.__LIST_or_LISTPDS_(default=false) Using this parameter causes th
+     __  ____ __ _______ _______________
 program  to  produce  a formatted dump of all or selected members of th
 PDS.  This has been coverd earlier under the heading of JCL.

      6.__LONG_(default=true)_and_SHORT_(default=false)  When producing
+     __  ____ ______________ ___ _____ _______________
 PDSLIST, the user has a choice of two formats.  The default format is
 132  character  line,  but  optionally a line may be 80 characters.  Th
 latter is useful in producing rotated listings on a laser printer.

      7.__NAME_(default=false)  When  browsing through the entire PDS, i
+     __  ____ _______________
 is often helpful to indicate which member met  a  given  criterion.   B
 setting  the  NAME option to "true" causes the program to put the membe
 name in columns 73 through 80 in the output stream.  Note that there ma
 be a loss  of  printed  data  in  those  columns  when  this  option  i
 exercised.

 _______________________________________________________________________

                                   -7-
1
                                  MACROS
 _______________________________________________________________________


      8.__NEST_(default=true)  The  main  subrountine  in  the program i
+     __  ____ ______________
 recursive.  This means that as members get processed they  may  in  tur
 invoke other members.  As the program puts the current member out on th
 output stream and recognizes that a nested member needs to be processed
 the  program  suspends processing of the current member until the neste
 member has  been  processed,  then  processing  of  the  current  membe
 continues.   At  times  this  feature is not desirable, as when the LIS
 option is used; then the user simply codes NONEST to  inhibit  recursiv
 processing.

      9.__OPTN_(default=true)  As  noted  earlier,  the  PARM  and GLOBA
+     __  ____ ______________
 control statements have special meanings.  But they could also be membe
 names.  Therefore if these are to be interpreted as  member  names,  th
 user must code NOOPTN.

      10.__NUM_(default=true) When listing a PDS, the user has the optio
+     ___  ___ ______________
 to  display  line  numbers  or  to  omit  them.  If the line numbers ar
 displayed, then they will appear  in  the  first  10  positions  of  th
 listing.

      11.__PRINT_(default=false)  Normally  the output stream will appea
+     ___  _____ _______________
 in the DDName=SYSOUT file.  By coding the PRINT option, the output  wil
 appear in the DDName=SYSPRINT file.  Also the output will be appear on
 new page when a new member gets processed.

      12.__PROFILE_(default=false) In many instances the user may want t
+     ___  _______ _______________
 process  all  or  a given subset of all the members.  The PROFILE optio
 causes all members to  be  processed.   Using  the  DDName=MEMBERS  fil
 causes  the PROFILE parameter to set to true, and in fact if all member
 are listed in this file, then this is identical to the PROFILE option.

      13.__RENUM_(default=false)  Normally  Superwylbur  datasets  retai
+     ___  _____ _______________
 their line numbers.  But the user may  want  to  renumber  the  dataset
 Renumbering occurs as the dataset is being read.

      14.__WYLFMT_(default=false)  The output stream may be a Superwylbu
+     ___  ______ _______________
 file.  The user must code WYLFMT and the output file will be witten ont
 DDName=EDIT, unless PDSCOPY was specified.

      15.__OR_(default=true),_AND_(default=false)  It should be mentione
+     ___  __ _______________ ___ _______________
 that the user may browse through the PDS searching  for  some  specifie
 information.   In  doing  so  the  PROFILE  option  would  be  used  (o
 DDName=MEMBERS),  and  the  selection   criteria   would   specify   th
 information  sought.   By  convention  all  criteria on the same contro
 record are "ORed".  Normally, criteria on seperate control  records  ar
 also "ORed" unless the AND option is set to true.  In this case criteri
 on seperate lines are "ANDed".

-

 _______________________________________________________________________

                                   -8-
1
                                  MACROS
 _______________________________________________________________________


      16.__LOAD_(default=false) This option allows the user to load a PD
+     ___  ____ _______________
 from a sequential file.  It is assumed that each member is preceded by
 IEBUPDT  control  record (e.g. ./ ADD NAME=member).  The output pds wil
 be defined by the DDName=PDSCOPY.  The dataset attributes of the  outpu
 will be defined in the JCL.

      17.__UNLOAD_(default=fasle)  This  is  the  converse  of  the  LOA
+     ___  ______ _______________
 option.  The PDS defined by the DDName=MACROS will be  unloaded  onto
 sequential  file  defined  by  the  DDName=SYSOUT.   Each member will b
 preceded by a control IEBUPDT-like control record.


      D.__Data_Variables
+     __  ____ _________

      1.__CN_or_CONTINUATION_(default_=_'+'):   When  this  character  i
+     __  __ __ ____________ ________ _ _____
 coded as the last character on a control card in the SYSIN input stream
 then the program will interpret this to mean that there is more  contro
 information on the next record.

      2.__CUTOFF_(default_=_32000):  The  user  may  want to restrict th
+     __  ______ ________ _ _______
 number of records to be read as a member gets processed.  When the valu
 assigned to CUTOFF is exceeded, the reading routine is terminated.

      3.__DSNAME:  This  variable  contains  the  dataset name of the PD
+     __  _______
 currently being associated with the DDName=MACROS.

      4.__GLOBAL:   This   variable  may  contain  changes  or  selectio
+     __  _______
 criteria.   Then  as  each  member  gets  processed,  this  string  get
 concatenated to each control record.

      5.__NESTOVFLO_(default_=_5):  As  explained earlier, members may b
+     __  _________ ________ _ ___
 nested.  But if the level of nesting exceeds the NESTOVFLO  value,  the
 the  program will terminate with an error.  This will prevent accidenta
 infinite nesting.

      6.__PARM:  This  variable  contains  the parameters under which th
+     __  _____
 program is currently executing.

      7.__PGSIZE_(default_=_60):  When listing a PDS the user can contro
+     __  ______ ________ _ ____
 how many lines will be printed per page.

      8.__RC_or_REFERENCE_CHARACTER_(default_=_'&'):  This character whe
+     __  __ __ ___________________ ________ _ _____
 coded in coulumn 1 of the input stream implies that this  is  a  contro
 record.


-
-
 _______________________________________________________________________

                                   -9-
1
                                  MACROS
 _______________________________________________________________________


                     IV.__PROGRAMMING_CONSIDERATIONS
+                    ___  ___________ ______________
0
      A.__Subroutines
+     __  ___________

      The  main  program  is  written in PL/1.  It calls two subroutines
 These routines are DDINFO and SVC99.  The DDINFO routine is used  merel
 to  get  JFCB  information  of the PDS when DDName=PDSCOPY is used.  Th
 program needs this information in order to properly  format  to  output
 The  SVC99  routine  dynamically  alloctes  and  de-allocates  files an
 members of PDS' as necessary.  SVC99 is also known as  "DYNAM"  and  wa
 obtained from the SHARE CBT tape.


      B.__Processing
+     __  __________

      During   the  initialization  step  some  minimal  editing  of  th
 parameter is performed.  For example the INTRDR variable is set to fals
 when DDName=PDSCOPY has been coded.

      The program has four fundamental processing sections.  These are t
 list the PDS, process all  members  of  the  PDS,  load  a  PDS  from
 sequential  file,  or to process an input stream that may contain one o
 more control records.  Whenever a member of a PDS needs to be processed
 then a recursive routine is entered.   The  member  gets  allocated  an
 opened.  The reading routine builds a list that contains the line numbe
 and  the text.  The text may be from zero to 255 characters long.  Afte
 the list has been built, the program applies the changes.   Then  a  bi
 vector  is  modified  to  reflect  what  has been coded in the selectio
 criteria.  At this point the program proceeds to put the list out  base
 on  the  current processing parameters.  If a control record is detecte
 in the output stream then the main subroutine is called recursively.


      C.__Future_Enhancements
+     __  ______ ____________

      It     is    recognized    that    the    current    practice    o
 allocating-opening-closing-deallocating members  is  sinfully  wasteful
 It  was originally felt that in order to provide absolute flexibility o
 processing various PDS' that this was acceptable.  But  in  practice  i
 was  found  that  the  need to address multiple PDS' was not that great
 So, clearly one of the future  enhancements  will  be  to  replace  thi
 mechanism  with  one  native  to processing PDS', i.e. a procedure whic
 would allocate and open a PDS only once irregardless of how many member
 are accessed.

      Building a double linked list would also be a better  technique  t
 store  the  data.   The  logical  bit  matrix  could  be eliminated if
 stronger alogorithm would be written to apply all changes and  selectio
 criteria in one pass, or the order of processing could be changed.
0
 _______________________________________________________________________

                                   -10-
1
                                  MACROS
 _______________________________________________________________________


      D.__Shortcommings
+     __  _____________

      The  user should be aware that this program does very little synta
 checking of control cards.  Also there  are  very  few  error  messages
 Where  alternatives existed, a complete set of alternatives was coded i
 the program.  This means that the program will most likely execute,  bu
 the  results  may  not  be what was intended whenever a control card ha
 been miscoded.

      Some routines such as the parsing routine  could  have  been  code
 more  efficiently using the translate instruction.  Some of the code wa
 borrowed from older programs and should really have been rewritten.

      The program could also  be  written  to  optionally  produce  smal
 temporary  files  instead of buidling lists in memory.  Some members ca
 contain lengthy text and will require quite a bit of memory.


-
-
-
-
-
-
-
-
-
-
-

 _______________________________________________________________________

                                   -11-
1
                                  MACROS
 _______________________________________________________________________


                               V.__EXAMPLES
+                              __  ________
0
      1.__Example_1
+     __  _______ _

      Problem:

      In trying to put together a publication we are required to assembl
 text  and tables for several chapters.  Furthermore we need to integrat
 EPIC/JANUS code, text and and tables references into one stream.

      Solution:

      As with any sizable problem, we attempt to make little problems ou
 of one big one.  In other words let's have various people  work  on  th
 text  of  the  individual chapters of the publication.  And each chapte
 will be put into a member of a PDS.  The text for each chapter will als
 contain  the  proper  EPIC/JANUS  code  including  any  imbedded   tabl
 references.   Then  ultimately  what  is  required  is to code the fron
 matter EPIC code and concatenate the text for all  the  chapters.   Thi
 chaining can be handled readily using the MACROS program.

      A typical JCL stream may look like this:


 //HB2UJNS JOB (6529,FOR,,99),EIA6,TIME=(,05)
 //MACROS  EXEC PGM=MACROS,REGION=500K
 //STEPLIB  DD  DISP=SHR,DSN=FEA.LINKLIB
 //SYSPRINT DD  SYSOUT=A
 //MACROS   DD  DISP=SHR,DSN=CN6533.PRJ.EIA6.TEXT
 //SYSIN    DD  *
 <START/DUPLEX VERTJUST DOCUMENT='Coal Distribution'
 <FRT/
 <TIP/
 <NUM/DOE/EIA-0125(84/2Q)
 <DIST/DISTRIBUTION CATEGORY UC-98
 <TI/Coal Distribution
 <TI/January-June
 <TI/1984
 <LOGO IMAGE='MYSYM'/
 <PDATE/Published:
 <PDATE/October 1984
 <PUB/Energy Information Administration
 <ADD/Washington  D.C.

 <BODY/
 &CURRENT
 <backmatter/
 &TEXT
 &GLOSSARY
0
 _______________________________________________________________________

                                   -12-
1
                                  MACROS
 _______________________________________________________________________


 <TBL  ID='T1'        IMAGE='T1'/
 <TBL  ID='T2'        IMAGE='T2'/
 <TBL  ID='T3'        IMAGE='T3'/
 <TBL  ID='T4'        IMAGE='T4'/
 <TBL  ID='T5'        IMAGE='T5'/
 <TBL  ID='T6'        IMAGE='T6'/
 <TBL  ID='T6000P02'  IMAGE='T6000P02'/
 <END/
 //SYSOUT DD DCB=(RECFM=FB,LRECL=080,BLKSIZE=6160),
 // UNIT=DASD,SPACE=(TRK,(10,10),RLSE),DISP=(,CATLG),
 // DSN=CN6529.HB2.EPIC.D850103.T145247
 //SYSOUT DD SYSOUT=A,DCB=BLKSIZE=80
 //*  ------------------------------------------------------------
 /*OUTPUT BAT1 DEST=EIAVM.BT1B540
 /*OUTPUT BAT2 DEST=EIAVM.BT2B540
 /*OUTPUT BAT3 DEST=EIAVM.BT3B540
 /*OUTPUT BAT4 DEST=EIAVM.BT4B540
 /*OUTPUT BAT5 DEST=EIAVM.BT5B540
 /*OUTPUT BAT6 DEST=EIAVM.BT6B540
 //STEP1   EXEC PGM=EPP0COMP,REGION=1280K,TIME=(00,22)
 //STEPLIB  DD  DSN=CNB540.PRJ.EPIC.V0.LOADLIB,DISP=SHR
 //SYSPRINT DD  SYSOUT=*
 //REGISTER DD  DSN=CNC540.PRJ.EPIC.REG.V0.DATABASE,DISP=SHR
 //MSGFILE  DD  SYSOUT=*
 //FT06F001 DD  SYSOUT=*
 //DEBUG    DD  DUMMY
 //DEBUGEX  DD  DUMMY
 //DEBUGCP  DD  DUMMY
 //SYSIN    DD  DUMMY
 //OUTPUT   DD  SYSOUT=*
 //BADCD    DD  SYSOUT=*
 //BAT1     DD  SYSOUT=(B,,BAT1),DCB=(RECFM=FB,LRECL=80,BLKSIZE=80)
 //BAT2     DD  SYSOUT=(B,,BAT2),DCB=(RECFM=FB,LRECL=80,BLKSIZE=80)
 //BAT3     DD  SYSOUT=(B,,BAT3),DCB=(RECFM=FB,LRECL=80,BLKSIZE=80)
 //BAT4     DD  SYSOUT=(B,,BAT4),DCB=(RECFM=FB,LRECL=80,BLKSIZE=80)
 //BAT5     DD  SYSOUT=(B,,BAT5),DCB=(RECFM=FB,LRECL=80,BLKSIZE=80)
 //BAT6     DD  SYSOUT=(B,,BAT6),DCB=(RECFM=FB,LRECL=80,BLKSIZE=80)
 //CODES    DD  DSN=CNB540.PRJ.EPIC.CODES.V0.DATA,DISP=SHR
 //ONPUT    DD  DSN=CNB540.PRJ.EPIC.SYN.V0.DATABASE(PUBDOC),DISP=SHR
 //BUFFILE  DD  DSN=&&BUFFILE,DISP=(,DELETE),UNIT=SYSDA,
 //  SPACE=(CYL,(1,1)),DCB=(RECFM=FB,LRECL=130,BLKSIZE=5200)
 //*  ------------------------------------------------------------
 //*
 //*  NOTE  PN EIA6 - MEANS GET IMAGE FROM REGISTERED DATASET
 //*        PN AAAAA - MEANS IMAGE DATASETS ARE IN STREAM
 //*
 //*  ------------------------------------------------------------
 //INPUT    DD  *
 EU HB26529
 PN AAAAA
0
 _______________________________________________________________________

                                   -13-
1
                                  MACROS
 _______________________________________________________________________


 GN 000
 PF PROOF
 FO 4250
 IN
 TR
 DS CN6529.HB2.EPIC.D850103.T145247
 ID CN6529.HB2.JANGRAPH.EIA6(T6)
 ID CN6529.HB2.JANGRAPH.EIA6(T6000P02)
 /*
 //EIATEXT DD DISP=SHR,DSN=CN6529.HB2.EPIC.D850103.T145247
 //*  ------------------------------------------------------------
 //SCR  EXEC  PGM=SCRATCH,COND=EVEN,
 //   PARM='CN6529.HB2.EPIC.D850103.T145247'
 //STEPLIB  DD  DSN=FEA.LINKLIB,DISP=SHR
 //SYSPRINT DD  SYSOUT=A

      Notes:   Only  a  few table references were coded.  Generally ther
 would be a bunch.  "TEXT" is a member of the PDS that in  fact  contain
 control  records  for the chapters to be included in the final text.  I
 this way this JCL stream remains constant.  The order in which the  tex
 is  assembled  is controlled simply by listing the members of the PDS i
 the member named "TEXT" as control statements.


      2.__Example_2
+     __  _______ _

      This  example  shows  two ways to copy some members from one PDS t
 another and at the same time modifying these members.

 //HB2UCOPY JOB (6529,FOR,,22,,,1),'PDSCOPY',TIME=(0,07)
 //MACROS  EXEC PGM=MACROS,REGION=500K,PARM='/WYLFMT'
 //STEPLIB  DD  DISP=SHR,DSN=CN6529.HB2.LOADLIB
 //SYSPRINT DD  SYSOUT=A
 //MACROS   DD  DISP=SHR,DSN=CN6529.PRJ.EIA7A.MACRO.LIB
 //PDSCOPY  DD  DSN=CN6529.PRJ.EIA7A.MACROS,
 //  DCB=(DSORG=PO,RECFM=U,LRECL=6233,BLKSIZE=6233),
 //  UNIT=DASD,SPACE=(TRK,(10,5,5),RLSE),DISP=(,CATLG,DELETE)
 //SYSIN    DD  *              COPY SELECTED MEMBERS W/CHANGES
 &GLOBAL  'MACRO.LIB'='MACROS', 'HB2'='PRJ'
 &EIA7A
 &EDITUPD



 //HB2U1441 JOB (6529,FOR,,22,,,1),'04/06/84',TIME=(0,5)
 //MACROS  EXEC PGM=MACROS,REGION=800K,PARM='/NONEST'
 //STEPLIB  DD  DISP=SHR,DSN=CN6529.HB2.LOADLIB
 //SYSPRINT DD  SYSOUT=A
 //SYSOUT   DD  SYSOUT=V,DCB=BLKSIZE=80
 //MACROS   DD  DISP=SHR,DSN=CN6529.BE1.EIA6DE.SOURCE.PL1
0
 _______________________________________________________________________

                                   -14-
1
                                  MACROS
 _______________________________________________________________________


 //PDSCOPY  DD  DISP=SHR,DSN=CN6533.PRJ.SOURCE.COBOL
 //MEMBERS  DD *
 PROD0406
 EIA7SFSE
 EIA7AFSE
 //SYSIN    DD  *
 'BE1'='HB2', 'EDIT.'='EIAPROCO.', 'USER'="'PRJ'"


      3.__Example_3
+     __  _______ _

      This  example  shows a frequent use of the MACROS program, and tha
 is to search for lines that contain a given string.  Here we display th
 line and the member name.

  //uuuU0728 JOB (aaaa,FOR,,22,,,1),'SEARCH',TIME=(0,5)
  //MACROS  EXEC PGM=MACROS,REGION=900K,
  //  PARM='/NONEST,PROFILE,NAME'
  //STEPLIB  DD  DISP=SHR,DSN=FEA.LINKLIB
  //SYSPRINT DD  SYSOUT=A
  //PDSLIST  DD  SYSOUT=A  (J,,71)
  //SYSOUT   DD  SYSOUT=A,DCB=BLKSIZE=80
  //MACROS   DD  DISP=SHR,DSN=CNaaaa.uuu.test.pds   ***LIBRARY***
  //SYSIN DD *
 LIST=(EXEC)
 LIST=(STEPLIB)



-
-
-
-
-
-
-
0
 _______________________________________________________________________

                                   -15-
1
                                  MACROS
 _______________________________________________________________________


      MORE EXAMPLES

        EXAMPLE:

        This example demonstrated how the MACROS program can be used
        to "resolve" parts of a jobstream. This is particularly useful
        for lengthy tables such as a county table.  The function of
        MACROS in this case is similar to the copy verb in Cobol.


        //uuuU JOB (aaaa,FOR,,22,,,1),'EXAMPLE1',TIME=(0,3),MSGCLASS=X
        //*                                                MEMBER: AH133
        //MACROS  EXEC PGM=MACROS,REGION=330K,PARM='/INTRDR'
        //STEPLIB  DD  DISP=SHR,DSN=FEA.LINKLIB
        //SYSPRINT DD  SYSOUT=A
        //SYSOUT   DD  SYSOUT=A,DCB=BLKSIZE=80
        //MACROS   DD  DISP=SHR,DSN=CNaaaa.uuu.ANY.PDS   ***LIBRARY***
        //SYSIN DD *
        &JOBCARDX      USER=uuu, ACCOUNT=aaaa, ZEIT=',12'
        &REQUEST       <C>=CB51,<P>=CNaaaa.PRJ,<D>=CNaaaa.uuu.EXTR.DATA5
        USE CB51;
        SELECT IF STATE = 470
               AND (BED=265 OR BED=286 OR BED=295 OR BED=326);
        DEFINE YR 'YEAR' ON YEAR;
          '1974' IF 74; '1975' IF 75; '1976' IF 76;
          '1977' IF 77; '1978' IF 78; '1979' IF 79; '1980' IF 80;
        DEFINE BEDNAME ON BED;
           'MORGAN SPRINGS' IF 265;
           'SEWANEE'        IF 286;
           'RICHLAND'       IF 295;
           'NELSON'         IF 326;
        DEFINE CNTY ON COUNTY;
        &COUNTIES   FIND=(470), '/BOLD'=''

        COMPUTE PRODUCTION= CAPTIVE_PRODUCTION + OPEN_MARKET_PRODUCTION;
        COMPUTE VALUE     = CAPTIVE_VALUE      + OPEN_MARKET_VALUE;
        COMPUTE PRODUCT   = VALUE * PRODUCTION;
        COMPUTE TON     ON PRODUCT; PRODUCTION IF > 0;NULL IF OTHER;
        COMPUTE DOLLARS ON PRODUCT; VALUE      IF > 0;NULL IF OTHER;
        POSTCOMPUTE AVG   USING $999.99 = DOLLARS/TON
                SHIFTING OUTPUT DECIMAL LEFT BY 2;
        COMPUTE FOB = DOLLARS/TON;
        POSTCOMPUTE LO USING $999.99 = MIN(FOB);
        POSTCOMPUTE HI USING $999.99 = MAX(FOB);
        POSTCOMPUTE PCT 'PERCENT COVERAGE' USING 999.9 =
          (100*TON)/PRODUCTION SHIFTING OUTPUT DECIMAL LEFT BY 1;

        @<TABLE>@

        TABLE ONE CENTER
        'F.O.B. MINE PRICES IN TENNESSEE':

 _______________________________________________________________________

                                   -16-
1
                                  MACROS
 _______________________________________________________________________


          YR, CNTY BY (BEDNAME THEN TOTAL) THEN TOTAL BY BEDNAME,
              LO THEN HI THEN AVG THEN PCT;

        &REQUEST       <C>=CB51,<P>=CNaaaa.PRJ,<D>=CNaaaa.uuu.EXTR.DATA5
        USE CB51;
        SELECT IF STATE = 560
        &AH13368  FROM=(DEFINE YR),TO=(<TABLE>), "470" = "560"
        TABLE TWO CENTER
        'F.O.B. MINE PRICES IN WYOMING':
          YR, CNTY THEN TOTAL,
             LO THEN HI THEN AVG THEN PCT;

-
        The above job submitted the following job:


        //uuuUTPL JOB (aaaa,FOR,,22,,,1),'T P L',TIME=(,12),MSGCLASS=X
        /*ROUTE PRINT  REMOTE13
        /*PHOLD
        //REQ  EXEC TPLGENTB,CBN=CB51,CBPREFX='CNaaaa.PRJ', LISTING=X,
        // DATA='CNaaaa.uuu.EXTR.DATA51'
        //TPL.REQUEST  DD *
        USE CB51;
        SELECT IF STATE = 470
               AND (BED=265 OR BED=286 OR BED=295 OR BED=326);
        DEFINE YR 'YEAR' ON YEAR;
          '1974' IF 74; '1975' IF 75; '1976' IF 76;
          '1977' IF 77; '1978' IF 78; '1979' IF 79; '1980' IF 80;
        DEFINE BEDNAME ON BED;
           'MORGAN SPRINGS' IF 265;
           'SEWANEE'        IF 286;
           'RICHLAND'       IF 295;
           'NELSON'         IF 326;
        DEFINE CNTY ON COUNTY;
                 'TENNESSEE'               IF  470000;
                 'ANDERSON'                IF  470001;
                 'BLEDSOE'                 IF  470007;
                 'CAMPBELL'                IF  470013;
                 'CLAIBORNE'               IF  470025;
                 'CUMBERLAND'              IF  470035;
                 'FENTRESS'                IF  470049;
                 'GRAINGER'                IF  470057;
                 'GRUNDY'                  IF  470061;
                 'HAMILTON'                IF  470065;
                 'MARION'                  IF  470115;
                 'MORGAN'                  IF  470129;
                 'OVERTON'                 IF  470133;
                 'PICKETT'                 IF  470137;
0
 _______________________________________________________________________

                                   -17-
1
                                  MACROS
 _______________________________________________________________________


                 'PUTNAM'                  IF  470141;
                 'RHEA'                    IF  470143;
                 'ROANE'                   IF  470145;
                 'SCOTT'                   IF  470151;
                 'SEQUATCHIE'              IF  470153;
                 'VAN BUREN'               IF  470175;
                 'WHITE'                   IF  470185;

        COMPUTE PRODUCTION= CAPTIVE_PRODUCTION + OPEN_MARKET_PRODUCTION;
        COMPUTE VALUE     = CAPTIVE_VALUE      + OPEN_MARKET_VALUE;
        COMPUTE PRODUCT   = VALUE * PRODUCTION;
        COMPUTE TON     ON PRODUCT; PRODUCTION IF > 0;NULL IF OTHER;
        COMPUTE DOLLARS ON PRODUCT; VALUE      IF > 0;NULL IF OTHER;
        POSTCOMPUTE AVG   USING $999.99 = DOLLARS/TON
                SHIFTING OUTPUT DECIMAL LEFT BY 2;
        COMPUTE FOB = DOLLARS/TON;
        POSTCOMPUTE LO USING $999.99 = MIN(FOB);
        POSTCOMPUTE HI USING $999.99 = MAX(FOB);
        POSTCOMPUTE PCT 'PERCENT COVERAGE' USING 999.9 =
          (100*TON)/PRODUCTION SHIFTING OUTPUT DECIMAL LEFT BY 1;

        @<TABLE>@

        TABLE ONE CENTER
        'F.O.B. MINE PRICES IN TENNESSEE':
          YR, CNTY BY (BEDNAME THEN TOTAL) THEN TOTAL BY BEDNAME,
              LO THEN HI THEN AVG THEN PCT;

        //REQ  EXEC TPLGENTB,CBN=CB51,CBPREFX='CNaaaa.PRJ', LISTING=X,
        // DATA='CNaaaa.uuu.EXTR.DATA51'
        //TPL.REQUEST  DD *
        USE CB51;
        SELECT IF STATE = 560
        DEFINE YR 'YEAR' ON YEAR;
          '1974' IF 74; '1975' IF 75; '1976' IF 76;
          '1977' IF 77; '1978' IF 78; '1979' IF 79; '1980' IF 80;
        DEFINE BEDNAME ON BED;
           'MORGAN SPRINGS' IF 265;
           'SEWANEE'        IF 286;
           'RICHLAND'       IF 295;
           'NELSON'         IF 326;
        DEFINE CNTY ON COUNTY;
                 'WYOMING'                 IF  560000;
                 'ALBANY'                  IF  560001;
                 'BIG HORN'                IF  560003;
                 'CAMPBELL'                IF  560005;
                 'CARBON'                  IF  560007;
                 'CONVERSE'                IF  560009;
                 'CROOK'                   IF  560011;
                 'FREMONT'                 IF  560013;
0
 _______________________________________________________________________

                                   -18-
1
                                  MACROS
 _______________________________________________________________________


                 'GOSHEN'                  IF  560015;
                 'HOT SPRINGS'             IF  560017;
                 'JOHNSON'                 IF  560019;
                 'LINCOLN'                 IF  560023;
                 'NATRONA'                 IF  560025;
                 'PARK'                    IF  560029;
                 'SHERIDAN'                IF  560033;
                 'SUBLETTE'                IF  560035;
                 'SWEETWATER'              IF  560037;
                 'TETON'                   IF  560039;
                 'UINTA'                   IF  560041;
                 'WASHAKIE'                IF  560043;
                 'WESTON'                  IF  560045;

        COMPUTE PRODUCTION= CAPTIVE_PRODUCTION + OPEN_MARKET_PRODUCTION;
        COMPUTE VALUE     = CAPTIVE_VALUE      + OPEN_MARKET_VALUE;
        COMPUTE PRODUCT   = VALUE * PRODUCTION;
        COMPUTE TON     ON PRODUCT; PRODUCTION IF > 0;NULL IF OTHER;
        COMPUTE DOLLARS ON PRODUCT; VALUE      IF > 0;NULL IF OTHER;
        POSTCOMPUTE AVG   USING $999.99 = DOLLARS/TON
                SHIFTING OUTPUT DECIMAL LEFT BY 2;
        COMPUTE FOB = DOLLARS/TON;
        POSTCOMPUTE LO USING $999.99 = MIN(FOB);
        POSTCOMPUTE HI USING $999.99 = MAX(FOB);
        POSTCOMPUTE PCT 'PERCENT COVERAGE' USING 999.9 =
          (100*TON)/PRODUCTION SHIFTING OUTPUT DECIMAL LEFT BY 1;

        @<TABLE>@
        TABLE TWO CENTER
        'F.O.B. MINE PRICES IN WYOMING':
          YR, CNTY THEN TOTAL,
             LO THEN HI THEN AVG THEN PCT;

-
-
-
-
-
-

 _______________________________________________________________________

                                   -19-
1
                                  MACROS
 _______________________________________________________________________


        EXAMPLE:

        In the following example all members of the pds are processed,
        and all lines that have the following pattern will be listed:

        all lines that have "OR" or "ANY" and "AND" ie ('OR' × 'ANY') &

        //uuuU0728 JOB (aaaa,FOR,,22,,,1),'EXAMLE2',TIME=(0,1)
        //MACROS  EXEC PGM=MACROS,REGION=900K,
        //  PARM='/NONEST,PROFILE,NAME'
        //STEPLIB  DD  DISP=SHR,DSN=FEA.LINKLIB
        //SYSPRINT DD  SYSOUT=A
        //PDSLIST  DD  SYSOUT=A  (J,,71)
        //SYSOUT   DD  SYSOUT=A,DCB=BLKSIZE=80
        //MACROS   DD  DISP=SHR,DSN=CNaaaa.uuu.test.pds   ***LIBRARY***
        //SYSIN DD *
        LIST=(OR),LIST=(ANY)
        LIST=(AND)

-
-
-
0       EXAMPLE:

        The MACROS program can be uses to list PDS'.  This program will
        CLIST libraries as well as SUPERWYLBUR libraries.

        //uuuULIST JOB (aaaa,FOR,,22,,,1),'EXAMPLE3',TIME=(0,21)
        //MACROS  EXEC PGM=MACROS,REGION=900K,
        //  PARM='/LIST,NONUM,SHORT'
        //STEPLIB  DD  DISP=SHR,DSN=FEA.LINKLIB
        //SYSPRINT DD  SYSOUT=A
        //SYSOUT   DD  SYSOUT=A,DCB=BLKSIZE=80
        //MACROS   DD  DISP=SHR,DSN=CNaaaa.uuu.TESTRUN    ***LIBRARY***
        //PDSLIST  DD  SYSOUT=V
        //SYSIN    DD  *

-
-
0
 _______________________________________________________________________

                                   -20-
1
                                  MACROS
 _______________________________________________________________________


        EXAMPLE:

        In this example only lines having the literal "COMPUTE" or "TABL
        will be selected, but if the line has the literal "POST" or "VAL
        then it will be rejected.

        //uuuUQCR JOB (aaaa,FOR,,3),'EXAMPLE4',TIME=(,2)
        //MACROS  EXEC PGM=MACROS,REGION=200K    PARM='/INTRDR'
        //STEPLIB  DD  DISP=SHR,DSN=FEA.LINKLIB
        //SYSPRINT DD  SYSOUT=A
        //SYSOUT   DD  SYSOUT=A,DCB=BLKSIZE=80
        //MACROS   DD  DISP=SHR,DSN=CNaaaa.PRJ.QCR.TPL.PDS ***LIBRARY***
        //SYSIN DD DATA,DLM='./'
        &SPCLTPL  SEL=(COMPUTE),SEL=(TABLE),DEL=(VALUE),DEL=(POST)

-
-
-
-
-       EXAMPLE:

        Note that the last three lines form one instruction.
        The default continuation character is "+", and it is the last
        non-blank character in the continued lines.

        //uuuU1326 JOB (aaaa,FOR,,22,,,1),'EXAMPLE5',TIME=(0,1)
        //MACROS  EXEC PGM=MACROS,REGION=900K,PARM='/NEST'
        //STEPLIB  DD  DISP=SHR,DSN=FEA.LINKLIB
        //SYSPRINT DD  SYSOUT=A
        //SYSOUT   DD  SYSOUT=A,DCB=BLKSIZE=80
        //MACROS   DD  DISP=SHR,DSN=CNaaaa.PRJ.WCP.PDS    ***LIBRARY***
        //PDSLIST  DD  SYSOUT=A  (J,,71)
        //SYSIN    DD  DATA,DLM='./'
        &TPL1TO3  <CWS>=%CWS,<CWE>=%CWE,<CWEL>=%CWEL,<PWS>=%PWS,<PWE>=%P
             <PWEL>=%PWEL,<LYWS>=%LYWS,<LYWE>=%LYWE,<LYWEL>=%LYWEL,    +
             <TYE>=%TYE,<TYEL>=%TYEL,<LYE>=%LYE,<LYEL>=%LYEL

-
0
 _______________________________________________________________________

                                   -21-
1
                                  MACROS
 _______________________________________________________________________


        EXAMPLE:

        Suppose we need to extract data from several members that
        belong to different PDS'.

        //uuuU0918 JOB (aaaa,FOR,,22,,,1),'EXAMPLE6',TIME=(0,2)
        //MACROS  EXEC PGM=MACROS,REGION=200K,PARM='/NAME'
        //STEPLIB  DD  DISP=SHR,DSN=FEA.LINKLIB
        //SYSPRINT DD  SYSOUT=A
        //SYSOUT   DD  SYSOUT=V,DCB=BLKSIZE=80
        //MACROS   DD  DISP=OLD,DSN=CNaaaa.uuu.TPL.CBX
        //PDSLIST  DD  SYSOUT=V  (J,,71)
        //SYSIN    DD  DATA,DLM='./'
        &HTM  INC=(1/10)
        &PARM="NONEST,NONAME,ANYPDS"
        &DSASM  CNaaaa.uuu.WYLIB
        &INDEX CNaaaa.uuu.MACROS  INC=(1/11)

-
-
-
-       EXAMPLE:

        Here is an example of how to use the GLOBAL variable.
        Note that the GLOBAL variable cannot occurr within nested
        invocations.


        //uuuUMAC JOB (aaaa,FOR,,22,,,1),EXAMPLE7,TIME=(0,2),MSGCLASS=X
        //MACROS  EXEC PGM=MACROS,REGION=200K
        //STEPLIB  DD  DISP=SHR,DSN=FEA.LINKLIB
        //SYSPRINT DD  SYSOUT=A
        //SYSOUT   DD  SYSOUT=V,DCB=BLKSIZE=80
        //MACROS   DD  DISP=SHR,DSN=CNaaaa.uuu.HTM.PDS
        //SYSIN    DD  DATA,DLM='./'
        //uuuUVII  JOB (aaaa,FOR,,20,,,1),'EXAMPLE7',TIME=(0,21)
        &PARM= "NONAME, RC='#'"
        #GLOBAL   DEL=(DD)
        #DTS INC=(3/99)
        #GLOBAL
        #DTS
        #GLOBAL  'D'=''
        #DTS     ' '=''

 _______________________________________________________________________

                                   -22-
1
                                  MACROS
 _______________________________________________________________________


        EXAMPLE:

        Put the "PDSLIST" output into a temporary dataset, and the
        produce rotated output.


        //uuuULIST JOB (aaaa,FOR,,22),'PDSLLIST',TIME=(0,7),MSGCLASS=X
        /*JOBPARM LINECNT=90
        //MACROS  EXEC PGM=MACROS,REGION=400K,PARM='/LIST,NUM,SHORT'
        //STEPLIB  DD  DISP=SHR,DSN=FEA.LINKLIB
        //SYSPRINT DD  SYSOUT=A
        //SYSOUT   DD  SYSOUT=V,DCB=BLKSIZE=80
        //MACROS   DD  DISP=SHR,DSN=CNaaaa.uuu.WYLIB
        //PDSLIST  DD  UNIT=SYSDA,DISP=(NEW,PASS),
        //  SPACE=(CYL,(1,1)),DCB=(RECFM=FB,LRECL=81,BLKSIZE=6156),
        //  DSN=&&LIST
        //SYSIN    DD  *
        //JS10   EXEC ROT12,LIB='&LIST',FLASH=
        //DATAIN   DD DISP=(OLD,DELETE,DELETE)
        //PRINT38  DD COPIES=01,DCB=(LRECL=129,BLKSIZE=129,RECFM=FM)
        //PARMIN   DD *
                  089064090            D           A
-
-
0       EXAMPLE:

        Using the ddname MEMBERS allows the user to address an
        arbitrary subset of all members in a convenient way.

  //HB2ULIST JOB (6529,FOR,,22),'PDSLLIST',TIME=(0,2)
  //MACROS  EXEC PGM=MACROS,REGION=400K,PARM='/LIST,NUM,SHORT'
  //STEPLIB  DD  DISP=SHR,DSN=CN6529.HB2.LOADLIB
  //SYSPRINT DD  SYSOUT=A
  //SYSOUT   DD  SYSOUT=V,DCB=BLKSIZE=80
  //MACROS   DD  DISP=SHR,DSN=CN6529.HB2.MISC.PDS
  //PDSLIST  DD  SYSOUT=V
  //MEMBERS  DD *  THIS IS A SUBSET OF ALL MEMBERS IN ANY ORDER
  INDEX
  DSKUTIL
  DATA

-
-
 _______________________________________________________________________

                                   -23-

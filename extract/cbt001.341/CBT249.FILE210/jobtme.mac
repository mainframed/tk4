 /*            JOB TIMING ANALYSIS  PROGRAM                           */
  JOBTME:            %INCLUDE(DRIVER);
 DECLARE XJOBN(50)  FIXED BINARY(31,0) INIT((50)0) STATIC;
 DECLARE XJOB1(50)  FIXED BINARY(31,0) INIT((50)0) STATIC;
     DECLARE XNAME(50) CHAR(8) INIT((50)'        ');
 DECLARE XJOB2(50)  FIXED BINARY(31,0) INIT((50)0) STATIC;
 DECLARE XJOB3(50)  FIXED BINARY(31,0) INIT((50)0) STATIC;
 DECLARE (XX,T1,T2,T3) FIXED BINARY(31,0) INIT(0) STATIC;
 DECLARE (PT1,PT2,PT3) PICTURE'999.999999';
1
     ANAL:   PROCEDURE OPTIONS(REENTRANT);
      IF QUIT_SWITCH ^= '1' THEN DO;
               IF CURRENT = JOBSELCT THEN DO;
               DO I = 1 TO 50;
               IF XJOBN(I) = 0 THEN DO;
               XJOBN(I) = CURRENT_ASID;
       XNAME(I) = SEJOBNM;
               XJOB1(I) = CURRENT_TIME;
               GOTO JSL_XIT;
               END;
          END;
      JSL_XIT: ;
      END;
      IF CURRENT = INITATT THEN DO;
               DO I = 1 TO 50;
               IF XJOBN(I) = CURRENT_ASID THEN DO;
               XJOB2(I) = CURRENT_TIME;
               GOTO INA_XIT;
               END;
               END;
      INA_XIT: ;
      END;
      IF CURRENT = INITDET THEN DO;
               DO I = 1 TO 50;
               IF XJOBN(I) = CURRENT_ASID THEN DO;
               XJOB3(I) = CURRENT_TIME;
               GOTO IND_XIT;
               END;
               END;
      IND_XIT: ;
      END;
      IF CURRENT = JOBTERM THEN DO;
               DO I = 1 TO 50;
               IF XJOBN(I) = CURRENT_ASID THEN DO;
               T1 = CURRENT_TIME - XJOB1(I);
               T2 = XJOB3(I) - XJOB2(I);
               T3 = (XJOB2(I) -XJOB1(I)) +
                    (CURRENT_TIME - XJOB3(I));
               PT1 = T1;
               PT2 = T2;
               PT3 = T3;
      PUT SKIP EDIT (XNAME(I),'ASID = ',XJOBN(I),'TOTAL = ',PT1,
               'JOB = ',PT2,'INIT/TERM = ',PT3)
               (COL(1),A,X(3),A,A,X(3),A,A,X(3),A,A,X(3),A,A);
               XJOBN(I) = 0;
               XJOB1(I) = 0;
               XJOB2(I) = 0;
               XX = XX + 1;
               XJOB3(I) = 0;
               GOTO JTR_XIT;
               END;
               END;
         JTR_XIT: ;
         END;
         END;  /* MAINLINE DO GROUP ENDS HERE */
         IF QUIT_SWITCH = '1' THEN DO;
         PUT SKIP(3) EDIT(XX,' JOBS PROCESSED') (COL(4),F(6),A);
         END;
         RETURN;
         END;
         END;

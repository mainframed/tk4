./       ADD   NAME=HNB@RAC
PROC 0
CONTROL NOPROMPT NOLIST NOCONLIST
IF &SUBSTR(1:3,&SYSUID) = TEC × +
   &SUBSTR(1:3,&SYSUID) = DSA × +
   &SYSUID = OPSTS05 × +
   &SYSUID = OPSTS02 × +
   &SYSUID = QUATSO3 × +
   &SYSUID = QUATSO4 × +
   &SYSUID = QUATSO9 × +
   &SYSUID = ATTTSO1 × +
   &SYSUID = ATTTSO7 × +
   &SYSUID = ATTTSO8 × +
   &SYSUID = HNTSOM4 × +
   &SYSUID = RACTSO2 × +
   &SYSUID = DRLTSOI × +
   &SYSUID = DRLTSOG × +
   &SYSUID = DRLTSO7 × +
   &SYSUID = DRLTSOB × +
   &SYSUID = AFSTSO1 × +
   &SYSUID = AFXTSO1 × +
   &SYSUID = HNTSOA3 THEN +
      ISPEXEC SELECT PGM(TSO311) PARM(PANEL(HNB@RAC))
ELSE +
      ISPEXEC SELECT PGM(TSO311) PARM(PANEL(HNB@RACG))
./       ADD   NAME=HNBRA11
PROC 0
CONTROL NOPROMPT
ISPEXEC VGET (ZUSER) SHARED
ISPEXEC DISPLAY PANEL(HNBRA11)
SET &CC = &LASTCC
DO WHILE(&CC = 0)
   IF &OPT = B × &OPT = S THEN DO
      ISPEXEC DISPLAY PANEL(HNBRA11B)
      IF &LASTCC = 0 THEN DO
         SET &LUSER = &USER
         IF &OPT = B THEN SET &LNAME = BATCH
         IF &OPT = S THEN SET &LNAME = STC
         IF &OPT = B THEN SET &NAME = &STR(NAME(BATCH))
         IF &OPT = S THEN SET &NAME = &STR(NAME('STARTED TASK'))
         SET &MSGID = HNBRA110
         SET &OWNER  = &STR(OWNER(&OWNER))
         IF &DEFGRP EQ PREFIX THEN +
            SET &DEFGRP = &STR(DFLTGRP(&SUBSTR(1:3,&USER)))
         ELSE +
            SET &DEFGRP = &STR(DFLTGRP(&DEFGRP))
         SET &GRPAUTH = &STR(AUTHORITY(&GRPAUTH))
         SET &UACC = &STR(UACC(&UACC))
         IF &CLAUTH ^= NONE THEN SET &CLAUTH = &STR(CLAUTH(&CLAUTH))
         ELSE SET &CLAUTH =
         TSOAUTHC ADDUSER &USER &NAME &DEFGRP &GRPAUTH &UACC &CLAUTH +
                  &DATA +
                  &GRPACC &ADSP &SPEC &OPS &AUDIT &OID &OWNER &MODEL
         IF &LASTCC ^= 0 THEN SET &MSGID = HNBRA111
      END
      ELSE SET &MSGID = HNBRA119
   END
   IF &OPT = T THEN DO
      ISPEXEC DISPLAY PANEL(HNBRA11T)
      IF &LASTCC = 0 THEN DO
         SET &LUSER = &USER
         SET &LNAME = &NAME
         SET &MSGID = HNBRA110
         SET &OWNER  = &STR(OWNER(&OWNER))
         IF &DEFGRP = THEN +
            SET &DEFGRP = &STR(DFLTGRP(&SUBSTR(1:3,&USER)))
         ELSE +
            SET &DEFGRP = &STR(DFLTGRP(&DEFGRP))
         SET &GRPAUTH = &STR(AUTHORITY(&GRPAUTH))
         SET &UACC = &STR(UACC(&UACC))
         IF &CLAUTH ^= NONE THEN SET &CLAUTH = &STR(CLAUTH(&CLAUTH))
         ELSE SET &CLAUTH =
         TSOAUTHC ADDUSER &USER &NAME &DEFGRP &GRPAUTH &UACC &CLAUTH +
                  &DATA +
                  &GRPACC &ADSP &SPEC &OPS &AUDIT &OID &OWNER
         IF &LASTCC ^= 0 THEN SET &MSGID = HNBRA111
      END
      ELSE SET &MSGID = HNBRA119
   END
   IF &MSGID = HNBRA110 THEN TSOAUTHC LISTUSER &USER
   ISPEXEC CONTROL DISPLAY REFRESH
   ISPEXEC DISPLAY PANEL(HNBRA11) MSG(&MSGID)
   SET &CC = &LASTCC
END
./       ADD   NAME=HNBRA12
PROC 0
CONTROL NOPROMPT
ISPEXEC DISPLAY PANEL(HNBRA12)
SET &CC = &LASTCC
DO WHILE(&CC = 0)
   SET &LUSER = &USERID
   SET &LFUNC = &REVDEL
   SET &MSGID = HNBRA120
   IF &REVDEL = REVOKE THEN TSOAUTHC ALTUSER &USERID REVOKE
   IF &REVDEL = RESUME THEN TSOAUTHC ALTUSER &USERID RESUME
   IF &REVDEL = DELETE THEN TSOAUTHC DELUSER &USERID
   IF &LASTCC ^= 0 THEN SET &MSGID = HNBRA121
   ISPEXEC CONTROL DISPLAY REFRESH
   ISPEXEC DISPLAY PANEL(HNBRA12) MSG(&MSGID)
   SET &CC = &LASTCC
END
./       ADD   NAME=HNBRA13
PROC 0
CONTROL NOPROMPT
SET &NULL =
ISPEXEC VGET (ZUSER) SHARED
ISPEXEC DISPLAY PANEL(HNBRA13)
SET &CC = &LASTCC
DO WHILE(&CC = 0)
   SET &MSGID = HNBRA130
   IF &GROUP ^= THEN SET &GROUP  = &STR(GROUP(&GROUP))
   IF &GRPAUTH ^= THEN SET &GRPAUTH = &STR(AUTHORITY(&GRPAUTH))
   IF &UACC ^= THEN SET &UACC = &STR(UACC(&UACC))
   IF &GRPACC = YES THEN SET &GRPACC = GRPACC
   ELSE SET &GRPACC = NOGRPACC
   IF &ADSP = YES THEN SET &ADSP = ADSP
   ELSE SET &ADSP = NOADSP
   IF &SPEC = YES THEN SET &SPEC = SPECIAL
   ELSE SET &SPEC = &NULL
   IF &OPS = YES THEN SET &OPS = OPERATIONS
   ELSE SET &OPS = &NULL
   SET &LUSER = &USER
   SET &LFUNC = &REVRES.D
   TSOAUTHC CONNECT &USER &GROUP +
                    &GRPAUTH &UACC &GRPACC &ADSP &SPEC &OPS &REVRES
   IF &LASTCC ^= 0 THEN SET &MSGID = HNBRA131
   ISPEXEC CONTROL DISPLAY REFRESH
   ISPEXEC DISPLAY MSG(&MSGID)
   SET &CC = &LASTCC
END
./       ADD   NAME=HNBRA14
PROC 0
CONTROL NOPROMPT
ISPEXEC DISPLAY PANEL(HNBRA14)
SET &CC = &LASTCC
DO WHILE(&CC = 0)
   SET &MSGID = HNBRA140
   SET &LUSER = &USER
   IF &GROUP ^= THEN SET &GROUP  = &STR(GROUP(&GROUP))
   IF &OWNER ^= THEN DO
      SET &LOWN = &OWNER
      SET &OWNER = &STR(OWNER(&OWNER))
      SET &MSGID = HNBRA143
   END
   TSOAUTHC REMOVE &USER &GROUP &OWNER
   IF &LASTCC ^= 0 THEN SET &MSGID = HNBRA141
   ISPEXEC CONTROL DISPLAY REFRESH
   ISPEXEC DISPLAY PANEL(HNBRA14) MSG(&MSGID)
   SET &CC = &LASTCC
END
./       ADD   NAME=HNBRA15
PROC 0
CONTROL NOPROMPT
SET &DATA =
ISPEXEC DISPLAY PANEL(HNBRA15)
SET &CC = &LASTCC
DO WHILE(&CC = 0)
   SET &MSGID = HNBRA150
   IF &OWNER ^= THEN SET &OWNER = &STR(OWNER(&OWNER))
   IF &DEFGRP ^= THEN SET &DEFGRP = &STR(DFLTGRP(&DEFGRP))
   IF &GROUP  ^= THEN SET &GROUP  = &STR(GROUP(&GROUP))
   IF &GRPAUTH ^= THEN SET &GRPAUTH = &STR(AUTHORITY(&GRPAUTH))
   IF &UACC ^= THEN SET &UACC = &STR(UACC(&UACC))
   IF &CLAUTH ^= THEN SET &CLAUTH = &STR(CLAUTH(&CLAUTH))
   IF &GRPACC = YES THEN SET &GRPACC = GRPACC
   IF &GRPACC = NO  THEN SET &GRPACC = NOGRPACC
   IF &ADSP = YES THEN SET &ADSP = ADSP
   IF &ADSP = NO  THEN SET &ADSP = NOADSP
   IF &SPEC = YES THEN SET &SPEC = SPECIAL
   IF &SPEC = NO  THEN SET &SPEC = NOSPECIAL
   IF &OPS = YES THEN SET &OPS = OPERATIONS
   IF &OPS = NO  THEN SET &OPS = NOOPERATIONS
   IF &AUDIT = YES THEN SET &AUDIT = AUDITOR
   IF &AUDIT = NO  THEN SET &AUDIT = NOAUDITOR
   IF &OID = YES THEN SET &OID = OIDCARD
   IF &OID = NO  THEN SET &OID = NOOIDCARD
   SET &MODEL =
   IF &MDL = YES THEN SET &MODEL = &STR(MODEL('MODEL'))
   IF &MDL = NO  THEN SET &MODEL = NOMODEL
   IF &UAUDIT = YES THEN SET &UAUDIT = UAUDIT
   IF &UAUDIT = NO THEN SET &UAUDIT = NOUAUDIT
   IF &DSC = YES THEN ISPEXEC DISPLAY PANEL(HNBRA15N)
   IF &LASTCC = 0 THEN +
      TSOAUTHC ALTUSER &USER &DEFGRP &GROUP &GRPAUTH &UACC &CLAUTH +
               &GRPACC &ADSP &SPEC &OPS &AUDIT &OID &OWNER &UAUDIT +
               &MODEL +
               &DATA
   IF &LASTCC ^= 0 THEN SET &MSGID = HNBRA151
   SET &DATA =
   ISPEXEC CONTROL DISPLAY REFRESH
   ISPEXEC DISPLAY PANEL(HNBRA15) MSG(&MSGID)
   SET &CC = &LASTCC
END
./       ADD   NAME=HNBRA16
PROC 0
CONTROL PROMPT
ISPEXEC DISPLAY PANEL(HNBRA16)
SET &CC = &LASTCC
DO WHILE(&CC = 0)
   SET &MSGID = HNBRA160
   IF &PSW ^= THEN SET &PSW = &STR(PASSWORD(&PSW &NPSW))
   IF &INT ^= THEN SET &INT = &STR(INTERVAL(&INT))
   IF &USR ^= THEN SET &USR = &STR(USER(&USR))
   TSOAUTHC PASSWORD &PSW &INT &USR
   IF &LASTCC ^= 0 THEN SET &MSGID = HNBRA161
   SET &PSW =
   SET &NPSW =
   SET &INT =
   SET &USR =
   ISPEXEC CONTROL DISPLAY REFRESH
   ISPEXEC DISPLAY PANEL(HNBRA16) MSG(&MSGID)
   SET &CC = &LASTCC
END
./       ADD   NAME=HNBRA17
PROC 0
CONTROL NOPROMPT
ISPEXEC DISPLAY PANEL(HNBRA17)
SET &CC = &LASTCC
DO WHILE(&CC = 0)
   SET &MSGID = HNBRA170
   SET &LUSER = &USER
   TSOAUTHC ALTUSER &USER &NAME &DATA
   IF &LASTCC ^= 0 THEN SET &MSGID = HNBRA171
   ELSE TSOAUTHC LISTUSER &USER
   ISPEXEC CONTROL DISPLAY REFRESH
   ISPEXEC DISPLAY PANEL(HNBRA17) MSG(&MSGID)
   SET &CC = &LASTCC
END
./       ADD   NAME=HNBRA18
PROC 0
CONTROL NOPROMPT
ISPEXEC DISPLAY PANEL(HNBRA18)
SET &CC = &LASTCC
DO WHILE(&CC = 0)
   SET &MSGID = HNBRA180
   IF &USR = ALL THEN SET &USR = &STR(*)
   TSOAUTHC LISTUSER &USR
   IF &LASTCC ^= 0 THEN SET &MSGID = HNBRA181
   ISPEXEC CONTROL DISPLAY REFRESH
   ISPEXEC DISPLAY PANEL(HNBRA18) MSG(&MSGID)
   SET &CC = &LASTCC
END
./       ADD   NAME=HNBRA19
PROC 0
ISPEXEC DISPLAY PANEL(HNBRA19)
SET &CC = &LASTCC
DO WHILE(&CC = 0)
   SET &MSGID = HNBRA190
   SET &LUSERID = &USERID
   SET &LFUNC  = &FUNC.D
   IF &FUNC = DEFINE THEN DO
      IF &UACC   ^= THEN SET &UACC   = &STR(UACC(&UACC))
      IF &OWNER  ^= THEN SET &OWNER  = &STR(OWNER(&OWNER))
      IF &AUDIT  ^= THEN SET &AUDIT  = &STR(AUDIT(&AUDIT))
      TSOAUTHC ADDSD '&USERID..MODEL' &OWNER &UACC &AUDIT &LVL MODEL
      SET &ECC = &LASTCC
   END
   IF &FUNC = DELETE THEN DO
      TSOAUTHC DELDSD '&USERID..MODEL'
      SET &ECC = &LASTCC
   END
   IF &ECC ^= 0 THEN SET &MSGID = HNBRA193
   SET &USERID =
   SET &OWNER  =
   ISPEXEC CONTROL DISPLAY REFRESH
   ISPEXEC DISPLAY PANEL(HNBRA19) MSG(&MSGID)
   SET &CC = &LASTCC
END
./       ADD   NAME=HNBRA21
PROC 0
CONTROL NOPROMPT NOMSG NOFLUSH
ISPEXEC VGET (ZUSER) SHARED
ISPEXEC DISPLAY PANEL(HNBRA21)
SET &CC = &LASTCC
DO WHILE(&CC = 0)
   SET &MSGID = HNBRA210
   SET &LGROUP = &GROUP
   IF &SUPGRP ^= THEN SET &SUPGRP = &STR(SUPGROUP(&SUPGRP))
   IF &OWNER  ^= THEN SET &OWNER  = &STR(OWNER(&OWNER))
   IF &TRM = NO THEN SET &TRM = TERMUACC
   ELSE SET &TRM = NOTERMUACC
   IF &MDL = NO THEN SET &MODEL =
   ELSE SET &MODEL = MODEL('MODEL')
   TSOAUTHC ADDGROUP &GROUP &SUPGRP &OWNER &TRM &MODEL
   IF &LASTCC ^= 0 THEN SET &MSGID = HNBRA211
   SET &GROUP =
   SET &OWNER = &ZUSER
   SET &SUPGROUP =
   SET &TERMUACC = NO
   ISPEXEC CONTROL DISPLAY REFRESH
   ISPEXEC DISPLAY PANEL(HNBRA21) MSG(&MSGID)
   SET &CC = &LASTCC
END
./       ADD   NAME=HNBRA22
PROC 0
CONTROL NOPROMPT END(NDIT)
ISPEXEC DISPLAY PANEL(HNBRA22)
SET &CC = &LASTCC
DO WHILE(&CC = 0)
   SET &MSGID = HNBRA220
   SET &LGROUP = &GROUP
   TSOAUTHC DELGROUP &GROUP
   IF &LASTCC ^= 0 THEN SET &MSGID = HNBRA221
   ISPEXEC CONTROL DISPLAY REFRESH
   ISPEXEC DISPLAY PANEL(HNBRA22) MSG(&MSGID)
   SET &CC = &LASTCC
NDIT
./       ADD   NAME=HNBRA23
PROC 0
CONTROL PROMPT END(NDIT)
ISPEXEC DISPLAY PANEL(HNBRA23)
SET &CC = &LASTCC
DO WHILE(&CC = 0)
   SET &MSGID = HNBRA230
   SET &LGROUP = &GROUP
   IF &SUPGRP ^= THEN SET &SUPGRP = &STR(SUPGROUP(&SUPGRP))
   IF &OWNER  ^= THEN SET &OWNER  = &STR(OWNER(&OWNER))
   IF &TRM = YES THEN SET &TRM = NOTERMUACC
   IF &TRM = NO THEN SET &TRM = TERMUACC
   IF &MDL = YES THEN SET &MODEL = &STR(MODEL('MODEL'))
   IF &MDL = NO THEN SET &MODEL = NOMODEL
   TSOAUTHC ALTGROUP &GROUP &SUPGRP &OWNER &TRM &MODEL
   IF &LASTCC ^= 0 THEN SET &MSGID = HNBRA231
   SET &GROUP =
   SET &OWNER =
   SET &SUPGROUP =
   SET &TERMUACC =
   SET &MODEL =
   ISPEXEC CONTROL DISPLAY REFRESH
   ISPEXEC DISPLAY PANEL(HNBRA23) MSG(&MSGID)
   SET &CC = &LASTCC
NDIT
./       ADD   NAME=HNBRA24
PROC 0
CONTROL PROMPT END(NDIT)
ISPEXEC DISPLAY PANEL(HNBRA24)
SET &CC = &LASTCC
DO WHILE(&CC = 0)
   SET &MSGID = HNBRA240
   SET &LGROUP = &GROUP
   IF &GROUP = ALL THEN SET &GROUP = &STR(*)
   TSOAUTHC LISTGRP &GROUP
   IF &LASTCC ^= 0 THEN SET &MSGID = HNBRA241
   ISPEXEC CONTROL DISPLAY REFRESH
   ISPEXEC DISPLAY PANEL(HNBRA24) MSG(&MSGID)
   SET &CC = &LASTCC
NDIT
./       ADD   NAME=HNBRA25
PROC 0
ISPEXEC DISPLAY PANEL(HNBRA25)
SET &CC = &LASTCC
DO WHILE(&CC = 0)
   SET &MSGID = HNBRA250
   SET &LGROUP = &GROUP
   SET &LFUNC  = &FUNC.D
   IF &FUNC = DEFINE THEN DO
      IF &UACC   ^= THEN SET &UACC   = &STR(UACC(&UACC))
      IF &OWNER  ^= THEN SET &OWNER  = &STR(OWNER(&OWNER))
      IF &AUDIT  ^= THEN SET &AUDIT  = &STR(AUDIT(&AUDIT))
      TSOAUTHC ADDSD '&GROUP..MODEL' &OWNER &UACC &AUDIT &LVL MODEL
      SET &ECC = &LASTCC
   END
   IF &FUNC = DELETE THEN DO
      TSOAUTHC DELDSD '&GROUP..MODEL'
      SET &ECC = &LASTCC
   END
   IF &ECC ^= 0 THEN SET &MSGID = HNBRA253
   SET &GROUP =
   SET &OWNER  =
   ISPEXEC CONTROL DISPLAY REFRESH
   ISPEXEC DISPLAY PANEL(HNBRA25) MSG(&MSGID)
   SET &CC = &LASTCC
END
./       ADD   NAME=HNBRA31
PROC 0
CONTROL NOPROMPT
ISPEXEC VGET (ZUSER) SHARED
ISPEXEC DISPLAY PANEL(HNBRA31)
SET &CC = &LASTCC
DO WHILE(&CC = 0)
   SET &MSGID = HNBRA310
   SET &LDSNAME = &DSNAME
   IF &UACC   ^= THEN SET &UACC   = &STR(UACC(&UACC))
   IF &OWNER  ^= THEN SET &OWNER  = &STR(OWNER(&OWNER))
   IF &AUDIT  ^= THEN SET &AUDIT  = &STR(AUDIT(&AUDIT))
   TSOAUTHC ADDSD &DSNAME &OWNER &UACC &AUDIT &LVL &MODEL
   SET &ECC = &LASTCC
   IF &ECC ^= 0 THEN SET &MSGID = HNBRA313
   SET &DSNAME =
   SET &OWNER  = &ZUSER
   ISPEXEC CONTROL DISPLAY REFRESH
   ISPEXEC DISPLAY MSG(&MSGID)
   SET &CC = &LASTCC
END
./       ADD   NAME=HNBRA32
PROC 0
CONTROL PROMPT
ISPEXEC VGET (ZUSER) SHARED
ISPEXEC DISPLAY PANEL(HNBRA32)
SET &CC = &LASTCC
DO WHILE(&CC = 0)
   SET &MSGID = HNBRA320
   IF &MODEL ^= THEN SET &DSNAME = &STR('&MODEL..MODEL')
   SET &LDSNAME = &DSNAME
   IF &UACC   ^= THEN SET &UACC   = &STR(UACC(&UACC))
   IF &OWNER  ^= THEN SET &OWNER  = &STR(OWNER(&OWNER))
   IF &AUDIT  ^= THEN SET &AUDIT  = &STR(AUDIT(&AUDIT))
   IF &GAUDIT ^= THEN SET &GAUDIT = &STR(GLOBALAUDIT(&GAUDIT))
   TSOAUTHC ALTDSD &DSNAME &OWNER &UACC &AUDIT &GAUDIT &LVL
   SET &ECC = &LASTCC
   IF &ECC ^= 0 THEN SET &MSGID = HNBRA323
   SET &DSNAME =
   SET &MODEL  =
   SET &OWNER  = &ZUSER
   ISPEXEC CONTROL DISPLAY REFRESH
   ISPEXEC DISPLAY MSG(&MSGID)
   SET &CC = &LASTCC
END
./       ADD   NAME=HNBRA33
PROC 0
CONTROL PROMPT
ISPEXEC VGET (ZUSER) SHARED
ISPEXEC DISPLAY PANEL(HNBRA33)
SET &CC = &LASTCC
DO WHILE(&CC = 0)
   SET &MSGID = HNBRA330
   SET &LDSNAME = &DSNAME
   TSOAUTHC DELDSD &DSNAME
   IF &LASTCC ^= 0 THEN SET &MSGID = HNBRA331
   SET &DSNAME =
   ISPEXEC CONTROL DISPLAY REFRESH
   ISPEXEC DISPLAY MSG(&MSGID)
   SET &CC = &LASTCC
END
./       ADD   NAME=HNBRA34
PROC 0
CONTROL NOPROMPT MSG
ISPEXEC DISPLAY PANEL(HNBRA34)
SET &CC = &LASTCC
DO WHILE(&CC = 0)
   SET &MSGID = HNBRA340
   IF &MODEL ^= THEN SET &DSNAME = &STR('&MODEL..MODEL')
   SET &LDSNAME = &DSNAME
   SET &ID =
   SET &CPY =
   IF &COPY = THEN DO
      SET &I = 1
      SET &BLANK =
      DO WHILE &I < 9
         SET &VAR = &STR(ID&I)
         SET &VAR2 = &&&VAR
         IF &VAR2 ^= THEN SET &ID = &STR(&ID.&BLANK.&VAR2)
         SET &BLANK = &STR( )
         SET &I = &I + 1
      END
      SET &ID = &STR(ID(&ID))
   END
   ELSE SET &CPY = &COPY
   TSOAUTHC PERMIT &DSNAME &ID &ACCESS &CPY
   IF &LASTCC ^= 0 THEN SET &MSGID = HNBRA341
   SET &DSNAME =
   SET &MODEL  =
   ISPEXEC CONTROL DISPLAY REFRESH
   ISPEXEC DISPLAY MSG(&MSGID) CURSOR(DSNAME)
   SET &CC = &LASTCC
END
./       ADD   NAME=HNBRA35
PROC 0
CONTROL NOPROMPT
ISPEXEC DISPLAY PANEL(HNBRA35)
SET &CC = &LASTCC
DO WHILE(&CC = 0)
   SET &MSGID = HNBRA350
   SET &LDSNAME = &DSNAME
   TSOAUTHC LISTDSD &DSNAME &ID &PREFIX &STATS &USERS &HIST
   SET &RCC = &LASTCC
   IF &RCC ^= 0 THEN SET &MSGID = HNBRA351
   SET &DSNAME =
   ISPEXEC CONTROL DISPLAY REFRESH
   ISPEXEC DISPLAY PANEL(HNBRA35) MSG(&MSGID)
   SET &CC = &LASTCC
END
./       ADD   NAME=HNBRA51
PROC 0
CONTROL NOPROMPT
ISPEXEC DISPLAY PANEL(HNBRA51)
SET &CC = &LASTCC
DO WHILE(&CC = 0)
   SET &MSGID = HNBRA510
   IF &FUNCTION NE THEN DO
      SET &I = 1
      SET &CLASSES =
      SET &BLANK   = &STR( )
      DO WHILE &I < 9
         SET &VAR1 = &STR(CLASS&I)
         SET &VAR2 = &&&VAR1
         IF &VAR2 NE THEN SET &CLASSES = &STR(&CLASSES&BLANK&VAR2)
         SET &I = &I + 1
      END
      SET &FUNCTION = &STR(&FUNCTION(&CLASSES))
   END
   SET &OPT=&STR(&FUNCTION &TERM &PW &INIT &LIST &MODEL &INAC +
            &SAUD &CAUD)
   TSOAUTHC SETROPTS LIST &FUNCTION &TERM &PW &INIT &LIST &MODEL +
            &INAC &SAUD &CAUD
   SET &RCC = &LASTCC
   IF &RCC ^= 0 THEN SET &MSGID = HNBRA511
   ISPEXEC CONTROL DISPLAY REFRESH
   ISPEXEC DISPLAY PANEL(HNBRA51) MSG(&MSGID)
   SET &CC = &LASTCC
END
./       ADD   NAME=HNBRA52
PROC 0
CONTROL NOPROMPT
ISPEXEC DISPLAY PANEL(HNBRA52)
SET &CC = &LASTCC
DO WHILE(&CC = 0)
   SET &MSGID = HNBRA520
   SEARCH &CLASS &MASK &VOLSER &AGE &LIST &CLIST &AM
   SET &RCC = &LASTCC
   IF &RCC ^= 0 THEN SET &MSGID = HNBRA521
   ELSE IF &CLIST NE THEN DO
      ISPEXEC EDIT DATASET(EXEC.RACF.CLIST)
      IF &EXEC = YES THEN EXEC EXEC.RACF.CLIST LIST
   END
   ISPEXEC CONTROL DISPLAY REFRESH
   ISPEXEC DISPLAY PANEL(HNBRA52) MSG(&MSGID)
   SET &CC = &LASTCC
END
./       ADD   NAME=HNBRA530
PROC 2 GROUP USERID
CONTROL NOPROMPT
TSOAUTHC ALTGROUP &GROUP OWNER(&USERID) SUP(SECURITY)
SET &RCC = &LASTCC
IF &RCC = 0 THEN DO
   TSOAUTHC ADDGROUP &GROUP.T OWNER(&USERID)
   IF &LASTCC NE 0 THEN WRITE UNABLE TO ADD &GROUP.T
   END
END
IF &RCC NE 0 THEN WRITE UNABLE TO TRANSFER &GROUP TO &USERID
./       ADD   NAME=HNBRA531
PROC 2 GROUP USERID
CONTROL NOPROMPT
SEARCH CLASS(USER) MASK(&GROUP) +
       CLIST('ALU ',' OWNER(&USERID)') NOLIST
IF &LASTCC ^= 0 THEN WRITE UNABLE TO SEARCH FOR &GROUP USERIDS (ALU)
ELSE DO
   ISPEXEC EDIT DATASET(EXEC.RACF.CLIST)
   EXEC EXEC.RACF.CLIST LIST
END
./       ADD   NAME=HNBRA532
PROC 1 GROUP
CONTROL NOPROMPT
SET &GROUPT = &GROUP.T
SEARCH CLASS(USER) MASK(&GROUP) NOLIST +
                CLIST('CO ',' GROUP(&GROUPT)')
SET &RCC = &LASTCC
IF &RCC = 0 THEN DO
   ISPEXEC EDIT DATASET(EXEC.RACF.CLIST)
   EXEC EXEC.RACF.CLIST LIST
   SEARCH CLASS(USER) MASK(&GROUP) NOLIST +
                   CLIST('ALU ',' DFLT(&GROUPT)')
   SET &RCC = &LASTCC
   IF &RCC = 0 THEN DO
      ISPEXEC EDIT DATASET(EXEC.RACF.CLIST)
      EXEC EXEC.RACF.CLIST LIST
   END
   ELSE WRITE UNABLE TO SEARCH FOR GROUP &GROUP USERIDS (ALTUSER)
END
ELSE WRITE UNABLE TO SEARCH FOR GROUP &GROUP USERIDS (CONNECT)
./       ADD   NAME=HNBRA533
PROC 1 GROUP
CONTROL NOPROMPT
SEARCH CLASS(USER) MASK(&GROUP) NOLIST +
                CLIST('RE ',' GROUP(&GROUP)')
SET &RCC = &LASTCC
IF &RCC = 0 THEN DO
   ISPEXEC EDIT DATASET(EXEC.RACF.CLIST)
   EXEC EXEC.RACF.CLIST LIST
END
ELSE WRITE UNABLE TO SEARCH FOR GROUP &GROUP USERIDS (REMOVE)
./       ADD   NAME=HNBRA534
PROC 1 GROUP
CONTROL NOPROMPT
SET &GROUPT = &GROUP.T
SEARCH CLASS(USER) MASK(&GROUP) NOLIST +
                CLIST('CO ',' GROUP(&GROUP) GRPACC AUTH(CREATE)')
SET &RCC = &LASTCC
IF &RCC = 0 THEN DO
   ISPEXEC EDIT DATASET(EXEC.RACF.CLIST)
   EXEC EXEC.RACF.CLIST LIST
   SEARCH CLASS(USER) MASK(&GROUP) NOLIST +
                   CLIST('ALU ',' DFLT(&GROUP)')
   SET &RCC = &LASTCC
   IF &RCC = 0 THEN DO
      ISPEXEC EDIT DATASET(EXEC.RACF.CLIST)
      EXEC EXEC.RACF.CLIST LIST
      SEARCH CLASS(USER) MASK(&GROUP) NOLIST +
                      CLIST('RE ',' GROUP(&GROUPT)')
      IF &RCC = 0 THEN DO
         ISPEXEC EDIT DATASET(EXEC.RACF.CLIST)
         EXEC EXEC.RACF.CLIST LIST
         DELGROUP &GROUPT
         IF &LASTCC NE 0 THEN WRITE UNABLE TO DELETE GROUP &GROUPT
      END
      ELSE WRITE UNABLE TO SEARCH FOR GROUP &GROUP USERIDS (REMOVE)
   END
   ELSE WRITE UNABLE TO SEARCH FOR GROUP &GROUP USERIDS (ALTUSER)
END
ELSE WRITE UNABLE TO SEARCH FOR GROUP &GROUP USERIDS (CONNECT)
./       ADD   NAME=HNBRA60
PROC 0
CONTROL NOPROMPT END(NDIT) NOMSG
ALLOC F(SORTMSG) DUMMY REUSE
ALLOC F(SYSOUT) DUMMY REUSE
SET &ALLOC = NO
SET &ZRWNO =
ISPEXEC VGET (ZRWNO) PROFILE
IF &ZRWNO = THEN SET &ZRWNO = 1
SET &ODSN = RACFRW&ZRWNO..LIST
ISPEXEC DISPLAY PANEL(HNBRA60)
SET &CC = &LASTCC
DO WHILE(&CC = 0)
   SET &MSGID = HNBRA600
   TSOSTATE &ODSN RETCODE
   SET &RETCODE = &LASTCC
   IF &RETCODE = 0 THEN +
      ALLOC F(SYSPRINT) DA(&ODSN) MOD REUSE
   IF &RETCODE NE 0 THEN +
      ALLOC F(SYSPRINT) DA(&ODSN) NEW CATALOG SPACE(10 10) +
            CYLINDERS REUSE
   SET &ALLOC = YES
   SET &SELCMD =
   IF &SSE = YES THEN DO
      ISPEXEC DISPLAY PANEL(HNBRA61)
      IF &LASTCC > 0 THEN SET &SELCMD =
      ELSE ISPEXEC DISPLAY PANEL(HNBRA61A)
   NDIT
   SET &EVECMD =
   SET &EVN = 1
   IF &SEV = YES && &SELCMD NE THEN DO
      ISPEXEC DISPLAY PANEL(HNBRA62) MSG(HNBRA610)
      SET &EVCC = &LASTCC
      DO WHILE(&EVCC = 0 && &EVN < 49)
         ISPEXEC DISPLAY PANEL(HNBRA62A)
         SET &EVCM&EVN = &STR(&EVECMD)
         ISPEXEC DISPLAY PANEL(HNBRA62) MSG(HNBRA620)
         SET &EVCC = &LASTCC
         SET &EVN = &EVN + 1
      NDIT
   NDIT
   SET &LSTCMD =
   SET &LSN = 1
   IF &SLS = YES THEN DO
      ISPEXEC DISPLAY PANEL(HNBRA63)
      SET &LSCC = &LASTCC
      DO WHILE(&LSCC = 0)
         SET &LSCM&LSN = &STR(&LSTCMD)
         ISPEXEC DISPLAY PANEL(HNBRA63) MSG(HNBRA630)
         SET &LSCC = &LASTCC
         SET &LSN = &LSN + 1
      NDIT
   NDIT
   SET &SUMCMD =
   SET &SUN = 1
   IF &SSU = YES THEN DO
      ISPEXEC DISPLAY PANEL(HNBRA64)
      SET &SUCC = &LASTCC
      DO WHILE(&SUCC = 0)
         SET &SUCM&SUN = &STR(&SUMCMD)
         ISPEXEC DISPLAY PANEL(HNBRA64) MSG(HNBRA640)
         SET &SUCC = &LASTCC
         SET &SUN = &SUN + 1
      NDIT
   NDIT
   ISPEXEC CONTROL DISPLAY LINE START(1)
   CONTROL MSG LIST
   TSOAUTHC &PCMD
   &SELCMD
   SET &CTR = 1
   DO WHILE(&CTR < &EVN)
      SET &CMD = EVCM&CTR
      SET &CMD = &STR(&&)&CMD
      &CMD
      SET &CTR = &CTR + 1
   NDIT
   SET &CTR = 1
   DO WHILE(&CTR < &LSN)
      SET &CMD = LSCM&CTR
      SET &CMD = &STR(&&)&CMD
      &CMD
      SET &CTR = &CTR + 1
   NDIT
   SET &CTR = 1
   DO WHILE(&CTR < &SUN)
      SET &CMD = SUCM&CTR
      SET &CMD = &STR(&&)&CMD
      &CMD
      SET &CTR = &CTR + 1
   NDIT
   END
   SET &RCC = &LASTCC
   CONTROL NOMSG NOLIST
   ISPEXEC CONTROL DISPLAY REFRESH
   IF &RCC > 0 THEN SET &MSGID = HNBRA601
   ISPEXEC DISPLAY PANEL(HNBRA60) MSG(&MSGID)
   SET &CC = &LASTCC
NDIT
IF &ALLOC = YES THEN DO
   ISPEXEC BROWSE DATASET(&ODSN)
   ISPEXEC VGET (SCL1) PROFILE
   ISPEXEC DISPLAY PANEL(HNBRA60P)
   SET &PCC = &LASTCC
   IF &PCC = 0 THEN DO
      IF &PROPT = D THEN DELETE &ODSN
      IF &PROPT = J THEN DO
         FREE DA(&ODSN)
         ISPEXEC FTOPEN TEMP
         ISPEXEC FTINCL HNBRA60P
         ISPEXEC VGET (ZTEMPF) SHARED
         ISPEXEC FTCLOSE
         SUB '&ZTEMPF' J(&JC)
      NDIT
      IF &PROPT ^= K THEN DO
         SET &ZRWNO = &ZRWNO + 1
         IF &ZRWNO > 9 THEN SET &ZRWNO = 1
         ISPEXEC VPUT (ZRWNO) PROFILE
      NDIT
   NDIT
   ALLOC F(SYSPRINT) DA(*) REUSE
NDIT

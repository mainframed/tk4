++USERMOD  (MW00009)
 /*        GTEDS/MIDWEST OS/VS PTF NUMBER 00009
  *
  *        TYPE             - ZAP
  *        RELEASE          - 3.8A
  *        PTF LEVEL        - 8201
  *        KEYPHRASE        - I/O PRIORITY QUEUEING
  *        ENVIRONMENT      - 12MB 3033 - BATCH,RJE,NJE,TSO,IMS,CICS
  *                         - 16MB 3033 - BATCH,RJE,NJE,TSO,IMS,CICS
  *        PROBLEM          - HIGH PRIORITY TASKS GET SLOWED DOWN IN
  *                         - FIFO I/O QUEUES.
  *        SOLUTION         - ADD I/O PRIORITY QUEUEING TO SYSTEM.
  *        RESULTS/BENEFITS - IMPROVED IMS AND TSO RESPONSE.
  *
  */ .
++VER  (Z038) FMID(FBB1221).
++ZAP  (IECIOSAM) .
 NAME IECIOSCN
 VER 03DE 5020B008            ST  IOSBR,IOQIOSB  SHOW IOQ ASSOC. W/IOSB
 VER 03E2 9400B004            NI  IOQFLA,ZERO    ZERO ALL FLAGS EXCEPT
 VER 03E6 943EB005            NI  IOQFLB,IOQALOC+IOQHOLD  ALLOC. & HOLD
 VER 03EA 07F4                BR  LNKR           RETURN TO CALLER
 VER 121C 0000,0000,0000,0000,0000     VERIFY THE
 VER 1226 0000,0000,0000,0000,0000     END OF IOS
 VER 1230 0000,0000,0000               PATCH AREA.
 REP 03DE 58A00224        PICK-UP PSA OLD ASCB ADDR.
 REP 03E2 D200B006A02B    MOVE ASCB DPRTY TO IOQPRI FIELD.
 REP 03E8 47F0821C        BRANCH TO FIRST PATCH AREA SEGMENT.
 REP 121C 5020B008            ST  IOSBR,IOQIOSB  SHOW IOQ ASSOC. W/IOSB
 REP 1220 9400B004            NI  IOQFLA,ZERO    ZERO ALL FLAGS EXCEPT
 REP 1224 943EB005            NI  IOQFLB,IOQALOC+IOQHOLD  ALLOC. & HOLD
 REP 1228 07F4                BR  LNKR           RETURN TO CALLER
 VER 0ECC 58FE0000  IQUEE060  L   WRKODD,IOQLNK-IOQ(WRKEVEN) GET NXT IOQ
 VER 0ED0 12FF                LTR WRKODD,WRKODD  TEST FOR END OF LCH
 VER 0ED2 47D05EDE            BNP IQUEE070       YES - GO QUEUE
 VER 0ED6 58E01004            L   WRKEVEN,LCHLST   PICKUP LAST IOQ
 VER 0EDA 58FE0000            L   WRKODD,IOQLNK-IOQ(WRKEVEN) END OF CHAI
 VER 0EDE 50BE0000  IQUEE070  ST  IOQR,IOQLNK-IOQ(WRKEVEN) LINK BACK TO
 VER 0EE2 50F0B000            ST  WRKODD,IOQLNK  LINK CURRENT TO NEXT
 VER 0EE6 50B01004            ST  IOQR,LCHLST    YES - SHOW LAST ON LCH
 VER 0EEA 9640B004  IQUEE080  OI  IOQFLA,IOQENQ  SHOW IOQE ENQUEUED
 REP 0ED2 47D0822A            BNP NEWEE070       YES - GO QUEUE
 REP 0ED6 D500F006B006    IS CURRENT IOQ LOWER IN PRIORITY ?
 REP 0EDC 4740822E        YES, INSERT NEXT IOQ AS CURRENT. BRANCH TO NEW
 REP 0EE0 18EF            NO, UPDATE IOQ POINTER AND
 REP 0EE2 47F05ECC              BRANCH TO IQUEE060.
 REP 0EE6 50F0B000            ST  WRKODD,IOQLNK  LINK CURRENT TO NEXT
 REP 122A 50B01004  NEWEE070  ST  IOQR,LCHLST    YES - SHOW LAST ON LCH
 REP 122E 50BE0000            ST  IOQR,IOQLNK-IOQ(WRKEVEN) LINK BACK TO
 REP 1232 47F05EE6        BRANCH BACK TO IQUEE080-4.
 IDRDATA MW00009

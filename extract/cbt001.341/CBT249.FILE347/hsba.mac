         MACRO
&LABEL   HSBA  &R=0,&C=0,&MOD=SET
         GBLB  &HMODNUM
         LCLA  &BA,&I1,&I2,&ROW,&COL,&LINESZ
         LCLC  &BAB1,&BAB2
         AIF   ('&MOD' EQ 'SET').GBLMOD
         AIF   ('&MOD' EQ '1').MOD1
         AIF   ('&MOD' EQ '2').MOD2
         MNOTE 8,'MOD NOT 1 OR 2 - PREV MOD OR 2 ASSEMED'
.GBLMOD  AIF   (NOT &HMODNUM).MOD2
.MOD1    ANOP
&HMODNUM SETB  1
         AIF   ('&R' GT  '12').M1RERR
         AIF   ('&C' GT  '40').M1CERR
&LINESZ  SETA  40
         AGO   .SETROW
.MOD2    ANOP
&HMODNUM SETB  0
         AIF   ('&R' GT  '24').M2RERR
         AIF   ('&C' GT  '80').M2CERR
&LINESZ  SETA  80
.SETROW  ANOP
&ROW     SETA  1
         AIF   ('&R' LE '1').SETCOL
&ROW     SETA  &R
.SETCOL  ANOP
&COL     SETA  1
         AIF   ('&C' LE '1').CALCBA
&COL     SETA  &C
.CALCBA  ANOP
&BA      SETA  &LINESZ*(&ROW-1)+&COL-1
&I1      SETA  &BA/64
&I2      SETA  2*(&BA-(64*&I1)+1)-1
&I1      SETA  2*(&I1+1)-1
&BAB1    SETC  '40C1C2C3C4C5C6C7C8C94A4B4C4D4E4F50D1D2D3D4D5D6D7D8D95A5-
               B5C5D'(&I1,2)
&BAB2    SETC  '40C1C2C3C4C5C6C7C8C94A4B4C4D4E4F50D1D2D3D4D5D6D7D8D95A5-
               B5C5D5E5F6061E2E3E4E5E6E7E8E96A6B6C6D6E6FF0F1F2F3F4F5F6F-
               7F8F97A7B7C7D7E7F'(&I2,2)
&LABEL   DC    XL3'11&BAB1&BAB2'
         AGO   .SBAX
.M1RERR  MNOTE 8,'ROW NOT 1 THRU 12 FOR MOD 1'
         AGO   .DUMMY
.M1CERR  MNOTE 8,'COL NOT 1 THRU 40 FOR MOD 1'
         AGO   .DUMMY
.M2RERR  MNOTE 8,'ROW NOT 1 THRU 24 FOR MOD 2'
         AGO   .DUMMY
.M2CERR  MNOTE 8,'COL NOT 1 THRU 80 FOR MOD 2'
.DUMMY   ANOP
&LABEL   DC    XL3'110000'
.SBAX    ANOP
         MEND

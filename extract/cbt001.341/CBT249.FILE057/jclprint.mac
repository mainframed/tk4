++ADD INTFC1082B,DATA,LIST
00000010CONTROL MAIN PROMPT NOMSG
00000020ERROR OFF
00000030ATTN GOTO EOJ
00000040FREE DD(JCLLIST TAPELIST)
00000050CONTROL MSG
00000060ERROR EXIT
00000070ALLOC DD(JCLLIST) DS('SYSP.JCLLIST') SHR
00000080ALLOC DD(TAPELIST) DS('SYSP.TAPELIST') SHR
00000090ALLOC DD(PSPLIN) DS(PANTEMP.DATA) SP(5,5) TRA
00000100SET &DDNAME=JCLLIST
00000110SET &OLDFLAG=0
00000120SET &CTYPE=S(I)
00000130START: ERROR GOTO START
00000140ATTN GOTO START
00000150SET &JOBNAME=
00000160SET &JOBNUMBER=
00000180WRITE
00000190WRITENR ENTER JOBNAME, PANNAME, VOLSER, OR .KEYWORD(+):
00000200GETJNAME: READ &JOBNAME
00000210SET &L=&LENGTH(&STR(&JOBNAME))
00000220IF &L=0 THEN GOTO START
00000230IF &DATATYPE(&SUBSTR(1,&JOBNAME))=NUM THEN DO
00000240IF &L^=6 THEN DO
00000250WRITENR VOLSER MUST BE 6 CHARACTERS - REENTER(+):
00000260GOTO GETJNAME
00000270END
00000280ERROR GOTO ABORT
00000290ATTN GOTO ABORT
00000300E 'SYSP.JCLIB(PANREST)' CNTL
00000310WRITE
00000320WRITE ENTER PANVALET NAMES OF JOBS YOU WISH TO RETRIEVE,
00000330WRITE ONE NAME PER LINE, IN ASCENDING COLLATING SEQUENCE.
00000340WRITE HIT 'ENTER' TO TERMINATE INPUT AFTER LAST NAME.
00000350WRITE
00000360C * 3 /?SYSUID/&SYSUID/
00000370C * 99999 /?VOLSER/&JOBNAME/A
00000380I NOPROMPT
00000390TOP
00000400F /SYSIN/ 3
00000410CONTROL NOMSG
00000420DOWN
00000430C * 99999 //++RESTORE /A
00000440CONTROL MSG
0000045099999 &STR(/*)
00000460SUBMIT
00000470GOTO EOEDIT
00000480ABORT: X ECHO
00000490WRITE TAPE RETRIEVAL REQUEST ABORTED
00000500EOEDIT: DATA
00000510END N
00000520ENDDATA
00000530GOTO START
00000540END
00000550IF &SUBSTR(1,&JOBNAME)=. THEN DO
00000560IF &L<2 THEN SET &PTYPE=U(0,1)
00000570ELSE IF &SUBSTR(2,&JOBNAME)=F THEN SET &PTYPE=U(1)
00000580ELSE IF &SUBSTR(2,&JOBNAME)=A THEN SET &PTYPE=U(0,1)
00000590ELSE IF &SUBSTR(2,&JOBNAME)=N THEN DO
00000600SET &PTYPE=S(A)
00000610IF &OLDFLAG=1 THEN DO
00000620SET &DDNAME=JCLLIST
00000630SET &OLDFLAG=0
00000640SET &CTYPE=S(I)
00000650WRITE
00000660WRITE *** USING SYSP.JCLLIST ***
00000670END
00000680END
00000690ELSE IF &SUBSTR(2,&JOBNAME)=O THEN DO
00000700SET &DDNAME=TAPELIST
00000710SET &PTYPE=U(0,1)
00000720SET &CTYPE=S(D)
00000730SET &OLDFLAG=1
00000740WRITE
00000750WRITE *** USING SYSP.TAPELIST ***
00000760END
00000770ELSE IF &SUBSTR(2,&JOBNAME)=E THEN GOTO EOJ
00000780ELSE DO
00000790WRITE
00000800WRITE INVALID KEYWORD '&JOBNAME'
00000810GOTO START
00000820END
00000830WRITE
00000840WRITE CLEAR SCREEN AND HIT 'ENTER'
00000850READ
00000860PAN PRINT &PTYPE CON(0) COM DDNAME(&DDNAME)
00000870GOTO START
00000880END
00000890IF &JOBNAME=? THEN DO
00000900WRITE
00000910WRITE ENTER ONE OF THE FOLLOWING:
00000920WRITE
00000930WRITE NAME OF REQUIRED JOB (8 OR LESS CHAR., 1ST NOT NUMERIC), O
00000940WRITE PANVALET NAME OF REQUIRED JOB (10 CHAR., LAST 4 NUMERIC),
00000950WRITE VOLSER OF TAPE FOR JOB RETRIEVAL (6 CHAR., 1ST NUMERIC), O
00000960WRITE .NEW TO LIST ALL JOBS NOT YET EXAMINED (JCLLIST), OR
00000970WRITE .OLD TO LIST ALL JOBS PREVIOUSLY RESTORED FROM TAPE (TAPEL
00000980WRITE .ALL TO LIST ALL JOBS (JCLLIST OR TAPELIST DEPENDING ON MO
00000990WRITE .FAIL TO LIST ALL JOBS THAT HAD PRINTED (JCLLIST OR TAPELI
00001000WRITENR .END TO TERMINATE JCLPRINT:
00001010GOTO GETJNAME
00001020END
00001030IF &L=10 THEN DO
00001040IF &DATATYPE(&SUBSTR(7:10,&JOBNAME))^=NUM THEN DO
00001050WRITENR JOBNAME TOO LONG OR INVALID PANNAME - REENTER(+):
00001060GOTO GETJNAME
00001070END
00001080SET &PANNAME=&JOBNAME
00001090GOTO JNUMOK
00001100END
00001110IF &L>8 THEN DO
00001120WRITENR JOBNAME LONGER THAN 8 CHARACTERS - REENTER(+):
00001130GOTO GETJNAME
00001140END
00001150SET &OJNAME=&JOBNAME
00001160IF &L<6 THEN SET &JOBNAME=&JOBNAME.0000000
00001170SET &L=&LENGTH(&JOBNAME)
00001180IF &L>6 THEN SET &JOBNAME=&SUBSTR(1:6,&JOBNAME)
00001190SET &I=1
00001200DO WHILE &I<=6
00001210SET &JCHAR=&SUBSTR(&I,&JOBNAME)
00001220IF &JCHAR>=A THEN GOTO EOL
00001230SET &J=1
00001240DO WHILE &J<=3
00001250IF &JCHAR=&SUBSTR(&J,#@$) THEN DO
00001260IF &I>1 THEN SET &PART1=&SUBSTR(1:&I-1,&JOBNAME)
00001270ELSE SET &PART1=
00001280IF &I<6 THEN SET &PART2=&SUBSTR(&I+1:6,&JOBNAME)
00001290ELSE SET &PART2=
00001300SET &JOBNAME=&PART1&SUBSTR(&J,NAD)&PART2
00001310GOTO EOL
00001320END
00001330SET &J=&J+1
00001340END
00001350EOL: SET &I=&I+1
00001360END
00001370NOJNUM: WRITE
00001380WRITE CLEAR SCREEN AND HIT 'ENTER'
00001390READ
00001400PAN PRINT N(&JOBNAME) CON(0) COM DDNAME(&DDNAME)
00001410WRITE
00001420WRITENR ENTER LAST 4 DIGITS OF PANVALET NAME(+):
00001430GETJNUM: READ &JOBNUMBER
00001440IF &JOBNUMBER=? THEN DO
00001450WRITE
00001460WRITENR DID YOU JUST GET A '0 DATASET(S) SELECTED' MESSAGE?
00001470READ &REPLY
00001480IF &SUBSTR(1,&REPLY)=Y THEN DO
00001490WRITE
00001500WRITE NO ENTRIES FOR JOB &OJNAME.
00001510GOTO START
00001520END
00001530WRITE
00001540WRITE FROM THE FOLLOWING LIST DETERMINE THE ENTRY CORRESPONDING
00001550WRITE TO THE JOB YOU WISH TO EXAMINE AND ENTER THE LAST FOUR
00001560WRITE DIGITS OF THE PANVALET NAME (USUALLY SAME AS JOBNUMBER).
00001570WRITE YOU MAY ALSO ENTER .END TO RESTART JCLPRINT PROCESS
00001580GOTO NOJNUM
00001590END
00001600SET &L=&LENGTH(&STR(&JOBNUMBER))
00001610IF &L=0 THEN GOTO JNUMBAD
00001620IF &SUBSTR(1,&JOBNUMBER)=. THEN GOTO START
00001630IF &DATATYPE(&JOBNUMBER)^=NUM THEN GOTO JNUMBAD
00001640IF &JOBNUMBER<1 THEN GOTO JNUMBAD
00001650IF &L=4 THEN GOTO JNUMOK
00001660IF &L<4 THEN DO
00001670SET &JOBNUMBER=&SUBSTR(1:4-&L,000)&JOBNUMBER
00001680WRITE ASSUMING LEADING ZERO(S) - JOBNUMBER=&JOBNUMBER
00001690GOTO JNUMOK
00001700END
00001710JNUMBAD: WRITENR JOBNUMBER &JOBNUMBER INVALID - REENTER(+):
00001720GOTO GETJNUM
00001730JNUMOK: ERROR OFF
00001740SET &PANNAME=&JOBNAME&JOBNUMBER
00001750/* SET &TSONAME=&SUBSTR(1:8,&PANNAME) */
00001760ATTN GOTO EODS
00001770PAN RET &PANNAME DDNAME(&DDNAME) DA(PANTEMP.DATA)
00001780IF &LASTCC^=0 THEN GOTO START
00001790ERROR GOTO EODS
00001800SET &PRTFLAG=0
00001810TSOHARD: WRITE
00001820WRITENR DO YOU WANT A HARD COPY LISTING OF THE JOB(+)?
00001830READ &REPLY
00001840WRITE
00001850IF &LENGTH(&REPLY)=0 THEN GOTO WHAT
00001860IF &REPLY=? THEN DO
00001870IF &PRTFLAG=0 THEN +
00001880WRITE ENTER 'NO' IF YOU WISH TO EXAMINE THE JOB ON THE SCREEN FI
00001890ELSE WRITE ENTER 'NO' IF YOU ARE FINISHED EXAMINING THIS JOB.
00001900WRITE ENTER 'YES' TO PRINT JOB ON LOCAL PRINTER, OR ENTER A
00001910WRITENR REMOTE NUMBER TO WHERE PRINTOUT IS TO BE ROUTED
00001920READ &REPLY
00001930WRITE
00001940END
00001950IF &DATATYPE(&REPLY)=NUM THEN DO
00001960SET &RMT=&REPLY
00001970SET &REPLY=Y
00001980END
00001990ELSE SET &RMT=0
00002000IF &SUBSTR(1,&REPLY)=N THEN DO
00002010IF &PRTFLAG=1 THEN GOTO EODS
00002020WRITE CLEAR SCREEN AND HIT 'ENTER'
00002030READ
00002040/* L &TSONAME..DATA 2 99999 NONUM COL(2:80) */
00002050L PANTEMP.DATA 2 99999 NONUM COL(2:80)
00002060SET &PRTFLAG=1
00002070ERROR OFF
00002080PAN CHANGE &PANNAME &CTYPE CON(0) DDNAME(&DDNAME)
00002090IF &LASTCC^=0 THEN WRITE *** IGNORE ABOVE MESSAGE (PV028) ***
00002100ERROR GOTO EODS
00002110GOTO TSOHARD
00002120END
00002130IF &SUBSTR(1,&REPLY)=Y THEN DO
00002140CONTROL NOMSG
00002150ERROR OFF
00002160FREE DD(/* PSPLIN */ PSPLOUT)
00002170CONTROL MSG
00002180ERROR GOTO EOHCOPY
00002190ATTN GOTO EOHCOPY
00002200/* ALLOC DD(PSPLIN) DS(&TSONAME..DATA) */
00002210ALLOC DD(PSPLOUT) SYSOUT(A) DEST(R&RMT)
00002220CALL 'SYSP.LINKLIB(PANPRT)'   *** MODULE INTFC1082F ***
00002230EOHCOPY: ERROR OFF
00002240FREE DD(PSPLOUT)
00002250IF &PRTFLAG=0 THEN PAN CHANGE &PANNAME &CTYPE CON(0) DDNAME(&DDN
00002260IF &LASTCC^=0 THEN WRITE *** IGNORE ABOVE MESSAGE (PV028) ***
00002270GOTO EODS
00002280END
00002290WHAT: WRITE '&REPLY' INVALID. ONLY 'YES', 'NO', OR RMT NUMBER AC
00002300GOTO TSOHARD
00002310EODS: CONTROL NOMSG
00002320ERROR OFF
00002330/* DELETE &TSONAME..DATA */
00002340CONTROL MSG
00002350GOTO START
00002360EOJ: CONTROL NOMSG
00002370ERROR OFF
00002380FREE DD(JCLLIST TAPELIST)
00002390DELETE PANTEMP.DATA
00002400EXIT

*PROCESS OPT(TIME);
 HISTO:  PROCEDURE OPTIONS(MAIN)REORDER;
0/*==>HISTO IS UNUSED. BLDO NO LONGER PRODUCES FILE(SYSOUT). */
0/*   HISTO READS THE FILE(SYSOUT) OUTPUT FROM BLDO AND PRODUCES
 /*      A HISTOGRAM OF THE NUMBER OF DESCRIPTORS OCCURRING A
 /*      GIVEN NUMBER OF TIMES. */
0DECLARE
      (HBOUND,MIN,TRUNC)BUILTIN,
      SYSPRINT PRINT,
      DICT RECORD INPUT ENV(FBS RECSIZE(67) TOTAL),
      EOF BIT(1)STATIC INITIAL(0B),
      (I,O)FIXED BINARY,
      HIST(2000)FIXED BINARY INITIAL((2000)0),
      MAX_OCCURRENCES FIXED BINARY INITIAL(0),
      GRAND_TOTAL FIXED BINARY(31)INITIAL(0),
      TOTAL_OCCURRENCES FIXED BINARY(31)INITIAL(0),
      OVERFLOWS FIXED BINARY INITIAL(0);
0DECLARE
   01 ENTRY,
      02 DESCRIPTOR CHAR(32),
      02 FILL CHAR(8),
      02 (MAJOR,MINOR,TOTAL)PICTURE'(9)9';
0ON ENDFILE(DICT)EOF=1B;
0     READ FILE(DICT)INTO(ENTRY);
0     DO GRAND_TOTAL=0 BY 1 WHILE(^EOF);
         O=TOTAL;
         IF O>MAX_OCCURRENCES
              THEN MAX_OCCURRENCES=O;
         TOTAL_OCCURRENCES=TOTAL_OCCURRENCES+O;
         IF O>=100
              THEN O=TRUNC(O/100)+99;
         IF O<=HBOUND(HIST,1)
              THEN HIST(O)=HIST(O)+1;
              ELSE OVERFLOWS=OVERFLOWS+1;
         READ FILE(DICT)INTO(ENTRY);
      END;
0     PUT EDIT((I,HIST(I) DO I=1 TO 99))(SKIP,F(8),X(9),F(8));
      DO I=100 TO HBOUND(HIST,1);
         J=(I-99)*100;
         IF HIST(I)>0
              THEN PUT SKIP EDIT(J,':',J+99,HIST(I))(F(8),A,F(8),F(8));
      END;
0     IF OVERFLOWS>0
         THEN PUT SKIP DATA(OVERFLOWS,MAX_OCCURRENCES);
      PUT SKIP DATA(GRAND_TOTAL,TOTAL_OCCURRENCES);
0END HISTO;

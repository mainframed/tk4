 DOC:  PROCEDURE;  /*  QUANDRY PL/I DOCUMENTATION */
-$_EXTERNAL_PROCEDURES:  ;
0%INCLUDE EXTRTN,EXTRTN2,EXTRTN3,EXTRTN4;
1/*   QUANDRY IS IMPLEMENTED AS A NUMBER OF EXTERNAL PROCEDURES
 /*      COMMUNICATING THROUGH PARAMETERS AND EXTERNAL VARIABLES.
 /*      THE EXTERNAL PROCEDURES, THEIR FUNCTIONS (AND PRINCIPAL
 /*      EXTERNAL VARIABLES ARE:
0/*      CMPCHNG-EDIT PROGRAM TEXT FOR CHANGE AND COMPLETE STATEMENTS
 /*           (SBSTMTS, RETRANS)
 /*      CMPFLD-COMPILE FIELD STATEMENTS INTO MACHINE CODE
 /*           (OBJCODE,LITPOOL)
 /*      CMPLST-LIST AND EDIT THE PROGRAM TEXT FOR LIST, DELETE,
 /*           AND RETAIN STATEMENTS (SBSTMTS, RETRANS)
 /*      CMPOPT-SET VALUES FROM OPTIONS STATEMENTS
 /*           (OPT, SBOPT, PROPT, ENV)
 /*      CMPPRT-PROCESS PRINT AND NOPRINT STATEMENTS (PFLD)
 /*      CMPRD-PROCESS READ STATEMENTS, BUILDING A READ TREE (PHEAD)
 /*      EXSRCH-EXECUTE THE SEARCH FOR GO AND TALLY STATEMENTS
 /*      GETSTMT-RETURN THE NEXT STATEMENT TO BE PROCESSED
 /*      LSTDICT-LIST ACCESS KEYS FOR LISTDICT STATEMENTS
 /*      LSTOBJ-DUMP OBJECT CODE IN HEX (OBJCODE, LITPOOL)
 /*      LSTREE-PRINT THE READ STATEMENT TREE (PHEAD)
 /*      NEXTKEY-RETURN THE KEY OF THE NEXT RECORD IN FILE(ERIC)
 /*           SATISFYING THE READ KEY (PHEAD)
 /*      PRINT-PRINT AN ERIC RECORD (PROPT, PFLD)
 /*      PRTERR-PRINT DIAGNOSTIC MESSAGE
 /*      PRTITLE-PRINT HEADERS, BROADCAST INFORMATION, AND TIME
 /*      SBMIT-PROCESS SUBMIT STATEMENTS; ENTRY SBSAVE SAVES
 /*           STATEMENTS FOR SUBMISSION OR EDITING
 /*           (SBSTMTS, SBOPT)
 /*      SETTREE-REINITIALIZE THE READ STATEMENT TREE
 /*      TESTENV-SET SYSTEM DEPENDENT (BATCH, TSO) VALUES
 /*           (ENV, SBOPT, OPT)
 /*      TESTOBJ-ASSEMBLER ROUTINE TO BRANCH INTO OBJCODE TO TEST
 /*           ERIC RECORDS AGAINST FIELD STATEMENTS
 /*           (OBJCODE, LITPOOL, PERIC)
 /*      UNPACK-ASSEMBLER ROUTINE TO CONVERT RECORDS FROM FILE(ERIC)
 /*           FORMAT TO PRINTABLE FORM */
1$_FLOW_OF_CONTROL: ;
0/*   THE FOLLOWING TABLE MAY BE HELPFUL IN UNDERSTANDING THE
 /*      FLOW OF CONTROL BETWEEN MODULES, AND IS (MORE OR LESS)
 /*      ACCURATE:
 /*           01 QUANDRY,
 /*              02 COMPILE,
 /*                 03 CMPCHNG,
 /*                 03 CMPFLD,
 /*                 03 CMPLST,
 /*                 03 CMPOPT,
 /*                 03 CMPPRT,
 /*                 03 CMPRD,
 /*                 03 EXSRCH,
 /*                    04 NEXTKEY,
 /*                    04 PRINT,
 /*                    04 TESTOBJ OPTIONS(ASSEMBLER),
 /*                 03 LSTDICT,
 /*                 03 LSTOBJ,
 /*                 03 LSTTREE,
 /*                 03 PRTITLE,
 /*                 03 SBMIT,
 /*                 03 SBMIT.SBSAVE,   /* ENTRY POINT   */
 /*                 03 SETTREE,
 /*              02 GETSTMT,
 /*              02 GETSTMT.GTCLEAR,   /* ENTRY POINT   */
 /*              02 GETSTMT.GTRTRAN,   /* ENTRY POINT   */
 /*              02 PRTITLE,
 /*              02 TESTENV;
0/*   PRTERR MAY BE CALLED FROM ALMOST ANYWHERE TO PRINT AN
 /*      ERROR MESSAGE
 /*   NORMAL FLOW OF CONTROL IS DESCRIBED IN THE COMMENTS
 /*      AT THE BEGINNING OF QUANDRY AND COMPILE.  THE SOURCE
 /*      FOR QUANDRY  SHOULD ALSO PROBABLY BE READ.
 /*   ERROR HANDLING MODIFIES THE NORMAL FLOW OF CONTROL.  THE
 /*      STANDARD TECHNIQUE FOR ERROR HANDLING IS TO RAISE
 /*      CHECK(ERRCODE).  THE CHECK ON-UNIT IN QUANDRY CALLS
 /*      PRTERR (WHICH ISSUES ALL QUANDRY DIAGNOSTICS) AND RAISES
 /*      THE QERROR CONDITION.  THE QERROR ON-UNIT EXITS THE ROUTINE
 /*      IN WHICH THE ERROR OCCURRED BY BRANCHING DIRECTLY TO
 /*      QUANDRY TO ATTEMPT RECOVERY.  ROUTINES CAN PORVIDE THEIR
 /*      OWN ERROR HANDLERS (WHICH SHOULD CALL PRTERR FOR ANY
 /*      MESSAGES) AND CAN CALL SIGNAL QERROR DIRECTLY TO INVOKE
 /*      RECOVERY.  (RECOVERY IS USUALLY INVOKED ONLY FOR ERRORS IN
 /*      USER INPUT.  MOST ERRORS IN QUANDRY ITSELF ARE TRAPPED IN
 /*      AN ERROR ON-UNIT AND EVENTUALLY RAISE FINISH. */
1$_EXTERNAL_VARIABLES:  ;
0%INCLUDE EXTVAR,EXTVAR2;
0/*   THE PRINCIPAL EXTERNAL VARIABLES USED BY QUANDRY AND THEIR
 /*      FUNCTIONS ARE:
0/*      ENV.BATCH-SET BY TESTENV WHEN RUNNING IN BATCH.  MAY BE
 /*           MODIFIED BY CMPOPT
 /*      ENV.TSO-SET BY TESTENV WHEN RUNNING UNDER TSO.  MAY BE
 /*           MODIFIED BY CMPOPT
 /*      ERRCODE-SET WITH AN ERROR CODE TO RAISE CHECK(ERRCODE) AND
 /*           THEREBY INITIATE DIAGNOSTIC AND RECOVERY PROCESSING.
 /*           USED BY PRTERR TO ISSUE THE APPROPRIATE MESSAGE
 /*      LITPOOL-POOL AL ALL CHARACTER STRINGS FOUND IN FIELD
 /*           STATEMENTS.  BUILT BY CMPFLD, USED BY LSTOBJ AND BY
 /*           MACHINE CODE EXECUTING UNDER TESTOBJ
 /*      OBJCODE-MACHINE LNAGUAGE REPRESENTATION OF FIELD STATEMENTS.
 /*           BUILT BY CMPFLD AND COMPILE, EXECUTED UNDER CONTROL OF
 /*           THE ASSEMBLER ROUTINE TESTOBJ.
 /*      PERIC-POINTER TO THE BUFFER CONTAINING THE CURRENT ERIC RECORD.
 /*           SET BY EXSRCH FOR TESTOBJ.
 /*      PHEAD-POINTER TH THE ROOT OF THE READ STATEMENT TREE. USED
 /*           MAINLY BY COMPILE, CMPRD, AND NEXTKEY.
 /*      PLIXOPT-DEFAULT EXECUTION-TIME OPTIONS (ISA(36K))
 /*      QERROR-CONDITION RAISED IN THE STANDARD QUANDRY ON-UNIT FOR
 /*           CHECK(ERRCODE) AND OTHER ERROR HANDLERS TO INITIATE
 /*           ERROR RECOVER.
 /*      SBSTMTS-CONTAINS SAVED STATEMENTS.  SUBMITTED BY SBMIT,
 /*           EDIT BY CMPCHNG AND CMPLST, AND TRANSFERRED TO THE
 /*           INCOMING STATEMENT BUFFER BY GTRTRAN TO SUPPORT
 /*           RETRANSLATION.  CLEARED BY COMPILE WHEN A READ
 /*           STATEMENT IS ENCOUNTERED.
 /*      SCANPTR-INDEX TO THE POSITION IN THE STATEMENT STRING
 /*           CURRENTLY BEING EXAMINED BY A STATEMENT TRANSLATOR.
 /*           PASSED TO PRTERR FOR USE IN THE 'ERROR DETECTED NEAR'
 /*           DIAGNOSTIC MESSAGE. */
1$_EXTERNAL_OPTION_VARIABLES:  ;
0%INCLUDE DCLOPT,DCLSBOPT,DCLPROPT;
1/*   QUANDRY OPTIONS ARE CLASSIFIED AS MISCELLANEOUS OPTIONS,
 /*      PRINT OPTIONS, AND SUBMIT OPTIONS.  THE VALUES OF THESE
 /*      OPTIONS ARE KEPT IN THE THREE EXTERNAL STRUCTURES
 /*      OPT (IN MEMBER DCLOPT), PROPT (DCLPROPT), AND SBOPT
 /*      (DCLSBOPT).  THESE VARIABLES ARE INITIALIZED TO BATCH
 /*      VALUES WHICH MAY BE MODIFIED FOR TSO BY TESTENV.
 /*      CMPOPT, THE OPTIONS STATEMENT PROCESSOR, CAN RESET
 /*      ALL OPTIONS AND THE ENVIRONMENT STRUCTURE ENV.
 /*      THE OPTIONS ARE:
0/*      OPT.CHANGE-CHANGE STATEMENT MAY BE USED; INCORRECT
 /*           STATEMENTS ARE TO BE SAVED IN SBSTMTS
 /*      OPT.CONTROL-PASSWORD WHICH MUST BE SPECIFIED TO USE
 /*           CERTAIN RESTRICTED OPTIONS, DOCUMENTED IN CMPOPT
 /*      OPT.PRINTLIM-MAXIMUM NUMBER OF RECORDS WHICH WILL BE
 /*           PRINTED FOR A SINGLE SEARCH
 /*      OPT.READLIM-MAXIMUM NUMBER OF RECORDS WHICH WILL BE
 /*           READ FROM FILE(ERIC) FOR A SINGLE SEARCH
 /*      OPT.READSIZE-SIZE OF THE AREA IN WHICH THE READ STATEMENT
 /*           TREE IS CONSTRUCTED
 /*      PROPT.COLUMN-COLUMN IN WHICH THE LISTING OF ERIC RECORDS
 /*           IS TO BEGIN
 /*      PROPT.LINESIZE-SIMULATED LINESIZE (RIGHT MARGIN - LEFT
 /*           MARGIN + 1) FOR THE LISTING OF ERIC RECORDS
 /*      PROPT.PAGENUM-PAGE NUMBER OF THE NEXT PAGE TO BE PRINTED
 /*      PROPT.PAGESIZE-PAGESIZE OF THE ERIC LISTING (>=59)
 /*      PROPT.SEARCH-NUMBER TO BE PRINTED ON EACH PAGE OF THE
 /*           SEARCH OUTPUT AS AN IDENTIFIER
 /*      PROPT.SKIP-LINES SKIPPED BETWEEN ERIC RECORDS
 /*      PROPT.SPACE-SPACING (SINGLE, DOUBLE, ETC.) FOR ERIC RECORDS
 /*      SBOPT.ACCT-ACCOUNT CODE FOR SUBMITTED JOB, INITIALIZED
 /*            IN TESTENV FROM THE JOBNAME (TSO USERID)
 /*      SBOPT.BIN-BIN NUMBER FOR SUBMITTED JOB
 /*      SBOPT.FORMS-FORMS FOR PRINTING SUBMITTED JOB
 /*      SBOPT.JOBNAME-JOBNAME FOR SUBMITTED JOB
 /*      SBOPT.LINES-CHARACTER STRING FOR THE HASP LINES= PARAMETER.
 /*           THE AUBURN HASP INTERPRETS THIS AS LINES, NOT
 /*           1000 LINES, AND SUPPORTS NNNK FORMAT FOR THOUSANDS
 /*      SBOPT.REMOTE-REMOTE ROUTING FOR SUBMITTED JOB
 /*      SBOPT.TIME-HASP EXECUTION TIME FOR SUBMITTED JOB.
 /*           THE AUBURN HASP INTERPRETS THIS AS MINUTES AND
 /*           SECONDS OF CPU TIME (MMSS), NOT CLOCK TIME
 /*      SBOPT.USERID-USERID FOR NOTIFICATION AT END OF
 /*           SUBMITTED JOB */
1$_FILES:  ;
0%INCLUDE FILES;
-/*   THE FILES USED BY QUANDRY ARE:
0/*      ERIC-ACTUAL CITATIONS IN PARTIALLY COMPRESSED FORM
 /*      INDX-ISAM FILE KEYED ON ACCESS KEYS; POINTS INTO FILE(MAP)
 /*      MAP-REGIONAL FILE OF SEQUENCES OF OCCURRENCES IN
 /*           IN FILE(ERIC) OF AN ACCESS KEY
 /*      SUBMIT-JCL AND QUANDRY STATEMENTS CONSTRUCTED FOR SUBMIT
 /*      SYSIN-QUANDRY STATEMENTS INPUT BY USER
 /*      SYSOUT-LISTING OF CITATIONS FOUND
 /*      SYSPRINT-MESSAGES TO USER AND ALL OUTPUT EXCEPT CITATIONS
0/*   MEMBER CMPRD CONTAINS MORE INFORMATION ON ERIC, MAP, AND
 /*      INDX.  THE FORMAT OF RECORDS IN THESE FILES IS
 /*      DESCRIBED BELOW. */
1$_FORMAT_OF_INDX_RECORD:  ;
0%INCLUDE DCLINDX;
-/*   THE FIELDS IN AN INDEX ENTRY ARE:
0/*      DESCRIPTOR-KEY FIELD; CORRESPONDS TO A DESCRIPTOR OR
 /*           IDENTIFIER, PREFIXED WITH '*' IF MAJOR
 /*      MAP_KEY-KEY OF THE RECORD IN FILE(MAP) WHICH CONTAINS
 /*           THE BEGINNING OF A SEQUENCE OF OCCURRENCES OF
 /*           DESCRIPTOR IN FILE(ERIC)
 /*      MAP_SUBSCRIPT-SUBSCRIPT IN THE MAP RECORD WHERE THE
 /*           SEQUENCE BEGINS
 /*      RECORD_COUNT-NUMBER OF ENTRIES IN THE SEQUENCE
 /*           (EXCLUDING THE END-OF-SEQUENCE INDICATOR) */
1$_FORMAT_OF_MAP_RECORDS:  ;
0/*   DECLARE ERIC_KEY(42) FIXED BINARY(31); */
0%INCLUDE DCLHIGH; /* INCLUDE MAP RECORD */
-/*   MAP CONSISTS OF SORTED SEQUENCES OF OCCURRENCES IN
 /*      FILE(ERIC) OF A DESCRIPTOR IN FILE(INDX).  SEQUENCES
 /*      BEGIN AT THE SUBSCRIPT SPECIFIED IN FILE(INDX) AND
 /*      CONTINUE THROUGH AS MANY MAP ENTRIES AS ARE NEEDED.
 /*      A VALUE OF HIGH_KEY IS ADDED TO TERMINATE THE SEQUENCE.
 /*   EACH ENTRY IS AN ENCODED KEY INTO FILE(ERIC).  THE
 /*      LAST 16 BITS CONTAIN THE NUMERIC VALUE OF THE RECORDED
 /*      CHARACTER KEY ('001' FOR THE FIRST RECORD ON THE TRACK,
 /*      ETC.).  THE FIRST 16 BITS CONTAIN THE TRACK NUMBER OF
 /*      THE RECORD IN FILE(ERIC) AS A FIXED BINARY(15) NUMBER.
 /*      THIS LIMITS THE SIZE OF FILE(ERIC) TO 32768 TRACKS. */
1$_FORMAT_OF_ERIC_RECORDS:  ;
0%INCLUDE DCLERIC;
0/*   ERIC CONSISTS OF REFORMATED AND PARTIALLY COMPRESSED
 /*      CITATIONS BUILT BY THE ASSEMBLER ROUTINE COMPACT
 /*      FROM THE STANDARD E.R.I.C. TAPES.  EACH RECORD IS
 /*      PRECEDED BY A THREE BYTE EBCDIC KEY: '001' FOR THE
 /*      FIRST RECORD ON A TRACK, '002' FOR THE SECOND, AND
 /*      SO FORTH.
 /*   THE FIELDS IN AN ERIC RECORD ARE:
0/*      DATA-THE STRING CONTAINING THE COMPACTED CITATION.
 /*           THE FIELDS OF THE CITATION OCCUR IN STANDARD
 /*           ERIC SEQUENCE (SEE MEMBER CMPFLD), WITH NO
 /*           INDICATION OF MISSING FIELDS AND NO SEPARATORS.
 /*           SOME FIELDS ARE IN A 6-BIT CODE RATHER THAN EBCDIC.
 /*      DATA_LENGTH-THE LENGTH OF THE DATA STRING
 /*      OFFSETS-THE OFFSET OF THE BEGINNING OF EACH FIELD
 /*           IN DATA FROM THE BEGINNING OF THE RECORD.
 /*           OFFSET(I+1)-OFFSET(I) IS THE LENGTH OF FIELD(I).
 /*           OFFSET(I+1)-OFFSET(I)=0 MEANS FIELD(I) IS ABSENT.
 /*           OFFSET(15) POINTS 1 BYTE BEYOND THE LAST FIELD
 /*      RECNO-THE RECORD NUMBER OF THE RECORD ON ITS TRACK;
 /*           EQUAL TO THE RECORDED KEY
 /*      RECORD_LENGTH-THE LENGTH OF THE RECORD EXCLUSIVE OF
 /*           THIS FIELD; USED BY ROUTINES WHICH CONSIDER THE
 /*           RECORD AS A PL/I VARYING STRING
 /*      TRACK-THE TRACK PORTION OF THE PL/I RECORD KEY */
0END DOC;

 CHKSEQ:  PROCEDURE OPTIONS(MAIN);
0DECLARE
      (INDEX,LENGTH,SUBSTR)BUILTIN,
      TAPE RECORD INPUT ENV(VB RECSIZE(8000) BLKSIZE(13030) TOTAL),
      V CHAR(8000)VARYING,
      P9 PICTURE'999999',
      PX PICTURE'XXXXXX' DEFINED P9,
      (RECNO,PREVIOUS,CURRENT,FIRST,LAST)FIXED BINARY(31),
      EOF BIT(1)STATIC INITIAL(0B);
0ON ENDFILE(TAPE)EOF=1B;
0     RECNO=1;
      READ FILE(TAPE)INTO(V);
      FIRST,PREVIOUS=SUBSTR(V,7,6);
      PUT SKIP LIST(SUBSTR(V,1,20),LENGTH(V),INDEX(V,'163351'));
      PUT DATA(FIRST);
      READ FILE(TAPE)INTO(V);
      DO RECNO=1 BY 1 WHILE(^EOF);
         PX=SUBSTR(V,7,6);
         CURRENT=P9;
         IF CURRENT^=PREVIOUS-1
              THEN PUT SKIP DATA(CURRENT,PREVIOUS,RECNO);
         PREVIOUS=CURRENT;
         READ FILE(TAPE)INTO(V);
      END;
      LAST=CURRENT;
      PUT DATA(RECNO,LAST);
0END;

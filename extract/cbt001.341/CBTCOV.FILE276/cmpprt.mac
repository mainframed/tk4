 (CHECK(ERRCODE)):  CMPPRT:  PROCEDURE(STTYPE,STMT,SAVE)REORDER;
 %INCLUDE DCLSTMT;
0DECLARE
      SAVE BIT(1)ALIGNED;
 %INCLUDE EXTVAR,EXTRTN;
1%INCLUDE DCLPARM,DCLPFLD,SYSPRINT;
0DECLARE
      HBOUND BUILTIN,
      PRINT_SWITCH BIT(1)STATIC ALIGNED,
      ALL BIT(1)AUTOMATIC INITIAL(0B),
      I FIXED BINARY(31),
      IER FIXED BINARY(31),
      NAME CHAR(12)STATIC;
1/*   CMPPRT IS CALLED TO COMPILE PRINT AND NOPRINT STATEMENTS.
 /*      CALLING ARGUMENTS ARE STTYPE ('PRINT' OR 'NOPRINT')
 /*           AND STMT, WHERE THE FORM OF STMT IS
 /*                (NO)PRINT FIELD_LIST#
 /*           WHERE FIELD_LIST BEGINS IN COLUMN 7 FOR PRINT
 /*           STATEMENTS AND COLUMN 9 FOR NOPRINT STATEMENTS
 /*           AND CONSISTS OF FIELD NAMES SEPARATED BY BLANKS OR
 /*           COMMAS, AND SAVE, WHICH MUST BE SET TO INDICATE
 /*           WHETHER SAVE WAS SPECIFIED.
 /*      THE STATEMENT IS SCANNED BY THE GENERAL PURPOSE
 /*           ROUTINE SCNPARM AND THE TOKENS ARE STORED IN THE
 /*           ARRAY PARM OF STRUCTURES.  AT PRESENT, THERE ARE
 /*           NO PARAMETERS WITH VALUES (SUBPARMS).
 /*      THE NAMES IN PARM ARE USED TO SET BITS IN THE EXTERNAL
 /*           ARRAY PFLD.  PRINT WILL USE THIS ARRAY TO DETERMINE
 /*           WHICH FIELDS TO PRINT.
 /*      CMPPRT DOES NOT USE THE STANDARD ERROR INTERFACE.
 /*           ERRORS ARE TRAPPED AND A MESSAGE IS ISSUED
 /*           THROUGH THE PRTERR SUBROUTINE.  THE REMAINDER
 /*           OF THE STATEMENT IS PROCESSED RATHER THAN BEING
 /*           DISCARDED.  THIS MEANS THAT ONLY THE INCORRECT
 /*           FIELDS NEED BE REENTERED. */
1ON CHECK(ERRCODE)(NOCHECK(ERRCODE)):  CALL PRTERR(STMT,ERRCODE);
0     SAVE=0B; /* ASSUME SAVE NOT SPECIFIED */
0     IF STTYPE='PRINT     '
         THEN DO;
              PRINT_SWITCH='1'B;
              PFLD(*)='0'B;
              SCANPTR=7;
         END;
         ELSE DO; /* NOPRINT */
              PRINT_SWITCH='0'B;
              PFLD(*)='1'B;
              SCANPTR=9;
         END;
0     CALL SCNPARM(STMT,PARM,NUMBER_OF_PARMS,IER);
0     DO I=1 TO NUMBER_OF_PARMS;
         SCANPTR=PARM.SCANPTR(I);
         NAME=PARM.NAME(I); /* COPYING OVER REDUCES SIZE OF OBJ PGM */
         IF PARM.SUBPARMS(I)
              THEN ERRCODE=12015; /* CHECK THIS OUT AND ADD CODE 10 */
              ELSE CALL SET_PARM;
         SELECT(NAME);
              WHEN('ALL         ')ALL=1B;
              WHEN('SAVE        ')SAVE=1B;
              OTHERWISE;
         END;
      END;
0     IF ALL
         THEN PFLD(*)=PRINT_SWITCH;
1SET_PARM:  PROCEDURE;
0DECLARE
      VALID_FIELD_TYPES(16)CHAR(10)STATIC INITIAL(
         'ACCNUM','CHNUM','DATE','TITLE','AUTHOR',
         'DESCRIPTOR','IDENTIFIER','NOTE','ISSUE','ABSTRACT',
         'AVAIL','JOURNAL','INST','SPONSOR',
         'ALL','SAVE');
         /* THIS LIST IS CONSTRUCTED FROM THE STRING OF THE SAME
         /* NAME IN COMPILE AND MUST APPEAR IN THE SAME ORDER.
         /* 'ALL' AND 'SAVE' MUST BE ADDED AT THE END. */
0DECLARE
      I FIXED BINARY;
0     DO I=1 TO HBOUND(VALID_FIELD_TYPES,1)
         WHILE(NAME^=VALID_FIELD_TYPES(I));
      END;
0     IF I<=HBOUND(VALID_FIELD_TYPES,1)
         THEN PFLD(I)=PRINT_SWITCH;
         ELSE ERRCODE=12115;
 END SET_PARM;
0END CMPPRT;

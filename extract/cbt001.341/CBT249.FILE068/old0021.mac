++USERMOD(BF00021).
++VER (Z038) FMID(HOZ1202)  /*
    THIS MODIFICATION IMPLEMENTS THE BATCH ACCESS OF INFO/MGMT WHICH
    WAS OMITTED BY IBM IN ITS DEVELOPMENT.  THE FUNCTIONS ARE:
       1. ELIMINATE CHECK FOR SCREEN SIZE IN BLGI2TI.
       2. ON ANY FORCED TGET RESPOND IF PANEL IS NOT IN TABLE RESPOND
          WITH ';PR S U,2,INFORPT'. IF PANEL IS IN TABLE THEN DO A
          GETLINE MACRO AND PUT REPLY BACK INTO BUFFER.  IF GETLINE
          RETURNS ERROR OR EOF THEN REPLY WITH ';QUIT'.  THE TABLE IS
          AS OF NOW:
                         BLG1M234 (PRINT COMPLETE)
                         BLG1M212 (REPORT COMPLETE)
                         BLG1M410 (PURGE VERIFICATION)
    */.
++ZAP (BLGI2TI).
  NAME   BLGI2TI
*
**    THIS ZAP TURNS OFF THE GTSIZE CHECK FOR ATLEAST 3270 SCREEN
**    SIZE
*
  VER A0 4740        TEST FOR # ROWS < 24
  REP A0 4700        IGNORE TEST
  VER A8 47B0        TEST FOR # COLS >= 80
  REP A8 47F0        MARK ALWAYS TRUE
++ZAP (BLGI2TRW).
  EXPAND BLGI2TRW(324)
  NAME    BLGI2TRW
*
**    THIS ZAP RETURNS THE STRING ';PR S U,2,INFORPT' ON ANY TGET WITH
**    RETURNED BUFFER LENGTH IS ZERO, UNLESS THE SCREEN IS BLG1M234
**    OR BLG1M212 OR BLG1M410
*
  VER 0578 5840,B054     TEST FOR ORIGINAL INST
  VER 0650 0000,0120     TEST FOR ORIGINAL AREA LENGTH
  VER 0688 0000          TEST FOR NEW PATCH AREA
  REP 0578 47F0,C66C        B  PATCH AREA
  REP 0650 0000,013C     TEST FOR ORIGINAL AREA LENGTH
  REP 0688 5840,B054        L 4,84(11)      ACCESS TBUF (OVERLAID IN)
  REP 068C 1266             LTR 6,6         LENGTH ZERO?
  REP 068E 4770,C560        BNZ RETURN      IF NOT THEN RETURN
  REP 0692 5810,5004        L 1,4(5)        CYCLE THROUGH
  REP 0696 5820,1000        L 2,0(1)           BLOCKS TO GET
  REP 069A 5830,2008        L 3,8(2)             INPUT BUFFER OF SCREEN
  REP 069E D20A,3000,C76C * MVC 0(11,3),A   MOVE IN 'QUIT' RESPONSE
  REP 06A4 4160,000B        LA 6,11         SET LENGTH OF 'QUIT'
  REP 06A8 BFFF,4010        ICM 15,15,16(4) GET OUT BUF ADDR
  REP 06AC 4780,C560        BZ RETURN       IF ZERO SKIP
  REP 06B0 D507,F01E,C788   CLC 30(8,15),ENTER IS THIS BLG0ENTR
  REP 06B6 4780,C6CA        BE  GET         IF SO THEN CONSIDER IN TAB
  REP 06BA 41E0,C790        LA  14,TABLE    POINT AT TABLE
  REP 06BE 9500,E000   LOOP CLI 0(14),0     END OF TABLE?
  REP 06C2 4780,C6BC        BE  PRINT       YES SO PRINT SCREEN
  REP 06C6 D507,F016,E000   CLC 22(8,15),0(14) CHECK AGAINST TABLE
  REP 06CC 4780,C6CA        BE GET          IF FOUND THEN DO GETLINE
  REP 06D0 41E0,E008        LA 14,8(14)     GET NEXT ENTRY
  REP 06D4 47F0,C6A2        B   LOOP        TRY AGAIN
*
**     PUT ';PR S U,2,INFORPT' COMMAND IN BUFFER
*
  REP 06D8 4160,0017  PRINT LA 6,23         SET LENGHT OF 'PRINT'
  REP 06DC D20F,3007,C777 * MVC 7(16,3),D   MOVE IN 'PRINT'
  REP 06E2 47F0,C560        B  RETURN       ALL DONE
*
**     DO GETLINE MACRO AND PUT RESPONSE IN BUFFER
*
  REP 06E6 5810,2004  GET   L  1,4(2)       SET R1->CPPL
  REP 06EA 58E0,1004        L  14,4(1)      GET UPT ADDR
  REP 06EE 58F0,100C        L  15,12(1)     GET ECT ADDRE
  REP 06F2 4110,B120        LA  1,IOPL      GET ADDR OF WORKAREA
  REP 06F6 50E0,1000        ST 14,0(1)      SAVE ADDR OF UPT
  REP 06FA 50F0,1004        ST 15,4(1)      SAVE ADDR OF ECT
  REP 06FE 41E0,B138        LA  14,ECB      POINT AT ECB
  REP 0702 50E0,1008        ST  14,8(1)     SAVE ADDR OF ECB
  REP 0706 41E0,B130        LA  14,GTPB     POINT AT GTPB
  REP 070A 50E0,100C        ST  14,12(1)    SAVE ADDR OF GTPB
  REP 070E D707,B130,B130   XC  GTPB(8),GTPB
  REP 0714 9280,B132        MVI GTPB+2,X'80'  SET FLAGS
  REP 0718 58F0,0010        L   15,16       GET CVT ADDR
  REP 071C 9180,F15C        TM  348(15),X'80'  IS GETLINE LOADED
  REP 0720 47E0,C712        BNO IKJ@0001    NO BRANCH TO LINK
  REP 0724 58F0,F15C        L   15,348(15)  YES BALR TO GETLINE
  REP 0728 05EF             BALR 14,15      DO GETLINE
  REP 072A 47F0,C72A        B   IKJ$0001    ALL DONE
  REP 072E 0700      IKJ@0001 NOPR 0
  REP 0730 45F0,C728        BAL 15,*+20   BRANCH AROUND CONSTANTS
  REP 0734 0000,0000        DC  A(*+8)      CANT ZAP RELO ADDR
  REP 0738 0000,0000        DC  F'0'        DCB ADDR PARM
  REP 073C C9D2,D1C7,C5E3,D340     DC C'IKJGETL'
  REP 0744 0000  0A06       SVC 6
  REP 0746 59F0,C768 IKJ$0001 C  15,MARC    CHECK RETURN CODE
  REP 074A 4720,C560        BH  RETURN      RETURN IF BAD
  REP 074E 58F0,B134        L   15,GTPB+4   GET ADDR OF BUFFER
  REP 0752 4810,F000        LH  1,0(15)     GET LENGTH OF BUFFER
  REP 0756 5B10,C768        S   1,MARC      CHECK LENGTH >4
  REP 075A 47D0,C560        BNP RETURN      THEN RETURN QUIT
  REP 075E 0610             BCTR  1,0       GET MACHINE LENGTH
  REP 0760 4410,C760        EX   1,MOVEIT   MOVE IN DATA
  REP 0764 4160,1007        LA   6,7(1)     MOVE IN LENGTH
  REP 0768 181F             LR   1,15       MOVE IN DATA
  REP 076A 4800,1000        LH   0,0(1)     GET LENGTH
  REP 076E BF08,C787        ICM  0,8,SUBPOOL GET SUBPOOL VALUE
  REP 0772 4110,1000        LA   1,0(1)     CLEAR TOP BYTE
  REP 0776 0A0A             SVC  10         FREE RESPONSE
  REP 0778 47F0,C560        B    RETURN     AND RETURN
  REP 077C D200,3006,F004 MOVEIT MVC 6(0,3),4(15)  MOVE IN DATA
  REP 0784 0000,0004   MARC DC   F'4'       CHECK FOR RC AND LEN
  REP 0788 7D5C,F711,5CF6,5ED8  A  DC X'7D5CF7115CF6',C';QUIT'
  REP 0790 E4C9,E3
  REP 0793 D7D9,40E2,40E4,6BF2  D  DC C'PR S U,2,INFORPT'
  REP 079B 6BC9,D5C6,D6D9,D7E3
  REP 07A3 01                   SUBPOOL DC X'01'
  REP 07A4 C2D3,C7F0,C5D5,E3D9  ENTER    DC  C'BLG0ENTR'   MAIN MENU
  REP 07AC C2D3,C7F1,D4F2,F3F4  TABLE    DC  C'BLG1M234'   PRINT END
  REP 07B4 C2D3,C7F1,D4F2,F1F2           DC  C'BLG1M212'   REPORT END
  REP 07BC C2D3,C7F1,D4F4,F1F0           DC  C'BLG1M410'   PURGE VERIFY
  REP 07C4 0000,0000,0000,0000           DC  XL8'00'  END OF TABLE

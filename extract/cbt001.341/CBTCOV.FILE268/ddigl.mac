      SUBROUTINE  DDIGL (X0,Y0,X1,Y1,VISBLE)
C
C     MODIFIED FOR USE WITH ABE
C
C     CALLS DDIIL
C
C     (GENERATE LINE)
C     GENERATE A LINE BETWEEN POINTS (X0,Y0) AND (X1,Y1).
C     THIS ROUTINE TAKES CARE OF THE BOOKKEEPING FOR DDIHL
C     AND ENSURES THAT AN ADDITIONAL SEGMENT WILL BE DRAWN
C     FROM THE PREVIOUS POSITION TO (X0,Y0) IF THESE ARE
C     NOT THE SAME.  HOWEVER, VISIBILITY CONTROL IS LEFT ENTIRELY
C     TO DDIHL.
C
      INTEGER          IFIX,        MX0,         MX1,         MY0
      INTEGER          MY1,         ROUND
      LOGICAL          VISBLE
      REAL             ARG,         FLOAT,       SIGN,        X0
      REAL             X1,          Y0,          Y1
C
      INCLUDE (DDI01)
C
      ROUND(ARG) = IFIX(ARG + SIGN(0.5,ARG))
      IF (.NOT.VISBLE) GO TO 10
C
C     DRAW A LINE SEGMENT FROM (X0,Y0) TO (X1,Y1).
C
      MX0 = ROUND(SX*X0) + 1
      MY0 = ROUND(SY*Y0) + 1
      MX1 = ROUND(SX*X1) + 1
      MY1 = ROUND(SY*Y1) + 1
      CALL DDIIL (MX0,MY0,MX1,MY1,VISBLE)
   10 RETURN
      END

      SUBROUTINE  DDIIT (T)
C
C     MODIFIED FOR USE WITH ABE
C
C     CALLS MATRS,ERRMS,ERRAR,ERRCK
C
C     (IMAGE TRANSFORMATION)
C     SUPPLY A 4-D IMAGE TRANSFORMATION TO BE APPLIED TO 3-D POINTS.
C     T(*,*) MAY BE QUITE GENERAL, EXCEPT THAT THE LAST COLUMN IS
C     ASSUMED TO BE (0,0,0,1), SO THAT PERSPECTIVE IMAGE TRANSFORMATIONS
C     AND GLOBAL COORDINATE SCALINGS ARE NOT SUPPORTED.  THE
C     TRANSFORMATION WILL BE EXAMINED TO VERIFY THAT IT DOES NOT
C     MAP THE UNIT SQUARE OUT OF ITSELF.  IF IT DOES, IT WILL BE
C     APPROPRIATELY SCALED TO ENSURE INTEGRITY OF THE UNIT SQUARE,
C     AND A WARNING MESSAGE WILL BE ISSUED.
C
      INTEGER          I,           J
      REAL             T(4,4)
C
      INCLUDE (DDI01)
C
      IMAGE = .TRUE.
      CALL MATRS (TIMAGE,T)
      DO 20 J = 1,4
           DO 10 I = 1,4
           IF (T(I,J) .NE. (T(I,J) - (TIMAGE(I,J)-T(I,J)))) GO TO 30
   10      CONTINUE
   20 CONTINUE
      GO TO 40
   30 CALL ERRMS (6HDDIIT ,4,
     X       50HIMAGE TRANSFORMATION OUT OF UNIT SQUARE - RESCALED,50)
      CALL ERRAR (6HT     ,1,T,16)
      CALL ERRAR (6HTIMAGE,0,TIMAGE,16)
      CALL ERRCK
   40 RETURN
      END

-
-
-
-
 /********************************************************************/
 /*                                                                  */
 /*                  *                            *******            */
 /*                * *                           *     *             */
 /*              *   *                          *     *              */
 /*            *     ***************************     *               */
 /*          *                                      *                */
 /**/       PROCEDURE    (PRM) OPTIONS(MAIN);   /* *                 */
 /*          *                                      *                */
 /*            *     ***************************     *               */
 /*              *   *                          *     *              */
 /*                * *                           *     *             */
 /*                  *                            *******            */
 /*                                                                  */
 /*                                                                  */
 /********************************************************************/
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*           _______________        _______________                  */
+/*           S Y S E V E N T        A N A L Y S I S                  */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*           _____________          ___________                      */
+/*           P R O G R A M          D R I V E R                      */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*  FUNCTION:                                                        */
 /*                                                                   */
 /*                                                                   */
 /*  THE SYSEVENT PROGRAM SUPPLIED HERIN  IS DESIGNED TO SERVE AS     */
 /*                                                                   */
 /*  A BASE FOR DEVELOPMENT OF ANALYSIS ROUTINES FOR THE EXAMINATION  */
 /*                                                                   */
 /*  OF SYSEVENT TRACES PRODUCED BY MVS GTF.                          */
 /*                                                                   */
 /*  THE GTF RUN USED TO COLLECT DATA FOR THIS PROGRAM MUST           */
 /*                                                                   */
 /*  SPECIFY  " PARM="MODE=EXT,DEBUG=NO,TIME=YES"  "  ON THE          */
 /*                                                                   */
 /*  EXECUTE CARD OF THE GTF PROC                                     */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                  JOHN A. CHAPMAN  */
 /*                                                  JUNE,      1974  */
 /*                                                  CHICAGO  CENTER  */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*   D R I V E R       P R O G R A M       S E R V I C E S           */
 /*                                                                   */
 /*   THIS DRIVER PROGRAM PROVIDES BASIC SERVICES TO THE USER         */
 /*   ANALYSIS ROUTINE :                                              */
 /*                                                                   */
 /*   RUN CONTROL.                                                    */
 /*                                                                   */
 /*   THE DRIVER SUPPORTS SPECIFICATION OF CONTROL INFORMATION        */
 /*   FOR THE RUN FROM THE "EXEC" CARD PARM FIELD AND FROM THE        */
 /*   --SYSPARM-- DD INPUT DATASET.  SYNTAX RULES FOR "PARM="         */
 /*   AND SYSPARM DD * ARE THE SAME:                                  */
 /*                                                                   */
 /*   SYNTAX:                                                         */
 /*                                                                   */
 /*   ONLY ALPHABETIC, NUMERIC, AND THE SPECIAL CHARACTERS            */
 /*        EQUALS = QUOTE '' COMMA , AND PARENTHESIS ()               */
 /*   ARE LEGAL IN THE PARMETER INPUT.                                */
 /*                                                                   */
 /*   ONLY COLUMNS 1 THRU 72 ARE INCLUDED FROM THE "SYSPARM"          */
 /*   INPUT STREAM.                                                   */
 /*                                                                   */
 /*   MORE THAN ONE CARD CAN BE USED TO SUPPLY "SYSPARM" INPUT.       */
 /*   COLUMNS 1 THROUGH 72 OF ALL CARDS IN THE INPUT STREAM           */
 /*   ARE CONCATENATED INTO A SINGLE CHARACTER STRING.  MULTIPLE      */
 /*   BLANKS ARE COMPRESSED TO A SINGLE BLANK.  THE RESULTING         */
 /*   STRING MUST COMPLY WITH THE RESTRICTIONS FOR THE USE OF         */
 /*   "GET STRING DATA" AND GET STRING LIST" AS DESCRIBED IN          */
 /*   THE PL/1 OPTIMIZING COMPILER MANUALS.                           */
 /*                                                                   */
 /*   OPERANDS:                                                       */
 /*                                                                   */
 /*   ALL PARAMETER (RUN CONTROL) OPERANDS ARE KEYWORD-WITH-DATA-     */
 /*   LIST:                                                           */
 /*                                                                   */
 /*        JOBNAME=                                                   */
 /*        ASIDS=                                                     */
 /*        INCLUDE=                                                   */
 /*        EXCLUDE=                                                   */
 /*        OPTIONS=                                                   */
 /*        DRIVER=                                                    */
 /*                                                                   */
 /*   IN ALL CASES, THE "DATA-LIST" MUST BE A QUOTED STRING.          */
 /*                                                                   */
 /*   OPERANDS MAY BE SPECIFIED IN ANY ORDER.                         */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*   D R I V E R       P R O G R A M       S E R V I C E S           */
 /*                                                                   */
 /*   THIS DRIVER PROGRAM PROVIDES BASIC SERVICES TO THE USER         */
 /*   ANALYSIS ROUTINE :                                              */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*   D R I V E R       P R O G R A M       S E R V I C E S           */
 /*                                                                   */
 /*   THIS DRIVER PROGRAM PROVIDES BASIC SERVICES TO THE USER         */
 /*   ANALYSIS ROUTINE :                                              */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*   D R I V E R       P R O G R A M       S E R V I C E S           */
 /*                                                                   */
 /*   THIS DRIVER PROGRAM PROVIDES BASIC SERVICES TO THE USER         */
 /*   ANALYSIS ROUTINE :                                              */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*   SUPPORTED VARIABLES:                                            */
 /*                                                                   */
 /*            THE VARIABLES  DESCRIBED BELOW ARE INITIALIZED         */
 /*            AND MAINTAINED BY THE PROGRAM.  THE USER SHOULD        */
 /*            CONSIDER THESE VARIABLES TO BE READ-ONLY,  OR          */
 /*            UNPREDICTABLE RESULTS MAY OCCUR.                       */
 /*                                                                   */
 /*                                                                   */
 /*   EVENT_NAME    - AN ARRAY OF EIGHT BYTE SYSEVENT NAMES           */
 /*                                                                   */
 /*   EVENT_COUNT   - AN ARRAY OF COUNTERS CONTAINING THE             */
 /*                 NUMBER OF SYSEVENTS ENCOUNTERED (INCLUDING THE    */
 /*                 CURRENT EVENT) BY SYSEVENT NUMBER.                */
 /*                                                                   */
 /*   EVENT_USE     - AN ARRAY OF 68 BYTE DESCRIPTORS ABOUT EACH      */
 /*                 ASSIGNED SYSEVENT.                                */
 /*                                                                   */
 /*   CURRENT_DEC   - CONTAINS THE PRINTABLE DECIMAL FORM             */
 /*                 OF THE CURRENT EVENT NUMBER.                      */
 /*                                                                   */
 /*   CURRENT_HEX   - CONTAINS THE PRINTABLE HEXIDECIMAL FORM         */
 /*                 OF THE CURRENT SYSEVENT NUMBER.                   */
 /*                                                                   */
 /*   CURRENT_ASID  - CONTAINS THE NUMBER OF THE ADDRESS SPACE        */
 /*                 REFERENCED BY THE CURRENT EVENT.                  */
 /*                                                                   */
 /*   CURRENT_EVENT - CONTAINS THE EIGHT-BYTE NAME OF THE             */
 /*                 CURRENT SYSEVENT.                                 */
 /*                                                                   */
 /*   EVENT_INDEX   - A FIXED BINARY FIELD CONTAINING A               */
 /*                 NUMBER ONE GREATER THEN THE CURRENT EVENT. TO     */
 /*                 BE USED AS AN INDEX IN SUBSCRIPTING.              */
 /*                                                                   */
 /*   CURRENT       - CONTAINS THE CURRENT SYSEVENT NUMBER IN         */
 /*                 FIXED BINARY.                                     */
 /*                                                                   */
 /*   CURRENT_ASCB  - AN EIGTH-BYTE PRINTABLE HEXIDECIMAL FIELD       */
 /*                 CONTAINING THE ASCB ADDRESS FOR THE CURRENT       */
 /*                 SYSEVENT.                                         */
 /*                                                                   */
 /*   EVENT_TOTAL   - A FIXED BINARY FIELD CONTAINING A COUNT OF      */
 /*                 THE TOTAL NUMBER OF SYSEVENT RECORDS PROCESSED    */
 /*                 TO THIS POINT IN THE RUN. INCLUDES THE CURRENT    */
 /*                 RECORD.                                           */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*   SUPPORTED VARIABLES:                                            */
 /*                                                                   */
 /*            THE VARIABLES  DESCRIBED BELOW ARE INITIALIZED         */
 /*            AND MAINTAINED BY THE PROGRAM.  THE USER SHOULD        */
 /*            CONSIDER THESE VARIABLES TO BE READ-ONLY,  OR          */
 /*            UNPREDICTABLE RESULTS MAY OCCUR.                       */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*   HEX_R15       - HEXIDECIMAL (PRINTABLE) FORMAT OF THE           */
 /*                 CONTENTS OF REGISTER 15 AT THE TIME OF THE        */
 /*                 ISSUANCE OF THE SYSEVENT.                         */
 /*                                                                   */
 /*   HEX_R0        - HEXIDECIMAL (PRINTABLE) FORMAT OF THE           */
 /*                 CONTENTS OF REGISTER  0 AT THE TIME OF THE        */
 /*                 ISSUANCE OF THE SYSEVENT.                         */
 /*                                                                   */
 /*   HEX_R1        - HEXIDECIMAL (PRINTABLE) FORMAT OF THE           */
 /*                 CONTENTS OF REGISTER  1 AT THE TIME OF THE        */
 /*                 ISSUANCE OF THE SYSEVENT.                         */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*   SUPPORTED VARIABLES:                                            */
 /*                                                                   */
 /*            THE VARIABLES  DESCRIBED BELOW ARE INITIALIZED         */
 /*            AND MAINTAINED BY THE PROGRAM.  THE USER SHOULD        */
 /*            CONSIDER THESE VARIABLES TO BE READ-ONLY,  OR          */
 /*            UNPREDICTABLE RESULTS MAY OCCUR.                       */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*   SUPPORTED VARIABLES:                                            */
 /*                                                                   */
 /*            THE VARIABLES  DESCRIBED BELOW ARE INITIALIZED         */
 /*            AND MAINTAINED BY THE PROGRAM.  THE USER SHOULD        */
 /*            CONSIDER THESE VARIABLES TO BE READ-ONLY,  OR          */
 /*            UNPREDICTABLE RESULTS MAY OCCUR.                       */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
1/*********************************************************************/
 /*                                                                   */
 /*                                                                   */
 /*            P R O G R A M   F I L E   D E C L A R A T I O N S      */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*       SYSIN     USER CONTROL DATA CARDS               INPUT FILE  */
             DECLARE SYSIN  FILE RECORD INPUT;
 /*                                                                   */
 /*       SYSPARM   DRIVER PARAMETER CARDS                INPUT FILE  */
             DECLARE SYSPARM FILE RECORD INPUT;
 /*                                                                   */
 /*       SYSDATA    GTF FORMAT INPUT                      DATA FILE  */
             DECLARE SYSDATA FILE RECORD INPUT;
 /*                                                                   */
 /*       SYSPRINT  PROGRAM   LOG                         PRINT FILE  */
             DECLARE SYSPRINT FILE STREAM OUTPUT PRINT;
 /*                                                                   */
 /*       SYSLOG    DRIVER  ACTION LOG                    PRINT FILE  */
             DECLARE SYSLOG FILE STREAM OUTPUT PRINT;
 /*                                                                   */
 /*       SYSOUT    SECONDARY USER REPORT                 PRINT FILE  */
             DECLARE SYSOUT FILE STREAM OUTPUT PRINT;
 /*                                                                   */
 /*       SYSLIST   PRIMARY  USER REPORT                  PRINT FILE  */
             DECLARE SYSLIST  FILE STREAM OUTPUT PRINT;
 /*                                                                   */
 /*       SYSLINE   FORMATTED TRACE  DUMP                 PRINT FILE  */
             DECLARE SYSLINE  FILE STREAM OUTPUT PRINT;
 /*                                                                   */
 /*       SYSWORK   WORK FILE OR TRANS FILE                           */
             DECLARE SYSWORK FILE RECORD SEQUENTIAL BUFFERED;
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*********************************************************************/
1
-
-
-/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*            D R I V E R                                            */
 /*                                                                   */
 /*            W O R K    A R E A S                                   */
 /*                                                                   */
 /*                      A N D                                        */
 /*                                                                   */
 /*            D A T A    T A B L E S                                 */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
1
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*                                                                   */
 /*              U S E R    A C C E S S A B L E                       */
 /*                                                                   */
 /*                                                                   */
 /*              D R I V E R    D A T A    F I E L D S                */
 /*                                                                   */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
-
      DECLARE EVENT_COUNT(64)      FIXED BINARY(31,0) INIT((64)0);
      DECLARE EVENT_TOTAL          FIXED BINARY (31,0) INIT(0);
      DECLARE EVENT_INDEX          FIXED BINARY(15,0);
      DECLARE CURRENT              FIXED BINARY (15,0);
      DECLARE CURRENT_EVENT        CHAR(8);
      DECLARE CURRENT_HEX          CHAR(2);
      DECLARE CURRENT_DEC          PICTURE'99';
      DECLARE CURRENT_ASID         PICTURE'9999';
      DECLARE CURRENT_SWITCH       CHAR(1) INIT('0');
      DECLARE QUIT_SWITCH          CHAR(1) INIT('0');
      DECLARE INIT_SWITCH          CHAR(1) INIT('1');
      DECLARE CURRENT_ASCB         CHAR(8);
      DECLARE CURRENT_TIME         FIXED BINARY (31,0);
      DECLARE TOD_FORMAT           CHAR(16);
      DECLARE CURRENT_TOD          CHAR(16);
      DECLARE TOD_CLOCK            BIT(64);
      DECLARE TRACE_DATE           CHAR(16) INIT((16)' ');
      DECLARE REPORT_DATE          CHAR(16) INIT((16)' ');
      DECLARE DELTA                PICTURE'99999999';
      DECLARE HEX_R15              CHAR(8);
      DECLARE HEX_R0               CHAR(8);
      DECLARE HEX_R1               CHAR(8);
      DECLARE TIMER_SWITCH         FIXED BINARY (15,0) INIT(0);
      DECLARE COMMAND_NAME         CHAR(8) INIT('        ');
      DECLARE LAST_TIME            FIXED BINARY(31,0) INIT(0);
      DECLARE TIME_CHANGE          FIXED BINARY(31,0) INIT(0);
      DECLARE REL_TIME             PICTURE'9999.99999';
      DECLARE FIRST_TIME           FIXED BINARY(31,0) INIT(0);
      DECLARE TIME_STRING          CHAR(30) UNAL      INIT(' ');
      DECLARE 1 TOD_MAP            BASED(TODPTR) UNAL,
              2 YEAR12             CHAR(2),
              2 YEAR34             CHAR(2),
              2 TOD_DAY            CHAR(3),
              2 HMS                CHAR(8),
              2 MICRO              CHAR(7),
              2 TODSPACE           CHAR(8);
      /*****/ TODPTR = ADDR(TIME_STRING);  /********************/
1
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*              V O L A T I L E    W O R K    A R E A S              */
 /*                                                                   */
 /*              A N D                                                */
 /*                                                                   */
 /*              T R A C E   F A C I L I T Y    F I E L D S           */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
-
      DECLARE LOGPGN               FIXED BINARY (15,0) INIT(0);
      DECLARE LOGPAGE              PICTURE'9999';
      DECLARE TRCPGN               FIXED BINARY (15,0) INIT(0);
      DECLARE TRCPAGE              PICTURE'9999';
      DECLARE WORK1                FIXED BINARY (31,0) INIT(0);
      DECLARE WORK2                FIXED BINARY (15,0) INIT(0);
      DECLARE WORK3                BIT(16);
      DECLARE WORK4                BIT(32);
      DECLARE WORK5                CHAR(4);
      DECLARE WORK6                BIT(64);
      DECLARE WORK7                CHAR(18);
      DECLARE WORK8                CHAR(8);
      DECLARE WORK9                FIXED BINARY (15,0);
      DECLARE WORK10               FIXED BINARY (15,0);
      DECLARE WORK11               CHAR(8);
1
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*                                                                   */
 /*              P A R A M E T E R    V A R I A B L E S               */
 /*                                                                   */
 /*              A N D                                                */
 /*                                                                   */
 /*              I N P U T    P A R M    S T R I N G S                */
 /*                                                                   */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
-
      DECLARE E_WORK(26)           FIXED BINARY (15,0) INIT((26)0);
      DECLARE START                FIXED BINARY(31,0) INIT(0);
      DECLARE STOP                 FIXED BINARY(31,0) INIT(0);
      DECLARE EVENTS(50)           FIXED BINARY (15,0) INIT((50)16383);
      DECLARE ASID(8)              FIXED BINARY (15,0) INIT((8)0);
      DECLARE EVENT_INCLUDE        CHAR(1) INIT('0');
      DECLARE EVENT_EXCLUDE        CHAR(1) INIT('0');
      DECLARE COMMAND_LIST         CHAR(8) INIT('        ');
-
      DECLARE PARM_STRING          CHAR(4095) VARYING;
      DECLARE JOBS(8)              CHAR(8) VARYING INIT((8)'');
      DECLARE PRM                  CHAR(100) VARYING;
      DECLARE STRING_W_J           CHAR(100) VARYING INIT((8)' ''''');
      DECLARE STRING_W_A           CHAR(100) VARYING INIT((8)' 0');
      DECLARE STRING_W_E           CHAR(100) VARYING INIT((26)' 0');
      DECLARE ASIDS                CHAR(100) VARYING INIT('');
      DECLARE JOBNAME              CHAR(100) VARYING INIT('');
      DECLARE OPTIONS              CHAR(100) VARYING INIT('');
      DECLARE DRIVER               CHAR(100) VARYING INIT('');
      DECLARE INCLUDE              CHAR(100) VARYING INIT('');
      DECLARE EXCLUDE              CHAR(100) VARYING INIT('');
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*                                                                   */
 /*   S U B P R O G R A M    E N T R Y   D E C L A R A T I O N S      */
 /*                                                                   */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
-
      DECLARE @PRESS ENTRY(CHAR(1024) VARYING)
                     RETURNS(CHAR(1024) VARYING);
      DECLARE @HEX ENTRY (FIXED BINARY(31,0)) RETURNS(CHAR(8) );
      DECLARE @TIME ENTRY(CHAR(30));
      DECLARE @TOD  ENTRY;
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*                                                                   */
 /*   R E P O R T   T I T L E S   A N D   M E S S A G E S             */
 /*                                                                   */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
-
      DECLARE TTL1  CHAR(100)         INIT(
 'REPORT DATE: ****************           S Y S E V E N T    A N A L Y S
  I S    S Y S T E M  ');
      DECLARE TTL2  CHAR(132) STATIC  INIT(
 '-SYSEVENT CODE-                            REGISTER CONTENTS  - - - -
 - - - -  T I M E  - - - - - -  COMMAND ');
      DECLARE TTL3  CHAR(132) STATIC  INIT(
 'HEX DEX--NAME--  ASID  JOBNAME   --ASCB--  -REG 15- -REG  1-  -CHANGE-
  -RELATIVE-  ---TOD  CLOCK---  --NAME-- ');
     DECLARE DASHS CHAR(132) STATIC  INIT((66)'- ');
0/*  DRIVER ERROR MESSAGES     (SYSLOG & SYSPRINT)                    */
     DECLARE ERRMSG1 CHAR(132) STATIC INIT(
 '****ERROR**** INCLUDE= AND EXCLUDE= ARE MUTUALLY EXCLUSIVE');
     DECLARE ERRMSG2 CHAR(132) STATIC INIT(
 '****ERROR**** SYSPARM INPUT STRING LENGTH EXCEEDED BEFORE EOF');
     DECLARE ERRMSG3 CHAR(132) STATIC INIT(
 '****ERROR**** SYSDATA DD STATEMENT MISSING');
     DECLARE ERRMSG4 CHAR(132) STATIC INIT(
 '****ERROR**** UNKNOWN CONDITION HAS CAUSED INTERRUPT');
     DECLARE ERRMSG5 CHAR(132) STATIC INIT(
 '****ERROR****  ANALYSIS RUN TERMINATED');
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*                                                                   */
 /*            S Y S E V E N T   R E C O R D   F O R M A T            */
 /*                                                                   */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
0                   /*  */
      DECLARE GTFAID               BIT(8) INIT((8)'1'B);
      DECLARE GTFFID               BIT(8) INIT('00000100'B);
      DECLARE GTFEID               BIT(16) INIT('0100000000000001'B);
      DECLARE XSER0                BIT(32);
      DECLARE XSER1                BIT(32);
      DECLARE XSERF                BIT(32);
0                   /*  */
      DECLARE GTFPTR               POINTER;
      DECLARE GTFREC               CHAR(1148) VARYING;
      DECLARE 1 GTFSE              BASED(GTFPTR) UNALIGNED ,
               2 SELGTH            FIXED BINARY(15,0),
               2 SEAID             BIT(8),
               2 SEFID             BIT(8),
               2 SETIME,
                 3 SETOD           BIT(32),
                 3 SEDAY           BIT(32),
               2 SEEID             BIT(16),
               2 SEASCB            BIT(32),
               2 SECPUID           FIXED BINARY(15,0),
               2 SEJOBNM           CHAR(8),
               2 SER15             BIT(32),
               2 SER0              BIT(32),
               2 SER1              BIT(32);
0
         DECLARE 1 REG_0      UNALIGNED BASED(R0PTR),
               2 R0_H1        FIXED BINARY (15,0),
               2 R0_B2        BIT(8),
               2 R0_B3        BIT(8);
0
         DECLARE 1 FULHAF     UNALIGNED BASED (FHPTR),
               2 HALF_1       FIXED BINARY(15,0),
               2 HALF_2       FIXED BINARY(15,0);
 /*                                                                   */
 /*        R E C O R D    F I E L D    A D D R E S S A B I L I T Y    */
               GTFPTR = ADDR(GTFREC);
               R0PTR  = ADDR(XSER0);
               FHPTR  = ADDR(XSERF);
 /*                                                                   */
 /*                                                                   */
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*                                                                   */
 /*            S Y S E V E N T   N A M E   T A B L E S                */
 /*                                                                   */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
-                                  /*  */
      DECLARE  EVENT_NAME(64) CHAR(8)
       INIT(   'TSEVENT ','TIMEREXP','TERMWAIT','NIOWAIT ',
               'USERRDY ','*UNUSED*','MEMCREAT','MEMDEL  ',
               'JOBSELCT','JOBTERM ','INITATT ','INITDET ',
               'QSCEST  ','QSCECMP ','*UNUSED*','SWOUTCMP',
               '*UNUSED*','SWINFL  ','QSCEFL  ','RSTORCMP',
               'ENQHOLD ','ENQRLSE ','RSMCNSTS','AVQLOW  ',
               'AVQOK   ','SQALOW  ','SQAOK   ','ASMCNSTS',
               'DEVALLOC','CONFIGCH','VERIFYPG','RESETPG ',
               'NEWIPS  ','ALTCPREC','TGETTPUT','SYQSCST ',
               'SYQSCCMP','*UNUSED*','REQSERVC','REQPGDAT',
               '*UNUSED*','DONTSWAP','OKSWAP  ','REQSWAP ',
               'BRINGIN ','WKLDINIT','WKLDCOLL','WKLDTERM',
               'SRM**SRM','*UNUSED*','*UNUSED*','*UNUSED*',
               '*UNUSED*','*UNUSED*','*UNUSED*','*UNUSED*',
               '*UNUSED*','*UNUSED*','*UNUSED*','*UNUSED*');
-              /* END OF SYSEVENT NAME TABLE                          */
               /* NAMES TAKEN FROM GC28-0681                          */
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*            P L / 1   S Y S E V E N T   N A M E S                  */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
-/*                                                                   */
 /*            --NAME--                                    EVENT      */
 /*                                                                   */
      DECLARE  TSEVENT             FIXED BINARY (15,0)   INIT(00);
      DECLARE  TIMEREXP            FIXED BINARY (15,0)   INIT(01);
      DECLARE  TERMWAIT            FIXED BINARY (15,0)   INIT(02);
      DECLARE  NIOWAIT             FIXED BINARY (15,0)   INIT(03);
      DECLARE  USERRDY             FIXED BINARY (15,0)   INIT(04);
      DECLARE  EVENT05             FIXED BINARY (15,0)   INIT(05);
      DECLARE  MEMCREAT            FIXED BINARY (15,0)   INIT(06);
      DECLARE  MEMDEL              FIXED BINARY (15,0)   INIT(07);
      DECLARE  JOBSELCT            FIXED BINARY (15,0)   INIT(08);
      DECLARE  JOBTERM             FIXED BINARY (15,0)   INIT(09);
      DECLARE  INITATT             FIXED BINARY (15,0)   INIT(10);
      DECLARE  INITDET             FIXED BINARY (15,0)   INIT(11);
      DECLARE  QSCEST              FIXED BINARY (15,0)   INIT(12);
      DECLARE  QSCECMP             FIXED BINARY (15,0)   INIT(13);
      DECLARE  EVENT14             FIXED BINARY (15,0)   INIT(14);
      DECLARE  SWOUTCMP            FIXED BINARY (15,0)   INIT(15);
      DECLARE  EVENT16             FIXED BINARY (15,0)   INIT(16);
      DECLARE  SWINFL              FIXED BINARY (15,0)   INIT(17);
      DECLARE  QSCEFL              FIXED BINARY (15,0)   INIT(18);
      DECLARE  RSTORCMP            FIXED BINARY (15,0)   INIT(19);
      DECLARE  ENQHOLD             FIXED BINARY (15,0)   INIT(20);
      DECLARE  ENQRLSE             FIXED BINARY (15,0)   INIT(21);
      DECLARE  RSMCNSTS            FIXED BINARY (15,0)   INIT(22);
      DECLARE  AVQLOW              FIXED BINARY (15,0)   INIT(23);
      DECLARE  AVQOK               FIXED BINARY (15,0)   INIT(24);
      DECLARE  SQALOW              FIXED BINARY (15,0)   INIT(25);
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*            P L / 1   S Y S E V E N T   N A M E S                  */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
-/*                                                                   */
 /*            --NAME--                                    EVENT      */
 /*                                                                   */
      DECLARE  SQAOK               FIXED BINARY (15,0)   INIT(26);
      DECLARE  ASMCNSTS            FIXED BINARY (15,0)   INIT(27);
      DECLARE  DEVALLOC            FIXED BINARY (15,0)   INIT(28);
      DECLARE  CONFIGCH            FIXED BINARY (15,0)   INIT(29);
      DECLARE  VERIFYPG            FIXED BINARY (15,0)   INIT(30);
      DECLARE  RESETPG             FIXED BINARY (15,0)   INIT(31);
      DECLARE  NEWIPS              FIXED BINARY (15,0)   INIT(32);
      DECLARE  ALTCPREC            FIXED BINARY (15,0)   INIT(33);
      DECLARE  TGETTPUT            FIXED BINARY (15,0)   INIT(34);
      DECLARE  SYQSCST             FIXED BINARY (15,0)   INIT(35);
      DECLARE  SYQSCCMP            FIXED BINARY (15,0)   INIT(36);
      DECLARE  EVENT37             FIXED BINARY (15,0)   INIT(37);
      DECLARE  REQSERVC            FIXED BINARY (15,0)   INIT(38);
      DECLARE  REQPGDAT            FIXED BINARY (15,0)   INIT(39);
      DECLARE  EVENT40             FIXED BINARY (15,0)   INIT(40);
      DECLARE  DONTSWAP            FIXED BINARY (15,0)   INIT(41);
      DECLARE  OKSWAP              FIXED BINARY (15,0)   INIT(42);
      DECLARE  REQSWAP             FIXED BINARY (15,0)   INIT(43);
      DECLARE  BRINGIN             FIXED BINARY (15,0)   INIT(44);
      DECLARE  WKLDINIT            FIXED BINARY (15,0)   INIT(45);
      DECLARE  WKLDCOLL            FIXED BINARY (15,0)   INIT(46);
      DECLARE  WKLDTERM            FIXED BINARY (15,0)   INIT(47);
      DECLARE  SRMSRM48            FIXED BINARY (15,0)   INIT(48);
      DECLARE  EVENT49             FIXED BINARY (15,0)   INIT(49);
      DECLARE  EVENT50             FIXED BINARY (15,0)   INIT(50);
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*   S Y S E V E N T   F U N C T I O N   L I S T                     */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
-                                  /*  */
      DECLARE EVENT_USE(64) CHAR(68);
      EVENT_USE(1)
   =  'PPMODE - EXECUTION OF TSO COMMAND OR SUBCOMMAND';
      EVENT_USE(2)
   =  'S R M TIMER EXPIRATION ';
      EVENT_USE(3)
   =  'TERMINAL USER IN WAIT CONDITION';
      EVENT_USE(4)
   =  'ADDRESS SPACE SUSPECTED OF BEING IN LONG WAIT';
      EVENT_USE(5)
   =  'AN ADDRESS SPACE (USER) IS READY ';
      EVENT_USE(6)
   =  'SYSEVENT CODE 05 IS UNUSED';
      EVENT_USE(7)
   =  'ADDRESS SPACE CREATION';
      EVENT_USE(8)
   =  'ADDRESS SPACE DELETION';
      EVENT_USE(9)
   =  'JOB SELECTION ';
      EVENT_USE(10)
   =  'JOB TERMINATION';
      EVENT_USE(11)
   =  'ATTACH BY INITIATOR (IEFSD263)';
      EVENT_USE(12)
   =  'DETACH BY INITIATOR (IEFSD263)';
      EVENT_USE(13)
   =  'QUIESCE STARTED FOR AN ADDRESS SPACE';
      EVENT_USE(14)
   =  'QUIESCE COMPLETED FOR AN ADDRESS SPACE';
      EVENT_USE(15)
   =  'SYSEVENT CODE 14 (0E) IS UNUSED' ;
      EVENT_USE(16)
   =  'SWAP OUT PROCESSING COMPLETED';
      EVENT_USE(17)
   =  'SYSEVENT CODE 16 (10) IS UNUSED.';
      EVENT_USE(18)
   =  'SWAP IN FAILED- OBTAIN/INIT LSQA FAILED FOR ASID';
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*   S Y S E V E N T   F U N C T I O N   L I S T                     */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
-
      EVENT_USE(19)
   =  'QUIESCE FAILED - ASID RESTORED AT THIS TIME';
      EVENT_USE(20)
   =  'RESTORE COMPLETED - CHECK FOR READY MADE HERE';
      EVENT_USE(21)
   =  'ENQ CONTENTION IS OCCURRING';
      EVENT_USE(22)
   =  'ENQ CONTENTION REDUCED';
      EVENT_USE(23)
   =  'REAL STORAGE MANAGER CONSTANTS TO SRM';
      EVENT_USE(24)
   =  'AVAILABLE FRAME QUEUE BELOW THRESHOLD';
      EVENT_USE(25)
   =  'AVAILABLE FRAME QUEUE RETURNED ABOVE LIMIT';
      EVENT_USE(26)
   =  'UNALLOCATED SQA BELOW THRESHOLD';
      EVENT_USE(27)
   =  'UNALLOCATED SQA RETURNED ABOVE LIMIT';
      EVENT_USE(28)
   =  'AUXILIARY STORAGE MANAGER CONSTANTS TO SRM';
      EVENT_USE(29)
   =  'DEVICE ALLOCATION DECISION REQUEST';
      EVENT_USE(30)
   =  'SYSTEM CONFIGURATION CHANGE';
      EVENT_USE(31)
   =  'VERIFY PERFORMANCE GROUP FOR ADDRESS SPACE';
      EVENT_USE(32)
   =  'RESET  PERFORMANCE GROUP FOR ADDRESS SPACE';
      EVENT_USE(33)
   =  'CHANGE IPS CURRENTLY USED BY SRM';
      EVENT_USE(34)
   =  'ALTERNATE CPU RECOVERY OCCURRING';
      EVENT_USE(35)
   =  'TSO TGET OR TPUT SATISFIED';
      EVENT_USE(36)
   =  'SYSTEM QUIESCE FUNCTION STARTED';
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*   S Y S E V E N T   F U N C T I O N   L I S T                     */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
-
      EVENT_USE(37)
   =  'SYSTEM QUIESCE FUNCTION COMPLETE';
      EVENT_USE(38)
   =  'SYSEVENT CODE 37 (25) IS UNUSED';
      EVENT_USE(39)
   =  'REQUEST FOR SERVICE DATA ON ADDRESS SPACE';
      EVENT_USE(40)
   =  'REQUEST FOR PAGING DATA ON ADDRESS SPACE';
      EVENT_USE(41)
   =  'SYSEVENT CODE 40 (28) IS UNUSED';
      EVENT_USE(42)
   =  'ADDRESS SPACE IS NOW NONSWAPPABLE';
      EVENT_USE(43)
   =  'ADDRESS SPACE IS NOW SWAPPABLE';
      EVENT_USE(44)
   =  'REQUEST TO SWAP OUT ADDRESS SPACE';
      EVENT_USE(45)
   =  'BRING ADDRESS SPACE INTO CORE - FOR CANCEL -';
      EVENT_USE(46)
   =  'WORKLOAD ACTIVITY MEASUREMENT INITIALIZED';
      EVENT_USE(47)
   =  'WORKLOAD ACTIVITY MEASUREMENT COLLECTION';
      EVENT_USE(48)
   =  'WORKLOAD ACTIVITY MEASUREMENT TERMINATION';
      EVENT_USE(49)
   =  'INTERNAL SRM CONTROL INVOKATION SYSEVENT';
      EVENT_USE(50)
   =  'ALL OTHER SYSEVENTS ARE UNUSED'   ;
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*                                                                   */
 /*        F I L E    O P E N   S T A T E M E N T S                   */
 /*                                                                   */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
-/*                                                                   */
      OPEN FILE(SYSOUT)  OUTPUT PRINT LINESIZE(137) PAGESIZE(58);
      OPEN FILE(SYSLOG)  OUTPUT PRINT LINESIZE(137) PAGESIZE(58);
      OPEN FILE(SYSLIST) OUTPUT PRINT LINESIZE(137) PAGESIZE(58);
      OPEN FILE(SYSPRINT) OUTPUT PRINT LINESIZE(137) PAGESIZE(59);
      OPEN FILE(SYSLINE ) OUTPUT PRINT LINESIZE(137) PAGESIZE(59);
      OPEN FILE(SYSPARM) INPUT RECORD SEQUENTIAL;
      OPEN FILE(SYSDATA) INPUT RECORD SEQUENTIAL;
 /*                                                                   */
 /*                                                                   */
 /*                                                                   */
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*   O N   C O N D I T I O N S                                       */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
-
          ON UNDEFINEDFILE(SYSPARM) GOTO PARM_RD_END;
          ON ENDFILE(SYSPARM)       GOTO PARM_RD_END;
          ON ENDFILE(SYSDATA)       GOTO INPUT_ENDED;
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*   O N   C O N D I T I O N S                                       */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
-
 /*                                                                   */
 /*                                                                   */
 /*   S Y S E V E N T   F U N C T I O N   L I S T  (S Y S P R I N T)  */
 /*                                                                   */
 /*                                                                   */
      ON ENDPAGE (SYSPRINT) BEGIN;
               PUT      EDIT
               ('SYSEVENT CODES FOR VS/2 RELEASE 3.0 (MVS)')
               (COL(27),A);
               PUT SKIP(4) EDIT ('SYSEVENT','EVENT  NUMBER',
               'FUNCTION') (COL(3),A,COL(12),A,COL(27),A);
               PUT EDIT ('  NAME  ',' DEC     HEX ',
               '/PURPOSE') (COL(3),A,COL(12),A,COL(27),A);
               PUT SKIP(3);
               END;
      SIGNAL ENDPAGE(SYSPRINT);
      DO I = 1 TO 50;
               WORK1 = I - 1;
               CURRENT_DEC = WORK1;
               WORK8 = @HEX(WORK1);
               CURRENT_HEX = SUBSTR(WORK8,7,2);
               PUT EDIT (EVENT_NAME(I),CURRENT_DEC,
               CURRENT_HEX,EVENT_USE(I))
               (COL(3),A,COL(14),A,COL(21),A,COL(27),A);
      END;
      REVERT ENDPAGE(SYSPRINT);
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*   O N   C O N D I T I O N S                                       */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
-
 /*                                                                   */
 /*                                                                   */
 /*   S Y S E V E N T   F U N C T I O N   L I S T   ( S Y S L I N E ) */
 /*                                                                   */
 /*                                                                   */
      ON ENDPAGE (SYSLINE ) BEGIN;
               PUT FILE(SYSLINE )      EDIT
               ('SYSEVENT CODES FOR VS/2 RELEASE 3.0 (MVS)')
               (COL(27),A);
               PUT FILE(SYSLINE ) SKIP(4) EDIT ('SYSEVENT',
               'EVENT NUMBER',
               'FUNCTION') (COL(3),A,COL(12),A,COL(27),A);
               PUT FILE(SYSLINE ) EDIT ('  NAME  ',' DEC     HEX ',
               '/PURPOSE') (COL(3),A,COL(12),A,COL(27),A);
               PUT FILE(SYSLINE ) SKIP(3);
               END;
      SIGNAL ENDPAGE(SYSLINE );
      DO I = 1 TO 50;
               WORK1 = I - 1;
               CURRENT_DEC = WORK1;
               WORK8 = @HEX(WORK1);
               CURRENT_HEX = SUBSTR(WORK8,7,2);
               PUT FILE(SYSLINE ) EDIT (EVENT_NAME(I),CURRENT_DEC,
               CURRENT_HEX,EVENT_USE(I))
               (COL(3),A,COL(14),A,COL(21),A,COL(27),A);
      END;
      REVERT ENDPAGE(SYSLINE );
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*   O N   C O N D I T I O N S                                       */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
-
       ON ENDPAGE (SYSLINE )  BEGIN;
               TRCPGN = TRCPGN + 1;
               TRCPAGE = TRCPGN;
               PUT FILE(SYSLINE ) PAGE
                   EDIT (TTL1,'TRACE  DATE: ',TRACE_DATE)
                        (COL(1),A,COL(102),A,A);
               PUT FILE(SYSLINE) SKIP EDIT ('*','PAGE  ',TRCPAGE)
               (COL(1),A,COL(121),A,COL(127),A);
               PUT FILE(SYSLINE ) SKIP(2) EDIT (TTL2) (A);
               PUT FILE(SYSLINE ) EDIT (TTL3) (COL(1),A);
               PUT FILE(SYSLINE ) EDIT (DASHS)  (COL(1),A);
               PUT FILE(SYSLINE ) SKIP(2);
      END;     /* END OF ENDPAGE BEGIN BLOCK                          */
0
       ON ENDPAGE (SYSLOG )  BEGIN;
               LOGPGN = LOGPGN + 1;
               LOGPAGE = LOGPGN;
               PUT FILE(SYSLOG ) PAGE
                   EDIT (TTL1,'**ACTION LOG**',
               'PAGE  ',LOGPAGE)
               (COL(1),A,COL(102),A,COL(121),A,COL(127),A);
               PUT FILE(SYSLOG ) SKIP(2);
               PUT FILE(SYSLOG ) EDIT (DASHS)  (COL(1),A);
               PUT FILE(SYSLOG ) SKIP(1);
      END;     /* END OF ENDPAGE BEGIN BLOCK                          */
0
       ON ENDPAGE (SYSPRINT)  BEGIN;
               PUT FILE(SYSPRINT) PAGE EDIT
               (TTL1) (COL(1),A);
               PUT FILE(SYSPRINT) SKIP(1);
               PUT FILE(SYSPRINT) EDIT (DASHS)  (COL(1),A);
               PUT FILE(SYSPRINT) SKIP(1);
      END;     /* END OF ENDPAGE BEGIN BLOCK                          */
1/*                                                                   */
 INITIALIZE:
      CALL @TIME(TIME_STRING);
      REPORT_DATE = YEAR34'.'TOD_DAY'  'HMS;
      SUBSTR(TTL1,14,16) = REPORT_DATE;
      SIGNAL ENDPAGE(SYSPRINT);
      SIGNAL ENDPAGE(SYSLIST );
      SIGNAL ENDPAGE(SYSLOG  );
      SIGNAL ENDPAGE(SYSOUT  );
      WORK1 = 0;
      PARM_STRING = ' ';
        PUT FILE(SYSLOG) SKIP(2) EDIT
            ('*---------------------S Y S P A R M  ',
             ' I N P U T--------------------------*')
                      (COL(2),A,A);
        PUT FILE(SYSLOG) SKIP(2);
1/*                                                                   */
 PARM_LOOP:
      READ FILE(SYSPARM) INTO(GTFREC);
      PUT FILE(SYSLOG) EDIT ('<',SUBSTR(GTFREC,1,72),'>')
               (COL(1),A,A,A);
      IF SUBSTR(GTFREC,1,72) = (72)' ' THEN GOTO PARM_LOOP;
      IF SUBSTR(GTFREC,1,1) = '*'  THEN GOTO PARM_LOOP;
0/*  */
     OPTIONS = @PRESS(SUBSTR(GTFREC,1,72));
      PUT FILE(SYSLOG) SKIP EDIT('==>',OPTIONS,'<==') (COL(1),A,A,A);
      IF LENGTH(PARM_STRING) < 3923 THEN DO;
         PARM_STRING = PARM_STRING' 'OPTIONS;
         END;
      IF LENGTH(PARM_STRING) < 3990 THEN GOTO PARM_LOOP;
 PARM_RD_END:
      IF LENGTH(PRM) ^= 0 THEN  DO;
               PARM_STRING = PARM_STRING' 'PRM;      END;
      PARM_STRING = PARM_STRING' ; ';
 /*   PARAMETER STRING BUILT AT THIS POINT                            */
1/*   PARAMETER STRING BUILT AT THIS POINT                            */
        GET STRING(PARM_STRING)
        DATA(OPTIONS,DRIVER,INCLUDE,EXCLUDE,JOBNAME,ASIDS);
        IF DRIVER ^= ''   THEN DO;
         DRIVER  = DRIVER   ' ; ';
         PUT FILE(SYSLOG) SKIP(2) EDIT('DRIVER=',DRIVER)
             (COL(1),A,A);
           TIMER_SWITCH = INDEX(DRIVER,'$NOTIMERS');
           END;
 /*************NOTE HERE FOR INCLUDE/EXCLUDE MUTUALLY EXCLUSIVE       */
      IF (INCLUDE ^= '' & EXCLUDE ^= '') THEN DO;
         PUT FILE(SYSLOG) SKIP(2) EDIT(ERRMSG1) (COL(1),A);
         GOTO ABTERM_PROCESS;
      END;
-
      IF INCLUDE ^= '' THEN  DO;
         EVENT_INCLUDE = '1';
         PUT FILE(SYSLOG) SKIP(2) EDIT('INCLUDE=',INCLUDE)
             (COL(1),A,A);
         INCLUDE = INCLUDESTRING_W_E' ; ';
         GET STRING(INCLUDE) LIST((E_WORK(JJ) DO JJ = 1 TO 26));
         DO I = 1 TO 26 WHILE(E_WORK(I) ^= 0);
            CURRENT = E_WORK(I) - 1;
            EVENTS(CURRENT) = CURRENT;
         END;
         END;
-
      IF EXCLUDE ^= '' THEN  DO;
         EVENT_EXCLUDE = '1';
         PUT FILE(SYSLOG) SKIP(2) EDIT('EXCLUDE=',EXCLUDE)
             (COL(1),A,A);
         EXCLUDE = EXCLUDESTRING_W_E' ; ';
         GET STRING(EXCLUDE) LIST((E_WORK(JJ) DO JJ = 1 TO 26));
         DO I = 1 TO 26 WHILE(E_WORK(I) ^= 0);
            CURRENT = E_WORK(I) + 1;
            EVENTS(CURRENT) = 256;
         END;
         END;
-
      IF JOBNAME ^= '' THEN  DO;
         PUT FILE(SYSLOG) SKIP(2) EDIT('JOBNAME=',JOBNAME)
             (COL(1),A,A);
         JOBNAME = JOBNAMESTRING_W_J' ; ';
         GET STRING(JOBNAME) LIST((JOBS(JJ) DO JJ = 1 TO 8));
         END;
-
      IF ASIDS ^= '' THEN    DO;
         PUT FILE(SYSLOG) SKIP(2) EDIT('ASIDS=',ASIDS)
             (COL(1),A,A);
          ASIDS = ASIDSSTRING_W_A' ; ';
         GET STRING(ASIDS) LIST((ASID(JJ) DO JJ = 1 TO 8));
         END;
-
      IF OPTIONS ^= '' THEN    DO;
         OPTIONS = OPTIONS  ' ; ';
         PUT FILE(SYSLOG) SKIP(2) EDIT('OPTIONS=',OPTIONS)
             (COL(1),A,A);
         END;
1/*                                                                  */
      SIGNAL ENDPAGE(SYSLOG);
      IF (ASID(1) ^= 0  JOBS(1) ^= ''  EVENTS(1) ^= 16383)
      THEN DO;
      PUT FILE(SYSLOG) PAGE
      EDIT('D R I V E R    O P T I O N S    S E L E C T E D')
               (COL(24),A);
      PUT FILE(SYSLOG) SKIP(3);
      PUT FILE(SYSLOG) EDIT('DRIVER SELECT OPTIONS WERE:') (COL(1),A);
      PUT FILE(SYSLOG) EDIT (DRIVER) (COL(1),A);
      PUT FILE(SYSLOG) SKIP(2);
      IF ASID(1) ^= 0 THEN DO;
      PUT FILE(SYSLOG) EDIT('A S I D S   SELECTED') (COL(12),A);
      PUT FILE(SYSLOG) SKIP;
               DO I = 1 TO 8;
      IF ASID(I) = 0 THEN GOTO ASID_NDN;
      PUT FILE(SYSLOG) EDIT ('  ',ASID(I),'  ') (A,F(3),A);
      END;
  ASID_NDN: ;
      END;
      IF JOBS(1) ^= '' THEN DO;
      PUT FILE(SYSLOG) SKIP(2) EDIT('J O B S   SELECTED ') (COL(12),A);
   PUT FILE(SYSLOG) SKIP;
      DO I = 1 TO 8;
               IF JOBS(I) = '' THEN GOTO JOBS_NDN;
               PUT FILE(SYSLOG) EDIT(JOBS(I),'   ') (A,A);
               END;
  JOBS_NDN:
      END;
 /*   END OF OPTION LIST LOGIC                                        */
      END;
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*   R E C O R D    P R O C E S S I N G    L O O P                   */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
-
 PROCESS_START:
      READ FILE(SYSDATA) INTO(GTFREC);
      IF ( SEAID ^= GTFAID  SEFID ^= GTFFID  SEEID ^= GTFEID )
               THEN GOTO PROCESS_START;
      IF TRACE_DATE = (16)' ' THEN DO;
         WORK6 = UNSPEC(SETOD)  UNSPEC(SEDAY);
         TOD_CLOCK = WORK6;
         CALL @TOD(TOD_CLOCK,TIME_STRING);
         TRACE_DATE = YEAR34'.'TOD_DAY'  'HMS;
      END;
      XSER0 = SER0;
      XSER1 = SER1;
      XSERF = SER15;
      SUBSTR(WORK3,1,8) = '00000000'B;   /*   D E T E R M I N E       */
      SUBSTR(WORK3,9,8) = R0_B3;         /*   C U R R E N T           */
      UNSPEC(CURRENT) = WORK3;           /*   S Y S E V E N T         */
      EVENT_INDEX = CURRENT + 1;         /*   N U M B E R             */
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*   E V E N T    S E L E C T I O N   L O G I C                      */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
-
      IF TIMER_SWITCH ^= 0 THEN DO;
          IF CURRENT = TIMEREXP THEN GOTO PROCESS_START;
      END;
      IF ASID(1) ^= 0 THEN DO;
               DO I = 1 TO 8;
               IF ASID(I) = R0_H1 THEN GOTO ASID_SELECT;
               END;
               GOTO PROCESS_START;
      ASID_SELECT:
      END;
      IF JOBS(1) ^= '' THEN DO;
               DO I = 1 TO 8;
               IF JOBS(I) = SEJOBNM THEN GOTO JOB_SELECT;
               END;
               GOTO PROCESS_START;
      JOB_SELECT:
      END;
      IF EVENT_INCLUDE = '1' THEN DO;
               IF EVENTS(EVENT_INDEX) = 16383 THEN
               GOTO PROCESS_START;
      END;
      IF EVENT_EXCLUDE = '1' THEN DO;
               IF EVENTS(EVENT_INDEX) = 256  THEN
               GOTO PROCESS_START;
      END;
 /*            END OF RECORD SELECTION LOGIC                          */
 /*                                                                   */
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*   C U R R E N T   R E C O R D   F O R M A T T I N G               */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
-
      IF INIT_SWITCH = '1' THEN DO;
         SIGNAL ENDPAGE(SYSLINE);
      END;
      EVENT_TOTAL = EVENT_TOTAL + 1;
      EVENT_COUNT(EVENT_INDEX) = EVENT_COUNT(EVENT_INDEX) + 1;
      CURRENT_EVENT = EVENT_NAME(EVENT_INDEX);
      CURRENT_DEC = CURRENT;
      WORK1 = CURRENT;
      WORK8 = @HEX(WORK1);
      CURRENT_HEX = SUBSTR(WORK8,7,2);
      UNSPEC(WORK2) = SUBSTR(UNSPEC(SER0),1,16);
      CURRENT_ASID = WORK2;
      UNSPEC(WORK1) = UNSPEC(SER15);
      HEX_R15 = @HEX(WORK1);
      UNSPEC(WORK1) = UNSPEC(SER0);
      HEX_R0 = @HEX(WORK1);
      UNSPEC(WORK1) = UNSPEC(SER1);
      HEX_R1 = @HEX(WORK1);
      UNSPEC(WORK1) =SEASCB;
      CURRENT_ASCB = @HEX(WORK1);
      UNSPEC(WORK1) = UNSPEC(SETOD);
      SUBSTR(CURRENT_TOD,1,8) = @HEX(WORK1);
      UNSPEC(WORK1) = UNSPEC(SEDAY);
      SUBSTR(CURRENT_TOD,9,8) = @HEX(WORK1);
      WORK6 = UNSPEC(SETOD)  UNSPEC(SEDAY);
      TOD_CLOCK = WORK6;
      CALL @TOD(TOD_CLOCK,TIME_STRING);
      TOD_FORMAT = '>'HMSMICRO;
      SUBSTR(WORK4,2,31) = SUBSTR(WORK6,15,31);
      UNSPEC(CURRENT_TIME) = WORK4;
      IF FIRST_TIME = 0 THEN FIRST_TIME = CURRENT_TIME;
      IF LAST_TIME = 0 THEN LAST_TIME = CURRENT_TIME;
      TIME_CHANGE = CURRENT_TIME - LAST_TIME;
      REL_TIME = CURRENT_TIME - FIRST_TIME;
      DELTA = TIME_CHANGE;
      LAST_TIME = CURRENT_TIME;
      COMMAND_NAME = '        ';
      IF CURRENT = TSEVENT THEN
        DO;
          WORK6 = SER1SER15;
          UNSPEC(WORK11) = WORK6;
          COMMAND_NAME = WORK11;
        END;
1
-
-
-
-
 /********************************************************************/
 /*                                                                  */
 /*                  *                            *******            */
 /*                * *                           *     *             */
 /*              *   *                          *     *              */
 /*            *     ***************************     *               */
 /*          *                                      *                */
 /**/      CALL     ANAL;                     /*   *                 */
 /*          *                                      *                */
 /*            *     ***************************     *               */
 /*              *   *                          *     *              */
 /*                * *                           *     *             */
 /*                  *                            *******            */
 /*                                                                  */
 /*                                                                  */
 /********************************************************************/
1/*                                                                   */
-
      INIT_SWITCH = '0';
      IF CURRENT_SWITCH = '0' THEN DO;
               PUT FILE(SYSLINE ) EDIT (CURRENT_HEX,CURRENT_DEC,
               CURRENT_EVENT,CURRENT_ASID,SEJOBNM,CURRENT_ASCB,HEX_R15,
               HEX_R1,DELTA,REL_TIME,TOD_FORMAT,COMMAND_NAME)
   (COL(1),A,X(2),A,X(1),A,X(2),A,X(2),A,X(2),A,X(2),A,X(1),A,X(2),
              A,X(1),A,X(2),A,X(2),A);
      END;
      CURRENT_SWITCH = '0';
      GOTO PROCESS_START;
 INPUT_ENDED:
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*   T E R M I N A T I O N   P R O C E S S I N G                     */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
-
      QUIT_SWITCH = '1';
      CALL ANAL;
      PUT PAGE;
               PUT SKIP(8);
      PUT  SKIP EDIT('E V E N T           T O T A L S')
               (COL(28),A);
      PUT SKIP(5);
    L = 4;
    DO I = 1 TO 50;
     IF L = 4 THEN DO;
         L = 0;
      PUT SKIP EDIT('    ') (COL(1),A);
      END;
      IF EVENT_COUNT(I) ^= 0 THEN DO;
        PUT EDIT(EVENT_NAME(I),' = ',EVENT_COUNT(I))
            (X(3),A,A,F(6));
       L = L + 1;
     END;
      END;
      PUT SKIP(6) EDIT
      (EVENT_TOTAL,'SYSEVENT  RECORDS  PROCESSED.')
      (COL(4),F(8),COL(16),A);
      PUT PAGE;
      RETURN;
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*   A B T E R M             P R O C E S S I N G                     */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
-
 ABTERM_PROCESS: ;
      PUT FILE(SYSPRINT) SKIP
         EDIT(ERRMSG5) (COL(1),A);
      PUT FILE(SYSLOG)   SKIP
         EDIT(ERRMSG5) (COL(1),A);
      RETURN;
-/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*                                                                   */
 /*   E N D    O F    I N S E R T E D    D R I V E R                  */
 /*                                                                   */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
1/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 /*                                                                   */
 /*                                                                   */
 /*   S T A R T   O F   U S E R   A N A L Y S I S   R O U T I N E     */
 /*                                                                   */
 /*                                                                   */
 /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
-/*                                                                   */

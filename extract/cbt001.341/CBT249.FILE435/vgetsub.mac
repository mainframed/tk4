         MACRO
         VGETSUB
.*       THIS MACRO IS THE SUBROUTINE CALLED BY THE $VGET MACRO
.*       THE $VGET MACRO COPIES THE NAME OF THE ISPF VARIABLE
.*       INTO $ID WHICH IS PART OF THE NAMELIST
.*
.*       A VDEFINE IS THEN PERFORMED TO INFORM ISPF OF THE VARIABLE
.*       WE WANT.
.*
.*       A VGET IS THEN PERFORMED TO MOVE THE ISPF VARIABLE INTO
.*       OUR WORK AREA.
.*
.*       A VDELETE IS THEN DONE TO FREE THE STORAGE AND DEFINITION
.*
.*       REGISTER 1 IS THEN LOADED WITH THE ADDRESS OF THE DATA
.*       AND WE RETURN TO THE $VGET MACRO
.*
VGETSUB  DS    0H
         ST    R14,$RETURN
         CALL  ISPLINK,($VDEF,$SPFNLST,$SPFVAR,$SPFCHAR,$LEN,$OPT),VL
         CALL  ISPLINK,($VGET,$SPFNLST),VL
         CALL  ISPLINK,($VDELETE,$SPFNLST),VL
         LA    R1,$SPFVAR
         L     R14,$RETURN
         BR    R14                      RETURN TO CALLER
$RETURN  DS    F
$VDELETE DC    C'VDELETE'
$VDEF    DC    C'VDEFINE'
$SPFNLST DC    C'('
$ID      DC    CL8' ',C')'
$SPFCHAR DC    C'CHAR'
$LEN     DC    F'80'
$OPT     DC    C'(NOBSCAN)'
$VGET    DC    C'VGET'
$SPFVAR  DC    CL80' '
         MEND

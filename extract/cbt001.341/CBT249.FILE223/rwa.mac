         MACRO
         RWA
*
*  TSO PERFORMANCE MEASUREMENT SYSTEM RECORDER WORK AREA
*
*  THIS MACRO IS USED IN BOTH THE TSOPMS RECORDER (PC10040) AND IN
*  THE SMF ACCOUNTING EXIT IEFACTRT (PA01010).  THEREFORE, SHOULD THIS
*  MACRO BE CHANGED, BOTH OF THESE MODIFICATIONS MUST BE REINSTALLED.
*
RWA      DSECT
RWAID    DS    CL4            TABLE ID ('RWA ') INITIALIZE INDICATOR
RWASAVE  DS    15F            SAVE AREA FOR OUR REGS
RWATRANP DS    A              PTR TO CURRENT RWA U249 TRANSACTION AREA
TODREGS  DS    7F             REG SAVE AREA FOR GETTOD
         ORG   TODREGS
CSREGS   DS    5F             REG SAVE AREA FOR CHECKSMF
         ORG   TODREGS
GSREGS   DS    8F             REG SAVE AREA FOR GETSU
RWAEJST  DS    XL8            TRANS. START ELAPSED JOB STEP TIMING
RWARCDP  DS    A            PTR TO U249 RECORD IN SPECIAL GETMAIN AREA
RWATEMP3 DS    F              TEMPORARY WORK AREA
RWATEMP1 DS    D              TEMPORARY WORK AREA
RWATEMP2 DS    D              TEMPORARY WORK AREA
RWAPSS   DS    D              TRANS. START PAGE-SEC COUNT
RWA#TRAN DS    H              NUMBER OF TRANSACTIONS IN CURRENT BUFFER
RWAIOSM  DS    H              TRANS. START IO SERVICE MEASURE
RWAIND1  DS    X              INDICATOR BYTE
RWATA    EQU   X'80'          IF ON, TRANSACTION IS ACTIVE
RWALOST1 EQU   X'40'          SMF RECORD NOT WRITTEN DUE TO GETMAIN
         TITLE 'SMF 249 RECORD IN THE RECORDER WORK AREA'
*
*  RECORD FORMAT OF THE USER SMF 249 RECORD
*
         DS    0F
U249RDW1 DS    H              RECORD DESCRIPTOR WORD
U249RDW2 DS    H
U249     DS    0X             SMF USER RECORD 249
U249HDR  DS    0X             RECORD HEADER
U249SYS  DS    X              VS2 INDICATOR (X'02')
U249RT   DS    X              RECORD TYPE (X'F9')
U249TIME DS    XL4            TIME RECORD WRITTEN TO SMF IN .01 SECONDS
U249DATE DS    PL4            PACKED DATE RECORD WRITTEN TO SMF BUFFER
U249SYID DS    CL4            SYSTEM ID
U249USER DS    CL8   USERID PADDED RIGHT WITH BLANKS AND LENGTH BYTE
U249LINE DS    XL2            LINE ADDRESS OR 3705 RESOURCE ID
U249RCD# DS    XL2            RECORD SEQUENCE NUMBER
U249PGN  DS    X              PERFORMANCE GROUP NUMBER
U249RES1 DS    XL5            RESERVED FIELD # 1
U249HLEN EQU   *-U249HDR      LENGTH OF HEADER AREA
U249TRAN DS    0X             INDIVIDUAL TRANSACTION DATA
U249CMD  DS    CL8            COMMAND NAME
U249RES3 DS    XL4            RESERVED FIELD
U249SU   DS    XL4            SERVICE UNITS
U249ET   DS    XL4            TRANS. ELAPSED TIME TIME IN .01 SECONDS
U249END  DS    XL4            TRANS END TIME IN .01 SECONDS
U249IND1 DS    X              INDICATOR BYTE # 1
U249TGSS EQU   X'80'   TGET SATISFIED - START TRANSACTION
U249TOWS EQU   X'40'   TERMINAL OUTPUT WAIT - START TRANSACTION
U249TGSE EQU   X'20'   TGET SATISFIED - END TRANSACTION
U249TIWE EQU   X'10'   TERMINAL INPUT WAIT - END TRANSACTION
U249TOWE EQU   X'08'   TERMINAL OUTPUT WAIT - END TRANSACTION
U249EOSE EQU   X'04'   END OF SESSION - END TRANSACTION
U249PCMD EQU   X'01'          COMMAND IS PRIMARY, NOT SUBCOMMAND
U249RES2 DS    XL7            RESERVED FIELD # 2
U249TLEN EQU   *-U249TRAN     LENGTH OF TRANSACTION AREA
MAX#TRAN EQU   5              MAX NUMBER OF TRANSACTIONS PER SMF RECORD
         ORG   *+(MAX#TRAN-1)*(U249TLEN)  RESERVE THE REST OF THE TRANS
U249LEN  EQU   *-U249         LENGTH OF ONE U249 RECORD
RWALEN   EQU   *-RWA          RECORDER WORK AREA LENGTH
RWAEND   EQU   *
         ORG   RWA+400   CAUSE AN ASSEMBLER ERROR IF THE RWA BECOMES
RWALEFT  EQU   *-RWAEND  BIGGER THAN 400 BYTES SINCE THIS IS ALL
*                        THE SPACE WHICH IS RESERVED IN THE UCOMAREA.
*                             NOTE: RWALEFT EQUALS THE NUMBER OF BYTES
*                             LEFT IN THE RWA AREA OF THE UCOMAREA
*                             WHICH ARE NOT BEING USED.
         MEND

         PROC 0 TEST(NO)
         SET WHAT = &STR(INFO/MVS UTILITY)
         SET MSG   = &STR()
         CONTROL NOMSG NOFLUSH
         IF &TEST = YES THEN CONTROL LIST SYMLIST MSG
         SET A     = &STR()
         SET B     = &STR()
         SET C     = &STR()
         SET D     = &STR()
         SET OINF2 = &STR()
         SET RINF2 = &STR()
         SET CIN2  = &STR()
         SET DINF2 = &STR()
         ISPEXEC VGET (A B C D OINFO2 RINF2 CIN2 DINF2) PROFILE
L000:    ERROR OFF
         ISPEXEC DISPLAY PANEL(VINFO1) MSG(&MSG) CURSOR(A)
         IF &LASTCC >= 8 THEN EXIT CODE(0)
         ISPEXEC VPUT (A B C D) PROFILE
         ISPEXEC DISPLAY PANEL(VINFO2)
         IF &LASTCC >= 8 THEN GOTO L000
         ISPEXEC VPUT (OINFO2 RINF2 CIN2 DINF2) PROFILE
         SET MSG   = &STR()
         FREE FILE(VSAM,VSAM2,VSAM3,VSAM4,A80)
         SET OUT = &STR()
         IF &OINFO2 ^= &STR() THEN DO
           FREE FI(OZPRINT)
           IF &OINFO2 = 1 THEN SYSOUT FI(OZPRINT) SYSOUT(A) CHARS(&CIN2)
           ELSE IF &OINFO2 = 2 THEN SET OUT = &STR(,C,R=&RINF2)
           ELSE IF &OINFO2 = 3 THEN DO
             ERROR DO
               ATTRIB A80 LRECL(80) RECFM(F B) BLKSIZE(6160)
               ALLOC FILE(OZPRINT) DSN(&DINF2) NEW CAT +
               SPACE(10 2) TRACKS USING(A80)
               SET CDSN = &DINF2
               SET MSG = TECA000
               GOTO L120
               END
             ALLOC FILE(OZPRINT) DSN(&DINF2) SHR
L120:        ERROR OFF
             END
           END
         ELSE SET OUT = &STR(,C)
         IF &A = 1 THEN +
         ALLOC FILE(VSAM) DSN('BLGOZS.VSAM') SHR
         ELSE IF &A = 2 THEN +
         ALLOC FILE(VSAM) DSN('BLGOZS.VTAM.VSAM') SHR
         ELSE IF &A = 3 THEN +
         ALLOC FILE(VSAM) DSN('BLGOZS.IMS.VSAM') SHR
         ELSE IF &A = 4 THEN +
         ALLOC FILE(VSAM) DSN('BLGOZS.AMS.VSAM') SHR
         ELSE IF &A = 5 THEN +
         ALLOC FILE(VSAM) DSN('BLGOZS.CBT.VSAM') SHR
         ELSE IF &A = 6 THEN +
         ALLOC FILE(VSAM) DSN('BLGOZS.TEC.VSAM') SHR
         ELSE +
         ALLOC FILE(VSAM) DSN('BLGOZS.VSAM') SHR
         IF &B = 1 THEN +
         ALLOC FILE(VSAM2) DSN('BLGOZS.VSAM') SHR
         ELSE IF &B = 2 THEN +
         ALLOC FILE(VSAM2) DSN('BLGOZS.VTAM.VSAM') SHR
         ELSE IF &B = 3 THEN +
         ALLOC FILE(VSAM2) DSN('BLGOZS.IMS.VSAM') SHR
         ELSE IF &B = 4 THEN +
         ALLOC FILE(VSAM2) DSN('BLGOZS.AMS.VSAM') SHR
         ELSE IF &B = 5 THEN +
         ALLOC FILE(VSAM2) DSN('BLGOZS.CBT.VSAM') SHR
         ELSE IF &B = 6 THEN +
         ALLOC FILE(VSAM2) DSN('BLGOZS.TEC.VSAM') SHR
         IF &C = 1 THEN +
         ALLOC FILE(VSAM3) DSN('BLGOZS.VSAM') SHR
         ELSE IF &C = 2 THEN +
         ALLOC FILE(VSAM3) DSN('BLGOZS.VTAM.VSAM') SHR
         ELSE IF &C = 3 THEN +
         ALLOC FILE(VSAM3) DSN('BLGOZS.IMS.VSAM') SHR
         ELSE IF &C = 4 THEN +
         ALLOC FILE(VSAM3) DSN('BLGOZS.AMS.VSAM') SHR
         ELSE IF &C = 5 THEN +
         ALLOC FILE(VSAM3) DSN('BLGOZS.CBT.VSAM') SHR
         ELSE IF &C = 6 THEN +
         ALLOC FILE(VSAM3) DSN('BLGOZS.TEC.VSAM') SHR
         IF &D = 1 THEN +
         ALLOC FILE(VSAM4) DSN('BLGOZS.VSAM') SHR
         ELSE IF &D = 2 THEN +
         ALLOC FILE(VSAM4) DSN('BLGOZS.VTAM.VSAM') SHR
         ELSE IF &D = 3 THEN +
         ALLOC FILE(VSAM4) DSN('BLGOZS.IMS.VSAM') SHR
         ELSE IF &D = 4 THEN +
         ALLOC FILE(VSAM4) DSN('BLGOZS.AMS.VSAM') SHR
         ELSE IF &D = 5 THEN +
         ALLOC FILE(VSAM4) DSN('BLGOZS.CBT.VSAM') SHR
         ELSE IF &D = 6 THEN +
         ALLOC FILE(VSAM4) DSN('BLGOZS.TEC.VSAM') SHR
         CALL 'SYS1.LINKLIB(BLGOZD)' 'D=BCDEGHNPQSTUV&OUT'
         CLRSCRN
         ISPEXEC CONTROL DISPLAY REFRESH
         GOTO L000

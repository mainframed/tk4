1

                                                                       P





















                                   PT SUITE
1

                                                                       P
















 The suite of Performance Tools programs consists of four main parts:-


 INDEPENDENT SAMPLER   - High resolution collection of data to an
                         in storage buffer.

 DATA COLLECTION       - Dependent sampling.
                       - Record data for independent and dependent
                         sampling.
                       - Operator interface.

 HOUSEKEEPING          - Automatic report production.
                       - Archive data.

 ANALYSIS              - Real time (via TSO, via operator command).
                       - Post processors.
1

                                                                       P

 INDEPENDENT SAMPLER.

 The  sampler  program is STATDIE. This is a timer DIE routine with an i
 time of a quarter of a second. The DIE exit runs in the address space a
 the  time  of  interrupt  and  collects  PSW,  TCB,  ASID  and  LOCAL,
 information. The data is written to in storage buffers.


 DATA COLLECT.


 - DEPENDENT SAMPLING.

 The  dependent sampling consists of a timer routine with a period curre
 to  10  mins. The sampling consists of an SRB scheduled to every active
 space  which  collects CDE entries Additionally if Clearing is active a
 scheduled to extract the Work Scheduler Tables.

 - RECORD DATA.

 Data  collected  is  written  to a 2 cylinder 3350 dataset, one per sys
 program  detects  when this dataset is about to D37 and automatically i
 copy.   The   dataset   that  is  produced  by  this  copy  is  in  the
 X6/X16.OHIST.xyymmdd.Shhmmss.Ehhmmss where:-

          x = SYSTEM ID
          yymmdd = Year, Month, Day.
          Shhmmss = Start time of data.
          Ehhmmss = End time of data.

 - OPERATOR INTERFACE.

 The  operator interface was written to alter XXPTLOG but was modified t
 diagnostic programs to be run on the system. Currently there are three
 written to use this diagnostic interface.

 PUSE - To provide Paging usage.
 CPU - To provide CPU usage.
 ENQRES - To provide ENQ and RESERVE lookup.


 HOUSEKEEPING.

 - AUTOMATIC REPORT PRODUCTION.
1

                                                                       P


 Automatic  report jobs are fired into the system by the housekeeping pr
 produce reports for all systems for the last 24 hours.

 - ARCHIVE DATA.

 The  data  collected  in  the mini datasets are merged into one dataset
 period  within  the  24 hours and copied to tape. Old data of five days
 scratched after being archived.


 ANALYSIS.

 - REAL TIME.

 Currently the only real time processor is CPU as a TSO or PT command.

 - POST PROCESSORS.

 The  post  processing  programs  are  written  in  PL1. They at present
 reports  of  CPU  utilization,  SVC  usage, Clearing task usage and PSW
 These  are  a  direct  replacement for SCORE, the orignal PSW sampler a
 program.
1

                                                                       P





















                        MODULE DESCRIPTION FOR PT TASK.
1

                                                                       P

 XXPTALC1.

 - Dynalloc output file X6/X16.OLOGx.

 - LOAD module XXPTALC2.

 - Read through X6/X16.OLOGx and if any records present CALL XXPTALC2.

 - Return.

 - ABENDS.

      1 - If unable to allocate X6/X16.OLOGx.

 - MESSAGES.

      MSG8

 - MACROS

      XPTD1
      XPTD2
1

                                                                       P

 XXPTALC2.

 - LOCATE X6/X16.OLOGx to find out output volume name and type.

 - Format output dataset name.

 - Allocate output dataset.

 - Copy X6/X16.OLOGx to output dataset.

 - Return.

 - ABENDS.

      3 - X6/X16.ODISK not catalogued on 3330, 3350 or DDEN.
      4 - Unable to allocate output dataset.
      6 - Bad return from locate.

 - MESSAGES.

      MSG0,MSG1,MSG2,MSG3,MSG4,MSG5,MSG6,MSG7,MSG8 and MSG9

 - MACROS.

      XPTD1
1

                                                                       P

 XXPTALC3.

 - Allocate SYS1.PARMLIB member PTMPRMxx.

 - ABENDS.

      5 - Allocate failed.

 - MESSAGES.

      MSG8

 - MACROS.

      XPTD1
1

                                                                       P

 XXPTARC.

 -  Find  if  archive  has  not  been done for 24 hours and if GLOBAL sy
 arcgive job.

 - Issue STIMER to expire at 06.00 .

 - WAIT for timer or POST from XXPTLOG to terminate.

 - When timer expires, restart timer and if GLOBAL system run archive jo

 - ABENDS.

      None

 - MESSAGES.

      None.

 - MACROS.

      XPTD1
1

                                                                       P

 XXPTD1.

 - This is a data csect for communication and contains no code.
1

                                                                       P

 XXPTGO.

 - This is the job step task.

 - LOAD message module XXPTMESG for later use.

 - ENQ to find if a PT is already running and if so end.

 - ATTACH logging module XXPTLOG.

 - Obtain command buffer and wait for STOP/MODIFY.

 - If MODIFY:

      - D
          Go ATTACH display module.
      - A
          Go reattach XXPTLOG if not already running.
      - H
          Go ATTACH module XXPTHELP.
      - ANY OTHER
          Pass to XXPTLOG.

 - If STOP:-

      - Notify XXPTLOG to terminate.

      - WAIT for his completion.

      - DETACH module XXPTLOG.

      - DEQ.

      - Return.

 - ABENDS.

      None.

 - MESSAGES.

      MSG10,MSG11,MSG12,MSG13,MSG14,MSG15 and MSG29.

 - MACROS.
1

                                                                       P


      None.
1

                                                                       P

 XXPTHELP.

 - Issue WTO's specifying options for modify.

 - ABENDS.

      None.

 - MESSAGES.

      No numbered messages, all contained within module.

 - MACROS.

      None.
1

                                                                       P

 XXPTLOG.

 - LOAD data csect XXPTD1.

 - LOAD message module XXPTMESG.

 - Find centre and system identification via XXCPUID.

 - LOAD time convert module XXPTTIME.

 - LOAD output module XXPTPUT.

 - ATTACH archive module XXPTARC.

 - Obtain storage for output buffer.

 - Issue ESTAE to trap abends.

 - LINK to STATDIE to ensure he is running.

 - Issue STIMER to set report period.

 - WAIT for timer pop or POST of modify via XXPTGO.

 - If timer pop:

      - Ensure recording is active, if not return to wait.

      - Ensure STATDIE active if not no XXE0 records produced.

      - Scan STATDIE buffer and produce XXE0 records.

      -  Chain  through ASCB's passing control to each active processing
      in turn. (XXPTRUNn).

      - Return to wait.

 - If POST with a modify via XXPTGO:

      - E
          - Terminate via XXPTTERM to do cleanup.

      - K
          - ABEND with a USER 2 abend.
1

                                                                       P


      - N
          Reset sample count.

      - P
          DELETE   all   processing  programs  XXPTRUNx,  LOAD,CALL  and
          termination modules XXPTRTMn, CLOSE output file and return to

      - R
          Set mask to process module next time.

      - S
          Ensure  not  started  already,  LOAD module STATSTDE to get ad
          pageable buffers, LINK to XXPTALC3, LINK to XXPTALC1, OPEN par
          output  file, process parmlib information, CLOSE parmlib, prod
          machine  enviroment  record,  produce  XXE2/3  LPA/MPLA/PLPA
          LOAD/CALL/DELETE initialization modules XXPTRIMx and return to

      - V
          Reset timer interval.

 - ESTAE exit

      - Set abending flag.

      - Go to XXPTTERM.

 - ABENDS.

      2 - self inflicted destruct.

 - MESSAGES.

      MSG16,MSG17,MSG18,MSG19,MSG20,MSG21,MSG22,MSG23,MSG24,MSG25 and MS

 - MACROS.

      XPTD1
      XPTD2
1

                                                                       P

 XXPTMESG.

 - Obtain number of message.

 - Obtain insertion string if any.

 - Make up message in buffer.

 - Issue WTO.

 - Issue XXSIACP message to log.

 - ABENDS.

      None.

 - MESSAGES.

      ALL  messages  prefixed  PTM  are  issued  from  this  module, alt
      messages relate directly to the running of this module.

 - MACROS.

      None.
1

                                                                       P

 XXPTPUT.

 - WRITE output buffer.

 - If NOTE required take one.

 - CLOSE TYPE=T if required.

 - If output dataset is not full return.

 _ If full, CLOSE output, CALL module XXPTALC2, OPEN output.

 - Return.

 - ABENDS.

      None.

 - MESSAGES.

      None.

 - MACROS.

      XPTD1
      XPTD2
1

                                                                       P

 XXPTRIM1.

 - LOAD module XXPTSRB1 and find length/entry point.

 - Obtain SALLOC lock.

 - GETMAIN 4K of SQA in subpool 245.

 - Release SALLOC lock.

 - Move XXPTSRB1 to 4K area.

 - Complete pointers in 4K area.

 - DELETE module XXPTSRB1.

 - Return.

 - ABENDS.

      None.

 - MESSAGES.

      None.

 - MACROS.

      XPTD1
      XPTD4
1

                                                                       P

 XXPTRIM2.

 - LOAD module XXPTSRB2 and find length/entry point.

 - Obtain SALLOC lock.

 - GETMAIN 4K of SQA in subpool 245.

 - Release SALLOC lock.

 - Move XXPTSRB2 to 4K area.

 - Complete pointers in 4K area.

 - DELETE module XXPTSRB2.

 - Return.

 - ABENDS.

      None.

 - MESSAGES.

      None.

 - MACROS.

      XPTD1
      XPTD4
1

                                                                       P

 XXPTRTM1.

 - Obtain SALLOC lock.

 - FREEMAIN 4K of SQA core in subpool 245.

 - Release SALLOC lock.

 - Return.

 - ABENDS.

      None.

 - MESSAGES.

      None.

 - MACROS.

      XPTD1
      XPTD4
1

                                                                       P

 XXPTRTM2.

 - Obtain SALLOC lock.

 - FREEMAIN 4K of SQA core in subpool 245.

 - Release SALLOC lock.

 - Return.

 - ABENDS.

      None.

 - MESSAGES.

      None.

 - MACROS.

      XPTD1
      XPTD4
1

                                                                       P

 XXPTRUN1.

 - Build prototype XXE4/5 records.

 - Set STIMER running for 1 min.

 - SCHEDULE SRB to target address space.

 - WAIT for srb routine to complete or timer to pop.

 - If timer pops issue message and return.

 - Else compete XXE4/5 records and put out using XXPTPUT.

 - Return.

 - ABENDS.

      None.

 - MESSAGES.

      MSG28.

 - MACROS.

      XPTD1
      XPTD2
      XPTD4
1

                                                                       P

 XXPTRUN2.

 - Build prototype XXE6/7 records.

 - Set STIMER running for 1 min.

 - SCHEDULE SRB to target address space.

 - WAIT for srb routine to complete or timer to pop.

 - If timer pops issue message and return.

 - Else compete XXE6/7 records and put out using XXPTPUT.

 - Return.

 - ABENDS.

      None.

 - MESSAGES.

      MSG28.

 - MACROS.

      XPTD1
      XPTD2
      XPTD4
1

                                                                       P

 XXPTSRB1.

 - SETFRR to trap any abends.

 - Find CDE's.

 - Chain down CDE's moving program name and size to data area.

 - Obtain LOCAL lock.

 - XMPOST back to XXPTRUN1 to say buffer complete.

 - Release LOCAL lock.

 - Delete SETFRR.

 - Return

 - If FRR takes write an EREP record and return.

 - ABENDS.

      None.

 - MESSAGES.

      None.

 - MACROS.

      XPTD4
1

                                                                       P

 XXPTSRB2.

 - SETFRR to trap any abends.

 - Find Work Scheduler Tables.

 - Move to data area.

 - Obtain LOCAL lock.

 - XMPOST back to XXPTRUN2 to say buffer complete.

 - Release LOCAL lock.

 - Delete SETFRR.

 - Return

 - If FRR takes write an EREP record and return.

 - ABENDS.

      None.

 - MESSAGES.

      None.

 - MACROS.

      XPTD4
1

                                                                       P

 XXPTTERM.

 - Test if entered for ABEND if so SDUMP.

 - FREEMAIN any 4K areas of SQA obtained.

 - FREEMAIN output buffer.

 - POST module XXPTARC to tell him to return.

 - WAIT for XXPTARC to end.

 - DETACH module XXPTARC.

 - Return.

 - ABENDS.

      None.

 - MESSAGES.

      None.

 - MACROS.

      XPTD1
      XPTD4
1

                                                                       P

 XXPTTIME.

 - Obtain TOD clock value.

 - Format data and return to user.

 - Return.

 - ABENDS.

      None.

 - MESSAGES.

      None.

 - MACROS.

      XPTD1

1

                                                                       P
















                        MACRO DESCRIPTION FOR PT TASK.
1

                                                                       P











 XPTD1      -      Mapping macro for data csect XXPTD1.










 XPTD2      -      Mapping macro for output records.










 XPTD4      -      Mapping macro for 4K SQA area in subpool 245.
1

                                                                       P





















                            MACRO CROSS REFERENCE.
1

                                                                       P

 XPTD1 -

          XXPTALC1  XXPTALC2  XXPTALC3 XXPTARC XXPTLOG XXPTPUT XXPTRIM1
          XXPTRTM1 XXPTRTM2 XXPTRUN1 XXPTRUN2 XXPTTERM XXPTTIME.

 XXPTD2 -

          XXPTALC1 XXPTLOG XXPTPUT XXPTRUN1 XXPTRUN2.

 XXPTD4 -

          XXPTRIM1   XXPTRIM2   XXPTRTM1  XXPTRTM2  XXPTRUN1  XXPTRUN2
          XXPTSRB2 XXPTTERM.
1

                                                                       P
















                         MESSAGES ISSUED FROM PT TASK.
1

                                                                       P

 PTM000I LOCATE ERROR - CVOL NOT MOUNTED

 PTM001I LOCATE ERROR - NOT CATALOGED

 PTM002I LOCATE ERROR - DATASET ON LOWER LEVEL INDEX

 PTM003I LOCATE ERROR - DATASET ON HIGHER LEVEL INDEX

 PTM004I LOCATE ERROR - SYNTAX ERROR IN DSNAME

 PTM005I LOCATE ERROR - I/O ERROR ON CATALOG

 PTM006I LOCATE ERROR - INVALID TTR

 PTM007I LOCATE ERROR - INVALID WORK AREA POINTER

 PTM008I DYNAMIC ALLOCATION ERROR CODE ecde-icde DSN=xxxxxxxxxxxxxx

 PTM009I CONTROL FILE NOT CATALOGUED ON DISK

 PTM010I XXPTLOG has   ENDED
 PTM010I XXPTLOG HAS ABENDED S nnn
 PTM010I XXPTLOG HAS ABENDED Unnnn

 PTM011I MODIFY REJECTED - XXPTLOG BUSY

 PTM012I MODIFY ACCEPTED - DISPLAY FOLLOWS:

 PTM013I MODIFY REJECTED - PROGRAM NAME TOO LONG

 PTM014I DISPLAY has   ENDED
 PTM014I DISPLAY HAS ABENDED S nnn
 PTM014I DISPLAY HAS ABENDED Unnnn

 PTM015I MODIFY REJECTED - XXPTLOG ALREADY ATTACHED

 PTM016I MODIFY ACCEPTED BY XXPTLOG

 PTM017I XXPTLOG START PROCESSING

 PTM018I XXPTLOG STOP PROCESSING

 PTM019I XXPTLOG TASK NUMBER n SUSPENDED
1

                                                                       P

 PTM020I XXPTLOG TASK NUMBER n REINSTATED

 PTM021I XXPTLOG INTERVAL TIME CHANGED

 PTM022I XXPTLOG SAMPLE COUNT CHANGED

 PTM023I STATDIE IS NOT ACTIVE - no XXE0 RECORDS BEING PRODUCED

 PTM024I SAMPLE COUNT COMPLETED - WAITING

 PTM025I XXPTLOG IS ENDING

 PTM026I XXPTLOG START REJECTED 'P' AND THE 'S' AGAIN

 PTM027I INVALID OR NO JOBNAME FOR CLEARING

 PTM028I NO RESPONSE FROM SRB ROUTINE - moduname

 PTM029I JOB ALREADY ACTIVE - START REJECTED
1

                                                                       P





















                             MESSAGE DESCRIPTION.
1

                                                                       P

 PTM000I - PTM007I
                All  messages  are  as  a  result  of a bad return code
                LOCATE macro (SVC 26).

 PTM008I
                Dynamic  allocation  SVC 99 has failed. The error code i
                and  the  information  code is 'icde', 'xxxxxxxx' is the
                name.

 PTM009I
                The  control  file  X6/X16.ODISK  is not catalogued on d
                3330, 3350 DDEN.

 PTM010I
                Notification  that  the logging task XXPTLOG has either
                abended.

 PTM011I
                XXPTLOG  is  either  processing  the  previous request o
                active.

 PTM012I
                The  requested  display  module has been ATTACHed and it
                follows.

 PTM013I
                The  modify command entered contained a jobname that was
                than 8 bytes.

 PTM014I
                Operator has issued request to reattach logging task XXP
                it is already active.

 PTM015I-PTM022I
                Notification that XXPTLOG has accepted the command.

 PTM023I
                XXPTLOG  has  detected  that  the  DIE  routine of STATD
                longer active and therefore no XXE0 records containging
                etc are being produced.

 PTM024I
                The  internal  count  of  samples  has completed. ( The
                usually  only  used for testing and when live this messa
1

                                                                       P

                the system has been up for about 10 days !!! ).

 PTM025I
                XXPTLOG has accepted terminate command.

 PTM026I
                The  operator has issued a 'S' (start) command to XXPTLO
                is  already active, it must first be 'P'd (stopped) and
                (started).

 PTM027I
                The jobname entered for CLEARING is not valid.

 PTM028I
                Information  message.  An  SRB  routine (XXPTSRBx) has n
                memory  posted  the  issuer  of  the srb (XXPTRUNx) he t
                assumes that the target address space has been terminate

 PTM029I
                The  ENQ test has found an ENQ outstanding and therefore
                there is a 'PT' already running.
1

                                                                       P





















                           MESSAGES CROSS REFERENCE
1

                                                                       P

 PTM000I -
          XXPTALC2

 PTM001I -
          XXPTALC2

 PTM002I -
          XXPTALC2

 PTM003I -
          XXPTALC2

 PTM004I -
          XXPTALC2

 PTM005I -
          XXPTALC2

 PTM006I -
          XXPTALC2

 PTM007I -
          XXPTALC2

 PTM008I -
          XXPTALC1 XXPTALC2 XXPTALC3

 PTM009I -
          XXPTALC2

 PTM010I -
          XXPTGO

 PTM011I -
          XXPTGO

 PTM012I -
          XXPTGO

 PTM013I -
          XXPTGO

 PTM014I -
          XXPTGO
1

                                                                       P


 PTM015I -
          XXPTGO

 PTM016I -
          XXPTLOG

 PTM017I -
          XXPTLOG

 PTM018I -
          XXPTLOG

 PTM019I -
          XXPTLOG

 PTM020I -
          XXPTLOG

 PTM021I -
          XXPTLOG

 PTM022I -
          XXPTLOG

 PTM023I -
          XXPTLOG

 PTM024I -
          XXPTLOG

 PTM025I -
          XXPTLOG

 PTM026I -
          XXPTLOG

 PTM027I -
          XXPTLOG

 PTM028I -
          XXPTRUN1 XXPTRUN2

 PTM029I -
1

                                                                       P

          XXPTGO

1

                                                                       P





















                              ABEND DESCRIPTION.
1

                                                                       P

 1 -
          Unable to allocate dataset X6/X16.OLOGx.
                Preceeded by message: - PTM008I

 2 -
          Self inflicted by use of 'K' command.
                Preceeded by message: - None

 3 -
          X6/X16.ODISK not catalogued on 3330, 3350 or DDEN.
                Preceeded by message: - PTM009I

 4 -
          Unable to allocate output dataset.
                Preceeded by message: - PTM008I

 5 -
          Allocate failed for SYS1.PARMLIB.
                Preceeded by message: - PTM008I

 6 -
          Bad return from LOCATE.
                Preceeded by message: -
                                        PTM000I  PTM001I PTM002I PTM003I
                                        PTM005I PTM006I PTM007I
1

                                                                       P





















                             ABEND CROSS REFERENCE
1

                                                                       P

 1 - XXPTALC1

 2 - XXPTLOG

 3 - XXPTLAC2

 4 - XXPTALC2

 5 - XXPTALC3

 6 - XXPTALC2
1

                                                                       P





















                MODULE DESCRIPTION FOR POST PROCESSING MODULES.
1

                                                                       P

 XXPPTCB - Tasking Monitor.

 Function:

          Analysis of CPU utilization by Task within a specified job.

 Inputs:

          ENVIN
                Enviroment File or Files from the 'PT' data collection s

          SYSIN
                Input parameters - see below.

 Output:

          PRINT
                Print file - see below.

 Description:
          This  program analyses the 'PT' data on a Task basis. It's mai
          for  investigation of Jobs that make heavy use of multi-taskin
          Clearing. In the case of clearing, additional information is c
          by  'PT'  to  enable  the  association of tasks with the Clear
          Scheduler Table.

          The output report is in the form of 100 columns, each of which
          activity of a single task. The indicator characters have the f
          significance:-

          0   = Active, but less than 1% CPU utilization.
          1-9 = 1% to 9% CPU.
          A   = 10% to 19% CPU.
          B   = 20% to 29% CPU.
          C   = 30% to 39% CPU.
          D   = 40% to 49% CPU.
          E   = 50% to 59% CPU.
          F   = 60% to 69% CPU.
          G   = 70% to 79% CPU.
          H   = 80% to 89% CPU.
          I   = 90% to 99% CPU.
          *   = 100%

          The  report  lists the SRB, TCB and the total CPU utilization
1

                                                                       P

          report  line  on the right of the printout. At the foot of eac
          page,  a 20X5 grid gives the sum of CPU utilization for each t
          the period covered by the page.

          At  the end of the report, or whenever all 100 task slots beco
          a  10X10  grid  is  produced  to identify the TCB associated w
          slot.

          When  all slots are full, and if the run is against Clearing,
          completed tasks are deleted from the table, and the table is c
          towards  the  left. This will give free positions for new task
          right of the grid.

 SYSIN Parameters.

          #.SDATE = yyddd           start and
          #.STIME = hhmmss          end dates and
          #.EDATE = yyddd           times. Default is
          #.ETIME = hhmmss          as per input file.
          #.SAMP = n                Number of 30 sec samples per line -
                                    default is 2. ( 1 min. )
          #.JOBNAME = 'jobname'     Target Jobname. Use upper case.
1

                                                                       P

          XXPPSCR - General Score Analysis

          Function:
          Analysis  of  CPU  utilization  for  a  job,  broken down into
          modules and system componants.

 Inputs:
          ENVIN -
                Enviroment file or files from the 'PT' suite of programs

          SYSIN -
                Input parameters - see below.

 OUTPUTS:
          PRINT -
                Print  file for 'score' graph and segementation analysis
                Must be

          MODMAP -
                Optional  print  file. If present, a module map of Commo
                Areas an the target address space will be produced.

          SVCPRINT -
                Optional  print  file.  If  present, an SVC activity map
                produced.


 Description:
          This  general  program  uses  'PT'  collected  data  to  analy
          utilization  by  system  components.  The information in 'PT'
          enviroment  records is used to construct a map of the storage
          the  machine.  One  Job/Asid is selected for analysis. PSW sam
          then 'Scored' against this storage map. These counts of 'hits'
          program components are used to produce graphs of CPU utilizati

          CPU SCORE ANALYSIS.

          This  report  produces  a graph of CPU utilization for various
          components.  The  key  to the symbols used in the graph appear
          end  of  the  report.  The  right  hand  side  of  the report
          information  on  locks  or  IRB  usage, and on tasks. This inf
          consists  of  counts  of  the  incidents  of  locks being held
          #.IRBREQ='1'b is specified in SYSIN, of IRB types in control.
          figure  is  the  average  number  of ready tasks in the target
1

                                                                       P

          space over this report period.

          SVC ANALYSIS.

          This report uses a 100 slot table to track CPU utilization of
          System  SVC'S  are allocated slots from the left of the table
          SVC'S are allocated from the right of the table.

          The graph entries have the following meanings:-
                0   = Active, but less than 1% CPU utilization.
                1-9 = 1% to 9% CPU.
                A   = 10% to 19% CPU.
                B   = 20% to 29% CPU.
                C   = 30% to 39% CPU.
                D   = 40% to 49% CPU.
                E   = 50% to 59% CPU.
                F   = 60% to 69% CPU.
                G   = 70% to 79% CPU.
                H   = 80% to 89% CPU.
                I   = 90% to 99% CPU.
                *   = 100%

          A  grid  is  printed at the foot of each page giving the perce
          SVC activity apportioned to each SVC in the table.
          A  table  is  produced  at the end of the report to enable slo
          related to actual SVC numbers.

          MODULE MAP.

          This  is  a map of storage by module names. In addition, certa
          names  are  used.  (e.g. PLPA). The left hand side of the prin
          '*'  markers.  These indicate the 'level' of the entries liste
          right  and  below. i.e. CSA and MLPA are at level '**', and IA
          at  level  '***', that is, within MLPA. Produce a module map a
          it, all will become clear.

          SEGMENTATION ANALYSIS.

          This report produces a breakdown of CPU utilization in the tar
          over  the  whole  of  the  selected period. It is used to 'zer
          program 'hot spots'. See the explaination of SYSIN parameters.

 SYSIN parameters.
1

                                                                       P

          #.SDATE = yyddd
          #.STIME = hhmmss
          #.EDATE = yyddd
          #.ETIME = hhmmss
                               Bounds  of  the  report.  Default  to who
                               file.
          #MAPTIME = hhmmss
                               Approximate  time  of map to be written t
                               file.  Only applicable if MODMAP file is
                               Defaults to begining of input file.
          #.JOBNAME = 'jobname'
                               Target  jobname.  Defaults  to  '#JOBLIST
                               indicates  selection  of  first  job  fou
                               'JOBLIST' candidates.
          #.JOBLIST(1 to 4) = 'jobname'
                               up  to  four  candidates  for target of t
                               Defaults  to  the  three  live  Clearing
                               (LKLIVRUN, LKLVCOLD and LKLVWARM) and LWT
          #.MINPC = n
                               Minimum percentage CPU utilization for se
                               Defaults to 1.
          #.SAMP = n
                               Number  of  blocks  of  PSW  samples  per
                               graph. Default to 2 - ie 1 minute per lin
          #.SEGNO = n
                               If  non-zero,  activates  segmentation  a
                               Number  of  segments into which target ar
                               be divided. Defaults is zero - no segemen
          #.SEGLVL = n
                               Percentage  below  which segment is not t
                               in  segmentation  report.  Default  is 1.
                               .01% .
          #.AREA = 'areaname'
                               Name   of   major  area  containing  segm
                               target.   Default   is  'VEQVREGN'.  Othe
                               candidates are 'NUCLEUS' or any name appe
                               '**' level in a 'MODMAP' print.
          #.MODULE = 'modname'
                               Default  is **NONE** - which means use AR
                               Can  be any name appearing below the 2 st
                               in  MODMAP print. If the module name is n
                               - the AREA name is used.
          #.OFFSET = n
                               Used  to offset to a module within an 'AR
1

                                                                       P

                               to  segment  an  SVC  program within the
                               this   OFFSET   number   is   a   decimal
                               representing an offset into 'AREA'. **see
          #.LENGTH = n
                               Used with offset. Defines the length, in
                               of the area to be retained from the OFFSE
                     **note.
                               The    two   parameters,   OFFSET   and
                               effectively   redefine  the  name  identi
                               'AREA'.  Their  main  use  is to manualy
                               NUCLEUS   or   load   modules   for  segm
                               purposes.  Later  releases  of  'PT'  may
                               automatic delinking of large program bloc
          #.IRBREQ = '0'b
                               IRB  report  request  flag. If #.IRBREQ =
                               entered,  the IRB version of the SCORE su
                               is produced.
1

                                                                       P





















                        MODULE DESCRIPTION FOR STATDIE.
1

                                                                       P

 Module:
          STATDIE
 Function:
          A  software  monitor  to measure cpu use, running as a self su
          disabled  exit  of  the  timer  second  level  interrupt handl
          standard  system  interfaces  are  used  and no system modific
          required. Periodically the exit receives control and samples t
          of  the system at the timer interrupt. Information is initiall
          in  a  fixed  trace buffer. When that fills up, an SRB is sche
          the  master  scheduler address space to copy the data to one o
          of common area pagable buffers.

          Currently  the  sampled  information  includes  the PSW at the
          interrupt,  active ASID, count of ready TCB'S on the dispatche
          SVC  number  if  an SVC is in control, active TCB address, rea
          this  address space, flags indicating if LOCAL lock , local su
          lock  and/or CMS locks are held, and flags indicating if an IR
          or  TIRB  was in control. In addition the 1st two bytes of PSA
          noted.  When  the  SRB is scheduled it also traces the current
          values,  the  RUA and CMPLT in the domain tables, and the fram
          counts in the PVT.
1

                                                                       P





















                       DESCRIPTION OF DISPLAY COMMANDS.
1

                                                                       P

 CPU.

 INPUT:
          F PT,D,CPU
          F PT,D,CPU,D
                ,D  causes  a delta picture using 600 DIE samples, else
                samples are used.

 OUTPUT:
          CPU UTILIZATION    11.1          SAMPLE SIZE           600
          SUPERVISOR STATE   86.5          TIME                19.20
          USERSTATE           5.9          AVG READY TCBS        0.1
          SUPERVISOR STATE IS  SVC: 47.7   SRB: 31.3   OTHER:   7.4
          key  PCT  ×  SVC  PCT  ×   PG  PCT  ×  JOB      PCT
           0  68.6  ×   0  10.4  ×   0   5.9  ×  INIT      64.1
           1  11.9  ×  10   5.9  ×   1  71.6  ×  PT        20.8
           2   0.0  ×  99   5.9  ×   2  22.3  ×  GPSA077    5.9
           3   0.0  ×  16   2.9  ×   3   0.0  ×  GXXA045    1.4
           4   0.0  ×  47   2.9  ×   4   0.0  ×  JES3       1.4
           5   2.9  ×  48   2.9  ×   5   0.0  ×  ********   0.0
           6   8.9  × 121   2.9  ×   6   0.0  ×  ********   0.0
           7   0.0  ×   1   1.4  ×   7   0.0  ×  ********   0.0
           8   7.4  ×  13   1.4  ×   8   0.0  ×  ********   0.0
           9   0.0  ×  19   1.4  ×   9   0.0  ×  ********   0.0
1

                                                                       P

 ENQRES.

 INPUT:
          F PT,D,ENQRES,G
                GLOBAL  display,  this  displays  all enqueues in the sy
                produces  a  very large display. It is recomended you do
                this format of ENQRES.

          F PT,D,ENQRES,C
                CONFLICT display, this displays all conflicting enqueues

          F PT,D,ENQRES,R
                RESERVE display, this displays all reserves.

          F PT,D,ENQRES,F,majname,minname,jobname
                FIND  display, majname,minname,jobname can be replaced b
                signify ALL.
                majname - major enqueue name for search.
                        'SYSDSN' will list all dataset enqueues.
                minname - minor enqueue name.
                        'datasetname' will find enqueues for this datase
                jobname - to list all enqueues for particular job.

 OUTPUT:

          The format of the display is as follows:
          1234 JJJJJJJJ VVVVVV-UUU MMMMMMMM NNNNNNNNNNNNNNNNNNNNNNNNNNNN

          1 - The scope of the enqueue, Y = system, J = step.
          2 - The type of enqueue, E = exclusive, S = shared.
          3 - The status of the enqueue, G = has resource, W = waiting.
          4 - The system scope of the enqueue, R = reserve.

          J - The job name of the enqueue address space.
          V - The volume serial on the reserved spindle.
          U - The unit address of the reserved spindle.
          M - the major resource name.
          N - The minor resource name.
1

                                                                       P

 PUSE.

          To display paging datsets and their usage.

 INPUT:
          F PT,D,PUSE

 OUTPUT:
           TIME  20.20.12 SYSTEM A   SLOTS   33280     VIO    167   NONV
           SLOTS UNRESERVED  31657    REVERVED BUT UNUSED   207  THRESHO
           TYPE   DSN            VOLSER DVAD  AVAIL   SIZE ERRORS   WGHT
          PLPA   F1P164.PLPA17   F1P164 164    928   2210        4725
          COMMON F1P165.CSA17    F1P165 165   1911   2210        5639
          LOCAL  F1P364.LOCAL64  F1P364 364   7927   8320        7441
          LOCAL  F1P365.LOCAL64  F1P365 365   7967   8320        7335
          LOCAL  F1P36C.LOCAL64  F1P36C 36C   7985   8320        6014
          LOCAL  F1P36D.LOCAL64  F1P36D 36D   7985   8320        5642
          SWAP   F1P36A.SWAP6    F1P36A 36A     49     60
          STASK TOTAL -   6      BATCH TOTAL-   3   TSO TOTAL-   6
1

                                                                       P





















                              PROGRAMMING NOTES.
1

                                                                       P

          DIE.

          'DIE'  stands  for disabled interrupt exit. In MVS there are t
          of  DIE'S.  One for IO and one for timer interrupts. The DIE i
          routine  in  fixed storage pointed to by a user supplied contr
          and  related  to  an outstanding service request which will ev
          generate  an interrupt. The DIE is an authorized system interf
          following discussion relates only to timer DIE'S.

          The  user supplied control block for timer services is the tim
          element  (TQE).  'USER'  here  must  be understood to be a bro
          because for most users the TQE is constructed and queued by th
          SVC  and not by the application program. With supervisor 2 ( S
          new system service routine was introduced to allow key 0 users
          easily  build  their  own  TQE'S. This service is call 'SETDIE
          documented in SPL: SUPERVISOR. There is no associated macro.

          Each  TQE contains an interrupt time and a pointer to the DIE
          All  timer management in a multiprocessor system is conducted
          if  it  has  an  operable  clock.  If this TQE represents the
          interrupt  in  the  queue, the clock comparator is changed. Ei
          can  access  the  TQE  chain while holding the dispatcher LOCK
          clock comparator must be changed, however, CPU 1 must SIGP CPU
          the processing.

          When  a  timer  interrupt is honoured on CPU 0, the timer seco
          interrupt  handler  dequeues the TQE and exits to the DIE indi
          it.  Control  is  received  in  the  address space dispatched
          interrupt  was  recognized,  physically  disabled,  with  the
          interrupt  and  registers  stored  in  the LCCA. The DIE exit
          reference  storage locations in SQA, fixed CSA, the NUCLEUS, o
          LSQA of the interrupted address space. It returns control to t
          SLIH which normally exits to the dispatcher.

          Prior  to  returning,  the DIE can reinitialize the TQE and re
          for  the  next  interrupt.  The  timer  DIE  is thus a self su
          process,  timer driven, but logically unrelated to any task or
          space  or  job. Once initialized it continues to function unti
          by   some  other  authorized  user  or  by  its  own  internal
          Furthermore,  it  is  a  user  exit and does not replace or ef
          standard  system routines. This technique is identical to that
          MF1  and  RMF  for their device and channel sampling exits, an
          SRM  for  its once-a-second system status evaluation and page
          exit, but it is a logically separate function.
1

                                                                       P





          DISPLAY MODULE INTERFACE.

          A  display module is just a normal program. It is always passe
          field  plus  additional  information  that  can  be  keyed  in
          operator.
          For  ASM  R1  contains  an  address of a pointer to H'100' fol
          C'/PT0'  followed by either 100 blanks (X'40') or the data key
          the operator.
          For PLI the PARM data is just 'PT0' plus blanks or operator da




          PROCESSING MODULE INTERFACE. (XXPTRIMx XXPTRUNx XXPTRTMx).

          1) Data csect XXPTD1 address is passed in R1.
          2) The savearea in XXPTD1 must be used.
          3)  4K  of SQA can be obtained in subpool 245, but its address
          placed in GETMx.
          4) For module to be called SYS1.PARMLIB must be updated.
          5)  79  bytes  may  be  passed to the module from SYS1.PARMLIB
          entry is found in PARMn.




          JCL FOR MEMBER PT ON SYS1.PROCLIB.

          //PT      EXEC PGM=XXPTGO,DPRTY=(12,10),TIME=1440




          SYS1.PARMLIB members PTMPRM00 etc

          1
          2J=LKLIVRUN
          3parm to be passed to XXPTRIM/RUN/RTM3
1

                                                                       P

          OUTPUT FILES.

          DCB is RECFM=F,LRECL=2016,BLKSIZE=2016
1

                                                                       P
















                         T U D O R   G .   J O N E S.

                       P E R F O R M A N C E   G R O U P

                      T E C H N I C A L   S E R V I C E S

              N A T I O N A L   W E S T M I N S T E R   B A N K .
1

//ASMI18S  JOB (ASMI,MI110,15U),CARTER,CLASS=E,
//             MSGCLASS=H,NOTIFY=ASMI18,PRTY=6
/*JOBPARM LINES=9999
//*
//*      UPDATED 08 DEC 81 TO FIT UZ37156 FROM 8107 TAPE.
//*
//*      THIS MOD CHANGES THE LINKAGE EDITOR AS FOLLOWS:
//*      1)  THE DSNAME AND VOLUME OF THE SYSLMOD DATA SET
//*          ARE ADDED TO THE MESSAGE OUTPUT,
//*      2)  THE AUTHORIZATION CODE MESSAGE IS SUPPRESSED
//*          IF THE CODE IS ZERO,
//*      3)  THE DATE AND TIME ARE STORED IN THE 'SSI' FIELD
//*          IF THE SETSSI STATEMENT IS ABSENT.  THE FORMAT
//*          IS HEX YDDDHHMM WHERE Y IS THE LAST DIGIT OF THE
//*          YEAR, JJJ IS THE JULIAN DAY, AND HHMM IS THE TIME.
//*      4)  THE MESSAGE 'DOES NOT EXIST BUT HAS BEEN ADDED'
//*          IS REPLACED WITH 'NOW ADDED'.
//*      5)  THE DATE AND TIME ARE PRINTED FOR EACH STOW.
//*
//*      BILL GODFREY, PLANNING RESEARCH CORPORATION, MCLEAN VA.
//*
//STEP1 EXEC SMP38E,PTS=DLIBJ1,DLIB=DLIBJ1,RES=DLIBJ1,RES2=ASMIJ1,
//         RUNIT2='3330'
//SMPCNTL  DD  *
 RESTORE S(LHEW000).
 RECEIVE S(LHEW000)    RC(RESTORE=4).
 APPLY S(LHEW000) DIS(NO) CHECK RC(RECEIVE=0).
 APPLY S(LHEW000) DIS(NO)       RC(APPLY=0).
/*
//SMPPTFIN DD  *
++ USERMOD(LHEW000)  /*  LINKAGE EDITOR MODS:  DSN, AUTHMSG, SSI, DATE.

         UPDATED 08 DEC 81 TO FIT UZ37156 FROM 8107 TAPE.

         THIS MOD CHANGES THE LINKAGE EDITOR AS FOLLOWS:
         1)  THE DSNAME AND VOLUME OF THE SYSLMOD DATA SET
             ARE ADDED TO THE MESSAGE OUTPUT,
         2)  THE AUTHORIZATION CODE MESSAGE IS SUPPRESSED
             IF THE CODE IS ZERO,
         3)  THE DATE AND TIME ARE STORED IN THE 'SSI' FIELD
             IF THE SETSSI STATEMENT IS ABSENT.  THE FORMAT
             IS HEX YDDDHHMM WHERE Y IS THE LAST DIGIT OF THE
             YEAR, JJJ IS THE JULIAN DAY, AND HHMM IS THE TIME.
         4)  THE MESSAGE 'DOES NOT EXIST BUT HAS BEEN ADDED'
             IS REPLACED WITH 'NOW ADDED'.  IT'S A LESS CONFUSING
             MESSAGE, AND IT GIVES US ROOM FOR THE DSNAME.
         5)  THE DATE AND TIME ARE PRINTED FOR EACH STOW.

         THE THIRD IS A REFIT OF SIMILAR ZAPS CONTRIBUTED TO SHARE,
         GUIDE, AND CBT BY VARIOUS INSTALLATIONS.
         THE OTHERS WERE DESIGNED BY
            BILL GODFREY, PLANNING RESEARCH CORPORATION, MCLEAN VA.
                                                           */ .
++ VER (Z038) FMID(EPM1102) PRE(UZ37156) /* 8107 */.
++ ZAP (HEWLFFNL) DISTLIB(AOS04).
 EXPAND HEWLFFNL(311)
 NAME HEWLFFNL
 VER  0000  05C0                          BALR  R12,0  BASE
 VER  012E  9110,20BE,4780                TM    APT2,SETSSI
 VER  015C  2228                                SSI BASE+DISP
 VER  019E  9110,20BE,4710                TM    APT2,SETSSI
 VER  020A  58A0,C862                     L     PRTREG,PRTWD1
 VER  02F8  58A0,C86A                     L     PRTREG,PRTWD3
 VER  033C  4850,2196            FNL900   LH    TEMP1,ENASC
 VER  046C  4490,C472,05EF                EX    MOVE DSN MSG
 VER  04FC  4EA0,C8B6                     CVD   R10,APFWORK
 VER  083E  09C1                 MESG5    DC    X'09',C'AUTH'
 VER  0874  11                   PRTWD5   DC    LEN/2 OF MESG5
 VER  09D0  0000,0000,0000,0000                 VERIFY PATCH
 VER  0AED  00                                  VERIFY PATCH
 REP  012E  47F0,CA3E                     B     PATCHSSI
 REP  01A2  47F0                          BC    15 ALWAYS SSI
 REP  02F8  58A0,C862                     L     PRTREG,PRTWD1
 REP  033C  47F0,CA82            FNL900   B     PATCHMSG  PRINT DATE
 REP  046C  45E0,C9CE                     BAL   R14,PATCHDSN
 REP  04FC  4580,CA68                     BAL   R8,PATCHAPF
 REP  09D0  4490,C472            PATCHDSN EX    SAME AS BEFORE
 REP  09D4  95C4,300F                     CLI   LINE+15,C'D'
 REP  09D8  4780,C9F8                     BE    MSG3
 REP  09DC  95D5,300F                     CLI   LINE+15,C'N'
 REP  09E0  077E                          BNER  R14
 REP  09E2  95D9,3013                     CLI   LINE+19,C'R'
 REP  09E6  4780,C9F0                     BE    MSG2
 REP  09EA  4190,3025            MSG1     LA     R9,LINE+37
 REP  09EE  47F0,C9FC                     B      MOVE
 REP  09F2  4190,3028            MSG2     LA     R9,LINE+40
 REP  09F6  47F0,C9FC                     B      MOVE
 REP  09FA  4190,303D            MSG3     LA     R9,LINE+61
 REP  09FE  5810,C726            MOVE     L      R1,=A(MINOR)
 REP  0A02  D22B,9000,1000                MVC    0(44,R9),0(R1)
 REP  0A08  4190,902B                     LA     R9,43(,R9)
 REP  0A0C  9540,9000            FIND     CLI    0(R9),C' '
 REP  0A10  4770,CA16                     BNE    *+8
 REP  0A14  4690,CA0A                     BCT    R9,FIND
 REP  0A18  D206,9001,CA36                MVC    1(7,R9),TAG1
 REP  0A1E  5810,C87E                     L      R1,DCBADRS2 DCB
 REP  0A22  5810,102C                     L      R1,44(,R1)  DEB
 REP  0A26  5810,1020                     L      R1,32(,R1)  UCB
 REP  0A2A  9180,1000                     TM     0(R1),X'80' VIO
 REP  0A2E  071E                          BOR    R14         YES
 REP  0A30  D205,9005,101C                MVC    5(6,R9),28(R1)
 REP  0A36  07FE                          BR     R14
 REP  0A38  40D6,D540,E5C9,D600  TAG1     DC     C' ON VIO'
 REP  0A40  4110,0002,0A0B       PATCHSSI TIME   DEC  00YYDDDF
 REP  0A46  9001,C8B6                     STM    R0,R1,APFWORK
 REP  0A4A  9110,20BE                     TM     APT2,SETSSI
 REP  0A4E  4710,C134                     BO     +136
 REP  0A52  9610,20BE                     OI     APT2,SETSSI
 REP  0A56  8810,0004                     SRL    R1,4 000YYDDD
 REP  0A5A  4010,2228                     STH    R1,SSI   YDDD
 REP  0A5E  8800,0010                     SRL    R0,16
 REP  0A62  4000,222A                     STH    R0,SSI+2
 REP  0A66  47F0,C134                     B      +0136
 REP  0A6A  4EA0,C8B6            PATCHAPF CVD    R10,APFWORK
 REP  0A6E  92C1,C83D                     MVI    MESG5+1,C'A'
 REP  0A72  9211,C872                     MVI    PRTWD5,17
 REP  0A76  12AA                          LTR    R10,R10 AUTH
 REP  0A78  0778                          BNZR  R8  YES, BRANCH
 REP  0A7A  9240,C83D                     MVI   MESG5+1,C' '
 REP  0A7E  9201,C872                     MVI   PRTWD5,1
 REP  0A82  07F8                          BR    R8
 REP  0A84  F342,CADB,C8BB       PATCHMSG UNPK  MES+25(5),APFWORK+5(3)
 REP  0A8A  D201,CADA,CADB                MVC   MES+24(2),MES+25
 REP  0A90  924B,CADC                     MVI   MES+26,C'.'
 REP  0A94  F121,C8BB,C8B6                MVO   APFWORK+5(3),APFWORK(2)
 REP  0A9A  F332,CAE8,C8BB                UNPK  MES+38(4),APFWORK+5(3)
 REP  0AA0  D201,CAE7,CAE8                MVC   MES+37(2),MES+38
 REP  0AA6  927A,CAE9                     MVI   MES+39,C':'
 REP  0AAA  41A0,CAC2                     LA    PRTREG,MES
 REP  0AAE  56A0,CABE                     O     PRTREG,MESL
 REP  0AB2  4580,C43C                     BAL   RET1,FNLPRTMG
 REP  0AB6  4850,2196                     LH    TEMP1,ENASC
 REP  0ABA  47F0,C33E                     B     FNL900+4
 REP  0ABE  0000
 REP  0AC0  1500,0000            MESL     DC    AL1(21),AL3(0) MSGLEN/2
 REP  0AC4  09                   MES      DC    X'09' SINGLE SPACE
 REP  0AC5  4040,4040,4040,4040           DC    C'        '
 REP  0ACD  4040,4040,4040,4040           DC    C'        '
 REP  0AD5  4040,C4C1,E3C5,40E8           DC    C'  DATE Y'
 REP  0ADD  E84B,C4C4,C440,40E3           DC    C'Y.DDD  T'
 REP  0AE5  C9D4,C540,C8C8,7AD4,D4        DC    C'IME HH:MM'
/*
//

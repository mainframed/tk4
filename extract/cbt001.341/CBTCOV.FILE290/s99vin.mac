 S99VIN: PROC(DDN,DSN,MRN,INFO,S99RC,S99ERROR,S99INFO);
      DCL (DDN,DSN,MRN,INFO) CHAR(*) VAR;
      DCL (S99RC,S99ERROR,S99INFO,I1) FIXED BIN(15);
      DCL 1 S99RB,
            2 VERB FIXED BIN(15) INIT(5127),
            2 FLAGS1 FIXED BIN(15) INIT(0),
            2 ERRORCODE FIXED BIN(15) INIT(0),
            2 INFOCODE FIXED BIN(15) INIT(0),
            2 S99TXTPP POINTER,
            2 RESERVED FIXED BIN(31) INIT(0),
            2 FLAGS2 FIXED BIN(31) INIT(0);
      DCL S99TUPL(11) POINTER;
      DCL 1 S99TUNIT(11),
            2 KEY FIXED BIN(15) INIT(1,5,6,7,8,9,10,11,12,13,14),
            2 NUM FIXED BIN(15) INIT((11) 1),
            2 PARM CHAR(44) VAR INIT(DDN,(44)' ',(8)' ',(3)(1)' ',
                                     (2)(2)' ',(3)(1)' ');
      DCL X80 BIT(8) BASED(X80PTR);
      DCL SVC99 EXTERNAL ENTRY(FIXED BIN(15)) RETURNS(FIXED BIN(15));
      S99TXTPP=ADDR(S99TUPL(1));
      DO I1=1 TO 11;
      S99TUPL(I1)=ADDR(S99TUNIT(I1).KEY);
      END;
      X80PTR=ADDR(S99TUPL(11));
      X80='10000000'B;
      S99RC=SVC99(S99RB.VERB);
      DSN=S99TUNIT(2).PARM;
      MRN=S99TUNIT(3).PARM;
      INFO='';
      DO I1=4 TO 11;
      INFO=INFO××S99TUNIT(I1).PARM;
      END;
      S99ERROR=S99RB.ERRORCODE;
      S99INFO=S99RB.INFOCODE;
      END S99VIN;

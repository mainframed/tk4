1S99VFR1: PROCEDURE(OP,COM) RETURNS(FIXED BIN(15,0)) REORDER;
    DECLARE
      ACT(12)            LABEL,
      OP                 FIXED BIN(15,0),
      COM                CHAR(*) VARYING;
    OP = OP - 4;
    IF S99TUPL# >= MAXTUPL#
       THEN RETURN(12);
    ELSE S99TUPL# = S99TUPL# + 1;
    IF OP > 12 × OP < 1
       THEN RETURN(20);
    ELSE GO TO ACT(OP);
-ACT(1):  /*  DSNAME(MEMBER NAME)  */
 ACT(2):
    IF SUBSTR(COM,1,44) = ' ' × INDEX(COM,',') > 0
       THEN RETURN(16);
    ELSE CALL SETUPL(2,1,SUBSTR(COM,1,44));
    IF SUBSTR(COM,45,8) ^= ' '
       THEN DO;
         IF S99TUPL# >= MAXTUPL#
            THEN RETURN(12);
         ELSE S99TUPL# = S99TUPL# + 1;
         CALL SETUPL(3,1,SUBSTR(COM,45,8));
       END;
    ELSE;
    RETURN(0);
-ACT(3):  /*  DDNAME  */
 ACT(4):
    IF LENGTH(COM) = 0 × LENGTH(COM) > 8 × VERIFY(COM,ALPHANUM ×× '@#$')
           > 0 × VERIFY(SUBSTR(COM,1,1),ALPHA ×× '@#$') > 0
       THEN RETURN(16);
    ELSE CALL SETUPL(1,1,COM);
    RETURN(0);
-ACT(5): /*  KEEP  */
    UNSPEC(TMP) = '0000000000000001'B ×× '00001000'B;
0ACT5A:
    CALL SETUPL(5,1,TMP);
    RETURN(0);
-ACT(6): /*  DELETE  */
    UNSPEC(TMP) = '0000000000000001'B ×× '00000100'B;
    GO TO ACT5A;
1ACT(7): /*  CATALOG  */
    UNSPEC(TMP) = '0000000000000001'B ×× '00000010'B;
    GO TO ACT5A;
-ACT(8): /*  UNCATALOG  */
    UNSPEC(TMP) = '0000000000000001'B ×× '00000001'B;
    GO TO ACT5A;
-ACT(9): /*  SYSOUT  */
    IF LENGTH(COM) = 0
       THEN DO;
         CALL SETUPL(24,0,'');
         RETURN(0);
       END;
    ELSE;
    CALL SETUPL(24,1,COM);
    RETURN(0);
-ACT(10): /*  DESTINATION  */
    IF LENGTH(COM) = 0 × LENGTH(COM) > 8 × VERIFY(COM,ALPHANUM) > 0
       THEN RETURN(16);
    ELSE CALL SETUPL(88,1,COM);
    RETURN(0);
-ACT(11): /*  HOLD  */
    CALL SETUPL(89,0,'');
    RETURN(0);
-ACT(12): /*  NOHOLD  */
    CALL SETUPL(10,0,'');
    RETURN(0);
 END S99VFR1;

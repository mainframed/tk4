//O1003519 JOB (VSP,008),
//             'JIM OLEKSIW ',CLASS=F,TIME=1,
//  MSGCLASS=A,NOTIFY=OLEKSIW,MSGLEVEL=1
//*
//*   SAS PROGRAM TO READ THE OUTPUT OF A GTF FILE FOR ANALYSIS
//*   OF THE VTAM SMS BUFFER TRACE RECORDS.   THESE RECORDS COULD
//*   BE READ DIRECTLY FROM THE GTF DATASET EXCEPT THAT I DID NOT KNOW
//*   WHERE TO FIND A DESCRIPTION OF THE GTF SMS RECORDS AT THE TIME.
//*
//*    JIM OLEKSIW, NORTHEAST UTILITIES SERVICE COMPANY
//*     P.O. BOX 270   HARTFORD CONNECTICUT  06101  (203-666-6911)
//*
//PRINT  EXEC PGM=AMDPRDMP
//TAPE   DD  DSN=USER.VTAMGTF,DISP=SHR
//SYSUT1 DD  UNIT=SCRATCH,DISP=NEW,SPACE=(CYL,(10,10))
//PRINTER  DD  DSN=&&TEMP,DISP=(,PASS),
//   DCB=(LRECL=121,BLKSIZE=3993,RECFM=FBA),
//   UNIT=SCRATCHA,SPACE=(CYL,(1,1),RLSE)
//SYSPRINT DD  SYSOUT=*
//*
//*  NOTE THAT TO COLLECT THE RECORDS YOU MUST START GTF WITH TRACE=USR
//*  VTAM:  F VTAM,TRACE,TYPE=SMS,ID=VTAMBUF   TO START
//*         F VTAM,NOTRACE,TYPE=SMS,ID=VTAMBUF   TO STOP
//*
//SYSIN    DD  *
   EDIT  DDNAME=TAPE,USR=FF0
    END
//ANAL  EXEC SAS79,OPTIONS='NODATE,LINESIZE=100,PAGESIZE=45'
//FT11F001  DD  SYSOUT=*
//FT12F001  DD  SYSOUT=*,CHARS=GF10
//GTFOUT  DD  DSN=&&TEMP,DISP=(OLD,DELETE),
//   UNIT=SCRATCHA,VOL=SER=SCRCHB
//SYSIN   DD  *
DATA WORK.BUFFERS ;
     LENGTH DEFAULT=4;
     INFILE GTFOUT ;
     DROP FLAG  JOBN  DUM LASTDAY LASTTIME ;
     RETAIN LASTDAY LASTTIME ;
Q00:
    INPUT @2 FLAG $2. @27 JOBN $4. @ ;
    IF FLAG EQ '**' THEN DO ;
       INPUT @17 DAY 3.  @49 TIME 5.2 ;
       LASTDAY = DAY ; LASTTIME = TIME ;
       DAY = DATEJUL(81000+DAY) ;  FORMAT DAY DATE7. TIME 6.2 ;
       RETURN ;
    END ;
    DAY = LASTDAY ; TIME = LASTTIME ;
   IF JOBN NE 'JOBN' THEN INPUT  ;
         IF JOBN NE 'JOBN' THEN GO TO Q00 ;
   INPUT @31 JOBNAME $8. ;  * YOU NOW HAVE JOBNAME LINE ;
   INPUT ;  * SKIP THE NEXT LINE (HEADINGS) ;
    Q1: INPUT @31 DUM $2. @ ; IF DUM NE 'IO' THEN INPUT;
    IF DUM NE 'IO' THEN GO TO Q1 ;
       INPUT @34 (IOMAX IOQ IOAVG IOTEX IOBUF IOTOT)
                 (HEX4. +1 HEX4. +1 HEX4. +1 HEX4. +1 HEX4. +1 HEX4. )
             +4  (PPMAX PPQ PPAVG PPTEX PPBUF PPTOT)
                 (HEX4. +1 HEX4. +1 HEX4. +1 HEX4. +1 HEX4. +1 HEX4. );
         Q2: INPUT @31 DUM $2. @ ; IF DUM NE 'LP' THEN INPUT;
         IF DUM  NE 'LP' THEN GO TO Q2 ;
       INPUT @34 (LPMAX LPQ LPAVG LPTEX LPBUF LPTOT)
                 (HEX4. +1 HEX4. +1 HEX4. +1 HEX4. +1 HEX4. +1 HEX4. )
             +4  (WPMAX WPQ WPAVG WPTEX WPBUF WPTOT)
                 (HEX4. +1 HEX4. +1 HEX4. +1 HEX4. +1 HEX4. +1 HEX4. );
         Q3: INPUT @31 DUM $2. @ ; IF DUM NE 'NP' THEN INPUT;
         IF DUM  NE 'NP' THEN GO TO Q3 ;
       INPUT @34 (NPMAX NPQ NPAVG NPTEX NPBUF NPTOT)
                 (HEX4. +1 HEX4. +1 HEX4. +1 HEX4. +1 HEX4. +1 HEX4. )
             +4  (LFMAX LFQ LFAVG LFTEX LFBUF LFTOT)
                 (HEX4. +1 HEX4. +1 HEX4. +1 HEX4. +1 HEX4. +1 HEX4. );
         Q4: INPUT @31 DUM $2. @ ; IF DUM NE 'CR' THEN INPUT;
         IF DUM  NE 'CR' THEN GO TO Q4 ;
       INPUT @34 (CRMAX CRQ CRAVG CRTEX CRBUF CRTOT)
                 (HEX4. +1 HEX4. +1 HEX4. +1 HEX4. +1 HEX4. +1 HEX4. )
             +4  (UEMAX UEQ UEAVG UETEX UEBUF UETOT)
                 (HEX4. +1 HEX4. +1 HEX4. +1 HEX4. +1 HEX4. +1 HEX4. );
         Q5: INPUT @31 DUM $2. @ ; IF DUM NE 'SF' THEN INPUT;
         IF DUM  NE 'SF' THEN GO TO Q5 ;
       INPUT @34 (SFMAX SFQ SFAVG SFTEX SFBUF SFTOT)
                  (HEX4. +1 HEX4. +1 HEX4. +1 HEX4. +1 HEX4. +1 HEX4. )
             +4  (SPMAX SPQ SPAVG SPTEX SPBUF SPTOT)
                 (HEX4. +1 HEX4. +1 HEX4. +1 HEX4. +1 HEX4. +1 HEX4. );
         Q6: INPUT @31 DUM $2. @ ; IF DUM NE 'AP' THEN INPUT;
         IF DUM  NE 'AP' THEN GO TO Q6 ;
       INPUT @34 (APMAX APQ APAVG APTEX APBUF APTOT)
                 (HEX4. +1 HEX4. +1 HEX4. +1 HEX4. +1 HEX4. +1 HEX4. );
 ARRAY I SFMAX SPMAX APMAX IOMAX PPMAX LPMAX WPMAX NPMAX LFMAX CRMAX
          UEMAX ;
         COUNT + 1 ;
         DO OVER I ;
                   IF I = 0 THEN I = . ;
         END ;
         OUTPUT ;
PROC SORT DATA=WORK.BUFFERS ;  BY DAY TIME COUNT ; ;
TITLE1 FIGURE 7. VTAM SMS BUFFER ANALYSIS  ;
TITLE2 NORTHEAST UTILITIES SERVICE COMPANY ;
PROC PRINT ; PROC MEANS MAXDEC=1 DATA=BUFFERS(DROP=DAY TIME) ;

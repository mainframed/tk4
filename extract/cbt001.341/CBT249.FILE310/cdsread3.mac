//BE008BBB JOB (TSO,008),'CDS PRINT  ',MSGLEVEL=1,MSGCLASS=A,CLASS=J,
//    TIME=30,NOTIFY=BE008BB
//*
//*  SAS PROGRAM TO READ OUTPUT OF SMP4 CDS
//*  USE YOUR SMP4 PROC, OVERRIDING THE SMPLIST DDNAME
//*  SORT THE OUTPUT IN ANY MANNER, OR SELECT JUST
//*  FMIDS THAT YOU NEED.
//*  PICK OFF RANGES OF DATES, OR WHATEVER
//*        JIM OLEKSIW, NORTHEAST UTILITIES SERVICE COMPANY
//*                     P.O. BOX 270 HARTFORD, CONNECTICUT  06101
//*
//STEP1     EXEC PUTSMP,A='*',SVOL=IPORES
//SMPLIST DD DSN=BE008BB.SMPCDS1.DATA,DISP=(NEW,CATLG),
//  VOL=SER=USTSO4,UNIT=SYSDA,
//  SPACE=(CYL,(10,5),RLSE),
//  DCB=(LRECL=121,BLKSIZE=18150,RECFM=FBA)
//SMPCNTL   DD   *
 LIST CDS SYSMOD .
//S1  EXEC SAS
//FT11F001  DD  SYSOUT=*
//FT12F001  DD  SYSOUT=*
//CDSIN DD  DSN=BE008BB.SMPCDS.DATA,DISP=SHR
//SYSIN DD  *
* SAS PROGRAM TO READ AND ANALYZE A CDS OUTPUT FROM SMP ;
DATA ;
  INFILE CDSIN ;
*OPTIONS TIME=90   ;
LENGTH TYPE $8 STATUS $15 FMID $8. ;
FORMAT TIME TIME8. ;
  INPUT @12 NYPE $4. @ ;    * LOOK FOR THE WORD 'TYPE' ;
  IF NYPE  = 'SUPE'     THEN DO ;
       OUTPUT;
       RETURN ;
  END ;
  IF NYPE = 'TYPE' THEN DO ;
   Z:INPUT @30 TYPE $8. @2 SYSMOD $8. ;
     LASTYPE = TYPE ;
   B:INPUT @12 TTATUS $7. @ ;
     IF TTATUS = 'LASTSUP'  THEN DO ;
          STATUS = 'LASTSUP';
          INPUT @30 FMID $8. ;
          OUTPUT ;
          RETURN ;
          END ;
     IF TTATUS= 'DELBY '   THEN DO ;
          STATUS = 'DELETED';
          INPUT @30 FMID $8. ;
          OUTPUT ;
          RETURN ;
          END ;
      DROP TTATUS MMID COUNT DT NYPE LASTYPE ;
     IF TTATUS = 'STATUS' THEN DO ;
        INPUT @30 STATUS $15. ;
      A:INPUT @12 MMID $4. @ ;
        IF MMID = 'FMID' THEN DO ;
           INPUT @30 FMID $8. ;
        AA:INPUT @12 DT $9. @ ;
           IF DT = 'DATE/TIME' THEN DO ;
              INPUT @22 ACTION $3.@30 YEAR 2.@33 DAY 3.@38 TIME TIME8.;
              OUTPUT ;
              COUNT = 0 ;
            C:INPUT @12 TYPE $4. @ ;
              IF TYPE = 'TYPE' THEN GO TO Z ;
              IF (TYPE='REQ '×TYPE='SUPI'×TYPE='PRE '×TYPE='LAST')
              THEN RETURN ;
              INPUT @22 ACTION @ ;
              IF (ACTION  = 'REC' × ACTION  = 'APP' × ACTION = 'ACC')
              THEN DO ;
                        INPUT @30 YEAR 2. @33 DAY 3. @38 TIME TIME8. ;
                        TYPE = LASTYPE ;
                        OUTPUT ;
                        END ;
              COUNT + 1 ;
              IF COUNT > 7 THEN RETURN ;
              GO TO C ;
           END ;
           ELSE DO ;
                INPUT ;
                GO TO AA ;
           END ;
     END ;
     ELSE DO;
          INPUT ;
          GO TO A ;
     END ;
  END ;
  ELSE DO ;
     INPUT ;
     GO TO B ;
  END ;
  END ;
ELSE RETURN ;


DATA ;
     SET ;
     DATE = DATEJUL(YEAR*1000 + DAY) ;
     IF DATE > '31JUL81'D ;  *** THIS SELECTS A RANGE OF DATES **** ;
     DROP DAY YEAR ;
     FORMAT DATE DATE7. ;


*PROC PRINT UNIFORM ;
*VAR SYSMOD TYPE FMID DATE TIME ACTION STATUS ;
TITLE1 NORTHEAST UTILITIES ENGINEERING COMPUTER SERVICES ;
TITLE2 IPO SYSTEM CDS LISTING ;
TITLE3 ORDERED BY SYSMOD ;


PROC SORT ;
     BY DATE TIME ;


PROC PRINT  UNIFORM ;
TITLE3 ORDERED BY TIME OF INSTALLATION ;
VAR DATE TIME SYSMOD TYPE FMID ACTION STATUS ;

//  JOBCARD OLEKSIW,MSGCLASS=A,TIME=90,CLASS=J,MSGLEVEL=1,
//   TYPRUN=HOLD
//*
//*   THIS PROGRAM READS THE SMF TAPE DATABASE AND PRODUCES A REPORT
//*   OF ALL OPENS OF A PARTICULAR VSAM FILE ...
//*   NOTE THAT WHEN A 'VERIFY' MAY OPEN THE FILE, AND A PROGRAM
//*   MAY CLOSE AND REOPEN THE SAME DATASET MANY TIMES ... THIS IS
//*   A GOOD WAY TO FIND OUT WHO THE "DOGS" ARE.
//*         JIM OLEKSIW, NORTHEAST UTILITIES SERVICE COMPANY
//*         P.O. BOX 270, HARTFORD CONNECTICUT 06101
//*
//SAS  EXEC SAS79,OPTIONS='LINESIZE=132'
//SMFIN DD DSN=SMFNOV,UNIT=TAPE,DISP=OLD,
//  VOL=(,,,6,SER=(SMNOV1,SMNOV2,SMNOV3,SMNOV4,SMNOV5,SMNOV6))
//SYSIN     DD  *
DATA     VSAMS ;
* QUICK AND DIRTY PROGRAM TO FIND OUT WHO HAS BEEN OPENING A
    VSAM DATASET ;
LENGTH REC_ID 2 ;
INFILE SMFIN END = ENDB LENGTH = L STOPOVER;
INPUT @2    REC_ID    PIB1.
   @;
   IF REC_ID = 62 THEN GO TO TYPE62 ;
DONE:
   INPUT; DELETE; RETURN ;
TYPE62:                             *    TYPE  62 RECRD;
  IF L < 136 THEN DO ; PUT _INFILE_ ; GO TO DONE ; END ;
   INPUT @3     STARTIME    SMFSTAMP8.
         @15    JOBNAME    $8.
                TSTAMP  SMFSTAMP8.
         @93    DSNAME $44.
         @31    USERID $8.
         ;
  IF DSNAME ='VSET2.LAWYER.VEHPM.CLUSTER' THEN OUTPUT ;
 FORMAT STARTIME TSTAMP DATETIME22. ;
 DROP REC_ID ;
PROC PRINT ;


   LIBSPOOL OBJECTIVE
  --------------------

ALLEVIATE PROBLEMS INVOLVED IN REVIEWING, COLLATING, STORING,
RETRIEVING A LARGE VOLUME OF PRODUCTION JOB CONTROL LANGUAGE LISTINGS.

       LIBSPOOL ATTEMPTS TO ADDRESS THESE PROBLEMS BY:

           1) PROVIDING AN AUTOMATIC REVIEW OF PRODUCTION TYPE JCL
              LISTINGS LOOKING FOR NON-NORMAL RESULTS BY MEANS OF A
              PREDEFINED SET OF ABEND CODES.

           2) AUTOMATING AND ORGANIZING THE STORING AND RETRIEVING
              OF ON-LINE JCL.

           3) AUTOMATING AND ORGANIZING THE ARCHIVING AND RETRIEVING
              OF JCL FROM ARCHIVE.

           4) CUTTING DOWN ON JCL PRINT OUTPUT.


   LIBSPOOL DATA SETS
  --------------------

          1) SHSW.LSLIB - CURRENT LIBRARIAN JCL LIBRARY
                          CONTAINS THE CURRENT JCL MODULES
                          GOTTEN FROM THE LIBSPOOL TASK.

          2) SHSW.LSARCLIB - RESTORE FROM LIBRARIAN ARCHIVE TAPE
                             LIBRARIAN JCL LIBRARY

          3) SHSW.LSADRLIB - ARCHIVE DIRECTORY
                             PARTIONED DATA SET CONTAINING INFORMATION
                             ON THE CONTENTS OF THE LIBRARIAN ARCHIVE
                             TAPES.

          4) PHGIOPS.OPS2339.DALYARCH - DAILY LIBRARIAN ARCHIVE TAPE

          5) PHGIOPS.OPS2340.WKLYARCH - WEEKLY LIBRARIAN ARCHIVE TAPE

   LIBSPOOL OPERATION
  --------------------

           LIBSPOOL RUNS AS A CONSOLE STARTED TASK THAT CAN BE
           STARTED AUTOMATICALLY AT IPL TIME AND WILL NORMALLY
           ALWAYS BE ACTIVE. IT WILL NEEDED TO BE STOPPED WHEN A
           DAILY ARCHIVE JOB IS RUN WHICH WILL REMOVE
           CHRONOLOGICALLY OLD JCL MODULES FROM THE LIBSPOOL DATA
           SET. THE LIBSPOOL PROGRAM 'JCLLIST' SHOULD BE LINKED
           INTO AN AUTHORIZED LINBRARY.

           LIBSPOOL CAN BE STOPPED WITH THE COMMAND:
                        P LIBSPOOL

           LIBSPOOL CAN BE STARTED UP WITH THE COMMAND:
                        S LIBSPOOL

           IF LIBSPOOL TERMINATES WITH AN ABEND
           A MESSAGE WILL BE WRITTEN TO THE OPERATOR
           INDICATING THAT LIBSPOOL IS NO LONGER RUNNING.
           THIS SHOULD INSURE THAT OPERATIONS WILL ALWAYS
           KNOW THAT LIBSPOOL IS ACTIVE. THE MESSAGE WILL NOT
           GO OFF THE OPERATOR CONSOLE UNTIL A REPLY OF ANY
           CHARACTER IS MADE TO IT.

           AT END EXECUTION FOR PRODUCTION JOBS SPECIFYING A
           SPECIFIC MSGCLASS ON THE JOB CARD LIBSPOOL WILL OBTAIN
           THE JCL AND SELECTED SYSOUT OUTPUT FROM JES2.
           LIBSPOOL WILL ONLY PROCESS JOBS RUN WITH A 'P' AS THE
           FIRST CHARACTER OF THE USER-ID. ALL OTHER JOBS USING A
           LIBSPOOL MSGCLASS WILL BE DELETED FROM THE SYSTEM.
           JCL OUTPUT WILL CONSIST OF:

                        1) JES LOG
                        2) JCL
                        3) EXECUTION MESSAGES

            SELECTED SYSOUT OUTPUT CAN BE CAPTURED BY SPECIFING
            SYSOUT=* ON THE DD STATEMENT OF THE SYSOUT WHICH IS
            DESIRED TO BE CAPTURED WITH THE JCL. EACH NON-JCL SYSOUT
            DATA SET IS LIMITED TO A MAXIMUM NUMBER OF LINES (750).THIS
            IS DONE TO PROTECT LIBSPOOL AGAINST DISK SPACE PROBLEMS.

            THIS OPTION WILL ONLY FUNCTION FOR JOBS THAT
            ARE RUN ON THE NIA NODE WHOSE PRINT IS NOT ROUTED TO
            ANOTHER NODE. THIS OPTION IS NOT AVAILIABLE FOR JOBS RUN
            ON ANOTHER NODE (EG. HOU) WHOSE PRINT (JCL) IS ROUTED
            BACK TO THE NIA NODE. JCL (JES2 LOG, JCL, EXECUTION
            MESSAGES) IS THE ONLY SYSOUT OUTPUT THAT CAN BE CAPTURED
            BY LIBSPOOL FOR JOBS RUN ON ANOTHER NODE. LIBSPOOL WILL
            NOT OPERATE PROPERLY IF A NON-JCL SYSOUT (SYSOUT=*) IS
            SENT BACK TO THE NIA NODE. EVERY EFFORT SHOULD BE MADE
            TO AVOID THIS SITUATION. (SYSOUT=* OUTPUT CAN ONLY BE
            CAPTURED BY LIBSPOOL FOR ONE STEP JOBS RUN ON ANOTHER

            THE LIBSPOOL DATA SET WILL ALLOW APPROXIMATELY A MAXIMUM
            OF 15,000 RECORDS PER JOB. PRINT LINES GREATER THAN 80
            CHARACTERS WILL TAKE 2 RECORDS WHEN STORED BY LIBSPOOL.


            LIBSPOOL WILL SCAN THE JCL LOOKING FOR A MATCH ON A
            PRE-DEFINED SET OF ABEND CONDITIONS. A MATCH OF
            ANY OF THE FOLLOWING IBM MESSAGE IDENTIFICATIONS WILL RESULT
            IN THE JCL TO BE QUEUED FOR OUTPUT UNDER SYSOUT CLASS J.

                  IEF251I - JOB CANCELLED
                  IEF283I - NOT DELETED X
                  IEF287I - NOT RECTLGD/CATALGD/UNCATLGD
                  IEF450I - ABEND
                  IEF451I - ENDED BY CC
                  IEF452I - JOBFAIL/JOB NOT RUN JCL ERROR
                  IEF453I - JOB FAILED - JCL ERROR

              THE JOB CARD MSGCLASS PARAMETER IS USED TO CONTROL:

                  1) SELECTION OF JCL OUTPUT BY LIBSPOOL
                  2) PRINTING OF THE JCL
                  3) PRINTING OF THE JCL BASED ON CONDITION CODE
                     VALUES ALLOWED

              THE FOLLOWING IDENTIFIES THE MSGCLASS VALUES THAT
              LIBSPOOL WILL SELECT FOR PROCESSING AND THE CONDITION
              CODE VALUES THAT ARE ALLOWED FOR THAT MESSAGE CLASS.

                 MSGCLASS                USAGE
                 ________        _______________________
                    X            JCL OF THIS MSGCLASS WILL ALWAYS PRINT.
                    W            CONDITION CODES GREATER THAN 0 QUEUES
                                 JCL TO BE PRINTED UNDER SYSOUT CLASS J.

              AS JCL IS PROCESSED BY LIBSPOOL FOR A JOB, A WTOR
              MESSAGE IS WRITTEN BY LIBSPOOL TO INDICATE TO THE OPERATOR
              WHAT LIBSPOOL FOUND WHEN IT SCANNED THE JCL. THE WTOR
              MESSAGES WILL REMAIN ON THE OPERATOR CONSOLE UNTIL A REPLY
              OF ANY CHARACTER IS MADE TO IT. MORE THAN ONE WTOR CAN BE
              OUTSTANDING FROM LIBSPOOL AT A TIME. THE FORMAT OF THE
              MESSAGES IS:

              LIBSPOOL: XXXXXXXX-YYYY-Z - MMMMMMMMMMMMMMMMMMMMMM

              WHERE XXXXXXXX - JOB NAME
                        YYYY - JOB NUMBER
                           Z - JOB MSGCLASS
                        MM.. - MESSAGE (MAXIMUM OF 22 CHARACTERS)

              A JOB RUN UNDER MSGCLASS W THAT RUNS WITHOUT A ABEND
              OR CONDITION CODE GREATER THAN ZERO OR ANY OTHER PROBLEM
              SUCH AS A NOT CATALOGED OR NOT DELETED MESSAGE WILL HAVE
              THE FOLLOWING MESSAGE - 'SUCCESSFULLY COMPLETED'.

              A JOB RUN UNDER MSGCLASS X THAT RUNS WITHOUT A ABEND
              OR ANY OTHER PROBLEM
              SUCH AS A NOT CATALOGED OR NOT DELETED MESSAGE WILL HAVE
              THE FOLLOWING MESSAGE - 'PRINTED - PRINT MSGCLS'.

              WHEN A JOB IS PRINTED BECAUSE OF A PROBLEM, LIBSPOOL
              WILL PUT ANY ONE OF THE FOLLOWING IN THE MESSAGE WRITTEN
              TO THE OPERATOR.

                 *****  ABENDED  *****
                 *** JOB CANCELLED ***
                 DATA SET NOT CATALOGED
                  DATA SET NOT DELETED
                 JOB ENDED BY COND CODE
                 ***** JCL ERROR *****
                 CONDITION CODE > 0000
                 PRINTED - NOT EXECUTED

              THIS SHOULD HIGHLIGHT TO THE OPERATOR THE REASON FOR THE
              PRINTING OF THE JCL AND HELP IN RESULTING IN THE PROPER
              FOLLOW-UP ACTION.

              IT SHOULD BE NOTED THAT A PRINTED JOB FOR ANY OF THE
              REASONS IN THE ABOVE LIST COULD HAVE MORE THAN
              ONE PROBLEM RECOGNIZED BY LIBSPOOL. HOWEVER, MESSAGES WILL
              BE USED IN THE ORDER PRESENTED ABOVE. FOR EXAMPLE, A JOB
              COULD HAVE ABENDED AND HAVE A NOT CATALOGED MESSAGE IN A
              PRIOR STEP. LIBSPOOL WILL INDICATE AN ABEND FOR THE JOB
              BUT NOT THE NOT CATALOGED CONDITION.

              IN ALL CASES THE JCL WILL BE ADDED TO THE LIBSPOOL
              LIBRARIAN DATA SET. LIBSPOOL COSTRUCTS AN EIGHT (8)
              CHARACTER LIBRARIAN MODULE NAME FOR THE JCL OF THE
              FOLLOWING FORMAT:

                        BYTE  1   - LETTER A THRU Z
                        BYTES 2-4 - JULIAN DAY NUMBER
                        BYTES 5-8 - JES2 JOB NUMBER

              THE LETTER IN THE FIRST BYTE IS NORMALLY 'A' BUT WILL BE
              INCREMENTED THRU Z IF IT IS FOUND THAT A MODULE ALREADY
              EXISTS ON THE LIBSPOOL LIBRARIAN DATA SET OF THAT NAME.

              WHILE THE JCL IS ON-LINE IN THE LIBSPOOL DATA SET
              THE LIBSPOOL CLIST CALLS PROGRAM OPS4318G TO INQUIRE
              INTO THE LIBSPOOL DATA SET SCANNING FOR MATCHES ON ANY
              ONE OF THE FOLLING CRITERIA:

                    1) GENERIC JOB NAME
                    2) USER-ID OF THE JOB
                    3) JOB NUMBER
                    4) LIBRARIAN MODULE NAME
                    5) ALL MODULES

              A FORMATTED DISPLAY WILL BE MADE BACK TO THE TERMINAL
              SHOWING ANY MODULES THAT MATCHED THE SELECTION CRITERIA
              USED. INFORMATION DISPLAYED WILL CONSIST OF:

                    1) JOB NAME
                    2) USER-ID
                    3) RUN DATE
                    4) START RUN TIME
                    5) END RUN TIME
                    6) LIBRARIAN LIBSPOOL MODULE NAME

              AN 'END OF DATA' MESSAGE APPEARS AFTER ALL THE DATA
              HAS BEEN SCANNED.
              A 'MODULE NOT FOUND' OR
              'NO MATCHES FOUND' MESSAGE APPEARS IF NO MATCH IS
              FOUND ON THE SEARCH CRITERIA USED.

              USING THE INFORMATION FROM THE ABOVE DISPLAY
              TO IDENTIFY THE RUN(S) IN QUESTION
              THE USER CAN THEN USE THE LIBSPOOL MODULE NAME TO
              SELECT THE JCL OF INTEREST FOR DISPLAY,PRINT OR LIBGET
              THRU USE OF THE LIBSPOOL CLIST.

              JOBS CANCELLED BEFORE BEING SCHEDULED FOR EXECUTION
              ARE ALSO CAPTURED BY LIBSPOOL BUT NOT PRINTED. THE
              RUN DATE USED WILL BE THE DATE THE JCL WAS ADDED
              TO THE LIBSPOOL LIBRARIAN DATA SET.

              DAILY, A BATCH ARCHIVE JOB WILL BE RUN TO REMOVE
              CHRONOLOGICALLY OLD JCL MODULES FROM THE LIBRARIAN
              LIBSPOOL DATA SET TO A LIBRARIAN ARCHIVE TAPE DATA SET.
              THE CONTENTS OF THE ARCHIVE TAPES GENERATED IS
              MAINTAINED IN A ONLINE ARCHIVE DIRECTORY DATA SET.
              THE LIBSPOOL CLIST CALLS PROGAM OPS4319G
              TO INQUIRE INTO THIS DATA SET USING
              THE SAME SELECTION CRITERIA USED IN
              INTERROGATING THE LIBSPOOL DATA SET.

                    1) GENERIC JOB NAME
                    2) USER-ID OF THE JOB
                    3) JOB NUMBER
                    4) LIBRARIAN MODULE NAME
                    5) ALL MODULES

              THE SELECTION IS QUALIFIED BY A DATE INTERVAL BASED
              ON THE RUN DATE FOR A JOB. A DISPLAY WILL BE MADE
              BACK TO THE TERMINAL INDICATING THE ARCHIVE TAPE
              DATA SET NAME FOLLOWED BY THE THE FOLLOWING DATA
              OF THE MODULES WHICH SATISFIED THE SELECTION
              CRITERIA WITHIN THE DATE INTERVAL SPECIFIED.

                    1) JOB NAME
                    2) USER-ID
                    3) RUN DATE
                    4) START RUN TIME
                    5) END RUN TIME
                    6) LIBRARIAN LIBSPOOL MODULE NAME

              KNOWING THE ARCHIVE TAPE DATA SET NAME AND THE
              LIBRARIAN MODULE NAME OF THE JCL IN QUESTION THE LIBSPOOL
              CLIST CAN BE USED TO SUBMIT A JOB TO BATCH TO RESTORE
              THE MODULE TO A RESTORE FROM ARCHIVE DATA SET. THE
              LIBSPOOL CLIST AGAIN CAN BE USED TO INTERROGATE THIS
              DATA SET AS WOULD BE DONE TO THE CURRENT LIBSPOOL DATA
              SET.

              THE DAILY ARCHIVE JOB ALSO GENERATES A REPORT WHICH IS
              FILED IN OPERATIONS. THIS REPORT INDICATES THE
              CONTENTS OF THE ARCHIVE TAPE DATA SET NAME IDENTIFIED
              IN THE HEADING. THE SEQUENCE OF THE REPORT IS JOB NAME,
              RUN DATE, RUN TIME. THIS REPORT IS ANOTHER WAY OF
              DETERMINING THE CONTENTS OF THE ARCHIVE TAPES.


   MEMBER DESCRIPTIONS
  ---------------------
OPS4318G - THIS IS A ASM PROGRAM WHICH IS RESPONSIBLE FOR DOING INQUIRY
          INTO THE LIBSPOOL LIBRARIAN DATA SET. IT IS INVOKED IN THE
          FOREGROUND FROM THE LIBSPOOL CLIST.

           INPUT:  PARAMETER INPUT OF THE FORMAT

                    PARM A-G     1 BYTE
                    USER ID      7 BYTES-TSO USER INVOKING THIS PROGRAM
                    NAME         0-8 BYTES DEPENDING ON PARM.

             WHERE: PARM CAN BE

                 A - SEARCH THE LIBRARIAN LIBSPOOL DATA SET FOR
                     ALL MATCHES ON THE PASSED GENERIC JOB NAME.
                     (1-8 BYTES)

                 B - SEARCH THE LIBRARIAN LIBSPOOL DATA SET FOR
                     ALL MATCHES ON THE PASSED USER ID (7 BYTES).

                 C - SEARCH THE LIBRARIAN LIBSPOOL DATA SET FOR
                     ALL MATCHES ON THE PASSED JOB NUMBER (4 BYTES).

                 D - SEARCH THE LIBRARIAN LIBSPOOL DATA SET FOR
                     ALL MATCHES ON THE PASSED LIBSPOOL LIBRARIAN
                     MODULE NAME. (8 BYTES).

                 E - SEARCH THE LIBRARIAN LIBSPOOL DATA SET FOR
                     ALL MODULES CURRENTLY ON THE LIBSPOOL DATA
                     SET.


         THE ABOVE INQUIRY RESULTS IN A DISPLAY BEING MADE BACK TO THE
         TSO TERMINAL SHOWING AN INDEX LIST OF MATCHES WHICH INDICATES
         JOB NAME, JOB NUMBER, USER ID, LIBRARIAN MODULE NAME, RUN DATE
         START RUN TIME, END RUN TIME.

                 F - DISPLAY THE PASSED LIBSPOOL LIBRARIAN MODULE
                     NAME BACK TO THE TSO TERMINAL.

                 G - PRINT THE PASSED LIBSPOOL LIBRARIAN MODULE
                     NAME .


OPS4319G - THIS IS A ASM PROGRAM WHICH IS RESPONSIBLE FOR DOING INQUIRY
          INTO THE LIBSPOOL ARCHIVE DIRECTORY DATA SET. IT IS INVOKED IN
          THE FOREGROUND FROM THE LIBSPOOL CLIST.

      INPUT: 1) LIBSPOOL ARCHIVE DIRECTORY DATA SET MEMBERS
             2) PDS DIRECTORY OF THE LIBSPOOL ARCHIVE DIRECTORY DATA SET
             3) PARAMETER INPUT OF THE FORMAT

                    PARM A-E     1 BYTE
                    USER ID      7 BYTES-TSO USER INVOKING THIS PROGRAM
                    SCAN START DATE   6 BYTES-YYMMDD
                    SCAN END DATE     6 BYTES-YYMMDD
                    NAME         0-8 BYTES DEPENDING ON PARM.

             WHERE: PARM CAN BE

                 A - SEARCH THE ARCHIVE DIRECTORY LIBSPOOL DATA SET FOR
                     ALL MATCHES ON THE PASSED GENERIC JOB NAME.
                     (1-8 BYTES)

                 B - SEARCH THE ARCHIVE DIRECTORY LIBSPOOL DATA SET FOR
                     ALL MATCHES ON THE PASSED USER ID (7 BYTES).

                 C - SEARCH THE ARCHIVE DIRECTORY LIBSPOOL DATA SET FOR
                     ALL MATCHES ON THE PASSED JOB NUMBER (4 BYTES).

                 D - SEARCH THE ARCHIVE DIRECTORY LIBSPOOL DATA SET FOR
                     ALL MATCHES ON THE PASSED LIBSPOOL LIBRARIAN
                     MODULE NAME. (8 BYTES).

                 E - SEARCH THE ARCHIVE DIRECTORY LIBSPOOL DATA SET FOR
                     ALL MODULES CURRENTLY ON THE LIBSPOOL DATA
                     SET.


         THE ABOVE INQUIRY RESULTS IN A DISPLAY BEING MADE BACK TO THE
         TSO TERMINAL SHOWING AN INDEX LIST OF MATCHES WHICH INDICATES
         JOB NAME, JOB NUMBER, USER ID, LIBRARIAN MODULE NAME, RUN DATE
         START RUN TIME, END RUN TIME. THE INQUIRY IS LIMITED TO INCLUDE
         THE SCAN START DATE THRU AND INCLUDING THE SCAN END DATE.

      THE MEMBERS OF THIS DATA SET ARE ARRANGED IN RUN DATE SEQUENCE.
      ONE MEMBER EXISTS FOR THE LAST DAILY ARCHIVE TAPE (MEMBER NAME
      #DAILY). ONE MEMBER ALSO EXISTS FOR EACH OF THE WEEKLY
      CATALOGED LIBRARIAN ARCHIVE TAPES.
      WEEKLY MEMBERS ARE NAMED THUS:

                     BYTES 1-2 $W
                     BYTES 3-8 DATE OF WEEKLY ARCHIVE
                               RUN. YYMMDD

                   THE FORMAT OF THE LOGICAL RECORD IS:

                     BYTES 1-6   JOB RUN DATE YYMMDD
                     BYTES 7-14  JOB NAME
                     BYTES 15-22 LIBRARIAN MODULE NAME
                     BYTES 23-27 START RUN TIME HH.MM
                     BYTES 28-32 END RUN TIME HH.MM
                     BYTES 33-39 JOB USER-ID
                     BYTE  40    FREE

                   THE SEQUENCE OF DATA WITHIN EACH MEMBER
                   IS:
                     RUN DATE
                     JOB NAME
                     JOB NUMBER - THIS IS IN BYTES 5-8 OF
                                  LIBRARIAN MODULE NAME.

      THE USER DATA FIELD OF THE DIRECTORY OF EACH MEMBER CONTAINS
      THE LOWEST AND THE HIGHEST RUN DATE OF THE RECORDS IN THE
      MEMBER. THE DIRECTORY IS READ LOOKING FOR A MEMBER WHOSE
      HIGHEST RUN DATE IS NOT LESS THAN THE SCAN BEGIN DATE.
      IF IT IS LESS THE
      NEXT MEMBER IN THE DIRECTORY IS LOOKED AT. WHEN A GOOD END
      DATE IS FOUND,A FIND MACRO IS DONE FOR THE MEMBER USING THE TTR
      INFORMATION IN THE DIRECTORY. THE MEMBER IS READ LOOKING FOR
      A DATE WITHIN THE INTERVAL SPECIFIED AND THEN A MATCH ON THE
      SEARCH CRITERIA SPECIFIED. AS SOON AS THE RUN DATE IS GREATER
      THAN THE SCAN END DATE THEN THE PROGRAM IS EXITED. IF THE END
      OF THE MEMBER IS REACHED BEFORE A RUN DATE IS GREATER THAN
      THE SCAN END DATE THEN THE NEXT MEMBER IN THE DIRECTORY IS
      LOOKED AT AS ABOVE.


OPS4320G - THIS IS A COBOL PROGRAM WHICH IS RESPONSIBLE FOR CREATING
          LIBRARIAN DLM AND COPY CARDS FOR MODULES WHICH HAVE REACHED
          THE MAXIMUM TIME ALLOWED FOR STAYING ONLINE IN THE LIBSPOOL
          DATA SET.
           INPUT:  PARAMETER INPUT OF THE FORMAT

                    HOURS=NNN,MODULES=NNN

                 WHERE HOURS IS THREE NUMERIC DIGITS INDICATING THE
                 MAXIMUM NUMBER OF HOURS A MODULE CAN STAY ONLINE
                 BEFORE IT BECOMES ELIGIBLE TO BE TAKEN OFFLINE AND
                 PUT ON ARCHIVE TAPE.
                 ANY MODULE ONLINE A NUMBER OF HOURS GREATER THAN
                 THIS NUMBER IS ELIGIBLE TO BE TAKEN OFFLINE.
                 THE NUMBER OF HOURS ON LINE FOR A JOB IS COMPUTED
                 USING THE START RUN TIME . MINUTES ARE ROUNDED UP
                 TO THE NEXT HOUR IF 30 OR GREATER. FOR MODULES
                 WHICH WERE NOT SCHEDULED THE TIME AND DATE ADDED
                 TO THE LIBRARIAN DATA SET IS USED.

                     MODULES IS THREE NUMERIC DIGITS INDICATING THE
                 NUMBER OF MODULES THAT MUST BE ELIGIBLE TO TO BE
                 TAKEN OFFLINE BEFORE ANY MORE STEPS IN THE DAILY OR
                 WEEKLY JOBSTREAMS ARE ALLOWED TO EXECUTE.
                 THIS CAN PROVIDE A CONTROL TO AVOID AN ARCHIVE UPDATE
                 FOR A SMALL NUMBER OF MODULES.

             FILE INPUT:

             LIBRARIAN BASE MANAGEMENT CODE FOR THE LIBSPOOL DATA SET

             IF THE LIBSPOOL DATA SET HAS A MCD CODE IT CAN BE INPUT
             THRU THIS DATA SET. IT CAN BE A ONE CARD MEMBER OF A
             ACF2 PROTECTED DATA SET.
             THE BASE MCD CODE IF INPUT SHOULD BE NUMERIC AND INDICATED
             ON THE FIRST FOUR (4) BYTES OF THE RECORD.
             MCD CODE PROCESSING CAN BE SUPRESSED BY DUMMYING OUT THIS
             FILE OR INDICATE 'NONE' IN THE FIRST FOUR (4) BYTES OF THE
             RECORD.

         OUTPUT:

             A DATA SET CONTAINING LIBRARIAN COPY CONTROL CARDS FOR
             MODULES ELIGIBLE TO BE TAKEN OFFLINE.

             A DATA SET CONTAINING LIBRARIAN DLM CONTROL CARDS FOR
             MODULES ELIGIBLE TO BE TAKEN OFFLINE.

             THESE DATA SETS ARE INPUT TO SUBSEQUENT LIBRARIAN STEPS
             THAT WILL MERGE THE COPIED MODULES ONTO A UPDATED
             ARCHIVE TAPE AND DELETE THE MODULES FROM THE LIBSPOOL
             DATA SET AFTER THE MERGE IS SUCCESSFUL.

OPS4321G - PROCESSING FLOW (ASSEMBLER)

  (1) CHECK PARMLIST FOR 'W' ; IF WEEKLY RUN SET WEEKLY RUN SWITCH TO1.
      IF LENGTH OF PARAMETER INPUT IS 7 BYTES THEN ASSUME THAT THE NEXT
      6 BYTES ARE THE DATE (YYMMDD) OF THE WEEKLY MEMBER TO BE WRITTEN
      TO THE DIRECTORY DATA SET.
  (2) DELETE #DAILY MEMBER FROM THE DIRECTORY DATASET.
  (3) GET THE DATASET NAME FROM THE TAPE DD.
  (4) LINK TO THE SORT PROGRAM. CHECK FOR FIRST TIME THRU THE E15 EXIT
           IF YES PASS A X'00' RECORD TO THE SORT WHICH WILL LATER BE
           REPLACED BY THE DSN HEADER FROM THE TAPE DD.

  (5) GET A RECORD FROM THE ARCHIVE MASTER INDEX.
  (6) FORMAT THE MASTER RECORDS TO MAKE A DIRECTORY RECORD. SAVE THE
           HIGHEST AND LOWEST RUN DATES FROM THE MASTER RECORD. CONVERT
           DATES FROM JULIAN TO GREGORIAN AND PASS NEW RECORD TO THE
           SORT.
  (7) CHECK FOR THE END OF THE INPUT MASTER, IF SO SET RETURN CODE 8
           TO END E15 EXIT.
  (8) OPEN THE  DIRECTORY MEMBER AS A SEQUENTIAL DATASET AND UPDATE THE
           THE X'00' RECORD WITH THE DIRECTORY LABEL FROM THE TAPE DD.
  (9) OPEN THE DIRECTORY AS PARTITIONED TO UPDATE THE DATASET DIRECTORY
           WITH USER INFORMATION OF THE HIGHEST AND LOWEST RUN DATES
           THAT WERE SAVED FROM THE INPUT MASTER.
  (10) CHECK IF A WEEKLY RUN IF SO REPLACE THE #DAILY MEMBER NAME WITH
           A NEW MEMBER #WYYMMDD.
  (11) CLOSE THE DIRECTORY , SET RC=0 AND END THE PROGRAM.

OPS4322G - PROCESSING FLOW (ASSEMBLER)

 (1) IF PARAMETER INPUT IS 'W' THEN MORE 'WEEKLY' TO THE HEADER LINES
          ELSE LEAVE THEM AS THEY ARE WITH THE 'DAILY' CHARACTERS.
 (2) OPEN MASTER INDEX AND REPORT, GET THE VOLSER AND DATSET NAME FROM
          THE TAPE DD.
 (3) GET THE CURRENT DATE AND CHANGE IT TO GREGORIAN. MOVE THE DATE TO
          THE REPORT HEADING.
 (4) LINK TO THE SORT PROGRAM, GET AN INPUT RECORD FROM THE MASTER.
          CONVERT THE JULIAN DATE TO GREGORIAN DATE. FORMAT AN OUTPUT
          RECORD AND PASS IT TO THE SORT.
 (5) IF END OF THE MASTER INPUT SET RC=0 AND END E15 EXIT.
 (6) IN E35 EXIT SET UP DETAIL HEADINGS. KEEP TRACK OF PAGE COUNT AND
          DO HEADING ROUTINE. FORMAT DETAIL RECORD AND DELETE IT FROM
          THE SORT. PUT A DETAIL RECORD. IF ALL SORT RECORDS ARE DELETED
          END E35 BY SETTING RC=8.
 (7) CLOSE MASTER AND REPORT SET RC=0 END PROGRAM.


OPS4323G - ASSEMBLER

 THIS PROGRAM IS EXECUTED AS THE SECOND STEP OF THE LIBSPOOL CONSOLE
 STARTED TASK. IT WRITES A MESSAGE TO THE OPERATOR INDICATING THAT
 LIBSPOOL IS NO LONGER RUNNING. A REPLY OF ANY CHARACTER MUST BE
 MADE TO THIS MESSAGE TO REMOVE IT FROM THE OPERATOR CONSOLE.
 THIS IS DONE TO INSURE THAT OPERATIONS IS ALWAYS AWARE OF LIBSPOOL
 BEING ACTIVE. THIS STEP ALWAYS EXECUTES (COND=EVEN).


OPS4341G - ASSEMBLER

 THIS PROGRAM IS EXECUTED AS THE LAST STEP OF THE DAILY AND WEEKLY
 ARCHIVE JOBSTREAMS. IT WRITES A MESSAGE TO THE OPERATOR THAT THE
 ARCHIVE JOB IS COMPLETE AND LIBSPOOL WILL NOW BE RESTARTED.


FIXADRIR - JOBSTREAM TO RECREATE ONE OR ALL OF THE MEMBERS OF THE
           ARCHIVE DIRECTORY DATA SET FROM THE WEEKLY AND LAST
           DAILY ARCHIVE TAPES.


LSLIBCPY -
     THIS JOB CAN BE USED TO REALLOCATE THE LIBSPOOL DATA SET
     TO INCREASE OR DECREASE ITS SPACE ALLOCATION OR VOLUME ALLOCATION.
     LIBSPOOL SHOULD BE STOPPED WHILE RUNNING THIS JOB. DATA SETS SHOULD
     BE RENAMED AFTER SUCCESSSFUL COMPLETION.


RESTORE  -
    THIS JOBSTREAM CAN BE USED TO RESTORE THE LIBSPOOL LIBRARIAN
    DATA SET FROM THE BACKUP MADE OF IT IN THE DAILY ARCHIVE JOBSTREAM.
    THE BACKUP IS TAKEN BEFORE THE MODULES TAKEN OFFLINE ARE DELETED
    FROM THE ONLINE LIBSPOOL LIBRARIAN DATA  SET.
    CORRESPONDING DATA SET NAMES, VOLUME SERIAL NUMBERS, AND SPACE
    ALLOCATION WILL HAVE TO BE CHANGED.

------------------------------------------------------------------------

    A DAILY AND WEEKLY BATCH ARCHIVE JOB WILL BE RUN TO
    REMOVE CHRONOLOGICALLY OLD JCL MODULES FROM THE LIBRARIAN
    LIBSPOOL DATA SET TO A LIBRARIAN ARCHIVE TAPE DATA SET.

    THE LIBSPOOL TASK WILL HAVE TO BE STOPPED BEFORE SCHEDULING
    THIS JOB. THIS IS DONE USING THE STOP COMMAND 'P LIBSPOOL'.

    THE STEPS IN THIS JOB ARE DECRIBED AS FOLLOWS:

STEP NO. STEP NAME  PROGRAM/NORMAL CONDITION CODE/STEP FUNCTION
-------- ---------  ----------------------------------------------------

   1      SELECT    OPS4320 - NORMAL CONDITION CODES ARE 0 AND 999
                    THIS PROGRAM INTERROGATES THE LIBSPOOL LIBRARIAN
                    DATA SET FOR MODULES THAT ARE CHRONOLOGICALLY OLDER
                    THAN THE NUMBER OF HOURS PASSED AS A PARAMETER
                    VALUE. LIBRARIAN COPY AND DLM CONTROL CARDS ARE
                    CREATED FOR MODULES TO BE PUT ON ARCHIVE TAPE AND
                    DELETED FROM THE LIBSPOOL LIBRARIAN DATA SET IN
                    LATER LIBRARIAN JOB STEPS. ALSO INPUT AS A PARAMETER
                    VALUE IS THE NUMBER OF MODULES TO BE ARCHIVED
                    THAT MUST BE SURPASSED IF THE ARCHIVE RUN IS TO
                    CONTINUE. THIS PROVIDES A CONTROL FOR DOING A
                    EXPENSIVE ARCHIVE UPDATE RUN FOR A SMALL NUMBER
                    OF MODULES. A CONDITION CODE OF 999 WILL BE
                    GENERATED IF THIS VALUE IS NOT SURPASSED WHICH WILL
                    SUPRESS THE EXECUTION OF THE REMAINING STEPS.
                    A ZERO CONDITION CODE INDICATES THAT THE MINIMUM
                    NUMBER OF MODULES CRITERIA HAS BEEN MET.
                    IF MCD CODE PROCESSING IS DESIRED
                    A BASE LIBRARIAN MANAGEMENT CODE CAN BE INPUT
                    THRU THE DATA SET DDNAME OF 'MCDCODE.
                    DUMMYING OUT THIS DDNAME
                    WILL SUPPRESS THE GENERATING OF MCD CONTROL CARDS.

   2      COPYSTEP  LIBRARIAN - NORMAL CONDITION CODE IS 0
                    THIS STEP INPUTS THE LIBRARIAN COPY CONTROL CARDS
                    CREATED IN STEP #1. THE MODULES ARE COPIED FROM THE
                    LIBRARIAN LIBSPOOL DATA SET TO A TEMPORARY DATA
                    SET.

   3      COPYTAPE  LIBRARIAN - NORMAL CONDITION CODE IS 0
                    THIS STEP PERFORMS THE LIBRARIAN ARCHIVE TAPE
                    UPDATE USING THE LAST ARCHIVE TAPE MASTER AND THE
                    MODULES COPIED FROM THE LIBSPOOL LIBRARIAN DATA
                    SET IN STEP #2.

   4      LIBUP     OPS4321G - NORMAL CONDITION CODE IS 0
                    THIS STEP PERFORMS THE UPDATE OF THE ARCHIVE
                    DIRECTORY DATA SET INDICATING THE CONTENTS OF THE
                    NEW ARCHIVE TAPE CREATED IN STEP 3. THE LIBSPOOL
                    CLIST CAN BE USED TO INQUIRE INTO THIS DATA SET
                    BASED ON THE SAME SELECTION CRITERIA USED IN
                    INTERROGATING THE LIBSPOOL DATA SET.

                       1) GENERIC JOB NAME
                       2) USER-ID OF THE JOB
                       3) JOB NUMBER
                       4) LIBRARIAN MODULE NAME
                       5) ALL MODULES

                    THE SELECTION IS QUALIFIED BY A DATE INTERVAL BASED
                    ON THE RUN DATE FOR A JOB. A DISPLAY WILL BE MADE
                    BACK TO THE TERMINAL INDICATING THE ARCHIVE TAPE
                    DATA SET NAME FOLLOWED BY THE THE FOLLOWING DATA
                    OF THE MODULES WHICH SATISFIED THE SELECTION
                    CRITERIA WITHIN THE DATE INTERVAL SPECIFIED.

                       1) JOB NAME
                       2) USER-ID
                       3) RUN DATE
                       4) START RUN TIME
                       5) END RUN TIME
                       6) LIBRARIAN LIBSPOOL MODULE NAME

   5      LIBPRT    OPS4322G - NORMAL CONDITION CODE IS 0
                    THIS STEP REPORTS THE CONTENTS OF THE UPDATED
                    ARCHIVE TAPE CREATED IN STEP #3. THE ARCHIVE TAPE
                    DATA SET NAME AND TAPE VOLUME SERIAL NUMBER
                    ARE IN THE HEADING OF EACH REPORT
                    PAGE. THE DATA IS REPORTED IN JOB NAME, RUN DATE,
                    RUN START TIME SEQUENCE. THE LAST DAILY
                    REPORT AND EACH WEEKLY REPORT
                    SHOULD BE FILED IN OPERATIONS AS AN ALTERNATE
                    SOURCE OF INFORMATION AS TO THE CONTENTS OF THE
                    ARCHIVE TAPES.

   6      BACKUPM   LIBRARIAN - NORMAL CONDITION CODE IS 0
                    THIS STEP BACKS UP THE LIBRARIAN DATA SET AS THE
                    SECOND FILE ON THE UPDATED ARCHIVE TAPE CREATED IN
                    STEP #3. THIS BACKUP IS DONE PRIOR TO DELETING THE
                    MODULES THAT WERE COPIED TO ARCHIVE TAPE IN STEP #3.

   7      DELETEM   LIBRARIAN - NORMAL CONDITION CODE IS 0
                    THIS STEP INPUTS THE DLM CONTROL CARDS CREATED IN
                    STEP #1 TO DELETE THE MODULES THAT WERE COPIED TO
                    ARCHIVE TAPE IN STEP #3.

   8      OPERMSG   OPS4341G - NORMAL CONDITION CODE IS 0
                    THIS STEP WRITES A MESSAGE TO THE OPERATOR THAT THE
                    ARCHIVE JOBSTREAM IS NOW COMPLETE AND THAT THE
                    LIBSPOOL TASK WILL NOW BE RESTARTED.

   9      STARTLS   IEBGENER - NORMAL CONDITION CODE IS 0
                    THIS STEP SUBMITS A COMMAND THRU THE INTERNAL
                    READER TO START LIBSPOOL.

            ONCE A WEEK (OR SOME OTHER WORKABLE TIME PERIOD THAT IS
            DEPENDENT ON THE VOLUME OF JOBS PROCESSED THRU THE
            LIBSPOOL SYSTEM) ANOTHER
            BATCH ARCHIVE JOB IS RUN IN PLACE OF THE DAILY ARCHIVE
            JOB. BESIDES PERFORMING THE TASKS IN THE DAILY ARCHIVE
            JOB THE FOLLOWING IS ALSO DONE:

            1) THE ARCHIVE DATA IS UPDATED ONTO A WEEKLY ARCHIVE
               TAPE. WEEKLY ARCHIVE TAPE ARE KEPT FOR THE PERIOD
               JCL HAS BEEN DESIGNATED TO BE MADE AVAILIABLE FROM
               ARCHIVE (EG. 2 1/2 YEARS). THEREFORE IF A WEEKLY
               ARCHIVE TAPE IS CREATED ONCE A WEEK AND JCL IS TO BE
               AVAILIABLE FOR UP TO 2 1/2 YEARS A GENERATION DATA
               GROUP OF 130 ENTRIES SHOULD BE CREATED FOR THE WEEKLY
               ARCHIVE TAPE DATA SET.

            2) A NULL DAILY ARCHIVE DATA SET IS CREATED TO BE USED
               TO START ACCUMULATING JCL MODULES FOR THE NEXT WEEK.

            3) THE ARCHIVE DIRECTORY DATA SET IS COMPRESSED.

            4) THE RESTORE FROM ARCHIVE DATA SET IS DELETED AND
               A NEW ONE IS ALLOCATED.

            5) THE NUMBER OF MEMBERS IN THE ARCHIVE DIRECTORY
               DATA SET IS LIMITED TO THE NUMBER OF GENERATIONS
               MAINTAINED OF THE WEEKLY ARCHIVE DIRECTORY TAPE
               GENERATION DATA GROUP. (PROPOSED)


LIBSPOOL PROBLEMS
-----------------

THE FOLLOWING ARE KNOWN CURRENT PROBLEMS IN USING LIBSPOOL:

  1) JCL QUEUED TO PRINT BY THE LIBSPOOL TASK PRINTS JOB SEPARATOR
     PAGES FOR EACH SECTION OF JCL OUTPUT. (JES LOG, JCL, EXECUTION
     MESSAGES). THE NEW JES SCHEDULED TO BE OPERATIONAL IN 1983
     CORRECTS THIS PROBLEM.

  2) AFTER ADDING THE LIBSPOOL MSGCLASS TO THE JOB CARD,
     JCL WHICH IS DUAL ROUTED WILL RESULT IN THE JCL NOT TO BE
     SENT TO THE REMOTE DESTINATION SPECIFIED ON THE /*OUTPUT CARD.
     DUAL ROUTING OUTPUT CARDS FOR JCL APPEAR AS:
     /*OUTPUT JCL DEST=(LOCAL,RMT10)


  LIBSPOOL INSTALLATION PROCEDURES
------------------------------------

    ALL SOURCE AND JCL MODULES ARE CONTAINED IN THE DATA SET
    SHSW.LIBSPOOL.DATA. THE MEMBERS OF THIS DATA SET SHOULD BE
    USED TO INSTALL LIBSPOOL.

   THE FOLLOWING TASKS SHOULD BE COMPLETED TO INSTALL LIBSPOOL:

    1) LINK THE PROGRAMS USED BY LIBSPOOL. THE FOLLOWING MEMBERS
       WERE USED TO LINK THE REQUIRED PROGRAMS.

         JCLLISTL - LIBSPOOL PROGRAM (LINK INTO AN AUTHORIZED LIBRARY)
                    SET THE VALUES AT THE BEGINNING OF THE JCLLIST
                    SOURCE FOR:
             1) MSGCLIST - THE MSGCLASSES TO BE SERVICED BY LIBSPOOL
             2) &RECLASS-PRINT SYSOUT CLASS FOR JCL PRINTED BY LIBSPOOL
             3) &PRODID-FIRST CHARACTER OF THE USER IDS TO BE PROCESSED
                        BY LIBSPOOL (SPACE VALUE WILL SUPRESS THIS).
             4) &DUMMYCLS-JES2 DEFINED DUMMY SYSOUT CLASS
             5) &SYSOUTMX-RECORD LIMIT FOR EACH NON JCL SYSOUT
             6) &MSGCLPRT-MSGCLASS TO BE PRINTED ALWAYS BY LIBSPOOL
             7) &MSGCLCC0-PRINT JCL IF CONDITION CODE FOUND GREATER 0
         OPS4318L - LIBSPOOL LIBRARIAN DATA SET INQUIRY PROGRAM
                    CALLED IN THE LIBSPOOL CLIST
         OPS4319L - LIBSPOOL ARCHIVE DIRECTORY DATA SET INQUIRY PROGRAM
                    CALLED IN THE LIBSPOOL CLIST
         OPS4320L - DAILY ARCHIVE MODULE SELECTION PROGRAM
         OPS4321L - DAILY ARCHIVE DIRECTORY UPDATE PROGRAM
         OPS4322L - DAILY ARCHIVE TAPE CONTENTS REPORT PROGRAM
         OPS4323L - LIBSPOOL INACTIVE NOTIFICATION PROGRAM
         OPS4341L - LIBSPOOL ARCHIVE COMPLETE NOTIFICATION PROGRAM

       MAKE APPROPRIATE JCL CHANGES AS NECESSARY.

    2) ALLOCATE THE DATA SETS REQUIRED BY LIBSPOOL

         ALLOCADR - ALLOCATE THE LIBSPOOL ARCHIVE DIRECTORY DATA SET
         ALLOCARC - ALLOCATE THE LIBSPOOL RESTORE FROM ARCHIVE
                    LIBRARIAN DATA SET
         ALLOCLS  - ALLOCATE THE CURRENT LIBSPOOL LIBRARIAN DATA SET
         OXYP     - CREATE THE GENERATION DATA GROUP INDEXES FOR THE
                    DAILY AND MONTHLY ARCHIVE TAPES.

       MAKE APPROPRIATE JCL CHANGES AS NECESSARY.

    3) COPY THE FOLLOWING JCL PROCEDURES TO A SYSTEM PROCLIB

         OPSX06   - DAILY ARCHIVE JOB
         OPSX07   - WEEKLY ARCHIVE JOB
         OPSX08   - RESTORE FROM TAPE ARCHIVE
         LIBSPOOL - CONSOLE STARTED TASK LIBSPOOL JCL

       MAKE APPROPRIATE JCL CHANGES AS NECESSARY.

    4) COPY THE FOLLOWING PARMLIB MEMBERS TO A PARMLIB

         OPSX0601 - BASE MCD CODE FOR THE LIBSPOOL DATA SET (OPTIONAL)
         OPSX0602 - LIBRARIAN CONTROL CARD = -OPT NOCYCLE,INDEX
         OPSX0603 - LIBRARIAN CONTROL CARDS = -OPT BKUPTAPE
                                              -END
         OPSX0604 - JES2 $VS COMMAND TO START LIBSPOOL
                    /*$VS,'S LIBSPOOL'
         OPSX0701 - BASE MCD CODE FOR THE LIBSPOOL DATA SET (OPTIONAL)
         OPSX0702 - LIBRARIAN CONTROL CARD = -OPT NOCYCLE,INDEX
         OPSX0703 - LIBRARIAN CONTROL CARDS = -OPT BKUPTAPE
                                              -END
         OPSX0704 - LIBRARIAN CONTROL CARD = -OPT NOCYCLE,INDEX,NOINPUT
                                              -END
         OPSX0705 - IEBCOPY CONTROL CARD = COPY INDD=DIR,OUTDD=DIR
         OPSX0706 - LIBRARIAN CONTROL CARDS
                    -OPT INIT,DISK,SEQ=/81,8,10,10/
                    -END
         OPSX0707 - JES2 $VS COMMAND TO START LIBSPOOL
                    /*$VS,'S LIBSPOOL'

    5) COPY THE LIBSPOOL CLIST FROM DSNAME=SHSW.LIBSPOOL.CLIST(LIBSPOOL)
       TO A COMMON CLIST LIBRARY.
       MAKE CORRESPONDING SYMBOLIC NAME CHANGES AS NECESSARY.

    6) DEFINE HELD CLASS(ES) IN THE JES2 PARAMETERS
       CURRENTLY PROGRAM JCLLIST WILL PROCESS SYSOUT CLASSES W,X AND 0

    7) ADD A START COMMAND FOR LIBSPOOL TO SYS1.PARMLIB(COMMND00)
       TO ALLOW LIBSPOOL TO START UP AT IPL TIME.

    8) DEFINE ACF2 RULES

         ACF2RULE - DEFINES ACF2 RULES FOR LIBSPOOL DATA SETS

    9) MODIFY THE DAILY ADD WEEKLY JCL ARCHIVE JOBSTREAMS AS NECESSARY.

         DAILY - $OPS2339
        WEEKLY - $OPS2340

  LIBSPOOL ASSITANCE
 ____________________

              TECHNICAL SUPPORT OF THE NIAGARA DATA CENTER IS
              AVIALIABLE TO SERVICE PROBLEMS ENCOUNTERED WITH
              LIBSPOOL . OXYCOM 939-3251.


   LIBSPOOL OBJECTIVE
  --------------------

ALLEVIATE PROBLEMS INVOLVED IN REVIEWING, COLLATING, STORING,
RETRIEVING A LARGE VOLUME OF PRODUCTION JOB CONTROL LANGUAGE LISTINGS.

       LIBSPOOL ATTEMPTS TO ADDRESS THESE PROBLEMS BY:

           1) PROVIDING AN AUTOMATIC REVIEW OF PRODUCTION TYPE JCL
              LISTINGS LOOKING FOR NON-NORMAL RESULTS BY MEANS OF A
              PREDEFINED SET OF ABEND CODES.

           2) AUTOMATING AND ORGANIZING THE STORING AND RETRIEVING
              OF ON-LINE JCL.

           3) AUTOMATING AND ORGANIZING THE ARCHIVING AND RETRIEVING
              OF JCL FROM ARCHIVE.

           4) CUTTING DOWN ON JCL PRINT OUTPUT.

   LIBSPOOL DATA SETS
  --------------------

          1) SHSW.LSLIB - CURRENT LIBRARIAN JCL LIBRARY
                          CONTAINS THE CURRENT JCL MODULES
                          GOTTEN FROM THE LIBSPOOL TASK.

          2) SHSW.LSARCLIB - RESTORE FROM LIBRARIAN ARCHIVE TAPE
                             LIBRARIAN JCL LIBRARY

          3) SHSW.LSADRLIB - ARCHIVE DIRECTORY
                             PARTIONED DATA SET CONTAINING INFORMATION
                             ON THE CONTENTS OF THE LIBRARIAN ARCHIVE
                             TAPES.

          4) PHGIOPS.OPS2339.DALYARCH - DAILY LIBRARIAN ARCHIVE TAPE

          5) PHGIOPS.OPS2340.WKLYARCH - WEEKLY LIBRARIAN ARCHIVE TAPE

   LIBSPOOL OPERATION
  --------------------

           LIBSPOOL RUNS AS A CONSOLE STARTED TASK THAT CAN BE
           STARTED AUTOMATICALLY AT IPL TIME AND WILL NORMALLY
           ALWAYS BE ACTIVE. IT WILL NEEDED TO BE STOPPED WHEN A
           DAILY ARCHIVE JOB IS RUN WHICH WILL REMOVE
           CHRONOLOGICALLY OLD JCL MODULES FROM THE LIBSPOOL DATA
           SET.

           LIBSPOOL CAN BE STOPPED WITH THE COMMAND:

                        P LIBSPOOL

           LIBSPOOL CAN BE STARTED UP WITH THE COMMAND:

                        S LIBSPOOL

           IF LIBSPOOL TERMINATES WITH AN ABEND OR A STOP COMMAND
           A MESSAGE WILL BE WRITTEN TO THE OPERATOR
           INDICATING THAT LIBSPOOL IS NO LONGER RUNNING.
           THIS SHOULD INSURE THAT OPERATIONS WILL ALWAYS
           KNOW THAT LIBSPOOL IS ACTIVE. THE MESSAGE WILL NOT
           GO OFF THE OPERATOR CONSOLE UNTIL A REPLY OF ANY
           CHARACTER IS MADE TO IT.

           AT END EXECUTION FOR PRODUCTION JOBS SPECIFYING A
           SPECIFIC MSGCLASS ON THE JOB CARD LIBSPOOL WILL OBTAIN
           THE JCL AND SELECTED SYSOUT OUTPUT FROM JES2.
           LIBSPOOL WILL ONLY PROCESS JOBS RUN WITH A 'P' AS THE
           FIRST CHARACTER OF THE USER-ID. ALL OTHER JOBS USING A
           LIBSPOOL MSGCLASS WILL BE DELETED FROM THE SYSTEM.
           JCL OUTPUT WILL CONSIST OF:

                        1) JES LOG
                        2) JCL
                        3) EXECUTION MESSAGES

            SELECTED SYSOUT OUTPUT CAN BE CAPTURED BY SPECIFING
            SYSOUT=* ON THE DD STATEMENT OF THE SYSOUT WHICH IS
            DESIRED TO BE CAPTURED WITH THE JCL. EACH NON-JCL SYSOUT
            DATA SET IS LIMITED TO A MAXIMUM NUMBER OF LINES (500).THIS
            IS DONE TO PROTECT LIBSPOOL AGAINST DISK SPACE PROBLEMS.

            THIS OPTION WILL ONLY FUNCTION FOR JOBS THAT
            ARE RUN ON THE NIA NODE WHOSE PRINT IS NOT ROUTED TO
            ANOTHER NODE. THIS OPTION IS NOT AVAILIABLE FOR JOBS RUN
            ON ANOTHER NODE (EG. HOU) WHOSE PRINT (JCL) IS ROUTED
            BACK TO THE NIA NODE. JCL (JES2 LOG, JCL, EXECUTION
            MESSAGES) IS THE ONLY SYSOUT OUTPUT THAT CAN BE CAPTURED
            BY LIBSPOOL FOR JOBS RUN ON ANOTHER NODE. LIBSPOOL WILL
            NOT OPERATE PROPERLY IF A NON-JCL SYSOUT (SYSOUT=*) IS
            SENT BACK TO THE NIA NODE. EVERY EFFORT SHOULD BE MADE
            TO AVOID THIS SITUATION. (SYSOUT=* OUTPUT CAN ONLY BE
            CAPTURED BY LIBSPOOL FOR ONE STEP JOBS RUN ON ANOTHER

            THE LIBSPOOL DATA SET WILL ALLOW APPROXIMATELY A MAXIMUM
            OF 15,000 RECORDS PER JOB. PRINT LINES GREATER THAN 80
            CHARACTERS WILL TAKE 2 RECORDS WHEN STORED BY LIBSPOOL.

            LIBSPOOL WILL SCAN THE JCL LOOKING FOR A MATCH ON A
            PRE-DEFINED SET OF ABEND CONDITIONS. A MATCH OF
            ANY OF THE FOLLOWING IBM MESSAGE IDENTIFICATIONS WILL RESULT
            IN THE JCL TO BE QUEUED FOR OUTPUT UNDER SYSOUT CLASS J.

                  IEF251I - JOB CANCELLED
                  IEF283I - NOT DELETED X
                  IEF287I - NOT RECTLGD/CATALGD/UNCATLGD
                  IEF450I - ABEND
                  IEF451I - ENDED BY CC
                  IEF452I - JOBFAIL/JOB NOT RUN JCL ERROR
                  IEF453I - JOB FAILED - JCL ERROR

              THE JOB CARD MSGCLASS PARAMETER IS USED TO CONTROL:

                  1) SELECTION OF JCL OUTPUT BY LIBSPOOL
                  2) PRINTING OF THE JCL
                  3) PRINTING OF THE JCL BASED ON CONDITION CODE
                     VALUES ALLOWED

              THE FOLLOWING IDENTIFIES THE MSGCLASS VALUES THAT
              LIBSPOOL WILL SELECT FOR PROCESSING AND THE CONDITION
              CODE VALUES THAT ARE ALLOWED FOR THAT MESSAGE CLASS.

                 MSGCLASS                USAGE
                 ________        _______________________
                    X            JCL OF THIS MSGCLASS WILL ALWAYS PRINT.
                    W            CONDITION CODES GREATER THAN 0 QUEUES
                                 JCL TO BE PRINTED UNDER SYSOUT CLASS J.

              AS JCL IS PROCESSED BY LIBSPOOL FOR A JOB, A WTOR
              MESSAGE IS WRITTEN BY LIBSPOOL TO INDICATE TO THE OPERATOR
              WHAT LIBSPOOL FOUND WHEN IT SCANNED THE JCL. THE WTOR
              MESSAGES WILL REMAIN ON THE OPERATOR CONSOLE UNTIL A REPLY
              OF ANY CHARACTER IS MADE TO IT. MORE THAN ONE WTOR CAN BE
              OUTSTANDING FROM LIBSPOOL AT A TIME. THE FORMAT OF THE
              MESSAGES IS:

              LIBSPOOL: XXXXXXXX-YYYY-Z - MMMMMMMMMMMMMMMMMMMMMM

              WHERE XXXXXXXX - JOB NAME
                        YYYY - JOB NUMBER
                           Z - JOB MSGCLASS
                        MM.. - MESSAGE (MAXIMUM OF 22 CHARACTERS)

              A JOB RUN UNDER MSGCLASS W THAT RUNS WITHOUT A ABEND
              OR CONDITION CODE GREATER THAN ZERO OR ANY OTHER PROBLEM
              SUCH AS A NOT CATALOGED OR NOT DELETED MESSAGE WILL HAVE
              THE FOLLOWING MESSAGE - 'SUCCESSFULLY COMPLETED'.

              A JOB RUN UNDER MSGCLASS X THAT RUNS WITHOUT A ABEND
              OR ANY OTHER PROBLEM
              SUCH AS A NOT CATALOGED OR NOT DELETED MESSAGE WILL HAVE
              THE FOLLOWING MESSAGE - 'PRINTED - PRINT MSGCLS'.

              WHEN A JOB IS PRINTED BECAUSE OF A PROBLEM, LIBSPOOL
              WILL PUT ANY ONE OF THE FOLLOWING IN THE MESSAGE WRITTEN
              TO THE OPERATOR.

                 *****  ABENDED  *****
                 *** JOB CANCELLED ***
                 DATA SET NOT CATALOGED
                  DATA SET NOT DELETED
                 JOB ENDED BY COND CODE
                 ***** JCL ERROR *****
                 CONDITION CODE > 0000
                 PRINTED - NOT EXECUTED

              THIS SHOULD HIGHLIGHT TO THE OPERATOR THE REASON FOR THE
              PRINTING OF THE JCL AND HELP IN RESULTING IN THE PROPER
              FOLLOW-UP ACTION.

              IT SHOULD BE NOTED THAT A PRINTED JOB FOR ANY OF THE
              REASONS IN THE ABOVE LIST COULD HAVE MORE THAN
              ONE PROBLEM RECOGNIZED BY LIBSPOOL. HOWEVER, MESSAGES WILL
              BE USED IN THE ORDER PRESENTED ABOVE. FOR EXAMPLE, A JOB
              COULD HAVE ABENDED AND HAVE A NOT CATALOGED MESSAGE IN A
              PRIOR STEP. LIBSPOOL WILL INDICATE AN ABEND FOR THE JOB
              BUT NOT THE NOT CATALOGED CONDITION.

              IN ALL CASES THE JCL WILL BE ADDED TO THE LIBSPOOL
              LIBRARIAN DATA SET. LIBSPOOL COSTRUCTS AN EIGHT (8)
              CHARACTER LIBRARIAN MODULE NAME FOR THE JCL OF THE
              FOLLOWING FORMAT:

                        BYTE  1   - LETTER A THRU Z
                        BYTES 2-4 - JULIAN DAY NUMBER
                        BYTES 5-8 - JES2 JOB NUMBER

              THE LETTER IN THE FIRST BYTE IS NORMALLY 'A' BUT WILL BE
              INCREMENTED THRU 'Z' IF IT IS FOUND THAT A MODULE ALREADY
              EXISTS ON THE LIBSPOOL LIBRARIAN DATA SET OF THAT NAME.

              WHILE THE JCL IS ON-LINE IN THE LIBSPOOL DATA SET
              THE 'LIBSPOOL' CLIST CAN BE USED TO DO INQUIRY
              SCANNING FOR MATCHES ON ANY
              ONE OF THE FOLLING CRITERIA:

                    1) GENERIC JOB NAME
                    2) USER-ID OF THE JOB
                    3) JOB NUMBER
                    4) LIBRARIAN MODULE NAME
                    5) ALL MODULES

              A FORMATTED DISPLAY WILL BE MADE BACK TO THE TERMINAL
              SHOWING ANY MODULES THAT MATCHED THE SELECTION CRITERIA
              USED. INFORMATION DISPLAYED WILL CONSIST OF:

                    1) JOB NAME
                    2) JOB NUMBER
                    3) USER-ID
                    4) LIBRARIAN LIBSPOOL MODULE NAME
                    5) RUN DATE
                    6) START RUN TIME
                    7) END RUN TIME

              USING THE INFORMATION FROM THE ABOVE DISPLAY
              TO IDENTIFY THE RUN(S) IN QUESTION
              THE USER CAN THEN USE THE LIBSPOOL MODULE NAME TO
              SELECT THE JCL OF INTEREST FOR DISPLAY,PRINT, OR LIBGET
              THRU USE OF THE LIBSPOOL CLIST.

              THE LIBSPOOL CLIST CAN ALSO BE USED TO INQUIRE INTO
              THE CONTENTS OF THE LIBSPOOL ARCHIVE TAPES. THE
              SELECTION CRITERIA USED IS THE SAME USED IN
              INTERROGATING THE LIBSPOOL DATA SET.

                    1) GENERIC JOB NAME
                    2) JOB NUMBER
                    3) LIBRARIAN MODULE NAME
                    4) USER-ID OF THE JOB
                    5) ALL MODULES

              THE SELECTION IS QUALIFIED BY A DATE INTERVAL BASED
              ON THE RUN DATE FOR A JOB. A DISPLAY WILL BE MADE
              BACK TO THE TERMINAL INDICATING THE ARCHIVE TAPE
              DATA SET NAME FOLLOWED BY THE THE FOLLOWING DATA
              OF THE MODULES WHICH SATISFIED THE SELECTION
              CRITERIA WITHIN THE DATE INTERVAL SPECIFIED.

                    1) JOB NAME
                    2) JOB NUMBER
                    3) USER-ID
                    4) LIBRARIAN LIBSPOOL MODULE NAME
                    5) RUN DATE
                    6) START RUN TIME
                    7) END RUN TIME

              HAVING OBTAINED THE ARCHIVE TAPE DATA SET NAME AND THE
              LIBSPOOL MODULE NAME FROM THE ABOVE DISPLAY, THE LIBSPOOL
              CLIST CAN BE USED TO SUBMIT A JOB TO BATCH TO RESTORE THE
              JCL TO THE LIBSPOOL RESTORE FROM ARCHIVE DATA SET. THE
              LIBSPOOL CLIST CAN AGAIN BE USED TO INQUIRE INTO THIS
              DATA SET.

              JOBS CANCELLED BEFORE BEING SCHEDULED FOR EXECUTION
              ARE ALSO CAPTURED BY LIBSPOOL. THE
              RUN DATE USED WILL BE THE DATE THE JCL WAS ADDED
              TO THE LIBSPOOL LIBRARIAN DATA SET.

              A DAILY AND WEEKLY BATCH ARCHIVE JOB WILL BE RUN TO
              REMOVE CHRONOLOGICALLY OLD JCL MODULES FROM THE LIBRARIAN
              LIBSPOOL DATA SET TO A LIBRARIAN ARCHIVE TAPE DATA SET.

             THE LIBSPOOL TASK WILL HAVE TO BE STOPPED BEFORE SCHEDULING
             THIS JOB. THIS IS DONE USING THE STOP COMMAND 'P LIBSPOOL'.

              THE STEPS IN THIS JOB ARE DECRIBED AS FOLLOWS:

STEP NO. STEP NAME  PROGRAM/NORMAL CONDITION CODE/STEP FUNCTION
-------- ---------  ----------------------------------------------------

   1      SELECT    OPS4320 - NORMAL CONDITION CODES ARE 0 AND 999
                    THIS PROGRAM INTERROGATES THE LIBSPOOL LIBRARIAN
                    DATA SET FOR MODULES THAT ARE CHRONOLOGICALLY OLDER
                    THAN THE NUMBER OF HOURS PASSED AS A PARAMETER
                    VALUE. HOURS=NNN
                    LIBRARIAN COPY AND DLM CONTROL CARDS ARE
                    CREATED FOR MODULES TO BE PUT ON ARCHIVE TAPE AND
                    DELETED FROM THE LIBSPOOL LIBRARIAN DATA SET IN A
                    LATER LIBRARIAN JOB STEP. ALSO INPUT AS A PARAMETER
                    VALUE IS THE NUMBER OF MODULES TO BE ARCHIVED
                    THAT MUST BE SURPASSED IF THE ARCHIVE RUN IS TO
                    CONTINUE. MODULES=NNN
                    THIS PROVIDES A CONTROL FOR DOING AN
                    EXPENSIVE ARCHIVE UPDATE RUN FOR A SMALL NUMBER
                    OF MODULES. A CONDITION CODE OF 999 WILL BE
                    GENERATED IF THIS VALUE IS NOT SURPASSED WHICH WILL
                    SUPRESS THE EXECUTION OF THE REMAINING STEPS.
                    A ZERO CONDITION CODE INDICATES THAT THE MINIMUM
                    NUMBER OF MODULES CRITERIA HAS BEEN MET.
                    IF MCD CODE PROCESSING IS DESIRED
                    A BASE LIBRARIAN MANAGEMENT CODE CAN BE INPUT
                    THRU THE DATA SET DDNAME OF 'MCDCODE.
                    DUMMYING OUT THIS DDNAME
                    WILL SUPPRESS THE GENERATING OF MCD CONTROL CARDS.

   2      COPYSTEP  LIBRARIAN - NORMAL CONDITION CODE IS 0
                    THIS STEP INPUTS THE LIBRARIAN COPY CONTROL CARDS
                    CREATED IN STEP #1. THE MODULES ARE COPIED FROM THE
                    LIBRARIAN LIBSPOOL DATA SET TO A TEMPORARY DATA
                    SET.

   3      COPYTAPE  LIBRARIAN - NORMAL CONDITION CODE IS 0
                    THIS STEP PERFORMS THE LIBRARIAN ARCHIVE TAPE
                    UPDATE USING THE LAST ARCHIVE TAPE MASTER AND THE
                    MODULES COPIED FROM THE LIBSPOOL LIBRARIAN DATA
                    SET IN STEP #2.

   4      LIBUP     OPS4321G - NORMAL CONDITION CODE IS 0
                    THIS STEP PERFORMS THE UPDATE OF THE ARCHIVE
                    DIRECTORY DATA SET INDICATING THE CONTENTS OF THE
                    NEW ARCHIVE TAPE CREATED IN STEP 3.

   5      LIBPRT    OPS4322G - NORMAL CONDITION CODE IS 0
                    THIS STEP REPORTS THE CONTENTS OF THE UPDATED
                    ARCHIVE TAPE CREATED IN STEP #3. THE ARCHIVE TAPE
                    DATA SET NAME AND TAPE VOLUME SERIAL NUMBER
                    ARE IN THE HEADING OF EACH REPORT
                    PAGE. THE DATA IS REPORTED IN JOB NAME, RUN DATE,
                    RUN START TIME SEQUENCE. THE LAST DAILY
                                                 ____
                    REPORT (FROM DAILY ARCHIVE JOB-$OPS2339) AND EACH
                    WEEKLY REPORT (FROM WEEKLY ARCHIVE JOB-$OPS2340)
                    SHOULD BE FILED IN OPERATIONS AS AN ALTERNATE
                    SOURCE OF INFORMATION AS TO THE CONTENTS OF THE
                    ARCHIVE TAPES.
                    (IF A REPORT IS MISPLACED, IT CAN BE RECREATED
                     BY A JOB THAT READS THE ARCHIVE TAPE FOR WHICH
                     THERE IS NOT REPORT. SEE NIA TECH SUPPORT FOR
                     ASSITANCE).

   6      BACKUPM   LIBRARIAN - NORMAL CONDITION CODE IS 0
                    THIS STEP BACKS UP THE LIBRARIAN DATA SET AS THE
                    SECOND FILE ON THE UPDATED ARCHIVE TAPE CREATED IN
                    STEP #3. THIS BACKUP IS DONE PRIOR TO DELETING THE
                    MODULES THAT WERE COPIED TO ARCHIVE TAPE IN STEP #3.

   7      DELETEM   LIBRARIAN - NORMAL CONDITION CODE IS 0
                    THIS STEP INPUTS THE DLM CONTROL CARDS CREATED IN
                    STEP #1 TO DELETE THE MODULES THAT WERE COPIED TO
                    ARCHIVE TAPE IN STEP #3.

   8      OPERMSG   OPS4341G - NORMAL CONDITION CODE IS 0
                    THIS STEP WRITES A MESSAGE TO THE OPERATOR THAT THE
                    ARCHIVE JOBSTREAM IS NOW COMPLETE AND THAT THE
                    LIBSPOOL TASK WILL NOW BE RESTARTED.

   9      STARTLS   IEBGENER - NORMAL CONDITION CODE IS 0
                    THIS STEP SUBMITS A COMMAND THRU THE INTERNAL
                    READER TO START LIBSPOOL.


            ONCE A WEEK (OR SOME OTHER WORKABLE TIME PERIOD THAT IS
            DEPENDENT ON THE VOLUME OF JOBS PROCESSED THRU THE
            LIBSPOOL SYSTEM) ANOTHER WEEKLY BATCH ARCHIVE JOB($OPS2340)
            IS RUN IN PLACE OF THE DAILY ARCHIVE JOB ($OPS2339).
            BESIDES PERFORMING THE TASKS IN THE DAILY ARCHIVE
            JOB THE FOLLOWING IS ALSO DONE:

            1) THE ARCHIVE DATA IS UPDATED ONTO A WEEKLY ARCHIVE
               TAPE. WEEKLY ARCHIVE TAPES ARE KEPT FOR THE PERIOD
               JCL HAS BEEN DESIGNATED TO BE MADE AVAILIABLE FROM
               ARCHIVE (EG. 1 1/2 YEARS). THEREFORE IF A WEEKLY
               ARCHIVE TAPE IS CREATED ONCE A WEEK AND JCL IS TO BE
               AVAILIABLE FOR UP TO 1 1/2 YEARS A GENERATION DATA
               GROUP OF 78 ENTRIES SHOULD BE CREATED FOR THE WEEKLY
               ARCHIVE TAPE DATA SET.

            2) A NULL DAILY ARCHIVE DATA SET IS CREATED TO BE USED
               TO START ACCUMULATING JCL MODULES FOR THE NEXT WEEK.

            3) THE ARCHIVE DIRECTORY DATA SET IS COMPRESSED.

            4) THE RESTORE FROM ARCHIVE DATA SET IS DELETED AND A
               NEW ONE IS ALLOCATED.

            5) THE NUMBER OF MEMBERS IN THE ARCHIVE DIRECTORY
               DATA SET IS LIMITED TO THE NUMBER OF GENERATIONS
               MAINTAINED OF THE WEEKLY ARCHIVE DIRECTORY TAPE
               GENERATION DATA GROUP. (PROPOSED)



LIBSPOOL PROBLEMS
-----------------

THE FOLLOWING ARE KNOWN CURRENT PROBLEMS IN USING LIBSPOOL:

  1) JCL QUEUED TO PRINT BY THE LIBSPOOL TASK PRINTS JOB SEPARATOR
     PAGES FOR EACH SECTION OF JCL OUTPUT. (JES LOG, JCL, EXECUTION
     MESSAGES). THE NEW JES SCHEDULED TO BE OPERATIONAL IN 1983
     CORRECTS THIS PROBLEM.

  2) AFTER ADDING THE LIBSPOOL MSGCLASS TO THE JOB CARD,
     JCL WHICH IS DUAL ROUTED WILL RESULT IN THE JCL NOT TO BE
     SENT TO THE REMOTE DESTINATION SPECIFIED ON THE /*OUTPUT CARD.
     DUAL ROUTING OUTPUT CARDS FOR JCL APPEAR AS:
     /*OUTPUT JCL DEST=(LOCAL,RMT10)


  LIBSPOOL ASSITANCE
 ____________________

              TECHNICAL SUPPORT OF THE NIAGARA DATA CENETR IS
              AVIALIABLE TO SERVICE PROBLEMS ENCOUNTERED WITH
              LIBSPOOL . OXYCOM 939-3251.

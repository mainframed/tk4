        /* THIS PROGRAM CREATES THE VALIDATION TABLE OF BOTH  */
        /* SYSTEM IDS AND USER IDS                            */
        /* IT PRODUCES IEFUJVTB VIA S100UADS. DA MITZ 29AUG80 */
 U040BC: PROCEDURE OPTIONS (MAIN);
0  DCL   TABLE  FILE RECORD OUTPUT,
         DATA1  FILE RECORD INPUT,
         DATA2  FILE RECORD INPUT,
         OUTPUT FILE RECORD OUTPUT;
0  DCL 1 RECIN1 STATIC,                /* MEG1.A55080A  */
        2 ROLLUP_DEPT_INDIC CHAR (1),
        2 FILLER1         CHAR (2),
        2 DEPT            CHAR (4),
        2 FILLER2         CHAR (113);
0  DCL 1 RECIN2 STATIC,               /*  SORTED S39005A */
        2 PROJECT        CHAR (5),
        2 FILL1          CHAR (1),
        2 MANAGER        CHAR (3),
        2 DESCRIPTION    CHAR (27),
        2 PROGRAMMER     CHAR (16),
        2 PHONE          CHAR (9),
        2 DEPARTMENT     CHAR (4),
        2 FILL3          CHAR (55);
0  DCL 1 RECOUT STATIC,
        2 LABEL          CHAR (8)  INIT (' '),
        2 BLANK1         CHAR (1)  INIT (' '),
        2 OPCODE         CHAR (5)  INIT (' '),
        2 BLANK2         CHAR (1)  INIT (' '),
        2 OPRAND         CHAR (4)  INIT (' '),
        2 VALUE          CHAR (8)  INIT (' '),
        2 QUOTE          CHAR (1)  INIT (' '),
        2 BLANK3         CHAR (3)  INIT (' '),
        2 COMMENT        CHAR (41) INIT (' '),
        2 SEQ            CHAR (8)  INIT (' ');
0  DCL 1 SPACE2 STATIC,
        2 FILLA          CHAR (9)  INIT (' '),
        2 FILLB          CHAR (7)  INIT ('SPACE 2'),
        2 FILLC          CHAR (64) INIT (' ');
0  DCL 1 MESSAGE STATIC,
        2 FILLD          CHAR (1)  INIT ('*'),
        2 MSG            CHAR (79) INIT (' ');
0  DCL PTABLE (1000) CHAR (5) STATIC;
0  DCL CTABLE (1000) CHAR (27) STATIC;
0  DCL DTABLE (10000) CHAR (1) STATIC;
0  DCL SEQ1 CHAR (4) STATIC;
0  DCL SEQ2 PIC '9999' STATIC;
0  DCL CNT FIXED BINARY (31,0) INIT (0) STATIC;
1MAINLINE:
0  DO I = 1 TO 10000;
      DTABLE (I) = '0';
      END;
0  DO I = 1 TO 1000;
      PTABLE (I) = '0000';
      CTABLE (I) = ' ';
      END;
0  OPEN FILE (DATA1),
        FILE (DATA2),
        FILE (TABLE),
        FILE (OUTPUT);
   ON ENDFILE (DATA1) GO TO PHASE1A;
   ON ENDFILE (DATA2) GO TO PHASE2;
0  LABEL = 'IEFUJVTB';
   OPCODE = 'CSECT';
0  WRITE FILE (TABLE) FROM (RECOUT);
   WRITE FILE (OUTPUT) FROM (RECOUT);
0  WRITE FILE (TABLE)  FROM (SPACE2);
   WRITE FILE (OUTPUT) FROM (SPACE2);
   MSG = '     DEPARTMENT TABLE GENERATED FROM MEG1.A55080A.';
   WRITE FILE (TABLE)  FROM (MESSAGE);
   WRITE FILE (OUTPUT) FROM (MESSAGE);
   WRITE FILE (TABLE)  FROM (SPACE2);
   WRITE FILE (OUTPUT) FROM (SPACE2);
0  LABEL = '        ';
   OPCODE = 'DS   ';
   OPRAND = '0F';
0  WRITE FILE (TABLE) FROM (RECOUT);
   WRITE FILE (OUTPUT) FROM (RECOUT);
1PHASE1:
0  READ FILE (DATA1) INTO (RECIN1);
0  IF ROLLUP_DEPT_INDIC ^= '2' THEN GO TO PHASE1;
0  IF DEPT = 0 THEN GO TO PHASE1;
0  DTABLE (DEPT) = '1';
0  GO TO PHASE1;
0PHASE1A:
0  READ FILE (DATA2) INTO (RECIN2);
0  IF PROJECT = '    ' ×
      PROJECT = '0000' THEN GO TO PHASE1A;
0  DO I = 1 TO 1000;
      IF PTABLE (I) = '0000' THEN DO;
         PTABLE (I) = PROJECT;
         CTABLE (I) = DESCRIPTION;
         GO TO PHASE1A;
         END;
      IF PTABLE (I) = PROJECT THEN GO TO PHASE1A;
      END;
0  GO TO PHASE1A;
1PHASE2:
0  LABEL  ='        ';
   OPCODE = 'DC   ';
   OPRAND = 'BL1'××'''';
   QUOTE='''';
   SEQ1   = 'DEPT';
   CNT = 1;
0LOOP:
0  IF CNT >= 10000 THEN GO TO PHASE2A;
   SEQ2 = CNT;
   SEQ = SEQ1××SEQ2;
0  VALUE = DTABLE(CNT)  ××
           DTABLE(CNT+1)××
           DTABLE(CNT+2)××
           DTABLE(CNT+3)××
           DTABLE(CNT+4)××
           DTABLE(CNT+5)××
           DTABLE(CNT+6)××
           DTABLE(CNT+7);
   WRITE FILE (TABLE)  FROM (RECOUT);
   WRITE FILE (OUTPUT) FROM (RECOUT);
   CNT = CNT + 8;
   GO TO LOOP;
0PHASE2A:
0  FILLB = 'EJECT  ';
   WRITE FILE (TABLE)  FROM (SPACE2);
   WRITE FILE (OUTPUT) FROM (SPACE2);
   FILLB = 'SPACE 2';
   MSG = '     PROJECT TABLE GENERATED FROM MEG1.S370060A.';
   WRITE FILE (TABLE)  FROM (MESSAGE);
   WRITE FILE (OUTPUT) FROM (MESSAGE);
   WRITE FILE (TABLE)  FROM (SPACE2);
   WRITE FILE (OUTPUT) FROM (SPACE2);
0  SEQ1 = 'PROJ';
   OPRAND = 'CL5'××'''';
   QUOTE = ' ';
0  DO I = 1 TO 1000;
      VALUE = PTABLE(I)××'''';
      COMMENT = CTABLE (I);
      SEQ2 = I;
      SEQ  = SEQ1××SEQ2;
      WRITE FILE (TABLE) FROM (RECOUT);
      WRITE FILE (OUTPUT) FROM (RECOUT);
      END;
1PHASE3:
0  LABEL = '        ';
   OPCODE = 'END  ';
   OPRAND = ' ';
   VALUE = ' ';
   QUOTE = ' ';
   COMMENT = ' ';
   SEQ = ' ';
0  WRITE FILE (TABLE) FROM (RECOUT);
   WRITE FILE (OUTPUT) FROM (RECOUT);
0  CLOSE FILE (DATA1),
         FILE (DATA2),
         FILE (TABLE),
         FILE (OUTPUT);
0END;

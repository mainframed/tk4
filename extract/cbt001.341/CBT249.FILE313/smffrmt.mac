 /*  SMFFRMT - SMF RECORD PRINT ROUTINE                              */
 /**** START OF SPECIFICATIONS ***************************************/
 /*                                                                  */
 /*     MODULE-NAME = SMFFRMT                                        */
 /*     STATUS = CHANGE LEVEL 00                                     */
 /*     DESCRIPTIVE-NAME = SMF RECORD PRINT ROUTINE                  */
 /*                                                                  */
 /*     NOTES = THIS PROGRAM CONTAINS THE MAPPINGS IN PL/I           */
 /*             OF THE NEW SMF RECORDS USED IN SYSTEM                */
 /*             EXTENSIONS RELEASE 2.                                */
 /*             RECORD TYPE 23 (SMF STATUS),                         */
 /*             RECORD TYPE 30 (JOB ACCOUNTING),                     */
 /*             RECORD TYPE 32 (FUNCUNTIONAL ACCOUNTING), AND        */
 /*             RECORD TYPE 90 (OPERATOR TRACKING) ARE MAPPED.       */
 /*                                                                  */
 /*       PROCESSOR = PL/1                                           */
 /*       MODULE-SIZE = APPROX 46,000 BYTES (DECIMAL)                */
 /*       ATTRIBUTES = REUSABLE                                      */
 /*     ENTRY = SMFFRMT                                              */
 /*       INPUT = DATA SET CONTAINING SMF RECORDS                    */
 /*       OUTPUT = PRINT OUT OF THE FORMATTED RECORDS                */
 /*                                                                  */
 /*      JCL TO RUN JOB AS FOLLOWS                                   */
 /*  //JOBCARD    JOB   (ACCOUNTING INFO),'NAME'                     */
 /*  //STEP1      EXEC  PLIXCLG                                      */
 /*  //PLI.SYSIN  DD    DSN=SYS1.SAMPLIB(SMFFRMT),DISP=SHR           */
 /*  //GO.SMFDATA DD    DSN=(DATA SET CONTAINING SMF RECORDS)        */
 /*  //GO.RPORT23 DD    SYSOUT=A                                     */
 /*  //GO.RPORT90 DD    SYSOUT=A                                     */
 /*                                                                  */
 /**** END OF SPECIFICATIONS *****************************************/
  %PAGE;
 SMFFRMT:  PROCEDURE OPTIONS (MAIN);


 %PAGE;
 /********************************************************************/
 /*                                                                  */
 /* SMF TYPE 23 RECORD - SMF STATISTICS                              */
 /*                                                                  */
 /* THIS RECORD IS WRITTEN AT USER SPECIFIED INTERVALS               */
 /* TO RECORD SMF STATISTICS COLLECTED DURING THE INTERVAL.          */
 /*                                                                  */
 /* THE RECORD LENGTH IS VARIABLE.                                   */
 /*                                                                  */
 /********************************************************************/

 DCL 1 SMFRCD23 BASED(ADDR(REAL_RECORD)),/*                          */
       2 SMF23FLG BIT (8),         /* HEADER FLAG BYTE               */
       2 SMF23RTY BIT (8),         /* RECORD TYPE - 23               */
       2 SMF23TME CHAR(4),          /*RECORD WRITTEN TIME            */
       2 SMF23DTE FIXED DECIMAL (7),/*RECORD WRITTEN DATE YYDDDF     */
       2 SMF23SID CHAR(4),         /* SYSTEM IDENTIFICATION          */

 /********************************************************************/
 /*                                                                  */
 /*            SELF DEFINING SECTION                                 */
 /*                                                                  */
 /********************************************************************/

       2 SMF23RS1 CHAR (2),        /*  RESERVED                      */
       2 SMF23SLS,                 /*                                */
         3 SMF23POF OFFSET (RECORD),   /* OFFSET TO PRODUCT SEGMENT  */
         3 SMF23PLN FIXED BINARY (15), /* LENGTH OF PRODUCT SEGMENT  */
         3 SMF23PON FIXED BINARY (15), /* NUMBER OF PRODUCT SEGMENTS */
         3 SMF23SOF OFFSET (RECORD),   /* OFFSET TO SYSTEM SEGMENT   */
         3 SMF23SLN FIXED BINARY (15), /* LENGTH OF SYSTEM SEGMENT   */
         3 SMF23SON FIXED BINARY (15), /* NUMBER OF SYSTEM SEGMENTS  */
         3 SMF23ROF OFFSET (RECORD),   /* OFFSET TO SMF SEGMENT      */
         3 SMF23RLN FIXED BINARY (15), /* LENGTH OF SMF SEGMENT      */
         3 SMF23RON FIXED BINARY (15); /* NUMBER OF SMF SEGMENTS     */
 %PAGE;
 /********************************************************************/
 /*                                                                  */
 /*            PRODUCT SECTION                                       */
 /*                                                                  */
 /********************************************************************/

   DCL 1 SMF23PRS (1) BASED(SMF23POF), /* MAX OF 1 PRODUCT SECTION   */
         2 SMF23TID FIXED BINARY (15), /* SUBTYPE ID - 0             */
         2 SMF23RVN CHAR(2),       /* RECORD VERSION NUMBER - 01     */
         2 SMF23PNM CHAR(8);       /* PRODUCT NAME - SMF             */

 /********************************************************************/
 /*                                                                  */
 /*            SYSTEM DEFINITION SEGMENT                             */
 /*                                                                  */
 /********************************************************************/

   DCL 1 SMF23SDS (1) BASED(SMF23SOF), /* MAX OF 1 SYSTEM DEFINITION */
         2 SMF23INT CHAR(6),       /* INTERVAL - HHMMSS              */
         2 SMF23RLS CHAR(4);       /* OPERATING SYSTEM RELEASE NUMBER*/

 /********************************************************************/
 /*                                                                  */
 /*             SMF STATISTICS SECTION                               */
 /*                                                                  */
 /********************************************************************/

   DCL 1 SMF23SMF (1) BASED(SMF23ROF), /*                            */
         2 SMF23BFW FIXED BINARY (31), /* # OF BUFFERS WRITTEN       */
         2 SMF23BFQ FIXED BINARY (31), /* MAX # OF FULL BUFFERS      */
         2 SMF23SUS FIXED BINARY (31), /* # OF TIMES SUSPENDED       */
         2 SMF23RCW FIXED BINARY (31); /* # OF RECORDS WRITTEN       */

    %PAGE;
 /********************************************************************/
 /*  SMF TYPE 30 RECORD DEFINITION                                   */
 /*                                                                  */
 /*                                                                  */
 /*      THIS RECORD IS WRITTEN AT NORMAL OR ABNORMAL                */
 /*      TERMINATION OF THE FOLLOWING:                               */
 /*          A BATCH JOB STEP                                        */
 /*          A BATCH JOB                                             */
 /*          A TSO SESSION                                           */
 /*          A STARTED TASK                                          */
 /*                                                                  */
 /*         THE EXPIRATION OF THE ACCOUNTING INTERVAL FOR ANY        */
 /*         OF THE ABOVE WORK CLASSES.                               */
 /*                                                                  */
 /*      THE RECORD LENGTH IS VARIABLE. MINIMUM OF XXX.              */
 /*                                                                  */
 /********************************************************************/

 DCL 1 SMFRCD30 BASED(ADDR(REAL_RECORD)),/*                          */

 /********************************************************************/
 /*                                                                  */
 /*  SMF RECORD HEADER SEGMENT                                       */
 /*                                                                  */
 /********************************************************************/

    2 SMF30RPS,                    /* FIXED RECORD SECTIONS          */
     5 SMF30FLG BIT (8),           /*HEADER FLAG BYTE                */
     5 SMF30RTY BIT (8),           /*RECORD TYPE - 30                */
     5 SMF30TME CHAR (4),          /*RECORD WRITTEN TIME             */
     5 SMF30DTE FIXED DECIMAL (7), /*RECORD WRITTEN DATE             */
     5 SMF30SID CHAR(4),           /*SYSTEM IDENTIFIER               */
     5 SMF30WID CHAR(4),           /*WORK CLASS ID                   */
     5 SMF30RS1 FIXED BINARY (15), /* RESERVED                       */

 /********************************************************************/
 /*                                                                  */
 /*  SELF DEFINING SECTION                                           */
 /*                                                                  */
 /********************************************************************/

    3 SMF30SDS,                    /*  SELF DEFINING SECTION         */
     5 SMF30SOF OFFSET (RECORD),   /*OFFSET TO SUBSYSTEM SEGMENT     */
     5 SMF30SLN FIXED BINARY (15), /*LENGTH OF SUBSYSTEM SEGMENT     */
     5 SMF30SON FIXED BINARY (15), /*NUMBER OF SUBSYSTEM SEGMENTS    */
     5 SMF30IOF OFFSET (RECORD),   /*OFFSET TO IDENTIFICATION SEGMENT*/
     5 SMF30ILN FIXED BINARY (15), /*LENGTH OF IDENTIFICATION SEGMENT*/
     5 SMF30ION FIXED BINARY (15), /*NUMBER OF IDENTIFICATION SEGMENT*/
     5 SMF30UOF OFFSET (RECORD),   /*OFFSET TO I/O ACTIVITY SEGMENT  */
     5 SMF30ULN FIXED BINARY (15), /*LENGTH OF I/O ACTIVITY SEGMENT  */
     5 SMF30UON FIXED BINARY (15), /*NUMBER OF I/O ACTIVITY SEGMENTS */
     5 SMF30TOF OFFSET (RECORD),   /*OFFSET TO COMPLETION SEGMENT    */
     5 SMF30TLN FIXED BINARY (15), /*LENGTH OF COMPLETION SEGMENT    */
     5 SMF30TON FIXED BINARY (15), /*NUMBER OF COMPLETION            */
     5 SMF30COF OFFSET (RECORD),   /*OFFSET TO CPU ACCOUNTING SEGMENT*/
     5 SMF30CLN FIXED BINARY (15), /*LENGTH OF CPU ACCOUNTING SEGMENT*/
     5 SMF30CON FIXED BINARY (15), /*NUMBER OF CPU ACCOUNTING SEGMENT*/
     5 SMF30AOF OFFSET (RECORD),   /*OFFSET TO ACCOUNTING SEGMENT    */
     5 SMF30ALN FIXED BINARY (15), /*LENGTH OF ACCOUNTING SEGMENT    */
     5 SMF30AON FIXED BINARY (15), /*NUMBER OF ACCOUNTING SEGMENTS   */
     5 SMF30ROF OFFSET (RECORD),   /*OFFSET TO STORAGE SEGMENT       */
     5 SMF30RLN FIXED BINARY (15), /*LENGTH OF STORAGE SEGMENT       */
     5 SMF30RON FIXED BINARY (15), /*NUMBER OF STORAGE SEGMENTS      */
     5 SMF30POF OFFSET (RECORD),   /*OFFSET TO PERFORMANCE SEGMENT   */
     5 SMF30PLN FIXED BINARY (15), /*LENGTH OF PERFORMANCE SEGMENT   */
     5 SMF30PON FIXED BINARY (15), /*NUMBER OF PERFORMANCE SEGMENTS  */
     5 SMF30OOF OFFSET (RECORD),   /*OFFSET TO OPERATOR SEGMENT      */
     5 SMF30OLN FIXED BINARY (15), /*LENGTH OF OPERATOR SEGMENT      */
     5 SMF30OON FIXED BINARY (15), /*NUMBER OF OPERATOR SEGMENTS     */
     5 SMF30EOF OFFSET (RECORD),   /*OFFSET TO EXCP SEGMENT          */
     5 SMF30ELN FIXED BINARY (15), /*LENGTH OF EXCP SEGMENT          */
     5 SMF30EON FIXED BINARY (15), /*NO OF EXCP SEGS - THIS RECORD   */
     5 SMF30EOR FIXED BINARY (15); /*NO OF EXCP SEGS - OTHER RECORDS */

 /********************************************************************/
 /*                                                                  */
 /*  PRODUCT OR SUBSYSTEM SECTION                                    */
 /*                                                                  */
 /********************************************************************/

 DECLARE
   1 SMF30PSS (1) BASED(SMF30SOF), /* MAX OF 1 PRODUCT SECTION       */
     5 SMF30TYP FIXED BINARY (15), /*RECORD SUBTYPE                  */
 /********************************************************************/
 /* 1 = JOB INITIATION                                               */
 /* 2 = INTERVAL RECORD                                              */
 /* 3 = STEP END RECORD- DELTA FROM LAST INTERVAL                    */
 /* 4 = STEP END TOTAL                                               */
 /* 5 = JOB TERMINATION                                              */
 /********************************************************************/
     5 SMF30RS2 FIXED BINARY (15), /*RESERVED                        */
     5 SMF30RVN CHAR(2),           /*RECORD VERSION                  */
     5 SMF30PNM CHAR(8);           /*PRODUCT NAME - SMF              */
 %PAGE;
 /********************************************************************/
 /*                                                                  */
 /*  JOB/SESSION ID SEGMENT                                          */
 /*                                                                  */
 /********************************************************************/

 DECLARE
   1 SMF30ID (1) BASED(SMF30IOF),  /*MAX OF 1 IDENTIFICATION SEGMENT */
     3 SMF30JBN CHAR(8),           /*JOB/SESSION NAME                */
     3 SMF30PGM CHAR(8),           /*PROGRAM NAME                    */
     3 SMF30STM CHAR(8),           /*STEP NAME                       */
     3 SMF30UIF CHAR(8),           /*USER ID FIELD                   */
     3 SMF30JNM CHAR(8),           /*JES JOB NUMBER                  */
     3 SMF30STN FIXED BINARY (15), /*STEP NUMBER                     */
     3 SMF30CLS CHAR(1),           /*JOB CLASS                       */
     3 SMF30RS3 CHAR(1),           /* RESERVED                       */
     3 SMF30PGN FIXED BINARY (15), /*JOB PERFORMANCE GROUP NUMBER    */
     3 SMF30JPT FIXED BINARY (15), /*JES INPUT PRIORITY              */
     3 SMF30AST FIXED BINARY (31), /*DEVICE ALLOCATION START TIME    */
     3 SMF30PPS FIXED BINARY (31), /*PROBLEM PROGRAM START TIME      */
     3 SMF30SIT FIXED BINARY (31), /*STEP INITIATION TIME            */
     3 SMF30STD CHAR(4),           /*STEP INITIATION DATE            */
     3 SMF30RST FIXED BINARY (31), /*READER START TIME               */
     3 SMF30RSD CHAR(4),           /*READER START DATE               */
     3 SMF30RDE,                   /* READER END TIME/DATE           */
       4 SMF30RET FIXED BINARY (31), /* READER END TIME              */
       4 SMF30RED CHAR(4),         /* READER END DATE                */
     3 SMF30USR CHAR(20),          /*PROGRAMMER'S NAME               */
     3 SMF30GRP CHAR(8),           /*RACF GROUP ID                   */
     3 SMF30RUD CHAR(8),           /*RACF USER ID                    */
     3 SMF30TID CHAR(8);           /*RACF TERMINAL ID                */
 %PAGE;
 /********************************************************************/
 /*                                                                  */
 /*  I/O ACTIVITY SEGMENT                                            */
 /*                                                                  */
 /********************************************************************/

 DECLARE
   1 SMF30URA (1) BASED(SMF30UOF), /* MAX OF 1 I/O ACTIVITY SEGMENT  */
     3 SMF30INP FIXED BINARY (31), /*NUMBER OF CARD IMAGES           */
     3 SMF30TEP FIXED BINARY (31), /*TOTAL BLOCKS TRANSFERRED        */
     3 SMF30TPT FIXED BINARY (31), /*NUMBER OF TPUTS (TSO SESSION)   */
     3 SMF30TGT FIXED BINARY (31), /*NUMBER OF TGETS (TSO SESSION)   */
     3 SMF30RDR CHAR(1),           /*READER DEVICE CLASS             */
     3 SMF30RDT CHAR(1),           /*READER DEVICE TYPE              */
     3 SMF30RV4 FIXED BINARY (15); /* RESERVED FIELD                 */

 /********************************************************************/
 /*                                                                  */
 /*     COMPLETION SEGMENT                                           */
 /*                                                                  */
 /********************************************************************/

 DECLARE
    1 SMF30CMP (1) BASED(SMF30TOF),/*MAX OF 1 COMPLETION SEGMENT     */
     3 SMF30SCC CHAR(2),           /*STEP COMPLETION CODE            */
     3 SMF30STI,                   /*STEP TERMINATION INDICATOR      */
        4 SMF30SAB BIT(1),         /* SYSTEM ABENDED                 */
        4 SMF30UJV BIT(1),         /* CANCELLED AT IEFUJV            */
        4 SMF30UJI BIT(1),         /* CANCELLED AT IEFUJI            */
        4 SMF30USI BIT(1),         /* CANCELLED AT IEFUSI            */
        4 SMF30TRT BIT(1),         /* CANCELLED AT IEFACTRT          */
        4 SMF30SRS BIT(1),         /* STEP IS TO BE RESTARTED        */
        4 SMF30ABD BIT(1),         /* STEP ABENDED                   */
        4 SMF30FLH BIT(1),         /* STEP FLUSHED                   */
        4 SMF30EXF BIT(1),         /* EXCP COUNTS MAY BE WRONG       */
        4 SMF30ISK BIT(1),         /* PREVIOUS INTERVAL SKIPPED      */
        4 SMF30RS9 BIT(6);         /* RESERVED                       */
 %PAGE;
 /********************************************************************/
 /*                                                                  */
 /*  CPU  ACCOUNTING SEGMENT                                         */
 /*                                                                  */
 /********************************************************************/

 DECLARE
    1 SMF30CAS (1) BASED(SMF30COF), /* MAX OF 1 ACCOUNTING SEGMENT   */
     3 SMF30PTY FIXED BINARY (15), /*CPU DISPATCHING PRIORITY        */
     3 SMF30RV3 FIXED BINARY (15), /*RESERVED                        */
     3 SMF30CPT FIXED BINARY (31), /*STEP CPU TIME UNDER TCB         */
     3 SMF30CPS FIXED BINARY (31), /*STEP CPU TIME UNDER SRB         */
     3 SMF30ICU FIXED BINARY (31), /*INITIATOR CPU TIME UNDER TCB    */
     3 SMF30ISB FIXED BINARY (31); /*INITIATOR CPU TIME UNDER SRB    */

 /********************************************************************/
 /*                                                                  */
 /*   EXCP SEGMENT                                                   */
 /*                                                                  */
 /********************************************************************/

 DECLARE
   1 SMF30EXP (255) BASED(SMF30EOF),/* MAX OF 255 EXCP SECTIONS      */
     3 SMF30KEY,                   /*COMPARISON KEY                  */
       5 SMF30DEV CHAR(1),         /*DEVICE CLASS                    */
       5 SMF30UTP CHAR(1),         /*UNIT TYPE                       */
       5 SMF30CUA,                 /*CHANNEL AND UNIT ADDRESS        */
         7 SMF30VDV BIT(1),        /* VIRTUAL DEVICE INDICATOR (MSS) */
         7 SMF30RS4 BIT(15),       /* RESERVED                       */
       5 SMF30DDN CHAR(8),         /*DD NAME FOR THIS DATA SET       */
     3 SMF30BLK FIXED BINARY (31), /*NUMBER OF BLOCKS FOR THIS D.S.  */
     3 SMF30BSZ,                   /*LARGEST BLOCKSIZE FOR THIS D.S. */
       5 SMF30CBS BIT(1),          /*CHANGED BLOCK SIZE              */
       5 SMF30RV1 BIT(15),         /*RESERVED                        */
     3 SMF30RV2  FIXED BINARY (15); /*RESERVED                       */

 /********************************************************************/
 /*                                                                  */
 /*  ACCOUNTING SEGMENT                                              */
 /*                                                                  */
 /********************************************************************/

 DECLARE
   1 SMF30ACS (1) BASED(SMF30AOF), /*MAX OF 1 ACCOUNTING SEGMENT     */
     3 SMF30AFL FIXED(8),          /*SUB FIELD LENGTH                */
     3 SMF30ACT CHAR(100);         /*ACCTG FIELD - LENGTH IS SMF30AFL*/
 %PAGE;
 /********************************************************************/
 /*                                                                  */
 /*  STORAGE AND PAGING SECTION                                      */
 /*                                                                  */
 /********************************************************************/

 DECLARE
   1 SMF30SAP (1) BASED(SMF30ROF), /*MAX OF 1 STORAGE SEGMENT        */
     3 SMF30RGN FIXED BINARY (15), /*REGION SIZE REQUESTED           */
     3 SMF30SFL,                   /*STORAGE FLAGS                   */
      5 SMF30VQR BIT(1),           /* STORAGE REQUESTED V=R          */
      5 SMF30RS8 BIT(7),           /* RESERVED                       */
     3 SMF30SPK BIT (8),           /*STORAGE PROTECT KEY             */
     3 SMF30PRV FIXED BINARY (15), /*VIRT STOR - USER PRIVATE AREA   */
     3 SMF30SYS FIXED BINARY (15), /*VIRT STOR - SYSTEM AREA         */
     3 SMF30PGI FIXED BINARY (31), /*NUMBER OF PAGE-INS              */
     3 SMF30PGO FIXED BINARY (31), /*NUMBER OF PAGE-OUTS             */
     3 SMF30REC FIXED BINARY (31), /*NUMBER OF RECLAIMS              */
     3 SMF30NSW FIXED BINARY (31), /*NUMBER OF SWAPS                 */
     3 SMF30PSI FIXED BINARY (31), /*NUMBER OF PAGES SWAPPED IN      */
     3 SMF30PSO FIXED BINARY (31), /*NUMBER OF PAGES SWAPPED OUT     */
     3 SMF30VPI FIXED BINARY (31), /*NUMBER OF VIO PAGE-INS          */
     3 SMF30VPO FIXED BINARY (31), /*NUMBER OF VIO PAGE-OUTS         */
     3 SMF30VPR FIXED BINARY (31), /*NUMBER OF VIO RECLAIMS          */
     3 SMF30CPI FIXED BINARY (31), /*NUMBER OF COMMON PAGE-INS       */
     3 SMF30CPR FIXED BINARY (31), /*NUMBER OF COMMON RECLAIMS       */
     3 SMF30LPI FIXED BINARY (31), /*NUMBER OF LPA PAGE-INS          */
     3 SMF30LPR FIXED BINARY (31), /*NUMBER OF LPA RECLAIMS          */
     3 SMF30PST FIXED BINARY (31), /*NUMBER OF PAGES STOLEN FROM HERE*/
     3 SMF30PSC CHAR(8);           /*NUMBER OF CPU PAGE-SECONDS      */
 %PAGE;
 /********************************************************************/
 /*                                                                  */
 /*  PERFORMANCE SEGMENT                                             */
 /*                                                                  */
 /********************************************************************/

 DECLARE
   1 SMF30PRF (1) BASED(SMF30POF), /*MAX OF 1 PERFORMANCE SEGMENT    */
     3 SMF30SRV FIXED BINARY (31), /*TOTAL SERVICE UNITS             */
     3 SMF30CSU FIXED BINARY (31), /*CPU SERVICE UNITS               */
     3 SMF30SRB FIXED BINARY (31), /*SRB   SERVICE UNITS             */
     3 SMF30IO  FIXED BINARY (31), /*I/O   SERVICE UNITS             */
     3 SMF30MSO FIXED BINARY (31), /*MSO   SERVICE UNITS             */
     3 SMF30TAT FIXED BINARY (31), /*TRANSACTION ACTIVE TIME         */
     3 SMF30TET FIXED BINARY (31), /* RESERVED                       */
     3 SMF30RES FIXED BINARY (31), /*TRANSATION RESIDENCY TIME       */
     3 SMF30TRS FIXED BINARY (31); /*NUMBER OF TRANSACTIONS          */

 /********************************************************************/
 /*                                                                  */
 /*  OPERATOR SEGMENT                                                */
 /*                                                                  */
 /********************************************************************/

 DECLARE
   1 SMF30OPS (1) BASED(SMF30OOF), /*MAX OF 1 OPERATOR SEGMENT       */
     3 SMF30PDM FIXED BINARY (31), /* NON-SPECIFIC DASD MOUNTS       */
     3 SMF30PRD FIXED BINARY (31), /* SPECIFIC DASD MOUNTS           */
     3 SMF30PTM FIXED BINARY (31), /* NON-SPECIFIC TAPE MOUNTS       */
     3 SMF30TPR FIXED BINARY (31), /* SPECIFIC TAPE MOUNTS           */
     3 SMF30MTM FIXED BINARY (31), /* NONSPECIFIC MSS MOUNTS         */
     3 SMF30MSR FIXED BINARY (31); /*NUMBER OF SPECIFIC MSS MOUNTS   */
 %PAGE;
 /********************************************************************/
 /*                                                                  */
 /*  SMF TYPE 32 RECORD - WORK ACCOUNTING FOR TSO USER               */
 /*                                                                  */
 /*  THIS RECORD IS WRITTEN AT NORMAL OR ABNORMAL TERMINATION        */
 /*  OF A TSO SESSION, AND AT THE EXPIRATION OF THE ACCOUNTING       */
 /*  INTERVAL FOR A TSO SESSION.                                     */
 /*                                                                  */
 /********************************************************************/

 DCL 1 SMFRCD32 BASED(ADDR(REAL_RECORD)),/*                          */

       2 SMF32RPS,                /* RECORD HEADER SECTION           */
         3 SMF32FLG BIT (8),      /* HEADER FLAG BYTE                */
         3 SMF32RTY BIT (8),      /* RECORD TYPE - 32                */
         3 SMF32TME CHAR(4),      /* RECORD WRITTEN TIME             */
         3 SMF32DTE FIXED DECIMAL (7), /* RECORD WRITTEN DATE        */
         3 SMF32SID CHAR (4),     /* SYSTEM IDENTIFICATION           */
         3 SMF32WID CHAR (4),     /* SUBSYSTEM ID                    */
         3 SMF32RS1 CHAR (2),     /* RESERVED                        */

 /********************************************************************/
 /*                                                                  */
 /*         SELF DEFINING SECTION                                    */
 /*                                                                  */
 /********************************************************************/

       2 SMF32SDS,                /* SELF DEFINING SECTION           */
         3 SMF32POF OFFSET (RECORD),   /* OFFSET TO PRODUCT SECTION  */
         3 SMF32PLN FIXED BINARY (15), /* LENGTH OF PRODUCT SECTION  */
         3 SMF32PON FIXED BINARY (15), /* NUMBER OF PRODUCT SECTION  */
         3 SMF32IOF OFFSET (RECORD),   /* OFFSET TO ID SECTION       */
         3 SMF32ILN FIXED BINARY (15), /* LENGTH OF ID SECTION       */
         3 SMF32ION FIXED BINARY (15), /* NUMBER OF ID SECTION       */
         3 SMF32COF OFFSET (RECORD),   /* OFFSET TO COMMAND SECTION  */
         3 SMF32CLN FIXED BINARY (15), /* LENGTH TO COMMAND SECTION  */
         3 SMF32CON FIXED BINARY (15); /* NUMBER OF COMMAND SECTION  */
 %PAGE;
 /********************************************************************/
 /*                                                                  */
 /*         PRODUCT SECTION                                          */
 /*                                                                  */
 /********************************************************************/

 DCL 1 SMF32PSS (1) BASED(SMF32POF), /*MAX OF 1 PRODUCT SEGMENT      */
       /**************************************************************/
       /*                                                            */
       /*  SUBTYPE DEFINITION                                        */
       /*     1 = INTERVAL RECORD - NODETAIL                         */
       /*     2 = INTERVAL RECORD - DETAIL                           */
       /*     3 = TSU END  RECORD - NODETAIL                         */
       /*     4 = TSU END  RECORD - DETAIL                           */
       /*                                                            */
       /**************************************************************/
       2 SMF32TYP FIXED BINARY (15), /* RECORD SUB-TYPE              */
       2 SMF32RVN CHAR(2),        /* RECORD VERSION - 01             */
       2 SMF32PNM CHAR(8);        /* PRODUCT NAME - 'TSO'            */
 %PAGE;
 /********************************************************************/
 /*                                                                  */
 /*       JOB / SESSION ID SECTION                                   */
 /*                                                                  */
 /********************************************************************/

 DCL 1 SMF32ID (1) BASED(SMF32IOF), /*MAX OF 1 ID SECTION            */
       3 SMF32JBN CHAR(8),         /*JOB/SESSION NAME                */
       3 SMF32PGM CHAR(8),         /*PROGRAM NAME                    */
       3 SMF32STM CHAR(8),         /*STEP NAME                       */
       3 SMF32UIF CHAR(8),         /*USER ID FIELD                   */
       3 SMF32JNM CHAR(8),         /*JES JOB NUMBER                  */
       3 SMF32STN FIXED BINARY (15), /*STEP NUMBER                   */
       3 SMF32RV1 CHAR(2),         /* RESERVED                       */
       3 SMF32PGN FIXED BINARY (15), /*JOB PERFORMANCE GROUP NUMBER  */
       3 SMF32JPT FIXED BINARY (15), /*JES INPUT PRIORITY            */
       3 SMF32AST FIXED BINARY (31), /*DEVICE ALLOCATION START TIME  */
       3 SMF32PPS FIXED BINARY (31), /*PROBLEM PROGRAM START TIME    */
       3 SMF32SIT FIXED BINARY (31), /*STEP INITIATION TIME          */
       3 SMF32STD CHAR(4),         /*STEP INITIATION DATE            */
       3 SMF32RST FIXED BINARY (31), /*READER START TIME             */
       3 SMF32RSD CHAR(4),         /*READER START DATE               */
       3 SMF32RDE ,                /*LOGON ENQUEUE TIME/DATE         */
         4 SMF32RET CHAR(4),       /*LOGON ENQUEUE TIME              */
         4 SMF32RED CHAR(4),       /* LOGON ENQUEUE DATE             */
       3 SMF32USR CHAR(20),        /*PROGRAMMER'S NAME               */
       3 SMF32GRP CHAR(8),         /*RACF GROUP ID                   */
       3 SMF32RUD CHAR(8),         /*RACF USER ID                    */
       3 SMF32TID CHAR(8);         /*RACF TERMINAL ID                */
 %PAGE;
 /********************************************************************/
 /*                                                                  */
 /*      TSO COMMAND SEGMENT                                         */
 /*      NON-DETAIL HAS ONLY COMMAND & COUNT                         */
 /*                                                                  */
 /********************************************************************/

 DCL 1 SMF32CDS (1) BASED (SMF32COF), /* MAX OF 1 COMMAND SEGMENT    */
      3 SMF32BSC,                 /* BASIC SECTION                   */
       5 SMF32CMD CHAR(8),        /* COMMAND NAME                    */
       5 SMF32CNT FIXED BINARY (31), /* COMMAND COUNT                */
      3 SMF32DTL,                 /* DETAIL SECTION                  */
       5 SMF32TCB FIXED BINARY (31), /* TCB TIME FOR COMMAND         */
       5 SMF32SRB FIXED BINARY (31), /* SRB TIME FOR COMMAND         */
       5 SMF32TGT FIXED BINARY (31), /* TGETS FOR COMMAND            */
       5 SMF32TPT FIXED BINARY (31), /* TPUTS FOR COMMAND            */
       5 SMF32TRN FIXED BINARY (31), /* TRANSACTIONS FOR CMD         */
       5 SMF32EXP FIXED BINARY (31); /* EXCPS FOR COMMAND            */
 %PAGE;
 /********************************************************************/
 /*                                                                  */
 /*  SMF TYPE 90 RECORD - OPERATOR TRACKING                          */
 /*                                                                  */
 /*  THIS RECORD IS WRITTEN WHEN EVER AN OPERATOR COMMAND OF         */
 /*  THE FOLLOWING TYPE IS RECEIVED:                                 */
 /*               SET TIME                                           */
 /*               SET DATE                                           */
 /*               SETDMN                                             */
 /*               SET IPS                                            */
 /*               SET OPT                                            */
 /*               SET ICS                                            */
 /*               IPL SRM                                            */
 /*               IPL/SET SMF                                        */
 /*               SWITCH SMF                                         */
 /*               HALT EOD                                           */
 /*  THIS RECORD IS ALSO WRITTEN TO CONTAIN THE DATA FROM            */
 /*  RESPONSE TO THE IPL REASON PROMPT.                              */
 /*                                                                  */
 /*  RECORD LENGTH IS VARIABLE MINIMUM OF XXX BYTES                  */
 /********************************************************************/

 DCL
   1 SMFRCD90 BASED(ADDR(REAL_RECORD)), /*                           */
     3 SMF90FLG BIT (8),             /* HEADER FLAG BYTE             */
     3 SMF90RTY BIT (8),             /* RECORD TYPE 90 HEX 5A        */
     3 SMF90TME CHAR (4),            /* RECORD WRITTEN TIME          */
     3 SMF90DTE FIXED DECIMAL (7),   /* RECORD WRITTEN DATE          */
     3 SMF90SID CHAR(4),             /* SYSTEM IDENTIFICATION        */

 /********************************************************************/
 /*                                                                  */
 /*        SELF DEFINING SECTION                                     */
 /*                                                                  */
 /********************************************************************/

     3 SMF90RS1 CHAR (2),            /* RESERVED                     */
   2 SMF90PSG,                       /*                              */
     3 SMF90POF OFFSET (RECORD),     /* OFFSET TO PROD SECTION       */
     3 SMF90PLN FIXED BINARY (15),   /* LENGTH OF PRODUCT SECTION    */
     3 SMF90PON FIXED BINARY (15),   /* NUMBER OF PRODUCT SECTION    */
     3 SMF90DOF OFFSET (RECORD),     /* OFFSET TO DATA SECTION       */
     3 SMF90DLN FIXED BINARY (15),   /* LENGTH OF DATA SECTION       */
     3 SMF90DON FIXED BINARY (15);   /* NUMBER OF DATA SECTION       */
 %PAGE;
 /********************************************************************/
 /*                                                                  */
 /*   PRODUCT HEADER                                                 */
 /*                                                                  */
 /********************************************************************/

 DCL
   1 SMF90PRH (1) BASED(SMF90POF), /* MAX OF 1 PRODUCT HEADER        */
     3 SMF90TID FIXED BINARY (15), /* SUB TYPE ID                    */
   /******************************************************************/
   /*  1 = SET TIME   2 = SET DATE     3 = SETDMN    4 = SET IPS     */
   /*  5 = SET SMF    6 = SWITCH SMF   7 = HALT EOD  8 = IPL PROMPT  */
   /*  9 = IPL SMF   10 = IPL SRM     11 = SET OPT  12 = SET ICS     */
   /******************************************************************/
     3 SMF90RVN CHAR(2),           /* RECORD VERSION NUMBER          */
     3 SMF90PNM CHAR(8);           /* PRODUCT NAME - SMF,SRM,SUP,ETC */

 /********************************************************************/
 /*                                                                  */
 /*  IPL SMF/SET SMF COMMAND SEGMENT - SUBTYPE ID 5 OR 9             */
 /*                                                                  */
 /********************************************************************/

 DCL
   1 SMF90T5 (1) BASED(SMF90DOF),  /* MAX OF 1 IPL SMF SEGMENT       */

 /********************************************************************/
 /*                                                                  */
 /*      SELF DEFINING SECTION FOR SUBTYPE 5 OR 9                    */
 /*                                                                  */
 /********************************************************************/

     3 SMF90OSM OFFSET (RECORD),     /* OFFSET OF SMF SEGMENT        */
     3 SMF90LSM FIXED BINARY (15),   /* LENGTH OF SMF SEGMENT        */
     3 SMF90NSM FIXED BINARY (15),   /* NUMBER OF SMF SEGMENTS       */
     3 SMF90ODA OFFSET (RECORD),     /* OFFSET OF DATASET SEGMENT    */
     3 SMF90LDA FIXED BINARY (15),   /* LENGTH OF DATASET SEGMENT    */
     3 SMF90NDA FIXED BINARY (15),   /* NUMBER OF DATA SETS          */
     3 SMF90OWK OFFSET (RECORD),     /* OFFSET OF SUBSYS SEGMENT     */
     3 SMF90LWK FIXED BINARY (15),   /* LENGTH OF SUBSYSTEM SEGMENT  */
     3 SMF90NWK FIXED BINARY (15);   /* NUMBER OF SUBSYSTEMS         */
 %PAGE;
 /********************************************************************/
 /*                                                                  */
 /*      SMF OPTIONS AT IPL OR SET                                   */
 /*                                                                  */
 /********************************************************************/
 DCL
   1 SMF90DSM (1) BASED(SMF90OSM(1)),      /*  1 DATA SEGMENT        */
     3 SMF90MAX CHAR(4),             /* MAXDORM IN MMSS FORMAT       */
     3 SMF90STA CHAR(6),             /* STATUS IN HHMMSS FORMAT      */
     3 SMF90JWT CHAR(4),             /* JWT IN HHMM FORMAT           */
     3 SMF90SYI CHAR(4),             /* SYSID IN CHARACTER           */
     3 SMF90BUF BIT  (8),            /* MIN NUMBER OF BUFFERS        */
     3 SMF90BUM BIT  (8),            /* MAX NUMBER OF BUFFERS        */
     3 SMF90SWT,                     /* SWITCHES                     */
       5 SMF90PAL BIT(1),            /* PROMPT(ALL)                  */
       5 SMF90PLT BIT(1),            /* PROMPT(LIST)                 */
       5 SMF90PIP BIT(1),            /* PROMPT(IPLR)                 */
       5 SMF90PNO BIT(1),            /* PROMPT(NONE)                 */
       5 SMF90RPR BIT(1),            /* REC(PERM)                    */
       5 SMF90RAL BIT(1),            /* REC(ALL)                     */
       5 SMF90LDS BIT(1),            /* LISTDSN                      */
       5 SMF90NLD BIT(1),            /* NOLISTDSN                    */
    3 SMF90RV7 CHAR(3) ,             /* RESERVED                     */
    3 SMF90REL CHAR(4),              /* MVS RELEASE NUMBER           */
    3 SMF90IIT FIXED BINARY (31),    /* IPL TIME                     */
    3 SMF90IDT FIXED DECIMAL (7);    /* IPL DATE  00YYDDDF           */
 %PAGE;
 /********************************************************************/
 /*                                                                  */
 /*      SUBTYPE 5 OR 9 - DATA SET SEGMENT.  THERE WILL BE AN ENTRY  */
 /*      FOR EACH SMF RECORDING DATA SET.  THE FIRST DATA SET IS THE */
 /*      ACTIVE DATA SET AT IPL                                      */
 /*                                                                  */
 /********************************************************************/

 DCL
   1 SMF90DSE (36) BASED(SMF90ODA(1)),      /* 36 DSNAME ENTRIES     */
     3 SMF90DSN CHAR(10);            /* SMF DATA SET NAME            */

 /********************************************************************/
 /*                                                                  */
 /*      SUBTYPE 5 OR 9 - WORK CLASS RECORDING SEGMENT. THERE WILL   */
 /*      BE ONE ENTRY FOR EACH SYS OR SUBSYS                         */
 /*                                                                  */
 /********************************************************************/

 DCL
   1 SMF90WCH (5) BASED(SMF90OWK(1)),       /* 5 SUBSYSTEM DEFINITION*/
     3 SMF90WKN CHAR(4),             /* SUBSYSTEM NAME               */
     3 SMF90FLA,                     /* SUBSYS FLAGS                 */
       5 SMF90DTL BIT (1),           /* DETAIL RECORDING             */
       5 SMF90RSS BIT (7),           /* RESERVED                     */
     3 SMF90RS9 CHAR(3),             /* RESERVED                     */
     3 SMF90SVL CHAR(8),             /*INTERVAL RECORD FOR SUB SYSTEM*/
     3 SMF90SYS CHAR (32),           /* BIT REPRESENTATION FOR WORK  */
                                     /* CLASS RECORDS                */
                                     /* 1 = RECORD ON, 0 = RECORD OFF*/
                                     /* BIT 0 = RECORD 0             */
                                     /* BIT 255 = RECORD 255         */
     3 SMF90EXN(15) CHAR(8);         /* EIGHT BYTE NAME OF EACH EXIT */

 /********************************************************************/
 /*                                                                  */
 /*      SWITCH SMF/HALT EOD SEGMENT - SUBTYPE 6 OR 7                */
 /*                                                                  */
 /********************************************************************/

 DCL
   1 SMF90T6 (1) BASED(SMF90DOF),    /* MAX OF 1 SWITCH SEGMENT      */
     3 SMF90SWO CHAR(10),            /* OLD RECORDING DATASET NAME   */
     3 SMF90SWN CHAR(10),            /* NEW RECORDING DATASET NAME   */
     3 SMF90IT FIXED BINARY (31),    /* IPL TIME                     */
     3 SMF90DT FIXED DECIMAL (7);    /* IPL DATE                     */
 %PAGE;
 /********************************************************************/
 /*                                                                  */
 /*      SYSTEM IPL PROMPT DATA - SUBTYPE ID 8                       */
 /*                                                                  */
 /********************************************************************/

 DCL
   1 SMF90T8 (1) BASED(SMF90DOF),  /* MAX OF 1 IPL PROMPT SEGMENT    */
     3 SMF90DTM CHAR(8),           /* SYSTEM DOWN TIME HH.MM.SS OR U */
     3 SMF90RSN CHAR(65),          /* IPL REASON OR U                */
     3 SMF90OPR CHAR(20),          /* OPERATOR'S NAME OR U           */
     3 SMF90ITM FIXED BINARY (31), /* TIME OF IPL                    */
     3 SMF90DTT FIXED DECIMAL (7); /* DATE OF IPL  YYDDDF            */

 /********************************************************************/
 /*                                                                  */
 /*        SET DATE / TOD SEGMENT - SUBTYPE ID 1 OR 2                */
 /*                                                                  */
 /********************************************************************/

 DCL
   1 SMF90T1 (1) BASED(SMF90DOF),  /* MAX OF 1 SET DATE SEGMENT      */
     3 SMF90OTM CHAR (4),          /* TIME BEFORE CMD ISSUED         */
     3 SMF90ODT FIXED DECIMAL (7), /* OLD DATE BEFORE CMD ISSUED     */
     3 SMF90NTM CHAR (4),          /* NEW TIME                       */
     3 SMF90NDT FIXED DECIMAL (7); /* DATE AFTER COMMAND ISSUED      */

 /********************************************************************/
 /*                                                                  */
 /*        SET IPS COMMAND SEGMENT - SUBTYPE ID 4                    */
 /*                                                                  */
 /********************************************************************/

 DCL
   1 SMF90T4 (1) BASED(SMF90DOF),  /* MAX OF 1 SET IPS SEGMENT       */
     3 SMF90TIP CHAR(8),           /* SET IPS TIME                   */
     3 SMF90IPO CHAR(8),           /* OLD IPS NAME                   */
     3 SMF90IPN CHAR(8);           /* NEW IPS NAME                   */
 %PAGE;
 /********************************************************************/
 /*                                                                  */
 /*         SETDMN SEGMENT - SUBTYPE ID 3                            */
 /*                                                                  */
 /********************************************************************/

 DCL
   1 SMF90T3 (1) BASED(SMF90DOF),  /* MAX OF 1 SET DOMAIN SEGMENT    */
     3 SMF90DDT CHAR(8),           /* TIME OF CHANGE                 */
     3 SMF90DMM BIT(8),            /* DOMAIN NUMBER                  */
     3 SMF90DFG,                   /* DOMAIN FLAGS                   */
       5 SMF90MND BIT(1),          /* MIN CHANGED                    */
       5 SMF90MXD BIT(1),          /* MAX CHANGED                    */
       5 SMF90WGT BIT(1),          /* WEIGHT CHANGED                 */
       5 SMF90AOB BIT(1),          /* AOBJ CHANGED                   */
       5 SMF90DOB BIT(1),          /* DOBJ CHANGED                   */
       5 SMF90FWK BIT(1),          /* FWKLD CHANGED                  */
       5 SMF90RS2 BIT(2),          /* RESERVED                       */
     3 SMF90NMI BIT(8),            /* NEW MIN VALUE                  */
     3 SMF90NMA BIT(8),            /* NEW MAX VALUE                  */
     3 SMF90NWT BIT(8),            /* NEW WEIGHT VALUE               */
     3 SMF90NAO BIT(8),            /* NEW AOBJ VALUE                 */
     3 SMF90NDO BIT(8),            /* NEW DOBJ VALUE                 */
     3 SMF90WKL BIT(8);            /* NEW FWKLD VALUE                */
 %PAGE;
 /********************************************************************/
 /*                                                                  */
 /*        IPL SRM COMMAND SEGMENT - SUBTYPE ID 10                   */
 /*                                                                  */
 /********************************************************************/

 DCL
   1 SMF90T10 (1) BASED(SMF90DOF), /* MAX OF 1 SRM PARMS AT IPL      */
     3 SMF90IPT CHAR(8),           /* TIME OF IPL                    */
     3 SMF90IPS CHAR(8),           /* IEAIPSXX PARMLIB MEMBER        */
     3 SMF90OPT CHAR(8),           /* IEAOPTXX PARMLIB MEMBER        */
     3 SMF90ICS CHAR(8);           /* IEAICSXX PARMLIB MEMBER        */

 /********************************************************************/
 /*                                                                  */
 /*        SET OPT COMMAND SEGMENT - SUBTYPE ID 11                   */
 /*                                                                  */
 /********************************************************************/

 DCL
   1 SMF90T11 (1) BASED(SMF90DOF), /* MAX OF 1 SET OPT SEGMENT       */
     3 SMF90TOP CHAR(8),           /* TIME OF OPT CHANGE             */
     3 SMF90OPO CHAR(8),           /* OLD OPT PARMLIB MEMBER         */
     3 SMF90OPN CHAR(8);           /* NEW OPT PARMLIB MEMBER         */

 /********************************************************************/
 /*                                                                  */
 /*        SETICS COMMAND SEGMENT - SUBTYPE ID 12                    */
 /*                                                                  */
 /********************************************************************/

 DCL
   1 SMF90T12 (1) BASED(SMF90DOF), /* MAX OF 1 SETICS SEGMENT        */
     3 SMF90TIC CHAR(8),           /* TIME OF 'SETICS' CHANGE        */
     3 SMF90ICO CHAR(8),           /* OLD PARMLIB MEMBER             */
     3 SMF90ICN CHAR(8);           /* NEW PARMLIB MEMBER             */

 %PAGE;

   DECLARE
       ADDR       BUILTIN,           /* ADDR BUILT-IN FUNCTION       */
       DATE       BUILTIN,           /* DATE BUILT-IN FUNCTION       */
       DIM        BUILTIN,           /* DIM BUILT-IN FUNCTION        */
       INDEX      BUILTIN,           /* INDEX BUILT-IN FUNCTION      */
       LENGTH     BUILTIN,           /* LENGTH BUILT-IN FUNCTION     */
       SUBSTR     BUILTIN,           /* SUBSTRING BUILT-IN FUNCTION  */
       TIME       BUILTIN,           /* TIME BUILT-IN FUNCTION       */
       TEMP_TIME  FIXED BINARY (31), /* TEMPORARY FIELD FOR TIME     */
       LINE_COUNT FIXED BINARY (31), /* LINE COUNTER                 */
       EOF        FIXED BINARY (31), /* END OF FILE SWITCH           */
       READ23     FIXED BINARY (31), /* READ RECORD 23 SWITCH        */
       READ90     FIXED BINARY (31), /* READ RECORD 90 SWITCH        */

       RECORD     AREA (23767),      /* THIS STRING CONTAINS THE     */
                                     /* INPUT RECORD. IT IS SET AT   */
                                     /* 32767 BYTES BECAUSE THAT IS  */
                                     /* THE MAXIMUM SIZE OF CURRENT  */
                                     /* SMF RECORDS.                 */

    1 SMFREC BASED(ADDR(RECORD)),    /* THIS STRUCTURE OVERLAYS THE  */
      2 RESERVED    CHAR (4),        /* RECORD AREA. THE FIRST FOUR  */
      2 REAL_RECORD CHAR (32763),    /* BYTES ARE TO MAKE THE OFFSETS*/
                                     /* WORK CORRECTLY               */

    /*****************************************************************/
    /*                                                               */
    /*   THE FOLLOWING STRUCTURE MAPS THE COMMON SMF RECORD HEADER   */
    /*                                                               */
    /*****************************************************************/

       01 RCDORD BASED(ADDR(REAL_RECORD)), /* SMF HEADER STRUCTURE   */
          02 FLG1       BIT (8),           /* FLAGS                  */
          02 TYPE       BIT (8),           /* RECORD TYPE            */
          02 TIME2      FIXED BINARY (31), /* TIME RECORD WRITTEN    */
          02 DATE2      FIXED DECIMAL (7), /* DATE RECORD WRITTEN    */
          02 ID         CHAR (4),          /* SYSTEM IDENTIFIER      */
          02 REST_OF_IT CHAR(32762);       /* REST OF RECORD         */
 %PAGE;
 /********************************************************************/
 /*                                                                  */
 /*  THE FOLLOWING DECLARES ARE FOR THE PROGRAM INPUT DATA SET AND   */
 /*  THE PROGRAM OUTPUT DATA SETS                                    */
 /*                                                                  */
 /********************************************************************/

    DECLARE

       SMFDATA FILE RECORD INPUT,    /* SMF INPUT DATA               */


       RPORT23 FILE STREAM OUTPUT    /* REPORT OUTPUT FOR RECORD 23  */
                    PRINT            /* THIS IS A PRINT FILE         */
                    ENVIRONMENT      /* REPORT ENVIRONMENT           */
                     (FB             /* OUTPUT IS FB FORMAT          */
                      RECSIZE(133)   /* OUTPUT RECORDS ARE 133 BYTES */
                      BLKSIZE(133)   /* RECORDS PER BLOCK = 1        */
                      CONSECUTIVE    /* DSORG IS SEQUENTIAL          */
                      ),             /* END OF DEFINITION FOR REPORT */

       RPORT90 FILE STREAM OUTPUT    /* REPORT OUTPUT FOR RECORD 90  */
                    PRINT            /* THIS IS A PRINT FILE         */
                    ENVIRONMENT      /* REPORT ENVIRONMENT           */
                     (FB             /* OUTPUT IS FB FORMAT          */
                      RECSIZE(133)   /* OUTPUT RECORDS ARE 133 BYTES */
                      BLKSIZE(133)   /* RECORDS PER BLOCK = 1        */
                      CONSECUTIVE    /* DSORG IS SEQUENTIAL          */
                      );             /* END OF DEFINITION FOR REPORT */
 %PAGE;

 /********************************************************************/
 /*                                                                  */
 /*  THE FOLLOWING DECLARES ARE FOR ACCUMULATORS FOR THE SMF         */
 /*  STATUS (TYPE 23 RECORDS) REPORT                                */
 /*                                                                  */
 /********************************************************************/

   DECLARE

      R23_BUFFERS_WRITTEN_SAVE       FIXED BINARY (31),
      R23_RECORDS_WRITTEN_SAVE       FIXED BINARY (31),
      R23_USERS_SUSPEND_SAVE         FIXED BINARY (31),
      R23_MAX_FULL_BUFFERS_SAVE      PIC'Z9',
      R23_SECONDS_IN_INTERVAL_SAVE   FIXED BINARY (31),
      R23_MINUTES_IN_INTERVAL_SAVE   FIXED BINARY (31),
      LINE_COUNT23                   FIXED BINARY (31) INIT (56),
      LINE_COUNT90                   FIXED BINARY (31) INIT (56);

 %PAGE;
    /*****************************************************************/
    /*                                                               */
    /*  THE FOLLOWING DATA DECLARATIONS PERTAIN TO THE PRINTING OF   */
    /*  THE COMMON REPORT HEADERS (IE  TIME AND DATE). OTHER HEADERS */
    /*  FOR THE INDIVIDUAL REPORTS ARE DECLARED IN THEIR SUBROUTINES */
    /*                                                               */
    /*****************************************************************/

    DECLARE

       01 REPORT_HEADER,
          02 HDR1          CHAR (20)  INIT ((20)' '),
          02 HDR2          CHAR (6)   INIT('TIME  '),
          02 REPORT_TIME   CHAR (11),
          02 HDR3          CHAR (61)  INIT ((61)' '),
          02 HDR4          CHAR (6)   INIT ('DATE  '),
          02 REPORT_DATE   CHAR (8),
          02 HDR5          CHAR (20)  INIT ((20)' '),

 /********************************************************************/
 /*                                                                  */
 /*     THESE STRUCTURE IS THE FIRST HEADER LINE FOR THE             */
 /*     FORMATTED SMF STATUS (TYPE 23) RECORDS                       */
 /*                                                                  */
 /********************************************************************/

       01 R23HDR1,
          02 HDR2 CHAR (50) INIT ((50)' '),
          02 HDR3 CHAR (32) INIT ('      SMF ACTIVITY REPORT       '),
          02 HDR4 CHAR (37) INIT ((37)' '),
          02 HDR5 CHAR (6)  INIT ('PAGE  '),
          02 PAGE_NUMBER23  PIC'ZZZ,ZZ9',


 /********************************************************************/
 /*                                                                  */
 /*     THESE STRUCTURE IS THE FIRST HEADER LINE FOR THE             */
 /*     FORMATTED SMF OPERATOR TRACKING (TYPE 90) RECORDS            */
 /*                                                                  */
 /********************************************************************/

       01 R90HDR1,
          02 HDR2 CHAR (50) INIT ((50)' '),
          02 HDR3 CHAR (32) INIT ('    OPERATOR TRACKING REPORT    '),
          02 HDR4 CHAR (37) INIT ((37)' '),
          02 HDR5 CHAR (6)  INIT ('PAGE  '),
          02 PAGE_NUMBER90  PIC'ZZZ,ZZ9';

 %PAGE;
 /********************************************************************/
 /*                                                                  */
 /*     THIS DATA LINE IS PRINTED IF NO TYPE 23 (SMF STATUS)         */
 /*     RECORDS WERE READ.                                           */
 /*                                                                  */
 /********************************************************************/

  DECLARE

     01 NO_TYPE23_READ,
        02 HDR2 CHAR (40) INIT ((40)' '),
        02 HDR3 CHAR (36) INIT ('NO SMF STATUS (TYPE 23) RECORDS READ'),
        02 HDR4 CHAR (56) INIT ((56)' '),

 /********************************************************************/
 /*                                                                  */
 /*     THIS DATA LINE IS PRINTED IF NO TYPE 90 (OPERATOR            */
 /*     TRACKING) RECORDS WERE READ.                                 */
 /*                                                                  */
 /********************************************************************/

     01 NO_TYPE90_READ,
        02 HDR2 CHAR (40) INIT ((40)' '),
        02 HDR3 CHAR (43) INIT (
             'NO OPERATOR TRACKING (TYPE 90) RECORDS READ'),
        02 HDR4 CHAR (49) INIT ((49)' ');
 %PAGE;

 /********************************************************************/
 /*                                                                  */
 /*        ACTIVE ON UNITS                                           */
 /*                                                                  */
 /********************************************************************/

    ON ENDFILE (SMFDATA) EOF = 1; /* SET END OF FILE SWITCH FOR LOOP */


 /********************************************************************/
 /*                                                                  */
 /*     A 'TRANSMIT' ON UNIT IS NEEDED BECAUSE CERTAIN LEVELS OF     */
 /*     OF THE PL/I COMPILER CAN'T HANDLE VBS RECORDS. THE 'ON'      */
 /*     UNIT IS A NO-OP. THE DATA IN THE RECORDS WHEN A TRANSMIT     */
 /*     ERROR OCCURS CAN STILL BE VALIDLY USED.                      */
 /*                                                                  */
 /********************************************************************/

    ON TRANSMIT (SMFDATA);
 %PAGE;
 /********************************************************************/
 /*                                                                  */
 /*        TOP SEGMENT                                               */
 /*                                                                  */
 /********************************************************************/

    CALL INIT;                          /* INITIALIZATION SUBROUTINE */
    READ FILE (SMFDATA) INTO(REAL_RECORD); /* READ SMF INPUT DATA    */
    DO WHILE (EOF = 0);                 /* READ ENTIRE FILE          */
      IF TYPE = 23 THEN                 /* TYPE 23 RECORD - SMF STATUS*/
        CALL SMF23;                     /* CALL RECORD 23 SUBROUTINE */
      ELSE;
      IF TYPE = 90 THEN                 /* TYPE 90 RECORD - OPERATOR */
        CALL SMF90;                     /* CALL RECORD 90 SUBROUTINE */
      ELSE;
      READ FILE (SMFDATA) INTO(REAL_RECORD); /* CONTINUE READING     */
    END;                                /* END FOR WHILE (EOF = 0)   */


  IF READ23 = 0 THEN                    /* IF WE READ NO TYPE 23 RECS*/
    PUT FILE (RPORT23)                  /* PUT OUT MESSAGE           */
          EDIT (NO_TYPE23_READ)
          (A)
          PAGE;
  ELSE
    CALL SMF23;                         /* RECORD 23 TOTALS          */

  IF READ90 = 0 THEN                    /* IF WE READ NO TYPE 90 RECS*/
    PUT FILE (RPORT90) /* PUT OUT MESSAGE           */
          EDIT (NO_TYPE90_READ)
          (A)
          PAGE;
  ELSE;
  CLOSE FILE (SMFDATA);                 /* CLOSE INPUT FILE         */
  CLOSE FILE (RPORT23);                 /* CLOSE REPORT 23 FILE     */
  CLOSE FILE (RPORT90);                 /* CLOSE REPORT 90 FILE     */
  %PAGE;
  INIT : PROC;

 /********************************************************************/
 /*                                                                  */
 /*        INITIALIZATION SUBROUTINE                                 */
 /*                                                                  */
 /********************************************************************/

    DECLARE
      TEMP_TIME_PIC PIC'99';            /* TEMPORARY VARIABLE        */
    OPEN FILE (SMFDATA);                /* OPEN SMF INPUT DATA SET   */
    OPEN FILE (RPORT23);                /* OPEN REPORT OUTPUT FILE   */
    OPEN FILE (RPORT90);                /* OPEN REPORT OUTPUT FILE   */
    EOF                          = 0;   /* INIT EOF SWITCH TO OFF    */
    READ23                       = 0;   /* INIT NUMBER OF 23 RECORDS */
    READ90                       = 0;   /* INIT NUMBER OF 90 RECORDS */
    R23_BUFFERS_WRITTEN_SAVE     = 0;   /* INIT                      */
    R23_RECORDS_WRITTEN_SAVE     = 0;   /*   SAVE                    */
    R23_USERS_SUSPEND_SAVE       = 0;   /*     AREAS                 */
    R23_MAX_FULL_BUFFERS_SAVE    = 0;   /*       FOR                 */
    R23_SECONDS_IN_INTERVAL_SAVE = 0;   /*         TYPE 23           */
    R23_MINUTES_IN_INTERVAL_SAVE = 0;   /*           RECORDS         */
    PAGE_NUMBER23                = 0;   /* PAGE NUMBER FOR REPORT 23 */
    PAGE_NUMBER90                = 0;   /* PAGE NUMBER FOR REPORT 90 */
    REPORT_DATE =                       /* GET DATE FROM SYSTEM      */
     SUBSTR(DATE,3,2)'/'SUBSTR(DATE,5,2)'/'SUBSTR(DATE,1,2);
    REPORT_TIME =                       /* GET TIME FROM SYSTEM      */
     SUBSTR(TIME,1,2)':'SUBSTR(TIME,3,2)':'SUBSTR(TIME,5,2)
      ' AM';
    IF SUBSTR(REPORT_TIME,1,2) = 12 THEN /* IT IS NOON               */
      SUBSTR(REPORT_TIME,10,1)='P';      /* SHOW PM                  */
    IF SUBSTR(REPORT_TIME,1,2) > 12 THEN /* IF PAST ONE PM           */
      DO;
        TEMP_TIME = SUBSTR(REPORT_TIME,1,2) ;
        TEMP_TIME = TEMP_TIME - 12 ;
        TEMP_TIME_PIC = TEMP_TIME ;
        SUBSTR(REPORT_TIME,1,2) = TEMP_TIME_PIC ;
        SUBSTR(REPORT_TIME,10,1)='P';
      END;
    IF SUBSTR(REPORT_TIME,1,1) = 0 THEN
      SUBSTR(REPORT_TIME,1,1) = ' ' ;
  END INIT;
  %PAGE;
  CONVDATE: PROC (INDATE,OUTDATE) ;

 /********************************************************************/
 /*                                                                  */
 /*        CONVERT RECORD WRITTEN DATE SUBROUTINE                    */
 /*                                                                  */
 /********************************************************************/

     DECLARE
        INDATE FIXED DECIMAL (7),         /* INPUT DATE TO CONVERT   */
        OUTDATE CHAR (8),                 /* OUTPUT DATE FROM CONVERT*/
        TEMPPIC PIC'ZZZ99999',            /* TEMPORARY VARIABLE      */
        DAYS (12) FIXED BINARY (31) INIT( /* DAYS IN THE MONTHS      */
             31,                          /* JANUARY                 */
             28,                          /* FEBRUARY                */
             31,                          /* MARCH                   */
             30,                          /* APRIL                   */
             31,                          /* MAY                     */
             30,                          /* JUNE                    */
             31,                          /* JULY                    */
             31,                          /* AUGUST                  */
             30,                          /* SEPTEMBER               */
             31,                          /* OCTOBER                 */
             30,                          /* NOVEMBER                */
             31),                         /* DECEMBER                */
        TOTDAY FIXED BINARY (31),         /* CALCULATE MONTH & DAY   */
        INDAY FIXED BINARY (31),          /* BINARY DAY OF YEAR      */
        INYEAR FIXED BINARY (31),         /* BINARY YEAR             */
        IN    FIXED BINARY (31),          /* LOOP INDEX              */
        TEMP_INYEAR FIXED BINARY (31),    /* TO CHECK LEAP YEAR      */
        LEAPDAY FIXED BINARY (31) INIT(1),/* EXTRA DAY IN LEAP YEAR  */
        MONFEB FIXED BINARY (31) INIT(2), /* MONTH NUMBER OF FEBRUARY*/
        YEARLEAP FIXED BINARY (31) INIT(4);/* YEARS IN LEAP YEAR CYCL*/
 %PAGE;
     TEMPPIC = INDATE ;
     SUBSTR(OUTDATE,6,1) = '/';
     SUBSTR(OUTDATE,7,2) = SUBSTR(TEMPPIC,4,2);
     INDAY =  SUBSTR(TEMPPIC,6,3);         /* GET DAYS IN BINARY     */
     INYEAR = SUBSTR(OUTDATE,7,2);         /* GET YEARS IN BINARY    */
     TOTDAY = 0;                           /* INITIALIZE FOR LOOP    */
     TEMP_INYEAR = INYEAR / 4;             /* FIND OUT IF LEAP YEAR  */
     TEMP_INYEAR = TEMP_INYEAR * 4;        /* TO SEE IF REMAINDER    */
     INYEAR = INYEAR - TEMP_INYEAR;        /* IF ZERO THEN LEAP YEAR */
     DO IN = 1 TO 12  WHILE (TOTDAY<INDAY);/*                        */
       IF IN = MONFEB & INYEAR = 0 THEN   /* IF FEBRUARY IN LEAP YEAR*/
         TOTDAY = TOTDAY + LEAPDAY;        /* INCREMENT DAY COUNT    */
       TOTDAY = TOTDAY + DAYS(IN);         /* INCREMENT DAYS THIS MON*/
     END;
     INDAY = DAYS(IN-1) - (TOTDAY - INDAY);/* DAY OF MONTH           */
     TEMPPIC = IN - 1;                     /* MONTH IS INDEX - ONE   */
     SUBSTR(OUTDATE,1,2) = SUBSTR(TEMPPIC,7,2);/* CONVERT MONTH      */
     SUBSTR(OUTDATE,3,1) = '/';
     IF IN - 1 = MONFEB &                  /* FEBRUARY               */
        INYEAR = 0 THEN                    /* LEAP YEAR              */
          INDAY = INDAY + LEAPDAY;         /* ADD ONE DAY            */
     TEMPPIC = INDAY;                      /* CONVERT DAY OF MONTH   */
     SUBSTR(OUTDATE,4,2) = SUBSTR(TEMPPIC,7,2);/* CONVERT DAY        */
     SUBSTR(OUTDATE,6,1) = '/';
  END CONVDATE;
  %PAGE;
  CONVTIME: PROC (INTIME,OUTTIME);

 /********************************************************************/
 /*                                                                  */
 /*        CONVERT RECORD WRITTEN TIME SUBROUTINE                    */
 /*                                                                  */
 /********************************************************************/

     DECLARE
        INTIME FIXED BINARY (31),
        OUTTIME CHAR (11),
        SECONDS_PER_HOUR   FIXED BINARY (31) INIT(360000),
        SECONDS_PER_MINUTE FIXED BINARY (31) INIT(6000),
        TEMP_HOURS         FIXED BINARY (31),
        TEMP_MINUTES       FIXED BINARY (31),
        TEMP_SECONDS       FIXED BINARY (31),
        TEMP_HUNDREDT      FIXED BINARY (31),
        TEMP_TWOCHAR       PIC'99';
     TEMP_HOURS = INTIME / SECONDS_PER_HOUR;
     TEMP_TWOCHAR = TEMP_HOURS;
     SUBSTR(OUTTIME,1,2) = TEMP_TWOCHAR;
     SUBSTR(OUTTIME,3,1) = ':';
     TEMP_MINUTES = (INTIME - (TEMP_HOURS * SECONDS_PER_HOUR)) /
                              SECONDS_PER_MINUTE  ;
     TEMP_TWOCHAR = TEMP_MINUTES;
     SUBSTR(OUTTIME,4,2) = TEMP_TWOCHAR;
     TEMP_SECONDS = (INTIME - ((TEMP_HOURS * SECONDS_PER_HOUR) +
                             (TEMP_MINUTES * SECONDS_PER_MINUTE)))/100;
     TEMP_TWOCHAR  = TEMP_SECONDS ;
     SUBSTR(OUTTIME,6,1) = ':';
     SUBSTR(OUTTIME,7,2) = TEMP_TWOCHAR ;
     SUBSTR(OUTTIME,9,1) = '.';
     TEMP_HUNDREDT = (INTIME - ((TEMP_HOURS * SECONDS_PER_HOUR) +
                               (TEMP_MINUTES * SECONDS_PER_MINUTE) +
                               (TEMP_SECONDS * 100 ))) ;
     TEMP_TWOCHAR = TEMP_HUNDREDT ;
     SUBSTR(OUTTIME,10,2) = TEMP_TWOCHAR ;
  END CONVTIME;
  %PAGE;
  SMF23 : PROC;                   /* FORMAT THE TYPE 23 RECORD */

 /********************************************************************/
 /*                                                                  */
 /*  THIS SUBROUTINE PRINTS A LINE OF DATA BY FORMATTING AN SMF      */
 /*  STATUS (TYPE 23) RECORD.  TOTALS ARE ACCUMULATED AND A CALL     */
 /*  TO THIS SUBROUTINE AFTER END OF FILE IS RAISED RESULTS IN       */
 /*  AN 'AVERAGES' LINE OF DATA TO BE PRINTED.                       */
 /*                                                                  */
 /********************************************************************/
 %PAGE;
 /********************************************************************/
 /*                                                                  */
 /*     THIS STRUCTURE MAPS THE OUTPUT OF THE FORMATTED SMF          */
 /*     STATUS (TYPE 23) RECORD                                      */
 /*                                                                  */
 /********************************************************************/

    DECLARE
       01 R23,
          02 R231 CHAR (1) INIT((1)' '),
          02 R23_SYSTEM_ID CHAR (4),
          02 R2311 CHAR(2) INIT((2)' '),
          02 R23_TIME CHAR (11),
          02 R2312 CHAR(2) INIT((2)' '),
          02 R23_DATE CHAR (8),
          02 R2313 CHAR (3) INIT((3)' '),
          02 R23_RECORD_VERSION CHAR(2) INIT('  '),
          02 R232 CHAR (1) INIT ((1)' '),
          02 R23_PRODUCT_NAME CHAR (8) INIT((8)' '),
          02 R233 CHAR (3) INIT ((3)' '),
          02 R23_INTERVAL,
             03 R23_INTERVAL_HOURS CHAR(2),
             03 R23_INTERVAL_SPACE1 CHAR(1) INIT(':'),
             03 R23_INTERVAL_MINUTES CHAR(2),
             03 R23_INTERVAL_SPACE2 CHAR(1) INIT(':'),
             03 R23_INTERVAL_SECONDS CHAR(2),
          02 R234 CHAR (6) INIT((6)' '),
          02 R23_SYSTEM_RELEASE CHAR (4) INIT((4)' '),
          02 R235 CHAR (1) INIT(' '),
          02 R23_BUFFERS_WRITTEN PIC'ZZZ,Z99',
          02 R238 CHAR (2)    INIT('  '),
          02 R23_RECORDS_WRITTEN PIC'ZZ,ZZZ,Z99',
          02 R239 CHAR (4)    INIT((4)' '),
          02 R23_BUFFERS_PER_MINUTE CHAR (9) INIT((9)' '),
          02 R23A CHAR (4)    INIT((4)' '),
          02 R23_RECORDS_PER_SECOND CHAR (9) INIT((9)' '),
          02 R236 CHAR (8)    INIT((8)' '),
          02 R23_MAX_FULL_BUFFERS PIC'Z9',
          02 R237 CHAR (7) INIT((7)' '),
          02 R23_USERS_SUSPEND PIC'Z,Z99',
          02 R23B CHAR (1)   INIT((1)' ');
 %PAGE;
 /********************************************************************/
 /*                                                                  */
 /*     THESE STRUCTURES ARE THE HEADERS FOR THE FORMATTED SMF       */
 /*     STATUS (TYPE 23) RECORDS                                     */
 /*                                                                  */
 /********************************************************************/

   DECLARE

       R23HDR2 CHAR (132) INIT(
 'SYSTEM TIME RECORD  DATE REC  REC  PRODUCT  REPORTING  RELEASE  BUFFER
 S     RECORDS      BUFFERS      RECORDS  MAX FULL     # USERS '),



       R23HDR3 CHAR (132) INIT(
 '  ID       WRITTEN   WRITTEN  VER     NAME   INTERVAL   NUMBER  WRITTE
 N     WRITTEN      PER MIN      PER SEC   BUFFERS   SUSPENDED '),



       BLANK132 CHAR (132) INIT((132)' ');

   DECLARE

        TEMPPIC PIC'ZZ,ZZ999',
        SECONDS_IN_INTERVAL FIXED BINARY (31),
        MINUTES_IN_INTERVAL FIXED BINARY (31);

 %PAGE;
     IF EOF = 1 THEN               /* CALLED AT END OF FILE          */
       DO;
         CALL SMF23_FINAL;         /* CALL TOTAL ROUTINE             */
         RETURN;                   /* RETURN                         */
       END;


     IF LINE_COUNT23 > 55 THEN     /*   IF END OF PAGE OR FIRST PAGE */
       DO;
         READ23 = 1;               /* SHOW WE READ TYPE 23 RECORDS   */
         PAGE_NUMBER23 = PAGE_NUMBER23 + 1;/* INCREMENT PAGE NUMBER  */
         PUT FILE (RPORT23)        /* PUT TO THE REPORT23 DATA SET   */
               EDIT (R23HDR1)      /* FIRST HEADER LINE              */
               (A)                 /* OUTPUT IS CHARACTER            */
               PAGE;               /* SKIP TO NEW PAGE               */
         PUT FILE (RPORT23)        /* PUT TO THE REPORT23 DATA SET   */
               EDIT (REPORT_HEADER)/* SECOND HEADER LINE             */
               (A)                 /* OUTPUT IS CHARACTER            */
               SKIP (2);           /* SKIP TWO LINES BEFORE          */
         PUT FILE (RPORT23)        /* PUT TO THE REPORT23 DATA SET   */
               EDIT (R23HDR2)      /* THIRD HEADER LINE              */
               (A)                 /* OUTPUT IS CHARACTER            */
               SKIP (2);           /* SKIP TWO LINES BEFORE          */
         PUT FILE (RPORT23)        /* PUT TO THE REPORT23 DATA SET   */
               EDIT (R23HDR3)      /* FOURTH HEADER LINE             */
               (A)                 /* OUTPUT IS CHARACTER            */
               SKIP (1);           /* SKIP ONE BEFORE PUT            */
         PUT FILE (RPORT23)        /* PUT TO THE REPORT23 DATA SET   */
               EDIT (BLANK132)     /* BLANK LINE                     */
               (A)                 /* OUTPUT IS CHARACTER            */
               SKIP (1);           /* SKIP ONE BEFORE PUT            */
         LINE_COUNT23 = 8;         /* NEXT LINE IS 8                 */
       END;
 %PAGE;
     CALL CONVTIME (TIME2,R23_TIME); /* CALL CONVERT TIME SUBROUTINE */
     CALL CONVDATE (DATE2,R23_DATE); /* CALL CONVERT DATE SUBROUTINE */
     R23_SYSTEM_ID = ID;             /* SYSTEM IDENTIFICATION        */
     R23_RECORD_VERSION = SMF23RVN(1); /* RECORD VERSION NUMBER      */
     R23_PRODUCT_NAME = SMF23PNM(1);   /* PRODUCT NAME               */
     R23_INTERVAL_HOURS = SUBSTR(SMF23INT(1),1,2);/*HOURS IN INTERVAL*/
     R23_INTERVAL_MINUTES = SUBSTR(SMF23INT(1),3,2);/*MINS IN INTRVAL*/
     R23_INTERVAL_SECONDS = SUBSTR(SMF23INT(1),5,2);/*SECS IN INTRVAL*/
     R23_SYSTEM_RELEASE = SMF23RLS(1); /* SYSTEM RELEASE NUMBER      */
     R23_BUFFERS_WRITTEN = SMF23BFW(1);/* BUFFERS WRITTEN            */
     R23_BUFFERS_WRITTEN_SAVE = R23_BUFFERS_WRITTEN_SAVE + SMF23BFW(1);
     R23_RECORDS_WRITTEN = SMF23RCW(1);/* RECORDS WRITTEN            */
     R23_RECORDS_WRITTEN_SAVE = R23_RECORDS_WRITTEN_SAVE + SMF23RCW(1);
     R23_MAX_FULL_BUFFERS = SMF23BFQ(1);/*MAXIMUM FULL BUFFERS       */
     IF R23_MAX_FULL_BUFFERS > R23_MAX_FULL_BUFFERS_SAVE THEN
       R23_MAX_FULL_BUFFERS_SAVE = SMF23BFQ(1);
     R23_USERS_SUSPEND = SMF23SUS(1);  /* NUMBER OF USERS SUSPENDED  */
     R23_USERS_SUSPEND_SAVE = R23_USERS_SUSPEND_SAVE + SMF23SUS(1);
     SECONDS_IN_INTERVAL =         /* CALCULATE SECONDS IN INTERVAL  */
         ((R23_INTERVAL_HOURS * 3600) + /* 3600 SECONDS PER HOUR     */
         (R23_INTERVAL_MINUTES * 60) + /* 60 SECONDS PER MINUTE      */
         (R23_INTERVAL_SECONDS));      /* PLUS SECONDS               */
     R23_SECONDS_IN_INTERVAL_SAVE =
              R23_SECONDS_IN_INTERVAL_SAVE + SECONDS_IN_INTERVAL;
     MINUTES_IN_INTERVAL =         /* CALCULATE MINUTES IN INTERVAL  */
         ((R23_INTERVAL_HOURS * 60) + /* 60 MINUTES PER HOUR         */
         (R23_INTERVAL_MINUTES));     /* PLUS MINUTES                */
     R23_MINUTES_IN_INTERVAL_SAVE =
              R23_MINUTES_IN_INTERVAL_SAVE + MINUTES_IN_INTERVAL;
     TEMPPIC = (SMF23BFW(1) * 100) / MINUTES_IN_INTERVAL ;
     R23_BUFFERS_PER_MINUTE =
                 SUBSTR(TEMPPIC,1,6)'.'SUBSTR(TEMPPIC,7,2);
     TEMPPIC = (SMF23RCW(1) * 100) / SECONDS_IN_INTERVAL ;
     R23_RECORDS_PER_SECOND =
                 SUBSTR(TEMPPIC,1,6)'.'SUBSTR(TEMPPIC,7,2);
     PUT FILE (RPORT23)
           EDIT(R23)
           (A)
           SKIP(1);
     LINE_COUNT23 = LINE_COUNT23 + 1;  /* INCREMENT LINE COUNTER     */
  %PAGE;
     SMF23_FINAL : PROC;

        DECLARE

           01 R23_FINAL,
              02 R23_FINAL1                    CHAR (31) INIT(
                                    '   TOTAL / AVERAGE / MAXIMUM   '),
              02 R23_FINAL2                    CHAR (33) INIT((33)' '),
              02 R23_FINAL_BUFFERS_WRITTEN            PIC'ZZZ,Z99',
              02 R23_FINAL3                    CHAR  (2) INIT('  '),
              02 R23_FINAL_RECORDS_WRITTEN            PIC'ZZ,ZZZ,Z99',
              02 R23_FINAL4                    CHAR  (4) INIT((4)' '),
              02 R23_FINAL_BUFFERS_PER_MINUTE  CHAR  (9) INIT((9)' '),
              02 R23_FINAL5                    CHAR  (4) INIT((4)' '),
              02 R23_FINAL_RECORDS_PER_SECOND  CHAR  (9) INIT((9)' '),
              02 R23_FINAL6                    CHAR  (8) INIT((8)' '),
              02 R23_FINAL_MAX_FULL_BUFFERS           PIC'Z9',
              02 R23_FINAL7                    CHAR  (7) INIT((7)' '),
              02 R23_FINAL_USERS_SUSPEND              PIC'Z,Z99',
              02 R23_FINAL8                    CHAR  (1) INIT((1)' ');


         IF R23_RECORDS_WRITTEN_SAVE ^= 0 THEN /* IF ANY DATA GATHERED*/
           DO;
             R23_FINAL_BUFFERS_WRITTEN   = R23_BUFFERS_WRITTEN_SAVE;
             R23_FINAL_RECORDS_WRITTEN   = R23_RECORDS_WRITTEN_SAVE;
             R23_FINAL_MAX_FULL_BUFFERS  = R23_MAX_FULL_BUFFERS_SAVE;
             R23_FINAL_USERS_SUSPEND     = R23_USERS_SUSPEND_SAVE;
             TEMPPIC = (R23_BUFFERS_WRITTEN_SAVE * 100) /
                              R23_MINUTES_IN_INTERVAL_SAVE;
             R23_FINAL_BUFFERS_PER_MINUTE =
                   SUBSTR(TEMPPIC,1,6)'.'SUBSTR(TEMPPIC,7,2);
             TEMPPIC = (R23_RECORDS_WRITTEN_SAVE * 100) /
                              R23_SECONDS_IN_INTERVAL_SAVE;
             R23_FINAL_RECORDS_PER_SECOND =
                   SUBSTR(TEMPPIC,1,6)'.'SUBSTR(TEMPPIC,7,2);
             PUT FILE (RPORT23)
                   EDIT(R23_FINAL)
                   (A)
                   SKIP(2);
           END;
       END SMF23_FINAL;
  END SMF23;
  %PAGE;
  SMF90 : PROC;                    /* FORMAT THE TYPE 90 RECORD      */

 /********************************************************************/
 /*                                                                  */
 /*  PROCESS OPERATOR TRACKING SMF RECORDS                           */
 /*                                                                  */
 /********************************************************************/

 /********************************************************************/
 /*                                                                  */
 /*     THIS STRUCTURE MAPS THE OUTPUT OF THE FORMATTED SMF          */
 /*     OPERATOR TRACKING (TYPE90) RECORD                            */
 /*                                                                  */
 /********************************************************************/

    DECLARE
       01 R90,
          02 R901              CHAR  (1) INIT((1)' '),
          02 R90_SYSTEM_ID     CHAR  (4),
          02 R9011             CHAR  (2) INIT((2)' '),
          02 R90_TIME          CHAR (11),
          02 R9012             CHAR  (2) INIT((2)' '),
          02 R90_DATE          CHAR  (8),
          02 R9013             CHAR  (3) INIT((3)' '),
          02 R90_RECORD_VERSION CHAR (2) INIT('  '),
          02 R902              CHAR  (1) INIT ((1)' '),
          02 R90_PRODUCT_NAME  CHAR  (8) INIT((8)' '),
          02 R903              CHAR (90) INIT ((90)' ');


 /********************************************************************/
 /*                                                                  */
 /*     THESE STRUCTURES ARE THE HEADERS FOR THE FORMATTED SMF       */
 /*     OPERATOR TRACKING (TYPE 90) RECORDS                          */
 /*                                                                  */
 /********************************************************************/

   DECLARE
       R90HDR2 CHAR (132)                INIT(
 'SYSTEM TIME RECORD  DATE REC  REC  PRODUCT
                                                             '),
       R90HDR3 CHAR (132)                INIT(
 '  ID       WRITTEN   WRITTEN  VER     NAME
                                                             ');

   DECLARE
        TEMPPIC                          PIC'ZZ,ZZZZ9',
        SECONDS_IN_INTERVAL    FIXED BINARY (31),
        MINUTES_IN_INTERVAL    FIXED BINARY (31);
 %PAGE;


     READ90 = 1;                   /* SHOW WE READ TYPE 90 RECORDS   */
     PAGE_NUMBER90 = PAGE_NUMBER90 + 1;/* INCREMENT PAGE NUMBER      */
     PUT FILE (RPORT90)            /* PUT TO THE REPORT90 DATA SET   */
           EDIT (R90HDR1)          /* FIRST HEADER LINE              */
           (A)                     /* OUTPUT IS CHARACTER            */
           PAGE;                   /* SKIP TO NEW PAGE               */
     PUT FILE (RPORT90)            /* PUT TO THE REPORT90 DATA SET   */
           EDIT (REPORT_HEADER)    /* SECOND HEADER LINE             */
           (A)                     /* OUTPUT IS CHARACTER            */
           SKIP (2);               /* SKIP TWO LINES BEFORE          */
     PUT FILE (RPORT90)            /* PUT TO THE REPORT90 DATA SET   */
           EDIT (R90HDR2)          /* THIRD HEADER LINE              */
           (A)                     /* OUTPUT IS CHARACTER            */
           SKIP (2);               /* SKIP TWO LINES BEFORE          */
     PUT FILE (RPORT90)            /* PUT TO THE REPORT90 DATA SET   */
           EDIT (R90HDR3)          /* FOURTH HEADER LINE             */
           (A)                     /* OUTPUT IS CHARACTER            */
           SKIP (1);               /* SKIP ONE BEFORE PUT            */
     LINE_COUNT90 = 7;             /* NEXT LINE IS 7                 */
     CALL CONVTIME (TIME2,R90_TIME); /* CALL CONVERT TIME SUBROUTINE */
     CALL CONVDATE (DATE2,R90_DATE); /* CALL CONVERT DATE SUBROUTINE */
     R90_SYSTEM_ID = ID;           /* SYSTEM IDENTIFICATION          */
     R90_RECORD_VERSION = SMF90RVN(1);/* RECORD VERSION NUMBER       */
     R90_PRODUCT_NAME = SMF90PNM(1);/* PRODUCT NAME                  */
     PUT FILE (RPORT90)
           EDIT(R90)
           (A)
           SKIP(1);
     LINE_COUNT90 = LINE_COUNT90 + 1;/* INCREMENT LINE COUNTER      */
     IF (SMF90TID(1) = 5)  (SMF90TID(1) = 9) THEN /*SMF SET OR IPL */
       CALL SMF90S5;               /* FORMAT RECORD 90 SUBTYPE 5 & 9*/
     IF (SMF90TID(1) = 6)  (SMF90TID(1) = 7) THEN /* HALT OR SWITCH*/
       CALL SMF90S6;               /* FORMAT RECORD 90 SUBTYPE 6 & 7*/
     IF (SMF90TID(1) = 8) THEN     /* SMF IPL/PROMPT DATA           */
       CALL SMF90S8;               /* FORMAT RECORD 90 SUBTYPE 8    */
     IF (SMF90TID(1) = 1)  (SMF90TID(1) = 2) THEN /* SET TIME/DATE */
       CALL SMF90S1;               /* FORMAT RECORD 90 SUBTYPE 1 & 2*/
     IF (SMF90TID(1) = 4)  (SMF90TID(1) = 10)     /* SRM SECTIONS */
        (SMF90TID(1) = 11)  (SMF90TID(1) = 12) THEN
       CALL SMF90S4;               /* FORMAT SUBTYPES 4,10,11,12    */
     IF (SMF90TID(1) = 3) THEN     /* SET DOMAIN SUBTYPE            */
       CALL SMF90S3;               /* FORMAT RECORD 90 SUBTYPE 3    */

  END SMF90;
  %PAGE;
  SMF90S5 : PROC;                    /* FORMAT THE SUBTYPE 5 & 9 REC*/

 /********************************************************************/
 /*                                                                  */
 /* PROCESS THE SMF OPTIONS AT IPL TIME OR SET TIME                  */
 /*                                                                  */
 /********************************************************************/

   DECLARE
        01 R90_SUB5_HDR1,
           02 SPACE1           CHAR  (7) INIT('  ***  '),
           02 SPACE2           CHAR (15) INIT('SMF OPTIONS AT '),
           02 R90_SUB5_TYPE    CHAR  (3),
           02 SPACE3           CHAR(107) INIT((107)' '),

        R90_SUB5_HDR2          CHAR(132) INIT(
 '       MAXDORM   STATUS   JOB WAIT TIME   SYSTEM   MIN   MAX   REL
                                                             '),

        R90_SUB5_HDR3          CHAR(132) INIT(
 '         MM:SS HH:MM:SS           HH:MM     ID    BUFS  BUFS   NUM
   IPL TIME   IPL DATE                                       '),

        R90_SUB5_HDR4          CHAR(132) INIT(
 '       RECORDING OPTIONS BY SUBSYSTEM
                                                             '),

        R90_SUB5_HDR5          CHAR(132) INIT(
 '                SYS NAME  DETAIL RECORDING
                                                             '),

        R90_SUB5_HDR6          CHAR(132) INIT(
 '                ACTIVE SMF EXITS FOR THIS SUBSYSTEM
                                                             '),

        R90_SUB5_HDR7          CHAR(132) INIT(
 '                RECORDS COLLECTED FOR THIS SUBSYSTEM  (BITS REPRESENT
 COLLECTABLE RECORDS)                                        '),

        R90_SUB5_HDR8          CHAR(132) INIT(
 '       ACTIVE SMF RECORDING DATA SETS
                                                             '),

        R90_SUB5_HDR9          CHAR(132) INIT(
 '                NO ACTIVE EXITS FOR THIS SUBSYSTEM
                                                             ');

 %PAGE;
     DECLARE

        01 R90_SUB5_LINE1,
           02 SPACE0           CHAR  (9) INIT((9)' '),
           02 R90_MAXDORM,
              03 R90_MAXDORMM  CHAR  (2),
              03 R90_MAXDSP2   CHAR  (1) INIT(':'),
              03 R90_MAXDORMS  CHAR  (2),
           02 SPACE1           CHAR  (1) INIT(' '),
           02 R90_STATUS,
              03 R90_STATUSH   CHAR  (2),
              03 R90_STATSP1   CHAR  (1) INIT(':'),
              03 R90_STATUSM   CHAR  (2),
              03 R90_STATSP2   CHAR  (1) INIT(':'),
              03 R90_STATUSS   CHAR  (2),
           02 SPACE2           CHAR (11) INIT((11)' '),
           02 R90_JWT,
              03 R90_JWTH      CHAR  (2),
              03 R90_JWTSP1    CHAR  (1) INIT(':'),
              03 R90_JWTM      CHAR  (2),
           02 SPACE3           CHAR  (4) INIT((4)' '),
           02 R90_SYSID        CHAR  (4),
           02 SPACE4           CHAR  (4) INIT((4)' '),
           02 R90_MINBUF                 PIC'ZZ9',
           02 SPACE5           CHAR  (3) INIT((3)' '),
           02 R90_MAXBUF                 PIC'ZZ9',
           02 SPACE6           CHAR  (2) INIT((2)' '),
           02 R90_RELEASE      CHAR  (4),
           02 SPACE7           CHAR  (3) INIT((3)' '),
           02 R90_IPLTIME      CHAR (11),
           02 SPACE8           CHAR  (3) INIT((3)' '),
           02 R90_IPLDATE      CHAR  (8),
           02 SPACE9           CHAR (41) INIT((41)' ');
 %PAGE;
    DECLARE

        01 R90_SUB5_LINE2,
           02 SPACE1           CHAR  (13) INIT((13)' '),
           02 SPACE2           CHAR  (7) INIT('PROMPT('),
           02 R90_PROMPT       CHAR  (5),
           02 SPACE3           CHAR  (6) INIT((6)' '),
           02 SPACE4           CHAR  (4) INIT('REC('),
           02 R90_REC          CHAR  (5),
           02 SPACE5           CHAR  (5) INIT((5)' '),
           02 R90_LISTDSN      CHAR  (3) INIT((3)' '),
           02 SPACE6           CHAR  (7) INIT('LISTDSN'),
           02 SPACE7           CHAR (77) INIT((77)' '),

        01 R90_SUB5_LINE3,     /* EXIT NAMES                         */
           02 SPACE1           CHAR (20) INIT((20)' '),
           02 R90_EXITS(11),
              03 R90_EXITNAME  CHAR  (8),
              03 SPACE2        CHAR  (2) INIT((2)' '),
           02 SPACE2           CHAR  (2) INIT((2)' '),

        01 R90_SUB5_LINE4,  /* DATA SET NAMES DATA LINE           */
           02 SPACE1           CHAR (12) INIT((12)' '),
           02 R90_DATASETS(9),
              03 R90_DATASET   CHAR (10),
              03 SPACE3        CHAR  (2) INIT((2)' '),
           02 SPACE4           CHAR (12) INIT((12)' '),

        01 R90_SUB5_LINE5,  /* RECORDS COLLECTED DATA LINE        */
           02 SPACE1           CHAR (20) INIT((20)' '),
           02 R90_RECORDS      CHAR (64),
           02 SPACE4           CHAR (48) INIT((48)' '),

        01 R90_SUB5_LINE6,  /* SUBSYSTEM DATA LINE                */
           02 SPACE1           CHAR (19) INIT((19)' '),
           02 R90_SYSNAME      CHAR  (4),
           02 SPACE2           CHAR  (6) INIT((6)' '),
           02 R90_DETAIL       CHAR (13),
           02 SPACE3           CHAR  (3) INIT((3)' '),
           02 SPACE4           CHAR  (8) INIT((8)' '),
           02 SPACE5           CHAR (79) INIT((79)' ');
 %PAGE;
    DECLARE

        HEX_TABLE (0:15) CHAR (1) INIT(  /* TRANSLATE TABLE          */
            '0','1','2','3','4','5','6','7',
            '8','9','A','B','C','D','E','F'),
        HEX_CHAR (8)     BIT (4)  BASED (HEX_POINTER),
        CHAR_BUFFER      CHAR (8) INIT ((8)' '),
        HEX_POINTER      POINTER,
        PLACE            FIXED BINARY (31),
        INDX             FIXED BINARY (31),
        A                FIXED BINARY (31),
        I                FIXED BINARY (31),
        X                FIXED BINARY (31),

        NONE                   CHAR  (5) INIT('NONE)'),
        IPLR                   CHAR  (5) INIT('IPLR)'),
        LIST                   CHAR  (5) INIT('LIST)'),
        ALL                    CHAR  (5) INIT('ALL) '),
        PERM                   CHAR  (5) INIT('PERM)'),
        NO                     CHAR  (3) INIT(' NO'),
        YES                    CHAR  (3) INIT('YES'),
        NOTNO                  CHAR  (3) INIT((3)' '),
        INEFFECT               CHAR (13) INIT('    IN EFFECT'),
        NOT_INEFFECT           CHAR (13) INIT('NOT IN EFFECT'),
        NONE_DEFINED           CHAR  (8) INIT('* NONE *'),
        SET                    CHAR  (3) INIT('SET'),
        IPL                    CHAR  (3) INIT('IPL');
 %PAGE;
         IF SMF90TID(1) = 5 THEN   /* SMF SET RECORD                */
           R90_SUB5_TYPE = SET;
         ELSE                      /* SMF IPL RECORD                */
           R90_SUB5_TYPE = IPL;
         PUT FILE (RPORT90)
               EDIT(R90_SUB5_HDR1)
               (A)
               SKIP(4);
         LINE_COUNT90 = LINE_COUNT90 + 2;/* INCREMENT LINE COUNTER  */
         PUT FILE (RPORT90)
               EDIT(R90_SUB5_HDR2)
               (A)
               SKIP(2);
         LINE_COUNT90 = LINE_COUNT90 + 1;/* INCREMENT LINE COUNTER  */
         PUT FILE (RPORT90)
               EDIT(R90_SUB5_HDR3)
               (A)
               SKIP(1);
         LINE_COUNT90 = LINE_COUNT90 + 1;/* INCREMENT LINE COUNTER  */
 %PAGE;
         R90_MAXDORMM =            /* MAXDORM INTERVAL              */
                        SUBSTR(SMF90MAX(1),1,2);
         R90_MAXDORMS =            /* MAXDORM INTERVAL              */
                        SUBSTR(SMF90MAX(1),3,2);
         R90_STATUSH  =            /* STATUS INTERVAL               */
                        SUBSTR(SMF90STA(1),1,2);
         R90_STATUSM  =            /* STATUS INTERVAL               */
                        SUBSTR(SMF90STA(1),3,2);
         R90_STATUSS  =            /* STATUS INTERVAL               */
                        SUBSTR(SMF90STA(1),5,2);
         R90_JWTH     =            /* JOB WAIT TIME                 */
                        SUBSTR(SMF90JWT(1),1,2);
         R90_JWTM     =            /* JOB WAIT TIME                 */
                        SUBSTR(SMF90JWT(1),3,2);
         R90_SYSID   = SMF90SYI(1);/* SYSTEM ID                     */
         R90_MINBUF  = SMF90BUF(1);/* MINIMUM BUFFERS               */
         R90_MAXBUF  = SMF90BUM(1);/* MAXIMUM BUFFERS               */
         R90_RELEASE = SMF90REL(1);/* SYSTEM RELEASE NUMBER         */
         CALL CONVTIME(SMF90IIT(1),R90_IPLTIME);/* IPL TIME         */
         CALL CONVDATE(SMF90IDT(1),R90_IPLDATE);/* IPL DATE         */
         PUT FILE (RPORT90)
               EDIT(R90_SUB5_LINE1)
               (A)
               SKIP(2);
         LINE_COUNT90 = LINE_COUNT90 + 2;/* INCREMENT LINE COUNTER  */
         IF SMF90PAL(1) = '1'B THEN /* PROMPT(ALL)                  */
           R90_PROMPT = ALL;        /* PROMPT(ALL)                  */
         ELSE
           DO;
             IF SMF90PLT(1) = '1'B THEN /* PROMPT(LIST)             */
               R90_PROMPT = LIST;   /* PROMPT(LIST)                 */
             ELSE
               DO;
                 IF SMF90PIP(1) = '1'B THEN /* PROMPT(IPLR)         */
                   R90_PROMPT = IPLR; /* PROMPT(IPLR)               */
                 ELSE
                   R90_PROMPT = NONE; /* PROMPT(NONE)               */
               END;
           END;
         IF SMF90RPR(1) = '1'B THEN /* REC(PERM)                    */
           R90_REC = PERM;          /* REC(PERM)                    */
         ELSE
           R90_REC = ALL;           /* REC(ALL)                     */
         IF SMF90LDS(1) = '1'B THEN /* LISTDSN                      */
           R90_LISTDSN = NOTNO;     /* LISTDSN                      */
         IF SMF90NLD(1) = '1'B THEN /* NOLISTDSN                    */
           R90_LISTDSN = NO;        /* NOLISTDSN                    */
         PUT FILE (RPORT90)         /* PUT OUT DATA LINE            */
               EDIT(R90_SUB5_LINE2)
               (A)
               SKIP(2);
         LINE_COUNT90 = LINE_COUNT90 + 2;/* INCREMENT LINE COUNTER  */
 %PAGE;
 /*******************************************************************/
 /*                                                                 */
 /*  ACTIVE SMF DATA SETS SECTION                                   */
 /*                                                                 */
 /*******************************************************************/
         PUT FILE (RPORT90)
               EDIT(R90_SUB5_HDR8)   /* SMF DATA SETS IN USE HEADER */
               (A)
               SKIP(2);
         LINE_COUNT90 = LINE_COUNT90 + 2;/* INCREMENT LINE COUNTER  */
         DO I = 1 TO DIM(R90_DATASET,1); /* BLANK OUT FIELDS        */
           R90_DATASETS(I) = ' ';
         END;
         DO I=1 TO SMF90NDA(1);     /* DATA SET NAMES               */
           R90_DATASET(I) = SMF90DSN(I); /* MOVE DATA SET NAME      */
           IF I = DIM(R90_DATASET,1) THEN /* LINE FULL ?            */
             DO;

               PUT FILE (RPORT90)   /* DATA SET NAME DATA LINE      */
                     EDIT(R90_SUB5_LINE4)
                     (A)
                     SKIP(2);
            LINE_COUNT90 = LINE_COUNT90 + 2;/* INCREMENT LINE COUNTER */
               DO X=1 TO DIM(R90_DATASET,1);
                 R90_DATASETS(X) = ' ';
               END;
             END;
         END;
         IF (I = (DIM(R90_DATASET,1) + 1)) /* IF WE DIDNT ALREADY  */
            (I < DIM(R90_DATASET,1)) THEN
           DO;                              /* WRITE THE LINE       */

             PUT FILE (RPORT90)     /* DATA SET NAME DATA LINE      */
                   EDIT(R90_SUB5_LINE4)
                   (A)
                   SKIP(2);
            LINE_COUNT90 = LINE_COUNT90 + 2;/* INCREMENT LINE COUNTER */
           END;
 %PAGE;
 /*******************************************************************/
 /*                                                                 */
 /*  SUBSYSTEM OPTIONS SECTION                                      */
 /*                                                                 */
 /*******************************************************************/
         PUT FILE (RPORT90)         /* SUBSYSTEM OPTIONS HEADER 1   */
               EDIT(R90_SUB5_HDR4)
               (A)
               SKIP(4);
         LINE_COUNT90 = LINE_COUNT90 + 2;/* INCREMENT LINE COUNTER  */

     DO A = 1 TO SMF90NWK(1);       /* DO ALL DEFINED SUBSYSTEMS    */
         PUT FILE (RPORT90)         /* SUBSYSTEM OPTIONS HEADER 2   */
               EDIT(R90_SUB5_HDR5)
               (A)
               SKIP(2);
         LINE_COUNT90 = LINE_COUNT90 + 2;/* INCREMENT LINE COUNTER  */

         R90_SYSNAME = SMF90WKN(A);  /* MOVE SUBSYSTEM NAME         */
         IF SMF90DTL(A) = '1'B THEN  /* DETAIL RECORDING ??         */
           R90_DETAIL = INEFFECT;    /* INDICATE DETAIL RECORDING   */
         ELSE                        /* NOT DETAIL                  */
           R90_DETAIL = NOT_INEFFECT;/* INDICATE NO DETAIL          */

         PUT FILE (RPORT90)
               EDIT(R90_SUB5_LINE6)  /* SUBSYSTEM DATA LINE         */
               (A)
               SKIP(2);
         LINE_COUNT90 = LINE_COUNT90 + 2;/* INCREMENT LINE COUNTER  */
 %PAGE;
 /*******************************************************************/
 /*                                                                 */
 /*  COLLECTABLE RECORDS BY SUBSYSTEM                               */
 /*                                                                 */
 /*******************************************************************/
         PUT FILE (RPORT90)
               EDIT(R90_SUB5_HDR7)   /* RECORDS GATHERED BY SUBSYSTEM*/
               (A)
               SKIP(2);
         LINE_COUNT90 = LINE_COUNT90 + 2;/* INCREMENT LINE COUNTER  */

           HEX_POINTER = ADDR(SMF90SYS(A)); /* POINT TO BITS       */
           DO INDX = 1 TO 64;
             PLACE = HEX_CHAR(INDX);
             SUBSTR(R90_RECORDS,INDX,1) = HEX_TABLE(PLACE);
           END;

         PUT FILE (RPORT90)         /* RECORDS COLLECTED DATA LINE  */
               EDIT(R90_SUB5_LINE5)
               (A)
               SKIP(2);
         LINE_COUNT90 = LINE_COUNT90 + 2;/* INCREMENT LINE COUNTER  */
 %PAGE;
 /*******************************************************************/
 /*                                                                 */
 /*  ACTIVE EXITS BY SUBSYSTEM                                      */
 /*                                                                 */
 /*******************************************************************/

         IF SMF90EXN(A,1)<'        ' THEN /* NO EXITS FOR SUBSYSTEM */
           DO;

             PUT FILE (RPORT90)     /* NO EXITS FOR SUBSYSTEM       */
                   EDIT(R90_SUB5_HDR9)
                   (A)
                   SKIP(2);
            LINE_COUNT90 = LINE_COUNT90 + 2;/* INCREMENT LINE COUNTER */
           END;
         ELSE                       /* THERE ARE SOME EXITS         */
           DO;
             PUT FILE (RPORT90)     /* EXITS BY SUBSYSTEM HEADER    */
                   EDIT(R90_SUB5_HDR6)
                   (A)
                   SKIP(2);
            LINE_COUNT90 = LINE_COUNT90 + 2;/* INCREMENT LINE COUNTER */
             DO X=1 TO DIM(R90_EXITNAME,1); /* BLANK OUT FIELDS     */
               R90_EXITS(X) = ' ';
             END;
             DO I=1 TO 15 WHILE (SMF90EXN(A,I)>'        ');/*VALID ? */
               R90_EXITNAME(I)=SMF90EXN(A,I); /* MOVE NAME          */
               IF I = DIM(R90_EXITNAME,1) THEN /* LINE FULL ?       */
                 DO;
                 PUT FILE (RPORT90) /* ACTIVE EXITS DATA LINE       */
                       EDIT(R90_SUB5_LINE6)
                       (A)
                       SKIP(2);
            LINE_COUNT90 = LINE_COUNT90 + 2;/* INCREMENT LINE COUNTER */
                   DO X=1 TO DIM(R90_EXITNAME,1); /* BLANK OUT FIELDS */
                     R90_EXITS(X) = ' ';
                   END;
                 END;
             END;
             IF (I ^= DIM(R90_EXITNAME,1)) 
                (I ^= DIM(R90_EXITNAME,1) + 1)
              THEN
               DO;

               PUT FILE (RPORT90)   /* EXIT NAMES DATA LINE         */
                     EDIT(R90_SUB5_LINE3)
                     (A)
                     SKIP(2);
            LINE_COUNT90 = LINE_COUNT90 + 2;/* INCREMENT LINE COUNTER */
             END;
           END;
       END;
  END SMF90S5;
  %PAGE;
  SMF90S6 : PROC;                    /* FORMAT THE SUBTYPE 6 & 7 REC*/

 /********************************************************************/
 /*                                                                  */
 /*   SUBTYPE 6 = SWITCH SMF RECORDING DATA SETS                     */
 /*   SUBTYPE 7 = HALT END OF DAY COMMAND ISSUED                     */
 /*                                                                  */
 /********************************************************************/

    DECLARE

       R90_SUB6_HDR1           CHAR(132) INIT(
 '  ***  SMF RECORDING DATA SET SWITCH
                                                             '),

       R90_SUB6_HDR2           CHAR(132) INIT(
 '  ***  HALT END OF DAY COMMAND ISSUED
                                                             '),

       R90_SUB6_HDR3           CHAR(132) INIT(
 '       DATA SET ACTIVE    DATA SET ACTIVE
                                                       '),


       R90_SUB6_HDR4           CHAR(132) INIT(
 '        BEFORE COMMAND      AFTER COMMAND        TIME OF IPL   DATE OF
  IPL                                                         '),

       R90_SUB6_HDR5           CHAR(132) INIT(
 '                                                 TIME OF IPL   DATE OF
  IPL                                                        '),

       R90_SUB6_HDR6           CHAR(132) INIT(
 '                 THIS DATA SET SWITCH FORCED ''DATA LOST'' MODE.  NO S
 MF RECORDING WILL TAKE PLACE                                  '),


       01 R90_SUB6_LINE1,
          02 SPACE1               CHAR (13) INIT((13)' '),
          02 R90_BEFORE_DATASET   CHAR (10) INIT((10)' '),
          02 SPACE2               CHAR (10) INIT((10)' '),
          02 R90_AFTER_DATASET    CHAR (10) INIT((10)' '),
          02 SPACE3               CHAR ( 6) INIT(( 6)' '),
          02 R90_IPL_TIME         CHAR (11),
          02 SPACE4               CHAR  (6) INIT((6)' '),
          02 R90_IPL_DATE         CHAR  (8),
          02 SPACE5               CHAR (58) INIT((58)' ');
 %PAGE;
         IF (SMF90TID(1) = 6) THEN     /* SWITCH SMF                 */
           DO;
             PUT FILE (RPORT90)
                   EDIT(R90_SUB6_HDR1)
                   (A)
                   SKIP(4);
         LINE_COUNT90 = LINE_COUNT90 + 2;/* INCREMENT LINE COUNTER */

             PUT FILE (RPORT90)
                   EDIT(R90_SUB6_HDR3)
                   (A)
                   SKIP(2);
         LINE_COUNT90 = LINE_COUNT90 + 2;/* INCREMENT LINE COUNTER */

             PUT FILE (RPORT90)
                   EDIT(R90_SUB6_HDR4)
                   (A)
                   SKIP(1);
         LINE_COUNT90 = LINE_COUNT90 + 2;/* INCREMENT LINE COUNTER */
           END;

         ELSE                          /* HALT END OF DAY            */
           DO;
             PUT FILE (RPORT90)
                   EDIT(R90_SUB6_HDR2)
                   (A)
                   SKIP(4);
             PUT FILE (RPORT90)
                   EDIT(R90_SUB6_HDR5)
                   (A)
                   SKIP(2);
           END;


         R90_BEFORE_DATASET = SMF90SWO(1); /* OLD DATA SET         */
         R90_AFTER_DATASET  = SMF90SWN(1); /* NEW DATA SET         */
         CALL CONVTIME(SMF90IT(1),R90_IPL_TIME); /* GET IPL TIME   */
         CALL CONVDATE(SMF90DT(1),R90_IPL_DATE); /* GET IPL DATE   */

             PUT FILE (RPORT90)
                   EDIT(R90_SUB6_LINE1)
                   (A)
                   SKIP(2);
         LINE_COUNT90 = LINE_COUNT90 + 1;/* INCREMENT LINE COUNTER */
         IF R90_AFTER_DATASET = '          ' &       /* DATA LOST  */
          (SMF90TID(1) = 6) THEN
           DO;

             PUT FILE (RPORT90)
                   EDIT(R90_SUB6_HDR6)
                   (A)
                   SKIP(2);
         LINE_COUNT90 = LINE_COUNT90 + 1;/* INCREMENT LINE COUNTER */
           END;
  END SMF90S6;
  %PAGE;
  SMF90S8 : PROC;                    /* FORMAT THE SUBTYPE 8 RECORD */

 /********************************************************************/
 /*                                                                  */
 /*    IPL REASON DATA                                               */
 /*                                                                  */
 /********************************************************************/


    DECLARE

       R90_SUB8_HDR1           CHAR(132) INIT(
 '  ***  OPERATOR''S RESPONSE FOR THE IPL REASON
                                                             '),


       R90_SUB8_HDR2           CHAR(132) INIT(
 'FAILURE TIME   TIME OF RE-IPL  DATE OF RE-IPL     OPERATOR''S NAME
      REASON FOR THE IPL                                      '),

       R90_SUB8_HDR3           CHAR(132) INIT(
 '           OPERATOR REPLIED ''U'' TO THE IPL REASON MESSAGE
                                                               '),

       R90_SUB8_HDR4           CHAR(132) INIT(
 '               TIME OF RE-IPL  DATE OF RE-IPL
                                                              '),



       01 R90_SUB8_LINE1,
          02 SPACE1               CHAR  (4) INIT((4)' '),
          02 R90_FAILURE_TIME     CHAR  (8) INIT((8)' '),
          02 SPACE2               CHAR  (6) INIT((6)' '),
          02 R90_IPL_TIME         CHAR (11) INIT((11)' '),
          02 SPACE3               CHAR  (4) INIT((4)' '),
          02 R90_IPL_DATE         CHAR  (8) INIT((8)' '),
          02 SPACE4               CHAR  (4) INIT((4)' '),
          02 R90_OPERATOR         CHAR (20) INIT((20)' '),
          02 SPACE5               CHAR  (2) INIT((2)' '),
          02 R90_REASON           CHAR (65) INIT((65)' ');
 %PAGE;
         PUT FILE (RPORT90)
               EDIT(R90_SUB8_HDR1)
               (A)
               SKIP(4);
         IF SUBSTR(SMF90DTM(1),1,1) = 'U' THEN /* DEFAULT RESPONSE   */
           DO;
             PUT FILE (RPORT90)
                   EDIT(R90_SUB8_HDR3)
                   (A)
                   SKIP(2);
             PUT FILE (RPORT90)
                   EDIT(R90_SUB8_HDR4)
                   (A)
                   SKIP(2);
         CALL CONVTIME(SMF90ITM(1),R90_IPL_TIME); /* GET IPL TIME   */
         CALL CONVDATE(SMF90DTT(1),R90_IPL_DATE); /* GET IPL DATE   */
             PUT FILE (RPORT90)
                   EDIT(R90_SUB8_LINE1)
                   (A)
                   SKIP(2);
           END;

         ELSE                          /* MEANINGFUL RESPONSE        */
           DO;
             PUT FILE (RPORT90)
                   EDIT(R90_SUB8_HDR2)
                   (A)
                   SKIP(2);


            LINE_COUNT90 = LINE_COUNT90 + 2;/* INCREMENT LINE COUNTER */

             R90_FAILURE_TIME = SMF90DTM(1); /* SYSTEM FAILURE TIME */
             R90_OPERATOR   = SMF90OPR(1); /* OPERATOR'S NAME      */
             R90_REASON     = SMF90RSN(1); /* REASON FOR IPL       */
             CALL CONVTIME(SMF90ITM(1),R90_IPL_TIME); /* GET IPL TIME */
             CALL CONVDATE(SMF90DTT(1),R90_IPL_DATE); /* GET IPL DATE */

                 PUT FILE (RPORT90)
                       EDIT(R90_SUB8_LINE1)
                       (A)
                       SKIP(2);
            LINE_COUNT90 = LINE_COUNT90 + 2;/* INCREMENT LINE COUNTER */
           END;
  END SMF90S8;
  %PAGE;
  SMF90S1 : PROC;                    /* FORMAT THE SUBTYPE 1 & 2 REC*/

 /********************************************************************/
 /*                                                                  */
 /*  SET TIME / DATE RECORD                                          */
 /*                                                                  */
 /********************************************************************/

    DECLARE

       R90_SUB1_HDR1           CHAR(132) INIT(
 '  ***  TIME OF DAY CLOCK SET BY OPERATOR
                                                             '),

       R90_SUB1_HDR2           CHAR(132) INIT(
 '       TIME BEFORE COMMAND   TIME AFTER COMMAND     DATE BEFORE COMMAN
 D  DATE AFTER COMMAND                                      '),

       01 R90_SUB1_LINE1,
          02 SPACE1            CHAR (15) INIT((15)' '),
          02 R90_BEFORE_TIME   CHAR (11),
          02 SPACE2            CHAR (10) INIT((10)' '),
          02 R90_AFTER_TIME    CHAR (11),
          02 SPACE3            CHAR (16) INIT((16)' '),
          02 R90_BEFORE_DATE   CHAR  (8),
          02 SPACE4            CHAR (13) INIT((13)' '),
          02 R90_AFTER_DATE    CHAR  (8),
          02 SPACE5            CHAR (40) INIT((40)' ');
     DECLARE
        HEX_TABLE (0:9)  CHAR (1) INIT(  /* TRANSLATE TABLE          */
            '0','1','2','3','4','5','6','7','8','9'),
        HEX_CHAR (8)     BIT (4)  BASED (HEX_POINTER),
        CHAR_BUFFER      CHAR (8) INIT ((8)' '),
        HEX_POINTER      POINTER,
        PLACE            FIXED BINARY (31),
        INDX             FIXED BINARY (31);
 %PAGE;

         PUT FILE (RPORT90)
               EDIT(R90_SUB1_HDR1)
               (A)
               SKIP(4);
         LINE_COUNT90 = LINE_COUNT90 + 4;/* INCREMENT LINE COUNTER  */

         PUT FILE (RPORT90)
               EDIT(R90_SUB1_HDR2)
               (A)
               SKIP(2);
         LINE_COUNT90 = LINE_COUNT90 + 2;/* INCREMENT LINE COUNTER  */

     CALL CONVDATE(SMF90ODT(1),R90_BEFORE_DATE);
     CALL CONVDATE(SMF90NDT(1),R90_AFTER_DATE);
     HEX_POINTER = ADDR (SMF90OTM(1));
     DO INDX = 1 TO 8;
       PLACE = HEX_CHAR(INDX);
       SUBSTR(CHAR_BUFFER,INDX,1) = HEX_TABLE(PLACE);
     END;
     R90_BEFORE_TIME = SUBSTR(CHAR_BUFFER,1,2)  ':'  /* HOURS   */
                       SUBSTR(CHAR_BUFFER,3,2)  ':'  /* MINUTES */
                       SUBSTR(CHAR_BUFFER,5,2)  '.'  /* SECONDS */
                       SUBSTR(CHAR_BUFFER,7,2);       /* HUNDREDTHS */
     HEX_POINTER = ADDR (SMF90NTM(1));
     DO INDX = 1 TO 8;
       PLACE = HEX_CHAR(INDX);
       SUBSTR(CHAR_BUFFER,INDX,1) = HEX_TABLE(PLACE);
     END;
     R90_AFTER_TIME  = SUBSTR(CHAR_BUFFER,1,2)  ':'  /* HOURS   */
                       SUBSTR(CHAR_BUFFER,3,2)  ':'  /* MINUTES */
                       SUBSTR(CHAR_BUFFER,5,2)  '.'  /* SECONDS */
                       SUBSTR(CHAR_BUFFER,7,2);       /* HUNDREDTHS */

         PUT FILE (RPORT90)
               EDIT(R90_SUB1_LINE1)
               (A)
               SKIP(2);
         LINE_COUNT90 = LINE_COUNT90 + 2;/* INCREMENT LINE COUNTER  */
  END SMF90S1;
  %PAGE;
  SMF90S4 : PROC;                    /* FORMAT SUBTYPE 4,10,11,12    */

 /********************************************************************/
 /*                                                                  */
 /*  SET IPS, SET OPT, SETICS, AND SRM IPL OPTIONS                   */
 /*                                                                  */
 /********************************************************************/

    DECLARE

       01 R90_SUB4_HDR1,
          02 SPACE1            CHAR  (7) INIT('  ***  '),
          02 R90_SET_TYPE      CHAR  (7),
          02 SPACE2            CHAR (27) INIT(
                   ' COMMAND ISSUED BY OPERATOR'),
          02 SPACE3            CHAR (91) INIT((91)' '),

       01 R90_SUB4_HDR2,
          02 SPACE1            CHAR (34) INIT(
                   '  ***  SRM PARAMETERS AT IPL     '),
          02 SPACE2            CHAR (98) INIT((98)' '),

       R90_SUB4_HDR3           CHAR(132) INIT(
 '       OLD IEAIPS MEMBER       NEW IEAIPS MEMBER
                                                             '),

       R90_SUB4_HDR4           CHAR(132) INIT(
 '       OLD IEAICS MEMBER       NEW IEAICS MEMBER
                                                             '),

       R90_SUB4_HDR5           CHAR(132) INIT(
 '       OLD IEAOPT MEMBER       NEW IEAOPT MEMBER
                                                             '),

       R90_SUB4_HDR6           CHAR(132) INIT(
 '       IEAIPS MEMBER     IEAOPT MEMBER     IEAICS MEMBER
                                                             ');

 %PAGE;
    DECLARE

       01 R90_SUB4_LINE1,
          02 SPACE1            CHAR (16) INIT((16)' '),
          02 R90_OLD_MEMBER    CHAR  (8),
          02 SPACE2            CHAR (16) INIT((16)' '),
          02 R90_NEW_MEMBER    CHAR  (8),
          02 SPACE3            CHAR (84) INIT((84)' '),

       01 R90_SUB4_LINE2,
          02 SPACE1            CHAR (12) INIT((12)' '),
          02 R90_IPS_MEMBER    CHAR  (8),
          02 SPACE2            CHAR (10) INIT((10)' '),
          02 R90_OPT_MEMBER    CHAR  (8),
          02 SPACE3            CHAR (10) INIT((10)' '),
          02 R90_ICS_MEMBER    CHAR  (8),
          02 SPACE4            CHAR (76) INIT((76)' '),

        SETIPS           CHAR (7) INIT('SET IPS'),
        SETOPT           CHAR (7) INIT('SET OPT'),
        SETICS           CHAR (7) INIT(' SETICS'),
        NONE             CHAR (8) INIT('  NONE  ');
 %PAGE;

 /********************************************************************/
 /*                                                                  */
 /*    SRM PARAMETERS AT IPL                                         */
 /*                                                                  */
 /********************************************************************/
         IF (SMF90TID(1) = 10) THEN      /* SRM IPL PARAMETERS       */
           DO;
             PUT FILE (RPORT90)
                   EDIT(R90_SUB4_HDR2)
                   (A)
                   SKIP(4);
            LINE_COUNT90 = LINE_COUNT90 + 4;/* INCREMENT LINE COUNTER */
             PUT FILE (RPORT90)
                   EDIT(R90_SUB4_HDR6)
                   (A)
                   SKIP(2);
            LINE_COUNT90 = LINE_COUNT90 + 2;/* INCREMENT LINE COUNTER */
             R90_IPS_MEMBER = SMF90IPS(1);
             IF SUBSTR(SMF90OPT(1),7,2) = '**' THEN
               R90_OPT_MEMBER = NONE;
             ELSE
               R90_OPT_MEMBER = SMF90OPT(1);
             IF SUBSTR(SMF90ICS(1),7,2) = '**' THEN
               R90_ICS_MEMBER = NONE;
             ELSE
               R90_ICS_MEMBER = SMF90ICS(1);
             PUT FILE (RPORT90)
                   EDIT(R90_SUB4_LINE2)
                   (A)
                   SKIP(2);
           END;
 %PAGE;
 /********************************************************************/
 /*                                                                  */
 /*    OPERATOR ISSUED SET IPS COMMAND                               */
 /*                                                                  */
 /********************************************************************/

         IF (SMF90TID(1) = 4)  THEN      /* SET IPS COMMAND          */
           DO;
             R90_SET_TYPE = SETIPS;
             PUT FILE (RPORT90)
                   EDIT(R90_SUB4_HDR1)
                   (A)
                   SKIP(4);
            LINE_COUNT90 = LINE_COUNT90 + 4;/* INCREMENT LINE COUNTER */
             PUT FILE (RPORT90)
                   EDIT(R90_SUB4_HDR3)
                   (A)
                   SKIP(2);
            LINE_COUNT90 = LINE_COUNT90 + 2;/* INCREMENT LINE COUNTER */
             R90_OLD_MEMBER = SMF90IPO(1);
             R90_NEW_MEMBER = SMF90IPN(1);
             PUT FILE (RPORT90)
                   EDIT(R90_SUB4_LINE1)
                   (A)
                   SKIP(2);
           END;
 %PAGE;
 /********************************************************************/
 /*                                                                  */
 /*    OPERATOR ISSUED SET OPT COMMAND                               */
 /*                                                                  */
 /********************************************************************/

         IF (SMF90TID(1) = 11) THEN      /* SET OPT COMMAND          */
           DO;
             R90_SET_TYPE = SETOPT;
             PUT FILE (RPORT90)
                   EDIT(R90_SUB4_HDR1)
                   (A)
                   SKIP(4);
            LINE_COUNT90 = LINE_COUNT90 + 4;/* INCREMENT LINE COUNTER */
             PUT FILE (RPORT90)
                   EDIT(R90_SUB4_HDR5)
                   (A)
                   SKIP(2);
            LINE_COUNT90 = LINE_COUNT90 + 2;/* INCREMENT LINE COUNTER */
             R90_NEW_MEMBER = SMF90OPN(1);
             IF SUBSTR(SMF90OPO(1),7,2) = '**' THEN
               R90_OLD_MEMBER = NONE;
             ELSE
               R90_OLD_MEMBER = SMF90OPO(1);
             PUT FILE (RPORT90)
                   EDIT(R90_SUB4_LINE1)
                   (A)
                   SKIP(2);
           END;
 %PAGE;
 /********************************************************************/
 /*                                                                  */
 /*    OPERATOR ISSUED SETICS COMMAND                                */
 /*                                                                  */
 /********************************************************************/

         IF (SMF90TID(1) = 12) THEN      /* SETICS COMMAND           */
           DO;
             R90_SET_TYPE = SETICS;
             PUT FILE (RPORT90)
                   EDIT(R90_SUB4_HDR1)
                   (A)
                   SKIP(4);
            LINE_COUNT90 = LINE_COUNT90 + 4;/* INCREMENT LINE COUNTER */
             PUT FILE (RPORT90)
                   EDIT(R90_SUB4_HDR4)
                   (A)
                   SKIP(2);
            LINE_COUNT90 = LINE_COUNT90 + 2;/* INCREMENT LINE COUNTER */
             R90_NEW_MEMBER = SMF90ICO(1);
             IF SUBSTR(SMF90ICO(1),7,2) = '**' THEN
               R90_OLD_MEMBER = NONE;
             ELSE
               R90_OLD_MEMBER = SMF90ICO(1);
             PUT FILE (RPORT90)
                   EDIT(R90_SUB4_LINE1)
                   (A)
                   SKIP(2);
           END;

  END SMF90S4;
  %PAGE;
  SMF90S3 : PROC;                    /* FORMAT THE SUBTYPE 3 RECORD */

 /********************************************************************/
 /*                                                                  */
 /*  SET DOMAIN OPTIONS                                              */
 /*                                                                  */
 /********************************************************************/

   DECLARE

       R90_SUB3_HDR1           CHAR(132) INIT(
 '  ***  SETDMN (SET DOMAIN) COMMAND ISSUED
                                                             '),

       R90_SUB3_HDR2           CHAR(132) INIT(
 '       DOMAIN     MIN     MAX     WEIGHT     AOBJ     DOBJ     FWKLD
                                                       '),
       01 R90_SUB3_LINE1,
          02 SPACE1            CHAR  (8) INIT((8)' '),
          02 R90_DOMAINC       CHAR  (1) INIT(' '),
          02 SPACE2            CHAR  (1) INIT(' '),
          02 R90_DOMAIN        PIC'Z99',
          02 SPACE3            CHAR  (3) INIT((3)' '),
          02 R90_MINC          CHAR  (1) INIT(' '),
          02 SPACE4            CHAR  (1) INIT(' '),
          02 R90_MIN           PIC'Z99',
          02 SPACE5            CHAR  (3) INIT((3)' '),
          02 R90_MAXC          CHAR  (1) INIT(' '),
          02 SPACE6            CHAR  (1) INIT(' '),
          02 R90_MAX           PIC'Z99',
          02 SPACE7            CHAR  (6) INIT((6)' '),
          02 R90_WEIGHTC       CHAR  (1) INIT(' '),
          02 SPACE8            CHAR  (1) INIT(' '),
          02 R90_WEIGHT        PIC'Z99',
          02 SPACE9            CHAR  (3) INIT((3)' '),
          02 R90_AOBJC         CHAR  (1) INIT(' '),
          02 SPACEA            CHAR  (1) INIT(' '),
          02 R90_AOBJ          PIC'Z99',
          02 SPACEB            CHAR  (3) INIT((3)' '),
          02 R90_DOBJC         CHAR  (1) INIT(' '),
          02 SPACEC            CHAR  (1) INIT(' '),
          02 R90_DOBJ          PIC'Z99',
          02 SPACED            CHAR  (3) INIT((3)' '),
          02 R90_FWKLDC        CHAR  (1) INIT(' '),
          02 SPACEE            CHAR  (1) INIT(' '),
          02 R90_FWKLD         PIC'Z99',
          02 SPACEF            CHAR (68) INIT((68)' ');
 %PAGE;

             PUT FILE (RPORT90)
                   EDIT(R90_SUB3_HDR1)
                   (A)
                   SKIP(4);
            LINE_COUNT90 = LINE_COUNT90 + 4;/* INCREMENT LINE COUNTER */
             PUT FILE (RPORT90)
                   EDIT(R90_SUB3_HDR2)
                   (A)
                   SKIP(2);
            LINE_COUNT90 = LINE_COUNT90 + 2;/* INCREMENT LINE COUNTER */
            R90_DOMAIN = SMF90DMM(1);   /* DOMAIN NUMBER             */
            R90_MIN    = SMF90NMI(1);   /* NEW MIN VALUE             */
            R90_MAX    = SMF90NMA(1);   /* NEW MAX VALUE             */
            R90_WEIGHT = SMF90NWT(1);   /* NEW WEIGHT VALUE          */
            R90_AOBJ   = SMF90NAO(1);   /* NEW AOBJ VALUE            */
            R90_DOBJ   = SMF90NDO(1);   /* NEW DOBJ VALUE            */
            R90_FWKLD  = SMF90WKL(1);   /* NEW FWKLD VALUE           */
            IF SMF90MND(1) = '1'B THEN  /* VALUE CHANGED             */
              R90_MINC = '*';           /* INDICATE CHANGED VALUE    */
            IF SMF90MXD(1) = '1'B THEN  /* VALUE CHANGED             */
              R90_MAXC = '*';           /* INDICATE CHANGED VALUE    */
            IF SMF90WGT(1) = '1'B THEN  /* VALUE CHANGED             */
              R90_WEIGHTC = '*';        /* INDICATE CHANGED VALUE    */
            IF SMF90AOB(1) = '1'B THEN  /* VALUE CHANGED             */
              R90_AOBJC = '*';          /* INDICATE CHANGED VALUE    */
            IF SMF90DOB(1) = '1'B THEN  /* VALUE CHANGED             */
              R90_DOBJC = '*';          /* INDICATE CHANGED VALUE    */
            IF SMF90FWK(1) = '1'B THEN  /* VALUE CHANGED             */
              R90_FWKLDC = '*';         /* INDICATE CHANGED VALUE    */


             PUT FILE (RPORT90)
                   EDIT(R90_SUB3_LINE1)
                   (A)
                   SKIP(2);
            LINE_COUNT90 = LINE_COUNT90 + 2;/* INCREMENT LINE COUNTER */

  END SMF90S3;

 END SMFFRMT;                           /* ENDOFPROGRAM              */

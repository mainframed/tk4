5 PRINT "CADAM PLOTTING PROGRAM ENTERED"
10 OPEN "COM1:9600,S,7,1,RS,CS65535,DS,CD" AS #3
20 E$=CHR$(27)
30 PRINT #3,E$+".@:"+E$+".H:"+E$+".E"
40 INPUT #3,ESCE
100 INPUT "ENTER FILE NAME TO BE PLOTTED",PFN$
110 IF PFN$="QUIT" THEN 9999
120 IF PFN$="quit" THEN 9999
130 OPEN PFN$ FOR INPUT AS #1
135 INPUT "ENTER XMIN,XMAX,YMIN,YMAX SCALING VALUES:",XMIN,XMAX,YMIN,YMA
140 PRINT #3,"SC";XMIN;",";XMAX;",";YMIN;",";YMAX;","
150 YES=1
160 NO=0
150 HOLDING=NO
200 REM MAINLINE
202 IF HOLDING=NO THEN GOTO 210
204 A$=HOLD$
205 HOLD$=""
206 HOLDING=NO
208 GOTO 222
210 IF EOF(1) THEN 9999
220 LINE INPUT #1, A$
222 REM MAINLINE SECONDARY
225 FOUND=INSTR(A$,"SP")
230 IF FOUND<>0 THEN GOTO 8000
232 FOUND=INSTR(A$,"NR;")
234 IF FOUND<>0 THEN GOTO 7000
236 IF LEN$(A$)=0 THEN GOTO 200
240 PRINT #3, A$
250 GOTO 200
7000 REM END OF DRAWING ROUTINE
7010 IF FOUND=1 THEN 7100
7020 C$=LEFT$(A$,FOUND-1)
7030 HOLD$=MID$(A$,FOUND,LEN(A$)-FOUND+1)+HOLD$
7040 HOLDING=YES
7050 A$=C$
7060 GOTO 222 ' RETURN TO MAINLINE SECONDARY
7100 PRINT "DONE WITH CURRENT GRAPH"
7110 RECLEN=LEN(A$)
7120 IF RECLEN=3 THEN 200 ' RETURN TO MAINLINE
7130 HOLD$=MID$(A$,FOUND+3,RECLEN-FOUND-2)+HOLD$
7140 HOLDING=YES
7150 GOTO 200 ' RETURN TO MAINLINE
8000 REM PEN SELECT SUBROUTINE
8001 IF FOUND=1 THEN 8010
8002 C$=LEFT$(A$,FOUND-1)
8003 HOLD$=MID$(A$,FOUND,LEN(A$)-FOUND+1)+HOLD$
8004 HOLDING=YES
8005 A$=C$
8006 GOTO 222 ' RETURN TO MAINLINE SECONDARY
8010 PRINT #3, "SP0;"
8020 P$=MID$(A$,3,1)
8030 IF P$="0" THEN 8052
8040 PRINT "CHANGE TO PEN NUMBER"+P$
8045 INPUT "PRESS RETURN WHEN READY";R$
8050 PRINT #3, "SP1;"
8052 RECLEN=LEN(A$)
8054 IF RECLEN=4 THEN 200 ' RETURN TO MAINLINE
8056 HOLD$=MID$(A$,FOUND+4,RECLEN-FOUND-3)+HOLD$
8058 HOLDING=YES
8060 GOTO 200 ' RETURN TO MAINLINE
9000 ' ERROR HANDLING
9010 IF ERR=57 AND ERL=40 THEN RESUME
9020 PRINT "ERR = ";ERR;" ERROR LINE = ";ERL
9999 PRINT"*** DONE ***": END

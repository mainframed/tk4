 % INCLUDE CPINIT;
   @PROC(1,UID);
   @ALLOC(DA('VSAM.U.SD.U000.TABLES.CLUSTER'),SHR);
   OPEN FILE(U194F9) TITLE(DA08DDN);
   @SETL(&NAME=GETPG(SYMC('&UID')));
   CLOSE FILE(U194F9);
   DA18DDN=DA08DDN;
   @FREE(DA);
   @WRITE('PGMR NAME FOR &UID = &NAME');
   DCL SUFFIX ENTRY(CHAR(*),CHAR(*))
     RETURNS(FIXED BIN(15,0));
   DCL U194F9 FILE RECORD INPUT DIRECT KEYED ENV(VSAM);
 GETPG:  PROC(PUID) RETURNS(CHAR(30) VAR);;
 /* GETS DIV/DEP AND PROGRAMMER NAME */
  DCL PUID CHAR(8);
  DCL APPLREC CHAR(120);
  DCL RETNAME CHAR(30) INIT('?');
  ON KEY(U194F9) BEGIN;
    ON KEY(U194F9) GO TO ENDDD;
    READ FILE(U194F9) INTO(APPLREC) KEY('04'××PUID);
    GO TO SETRET;
    END;
  READ FILE(U194F9) INTO(APPLREC) KEY('04'××SUBSTR(PUID,2,5));
 SETRET:
  RETNAME=SUBSTR(APPLREC,31,30);
 ENDDD:
  RETURN(SUBSTR(RETNAME,1,SUFFIX(RETNAME,' ')));
  END GETPG;
  END;

*$.HE ISD GENERALIZED SUBROUTINES - SYSFIND
*$.HE PLI INTERFACE TO FIND MACRO
*$.PL 55
*$.PN 0
*$.PA
*$.SS
*$.NF
*$12/1/76
*$AUTHOR:  T. SMITH
*$SOURCE MODULE NAME:  SYSFIND
*$DOCUMENTATION ID:  *$
*$.FI L
*$.SP 5
*$THIS ROUTINE PROVIDES THE PLI PROGRAMMER WITH AN INTERFACE TO THE
*$FIND MACRO.  IT CAN BE USED TO CAUSE THE SYSTEM TO USE THE ADDRESS
*$OF THE FIRST BLOCK OF THE SPECIFIED PARTITIONED DATA SET MEMBER
*$AS THE STARTING POINT FOR THE NEXT CALL TO SYSREAD.
*$.SP 1
*$CALL SYSFIND(DCBPTR,MEMBNAME,'D',RETCODE);
*$.SP 1
*$CALL SYSFIND(DCBPTR,LISTPTR,'C',RETCODE);
*$.SP 1
*$.CE 1
*$DEFINITION OF TERMS
*$.SP 1
*$'C'
*$.IN 5
*$SPECIFIES THAT A RELATIVE ADDRESS HAS BEEN SUPPLIED, AND NO
*$DIRECTORY SEARCH IS REQUIRED.  THE RELATIVE ADDRESS SUPPLIED IS ISED
*$DIRECTLY BY THE ACCESS METHOD FOR THE NEXT INPUT OPERATION.
*$.IN 0
*$'D'
*$.IN 5
*$SPECIFIES THAT ONLY A MEMBER NAME HAS BEEN SUPPLIED, AND THE
*$ACCESS METHOD MUST SEARCH THE DIRECTORY OF THE DATA SET
*$INDICATED IN THE DCB TO FIND THE LOCATION OF THE MEMBER.
*$.IN 0
*$DCBPTR
*$.IN 5
*$POINTER VARIABLE CONTAINING THE ADDRESS OF THE BPAM DCB.  PREVIOUSLY
*$SET BY A CALL TO SYSDCBP.
*$.IN 0
*$LISTPTR
*$.IN 5
*$POINTER TO THE RELATIVE ADDRESS (TTRK) OF THE LIST.  THE LIST
*$ENTRY MUST HAVE BEEN CONSTRUCTED VIA 'SYSBLDL' PREVIOUS TO
*$THIS CALL.
*$.IN 0
*$MEMBNAME CHAR(8)
*$.IN 5
*$NAME OF MEMBER TO BE FOUND.
*$.IN 0
*$RETCODE FIXED BIN(31,0)
*$.IN 5
*$0 - SUCCESSFUL EXECUTION.
*$.IN 5
*$4 - NAME NOT FOUND
*$.IN 5
*$8 - PERMANENT I/O ERROR
*$.IN 0
SYSFIND  PLIENTRY ,COMPILE=&SYSPARM
         LM    2,5,0(1) LOAD PARAMETER LIST
         L     1,0(2) LOAD DCB PTR
         L     0,0(3) LOAD LIST NAME PTR.ADDRESS FROM SDV
         L     4,0(4) ADDRESS ID CHAR
         CLI   0(4),C'C' CHECK TYPE
         BE    CTYPE
         CLI   0(4),C'D'
         BNE   EXIT
* D-TYPE - NAME LIST FOR FIND
         FIND  (1),(0),D
         ST    15,0(5)
         B     EXIT
* C-TYPE - RELATIVE LIST
CTYPE    FIND  (1),(0),C
EXIT     PLIEXIT
         END

 MACRO
 BLDG &INDEX=,&ENTRIES=0,&EMPTY=NO,&DELETE=NO,&PGMR=,&DIV=
 GBLB &ERR
 LCLC &EM,&DEL,&BLNKS,&BLDXSTR
 LCLA &INDX,&INDXC
&BLNKS SETC (58-K'&INDEX)' '
 AIF ('&PGMR' NE '').PGMOK
 MNOTE 16,'PGMR= KEYWORD NOT SUPPLIED GENERATION TERMINATED'
&ERR SETB 1
.PGMOK ANOP
 AIF ('&DIV' NE '').DIVOK
 MNOTE 16,'DIV= KEYWORD NOT SUPPLIED, GENERATION TERMINATED'
&ERR SETB 1
.DIVOK ANOP
 AIF ('&INDEX' NE '').OKNAM
 MNOTE 16,'INDEX= KEYWORD NOT SUPPLIED, GENERATION TERMINATED'
&ERR SETB 1
.OKNAM ANOP
 AIF ('&ENTRIES' NE '0').OKENT
 MNOTE 16,'ENTRIES= KEYWORD NOT SUPPLIED, GENERATION TERMINATED'
&ERR SETB 1
 AGO .MEND
.OKENT ANOP
 AIF ('&EMPTY' EQ 'NO').NOEMP
&EM SETC ',EMPTY'
.NOEMP ANOP
 AIF ('&DELETE' EQ 'NO').NODEL
&DEL SETC ',DELETE'
.NODEL ANOP
 AIF (&ERR).MEND
&INDXC SETA 0
&INDX SETA K'&INDEX
.LP ANOP
&INDXC SETA &INDXC+1
 AIF (&INDXC GE &INDX).NOBLDX
 AIF ('&INDEX'(&INDXC,1) NE '.').LP
&BLDXSTR SETC '&INDEX'(1,&INDXC-1)
 PUNCH ' BLDX INDEX=&BLDXSTR'
 AGO .LP
.NOBLDX ANOP
 PUNCH ' BLDG INDEX=&INDEX,&BLNKS.C'
 PUNCH '               ENTRIES=&ENTRIES&EM&DEL PGMR=&PGMR,DIV=&DIV,DATEC
               =&SYSDATE'
.MEND ANOP
 MEND

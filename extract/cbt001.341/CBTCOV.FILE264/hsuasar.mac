  /* HSUASAR */
  /* RETURNS THE HIGHEST NUMERIC ADDRESS IN THE SPECIFIED DIMENSION */
  HSUASAR:PROC(PRMPTR,PRMCNT) RETURNS(FIXED BIN(31,0));
    DCL PRMPTR PTR;
    DCL PRMCNT FIXED BIN(15,0); /* DESIRED DIMENSION */
    % INCLUDE ASARDCL;
    DCL GFASAR ENTRY(PTR,FIXED BIN(15,0),BIT(1))
      RETURNS(PTR);
    DCL FNDASAR ENTRY(PTR,CHAR(2) VAR,PTR)
      RETURNS(BIT(1));
    DCL BIT BIT(1);
    ASARHP = PRMPTR;
    I = REFASAR(ASARHP);
    IF I>PRMCNT
      THEN DO; /* NO ELEMENTS IN DIMENSION IF I<=PRMCNT */
        DO ASARELP=GFASAR(ASARHP,PRMCNT,'1'B) REPEAT(ASAREL)
          UNTIL(^SUBSTR(ASARELFL,1,1));
          BIT=FNDASAR(ASARELP,'XX',ASAREL);
          END;
        END;
    IF I<=PRMCNT
      THEN RETURN(0); /* NO ELEMENTS IN DIMENSION */
      ELSE RETURN(UNSPEC(ASARDPT(PRMCNT)->ASAREL));
    END;

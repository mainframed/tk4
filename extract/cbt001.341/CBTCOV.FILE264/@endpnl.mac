 /* @ENDPNL */
 %NOPRINT;
         % DCL @ENDPNL ENTRY;
 % @ENDPNL: PROC(P1) RETURNS(CHAR);
 /*
0*$.HE GENERALIZED SUBROUTINES - @ENDPNL
0*$.HE PLI PREPROCESSOR TEXT
0*$.HE FULL SCREEN SUPPORT FOR PLI UNDER TSO
0*$.PL 55
0*$.PN 0
0*$.SS
0*$.NF
0*$06/21/77
0*$AUTHOR:  T. SMITH
0*$SOURCE MODULE NAME:  @ENDPNL
0*$DOCUMENTATION ID:  0*$
0*$.FI L
0*$.SP 5
0*$THIS PLI PREPROCESSOR MACRO IS PART OF A PACKAGE TO PROVIDE 3277
0*$FULL SCREEN SUPPORT TO PLI PROGRAMS UNDER TSO.  SEE ALSO
0*$DOCUMENTATION ON THE @PANEL, @FIELD, @DOPNL, @FLDMOD, AND @SCREEN
0*$MACROS.
0*$.SP 1
0*$@ENDPNL DELIMITS THE DESCRIPTION OF A PANEL.  IT SHOULD FOLLOW THE
0*$LAST @FIELD MACRO FOR THE PANEL, AND HAS ONLY ONE OPTIONAL OPERAND:
0*$.SP 1
0*$.IN 5
0*$@ENDPNL(LAST);
0*$.IN 0
0*$.SP 1
0*$THE LAST KEYWORD SHOULD ONLY BE SPECIFIED ON THE @ENDPNL MACRO FOR
0*$THE LAST PANEL DEFINITION IN YOUR PROGRAM.
 */
         DCL (RET,P1) CHAR;
         DCL (I,INOFF,OUTOFF) FIXED;
         @@PNLSTA='DCL 1 '××@@PNLNAME××' STATIC UNALIGNED,'
          ××' 3 @PNLLEN FIXED BIN'
 ××'(15,0) INIT(-'××@NUMSTR(@ROWS*@COLS)
 ××'), 3 @PNLNAME CHAR(8) INIT('''××
 @@PNLNAME××'''), 3 @PNLNUM FIXED BIN(15,0) INIT('××@NUMSTR(@@PNLNUM)××
 '), 3 @INCNT FIXED BIN(15,0) INIT('××@NUMSTR(@@INCNT)××'), 3 @FLDCNT '
 ××' FIXED BIN(15,0) INIT('××@NUMSTR(@@FLDNUM)××')'
 ××@@SBASAV××'), 3 @NEWLEN FIXED BIN(31,0) INIT('××@NUMSTR(@@PNLLEN)××
 '), 3 @FLDDESCR @@PNLSTR';
 @@PNLARY=@@PNLARY××'@PNLSTAPT('××@NUMSTR(@@PNLNUM)××')=ADDR('××
 @@PNLNAME××'); @PNLDYNPT('××@NUMSTR(@@PNLNUM)××
 ')=ADDR('××@@PNLNAME××'_DYNAM);';
         I = @@FLDNUM/8;
         IF I*8 < @@FLDNUM
              THEN I = I + 1;
         /* I NOW EQUALS THE LENGTH IN BYTES OF @OUTFLAG */
         OUTOFF = I + 10;
         INOFF = OUTOFF + @@OUTOFF;
         @@PNLDYN='DCL 1 '××@@PNLNAME××'_DYNAM UNALIGNED, 3 @INOFF '××
 'FIXED BIN(31,0) INIT('××@NUMSTR(INOFF)××'), 3 @OUTOFF FIXED '××
 'BIN(31,0) INIT('××@NUMSTR(OUTOFF)××
 '), 3 @DYNCNT FIXED BIN(15,0) INIT('××@NUMSTR(@@FLDNUM)××
           '), 3 '××@@PNLNAME××'_OUTFLAG('××
           @@FLDNUM××') BIT(1) INIT(('××@NUMSTR(@@FLDNUM)××
           ')(1)''0''B), 3 '××@@PNLNAME××'_OUT @@OUTDYN, 3 '××
           @@PNLNAME××'_IN @@INDYN';
         RET='@@PNLSTA; @@PNLDYN;';
         IF P1 = 'LAST'
              THEN RET=RET××
                'DCL 1 @PNLARYS UNALIGNED, 2 @ARYCNT FIXED '××
           'BIN(31,0)'××
 ' INIT('××@NUMSTR(@@PNLNUM)××'), 2 @PNLARY('××@NUMSTR(@@PNLNUM)××'),'××
           ' 3 @PNLSTAPT PTR, 3 @PNLDYNPT PTR;'××
           @@PNLARY××
           'DCL @PNLCNT FIXED BIN(15,0)'
           ××' INIT('××@NUMSTR(@@PNLNUM)××');';
         RETURN(RET);
         % END @ENDPNL;
 %PRINT;

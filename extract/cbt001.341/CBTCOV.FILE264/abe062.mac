   /* COPYRIGHT 1983 BY THOMAS GLEN SMITH */
   /*ABE062,SLE,SRE */
   /*1      2   3   */
   %INCLUDE ABESUB;
 ABESUB(ABE062) PARS(0) CHECK(YES);
   %INCLUDE ABESUBA;
   DCL 1 LRN_STRUCTURE BASED(LRNPTR),
   %INCLUDE ABELRN;
   %INCLUDE ABELRNA;

   DCL ORGPTR PTR;
   DCL MYCMD CHAR(256) VAR;
   DCL CMDNAME CHAR(8);
   SELECT(CMDINDX);
     WHEN(1,2) CMDNAME='SL';
     WHEN(3)   CMDNAME='SR';
     OTHERWISE;
     END; /* SELECT */
   ORGPTR = RECPTR;
   AMT=PARY(1);
   L1=RH_L1;
   L2=RH_L2;
   IF L1>L2
     THEN DO;
       I=L1;
       L1=L2;
       L2=I;
       END;
   IF RH_NCOLS<1
     THEN DO;
       MSGDATA='RH_NCOLS MUST BE GREATER THAN 0';
       RHRC=8;
       RETURN;
       END;
   DO N=RH_NCOLS-1 TO 0 BY -1;
     SCOL=RH_OFF+N*RH_LEN;
     PUT STRING(MYCMD) EDIT
       (L1)(F(8))
       (L2)(X(1),F(8))
       (SCOL)(X(1),F(8))
       ('.32767 ')(A)
       (CMDNAME)(A)
       (AMT)(X(1),F(8));
     I=#CMD(MYCMD,RHPTR,RHHDRPT);
     END;
   RHRC=0;
   END ABE062;

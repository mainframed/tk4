*$.HE GENERALIZED UTILITIES - DDAMON
*$.HE MONITOR UTILITY - INVOKE SEQUENCE OF PROGRAMS
*$.PL 55
*$.PN 0
*$.PA
*$.SS
*$.NF
*$6/18/74
*$AUTHOR:  T. SMITH
*$SOURCE MODULE NAME:  DDAMON
*$DOCUMENTATION ID:  *$
*$.FI L
*$.SP 5
*$THE MONITOR UTILITY PROGRAM PROVIDES THE USER WITH THE FACILITY
*$FOR INVOKING A SEQUENCE OF ONE OR MORE PROGRAMS IN THE SAME JOB
*$STEP.
*$.SP 1
*$.NF
*$// EXEC PGM=DDAMON
*$//* INSERT ALL NECESSARY DD
*$//* STATEMENTS FOR PROGRAMS
*$//* TO BE INVOKED HERE.
*$//MONITOR DD *
*$ MONITOR CONTROL STATEMENTS
*$ ARE INSERTED HERE.  SEE BELOW
*$ FOR FORMAT.
*$/*
*$.FI L
*$.SP 1
*$.CE 1
*$MONITOR CONTROL STATEMENT FORMAT
*$.SP 1
*$PROGNAME,PARMVALUE
*$.SP 1
*$PROGNAME
*$.IN 5
*$PROGNAME IS THE NAME OF THE PROGRAM THE USER WISHES TO EXECUTE.
*$THE SPECIFIED PROGRAMS WILL BE EXECUTED IN THE SAME SEQUENCE AS
*$THEIR RESPECTIVE MONITOR CONTROL STATEMENTS ARE ENCOUNTERED IN
*$THE MONITOR DATA SET.  THE PROGRAM NAME IN EACH CONTROL STATEMENT
*$MUST BE PADDED ON THE RIGHT WITH BLANKS IF IT LESS THAT 8 BYTES
*$IN LENGTH.
*$.IN 0
*$PARMVALUE
*$.IN 5
*$PARMVALUE IS ANY PARAMETER INFORMATION TO BE PASSED TO THE SPECIFIED
*$PROGRAM WHEN IT IS INVOKED.  THIS INFORMATION WILL BE PASSED IN THE
*$SAME MANNER AS THOUGH IT WERE SPECIFIED IN THE PARM PARAMETER ON THE
*$EXEC JCL STATEMENT.
MONITOR SAVES RETCTL
 TGSREQU
 OPEN (SYSIN)
NXT EQU *
 GET SYSIN,CARD
 XC PARMLEN,PARMLEN
 CLI COMMA,C','
 BC 7,DOLINK
 LA R1,70
PNXT EQU *
 LA R2,PARMIN(R1)
 CLI 0(R2),C' '
 BC 7,GOTEND
 BCT R1,PNXT
GOTEND EQU *
 STH R1,PARMLEN
 BCTR R1,0
 EX R1,MVCPARM
 B DOLINK
MVCPARM MVC PARM(0),PARMIN
DOLINK EQU *
 LA R1,PRMPTR
 LINK EPLOC=PROGNAME
 B NXT
EOF EQU *
 SR RF,RF
 B RETCTL
SYSIN DCB DDNAME=MONITOR,DSORG=PS,MACRF=(GM),EODAD=EOF
CARD DS 0CL80
PROGNAME DS CL8
COMMA DS CL1
PARMIN DS CL71
PRMPTR DS 0F
 DC X'80'
 DC AL3(PARMLEN)
PARMLEN DS H
PARM DS CL71
 LTORG
 END

 /* DUMPDSCB */
 /*
0*#)F FUNCTION
0*# USE THE DUMPDSCB COMMAND TO OBTAIN A HEXADECIMAL DUMP AT
0*# YOU TERMINAL OF THE FORMAT 1 DSCB FOR A GIVEN DSNAME.
0*#)X SYNTAX
0*# DUMPDSCB 'DSNAME' VOL()
0*#)O OPERANDS
0*# 'DSNAME' - THIS IS THE DSNAME OF THE DATA SET FOR WHICH YOU
0*#   WANT A DUMP OF THE FORMAT 1 DSCB.  STANDARD TSO NAMEING
0*#   CONVENTIONS APPLY
0*#))VOL() - THIS KEYWORD PARAMETER IS OPTIONAL, AND IS USED TO
0*#   SPECIFY OF SERIAL NUMBER OF THE VOLUME CONTAINING THE
0*#   DATA SET FOR WHICH THE DSCB IS TO BE DUMPED.  IF THE VOL
0*#   KEYWORD IS NOT USED, THE DUMPDSCB COMMAND WILL SEARCH THE
0*#   CATALOG TO LOCATE THE DATA SET.
 */
         % INCLUDE CPINIT;
         @PROC(1,DSNAME#(DSNAME),VOL());
         % INCLUDE CTLGDEF;
         DCL RETCODE FIXED BIN(31,0),
             RET BIT(32) DEF RETCODE,
             RETC CHAR(4) DEF RETCODE;
         DCL CTLGRET CHAR(8);
         DCL 1 ABND STATIC,
              2 DUM BIN FLOAT(53),
              2 MAREA CHAR(265) INIT(' ');
         CTLGPTR = ADDR(MAREA);
         DCL WKAREA CHAR(148) INIT('');
         DCL MYVOL CHAR(6);
         DCL DSN CHAR(44) VAR;
         DCL (DUMPSTT,SYSCTLG,SYSVTOC,TROUT) ENTRY;
         DSN = SETDSN@(DSNAME);
         IF VOL ^= 0
              THEN MYVOL = SYMC('&VOL');
              ELSE DO;
                   CALL SYSCTLG('NAME',RET,DSN,'SYSRES',MAREA);
                   IF RETCODE ^= 0
                        THEN DO;
                             CALL TROUT(RETC,CTLGRET);
                             @SETL(&CTLGRC = CTLGRET);
                             @SETL(&CTLGDSN = DSN);
           @WRITE('ERROR = &CTLGRC ACCESSING CATALOG, DSN = &CTLGDSN');
                             SIGNAL ERROR;
                             END;
                   MYVOL = VLSTBLK.VOLID.VOLSER(1);
                   END;
         CALL SYSVTOC('SEARCH',RET,DSN,MYVOL,WKAREA);
         IF RETCODE ^= 0
              THEN DO;
                   CALL TROUT(RETC,CTLGRET);
                   @SETL(&CTLGRC = CTLGRET);
                   @SETL(&CTLGDSN = DSN);
                   @SETL(&MYVOL = MYVOL);
 @WRITE('ERROR = &CTLGRC ACCESSING VTOC, DSN = &CTLGDSN, VOL = &MYVOL');
                   SIGNAL ERROR;
                   END;
         CALL DUMPSTT(WKAREA);
         END;

 /* OCT */
   % INCLUDE CPINIT;
   @PROC(1,INPUT,DECIMAL,HEX);
   DCL OCTAL ENTRY(FIXED BIN(15,0))
     RETURNS(CHAR(6));
   DCL INSTR CHAR(15) VARYING;
   DCL ANS CHAR(11),
       PIC PIC'ZZZ,ZZZ,ZZ9' DEF ANS;
   DCL 1 F FIXED BIN(31,0),
       1 FD DEF F,
         2 TOP FIXED BIN(15,0),
         2 BOT FIXED BIN(15,0);
   INSTR=SYMC('&INPUT');
   DO I = INDEX(INSTR,',') REPEAT INDEX(INSTR,',') WHILE(I ^= 0);
     INSTR=SUBSTR(INSTR,1,I-1)××SUBSTR(INSTR,I+1);
     END;
   IF DECIMAL = 0 & HEX = 0
     THEN DO;
       F=0;
       IF LENGTH(INSTR)>6
         THEN DO;
           @WRITE('ERROR - OCTAL MUST BE 6 OR LESS CHARACTERS');
           RETURN;
           END;
       INSTR=SUBSTR('000000',1,6-LENGTH(INSTR))××INSTR;
       IF VERIFY(INSTR,'01234567')^=0 × SUBSTR(INSTR,1,1)>1
         THEN @WRITE('ERROR - INVALID OCTAL CONSTANT');
         ELSE DO;
           DO I=0 TO 5;
             F=F+SUBSTR(INSTR,6-I,1)*8**I;
             END;
           PIC=F;
           @SETL(&ANSWER=ANS);
           @WRITE('OCTAL &INPUT = DECIMAL &ANSWER');
           END;
       END;
     ELSE DO;
       IF HEX^=0
         THEN DO;
           F=HEXCON(INSTR);
           @SETL(&PRE='HEX');
           END;
         ELSE IF VERIFY(INSTR,'0123456789')^=0
           THEN DO;
             @WRITE('ERROR - INPUT NOT ALL DECIMAL DIGITS');
             RETURN;
             END;
           ELSE DO;
             F=INSTR;
             @SETL(&PRE='DECIMAL');
             END;
       @SETL(&ANSWER=OCTAL(BOT));
       @WRITE('&PRE &INPUT = OCTAL &ANSWER');
       END;
 HEXCON:  PROC(INSTR) RETURNS(FIXED BIN(31,0));
   DCL INSTR CHAR(15) VAR;
   DCL ZEROS CHAR(8) STATIC INIT((8)'0');
   DCL TRINBIN FIXED BIN(31,0),
       TRINSTR CHAR(4) DEF TRINBIN;
   DCL L FIXED BIN(15,0);
   L=LENGTH(INSTR);
   IF L > 8
     THEN DO;
       @WRITE('ERROR - ONLY 8 HEX DIGITS (4 BTYES) AT A TIME');
       SIGNAL ERROR;
       END;
     ELSE INSTR=SUBSTR(ZEROS,1,8-L)××INSTR;
   CALL TRIN(INSTR,TRINSTR);
   RETURN(TRINBIN);
   END HEXCON;
   END;

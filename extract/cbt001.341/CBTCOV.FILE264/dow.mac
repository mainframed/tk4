 /* DOW */
 /*
0*$.HE GENERALIZED SUBROUTINES - DOW
0*$.HE DETERMINE DAY-OF-WEEK
0*$.PL 55
0*$.PN 0
0*$.PA
0*$.SS
0*$.NF
0*$09/28/77
0*$AUTHOR:  T. SMITH
0*$SOURCE MODULE NAME:  DOW
0*$DOCOMENTATION ID:  0*$
0*$.FI L
0*$.SP 5
0*$THIS SUBROUTINE CAN BE INVOKED TO FIND OUT ON WHAT DAY OF THE WEEK
0*$A GIVEN DATE FALLS.  CALL FORMAT IS AS FOLLOWS:
0*$.SP 1
0*$.IN 5
0*$.NF
0*$DCL DOW ENTRY(FIXED DEC(5,0))
0*$  RETURNS(FIXED BIN(15,0));
0*$I = DOW(JULIAN);
0*$.FI L
0*$.IN 0
0*$.SP 1
0*$WHERE JULIAN IS THE DATE IN JULIAN FORM. THE RETURNED VALUE IS A
0*$NUMBER FROM 1 TO 7, WHERE 1 IS SUNDAY, 2 IS MONDAY, ETC.
 */
 DOW:  PROC(JULIAN) RETURNS(FIXED BIN(15,0));
         DCL JULIAN FIXED DEC(5,0);
         DCL (Z,YY,DDD) FIXED BIN(31,0);
         YY = JULIAN/1000;
         DDD = JULIAN-(YY*1000);
         Z = YY/4;
         IF MOD(YY,4) ^= 0
              THEN Z = Z + 1;
         Z = MOD(Z+MOD(YY,7),7) + MOD(DDD-1,7);
         IF Z > 7
              THEN Z = Z - 7;
         Z = Z + 1;
         IF Z = 8
              THEN Z = 1;
         RETURN(Z);
         END;

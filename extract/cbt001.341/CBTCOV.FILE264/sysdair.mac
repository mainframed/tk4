*$.HE GENERALIZED SUBROUTINES - SYSDAIR
*$.HE INTERFACE TO TSO DAIR ROUTINE
*$.PL 55
*$.PN 0
*$.PA
*$.SS
*$.NF
*$5/16/74
*$AUTHOR:  T. SMITH
*$SOURCE MODULE NAME:  SYSDAIR
*$DOCUMENTATION ID:  *$
*$.FI L
*$.SP 5
*$THIS ROUTINE SUPPLIES THE PLI PROGRAMMER WITH AN INTERFACE
*$TO THE TSO DYNAMIC ALLOCATION INTERFACE ROUTINE (DAIR).
*$THIS ROUTINE CAN BE USED TO ALLOCATE, FREE, CONCATENATE, AND
*$DECONCATENATE DATA SETS DYNAMICALLY; THAT IS, DURING PROBLEM
*$PROGRAM EXECUTION.  WITH TSO, DYNAMIC ALLOCATION PERMITS THE
*$TERMINAL MONITOR PROGRAM, COMMAND PROCESSORS, AND OTHER
*$PROBLEM PROGRAMS EXECUTING IN THE FOREGROUND REGION TO ALLOCATE
*$DATA SETS AFTER LOGON AND FREE THEM BEFORE LOGOFF.
*$.SP 1
********************************************************$
*$CALL SYSDAIR(CPPLUPT,CPPLECT,IOECB,CPPLPSCB,DAPBSTR,RETCODE);
*$.SP 1
********************************************************$
*
*$.CE 1
*$DEFINITION OF TERMS
*$.SP 1
*
********************************************************$
*
*$CPPLECT
*$.IN 5
*$POINTER VARIABLE SPCIFYING THE ADDRESS OF THE ENVIRONMENT
*$.IN 0
*$CPPLPSCB
*$.IN 5
*$POINTER VARIABLE SPECIFYING THE ADDRESS OF THE PROTECTED
*$STEP CONTROL BLOCK.
*$.IN 0
*$CPPLUPT
*$.IN 5
*$POINTER VARIABLE SPECIFYING THE ADDRESS OF THE USER PROFILE
*$TABLE (UPT).  YOU MAY OBTAIN THIS ADDRESS FROM THE CPPL
*$POINTED TO WHEN A COMMAND PROCESSOR IS ATTACHED BY
*$THE TERMINAL MONITOR PROGRAM.
*$.IN 0
*$DAPBSTR
*$.IN 5
*$ STRUCTURE CONTAINING THE DAIR PARAMETER BLOCK,
*$ CREATED BY THE CALLING ROUTINE.
*$.IN 0
*$IOECB
*$.IN 5
*$EVENT VARIABLE USED AS THE CALLING PROGRAM' EVENT CONTROL
*$BLOCK.
*$.IN 0
*$RETCODE
*$.IN 5
*$FIXED BIN(31,0) SET DEPENDING ON THE FUNCTION REQUESTED
*$OF DAIR.  SEE TSO GUIDE TO WRITING A TERMINAL MONITOR
*$PROGRAM OR A COMMAND PROCESSOR.
*$
******************************************************$
SYSDAIR  PLIENTRY ,DSA=128,COMPILE=&SYSPARM
         XC    MYDSA(MYLEN),MYDSA
         LM    2,7,0(1)
         L     2,0(2)                  R2 = A(UPT)
         L     3,0(3)                  R3 = A(ECT)
         L     5,0(5)                  R5 = A(PSCB)
         L     6,0(6)                  R6 = A(DAIR PARAMETER BLOCK)
         STM   2,6,DAPL                ST DAIR PARAMETER LIST
         LA    1,DAPL
         LINK  EP=IKJEFD00
         ST    15,0(7)                 SET RETCODE
EXIT     PLIEXIT
         LTORG
DSA      DSECT
MYDSA    DS    0F
DAPL     DS    5F
MYLEN    EQU   *-MYDSA
DSALEN   EQU   *-DSA
         END

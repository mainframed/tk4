 /* COPYRIGHT 1983 BY THOMAS GLEN SMITH */
  /* DENTCMDB */
  %NOPRINT;
  % IF @PARM ^=''
    % THEN % @PARM =','××@PARM;
 @PROCNAME:PROC(CMDDATA @PARM) RETURNS(FIXED BIN(15,0)) RECURSIVE
   OPTIONS(REENTRANT);
  DFT RANGE(*) FIXED BIN VALUE(FIXED BIN(31,0));
  DCL PREFIX ENTRY(CHAR(*),CHAR(*))RETURNS(FIXED BIN(15,0));
  RETVAL = 0;
  PARSTR=C_PARSTR;
  PARPTR = ADDR(PARSTR);
  % IF @DEBUG ='N'
    % THEN % DO;
  ON ERROR BEGIN;
  RETVAL = 16;
  GO TO EOR;
  END;
  ON CONVERSION BEGIN;
  RETVAL = 16;
  GO TO EOR;
  END;
      % END;
  I=INDEX(CMDDATA,' ');
  IF I=1
    THEN DO;
      CMDDATA=SUBSTR(CMDDATA,PREFIX(CMDDATA,' '));
      I=INDEX(CMDDATA,' ');
      END;
  IF I=0
    THEN I=LENGTH(CMDDATA)+1;
  IF VERIFY(SUBSTR(CMDDATA,1,I-1),'0123456789')=0
    THEN DO;
      CMDDATA='SET '××CMDDATA;
      I=4;
      END;
  CURNAME=SUBSTR(CMDDATA,1,I-1);
  CALL SETCAPS(CURNAME);
  DO J=1 TO HBOUND(NOPCMDS,1) WHILE(CURNAME^=NOPCMDS(J));
    END;
  IF J<=HBOUND(NOPCMDS,1)
    THEN DO CMDINDX=1 TO HBOUND(CMDTAB,1)
      WHILE(CURNAME^=CMDTAB(CMDINDX));
      END;
    ELSE DO;
      CALL DENTPRS(CMDDATA,PARSTR);
      CALL DENTCMK(RHPTR,PARPTR);
      IF OPERCK ^='0'B
        THEN DO;
          RETVAL = 4;
          GO TO EOR;
          END;
      IF CMDINDX = 0
        THEN DO;
          RETVAL = 8;
          GO TO EOR;
          END;
      END;
  % DCL @TMP FIXED;
  % @TMP = @SUBCNT-1;
  DO I = 1 TO @TMP UNTIL(CMDINDX <= RNGEARY(I));
    END;
  IF CMDINDX < RNGEARY(I)
    THEN I = I - 1;
  IX = CMDINDX - RNGEARY(I) + 1;
  GO TO CASE(I);
  @CALCOD;
 ENDCASE:
 EOR:
  RETURN(RETVAL);
  DCL CMDDATA CHAR(*) VAR;
  DCL DENTPRS ENTRY(CHAR(*) VAR,);
  DCL DENTCMK ENTRY;
  DCL PARPTR PTR;
  DCL 1 C_PARSTR UNALIGNED STATIC,
    2 C_CMDINDX FIXED BIN(15,0) INIT(0),
    2 C_OPERCK BIT(16) INIT('0'B),
    2 C_QUOTCK BIT(16) INIT('0'B),
    2 C_PARY(16) CHAR(256) VAR INIT((16)(1)''),
    2 C_NUMCKA(@SNMCNT) BIT(16) INIT(@NUMSTR),
    2 C_CMDTAB(@SNMCNT) CHAR(8) VAR INIT(@NAMSTR);
  DCL 1 PARSTR UNALIGNED,
    2 CMDINDX FIXED BIN(15,0),
    2 OPERCK BIT(16),
    2 QUOTCK BIT(16),
    2 PARY(16) CHAR(256) VAR,
    2 NUMCKA(@SNMCNT) BIT(16),
    2 CMDTAB(@SNMCNT) CHAR(8) VAR;
  DCL RNGEARY(@SUBCNT) FIXED BIN(15,0) STATIC INIT(@RNGESTR);
  DCL CASE(@SUBCNT) LABEL;
  DCL IX FIXED BIN(15,0);
  DCL @RELEASE BIT(1) EXT INIT('0'B);
  DCL NOPCMDS(@NOPCNT) CHAR(8) VAR STATIC INIT(@NOPSTR);
  DCL SETCAPS ENTRY;
  DCL CURNAME CHAR(8) VAR;
  @PARMDCL;
  @ENTDCL;
  END;
  %PRINT;

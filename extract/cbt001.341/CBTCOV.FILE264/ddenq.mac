 /* DDENQ/DSNENQ */
 /*
0*$.HE GENERALIZED SUBROUTINES - DDENQ/DSNENQ
0*$.HE ENQUEUE DATASETS LIKE U098MS01
0*$.PL 55
0*$.PN 0
0*$.PA
0*$.SS
0*$.NF
0*$09/29/78
0*$AUTHOR:  T. SMITH
0*$SOURCE MODULE NAME:  DDENQ
0*$DOCUMENTATION ID:  0*$
0*$.FI L
0*$.SP 5
0*$THIS SUBROUTINE CAN BE USED TO ENQUEUE (SYSTEM LEVEL) ON A DATA
0*$SET WITH THE SAME QNAME/RNAME THAT IS USED BY UTILITY PROGRAM
0*$U098MS01.  THE QNAMES WILL BE 'SPFDSN', 'KCENQ' AND 'SYSIEWLP'.
0*$THE DSNAME, AND THE RNAME WILL BE THE FULLY QUALIFIED DSNAME.
0*$.IN 5
0*$.NF
0*$.SP 1
0*$DCL DDENQ ENTRY(CHAR(8),CHAR(*))
0*$  RETURNS(CHAR(2));
0*$DCL DSNENQ ENTRY(CHAR(44),CHAR(*))
0*$  RETURNS(CHAR(2));
0*$DCL ENQRET CHAR(2);
0*$ENQRET = DDENQ(DDNAME,ENQCODE);
0*$IF ENQRET ^= 'OK'
0*$  THEN SIGNAL ERROR;
0*$  OR
0*$ENQRET = DSNENQ(DSNAME,ENQCODE);
0*$IF ENQRET ^= 'OK'
0*$  THEN SIGNAL ERROR;
0*$.HI 5
0*$.FI L
0*$.SP 1
0*$WHERE:
0*$.SP 1
0*$DDNAME IS CHAR(8).  DDENQ WILL READ IN THE
0*$JFCB FOR THAT DDNAME AND WILL USE THE DSNAME STORED THERE FOR
0*$THE ENQUEUE.
0*$.SP 1
0*$DSNAME IS CHAR(44).
0*$.SP 1
0*$ENQCODE IS CHAR(*), AND IS EITHER 'ENQ' OR 'DEQ'.
0*$.HI 0
0*$.PI 5
0*$.IN 0
0*$.SP 1
0*$THE CHARACTER VALUE RETURNED FROM DDENQ/DSNENQ IS AN
0*$INDICATION OF SUCCESS OR FAILURE OF THE ENQ/DEQ.  AS YOU
0*$CAN SEE, 'OK' MEANS THE ENQ/DEQ WAS SUCCESSFUL.  OTHER
0*$POSSIBLE RETURNED VALUES ARE DOCUMENTED IN THE TEXT FOR
0*$THE SYSENQ AND SYSDEQ SUBROUTINES ELSEWHERE IN THIS
0*$MANUAL.
 */
 DDENQ:  PROC(NAME,ENQCODE) RETURNS(CHAR(2)) OPTIONS(REENTRANT);
         JFCBPTR = ADDR(JFCBCOR);
         CALL SYSJFCB(NAME,JFCBPTR);
         GO TO BYDSN;
 DSNENQ:  ENTRY(PRMDSN,ENQCODE) RETURNS(CHAR(2)) OPTIONS(REENTRANT);
         JFCBPTR = ADDR(JFCBCOR);
         JFCBDSNM = PRMDSN;
 BYDSN: ;
         DCL NAME CHAR(8);
         DCL ENQCODE CHAR(*);
              /* MAY BE EITHER 'ENQ' OR 'DEQ' */
         DCL JFCBCOR CHAR(176);
         % INCLUDE JFCB;
         DCL PRMDSN CHAR(44);
         DCL KCENQ  CHAR(8) STATIC INIT('KCENQ');
         DCL SPFDSN CHAR(8) STATIC INIT('SPFDSN');
         DCL SPFEDT CHAR(8) STATIC INIT('SPFEDIT');
         DCL IEWL   CHAR(8) STATIC INIT('SYSIEWLP');
         DCL RNAME CHAR(44) VAR;
         DCL ENQRET CHAR(2);
         RNAME = JFCBDSNM;
         IF ENQCODE = 'ENQ'
           THEN DO;
             CALL SYSENQ(SPFEDT,RNAME,'SYSTEMS','E','HAVE',ENQRET);
             CALL SYSENQ(IEWL,  RNAME,'SYSTEMS','E','HAVE',ENQRET);
             CALL SYSENQ(KCENQ, RNAME,'SYSTEM', 'E','HAVE',ENQRET);
             CALL SYSENQ(SPFDSN,RNAME,'SYSTEMS','E','HAVE',ENQRET);
             END;
           ELSE DO;
             CALL SYSDEQ(SPFDSN,RNAME,'SYSTEMS',ENQRET);
             CALL SYSDEQ(KCENQ, RNAME,'SYSTEM', ENQRET);
             CALL SYSDEQ(IEWL,  RNAME,'SYSTEMS',ENQRET);
             CALL SYSDEQ(SPFEDT,RNAME,'SYSTEMS',ENQRET);
             END;
         RETURN(ENQRET);
         END;

 /* REQRPT2    UPDATED JULY 1978 BY RICK BABLER */
 REQRPT2:  PROC OPTIONS(MAIN);
         DCL DATE BUILTIN;
         DCL BDAM PTR;
         DCL DSNRCOR CHAR(110);
         DSNRPTR = ADDR(DSNRCOR);
         % INCLUDE TGSDSNR;
         % INCLUDE TGSVOL;
         % INCLUDE TGSBDAM;
         % INCLUDE TGSISWK;
         DCL (DSNRPTR,VOLRPTR) PTR;
         DCL ISAMFLE FILE ENV(INDEXED) INPUT;
         OPEN FILE(BDAMFLE) INPUT DIRECT KEYED;
         OPEN FILE(ISAMFLE) SEQUENTIAL;
         ON ENDFILE(ISAMFLE) GO TO EOJ;
         DCL PGNUM FIXED DEC(3,0) INIT(0);
 ON ENDPAGE(SYSPRINT) BEGIN;
         PGNUM = PGNUM + 1;
         PUT EDIT('LIST OF DATA SETS SCHEDULED','DATE = ',DATE,
           '  PAGE ',PGNUM)(A,COL(40),A,A,A,P'ZZ9') PAGE;
         PUT EDIT('FOR DELETION ON THE NEXT RUN OF JOB AU109856')(A)
           SKIP(1);
         PUT SKIP(1);
         END;
         SIGNAL ENDPAGE(SYSPRINT);
 NXT:
         READ FILE(ISAMFLE) INTO(ISAMIN);
         IF PRJNUM = '000000'
              THEN GO TO NXT;
         BDAMKEYA = ISAM.DAMASTER;
 DUPDSN: READ FILE(BDAMFLE) INTO(DSNRECS) KEY(BDAMKEY);
         IF SUBSTR(DCOMFLG,1,1) /* IS IT DSNREC? */
              THEN GO TO NXT;
         IF DPGMRNO=0 & DDIV=0 & DDEP=0 & DTRKS=0
              THEN PUT EDIT('DSN=',DSN,' VOL=',NEWVOL)(A,A,A,A)
                SKIP(1);
         IF DNDUPPT = 0 THEN GO TO NXT;
         BDAMKEYA = DNDUPPT;
         GO TO DUPDSN;
 EOJ:
         END;

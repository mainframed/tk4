 /* COPYRIGHT 1983 BY THOMAS GLEN SMITH */
   /* SSEBP - IMPLEMENTATION OF SSE IN BATCH */
   % DCL @PROCNAME CHAR;
   % @PROCNAME = 'SSEBP';
   % INCLUDE DENTSUB;
   HALT;
   DCL VAL CHAR(256) VAR;
   DCL KEY CHAR(8);
   DCL GBLSW BIT(1) STATIC INIT('0'B);
   DCL L FIXED BIN(15,0);
   DCL 1 BLSTR BASED(BLPTR),
     2 NBLPTR PTR,
     2 BLCMDLEN FIXED BIN(15,0),
     2 BLCMD CHAR(L REFER(BLCMDLEN)) VAR;
   DO IX = 2 TO 15 WHILE(PARY(IX)^='');
     I = INDEX(PARY(IX),'(');
     IF I < 2 × I > 8
       THEN DO; /* GET OUT IF BAD OPERAND */
         MSGDATA = 'INVALID KEYWORD OPERAND='××PARY(IX);
         RHRC = 4;
         RETURN;
         END;
     KEY = '&'××SUBSTR(PARY(IX),1,I-1);
     VAL = SUBSTR(PARY(IX),I+1,LENGTH(PARY(IX))-I-1);
     CALL #SET(GBLSW,KEY,VAL); /* CALL SET@ */
     END;
   I=#CMD('BL 0 1',RHPTR,SUBENT,RHHDRPT);
   NXTHDR->RECSTR='$CONTROL NL';
   CALL BLSET('S');
   CALL BLSET('ARUN @@@@@@@@');
   CALL BLSET('DEL ALL');
   CALL BLSET('DREM @@@@@@@@ 0 99999999 0');
   RHRC=0;
 BLSET: PROC(PRM);
   DCL PRM CHAR(*) VAR;
   L=LENGTH(PRM);
   ALLOCATE BLSTR;
   NBLPTR=BLHDR;
   BLHDR=BLPTR;
   BLCMD=PRM;
   END BLSET;
   END;

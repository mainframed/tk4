         MACRO
         MSG   &SEV,&MSG
         GBLB  &PASS2,&CONT,&PASS2A
         GBLA  &MSGNO,&CONNO
         LCLC  &NAME,&CNAME,&STR,&STRN
         LCLA  &MSGL,&INCR,&LS
         AIF   (NOT &PASS2).BYCK
         AIF   (&PASS2A).BYCKA
&PASS2A  SETB  1
&MSGNO   SETA  0
MSGS     DS    0F
         AGO   .BYCKA
.BYCK    ANOP
         AIF   (&MSGNO NE 0).BYCKA
MESSAGES CSECT
         DC    A(MSGS)
.BYCKA   ANOP
         AIF   (&PASS2).PASS2
&NAME    SETC  'MSG'.'&MSGNO'
 DC AL2(&SEV)
 DC AL2(&NAME-MSGS)
         AGO   .MENDA
.PASS2   ANOP
&INCR    SETA  &CONNO+1
&CNAME   SETC  'CON'.'&INCR'
&NAME    SETC  'CON'.'&CONNO'
         AIF   (&CONT).SETLEN
         AIF   (&MSGNO EQ 0).BYEQU
&NAME EQU 0
.BYEQU   ANOP
&NAME    SETC  'MSG'.'&MSGNO'
.SETLEN  ANOP
&MSGL    SETA  K'&MSG+2 =LENGTH(MSG TEXT) INCL HDR
&NAME DC A(&CNAME)
 DC AL2(&MSGL)
 DC AL2(0)
 DC C&MSG
&CONNO   SETA  &CONNO+1
         AIF   (&CONT).SETCONT
.MENDA   ANOP
&MSGNO   SETA  &MSGNO+1
         AGO   .MEND
.SETCONT ANOP
&CONT    SETB  0
.MEND    ANOP
         MEND

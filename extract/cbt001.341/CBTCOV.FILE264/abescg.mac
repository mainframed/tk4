 /* COPYRIGHT 1983 BY THOMAS GLEN SMITH */
 ABESCG:  PROC (RHPPTR,SUBENT) OPTIONS(REENTRANT);
 /* THIS SUBROUTINE IS CALLED WHENEVER THE SCREEN FORMAT HAS BEEN
 CHANGED.  IT WILL RESET THE SBA ADDRESSES AND FIELD LENGTHS IN
 THE DISPLAY CONTROL STRUCTURE POINTER TO BY EPPTR */
 % DCL @PROCNAME CHAR;
 % @PROCNAME = '';
 % INCLUDE ABESUB;
 % INCLUDE ABEPNL;
   DCL RHPPTR PTR;
   DCL SBACONV ENTRY;
   DCL WRKSBAB FIXED BIN(15,0),
       WRKSBA CHAR(2) DEF WRKSBAB;
   DYNPTR = RHPDYNPT;
   PNLPTR = RHPSTAPT;
   SCRSIZE=SCREENLEN*LINESIZE;
   PNLLEN = 0-SCRSIZE;
   INCNT=SCREENLEN*2-9;
   FLDCNT=INCNT+3;
   WRKSBAB,CURSBAB=LINESIZE*3+1;
   CALL SBACONV(WRKSBAB,'1'B); /* CONVERT CURSOR LOC TO TRANS CODE */
   CURSBA=WRKSBA;
   /*
   * DO FIELD1 - RULER
   */
   SFLDPTR=ADDR(FLDLOC); /* SFLDPTR=ADDR(FIELD1) - RULER */
   DFLDPTR=DYNPTR;
   DFLDADJ=DFLDADJ+DOUTOF+OUTOFF;
   DATA='';
   LEN=LINESIZE*2-2;
   /*
   * DO FIELD2 - MSG AREA
   */
   SFLDADJ=SFLDADJ+FLDLEN; /* SFLDPTR=ADDR(FIELD2) - MSG AREA */
   WRKSBAB,FLDSBAB=LINESIZE*2-1;
   CALL SBACONV(WRKSBAB,'1'B); /* CONVERT FIELD LOC TO TRANS CODE */
   FLDSBA=WRKSBA;
   DFLDPTR=DYNPTR;
   DFLDADJ=DFLDADJ+DOUTOF+OUTOFF;
   DATA='';
   LEN=LINESIZE;
   /*
   * DO FIELD3 - CMD AREA
   */
   SFLDADJ=SFLDADJ+FLDLEN; /* SFLDPTR=ADDR(FIELD3) - CMD AREA */
   WRKSBAB,FLDSBAB=LINESIZE*3;
   CALL SBACONV(WRKSBAB,'1'B); /* CONVERT FIELD LOC TO TRANS CODE */
   FLDSBA=WRKSBA;
   DFLDPTR=DYNPTR;
   DFLDADJ=DFLDADJ+DOUTOF+OUTOFF;
   DATA='';
   LEN=LINESIZE-1;
   DFLDPTR=DYNPTR;
   DFLDADJ=DFLDADJ+DINOF+INOFF;
   DATA='';
   LEN=LINESIZE-1;
   /*
   * DO FIELD4 - TAB AREA
   */
   SFLDADJ=SFLDADJ+FLDLEN; /* SFLDPTR=ADDR(FIELD4) - TAB AREA */
   WRKSBAB,FLDSBAB=LINESIZE*4;
   CALL SBACONV(WRKSBAB,'1'B); /* CONVERT FIELD LOC TO TRANS CODE */
   FLDSBA=WRKSBA;
   DFLDPTR=DYNPTR;
   DFLDADJ=DFLDADJ+DOUTOF+OUTOFF;
   DATA='';
   LEN=LINESIZE-1;
   /*
   * DO FIELD5 TO FIELDN
   */
   RHPMAXLN=0;
   I=RHPMAXSQ;
   CALL SUBENT(35)(RHPPTR,I); /* ABESQ - ADJUST REST OF SCREEN */
   END ABESCG;

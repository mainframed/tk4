 /* COPYRIGHT 1983 BY THOMAS GLEN SMITH */
 /* ABEIN - MAINLINE INITIALIZATION SUBROUTINE */
   %INCLUDE ABESUB;
 ABESUB(ABEIN) PARMS(RHHDRPT,CPPLCBUF);
   %INCLUDE ABESUBA;
   %INCLUDE ABEREC;
   DCL SETCAPS ENTRY;
   DCL (CPPLCBUF,RHPTR) PTR;
   DCL 1 CBUF BASED(CPPLCBUF),
     2 BUFLEN FIXED BIN(15,0),
     2 OFFSET FIXED BIN(15,0),
     2 BUFFER CHAR(256);
   DCL (VSAM1,VSAM2,VSAM3) FILE ENV(VSAM);
   DCL (VSAMGK1,VSAMGK2,VSAMGK3,VSAMGK4,VSAMGK5,VSAMGK6)
     FILE ENV(VSAM GENKEY);
   DCL REGONE1 FILE ENV(REGIONAL(1));
   DCL ISAM1 FILE ENV(INDEXED);
   DCL (SEQ1,SEQ2,SEQ3,SEQINTL) FILE ENV(CONSECUTIVE);
   DCL INTRDR FILE RECORD OUTPUT ENV(F BLKSIZE(80));
   DCL PDSDIR FILE RECORD INPUT ENV(F RECSIZE(256) BLKSIZE(256));
   DCL CMDBUF CHAR(256) VAR;
   RH_VSAM_1 = VSAM1;
   RH_VSAM_2 = VSAM2;
   RH_VSAM_3 = VSAM3;
   RH_VSAM_GENKEY_1 = VSAMGK1;
   RH_VSAM_GENKEY_2 = VSAMGK2;
   RH_VSAM_GENKEY_3 = VSAMGK3;
   RH_VSAM_GENKEY_4 = VSAMGK4;
   RH_VSAM_GENKEY_5 = VSAMGK5;
   RH_VSAM_GENKEY_6 = VSAMGK6;
   RH_REGIONAL_ONE_1 = REGONE1;
   RH_ISAM_1 = ISAM1;
   RH_SEQ_1=SEQ1;
   RH_SEQ_2=SEQ2;
   RH_SEQ_3=SEQ3;
   RH_SEQ_INTERNAL=SEQINTL;
   RH_SEQ_INTERNAL_RDR=INTRDR;
   RH_PDSDIR=PDSDIR;
   LSTRHEL,NXTRHEL=NULL;
   STRING(RHCFL)='0'B;
   RHECBP,RHECBW = 0;
   RHRUNSTK = NULL;
   RHRUNDCB = NULL;
   RHAIDDCB = NULL;
   RHPLOT79 = NULL;
   RHPLOT79_ENTRIES = NULL;
   RHPLOT79_SET07 = NULL;
   RHGRP    = NULL;
   RHPNLDCB = NULL;
   RHPNLHDR = NULL;
   RHRCLIM=99999999;
   RHPDSDCB=NULL;
   RHUNQNO=0;
   RH_ATNCNT=0;
     DCL ABEBAR ENTRY;
   #BARENUM=ABEBAR;
     DCL ABEALC ENTRY;
   #ABEALC=ABEALC;
     DCL ABECD ENTRY;  /* INTERFACE TO FULL-SCREEN SYSTPUT */
   #ABECD=ABECD;
     DCL ABESUBR ENTRY;
   #ABESUBR=ABESUBR;
     DCL ABE053A ENTRY;
   #ABE053A=ABE053A;
     DCL ABEDFN ENTRY;
   #ABEDFN=ABEDFN;
     DCL ABEDT ENTRY;
   #ABEDT=ABEDT;
     DCL ABEGOP ENTRY;
   #ABEGOP=ABEGOP;
     DCL ABEHOL ENTRY;
   #HOLIDAY=ABEHOL;
     DCL ABELSP ENTRY;
   #ABELSP=ABELSP;
     DCL ABELSPP ENTRY;
   #ABELSPP=ABELSPP;
     DCL ABEMKS ENTRY;
   #ABEMKS=ABEMKS;
     DCL ABEPI ENTRY;
   #ABEPI=ABEPI;
     DCL ABEPIB ENTRY;
   #ABEPIB=ABEPIB;
     DCL ABEPRS ENTRY;
   #ABEPRS = ABEPRS;
     DCL ABEPOS ENTRY;
   #ABEPOS=ABEPOS;
     DCL ABEINS ENTRY;
   #ABEINS=ABEINS;
     DCL ABESQ ENTRY;
   #ABESQ=ABESQ;
     DCL ABEST ENTRY;
   #ABESTP=ABEST;
     DCL ABESY ENTRY;
   #ABESYP=ABESY;
     DCL ABERP ENTRY;
   #ABESYLP=ABERP;
     DCL ABEAR ENTRY;  /* ADDREC */
   #ADD=ABEAR;
     DCL CALCEVA ENTRY;
   #CALCEVA=CALCEVA;
     DCL CALCEVB ENTRY;
   #CALCEVB=CALCEVB;
     DCL ABECMD ENTRY(,PTR,PTR) RETURNS(FIXED BIN(15,0));
   #CMD=ABECMD;
     DCL ABECNVT ENTRY;
   #CONVERT=ABECNVT;
     DCL ABEDBG ENTRY;  /* DB2 GET INTERFACE */
   #DB2GET = ABEDBG;
     DCL ABEDBC ENTRY;  /* DB2 STMT INTERFACE */
   #DB2COM = ABEDBC;
     DCL ABEDBP ENTRY;  /* DB2 PUT INTERFACE */
   #DB2PUT = ABEDBP;
     DCL ABEDL ENTRY;  /* DELPROC */
   #DEL = ABEDL;
     DCL EVAL ENTRY;
   #EVAL = EVAL;
     DCL ABEGETM ENTRY;
   #GET_MISSING = ABEGETM;
     DCL ABEFLOT ENTRY;
   #GETFLOAT = ABEFLOT;
     DCL ABEGS ENTRY;
   #GETSLOT = ABEGS;
     DCL ABEMD ENTRY;  /* MDPROC */
   #MD = ABEMD;
     DCL ABEMICK ENTRY;
   #MISSING = ABEMICK;
     DCL ABENC ENTRY;  /* NEWCUR */
   #NC = ABENC;
     DCL ABEPFN ENTRY;
   #PFN  = ABEPFN;
     DCL ABEPFO ENTRY; /* PANEL CONSTRUCTION  */
   #PFO  = ABEPFO;
     DCL ABE064C ENTRY;
   #PIXGET  = ABE064C;
     DCL ABE064D ENTRY;
   #PIXPUT  = ABE064D;
     DCL ABE064F ENTRY;
   #PIXGETL  = ABE064F;
     DCL ABE064G ENTRY;
   #PIXPUTL  = ABE064G;
     DCL ABE064K ENTRY;
   #PIXZERO  = ABE064K;
     DCL ABECMDP ENTRY;
   #POP=ABECMDP;
     DCL ABEPRE ENTRY;
   #PRED = ABEPRE;
     DCL ABECMDS ENTRY;
   #PUSHLIFO=ABECMDS;
     DCL ABECP ENTRY;  /* CMDBUF BREAKDOWN & STACK */
   #PUSHLILO=ABECP;
     DCL ABEPS ENTRY;  /* PUTSLOT */
   #PUTSLOT = ABEPS;
     DCL ABER ENTRY;  /* READIN */
   #READ = ABER;
     DCL ABERF ENTRY;  /* REFRESH */
   #REFRESH = ABERF;
     DCL ABEREP ENTRY;  /* REP */
   #REP = ABEREP;
     DCL ABERS ENTRY;  /* RESEQ */
   #RESEQ = ABERS;
     DCL ABELOC ENTRY;
   #RHPLOC = ABELOC;
     DCL SCRWRIT ENTRY;
   #SCRWRITE = SCRWRIT;
     DCL ABESETA ENTRY;
   #SETA,#SETA_SAVE = ABESETA;
     DCL ABESETY ENTRY;
   #SETA_CLIST = ABESETY;
     DCL ABESETC ENTRY;
   #SETC,#SETC_SAVE = ABESETC;
     DCL ABESETZ ENTRY;
   #SETC_CLIST = ABESETZ;
     DCL ABESK ENTRY;
   #SKIP = ABESK;
     DCL SPARS ENTRY;   /* KEYWORD PARSING SUBRTNE */
   #SPARS = SPARS;
     DCL ABESUC ENTRY;
   #SUCC = ABESUC;
     DCL ABESRCH ENTRY;
   #SRCH = ABESRCH;
     DCL ABESYMA ENTRY;
   #SYMA,#SYMA_SAVE = ABESYMA;
     DCL ABESYMY ENTRY;
   #SYMA_CLIST = ABESYMY;
     DCL ABESYMC ENTRY;
   #SYMC,#SYMC_SAVE = ABESYMC;
     DCL ABESYMZ ENTRY;
   #SYMC_CLIST = ABESYMZ;
     DCL ABESYCL ENTRY;
   #SYMCL,#SYMCL_SAVE = ABESYCL;
     DCL ABESYCP ENTRY;
   #SYMCL_CLIST = ABESYCP;
     DCL ABEW ENTRY;  /* WRITEOUT */
   #WRITE = ABEW;
     DCL ABEGF ENTRY;
   #GETFIELD = ABEGF;
     DCL ABECI ENTRY;
   CALL ABECI(RHHDRPT);
   CMDBUF=SUBSTR(BUFFER,1,BUFLEN-4);
   CALL SETCAPS(CMDBUF);
   RHPTR=NULL;
   I=#CMD(CMDBUF,RHPTR,RHHDRPT);
   IF I^=0 & RHPTR=NULL
     THEN SIGNAL ERROR;
   END ABEIN;

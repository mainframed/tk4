 /* COPYRIGHT 1983 BY THOMAS GLEN SMITH */
 /* ABE052 - SPLITB */
   %INCLUDE ABESUB;
 ABESUB(ABE052) CHECK(YES);
   %INCLUDE ABESUBA;
   DCL 1 LRN_STRUCTURE BASED(LRNPTR),
   %INCLUDE ABELRN;
   %INCLUDE ABELRNA;

   DCL (PREFIX,SUFFIX) ENTRY(CHAR(*), CHAR(*))
     RETURNS(FIXED BIN(15,0));
   DCL LAST FIXED BIN(31,0) INIT(99999999);
   DCL (SAVPTR,ORGPTR,SEQPTR,DELPTR) PTR;
   RHRC=0;
   MSGDATA='';
   ORGPTR = RECPTR;
   L1=RH_L1;
   L2=RH_L2;
   IF L1>L2
     THEN DO;
       I=L1;
       L1=L2;
       L2=I;
       END;
   CALL #MD(RHPTR,RHHDRPT,L1);  /* CALL MDPROC */
   SEQPTR=RECPTR;
   DO WHILE(RECSEQ <= L2) UNTIL(RECPTR = HDPTR);
     IF RECSTR=''
       THEN DO;
         IF SEQPTR=RECPTR
           THEN SEQPTR=LSTPTR;
         IF ORGPTR=RECPTR
           THEN ORGPTR=LSTPTR;
         DELPTR=RECPTR;
         RECPTR=LSTPTR;
         CALL #PUTSLOT(RHPTR,RHHDRPT,DELPTR);
         END;
       ELSE DO;
         RECSTR=SUBSTR(RECSTR,PREFIX(RECSTR,' '));
         RECSTR=SUBSTR(RECSTR,1,SUFFIX(RECSTR,' '));
         J=INDEX(RECSTR,' ');
         IF J^=0
           THEN DO;
             BUF=SUBSTR(RECSTR,J);
             RECSTR=SUBSTR(RECSTR,1,J-1);
             SEQ=-1;
             CALL #ADD(RHPTR,RHHDRPT,RECPTR,SAVPTR,SEQ,BUF,0);
             SAVPTR->RECSEQ=RECPTR->RECSEQ;
             END;
         END;
     RECPTR = NXTPTR;
     END;
   RECPTR = ORGPTR;
   CALL #RESEQ(RHPTR,RHHDRPT,SEQPTR,'NOSAVE','NORENUM',LAST);
   CALL #NC(RHPTR,ORGPTR); /* CALL ABENC */
   RHRC = 0;
   END ABE052;

 /*
0*$.HE ISD GENERALIZED SUBROUTINES - PSFCODE
0*$.HE PRINT SERVICES FACILITY STRUCTURED FIELD CODES
0*$.PL 55
0*$.PN 0
0*$.PA
0*$.SS
0*$.NF
0*$10/15/75
0*$AUTHOR:  T. SMITH
0*$SOURCE MODULE NAME:  PSFCODE
0*$DOCUMENTATION ID:  0*$
0*$.FI L
0*$.SP 5
0*$THIS FUNCTION RETURNS THE 3-BYTE CODE IDENTIFYING A STRUCTURED
0*$FIELD TO PRINT SERVICES FACILITY GIVEN A 3-BYTE MNEMONIC, E.G.
0*$PSFCODE('BAG') RETURNS X'D3A8C9', WHICH IS THE CODE IDENTIFYING
0*$THE "BEGIN ACTIVE ENVIRONMENT GROUP" STRUCTURED FIELD.  SEE
0*$"PRINT SERVICES FACILITY DATA STREAM REFERENCE FOR MVS AND VSE"
0*$SH35-0073.
0*$.SP 1
0*$CALL FORMAT IS AS FOLLOWS:
0*$.SP 1
0*$.NF
0*$.IN 10
0*$DCL PSFCODE ENTRY(CHAR(3)) RETURNS(CHAR(3));
0*$DCL CODE CHAR(3);
0*$CODE=PSFCODE('BAG');
 */
 PSFCODE: PROC(PARM) OPTIONS(REENTRANT) RETURNS(CHAR(3));
   DCL PARM CHAR(3);
   %INCLUDE @HEXCHAR;
   DCL TABLE(72,2) CHAR(3) STATIC INIT(
     'BAG',@HEXCHAR(D3A8C9),
     'BCF',@HEXCHAR(D9A88A),
     'BCP',@HEXCHAR(D3A887),
     'BCT',@HEXCHAR(D3A89B),
     'BDG',@HEXCHAR(D3A8C4),
     'BDM',@HEXCHAR(D3A8CA),
     'BDT',@HEXCHAR(D3A8A8),
     'BDX',@HEXCHAR(D3A8E3),
     'BFG',@HEXCHAR(D3A8C5),
     'BFM',@HEXCHAR(D3A8CD),
     'BFN',@HEXCHAR(D3A889),
     'BIM',@HEXCHAR(D3A87B),
     'BMM',@HEXCHAR(D3A8CC),
     'BMO',@HEXCHAR(D3A8DF),
     'BPG',@HEXCHAR(D3A8AF),
     'BPM',@HEXCHAR(D3A8CB),
     'BPS',@HEXCHAR(D3A85F),
     'CFC',@HEXCHAR(D3A78A),
     'CFI',@HEXCHAR(D38C8A),
     'CPC',@HEXCHAR(D3A787),
     'CPD',@HEXCHAR(D3A687),
     'CPI',@HEXCHAR(D38C87),
     'CTC',@HEXCHAR(D3A79B),
     'CTD',@HEXCHAR(D3A69B),
     'CTX',@HEXCHAR(D3EE9B),
     'DXD',@HEXCHAR(D3A6E3),
     'EAG',@HEXCHAR(D3A9C9),
     'ECF',@HEXCHAR(D3A98A),
     'ECP',@HEXCHAR(D3A987),
     'ECT',@HEXCHAR(D3A99B),
     'EDG',@HEXCHAR(D3A9C4),
     'EDM',@HEXCHAR(D3A9CA),
     'EDT',@HEXCHAR(D3A9A8),
     'EDX',@HEXCHAR(D3A9E3),
     'EFG',@HEXCHAR(D3A9C5),
     'EFM',@HEXCHAR(D3A9CD),
     'EFN',@HEXCHAR(D3A989),
     'EIM',@HEXCHAR(D3A97B),
     'EMM',@HEXCHAR(D3A9CC),
     'EMO',@HEXCHAR(D3A9DF),
     'EPG',@HEXCHAR(D3A9AF),
     'EPM',@HEXCHAR(D3A9CB),
     'EPS',@HEXCHAR(D3A95F),
     'FDS',@HEXCHAR(D3AAEC),
     'FDX',@HEXCHAR(D3EEEC),
     'FGD',@HEXCHAR(D3A6C5),
     'FNC',@HEXCHAR(D3A789),
     'FND',@HEXCHAR(D3A689),
     'FNG',@HEXCHAR(D3EE89),
     'FNI',@HEXCHAR(D38C89),
     'FNM',@HEXCHAR(D3A289),
     'FNO',@HEXCHAR(D3AE89),
     'FNP',@HEXCHAR(D3AC89),
     'ICP',@HEXCHAR(D3AC7B),
     'IDM',@HEXCHAR(D3ABCZ),
     'IID',@HEXCHAR(D3A67B),
     'IMM',@HEXCHAR(D3ABCC),
     'IOC',@HEXCHAR(D3A77B),
     'IPS',@HEXCHAR(D3AF5F),
     'IRD',@HEXCHAR(D3EE7B),
     'LNC',@HEXCHAR(D3AAE7),
     'LND',@HEXCHAR(D3A6E7),
     'MCC',@HEXCHAR(D3A288),
     'MCF',@HEXCHAR(D3B18A),
     'MDD',@HEXCHAR(D3A688),
     'MMC',@HEXCHAR(D3A788),
     'MMO',@HEXCHAR(D3B1DF),
     'MPS',@HEXCHAR(D3B15F),
     'MSU',@HEXCHAR(D3ABEA),
     'NOP',@HEXCHAR(D3EEEE),
     'PGD',@HEXCHAR(D3A6AF),
     'PGP',@HEXCHAR(D3ACAF));

   I=1;
   J=HBOUND(TABLE,1);
   DO WHILE(J>=I);
     K=(J-I+1)/2+I; /* K=MIDPOINT */
     SELECT;
       WHEN(TABLE(K,1)=PARM) RETURN(TABLE(K,2));
       WHEN(TABLE(K,1)<PARM) I=K+1;
       OTHERWISE J=K-1;
       END; /* SELECT */
     END;
   RETURN('   '); /* NOT FOUND */
   END PSFCODE;

 STRTRK: PROC OPTIONS(MAIN) ;
 DCL(G(10,10),Q(10,10),NN(3),MAP(10,10),BOMB(4,2)) FIXED BINARY(15);
  DCL TTT(12) FIXED BINARY(15) INIT(0,3,3,6,1,4,6,2,5,0,3,5);
  DCL Q$(0:10) CHAR(2)INIT(' .',' E',' K',' B',' *',' Q',' C',' .',' T',
 'XX',' B');
 DCL (D(8),K(10,3),C(4,2)) FLOAT EXTERNAL;
 DCL (A$,C$,F$,M$,N$,P$,S$,V$,X$,Z$) CHAR(15);
  DCL SMLL CHAR(26) INIT('abcdefghijklmnopqrstuvwxyz');
  DCL CAPS CHAR(26) INIT('ABCDEFGHIJKLMNOPQRSTUVWXYZ');
 DCL (TIME,DATE,ONSOURCE) BUILTIN;
   DCL ISEED FIXED BINARY(31) EXTERNAL;
 ON CONVERSION BEGIN;
  IF ONSOURCE='SPOCK1' THEN DO;ONSOURCE='0     ';V=1;GOTO #270; END;
  IF ONSOURCE='SPOCK2' THEN DO;ONSOURCE='0     ';V=2;GOTO #270; END;
  PUT SKIP LIST('THAT''S NOT A NUMBER!!');
  PUT SKIP LIST('I''LL GIVE YOU ANOTHER CHANCE.');ONSOURCE='0     ';
   ENDD: GOTO #2680; END;
 V$=TIME;DO I=1 TO 3;SUBSTR(V$,I,1)=SUBSTR(V$,9-I,1); END;
 GET STRING(V$) EDIT(ISEED)(F(9));
 PUT SKIP LIST('OUR FEE OF .25 HAS BEEN DEDUCTED FROM YOUR ACCOUNT.');
 PUT SKIP LIST('************   S T A R    T R E K   *************');
 PUT SKIP LIST(' ') ;
 PUT SKIP LIST('**********  VER. PLI.6  --  30 AUG 76  **********');
  CALL  #13180 ;
 PUT SKIP LIST( 'BE CAREFUL AND HAVE A GOOD TIME.');
 PUT SKIP LIST('PLEASE, IF THERE ARE OTHERS WAITING ON THIS TERMINAL,');
 PUT SKIP LIST('TERMINATE THE GAME AND RELEASE THE TERMINAL.');
 PUT SKIP LIST('DO NOT CAUSE THIS GAME TO BE REMOVED FROM THE SYSTEM.');
 PUT SKIP LIST('PLEASE REPORT ANY BUGS IN THIS PROGRAM TO "JRBANE"');
 PUT SKIP LIST('USING THE SEND COMMAND.  IF WE NEED MORE INFORMATION');
 PUT SKIP LIST('WE WILL CONTACT YOU.');
 PUT SKIP LIST(' ');
  #200:  PUT SKIP LIST('   TO PLAY SHORT VERSION, TYPE 1 ---');
 PUT SKIP LIST('   TO PLAY REGULAR VERSION, TYPE 2:');
  GET LIST(V);
 IF V=1 THEN GOTO  TIMECK;
 IF V=2 THEN GOTO  TIMECK;
 PUT SKIP LIST(' ') ;
 GOTO  #200 ;
  TIMECK: V$=TIME; GET STRING(V$) EDIT(IHOUR) (F(2));
  V$=DATE; GET STRING(V$) EDIT(Y,M,DAY) (F(2),F(2),F(2));
  Y = Y +1900;
  I1=TRUNC((Y-1500)/100); A=I1*5 + (I1+3)/4;
  I2 = TRUNC(A-TRUNC(A/7)*7);
  Y3 = TRUNC(Y-TRUNC(Y/100)*100);
  A = Y3/4 + Y3 + DAY + TTT(M) + I2;
  B = TRUNC(A-TRUNC(A/7)*7)+1;
  IF M>2 THEN GOTO ##470;
  IF Y3 = 0 THEN GOTO ##440;
  IF TRUNC(Y-TRUNC(Y/4)*4)^=0 THEN GOTO ##400;
  ##400: IF B=0 THEN B=6; B=B-1; GOTO ##470;
  ##440: A = I1-1;
  IF TRUNC(A-TRUNC(A/4)*4)=0 THEN GOTO ##400;
  ##470: IF B=0 THEN B=7;
  IF B=1 × B=7 THEN GOTO #270;
  IF IHOUR < 10 × IHOUR > 14 THEN GOTO #270;
  PUT SKIP LIST('BOTH THE CREATORS OF THIS PROGRAM AND SYSTEMS');
  PUT SKIP LIST('FORBID ITS USE BETWEEN THE HOURS OF 10 AND 3');
  PUT SKIP LIST('MONDAY THROUGH FRIDAY (PEAK TSO USE HOURS).');
  PUT SKIP LIST('PLEASE TRY AGAIN LATER DURING OFF-PEAK HOURS.');
  PUT SKIP LIST(' ');
  PUT SKIP LIST('                    BOBBY BANE AND WEAT MATTIS');
  STOP; /* PROGRAM HALTS HERE IF TIME IS WRONG */
  #270:  /*  INITIALIZER  */;
  M1=1 ; TH=1; MAP=0; THNUM=0;RID=0; BOMB=0; IB=0;FF1=1;FF2=1;
  E0=3000 ;
  E=3000 ;
  P0=13 ;
  P=13 ;
  R9=TRUNC(3*RND)+1; R8=0;
  S9=200 ;
  Q1=TRUNC(RND*10+1) ;
  Q2=TRUNC(RND*10+1) ;
  F=1 ;
  T0=TRUNC(RND*50+20)*100 ;
  T=T0 ;
  T9=28+TRUNC(RND*11) ;
 D=0;
  S1=TRUNC(RND*10+1) ;
  S2=TRUNC(RND*10+1) ;
  B9=0 ;
   E4,W3,C5=0 ;
   Z$ = 'DOWN' ;
  A9=3000 ;
  K9=0 ;
  C=0 ;
  DO I=1 TO 10 ;
  DO J=1 TO 10 ;
 B3=0;
  R=RND*100 ;
  IF V=2 THEN GOTO  #760 ;
  T9=12+TRUNC(RND*11) ;
  K3=4;
  IF R > .78 THEN K3=3 ;
  IF R > 2.00 THEN K3=2 ;
  IF R > 5.28  THEN K3=1;
  IF R > 9.28 THEN K3=0 ;
  K9=K9+K3 ;
  GOTO  #1100 ;
  #760: /*DETERMINE KLINGONS, BASES AND STARS*/;
  K3=9;
  IF R > .10 THEN K3=8 ;
  IF R > .25 THEN K3=7 ;
  IF R > .50 THEN K3=6 ;
  IF R > 1.00 THEN K3=5 ;
  IF R > 1.50 THEN K3=4 ;
  IF R > 3.00 THEN K3=3 ;
  IF R > 6.28 THEN K3=2;
  IF R > 9.00 THEN K3=1;
  IF R > 14.28 THEN K3=0;
  K9=K9+K3 ;
 IF RND >.97 THEN DO;
 B3=1; B9=B9+1; END;
  #1100: S3=TRUNC(RND*8+1) ;
  G(I,J)=K3*100+B3*10+S3 ;
  IF RND >.95 & IB <5 THEN DO;
   BOMB(IB,1) = I; BOMB(IB,2) = J;
   IB = IB + 1; END;
  END ;
   END ;
  K0=K9 ;
  IF B9=0 THEN DO;
  I=TRUNC(RND*10+1) ;
  J=TRUNC(RND*10+1) ;
  G(I,J)=G(I,J)+10 ;
  B9=1 ;END;
 #1220:   P2=1 ;
 PUT SKIP LIST(' ') ;
 PUT SKIP LIST('   PLEASE TYPE A SECRET PASSWORD:');
   GET EDIT(X$) (COL(1),A(15)); X$=TRANSLATE(X$,CAPS,SMLL);
 PUT SKIP LIST(' ') ;
  N1,N9,N7,A7=0 ;
  DO I=1 TO TRUNC(RND*5) ;
  R1=TRUNC(RND*10+1) ;
  R2=TRUNC(RND*10+1) ;
  C(I,1)=R1 ;
  C(I,2)=R2 ;
  G(R1,R2)=G(R1,R2)+100 ;
  K9=K9+1 ;
  K0=K9 ;
   END ;
  H1=0 ;
  H2=TRUNC(RND*5) ;
 PUT SKIP LIST(' ') ;
 PUT EDIT('ORDERS=  STARDATE = ',T)(COL(1),A,F(6,1));
 PUT SKIP LIST(' ') ;
 PUT SKIP LIST(' AS COMMANDER OF THE FEDERATION STARSHIP ENTERPRISE,');
 PUT SKIP LIST('YOUR MISSION IS TO RID THE GALAXY OF THE DEADLY');
 PUT SKIP LIST('KLINGON MENACE.  TO DO THIS, YOU MUST DESTROY THE');
 PUT EDIT('KLINGON INVASION FORCE OF ',K9,' BATTLE CRUISERS.')
  (COL(1),A,F(2),A);
 PUT SKIP LIST('YOU WILL ALSO BE HARASSED BY ROMULANS AND THOLIANS.');
 PUT EDIT('YOU HAVE ',T9,' SOLAR YEARS TO COMPLETE YOUR MISSION.')
 (COL(1),A,F(2),A) ;
 PUT EDIT('(I.E. UNTIL STARDATE ',T0+T9,').')
 (COL(1),A,F(6,1),A) ;
 PUT SKIP LIST(' ') ;
  IF B9 = 1 THEN
 PUT SKIP LIST('       YOU WILL HAVE ONE SUPPORTING STARBASE.');
  ELSE
 PUT EDIT('     YOU WILL HAVE ',B9,' SUPPORTING STARBASES.')
 (COL(1),A,F(2),A) ;
 PUT SKIP LIST('WHEN THE ENTERPRISE DOCKS AT ONE (IS POSITIONED');
 PUT SKIP LIST('NEXT TO ONE) IT IS RESUPPLIED WITH ENERGY AND');
 PUT SKIP LIST('PHOTON TORPEDOES.') ;
 PUT EDIT('THE ENTERPRISE IS CURRENTLY IN QUADRANT ',Q1,'-',Q2)
 (COL(1),A,F(2),A,F(2)) ;
 PUT EDIT('SECTOR ',S1,'-',S2)(COL(40),A,F(2),A,F(2));
 #12980: PUT SKIP LIST('DO YOU NEED FURTHER INSTRUCTIONS:');
   GET EDIT(A$) (COL(1),A(15)); A$=TRANSLATE(A$,CAPS,SMLL);
 IF A$ = 'NO' THEN GOTO #1420;
 IF A$ ^= 'YES' THEN GOTO #12980;
  PUT SKIP LIST('TO GET A COPY OF THE INSTRUCTIONS FOR THIS');
  PUT SKIP LIST('GAME, TYPE "SCHED ''ECE01.SOURCE(RULES)''".');
  PUT SKIP LIST('THIS WILL PUT A COPY OF THE RULES OUT ON THE');
  PUT SKIP LIST('LINE PRINTER AT MARTIN.  PLEASE READ THEM IN');
  PUT SKIP LIST('FULL BEFORE YOU TRY TO PLAY AGAIN.');
 PUT SKIP LIST('THEN RERUN THIS PROGRAM, ANSWERING THE INST.');
 PUT SKIP LIST('QUESTION WITH A ''NO''.');
  STOP;
 #1420:  /*SET UP QUADRANT*/ ;
  Q=0; /* ZORCH QUADRANT */
  K3,B3,S3=0 ;
  X=G(Q1,Q2)/100 ;
  K3=TRUNC(X) ;
  IF K3 > 3 THEN DO;
  P4=5 ;
  CALL  #11950 ;END;
  B3=TRUNC((X-K3+.01)*10.0) ;
 S3=G(Q1,Q2)-10*B3-100*K3 ;
 K=0 ;
  IF R8=1 THEN DO; Q(RX,RY)=7; GOTO #1560; END;
   IF R9<=0 THEN GOTO #1560;
  IF RND< .9 THEN GOTO #1560;
    #15: CALL #12740; IF R1=S1 & R2=S2 THEN GOTO #15;
   Q(R1,R2)=7;
  R8=1;RX=R1;RY=R2;
   P4=12;
    CALL #11950;
  #1560: IF G(Q1,Q2)<10 & R8=0 & RND < .1 & TH=1  THEN DO;
  TH=0;S1=TRUNC(2+8*RND);S2=TRUNC(2+8*RND); DO I=1 TO S3;
  RELOOP: CALL #12740; IF ABS(S1-R1)<2 × ABS(S2-R2)<2 THEN GOTO RELOOP;
  Q(R1,R2)=4; END;  DO I=1 TO 3;
  RELP: CALL #12740; IF ABS(S1-R1)<2 × ABS(S2-R2)<2 THEN GOTO RELP;
  Q(R1,R2)=8;END;THNUM=3;WS=0;IF N1^=1 THEN Q(S1,S2)=5;Q(S1,S2)=1;GOTO
  #1; END;
  IF N1=1 THEN Q(S1,S2)=5;
  ELSE Q(S1,S2)=1;
  DO I=1 TO K3 ;
  CALL  #12740 ;
  Q(R1,R2)=2 ;
  K(I,1)=R1 ;
  K(I,2)=R2 ;
  K(I,3)=S9 ;
   END ;
  DO I=1 TO 4 ;
  IF Q1=C(I,1) & Q2=C(I,2) THEN DO;
  K(K3,3)=600 ;
  Q(R1,R2)=6 ;END;
  END ;
 IF B3^=0 THEN DO;
  CALL #12740; Q(R1,R2)=3; END;
 DO I=1 TO S3 ;
  CALL   #12740 ;
  Q(R1,R2)=4 ;
   END ;
 #1: A=-1;
  DO I = 1 TO 4;
   IF BOMB(I,1)=Q1 & BOMB(I,2)=Q2 THEN DO;
     CALL #12740; Q(R1,R2) = 10; END; END;
  IF K3>0 & K3 < 4 THEN DO;
  P4=6;
  CALL #11950;END;
  IF P2=1 THEN GOTO  #1910 ;
  CALL  #6460 ;
  IF E<=0 THEN GOTO  #6890 ;
  GOTO  #2640 ;
 #1910:  /*SHORT RANGE SCAN*/ ;
  IF P2=1 THEN DO;
  P4=8;IF Q1=10 & (Q2=9 × Q2=10) THEN DO;
  IF Q2=9 THEN MAP(10,10)=0; ELSE MAP(10,9)=0; END;
  MAP(10,9)=0; MAP(10,10)=0;
  CALL  #11950 ;END;
  P2=P2+1 ;
   T8=S1-1 ;
   U=S1+1 ;
   M=S2-1 ;
   N=S2+1 ;
  IF T8<1 THEN T8=1;
  IF U>10 THEN U=10;
  IF M<1 THEN M=1;
  IF N>10 THEN N=10;
  DO I=T8 TO U ;
  DO J=M TO N ;
 IF Q(I,J)=10 THEN DO;
 PUT SKIP LIST('*** KLINGON MINE DISGUISED AS STARBASE EXPLODES ***');
 GO TO #6890; END;
  IF Q(I,J) ^=3 THEN GOTO #2140;
  C$='DOCKED' ;
  CALL  #10310 ;
  GOTO  #2230 ;
 #2140:     END ;
  END ;
  IF K3>0 × R8=1 × THNUM > 0 THEN GOTO  #2200 ;
  IF E<E0*.1 THEN GOTO  #2220 ;
  C$='GREEN' ;
  GOTO  #2230 ;
 #2200:  C$='RED' ;
  GOTO  #2230 ;
 #2220:  C$='YELLOW' ;
  #2230: IF E<=0 THEN GOTO  #6890 ;
  IF RID=1 THEN DO; C$='RIDICULOUS'; RID=0; END;
  IF D(2) >= 0 THEN GOTO  #2310 ;
 PUT SKIP LIST('SHORT RANGE SENSORS ARE OUT ');
 PUT SKIP LIST(' ') ;
  GOTO  #2640 ;
 #2310: PUT SKIP LIST('----------------------'); MAP(Q1,Q2)=G(Q1,Q2);
  DO I=1 TO 10 ;
  PUT EDIT((Q$(Q(I,J)) DO J=1 TO 10),'   ')(COL(1),10 A,A);
  IF I=1 THEN
 PUT EDIT('STARDATE            ',T)
  (A,F(6,1)) ;
 IF I=2 THEN
 PUT EDIT('CONDITION           ',C$)
  (A,A) ;
 IF I=3 THEN
 PUT EDIT('QUADRANT            ',Q1,'-',Q2)
  (A,F(2),A,F(2)) ;
 IF I=4 THEN
 PUT EDIT('SECTOR              ',S1,'-',S2)
  (A,F(2),A,F(2)) ;
 IF I=5 THEN
 PUT EDIT('ENERGY      ',E)
  (A,F(6,1)) ;
 IF I=6 THEN
 PUT EDIT('PHOTON TORPEDOES ',P)
  (A,F(2)) ;
 IF I=7 THEN
 PUT EDIT('KLINGONS LEFT    ',K9)
  (A,F(2)) ;
 IF I=8 THEN
  PUT EDIT('ROMULANS LEFT    ',R9) (A,F(2));
 IF I=9 THEN
  PUT EDIT('ENERGY SHIELDS   ',Z$,'-',A9) (A,A,A,F(6,1));
 END;
  PUT SKIP LIST('----------------------');
 #2640: IF N9^=1 THEN GOTO #2680;
  CALL  #10830 ;
  IF N7=1 THEN GOTO  #5950 ;
  N9=2 ;
 #2680: PUT SKIP LIST('COMMAND:') ;
   GET LIST(A) ;
  IF C$='DOCKED' THEN CALL #10310;
  GOTO  #8470 ;
 #2730: PUT SKIP LIST(' ') ;
 PUT SKIP LIST('   0 = SET COURSE') ;
 PUT SKIP LIST('   1 = SHORT RANGE SENSOR SCAN');
 PUT SKIP LIST('   2 = LONG RANGE SENSOR SCAN');
 PUT SKIP LIST('   3 = FIRE PHASERS');
 PUT SKIP LIST('   4 = FIRE PHOTON TORPEDOES');
 PUT SKIP LIST('   5 = DAMAGE CONTROL REPORT');
 PUT SKIP LIST('   6 = SELF-DESTRUCT');
 PUT SKIP LIST('   7 = ABANDON SHIP');
 PUT SKIP LIST('   8 = ACTIVATE ENERGY SHIELDS');
 PUT SKIP LIST('   9 = DEACTIVATE ENERGY SHIELDS');
 PUT SKIP LIST('  10 = FIRE EXPERIMENTAL DEATH RAY');
 PUT SKIP LIST('  11 = ACTIVATE TELEPORTATION UNIT');
 PUT SKIP LIST('  12 = ENGAGE IMPULSE ENGINES');
 PUT SKIP LIST('  13 = MAINTAIN POSITION');
 PUT SKIP LIST('  14 = NAVIGATION COMPUTER');
  PUT SKIP LIST('  15 = CUMULATIVE STAR MAP');
 PUT SKIP LIST(' ') ;
  GOTO  #2640 ;
 #2910:  /*WARP DRIVE*/ ;
  IF THNUM > 0 THEN DO;
  PUT SKIP LIST('THOLIAN TRACTORS DISABLE WARP DRIVE'); GOTO #2680; END;
  C$='MOVING' ;
 #2930: PUT SKIP LIST('COURSE (IN DEGREES):');
   GET LIST(C1) ;
  IF C1>= 360 × C1 <0 THEN GOTO  #2640 ;
 PUT SKIP LIST('WARP FACTOR (0-15):');
   GET LIST(W1) ;
  IF W1<0 THEN GOTO  #2680 ;
  IF W1>15 THEN GOTO  #2680 ;
  IF W1>.25 & D(1)<0 THEN DO ;
 PUT SKIP LIST('WARP ENGINES ARE DAMAGED, MAXIMUM SPEED = WARP .25');
  GOTO  #2930 ;END;
  #9700: IF RND>W1 THEN GOTO  #10040 ;
  IF V=2 THEN GOTO  #9750 ;
  IF RND>.15 THEN GOTO  #10040 ;
  GOTO  #9760 ;
 #9750:  IF RND>.10 THEN GOTO  #10040;
 #9760:  Z3=TRUNC(RND*10+1) ;
  Z4=TRUNC(RND*10+1) ;
  IF G(Z3,Z4)>999 THEN GOTO  #10040 ;
  S4=G(Z3,Z4)-TRUNC(G(Z3,Z4)*.1)*10 ;
  IF S4<=0 THEN GOTO  #10040 ;
 PUT SKIP LIST(' ') ;
 PUT SKIP LIST('*************************************************'
  ) ;
 PUT EDIT('******** SUPERNOVA IN QUADRANT ',Z3,'-',Z4,' ************')
  (COL(1),A,F(2),A,F(2),A) ; MAP(Z3,Z4)=1000;
 PUT SKIP LIST('ALL MATTER IN THIS QUADRANT CONVERTED TO ENERGY.');
  IF Q1^=Z3 THEN GOTO  #9930 ;
  IF Q2^=Z4 THEN GOTO  #9930 ;
 PUT SKIP LIST(' ') ;
  CALL  #10750 ;
 PUT EDIT('UNFORTUNATELY, ',N$,' WAS IN THIS QUADRANT.')
  (COL(1),A,A,A) ;
  P4=7 ;
  CALL  #11950 ;
  GOTO  #5950 ;
 #9930:PUT SKIP LIST('FROM NOW ON, ANY VESSEL STOPPING IN THIS QUADRANT'
  ) ;
 PUT SKIP LIST('WILL BE TOTALLY ENERGIZED.');
 PUT SKIP LIST('*************************************************'
  ) ;
 PUT SKIP LIST(' ') ;
  K4=TRUNC(G(Z3,Z4)/99.99) ;
  B4=TRUNC((G(Z3,Z4)/99.99-K4)*10.0);
  B9=B9-B4 ;
  K9=K9-K4 ;
  IF K9<=0 THEN GOTO  #7020 ;
  G(Z3,Z4)=TRUNC(1000.0) ;
  CALL  #12170 ;
 #10040:  /*KLINGON TRACTORS*/ ;
  IF RND>.12 THEN GOTO  #10240 ;
  DO I=1 TO 4 ;
  IF C(I,1)<0.5 THEN GOTO  #10230 ;
  Q1=C(I,1) ;
  Q2=C(I,2) ;
  S1=TRUNC(RND*10+1) ;
  S2=TRUNC(RND*10+1) ;
 PUT SKIP LIST(' ') ;
 PUT EDIT(N$,' CAUGHT IN MAGNETIC TRACTOR BEAM.')(COL(1),A,A);
 PUT SKIP LIST(' ') ;
  T=T+.5 ; THNUM=0;
  W9=RND ;
  DO J=1 TO 8 ;
  D(J)=D(J)+1 ;
  IF D(J)<=0 THEN GOTO  #10210 ;
  D(J)=0 ;
 #10210:   END ;
  GOTO  #1420 ;
 #10230: END;
 #10240: E=E-W1*C5/4-C5/4 ;
  IF E<=0 THEN GOTO  #6890 ;
  IF W1<.2 THEN W9=RND;
  IF W1=15 THEN GOTO  #5790 ;
 #3120:  /*CONTINUE*/ ;
  CALL  #6460 ;
  IF N9=1 THEN GOTO  #2640 ;
  IF E<100.0 THEN DO;
  P4=11 ;
  CALL  #11950 ;END;
  IF E<=0 THEN GOTO  #6950 ;
  IF RND < .05 THEN DO; P4=TRUNC(1+4*RND); CALL #11950; END;
  DO I=1 TO 8 ;
  IF D(I)=0 THEN GOTO  #3390 ;
  D(I)=D(I)+W1/2 ;
  IF D(I)<0 THEN GOTO  #3390 ;
  D(I)=0 ;
 #3390:   END ;
  IF RND>.20 THEN GOTO  #3690 ;
  R1=TRUNC(RND*8+1) ;
  IF RND>.5 THEN GOTO  #3540 ;
  IF RND>.5 THEN GOTO  #3690 ;
  D(R1)=D(R1)-(RND*5+1) ;
 CALL  #7550 ;
  P4=TRUNC(13 + 6*RND); CALL #11950;
 PUT EDIT('*** ',F$,' DAMAGED ***')(COL(1),A,A,A);
  IF F$^='ENERGY SHIELDS' THEN GOTO  #3690;
  C5=0 ;
 PUT SKIP LIST('*** ENERGY SHIELDS ARE DOWN ***');
  Z$='DOWN' ;
  GOTO  #3690 ;
 #3540:  DO I=R1 TO 8 ;
  IF D(I)<0 THEN GOTO  #3610 ;
   END ;
  DO I=1 TO R1-1 ;
  IF D(I)<0 THEN GOTO  #3610 ;
   END ;
  GOTO  #3690 ;
 #3610:  R1=I ;
  D(I)=D(I)+RND*5+1 ;
  IF D(I)<=0 THEN GOTO  #3650 ;
  D(I)=0 ;
 #3650: CALL  #7550 ;P4=TRUNC(19+6*RND); CALL #11950;
 PUT EDIT('*** ',F$,' STATE OF REPAIR IMPROVED ***')(COL(1),A,A,A);
 #3690:  N=TRUNC(W1*10+.00001) ;
  T=T+(.20*W1) ;
  E=E-2*N ;
  Q(S1,S2)=0 ;
  X=S1 ;
  Y=S2 ;
  IF T>T0+T9 THEN GOTO  #6890 ;
  CALL  #5760 ;
  DO I=1 TO N ;
  S1=S1+X1 ;
  S2=S2+X2 ;
  X3=TRUNC(S1+.5) ;
  Y3=TRUNC(S2+.5) ;
  IF S1<.5 THEN GOTO  #4060 ;
  IF S2<.5 THEN GOTO  #4060 ;
  IF S1>=10.5 THEN GOTO  #4060 ;
  IF S2>=10.5 THEN GOTO  #4060 ;
  IF Q(X3,Y3)^=0 THEN GOTO  #3890 ;
   END ;
  GOTO  #4020 ;
 #3890:   Z5=Q(X3,Y3) ;
  IF Z5=6 THEN DO;
  Z3=Q1 ;
  Z4=Q2 ;
  CALL  #12170 ;
  GOTO  #7930 ;END;
 #3950:  IF Z5=2 THEN GOTO  #7930 ;
  IF Z5=7 THEN DO; Q(S1,S2)=0; R9=R9-1; R8=0; S1=X3;S2=Y3;FF1=FF1+.25;
  Q(S1,S2)=A5; DO I=1 TO 8; D(I)=D(I)-4*RND-1;END;Z$='DOWN';
  C5=0; E=E-500; IF E<=0 THEN GOTO #6950; CALL #10750;
  PUT EDIT(N$,' RAMS ROMULAN AT SECTOR ',S1,'-',S2)
     (COL(1),A,A,F(2),A,F(2)); A=2;
  GOTO #6260; END;
  PUT SKIP LIST(' ') ;
  CALL  #10750 ;
 PUT EDIT(N$,' SMACKS INTO OBJECT AT SECTOR ',S1,'-',S2)
  (COL(1),A,A,F(2),A,F(2)) ;
  S1=S1-X1 ;
  S2=S2-X2 ;
 #4020:  S1=TRUNC(S1+.5) ;
  S2=TRUNC(S2+.5) ;
  Q(S1,S2)=A5 ;
  GOTO  #2640 ;
 #4060: MAP(Q1,Q2)=G(Q1,Q2); Q1=TRUNC(Q1+W1*X1+(X-.5)/10);
  Q2=TRUNC(Q2+W1*X2+(Y-.5)/10) ;
  IF Q1>=1 THEN GOTO  #4110 ;
  Q1=1 ;
  Z2=1 ;
 #4110:  IF Q1<=10 THEN GOTO  #4140 ;
  Q1=10 ;
  Z2=1 ;
 #4140:  IF Q2>=1 THEN GOTO  #4170 ;
  Q2=1 ;
  Z2=1 ;
 #4170:  IF Q2<=10 THEN GOTO  #4200 ;
  Q2=10 ;
  Z2=1 ;
 #4200:  IF Z2^=1 THEN GOTO  #4220 ;
  IF F>2 THEN GOTO  #12690 ;
  PUT SKIP LIST('************************************************');
  PUT SKIP LIST('***   FOOLISH MORTAL!                        ***');
  PUT SKIP LIST('***       YOU HAVE ATTEMPTED TO VENTURE OUT  ***');
  PUT SKIP LIST('***   OF THE GALAXY INTO SUBSPACE.  ON THE   ***');
  PUT SKIP LIST('***   THIRD TIME YOU TRY THIS, ZIMBULA WILL  ***');
  PUT SKIP LIST('***   DESTROY YOU!                           ***');
  PUT SKIP LIST('***                    LOVE AND KISSES,      ***');
  PUT SKIP LIST('***                    ZIMBULA               ***');
  PUT SKIP LIST('************************************************');
  PUT SKIP LIST(' ');
  F=F+1 ;
  GOTO  #4220 ;
 #12690: PUT SKIP LIST(' ');
  PUT SKIP LIST('***********************************************');
  PUT SKIP LIST('***   DEAR CAPTAIN;                         ***');
  PUT SKIP LIST('***       SINCE YOU HAVE CHOSEN TO IGNORE   ***');
  PUT SKIP LIST('***   MY INITIAL WARNINGS,  YOU HAVE SHOWN  ***');
  PUT SKIP LIST('***   THAT YOU ARE NOT MENTALLY COMPETENT   ***');
  PUT SKIP LIST('***   TO PILOT A STARSHIP.  I WILL REMEDY   ***');
  PUT SKIP LIST('***   THAT SITUATION IMMEDIATELY.           ***');
  PUT SKIP LIST('***                    GOODBYE,             ***');
  PUT SKIP LIST('***                    ZIMBULA              ***');
  PUT SKIP LIST('***   P.S.   NEXT TIME MAYBE YOU''LL LISTEN. ***');
  PUT SKIP LIST('***********************************************');
  PUT SKIP LIST(' ');
  GOTO  #5900 ;
 #4220: PUT SKIP LIST(' ') ;
  IF G(Q1,Q2)>999 THEN GOTO  #10250 ;
  Z2=0 ;
 #4250:  S1=TRUNC(RND*10+1) ;
  S2=TRUNC(RND*10+1) ;
  GOTO  #1420 ;
 #4280:  /*LONG RANGE SENSORS*/ ;
  IF D(3) >= 0 THEN GOTO  #4330 ;
 PUT SKIP LIST('LONG RANGE SENSORS ARE INOPERABLE');
 PUT SKIP LIST(' ') ;
  GOTO  #2640 ;
 #4330: PUT EDIT('LONG RANGE SENSOR SCAN FOR QUADRANT ',Q1,'-',Q2)
  (A,F(2),A,F(2)) ;
 PUT SKIP LIST('-----------------') ;
  DO I=Q1-1 TO Q1+1 ;
     NN=0;
  DO J=Q2-1 TO Q2+1 ;
  IF I<1 THEN GOTO  #4430 ;
  IF I>10 THEN GOTO  #4430 ;
  IF J<1 THEN GOTO  #4430 ;
  IF J>10 THEN GOTO  #4430 ;
  NN(J-Q2+2)=G(I,J) ; MAP(I,J)=G(I,J);
 #4430:     END ;
 PUT EDIT('=',NN(1),'=',NN(2),'=',NN(3))(COL(1),A,F(4),A,F(4),A,F(4));
 PUT SKIP LIST('-----------------');
   END ;
 PUT SKIP LIST(' ') ;
  GOTO  #2640 ;
 #4490:  /*PHASERS*/ ;
  IF D(4) >= 0 THEN GOTO  #4540 ;
 PUT SKIP LIST('PHASER CONTROL IS DISABLED');
 PUT SKIP LIST(' ') ;
  GOTO  #2640 ;
 #4540:  IF C5=0 THEN GOTO  #4580 ;
 PUT SKIP LIST('YOU MUST LOWER YOUR ENERGY SHIELDS TO FIRE.');
 PUT SKIP LIST(' ') ;
 #4570:  GOTO  #2680 ;
 #4580: IF THNUM > 0 THEN DO;
 EN = (2*THNUM+WS)*100;
 PUT EDIT('ENERGY REQUIRED TO DISRUPT WEB AND KILL THOLIANS = ',
 EN)(COL(1),A,F(6,1));
 IF E<EN THEN DO; PUT SKIP LIST('ENERGY LEVELS INSUFFICIENT');
                  GOTO #2640; END;
 AGAIN: PUT SKIP LIST('WOULD YOU LIKE TO RECONSIDER:');
 GET EDIT(V$) (COL(1),A(15));V$=TRANSLATE(V$,CAPS,SMLL);
 IF V$='YES' THEN GOTO #2640; IF V$^='NO' THEN GOTO AGAIN;
 PUT SKIP LIST('PHASERS FIRING');E=E-EN;
 IF RND >.7 THEN DO;PUT SKIP LIST('** PHASERS REFLECT OFF THOLIAN WEB');
 E=E-EN;IF E<0 THEN GOTO #6930; GOTO #4770;END;
 PUT SKIP LIST('*** THOLIANS DESTROYED ***');THNUM=0;
 DO I=1 TO 10; DO J=1 TO 10;
  IF Q(I,J) = 8 THEN Q(I,J)=0; END;END;
 GOTO #4770; END;
  PUT EDIT('PHASERS LOCKED ON TARGET.      ENERGY AVAILABLE = ',E)
  (A,F(6,1)) ;
 PUT SKIP LIST('NUMBER OF UNITS TO FIRE:');
   GET LIST(X) ;
  IF X<=0 THEN GOTO  #2640 ;
  IF E-X<0 THEN GOTO  #4580 ;
  E=E-X ;
  IF K3=0 THEN GOTO  #4780 ;
  W2=K3 ;
  DO I=1 TO 10 ;
  IF K(I,3)<=0 THEN GOTO  #4750 ;
  H=(X)/(FNO(I))*(3.0+RND) ;
  K(I,3)=K(I,3)-(H/W2) ;
 PUT EDIT(H/W2,' UNIT HIT ON KLINGON AT SECTOR ',K(I,1),'-',K(I,2))
  (COL(1),F(6,1),A,F(2),A,F(2)) ;
 PUT EDIT('(',K(I,3),' LEFT)') (COL(1),A,F(6,1),A);
  IF K(I,3)>0 THEN GOTO  #4750 ;
 PUT EDIT('*** KLINGON AT SECTOR ',K(I,1),'-',K(I,2),' DESTROYED.')
  (COL(1),A,F(2),A,F(2),A) ;
  IF Q(K(I,1),K(I,2))^=6 THEN GOTO  #6410;
  Z3=Q1 ;
  Z4=Q2 ;
  CALL  #12170 ;
 #6410:  K3=K3-1 ;
  K9=K9-1 ;
  Q(K(I,1),K(I,2))=0 ;
  G(Q1,Q2)=K3*100+B3*10+S3 ;
  IF K9<=0 THEN GOTO  #7020 ;
 #4750:   END ;
  IF K3<=0 THEN GOTO  #4790 ;
  #4770: CALL  #6460 ;
 #4780:  IF E<=0 THEN GOTO  #6890 ;
 #4790:  GOTO  #2640 ;
 #4800:  /*PHOTON TORPEDOES*/ ;
  IF D(5) >= 0 THEN GOTO  #4850 ;
 PUT SKIP LIST('PHOTON TUBES ARE NOT OPERATIONAL');
 PUT SKIP LIST(' ') ;
  GOTO  #2640 ;
 #4850:  IF P>0 THEN GOTO  #4880 ;
 PUT SKIP LIST('YOU SHOT ''EM ALL ALREADY!');
  GOTO  #2640 ;
 #4880:  IF C5=0 THEN GOTO  #4920 ;
 PUT SKIP LIST('YOU MUST LOWER YOUR ENERGY SHIELDS TO FIRE.');
 PUT SKIP LIST(' ') ;
  GOTO  #2680 ;
 #4920: PUT LIST('DO YOU WISH TO FIRE A BURST:');
   GET EDIT(M$) (COL(1),A(15)); M$=TRANSLATE(M$,CAPS,SMLL);
 PUT LIST('TORPEDO COURSE (IN DEGREES):');
   GET LIST(C1) ;
  IF C1>= 360 × C1<0 THEN GOTO  #2640 ;
 #4990:  IF P<3 THEN GOTO  #5010 ;
  IF M$='YES' THEN GOTO  #8290 ;
 #5010:  IF RND<.92 THEN GOTO  #5090;
 PUT SKIP LIST(' TORPEDO MISFIRES.');
  C1=RND*360;
 #5060:  IF E4=0 THEN GOTO  #5090 ;
 PUT SKIP LIST(' REMAINDER OF BURST ABORTED.');
  E4=0 ;
 #5090:  CALL  #5760 ;
  X=S1 ;
  Y=S2 ;
  P=P-1 ;
  U2=-1 ;
 PUT SKIP LIST('TORPEDO TRACK:') ;
 #5150:  X=X+X1 ;
  Y=Y+X2 ;
  IF X<.5 THEN GOTO  #5650 ;
  IF Y<.5 THEN GOTO  #5650 ;
  IF X>=10.5 THEN GOTO  #5650 ;
  IF Y>=10.5 THEN GOTO  #5650 ;
 PUT EDIT(X,'-',Y) (COL(1),F(2),A,F(2));
  U2=U2+1 ;
  X5=TRUNC(X+.5) ;
  Y5=TRUNC(Y+.5) ;
  IF Q(X5,Y5)^=0 THEN GOTO  #5270 ;
  GOTO  #5150 ;
 #5270:   F7=Q(X5,Y5) ;
  IF F7=1 THEN GOTO  #5150 ;
  IF F7=2 THEN GOTO  #7230 ;
  IF F7=3 THEN GOTO  #5440 ;
  IF F7=4 THEN GOTO  #5500 ;
  IF F7=6 THEN GOTO #7230 ;
  IF F7=5 THEN GOTO  #5150 ;
  IF F7=7 THEN GOTO #5560;
  IF F7=10 THEN DO; PUT SKIP LIST('** KLINGON MINE DESTROYED **');
  DO IB = 1 TO 4;
   IF BOMB(IB,1) = Q1 & BOMB(IB,2) = Q2 THEN BOMB(IB,*)=0; END;
  Q(X5,Y5)=0; GOTO #5670; END;
 IF F7=8 THEN DO;PUT SKIP LIST('*** THOLIAN DESTROYED ***');
 Q(X5,Y5)=0;THNUM=THNUM-1;IF THNUM=0 THEN FF2=1.4; GOTO #5670; END;
 IF F7=9 & RND >.7 THEN DO; WS=WS-1; Q(X5,Y5)=0;
 PUT SKIP LIST('*** THOLIAN WEB PARTIALLY DISRUPTED ***');
 GOTO #5670; END; GOTO #5150; #5340: PUT SKIP LIST(' ');
 PUT SKIP LIST('*** KLINGON DESTROYED ***');
  K3=K3-1 ;
  K9=K9-1 ;
  IF K9<=0 THEN GOTO  #7020 ;
  DO I=1 TO 9 ;
  IF K(I,1)^=X5 THEN GOTO  #5430 ;
  IF K(I,2)^=Y5 THEN GOTO  #5430 ;
  GOTO  #5570 ;
 #5430:   END ; GOTO #5670;
 #5440:  Q(X5,Y5)=0 ;
 PUT SKIP LIST(' ') ;
 PUT SKIP LIST('***STARBASE DESTROYED ... CONGRATULATIONS***');
  B3=B3-1 ;
  RID=1;
  GOTO  #5630 ;
 #5500:  Q(X5,Y5)=0 ;
 PUT SKIP LIST(' ') ;
 PUT SKIP LIST('***STAR DESTROYED***');
  S3=S3-1 ;
  IF S3>=0 THEN GOTO  #5630 ;
  S3=0 ;
  GOTO  #5630 ;
  #5560: PUT SKIP LIST('*** ROMULAN DESTROYED ***');FF1=FF1+.25;
  R9=R9-1;
  Q(X5,Y5)=0;
  R8=0;
  GOTO #5670;
 #5570:  K(I,3)=0 ;
  Q(X5,Y5)=0 ;
  IF F7^=6 THEN GOTO  #5630 ;
  Z3=Q1 ;
  Z4=Q2 ;
  CALL  #12170 ;
 #5630:  G(Q1,Q2)=K3*100+B3*10+S3 ;
  GOTO  #5670 ;
 #5650: PUT SKIP LIST(' ') ;
 PUT SKIP LIST('TORPEDO MISSED') ;
 #5670:  IF E4=0 THEN GOTO  #5720 ;
  E4=E4+1 ;
  IF E4>3.5 THEN GOTO  #5710 ;
  GOTO  #8360 ;
 #5710:  IF R8=0 & THNUM=0 & K3<=0 THEN GOTO  #5740 ;
 #5720:  CALL  #6460 ;
  IF E<= 0 THEN GOTO  #6890 ;
 #5740:  E4=0 ;
  GOTO  #2640 ;
 #5760:  PROC; X2=SIN(C1/57.296);
  X1=-COS(C1/57.296);
  RETURN;   END ;
 #5790:  W9=RND ;
  IF T>T0+8.99 THEN GOTO  #5830 ;
 PUT EDIT('WARP 15 CANNOT BE USED UNTIL STARDATE ',T0+9)
  (COL(1),A,F(6,1)) ;
  GOTO  #2930 ;
 #5830:  CALL  #6460 ;
  IF E<=0 THEN GOTO  #6930 ;
 PUT SKIP LIST('SPEED APPROACHING WARP 15.');
 PUT SKIP LIST('ENGINES OPERATING ABOVE DANGER LEVEL.');
 PUT SKIP LIST('ALL SAFETY DEVICES DYSFUNCTIONAL.');
 PUT SKIP LIST('CRITICAL OVERHEATING--SPONTANEOUS IMPLOSION IMMINENT.');
  IF W9>=.40 THEN GOTO #5980;
 #5900:  /*ZAP*/;
 PUT SKIP LIST('*****************************************************');
  CALL  #10750 ;
 PUT EDIT('*** ENTROPY OF ',N$,' MAXIMIZED ************')
  (COL(1),A,A,A) ;
 PUT SKIP LIST('*****************************************************');
 #5950:  CALL  #13180 ;
 PUT SKIP LIST('  THOU HAST BITTEN YE INTERSTELLAR DUST ');
  GOTO  #13230 ;
 #5980:  IF W9>=.55 THEN GOTO  #6040;
 PUT SKIP LIST(' ') ;
 PUT SKIP LIST(' YOU ARE TRAVELLING BACK IN TIME.');
  T=T-9 ;
 PUT EDIT('*** STARDATE =',T+1) (COL(1),A,F(6,1));
  GOTO  #3120 ;
 #6040:  IF W9>=.60 THEN GOTO  #6100;
 PUT SKIP LIST(' ') ;
 PUT SKIP LIST(' YOU ARE TRAVELLING BACK IN TIME.');
  T=T-14 ;
 PUT EDIT('*** STARDATE =',T+1) (COL(1),A,F(6,1));
  GOTO  #3120 ;
 #6100:  IF W9>=.70 THEN GOTO  #6170;
 PUT SKIP LIST(' ') ;
 PUT SKIP LIST(' YOU ARE TRAVELLING FORWARD IN TIME.');
  T=T+2 ;
  IF T>T0+T9 THEN GOTO  #6890 ;
 PUT EDIT('*** STARDATE =',T) (COL(1),A,F(6,1));
  GOTO  #3120 ;
 #6170: PUT SKIP LIST(' ') ;
 PUT SKIP LIST('NUCLEAR REACTOR CHAIN REACTION QUENCHED.');
 PUT SKIP LIST('*** TIME PORTAL MISSED ***');
  GOTO  #3120 ;
 #6210:  /*DAMAGE CONTROL*/ ;
  IF D(6) >= 0 THEN GOTO  #6260 ;
 PUT SKIP LIST('DAMAGE CONTROL REPORT IS NOT AVAILABLE');
 PUT SKIP LIST(' ') ;
  GOTO  #2640 ;
 #6260: PUT SKIP LIST(' ') ;
 PUT SKIP LIST('DEVICE          STATE OF REPAIR');
  DO I=1 TO 8 ;
  R5=I-.5 ;
  CALL  #7550 ;
 PUT EDIT(F$,D(I)) (COL(1),A,X(4),F(8,4));
   END ;
 PUT SKIP LIST(' ') ;
  GOTO  #2640 ;
 #6460:  PROC ;
  CALL  #10750 ;
  IF K3<=0 & R8 =0 & THNUM = 0 THEN GOTO  #6880 ;
 IF THNUM > 0 THEN DO;CALL THOLAN;GOTO #6880; END;
 IF C$ = 'DOCKED' THEN DO; PUT EDIT('STARBASE SHIELDS PROTECT ',N$)
     (COL(1),A,A);
  GOTO  #6880 ; END;
 #6520:IF R8=1 THEN CALL ROMULN(E);IF K3<=0 THEN GOTO #6880;
  IF C5=0 THEN GOTO #6540;
  #6530:DO I=1 TO 10; IF K(I,3)<=0 THEN GOTO #7520;
 H=(K(I,3)/FNO(I))*(2+RND); A9=A9-H; IF A9>0 THEN GOTO #7520;
 Z$='DOWN'; U3=I+1;
 PUT SKIP LIST('** KLINGONS ATTACK--ENERGY SHIELDS KNOCKED OUT**');
 PUT SKIP LIST(' '); C5=0; GOTO #6730;
  #7520: END;
 PUT EDIT('** KLINGONS ATTACK--ENERGY SHIELDS PROTECT ',N$)
 (COL(1),A,A); GOTO #6870;
 #6540:  IF K3*150<E THEN GOTO  #6710;
  IF N1^=0 THEN GOTO  #6680 ;
 PUT SKIP LIST(' ');
 PUT SKIP LIST('*********************************************');
 PUT SKIP LIST('***    INTERSTELLAR MESSENGER SERVICE     ***');
 PUT SKIP LIST('*********************************************');
 PUT SKIP LIST('** FROM: KLINGON COMMANDER                 **');
 PUT EDIT('**   TO: CAPTAIN OF ',N$,'        **') (COL(1),A,A,A);
 PUT SKIP LIST('**                                         **');
 PUT SKIP LIST('**   I REALLY DON''T NEED TO TELL YOU, BUT  **');
 PUT SKIP LIST('** I KNOW YOU ARE LOW ON ENERGY.  YOU WILL **');
 PUT SKIP LIST('** PROBABLY BE DESTROYED BY MY NEXT BLAST  **');
 PUT SKIP LIST('** (HEH! HEH!), BUT AS A GENTLEMAN, I MUST **');
 PUT SKIP LIST('** OFFER YOU THE CHANCE TO SURRENDER.  I   **');
 PUT SKIP LIST('** WILL BE ANXIOUSLY AWAITING YOUR REPLY   **');
 PUT SKIP LIST('** (WITH CHARGED PHASERS!).                **');
 PUT SKIP LIST('**                                         **');
 PUT SKIP LIST('*********************************************');
 PUT SKIP LIST(' ');
 PUT SKIP LIST('DO YOU SURRENDER, CAPTAIN:');
   GET EDIT(S$) (COL(1),A(15)); S$=TRANSLATE(S$,CAPS,SMLL);
  IF S$^='YES' THEN GOTO  #6675 ;
  A7=1 ;
  N9=1 ;
  GOTO  #6880 ;
  #6675:  PUT SKIP LIST('*** DIE,  FEDERATION SWINE! ***');
 #6680:  IF E>100.0 THEN GOTO  #6710;
  P4=11 ;
  CALL  #11950 ;
 #6710:  U3=1 ;
 PUT SKIP LIST(' ') ;
 #6730:  DO I=U3 TO 10 ;
  IF K(I,3)<= 0 THEN GOTO  #6860 ;
  H=(K(I,3)/FNO(I))*(2+RND) ;
  E=E-H ;
 PUT EDIT(H,' UNIT HIT ON ',N$,' FROM KLINGON, SECTOR ',K(I,1),'-',
  K(I,2)) (COL(1),F(5,1),A,A,A,F(2),A,F(2));
  IF H<=180 THEN GOTO  #6850 ;
  R5=TRUNC(RND*8+1) ;
  R1=R5 ;
  D(R5)=D(R5)-(H/200)*(1.5+RND) ;
 CALL  #7550 ;
 PUT EDIT('*** CRITICAL HIT, ',F$,' DAMAGED ***')(COL(1),A,A,A);
 #6850: PUT EDIT('(',E,' LEFT)') (COL(1),A,F(6,1),A);
 #6860:   END ;
 #6870: PUT SKIP LIST(' ') ;
 #6880:  RETURN;   END ;
 #6890:  /*LOSE*/ ;
  IF E>0 THEN GOTO  #6930 ;
  P4=10 ;
  CALL  #11950 ;
 #6930:  CALL  #13180 ;
 #6940: PUT EDIT('IT IS STARDATE ' ,T) (COL(1),A,F(6,1));
 #6950: PUT SKIP LIST(' ') ;
  CALL  #10750 ;
 PUT EDIT(N$,' HAS BEEN DESTROYED.') (COL(1),A,A);
 #6980:  PUT EDIT('THERE ARE STILL ',K9,' KLINGON BATTLE CRUISERS.')
  (COL(1),A,F(2),A) ;
  PUT SKIP LIST('THE FEDERATION WILL BE CONQUERED.');
  PUT SKIP LIST('YOU FLUNKED!') ;
  GOTO  #13230 ;
 #7020:  /*WIN*/ ;
  P4=9 ;FF=FF1*FF2;
  CALL  #11950 ;
  CALL  #13180 ;
 PUT EDIT('IT IS STARDATE ',T) (COL(1),A,F(6,1));
 PUT SKIP LIST('THE LAST KLINGON BATTLE CRUISER IN THE GALAXY');
 PUT SKIP LIST('HAS BEEN DESTROYED.');
 PUT SKIP LIST('THE FEDERATION HAS BEEN SAVED.');
 PUT SKIP LIST('YOU HAVE BEEN PROMOTED TO COMMODORE EMERITUS.');
 M1=0;IF T=T0 THEN DO;PUT SKIP LIST('RATING UNDEFINED');GOTO #13230;END;
  IF N1^=0 THEN GOTO  #7150 ;
 PUT EDIT(K0,' KLINGONS IN ',T-T0,' YEARS.  RATING= ',K0/(T-T0)*100*FF
  )(COL(1),F(3),A,F(6,1),A,F(5)) ;
  GOTO  #13230 ;
 #7150: PUT EDIT(K0,' KLINGONS IN ',T-T0,' YEARS.')
 (COL(1),F(3),A,F(6,1),A);
  IF A7=5 THEN GOTO  #7200 ;
 PUT SKIP LIST('ENTERPRISE CAPTURED.');
 PUT EDIT('RATING= ',(K0/(T-T0)*25*FF))(COL(1),A,F(5*FF));
  GOTO  #13230 ;
 #7200: PUT SKIP LIST('ENTERPRISE DESTROYED INTENTIONALLY.');
 #7210: PUT EDIT('RATING= ',(K0/(T-T0)*50*FF))(COL(1),A,F(5*FF));
  GOTO  #13230 ;
 #7230:  /*HIT OR MISS*/ ;
  IF RND<(U2*3)/100 THEN GOTO  #7360;
  IF RND>.15 THEN GOTO  #5340 ;
 PUT SKIP LIST(' ') ;
 PUT SKIP LIST('** KLINGON EVASIVE ACTION---');
 PUT SKIP LIST('* KLINGON DAMAGED, BUT NOT DESTROYED *');
  DO I=1 TO 10 ;
  IF K(I,1)^=X5 THEN GOTO  #7330 ;
  IF K(I,2)^= Y5 THEN GOTO  #7330 ;
  GOTO  #7340 ;
 #7330:   END ;
 #7340:  K(I,3)=0.4*K(I,3) ;
  GOTO  #5670 ;
 #7360: PUT SKIP LIST(' ') ;
 PUT SKIP LIST('** KLINGON EVASIVE ACTION---');
 PUT SKIP LIST('* TORPEDO MISSED *');
  GOTO  #5670 ;
 #7550:  PROC ;
  IF A+1^=1 THEN GOTO  #7580 ;
  R5=R1 ;
 #7580:  IF R5>1 THEN GOTO  #7610 ;
  F$='WARP ENGINES';
  GOTO  #7800 ;
 #7610:  IF R5>2 THEN GOTO  #7640 ;
  F$='SR SENSORS' ;
  GOTO  #7800 ;
 #7640:  IF R5>3 THEN GOTO  #7670 ;
  F$='LR SENSORS' ;
  GOTO  #7800 ;
 #7670:  IF R5>4 THEN GOTO  #7700 ;
  F$='PHASER CONTROL';
  GOTO  #7800 ;
 #7700:  IF R5>5 THEN GOTO  #7730 ;
  F$='PHOTON TUBES';
  GOTO  #7800 ;
 #7730:  IF R5>6 THEN GOTO  #7760 ;
  F$='DAMAGE CONTROL';
  GOTO  #7800 ;
 #7760:  IF R5>7 THEN GOTO  #7790 ;
  F$='ENERGY SHIELDS';
  GOTO  #7800 ;
 #7790:  F$='NAVIGATION AID';
 #7800:  RETURN;END ;
 #7810:  /*MAINTAIN POSITION*/ ;
  W1=0 ;
  W9=RND ;
  C1=3 ;
  T=T+1 ;
  DO I=1 TO 8 ;
  D(I)=D(I)+2 ;
  IF D(I)<0 THEN GOTO  #7900 ;
  D(I)=0 ;
 #7900:   END ;
  E=E-50 ;
  GOTO  #9700 ;
 #7930:  /*RAMMING KLINGON*/ ;
 PUT SKIP LIST(' ') ;
  Q(S1,S2)=0 ;
  K3=K3-1 ;
  K9=K9-1 ;
  Z$='DOWN' ;
  DO I=1 TO 9 ;
  IF K(I,1)^=X3 THEN GOTO  #8050 ;
  IF K(I,2)^=Y3 THEN GOTO  #8050 ;
  Z6=K(I,1) ;
  Z7=K(I,2) ;
  GOTO  #8060 ;
 #8050:   END ;
 #8060:  K(I,3)=0 ;
  CALL  #10750 ;
  Q(X3,Y3)=A5 ;
  GOTO  #8100 ;
 #8100:  G(Q1,Q2)=K3*100+B3*10+S3 ;
 PUT SKIP LIST('*** EMERGENCY ALERT ***');
 PUT SKIP LIST('*** COLLISION IMMINENT ***');
  CALL  #13180 ;
  CALL  #10750 ;
 PUT EDIT(N$,' RAMS KLINGON AT SECTOR ',Z6,'-',Z7)
  (COL(1),A,A,F(2),A,F(2)) ;
 PUT EDIT('*** KLINGON DESTROYED, ',N$,' HEAVILY DAMAGED. ***')
  (COL(1),A,A,A) ;
  DO I=1 TO 7 ;
  D(I)=D(I)-(RND*4+1) ;
   END ;
  C5=0 ;
  E=E-500 ;
  IF K9<=0 THEN GOTO  #7020 ;
  CALL  #6460 ;
  IF E<=0 THEN GOTO  #6950 ;
  S1=Z6 ;
  S2=Z7 ;
  A=2 ;
  GOTO  #6260 ;
 #8290:  /*BURST FORMATION*/ ;
 #8300: PUT LIST('BURST ANGLE (2 - 15 DEGREES):');
   GET LIST(E5) ;
  IF E5<=0 THEN GOTO  #2680 ;
  IF E5<2 THEN GOTO  #8300 ;
  IF E5>15 THEN GOTO  #8300 ;
  E4=1 ;
 #8360: PUT EDIT('NUMBER ',E4)(COL(1),A,F(2));
  IF E4>1.5 THEN GOTO  #8400 ;
  C1=C1-E5 ;
  GOTO  #5010 ;
 #8400:  C1=C1+E5 ;
  GOTO  #5010 ;
 #8470:  /*COMMAND LINK*/ ;
  IF A = 0 THEN GOTO  #2910 ;
  IF A = 1 THEN GOTO  #1910 ;
  IF A = 2 THEN GOTO  #4280 ;
  IF A = 3 THEN GOTO  #4490 ;
  IF A = 4 THEN GOTO  #4800 ;
  IF A = 5 THEN GOTO  #6210 ;
  IF A = 6 THEN GOTO  #11300 ;
  IF A = 7 THEN GOTO  #9360 ;
  IF A = 8 THEN GOTO  #10420 ;
  IF A = 9 THEN GOTO  #10630 ;
  IF A = 10 THEN GOTO  #8630 ;
  IF A = 11 THEN GOTO  #12260 ;
  IF A = 12 THEN GOTO  #11960 ;
  IF A = 13 THEN GOTO  #7810 ;
  IF A = 14 THEN GOTO #13700;
  IF A = 15 THEN GOTO #13800;
  GOTO  #2730 ;
 #8630:  /*DEATH RAY*/ ;
  IF T>T0+9.99 THEN GOTO  #8680 ;
 PUT EDIT(' DEATH RAY CANNOT BE USED UNTIL STARDATE ',T0+10)
  (COL(1),A,F(6,1)) ;
 PUT SKIP LIST(' ') ;
  GOTO  #2680 ;
 #8680:  IF W3<.05 THEN GOTO  #8720 ;
 PUT SKIP LIST(' DEATH RAY PERMANENTLY OUT OF ORDER.');
 PUT SKIP LIST(' ') ;
  GOTO  #2680 ;
 #8720:  IF C5=0 THEN GOTO  #8760 ;
 PUT SKIP LIST(' YOU MUST LOWER YOUR SHIELDS TO FIRE.');
 PUT SKIP LIST(' ') ;
  GOTO  #2680 ;
 #8760:  W3=RND ;
 PUT SKIP LIST(' ') ;
  IF W3>.20 THEN GOTO  #8890 ;
 PUT SKIP LIST( 'ANTI-MATTER OVERLOAD,');
 #8800: PUT SKIP LIST(' TEMPORARY PSEUDO-STARS CREATED FROM ENERGY.');
  DO I=1 TO 10 ;
  DO J=1 TO 10 ;
  IF Q(I,J)^=0 THEN GOTO  #8850 ;
  Q(I,J)=4 ;
 #8850:     END ;
   END ;
 PUT SKIP LIST(' ') ;
  GOTO  #2310 ;
 #8890:  IF W3>.36 THEN GOTO  #8930 ;
 PUT SKIP LIST('*** DEATH RAY BACKFIRES ***');
 PUT SKIP LIST('*** BETTER LUCK NEXT TIME ***');
  GOTO  #5900 ;
 #8930:  IF W3>.52 THEN GOTO  #9110 ;
 #8940:PUT EDIT('*** DEATH RAY ANNIHILATES ALL ALIENS IN QUADRANT ',Q1
  ,'-',Q2)(COL(1),A,F(2),A,F(2)) ;
  K9=K9-K3;IF THNUM ^=0 THEN DO;THNUM = 0;FF2=1.4;END;
  IF K9<=0 THEN GOTO  #7020 ;
  DO I=1 TO 10 ;
  DO J=1 TO 10 ;
  IF Q(I,J)=8 THEN Q(I,J)=0;
  IF Q(I,J)=7 THEN DO;R8=0;FF1=FF1+.25;R9=R9-1;Q(I,J)=0;END;
  IF Q(I,J)^= 6 THEN GOTO  #9010 ;
  Q(I,J)=0 ;
 #9010:  IF Q(I,J)^=2 THEN GOTO  #9030;
  Q(I,J)=0 ;
 #9030:     END ;
   END ;
  K3=0 ;
  G(Q1,Q2)=TRUNC(B3*10+S3) ;
  Z3=Q1 ;
  Z4=Q2 ;
  CALL  #12170 ;
  GOTO  #2680 ;
 #9110:  IF W3>.68 THEN GOTO  #9160 ;
 PUT SKIP LIST('*THERMAL REACTOR ENERGY DRAIN.');
 PUT EDIT(.95*E,' UNITS OF ENERGY BURNED.')(COL(1),F(6,1),A);
  E=.05*E ;
  GOTO  #8940 ;
 #9160:  IF W3>.84 THEN GOTO  #9300 ;
 PUT SKIP LIST('*MATTER/ANTI-MATTER TRANSFORMATION.');
  IF K3>0 THEN GOTO  #9200 ;
  GOTO  #8800 ;
 #9200: PUT SKIP LIST('KLINGONS HIT BY MAIN BEAM DUPLICATED.');
  P8=K3 ;
 PUT SKIP LIST('ENTIRE QUADRANT DISORDERED.');
  DO I=1 TO P8 ;
  IF K3>8 THEN GOTO  #9280 ;
  K3=K3+1 ;
  K9=K9+1 ;
   END ;
 #9280:  G(Q1,Q2)=K3*100+B3*10+S3 ;
  GOTO  #4250 ;
 #9300: PUT SKIP LIST('*** DEATH RAY GOES CRAZY ***');
 PUT SKIP LIST('*** DESTROYS EVERY KLINGON IN THE GALAXY ***');
 PUT EDIT('*** ALSO DESTROYS ',N$)(COL(1),A,A);FF1=FF1+.25*R9;FF2=1.4;
  IF N1^= 0 THEN GOTO  #9350 ;
  A7=N1=5 ;
 #9350:  GOTO  #7020 ;
 #9360:  /*ABANDON SHIP*/ ;
 IF THNUM > 0 THEN DO;
 PUT SKIP LIST('YOU MAY NOT ABANDON SHIP INSIDE A THOLIAN WEB.');
 GOTO #2680; END;
  IF N1=0 THEN GOTO  #9400 ;
 PUT SKIP LIST('THE FAIRIE QUEENE CANNOT BE ABANDONED.');
  GOTO  #2680 ;
 #9400: PUT SKIP LIST(' ') ;
  IF A7^=1 THEN GOTO  #9460 ;
 PUT SKIP LIST('** YOU MAY NOT ABANDON SHIP AFTER YOU HAVE BEEN ');
 PUT SKIP LIST('ASKED TO SURRENDER.');
 PUT SKIP LIST(' ') ;
  GOTO  #2680 ;
 #9460: PUT SKIP LIST('WOULD YOU LIKE TO RECONSIDER:');
   GET EDIT(P$) (COL(1),A(15)); P$=TRANSLATE(P$,CAPS,SMLL);
  IF P$^='YES' THEN GOTO  #9500 ;
  GOTO  #2680 ;
 #9500: PUT SKIP LIST('*** ABANDON SHIP ***');
 PUT SKIP LIST('*** ABANDON SHIP ***');
 PUT SKIP LIST(' ') ;
 PUT SKIP LIST('SERIES ENTER-BLITZ INITIATED.');
 PUT SKIP LIST('FAIL-SAFE AUTO-OVERRIDE INSERTED.');
 PUT SKIP LIST(' COMMANDER AND SELECT FEMALE CREW ESCAPE IN SHUTTLE CRAF
 T.');
 PUT SKIP LIST(' ') ;
 PUT SKIP LIST('*** ENTERPRISE REDUCED TO SUB-ATOMIC PARTICLES ***');
 PUT SKIP LIST(' ') ;
  A7=5 ;
  N1=1 ;
  N9=1 ; C5=0; Z$='DOWN';
  IF T<T0+T9 THEN GOTO  #9690 ;
 PUT SKIP LIST('ABANDONING SHIP COSTS 1 STARDATE.');
  T=T+1 ;
 PUT SKIP LIST('*** SO LONG, SPORT ***');
  N1=0 ;
 PUT SKIP LIST(' ') ;
  GOTO  #6940 ;
 #9690:  GOTO  #2640 ;
 #10250:  /*OLD SUPERNOVA*/ ;
  CALL  #10750 ;
 PUT EDIT(N$,' HAS WARPED INTO A QUADRANT CONTAINING A')
  (COL(1),A,A) ;
 PUT SKIP LIST('SUPERNOVA AND HAS BEEN FRIED. ');
 PUT SKIP LIST('           . . . NOT EVEN CINDERS REMAIN . . .');
 GOTO #5900;
 #10310:  PROC ;
  IF N1=1 THEN GOTO  #10370 ;
  E=3000 ;
  A9=3000 ;
  P=13 ;
  GOTO  #10400 ;
 #10370:  E=2000 ;
  A9=2000 ;
  P=8 ;
 #10400:  A7=0 ;
  RETURN;   END ;
 #10420:  /*RAISE SHIELDS*/ ;
  IF D(7)>=0 THEN GOTO  #10460 ;
 PUT SKIP LIST('ENERGY SHIELDS DISABLED.');
  GOTO  #2680 ;
 #10460:  IF C5=0 THEN GOTO  #10500 ;
 PUT SKIP LIST('ENERGY SHIELDS ALREADY ACTIVATED.');
 PUT SKIP LIST(' ') ;
  GOTO  #2680 ;
 #10500:  IF A9>=200 THEN GOTO  #10540;
 PUT SKIP LIST('SHIELD ENERGY DRAINED.');
 PUT SKIP LIST(' ') ;
  GOTO  #2680 ;
 #10540: PUT SKIP LIST(' ') ;
 PUT SKIP LIST('ENERGY SHIELDS ACTIVATED.');
 PUT SKIP LIST(' ') ;
  C5=200 ;
  Z$='UP' ;
  A9=A9-C5 ;
  IF E<=0 THEN GOTO  #6890 ;
  CALL  #6460 ;
  GOTO  #2680 ;
 #10630:  /*LOWER SHIELDS*/ ;
 PUT SKIP LIST(' ') ;
  IF C5^=0 THEN GOTO  #10690 ;
 PUT SKIP LIST('ENERGY SHIELDS ALREADY DOWN.');
 PUT SKIP LIST(' ') ;
  GOTO  #2680 ;
 #10690: PUT SKIP LIST('ENERGY SHIELDS DEACTIVATED.');
 PUT SKIP LIST(' ') ;
  C5=0 ;
  Z$='DOWN' ;
  CALL  #6460 ;
  GOTO  #2640 ;
 #10750:  PROC ;
  IF N1^=1 THEN GOTO  #10800 ;
  A5=5 ;
  N$='THE FAIRY QUEEN' ;
  GOTO  #10820 ;
 #10800:  N$='THE ENTERPRISE' ;
  A5=1 ;
 #10820:  RETURN;   END ;
 #10830:  PROC ;
 PUT SKIP LIST(' ') ;
  Z$='DOWN' ;
  A9=2000 ;
  DO I=1 TO 10 ;
  DO J=1 TO 10 ;
  K3=TRUNC(G(I,J)/99.99) ;
  B3=TRUNC((G(I,J)/99.99-K3)*10.0) ;
  IF B3>0 THEN GOTO  #11020 ;
  END ;
   END ;
 PUT SKIP LIST(' YOU HAVE BEEN TAKEN TO KLINGON HEADQUARTERS.');
 PUT SKIP LIST('IF YOU HAD A STARBASE, YOU WOULD BE REPATRIATED');
 PUT SKIP LIST('AND GIVEN A NEW STARSHIP TO COMMAND.');
 PUT SKIP LIST('SINCE YOU HAVE NO STARBASE, YOU WILL BE MERCILESSLY');
 PUT SKIP LIST('TORTURED TO DEATH BY THE ARCHFIEND,');
 PUT SKIP LIST('RUSSELL SCHOUEST, SCOURGE OF THE UNIVERSE.');
  N7=1 ;
  GOTO  #11210 ;
 #11020:  N9=2 ;
  T=T+1 ;
  Q1=I ;
  Q2=J ;
  E=2000 ;
  P=8 ;
  N1=1 ;
 PUT SKIP LIST('YOU HAVE BEEN SENT BACK TO STARFLEET COMMAND.');
 PUT SKIP LIST('YOU ARE NOW IN COMMAND OF A NEW STARSHIP,');
 PUT SKIP LIST('       THE FAIRIE QUEENE,');
 PUT SKIP LIST('WHICH LOOKS LIKE /Q/ ON THE SCAN.');
 PUT SKIP LIST(' ') ;
 PUT EDIT('       YE FAIRIE QUEENE IS CURRENTLY IN QUADRANT ',Q1
 ,'-',Q2)(COL(1),A,F(2),A,F(2)) ;
 PUT SKIP LIST('TRY TO BE MORE CAREFUL THIS TIME.');
  DO I=1 TO 7 ;
  D(I)=0 ;
   END ;
 PUT SKIP LIST(' ') ;
  GOTO  #4250 ;
 #11210:  RETURN;   END ;
 #11300:  /*SELF DESTRUCT*/ ;
 PUT SKIP LIST(' ') ;
 PUT SKIP LIST('SERIES ENTER-BLITZ INITIATED.');
 PUT SKIP LIST('IN TEN SECONDS THIS VESSEL WILL SELF-DESTRUCT.');
 PUT SKIP LIST(' 10') ;
 PUT SKIP LIST('      9') ;
 PUT SKIP LIST('         8') ;
 PUT SKIP LIST('            7') ;
 PUT SKIP LIST('               6') ;
 PUT SKIP LIST(' ') ;
 PUT SKIP LIST('T MINUS 5 SECONDS AND HOLDING.');
 PUT SKIP LIST('FAIL-SAFE MECHANISM ENGAGED.  ONLY THE COMMANDER OF');
 PUT SKIP LIST('THE STARSHIP CAN OVERRIDE WITH HIS SECRET PASSWORD');
 PUT SKIP LIST('SCIENCE OFFICER SPOCK HAS ALREADY ENTERED HIS CORRECT');
 PUT SKIP LIST('COUNTER-PASSWORD.') ;
 PUT SKIP LIST('TO CONTINUE SERIES ENTER-BLITZ, TYPE YOUR ');
 PUT SKIP LIST('SECRET PASSWORD:') ;
   GET EDIT(V$) (COL(1),A(15)); V$=TRANSLATE(V$,CAPS,SMLL);
  IF V$^=X$ THEN GOTO  #11550 ;
 PUT SKIP LIST(' ') ;
 PUT SKIP LIST('                   4');
 PUT SKIP LIST('                      3');
 PUT SKIP LIST('                         2');
 PUT SKIP LIST('                            1');
  GOTO  #5900 ;
 #11550: PUT SKIP LIST(' ') ;
 PUT SKIP LIST('SERIES ENTER-BLITZ TERMINATED.');
 PUT SKIP LIST(' ') ;
  GOTO  #2640 ;
 #11960:  /*IMPULSE ENGINES*/ ;
  IF THNUM > 0 THEN DO;
  PUT SKIP LIST('THOLIAN TRACTORS DISABLE IMPULSE DRIVE');
 GOTO #2680; END;
 PUT SKIP LIST(' ') ;
 PUT SKIP LIST('IMPULSE ENGINES ON STANDBY.');
 PUT SKIP LIST(' ') ;
 #12000: PUT SKIP LIST('COURSE(IN DEGREES):');
   GET LIST(C1) ;
  IF C1>=360 × C1<0 THEN GOTO  #2640 ;
 PUT SKIP LIST('WARP FACTOR(1-5):') ;
   GET LIST(W1) ;
  IF W1<1 THEN GOTO  #2680 ;
  IF W1>5 THEN GOTO  #2680 ;
 PUT SKIP LIST(' ') ;
 PUT SKIP LIST('IMPULSE ENGINES ENGAGED.');
  C$='MOVING' ;
  E=E-400 ;
  IF E<=0 THEN GOTO  #6940 ;
  IF RND<.92 THEN GOTO  #9700 ;
 PUT SKIP LIST(' ') ;
 PUT SKIP LIST('***** IMPULSE ENGINES IMPLODE *****');
  GOTO  #6980 ;
 #12170:  PROC ;
  DO IV=1 TO 4 ;
  IF C(IV,1)=Z3 & C(IV,2)=Z4 THEN DO ;
  C(IV,1)=0 ;
  C(IV,2)=0 ;
  END;END ;
  RETURN;END ;
 #12260:  /*TELEPORTER*/ ;
  IF T>T0+6.99 THEN GOTO  #12310 ;
 PUT EDIT('TELEPORTER CANNOT BE USED UNTIL STARDATE ',T0+7)
 (COL(1),A,F(6,1)) ;
 PUT SKIP LIST(' ') ;
  GOTO  #2680 ;
 #12310:  IF W9>.20 & THNUM =0 THEN GOTO  #12360;
 #12320: PUT SKIP LIST('SPACE STORM BETWEEN HERE AND BASE CAUSING STATIC
  ON ALL');
 PUT SKIP LIST('FREQUENCIES--TELEPORTER TEMPORARILY DYSFUNCTIONAL.')
 ;
 PUT SKIP LIST(' ') ;
  GOTO  #2680 ;
 #12360:  H1=H1+1 ;
  IF H1<=2*H2 THEN GOTO  #12400 ;
 PUT SKIP LIST('TELEPORTATION CAPABILITY PERMANENTLY LOST.');
  GOTO  #2680 ;
 #12400: PUT SKIP LIST(' ') ;
 PUT SKIP LIST(' TELEPORTER ACTIVATED.');
  DO I=1 TO 10 ;
  DO J=1 TO 10 ;
  K3=TRUNC(G(I,J)/99.99) ;
  B3=TRUNC((G(I,J)/99.99-K3)*10.0) ;
  IF B3>0 THEN GOTO  #12510 ;
  END ;
   END ;
 PUT SKIP LIST(' ') ;
  GOTO  #12320 ;
 #12510:  Q1=I ;
  Q2=J ;
  IF RND>.15 THEN GOTO  #12580 ;
 PUT SKIP LIST('DISINTEGRATOR/INTEGRATOR MALFUNCTION--');
 PUT SKIP LIST('STARSHIP MOLECULES REORIENTED AS MOONPIE.');
 PUT SKIP LIST('  YOU ATE THAT ONE.');
  GOTO  #5950 ;
 #12580:  GOTO  #4250 ;
 #12740:  PROC ;
 #12750:  R1=TRUNC(RND*8+1) ;
  R2=TRUNC(RND*8+1) ;
  IF Q(R1,R2)>=1 THEN GOTO  #12750 ;
  RETURN;   END ;
 #13180:  PROC ;
  PUT EDIT(' ',' ',' ') (COL(1),A);
  RETURN;   END ;
  #13230: IF M1=0 THEN GOTO  #11940 ;
 PUT SKIP LIST(' ') ;
 PUT EDIT(K0-K9,' KLINGONS IN ',T-T0,' YEARS.')
 (COL(1),F(3),A,F(6,1),A) ;
 IF T=T0 THEN DO;PUT SKIP LIST('RATING UNDEFINED');GOTO #11760;END;
  R0=TRUNC((K0-K9)**2/(T-T0)/K0*100);
  IF N1=0 THEN GOTO  #11760 ;
  R0=TRUNC(R0/2);
  IF A7=5 THEN GOTO  #11760 ;
  R0=TRUNC(R0/2);
 #11760: PUT EDIT('POSTHUMOUS RATING = ',R0)(COL(1),A,F(6,1));
 PUT SKIP LIST(' ') ;
 PUT SKIP LIST('        . . . BETTER LUCK NEXT REINCARNATION.');
 PUT SKIP LIST(' ') ;
 PUT SKIP LIST(' ') ;
 PUT SKIP LIST('WOULD YOU LIKE TO SEE THE CURRENT STATE OF THE GALAXY:')
 ;
   GET EDIT(A$) (COL(1),A(15)); A$=TRANSLATE(A$,CAPS,SMLL);
  IF A$ ='NO' THEN GOTO  #11940 ;
  DO I=1 TO 10 ;
 PUT SKIP LIST('-----------------------------------------------------');
 PUT EDIT((G(I,J) DO J=1 TO 10))(COL(1),10 F(5));
   END ;
 PUT SKIP LIST('-----------------------------------------------------');
 PUT SKIP LIST(' ') ;
  CALL  #10750 ;
 PUT EDIT('LAST KNOWN POSITION OF ',N$)(COL(1),A,A);
 PUT EDIT('         QUADRANT ',Q1,'-',Q2,'   SECTOR ',S1,'-',S2)
  (COL(1),4 (A,F(2))) ;
 #11940: PUT SKIP LIST(' ') ;
   PUT SKIP LIST(' ') ;
 PUT SKIP LIST('  DO YOU WISH TO PLAY AGAIN:');
   GET EDIT(A$) (COL(1),A(15)); A$=TRANSLATE(A$,CAPS,SMLL);
  IF A$ ='YES' THEN GOTO  #200 ;
 PUT SKIP LIST(' ') ;
  PUT SKIP LIST('   ** ABOUT TIME YOU QUIT!!! **  ');
 #13300:   STOP ;
  RND: PROC;
  DCL ISEED FIXED BIN(31) EXTERNAL;
   (NOFOFL):ISEED=ISEED*65539;
   IF ISEED < 0 THEN ISEED=ISEED+2147483647;
   ISEED=ISEED+1;
   RETURN(ISEED*.4656613E-9);
   END;
   FNO: PROC(I) ; DCL K(10,3) FLOAT EXTERNAL;
  (NOUNDERFLOW,NOOVERFLOW): RETURN(SQRT((K(I,1)-S1)**2+(K(I,2)-S2)**2));
   END ;
   /* THE END OF IT ALL */
  #11950: PROC ;
  IF P4=1 THEN PUT EDIT('IT IS NOW STARDATE ',T,' GETTING A BIT OLD AREN
 ''T YOU?') (COL(1),A,F(6,1),COL(1),A);
 IF P4=2 THEN PUT EDIT('IT IS NOW STARDATE ',T,' YOU''VE HAD ',T-T0,' YE
 ARS.',' WHAT''S THE MATTER??')(COL(1),A,F(6,1),A,F(6,1),A,COL(1),A);
   IF P4=3 THEN PUT EDIT('IT IS NOW STARDATE ',T,' YOU HAVE BEEN AT WAR
 FOR ',T-T0,' YEARS.','** GIVE UP !!!!**')(COL(1),A,F(6,1),A,F(6,1),A,CO
 L(1),A);
  IF P4=4 THEN PUT EDIT('IT IS NOW STARDATE ',T,T-T0,' YEARS HAVE ELAPSE
 D.','WHAT DO YOU HAVE TO SHOW FOR IT?')(COL(1),A,2(F(6,1)),A,COL(1),A);
   IF P4=5 THEN PUT EDIT('***** WARNING *****','YOU ARE OUTNUMBERED '
 ,K3,':1.','YOU ASKED FOR IT!!')(COL(1),A,COL(1),A,F(2),A,X(10),A);
   IF P4=6 THEN PUT EDIT('***** WARNING *****','YOU ARE IN A QUADRANT CO
 NTAINING ',K3,' KLINGONS.','>>>*RED ALERT*<<<')(COL(1),A,COL(1),A,F(2),
 A,COL(1),A);
   IF P4=7 THEN PUT SKIP LIST('IT HAS BEEN FRIED!!!');
   IF P4=8 THEN PUT SKIP LIST('HERE IS YOUR PRESENT STATUS:');
   IF P4=9 THEN PUT SKIP LIST('** IMAGINE THAT, YOU WON ONE!?! **');
   IF P4=10 THEN PUT SKIP LIST('*** GUESS WHAT? ***  ALL ENERGY LEVELS A
 RE TOTALLY DEAD!');
   IF P4=11 THEN PUT SKIP LIST('***** WARNING *****  ENERGY LEVELS ARE D
 ANGEROUSLY LOW!');
  IF P4=12 THEN PUT SKIP LIST('*** WARNING *** ROMULAN SHIP PRESENT IN T
 HIS QUADRANT ***');
  IF P4=13 THEN PUT EDIT('*** MR. SCOTT GETS INTO BOTTLE OF SCOTCH. ***'
 ,'*** DECIDES TO SHARE IT WITH COMPUTER ***') (2(COL(1),A));
  IF P4=14 THEN PUT SKIP LIST('*** YEOMAN RAND SPILLS COFFEE ON THE MAST
 ER CONTROL PANEL ***');
  IF P4=15 THEN PUT SKIP LIST('*** TRIBBLES INVADE SHIPS ENGINEERING ***
 ');
  IF P4=16 THEN PUT SKIP LIST('*** ENSIGN CHECKOV TRIES TARGET PRACTICE
  WITH PHASER PISTOL ***');
  IF P4=17 THEN PUT SKIP LIST('*** STARSHIP COLLIDES WITH BLACK HOLE ***
 ');
  IF P4=18 THEN PUT SKIP LIST('*** MR. SPOCK AND COMPUTER BATTLE LOGIC,
 NEITHER WINS. ***');
  IF P4=19 THEN PUT SKIP LIST('*** MR. SCOTT FINDS SPARE DILITHIUM CRYST
 ALS IN HIS JUNK BOX ***');
  IF P4=20 THEN PUT SKIP LIST('***  SHIP GETS TWO WEEKS R & R ON EARTHLI
 KE PLANET ***');
  IF P4=21 THEN PUT SKIP LIST('** COMPUTER BEATS SPOCK AT 3D CHESS **');
  IF P4=22 THEN PUT SKIP LIST('*** MR. SCOTT FALLS IN LOVE WITH COMPUTER
 **');
  IF P4=23 THEN PUT SKIP LIST('*** MR. SULU DISCOVERS FAULTY WIRING ***'
 );
  IF P4=24 THEN PUT SKIP LIST('*** ENGINEERING RECEIVES BACK PAY ***');
 RETURN;END ;
  #13700:  /*NAVIGATION COMPUTER*/;
   IF D(8)<0 THEN DO;
     PUT SKIP LIST('NAVIGATION AID IS NOT ACTIVE') ;
     GO TO #2640;
     END;
   PUT SKIP LIST('QUADRANT:');
    GET LIST(Q8,Q9);
   IF Q8<=0 × Q9<=0 × Q8>10 × Q9>10 THEN GOTO #2640;
   D9=1;
   Q8=Q8-Q1;
   Q9=Q9-Q2;
   IF Q8=0 & Q9=0 THEN DO;
     PUT SKIP LIST('SECTOR:');
      GET LIST(Q8,Q9);
     IF Q8<=0 × Q9<=0 × Q8>10 × Q9>10 THEN GOTO #2640;
     Q8=Q8-S1;
     Q9=Q9-S2;
     IF Q8=0 & Q9=0 THEN DO;
       PUT SKIP LIST('DON''T MOVE!');
       PUT SKIP LIST('YOU  DO NEED A NAVIGATION AID, DON''T YOU!');
        GOTO #2640;
        END;
     D9=10;
     END;
   W1=SQRT(Q8**2+Q9**2)/D9;
   IF Q8<0 THEN GOTO #14000;
   IF Q8>0 THEN GOTO #14040;
   Q7=270;
   IF Q9>0 THEN Q7=90;
   GOTO #14070;
   #14000: Q7=0;
   IF Q9>0 THEN Q7=1;
   IF Q9<0 THEN Q7=4;
   GOTO #14070;
   #14040: Q7=180;
   IF Q9>0 THEN Q7=2;
   IF Q9<0 THEN Q7=3;
   #14070: IF Q7<1 × Q7>4 THEN DO;
     Q6=Q7;
     GOTO #14150;
     END;
   Q6=ATAN(ABS(Q9/Q8))*57.296;
   IF Q7=2 THEN Q6=180-Q6;
   IF Q7=3 THEN Q6=180+Q6;
   IF Q7=4 THEN Q6=360-Q6;
   #14150: PUT SKIP EDIT('COURSE  ',Q6,'  WARP  ',W1) (COL(1),A,F(7,3),
   A,F(6,3));
   GOTO #2640;
 #13800: /* STAR MAP */; MAP(Q1,Q2)=-MAP(Q1,Q2);
  PUT EDIT((I DO I=1 TO 10))(COL(4),10 F(5));
  DO I=1 TO 10;
 PUT SKIP LIST('--------------------------------------------------------
 ');
 PUT EDIT(I,'×',(MAP(I,J) DO J=1 TO 10))(COL(1),F(2),A,10 F(5)); END;
 PUT SKIP LIST('--------------------------------------------------------
 ');
 MAP(Q1,Q2)=-MAP(Q1,Q2); GOTO #2680;
 ROMULN: PROC(E);
   H=(1000+500*RND)/SQRT((S1-RX)**2+(S2-RY)**2);
   IF C$='DOCKED' THEN DO;
   PUT EDIT('STARBASE SHIELDS PROTECT ',N$,' FROM ROMULAN')
   (COL(1),A,A,A);GOTO MOVER; END;
   IF Z$='UP' THEN DO; A9 = A9- H;
   IF A9 > 0 THEN DO;
   PUT EDIT('SHIELDS PROTECT ',N$,' FROM ROMULAN')(COL(1),A,A,A);
   GOTO MOVER; END;
   H = -A9; Z$='DOWN';
   PUT SKIP LIST('ROMULAN ATTACK CRASHES SHIELDS'); END;
   E=E-H;PUT EDIT(H,' HIT ON ',N$,' FROM ROMULAN AT SECTOR ',RX,'-',RY)
   (COL(1),F(6,1),A,A,A,F(2),A,F(2));
   IF E<=0 THEN DO; P4=10; CALL #11950; GOTO #6930; END;
   IF E<=100 THEN DO; P4=11;CALL #11950; END;
   /* MOVE ROMULAN AT RANDOM*/
  MOVER: PUT EDIT('ROMULAN AT ',RX,'-',RY,' MOVES.') (COL(1),A,F(2),A,F(
 2),A);
   Q(RX,RY)=0; RW  =.3*RND+.1; RD=360*RND;
   RX1=-COS(RD/57.296); RY1=SIN(RD/57.296);
   DO I=1 TO TRUNC(RW*10.05); RX=RX+RX1;RY=RY+RY1;
   IF RX<.5×RX>10.5×RY<.5×RY>10.5 THEN GOTO HOLDIT;
   IF Q(TRUNC(RX+.5),TRUNC(RY+.5)) ^=0 THEN GOTO HOLDIT;
   END;
 ROMSTP: RX=TRUNC(RX+.5);RY=TRUNC(RY+.5); GOTO ROMOVE;
 HOLDIT: RX=RX-RX1;RY=RY-RY1; GOTO ROMSTP;
 ROMOVE: Q(RX,RY)=7; RD=45*TRUNC(RD/45+.5);
   PUT SKIP LIST('SENSORS INDICATE ROMULAN IS MOVING APPROXIMATELY');
   PUT EDIT('ON COURSE ',RD,' AT WARP ',RW)
   (COL(1),A,F(3),A,F(3,1));
   RETURN; END;
 THOLAN: PROC; PUT SKIP(2) LIST('** THOLIANS ATTACK **');
 DO I=1 TO THNUM;
 DO J=S1-1 TO S1+1; DO IK=S2-1 TO S2+1;
 IF Q(J,IK)^=9 THEN DO;Q(J,IK)=9;WS=WS+1;
 PUT EDIT('THOLIAN ',I,' LAYS WEB AT SECTOR ',J,'-',IK)(COL(1),A,
 F(1),A,F(2),A,F(2)); GOTO BOTLP; END;
 END; END; GOTO GOTCHA;
 BOTLP: END;
 IF WS=9 THEN GOTO GOTCHA;
 PUT EDIT('THOLIAN WEB NOW ',WS*11.11,' PERCENT COMPLETED')(COL(1),A,
 F(4,1),A) ; RETURN;
 GOTCHA: PUT SKIP LIST('THOLIAN WEB HAS BEEN COMPLETED!!!');
 PUT EDIT(N$,' WILL BE TOWED OFF TO THOLIA AND SOLD AS SCRAP.')
 (COL(1),A,A); E=0; RETURN; END;
 END;

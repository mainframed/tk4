 /* COPYRIGHT 1983 BY THOMAS GLEN SMITH */
 /* DENT052 - SPLITB */
   % DCL @PROCNAME CHAR;
   % DCL @RENTNAME CHAR;
   % @PROCNAME = 'RENT';
   % @RENTNAME = 'DENT052';
   % INCLUDE DENTSUB;
   DCL (PREFIX,SUFFIX) ENTRY(CHAR(*), CHAR(*))
     RETURNS(FIXED BIN(15,0));
         DCL LAST FIXED BIN(31,0) INIT(99999999);
   DCL (SAVPTR,ORGPTR,SEQPTR,DELPTR) PTR;
   RHRC=0;
   MSGDATA='';
   ORGPTR = RECPTR;
   IF PARY(2)=''
     THEN DO;
       L1=0;
       L2=LAST;
       END;
     ELSE DO;
       L1=PARY(2);
       IF PARY(3)=''
         THEN L2=L1;
         ELSE L2=PARY(3);
       END;
   IF L1>L2
     THEN DO;
       MSGDATA='INVALID LINE RANGE';
       RHRC=0;
       RETURN;
       END;
   CALL #MD(RHPTR,SUBENT,L1);  /* CALL MDPROC */
   SEQPTR=RECPTR;
   DO WHILE(RECSEQ <= L2) UNTIL(RECPTR = HDPTR);
     IF RECSTR=''
       THEN DO;
         IF SEQPTR=RECPTR
           THEN SEQPTR=LSTPTR;
         IF ORGPTR=RECPTR
           THEN ORGPTR=LSTPTR;
         DELPTR=RECPTR;
         RECPTR=LSTPTR;
         CALL #PUTSLOT(RHPTR,SUBENT,DELPTR);
         END;
       ELSE DO;
         RECSTR=SUBSTR(RECSTR,PREFIX(RECSTR,' '));
         RECSTR=SUBSTR(RECSTR,1,SUFFIX(RECSTR,' '));
         J=INDEX(RECSTR,' ');
         IF J^=0
           THEN DO;
             BUF=SUBSTR(RECSTR,J);
             RECSTR=SUBSTR(RECSTR,1,J-1);
             SEQ=-1;
             CALL #ADD(RHPTR,SUBENT,RECPTR,SAVPTR,SEQ,
               BUF,RHPPTR);/* CALL ADDREC */
             SAVPTR->RECSEQ=RECPTR->RECSEQ;
             END;
         END;
     RECPTR = NXTPTR;
     END;
   RECPTR = ORGPTR;
   CALL #RESEQ(RHPTR,SUBENT,SEQPTR,'NOSAVE','NORENUM',LAST,
     RHPPTR);    /* CALL RESEQ */
   CALL #NC(RHPTR,SUBENT,ORGPTR); /* CALL DENTNC */
   RHRC = 0;
   END DENT052;

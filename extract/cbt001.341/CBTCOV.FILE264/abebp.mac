 /* COPYRIGHT 1983 BY THOMAS GLEN SMITH */
   /* ABEBP - IMPLEMENTATION OF ABE IN BATCH */
   %INCLUDE ABESUB;
 ABESUB(ABEBP) PARS(0000000000000000) CHECK(YES);
   %INCLUDE ABESUBA;
   DCL 1 LRN_STRUCTURE BASED(LRNPTR),
   %INCLUDE ABELRN;
   %INCLUDE ABELRNA;

   DCL VAL CHAR(256) VAR;
   DCL KEY CHAR(8);
   DCL GBLSW BIT(1) STATIC INIT('0'B);
   DCL L FIXED BIN(15,0);

   DO IX = 1 TO HBOUND(PARY,1) WHILE(PARY(IX)^='');
     I = INDEX(PARY(IX),'(');
     IF I < 2 × I > 8
       THEN DO; /* GET OUT IF BAD OPERAND */
         MSGDATA = 'INVALID KEYWORD OPERAND='××PARY(IX);
         RHRC = 4;
         RETURN;
         END;
     KEY = SUBSTR(PARY(IX),1,I-1);
     VAL = SUBSTR(PARY(IX),I+1,LENGTH(PARY(IX))-I-1);
     CALL #SETC(RHHDRPT,RH_SYMTREE,KEY,VAL); /* CALL SET@ */
     END;

   I=#CMD('0 BL 1',RHPTR,RHHDRPT);
   NXTHDR->RECSTR='$CONTROL NL';
   I=#CMD('COPY AAAAAAAA',RHPTR,RHHDRPT);
   I=#CMD('DEL',RHPTR,RHHDRPT);
   I=#CMD('RUN AAAAAAAA',RHPTR,RHHDRPT);
   I=#CMD('SAVE',RHPTR,RHHDRPT);
   RHRC=0;
   END;

 /* ELAPTME
0*$.HE GENERALIZED SUBROUTINES - ELAPTME
0*$.HE CALCULATE ELAPSED TIME
0*$.PL 55
0*$.PN 0
0*$.PA
0*$.SS
0*$.NF
0*$06/13/77
0*$AUTHOR:  T. SMITH
0*$SOURCE MODULE NAME:  ELAPTME
0*$DOCOMENTATION ID:  0*$
0*$.FI L
0*$.SP 5
0*$THIS SUBROUTINE MAY BE INVOKED TO CALCULATE THE ELAPSED TIME
0*$BETWEEN TWO POINTS IN TIME.  CALL FORMAT IS AS FOLLOWS:
0*$.SP 1
0*$.IN 5
0*$I = ELAPTME(SDTE,STME,EDTE,ETME);
0*$.IN 0
0*$WHERE I IS FIXED BIN(31,0), AND WILL BE SET BY ELAPTME TO THE ELAPSED
0*$TIME IN HUNDREDTHS OF SECONDS.  SDTE AND EDTE MUST BE FIXED DEC(5,0),
0*$AND MUST BE SET BY THE CALLER TO THE STARTING AND ENDING DATES,
0*$RESPECTIVELY.  STME AND ETME MUST BE FIXED BIN(31,0), AND MUST BE
0*$SET BY THE CALLER TO THE STARTING AND ENDING TIMES, RESPECTIVELY.
 */
 ELAPTME:  PROC(SDTE,STME,EDTE,ETME) RETURNS(FIXED BIN(31,0));
   ON ERROR GO TO EOT;
   IF SDTE=EDTE
     THEN IF STME>ETME
       THEN RETURN(-1);
       ELSE;
     ELSE IF SDTE>EDTE
       THEN RETURN(-1);
   DCL (SDTE,EDTE,CDTE) FIXED DEC(5,0);
   DCL (STME,ETME) FIXED BIN(31,0);
   DCL RET FIXED BIN(31,0) INIT(0);
   DCL (SYY,EYY,CYY) FIXED DEC(2,0);
   DCL (SDD,EDD,CDD) FIXED DEC(3,0);
   IF SDTE=EDTE
     THEN RETURN(ETME-STME);
   SYY=SDTE/1000;
   EYY=EDTE/1000;
   SDDD=SDTE-SYY;
   EDDD=EDTE-EYY;
   RET=8640000-STME;
   CALL SETCD;
   DO WHILE(SDTE<EDTE);
     SDTE=SDTE+1;
     IF SDTE > CDTE
       THEN DO;
         SYY=SYY+1;
         SDDD=1;
         SDTE=SYY*1000+SDDD;
         CALL SETCD;
         END;
   IF SDTE < EDTE
     THEN RET=RET+8640000;
   END;
   RET=RET+ETME;
   RETURN(RET);
 SETCD:  PROC;
   IF MOD(SYY,4)=0
     THEN CDDD=366;
     ELSE CDDD=365;
   CYY=SYY;
   CDTE=CYY*1000+CDDD;
   END SETCD;
 EOT:
   END;

 /* COPYRIGHT 1983 BY THOMAS GLEN SMITH */
 /* DENT042 (WAS DENTFSL), $CLEAR */
 /* CALLED TO PROCESS - $CLEAR <PANEL> */
   % DCL @PROCNAME CHAR;
   % DCL @RENTNAME CHAR;
   % @PROCNAME='RENT';
   % @RENTNAME='DENT042';
   % INCLUDE DENTSUB;
   % INCLUDE DENTPNL;
   HALT;
   DCL SETCAPS ENTRY;
   DCL NAME CHAR(8);
   DCL AD(0:32766) CHAR(1) UNALIGNED BASED(T);
   DCL HWD UNALIGNED FIXED BIN(15,0) BASED(DUMPTR);
   DCL 1 MPNLCALL,
     2 MCURPNL FIXED BIN(15,0) INIT(0),
     2 MNXTPNL FIXED BIN(15,0) INIT(1),
     2 MARYPTR PTR,
     2 MAID BIT(8),
     2 MCURLOC FIXED BIN(15,0),
     2 MCHGCURS FIXED BIN(15,0) INIT(-1),
     2 MCALLFLGS BIT(8) INIT('0'B);
   DCL 1 @PNLARYS,
     2 @ARYCNT FIXED BIN(31,0) INIT(1),
     2 @PNLARY(1),
      3 @PNLSTAPT PTR,
       /* PTR TO STATIC PORTION OF DEFINITION */
      3 @PNLDYNPT PTR;
       /* PTR TO DYNAMIC PORTION OF DEFINITION */
   NAME=PARY(2);
   CALL SETCAPS(NAME);
   T=#PFN(RHHDRPT,SUBENT,NAME); /* GO GET PANEL */
   WRKPTR,PNLPTR=ADDR(AD(4));
   IF WRKPTR->PNLLEN<0
     THEN DO;
       WRKADJ=WRKADJ+WRKPTR->NEWLEN;
       SFLDPTR=ADDR(FLDLOC); /* POINT TO FIRST FIELD DESCR */
       END;
     ELSE DO;
       WRKADJ=WRKADJ+WRKPTR->PNLLEN;
       SFLDPTR=ADDR(NEWLEN); /* POINT TO FIRST FIELD DESCR */
       END;
   DYNPTR=WRKPTR;
   WRKADJ=WRKADJ+DOUTOF; /* WRKPTR POINTS AT PANEL_OUT SUBSTRUCTURE */
   DO SFLDADJ=SFLDADJ REPEAT SFLDADJ+FLDLEN UNTIL(FLDNUM=FLDCNT);
     IF ^SUBSTR(FLAGS,3,1) /* UNPROTECTED? */
       THEN DO; /* IT IS INPUT FIELD */
         DFLDADJ=WRKADJ+OUTOFF; /* DFLDPTR POINTS AT OUTPUT DATA */
         DATA='';
         END;
     END;
   END DENT042;

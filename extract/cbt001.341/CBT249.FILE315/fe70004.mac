//TEC0169I JOB (T369055000),TIM.BAKER,CLASS=B,NOTIFY=TEC0169,MSGCLASS=X
/*JOBPARM ROOM=2,S=C033
//*
//*******************************************************************
//*                                                                 *
//*  THIS USER MOD CHANGES THE COMMON VERIFY SPF DIRECTORY ENTRY    *
//*  MODULE TO LOOK FOR THE SPF USER DATA IN THE LAST 30 BYTES OF   *
//*  USER DATA.                                                     *
//*  THIS FIX MUST BE APPLIED WITH FE70002, FE70003, AND FE70005.   *
//*  JOB SPFSUBS1 SHOULD BE RUN AFTER ALL 4 USER MODS ARE APPLIED   *
//*  TO ASSEMBLE AND LINK CCD, CIV, CML, AND CVSDE THEN SPFSUBS IS  *
//*  LINKED.                                                        *
//*                                                                 *
//*******************************************************************
//*
//COPYOUT EXEC PGM=IEBCOPY,REGION=1024K
//SYSPRINT  DD SYSOUT=*
//SYSIN     DD *
  COPY INDD=SYSUT1,OUTDD=SYSUT2
  SELECT MEMBER=((ISPCVSDE,ISPCVSDO))
//SYSUT1    DD DSN=SYS9.SPF100P1.SOURCE,DISP=SHR
//SYSUT2    DD DSN=&TEMP,DISP=(NEW,KEEP),UNIT=VIO,SPACE=(TRK,(1,1,1)),
//             DCB=*.SYSUT1
//*
//COPYIN  EXEC PGM=IEBCOPY,REGION=1024K
//SYSPRINT  DD SYSOUT=*
//SYSIN     DD *
  COPY INDD=SYSUT1,OUTDD=SYSUT2
  SELECT MEMBER=(ISPCVSDO)
//SYSUT1    DD DSN=&TEMP,DISP=(OLD,DELETE)
//SYSUT2    DD DSN=SYS9.SPF100P1.SOURCE,DISP=SHR
//*
//CHANGE  EXEC PGM=IEBUPDTE
//SYSPRINT  DD SYSOUT=*
//SYSUT1    DD DSN=SYS9.SPF100P1.SOURCE,DISP=SHR
//SYSUT2    DD DSN=SYS9.SPF100P1.SOURCE,DISP=SHR
//SYSIN     DD *
./ CHANGE NAME=ISPCVSDE
*    VERIFIES SPF STATS FROM END OF USER DATA - F.E.D.S. USER MOD
@RF00036 DS    0H
         IC    R5,CVSBC(CVSBLDLP) LOAD NUMBER OF HALFWORDS IN USER DATA
         N     R5,ONEFOX          TURN OFF NON - LENGTH BITS
         C     R5,ZEROFOX         CHECK IF LENGTH LONG ENOUGH FOR STATS
         BL    @RT00038           NO, SPF STATS CANNOT EXIST
         SLL   R5,1               MULTIPLE HALFWORDS BY 2 FOR LENGTH
         LA    R6,14(,CVSBLDLP)   POINT TO FIRST OF USER DATA
         AR    R6,R5              POINT TO END OF USER DATA
         LA    R7,30              LOAD LENGTH OF SPF USER DATA
         SR    R6,R7              POINT TO FIRST OF SPF USER DATA
         CLC   SDEBLANK(3,R6),@CC00432     CHECK FOR BLANKS
         BE    @RF00038           LAST THREE CHARACTERS BLANKS
*    VERIFIES SPF STATS FROM END OF USER DATA - F.E.D.S. USER MOD
         UNPK  CVSTEMP(5),SDECDATE(4,R6) UNPACK DATE         F.E.D.S.
         UNPK  CVSTEMP(5),SDEMDATE(4,R6) UNPACK DATE         F.E.D.S.
ONEFOX   DC    F'31'              F.E.D.S.
ZEROFOX  DC    F'15'              F.E.D.S.
./ ENDUP

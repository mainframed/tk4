         TITLE 'P D S  --  ISPF DIALOG DISPLAY CODE'     1/15/85'
*************************************************************  SS JUL84
*                                                              SS JUL84
*        ADDED SUPPORT OF DIALOG DISPLAY MODE USING            SS JUL84
*        A DIALOG TABLE TO DISPLAY PDS OUTPUT                  SS JUL84
*                                                              SS JUL84
*************************************************************  SS JUL84
         SPACE 2                                               SS JUL84
ISPDSPY  CSECT
         USING *,R8                                            SS JUL84
         ST    R14,SPFSAV14        SAVE 14                     SS JUL84
         STM   R1,R8,SPFSAV1       SAVE REGS 1-8               SS JUL84
         LA    R6,FIRST4K                  EXTRA BASE          SS SEP84
         USING FIRST4K,R6                                      SS SEP84
         LR    R8,R15              ENTRY AND BASE IN R8        SS JUL84
         LA    R5,2048(,R8)                                    SS SEP84
         LA    R5,2048(,R5)        SECOND BASE                 SS SEP84
         USING ISPDSPY+4096,R5                                 SS SEP84
         TM    SPFLAG0,SPFTABLE    FIRST TIME IN               SS JUL84
         BO    ISPOPT              NO, ALL SET                 SS JUL84
         SPACE 3
* INITIALIZE THE DIALOG VARIABLES                              SS JUL84
         L     R4,ISPVINIA         ADDR OF INIT ROUTINE        SS MAR85
         BALR  R3,R4                                           SS MAR85
         SPACE 3                                               SS SEP84
ISPOPT   DS    0H                                              SS NOV84
         OI    SPFLAG3,SPFREFR        MAKE SURE OF REFRESH     SS NOV84
         SR    R15,R15                                         SS NOV84
         IC    R15,SPFLAG1            FUNCTION CODE            SS JUL84
         B     *+4(R15)               FUNCTION BRANCH TABLE    SS JUL84
         B     ISPEXIT                NOP                      SS JUL84
         B     ISPCLN                 CLEAN UP                 SS JUL84
         B     ISPPTGET               PUTGET                   SS JUL84
         B     ISPPUTL                PUTLINE                  SS JUL84
         B     ISPMEML                ADD LINE TO MEMLIST      SS SEP84
         B     ISPPNSUP               PANEL SUPPORT            SS NOV84
         B     ISPEXIT                PAD                      SS JUL84
         B     ISPEXIT                PAD                      SS JUL84
         SPACE 3
ISPERR   DS    0H                                              SS JUL84
         BAL   R2,ISPTBT#M        TERMINATE MEMLIST TABLE     ABL JUN85
         NI    SPFLAG0,255-SPFDON-SPFDSUSP-SPFVIEW            ABL JUN85
         NI    SPFLAG2,0             CLEAR MEMLIST MODE       ABL NOV84
         NI    SPFLAG3,SPFSELV       CLEAR MEMLIST MODE       ABL NOV84
         NI    SPFLAG4,0             CLEAR MEMLIST MODE       ABL JUN85
         NI    MEMFLAG0,0            CLEAR MEMLIST MODE       ABL NOV84
         DC    X'00'          FORCE 0C1                        SS JUL84
         SPACE 3
ISPCLN   DS    0H                                              SS JUL84
         BAL   R2,ISPTBT#S        TERMINATE ISPMODE TABLE     ABL OCT84
         BAL   R2,ISPTBT#M        TERMINATE MEMLIST TABLE     ABL OCT84
         SPACE 1
         NI    SPFLAG0,0                                       SS SEP84
         NI    SPFLAG2,0                                       SS SEP84
         NI    SPFLAG3,0                                       SS SEP84
         NI    MEMFLAG0,0                                      SS SEP84
         LA    R14,VRESET         DELETE ALL DIALOG VARIABLES  SS JUL84
         ST    R14,PARMLIST                                    SS JUL84
         OI    PARMLIST+00,X'80'                               SS JUL84
         LA    R1,PARMLIST                                     SS JUL84
         L     R15,ISPLINK                                     SS JUL84
         BALR  R14,R15                                         SS JUL84
         LTR   R15,R15                                         SS JUL84
         BNZ   ISPERR                                          SS JUL84
         B     ISPEXIT                                         SS JUL84
         SPACE 3
*                                                              SS JUL84
*  ADD ANOTHER DISPLAY LINE                                    SS JUL84
*                                                              SS JUL84
ISPPUTL  DS    0H                                              SS JUL84
         BAL   R2,ISPADDLN                                     SS AUG84
         TM    SPFLAG0,SPFCKER                                 SS SEP84
         BZ    ISPPUTL2                                        SS SEP84
         L     R1,SPFSAV1        RELOAD REGISTER 1            ABL JUN85
         CLI   4+6(R1),C'E'      ERROR TYPE MESSAGE           ABL JUN85
         BNE   ISPPUTL2                                        SS SEP84
         CLC   4+0(3,R1),ISPPDS  "PDS" PREFIX?                ABL JUN84
         BNE   ISPPUTL2          NO, BRANCH                   ABL OCT84
         TM    4+5(R1),X'F0'     NUMERIC?                     ABL JUN84
         BNO   ISPPUTL2          NO, BRANCH                   ABL OCT84
         TM    4+4(R1),X'F0'     NUMERIC?                     ABL JUN84
         BNO   ISPPUTL2          NO, BRANCH                   ABL OCT84
         TM    4+3(R1),X'F0'     NUMERIC?                     ABL JUN84
         BNO   ISPPUTL2          NO, BRANCH                   ABL OCT84
         OI    SPFLAG0,SPFMSGER  FLAG ERROR FOUND              SS SEP84
         MVC   SPFMLIN1(8),4(R1)     SAVE THE ERROR HEADER    ABL JUN85
         MVC   SPFMLIN2(79),SPFLINE  SAVE THE ERROR MESSAGE   ABL JUN85
ISPPUTL2 DS    0H                                              SS SEP84
         LH    R14,SPFCKPT       COUNT FROM LAST CKPT          SS JUL84
         LA    R14,1(R14)        ONE MORE ENTRY                SS JUL84
         STH   R14,SPFCKPT       SAVE COUNT                    SS JUL84
         CH    R14,SPFCKSZ       TIME FOR NEW CKPT             SS JUL84
         BL    ISPEXIT           DONE WITH PUTLINE            ABL OCT84
         LA    R14,ISPCNTL        CONTROLTABLE                ABL JUN85
         LA    R15,ISPDSP                                     ABL JUN85
         LA    R0,ISPREF                                      ABL JUN85
         STM   R14,R0,PARMLIST                                ABL JUN85
         OI    PARMLIST+08,X'80'                              ABL JUN85
         LA    R1,PARMLIST                                    ABL JUN85
         L     R15,ISPLINK                                    ABL JUN85
         BALR  R14,R15                                        ABL JUN85
         LTR   R15,R15                                        ABL JUN85
         BNZ   ISPERR                                         ABL JUN85
ISPATCK  DS    0H                CHECK POINT TIME              SS JUL84
         L     R1,SPFSTART        REPOSITION TO HERE           SS JUL84
         S     R1,SPFLAST         CALCULATE RELATIVE POSITION  SS JUL84
         BZ    ISPATCK2           IF ZERO SKIP REPOSITON       SS JUL84
         ST    R1,SPFFIXED        SAVE VALUE                   SS JUL84
         LA    R14,TBSKIP         CONTROLTABLE                 SS JUL84
         LA    R15,SPFTBL                                      SS JUL84
         LA    R0,SPFFIXED                                     SS JUL84
         STM   R14,R0,PARMLIST                                 SS JUL84
         OI    PARMLIST+08,X'80'                               SS JUL84
         LA    R1,PARMLIST                                     SS JUL84
         L     R15,ISPLINK                                     SS JUL84
         BALR  R14,R15                                         SS JUL84
         C     R15,ISPL8                                       SS JUL84
         BH    ISPERR                                          SS JUL84
ISPATCK2 DS    0H                CHECK POINT TIME              SS JUL84
         OI    ##ADRPA#,$A+$D           IGNORE ATTENTION NOW   SS JUL84
         MVI   SPFPANEL+5,C'3'    PANEL NAME                   SS JUL84
         L     R4,ISPTBDSA        GET ADDRESS OF SUBR          SS MAR85
         BALR  R3,R4              DISPLAY TABLE PANEL          SS MAR85
         BAL   R2,ISPBOTM             REPOSITION FOR NEXT ADD  SS AUG84
         MVC   SPFSTART,SPFTDTOP      NEXT DISPLAY SAME PLACE  SS AUG84
         CLI   SPFVZCMD,X'43'         RETURN HIT?             ABL DEC84
         BE    ISPNWCMD               YES, TERMINATE          ABL DEC84
         CLI   SPFVZCMD,X'42'         END?                    ABL OCT84
         BE    ISPNWCMD               YES, BRANCH              SS NOV84
         CLI   SPFVZCMD,C'0'          CONTINUE?               ABL DEC84
         BE    ISPATCK4               YES, VALID              ABL DEC84
         MVC   SPFMSGID,ISPPDSM       SET UP INVALID MESSAGE  ABL DEC84
         MVI   SPFMSGID+6,C'3'        ADD PANELID             ABL DEC84
         CLI   SPFVZCMD+1,X'40'       BLANK AFTER F?          ABL JUN85
         BNE   ISPATCK2               NO, BRANCH              ABL JUN85
         CLI   SPFVZCMD,C'F'          F FOR ISPMODE FIND?     ABL JUN85
         BE    ISPATCK3               YES, BRANCH             ABL JUN85
         CLI   SPFVZCMD,C'F'-X'40'    F FOR ISPMODE FIND?     ABL JUN85
         BNE   ISPATCK2               NO, BRANCH              ABL JUN85
ISPATCK3 DS    0H          ****    FIND  SUBCOMMAND  ****     ABL JUN85
         MVC   SPFMSGID,ISPBLK8       CLEAR THE ERROR MESSAGE ABL JUN85
         MVC   PUTGETBF(4),ISPLEN2    AL2(254,0)              ABL JUN85
         MVC   SPFINPUT(250),SPFVZCMD CURRENT SUBCOMMAND      ABL JUN85
         LA    R15,SPFINPUT+1        FIRST BLANK AFTER CMD    ABL JUN85
         LA    R14,46                TRY FOR 46 BYTES         ABL JUN85
         LA    R1,ISPPARFD           PARSE LIST               ABL JUN85
         L     R4,ISPPARSA           PARSE ROUTIME            ABL JUN85
         BALR  R3,R4                                          ABL JUN85
         C     R15,ISPL8             RETURN CODE              ABL JUN85
         BH    ISPATCK2                                       ABL JUN85
         MVI   SPFTBL+2,C'S'      TABLE NAME "PDS"            ABL JUN85
         L     R4,ISPFLOGA                                    ABL JUN85
         BALR  R3,R4                                          ABL JUN85
         B     ISPATCK                                        ABL JUN85
ISPATCK4 DS    0H                                             ABL DEC84
         LA    R14,0                                           SS JUL84
         STH   R14,SPFCKPT        RESET CKPT VALUE             SS JUL84
         L     R14,SPFLAST                                     SS JUL84
         CH    R14,SPFMAX         OVER MAX                     SS JUL84
         BL    ISPEXIT                                         SS JUL84
*            CODE TO DELETE OLD OUTPUT IF OVER TABLE MAX       SS JUL84
         LH    R14,SPFMAX         MAX                          SS JUL84
         LNR   R14,R14            NEGATIVE .. BACKUP VALUE     SS JUL84
         ST    R14,SPFFIXE2       SAVE                         SS JUL84
         A     R14,SPFLAST        CALC DEL AMOUNT              SS JUL84
         ST    R14,SPFFIXED       SAVE                         SS JUL84
         L     R1,SPFSTART                                     SS JUL84
         SR    R1,R14             ADJUST SPFSTART              SS JUL84
         BP    ISPSTOK            NEGATIVE IS THAT LINE DELETE SS JUL84
         LA    R1,1               DISPLAY AT LINE 1            SS JUL84
ISPSTOK  ST    R1,SPFSTART        NEW START LINE VALUE         SS JUL84
         BAL   R2,ISPDEL          POSITION AND DELETE          SS JUL84
         BAL   R2,ISPQUERY        NEW TABLE SIZE               SS JUL84
         B     ISPEXIT                                         SS JUL84
ISPNWCMD DS    0H                                              SS JUL84
         MVC   PMEMCURR(4),PMEMMAX   TERMINATE MEMBER LIST    ABL APR85
         NI    FLAGSAA,255-FMEM#MEM  TURN OFF MEMBER RANGE     SS JUL84
         LA    R14,0
         STH   R14,SPFCKPT        RESET CKPT VALUE             SS JUL84
         LM    R1,R8,SPFSAV1                                   SS JUL84
         L     R14,SPFSAV14                                    SS JUL84
         BR    R14                ATT RETURN                   SS JUL84
         SPACE 3
*                                                              SS JUL84
*  DISPLAY OUTPUT FROM LAST CMD .. ASK FOR NEW CMD             SS JUL84
*                                                              SS JUL84
ISPPTGET DS    0H                                              SS JUL84
         LA    R1,PUTGETBF            SETUP BUFFER             SS JUL84
         ST    R1,ADDRCBUF                        ADDRESS      SS JUL84
         L     R1,SPFSAV1         OUTPUT BUFFER                SS AUG84
         NI    SPFLAG2,255-SPFSEQ-SPFUPDA CLEAR EVERY TIME     SS SEP84
         NI    SPFLAG4,255-SPF38XA  CLEAR PROMPTING FLAG      ABL DEC84
         CLI   10(R1),C'A'          POSSIBLE PDS38XA MESSAGE? ABL DEC84
         BNE   ISPPTGT1             NO, BRANCH                ABL DEC84
         CLC   4(4,R1),ISP300A      PDS3...?                  ABL DEC84
         BNE   ISPPTGT1             NO, BRANCH                ABL DEC84
         CLI   8(R1),C'8'           PDS38.. OR PDS39..?       ABL DEC84
         BL    ISPPTGT1             NO, BRANCH                ABL DEC84
         TM    9(R1),X'F0'          PDS38X. OR PDS39X.?       ABL DEC84
         BNO   ISPPTGT1             NO, BRANCH                ABL DEC84
         OI    SPFLAG4,SPF38XA      YES, SET A FLAG FOR LATER ABL DEC84
         TM    SPFLAG2,SPFMEMA    IS MEMLIST ACTIVE?          ABL APR85
         BZ    ISPPTGT0           NO, SKIP                    ABL APR85
         TM    SPFLAG0,SPFVIEW    VIEW MODE ALREADY?          ABL APR85
         BO    ISPPTGT1           YES, SKIP                   ABL APR85
         OI    SPFLAG0,SPFVIEW    FORCE VIEW MODE             ABL MAR85
         MVC   SPFMSGID,ISPPDSM   SET MESSAGE ID              ABL JUN85
         MVI   SPFMSGID+6,C'1'    MODIFY MESS TO PDSM711R     ABL JUN85
         MVI   SPFMSGID+7,C'R'                                ABL JUN85
         B     ISPPTGT1                                       ABL APR85
ISPPTGT0 DS    0H                                             ABL APR85
         TM    SPFLAG4,SPFCPOST   COMMAND POST PROCESSING     ABL APR85
         BNO   ISPPTGT1           NO, BRANCH                  ABL APR85
         BAL   R2,ISPADDLN        YES, DISPLAY IT             ABL APR85
         B     ISPDISP4           DISPLAY USING VIEW MODE     ABL APR85
ISPPTGT1 DS    0H                                             ABL DEC84
         TM    SPFLAG3,SPFCHN     HAS CHANGE DSN BEEN DONE     SS SEP84
         BZ    ISPPTGT2           NO, SKIP                     SS AUG84
         NI    SPFLAG3,255-SPFCHN-SPF300A CLEAR                SS SEP84
         BAL   R2,ISPTBT#M        TERMINATE MEMLIST TABLE     ABL OCT84
         L     R1,SPFSAV1         OUTPUT BUFFER                SS AUG84
ISPPTGT2 DS    0H                                              SS SEP84
         CLC   4(7,R1),ISP300A    SAME OLD MSG                 SS AUG84
         BE    ISPPTGT3           YES, CHECK                   SS AUG84
         BAL   R2,ISPADDLN        NO, DISPLAY IT               SS AUG84
         B     ISPDISPL                                        SS SEP84
ISPPTGT3 DS    0H                                              SS SEP84
         TM    SPFLAG3,SPF300A    HAS 300A OUTPUT ONCE         SS SEP84
         BO    ISPDISPL           YES, SKIP                    SS SEP84
         OI    SPFLAG3,SPF300A    NOW 300A OUTPUT ONCE         SS SEP84
         BAL   R2,ISPADDLN        DISPLAY IT                   SS AUG84
ISPDISPL DS    0H                                              SS JUL84
         TM    SPFLAG4,SPFCPOST   COMMAND POST PROCESSING      SS NOV84
         BO    ISPCPOST           YES                          SS NOV84
         TM    SPFLAG2,SPFPOST    POST PROCESSING REQUIRED     SS SEP84
         BO    ISPPOST            YES                          SS SEP84
         TM    SPFLAG4,SPFMCMD    MULTY CMD                    SS NOV84
         BO    ISPMCMD            YES                          SS NOV84
         TM    SPFLAG3,SPFCONV    CONVERT AN ERROR TO VIEW?   ABL OCT84
         BNO   ISPDISP6           NO, BRANCH                  ABL OCT84
         TM    SPFLAG0,SPFMSGER   ANY ERRORS?                 ABL OCT84
         BNO   ISPDISP6           NO, BRANCH                  ABL OCT84
         OI    SPFLAG0,SPFVIEW    VIEW MODE NOW               ABL OCT84
ISPDISP6 DS    0H                                             ABL OCT84
         TM    SPFLAG4,SPFCPOST   COMMAND POST PROCESSING      SS NOV84
         BO    ISPCPOST           YES                          SS NOV84
         TM    SPFLAG4,SPFMCMD    MULTY CMD                    SS NOV84
         BO    ISPMCMD            YES                          SS NOV84
         TM    SPFLAG2,SPFPOST    POST PROCESSING STILL        SS NOV84
         BO    ISPDISP4           YES                          SS NOV84
         TM    SPFLAG0,SPFVIEW    VIEW MODE                    SS SEP84
         BO    ISPDISP4           YES                          SS SEP84
         TM    SPFLAG2,SPFMEMA    ACTIVE MEMLIST               SS SEP84
         BO    ISPMMLDS           YES, DISPLAY IT              SS SEP84
ISPDISP4 DS    0H                                              SS SEP84
         MVI   SPFTBL+2,C'S'      TABLE NAME "PDS"             SS SEP84
         L     R15,SPFSTART       REPOSITION TO HERE           SS MAY85
         S     R15,SPFLAST        CALCULATE RELATIVE POSTION   SS MAY85
         BAL   R2,ISPSKIP                                      SS MAY85
ISPDISP2 DS    0H                                              SS JUL84
         MVI   SPFLAG1,0          RESET ACTION FLAG           ABL OCT84
         MVI   SPFTBL+2,C'S'      TABLE NAME "PDS"             SS SEP84
         MVI   SPFPANEL+5,C'1'    PANEL NAME                   SS SEP84
         TM    SPFLAG0,SPFVIEW    VIEW MODE                    SS SEP84
         BZ    ISPDISP3           NO                           SS SEP84
         MVI   SPFPANEL+5,C'2'    PANEL NAME                   SS SEP84
ISPDISP3 DS    0H                                              SS SEP84
         TM    SPFLAG2,SPFPOST    POST PROCESSING VIEW MODE    SS SEP84
         BZ    ISPDISP5           YES                          SS SEP84
         MVI   SPFPANEL+5,C'4'    PANEL NAME                   SS SEP84
ISPDISP5 DS    0H                                              SS JUL84
         L     R4,ISPTBDSA        GET ADDRESS OF SUBR          SS MAR85
         BALR  R3,R4              DISPLAY TABLE PANEL          SS MAR85
         CLI   SPFFIXED+3,8           RETURN FROM PANEL 1?    ABL DEC84
         BE    ISPEND                 YES, BRANCH             ABL DEC84
         BAL   R2,ISPQUERY                                     SS JUL84
         MVC   SPFSTART,SPFTDTOP  SAVE INFO                    SS NOV84
         MVC   PUTGETBF(4),ISPLEN     AL2(52,0)               ABL OCT84
         MVC   SPFINPUT(48),SPFVZCMD                           SS NOV84
         CLC   SPFVZCMD+48(8),ISPBLK8  ANY ADDITIONAL OPERS?  ABL JUN85
         BE    ISPOPTT                 NO, BRANCH             ABL JUN85
         MVC   PUTGETBF(4),ISPLEN2     AL2(254,0)             ABL JUN85
         MVC   SPFINPUT(250),SPFVZCMD  CURRENT SUBCOMMAND     ABL JUN85
         B     ISPOPTT                                         SS NOV84
         SPACE 2                                              ABL OCT84
*    FUNCTION SELECTION                                        SS NOV84
ISPOPTT  DS    0H                                              SS NOV84
         TM    SPFLAG2,SPFPOST    LINE VIEW MODE               SS NOV84
         BO    ISPOPTP            YES                          SS NOV84
         TM    SPFLAG0,SPFVIEW    VIEW MODE                    SS NOV84
         BO    ISPOPTV            YES                          SS NOV84
         TM    SPFLAG2,SPFMEMA    MEMLIST MODE                 SS NOV84
         BO    ISPOPTM            YES                          SS NOV84
         L     R14,ISP$TLIA       ISPMODE                      SS NOV84
         B     ISPOPT2                                         SS NOV84
ISPOPTP  L     R14,ISP$TLPA       GET                          SS NOV84
         B     ISPOPT2                THE                      SS NOV84
ISPOPTV  L     R14,ISP$TLVA               RIGHT                SS NOV84
         B     ISPOPT2                          TABLE          SS NOV84
ISPOPTM  L     R14,ISP$TLMA                                    SS NOV84
         B     ISPOPT2                                         SS NOV84
ISPOPT2  DS    0H                                              SS NOV84
         LA    R1,SPFINPUT        POINT TO INPUT               SS NOV84
         BAL   R2,ISPVERG         CHECK IT                     SS NOV84
         C     R15,ISPL8                                       SS NOV84
         BE    ISPOPTIV           TOO LONG                     SS NOV84
         CH    R15,ISPH12                                      SS NOV84
         BE    ISPOPT3            SHOULD BE A COMMAND          SS NOV84
         C     R15,ISPL4                                       SS NOV84
         BNE   ISPOPT4                                         SS NOV84
         BAL   R2,ISPTBT#M        KILL MEMLIST                 SS NOV84
         L     R14,MEMLTPT                                     SS NOV84
ISPOPT4  DS    0H                                              SS NOV84
         L     R15,SPFOPER                                     SS NOV84
         CLI   0(R15),C'.'        DOT                          SS NOV84
         BNE   ISPFUNC                                         SS NOV84
         MVC   MEMLSAVZ,SPFINPUT  SAVE FOR4                    SS NOV84
         OI    SPFLAG4,SPFMCMD                                 SS NOV84
         B     ISPFUNC                                         SS NOV84
ISPOPT3  DS    0H                                              SS NOV84
         CLI   SPFNAMEH,C'0'      NUMERIC?                    ABL DEC84
         BL    ISPFUNC            NO, MUST BE A COMMAND        SS NOV84
         B     ISPOPTIV           MUST BE INVALID              SS NOV84
ISPMCMD  DS    0H                                              SS NOV84
         NI    SPFLAG4,255-SPFMCMD  RESET FLAG                 SS NOV84
         MVI   SPFVZCMD,C' '                                   SS NOV84
         MVC   SPFVZCMD+1(249),SPFVZCMD                        SS NOV84
         MVC   SPFVZCMD(L'MEMLSAVZ),MEMLSAVZ GET OLD CMD       SS NOV84
         BAL   R2,ISPSHCMD        EXTRACT NEXT COMMAND         SS NOV84
         MVC   SPFINPUT(L'MEMLSAVZ),SPFVZCMD                   SS NOV84
         B     ISPOPTT                                         SS NOV84
         SPACE 2                                               SS NOV84
*                                                              SS NOV84
* PANEL MESSAGE SETUP                                          SS NOV84
*                                                              SS NOV84
ISPOPTIV DS    0H                                              SS NOV84
         TM    SPFLAG4,SPF38XA    PROMPTING MESSAGE?          ABL DEC84
         BO    ISPCMDCN           YES, ALLOW THIS INPUT       ABL DEC84
         MVC   SPFMSGID,ISPPDSM   SET UP INVALID MSG           SS NOV84
         MVC   SPFMSGID+6(1),SPFPANEL+5                        SS NOV84
         B     ISPDISP6                                        SS NOV84
ISPMSGIN DS    0H                                              SS NOV84
         MVC   SPFMSGID,ISPPDSM   SET UP ENTER OPTION MSG      SS NOV84
         MVI   SPFMSGID+6,C'9'                                 SS NOV84
         MVI   SPFMSGID+7,C'E'                                 SS NOV84
         B     ISPDISP6                                        SS NOV84
         SPACE 3                                               SS NOV84
ISPFUNC  DS    0H                                              SS NOV84
         L     R14,MEMLTPT                                     SS NOV84
         SR    R15,R15                                         SS NOV84
         IC    R15,$TLFU(R14)                                  SS NOV84
         B     *+4(R15)                                        SS NOV84
* COMMON FUCTIONS                                              SS NOV84
         B     ISPEND          0                               SS NOV84
         B     ISPSUSP         4                               SS NOV84
         B     ISPKLEAR        8                               SS NOV84
         B     ISPTRUN        12                               SS NOV84
         B     ISPCLIP        16                               SS NOV84
         B     ISPOFFIT       20                               SS NOV84
         B     ISPCMDCK       24                               SS NOV84
         B     ISPOPTIV       28                               SS NOV84
         B     ISPMSGIN       32                               SS NOV84
         B     ISPALL         36                               SS NOV84
         B     ISPDISP6       40                               SS NOV84
         B     ISPRCAL        44                               SS NOV84
         B     ISPSETP        48                               SS NOV84
* MEMLIST ONLY FUCTIONS                                        SS NOV84
         B     ISPOFFIT       52                               SS NOV84
         B     ISPTOMML       56                               SS NOV84
         B     ISPDISPX       60                              ABL JUN85
         B     ISPREFR        64      NOT USED                 SS NOV84
         B     ISPTOVW        68                               SS NOV84
         B     ISPMMOFF       72                               SS NOV84
         B     ISPCKSHF       76                               SS NOV84
         B     ISPCKALI       80                               SS NOV84
         B     ISPLOCAT       84                               SS NOV84
         B     ISPLNX         88                               SS NOV84
*                                                              SS NOV84
* MORE COMMON FUNCTIONS                                        SS NOV84
*                                                              SS NOV84
         B     ISPUTL11       92      SET UP UT1 CMD           SS NOV84
         B     ISPFIND        96      FIND                     SS NOV84
*        B     ISPXXXXX      100      NOT USED                 SS NOV84
         SPACE 2                                               SS NOV84
ISPCPOST DS    0H                                              SS NOV84
         NI    SPFLAG4,255-SPFCPOST                            SS NOV84
         L     R14,MEMLTPT         GET MY TABLE ENTRY          SS NOV84
         SR    R15,R15                                         SS NOV84
         IC    R15,MEMFLAG1         GET POST PROCESSOR INDEX   SS NOV84
         B     *+4(R15)             INDEX TO PROCESSOR         SS NOV84
         B     ISPSETPP          0  PANEL POST PROCESS         SS NOV84
*        B     ISPDISP6          4  PAD                        SS NOV84
         B     ISPMGRP           4  MEMLIST * (LAST GROUP)     SS MAR85
         B     ISPMEMG           8  MEMLIST GROUP FROM SPFSAVZ SS MAR85
         B     ISPDISP6          12 PAD                        SS MAR85
         SPACE 2                                               SS NOV84
ISPCMDCK DS    0H                   CHECK FOR A PDS COMMAND    SS NOV84
         BAL   R2,ISPVER                                       SS NOV84
         C     R15,ISPL8                                       SS NOV84
         BE    ISPOPTIV                                        SS NOV84
         CH    R15,ISPH12           INVALID COMMAND?           SS NOV84
         BNE   ISPCMDC1             NO, BRANCH                ABL DEC84
         CLI   SPFNAMEH,C'?'        QUESTION MARK?            ABL DEC84
         BE    ISPCMDC0             YES, ALLOW IT             ABL DEC84
         CLI   SPFNAMEH,C'.'        . OF .?                   ABL DEC84
         BE    ISPCMDC0             YES, ALLOW IT             ABL DEC84
         CLI   SPFNAMEH,C'%'        IMPLIED CLIST?            ABL DEC84
         BNE   ISPOPTIV             YES, INCORRECT            ABL DEC84
ISPCMDC0 L     R14,ISPEXECA         ADDRESS OF EXEC           ABL DEC84
         ST    R14,MEMLTPT          SAVE THE ADDRESS          ABL DEC84
ISPCMDC1 DS    0H                                             ABL DEC84
         TM    0(R14),#S            SOURCE ONLY?               SS NOV84
         BZ    ISPCMDC2             NO, BRANCH                 SS NOV84
         TM    FLAGSCC,RECFMU       LOAD LIBRARY?              SS NOV84
         BO    ISPOPTIV             YES, BAD                   SS NOV84
         B     ISPCMDC3                                        SS NOV84
ISPCMDC2 DS    0H                                              SS NOV84
         TM    0(R14),#U            LOAD LIBRARY ONLY?         SS NOV84
         BZ    ISPCMDC3             NO, BRANCH                 SS NOV84
         TM    FLAGSCC,RECFMU       LOAD LIBRARY?              SS NOV84
         BZ    ISPOPTIV             NO, BAD                    SS NOV84
ISPCMDC3 DS    0H                                              SS NOV84
         TM    $TLF2(R14),#T         COMMAND PROCESS PROVIDED  SS MAR85
         BZ    ISPCMDC7              NO, BRANCH                SS MAR85
         TM    0(R14),#L             ALSO A LINE COMMAND       SS MAR85
         BZ    ISPFUNC               NO,  GOOD FUNCTION CODE   SS MAR85
*  FUNC CODE IS SET FOR LINE COMMANDS, MUST SCAN ALTERNATE     SS MAR85
*  TABLE FOR THIS COMMAND TO GET COMMAND LINE FUNCTION CODE    SS MAR85
         L     R14,ISP$TLXA          GET ALTERNATE TABLE       SS MAR85
         B     ISPOPT2               FIND COMMAND              SS MAR85
ISPCMDC7 DS    0H                                             ABL DEC84
         TM    SPFLAG2,SPFMEMA      IS IT ACTIVE               SS MAR85
         BZ    ISPCMDC4             NOTHING TO DO              SS MAR85
         TM    0(R14),#K            INACTIVATE MEMLIST?        SS MAR85
         BZ    ISPCMDCZ             NO, BRANCH                 SS MAR85
         TM    $TLF2(R14),#M        REDO MEMLIST WITH LAST GRP SS MAR85
         BZ    ISPCMDCM             NO                         SS MAR85
         TM    SPFLAG0,SPFVIEW      ALREADY IN VIEW MODE?     ABL JUN85
         BO    ISPCMDCM             YES, DO NOT REACTIVATE    ABL JUN85
         MVI   MEMFLAG1,4           CMD POST PROCESS NUM 4     SS MAR85
         OI    SPFLAG4,SPFCPOST     SET POST PROC FLAG         SS MAR85
ISPCMDCM DS    0H                                              SS MAR85
         BAL   R2,ISPTBT#M          INACTIVATE MEMLIST         SS NOV84
         L     R14,MEMLTPT                                     SS NOV84
         B     ISPCMDC4                                        SS MAR85
ISPCMDCZ DS    0H                                              SS MAR85
         TM    $TLF2(R14),#M         COULD CHANGE STATS        SS MAR85
         BZ    ISPCMDC4                                        SS MAR85
         MVI   MEMFLAG1,8           CMD POST PROCESS NUM 8     SS MAR85
         OI    SPFLAG4,SPFCPOST     SET POST PROC FLAG         SS MAR85
ISPCMDC4 DS    0H                                              SS NOV84
         TM    $TLF2(R14),#2         TERMINATE VIEW MODE?     ABL DEC84
         BNO   ISPCMDC8              NO, BRANCH               ABL DEC84
         NI    SPFLAG0,255-SPFVIEW   YES, TURN OFF VIEW MODE  ABL DEC84
ISPCMDC8 DS    0H                                             ABL DEC84
         TM    SPFLAG0,SPFVIEW       IN VIEW MODE?            ABL DEC84
         BO    ISPCMD                YES, BRANCH               SS NOV84
         TM    SPFLAG2,SPFMEMA       MEMBER LIST ACTIVE?       SS NOV84
         BZ    ISPCMD                NO, BRANCH                SS NOV84
         NI    SPFLAG3,255-SPFCONV                             SS NOV84
         NI    SPFLAG0,255-SPFCKER-SPFMSGER                    SS NOV84
         TM    0(R14),#E             NO MATCH                  SS NOV84
         BO    ISPOPTIV              INVALID MSG               SS NOV84
         OI    SPFLAG0,SPFVIEW       NOW GOING INTO VIEW MODE  SS NOV84
         TM    0(R14),#V             VIEW ALWAYS REQUIRED?    ABL DEC84
         BO    ISPCMD                YES, BRANCH              ABL DEC84
         NI    SPFLAG0,255-SPFVIEW   TURN OFF SPFVIEW          SS NOV84
         OI    SPFLAG0,SPFCKER       CHECK FOR PDS ERROR MSGS  SS NOV84
         OI    SPFLAG3,SPFCONV       CONVERT ERROR --> VIEW    SS NOV84
         B     ISPCMD                                          SS NOV84
ISPCMD   DS    0H                                              SS NOV84
         LH    R15,PUTGETBF       GET LENG                     SS NOV84
         BCTR  R15,0              LESS 1 MVC                   SS NOV84
ISPCMDM  MVC   SPFZSAV(0),PUTGETBF                             SS NOV84
         EX    R15,ISPCMDM        SAVE CMD FOR RECALL          SS NOV84
ISPCMDCN DS    0H                                             ABL DEC84
         OI    SPFLAG3,SPFLOGM    LOG THE COMMAND              SS DEC84
         B     ISPCMDC                                         SS NOV84
ISPCMDL  DS    0H                                              SS NOV84
         MVC   MEMLTPT2,MEMLTPT   SAVE CMD FOR REPEAT          SS NOV84
         B     ISPCMDC                                         SS NOV84
ISPCMDC  DS    0H                                              SS NOV84
         NI    SPFLAG4,255-SPF38XA  NOT PROMPTING NOW         ABL DEC84
         L     R15,SPFLAST          SAVE INFO                  SS JUL84
         ST    R15,SPFSTART                                    SS JUL84
         LA    R1,PUTGETBF                                    ABL OCT84
         ST    R1,SPFSAV1                                     ABL OCT84
         LA    R15,1(,R15)                                    ABL OCT84
         TM    SPFLAG3,SPFLOGM    TO BE LOGGED?               ABL OCT84
         BNO   ISPNOLOG           NO, BRANCH                  ABL OCT84
         ST    R15,SPFSTART                                   ABL OCT84
         LH    R3,0(,R1)          GET BUFFER LENGTH            SS MAY85
         LA    R4,4(,R1)                                       SS MAY85
         S     R3,ISPL4           LESS -4 FOR HEADER           SS MAY85
         MVI   SPFLINE,C'>'       FLAG CMD LINE                SS MAY85
ISPCOLP  MVI   SPFLINE+1,C' '     BLANK                        SS MAY85
         MVC   SPFLINE+2(77),SPFLINE+1 RIPPLE                  SS MAY85
         CH    R3,ISPH78          LENGTH 78                    SS MAY85
         BNH   ISPCOLPL           LESS , LAST                  SS MAY85
         CLC   SPFLINE+1(78),0(R4) IS IT A BLANK LINE          SS MAY85
         BE    ISPCOLPN           YES SKIP TO NEXT             SS MAY85
         MVC   SPFLINE+1(78),0(R4) COPY GOOD LINE              SS MAY85
         BAL   R2,ISPADDCO        PUT IT INTO THE TABLE        SS MAY85
         MVI   SPFLINE,C'-'       FLAG ADDITIONAL LINES        SS MAY85
ISPCOLPN LA    R4,78(,R4)         NEXT PART OF LINE            SS MAY85
         SH    R3,ISPH78          REDUCE BY LENGTH             SS MAY85
         B     ISPCOLP                                         SS MAY85
ISPCOLPL BCTR  R3,0               ONE LESS FOR MVC             SS MAY85
         CLC   SPFLINE+1(0),0(R4) IS IT A BLANK LINE           SS MAY85
         EX    R3,*-6             EXECUTE IT                   SS MAY85
         BE    ISPCOLPS                                        SS MAY85
         MVC   SPFLINE+1(0),0(R4) COPY TO OUTPUT LINE          SS MAY85
         EX    R3,*-6             EXECUTE IT                   SS MAY85
         BAL   R2,ISPADDCO                                     SS MAY85
ISPCOLPS DS    0H                                              SS MAY85
*        BAL   R2,ISPADDLN        YES, ECHO THE INPUT LINE     SS MAY85
         NI    SPFLAG3,FF-SPFLOGM LOGGED NOW                  ABL OCT84
ISPNOLOG DS    0H                                             ABL NOV84
         TM    FLAGSFF,FLOGWRT    LOGGING TO A DATA SET?      ABL NOV84
         BNO   ISPNOLDS           NO, BRANCH                  ABL NOV84
         LA    R1,PUTGETBF        POINT TO THE DATA LINE      ABL NOV84
         BAL   R14,LOGDATA        LOG TO THE DATA SET         ABL NOV84
ISPNOLDS DS    0H                                             ABL NOV84
         LA    R14,0                                           SS JUL84
         STH   R14,SPFCKPT                                     SS JUL84
*            CODE TO DELETE OLD OUTPUT IF OVER TABLE SIZE      SS JUL84
         L     R14,SPFLAST        CURRENT SIZE                 SS JUL84
         CH    R14,SPFSIZE        SIZE LIMIT                   SS JUL84
         BNH   ISPSZOK            NOT TO BIG                   SS JUL84
         SH    R14,SPFSIZE        CALC DELETE AMOUNT           SS JUL84
         ST    R14,SPFFIXED       SAVE DELETE COUNT            SS JUL84
         LH    R14,SPFSIZE        TABLE SIZE                   SS JUL84
         LNR   R14,R14                NEGATIVE                 SS JUL84
         ST    R14,SPFFIXE2       SAVE SKIP COUNT              SS JUL84
         BAL   R2,ISPDEL          GO DELETE                    SS JUL84
         BAL   R2,ISPQUERY       GET NEW SIZE                  SS JUL84
         L     R15,SPFLAST        SAVE INFO                    SS JUL84
         ST    R15,SPFSTART                                    SS JUL84
ISPSZOK  DS    0H                                              SS NOV84
         B     ISPEXIT                                         SS NOV84
         SPACE 2                                              ABL OCT84
ISPEND   MVC   PUTGETBF(13),ISPENDIT END COMMAND INTO BUFFER   SS JUL84
         MVC   PMEMCURR(4),PMEMMAX   TERMINATE MEMBER LIST    ABL APR85
         NI    FLAGSAA,255-FMEM#MEM  TURN OFF MEMBER RANGE     SS JUL84
         SPACE 1
         CLI   PDSENTRY+3,0          ENTRY FROM SPF PANEL?    ABL OCT84
         BE    ISPCLN                YES, NO PROBLEM          ABL OCT84
         BAL   R2,ISPCTLSM                                     SS MAR85
         B     ISPCLN                                          SS JUL84
ISPSUSP  MVC   PUTGETBF(13),ISPDSNMG DSN COMMAND INTO BUFFER   SS JUL84
         NI    SPFLAG0,255-SPFDON    TURN DIALOG DISPLAY OFF   SS JUL84
         OI    SPFLAG0,SPFDSUSP      SUSPEND BIT ON            SS JUL84
         BAL   R2,ISPTBT#M           MAKE SURE MEMLIST ENDED   SS DEC84
         BAL   R2,ISPCTLSM                                     SS MAR85
         B     ISPEXIT                                         SS JUL84
ISPOFFIT MVC   PUTGETBF(13),ISPDSNMG DSN COMMAND INTO BUFFER   SS JUL84
         LA    R0,ISPCNTL                 FIRST PARAMETER     ABL SEP84
         LA    R1,ISPDSP                  SECOND PARAMETER    ABL SEP84
         LA    R2,ISPSM                   THIRD PARAMETER     ABL SEP84
         LA    R3,=F'1'                   FOURTH PARAMETER    ABL SEP84
         STM   R0,R3,PARMLIST             SAVE ADDRESSES      ABL SEP84
         OI    PARMLIST+12,X'80'          LAST                ABL SEP84
         LA    R1,PARMLIST                    PARAMETER       ABL SEP84
         L     R15,ISPLINK                                    ABL SEP84
         BALR  R14,R15                    LET SPF KNOW        ABL SEP84
         B     ISPCLN                                          SS JUL84
ISPKLEAR DS    0H                                              SS JUL84
         BAL   R2,ISPTBT#S         TERMINATE ISPMODE TABLE    ABL OCT84
         BAL   R2,ISPCREAT                                     SS JUL84
         B     ISPDISP6                                        SS NOV84
ISPTRUN  DS    0H                                              SS JUL84
         L     R14,SPFLAST         SIZE                        SS JUL84
         S     R14,SPFTDTOP        LESS DISPLAY POSITION       SS JUL84
         ST    R14,SPFFIXED        DEL THIS AMOUNT             SS JUL84
         LA    R14,0               NO POSITIONING              SS JUL84
         ST    R14,SPFFIXE2            IS LAST ENTRY           SS JUL84
         BAL   R2,ISPDEL           POSITION AND DELETE         SS JUL84
         BAL   R2,ISPQUERY         NEW TABLE SIZE              SS JUL84
         L     R14,SPFLAST         DISPLAY AT BOTTOM OF TABLE  SS JUL84
         ST    R14,SPFSTART                                    SS JUL84
         B     ISPDISP6            REDISPLAY                   SS NOV84
ISPCLIP  DS    0H                                              SS JUL84
         L     R14,SPFTDTOP        DISPLAY TOP                 SS JUL84
         LTR   R14,R14             AT TOP                      SS JUL84
         BZ    ISPCLIP2            YES NO CLIP                 SS JUL84
         BCTR  R14,0               POSITION ONE UP             SS JUL84
         LTR   R14,R14             AT TOP                      SS JUL84
         BZ    ISPCLIP2            YES NO CLIP                 SS JUL84
         ST    R14,SPFFIXED        DEL THIS AMOUNT             SS JUL84
         S     R14,SPFLAST         CALC REPOSITION AMOUNT      SS JUL84
         ST    R14,SPFFIXE2        SAVE                        SS JUL84
         BAL   R2,ISPDEL           POSITION AND DELETE         SS JUL84
         BAL   R2,ISPQUERY         NEW TABLE SIZE              SS JUL84
ISPCLIP2 LA    R14,1               DISPLAY AT TOP OF TABLE     SS JUL84
         ST    R14,SPFSTART                                    SS JUL84
         B     ISPDISP6            REDISPLAY                   SS NOV84
         SPACE 3                                               SS JUL84
ISPTOMML DS    0H                                              SS SEP84
         NI    SPFLAG0,255-SPFVIEW   TURN OFF SPFVIEW          SS SEP84
         B     ISPDISP6                                        SS NOV84
ISPDISPX L     R4,ISPDISPA                                    ABL JUN85
         BALR  R3,R4                 DISPLAY CURRENT TABLE    ABL JUN85
         B     ISPDISP6                                       ABL JUN85
ISPREFR  DS    0H                                              SS NOV84
         OI    SPFLAG2,SPFUPDA       MUST BE REFRESHED         SS NOV84
ISPALL   MVC   PUTGETBF(16),ISPMALL  MEMLIST ALL INTO BUFFER  ABL NOV84
         NI    SPFLAG0,255-SPFVIEW   TURN OFF VIEW MODE        SS NOV84
         B     ISPEXIT                                         SS NOV84
         SPACE 2
ISPMGRP  DS    0H                                             ABL JUN85
*        NI    SPFLAG2,255-SPFCPOST                            SS MAR85
         MVC   PUTGETBF(16),ISPMALL  MEMLIST ALL INTO BUFFER   SS MAR85
         MVI   PUTGETBF+12,C'*'      CONVERT TO LAST GROUP     SS MAR85
         B     ISPEXIT                                         SS MAR85
         SPACE 2
ISPMEMG  DS    0H                                             ABL JUN85
*        NI    SPFLAG2,255-SPFCPOST                            SS MAR85
         MVC   PUTGETBF(16),ISPMALL  MEMLIST ALL INTO BUFFER   SS MAR85
         MVI   PUTGETBF+1,13         MODIFY LENGTH FOR INSERT ABL APR85
         CLC   ##SUBCOM+1(7),$ATT+1  ATTRIBUTE SUBCOMMAND?    ABL APR85
         BNE   ISPMEMG2              NO, BRANCH               ABL APR85
         TM    #OPTOPT,X'F0'         ANY CHANGES IN ATTRS?    ABL APR85
         BNO   ISPDISPL              NO, BRANCH               ABL APR85
ISPMEMG2 DS    0H                                             ABL APR85
         LH    R14,SPFZSAV           GET LENGTH                SS MAR85
         SL    R14,ISPL4             LESS 4 FOR PREFIX         SS MAR85
         LA    R15,SPFZSAV+4         ADDR OF OPERATED          SS MAR85
         BAL   R2,ISPCKBLK           FIND FIRST COMMAND        SS MAR85
         LTR   R15,R15               WE OK                     SS MAR85
         BZ    ISPDISPL              NO                        SS MAR85
         LA    R1,C' '               SCAN FOR BLANK            SS MAR85
         BAL   R2,ISPCLI                                       SS MAR85
         LTR   R15,R15               SHORT BUFFER              SS MAR85
         BZ    ISPDISPL                                        SS MAR85
         LA    R1,ISPPARST           GET STRING PARSE          SS MAR85
         L     R4,ISPPARSA           GET ROUTINE ADDR          SS MAR85
         BALR  R3,R4                                           SS MAR85
         MVC   SPFMSGID(8),ISPBLK8   CLEAR ANY MESSAGE        ABL JUN85
         LTR   R15,R15               GOOD                      SS MAR85
         BNZ   ISPMGRP               NO, TRY LAST MEMBER GRP  ABL JUN85
         LH    R1,SPFPRLN            GET STRING LENGTH         SS MAR85
         L     R15,SPFPRSR           GET STRING ADDR           SS MAR85
         EX    R1,ISPMEMG0           COPY IT                   SS MAR85
         AH    R1,PUTGETBF           CALULATE LENGTH OF DATA   SS MAR85
         STH   R1,PUTGETBF           STORE NEW LENGTH          SS MAR85
         OI    SPFLAG2,SPFUPDA       MUST BE REFRESHED         SS MAR84
         B     ISPEXIT                                         SS MAR85
ISPMEMG0 MVC   PUTGETBF+12(0),0(R15) COPY MEMBER OR  GROUP     SS MAR85
         SPACE 2
* FIND SUPPORT                                                 SS MAY85
ISPFIND  DS    0H          ****    FIND  SUBCOMMAND  ****      SS MAY85
         L     R15,SPFOPER           FIRST BLANK AFTER CMD     SS MAY85
         LA    R14,46                TRY FOR 46 BYTES          SS MAY85
         LA    R1,ISPPARFD           PARSE LIST                SS MAY85
         L     R4,ISPPARSA           PARSE ROUTIME             SS MAY85
         BALR  R3,R4                                           SS MAY85
         C     R15,ISPL8             RETURN CODE               SS MAY85
         BH    ISPDISP4                                        SS MAY85
         MVI   SPFTBL+2,C'S'      TABLE NAME "PDS"             SS MAY85
         L     R4,ISPFLOGA                                     SS MAY85
         BALR  R3,R4                                           SS MAY85
         B     ISPDISP4                                        SS MAY85
         SPACE 2
* RECALL SUPPORT                                               SS MAY85
ISPRCAL  DS    0H          ****   RECALL SUBCOMMAND  ****      SS NOV84
         L     R15,SPFOPER           FIRST BLANK AFTER CMD    ABL DEC84
         LA    R14,30                TRY FOR 30 BYTES         ABL DEC84
         LA    R1,ISPPARRE           PARSE LIST                SS MAY85
         L     R4,ISPPARSA           PARSE ROUTIME             SS MAY85
         BALR  R3,R4                                           SS MAY85
         C     R15,ISPL8             RETURN CODE               SS MAY85
         BE    ISPRCAL3                                        SS MAY85
         BH    ISPDISP6                                        SS MAY85
         TM    SPFPRBI,X'01'         FROM LOG                  SS MAY85
         BO    ISPRCAL8                                        SS MAY85
         TM    SPFPRBI,X'20'         CHANGE OPERAND            SS MAY85
         BO    ISPRCAL6                                        SS MAY85
         TM    SPFPRBI,X'10'         ENTER                     SS MAY85
         BO    ISPRCAL5                                        SS MAY85
         B     ISPRCAL3                                        SS MAY85
ISPRCAL5 LH    R15,SPFZSAV           LENGTH                    SS MAR85
         BCTR  R15,0                 MACHINE LENGTH           ABL DEC84
         MVC   PUTGETBF(*-*),SPFZSAV <<EXECUTED>>             ABL DEC84
         EX    R15,*-6               MOVE IN THE SUBCOMMAND   ABL DEC84
         B     ISPOPTT               RESCAN THE SUBCOMMAND    ABL DEC84
ISPRCAL3 DS    0H                                              SS MAR85
         MVI   SPFVZCMD,C' '                                   SS NOV84
         MVC   SPFVZCMD+1(249),SPFVZCMD                        SS NOV84
         LH    R15,SPFZSAV        GET LENG                     SS NOV84
         SH    R15,ISPH5          LESS 5 MVC                   SS NOV84
ISPRCAL2 MVC   SPFVZCMD(0),SPFZSAV+4                           SS NOV84
         EX    R15,ISPRCAL2       SAVE CMD FOR RECALL          SS NOV84
         B     ISPSETP3                                        SS NOV84
ISPRCAL6 DS    0H                                              SS MAY85
         TM    SPFPRBI,X'10'      SHOULD NOT BE ENTER KEY      SS MAY85
         BO    ISPRCAL9           CONFLICT                     SS MAY85
         MVI   SPFVZCMD,C' '                                  ABL APR85
         MVC   SPFVZCMD+1(249),SPFVZCMD                       ABL APR85
         MVC   SPFVZCMD(128),RECALLDS+4  THIS ALLOCATION MSG  ABL APR85
         B     ISPSETP3                                       ABL APR85
ISPRCAL8 DS    0H                                              SS MAY85
         TM    SPFPRBI,X'30'      TEST ENTER AND CHANGE KEY    SS MAY85
         BNZ   ISPRCAL9           CONFLICT                     SS MAY85
         MVI   SPFTBL+2,C'S'      TABLE NAME "PDS"             SS MAY85
         L     R4,ISPRLOGA                                     SS MAY85
         BALR  R3,R4                                           SS MAY85
         LTR   R15,R15                                         SS MAY85
         BZ    ISPSETP3                                        SS MAY85
         B     ISPDISP6                                        SS MAY85
ISPRCAL9 DS    0H                                              SS MAY85
         MVC   SPFMSGID,ISPPDSM   INIT MESSAGE                 SS MAY85
         MVI   SPFMSGID+7,C'A'                                 SS MAY85
         MVI   SPFMSGID+6,C'7'    CONFLICT MESSAGE             SS MAY85
         B     ISPDISP6                                        SS MAY85
         SPACE 2
ISPSETP  DS    0H          ****   O AND T SUBCOMMANDS ****     SS NOV84
         NI    SPFLAG4,255-SPFMCMD  RESET FLAG                 SS NOV84
         MVI   SPFVZCMD,C' '                                   SS NOV84
         MVC   SPFVZCMD+1(249),SPFVZCMD                        SS NOV84
         MVC   MEMLNMSV,ISPBLK8                                SS NOV84
         MVC   SPFMEMB,ISPBLK8                                 SS NOV84
         L     R14,MEMLTPT                                     SS NOV84
         TM    $TLF2(R14),#Z                                   SS NOV84
         BO    ISPSETP2                                        SS NOV84
         LH    R15,PUTGETBF       GET LENG                     SS NOV84
         SH    R15,ISPH5          LESS 5 MVC                   SS NOV84
ISPSETP4 MVC   SPFVZCMD(0),SPFINPUT                            SS NOV84
         EX    R15,ISPSETP4       COPY TO CMD FROM INPUT       SS NOV84
         BAL   R2,ISPSHCMD                                     SS NOV84
         CLI   SPFVZCMD,C' '                                   SS NOV84
         BE    ISPSETP3                                        SS NOV84
ISPSETP2 DS    0H                                              SS NOV84
         OI    SPFLAG3,SPFNOND      INVOKE PANEL NON-DISPLAY   SS NOV84
ISPSETP3 DS    0H                                              SS NOV84
         L     R4,ISPSETVA        SET SERVICE ROUTINE          SS MAR85
         BALR  R3,R4                                           SS MAR85
         L     R1,SPFPANT                                      SS NOV84
         ST    R1,SPFPANC                                      SS NOV84
         L     R14,MEMLTPT                                     SS NOV84
         SR    R15,R15                                         SS NOV84
         IC    R15,$TLEX(R14)                                  SS NOV84
         AL    R15,ISP$PNA                                     SS MAR85
         MVC   SPFPSTK(8),0(R15)                               SS NOV84
ISPSETPP DS    0H                                              SS NOV84
*        NI    SPFLAG2,255-SPFCPOST                           ABL JUN85
         L     R4,ISPPANDA          GET ADDR OF PAN DSP SUBR   SS MAR85
         BALR  R3,R4                                           SS MAR85
         CLC   SPFZSEL(4),ISPCEND                              SS NOV84
         BE    ISPDISP6                                        SS NOV84
         MVC   SPFINPUT(250),SPFZSEL                           SS NOV84
         MVC   PUTGETBF(4),ISPLEN2                             SS NOV84
         L     R14,MEMLTPT                                     SS NOV84
         TM    $TLF2(R14),#Z        NONDISPL                   SS NOV84
         BO    ISPSETP5             YES, THEN NO POST PROC     SS NOV84
         TM    $TLF2(R14),#A        RESCAN.. MULTY FUNC PANEL  SS NOV84
         BZ    ISPSETP5             NO, THEN NO POST PROC      SS NOV84
*        OI    SPFLAG4,SPFCPOST                                SS NOV84
*        MVI   MEMFLAG1,0           ISPSETPP POST PROC         SS NOV84
ISPSETP5 DS    0H                                              SS NOV84
         TM    $TLF2(R14),#A        ACTIVATE RESCAN?           SS NOV84
         BZ    ISPCMDCK             NO, CHECK COMMAND          SS NOV84
         B     ISPOPTT              YES, SELECT FUNCTION       SS NOV84
         SPACE 3                                               SS NOV84
ISPMMLDS DS    0H                                              SS SEP84
         MVI   SPFTBL+2,C'M'        MEMLIST TABLE              SS SEP84
         MVI   SPFPANEL+5,C'5'      SOURCE                     SS SEP84
         TM    FLAGSCC,RECFMU       LOAD LIB                   SS SEP84
         BO    ISPMMLD2                                        SS NOV84
         TM    SPFLAG2,SPFSHIFT     OTHER TABLE                SS NOV84
         BZ    ISPMMLD3                                        SS NOV84
         MVI   SPFPANEL+5,C'6'      OTHER TABLE                SS NOV84
         B     ISPMMLD3                                        SS NOV84
ISPMMLD2 MVI   SPFPANEL+5,C'7'      LOAD                       SS SEP84
         TM    SPFLAG2,SPFSHIFT     OTHER TABLE                SS SEP84
         BZ    ISPMMLD3                                        SS SEP84
         MVI   SPFPANEL+5,C'8'      OTHER TABLE                SS SEP84
ISPMMLD3 DS    0H                                              SS SEP84
         BAL   R2,ISPQUERY                                     SS SEP84
         BAL   R2,ISPOSTN                                      SS SEP84
         L     R4,ISPTBDSA        GET ADDRESS OF SUBR          SS MAR85
         BALR  R3,R4              DISPLAY TABLE PANEL          SS MAR85
ISPMMLD6 DS    0H                                             ABL JUN85
         CLI   SPFFIXED+3,4           MORE THAN ONE LINE CMD?  SS JUL84
         BH    ISPEND                 RETURN FROM PANEL 1     ABL DEC84
         BNE   ISPMMLD8               NO, BRANCH               SS JUL84
         OI    SPFLAG2,SPFMULT        YES, SET BIT             SS SEP84
ISPMMLD8 DS    0H                                              SS SEP84
         L     R15,SPFTDTOP           GET TOP OF SCREEN        SS SEP84
         ST    R15,MEMLTOP            NEXT DISPLAY SAME PLACE  SS SEP84
         BAL   R2,ISPQUERY                                     SS JUL84
         L     R15,MEMLCRP                                     SS SEP84
         LTR   R15,R15                ANY LINE COMMANDS?       SS SEP84
         BNZ   ISPLNCMD                                        SS SEP84
         ST    R15,MEMLCCRP           SET ZERO CURSOR          SS MAR85
ISPMMLD4 DS    0H                                              SS SEP84
         LA    R1,PUTGETBF                                    ABL OCT84
         ST    R1,SPFSAV1                                     ABL OCT84
         MVC   PUTGETBF(4),ISPLEN     AL2(52,0)               ABL OCT84
         MVC   SPFINPUT(48),SPFVZCMD                           SS NOV84
         CLC   SPFVZCMD+48(8),ISPBLK8  ANY ADDITIONAL OPERS?  ABL JUN85
         BE    ISPOPTT                 NO, BRANCH             ABL JUN85
         MVC   PUTGETBF(4),ISPLEN2     AL2(254,0)             ABL JUN85
         MVC   SPFINPUT(250),SPFVZCMD  CURRENT SUBCOMMAND     ABL JUN85
         B     ISPOPTT                                         SS NOV84
         SPACE 2                                              ABL OCT84
ISPMMOFF DS    0H                                              SS SEP84
         BAL   R2,ISPTBT#M           TERMINATE MEMLIST TABLE  ABL OCT84
         NI    SPFLAG0,255-SPFVIEW   TURN OFF VIEW MODE        SS NOV84
         B     ISPDISP6              NORMAL MODE               SS NOV84
ISPLOCAT DS    0H                                             ABL OCT84
         L     R15,SPFOPER           GET BLANK AFTER COMMAND   SS NOV84
         LA    R14,45                LOOK THIS FAR             SS NOV84
         BAL   R2,ISPCKBLK           FIND NON-BLANK OPERAND    SS NOV84
         MVC   MEMLNMSV,0(R15)       COPY OPERAND              SS SEP84
         OC    MEMLNMSV,ISPBLK8      UPPER CASE               ABL OCT84
         L     R4,ISPLOCA            ADDRESS OF LOC SUBR       SS MAR85
         BALR  R3,R4                                           SS MAR85
         NI    MEMFLAG0,255-MEMLGOTT  MAKE SURE TOP RESET      SS SEP84
         B     ISPMMLD3              REDISPLAY NEW PLACE       SS SEP84
ISPTOVW  DS    0H                                              SS SEP84
         OI    SPFLAG0,SPFVIEW       TURN ON  SPFVIEW          SS SEP84
         B     ISPDISP6              DISP IN VIEW MODE         SS NOV84
ISPCKSHF DS    0H                                              SS SEP84
         TM    SPFLAG2,SPFSHIFT     OTHER TABLE                SS SEP84
         BO    ISPMMLD7             YES                        SS SEP84
         OI    SPFLAG2,SPFSHIFT     OTHER TABLE                SS SEP84
         B     ISPDISP6                                        SS NOV84
ISPMMLD7 NI    SPFLAG2,255-SPFSHIFT BACK TO TABLE 6            SS SEP84
         B     ISPDISP6                                        SS NOV84
         SPACE 2                                               SS SEP84
ISPCKALI DS    0H                                              SS SEP84
         L     R4,ISPALICA          GET ADDR OF SUBRTM         SS MAR85
         BALR  R3,R4                CALL ALIAS CHECK SUBRTN    SS MAR85
         B     ISPDISP6             CONTINUE                   SS NOV84
         SPACE 2                                               SS SEP84
*                                                              SS SEP84
*  MEMLIST LINE CMD PROCESSOR                                  SS SEP84
*                                                              SS SEP84
ISPLNCMD DS    0H                                              SS SEP84
         SR    R15,R15              ZERO VALUE                 SS MAR85
         ST    R15,MEMLCCRP         INIT TO ZERO               SS MAR85
         NI    SPFLAG2,255-SPFPOST  RESET FIRST TIME           SS SEP84
         BAL   R2,ISPFIRST          CHECK FOR ANY ZCMD         SS SEP84
         LTR   R15,R15              RETURN RC WILL TELL        SS SEP84
         BZ    ISPLNC2              NO, SKIP SAVE              SS SEP84
         MVC   MEMLSAVZ,SPFVZCMD    SAVE ZCMD                  SS SEP84
         OI    SPFLAG2,SPFZCMD      INDICATE HAVE ZCMD         SS SEP84
ISPLNC2  DS    0H                                              SS SEP84
         NI    SPFLAG0,255-SPFCKER-SPFMSGER   RESET            SS SEP84
         OC    MEMLDATA,ISPBLK8     MAKE UPPER CASE            SS SEP84
         BAL   R2,ISPVERL           CHECK CMD VERB             SS SEP84
         C     R15,ISPL8            IS THIS VALID              SS SEP84
         BH    ISPLNB3              NO                         SS SEP84
         TM    0(R14),#L+#O         IS THIS VALID LINE CMD     SS SEP84
         BZ    ISPLNB3                                         SS SEP84
         TM    0(R14),#S            IS THIS SOURCE ONLY        SS SEP84
         BZ    ISPLNC3                                         SS SEP84
         TM    FLAGSCC,RECFMU       IS IT A LOADMOD?           SS SEP84
         BO    ISPLNB3              YES, BAD                   SS SEP84
         B     ISPLNC4                                         SS SEP84
ISPLNC3  DS    0H                                              SS SEP84
         TM    0(R14),#U            IS THIS LOADMOD ONLY       SS SEP84
         BZ    ISPLNC4                                         SS SEP84
         TM    FLAGSCC,RECFMU       IS IT A LOADMOD?           SS SEP84
         BZ    ISPLNB3              NO,  BAD                   SS SEP84
ISPLNC4  DS    0H                                              SS SEP84
         MVI   MEMFLAG1,0           DEFAULT POST PROCESSOR     SS SEP84
         OI    SPFLAG2,SPFPOST      POST PROCESSING TO GO      SS SEP84
         BAL   R2,ISPDSPSV          SAVE DISPLAY               SS SEP84
         L     R14,MEMLTPT          RESTORE R14                SS SEP84
ISPLNC5  DS    0H                                              SS SEP84
         SR    R15,R15                                         SS SEP84
         IC    R15,4(R14)           GET PROCESSOR INDEX        SS SEP84
         B     *+4(R15)             INDEX TO PROCESSOR         SS SEP84
         B     ISPLNBAD          0  INVALID                    SS SEP84
         B     ISPMMLNL          4  BLANK ENTRY                SS SEP84
         B     ISPDELL           8  DEL MEML ENTRY             SS NOV84
         B     ISPLALI          12  ALIAS                      SS SEP84
         B     ISPGEN           16  GENERAL PROCESSOR          SS SEP84
         B     ISPLDEL          20  DELETE                     SS SEP84
         B     ISPLREN          24  RENAME                     SS SEP84
         B     ISPLNBAD         28  UNDO                       SS SEP84
         B     ISPLPND          32  SELECT PANEL SUPPORT       SS NOV84
         B     ISPSTAT1         36  STATUS COMMAND             SS SEP84
         B     ISPUTL1          40  UTILITY COMMANDS           SS SEP84
         B     ISPMMLD4         44  PAD                        SS SEP84
         SPACE 3                                               SS SEP84
ISPLERR  DS    0H                                              SS SEP84
         NI    SPFLAG0,255-SPFCKER-SPFMSGER   RESET            SS SEP84
         MVC   MEMLDATA,ISPERMSG                               SS SEP84
         MVC   SPFMSGID,ISPPDSM   INIT MESSAGE                ABL JUN85
         MVI   SPFMSGID+7,C'A'                                ABL JUN85
         MVI   SPFMSGID+6,C'1'    GENERAL ERROR MESSAGE       ABL JUN85
         B     ISPLNB2          CONTINUE                       SS SEP84
ISPLNBAD DS    0H                                              SS SEP84
         MVC   MEMLDATA,ISPINVLD    INVALID MESSAGE            SS SEP84
ISPLNB2  DS    0H                                              SS SEP84
         BAL   R2,ISPDSPRS      RESTORE DISPLAY                SS SEP84
         B     ISPLNB4          CONTINUE                       SS SEP84
ISPLNB3  DS    0H                                              SS SEP84
         MVC   MEMLDATA,ISPINVLD    INVALID MESSAGE            SS SEP84
ISPLNB4  DS    0H                                              SS SEP84
         BAL   R2,ISPMEMOD          UPDATE TABLE LINE          SS SEP84
         BAL   R2,ISPQUERY                                     SS MAR85
         MVC   MEMLCCRP,MEMLCRP     SAVE CUR CPR FOR CURSER    SS MAR85
         NI    SPFLAG2,255-SPFMULT-SPFPOST END OTHER LINE CMDS SS SEP84
         NI    SPFLAG2,255-SPFZCMD  CLEAR FLAGE                SS SEP84
         B     ISPMMLDS             DISPLAY TABLE FROM HERE   ABL DEC84
         SPACE 2                                               SS SEP84
ISPPOST  DS    0H                                              SS SEP84
         L     R14,MEMLTPT         GET MY TABLE ENTRY          SS SEP84
         MVI   SPFTBL+2,C'M'        RESET TO MEMLIST TABLE     SS SEP84
         SR    R15,R15                                         SS SEP84
         IC    R15,MEMFLAG1         GET POST PROCESSOR INDEX   SS SEP84
         B     *+4(R15)             INDEX TO PROCESSOR         SS SEP84
         B     ISPLNX            0  CLEAN UP                   SS SEP84
         B     ISPLNV            4  RETURN AFTER STATS REFRESH SS SEP84
         B     ISPDELP           8  DEL MEML ENTRY             SS SEP84
         B     ISPLALIP         12  ALIAS                      SS SEP84
         B     ISPGENP          16  GENERAL PROCESSOR          SS SEP84
         B     ISPLDELP         20  DELETE                     SS NOV84
         B     ISPLRENP         24  RENAME                     SS SEP84
         B     ISPLNX           28  RESTORE                    SS SEP84
         B     ISPLPNDP         32  SELECT PANEL SUPPORT       SS NOV84
         B     ISPSTAP2         36  STATUS PART 2              SS SEP84
         B     ISPSTAP3         40  STATUS PART 3              SS SEP84
         B     ISPLNX           44  PAD                        SS SEP84
         SPACE 3                                               SS SEP84
ISPLNV   DS    0H                                              SS SEP84
         L     R14,MEMLTPT         GET MY TABLE ENTRY          SS SEP84
         TM    0(R14),#V           VIEW MODE TO FOLLOW         SS SEP84
         BZ    ISPLNX              NO                          SS SEP84
         B     ISPDISP4                                        SS SEP84
ISPMMLNL DS    0H                                              SS MAR85
         CLI   MEMLDATA,C'*'    IS IT A MSG                    SS MAR85
         BNE   ISPMMLNK         NO,  CLEAR                     SS MAR85
         CLC   MEMLDATA,ISPINVLD  INVALID MSG                  SS MAR85
         BNE   ISPMMLN2         NO, DONT CLEAR                ABL JUN85
ISPMMLNK DS    0H                                              SS MAR85
         MVC   MEMLDATA,ISPBLK8    BLANK OUT DATA              SS MAR85
ISPMMLN2 DS    0H                                             ABL JUN85
         BAL   R2,ISPMEMOD      UPDATE TABLE                   SS MAR85
         B     ISPLNX2                                         SS MAR85
ISPLNX   DS    0H                                              SS SEP84
         MVI   SPFTBL+2,C'M'    RESET TO MEMLIST TABLE         SS SEP84
         BAL   R2,ISPQUERY      GET CUR CRP FOR CURSOR         SS MAR85
         MVC   MEMLCCRP,MEMLCRP SAVE CUR CRP                   SS MAR85
ISPLNX2  DS    0H                                              SS MAR85
         NI    SPFLAG2,255-SPFPOST                             SS SEP84
         BAL   R2,ISPDSPRS      RESTORE DISPLAY                SS SEP84
         TM    SPFLAG2,SPFMULT  MORE LINES TO PROCESS         ABL JUN85
         BZ    ISPLNCKZ         NO, CHECK FOR ZCMD            ABL JUN85
ISPREAP1 DS    0H                                             ABL SEP84
         LA    R14,TBDISPL      DISPLAY TABLE                  SS SEP84
         LA    R15,SPFTBL                                      SS SEP84
         STM   R14,R15,PARMLIST  WITH NO                       SS SEP84
         OI    PARMLIST+4,X'80'         TABLE NAME OR MSG      SS SEP84
         LA    R1,PARMLIST                                     SS SEP84
         L     R15,ISPLINK                                     SS JUL84
         BALR  R14,R15                                         SS JUL84
         CLI   FLAGSSS,0          RETURN KEY ACTIVE?          ABL SEP84
         MVI   FLAGSSS,0                                      ABL SEP84
         BNE   ISPREAP1           YES, REPEAT THE TBDISPL     ABL SEP84
         C     R15,ISPL8        FORCED END                     SS SEP84
         BE    ISPEND           YES                            SS SEP84
         BH    ISPERR                                          SS SEP84
         C     R15,ISPL4           STILL MORE LINES AFTER THIS SS SEP84
         BE    ISPLNC2             CONTINUE                    SS SEP84
         NI    SPFLAG2,255-SPFMULT NO MORE AFTER THIS          SS SEP84
         B     ISPLNC2             PROCESS THE LAST            SS SEP84
         SPACE 2
ISPLNCKZ OI    SPFLAG2,SPFZPOS  SET TO HONOR POSITIONING      ABL JUN85
         TM    SPFLAG2,SPFZCMD  ZCMD TO PROCESS?              ABL JUN85
         BNO   ISPMMLDS         NO, BRANCH                    ABL JUN85
         NI    SPFLAG2,255-SPFZPOS  NO POSITIONING POSSIBLE   ABL JUN85
         MVC   SPFVZCMD(L'MEMLSAVZ),MEMLSAVZ RESTOR ZCMD      ABL JUN85
         NI    SPFLAG2,255-SPFZCMD RESET FLAG                  SS SEP84
         LA    R0,80              CHARACTERS TO SCAN          ABL JUN85
         LA    R1,SPFVZCMD+80     WHERE TO START SCAN         ABL JUN85
ISPLNLB  CLI   0(R1),X'40'        BLANK?                      ABL JUN85
         BNE   ISPLNLNB           NO, BRANCH                  ABL JUN85
         BCTR  R1,0               ONE LESS CHARACTER          ABL JUN85
         BCT   R0,ISPLNLB         CHECK ALL CHARACTERS?       ABL JUN85
         B     ISPMMLD4           YES, ALL BLANK              ABL JUN85
ISPLNLNB CLI   0(R1),C'+'         CONTINUATION DESIRED?       ABL JUN85
         BNE   ISPMMLD4           NO, RETURN                  ABL JUN85
         ST    R3,SPFCURSO        SAVE THE RETURN ADDRESS     ABL JUN85
         LA    R0,SPFVZCMD-1      OFFSET BY -1                ABL JUN85
         SR    R1,R0                                          ABL JUN85
         ST    R1,SPFCURSO        SAVE THE CURSOR POSITION    ABL JUN85
         L     R4,ISPSETVA        SET SERVICE ROUTINE         ABL JUN85
         BALR  R3,R4                                          ABL JUN85
         L     R0,SPFPANT                                     ABL JUN85
         ST    R0,SPFPANC                                     ABL JUN85
         MVC   SPFPSTK(8),ISP$PANC  CONTINUED PANEL           ABL JUN85
         L     R4,ISPPANDA          GET ADDR OF PAN DSP SUBR  ABL JUN85
         BALR  R3,R4                                          ABL JUN85
         CLC   SPFZSEL(4),ISPCEND                             ABL JUN85
         BNE   ISPMMLD4            PROCESS CMD                ABL JUN85
         B     ISPMMLDS            IGNORE COMMAND             ABL JUN85
         SPACE 2                                               SS SEP84
ISPLDELP DS    0H                                              SS SEP84
         TM    SPFLAG0,SPFMSGER    ANY ERRORS                  SS SEP84
         BO    ISPLERR                                         SS SEP84
         MVI   MEM2XATT+1,C'D'     MARK NO LONGER ACTIVE       SS NOV84
******   NOTE: TO LEAVE DELETED MEMBERS IN THE MEMLIST TABLE  ABL APR85
******         COMMENT THE NEXT TWO STATEMENTS:               ABL APR85
         BAL   R2,ISPDEL1          REMOVE FROM TABLE           SS NOV84
         B     ISPLNX              CONTINUE WITH NEXT ENTRY    SS NOV84
         B     ISPGENP             SAME POST PROCESSING        SS SEP84
ISPLRENP DS    0H                                              SS SEP84
         TM    SPFLAG0,SPFMSGER    ANY ERRORS                  SS SEP84
         BO    ISPLERR             SAME POST PROCESSING        SS SEP84
         LH    R15,$TLMG(R14)      MSG OFFSET                  SS NOV84
         AL    R15,ISP$TMGA        MSG ADDR                    SS MAR85
         MVC   MEMLDATA,0(R15)     PUT MSG IN MEMLIST TABLE    SS SEP84
         MVC   MEM2OPT,ISPBLK8     CLEAR OPTION                SS SEP84
         MVI   MEM2XATT+1,C'R'     NO LONGER ACTIVE            SS NOV84
         BAL   R2,ISPMEMOD         UPDATE TABLE                SS SEP84
         MVC   MEM1NAMA(MEMLVLEN),MEM2NAMA   SAVE STATS        SS SEP84
******   NOTE: TO LEAVE THE ORIGINAL MEMBER NAME IN THE       ABL APR85
******         MEMLIST TABLE, COMMENT THE NEXT STATEMENT:     ABL APR85
         BAL   R2,ISPDEL1          REMOVE FROM TABLE           SS NOV84
         L     R4,ISPLOCA            ADDRESS OF LOC SUBR       SS MAR85
         BALR  R3,R4                                           SS MAR85
         MVC   MEM2NAMA(MEMLVLEN),MEM1NAMA   SAME STATS        SS SEP84
         MVI   MEM2XATT+1,C' '     MAKE SURE IT IS ACTIVE      SS NOV84
         MVC   MEMLDATA,ISPNEWNM   PUT MSG IN MEMLIST TABLE    SS SEP84
         MVC   MEMLNAME,MEMLNMSV   ADD ENTRY FOR NEWNAME       SS SEP84
         LTR   R15,R15             OVERLAY ONE                 SS SEP84
         BZ    ISPLREN5                                        SS SEP84
         BAL   R2,ISPMEMAD         UPDATE TABLE                SS SEP84
         B     ISPLNV                                          SS SEP84
ISPLREN5 DS    0H                                              SS SEP84
         BAL   R2,ISPMEMOD         UPDATE TABLE                SS SEP84
         B     ISPLNV                                          SS SEP84
ISPLALIP DS    0H                                              SS SEP84
         TM    SPFLAG0,SPFMSGER    ANY ERRORS                  SS SEP84
         BO    ISPLERR             SAME POST PROCESSING        SS SEP84
         LH    R15,$TLMG(R14)      MSG OFFSET                  SS NOV84
         AL    R15,ISP$TMGA        MSG ADDR                    SS MAR85
         MVC   MEMLDATA,0(R15)     PUT MSG IN MEMLIST TABLE    SS SEP84
         MVC   MEM2OPT,ISPBLK8     CLEAR OPTION                SS SEP84
         BAL   R2,ISPMEMOD         UPDATE TABLE                SS SEP84
         MVC   MEM1NAMA(MEMLVLEN),MEM2NAMA   SAVE STATS        SS SEP84
         L     R4,ISPLOCA            ADDRESS OF LOC SUBR       SS MAR85
         BALR  R3,R4                                           SS MAR85
         MVC   MEM2NAMA(MEMLVLEN),MEM1NAMA   SAME STATS        SS SEP84
         MVI   MEM2XATT+1,C' '     MAKE SURE IT IS ACTIVE      SS NOV84
         MVC   MEMLDATA,ISPNEWNM   PUT MSG IN MEMLIST TABLE    SS SEP84
         MVC   MEMLNAME,MEMLNMSV   ADD ENTRY FOR NEWNAME       SS SEP84
         LTR   R15,R15             OVERLAY ONE                 SS SEP84
         BE    ISPLALI5                                        SS SEP84
         BAL   R2,ISPMEMAD         UPDATE TABLE                SS SEP84
         B     ISPLSTAT            RESET STATS                 SS SEP84
ISPLALI5 DS    0H                                              SS SEP84
         BAL   R2,ISPMEMOD         UPDATE TABLE                SS SEP84
         B     ISPLSTAT            RESET STATS                 SS SEP84
         SPACE 2                                               SS SEP84
ISPLDEL  DS    0H                                              SS SEP84
ISPLREN  DS    0H                                              SS SEP84
ISPLALI  DS    0H                                              SS SEP84
ISPGEN   DS    0H                                              SS SEP84
         CLI   MEM2XATT+1,C' '     IS THIS A GOOD MEMBER       SS NOV84
         BH    ISPLNBAD            CANNOT PROCESS              SS NOV84
         MVC   MEMFLAG1(1),4(R14)  SET POST PROCESSING INDEX   SS SEP84
         TM    $TLF2(R14),#P       DIFFERENT POST PROC         SS NOV84
         BZ    ISPGEN2              NO SKIP                    SS NOV84
         MVC   MEMFLAG1(1),$TLEX(R14) USE IT                   SS NOV84
ISPGEN2  DS    0H                                              SS SEP84
         OI    SPFLAG0,SPFCKER     ALSO CHECK FOR ERRORS       SS NOV84
         LH    R15,$TLCM(R14)   GET MAIN TABLE ENTRY OFFSET    SS NOV84
         TM    $TLF2(R14),#R       REAL CMD OFFSET*2           SS NOV84
         BZ    ISPGEN3                                         SS NOV84
         SR    R15,R15                                         SS NOV84
         IC    R15,$TLEX(R14)                                  SS NOV84
         LA    R15,ISPREAL(R15)                                SS NOV84
         LH    R15,0(R15)                                      SS NOV84
ISPGEN3  DS    0H                                              SS NOV84
         LA    R15,$TBL(R15)    SET ADDR                       SS SEP84
ISPGEN4  DS    0H                                             ABL OCT84
         MVC   PUTGETBF(4),ISPCMD30                           ABL OCT84
         MVC   SPFINPUT(8),0(R15) COPY CMD NAME                SS SEP84
         MVI   SPFINPUT+8,C' '                                 SS SEP84
         MVC   SPFINPUT+9(8),MEMLNAME                          SS SEP84
         MVI   SPFINPUT+17,C' '                               ABL OCT84
         CLI   MEMLDATA,X'00'      NULLS                       SS NOV84
         BE    ISPGEN5             YES, CONVERT TO BLANKS      SS NOV84
         CLI   MEMLDATA,C'*'       STATUS MESSAGE?            ABL OCT84
         BNE   *+10                NO, BRANCH                 ABL OCT84
ISPGEN5  DS    0H                                              SS NOV84
         MVC   MEMLDATA(8),ISPBLK8 YES, BLANK IT OUT          ABL OCT84
         MVC   SPFINPUT+18(8),MEMLDATA                        ABL OCT84
         MVC   MEMLNMSV,MEMLDATA                               SS NOV84
         TM    0(R14),#V           VIEW MODE OUTPUT?           SS DEC84
         BZ    ISPGEN6             NO, BRANCH                  SS DEC84
         OI    SPFLAG3,SPFLOGM     YES, MARK FOR LOGGING       SS DEC84
ISPGEN6  DS    0H                                              SS NOV84
         B     ISPCMDL                                        ABL OCT84
ISPGENP  DS    0H                                              SS SEP84
* #V: ATTRIB, COMPARE, DIR, FIND, HISTORY, LIST, MAP & VERIFY ABL DEC84
         TM    0(R14),#V           VIEW MODE EXPECTED?        ABL DEC84
         BO    ISPGENP2            YES, IGNORE ERROR MSG FLG  ABL DEC84
         TM    SPFLAG0,SPFMSGER    ANY ERRORS?                 SS SEP84
         BO    ISPLERR             YES, TERMINATE LIST CMDS.   SS SEP84
ISPGENP2 DS    0H                                             ABL SEP84
         LH    R15,$TLMG(R14)      MSG OFFSET                  SS NOV84
         AL    R15,ISP$TMGA        MSG ADDR                    SS SEP84
         MVC   MEMLDATA,0(R15)     PUT MSG IN MEMLIST TABLE    SS SEP84
         MVC   MEM2OPT,ISPBLK8     CLEAR OPTION                SS SEP84
         BAL   R2,ISPMEMOD         UPDATE TABLE                SS SEP84
         TM    ##ADRPA#,$F         SOFT ATTN SIGNALLED?       ABL APR85
         BNO   ISPLSTA0            NO, BRANCH                 ABL APR85
         NI    ##ADRPA#,255-$F     YES, TURN OFF FLAG         ABL APR85
         MVC   MEMLDATA,ISPATTN    SPECIAL *ATTN* FLAG        ABL APR85
         MVI   SPFTBL+2,C'M'       RESET TO MEMLIST           ABL APR85
         B     ISPLNB2             TERMINATE LINE COMMANDS    ABL APR85
ISPLSTA0 DS    0H                                             ABL APR85
         L     R14,MEMLTPT         RESTORE R14 WITH TABLE ENT  SS NOV84
         TM    $TLF2(R14),#M       UPDATE STATS                SS NOV84
         BZ    ISPLNV              NO CONTINUE                 SS NOV84
ISPLSTAT DS    0H                                              SS NOV84
         MVI   MEMFLAG1,4          CHANGE SECOND POST PROC     SS NOV84
         OI    SPFLAG2,SPFUPDA                                 SS NOV84
         MVC   PUTGETBF(4),ISPCMD21                            SS NOV84
         MVC   SPFINPUT(8),$MML   COPY CMD FOR MEMLIST         SS NOV84
         MVI   SPFINPUT+8,C' '                                 SS NOV84
         MVC   SPFINPUT+9(8),MEMLNAME                          SS NOV84
         B     ISPEXIT            FORCE RESET OF STATS         SS NOV84
ISPDELP  DS    0H                 DELETE THIS LINE             SS NOV84
         TM    SPFLAG0,SPFMSGER    ANY ERRORS                  SS NOV84
         BO    ISPLERR                                         SS NOV84
ISPDELL  DS    0H                 DELETE THIS LINE             SS NOV84
         BAL   R2,ISPDEL1                                      SS NOV84
         B     ISPLNX             CLEAN UP                     SS NOV84
*                                                              SS NOV84
*  LINE CMD SELECT PANEL DISPLAY SUPPORT (O LINE COMMAND)      SS NOV84
*                                                              SS NOV84
ISPLPND  DS    0H                                              SS NOV84
         CLI   MEM2XATT+1,C' '     IS THIS A GOOD MEMBER       SS NOV84
         BH    ISPLNBAD            CANNOT PROCESS              SS NOV84
         OI    SPFLAG0,SPFCKER     ALSO CHECK FOR ERRORS       SS NOV84
         LA    R15,$TBL(R15)    SET ADDR                       SS NOV84
         CLI   MEMLDATA,X'00'      NULLS                       SS NOV84
         BE    ISPLPND3            YES, CONVERT TO BLANKS      SS NOV84
         CLI   MEMLDATA,C'*'       STATUS MESSAGE?             SS NOV84
         BNE   *+10                NO, BRANCH                  SS NOV84
ISPLPND3 DS    0H                                              SS NOV84
         MVC   MEMLDATA(8),ISPBLK8 YES, BLANK IT OUT           SS NOV84
         MVC   MEMLNMSV,MEMLDATA   SAVE FOR PANEL              SS NOV84
         MVC   SPFMEMB,MEMLNAME    SAVE FOR PANEL              SS NOV84
         MVI   SPFVZCMD,C' '             BLANK FIRST           SS NOV84
         MVC   SPFVZCMD+1(249),SPFVZCMD                        SS NOV84
         L     R14,MEMLTPT         RESTORE R14                 SS NOV84
         ST    R14,MEMLTPT2        SAVE TABLE ENTRY            SS NOV84
         TM    $TLF2(R14),#Z       NONDISPL                    SS NOV84
         BO    ISPLPND2            YES                         SS NOV84
         MVC   SPFVZCMD(4),MEM2OPT ANY .MORE                   SS NOV84
         BAL   R2,ISPSHCMD         SET IT UP                   SS NOV84
         CLI   SPFVZCMD,C' '       ANY .MORE                   SS NOV84
         BE    ISPLPND4            NO                          SS NOV84
ISPLPND2 DS    0H                                              SS NOV84
         OI    SPFLAG3,SPFNOND     INVOKE PANEL NON-DISPLAY    SS NOV84
ISPLPND4 DS    0H                                              SS NOV84
         L     R4,ISPSETVA        SET SERVICE ROUTINE          SS MAR85
         BALR  R3,R4                                           SS MAR85
         L     R1,SPFPANT                                      SS NOV84
         ST    R1,SPFPANC          SET CURRENT TO NEW          SS NOV84
         L     R14,MEMLTPT         RESTORE R14                 SS NOV84
         SR    R15,R15                                         SS NOV84
         IC    R15,$TLEX(R14)      GET                         SS NOV84
         AL    R15,ISP$PNA             PANEL                   SS MAR85
         MVC   SPFPSTK(8),0(R15)            NAME               SS NOV84
ISPLPND5 DS    0H                                              SS NOV84
         L     R4,ISPPANDA          GET ADDR OF PAN DSP SUBR   SS MAR85
         BALR  R3,R4                                           SS MAR85
         CLC   SPFZSEL(4),ISPCEND     END KEY?                 SS NOV84
         BE    ISPLNX                 YES, DONE                SS NOV84
         MVC   SPFINPUT(250),SPFZSEL                           SS NOV84
         MVC   PUTGETBF(4),ISPLEN2                             SS NOV84
         L     R14,MEMLTPT          RESTORE R14                SS NOV84
         MVI   MEMFLAG1,16          USE GENERAL PURPOSE POST   SS NOV84
         OI    SPFLAG2,SPFPOST                                 SS NOV84
         TM    $TLF2(R14),#Z        NONDISPLAY?                SS NOV84
         BO    ISPSETP5             YES, THEN NO POST PROC     SS NOV84
         TM    $TLF2(R14),#A        RESCAN.. MULTY FUNC PANEL? SS NOV84
         BZ    ISPCMDL              NO, NO CHANGE              SS NOV84
*  RESCAN LINE CMD FROM PANEL                                  SS NOV84
         BAL   R2,ISPVER            CHECK CMD VERB             SS NOV84
         C     R15,ISPL8            VALID VERB?                SS NOV84
         BH    ISPLNB3              NO, ERROR                  SS NOV84
         TM    0(R14),#V            VIEW MODE OUTPUT?         ABL DEC84
         BZ    *+8                  NO, BRANCH                ABL DEC84
         OI    SPFLAG3,SPFLOGM      YES, MARK FOR LOGGING     ABL DEC84
         TM    $TLF2(R14),#H        ALLOWED FROM O LINE CMD?  ABL DEC84
         BO    ISPLPN2              YES, BRANCH               ABL DEC84
         TM    0(R14),#L            VALID LINE COMMAND?        SS NOV84
         BZ    ISPLNB3              NO, ERROR                  SS NOV84
ISPLPN2  DS    0H                                              SS NOV84
         TM    0(R14),#S            COMMAND FOR SOURCE ONLY?   SS NOV84
         BZ    ISPLPN3              NO, BRANCH                 SS NOV84
         TM    FLAGSCC,RECFMU       LOAD LIBRARY?              SS NOV84
         BO    ISPLNB3              YES, ERROR                 SS NOV84
         B     ISPLPN4                                         SS NOV84
ISPLPN3  DS    0H                                              SS NOV84
         TM    0(R14),#U            COMMAND FOR LOAD ONLY?     SS NOV84
         BZ    ISPLPN4              NO, BRANCH                 SS NOV84
         TM    FLAGSCC,RECFMU       LOAD LIBRARY?              SS NOV84
         BZ    ISPLNB3              NO, ERROR                  SS NOV84
ISPLPN4  DS    0H                                              SS NOV84
         TM    0(R14),#V            REVIEW MODE REQUIRED?      SS NOV84
         BO    ISPLPN5              YES, USE GENERAL PURPOSE   SS NOV84
         MVI   MEMFLAG1,32          COME BACK TO PANEL POST PR SS NOV84
         TM    $TLF2(R14),#P        DIFFERENT POST PROCESSOR?  SS NOV84
         BZ    ISPCMDC              NO, BRANCH                 SS NOV84
ISPLPN5  DS    0H                                              SS NOV84
         TM    $TLF2(R14),#P        DIFFERENT POST PROCESSOR?  SS NOV84
         BZ    ISPCMDL              NO, BRANCH                 SS NOV84
         MVC   MEMFLAG1(1),$TLEX(R14) USE IT                   SS NOV84
         B     ISPCMDL                                         SS NOV84
ISPLPNDP DS    0H                                              SS NOV84
         TM    SPFLAG0,SPFMSGER    ANY ERRORS                  SS NOV84
         BO    ISPLERR                                         SS NOV84
         LH    R15,$TLMG(R14)      MSG OFFSET                  SS NOV84
         AL    R15,ISP$TMGA        MSG ADDR                    SS NOV84
         MVC   MEMLDATA,0(R15)     PUT MSG IN MEMLIST TABLE    SS NOV84
         MVC   MEM2OPT,ISPBLK8     CLEAR OPTION                SS NOV84
         BAL   R2,ISPMEMOD         UPDATE TABLE                SS NOV84
         L     R14,MEMLTPT         RESTORE R14 WITH TABLE ENT  SS NOV84
         TM    $TLF2(R14),#M       UPDATE STATS                SS NOV84
         BO    ISPLSTAT            YES, BRANCH                 SS NOV84
         L     R14,MEMLTPT2        GET SAVED TABLE ENTRY       SS NOV84
         ST    R14,MEMLTPT         RESTORE IT                  SS NOV84
         B     ISPLNV              REENTER MEMLIST DISPLAY    ABL DEC84
*****    B     ISPLPND5            REDISPLAY PANEL             SS NOV84
         SPACE 3                                               SS NOV84
*                                                              SS MAR85
*   STATUS LINE COMMAND                                        SS MAR85
*                                                              SS MAR85
ISPSTAT1 DS    0H                                              SS MAR85
         CLI   MEM2XATT+1,C' '     IS THIS A GOOD MEMBER       SS MAR85
         BH    ISPLNBAD            CANNOT PROCESS              SS MAR85
         MVI   MEMFLAG1,36         SET POST PROCESSING INDEX   SS MAR85
         OI    SPFLAG0,SPFCKER     ALSO CHECK FOR ERRORS       SS MAR85
         MVC   PUTGETBF(4),ISPCMD30                            SS MAR85
         MVC   SPFINPUT(8),$ATT   COPY CMD NAME                SS MAR85
ISPSTAT2 DS    0H                                              SS MAR85
         MVI   SPFINPUT+8,C' '                                 SS MAR85
         MVC   SPFINPUT+9(8),MEMLNAME                          SS MAR85
         MVI   SPFINPUT+17,C' '                                SS MAR85
         CLI   MEMLDATA,C'*'       MSG                         SS MAR85
         BNE   *+10                                           ABL JUN85
         MVC   MEMLDATA(8),ISPBLK8      BLANK IT OUT           SS MAR85
         MVC   SPFINPUT+18(8),MEMLDATA                         SS MAR85
         MVC   MEMLNMSV,MEMLDATA                               SS MAR85
         OI    SPFLAG3,SPFLOGM                                 SS MAR85
         B     ISPCMDL                                         SS MAR85
ISPSTAP2 DS    0H                                              SS MAR85
         TM    SPFLAG0,SPFMSGER    ANY ERRORS                  SS MAR85
         BO    ISPLERR                                         SS MAR85
         MVI   MEMFLAG1,40         SET POST PROCESSING INDEX   SS MAR85
         OI    SPFLAG0,SPFCKER     ALSO CHECK FOR ERRORS       SS MAR85
         MVC   PUTGETBF(4),ISPCMD30                            SS MAR85
         MVC   SPFINPUT(8),$HIS   COPY CMD NAME                SS MAR85
         B     ISPSTAT2                                        SS MAR85
ISPSTAP3 DS    0H                                              SS MAR85
         TM    SPFLAG0,SPFMSGER    ANY ERRORS                  SS MAR85
         BO    ISPLERR                                         SS MAR85
         MVI   MEMFLAG1,16         SET POST PROCESSING INDEX   SS MAR85
         OI    SPFLAG0,SPFCKER     ALSO CHECK FOR ERRORS       SS MAR85
         MVC   PUTGETBF(4),ISPCMD30                            SS MAR85
         MVC   SPFINPUT(8),$MAP   COPY CMD NAME                SS MAR85
         B     ISPSTAT2                                        SS MAR85
         SPACE 3                                               SS NOV84
*                                                              SS MAR85
*   FORMAT UT2 LINE COMMAND                                    SS MAR85
*                                                              SS MAR85
ISPUTL1  DS    0H                                              SS MAR85
         CLI   MEM2XATT+1,C' '     IS THIS A GOOD MEMBER       SS MAR85
         BH    ISPLNBAD            CANNOT PROCESS              SS MAR85
         MVI   MEMFLAG1,16         SET POST PROCESSING INDEX   SS MAR85
         MVC   PUTGETBF(4),ISPCMD30                            SS MAR85
         MVC   SPFINPUT(8),$UT2   COPY CMD NAME                SS MAR85
         MVI   SPFINPUT+8,C' '                                 SS MAR85
         MVC   SPFINPUT+9(8),MEMLNAME  GET MEMBER NAME         SS MAR85
         MVC   SPFINPUT+17(5),ISPUTDOT INSERT LITERAL UT.     ABL JUN85
         TM    $TLF2(R14),#R       IS REAL COMMAND HERE        SS MAR85
         BO    ISPUTL4             YES, USE AFTER UT.          SS MAR85
         TM    $TLF2(R14),#C       IS IT A 1,2 CHAR NAME       SS MAR85
         BO    ISPUTL6             YES, USE AFTER UT.          SS MAR85
         TM    0(R14),#X           IS AN EXTENDED NAME         SS MAR85
         BZ    ISPLNBAD            NO, THEN CANT USE           SS MAR85
         LH    R15,$TLCM(R14)      COMMAND OFFSET              SS MAR85
         AL    R15,ISP$TXA         COMMAND ADDRES              SS MAR85
         B     ISPUTL5             USE IT                      SS MAR85
ISPUTL4  DS    0H                                              SS MAR85
         SR    R15,R15             CLEAR FOR INSERT            SS MAR85
         IC    R15,$TLEX(R14)      GET OFFSET OF REAL CMD      SS MAR85
         LA    R15,ISPREAL(R15)    GET ADDRESS                 SS MAR85
ISPUTL5  DS    0H                                              SS MAR85
         MVC   SPFINPUT+22(4),0(R15) INSERT 4 CHAR OF CMD      SS MAR85
         B     ISPUTL7             DO REST                     SS MAR85
ISPUTL6  DS    0H                                              SS MAR85
         MVC   SPFINPUT+22(2),$TLCM(R14)  USE THESE 2 CHAR     SS MAR85
         MVC   SPFINPUT+24(2),ISPBLK8     BLANK REST           SS MAR85
ISPUTL7  DS    0H                                              SS MAR85
         CLI   MEMLDATA,C'*'       MSG                         SS MAR85
         BE    *+10                                            SS MAR85
         MVC   MEMLDATA(8),ISPBLK8      BLANK IT OUT           SS MAR85
         MVC   MEMLNMSV,MEMLDATA   SAVE FOR PANEL USE          SS MAR85
         B     ISPCMDL                                         SS MAR85
         SPACE 3                                               SS NOV84
*                                                              SS MAR85
*   FORMAT UT1 COMMAND                                         SS MAR85
*                                                              SS MAR85
ISPUTL11 DS    0H                                              SS MAR85
         MVC   PUTGETBF(4),ISPCMD21                            SS MAR85
         MVC   SPFINPUT(8),$UT1   COPY CMD NAME                SS MAR85
         MVC   SPFINPUT+08(5),ISPUTDOT INSERT LITERAL UT.     ABL JUN85
         TM    $TLF2(R14),#R       IS REAL COMMAND HERE        SS MAR85
         BO    ISPUTL41            YES, USE AFTER UT.          SS MAR85
         TM    $TLF2(R14),#C       IS IT A 1,2 CHAR NAME       SS MAR85
         BO    ISPUTL61            YES, USE AFTER UT.          SS MAR85
         TM    0(R14),#X           IS AN EXTENDED NAME         SS MAR85
         BZ    ISPOPTIV            NO, THEN CANT USE           SS MAR85
         LH    R15,$TLCM(R14)      COMMAND OFFSET              SS MAR85
         AL    R15,ISP$TXA         COMMAND ADDRES              SS MAR85
         B     ISPUTL51            USE IT                      SS MAR85
ISPUTL41 DS    0H                                              SS MAR85
         SR    R15,R15             CLEAR FOR INSERT            SS MAR85
         IC    R15,$TLEX(R14)      GET OFFSET OF REAL CMD      SS MAR85
         LA    R15,ISPREAL(R15)    GET ADDRESS                 SS MAR85
ISPUTL51 DS    0H                                              SS MAR85
         MVC   SPFINPUT+13(4),0(R15) INSERT 4 CHAR OF CMD      SS MAR85
         B     ISPUTL71            DO REST                     SS MAR85
ISPUTL61 DS    0H                                              SS MAR85
         MVC   SPFINPUT+13(2),$TLCM(R14)  USE THESE 2 CHAR     SS MAR85
         MVC   SPFINPUT+15(2),ISPBLK8     BLANK REST           SS MAR85
ISPUTL71 DS    0H                                              SS MAR85
         B     ISPCMDCK                                        SS MAR85
         SPACE 3                                               SS NOV84
*                                                              SS NOV84
*  MEMLIST ADD LINE FUNCTION                                   SS JUL84
*                                                              SS JUL84
ISPMEML  DS    0H                                              SS SEP84
         TM    SPFLAG0,SPFMEMV    VDEFINES FOR MEMLIST OK      SS SEP84
         BO    ISPMEMOK                                        SS SEP84
         LA    R14,VDEFINE         START VDEFINES              SS JUL84
         ST    R14,PARMLIST                                    SS JUL84
         LA    R14,MEMLTKEY        MEMBER NAME IS KEY          SS JUL84
         LA    R15,MEMLNAME                                    SS JUL84
         LA    R0,ISPCHAR                                      SS JUL84
         LA    R1,ISPL8                                        SS JUL84
         STM   R14,R1,PARMLIST+4                               SS JUL84
         OI    PARMLIST+16,X'80'                               SS JUL84
         LA    R1,PARMLIST                                     SS JUL84
         L     R15,ISPLINK                                     SS JUL84
         BALR  R14,R15                                         SS JUL84
         LTR   R15,R15                                         SS JUL84
         BNZ   ISPERR                                          SS JUL84
         LA    R14,MEMTNAML       VAR NAME LIST                SS JUL84
         LA    R15,MEMTNAMA       TABLE ARRAY                  SS JUL84
         LA    R0,ISPCHAR                                      SS JUL84
         LA    R1,ISPL8                                        SS JUL84
         STM   R14,R1,PARMLIST+4                               SS JUL84
         OI    PARMLIST+16,X'80'                               SS JUL84
         LA    R1,PARMLIST                                     SS JUL84
         L     R15,ISPLINK                                     SS JUL84
         BALR  R14,R15                                         SS JUL84
         LTR   R15,R15                                         SS JUL84
         BNZ   ISPERR                                          SS JUL84
         OI    SPFLAG0,SPFMEMV    VDEFINES IS DONE             SS SEP84
ISPMEMOK DS    0H                                              SS SEP84
         TM    SPFLAG3,SPFCHN     HAS CHANGE DSN BEEN DONE    ABL OCT84
         BZ    ISPMEMK1           NO, SKIP                    ABL OCT84
         NI    SPFLAG3,255-SPFCHN-SPF300A CLEAR               ABL OCT84
         BAL   R2,ISPTBT#M        TERMINATE MEMLIST TABLE     ABL OCT84
ISPMEMK1 DS    0H                                             ABL OCT84
         TM    SPFLAG0,SPFMEMT    IS MEMLIST TABLE CREATED     SS SEP84
         BO    ISPMEMK2                                        SS SEP84
         BAL   R2,ISPCRMEM        CREATE MEMLIST TABLE         SS SEP84
ISPMEMK2 DS    0H                                              SS SEP84
         TM    SPFLAG2,SPFMEMA    FIRST TIME                   SS SEP84
         BO    ISPMEMK3           NO                           SS SEP84
         OI    SPFLAG2,SPFSEQ                                  SS SEP84
         B     ISPMEML4                                        SS SEP84
ISPMEMK3 TM    SPFLAG2,SPFSEQ     FIRST TIME SEQ ADD           SS SEP84
         BO    ISPMEML4           YES                          SS SEP84
         MVI   SPFTBL+2,C'M'      MAKE SURE MEMLIST            SS SEP84
         BAL   R2,ISPGET          FIND ENTRY TO REPLACE        SS SEP84
         LTR   R15,R15            WE FIND IT                   SS SEP84
         BZ    ISPMEML2           YES                          SS SEP84
         MVC   MEMLNMSV,MEMLNAME  NO, MUST INSERT              SS SEP84
         L     R4,ISPLOCA            ADDRESS OF LOC SUBR       SS MAR85
         BALR  R3,R4                                           SS MAR85
         LTR   R15,R15            FIND EXACT MATCH             SS SEP84
         BZ    ISPMEML2           YES ????                     SS SEP84
         MVC   MEMLNAME,MEMLNMSV  GET ORIGINAL NAME            SS SEP84
ISPMEML4 DS    0H                 ADD NEW ENTRY HERE           SS SEP84
         MVC   MEMLDATA,ISPBLK8                                SS SEP84
         MVC   MEM2NAMA(MEMLVLEN),MEM1NAMA                     SS SEP84
         BAL   R2,ISPMEMAD                                     SS SEP84
         B     ISPEXIT                                         SS SEP84
ISPMEML2 DS    0H                                              SS SEP84
         TM    SPFLAG2,SPFUPDA    REFRESH ENTRIES              SS SEP84
         BO    ISPMEML3           YES                          SS SEP84
         MVC   MEMLDATA,ISPBLK8   NO, CLEAR MSGS               SS SEP84
ISPMEML3 DS    0H                                              SS SEP84
         MVC   MEM2NAMA(MEMLVLEN),MEM1NAMA                     SS SEP84
         BAL   R2,ISPMEMOD                                     SS SEP84
         B     ISPEXIT                                         SS SEP84
         SPACE 2                                               SS SEP84
*                                                              SS NOV84
*  SUPPORT REQUEST  SELECT PANEL DISPLAY (SUBCOMMANDS UT1,UT2) SS NOV84
*                                                              SS NOV84
ISPPNSUP DS    0H                                              SS NOV84
         MVI   SPFVZCMD,C' '                                   SS NOV84
         MVC   SPFVZCMD+1(249),SPFVZCMD                        SS NOV84
         LH    R15,SPFZLEN        GET LENG                     SS NOV84
         LTR   R15,R15            ZERO                         SS NOV84
         BZ    ISPPNSU3                                        SS NOV84
         BCTR  R15,0              LESS 1 MVC                   SS NOV84
         L     R14,SPFZDATA       PASSED ZCMD DATA             SS NOV84
ISPPNSU4 MVC   SPFVZCMD(0),0(R14)                              SS NOV84
         EX    R15,ISPPNSU4       COPY TO CMD FROM INPUT       SS NOV84
         BAL   R2,ISPFIRST        CHECK FOR ANY REAL DATA      SS NOV84
         LTR   R15,R15            CHECK RETURN ADDRESS/RC      SS MAR85
         BZ    ISPPNSU3           ALL BLANK                    SS MAR85
ISPPNSU2 DS    0H                                              SS NOV84
         OI    SPFLAG3,SPFNOND       INVOKE PANEL NON-DISPLAY  SS NOV84
ISPPNSU3 DS    0H                                              SS NOV84
         L     R4,ISPSETVA        SET SERVICE ROUTINE          SS MAR85
         BALR  R3,R4                                           SS MAR85
         MVC   SPFPANT2(12),SPFPANT  SAVE ISPMODE PAN SUPPORT  SS NOV84
         LA    R1,SPFPSTK2                                     SS NOV84
         ST    R1,SPFPANT                                      SS NOV84
         ST    R1,SPFPANC                                      SS NOV84
         LA    R1,SPFPSTKE                                     SS NOV84
         ST    R1,SPFPANB2                                     SS NOV84
         L     R4,ISPPANDA          GET ADDR OF PAN DSP SUBR   SS MAR85
         BALR  R3,R4                                           SS MAR85
         MVC   SPFPANT(12),SPFPANT2  RESTORE ISPNODE PAN SUPPO SS NOV84
         LA    R1,SPFZSEL                                      SS NOV84
         ST    R1,SPFSAV1         RETURN DATA                  SS SEP84
         B     ISPEXIT                                         SS SEP84
         SPACE 2                                               SS SEP84
*                                                              SS JUL84
*  SUBROUTINES                                                 SS JUL84
*                                                              SS JUL84
ISPSXEQ0 DS    0H                                              SS MAR85
         LA    R1,PARMLIST                                     SS JUL84
         L     R15,ISPLINK                                     SS JUL84
         BALR  R14,R15                                         SS JUL84
         LTR   R15,R15                                         SS JUL84
         BNZ   ISPERR                                          SS JUL84
         BR    R2                                              SS SEP84
ISPSXEQ8 DS    0H                                              SS MAR85
         LA    R1,PARMLIST                                     SS JUL84
         L     R15,ISPLINK                                     SS JUL84
         BALR  R14,R15                                         SS JUL84
         C     R15,ISPL8                                       SS JUL84
         BH    ISPERR                                          SS JUL84
         BR    R2                 RETURN                       SS JUL84
         SPACE 1                                              ABL SEP84
* CONTROL DISPLAY SESSION MGR  (REFRESH)                       SS MAR85
ISPCTLSM DS    0H                                              SS MAR85
         LA    R14,ISPCNTL                FIRST PARAMETER     ABL APR85
         LA    R15,ISPDSP                 SECOND PARAMETER    ABL APR85
         LA    R0,ISPSM                   THIRD PARAMETER     ABL APR85
         LA    R1,=F'1'                   FOURTH PARAMETER    ABL APR85
         STM   R14,R1,PARMLIST            SAVE ADDRESSES      ABL APR85
         OI    PARMLIST+12,X'80'          LAST                ABL APR85
         B     ISPSXEQ0                                        SS MAR85
         SPACE 3                                               SS JUL84
*                                                              SS JUL84
*  VDEFINE SUPPORT SUBROUTINE: BEFORE ENTRY SET:               SS JUL84
*  R14=ADDR OF VARIABLE NAME                                   SS JUL84
*  R15=ADDR OF VARIABLE                                        SS JUL84
*  R1 =ADDR OF VARIABLE LENGTH                                 SS JUL84
*                                                              SS JUL84
ISPVDEF  DS    0H                                              SS SEP84
         LA    R0,ISPCHAR                                      SS SEP84
         STM   R14,R1,PARMLIST+4                               SS JUL84
         OI    PARMLIST+16,X'80'                               SS JUL84
         LA    R14,VDEFINE         START VDEFINES              SS JUL84
         ST    R14,PARMLIST                                    SS JUL84
         B     ISPSXEQ0                                        SS MAR85
         SPACE 2                                               SS SEP84
*            CODE TO POSITION TO FIRST NON BLANK IN INPUT      SS JUL84
ISPFIRST DS    0H                                              SS SEP84
         LA    R15,SPFVZCMD           START OF ZCMD            SS NOV84
         LA    R14,48                 INPUT SIZE               SS JUL84
ISPCKBLK CLI   0(R15),C' '            BLANK                    SS JUL84
         BNE   ISPNONBL                                        SS JUL84
         LA    R15,1(,R15)            NEXT CHAR                SS JUL84
         BCT   R14,ISPCKBLK                                    SS JUL84
         SR    R15,R15                ERROR                    SS JUL84
ISPNONBL DS    0H                                              SS JUL84
         BR    R2                                              SS SEP84
         SPACE 2                                               SS SEP84
*            CODE TO POSITION DATA AFTER PERIOD                SS NOV84
ISPSHCMD DS    0H                                              SS NOV84
         LA    R15,SPFVZCMD           START OF ZCMD            SS NOV84
         LA    R14,48                 INPUT SIZE               SS NOV84
ISPSHBLK CLI   0(R15),C' '            BLANK                    SS NOV84
         BNE   ISPSHBL2                                        SS NOV84
         LA    R15,1(,R15)            NEXT CHAR                SS NOV84
         BCT   R14,ISPSHBLK                                    SS NOV84
         SR    R15,R15                ERROR                    SS NOV84
ISPSHBL2 CLI   0(R15),C' '            BLANK                    SS NOV84
         BE    ISPSHBL3                                        SS NOV84
         CLI   0(R15),C'.'            PERIOD                   SS NOV84
         BE    ISPSHPRD                                        SS NOV84
         LA    R15,1(,R15)            NEXT CHAR                SS NOV84
         BCT   R14,ISPSHBL2                                    SS NOV84
ISPSHBL3 DS    0H                                              SS NOV84
         MVI   SPFVZCMD,C' '          BLANK                    SS NOV84
         MVC   SPFVZCMD+1(249),SPFVZCMD  RIPPLE                SS NOV84
         BR    R2                                              SS NOV84
ISPSHPRD DS    0H                                              SS NOV84
         LA    R15,1(,R15)                                     SS NOV84
         LA    R1,SPFVZCMD+250                                 SS NOV84
         SR    R1,R15                                          SS NOV84
ISPSHR2  MVC   SPFVZCMD(0),0(R15)     SHIFT BACK               SS NOV84
         EX    R1,ISPSHR2                                      SS NOV84
         LA    R15,SPFVZCMD(R1)                                SS NOV84
         LA    R1,SPFVZCMD+250                                 SS NOV84
         SR    R1,R15                                          SS NOV84
         MVI   0(R15),C' '                                     SS NOV84
         BCTR  R1,0                                            SS NOV84
         BCTR  R1,0                                            SS NOV84
ISPSHR3  MVC   1(0,R15),0(R15)                                 SS NOV84
         EX    R1,ISPSHR3                                      SS NOV84
         BR    R2                                              SS SEP84
         SPACE 2                                               SS SEP84
*  CODE TO FIND CHAR MATCH                                     SS MAR85
ISPCLI   DS    0H                                              SS MAR85
ISPCLILP EX    R1,ISPCLI0         USE CHAR IN R1 FOR COMPARE   SS MAR85
         BER   R2                 DONE IF EQU .. RETURN        SS MAR85
         LA    R15,1(,R15)        NEXT CHAR                    SS MAR85
         BCT   R14,ISPCLILP       CHARS LEFT COUNT DOWN        SS MAR85
         SR    R15,R15            RETURN 0 IF NONE FOUND       SS MAR85
         BR    R2                                              SS MAR85
ISPCLI0  CLI   0(R15),0           EXECUTED COMPARE             SS MAR85
         SPACE 2                                               SS MAR85
*  CODE TO FIND CHAR MATCH WORKING BACKWARD                    SS MAR85
ISPCLIB  DS    0H                                              SS MAR85
ISPCLIL2 EX    R1,ISPCLI0         USE CHAR IN R1 FOR COMPARE   SS MAR85
         BER   R2                 DONE IF EQU .. RETURN        SS MAR85
         BCTR  R15,0              NEXT CHAR BACK               SS MAR85
         BCT   R14,ISPCLIL2       CHARS LEFT COUNT DOWN        SS MAR85
         SR    R15,R15            RETURN 0 IF NONE FOUND       SS MAR85
         BR    R2                                              SS MAR85
         SPACE 2                                               SS MAR85
ISPCREF  DS    0H                                              SS NOV84
         LA    R14,ISPCNTL        CONTROLTABLE                 SS JUL84
         LA    R15,ISPDSP                                      SS JUL84
         LA    R0,ISPREF                                       SS JUL84
         STM   R14,R0,PARMLIST                                 SS JUL84
         OI    PARMLIST+08,X'80'                              ABL JUN85
         LA    R1,PARMLIST                                     SS JUL84
         L     R15,ISPLINK                                     SS JUL84
         BALR  R14,R15                                         SS JUL84
         LTR   R15,R15                                         SS JUL84
         BNZ   ISPERR                                          SS JUL84
         NI    SPFLAG3,255-SPFREFR                             SS NOV84
         BR    R2                                              SS NOV84
         SPACE 2                                               SS SEP84
ISPDVGET DS    0H                                              SS NOV84
         LA    R14,VGET               VGET                    ABL OCT84
         LA    R15,VZVERB             ZVERB                   ABL OCT84
         LA    R0,ISPSHARE            SHARED                  ABL OCT84
         STM   R14,R0,PARMLIST                                ABL OCT84
         OI    PARMLIST+8,X'80'                               ABL OCT84
         B     ISPSXEQ0                                        SS MAR85
         SPACE 2                                               SS SEP84
ISPCREAT DS    0H                                              SS JUL84
         MVI   SPFTBL+2,C'S'      MAKE NAME "PDS"              SS SEP84
         LA    R14,TBCREATE       CREATE TABLE                 SS JUL84
         ST    R14,PARMLIST                                    SS JUL84
         LA    R14,SPFTBL                                      SS JUL84
         LA    R15,0                                           SS JUL84
         LA    R0,VSPFLIN                                      SS JUL84
         LA    R1,ISPNOWRT                                     SS JUL84
         STM   R14,R1,PARMLIST+4                               SS JUL84
         OI    PARMLIST+16,X'80'                               SS JUL84
ISPCREA2 LA    R1,PARMLIST                                     SS JUL84
         L     R15,ISPLINK                                     SS JUL84
         BALR  R14,R15                                         SS JUL84
         LTR   R15,R15                                         SS JUL84
         BZ    ISPIDONE                                        SS JUL84
         C     R15,ISPL8          DUPLICATE NAME               SS JUL84
         BNE   ISPERR             NO, MUST BE SEVERE ERROR     SS JUL84
         CLI   SPFTBL+7,C'9'      TRIED 9 TIMES                SS JUL84
         BE    ISPERR             YES, GIVE UP                 SS JUL84
         SR    R15,R15                                         SS JUL84
         LA    R15,1(R15)         ADD ONE TO MAKE DIFFERENT    SS JUL84
         STC   R15,SPFTBL+7                                    SS JUL84
         B     ISPCREA2           TRY AGAIN                    SS JUL84
ISPIDONE OI    SPFLAG0,SPFTABLE  GOOD TABLE CREATED            SS JUL84
         CLI   SPFLAG1,SPFPTGET   HAVE LINE TO ADD             SS SEP84
         BE    ISPADDLN                                        SS SEP84
         CLI   SPFLAG1,SPFPUTL    LINE WILL BE ADDED SOON      SS SEP84
         BER   R2                                              SS SEP84
         B     ISPADD1           MAKE TABLE NON EMPTY          SS JUL84
ISPCRMEM DS    0H                                              SS JUL84
         MVI   SPFTBL+2,C'M'      MAKE NAME "PDM"              SS SEP84
         LA    R14,TBCREATE       CREATE TABLE                 SS JUL84
         ST    R14,PARMLIST                                    SS JUL84
         LA    R14,SPFTBL                                      SS JUL84
         LA    R15,MEMLTKEY                                    SS JUL84
         LA    R0,MEMTNAML                                     SS JUL84
         LA    R1,ISPNOWRT                                     SS JUL84
         STM   R14,R1,PARMLIST+4                               SS JUL84
         OI    PARMLIST+16,X'80'                               SS JUL84
         LA    R1,PARMLIST                                     SS JUL84
         L     R15,ISPLINK                                     SS JUL84
         BALR  R14,R15                                         SS JUL84
         LTR   R15,R15            ERROR                        SS JUL84
         BNZ   ISPERR             NO, MUST BE SEVERE ERROR     SS JUL84
         OI    SPFLAG0,SPFMEMT   GOOD TABLE CREATED            SS JUL84
         NI    SPFLAG2,255-SPFMEMA NO ACTIVE YET               SS JUL84
         BR    R2                                              SS SEP84
         SPACE 2                                               SS JUL84
ISPTBT#S MVI   SPFTBL+2,C'S'         TERMINATE ISPMODE TABLE  ABL OCT84
         B     ISPTBEND                                       ABL OCT84
         SPACE 1
ISPTBT#M TM    SPFLAG2,SPFMEMA       TERMINATE MEMLIST TABLE  ABL OCT84
         BZR   R2                    DOES NOT EXIST, RETURN   ABL OCT84
         MVI   SPFTBL+2,C'M'         MEMLIST TABLE            ABL OCT84
         NI    SPFLAG0,255-SPFCLNM   CLEAR MEMLIST MODE       ABL OCT84
         NI    SPFLAG2,0             CLEAR MEMLIST MODE       ABL OCT84
         NI    SPFLAG3,255-SPFCONV   CLEAR MEMLIST MODE       ABL OCT84
         NI    SPFLAG3,SPFSELV+SPF300A                        ABL NOV84
         NI    MEMFLAG0,0            CLEAR MEMLIST MODE       ABL OCT84
         SPACE 1
ISPTBEND DS    0H                                              SS SEP84
         LA    R14,TBEND          END TABLE                    SS JUL84
         LA    R15,SPFTBL         TABLE NAME                   SS JUL84
         STM   R14,R15,PARMLIST                                SS JUL84
         OI    PARMLIST+04,X'80'                               SS JUL84
         B     ISPSXEQ0                                        SS MAR85
         SPACE 2                                               SS JUL84
ISPADD1  DS    0H                                              SS JUL84
         LA    R14,1              SET COUNTS TO ONE            SS JUL84
         ST    R14,SPFSTART           START OF LAST CMD        SS JUL84
         ST    R14,SPFCRP             CPR                      SS JUL84
         ST    R14,SPFTDTOP           DISPLAY TOP              SS JUL84
         LA    R14,0              SET COUNTS TO ZERO           SS JUL84
         STH   R14,SPFCKPT            COUNT FROM LAST CKPT     SS JUL84
         ST    R14,SPFLAST            ZERO SIZE TABLE          SS JUL84
         LA    R1,MSGENTDS            ADD LINE AND RETURN      SS JUL84
         ST    R1,SPFSAV1                                      SS SEP84
         B     ISPADDLN                                        SS SEP84
         SPACE 2                                               SS SEP84
ISPADDLN DS    0H                                              SS JUL84
         MVI   SPFLINE,C' '      PRE CLEAR OUTPUT LINE         SS JUL84
         MVC   SPFLINE+1(78),SPFLINE                           SS JUL84
         L     R1,SPFSAV1        OUTPUT BUFFER                 SS JUL84
         LH    R14,0(R1)         LENGTH                        SS JUL84
         SH    R14,ISPH5         -4 FOR HEADER -1 FOR MVC      SS JUL84
         L     R15,ADDRUPT              ADDRESS OF THE UPT    ABL APR85
         TM    UPTSWS-UPT(R15),UPTMID   MESSAGE ID DESIRED?   ABL APR85
         BO    ISPADD79                 YES, BRANCH           ABL APR85
         CLC   4(3,R1),ISPPDS    PDS PREFIX?                  ABL APR85
         BNE   ISPADD79          NO, BRANCH                   ABL APR85
         TM    9(R1),X'F0'       NUMERIC?                     ABL APR85
         BNO   ISPADD79          NO, BRANCH                   ABL APR85
         TM    8(R1),X'F0'       NUMERIC?                     ABL APR85
         BNO   ISPADD79          NO, BRANCH                   ABL APR85
         TM    7(R1),X'F0'       NUMERIC?                     ABL APR85
         BNO   ISPADD79          NO, BRANCH                   ABL APR85
         CLI   11(R1),X'40'      A FOLLOWING BLANK?           ABL APR85
         BNE   ISPADD79          NO, BRANCH                   ABL APR85
         CLI   10(R1),C'I'       INFORMATIONAL MESSAGE?       ABL APR85
         BE    ISPADDLS          YES, BRANCH                  ABL APR85
         CLI   10(R1),C'A'       ACTION MESSAGE?              ABL APR85
         BE    ISPADDLS          YES, BRANCH                  ABL APR85
         CLI   10(R1),C'W'       WARNING MESSAGE?             ABL APR85
         BE    ISPADDLS          YES, BRANCH                  ABL APR85
         CLI   10(R1),C'E'       ERROR MESSAGE?               ABL APR85
         BNE   ISPADD79          NO, BRANCH                   ABL APR85
ISPADDLS DS    0H                                             ABL APR85
         LA    R0,8              LITERAL 8                    ABL APR85
         SR    R14,R0            -8 FOR THE MESSAGE ID        ABL APR85
         AR    R1,R0                                          ABL APR85
ISPADD79 DS    0H                                             ABL APR85
         CH    R14,ISPH78        MAX LENGTH                    SS JUL84
         BNH   ISPMVLIN          OK                            SS JUL84
         LH    R14,ISPH78        TRUNCATE                      SS JUL84
ISPMVLIN MVC   SPFLINE(0),4(R1)  MOVE TO DIALOG VARIABLE       SS JUL84
         EX    R14,*-6                                         SS JUL84
ISPADDCO DS    0H                                              SS MAY85
         CLI   SPFLINE,X'40'     BLANK IN CHARACTER 1         ABL SEP84
         BNE   *+8               NO, BRANCH                   ABL SEP84
         MVI   SPFLINE,0         YES, CONVERT TO NULL         ABL SEP84
         MVI   SPFTBL+2,C'S'     MAKE TABLE "PDS"              SS SEP84
         LA    R14,TBADD         ADD TO TABLE                  SS JUL84
         LA    R15,SPFTBL                                      SS JUL84
         STM   R14,R15,PARMLIST                                SS JUL84
         OI    PARMLIST+4,X'80'                                SS JUL84
         LA    R1,PARMLIST                                     SS JUL84
         L     R15,ISPLINK                                     SS JUL84
         BALR  R14,R15                                         SS JUL84
         LTR   R15,R15                                         SS JUL84
         BNZ   ISPERR                                          SS JUL84
         L     R14,SPFLAST       TRACK TABLE POSITION          SS JUL84
         LA    R14,1(R14)        ONE MORE ENTRY                SS JUL84
         ST    R14,SPFLAST       SAVE NEW COUNT                SS JUL84
         BR    R2                RETURN                        SS AUG84
         SPACE 2                                               SS JUL84
ISPMEMOD DS    0H                ADD TO TABLE                  SS JUL84
         MVI   SPFTBL+2,C'M'      MEMLIST TABLE                SS SEP84
         LA    R14,TBMOD         ADD TO TABLE                  SS SEP84
         LA    R15,SPFTBL                                      SS SEP84
         STM   R14,R15,PARMLIST                                SS SEP84
         OI    PARMLIST+4,X'80'                                SS SEP84
         LA    R1,PARMLIST                                     SS SEP84
         L     R15,ISPLINK                                     SS SEP84
         BALR  R14,R15                                         SS SEP84
         C     R15,ISPL8                                       SS SEP84
         BH    ISPERR                                          SS SEP84
         OI    SPFLAG2,SPFMEMA   MAKE MEMLIST ACTIVE           SS SEP84
         C     R15,ISPL8                                       SS SEP84
         BER   R2                ADDED AT END BY MISTAKE       SS SEP84
         TM    MEMFLAG0,MEMLGOTT TOP SET FIRST TIME            SS SEP84
         BZ    ISPQUERY          NO, QUERY TO GET CPR          SS SEP84
         SR    R15,R15           NORMAL RETURN                 SS SEP84
         BR    R2                RETURN                        SS SEP84
         SPACE 2                                               SS JUL84
ISPMEMAD DS    0H                ADD TO TABLE                  SS JUL84
         MVI   SPFTBL+2,C'M'      MEMLIST TABLE                SS SEP84
         LA    R14,TBADD         ADD TO TABLE                  SS SEP84
         LA    R15,SPFTBL                                      SS SEP84
         STM   R14,R15,PARMLIST                                SS SEP84
         OI    PARMLIST+4,X'80'                                SS SEP84
         LA    R1,PARMLIST                                     SS SEP84
         L     R15,ISPLINK                                     SS SEP84
         BALR  R14,R15                                         SS SEP84
         C     R15,ISPL8                                       SS SEP84
         BER   R2                ADDED AT END BY MISTAKE       SS SEP84
         BH    ISPERR                                          SS SEP84
         OI    SPFLAG2,SPFMEMA   MAKE MEMLIST ACTIVE           SS SEP84
         TM    MEMFLAG0,MEMLGOTT TOP SET FIRST TIME            SS SEP84
         BZ    ISPQUERY          NO, QUERY TO GET CPR          SS SEP84
         SR    R15,R15           NORMAL RETURN                 SS SEP84
         BR    R2                RETURN                        SS SEP84
         SPACE 2                                               SS JUL84
ISPMEMSC DS    0H                ADD TO TABLE                  SS JUL84
         MVI   SPFTBL+2,C'M'      MEMLIST TABLE                SS SEP84
         LA    R14,TBSCAN        ADD TO TABLE                  SS SEP84
         LA    R15,SPFTBL                                      SS SEP84
* R0 PASSED POINTING TO VAR NAME                               SS SEP84
         STM   R14,R0,PARMLIST                                 SS SEP84
         OI    PARMLIST+8,X'80'                                SS SEP84
         B     ISPSXEQ8                                        SS MAR85
         SPACE 2                                               SS JUL84
ISPQUERY DS    0H                                              SS JUL84
         LA    R14,TBQUERY        GET CPR                      SS JUL84
         ST    R14,PARMLIST                                    SS JUL84
         LA    R14,SPFTBL         TABLE NAME                   SS JUL84
         LA    R15,0              NO KEYS  - NO KEYNUM         SS JUL84
         LA    R0,0               NO NAMES - NO NAMENUM        SS JUL84
         LA    R1,VSPFFIX2        TABLE SIZE GOES HERE         SS JUL84
         STM   R14,R1,PARMLIST+4                               SS JUL84
         STM   R15,R0,PARMLIST+20                              SS JUL84
         LA    R14,VSPFFIX        CPR GOES HERE                SS JUL84
         ST    R14,PARMLIST+28                                 SS JUL84
         OI    PARMLIST+28,X'80'                               SS JUL84
         LA    R1,PARMLIST                                     SS JUL84
         L     R15,ISPLINK                                     SS JUL84
         BALR  R14,R15                                         SS JUL84
         LTR   R15,R15                                         SS JUL84
         BNZ   ISPERR                                          SS JUL84
         CLI   SPFTBL+2,C'M'      MEMLIST TABLE                SS SEP84
         BE    ISPQUER2           YES RETURN NOW               SS SEP84
         L     R15,SPFFIXE2       SAVE INFO                    SS JUL84
         LTR   R15,R15                                         SS JUL84
         BZ    ISPADD1            NOW EMPTY, PAD WITH ONE LINE SS JUL84
         ST    R15,SPFLAST                                     SS JUL84
         L     R14,SPFFIXED                                    SS JUL84
         ST    R14,SPFCRP                                      SS JUL84
         B     ISPBOTM                                         SS SEP84
ISPQUER2 DS    0H                                              SS SEP84
         SR    R15,R15           NORMAL RETURN                 SS SEP84
         L     R14,SPFFIXE2                                    SS SEP84
         ST    R14,MEMLSIZE                                    SS SEP84
         L     R14,SPFFIXED                                    SS SEP84
         ST    R14,MEMLCRP                                     SS SEP84
         TM    MEMFLAG0,MEMLGOTT                               SS SEP84
         BOR   R2                                              SS SEP84
         ST    R14,MEMLTOP                                     SS SEP84
         OI    MEMFLAG0,MEMLGOTT                               SS SEP84
         BR    R2                                              SS SEP84
         SPACE 2                                               SS SEP84
ISPTOP   DS    0H                                              SS AUG84
         LA    R14,TBTOP          PRE POSITION TO BOTTOM       SS JUL84
         B     ISPTWO             SET UP THE REST              SS JUL84
         SPACE 2                                               SS JUL84
ISPBOTM  DS    0H                                              SS AUG84
         LA    R14,TBBOTTOM       PRE POSITION TO BOTTOM       SS JUL84
ISPTWO   DS    0H                                              SS SEP84
         LA    R15,SPFTBL         TABLE NAME                   SS JUL84
         STM   R14,R15,PARMLIST                                SS JUL84
         OI    PARMLIST+04,X'80'                               SS JUL84
         B     ISPSXEQ0                                        SS MAR85
         SPACE 2                                               SS JUL84
ISPGET   DS    0H                                              SS AUG84
         LA    R14,TBGET          GET IT IF IT IS THERE        SS JUL84
         LA    R15,SPFTBL         TABLE NAME                   SS JUL84
         STM   R14,R15,PARMLIST                                SS JUL84
         OI    PARMLIST+04,X'80'                               SS JUL84
         B     ISPSXEQ8                                        SS MAR85
         SPACE 2                                               SS JUL84
*                                                              SS JUL84
*  MEMLTOP  CONTAIN MEMLIST NEW POSTION                        SS JUL84
*  MEMLCRP  CONTAIN MEMLIST CURRENT POSITION (QUERY FIRST)     SS JUL84
*                                                              SS JUL84
ISPOSTN  DS    0H                                              SS JUL84
         L     R15,MEMLTOP        CALCULATE                    SS SEP84
         LR    R14,R15                                         SS SEP84
         S     R15,MEMLCRP           SKIP AMOUNT + OR -        SS SEP84
         ST    R14,MEMLCRP        SET NEW CRP                  SS SEP84
ISPSKIP  DS    0H                 R15 IS SKIP VALUE            SS SEP84
         LTR   R15,R15            CHECK POSITION               SS JUL84
         BZR   R2                 NO SKIP REQUIRED             SS JUL84
         ST    R15,SPFFIXE2                                    SS SEP84
         LA    R14,TBSKIP         SKIP FUNCTION                SS JUL84
         LA    R15,SPFTBL                                      SS JUL84
         LA    R0,SPFFIXE2                                     SS JUL84
         STM   R14,R0,PARMLIST                                 SS JUL84
         OI    PARMLIST+08,X'80'                               SS JUL84
         B     ISPSXEQ8                                        SS MAR85
         SPACE 2                                               SS NOV84
ISPDEL1  DS    0H                                              SS NOV84
         XC    SPFFIXED,SPFFIXED                               SS NOV84
         XC    SPFFIXE2,SPFFIXE2                               SS NOV84
         MVI   SPFFIXED+3,1                                    SS NOV84
         B     ISPDEL                                          SS NOV84
*                                                              SS JUL84
*  SPFFIXED CONTAIN DELETE COUNT                               SS JUL84
*  SPFFIXE2 CONTAIN SKIP AMOUNT                                SS JUL84
*                                                              SS JUL84
ISPDEL   DS    0H                                              SS JUL84
         ICM   R14,15,SPFFIXE2    CHECK POSITION               SS JUL84
         BZ    ISPNOSK            NO SKIP REQUIRED             SS JUL84
         LA    R14,TBSKIP         SKIP FUNCTION                SS JUL84
         LA    R15,SPFTBL                                      SS JUL84
         LA    R0,SPFFIXE2                                     SS JUL84
         STM   R14,R0,PARMLIST                                 SS JUL84
         OI    PARMLIST+08,X'80'                               SS JUL84
         LA    R1,PARMLIST                                     SS JUL84
         L     R15,ISPLINK                                     SS JUL84
         BALR  R14,R15                                         SS JUL84
         C     R15,ISPL8                                       SS JUL84
         BH    ISPERR                                          SS JUL84
ISPNOSK  L     R14,SPFFIXED       INIT R14                     SS JUL84
         LTR   R14,R14            DEL AMOUNT                   SS JUL84
         BZR   R2                 NO DEL REQUIRED              SS JUL84
ISPDLUP  ST    R14,SPFFIXED       SAVE COUNT LIFT              SS JUL84
         LA    R14,TBDELETE       DELETE HIS LINE              SS JUL84
         LA    R15,SPFTBL         TABLE NAME                   SS JUL84
         STM   R14,R15,PARMLIST                                SS JUL84
         OI    PARMLIST+04,X'80'                               SS JUL84
         LA    R1,PARMLIST                                     SS JUL84
         L     R15,ISPLINK                                     SS JUL84
         BALR  R14,R15                                         SS JUL84
         C     R15,ISPL8                                       SS JUL84
         BH    ISPERR                                          SS JUL84
         BE    ISPQUERY                                        SS JUL84
         L     R14,SPFFIXED      DEL COUNT                     SS JUL84
         BCT   R14,ISPDLUP       DECRAMENT AND LOOP            SS JUL84
         BR    R2                 RETURN                       SS JUL84
         SPACE 2                                               SS JUL84
         SPACE 2                                               SS JUL84
ISPDSPSV DS    0H                                              SS SEP84
         LA    R14,ISPCNTL      CONTROL                        SS SEP84
         LA    R15,ISPDSP       DISPLAY                        SS SEP84
         LA    R0,ISPSAVE       SAVE                           SS SEP84
         STM   R14,R0,PARMLIST                                 SS SEP84
         OI    PARMLIST+8,X'80'                                SS SEP84
         B     ISPSXEQ0                                        SS MAR85
         SPACE 2                                               SS JUL84
ISPDSPRS DS    0H                                              SS SEP84
         LA    R14,ISPCNTL      CONTROL                        SS SEP84
         LA    R15,ISPDSP       DISPLAY                        SS SEP84
         LA    R0,ISPRSTR       RESTORE                        SS SEP84
         STM   R14,R0,PARMLIST                                 SS SEP84
         OI    PARMLIST+8,X'80'                                SS SEP84
         B     ISPSXEQ0                                        SS MAR85
         SPACE 2                                               SS JUL84
*                                                              SS SEP84
*  SUBROUTINE TO LOCATE COMMAND IN BUFFER AND MATCH WITH TABLE SS SEP84
*  OF COMMANDS                                                 SS SEP84
*  ENTRY ISPVER FOR ZCMD  BUFFER                               SS SEP84
*  ENTRY ISPVERL FOR LINE CMD                                  SS SEP84
*                                                              SS SEP84
         SPACE 1                                               SS SEP84
ISPVER   DS    0H            FIND PDS VERB IN CMD BUFFER       SS NOV84
         LA    R1,SPFINPUT                                     SS SEP84
ISPVERC  DS    0H            FIND PDS VERB IN GIVEN BUFFER     SS NOV84
         L     R14,ISP$TL2A  TABLE FOR SEARCH                  SS SEP84
ISPVERG  DS    0H            FIND VERB WITH GIVEN PARMS        SS NOV84
         LA    R15,30         LIMIT OF SCAN                    SS SEP84
         B     ISPVER1                                         SS SEP84
ISPVERL  DS    0H            FIND LINE VERB IN MEML2OPT        SS SEP84
         OC    MEM2OPT,ISPBLK8 FORCE UPPER CASE                SS SEP84
         LA    R1,MEM2OPT                                      SS SEP84
ISPVERLG DS    0H            FIND LINE VERB FROM GIVEN BUFFER  SS NOV84
         LA    R15,4          LIMIT OF SCAN OF LINE ENTRY      SS SEP84
         L     R14,ISP$TLA   TABLE FOR SEARCH                  SS SEP84
ISPVER1  DS    0H                                              SS MAR85
         L     R4,ISPVERAD   LOAD ADDRESS OF VERB SUBROUTINE   SS MAR85
         BR    R4                                              SS MAR85
         SPACE 5                                               SS MAR85
*                                                              SS MAR85
*   VERB SUBROUTINE USES BASE R4                               SS MAR85
*                                                              SS MAR85
         SPACE 2                                               SS SEP84
ISPEXIT  DS    0H                                              SS JUL84
         MVI   SPFLAG1,0      TURN OFF FUNCTION                SS JUL84
         LM    R2,R8,SPFSAV2                                   SS JUL84
         L     R14,SPFSAV14                                    SS JUL84
         B     4(R14)                                          SS JUL84
*                                                              SS JUL84
*  CONSTANTS                                                   SS JUL84
*                                                              SS JUL84
*  ISPF FUNCTIONS                                              SS JUL84
ISPCNTL  DC    C'CONTROL'                                      SS JUL84
ISPDISP  DC    C'DISPLAY'                                      SS NOV84
TBADD    DC    C'TBADD'                                        SS JUL84
TBBOTTOM DC    C'TBBOTTOM'                                     SS JUL84
TBCREATE DC    C'TBCREATE'                                     SS JUL84
TBDELETE DC    C'TBDELETE'                                     SS JUL84
TBDISPL  DC    C'TBDISPL'                                      SS JUL84
TBEND    DC    C'TBEND'                                        SS JUL84
TBGET    DC    C'TBGET'                                        SS JUL84
TBMOD    DC    C'TBMOD'                                        SS JUL84
TBPUT    DC    C'TBPUT'                                        SS JUL84
TBQUERY  DC    C'TBQUERY'                                      SS JUL84
TBSCAN   DC    C'TBSCAN'                                       SS JUL84
TBSKIP   DC    C'TBSKIP'                                       SS JUL84
TBTOP    DC    C'TBTOP'                                        SS JUL84
TBVCLEAR DC    C'TBVCLEAR'                                     SS JUL84
VCOPY    DC    C'VCOPY'                                        SS JUL84
VDEFINE  DC    C'VDEFINE'                                      SS JUL84
VDELETE  DC    C'VDELETE'                                      SS JUL84
VGET     DC    C'VGET'                                         SS JUL84
VRESET   DC    C'VRESET'                                       SS JUL84
*  ISPF OPERANDS                                               SS JUL84
ISPDSP   DC    C'DISPLAY'                                      SS JUL84
ISPNOND  DC    C'NONDISPL'                                     SS NOV84
ISPREF   DC    C'REFRESH'                                      SS JUL84
ISPSAVE  DC    C'SAVE'                                         SS JUL84
ISPRSTR  DC    C'RESTORE'                                      SS JUL84
ISPCHAR  DC    C'CHAR'                                         SS JUL84
ISPFIX   DC    C'FIXED'                                        SS JUL84
ISPMOVE  DC    C'MOVE'                                         SS JUL84
ISPNOWRT DC    C'NOWRITE'                                      SS JUL84
ISPPANAL DC    C'P71PN   '                                    ABL JUN85
ISPPDSM  DC    C'PDSM71.N'                                    ABL OCT84
ISPSM    DC    C'SM '                                         ABL OCT84
ISPSHARE DC    C'SHARED '                                     ABL SEP84
ISPNO    DC    C'NO '          TBDSPLY AUTOSEL=NO              SS MAR85
*  ISPF VARIABLE NAMES AND NAME LISTS                          SS JUL84
VSPFVFIX DC    C'('        START OF FIX DIALOG VERBS           SS SEP84
VSPFFIX  DC    C'PDSFIX '                                      SS JUL84
VSPFFIX2 DC    C'PDSFIX2 '                                     SS JUL84
VSPFCRP  DC    C'PDSCRP '                                      SS JUL84
VZTDTOP  DC    C'ZTDTOP '                                      SS JUL84
         DC    C')'        END OF FIX DIALOG VERBS             SS SEP84
VSPFLIN  DC    C'PDSLINE '                                     SS JUL84
VSPFMSG  DC    C'PDSMSG '                                      SS JUL84
VSPFMSG1 DC    C'PDSMSG1 '                                    ABL JUN85
VSPFMSG2 DC    C'PDSMSG2 '                                    ABL JUN85
VZCMD    DC    C'ZCMD '                                        SS JUL84
VZTIME   DC    C'ZTIME '                                       SS JUL84
VZENVIR  DC    C'ZENVIR '  ISPF V2 INDICATOR                   SS MAR85
VSPFDSN  DC    C'PDSDSN '                                      SS JUL84
VSPFPWD  DC    C'PDSPWD '                                      SS JUL84
VSPFVOL  DC    C'PDSVOL '                                      SS JUL84
VSPFMEM  DC    C'PDSMEM '                                      SS JUL84
VSPFDATA DC    C'PDSDATA '                                     SS NOV84
VSPFDSG  DC    C'PDSDSORG '                                    SS JUL84
VSPFTYPE DC    C'PDSTYPE '                                     SS JUL84
VSPFZSEL DC    C'PDSZSEL '                                     SS NOV84
VZVERB   DC    C'ZVERB '                                      ABL SEP84
* THE FOLLOWING CONSTANTS DEFINE THE TABLE VARIABLES, BOTH KEY AND
*   NAMES
         SPACE
MEMLTKEY DC    C'(MEMLNAME)'       TABLE KEY
         SPACE 3
MEMTNAML DC    C'( '               MEM TBL
MEMLTDAT DC    C'MEMLDATA '        USER ENTERED DATA
MMLOPT   DC    C'MEMLOPT '
MMLALIS  DC    C'MEMLALIS '
MMLTTR   DC    C'MEMLTTR '         MEM TBL ALIAS SCAN ARG LIST
         DC    C'MEMXATT '         HEX TTR AND STATUS          SS NOV84
         DC    C'MEMLVMOD MEMLCDAT MEMLMDAT  '
         DC    C'MEMLMTIM MEMLMID MEMLISIZ MEMLCSIZ '          SS NOV84
         DC    C'MEMLMNAM MEMLMTTR '                           SS NOV84
         DC    C'MEMLLENG MEMLENTY MEMLATT1 MEMLATT2 MEMLDC MEMLTEST '
         DC    C'MEMLAPF MEMLMODE MEMLSSI MEMLLDAT '           SS MAR85
         DC    C')'
*        ADDED MEMLISIZ MEMLSSI                                SS NOV84
*        ADDED MEMLLDAT  FUTURE: LINKEDIT DATE                 SS MAR85
         SPACE
         EJECT
*  ISPF VARIABLE LENGTHS
ISPL1    DC    F'1'                     LENGTH OF TYPE  VAR    SS SEP84
ISPL2    DC    F'2'                     LENGTH OF DSORG VAR    SS SEP84
ISPL4    DC    F'4'                     LENGTH OF FIXED VAR    SS JUL84
ISPL6    DC    F'6'                     LENGTH OF VOLUME VAR   SS SEP84
ISPL8    DC    F'8'                     LENGTH OF 8            SS JUL84
ISPL32   DC    F'32'                    LENGTH OF ZENVIR       SS MAR85
ISPL44   DC    F'44'                    LENGTH OF DSN          SS SEP84
ISPLMSG  DC    F'79'                    LENGTH OF SPFMSG      ABL NOV84
ISPL79   DC    F'79'                    LENGTH OF TABLE VAR    SS JUL84
ISPL250  DC    F'250'                   LENGTH OF ZSEL/ZCMD    SS SEP84
ISPH78   DC    H'78'                    LENGTH OF TABLE VAR-1  SS JUL84
ISPH5    DC    H'5'                     LEN PUTL BUF LESS HEAD SS JUL84
ISPH12   DC    H'12'                    RC 16                  SS NOV84
ISPH16   DC    H'16'                    RC 16                  SS NOV84
ISPLEN   DC    H'52',H'0'               LENGTH (ZCMD+4,0)     ABL OCT84
ISPLEN2  DC    H'254',H'0'              LENGTH (ZCMD+4,0)      SS NOV84
*  ISPF SUBROUTINE ACONS
ISPVERAD DC    A(ISPVER11)                                     SS MAR85
ISPALICA DC    A(ISPALICK)                                     SS MAR85
ISPLOCA  DC    A(ISPLOC)                                       SS MAR85
ISPTBDSA DC    A(ISPTBDSP)                                     SS MAR85
ISPPANDA DC    A(ISPPAND)                                      SS MAR85
ISPSETVA DC    A(ISPSETVS)                                     SS MAR85
ISPPARSA DC    A(ISPPARSE)                                     SS MAR85
ISPVINIA DC    A(ISPVINIT)                                     SS MAR85
ISPESTAE DC    A(STAEEXIT)                                    ABL JUN85
ISPDISPA DC    A(ISPDISPT)                                    ABL JUN85
ISPRLOGA DC    A(ISPRLOG)                                      SS MAY85
ISPFLOGA DC    A(ISPFLOG)                                      SS MAY85
*  ISPF OTHER CONSTANTS
ISPBLK8  DC    CL8' '                                          SS SEP84
ISPPDS   DC    C'PDS'                                          SS JUL84
ISPCEND  DC    C'END '                                         SS NOV84
ISPCPAN  DC    C'PANEL('                                       SS NOV84
ISP300A  DC    C'PDS300A'               MSG TO SKIP            SS AUG84
ISPALIS  DC    CL8'*AL*  '                                     SS SEP84
ISPUNKN  DC    CL8'*UNKNOWN'                                   SS SEP84
ISPORP   DC    CL8'*ORPHAN'                                    SS SEP84
ISPNEWNM DC   CL8'*NEWNAME'                                   ABL OCT84
ISPERMSG DC   CL8'**ERROR*'                                   ABL OCT84
ISPATTN  DC   CL8'**ATTN**'                                   ABL APR85
ISPINVLD DC   CL8'*INVALID'                                   ABL OCT84
ISPPO    DC    C'PO'                                           SS SEP84
ISPPS    DC    C'PS'                                           SS SEP84
ISPUTDOT DC    C'  UT.'                                       ABL JUN85
ISPENDIT DC    X'000D0000',CL9'&NEND'                          SS JUL84
ISPDSNMG DC    X'000D0000',CL9'&NDSN'                          SS JUL84
ISPMALL  DC    X'00100000',CL12'&NMML :'                      ABL NOV84
ISPCMD21 DC    X'00150000'                                     SS SEP84
ISPCMD30 DC    X'001E0000'                                    ABL DEC84
         SPACE 2                                               SS MAR85
* PARSE PARM LIST OPTIONS                                      SS MAR85
*        DC    X'XX'   OPTION FLAG                             SS MAR85
*              X'80'   STRING   (MUST BE FIRST IF USED)        SS MAR85
*              X'40'   NUMERIC PARM (MUST BE FIRST AFTER STR)  SS MAR85
*              X'20'   KEYWORD (NO SUB VALUES)                 SS MAR85
*              X'10'   ALLOW KEYWORD SINGLE CHAR MATCH         SS MAR85
*              X'10'   CHECK STRING FOR IMBED CHAR (FUTURE)    SS MAR85
*              X'10'   NUMERIC RANGE CHECK REQUESTED           SS MAR85
*              X'00-07' LENGTH OF COMMPARE                     SS MAR85
*              X'FF'   END OF TABLE                            SS MAR85
*        DC    X'XX'   BITS ORED IF MATCH                      SS MAR85
*        DC    CL8''/F'',F''                                   SS MAR85
*                      KEYWORD                                 SS MAR85
*                      RANGE VALUES                            SS MAR85
         SPACE 2                                               SS MAR85
* PARSE PARM LIST FOR STRING ONLY                              SS MAR85
ISPPARST DC    X'80',X'80',CL8' ',X'FF'                        SS MAR85
         SPACE 1                                               SS MAY85
* PARSE PARM LIST FOR RECALL                                   SS MAR85
         DS    0F                                              SS MAR85
         DS    H     ALIGN                                     SS MAY85
ISPPARRE DC    X'51',X'41',F'-1000',F'1000' NUMERIC            SS JUN85
         DC    X'35',X'20',CL8'CHANGE'                         SS MAR85
         DC    X'34',X'10',CL8'ENTER'                          SS MAR85
         DC    X'34',X'09',CL8'FIRST'    KEYWORDS              SS MAR85
         DC    X'32',X'01',CL8'LOG'                            SS MAY85
         DC    X'23',X'05',CL8'PREVIOUS'                       SS JUN85
         DC    X'23',X'07',CL8'LAST'                           SS JUN85
         DC    X'FF'                                           SS MAR85
         SPACE 1                                               SS MAY85
* PARSE PARM LIST FOR FIND                                     SS MAR85
         DS    0F                                              SS MAR85
ISPPARFD DC    X'80',X'00',CL8' '      STRING                  SS MAY85
         DC    X'51',X'40',F'1',F'79'  NUMERIC                 SS MAY85
         DC    X'33',X'80',CL8'ASIS'     KEYWORDS              SS MAY85
         DC    X'34',X'20',CL8'FIRST'                          SS MAY85
         DC    X'23',X'10',CL8'PREVIOUS'                       SS MAY85
         DC    X'33',X'18',CL8'LAST'                           SS MAY85
         DC    X'33',X'04',CL8'WORD'                           SS MAY85
         DC    X'23',X'02',CL8'PREFIX'                         SS MAY85
         DC    X'23',X'01',CL8'SUFFIX'                         SS MAY85
         DC    X'FF'                                           SS MAY85
         SPACE 3                                               SS MAR85
L7FFF    EQU   32767                                           SS MAR85
H7FFF    DC    H'32767'                                        SS MAR85
ISPSIZE  DC    H'&SPFSIZE'                                     SS JUL84
ISPMAX   DC    H'&SPFMAX'                                      SS JUL84
ISPCKPT  DC    H'&SPFCKPT'                                     SS JUL84
         SPACE 1                                               SS SEP84
* ADDCONS TO COMMAND TABLES AND TABLE ENTRIES                  SS NOV84
ISP$TLA  DC    A(ISP$TL)                                       SS NOV84
ISP$TL2A DC    A(ISP$TL2)                                      SS NOV84
ISP$TLXA DC    A(ISP$TLX)                                      SS NOV84
ISP$TLPA DC    A(ISP$TLP)                                      SS NOV84
ISP$TLVA DC    A(ISP$TLV)                                      SS NOV84
ISP$TLIA DC    A(ISP$TLI)                                      SS NOV84
ISP$TLMA DC    A(ISP$TLM)                                      SS NOV84
ISPEXECA DC    A(ISPEXECT)                                    ABL DEC84
ISP$TXA  DC    A(ISP$TX)                                       SS MAR85
ISP$PNA  DC    A(ISP$PAN)                                      SS MAR85
ISP$TMGA DC    A(ISP$TMG)                                      SS MAR85
         SPACE 2                                               SS NOV84
         COPY  DIATBL71                                       ABL DEC84
         USING *,R4                                            SS MAR85
ISPVER11 DS    0H                                              SS MAR85
         CLI   0(R1),C' '     SCAN FIRST NON BLANK             SS NOV84
         BNE   ISPVER2                                         SS SEP84
         LA    R1,1(,R1)      NEXT CHAR                        SS SEP84
         BCT   R15,ISPVER11                                    SS NOV84
ISPVER16 DS    0H            BLANK INPUT                       SS NOV84
         ST    R1,SPFVERB    SAVE ADDRESS                      SS NOV84
         LA    R3,1(,R1)     RESUME SCAN AT NEXT CHAR          SS SEP84
         ST    R3,SPFOPER    SAVE ADDRESS                      SS NOV84
         SR    R3,R3         LENGTH 0                          SS NOV84
         MVI   SPFNAMEH,X'41' NULL CMD                         SS NOV84
         B     ISPVER5                                         SS NOV84
ISPVER2  LA    R15,8         EXPAND SCAN                       SS SEP84
         ST    R1,SPFVERB    SAVE ADDRESS                      SS NOV84
         LA    R3,1(,R1)     RESUME SCAN AT NEXT CHAR          SS SEP84
ISPVER3  CLI   0(R3),C' '    SCAN NEXT BLANK                   SS SEP84
         BE    ISPVER4                                         SS SEP84
         CLI   0(R3),C'.'    SCAN NEXT PERIOD (PANEL SUPPORT)  SS NOV84
         BE    ISPVER4                                         SS NOV84
         LA    R3,1(,R3)     NEXT CHAR                         SS SEP84
         BCT   R15,ISPVER3                                     SS SEP84
ISPVER20 LA    R15,20        INVALID SYNTAX                    SS SEP84
***      BR    R2                                             ABL APR85
ISPVER4  DS    0H                                              SS SEP84
         ST    R3,SPFOPER    SAVE ADDRESS                      SS NOV84
         SR    R3,R1         LENGTH                            SS SEP84
         BCTR  R3,0          LESS ONE FOR CLC                  SS SEP84
         MVC   SPFNAMEH,0(R1)   SAVE THE SUBCOMMAND NAME      ABL OCT84
         OC    SPFNAMEH,ISPBLK8 UPPER CASE THE NAME           ABL OCT84
ISPVER5  TM    0(R14),#E     END OF TABLE                      SS NOV84
         BO    ISPVER12      NOT VALID                         SS NOV84
         LH    R15,$TLCM(R14) TABLE OFFSET                     SS NOV84
         TM    $TLF2(R14),#C CMD VALUE                         SS NOV84
         BZ    ISPVER66                                        SS NOV84
         LA    R15,$TLCM(R14) POINT TO VALUE IN ENTRY          SS NOV84
         B     ISPVER7                                         SS NOV84
ISPVER66 TM    0(R14),#X     EXTENDED TABLE                    SS NOV84
         BZ    ISPVER6                                         SS SEP84
         AL    R15,ISP$TXA                                     SS SEP84
         B     ISPVER7                                         SS SEP84
ISPVER6  LA    R15,$TBL(R15) TABLE ENTRY                       SS SEP84
ISPVER7  DS    0H                                              SS SEP84
         CLC   0(0,R15),SPFNAMEH  MATCH TABLE AND SUBCOMMAND  ABL OCT84
         EX    R3,*-6        FOR LENGTH OF CMD                 SS SEP84
         BE    ISPVER8       MATCH                             SS SEP84
         LA    R14,ISPTEL(,R14)  NEXT ENTRY                    SS SEP84
         B     ISPVER5                                         SS SEP84
ISPVER8  DS    0H                                              SS SEP84
         ST    R14,MEMLTPT   SAVE TABLE ENTRY ADDR             SS SEP84
         TM    0(R14),#O     LINE CMD ONLY                     SS SEP84
         BO    ISPVER08                                        SS SEP84
         TM    0(R14),#K     FORCE MEMLIST INACTIVE            SS SEP84
         BO    ISPVER04                                        SS SEP84
         SR    R15,R15       GOOD CMD                          SS SEP84
         BR    R2                                              SS SEP84
ISPVER04 LA    R15,04        FORCE MEMLIST INACTIVE            SS SEP84
         BR    R2                                              SS SEP84
ISPVER08 LA    R15,08        LINE CMD ONLY                     SS SEP84
         BR    R2                                              SS SEP84
ISPVER12 LA    R15,12        NOT FOUND                         SS SEP84
         ST    R14,MEMLTPT   SAVE TABLE ENTRY ADDR             SS NOV84
         BR    R2                                              SS SEP84
         DROP  R4                                              SS MAR85
         SPACE 2                                               SS SEP84
*                                                              SS SEP84
*  LOC NEARIST MATCH TO MEMBER NAME IN ISPNMSV                 SS SEP84
*  R3 IS RETURN REGISTER                                       SS SEP84
*                                                              SS SEP84
ISPLOC   DS    0H
         USING *,R4                                            SS MAR85
         MVI   SPFTBL+2,C'M'         MAKE SURE MEMLIST TABLE   SS SEP84
         BAL   R2,ISPQUERY           GET CURRENT TABLE SIZE    SS SEP84
         XC    MEMLNAME,MEMLNAME     NO NAME YET               SS SEP84
         OC    MEMLSIZE,MEMLSIZE     EMPTY                     SS SEP84
         BZ    ISPLOC7               YES                       SS SEP84
         BAL   R2,ISPTOP             START AT TOP              SS SEP84
ISPLOC1  L     R15,MEMLSIZE          GET SIZE                  SS SEP84
         LA    R15,2(,R15)           ROUND UP                  SS SEP84
         SRL   R15,1                 DIVIDE TABLE IN TWO       SS SEP84
         ST    R15,SPFFIXED          SAVE FIRST TIME           SS SEP84
ISPLOC2  ST    R15,SPFFIXE2          LAST SKIP VALUE           SS SEP84
         BAL   R2,ISPSKIP            DO SKIP                   SS SEP84
         LTR   R15,R15               RC 0                      SS SEP84
         BZ    ISPLOC4               YES                       SS SEP84
         L     R15,SPFFIXE2          TABLE EMPTY               SS SEP84
         LTR   R15,R15                                         SS SEP84
         BM    ISPLOC3               RAN OFF TOP               SS SEP84
         BAL   R2,ISPBOTM            RAN OFF BOTTOM            SS SEP84
         B     ISPLOC4                                         SS SEP84
ISPLOC3  LA    R15,1                 REPOSITON                 SS SEP84
         ST    R15,SPFFIXE2               TO FIRST             SS SEP84
         BAL   R2,ISPSKIP                     LINE WITH SKIP   SS SEP84
ISPLOC4  L     R15,SPFFIXED          TRY THIS                  SS SEP84
         LA    R1,1                  BINARY SEARCH OVER        SS SEP84
         CR    R15,R1                                          SS SEP84
         BNH   ISPLOC7               YES MUST BE CLOSE         SS SEP84
         LA    R15,1(,R15)           ROUND                     SS SEP84
         SRL   R15,1                 DIVIDE PORTION  IN HALF   SS SEP84
         ST    R15,SPFFIXED          SAVE                      SS SEP84
         CLC   MEMLNMSV,MEMLNAME     WHICH WAY FROM HERE       SS SEP84
         BH    ISPLOC2               GO DOWN FROM HERE         SS SEP84
         BE    ISPLOC6               WE ARE THERE              SS SEP84
ISPLOC5  DS    0H                    GO UP FROM HERE           SS SEP84
         LNR   R15,R15                  WITH NEG VALUE         SS SEP84
         B     ISPLOC2                    POSITION             SS SEP84
ISPLOC6  SR    R15,R15               RC=0 .. GOT MATCH         SS SEP84
         BR    R3                                              SS SEP84
ISPLOC7  LA    R15,1                 RC=-1.. GOT CLOSE         SS SEP84
         LNR   R15,R15                                         SS SEP84
         CLC   MEMLNMSV,MEMLNAME     JUST ABOVE OR BELOW       SS SEP84
         BE    ISPLOC6                                         SS SEP84
         BHR   R3                    ABOVE .. DONE             SS SEP84
         BAL   R2,ISPSKIP            MOVE BACK ABOVE           SS SEP84
         LTR   R15,R15                                         SS SEP84
         BZ    ISPLOC7               CHECK ONE MORE TIME       SS SEP84
         LA    R15,1                 RC=-1.. GOT CLOSE         SS SEP84
         LNR   R15,R15                                         SS SEP84
         BR    R3                    DONE                      SS SEP84
         DROP  R4                                              SS MAR85
         SPACE 2                                               SS JUL84
*                                                              SS NOV84
*   SELECT PANEL DISPLAY ROUTINE    RETURN = R3                SS NOV84
*                                                              SS NOV84
ISPPAND  DS    0H                                              SS NOV84
         USING *,R4                                            SS MAR85
         TM    SPFLAG3,SPFNOND    INVOKE PANEL NON-DISPLAY     SS NOV84
         BZ    ISPPAND2                                        SS NOV84
         LA    R14,ISPCNTL        CONTROLTABLE                 SS NOV84
         LA    R15,ISPNOND                                     SS NOV84
         STM   R14,R15,PARMLIST                                SS NOV84
         OI    PARMLIST+04,X'80'                               SS NOV84
         LA    R1,PARMLIST                                     SS NOV84
         L     R15,ISPLINK                                     SS NOV84
         BALR  R14,R15                                         SS NOV84
         LTR   R15,R15                                         SS NOV84
         BNZ   ISPERR                                          SS NOV84
         NI    SPFLAG3,255-SPFNOND                             SS NOV84
         B     ISPPAND3                                        SS NOV84
ISPPAND2 DS    0H                                              SS NOV84
         TM    SPFLAG3,SPFREFR    NEED REFRESH                 SS NOV84
         BZ    ISPPAND3                                        SS NOV84
         BAL   R2,ISPCREF                                      SS NOV84
ISPPAND3 DS    0H                                              SS NOV84
         OI    ##ADRPA#,$A+$D           IGNORE ATTENTION NOW
         LA    R14,ISPDISP        DISPLAY TABLE                SS NOV84
         L     R15,SPFPANC        PANEL NAME                   SS NOV84
         LA    R0,0               NO MSG                       SS NOV84
         CLC   SPFMSGID(4),ISPPDSM ANY MSG                     SS NOV84
         BNE   ISPPAND4                                        SS NOV84
         LA    R0,SPFMSGID                                     SS NOV84
         CLC   SPFPANPR(8),0(R15) SAME PANEL AS LAST TIME?    ABL DEC84
         BNE   ISPPAND4           NO, BRANCH                  ABL DEC84
         SR    R15,R15            YES, NULLIFY PANEL NAME     ABL DEC84
ISPPAND4 DS    0H                                              SS NOV84
         MVC   SPFPANPR(8),SPFPANC   SAVE LAST PANEL NAME     ABL DEC84
         LA    R1,VZCMD           CURSER AT CMD LINE           SS NOV84
         STM   R14,R1,PARMLIST                                 SS NOV84
         LA    R1,SPFCURSO           CURSOR OFFSET            ABL JUN85
         ST    R1,PARMLIST+16                                 ABL JUN85
         OI    PARMLIST+16,X'80'                              ABL JUN85
         SPACE 1                                               SS NOV84
ISPPAND5 DS    0H                                              SS NOV84
         LA    R1,PARMLIST                                     SS JUL84
         L     R15,ISPLINK                                     SS JUL84
         BALR  R14,R15                                         SS JUL84
         CLI   FLAGSSS,0          RETURN KEY ACTIVE?           SS NOV84
         MVI   FLAGSSS,0                                       SS NOV84
         BNE   ISPPAND5           YES, REPEAT THE TBDISPL      SS NOV84
         MVI   SPFMSGID,C' '      TURN OFF MSG                 SS NOV84
         MVI   SPFCURSO+3,0       RESET THE CURSOR OFFSET     ABL JUN85
         ST    R15,SPFFIXED       SAVE RC                      SS JUL84
         AIF ('&RETURNX' EQ 'NO').RETURN4                      SS NOV84
         CLI   SPFFIXED+3,8           RETURN CODE=8?          ABL OCT84
         BNE   ISPPAND8               NO, BRANCH              ABL OCT84
         BAL   R2,ISPDVGET                                     SS NOV84
         SPACE 1                                              ABL OCT84
         CLI   SPFRETRN,C'R'         "RETURN"                 ABL OCT84
         BNE   ISPPAND8              YES, BRANCH               SS NOV84
         CLC   SPFPANT,SPFPANC       TOP  PANEL                SS NOV84
         BNE   ISPPAND8              NO,  NO PROBLEM           SS NOV84
         MVI   FLAGSSS,C'2'          REINVOKE ALL LATER       ABL OCT84
ISPPAND8 DS    0H                                             ABL OCT84
.RETURN4 ANOP                                                 ABL OCT84
         SPACE 1                                              ABL OCT84
         CLI   SPFFIXED+3,8           RETURN?                 ABL OCT84
         BNE   ISPPAND9               YES, BRANCH              SS NOV84
         MVI   SPFFIXED+3,0          RESET RETURN CODE         SS NOV84
         MVC   SPFZSEL(4),ISPCEND    SET TO END CODE           SS NOV84
         B     ISPPANDC                                        SS NOV84
ISPPAND9 DS    0H                                              SS NOV84
         CLI   SPFFIXED+3,12          NO PANEL                 SS NOV84
         BE    ISPPANDE               YES, BRANCH              SS NOV84
         CLI   SPFFIXED+3,0                                    SS NOV84
         BNE   ISPERR                                          SS NOV84
         CLC   SPFZSEL(6),ISPCPAN    NEXT PANEL                SS NOV84
         BNE   ISPPANDC              NO                        SS NOV84
         L     R15,SPFPANC           CURRENT PANEL             SS NOV84
         C     R15,SPFPANB           IS IT LAST                SS NOV84
         BE    ISPPANDD              YES, LEAVE AS LAST        SS NOV84
         LA    R15,8(R15)            NEXT                      SS NOV84
         ST    R15,SPFPANC           UPDATA                    SS NOV84
ISPPANDD MVC   0(8,R15),SPFZSEL+6    MOVE PANEL NAME           SS NOV84
         CLI   0(R15),C'A'           GOOD ENTRY                SS NOV84
         BL    ISPPANDE              BAD ENTRY                 SS NOV84
         LA    R1,9                  SCAN FOR 8                SS NOV84
ISPPANDF CLI   0(R15),C'A'           FIND END OF NAME          SS NOV84
         BL    ISPPANDG                                        SS NOV84
         LA    R15,1(,R15)           NEXT                      SS NOV84
         BCT   R1,ISPPANDF                                     SS NOV84
         B     ISPPANDI                                        SS NOV84
ISPPANDG MVI   0(R15),C' '           BLANK OUT REST            SS NOV84
         LA    R15,1(,R15)           NEXT                      SS NOV84
         BCT   R1,ISPPANDG                                     SS NOV84
ISPPANDH BAL   R2,ISPSHCMD           SHIFT ZCMD TO NEXT '.'    SS NOV84
         CLI   SPFVZCMD,C' '         IS IT BLANK               SS NOV84
         BE    ISPPAND               YES DISPLAY PANEL         SS NOV84
         OI    SPFLAG3,SPFNOND       NO, INVOKE PANEL NONDISPL SS NOV84
         B     ISPPAND                                         SS NOV84
ISPPANDC DS    0H                                              SS NOV84
         CLI   SPFZSEL,C' '          NULL                      SS NOV84
         BNH   ISPPANDN              YES                       SS NOV84
         CLI   SPFZSEL,C'?'          INVALID                   SS NOV84
         BE    ISPPANDI                                        SS NOV84
         B     ISPPANDJ              CONTINUE CHECKS           SS NOV84
ISPPANDI DS    0H                                              SS NOV84
         MVC   SPFMSGID,ISPPDSM      SET BASE MSG              SS NOV84
         MVI   SPFMSGID+6,C'9'       COMMON MSG                SS NOV84
         MVI   SPFMSGID+7,C'A'       COMMON MSG                SS NOV84
         B     ISPPAND               TRY AGAIN                 SS NOV84
ISPPANDN DS    0H                                              SS NOV84
         MVC   SPFMSGID,ISPPDSM      SET BASE MSG              SS NOV84
         MVI   SPFMSGID+6,C'9'       COMMON MSG                SS NOV84
         MVI   SPFMSGID+7,C'E'       COMMON MSG                SS NOV84
         B     ISPPAND               TRY AGAIN                 SS NOV84
ISPPANDE DS    0H                                              SS NOV84
         MVC   SPFMSGID,ISPPDSM      SET BASE MSG              SS NOV84
         MVI   SPFMSGID+6,C'9'       COMMON MSG                SS NOV84
         MVI   SPFMSGID+7,C'P'       BAD PANEL                 SS NOV84
         MVC   SPFZSEL(4),ISPCEND    END CODE                  SS NOV84
ISPPANDJ DS    0H                                              SS NOV84
         CLC   SPFZSEL(4),ISPCEND    END CODE                  SS NOV84
         BNE   ISPPANDX              NO, GOT COMMAND           SS NOV84
         CLC   SPFPANC,SPFPANT       LAST PANEL                SS NOV84
         BER   R3                    RETURN END                SS NOV84
         L     R14,SPFPANC           GET ADDR                  SS NOV84
         S     R14,ISPL8             BACK UP 8                 SS NOV84
         ST    R14,SPFPANC                                     SS NOV84
         B     ISPPAND                                         SS NOV84
ISPPANDX DS    0H                                              SS NOV84
         SPACE 2                                               SS NOV84
         NI    ##ADRPA#,FF-$A-$D        DO NOT IGNORE ATTENTION NOW
         SPACE 1
         ESTAE 0                        CANCEL THE ESTAE ADDRESS
         MVC   STAEPARM(4),STAELIST     RESET THE ESTAE ADDRESS
         L     R2,ISPESTAE              ESTAE EXIT ADDRESS    ABL JUN85
         ESTAE (R2),CT,PARAM=(R7),MF=(E,STAEPARM)             ABL JUN85
         BR    R3                                              SS NOV84
         SPACE 2                                               SS SEP84
         DROP  R4                                              SS MAR85
*                                                              SS SEP84
*  ALIAS CHECKER                                               SS SEP84
*  R3 IS RETURN REGISTER                                       SS SEP84
*                                                              SS SEP84
ISPALICK DS    0H                                              SS SEP84
         USING *,R4                                            SS MAR85
         MVI   SPFTBL+2,C'M'         MAKE SURE USING MEMLIST   SS SEP84
         BAL   R2,ISPTOP             START WITH TOP            SS SEP84
ISPALI2  DS    0H                                              SS SEP84
         MVC   MEM2ALIS,ISPALIS      SET CODE FOR ALIAS INDIC  SS SEP84
         LA    R0,MMLALIS            SCAN VARIABLE             SS SEP84
         BAL   R2,ISPMEMSC           DO SCAN                   SS SEP84
         C     R15,ISPL8             NONE FOUND                SS SEP84
         BER   R3                    DONE                      SS SEP84
         MVC   MEMLNMSV,MEMLNAME     SAVE NAME                 SS SEP84
         MVC   MEMLTTSV,MEM2TTR      SAVE TTR                  SS SEP84
         TM    FLAGSCC,RECFMU        IS IT A LOAD MODE         SS SEP84
         BO    ISPALI50              YES                       SS SEP84
ISPALI3  DS    0H                                              SS SEP84
         BAL   R2,ISPTOP             START AT TOP              SS SEP84
ISPALI4  DS    0H                                              SS SEP84
         MVC   MEM2TTR,MEMLTTSV      TTR FOR SCAN              SS SEP84
         LA    R0,MMLTTR             SCAN FOR                  SS SEP84
         BAL   R2,ISPMEMSC                   MATCH TTR         SS SEP84
         C     R15,ISPL8             FOUND ANY                 SS SEP84
         BE    ISPALI10              NO                        SS SEP84
         CLC   MEM2ALIS,ISPBLK8      ANOTHER ALIAS             SS SEP84
         BNE   ISPALI4               YES KEEP TRYING           SS SEP84
* GOT A MATCH                                                  SS SEP84
         XC    MEMLNAME,MEMLNMSV     SWITCH                    SS SEP84
         XC    MEMLNMSV,MEMLNAME          MEMBER               SS SEP84
         XC    MEMLNAME,MEMLNMSV                NAMES          SS SEP84
         BAL   R2,ISPGET             GET ORIGINAL MEMBER       SS SEP84
         MVC   MEM2ALIS,MEMLNMSV     ALIAS OF NAME             SS SEP84
         BAL   R2,ISPMEMOD           UPDATE                    SS SEP84
         B     ISPALI2               CONTINUE WITH NEXT        SS SEP84
ISPALI10 DS    0H                    NO MATCH                  SS SEP84
         MVC   MEMLNAME,MEMLNMSV                NAMES          SS SEP84
         BAL   R2,ISPGET             GET ORIGINAL MEMBER       SS SEP84
         MVC   MEM2ALIS,ISPUNKN      MARK UNKNOWN              SS SEP84
         BAL   R2,ISPMEMOD           UPDATE                    SS SEP84
         B     ISPALI2               CONTINUE WITH NEXT        SS SEP84
ISPALI50 DS    0H                                              SS SEP84
         CLC   MEM2MNAM,ISPBLK8      IS THERE A MAIN NAME      SS SEP84
         BE    ISPALI3                                         SS SEP84
         MVI   MEMFLAG2,0            CLEAR BEFORE TESTS        SS SEP84
         MVC   MEMLNAME,MEM2MNAM     GET THIS ON IF THERE      SS SEP84
         BAL   R2,ISPGET             GET ORIGINAL MEMBER       SS SEP84
         C     R15,ISPL8             IS THERE ONE              SS SEP84
         BE    ISPALI55              NO, TRY BY TTR            SS SEP84
         OI    MEMFLAG2,MEMLGMNM     FOUND MAIN NAME           SS SEP84
         CLC   MEMLTTSV,MEM2TTR      SAME TTR                  SS SEP84
         BNE   ISPALI55              NO                        SS SEP84
         XC    MEMLNAME,MEMLNMSV     SWITCH                    SS SEP84
         XC    MEMLNMSV,MEMLNAME          MEMBER               SS SEP84
         XC    MEMLNAME,MEMLNMSV                NAMES          SS SEP84
         BAL   R2,ISPGET             GET ORIGINAL MEMBER       SS SEP84
         MVC   MEM2ALIS,MEMLNMSV     ALIAS OF NAME             SS SEP84
         MVC   MEM2MTTR,MEMLNMSV     ALIAS OF NAME             SS SEP84
         BAL   R2,ISPMEMOD           UPDATE                    SS SEP84
         B     ISPALI2               CONTINUE WITH NEXT        SS SEP84
ISPALI55 DS    0H                                              SS SEP84
         MVC   MEM2TTR,MEMLTTSV      TRY  TTR                  SS SEP84
         BAL   R2,ISPTOP             START AT TOP              SS SEP84
ISPALI56 DS    0H                                              SS SEP84
         LA    R0,MMLTTR             SCAN FOR                  SS SEP84
         BAL   R2,ISPMEMSC                   MATCH TTR         SS SEP84
         C     R15,ISPL8             FOUND ANY                 SS SEP84
         BE    ISPALI57              UNKNOWN                   SS SEP84
         CLC   MEM2ALIS,ISPBLK8      ANOTHER ALIAS             SS SEP84
         BNE   ISPALI56              YES KEEP TRYING           SS SEP84
* GOT A MATCH                                                  SS SEP84
         OI    MEMFLAG2,MEMLGTTR     FOUND TTR MATCH           SS SEP84
         XC    MEMLNAME,MEMLNMSV     SWITCH                    SS SEP84
         XC    MEMLNMSV,MEMLNAME          MEMBER               SS SEP84
         XC    MEMLNAME,MEMLNMSV                NAMES          SS SEP84
         BAL   R2,ISPGET             GET ORIGINAL MEMBER       SS SEP84
         MVC   MEM2MTTR,MEMLNMSV     ALIAS OF NAME             SS SEP84
         B     ISPALI58                                        SS SEP84
ISPALI57 DS    0H                                              SS SEP84
         MVC   MEMLNAME,MEMLNMSV     ORIGINAL MEMBER NAME      SS SEP84
         BAL   R2,ISPGET             GET ORIGINAL MEMBER       SS SEP84
ISPALI58 DS    0H                                              SS SEP84
         MVC   MEM2ALIS,ISPORP       ORPHAN                    SS SEP84
         SR    R15,R15               CLEAR                     SS SEP84
         IC    R15,MEMFLAG2          GET STATUS                SS SEP84
         LA    R15,X'F1'(,R15)       ADD 1 AND MAKE PRINTABLE  SS SEP84
         STC   R15,MEM2ALIS+7        TYPE ORPHAN               SS SEP84
         BAL   R2,ISPMEMOD           UPDATE                    SS SEP84
         B     ISPALI2               CONTINUE WITH NEXT        SS SEP84
         DROP  R4                                              SS MAR85
         SPACE 2                                               SS MAR85
*                                                              SS MAR85
*  TABLE DISPLAY SUBROUTINE                                    SS MAR85
*                                                              SS MAR85
ISPTBDSP DS    0H                                              SS SEP84
         USING *,R4                                            SS MAR85
         TM    SPFLAG3,SPFREFR    NEED REFRESH                 SS NOV84
         BZ    ISPTBDNR                                        SS NOV84
         BAL   R2,ISPCREF                                      SS NOV84
ISPTBDNR DS    0H                                              SS NOV84
         OI    ##ADRPA#,$A+$D           IGNORE ATTENTION NOW
         LA    R14,TBDISPL        DISPLAY TABLE                SS JUL84
         ST    R14,PARMLIST                                    SS JUL84
         LA    R14,SPFTBL         TABLE NAME                   SS JUL84
         LA    R15,SPFPANEL       PANEL NAME                   SS JUL84
         LA    R0,0               NO MSG                       SS JUL84
         CLC   SPFMSGID(4),ISPPDSM ANY MSG                     SS NOV84
         BNE   ISPTBDNM                                        SS NOV84
         LA    R0,SPFMSGID                                     SS NOV84
         CLC   SPFPANPR(8),0(R15) SAME PANEL AS LAST TIME?    ABL DEC84
         BNE   ISPTBDNM           NO, BRANCH                  ABL DEC84
         SR    R15,R15            YES, NULLIFY PANEL NAME     ABL DEC84
ISPTBDNM DS    0H                                              SS NOV84
         CLI   SPFTBL+2,C'M'      MEMLIST TABLE?               SS MAR85
         BNE   ISPTBDNC           NO, NO CURSOR CRP            SS MAR85
         TM    SPFLAG2,SPFZPOS    POSITIONING CALL?           ABL JUN85
         BNO   ISPTBDV1           NO, BRANCH                  ABL JUN85
         CLC   SPFPANPR(8),SPFPANEL  PANEL NAMES EQUAL?       ABL JUN85
         BNE   ISPTBDV1              NO, CANNOT USE BLANK     ABL JUN85
         SR    R15,R15            CLEAR THE PANEL NAME        ABL JUN85
ISPTBDV1 DS    0H                                             ABL JUN85
         MVC   SPFPANPR(8),SPFPANEL  SAVE LAST PANEL NAME     ABL JUN85
         NI    SPFLAG2,255-SPFZPOS  TURN OFF POSITING FLAG    ABL JUN85
         L     R1,MEMLCCRP        CURSER AT A LINE             SS MAR85
         LTR   R1,R1                                           SS MAR85
         BZ    ISPTBDNC                                        SS MAR85
         LA    R1,MMLOPT          SET CURSER AT OPT FIELD      SS MAR85
         STM   R14,R1,PARMLIST+4                               SS MAR85
         LA    R14,MEMLCCRP       CRP                          SS MAR85
         ST    R14,PARMLIST+20                                 SS MAR85
         CLI   SPFVERSN,C'2'      ISPF V2 OR LATER             SS MAR85
         BNL   ISPTBDV2           YES                          SS MAR85
         OI    PARMLIST+20,X'80'                               SS JUL84
         B     ISPTBDNF                                        SS MAR85
ISPTBDV2 DS    0H                                              SS MAR85
         SR    R0,R0                                           SS MAR85
         ST    R0,PARMLIST+24     NO POSITION                  SS MAR85
         LA    R14,ISPNO          NO AUTOSEL                   SS MAR85
         ST    R14,PARMLIST+28                                 SS MAR85
         OI    PARMLIST+28,X'80'                               SS JUL84
         CLC   SPFMSGID(4),ISPPDSM    ANY MESSAGE ?            AXC
         BNE   ISPTBDNF                                        AXC
         OI    PARMLIST+20,X'80'      YES USE AUTO SELECT      AXC
         B     ISPTBDNF                                        SS MAR85
ISPTBDNC DS    0H                                              SS MAR85
         MVC   SPFPANPR(8),SPFPANEL  SAVE LAST PANEL NAME     ABL JUN85
         LA    R1,VZCMD           CURSER AT CMD LINE           SS JUL84
         STM   R14,R1,PARMLIST+4                               SS JUL84
         OI    PARMLIST+16,X'80'                               SS MAR85
ISPTBDNF DS    0H                                              SS MAR85
         CLI   FLAGSSS,C'4'       RETURN FROM MEMLIST?        ABL OCT84
         BL    ISPREAP2           NO, BRANCH                  ABL OCT84
         CLI   SPFPANEL+5,C'4'    MEMLIST PANEL?              ABL NOV84
         BNH   ISPREAP2           NO, BRANCH                  ABL NOV84
         MVI   FLAGSSS,0          YES, CLEAR IT NOW           ABL OCT84
         SPACE 1                                              ABL SEP84
ISPREAP2 DS    0H                                             ABL SEP84
         LA    R1,PARMLIST                                     SS JUL84
         L     R15,ISPLINK                                     SS JUL84
         BALR  R14,R15                                         SS JUL84
         CLI   FLAGSSS,0          RETURN KEY ACTIVE?          ABL SEP84
         MVI   FLAGSSS,0                                      ABL SEP84
         BNE   ISPREAP2           YES, REPEAT THE TBDISPL     ABL SEP84
         MVI   SPFMSGID,C' '      TURN OFF MSG                 SS NOV84
         ST    R15,SPFFIXED       SAVE RC                      SS JUL84
         CLI   SPFFIXED+3,8           RETURN CODE=8?          ABL OCT84
         BNE   ISPSET8                NO, BRANCH              ABL OCT84
         BAL   R2,ISPDVGET                                     SS NOV84
         SPACE 1                                              ABL OCT84
         CLI   SPFRETRN,C'R'         "RETURN"                 ABL OCT84
         BE    ISPSET4               YES, BRANCH              ABL DEC84
         MVC   SPFVZCMD(2),ISP8      SET TO 'END' CODE        ABL DEC84
         MVI   SPFFIXED+3,0          RESET RETURN CODE        ABL DEC84
         CLI   SPFPANEL+5,C'1'       PANEL 1 (PRIMARY)?       ABL DEC84
         BNE   ISPSET8               NO, BRANCH               ABL DEC84
         CLI   PDSENTRY+3,0          ENTERED AS A DIALOG?     ABL DEC84
         BE    ISPSET8               YES, BRANCH              ABL DEC84
         MVC   SPFVZCMD(2),ISP1      END ON PANEL 1           ABL DEC84
         B     ISPSET8                                        ABL DEC84
ISPSET4  DS    0H                                             ABL DEC84
         MVC   SPFVZCMD(2),ISPR      SET TO 'RETURN' CODE     ABL DEC84
         CLI   SPFPANEL+5,C'1'       PANEL 1 (PRIMARY)?       ABL DEC84
         BE    ISPSET8               YES, NO PROBLEM          ABL DEC84
         CLI   PDSENTRY+3,0          ENTRY FROM SPF PANEL?    ABL DEC84
         BE    ISPSET8               YES, NO PROBLEM          ABL DEC84
         MVI   SPFFIXED+3,0          RESET RETURN CODE        ABL DEC84
         AIF ('&RETURNX' EQ 'NO').RETURN3                     ABL DEC84
         MVI   FLAGSSS,C'2'          REINVOKE ALL LATER       ABL OCT84
         CLI   SPFPANEL+5,C'5'       PANEL 5?                 ABL OCT84
         BL    ISPSET8               LOWER, BRANCH            ABL DEC84
         MVI   FLAGSSS,C'4'          REINVOKE EXCEPT MEMLIST  ABL OCT84
.RETURN3 ANOP                                                 ABL DEC84
ISPSET8  DS    0H                                             ABL OCT84
         NI    SPFLAG3,FF-SPFLOGM     ASSUME NO LOGGING        SS NOV84
***TEST  OI    SPFLAG3,SPFLOGM        ASSUME MESSAGE LOGGING  ABL DEC84
         CLI   SPFFIXED+3,8           VALID RETURN CODE?      ABL DEC84
         BH    ISPERR                 NO, ERROR               ABL DEC84
* ALL VALIDATION DONE BY TABLES AT ISPOPTT                     SS NOV84
         SPACE 2                                               SS NOV84
         NI    ##ADRPA#,FF-$A-$D        DO NOT IGNORE ATTENTION NOW
         SPACE 1
         ESTAE 0                        CANCEL THE ESTAE ADDRESS
         MVC   STAEPARM(4),STAELIST     RESET THE ESTAE ADDRESS
         L     R2,ISPESTAE              ESTAE EXIT ADDRESS    ABL JUN85
         ESTAE (R2),CT,PARAM=(R7),MF=(E,STAEPARM)             ABL JUN85
         CLI   SPFFIXED+3,4           MORE THAN ONE LINE CMD? ABL JUN85
         BER   R3                     YES, RETURN             ABL JUN85
         CLC   SPFVZCMD(2),ISP1       END AT PANEL 1?         ABL JUN85
         BER   R3                     YES, RETURN             ABL JUN85
         CLC   SPFVZCMD(2),ISP8       END SUBCOMMAND?         ABL JUN85
         BER   R3                     YES, RETURN             ABL JUN85
         LA    R0,80              CHARACTERS TO SCAN          ABL JUN85
         LA    R1,SPFVZCMD+80     WHERE TO START SCAN         ABL JUN85
ISPTBLB  CLI   0(R1),X'40'        BLANK?                      ABL JUN85
         BNE   ISPTBLNB           NO, BRANCH                  ABL JUN85
         BCTR  R1,0               ONE LESS CHARACTER          ABL JUN85
         BCT   R0,ISPTBLB         CHECK ALL CHARACTERS?       ABL JUN85
         BR    R3                 YES, ALL BLANK              ABL JUN85
ISPTBLNB CLI   0(R1),C'+'         CONTINUATION DESIRED?       ABL JUN85
         BNER  R3                 NO, RETURN                  ABL JUN85
         ST    R3,SPFSAVER        SAVE THE RETURN ADDRESS     ABL JUN85
         LA    R0,SPFVZCMD-1      OFFSET BY -1                ABL JUN85
         SR    R1,R0                                          ABL JUN85
         ST    R1,SPFCURSO        SAVE THE CURSOR POSITION    ABL JUN85
         L     R4,ISPSETVA        SET SERVICE ROUTINE         ABL JUN85
         BALR  R3,R4                                          ABL JUN85
         L     R0,SPFPANT                                     ABL JUN85
         ST    R0,SPFPANC                                     ABL JUN85
         MVC   SPFPSTK(8),ISP$PANC  CONTINUED PANEL           ABL JUN85
         L     R4,ISPPANDA          GET ADDR OF PAN DSP SUBR  ABL JUN85
         BALR  R3,R4                                          ABL JUN85
         L     R3,SPFSAVER        RESET THE RETURN ADDRESS    ABL JUN85
         CLC   SPFZSEL(4),ISPCEND                             ABL JUN85
         BNER  R3                                             ABL JUN85
         MVI   SPFVZCMD,X'40'                                 ABL JUN85
         MVC   SPFVZCMD+1(249),SPFVZCMD  RIPPLE               ABL JUN85
         BR    R3                                             ABL JUN85
         SPACE 2                                              ABL JUN85
         BR    R3                                             ABL JUN85
         DROP  R4                                              SS MAR85
*                                                              SS MAR85
*   PARSE SUBROUTINE  R3 = RETURN                              SS MAR85
*                     R1 = PARSE LIST                          SS MAR85
*                     R14= LENGTH OF INPUT LINE                SS MAR85
*                     R15= INPUT LINE ADDRESS                  SS MAR85
***** UNTESTED  *****                                          SS MAR85
ISPPARSE DS    0H                                              SS MAR85
         USING *,R4                                            SS MAR85
         MVI   SPFPRRC,0    SET RC ZERO                        SS MAR85
         MVI   SPFPRBI,0    ZERO PARM BITS                     SS MAR85
         BAL   R2,ISPCKBLK  POSITION AT FIRST NON BLANK        SS MAR85
         LTR   R15,R15      ANY                                SS MAR85
         BZ    ISPPARE8     NO  STRING FOUND                   SS MAR85
         ST    R1,SPFPRAD   SAVE PARSE LIST                    SS MAR85
         TM    0(R1),X'80'  STRING REQUEST                     SS MAR85
         BZ    ISPPAR50     NO TRY OTHER                       SS MAR85
         CLI   0(R15),X'8B' BRACKET                            SS MAR85
         BE    ISPPAR05     YES USE A DELIMITER                SS MAR85
         CLI   0(R15),X'80' ALPHA (UPPER OR LOWER)             SS MAR85
         BH    ISPPAR10     YES, USE BLANK AS DELIMITER        SS MAR85
         CLI   0(R15),C'$'  NATIONAL CHAR                      SS MAR85
         BE    ISPPAR10     YES, USE BLANK AS DELIMITER        SS MAR85
         CLI   0(R15),C'@'  NATIONAL CHAR                      SS MAR85
         BE    ISPPAR10     YES, USE BLANK AS DELIMITER        SS MAR85
         CLI   0(R15),C'#'  NATIONAL CHAR                      SS MAR85
         BE    ISPPAR10     YES, USE BLANK AS DELIMITER        SS MAR85
         TM    1(R1),X'80'  FIND COMMAND?                     ABL JUN85
         BZ    ISPPAR02     YES, USE CHARACTER AS DELIMITER   ABL JUN85
         CLI   0(R15),C'*'  RECALL GROUP                       SS MAR85
         BE    ISPPAR10     YES, USE BLANK AS DELIMITER        SS MAR85
         CLI   0(R15),C':'  GROUP                              SS MAR85
         BE    ISPPAR10     YES, USE BLANK AS DELIMITER        SS MAR85
         CLI   0(R15),C'/'  PATTERN?                          ABL JUN85
         BE    ISPPAR10     YES, USE BLANK AS DELIMITER?      ABL JUN85
ISPPAR02 DS    0H                                             ABL JUN85
         IC    R1,0(R15)    INSERT COMPARE CHAR                SS MAR85
         LA    R15,1(,R15)  START AT NEXT CHAR                 SS MAR85
         B     ISPPAR15     CONTINUE                           SS MAR85
ISPPAR05 DS    0H                                              SS MAR85
         IC    R1,0(R15)                                       SS MAR85
         B     ISPPAR15                                        SS MAR85
ISPPAR10 DS    0H                                              SS MAR85
         LA    R1,C' '      USE BLANK                          SS MAR85
ISPPAR15 DS    0H                                              SS MAR85
         ST    R15,SPFPRSR  START OF STRING                    SS MAR85
         BAL   R2,ISPCLI                                       SS MAR85
         LTR   R15,R15                                         SS MAR85
         BZ    ISPPAREL     RC 12 ERROR IN LENGTH OF STRING    SS MAR85
         LR    R0,R15                                          SS MAR85
         SL    R0,SPFPRSR   CALULATE LENGTH                    SS MAR85
         BCTR  R0,0         LESS ON                            SS MAR85
         STH   R0,SPFPRLN                                      SS MAR85
         L     R1,SPFPRAD   GET ADDRESS OF PARM                SS MAR85
         OC    SPFPRBI,1(R1) OR IN PARM BIT                    SS MAR85
         CLI   0(R15),C' '  WE AT BLANK                        SS MAR85
         BE    ISPPAR20     YES                                SS MAR85
         LA    R15,1(,R15)  SKIP OVER DELIMITER                SS MAR85
ISPPAR20 DS    0H                                              SS MAR85
         BAL   R2,ISPCKBLK  FIND NEXT PARM                     SS MAR85
         LTR   R15,R15      ANY FOUND                          SS MAR85
         BZR   R3           NO DONE                            SS MAR85
         LA    R1,10(,R1)   SET TO NEXT PARSE ENTRY            SS MAR85
         ST    R1,SPFPRAD                                      SS MAR85
ISPPAR50 DS    0H                                              SS MAR85
         MVI   SPFPRRC,24   INCASE INVALID KEY                 SS MAY85
         ST    R14,SPFPRLL  SAVE IT                            SS MAR85
         L     R1,SPFPRAD   GET ADDRESS                        SS MAR85
         CLI   0(R1),X'FF'  END OF TABLE                       SS MAR85
         BE    ISPPAR90     DONE, SETUP RC                     SS MAR85
         CLI   0(R15),C'-'  IS IT NUMERIC (NEGATIVE)           SS MAR85
         BE    ISPPAR60     YES                                SS MAR85
         CLI   0(R15),C'0'  IS IT NUMERIC                      SS MAR85
         BNL   ISPPAR62     YES                                SS MAR85
         TM    0(R1),X'40'  NUMERIC PARM                       SS MAR85
         BZ    ISPPAR70     NO                                 SS MAR85
         LA    R1,10(,R1)   NEXT ENTRY                         SS MAR85
         B     ISPPAR70     TRY KEYWORDS                       SS MAR85
ISPPAR60 DS    0H                                              SS MAR85
         OI    SPFPRRC,X'80' SAY NEGATIVE VALUE                SS MAR85
         LA    R15,1(,R15)  SKIP OVER - SIGN                   SS MAR85
         BCT   R14,ISPPAR61                                    SS MAR85
         B     ISPPARES     NO NUMBERS                         SS MAR85
ISPPAR61 CLI   0(R15),C'0'  CHECK NUMERIC FOR SURE             SS MAR85
         BL    ISPPARES     NO NUMBERS                         SS MAR85
ISPPAR62 DS    0H                                              SS MAR85
         TM    0(R1),X'40'  WE LOOKING FOR NUMERIC             SS MAR85
         BZ    ISPPARES     NO NUMBERS ALLOWED                 SS MAR85
         ST    R15,SPFPRNU  SAVE LOCATION                      SS MAR85
ISPPAR63 CLI   0(R15),C'0'  FIND ALL THE NUMBERS               SS MAR85
         BL    ISPPAR65     END OF NUMBERS                     SS MAR85
         LA    R15,1(,R15)  NEXT                               SS MAR85
         BCT   R14,ISPPAR63 CONTINUE                           SS MAR85
ISPPAR65 ST    R14,SPFPRLL  SAVE                               SS MAR85
         L     R14,SPFPRNU  GET ADDRESS NUMBER                 SS MAR85
         LR    R1,R15                                          SS MAR85
         SLR   R1,R14       CALULATE LENGTH                    SS MAR85
         BCTR  R1,0         ON LESS FOR PACK                   SS MAR85
         EX    R1,ISPPAR95  DO PACK                            SS MAR85
         TM    SPFPRRC,X'80'  WAS IT NEG                       SS MAR85
         BZ    ISPPAR66                                        SS MAR85
         NI    WORKTBL+7,X'FD' MAKE NEG DECIMAL                SS MAR85
ISPPAR66 DS    0H                                              SS MAR85
         CVB   R14,WORKTBL                                     SS MAR85
         ST    R14,SPFPRNU  SAVE VALUE                         SS MAR85
         L     R1,SPFPRAD   GET ADDRESS OF PARM                SS MAR85
         TM    0(R1),X'10'  CHECK RANGE REQUIRED               SS MAY85
         BZ    ISPPAR67     NO                                 SS MAY85
         C     R14,2(,R1)   LOWER RANGE                        SS MAY85
         BL    ISPPARER     LOWER IS ERROR                     SS MAY85
         C     R14,6(,R1)   UPPER RANGE                        SS MAY85
         BH    ISPPARER     UPPER IS ERROR                     SS MAY85
ISPPAR67 DS    0H                                              SS MAY85
         MVI   SPFPRRC,0    GOOD SO FAR                        SS MAY85
         OC    SPFPRBI,1(R1) OR IN PARM BIT                    SS MAR85
         B     ISPPAR80     CONTINUE LOOKING FOR OTHER PARMS   SS MAR85
ISPPAR95 PACK  WORKTBL(8),0(0,R14)   EXECUTED                  SS MAR85
ISPPAR70 DS    0H                                              SS MAR85
         CLI   0(R1),X'FF'  END OF TABLE                       SS MAR85
         BE    ISPPAREK     DONE, SETUP RC                     SS MAR85
         TM    0(R1),X'20'  IS IT KEYWORD                      SS MAR85
         BZ    ISPPAREP     INVALID PARSE PARM RC=16           SS MAR85
         TM    0(R1),X'10'  SINGLE CHAR CHECK                  SS MAY85
         BZ    ISPPAR72     NO                                 SS MAY85
         CLI   1(R15),C' '  ONLY ONE CHAR                      SS MAY85
         BNE   ISPPAR72     NO                                 SS MAY85
         OC    0(1,R15),ISPBLK8 MAKE UPPER CASE                SS MAR85
         CLC   0(1,R15),2(R1) COMPARE PARM TO KEYWORD          SS MAR85
         BNE   ISPPAR75     TRY NEXT KEYWORD                   SS MAR85
         B     ISPPAR73     GOOD KEY                           SS MAR85
ISPPAR72 DS    0H                                              SS MAY85
         IC    R14,0(R1)    GET COMPARE LENGTH                 SS MAR85
         N     R14,ISPPAR97 AND OUT OTHER BITS                 SS MAR85
         OC    0(8,R15),ISPBLK8 MAKE UPPER CASE                SS MAR85
         EX    R14,ISPPAR98 COMPARE KEYWORD                    SS MAR85
         BNE   ISPPAR75     TRY NEXT KEYWORD                   SS MAR85
ISPPAR73 DS    0H                                              SS MAY85
         MVI   SPFPRRC,0    GOOD KEY                           SS MAY85
         OC    SPFPRBI,1(R1) FOUND THIS KEYWORD                SS MAR85
         B     ISPPAR80     SETUP FOR NEXT PARM                SS MAR85
ISPPAR75 DS    0H                                              SS MAR85
         LA    R1,10(,R1)   NEXT ENTRY                         SS MAR85
         B      ISPPAR70    CONTINUE                           SS MAR85
         DS    0F                                             ABL APR85
ISPPAR97 DC    X'00000007'  MASK LAST 3 BITS                   SS MAR85
ISPPAR98 CLC   0(0,R15),2(R1) COMPARE PARM TO KEYWORD          SS MAR85
ISPPAR80 DS    0H                                              SS MAR85
         L     R14,SPFPRLL  GET LENGTH                         SS MAR85
         LTR   R14,R14      ANY MORE                           SS MAR85
         BZ    ISPPAR90     SETUP RC                           SS MAR85
         LA    R1,C' '      FIND NEXT BLANK                    SS MAR85
         BAL   R2,ISPCLI                                       SS MAR85
         LTR   R15,R15                                         SS MAY85
         BZ    ISPPAR90     END OF INPUT                       SS MAY85
         BAL   R2,ISPCKBLK  FIND NEXT PARM                     SS MAY85
         LTR   R15,R15                                         SS MAY85
         BZ    ISPPAR90     END OF INPUT                       SS MAY85
         B     ISPPAR50     VERIFY THIS PARM                   SS MAR85
ISPPARE8 MVI   SPFPRRC,8    NO STRING PARM                     SS MAY85
         B     ISPPAR90                                        SS MAY85
ISPPAREL MVI   SPFPRRC,12   STRING PARM TO LONG                SS MAY85
         MVC   SPFMSGID,ISPPDSM SETUP MESSAGE                  SS MAY85
         MVI   SPFMSGID+7,C'A'                                 SS MAY85
         MVI   SPFMSGID+6,C'3'                                 SS MAY85
         B     ISPPAR90                                        SS MAY85
ISPPARES MVI   SPFPRRC,16   SYNTAX ERROR IN NUMERIC            SS MAY85
         MVC   SPFMSGID,ISPPDSM SETUP MESSAGE                  SS MAY85
         MVI   SPFMSGID+7,C'A'                                 SS MAY85
         MVI   SPFMSGID+6,C'4'                                 SS MAY85
         B     ISPPAR90                                        SS MAY85
ISPPARER MVI   SPFPRRC,20   RANGE  ERROR IN NUMERIC            SS MAY85
         MVC   SPFMSGID,ISPPDSM SETUP MESSAGE                  SS MAY85
         MVI   SPFMSGID+7,C'A'                                 SS MAY85
         MVI   SPFMSGID+6,C'5'                                 SS MAY85
         B     ISPPAR90                                        SS MAY85
ISPPAREK MVI   SPFPRRC,24   INVALID KEY                        SS MAY85
         MVC   SPFMSGID,ISPPDSM SETUP MESSAGE                  SS MAY85
         MVI   SPFMSGID+7,C'A'                                 SS MAY85
         MVI   SPFMSGID+6,C'6'                                 SS MAY85
         B     ISPPAR90                                        SS MAY85
ISPPAREP MVI   SPFPRRC,32   INVALID PARSE LIST                 SS MAY85
         DC    H'0'         TEST .. FORCE  0C1                 SS MAY85
         B     ISPPAR90                                        SS MAY85
ISPPAR90 DS    0H                                              SS MAR85
         SR    R15,R15                                         SS MAR85
         IC    R15,SPFPRRC                                     SS MAR85
         BR    R3                                              SS MAR85
         DROP  R4                                              SS MAR85
         SPACE 2                                               SS MAR85
*                                                              SS JUL84
*  SUPPORT ROUTE TO VDEFINE AND COPY DATA SET INFO             SS JUL84
*    RETURN REG IS R3                                          SS JUL84
*                                                              SS JUL84
ISPSETVS DS    0H                                              SS SEP84
         USING *,R4                                            SS MAR85
         TM    SPFLAG3,SPFSELV    VDEFINES DONE YES            SS SEP84
         BO    ISPSETV2           YES SKIP                     SS SEP84
         LA    R1,SPFPSTK                                      SS NOV84
         ST    R1,SPFPANT                                      SS NOV84
         ST    R1,SPFPANC                                      SS NOV84
         LA    R1,SPFPSTKB                                     SS NOV84
         ST    R1,SPFPANB                                      SS NOV84
         LA    R14,VSPFDSN                                     SS SEP84
         LA    R15,SPFDSNAM       DSN MADE AVAILABLE TO PANEL  SS SEP84
         LA    R1,ISPL44                                       SS SEP84
         BAL   R2,ISPVDEF                                      SS SEP84
         LA    R14,VSPFPWD                                     SS SEP84
         LA    R15,SPFPWD         PWD MADE AVAILABLE TO PANEL  SS SEP84
         LA    R1,ISPL8                                        SS SEP84
         BAL   R2,ISPVDEF                                      SS SEP84
         LA    R14,VSPFVOL                                     SS SEP84
         LA    R15,SPFVOL         VOL MADE AVAILABLE TO PANEL  SS SEP84
         LA    R1,ISPL6                                        SS SEP84
         BAL   R2,ISPVDEF                                      SS SEP84
         LA    R14,VSPFMEM                                     SS SEP84
         LA    R15,SPFMEMB        MEM MADE AVAILABLE TO PANEL  SS SEP84
         LA    R1,ISPL8                                        SS SEP84
         BAL   R2,ISPVDEF                                      SS SEP84
         LA    R14,VSPFDATA                                    SS NOV84
         LA    R15,MEMLNMSV       DATA MADE AVALIABLE TO PANEL SS NOV84
         LA    R1,ISPL8                                        SS NOV84
         BAL   R2,ISPVDEF                                      SS NOV84
         LA    R14,VSPFDSG                                     SS SEP84
         LA    R15,SPFDSORG       DSORG    AVAILABLE TO PANEL  SS SEP84
         LA    R1,ISPL2                                        SS SEP84
         BAL   R2,ISPVDEF                                      SS SEP84
         LA    R14,VSPFTYPE                                    SS SEP84
         LA    R15,SPFTYPE        TYPE     AVAILABLE TO PANEL  SS SEP84
         LA    R1,ISPL1                                        SS SEP84
         BAL   R2,ISPVDEF                                      SS SEP84
         LA    R14,VSPFZSEL                                    SS SEP84
         LA    R15,SPFZSEL        ZSEL     AVAILABLE TO PANEL  SS SEP84
         LA    R1,ISPL250                                      SS SEP84
         BAL   R2,ISPVDEF                                      SS SEP84
         OI    SPFLAG3,SPFSELV    VDEFINES DONE YES            SS SEP84
ISPSETV2 DS    0H                                              SS SEP84
         MVC   SPFDSNAM,DSNAME                                 SS SEP84
         MVC   SPFPWD,PASSWORD                                 SS SEP84
         MVC   SPFVOL,VOLUME                                   SS SEP84
*              SPFMEMB SET BY CALLER                           SS NOV84
*              MEMLNMSV SET BY CALLER                          SS NOV84
         MVC   SPFDSORG,ISPPS          ASSUME DSORG=PS         SS SEP84
         MVI   SPFTYPE,C' '            TYPE BLANK              SS NOV84
         TM    DSORG,DS1DSGPO          IS IT PO                SS SEP84
         BZ    ISPSETV4                NO                      SS NOV84
         MVC   SPFDSORG,ISPPO          YES, SET TO PO          SS SEP84
ISPSETV3 DS    0H                                              SS SEP84
         TM    FLAGSCC,RECFMU              IS IT LOAD          SS SEP84
         BZ    ISPSETV4                    NO                  SS SEP84
         MVI   SPFTYPE,C'U'                YES, SET U          SS SEP84
ISPSETV4 DS    0H                                              SS SEP84
         MVI   SPFZSEL,C' '            CLEAR ZSEL              SS SEP84
         MVC   SPFZSEL+1(249),SPFZSEL        RIPPLE            SS SEP84
         BR    R3                                              SS SEP84
         DROP  R4                                              SS MAR85
         SPACE 2                                               SS SEP84
* INITIALIZE THE DIALOG VARIABLES                              SS JUL84
ISPVINIT DS    0H                                              SS MAR85
         USING *,R4                                            SS MAR85
         MVI   SPFINPUT,C' '           BLANK IF NOT USED YET   SS NOV84
         MVC   SPFINPUT+1(48),SPFINPUT                         SS NOV84
         MVC   SPFZSAV(13),ISPENDIT  DEFAULT                   SS NOV84
         CLI   SPFLAG1,SPFCLEAN    OPT CLEANUP                 SS JUL84
         BE    ISPEXIT             YES, NOTHING TO CLEANUP     SS JUL84
         LA    R14,VDEFINE         START VDEFINES              SS JUL84
         ST    R14,PARMLIST                                    SS JUL84
         LA    R14,VSPFVFIX        ALL FIXED DIALOG VERBS      SS SEP84
         LA    R15,SPFFIXED                                    SS JUL84
         LA    R0,ISPFIX                                       SS JUL84
         LA    R1,ISPL4                                        SS JUL84
         STM   R14,R1,PARMLIST+4                               SS JUL84
         OI    PARMLIST+16,X'80'                               SS JUL84
         LA    R1,PARMLIST                                     SS JUL84
         L     R15,ISPLINK                                     SS JUL84
         BALR  R14,R15                                         SS JUL84
         LTR   R15,R15                                         SS JUL84
         BNZ   ISPERR                                          SS JUL84
         LA    R14,VZCMD           ZCMD INPUT LINE             SS JUL84
         LA    R15,SPFVZCMD                                    SS JUL84
         LA    R1,ISPL250                                      SS JUL84
         BAL   R2,ISPVDEF                                      SS SEP84
         LA    R14,VSPFLIN                                     SS JUL84
         LA    R15,SPFLINE        TABLE LINE                   SS JUL84
         LA    R1,ISPL79                                       SS JUL84
         BAL   R2,ISPVDEF                                      SS SEP84
         LA    R14,VSPFMSG1                                   ABL JUL85
         LA    R15,SPFMLIN1       SHORT MESSAGE HEADER        ABL JUN85
         LA    R1,ISPL8                                       ABL JUN85
         BAL   R2,ISPVDEF                                     ABL JUN85
         LA    R14,VSPFMSG2                                   ABL JUL85
         LA    R15,SPFMLIN2       LONG MESSAGE                ABL JUN85
         LA    R1,ISPL79                                      ABL JUN85
         BAL   R2,ISPVDEF                                     ABL JUN85
         LA    R14,VZVERB                                     ABL OCT84
         LA    R15,SPFRETRN       RETURN/END                  ABL OCT84
         L     R1,ISPL8            SET LENGTH                 ABL OCT84
         ST    R1,SPFFIXER            TO 8                    ABL OCT84
         LA    R1,SPFFIXER               USE AS PARM          ABL OCT84
         BAL   R2,ISPVDEF                                     ABL OCT84
         LA    R14,VSPFMSG                                     SS JUL84
         LA    R15,SPFDSNMG       DSN AND VOL FOR PANEL MSG    SS JUL84
         LA    R1,ISPLMSG                                      SS JUL84
         BAL   R2,ISPVDEF                                      SS SEP84
         LA    R14,VCOPY          GET THE TIME                 SS JUL84
         ST    R14,PARMLIST                                    SS JUL84
         LA    R14,VZTIME           GET TIME OF DATA           SS JUL84
         L     R15,ISPL8            SET LENGTH                 SS JUL84
         ST    R15,SPFFIXED            TO 8                    SS JUL84
         LA    R15,SPFFIXED               USE AS PARM          SS JUL84
         LA    R0,SPFTBL                                       SS JUL84
         LA    R1,ISPMOVE                                      SS JUL84
         STM   R14,R1,PARMLIST+4                               SS JUL84
         OI    PARMLIST+16,X'80'                               SS JUL84
         LA    R1,PARMLIST                                     SS JUL84
         L     R15,ISPLINK                                     SS JUL84
         BALR  R14,R15                                         SS JUL84
         LTR   R15,R15                                         SS JUL84
         BNZ   ISPERR                                          SS JUL84
         MVC   SPFTBL+5(2),SPFTBL+3 MINUTES PART OF TABLE NAME SS JUL84
         MVC   SPFTBL+3(2),SPFTBL   HOURS ALSO                 SS JUL84
         MVC   SPFTBL(3),ISPPDS     TABLE NAME STARTS PDS      SS JUL84
         MVI   SPFTBL+7,C'0'        FILL OUT TO 8 CHAR         SS JUL84
         LA     R15,0               ZERO COMPARES              SS AUG84
         CH     R15,SPFMAX          IS IT SET                  SS AUG84
         BNZ    *+10                YES                        SS AUG84
         MVC    SPFMAX,ISPMAX       NO, SET IT                 SS AUG84
         CH     R15,SPFCKSZ         IS IT SET                  SS AUG84
         BNZ    *+10                YES                        SS AUG84
         MVC    SPFCKSZ,ISPCKPT     NO, SET IT                 SS AUG84
         CH     R15,SPFSIZE         IS IT SET                  SS AUG84
         BNZ    *+10                YES                        SS AUG84
         MVC    SPFSIZE,ISPSIZE     NO, SET IT                 SS AUG84
         BAL   R2,ISPCREAT        CREATE TABLE                 SS JUL84
         MVC   SPFPANEL,ISPPANAL                               SS SEP84
         LA    R14,VCOPY          GET THE TIME                 SS MAR85
         ST    R14,PARMLIST                                    SS MAR85
         LA    R14,VZENVIR          GET TIME OF DATA           SS MAR85
         L     R15,ISPL32           SET LENGTH                 SS MAR85
         ST    R15,SPFFIXED            TO 8                    SS MAR85
         LA    R15,SPFFIXED               USE AS PARM          SS MAR85
         LA    R0,SPFZENVI                                     SS MAR85
         LA    R1,ISPMOVE                                      SS MAR85
         STM   R14,R1,PARMLIST+4                               SS MAR85
         OI    PARMLIST+16,X'80'                               SS MAR85
         LA    R1,PARMLIST                                     SS MAR85
         L     R15,ISPLINK                                     SS MAR85
         BALR  R14,R15                                         SS MAR85
         C     R15,ISPL8            RC=8 -- FROM ISPFV1?      ABL APR85
         BER   R3                   YES, RETURN               ABL APR85
         LTR   R15,R15                                         SS MAR85
         BNZ   ISPERR                                          SS MAR85
         BR    R3                                              SS MAR85
         DROP  R4                                              SS MAR85
         SPACE 2                                               SS MAY85
*  RECALL FROM LOG                                             SS MAY85
ISPRLOG  DS    0H                                              SS MAY85
         USING ISPRLOG,R4                                      SS MAY85
ISPRLG10 DS    0H                  PROCESS RECALL FROM LOG     SS MAY85
         TM    SPFPRBI,X'40'       NUMBER SUPPLIED             SS MAY85
         BZ    ISPRLG12            NO                          SS JUN85
         L     R15,SPFPRNU         GET NUMBER                  SS JUN85
         LTR   R15,R15             CHECK VALUE                 SS JUN85
         BZ    ISPRLG12            ZERO, SET DEFAULT           SS JUN85
         BP    ISPRLG15            POSITIVE, OK                SS JUN85
         LPR   R15,R15             MAKE POSITIVE               SS JUN85
         OI    SPFPRBI,X'05'       PREVIOUS CODE               SS JUN85
         ST    R15,SPFPRNU         SAVE                        SS JUN85
         B     ISPRLG15                                        SS JUN85
ISPRLG12 DS    0H                                              SS JUN85
         LA    R15,1               DEFAULT TO 1                SS MAY85
         ST    R15,SPFPRNU                                     SS MAY85
ISPRLG15 DS    0H                                              SS MAY85
         TM    SPFPRBI,X'08'       FIRST KEY WORD              SS MAY85
         BZ    ISPRLG30            NO, THEN USE CURRENT        SS MAY85
         TM    SPFPRBI,X'06'       LAST/PREV/-N KEYWORD?       SS JUN85
         BNZ   ISPRLGEC            YES, CONFLICT WITH FIRST    SS JUN85
         BAL   R2,ISPTOP           YES, START AT TOP           SS MAY85
         B     ISPRLG45                                        SS MAY85
ISPRLG30 DS    0H                                              SS MAY85
         TM    SPFPRBI,X'02'       LAST KEYWORD?               SS JUN85
         BZ    ISPRLG35            NO, THEN USE CURRENT        SS JUN85
         BAL   R2,ISPBOTM          YES, START AT BOTTOM        SS JUN85
         B     ISPRLG45                                        SS JUN85
ISPRLG35 DS    0H                                              SS JUN85
         L     R15,SPFSTART        START SEARCH HERE           SS MAY85
         S     R15,SPFLAST         RELATIVE POSITION           SS MAY85
         BAL   R2,ISPSKIP          POSITION SUBR               SS MAY85
         TM    SPFPRBI,X'04'       PREVIOUS?                   SS JUN85
         BO    ISPRLG47            BACK UP ONE                 SS JUN85
         B     ISPRLG45            START SEARCH                SS MAY85
ISPRLG40 DS    0H                                              SS MAY85
         ST    R15,SPFPRNU         SAVE NUMBER FOR NEXT TIME   SS MAY85
         B     ISPRLG47                                        SS MAY85
ISPRLG45 DS    0H                                              SS MAY85
         CLI   SPFLINE,C'>'        COMMAND FLAG                SS MAY85
         BE    ISPRLG50            GOT IT                      SS MAY85
ISPRLG47 DS    0H                                              SS MAY85
         LA    R15,1               SKIP ONE                    SS MAY85
         TM    SPFPRBI,X'04'       PREVIOUS KEYWORD?           SS JUN85
         BZ    ISPRLG48                                        SS JUN85
         LNR   R15,R15             YES, SKIP -1                SS JUN85
ISPRLG48 DS    0H                                              SS JUN85
         BAL   R2,ISPSKIP                                      SS MAY85
         LTR   R15,R15                                         SS MAY85
         BNZ   ISPRLGEN            RAN OFF END                 SS JUN85
         B     ISPRLG45                                        SS MAY85
ISPRLG50 DS    0H                                              SS MAY85
         L     R15,SPFPRNU         COUNT THEM                  SS MAY85
         BCT   R15,ISPRLG40        NOT THIS ONE                SS MAY85
         MVI   SPFVZCMD,C' '       BLANK ZCMD                  SS MAY85
         MVC   SPFVZCMD+1(249),SPFVZCMD  RIPPLE                SS MAY85
         LA    R1,SPFVZCMD         START OF BUFFER TEXT        SS MAY85
         ST    R1,SPFPRNU          SAVE FOR NEXT               SS MAY85
ISPRLG60 DS    0H                                              SS MAY85
         MVC   0(78,R1),SPFLINE+1  MOVE COMMAND TEXT           SS MAY85
         LA    R15,1               CHECK NEXT LINE             SS MAY85
         BAL   R2,ISPSKIP                                      SS MAY85
         LTR   R15,R15                                         SS MAY85
         BNZ   ISPRLG90            NOT MORE IN TABLE           SS MAY85
         CLI   SPFLINE,C'-'        COMMAND CONTINUATION        SS MAY85
         BNE   ISPRLG90            NO, DONE                    SS MAY85
         L     R1,SPFPRNU          LAST TEXT POSITION          SS MAY85
         LA    R1,78(,R1)          POSITION TEXT 78 CHAR       SS MAY85
         ST    R1,SPFPRNU          LAST TEXT POSITION         ABL JUN85
         B     ISPRLG60            PROCESS IT                  SS MAY85
ISPRLGEC DS    0H                                              SS JUN85
         BAL   R2,ISPBOTM          RESET RECORD POINTER        SS JUN85
         MVC   SPFMSGID,ISPPDSM    INIT                        SS JUN85
         MVI   SPFMSGID+7,C'A'      CONFLICT                   SS JUN85
         MVI   SPFMSGID+6,C'7'             MESSAGE             SS JUN85
         B     ISPRLGE2                                        SS JUN85
ISPRLGEN DS    0H                                              SS MAY85
         BAL   R2,ISPBOTM          RESET RECORD POINTER        SS MAY85
         MVC   SPFMSGID,ISPPDSM    INIT                        SS MAY85
         MVI   SPFMSGID+7,C'F'      BOTTOM                     SS MAY85
         MVI   SPFMSGID+6,C'2'             MESSAGE             SS MAY85
         TM    SPFPRBI,X'04'       PREVIOUS?                   SS JUN85
         BZ    ISPRLGE2                                        SS JUN85
         MVI   SPFMSGID+6,C'3'     TOP                         SS JUN85
ISPRLGE2 DS    0H                                              SS JUN85
         LA    R15,8               NO COMMANDS FOUND           SS MAY85
         BR    R3                                              SS MAY85
ISPRLG90 DS    0H                                              SS MAY85
         BAL   R2,ISPBOTM          RESET RECORD POINTER        SS MAY85
         SR    R15,R15             GOOD COMMAND                SS MAY85
         BR    R3                                              SS MAY85
         DROP  R4                                              SS MAR85
         SPACE 2                                               SS MAY85
*  FIND IN LOG                                                 SS MAY85
ISPFLOG  DS    0H                                              SS MAY85
         USING ISPFLOG,R4                                      SS MAY85
         CLI   SPFPRRC,8           NO STRING                   SS MAY85
         BE    ISPFLG05                                        SS MAY85
         TM    SPFPRBI,X'03'       PREFIX OR SUFFIX            SS MAY85
         BO    ISPFLGEC            BOTH.. ERROR                SS MAY85
         TM    SPFPRBI,X'05'       WORD OR SUFFIX              SS MAY85
         BO    ISPFLGEC            BOTH.. ERROR                SS MAY85
         TM    SPFPRBI,X'06'       WORD OR PREFIX              SS MAY85
         BO    ISPFLGEC            BOTH.. ERROR                SS MAY85
         MVC   SPFFDBI(4),SPFPRBI  COPY BITS AND LEN           SS MAY85
         NI    SPFFDBI2,255-X'02'  CLEAR AT TOP/BOTTOM         SS MAY85
         OI    SPFFDBI2,X'01'      HAVE STRING                 SS MAY85
         MVC   SPFFDNU,SPFPRNU     COPY POSITION IF THERE      SS MAY85
         LH    R1,SPFFDLN                                      SS MAY85
         L     R15,SPFPRSR                                     SS MAY85
         EX    R1,ISPFLGMV         EXECUTE MVC CHAR            SS MAY85
         TM    SPFFDBI,X'80'       ASIS                        SS MAY85
         BO    ISPFLG02            DO NOT FORCE UPPER CASE     SS MAY85
         MVI   SPFINPUT,C' '       SETUP BLANK LINE            SS MAY85
         MVC   SPFINPUT+1(78),SPFINPUT  RIPPLE                 SS MAY85
         LH    R1,SPFFDLN                                      SS MAY85
         EX    R1,ISPFLGOC         EXECUTE OR CHAR             SS MAY85
ISPFLG02 DS    0H                                              SS MAY85
         MVC   SPFFDTOP,SPFSTART   SAVE START                  SS MAY85
         TM    SPFFDBI,X'10'       BACKWARD SEARCH             SS MAY85
         BO    ISPFLG60                                        SS MAY85
         CLC   SPFFDTOP,ISPL1      AT TOP                      SS MAY85
         BNE   ISPFLG10                                        SS MAY85
         OI    SPFFDBI2,X'02'      FROM TOP                    SS MAY85
         B     ISPFLG10                                        SS MAY85
ISPFLGMV MVC   SPFFDSAV(0),0(R15)  SAVE COMPARE STRING         SS MAY85
ISPFLG05 DS    0H                                              SS MAY85
         CLI   SPFFDSAV,0          ANY STRING                  SS MAY85
         BE    ISPFLGEM            CANNOT DO REPEAT FIND       SS MAY85
         TM    SPFFDBI2,X'01'      HAVE STRING                 SS MAY85
         BZ    ISPFLGEM            NO, NO REPEAT FIND          SS MAY85
         TM    SPFFDBI,X'10'       BACKWARD SEARCH             SS MAY85
         BO    ISPFLG50            START HERE                  SS MAY85
         CLC   SPFSTART,SPFFDTOP   STILL SAME PLACE            SS MAY85
         BNE   ISPFLG07                                        SS MAY85
         MVI   SPFINPUT,C' '       SETUP BLANK LINE            SS MAY85
         MVC   SPFINPUT+1(78),SPFINPUT  RIPPLE                 SS MAY85
         TM    SPFFDBI,X'20'       FIRST KEY WORD              SS MAY85
         BO    ISPFLG15            NO, THEN USE CURRENT        SS MAY85
         L     R15,SPFSTART        SET NEW PLACE               SS MAY85
         LA    R15,1(,R15)                                     SS MAY85
         C     R15,SPFLAST         BOTTOM                      SS MAY85
         BH    ISPFLGEN            RAN OFF BOTTOM              SS MAY85
         ST    R15,SPFSTART                                    SS MAY85
         B     ISPFLG30                                        SS MAY85
ISPFLG07 DS    0H                                              SS MAY85
         NI    SPFFDBI,255-X'20'   RESET FIRST                 SS MAY85
ISPFLG10 DS    0H                  PROCESS FIND                SS MAY85
         MVI   SPFINPUT,C' '       SETUP BLANK LINE            SS MAY85
         MVC   SPFINPUT+1(78),SPFINPUT  RIPPLE                 SS MAY85
         TM    SPFFDBI,X'20'       FIRST KEY WORD              SS MAY85
         BZ    ISPFLG30            NO, THEN USE CURRENT        SS MAY85
ISPFLG15 DS    0H                  GO TO TOP                   SS MAY85
         NI    SPFFDBI,255-X'20'   RESET FIRST                 SS MAY85
         OI    SPFFDBI2,X'02'      FROM TOP                    SS MAY85
         BAL   R2,ISPTOP           START AT TOP                SS MAY85
         LA    R15,1                                           SS MAY85
         ST    R15,SPFSTART        NOW AT TOP                  SS MAY85
         BAL   R2,ISPSKIP                                      SS MAY85
         LTR   R15,R15                                         SS MAY85
         BNZ   ISPFLGEN            RAN OFF BOTTOM              SS MAY85
         B     ISPFLG40                                        SS MAY85
ISPFLG30 DS    0H                                              SS MAY85
         L     R15,SPFSTART        START SEARCH HERE           SS MAY85
         S     R15,SPFLAST         RELATIVE POSITION           SS MAY85
         BAL   R2,ISPSKIP          POSITION SUBR               SS MAY85
ISPFLG40 DS    0H                                              SS MAY85
         TM    SPFFDBI,X'80'       ASIS                        SS MAY85
         BO    ISPFLG42            DO NOT FORCE UPPER CASE     SS MAY85
         OC    SPFLINE(79),SPFINPUT FORCE ALL UPPER CASE       SS MAY85
ISPFLG42 DS    0H                                              SS MAY85
         TM    SPFFDBI,X'40'       POSITION NUMBER             SS MAY85
         BZ    ISPFLG45            NO, FIND IN LINE            SS MAY85
         LA    R15,SPFLINE-1       RELATIVE TO ZERO            SS MAY85
         A     R15,SPFFDNU         POSITION                    SS MAY85
         B     ISPFLG47            DO COMPARE HERE             SS MAY85
ISPFLG45 DS    0H                                              SS MAY85
         LA    R15,SPFLINE                                     SS MAY85
         LA    R14,79              END OF LINE                 SS MAY85
         SH    R14,SPFFDLN         ALLOW FOR LENG OF STRING    SS MAY85
ISPFLG46 DS    0H                                              SS MAY85
         SR    R1,R1               FOR IC                      SS MAY85
         IC    R1,SPFFDSAV         FIRST CHAR                  SS MAY85
         BAL   R2,ISPCLI           FIND MATCH                  SS MAY85
         LTR   R15,R15             ANY                         SS MAY85
         BZ    ISPFLG49                                        SS MAY85
ISPFLG47 DS    0H                                              SS MAY85
         LH    R1,SPFFDLN                                      SS MAY85
         EX    R1,ISPFLGCL                                     SS MAY85
         BE    ISPFLG80                                        SS MAY85
ISPFLG48 DS    0H                                              SS MAY85
         TM    SPFFDBI,X'40'       POSITION NUMBER             SS MAY85
         BO    ISPFLG49            YES TRY NEXT LINE           SS MAY85
         LA    R15,1(,R15)         CONTINUE NEXT CHAR          SS MAY85
         BCT   R14,ISPFLG46        IF MORE CHAR                SS MAY85
ISPFLG49 DS    0H                                              SS MAY85
         LA    R15,1               SKIP ONE                    SS MAY85
         BAL   R2,ISPSKIP                                      SS MAY85
         LTR   R15,R15                                         SS MAY85
         BNZ   ISPFLGEN            RAN OFF BOTTOM              SS MAY85
         L     R15,SPFSTART        KEEP                        SS MAY85
         LA    R15,1(,R15)              POINTER                SS MAY85
         ST    R15,SPFSTART                     UP TO DATE     SS MAY85
         B     ISPFLG40                                        SS MAY85
ISPFLGEN DS    0H                                              SS MAY85
         MVC   SPFMSGID,ISPPDSM    INIT MESSAGE                SS MAY85
         MVI   SPFMSGID+7,C'F'                                 SS MAY85
         TM    SPFFDBI2,X'02'      WE START AT TOP             SS MAY85
         BZ    ISPFLGE2                                        SS MAY85
         MVI   SPFFDBI2,0          FORCE NEW FIND              SS MAY85
         MVI   SPFMSGID+6,C'1'                                 SS MAY85
         B     ISPFLGE4                                        SS MAY85
ISPFLGE2 DS    0H                                              SS MAY85
         MVI   SPFMSGID+6,C'2'                                 SS MAY85
         OI    SPFFDBI,X'20'       FORCE FIRST NEXT TIME       SS MAY85
ISPFLGE4 DS    0H                                              SS MAY85
         BAL   R2,ISPBOTM          RESET RECORD POINTER        SS MAY85
         MVC   SPFSTART,SPFFDTOP   RESET START                 SS MAY85
         MVI   SPFVZCMD,C' '       BLANK                       SS MAY85
         MVC   SPFVZCMD+1(249),SPFVZCMD                        SS MAY85
         LA    R15,8               NO COMMANDS FOUND           SS MAY85
         BR    R3                                              SS MAY85
ISPFLGOC OC    SPFFDSAV,SPFINPUT   FORCE UPPER CASE            SS MAY85
ISPFLGCL CLC   0(0,R15),SPFFDSAV   COMPARE TEXT                SS MAY85
ISPFLG50 DS    0H                  REPEAT FIND PREV            SS MAY85
         MVI   SPFINPUT,C' '       SETUP BLANK LINE            SS MAY85
         MVC   SPFINPUT+1(78),SPFINPUT  RIPPLE                 SS MAY85
         CLC   SPFSTART,SPFFDTOP   STILL SAME PLACE            SS MAY85
         BNE   ISPFLG57                                        SS MAY85
         TM    SPFFDBI,X'08'       LAST  KEY WORD              SS MAY85
         BO    ISPFLG65            YES, SET                    SS MAY85
         B     ISPFLG69                                        SS MAY85
ISPFLG57 DS    0H                                              SS MAY85
         NI    SPFFDBI,255-X'08'   RESET LAST                  SS MAY85
         B     ISPFLG69                                        SS MAY85
ISPFLG60 DS    0H                  PROCESS FIND PREV/LAST      SS MAY85
         TM    SPFFDBI,X'20'       FIRST KEYWORD               SS MAY85
         BO    ISPFLGEC            CONFLICT WITH PREV/LAST     SS MAY85
         MVI   SPFINPUT,C' '       SETUP BLANK LINE            SS MAY85
         MVC   SPFINPUT+1(78),SPFINPUT  RIPPLE                 SS MAY85
         TM    SPFFDBI,X'08'       LAST  KEY WORD              SS MAY85
         BZ    ISPFLG69            NO, THEN USE CURRENT        SS MAY85
ISPFLG65 DS    0H                  GO TO TOP                   SS MAY85
         NI    SPFFDBI,255-X'08'   RESET LAST                  SS MAY85
         OI    SPFFDBI2,X'02'      FROM BOTTOM                 SS MAY85
         BAL   R2,ISPBOTM          START AT BOTTOM             SS MAY85
         LTR   R15,R15                                         SS MAY85
         BNZ   ISPFLGET            RAN OFF BOTTOM              SS MAY85
         L     R15,SPFLAST                                     SS MAY85
         ST    R15,SPFSTART        NOW AT BOTTOM               SS MAY85
         B     ISPFLG70                                        SS MAY85
ISPFLG69 DS    0H                                              SS MAY85
         L     R15,SPFSTART        START SEARCH HERE           SS MAY85
         S     R15,SPFLAST         RELATIVE POSITION           SS MAY85
         BAL   R2,ISPSKIP          POSITION SUBR               SS MAY85
         B     ISPFLG79            BACK UP ONE                 SS MAY85
ISPFLG70 DS    0H                                              SS MAY85
         TM    SPFFDBI,X'80'       ASIS                        SS MAY85
         BO    ISPFLG72            DO NOT FORCE UPPER CASE     SS MAY85
         OC    SPFLINE(79),SPFINPUT FORCE ALL UPPER CASE       SS MAY85
ISPFLG72 DS    0H                                              SS MAY85
         TM    SPFFDBI,X'40'       POSITION NUMBER             SS MAY85
         BZ    ISPFLG75            NO, FIND IN LINE            SS MAY85
         LA    R15,SPFLINE-1       RELATIVE TO ZERO            SS MAY85
         A     R15,SPFFDNU         POSITION                    SS MAY85
         B     ISPFLG77            DO COMPARE HERE             SS MAY85
ISPFLG75 DS    0H                                              SS MAY85
         LA    R15,SPFLINE-1                                   SS MAY85
         LA    R14,79              END OF LINE                 SS MAY85
         SH    R14,SPFFDLN         ALLOW FOR LENG OF STRING    SS MAY85
         ALR   R15,R14             POSITION TO END OF STRING   SS MAY85
ISPFLG76 DS    0H                                              SS MAY85
         SR    R1,R1               FOR IC                      SS MAY85
         IC    R1,SPFFDSAV         FIRST CHAR                  SS MAY85
         BAL   R2,ISPCLIB          FIND MATCH                  SS MAY85
         LTR   R15,R15             ANY                         SS MAY85
         BZ    ISPFLG79                                        SS MAY85
ISPFLG77 DS    0H                                              SS MAY85
         LH    R1,SPFFDLN                                      SS MAY85
         EX    R1,ISPFLGCL                                     SS MAY85
         BE    ISPFLG80                                        SS MAY85
ISPFLG78 DS    0H                                              SS MAY85
         TM    SPFFDBI,X'40'       POSITION NUMBER             SS MAY85
         BO    ISPFLG79            YES TRY NEXT LINE           SS MAY85
         BCTR  R15,0               CONTINUE NEXT CHAR          SS MAY85
         BCT   R14,ISPFLG76        IF MORE CHAR                SS MAY85
ISPFLG79 DS    0H                                              SS MAY85
         LA    R15,1               SKIP                        SS MAY85
         LNR   R15,R15                  -1                     SS MAY85
         BAL   R2,ISPSKIP                                      SS MAY85
         LTR   R15,R15                                         SS MAY85
         BNZ   ISPFLGET            RAN OFF TOP                 SS MAY85
         L     R15,SPFSTART        KEEP                        SS MAY85
         BCTR  R15,0                    POINTER                SS MAY85
         ST    R15,SPFSTART                     UP TO DATE     SS MAY85
         B     ISPFLG70                                        SS MAY85
ISPFLGET DS    0H                                              SS MAY85
         MVC   SPFMSGID,ISPPDSM    INIT MESSAGE                SS MAY85
         MVI   SPFMSGID+7,C'F'                                 SS MAY85
         TM    SPFFDBI2,X'02'      WE START AT BOTTOM          SS MAY85
         BZ    ISPFLGE6                                        SS MAY85
         NI    SPFFDBI2,255-X'03'  FORCE NEW FIND              SS MAY85
         MVI   SPFMSGID+6,C'1'                                 SS MAY85
         B     ISPFLGE8                                        SS MAY85
ISPFLGE6 DS    0H                                              SS MAY85
         MVI   SPFMSGID+6,C'3'                                 SS MAY85
         OI    SPFFDBI,X'08'       FORCE LAST NEXT TIME        SS MAY85
ISPFLGE8 DS    0H                                              SS MAY85
         BAL   R2,ISPBOTM          RESET RECORD POINTER        SS MAY85
         MVC   SPFSTART,SPFFDTOP   RESET START                 SS MAY85
         MVI   SPFVZCMD,C' '       BLANK                       SS MAY85
         MVC   SPFVZCMD+1(249),SPFVZCMD                        SS MAY85
         LA    R15,8               NO COMMANDS FOUND           SS MAY85
         BR    R3                                              SS MAY85
ISPFLGEM DS    0H                                              SS MAY85
         MVC   SPFMSGID,ISPPDSM    INIT MESSAGE                SS MAY85
         MVI   SPFMSGID+7,C'A'                                 SS MAY85
         MVI   SPFMSGID+6,C'2'                                 SS MAY85
         LA    R15,8                                           SS MAY85
         BR    R3                                              SS MAY85
ISPFLGEC DS    0H                                              SS MAY85
         MVC   SPFMSGID,ISPPDSM    INIT MESSAGE                SS MAY85
         MVI   SPFMSGID+7,C'A'                                 SS MAY85
         MVI   SPFMSGID+6,C'7'                                 SS MAY85
         LA    R15,8                                           SS MAY85
         BR    R3                                              SS MAY85
ISPFLG80 DS    0H                                              SS MAY85
         TM    SPFFDBI,X'07'  4+2+1 WORD, PREFIX, SUFFIX       SS MAY85
         BZ    ISPFLG89             NONE, THIS IS A MATCH      SS MAY85
         LR    R2,R15               BACK                       SS MAY85
         BCTR  R2,0                      UP ONE                SS MAY85
         CLI   0(R2),C'$'           NATIONAL CHAR              SS MAY85
         BE    ISPFLG82             YES                        SS MAY85
         CLI   0(R2),C'@'           NATIONAL CHAR              SS MAY85
         BE    ISPFLG82             YES                        SS MAY85
         CLI   0(R2),C'#'           NATIONAL CHAR              SS MAY85
         BE    ISPFLG82             YES                        SS MAY85
         CLI   0(R2),X'81'          LOWER CASE A               SS MAY85
         BNL   ISPFLG82             NORMAL CHAR                SS MAY85
*  MUST BE SPECIAL CHAR                                        SS MAY85
         TM    SPFFDBI,X'06'        WORD OR PREFIX             SS MAY85
         BZ    ISPFLG88             SUFFIX,  NO MATCH          SS MAY85
         B     ISPFLG84             NEXT TEST                  SS MAY85
ISPFLG82 DS    0H                                              SS MAY85
         TM    SPFFDBI,X'06'        WORD OR PREFIX             SS MAY85
         BNZ   ISPFLG88             NO MATCH                   SS MAY85
ISPFLG84 DS    0H                   NO MATCH                   SS MAY85
         LA    R2,1(,R15)           SKIP                       SS MAY85
         AH    R2,SPFFDLN                OVER STRING           SS MAY85
         CLI   0(R2),C'$'           NATIONAL CHAR              SS MAY85
         BE    ISPFLG85             YES                        SS MAY85
         CLI   0(R2),C'@'           NATIONAL CHAR              SS MAY85
         BE    ISPFLG85             YES                        SS MAY85
         CLI   0(R2),C'#'           NATIONAL CHAR              SS MAY85
         BE    ISPFLG85             YES                        SS MAY85
         CLI   0(R2),X'81'          LOWER CASE A               SS MAY85
         BNL   ISPFLG85             NORMAL CHAR                SS MAY85
*  MUST BE SPECIAL CHAR                                        SS MAY85
         TM    SPFFDBI,X'05'        WORD OR SUFFIX             SS MAY85
         BZ    ISPFLG88             PREFIX,  NO MATCH          SS MAY85
         B     ISPFLG89             GOOD MATCH                 SS MAY85
ISPFLG85 DS    0H                                              SS MAY85
         TM    SPFFDBI,X'05'        WORD OR SUFFIX             SS MAY85
         BZ    ISPFLG89             PREFIX, GOOD MATCH         SS MAY85
ISPFLG88 DS    0H                   NO MATCH                   SS MAY85
         TM    SPFFDBI,X'10'        BACKWARD SEARCH            SS MAY85
         BO    ISPFLG78             CONTINUE HERE              SS MAY85
         B     ISPFLG48             ELSE CONTINUE HERE         SS MAY85
ISPFLG89 DS    0H                                              SS MAY85
         NI    SPFFDBI2,255-X'02'  NO LONGER AT TOP/BOTTOM     SS MAY85
ISPFLG90 DS    0H                                              SS MAY85
         MVC   SPFFDTOP,SPFSTART   SAVE FOUND LOCATION         SS MAY85
         BAL   R2,ISPBOTM          RESET RECORD POINTER        SS MAY85
         SR    R15,R15             GOOD COMMAND                SS MAY85
         BR    R3                                              SS MAY85
         SPACE 2                                              ABL JUN85
***  EXTRACT THE CURRENT ISPMODE/MEMLIST TABLE                ABL JUN85
ISPDISPT DS    0H                                             ABL JUN85
         USING *,R4
         MVC   SPFMSGID(8),ISPBLK8   TURN OFF MESSAGES
         MVC   SPFCURSR(8),ISPBLK8   TURN OFF CURSOR NAME
         NI    HFLAGSDD,FF-X'02'     NO OPEN YET
ISPD020  OI    ##ADRPA#,$A+$D        IGNORE ATTENTION NOW
         NI    HFLAGSDD,FF-X'01'     NO ATTRIBUTES
         LA    R14,ISPDISP           DISPLAY TABLE
         LA    R15,ISPDEXN           PANEL NAME
         LA    R0,0                  NO MSG
         CLC   SPFMSGID(4),ISPPDSM   ANY MSG
         BNE   ISPD030
         LA    R0,SPFMSGID
         CLC   SPFPANPR(4),0(R15)    SAME PANEL AS LAST TIME?
         BNE   ISPD030               NO, BRANCH
         SR    R15,R15               YES, NULLIFY PANEL NAME
ISPD030  MVC   SPFPANPR(8),ISPDEXN   SAVE LAST PANEL NAME
         LA    R1,SPFCURSR           DEFAULT CURSOR POSITIONING
         STM   R14,R1,PARMLIST
         OI    PARMLIST+12,X'80'
         LA    R1,PARMLIST
         L     R15,ISPLINK
         BALR  R14,R15
         MVC   SPFMSGID(8),ISPBLK8   TURN OFF MESSAGES
         MVC   SPFCURSR(8),ISPBLK8   TURN OFF CURSOR NAME
         LTR   R15,R15               PF3/PF4 HIT?
         BNZ   ISPD900               YES, BRANCH
         SPACE 1
         MVC   SPFDDSN(8),ISPDTITL   VARIABLE NAME IS PTIT#
         MVC   SPFDDSN+4(1),SPFPANEL+5
         LA    R14,SPFDDSN           GET FIRST VARIABLE
         LA    R15,75                SET LENGTH
         LA    R0,SPFDTIT+5          SET OUTPUT VARIABLE NAME
         BAL   R2,ISPDVCOP           COPY INTO STORAGE
         SPACE 1
         MVC   SPFDTIT(5),ISPBLK8    BLANK THE "CMD" FIELD
         CLI   SPFPANEL+5,C'5'       MEMLIST PANEL?
         BL    *+10                  NO, BRANCH
         MVC   SPFDTIT(5),ISPDCMD    YES, ADD "CMD  "
         SPACE 1
         LA    R14,ISPDDSNL          GET FIRST VARIABLE
         LA    R15,44                SET LENGTH
         LA    R0,SPFDDSN            SET OUTPUT VARIABLE NAME
         BAL   R2,ISPDVCOP           COPY INTO STORAGE
         SPACE 1
         LA    R14,ISPDMEML          GET FIRST VARIABLE
         LA    R15,8                 SET LENGTH
         LA    R0,SPFDMEM            SET OUTPUT VARIABLE NAME
         BAL   R2,ISPDVCOP           COPY INTO STORAGE
         SPACE 1
         LA    R14,ISPDDESL          GET FIRST VARIABLE
         LA    R15,8                 SET LENGTH
         LA    R0,SPFDDEST           SET OUTPUT VARIABLE NAME
         BAL   R2,ISPDVCOP           COPY INTO STORAGE
         SPACE 1
         LA    R14,ISPDFORL          GET FIRST VARIABLE
         LA    R15,4                 SET LENGTH
         LA    R0,SPFDFORM           SET OUTPUT VARIABLE NAME
         BAL   R2,ISPDVCOP           COPY INTO STORAGE
         SPACE 1
         LA    R14,ISPDDISL          GET FIRST VARIABLE
         LA    R15,1                 SET LENGTH
         LA    R0,SPFDDISP           SET OUTPUT VARIABLE NAME
         BAL   R2,ISPDVCOP           COPY INTO STORAGE
         SPACE 1
         LA    R14,ISPDSYSL          GET FIRST VARIABLE
         LA    R15,1                 SET LENGTH
         LA    R0,SPFDSOUT           SET OUTPUT VARIABLE NAME
         BAL   R2,ISPDVCOP           COPY INTO STORAGE
         SPACE 3
         LA    R1,M99RBPTR              DYNAMIC ALLOCATION
         XC    M99RBPTR(40),M99RBPTR    CLEAR THE WORK AREA
         LA    R1,M99RBPTR              DYNAMIC ALLOCATION
         USING S99RBP,R1
         SPACE 1
         LA    R14,M99RB
         USING S99RB,R14
         ST    R14,S99RBPTR
         OI    S99RBPTR,S99RBPND        MARK END OF LIST
         SPACE 1
         LA    R15,M99TUPL
         USING S99TUPL,R15
         MVI   S99RBLN,20               LENGTH 20
         MVI   S99VERB,S99VRBAL         ALLOCATE
         ST    R15,S99TXTPP             POINT TO TEXT POINTERS
         LA    R2,WORKTBL                        START OF TEXT
         SPACE 1
         MVC   0(L'ISPDDDNA,R2),ISPDDDNA         SPECIFY DDNAME TEXT
         ST    R2,S99TUPTR                       POINT TO TEXT UNIT
         LA    R2,L'ISPDDDNA(,R2)                START OF NEXT TEXT
         SPACE 1
         LA    R15,4(,R15)                       NEXT POINTER ELEMENT
         MVC   0(L'ISPDDSOR,R2),ISPDDSOR         SPECIFY DSORG TEXT
         ST    R2,S99TUPTR                       POINT TO TEXT UNIT
         LA    R2,L'ISPDDSOR(,R2)                START OF NEXT TEXT
         SPACE 1
         LA    R15,4(,R15)                       NEXT POINTER ELEMENT
         MVC   0(L'ISPDFREE,R2),ISPDFREE         SPECIFY FREE TEXT
         ST    R2,S99TUPTR                       POINT TO TEXT UNIT
         LA    R2,L'ISPDFREE(,R2)                START OF NEXT TEXT
         SPACE 1
         MVC   SPFCURSR(8),ISPDSYSP              SYSOUT VARIABLE
         CLI   SPFDSOUT,X'40'                    DSNAME ALLOCATION?
         BH    ISPD080                           NO, BRANCH
         MVC   SPFCURSR(8),ISPDDSNP              DSNAME VARIABLE
         LA    R15,4(,R15)                       NEXT POINTER ELEMENT
         MVC   0(L'ISPDDSNA,R2),ISPDDSNA         SPECIFY DSNAME TEXT
         MVC   6(44,R2),SPFDDSN                  SPECIFY DSNAME
         ST    R2,S99TUPTR                       POINT TO TEXT UNIT
         LA    R2,L'ISPDDSNA+44(,R2)             START OF NEXT TEXT
         SPACE 1
         CLI   SPFDMEM,X'41'                     ANY MEMBER?
         BL    ISPD050                           NO, BRANCH
         LA    R15,4(,R15)                       NEXT POINTER ELEMENT
         MVC   0(L'ISPDMEMB,R2),ISPDMEMB         SPECIFY MEMBER TEXT
         MVC   6(8,R2),SPFDMEM                   SPECIFY MEMBER
         ST    R2,S99TUPTR                       POINT TO TEXT UNIT
         LA    R2,L'ISPDMEMB(,R2)                START OF NEXT TEXT
         SPACE 1
ISPD050  LA    R15,4(,R15)                       NEXT POINTER ELEMENT
         MVC   0(L'ISPDALLO,R2),ISPDALLO         SPECIFY DISP=OLD
         CLI   SPFDDISP,C'S'                     SHR?
         BNE   *+8                               NO, BRANCH
         MVI   6(R2),ISPDSHR                     SPECIFY DISPOSITION
         CLI   SPFDDISP,C'M'                     MOD?
         BNE   *+8                               NO, BRANCH
         MVI   6(R2),ISPDMOD                     SPECIFY DISPOSITION
         CLI   SPFDDISP,C'N'                     NEW?
         BNE   *+8                               NO, BRANCH
         MVI   6(R2),ISPDNEW                     SPECIFY DISPOSITION
         ST    R2,S99TUPTR                       POINT TO TEXT UNIT
         LA    R2,L'ISPDALLO(,R2)                START OF NEXT TEXT
         SPACE 1
         CLI   SPFDDISP,C'O'                     OLD?
         BE    ISPD070                           YES, BRANCH
         CLI   SPFDDISP,C'S'                     SHR?
         BE    ISPD070                           YES, BRANCH
         LA    R15,4(,R15)                       NEXT POINTER ELEMENT
         MVC   0(L'ISPDFIRS,R2),ISPDFIRS         SPECIFY PRIMARY
         ST    R2,S99TUPTR                       POINT TO TEXT UNIT
         LA    R2,L'ISPDFIRS(,R2)                START OF NEXT TEXT
         SPACE 1
         LA    R15,4(,R15)                       NEXT POINTER ELEMENT
         MVC   0(L'ISPDSECO,R2),ISPDSECO         SPECIFY SECONDARY
         ST    R2,S99TUPTR                       POINT TO TEXT UNIT
         LA    R2,L'ISPDSECO(,R2)                START OF NEXT TEXT
         SPACE 1
         LA    R15,4(,R15)                       NEXT POINTER ELEMENT
         MVC   0(L'ISPDTRK,R2),ISPDTRK           SPECIFY TRACK ALLOC
         ST    R2,S99TUPTR                       POINT TO TEXT UNIT
         LA    R2,L'ISPDTRK(,R2)                 START OF NEXT TEXT
         SPACE 1
         CLI   SPFDMEM,X'41'                     ANY MEMBER NAME?
         BL    ISPD070                           NO, BRANCH
         LA    R15,4(,R15)                       NEXT POINTER ELEMENT
         MVC   0(L'ISPDDIR,R2),ISPDDIR           SPECIFY DIRECTORY BLKS
         ST    R2,S99TUPTR                       POINT TO TEXT UNIT
         LA    R2,L'ISPDDIR(,R2)                 START OF NEXT TEXT
         SPACE 1
ISPD070  LA    R15,4(,R15)                       NEXT POINTER ELEMENT
         MVC   0(L'ISPDNORM,R2),ISPDNORM         SPECIFY DISP=(,CATLG)
         ST    R2,S99TUPTR                       POINT TO TEXT UNIT
         LA    R2,L'ISPDNORM(,R2)                START OF NEXT TEXT
         SPACE 1
         LA    R15,4(,R15)                       NEXT POINTER ELEMENT
         MVC   0(L'ISPDANOR,R2),ISPDANOR         SPECIFY DISP=(,,KEEP)
         ST    R2,S99TUPTR                       POINT TO TEXT UNIT
         B     ISPD110
         SPACE 1
ISPD080  CLI   SPFDFORM,X'41'                    ANY FORM?
         BL    ISPD090                           NO, BRANCH
         LA    R15,4(,R15)                       NEXT POINTER ELEMENT
         MVC   0(L'ISPDFORM,R2),ISPDFORM         SPECIFY FORMS TEXT
         MVC   6(4,R2),SPFDFORM                  SPECIFY FORM NAME
         ST    R2,S99TUPTR                       POINT TO TEXT UNIT
         LA    R2,L'ISPDFORM(,R2)                START OF NEXT TEXT
         SPACE 1
ISPD090  CLI   SPFDDEST,X'41'                    ANY DEST?
         BL    ISPD100                           NO, BRANCH
         LA    R15,4(,R15)                       NEXT POINTER ELEMENT
         MVC   0(L'ISPDDEST,R2),ISPDDEST         SPECIFY DEST TEXT
         MVC   6(8,R2),SPFDDEST                  SPECIFY DESTINATION
         ST    R2,S99TUPTR                       POINT TO TEXT UNIT
         LA    R2,L'ISPDDEST(,R2)                START OF NEXT TEXT
         SPACE 1
ISPD100  LA    R15,4(,R15)                       NEXT POINTER ELEMENT
         MVC   0(L'ISPDSYSO,R2),ISPDSYSO         SPECIFY SYSOUT TEXT
         MVC   6(1,R2),SPFDSOUT                  SPECIFY SYSOUT CLASS
         ST    R2,S99TUPTR                       POINT TO TEXT UNIT
         SPACE 1
ISPD110  OI    S99TUPTR,X'80'                    MARK END OF LIST
         DYNALLOC
         SPACE 2
         DROP  R1,R14,R15
         MVC   DDNAMEH,WORKTBL+6        SAVE DDNAME
         LTR   R15,R15                  SUCCESSFUL?
         BZ    ISPD120                  YES, BRANCH
         SPACE 2
         LA    R14,M99RB                POINTER TO SVC 99 BLOCK
         ST    R15,DAIRRC               RETURN CODE
         LA    R15,DAIRRC               POINTER TO RETURN CODE
         LA    R0,ADDRFF02              POINTER TO A(IKJEFF02)
         LA    R1,=AL2(DFSVC99)         POINTER TO INVOCATION TYPE
         L     R2,ADDRCPPL              POINTER TO THE CPPL
         STM   R14,R2,DFDAPLP           INITIALIZE DFDAPLP, DFDRCP,
*                                         DFJEFF02, DFIDP AND DFCPPLP
         SPACE 1
         LINK  EP=IKJEFF18,MF=(E,DFPARMS)
         MVC   SPFMSGID(8),ISPD701X     ERROR MESSAGE
         LTR   R15,R15                  PROBLEM WITH IKJEFF18?
         BNZ   ISPD020                  YES, BRANCH
         B     ISPD020
         SPACE 2
ISPD120  CLI   SPFDSOUT,X'40'           SYSOUT ALLOCATION?
         BH    ISPD180                  YES, BRANCH
         CLI   WORKTBL+14+6,DS1DSGPO    PARTITIONED?
         BNE   ISPD130                  NO, BRANCH
         CLI   SPFDMEM,X'41'            ANY MEMBER NAME?
         BL    ISPD170                  NO, ERROR
         B     ISPD180
         SPACE 1
ISPD130  CLI   WORKTBL+14+6,DS1DSGPS    SEQUENTIAL?
         BNE   ISPD170                  NO, ERROR
         CLI   SPFDMEM,X'41'            ANY MEMBER NAME?
         BL    ISPD180                  NO, ERROR
         SPACE 1
ISPD170  MVC   SPFMSGID(8),ISPD702X     ERROR MESSAGE
         B     ISPD020
         SPACE 2
*** OPEN THE SYSOUT/DATA SET
ISPD180  MVC   STOWDCB(ISPDDCBL),ISPDDCB     CONSTRUCT A DCB
         MVC   DCBDDNAM-IHADCB+STOWDCB(8),DDNAMEH
         MVI   OPENLIST,X'80'
         OPEN  (STOWDCB,(OUTPUT)),MF=(E,OPENLIST)
         TM    DCBOFLGS-IHADCB+STOWDCB,X'10' OPEN ALREADY
         BNO   ISPD190                       NO, ERROR
         OI    HFLAGSDD,X'02'                OPEN NOW
         TM    HFLAGSDD,X'01'                OPEN WITH GOOD VALUES?
         BO    ISPD200                       YES, BRANCH
         MVI   OPENLIST,X'80'
         CLOSE (STOWDCB),MF=(E,OPENLIST)
ISPD190  MVC   SPFMSGID(8),ISPD703X     ERROR MESSAGE
         B     ISPD020
         SPACE 2
*** OUTPUT THE DATA
ISPD200  LA    R14,ISPDTBTO                 TBTOP
         LA    R15,SPFTBL                   TABLE ADDRESS
         STM   R14,R15,PARMLIST
         OI    PARMLIST+4,X'80'
         LA    R1,PARMLIST
         L     R15,ISPLINK
         BALR  R14,R15
         SPACE 2
         L     R0,RECOVER                   CURRENT RECOVERY ADDRESS
         STM   R14,R8,WORKTBL               SAVE ENTRY REGISTERS
         LA    R0,ISPD500                   LOCAL RECOVERY ADDRESS
         ST    R0,RECOVER
         OI    ##ADRPA#,$Q                  QUIET MODE IF ABEND
         SPACE 1
         LA    R0,240                       ZONE PORTION
         SR    R2,R2
         IC    R2,SPFPANEL+5                1, 2, 5, 6, 7 OR 8
         SR    R2,R0                        DROP THE ZONE
         SLL   R2,2                         4, 8, 20, 24, 28 OR 32
         SPACE 1
         LA    R0,SPFDTIT                   SPF TITLE LINE
         PUT   STOWDCB,(0)
         SPACE 2
ISPD300  LA    R14,ISPDTBSK                 TBSKIP
         LA    R15,SPFTBL                   TABLE ADDRESS
         STM   R14,R15,PARMLIST
         OI    PARMLIST+4,X'80'
         LA    R1,PARMLIST
         L     R15,ISPLINK
         BALR  R14,R15
         LTR   R15,R15                      END OF DATA?
         BNZ   ISPD600                      NO, BRANCH
         SPACE 2
         LA    R1,WORKTBL+80                OUTPUT DATA LINE
         MVI   0(R1),X'40'
         MVC   1(79,R1),0(R1)
         SPACE 1
         MVC   0(4,R1),MEM2OPT              MEMLIST OPTION FIELD
         MVC   4+1(8,R1),MEMLNAME           MEMLIST NAME FIELD
         MVC   13+1(8,R1),MEMLDATA          MEMLIST DATA/STATUS FIELD
         SPACE 1
         B     *(R2)                        PERFORM THE FORMATING RTN
         B     ISPD310                      PANEL=1
         B     ISPD310                      PANEL=2
         B     ISPD310                      PANEL=3
         B     ISPD310                      PANEL=4
         B     ISPD350                      PANEL=5
         B     ISPD360                      PANEL=6
         B     ISPD370                      PANEL=7
         B     ISPD380                      PANEL=8
         SPACE 2
ISPD310  MVC   0(79,R1),SPFLINE             ADD TABLE DATA
         CLI   0(R1),X'39'                  NULL FIRST BYTE?
         BH    ISPD400                      NO, BRANCH
         MVI   0(R1),X'40'                  YES, RESET TO BLANK
         B     ISPD400
         SPACE 2
ISPD350  OC    23+1(6,R1),MEM2VMOD          PANEL=5
         OC    31+2(8,R1),MEM2CDAT
         OC    41+2(8,R1),MEM2MDAT
         OC    51+1(8,R1),MEM2MTIM
         OC    57+1(8,R1),MEM2CSIZ
         OC    63+1(8,R1),MEM2ISIZ
         OC    71+1(8,R1),MEM2MID
         B     ISPD400
         SPACE 2
ISPD360  OC    22+1(8,R1),MEM2ALIS          PANEL=6
         OC    31+2(8,R1),MEM2TTR
         OC    41+2(5,R1),MEM2VMOD
         OC    50+1(8,R1),MEM2MDAT
         OC    59+1(5,R1),MEM2MTIM
         OC    65+1(5,R1),MEM2CSIZ
         OC    71+1(7,R1),MEM2MID
         B     ISPD400
         SPACE 2
ISPD370  OC    22+1(8,R1),MEM2ALIS          PANEL=7
         OC    31+1(8,R1),MEM2LDAT
         OC    40+1(4,R1),MEM2ATT1
         OC    45+1(4,R1),MEM2ATT2
         OC    50+1(4,R1),MEM2DC
         OC    55+1(4,R1),MEM2TEST
         OC    60+1(4,R1),MEM2APF
         OC    65+1(4,R1),MEM2MODE
         OC    70+1(8,R1),MEM2MNAM
         B     ISPD400
         SPACE 2
ISPD380  OC    22+1(8,R1),MEM2ALIS          PANEL=8
         OC    30+2(6,R1),MEM2TTR
         OC    38+2(8,R1),MEM2MNAM
         OC    47+1(8,R1),MEM2MTTR
         OC    56+1(6,R1),MEM2LENG
         OC    63+1(6,R1),MEM2ENTY
         OC    70+1(8,R1),MEM2SSI
         SPACE 2
ISPD400  LR    R0,R1
         PUT   STOWDCB,(0)
         B     ISPD300
         SPACE 1
ISPD500  LM    R14,R8,WORKTBL               RESET ENTRY REGISTERS
         ST    R0,RECOVER                   RESET THE RECOVERY ADDRESS
         NI    ##ADRPA#,FF-$Q               RESET QUIET MODE
         MVC   SPFMSGID(8),ISPD704X         ERROR MESSAGE
         MVI   OPENLIST,X'80'
         TM    DCBOFLGS-IHADCB+STOWDCB,X'10' STILL OPEN?
         BNO   ISPD020                       NO, BRANCH
         CLOSE (STOWDCB),MF=(E,OPENLIST)
         B     ISPD020
         SPACE 2
*** CLOSE THE SYSOUT/DSNAME DATA SET
ISPD600  MVI   OPENLIST,X'80'
         CLOSE (STOWDCB),MF=(E,OPENLIST)
         LM    R14,R1,WORKTBL               RELOAD CHANGED REGISTERS
         ST    R0,RECOVER                   RESET THE RECOVERY ADDRESS
         MVC   SPFMSGID(8),ISPD705X         COMPLETED MESSAGE
         SPACE 1
ISPD900  NI    ##ADRPA#,FF-$Q-$A-$D         RESET QUIET MODE/ATTN
         TM    HFLAGSDD,X'02'               ANY OPEN?
         BNOR  R3                           NO, RETURN
         SPACE 1
         MVI   VOLALLOC,X'40'               NEED TO REREAD THE DSCB
         BAL   R2,CLOSEIT                   CLOSE THE INPUT DCB'S
         B     RESTART2
         SPACE 3
         USING IHADCB,R1
*** DCB OPEN EXIT
ISPD980  SR    R15,R15
         CH    R15,DCBDSORG                  ANY DSORG?
         BNE   *+8                           YES, BRANCH
         OI    DCBDSORG,DS1DSGPS             NO, USE DSORG=PS
         TM    DCBDSORG,DS1DSGPS             DSORG=PS?
         BNOR  R14                           NO, ERROR
         CLI   DCBRECFM,0                    ANY RECFM?
         BNE   *+8                           YES, BRANCH
         MVI   DCBRECFM,DCBRECF+DCBRECBR     NO, USE RECFM=FB
         TM    DCBRECFM,DCBRECF+DCBRECV      RECFM=F. OR RECFM=V.?
         BNMR  R14                           NO, ERROR
         LA    R0,80                         DEFAULT LRECL
         TM    DCBRECFM,DCBRECV              RECFM=V.?
         BOR   R14                           YES, ERROR
         CH    R15,DCBLRECL                  ANY LRECL?
         BNE   *+8                           YES, BRANCH
         STH   R0,DCBLRECL                   NO, USE LRECL=80
         CH    R0,DCBLRECL                   LRECL=80?
         BNER  R14                           NO, ERROR
         LA    R0,3120                       DEFAULT BLKSIZE
         CH    R15,DCBBLKSI                  ANY BLKSIZE?
         BNE   *+8                           YES, BRANCH
         STH   R0,DCBBLKSI                   NO, USE BLKSIZE=3120
         OI    HFLAGSDD,X'01'                ALL ATTRIBUTES ARE CORRECT
         BR    R14
         DROP  R1
         SPACE 2
ISPDVCOP LA    R1,VCOPY              COPY VARIABLE VALUES
         ST    R1,PARMLIST
*        LA    R14,XXXXXX            GET FIRST VARIABLE
*        L     R15,YYYYYY            SET LENGTH
         ST    R15,SPFFIXED
         LA    R15,SPFFIXED
*        LA    R0,ZZZZZZ             SET OUTPUT VARIABLE NAME
         LA    R1,ISPMOVE
         STM   R14,R1,PARMLIST+4
         OI    PARMLIST+16,X'80'
         LA    R1,PARMLIST
         L     R15,ISPLINK
         BALR  R14,R15
         LTR   R15,R15
         BNZ   ISPERR
         BR    R2
         SPACE 2
         PRINT NOGEN
ISPDDCB  DCB   DSORG=PS,DDNAME=PDSLOG,MACRF=(PM),EXLST=ISPDXIT
ISPDDCBL EQU   *-ISPDDCB
         PRINT GEN
         SPACE 2
ISPDXIT  DC    0F'0',X'85',AL3(ISPD980)      OPEN EXIT ONLY
ISPDTBTO DC    C'TBTOP '
ISPDTBSK DC    C'TBSKIP '
ISPDTITL DC    C'PTIT# '
ISPDDSNL DC    C'EXTRDSN '
ISPDMEML DC    C'MEMBER '
ISPDDESL DC    C'DEST '
ISPDFORL DC    C'FORM '
ISPDDISL DC    C'DISP '
ISPDSYSL DC    C'SYSOUT '
ISPDSYSP DC    C'PDSPCLAS'
ISPDDSNP DC    C'PDSPXDSN'
ISPDCMD  DC    C'CMD  '
ISPDTEXT DC    CL8'LOGCOPY'
ISPDDDNA DC    X'0055000100084040404040404040'     RETURN DDNAME
ISPDDSOR DC    X'0057000100024040'                 RETURN DSORG
ISPDFREE DC    X'001C0000'                         FREE=CLOSE
ISPDMEMB DC    X'0003000100084040404040404040'     DSNAME
ISPDDSNA DC    X'00020001002C'                     DSNAME
ISPDALLO DC    X'00040001000101'                   DISP=(_)
ISPDNORM DC    X'00050001000102'                   DISP=(,CATLG)
ISPDANOR DC    X'00060001000108'                   DISP=(,,KEEP)
ISPDTRK  DC    X'00070000'                         SPACE=(TRK,
ISPDFIRS DC    X'000A00010003000001'               SPACE=(,1
ISPDSECO DC    X'000B00010003000004'               SPACE=(,,4
ISPDDIR  DC    X'000C00010003000005'               SPACE=(,,,5)
ISPDOLD  EQU   X'01'
ISPDMOD  EQU   X'02'
ISPDNEW  EQU   X'04'
ISPDSHR  EQU   X'08'
ISPDSYSO DC    X'001800010001C1'                   SYSOUT=A
ISPDFORM DC    X'001A00010004C4F1F0F1'             SYSOUT=(,,D101)
ISPDDEST DC    X'005800010008D5F1F3F040404040'     DEST=R130
ISPDEXN  DC    CL8'P71VEXT '                       PANEL NAME
ISPD701X DC    CL8'PDSM711X'                       ERROR NAME
ISPD702X DC    CL8'PDSM712X'                       ERROR NAME
ISPD703X DC    CL8'PDSM713X'                       ERROR NAME
ISPD704X DC    CL8'PDSM714X'                       ERROR NAME
ISPD705X DC    CL8'PDSM715X'                       DONE MESSAGE
         DROP  R4                                              SS MAR85
         DROP  R6,R5,R8                                        SS SEP84

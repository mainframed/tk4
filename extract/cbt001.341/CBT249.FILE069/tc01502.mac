//MGG0001 JOB (GTE4,136),'TC01502',TIME=6
//******************************************************************
//*    ZAPS TO IEDAYM TO CAUSE ERASE/WRITE ALTERNATE TO BE SENT    *
//*    INSTEAD OF ERASE/WRITE TO 3270 TERMINALS WHOSE TSBLNNO IS   *
//*    SET AT 43 LINES RATHER THAN 24 LINES. (BOTH LOCAL AND       *
//*    REMOTE 3270S) THIS IS FOR SUPPORT OF 43 LINE 3278 MOD 4     *
//*    TERMINALS ON TCAM 10.                                       *
//*            IPO 6/MVS 3.8 WITH TCAM LEVEL-SET PTF               *
//*                                                                *
//*                       MARGARET GARDNER, GTE LABORATORIES, INC. *
//******************************************************************
//     EXEC SMPPROC
//SMPCNTL  DD  *
 RECEIVE S(TC01502) .
 APPLY S(TC01502) DIS(NO).
//SMPPTFIN DD *
++USERMOD(TC01502) /* 3278 MOD 4 SUPPORT */.
++VER(Z038) FMID(ETC0108) PRE(UZ23813) SUP(TC01501).
++ZAP(IEDAYM).
  EXPAND IEDAYM(138)
  NAME  IEDAYM
   VER 0AB2 50604090    ST  R6,SCBMBSSA        PUT ADDRESS IN CCW
   VER 0AB6 92054090    MVI LCBCPA,ERASECOM    SET TO ERASE 3270 LOCAL
   REP 0AB2 58B0CEA8    L   R11,VEDIT          ADDRESSABILITY
   REP 0AB6 47F0B418    B   PATCH1
*               PATCH1  EQU *              ****LOCAL SUPPORT ADDED****
   VER 12C4 00000000
   REP 12C4 50604090    ST  R6,SCBMBSSA        PUT ADDRESS IN CCW
   REP 12C8 45E0B468    BAL R14,FNDSCR         GET TSBLNNO
   REP 12CC 1266        LTR R6,R6              QCBTJID WAS ZERO
   REP 12CE 4770B42E    BNZ WHICHL             CHECK WHICH SCREEN
*              NOTBIGL  EQU *
   REP 12D2 92054090    MVI LCBCPA,ERASECOM    SET FOR ERASE (=X'05')
   REP 12D6 47F0CABA    B   RETURN
*              WHICHL   EQU *
   REP 12DA 952B6028    CLI TSBLNNO,X'2B'      43 LINES?
   REP 12DE 4770B426    BNE NOTBIGL            GO SET FOR ERASE
   REP 12E2 920D4090    MVI LCBCPA,X'0D'       SET FOR ERASE ALT
   REP 12E6 47F0CABA    B   RETURN
********************************************************************
   VER 0B10 D2043019    MVC SCBMBSSA(5),ERASEREM MOVE MSG TO SCB
   VER 0B14 B3F2                                  X'0227F54003'
   VER 0B16 41100005    LA  R1,5               SET DATA COUNT
   VER 0B1A 58504034    L   R5,LCBDCBPT        GET DCB ADDR
   REP 0B10 58B0CEA8    L   R11,VEDIT          ADDRESSABILITY
   REP 0B14 47F0B43E    B   PATCH2
*               PATCH2  EQU *              ****REMOTE SUPPORT ****
   REP 12EA 45E0B468    BAL FNDSCR             GET SCREENSIZE
   REP 12EE 1266        LTR R6,R6              QCBTJID=0?
   REP 12F0 4770B452    BNZ WHICHR             CHECK WHICH SCREEN
*               NOTBIGR EQU *
   REP 12F4 D2043019    MVC SCBMBSSA(5),ERASEREM MOVE MSG TO SCB
   REP 12F8 B3F2
   REP 12FA 47F0B460    B   DONE               (RETURN)
*               WHICHR  EQU *
   REP 12FE 952B6028    CLI TSBLNNO,X'2B'      43 LINES?
   REP 1302 4770B448    BNE NOTBIGR            GO SET FOR ERASE
   REP 1306 D2043019    MVC SCBMBSSA(5),ERALTR SET FOR ERASE ALT
   REP 130A B496
*               DONE    EQU *
   REP 130C 41100005    LA  R1,5               SET DATA COUNT
   REP 1310 47F0CB1A    B   RETURN
*               FNDSCR  EQU *
   REP 1314 58600010    L   R6,CVTPTR
   REP 1318 5866022C    L   R6,CVTASVT-CVT(R6)
   REP 131C 41660210    LA  R6,ASVTENTY-ASVT(R6)
   REP 1320 4850701E    LH  R5,QCBTJID
   REP 1324 1255        LTR R5,R5              CHECK FOR QCBTJID=0
   REP 1326 4720B484    BP  GOAHEAD
   REP 132A 41600000    LA  R6,0                SET R6=ZERO
   REP 132E 07FE        B   R14                 RETURN
*               GOAHEAD EQU *
   REP 1330 0650        BCTR R5,AVTEZERO
   REP 1332 89500002    SLL R5,TWO
   REP 1336 1A65        AR  R6,R5
   REP 1338 58606000    L   R6,AVTEZERO(,R6)
   REP 133C 5866003C    L   R6,ASCBTSB-ASCB(R6) ADDR OF TSB
   REP 1340 07FE        B   R14                 RETURN
*               ERALTR  EQU *
   REP 1342 02277E40    DC  X'02277E4003'       REMOTE ERASE ALT
   REP 1346 03
/*

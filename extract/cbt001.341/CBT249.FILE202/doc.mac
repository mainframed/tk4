1
                                                     MARCH 1978







                  EXTENDED JES2 AUTOMATIC

                    COMMAND PROCESSING

                        RELEASE 2



                   S. HENSEN
                   GTE LABORATORIES, INC
                   TECHNICAL COMPUTATION CENTER
                   40 SYLVAN ROAD
                   WALTHAM, MASSACHUSETTS  02154
                   617 890-8460 EXT 130

1


   INTRODUCTION


   THE CURRENT IBM/JES2 SUPPORT OF AUTOMATIC COMMAND PROCESSING SEEMS
   QUITE ADEQUATE FOR THOSE COMMANDS WHICH MUST BE ISSUED ON A DAILY
   BASIS. WITHIN MOST COMPUTER INSTALLATIONS, HOWEVER, THERE ARE
   MANY COMMANDS AND JOBS WHICH ARE RUN ON A REGULAR BASIS WHICH IS
   NOT DAILY. EXAMPLES OF THESE INCLUDE STARTING AND STOPPING PER-
   FORMANCE MEASUREMENTS TOOLS DEPENDING ON THE DAYS OF A HEAVY LOAD,
   RUNNING DISK BACKUPS AND COMPRESSIONS ON A WEEKLY BASIS, AND
   EXECUTING ACCOUNTING REPORTS ON A MONTHLY BASIS. FOR THIS TYPE
   OF AUTOMATIC PROCESSING, THE TWO PROGRAMS 'AUTOCMD' AND 'DAYDATE'
   EXTEND THE TIME-OF-DAY PROCESSING SUPPORTED BY JES2 AND ADD THE
   FEATURES OF DAY-OF-WEEK, WEEK-OF-MONTH, AND MONTH-OF-YEAR PROCESSING.


   DAYDATE AS A STANDALONE PROGRAM WILL ISSUE A RETURN CODE OF THE
   NUMERIC DAY-OF-WEEK (1-7), WEEK-OF-MONTH (1-5), OR MONTH-OF-YEAR
   (1-12). WHEN CALLED VIA A LINK MACRO IT WILL RETURN THE ABOVE OR,
   IN ADDITION, WILL RETURN THE THREE CHARACTER REPRESENTATION OF THE
   DAY-OF-WEEK (MON. - SUN.) OR MONTH-OF-YEAR (JAN. - DEC.) VIA THE
   STANDARD PARAMETER ADDRESS IN R1.


   AUTOCMD ISSUED THROUGH THE PROCEDURE AUTOCMD IN 'SYS1.PROCLIB'
   WILL READ IN AUTOMATIC START COMMANDS FROM THE MEMBER AUTOCMDS
   IN 'SYS1.PROCLIB' AND ISSUE THE APPROPRIATE COMMANDS TO THE
   INTERNAL READER, DEPENDING ON THE DAY-OF-WEEK OR WEEK-OF-MONTH.
1


   INSTALLATION INFORMATION


   1. CONTENTS OF THE DISTRIBUTATION TAPE


      THIS FILE ON THE TAPE IS IN IEBUPDTE FORMAT WITH THE SOURCE
      FOR THE TWO PROGRAMS NEEDED FOR EXTENDED AUTOMATIC COMMAND
      SUPPORT, PGM=AUTOCMD AND PGM=DAYDATE ALSO A SAMPLE PROCEDURE
      FOR EXECUTING EACH OF THE PROGRAMS AND A SAMPLE LIST OF JES2
      AUTOMATIC COMMANDS USED AS INPUT INTO PGM=AUTOCMD ARE
      INCLUDED.


           MEMBER                 PURPOSE

           AUTOCMD                ASM SOURCE FOR AUTOCMD
           DAYDATE                ASM SOURCE FOR DAYDATE
           DOC                    DOCUMENTATION (YOU ARE NOW READING IT)
           JAUTCMDS               INPUT TO AUTOCMD
           JAUTOCMD               JCL TO RUN AUTOCMD
           JDAYDATE               JCL TO RUN DAYDATE


   2. INSTALLATION PROCEDURE


      THE FOLLOWING JCL WILL PREALLOCATE THE NECESSARY DATASET ON THE
      SUPPLIED 'VOLUME' AND 'DISK'.


      // EXEC PGM=IEBUPDTE,PARM=NEW
      //SYSIN     DD UNIT=2400,DISP=(OLD,KEEP),LABEL=(XXX,NL),
      //             DCB=(RECFM=FB,LRECL=80,BLKSIZE=32720)
      //SYSUT2    DD UNIT=DISK,VOL=SER=VOLUME,DSN=JES2.AUTO.CMDS,
      //          DISP=(NEW,KEEP),SPACE=(TRK,(5,1,28))
      //SYSPRINT  DD SYSOUT=A


   BOTH PROGRAMS WILL NEED TO BE ASSEMBLED AND LINKED INTO A LINKLIST
   LIBRARY.


   ALSO, IT IS RECOMMENDED THAT THE PROCEDURE FOR EXECUTING
   PGM=AUTOCMD BE PLACED INTO A 'SYS1.PROCLIB' MEMBER IN ORDER
   FOR IT TO BE RELEASED FROM THE OPERATOR'S CONSOLE, AUTOMATICALLY
   AT IPL TIME, OR BY A JES2 AUTOMATIC COMMAND. SECONDLY, THE USER
   MAY WISH TO PLACE THE ACTUAL LIST OF AUTOMATIC COMMANDS INTO A
   'SYS1.PROCLIB' MEMBER.


   THE PROCEDURE FOR PGM=DAYDATE IS INCLUDED ONLY TO SERVE AS AN
   EXAMPLE OF HOW IT MAY BE INCORPORATED INTO DAY-DEPENDENT
   BATCH PROCESSING AS WELL AS IN AUTOMATIC COMMAND PROCESSING.

1
                      D A Y D A T E

   STANDALONE PROGRAM:

    JCL REQUIRED:  // EXEC PGM=DAYDATE,PARM='XXX'

    PARM OPTIONS:  'DOW' - DAY OF WEEK, RETURN CODE IS 1-7
                           WHERE 1 IS MONDAY.
                   'WOM' - WEEK OF MONTH, RETURN CODE IS 1-5
                           WHERE 1 IS WEEK OF FIRST FRIDAY.
                   'MOY' - MONTH OF YEAR, RETURN IS 1-12
                           WHERE 1 IS JANUARY.

    EXEC WITH LINK MACRO:

           CODE:   LINK EP=DAYDATE,PARAM=((ADDR)),DCB=0
                           WHERE ADDR IS ADDRESS OF A HALF-WORD OF
                           PARM LENGTH PLUS PARM DATA.

        EXAMPLE:   GETDAY  LA   3,DOW
                           LINK EP=DAYDATE,PARAM=((3)),DCB=0
                           .
                           .
                   DOW     DC   H'3'
                           DC   C'DOW'

        PARM OPTIONS:  'DOW' - DAY OF WEEK, DATA RETURNED VIA ADDRESS IN
                               REGISTER 1 IS 1-7 WHERE 1 IS MONDAY

                       'WOM' - WEEK OF MONTH, DATA RETURNED VIA ADDRESS
                               IS REGISTER 1 IS 1-5 WHERE 1 IS WEEK OF
                               FIRST FRIDAY.

                       'MOY' - MONTH OF YEAR, DATA RETURNED VIA ADDRESS
                               IN REGISTER 1 IS 1-12 WHERE 1 IS JANUARY.

                       'DAY' - CHARACTER DAY OF WEEK, DATA RETURNED VIA
                               ADDRESS IN REGISTER 1, IS THE FIRST THREE
                               CHARACTERS OF THE CURRENT DAY OF WEEK.

                       'MON' - CHARACTER MONTH OF YEAR, DATA RETURNED
                               VIA ADDRESS IN REGISTER 1 IS THE FIRST
                               THREE CHARACTERS OF THE CURRENT MONTH.

        RETURN CONVENTION:

                       UPON RETURN TO THE CALLING PROGRAM FROM DAYDATE,
                               REGISTER 1 CONTAINS THE ADDRESS OF A
                               FULL-WORD POINTER WHICH CONTAINS A HIGH-
                               ORDER BIT PLUS THE ADDRESS OF THE ACTUAL
                               PARM DATA IN THE REMAINING THREE BYTES.
                               AT THIS ADDRESS WILL BE A HALF-WORD
                               LENGTH OF THE PARM PASSED PLUS THE
                               PARM DATA.


1

                            A U T O C M D

   PROCEDURE: THE PGM AUTOCMD IS EXECUTED VIA THE PROCEDURE AUTOCMD
              LOCATED IN 'SYS1.PROCLIB'

   INPUT:     INPUT TO THIS PROCEDURE IS THE MEMBER AUTOCMDS LOCATED
              IN 'SYS1.PROCLIB' WHICH IS BASICALLY A LIST OF JES
              AUTOMATIC COMMANDS.

   OUTPUT:    AUTOCMD PROCESSES THE ABOVE LIST & ISSUES ONLY COMMANDS
              WHICH ARE VALID FOR THAT DAY TO THE INTERNAL READER

   INPUT FORMAT: THE FORMAT IS THE STANDARD JES2 COMMAND FOLLOWED BY
              SIGNIFICANT COMMENTS WHICH ARE INTERPRETED BY
              PGM=AUTOCMD AS AN INDICATOR OF WHEN TO ISSUE THE COMMAND.

              TIME OF DAY: AS IN THE STANDARD AUTOMATIC COMMAND, TIME
                      OF DAY FOR ISSUING THE COMMAND MAY BE SPECIFIED
                      BY 'T=HH.MM' IN COL 6 WHERE HH IS THE HOUR OF THE
                      24-HR CLOCK AND MM IS THE NUMBER OF MINUTES PAST
                      THE HOUR. IF THE TIME OF DAY SPECIFIED HAS PASSED,
                      PGM=AUTOCMD WILL NOT ISSUE THE COMMAND.

              DAY OF WEEK: THE DAYS OF THE WEEK FOR ISSUING A GIVEN
                     COMMAND CAN BE SPECIFIED BY ENTERING 'DXXX' IN COL
                     60 OF THE COMMAND WHERE XXX IS REPLACED BY A
                     STRING OF DIGITS 1-7, (EX. D135 - ISSUE COMMAND
                     ONLY ON MONDAY, WEDNESDAY AND FRIDAY). IF NOTHING
                     IS GIVEN IN THE COMMENT FIELD, THE COMMAND WILL BE
                     ISSUED DAILY.

              WEEK OF MONTH: THE WEEK OF THE MONTH FOR ISSUING A GIVEN
                     COMMAND CAN BE SPECIFIED BY ENTERING 'WYYY' IN COL
                     60 OF THE COMMAND WHERE YYY IS REPLACED BY A STRING
                     OF DIGITS 1-5 OR BY THE LETTERS 'A' OR 'L'. (EX.
                     W3 - ISSUES COMMAND ONLY DURING THE THIRD WEEK OF
                     THE MONTH. EX. 2. WA - ISSUE COMMAND ON WEEKS 1-4
                     IN A 5 WEEK MONTH AND ON WEEKS 1-3 IN A 4 WEEK
                     MONTH. EX. 3 WL - ISSUE COMMAND ONLY WEEK 4 OF
                     A 4 WEEK MONTH AND ON WEEK 5 OF A 5 WEEK MONTH.)
                     IF NOTHING IS GIVEN IN THE COMMENT FIELD, THE
                     COMMAND WILL BE ISSUED DAILY.

              DAY OF MONTH: PARM FOR BOTH DAY AND WEEK AND CAN BE
                     SPECIFIED FOR ANY COMMAND BY ENTERING
                     'DXXXWYYY' IN COL. 60 WHERE XXX IS REPLACED
                     BY A STRING OF DIGITS 1-7 AND YYY IS REPLACED
                     BY A STRING OF DIGITS 1-5. CONDITIONS MUST BE
                     SATISIFIED FOR BOTH DAY OF WEEK AND WEEK OF
                     MONTH IN ORDER FOR THE COMMAND TO BE ISSUED.
                     (EX. D5W13 - ISSUE COMMAND ONLY ON FRIDAY OF
                     THE FIRST AND THIRD WEEKS).

              SYMBOLIC SUBSTITUTION: THE PGM AUTOCMD ALSO ALLOWS FOR
                     SOME SYMBOLIC SUBSTITUTION WITHIN THE COMMAND FOR
                     DAY, WEEK, OR MONTH. THE SYMBOL '&DAY.' WILL BE
                     REPLACED WITH THE 1-DIGIT DAY OF WEEK WHERE 1
                     IS MONDAY, THE SYMBOL '&WEEK.' WILL BE REPLACED
                     WITH THE 1-DIGIT WEEK OF MONTH WHERE 1 IS THE
                     WEEK OF THE FIRST FRIDAY, AND THE SYMBOL '&MONTH.'
                     WILL BE REPLACED WITH THE 2-DIGIT MONTH OF YEAR
                     WHERE JANUARY IS MONTH 01.


1

              NOTE:  AUTOCMDS USES DAYDATE FOR ITS CURRENT DAY AND
                     WEEK DETERMINATIONS.

                     ALSO, WHEN SPECIFYING DAY OF MONTH PROCESSING,
                     CONSIDER CAREFULLY THE ALGORITHM FOR DETERMINING
                     THE CURRENT WEEK OF THE MONTH. (I.E., THE FIRST
                     WEEK ENDING SUNDAY WHICH CONTAINS THE FIRST
                     FRIDAY.) OFTEN WHEN THE FIRST OF THE MONTH
                     FALLS NEAR THE END OF THE WEEK, BY THIS ALGORITHM,
                     MONDAY - THURSDAY MAY NOT EVEN OCCUR DURING W1.










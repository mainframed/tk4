         MACRO
&NAME    ENDIF &LABEL=YES
         GBLA  &STRUCQ(9)          SEQUENCE VALIDATION STACK
         GBLA  &STRUCB(9)          BLOCK NUMBER STACK
         GBLA  &STRUCL             LEVEL COUNTER, ALSO STACK INDEX
         LCLB  &NOELSE
         LCLC  &LBL
.*   THIS MACRO IS PART OF A  BAL STRUCTURED PROGRAMMING PACKAGE
.*    WRITTEN BY  GARY S. NEMETH  OF THE CLEVELAND TRUST COMPANY
.*     DURING 1976.  ALL RIGHTS RESERVED.  ANY COMMERCIAL USE
.*      MUST BE APPROVED BY THE CLEVELAND TRUST COMPANY.
.* THIS MACRO MODIFIED AT RAINIER NATIONAL BANK
         AIF   (&STRUCL EQ 0).ERR            ENDIF IS IMPOSSIBLE
         AIF   (&STRUCQ(&STRUCL) EQ 1).ELSE  ELSE ENDIF
         AIF   (&STRUCQ(&STRUCL) EQ 2).OK    ENDIF IS REQUIRED, OK
         MNOTE *,'END          LEVEL &STRUCL BLK &STRUCB(&STRUCL)'
&STRUCL  SETA  &STRUCL-1
.ERR     MNOTE 12,'STRUCTURE ERROR'
         MEXIT
.ELSE    ANOP
.*       AIF   ('&LABEL' NE 'YES').ELSENL
&LBL     SETC  'B'.'&STRUCB(&STRUCL)'.'&STRUCL'.'F'
&LBL     DS    0H
.ELSENL  ANOP
&NOELSE  SETB  1
.OK      ANOP
.*       MNOTE *,'END          LEVEL &STRUCL BLK &STRUCB(&STRUCL)'
         AIF   (&NOELSE).NOEND
.*       AIF   ('&LABEL' NE 'YES').NOEND
&LBL     SETC  'B'.'&STRUCB(&STRUCL)'.'&STRUCL'.'N'
&LBL     DS   0H
.NOEND   ANOP
&STRUCL  SETA  &STRUCL-1           POP STATUS
         AIF   ('&NAME' EQ '').NONAME
&NAME    DS    0H
.NONAME  MEXIT
         MEND

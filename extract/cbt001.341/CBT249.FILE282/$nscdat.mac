         MACRO
        $NSCDAT &DSECT=NO,&DOC=NOGEN
         PUSH  PRINT
         PRINT &DOC
         AIF   ('&DSECT' EQ 'NO').SKP01
NSCDAT   DSECT
         AGO   .SKP02
.SKP01   ANOP
NSCDAT   CSECT ,                   START OF COMMON DATA AREA
.SKP02   ANOP
         PUSH  USING               SAVE REGISTER STATUS
         DROP  ,                   RELEASE ALL REGISTERS
         USING NSCDAT,R13          COMMON WORK AREA
         SPACE
***********************************************************************
*                                                                     *
*              SAVE AREA AND CONSTANTS                                *
*                                                                     *
***********************************************************************
         SPACE
SAVEAREA DC    18F'0'              OS SAVE AREA
PATCH    DC    20S(*)              PATCH AREA
         SPACE 2
***********************************************************************
*                                                                     *
*              SCRIPT CVT COMMON ROUTINE AREA                         *
*                                                                     *
***********************************************************************
         SPACE
SCVTENT  A     R15,VSCRICVT        POINT TO ENTRY ADDRESS
         L     R15,0(,R15)         GET ROUTINE ENTRY ADDRESS
SCVTENTR DS    0H
        $SAVE  ,                   SAVE CALLER'S REGISTERS
         LR    BASE2,R15           TRANSFER ENTRY ADDRESS
SCVTENY  B     SCVTDSLN(,BASE2)    ENTRY SEQUENCE COMPLETE
*        ABOVE BRANCH NOPPED IF FULLSTAT
         L     BASE2,SCVTCCNT-SCVTDSCT(,R15) ROUTINE CALL COUNT
         LA    BASE2,1(,BASE2)               PLUS ONE
         ST    BASE2,SCVTCCNT-SCVTDSCT(,R15) UPDATE CALL COUNT
         LR    BASE2,R15           TRANSFER ENTRY ADDRESS
SCVTENZ  B     SCVTDSLN(,BASE2)    ENTRY SEQUENCE COMPLETE
*        ZAP ABOVE BRANCH TO NOP IN DESPERATION
         OI    SCVTENZ+1,X'F0'     CLOSE THE PRINT GATE
         MVC   SCVTENN,SCVTCSCT-SCVTDSCT(BASE2)  ENTER ROUTINE NAME
         LA    R0,SCVTENM          POINT TO SHORT DISPLAY RECORD
        $CALL  PUTTERM             DISPLAY THE RESULT
         NI    SCVTENZ+1,X'0F'     REOPEN THE PRINT GATE
         LM    R0,R15,0(BASESAVE)  REGISTERS AS THEY WERE AT ENTRY
         LR    BASE2,R15           TRANSFER BASE REG
         B     SCVTDSLN(,BASE2)    ENTRY SEQUENCE COMPLETE
         SPACE
SCVTENM  DC    0H'0',AL2(5+L'SCVTENN,0),C' '
SCVTENN  DC    CL8'********'
         EJECT
***********************************************************************
*                                                                     *
*              CONSTANTS                                              *
*                                                                     *
***********************************************************************
         SPACE
FM8      DC    F'-8'               MINUS EIGHT
FM4      DC    F'-4'               MINUS FOUR
F0       DC    F'0'                FULLWORD ZERO
H0       EQU   F0+2                HALFWORD ZERO
F1       DC    F'1'                FULLWORD ONE
H1       EQU   F1+2                HALFWORD ONE
F2       DC    F'2'                FULLWORD TWO
H2       EQU   F2+2                HALFWORD TWO
F3       DC    F'3'                FULLWORD THREE
H3       EQU   F3+2                HALFWORD THREE
F4       DC    F'4'                FULLWORD FOUR
H4       EQU   F4+2                HALFWORD FOUR
F5       DC    F'5'                FULLWORD FIVE
H5       EQU   F5+2                HALFWORD FIVE
F6       DC    F'6'                FULLWORD SIX
H6       EQU   F6+2                HALFWORD SIX
F7       DC    F'7'                FULLWORD SEVEN
H7       EQU   F7+2                HALFWORD SEVEN
F8       DC    F'8'                FULLWORD EIGHT
H8       EQU   F8+2                HALFWORD EIGHT
F9       DC    F'9'                FULLWORD NINE
H9       EQU   F9+2                HALFWORD NINE
F10      DC    F'10'               FULLWORD TEN
H10      EQU   F10+2               HALFWORD TEN
F11      DC    F'11'               FULLWORD ELEVEN
H11      EQU   F11+2               HALFWORD ELEVEN
F12      DC    F'12'               FULLWORD TWELVE
H12      EQU   F12+2               HALFWORD TWELVE
F15      DC    F'15'               FULLWORD FIFTEEN
H15      EQU   F15+2               HALFWORD FIFTEEN
F30      DC    F'30'               FULLWORD THIRTY
H30      EQU   F30+2               HALFWORD THIRTY
H60      DC    H'60'               HALFWORD SIXTY
H132     DC    H'132'              HALFWORD ONE-THIRTY-TWO
F255     DC    F'255'              FULLWORD TWO FIFTY-FIVE
F256     DC    F'256'              FULLWORD TWO FIFTY-SIX
F4096    DC    F'4096'             FULLWORD FOUR K
F32767   DC    F'32767'            FULLWORD 32K-1
H32767   EQU   F32767+2            LARGEST POSITIVE HALFWORD
FM32768  DC    F'-32768'           FULLWORD -32K
HM32768  EQU   FM32768+2           LARGEST NEGATIVE HALFWORD
F16MEG   DC    A(X'1000000')       SIXTEEN MEGABYTES
         DC    F'0'                    UNUSED
         DC    F'0'                    UNUSED
         DC    F'0'                    UNUSED
         SPACE
         DC    0D'0'               FOR BLANKS ALIGNMENT
BLANKS   DC    CL240' '            BLANKS FOR ALL PURPOSES
         EJECT
***********************************************************************
*                                                                     *
*              SCRIPTW CONSTANT AREA                                  *
*                                                                     *
***********************************************************************
         SPACE
ADBASE   DC    V(SCRIPTW)          SCRIPT FIRST BASE
VMAIN    DC    V(MAIN)             SCRIPT MAIN LOOPING POINT
VSCRICVT DC    V(SCRICVT)          SCRIPT COMMUNICATION VECTOR TABLE
VSCRLAST DC    A(*-*)              HIGHEST ROUTINE ADDRESS
VTRUEEND DC    V(TRUEEND)          SCRIPT FINAL EOF ROUTINE
WRETDC   EQU   4                   DON'T COUNT ENCOUNTERED RETCODE
WRETNR   EQU   8                   ANOTHER RECORD NOW PRESENT RETCODE
WRETQT   EQU   12                  FINAL RECORD RETCODE
WRETQQ   EQU   16                  IMMEDIATE FINAL RECORD RETCODE
WRETSU   EQU   20                  SUBSTITUTE ANOTHER RECORD RETCODE
WRETLI   EQU   24                  REPROCESS LITERALLY
WRETPA   EQU   28                  FINAL PAGE RETCODE
         SPACE
         DC    A(*-*)
         DC    A(*-*)
         DC    A(*-*)
         EJECT
***********************************************************************
*                                                                     *
*              DEFAULT PARM VALUES FOR KEYWORDS                       *
*                                                                     *
***********************************************************************
         SPACE
TAB3DEF  EQU   0                   THE DEFAULT VALUE
TAB3MIN  EQU   4                   THE MINIMUM VALUE
TAB3MAX  EQU   8                   THE MAXIMUM VALUE
         SPACE
DEFAULTS DC    0F'0'
DEFLL    DC    A(60,10,144)        LINE LENGTH
DEFPL    DC    A(66,10,176)        PAGE LENGTH
DEFTM    DC    A(6,0,33)           TOP MARGIN
DEFBM    DC    A(6,0,33)           BOTTOM MARGIN
DEFHDMG  DC    A(1,0,33)           HEADING MARGIN
DEFFTMG  DC    A(1,0,33)           FOOTING MARGIN
DEFPAGS  DC    A(1,1,32767)        PAGE NUMBER TO START PRINTING
DEFPAGL  DC    A(32767,1,32767)    PAGE NUMBER TO QUIT PRINTING
DEFADJ   DC    A(0,0,50)           ADJUST COUNT
DEFNUM   DC    A(1,0,100)          NUMBER COLUMN OFFSET
DEFFFCH  DC    A(1,1,9)            SKIP TO CHANNEL FOR PAGE ALIGN
DEFFFTO  DC    A(3,1,175)          PAGE LINE NUMBER OF SKIP TO CHANNEL
DEFFNSIZ DC    A(200,1,32767)      MAX BUFFERED FOOTNOTE LINES
DEFRMSIZ DC    A(200,1,32767)      MAX RECORDS PER REMOTE
DEFHSFS  DC    A(9,2,HSFSCT)       HEADING/FOOTING SPACE OVERLAP
DEFRNLEN DC    A(150,4,240)        SET REFERENCE MAX CHAR LENGTH
DEFLNUM  DC    A(0,0,125)          LINE NUMBER COLUMN OFFSET
DEFSEQC  DC    A(240,0,240)        INPUT SEQUENCE NUMBER COLUMN
DEFPASOF DC    A(1,1,10)           NUMBER OF PASSES
DEFDARK  DC    A(1,1,10)           OFFLINE DARK OPTION
DEFTRSH  DC    A(5,0,32767)        HYPHENATION THRESHOLD
DEFMNPT  DC    A(3,0,32767)        HYPHENATION START MINIMUM
DEFENDPT DC    A(3,0,32767)        HYPHENATION END MINIMUM
DEFCONT  DC    A(0,0,32767)        ERROR CONTINUE
DEFTABL  DC    A(0,0,1)            LEFT TAB ADJUST VALUE
DEFHYSUP DC    A(3,0,32767)        HYPHENATION LINE SUPPRESS
DEFCPI   DC    A(10,4,18)          CHARACTERS PER INCH
DEFLPI   DC    A(6,2,15)           OUTPUT LINES PER INCH
         DC    A(*-*,*-*,*-*)          UNUSED
         DC    A(*-*,*-*,*-*)          UNUSED
         DC    A(*-*,*-*,*-*)          UNUSED
         EJECT
***********************************************************************
*                                                                     *
*              ADCONS                                                 *
*                                                                     *
***********************************************************************
         SPACE
IOCBPRT  DC    A(*-*)              SYSPRINT IOCB POINTER
IOCBTERM DC    A(*-*)              SYSTERM IOCB POINTER
         SPACE
INDEXS   DC    V(CTLTAB),A(SPCTLL),V(CTLTABN)     CONTROL WORD POINTERS
SPCTLI   EQU   0,2                 INITIAL CONTROL WORD
SPCTLW   EQU   2,2                 WORKING CONTROL WORD
SPCTLO   EQU   4,2                 BRANCH OFFSET
SPCTLC   EQU   6,2                 STATISTICS COUNT
SPCTLL   EQU   8,8                 LENGTH OF ONE ENTRY
         SPACE
TRANAD   DC    A(*-*)              WORKING I/O TRANSLATE TABLE ADDR
TRANADI  DC    A(TRANTABI)         INPUT TRANSLATE TABLE
TRANADO  DC    A(TRANTABO)         OUTPUT TRANSLATE TABLE
PASSNO   DC    F'0'                CURRENT PASS NUMBER
NUMTBLAD DC    A(NUMTBL)           NUMERIC TRANSLATE TABLE ADDRESS
CWTABAD  DC    A(CWTABLE)          CONTROL WORD SEPARATOR TABLE
ESTABAD  DC    A(*-*,ESTABLE)      WORKING/ACTUAL INPUT ESCAPE TABLE
CSTABAD  DC    A(CSTABLE)          ADDR .CS STATUS AND CURRENT TABLES
HEXTABAD DC    A(HEXTABLE)         FOR HEX TO CHARACTER CONVERSION
TRINITAD DC    A(TRINIT)           IDENTITY TRANSLATE TABLE ADDRESS
RCAREAAD DC    A(*-*)              REV CODE WORK AREA ADDRESS
TBANCHR  DC    A(*-*)              POINTER TO USER TAB CHAIN
         SPACE
STAKMAX  EQU   9                   MAXIMUM LEVELS OF SAVE/RESTORE
STAKANCH DC    A(*-*)              SAVE/RESTORE STACK ANCHOR
STAKCTR  DC    F'0'                SAVE/RESTORE STACK COUNTER
         SPACE
DUMPAD   DC    A(DUMPAREA)         MINI DUMP DATA AREA
LKTOP    DC    F'0'                TOP CHARACTER LINK ELEMENT
LKSTAR   DC    F'0'                LINK CHARACTER START
LKSIZE   DC    F'0'                LINK AREA SIZE
LKMULT   DC    F'0'                LINK SAVE WORD
LKANCH   DC    A(*-*)              LINK CHARACTER BLOCK ANCHOR
LKASIZE  DC    A(*-*)              NUMBER OF LINKED CHAR BLOCKS
         SPACE
WRKPLIST DC    A(*-*)              ADDRESS OF NEW STRING
         DC    A(*-*)              LENGTH OF NEW STRING
WRKFLN   DC    A(*-*)              FIRST LINK ADDRESS
WRKLLN   DC    A(*-*)              LAST LINK ADDRESS
         DC    A(*-*)              PRIMARY LINE LENGTH
         SPACE
WRKNX    DC    A(*-*)
WRKL     DC    F'0'                BOOLEAN NON-BLANK FOUND IND (0 OR 1)
         SPACE
WRKBRK   DC    A(*-*)              HYPHEN BREAK POINT
WRKSW    DC    X'00'               SWITCHS
WRKUHY   EQU   X'80'                    USER HYPHEN SWITCH
WRKBLNK  EQU   X'40'                    NO BLANKS FOUND SWITCH
         SPACE
ESCFLAG  DC    X'00'               ESCAPE CHAR FLAG
ESCSW    EQU   X'80'                    ESCAPE CHAR SWITCH
         SPACE
LBANCH   DC    A(0)                LOCAL FILE LABEL ANCHOR
LBGOTO   DC    CL8' '              GOTO TARGET
LBWRK    DC    CL8' '              GOTO WORK AREA
         SPACE
BUFF3AD  DC    A(BUFF3)            TEMPORARY READ BUFFER
HIDBANCH DC    A(*-*)              HIDDEN BUFFER ANCHOR
PEANCH   DC    A(*-*)              PERFORM LINE BUFFERS ANCHOR
OIANCH   DC    A(0)                INPUT OVERLAY ANCHOR
OOANCH   DC    A(0)                OUTPUT OVERLAY ANCHOR
BXPTR    DC    A(*-*)              POINTER TO BOX BUILDING AREA
         SPACE
DHMAXTC  EQU   10                  MAX NUMBER OF TABLES OF CONTENTS
DHNUMTC  DC    A(*-*)              CURRENT TABLE OF CONTENTS NUMBER
DHANCH   DC    (DHMAXTC)A(*-*)     TABLES OF CONTENTS ANCHORS
TCANCH   DC    (DHMAXTC)A(*-*)     TABLE OF CONTENTS BUFFER ANCHOR
TCPAGE   DC    A(*-*)              PAGE NUMBER AFTER .TC
TCDHSAVE DC    XL6'00'             .TC DEFINE HEAD SAVE
         SPACE
SAVEINIT DC    A(*-*)              INITIAL STACK SAVE WORK AREA
         SPACE
*        POSSIBLE RETURN CODES FROM THE 'GETYESNO' ROUTINE            *
*        TO BE FOUND IN 'YNRESULT'.                                   *
         SPACE
YNPOS    EQU   1                   IF AFFIRMATIVE
YNNEG    EQU   2                   IF NEGATIVE
YNMBE    EQU   3                   IF YES AND NO
YNDEL    EQU   4                   IF DELETE
YNOFN    EQU   5                   IF SUPER NEGATIVE
YNSET    EQU   6                   IF SET
YNARA    EQU   7                   IF ARABIC
YNROM    EQU   8                   IF ROMAN
YNINC    EQU   9                   IF INCLUDE
YNIGN    EQU   10                  IF IGNORE
YNODD    EQU   11                  IF ODD
YNEVN    EQU   12                  IF EVEN
YNTRON   EQU   13                  IF TRACEON
YNTROFF  EQU   14                  IF TRACEOFF
YNUSER   EQU   15                  IF USER
YNADD    EQU   16                  IF ADD
YNCNG    EQU   17                  IF CHANGE
YNDUMP   EQU   18                  IF DUMP
YNPUR    EQU   19                  IF PURGE
YNLEFT   EQU   20                  IF LEFT
YNRGHT   EQU   21                  IF RIGHT
YNCNTR   EQU   22                  IF CENTRE OR CENTER
YNISDE   EQU   23                  IF INSIDE
YNOSDE   EQU   24                  IF OUTSIDE
YNLOWER  EQU   25                  IF LOWER
YNASTK   EQU   26                  IF CHARACTER ASTERISK
YNTEST   EQU   27                  IF TEST
YNPREF   EQU   28                  IF PREFIX
YNSUFX   EQU   29                  IF SUFFIX
YNSUP    EQU   30                  IF SUPPRESS
YNTRSH   EQU   31                  IF THRESH
YNMNPT   EQU   32                  IF MINPT
YNENDPT  EQU   33                  IF ENDPT
YNHALF   EQU   34                  IF HALF
YNAND    EQU   35                  IF LOGICAL AND
YNOR     EQU   36                  IF LOGICAL OR
YNABS    EQU   37                  IF ABSOLUTE
YNCND    EQU   38                  IF CONDITIONAL
YNFRAC   EQU   39                  IF FRACTIONAL
YNNORM   EQU   40                  IF NORMAL
YNDHSTRT EQU   41                  DEFINE HEAD START LIMIT
YNSKBF   EQU   41                  IF SKBF
YNSPAF   EQU   42                  IF SPAF
YNTCIN   EQU   43                  IF TCINDENT
YNTCOF   EQU   44                  IF TCOFFSET
YNTO     EQU   45                  IF TONLY
YNTC     EQU   46                  IF TC
YNTSP    EQU   47                  IF TSPACE
YNUS     EQU   48                  IF US
YNUP     EQU   49                  IF UPPER
YNOJ     EQU   50                  IF OJUST
YNPA     EQU   51                  IF PAGE
YNBREAK  EQU   52                  IF BREAK
YNNOTO   EQU   53                  IF NOTONLY
YNNOTC   EQU   54                  IF NOTC
YNNOTSP  EQU   55                  IF NOTSPACE
YNNOUS   EQU   56                  IF NOUS
YNNOUP   EQU   57                  IF NOUPPER
YNNOOJ   EQU   58                  IF NOOJUST
YNNOPA   EQU   59                  IF NOPAGE
YNNOBRK  EQU   60                  IF NOBREAK
YNDHEND  EQU   YNNOBRK             DEFINE HEAD END LIMIT
YNHJ     EQU   61                  IF HEX JOIN
YNNOHJ   EQU   62                  IF NO HEX JOIN
*
YNOMIT   EQU   X'FE'               IF OMITTED
YNDNO    EQU   X'FF'               IF DON'T KNOW
         SPACE
YNRESULT DC    X'00'               PASS BACK GETYESNO RESULT
         SPACE
BOMIT    EQU   1                   COND CODE 1 IF ARGUMENT OMITTED
BPOS     EQU   2                   COND CODE 2 IF ARGUMENT AFFIRMATIVE
BNEG     EQU   4                   COND CODE 4 IF ARGUMENT NEGATIVE
BDNO     EQU   8                   COND CODE 8 IF ARGUMENT UNDEFINED
         SPACE
ERRTEXT  DC    A(*-*)              EXTRA ERROR TEXT LENGTH/POINTER
ERRSTART DC    A(*-*)              ERROR START COLUMN
ARGSTART DC    A(*-*)              FIRST CHARACTER TO SCAN
ARGSTOP  DC    A(*-*)              LAST CHARACTER TO SCAN
ARGSRSTA DC    A(0)                SAVE FIRST CHARACTER TO SCAN
ARGSRSTP DC    A(0)                SAVE LAST CHARACTER TO SCAN
ARGTSTAR DC    A(0)                SAVE FIRST CHARACTER TO SCAN
ARGTSTOP DC    A(0)                SAVE LAST CHARACTER TO SCAN
OPENPARN DC    A(0)                -> OPEN PARENTHESIS IN ARG
CLOSPARN DC    A(0)                -> CLOSE PARENTHESIS IN ARG
ARGCOUNT DC    F'0'                LAST COUNT OF ARGS IN .AP/.IM/.SI
QSTRING  DC    A(0)                QUOTED STRING SWITCH
OUTSEQ   DC    F'0'                LEGAL OUTPUT SEQUENCE NUMBER
         EJECT
        $MSGSECT TYPE=FLAG         GENERATE ERROR FLAGS
         SPACE
ERRCLR   EQU   X'00'                    NO ERROR
ERRINFO  EQU   X'01'                    INFORMATION MESSAGE
ERRWARN  EQU   X'04'                    WARNING MESSAGE
ERRSET   EQU   X'08'                    ERROR MESSAGE
ERRSVERE EQU   X'0C'                    SEVERE ERROR MESSAGE
ERRTERM  EQU   X'10'                    ERROR AND NOCONTINUE
         EJECT
*                                                                     *
*  PARAMETER BLOCKS PASSED TO THE INPUT COORDINATOR ROUTINE           *
*                                                                     *
         SPACE
PRIMBLOK DS    0D                  REFERS TO PRIMARY INPUT FILE
PRIMNAME DC    CL8'SYSIN'          FILE NAME
PRIMMEMB DC    CL8'        '       NO MEMBER NAME
PRIMMIN  DC    A(1)                BEGINNING LINE NUMBER
PRIMMAX  DC    A(X'1000000')       ENDING LINE NUMBER
PRIMFLAG DC    XL4'00'             FLAG BYTES
PRIMARGC DC    F'0'                ARGUMENT COUNT
PRIMGOTO DC    CL8' '              GOTO TARGET
         SPACE 2
CONSBLOK DS    0D                  REFERS TO CONSOLE
CONSNAME DC    CL8'SYSCONS'        FILE NAME
CONSMEMB DC    CL8'        '       NO MEMBER NAME
CONSMIN  DC    A(1)                FIRST ITEM NUMBER
CONSMAX  DC    A(*-*)              LAST LINE NUMBER
CONSFLAG DC    XL4'00'             FLAG BYTES
CONSARGC DC    F'0'                ARGUMENT COUNT
CONSGOTO DC    CL8' '              GOTO TARGET
         SPACE 2
APIMBLOK DS    0D                  BLOCK USED BY APPEND/IMBED/SIGNAL
APIMNAME DC    CL8'********'       DDNAME TO BE READ
APIMMEMB DC    CL8'        '       MEMBER NAME (IF ANY) TO BE READ
APIMMIN  DC    A(*-*)              FIRST ITEM NUMBER
APIMMAX  DC    A(*-*)              MAXIMUM LINE NUMBER
APIMFLAG DC    XL4'00'             FILLED IN FLAGS
APIMARGC DC    F'0'                ARGUMENT COUNT
APIMGOTO DC    CL8' '              GOTO TARGET
         SPACE
COMREPAD DC    A(*-*)              -> LIST OF DDNAME REPLACEMENTS
COMPARM3 DC    A(*-*)              THIRD USER PARM POINTER
CURFILE  DC    A(0,0)              PTRS TO CURRENT FILBLOCK AND DDBLOCK
COMAREA  DC    0F'0'               START OF RECORD DESCRIPTOR DATA
COMFILNM DC    CL8' '              NAME OF CURRENT INPUT FILE
COMMEMNM DC    CL8' '              NAME OF CURRENT INPUT MEMBER
COMFILNO DC    CL8' '              ZONED DECIMAL LINE NUMBER
COMFILIT DC    A(0)                NUMBER OF LAST RECORD READ
COMLEN   EQU   *-COMAREA           LENGTH OF RECORD DESCRIPTOR DATA
         SPACE
COMAGO   DS    XL(COMLEN)          SOURCE OF FORWARD GOTO
         EJECT
*                                                                     *
*                                       PARAMETER LISTS               *
*                                                                     *
         SPACE 2
FMTOLD1  DS    0D                  ORIGIN OF FIRST FORMAT DATA AREA
LINKPARM DS    0F
OUTPARM  DC    A(BUFF1M1)          LOC. OF STRING
NOCHARS  DC    F'0'                LENGTH OF STRING
OLDFIRST DC    A(*-*)              LOC. OF FIRST LINK ELEMENT
OLDLAST  DC    A(*-*)              LOC. OF LAST LINK ELEMENT
OLDCOUNT DC    F'0'                NUMBER OF LINK BLOCKS
IWSPC    DC    F'0'                INTER-WORD SPACES
         SPACE
PARMPUT  DS    0F
PTCHLOC  DC    A(BUFF2M1)          LOC. OF STRING
PTCHLNG  DC    F'0'                LENGTH OF STRING
PTELFIR  DC    A(*-*)              LOC. OF FIRST LINK ELEMENT
PTELLST  DC    A(*-*)              LOC. OF LAST LINK ELEMENT
PTELLNG  DC    F'0'                LENGTH OF PRIMARY LINE
EFMTOLD1 EQU   *-FMTOLD1           LENGTH OF LINK DESCRIPTORS
         SPACE
SWCTL    DC    0F'0'               START OF SWITCH CONTROL AREA
CLLZ     DC    A(*-*)              COLUMN LENGTH PARAMETER
TBANCHA  DC    A(TBANCHR)          ADDR OF TAB ANCHOR FIELD
RMARGIN  DC    H'0'                RIGHT MARGIN
OFUNCNT  DC    H'0'                OFFSET/UNDENT MARGIN COUNT
INDENTR  DC    H'0'                RIGHT INDENT FROM LINE LENGTH
         SPACE
JUVAL    DC    AL1(*-*)            JUSTIFY OPTION
JUVNEG   EQU   0                        NO JUSTIFY
JUVHALF  EQU   4                        HALF JUSTIFY LEFT AND RIGHT
JUVPOS   EQU   8                        JUSTIFY LEFT AND RIGHT
JUVLEFT  EQU   12                       LEFT JUSTIFY
JUVRGHT  EQU   16                       RIGHT JUSTIFY
JUVCNTR  EQU   20                       CENTRE JUSTIFY
JUVISDE  EQU   24                       INSIDE JUSTIFY
JUVOSDE  EQU   28                       OUTSIDE JUSTIFY
FOVAL    DC    AL1(*-*)            FORMAT OPTION  ***RESERVED***
         DC    F'0'                    UNUSED
         DC    F'0'                    UNUSED
         SPACE
*                                                                     *
*                                       SWITCHS                       *
*                                                                     *
SWITCHS  DC    XL10'00'            ALL THE SWITCHES
         SPACE
         ORG   SWITCHS+6           END OF SAVED/RESTORED SWITCHS
LFMTOLD1 EQU   *-FMTOLD1           LENGTH OF FIRST FORMAT AREA
SWCTLZ   EQU   *-SWCTL             END OF SWITCH CONTROL AREA
         ORG   ,                   END OF GLOBAL SWITCHS
         EJECT
***********************************************************************
*                                                                     *
*                                       PAGE CONTROL                  *
*                                                                     *
***********************************************************************
         SPACE
FMTOLD2  DS    0F                  ORIGIN OF SECOND FORMAT DATA AREA
LLZ      DC    A(*-*)              LINE LENGTH PARAMETER
INDL     DC    H'0'                INDENTATION FACTOR
OFFL     DC    H'0'                OFFSET VALUE
OFFLI    DC    H'0'                OFFSET INCREMENT
UNDL     DC    H'0'                UNDENT FACTOR
CECNT    DC    H'0'                CENTER VALUE
LICNT    DC    H'0'                LITERAL VALUE
DSCNT    DC    H'1'                LINE SPACING FACTOR
OVLINCNT DC    H'0'                OVERLAY COUNT LEFT
URCNT    DC    H'0'                USER REFERENCE VALUE
ADJCNT   DC    H'0'                ADJUST COUNT
ADJCEVN  DC    H'0'                EVEN PAGE ADJUST COUNT
ADJCODD  DC    H'0'                ODD PAGE ADJUST COUNT
PICNT    DC    H'0'                PARAGRAPH INDENT VALUE
HICNT    DC    H'0'                HANGING INDENT VALUE
PLZ      DC    H'0'                PAGE LENGTH
TOPMRG   DC    H'0'                TOP MARGIN
BMMRG    DC    H'0'                BOTTOM MARGIN
HDMRG    DC    H'1'                HEADING MARGIN
FTMRG    DC    H'1'                FOOTING MARGIN
HSCNT    DC    H'0'                HEADING SPACE COUNT
FSCNT    DC    H'0'                FOOTING SPACE COUNT
FTCNT    DC    H'0'                FOOTING TITLE COUNT
DARKVAL  DC    H'0'                DARK OUTPUT VALUE
HYTHRESH DC    H'0'                HYPHENATION THRESHOLD
HYMINPT  DC    H'0'                HYPHENATION START MINIMUM
HYENDPT  DC    H'0'                HYPHENATION END MINIMUM
HYSUPCNT DC    H'0'                HYPHENATION LINE SUPPRESS
HYSUPWRK DC    H'0'                HYPHENATION LINE SUPPRESS LEFT
CDCOUNT  DC    F'0'                COUNT OF MULTI-COLUMN DEFINITION
CDMAXC   EQU   9                   MAX MULTI-COLUMN SUPPORT
CDVALC   DC    XL(CDMAXC)'00'      MULTI-COLUMN OFFSETS
CDINIT1  EQU   0                        DEFAULT FIRST VALUE
CDINIT2  EQU   46                       DEFAULT SECOND VALUE
CDINIT3  EQU   92                       DEFAULT THIRD VALUE
LFMTOLD2 EQU   *-FMTOLD2           LENGTH OF SECOND AREA
         SPACE
PACNTI   DC    A(*-*)              INTEGER PART OF PAGE NUMBER
PACNTD   DC    A(*-*)              DECIMAL PART OF PAGE NUMBER
PACNTII  DC    A(1)                INITIAL INTEGER PART OF PAGE NUMBER
PACNTDI  DC    A(-1)               INITIAL DECIMAL PART OF PAGE NUMBER
PNPREF   DC    0CL9' ',X'00',CL8'*'     LENGTH/PAGE NUMBER PREFIX
PNSUFX   DC    0CL9' ',X'00',CL8'*'     LENGTH/PAGE NUMBER SUFFIX
         SPACE
ERCONT   DC    F'0'                ERROR CONTINUE COUNT
RETCODE  DC    H'0'                RETURN CODE TO CALLER
SYRET    DC    H'0'                LAST .SY RETURN CODE
PLCT     DC    H'0'                PAGE LENGTH COUNTER
FNSEP    DC    H'0'                FOOTNOTE DEPTH INCL SEPARATOR
         SPACE
WRKBUFFA DC    A(WRKBUFF)          HEADING/FOOTING BUFFER ADDRESS
ADJBUFFA DC    A(*-*)              EVEN/ODD ADJUST WORK BUFFER
         SPACE
EBCDPAGE DC    CL32'1'             EBCDIC PAGE NUMBER FOR SYSPPAGE
DECPAGE  DC    CL8'00000000',CL8'********' NUMERIC/ROMAN PAGE NUMBER
HDTEMPAD DC    A(BUFF3+4)          TEMP HEADING BUFFER ADDRESS
HPBKCNT  DC    2H'0'               HEADING BUFFER BACKSPACE COUNT
         SPACE
TRIPLSP  EQU   C'-'                SKIP 3 LINES BEFORE PRINTING
DOUBLSP  EQU   C'0'                SKIP 2 LINES BEFORE PRINTING
SINGLSP  EQU   X'40'               SKIP 1 LINE BEFORE PRINTING
SUPRSPAC EQU   C'+'                SUPPRESS SPACE BEFORE PRINTING
SPACTABL DC    AL1(SUPRSPAC,SINGLSP,DOUBLSP,TRIPLSP)  ASA CARRIAGE TAB
         SPACE
LINEFC   EQU   30                  MAX NUMBER OF LINEFEEDS AT ONCE
LINEFE   EQU   10                  NUMBER OF LINE FEEDS TO EJECT PAGE
LINEF    DC    (LINEFC)X'1725'     LINE FEED OPERATION
         SPACE
CPRTBYP  EQU   X'24'               SUPPRESS CONSOLE PRINTING
CPRTRES  EQU   X'14'               RESTORE  CONSOLE PRINTING
CBACKSP  EQU   X'16'               BACKSPACE CHARACTER
CESCAPE  EQU   X'27'               ESCAPE CHARACTER
         SPACE
FLOFFCH  DC    F'0'                BUFFERED SPACE CHANNEL SKIP
FLOFFSP  DC    F'0'                BUFFERED OFFLINE SPACES
FLBLNK   DC    0F'0',AL2(BLNKRDWL,0)
FLBLNKCC DC    X'CC',C' '          BLANK FLUSH CC AND DATA
         SPACE
BLNKRDWL EQU   6                   LENGTH IN RDW FOR BLANK LINE
BLNKLINE DC    0F'0',AL2(BLNKRDWL,0)    FOR SKIPPING SPACES
PRNTRCC  DC    C' '
BLNKDATA DC    CL132' '
         EJECT
***********************************************************************
*                                                                     *
*                                       BUFFER STORAGE                *
*                                                                     *
***********************************************************************
         SPACE
         DS    0F
BUFF1LGZ DC    H'5',H'0'
BUFF1LG  EQU   BUFF1LGZ+1
BUFF1M1  DC    C' '
BUFF1    DC    CL240' ',CL16' '    OUTPUT BUFFER
         SPACE
         DS    0F
BUFF2LGZ DC    H'5',H'0'
BUFF2LG  EQU   BUFF2LGZ+1
BUFF2M1  EQU   *-1                 (MUST PRECEED BUFF2)
BUFF2    DC    CL240' ',CL16' '    INPUT BUFFER
         SPACE
B2LG     EQU   L'BUFF2
         EJECT
***********************************************************************
*                                                                     *
*              HEADING AND FOOTING BUFFERS                            *
*                                                                     *
***********************************************************************
         SPACE
ADEVHEAD DC    A(EVNHEAD)          ADDR EVEN HEADINGS/FOOTINGS
ADODHEAD DC    A(ODDHEAD)          ADDR ODD HEADINGS/FOOTINGS
AFTHEAD  DC    A(FTHEAD)           ADDR FOOTNOTE TITLES
HSFSCT   EQU   19                  MAX HEADING/FOOTING WRAP AROUND CNT
HSFSWRK  DC    H'0'                WORKING HS/FS REMAINDER
         SPACE
PSYMBOL  DC    AL1(*-*),C'%',C'&&' WORKING/DEFAULT/ALTERNATE PAGE SYMBL
         SPACE
OCCNT    DC    H'0'                OVERLAY CHAR TEXT LINES COUNT
OCCHAR   DC    AL1(*-*),C' '       OVERLAY CHARACTER OPERAND
OCEXCEP  DC    XL21'00'            EXCEPTION CHARACTER ARRAY
OCLEN    EQU   *-OCCNT             LENGTH OF OVERLAY CHAR AREA
         SPACE
UDFLAG   DC    X'00'               UNDERSCORE INCLUDE/IGNORE FLAG
UDINCCHR DC    C' '                UNDERSCORE INCLUDE ESCAPE
UDIGNCHR DC    C' '                UNDERSCORE IGNORE ESCAPE
UDTABAD  DC    A(UDTABLE)          UNDERSCORE TABLE ADDRESS
UPTABAD  DC    A(UPTABLE)          UPPERCASE TABLE ADDRESS
         SPACE
IFSTAKCT EQU   10                  MAX .IF NESTING COUNT
IFSTAKSP EQU   2                   BYTE COUNT FOR ONE .IF LEVEL
IFSTAK   DC    XL(IFSTAKCT*IFSTAKSP)'00',XL(IFSTAKSP)'00'  IF STACK
         SPACE
PERIND   DC    AL1(*-*),C'.'       CONTROL WORD INDICATOR CHARACTER
BREAKCHR DC    AL1(*-*),CL1''''    WORKING/DEFAULT HEADER BREAK CHAR
PERNBIND DC    AL1(*-*),C' '       NOBREAK CONTROL WORD INDICATOR
BSIND    DC    AL1(*-*),C' '       USER BACKSPACE/HEXJOIN CHARACTER
TBIND    DC    AL1(*-*),X'05'      USER ADDITIONAL TAB CHARACTER
         SPACE
*                                                                     *
*        INCORE FORMATTING SAVE AREAS                                 *
*                                                                     *
         SPACE
ICORANCH DC    A(*-*)              INCORE FORMAT ANCHOR POINTER
ICORFLG  DC    X'00'               TYPE OF INCORE OPERATION
ICORNONE EQU   0                        INCORE FORMAT NOT IN PROGRESS
ICORCC   EQU   4                        .CC BEGIN/END SEQUENCE
ICORCP   EQU   8                        .CP BEGIN/END SEQUENCE
ICORFB   EQU   12                       .FB BEGIN/END SEQUENCE
ICORFK   EQU   16                       .FK BEGIN/END SEQUENCE
ICORFN   EQU   20                       .FN BEGIN/END SEQUENCE
ICORHN   EQU   24                       .HN BEGIN/END SEQUENCE
ICORHNE  EQU   28                       .HN EVEN BEGIN/END SEQUENCE
ICORHNO  EQU   32                       .HN ODD BEGIN/END SEQUENCE
         SPACE
ICOLFLG  DC    X'00'               TYPE OF MULTI-COLUMN OPERATION
ICOLNONE EQU   0                        MULTI-COLUMN NOT IN PROGRESS
ICOLMC   EQU   4                        MULTI-COLUMN IN PROGRESS
ICOLSC   EQU   8                        SUPPRESSED MULTI-COLUMN
ICOLTC   EQU   12                       TITLE SUPPRESSED MULTI-COLUMN
CLLZSAVE DC    F'0'                SAVE FOR REAL CLLZ
SCCOUNT  DC    F'0'                SINGLE COLUMN NEST COUNT
CDCURR   DC    F'0'                CURRENT MULTI-COLUMN IN PROGRESS
CDPLCT   DC    H'0'                SAVE LINES REMAINING FIR COLUMN
         SPACE
CCAREA   DC    0F'0'               .CC FORMAT AREA
CCQCNT   DC    F'0'                     NUMBER QUEUED .CC LINES
CCQCNTF  DC    F'0'                     NUMBER IN FIRST BLOCK
CCQANCH  DC    A(0)                     .CC CELL ANCHOR
CCQFLGS  DC    XL4'00'                  .CC FLAGS
CCQSAVE  DC    A(*-*)                   .CC SAVE CURRENT DATA POINTER
CPAREA   DC    0F'0'               .CP FORMAT AREA
CPQCNT   DC    F'0'                     NUMBER QUEUED .CP LINES
CPQCNTF  DC    F'0'                     NUMBER IN FIRST BLOCK
CPQANCH  DC    A(0)                     .CP CELL ANCHOR
CPQFLGS  DC    XL4'00'                  .CP FLAGS
CPQSAVE  DC    A(*-*)                   .CP SAVE CURRENT DATA POINTER
FBAREA   DC    0F'0'               .FB FORMAT AREA
FBQCNT   DC    F'0'                     NUMBER QUEUED .FB LINES
FBQCNTF  DC    F'0'                     NUMBER IN FIRST BLOCK
FBQANCH  DC    A(0)                     .FB CELL ANCHOR
FBQFLGS  DC    XL4'00'                  .FB FLAGS
FBQSAVE  DC    A(*-*)                   .FB SAVE CURRENT DATA POINTER
FKAREA   DC    0F'0'               .FK FORMAT AREA
FKQCNT   DC    F'0'                     NUMBER QUEUED .FK LINES
FKQCNTF  DC    F'0'                     NUMBER IN FIRST BLOCK
FKQANCH  DC    A(0)                     .FK CELL ANCHOR
FKQFLGS  DC    XL4'00'                  .FK FLAGS
FKQSAVE  DC    A(*-*)                   .FK SAVE CURRENT DATA POINTER
FNAREA   DC    0F'0'               .FN FORMAT AREA
FNQCNT   DC    F'0'                     NUMBER QUEUED FOOTNOTE LINES
FNQCNTF  DC    F'0'                     NUMBER IN FIRST BLOCK
FNQANCH  DC    A(0)                     FOOTNOTE CELL ANCHOR
FNQFLGS  DC    XL4'00'                  .FN FLAGS
FNQSAVE  DC    A(*-*)                   .FN SAVE CURRENT DATA POINTER
HNAREA   DC    0F'0'               .HN FORMAT AREA
HNQCNT   DC    F'0'                     NUMBER QUEUED HEADNOTE LINES
HNQCNTF  DC    F'0'                     NUMBER IN FIRST BLOCK
HNQANCH  DC    A(0)                     HEADNOTE CELL ANCHOR
HNQFLGS  DC    XL4'00'                  HEADNOTE FLAGS
HNQSAVE  DC    A(*-*)                   .HN SAVE CURRENT DATA POINTER
HNEAREA  DC    0F'0'               .HN EVEN FORMAT AREA
HNEQCNT  DC    F'0'                     NUMBER QUEUED HEADNOTE LINES
HNEQCNTF DC    F'0'                     NUMBER IN FIRST BLOCK
HNEQANCH DC    A(0)                     HEADNOTE CELL ANCHOR
HNEQFLGS DC    XL4'00'                  HEADNOTE FLAGS
HNEQSAVE DC    A(*-*)                   .HN SAVE CURRENT DATA POINTER
HNOAREA  DC    0F'0'               .HN ODD FORMAT AREA
HNOQCNT  DC    F'0'                     NUMBER QUEUED HEADNOTE LINES
HNOQCNTF DC    F'0'                     NUMBER IN FIRST BLOCK
HNOQANCH DC    A(0)                     HEADNOTE CELL ANCHOR
HNOQFLGS DC    XL4'00'                  HEADNOTE FLAGS
HNOQSAVE DC    A(*-*)                   .HN SAVE CURRENT DATA POINTER
         SPACE
SCAREA   DC    0F'0'               SINGLE COLUMN FORMAT AREA
SCQCNT   DC    F'0'                     NUMBER QUEUED SC LINES
SCQCNTF  DC    F'0'                     NUMBER IN FIRST BLOCK
SCQANCH  DC    A(0)                     SINGLE COLUMN ANCHOR
SCQFLGS  DC    XL4'00'                  SINGLE COLUMN FLAGS
SCQSAVE  DC    A(*-*)                   SINGLE COLUMN SAVE CURRENT DATA
MCAREA   DC    0F'0'               MULTI-COLUMN FORMAT AREA
MCQCNT   DC    F'0'                     NUMBER QUEUED MC LINES
MCQCNTF  DC    F'0'                     NUMBER IN FIRST BLOCK
MCQANCH  DC    A(0)                     MULTI-COLUMN ANCHOR
MCQFLGS  DC    XL4'00'                  MULTI-COLUMN FLAGS
MCQSAVE  DC    A(*-*)                   MULTI-COLUMN SAVE CURRENT DATA
MCQLEN   EQU   *-MCAREA            LENGTH OF ONE AREA
         DC    (CDMAXC-1)XL(MCQLEN)'00' ROOM FOR THE OTHERS
MCFNQAD  DC    A(*-*)              MULTI-COLUMN LINE POINTER
MCALEN   DC    AL2(MCQLEN)         LENGTH OF ONE AREA
         SPACE
HDPTRSAV DS    CL(LFMTOLD1)        SAVE AREA FOR HEADING ROUTINE
         SPACE
HYLEVEL  DC    A(*-*)              CURRENT HYPHENATION LEVEL
HYNONE   EQU   1                   NO HYPHENATION
HYUSER   EQU   2                   USER HYPHENATION
HYAUTO   EQU   3                   AUTOMATIC HYPHENATION
HYUCHAR  EQU   X'30'               INTERNAL USER TRAILING HYPHEN CHAR
HYACHAR  EQU   C'-'                EXTERNAL HYPHEN CHARACTER
HYEXCNT  DC    F'0'                HYPHENATION EXCEPTION WORD COUNT
HYTESTAR DC    0CL65' ',X'00',CL64' '   HYPHENATION TEST AREA
         SPACE
PUMAX    EQU   9                   MAXIMUM PUT FILE NUMBER
PUIOCBPT DC    A(PUIOCBAD)         POINTER TO WORK FILE IOCB ADDRS
PUDDNAME DC    CL8'SYSUSR**'       PUT WORK FILE BASIC DDNAME
         SPACE
IXVCNT   EQU   9                   MAX CONCURRENT INDEXES
IXANCHV  DC    (IXVCNT)A(*-*)      PTRS FIRST LEVEL ONE INDEX BLOCK
IXPTRS   DC    0A(0)               START OF INDEX PARSED PARMS
IXPTR1   DC    A(*-*)                   FIRST LENGTH-1/ADDRESS
IXPTR2   DC    A(*-*)                   SECOND LENGTH-1/ADDRESS
IXPTR3   DC    A(*-*)                   THIRD LENGTH-1/ADDRESS
IXPTRE   DC    A(0)                     END OF PARM LEVELS
IXPARM   DC    A(*-*)                   REFERENCE LENGTH-1/ADDRESS
IXPTRL   EQU   *-IXPTRS            LENGTH OF IX PARSED PARMS
         SPACE
RGLISTAD DC    A(RGLIST)           ADDRESS REGION MANAGER PARM LIST
         SPACE
PRGUSED  DC    A(0)                REGION MANAGER GOTTEN CORE
PRGHIGH  DC    A(0)                HIGH WATER MARK FOR GOTTEN CORE
         EJECT
*                                                                     *
*                                       RANDOM STORAGE                *
*                                                                     *
         SPACE
WTOCOUNT DC    F'0'                WRITE TO OPERATOR RECORD COUNT
PAGECNT  DC    F'0'                REAL PAGE EJECT COUNT
SKSP     DC    0F'0'               CONDITIONAL SKIP/SPACE AREA
SKSPFLG  DC    X'00'               SKIP SPACE FLAGS
SKSPABS  EQU   X'80'                    ABSOLUTE SKIP/SPACE
SKSPCND  EQU   X'40'                    CONDITIONAL SKIP/SPACE
SKSPSK   EQU   X'20'                    A SKIP, NOT A SPACE
SKSPFLG2 DC    X'00'               SKIP/SPACE TO ACCOMPANY CONDITIONAL
SKSPCCNT DC    H'0'                CONDITIONAL SKIP/SPACE COUNT
PLSTSV   DC    A(*-*)              INVOCATION PARM LIST ADDRESS
DECM     DC    D'0'                CONVERSION AREA
NUMSIGN  DC    C' '                GET NUMBER SIGN AREA
         SPACE
URSV     DC    16A(0)              .UR REGISTER SAVE AREA
URCURPTR DC    A(*-*)              .UR CURRENT TARGET POINTER
URENDPTR DC    A(*-*)              .UR CURRENT TARGET END POINTER
URBBACK  DC    F'0'                .UR URBUMP BACKUP COUNT
URMAXCNT DC    AL2(*-*,100)        .AP/.UR ITERATION COUNTER
UREDPAT  DC    X'4020202020202120' EDMK PATTERN - AT LEAST "0"
UREDPTN  DC    XL10'40202020202020202120'    LONG DECIMAL EDIT PATTERN
UREDWRK  DC    CL10'*'             DECIMAL WORK AREA
URFLAG   DC    X'00'               .UR LOCAL SWITCHES
URLQUT   EQU   X'80'                    L'&VARIABLE FLAG
URTQUT   EQU   X'40'                    T'&VARIABLE FLAG
         SPACE
*                                                                     *
*        REMOTE SEQUENCE SAVE AREAS --                                *
*                                                                     *
         SPACE
RMNAMLEN DC    XL(L'APIMNAME)'00'  FLAGGED IF REMOTE NAME OF LENGTH
RMNAMDEF EQU   X'FF'               REMOTE NAME DEFINED OF THIS LENGTH
         SPACE
RMQANCH  DC    A(*-*)              REMOTE DESCRIPTOR QUEUE ANCHOR
RMCNT    DC    F'0'                REMOTE CALL COUNT
RMCW     DC    C'**'               CONTROL WORD STRING
RMFLAG   DC    XL4'00'             REMOTE WORK FLAG
         ORG   *-2                 BACKUP FOR CHARACTERS
RMCWIND  DC    C' '                MACRO/REMOTE CONTROL WORD IND
RMDELIM  DC    C' '                .DM STRING DELIMITER
         SPACE
RMTRIG   DC    H'0'                TRIGGER FOR REMOTE SEQUENCE
RMNEST   DC    H'0'                NESTED LEVEL OF REMOTE SEQUENCES
RMNMNEST DC    H'0'                NEST LEVEL OF AUTOMATIC REMOTES
FILNEST  DC    H'0'                TOTAL NESTED LEVEL OF FILES
         SPACE
SFNCNT   DC    H'0'                SYSTEM FOOTNOTE COUNT
RMIMSAV  DC    16F'0'              REGISTERS OF REMOTE IMBEDDER
         EJECT
***********************************************************************
*                                                                     *
*              .SR SYMBOL TABLE                                       *
*                                                                     *
***********************************************************************
         SPACE
ASRWORK  DC    A(*-*)              CURRENT SYMBOL DICTIONARY PTR
ASRGBL   DC    A(SRGBL)            GLOBAL SYMBOL DICTIONARY
ASRLCL   DC    A(SRLCL)            LOCAL SYMBOL DICTIONARY
ASRCNT   EQU   9                   KEEP COUNT LAST VARIABLE PTR
         SPACE
RNTBCNT  DC    F'0'                COUNT OF USER VARIABLE SYMBOLS
RNTBSCNT DC    F'0'                COUNT OF SUBSCRIPTED VARIABLES
RNTBSRCH DC    F'0'                TOTAL SEARCH COUNT FOR VARIABLES
RNTBFAIL DC    F'0'                LOOKASIDE FAILURE COUNT
         SPACE
SRNTBLN  DC    A(*-*)              SINGLE ENTRY LENGTH FOR BXLE
SRNTBCUR DC    A(*-*)              ADDR OF LAST SYSTEM ENTRY (SYSNULL)
SRNTBBEG DC    V(SYSREFS)          ADDR OF START SYSTEM SYMBOLS
         SPACE
SRNM     DC    CL10' '             WORKING REFERENCE NAME
SRNMSUB  DC    AL2(*-*,0)          SUBSCRIPT VALUE AND DEFAULT
SRNMFR   DC    AL2(*-*,1)          FROM SUBLIST VALUE AND DEFAULT
SRNMTO   DC    AL2(*-*,255)        TO SUBLIST VALUE AND DEFAULT
SRNMFLG  DC    X'00'               REFERENCE NAME FLAG BYTE
SRNMALL  EQU   X'80'                    ALL SUBSCRIPT FLAG
SRNMALLP EQU   X'40'                    ALL BUT POSITIVE
SRNMALLN EQU   X'20'                    ALL BUT NEGATIVE
*        EQU   X'10'                    UNUSED
SRNMTSYM EQU   X'08'                    ERROR IN REFERENCE SYMBOL
SRNMTSUB EQU   X'04'                    ERROR IN REFERENCE SUBSCRIPT
SRNMTFR  EQU   X'02'                    ERROR IN REF SUBLIST FROM
SRNMTTO  EQU   X'01'                    ERROR IN REF SUBLIST TO
         SPACE
***********************************************************************
*                                                                     *
*              END OF DIRECTLY ADDRESSABLE PORTION                    *
*                                                                     *
***********************************************************************
         SPACE
SCRDATWK DC    0D'0'               START OF TEMPORARY WORK AREAS
         SPACE
TTYPE    DC    X'00'               OUTPUT DEFINITION
TONLINE  EQU   X'80'                    ON IF OUTPUT ONLINE
TFILE    EQU   X'40'                    ON IF OUTPUT TO A FILE
TSCREEN  EQU   X'20'                    ON IF OUTPUT TO A CRT SCREEN
         SPACE
TDEVICE  DC    X'00'               DEVICE QUALIFIER
T2741    EQU   VFO2741-VFO2741          2741 COMPATIBLE
TX1620   EQU   VFO1620-VFO2741          XEROX 1620 TERMINAL
TXASM3   EQU   VFOASM3-VFO2741          A.S. MULTIWRITER III
TQUME    EQU   VFOQUME-VFO2741          QUME TERMINAL
TXASIS   EQU   VFOASIS-VFO2741          ASIS OUTPUT TERMINAL
TMYTE    EQU   VFOMYTE-VFO2741          INSTALLATION DEFINED TERMINAL
TDEVWID  DC    H'0'                CHARACTER WIDTH
VDEVICEA DC    A(*-*)              TERMINAL DESCRIPTOR POINTER
TDEVATEA DC    A(TDEVATE)          ASCII TO EBCDIC TRANSLATE TABLE
BSHJ     DC    AL1(*-*),AL1(YNHJ)  HEX JOIN ATTRIBUTE OF USER BACKSPACE
         SPACE 2
         ORG   SCRDATWK+X'100'     LEAVE A HOLE FOR TEMPORARIES
         SPACE 2
***********************************************************************
*                                                                     *
*              BUFFER AND WORK AREAS                                  *
*                                                                     *
***********************************************************************
         SPACE
BUFF3    DC    H'0',H'0',CL240' ',CL16' '  DUMMY TERM READS HERE
WRKBUFF  DC    CL240' ',CL16' '    HEADING/FOOTING BUFFER
         EJECT
***********************************************************************
*                                                                     *
*              TRANSLATE TABLE FOR .TR AND TRANSLATE PARM             *
*                                                                     *
***********************************************************************
         SPACE
         DC    0D'0'               TO ALIGN TRANSLATE TABLES
TRANTABO DC    256AL1(*-TRANTABO)  OUTPUT TRANSLATE TABLE
         SPACE
TRANTABI DC    256AL1(*-TRANTABI)  INPUT TRANSLATE TABLE
         SPACE
ESTABLE  DC    XL256'00'           INPUT ESCAPE CHAR TABLE
         SPACE
CWTABLE  DC    XL256'00'           CONTROL WORD SEPARATOR TABLE
         ORG   CWTABLE+C';'        DEFAULT VALUE
         DC    C';'                DEFAULT SEPARATOR
         ORG
         SPACE
NUMTBL   DC    256X'FF'            NUMERIC TRANSLATE AND TEST TABLE
         ORG   NUMTBL+C'0'
         DC    10X'00'
         ORG   ,
         SPACE
HEXTABLE DC    256X'FF'            HEX TO CHARACTER CONVERSION AID
         ORG   HEXTABLE+C'A'-C' '  LOWER ALPHA
         DC    AL1(10,11,12,13,14,15)
         ORG   HEXTABLE+C'A'       UPPER ALPHA
         DC    AL1(10,11,12,13,14,15)
         ORG   HEXTABLE+C'0'       NUMERICS
         DC    AL1(0,1,2,3,4,5,6,7,8,9)
         ORG   ,
         SPACE
TRINIT   DC    256AL1(*-TRINIT)    IDENTITY TRANSLATE TABLE
         SPACE
UDON     EQU   X'01'               IF CHAR TO BE UNDERSCORED
UDOFF    EQU   X'00'               IF CHAR NOT TO BE UNDERSCORED
UDTABLE  DC    XL256'00'           UNDERSCORE TABLE
         SPACE
UPTABLE  DC    256AL1(*-UPTABLE)   UPPER CASE TRANSLATE TABLE
         ORG   UPTABLE+C'A'-C' '   LOWER CASE 'A'
         DC    C'ABCDEFGHI'        LOWER TO UPPER
         ORG   UPTABLE+C'J'-C' '   LOWER CASE 'J'
         DC    C'JKLMNOPQR'        LOWER TO UPPER
         ORG   UPTABLE+C'S'-C' '   LOWER CASE 'S'
         DC    C'STUVWXYZ'         LOWER TO UPPER
         ORG   ,
         SPACE
TDEVATE  DC    X'00010203372D2E2F1605250B0C0D0E0F'
         DC    X'101112133C3D322618193F27221D351F'
         DC    C' !"#$%&&''()*+,-./'
         DC    C'0123456789:;<=>?'
         DC    C'@ABCDEFGHIJKLMNO'
         DC    C'PQRSTUVWXYZ',X'ADE0BD4A6D'
         DC    X'79',C'abcdefghijklmno'
         DC    C'pqrstuvwxyz',X'C04FD05F07'
         DC    128X'00'
         SPACE
CSTABLE  DC    2XL100'00'          .CS INCLUDE STATUS, 00 ON, FF OFF
*                                  .CS CURRENTLY ON STATUS
         SPACE
PUIOCBAD DC    (PUMAX+1)A(*-*)     PUT FILE IOCB ADDRESSES
         SPACE
EVNHEAD  DC    (HSFSCT)A(0)        EVEN PAGE HEADING/FOOTING POINTERS
ODDHEAD  DC    (HSFSCT)A(0)        ODD PAGE HEADING/FOOTING POINTERS
FTHEAD   DC    (HSFSCT)A(0)        FOOTNOTE TITLE POINTERS
         SPACE
SRGBL    DC    0A(*-*)             GLOBAL SYMBOL DICTIONARY
SGBLANCH DC    A(*-*)              GBL VARIABLE SYMBOL ANCHOR
SGBLLAST DC    (ASRCNT)A(*-*)      LAST GBL SUCCESSES
         SPACE
SRLCL    DC    0A(*-*)             LOCAL SYMBOL DICTIONARY
SLCLANCH DC    A(*-*)              LCL VARIABLE SYMBOL ANCHOR
SLCLLAST DC    (ASRCNT)A(*-*)      LAST LCL SUCCESSES
         SPACE
RGLIST   DC    0F'0'               REGION MANAGER PARM LIST
PCELLLEN DC    A(*-*)              CELL LENGTH FOR GETCELL/FREECELL
PCELLPTR DC    A(*-*)              CELL ADDR FOR GETCELL/FREECELL
PRGFLAG  DC    XL4'00'             CALL TYPE
PRGINIT  EQU   X'00'                    INITIAL CALL
PRGFINIS EQU   X'FF'                    TERMINATION CALL
PMAXEXTS DC    AL1(63)             MAX 4K BLOCKS ALLOCATED -1
PMINEXTS DC    AL1(1)              MIN 4K BLOCKS ALLOCATED -1
PSPNUMBR DC    AL1(0)              SUB-POOL NUMBER
         DC    AL1(0)                   *RESERVED*
PMNCSIZE DC    A(0)                MIN CELL SIZE
RGWORKAR DC    XL(X'90')'00'       REGION MANAGER WORK AREA
PRGLEN   EQU   *-RGLIST            LENGTH OF REGION MANAGER PARM LIST
         SPACE
DUMPAREA DC    0D'0'               START OF DUMP DATA
DUMPPSW  DC    XL8'0'              DUMP PSW
DUMPREG  DC    16F'0'              DUMP REGISTERS
DUMPFROM DC    A(0)                DUMP FROM ADDRESS
DUMPTO   DC    A(0)                DUMP TO ADDRESS
DUMPLEN  EQU   *-DUMPAREA          LENGTH OF DUMP AREA
         SPACE 2
         POP   USING
         POP   PRINT
         MEND
*
*
*
*
*
*
*
*
*
*
*
*
*
*
*
*
*
*
*
*
*
*
*
*
*
*
*
*
*
*
*
*
*
*
*
*
*
*
*
*
*
*
*
*
*
*
*
*
*
*
*
*
*
*
*
*
*
*
*
*
*
*
*
*
*

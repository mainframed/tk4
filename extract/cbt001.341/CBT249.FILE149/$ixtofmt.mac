***********************************************************************
*
IXTOFMT5 CSECT
*
*  THIS ROUTINE USES THE CVAF SERVICE ROUTINES TO CONVERT THE
*  FREE SPACE BIT MAP OF AN INDEXED VTOC INTO PSUEDO FORMAT-5
*  DSCBS.  THIS PROVIDES A COMPATIBILITY INTERFACE FUNCTION FOR
*  PRE-DFDS ROUTINES WHICH EXAMINE FORMAT-5 DSCBS.
*
*  THIS ROUTINE IS CALLED ONCE FOR EACH FORMAT-5 WHICH MUST BE
*  BUILT.  THE INDEX RECORD BUFFER RETURNED BY CVAF IS SAVED SO
*  THAT NO ADDITIONAL I/O NEED BE DONE FOR SUCCEEDING CALLS.  THE
*  BUFFERS ARE FREED WHEN THE LAST FORMAT-5 DSCB IS RETURNED.
*  HENCE, THIS ROUTINE SHOULD BE CALLED UNTIL A FORMAT-5 DSCB WITH
*  DS5PTRDS EQUAL TO ZERO IS RETURNED.  THE NON-ZERO VALUE IN
*  DS5PTRDS WILL ALWAYS BE C'00001'.
*
*  INPUT:    R1 -->  (PARMLIST)
*                    A(WORD) -- ADDR OF A FULLWORD USED BY THIS
*                               ROUTINE.  MUST BE ZEROED FOR FIRST
*                               CALL AND RETURNED UNALTERED THEREAFTER.
*                    A(DCB)  -- ADDR OF A DCB OPENED TO THE DESIRED
*                               VTOC.  NO I/O MAY BE OUTSTANDING TO
*                               THIS DCB.
*                    A(COUNT1)- ADDR OF FULLWORD WHERE COUNT OF THE
*                               FREE (FMT 0) DSCBS WILL BE RETURNED.
*                    A(COUNT2)- ADDR OF FULLWORD WHERE COUNT OF THE
*                               FREE VIRS WILL BE RETURNED.
*                    A(FMT5) -- ADDR OF 140-BYTE AREA FOR FORMAT-5
*                               DSCB BUILT BY THIS ROUTINE.
*
*  RETURN CODES:
*            R15  = 0   ALL OK.
*            R15  = 4   VTOC IS NOT IN INDEXED FORMAT.
*            R15  = 8   CVAFTST CALL FAILED (OTHER THAN NOT INDEXED
*                       FORMAT VTOC).  CVAFTST RC IN REG 0.
*            R15  = 12  CVAFDSM CALL FAILED (OTHER THAN NON INDEXED
*                       FORMAT VTOC).  CVAFDSM RC IN HIGH ORDER BYTE
*                       OF R0. CVSTAT IN LOW ORDER BYTE OF R0.
*            R15  = 16  (UNUSED)
*            R15  = 20  LOGIC ERROR IN THIS ROUTINE.  R0 = OFFSET.
*
*
*  ATTRIBUTES -  REENTRANT, PROBLEM STATE, PROBLEM KEY
*
***********************************************************************

./ ADD NAME=CATGET   0108-81322-83033-1807-00038-00009-00000-KK00150
        PROC 2 DSN CAT L


        CONTROL NOFLUSH MSG END(ENDO)


        IF &L = L THEN +


         CONTROL MSG LIST CONLIST SYMLIST


        IFALC F(VOLGET)


        IF &LASTCC = 0 THEN GOTO ONWIT


        ALLOC F(VOLGET) BLOCK(121) SP(10 10) NEW


        ONWIT: +


        GLOBAL RC VOL DEV


        SET RC = 0


        STACK DDOUT(VOLGET)


        LISTCAT ENT(&DSN) ALL CAT(&CAT)


        OPENFILE VOLGET


        GETFILE VOLGET


        IF &SUBSTR(1:7,&STR(&VOLGET)) NE &STR(NONVSAM) THEN DO


                    CLOSFILE VOLGET


                    SET RC = 12


                    EXIT CODE(12)


                                                            ENDO


        GETFILE VOLGET


        GETFILE VOLGET


        GETFILE VOLGET


        GETFILE VOLGET


        GETFILE VOLGET


        SET VOL = &SUBSTR(26:31,&STR(&VOLGET))


        SET DEV = &SUBSTR(58:59,&STR(&VOLGET))


        CLOSFILE VOLGET





        DEVTYPE VOL(&VOL)


        IF &LASTCC NE 0 THEN DO


              IF &SUBSTR(1:4,&VOL) = 3350 THEN DO


                                         SET &DEV = 3350


                                         EXIT


                                               ENDO


               SET RC = 8


               EXIT CODE(8)


                              ENDO


        SET &DEV = &STR(&DEVTYP)


./ ADD NAME=CHDSCB   0103-77333-84009-1013-00030-00030-00009-KK00150
00010003PROC 1 DSN RECFM() LRECL() BL() DSORG() REC() LR() BLK() BLKSIZE
T

00020003IF &NOLIST = THEN LISTD &DSN


00030001CONTROL NOMSG END(ENDO)


00040000FREE F(REL) ATTR(KKKC)


00050001CONTROL MSG


00060000IF &REC.K NE K THEN SET &RECFM = &REC


00070000IF &LR.K NE K THEN SET &LRECL = &LR


00080000IF &BLK.K NE K THEN SET &BL = &BLK


00090000IF &BLKSIZE.K NE K THEN SET &BL = &BLKSIZE


00101003SET RF1 = &STR()


00102003SET RF2 = &STR()


00103003SET RF3 = &STR()


00110000SET &N = 1


00120000IF &RECFM.K = K THEN GOTO SKIPARS


00130000RFPARS: -


00140000IF &LENGTH(&RECFM.) GT 1 THEN DO


00150000                      SET &RF&N = &SUBSTR(1,&RECFM.)


00160000                      SET &RECFM = &SUBSTR(2:&LENGTH(&RECFM.),&R


00170000                      SET &N = &N + 1


00180000                      GOTO RFPARS


00190000                              ENDO


00200000SET &RECFM = RECFM(&RF1 &RF2 &RF3 &RECFM.)


00210000SKIPARS: -


00220000IF &LRECL.K NE K THEN SET &LRECL = LRECL(&LRECL.)


00230000IF &BL.K    NE K THEN SET &BL    = BL(&BL.)


00240000IF &DSORG.K NE K THEN SET &DSORG = DSORG(&DSORG.)


00250000ATTR KKKC &RECFM &LRECL &BL &DSORG


00260000ALLOC F(REL) DA(&DSN.) MOD KEEP US(KKKC)


00270002CALL 'WDPSC.SYSLIBRY(RELSEQ)'


00280003IF &NOLIST = THEN LISTD &DSN


./ ADD NAME=CLIB     0104-82069-84104-0820-00069-00064-00000-JS02150
                PROC 1 DSN  XLIB(NONE) PRINT()


                CONTROL NOMSG NOFLUSH END(ENDO)





                IF &STR(&XLIB) NE &STR(NONE) THEN %CLIB &XLIB





                STACK


                CLOG '&SYSDATE &SYSTIME CLIB' U($$$#150) SAVE





                ERROR OFF





                FILEINFO DSN(&STR(&DSN))


                SET &RC = &LASTCC





                IF &RC EQ 96 THEN DO


                    WRITE


                    WRITE ERROR ===> INVALID SYNTAX OF DSNAME


                    GOTO ENDIT


                    ENDO





                IF &RC NE 0 THEN DO


                    WRITE


                    WRITE ERROR ===> &OUTMSG


                    GOTO ENDIT


                    ENDO





                IF &DSORG NE PO THEN DO


                    WRITE


                    WRITE ERROR ===> DATASET TO BE CONCATENATED IS NOT


                    WRITE            PARTITIONED DATASET


                    GOTO ENDIT


                    ENDO





                IF &MEMCNTL EQ YES THEN DO


                    WRITE


                    WRITE ERROR ===> DO NOT PROVIDE MEMBER NAME


                    GOTO ENDIT


                    ENDO





                IF &RECFM NE V THEN DO


                    WRITE


                    WRITE ERROR ===> &FULLDSN MUST CONTAIN


                    WRITE            VARIABLE LENGTH RECORDS


                    GOTO ENDIT


                    ENDO





                WHATDSN DDNAME(SYSPROC)


                SET &RC = &LASTCC





                IF &RC NE 0 THEN GOTO CONCATM





                IF &FULLDSN NE &DSNAME THEN GOTO CONCATM





                IF &PRINT = NO THEN GOTO ENDIT





                WRITE


                WRITE SUCCESSFUL COMPLETION


                WRITE        (BUT NO ACTION WAS TAKEN SINCE THE GIVEN


                WRITE         DATASET WAS ALREADY AT THE TOP OF THE STAC


                GOTO ENDIT





         CONCATM: CONCATEM ACTCODE(A) DDNAME(SYSPROC) DSNAME('&FULLDSN')


                SET &RC = &LASTCC





                IF &PRINT = NO THEN GOTO ENDIT





                WRITE


                WRITE &OUTMSG


                WRITE        (RETURN CODE = &RC)


         ENDIT: EXIT


./ ADD NAME=CMDOUT   0112-82348-84153-1711-00047-00005-00000-KK00150
        PROC 0 DDN(CMDOUT) FREE(NO) L PRC MOD USE(NONE) FORCE CYL


        CONTROL NOMSG NOFLUSH END(ENDO)


        IF &L = L THEN CONTROL MSG LIST CONLIST


        IF &FREE NE NO THEN DO


                            FREE F(CMD&FREE)


                            EXIT


                            ENDO


        IF &CYL = THEN SET CYL = TRACK


        SET &OUT = 1


        LOOP: IFALC F(CMD&OUT)


              IF &LASTCC NE 0 THEN GOTO GOTFN


        RTRY: SET &OUT = &OUT + 1


              GOTO LOOP


        GOTFN: ALLOC F(CMD&OUT) DUMMY


        IF &DDN = CMDOUT THEN SET &DDN = &DDN&OUT


        IF &SYSPREF = &SYSUID OR &SYSUID = &STR() +


                              THEN SET &CMDDSN = COMMAND.OUTPUT&OUT


                              ELSE SET &CMDDSN = &SYSUID..COMMAND.OUTPUT


        IF &USE = NONE THEN SET &U = &STR()


                       ELSE SET &U = &STR(US(&USE))


        IF &FORCE = FORCE THEN GOTO FREEIT


        SET FRC = 0


        IFALC F(&DDN) DA(&CMDDSN)


        IF &LASTCC = 0 THEN +


                   IF &U = THEN GOTO GOTCMDF


                           ELSE GOTO SETATTR


        FREEIT: +


        IFALC F(&DDN)


        IF &LASTCC = 0 THEN FREE F(&DDN)


        FILEINFO DSN(&CMDDSN)


        SET &FRC = &LASTCC


        SETATTR: ERROR EXIT CODE(99)


        IF &FRC = 0 THEN ALLOC F(&DDN) DSN(&CMDDSN) &U


                    ELSE +


        IF &FRC = 4 THEN ALLOC F(&DDN) DSN(&CMDDSN) NEW CAT &CYL  SP(1,1


                    ELSE DO


                         WRITE ERROR IN CLIST CMDOUT ALLOCATING FOLLOWIN


                         WRITE &CMDDSN : &OUTMSG


                         GOTO RTRY


                         ENDO


        GOTCMDF: ERROR OFF


                 IF &PRC = PRC THEN WRITE RC IS &OUT


                 IF &MOD = MOD THEN DO


                                    FREE F(&DDN.M)


                                    ALLOC F(&DDN.M) DSN(&CMDDSN) MOD &U


                                    ENDO


        EXCO:    EXIT CODE(&OUT)


./ ADD NAME=ERRORMSG 0105-82314-84157-1529-00116-00005-00000-JS02150
        PROC 1 CODE


        CONTROL NOMSG


        GLOBAL MSG


        STACK


        CLOG '&SYSDATE &SYSTIME ERRORMSG' U($$$#150) SAVE


        ERROR DO


              SET MSG = &STR(CLIST ERROR CODE WAS &CODE)


              EXIT CODE(0)


              END


        GOTO MSG&CODE


        MSG16:  SET MSG = &STR(NOT ENOUGH VIRTUAL STORAGE)


                EXIT


        MSG300: SET MSG = &STR(USER TRIED TO UPDATE AN UNAUTHORIZED VARI


                EXIT


        MSG304: SET MSG = &STR(INVALID KEYWORD ON EXIT STATEMENT)


                EXIT


        MSG308: SET MSG = &STR(CODE SPECIFIED, BUT NO CODE GIVEN ON EXIT
NT)

                EXIT


        MSG312: SET MSG = &STR(INTERNAL GLOBAL PROCESSING ERROR)


                EXIT


        MSG316: SET MSG = &STR(TERMIN DELIMITER GREATER THAN 256 CHARACT


                EXIT


        MSG324: SET MSG = &STR(GETLINE ERROR)


                EXIT


        MSG328: SET MSG = &STR(MORE THAN 64 DELIMITERS ON TERMIN)


                EXIT


        MSG332: SET MSG = &STR(INVALID FILE NAME SYNTAX)


                EXIT


        MSG336: SET MSG = &STR(FILE ALREADY OPEN)


                EXIT


        MSG340: SET MSG = &STR(INVALID OPEN TYPE SYNTAX)


                EXIT


        MSG344: SET MSG = &STR(UNDEFINED OPEN TYPE)


                EXIT


        MSG348: SET MSG = &STR(FILE SPECIFIED DID NOT OPEN)


                EXIT


        MSG352: SET MSG = &STR(GETFILE - FILENAME NOT CURRENTLY OPEN)


                EXIT


        MSG356: SET MSG = &STR(GETFILE - THE FILE HAS BEEN CLOSED BY THE


                EXIT


        MSG360: SET MSG = &STR(PUTFILE - FILE NAME NOT CURRENTLY OPEN)


                EXIT


        MSG364: SET MSG = &STR(PUTFILE - THE FILE HAS BEEN CLOSED BY THE


                EXIT


        MSG368: SET MSG = &STR(PUTFILE - CLOSFILE - FILE NOT OPENED BY O


                EXIT


        MSG372: SET MSG = &STR(PUTFILE - ISSUED BEFORE GETFILE ON A FILE
FOR UPDATE)

                EXIT


        MSG400: SET MSG = &STR(GETFILE END OF FILE)


                EXIT


        MSG800: SET MSG = &STR(DATA FOUND WHERE OPERATOR WAS EXPECTED)


                EXIT


        MSG804: SET MSG = &STR(OPERATOR FOUND WHERE DATA WAS EXPECTED)


                EXIT


        MSG808: SET MSG = &STR(A COMPARISON OPERATOR WAS USED IN A SET S
)

                EXIT


        MSG816: SET MSG = &STR(OPERATOR FOUND AT THE END OF A STATEMENT)


                EXIT


        MSG820: SET MSG = &STR(OPERATORS OUT OF ORDER)


                EXIT


        MSG824: SET MSG = &STR(MORE THAN ONE EXCLUSIVE OPERATOR FOUND)


                EXIT


        MSG828: SET MSG = &STR(MORE THAN ONE EXCLUSIVE COMPARISON OPERAT


                EXIT


        MSG840: SET MSG = &STR(NOT ENOUGH OPERANDS)


                EXIT


        MSG844: SET MSG = &STR(NO VALID OPERATORS)


                EXIT


        MSG848: SET MSG = &STR(ATTEMPT TO LOAD CHARACTER FROM NUMERIC VA


                EXIT


        MSG852: SET MSG = &STR(ADDITION ERROR - CHARACTER DATA)


                EXIT


        MSG856: SET MSG = &STR(SUBTRACTION ERROR - CHARACTER DATA)


                EXIT


        MSG860: SET MSG = &STR(MULTIPLICATION ERROR - CHARACTER DATA)


                EXIT


        MSG864: SET MSG = &STR(DIVIDE ERROR - CHARACTER DATA OR DIVISION
)

                EXIT


        MSG868: SET MSG = &STR(PREFIX FOUND ON CHARACTER DATA)


                EXIT


        MSG872: SET MSG = &STR(NUMERIC VALUE TOO LARGE)


                EXIT


        MSG900: SET MSG = &STR(SINGLE AMPERSAND FOUND)


                EXIT


        MSG904: SET MSG = &STR(SYMBOLIC VARIABLE NOT FOUND)


                EXIT


        MSG908: SET MSG = &STR(ERROR OCCURD IN ERR ACTN RANGE THAT RECD
AUSE OF ANOTHER ERR)

                EXIT


        MSG912: SET MSG = &STR(SUBSTRING RANGE INVALID)


                EXIT


        MSG916: SET MSG = &STR(NON-NUMERIC VALUE IN SUBSTRING RANGE)


                EXIT


        MSG920: SET MSG = &STR(SUBSTRING RANGE VALUE TOO SMALL: 0 OR NEG


                EXIT


        MSG924: SET MSG = &STR(INVALID SUBSTRING SYNTAX)


                EXIT


        MSG932: SET MSG = &STR(SUBSTRING OUTSIDE OF RANGE OF THE STRING)


                EXIT


        MSG936: SET MSG = &STR(A BUILT-IN FUNCTION REQUIRING A VALUE WAS
 WITHOUT A VALUE)

                EXIT


        MSG940: SET MSG = &STR(INVALID SYMBOLIC VARIABLE)


                EXIT


        MSG944: SET MSG = &STR(A LABEL WAS USED AS A SYMBOLIC VARIABLE)


                EXIT


        MSG948: SET MSG = &STR(INVALID LABEL SYNTAX ON A GOTO STATEMENT)


                EXIT


        MSG952: SET MSG = &STR(GOTO LABEL WAS NOT DEFINED)


                EXIT


        MSG956: SET MSG = &STR(GOTO STATEMENT HAS NO LABEL)


                EXIT


        MSG960: SET MSG = &STR(SYSSCAN WAS SET TO AN INVALID VALUE)


                EXIT


        MSG964: SET MSG = &STR(LASTCC SET TO INVALID VALUE, EXIT TRIED T
 DEFAULT VALUE)

                EXIT


        MSG999: SET MSG = &STR(INTERNAL COMMAND PROCEDURE ERROR)


                EXIT


./ ADD NAME=FINDTTR  0101-80157-80157-1124-00017-00012-00007-KK00150
00010001PROC 1 DSNAME T


00011000CONTROL NOFLUSH END(ENDO) NOMSG


00020000FREE F(PDS  PRINT)


00021000CONTROL MSG


00030000ALLOC F(PDS) DA(&DSNAME)


00040000ALLOC F(PRINT) DA(*)


00040100WRITE ENTER STRING TO FIND:


00040200READ


00040300SET &PRM = &STR(&SYSDVAL)


00041000IF &SUBSTR(1,&STR(&PRM)) = &STR(') THEN +


00042000  SET &PRM = &SUBSTR(2:&LENGTH(&STR(&PRM))-1,&STR(&PRM))


00043001IF &T NE T THEN DO


00043101                CALL 'KK00150.MY.LOAD(FINDTTR)' '&PRM'


00044001                ENDO


00045001           ELSE DO


00046001                TEST 'KK00150.MY.LOAD(FINDTTR)' '&PRM'


00047001                ENDO


./ ADD NAME=FIREUP   0103-83249-83276-0947-00176-00176-00000-JS02150
                    PROC 0 PANEL() MESSAGE() SKELETON() TABLEIN() TABLEO


                           TAILOUT() SPFLOAD() PRINT()





                    CONTROL NOMSG NOFLUSH END(ENDO)





        ISPPLIB:    IF &PANEL = THEN GOTO ISPMLIB





                    SET &THEDSN = &PANEL


                    SET &WHICHONE = 1


                    SET &WHICHLIB = &STR(PANEL LIBRARY)


                    SET &DDNAM = ISPPLIB


                    SET &RETERN = ISPMLIB


                    GOTO FINFO





        ISPMLIB:    IF &MESSAGE = THEN GOTO ISPSLIB





                    SET &THEDSN = &MESSAGE


                    SET &WHICHONE = 2


                    SET &WHICHLIB = &STR(MESSAGE LIBRARY)


                    SET &DDNAM = ISPMLIB


                    SET &RETERN = ISPSLIB


                    GOTO FINFO





        ISPSLIB:    IF &SKELETON = THEN GOTO ISPTLIB





                    SET &THEDSN = &SKELETON


                    SET &WHICHONE = 3


                    SET &WHICHLIB = &STR(SKELETON LIBRARY)


                    SET &DDNAM = ISPSLIB


                    SET &RETERN = ISPTLIB


                    GOTO FINFO





        ISPTLIB:    IF &TABLEIN = THEN GOTO ISPTABL





                    SET &THEDSN = &TABLEIN


                    SET &WHICHONE = 4


                    SET &WHICHLIB = &STR(TABLE INPUT LIBRARY)


                    SET &DDNAM = ISPTLIB


                    SET &RETERN = ISPTABL


                    GOTO FINFO





        ISPTABL:    IF &TABLEOUT = THEN GOTO ISPFILE





                    SET &THEDSN = &TABLEOUT


                    SET &WHICHONE = 5


                    SET &WHICHLIB = &STR(TABLE OUTPUT LIBRARY)


                    SET &DDNAM = ISPTABL


                    SET &RETERN = ISPFILE


                    GOTO FINFO





        ISPFILE:    IF &TAILOUT = THEN GOTO ISPLLIB





                    FREE F(ISPFILE)


                    CONTROL MSG


                    ALLOC F(ISPFILE) DA(&TAILOUT) SHR


                    SET &RC = &LASTCC


                    CONTROL NOMSG





                    IF &PRINT NE YES THEN GOTO ISPLLIB





                    IF &RC = 0 THEN DO


                          WRITE FILE TAILORING OUTPUT LIBRARY ALLOCATED


                          GOTO ISPLLIB


                          ENDO





        ISPLLIB:    IF &SPFLOAD = THEN GOTO KWIT





                    SET &THEDSN = &SPFLOAD


                    SET &WHICHONE = 7


                    SET &WHICHLIB = &STR(SPF LINK LIBRARY)


                    SET &DDNAM = ISPLLIB


                    SET &RETERN = KWIT


                    GOTO FINFO





        KWIT:       GOTO ENDIT





        FINFO:      FILEINFO DSN(&STR(&THEDSN))


                    SET &RC = &LASTCC





                    IF &RC EQ 96 THEN DO


                        WRITE ******************************************
*********

                        WRITE INVALID DSNAME SYNTAX OF &WHICHLIB


                        WRITE ******************************************
*********

                        GOTO EXITINFO


                        ENDO





                    IF &RC NE 0 THEN DO


                        WRITE ******************************************


                        WRITE &OUTMSG


                        WRITE ******************************************


                        GOTO EXITINFO


                        ENDO





                    IF &WHICHONE = 6 THEN GOTO FINFO2





                    IF &DSORG NE PO THEN DO


                        WRITE ******************************************


                        WRITE THE &WHICHLIB MUST BE PARTITIONED


                        WRITE ******************************************


                        GOTO EXITINFO


                        ENDO





                    IF &MEMCNTL EQ YES THEN DO


                        WRITE **************************


                        WRITE DO NOT PROVIDE MEMBER NAME


                        WRITE **************************


                        GOTO EXITINFO


                        ENDO





        FINFO2:     IF &WHICHONE NE 7 THEN GOTO FINFO3





                    IF &RECFM NE U THEN DO


                        WRITE ******************************************
****************

                        WRITE THE &WHICHLIB MUST CONTAIN UNDEFINED RECOR


                        WRITE ******************************************
****************

                        GOTO EXITINFO


                        ENDO





                    GOTO CONCAT





        FINFO3:     IF &RECFM NE F THEN DO


                        WRITE ******************************************
****************

                        WRITE THE &WHICHLIB MUST CONTAIN FIXED LENGTH RE


                        WRITE ******************************************
****************

                        GOTO EXITINFO


                        ENDO





                    IF &LRECL NE 80 THEN DO


                        WRITE ******************************************
*

                        WRITE LRECL OF &WHICHLIB MUST BE 80


                        WRITE ******************************************
*

                        GOTO EXITINFO


                        ENDO





                    IF &WHICHONE = 4 OR +


                       &WHICHONE = 5 OR +


                       &WHICHONE = 6 THEN GOTO CONCAT





                    IF &BLKSIZE LT 3120 THEN DO


                        WRITE ******************************************


                        WRITE BLOCK SIZE OF &WHICHLIB


                        WRITE GREATER THAN OR EQUAL TO 3120


                        WRITE ******************************************


                        GOTO EXITINFO


                        ENDO





        CONCAT:     WHATDSN DDNAME(&DDNAM)


                    SET &RC = &LASTCC





                    IF &RC NE 0 THEN GOTO CONCATM





                    IF &FULLDSN NE &DSNAME THEN GOTO CONCATM





                    IF &PRINT NE YES THEN GOTO EXITINFO





                    WRITE &WHICHLIB ALLOCATED   (PREVIOUSLY)


                    GOTO EXITINFO





        CONCATM:    CONCATEM ACTCODE(A) DDNAME(&DDNAM) DSNAME('&FULLDSN'


                    SET &RC = &LASTCC





                    IF &PRINT NE YES THEN GOTO EXITINFO





                    IF &RC = 0 THEN DO


                          WRITE &WHICHLIB ALLOCATED


                          GOTO EXITINFO


                          ENDO





                    WRITE **********************************************


                    WRITE &OUTMSG


                    WRITE        (RETURN CODE = &RC)


                    WRITE **********************************************





        EXITINFO:   GOTO &RETERN





        ENDIT:      EXIT


./ ADD NAME=FULLUT1  0106-80207-82348-1035-00222-00213-00015-LL02150
00010000PROC 5 FSOPT SCREEN FORLIB ASMSRC ASMLOD +


00020000        CTL1() CTL2() CTL3() CTL4() CTL5() CTL6()


00030000CONTROL MAIN NOMSG END(ENDO)


00040000SET &CF = N


00050000IF &SYSPREF = CTEST THEN CONTROL MSG LIST CONLIST SYMLIST


00060000


00070000SET CTL = &STR(&&CTL)


00080000SET I = 1


00090000DO WHILE &I < 7


00100000     IF &STR(&CTL&I) = Q THEN SET CTL&I = &STR(?)


00110000     IF &STR(&CTL&I) = A THEN SET CTL&I = &STR('')


00120000     IF &STR(&CTL&I) = N THEN SET CTL&I = &STR(^)


00130000     SET &I = &I + 1


00140000   ENDO


00150000


00160000IF &ASMSRC NE ооо THEN DO


00170000    IF &SYSPREF = &SYSUID THEN SET &FULLGEN = &STR(FULLGEN)


00180000                          ELSE SET &FULLGEN = &STR(&SYSUID..FULL


00190000                       ENDO


00200000                  ELSE DO


00210000    IF &SYSPREF = &SYSUID THEN SET &FULLGEN = &STR(FULLGEN.&SCRE


00220000                 ELSE SET &FULLGEN = &STR(&SYSUID..FULLGEN.&SCRE


00230000                       ENDO


00240000


00250000IF &SUBSTR(1,&FORLIB) NE &STR(') THEN SET &FORLIB = &SYSPREF..&F


00260000       ELSE SET &FORLIB = &SUBSTR(2:&LENGTH(&FORLIB)-1,&FORLIB)


00270000IF &SUBSTR(1,&ASMSRC) NE &STR(') THEN SET &ASMSRC = &SYSPREF..&A


00280000       ELSE SET &ASMSRC = &SUBSTR(2:&LENGTH(&ASMSRC)-1,&ASMSRC)


00290000IF &SUBSTR(1,&ASMLOD) NE &STR(') THEN SET &ASMLOD = &SYSPREF..&A


00300000       ELSE SET &ASMLOD = &SUBSTR(2:&LENGTH(&ASMLOD)-1,&ASMLOD)


00310000


00320000IF &FSOPT NE A THEN DO


00330000     IF &FORLIB = &SYSPREF..ооо THEN DO


00340000                  WRITE ERROR - FORMAT LIBRARY WAS NOT ENTERED.


00350000                  EXIT


00360000                                     ENDO


00370000     ERROR  DO


00380000             SET RC = &LASTCC


00390000             IF &RC < 4 THEN WRITE DATASET IS NOT A PDS:


00400000               ELSE WRITE FORMAT LIBRARY COULD NOT BE FOUND:


00410000             WRITE       '&FORLIB'


00420000             EXIT


00430000            ENDO


00440000     DATASTAT '&FORLIB'


00450000     ERROR OFF


00460000                    ENDO


00470000


00480000IF &ASMSRC NE &SYSPREF..ооо THEN DO


00490000     ERROR  DO


00500000             SET RC = &LASTCC


00510000             IF &RC < 4 THEN WRITE DATASET IS NOT A PDS:


00520000               ELSE WRITE SOURCE LIBRARY COULD NOT BE FOUND:


00530000             WRITE       '&ASMSRC'


00540000             EXIT


00550000            ENDO


00560000     DATASTAT '&ASMSRC'


00570000     ERROR OFF


00580000                                 ENDO


00590000


00600000IF &FSOPT NE G THEN DO


00610000    IF &ASMLOD = &SYSPREF..ооо THEN DO


00620000                            WRITE ERROR - LOAD LIBRARY WAS NOT E


00630000                            EXIT


00640000                                    ENDO


00650000     ERROR DO


00660000             SET RC = &LASTCC


00670000             IF &RC < 4 THEN WRITE DATASET IS NOT A PDS:


00680000               ELSE WRITE LOAD LIBRARY COULD NOT BE FOUND:


00690000            WRITE     '&ASMLOD'


00700000            EXIT


00710000           ENDO


00720000     DATASTAT '&ASMLOD'


00730000     ERROR OFF


00740000                    ENDO


00750000


00760000IF &FSOPT = A THEN DO


00770000


00780000       IF &ASMSRC = &SYSPREF..ооо THEN DO


00790000          ERROR DO


00800000                  SET RC = &LASTCC


00810000                  IF &RC < 2 THEN GOTO ASMIT


00820000                    ELSE WRITE ERROR - SOURCE COULD NOT BE FOUND


00830000                  EXIT


00840000                ENDO


00850000          DATASTAT &FULLGEN..ASM


00860000          ERROR OFF


00870000          WRITE INVALID SOURCE DATASET.


00880000          EXIT


00890000                                       ENDO


00900000


00910000                                  ELSE GOTO ASMIT


00920000                   ENDO


00930000


00940000  ERROR DO


00950000     SET CC = &LASTCC


00960000     IF &CC NE 8 THEN DO


00970000                     WRITE UNKNOWN I/O ERROR- RETURN CODE WAS &C


00980000                     WRITE PLEASE CHECK YOUR FORMAT LIBRARY NAME


00990000                     EXIT


01000000                       ENDO


01010000     KOMM CLEAR RESET


01020000     WRITE MEMBER &SCREEN NOT FOUND IN '&FORLIB'.


01030000     WRITE MEMBER IS BEING CREATED - PLEASE WAIT.


01040000     ERROR OFF


01050000     FREE F(IN01,OUT01,MESSAGES)


01060000     ALLOC F(IN01) DSN('WDPSC.CARD(QUICK)') SHR


01070000     ALLOC F(OUT01) DSN('&FORLIB(&SCREEN)') SHR


01080000     ALLOC F(MESSAGES) DUMMY


01090000     ERROR DO


01100000           WRITE ERROR - &SCREEN COULD NOT BE CREATED.


01110000           EXIT


01120000           ENDO


01130000     CALL 'WDPSC.SYSLIBRY(FTL)' '01'


01140000     GOTO OPTLAB1


01150000        ENDO


01160000MEMSTAT '&FORLIB(&SCREEN)'  NOPRINT


01170000


01180000OPTLAB1:ERROR OFF


01190001FREE F(FILEOUT,SCREEN,CRSADDR) ATTR(KAT1)


01200000ALLOC F(SCREEN) DSN('&FORLIB(&SCREEN)') SHR


01201006ALLOC F(CRSADDR) DSN('WDPSC.FS.ADDRESS') SHR


01210000


01220000ERROR DO


01230000      ERROR


01240000      ATTR KAT1 LRECL(80) RECFM(F B) BLK(4000)


01250000      ALLOC F(FILEOUT) DSN(&FULLGEN..ASM) NEW TRACK SP(3,3) US(K


01260000      ENDO


01270000ALLOC F(FILEOUT) DSN(&FULLGEN..ASM)


01280000


01290000ERROR DO


01300000      SET QRC = &LASTCC


01310000      IF &QRC = 5 THEN EXIT CODE(0)


01320000      WRITE RETURN CODE WAS &QRC


01330000      WRITE UNKNOWN ERROR IN SCREEN GENERATOR.


01340000      EXIT


01350000      ENDO


01360000


01370002CALL 'WDPSC.SYSLIBRY(QUICK)' +


01380000 '&CTL1&CTL2&CTL3&CTL4&CTL5&CTL6&SCREEN/' /*  CALL SCREEN GENERA


01390000


01400000


01410000ERROR DO


01420000      SET &A = &LASTCC


01430000      ERROR OFF


01440000  KOMM RESET CLEAR


01450000      IF &A = SB37 OR &A = SD37 OR &A = SE37 THEN DO


01460000                  WRITE NO SPACE AVAILABLE TO PLACE &SCREEN


01470000                  WRITE INTO ASSEMBLER SOURCE DATASET &ASMSRC;


01480000                  WRITE ASSEMBLER SOURCE IS IN &SYSPREF..&FULLGE


01490003                  EXIT


01500000                        ENDO


01510000      WRITE ERROR CODE &A OCCURED WHILE SAVING ASSEMBLER SOURCE.


01520000      WRITE ASSEMBLER SOURCE IS IN &SYSPREF..&FULLGEN..ASM


01521003      WRITE


01522003      WRITE POSSIBLY ANOTHER USER IS EDITING &ASMSRC


01523003      WRITE THIS MEANS THAT THIS APPLICATION CANNOT SUCCESSFULLY


01524003      WRITE YOUR NEW MEMBER


01525003      WRITE


01526003      WRITE EITHER SPECIFY ANOTHER LIBRARY WHICH IS NOT BEING US


01527003      WRITE THIS TIME OR RECONSIDER SPECIFYING ONE AT ALL.  THIS


01528003      WRITE IS NOT REQUIRED


01530003      EXIT


01540000      ENDO


01550000CONTROL MSG


01560000IF &ASMSRC NE &SYSPREF..ооо THEN COPY &FULLGEN..ASM '&ASMSRC(&SC
ONUM

01570000      ELSE DO


01580000           KOMM CL RES


01590000           WRITE ASSEMBLER SOURCE IS IN &SYSPREF..&FULLGEN..ASM


01600000           SET &CF = Y


01610000           ENDO


01620000


01630000ASMCHK: IF &FSOPT = G THEN EXIT


01640000


01650000ASMIT:  CONTROL NOMSG


01660000  IF &CF = N THEN KOMM RESET CLEAR


01670000


01680000  WRITE


01690000  WRITE


01700000  WRITE ..................... INTERACTIVE ASSEMBLY AND LINK EDIT
...............

01710000  WRITE


01720000  WRITE ASSEMBLY IN PROGRESS


01730000  SET &TERMOPT = NOTERM


01740000  ERROR DO


01750000    WRITE


01760000    CONTROL MSG


01770000    SET &TERMOPT = TERM


01780000    ERROR DO


01790000           SET RC = &LASTCC


01800000           WRITE ERROR IN ASSEMBLY PROCESS: RETURN CODE WAS &RC


01810000           IF &RC GT 8 THEN EXIT


01820000       WRITE  ASSEMBLER LISTING WAS PLACED IN &SYSPREF..&FULLGEN


01830000           EXIT


01840000          ENDO


01850000        ENDO


01860000


01870000IF &FSOPT NE A OR &ASMSRC = &SYSPREF..ооо THEN +


01880004  ASM   &FULLGEN         OBJ(&FULLGEN) LIB('USER.TSO.MACLIB') +


01890000                         PRINT(&FULLGEN) &TERMOPT LIST


01900000                                          ELSE +


01910004  ASM '&ASMSRC(&SCREEN)' OBJ(&FULLGEN) LIB('USER.TSO.MACLIB') +


01920000                         PRINT(&FULLGEN) &TERMOPT LIST


01930000  WRITE


01940000  WRITE ASSEMBLER LISTING PLACED IN &SYSPREF..&FULLGEN..LIST


01950000  WRITE


01960000  WRITE LINK EDIT IN PROGRESS


01970000  CONTROL MSG


01980000  ERROR DO


01990000         SET RC = &LASTCC


02000000         WRITE ERROR IN LINKEDIT PROCESS: RETURN CODE WAS &RC


02010000         IF &RC GT 8 THEN EXIT


02020000   WRITE  LINK EDIT LISTING WAS PLACED IN &SYSPREF..&FULLGEN..LI


02030000         EXIT


02040000        ENDO


02050000  LINK &FULLGEN. LOAD('&ASMLOD(&SCREEN)') LIST MAP PRINT(&FULLGE


02060000  ERROR OFF


02070000  WRITE LINK EDIT LISTING PLACED IN &SYSPREF..&FULLGEN..LINKLIST


02080000  WRITE


02090000  WRITE


02100000  SET IS = &STR( LOAD MODULE &SCREEN PLACED IN &ASMLOD )


02110000  SET &L = &LENGTH(&IS)


02120000  SET PS = &STR(................................................


02130000  WRITE &SUBSTR(1:(77-&L)/2,&PS)&IS&SUBSTR(1:(78-&L)/2,&PS)


./ ADD NAME=FULLUT2  0103-80207-80288-1716-00182-00180-00006-LG00150
00010000PROC 2 SCREEN ASMLOD SCRUFLG(0) IOBUFLG(0) SCRNFLG(0) DEST()


00020000CONTROL NOMSG NOFLUSH END(ENDO)


00030000IF &SYSPREF = CTEST THEN CONTROL MSG LIST CONLIST SYMLIST


00040000


00050000IF &SYSPREF = &SYSUID THEN SET &FULLANAL = &STR(FULLANAL)


00060000                      ELSE SET &FULLANAL = &STR(&SYSUID..FULLANA


00070000


00080000IF &SUBSTR(1,&ASMLOD) NE &STR(') THEN SET &ASMLOD = &SYSPREF..&A


00090000       ELSE SET &ASMLOD = &SUBSTR(2:&LENGTH(&ASMLOD)-1,&ASMLOD)


00100000


00110000IF &DEST NE THEN DO


00120000                 SET &DEST = &STR(DEST(&DEST))


00130000                 ENDO


00140000


00150000FREE F(FILEOUT,JOBSTREM,IN,OUT,LIBR)


00160000


00170000ERROR DO


00180000      SET RC = &LASTCC


00190000      IF &RC < 4 THEN WRITE '&ASMLOD' IS NOT A PDS;


00200000                 ELSE WRITE '&ASMLOD' COULD NOT BE FOUND;


00210000      WRITE PLEASE CHECK YOUR DSNAME.


00220000      EXIT


00230000      ENDO


00240000DATASTAT '&ASMLOD'


00250000


00260000ERROR DO


00270000     SET CC = &LASTCC


00280000     IF &CC NE 8 THEN DO


00290000                     WRITE UNKNOWN ERROR- LASTCC WAS &CC.


00300000                     WRITE PLEASE NOTIFY TSO COORDINATOR OF ERRO
ULLSCREEN ANALYZER.

00310000                     EXIT


00320000                      ENDO


00330000     WRITE MEMBER &SCREEN NOT FOUND IN '&ASMLOD'


00340000     EXIT


00350000      ENDO


00360000MEMSTAT '&ASMLOD(&SCREEN)'  NOPRINT


00370000


00380000ERROR DO


00390000      ERROR OFF


00400000      FREE F(FILEOUT) ATTR(AT1)


00410000      ATTR AT1 BLKSIZE(800) LRECL(80) RECFM(F,B)


00420000      ALLOC F(FILEOUT) DSN(&FULLANAL..SCREEN) NEW SPACE(1,1) TRA
T1)

00430000      RETURN


00440000      ENDO


00450000ALLOC F(FILEOUT) DSN(&FULLANAL..SCREEN)


00460000


00470000ERROR OFF


00480000SET &QUALNO1 = D&SUBSTR(1:2,&SYSDATE)&SUBSTR(4:5,&SYSDATE)&SUBST
YSDATE)

00490000SET &QUALNO2 = T&SUBSTR(1:2,&SYSTIME)&SUBSTR(4:5,&SYSTIME)&SUBST
YSTIME)

00500000FREE F(JOBSTREM) ATTR(AT5)


00510000ATTR AT5 BLKSIZE(80) LRECL(80) RECFM(F,B)


00520000ALLOC F(JOBSTREM) DSN(&FULLANAL..&QUALNO1..&QUALNO2..JOB) NEW -


00530000TRACKS SP(1,1) US(AT5)


00540000


00550000ALLOC F(LIBR) DSN('&ASMLOD') SHR


00560000


00570000IF &SYSPREF = CTEST THEN CALL 'WDPSC.SYSLIBRY(WAITER)' '10'


00580000


00590000ERROR DO


00600000      WRITE LASTCC IS &LASTCC


00610000      WRITE PLEASE NOTIFY TSO COORDINATOR OF ERROR 2 IN FULLSCRE
ZER.

00620000      EXIT


00630000      ENDO


00640000


00650003CALL 'WDPSC.SYSLIBRY(TUBE)' '&SCREEN'


00660000


00670000ERROR OFF


00680000


00690002IF &SCRUFLG = 0 AND &IOBUFLG = 0 AND &SCRNFLG = 0 THEN GOTO FAX


00700000


00710000KOMM RESET CLEAR


00720000


00730000IF &SCRUFLG NE 0 THEN DO


00740000     FREE F(SYS260J,SYSIN,SYS260A,SYSPRINT)


00750000     ALLOC F(SYSPRINT) DUMMY


00760000     ALLOC F(SYS260J) SYSOUT(A) &DEST


00770000     ALLOC F(SYS260A) DSN(&FULLANAL..&QUALNO1..&QUALNO2..JOB) SH


00780000     ALLOC F(SYSIN) DA('WDPSC.CARD(TUBEDYL)')


00790000     SET I = 0


00800000        DO WHILE &I < &SCRUFLG


00810000          SET I = &I+1


00820000          CALL 'WDPSC.SYSLIBRY(DYL260)'


00830000        ENDO


00840000     WRITE


00850000     IF &SCRUFLG = 1 THEN WRITE ONE COPY OF SCRUFF WAS PRINTED.


00860000                     ELSE +


00870000     WRITE &SCRUFLG COPIES OF SCRUFF WERE PRINTED.


00880000                      ENDO


00890000


00900000IF &IOBUFLG NE 0 THEN DO


00910000     FREE F(SYS260A,SYSIN,SYSPRINT)


00920000     ALLOC F(SYS260A) DSN(&FULLANAL..SCREEN) SHR


00930000     ALLOC F(SYSIN) DSN('WDPSC.CARD(TUBE)') SHR


00940000     ALLOC F(SYSPRINT) SYSOUT(A) &DEST


00950000     SET I = 0


00960000        DO WHILE &I < &IOBUFLG


00970000          SET I = &I+1


00980000          CALL 'WDPSC.SYSLIBRY(DYL260)'


00990000        ENDO


01000000     WRITE


01010000     IF &IOBUFLG = 1 THEN WRITE ONE COPY OF THE I/O BUFFERS WAS


01020000                     ELSE +


01030000     WRITE &IOBUFLG COPIES OF THE I/O BUFFERS WERE PRINTED.


01040000                      ENDO


01050000


01060000IF &IOBUFLG NE 0 OR &SCRUFLG NE 0 THEN DO


01070000     FREE F(SYSIN,SYSPRINT,SYS260J)


01080000     ALLOC F(SYSIN) DA(*)


01090000     ALLOC F(SYSPRINT) DA(*)


01100000                                       ENDO


01110000


01120000IF &SCRNFLG NE 0 THEN DO


01130000


01140000     GETMY PROG SYS ACCT          /*  FIND JOBCARD INFO   */


01150000


01160000     IF &STR(&PROG) = &STR(*TSO* 0000 T) THEN DO


01170000        WRITENR PLEASE ENTER YOUR PROGRAMMER NAME FIELD ==>


01180000        READ


01190000        SET &L = &LENGTH(&SYSDVAL)


01200000


01210000        IF &L GE 20 THEN  SET &PROG = &SUBSTR(1:20,&SYSDVAL)


01220000                    ELSE +


01230000                          SET &PROG = +


01240000           &STR(&SYSDVAL&SUBSTR(&L+1:20,&STR(*TSO* 0000 T


01250000


01260000        WRITE


01270000        WRITE TO AVOID BEING PROMPTED FOR PROGRAMMER NAME FIELD;


01280000        WRITE PLEASE USE THE PROG OPERAND ON AT LEAST ONE LOGON


01290000                                              ENDO


01300000


01310000       ERROR DO


01320000             ERROR OFF


01330000             COPY 'WDPSC.CARD(TUBE)' &FULLANAL..WORK


01340000             ERROR DO


01350000                   WRITE LASTCC IS &LASTCC.


01360000                   WRITE PLEASE NOTIFY TSO COORDINATOR OF ERROR
LSCREEN ANALYZER

01370000                   EXIT


01380000                   ENDO


01390000             ENDO


01400000


01410000     EDIT '&SYSPREF..&FULLANAL..WORK' OLD CNTL


01420000       ERROR DO


01430000             WRITE LASTCC IS &LASTCC.


01440000             WRITE PLEASE NOTIFY TSO COORDINATOR OF ERROR 4 IN F
N ANALYZER

01450000             END NOSAVE


01460000             EXIT


01470000             ENDO


01480000     TOP


01490000     DEL * 99999


01500000     SET JOBNAME = &SUBSTR(1:2,&SYSUID)F&SYS&SUBSTR(5:7,&SYSUID)


01510000     010 //&JOBNAME JOB (&ACCT),'&PROG',CLASS=A


01520000     030 /*ROUTE  PRINT LOCAL


01530000     040 //JOBCAT DD DSN=SYS1.USERCAT1,DISP=SHR


01540000     050 //*


01550000     060 //STEP1  EXEC  PGM=DYL260


01560000     070 //SYSPRINT DD  DUMMY


01570000     080 //SYS260A  DD DSN=&SYSPREF..&FULLANAL..&QUALNO1..&QUALN


01580000     085 //   DISP=(OLD,DELETE)


01590000     090 //SYS260R  DD  SYSOUT=A,FLASH=NULL,CHARS=TN,COPIES=&SCR


01600000     100 //SYSIN  DD  *


01610000     110 C


01620000     120 FA F


01630000     130 R011060100   1


01640000     140 T1 5


01650000     150 T2F5


01660000     160 P   10 U1         01        X


01670000     170 P   80 A1         11        X


01680000     180 P   10 U1         91        X


01690000     WRITE


01700000     IF &SCRNFLG = 1 THEN +


01710000     WRITE THE FOLLOWING JOB WILL PRINT ONE COPY OF THE SCREEN:


01720000                     ELSE +


01730000     WRITE THE FOLLOWING JOB WILL PRINT &SCRNFLG COPIES OF THE S


01740000     CONTROL MSG


01750000     IF &SYSPREF = CTEST THEN L


01760000                         ELSE SUB *


01770000     END NO


01770102     ERROR OFF


01771001     FREE DA('&SYSPREF..&FULLANAL..&QUALNO1..&QUALNO2..JOB') KEE


01780000                       ENDO


01800002FAX: IF &SCRNFLG = 0 THEN +


01810002     FREE DA('&SYSPREF..&FULLANAL..&QUALNO1..&QUALNO2..JOB') DEL


./ ADD NAME=HOSEDOWN 0107-81317-83276-0947-00161-00196-00000-JS02150
                    PROC 0 PANEL() MESSAGE() SKELETON() TABLEIN() TABLEO


                           TAILOUT() SPFLOAD() PRINT()





                    CONTROL NOMSG NOFLUSH END(ENDO)





                    IF &TABLEIN = AND +


                       &TABLEOUT = THEN GOTO ISPPLIB





                    IF &TABLEIN NE AND +


                       &TABLEOUT NE THEN GOTO DOTABLES





                    WRITE *****************************************


                    WRITE *  YOU MUST EITHER SPECIFY BOTH THE TABLE


                    WRITE *  INPUT AND OUTPUT LIBRARIES OR DO NOT


                    WRITE *  SPECIFY EITHER ONE AT ALL


                    WRITE *****************************************


                    GOTO ISPPLIB





        DOTABLES:   FREE F(ISPTABL)


                    FREE F(ISPTLIB)





                    IF &PRINT EQ YES THEN DO


                         WRITE &STR(TABLE INPUT LIBRARY DE-ALLOCATED)


                         WRITE &STR(TABLE OUTPUT LIBRARY DE-ALLOCATED)


                         ENDO





        ISPPLIB:    IF &PANEL = THEN GOTO ISPMLIB





                    SET &THEDSN = &PANEL


                    SET &WHICHONE = 1


                    SET &WHICHLIB = &STR(PANEL LIBRARY)


                    SET &DDNAM = ISPPLIB


                    SET &RETERN = ISPMLIB


                    GOTO FINFO





        ISPMLIB:    IF &MESSAGE = THEN GOTO ISPSLIB





                    SET &THEDSN = &MESSAGE


                    SET &WHICHONE = 2


                    SET &WHICHLIB = &STR(MESSAGE LIBRARY)


                    SET &DDNAM = ISPMLIB


                    SET &RETERN = ISPSLIB


                    GOTO FINFO





        ISPSLIB:    IF &SKELETON = THEN GOTO ISPFILE





                    SET &THEDSN = &SKELETON


                    SET &WHICHONE = 3


                    SET &WHICHLIB = &STR(SKELETON LIBRARY)


                    SET &DDNAM = ISPSLIB


                    SET &RETERN = ISPFILE


                    GOTO FINFO





        ISPFILE:    IF &TAILOUT = THEN GOTO ISPLLIB





                    FREE F(ISPFILE)





                    IF &PRINT EQ YES THEN DO


                          WRITE FILE TAILORING OUTPUT LIBRARY &STR(DE-AL


                          GOTO ISPLLIB


                          ENDO





        ISPLLIB:    IF &SPFLOAD = THEN GOTO KWIT





                    SET &THEDSN = &SPFLOAD


                    SET &WHICHONE = 7


                    SET &WHICHLIB = &STR(SPF LINK LIBRARY)


                    SET &DDNAM = ISPLLIB


                    SET &RETERN = KWIT


                    GOTO FINFO





        KWIT:       GOTO ENDIT





        FINFO:      FILEINFO DSN(&STR(&THEDSN))


                    SET &RC = &LASTCC





                    IF &RC EQ 96 THEN DO


                        WRITE ******************************************
*********

                        WRITE INVALID DSNAME SYNTAX OF &WHICHLIB


                        WRITE ******************************************
*********

                        GOTO EXITINFO


                        ENDO





                    IF &RC NE 0 THEN DO


                        WRITE ******************************************


                        WRITE &OUTMSG


                        WRITE ******************************************


                        GOTO EXITINFO


                        ENDO





                    IF &WHICHONE = 6 THEN GOTO FINFO2





                    IF &DSORG NE PO THEN DO


                        WRITE ******************************************


                        WRITE THE &WHICHLIB MUST BE PARTITIONED


                        WRITE ******************************************


                        GOTO EXITINFO


                        ENDO





                    IF &MEMCNTL EQ YES THEN DO


                        WRITE **************************


                        WRITE DO NOT PROVIDE MEMBER NAME


                        WRITE **************************


                        GOTO EXITINFO


                        ENDO





        FINFO2:     IF &WHICHONE NE 7 THEN GOTO FINFO3





                    IF &RECFM NE U THEN DO


                        WRITE ******************************************
****************

                        WRITE THE &WHICHLIB MUST CONTAIN UNDEFINED RECOR


                        WRITE ******************************************
****************

                        GOTO EXITINFO


                        ENDO





                    GOTO UNCONCAT





        FINFO3:     IF &RECFM NE F THEN DO


                        WRITE ******************************************
****************

                        WRITE THE &WHICHLIB MUST CONTAIN FIXED LENGTH RE


                        WRITE ******************************************
****************

                        GOTO EXITINFO


                        ENDO





                    IF &LRECL NE 80 THEN DO


                        WRITE ******************************************
*

                        WRITE LRECL OF &WHICHLIB MUST BE 80


                        WRITE ******************************************
*

                        GOTO EXITINFO


                        ENDO





                    IF &WHICHONE = 4 OR +


                       &WHICHONE = 5 OR +


                       &WHICHONE = 6 THEN GOTO UNCONCAT





                    IF &BLKSIZE LT 3120 THEN DO


                        WRITE ******************************************


                        WRITE BLOCK SIZE OF &WHICHLIB


                        WRITE GREATER THAN OR EQUAL TO 3120


                        WRITE ******************************************


                        GOTO EXITINFO


                        ENDO





        UNCONCAT:   CONCATEM ACTCODE(D) DDNAME(&DDNAM) DSNAME('&FULLDSN'


                    SET &RC = &LASTCC





                    IF &PRINT NE YES THEN GOTO EXITINFO





                    IF &RC = 0 THEN DO


                          WRITE &WHICHLIB &STR(DE-ALLOCATED)


                          GOTO EXITINFO


                          ENDO





                    WRITE **********************************************


                    WRITE &OUTMSG


                    WRITE        (RETURN CODE = &RC)


                    WRITE **********************************************





        EXITINFO:   GOTO &RETERN





        ENDIT:      EXIT


./ ADD NAME=LASTLINK 0105-82127-83279-0852-00187-00187-00000-JS02150
                   PROC 0 VOL()


                   KOMM RESET CLEAR


                   CONTROL NOMSG NOFLUSH END(ENDO)





                   SET &ZEEVOL =


                   IF &VOL NE  THEN DO


                       SET &ZEEVOL = &STR(VOL(&VOL))


                       ENDO





        ERR1:   ERROR DO


                    WRITE


                    WRITE ***********************************


                    WRITE *  INVALID SYNTAX OF DATASET NAME *


                    WRITE ***********************************


                    CALL 'WDPSC.SHARED.LOAD(NEWWAIT)' '5'


                    KOMM RESET CLEAR


                    GOTO GETDSN


                    ENDO





        GETDSN: WRITE


                WRITE ENTER DATASET NAME OF LOAD MODULE LIBRARY


                WRITE   (UNQUOTED DATASET WILL HAVE PREFIX APPENDED)


                WRITE


                WRITENR ENTER DSN HERE ==>


                READ


                SET &DSN = &STR(&SYSDVAL)





                KOMM RESET CLEAR





        ERR2:   ERROR DO


                    WRITE


                    WRITE **********************************


                    WRITE *  INVALID SYNTAX OF MEMBER NAME *


                    WRITE **********************************


                    CALL 'WDPSC.SHARED.LOAD(NEWWAIT)' '5'


                    KOMM RESET CLEAR


                    GOTO GETMEM


                    ENDO





        GETMEM: WRITE


                WRITENR ENTER MEMBER NAME ===>


                READ &MEMNAME





        FINFO:  ERROR OFF


                FILEINFO DSN(&STR(&DSN)) &ZEEVOL MEM(&STR(&MEMNAME))


                SET &MYCC = &LASTCC





                IF &MYCC EQ 96 THEN DO


                    WRITE


                    WRITE ***********************************


                    WRITE *  INVALID SYNTAX OF DATASET NAME *


                    WRITE ***********************************


                    CALL 'WDPSC.SHARED.LOAD(NEWWAIT)' '5'


                    KOMM RESET CLEAR


                    GOTO ERR1


                    ENDO





                IF &MYCC EQ 48 THEN DO


                    WRITE


                    WRITE **********************************


                    WRITE *  INVALID SYNTAX OF MEMBER NAME *


                    WRITE **********************************


                    CALL 'WDPSC.SHARED.LOAD(NEWWAIT)' '5'


                    KOMM RESET CLEAR


                    GOTO ERR2


                    ENDO





                IF &MYCC = 28 THEN GOTO ALLOCIT





                IF &MYCC = 24 THEN DO


                    WRITE


                    WRITE *****************************


                    WRITE *   MEMBER NAME NOT FOUND   *


                    WRITE *****************************


                    CALL 'WDPSC.SHARED.LOAD(NEWWAIT)' '5'


                    KOMM RESET CLEAR


                    GOTO ERR2


                    ENDO





                IF &MYCC NE 0 THEN DO


                    WRITE


                    WRITE ******************************


                    WRITE &OUTMSG


                    WRITE ******************************


                    CALL 'WDPSC.SHARED.LOAD(NEWWAIT)' '5'


                    KOMM RESET CLEAR


                    GOTO ERR1


                    ENDO





                IF &DSORG NE PO THEN DO


                    WRITE


                    WRITE **********************************


                    WRITE *   LOAD MODULE LIBRARY MUST BE  *


                    WRITE *   A PARTITIONED DATASET        *


                    WRITE **********************************


                    CALL 'WDPSC.SHARED.LOAD(NEWWAIT)' '5'


                    KOMM RESET CLEAR


                    GOTO ERR1


                    ENDO





                IF &RECFM NE U THEN DO


                    WRITE


                    WRITE **********************************


                    WRITE *   LOAD MODULE LIBRARY MUST     *


                    WRITE *   HAVE RECFM=U                 *


                    WRITE *                                *


                    WRITE *   THIS DATASET MUST NOT BE     *


                    WRITE *   A LOAD MODULE LIBRARY        *


                    WRITE **********************************


                    CALL 'WDPSC.SHARED.LOAD(NEWWAIT)' '5'


                    KOMM RESET CLEAR


                    GOTO ERR1


                    ENDO





                   SET &LODLIB = &FULLDSN


                   GOTO DOIT





        ALLOCIT: DEVTYPE VOL(&VOL)


                 IF &LASTCC NE 0 THEN DO


                    WRITE


                    WRITE **********************************


                    WRITE &OUTMSG


                    WRITE **********************************


                    EXIT


                    ENDO





                 FREE F(FINDMEDD)


                 ALLOC F(FINDMEDD) DA('&FULLDSN') SHR -


                 VOL(&VOL) UNIT(&DEVTYP)


                 IF &LASTCC NE 0 THEN DO


                    WRITE


                    WRITE ***************************************


                    WRITE UNSUCCESSFUL ALLOCATION OF LOAD LIBRARY


                    WRITE ***************************************


                    EXIT


                    ENDO





                 GOTO FINFO





        DOIT:      FREE F(SYSIN)


                   ALLOC F(SYSIN) NEW SPACE(1,1) BLK(80)


                   OPENFILE SYSIN OUTPUT


                   SET &SYSIN = &STR( LISTIDR MEMBER=&MEMNAME)


                   PUTFILE SYSIN


                   CLOSFILE SYSIN


                   FREE F(SYSPRINT SYSLIB)


                   ERROR DO


                        CONTROL MSG


                        ALLOC F(SYSPRINT) DSN('&SYSUID..LASTLINK.SYSPRIN


                        NEW SPACE(1,1) TRACKS UNIT(SYSDA)


                        CONTROL NOMSG


                        ERROR OFF


                        GOTO CONT1


                        ENDO


                   ALLOC F(SYSPRINT) DA('&SYSUID..LASTLINK.SYSPRINT') SH


                   ERROR OFF


        CONT1:     CONTROL MSG


                   DEVTYPE VOL(&VOLSER)


                   IF &LASTCC NE 0 THEN DO


                      WRITE


                      WRITE **********************************


                      WRITE &OUTMSG


                      WRITE **********************************


                      EXIT


                      ENDO





                   SET &VOLPAR = &STR(VOL(&VOLSER))


                   SET &UNIT = &STR(UNIT(&DEVTYP))


                   ALLOC F(SYSLIB) DA('&LODLIB') SHR &VOLPAR &UNIT


                   CONTROL NOMSG


                   KOMM RESET CLEAR


                   WRITE


                   CALL 'SYS1.LINKLIB(AMBLIST)'


                   FREE F(SYSIN SYSPRINT SYSLIB)


                   FREE F(SYS260A,SYS260J)


                   FREE ATTRLIST(SYSJATTR)


                   ATTR SYSJATTR RECFM(F) LRECL(80) BLKSIZE(80)


                   CONTROL MSG


                   ALLOC F(SYS260A) DA('&SYSUID..LASTLINK.SYSPRINT') SHR


                   ALLOC F(SYS260J) DSN(*) USING(SYSJATTR)


                   ALLOC F(SYSPRINT) DUMMY


                   ALLOC F(SYSIN) DA('WDPSC.MASTER.CLIST.PARMS(LLINKDYL)


                   CALL 'WDPSC.SYSLIBRY(DYL260)'


                   CONTROL NOMSG


                   FREE F(SYSIN SYSPRINT)


                   ALLOC F(SYSIN) DSN(*)


                   ALLOC F(SYSPRINT) DSN(*)


./ ADD NAME=NEWSPF   0120-83272-84173-1816-00089-00149-00016-KK00150
00010004PROC 0 L PROFDSN(NONE) F MYCMD T NC TABL SETUP CLEANUP


00020000CONTROL MAIN END(ENDO)


00030000IF &L = L THEN CONTROL LIST MSG CONLIST


00030120IF &SYSPREF = KX00150 THEN CONTROL MSG LIST CONLIST


00031000


00031105IF &CLEANUP = CLEANUP THEN GOTO MRCLEAN


00032003


00081100/*************************************************************/


00081200/*  IF THE USER WANTS TO ENTER A DIFFERENT COMMAND STRING... */


00081300/*************************************************************/


00081400IF &MYCMD = MYCMD THEN DO


00081500        WRITE ENTER ISPF INVOCATION COMMAND:


00081600        READ


00081700                       ENDO


00081800                  ELSE +


00081900        SET &SYSDVAL = PDF


00082000


00083000/*************************************************************/


00090000/*  IF ISPPROF IS ALREADY ALLOCATED, ASSUME CONVERSION DONE: */


00090100/*************************************************************/


00100000IFALC F(ISPPROF)


00110000IF &LASTCC = 0 THEN GOTO CHEKLIBS


00111000


00112000/*************************************************************/


00120000/*  IF ISPPROF LIB EXISTS, ASSUME CONVERSION DONE:           */


00120100/*************************************************************/


00121000IF &PROFDSN = NONE THEN +


00122019     IF &SYSUID = &SYSPREF OR &SYSPREF = &STR() +


00122119                           THEN SET &PROFDSN = &SYSUID..ISPF.ISP


00123000                           ELSE SET &PROFDSN = &SYSPREF..&SYSUID
SPPROF

00124000CONTROL NOMSG


00130000ALLOC DDN(ISPPROF) DSN('&PROFDSN')


00140000IF &LASTCC = 0 THEN GOTO CHEKLIBS


00141000


00141100/*************************************************************/


00142000/* USER PROFILE LIB DOES NOT EXIST; WE MUST BUILD IT:        */


00143000/*************************************************************/


00144000FREE ATTR(KKISPRO)


00145000CONTROL MSG


00150000ATTR KKISPRO RECFM(F B) LRECL(80) BLKSIZE(3120)


00160000ALLOC DDN(ISPPROF) DSN('&PROFDSN') NEW CATALOG TRACK SP(1 1) DIR


00170000      USING(KKISPRO) UNIT(3350) VOL(SYS018)


00171000IF &LASTCC NE 0 THEN DO


00172000      WRITE ERROR ALLOCATING PROFILE DATASET (USER PARMS)


00172112      WRITE PLEASE CONTACT WDPSC CUSTOMER TECHNICAL SUPPORT AT 3


00172218      ALLOC DDN(ISPPROF) DUMMY


00173000      EXIT


00180000                     ENDO


00181000


00182000/*************************************************************/


00190000/* NEW PROFILE LIB ALLOCATED, NOW TRY TO CONVERT OLD PARMS:  */


00190112/* 02/09/84 - SPFMVS GONE, NO CONVERSION ALLOWED NOW.......  */


00191000/*************************************************************/


00370000


00371000/*************************************************************/


00380000/* NOW WE CHECK IF ISPF LIBS ARE PRESENT:                    */


00381000/*************************************************************/


00400100CHEKLIBS: CONTROL MSG


00414112/*               ALLOCATE ANY NEW LIBS THAT AREN'T THERE:  ***/


00440000SPFCONC DDN(ISPPLIB) DSN('SYS1.ISP.PROD.ISPPLIB')


00460000SPFCONC DDN(ISPSLIB) DSN('SYS1.ISP.PROD.ISPSLIB')


00480000SPFCONC DDN(ISPMLIB) DSN('SYS1.ISP.PROD.ISPMLIB')


00490000SPFCONC DDN(ISPTLIB) DSN('SYS1.ISP.PROD.ISPTLIB')


00520100/*                                                           */


00520200/*  THEN ALLOCATE TEST LIBRARIES IF REQUESTED:             ***/


00521000IF &T = T THEN DO


00521300  SPFCONC DDN(ISPPLIB) DSN('SYS1.ISP.LOCAL.ISPPLIB')


00521400  SPFCONC DDN(ISPSLIB) DSN('SYS1.ISP.LOCAL.ISPSLIB')


00521500  SPFCONC DDN(ISPMLIB) DSN('SYS1.ISP.LOCAL.ISPMLIB')


00521600  SPFCONC DDN(ISPTLIB) DSN('SYS1.ISP.LOCAL.ISPTLIB')


00521700  IF &TABL = TABL THEN +


00521800  SPFCONC DDN(ISPTABL) DSN('SYS1.ISP.LOCAL.ISPTLIB')


00521900               ENDO


00522000


00523000/*************************************************************/


00530107/*  THEN WE CAN ISSUE THE ISPF/PDF COMMAND IF NEEDED:        */


00530200/*************************************************************/


00531000NEWSPF: +


00535100     IF &SETUP = SETUP THEN EXIT


00535507     IF &NC = NC THEN GOTO MRCLEAN


00535600     STACK T(ISPLLIB)


00535700     &SYSDVAL


00536100


00552000/*************************************************************/


00553007/* THIS SECTION IS USED WHILE SPFMVS IS PRODUCTION VERSION.  */


00553107/* PUT THE OLD SPF LIBS BACK IN PLACE NOW:                   */


00554000/*************************************************************/


00555005MRCLEAN: +


00555209EXIT    /* PDF IS NOW PRODUCTION VERSION  */


./ ADD NAME=RLSE     0119-77004-84104-0902-00017-00004-00017-JS02150
00000116PROC 1 DSN CYLS CYL VOL(NONE)


00000210CONTROL NOFLUSH END(ENDO) NOMSG


00000419STACK


00000519CLOG '&SYSDATE &SYSTIME RLSE' U($$$#150) SAVE


00000617FREE F(REL)


00000710CONTROL MSG


00000802IF &CYL.K NE K THEN SET CYL = &STR(CYL SP(1))


00000910               ELSE +


00001010IF &CYLS.K NE K THEN SET CYL = &STR(CYL SP(1))


00001110ERROR DO


00001210      WRITE RLSE FAILED - CHECK YOUR DSNAME


00001310      EXIT


00001410      ENDO


00002316IF &VOL EQ NONE +


00002416          THEN ALLOC F(REL) DA(&DSN.) MOD KEEP RELEASE &CYL


00002516          ELSE ALLOC F(REL) DA(&DSN.) MOD KEEP RELEASE &CYL VOL(


00003012CALL 'WDPSC.SYSLIBRY(RELSEQ)'


./ ADD NAME=SPFBATU  0100-83318-83318-1449-00148-00148-00000-KK00150
00010000PROC 0 FI(NONE) L SF(Y)


00020000CONTROL NOFLUSH   MSG END(ENDO)


00030000IF &L = L THEN CONTROL MSG LIST CONLIST  /* */


00040000GLOBAL GCRC GCVOL GCDEVT


00050000GLOBAL EMSG


00060000ERROR DO


00070000      %ERRORMSG &LASTCC


00080000      GOTO MAINLOOP


00090000      ENDO


00100000/* */


00110000/*   INITIALIZE VARIABLES FIRST:                         */


00120000/* */


00130000SET EMSG = &STR()


00131000SET OPT = &STR()


00140000SET &CDCUR = MEMBER


00150000ISPEXEC VGET (PRJ0 LIB0 TYP0 DSN) PROFILE


00160000/* */


00170000/*   DISPLAY OPTION/DATA PANEL:                         */


00180000/* */


00190000MAINLOOP: GOTO DISPLAY


00200000DISPLAY: ERROR OFF


00210000CONTROL MSG NOLIST NOCONLIST


00220000ISPEXEC DISPLAY PANEL(SPFBATU) CURSOR(&CDCUR)


00230000   SET DRC = &LASTCC


00231000IF &L = L THEN CONTROL MSG LIST CONLIST  /* */


00240000   IF &DRC NE 0 THEN DO


00250000         IF &FI NE NONE THEN %CMDOUT FREE(&FI)


00260000         ISPEXEC VPUT (PRJ0 LIB0 TYP0 DSN) PROFILE


00261000         FREE F(SYSIN)


00262000         ALLOC F(SYSIN) DA(*)


00270000         EXIT


00280000                     ENDO


00290000SET EMSG = &STR()


00291000IF &OPT = U THEN GOTO OPTVER


00300000IF &FI = NONE THEN DO


00310000              CONTROL NOMSG


00320000              FREE ATTR(KKKASBU)


00330000              ATTR KKKASBU RECFM(F,B) LRECL(121) BLK(1210)


00340000              CONTROL MSG


00350000              %CMDOUT DDN(SYSPRINT) USE(KKKASBU) FORCE &L


00360000              SET &FI = &LASTCC


00370000              IF &FI = 99 THEN DO


00380000                  SET FI = NONE


00390000                  SET EMSG = ERROR ALLOCATING CMD FILE


00400000                  GOTO MAINLOOP


00410000                               ENDO


00420000              OPENFILE SYSPRINT OUTPUT


00430000              CLOSFILE SYSPRINT


00440000              SET SVOL = &VOL


00450000              WHATDSN DDN(SYSPRINT)


00460000              SET VOL = &SVOL


00470000                   ENDO


00480000GOTO OPTVER     /* VERIFY PARMS ENTERED   */


00490000


00500000OPTSEL:GOTO OPT&OPT


00511000


00520000ENDOPT: +


00530000CALL 'WDPSC.CMDLIB(CLRSPFIO)'


00540000ISPEXEC EDIT DATASET('&DSNAME.')


00550000OPENFILE SYSPRINT OUTPUT


00560000CLOSFILE SYSPRINT


00561000SET CDCUR = MEMBER


00570000GOTO MAINLOOP


00580000


00590000/*   OPTVER VERIFICATION SUBROUTINE:   */


00600000


00610000OPTVER: +


00610100 IF &OPT NE Z AND &OPT NE U AND &MEMBER = THEN DO


00610200     SET CDCUR = MEMBER


00610300     SET EMSG = ENTER MEMBER NAME


00610400     GOTO MAINLOOP


00610500                                 ENDO


00610600 IF &DSN = THEN SET &LIB = '&PRJ0..&LIB0..&TYP0'


00610700           ELSE SET &LIB = &DSN


00610800 SET &VO =


00610900 SET &MO =


00611000 IF &VOL NE &STR() THEN SET VO = VOL(&VOL)


00611100 IF &MEMBER NE &STR() THEN SET MO = MEM(&MEMBER)


00611200 FILEINFO DSN(&LIB) &VO &MO


00611300 SET &FRC = &LASTCC


00611400 IF &FRC NE 0 THEN DO


00611500       IF &FRC = 24 THEN SET CDCUR = MEMBER


00611600                    ELSE IF &DSN = THEN SET CDCUR = PRJ0


00611700                                   ELSE SET CDCUR = DSN


00611800       SET EMSG = &STR(&OUTMSG)


00611900       GOTO MAINLOOP


00612000                   ENDO


00612100 IF &MEMCNTL = YES THEN DO


00612200       SET CDCUR = DSN


00612300       SET EMSG = MEMBER NAME NOT ALLOWED HERE


00612400       GOTO MAINLOOP


00612500                        ENDO


00613000GOTO OPTSEL


00620000


00623100OPTU: STACK


00624500URZAP '&FULLDSN' &VO


00624600KOMM RES(1)


00624700ISPEXEC CONTROL DISPLAY REFRESH


00624800GOTO MAINLOOP


00624900


00625000OPTZ: +


00625100CONTROL NOMSG


00625200FREE F(SYSIN)


00625300CONTROL MSG


00625400ALLOC F(SYSIN) DA(*)


00625500IF &VOL = &STR() THEN GOTO FREELIB


00625600IFALC F(SYSLIB) DA('&FULLDSN')


00625700IF &LASTCC = 0 THEN GOTO CALLZAP


00625800FREELIB: CONTROL NOMSG


00625900FREE F(SYSLIB)


00626000CONTROL MSG


00626100IF &VOL = &STR() THEN ALLOC F(SYSLIB) DA('&FULLDSN') SHR


00626200                 ELSE ALLOC F(SYSLIB) DA('&FULLDSN') VOL(&VOL.)
(SYSALLDA)

00626300CALLZAP: ISPEXEC CONTROL DISPLAY SM START(1)


00626400         CALL 'SYS1.LINKLIB(AMASPZAP)'


00626500GOTO ENDOPT


00626600


00626700OPTI: GOTO OPTB


00626800OPTD: GOTO OPTB


00627000


00630000OPTB: +


00631000IF &VOL = &STR() THEN GOTO FREELIB2


00641000CONTROL NOMSG


00642000FREE F(SYSLIB SYSIN)


00643000GOTO ALLOCS


00650000FREELIB2: CONTROL NOMSG


00660000FREE F(SYSIN)


00670000ALLOCS: CONTROL MSG


00680000ALLOC F(SYSIN) SP(1) TRACK


00681000IFALC F(SYSLIB) DA('&FULLDSN')


00682000IF &LASTCC = 0 THEN GOTO BILDCTL


00683000CONTROL NOMSG


00684000FREE F(SYSLIB)


00685000CONTROL MSG


00690000IF &VOL = &STR() THEN ALLOC F(SYSLIB) DA('&FULLDSN') SHR


00700000                 ELSE ALLOC F(SYSLIB) DA('&FULLDSN') VOL(&VOL.)
(SYSALLDA)

00710000BILDCTL: OPENFILE SYSIN OUTPUT


00711000IF &OPT = I THEN +


00711100       SET SYSIN = &STR( LISTIDR OUTPUT=ALL,MEMBER=&MEMBER)


00713000IF &OPT = B THEN +


00720000       SET SYSIN = &STR( LISTLOAD OUTPUT=XREF,MEMBER=&MEMBER)


00720100IF &OPT = D THEN +


00722000       SET SYSIN = &STR( DUMPT &MEMBER &CSECT)


00730000PUTFILE SYSIN


00740000CLOSFILE SYSIN


00741000IF &OPT = D THEN CALL 'SYS1.LINKLIB(AMASPZAP)'


00750000            ELSE CALL 'SYS1.LINKLIB(AMBLIST)'


00780000GOTO ENDOPT


./ ADD NAME=SPFCATCC 0102-84079-84079-1143-00273-00274-00003-KK00150
00010000PROC 0 TYPE(C) L CAT(NONE)


00020000CONTROL NOFLUSH NOMSG END(ENDO)


00021000IF &L = L THEN CONTROL MSG LIST CONLIST


00022000   /**********************************************************/


00022100   /* VERIFY THAT INPUT AND OUTPUT FILES ARE ALLOCATED:      */


00022200   /**********************************************************/


00023000ERROR EXIT CODE(99)


00030000IFALC F(BILDLIST)


00040000IFALC F(SYSIN)


00121000   /**********************************************************/


00122000   /* CALL THE INITALIZATION SUBROUTINE FOR VARIABLES:       */


00123000   /**********************************************************/


00124000GOTO INITVARS


00130000INITDONE: CONTROL NOFLUSH


00131000   /**********************************************************/


00132000   /* ESTABLISH END OF FILE EXIT ROUTINE:                    */


00133000   /**********************************************************/


00140000ERROR DO


00150000  ERROR OFF


00160000  CLOSFILE BILDLIST


00170000  CLOSFILE SYSIN


00180000  EXIT


00190000      ENDO


00191000   /**********************************************************/


00192000   /* OPEN THE INPUT AND OUTPUT FILES:                       */


00193000   /**********************************************************/


00200000OPENFILE BILDLIST INPUT


00210000OPENFILE SYSIN OUTPUT


00211000


00220000   /**********************************************************/


00221000   /**********************************************************/


00230000   /* BEGIN MAIN PROCESSING LOOP:                            */


00231000   /* LOOP READING THE IDCAMS LISTING FOR KNOWN ENTRIES:     */


00232000   /* PERFORM SEPARATE SUBROUTINE FOR NVSAM,ALIAS,GDG:       */


00240000   /**********************************************************/


00241000   /**********************************************************/


00250000LOOP: +


00260000 GETFILE BILDLIST


00270000 LOOP1:   IF &SUBSTR(1,&STR(&BILDLIST)) = &STR( ) THEN GOTO LOOP


00280000 SET &SYSDVAL = &STR(&BILDLIST)


00290000 READDVAL P1 P2 P3 P4


00310000   /**********************************************************/


00320000   /*                                    STANDARD NONVSAM:   */


00330000   /**********************************************************/


00350000 IF &STR(&P1) = NONVSAM THEN GOTO NVSAM


00370000   /**********************************************************/


01200000 /*                                      STANDARD GDG:       */


01201000   /**********************************************************/


01202000 IF &STR(&P1) = GDG THEN GOTO GDG


01204000   /**********************************************************/


01205000 /*                                      STANDARD ALIAS:     */


01206000   /**********************************************************/


01207000 IF &STR(&P1) = ALIAS THEN GOTO ALIAS


01210000GOTO LOOP


01210100


01210300   /**********************************************************/


01210400   /*          INDIVIDUAL ENTRY SUBROUTINES:                 */


01210500   /**********************************************************/


01210600


01210700   /**********************************************************/


01210800   /*                                    STANDARD NONVSAM:   */


01210900   /**********************************************************/


01211202NVSAM: SET DSN = &STR(&P3)


01211300   /**********************************************************/


01211400   /*                FIRST FIND THE VOLSER RECORD:           */


01211500   /**********************************************************/


01211600   FINDV: +


01211700          GETFILE BILDLIST


01211800          IF &SUBSTR(1,&STR(&BILDLIST)) NE &STR( ) THEN GOTO LOO


01211900          SET &SYSDVAL = &STR(&BILDLIST)


01212000          READDVAL P1 P2 P3 P4


01212100          IF &STR(&P1) NE &STR(VOLUMES) THEN GOTO FINDV


01212200          GETFILE BILDLIST


01212300          SET &SYSDVAL = &STR(&BILDLIST)


01212400          READDVAL P1 P2 P3 P4


01212500          SET VOL = &SUBSTR(19:&LENGTH(&STR(&P1)),&STR(&P1))


01212600          DO WHILE &SUBSTR(1,&STR(&VOL)) = &STR(-)


01212700             SET VOL = &SUBSTR(2:&LENGTH(&STR(&VOL)),&STR(&VOL))


01212800             ENDO


01212900          SET DEV = &SUBSTR(16:&LENGTH(&STR(&P1))-1,&STR(&P2))


01213000   /**********************************************************/


01213100   /*                THEN  FIND THE DEVICE TYPE:             */


01213200   /**********************************************************/


01213300          SET DT = &STR(&D&DEV)


01213400   /*     DEVTYPE VOL(&VOL)   */


01213500          IF &LASTCC NE 0 THEN DO


01213600              SET SYSIN = &STR(***** &VOL ***** ERROR ==> &OUTMS


01213700              PUTFILE SYSIN


01213800              GOTO LOOP


01213900                               ENDO


01214000


01214100   /**********************************************************/


01214200   /*                THEN  BUILD THE DESIRED CTL CARD:       */


01214300   /**********************************************************/


01214400          IF &TYPE = D THEN SET SYSIN = &STR( DEL '&DSN' )


01214500                       ELSE  +


01214600          IF &TYPE = U THEN SET SYSIN = &STR( DEL '&DSN' NSCR)


01214700                       ELSE  DO


01214800          SET SYSIN = &STR( DEF NVSAM&LP. NAME('&DSN') +)


01214900                              PUTFILE SYSIN


01215000/*        SET SYSIN = &STR(           VOL(&VOL) DEVT(&DEVTYP) &R


01215100          SET SYSIN = &STR(           VOL(&VOL) DEVT(&DT) &RP)


01215200                             ENDO


01215300   /**********************************************************/


01215400   /*                THEN  WRITE SYSIN DESIRED CTL CARD:     */


01215500   /**********************************************************/


01215600          IF &STR(&CAT) = NONE THEN PUTFILE SYSIN


01215700                         ELSE DO


01215800                         SET &SYSIN = &STR(&SYSIN)&STR( +)


01215900                              PUTFILE SYSIN


01216000                         SET &SYSIN = &STR(   )&STR(CAT(&CAT))


01216100                              PUTFILE SYSIN


01216200                              ENDO


01216300   /**********************************************************/


01216400   /*   NOW SEE IF ANY ALIASES NEED TO BE MOVED:             */


01216500   /**********************************************************/


01216600          GETFILE BILDLIST


01216700          IF &SUBSTR(1,&STR(&BILDLIST)) NE &STR( ) THEN GOTO LOO


01216800          SET &SYSDVAL = &STR(&BILDLIST)


01216900          READDVAL P1 P2 P3 P4


01217000          IF &STR(&P1) = &STR(ASSOCIATIONS--------(NULL)) THEN G


01217100          IF &TYPE = D THEN GOTO LOOP


01217200          IF &TYPE = U THEN GOTO LOOP


01217300   /**********************************************************/


01217400   /*   LOOP2   IF ANY ALIASES NEED TO BE MOVED:             */


01217500   /**********************************************************/


01217600  LOOP2:  GETFILE BILDLIST


01217700          IF &SUBSTR(1,&STR(&BILDLIST)) NE &STR( ) THEN GOTO LOO


01217800          SET &SYSDVAL = &STR(&BILDLIST)


01217900          READDVAL P1 P2 P3 P4


01218000          IF &STR(&P1) = NONVSAM THEN GOTO LOOP1


01218100          IF &SUBSTR(1:9,&STR(&P1)) = &STR(ALIAS----) THEN DO


01218200             SET AN = &SUBSTR(10:&LENGTH(&STR(&P1)),&STR(&P1))


01218300             SET SYSIN = &STR( DEF ALIAS&LP. NAME('&AN') +)


01218400                              PUTFILE SYSIN


01218500             SET SYSIN = &STR(           REL('&DSN') &RP)


01218600          IF &STR(&CAT) = NONE THEN PUTFILE SYSIN


01218700                         ELSE DO


01218800                         SET &SYSIN = &STR(&SYSIN)&STR( +)


01218900                              PUTFILE SYSIN


01219000                         SET &SYSIN = &STR(   )&STR(CAT(&CAT))


01219100                              PUTFILE SYSIN


01219200                              ENDO


01219300                                                           ENDO


01219400          GOTO LOOP2


01219500   /**********************************************************/


01219600   /*      END OF NVSAM ENTRY CODE                           */


01219700   /**********************************************************/


01219800


01219900


01220000   /**********************************************************/


01220100   /*                                    STANDARD GDG:       */


01220200   /**********************************************************/


01220401GDG:      SET DSN = &STR(&P4)


01220500   /**********************************************************/


01220600   /*                FIRST FIND THE ATTR   RECORD:           */


01220700   /**********************************************************/


01220800   FINDA: +


01220900          GETFILE BILDLIST


01221000          IF &SUBSTR(1,&STR(&BILDLIST)) NE &STR( ) THEN GOTO LOO


01221100          SET &SYSDVAL = &STR(&BILDLIST)


01221200          READDVAL P1 P2 P3 P4


01221300          IF &STR(&P1) NE &STR(ATTRIBUTES) THEN GOTO FINDA


01221400          GETFILE BILDLIST


01221500          SET &SYSDVAL = &STR(&BILDLIST)


01221600          READDVAL P1 P2 P3 P4


01221700          SET LIM = &SUBSTR(20:&LENGTH(&STR(&P1)),&STR(&P1))


01221800          DO WHILE &SUBSTR(1,&STR(&LIM)) = &STR(-)


01221900             SET LIM = &SUBSTR(2:&LENGTH(&STR(&LIM)),&STR(&LIM))


01222000             ENDO


01222100          SET SCR = &P2


01222200          SET EMO = &P3


01223300


01223400   /**********************************************************/


01223500   /*                THEN  BUILD THE DESIRED CTL CARD:       */


01223600   /**********************************************************/


01223700          IF &TYPE = D THEN SET SYSIN = &STR( DEL '&DSN' )


01223800                       ELSE  +


01223900          IF &TYPE = U THEN SET SYSIN = &STR( DEL '&DSN' NSCR)


01224000                       ELSE  DO


01224100          SET SYSIN = &STR( DEF GDG&LP. NAME('&DSN') +)


01224200                              PUTFILE SYSIN


01224300          SET SYSIN = &STR(           LIM(&LIM) &SCR &EMO &RP)


01224500                             ENDO


01224600   /**********************************************************/


01224700   /*                THEN  WRITE SYSIN DESIRED CTL CARD:     */


01224800   /**********************************************************/


01224900          IF &STR(&CAT) = NONE THEN PUTFILE SYSIN


01225000                         ELSE DO


01225100                         SET &SYSIN = &STR(&SYSIN)&STR( +)


01225200                              PUTFILE SYSIN


01225300                         SET &SYSIN = &STR(   )&STR(CAT(&CAT))


01225400                              PUTFILE SYSIN


01225500                              ENDO


01225600   GOTO LOOP


01225700   /**********************************************************/


01225800   /*      END OF GDG ENTRY CODE                             */


01225900   /**********************************************************/


01229000


01229100


01229200   /**********************************************************/


01229300   /*                                    STANDARD ALIAS:     */


01229400   /**********************************************************/


01229501ALIAS:    SET DSN = &STR(&P3)


01229600   /**********************************************************/


01229700   /*                FIRST FIND THE REL    RECORD:           */


01229800   /**********************************************************/


01229900   FINDR: +


01230000          GETFILE BILDLIST


01230100          IF &SUBSTR(1,&STR(&BILDLIST)) NE &STR( ) THEN GOTO LOO


01230200          SET &SYSDVAL = &STR(&BILDLIST)


01230300          READDVAL P1 P2 P3 P4


01230400          IF &STR(&P1) NE &STR(ASSOCIATIONS) THEN GOTO FINDR


01230500          GETFILE BILDLIST


01230600          SET &SYSDVAL = &STR(&BILDLIST)


01230700          READDVAL P1 P2 P3 P4


01230800          SET REL = &SUBSTR(10:&LENGTH(&STR(&P1)),&STR(&P1))


01231400


01231500   /**********************************************************/


01231600   /*                THEN  BUILD THE DESIRED CTL CARD:       */


01231700   /**********************************************************/


01231800          IF &TYPE = D THEN SET SYSIN = &STR( DEL '&DSN' )


01231900                       ELSE  +


01232000          IF &TYPE = U THEN SET SYSIN = &STR( DEL '&DSN' NSCR)


01232100                       ELSE  DO


01232200          SET SYSIN = &STR( DEF ALIAS&LP. NAME('&DSN') +)


01232300                              PUTFILE SYSIN


01232400          SET SYSIN = &STR(           REL('&REL') &RP)


01232500                             ENDO


01232600   /**********************************************************/


01232700   /*                THEN  WRITE SYSIN DESIRED CTL CARD:     */


01232800   /**********************************************************/


01232900          IF &STR(&CAT) = NONE THEN PUTFILE SYSIN


01233000                         ELSE DO


01233100                         SET &SYSIN = &STR(&SYSIN)&STR( +)


01233200                              PUTFILE SYSIN


01233300                         SET &SYSIN = &STR(   )&STR(CAT(&CAT))


01233400                              PUTFILE SYSIN


01233500                              ENDO


01233600   GOTO LOOP


01233700   /**********************************************************/


01233800   /*      END OF ALIAS ENTRY CODE                           */


01233900   /**********************************************************/


01234000


01234100   /**********************************************************/


01234200   /**********************************************************/


01234300   /* INITIALIZE VARIABLES SUBROUTINE :                      */


01234400   /**********************************************************/


01234500   /**********************************************************/


01234600INITVARS: +


01235000SET &LP = &SUBSTR(1,&STR(()))


01240000SET &RP = &SUBSTR(2,&STR(()))


01250000SET &D = &STR(&&D)


01260000SET D30502009 = &STR(3330)


01270000SET D3050200D = &STR(3330-1)


01280000SET D3050200B = &STR(3350)


01290000SET D3010200E = &STR(3380)


01300000SET D30502006 = &STR(2305-1)


01310000SET D30502007 = &STR(2305-2)


01320000SET D00012000 = &STR(SYSDA)


01330000SET D00022000 = &STR(SYSSQ)


01340000SET D00082000 = &STR(WORK)


01350000SET D00092000 = &STR(WORK)


01360000SET D00058000 = &STR(TAPE8)


01370000SET D00068000 = &STR(TAPE16)


01380000SET D30008001 = &STR(2400)


01390000SET D34008001 = &STR(2400-3)


01400000SET D34208001 = &STR(2400-4)


01410000SET D34008003 = &STR(3400-3)


01420000SET D34208003 = &STR(3400-4)


01430000SET D32008003 = &STR(3400-5)


01440000SET D32108003 = &STR(3400-6)


01450000GOTO INITDONE


./ ADD NAME=SPFCATNV 0103-84075-84100-1357-00722-00716-00000-KK00150
        PROC 0 FI(NONE) L


        CONTROL NOFLUSH   MSG END(ENDO)


        /*IF &SYSUID = KK00150 THEN CONTROL MSG LIST CONLIST  /* */


        IF &L = L THEN CONTROL MSG LIST CONLIST  /* */


        GLOBAL GCRC GCVOL GCDEVT


        GLOBAL EMSG


        ERROR DO


              %ERRORMSG &LASTCC


              GOTO MAINLOOP


              ENDO


        /***************************************************************


        /*   INITIALIZE VARIABLES FIRST:


        /***************************************************************


        SET PATTR = &STR(LOW)


        SET CN = &STR(&&CN)


        SET CO = &STR(&&CO)


        SET CP = &STR(&&CP)


        SET PF = &STR(&&PF)


        SET &P  = &STR(&&P)


        SET &EO  = &STR(&&EO)


        SET EMSG = &STR()


        SET DEVT = &STR()


        SET ALIAS = &STR()


        SET &CDCUR = DSN


        SET &VF = N


        SET REP = &STR(&&REP)


        SET REP1 = NONE


        SET REP2 = NONE


        SET REP3 = NONE


        SET REP4 = NONE


        SET REP5 = NONE


        SET REP6 = NONE


        SET REP7 = NONE


        SET REP8 = NONE


        ERROR OFF


        ISPEXEC VGET (CN7 CN8 LF PASSDS) PROFILE


        IF &PASSDS NE YES THEN SET &DSN = &STR()


        ERROR DO


              %ERRORMSG &LASTCC


              GOTO MAINLOOP


              ENDO


        INITCATS: SET ICF = N


        SET CN1 = &STR(SYS1.SOFTCAT)


        SET CD1 = &STR(SOFTWARE CAT)


        SET PF1 = N


        SET CN2 = &STR(SYS1.G29MCAT)


        SET CD2 = &STR(3033 MASTER)


        SET PF2 = U


        SET CN3 = &STR(SYS1.K15MCAT)


        SET CD3 = &STR(3081 MASTER)


        SET PF3 = U


        SET CN4 = &STR(SYS1.J14MCAT)


        SET CD4 = &STR(TEST SYSTEM)


        SET PF4 = N


        SET CN5 = &STR(SYS1.J14MCAT)


        SET CD5 = &STR(BLOCK SYSTEM)


        SET PF5 = N


        SET CN6 = &STR(SYS1.USERCAT1)


        SET CD6 = &STR(USERCAT1)


        SET PF6 = N


        SET PF7 = N


        SET CD7 = &STR((OPTIONAL CAT))


        SET PF8 = N


        SET CD8 = &STR((OPTIONAL CAT))





        /***************************************************************


        /*   MAIN DIALOG LOOP START: DISPLAY PANEL AND GET RESPONSE:


        /***************************************************************


        MAINLOOP: IF &ICF = Y THEN GOTO INITCATS


        DISPLAY: ERROR OFF


        CONTROL MSG NOLIST NOCONLIST


        ISPEXEC DISPLAY PANEL(&SYSICMD) CURSOR(&CDCUR)


           SET DRC = &LASTCC


           IF &DRC NE 0 THEN DO


                 IF &FI NE NONE THEN %CMDOUT FREE(&FI)


                 ISPEXEC VPUT (CN7 CN8 LF) PROFILE


                 EXIT


                             ENDO


        IF &LF = L THEN DO


                        ISPEXEC CONTROL DISPLAY SM START(1)


                        CONTROL MSG LIST CONLIST


                        SET VF = E


                        SET L = L


                        ENDO


                   ELSE DO


                        SET VF = N


                        IF &LF = Y THEN SET VF = Y


                        IF &LF = B THEN SET VF = Y


                        IF &LF = E THEN SET VF = E


                        ENDO


        IF &STR(&DEVT) = &STR() THEN SET CDT = Y


                                ELSE SET CDT = N


        SET EMSG = &STR()


        SET PATTR = &STR()





        /***************************************************************


        /*   ALLOCATE AN OUTPUT FILE FOR DISPLAYING THE RESULTS:


        /***************************************************************


        IF &FI = NONE THEN DO


                      CONTROL NOMSG


                      IF &LF = L THEN CONTROL MSG


                      FREE ATTR(KKKACUNV)


                      ATTR KKKACUNV RECFM(V,B) LRECL(137) BLK(3155)


                      CONTROL MSG


                      %CMDOUT MOD USE(KKKACUNV) FORCE &L


                      SET &FI = &LASTCC


                      IF &FI = 99 THEN DO


                          SET FI = NONE


                          SET EMSG = ERROR ALLOCATING CMD FILE


                          GOTO MAINLOOP


                                       ENDO


                      OPENFILE CMDOUT&FI OUTPUT


                      CLOSFILE CMDOUT&FI


                      SET SVOL = &VOL


                      WHATDSN DDN(CMDOUT&FI)


                      SET &CDSN = &DSNAME


                      SET VOL = &SVOL


                           ENDO





        /***************************************************************


        /*   MAKE ONE PASS   THROUGH ALL CATALOGS VERIFYING  REQUESTS:


        /***************************************************************


        GOTO CATVER     /* VERIFY PARMS ENTERED   */





        /***************************************************************


        /*   MAKE 3 PASSES THROUGH ALL CATALOGS PROCESSING REQUESTS:


        /***************************************************************


        CATLOOP: +


        SET PASS = 1


        DO WHILE &PASS < 4


                                 /*  INNER LOOP THROUGH EACH CATLOG:   *


          SET CDF = YES


          SET &I = 1


          DO WHILE &I < 9


            IF &CO&I NE &STR( ) THEN GOTO CATFUNC /* CATALOG NEEDS SOMET


            CATDONE: +


            IF &CDF = YES THEN SET &CO&I =


            SET CDF = YES


            SET &I = &I + 1


          ENDO





          SET PASS = &PASS + 1


        ENDO





        /***************************************************************


        /*   ALL CATALOG FTNS DONE: DISPLAY RESULTS AND RESTART DIALOG:


        /***************************************************************





        SET CDCUR = DSN


        ENDLOOP: IF &CDT = Y THEN SET DEVT = &STR()


                 IF &VF = N THEN DO


                            OPENFILE CMDOUT&FI OUTPUT


                            CLOSFILE CMDOUT&FI


                            GOTO MAINLOOP


                                 ENDO


        ISPEXEC SELECT PGM(CLRSPFIO)


        ISPEXEC CONTROL ERRORS RETURN


        IF &VF = Y THEN ISPEXEC BROWSE DATASET('&CDSN.')


        IF &VF = E THEN ISPEXEC EDIT DATASET('&CDSN.')


        OPENFILE CMDOUT&FI OUTPUT


        CLOSFILE CMDOUT&FI


        SET VF = N


        GOTO MAINLOOP





        /***************************************************************


        /*   ALL DIALOG INTERNAL SUBROUTINES FOLLOW HERE:


        /***************************************************************





        /*   CATVER VERIFICATION SUBROUTINE:   */





        CATVER: SET NAME = &STR(&DSN)


        /*


        /*  1 = NO OP                           6 = DELETE


        /*  2 = LISTCAT                         7 = CATALOG


        /*  3 = LISTCAT LVL                    11 = RECATALOG


        /*  4 = UNCATALOG                      13 = RENAME


        /*  5 = DEF ALIAS                      17 = DEF GDG


        /* 19 = COPY FROM CATALOG              23 = MOVE FROM CATALOG


        /*


        /*  8 = COPY LIST(L) FROM CAT  (FL)  9 = COPY LIST(LL) FROM CAT


        /* 10 = MOVE LIST(L) FROM CAT  (ML) 12 = MOVE LIST(LL) FROM CAT


        /* 14 = CATALOG FROM LIST BILT BY 8,9,10,12  (THIS IS CL)


        /*


        /* 15 = UNCATALOG BY LEVEL


        /* 16 = DELETE    BY LEVEL


        /*





        /* DO PRELIMINARY PROCESSING:  VERIFY OPTION COMBINATIONS   */


        /*     THEN VERIFY VOL AND DEVT FOR LATER CAT OR RECAT OPT  */





        /* SET OP FLAGS OFF  */


        SET &FF = NO


        SET &MFF = NO


        SET &CATF = NO


        SET &CATLF = NO


        SET &RECATF = NO


        SET &COPYF = NO


        SET &MOVEF = NO


        SET &BILDF = NO


        SET &DELF = NO


        SET &RENF = NO


        SET &GDGF = NO


        SET &ALIASF = NO


        SET &ULLF = NO





        SET &J = 1


        DO WHILE &J < 9


          IF &CO&J = 5 THEN SET &ALIASF = YES


          IF &CO&J = 6 THEN SET &DELF = YES


          IF &CO&J = 7 THEN SET &CATF = YES


          IF &CO&J = 8  OR &CO&J = 9 OR &CO&J = 10 OR &CO&J = 12 THEN +


                             SET &BILDF = YES


          IF &CO&J = 11 THEN SET &RECATF = YES


          IF &CO&J = 13 THEN SET &RENF = YES


          IF &CO&J = 14 THEN SET &CATLF = YES


          IF &CO&J = 15 THEN SET &ULLF = YES


          IF &CO&J = 17 THEN SET &GDGF = YES


          IF &CO&J = 19 THEN SET &COPYF = YES


          IF &CO&J = 23 THEN SET &MOVEF = YES


          SET &J = &J + 1


        ENDO





        IF &BILDF = YES THEN DO


            IF &CATF = YES OR &RECATF = YES OR +


               &COPYF = YES OR &MOVEF = YES OR +


               &RENF = YES OR &GDGF = YES THEN DO


                SET EMSG = &STR(INVALID COMBINATION OF OPTIONS)


                SET CDCUR = CO1


                GOTO MAINLOOP


                ENDO


            IF &CATLF = NO THEN DO


                SET EMSG = &STR(SPECIFY DEST FOR CATALOG-A-LIST)


                SET CDCUR = CO1


                GOTO MAINLOOP


                ENDO


            ENDO





        IF &CATLF = YES THEN DO


            IF &CATF = YES OR &RECATF = YES OR +


               &COPYF = YES OR &MOVEF = YES OR +


               &RENF = YES OR &GDGF = YES THEN DO


                SET EMSG = &STR(INVALID COMBINATION OF OPTIONS)


                SET CDCUR = CO1


                GOTO MAINLOOP


                ENDO


            IF &BILDF = NO THEN DO


                SET EMSG = &STR(SPECIFY SOURCE FOR CATALOG-A-LIST)


                SET CDCUR = CO1


                GOTO MAINLOOP


                ENDO


            ENDO





        IF &ULLF = YES THEN DO


            IF &CATF = YES OR &RECATF = YES OR +


               &COPYF = YES OR &MOVEF = YES OR +


               &RENF = YES OR &GDGF = YES THEN DO


                SET EMSG = &STR(INVALID COMBINATION OF OPTIONS)


                SET CDCUR = CO1


                GOTO MAINLOOP


                ENDO


            ENDO





        IF &GDGF = YES THEN DO


            IF &CATF = YES OR &RECATF = YES OR +


               &COPYF = YES OR &MOVEF = YES OR +


               &RENF = YES OR &CATLF = YES  OR BILDF = YES THEN DO


                SET EMSG = &STR(INVALID COMBINATION OF OPTIONS)


                SET CDCUR = CO1


                GOTO MAINLOOP


                ENDO


            ENDO








        IF &CATF = NO AND &RECATF = NO  THEN GOTO CATLOOP /* NO VER NEED


        IF &COPYF = YES OR &MOVEF = YES THEN GOTO CATLOOP /* GET VOL LAT





        IF &STR(&VOL) = &STR() THEN DO





          IF &RECATF = YES       THEN DO


              SET EMSG = &STR(ERROR - VOLUME IS NEEDED TO RECATALOG DATA


              SET CDCUR = VOL


              GOTO MAINLOOP


                                      ENDO





          IF &CATF = YES       THEN DO


              FILEINFO DSN(&NAME)


              SET FIRC = &LASTCC


               IF &FIRC = 4 THEN DO


                    SET EMSG = &STR(VOLUME NEEDED TO CATALOG &NAME)


                    SET CDCUR = VOL


                    GOTO MAINLOOP


                                  ENDO


               IF &FIRC NE 0 THEN DO


                    SET EMSG = &STR(UNABLE TO CATALOG &NAME - &OUTMSG)


                    SET CDCUR = VOL


                    GOTO MAINLOOP


                                  ENDO


              SET &VOL = &STR(&VOLSER)


                                    ENDO


                                  ENDO





        GOTVOL: +


        IF &STR(&DEVT) = &STR() THEN +


           DO


           DEVTYPE VOL(&VOL)


           SET DTRC = &LASTCC


           IF &DTRC NE 0 THEN +


                DO


                IF &LENGTH(&VOL) > 3 THEN DO


                     IF &SUBSTR(1:4,&VOL) = 3350 THEN DO


                                                SET &DEVT = 3350


                                                GOTO GOTDEVT


                                                      ENDO


                     IF &SUBSTR(1:4,&VOL) = 3380 THEN DO


                                                SET &DEVT = 3380


                                                GOTO GOTDEVT


                                                      ENDO


                                          ENDO


                IF &DTRC = 8 THEN DO


                                  SET EMSG = &STR(DEVICE TYPE NEEDED)


                                  SET CDCUR = DEVT


                                  GOTO MAINLOOP


                                  ENDO


                SET EMSG = &STR(DEVICE TYPE NEEDED - &OUTMSG)


                SET CDCUR = DEVT


                GOTO MAINLOOP


                ENDO


           SET &DEVT = &STR(&DEVTYP)


           ENDO


        GOTDEVT: +


        GOTO CATLOOP








        /*  CATALOG FUNCTION CONTROL SUBROUTINE:


        /*    (GET PASSWORD AS NEEDED, CALL SPECIFIC CATALOG FUNCTION)





        /*                    FIRST, ANALYZE OPTION,PARMS AND PASSWORD:


        CATFUNC: +


        SET CC = &I


        SET &SYSDVAL = &STR(&CP&CC)


        SET &CP&CC = &STR()


        READDVAL P1 P2 P3 P4 P5 P6


        SET &PC = 1


        DO WHILE &PC < 6


        IF &PF&CC = Y OR &PF&CC = U THEN DO


             IF &CO&CC = 8 OR &CO&CC = 9 THEN GOTO NOPASS


             IF &CO&CC = 1 OR &CO&CC = 19 THEN GOTO NOPASS


             IF &PF&CC = U AND &CO&CC < 4 THEN GOTO NOPASS


             IF &REP&CC = NONE AND &P&PC = &STR() THEN +


                                   DO


                                   SET EMSG = &STR(ENTER PASSWORD)


                                   SET CDCUR = CP&CC


                                   SET PATTR = NON


                                   GOTO DISPLAY


                                   ENDO


             IF &P&PC NE &STR() AND &PC = 1 THEN +


                                   DO


                                   SET &REP&CC = &STR(&P&PC)


                                   GOTO NEXTPARM


                                   ENDO


                                         ENDO


        NOPASS: +


             IF &P&PC = &STR() THEN GOTO SELOPT


             IF &P&PC = Y THEN DO


                               SET &PF&CC = Y


                               SET ICF = Y


                               SET &NPC = &PC+1


                               IF &P&NPC NE &STR() THEN DO


                                                   SET &REP&CC = &P&NPC


                                                   SET &PC = &PC+1


                                                   ENDO


                                                   ELSE DO


                                                   SET &REP&CC = NONE


                                                   ENDO


                               GOTO NEXTPARM


                               ENDO


             IF &P&PC = &REP&CC THEN GOTO NEXTPARM


             IF &CP&CC NE &STR() THEN SET &CP&CC = &STR(&CP&CC &P&PC)


                                 ELSE SET &CP&CC = &STR(&P&PC)


        NEXTPARM: SET &PC = &PC + 1


        ENDO





        /*                    SECOND ; CALL THE FUNCTION SUBROUTINE :


        SELOPT: GOTO O&CO&CC                 /* CALL THE CATALOG FUNCTIO





        /*                    THIRD  ; SAY OK AND RETURN TO CATALOG LOOP


        CUP: SET EMSG = &STR(SUCCESSFUL COMPLETION FOR &CN&CC)


             GOTO CATDONE





        /***************************************************/


        /* SPECIFIC CATALOG FUNCTION SUBROUTINES FOLLOW:   */


        /***************************************************/





        /* SOME FUNCTIONS NEED TO LIST THEIR RESULTS BACK FOR LATER DISP


        OKLC: +


          STACK DDOUT(CMDOUT&FI.M)


          LISTC ALL ENT(&NAME) CAT('&CN&CC'/&REP&CC)


          GOTO CUP





        /* SOME FUNCTIONS NEED TO WAIT UNTIL LATER TO PERFORM THEIR STUF


        WAIT: +


          SET CDF = NO


          GOTO CATDONE





        O1:    GOTO CATDONE                     /* NOP FUNCTION  */





        /*         OPTION L  */


        O2: +


            IF &PASS = 1 THEN GOTO WAIT  /* NOT TIME TO DO THIS YET... *


            IF &CP&CC = &STR() THEN SET &CP&CC = ALL


            STACK DDOUT(CMDOUT&FI.M) LIST


            LISTC &CP&CC ENT(&NAME) CAT('&CN&CC'/&REP&CC)


            SET VF = Y


            IF &CP&CC = ALL THEN SET &CP&CC = &STR()


            GOTO CATDONE





        /*         OPTION LL */


        O3: +


            IF &PASS = 1 THEN GOTO WAIT  /* NOT TIME TO DO THIS YET... *


            IF &CP&CC = &STR() THEN SET &CP&CC = ALL


            STACK DDOUT(CMDOUT&FI.M) LIST


            LISTC &CP&CC LVL(&NAME) CAT('&CN&CC'/&REP&CC)


            SET VF = Y


            IF &CP&CC = ALL THEN SET &CP&CC = &STR()


            GOTO CATDONE





        /*         OPTION U  */


        O4: +


          IF &PASS = 1 THEN GOTO WAIT  /* NOT TIME TO DO THIS YET... */


          STACK DDOUT(CMDOUT&FI.M) LIST


          DEL &NAME NSCR CAT('&CN&CC'/&REP&CC)


          SET &RC = &LASTCC


          IF &RC NE 0 THEN DO


                           SET VF = Y


                           SET EMSG = &STR(ERROR &RC FOR &CN&CC)


                           GOTO CATDONE


                           ENDO


          GOTO CUP





        /*         OPTION A  */


        O5: +


          IF &PASS = 1 THEN GOTO WAIT  /* NOT TIME TO DO THIS YET... */


          STACK DDOUT(CMDOUT&FI.M) LIST


          DEF ALIAS(NAME(&ALIAS) REL(&NAME)) CAT('&CN&CC'/&REP&CC)


          SET &RC = &LASTCC


          IF &RC NE 0 THEN DO


                           SET VF = Y


                           SET EMSG = &STR(ERROR &RC FOR &CN&CC)


                           GOTO CATDONE


                           ENDO


          GOTO OKLC





        /*         OPTION D  */


        O6: +


          IF &PASS = 1 THEN GOTO WAIT  /* NOT TIME TO DO THIS YET... */


          IF &PF&CC = U OR &PF&CC = Y THEN DO


            %CATGET &NAME '&CN&CC.'


               IF &GCRC NE 0 THEN DO


                  SET EMSG = &STR(ERROR &GCRC FROM CATGET)


                  SET CDCUR = CO&I


                  GOTO ENDLOOP


                                  ENDO


          CONTROL NOMSG


          FREE F(DANCATD)


          CONTROL MSG


          ALLOC F(DANCATD) DA(&NAME) VOL(&GCVOL) UNIT(&GCDEVT)


          STACK DDOUT(CMDOUT&FI.M) LIST


          DEL &NAME CAT('&CN&CC'/&REP&CC) FILE(DANCATD)


          SET &RC = &LASTCC


          CONTROL NOMSG


          FREE F(DANCATD)


          CONTROL MSG


          IF &RC NE 0 THEN DO


                           SET VF = Y


                           SET EMSG = &STR(ERROR &RC FOR &CN&CC)


                           GOTO CATDONE


                           ENDO


                                        ENDO


                                 ELSE DO


          STACK DDOUT(CMDOUT&FI.M) LIST


          DEL &NAME CAT('&CN&CC'/&REP&CC)


          SET &RC = &LASTCC


          IF &RC NE 0 THEN DO


                           SET VF = Y


                           SET EMSG = &STR(ERROR &RC FOR &CN&CC)


                           GOTO CATDONE


                           ENDO


                                      ENDO


          GOTO CUP





        /*         OPTION C  */


        O7: +


          IF &PASS = 1 THEN GOTO WAIT  /* NOT TIME TO DO THIS YET... */


          STACK DDOUT(CMDOUT&FI.M) LIST


          DEF NVSAM(NAME(&NAME) VOL(&VOL) DEVT(&DEVT)) CAT('&CN&CC'/&REP


          SET &RC = &LASTCC


          IF &RC NE 0 THEN DO


                           SET VF = Y


                           SET EMSG = &STR(ERROR &RC FOR &CN&CC)


                           GOTO CATDONE


                           ENDO


          SET DOK = YES  /* SAY OK TO DELETE SOURCE ENTRY (FOR MF=MOVE O


          GOTO OKLC





        /*         OPTION FL  */


        /*    SUBROUTINE TO BUILD LIST FROM CATALOG SPECIFIED:   */


        O8: +


          IF &PASS > 1 THEN GOTO CATDONE


          IFALC F(BILDLIST)


          IF &LASTCC NE 0 THEN ALLOC F(BILDLIST) NEW DELETE TRACKS SP(1


          SET CLF = OKGO /* SAY CAN DO IT */


              OPENFILE CMDOUT&FI.M OUTPUT


              SET CMDOUT&FI.M = &STR( TRANSFER FROM CATALOG &CN&CC)


              PUTFILE CMDOUT&FI.M


              CLOSFILE CMDOUT&FI.M


              STACK DDOUT(BILDLIST)


              LISTC ALL ENT(&NAME) CAT('&CN&CC')


              IF &LASTCC NE 0 THEN SET CLF = NOGO /* SAY CANNOT DO IT */


              GOTO WAIT





        /*         OPTION FLL */


        /*    SUBROUTINE TO BUILD LIST FROM CATALOG SPECIFIED:   */


        O9: +


          IF &PASS > 1 THEN GOTO CATDONE


          IFALC F(BILDLIST)


          IF &LASTCC NE 0 THEN ALLOC F(BILDLIST) NEW DELETE TRACKS SP(1


          SET CLF = OKGO /* SAY CAN DO IT */


              OPENFILE CMDOUT&FI.M OUTPUT


              SET CMDOUT&FI.M = &STR( TRANSFER FROM CATALOG &CN&CC)


              PUTFILE CMDOUT&FI.M


              CLOSFILE CMDOUT&FI.M


              STACK DDOUT(BILDLIST)


              LISTC ALL LVL(&NAME) CAT('&CN&CC')


              IF &LASTCC NE 0 THEN SET CLF = NOGO /* SAY CANNOT DO IT */


              GOTO WAIT





        /*         OPTION ML  */


        O10: +


          IF &PASS = 1 THEN GOTO O8    /* NEED TO BUILD LIST FIRST.. */


          IF &PASS = 2 THEN GOTO WAIT  /* NOT TIME TO DO THIS YET... */


          OPENFILE CMDOUT&FI.M OUTPUT


          SET CMDOUT&FI.M = &STR( MOVE FROM CATALOG &CN&CC)


          PUTFILE CMDOUT&FI.M


          CLOSFILE CMDOUT&FI.M


          IF &CLF = NOGO THEN DO


             SET EMSG = &STR(ERROR-CATALOG TRANSFER NOT SUCCESSFUL)


             GOTO CATDONE


             ENDO


          IFALC F(SYSIN)


          IF &LASTCC = 0 THEN FREE F(SYSIN)


          IF &VF = E THEN DO


                         %CMDOUT DDN(SYSIN) MOD


                         SET SFN = &LASTCC


                          ENDO


                     ELSE +


          ALLOC F(SYSIN) NEW DELETE               TRACKS SP(1 1) /* */


          IF &SYSICMD = SPFCATNN THEN +


          %SPFCATCN TYPE(U) CAT('''&CN&CC''/&REP&CC') &L


                                 ELSE +


          %SPFCATCC TYPE(U) CAT('''&CN&CC''/&REP&CC') &L


          IF &LASTCC NE 0 THEN DO


             SET EMSG = &STR(ERROR-CATALOG TRANSFER NOT SUCCESSFUL)


             SET CLF = NOGO


             GOTO CATDONE


             ENDO


          IFALC F(SYSPRINT)


          IF &LASTCC = 0 THEN DO


              IFALC F(SYSPRINT) DSN('&CDSN.')


              IF &LASTCC = 0 THEN GOTO SYSPOK1


              FREE F(SYSPRINT)


              ENDO


          ALLOC F(SYSPRINT) DSN('&CDSN.') MOD


           SYSPOK1: IF &VF = E THEN DO


                   WHATDSN DDN(SYSIN)


                   ISPEXEC EDIT DATASET('&DSNAME')  /*  */


                                    ENDO


          CALL 'SYS1.LINKLIB(IDCAMS)'    /*  */


          IF &LASTCC NE 0 THEN DO


             SET EMSG = &STR(ERROR-CATALOG TRANSFER NOT SUCCESSFUL)


             SET CLF = NOGO


             IF &VF = E THEN %CMDOUT FREE(&SFN)


             GOTO CATDONE


             ENDO


          IF &VF = E THEN %CMDOUT FREE(&SFN)


          GOTO CUP








        /*         OPTION R   */


        O11: +


          IF &PASS = 1 THEN GOTO WAIT  /* NOT TIME TO DO THIS YET... */


          STACK DDOUT(CMDOUT&FI.M) LIST


          DEL &NAME NSCR CAT('&CN&CC'/&REP&CC)


          SET &RC = &LASTCC


          IF &RC NE 0 THEN DO


                           SET VF = Y


                           SET EMSG = &STR(ERROR &RC FOR &CN&CC)


                           GOTO CATDONE


                           ENDO


          RECAT: +


          STACK DDOUT(CMDOUT&FI.M) LIST


          DEF NVSAM(NAME(&NAME) VOL(&VOL) DEVT(&DEVT)) CAT('&CN&CC'/&REP


          SET &RC = &LASTCC


          IF &RC NE 0 THEN DO


                           SET VF = Y


                           SET EMSG = &STR(ERROR &RC FOR &CN&CC)


                           GOTO CATDONE


                           ENDO


          GOTO OKLC





        /*         OPTION MLL */


        O12: +


          IF &PASS = 1 THEN GOTO O9    /* NEED TO BUILD LIST FIRST.. */


          IF &PASS = 2 THEN GOTO WAIT  /* NOT TIME TO DO THIS YET... */


          GOTO O10





        /*         OPTION RN  */


        O13: +


          IF &PASS = 1 THEN GOTO WAIT  /* NOT TIME TO DO THIS YET... */


          STACK DDOUT(CMDOUT&FI.M) LIST


          ALTER &NAME NEWNAME(&ALIAS) CAT('&CN&CC'/&REP&CC)


          SET &RC = &LASTCC


          IF &RC NE 0 THEN DO


                           SET VF = Y


                           SET EMSG = &STR(ERROR &RC FOR &CN&CC)


                           GOTO CATDONE


                           ENDO


          STACK DDOUT(CMDOUT&FI.M) LIST


          LISTC ALL ENT(&ALIAS) CAT('&CN&CC'/&REP&CC)


          GOTO CUP





        /*         OPTION CL  */


        O14: +


          IF &PASS = 1 THEN GOTO WAIT  /* NOT TIME TO DO THIS YET... */


          OPENFILE CMDOUT&FI.M OUTPUT


          SET CMDOUT&FI.M = &STR( TRANSFER TO CATALOG &CN&CC)


          PUTFILE CMDOUT&FI.M


          CLOSFILE CMDOUT&FI.M


          IF &CLF = NOGO THEN DO


             SET EMSG = &STR(ERROR-CATALOG TRANSFER NOT SUCCESSFUL)


             GOTO CATDONE


             ENDO


          IFALC F(SYSIN)


          IF &LASTCC = 0 THEN FREE F(SYSIN)


          IF &VF = E THEN DO


                         %CMDOUT DDN(SYSIN) MOD


                         SET SFN = &LASTCC


                          ENDO


                     ELSE +


          ALLOC F(SYSIN) NEW DELETE               TRACKS SP(1 1) /* */


          IF &SYSICMD = SPFCATNN THEN +


          %SPFCATCN CAT('''&CN&CC''/&REP&CC') &L


                                 ELSE +


          %SPFCATCC CAT('''&CN&CC''/&REP&CC') &L


          IF &LASTCC NE 0 THEN DO


             SET EMSG = &STR(ERROR-CATALOG TRANSFER NOT SUCCESSFUL)


             SET CLF = NOGO


             GOTO CATDONE


             ENDO


          IFALC F(SYSPRINT)


          IF &LASTCC = 0 THEN DO


              IFALC F(SYSPRINT) DSN('&CDSN.')


              IF &LASTCC = 0 THEN GOTO SYSPOK


              FREE F(SYSPRINT)


              ENDO


          ALLOC F(SYSPRINT) DSN('&CDSN.') MOD


           SYSPOK: IF &VF = E THEN DO


                   WHATDSN DDN(SYSIN)


                   ISPEXEC EDIT DATASET('&DSNAME')  /*  */


                                   ENDO


          CALL 'SYS1.LINKLIB(IDCAMS)'    /*  */


          IF &LASTCC NE 0 THEN DO


             SET EMSG = &STR(ERROR-CATALOG TRANSFER NOT SUCCESSFUL)


             SET CLF = NOGO


             IF &VF = E THEN %CMDOUT FREE(&SFN)


             GOTO CATDONE


             ENDO


          IF &VF = E THEN %CMDOUT FREE(&SFN)


          GOTO CUP





        /*         OPTION ULL */


        O15: +


          IF &PASS = 1 THEN GOTO O9    /* NEED TO BUILD LIST FIRST.. */


          IF &PASS = 2 THEN GOTO WAIT  /* NOT TIME TO DO THIS YET... */


          GOTO O10





        /*         OPTION G   */


        O17: +


          IF &PASS = 1 THEN GOTO WAIT  /* NOT TIME TO DO THIS YET... */


          IF &CP&CC = &STR() THEN SET &CP&CC = SCR


          STACK DDOUT(CMDOUT&FI.M) LIST


          DEF GDG(NAME(&NAME) LIM(&VOL) &CP&CC) CAT('&CN&CC'/&REP&CC)


          SET &RC = &LASTCC


          IF &CP&CC = &STR(SCR) THEN SET &CP&CC = &STR()


          IF &RC NE 0 THEN DO


                           SET VF = Y


                           SET EMSG = &STR(ERROR &RC FOR &CN&CC)


                           GOTO CATDONE


                           ENDO


          GOTO OKLC





        /*         OPTION F   */


             /* IF SPECIFIED, GET VOL FROM CAT GIVEN :       */


        O19: +


           IF &PASS > 1 THEN GOTO CATDONE


           %CATGET &NAME '&CN&CC.'


           IF &GCRC NE 0 THEN DO


              SET EMSG = &STR(ERROR &GCRC FROM CATGET)


              SET CDCUR = CO&CC


              GOTO MAINLOOP


                              ENDO


           SET &VOL = &GCVOL


           SET &DEVT = &STR(&GCDEVT)


           GOTO WAIT





        /*         OPTION MF  */


        O23: +


          IF &PASS = 1 THEN GOTO O19


          IF &PASS = 2 THEN GOTO WAIT


          IF &DOK = YES THEN GOTO O4


           SET VF = Y


           SET EMSG = &STR(ERROR-MOVE BYPASSED FOR &CN&CC)


           GOTO CATDONE


./ ADD NAME=UNCLIB   0104-81209-83276-0948-00046-00044-00000-JS02150
                PROC 1 DSN


                CONTROL NOMSG NOFLUSH END(ENDO)





                ERROR OFF





                FILEINFO DSN(&STR(&DSN))


                SET &RC = &LASTCC





                IF &RC EQ 96 THEN DO


                    WRITE


                    WRITE ERROR ===> INVALID SYNTAX OF DSNAME


                    GOTO ENDIT


                    ENDO





                IF &RC NE 0 THEN DO


                    WRITE


                    WRITE ERROR ===> &OUTMSG


                    GOTO ENDIT


                    ENDO





                IF &DSORG NE PO THEN DO


                    WRITE


                    WRITE ERROR ===> DATASET TO BE CONCATENATED IS NOT


                    WRITE            PARTITIONED DATASET


                    GOTO ENDIT


                    ENDO





                IF &MEMCNTL EQ YES THEN DO


                    WRITE


                    WRITE ERROR ===> DO NOT PROVIDE MEMBER NAME


                    GOTO ENDIT


                    ENDO





                IF &RECFM NE V THEN DO


                    WRITE


                    WRITE ERROR ===> &FULLDSN MUST CONTAIN


                    WRITE            VARIABLE LENGTH RECORDS


                    GOTO ENDIT


                    ENDO





                CONCATEM ACTCODE(D) DDNAME(SYSPROC) DSNAME('&FULLDSN')


                SET &RC = &LASTCC


                WRITE


                WRITE &OUTMSG


                WRITE        (RETURN CODE = &RC)


         ENDIT: EXIT


./ ADD NAME=WATDSN   0112-80276-84104-0909-00010-00007-00000-JS02150
                PROC 1 DDNAME


                CONTROL NOFLUSH NOMSG END(ENDO)


                STACK


                CLOG '&SYSDATE &SYSTIME WATDSN' U($$$#150) SAVE


                FREE F(SYSOUT)


                ALLOC F(SYSOUT) DSN(*)


                WRITE


                IF &LENGTH(&STR(&DDNAME)) LT 8 THEN +


                    SET &DDNAME = &STR(&DDNAME&SUBSTR(1:8-&LENGTH(&DDNAM
    )

                CALL 'WDPSC.SHARED.LOAD(WATDSN)' '&STR(&DDNAME)'



000010 IDENTIFICATION DIVISION.
000020 PROGRAM-ID. TUBE.
000030 ENVIRONMENT DIVISION.
000040 INPUT-OUTPUT SECTION.
000050 FILE-CONTROL.
000060     SELECT FILEOUT          ASSIGN UT-S-FILEOUT.
000070     SELECT JOBSTREAM-FILE   ASSIGN UT-S-JOBSTREM.
000080 DATA DIVISION.
000090 FILE SECTION.
000100 FD  FILEOUT
000110     BLOCK 0
000120     LABEL STANDARD.
000130 01  FILEOUT-REC   PIC X(80).
000140
000150 FD  JOBSTREAM-FILE
000160     BLOCK 0
000170     LABEL STANDARD.
000180 01  JOBSTREAM-REC PIC X(80).
000190
000200 WORKING-STORAGE SECTION.
000210
000220 77  WS-1      PIC S9(7) COMP-3 VALUE +0.
000230 77  WS-2      PIC S9(7) COMP-3 VALUE +0.
000240 77  WS-3      PIC S9(7) COMP-3 VALUE +80.
000250 77  WS-4      PIC S9(7) COMP-3 VALUE +0.
000260 77  WS-5      PIC S9(7) COMP-3 VALUE +0.
000270 77  WS-6      PIC S9(7) COMP-3 VALUE +0.
000280 77  WS-LENGTH PIC S9(4) COMP   VALUE +0.
000290 77  DDNAME    PIC X(8)         VALUE 'LIBR    '.
000300
000310 01  MENU      PIC X(4000).
000320
000330 01  PASSREC.
000340     05  IOPARM      PIC X(8) VALUE SPACES.
000350     05  OUTLEN      PIC S9(4) COMP.
000360     05  OUTBUFF     PIC X(4000).
000370     05  INLEN  PIC S9(4) COMP SYNC.
000380     05  INBUFF.
000390         10  INREC PIC X(4000).
000400     05  RETLEN                               PIC S9(4) COMP.
000410     05  SCRUF.
000420         10  SCRUFF OCCURS 24 TIMES PIC X(80).
000430
000440 01  SCREEN-LINE.
000450     05  FILLER      PIC X(20) VALUE '   LENGTH OF SCREEN '.
000460     05  SCREEN-NAME PIC X(8).
000470     05  FILLER      PIC XXXX  VALUE ' IS '.
000480     05  SCREEN-LENGTH   PIC 9999.
000490     05  FILLER      PIC X(44) VALUE SPACES.
000500
000510 01  LINE-TABLE.
000520     05  LINE-REC OCCURS 50 TIMES PIC X(80).
000530
000540 01  LOAD-NAME.
000550     05  LOAD-MOD OCCURS 8 TIMES PIC X.
000560
000570 LINKAGE SECTION.
000580
000590 01  ARG.
000600     05  FILLER    PIC S9(4) COMP.
000610     05  ARG-NAME.
000620         10  ARG-MOD OCCURS 8 TIMES PIC X.
000630
000640 PROCEDURE DIVISION USING ARG.
000650
000660 INIT-PROCEDURES.
000670     PERFORM 120-INITIAL-PROCEDURES.
000680
000690 ACCESS-MOD-NAME.
000700     PERFORM 130-ACCESS-MODULE-NAME 8 TIMES.
000710
000720 ACCESS-SCREEN.
000730     PERFORM 140-ACCESS-SCREEN.
000740
000750 WRITE-SCREEN.
000760     PERFORM 180-WRITE-SCREEN.
000770
000780 LOAD-SCRUFF.
000790     PERFORM 190-LOAD-SCRUFF 24 TIMES.
000800
000810 LOAD-INBUFF.
000820     MOVE INBUFF TO LINE-TABLE.
000830     PERFORM 200-LOAD-INBUFF 20 TIMES.
000840
000850 LOAD-OUTBUFF.
000860     PERFORM 205-SCREEN-LINE.
000870     MOVE OUTBUFF TO LINE-TABLE.
000880     PERFORM 210-LOAD-OUTBUFF 50 TIMES.
000890
000900
000910 EOF.
000920     CLOSE FILEOUT JOBSTREAM-FILE.
000930     STOP RUN.
000940
000950 120-INITIAL-PROCEDURES SECTION.
000960     OPEN OUTPUT FILEOUT JOBSTREAM-FILE.
000970
000980 130-ACCESS-MODULE-NAME SECTION.
000990     ADD +1 TO WS-1.
001000     IF ARG-MOD (WS-1) NUMERIC
001010     MOVE ARG-MOD (WS-1) TO LOAD-MOD (WS-1)
001020     GO TO 130-EXIT.
001030     IF ARG-MOD (WS-1) ALPHABETIC
001040     MOVE ARG-MOD (WS-1) TO LOAD-MOD (WS-1)
001050     GO TO 130-EXIT.
001060     MOVE SPACE TO LOAD-MOD (WS-1).
001070 130-EXIT.
001080
001090 140-ACCESS-SCREEN SECTION.
001100     CALL 'GETSCRN' USING DDNAME LOAD-NAME WS-LENGTH MENU.
001110
001120 180-WRITE-SCREEN SECTION.
001130     MOVE 'SBXXXXXB' TO IOPARM.
001140     MOVE WS-LENGTH TO OUTLEN INLEN.
001150     MOVE SPACES TO INBUFF OUTBUFF.
001160     MOVE MENU TO OUTBUFF.
001170     CALL 'FULLSCR3'
001180     USING IOPARM OUTLEN OUTBUFF INLEN INBUFF RETLEN SCRUF.
001190
001200 190-LOAD-SCRUFF SECTION.
001210     ADD +1 TO WS-4.
001220     MOVE SCRUFF (WS-4) TO JOBSTREAM-REC.
001230     WRITE JOBSTREAM-REC.
001240
001250 200-LOAD-INBUFF SECTION.
001260     ADD +1 TO WS-5.
001270     MOVE LINE-REC (WS-5) TO FILEOUT-REC.
001280     WRITE FILEOUT-REC.
001290
001300 205-SCREEN-LINE SECTION.
001310     MOVE WS-LENGTH TO SCREEN-LENGTH.
001320     MOVE LOAD-NAME TO SCREEN-NAME.
001330     MOVE SCREEN-LINE TO FILEOUT-REC.
001340     WRITE FILEOUT-REC.
001350     MOVE SPACES TO FILEOUT-REC.
001360     WRITE FILEOUT-REC.
001370
001380 210-LOAD-OUTBUFF SECTION.
001390     ADD +1 TO WS-6.
001400     MOVE LINE-REC (WS-6) TO FILEOUT-REC.
001410     WRITE FILEOUT-REC.

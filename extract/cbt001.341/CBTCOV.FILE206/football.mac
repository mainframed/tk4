 /*        F O O T B A L L       */
 FF:     PROC OPTIONS(MAIN) REORDER;
         ON ZERODIVIDE  ;
         ON UNDERFLOW ;
         ON OVERFLOW ;
       DCL
        (B,B0,B1,COUNT8350,D1,D2,G,I,IERR,ITEMP,K,O0,O2,P,
        P3,P5,P7,Q3,R2,T,TOGO,U,W,Y,YDLINE,Z0,Z1,Z2,Z6)STATIC INIT(0),
        ((IS,TEAM(2),BS(5),TS,OS,WS)CHAR(20) VAR,
        QUARTERS(4) CHAR(11) VAR
                 INIT('FIRST','SECOND','THIRD','**4-TH**'))
        STATIC;
      DCL
        TEAMNAME(28)  CHAR(20) VAR
        INIT( 'JETS',
              'DOLPHINS',
              'PATRIOTS',
              'COLTS',
              'BILLS',
              'BROWNS',
              'STEELERS',
              'BENGALS',
              'OILERS',
              'RAIDERS',
              'CHIEFS',
              'BRONCOS',
              'CHARGERS',
              'GIANTS',
              'COWBOYS',
              'REDSKINS',
              'EAGLES',
              'CARDS',
              'VIKINGS',
              'PACKERS',
              'LIONS',
              'BEARS',
              '49-ERS',
              'RAMS',
              'SAINTS',
              'BUCKANEERS',
              'SEAHAWKS',
              'FALCONS') STATIC;
        DCL  AS(20) CHAR(20)
          INIT( 'RUN UP MIDDLE',
              'OFF TACKLE',
              'COUNTER PLAY',
              'DRAW PLAY',
              'DOUBLE REVERSE',
              'LATERAL PASS',
              'QB SNEAK',
              'POWER SWEEP',
              'END AROUND',
              'SCREEN PLAY',
              'SHOTGUN PASS',
              'DOWN & OUT',
              'DOWN & IN',
              'BUTTONHOOK PASS',
              'PASS OVER MIDDLE',
              'STOP & GO',
              'SLANT OVER MIDDLE',
              'HALFBACK OPTION',
              'TRIPLE OPTION',
              'FLY PATTERN') VAR STATIC;
        DCL OPTION CHAR(12),
         VS(80) CHAR(80) VAR
         INIT( ' HANDOFF TO THE FULLBACK--INTO THE MIDDLE OF THE LINE',
 ' HANDOFF TO THE HALFBACK WHO RUNS STRAIGHT UP THE MIDDLE',
 ' HANDOFF TO THE FULLBACK WHO RUNS UP THE MIDDLE',
 ' HANDOFF TO THE HALFBACK WHO RUNS UP THE MIDDLE',
 ' HANDOFF TO THE FULLBACK WHO RUNS OFF LEFT TACKLE',
 ' HANDOFF TO THE HALFBACK WHO RUNS OFF LEFT TACKLE',
 ' HANDOFF TO THE FULLBACK WHO RUNS OFF RIGHT TACKLE',
 ' HANDOFF TO THE HALFBACK WHO RUNS OFF RIGHT TACKLE',
 ' FAKE LEFT TO THE HALFBACK-HANDOFF TO THE FULLBACK WHO RUNS RIGHT',
 ' FAKE LEFT TO THE FULLBACK-HANDOFF TO THE HALFBACK WHO RUNS RIGHT',
 ' FAKE RIGHT TO THE HALFBACK-HANDOFF TO THE FULLBACK WHO RUNS LEFT',
 ' FAKE RIGHT TO THE FULLBACK-HANDOFF TO THE HALFBACK WHO RUNS LEFT',
 ' HANDOFF TO THE HALFBACK - DRAW PLAY',
 ' HANDOFF TO THE FULLBACK - DRAW PLAY',
 ' HANDOFF TO THE FULLBACK - DRAW PLAY',
 ' HANDOFF TO THE HALFBACK - DRAW PLAY',
 ' SPLIT END STARTS RIGHT:HANDS TO FLANKER WHO RUNS AROUND LEFT END',
 ' SPLIT END STARTS LEFT:HANDS TO TIGHT END WHO RUNS RIGHT',
 ' TIGHT END STARTS RIGHT:HANDS TO SPLIT END WHO RUNS LEFT',
 ' TIGHT END STARTS LEFT:HANDS TO FLANKER WHO RUNS AROUND RIGHT END',
 ' A LATERAL TO THE FULLBACK WHO RUNS AROUND LEFT END',
 ' A LATERAL TO THE HALFBACK WHO RUNS AROUND RIGHT END',
 ' A LATERAL TO THE FULLBACK WHO RUNS AROUND RIGHT END',
 ' A LATERAL TO THE HALFBACK WHO RUNS AROUND LEFT END',
 ' THE QB KEEPS THE BALL HIMSELF',
 ' THE QB KEEPS THE BALL HIMSELF',
 ' A QUARTERBACK SNEAK',
 ' A QUARTERBACK SNEAK',
 ' A SWEEP AROUND LEFT END BY THE FULLBACK',
 ' A SWEEP AROUND RIGHT END BY THE FULLBACK',
 ' HANDOFF TO THE HALFBACK -- A SWEEP AROUND RIGHT END',
 ' A SWEEP AROUND LEFT END BY THE HALFBACK',
 ' AN END AROUND BY THE SPLIT END TO THE RIGHT',
 ' AN END AROUND BY THE SPLIT END TO THE LEFT',
 ' AN END AROUND BY THE TIGHT END TO THE RIGHT',
 ' AN END AROUND BY THE TIGHT END TO THE LEFT',
 ' A SCREEN PASS TO THE FULLBACK',
 ' A SCREEN PASS TO THE HALFBACK',
 ' A SCREEN PASS TO THE TIGHT END',
 ' A SCREEN PASS TO THE FLANKER',
 ' A SHOTGUN FORMATION -- PASS TO THE FLANKER',
 ' A SHOTGUN FORMATION -- PASS TO THE SPLIT END',
 ' A SHOTGUN FORMATION -- PASS TO THE TIGHT END',
 ' A SHOTGUN FORMATION -- PASS TO THE FLANKER',
 ' A DOWN AND OUT TO THE FLANKER ON THE LEFT',
 ' A DOWN AND OUT TO THE SPLIT END ON THE RIGHT',
 ' A DOWN AND OUT TO THE TIGHT END ON THE LEFT',
 ' A DOWN AND OUT TO THE FLANKER ON THE LEFT',
 ' A DOWN AND IN TO THE SPLIT END ON THE RIGHT',
 ' A DOWN AND IN TO THE TIGHT END ON THE LEFT',
 ' A DOWN AND IN TO THE TIGHT END ON THE RIGHT',
 ' A DOWN AND IN TO THE TIGHT END ON THE RIGHT',
 ' A BUTTONHOOK ON THE LEFT SIDE BY THE FLANKER',
 ' A BUTTONHOOK ON THE RIGHT SIDE BY THE SPLIT END',
 ' A BUTTONHOOK ON THE LEFT SIDE BY THE TIGHT END',
 ' A BUTTONHOOK ON THE RIGHT SIDE BY THE TIGHT END',
 ' A PASS OVER THE MIDDLE TO THE FLANKER',
 ' A PASS OVER THE MIDDLE TO THE TIGHT END',
 ' A PASS OVER THE MIDDLE TO THE FULLBACK',
 ' A PASS OVER THE MIDDLE TO THE HALFBACK',
 ' A STOP AND GO BY THE SPLIT END',
 ' A STOP AND GO BY THE TIGHT END',
 ' A STOP AND GO BY THE FLANKER',
 ' A STOP AND GO BY THE FLANKER',
 ' A SLANT OVER THE MIDDLE TO THE LEFT BY THE FLANKER',
 ' A SLANT OVER THE MIDDLE TO THE RIGHT BY THE SPLIT END',
 ' A SLANT OVER THE MIDDLE TO THE LEFT BY THE TIGHT END',
 ' A SLANT OVER THE MIDDLE TO THE RIGHT BY THE FLANKER',
 ' FLANKER',
 ' TIGHT END',
 ' SPLIT END',
 ' FULLBACK',
 ' LEFT END',
 ' RIGHT END',
 ' FULLBACK',
 ' HALFBACK',
 ' THE SPLIT END GOES DEEP -- IT"S A LONG PASS',
 ' THE FLANKER GOES DEEP  -- A LONG PASS',
 ' RECEIVERS ARE DEEP -- IT"S A LONG PASS TO THE FLANKER',
 ' THE TIGHT END IS FAR DOWN-FIELD -- IT"S A LONG PASS') STATIC ;
        DCL (X1,X2,X3)(2,20),
            X5(2,20)DEC FLOAT,
            YARDS(2,2)INIT((4) 0),
 (T0,A9,NOPUNTS,TOTPUNTS,NFMBL,NOPASS,O4,O7,J5,K9,P4,P6)(2)INIT((2) 0),
 (FIELDGOALS,FMBREC,NORUNS,SCORE)(2) BIN FIXED INIT((2)0),
            (IFTIME,Z,Q1,Z8,Q,LENPER)BIN FIXED INIT(0),
            ISCORE(2,4) INIT((8)0),FGRCD(20,2) BIN FIXED INIT((40)0)
            ,A BIN FIXED STATIC;
         /* 0 01/19/73 */;
         ON ENDPAGE(SYSPRINT) ;
 GFMT:   FORMAT(SKIP,3 A);
         Z1=3+8.5000*RND(X);
         X5=0;
         DO Q1=1 TO 2;
         DO Z8=1 TO 8;
         X1(Q1,Z8)=5.000+10.000*RND(X);
         END;
         X1(Q1,3)=X1(Q1,3)+20.000*RND(X);
         X1(Q1,5)=X1(Q1,5)+20.000*RND(X);
         X1(Q1,8)=5.000+20.000*RND(X);
         END;
         GO TO L8190;
 L300:   X=.5000;
         Q=1;
         B,B0=LENPER;
         ON CONVERSION GO TO L440;
 L440:   PUT EDIT('VERSION 2.1 11/20/77')(SKIP,A);
         PUT EDIT('PLAYERS:0,1,2  OPTIONS:N-NORMAL,B-BRIEF,DEFAULT-N')
         (SKIP,A);
         PUT EDIT('NO. PLAYERS,OPTION(S)')(SKIP,A);
         PUT SKIP;GET EDIT(OPTION)(A(10));
         GET STRING(OPTION) EDIT (I)(F(1));
         ON CONVERSION SYSTEM;
         IPLAYTYPE=1;
         IF I=1 THEN DO;
           DO O2=1 TO 20;
           X3(2,O2)=MIN(.9500,X3(2,O2)*(((16.00-Z1)/30.00)+1.000));
           END;END;
 L510:   IF 3-I<1 THEN GOTO L440;
         IF 3-I>3 THEN GOTO L440;
 NAMESOK:
         LENPER=15;
         IF INDEX(OPTION,'B')>0 THEN LENPER=8;
         IF LENPER=8 THEN
         PUT  EDIT('FOR THIS GAME EACH 1/4 WILL BE 8 MINUTES !!!')
             (R(GFMT));
         B,B0=LENPER;
         IF 3-I=3 THEN GOTO L8910;
         PUT  EDIT('NAME OF VISITING TEAM (UP TO 16 CHARS)')(R(GFMT));
         PUT SKIP;
         GET EDIT(TEAM(1))(SKIP,A(20));
         ITEMP=INDEX(TEAM(1),'  ');
         IF ITEMP>0 THEN TEAM(1)=SUBSTR(TEAM(1),1,ITEMP);
         IF 3-I=2 THEN GOTO L8910;
         PUT  EDIT('NAME OF HOME TEAM')(R(GFMT));
         PUT SKIP;
         GET EDIT(TEAM(2))(SKIP,A(20));
         ITEMP=INDEX(TEAM(2),'  ');
         IF ITEMP>0  THEN TEAM(2)=SUBSTR(TEAM(2),1,ITEMP);
         /* :VERBOS/PEB: */;
         /* :FTNAME/PEB: */;
 L690:   PUT  EDIT('<> <> TO PRINT PLAY CHART ENTER PLAY NO. 100 <>')
         (R(GFMT));
         IF INDEX(OPTION,'H')>0 THEN CALL L6640;
         PUT  EDIT('>>> THE COIN TOSS... ')(R(GFMT));
         U,Q1=1;
         IF RND(X)<.5000 THEN U,Q1=2;
         PUT  EDIT(TEAM(3-Q1),' WILL KICK OFF...')(A);
         IPLAYTYPE=3;
         A,W=0;
 L840:   P=59.000+TRUNC(23.765*.5000*(RND(X)+RND(X)));
         Q3=1;
         B=B-.1;
         IFTIME=0;
         P5=TRUNC(.5000*(RND(X)+RND(X))*8.000);
         IF RND(X)<.01 THEN GOTO L1190;
         IF RND(X)<.400 THEN GOTO L940;
         P5=TRUNC(.5000*(RND(X)+RND(X))*8.000)+1.000;
         GO TO L1050;
 L940:   PUT  EDIT(' INTO THE END-ZONE /')(R(GFMT));
         IF RND(X)<.700 THEN GOTO L990;
         P5=TRUNC(-6.000*.5000*(RND(X)+RND(X)));
         YDLINE=TRUNC(30.000*.5000*(RND(X)+RND(X))+1);
         GO TO L1070;
 L990:   IF RND(X)<.94 THEN GOTO L1030;
         P5=0;
         YDLINE=100.00+TRUNC(3.000*RND(X));
         GO TO L1210;
 L1030:  PUT EDIT(' IT IS NOT RUN OUT')(A);
         GO TO L1240;
 L1050:  PUT  EDIT(' CAUGHT ON',P5,' YD. LINE /')(SKIP,A,F(4),A);
 AFMT:   FORMAT(A,F(5),A);
         YDLINE=TRUNC(48.000*.5000*(RND(X)+RND(X))+1);
 L1070:  IF RND(X)<.2000 THEN YDLINE=90.00*.333*(RND(X)+RND(X)+RND(X));
         IF RND(X)<.200 THEN YDLINE=1.000+10.000*RND(X);
         TOGO=100-YDLINE;
         PUT  EDIT(' RETURNED ',YDLINE-P5,' YDS.')(R(AFMT));
         Q3=1;
         D1,D2=10;
         B1=YDLINE;
         GO TO L5980;
 L1190:  YDLINE=100;
         PUT  EDIT(' CAUGHT ON',P5,' YD. LINE /')(SKIP,A,F(4),A);
 L1210:  PUT EDIT(' RETURNED ',YDLINE-P5,' YDS.')(A,F(4),A);
         GO TO L6430;
 L1240:  PUT EDIT('KICK GOES INTO END-ZONE--TOUCHBACK')(R(GFMT));
         PUT SKIP EDIT('* ',TEAM(Q1),' BALL ON <OWN> 20 *')
             (3 A);
         Q3=1;
         YDLINE,B1=20;
         TOGO=80;
         D1,D2=10;
 L1370:  A=A+1;
         GO TO L1590;
 IFMT:   PROC(X);IF ABS(X)<1.0E-5 THEN RETURN(0);
                 ELSE RETURN(1-TRUNC(LOG10(ABS(X))));END;
 IFMT2:  PROC(X);IF ABS(X)<1.0E-5 THEN RETURN(3);
                 ELSE RETURN(MAX(4,4-TRUNC(LOG10(ABS(X)))));END;
     /*  --- TIME FCN --- */;
 NEWTIME:PROC;
         IF IPLAYTYPE=4 THEN GOTO L1520;
         B=B-.08-.11*RND(X);
         IF IFTIME=1 THEN GOTO L1500;
         IF IFTIME=5 THEN B=MAX(B,.05);
         IF IFTIME=5 THEN GOTO L1520;
         IF IFTIME=0 THEN GOTO L1520;
         T0(Q1)=T0(Q1)+1;
         IF T0(Q1)>3 THEN GOTO L1500;
         PUT EDIT('  --- TIME OUT NO.',T0(Q1),' CALLED ---')(R(AFMT));
 GFMT:   FORMAT(SKIP,6 A);
 AFMT:   FORMAT(SKIP,A,F(4),A);
         GO TO L1520;
 L1500:  B=B-.50003-.27*RND(X);
         IF B0>2 THEN B=MAX(B,2);
 L1520:  IFTIME=1;
         IF Q=1 THEN GOTO L1570;
         IF Q=3 THEN GOTO L1570;
         IF B>8 THEN GOTO L1570;
         B=MAX(B0-.651234,B);
 L1570:  B0=B;
         RETURN;END;
 L1590:  IF A>4 THEN IFTIME=0;
         IF A>4 THEN GOTO L4000;
         Z2=1;
         A9(Q1)=A9(Q1)+1;
 L1640:   /*  NEW PLAY-------- */;
         IF I=1 THEN IF Q1=1 THEN GOTO L1710;
         IF INDEX(OPTION,'H')<=0 THEN GOTO L1710;
         PUT SKIP;
         IF I=2 THEN GOTO L1710;
         PUT EDIT (' ')(A);PUT SKIP;
 L1710: /*  DIGITS(2) */;
         CALL L4780;
         IF Z>20 THEN GOTO L1770;
         IF Z<1 THEN GOTO L1770;
         X5(Q1,Z)=MAX(-29,X5(Q1,Z)-23*RND(X));
         IF RND(X)<.15 THEN X5(Q1,1+19.9*RND(X))=0;
 L1770:  IF 3-I=1 THEN GO TO L1820;
         IF 3-I=3 THEN GO TO L1790;
 L1780:  IF Q1=1 THEN GO TO L1820;
 L1790:  B=MAX(B,.001);
         PUT EDIT('>>',TRUNC(B),':',60*(B-TRUNC(B)))(A,P'ZZ',A,P'99');
         GO TO L9340;
 L1820:  IF A>4 THEN GOTO L4000;
         B=MAX(B,0);
 L1850:  B=MAX(B,.001);
 L1930: PUT SKIP;
     PUT EDIT('>>',TRUNC(B),':',60*(B-TRUNC(B)))(SKIP,A,P'ZZ',A,P'99');
         ON CONVERSION GO TO L1930;
         /*  ASK USER FOR INPUT */
 L1960:  GET LIST(Z);
         ON CONVERSION SYSTEM;
 L1990:  IF Z<-20 THEN GO TO L1960;
         IF Z<0 THEN DO;Z=ABS(Z);IFTIME=-1;END;
         IF Z<=20 THEN GO TO PLAYCOUNT;
         IF Z=25 THEN GOTO L2340;
         IF Z=50 THEN GOTO L7060;
         IF Z=200 THEN DO;
           PUT EDIT('<',QUARTERS(Q),'QUARTER ',TEAM(1),SCORE(1),
           TEAM(2),SCORE(2),'>')
           (SKIP(2),A,A,X(1),A,A,X(2),F(3),X(6),A,X(2),F(3),A);
           PUT EDIT(TEAM(Q1),' BALL ',QUARTERS(A),' DOWN AND ',
           MIN(D2,TOGO),' ON ')(SKIP,A,A,A,X(1),A,F(3),A);
           IF YDLINE<=50.0 THEN
              PUT EDIT(' <OWN> ',YDLINE,' YARD LINE')(A,F(3),A);
             ELSE
              PUT EDIT(' ',TEAM(3-Q1),100-YDLINE,' YARD LINE')
              (A,A,F(3),A);
           GO TO L1850;
           END;
 L2080: IF Z=0 THEN DO;
 L2090:    PUT EDIT(' ENTER NO. OF PLAYERS (0/1/2)')(R(GFMT));
           PUT SKIP;GET LIST(I);
           IF 3-I<1 THEN GOTO L2090;
           IF 3-I>3 THEN GOTO L2090;
           GO TO L1640;
           END;
 L2140:  IF Z=100 THEN GOTO L2190;
         IF Z>520 THEN GOTO L1850;
         IF Z>500 & Z<=520 THEN DO;
            Z0=Z-500;
            PUT EDIT(AS(Z0),.5000*X1(Q1,Z0),-X2(Q1,Z0),
              MIN(93,100*X3(Q1,Z0)),'%')
              (SKIP,A, 3 F(4),A);
            END;
         GO TO L1850;
 L2190:  PUT EDIT('GAIN LOSS PROB   GAIN LOSS PROB')
           (SKIP,X(22),A);
         PUT EDIT('25-PUNT  50-FG',TEAM)
           (SKIP,A(14),X(11),A(16),X(1),A(16));
         DO Z0=1 TO 20;
         PUT EDIT(Z0,AS(Z0),.5*X1(1,Z0),-X2(1,Z0),MIN(93,100*X3(1,Z0)),
            .5*X1(2,Z0),-X2(2,Z0),MIN(93,100*X3(2,Z0)))
            (SKIP,F(2),X(2),A(16),X(1),F(3),X(2),F(3),X(2),F(3),
            X(5),F(3),X(1),F(3),X(1),F(3));
            END;
         PUT SKIP;
         GO TO L1850;
         /*      THE ACTION    */
 L2370:  TOGO=YDLINE;
         YDLINE=100-TOGO;
         A,W=0;
         D1,D2=10;
         GO TO L4000;
 L2340:  PUT  EDIT(' //PUNT// ')(A);
         P=25+32*.3333*(RND(X)+RND(X)+RND(X));
         IF RND(X)<.2 THEN P=30+30*RND(X);
         IPLAYTYPE=3;
         A9(Q1)=A9(Q1)-1;
         IFTIME=0;
         NOPUNTS(Q1)=NOPUNTS(Q1)+1;
         IF Z=80 THEN GOTO L2530;
         IF A<4 THEN GOTO L2530;
         IF RND(X)<.02 THEN GOTO L3210;
 L2530:  PUT EDIT('GOOD FOR',(.5000+P),' YARDS  ')(A,F(3),A);
         TOTPUNTS(Q1)=TOTPUNTS(Q1)+P;
         Q3=1;
         P3=P+YDLINE;
         IF P3<100 THEN GOTO L2640;
         PUT EDIT('<<TOUCHBACK>>')(R(GFMT));
         A,W=0;
         D1,D2=10;
         YDLINE,B1=20;
         TOGO=80;
         GO TO L2960;
 L2640:
     IF A<4 THEN GOTO L2820;
     IF RND(X)<.92 THEN GOTO L2700;
     P7=20+TRUNC(30*.5000*(RND(X)+RND(X)));
     IF P3+P7<99 THEN GOTO L2760;
     P7=99-P3;
     GO TO L2760;
 L2700:
     IF RND(X)<.3 THEN GOTO L2730;
     P7=TRUNC(12*.5000*(RND(X)+RND(X))+1);
     GO TO L2760;
 L2730:
     P7=0;
   PUT  EDIT('A FAIR CATCH ')(R(GFMT));
     GO TO L2900;
 L2760:
     IF RND(X)>.12 THEN GOTO L2880;
     P7=MAX((-100+P3)*.5000*(RND(X)+RND(X))+1,4-21*.5000*(RND(X)+RND(X)
    ));
 PUT EDIT(' THE BALL IS NOT CAUGHT, IT ROLLS ',-P7,' YARDS')
        (SKIP,A,F(3),A);
     TOTPUNTS(Q1)=TOTPUNTS(Q1)-P7;
     GO TO L2900;
 L2820:
     P7=TRUNC(MAX(-(100-P3)*.5000*(RND(X)+RND(X))+1,-(11*.5000*(RND(X)+
     RND(X)))));
     IF RND(X)<.1 THEN P7=5*RND(X);
     IF RND(X)<.3 THEN P7=TRUNC(P7*RND(X));
     PUT EDIT('A ROLL OF',-TRUNC(P7),' YARDS ')(SKIP,A,F(4),A);
     TOTPUNTS(Q1)=TOTPUNTS(Q1)-P7;
     GO TO L2900;
 L2880:
     P7=MIN(P3,P7);
     PUT EDIT(' RETURNED ',TRUNC(.5000+P7),' YARDS')(SKIP,A,F(4),A);
 L2900:   TOGO=P3-P7;
     Q3=1;
 YDLINE=100-TOGO;
     A,W=0;
     D1,D2=10;
   B1=YDLINE;
 L2960:     Q1=3-Q1;
     GO TO L5980;
 L2990:
   PUT  EDIT('  >>> !!! FUMBLE !!! <<<')(R(GFMT));
     IPLAYTYPE=3;
     NFMBL(Q1)=NFMBL(Q1)+1;
     Y=20*RND(X)-10;
     IF RND(X)>.25 THEN GOTO L3070;
   PUT  EDIT(' * RECOVERY BY ',TEAM(Q1))(R(GFMT));
     IF Y>=0 THEN GOTO L5630;
     GO TO L4410;
 L3070:
 TOGO=YDLINE+Y;
     IFTIME=0;
     FMBREC(Q1)=FMBREC(Q1)+1;
 YDLINE=100-TOGO;
   IF YDLINE>=100 THEN GOTO L3170;
   IF YDLINE>0 THEN GOTO L4000;
     Q1=3-Q1;
   PUT  EDIT('RECOVERED IN THE ENDZONE ')(R(GFMT));
     A=0;
     GO TO L1240;
 L3170:
   PUT  EDIT('RECOVERED IN THE ENDZONE')(R(GFMT));
     A=0;
     Q1=3-Q1;
     GO TO L6430;
 L3210:
   PUT  EDIT(' >>> B L O C K E D <<<')(R(GFMT));
     Q3=1;
     RETURN=7.0+40*.500*(RND(X)+RND(X));
     IF RND(X)<.15 THEN RETURN=80*RND(X);
  L3260:   PUT  EDIT('  BALL TAKEN BY ',TEAM(3-Q1))(R(GFMT));
         IF YDLINE<=RETURN THEN GO TO L4170;
         PUT EDIT(' RETURNED ',RETURN,' YDS')(A,F(4),A);
 L3300:  TOGO=YDLINE-RETURN;
         YDLINE=100-TOGO;
         GO TO L4000;
 L3400:  Q3=1;
         PUT EDIT('>>> RETURNED FOR A ',TEAM(3-Q1),' T O U C H D O W N')
                 (R(GFMT));
         Q1=3-Q1;
         GO TO L6430;
         /* ************************************** */
 PLAYCOUNT:
        IF RND(X)<.04 THEN GOTO L8540;
        DO Z8=1 TO Z-1,Z+1 TO 20;
           X5(Q1,Z8)=MIN(15,X5(Q1,Z8)+.24*(1+RND(X))/X3(Q1,Z8));
 L3420:    END;
        IF I=1 THEN IF Q1=2 THEN X5(Q1,Z)=0;
        IF Z>10 THEN GOTO L3480;
        NORUNS(Q1)=NORUNS(Q1)+1;
        IPLAYTYPE=1;
        PUT  EDIT(VS(Z*4+1-4*RND(X)))(A);
        GO TO L4340;
 L3480: IPLAYTYPE=2;
        NOPASS(Q1)=NOPASS(Q1)+1;
        Z2=1;
        IF Z=18 THEN GOTO L3630;
        IF Z^=19 THEN DO;
          PUT  EDIT(VS(Z*4+1-4*RND(X)))(A);
          GOTO L3740;
          END;
        PUT  EDIT(' A ROLLOUT BY THE QUARTERBACK ')(A);
     IF RND(X)<.3 THEN GOTO L3650;
     IF RND(X)<.5000 THEN GOTO L3720;
     IPLAYTYPE=1;
     NOPASS(Q1)=NOPASS(Q1)-1;
     NORUNS(Q1)=NORUNS(Q1)+1;
     PUT EDIT('WHO LATERALS TO THE ',VS(75+2*RND(X)))(A,A);
     Z2=.5000;
     GO TO L4340;
 L3630:
   PUT  EDIT(' A HANDOFF TO THE HALFBACK ')(A);
     IF RND(X)<.4 THEN GOTO L3720;
 L3650:
     PUT EDIT('WHO RUNS AROUND ',VS(73+2*RND(X)))(A,A);
     NORUNS(Q1)=NORUNS(Q1)+1;
     Z2=.65;
     IF Z=18 THEN Z2=.5000;
     IPLAYTYPE=1;
     NOPASS(Q1)=NOPASS(Q1)-1;
     GO TO L4340;
 L3720:
     PUT EDIT('WHO PASSES TO THE ',VS(69+4.5000*RND(X)))(A,A);
     Z2=1.8;
 L3740:
     O2=FNN(X5(Q1,Z))*X3(Q1,Z);
     IF INDEX(OPTION,'P')>0 THEN
     PUT EDIT(TRUNC(X5(Q1,Z)),TRUNC(MIN(95,100*O2)),'%')
           (SKIP,F(3),X(2),F(4),A);
     Y=MAX(.25*X1(Q1,Z),FNN(X5(Q1,Z))*RND(X)*X1(Q1,Z));
     Y=MIN(Y,X1(Q1,Z)+10*RND(X));
     IF RND(X)<.07 THEN GOTO L3800;
     IF RND(X)<O2 THEN GOTO L5590;
 L3800:
     IF RND(X)<.07+.0008*X1(Q1,Z) THEN GOTO INCOMPLETE;
     GO TO L4200;
 INCOMPLETE:
     PUT EDIT('>>> INTERCEPTED BY ',TEAM(3-Q1))(R(GFMT));
     IFTIME=0;
     Y=MIN(TRUNC(.5000*(RND(X)+RND(X))*X1(Q1,Z)+1),30);
     Q3=1;
     O4(Q1)=O4(Q1)+1;
     R2=16*.5000*(RND(X)+RND(X));
   IF RND(X)<.25 THEN R2=2*TOGO*RND(X)-1;
   IF TOGO-Y>=1 THEN GOTO L3950;
   PUT  EDIT(' IN THE ENDZONE -- TOUCHBACK <<<')(A);
   TOGO=80;
   YDLINE=20;
     GO TO L4000;
 L3950:
 TOGO=YDLINE+Y-R2;
 YDLINE=100-TOGO;
   IF YDLINE>=100 THEN GOTO L4170;
  PUT EDIT(' !!! RUN BACK ',R2,' YARDS ')(A,F(3),A);
 L4000:
   B1=YDLINE;
     A,W=0;
     D1,D2=10;
     IF B1>50 THEN GOTO L4090;
     Q3=1;
 PUT EDIT(' --- ',TEAM(3-Q1),' TAKE OVER ON <OWN> ',
  .5000*(2.00*B1+.5000),' ---')(SKIP,3 A,F(4),A);
     IF IFTIME=-1 THEN IFTIME=0;
     Q1=3-Q1;
     GO TO L4750;
 L4090:
     B1=100-B1;
   IF TOGO>10 THEN GOTO L4120;
     Q3=2;
 L4120:
     A,W=0;
     PUT EDIT('     ----',TEAM(3-Q1),' TAKE OVER ON THE ',TEAM(Q1),
     .5000*TRUNC(2*B1+.5000),' ---')
     (SKIP,3 A,A,F(4),A);
     IF IFTIME=-1 THEN IFTIME=0;
     Q1=3-Q1;
     GO TO L4750;
 L4170:
   PUT  EDIT(' --- RETURNED ALL THE WAY---')(R(GFMT));
         Q1=3-Q1;
         GO TO L6430;
 L4200:  IF RND(X)/FNN(.3*SCORE(3-Q1)-.3*SCORE(Q1))>.2 THEN GOTO L4240;
         Y=MIN(-.1,-X2(Q1,Z)*.5000*(RND(X)+RND(X)));
         O7(Q1)=O7(Q1)+1;
         GO TO L4410;
 L4240:  PUT  EDIT(' <<INCOMPLETE>> ')(R(GFMT));
         IF IFTIME^=-1 THEN GOTO L4260;
         IF RND(X)<.5000 THEN GOTO L4310;
         GO TO L4330;
 L4260:  IFTIME=0;
         B1=YDLINE;
         GO TO L6180;
 L4310:  PUT  EDIT('HALFBACK')(R(GFMT));
         GO TO L4340;
 L4330:  PUT  EDIT('FULLBACK')(R(GFMT));
 L4340:  O2=MIN(.9300,X3(Q1,Z)*FNN(X5(Q1,Z)));
         IF INDEX(OPTION,'P')>0 THEN
             PUT EDIT(TRUNC(X5(Q1,Z)),TRUNC(MIN(95,100*O2)),'%')
                     (SKIP,F(3),X(2),F(4),A);
         IF RND(X)<O2 THEN GOTO L5470;
         IF RND(X)<.12 THEN GOTO L2990;
         PUT  EDIT(' STOPPED FOR ')(SKIP,A);
         GO TO L4670;
 L4400:  B=B+.002*Y;
 L4410:  D1=D1-(Y);
         YDLINE=YDLINE+Y;
         TOGO=100-YDLINE;
         B1=YDLINE;
         IF B1<=0 THEN GOTO L4470;
         GO TO L4630;
 L4470:
     IF Z<=5 THEN GOTO L4500;
   PUT  EDIT('* PASSER TACKLED *')(R(GFMT));
     IPLAYTYPE=2;
 L4500:
     IF Y>-1 THEN GOTO L4530;
    PUT EDIT(' A LOSS OF ',-Y,' YARDS')(R(LOSSFMT));
 LOSSFMT:FORMAT(A,F(IFMT2(Y),IFMT(Y)),A);
     GO TO L4550;
 L4530:
   Y=MIN(Y,YDLINE);
    PUT EDIT(' A LOSS OF ',-Y,' YARDS')(R(LOSSFMT));
 L4550:  YARDS(Q1,IPLAYTYPE)=YARDS(Q1,IPLAYTYPE)+Y;
   PUT  EDIT(' >>> S A F E T Y <<<')(A);
     Z=80;
     ISCORE(3-Q1,Q)=ISCORE(3-Q1,Q)+2;
   SCORE(3-Q1)=SCORE(3-Q1)+2;
     CALL L6600;
     GO TO L6740;
 L4630:IF IPLAYTYPE=2 THEN   PUT  EDIT('* PASSER TACKLED ')(R(GFMT));
    PUT EDIT(' A LOSS OF ',-Y,' YARDS')(R(LOSSFMT));
  YARDS(Q1,IPLAYTYPE)=YARDS(Q1,IPLAYTYPE)+Y;
     GO TO L6160;
 L4670:     Y=1-RND(X)*(X2(Q1,Z)+1);
     IF RND(X)<.5000 THEN Y=2*(RND(X)-.5000);
     IF ABS(Y)<.1 THEN GOTO L4720;
     IF Y<0 THEN GOTO L4400;
     GO TO L5550;
 L4720:
   PUT  EDIT(' NO GAIN')(A);
   B1=YDLINE;
     GO TO L6180;
 L4750:     CALL NEWTIME;
     CALL L4780;
     GO TO L4910;
 L4780: PROC;
     IF Z6=1 THEN GOTO L4900;
     IF B>2.2 THEN GOTO L4900;
     IF Q=1 THEN GOTO L4900;
     IF Q=3 THEN GOTO L4900;
  PUT EDIT (' ')(A);PUT SKIP;
  GFMT:FORMAT(SKIP,6 A);
  PUT EDIT('   *** 2 MINUTE WARNING ***')(R(GFMT));
     IF Q=4 THEN GOTO L4870;
   PUT  EDIT('           --- FIRST HALF ---')(R(GFMT));
     GO TO L4880;
 L4870:
  PUT  EDIT(' SECOND HALF')(R(GFMT));
 L4880:     B,B0=MIN(B,2);
     Z6=1;
 L4900:
     RETURN;END;
 L4910:     IF B>.011 THEN GOTO L1370;
     IF Q=2 THEN GOTO L4990;
     IF Q>=4 THEN GOTO L5130;
  PUT EDIT('... END OF ',QUARTERS(Q),' QUARTER ...')(SKIP(3),3 A);
     Z6=.25;
     GO TO L5420;
 L4990:
   PUT  EDIT('  ******* END OF THE FIRST HALF *******')
          (SKIP(3),A);
     T0(1)=T0(2)=0;
  PUT EDIT(TEAM,SCORE)(SKIP,X(1),2 A(25),SKIP,F(5),F(25));
   PUT  EDIT('*** FIRST HALF  STATISTICS ***')(SKIP(2),A);
     Z6=.25;
     GO TO L7740;
 L5080:
     B,B0=LENPER;
     Z6=.25;
     Q=Q+1;
     CALL L6620;
    IF U=1 THEN GO TO L6780;ELSE GO TO L6930;
 L5130:
 PUT EDIT (' ')(A);PUT SKIP;
 PUT EDIT(' - - - - - - - - - - - - - - - - -')(SKIP(3),A);
 PUT EDIT(' +++++ F I N A L   S C O R E +++++')(SKIP,A);
 PUT EDIT('     TEAM','1   2   3   4   TOTAL')(SKIP,A(23),A);
 PUT EDIT('-----------------------','--  --  --  --  -----')(SKIP,A(23),
            A);
 PUT EDIT(TEAM(1),ISCORE(1,*),SCORE(1))
   (SKIP,A(20),4(X(1),F(3)),X(5),F(3));
 PUT EDIT(TEAM(2),ISCORE(2,*),SCORE(2))
   (SKIP,A(20),4(X(1),F(3)),X(5),F(3));
 PUT EDIT('- - - - - - - - - - - - -')(SKIP,A);
  PUT SKIP(3);
 PUT  EDIT('Z1=',Z1)(SKIP(3),A,F(4,1));
 PUT EDIT(' PTS/Z1=',SUM(SCORE)*15/(LENPER*Z1))(X(1),A,F(4,1));
 PUT EDIT ('TOTAL YARDS',SUM(YARDS))(SKIP,A,X(1),F(4));
     PUT SKIP;
     PUT EDIT(' ------>')(R(GFMT));
     GO TO L7720;
 L5420:     Q=Q+1;
     B,B0=LENPER;
     Z6=.25;
     GO TO L1370;
 L5470:
     IF Z>9 THEN GOTO L5540;
   Y=Z2*(X1(Q1,Z)*.25*(RND(X)+RND(X)+RND(X)+RND(X)))*FNP(YDLINE);
     IF Y<.25*X1(Q1,Z) THEN Y=MAX(1,.25*X1(Q1,Z)-RND(X));
     IF RND(X)>.08 THEN GOTO L5550;
     Y=Y*3*(RND(X)+1);
   PUT  EDIT('---HE FINDS A BIG HOLE---')(R(GFMT));
     GO TO L5550;
 L5540:  Y=Z2*(X1(Q1,Z)*.5000*(RND(X)+RND(X)))*FNP(YDLINE);
 L5550:  W=W+Y;
         IPLAYTYPE=1;
         GO TO L5650;
 L5590:  Y=Y*FNP(YDLINE);
         IF RND(X)>.12 THEN GOTO L5630;
         PUT  EDIT('---HE FIGHTS OFF A TACKLE---')(R(GFMT));
         Y=Y*3*(RND(X)+1);
 L5630:  W=W+Y;
         IF IPLAYTYPE=2 THEN J5(Q1)=J5(Q1)+1;
 L5650:  /*  X5(Q1,Z)=MAX(-15,X5(Q1,Z)-5*RND(X)) */;
         IF W>=D1 THEN GOTO L5690;
         GO TO L6080;
 L5690:
   YDLINE=YDLINE+Y;
   TOGO=TOGO-Y;
     A,W=0;
   IF YDLINE >=100 THEN GOTO TOUCHDOWN;
   IF TOGO>10 THEN GOTO L5780;
     Q3=2;
   D1,D2=TOGO;
   B1=YDLINE;
     GO TO L5790;
 L5780:
   B1=YDLINE;
 L5790:     D1,D2=10;
     PUT EDIT(' A GAIN OF ',Y,' YARDS')
      (COL(IFSTOP(Y)),A,F(IFMT2(Y),IFMT(Y)),A);
    IFSTOP:PROC(Y);IF Y<1 THEN RETURN(14);
           ELSE RETURN(1);END;
     CALL L5840;
     B=B-2.5000*RND(X)*.002*Y;
     GO TO L5940;
 L5840 :PROC;
     IF Z>10 THEN GOTO L5860;
         IF Z<3 THEN GOTO L5930;
          IF Z=3 THEN GOTO L5880;
    IF RND(X)<.3 THEN GOTO L5880;
          IF Z=4 × Z=5 THEN GOTO L5890;
 L5860:
     IF RND(X)>.4 THEN GOTO L5930;
 L5880:     IF RND(X)>.7 THEN GOTO L5930;
  L5890:   IF RND(X)>.2 THEN GOTO L5930;
     IF RND(X)>.8 THEN GOTO L5930;
     IFTIME=0;
   PUT  EDIT('    - OUT OF BOUNDS -')(R(GFMT));
  GFMT:FORMAT(SKIP,6 A);
 L5930:
     RETURN;END;
 L5940:  YARDS(Q1,IPLAYTYPE)=YARDS(Q1,IPLAYTYPE)+Y;
     K9(Q1)=K9(Q1)+1;
   IF TOGO>10 THEN GOTO L5980;
     Q3=2;
 L5980:
     PUT EDIT(' ',TEAM(Q1),' BALL ')(R(GFMT));
 L5990:
     WS='<OWN>';
     O2=Q1;
     IF B1<=50 THEN GOTO L6040;
     WS=TEAM(3-Q1);
   B1=100-YDLINE;
 L6040:
  PUT EDIT('** F I R S T  D O W N **  ON ',WS,B1)
   (2 A,F(4));
     A,W=0;
     D1,D2=10;
     GO TO L4750;
 L6080:   YDLINE=YDLINE+Y;
   TOGO=TOGO-Y;
   IF YDLINE>100 THEN GOTO TOUCHDOWN;
   B1=YDLINE;
   PUT EDIT(' A GAIN OF ',Y,' YARDS')
   (COL(IFSTOP(Y)),A,F(IFMT2(Y),IFMT(Y)),A);
     CALL L5840;
     IF IPLAYTYPE>2 THEN GOTO L6160;
   YARDS(Q1,IPLAYTYPE)=YARDS(Q1,IPLAYTYPE)+1;
 L6160:
     IF A>=4 THEN GOTO L2370;
     D2=D2-Y;
 L6180:     IF A>=4 THEN GOTO L2370;
     PUT EDIT(' ',TEAM(Q1),' BALL ')(SKIP,3 A);
     IF B1>50 THEN GOTO L6370;
 L6210:     WS='<OWN>';
   B1=YDLINE;
   IF YDLINE<50 THEN GOTO L6260;
     WS=TEAM(3-Q1);
   B1=100-YDLINE;
 L6260:
     IF Q3=2 THEN GOTO L6320;
 L6300:
  PUT EDIT(QUARTERS(A+1),' DOWN AND ',MIN(TOGO,D2),
      ' ON ',WS,B1)
       (X(1),A,A,F(IFMT2(MIN(TOGO,D2)),IFMT(MIN(TOGO,D2))),2 A,F(5));
     GO TO L4750;
 L6320:
  PUT EDIT(QUARTERS(A+1),' DOWN AND  G O A L  ON ',WS,B1)
          (X(1),2 A,X(1),A,F(IFMT2(B1),IFMT(B1)));
     GO TO L4750;
 L6370:
   B1=100-YDLINE;
     GO TO L6210;
 TOUCHDOWN:
   Y=100-YDLINE+Y;
  PUT EDIT(' A GAIN OF ',Y,' YARDS ')
      (COL(IFSTOP(Y)),A,F(IFMT2(Y),IFMT(Y)),A);
     Q3=1;
   YARDS(Q1,IPLAYTYPE)=YARDS(Q1,IPLAYTYPE)+Y;
 L6430:   PUT  EDIT(' !!! T O U C H D O W N !!!')(R(GFMT));
     IF IFTIME=-1 THEN IFTIME=0;
     CALL NEWTIME;
     IFTIME=0;
   PUT  EDIT('  THE EXTRA POINT TRY')(R(GFMT));
     IF RND(X)>.0323 THEN GOTO L6520;
   PUT  EDIT(' IS >>> BLOCKED <<<')(A);
     G=6;
     GO TO L6550;
 L6520:
   PUT  EDIT(' IS  G O O D  ')(A);
     CALL L4780;
     G=7;
  L6550:    IF(Q1=2) THEN GO TO L6900;
 L6560:     ISCORE(Q1,Q)=ISCORE(Q1,Q)+G;
   SCORE(Q1)=SCORE(Q1)+G;
     CALL L6600;
     GO TO L6720;
 L6600:  PROC;
 L6620:    ENTRY;
           PUT EDIT('<',QUARTERS(Q),'QUARTER: ',TEAM(1),SCORE(1),
                    ' --- ',TEAM(2),SCORE(2),'>')
                    (SKIP,A,A,X(1),2 A,F(3),2 A,F(3),3 A);
           IF INDEX(OPTION,'H')<=0 THEN GOTO L6710;
 L6640:    ENTRY;
           IF Z<100 THEN PUT SKIP;
           PUT  EDIT('** SCORE **')(A);
           PUT SKIP;
           PUT EDIT('*',SCORE(1),'-',SCORE(2),'*')
                   (2(A,X(1),P'99',X(1)),A);
           PUT SKIP(2) EDIT (' ') (A); PUT SKIP;
 L6710:    RETURN; END;
 L6720:  IF Z=80 THEN GOTO L6740;
         GO TO L6780;
 L6740:  YDLINE=20;
         TOGO=80;
         A=4;
         GO TO L2340;
 L6780:  Q1=2;
         IF Z=80 THEN GOTO L6810;
         GO TO L6850;
 L6810:  YDLINE=20;
         TOGO=80;
         A=4;
         GO TO L2340;
 L6850:  PUT EDIT(' ', TEAM(3-Q1),' WILL KICK OFF...')(A);
         IPLAYTYPE=3;
         A,W=0;
         IF SCORE(Q1)>=SCORE(3-Q1) THEN GOTO L9040;
         GO TO L840;
 L6900:  ISCORE(Q1,Q)=ISCORE(Q1,Q)+G;
         SCORE(Q1)=SCORE(Q1)+G;
         CALL L6600;
 L6930:  Q1=1;
         IF Z=80 THEN GOTO L6740;
         PUT EDIT(' ', TEAM(3-Q1),' WILL KICK OFF...')(A);
         IPLAYTYPE=3;
         A,W=0;
         IF SCORE(Q1)>=SCORE(3-Q1) THEN GOTO L9040;
         GO TO L840;
 L7030:  Q1=2;
 L7040:  A,W=0;
         GO TO L1370;
 L7060:  PUT EDIT('***',TOGO+7,' YARD FIELD GOAL ATTEMPT')(A,F(3),A);
         YDLINE=YDLINE-7;
         TOGO=100-YDLINE;
         A9(Q1)=A9(Q1)-1;
         IFTIME=0;
         FIELDGOALS(Q1)=FIELDGOALS(Q1)+1;
         FGRCD(Q1,FIELDGOALS(Q1))=TOGO;
         B=B-.35;
         K=40+22.00*.5000*(RND(X)+RND(X));
         IF RND(X)<.25 THEN
         K=32+25.0*RND(X);
 L7190:  IF RND(X)<.1 THEN GOTO FGBLOCKED;
         IF K<FIXED(TOGO) THEN GOTO FGSHORT;
         IF RND(X)>SIN(1.57*(1-(TOGO)/64.00))THEN GOTO FGNOGOOD;
         GO TO FGGOOD;
 FGSHORT: PUT  EDIT(' >>> SHORT <<< ')(R(GFMT));
         FGRCD(Q1,FIELDGOALS(Q1))=FGRCD(Q1,FIELDGOALS(Q1))+300;
         YDLINE=YDLINE+K;
         TOGO=100-YDLINE;
         IF YDLINE>50 THEN
          PUT EDIT(' CAUGHT ON THE',(100-YDLINE),' YARD LINE')(A,F(3));
         RETURN=30*RND(X);
         IF RND(X)<.2 THEN RETURN=10*RND(X);
         IF RND(X)<.1 THEN RETURN=60*RND(X);
         GO TO L3260;
 FGNOGOOD:
 L7510:  PUT  EDIT(' THE KICK IS LONG ENOUGH ')(R(GFMT));
         PUT  EDIT(' >>> NO GOOD <<<')(R(GFMT));
         FGRCD(Q1,FIELDGOALS(Q1))=FGRCD(Q1,FIELDGOALS(Q1))+200;
         IF RND(X)<.32 THEN GOTO L7400;
         Q1=3-Q1;
         A,W=0;
         GO TO L1240;
 L7400:  YDLINE=1.00+.333*(RND(X)+RND(X)+RND(X))*38.00;
         IF RND(X)>.05 THEN GOTO L7430;
         YDLINE=1.00+105.0*.333*(RND(X)+RND(X)+RND(X));
 L7430:  PUT EDIT(' --- RETURNED ',YDLINE+5.00*RND(X)+1.00,
                  ' YARDS ---') (SKIP,A,F(4),A);
         TOGO=100-YDLINE;
         GO TO L4000;
 FGBLOCKED:
         PUT  EDIT(' >>> BLOCKED <<<')(R(GFMT));
         FGRCD(Q1,FIELDGOALS(Q1))=FGRCD(Q1,FIELDGOALS(Q1))+400;
         RETURN=0;
         GO TO L3300;
 FGGOOD: PUT  EDIT(' THE KICK IS LONG ENOUGH ')(R(GFMT));
         PUT  EDIT(' !!! GOOD !!!')(A);
         FGRCD(Q1,FIELDGOALS(Q1))=FGRCD(Q1,FIELDGOALS(Q1))+500;
 L7540:  G=3;
         GO TO L6550;
 L7720:  PUT EDIT('******** STATISTICS ********')(SKIP(3),A);
 L7740:  PUT EDIT (TEAM(1),TEAM(2))(SKIP,2 A(17));
         ON ZERODIVIDE;
 STATFMT:FORMAT(SKIP,F(6),F(17),X(3),COL(30),A);
 AVGFMT:FORMAT(SKIP,F(8,1),F(17,1),X(3),COL(30),A);
 PERCENTFMT:FORMAT(SKIP,F(8,1),A(1),F(16,1),A(1),X(2),COL(30),A);
 PUT EDIT(SUM(YARDS(1,*)),SUM(YARDS(2,*)),'TOTAL OFFENSIVE YARDS')
    (R(STATFMT));
 PUT EDIT(A9,'TOTAL PLAYS')
    (R(STATFMT));
 PUT EDIT(K9,'FIRST DOWNS')
    (R(STATFMT));
 PUT SKIP;
 PUT  EDIT(YARDS(*,1),'RUSHING YARDAGE')
    (R(STATFMT));
 PUT EDIT(YARDS(*,1)/NORUNS,'AVG YARDS RUSHING')
    (R(AVGFMT));
 PUT SKIP;
 PUT EDIT(NOPASS,'PASSES ATTEMPTED')
    (R(STATFMT));
 PUT EDIT(J5,'PASSES COMPLETED')
    (R(STATFMT));
 PUT EDIT(100*J5(1)/NOPASS(1),'%',100*J5(2)/NOPASS(2),'%',
  'PERCENT COMPLETIONS')
    (R(PERCENTFMT));
 PUT EDIT(YARDS(*,2),'PASSING YARDAGE')
    (R(STATFMT));
 PUT EDIT(YARDS(*,2)/J5,'AVG. YARDS PASSING')
    (R(AVGFMT));
 PUT SKIP;
 PUT EDIT(O7,'TIMES PASSER TACKLED')
    (R(STATFMT));
 PUT EDIT(O4,'TIMES INTERCEPTED')
    (R(STATFMT));
 PUT SKIP;
 PUT EDIT(NOPUNTS,'PUNTS')
    (R(STATFMT));
 PUT EDIT(TOTPUNTS/NOPUNTS,'AVG. YARDS PER PUNT')
    (R(AVGFMT));
 PUT SKIP;
 PUT EDIT(NFMBL,'FUMBLES')
    (R(STATFMT));
 PUT EDIT(FMBREC,'FUMBLES LOST')
    (R(STATFMT));
 PUT SKIP;
 PUT EDIT(P4,'NO. PENALTIES')
    (R(STATFMT));
 PUT EDIT(P6,'YARDS PENALIZED')
    (R(STATFMT));
     BS(1)='GOOD';
     BS(2)='NO GOOD';
     BS(3)='SHORT';
     BS(4)='BLOCKED';
     BS(5)='GOOD';
     DO Z8=1 TO 2;
     IF FIELDGOALS(Z8)=0 THEN GOTO L8150;
     PUT EDIT('   FIELD GOAL ATTEMPTS BY ',TEAM(Z8))(R(GFMT));
     DO O2=1 TO FIELDGOALS(Z8);
     Q1=TRUNC(FGRCD(Z8,O2)/100);
  PUT EDIT('    ',FGRCD(Z8,O2)-Q1*100,' YARDS -- ',BS(Q1))
          (SKIP,A,F(3),2 A);
     END;
 L8150:
     END;
     IF Q<4 THEN GOTO L5080;
     EXIT;
 L8190:
     DO Q1=1 TO 2;
     X1(Q1,9)=8+2*RND(X);
     X1(Q1,10)=10+40*RND(X);
     X1(Q1,11)=30+50*RND(X);
     X1(Q1,12)=MIN(10,5+8*RND(X));
     X1(Q1,13)=MAX(9,5+12*RND(X));
     X1(Q1,14)=5+9*RND(X);
     X1(Q1,15)=MAX(12,10+10*RND(X));
     X1(Q1,16)=MAX(12,53+20*RND(X));
     X1(Q1,17)=MAX(12,10+20*RND(X));
     X1(Q1,18)=MAX(12,10+10*RND(X));
     X1(Q1,19)=MAX(12,10+10*RND(X));
     X1(Q1,20)=MAX(12,120+30*RND(X));
 L8320:
     Z8=1+TRUNC(10.00*RND(X));
     IF 2*X1(Q1,Z8)>35 THEN GOTO L8320;
     X1(Q1,Z8)=X1(Q1,Z8)*2;
      /* *******DEBUG ******* */; COUNT8350=1;
 L8350:
     Z8=9.00+TRUNC(RND(X)*10.5000);
 /***** DEBUG */; COUNT8350=COUNT8350+1;IF COUNT8350>30 THEN GO TO LNG;
     IF X1(Q1,Z8)*2.5000>80 THEN GOTO L8350;
  LNG:    X1(Q1,Z8)=X1(Q1,Z8)*2.5000;  /* DEBUG */;
     DO Z8=1 TO 20;
     X2(Q1,Z8)=X1(Q1,Z8)*MIN(.5000,RND(X));
     IF Z8>9 THEN GOTO L8440;
     IF X2(Q1,Z8)<8 THEN GOTO L8440;
     X2(Q1,Z8)=8;
 L8440:
 X3(Q1,Z8)=(Z1+.100*X2(Q1,Z8)+.5000)/(X1(Q1,Z8)+.100*X2(Q1,Z8)-.5000);
     IF X3(Q1,Z8)>=.9500 THEN X3(Q1,Z8)=.9300;
     IF X2(Q1,Z8)>20 THEN X2(Q1,Z8)=18;
     X5(Q1,Z8)=0;
     END;
     X2(Q1,7)=1;
     X2(Q1,12)=1;
     END;
     GO TO L300;
 L8540:
   PUT  EDIT(' >>> PENALTY AGAINST ')(A);
     B=MAX(.01,B-.1);
     IPLAYTYPE=4;
     A9(Q1)=A9(Q1)-1;
     IFTIME=5;
     IF RND(X)>.5000 THEN GOTO L8680;
     IF RND(X)>.2 THEN GOTO L8650;
   PUT EDIT(TEAM(Q1),'---',MIN(YDLINE/2,15),' YARDS <<<')(R(PENFMT));
   Y=-MIN(YDLINE/2,15);
     GO TO L8740;
 L8650:
   PUT EDIT(TEAM(Q1),'---',MIN(YDLINE/2,5),' YARDS <<<')(R(PENFMT));
   Y=-MIN(YDLINE/2,5);
     GO TO L8740;
 L8680:
     IF RND(X)>.2 THEN GOTO L8720;
   PUT EDIT(TEAM(3-Q1),'---',MIN(TOGO/2,15),' YARDS <<<')(R(PENFMT));
   Y=MIN(TOGO/2,15);
     GO TO L8740;
 L8720:
   PUT EDIT(TEAM(3-Q1),'---',MIN(TOGO/2,5),' YARDS <<<')(R(PENFMT));
 PENFMT:FORMAT(2 A,P'ZZZV.Z',A);
   Y=MIN(TOGO/2,5);
 L8740:     B=MAX(B,.0111);
     IPLAYTYPE=3;
     O2=Q1;
     IF Y<0 THEN GOTO L8800;
     O2=3-Q1;
 L8800:
     P6(O2)=P6(O2)+ABS(Y);
     P4(O2)=P4(O2)+1;
     A=MAX(0,A-1);
   YDLINE=YDLINE+TRUNC(Y);
 TOGO=100-YDLINE;
   B1=YDLINE;
     W=W+Y;
     D2=D2-Y;
     PUT EDIT(' ',TEAM(Q1),' BALL ')(R(GFMT));
     IF D2<=0 THEN GOTO L5990;
     GO TO L6210;
 L8910:
     IF 3-I=2 THEN GOTO L8960;
     TEAM(1)=TEAMNAME(1);
     IF RND(X)<.5000 THEN GOTO L8960;
     TEAM(1)=TEAMNAME(14);
 L8960:
     TEAM(2)=TEAMNAME(TRUNC(26.00*RND(X)+1.00));
     IF TEAM(1)=TEAM(2) THEN GOTO L8960;
   PUT  EDIT('  THE TEAMS ARE')(R(GFMT));
     PUT EDIT('    VISITING TEAM -- ',TEAM(1))(R(GFMT));
     PUT EDIT('        HOME TEAM -- ',TEAM(2))(R(GFMT));
     GO TO L690;
 L9040:
     IF 3-I=3 THEN GOTO L9070;
     IF 3-I=1 THEN GOTO L9140;
     IF Q1=2 THEN GOTO L9140;
 L9070:
   IF Q=4 THEN IF SCORE(Q1)-SCORE(3-Q1)>B THEN GOTO L9220;
   IF SCORE(Q1)-SCORE(3-Q1)>14 THEN GOTO L9100;
     IF B>4 THEN GOTO L840;
 L9100:
     IF Q=1 THEN GOTO L840;
     IF Q=3 THEN GOTO L840;
     IF B>10 THEN GOTO L840;
     GO TO L9210;
 L9140:
     CALL L6620;
     PUT EDIT(TRUNC(B),':',TRUNC(60*(B-TRUNC(B))))(P'ZZ',A,P'99');
   PUT  EDIT(' 0-KICKOFF, 1-ONSIDES KICK ATT.')(A);
     PUT SKIP;GET LIST(T);
     IFTIME=0;
     IF T^=1 THEN GOTO L840;
     GO TO L9240;
 L9210:IF RND(X)*FNN(.3*SCORE(3-Q1)-.3*SCORE(Q1))>.5000 THEN GOTO L840;
 L9220:
   PUT  EDIT(' * AN ATTEMPTED ONSIDES KICK *')(R(GFMT));
     IFTIME=0;
 L9240: IF RND(X)*FNN(.3*SCORE(Q1)-.3*SCORE(3-Q1))>.88 THEN GOTO L9310;
     Q3=1;
     B=B-2.5000*RND(X)*.15;
     Q1=3-Q1;
   YDLINE=40.000+TRUNC(11.00*.5000*(RND(X)+RND(X)));
 TOGO=100-YDLINE;
     GO TO L4000;
 L9310:
   YDLINE=50.00+TRUNC(11.00*.5000*(RND(X)+RND(X)));
 TOGO=100-YDLINE;
     GO TO L4000;
 L9340:   O0=SCORE(Q1)-SCORE(3-Q1);
      /*   DETERMINE NEXT PLAY FOR MACHINE */
     IF B>.4 THEN GOTO L9390;
   IF Q=2 THEN IF TOGO<42 THEN GOTO L7060;
   IF Q=4 THEN IF O0>-4 THEN IF TOGO<42 THEN GOTO L7060;
 L9390:
     IF A=4 THEN GOTO L9530;
     IF A^=3 THEN GOTO L9460;
 L9410:
   IF MIN(D2,TOGO)<Z1/1.5000 THEN GOTO L9590;
   IF TOGO<Z1 THEN GOTO L9590;
     IF Q^=3 THEN IF Q^=1 THEN IF O0<0 THEN GOTO L9440;
   IF RND(X)<.5000 THEN IF TOGO>45 THEN IF MIN(D2,TOGO)>MAX(12,4*RND(X
    )*Z1) THEN GOTO L2340;
 L9440:
     Z=TRUNC(10.000+10.49*RND(X));
     GO TO PLAYCOUNT;
 L9460:
     IF B>3 THEN GOTO L9500;
     IF B>2 THEN IF B<2.33 THEN GOTO L9500;
     IF Q=2 THEN IFTIME=-1;
     IF O0<=0 THEN IF Q=4 THEN IFTIME=-1;
     IF IFTIME=-1 THEN GOTO L9440;
 L9500:
     IF O0<5*B THEN IF Q>2 THEN GOTO L9440;
     Z=TRUNC(1.000+9.000*RND(X));
     IF RND(X)<.5000 THEN GOTO PLAYCOUNT;
     Z=TRUNC(1.000+19.49*RND(X));
     GO TO PLAYCOUNT;
 L9530:
   IF Q=4 THEN IF O0<-B*1.67 THEN IF O0<-3 THEN IF MIN(D2,TOGO)>8
      THEN GOTO L9440;
     IF Q=4 THEN IF O0<-B*1.67 THEN IF O0<-3 THEN GOTO L9410;
   IF Q^=4 THEN IF O0<7 THEN IF O0>-7 THEN IF TOGO<40 THEN GOTO
     L7060;
   IF TOGO<48 THEN IF MIN(D2,TOGO)<Z1*RND(X) THEN GOTO L9590;
   IF TOGO>=43 THEN GOTO L2340;
     GO TO L7060;
     GO TO L2340;
 L9590:
     Z=TRUNC(1.000+10.000*RND(X));
     GO TO PLAYCOUNT;
 FNN:PROC(XX);ON UNDERFLOW XX=0;ON OVERFLOW XX=0;
     RETURN(1.00+3.76E-2*XX+6.29E-4*XX*XX);
        END;
     FNP:PROC(X);RETURN(.753+1.92E-2*X-2.11E-4*X*X);
      END;
 RND:PROC(X);
 ON FIXEDOVERFLOW;
 DCL (IX,IY)BIN FIXED(31)STATIC INIT(0),
    YFL STATIC,
      ISTART BIN FIXED INIT(0)STATIC;
 IX=IY;
 IF ISTART=0 THEN DO;CALL RAND(IX);ISTART=1;END;
 IY=IX*66539;
 IF IY<0 THEN IY=IY+2147483647+1;
 YFL=IY;
 YFL=YFL*.4656613E-9;
 RETURN (ABS(YFL));
 RAND:PROC(IX);
 DCL 1 CLOCK, 2 DATE CHAR(8),2 TME CHAR(8),2 VT
        BIN FIXED(31,0),ET BIN FIXED(31,0);
 DCL IX BIN FIXED(31);
 /* FOLLOWING STATEMENTS ADDED DURING CONVERSION TO PL/1 OPT */
 DCL  MYTIME CHAR(9),
      TIME BUILTIN;
 MYTIME=TIME;
 VT=SUBSTR(TIME,7);
  /*  END OF NEW CODE  */
 ON FIXEDOVERFLOW;
 IX=VT*VT;
 IX=IX*2+1;
 IX=MOD(IX,10**8);
 END RND;
 END FF;

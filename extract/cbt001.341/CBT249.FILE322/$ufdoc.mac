
UF MODIFICATION DESCRIPTIONS


FOR FURTHER INFORMATION ON THESE MODIFICATIONS PLEASE CONTACT:

JACK SCHUDEL
NORTHEAST REGIONAL DATA CENTER
233 SSRB, UNIVERSITY OF FLORIDA
GAINESVILLE, FLORIDA  32611
(904) 392-4601
SHARE CODE - UF


THIS VERSION OF QUEUE WAS DERIVED FROM FILE 278 OF THE CBT MODS TAPE,
WHICH HAD BEEN OBTAINED FROM VERSION 18 OF THE SHARE JES2 PROJECT TAPE.
IT HAS BEEN RUN ON THE FOLLOWING VERSIONS OF JES2 (ASSUMING THAT THE
APPROPRIATE SYSPARM OPTIONS HAVE BEEN SET):
       JES2 4.1
       JES2 NJE 3.1
       MVS/SP-JES2 RELEASE 3

IN THE NERDC ENVIRONMENT, USE OF THE QUEUE COMMAND IS RESTRICTED TO
SYSTEMS PROGRAMMING PERSONNEL INVOLVED IN JES2 MAINTENANCE, AND THERE
HAVE BEEN SEVERAL COMMANDS ADDED FOR THIS USAGE.  AN ATTEMPT HAS BEEN
MADE TO REQUIRE THAT THE COMMANDS THAT ALLOW THE UNRESTRICTED ACCESS
TO SPOOL DATA AND CONTROL BLOCKS BE AVAILABLE TO ONLY AUTHORIZED USERS,
BUT THERE WERE ALSO CHANGES MADE TO ALLOW THOSE AUTHORIZED USERS FULL
ACCESS TO THE SYSTEM WITHOUT HAVING ANY NAMING CONVENTION RESTRICTIONS
IMPOSED UPON THEM.  IT IS THEREFORE NORMAL FOR AN AUTHORIZED USER
TO BE ABLE TO USE THE LIST COMMAND AGAINST ANY JOB IN THE SYSTEM
INSTEAD OF HAVING TO USE THE XD COMMAND.

THE COMMAND ONLY NEEDS TO RUN AUTHORIZED FOR THE FOLLOWING COMMANDS
CANCEL, REQUEUE, AND PURGE. IF YOU DO NOT MARK THE CODE AC=1, THESE
THREE COMMANDS WILL NOT FUNCTION.

INSTALLATION PROCEDURE FOR QUEUE:

     1. Q0 IS THE COMMON AREA.
        Q1 - QNN ARE REENTRANT CODE.
        QCOMMON, QSTART, QSTOP, QTILT, AND $JQT ARE MACROS.
        HELP IS A TSO HELP MEMBER.
        $NERJCL2 IS THE JCL TO ASSEMBLE AND LINK QUEUE.
        ($NERJCL WILL GENERATE THE PRE-SP2 VERSION OF QUEUE.)
        TABLE IS A SAMPLE SMP JOB TO AUTHORIZE THE QUEUE COMMAND.

     2. EDIT MEMBER QCOMMON CHANGING THE FOLLOWING PARAMETERS:

        UNIT=XXXX THE DEVICE TYPE FOR SYS1.HASPCKPT.
        VOLSER=YYYYYY THE VOLUME SERIAL FOR SYS1.HASPCKPT.
        SID1-SID7=ZZZZ THE SMF IDS FOR EACH CPU IN THE COMPLEX. THE
        IDS MUST BE IN THE SAME ORDER AS IN THE INITIALIZATION DECK.

        AT PRESENT THERE IS SUPPORT IN THE INITIALIZATION MODULE TO
        DYNAMICALLY ALLOCATE THE CHECKPOINT ON EITHER 3330, 3330-1,
        OR 3350. IF YOU ARE FORTUNATE ENOUGH TO HAVE A DRUM OR A
        3380 YOU WILL HAVE TO MODIFY Q10 TO ADD SUPPORT.

        EDIT THE MACRO QSTART TO INDICATE THE OPTIONS DESIRED,
        OR SPECIFY THEM AS SYSPARM INPUT TO THE ASSEMBLER.
        IT WILL BE NECESSARY TO LOOK AT THE MACRO FOR A DESCRIPTION
        OF THE OPTIONS AVAILABLE.

     3. EDIT MEMBER $NERJCL2 TO CHANGE THE JCL TO FIT YOUR STANDARDS.
        DO NOT ALTER THE ORDER OF THE ASSEMBLY SYSLIBS AS THERE IS A
        CONFLICT ON THE MACRO QSTART.  THE DBCSYMED PROGRAM THAT IS USED
        BETWEEN THE ASSEMBLIES AND THE LINKEDIT IS A PART OF THE YALE
        DBC PROGRAM PRODUCT AVAILABLE FROM CSR.  IT EDITS THE GENERATED
        SYM CARDS IN THE OBJECT DECK TO REMOVE NULL ENTRIES AND MOST OF
        THE DUPLICATE ONES.  IF THE PROGRAM IS NOT AVAILABLE, SIMPLY
        DELETE THE STEP AND CHANGE THE LINKEDIT INPUT REFERENCE.

        THE SUPPLIED JCL GENERATES A SINGLE LOAD MODULE WHICH IS NOT
        REENTRANT.  THIS IS IDEAL FOR TESTING, BUT MAY NOT BE DESIRED
        IN A PRODUCTION ENVIRONMENT.
        TO GENERATE A REENTRANT VERSION OF THE COMMAND, LINK MODULES
        Q1 THROUGH QNN AS A SINGLE PROGRAM NAMED QUEUE (ALIAS Q)
        INTO SYS1.LPALIB.  IT WILL NEED AN AUTHORIZATION CODE OF 1
        IF YOU DESIRE TO USE THE CANCEL, REQUEUE, AND PURGE COMMANDS.
        THE LINKEDIT OF MODULE QUEUE WILL GENERATE AN UNRESOLVED
        EXTERNAL REFERENCE FOR MODULE QUEUECMN, WHICH IS NORMAL AND
        SHOULD BE IGNORED.
        MODULE Q0 SHOULD THEN BE ASSEMBLED AND LINKED INTO SYS1.LINKLIB
        OR SYS1.CMDLIB WITH A NAME OF QUEUECMN.  IF YOU WANT TO CHANGE
        THE NAME OF QUEUECMN, THE ONLY REFERENCE TO IT IS IN MEMBER
        Q10 WHERE THE LINK IS ISSUED.

     4. IF THE CANCEL, REQUEUE, AND PURGE COMMANDS ARE DESIRED, ADD
        QUEUE (ALIAS Q) TO THE IKJEFTE2 MODULE WHICH IS THE TSO LIST
        OF AUTHORIZED COMMANDS. A SAMPLE SMP JOB IS PROVIDED IN THE
        MEMBER TABLE. QUEUE CAN BE RUN UNDER SPF BUT THE SUBCOMMANDS
        USING THE SUBSYSTEM INTERFACE (CANCEL, REQUEUE, AND DELETE)
        WILL BE INOPERABLE, ALL OTHER COMMANDS WILL FUNCTION NORMALLY.
        IF YOU DON'T MIND THE INTEGRITY PROBLEM YOU CAN ADD CODE TO
        QUEUE TO USE A SPECIAL SVC TO GET INTO SUPERVISOR STATE AND
        HAVE FULL FACILITY UNDER SPF.

USERS THAT DO NOT HAVE THE UICC JTIP PACKAGE INSTALLED WILL NEED TO
EITHER CHANGE THE QSTART MACRO OR SPECIFY NOJTIP IN THE ASSEMBLER
SYSPARM OPTIONS.

USERS THAT DO NOT HAVE THE YALE DBC PACKAGE INSTALLED SHOULD
EITHER CHANGE THE QSTART MACRO OR SPECIFY NODBC IN THE ASSEMBLER
SYSPARM OPTIONS.  IF DBC IS SPECIFIED BUT THE PACKAGE DOES NOT
EXIST, ALL THAT WILL HAPPEN IS THAT A MESSAGE WILL FLASH ON THE
USER'S TERMINAL INDICATING THAT THE LOAD FOR MODULE DBC FAILED.
THIS MESSAGE CAN BE IGNORED.

SOME OF THE CODE MAY BE DEPENDENT ON ASSEMBLER H, BUT ALL THAT SHOULD
BE NEEDED IS TO MOVE SOME OF THE DSECTS AROUND TO GET THEM IN THE
PROPER ORDER FOR THE OTHER ASSEMBLERS.

FOR FURTHER INFORMATION ON THE SUPPORT FOR MVS/SP-JES2 RELEASE 2 AND
ABOVE, SEE MEMBER $SP.

TO MAKE IT EASIER TO ENTER CERTAIN COMMANDS, COMMAND NAMES MAY NOW
BE UP TO FOUR CHARACTERS.

FOLLOWING IS A LIST OF THE INDIVIDUAL MODIFICATIONS:

UF001  ALLOW QUEUE COMMAND TO ASSEMBLE USING NJE3.1 SOURCE CODE.
       A FEW EQUATES AND ADDITIONAL DSECTS WERE INCLUDED, WHICH SHOULD
       BE OK FOR NON-NJE SOURCE AS WELL.

UF002  ALLOW QCOMMON TO BE LINKED IN FOR TESTING.
       WE RUN WITH SEVERAL DIFFERENT SPOOL PACK FORMATS DURING TEST,
       AND IT IS CONVENIENT TO HAVE MULTIPLE VERSIONS OF QUEUE TO
       SUPPORT THESE DIFFERENT TEST VERSIONS.
       IT IS ALSO MUCH SIMPLER TO RUN UNDER TSO TEST.

UF003  SUPPORT FOR 3278 MODELS 2, 4, AND 5.
       WE HAVE A WIDE ASSORTMENT OF TERMINALS IN-HOUSE, SO QUEUE WAS
       MODIFIED TO SUPPORT ALL TERMINAL TYPES AS BASIC MODEL 2, AND
       TO ALLOW THE USER TO SWITCH TO THE LARGER SCREEN FORMAT AT ANY
       TIME DURING HIS SESSION.
       THIS CODE IS CURRENTLY RUNNING UNDER ACF/VTAM REL 2, BUT WAS
       DEVELOPED UNDER ACF/VTAM REL 1, AND HAS ALSO RUN WITH TCAM AT
       THE 8011 LEVEL.

UF004  ADD A TITLE CARD FOR Q0 (QCOMMON).

UF005  DO NOT CHECK FOR JOBNAME MATCHING TSO LOGON ID IF QXAUTH=1.
       ALSO ALLOW READING DSID'S LESS THAN 101 IF QXAUTH=1.
       DSID'S LESS THAN 101 ARE SOMETIMES USEFUL TO LOOK AT;  THE
       INTERNAL TEXT FILE MAKES IT EASIER TO LOCATE THE PROPPER DSID
       IN A SYSGEN WHERE ALL STEPNAMES ARE "ASM", AND IN A VM NETWORK
       ENVIRONMENT IT IS COMMON TO HAVE OUTPUT DSID'S OF 1.

UF006  ONLY READ THE CHECKPOINT IF THE INFORMATION IS NEEDED.
       THE READ OF THE CHECKPOINT IS REMOVED FROM THE MAIN EXECUTION
       LOOP, SINCE IT IS REALLY SILLY TO READ A LARGE CHECKPOINT DATASET
       WHEN THE USER COMMAND IS TO JUST REPOSTITION WITHIN THE CURRENT
       FILE.

UF007  CHANGE COMMANDS "DD *" AND "L * DSID" TO USE THE LAST JOBNAME
       IF A "*" IS SPECIFIED.  THIS MAKES IT EASIER TO TYPE, AND CODE
       IS ADDED TO SKIP THE CHECKPOINT READ FOR PERFORMANCE REASONS.
       IT IS STRONGLY RECOMMENDED THAT THE "*" BE USED INSTEAD OF THE
       JOB NAME/NUMBER SINCE THE RESPONCE TIME IS SO MUCH BETTER.

UF008  HAVE THE FINDPDDB ROUTINE START AT THE FIRST IOT IF PDDB IS NOT
       FOUND.  A MIXTURE OF SPIN AND REGULAR PDDB'S USED TO CAUSE
       THE ROUTINE TO SCAN TO THE END OF THE IOT'S AND STAY THERE WHILE
       TRYING TO LOCATE THE FIRST REGULAR PDDB AFTER A SPUN ONE.

UF009  ADD SYNAD ROUTINE AND ADDITIONAL CHECKING TO READSPC ROUTINE SO
       THAT THE SYSTEM WILL NOT FAIL DURING XB PROCESSING.

UF010  IF USER HAS TSO OPERATOR AUTHORITY, SET FLAG BIT IN QFLAG1,
       AND FORCE QXAUTH ON.

UF011  ADD MODULE HEXDUMP (Q28) WHICH WILL GENERATE AN ABEND FORMAT
       DUMP OF THE DATA PASSED TO IT.

UF012  CHANGE HEXBLK (Q9) TO USE HEXDUMP FOR FORMATTING THE READ
       BUFFER.

UF013  CHANGE HEXBLK (Q9) TO ALLOW ADDITIONAL INPUT PARAMETERS FOR
       DUMPING CURRENT BLOCK, AND OFFSETS INTO THE REQUESTED BLOCK.
       IF THE BLOCK ADDRESS PARAMETER IS "+", THE BUFFER CHAINED FROM
       THE CURRENT BUFFER WILL BE DUMPED.

UF014  CHANGE PARSE (Q16) TO USE 4 CHARACTER COMMAND NAMES, AND
       CHANGE LOGIC FOR DETERMINING IF A COMMAND IN PRIVILEGED.

UF015  ADD MODULE CJQE (Q29) TO DUMP JQE IN HEX.

UF016  ADD MODULE CJCT (Q30) TO DUMP JCT IN HEX WITH OPTIONAL
       OFFSET SPECIFIED.

UF017  ADD MODULE CTSO (Q31) TO ALLOW ANY TSO COMMAND TO BE ISSUED
       WHILE IN QUEUE.
       NOTE:  THIS SHOULE NOT BE DONE IF QUEUE IS RUN AUTHORIZED.

UF018  CHANGE DEFAULT STARTUP COMMAND TO "HELP" SO GET STARTED FASTER.

UF019  ALLOW SYSPARM TO CHANGE &QXXX DEFAULTS.

UF020  SUPPORT FOR SP2 LEVEL OF JES2.
       NOTE: THERE ARE PROBABLY SOME BUGS IN THE DISPLAY COMMANDS AT
             THIS LEVEL.  THEY ARE BEING FIXED AS THEY ARE DISCOVERED,
             BUT SINCE THE NERDC DOES NOT NORMALLY USE THESE COMMANDS,
             IT MAY TAKE SOME TIME TO DISCOVER THE ERRORS.

UF021  SUPPORT FOR SP2 PTF UZ52546 (8110 LEVEL SET).

UF022  ADD MODULE CHCT (Q32) TO DUMP HCT CHECKPOINTED AREA.

UF023  ADD SYMDEL/SYMNODEL STATEMENTS AROUND DSECTS TO REDUCE
       NUMBER OF SYM ENTRIES IN FINAL LOAD MODULE.
       (THE DBCSYMED PROGRAM READS IN THE GENERATED OBJECT
       DECKS AND REMOVES SYM ENTRIES THAT APPEAR BETWEEN
       SYMDEL/SYMNODEL DSECT DEFINITIONS.  THIS CAN CUT THE
       SIZE OF THE FINAL LOAD MODULE BY MORE THAN HALF.)

UF024  ADD DIE COMMAND TO FORCE AN ABEND SO CAN GET BACK INTO THE
       DEBUGGING ENVIRONMENT, AND ESTABLISH ESTAE DURING INIT.

UF025  ADD PDDB COMMAND TO LIST PDDB'S FOR A JOB.  THIS IS USEFUL WHEN
       THE DD COMMAND FAILS FOR SUCH THINGS AS SYSOUT RECEIVED FROM
       OTHER NODES AS WELL AS DURING DEBUGGING OF MISC PROBLEMS.
       IF &QJTIP IS ON, THE PROC, STEP, AND DDNAMES WILL BE FORMATTED.

UF026  ADD JOE COMMAND TO DUMP JOES FOR A JOB.

UF027  FIX XI COMMAND TO PROPERLY LIST ALL INITIATOR CLASSES.

UF028  CHANGE SAVE COMMAND TO ALLOW QPARM3 TO SPECIFY THE VOLSER
       THAT THE DATASET IS TO BE ALLOCATED TO.
       (QPARM2 IS USED TO SPECIFY THE DATASET TYPE.  IT WASN'T
       DOCUMENTED, EITHER.)
       NOW THE COMMAND IS:
         SAVE DSN <DSTYPE> <VOLSER>

UF029  CHANGE Q7 FORMAT TO FIX ERROR IN TESTING FOR JOB ACTIVE ON A
       PRINTER.

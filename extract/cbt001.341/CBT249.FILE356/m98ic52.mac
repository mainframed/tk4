PROC 0
   GLOBAL TYPE RECFM GOODBLK BLKSIZE REC RBLK MIN MAX DEVICE TEMP +
          RTRK RCYL BLKEXT1 CYLEXT1 TRKEXT1 JCL1 JCL2 JCL3 JCL4 TCYL +
          BTRK DEBUG BOVR
   SET FLAG = 0
   SET &EXIT = NO
   DO WHILE &EXIT NE YES
     CONTROL NOLIST NOCONLIST NOMSG
     ISPEXEC DISPLAY PANEL(M98IP52)
     IF &EXIT NE YES THEN DO
       IF &DEBUG NE &STR() THEN +
         CONTROL LIST CONLIST MSG
       SET &BLTRK = &BOTRK / (&BLKOLD + &BOOVR)
       IF &RECFM = VB THEN SET &BLKOLD = (&BLKOLD - 4)
       SET &RBLK = &BLKOLD / &REC
       SET &RTRK = &RBLK * &BLTRK
       IF &SPACE = BLK THEN +
         SET &MIN = &RBLK * &PRIMSPAC
       ELSE +
         IF &SPACE = TRK THEN +
           SET &MIN = &RTRK * &PRIMSPAC
         ELSE +
           SET &MIN = &RTRK * &PRIMSPAC * &TOCYL
       SET &TYPE = &SPCNEW
       SET &DEVICE = &DEVNEW
       SET &MAX = &MIN
       M98IC59
       END
     END
   END

++ USERMOD (#Z00394) .
++ VER   (Z038)     FMID (HVT2102)   PRE (UZ57224)
                    SUP (#Z00162 #Z00165,#Z00229,#Z00258)
          /*
               THIS MODIFICATION CHANGES THE ACF/VTAM UNFORMATTED
               SYSTEM SERVICES MESSAGE BUILDER TO TAKE AN EXIT
               FOR THE PURPOSES OF MODIFYING THE TEXT OF MESSAGES.

               THE LOGIC IS THAT EACH MESSAGE FOR WHICH
               AN EXIT IS DESIRED IS ALIGNED ON A FULL
               WORD BOUNDARY AND IS PRECEDED BY A FULL
               WORD THAT CONTAINS X'FF' IN THE HIGH
               ORDER BYTE AND THE ADDRESS OF THE EXIT
               ROUTINE IN THE THREE LOW ORDER BYTES.
               IF EITHER THAT X'FF' IS NOT PRESENT OR
               THE ADDRESS IS ZERO, THE EXIT IS NOT TAKEN.

               LINKAGE IS DONE WITH A BALR R14,R15.
               R13 POINTS TO A VALID (NEWLY CREATED) SAVE AREA.
               THE CODE IS ONLY EXPECTED TO BE REUSABLE
               BY VTAM.

                                                               */  .
++ ZAP  (ISTINCU6)  DISTLIB(AOS26) .
        EXPAND ISTINCU6(144)
        NAME  ISTINCU6
*       BASE REGS ARE R11 (X'1C') AND R12 (X'101B').
*       EXPAND AREA WILL START AT X'19D0'
        VER 07C4  5090A018          ST    @09,INPTR1(,R10)
        VER 07C8  1FFF
        VER 07CA  47F0,B820         B     @RC00878
*
        VER 19D0  00000000
        VER 1A58  00000000
*
        REP 07C4  47F0C9B5    BR TO EXPAND AREA
*
        REP 19D0  5090A018    REFRESH OVERLAID INSTRUCTION
        REP 19D4  18F3        PASS BUFFER ADDRESS
        REP 19D6  5FF0C9ED    SUBTRACT 4 FROM MESSAGE ADDRESS
        REP 19DA  95FFF000    CHECK FOR X'FF' FLAG
        REP 19DE  4770B7AC    RETURN TO MAINLINE IF NOT
        REP 19E2  BFF7F001    LOAD(ICM) ADDRESS OF THE LOGO RTN
        REP 19E6  4780B7AC    RETURN TO MAINLINE IF ADDRESS ZERO
        REP 19EA  50D0C9F1    SAVE OFF REG 13
        REP 19EE  5000C9F5    SAVE OFF REG 0
        REP 19F2  5800A014    WHERE EXIT EXPECTS TERMINAL ADDRESS
        REP 19F6  41D0C9F9    PROVIDE NEW SAVE AREA
        REP 19FA  05EF        BALR TO LOGO ROUTINE
        REP 19FC  58D0C9F1    RESTORE REG 13
        REP 1A00  5800C9F5    RESTORE REG 0
        REP 1A04  47F0B7AC    RETURN TO MAINLINE
        REP 1A08  00000004    CONSTANT OF 4 FOR SUBTRACT
        REP 1A0C  00000000    REG 13 SAVED HERE
        REP 1A10  00000000    REG 0 SAVED HERE
        REP 1A14  00000000    BEGINNING OF NEW SAVE AREA
        REP 1A58  00000000    END OF NEW SAVE AREA
*
         IDRDATA #Z00394

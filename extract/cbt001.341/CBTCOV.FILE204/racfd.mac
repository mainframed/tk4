        PROC 1 VOL ALL TEST
        /************************************************************/
        /*  THIS CLIST WILL RACF DELETE ALL DATASETS ON A SPECIFIED */
        /*          VOLUME */
        IF &TEST=TEST THEN -
            CONTROL LIST CONLIST SYMLIST MSG NOFLUSH
        DELETE IEHLIST.DATA
        FREE ATTR(SYSP)
        ATTR SYSP BLKSIZE(80) LRECL(80) DSORG(PS) RECFM(F)
        FREE FI(DD1,SYSPRINT,SYSIN)      /* ALLOC FILES FOR IEHLIST
        ALLOC DD(SYSIN) USING(SYSP) NEW DELETE SPACE(1) TRACK DELETE-
              UNIT(V2314)
        FREE ATTR(SYSP)
        OPENFILE SYSIN OUTPUT
        SET &SYSIN=&STR( LISTVTOC VOL=DISK=&VOL)
        PUTFILE SYSIN
        CLOSFILE SYSIN
        ALLOC FI(DD1) UNIT(DISK) VOL(&VOL) NEW SP(0) TRACKS
        ALLOC FI(SYSPRINT) DA(IEHLIST.DATA)  NEW SP(1,1) CYL
        CALL 'SYS1.LINKLIB(IEHLIST)'
        OPEN: OPENFILE SYSPRINT INPUT    /* OPEN IEHLIST LISTING DS */
        LOOP: GETFILE SYSPRINT          /* READ A LINE FORM IEHLIST */
        SET RACFBIT=&SUBSTR(114:120,&STR(&SYSPRINT))
        IF &SUBSTR(1,&RACFBIT) EQ &STR( ) THEN -
          GOTO LOOP                    /* SKIP BLANK LINES */
        SET RACFBIT=&RACFBIT
        IF &RACFBIT=RACF THEN -
         DO
          SET DSNAME=&SUBSTR(2:45,&STR(&SYSPRINT))
          SET DSNAME=&DSNAME
          WRITE RACF PROTECTION DELETED:  &DSNAME
          AD '&DSNAME',UNIT(DISK),VOL(&VOL),NOSET
          DD '&DSNAME',VOL(&VOL)
         END
         GOTO LOOP
        EOF: WRITE PROCESSING COMPLETE
        CLEANUP: CLOSFILE SYSPRINT
        END

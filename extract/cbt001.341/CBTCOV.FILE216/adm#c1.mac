PROC 0 DEBUG
/* CLIST TO CALL GDDM INTERACTIVE MAP DEFINITION (IMD)   J.R. WARD */
CONTROL NOLIST   MSG NOFLUSH PROMPT
IF &DEBUG NE &STR() THEN CONTROL LIST MSG NOFLUSH PROMPT CONLIST
ISPEXEC CONTROL ERRORS RETURN
KOMM CLEAR
ATTRIB ADMDCB  RECFM(F)   LRECL(400) BLKSIZE(400)
ATTRIB ADMDCB2 RECFM(F B) LRECL(80)  BLKSIZE(400)
DSNCHECK ADMIFMT NOLIST
IF &LASTCC NE 0 THEN +
   DO
      SET &BADFILE = &STR(ADMIFMT)
      ISPEXEC DISPLAY PANEL(ADM#P1A)
      ALLOC FI(ADMIFMT) DA(ADMIFMT) NEW VOL(&VOL.) DIR(&DIRBLKS.) +
        TRACKS SP(&SPACE.,&SPACE.) USING(ADMDCB) CATALOG
      GOTO GGMAP
   END
ELSE +
   GOTO GGMAP
   END
GGMAP: DSNCHECK ADMGGMAP NOLIST
IF &LASTCC NE 0 THEN +
   DO
      SET &BADFILE = &STR(ADMGGMAP)
      ISPEXEC DISPLAY PANEL(ADM#P1A)
      ALLOC FI(ADMGGMAP) DA(ADMGGMAP) NEW VOL(&VOL.) DIR(&DIRBLKS.) +
        TRACKS SP(&SPACE.,&SPACE.) USING(ADMDCB2) CATALOG
      GOTO GNADS
   END
ELSE +
   GOTO GNADS
END
GNADS: DSNCHECK ADMGNADS NOLIST
IF &LASTCC NE 0 THEN +
   DO
      SET &BADFILE = &STR(ADMGNADS)
      ISPEXEC DISPLAY PANEL(ADM#P1A)
      ALLOC FI(ADMGNADS) DA(ADMGNADS) NEW VOL(&VOL.) DIR(&DIRBLKS.) +
        TRACKS SP(&SPACE.,&SPACE.) USING(ADMDCB) CATALOG
      GOTO GOOD
   END
ELSE +
   GOTO GOOD
END
GOOD: +
FREE ATTR(ADMDCB,ADMDCB2)
ALLOC FI(ADMIFMT) DA(ADMIFMT) SHR
ALLOC FI(ADMGGMAP) DA(ADMGGMAP) SHR
ALLOC FI(ADMGNADS) DA(ADMGNADS) SHR
ALLOC FI(ADMLIST) SYSOUT(A)
ALLOC FI(ADMGIMP) DA('SYS1.SADSC.GDDMMAP') SHR
ALLOC FI(MSL1) DA('SYS1.SADSC.GDDMR4.MAPS') SHR
DOPGM ADMIMD 'MSL1'
FREE FI(ADMIFMT,ADMGGMAP,ADMGNADS,ADMGIMP,MSL1)
FREE FI(ADMLIST)
ISPEXEC CONTROL DISPLAY REFRESH

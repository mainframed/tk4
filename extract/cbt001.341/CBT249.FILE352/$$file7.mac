./       ADD   NAME=NETINFO
*--------------------------------------------------------------------*;
* THIS SAS PROGRAM (NETINFO) IS DESIGNED TO COMBINE INFORMATION      *;
* ON THE CURRENT NETWORK AND CICS DEFINITIONS AND PRODUCE AN INFO/   *;
* SYSTEM ENTRY IN THE FORM 'U09NNNX' WHERE NNN IS THE CURRENT PEP    *;
* RELEASE, AND X IS THE REPORT NUMBER (1,2,3,4, OR 5).               *;
*                                                                    *;
* METHOD OF OPERATION:                                               *;
*                                                                    *;
*  1) JOB 'CICSDOC' ASSEMBLES THE CURRENT PROD/TEST CICS TCT AND     *;
*     FCT (FOR STAR EDS TERMINAL NUMBERS) AND PLACES RECORDS IN      *;
*     'TECH.NETINFO.TABLES'.                                         *;
*                                                                    *;
*  2) JOB 'EURODOC' ASSEMBLES THE CURRENT EUROSTAR CICS TCT AND      *;
*     FCT (FOR STAR EDS TERMINAL NUMBERS) AND PLACES RECORDS IN      *;
*     'TECH.NETINFO.TABLES'.                                         *;
*                                                                    *;
*  3) JOB 'VTAMDOC' ASSEMBLES THE CURRENT NCP/PEP GEN AND THE        *;
*     CURRENT LOCAL TERMINAL GROUPS FROM 'SYS1.VTAMLST' AND PLACES   *;
*     THE RECORDS IN 'TECH.NETINFO.TABLES'.                          *;
*                                                                    *;
*  4) THIS JOB 'NETINFO' READS THE VARIOUS PIECES AND MATCH/MERGES   *;
*     THIS MESS TOGETHER TO PRODUCE A SINGLE REPORT IN INFO/SYSTEM   *;
*     ENTRY FORMAT TO DOCUMENT THE NETWORK.                          *;
*                                                                    *;
*--------------------------------------------------------------------*;
 PAGE;
*--------------------------------------------------------------------*;
*                                                                    *;
*                                                                    *;
* FILES USED BY 'NETINFO':                                           *;
*                                                                    *;
*  DDNAME     COMMENTS                                               *;
*  --------   ------------------------------------------------------ *;
*  VTAMDOC    MEMBER CONTAINING PEP/LOCAL TERM DEF PRODUCED BY       *;
*               JOB 'VTAMDOC'                                        *;
*                                                                    *;
*  FCTSTAR    MEMBER CONTAINING ASSEMBLY OF 'DFHFCT' FOR CICSSTAR    *;
*               (     EDS STATION # ARE OBTAINED FROM HERE)          *;
*                                                                    *;
*  FCTMISC    MEMBER CONTAINING ASSEMBLY OF 'DFHFCT' FOR CICSMISC    *;
*               (     EDS STATION # ARE OBTAINED FROM HERE)          *;
*                                                                    *;
*  FCTTEST    MEMBER CONTAINING ASSEMBLY OF 'DFHFCT' FOR TESTCICS    *;
*               (     EDS STATION # ARE OBTAINED FROM HERE)          *;
*                                                                    *;
*  FCTEURO    MEMBER CONTAINING ASSEMBLY OF 'DFHFCT' FOR EUROSTAR    *;
*               (     EDS STATION # ARE OBTAINED FROM HERE)          *;
*                                                                    *;
*  TCTSTAR    MEMBER CONTAINING ASSEMBLY OF 'DFHTCT' FOR CICSSTAR    *;
*               (CICS TERMINAL DEFINITIONS ARE OBTAINED FROM HERE)   *;
*                                                                    *;
*  TCTMISC    MEMBER CONTAINING ASSEMBLY OF 'DFHTCT' FOR CICSMISC    *;
*               (CICS TERMINAL DEFINITIONS ARE OBTAINED FROM HERE)   *;
*                                                                    *;
*  TCTTEST    MEMBER CONTAINING ASSEMBLY OF 'DFHTCT' FOR TESTCICS    *;
*               (CICS TERMINAL DEFINITIONS ARE OBTAINED FROM HERE)   *;
*                                                                    *;
*  TCTEURO    MEMBER CONTAINING ASSEMBLY OF 'DFHTCT' FOR EUROSTAR    *;
*               (CICS TERMINAL DEFINITIONS ARE OBTAINED FROM HERE)   *;
*                                                                    *;
*   NOTE:  'ASSEMBLY' ABOVE USES A SPECIAL CUSTOMIZED MACRO LIBRARY  *;
*          'TECH.NETINFO.MACLIB' TO ASSEMBLE THE TABLES.. THE        *;
*          'REAL' MACROS FOR EACH COMPONENT ARE  N O T  USED.        *;
*                                                                    *;
*                                                                    *;
*  SECSTAR   POINTS TO STAR PROD PSECURITY FILE                      *;
*                                                                    *;
*  SECTEST   POINTS TO STAR TEST PSECURITY FILE                      *;
*                                                                    *;
*  SECEURO   POINTS TO STAR EURO PSECURITY FILE                      *;
*                                                                    *;
*  SECMISC   POINTS TO STAR MISC PSECURITY FILE  (NULLFILE)...       *;
*                                                                    *;
*  DSPRINT    POINTS TO 'DSPRINT.REQUEST.QUEUE' FOR DSPRINT          *;
*             TERMINAL DEFINITIONS.                                  *;
*                                                                    *;
*  ADMPRINT   POINTS TO 'ADMPRINT.REQUEST.QUEUE' FOR ADMPRINT        *;
*             TERMINAL DEFINITIONS.                                  *;
*                                                                    *;
*   NOTE:   THE ADMPRINT AND DSPRINT DDNAMES SHOULD HAVE             *;
*           'FREE=CLOSE' ON THE DDCARDS.                             *;
*                                                                    *;
*--------------------------------------------------------------------*;
 PAGE;
*--------------------------------------------------------------------*;
*                                                                    *;
*  OUTPUT FILES:                                                     *;
*                                                                    *;
*   INFO      RECFM=VB,LRECL=84 OUTPUT FILE - USED TO WRITE OUT THE  *;
*             RESULTING INFO/SYSTEM ENTRY.                           *;
*                                                                    *;
*                                                                    *;
*                                                                    *;
* KEN TRUE    23 FEB 82                                              *;
*                                                                    *;
* MOD 1 - KEN TRUE - READ STAR TERMINAL SECURITY FILES AND EXTRACT   *;
*         15JUL82    EDS STATION NUMBERS/STATION NAMES.              *;
*                                                                    *;
*                                                                    *;
*                                                                    *;
*--------------------------------------------------------------------*;
  MACRO _P
  SEQNO = SEQNO+1;
 PUT   @1 SEQNO Z8. @9 %
       PAGE;
 OPTIONS NOTRMUPCASE MISSING=' ' NOSOURCE;
 /* NOTE: SOME OF THE HEADERS ARE IN UPPER/LOWER CASE */;

*--------------------------------------------------------------------*;
* PROCESS THE DSPRINT TERMINAL DEFINITIONS                           *;
*--------------------------------------------------------------------*;
 DATA _NULL_ DSPRINT
       (KEEP= VTAMID CICSTYPE APPLID );
 INFILE DSPRINT END=EOF;

 RETAIN CICSTYPE '        ' APPLID 'DSPRINT ';
 FORMAT CICSTYPE APPLID $CHAR8.;

 INPUT @1 LAST  PIB1. @ ;
 FORMAT LAST HEX2.;

 DO I = 1 TO 103;

   PTR = (I-1)*24 + 9;

   INPUT @PTR    VTAMID   $CHAR8.
         @PTR+23 TYPE     PIB1.   @;

                   CICSTYPE = 'UNKNOWN ';
   IF TYPE=1  THEN CICSTYPE = '328XNVFC';
   IF TYPE=2  THEN CICSTYPE = '3288NVFC';
   IF TYPE=3  THEN CICSTYPE = '3790    ';
   IF TYPE=4  THEN CICSTYPE = '328XSLU1';
   IF TYPE=5  THEN CICSTYPE = '328XLU1V';

   IF VTAMID             >  '        ' &
      SUBSTR(VTAMID,1,5) ^= 'PRINT'
    THEN OUTPUT DSPRINT;

   IF I = 103     &
      LAST = '1.......'B THEN
    DO;
      STOP;
    END;

 END;

   PAGE;
*--------------------------------------------------------------------*;
* PROCESS THE ADMPRINT TERMINAL DEFINITIONS                          *;
*--------------------------------------------------------------------*;
 DATA _NULL_ ADMPRINT
       (KEEP= VTAMID CICSTYPE APPLID );
 INFILE ADMPRINT END=EOF;

 RETAIN CICSTYPE '        ' APPLID 'ADMPRINT';
 FORMAT CICSTYPE APPLID $CHAR8.;

 INPUT @1 LAST  PIB1. @ ;
 FORMAT LAST HEX2.;

 DO I = 1 TO 103;

   PTR = (I-1)*24 + 9;

   INPUT @PTR    VTAMID   $CHAR8.
         @PTR+23 TYPE     PIB1.   @;

                   CICSTYPE = 'UNKNOWN ';
   IF TYPE=0  THEN CICSTYPE = '32872C  ';
   IF TYPE=1  THEN CICSTYPE = '328XNVFC';
   IF TYPE=2  THEN CICSTYPE = '3288NVFC';
   IF TYPE=3  THEN CICSTYPE = '3790    ';
   IF TYPE=4  THEN CICSTYPE = '328XSLU1';
   IF TYPE=5  THEN CICSTYPE = '328XLU1V';

   IF VTAMID             >  '        ' &
      SUBSTR(VTAMID,1,5) ^= 'PRINT'
    THEN OUTPUT ADMPRINT;

   IF I = 103     &
      LAST = '1.......'B THEN
    DO;
      STOP;
    END;

 END;
     PAGE;
*--------------------------------------------------------------------*;
* SORT THE DSPRINT TERMINALS BY TERMID                               *;
*--------------------------------------------------------------------*;
  PROC SORT DATA=DSPRINT;
  BY VTAMID;

*--------------------------------------------------------------------*;
* PRINT DSPRINT TERMINAL REPORT                                      *;
*--------------------------------------------------------------------*;
  PROC PRINT DATA=DSPRINT UNIFORM;
  TITLE DSPRINT TERMINAL DEFINITIONS;
  VAR VTAMID CICSTYPE APPLID;

*--------------------------------------------------------------------*;
* SORT THE AMDPRINT TERMINALS BY TERMID                              *;
*--------------------------------------------------------------------*;
  PROC SORT DATA=ADMPRINT;
  BY VTAMID;

*--------------------------------------------------------------------*;
* PRINT ADMPRINT TERMINAL REPORT                                     *;
*--------------------------------------------------------------------*;
  PROC PRINT DATA=ADMPRINT UNIFORM;
  TITLE ADMPRINT TERMINAL DEFINITIONS;
  VAR VTAMID CICSTYPE APPLID;

  PAGE;
*--------------------------------------------------------------------*;
*   PROCESS THE VTAM PEP/LOCAL TERMINAL DEFINITIONS                  *;
*--------------------------------------------------------------------*;
 DATA VTAM;
 INFILE VTAMDOC;
 INPUT
    @01 PEPID     $8.
    @10 COMTYPE   $CHAR4.
    @15 LIB       $CHAR3.
    @19 UCB       $CHAR3.
    @23 VTAMLINE  $CHAR8.
    @32 VTAMCU    $CHAR8.
    @41 VTAMID    $CHAR8.
    @50 VTAMTYPE  $CHAR8.
    @59 TERMMODE  $CHAR8.
    @68 LOGAPPL   $CHAR8. ;

*--------------------------------------------------------------------*;
 PROC SORT;
 BY VTAMID VTAMLINE;
*--------------------------------------------------------------------*;
  PAGE;
*--------------------------------------------------------------------*;
*                                                                    *;
* EXTRACT THE STAR, MISC, TEST, EURO CURRENT FCT ASSEMBLIES TO GET   *;
* PROPER      EDS STATION NUMBERS.                                   *;
*                                                                    *;
*--------------------------------------------------------------------*;

*--------------------------------------------------------------------*;
* PROCESS THE EDS TERMINAL SECURITY FILE FOR THE STAR SYSTEM         *;
*--------------------------------------------------------------------*;
 DATA _NULL_ SECSTAR
       (KEEP= EDSID EDSNAME EDSRBA EDSSEC );

 INFILE SECSTAR  END=EOF OBS=3;* NOTE: ONLY FIRST 3 RECS ARE SYS RECS;

 RETAIN  EDSSEC 'STAR';

 FORMAT  EDSSEC $CHAR4. EDSID Z4. EDSRBA HEX6.;

 INPUT @1 LAST  PIB1. @ ;

 DO I = 1 TO 196;

   PTR = (I-1)*10 + 73;

   INPUT @PTR    EDSID    PIB2.
         @PTR+2  EDSNAME  $CHAR5.
         @PTR+7  EDSRBA   PIB3.   @;

    IF EDSNAME > '     ' THEN
      DO;
        *PUT /EDSID= EDSNAME= EDSRBA= ;
         OUTPUT SECSTAR;
      END;

 END;

 PROC SORT;BY EDSID;
*PROC PRINT;
*TITLE  EDS STATION NAMES FROM SECSTAR FILE;
*--------------------------------------------------------------------*;
* READ COMPILED FCT TABLE ;
*--------------------------------------------------------------------*;
 DATA FCTSTARR  (KEEP= FCTID CICSID EDSID);
 INFILE FCTSTAR;

 INPUT
    @1  STAR      $CHAR6. @;

 IF STAR ^= 'DFHFCT' THEN DELETE;

 INPUT
    @7  FCTID     $CHAR2.
    @10 CICSID    $CHAR4.
    @15 EDSID     4.      ;

 DROP STAR;
*--------------------------------------------------------------------*;
 PROC SORT;BY EDSID;
*PROC PRINT UNIFORM;
*TITLE LISTING OF FCT FROM STAR SYSTEM;
*--------------------------------------------------------------------*;
* MERGE FCT/SECURITY FILE TOGETHER;
*--------------------------------------------------------------------*;
 DATA FCTSTAR;
 TITLE ERROR LISTING FROM MERGE OF FCT AND SECURITY FILE FOR STAR SYS;
 MERGE SECSTAR   (IN=INSEC)
       FCTSTARR  (IN=INFCT);
 BY EDSID;
 FILE PRINT MOD;

 IF INFCT & ^INSEC THEN
   DO;
     PUT '***CICSID=' CICSID ' EDS STATION ' EDSID ' IN FCT ' FCTID
         'IS NOT IN TERM SECURITY FILE';
     EDSNAME = '-UND-';
     EDSSEC  = '????';
     EDSRBA  = 0;
   END;
 IF ^INFCT & INSEC THEN
   DO;
     PUT '***CICSID=' CICSID ' EDS STATION ' EDSID EDSNAME
         'IS NOT IN FCT ';
     DELETE;
   END;
 IF (FIRST.EDSID & ^LAST.EDSID) ×
    (^FIRST.EDSID & LAST.EDSID)  ×
    (^FIRST.EDSID & ^LAST.EDSID)   THEN
   DO;
     PUT '--- CICSID=' CICSID ' EDS STATION ' EDSID EDSNAME
         ' IN FCT ' FCTID
         'IS DEFINED MORE THAN ONCE' ;
   END;
*--------------------------------------------------------------------*;
 PROC PRINT UNIFORM;
 TITLE CURRENT  EDS STATIONS DEFINED FOR STAR SYSTEM FCT;
*--------------------------------------------------------------------*;
 PROC SORT; BY CICSID FCTID;
*--------------------------------------------------------------------*;
 DATA TCTSTAR;
 INFILE TCTSTAR;
 INPUT
    @7  TCTID     $CHAR2.
    @10 APPLID    $CHAR8.
    @19 CICSID    $CHAR4.
    @24 VTAMID    $CHAR8.
    @33 CICSTYPE  $CHAR8.
    @42 CONNECT   $CHAR4.
    @46 RELEASE   $CHAR8.
    @55 PRTID     $CHAR8.
    @64 PRTCOPY   $CHAR4.;
*--------------------------------------------------------------------*;
 PROC SORT; BY CICSID APPLID VTAMID;
*--------------------------------------------------------------------*;
*PROC PRINT UNIFORM;
*TITLE CURRENT VTAM STATION DEFINITIONS FOR STAR SYSTEM TCT;
*--------------------------------------------------------------------*;

 DATA CICSSTAR;
 TITLE ERROR LISTINGS FOR CICS TCT/FCT MERGE FOR STAR SYSTEM;
 MERGE TCTSTAR (IN=INCICS)
       FCTSTAR  (IN=INEDS) ;
 BY CICSID;

 FILE PRINT MOD;

 IF INEDS & ^INCICS THEN
   DO;
     PUT '***CICSID=' CICSID ' EDS STATION '
         EDSID EDSNAME
         ' IN FCT=' FCTID
         'IS NOT DEFINED TO CICS***' APPLID TCTID;
     DELETE;
   END;

 IF (FIRST.CICSID & ^LAST.CICSID) ×
    (^FIRST.CICSID & LAST.CICSID)  ×
    (^FIRST.CICSID & ^LAST.CICSID)   THEN
   DO;
     PUT '---CICSID=' CICSID ' EDS STATION '
         EDSID EDSNAME
         ' IN FCT=' FCTID
         'IS DEFINED MORE THAN ONCE FOR TCT=' TCTID APPLID;
   END;

*--------------------------------------------------------------------*;
*PROC PRINT UNIFORM;
*TITLE TOTAL SYSTEM LISTING FOR STAR SYSTEM;
*--------------------------------------------------------------------*;
  PAGE;
*--------------------------------------------------------------------*;
* PROCESS THE EDS TERMINAL SECURITY FILE FOR THE MISC SYSTEM         *;
*   P.S.  I KNOW THAT NO EDS IDS ARE IN THAT SYSTEM.....             *;
*         THIS IS JUST TO MAKE IT LIKE THE OTHERS (STAR,TEST,EURO..) *;
*--------------------------------------------------------------------*;
 DATA _NULL_ SECMISC
       (KEEP= EDSID EDSNAME EDSRBA EDSSEC );

 INFILE SECMISC  END=EOF OBS=3;* NOTE: ONLY FIRST 3 RECS ARE SYS RECS;

 RETAIN  EDSSEC 'MISC';

 FORMAT  EDSSEC $CHAR4. EDSID Z4. EDSRBA HEX6.;

 INPUT @1 LAST  PIB1. @ ;

 DO I = 1 TO 196;

   PTR = (I-1)*10 + 73;

   INPUT @PTR    EDSID    PIB2.
         @PTR+2  EDSNAME  $CHAR5.
         @PTR+7  EDSRBA   PIB3.   @;

    IF EDSNAME > '     ' THEN
      DO;
        *PUT /EDSID= EDSNAME= EDSRBA= ;
         OUTPUT SECMISC;
      END;

 END;

 PROC SORT;BY EDSID;
*PROC PRINT;
*TITLE EDS STATION NAMES FROM SECMISC FILE;
*--------------------------------------------------------------------*;
* READ COMPILED FCT TABLE ;
*--------------------------------------------------------------------*;
 DATA FCTMISCR  (KEEP= FCTID CICSID EDSID);
 INFILE FCTMISC;

 INPUT
    @1  MISC      $CHAR6. @;

 IF MISC ^= 'DFHFCT' THEN DELETE;

 INPUT
    @7  FCTID     $CHAR2.
    @10 CICSID    $CHAR4.
    @15 EDSID     4.      ;

 DROP MISC;
*--------------------------------------------------------------------*;
 PROC SORT;BY EDSID;
*PROC PRINT UNIFORM;
*TITLE LISTING OF FCT FROM MISC SYSTEM;
*--------------------------------------------------------------------*;
* MERGE FCT/SECURITY FILE TOGETHER;
*--------------------------------------------------------------------*;
 DATA FCTMISC;
 TITLE ERROR LISTING FROM MERGE OF FCT AND SECURITY FILE FOR MISC SYS;
 MERGE SECMISC   (IN=INSEC)
       FCTMISCR  (IN=INFCT);
 BY EDSID;
 FILE PRINT MOD;

 IF INFCT & ^INSEC THEN
   DO;
     PUT '***CICSID=' CICSID ' EDS STATION ' EDSID ' IN FCT ' FCTID
         'IS NOT IN TERM SECURITY FILE';
     EDSNAME = '-UND-';
     EDSSEC  = '????';
     EDSRBA  = 0;
   END;
 IF ^INFCT & INSEC THEN
   DO;
     PUT '***CICSID=' CICSID ' EDS STATION ' EDSID EDSNAME
         'IS NOT IN FCT ';
     DELETE;
   END;
 IF (FIRST.EDSID & ^LAST.EDSID) ×
    (^FIRST.EDSID & LAST.EDSID)  ×
    (^FIRST.EDSID & ^LAST.EDSID)   THEN
   DO;
     PUT '--- CICSID=' CICSID ' EDS STATION ' EDSID EDSNAME
         ' IN FCT ' FCTID
         'IS DEFINED MORE THAN ONCE' ;
   END;
*--------------------------------------------------------------------*;
 PROC PRINT UNIFORM;
 TITLE CURRENT EDS STATIONS DEFINED FOR MISC SYSTEM FCT;
*--------------------------------------------------------------------*;
 PROC SORT; BY CICSID FCTID;
*--------------------------------------------------------------------*;
 DATA TCTMISC;
 INFILE TCTMISC;
 INPUT
    @7  TCTID     $CHAR2.
    @10 APPLID    $CHAR8.
    @19 CICSID    $CHAR4.
    @24 VTAMID    $CHAR8.
    @33 CICSTYPE  $CHAR8.
    @42 CONNECT   $CHAR4.
    @46 RELEASE   $CHAR8.
    @55 PRTID     $CHAR8.
    @64 PRTCOPY   $CHAR4.;
*--------------------------------------------------------------------*;
 PROC SORT; BY CICSID APPLID VTAMID;
*--------------------------------------------------------------------*;
*PROC PRINT UNIFORM;
*TITLE CURRENT VTAM STATION DEFINITIONS FOR MISC SYSTEM TCT;
*--------------------------------------------------------------------*;

 DATA CICSMISC;
 TITLE ERROR LISTINGS FOR CICS TCT/FCT MERGE FOR MISC SYSTEM;
 MERGE TCTMISC (IN=INCICS)
       FCTMISC  (IN=INEDS) ;
 BY CICSID;

 FILE PRINT MOD;

 IF INEDS & ^INCICS THEN
   DO;
     PUT '***CICSID=' CICSID ' EDS STATION ' EDSID EDSNAME
         ' IN FCT=' FCTID
         'IS NOT DEFINED TO CICS***' APPLID TCTID;
     DELETE;
   END;

 IF (FIRST.CICSID & ^LAST.CICSID) ×
    (^FIRST.CICSID & LAST.CICSID)  ×
    (^FIRST.CICSID & ^LAST.CICSID)   THEN
   DO;
     PUT '---CICSID=' CICSID ' EDS STATION ' EDSID EDSNAME
         ' IN FCT=' FCTID
         'IS DEFINED MORE THAN ONCE FOR TCT=' TCTID APPLID;
   END;

*--------------------------------------------------------------------*;
*PROC PRINT UNIFORM;
*TITLE TOTAL SYSTEM LISTING FOR MISC SYSTEM;
*--------------------------------------------------------------------*;
  PAGE;
*--------------------------------------------------------------------*;
* PROCESS THE EDS TERMINAL SECURITY FILE FOR THE TEST SYSTEM         *;
*--------------------------------------------------------------------*;
 DATA _NULL_ SECTEST
       (KEEP= EDSID EDSNAME EDSRBA EDSSEC );

 INFILE SECTEST  END=EOF OBS=3;* NOTE: ONLY FIRST 3 RECS ARE SYS RECS;

 RETAIN  EDSSEC 'TEST';

 FORMAT  EDSSEC $CHAR4. EDSID Z4. EDSRBA HEX6.;

 INPUT @1 LAST  PIB1. @ ;

 DO I = 1 TO 196;

   PTR = (I-1)*10 + 73;

   INPUT @PTR    EDSID    PIB2.
         @PTR+2  EDSNAME  $CHAR5.
         @PTR+7  EDSRBA   PIB3.   @;

    IF EDSNAME > '     ' THEN
      DO;
        *PUT /EDSID= EDSNAME= EDSRBA= ;
         OUTPUT SECTEST;
      END;

 END;

 PROC SORT;BY EDSID;
*PROC PRINT;
*TITLE EDS STATION NAMES FROM SECTEST FILE;
*--------------------------------------------------------------------*;
* READ COMPILED FCT TABLE ;
*--------------------------------------------------------------------*;
 DATA FCTTESTR  (KEEP= FCTID CICSID EDSID);
 INFILE FCTTEST;

 INPUT
    @1  TEST      $CHAR6. @;

 IF TEST ^= 'DFHFCT' THEN DELETE;

 INPUT
    @7  FCTID     $CHAR2.
    @10 CICSID    $CHAR4.
    @15 EDSID     4.      ;

 DROP TEST;
*--------------------------------------------------------------------*;
 PROC SORT;BY EDSID;
*PROC PRINT UNIFORM;
*TITLE LISTING OF FCT FROM TEST SYSTEM;
*--------------------------------------------------------------------*;
* MERGE FCT/SECURITY FILE TOGETHER;
*--------------------------------------------------------------------*;
 DATA FCTTEST;
 TITLE ERROR LISTING FROM MERGE OF FCT AND SECURITY FILE FOR TEST SYS;
 MERGE SECTEST   (IN=INSEC)
       FCTTESTR  (IN=INFCT);
 BY EDSID;
 FILE PRINT MOD;

 IF INFCT & ^INSEC THEN
   DO;
     PUT '***CICSID=' CICSID ' EDS STATION ' EDSID ' IN FCT ' FCTID
         'IS NOT IN TERM SECURITY FILE';
     EDSNAME = '-UND-';
     EDSSEC  = '????';
     EDSRBA  = 0;
   END;
 IF ^INFCT & INSEC THEN
   DO;
     PUT '***CICSID=' CICSID ' EDS STATION ' EDSID EDSNAME
         'IS NOT IN FCT ';
     DELETE;
   END;
 IF (FIRST.EDSID & ^LAST.EDSID) ×
    (^FIRST.EDSID & LAST.EDSID)  ×
    (^FIRST.EDSID & ^LAST.EDSID)   THEN
   DO;
     PUT '--- CICSID=' CICSID ' EDS STATION ' EDSID EDSNAME
         ' IN FCT ' FCTID
         'IS DEFINED MORE THAN ONCE' ;
   END;
*--------------------------------------------------------------------*;
 PROC PRINT UNIFORM;
 TITLE CURRENT EDS STATIONS DEFINED FOR TEST SYSTEM FCT;
*--------------------------------------------------------------------*;
 PROC SORT; BY CICSID FCTID;
*--------------------------------------------------------------------*;
 DATA TCTTEST;
 INFILE TCTTEST;
 INPUT
    @7  TCTID     $CHAR2.
    @10 APPLID    $CHAR8.
    @19 CICSID    $CHAR4.
    @24 VTAMID    $CHAR8.
    @33 CICSTYPE  $CHAR8.
    @42 CONNECT   $CHAR4.
    @46 RELEASE   $CHAR8.
    @55 PRTID     $CHAR8.
    @64 PRTCOPY   $CHAR4.;
*--------------------------------------------------------------------*;
 PROC SORT; BY CICSID APPLID VTAMID;
*--------------------------------------------------------------------*;
*PROC PRINT UNIFORM;
*TITLE CURRENT VTAM STATION DEFINITIONS FOR TEST SYSTEM TCT;
*--------------------------------------------------------------------*;

 DATA CICSTEST;
 TITLE ERROR LISTINGS FOR CICS TCT/FCT MERGE FOR TEST SYSTEM;
 MERGE TCTTEST (IN=INCICS)
       FCTTEST  (IN=INEDS) ;
 BY CICSID;

 FILE PRINT MOD;

 IF INEDS & ^INCICS THEN
   DO;
     PUT '***CICSID=' CICSID ' EDS STATION ' EDSID EDSNAME
         ' IN FCT=' FCTID
         'IS NOT DEFINED TO CICS***' APPLID TCTID;
     DELETE;
   END;

 IF (FIRST.CICSID & ^LAST.CICSID) ×
    (^FIRST.CICSID & LAST.CICSID)  ×
    (^FIRST.CICSID & ^LAST.CICSID)   THEN
   DO;
     PUT '---CICSID=' CICSID ' EDS STATION ' EDSID EDSNAME
         ' IN FCT=' FCTID
         'IS DEFINED MORE THAN ONCE FOR TCT=' TCTID APPLID;
   END;

*--------------------------------------------------------------------*;
*PROC PRINT UNIFORM;
*TITLE TOTAL SYSTEM LISTING FOR TEST SYSTEM;
*--------------------------------------------------------------------*;
  PAGE;
*--------------------------------------------------------------------*;
* PROCESS THE EDS TERMINAL SECURITY FILE FOR THE EURO SYSTEM         *;
*--------------------------------------------------------------------*;
 DATA _NULL_ SECEURO
       (KEEP= EDSID EDSNAME EDSRBA EDSSEC );

 INFILE SECEURO  END=EOF OBS=3;* NOTE: ONLY FIRST 3 RECS ARE SYS RECS;

 RETAIN  EDSSEC 'EURO';

 FORMAT  EDSSEC $CHAR4. EDSID Z4. EDSRBA HEX6.;

 INPUT @1 LAST  PIB1. @ ;

 DO I = 1 TO 196;

   PTR = (I-1)*10 + 73;

   INPUT @PTR    EDSID    PIB2.
         @PTR+2  EDSNAME  $CHAR5.
         @PTR+7  EDSRBA   PIB3.   @;

    IF EDSNAME > '     ' THEN
      DO;
        *PUT /EDSID= EDSNAME= EDSRBA= TIMES=;
         OUTPUT SECEURO;
      END;

 END;

 PROC SORT;BY EDSID;
*PROC PRINT;
*TITLE EDS STATION NAMES FROM SECEURO FILE;
*--------------------------------------------------------------------*;
* READ COMPILED FCT TABLE ;
*--------------------------------------------------------------------*;
 DATA FCTEUROR  (KEEP= FCTID CICSID EDSID);
 INFILE FCTEURO;

 INPUT
    @1  EURO      $CHAR6. @;

 IF EURO ^= 'DFHFCT' THEN DELETE;

 INPUT
    @7  FCTID     $CHAR2.
    @10 CICSID    $CHAR4.
    @15 EDSID     4.      ;

 DROP EURO;
*--------------------------------------------------------------------*;
 PROC SORT;BY EDSID;
*PROC PRINT UNIFORM;
*TITLE LISTING OF FCT FROM EURO SYSTEM;
*--------------------------------------------------------------------*;
* MERGE FCT/SECURITY FILE TOGETHER;
*--------------------------------------------------------------------*;
 DATA FCTEURO;
 TITLE ERROR LISTING FROM MERGE OF FCT AND SECURITY FILE FOR EURO SYS;
 MERGE SECEURO   (IN=INSEC)
       FCTEUROR  (IN=INFCT);
 BY EDSID;
 FILE PRINT MOD;

 IF INFCT & ^INSEC THEN
   DO;
     PUT '***CICSID=' CICSID ' EDS STATION ' EDSID ' IN FCT ' FCTID
         'IS NOT IN TERM SECURITY FILE';
     EDSNAME = '-UND-';
     EDSSEC  = '????';
     EDSRBA  = 0;
   END;
 IF ^INFCT & INSEC THEN
   DO;
     PUT '***CICSID=' CICSID ' EDS STATION ' EDSID EDSNAME
         'IS NOT IN FCT ';
     DELETE;
   END;
 IF (FIRST.EDSID & ^LAST.EDSID) ×
    (^FIRST.EDSID & LAST.EDSID)  ×
    (^FIRST.EDSID & ^LAST.EDSID)   THEN
   DO;
     PUT '--- CICSID=' CICSID ' EDS STATION ' EDSID EDSNAME
         ' IN FCT ' FCTID
         'IS DEFINED MORE THAN ONCE' ;
   END;
*--------------------------------------------------------------------*;
 PROC PRINT UNIFORM;
 TITLE CURRENT EDS STATIONS DEFINED FOR EURO SYSTEM FCT;
*--------------------------------------------------------------------*;
 PROC SORT; BY CICSID FCTID;
*--------------------------------------------------------------------*;
 DATA TCTEURO;
 INFILE TCTEURO;
 INPUT
    @7  TCTID     $CHAR2.
    @10 APPLID    $CHAR8.
    @19 CICSID    $CHAR4.
    @24 VTAMID    $CHAR8.
    @33 CICSTYPE  $CHAR8.
    @42 CONNECT   $CHAR4.
    @46 RELEASE   $CHAR8.
    @55 PRTID     $CHAR8.
    @64 PRTCOPY   $CHAR4.;
*--------------------------------------------------------------------*;
 PROC SORT; BY CICSID APPLID VTAMID;
*--------------------------------------------------------------------*;
*PROC PRINT UNIFORM;
*TITLE CURRENT VTAM STATION DEFINITIONS FOR EURO SYSTEM TCT;
*--------------------------------------------------------------------*;

 DATA CICSEURO;
 TITLE ERROR LISTINGS FOR CICS TCT/FCT MERGE FOR EURO SYSTEM;
 MERGE TCTEURO (IN=INCICS)
       FCTEURO  (IN=INEDS) ;
 BY CICSID;

 FILE PRINT MOD;

 IF INEDS & ^INCICS THEN
   DO;
     PUT '***CICSID=' CICSID ' EDS STATION ' EDSID EDSNAME
         ' IN FCT=' FCTID
         'IS NOT DEFINED TO CICS***' APPLID TCTID;
     DELETE;
   END;

 IF (FIRST.CICSID & ^LAST.CICSID) ×
    (^FIRST.CICSID & LAST.CICSID)  ×
    (^FIRST.CICSID & ^LAST.CICSID)   THEN
   DO;
     PUT '---CICSID=' CICSID ' EDS STATION ' EDSID EDSNAME
         ' IN FCT=' FCTID
         'IS DEFINED MORE THAN ONCE FOR TCT=' TCTID APPLID;
   END;

*--------------------------------------------------------------------*;
*PROC PRINT UNIFORM;
*TITLE TOTAL SYSTEM LISTING FOR EURO SYSTEM;
*--------------------------------------------------------------------*;
 PAGE;
*--------------------------------------------------------------------*;
* NOW THE FINAL HOUSEKEEPING:                                        *;
*  PUT ADMPRINT, DSPRINT TOGETHER LIKE CICS DEFINITIONS              *;
*  COMBINE WITH CICS DEFINITIONS AND SORT                            *;
*--------------------------------------------------------------------*;
 DATA OTHER;
 SET ADMPRINT DSPRINT;
 RETAIN FCTID     '  '
        CICSID    '    '
        EDSID     0
        TCTID     '        '
        CICSID    '    '
        CONNECT   '    '
        RELEASE   '        '
        PRTID     '        '
        PRTCOPY   '    '
        EDSNAME   '     '
        EDSSEC    '    ';

 EDSID=.;*SET TO MISSING VALUE;

*--------------------------------------------------------------------*;
* MERGE ALL CICS JUNK TOGETHER;
*--------------------------------------------------------------------*;
 DATA CICS;
 SET CICSSTAR CICSMISC CICSTEST CICSEURO OTHER;
*--------------------------------------------------------------------*;
 PROC SORT DATA=CICS;
 BY VTAMID APPLID CICSID;

  PAGE;
*--------------------------------------------------------------------*;
 DATA MAGILLA (DROP = INVTAM INCICS INOTHER);
 MERGE VTAM
       CICS ;
 BY VTAMID ;

*--------------------------------------------------------------------*;
*--------------------------------------------------------------------*;
*                                                                    *;
* NOW GENERATE INFO/SYSTEM FORMAT ENTRY FOR STORAGE IN               *;
* TECHINFO SYSTEM UNDER U09NNN1 RECORD                               *;
* REPORT 1: TOTAL SYSTEM CONFIGURATION                               *;
*--------------------------------------------------------------------*;

 DATA _NULL_

      PRINTERS
           (KEEP = VTAMID VTAMTYPE TERMMODE VTAMLINE VTAMCU COMTYPE
                   UCB    LIB      CICSID   CICSTYPE APPLID
                   TCTID  RELEASE  CONNECT  PRTID    PRTCOPY
                   EDSID  FCTID    PEPID    LOGAPPL  EDSNAME EDSSEC
           )
      STARTERM
           (KEEP = VTAMID VTAMTYPE TERMMODE VTAMLINE VTAMCU COMTYPE
                   UCB    LIB      CICSID   CICSTYPE APPLID
                   TCTID  RELEASE  CONNECT  PRTID    PRTCOPY
                   EDSID  FCTID    PEPID    LOGAPPL  EDSNAME EDSSEC
           ) ;
 SET MAGILLA END=EOF;
 BY VTAMID;

 FILE INFO NOPRINT RECFM=VB LRECL=84 ; *  BLKSIZE=6233;

 RETAIN SEQNO 0; * LINE COUNTER FOR LINE NUMBERS IN COL 1-8;

 IF VTAMID = '        ' & CICSID = '    ' THEN DELETE;

 IF CICSID = '    ' & APPLID = '        ' THEN
   DO;
     CICSTYPE = '(not def';
     APPLID   = 'to CICS)';
     RELEASE  = '<-------';
   END;

 IF UCB = '   '    THEN
   DO;
     VTAMTYPE = '(not def';
     TERMMODE = 'to VTAM)';
     VTAMLINE = '<-------';
   END;

 IF SUBSTR(TERMMODE,2,3) ^= '327' &
    SUBSTR(TERMMODE,1,3) ^= 'RJE' &
           TERMMODE      ^= 'to VTAM)'  &
    SUBSTR(TERMMODE,3,4) ^= '3767'
   THEN
    DO;
      OUTPUT PRINTERS;
    END;

 IF EDSNAME ^= '     ' THEN OUTPUT STARTERM;

 IF FIRST.VTAMID THEN
  DO;
     LINK BUMPCNT;

     PUT      @1  SEQNO    Z8.
              @9  VTAMID   $CHAR8.
              @18 VTAMTYPE $CHAR8.
              @27 TERMMODE $CHAR8.
              @36 VTAMLINE $CHAR8.
              @45 VTAMCU   $CHAR8.
              @54 COMTYPE  $CHAR4.
              @59 UCB      $CHAR3.
              @63 LIB      $CHAR3.
              @73 LOGAPPL  $CHAR8. ;
  END;

 LINK BUMPCNT;

 PUT      @1  SEQNO    Z8.
          @13 CICSID   $CHAR4.
          @18 CICSTYPE $CHAR8.
          @27 APPLID   $CHAR8.
          @36 RELEASE  $CHAR8.
          @45 PRTID    $CHAR8.
          @54 CONNECT  $CHAR4.
          @59 PRTCOPY  $CHAR4.
          @65 TCTID    $CHAR2.
          @68 FCTID    $CHAR2.
          @71 EDSID    4.
          @76 EDSNAME  $CHAR5.;


 IF EOF THEN LINK FOOTING;

 RETURN;
  PAGE;
*--------------------------------------------------------------------*;
 BUMPCNT:
 SEQNO = SEQNO+1;
 IF SEQNO = 1 THEN LINK HEADING;
 IF MOD(SEQNO,60) = 3 THEN LINK NEWPAGE;
 RETURN;
*--------------------------------------------------------------------*;
 NEWPAGE:
 PUT   @1 SEQNO Z8.
       @9 'VTAMID   VTAMTYPE LOGMODE  VTAMLINE VTAMCU   COMM UCB LIB'
      @68 '     LOGAPPL ';
       _P '  CICSID CICSTYPE APPLID   RELEASE? PRINTER? AUTO COPY  TC'
      @68 'FC EDS# EDSID';
       _P '-------- -------- -------- -------- -------- ---- --------'
      @68 '-- ---- -----';
  SEQNO = SEQNO+1;
/*1   1     2         3         4         5         6         7
9012345678901234567890123456789012345678901234567890123456789012345678
VTAMID   VTAMTYPE LOGMODE  VTAMLINE VTAMCU   COMM UCB LIB       LOGAPPL
  CICSID CICSTYPE APPLID   RELEASE? PRINTER  AUTO COPY  TC FC EDS# EDSID
XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX XXXX XXX XXX       XXXXXXXX
    XXXX XXXXXXXX XXXXXXXX XXX XXX  XXXXXXXX XXXX XXXX  XX XX XXXX XXXXX

 */
   RETURN;
*--------------------------------------------------------------------*;
 HEADING:
 RETAIN THEDATE '      ' DATTIM '                    '
        UVALUE  'U090001';
 IF SUBSTR(PEPID,1,3) = 'PEP'
    THEN SUBSTR(UVALUE,4,3) = SUBSTR(PEPID,4,3);* PEPNNN  TYPE NCP2.0;
    ELSE SUBSTR(UVALUE,4,3) = SUBSTR(PEPID,5,3);* P0102NN TYPE NCP2.1;
 THEDATE = PUT(DATE( ),MONYY5.);
 DATTIM = PUT(DATETIME( ),DATETIME17.);
 SUBSTR(DATTIME,8,1) = ' ';

 PUT   @1 SEQNO Z8.
 @9 'H ' UVALUE 'D=' THEDATE 'S=INTEL';
 _P 'T Current ACF/VTAM network configuration for SJ1 IBM MVS system';
 _P 'T as of ' DATTIM 'for ' PEPID 'using PROD/TEST/EURO CICS TCTS,';
 _P 'T EDS PSCURTY files, and ADMPRINT/DSPRINT printer definitions.';
 _P 'L VTAM CICS NETWORK DEFINITION CONFIG CONFIGURATION NET NCP PEP';
 _P 'L TCT LOCAL TERMINAL TERMINALS PRINTER ADMPRINT DSPRINT '
   PEPID THEDATE ;
 _P ' ';
 _P 'The following table is generated from the VTAM ACF/NCP and local';
 _P 'network definition for ' PEPID 'and the current PROD/TEST/EURO';
 _P 'CICS TCT/FCT, STAR PSCURTY, and ADMPRINT/DSPRINT print queues.';
 _P ' ';
 _P 'The headings have the following meanings:';
 _P ' VTAMID   - VTAM terminal name  ×  CICSID   - CICS terminal name';
 _P ' VTAMTYPE - VTAM term. type     ×  CICSTYPE - CICS term. type';
 _P ' LOGMODE  - dflt. VTAM LOGMODE  ×  APPLID   - Application  ID';
 _P ' VTAMLINE - VTAM line name      ×  RELEASE? - CICS RELREQ= parm';
 _P ' VTAMCU   - VTAM control unit   ×  PRINTER  - CICS printer addr';
 _P ' COMM     - VTAM comm. mode     ×  AUTO     - CICS auto connect';
 _P ' UCB      - unit addr. or "NCP" ×  COPY     - CICS printer option';
 _P ' LIB      - 3705 "LIB" address  ×   TC FC   - CICS TCT & FCT suffix
es';
_P ' LOGAPPL  - auto logon-to system×  EDS# EDSID-STAR station #/name ';
_P '                                ×  EDSID=-UND-:not in PSCURTY file';
  SEQNO = SEQNO+1;

 DROP THEDATE DATTIM;

 LINK NEWPAGE;

 RETURN;
  PAGE;
*--------------------------------------------------------------------*;
 FOOTING:
       _P ' ';
       _P 'Author: Ken True  (created by "NETINFO" SAS program)';
       _P '$EOM';
  SEQNO = SEQNO+1;

 RETURN;
*--------------------------------------------------------------------*;
 /*
H ********
T NETWORK DEFINITION FOR VTAM AND CICS TERMINALS FOR PEP PPPPPP
K NET NETWORK DEFINITION DOCUMENT DOC VTAM CICS TERM TERMINALS P
K PPPPPP DFHTCT TCT DFHTCTNN DFHTCTNN

  1   1     2         3         4         5         6         7
9012345678901234567890123456789012345678901234567890123456789012345678
VTAMID   VTAMTYPE LOGMODE  VTAMLINE VTAMCU   COMM UCB LIB       LOGAPPL
  CICSID CICSTYPE APPLID   RELEASE? PRINTER  AUTO COPY  TC FC EDS# EDSID
XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX XXXXXXXX XXXX XXX XXX       XXXXXXXX
    XXXX XXXXXXXX XXXXXXXX XXX XXX  XXXXXXXX XXXX XXXX  XX XX XXXX XXXXX



AUTHOR:  KEN TRUE
$EOM
  */ ;
    PAGE;
*--------------------------------------------------------------------*;
*--------------------------------------------------------------------*;
*                                                                    *;
* NOW GENERATE INFO/SYSTEM FORMAT ENTRY FOR STORAGE IN               *;
* TECHINFO SYSTEM UNDER U09NNN2 RECORD                               *;
* REPORT 2 - TOTAL NETWORK NON-RJE PRINTER REPORT                    *;
*--------------------------------------------------------------------*;

 DATA _NULL_
      TABLETOP
           (KEEP = VTAMID VTAMTYPE TERMMODE VTAMLINE VTAMCU COMTYPE
                   UCB    LIB      CICSID   CICSTYPE APPLID
                   TCTID  RELEASE  CONNECT  PRTID    PRTCOPY
                   EDSID  FCTID    PEPID    LOGAPPL  EDSNAME EDSSEC
           ) ;
 SET PRINTERS END=EOF;
 BY VTAMID;

 FILE INFO NOPRINT RECFM=VB LRECL=84 MOD; *  BLKSIZE=6233;

 RETAIN SEQNO 0; * LINE COUNTER FOR LINE NUMBERS IN COL 1-8;

 IF APPLID = 'ADMPRINT'  ×
    APPLID = 'DSPRINT '   THEN  OUTPUT TABLETOP;

 IF FIRST.VTAMID THEN
  DO;
     LINK BUMPCNT1;

     PUT      @1  SEQNO    Z8.
              @9  VTAMID   $CHAR8.
              @18 VTAMTYPE $CHAR8.
              @27 TERMMODE $CHAR8.
              @36 VTAMLINE $CHAR8.
              @45 VTAMCU   $CHAR8.
              @54 COMTYPE  $CHAR4.
              @59 UCB      $CHAR3.
              @63 LIB      $CHAR3.
              @73 LOGAPPL  $CHAR8. ;
  END;

 LINK BUMPCNT1;

 PUT      @1  SEQNO    Z8.
          @13 CICSID   $CHAR4.
          @18 CICSTYPE $CHAR8.
          @27 APPLID   $CHAR8.
          @36 RELEASE  $CHAR8.
          @45 PRTID    $CHAR8.
          @54 CONNECT  $CHAR4.
          @59 PRTCOPY  $CHAR4.
          @65 TCTID    $CHAR2.
          @68 FCTID    $CHAR2.
          @71 EDSID    4.
          @76 EDSNAME  $CHAR5.;

 IF EOF THEN LINK FOOTING1;

 RETURN;
  PAGE;
*--------------------------------------------------------------------*;
 BUMPCNT1:
 SEQNO = SEQNO+1;
 IF SEQNO = 1 THEN LINK HEADING1;
 IF MOD(SEQNO,60) = 3 THEN LINK NEWPAGE1;
 RETURN;
*--------------------------------------------------------------------*;
 NEWPAGE1:;
 PUT   @1 SEQNO Z8.
       @9 'VTAMID   VTAMTYPE LOGMODE  VTAMLINE VTAMCU   COMM UCB LIB'
      @68 '     LOGAPPL ';
       _P '  CICSID CICSTYPE APPLID   RELEASE? PRINTER? AUTO COPY  TC'
      @68 'FC EDS# EDSID';
       _P '-------- -------- -------- -------- -------- ---- --------'
      @68 '-- ---- -----';
  SEQNO = SEQNO+1;
   RETURN;
*--------------------------------------------------------------------*;
 HEADING1:
 RETAIN THEDATE '      ' DATTIM '                    '
        UVALUE  'U090002';
 IF SUBSTR(PEPID,1,3) = 'PEP'
    THEN SUBSTR(UVALUE,4,3) = SUBSTR(PEPID,4,3);* PEPNNN  TYPE NCP2.0;
    ELSE SUBSTR(UVALUE,4,3) = SUBSTR(PEPID,5,3);* P0102NN TYPE NCP2.1;
 THEDATE = PUT(DATE( ),MONYY5.);
 DATTIM = PUT(DATETIME( ),DATETIME17.);
 SUBSTR(DATTIME,8,1) = ' ';

 PUT   @1 SEQNO Z8.
 @9 'H ' UVALUE 'D=' THEDATE 'S=INTEL';
 _P 'T Current non-RJE printer configuration for SJ1 IBM MVS system';
 _P 'T as of ' DATTIM 'for ' PEPID 'with PROD/TEST/EURO CICS,';
 _P 'T STAR PSCURTY, ADMPRINT and DSPRINT printer definitions.';
 _P 'L VTAM CICS NETWORK DEFINITION CONFIG CONFIGURATION NET NCP PEP';
 _P 'L TCT LOCAL PRINTER PRINTERS ADMPRINT DSPRINT ' PEPID THEDATE ;
 _P ' ';
 _P 'The following table is generated from the VTAM ACF/NCP and local';
 _P 'network definition for ' PEPID ', current CICS/ADMRPRINT/DSPRINT
 ';
 _P 'tables and/or TCT definitions, and STAR PSCURTY files.';
 _P ' ';
 _P 'The headings have the following meanings:';
 _P ' VTAMID   - VTAM terminal name  ×  CICSID   - CICS terminal name';
 _P ' VTAMTYPE - VTAM term. type     ×  CICSTYPE - CICS term. type';
 _P ' LOGMODE  - dflt. VTAM LOGMODE  ×  APPLID   - Application  ID';
 _P ' VTAMLINE - VTAM line name      ×  RELEASE? - CICS RELREQ= parm';
 _P ' VTAMCU   - VTAM control unit   ×  PRINTER  - CICS printer addr';
 _P ' COMM     - VTAM comm. mode     ×  AUTO     - CICS auto connect';
 _P ' UCB      - unit addr. or "NCP" ×  COPY     - CICS printer option';
 _P ' LIB      - 3705 "LIB" address  ×   TC FC   - CICS TCT & FCT suffix
 ';
_P ' LOGAPPL  - auto logon-to system×  EDS# EDSID-STAR station #/name ';
_P '                                ×  EDSID=-UND-:not in PSCURTY file';
  SEQNO = SEQNO+1;

 DROP THEDATE DATTIM;

 LINK NEWPAGE1;

 RETURN;
  PAGE;
*--------------------------------------------------------------------*;
 FOOTING1:;
       _P ' ';
       _P 'Author: Ken True  (created by "NETINFO" SAS program)';
       _P '$EOM';
  SEQNO = SEQNO+1;

 RETURN;
    PAGE;
*--------------------------------------------------------------------*;
*--------------------------------------------------------------------*;
*                                                                    *;
* NOW GENERATE INFO/SYSTEM FORMAT ENTRY FOR STORAGE IN               *;
* TECHINFO SYSTEM UNDER U09NNN3 RECORD                               *;
* REPORT 3 - ADMPRINT AND DSPRINT PRINTERS ONLY                      *;
*--------------------------------------------------------------------*;

 DATA _NULL_ ;
 SET TABLETOP END=EOF;
 BY VTAMID;

 FILE INFO NOPRINT RECFM=VB LRECL=84 MOD ;*BKSIZE=6233;

 RETAIN SEQNO 0; * LINE COUNTER FOR LINE NUMBERS IN COL 1-8;


 IF FIRST.VTAMID THEN
  DO;
     LINK BUMPCNT2;

     PUT      @1  SEQNO    Z8.
              @9  VTAMID   $CHAR8.
              @18 VTAMTYPE $CHAR8.
              @27 TERMMODE $CHAR8.
              @36 VTAMLINE $CHAR8.
              @45 VTAMCU   $CHAR8.
              @54 COMTYPE  $CHAR4.
              @59 UCB      $CHAR3.
              @63 LIB      $CHAR3.
              @73 LOGAPPL  $CHAR8. ;
  END;

 LINK BUMPCNT2;

 PUT      @1  SEQNO    Z8.
          @13 CICSID   $CHAR4.
          @18 CICSTYPE $CHAR8.
          @27 APPLID   $CHAR8.
          @36 RELEASE  $CHAR8.
          @45 PRTID    $CHAR8.
          @54 CONNECT  $CHAR4.
          @59 PRTCOPY  $CHAR4.
          @65 TCTID    $CHAR2.
          @68 FCTID    $CHAR2.
          @71 EDSID    4.
          @76 EDSNAME  $CHAR5.;

 IF EOF THEN LINK FOOTING2;

 RETURN;
  PAGE;
*--------------------------------------------------------------------*;
 BUMPCNT2:
 SEQNO = SEQNO+1;
 IF SEQNO = 1 THEN LINK HEADING2;
 IF MOD(SEQNO,60) = 2 THEN LINK NEWPAGE2;
 RETURN;
*--------------------------------------------------------------------*;
 NEWPAGE2:;
 PUT   @1 SEQNO Z8.
       @9 'VTAMID   VTAMTYPE LOGMODE  VTAMLINE VTAMCU   COMM UCB LIB'
      @68 '             ';
       _P '         APPLTYPE APPLID                                 '
      @68 '             ';
       _P '-------- -------- -------- -------- -------- ---- --------'
      @68 '             ';
  SEQNO = SEQNO+1;
   RETURN;
*--------------------------------------------------------------------*;
 HEADING2:
 RETAIN THEDATE '      ' DATTIM '                    '
        UVALUE  'U090003';
 IF SUBSTR(PEPID,1,3) = 'PEP'
    THEN SUBSTR(UVALUE,4,3) = SUBSTR(PEPID,4,3);* PEPNNN  TYPE NCP2.0;
    ELSE SUBSTR(UVALUE,4,3) = SUBSTR(PEPID,5,3);* P0102NN TYPE NCP2.1;
 THEDATE = PUT(DATE( ),MONYY5.);
 DATTIM = PUT(DATETIME( ),DATETIME17.);
 SUBSTR(DATTIME,8,1) = ' ';

 PUT   @1 SEQNO Z8.
 @9 'H ' UVALUE 'D=' THEDATE 'S=INTEL';
 _P 'T Current ADMPRINT and DSPRINT printer configuration ';
 _P 'T as of ' DATTIM 'for ' PEPID 'and local VTAM printers.';
 _P 'K ADMPRINT DSPRINT LOCAL PRINTER PRINTERS ';
 _P 'K  ' PEPID THEDATE ;
 _P 'L VTAM NETWORK DEFINITION CONFIG CONFIGURATION NET NCP PEP';
 _P ' ';
 _P 'The following table is generated from the VTAM ACF/NCP and local';
 _P 'network definition for ' PEPID 'and current ADMRPRINT/DSPRINT ';
 _P ' ';
 _P 'The headings are as follows:';
 _P ' VTAMID   - VTAM terminal name  ×  ';
 _P ' VTAMTYPE - VTAM term. type     ×  APPLTYPE - applic. term type';
 _P ' LOGMODE  - dflt. VTAM LOGMODE  ×  APPLID   - Application  ID';
 _P ' VTAMLINE - VTAM line name      ×  ';
 _P ' VTAMCU   - VTAM control unit   ×  ';
 _P ' COMM     - VTAM comm. mode     ×  ';
 _P ' UCB      - unit addr. or "NCP" ×  ';
 _P ' LIB      - 3705 "LIB" address  ×  ';
 _P ' LOGAPPL  - auto logon-to system ';
 _P ' ';
  SEQNO = SEQNO+1;

 DROP THEDATE DATTIM;

 LINK NEWPAGE2;

 RETURN;
  PAGE;
*--------------------------------------------------------------------*;
 FOOTING2:;
       _P ' ';
       _P 'Author: Ken True  (created by "NETINFO" SAS program)';
       _P '$EOM';
  SEQNO = SEQNO+1;

 RETURN;
    PAGE;
*--------------------------------------------------------------------*;
*--------------------------------------------------------------------*;
*                                                                    *;
* NOW GENERATE INFO/SYSTEM FORMAT ENTRY FOR STORAGE IN               *;
* TECHINFO SYSTEM UNDER U09NNN4 RECORD                               *;
* REPORT 4 - STAR STATION NUMBERS SORTED BY NUMBER                   *;
*--------------------------------------------------------------------*;
PROC SORT DATA=STARTERM;
BY EDSID APPLID CICSID;

 DATA _NULL_
      STARNAME
           (KEEP = VTAMID VTAMTYPE TERMMODE VTAMLINE VTAMCU COMTYPE
                   UCB    LIB      CICSID   CICSTYPE APPLID
                   TCTID  RELEASE  CONNECT  PRTID    PRTCOPY
                   EDSID  FCTID    PEPID    LOGAPPL  EDSNAME EDSSEC
           ) ;
 SET STARTERM END=EOF;
 BY EDSID;

 FILE INFO NOPRINT RECFM=VB LRECL=84 MOD; *  BLKSIZE=6233;

 RETAIN SEQNO 0; * LINE COUNTER FOR LINE NUMBERS IN COL 1-8;

 IF VTAMLINE='<-------' THEN
   DO;
      COMTYPE=' not';
      UCB    ='def';
      LIB    =' to';
      LOGAPPL='VTAM    ';
   END;

 IF EDSNAME ^='-UND-' THEN OUTPUT STARNAME;

 LINK BUMPCNT4;

 IF FIRST.EDSID
   THEN
     PUT      @1  SEQNO    Z8.
              @9  EDSID    4.
              @14 EDSNAME  $CHAR5.
              @20 APPLID   $CHAR8.
              @29 TCTID    $CHAR2.
              @32 FCTID    $CHAR2.
              @36 CICSID   $CHAR4.
              @42 VTAMID   $CHAR8.
              @51 VTAMLINE $CHAR8.
              @60 COMTYPE  $CHAR4.
              @65 UCB      $CHAR3.
              @69 LIB      $CHAR3.
              @73 LOGAPPL  $CHAR8. ;

   ELSE
     PUT      @1  SEQNO    Z8.
              @14 EDSNAME  $CHAR5.
              @20 APPLID   $CHAR8.
              @29 TCTID    $CHAR2.
              @32 FCTID    $CHAR2.
              @36 CICSID   $CHAR4.
              @42 VTAMID   $CHAR8.
              @51 VTAMLINE $CHAR8.
              @60 COMTYPE  $CHAR4.
              @65 UCB      $CHAR3.
              @69 LIB      $CHAR3.
              @73 LOGAPPL  $CHAR8. ;

 IF EOF THEN LINK FOOTING4;

 RETURN;
/*1   1     2         3         4         5         6         7
9012345678901234567890123456789012345678901234567890123456789012345678
EDS# EDSID APPLID   TC FC CICSID VTAMID   VTAMLINE COMM UCB LIB  LOGAPPL
XXXX XXXXX XXXXXXXX XX XX  XXXX  XXXXXXXX XXXXXXXX XXXX XXX XXX XXXXXXXX

 */
  PAGE;
*--------------------------------------------------------------------*;
 BUMPCNT4:;
 SEQNO = SEQNO+1;
 IF SEQNO = 1 THEN LINK HEADING4;
 IF MOD(SEQNO,60) = 3 THEN LINK NEWPAGE4;
 RETURN;
*--------------------------------------------------------------------*;
 NEWPAGE4:;
 PUT   @1 SEQNO Z8.
       @9 'EDS# EDSID APPLID   TC FC CICSID VTAMID   VTAMLINE COMM UCB'
      @68 ' LIB LOGAPPL ';
       _P '---- ----- -------- -- --  ----  -------- -------- ---- ---'
      @68 ' --- --------';
  SEQNO = SEQNO+1;
   RETURN;
*--------------------------------------------------------------------*;
 HEADING4:
 RETAIN THEDATE '      ' DATTIM '                    '
        UVALUE  'U090004';
 IF SUBSTR(PEPID,1,3) = 'PEP'
    THEN SUBSTR(UVALUE,4,3) = SUBSTR(PEPID,4,3);* PEPNNN  TYPE NCP2.0;
    ELSE SUBSTR(UVALUE,4,3) = SUBSTR(PEPID,5,3);* P0102NN TYPE NCP2.1;
 THEDATE = PUT(DATE( ),MONYY5.);
 DATTIM = PUT(DATETIME( ),DATETIME17.);
 SUBSTR(DATTIME,8,1) = ' ';

 PUT   @1 SEQNO Z8.
 @9 'H ' UVALUE 'D=' THEDATE 'S=INTEL';
 _P 'T Current STAR EDS station id configuration for SJ1 MVS system';
 _P 'T as of ' DATTIM 'for ' PEPID 'with PROD/TEST/EURO CICS,';
 _P 'T and STAR PSCURTY definitions.  Sorted by EDS Station Number';
 _P 'L VTAM CICS NETWORK DEFINITION CONFIG CONFIGURATION NET NCP PEP';
 _P 'L TCT LOCAL STAR EDS STATION ID NAME  ' PEPID THEDATE ;
 _P ' ';
 _P 'The following table is generated from the VTAM ACF/NCP and local';
 _P 'network definition for ' PEPID ', current STAR/TEST/EURO CICS table
s';
 _P 'and STAR PSCURTY files.  The table is sorted by EDS station number.
';
 _P ' ';
 _P 'The headings have the following meanings:';
 _P ' EDS#     - STAR EDS station number ';
 _P ' EDSID    - STAR EDS station name ';
 _P ' APPLID   - CICS system VTAM application id';
 _P ' TC, FC   - CICS TCT and FCT suffixes';
 _P ' CICSID   - CICS Terminal ID ';
 _P ' VTAMID   - VTAM Terminal name';
 _P ' VTAMLINE - VTAM Line name    ';
 _P ' COMM     - VTAM Communication type';
 _P ' UCB,LIB  - 3705 UCB or "NCP", and 3705 "LIB" address';
 _P ' LOGAPPL  - auto logon-to system id';
  SEQNO = SEQNO+1;

 DROP THEDATE DATTIM;

 LINK NEWPAGE4;

 RETURN;
  PAGE;
*--------------------------------------------------------------------*;
 FOOTING4:;
       _P ' ';
       _P 'Author: Ken True  (created by "NETINFO" SAS program)';
       _P '$EOM';
  SEQNO = SEQNO+1;

 RETURN;
    PAGE;
*--------------------------------------------------------------------*;
*--------------------------------------------------------------------*;
*                                                                    *;
* NOW GENERATE INFO/SYSTEM FORMAT ENTRY FOR STORAGE IN               *;
* TECHINFO SYSTEM UNDER U09NNN4 RECORD                               *;
* REPORT 5 - STAR STATION NAMES SORTED BY NAME FOR OPERATIONAL TERMS *;
*--------------------------------------------------------------------*;
PROC SORT DATA=STARNAME;
BY EDSNAME APPLID CICSID EDSID;

 DATA _NULL_ ;
 SET STARNAME END=EOF;
 BY EDSNAME;

 FILE INFO NOPRINT RECFM=VB LRECL=84 MOD; *  BLKSIZE=6233;

 RETAIN SEQNO 0; * LINE COUNTER FOR LINE NUMBERS IN COL 1-8;

 IF VTAMLINE='<-------' THEN
   DO;
      COMTYPE=' not';
      UCB    ='def';
      LIB    =' to';
      LOGAPPL='VTAM    ';
   END;

     LINK BUMPCNT5;

 IF FIRST.EDSNAME
   THEN
     PUT      @1  SEQNO    Z8.
              @9  EDSNAME  $CHAR5.
              @15 EDSID    4.
              @20 APPLID   $CHAR8.
              @29 TCTID    $CHAR2.
              @32 FCTID    $CHAR2.
              @36 CICSID   $CHAR4.
              @42 VTAMID   $CHAR8.
              @51 VTAMLINE $CHAR8.
              @60 COMTYPE  $CHAR4.
              @65 UCB      $CHAR3.
              @69 LIB      $CHAR3.
              @73 LOGAPPL  $CHAR8. ;

   ELSE
     PUT      @1  SEQNO    Z8.
              @15 EDSID    4.
              @20 APPLID   $CHAR8.
              @29 TCTID    $CHAR2.
              @32 FCTID    $CHAR2.
              @36 CICSID   $CHAR4.
              @42 VTAMID   $CHAR8.
              @51 VTAMLINE $CHAR8.
              @60 COMTYPE  $CHAR4.
              @65 UCB      $CHAR3.
              @69 LIB      $CHAR3.
              @73 LOGAPPL  $CHAR8. ;

 IF EOF THEN LINK FOOTING5;

 RETURN;
/*1   1     2         3         4         5         6         7
9012345678901234567890123456789012345678901234567890123456789012345678
EDSID EDS# APPLID   TC FC CICSID VTAMID   VTAMLINE COMM UCB LIB  LOGAPPL
XXXXX XXXX XXXXXXXX XX XX  XXXX  XXXXXXXX XXXXXXXX XXXX XXX XXX XXXXXXXX

 */
  PAGE;
*--------------------------------------------------------------------*;
 BUMPCNT5:;
 SEQNO = SEQNO+1;
 IF SEQNO = 1 THEN LINK HEADING5;
 IF MOD(SEQNO,60) = 3 THEN LINK NEWPAGE5;
 RETURN;
*--------------------------------------------------------------------*;
 NEWPAGE5:;
 PUT   @1 SEQNO Z8.
       @9 'EDSID EDS# APPLID   TC FC CICSID VTAMID   VTAMLINE COMM UCB'
      @68 ' LIB LOGAPPL ';
       _P '----- ---- -------- -- --  ----  -------- -------- ---- ---'
      @68 ' --- --------';
  SEQNO = SEQNO+1;
   RETURN;
*--------------------------------------------------------------------*;
 HEADING5:
 RETAIN THEDATE '      ' DATTIM '                    '
        UVALUE  'U090005';
 IF SUBSTR(PEPID,1,3) = 'PEP'
    THEN SUBSTR(UVALUE,4,3) = SUBSTR(PEPID,4,3);* PEPNNN  TYPE NCP2.0;
    ELSE SUBSTR(UVALUE,4,3) = SUBSTR(PEPID,5,3);* P0102NN TYPE NCP2.1;
 THEDATE = PUT(DATE( ),MONYY5.);
 DATTIM = PUT(DATETIME( ),DATETIME17.);
 SUBSTR(DATTIME,8,1) = ' ';

 PUT   @1 SEQNO Z8.
 @9 'H ' UVALUE 'D=' THEDATE 'S=INTEL';
 _P 'T Current STAR EDS station id configuration for SJ1 MVS system';
 _P 'T as of ' DATTIM 'for ' PEPID 'with PROD/TEST/EURO CICS,';
 _P 'T and STAR PSCURTY definitions.  Sorted by EDS Station NAME. ';
 _P 'L VTAM CICS NETWORK DEFINITION CONFIG CONFIGURATION NET NCP PEP';
 _P 'L TCT LOCAL STAR EDS STATION ID NAME  ' PEPID THEDATE ;
 _P ' ';
 _P 'The following table is generated from the VTAM ACF/NCP and local';
 _P 'network definition for ' PEPID ', current STAR/TEST/EURO CICS table
s';
 _P 'and STAR PSCURTY files.  The table is sorted by EDS station NAME.
';
 _P 'NOTE: Terminals not defined to PSCURTY are excluded from this list.
';
 _P 'The headings have the following meanings:';
 _P ' EDSID    - STAR EDS station name as defined in PSCURTY file';
 _P ' EDS#     - STAR EDS station number ';
 _P ' APPLID   - CICS system VTAM application id';
 _P ' TC, FC   - CICS TCT and FCT suffixes';
 _P ' CICSID   - CICS Terminal ID ';
 _P ' VTAMID   - VTAM Terminal name';
 _P ' VTAMLINE - VTAM Line name    ';
 _P ' COMM     - VTAM Communication type';
 _P ' UCB,LIB  - 3705 UCB or "NCP", and 3705 "LIB" address';
 _P ' LOGAPPL  - auto logon-to system id';
  SEQNO = SEQNO+1;

 DROP THEDATE DATTIM;

 LINK NEWPAGE5;

 RETURN;
  PAGE;
*--------------------------------------------------------------------*;
 FOOTING5:;
       _P ' ';
       _P 'Author: Ken True  (created by "NETINFO" SAS program)';
       _P '$EOM';
  SEQNO = SEQNO+1;

 RETURN;
./       ADD   NAME=NETINFOS
*--------------------------------------------------------------------*;
* NETINFOS: PURPOSE..SPLIT UP THE INFOSYSTEM ENTRY PRODUCED BY       *;
*           NETINFO SAS PROGRAM INTO SEPARATE PRINT LISTINGS         *;
*           THAT ARE NICELY PAGINATED..                              *;
*                                                                    *;
*                                                                    *;
*  KEN TRUE   : 7/15/82                                              *;
*                                                                    *;
*--------------------------------------------------------------------*;
 DATA _NULL_;  /* MAKE 2 COPIES OF COVER LETER   */
 INFILE MEMO;
 FILE PRINT NOTITLES PS=66 MOD;
 INPUT @1 TEXT $CHAR72.;
 PUT @5 TEXT $CHAR72.;

 DATA _NULL_;
 INFILE MEMO;
 FILE PRINT NOTITLES PS=66 MOD;
 INPUT @1 TEXT $CHAR72.;
 PUT @5 TEXT $CHAR72.;

 DATA _NULL_;
 INFILE INFO  LENGTH=L;
 FILE PRINT NOTITLES PS=66 MOD;
 RETAIN TEST '        ';
 INPUT @1  SEQNO   $CHAR8. @;
 LEN = L-8;
 INPUT @9  TEXT    $VARYING72. LEN;
 TEST=TEXT;
 IF SEQNO = '00000001' ×
    SUBSTR(TEST,1,7) = 'VTAMID ' ×
    SUBSTR(TEST,1,5) = 'EDS# '   ×
    SUBSTR(TEST,1,6) = 'EDSID '
   THEN  PUT #1 @5 TEXT $VARYING72. LEN;
   ELSE  PUT    @5 TEXT $VARYING72. LEN;
 DELETE;
./       ADD   NAME=NETMEMO


 I          T          L  ×             TTTTT EEEE   CCC  H   H
            T          L  ×              T   E     C     H   H
 I  N NN  TTTTT        L  ×             T   EEE   C     HHHHH
 I  NN  N   T          L  ×            T   E     C     H   H
 I  N   N   T          L  ×           T   EEEE   CCC  H   H
 I  N   N   T    EEE   L  ×
 I  N   N   T   E   E  L  ×             IIIII  N   N  FFFFF  OOO
  IIN   N    TTTEEEEELL   ×              I    NN  N  F     O   O
                E         ×             I    N N N  FFF   O   O
                 EEE      ×            I    N  NN  F     O   O
                          ×         IIIII  N   N  F      OOO
--------------------------+--------------------------------------------+
                    IBM BUSINESS SYSTEMS SOFTWARE
------------------------------------------------------------------------


             TO:  LIST

           FROM:  KEN TRUE (SJ1-442, X7-5004)

        SUBJECT:  CURRENT NETWORK DOCUMENTATION FOR SJ1 IBM SYSTEM



        ATTACHED ARE THE FIVE (5) REPORTS DOCUMENTING THE CURRENT
        NETWORK CONFIGURATION FOR THE IBM 3081 BUSINESS SYSTEM.

        REPORTS ARE:

          1) TOTAL NETWORK CONFIGURATION SORTED BY VTAM TERMINAL NAME
          2) TOTAL NON-RJE PRINTER CONFIGURATION SORTED BY VTAM TERMINAL
          3) LIST OF PRINTERS FOR ADMPRINT/DSPRINT USAGE
          4) STAR EDS STATIONS WITH EDS STATION NAME SORTED BY STATION
             NUMBER
          5) STAR EDS STATION NAMES WITH EDS STATION NUMBERS SORTED BY
             EDS STATION NAME

        THESE REPORTS ARE ALSO AVAILABLE UNDER TSO VIA THE "TECHINFO"
        TSO COMMAND.


        LIST:  SHELBY SIEGEL (SJ1-442)
               KAREN  MAKI   (SJ1-442)
               JUDY JESSOP   (SJ1-442)
               JIM MACKO     (SJ1-411)

               OPERATIONS CONSOLE  (3081 MASTER CONSOLE)
               NCC OPERATOR        (SJ1-NCC AREA)
               MTO ROOM            (SJ1)
               OPS ANALYSTS (SJ1)
               DATA SERVICES  (2 COPIES) (HELP DESK)


               STAR HOTLINE  (DV1)  (3 COPIES)
               TOM HILL      (DV1-424)


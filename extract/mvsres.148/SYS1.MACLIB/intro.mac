         MACRO
&N       INTRO &PROGID=IEDIMCP,&CROSSRF=0,&DISK=YES,             X03039*
               &MSMIN=50,&MSMAX=70,&DLQ=,&CPRCDS=2,&TOPMSG=YES,        *
               &CONTROL=,&PASSWRD=,&CPB=0,                             *
               &PRIMARY=SYSCON,&INTVAL=0,&CKREQS=0,                    *
               &STARTUP=,&COMWRTE=NO,&WTTONE=0,&APDUMP=YES,    @ZA08385*
               &TRACE=(0),&CIB=2,&ENVIRON=TCAM,                @Y17XANA*
               &USEREG=0,&OLTEST=56,&DTRACE=(0),&TTRACE=,      @Y17XANA*
               &RESTART=0,&LINETYP=BOTH,&THRESH=(255,1,1,1),    SA65392*
               &FEATURE=(DIAL,2741,TIMER,NOCONC,NO3705,NOSNA), @YM06919*
               &SIBCNT=0,&SUBAREA=0,&MAXSUBA=0,                @Y17XANU*
               &OPMASK=(FFFC,FFFC,0008,FFFC,0008,0008,FFFC,C000,FF0C), *
               &MSKVAL=(FFFC,FFFC,0008,FFFC,0008,0008,FFFC,C000,FF0C), *
               &BTRACE=,&PLCBNO=0,&VM=NO,&COMMBUF=,            @PI02856*
               &ABEFMT=,&BUFFTR=(0,PAR,C),&BFRRTN=HI,          @OY19405*
               &LNUNITS=0,&MSUNITS=0,&CPINTVL=1800,&KEYLEN=,     Y02027*
               &UNITSZ=,&APWAS=4024,&AUTHA=YES,&BRACKET=NO     @X50X9FI
.*A000000-999999                                               @X31X8F0
.* CHANGE ACTIVITY AS FOLLOWS
.*                  VERSION DATED 08/03/77                     @G36XR0S
.*C321000,434000-435000                                          Y02027
.*C032000,595000,601000-602000,665000                           SA51078
.*A043900,579500,596200-596600,665300-665600                    SA51078
.*C142000                                                        S21903
.*D286000-294000                                                 S21903
.*A286000                                                        S21903
.*C010000,032000,057000,354550,416000                            S22027
.*A014100,030500,043800,045300-045600,327000-343960              S22027
.*A354554-354590,416090-416900                                   S22027
.*D327000-327600                                                 S22027
.*C008000,311000,315000,317000                                   S99258
.*C057000,684000                                                 S22029
.*D685000-687000                                                 S22029
.*D327000,354500                                                 S22026
.*C010000,032000                                                 S22026
.*A014500,043300-043600,066050-066850,326500-327500              S22026
.*A343090-343900,347300-347600,354460-354520                     S22026
.*                               CLEAN-UP                        S21903
.*A014000,074000                                                SA50203
.*C085000                                                       SA62343
.*A689125-689150                                                 Y01004
.*C307500,321000,434000-435000                                   Y01004
.*D689400                                                        Y01004
.*C142000,425000,669000                                          Y05330
.*A354636                                                        Y06328
.*A354637,354638                                                 Y05330
.*A011130,013100,030700                                          X03039
.*C000200,010000,011000,057000,063000,066700-066750,070000,079000X03039
.*C091000,096000,101100-101250,101500-101550,115500,127000,134000X03039
.*C142000,200000,227000,239000,254000,264000,274000,302000,31500X03039
.*C327060,327450,327730,354550-354558,354605-354624,354626-354650X03039
.*C356000-357000,366000,390000,400000,444000,495000,519000,525000X03039
.*C539000,551000,561000,612000,626000,638000,679000,715000       X03039
.*A396000                                                       SA63008
.*A030700,285000                                                SA65392
.*C007000,009000                                                SA65392
.*D286000                                                       SA65392
.*C010100,C032000,A043901-043902,D354593,C354596,A344597,        Y05331
.*A354628-354647                                                 Y05331
.*A143000                                                       OX02212
.*D690000                                                       OX02212
.*A115000,307500                                               @Z30X8FG
.*C008000,057000,142000,315000,327060,327450                   @Z30X8FG
.*C327730,348160,348600,375600,513000,533000                   @Z30X8FG
.*D124000-129000                                               @Z30X8FG
.*A311000                                                      @SA68227
.*C670000                                                      @SA71946
.*A600000                                                      @XA05310
.*C601000-602000,604000                                        @XA05310
.*D571000                                                      @XA05310
.*A195000                                                      @ZA02609
.*C202000,200000                                               @ZA02609
.*C011050,354657-354698                                        @X50X9FI
.*A354657                                                      @X50X9FI
.*C008000                                                      @SA74046
.*C354658                                                      @ZA05019
.*C354555-354558                                               @OX11333
.*A032000,043902                                               @ZA07083
.*C006000,327780-327810                                        @ZA07083
.*C010000,010100,013400-013700,057300,101120,142000            @Y17XANU
.*C353450-353510,354092,354160-354547                          @Y17XANU
.*A010000,030700,057000,057600,101750,616000                   @Y17XANU
.*D101122,307550-307950                                        @Y17XANU
.*A010300,075200,219110-219670                                 @Y17XAB3
.*D219800                                                      @Y17XAB3
.*C348600,351400,352800                                        @Y17XAXU
.*A082000-082100,740000-741050,742105-742195                   @Y17XANA
.*C004900,005200                                               @Y17XANA
.*D010100                                                      @Y17XANA
.*D219660-219670                                               @YM07738
.*C219650,729100                                               @YM07738
.*A058070,060900,702900                                        @YM07790
.*C011900,170100,171500,702900,711200                          @YM07790
.*D078600-079200                                               @YM07790
.* A289800,290100                                              @Y17XAXF
.*C355600,414900-699900,732400,732500,755400                   @G36XRFG
.*D414500-414800,700000                                        @G36XRFG
.*C738300-738400                                               @G36XRYP
.*A043942,579500                                               @OS77945
.*C032000,382000,595000,596400                                 @OS77945
.*C348120                                                      @OZ17630
.*C348080-348140                                               @OZ24197
.* RESEQUENCED AT THIS POINT. ALL LINE NUMBERS BELOW ARE VALID
.* A121000                                                     @OY16094
.* D122500                                                     @OY16094
.* C121500                                                     @OY16348
.* C126500-127000                                              @OY16351
.* C006000-006500                                              @OY16438
.* A065500,170000,171000,172500,                               @OY18015
.* A174000,175500,177000,178500,180000,181500,183000,184500,   @OY18015
.* A186000,187500,189000,190500,192000,193500                  @OY18015
.* D171500,173000,                                             @OY18015
.* D174500,176000,177500,179000,180500,182000,183500,185000,   @OY18015
.* D186500,188000,189500,191000,192500,194000                  @OY18015
.*A461000                                                      @OY19488
.*A007500,080000,135500,525500,523000                          @OY19124
.*C007500,066000,229000                                        @OY19405
.*C130000,132000                                               @OX20976
.*A131000                                                      @OX20976
.*A051500,611000                                               @OZ36390
.*A530500,535500,537500                                        @OZ36974
.* C193600,195000,506500                                       @OZ35527
.* A170200                                                     @OZ35527
.*A433000                                                      @OZ46929
.*C435000-436000                                               @OZ46929
.*D114000-115000                                               @OZ49910
.*D433100-433400                                               @OZ53057
.*C435000-435500                                               @OZ53057
         GBLA  &IEDQZF
         GBLA  &KEYLN                                          @OZ36390
.* &IEDQZF NUMBER WORDS TO BE ADDED TO SCB FOR SAVEAREA
         GBLB  &IEDQRN(8)                                        S22024
.* &IEDQRN(1) 0=NO 3705,1=3705 W/ OR W/O 270X SUPPORT)         @Y17XANU
.* &IEDQRN(2) 1=3705 ONLY SUPPORT                              @Y17XANU
.* &IEDQRN(3) 1=SNA ONLY SUPPORT                               @YM07790
.* &IEDQRN(4) 1=SNA ENVIRONMENT (W/ OR W/O PRE-SNA)            @YM07790
         GBLB  &IEDQZA(64)
.* &IEDQZA(44) SET BY COMMBUF=(N,N,N) OPERAND                    S22027
.* &IEDQZA(60) SET BY &FEATURE=NODIAL                           SA50203
.* &IEDQZA(13) SET BY FEATURE=(,,,CONCO) OR FEATURE=(,,,CONC)    S22026
.* &IEDQZA(42) SET BY NON-ZERO RESPONSE TO MSUNITS=INTEGER
.* &IEDQZA(51) SET BY &ENVIRON=TSO OR MIXED
.* &IEDQZA(52) SET BY &ENVIRON=TCAM OR MIXED
.* &IEDQZA(41) SET BY DISK=YES
.* &IEDQZA(7)  SET BY INTRO, DISTINGUISHES TCAM FROM QTAM.
.*             CHECKED BY INTRO TO AVOID DUPLICATE INTROS.
         GBLC  &IEDQSV1(50)             SET TO PROGID          @YM04652
         LCLA  &IEDLKEY
         LCLA  &IEDLSA
.* &IEDLSA IS INDEX THRU STARTUP OPERANDS
         LCLA  &IEDLSCB
         LCLA  &IEDLTON
         LCLA  &IEDLMIN,&IEDLMAX
         LCLA  &IEDLMS
         LCLA  &IEDLTRA
.* &IEDLTRA IS TRACE OPERAND SAVED FOR TREXIT
         LCLA  &A                                                S22027
         LCLA  &ABDUMP                  ABDUMP FORMATTING      @Y17XAB3
         LCLB  &AF(32)                                         @OY18015
         LCLA  &B,&TR,&BUFF                                    @OY19405
         LCLA  &G,&ECNT                 INDEX USED IN          @Y17XANU
.*                                      ANALYZING &OPMSK       @Y17XANU
         LCLC  &H                                              @Y17XANU
         LCLC  &SUBTVAL,&SUBIVAL        SUBT AND IOTR VALUES   @Y17XAXF
         LCLA  &IEDIDLN                                          X03039
         LCLA  &C,&D,&E,&F              THRESHHOLD VALUES       SA65392
         LCLB  &IEDLDSK
         LCLB  &IEDLSB(18)                                     @OS77945
         LCLA  &DTRACEN                 DTRACE TABLE ENTRIES   @Y17XANA
         LCLA  &TRACEN                  TRACE  TABLE ENTRIES   @Y17XANA
.* &IEDLSB(1)  STARTUP=C OR W SPECIFIED
.* &IEDLSB(2)  STARTUP=C SPECIFIED
.* &IEDLSB(3)  STARTUP=I SPECIFIED
.* &IEDLSB(4)  STARTUP=Y SPECIFIED
.* &IEDLSB(5)  LINETYP=STSP OR LINETYP=BOTH SPECIFIED - ZEROED
.* &IEDLSB(6)  LINETYP=BISC OR LINETYP=BOTH SPECIFIED - ZEROED
.* &IEDLSB(5) AND (6) BOTH SET IF LINETYP=MINI SPECIFIED
.* &IEDLSB(7)  TOPMSG=NO SPECIFIED
.* &IEDLSB(8)  FEATURE=NODIAL
.* &IEDLSB(9)  FEATURE=(,NO2741)
.* &IEDLSB(10) FEATURE=(,,NOTIMER)
.* &IEDLSB(11) FEATURE=(,,,CONC)                                 S22026
.* &IEDLSB(12) FEATURE=(,,,CONCO)                                S22026
.* &IEDLSB(13) COMMBUF=(N,N,N) SPECIFIED                         S22027
.* &IEDLSB(14) STARTUP=E SPECIFIED                              SA51078
.* &IEDLSB(15) VM=YES SPECIFIED                                  Y05331
.* &IEDLSB(16) VM=PROMPT SPECIFIED                               Y05331
.* &IEDLSB(18) STARTUP=N SPECIFIED                             @OS77945
         LCLC  &BRETURN                                        @OY19124
         LCLC  &IEDLSEC
         LCLC  &IEDLSKP
         LCLC  &IEDCBUF(3)                                       S22027
.* &IEDCBUF SET TO COMBUF VALUES                                 S22027
&IEDLSB(5) SETB 1                       SET TO DEFAULT OF
&IEDLSB(6) SETB 1                         LINETYP=BOTH
&IEDLSKP SETC  'IEDQ&SYSNDX'
         AIF   (NOT &IEDQZA(7)).GOODINT
         SPACE
         MNOTE 12,'IHB067 INTRO MACRO PREVIOUSLY SPECIFIED'
         SPACE 2
         MEXIT
.GOODINT ANOP
&IEDQZA(7) SETB 1
         SPACE
*                                                            * @Y17XANU
*              INTRO UPDATE - LEVEL A0                       * @Y17XANU
*                                                            * @Y17XANU
         SPACE 2
&IEDQZA(52) SETB ('&ENVIRON' EQ 'TCAM' OR '&ENVIRON' EQ 'MIXED')
&IEDQZA(51) SETB ('&ENVIRON' EQ 'TSO' OR '&ENVIRON' EQ 'MIXED')
         AIF   (&IEDQZA(51) OR &IEDQZA(52)).SKIPINV
         SPACE
         MNOTE 4,'IHB303  INVALID OPERAND ENVIRON, TCAM ASSUMED'
         SPACE 2
&IEDQZA(52) SETB 1                      SET DEFAULT TO 'TCAM'
.SKIPINV ANOP
         AIF   ('&FEATURE(4)' NE 'CONCO').CTEST2                 S22026
&IEDLSB(12) SETB 1                      FEATURE=(,,,CONCO)       S22026
&IEDQZA(13) SETB 1                      FEATURE=(,,,CONCO)       S22026
&IEDLSB(8)  SETB 1                      FORCE FEATURE=NODIAL     S22026
&IEDLSB(9)  SETB 1                      FORCE FEATURE=(,NO2741)  S22026
         AGO   .GOODFEA                                          S22026
.CTEST2  AIF   ('&FEATURE(4)' NE 'CONC').CTEST3                  S22026
&IEDLSB(11) SETB 1                      FEATURE=(,,,CONC)        S22026
&IEDQZA(13) SETB 1                      FEATURE=(,,,CONC)        S22026
         AGO   .DTST                                             S22026
.CTEST3  AIF   ('&FEATURE(4)' EQ 'NOCONC' OR '&FEATURE(4)' EQ '').DTST
.*                                                               S22026
         SPACE 1                                                 S22026
         MNOTE 4,'IHB303 INVALID OPERAND FEATURE, (,,,NOCONC) ASSUMED'
         SPACE 2                                                 S22026
.DTST    ANOP                                                    S22026
         AIF   ('&FEATURE(1)' EQ 'DIAL' OR '&FEATURE(1)' EQ '').DIAL
         AIF   ('&FEATURE(1)' EQ 'NODIAL').NODIAL
         SPACE
         MNOTE 4,'IHB303  INVALID OPERAND FEATURE, DIAL ASSUMED'
         SPACE 2
         AGO   .DIAL
.NODIAL  ANOP
&IEDLSB(8) SETB 1                       FEATURE=NODIAL
&IEDQZA(60) SETB 1                                              SA50203
.DIAL    ANOP
         AIF   ('&FEATURE(2)' EQ '2741' OR '&FEATURE(2)' EQ '').T2741
         AIF   ('&FEATURE(2)' EQ 'NO2741').NO2741
         SPACE
         MNOTE 4,'IHB303  INVALID OPERAND FEATURE, (,2741) ASSUMED'
         SPACE 2
         AGO   .T2741
.NO2741  ANOP
&IEDLSB(9) SETB 1                       FEATURE=(,NO2741)
.T2741   ANOP
         AIF   (&IEDQZA(51) AND &IEDLSB(9)).BADFEA              SA62343
         AGO   .GOODFEA
.BADFEA  ANOP
&IEDLSB(8) SETB 0
&IEDLSB(9) SETB 0
.GOODFEA ANOP                                                  @Y17XANU
         AIF   ('&FEATURE(3)' EQ 'TIMER' OR '&FEATURE(3)' EQ '').TIMER
         AIF   ('&FEATURE(3)' EQ 'NOTIMER').NOTIME
         SPACE
         MNOTE 4,'IHB303  INVALID OPERAND FEATURE, (,,TIMER) ASSUMED'
         SPACE 2
         AGO   .TIMER
.NOTIME  ANOP
&IEDLSB(10) SETB 1                      FEATURE=(,,NOTIMER)
.TIMER   ANOP
&IEDQRN(1)  SETB  1                                              S22024
         AIF   ('&FEATURE(5)' EQ 'NO3705' OR                           *
               '&FEATURE(5)' EQ '' OR                                  *
               '&FEATURE(5)' EQ 'NOVTAM').NO3705               @OY16348
         AIF   ('&FEATURE(5)' EQ 'MIXD3705' OR                         *
               '&FEATURE(5)' EQ 'MIXDVTAM').T3705                X03039
         AIF   ('&FEATURE(5)' NE 'ONLY3705' AND                        *
               '&FEATURE(5)' NE 'ONLYVTAM').BAD3705              X03039
&IEDQRN(2)  SETB  1                                              S22024
         AGO   .T3705                                            S22024
.BAD3705 ANOP                                                    S22024
         SPACE
         MNOTE 4,'IHB303 INVALID OPERAND FEATURE, (,,,,NO3705) ASSUMED'
.*                                                             @OY16351
         SPACE 2
.NO3705  ANOP                                                    S22024
&IEDQRN(1)  SETB  0                                              S22024
.T3705   ANOP                                                    S22024
         AIF   (NOT &IEDQRN(1)).BYPSNA  BRANCH IF EP ONLY      @PI02859
         AIF   ('&FEATURE(6)' EQ '').BYPSNA                    @OX20976
         AIF   ('&FEATURE(6)' EQ 'ONLYSNA').ONSNA ONLY SNA     @Y17XANU
         AIF   ('&FEATURE(6)' EQ 'MIXDSNA').MXSNA MIXED SNA    @Y17XANU
         AIF   ('&FEATURE(6)' EQ 'NOSNA').BYPSNA               @OX20976
         SPACE 1                                               @Y17XANU
         MNOTE 4,'IHB303 INVALID OPERAND FEATURE,(NOSNA) ASSUMED'
.*                                                             @OX20976
         AGO   .BYPSNA                  FORCE NO SNA           @OX20976
.ONSNA   ANOP                                                  @Y17XANU
&IEDQRN(3) SETB 1                       SET ONLY SNA           @YM07790
.MXSNA   ANOP                                                  @Y17XANU
&IEDQRN(4) SETB 1                       SET SNA ENVIRONMENT    @YM07790
.BYPSNA  ANOP                                                  @PI02859
&BRETURN SETC  '&BFRRTN'                                       @OY19124
         AIF   ('&BFRRTN' EQ 'HI' OR '&BFRRTN' EQ 'LO' OR '&BFRRTN' EQ X
               '').BFRGOD                                      @OY19124
         MNOTE 4,'IHB304 INVALID OPERAND BFRRTN, HI ASSUMED'   @OY19124
&BRETURN SETC 'HI'                                             @OY19124
.BFRGOD ANOP                                                   @OY19124
         AIF   (NOT &IEDQRN(1)).BYPTR   BYPASS IF EP ONLY      @PI02856
         AIF   ('&BTRACE' EQ '' AND '&TTRACE' EQ '').TRDEF     @PI02856
         AIF   ('&BTRACE' NE '' AND '&TTRACE' NE '').BTRDEF    @PI02856
         AIF   ('&BTRACE' EQ '').TTRDEF CHECK TTRACE           @PI02856
.BTRDEF  ANOP                                                  @PI02856
         AIF   (T'&BTRACE NE 'N').BADTR     VALID NUMBER       @PI02856
&TR      SETA  &BTRACE                  SET BTRACE VALUE       @PI02856
         AGO   .TRSPSE                                         @PI02856
.TTRDEF  ANOP                                                  @PI02856
         AIF   (T'&TTRACE NE 'N').BADTR     VALID NUMBER       @PI02856
&TR      SETA  &TTRACE                  SET TTRACE VALUE       @PI02856
         AGO   .TRSPSE                                         @PI02856
.TRDEF   ANOP                                                  @PI02856
&TR      SETA  200                      SET DEFAULT            @PI02856
.TRSPSE  ANOP                                                  @PI02856
         AIF   (&TR LT 0 OR &TR GT 65535).BADTR INVALID ENTRY  @PI02856
         AGO   .BYPTR                                          @PI02856
.BADTR   MNOTE 4,'IED900 INVALID BTRACE/TTRACE, 200 ASSUMED'   @PI02856
&TR      SETA  200                      SET DEFAULT            @PI02856
.BYPTR   ANOP                                                  @PI02856
.*       &TR WILL BE USED TO SET NO. OF PIU TRACE ENTRIES IN SAVT
.*                                                             @PI02856
         AIF   (&IEDQZA(52)).SETCOR
         AGO   .NODISK                  SKIP IF TSO ONLY
.SETCOR  ANOP
         AIF   ('&MSUNITS' EQ 'YES').COREYES
         AIF   ('&MSUNITS' EQ 'NO').CORENO
         IEDQMASK &MSUNITS,2
         AIF   (&IEDQZA(24)).CORERR
         AIF   ('&MSUNITS'(1,1) EQ 'X' OR &MSUNITS LT 0).CORERR
         AIF   (&MSUNITS EQ 0).CORENO
&IEDLMS  SETA  &MSUNITS
.SETGBL  ANOP
&IEDQZA(42) SETB 1                      MSUNITS REQUESTED
         AGO   .COROUT
.COREYES ANOP
.CORERR  ANOP                                                  @Z30X8FG
         MNOTE 4,'IHB303 INVALID OPERAND MSUNITS, 1 ASSUMED'
&IEDLMS  SETA  1                        MSUNITS=1 DEFAULT VALUE
         AGO   .SETGBL
.CORENO  ANOP
&IEDLMS  SETA  0                        MSUNITS=0 OR NO
         AIF   ('&DISK' NE 'NO').COROUT
         SPACE
         MNOTE 12,'IHB300 MSUNITS/DISK OPERAND INVALID AS SPECIFIED'
         SPACE 2
.COROUT  ANOP
         AIF   ('&DISK' EQ 'NO').NODISK
         AIF   ('&DISK' EQ 'YES').DODSK
         SPACE
         MNOTE 4,'IHB303  INVALID OPERAND DISK, YES ASSUMED'
         SPACE 2
.DODSK   ANOP
&IEDQZA(41) SETB 1                      DISK=YES
.NODISK  ANOP
         CNOP  0,8 .                    FORCE DOUBLEWORD BOUNDARY
         USING *,15 .                   TEMPORARY BASE
&N       B     &IEDLSKP .               SKIP CONSTANTS
         DC    AL1(3),C'VA0' .          PROGRAM LEVEL AND ID   @Y17XANU
&IEDLDSK SETB  ('&DISK' NE 'NO' AND &IEDQZA(52))
&IEDLSEC SETC  '&SYSECT'                                        OX02212
&IEDLSEC CSECT                                                  OX02212
IEDQAVT  DS    0D
         ENTRY IEDQAVT
IEDSAVE1 DC    18F'0' .                 MESSAGE CONTROL PROG SAVEAREA
IEDSAVE2 DC    14F'0',A(IEDQAVT),3F'0' .DISPATCHER SAVEAREA
&ABDUMP  SETA  0                   INITIALIZE VALUE            @Y17XAB3
         AIF   (T'&ABEFMT EQ 'O').ABEFMTX                      @Y17XAB3
&A       SETA  0                   INITIALIZE INDEX            @Y17XAB3
         AIF   (N'&ABEFMT NE 1 OR '&ABEFMT(1)' NE 'ALL').ABEFMT1
&ABDUMP  SETA  131070                                          @OY18015
&AF(32)  SETB  1                       ALL INCLUDES HIER       @OZ35527
         AGO   .ABEFMTX                                        @OY18015
.ABEFMT1 ANOP                                                  @Y17XAB3
&A       SETA   &A+1               BUMP INDEX                  @Y17XAB3
         AIF   (&AF(2) OR '&ABEFMT(&A)' NE 'AMWA').ABEFMT2     @OY18015
&AF(2)   SETB  1                                               @OY18015
&ABDUMP  SETA  &ABDUMP+2                                       @Y17XAB3
         AGO   .ABEFMTY                                        @Y17XAB3
.ABEFMT2 AIF   (&AF(3) OR '&ABEFMT(&A)' NE 'PEWA').ABEFMT3     @OY18015
&AF(3)   SETB  1                                               @OY18015
&ABDUMP  SETA  &ABDUMP+4                                       @Y17XAB3
         AGO   .ABEFMTY                                        @Y17XAB3
.ABEFMT3 AIF   (&AF(4) OR '&ABEFMT(&A)' NE 'PCB').ABEFMT4      @OY18015
&AF(4)   SETB  1                                               @OY18015
&ABDUMP  SETA  &ABDUMP+8                                       @Y17XAB3
         AGO   .ABEFMTY                                        @Y17XAB3
.ABEFMT4 AIF   (&AF(5) OR '&ABEFMT(&A)' NE 'SIB').ABEFMT5      @OY18015
&AF(5)   SETB  1                                               @OY18015
&ABDUMP  SETA  &ABDUMP+16                                      @Y17XAB3
         AGO   .ABEFMTY                                        @Y17XAB3
.ABEFMT5 AIF   (&AF(6) OR '&ABEFMT(&A)' NE 'RVT').ABEFMT6      @OY18015
&AF(6)   SETB  1                                               @OY18015
&ABDUMP  SETA  &ABDUMP+32                                      @Y17XAB3
         AGO   .ABEFMTY                                        @Y17XAB3
.ABEFMT6 AIF   (&AF(7) OR '&ABEFMT(&A)' NE 'DCT').ABEFMT7      @OY18015
&AF(7)   SETB  1                                               @OY18015
&ABDUMP  SETA  &ABDUMP+64                                      @Y17XAB3
         AGO   .ABEFMTY                                        @Y17XAB3
.ABEFMT7 AIF   (&AF(8) OR '&ABEFMT(&A)' NE 'LGB').ABEFMT8      @OY18015
&AF(8)   SETB  1                                               @OY18015
&ABDUMP  SETA  &ABDUMP+128                                     @Y17XAB3
         AGO   .ABEFMTY                                        @Y17XAB3
.ABEFMT8 AIF   (&AF(9) OR '&ABEFMT(&A)' NE 'DCB').ABEFMT9      @OY18015
&AF(9)   SETB  1                                               @OY18015
&ABDUMP  SETA  &ABDUMP+256                                     @Y17XAB3
         AGO   .ABEFMTY                                        @Y17XAB3
.ABEFMT9 AIF   (&AF(10) OR '&ABEFMT(&A)' NE 'DEB').ABEFMTA     @OY18015
&AF(10)  SETB  1                                               @OY18015
&ABDUMP  SETA  &ABDUMP+512                                     @Y17XAB3
         AGO   .ABEFMTY                                        @Y17XAB3
.ABEFMTA AIF   (&AF(11) OR '&ABEFMT(&A)' NE 'SCB').ABEFMTB     @OY18015
&AF(11)  SETB  1                                               @OY18015
&ABDUMP  SETA  &ABDUMP+1024                                    @Y17XAB3
         AGO   .ABEFMTY                                        @Y17XAB3
.ABEFMTB AIF   (&AF(12) OR '&ABEFMT(&A)' NE 'PLCB').ABEFMTC    @OY18015
&AF(12)  SETB  1                                               @OY18015
&ABDUMP  SETA  &ABDUMP+2048                                    @Y17XAB3
         AGO   .ABEFMTY                                        @Y17XAB3
.ABEFMTC AIF   (&AF(13) OR '&ABEFMT(&A)' NE 'LCB').ABEFMTD     @OY18015
&AF(13)  SETB  1                                               @OY18015
&ABDUMP  SETA  &ABDUMP+4096                                    @Y17XAB3
         AGO   .ABEFMTY                                        @Y17XAB3
.ABEFMTD AIF   (&AF(14) OR '&ABEFMT(&A)' NE 'QCB').ABEFMTE     @OY18015
&AF(14)  SETB  1                                               @OY18015
&ABDUMP  SETA  &ABDUMP+8192                                    @Y17XAB3
         AGO   .ABEFMTY                                        @Y17XAB3
.ABEFMTE AIF   (&AF(15) OR '&ABEFMT(&A)' NE 'OPT').ABEFMTF     @OY18015
&AF(15)  SETB  1                                               @OY18015
&ABDUMP  SETA  &ABDUMP+16384                                   @Y17XAB3
         AGO   .ABEFMTY                                        @Y17XAB3
.ABEFMTF AIF   (&AF(16) OR '&ABEFMT(&A)' NE 'TTE').ABEFMTG     @OY18015
&AF(16)  SETB  1                                               @OY18015
&ABDUMP  SETA  &ABDUMP+32768                                   @Y17XAB3
         AGO   .ABEFMTY                                        @Y17XAB3
.ABEFMTG AIF   (&AF(17) OR '&ABEFMT(&A)' NE 'UCB').ABEFMTH     @OZ35527
&AF(17)  SETB  1                                               @OY18015
&ABDUMP  SETA  &ABDUMP+65536                                   @Y17XAB3
         AGO   .ABEFMTY                                        @OZ35527
.ABEFMTH AIF   (&AF(32) OR '&ABEFMT(&A)' NE 'HIER').ABEFMTY    @OZ35527
&AF(32)  SETB  1                                               @OZ35527
.ABEFMTY AIF   (&A LT N'&ABEFMT).ABEFMT1 LOOP BACK UNTIL DONE  @OZ35527
.ABEFMTX ANOP                                                  @Y17XAB3
IEDSAVE3 DS    18F'0'                   SUBTASK'S SAVEAREA     @YM07738
IEDSAVE4 DC    18F'0' .                 1ST LEVEL SUBROUTINE SAVEAREA
         DC    8F'0' .                  DISABLED SAVEAREA
         AIF   (K'&PROGID LT 8).SETEQU  PROGID LESS THAN 8 CHAR@Y17XANU
&IEDQSV1(5) SETC '&PROGID'(1,8)         SET PROGID             @Y17XANU
         AGO   .PROGSET                 CONTINUE PROCESSING    @Y17XANU
.SETEQU  ANOP                                                  @Y17XANU
&IEDQSV1(5) SETC '&PROGID'              SET PROGID             @Y17XANU
.PROGSET ANOP                                                  @Y17XANU
         AIF   ('&DLQ' EQ '').NODLQ
         AIF   ('&DLQ'(1,1) EQ '0' AND K'&DLQ EQ 1).NODLQ
         AIF   (K'&DLQ GT 8).BADDLQ
         DC    CL8'&DLQ' .              DLQ=TERMNAME
         AGO   .SKIPDLQ
.BADDLQ  SPACE
         MNOTE 12,'IHB304 DLQ SPECIFIED TOO MANY CHARACTERS'
         SPACE 2
.NODLQ   DC    2F'0' .                  DLQ=TERMNAME NOT SPECIFIED
.SKIPDLQ ANOP
         DC    A(IEDQSTCS,0) .
         AIF   ('&PRIMARY' EQ 'SYSCON' OR '&PRIMARY' EQ '').NOPRI
         AIF   ('&PRIMARY'(1,1) EQ '0' AND K'&PRIMARY EQ 1).NOPRI
         AIF   (K'&PRIMARY GT 8).BADMARY
         DC    CL8'&PRIMARY' .          PRIMARY=TERMNAME
         AGO   .SKIPRI
.BADMARY SPACE
         MNOTE 12,'IHB304 PRIMARY SPECIFIED TOO MANY CHARACTERS'
         SPACE 2
.NOPRI   DC    8X'00' .                 PRIMARY=SYSCON
.SKIPRI  ANOP
IEDDOUBL DC    2F'0' .
         AIF   ('&CONTROL' EQ '').NOTROL
         AIF   ('&CONTROL'(1,1) EQ '0' AND K'&CONTROL EQ 1).NOTROL
         AIF   (K'&CONTROL GT 8).BADTROL
         DC    CL8'&CONTROL' .          CONTROL=CHARS SPECIFIED
         AGO   .SKIPTRL
.BADTROL SPACE
         MNOTE 12,'IHB304 CONTROL SPECIFIED TOO MANY CHARACTERS'
         SPACE 2
.NOTROL  DC    8X'FF' .                 CONTROL=CHARS OMITTED
.SKIPTRL AIF   ('&PASSWRD' EQ '').NOPASS
         AIF   ('&PASSWRD'(1,1) EQ '0' AND K'&PASSWRD EQ 1).NOPASS
         AIF   (K'&PASSWRD GT 8).BADPAS
         DC    CL8'&PASSWRD' .          PASSWRD=CHARS SPECIFIED
         AGO   .SKIPASS
.BADPAS  SPACE
         MNOTE 12,'IHB304 PASSWRD SPECIFIED TOO MANY CHARACTERS'
         SPACE 2
.NOPASS  DC    CL8' ' .                 PASSWRD=CHARS OMITTED
.SKIPASS ANOP
         DC    A(0) .                   ADDR OF MESSAGE CONTROL TCB
         IEDQMASK &TRACE(1),2                                  @Y17XANA
         AIF   (&IEDQZA(24)).BADTRA
         AIF   ('&TRACE'(1,1) EQ 'X' OR &TRACE(1) LT 0).BADTRA @Y17XANA
         AIF   (&TRACE(1) GT 0 AND &TRACE(1) LT 20).BADTRA     @Y17XANA
&TRACEN  SETA  &TRACE(1)         TRACE TABLE ENTRIES           @Y17XANA
         AGO   .SKPTRA
.BADTRA  SPACE
         MNOTE  4,'IHB303 INVALID OPERAND TRACE, 20 ASSUMED'   @Z30X8FJ
         SPACE 2
&TRACEN  SETA  20                       TRACE=20  MIN VALUE    @Y17XANA
.SKPTRA  ANOP
&IEDLTRA SETA  &TRACEN           SAVE TRACE OPERAND FOR TREXIT @Y17XANA
IEDRACE  DC    F'&TRACEN' .             TRACE=INTEGER          @Y17XANA
IEDREADY DC    A(IEDDELEM) .            ADDRESS OF FIRST OF CHAIN
*                                         OF ELEMENTS,PRIORITY ORDER
         AIF   ('&BUFFTR' EQ '').BUFDEF SET DEFAULT            @OY19405
         AIF   (T'&BUFFTR(1) NE 'N').BADBUF INVALID ENTRY      @OY19405
&BUFF    SETA  &BUFFTR(1)               SET UP SPECIFIED VAL   @OY19405
         AIF   (&BUFF LT 0).BADBUF               INVALID ENTRY @OY19405
         AIF   (&BUFF GT 200).SETNO     ENTRY OK WITH COMWRITE @OY19405
         AGO   .BUFFAOK                                        @OY19405
.SETNO   ANOP                                                  @OY19405
&BUFF    SETA  200                      SET TO 200             @OY19405
         MNOTE 4,'IED303 INVALID OPERAND BUFFTR, 200 ASSUMED'  @OY19405
.BUFFAOK ANOP                                                  @OY19405
         AIF   (N'&BUFFTR LT 2).BUFFOK  NO MORE PARAMETERS     @OY19405
         AIF   ('&BUFFTR(2)' EQ 'PAR').CKCON CHECK NEXT PARM   @OY19405
         AIF   ('&BUFFTR(2)' EQ 'FULL').SETFU SET FULL TRACE   @OY19405
         MNOTE 4,'IED303 INVALID OPERAND BUFFTR, PAR ASSUMED'  @OY19405
         AGO   .CKCON                   CHECK C OPERAND        @OY19405
.SETFU   ANOP                                                  @OY19405
&BUFF    SETA  &BUFF+16777216           SET FLAG FOR FULL BUFF @OY19405
.CKCON   ANOP                                                  @OY19405
         AIF   (N'&BUFFTR LT 3).BUFFOK  NO MORE PARAMETERS     @OY19405
         AIF   ('&BUFFTR(3)' NE 'U').SETCON TAKE DEFAULT       @OY19405
&BUFF    SETA  &BUFF+33554432           SET FLAG FOR UNCOND TR @OY19405
         AGO   .BUFFOK                                         @OY19405
.SETCON  ANOP                                                  @OY19405
         AIF   ('&BUFFTR(3)' EQ 'C').BUFFOK                    @OY19405
         MNOTE 4,'IED303 INVALID OPERAND BUFFTR, C ASSUMED'    @OY19405
         AGO   .BUFFOK                  CONTINUE               @OY19405
.BADBUF  MNOTE 4,'IED303 INVALID OPERAND BUFFTR, 0 ASSUMED'    @OY19405
.BUFDEF  ANOP                                                  @OY19405
&BUFF    SETA 0                         DEFAULT VALUE          @OY19405
.BUFFOK  ANOP                                                  @OY19405
IEDREADD DC    A(0)                     ADD. OF BUFF TRAC TAB  @OY19405
         DC    F'&BUFF' .               NO. ENTRIES ON  INTRO  @OY19405
IEDCKGET DC    A(0) .                   CHECKPOINT WORKAREA-GETMAIN
IEDOCGET DC    A(0) .                   OPERATOR CONTROL WORKAREA
&IEDLSCB SETA  84 .                     SIZE OF SCB WITHOUT SAVEAREA
         IEDQMASK &USEREG,1
         AIF   (&IEDQZA(24)).ERREG
         AIF   (&USEREG EQ 0).ZEREG
         AIF   ('&USEREG'(1,1) EQ 'X' OR &USEREG GT 10).ERREG
&IEDQZF  SETA  &USEREG
         MVC   &IEDLSCB.(4*&IEDQZF,3),28(13) USEREG=INTEGER
         MVC   28(4*&IEDQZF,13),&IEDLSCB.(3)
.* &IEDQZF IS GLOBAL, NUMBER WORDS TO BE ADDED TO SCB FOR SAVEAREA
         AGO   .SKIPREG
.ZEREG   ANOP
&IEDQZF  SETA  0                        ASSUME 0 DEFAULT VALUE
         NOPR  0 .                      USEREG=0
         DC    4X'00' .
         NOPR  0 .
         DC    4X'00' .
         AGO   .SKIPREG
.ERREG   SPACE
         MNOTE 4,'IHB303  INVALID OPERAND USEREG, 0 ASSUMED'
         SPACE 2
         AGO   .ZEREG
.SKIPREG ANOP
&IEDLSCB SETA  &IEDLSCB+4*&IEDQZF
IEDPARM  DC    A(0,IEDQAVT,0) .         PARAMETER LIST
         IEDQMASK &DTRACE(1),2                                 @Y17XANA
         AIF   (&IEDQZA(24)).DTRERR
         AIF   ('&DTRACE'(1,1) EQ 'X' OR &DTRACE(1) LT 0).DTRERR
&DTRACEN SETA  &DTRACE(1)                     DTRACE=INTEGER   @Y17XANA
         AGO   .DTROUT
.DTRERR  SPACE
         MNOTE 4,'IHB303  INVALID OPERAND DTRACE, 0 ASSUMED'
         SPACE 2
&DTRACEN SETA  0                        DTRACE=0 DEFAULT VALUE @Y17XANA
.DTROUT  ANOP
IEDDISTR DC    F'&DTRACEN' .            DTRACE=INTEGER         @Y17XANA
IEDRNMPT DC    A(IEDQTNT) .             TERMNAME TABLE POINTER
         DC    A(IEDQRDYA) .            USER EXIT ADDRESS IN READY
         DC    A(0) .                   LINE END BSC MSG SCAN
         DC    A(IEDDUMBR) .            LINE TRACE TABLE UPDATE
         DC    V(IEDQSBT)               OP CTL SET BIT ROUTINE @YM07020
         AIF (&IEDQRN(1) OR &OLTEST NE 0).MVBFR                @Y17XAXF
         DC    A(0)                     RESERVED               @YM07020
         AGO   .SPARM                                          @Y17XAXF
.MVBFR   DC    V(IEDMVBFR) .                                   @Y17XAXF
.SPARM   ANOP .                                                @Y17XAXF
IEDSPLPT DC    A(0) .                   START PARAMETER LIST POINTER
         IEDQMASK &CIB,1
         AIF   (&IEDQZA(24)).CIBERR
         AIF   ('&CIB'(1,1) EQ 'X').CIBERR
         AIF   ('&CIB' EQ '0').CIBERR                            S21903
         DC    AL1(&CIB) .              CIB=INTEGER
         AGO   .CIBOUT
.CIBERR  SPACE
         MNOTE 4,'IHB303  INVALID OPERAND CIB, 2 ASSUMED'
         SPACE 2
         DC    AL1(2) .                 CIB=2 DEFAULT VALUE
.CIBOUT  ANOP
         IEDQMASK &CKREQS,1
         AIF   (&IEDQZA(24)).BADREQ
         AIF   ('&CKREQS'(1,1) EQ 'X' OR &CKREQS LT 0).BADREQ
         DC    AL1(&CKREQS) .           CKREQS=INTEGER
         AGO   .SKPREQ
.BADREQ  SPACE
         MNOTE 4,'IHB303  INVALID OPERAND CKREQS, 0 ASSUMED'
         SPACE 2
         DC    AL1(0) .                 CKREQS=0 DEFAULT VALUE
.SKPREQ  ANOP
         IEDQMASK &LNUNITS,2
         AIF   (&IEDQZA(24)).LINERR
         AIF   ('&LNUNITS'(1,1) EQ 'X' OR &LNUNITS LT 0).LINERR
         DC    AL2(&LNUNITS) .          LNUNITS=INTEGER
         AGO   .LINOUT
.LINERR  SPACE
         MNOTE 4,'IHB303  INVALID OPERAND LNUNITS, 0 ASSUMED'
         SPACE 2
         DC    AL2(0) .                 LNUNITS=0 DEFAULT VALUE
.LINOUT  ANOP
IEDAS    DC    A(0) .                   RELEASE
         DC    4F'0' .                  TCB ADDRS OF ATTACHED TASKS
         DC    X'40',AL3(0) .           COMMON WRITE FE TASK ECB
         DC    3F'0' .                  EVENT CONTROL BLOCKS
IEDOSECB DC    F'0' .                   DISPATCHER'S ECB
IEDPCBPT DC    A(0) .                   FIRST PROCESS CONTROL BLOCK
IEDOPTPT DC    F'0' .                   ORGED BY OPTION,OPTION TAB ADDR
         AIF   (NOT &IEDQRN(2)).IOGEN                            S22024
IEDKA02  DC    A(0)                                              S22024
         AGO   .SKIOGN                                           S22024
.IOGEN   ANOP                                                    S22024
IEDKA02  DC    V(IEDQKA02) .            I/O GENERATOR
.SKIOGN  ANOP                                                    S22024
&C       SETA  0                                                SA65392
.THRESH1 ANOP                                                   SA65392
&C       SETA  &C+1                                             SA65392
         AIF   (T'&THRESH(&C) NE 'N').THRESH2                   SA65392
         AIF   (&THRESH(&C) GT 0 AND &THRESH(&C) LT 256).THRESH3
.THRESH2 MNOTE 12,'*** IHB002 INVALID THRESH OPERAND SPECIFIED - &THRESC
               H(&C)'                                           SA65392
         AGO   .THRESH6                                         SA65392
.THRESH3 AIF   (&C NE 4).THRESH1                                SA65392
&C       SETA  &THRESH(1)                                       SA65392
&D       SETA  &THRESH(2)                                       SA65392
&E       SETA  &THRESH(3)                                       SA65392
&F       SETA  &THRESH(4)                                       SA65392
         AIF   (&D LE &C).THRESH4                               SA65392
&D       SETA  &C                                               SA65392
.THRESH4 AIF   (&E LE &C).THRESH5                               SA65392
&E       SETA  &C                                               SA65392
.THRESH5 AIF   (&F LE &C).THRESH6                               SA65392
&F       SETA  &C                                               SA65392
.THRESH6 ANOP                                                   SA65392
         DC    AL1(&C),AL1(&D),AL1(&E),AL1(&F)                  SA65392
.SKIPTR  ANOP
         IEDQMASK &CROSSRF,2
         AIF   (&IEDQZA(24)).CROSSER
         AIF   ('&CROSSRF'(1,1) EQ 'X').CROSSER
IEDCRSRF DC    F'&CROSSRF' .            CROSSRF=INTEGER
         AGO   .CROSSOT
.CROSSER SPACE
         MNOTE 4,'IHB303  INVALID OPERAND CROSSRF, 0 ASSUMED'
         SPACE 2
IEDCRSRF DC    F'0' .                   CROSSRF=0 DEFAULT VALUE
.CROSSOT ANOP
         DC    A(0) .                   ADDR OF COMMUNICATIONS PARM
IEDUI    DC    V(IEDQUI) .              USER INTERFACE ROUTINE   S22025
         DC    A(0) .                   UNASSIGNED               Y01004
         IEDQMASK &OLTEST,1
         AIF   (&IEDQZA(24)).EROLT
         AIF   ('&OLTEST'(1,1) EQ 'X' OR &OLTEST LT 0).EROLT
         AIF   (&OLTEST LT 56 AND &OLTEST GT 0).EROLT          @Y17XAXU
         DC    AL1(&OLTEST) .           OLTEST=INTEGER
         AGO   .SKPOLT
.EROLT   SPACE
         MNOTE 4,'IHB303  INVALID OPERAND OLTEST,56 ASSUMED'   @Y17XAUU
         SPACE 2
         DC    AL1(56)                  OLTEST=56 DEFAULT      @Y17XAUU
.SKPOLT  ANOP
         DC    VL3(IEDQHG02) .          REMOVE TIME DELAY ELEMENT
IEDAL    DC    V(IEDQAL) .              ADDRESS COMPUTATION
IEDGD    DC    V(IEDQGD) .              BUFFER ASSOCIATION     @G36XRXF
IEDA3    DC    A(0) .                   TRANSPARENCY CCW BUILDER (GT)
IEDAX    DC    V(IEDQAX) .              SCAN
IEDEA    DC    A(0) .                   DISPATCHER
IEDDISP  EQU   *
         DC    A(0) IGG019R3            RECEIVE SCHEDULER
&A       SETA  0                                               @YM08551
         AIF   ('&COMMBUF' EQ '').NCMBUF                         S22027
         AIF   (N'&COMMBUF EQ 3).CMBFOK                          S22027
.CMBERR  ANOP                                                  @Z30X8FG
         MNOTE 12,'IHB300 COMMBUF OPERAND INVALID AS SPECIFIED'
.*                                                             @Z30X8FG
&IEDQZA(44) SETB 0                                               S22027
         AGO   .NCMBUF                                           S22027
.CMBFOK  ANOP                                                    S22027
&IEDQZA(44) SETB 1                                               S22027
         AIF   (K'&COMMBUF(1) GT 8 OR K'&COMMBUF(2) GT 8 OR K'&COMMBUF(X
               3) GT 8).CMBERR                                   S22027
.LOOP    ANOP                                                    S22027
         AIF   (&A EQ 3).CKCMBUF                                 S22027
&A       SETA  &A+1                                              S22027
&IEDCBUF(&A) SETC '&COMMBUF(&A)'                                 S22027
         IEDQMASK &IEDCBUF(&A),2                                 S22027
         AIF   (NOT &IEDQZA(24)).LOOP                            S22027
         MNOTE 12,'IHB300 COMMBUF OPERAND INVALID AS SPECIFIED'
.*                                                             @Z30X8FG
&IEDQZA(44) SETB 0                                               S22027
         AIF   (&A LT 3).LOOP                                    S22027
.CKCMBUF AIF   (NOT &IEDQZA(44)).NCMBUF                          S22027
         AIF   (&COMMBUF(1) EQ 0 OR &COMMBUF(2) EQ 0 OR &COMMBUF(3) EQ X
               0).NCMBUF1                                        S22027
&A       SETA  &IEDCBUF(3)                                       S22027
&B       SETA  &A/4                                              S22027
&B       SETA  &B*4                                              S22027
         AIF   (&B NE &A).NCMBUF1                                S22027
&IEDLSB(13) SETB 1                                               S22027
         AGO   .NCMBUF                                           S22027
.NCMBUF1 ANOP                                                    S22027
&IEDQZA(44) SETB 0                                               S22027
         MNOTE 12,'IHB300 COMMBUF OPERAND INVALID AS SPECIFIED'
.*                                                             @Z30X8FG
.NCMBUF  ANOP                                                    S22027
         AIF   ('&APDUMP' EQ 'YES').APDMP                      @ZA07083
         AIF   ('&APDUMP' EQ 'NO').NODMP                       @ZA07083
         MNOTE 4,'IHB303 INVALID OPERAND APDUMP,NO ASSUMED'    @ZA07083
         AGO   .NODMP                                          @ZA07083
.APDMP   ANOP                                                  @ZA07083
&IEDLSB(17) SETB 1                                             @ZA07083
.NODMP   ANOP                                                  @ZA07083
         DC    B'00&IEDLSB(17)&IEDLSB(13)&IEDLSB(11)&IEDLSB(12)&IEDLSB(X
               9)&IEDLSB(8)' .                                 @ZA07083
         AIF   (&IEDLSB(8)).XXDIAL
*                                         DIAL
         AGO   .XXSKDI
.XXDIAL  ANOP
*                                         NODIAL
.XXSKDI  AIF   (&IEDLSB(9)).XX27
*                                         2741
         AGO   .XXSK27
.XX27    ANOP
*                                         NO2741
.XXSK27  AIF   (&IEDLSB(10)).XXTI
*                                         TIMER
         AGO   .XXSKTI
.XXTI    ANOP
*                                         NOTIMER
.XXSKTI  ANOP
         AIF   (&IEDLSB(11) OR &IEDLSB(12)).XXCONC               S22026
*                                         NOCONC                 S22026
         AGO   .XXCONCX                                          S22026
.XXCONC  AIF   (&IEDLSB(11)).XXCONCM                             S22026
*                                         CONCO (OVERIDES DIAL   S22026
*                                         AND 2741 IF SPECIFIED) S22026
         AGO   .XXCONCX                                          S22026
.XXCONCM ANOP                                                    S22026
*                                         CONC                   S22026
.XXCONCX ANOP                                                    S22026
         AIF   (NOT &IEDQZA(44)).NOCBCMT                         S22027
*                                  COMMBUF KEYWORD SPECIFIED     S22027
.NOCBCMT ANOP                                                    S22027
         DC    AL3(0) .                 SEND SCHEDULER
*                     IGG019R4          HAS TSO,DIAL,2741 SUPPORT
*                     IGG019Q6          NO TSO, NO DIAL, NO 2741 S21903
*                     IGG019Q7          NO TSO, NO 2741, BUT HAS DIAL
*                                       NONE OF ABOVE IF CONC    S22026
*                                         ONLY (CONCO) SPECIFIED S22026
.*
         DS    0A .                     AFTER OPEN, GET SCHED  @G36XRFF
         AIF   ('&APWAS' EQ '184' OR '&APWAS' EQ '440' OR '&APWAS' EQ  *
               '952' OR '&APWAS' EQ '1976' OR '&APWAS' EQ '4024' OR    *
               ('&APWAS' GE '4025' AND '&APWAS' LE '32695')).GDAPWA
*                                                              @OZ24197
         MNOTE 4,'IHB303 INVALID OPERAND APWAS, 4024 ASSUMED'  @G36XRFF
         SPACE 2                                               @G36XRFF
         DC    AL2(4024) .              APWAS=4024 DEFAULT VAL @G36XRFF
         AGO   .SKPAPWA                                        @G36XRFF
.GDAPWA  ANOP                                                  @G36XRFF
         DC    AL2(&APWAS) .            APPLICATION PROGRAM    @G36XRFF
.*                                      WORKAREA SIZE          @G36XRFF
.SKPAPWA ANOP                                                  @G36XRFF
         AIF   ('&AUTHA' EQ 'NO').NOAUTH                       @G36XRFF
         AIF   ('&AUTHA' EQ 'YES').YESAUTH                     @G36XRFF
         SPACE
         MNOTE 4,'IHB303 INVALID OPERAND AUTHA, YES ASSUMED'   @G36XRFF
         SPACE
.YESAUTH DC   X'8000'  .               AUTHORIZED APP. PROGRAMS@G36XRFF
         AGO   .SKPAUTH                                        @G36XRFF
.NOAUTH  DC    AL2(0) .                 UNAUTHORIZED APP. PGM  @G36XRFF
.SKPAUTH ANOP                                                  @G36XRFF
         DC    A(0) .                   PUT SCHEDULER
         DC    A(0) .                   RESERVED                 Y02027
IEDBZ    DC    A(0) .                   LOG SCHEDULER
IEDR1    DC    A(0) .                   DIAL SCHEDULER
IEDHB    DC    A(0) .                   BUFFERED SCHEDULER
         DC    A(0) .                   RETRIEVE SCHEDULER
         DC    A(0) .                   LOCAL SCHEDULER
IEDCSCH  DC    A(0) .                   CONC SEND SCHEDULER      S22026
         AIF   (&IEDQRN(1)).GENSCHD .   GENERATE SCHD ADDRESS    X03039
         DC    A(0) .                                            X03039
         DC    A(0) .                                            X03039
         AGO   .NOSCHD .                DONT GEN SCHD ADDRESSES  X03039
.GENSCHD ANOP
         DC    V(IEDIAQ) .              3705 RESOURCES SEND    @Y17XANU
*                                       SCHEDULER              @Y17XANU
         DC    V(IEDIAM) .              3705 RESOURCES RECEIVE @Y17XANU
*                                       SCHEDULER              @Y17XANU
.NOSCHD  ANOP
         AIF   (NOT &IEDQZA(44)).XXCMBF                          S22027
IEDCMBSS DC    H'0' .                   COMMBUF SEND SCHEDULER   S22027
*                                       AFTER OPEN               S22027
&A       SETA  &IEDCBUF(3)                                       S22027
         DC    AL2(&A) .                SIZE OF CB DATA AREA     S22027
         AGO   .XXCMBF1                                          S22027
.XXCMBF  ANOP                                                    S22027
IEDCMBSS DC    A(0) .                   COMMBUF SEND SCHEDULER   S22027
.XXCMBF1 ANOP                                                    S22027
         DC    A(0) .                                            S22024
         DC    B'&IEDQRN(1).&IEDQRN(3).&IEDQRN(4).00000' . SAVT@YM07790
*                                                        FLAGS @YM07790
         DC    AL3(IEDNSAVT)
&IEDLSEC SETC  '&SYSECT'                                         S22024
IEDNSAVT CSECT .                                                S22024
         AIF   ('&VM' EQ 'NO').NOVM                              Y05331
         AIF   ('&VM' EQ 'YES').YESVM                            Y05331
         AIF   ('&VM' EQ 'PROMPT').MAYBVM                        Y05331
         SPACE
         MNOTE 4,'IHB303 INVALID OPERAND VM, NO ASSUMED'
         SPACE 2
.NOVM    ANOP                                                    Y05331
&IEDLSB(15) SETB 0                                               Y05331
&IEDLSB(16) SETB 0                                               Y05331
         AGO   .ENDVM                                            Y05331
.YESVM   ANOP                                                    Y05331
&IEDLSB(15) SETB 1                                               Y05331
&IEDLSB(16) SETB 0                                               Y05331
         AGO   .ENDVM                                            Y05331
.MAYBVM  ANOP                                                    Y05331
&IEDLSB(15) SETB 0                                               Y05331
&IEDLSB(16) SETB 1                                               Y05331
.ENDVM   ANOP                                                    Y05331
         DC    B'&IEDLSB(15).&IEDLSB(16).000000' .               Y05331
         DC    AL3(0) .                 VIRTUAL DIAGNOSE ROUTINE Y05331
         AIF   (NOT &IEDQRN(1)).SKP3705                          Y05331
         DC    A(0) .                   PLCB POOL ADDRESS        X03039
         DC    A(0) .                   NEXT FREE PLCB           X03039
         DC    H'0' .                   PLCB IN-USE COUNT      @Y17XANU
         DC    H'0' .                   PLCB HI WATER COUNT    @Y17XANU
         DC    V(IEDIAP01) .            ADDRESS OF PLCB        @Y17XANU
*                                       ALLOCATION ROUTINE     @Y17XANU
         DC    A(0) .                   ANCHOR FOR PLCB        @Y17XANU
*                                       REQUEST WAIT CHAIN     @Y17XANU
         DC    H'0' .                   PLCB WAIT COUNT        @Y17XANU
         DC    H'0' .                   PLCB HI WATER WAIT CNT @Y17XANU
         DC    V(IEDIAP7S) .            ADDRESS OF STCB FOR    @Y17XANU
*                                       PLCB DEALLOCATION      @Y17XANU
         DC    V(IEDIAP07) .            BRANCH ENTRY ADDRESS   @Y17XANU
*                                       OF PLCB DEALLOCTION    @Y17XANU
*                                       ROUTINE                @Y17XANU
         DC    A(0) .                   NEXT FREE SIB ADDRESS  @Y17XANU
         DC    H'0' .                   SIB IN USE COUNT       @Y17XANU
         DC    H'0' .                   COUNT OF SIB REQUESTS  @Y17XANU
*                                       THAT FAILED            @Y17XANU
         DC    V(IEDIAP02) .            ADDRESS OF SIB         @Y17XANU
*                                       ALLOCATION ROUTINE     @Y17XANU
         DC    V(IEDIAP08) .            ADDRESS OF SIB         @Y17XANU
*                                       DEALLOCATION ROUTINE   @Y17XANU
         DC    A(0) .                   3705 FLDH QCB          @Y17XANU
         DC    V(IEDNKA) .              CONTROL NIR GENR QCB   @Y17XANU
*                                       ADDRESS                @Y17XANU
         DC    V(IEDNGD) .              DATA NIR GENR QCB ADDR @Y17XANU
         DC    A(0) .                   3705 TRACE ROUTINE     @Y17XANU
*                                       ADDRESS                @Y17XANU
         DC    F'&TR' .                 ADDRESS OF PIU TRACE   @Y17XANU
*                                       TABLE                  @Y17XANU
         DC    V(IEDNCU) .              3705 CLEANUP ROUTINE   @YM06020
*                                       ADDRESS                @Y17XANU
         DC    A(0) .                   NAT ADDRESS            @Y17XANU
         DC    A(0) .                   SAT ADDRESS            @Y17XANU
         DC    A(0) .                   MODE BYTE TABLE        @Y17XANU
*                                       ADDRESS                @Y17XANU
IEDLUQCB DC    A(0),A(0),V(IEDLUS) .    LUS QCB                @Y17XAXF
         ENTRY IEDLUQCB                                        @Y17XAXF
         DC    A(0) .                   OPERATOR SERVICES      @Y17XANU
*                                       REQUEST CHAIN          @Y17XANU
         DC    A(0) .                   SSCP LCB               @Y17XANU
         DC    A(0),A(0),V(IEDSCPSS) .  SSCP QCB               @Y17XANU
         DC    V(IEDXFMO) .             OUTBOUND               @YM03681
*                                       XFORMER QCB ADDRESS    @YM03681
         DC    2F'0' .                  RESERVED               @YM03681
         DC    V(IEDXFMI) .             INBOUND                @YM03681
*                                       XFORMER ENTRY ADDRESS  @YM03681
         DC    2F'0' .                  RESERVED               @YM03681
         DC    V(IEDPCIN) .             PATH CONTROL           @YM03681
*                                       INBOUND QCB ADDRESS    @YM03681
         DC    2F'0' .                  RESERVED               @YM03681
         DC    A(0) .                   REQ BUILDER RTN        @YM08099
         DC    V(IEDMVBFR) .            MOVE DATA RTN          @Y17XANU
         DC    V(IEDXTREQ) .            CROSS TASK REQ HDLR    @Y17XANU
         DC    V(IEDSCLU) .             SC ENTRY ADDRESS       @Y17XANU
         DC    V(IEDSCPRQ) .            SSCP REQ HDLR ADDRESS  @Y17XANU
         DC    V(IEDSCPRP) .            SSCP RESP HDLR ADDRESS @Y17XANU
         DC    V(IEDCSCIN) .            FID1 COM SC INBOUND    @Y17XANU
         AIF   (&IEDQRN(3)).NOSAI       DEFINE VCON FOR SAI    @YM07790
         DC    V(IEDSAI) .              FID0 SA INBOUND        @Y17XANU
         DC    V(IEDSAC) .              COMMAND PROCESSOR      @Y17XANU
         DC    V(IEDSARI) .             COMMAND PROCESSOR      @Y17XANU
         AGO   .ENDSAI
.NOSAI   ANOP
         DC    A(0) .                   FID0 SA INBOUND        @Y17XANU
         DC    A(0) .                   COMMAND PROCESSOR      @Y17XANU
         DC    A(0) .                   COMMAND PROCESSOR      @Y17XANU
.ENDSAI  ANOP
         DC    V(IEDSAO) .              COMMAND ID PROC        @Y17XANU
         DC    V(IEDDFOUT) .            DFC OUTBOUND           @Y17XANU
         DC    V(IEDRQIN) .             INBOUND REQ PROCESSOR  @Y17XANU
         DC    V(IEDQRS) .              RESPONSE GENERATOR     @Y17XANU
*                                       ADDRESS                @Y17XANU
         DC    A(IEDSCPMH)              SSCP MH ADDRESS        @YM03679
         DC    A(IEDQMHTB) .            MH TABLE ADDRESS       @YM04651
         DC    H'0' .                   INDEX OF LAST NAT ENTR @Y17XANU
         DC    H'0' .                   CONSTANT TO CALCULATE  @Y17XANU
*                                       NAT ENTRY FROM MH INDX @Y17XANU
         DC    V(IEDNSL) .              3705 STOPLINE          @YM04612
*                                       QCB ADDRESS            @Y17XANU
         DC    A(0) .                   MANUAL DIAL ROUTINE    @Y17XANU
*                                       ADDRESS                @Y17XANU
         DC    A(0) .                   APPL REQUEST QUEUE     @Y17XANU
         DC    H'0' .                   APPL REQUEST TAG       @Y17XANU
         DC    H'0' .                   SSCP TTCIN             @Y17XANU
*                                       /TCAM PU TTCIN         @Y17XANU
         AIF   ('&BRACKET' EQ 'YES').BRKTYES  BRACKET=YES      @Y17XANU
         AIF   ('&BRACKET' EQ 'NO').BRKTNO    BRACKET=NO       @Y17XANU
         SPACE 1                                               @Y17XANU
         MNOTE 4,'IHB303 INVALID OPERAND BRACKET, NO ASSUMED'  @Y17XANU
         SPACE 1                                               @Y17XANU
.BRKTNO  ANOP                                                  @Y17XANU
         DC    F'0' .                   BRACKET STATE MANAGER  @Y17XANU
*                                       ADDR(ZERO=NO LOADED)   @Y17XANU
         AGO   .BRKTSKP                                        @Y17XANU
.BRKTYES ANOP                                                  @Y17XANU
.*             ANY NON ZERO VALUE IN THIS DC WILL CAUSE IEDQOA @Y17XANU
.*             TO LOAD THE  RACKET STATE MANAGER MODULE AND    @Y17XANU
.*             PUT ITS ADDRESS HERE                            @Y17XANU
         DC    F'1' .                   BRACKET STATE MANAGER  @Y17XANU
*                                       ADDR(ZERO=NOT LOADED   @Y17XANU
.BRKTSKP ANOP                                                  @Y17XANU
         AIF   (T'&SIBCNT NE 'N').BADSIB  SIB COUNT INVALID    @Y17XANU
         AIF   (&SIBCNT LT 0 OR &SIBCNT GT 65535).BADSIB       @Y17XANU
         DC    H'&SIBCNT' .             NUMBER OF SIBS         @Y17XANU
         AGO   .SIBCOK                                         @Y17XANU
.BADSIB  ANOP
         MNOTE 4,'IHB303 INVALID OPERAND SIBCNT, DEFAULT ASSUMED'
.*                                                             @OZ53057
IEDSSIBC DC    AL2(0) .                 SIB COUNT              @OZ53057
.SIBCOK  ANOP                                                  @Y17XANU
         AIF   (T'&MAXSUBA NE 'N').BDSMAX MAXSUBA BAD          @Y17XANU
         AIF   (&MAXSUBA LT 1 OR &MAXSUBA GT 255).BDSMAX       @Y17XANU
         DC    AL1(&MAXSUBA) .          MAX SUBAREA VALUE      @Y17XANU
         AGO   .MAXOK                                          @Y17XANU
.BDSMAX  ANOP                                                  @Y17XANU
         MNOTE 4,'IHB303 INVALID OPERAND MAXSUBA, 0 ASSUMED'   @Y17XANU
         DC    XL1'0' .                 MAXSUBAREA VALUE       @Y17XANU
.MAXOK   ANOP                                                  @Y17XANU
         AIF   (T'&SUBAREA NE 'N').BADSUBV  SUBAREA VALUE BAD  @Y17XANU
         AIF   (&SUBAREA LT 1 OR &SUBAREA GT 255).BADSUBV      @Y17XANU
         DC    AL1(&SUBAREA) .          SUBAREA VALUE          @Y17XANU
         AGO   .SUBVOK                                         @Y17XANU
.BADSUBV ANOP                                                  @Y17XANU
         MNOTE 4,'IHB303 INVALID OPERAND SUBAREA, 0 ASSUMED'   @Y17XANU
         DC    XL1'0' .                 SUBAREA VALUE          @Y17XANU
.SUBVOK  ANOP                                                  @Y17XANU
         DC    V(IEDIAP03) .            NETWORK ADDR TO TTCIN  @Y17XANU
*                                       CONVERSION RTN ADDRESS @Y17XANU
         DC    V(IEDIAP04) .            TTCIN TO NETWORK ADDR  @Y17XANU
*                                       CONVERSION RTN ADDRESS @Y17XANU
         DC    V(IEDIAP05) .            INDEX TO TTE/MH ENTRY  @Y17XANU
*                                       CONVERSION RTN ADDRESS @Y17XANU
         DC    V(IEDIAP06) .            SA LCB FETCH ROUTINE   @Y17XANU
         DC    H'0' .                   SIB POOL UTIL. HI-WATER
*                                       COUNT                  @Y17XANU
         DC    H'0' .                   TNT INDEX OF FIRST     @Y17XANU
*                                       NAT ENTRY              @Y17XANU
         DC    H'0' .                   TTCIN OF FIRST MH      @Y17XANU
*                                       ENTRY                  @Y17XANU
         DS    0H .                     NETWORK ADDR SA MASK   @Y17XANU
         DC    XL1'0' .                 SUBAREA MASK           @Y17XANU
         DC    XL1'0' .                 BYTE OF ZEROS          @Y17XANU
         DC    XL1'0' .                 SUBAREA VALUE LENGTH   @Y17XANU
         DC    XL1'0' .                 RESERVED               @YM02919
         DC    H'0' .                  (PLCB,SAT,SIB,RVT, AND  @YM02919
*                                       NAT POOL SIZE)/8       @YM02919
         DC    V(IEDDVAS) .             DEV ASSOCIATION RTN    @Y17XANU
IEDID    DC    A(0) . IEDNID            BSC ID VERFICATION RTN @YM05633
         DS    0F .                     ACT/DEACT REDRIVE ELEM @YM03726
         DC    X'00' .                  KEY FIELD              @YM03697
         DC    AL3(IEDOPCOB) .          QCB ADDRESS FIELD      @YM03697
         DC    X'00' .                  PRIORITY FIELD         @YM03697
         DC    XL7'00' .                RESERVED               @YM03697
         DC    X'0A' .                  FLAG FIELD             @YM03697
         DC    AL3(0) .                 RESERVED               @Y17XAXF
IEDNCKPT DC    X'02',AL3(IEDDELEM)      3705 CKPOINT QCB       @Y17XAXF
         DC    A(0) .                    *                     @Y17XAXF
         DC    A(IEDNCKPT)               *                     @Y17XAXF
         DC    V(IEDBITN) .             BIND IMAGE TABLE ADDR  @Y17XAXF
         DC    A(0)                     LAST FREE PLCB         @OY19488
.SKP3705 ANOP                                                  @Y17XANU
         SPACE 1                                               @Y17XANU
&IEDLSEC CSECT
         AIF   ( T'&PLCBNO NE 'N' ).BDPLCB                       S22024
         DC    H'&PLCBNO' .             NUMBER OF PLCBS          S22024
         AGO   .GABND                                            S22024
.BDPLCB  SPACE 1 .                                               S22024
         MNOTE 4,'IHB303 INVALID OPERAND PLCBNO,DEFAULT ASSUMED' X03039
         SPACE 2                                               @ZA05019
         AGO   .NOPLCB                                           S22024
.NORN    DC    A(0) .                   SECONDARY AVT POINTER    S22024
.NOPLCB  DC    H'0' .                   RESERVED                 S22024
.GABND   ANOP                                                    S22024
IEDABEND BALR  1,0 .                    ESTABLISH BASE REG
         USING *,1 .                      FOR ABEND S045
         B     IEDSVC13 .               GO DO ABEND, SYSTEM 045
         DC    F'0' .                   DUMMY LINE I/O ECB
IEDA3TL  DC    A(0) .                   IEDQA3, TRANSLATE LIST
         IEDQMASK &WTTONE,2
         AIF   (&IEDQZA(24)).BADTONE
         AIF   ('&WTTONE'(1,1) EQ 'X').BADTONE
         AIF   (&WTTONE GT 450).BADTONE
         AIF   (&WTTONE EQ 0).ZEROTON
&IEDLTON SETA  &WTTONE
         DC    A(IEDTON) .              ADDR OF WORLD TRADE TONE CHARS
         AGO   .GOODTON
.BADTONE SPACE
         MNOTE 4,'IHB303  INVALID OPERAND WTTONE, 0 ASSUMED'
         SPACE 2
.ZEROTON ANOP
&IEDLTON SETA  0
         DC    A(0) .                   WTTONE=0
.GOODTON ANOP
         DC    A(0) IEDQNX              OPERATOR AWARENESS MSG ROUTER
         DC    A(0) IGG019Q0            I/O TRACE TABLE HANDLER
         DC    A(0) IEDQHI              SYSTEM DELAY SUBTASK QCB ADDR
         AIF   ( &IEDQRN(2) ).NOHK .                             S22024
         DC    V(IEDQHK) .              STOPLINE SUBTASK QCB ADDR
         AGO   .NOHK1 .                                          S22024
.NOHK    ANOP                                                    S22024
         DC    A(0) .                   HK UNUSED IN VTAM ONLY @Z30X8FG
.NOHK1   ANOP .                                                  S22024
         DC    X'20',AL3(IEDCPRMB),X'F0',AL3(0),A(IEDCKELE,IEDCKPTB)
*                                         CKPT ELE FROM TIME Q
IEDCKELE DC    X'70',AL3(IEDCKPTB),X'EC',AL3(0) CKPT TIME DELAY ELE
         DC    AL1(&IEDLSCB) .          SCB SIZE INCLUDING SAVEAREA
         DC    AL3(IEDCKPTB) .          QCB TO RECEIVE ELE WHEN
*                                         INTERVAL IS UP
         AIF   ('&STARTUP' EQ '').NOSN                         @OS77945
&IEDLSA  SETA  1                                               @OS77945
.SNLOOP  AIF   (K'&STARTUP LT &IEDLSA).NOSN                    @OS77945
         AIF   ('&STARTUP'(&IEDLSA,1) EQ 'N').GOSN             @OS77945
&IEDLSA  SETA  &IEDLSA+1                                       @OS77945
         AGO   .SNLOOP                                         @OS77945
.GOSN    ANOP                                                  @OS77945
&IEDLSB(18) SETB 1                                             @OS77945
.NOSN    DC    B'&IEDLSB(18).0000000'                          @OS77945
         IEDQMASK &CPRCDS,1
         AIF   (&IEDQZA(24)).BADCPR
         AIF   ('&CPRCDS'(1,1) EQ 'X').BADCPR
         AIF   (&CPRCDS LT 2 OR &CPRCDS GT 75).BADCPR
         DC    AL1(&CPRCDS) .           CPRCDS=INTEGER
         AGO   .SKIPCPR
.BADCPR  SPACE
         MNOTE 4,'IHB303  INVALID OPERAND CPRCDS, 2 ASSUMED'
         SPACE 2
         DC    AL1(2) .                 CPRCDS=2 DEFAULT VALUE
.SKIPCPR ANOP
         IEDQMASK &CPINTVL,2
         AIF   (&IEDQZA(24)).BADCPVL
         AIF   ('&CPINTVL'(1,1) EQ 'X' OR &CPINTVL LT 30).BADCPVL
         AIF   (&CPINTVL GE 43200).BADCPVL                      SA63008
         DC    AL2(&CPINTVL) .          CPINTVL=INTEGER
         AGO   .SKPCPVL
.BADCPVL SPACE
         MNOTE 4,'IHB303  INVALID OPERAND CPINTVL, 1800 ASSUMED'
         SPACE 2
         DC    AL2(1800) .              CPINTVL=1800 DEFAULT VALUE
.SKPCPVL ANOP
         DC    H'0' .                   TIME OF DAY OF INTERRUPT
         DC    X'08' .                  OFFSET TO CKPT QCB ADDR
         DC    4X'00' .                 OPEN CONSTANTS
         DC    X'00' .                  CKPT ELE STATUS
IEDOPETR DS    0X .                     INTRO RETURN CODE
         DC    V(IEDQHG01) .            TIME DELAY SUBROUTINE
IEDBSX   DC    AL1(8) .                 OFFSET TO BINARY SEARCH ADDR
         DC    AL3(0) .                 LINK ON TIME QUEUE
IEDDELEM DC    A(IEDREADY-8,IEDDELEM) . DUMMY LAST ELEMENT
         DC    X'20',AL3(IEDCKPTB),A(0) CLOSE CHECKPOINT ELEMENT
IEDCLRHI DC    X'0000FFFF' .            CLEARS HIGH HALF OF REG
IEDADBUF DC    B'&AF(32).0000000'      ADBUMP PARM/MH PTR      @OZ35527
         DC    AL3(&ABDUMP)                                    @OZ35527
         DC    A(0) .                   2260 LOCAL APPENDAGE
         DC    AL1(0) .                 RESERVED
IEDMSGS  DC    AL3(IEDQMSGS) .          LIST OF OPTIONAL VCONS
         AIF   (NOT &IEDQZA(44)).XXCMBF2                         S22027
&A       SETA  &IEDCBUF(1)                                       S22027
IEDCBSTB DC    AL2(&A) .                NUMBER OF COMMBUF STCBS  S22027
&A       SETA  &IEDCBUF(2)                                       S22027
IEDCBNDA DC    AL2(&A) .                NUMBER OF CB DATA AREAS  S22027
*                                       AFTER INTRO THE ABOVE    S22027
*                                       TWO HALF WORDS CONTAIN   S22027
*                                       THE ADDR OF CB MASTER QCBS22027
         AGO   .XXCMBF3                                          S22027
.XXCMBF2 DC    A(0) .                   RESERVED FOR CB          S22027
.XXCMBF3 ANOP                                                    S22027
IEDSUPPT DC    A(0) .                   STARTUP MESSAGE
         AIF   (&IEDQZA(51)).DOQCB
         DC    A(0) .                   TIME SHARING INPUT QCB ADDR
*                                        (UNUSED WHEN ENVIRON=TCAM)
         AGO   .SKDOQCB
.DOQCB   ANOP
IEDTSOPT DC    A(IEDAYTSQ) .            TS INPUT QCB ADDR (QCB IS
*                                         GENERATED BY TSINPUT MACRO)
.SKDOQCB ANOP
IEDOCQPT DC    A(0) IEDQEU .            OPEN/CLOSE APPL PGM      Y02027
IEDDELYB DC    A(*,0),V(IEDQHG) .       TIME DELAY QCB
         DC    A(0) .                   STIMER INTERVAL
         DC    H'0' .                   REFERENCE TIME
IEDINOUT DC    X'0100' .                DUMMY INEND/OUTEND PARM LIST
         DC    X'0C',AL3(IEDDELYB),A(IEDDELYB) PARM TO SVC 102 TO POST
*                                       TIME DELAY QCB TO ITSELF WHEN
*                                       TIME INTERRUPT IS RECEIVED
         DC    A(IEDDELYB) .            TIME DELAY Q
         AIF   ('&BRETURN' EQ 'LO').LOBACK                     @OY19124
         DC    X'02',AL3(IEDDELEM),A(0),V(IEDQGA)  AVAIL BFR   @G36XRFF
         AGO   .HIBACK                                         @OY19124
.LOBACK  ANOP                                                  @OY19124
         DC    X'02',AL3(IEDDELEM),XL1'80',AL3(0),V(IEDQGA)    @OY19124
.HIBACK  ANOP                                                  @OY19124
IEDBFRTB DC    X'02',AL3(IEDDELEM),A(0),V(IEDQGB) BFR RET QCB  @G36XRFF
IEDCKPTB DC    X'02',AL3(IEDDELEM),A(0,IEDCKPTB) CHECKPOINT QCB
IEDOPCOB DC    X'02',AL3(IEDDELEM),A(0,IEDOPCOB) OPERATOR CONTROL
IEDOLTQB DC    X'02',AL3(IEDDELEM),A(0,IEDOLTQB) ON LINE TEST
         AIF   (NOT &IEDQRN(2)).ACTQCB                           S22024
         DC    X'02',AL3(IEDDELEM),A(0),A(0) ACTIVATE QCB        S22024
&IEDLSB(5) SETB 0                                                S22024
&IEDLSB(6) SETB 0                                                S22024
         AGO   .LNTOUT                                           S22024
.ACTQCB  ANOP                                                    S22024
         AIF   ('&LINETYP' EQ 'STSP').LNTSTSP
         AIF   ('&LINETYP' EQ 'BISC').LNTBISC
         AIF   ('&LINETYP' EQ 'MINI').LNTMINI
         AIF   ('&LINETYP' EQ 'BOTH').LNTBOTH
         SPACE
.TSOERR   ANOP                                                 @OZ36974
         MNOTE 4,'IHB303  INVALID OPERAND LINETYP, BOTH ASSUMED'
         SPACE 2
.LNTBOTH ANOP
*                                       LINETYP=BOTH SPECIFIED
         DC    X'02',AL3(IEDDELEM),A(0),V(IEDQKA) ACTIVATE QCB
&IEDLSB(5) SETB 0
&IEDLSB(6) SETB 0
         AGO   .LNTOUT
.LNTMINI ANOP
*                                       LINETYP=MINI SPECIFIED
.* CHECK IF TSO                                                @OZ36974
         AIF   (&IEDQZA(51)).TSOERR                            @OZ36974
         DC    X'02',AL3(IEDDELEM),A(0),V(IEDQKD) ACTIVATE QCB
         AGO   .LNTOUT
.LNTBISC ANOP
*                                       LINETYP=BISC SPECIFIED
.* CHECK IF TSO                                                @OZ36974
         AIF   (&IEDQZA(51)).TSOERR                            @OZ36974
         DC    X'02',AL3(IEDDELEM),A(0),V(IEDQKB) ACTIVATE QCB
&IEDLSB(6) SETB 0                       BISC ONLY
         AGO   .LNTOUT
.LNTSTSP ANOP
*                                       LINETYP=STSP
         AIF   (&IEDQZA(51)).STSPTSO
         DC    X'02',AL3(IEDDELEM),A(0),V(IEDQKE) ACTIVATE QCB
         AGO   .SETSTSP
.STSPTSO ANOP
         DC    X'02',AL3(IEDDELEM),A(0),V(IEDQKC) ACTIVATE QCB
.SETSTSP ANOP
&IEDLSB(5) SETB 0                       STSP ONLY
.LNTOUT  ANOP
IEDCLOSB DC    X'02',AL3(*-1),A(0),V(IEDQNA) CLOSEDOWN COMPLETION
IEDCPRMB DC    X'02',AL3(*-1),A(0),V(IEDQHG03) REMOVE TIME DELAY
*                                         REQUEST ELE FROM TIME Q
         AIF   (&IEDQZA(51)).DOYO
         AIF   (&IEDQZA(41) AND &IEDQZA(42)).FA IF CORE AND DISK
         AIF   (&IEDQZA(41)).FA2        IF DISK ONLY
         DC    X'02',AL3(IEDDELEM),A(0),V(IEDQFA1) CORE ONLY Q QCB
         AGO   .SKFA
.FA2     ANOP
         DC    X'02',AL3(IEDDELEM),A(0),V(IEDQFA2) DISK ONLY Q QCB
         AGO   .SKFA
.FA      ANOP
         DC    X'02',AL3(IEDDELEM),A(0),V(IEDQFA) QUEUE QCB
.SKFA    ANOP
IEDCPBCB DC    X'02',AL3(*-1),A(0),V(IEDQFQ) CPB CLEANUP QCB
         AGO   .SKIPYO
.DOYO    DC    X'02',AL3(IEDDELEM),A(0),V(IEDAYN) QUEUE QCB   G36XRYP
IEDCPBCB DC    X'02',AL3(*-1),A(0),V(IEDAYN02) CPB CLEANUP QCBG36XRYP
.SKIPYO  ANOP
         DC    2F'0' .                  COREC AND CADDR
         DC    F'0' .                   FULLWORD OF ZEROES
         DC    V(IEDQFE) .              FE PATCH MODULE
         DC    F'0',X'40',AL3(0) .
         AIF   ('&COMWRTE' EQ 'NO').NOCMWR
         AIF   ('&COMWRTE' EQ 'YES').YESCMWR
         SPACE
         MNOTE 4,'IHB303  INVALID OPERAND COMWRTE, NO ASSUMED'
         SPACE 2
.NOCMWR  DC    X'00' .                  COMWRTE=NO SPECIFIED
         AGO   .SKCMWR
.YESCMWR DC    X'80' .                  COMWRTE=YES SPECIFIED
.SKCMWR  ANOP
&SUBTVAL SETC  '00'                     ASSIGN DEFAULT VALUE   @Y17XAXF
         AIF   ('&DTRACE(2)' NE '').DTRACET                    @Y17XANA
         AIF   (&DTRACEN EQ 0).DTRACEE                         @Y17XANA
         AIF   (&DTRACEN GT 0).DTRACEN                         @Y17XANA
.DTRACET ANOP                                                  @Y17XANA
         AIF   ('&DTRACE(2)' EQ 'OFF').DTRACEE                 @Y17XANA
         AIF   (&DTRACEN GT 0).DTRACEX                         @Y17XANA
         MNOTE 4,'IHB300 DTRACE OPTION REQUIRES TRACE TABLE'   @Y17XANA
         AGO   .DTRACEE                                        @Y17XANA
.DTRACEX ANOP                                                  @Y17XANA
         AIF   ('&DTRACE(2)' EQ 'ON').DTRACEN                  @Y17XANA
         AIF   ('&DTRACE(2)' EQ 'POST').DTRACEP                @Y17XANA
         AIF   ('&DTRACE(2)' EQ 'ALL').DTRACEL                 @Y17XANA
         MNOTE 4,'IHB300 DTRACE OPTION INVALID ON ASSUMED'     @Y17XANA
.DTRACEN ANOP                                                  @Y17XANA
&SUBTVAL SETC  '80'                                            @Y17XANA
         AGO   .DTRACEE                                        @Y17XANA
.DTRACEP ANOP                                                  @Y17XANA
&SUBTVAL SETC  'C0'                                            @Y17XANA
         AGO   .DTRACEE                                        @Y17XANA
.DTRACEL ANOP                                                  @Y17XANA
&SUBTVAL SETC  'FF'                                            @Y17XANA
.DTRACEE ANOP                                                  @Y17XANA
&SUBIVAL SETC  '00'                     SET DEFAULT VALUE
         AIF   ('&TRACE(2)' NE '').TRACET                      @Y17XANA
         AIF   (&TRACEN EQ 0).TRACEE                           @Y17XANA
         AIF   (&TRACEN GT 0).TRACEN                           @Y17XANA
.TRACET  ANOP                                                  @Y17XANA
         AIF   ('&TRACE(2)' EQ 'OFF').TRACEE                   @Y17XANA
         AIF   (&TRACEN GT 0).TRACEX                           @Y17XANA
         MNOTE 4,'IHB300 TRACE OPTION REQUIRES TRACE TABLE'    @Y17XANA
         AGO   .TRACEE                                         @Y17XANA
.TRACEX  ANOP                                                  @Y17XANA
         AIF   ('&TRACE(2)' EQ 'ON').TRACEN                    @Y17XANA
         AIF   ('&TRACE(2)' EQ 'HOLD').TRACEH                  @Y17XANA
         AIF   ('&TRACE(2)' EQ 'ALL').TRACEL                   @Y17XANA
         MNOTE 4,'IHB300 TRACE OPTION INVALID ON ASSUMED'      @Y17XANA
.TRACEN  ANOP                                                  @Y17XANA
&SUBIVAL SETC  '80'                                            @Y17XANA
         AGO   .TRACEE                                         @Y17XANA
.TRACEH  ANOP                                                  @Y17XANA
&SUBIVAL SETC  'C0'                                            @Y17XANA
         AGO   .TRACEE                                         @Y17XANA
.TRACEL  ANOP                                                  @Y17XANA
&SUBIVAL SETC  'FF'                                            @Y17XANA
.TRACEE  ANOP                                                  @Y17XANA
.TREXIT  ANOP                                                  @Y17XANU
         DC    X'00FFFF0000000040000000',3F'0'  FE PATCH AREA  @Y17XANU
         DC    X'&SUBTVAL' .            SUBT FLAGS             @Y17XAXF
         DC    X'&SUBIVAL' .            IOTR FLAGS             @Y17XANU
         DC    H'0' .                   RESERVED               @Y17XANU
         DC    A(0) .                   FE SERVICE ROUTINE     @Y17XANU
         DC    13F'0' .                 FE PATCH AREA          @Y17XANU
         DC    F'0' .                   TOTE AREA              @Y17XANU
*        GETMAIN EC,MF=L                GETMAIN PARAMETER LIST
         GETMAIN EC,MF=L
         DC    H'2,3,4,7,16' .          HALFWORD CONSTANTS
&IEDLKEY SETA  0                        DEFAULT FOR KEYLEN (UNITSZ)
         AIF   ('&KEYLEN' EQ '').TRYUNSZ
         AIF   ('&UNITSZ' NE '').BOTHBAD
         AGO   .TRYKEY
.TRYUNSZ AIF   ('&UNITSZ' EQ '').SKPKYX
         IEDQMASK &UNITSZ,1
         AIF   (&IEDQZA(24)).BADUNSZ
         AIF   (&UNITSZ EQ 0).GOODUNS
         AIF   (&IEDQRN(1)).CK05        CK FOR 3705 ENVIRON    @YM06968
         AIF   ('&UNITSZ'(1,1) EQ 'X' OR &UNITSZ LT 36).BADUNSZ
.*                                                             @Z30X8FG
         AGO   .GOODUNS                                        @YM06968
.CK05    AIF  ('&UNITSZ'(1,1) EQ 'X' OR &UNITSZ LT 44).BADUNSZ @YM06968
.GOODUNS ANOP
&IEDLKEY SETA  &UNITSZ
*                                       UNITSZ=INTEGER
         AGO   .SKPKY
.BOTHBAD SPACE
         MNOTE 4,'IHB303  INVALID OPERAND KEYLEN/UNITSZ, 0 ASSUMED'
         SPACE 2
.SKPKYX  ANOP
*                                       KEYLEN=0 (UNITSZ=0) DEFAULT
         AGO   .SKPKY
.BADUNSZ SPACE
         MNOTE 4,'IHB303  INVALID OPERAND UNITSZ, 0 ASSUMED'
         SPACE 2
*                                       UNITSZ=0 DEFAULT VALUE
         AGO   .SKPKY
.TRYKEY  ANOP
         IEDQMASK &KEYLEN,1
         AIF   (&IEDQZA(24)).BADKY
         AIF   (&KEYLEN EQ 0).GOODKEY
         AIF   (&IEDQRN(1)).CK3705      CK FOR 3705 ENVIRON    @YM06968
         AIF   ('&KEYLEN'(1,1) EQ 'X' OR &KEYLEN LT 36).BADKY  @Z30X8FG
         AGO   .GOODKEY                                        @YM06968
.CK3705  AIF   ('&KEYLEN'(1,1) EQ 'X' OR &KEYLEN LT 44).BADKY  @YM06968
.GOODKEY ANOP
&IEDLKEY SETA  &KEYLEN
*                                       KEYLEN=INTEGER
         AGO   .SKPKY
.BADKY   SPACE
         MNOTE 4,'IHB303  INVALID OPERAND KEYLEN, 0 ASSUMED'
         SPACE 2
*                                       KEYLEN=0 DEFAULT VALUE
.SKPKY   ANOP
&KEYLN   SETA  &IEDLKEY                 KEYLN=KEYLEN OR UNITSZ @OZ36390
         DC    H'&IEDLKEY'
         DC    5H'0' .                  LNCNT,OPCNT,OPCON,AVFCT,SMCNT
         IEDQMASK &INTVAL,2
         AIF   (&IEDQZA(24)).BADINT
         AIF   ('&INTVAL'(1,1) EQ 'X' OR &INTVAL LT 0).BADINT
         DC    AL2(&INTVAL) .               INTVAL=INTEGER
         AGO   .SKPINT
.BADINT  SPACE
         MNOTE 4,'IHB303  INVALID OPERAND INTVAL, 0 ASSUMED'
         SPACE 2
         DC    H'0' .                   INTVAL=0 DEFAULT VALUE
.SKPINT  ANOP
IEDDLQX  DC    H'0' .                   DEAD LETTER Q OFFSET
IEDDUMBR BR    11 .                     DUMMY TRACE TABLE UPDATE
IEDBIT1  DC    B'0&IEDQZA(51).&IEDQZA(52).0000&IEDLDSK'
         AIF   ('&TOPMSG' EQ 'NO').NOTOP
         AIF   ('&TOPMSG' EQ 'YES').YESTOP
         SPACE
         MNOTE 4,'IHB303  INVALID OPERAND TOPMSG, YES ASSUMED'
         SPACE 2
.YESTOP  ANOP
&IEDLSB(7) SETB 0
*                                       TOPMSG=YES, DISPLAY T.O. MSGS
         AGO   .ENDTOP
.NOTOP   ANOP
&IEDLSB(7) SETB 1
*                                       TOPMSG=NO, SUPPRESS T.O. MSGS
.ENDTOP  ANOP
         AIF   ('&STARTUP' EQ '').ENDSTRT
         AIF   (K'&STARTUP GT 3).ERRSTRT
&IEDLSA  SETA  1                        PRESET INDEX
.STALOOP AIF   (K'&STARTUP LT &IEDLSA).ENDSTR
         AIF   ('&STARTUP'(&IEDLSA,1) EQ 'C').GOTC
         AIF   ('&STARTUP'(&IEDLSA,1) EQ 'W').GOTW
         AIF   ('&STARTUP'(&IEDLSA,1) EQ 'I').GOTI
         AIF   ('&STARTUP'(&IEDLSA,1) EQ 'Y').GOTY
         AIF   ('&STARTUP'(&IEDLSA,1) EQ 'E').GOTE              SA51078
         AIF   ('&STARTUP'(&IEDLSA,1) EQ 'N').STABUMP          @OS77945
.ERRSTRT SPACE
         MNOTE 12,'IHB300 STARTUP OPERAND INVALID AS SPECIFIED'
         SPACE 2
         AGO   .ENDSTRT
.GOTC    AIF   (&IEDLSB(1)).ERRSTRT
&IEDLSB(1) SETB 1                       STARTUP SPECIFIED
&IEDLSB(2) SETB 1                       'C' SPECIFIED
         AGO   .STABUMP
.GOTW    AIF   (&IEDLSB(1)).ERRSTRT
&IEDLSB(1) SETB 1                       STARTUP SPECIFIED
&IEDLSB(2) SETB 0                       'W' SPECIFIED
         AGO   .STABUMP
.GOTI    AIF   (&IEDLSB(3)).ERRSTRT
&IEDLSB(3) SETB 1                       'I' SPECIFIED
         AGO   .STABUMP
.GOTY    AIF   (&IEDLSB(4) OR &IEDLSB(14) OR                           X
               &IEDLSB(18)).ERRSTRT                            @OS77945
&IEDLSB(4) SETB 1                       'Y' SPECIFIED
         AGO   .STABUMP                                         SA51078
.GOTE    AIF   (&IEDLSB(4) OR &IEDLSB(14) OR                           X
               &IEDLSB(18)).ERRSTRT                            @OS77945
&IEDLSB(14) SETB 1                                              SA51078
.STABUMP ANOP
&IEDLSA  SETA  &IEDLSA+1                BUMP INDEX
         AGO   .STALOOP                 LOOK AT NEXT CHARACTER
.ENDSTR  AIF   (NOT &IEDLSB(1)).ERRSTRT
         DC    B'&IEDLSB(14).00&IEDLSB(7).00&IEDLSB(6).&IEDLSB(5)'
*                                       STARTUP CODE SPECIFIED @XA05310
         DC    B'0000&IEDLSB(4).&IEDLSB(3).&IEDLSB(2).&IEDLSB(1)'
         AGO   .MOREBIT
.ENDSTRT ANOP                                                  @XA05310
         DC    B'&IEDLSB(14).00&IEDLSB(7).00&IEDLSB(6).&IEDLSB(5)'
         DC    B'00000000'              STARTUP CODE NOT SPEC  @XA05310
.MOREBIT ANOP
         IEDQMASK &RESTART,1
         AIF   (&IEDQZA(24)).BADREST
         AIF   ('&RESTART'(1,1) EQ 'X').BADREST
         DC    AL1(&RESTART) .          RESTART=INTEGER
         AGO   .SKPREST
.BADREST SPACE
         MNOTE 4,'IHB303  INVALID OPERAND RESTART, 0 ASSUMED'
         SPACE 2
         DC    AL1(0) .                 RESTART=0 DEFAULT VALUE
.SKPREST ANOP
         DC    2AL1(0) .
         DC    V(IEDOPTN) .             OPTION SEARCH RTN      @Y17XANU
         DC    V(IEDQGA02) .            BUFFER STEAL RTN       @G36XRFF
         DC    V(IEDQTL) .              DEVICE DEP FIELD       @Y17XANU
*                                       LOOKUP RTN             @Y17XANU
         DC    A(IEDOPMSK) .            OP CTL MASK TABLE ADDR @Y17XANU
IEDOPMSK CSECT                                                 @Y17XANU
         DC    H'9' .                   DEFINE ENTRY COUNT     @Y17XANU
&G       SETA  0                        INIT LOOP COUNTER      @Y17XANU
         AIF   (N'&OPMASK LT 9 OR N'&OPMASK EQ 9).MSKLOOP      @Y17XANU
.*                                      VALID ENTRY            @Y17XANU
         MNOTE 4,'IED901 TOO MANY MASK ENTRIES - FIRST 9 ARE CANDIDATESC
               '                                               @Y17XANU
.MSKLOOP ANOP                                                  @Y17XANU
         AIF   (&G EQ 9).MSKEND         ALL MASKS CHECKED      @Y17XANU
&G       SETA  &G+1                     INCREMENT COUNTER      @Y17XANU
&H       SETC  '&OPMASK(&G)'             GET NEXT ENTRY        @Y17XANU
         AIF   ('&H' EQ '').DEFMSK      USE DEFAULT VALUE      @Y17XANU
         AIF   (K'&H EQ 4).MSKCHK0      4 DIGIT ENTRY          @Y17XANU
.*                                                             @Y17XANU
         AGO   .ERRMSK1                 USE DEFAULT            @Y17XANU
.MSKCHK0 ANOP                                                  @Y17XANU
&ECNT    SETA  0                        INIT LOOP COUNT        @Y17XANU
.MSKCHK1 ANOP                                                  @Y17XANU
         AIF   (&ECNT EQ 4).MSKFIN      MASK ENTRY VALID       @Y17XANU
&ECNT    SETA  &ECNT+1                  INCREMENT COUNTER      @Y17XANU
         AIF   ('&H'(K'&H,1) GE '0' AND '&H'(K'&H,1) LE '9').MSKCHK1
.*             IF DIGIT BETWEEN 0 AND 9 - VALID HEX            @Y17XANU
         AIF   ('&H'(K'&H,1) LT 'A' OR '&H'(K'&H,1) GT 'F').ERRMSK1
.*             IF DIGIT NOT BETWEEN A AND F - INVALID HEX      @Y17XANU
         AGO   .MSKCHK1                 CHECK NEXT DIGIT       @Y17XANU
.ERRMSK1 ANOP                                                  @Y17XANU
         MNOTE 4,'IED902 INVALID OPMASK VALUE, DEFAULT ASSUMED'
.*                                                             @Y17XANU
.DEFMSK  ANOP
         DC    XL2'&MSKVAL(&G)' .       OP CONTROL MASK        @Y17XANU
         AGO   .MSKLOOP                 SPARSE NEXT ENTRY      @Y17XANU
.MSKFIN  ANOP                                                  @Y17XANU
         DC    XL2'&H'                  OP CONTROL MASK        @Y17XANU
         AGO   .MSKLOOP                 SPARSE NEXT ENTRY      @Y17XANU
.MSKEND  ANOP                           END OF TABLE           @Y17XANU
&IEDLSEC CSECT                                                 @Y17XANU
         DC    H'6' .                   LENGTH OF DCT MASK FLD @Y17XANU
         DC    H'0' .                   TTCIN OF PRIMARY       @Y17XADU
*                                       TERMINAL               @Y17XANU
.* &IEDQZA(52) SET BY ENVIRON=TCAM OR MIXED
         AIF   (NOT &IEDQZA(52)).TSONLY
         DC    V(IEDQHM02) .            DESTINATION ASSIGNEMNT
         IEDQMASK &MSMIN,1
         AIF   (&IEDQZA(24)).BADMIN
         AIF   ('&MSMIN'(1,1) EQ 'X' OR &MSMIN GE 100).BADMIN
&IEDLMIN SETA  &MSMIN
         AGO   .SKIPMIN
.BADMIN  SPACE
         MNOTE 4,'IHB303  INVALID OPERAND MSMIN, 50 ASSUMED'
         SPACE 2
*                                       DEFAULT VALUE FOR MSMIN USED
&IEDLMIN SETA  50
.SKIPMIN ANOP
         IEDQMASK &MSMAX,1
         AIF   (&IEDQZA(24)).BADMAX
         AIF   ('&MSMAX'(1,1) EQ 'X' OR &MSMAX GT 100 OR &MSMAX LT 1).BA
               ADMAX
&IEDLMAX SETA  &MSMAX
         AGO   .SKIPMAX
.BADMAX  SPACE
         MNOTE 4,'IHB303  INVALID OPERAND MSMAX, 70 ASSUMED'
         SPACE 2
*                                       DEFAULT VALUE FOR MSMAX USED
&IEDLMAX SETA  70
.SKIPMAX ANOP
         AIF   (&IEDLMAX GT &IEDLMIN).OKINAX
         SPACE
         MNOTE 12,'IHB300 MSMIN/MSMAX OPERAND INVALID AS SPECIFIED'
         SPACE 2
         DC    F'50' .                  MSMIN=50 DEFAULT VALUE
         DC    F'70' .                  MSMAX=70 DEFAULT VALUE
         AGO   .MINMAX
.OKINAX  ANOP
         DC    F'&IEDLMIN' .                  MSMIN=INTEGER
         DC    F'&IEDLMAX' .                  MSMAX=INTEGER
.MINMAX  ANOP
         DC    F'&IEDLMS' .             MSUNITS=INTEGER
         DC    AL1(4),AL3(0),A(0) .     ELEMENTS WAITING FOR CPBS
         AIF   (&IEDQZA(41)).GOTDISK
         AGO   .END
.GOTDISK ANOP
IEDFL    DC    A(0) .                   DISK EXCP DRIVER
IEDIA    DC    A(0) .                   REUS
         DC    A(0) .                   ADDR OF COPY SUBTASK QCB
         DC    AL1(40),AL3(0),A(0) .    CPBS FOR CPB CLEANUP-DISABLE
         DC    AL1(40),AL3(0),A(0) .    SAME, BUT ENABLED
         DC    AL1(40),AL3(0),A(0) .    CPBS WITHOUT BUFFERS
IEDBIT4  DC    XL1'00' .                FLAGBITS                SA51078
         DC    AL3(0) .                 RESERVED                SA51078
         DC    A(0) .                   RESERVED                SA51078
         DC    AL1(40),AL3(0),A(0) .    CPBS WANTING I/O
IEDFCPB  DC    A(0) .                   CPB FREEPOOL
         DC    17F'0' .                 DISK OPEN CONSTANTS
IEDNADDR DC    A(IEDQNADN,IEDQNADR)     DISK RECORD ADDRESSES    Y05330
         DC    A(IEDOPCOB),X'EA',AL3(0),X'310C00FF'            @SA71946
*                                       NON-REUSABLE DISK
*                                         THRESHOLD CLOSEDOWN ELE
         IEDQMASK &CPB,2
         AIF   (&IEDQZA(24)).BADCPB
         AIF   ('&CPB'(1,1) EQ 'X' OR &CPB LT 0).BADCPB
         DC    AL2(&CPB) .                 CPB=INTEGER
         AGO   .SKPCPB
.BADCPB  SPACE
         MNOTE 4,'IHB303  INVALID OPERAND CPB, 0 ASSUMED'
         SPACE 2
         DC    AL2(0) .                 CPB=0 DEFAULT VALUE
.SKPCPB  ANOP
         AGO   .END
.TSONLY  ANOP                                                    S22029
.END     SPACE 2
IEDOA    DC    CL8'IEDQOA  ' .          INITIALIZATION LINKOR SUBRT
IEDSVC13 DS    0H .
         STM   14,12,12(13) .           SAVE REGISTERS IN      @Y17XANA
*                                       CURRENT SAVE AREA        Y01004
         L     1,IED045 .               GET ABEND CODE
         DROP  1 .                      FORGET BASE
*        ABEND (1) .                    SYSTEM 045,SUBCODE IN R15
         ABEND (1) .                    SYSTEM 045,SUBCODE IN R15
         DS    0F .                     WORD BOUNDARY
IED045   DC    X'80045000' .            ABEND SYSTEM CODE
         AIF   (&IEDLTON EQ 0).NOTONE
IEDTON   CSECT
         DC    AL2(&IEDLTON),&IEDLTON.X'FF' .     TONE CHAR WORLD TRADE
.NOTONE  AIF   (&IEDLSB(10) EQ 0).HGOK
         SPACE 3
IEDQHG   CSECT .                        DUMMY TIME DELAY SUBTASK
*                                       FEATURE=(,,NOTIMER)
IEDQHG03 DS    0H
         ENTRY IEDQHG01,IEDQHG02,IEDQHG03
         DC    X'0400' .                STCB FOR TIME DELAY SUBTASK
IEDQHG01 DS    0H .                     SUBROUTINE TYPE ENTRY
IEDQHG02 DS    0H .                       POINTS TO TIME DELAY
         LA    15,6 .                   ABEND SUBCODE
         BAL   14,IEDABEND-IEDSAVE2(13) ILLEGAL CALL TO TIME
*                                         DELAY, SO ABEND
.HGOK    ANOP
         SPACE 3
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
*
*                      TCAM MESSAGE CONTROL PROGRAM
*
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
&IEDLSEC CSECT
&IEDIDLN  SETA K'&PROGID                                         X03039
IEDPGMID DC    AL1(&IEDIDLN) .          LENGTH OF PROGID         X03039
         DC    C'&PROGID'
.SKIPSEC ANOP
*
&IEDLSKP DS    0H
         STM   14,12,12(13) .           SAVE CALLERS REGISTERS
         ST    1,IEDSPLPT .             SAVE ADDRESS OF START
*                                         PARAMETER LIST POINTER
         LA    1,IEDSAVE1 .             GET ADDRESS OF SAVEAREA
         ST    13,IEDSAVE1+4 .          EXCHANGE
         ST    1,8(13) .                  SAVEAREA ADDRESSES
         USING IEDSAVE1,13 .            IDENTIFY PROGRAM BASE
         LR    13,1 .                   SET PROGRAM BASE
         DROP  15 .                     FORGET TEMPORARY
*                                       PASS ADDR OF AVT AS PARM IN R1
*        LINK  EPLOC=IEDOA,MF=(E,(1))   GET OPERATOR REPLY ROUTINE
         LINK  EPLOC=IEDOA,MF=(E,(1))
         SPACE 2
         MEND

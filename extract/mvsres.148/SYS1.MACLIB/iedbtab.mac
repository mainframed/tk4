         MACRO
&NAME    IEDBTAB &DEFBI=BI3270,&CBI=
.*A000000-999999                                               @Y17XAFN
.*C001300,001400,001610,001820,002100,002300,002450,002660     @OZ27620
.*C002730,002940,003010,003220,003290,003500,003990,004060     @OZ27620
.*C004900,004970,005180,005250,005460,005670,005950,006160     @OZ27620
.*C006300,006510,006580,006790,007070,007350                   @OZ27620
.* &DEFBI - NAME OF DEFAULT BIND IMAGE OPERAND.
.* &CBI   - NAME OF CANNED BIND IMAGE OPERAND.
.* &SUBON - NUMBER OF CANNED BIND IMAGE SUB-OPERAND.
.* &BIC   - CANNED BIND IMAGE COUNTER.
.* IEDBITN - NAME OF THE BIND IMAGE TABLE,AS IT IS DEFINED IN THE
.*           SECONDARY AVT.
         GBLB  &IEDBIG
         LCLA  &SUBON,&BIC
         LCLC  &N
&SUBON   SETA  N'&CBI                   NUMBER OF CBI SUB-OPERS
&IEDBIG  SETB  1                        SET ZERO NAME FIELD FLAG
&N       SETC  '&DEFBI'                 GET DEFAULT BI NAME
IEDBITN  CSECT
         AIF   ('&DEFBI' EQ 'BI3270').BIDEF    DEFAULT BI CODED
         AIF   ('&DEFBI' NE 'BI3270NB').BI3601 3271 BI CODED
BI3270NB IEDBENT FMPROF=X'02',TSPROF=X'02',SECPROT=X'40',      @OZ27620X
               COMPROT=XL2'0000',PRIPROT=X'20'                 @OZ27620
         AGO   .BICBI                   CHECK FOR CANNED BI
.BI3601  AIF   ('&DEFBI' NE 'BI3601').BI3614 3601 BI CODED
BI3601   IEDBENT SECPROT=X'F0'                                 @OZ27620
         AGO   .BICBI                   CHECK FOR CANNED BI
.BI3614  AIF   ('&DEFBI' NE 'BI3614').BI3767 3614 BI CODED
BI3614   IEDBENT FMPROF=X'04',TSPROF=X'04',SECPROT=X'30',      @OZ27620X
               COMPROT=XL2'0040'
         AGO   .BICBI                   CHECK FOR CANNED BI
.BI3767  AIF   ('&DEFBI' NE 'BI3767').BI3770A 3767 BI CODED
BI3767   IEDBENT PRIPROT=X'B1',COMPROT=XL2'3040',              @OZ27620X
               SECPROT=X'A0',LUPROF=X'01'                      @OZ27620
         AGO   .BICBI                   CHECK FOR CANNED BI
.BI3770A AIF   ('&DEFBI' NE 'BI3770A').EMU3790 3770 BI CODED
BI3770A  IEDBENT PRIPROT=X'B3',COMPROT=XL2'7080',              @OZ27620X
               TSUSAGE=XL6'0001858580000',LUPROF=X'01',                X
               PRESERC=XL11'1000000000000000000000',           @OZ27620X
               SECPROT=X'A3'                                   @OZ27620
         AGO   .BICBI                   CHECK FOR CANNED BI
.EMU3790 AIF   ('&DEFBI' NE 'EMU3790').RJ3790A 3790 BI CODED
EMU3790  IEDBENT PRIPROT=X'B1',COMPROT=XL2'3080',              @OZ27620X
               LUPROF=X'02',PRESERC=XL11'0200',SECPROT=X'B0'   @OZ27620
         AGO   .BICBI                   CHECK FOR CANNED BI
.RJ3790A AIF   ('&DEFBI' NE 'RJE3790A').RJ3790B 3790 BI CODED
RJE3790A IEDBENT PRIPROT=X'A3',COMPROT=XL2'7080',              @OZ27620X
               LUPROF=X'01',PRESERC=XL11'1060F10080800000000000',      X
               SECPROT=X'A3'                                   @OZ27620
         AGO   .BICBI                   CHECK FOR CANNED BI
.RJ3790B AIF   ('&DEFBI' NE 'RJE3790B').BTH3790 3790 BI CODED
RJE3790B IEDBENT PRIPROT=X'A3',COMPROT=XL2'7080',              @OZ27620X
               LUPROF=X'01',PRESERC=XL11'1020F10080800000000000',      X
               SECPROT=X'A3'                                   @OZ27620
         AGO   .BICBI                   CHECK FOR CANNED BI
.BTH3790 AIF   ('&DEFBI' NE 'BTCH3790').BIERR 3790 BI CODED
BTCH3790 IEDBENT TSPROF=X'04',PRIPROT=X'B1',SECPROT=X'B0',     @OZ27620X
               COMPROT=XL2'7080',LUPROF=X'01',                         X
               PRESERC=XL11'3118400000900800000050'
         AGO   .BICBI                   CHECK FOR CANNED BI
.BIERR   MNOTE 8,'*** IEDB00 DEFBI OPERAND CODED INCORRECTLY,&N IS NOT *
               AN ACCEPTABLE DEFAULT,BI3270 WAS GENERATED.'
.BIDEF   ANOP
BI3270   IEDBENT FMPROF=X'02',TSPROF=X'02',PRIPROT=X'21',      @OZ27620X
               SECPROT=X'40',COMPROT=XL2'2000'                 @OZ27620
.BICBI   ANOP
&IEDBIG  SETB  0                        RESET ZERO NAME FIELD FLAG
         AIF   ('&CBI' EQ '').MEND CANNED BI CODED
         AIF   ('&CBI'(1,1) EQ '(' OR 'SUBON' EQ '1').BISYN
         MNOTE 8,'*** IEDB01 SUB-OPERANDS MUST BE ENCLOSED BY PARENTHES*
               ES,DEFAULT TO 1 SUB-OPERAND.'
.BISYN   ANOP
&BIC     SETA  1
.BI3271C ANOP
&N       SETC  '&CBI(&BIC)'
         AIF   ('&CBI(&BIC)' NE 'BI3270NB').BI3270C 3271 BI CODED
BI3270NB IEDBENT FMPROF=X'02',TSPROF=X'02',SECPROT=X'40',      @OZ27620X
               COMPROT=XL2'0000',PRIPROT=X'20'                 @OZ27620
         AGO   .BISOPCK                 SUB OPERAND CHECK
.BI3270C AIF   ('&CBI(&BIC)' NE 'BI3270').BI3601C 3271 BI CODED
BI3270   IEDBENT FMPROF=X'02',TSPROF=X'02',PRIPROT=X'21',      @OZ27620X
               SECPROT=X'40',COMPROT=XL2'2000'                 @OZ27620
         AGO   .BISOPCK                 SUB OPERAND CHECK
.BI3601C AIF   ('&CBI(&BIC)' NE 'BI3601').BI3614C 3601 BI CODED
BI3601   IEDBENT SECPROT=X'F0'                                 @OZ27620
         AGO   .BISOPCK                 CHECK FOR CANNED BI
.BI3614C AIF   ('&CBI(&BIC)' NE 'BI3614').BI3767C 3614 BI CODED
BI3614   IEDBENT FMPROF=X'04',TSPROF=X'04',SECPROT=X'30',      @OZ27620X
               COMPROT=XL2'0040'
         AGO   .BISOPCK                 CHECK FOR CANNED BI
.BI3767C AIF   ('&CBI(&BIC)' NE 'BI3767').BI377AC 3767 BI CODED
BI3767   IEDBENT PRIPROT=X'B1',SECPROT=X'A0',                  @OZ27620X
               LUPROF=X'01',COMPROT=XL2'3040'                  @OZ27620
         AGO   .BISOPCK                 SUB OPERAND CHECK
.BI377AC AIF   ('&CBI(&BIC)' NE 'BI3770A').EMU379C 3770 BI CODED
BI3770A  IEDBENT PRIPROT=X'B3',COMPROT=XL2'7080',              @OZ27620X
               TSUSAGE=XL6'000185850000',LUPROF=X'01',                 X
               PRESERC=XL11'1000000000000000000000',           @OZ27620X
               SECPROT=X'A3'                                   @OZ27620
         AGO   .BISOPCK                 CHECK FOR CANNED BI
.EMU379C AIF   ('&CBI(&BIC)' NE 'EMU3790').RJ379AC 3790 BI CODED
EMU3790  IEDBENT PRIPROT=X'B1',COMPROT=XL2'3080',              @OZ27620X
               LUPROF=X'02',PRESERC=XL11'0200',SECPROT=X'B0'   @OZ27620
         AGO   .BISOPCK                 CHECK FOR CANNED BI
.RJ379AC AIF   ('&CBI(&BIC)' NE 'RJE3790A').RJ379BC 3790 BI CODED
RJE3790A IEDBENT PRIPROT=X'A3',SECPROT=X'A3',                  @OZ27620X
               COMPROT=XL2'7080',                              @OZ27620X
               LUPROF=X'01',PRESERC=XL11'1060F10080800000000000'
         AGO   .BISOPCK                 CHECK FOR CANNED BI
.RJ379BC AIF   ('&CBI(&BIC)' NE 'RJE3790B').BTH379C 3790 BI CODED
RJE3790B IEDBENT PRIPROT=X'A3',SECPROT=X'A3',                  @OZ27620X
               COMPROT=XL2'7080',                              @OZ27620X
               LUPROF=X'01',PRESERC=XL11'1020F10080800000000000'
         AGO   .BISOPCK                 CHECK FOR CANNED BI
.BTH379C AIF   ('&CBI(&BIC)' NE 'BTCH3790').BIERR1 3790 BI CODED
BTCH3790 IEDBENT TSPROF=X'04',PRIPROT=X'B1',SECPROT=X'B0',     @OZ27620X
               COMPROT=XL2'7080',LUPROF=X'01',                         X
               PRESERC=XL11'3118400000900800000050'
         AGO   .BISOPCK                 CHECK FOR CANNED BI
.BIERR1  MNOTE 8,'*** IEDB02 CBI OPERAND CODED INCORRECTLY,&N IS NOT AN*
                ACCEPTABLE BIND IMAGE NAME.'
.BISOPCK ANOP
&SUBON   SETA  &SUBON-1                 DECREMENT SUB OPS BY ONE
&BIC     SETA  &BIC+1                   INCREMENT CANNED BI NUM BY 1
         AIF   ('&SUBON' NE '0').BI3271C LAST SUB OP CHECKED
.MEND    MEND

000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID. RRDSREAD.
000300 AUTHOR. JAY MOSELEY.
000400 DATE-WRITTEN. NOVEMBER, 2001.
000500 DATE-COMPILED.
000600
000700* ************************************************************* *
000800* THIS PROGRAM TESTS THE VSAMIO ROUTINE BY READING RECORDS FROM *
000900* AN RRDS CLUSTER AND DISPLAYING THEIR CONTENTS ON SYSOUT.      *
001000* ************************************************************* *
001100
001200 ENVIRONMENT DIVISION.
001300 CONFIGURATION SECTION.
001400 SOURCE-COMPUTER. IBM-370.
001500 OBJECT-COMPUTER. IBM-370.
001600
001700 INPUT-OUTPUT SECTION.
001800 FILE-CONTROL.
001900
002000 DATA DIVISION.
002100 FILE SECTION.
002200
002300 WORKING-STORAGE SECTION.
002400 77  END-OF-FILE-SWITCH          PIC X(1)    VALUE 'N'.
002500     88  END-OF-FILE                         VALUE 'Y'.
002600
002700 77  COUNTER-EDIT                PIC ZZ,ZZZ,ZZ9.
002800
002900 01  VSIO-PARAMETER-VALUES       COPY VSAMIO.
003000 01  RRDSF01                     COPY VSAMIOFB.
003100 01  RRDS-RECORD                 PIC X(80).
003200
003300 PROCEDURE DIVISION.
003400
003500 000-INITIATE.
003600
003700     DISPLAY 'RRDSREAD: READ RRDS SEQUENTIALLY'.
003800     DISPLAY '--------------------------------'.
003900     DISPLAY ' '.
004000
004100     MOVE 'RRDSF01' TO VSIO-DDNAME.
004200     MOVE VSIO-RRDS TO VSIO-ORGANIZATION.
004300     MOVE VSIO-SEQUENTIAL TO VSIO-ACCESS.
004400     MOVE VSIO-INPUT TO VSIO-MODE.
004500     MOVE +80 TO VSIO-RECORD-LENGTH.
004600     MOVE VSIO-OPEN TO VSIO-COMMAND.
004700     CALL 'VSAMIO' USING VSIO-PARAMETER-BLOCK, RRDSF01,
004800                         RRDS-RECORD.
004900*    END-CALL.
005000     IF NOT VSIO-SUCCESS
005100         DISPLAY 'VSAMIO ERROR OCCURRED DURING '
005200                 VSIO-COMMAND
005300         EXHIBIT NAMED VSIO-RETURN-CODE,
005400         EXHIBIT NAMED VSIO-VSAM-RETURN-CODE,
005500                       VSIO-VSAM-FUNCTION-CODE,
005600                       VSIO-VSAM-FEEDBACK-CODE
005700         STOP RUN.
005800*    END-IF.
005900
006000 010-PROCESS.
006100
006200     PERFORM 110-PROCESS-DATA
006300        THRU 119-EXIT
006400       UNTIL END-OF-FILE.
006500*    END-PERFORM.
006600
006700 020-TERMINATE.
006800
006900     MOVE VSIO-CLOSE TO VSIO-COMMAND.
007000     CALL 'VSAMIO' USING VSIO-PARAMETER-BLOCK, RRDSF01,
007100                         RRDS-RECORD.
007200*    END-CALL.
007300     IF NOT VSIO-SUCCESS
007400         DISPLAY 'VSAMIO ERROR OCCURRED DURING '
007500                 VSIO-COMMAND
007600         EXHIBIT NAMED VSIO-RETURN-CODE,
007700         EXHIBIT NAMED VSIO-VSAM-RETURN-CODE,
007800                       VSIO-VSAM-FUNCTION-CODE,
007900                       VSIO-VSAM-FEEDBACK-CODE.
008000*    END-IF.
008100
008200     STOP RUN.
008300
008400 110-PROCESS-DATA.
008500
008600     MOVE VSIO-READ TO VSIO-COMMAND.
008700     CALL 'VSAMIO' USING VSIO-PARAMETER-BLOCK, RRDSF01,
008800                         RRDS-RECORD.
008900*    END-CALL.
009000
009100     IF NOT VSIO-SUCCESS
009200         IF VSIO-END-OF-FILE
009300             MOVE 'Y' TO END-OF-FILE-SWITCH
009400         ELSE
009500             DISPLAY 'VSAMIO ERROR OCCURRED DURING '
009600                     VSIO-COMMAND
009700             EXHIBIT NAMED VSIO-RETURN-CODE,
009800             EXHIBIT NAMED VSIO-VSAM-RETURN-CODE,
009900                           VSIO-VSAM-FUNCTION-CODE,
010000                           VSIO-VSAM-FEEDBACK-CODE
010100             MOVE 'Y' TO END-OF-FILE-SWITCH.
010200*        END-IF
010300*    END-IF.
010400
010500     IF NOT END-OF-FILE
010600         MOVE VSIO-RELATIVE-RECORD TO COUNTER-EDIT
010700         DISPLAY COUNTER-EDIT ': ' RRDS-RECORD.
010800*    END-IF.
010900
011000 119-EXIT.
011100     EXIT.
011200
011300

         TITLE 'AHLTPMT- GTF EVENT SELECTION PROMPTING MODULE          *
                       '
AHLTPMT  CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'AHLTPMT   73.240'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @11,0                                               0001
@PSTART  LA    @12,4095(,@11)                                      0001
         USING @PSTART,@11                                         0001
         USING @PSTART+4095,@12                                    0001
         ST    @13,@SA00001+4                                      0001
         LA    @14,@SA00001                                        0001
         ST    @14,8(,@13)                                         0001
         LR    @13,@14                                             0001
*                                                                  0053
*/********************************************************************/
*/*                                                                  */
*/* INITIALIZATION                                                   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0053
*   ENDPTRS=ENDPTRS&&ENDPTRS;       /* CLEAR DEV TBL ENDPTRS:      0053
*                                      IOEND,SIOEND,SVCEND, PIEND  0053
*                                                              Y02014*/
*                                                                  0053
         XC    ENDPTRS(16),ENDPTRS                                 0053
*/********************************************************************/
*/*                                                                  */
*/* GET THE MESSAGE TEXT FOR AHL101A AND BUILD THE DETAIL PORTION    */
*/* WHILE GETTING CORE FOR THE NECESSARY FILTER TABLES               */
*/*                                                                  */
*/********************************************************************/
*                                                                  0054
*   ICTMSGX=2;                      /* SET THE INDEX FOR MSG #     0054
*                                      AHL101A                       */
         L     @10,INITPTR(,PCTPTR)                                0054
         MVI   ICTMSGX(@10),X'02'                                  0054
*   TWTBUF(1:152)='';               /* BLANK OUT MSG BUFFER    Y02014*/
         MVI   TWTBUF(@10),C' '                                    0055
         MVC   TWTBUF+1(151,@10),TWTBUF(@10)                       0055
*   CALL AHLCTL2;                   /* THEN BRANCH TO AHLCTL2 WHICH
*                                      WILL PUT THE MSG INDICATED  0056
*                                      INTO THE BUFFER INDICATED   0056
*                                                              Y02014*/
         L     @15,@CV00346                                        0056
         BALR  @14,@15                                             0056
*   MSGPTR=ADDR(TWTBUF)+WTOLEN+8;   /* SET THIS POINTER TO THE END OF
*                                      THE MSG WHICH IS IN WTO FORMAT
*                                      & BEGINS 8 BYTES INTO THE   0057
*                                      BUFFER                        */
         L     @10,INITPTR(,PCTPTR)                                0057
         LA    MSGPTR,TWTBUF(,@10)                                 0057
         LH    @15,WTOLEN(,@10)                                    0057
         AR    MSGPTR,@15                                          0057
         AH    MSGPTR,@CH00038                                     0057
*   TWTWORK(1:4)=RTDCODE;           /* SAVE THE ROUT&DESC CODES THAT
*                                      ARE AT THE END OF THE WTO MSG
*                                      SO THAT THEY CAN BE RESTORED
*                                      AFTER THE MSG HAS BEEN ADDED
*                                      TO                            */
         MVC   TWTWORK(4,@10),RTDCODE(MSGPTR)                      0058
*                                                                  0059
*/********************************************************************/
*/*                                                                  */
*/* IF THE IO BIT IS ON ADD TO THE MESSAGE TEXT 'IO=,' AND GET CORE  */
*/* FOR THE IO EBCDIC  TABLE                                         */
*/*                                                                  */
*/********************************************************************/
*                                                                  0059
*   IF GTFIOP='0'B                  /* IS THERE TO BE ANY IO       0059
*                                      PROMPTING?              Y02014*/
*     THEN                          /* NO IO PROMPTING               */
         TM    GTFIOP(@10),B'00000001'                             0059
         BZ    @RT00059                                            0059
*     GO TO PMT01;                  /* SO GO TEST FOR SIO            */
*   MESSAGE(1:7)=PMTAB(1);          /* YES SO PLACE IO= INTO THE MSG
*                                      TO INDICATE IT IS EXPECTED    */
         MVC   MESSAGE(7,MSGPTR),PMTAB                             0061
*   MESSAGE(4)=',';                 /* PUT IN A COMMA                */
         MVI   MESSAGE+3(MSGPTR),C','                              0062
*   MSGPTR=MSGPTR+4;                /* MOVE THE POINTER TO THE NEW 0063
*                                      END OF THE MSG                */
         LA    @14,4                                               0063
         AR    MSGPTR,@14                                          0063
*   WTOLEN=WTOLEN+4;                /* INCREASE THE 2 BYTE MSG LENGTH
*                                      FIELD AT THE BEGINNING OF THE
*                                      MSG                           */
*                                                                  0064
         AR    @15,@14                                             0064
         STH   @15,WTOLEN(,@10)                                    0064
*/* PERFORM GETMAIN FOR IO EBCDIC  TABLE                       Y02014*/
*                                                                  0065
*   RFY                                                            0065
*     RETCODE RSTD;                                                0065
*   DO;                             /* GETMAIN (EC) LV(153)        0066
*                                      A(GETFREE) SP(0) RTCD(RETCODE)*/
*     RESPECIFY                                                    0067
*      (GPR01P,                                                    0067
*       GPR15F)RESTRICTED;                                         0067
*     I004=I004&&I004;              /* INIT LIST                     */
         XC    I004(10),I004                                       0068
*     I00404='20'X;                 /* TYPE                          */
         MVI   I00404,X'20'                                        0069
*     I00401=153;                   /* LENGTH                        */
         MVC   I00401(4),@CF00406                                  0070
*     I00403=ADDR(GETFREE);         /* ADDR OF ADDR LIST             */
         LA    @14,GETFREE                                         0071
         STCM  @14,7,I00403                                        0071
*     I00405=0;                     /* SUBPOOL VALUE                 */
         MVI   I00405,X'00'                                        0072
*     GPR01P=ADDR(I004);            /* REG1 POINTS TO LIST           */
         LA    GPR01P,I004                                         0073
*     SVC(4);                       /* STANDARD-FORM OF GETMAIN      */
         SVC   4                                                   0074
*     RETCODE=GPR15F;               /* SET RETURN CODE               */
*     RESPECIFY                                                    0076
*      (GPR01P,                                                    0076
*       GPR15F)UNRESTRICTED;                                       0076
*   END;                            /* GETMAIN (EC) LV(153)        0077
*                                      A(GETFREE) SP(0) RTCD(RETCODE)*/
*                                   /* Y02014                        */
*   IF RETCODE^=0                   /* DID GETMAIN GO OK       Y02014*/
*     THEN                                                         0078
         LTR   RETCODE,RETCODE                                     0078
         BZ    @RF00078                                            0078
*     DO;                           /* NO                      Y02014*/
*       ICTMSGX=28;                 /* SET INDEX FOR MSG AHL130I   0080
*                                                              Y02014*/
         L     @14,INITPTR(,PCTPTR)                                0080
         MVI   ICTMSGX(@14),X'1C'                                  0080
*       ICTIOTYP=2;                 /* SET IO TYPE WTO         Y02014*/
         MVI   ICTIOTYP(@14),X'02'                                 0081
*       CALL AHLTIO;                /* PRINT MSG               Y02014*/
         L     @15,@CV00303                                        0082
         BALR  @14,@15                                             0082
*       GO TO PMT71;                /* SET RETURN CODE AND EXIT    0083
*                                                              Y02014*/
         B     PMT71                                               0083
*     END;                                                         0084
*   RFY                                                            0085
*     RETCODE UNRSTD;                                              0085
@RF00078 DS    0H                                                  0086
*   IOTAB=GETFREE;                  /* GETMAIN OK SO PLACE ADDR OF 0086
*                                      STORAGE IN INITDATA     Y02014*/
         L     @10,GETFREE                                         0086
         L     @05,INITPTR(,PCTPTR)                                0086
         ST    @10,IOTAB(,@05)                                     0086
*   OPPTR=GETFREE;                  /* SET THE POINTER FOR THE TABLE
*                                      CURRENTLY BEING WORKED ON   0087
*                                                              Y02014*/
*                                                                  0087
         LR    OPPTR,@10                                           0087
*/* THE FOLLOWING STATEMENT ZEROS OUT THE IO EBCDIC TABLE      Y02014*/
*                                                                  0088
*   ENTRYTBL(1:153)=ENTRYTBL(1:153)&&ENTRYTBL(1:153);              0088
         XC    ENTRYTBL(153,OPPTR),ENTRYTBL(OPPTR)                 0088
*   IOFTPTR=OPPTR;                  /* SET THE POINTER THAT POINTS TO
*                                      THE NEXT SLOT I IN THE TABLE
*                                      TO BE FILLED TO THE BEGINNING
*                                      OF THE TABLE                  */
         ST    OPPTR,IOFTPTR                                       0089
*   IOEND=OPPTR;                    /* INITIALIZE THE RESET POINTER
*                                      THE SAME                      */
         ST    OPPTR,IOEND                                         0090
*   ENTRYTBL(151:153)=ELIND;        /* PLACE THE END OF LIST FLAGS IN
*                                      THE LAST SLOT IN THE TABLE    */
         MVC   ENTRYTBL+150(3,OPPTR),ELIND                         0091
*                                                                  0092
*/********************************************************************/
*/*                                                                  */
*/* IF THE SIO BIT IS ON ADD TO THE MESSAGE TEXT 'SIO=,' AND GET CORE*/
*/* FOR THE SIO EBCDIC  TABLE                                        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0092
*PMT01:                                                            0092
*   IF GTFSIOP='0'B                 /* IS THERE TO BE ANY SIO      0092
*                                      PROMPTING?              Y02014*/
*     THEN                          /* NO THERE ISN'T SO             */
PMT01    L     @10,INITPTR(,PCTPTR)                                0092
         TM    GTFSIOP(@10),B'00010000'                            0092
         BZ    @RT00092                                            0092
*     GO TO PMT02;                  /* GO TEST FOR SVC               */
*   MESSAGE(1:7)=PMTAB(2);          /* ADD SIO= TO THE END OF THE MSG
*                                      TEXT                          */
         MVC   MESSAGE(7,MSGPTR),PMTAB+7                           0094
*   MESSAGE(5)=',';                 /* PUT IN A COMMA                */
         MVI   MESSAGE+4(MSGPTR),C','                              0095
*   MSGPTR=MSGPTR+5;                /* MOVE THE POINTER OUT TO THE 0096
*                                      NEW MSG END                   */
         LA    @15,5                                               0096
         AR    MSGPTR,@15                                          0096
*   WTOLEN=WTOLEN+5;                /* INCREMENT THE 2 BYTE WTO    0097
*                                      LENGTH FIELD                  */
*                                                                  0097
         AH    @15,WTOLEN(,@10)                                    0097
         STH   @15,WTOLEN(,@10)                                    0097
*/* PERFORM GETMAIN FOR SIO EBCDIC TABLE                       Y02014*/
*                                                                  0098
*   RFY                                                            0098
*     RETCODE RSTD;                                                0098
*   DO;                             /* GETMAIN (EC) LV(153)        0099
*                                      A(GETFREE) SP(0) RTCD(RETCODE)*/
*     RESPECIFY                                                    0100
*      (GPR01P,                                                    0100
*       GPR15F)RESTRICTED;                                         0100
*     I004=I004&&I004;              /* INIT LIST                     */
         XC    I004(10),I004                                       0101
*     I00404='20'X;                 /* TYPE                          */
         MVI   I00404,X'20'                                        0102
*     I00401=153;                   /* LENGTH                        */
         MVC   I00401(4),@CF00406                                  0103
*     I00403=ADDR(GETFREE);         /* ADDR OF ADDR LIST             */
         LA    @14,GETFREE                                         0104
         STCM  @14,7,I00403                                        0104
*     I00405=0;                     /* SUBPOOL VALUE                 */
         MVI   I00405,X'00'                                        0105
*     GPR01P=ADDR(I004);            /* REG1 POINTS TO LIST           */
         LA    GPR01P,I004                                         0106
*     SVC(4);                       /* STANDARD-FORM OF GETMAIN      */
         SVC   4                                                   0107
*     RETCODE=GPR15F;               /* SET RETURN CODE               */
*     RESPECIFY                                                    0109
*      (GPR01P,                                                    0109
*       GPR15F)UNRESTRICTED;                                       0109
*   END;                            /* GETMAIN (EC) LV(153)        0110
*                                      A(GETFREE) SP(0) RTCD(RETCODE)*/
*   IF RETCODE^=0                   /* DID GETMAIN GO OK       Y02014*/
*     THEN                                                         0111
         LTR   RETCODE,RETCODE                                     0111
         BZ    @RF00111                                            0111
*     DO;                           /* NO                      Y02014*/
*       ICTMSGX=28;                 /* SET INDEX FOR MSG AHL130I   0113
*                                                              Y02014*/
         L     @14,INITPTR(,PCTPTR)                                0113
         MVI   ICTMSGX(@14),X'1C'                                  0113
*       ICTIOTYP=2;                 /* SET IO TYPE WTO         Y02014*/
         MVI   ICTIOTYP(@14),X'02'                                 0114
*       CALL AHLTIO;                /* PRINT MSG               Y02014*/
         L     @15,@CV00303                                        0115
         BALR  @14,@15                                             0115
*       GO TO PMT71;                /* SET RETURN CODE AND EXIT    0116
*                                                              Y02014*/
         B     PMT71                                               0116
*     END;                                                         0117
*   RFY                                                            0118
*     RETCODE UNRSTD;                                              0118
@RF00111 DS    0H                                                  0119
*   SIOTAB=GETFREE;                 /* GETMAIN OK SO PLACE ADDR OF 0119
*                                      STORAGE IN INITDATA     Y02014*/
         L     @10,GETFREE                                         0119
         L     @05,INITPTR(,PCTPTR)                                0119
         ST    @10,SIOTAB(,@05)                                    0119
*   OPPTR=GETFREE;                  /* SET THE POINTER FOR THE TABLE
*                                      CURRENTLY BEING WORKED ON   0120
*                                                              Y02014*/
*                                                                  0120
         LR    OPPTR,@10                                           0120
*/* THE FOLLOWING STATEMENT ZEROS OUT THE SIO EBCDIC TABLE     Y02014*/
*                                                                  0121
*   ENTRYTBL(1:153)=ENTRYTBL(1:153)&&ENTRYTBL(1:153);              0121
         XC    ENTRYTBL(153,OPPTR),ENTRYTBL(OPPTR)                 0121
*   SIOFTPTR=OPPTR;                 /* INITIALIZE THIS POINTER TO THE
*                                      NEXT AVAILABLE SLOT IN THE SIO
*                                      F.T.                          */
         ST    OPPTR,SIOFTPTR                                      0122
*   SIOEND=OPPTR;                   /* INITIALIZE THE RESET POINTER
*                                      THE SAME                      */
         ST    OPPTR,SIOEND                                        0123
*   ENTRYTBL(151:153)=ELIND;        /* PUT THE END OF TABLE FLAG IN
*                                      THE TABLE                     */
         MVC   ENTRYTBL+150(3,OPPTR),ELIND                         0124
*                                                                  0125
*/********************************************************************/
*/*                                                                  */
*/* IF THE SVC BIT IS ON ADD TO THE MESSAGE TEXT 'SVC=,' AND GET CORE*/
*/* FOR THE SVC EBCDIC  TABLE                                        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0125
*PMT02:                                                            0125
*   IF GTFSVCP='0'B                 /* IS THERE TO BE ANY SVC      0125
*                                      PROMPTING               Y02014*/
*     THEN                          /* NO THERE ISN'T SO             */
PMT02    L     @10,INITPTR(,PCTPTR)                                0125
         TM    GTFSVCP(@10),B'01000000'                            0125
         BZ    @RT00125                                            0125
*     GO TO PMT03;                  /* GO TEST FOR PI                */
*   MESSAGE(1:7)=PMTAB(3);          /* YES THERE IS SO ADD SVC= TO 0127
*                                      THE MSG                       */
         MVC   MESSAGE(7,MSGPTR),PMTAB+14                          0127
*   MESSAGE(5)=',';                 /* PUT IN A COMMA                */
         MVI   MESSAGE+4(MSGPTR),C','                              0128
*   MSGPTR=MSGPTR+5;                /* INCREMENT THE POINTER TO THE
*                                      NEW END OF THE MESSAGE        */
         LA    @15,5                                               0129
         AR    MSGPTR,@15                                          0129
*   WTOLEN=WTOLEN+5;                /* INCREASE THE MESSAGE LENGTH 0130
*                                      FIELD IN THE WTO MSG FORMAT   */
*                                                                  0130
         AH    @15,WTOLEN(,@10)                                    0130
         STH   @15,WTOLEN(,@10)                                    0130
*/* PERFORM GETMAIN FOR SVC EBCDIC TABLE                       Y02014*/
*                                                                  0131
*   RFY                                                            0131
*     RETCODE RSTD;                                                0131
*   DO;                             /* GETMAIN (EC) LV(153)        0132
*                                      A(GETFREE) SP(0) RTCD(RETCODE)*/
*     RESPECIFY                                                    0133
*      (GPR01P,                                                    0133
*       GPR15F)RESTRICTED;                                         0133
*     I004=I004&&I004;              /* INIT LIST                     */
         XC    I004(10),I004                                       0134
*     I00404='20'X;                 /* TYPE                          */
         MVI   I00404,X'20'                                        0135
*     I00401=153;                   /* LENGTH                        */
         MVC   I00401(4),@CF00406                                  0136
*     I00403=ADDR(GETFREE);         /* ADDR OF ADDR LIST             */
         LA    @14,GETFREE                                         0137
         STCM  @14,7,I00403                                        0137
*     I00405=0;                     /* SUBPOOL VALUE                 */
         MVI   I00405,X'00'                                        0138
*     GPR01P=ADDR(I004);            /* REG1 POINTS TO LIST           */
         LA    GPR01P,I004                                         0139
*     SVC(4);                       /* STANDARD-FORM OF GETMAIN      */
         SVC   4                                                   0140
*     RETCODE=GPR15F;               /* SET RETURN CODE               */
*     RESPECIFY                                                    0142
*      (GPR01P,                                                    0142
*       GPR15F)UNRESTRICTED;                                       0142
*   END;                            /* GETMAIN (EC) LV(153)        0143
*                                      A(GETFREE) SP(0) RTCD(RETCODE)*/
*   IF RETCODE^=0                   /* DID GETMAIN GO OK       Y02014*/
*     THEN                                                         0144
         LTR   RETCODE,RETCODE                                     0144
         BZ    @RF00144                                            0144
*     DO;                           /* NO                      Y02014*/
*       ICTMSGX=28;                 /* SET INDEX FOR MSG AHL130I   0146
*                                                              Y02014*/
         L     @14,INITPTR(,PCTPTR)                                0146
         MVI   ICTMSGX(@14),X'1C'                                  0146
*       ICTIOTYP=2;                 /* SET IO TYPE WTO         Y02014*/
         MVI   ICTIOTYP(@14),X'02'                                 0147
*       CALL AHLTIO;                /* PRINT MSG               Y02014*/
         L     @15,@CV00303                                        0148
         BALR  @14,@15                                             0148
*       GO TO PMT71;                /* SET RETURN CODE AND EXIT    0149
*                                                              Y02014*/
         B     PMT71                                               0149
*     END;                                                         0150
*   RFY                                                            0151
*     RETCODE UNRSTD;                                              0151
@RF00144 DS    0H                                                  0152
*   SVCTAB=GETFREE;                 /* GETMAIN OK SO PLACE ADDR OF 0152
*                                      STORAGE IN INITDATA     Y02014*/
         L     @10,GETFREE                                         0152
         L     @05,INITPTR(,PCTPTR)                                0152
         ST    @10,SVCTAB(,@05)                                    0152
*   OPPTR=GETFREE;                  /* SET THE POINTER FOR THE TABLE
*                                      CURRENTLY BEING WORKED ON   0153
*                                                              Y02014*/
*                                                                  0153
         LR    OPPTR,@10                                           0153
*/* THE FOLLOWING STATEMENT ZEROS OUT THE SVC EBCDIC TABLE     Y02014*/
*                                                                  0154
*   ENTRYTBL(1:153)=ENTRYTBL(1:153)&&ENTRYTBL(1:153);              0154
         XC    ENTRYTBL(153,OPPTR),ENTRYTBL(OPPTR)                 0154
*   SVCFIPTR=OPPTR;                 /* INITIALIZE THE PTR TO THE NEXT
*                                      EMPTY SLOT IN THE TABLE       */
         ST    OPPTR,SVCFIPTR                                      0155
*   SVCEND=OPPTR;                   /* AND INITIALIZE THE RESET PTR
*                                      THE SAME                      */
         ST    OPPTR,SVCEND                                        0156
*   ENTRYTBL(151:153)=ELIND;        /* PUT THE END OF TABLE FLAG AT
*                                      THE END                       */
         MVC   ENTRYTBL+150(3,OPPTR),ELIND                         0157
*                                                                  0158
*/********************************************************************/
*/*                                                                  */
*/* IF THE PI BIT IS ON ADD TO THE MESSAGE TEXT 'PI=,' AND GET CORE  */
*/* FOR THE PI EBCDIC  TABLE                                         */
*/*                                                                  */
*/********************************************************************/
*                                                                  0158
*PMT03:                                                            0158
*   IF GTFPIP='0'B                  /* IS THERE TO BE PI PROMTING? 0158
*                                                              Y02014*/
*     THEN                          /* NO PI PROMPTING SO            */
PMT03    L     @10,INITPTR(,PCTPTR)                                0158
         TM    GTFPIP(@10),B'00000100'                             0158
         BZ    @RT00158                                            0158
*     GO TO PMT04;                  /* GO TEST FOR IO=SIO            */
*   MESSAGE(1:7)=PMTAB(4);          /* YES THERE IS SO ADD PI= TO THE
*                                      END OF THE WTO MSG IN THE   0160
*                                      BUFFER                        */
         MVC   MESSAGE(7,MSGPTR),PMTAB+21                          0160
*   MESSAGE(4)=',';                 /* PUT IN A COMMA                */
         MVI   MESSAGE+3(MSGPTR),C','                              0161
*   MSGPTR=MSGPTR+4;                /* MOVE THE PTR TO THE NEW END OF
*                                      THE MSG                       */
         LA    @15,4                                               0162
         AR    MSGPTR,@15                                          0162
*   WTOLEN=WTOLEN+4;                /* AND INCREMENT THE 2 BYTE WTO
*                                      LENGTH FIELD BY 4             */
*                                                                  0163
         AH    @15,WTOLEN(,@10)                                    0163
         STH   @15,WTOLEN(,@10)                                    0163
*/* PERFORM GETMAIN FOR PI EBCDIC  TABLE                       Y02014*/
*                                                                  0164
*   RFY                                                            0164
*     RETCODE RSTD;                                                0164
*   DO;                             /* GETMAIN (EC) LV(60) A(GETFREE)
*                                      SP(0) RTCD(RETCODE)           */
*     RESPECIFY                                                    0166
*      (GPR01P,                                                    0166
*       GPR15F)RESTRICTED;                                         0166
*     I004=I004&&I004;              /* INIT LIST                     */
         XC    I004(10),I004                                       0167
*     I00404='20'X;                 /* TYPE                          */
         MVI   I00404,X'20'                                        0168
*     I00401=60;                    /* LENGTH                        */
         MVC   I00401(4),@CF00420                                  0169
*     I00403=ADDR(GETFREE);         /* ADDR OF ADDR LIST             */
         LA    @14,GETFREE                                         0170
         STCM  @14,7,I00403                                        0170
*     I00405=0;                     /* SUBPOOL VALUE                 */
         MVI   I00405,X'00'                                        0171
*     GPR01P=ADDR(I004);            /* REG1 POINTS TO LIST           */
         LA    GPR01P,I004                                         0172
*     SVC(4);                       /* STANDARD-FORM OF GETMAIN      */
         SVC   4                                                   0173
*     RETCODE=GPR15F;               /* SET RETURN CODE               */
*     RESPECIFY                                                    0175
*      (GPR01P,                                                    0175
*       GPR15F)UNRESTRICTED;                                       0175
*   END;                            /* GETMAIN (EC) LV(60) A(GETFREE)
*                                      SP(0) RTCD(RETCODE)           */
*   IF RETCODE^=0                   /* DID GETMAIN GO OK       Y02014*/
*     THEN                                                         0177
         LTR   RETCODE,RETCODE                                     0177
         BZ    @RF00177                                            0177
*     DO;                           /* NO                      Y02014*/
*       ICTMSGX=28;                 /* SET INDEX FOR MSG AHL130I   0179
*                                                              Y02014*/
         L     @14,INITPTR(,PCTPTR)                                0179
         MVI   ICTMSGX(@14),X'1C'                                  0179
*       ICTIOTYP=2;                 /* SET IO TYPE WTO         Y02014*/
         MVI   ICTIOTYP(@14),X'02'                                 0180
*       CALL AHLTIO;                /* PRINT MSG               Y02014*/
         L     @15,@CV00303                                        0181
         BALR  @14,@15                                             0181
*       GO TO PMT71;                /* SET RETURN CDE AND EXIT Y02014*/
         B     PMT71                                               0182
*     END;                                                         0183
*   RFY                                                            0184
*     RETCODE UNRSTD;                                              0184
@RF00177 DS    0H                                                  0185
*   PITAB=GETFREE;                  /* GETMAIN OK SO PLACE ADDR OF 0185
*                                      STORAGE IN INITDATA     Y02014*/
         L     @10,GETFREE                                         0185
         L     @05,INITPTR(,PCTPTR)                                0185
         ST    @10,PITAB(,@05)                                     0185
*   OPPTR=GETFREE;                  /* SET THE POINTER FOR THE TABLE
*                                      CURRENTLY BEING WORKED ON   0186
*                                                              Y02014*/
*                                                                  0186
         LR    OPPTR,@10                                           0186
*/* THE FOLLOWING STATEMENT ZEROS OUT THE PI EBCDIC TABLE      Y02014*/
*                                                                  0187
*   ENTRYTBL(1:60)=ENTRYTBL(1:60)&&ENTRYTBL(1:60);                 0187
         XC    ENTRYTBL(60,OPPTR),ENTRYTBL(OPPTR)                  0187
*   PIFIPTR=OPPTR;                  /* INITIALIZE THE CURRENT ENTRY
*                                      POINTER TO THE NEXT EMPTY SLOT*/
         ST    OPPTR,PIFIPTR                                       0188
*   PIEND=OPPTR;                    /* INITIALIZE THE RESET POINTER
*                                      THE SAME                      */
         ST    OPPTR,PIEND                                         0189
*   ENTRYTBL(58:60)=ELIND;          /* PUT THE END OF TABLE FLAG IN
*                                      AT THE END                    */
         MVC   ENTRYTBL+57(3,OPPTR),ELIND                          0190
*                                                                  0191
*/********************************************************************/
*/*                                                                  */
*/* IF THE IO & SIO BITS ARE ON PUT 'IO=SIO=' INTO THE MESSAGE TEXT  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0191
*PMT04:                                                            0191
*                                                                  0191
*   /*****************************************************************/
*   /*                                                               */
*   /* CAN THERE BE PROMPTING FOR IO=SIO OR SIO=IO?                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0191
*   IF GTFIOP='1'B&GTFSIOP='1'B     /*                         Y02014*/
*     THEN                          /* YES                           */
PMT04    L     @10,INITPTR(,PCTPTR)                                0191
         TM    GTFIOP(@10),B'00010001'                             0191
         BNO   @RF00191                                            0191
*     DO;                           /* YES THERE CAN                 */
*       MESSAGE(1:7)=PMTAB(5);      /* PLACE IO=SIO IN MSG           */
         MVC   MESSAGE(7,MSGPTR),PMTAB+28                          0193
*       MSGPTR=MSGPTR+8;            /* MOVE THE PTR TO THE NEW END OF
*                                      THE MSG                       */
         LA    @15,8                                               0194
         AR    MSGPTR,@15                                          0194
*       WTOLEN=WTOLEN+8;            /* INCREMENT THE WTO MSG LENGTH
*                                      FIELD                         */
         AH    @15,WTOLEN(,@10)                                    0195
         STH   @15,WTOLEN(,@10)                                    0195
*     END;                                                         0196
*                                                                  0196
*/********************************************************************/
*/*                                                                  */
*/* FINISH UP THE MESSAGE INTO WTOR FORMAT                           */
*/*                                                                  */
*/********************************************************************/
*                                                                  0197
*   MSGPTR=MSGPTR-1;                /* MOVE THE END OF MSG PTR BACK 1
*                                      AND                           */
@RF00191 BCTR  MSGPTR,0                                            0197
*   WTOLEN=WTOLEN-1;                /* DECREMENT THE WTO MSG LENGTH
*                                      FIELD 1 SO THAT THE LAST COMMA
*                                      WILL NOT BE WRITTEN OUT       */
         L     @10,INITPTR(,PCTPTR)                                0198
         LH    @00,WTOLEN(,@10)                                    0198
         BCTR  @00,0                                               0198
         STH   @00,WTOLEN(,@10)                                    0198
*   MESSAGE(1:4)=TWTWORK(1:4);      /* RESTORE THE ROUT & DESC SAVED
*                                      FROM THE END OF THE WTOR TEXT
*                                      TO THE NEW END OF THE WTOR    */
         MVC   MESSAGE(4,MSGPTR),TWTWORK(@10)                      0199
*   ICTMSGX='FF'X;                  /* INDICATE THAT IT IS TO BE   0200
*                                      WRITTEN OUT                   */
         MVI   ICTMSGX(@10),X'FF'                                  0200
*                                                                  0201
*/********************************************************************/
*/*                                                                  */
*/* CHECK TO SEE IF THE INPUT IS FROM PARMLIB OR FROM THE CONSOLE    */
*/* IF IT IS FROM PARMLIB DON'T WRITE OUT THE MSG                    */
*/*                                                                  */
*/********************************************************************/
*                                                                  0201
*PMT06:                                                            0201
*                                                                  0201
*   /*****************************************************************/
*   /*                                                               */
*   /* IS THE INPUT TO BE FROM PARMLIB?                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0201
*   IF ICTPLIB='1'B THEN            /* YES                           */
PMT06    L     @10,INITPTR(,PCTPTR)                                0201
         TM    ICTPLIB(@10),B'10000000'                            0201
         BNO   @RF00201                                            0201
*     DO;                           /* YES IT IS FROM PARMLIB        */
*                                                                  0202
*/********************************************************************/
*/*                                                                  */
*/* READ A RECORD FROM PARMLIB INTO ICTBUF AND THEN CHECK FOR AN EOD */
*/* ON THE READ OR AN I/O ERROR                                      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0203
*PMT59:                                                            0203
*       ICTIOTYP=3;                 /* INDICATE THAT A RECORD IS TO
*                                      BE GOTTEN FROM PARMLIB        */
PMT59    L     @10,INITPTR(,PCTPTR)                                0203
         MVI   ICTIOTYP(@10),X'03'                                 0203
*       CALL AHLTIO;                /* THEN CALL THE ROUTINE THAT  0204
*                                      DOES THE I/O            Y02014*/
*                                                                  0204
         L     @15,@CV00303                                        0204
         BALR  @14,@15                                             0204
*       /*************************************************************/
*       /*                                                           */
*       /* HAS THE STOP/MODIFY ECB BEEN POSTED?                      */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0205
*       IF ICTSTOP='1'B THEN        /* YES                           */
         L     @10,INITPTR(,PCTPTR)                                0205
         TM    ICTSTOP(@10),B'00000100'                            0205
         BO    @RT00205                                            0205
*         GO TO PMT70;              /* YES RETURN A CODE OF 12       */
*                                                                  0206
*       /*************************************************************/
*       /*                                                           */
*       /* WAS THERE AN EOD ON THE READ FROM PARMLIB?                */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0207
*       IF ICTEOD='1'B THEN         /* YES                           */
         TM    ICTEOD(@10),B'00100000'                             0207
         BNO   @RF00207                                            0207
*         DO;                       /* YES THERE WAS SO              */
*           EODIND=2;               /* SET THE INDICATOR AS IF AN  0209
*                                      'END' HAD BEEN READ AND       */
         MVI   EODIND,X'02'                                        0209
*           GO TO PMT46;            /* GO TO UPDATE THE RESET      0210
*                                      POINTERS & FINISH OFF THE   0210
*                                      TABLES                        */
         B     PMT46                                               0210
*         END;                                                     0211
*                                                                  0211
*       /*************************************************************/
*       /*                                                           */
*       /* IF THIS IS NOT THE EOD THEN WAS THERE A READ ERROR?       */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0212
*       IF ICTIOERR='1'B THEN       /* YES THERE WAS AN ERROR WHICH
*                                      MEANS THE INPUT PARMLIB CANNOT
*                                      BE USED FOR PROMPTING SO      */
@RF00207 L     @10,INITPTR(,PCTPTR)                                0212
         TM    ICTIOERR(@10),B'01000000'                           0212
         BO    @RT00212                                            0212
*         GO TO PMT69;              /* GIVE THE OPERATOR A CHANCE TO
*                                      DO THE PROMPTS FROM THE     0213
*                                      CONSOLE                       */
*     END;                                                         0214
*   ELSE                            /* NO                            */
*     DO;                           /* NO INPUT IS TO BE FROM THE  0215
*                                      CONSOLE                       */
*                                                                  0215
         B     @RC00201                                            0215
@RF00201 DS    0H                                                  0216
*/********************************************************************/
*/*                                                                  */
*/* THIS IS INPUT FROM THE CONSOLE SO SET THE TABLE POINTERS BACK TO */
*/* THE LAST ENTRIES MADE INTO THE TABLES FROM THE LAST SUCESSFUL    */
*/* INPUT PARAMETERS AND THEN ISSUE A WTOR REQUESTING FUTHER TRACE   */
*/* DEFINITION.  THIS IS NOT NEEDED FOR PARMLIB INPUT BECAUSE IF AN  */
*/* ERROR IS MADE ON INPUT FROM PARMLIB NO ATTEMPT IS MADE TO RECOVER*/
*/* INSTEAD THE RETRY BIT IS SET AND PROMPTING IS STARTED OVER FROM  */
*/* THE CONSOLE                                                      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0216
*PMT61:                                                            0216
*       IOFTPTR=IOEND;              /* SINCE THE INPUT IS TO BE FROM
*                                      THE CONSOLE TABLE POINTERS  0216
*                                      MUST BE RESET                 */
PMT61    MVC   IOFTPTR(4),IOEND                                    0216
*       SIOFTPTR=SIOEND;            /* TO THE LAST VALID ENTRIES MADE
*                                      INTO ANY OF THE 4 TABLES THAT
*                                      IS AN ERROR WAS MADE MADE THE
*                                      BAD                           */
         MVC   SIOFTPTR(4),SIOEND                                  0217
*       SVCFIPTR=SVCEND;            /* ENTRIES CAN BE IGNORED. SO  0218
*                                      HERE THE POINTERS TO LAST   0218
*                                      ENTRIES MADE ARE              */
         MVC   SVCFIPTR(4),SVCEND                                  0218
*       PIFIPTR=PIEND;              /* RESET TO THE LAST VALID ENTRY */
         MVC   PIFIPTR(4),PIEND                                    0219
*       ICTIOTYP=1;                 /* NOW PREPARE TO WRITE OUT THE
*                                      NEXT PROMPTING MESSAGE (WTOR) */
         L     @10,INITPTR(,PCTPTR)                                0220
         MVI   ICTIOTYP(@10),X'01'                                 0220
*       CALL AHLTIO;                /* AND BRANCH TO THE ROUTINE THAT
*                                      DOES I/O                Y02014*/
*                                                                  0221
         L     @15,@CV00303                                        0221
         BALR  @14,@15                                             0221
*       /*************************************************************/
*       /*                                                           */
*       /* HAS THE STOP/MODIFY ECB BEEN POSTED?                      */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0222
*       IF ICTSTOP='1'B THEN        /* YES                           */
         L     @10,INITPTR(,PCTPTR)                                0222
         TM    ICTSTOP(@10),B'00000100'                            0222
         BO    @RT00222                                            0222
*         GO TO PMT70;              /* YES RETURN A CODE OF 12       */
*     END;                          /* NO                            */
*                                                                  0225
*/********************************************************************/
*/*                                                                  */
*/* SEARCH FOR THE FIRST NONBLANK CHAR AS THE BEGINNING OF THE TEXT  */
*/* AND REQUEST ANOTHER LINE IF THERE IS NO NONBLANK                 */
*/*                                                                  */
*/********************************************************************/
*                                                                  0225
*PMT60:                                                            0225
*   EODIND=0;                       /* SET THE SWITCH TO INDICATE  0225
*                                      THAT THIS IS NOT THE END OF 0225
*                                      ANYTHING                      */
@RC00201 DS    0H                                                  0225
PMT60    MVI   EODIND,X'00'                                        0225
*   DO K=1 TO LENGTH(MSGREPLY);     /* SEARCH FOR THE FIRST NONBLANK
*                                      CHAR IN THE MSG BUFFER  Y02014*/
         LA    K,1                                                 0226
@DL00226 DS    0H                                                  0227
*     IF MSGREPLY(K)^=' '           /* IS THIS A BLANK?        Y02014*/
*       THEN                        /* NO SO IT MUST BE THE BEGINNING
*                                      OF THE TEXT                   */
         L     @10,INITPTR(,PCTPTR)                                0227
         ALR   @10,K                                               0227
         CLI   MSGREPLY-1(@10),C' '                                0227
         BNE   @RT00227                                            0227
*       GO TO PMT07;                /* SO LEAVE THE LOOP             */
*   END;                            /* YES IT IS A BLANK SO CONTINUE
*                                      THE LOOP                      */
         AH    K,@CH00041                                          0229
         CH    K,@CH00230                                          0229
         BNH   @DL00226                                            0229
*   ICTMSGX=3;                      /* NO NONBLANK WAS FOUND SO    0230
*                                      PROMPT AGAIN FOR ANOTHER LINE
*                                      OF TEXT                 Y02014*/
         L     @10,INITPTR(,PCTPTR)                                0230
         MVI   ICTMSGX(@10),X'03'                                  0230
*   GO TO PMT06;                    /* GO DO THE I/O                 */
         B     PMT06                                               0231
*PMT07:                             /* EXIT FROM LOOP                */
*   KWPSN=K;                        /* SAVE THE POSITION OF THE FIRST
*                                      NONBLANK CHAR AS THE BEGINNING
*                                      OF THE FIRST KEYWORD          */
PMT07    LR    KWPSN,K                                             0232
*                                                                  0233
*/********************************************************************/
*/*                                                                  */
*/* AT THIS POINT IN THE CODE IT IS ASSUMED THAT K (& KWPSN) POINT TO*/
*/* THE BEGINNING OF A KEYWORD.  HERE A LOOP ADVANCES K TO POINT TO  */
*/* THE NEXT '=', WHEN ONE IS FOUND THE TEXT BETWEEN KWPSN & K IS    */
*/* CHECKED TO SEE IF IT IS A VALID KEYWORD; IF NONE IS FOUND AND A  */
*/* BLANK IS TURNED UP INSTEAD THE TEXT BETWEEN KWPSN & K IS CHECKED */
*/* FOR THE STRING 'END' ANYTHING ELSE IS AN ERROR                   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0233
*PMT08:                                                            0233
*   IF MSGREPLY(K)='='              /* IS THIS CHAR '='?       Y02014*/
*     THEN                          /* YES                           */
PMT08    L     @10,INITPTR(,PCTPTR)                                0233
         LR    @06,@10                                             0233
         ALR   @06,K                                               0233
         CLI   MSGREPLY-1(@06),C'='                                0233
         BE    @RT00233                                            0233
*     GO TO PMT10;                  /* YES SO LEAVE THE LOOP         */
*   K=K+1;                          /* NO IT ISN'T SO GO ON TO THE 0235
*                                      NEXT CHAR                     */
*                                                                  0235
         AH    K,@CH00041                                          0235
*   /*****************************************************************/
*   /*                                                               */
*   /* IS THIS CHAR A ' '?                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0236
*   IF MSGREPLY(K)^=' '             /*                         Y02014*/
*     THEN                          /* NO                            */
         LR    @06,@10                                             0236
         ALR   @06,K                                               0236
         CLI   MSGREPLY-1(@06),C' '                                0236
         BNE   @RT00236                                            0236
*     GO TO PMT08;                  /* NO SO CONTINUE THE LOOP       */
*                                                                  0237
*   /*****************************************************************/
*   /*                                                               */
*   /* YES IT IS A BLANK SO ARE THERE ANY MORE THAN 3 CHAR?          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0238
*   IF K-KWPSN^=3 THEN              /* YES                           */
         LR    @06,K                                               0238
         SR    @06,KWPSN                                           0238
         CH    @06,@CH00071                                        0238
         BNE   @RT00238                                            0238
*     GO TO PMT11;                  /* YES SO THERE MUST BE TEXT   0239
*                                      THERE OTHER THAN 'END'; AN  0239
*                                      ERROR WRITE OUT A MSG         */
*                                                                  0239
*   /*****************************************************************/
*   /*                                                               */
*   /* NO IT IS EXACTLY 3 CHAR SO CHECK TO SEE IF THEY ARE 'END'     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0240
*   IF MSGREPLY(KWPSN:KWPSN+2)^='END'/*                        Y02014*/
*     THEN                          /* NO                            */
         ALR   @10,KWPSN                                           0240
         CLC   MSGREPLY-1(3,@10),@CC00444                          0240
         BNE   @RT00240                                            0240
*     GO TO PMT11;                  /* NO; ERROR WRITE OUT MSG 110   */
*   EODIND=2;                       /* YES IT IS A VALID 'END' SO SET
*                                      THE SWITCH TO INDICATE THAT NO
*                                      MORE PROMPTING IS TO BE DONE
*                                      AND THE TABLES SHOULD BE    0242
*                                      FINISHED                      */
         MVI   EODIND,X'02'                                        0242
*   GO TO PMT46;                    /* THEN GO FINISH THEM           */
         B     PMT46                                               0243
*                                                                  0244
*/********************************************************************/
*/*                                                                  */
*/* AN '=' HAS BEEN FOUND SO ISOLATE THE KEYWORD AND THEN COMPARE IT */
*/* WITH THE VALID KEYWORDS IN PMTAB LOOKING FOR A MATCH             */
*/*                                                                  */
*/********************************************************************/
*                                                                  0244
*PMT10:                                                            0244
*   K=K+1;                          /* AN '=' HAS BEEN FOUND       0244
*                                      INCREMENT K TO THE NEXT CHAR
*                                      WHICH SHOULD BE A '(' AND     */
*                                                                  0244
PMT10    LA    @10,1                                               0244
         AR    K,@10                                               0244
*   /*****************************************************************/
*   /*                                                               */
*   /* IS THE KEYWORD OVER 6 CHAR LONG?                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0245
*   IF K-KWPSN>7 THEN               /* YES                           */
         LR    @06,K                                               0245
         SR    @06,KWPSN                                           0245
         CH    @06,@CH00075                                        0245
         BH    @RT00245                                            0245
*     GO TO PMT11;                  /* YES IT IS; ERROR WRITE OUT A
*                                      MSG                           */
*   TEMPKW(1:4)=BLANK;              /* NO IT ISN'T SO                */
         MVC   TEMPKW(4),BLANK                                     0247
*   TEMPKW(5:7)=BLANK(1:3);         /* BLANK OUT A 7 BYTE WORK AREA
*                                      PARM TO TEMP HOLD AREA  Y02014*/
         MVC   TEMPKW+4(3),BLANK                                   0248
*   TEMPKW(1:K-KWPSN)=MSGREPLY(KWPSN:K-1);/* AND PUT THE KEYWORD ONLY
*                                      INTO IT LEFT JUSTIFIED SO IT
*                                      WILL BE SET UP LIKE THE     0249
*                                      KEYWORDS IN PMTAB       Y02014*/
*                                                                  0249
         BCTR  @06,0                                               0249
         L     @15,INITPTR(,PCTPTR)                                0249
         ALR   @15,KWPSN                                           0249
         EX    @06,@SM00580                                        0249
*   /*****************************************************************/
*   /*                                                               */
*   /* SEARCH FOR A MATCH                                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0250
*   DO J=1 TO 6;                                                   0250
*                                                                  0250
         LA    @06,1                                               0250
         LR    J,@06                                               0250
@DL00250 DS    0H                                                  0251
*     /***************************************************************/
*     /*                                                             */
*     /* IS THIS A MATCH?                                            */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0251
*     IF PMTAB(J)=TEMPKW THEN       /* YES                           */
         LR    @06,J                                               0251
         MH    @06,@CH00075                                        0251
         LA    @15,PMTAB-7(@06)                                    0251
         CLC   0(7,@15),TEMPKW                                     0251
         BE    @RT00251                                            0251
*       GO TO PMT12;                /* YES LEAVE THE LOOP            */
*   END;                            /* NO CONTINUE THE LOOP          */
         AH    J,@CH00041                                          0253
         CH    J,@CH00308                                          0253
         BNH   @DL00250                                            0253
*PMT11:                             /* ERROR MSG                     */
*   ICTMSGX=11;                     /* AN INVALID KEYWORD HAS BEEN 0254
*                                      FOUND SO SET THE INDICATER FOR
*                                      MSG AHL110A                   */
PMT11    L     @10,INITPTR(,PCTPTR)                                0254
         MVI   ICTMSGX(@10),X'0B'                                  0254
*   GO TO PMT05;                    /* AND WRITE IT OUT              */
         B     PMT05                                               0255
*                                                                  0256
*/********************************************************************/
*/*                                                                  */
*/* NOW THAT A VALID KEYWORD HAS BEEN IDENTIFIED CHECK WHAT FOLLOWS  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0256
*PMT12:                                                            0256
*   IF MSGREPLY(K)^='('             /* IS THE NEXT CHAR AFTER THE  0256
*                                      KEYWORD A '('?          Y02014*/
*     THEN                          /* NO                            */
PMT12    L     @06,INITPTR(,PCTPTR)                                0256
         LR    @15,@06                                             0256
         ALR   @15,K                                               0256
         CLI   MSGREPLY-1(@15),C'('                                0256
         BE    @RF00256                                            0256
*     DO;                           /* NO THEN IT MIGHT BE 'I' OR 'S'
*                                      IF THE KEYWORD WAS 'SIO=IO='
*                                      OR 'IO=SIO='            Y02014*/
*       IF MSGREPLY(K)='I'          /* IS THIS THE CASE?             */
*           MSGREPLY(K)='S'        /*                         Y02014*/
*         THEN                      /* YES THEN WE'VE IDENTIFIED THE */
         LR    @15,@06                                             0258
         ALR   @15,K                                               0258
         CLI   MSGREPLY-1(@15),C'I'                                0258
         BE    @RT00258                                            0258
         ALR   @06,K                                               0258
         CLI   MSGREPLY-1(@06),C'S'                                0258
         BE    @RT00258                                            0258
*         GO TO PMT08;              /* WRONG KEYWORD BECAUSE WE HAD
*                                      THE WRONG '=' SO GO BACK AND
*                                      SCAN ON TO THE NEXT '=' SIGN  */
*       KWPBEG=K-1;                 /* SINCE THERE IS NO OPENNING '('
*                                      THIS MUST BE A SUBPARM LIST OF
*                                      JUST ONE ENTRY I.E. IO=284 SO
*                                      POINT TO THE '=' AS THE     0260
*                                      BEGINNING                     */
*                                                                  0260
         LR    @00,K                                               0260
         BCTR  @00,0                                               0260
         ST    @00,KWPBEG                                          0260
*       /*************************************************************/
*       /*                                                           */
*       /* SCAN FOR THE NEXT DELIMITER                               */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0261
*       L=K;                        /*                         Y02014*/
         ST    K,L                                                 0261
*       DO K=L TO L+3;              /*                         Y02014*/
*                                                                  0262
         L     @15,L                                               0262
         LR    K,@15                                               0262
         B     @DE00262                                            0262
@DL00262 DS    0H                                                  0263
*         /***********************************************************/
*         /*                                                         */
*         /* CHECK FOR DELIMITER                                     */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0263
*         IF MSGREPLY(K)=','        /* CHECK FOR ','           Y02014*/
*             MSGREPLY(K)=' '      /* OR ' '                  Y02014*/
*           THEN                    /* YES                           */
         L     @15,INITPTR(,PCTPTR)                                0263
         LR    @14,@15                                             0263
         ALR   @14,K                                               0263
         CLI   MSGREPLY-1(@14),C','                                0263
         BE    @RT00263                                            0263
         ALR   @15,K                                               0263
         CLI   MSGREPLY-1(@15),C' '                                0263
         BNE   @RF00263                                            0263
@RT00263 DS    0H                                                  0264
*           DO;                     /* FOUND ONE OF THE DELIMITERS   */
*             KWPEND=K;             /* SAVE THIS AS THE END OF THE 0265
*                                      SUBPARMLIST                   */
         ST    K,KWPEND                                            0265
*             GO TO PMT67;          /* PROCESS THE ONE ENTRY         */
         B     PMT67                                               0266
*           END;                                                   0267
*       END;                                                       0268
@RF00263 AH    K,@CH00041                                          0268
@DE00262 LA    @00,3                                               0268
         A     @00,L                                               0268
         CR    K,@00                                               0268
         BNH   @DL00262                                            0268
*       ICTMSGX=31;                 /* ID OF ERROR MESSAGE     Y02014*/
         L     @03,INITPTR(,PCTPTR)                                0269
         MVI   ICTMSGX(@03),X'1F'                                  0269
*       GO TO PMT20;                /* GO ISSUE ERROR MESSAGE  Y02014*/
         B     PMT20                                               0270
*     END;                                                         0271
*                                                                  0272
*/********************************************************************/
*/*                                                                  */
*/* NOW THAT THE KEYWORD HAS BEEN DETERMIND CHECK THE FOLLOWING      */
*/* SUBPARMLIST FOR VALID GENERAL SYNTAX                             */
*/*                                                                  */
*/********************************************************************/
*                                                                  0272
*   KWPBEG=K;                       /* YES SO ASSUME IT TO BE THE  0272
*                                      BEGINNING OF THE SUBPARMLIST
*                                      AND SAVE THE POINTER TO IT    */
@RF00256 ST    K,KWPBEG                                            0272
*PMT15:                             /* SCAN ON                       */
*   K=K+1;                          /* ADVANCE TO THE NEXT CHAR OF 0273
*                                      THE TEXT                      */
*                                                                  0273
PMT15    AH    K,@CH00041                                          0273
*   /*****************************************************************/
*   /*                                                               */
*   /* IS IT A ' '                                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0274
*   IF MSGREPLY(K)=' '              /*                         Y02014*/
*     THEN                          /* YES                           */
         L     @15,INITPTR(,PCTPTR)                                0274
         LR    @14,@15                                             0274
         ALR   @14,K                                               0274
         CLI   MSGREPLY-1(@14),C' '                                0274
         BNE   @RF00274                                            0274
*     DO;                           /* YES IT IS; ERROR              */
*       ICTMSGX=12;                 /* SET THE MSG INDEX TO AHL111A
*                                      AND                           */
         MVI   ICTMSGX(@15),X'0C'                                  0276
*       GO TO PMT20;                /* GO WRITE IT OUT               */
         B     PMT20                                               0277
*     END;                                                         0278
*                                                                  0278
*   /*****************************************************************/
*   /*                                                               */
*   /* NO THEN IS IT THE END OF THE SUBPARMLIST?                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0279
*   IF MSGREPLY(K)^=')'             /*                         Y02014*/
*     THEN                          /* NO                            */
@RF00274 L     @15,INITPTR(,PCTPTR)                                0279
         ALR   @15,K                                               0279
         CLI   MSGREPLY-1(@15),C')'                                0279
         BNE   @RT00279                                            0279
*     GO TO PMT15;                  /* NO SO GO TRY THE NEXT CHAR IN
*                                      THE TEXT                      */
*   KWPEND=K;                       /* YES THEN SAVE THIS POSITION AS
*                                      THE END OF THE SUPARMLIST     */
         ST    K,KWPEND                                            0281
*                                                                  0282
*/********************************************************************/
*/*                                                                  */
*/* NOW THAT THE ENDS OF THE SUBPARMLIST HAVE BEEN FOUND             */
*/* CHECK TO SEE THAT THE SUBPARMLIST IS FOLLOWED                    */
*/* EITHER BY A BLANK OR A COMMA NONBLANK                            */
*/*                                                                  */
*/********************************************************************/
*                                                                  0282
*   K=K+1;                          /* GO TO THE NEXT CHAR           */
         AH    K,@CH00041                                          0282
*PMT67:                             /* SCAN ON                       */
*                                                                  0283
*   /*****************************************************************/
*   /*                                                               */
*   /* IS IT A COMMA?                                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0283
*   IF MSGREPLY(K)=','              /*                         Y02014*/
*     THEN                          /* YES                           */
PMT67    L     @15,INITPTR(,PCTPTR)                                0283
         LR    @14,@15                                             0283
         ALR   @14,K                                               0283
         CLI   MSGREPLY-1(@14),C','                                0283
         BE    @RT00283                                            0283
*     GO TO PMT13;                  /* YES SO ANOTHER KEYWORD MUST 0284
*                                      FOLLOW                        */
*                                                                  0284
*   /*****************************************************************/
*   /*                                                               */
*   /* NO, THEN IS IT MUST BE A BLANK, IS IT?                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0285
*   IF MSGREPLY(K)^=' '             /*                         Y02014*/
*     THEN                          /* NO                            */
         LR    @14,@15                                             0285
         ALR   @14,K                                               0285
         CLI   MSGREPLY-1(@14),C' '                                0285
         BE    @RF00285                                            0285
*     DO;                           /* NO; ERROR                     */
*       ICTMSGX=8;                  /* SET THE MSG INDEX FOR AHL107A */
         MVI   ICTMSGX(@15),X'08'                                  0287
*       GO TO PMT05;                /* GO WRITE THE MSG              */
         B     PMT05                                               0288
*     END;                                                         0289
*   EODIND=1;                       /* YES IT IS A BLANK SO SET THE
*                                      SWITCH TO INDICATE THAT THIS
*                                      IS THE END OF THE LINE WHEN 0290
*                                      THIS KEYWORD IS PROCESSED     */
@RF00285 MVI   EODIND,X'01'                                        0290
*   GO TO PMT14;                    /* AND THEN GO ON TO PROCESS IT  */
         B     PMT14                                               0291
*PMT13:                             /* COMMA FOUND                   */
*   K=K+1;                          /* YES THE ')' IS FOLLOWED BY A
*                                      ',' WHICH MEANS ANOTHER     0292
*                                      KEYWORD SHOULD FOLLOW. MOVE TO
*                                      THE NEXT CHAR                 */
*                                                                  0292
PMT13    AH    K,@CH00041                                          0292
*   /*****************************************************************/
*   /*                                                               */
*   /* IS THIS A BLANK?                                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0293
*   IF MSGREPLY(K)=' '              /*                         Y02014*/
*     THEN                          /* YES                           */
         L     @15,INITPTR(,PCTPTR)                                0293
         ALR   @15,K                                               0293
         CLI   MSGREPLY-1(@15),C' '                                0293
         BE    @RT00293                                            0293
*     GO TO PMT09;                  /* YES IT IS; ERROR              */
*   NEXTKW=K;                       /* NO IT ISN'T SO SAVE IT AS THE
*                                      NEXT KEYWORD TO BE CHECKED    */
         ST    K,NEXTKW                                            0295
*                                                                  0296
*/********************************************************************/
*/*                                                                  */
*/*         GO PROCESS THE SUBPARAMETERS FOR THIS KEYWORD      Y02014*/
*/*                                                                  */
*/********************************************************************/
*                                                                  0296
*PMT14:                                                            0296
*   GO TO WTGTAB3(J);               /* NO SO USE THE KEYWORD INDEX 0296
*                                      INTO THE BRANCH TABLE TO GO TO
*                                      THE PROPER CODE               */
*                                                                  0296
PMT14    LR    @03,J                                               0296
         SLA   @03,2                                               0296
         L     @03,WTGTAB3-4(@03)                                  0296
         BR    @03                                                 0296
*/********************************************************************/
*/*                                                                  */
*/* IF J=5 OR 6 FOR WTGTAB THE CODE BRANCHES HERE.  THIS IS THE CODE */
*/* FOR THE IO=SIO= & SIO=IO= KEYWORDS                               */
*/*                                                                  */
*/********************************************************************/
*                                                                  0297
*PMT18:                                                            0297
*   IF GTFSIOP='1'B                 /* ARE BOTH IO AND SIO     Y02014*/
*       &GTFIOP='1'B                /* PROMPTING BITS ON?      Y02014*/
*     THEN                          /* YES                           */
PMT18    L     @03,INITPTR(,PCTPTR)                                0297
         TM    GTFSIOP(@03),B'00010001'                            0297
         BNO   @RF00297                                            0297
*     DO;                           /* YES SO THIS KEYWORD IS      0298
*                                      ACCEPTABLE                    */
*       ENTRYPTR=IOFTPTR;           /* SET PTR TO CURRENT ENTRY IN IO
*                                      TBL                           */
         L     ENTRYPTR,IOFTPTR                                    0299
*       OPPTR=IOTAB;                /* SET THE CURRENT TABLE PTR TO
*                                      THE IO TABLE            Y02014*/
         L     OPPTR,IOTAB(,@03)                                   0300
*       PATHSW=1;                   /* SET PATHSW FOR IO=SIO         */
         MVI   PATHSW,X'01'                                        0301
*       GO TO PMT23;                /* GO TO THE COMMON CODE TO    0302
*                                      PROCESS THE ENTRIES           */
         B     PMT23                                               0302
*     END;                                                         0303
*PMT19:                             /* ERROR MSG                     */
*   ICTMSGX=13;                     /* NO THEN IT IS AN INVALID    0304
*                                      KEYWORD FOR THIS PROMPT. ERROR
*                                      MSG AHL112A                   */
@RF00297 DS    0H                                                  0304
PMT19    L     @03,INITPTR(,PCTPTR)                                0304
         MVI   ICTMSGX(@03),X'0D'                                  0304
*PMT20:                             /* ERROR MSG PROCESS             */
*   CALL AHLCTL2;                   /* GET THE MSG TEXT        Y02014*/
PMT20    L     @15,@CV00346                                        0305
         BALR  @14,@15                                             0305
*   MSGPTR=ADDR(TWTBUF)+WTOLEN+2;   /* SET PTR TO END OF MSG -6 BYTES*/
         L     @15,INITPTR(,PCTPTR)                                0306
         LA    MSGPTR,TWTBUF(,@15)                                 0306
         AH    MSGPTR,WTOLEN(,@15)                                 0306
         AH    MSGPTR,@CH00327                                     0306
*   MSG10X(1:6)=PMTAB(J);           /* MOVE THAT KEYWORD INTO THE MSG*/
         LR    @14,J                                               0307
         MH    @14,@CH00075                                        0307
         LA    @09,PMTAB-7(@14)                                    0307
         MVC   MSG10X(6,MSGPTR),0(@09)                             0307
*   ICTMSGX='FF'X;                  /* INDICATE THAT THE MSG IS IN 0308
*                                      THE BUFFER                    */
         MVI   ICTMSGX(@15),X'FF'                                  0308
*   GO TO PMT05;                    /* & GO WRITE OUT THE MSG        */
         B     PMT05                                               0309
*                                                                  0310
*/********************************************************************/
*/*                                                                  */
*/* IF J=1 FOR WTGTAB THE CODE BRANCHES HERE.  THIS IS THE CODE      */
*/* FOR THE IO= KEYWORD                                              */
*/*                                                                  */
*/********************************************************************/
*                                                                  0310
*PMT21:                                                            0310
*   IF GTFIOP='0'B                  /* IS THE IO PROMPTING BIT ON? 0310
*                                                              Y02014*/
*     THEN                          /* NO                            */
PMT21    L     @03,INITPTR(,PCTPTR)                                0310
         TM    GTFIOP(@03),B'00000001'                             0310
         BZ    @RT00310                                            0310
*     GO TO PMT19;                  /* NO; ERROR GO WRITE OUT MSG  0311
*                                      AHL112A                       */
*   ENTRYPTR=IOFTPTR;               /* YES THEN SET THE CURRENT ENTRY
*                                      PTR TO THE NEXT SLOT IN THE IO
*                                      TABLE                         */
         L     ENTRYPTR,IOFTPTR                                    0312
*   OPPTR=IOTAB;                    /* SET THE CURRENT TABLE PTR TO
*                                      THE IO TABLE            Y02014*/
         L     OPPTR,IOTAB(,@03)                                   0313
*   PATHSW=2;                       /* SET THE SWITCH FOR IO=        */
         MVI   PATHSW,X'02'                                        0314
*   GO TO PMT23;                    /* GO TO THE COMMON CODE TO    0315
*                                      PROCESS THE ENTRIES           */
*                                                                  0315
         B     PMT23                                               0315
*/********************************************************************/
*/*                                                                  */
*/* IF J=2 FOR WTGTAB THE CODE BRANCHES HERE.  THIS IS THE CODE      */
*/* FOR THE SIO= KEYWORD                                             */
*/*                                                                  */
*/********************************************************************/
*                                                                  0316
*PMT22:                                                            0316
*   IF GTFSIOP='0'B                 /* IS THE BIT ON FOR SIO       0316
*                                      PROMPTING?              Y02014*/
*     THEN                          /* NO                            */
PMT22    L     @03,INITPTR(,PCTPTR)                                0316
         TM    GTFSIOP(@03),B'00010000'                            0316
         BZ    @RT00316                                            0316
*     GO TO PMT19;                  /* NO; ERROR GO WRITE OUT MSG  0317
*                                      AHL112A                       */
*   ENTRYPTR=SIOFTPTR;              /* SET THE CURRENT ENTRY PTR TO
*                                      THE NEXT EMPTY SLOT IN THE SIO
*                                      TABLE                         */
         L     ENTRYPTR,SIOFTPTR                                   0318
*   OPPTR=SIOTAB;                   /* SET THE CURRENT TABLE PTR TO
*                                      THE SIO TABLE           Y02014*/
         L     OPPTR,SIOTAB(,@03)                                  0319
*   PATHSW=3;                       /* SET THE SWITCH FOR SIO      0320
*                                      PROCESSING                    */
         MVI   PATHSW,X'03'                                        0320
*                                                                  0321
*/********************************************************************/
*/*                                                                  */
*/* THIS IS COMMON CODE USED FOR PROCESSING IO=, SIO=, IO=SIO=, AND  */
*/* SIO=IO= KEYWORDS                                                 */
*/*                                                                  */
*/********************************************************************/
*                                                                  0321
*PMT23:                                                            0321
*   ENDSW=0;                        /* SET THE SWITCH TO INDICATE NOT
*                                      AT THE END OF THE SUBPARMLIST */
PMT23    MVI   ENDSW,X'00'                                         0321
*   KWPSN=KWPBEG;                   /* SAVE THE BEGINNING OF THE   0322
*                                      SUBPARMLIST AS THE BEGINNING
*                                      OF THE FIRST SUBPARM ENTRY    */
*                                                                  0322
         L     @10,KWPBEG                                          0322
         LR    KWPSN,@10                                           0322
*   /*****************************************************************/
*   /*                                                               */
*   /* START THE LOOP THAT SCANS THE WHOLE SUBPARMLIST               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0323
*   DO K=KWPBEG TO KWPEND-1;        /* AND STOPS AT EACH ','         */
         LR    K,@10                                               0323
         B     @DE00323                                            0323
@DL00323 DS    0H                                                  0324
*PMT24:                             /*                               */
*     IF MSGREPLY(K)=','            /* IS THIS CHAR A ','?     Y02014*/
*       THEN                        /* YES                           */
PMT24    L     @10,INITPTR(,PCTPTR)                                0324
         ALR   @10,K                                               0324
         CLI   MSGREPLY-1(@10),C','                                0324
         BE    @RT00324                                            0324
*       GO TO PMT25;                /* YES THEN ONE SUBENTRY SHOULD
*                                      BE ISOLATED LEAVE THE LOOP    */
*   END;                            /* NO CONTINUE THE LOOP          */
         AH    K,@CH00041                                          0326
@DE00323 L     @10,KWPEND                                          0326
         BCTR  @10,0                                               0326
         CR    K,@10                                               0326
         BNH   @DL00323                                            0326
*   ENDSW=1;                        /* LOOP HAS REACHED THE END OF 0327
*                                      THE SUPPARMLIST WHICH IS THE
*                                      SAME AS A COMMA EXCEPT THAT NO
*                                      MORE SUBENTRIES FOLLOW SO SET
*                                      THE SWITCH TO SHOW THAT THERE
*                                      ARE NO MORE                   */
         MVI   ENDSW,X'01'                                         0327
*PMT25:                                                            0328
*   IF K-KWPSN-1=0                  /* CHECK TO SEE THAT THE IS NOT
*                                      NUL (,,)                      */
*     THEN                          /* YES IT IS NUL; ERROR          */
PMT25    LR    @10,K                                               0328
         SR    @10,KWPSN                                           0328
         BCTR  @10,0                                               0328
         LTR   @10,@10                                             0328
         BZ    @RT00328                                            0328
*     GO TO PMT09;                  /* GO WRITE OUT MSG              */
*PMT26:                                                            0330
*   IF K-KWPSN-1^=3                 /* LENGTH IS LESS THAN 0 IS IT 0330
*                                      GREATER THAN 3?               */
*     THEN                                                         0330
PMT26    LR    @10,K                                               0330
         SR    @10,KWPSN                                           0330
         BCTR  @10,0                                               0330
         CH    @10,@CH00071                                        0330
         BE    @RF00330                                            0330
*     DO;                           /* YES IT IS; ERROR              */
*PMT26A:                                                           0332
*       ICTMSGX=10;                 /* SET INDEX FOR MSG AHL109A     */
PMT26A   L     @10,INITPTR(,PCTPTR)                                0332
         MVI   ICTMSGX(@10),X'0A'                                  0332
*       CALL AHLCTL2;               /* GET MSG TEXT            Y02014*/
         L     @15,@CV00346                                        0333
         BALR  @14,@15                                             0333
*       MSGPTR=ADDR(TWTBUF)+WTOLEN+5;/* SET PTR TO END OF MSG -3   0334
*                                      BYTES                         */
*                                                                  0334
         L     @10,INITPTR(,PCTPTR)                                0334
         LA    MSGPTR,TWTBUF(,@10)                                 0334
         AH    MSGPTR,WTOLEN(,@10)                                 0334
         AH    MSGPTR,@CH00273                                     0334
*       /*************************************************************/
*       /*                                                           */
*       /* PLACE FIRST 3 BYTES OF ENTRY INTO MSG TEXT                */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0335
*       MSG10X(1:3)=MSGREPLY(KWPSN+1:KWPSN+3);/*               Y02014*/
         LR    @06,@10                                             0335
         ALR   @06,KWPSN                                           0335
         MVC   MSG10X(3,MSGPTR),MSGREPLY(@06)                      0335
*       ICTMSGX='FF'X;              /* INDICATE MSG IS IN THE BUFFER */
         MVI   ICTMSGX(@10),X'FF'                                  0336
*       GO TO PMT05;                /* GO WRITE OUT THE MSG          */
         B     PMT05                                               0337
*     END;                                                         0338
*   NUMBER=MSGREPLY(KWPSN+1:K-1);   /* THE SUBENTRY IS OF THE CORRECT
*                                      LENGTH SO SAVE IT IN A 3 BYTE
*                                      AREA                    Y02014*/
@RF00330 MVI   NUMBER+1,C' '                                       0339
         MVI   NUMBER+2,C' '                                       0339
         LR    @10,K                                               0339
         SR    @10,KWPSN                                           0339
         BCTR  @10,0                                               0339
         BCTR  @10,0                                               0339
         L     @15,INITPTR(,PCTPTR)                                0339
         ALR   @15,KWPSN                                           0339
         EX    @10,@SM00582                                        0339
*   I=1;                            /* BEGIN LOOP AT THE FIRST ENTRY
*                                      IN THE CURRENT TABLE          */
         LA    I,1                                                 0340
*PMT27:                             /* CHECK FOR KEYWORDS            */
*   IF ENTRYPTR=ADDR(ENTRX(I))      /* IS THE ENTRY INDEXED BY I THE
*                                      SAME ONE AS THE NEXT EMPTY  0341
*                                      ENTRY IN THE TABLE?           */
*     THEN                          /* YES                           */
PMT27    LR    @10,I                                               0341
         MH    @10,@CH00071                                        0341
         LR    @15,OPPTR                                           0341
         AL    @15,@CF00584                                        0341
         LA    @00,ENTRX(@10,@15)                                  0341
         CR    ENTRYPTR,@00                                        0341
         BE    @RT00341                                            0341
*     GO TO PMT28;                  /* YES LEAVE THE LOOP NO       0342
*                                      DUPLICATE ENTRY EXISTS        */
*   IF ENTRX(I)=NUMBER              /* NO THEN CHECK TO SEE IF THESE
*                                      TWO ENTRIES ARE THE SAME      */
*     THEN                          /* YES                           */
         ALR   @10,OPPTR                                           0343
         AL    @10,@CF00584                                        0343
         CLC   ENTRX(3,@10),NUMBER                                 0343
         BE    @RT00343                                            0343
*     GO TO PMT31;                  /* YES THEY ARE THE SAME SO BY 0344
*                                      PASS THIS ONE                 */
*   I=I+1;                          /* NO THEY ARE NOT THE SAME SO GO
*                                      TO THE NEXT ENTRY             */
         AH    I,@CH00041                                          0345
*   GO TO PMT27;                    /* CONTINUE THE LOOP             */
         B     PMT27                                               0346
*                                                                  0347
*   /*****************************************************************/
*   /*                                                               */
*   /* VALIDITY CHECK DEVICE ADDRESS TO ENSURE A VALID HEX NUMBER    */
*   /*                                                         Y02014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0347
*PMT28:                             /* VALIDITY CHECK                */
*   DO L=1 TO 3;                    /* CHECK THE THREE BYTES   Y02014*/
PMT28    LA    @10,1                                               0347
         ST    @10,L                                               0347
@DL00347 DS    0H                                                  0348
*     IF^((NUMBER(L:L)>='A')&       /* VALID EBCDIC A-F        Y02014*/
*         (NUMBER(L:L)<='F')        /*                         Y02014*/
*         (NUMBER(L:L)>='0')&      /* VALID EBCDIC 0-9        Y02014*/
*         (NUMBER(L:L)<='9'))THEN   /*                         Y02014*/
         LA    @15,NUMBER-1(@10)                                   0348
         CLI   0(@15),C'A'                                         0348
         BL    @GL00003                                            0348
         LA    @15,NUMBER-1(@10)                                   0348
         CLI   0(@15),C'F'                                         0348
         BNH   @RF00348                                            0348
@GL00003 L     @10,L                                               0348
         LA    @15,NUMBER-1(@10)                                   0348
         CLI   0(@15),C'0'                                         0348
         BL    @RT00348                                            0348
         LA    @15,NUMBER-1(@10)                                   0348
         CLI   0(@15),C'9'                                         0348
         BH    @RT00348                                            0348
*       GO TO PMT26A;               /* WRITE ERR MSG           Y02014*/
*   END;                                                           0350
@RF00348 LA    @10,1                                               0350
         A     @10,L                                               0350
         ST    @10,L                                               0350
         CH    @10,@CH00071                                        0350
         BNH   @DL00347                                            0350
*PMT30:                             /* ENTER?                        */
*   IF ENTRX(I)=ELIND               /* IS THERE ANY MORE ROOM IN THE
*                                      TABLE?                        */
*     THEN                          /* NO                            */
PMT30    LR    @10,I                                               0351
         MH    @10,@CH00071                                        0351
         ALR   @10,OPPTR                                           0351
         AL    @10,@CF00584                                        0351
         CLC   ENTRX(3,@10),ELIND                                  0351
         BNE   @RF00351                                            0351
*     DO;                           /* NO; ERROR PICK A MSG          */
*                                                                  0352
*       /*************************************************************/
*       /*                                                           */
*       /* DOES THE SWITCH INDICATE SIO PROCESSING?                  */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0353
*       IF PATHSW=3 THEN            /* YES                           */
         CLI   PATHSW,3                                            0353
         BNE   @RF00353                                            0353
*         ICTMSGX=15;               /* YES SO SET INDEX FOR MSG    0354
*                                      AHL114A                       */
         L     @10,INITPTR(,PCTPTR)                                0354
         MVI   ICTMSGX(@10),X'0F'                                  0354
*       ELSE                        /* NO                            */
*         ICTMSGX=14;               /* NO THEN SET THE INDEX FOR MSG
*                                      AHL113A                       */
         B     @RC00353                                            0355
@RF00353 L     @10,INITPTR(,PCTPTR)                                0355
         MVI   ICTMSGX(@10),X'0E'                                  0355
*       GO TO PMT05;                /* THEN GO WRITE IT OUT          */
         B     PMT05                                               0356
*     END;                                                         0357
*   ENTRX(I)=NUMBER;                /* YES THERE IS ROOM IN THE    0358
*                                      CURRENT TABLE SO PUT THIS ONE
*                                      IN IT                         */
@RF00351 LA    @10,3                                               0358
         LR    @09,I                                               0358
         MR    @08,@10                                             0358
         ALR   @09,OPPTR                                           0358
         AL    @09,@CF00584                                        0358
         MVC   ENTRX(3,@09),NUMBER                                 0358
*   ENTRYPTR=ENTRYPTR+3;            /* ADVANCE THE CURRENT ENTRY PTR
*                                      TO THE NEXT SLOT IN THE TABLE */
         AR    ENTRYPTR,@10                                        0359
*PMT31:                             /* END?                          */
*                                                                  0360
*   /*****************************************************************/
*   /*                                                               */
*   /* ARE WE AT THE END OF THE SUBPARMLIST?                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0360
*   IF ENDSW^=1 THEN                /* NO                            */
PMT31    CLI   ENDSW,1                                             0360
         BE    @RF00360                                            0360
*     DO;                           /* NO SO                         */
*       KWPSN=K;                    /* SAVE THE POSITION OF THE END
*                                      OF THIS SUBENTRY AS THE     0362
*                                      BEGINNING OF THE NEXT SUBENTRY*/
         LR    KWPSN,K                                             0362
*       K=K+1;                      /* ADVANCE THE TEXT PTR TO THE 0363
*                                      NEXT CHAR                     */
         AH    K,@CH00041                                          0363
*       GO TO PMT24;                /* GO ISOLATE THE NEXT SUBENTRY
*                                      IN THE LIST                   */
         B     PMT24                                               0364
*     END;                                                         0365
*                                                                  0365
*   /*****************************************************************/
*   /*                                                               */
*   /* YES THAT WAS THE LAST ENTRY FOR THIS KEYWORD WAS IT SIO?      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0366
*   IF PATHSW=3 THEN                /* YES                           */
@RF00360 CLI   PATHSW,3                                            0366
         BNE   @RF00366                                            0366
*     DO;                           /* YES IT WAS SIO                */
*       SIOFTPTR=ENTRYPTR;          /* SO UPDATE SIO PTR TO REFLECT
*                                      NEW ENTRIES                   */
         ST    ENTRYPTR,SIOFTPTR                                   0368
*       GO TO PMT46;                /* GO SEE IF THERE ARE MORE    0369
*                                      KEYWORDS                      */
         B     PMT46                                               0369
*     END;                                                         0370
*                                                                  0370
*   /*****************************************************************/
*   /*                                                               */
*   /* NOT SIO, WAS IT IO?                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0371
*   IF PATHSW=2 THEN                /* YES                           */
@RF00366 CLI   PATHSW,2                                            0371
         BNE   @RF00371                                            0371
*     DO;                           /* YES IT WAS                    */
*       IOFTPTR=ENTRYPTR;           /* SO UPDATE IO PTR TO REFLECT 0373
*                                      NEW ENTRIES                   */
         ST    ENTRYPTR,IOFTPTR                                    0373
*       GO TO PMT46;                /* GO SEE IF THERE ARE MORE    0374
*                                      KEYWORDS                      */
         B     PMT46                                               0374
*     END;                          /* IT IS NEITHER IO NOR SIO SO IT
*                                      MUST BE IO=SIO                */
*                                                                  0376
*/********************************************************************/
*/*                                                                  */
*/* WHEN ENTRIES JUST MADE INTO THE IO HAVE TO ALSO BE MADE INTO THE */
*/* SIO TABLE BECAUSE THE IO=SIO= KEYWORD WAS USED THE CODE BRANCHES */
*/* HERE.  THE LATEST IO ENTRIES ARE MERGED INTO THE SIO TABLE IF    */
*/* THERE IS ROOM                                                    */
*/*                                                                  */
*/********************************************************************/
*                                                                  0376
*   OPPTR=IOFTPTR;                  /* USE THE CURRENT TABLE PTR TO
*                                      POINT TO THE ENTRIES IN THE IO
*                                      TABLE TO BE COPIED INTO THE 0376
*                                      SIO TABLE, THE FIRST ONE WOULD
*                                      BE POINTED TO BY THE NEXT   0376
*                                      ENTRY PTR THAT WAS UPDATED AT
*                                      THE END OF THE LAST GROUP OF
*                                      ENTRIES INTO THE IO TABLE     */
@RF00371 L     OPPTR,IOFTPTR                                       0376
*   IOFTPTR=ENTRYPTR;               /* NOW THAT WE HAVE THE BEGINNING
*                                      OF THE NEW ENTRIES FROM IT  0377
*                                      UPDATE IT FOR THIS GROUP OF 0377
*                                      ENTRIES                       */
         ST    ENTRYPTR,IOFTPTR                                    0377
*   ENTRYPTR=SIOFTPTR;              /* GET THE PTR TO THE NEXT ENTRY
*                                      TO BE MADE INTO THE SIO TABLE */
         L     ENTRYPTR,SIOFTPTR                                   0378
*PMT32:                                                            0379
*   IF OPPTR=IOFTPTR                /* IS THIS THE END OF THE IO   0379
*                                      TABLE ENTRIES?          Y02014*/
*     THEN                                                         0379
PMT32    C     OPPTR,IOFTPTR                                       0379
         BNE   @RF00379                                            0379
*     DO;                           /* YES IT IS                     */
*       SIOFTPTR=ENTRYPTR;          /* UPDATE THE SIO PTR TO THE NEXT
*                                      EMPTY SLOT TO REFLECT NEW   0381
*                                      ENTRIES                       */
         ST    ENTRYPTR,SIOFTPTR                                   0381
*       GO TO PMT46;                /* THEN GO TO SEE IF THERE IS  0382
*                                      ANYMORE                       */
         B     PMT46                                               0382
*     END;                                                         0383
*   I=1;                            /* BEGIN LOOP TO SEARCH FOR    0384
*                                      DUPLICATE ENTRIES AT THE    0384
*                                      BEGINNING OF SIO TABLE        */
@RF00379 LA    I,1                                                 0384
*PMT33:                                                            0385
*   IF ENTRYPTR=ADDR(SIOENT(I))     /* IS THIS THE END OF THE SIO  0385
*                                      TABLE ENTRIES?                */
*     THEN                                                         0385
PMT33    LR    @10,I                                               0385
         MH    @10,@CH00071                                        0385
         L     @07,INITPTR(,PCTPTR)                                0385
         L     @07,SIOTAB(,@07)                                    0385
         LA    @03,0(@10,@07)                                      0385
         AL    @03,@CF00584                                        0385
         CR    ENTRYPTR,@03                                        0385
         BE    @RT00385                                            0385
*     GO TO PMT34;                  /* YES IT IS SO GO MAKE THE ENTRY*/
*   IF ENTRX(1)=SIOENT(I)           /* NO ITS NOT IS THIS A DUPLICATE
*                                      ENTRY?                        */
*     THEN                                                         0387
         ALR   @07,@10                                             0387
         AL    @07,@CF00584                                        0387
         CLC   ENTRX(3,OPPTR),SIOENT(@07)                          0387
         BE    @RT00387                                            0387
*     GO TO PMT35;                  /* YES, SKIP IT                  */
*   I=I+1;                          /* NO SO GO ON TO THE NEXT SIO 0389
*                                      ENTRY                         */
         AH    I,@CH00041                                          0389
*   GO TO PMT33;                    /* CONTINUE LOOP                 */
         B     PMT33                                               0390
*PMT34:                             /* NO DUP                        */
*                                                                  0391
*   /*****************************************************************/
*   /*                                                               */
*   /* NO DUPLICATE FOUND IS THERE ROOM IN SIO TBL FOR ANOTHER ENTRY */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0391
*   IF SIOENT(I)=ELIND THEN         /* NO                            */
PMT34    LR    @10,I                                               0391
         MH    @10,@CH00071                                        0391
         L     @07,INITPTR(,PCTPTR)                                0391
         L     @03,SIOTAB(,@07)                                    0391
         ALR   @03,@10                                             0391
         AL    @03,@CF00584                                        0391
         CLC   SIOENT(3,@03),ELIND                                 0391
         BNE   @RF00391                                            0391
*     DO;                           /* NO; ERROR                     */
*       ICTMSGX=15;                 /* SET INDEX FOR THE MSG AHL114A */
         MVI   ICTMSGX(@07),X'0F'                                  0393
*       GO TO PMT05;                /* GO WRITE IT OUT               */
         B     PMT05                                               0394
*     END;                                                         0395
*   SIOENT(I)=ENTRX(1);             /* YES THER IS ROOM SO ADD THE 0396
*                                      ENTRY                         */
@RF00391 LA    @10,3                                               0396
         LR    @09,I                                               0396
         MR    @08,@10                                             0396
         L     @07,INITPTR(,PCTPTR)                                0396
         L     @07,SIOTAB(,@07)                                    0396
         ALR   @07,@09                                             0396
         AL    @07,@CF00584                                        0396
         MVC   SIOENT(3,@07),ENTRX(OPPTR)                          0396
*   ENTRYPTR=ENTRYPTR+3;            /* AND UPDATE THE CURRENT ENTRY
*                                      POINTER                       */
         AR    ENTRYPTR,@10                                        0397
*PMT35:                             /* CONTINUE                      */
*   OPPTR=OPPTR+3;                  /* INCREMENT THE CURRENT TABLE 0398
*                                      PTR BEING USED TO POINT TO THE
*                                      NEW ENTRY IN THE IO TABLE THAT
*                                      IS BEING COPIED               */
PMT35    AH    OPPTR,@CH00071                                      0398
*   GO TO PMT32;                    /* CONTINUE THE LOOP             */
         B     PMT32                                               0399
*                                                                  0400
*/********************************************************************/
*/*                                                                  */
*/* IF J=3 FOR WTGTAB THE CODE BRANCHES HERE.  THIS IS THE CODE      */
*/* FOR THE SVC= KEYWORD                                             */
*/*                                                                  */
*/********************************************************************/
*                                                                  0400
*PMT41:                                                            0400
*   IF GTFSVCP='0'B                 /* IS THE PROMPTING BIT FOR SVC
*                                      ON?                     Y02014*/
*     THEN                          /* NO                            */
PMT41    L     @03,INITPTR(,PCTPTR)                                0400
         TM    GTFSVCP(@03),B'01000000'                            0400
         BZ    @RT00400                                            0400
*     GO TO PMT19;                  /* NO THEN THIS IS AN INVALID  0401
*                                      PROMPT WRITE AN ERROR MSG     */
*   ENTRYPTR=SVCFIPTR;              /* YES SET THE CURRENT ENTRY PTR
*                                      TO THE NEXT SLOT IN THE SVC 0402
*                                      TABLE                         */
         L     ENTRYPTR,SVCFIPTR                                   0402
*   OPPTR=SVCTAB;                   /* SET THE CURRENT TABLE PTR TO
*                                      THE SVC TABLE           Y02014*/
         L     OPPTR,SVCTAB(,@03)                                  0403
*   PATHSW=2;                       /* SET SWITCH TO INDICATE SVC  0404
*                                      PROCESSING                    */
         MVI   PATHSW,X'02'                                        0404
*   GO TO PMT37;                    /* GO TO THE COMMON CODE TO    0405
*                                      PROCESS PI&SVC ENTRIES        */
*                                                                  0405
         B     PMT37                                               0405
*/********************************************************************/
*/*                                                                  */
*/* IF J=4 FOR WTGTAB THE CODE BRANCHES HERE.  THIS IS THE CODE      */
*/* FOR THE PI= KEYWORD                                              */
*/*                                                                  */
*/********************************************************************/
*                                                                  0406
*PMT36:                                                            0406
*   IF GTFPIP='0'B                  /* IS THE PROMPTING BIT FOR PI 0406
*                                      ON?                     Y02014*/
*     THEN                          /* NO                            */
PMT36    L     @03,INITPTR(,PCTPTR)                                0406
         TM    GTFPIP(@03),B'00000100'                             0406
         BZ    @RT00406                                            0406
*     GO TO PMT19;                  /* NO IVALID PROMPTING WRITE OUT
*                                      ERROR MSG                     */
*   ENTRYPTR=PIFIPTR;               /* YES SET THE CURRENT ENTRY PTR
*                                      TO THE NEXT EMPTY SLOT IN PI
*                                      TABLE                         */
         L     ENTRYPTR,PIFIPTR                                    0408
*   OPPTR=PITAB;                    /* SET THE CURRENT TABLE PTR TO
*                                      THE PI TABLE            Y02014*/
         L     OPPTR,PITAB(,@03)                                   0409
*   PATHSW=1;                       /* SET SWITCH TO INDICATE PI   0410
*                                      PROCESSING                    */
         MVI   PATHSW,X'01'                                        0410
*                                                                  0411
*/********************************************************************/
*/*                                                                  */
*/* COMMON CODE FOR READING IN PI= & SVC= KEYWORD PARAMETER LISTS    */
*/*                                                                  */
*/********************************************************************/
*                                                                  0411
*PMT37:                                                            0411
*   ENDSW=0;                        /* SET SWITCH TO INDICATE NOT THE
*                                      END OF THE SUBPARMLIST        */
PMT37    MVI   ENDSW,X'00'                                         0411
*   KWPSN=KWPBEG;                   /* INITIALIZE PTR TO THE FIRST 0412
*                                      SUBENTRY                      */
         L     @10,KWPBEG                                          0412
         LR    KWPSN,@10                                           0412
*   DO K=KWPBEG                     /* SET UP A LOOP TO SCAN THE   0413
*                                      PARMLIST STOPPING             */
*         TO KWPEND-1;              /* AT EACH ',' & THE END         */
         LR    K,@10                                               0413
         B     @DE00413                                            0413
@DL00413 DS    0H                                                  0414
*PMT38:                                                            0414
*     IF MSGREPLY(K)=','            /* IS THIS CHAR A ','?     Y02014*/
*       THEN                                                       0414
PMT38    L     @10,INITPTR(,PCTPTR)                                0414
         ALR   @10,K                                               0414
         CLI   MSGREPLY-1(@10),C','                                0414
         BE    @RT00414                                            0414
*       GO TO PMT39;                /* YES SO A SUBENTRY SHOULD BE 0415
*                                      ISOLATED                      */
*   END;                            /* NO CONTINUE THE LOOP          */
         AH    K,@CH00041                                          0416
@DE00413 L     @10,KWPEND                                          0416
         BCTR  @10,0                                               0416
         CR    K,@10                                               0416
         BNH   @DL00413                                            0416
*   ENDSW=1;                        /* LOOP HAS REACHED THE END OF 0417
*                                      THE SUBPARMLIST SET THE SWITCH
*                                      TO INDICATE THAT THIS WILL BE
*                                      THE LAST SUBENTRY FOR THIS  0417
*                                      KEYWORD                       */
         MVI   ENDSW,X'01'                                         0417
*PMT39:                                                            0418
*   IF K-KWPSN-1<=0                 /* IS THE SUBENTRY NUL           */
*     THEN                          /* YES; ERROR                    */
PMT39    LR    @10,K                                               0418
         SR    @10,KWPSN                                           0418
         BCTR  @10,0                                               0418
         LTR   @10,@10                                             0418
         BNP   @RT00418                                            0418
*     GO TO PMT09;                  /* WRITE OUT A MSG               */
*   IF K-KWPSN-1>3                  /* IS THE SUBENTRY TOO LONG?     */
*     THEN                                                         0420
         CH    @10,@CH00071                                        0420
         BNH   @RF00420                                            0420
*     DO;                           /* YES PICK A MSG                */
*       IF PATHSW=1                 /* IS THIS PI PROCESSING?        */
*         THEN                                                     0422
         CLI   PATHSW,1                                            0422
         BNE   @RF00422                                            0422
*         ICTMSGX=16;               /* YES SET INDEX FOR MSG AHL115A */
         L     @10,INITPTR(,PCTPTR)                                0423
         MVI   ICTMSGX(@10),X'10'                                  0423
*       ELSE                                                       0424
*         ICTMSGX=17;               /* NO THEN SET INDEX FOR MSG   0424
*                                      AHL116A                       */
         B     @RC00422                                            0424
@RF00422 L     @10,INITPTR(,PCTPTR)                                0424
         MVI   ICTMSGX(@10),X'11'                                  0424
*       GO TO PMT05;                /* THEN WRITE OUT MSG            */
         B     PMT05                                               0425
*     END;                                                         0426
*   NUMBER=CHAR0;                   /* NO LENGTH IS VALID SO       0427
*                                      INITALIZE A 3 BYTE AREA TO 0
*                                      CHAR 'F0F0F0'X                */
@RF00420 MVC   NUMBER(3),CHAR0                                     0427
*   J=KWPSN+5-K;                    /* FIGURE WHERE THE FIRST DIGIT
*                                      WILL FALL IN A 3 BYTE FIELD IF
*                                      THE SUBENTRY IS RIGHT       0428
*                                      JUSTIFIED                     */
         LA    J,5                                                 0428
         AR    J,KWPSN                                             0428
         SR    J,K                                                 0428
*   NUMBER(J:3)=MSGREPLY(KWPSN+1:K-1);/* MOVE THE SUBENTRY INTO THE 3
*                                      BYTE FIELD RIGHT JUSTIFIED  0429
*                                                              Y02014*/
         LA    @05,NUMBER-1(J)                                     0429
         LA    @15,3                                               0429
         SR    @15,J                                               0429
         L     @14,INITPTR(,PCTPTR)                                0429
         ALR   @14,KWPSN                                           0429
         EX    @15,@SM00585                                        0429
*   KWPSN=K;                        /* SAVE THE POSITION OF THE NEXT
*                                      SUBENTRY                      */
*                                                                  0430
         LR    KWPSN,K                                             0430
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK TO BE SURE THAT ALL 3 BYTES CAN ONLY CONTAIN A DIGIT    */
*   /* CHAR                                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0431
*   IF HIGH1='1111'B&HIGH2='1111'B&HIGH3='1111'B THEN/* YES          */
         TM    HIGH1,B'11110000'                                   0431
         BNO   @RF00431                                            0431
         TM    HIGH2,B'11110000'                                   0431
         BNO   @RF00431                                            0431
         TM    HIGH3,B'11110000'                                   0431
         BO    @RT00431                                            0431
*     GO TO PMT65;                  /* YES THEY ARE OK SO GO TO CHECK
*                                      FURTHER                       */
*   NUMBER=ELIND;                   /* NO THEY ARE NOT OK SO PUT   0433
*                                      'FFFFFF'X INTO THE 3 BYTE   0433
*                                      FIELD TO BE SURE THAT IT WILL
*                                      COME UP INVALID LATER         */
@RF00431 MVC   NUMBER(3),ELIND                                     0433
*PMT65:                             /* PI?                           */
*                                                                  0434
*   /*****************************************************************/
*   /*                                                               */
*   /* IS THIS PI PROCESSING?                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0434
*   IF PATHSW=1 THEN                /* YES                           */
PMT65    CLI   PATHSW,1                                            0434
         BE    @RT00434                                            0434
*     GO TO PMT40;                  /* YES THEN GO TO THE PI TEST &
*                                      ERROR MSG                     */
*                                                                  0435
*   /*****************************************************************/
*   /*                                                               */
*   /* NO THEN IT MUST BE SVC PROCESSING                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0436
*   IF NUMBER>=CHAR0                /* IS THE SVC NUMBER             */
*       &NUMBER<=MAXSVCNO           /* 000<=SVC#<=255?               */
*     THEN                          /* YES                           */
         CLC   NUMBER(3),CHAR0                                     0436
         BL    @RF00436                                            0436
         CLC   NUMBER(3),MAXSVCNO                                  0436
         BNH   @RT00436                                            0436
*     GO TO PMT42;                  /* YES ENTER IT IN TABLE         */
*   ICTMSGX=17;                     /* NO; ERROR SET INDEX FOR MSG 0438
*                                      AHL116                        */
@RF00436 L     @10,INITPTR(,PCTPTR)                                0438
         MVI   ICTMSGX(@10),X'11'                                  0438
*   GO TO PMT05;                    /* GO WRITE OUT THE MSG          */
         B     PMT05                                               0439
*PMT40:                             /* PI                            */
*                                                                  0440
*   /*****************************************************************/
*   /*                                                               */
*   /* VALIDITY CHECK THE PI NUMBER                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0440
*   IF NUMBER>CHAR0                 /* IS THIS PI NUMBER             */
*       &NUMBER<=MAXPINO            /* 000<PI#<=019                  */
*     THEN                          /* YES                           */
PMT40    CLC   NUMBER(3),CHAR0                                     0440
         BNH   @RF00440                                            0440
         CLC   NUMBER(3),MAXPINO                                   0440
         BNH   @RT00440                                            0440
*     GO TO PMT42;                  /* YES GO PUT IT INTO THE TABLE  */
*   ICTMSGX=16;                     /* NO; ERROR SET THE INDEX FOR 0442
*                                      MSG AHL115A                   */
@RF00440 L     @10,INITPTR(,PCTPTR)                                0442
         MVI   ICTMSGX(@10),X'10'                                  0442
*   GO TO PMT05;                    /* GO WRITE OUT THE MSG          */
         B     PMT05                                               0443
*                                                                  0444
*/********************************************************************/
*/*                                                                  */
*/* AT THIS POINT THE PARMLIST ENTRY IS KNOWN TO BE VALID, NEXT      */
*/* CHECK TO SEE IF IT IS A DUPLICATE & IF NOT ENTER IT IN THE TABLE */
*/*                                                                  */
*/********************************************************************/
*                                                                  0444
*PMT42:                                                            0444
*   I=1;                            /* START LOOP AT THE FIRST ENTRY
*                                      IN THE CURRENT TABLE          */
PMT42    LA    I,1                                                 0444
*PMT43:                             /* FIRST SLOT?                   */
*   IF ENTRYPTR=ADDR(ENTRX(I))      /* IS THIS ENTRY THE FIRST EMPTY
*                                      SLOT IN THE CURRENT TABLE     */
*     THEN                          /* YES                           */
PMT43    LR    @10,I                                               0445
         MH    @10,@CH00071                                        0445
         LR    @15,OPPTR                                           0445
         AL    @15,@CF00584                                        0445
         LA    @00,ENTRX(@10,@15)                                  0445
         CR    ENTRYPTR,@00                                        0445
         BE    @RT00445                                            0445
*     GO TO PMT45;                  /* YES THEN THERE ARE NO       0446
*                                      DUPLICATE ENTRIES SO LEAVE THE
*                                      LOOP                          */
*                                                                  0446
*   /*****************************************************************/
*   /*                                                               */
*   /* NO SO THEN CHECK TO SEE IF THIS ENTRY IS A DUPLICATE          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0447
*   IF NUMBER=ENTRX(I)THEN          /* YES                           */
         ALR   @10,OPPTR                                           0447
         AL    @10,@CF00584                                        0447
         CLC   NUMBER(3),ENTRX(@10)                                0447
         BE    @RT00447                                            0447
*     GO TO PMT44;                  /* YES IT IS A DUP SO SKIP IT &
*                                      GO ON TO THE NEXT SUBPARM     */
*   I=I+1;                          /* NO NOT A DUP SO GO ON TO THE
*                                      NEXT ENTRY                    */
         AH    I,@CH00041                                          0449
*   GO TO PMT43;                    /* CONTINUE LOOP                 */
         B     PMT43                                               0450
*PMT45:                             /* NO DUP                        */
*                                                                  0451
*   /*****************************************************************/
*   /*                                                               */
*   /* NOW THAT WE KNOW THERE IS NO DUPLICATE ENTRY IS THERE ROOM    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0451
*   IF ENTRX(I)=ELIND               /* IN THE TABLE FOR A NEW ENTRY? */
*     THEN                          /* NO                            */
PMT45    LR    @10,I                                               0451
         MH    @10,@CH00071                                        0451
         ALR   @10,OPPTR                                           0451
         AL    @10,@CF00584                                        0451
         CLC   ENTRX(3,@10),ELIND                                  0451
         BNE   @RF00451                                            0451
*     DO;                           /* NO THERE ISN'T ANYMORE ROOM;
*                                      ERROR                         */
*       ICTMSGX=18;                 /* SET THE MSG INDEX FOR MSG   0453
*                                      AHL117A                       */
         L     @10,INITPTR(,PCTPTR)                                0453
         MVI   ICTMSGX(@10),X'12'                                  0453
*       GO TO PMT05;                /* GO WRITE OUT THE MSG          */
         B     PMT05                                               0454
*     END;                                                         0455
*   ENTRX(I)=NUMBER;                /* YES THERE IS ROOM SO PUT THE
*                                      NEW ENTRY INTO THE CURRENT  0456
*                                      TABLE                         */
@RF00451 LA    @10,3                                               0456
         LR    @09,I                                               0456
         MR    @08,@10                                             0456
         ALR   @09,OPPTR                                           0456
         AL    @09,@CF00584                                        0456
         MVC   ENTRX(3,@09),NUMBER                                 0456
*   ENTRYPTR=ENTRYPTR+3;            /* ADVANCE THE CURRENT PTR TO THE
*                                      NEXT SLOT                     */
         AR    ENTRYPTR,@10                                        0457
*PMT44:                             /* ROUTE?                        */
*                                                                  0458
*   /*****************************************************************/
*   /*                                                               */
*   /* TEST THIS SWITCH TO SEE IF THAT WAS THE LAST SUBENTRY         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0458
*   IF ENDSW^=1 THEN                /* NO                            */
PMT44    CLI   ENDSW,1                                             0458
         BE    @RF00458                                            0458
*     DO;                           /* NO IT WASN'T SO               */
*       K=K+1;                      /* START THE SCAN FOR THE NEXT 0460
*                                      SUBENTRY                      */
         AH    K,@CH00041                                          0460
*       GO TO PMT38;                /* RETURN TO THE LOOP            */
         B     PMT38                                               0461
*     END;                                                         0462
*                                                                  0462
*   /*****************************************************************/
*   /*                                                               */
*   /* YES THAT WAS THE LAST ONE SO WAS THIS PI PROCESSING?          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0463
*   IF PATHSW=1 THEN                /* YES                           */
@RF00458 CLI   PATHSW,1                                            0463
         BNE   @RF00463                                            0463
*     PIFIPTR=ENTRYPTR;             /* THEN UPDATE THE PI PTR TO THE
*                                      NEXT EMPTY SLOT TO REFLECT THE
*                                      NEW GROUP OF ENTRIES INTO THE
*                                      PI TABLE                      */
         ST    ENTRYPTR,PIFIPTR                                    0464
*   ELSE                            /* NO THEN IT MUST BE SVC        */
*     SVCFIPTR=ENTRYPTR;            /* THEN UPDATE THE SVC PTR TO THE
*                                      NEXT EMPTY SLOT TO REFLECT THE
*                                      NEW GROUP OF ENTRIES INTO THE
*                                      SVC TABLE                     */
         B     @RC00463                                            0465
@RF00463 ST    ENTRYPTR,SVCFIPTR                                   0465
*                                                                  0466
*/********************************************************************/
*/*                                                                  */
*/* THE CODE BRANCHES HERE AFTER FINISHING PROCESSING OF A LINE OR   */
*/* ANY KEYWORD SUBPARMLIST.  THE SWITCH EODIND IS USED TO DECIDE IF */
*/* THERE SHOULD BE ANYMORE INPUT & WHERE TO GO TO PROCESS IT        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0466
*PMT46:                                                            0466
*   IF EODIND=0                     /* IS THE SWITCH SET TO INDICATE
*                                      THE END OF A LINE WAS REACHED?*/
*     THEN                          /* NO                            */
@RC00463 DS    0H                                                  0466
PMT46    CLI   EODIND,0                                            0466
         BNE   @RF00466                                            0466
*     DO;                           /* NO                            */
*       K=NEXTKW;                   /* SO INITALIZE THE SCAN PTR TO
*                                      THE POSITION OF WHAT SHOULD BE
*                                      THE NEXT KEYWORD              */
         L     K,NEXTKW                                            0468
*       GO TO PMT07;                /* GO BACK INTO THE SCAN LOOP FOR
*                                      KEYWORDS                      */
         B     PMT07                                               0469
*     END;                                                         0470
*                                                                  0470
*/********************************************************************/
*/*                                                                  */
*/* THE RESET POINTERS ARE UPDATED AT THIS POINT -- THE CONSEQUENCE  */
*/* OF DOING THIS AT THIS POINT IS THAT ANY ERROR IN ANY WHOLE LINE  */
*/* OF PROMPTING INVALIDATES THAT WHOLE LINE NOT JUST THAT KEYWORD   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0471
*   IOEND=IOFTPTR;                  /* YES THIS IS THE END OF A LINE
*                                      SO UPDATE THE                 */
@RF00466 MVC   IOEND(4),IOFTPTR                                    0471
*   SIOEND=SIOFTPTR;                /* RESET POINTERS TO             */
         MVC   SIOEND(4),SIOFTPTR                                  0472
*   PIEND=PIFIPTR;                  /* REFLECT ALL THE VALID         */
         MVC   PIEND(4),PIFIPTR                                    0473
*   SVCEND=SVCFIPTR;                /* ENTRIES MADE INTO THE TABLES
*                                      FROM THIS LINE OF PROMPTING   */
         MVC   SVCEND(4),SVCFIPTR                                  0474
*   IF EODIND^=2                    /* IN ADDITIN TO BEING THE END OF
*                                      THE LINE WAS THIS ALSO THE END
*                                      OF THE PROMPTING?             */
*     THEN                                                         0475
         CLI   EODIND,2                                            0475
         BE    @RF00475                                            0475
*     DO;                           /* NO SO                         */
*       ICTMSGX=3;                  /* SET THE MSG INDEX FOR MSG   0477
*                                      AHL102A AND                   */
         L     @10,INITPTR(,PCTPTR)                                0477
         MVI   ICTMSGX(@10),X'03'                                  0477
*       GO TO PMT06;                /* BRANCH TO REQUEST MORE      0478
*                                      PROMPTING OR 'END'            */
         B     PMT06                                               0478
*     END;                                                         0479
*                                                                  0480
*/********************************************************************/
*/*                                                                  */
*/* FREEMAIN CORE GOTTEN FOR ANY TABLE IF THAT TABLE IS EMPTY AND    */
*/* THEN TURN OFF THE ASSOCIATED PROMTING BIT AND SET THE OPTION     */
*/* BITS SO THAT THERE WILL BE A FULL TRACE OF THAT EVENT            */
*/*                                                                  */
*/********************************************************************/
*                                                                  0480
*   /*****************************************************************/
*   /*                                                               */
*   /* YES EODIND=2 SO THAT WAS THE END OF THE PROMPTING             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0480
*   IF GTFIOP='0'B                  /* WAS THERE TO BE IO PROMPTING?
*                                                              Y02014*/
*     THEN                          /* NO                            */
@RF00475 L     @10,INITPTR(,PCTPTR)                                0480
         TM    GTFIOP(@10),B'00000001'                             0480
         BZ    @RT00480                                            0480
*     GO TO PMT48;                  /* NO THERE WASN'T SO THERE IS NO
*                                      IO TABLE                      */
*                                                                  0481
*   /*****************************************************************/
*   /*                                                               */
*   /* YES THERE WAS SO ARE THERE ANY ENTRIES IN THE IO TABLE?       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0482
*   IF IOFTPTR=IOTAB                /*                         Y02014*/
*     THEN                          /* NO                            */
         L     @03,IOFTPTR                                         0482
         C     @03,IOTAB(,@10)                                     0482
         BE    @RT00482                                            0482
*     GO TO PMT47;                  /* NO GO FREE THE TABLE          */
*   ENTRYPTR=IOFTPTR;               /* YES THEN SET THE CURRENT ENTRY
*                                      PTR TO THE NEXT EMPTY SLOT    */
         LR    ENTRYPTR,@03                                        0484
*   LSTENTRY=ELIND;                 /* STORE 'FFFFFF'X INTO AS THE 0485
*                                      LAST ENTRY                    */
         MVC   LSTENTRY(3,ENTRYPTR),ELIND                          0485
*   GO TO PMT48;                    /* GO CHECK SIO                  */
         B     PMT48                                               0486
*PMT47:                             /* FREE IO EBCDIC TABLE          */
*   FREEAD=IOTAB;                   /* ADDR OF STORAGE         Y02014*/
PMT47    L     @10,INITPTR(,PCTPTR)                                0487
         L     FREEAD,IOTAB(,@10)                                  0487
*   DO;                             /* FREEMAIN(R) LV(153)A(FREETB)  */
*     RESPECIFY                                                    0489
*      (GPR01F,                                                    0489
*       GPR00F)RESTRICTED;                                         0489
*     GPR00F=153;                   /* LENGTH REQUESTED              */
         LA    GPR00F,153                                          0490
*     GPR01F=ADDR(FREETB);          /* SET REGISTER ONE              */
         LR    GPR01F,FREEAD                                       0491
*     SVC(10);                      /* R-FORM OF GETMAIN             */
         SVC   10                                                  0492
*     RESPECIFY                                                    0493
*      (GPR01F,                                                    0493
*       GPR00F)UNRESTRICTED;                                       0493
*   END;                            /* FREEMAIN(R) LV(153)A(FREETB)  */
*   IOTAB=0;                        /* ZERO THE PTR IN THE TVT TO THE
*                                      IO TABLE                Y02014*/
         L     @10,INITPTR(,PCTPTR)                                0495
         SR    @03,@03                                             0495
         ST    @03,IOTAB(,@10)                                     0495
*   GTFIOP='0'B;                    /* TURN OFF THE IO PROMPT BIT  0496
*                                                              Y02014*/
*   GTFIO='1'B;                     /* SINCE NO PROMPT WAS GIVEN   0497
*                                      THERE SHOULD BE A FULL TRACE
*                                      OF IO                   Y02014*/
         OI    GTFIO(@10),B'00000010'                              0497
         NI    GTFIOP(@10),B'11111110'                             0497
*   PCTIOF='0'B;                    /* TURN OFF PCTCATF FILTER BIT 0498
*                                                              Y02014*/
         NI    PCTIOF(PCTPTR),B'11110111'                          0498
*PMT48:                             /* SIO                           */
*                                                                  0499
*   /*****************************************************************/
*   /*                                                               */
*   /* WAS THERE TO BE SIO PROMPTING?                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0499
*   IF GTFSIOP='0'B                 /*                         Y02014*/
*     THEN                          /* NO                            */
PMT48    L     @10,INITPTR(,PCTPTR)                                0499
         TM    GTFSIOP(@10),B'00010000'                            0499
         BZ    @RT00499                                            0499
*     GO TO PMT50;                  /* NO SO GO ON TO PI             */
*                                                                  0500
*   /*****************************************************************/
*   /*                                                               */
*   /* YES, ARE THERE ANY SIO ENTRIES IN THE TABLE                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0501
*   IF SIOFTPTR=SIOTAB              /*                         Y02014*/
*     THEN                          /* NO                            */
         L     @03,SIOFTPTR                                        0501
         C     @03,SIOTAB(,@10)                                    0501
         BE    @RT00501                                            0501
*     GO TO PMT49;                  /* NO                            */
*   ENTRYPTR=SIOFTPTR;              /* YES THERE ARE, SET THE CURRENT
*                                      TABLE PTR TO THE SIO TABLE    */
         LR    ENTRYPTR,@03                                        0503
*   LSTENTRY=ELIND;                 /* STORE 'FFFFFF'X INTO IT AS THE
*                                      LAST ENTRY                    */
         MVC   LSTENTRY(3,ENTRYPTR),ELIND                          0504
*   GO TO PMT50;                    /* GO ON TO TEST PI              */
         B     PMT50                                               0505
*PMT49:                             /* FREE SIO EBCDIC TABLE   Y02014*/
*   FREEAD=SIOTAB;                  /* ADDR OF STORAGE         Y02014*/
PMT49    L     @10,INITPTR(,PCTPTR)                                0506
         L     FREEAD,SIOTAB(,@10)                                 0506
*   DO;                             /* FREEMAIN(R) LV(153)A(FREETB)  */
*     RESPECIFY                                                    0508
*      (GPR01F,                                                    0508
*       GPR00F)RESTRICTED;                                         0508
*     GPR00F=153;                   /* LENGTH REQUESTED              */
         LA    GPR00F,153                                          0509
*     GPR01F=ADDR(FREETB);          /* SET REGISTER ONE              */
         LR    GPR01F,FREEAD                                       0510
*     SVC(10);                      /* R-FORM OF GETMAIN             */
         SVC   10                                                  0511
*     RESPECIFY                                                    0512
*      (GPR01F,                                                    0512
*       GPR00F)UNRESTRICTED;                                       0512
*   END;                            /* FREEMAIN(R) LV(153)A(FREETB)  */
*   SIOTAB=0;                       /* ZERO THE TVT PTR TO THE SIO 0514
*                                      TABLE                   Y02014*/
         L     @10,INITPTR(,PCTPTR)                                0514
         SR    @03,@03                                             0514
         ST    @03,SIOTAB(,@10)                                    0514
*   GTFSIOP='0'B;                   /* TURN OFF THE SIO PROMPTING BIT
*                                                              Y02014*/
*   GTFSIO='1'B;                    /* SINCE THERE WAS NO PROMPTING
*                                      THERE SHOULD BE FULL SIO    0516
*                                                              Y02014*/
         OI    GTFSIO(@10),B'00100000'                             0516
         NI    GTFSIOP(@10),B'11101111'                            0516
*   PCTSIOF='0'B;                   /* TURN OFF CATF FILTER BIT    0517
*                                                              Y02014*/
         NI    PCTSIOF(PCTPTR),B'11111011'                         0517
*PMT50:                             /* PI?                           */
*                                                                  0518
*   /*****************************************************************/
*   /*                                                               */
*   /* WAS THERE TO BE PI PROMPTING?                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0518
*   IF GTFPIP='0'B                  /* WAS THERE TO BE PI PROMPTING?
*                                                              Y02014*/
*     THEN                          /* NO                            */
PMT50    L     @10,INITPTR(,PCTPTR)                                0518
         TM    GTFPIP(@10),B'00000100'                             0518
         BZ    @RT00518                                            0518
*     GO TO PMT52;                  /* NO                            */
*                                                                  0519
*   /*****************************************************************/
*   /*                                                               */
*   /* YES, THERE WAS TO HAVE BEEN PI PROMTING                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0520
*   IF PIFIPTR=PITAB                /* YES, ARE THERE ANY PI TABLE 0520
*                                      ENTRIES?                Y02014*/
*     THEN                          /* NO                            */
         L     @03,PIFIPTR                                         0520
         C     @03,PITAB(,@10)                                     0520
         BE    @RT00520                                            0520
*     GO TO PMT51;                  /* NO                            */
*   ENTRYPTR=PIFIPTR;               /* YES, SET THE CURRENT TABLE  0522
*                                      POINTER TO THE PI TABLE       */
         LR    ENTRYPTR,@03                                        0522
*   LSTENTRY=ELIND;                 /* PUT 'FFFFFF'X IN AS THE LAST
*                                      ENTRY                         */
         MVC   LSTENTRY(3,ENTRYPTR),ELIND                          0523
*   GO TO PMT52;                    /* GO ON TO SVC                  */
         B     PMT52                                               0524
*PMT51:                             /* FREE PI TABLE           Y02014*/
*   FREEAD=PITAB;                   /* ADRESS OF STORAGE       Y02014*/
PMT51    L     @10,INITPTR(,PCTPTR)                                0525
         L     FREEAD,PITAB(,@10)                                  0525
*   DO;                             /* FREEMAIN(R) LV(60)A(FREETB)   */
*     RESPECIFY                                                    0527
*      (GPR01F,                                                    0527
*       GPR00F)RESTRICTED;                                         0527
*     GPR00F=60;                    /* LENGTH REQUESTED              */
         LA    GPR00F,60                                           0528
*     GPR01F=ADDR(FREETB);          /* SET REGISTER ONE              */
         LR    GPR01F,FREEAD                                       0529
*     SVC(10);                      /* R-FORM OF GETMAIN             */
         SVC   10                                                  0530
*     RESPECIFY                                                    0531
*      (GPR01F,                                                    0531
*       GPR00F)UNRESTRICTED;                                       0531
*   END;                            /* FREEMAIN(R) LV(60)A(FREETB)   */
*   PITAB=0;                        /* ZERO THE TVT PTR TO THE PI  0533
*                                      TABLE                   Y02014*/
         L     @10,INITPTR(,PCTPTR)                                0533
         SR    @03,@03                                             0533
         ST    @03,PITAB(,@10)                                     0533
*   GTFPIP='0'B;                    /* TURN OFF THE PI PROMPTING BIT
*                                                              Y02014*/
*   GTFPI='1'B;                     /* TURN ON THE TRACE ALL SINCE 0535
*                                      THERE WAS NO PI PROMPTING   0535
*                                                              Y02014*/
         OI    GTFPI(@10),B'00001000'                              0535
         NI    GTFPIP(@10),B'11111011'                             0535
*   PCTPIF='0'B;                    /* TURN OFF CATF FILTER BIT    0536
*                                                              Y02014*/
         NI    PCTPIF(PCTPTR),B'11111101'                          0536
*PMT52:                             /* SVC?                          */
*                                                                  0537
*   /*****************************************************************/
*   /*                                                               */
*   /* WAS THERE TO BE SVC PROMPTING?                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0537
*   IF GTFSVCP='0'B                 /*                         Y02014*/
*     THEN                          /* NO                            */
PMT52    L     @10,INITPTR(,PCTPTR)                                0537
         TM    GTFSVCP(@10),B'01000000'                            0537
         BZ    @RT00537                                            0537
*     GO TO PMT54;                  /* NO THEN SKIP LOOKING AT THE 0538
*                                      TABLE BECAUSE THERE WON'T BE
*                                      ANY TABLE                     */
*                                                                  0538
*   /*****************************************************************/
*   /*                                                               */
*   /* HAVE ANY ENTRIES BEEN MADE IN THE SVC TABLE?                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0539
*   IF SVCFIPTR=SVCTAB              /*                         Y02014*/
*     THEN                          /* NO                            */
         L     @03,SVCFIPTR                                        0539
         C     @03,SVCTAB(,@10)                                    0539
         BE    @RT00539                                            0539
*     GO TO PMT53;                  /* NO SO DELETE THE TABLE        */
*   ENTRYPTR=SVCFIPTR;              /* YES SO SET THE CURRENT ENTRY
*                                      PTR TO THE SVC TABLE NEXT   0541
*                                      EMPTY SLOT                    */
         LR    ENTRYPTR,@03                                        0541
*   LSTENTRY=ELIND;                 /* AND PUT THE 'FFFFFF'X ENTRY AT
*                                      THE END                       */
         MVC   LSTENTRY(3,ENTRYPTR),ELIND                          0542
*   GO TO PMT54;                    /* BRANCH AROUND THE CODE THAT 0543
*                                      FREES THE SVC TABLE CORE      */
         B     PMT54                                               0543
*PMT53:                             /* FREE SVC EBCDIC TABLE   Y02014*/
*   FREEAD=SVCTAB;                  /* ADDRESS OF STORAGE      Y02014*/
PMT53    L     @10,INITPTR(,PCTPTR)                                0544
         L     FREEAD,SVCTAB(,@10)                                 0544
*   DO;                             /* FREEMAIN(R) LV(153)A(FREETB)  */
*     RESPECIFY                                                    0546
*      (GPR01F,                                                    0546
*       GPR00F)RESTRICTED;                                         0546
*     GPR00F=153;                   /* LENGTH REQUESTED              */
         LA    GPR00F,153                                          0547
*     GPR01F=ADDR(FREETB);          /* SET REGISTER ONE              */
         LR    GPR01F,FREEAD                                       0548
*     SVC(10);                      /* R-FORM OF GETMAIN             */
         SVC   10                                                  0549
*     RESPECIFY                                                    0550
*      (GPR01F,                                                    0550
*       GPR00F)UNRESTRICTED;                                       0550
*   END;                            /* FREEMAIN(R) LV(153)A(FREETB)  */
*   SVCTAB=0;                       /* ZERO THE TVT PTR TO THE SVC 0552
*                                      TABLE                   Y02014*/
         L     @10,INITPTR(,PCTPTR)                                0552
         SR    @03,@03                                             0552
         ST    @03,SVCTAB(,@10)                                    0552
*   GTFSVCP='0'B;                   /* TURN OFF THE SVC PROMPTING BIT
*                                                              Y02014*/
*   GTFSVC='1'B;                    /* SINCE THERE WAS NO PROMPTING
*                                      TURN ON THE TRACE ALL SVC BIT
*                                                              Y02014*/
         OI    GTFSVC(@10),B'10000000'                             0554
         NI    GTFSVCP(@10),B'10111111'                            0554
*   PCTSVCF='0'B;                   /* TURN OFF CATF FILTERING BIT 0555
*                                                              Y02014*/
         NI    PCTSVCF(PCTPTR),B'11101111'                         0555
*                                                                  0556
*/********************************************************************/
*/*                                                                  */
*/* CHECK FOR FULL TABLES AND SORT THEM INTO ASENDING ORDER          */
*/*                                                                  */
*/********************************************************************/
*                                                                  0556
*PMT54:                                                            0556
*   EBCIO=IOTAB;                    /* STORE ADDRESS IN ORDERED    0556
*                                      STRUCTURE               Y02014*/
PMT54    L     @10,INITPTR(,PCTPTR)                                0556
         MVC   EBCIO(4),IOTAB(@10)                                 0556
*   EBCSIO=SIOTAB;                  /* STORE ADDRESS IN ORDERED    0557
*                                      STRUCTURE               Y02014*/
         MVC   EBCSIO(4),SIOTAB(@10)                               0557
*   EBCSVC=SVCTAB;                  /* STORE ADDRESS IN ORDERED    0558
*                                      STRUCTURE               Y02014*/
         MVC   EBCSVC(4),SVCTAB(@10)                               0558
*   EBCPI=PITAB;                    /* STORE ADRESS IN ORDERED     0559
*                                      STRUCTURE               Y02014*/
         MVC   EBCPI(4),PITAB(@10)                                 0559
*   FLTRAD=ADDR(EBCIO);             /* POINT TO THE ADDRESS OF THE 0560
*                                      FIRST OF THE FOUR DEVICE    0560
*                                      TABLES                  Y02014*/
         LA    FLTRAD,EBCIO                                        0560
*   ENTRYPTR=ADDR(IOFTPTR);         /* AND POINT TO THE ADDRESS OF 0561
*                                      THE END OF IT                 */
         LA    ENTRYPTR,IOFTPTR                                    0561
*PMT55:                             /* EMPTY?                        */
*                                                                  0562
*   /*****************************************************************/
*   /*                                                               */
*   /* ARE THERE ENTRIES IN THIS TABLE?                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0562
*   IF GTFFTAD=0                    /*                         Y02014*/
*     THEN                          /* NO                            */
PMT55    L     @10,GTFFTAD(,FLTRAD)                                0562
         LTR   @10,@10                                             0562
         BZ    @RT00562                                            0562
*     GO TO PMT57;                  /* NO GO ON TO THE NEXT          */
*   OPPTR=GTFFTAD;                  /* YES SET THE CURRENT TABLE PTR
*                                      TO IT                   Y02014*/
         L     @07,GTFFTAD(,FLTRAD)                                0564
         LR    OPPTR,@07                                           0564
*   J=(ENDPTR-OPPTR)/3;             /* FIGURE THE NUMBER OF ENTRIES
*                                      IN THE TABLE                  */
         L     @08,ENDPTR(,ENTRYPTR)                               0565
         SR    @08,OPPTR                                           0565
         SRDA  @08,32                                              0565
         D     @08,@CF00071                                        0565
         LR    J,@09                                               0565
*PMT56:                             /* TOP OF LOOP                   */
*   J=J-1;                          /* SET UP OUTER LOOP FOR BUBBLE
*                                      SORT                          */
PMT56    BCTR  J,0                                                 0566
*   EXCHG=0;                        /* INITIALIZE SWITCH TO SHOW THAT
*                                      NO SWAP HAS BEEN MADE         */
*                                                                  0567
         SR    EXCHG,EXCHG                                         0567
*   /*****************************************************************/
*   /*                                                               */
*   /* INNER LOOP OF BUBBLE SORT MOVES THE LARGEST ENTRY TO THE END  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0568
*   DO I=1 TO J;                                                   0568
*                                                                  0568
         LA    I,1                                                 0568
         B     @DE00568                                            0568
@DL00568 DS    0H                                                  0569
*     /***************************************************************/
*     /*                                                             */
*     /* IS THIS ENTRY LARGER THAN THE NEXT ONE?                     */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0569
*     IF ENTRX(I)>ENTRX(I+1)THEN    /* YES                           */
         LR    @15,I                                               0569
         MH    @15,@CH00071                                        0569
         ST    @15,@TF00001                                        0569
         ALR   @15,OPPTR                                           0569
         AL    @15,@CF00584                                        0569
         LR    @14,OPPTR                                           0569
         AL    @14,@TF00001                                        0569
         CLC   ENTRX(3,@15),ENTRX(@14)                             0569
         BNH   @RF00569                                            0569
*       DO;                         /* YES, SWAP                     */
*         NUMBER=ENTRX(I);          /* STORE THIS ENTRY IN TEMP    0571
*                                      STORAGE                       */
         LR    @15,OPPTR                                           0571
         AL    @15,@TF00001                                        0571
         AL    @15,@CF00584                                        0571
         MVC   NUMBER(3),ENTRX(@15)                                0571
*         ENTRX(I)=ENTRX(I+1);      /* MOVE THE NEXT ENTRY WHERE THIS
*                                      ONE WAS                       */
         LR    @15,OPPTR                                           0572
         AL    @15,@TF00001                                        0572
         AL    @15,@CF00584                                        0572
         LR    @14,OPPTR                                           0572
         AL    @14,@TF00001                                        0572
         MVC   ENTRX(3,@15),ENTRX(@14)                             0572
*         ENTRX(I+1)=NUMBER;        /* AND PUT THIS ONE WHERE IT WAS */
         LR    @15,OPPTR                                           0573
         AL    @15,@TF00001                                        0573
         MVC   ENTRX(3,@15),NUMBER                                 0573
*         EXCHG=1;                  /* SET THE SWITCH TO SHOW THAT 0574
*                                      THERE WAS A SWAP              */
         LA    EXCHG,1                                             0574
*       END;                                                       0575
*   END;                            /* CONTINUE THE LOOP             */
*                                                                  0576
@RF00569 AH    I,@CH00041                                          0576
@DE00568 CR    I,J                                                 0576
         BNH   @DL00568                                            0576
*   /*****************************************************************/
*   /*                                                               */
*   /* WERE THERE ANY SWAPS?                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0577
*   IF EXCHG^=0 THEN                /* NO                            */
         CH    EXCHG,@CH00409                                      0577
         BNE   @RT00577                                            0577
*     GO TO PMT56;                  /* NO, SO THEN THERE IS NO NEED
*                                      TO SORT ANYMORE THE LIST IS IN
*                                      ORDER                         */
*PMT57:                             /* NEXT                          */
*   ENTRYPTR=ENTRYPTR+4;            /* MOVE THE PTR TO THE PTRS UP TO
*                                      THE NEXT                      */
PMT57    LA    @10,4                                               0579
         AR    ENTRYPTR,@10                                        0579
*   FLTRAD=FLTRAD+4;                /* ALSO MOVE THE PTR TO THE END
*                                      PTRS UP ONE                   */
*                                                                  0580
         AR    FLTRAD,@10                                          0580
*   /*****************************************************************/
*   /*                                                               */
*   /* TEST TO SEE IF ALL 4 TABLES HAVE BEEN DONE                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0581
*   IF FLTRAD<=ADDR(EBCIO)+12       /*                         Y02014*/
*     THEN                          /* NO                            */
         LA    @10,EBCIO                                           0581
         AH    @10,@CH00033                                        0581
         CR    FLTRAD,@10                                          0581
         BNH   @RT00581                                            0581
*     GO TO PMT55;                  /* NO SO CONTINUE THE LOOP       */
*                                                                  0583
*/********************************************************************/
*/*                                                                  */
*/* COMPARE THE IO & SIO TABLES TO SEE IF THEY ARE EQUAL AND IF SO   */
*/* SET THE IOEQ BIT AND FREEMAIN THE SIO TABLE                      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0583
*   IF GTFIOP='0'BGTFSIOP='0'B     /* IS EITHER THE IO OR     Y02014*/
*     THEN                          /* THE SIO PROMPTING BIT OFF?    */
         L     @10,INITPTR(,PCTPTR)                                0583
         TM    GTFIOP(@10),B'00010001'                             0583
         BNO   @RT00583                                            0583
*     GO TO PMT68;                  /* YES SO DON'T TRY TO COMPARE 0584
*                                      THE TABLES              Y02014*/
*   OPPTR=IOTAB;                    /* NO SO SET UP TO COMPARE THE IO
*                                      TO THE SIO TABLE SET UP BASE
*                                      FOR IOENT               Y02014*/
*                                                                  0585
         L     OPPTR,IOTAB(,@10)                                   0585
*   /*****************************************************************/
*   /*                                                               */
*   /* LOOP THROUGH THE TABLES                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0586
*   DO I=1 TO 50;                                                  0586
*                                                                  0586
         LA    I,1                                                 0586
@DL00586 DS    0H                                                  0587
*     /***************************************************************/
*     /*                                                             */
*     /* ARE THESE TO ENTRIES THE SAME?                              */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0587
*     IF IOENT(I)^=SIOENT(I)THEN    /* NO                            */
         LR    @10,I                                               0587
         MH    @10,@CH00071                                        0587
         L     @03,INITPTR(,PCTPTR)                                0587
         L     @03,SIOTAB(,@03)                                    0587
         ST    @10,@TF00001                                        0587
         ALR   @10,OPPTR                                           0587
         AL    @10,@CF00584                                        0587
         AL    @03,@TF00001                                        0587
         AL    @03,@CF00584                                        0587
         CLC   IOENT(3,@10),SIOENT(@03)                            0587
         BNE   @RT00587                                            0587
*       GO TO PMT68;                /* NO SO LEAVE THE LOOP THE    0588
*                                      TABLES ARE NOT THE SAME Y02014*/
*     IF IOENT(I)=ELIND             /* IS THIS THE END OF THE IO   0589
*                                      TABLE?                        */
*       THEN                        /* YES                           */
         LR    @10,OPPTR                                           0589
         AL    @10,@TF00001                                        0589
         AL    @10,@CF00584                                        0589
         CLC   IOENT(3,@10),ELIND                                  0589
         BE    @RT00589                                            0589
*       GO TO PMT63;                /* YES AND IF WE HAVEN'T HAD A 0590
*                                      DIFFERENCE YET THEN THIS MUST
*                                      ALSO BE THE END OF THE SIO  0590
*                                      TABLE AND THEY MUST BE THE  0590
*                                      SAME SO LEAVE THE LOOP        */
*   END;                                                           0591
         AH    I,@CH00041                                          0591
         CH    I,@CH00550                                          0591
         BNH   @DL00586                                            0591
*PMT63:                             /* IOEQ ON                       */
*   GTFIOSIO='1'B;                  /* SINCE BOTH IO & SIO ARE THE 0592
*                                      SAME TURN ON THE IOEQ BIT IN
*                                      INITDATA                Y02014*/
PMT63    L     @10,INITPTR(,PCTPTR)                                0592
         OI    GTFIOSIO(@10),B'00000001'                           0592
*   FREEAD=SIOTAB;                  /* POINT TO AREA TO FREE   Y02014*/
         L     FREEAD,SIOTAB(,@10)                                 0593
*   DO;                             /* FREEMAIN(R) LV(153)A(FREETB)  */
*     RESPECIFY                                                    0595
*      (GPR01F,                                                    0595
*       GPR00F)RESTRICTED;                                         0595
*     GPR00F=153;                   /* LENGTH REQUESTED              */
         LA    GPR00F,153                                          0596
*     GPR01F=ADDR(FREETB);          /* SET REGISTER ONE              */
         LR    GPR01F,FREEAD                                       0597
*     SVC(10);                      /* R-FORM OF GETMAIN             */
         SVC   10                                                  0598
*     RESPECIFY                                                    0599
*      (GPR01F,                                                    0599
*       GPR00F)UNRESTRICTED;                                       0599
*   END;                            /* FREEMAIN(R) LV(153)A(FREETB)  */
*                                   /* FREE SIO TABLE Y02014         */
*   SIOTAB=IOTAB;                   /* THEN PUT THE IO TABLE ADDRESS
*                                      IN INITDATA IN PLACE OF THE 0601
*                                      SIO TABLE SO THAT IT WILL BE
*                                      USED FOR BOTH           Y02014*/
         L     @10,INITPTR(,PCTPTR)                                0601
         MVC   SIOTAB(4,@10),IOTAB(@10)                            0601
*   GOTO PMT68;                     /* PREPARE FOR RETURN      Y02014*/
         B     PMT68                                               0602
*                                                                  0603
*/********************************************************************/
*/*                                                                  */
*/* THE CODE BRANCHES HERE WHEN AN ERROR HAS OCCURRED THAT           */
*/* INVALIDATES A LINE OF INPUT.  IF PROMPTING IS FROM THE CONSOLE   */
*/* IT BRANCHES BACK TO THE BEGINNING OF THE PROMPTING LOOP.         */
*/* IF PROMPTING IS FROM PARMLIB THE RETRY BIT IS SET AND IT RETURNS */
*/*                                                                  */
*/********************************************************************/
*                                                                  0603
*PMT09:                                                            0603
*   ICTMSGX=6;                      /* SET INDEX FOR MSG AHL105A     */
PMT09    L     @10,INITPTR(,PCTPTR)                                0603
         MVI   ICTMSGX(@10),X'06'                                  0603
*PMT05:                                                            0604
*                                                                  0604
*   /*****************************************************************/
*   /*                                                               */
*   /* IS INPUT FROM PARMLIB?                                  Y02014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0604
*   IF ICTPLIB='0'B THEN            /* NO                            */
PMT05    L     @10,INITPTR(,PCTPTR)                                0604
         TM    ICTPLIB(@10),B'10000000'                            0604
         BZ    @RT00604                                            0604
*     GO TO PMT61;                  /* NO SO GO PRINT THE MSG TO THE
*                                      CONSOLE AND GET ANOTHER LINE
*                                      OF INPUT                      */
*   ICTIOTYP=4;                     /* YES SO INFORM THE OPERATOR  0606
*                                      THAT THERE WAS AN ERROR       */
         MVI   ICTIOTYP(@10),X'04'                                 0606
*   CALL AHLTIO;                    /* GO DO THE IO            Y02014*/
*                                                                  0607
         L     @15,@CV00303                                        0607
         BALR  @14,@15                                             0607
*   /*****************************************************************/
*   /*                                                               */
*   /* HAS THE STOP/MODIFY ECB BEEN POSTED?                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0608
*   IF ICTSTOP='1'B THEN            /* YES                           */
         L     @10,INITPTR(,PCTPTR)                                0608
         TM    ICTSTOP(@10),B'00000100'                            0608
         BO    @RT00608                                            0608
*     GO TO PMT70;                  /* YES RETURN A CODE OF 12       */
*   ICTMSGX=22;                     /* NO SET THE INDEX FOR MSG    0610
*                                      AHL124I                 Y02014*/
         MVI   ICTMSGX(@10),X'16'                                  0610
*   ICTIOTYP=2;                     /* AND MSG TYPE TO WTO           */
         MVI   ICTIOTYP(@10),X'02'                                 0611
*   CALL AHLTIO;                    /* GO WRITE OUT THE REST OF WHAT
*                                      HAS TO BE SAID          Y02014*/
*                                                                  0612
         L     @15,@CV00303                                        0612
         BALR  @14,@15                                             0612
*   /*****************************************************************/
*   /*                                                               */
*   /* HAS THE STOP/MODIFY ECB BEEN POSTED?                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0613
*   IF ICTSTOP='1'B THEN            /* YES                           */
         L     @10,INITPTR(,PCTPTR)                                0613
         TM    ICTSTOP(@10),B'00000100'                            0613
         BO    @RT00613                                            0613
*     GO TO PMT70;                  /* YES RETURN A CODE OF 12       */
*PMT69:                             /* RETRY                         */
*   ICTRETRY='1'B;                  /* TURN ON THE RETRY BIT MEANNING
*                                      THAT THESE TABLES ARE INVALID
*                                      AND THAT THE PROMPTING MUST BE
*                                      STARTED OVER AGAIN            */
PMT69    L     @10,INITPTR(,PCTPTR)                                0615
         OI    ICTRETRY(@10),B'00010000'                           0615
*PMT68:                             /* OK                            */
*   SAREG15=0;                      /* RETURN A 0 IN REG15 FOR A   0616
*                                      NORMAL END                    */
PMT68    L     @10,BAKSAPTR(,SAPTR)                                0616
         SR    @03,@03                                             0616
         ST    @03,SAREG15(,@10)                                   0616
*   RETURN;                         /* AND THEN RETURN TO CTL WHICH
*                                      WILL BACK TRACK TO TRY AGAIN  */
@EL00001 L     @13,4(,@13)                                         0617
@EF00001 DS    0H                                                  0617
@ER00001 LM    @14,@12,12(@13)                                     0617
         BR    @14                                                 0617
*PMT70:                             /* STOP                          */
*   SAREG15=12;                     /* RETURN A 12 IN REG 15 IF THE
*                                      STOP/MODIFY ECB HAS BEEN    0618
*                                      POSTED                        */
PMT70    L     @10,BAKSAPTR(,SAPTR)                                0618
         MVC   SAREG15(4,@10),@CF00033                             0618
*   RETURN;                         /*                         Y02014*/
         B     @EL00001                                            0619
*PMT71:                                                            0620
*   SAREG15=8;                      /* RETURN CODE OF EIGHT FOR ERROR
*                                      IN GTF INITIALIZATION   Y02014*/
PMT71    L     @10,BAKSAPTR(,SAPTR)                                0620
         MVC   SAREG15(4,@10),@CF00038                             0620
*   RETURN;                         /* RETURN TO AHLTCTL1;     Y02014*/
         B     @EL00001                                            0621
*   DECLARE                         /* GENERAL PURPOSE REGISTERS     */
*     GPR00F FIXED(31)REG(0),                                      0622
*     GPR01F FIXED(31)REG(1),                                      0622
*     GPR15F FIXED(31)REG(15),                                     0622
*     GPR01P PTR(31)REG(1);                                        0622
*   DCL                                                            0623
*     1 I004 DEF(ILIST)BDY(WORD),   /* LIST FOR GETMAIN              */
*      2 I00401 PTR(31),            /* LENGTH                        */
*      2 I00402 CHAR(1),            /* HIARCHY                       */
*      2 I00403 PTR(24),            /* ADDR OF ADDR LIST             */
*      2 I00404 CHAR(1),            /* TYPE OF REQUEST               */
*      2 I00405 PTR(8);             /* SUBPOOL VALUE                 */
*   DECLARE                                                        0624
*     ILIST CHAR(10)BDY(DWORD);     /* STANDARD LIST                 */
*   DECLARE                         /* COMMON VARIABLES              */
*     I256C CHAR(256)BASED,                                        0625
*     I031F FIXED(31)BASED,                                        0625
*     I031P PTR(31)BASED,                                          0625
*     I015F FIXED(15)BASED,                                        0625
*     I015P PTR(15)BASED,                                          0625
*     I008P PTR(8)BASED,                                           0625
*     I001C CHAR(1)BASED;                                          0625
*   END                             /*                               */
*                                                                  0626
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (GTFPCT  )                                       */
*/*%INCLUDE SYSLIB  (INITDATA)                                       */
*/*%INCLUDE SYSLIB  (SAVEAREA)                                       */
*                                                                  0626
*       ;                                                          0626
@DATA    DS    0H
@CH00409 DC    H'0'
@CH00041 DC    H'1'
@CH00327 DC    H'2'
@CH00273 DC    H'5'
@CH00308 DC    H'6'
@CH00075 DC    H'7'
@CH00550 DC    H'50'
@CH00230 DC    H'124'
@SM00580 MVC   TEMPKW(0),MSGREPLY-1(@15)
@SM00582 MVC   NUMBER(0),MSGREPLY(@15)
@SM00585 MVC   0(0,@05),MSGREPLY(@14)
         DS    0F
@SA00001 DS    18F
@TF00001 DS    F
         DS    0F
@CF00584 DC    F'-3'
@CF00071 DC    F'3'
@CH00071 EQU   @CF00071+2
@CF00038 DC    F'8'
@CH00038 EQU   @CF00038+2
@CF00033 DC    F'12'
@CH00033 EQU   @CF00033+2
@CF00420 DC    F'60'
@CF00406 DC    F'153'
@CV00303 DC    V(AHLTIO)
@CV00346 DC    V(AHLCTL2)
         DS    0D
L        DS    A
KWPBEG   DS    A
NEXTKW   DS    A
KWPEND   DS    A
GETFREE  DS    A
ENDSW    DS    AL1
EODIND   DS    AL1
PATHSW   DS    AL1
@CC00444 DC    C'END'
         DS    CL2
ENDPTRS  DS    CL16
         ORG   ENDPTRS
IOEND    DS    AL4
SIOEND   DS    AL4
SVCEND   DS    AL4
PIEND    DS    AL4
         ORG   ENDPTRS+16
ELIND    DC    X'FFFFFF'
         DS    CL1
BGNPTRS  DS    CL16
         ORG   BGNPTRS
IOFTPTR  DS    AL4
SIOFTPTR DS    AL4
SVCFIPTR DS    AL4
PIFIPTR  DS    AL4
         ORG   BGNPTRS+16
NUMBER   DS    CL3
         ORG   NUMBER
HIGH1    DS    BL1
@NM00011 EQU   NUMBER+0
HIGH2    DS    BL1
@NM00012 EQU   NUMBER+1
HIGH3    DS    BL1
         ORG   NUMBER+3
BLANK    DC    CL4' '
         DS    CL1
EBCTAB   DS    CL16
         ORG   EBCTAB
EBCIO    DS    AL4
EBCSIO   DS    AL4
EBCSVC   DS    AL4
EBCPI    DS    AL4
         ORG   EBCTAB+16
MSK2     DC    X'55'
TEMPKW   DS    CL7
CHAR0    DC    CL3'000'
MAXSVCNO DC    CL3'255'
MAXPINO  DC    CL3'019'
TRANEXNO DC    CL3'016'
PGFLTNO  DC    CL3'017'
SEGEXNO  DC    CL3'018'
SSMNO    DC    CL3'019'
PATCH    DC    CL256'AHLTPMT AHLTPMT AHLTPMT AHLTPMT PATCH AREA'
         DC    CL144' '
         DS    CL3
ILIST    DS    CL10
PMTAB    DC    CL7'IO=    '
         DC    CL7'SIO=   '
         DC    CL7'SVC=   '
         DC    CL7'PI=    '
         DC    CL7'IO=SIO='
         DC    CL7'SIO=IO='
WTGTAB3  DC    AL4(PMT21)
         DC    AL4(PMT22)
         DC    AL4(PMT41)
         DC    AL4(PMT36)
         DC    AL4(PMT18)
         DC    AL4(PMT18)
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
FREEAD   EQU   @03
FLTRAD   EQU   @03
EXCHG    EQU   @07
ENTRYPTR EQU   @06
KWPSN    EQU   @07
J        EQU   @10
K        EQU   @03
I        EQU   @05
OPPTR    EQU   @04
MSGPTR   EQU   @03
PCTPTR   EQU   @02
SAPTR    EQU   @13
ENTBLAD  EQU   @01
RETCODE  EQU   @15
GPR01P   EQU   @01
GPR15F   EQU   @15
GPR01F   EQU   @01
GPR00F   EQU   @00
GTFPCT   EQU   0
GTFSTAT  EQU   GTFPCT+8
GTFOPTS  EQU   GTFPCT+12
GTFOPTS1 EQU   GTFOPTS
GTFOPTS2 EQU   GTFOPTS+1
GTFOPTS3 EQU   GTFOPTS+2
GTFOPTS4 EQU   GTFOPTS+3
PCTCATF  EQU   GTFPCT+16
PCTSVCF  EQU   PCTCATF+1
PCTIOF   EQU   PCTCATF+1
PCTSIOF  EQU   PCTCATF+1
PCTPIF   EQU   PCTCATF+1
INITPTR  EQU   GTFPCT+60
NEXTBLOK EQU   GTFPCT+180
WRTRCOM  EQU   GTFPCT+204
TRMWRIT  EQU   GTFPCT+212
WRTRERR  EQU   GTFPCT+216
GTFSSRB  EQU   GTFPCT+220
QLOCKWRD EQU   GTFPCT+236
QLOCKECB EQU   GTFPCT+240
AUDITFLG EQU   GTFPCT+296
INITDATA EQU   0
ICT      EQU   INITDATA+16
ICTMSGX  EQU   ICT
ICTIOTYP EQU   ICT+1
ICTFLAGS EQU   ICT+2
ICTPLIB  EQU   ICTFLAGS
ICTIOERR EQU   ICTFLAGS
ICTEOD   EQU   ICTFLAGS
ICTRETRY EQU   ICTFLAGS
ICTSTOP  EQU   ICTFLAGS
MSGREPLY EQU   INITDATA+28
GTFOPIND EQU   INITDATA+152
GTFOPT1  EQU   GTFOPIND
GTFOPT2  EQU   GTFOPIND+1
GTFSVC   EQU   GTFOPT2
GTFSVCP  EQU   GTFOPT2
GTFSIO   EQU   GTFOPT2
GTFSIOP  EQU   GTFOPT2
GTFPI    EQU   GTFOPT2
GTFPIP   EQU   GTFOPT2
GTFIO    EQU   GTFOPT2
GTFIOP   EQU   GTFOPT2
GTFOPT3  EQU   GTFOPIND+2
GTFIOSIO EQU   GTFOPT3
GTFOPT4  EQU   GTFOPIND+3
IOTAB    EQU   INITDATA+156
SIOTAB   EQU   INITDATA+160
SVCTAB   EQU   INITDATA+164
PITAB    EQU   INITDATA+168
TWT      EQU   INITDATA+176
TWTWORK  EQU   TWT+8
TWTBUF   EQU   TWT+40
BAKSAPTR EQU   4
SAVEAREA EQU   0
SAREG15  EQU   SAVEAREA+16
RTDCODE  EQU   0
MESSAGE  EQU   0
ENTRYTBL EQU   0
ENTRX    EQU   ENTRYTBL
ENDPTR   EQU   0
IOENT    EQU   0
LSTENTRY EQU   0
MSG10X   EQU   0
SIOENT   EQU   0
GTFFTAD  EQU   0
FREETB   EQU   0
I001C    EQU   0
I008P    EQU   0
I015F    EQU   0
I015P    EQU   0
I031F    EQU   0
I031P    EQU   0
I256C    EQU   0
WTOLEN   EQU   TWTBUF+8
I004     EQU   ILIST
I00401   EQU   I004
I00403   EQU   I004+5
I00404   EQU   I004+8
I00405   EQU   I004+9
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
I00402   EQU   I004+4
UNIT     EQU   ENTRX+1
CHANL    EQU   ENTRX
SAREG12  EQU   SAVEAREA+68
SAREG11  EQU   SAVEAREA+64
SAREG10  EQU   SAVEAREA+60
SAREG9   EQU   SAVEAREA+56
SAREG8   EQU   SAVEAREA+52
SAREG7   EQU   SAVEAREA+48
SAREG6   EQU   SAVEAREA+44
SAREG5   EQU   SAVEAREA+40
SAREG4   EQU   SAVEAREA+36
SAREG3   EQU   SAVEAREA+32
SAREG2   EQU   SAVEAREA+28
SAREG1   EQU   SAVEAREA+24
SAREG0   EQU   SAVEAREA+20
SAREG14  EQU   SAVEAREA+12
SAFORPTR EQU   SAVEAREA+8
SABAKPTR EQU   SAVEAREA+4
SAVACANT EQU   SAVEAREA
@NM00010 EQU   TWT+4
@NM00009 EQU   TWT
RANGPTR  EQU   INITDATA+172
GTFTIME  EQU   GTFOPT4
GTFRES3  EQU   GTFOPT4
GTFRES2  EQU   GTFOPT3
GTFRR    EQU   GTFOPT3
GTFSRM   EQU   GTFOPT3
GTFRNIO  EQU   GTFOPT3
GTFEXT   EQU   GTFOPT3
GTFPCI   EQU   GTFOPT1
GTFRES1  EQU   GTFOPT1
GTFDSP   EQU   GTFOPT1
GTFTRC   EQU   GTFOPT1
GTFUSR   EQU   GTFOPT1
GTFSYS   EQU   GTFOPT1
GTFSYSP  EQU   GTFOPT1
GTFSYSM  EQU   GTFOPT1
WTORECB  EQU   INITDATA+24
PARMDCB  EQU   INITDATA+20
ICTRESV  EQU   ICTFLAGS
ICTTRCIN EQU   ICTFLAGS
EXECPTR  EQU   INITDATA+12
CIBPTR   EQU   INITDATA+8
INITID   EQU   INITDATA
PCTWTOMD EQU   GTFPCT+312
PCTDMPMD EQU   GTFPCT+308
TRANSMAX EQU   GTFPCT+304
GTFASCB  EQU   GTFPCT+300
@NM00008 EQU   AUDITFLG+3
AFSLEBLD EQU   AUDITFLG+3
WSERFG06 EQU   AUDITFLG+3
WSERFG05 EQU   AUDITFLG+3
WSERFG04 EQU   AUDITFLG+3
WSERFG03 EQU   AUDITFLG+3
WSERFG02 EQU   AUDITFLG+2
WSERFLAG EQU   AUDITFLG+2
TERMFLAG EQU   AUDITFLG+2
AFXWRIT  EQU   AUDITFLG+2
AFQLWAIT EQU   AUDITFLG+2
AFSLEGET EQU   AUDITFLG+2
AFBUFGET EQU   AUDITFLG+2
AFFEOB   EQU   AUDITFLG+2
AFBLKFIX EQU   AUDITFLG+1
AFEQFIX  EQU   AUDITFLG+1
AFPGRLSE EQU   AUDITFLG+1
AFWRAP   EQU   AUDITFLG+1
AFBUFOFF EQU   AUDITFLG+1
AFLDFX   EQU   AUDITFLG+1
AFCLOSE  EQU   AUDITFLG+1
AFOPEN   EQU   AUDITFLG+1
AFGMBLOK EQU   AUDITFLG
AFGMSRB  EQU   AUDITFLG
AFWAIT   EQU   AUDITFLG
AFTERM   EQU   AUDITFLG
AFINIT   EQU   AUDITFLG
AFWWRIT  EQU   AUDITFLG
AFCWRIT  EQU   AUDITFLG
AFIWRIT  EQU   AUDITFLG
EQSHORT  EQU   GTFPCT+292
SLEMAX   EQU   GTFPCT+288
SLECNT   EQU   GTFPCT+284
RQPURGE  EQU   GTFPCT+280
RQTOTAL  EQU   GTFPCT+276
WRTDLST  EQU   GTFPCT+272
NUMOFBUF EQU   GTFPCT+268
SBUFDISA EQU   GTFPCT+264
SLESUSED EQU   GTFPCT+260
EQMIN    EQU   GTFPCT+256
EQLENGTH EQU   GTFPCT+252
WQMAX    EQU   GTFPCT+248
WQLENGTH EQU   GTFPCT+244
QLECBP   EQU   QLOCKECB
@NM00007 EQU   QLOCKECB
@NM00006 EQU   QLOCKWRD+3
SCHEDBUF EQU   QLOCKWRD+2
POSTWRIT EQU   QLOCKWRD+1
QLOCK    EQU   QLOCKWRD
WRITERDD EQU   GTFPCT+228
GTFLOSTR EQU   GTFPCT+224
SRBAVAIL EQU   GTFSSRB
WRTRERRP EQU   WRTRERR
@NM00005 EQU   WRTRERR
TRMWRITP EQU   TRMWRIT
@NM00004 EQU   TRMWRIT
GTFCMECB EQU   GTFPCT+208
WRTRCOMP EQU   WRTRCOM
@NM00003 EQU   WRTRCOM
TRANSCNT EQU   GTFPCT+200
AHLRDPLQ EQU   GTFPCT+196
SFEOBRTN EQU   GTFPCT+192
SBLOKRTN EQU   GTFPCT+188
CURRBLOK EQU   GTFPCT+184
GBCDS    EQU   NEXTBLOK
WSMODEND EQU   GTFPCT+176
WSMODBEG EQU   GTFPCT+172
BCBPAGE  EQU   GTFPCT+156
SLEPAGE  EQU   GTFPCT+152
SAVECNT  EQU   GTFPCT+148
SLQHEAD  EQU   GTFPCT+144
HQLENGTH EQU   GTFPCT+140
QTAIL    EQU   GTFPCT+136
HQHEAD   EQU   GTFPCT+132
WQHEAD   EQU   GTFPCT+128
RQHEAD   EQU   GTFPCT+124
EQHEAD   EQU   GTFPCT+120
WPOSTSRB EQU   GTFPCT+116
WTSKTCBA EQU   GTFPCT+112
WRTRTCBA EQU   GTFPCT+108
TRMWTASK EQU   GTFPCT+104
WTSKATTH EQU   GTFPCT+100
WTSKINIT EQU   GTFPCT+96
WTASKECB EQU   GTFPCT+92
WMTABPTR EQU   GTFPCT+88
ATTCHECB EQU   GTFPCT+84
AHLECB   EQU   GTFPCT+80
STOPECBA EQU   GTFPCT+76
ECBADRLT EQU   GTFPCT+72
FIXLEN   EQU   GTFPCT+68
FIXPTR   EQU   GTFPCT+64
MCQEPTR  EQU   GTFPCT+56
GTFEIDL  EQU   GTFPCT+52
GTFPIBL  EQU   GTFPCT+48
GTFPIFT  EQU   GTFPCT+44
GTFSVCBL EQU   GTFPCT+40
GTFSVCFT EQU   GTFPCT+36
GTFIOBL  EQU   GTFPCT+32
GTFIOFT  EQU   GTFPCT+28
GTFSIOBL EQU   GTFPCT+24
GTFSIOFT EQU   GTFPCT+20
@NM00002 EQU   PCTCATF+1
PCTRR    EQU   PCTCATF+1
PCTSRM   EQU   PCTCATF+1
PCTRNIO  EQU   PCTCATF+1
PCTUSR   EQU   PCTCATF
PCTPI    EQU   PCTCATF
@NM00001 EQU   PCTCATF
PCTDSP   EQU   PCTCATF
PCTSIO   EQU   PCTCATF
PCTIO    EQU   PCTCATF
PCTEXT   EQU   PCTCATF
PCTSVC   EQU   PCTCATF
OPTTIME  EQU   GTFOPTS4
OPTRES3  EQU   GTFOPTS4
OPTIOSIO EQU   GTFOPTS3
OPTRES2  EQU   GTFOPTS3
OPTRR    EQU   GTFOPTS3
OPTSRM   EQU   GTFOPTS3
OPTRNIO  EQU   GTFOPTS3
OPTEXT   EQU   GTFOPTS3
OPTIOP   EQU   GTFOPTS2
OPTIO    EQU   GTFOPTS2
OPTPIP   EQU   GTFOPTS2
OPTPI    EQU   GTFOPTS2
OPTSIOP  EQU   GTFOPTS2
OPTSIO   EQU   GTFOPTS2
OPTSVCP  EQU   GTFOPTS2
OPTSVC   EQU   GTFOPTS2
OPTPCI   EQU   GTFOPTS1
OPTRES1  EQU   GTFOPTS1
OPTDSP   EQU   GTFOPTS1
OPTTRC   EQU   GTFOPTS1
OPTUSR   EQU   GTFOPTS1
OPTSYS   EQU   GTFOPTS1
OPTSYSP  EQU   GTFOPTS1
OPTSYSM  EQU   GTFOPTS1
GTFRESV  EQU   GTFSTAT
GTFDEBUG EQU   GTFSTAT
GTFMODE  EQU   GTFSTAT
GTFPCTID EQU   GTFPCT
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RT00059 EQU   PMT01
@RT00092 EQU   PMT02
@RT00125 EQU   PMT03
@RT00158 EQU   PMT04
@RT00205 EQU   PMT70
@RT00212 EQU   PMT69
@RT00222 EQU   PMT70
@RT00227 EQU   PMT07
@RT00233 EQU   PMT10
@RT00236 EQU   PMT08
@RT00238 EQU   PMT11
@RT00240 EQU   PMT11
@RT00245 EQU   PMT11
@RT00251 EQU   PMT12
@RT00258 EQU   PMT08
@RT00279 EQU   PMT15
@RT00283 EQU   PMT13
@RT00293 EQU   PMT09
@RT00310 EQU   PMT19
@RT00316 EQU   PMT19
@RT00324 EQU   PMT25
@RT00328 EQU   PMT09
@RT00341 EQU   PMT28
@RT00343 EQU   PMT31
@RT00348 EQU   PMT26A
@RC00353 EQU   PMT05
@RT00385 EQU   PMT34
@RT00387 EQU   PMT35
@RT00400 EQU   PMT19
@RT00406 EQU   PMT19
@RT00414 EQU   PMT39
@RT00418 EQU   PMT09
@RC00422 EQU   PMT05
@RT00431 EQU   PMT65
@RT00434 EQU   PMT40
@RT00436 EQU   PMT42
@RT00440 EQU   PMT42
@RT00445 EQU   PMT45
@RT00447 EQU   PMT44
@RT00480 EQU   PMT48
@RT00482 EQU   PMT47
@RT00499 EQU   PMT50
@RT00501 EQU   PMT49
@RT00518 EQU   PMT52
@RT00520 EQU   PMT51
@RT00537 EQU   PMT54
@RT00539 EQU   PMT53
@RT00562 EQU   PMT57
@RT00577 EQU   PMT56
@RT00581 EQU   PMT55
@RT00583 EQU   PMT68
@RT00587 EQU   PMT68
@RT00589 EQU   PMT63
@RT00604 EQU   PMT61
@RT00608 EQU   PMT70
@RT00613 EQU   PMT70
@ENDDATA EQU   *
         END   AHLTPMT,(C'PL/S-II',0502,73240)

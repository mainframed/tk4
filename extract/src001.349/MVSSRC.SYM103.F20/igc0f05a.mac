         TITLE 'IGC0F05A SNAP/GTF TRACE FORMAT MODULE                  *
                        '
IGC0F05A CSECT ,      YM08295
@MAINENT DS 0H        YM08295
    USING *,@15       YM08295
    B @PROLOG         YM08295
    DC  AL1(16)       YM08295
    DC  C'IGC0F05A  74.073'
    DROP @15          YM08295
@PROLOG STM @14,@12,12(@13)   YM08295
    BALR @11,0        YM08295
@PSTART LA @12,4095(,@11) YM08295
    USING @PSTART,@11
    USING @PSTART+4095,@12  YM08295
    L @05,0(@01)     TCB PTR YM08295
    L @00,@SIZDATD     YM08295
    GETMAIN RC,LV=(0)  COND GETMAIN  YM08295
*   IF RETCODE^=0 THEN              /* IF CANT GET STORAGE   @YM08295*/
         LTR   RETCODE,RETCODE                                     0187
         BZ    @RF00187                                            0187
*     DO;                           /*                       @YM08295*/
*       GEN;                                                       0189
*     /* @YM08295*/
    NI TCBGTOFM(@05),B'11111110' ENABLE GTF TRACING YM08295
    LA @15,4  RETURN CODE YM08295
    L @14,12(@13)  YM08295
    LM @00,@12,20(@13)  YM08295
    BR @14  YM08295
*     END;                          /*                       @YM08295*/
*   GEN;                                                           0191
*                                                                  0191
@RF00187 DS    0H                                                  0191
   LR @08,@01   YM08295
   LA @10,4095(@08)  YM08295
   USING @DATD,@08   YM08295
   USING @DATD+4095,@10  YM08295
   ST @13,@SA00001+4   YM08295
   LM @00,@01,20(@13)  YM08295
   ST @08,8(,@13)      YM08295
   LR @13,@08          YM08295
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @YL02014*/
*   /* ESTABLISH ERROR PROTECTION                            @YL02014*/
*   /*                                                       @YL02014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0192
*   RFY                                                            0192
*    (GENREG,                                                      0192
*     ESTAEREG,                                                    0192
*     PARMRG1) RSTD;                                               0192
*   ABDPLPTR=PARMRG1;               /* GET PTR TO SNAPS PARM LIST  0193
*                                                            @YL02014*/
         ST    PARMRG1,ABDPLPTR                                    0193
*   ESTAEPTR=ADDR(EPLD);            /* SET UP ADDR OF ESTAE        0194
*                                      PARAMETERS                    */
         LA    @14,EPLD                                            0194
         ST    @14,ESTAEPTR                                        0194
*   ESTADTA1=ADDRDTA1;              /* PUT ADDR OF REENTRANT DATA IN
*                                      ESTAE PARAMETER LIST  @YL02014*/
         ST    ADDRDTA1,ESTADTA1(,@14)                             0195
*   ESTADTA2=ADDRDTA2;              /* PUT ADDR OF REENTRANT DATA IN
*                                      ESTAE PARAMETER LIST  @YL02014*/
         ST    ADDRDTA2,ESTADTA2(,@14)                             0196
*   TCBPTR=ADPLTCB;                 /*                       @YL02014*/
         L     @05,ABDPLPTR                                        0197
         MVC   TCBPTR(4),ADPLTCB(@05)                              0197
*   GENREG=ADDR(IGCESTAE);          /* STORE ADDR OF ESTAE ROUTINE IN
*                                      REGISTER FOR ESTAE    @YL02014*/
         LA    GENREG,IGCESTAE                                     0198
*   ESTAEREG=ADDR(ESTAPARM);        /* STORE ADR OF ESTAE PARAM LIST
*                                                            @YL02014*/
         LR    ESTAEREG,@14                                        0199
*   ESLIST(1:16)='00'X;             /* ENSURE UNUSED FIELDS ARE ZERO
*                                                            @ZA29403*/
         XC    ESLIST+1(15),ESLIST+1                               0200
         MVI   ESLIST,X'00'                                        0200
*   GEN REFS(GENREG,ESTAEREG,ESLIST);                              0201
*                                      /* ESTABLISH ESTAE    @ZA29403*/
         ESTAE (GENREG),CT,PARAM=(ESTAEREG),TERM=YES,        @ZA29403  *
               ASYNCH=YES,PURGE=NONE,MF=(E,ESLIST)           @ZA29403
*   RFY                                                            0202
*    (GENREG,                                                      0202
*     ESTAEREG,                                                    0202
*     PARMRG1) UNRSTD;              /*                       @YL02014*/
*   IF RETCODE^=0 THEN              /* TEST FOR ERROR IN ESTAE     0203
*                                                            @YL02014*/
         LTR   RETCODE,RETCODE                                     0203
         BZ    @RF00203                                            0203
*     DO;                           /* ESTAE ERROR PATH      @YL02014*/
*       MSGIND=1;                   /* INDICATE MSG IEA931I  @YL02014*/
         MVC   MSGIND(2),@CH00063                                  0205
*       CALL ERRPROC;               /*                       @YL02014*/
         BAL   @14,ERRPROC                                         0206
*       TCBGTOFM='0'B;              /* ENABLE GTF TRACING    @YL02014*/
         L     @14,TCBPTR                                          0207
         NI    TCBGTOFM(@14),B'11111110'                           0207
*       RETURN CODE(4);             /* RETURN TO SYSTEM INDICATING 0208
*                                      THAT THE BUFFERS ARE NOT    0208
*                                      FORMATTED                     */
         L     @13,4(,@13)                                         0208
         L     @00,@SIZDATD                                        0208
         LR    @01,@08                                             0208
         FREEMAIN R,LV=(0),A=(1)
         LA    @15,4                                               0208
         L     @14,12(,@13)                                        0208
         LM    @00,@12,20(@13)                                     0208
         BR    @14                                                 0208
*     END;                          /* END OF ESTAE ERROR PATH     0209
*                                                            @YL02014*/
*   FMTSNAP=ABDPLPTR;               /* STORE SNAP PARM LIST PTR      */
@RF00203 MVC   FMTSNAP(4),ABDPLPTR                                 0210
*   AUDIT=AUDIT&&AUDIT;             /* ZERO OUT AUDIT FLAGS  @YL02014*/
         XC    AUDIT(4),AUDIT                                      0211
*   INFO=INFO&&INFO;                /* ZERO OUT INFO FLAGS   @YL02014*/
*                                                                  0212
         XC    INFO(4),INFO                                        0212
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @YL02014*/
*   /* GET STORAGE FOR AHLREADS BUFFER AND ZERO OUT BUFFER   @YL02014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0213
*   RDRBUFLN=FOURK;                 /*                       @YL02014*/
         LH    @14,@CH02312                                        0213
         ST    @14,RDRBUFLN                                        0213
*   DO;                             /* GETMAIN (EC) LV(RDRBUFLN)   0214
*                                      A(READBUFF) SP(SQA)           */
*     RESPECIFY                                                    0215
*      (GPR01P) RESTRICTED;                                        0215
*     I004=I004&&I004;              /* INIT LIST                     */
         XC    I004(10),I004                                       0216
*     I00404='20'X;                 /* TYPE                          */
         MVI   I00404,X'20'                                        0217
*     I00401=RDRBUFLN;              /* LENGTH                        */
         ST    @14,I00401                                          0218
*     I00403=ADDR(READBUFF);        /* ADDR OF ADDR LIST             */
         LA    @14,READBUFF                                        0219
         STCM  @14,7,I00403                                        0219
*     I00405=SQA;                   /* SUBPOOL VALUE                 */
         MVI   I00405,X'F5'                                        0220
*     GPR01P=ADDR(I004);            /* REG1 POINTS TO LIST           */
         LA    GPR01P,I004                                         0221
*     SVC(4);                       /* STANDARD-FORM OF GETMAIN      */
         SVC   4                                                   0222
*     RESPECIFY                                                    0223
*      (GPR01P) UNRESTRICTED;                                      0223
*   END;                            /* GETMAIN (EC) LV(RDRBUFLN)   0224
*                                      A(READBUFF) SP(SQA)           */
*   IF RETCODE^=0 THEN              /* TEST FOR GETMAIN ERROR      0225
*                                                            @YL02014*/
         LTR   RETCODE,RETCODE                                     0225
         BZ    @RF00225                                            0225
*     DO;                           /* GETMAIN ERROR PATH    @YL02014*/
*       MSGIND=2;                   /* INDICATE MSG IEA932I  @YL02014*/
         MVC   MSGIND(2),@CH00075                                  0227
*       CALL ERRPROC;               /*                       @YL02014*/
         BAL   @14,ERRPROC                                         0228
*       TCBGTOFM='0'B;              /* ENABLE GTF TRACING    @YL02014*/
         L     @14,TCBPTR                                          0229
         NI    TCBGTOFM(@14),B'11111110'                           0229
*       GENERATE(ESTAE 0);          /* CANCEL ESTAE          @YL02014*/
         ESTAE 0
*       RETURN CODE(4);             /* INDICATE TO SNAP THAT NO    0231
*                                      BUFFERS WERE FORMATTED      0231
*                                                            @YL02014*/
         L     @13,4(,@13)                                         0231
         L     @00,@SIZDATD                                        0231
         LR    @01,@08                                             0231
         FREEMAIN R,LV=(0),A=(1)
         LA    @15,4                                               0231
         L     @14,12(,@13)                                        0231
         LM    @00,@12,20(@13)                                     0231
         BR    @14                                                 0231
*     END;                          /* END OF GETMAIN ERR PATH     0232
*                                                            @YL02014*/
*   RFY                                                            0233
*    (RETCODE) UNRSTD;              /*                       @YL02014*/
*                                                                  0233
@RF00225 DS    0H                                                  0234
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @YL02014*/
*   /*                                                       @YL02014*/
*   /*                                                       @YL02014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0234
*   ADTNGENT='1'B;                  /* INDICATE ENTRY AS CALLING RTN */
         OI    ADTNGENT,B'10000000'                                0234
*   CALL INITPROC;                  /*                       @YL02014*/
*                                                                  0235
         BAL   @14,INITPROC                                        0235
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @YL02014*/
*   /*                                                       @YL02014*/
*   /*                                                       @YL02014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0236
*   CALL CONTROL;                   /*                       @YL02014*/
*                                                                  0236
         BAL   @14,CONTROL                                         0236
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @YL02014*/
*   /*                                                       @YL02014*/
*   /*                                                       @YL02014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0237
*   CALL EXITPROC;                  /*                       @YL02014*/
*                                                                  0237
         BAL   @14,EXITPROC                                        0237
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @YL02014*/
*   /* CANCEL ERROR PROTECTION                               @YL02014*/
*   /*                                                       @YL02014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0238
*   GENERATE(ESTAE 0);              /*                       @YL02014*/
         ESTAE 0
*   RETURN CODE(0);                 /*                       @YL02014*/
         L     @13,4(,@13)                                         0239
         L     @00,@SIZDATD                                        0239
         LR    @01,@08                                             0239
         FREEMAIN R,LV=(0),A=(1)
         SLR   @15,@15                                             0239
         L     @14,12(,@13)                                        0239
         LM    @00,@12,20(@13)                                     0239
         BR    @14                                                 0239
*IGCESTAE:                                                         0240
*   DO;                                                            0240
IGCESTAE DS    0H                                                  0241
*     RFY                                                          0241
*      (PARMRG0,                                                   0241
*       PARMRG1,                                                   0241
*       PARMRG2,                                                   0241
*       ESTACODE,                                                  0241
*       SAVE14,                                                    0241
*       RETRTM) RSTD;                                              0241
*     GENERATE;                                                    0242
       USING *,@15
       B ESTAERTN
       DS 0F
IGCBASE DC AL4(@PSTART)
        DC AL4(@PSTART+4095)
TWELVE  DC F'12'
*ESTAERTN:                                                         0243
*     IF ESTACODE=TWELVE THEN       /* CHECK FOR RTCA        @YL02014*/
ESTAERTN C     ESTACODE,TWELVE                                     0243
         BNE   @RF00243                                            0243
*       DO;                         /* START OF NO RTCA PATH @YL02014*/
*         ADDRDTA1=PARMRG2->ESTADTA1;/* SET UP ADDRESSABILITY      0245
*                                                            @YL02014*/
         L     ADDRDTA1,ESTADTA1(,PARMRG2)                         0245
*         ADDRDTA2=PARMRG2->ESTADTA2;/* TO REENTRANT DATA AREA     0246
*                                                            @YL02014*/
         L     ADDRDTA2,ESTADTA2(,PARMRG2)                         0246
*         SAVE14=RETRTM;            /* SAVE RETURN ADDR TO RTM     0247
*                                                            @YL02014*/
         LR    SAVE14,RETRTM                                       0247
*         SAVECODE=ESTACODE;        /* SAVE ESTAE CODE FROM REG0   0248
*                                                            @YL02014*/
         ST    ESTACODE,SAVECODE                                   0248
*         GENERATE;                                                0249
       LM @11,@12,IGCBASE
       USING @PSTART,@11
       USING  @PSTART+4095,@12
       DROP @15
       LA @13,ESTAESAV
*       END;                        /* END OF NO RTCA PATH   @YL02014*/
*     ELSE                                                         0251
*       DO;                         /* START OF RTCA EXISTS PATH   0251
*                                                            @YL02014*/
         B     @RC00243                                            0251
@RF00243 DS    0H                                                  0252
*         GENERATE;                                                0252
         USING IGCESTAE,@15
         STM @14,@12,12(@13)
         LM @11,@12,IGCBASE
         USING @PSTART,@11
         USING  @PSTART+4095,@12
         DROP @15
*         ADDRDTA1=EPARM->ESTADTA1;                                0253
         L     @15,EPARM(,PARMRG1)                                 0253
         L     ADDRDTA1,ESTADTA1(,@15)                             0253
*         ADDRDTA2=EPARM->ESTADTA2;                                0254
         L     ADDRDTA2,ESTADTA2(,@15)                             0254
*         GENERATE;                                                0255
         ST @13,ESTAESAV+4
         LA @14,ESTAESAV
         ST @14,8(,@13)
         LR @13,@14
*         SDWAPTR=PARMRG1;          /* ESTABLISH ADDR FOR SDWA     0256
*                                                            @YL02014*/
         ST    PARMRG1,SDWAPTR                                     0256
*         SAVECODE=ESTACODE;        /* SAVE ESTAE CODE FROM RG0    0257
*                                                            @YL02014*/
         ST    ESTACODE,SAVECODE                                   0257
*         RFY                                                      0258
*          (ESTACODE,                                              0258
*           PARMRG2,                                               0258
*           RETRTM) UNRSTD;                                        0258
*                                                                  0258
*         /***********************************************************/
*         /*                                                         */
*         /* RETRY IF SDWA INDICATES                         @YL02014*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0259
*         IF SDWAMCHK='1'B THEN     /* CHECK FOR MACHINE CHECK     0259
*                                                            @YL02014*/
         L     @06,SDWAPTR                                         0259
         TM    SDWAMCHK(@06),B'10000000'                           0259
         BNO   @RF00259                                            0259
*           DO;                     /* MACHINE CHECK PATH    @YL02014*/
*             IF SDWAINSF='1'B THEN /* CHECK FOR INSTRUCTION @YL02014
*                                      PATH                  @YL02014*/
         TM    SDWAINSF(@06),B'00000100'                           0261
         BNO   @RF00261                                            0261
*               DO;                 /* INSTRUCTION ERROR PATH      0262
*                                                            @YL02014*/
*                 IF SDWAREGU='0'B&SDWAPSWU='0'B THEN              0263
*                                                                  0263
         TM    SDWAREGU(@06),B'01100000'                           0263
         BNZ   @RF00263                                            0263
*                   /*************************************************/
*                   /*                                               */
*                   /* RETRY POSSIBLE                        @YL02014*/
*                   /*                                               */
*                   /*************************************************/
*                                                                  0264
*                   DO;             /* START OF RETRY PATH   @YL02014*/
*                     DO;           /* SETRP RETADDR(MCHKRTRY)RECORD(
*                                      YES)RC(SDWARETY)FRESDWA(YES)WK
*                                      AREA(SDWAPTR)RECPARM(SETRPARM)
*                                      DUMP(NO)                      */
*                       RESPECIFY                                  0266
*                        (GPR00P,                                  0266
*                         GPR01P,                                  0266
*                         GPR14P,                                  0266
*                         GPR15P) RSTD;                            0266
*                       GPR01P=SDWAPTR;                            0267
         LR    GPR01P,@06                                          0267
*                       GPR01P->SDWARCDE=SDWARETY;/* STORE RC INTO 0268
*                                      SDWA                          */
         MVI   SDWARCDE(GPR01P),X'04'                              0268
*                       GPR01P->SDWARTYA=ADDR(MCHKRTRY);/* SAVE RETRY
*                                      ADDRESS                       */
         MVC   SDWARTYA(4,GPR01P),SDWANXT1(@06)                    0269
*                       GPR01P->SDWAFREE='1'B;/* SET FLAG TO FREE  0270
*                                      SDWA                          */
*                       GPR01P->SDWARCRD='1'B;/* TURN ON RECORD    0271
*                                      INDICATOR                     */
         OI    SDWAFREE(GPR01P),B'10000100'                        0271
*                       GPR15P=ADDR(SETRPARM);/* ACCESS RECORD     0272
*                                      PARAMETER LIST                */
         LA    GPR15P,SETRPARM                                     0272
*                       GPR01P->SDWARECP=GPR15P->I256C(1:24);/* COPY
*                                      RECORD PARAMETERS             */
         MVC   SDWARECP(24,GPR01P),I256C(GPR15P)                   0273
*                       GPR01P->SDWAREQ='0'B;/* TURN OFF DUMP      0274
*                                      INDICATOR                     */
         NI    SDWAREQ(GPR01P),B'01111111'                         0274
*                       RESPECIFY                                  0275
*                        (GPR00P,                                  0275
*                         GPR01P,                                  0275
*                         GPR14P,                                  0275
*                         GPR15P) UNRSTD;                          0275
*                     END;                                         0276
*                                                                  0276
*                     /***********************************************/
*                     /*                                             */
*                     /*                                     @YM04485*/
*                     /*                                             */
*                     /***********************************************/
*                                                                  0277
*                     GENERATE;                                    0277
*                                                          /*@YL02014*/
          L @13,4(,@13)
          LM @14,@12,12(@13)
          BR @14
*                   END;            /* END OF RETRY PATH     @YL02014*/
*               END;                /* END OF INSTRUCTION ERROR PATH
*                                                            @YL02014*/
@RF00263 DS    0H                                                  0280
*           END;                    /* END OF MACHINE CHK PATH     0280
*                                                            @YL02014*/
@RF00261 DS    0H                                                  0281
*       END;                        /* END OF RTCA EXISTS PATH     0281
*                                                            @YL02014*/
*                                                                  0281
@RF00259 DS    0H                                                  0282
*     /***************************************************************/
*     /*                                                             */
*     /* CHECK FOR NO RTCA OR FORMAT APPENDAGE IN CONTROL    @YL02014*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0282
*     IF(ADTEDFMT='0'B)×(ADTEDHEX='1'B)×(SAVECODE=12) THEN         0282
@RC00243 TM    ADTEDFMT,B'00010000'                                0282
         BZ    @RT00282                                            0282
         TM    ADTEDHEX,B'00000100'                                0282
         BO    @RT00282                                            0282
         CLC   SAVECODE(4),@CF00033                                0282
         BNE   @RF00282                                            0282
@RT00282 DS    0H                                                  0283
*       DO;                         /* START OF ERR OCCURRED IN    0283
*                                      IGC0F05A OR HEX FORMAT      0283
*                                      APPENDAGE OR NO RTCA EXISTS 0283
*                                      PATH                  @YL02014*/
*         IF SAVECODE^=12 THEN                                     0284
         CLC   SAVECODE(4),@CF00033                                0284
         BE    @RF00284                                            0284
*           DO;                     /*                       @YL02014*/
*             GENERATE;                                            0286
*                                /* SAVE APPROPRIATE REGS FOR RETRY */
           L @06,SDWAPTR
           STM @08,@12,SDWASR08(@06)  SAVE BASE REGS AND DATA REGS
           LA @01,@SA00001  SAVE IGC0F05A SAVE AREA FOR
           ST @01,SDWASR13(,@06)  FOR RETURN TO ABEND
*             DO;                   /* SETRP RETADDR(EXIT)RECORD(YES)
*                                      WKAREA(SDWAPTR)RC(SDWARETY)REC
*                                      PARM(SETRPARM)FRESDWA(YES)RETR
*                                      EGS(YES)DUMP(NO)              */
*               RESPECIFY                                          0288
*                (GPR00P,                                          0288
*                 GPR01P,                                          0288
*                 GPR14P,                                          0288
*                 GPR15P) RSTD;                                    0288
*               GPR01P=SDWAPTR;                                    0289
         L     GPR01P,SDWAPTR                                      0289
*               GPR01P->SDWARCDE=SDWARETY;/* STORE RC INTO SDWA      */
         MVI   SDWARCDE(GPR01P),X'04'                              0290
*               GPR01P->SDWARTYA=ADDR(EXIT);/* SAVE RETRY ADDRESS    */
         LA    @06,EXIT                                            0291
         ST    @06,SDWARTYA(,GPR01P)                               0291
*               GPR01P->SDWAFREE='1'B;/* SET FLAG TO FREE SDWA       */
*               GPR01P->SDWARCRD='1'B;/* TURN ON RECORD INDICATOR    */
         OI    SDWAFREE(GPR01P),B'10000100'                        0293
*               GPR15P=ADDR(SETRPARM);/* ACCESS RECORD PARAMETER LIST*/
         LA    GPR15P,SETRPARM                                     0294
*               GPR01P->SDWARECP=GPR15P->I256C(1:24);/* COPY RECORD
*                                      PARAMETERS                    */
         MVC   SDWARECP(24,GPR01P),I256C(GPR15P)                   0295
*               GPR01P->SDWAREQ='0'B;/* TURN OFF DUMP INDICATOR      */
         NI    SDWAREQ(GPR01P),B'01111111'                         0296
*               GPR01P->SDWAUPRG='1'B;/* TURN ON RETREGS INDICATOR   */
         OI    SDWAUPRG(GPR01P),B'00001000'                        0297
*               RESPECIFY                                          0298
*                (GPR00P,                                          0298
*                 GPR01P,                                          0298
*                 GPR14P,                                          0298
*                 GPR15P) UNRSTD;                                  0298
*             END;                  /*                       @YM04485
*                                                            @YL02014*/
*             GENERATE;                                            0300
*                                                          /*@YL02014*/
          L @13,4(,@13)
          LM @14,@12,12(@13)
          BR @14
*           END;                    /*                       @YL02014*/
*EXIT:                                                             0302
*         DO;                       /*                       @YL02014*/
@RF00284 DS    0H                                                  0302
EXIT     DS    0H                                                  0303
*           GEN(ESTAE 0);                                          0303
         ESTAE 0
*           CALL EXITPROC;          /*                       @YL02014*/
         BAL   @14,EXITPROC                                        0304
*           IF SAVECODE=12 THEN     /* WAS THERE ANY SDWA?   @YL02014*/
         CLC   SAVECODE(4),@CF00033                                0305
         BNE   @RF00305                                            0305
*             DO;                   /* RETURN CODE FOR NO DSWA PATH
*                                                            @YL02014*/
*               GENERATE;                                          0307
              L @00,@SIZDATD
              LR @01,@08
              FREEMAIN R,LV=(0),A=(1)
              LA @15,4
              LR @14,@07
              BR @14
*             END;                  /* END OF RET CODE FOR NO SDWA 0308
*                                                            @YL02014*/
*           RETURN CODE(4);                                        0309
@RF00305 L     @13,4(,@13)                                         0309
         L     @00,@SIZDATD                                        0309
         LR    @01,@08                                             0309
         FREEMAIN R,LV=(0),A=(1)
         LA    @15,4                                               0309
         L     @14,12(,@13)                                        0309
         LM    @00,@12,20(@13)                                     0309
         BR    @14                                                 0309
*         END EXIT;                 /*                       @YL02014*/
*       END;                        /* END OF ERR OCCURRED IN      0311
*                                      IGC0F05A OR USR FORMAT      0311
*                                      APPENDAGE OR NO RTCA EXISTS 0311
*                                      PATH                  @YL02014*/
*     GENERATE;                                                    0312
@RF00282 DS    0H                                                  0312
*             /* SAVE APPROPRIATE REGS FOR RETRY */
  L @06,SDWAPTR
  STM @08,@12,SDWASR08(@06)     SAVE BASE REGS AND DATA REGS FOR
  LA @01,@SA00001     SAVE IGC0F05A SAVE AREA FOR
  ST @01,SDWASR13(,@06)    RETURN TO ABEND
*     IF ADTNGSYS='0'B THEN         /* CHECK FOR USER FMT APP IN   0313
*                                      CONTROL               @YM06917*/
         TM    ADTNGSYS,B'00000010'                                0313
         BNZ   @RF00313                                            0313
*       DO;                         /* CHANGE PLIST FOR LOGREC TO  0314
*                                      GIVE USER FMT APP NAME      0314
*                                                            @YM06917*/
*         SETMOD=EXITNM;            /*                       @YM06917*/
         MVC   SETMOD(8),EXITNM                                    0315
*         SETCSECT=EXITNM;          /*                       @YM06917*/
         MVC   SETCSECT(8),EXITNM                                  0316
*       END;                        /*                       @YM06917*/
*     DO;                           /* SETRP RETADDR(IGCRETRY)RECORD(
*                                      YES)WKAREA(SDWAPTR)RC(SDWARETY
*                                      )RECPARM(SETRPARM)FRESDWA(YES)
*                                      RETREGS(YES)DUMP(NO)          */
@RF00313 DS    0H                                                  0319
*       RESPECIFY                                                  0319
*        (GPR00P,                                                  0319
*         GPR01P,                                                  0319
*         GPR14P,                                                  0319
*         GPR15P) RSTD;                                            0319
*       GPR01P=SDWAPTR;                                            0320
         L     GPR01P,SDWAPTR                                      0320
*       GPR01P->SDWARCDE=SDWARETY;  /* STORE RC INTO SDWA            */
         MVI   SDWARCDE(GPR01P),X'04'                              0321
*       GPR01P->SDWARTYA=ADDR(IGCRETRY);/* SAVE RETRY ADDRESS        */
         LA    @06,IGCRETRY                                        0322
         ST    @06,SDWARTYA(,GPR01P)                               0322
*       GPR01P->SDWAFREE='1'B;      /* SET FLAG TO FREE SDWA         */
*       GPR01P->SDWARCRD='1'B;      /* TURN ON RECORD INDICATOR      */
         OI    SDWAFREE(GPR01P),B'10000100'                        0324
*       GPR15P=ADDR(SETRPARM);      /* ACCESS RECORD PARAMETER LIST  */
         LA    GPR15P,SETRPARM                                     0325
*       GPR01P->SDWARECP=GPR15P->I256C(1:24);/* COPY RECORD        0326
*                                      PARAMETERS                    */
         MVC   SDWARECP(24,GPR01P),I256C(GPR15P)                   0326
*       GPR01P->SDWAREQ='0'B;       /* TURN OFF DUMP INDICATOR       */
         NI    SDWAREQ(GPR01P),B'01111111'                         0327
*       GPR01P->SDWAUPRG='1'B;      /* TURN ON RETREGS INDICATOR     */
         OI    SDWAUPRG(GPR01P),B'00001000'                        0328
*       RESPECIFY                                                  0329
*        (GPR00P,                                                  0329
*         GPR01P,                                                  0329
*         GPR14P,                                                  0329
*         GPR15P) UNRSTD;                                          0329
*     END;                          /*                       @ZA24358*/
*     SETMOD='IGC0F05A';            /* RESTORE IGC NAME IN SETRP PARM
*                                      LIST                  @YM06917*/
         MVC   SETMOD(8),@CC02660                                  0331
*     SETCSECT='IGC0F05A';          /*                       @YM06917*/
         MVC   SETCSECT(8),@CC02660                                0332
*     GENERATE;                                                    0333
*             /* RETURN TO RTM @YL02014*/
  L @13,4(,@13)
  LM @14,@12,12(@13)
  BR @14
*IGCRETRY:                                                         0334
*     IF TRCCLS(1:4)='1110'B THEN   /* CHECK FOR USR CLASS   @YL02014*/
IGCRETRY L     @06,FMTEID                                          0334
         TM    TRCCLS(@06),B'11100000'                             0334
         BNO   @RF00334                                            0334
         TM    TRCCLS(@06),B'00010000'                             0334
         BNZ   @RF00334                                            0334
*       DO;                         /*                       @YL02014*/
*         CALL HDRPATH;             /*                       @YL02014
*                                                            @YL02014*/
         BAL   @14,HDRPATH                                         0336
*       END;                        /*                       @YL02014*/
*     CALL HEXFORMT;                /*                       @YL02014*/
@RF00334 BAL   @14,HEXFORMT                                        0338
*     PGMCKMOD=EXITNM;              /* GET MODULE NAME FOR MSG ABOUT
*                                      PGM CHECK             @YL02014*/
         MVC   PGMCKMOD(8),EXITNM                                  0339
*     PGMCKPSW=SDWAEC1;             /* GET PROGRAM CHECK OLD PSW     */
         L     @06,SDWAPTR                                         0340
         MVC   PGMCKPSW(8),SDWAEC1(@06)                            0340
*     PGMCKADR=EPA;                 /* GET ADDR OF MODULE FOR MSG  0341
*                                      ABOUT PGM CHECK       @YL02014*/
         MVC   PGMCKADR(3),EPA                                     0341
*     PARMRG1=ABDPLPTR;             /*                       @YL02014*/
         L     @06,ABDPLPTR                                        0342
         LR    PARMRG1,@06                                         0342
*     ADPLFMT2=ADDR(PGMCKDTA);      /* SET UP ADDR PSW       @YL02014*/
         LA    @15,PGMCKDTA                                        0343
         ST    @15,ADPLFMT2(,@06)                                  0343
*     PARMRG0=ADDR(PGMCKFP);        /*                       @YL02014*/
         LA    PARMRG0,PGMCKFP                                     0344
*     CALL FRMTLINE;                /*                       @YL02014*/
         L     @15,ADPLFRMT(,@06)                                  0345
         BALR  @14,@15                                             0345
*     CALL PRNTLINE;                /*                       @YL02014*/
         L     @06,ABDPLPTR                                        0346
         L     @15,ADPLPRNT(,@06)                                  0346
         BALR  @14,@15                                             0346
*     LOCREGS=SDWAGRSV;             /* GET REGS AT TIME OF INTERRUPT
*                                      FROM RTCA             @YL02014*/
         L     @06,SDWAPTR                                         0347
         MVC   LOCREGS(64),SDWAGRSV(@06)                           0347
*     ADPLFMT2=ADDR(LOCREGS);       /* SET UP ADDR OF REG CONTENTS 0348
*                                                            @YL02014*/
         L     @06,ABDPLPTR                                        0348
         LA    @15,LOCREGS                                         0348
         ST    @15,ADPLFMT2(,@06)                                  0348
*     PARMRG0=ADDR(REGFP1);         /*                       @YL02014*/
         LA    PARMRG0,REGFP1                                      0349
*     CALL FRMTLINE;                /*                       @YL02014*/
         L     @15,ADPLFRMT(,@06)                                  0350
         BALR  @14,@15                                             0350
*     CALL PRNTLINE;                /*                       @YL02014*/
         L     @06,ABDPLPTR                                        0351
         L     @15,ADPLPRNT(,@06)                                  0351
         BALR  @14,@15                                             0351
*     PARMRG0=ADDR(REGFP2);         /*                       @YL02014*/
         LA    PARMRG0,REGFP2                                      0352
*     CALL FRMTLINE;                /*                       @YL02014*/
         L     @06,ABDPLPTR                                        0353
         L     @15,ADPLFRMT(,@06)                                  0353
         BALR  @14,@15                                             0353
*     CALL PRNTLINE;                /*                       @YL02014*/
         L     @06,ABDPLPTR                                        0354
         L     @15,ADPLPRNT(,@06)                                  0354
         BALR  @14,@15                                             0354
*     IF TRCCLS(1:4)='1110'B THEN                                  0355
         L     @06,FMTEID                                          0355
         TM    TRCCLS(@06),B'11100000'                             0355
         BNO   @RF00355                                            0355
         TM    TRCCLS(@06),B'00010000'                             0355
         BNZ   @RF00355                                            0355
*       DO;                         /*                       @YL02014*/
*         USRINDEX=RCDFID;          /*                       @YL02014*/
         L     @06,CURREC                                          0357
         SLR   @15,@15                                             0357
         IC    @15,RCDFID(,@06)                                    0357
         ST    @15,USRINDEX                                        0357
*         USRHXBIT(USRINDEX)='1'B;  /*                       @YL02014*/
         LA    @06,USRHXBIT-1(@15)                                 0358
         OI    0(@06),B'10000000'                                  0358
*         GENERATE;                                                0359
*                                 /* GO TO USRFORMT TO CONTINUE RETRY*/
           LA @14,USRRETRY
           LA @15,8
           BR @14
*       END;                                                       0360
*     ELSE                                                         0361
*       DO;                         /*                       @YL02014*/
         B     @RC00355                                            0361
@RF00355 DS    0H                                                  0362
*         GENERATE;                                                0362
*                                 /* GO TO SYSFORMT TO CONTINUE RETRY*/
           LA @14,SYSRETRY
           LA @15,8
           BR @14
*       END;                        /*                       @YL02014*/
*     RFY                                                          0364
*      (PARMRG0,                                                   0364
*       PARMRG1,                                                   0364
*       SAVE14) UNRSTD;                                            0364
@RC00355 DS    0H                                                  0365
*   END IGCESTAE;                   /* END OF ESTAE ROUTINE  @YL02014*/
*INITPROC:                                                         0366
*   PROC;                                                          0366
*                                                                  0366
@EL00001 L     @13,4(,@13)                                         0366
@EF00001 L     @00,@SIZDATD                                        0366
         LR    @01,@08                                             0366
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0366
         BR    @14                                                 0366
INITPROC STM   @14,@12,@SA00002                                    0366
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP FORMAT APPENDAGE PARAMETER LIST                @YL02014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0367
*   ADTEDINT='1'B;                  /* INDICATE INITPROC AS CALLED 0367
*                                      ROUTINE               @YL02014*/
         OI    ADTEDINT,B'10000000'                                0367
*   DO;                             /* GETMAIN (RC) LV(400) SP(250)  */
*     RESPECIFY                                                    0369
*      (GPR01F,                                                    0369
*       GPR15F,                                                    0369
*       GPR00F) RESTRICTED;                                        0369
*     GPR01F=0;                     /* REG 1 MUST BE ZERO            */
         SLR   GPR01F,GPR01F                                       0370
*     GPR15F=0;                     /* RC-TYPE GETMAIN               */
         SLR   GPR15F,GPR15F                                       0371
*     GPR00F=400;                   /* LENGTH REQUESTED              */
         LA    GPR00F,400                                          0372
*     GPR15F=GPR15F×((250)*256);    /* SP IN BYTE 2                  */
         O     GPR15F,@CF02887                                     0373
*     SVC(120);                     /* RC/RU-FORM OF GETMAIN         */
         SVC   120                                                 0374
*     RESPECIFY                                                    0375
*      (GPR01F,                                                    0375
*       GPR15F,                                                    0375
*       GPR00F) UNRESTRICTED;                                      0375
*   END;                            /* GETMAIN (RC) LV(400) SP(250)  */
*   IF RETCODE^=0 THEN              /* IF STORAGE UNAVAIL    @YM07534*/
         LTR   RETCODE,RETCODE                                     0377
         BZ    @RF00377                                            0377
*     DO;                           /*                       @YM07534*/
*       MSGIND=2;                   /* ERROR MSG FOR ERROR PROCESS 0379
*                                                            @YM07534*/
         MVC   MSGIND(2),@CH00075                                  0379
*       CALL ERRPROC;               /*                       @YM07534*/
         BAL   @14,ERRPROC                                         0380
*       TCBGTFOM='0'B;              /* ENABLE GTF TRACING    @YM07534*/
         SLR   @15,@15                                             0381
         ST    @15,TCBGTFOM                                        0381
*       DO;                         /* FREEMAIN(R)                 0382
*                                      LV(RDRBUFLN)SP(SQA)A(OUTBUFFR)*/
*         RESPECIFY                                                0383
*          (GPR01F,                                                0383
*           GPR00F) RESTRICTED;                                    0383
*         GPR00F=RDRBUFLN;          /* LENGTH REQUESTED              */
         L     GPR00F,RDRBUFLN                                     0384
*         GPR01F=SQA;               /* SP IN REG 1                   */
         LA    GPR01F,245                                          0385
*         GEN(SLL   GPR01F,24)                                     0386
*         NODEFS NOREFS NOSETS NOEXIT NOFLOWS SEQFLOW;             0386
         SLL   GPR01F,24
*         GPR00F=GPR00F×GPR01F;     /* SP IN HI BYTE                 */
         OR    GPR00F,GPR01F                                       0387
*         GPR01F=ADDR(OUTBUFFR);    /* SET REGISTER ONE              */
         L     GPR01F,READBUFF                                     0388
*         SVC(10);                  /* R-FORM OF GETMAIN             */
         SVC   10                                                  0389
*         RESPECIFY                                                0390
*          (GPR01F,                                                0390
*           GPR00F) UNRESTRICTED;                                  0390
*       END;                        /* FREEMAIN(R)                 0391
*                                      LV(RDRBUFLN)SP(SQA)A(OUTBUFFR)*/
*       GENERATE(ESTAE 0);          /* CANCEL ESTAE          @YM07534*/
         ESTAE 0
*       GEN;                                                       0393
        LA    15,4              INDICATE NO BUFFERS FORMATTED  @ZA30181
        L     13,4(,13)                                        @ZA30181
        L     14,12(,13)                                       @ZA30181
        LM    0,12,20(13)                                      @ZA30181
        BR    14                RETURN TO SNAP                 @ZA30181
*     END;                          /* END GETMAIN ERROR PATH      0394
*                                                            @YM07534*/
*   USRSAVE=PARMRG1;                /* SAVE AREA FOR USER RTN      0395
*                                                            @YM07534*/
@RF00377 ST    PARMRG1,USRSAVE                                     0395
*   GEN;                                                           0396
*     /*  @YM07534*/
 LA 1,72(1)    NON-ZERO PROT KEY WORK AREA FOR USER RTNS @YM07534
 ST 1,FMTWORK             @YM07534
 LA 1,200(1) PT TO OUTPUT BUFFER                            ZA00919
*   USROUT=PARMRG1;                 /* SAVE @ OF OUTPUT AREA FOR NON
*                                      KEY 0 USERS           @ZA00919*/
         ST    PARMRG1,USROUT                                      0397
*   FMTRTNAD=ADPLFRMT;              /* STORE ADDR OF FORMAT ROUTINE
*                                      FROM SNAPS PARM LIST INTO PARM
*                                      LIST FOR FORMAT APPENDAGE   0398
*                                                            @YL02014*/
*                                                                  0398
         L     @15,ABDPLPTR                                        0398
         MVC   FMTRTNAD(4),ADPLFRMT(@15)                           0398
*   /*****************************************************************/
*   /*                                                               */
*   /* NOTE ALSO: ADDRESS OF SNAPS PARM LIST ALREADY IN FORMAT       */
*   /* APPENDAGE PARM LIST                                   @YL02014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0399
*   FMTSNAP=ABDPLPTR;               /*                       @YL02014*/
*                                                                  0399
         ST    @15,FMTSNAP                                         0399
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @YL02014*/
*   /* ZERO OUT AMDPRTAB AND INITIALIZE                      @YL02014*/
*   /*                                                       @YL02014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0400
*   PRTABAD=ADDR(AMDPRTAB);         /* SET UP ADDR OF AMDPRTAB     0400
*                                                            @YL02014*/
         LA    @15,AMDPRTAB                                        0400
         ST    @15,PRTABAD                                         0400
*   PRTABLN=LENGTH(AMDPRTAB);       /* SET UP LENGTH OF PRTAB      0401
*                                                            @YL02014*/
         MVC   PRTABLN(4),@CF02888                                 0401
*   PRTABZIP=ADDR(ZERO);            /* ADDRESS OF ZERO FIELD @YL02014*/
         LA    @15,@CH00039+1                                      0402
         ST    @15,PRTABZIP                                        0402
*   PRTABPAD=ZERO;                  /* ZERO PAD              @YL02014*/
         MVI   PRTABPAD,X'00'                                      0403
*   PRTABZLN=1;                     /* LENGTH OF ZERO FIELD  @YL02014*/
         MVC   PRTABZLN(3),@CF00063+1                              0404
*   GENERATE;                                                      0405
*                                 /* SET UP REGISTERS FOR MOVE CHAR
         LM    R2,R5,PRTABMVC
         MVCL  R2,R4MOVE
*   ALLS='1'B;                      /* INDICATE PRINT SIO RCDS     0406
*                                                            @YL02014*/
         OI    ALLS,B'10000000'                                    0406
*   ALLI='1'B;                      /* INDICATE PRINT IO RCDS      0407
*                                                            @YL02014*/
         OI    ALLI,B'10000000'                                    0407
*   ALLV='1'B;                      /* INDICATE PRINT SVC RCDS     0408
*                                                            @YL02014*/
         OI    ALLV,B'10000000'                                    0408
*   ALLU='1'B;                      /* INDICATE PRINT USR RCDS     0409
*                                                            @YL02014*/
         OI    ALLU,B'10000000'                                    0409
*   ALLP='1'B;                      /* INDICATE PRINT PI RCDS      0410
*                                                            @YL02014*/
         OI    ALLP,B'10000000'                                    0410
*   EXT='1'B;                       /* INDICATE PRINT EXT RCDS     0411
*                                                            @YL02014*/
*   DSP='1'B;                       /* INDICATE PRINT DSP RCDS     0412
*                                                            @YL02014*/
*   RNIO='1'B;                      /* INDICATE PRNT RNIO RCDS     0413
*                                                            @YL02014*/
*   RR='1'B;                        /* INDICATE PRINT RR RCDS      0414
*                                                            @YL02014*/
*   SRM='1'B;                       /* INDICATE PRINT SRM RCDS     0415
*                                                            @YL02014*/
*                                                                  0415
         OI    EXT,B'11001110'                                     0415
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @YL02014*/
*   /* ZERO OUT SYSTAB AND USRTABL AND                       @YL02014*/
*   /* BLDLLIST AND TEMPIBUF,BLANK OUT TEMPOBUF              @YL02014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0416
*   ZEROSYS=''B;                    /* ZERO OUT SYSTAB       @YL02014*/
         XC    ZEROSYS(256),ZEROSYS                                0416
*   ZEROUSR=''B;                    /* ZERO OUT USRTABL      @YL02014*/
         XC    ZEROUSR(256),ZEROUSR                                0417
*   ZEROBLDL=''B;                   /* ZERO OUT BLDLLIST     @YL02014*/
         XC    ZEROBLDL(178),ZEROBLDL                              0418
*   ZEROIBUF(1:256)=''B;            /* ZERO OUT TEMP RECORD  @YL02014*/
         XC    ZEROIBUF(256),ZEROIBUF                              0419
*   ZEROIBUF(256:284)=''B;          /* ZERO OUT REST OF TEMP RCD     */
         XC    ZEROIBUF+255(29),ZEROIBUF+255                       0420
*   TEMPOBUF='';                    /* BLANK OUT TEMP PRINT BUF      */
         MVI   TEMPOBUF,C' '                                       0421
         MVC   TEMPOBUF+1(120),TEMPOBUF                            0421
*   ADTEDINT='0'B;                  /* TURN OFF AUDIT FLAGS  @YL02014*/
         NI    ADTEDINT,B'01111111'                                0422
*   END INITPROC;                                                  0423
@EL00002 DS    0H                                                  0423
@EF00002 DS    0H                                                  0423
@ER00002 LM    @14,@12,@SA00002                                    0423
         BR    @14                                                 0423
*CONTROL:                                                          0424
*   PROC;                                                          0424
CONTROL  STM   @14,@12,@SA00003                                    0424
*   ADTEDCTL='1'B;                  /* INDICATE CONTROL AS CALLED  0425
*                                      ROUTINE               @YL02014*/
         OI    ADTEDCTL,B'01000000'                                0425
*   FIRSTSW='1'B;                   /* GTF OPTION NEEDED     @YL02014*/
         OI    FIRSTSW,B'10000000'                                 0426
*   LLEFT=0;                        /* INIT # OF BYTES LEFT IN BUFFER*/
         SLR   @15,@15                                             0427
         STH   @15,LLEFT                                           0427
*   ERRBIT='0'B;                    /* INIT ERROR BIT        @YL02014*/
*   EOFIND='0'B;                    /* INIT EOFIND BIT       @YL02014*/
         NI    ERRBIT,B'10011111'                                  0429
*   DO WHILE(EOFIND='0'B);          /* START OF BUFF MGR PATH      0430
*                                                            @YL02014*/
         B     @DE00430                                            0430
@DL00430 DS    0H                                                  0431
*     CALL BUFFMGR;                 /*                       @YL02014*/
         BAL   @14,BUFFMGR                                         0431
*     IF EOFIND='0'B THEN                                          0432
         TM    EOFIND,B'00100000'                                  0432
         BNZ   @RF00432                                            0432
*       DO;                         /* START OF NOT EOF PATH @YL02014*/
*         IF ERRBIT='0'B THEN       /* CHECK FOR VALID LL FIELDS     */
         TM    ERRBIT,B'01000000'                                  0434
         BNZ   @RF00434                                            0434
*           DO;                     /* START OF VALID LL PATH      0435
*                                                            @YL02014*/
*             FMTINPUT=CURREC;      /* PUT POINTER TO CURRENT RECORD
*                                      INTO PARM LIST FOR FORMAT   0436
*                                      APPENDAGES            @YL02014*/
         L     @15,CURREC                                          0436
         ST    @15,FMTINPUT                                        0436
*             IF RCDAID='00'X THEN  /* CHECK FOR GTF CONTROL       0437
*                                      RECORD(00)                    */
         CLI   RCDAID(@15),X'00'                                   0437
         BNE   @RF00437                                            0437
*               DO;                 /* START OF CONTROL REC PATH     */
*                 IF RCDFID^='00'X THEN/* CHECK FOR VALID FID FIELD  */
         CLI   RCDFID(@15),X'00'                                   0439
         BE    @RF00439                                            0439
*                   DO;             /* START OF VALID FID FIELD      */
*                     IF(FIRSTSW='1'B)&(RCDFID='01'X) THEN/* CHECK 0441
*                                      FOR TIMESTAMP RECORD  @YL02014*/
         TM    FIRSTSW,B'10000000'                                 0441
         BNO   @RF00441                                            0441
         CLI   RCDFID(@15),X'01'                                   0441
         BNE   @RF00441                                            0441
*                       DO;         /* START OF FIRST TIMESTAMP    0442
*                                      RECORD PATH           @YL02014*/
*                         FOXGTF=TSGTFOPT;/* GET GTFOPTS FROM 1ST  0443
*                                      TIMESTAMP CONTROL RCD @YL02014*/
         MVC   FOXGTF(4),TSGTFOPT(@15)                             0443
*                         FMTGTF=ADDR(FOXGTF);/* STORE GTF OPTIONS IN
*                                      PARM LIST FOR FORMAT        0444
*                                      APPENDAGES            @YL02014*/
         LA    @14,FOXGTF                                          0444
         ST    @14,FMTGTF                                          0444
*                         IF TSGTFYES='1'B THEN/* TIMESTAMP ON       */
         TM    TSGTFYES(@15),B'00000001'                           0445
         BNO   @RF00445                                            0445
*                           DO;     /* START OF TIMESTAMP ON PATH    */
*                             OFSTDATA=TSDATAOF;/* SET UP DATA OFFSET*/
         MVC   OFSTDATA(2),TSDATAOF+2                              0447
*                             OFSTEID=TSEIDOF;/* SET UP EID OFFSET   */
         MVC   OFSTEID(2),TSEIDOF+2                                0448
*                           END;    /* END OF TIMESTAMP ON PATH      */
*                         ELSE                                     0450
*                           DO;     /* START OF TIMESTAMP OFF PATH   */
         B     @RC00445                                            0450
@RF00445 DS    0H                                                  0451
*                             OFSTDATA=DATAOF;/* SET UP DATA OFFSET  */
         MVC   OFSTDATA(2),DATAOF+2                                0451
*                             OFSTEID=EIDOF;/* SET UP EID OFFSET     */
         MVC   OFSTEID(2),EIDOF+2                                  0452
*                           END;    /* END OF TIMESTAMP OFF PATH     */
*                         FIRSTSW='0'B;/* TURN OFF FIRST TIMESTAMP 0454
*                                      RECORD INDICATOR      @YL02014*/
@RC00445 NI    FIRSTSW,B'01111111'                                 0454
*                         CALL CONREC;                             0455
         BAL   @14,CONREC                                          0455
*                       END;        /* END OF FIRST TIMESTAMP      0456
*                                                            @YL02014*/
*                     ELSE                                         0457
*                       DO;         /* START OF FID IN ERROR PATH  0457
*                                                            @YL02014*/
         B     @RC00441                                            0457
@RF00441 DS    0H                                                  0458
*                         IF(FIRSTSW='1'B)&(RCDFID^='01'X) THEN/*  0458
*                                      CHECK FOR FIRST RCD   @YL02014*/
         TM    FIRSTSW,B'10000000'                                 0458
         BNO   @RF00458                                            0458
         L     @01,CURREC                                          0458
         CLI   RCDFID(@01),X'01'                                   0458
         BE    @RF00458                                            0458
*                           DO;     /* START OF ERR ON 1ST RCD PATH
*                                                            @YL02014*/
*                             MSGIND=3;/* INDICATE MSG IEA809I     0460
*                                                            @YL02014*/
         MVC   MSGIND(2),@CH00294                                  0460
*                             LLEFT=0;/* INDICATE GET FRESH BUFFER TO
*                                      BUFFMGR               @YL02014*/
         SLR   @15,@15                                             0461
         STH   @15,LLEFT                                           0461
*                             CALL ERRPROC;/* CALL ERROR RTN TO PRINT
*                                      MSG                   @YL02014*/
         BAL   @14,ERRPROC                                         0462
*                           END;    /* END OF ERR ON 1ST RCD PATH  0463
*                                                            @YL02014*/
*                         ELSE                                     0464
*                           DO;     /* START OF FID VALID? PATH      */
         B     @RC00458                                            0464
@RF00458 DS    0H                                                  0465
*                             IF(RCDFID='01'X)/* IS FID EQUAL TO HEX
*                                      01                            */
*                                 ×(RCDFID='02'X)/* OR HEX 02      0465
*                                                            @YL02014*/
*                                 ×(RCDFID='03'X)/* OR HEX 03      0465
*                                                            @YL02014*/
*                               THEN                               0465
         L     @15,CURREC                                          0465
         CLI   RCDFID(@15),X'01'                                   0465
         BE    @RT00465                                            0465
         CLI   RCDFID(@15),X'02'                                   0465
         BE    @RT00465                                            0465
         CLI   RCDFID(@15),X'03'                                   0465
         BNE   @RF00465                                            0465
@RT00465 DS    0H                                                  0466
*                               DO; /* START OF VALID CONTROL RECORD
*                                      PATH                  @YL02014*/
*                                 CALL CONREC;                     0467
         BAL   @14,CONREC                                          0467
*                               END;/* END OF VALID CONTROL RECORD 0468
*                                      PATH                          */
*                           END;    /* END OF FID VALID? PATH        */
*                       END;        /* END OF FID IN ERROR PATH      */
*                   END;            /* END OF VALID FID FIELD        */
*               END;                /* END OF CONTROL REC PATH     0472
*                                                            @YL02014*/
*             ELSE                                                 0473
*               DO;                 /* START OF TRACE RECORD PATH    */
         B     @RC00437                                            0473
@RF00437 DS    0H                                                  0474
*                 IF RCDAID='FF'X THEN/* CHECK FOR VALID AID @YL02014*/
         L     @15,CURREC                                          0474
         CLI   RCDAID(@15),X'FF'                                   0474
         BNE   @RF00474                                            0474
*                   DO;             /* START OF VALID AID PATH     0475
*                                                            @YL02014*/
*                     FMTEID=CURREC+OFSTEID;/* PUT POINTER TO EID OF
*                                      RCD INTO PARM LIST FOR FORMAT
*                                      APPENDAGE             @YL02014*/
         LH    @14,OFSTEID                                         0476
         ALR   @14,@15                                             0476
         ST    @14,FMTEID                                          0476
*                     FMTDATA=CURREC+OFSTDATA;/* PUT PTR TO DATA OF
*                                      RCD INTO PARM LIST FOR FORMAT
*                                      APPENDAGE             @YL02014*/
         AH    @15,OFSTDATA                                        0477
         ST    @15,FMTDATA                                         0477
*                     DPLASCB=ASVTENTY(ADPLASID);/* CONVERT ASID FROM
*                                      IHAADBPL TO ASCB      @YL02014*/
         L     @01,ABDPLPTR                                        0478
         LH    @15,ADPLASID(,@01)                                  0478
         SLA   @15,2                                               0478
         L     @01,CVTPTR                                          0478
         L     @01,ASVTPTR(,@01)                                   0478
         L     @15,ASVTENTY-4(@15,@01)                             0478
         ST    @15,DPLASCB                                         0478
*                     IF DPLASCB=TRCASCB THEN/* CHECK FOR MATCHING 0479
*                                      ASCB                          */
         C     @15,TRCASCB(,@14)                                   0479
         BNE   @RF00479                                            0479
*                       DO;         /* START OF MATCHING ASCB PATH   */
*                                                                  0480
*                         /*******************************************/
*                         /*                                         */
*                         /*                                 @YL02014*/
*                         /*                                 @YL02014*/
*                         /*                                 @YL02014*/
*                         /*                                         */
*                         /*******************************************/
*                                                                  0481
*                         IF TRCCLS(1:4)='1110'B THEN/* CHECK FOR  0481
*                                      USER RECORD           @YL02014*/
         TM    TRCCLS(@14),B'11100000'                             0481
         BNO   @RF00481                                            0481
         TM    TRCCLS(@14),B'00010000'                             0481
         BNZ   @RF00481                                            0481
*                           DO;     /* START OF USER RECORD PATH     */
*                             CALL USRFORMT;/*               @YL02014*/
         BAL   @14,USRFORMT                                        0483
*                           END;    /* END OF USER RECORD PATH     0484
*                                                            @YL02014*/
*                         ELSE                                     0485
*                           DO;     /* START OF NOT USER RECORD PATH */
         B     @RC00481                                            0485
@RF00481 DS    0H                                                  0486
*                             CALL SYSFORMT;/*               @YL02014*/
         BAL   @14,SYSFORMT                                        0486
*                           END;    /* END OF NOT USER RECORD      0487
*                                                            @YL02014*/
*                       END;        /* END OF MATCHING ASCB PATH     */
*                   END;            /* END OF VALID AID PATH @YL02014*/
*                 ELSE                                             0490
*                   DO;             /* START OF NOT VALID AID OR USR
*                                      PATH                  @YL02014*/
         B     @RC00474                                            0490
@RF00474 DS    0H                                                  0491
*                     IF FIRSTSW='1'B THEN/* CHECK FOR FIRST RCD   0491
*                                                            @YL02014*/
         TM    FIRSTSW,B'10000000'                                 0491
         BNO   @RF00491                                            0491
*                       DO;         /* START OF ERR ON 1ST RCD PATH
*                                                            @YL02014*/
*                         MSGIND=3; /* INDICATE MSG IEA809I  @YL02014*/
         MVC   MSGIND(2),@CH00294                                  0493
*                         LLEFT=0;  /* INDICATE GET FRESH BUFFER TO
*                                      BUFFMGR               @YL02014*/
         SLR   @15,@15                                             0494
         STH   @15,LLEFT                                           0494
*                         CALL ERRPROC;/* CALL ERROR RTN TO PRINT MSG
*                                                            @YL02014*/
         BAL   @14,ERRPROC                                         0495
*                       END;        /* END OF ERR ON 1ST RCD PATH  0496
*                                                            @YL02014*/
*                     ELSE                                         0497
*                       DO;         /* START OF AID IN ERROR PATH  0497
*                                                            @YL02014*/
         B     @RC00491                                            0497
@RF00491 DS    0H                                                  0498
*                         MSGIND=6; /* INDICATE MSG          @YL02014*/
         MVC   MSGIND(2),@CH01274                                  0498
*                         CALL ERRPROC;/*                    @YL02014*/
         BAL   @14,ERRPROC                                         0499
*                         CALL HEXFORMT;/*                   @YL02014*/
         BAL   @14,HEXFORMT                                        0500
*                       END;        /* END OF AID IN ERROR   @YL02014*/
*                   END;            /* END OF NOT VALID AID PATH     */
*               END;                /* END OF TRACE RECORD PATH      */
*           END;                    /* END OF VALID LL PATH  @YL02014*/
*         ELSE                                                     0505
*           DO;                     /* START OF INVALID LL PATH    0505
*                                                            @YL02014*/
         B     @RC00434                                            0505
@RF00434 DS    0H                                                  0506
*             ERRBIT='0'B;          /* TURN OFF ERROR INDICATOR    0506
*                                                            @YL02014*/
         NI    ERRBIT,B'10111111'                                  0506
*           END;                    /* END OF INVALID LL PATH      0507
*                                                            @YL02014*/
*       END;                        /* END OF NOT EOF PATH   @YL02014*/
@RC00434 DS    0H                                                  0509
*   END;                            /* END OF BUFF MGR PATH  @YL02014*/
@RF00432 DS    0H                                                  0509
@DE00430 TM    EOFIND,B'00100000'                                  0509
         BZ    @DL00430                                            0509
*   ADTEDCTL='0'B;                  /*                       @YL02014*/
         NI    ADTEDCTL,B'10111111'                                0510
*   END CONTROL;                                                   0511
@EL00003 DS    0H                                                  0511
@EF00003 DS    0H                                                  0511
@ER00003 LM    @14,@12,@SA00003                                    0511
         BR    @14                                                 0511
*BUFFMGR:                                                          0512
*   PROC;                                                          0512
BUFFMGR  STM   @14,@12,@SA00004                                    0512
*   ADTEDBUF='1'B;                  /* SET AUDIT FOR CALLED PROGRAM  */
         OI    ADTEDBUF,B'00100000'                                0513
*   IF LLEFT=0 THEN                 /* IS REMAINING LENGTH OF BUFFER
*                                      EQUAL TO ZERO         @YL02014*/
         SLR   @15,@15                                             0514
         CH    @15,LLEFT                                           0514
         BNE   @RF00514                                            0514
*     DO;                           /* START OF GET FRESH BUFFER PATH*/
*       READECB=READECB&&READECB;   /* ZERO OUT ECB FOR AHLREAD      */
         L     @14,READECB                                         0516
         LR    @07,@14                                             0516
         XR    @07,@14                                             0516
         ST    @07,READECB                                         0516
*       DO;                         /* AHLREAD DATAAREA(OUTBUFFR)ECB(
*                                      READECB)TCB(ADPLTCB->TCB)     */
*                                                                  0517
*         /***********************************************************/
*         /*                                                         */
*         /* THE FOLLOWING CODE IS GENERATED BY THE AHLREAD MACRO. IT*/
*         /* LOCATES GTF, BUILDS A PARAMETER LIST, AND GETS AND      */
*         /* SCHEDULES AN SRB FOR AHLREADR                    @Y02014*/
*         /*                                                         */
*         /***********************************************************/
*                                                                  0518
*         DCL                                                      0518
*           1 AHLRDAT INT BDY(WORD) BASED,/* MAPPING OF WORKAREA FOR
*                                      THIS MACRO                    */
*            2 * CHAR(12) BDY(WORD),/* WORKAREA FOR EXEC FORM GETMAIN*/
*             3 AHLRDGM PTR(31) BDY(WORD),/* PLIST FOR EXEC FORM   0518
*                                      GETMAIN                       */
*            2 AHLRDPTR PTR(31);    /* WORD WHERE GETMAIN WILL RETURN
*                                      ADDR OF THE STORAGE IT HAS  0518
*                                      GOTTEN                        */
*         DCL                                                      0519
*           1 AHLRDSQA BASED(AHLSRB) BDY(WORD),/* PLIST AND SRB      */
*            2 AHLSRBAS CHAR(LENGTH(SRB)),/* AREA FOR SRB            */
*            2 AHLRDPL BDY(WORD),   /* TRACE DATA REQUEST PARAMETER
*                                      LIST                          */
*             3 AHLRDPQC PTR(31),   /* THIS IS THE AHLRDPLQ QUEUE  0519
*                                      CHAIN FIELD AND WILL POINT TO
*                                      THE NEXT AHLRDPL OR BE 0      */
*             3 AHLRDID CHAR(8),    /* THIS ID IS MATCHED WITH THE 0519
*                                      MCQENAME TO DETERMINE WHICH 0519
*                                      APPLICATION THE DATA IS TO  0519
*                                      COME FROM                     */
*             3 * PTR(16),                                         0519
*             3 AHLRDDID CHAR(6) BDY(WORD,3),/* ID OF THE TRACE DATA
*                                      REQUEST                       */
*              4 AHLRDASI PTR(16),  /* CURRENT ASID                  */
*              4 AHLRDTCB PTR(31),  /* TCB FOR WHICH DUMP IS BEING 0519
*                                      TAKEN, OR DEFAULTED TO 0 FOR
*                                      AN SVCDUMP                    */
*             3 AHLRDECB PTR(31),   /* ADDR OF THE ECB TO BE POSTED
*                                      WITH THE RETURN CODE WHEN THE
*                                      FUNCTION IS COMPLETED         */
*             3 AHLRDATA PTR(31),   /* ADDRESS OF THE DATA AREA WHERE
*                                      AHLREADR IS TO PUT ITS OUTPUT */
*             3 AHLRDASC PTR(31),   /* ASCB ADDR WHERE ECB IS TO BE
*                                      FOUND                         */
*             3 AHLRDPX2 PTR(31),   /* POST CODE FOR THE REQUESTOR OF
*                                      THE DATA                      */
*             3 AHLRDSRB PTR(31);   /* ADDR OF THE SRB USED FOR THIS
*                                      REQUEST                       */
*         DCL                                                      0520
*           AHLSRB REG(1) PTR(31),  /* SRB MAPPING ADDRESS - THIS  0520
*                                      MUST BE GPR1 BECAUSE IT IS  0520
*                                      USED FOR THE SCHEDULE MACRO   */
*           AHLRC PTR(31) REG(15);  /* USED TO CHECK RETURN CODES    */
*         DCL                                                      0521
*           AHLRC4 BIT(32) CONSTANT('40000004'X),/* USED TO SET ECB
*                                      TO RETURN CODE OF 4 AND SET 0521
*                                      THE POST BIT ON IF AHLREADR 0521
*                                      CANNOT BE SCHEDULE            */
*           AHLSPSQA FIXED(16) CONSTANT(245);/* SQA SUBPOOL FOR    0521
*                                      GETMAIN                       */
*         DCL                                                      0522
*           1 AHLRDG DEFINED(AHLRDGM),/* LIST FOR GETMAIN            */
*            2 AHLRDG01 PTR(31),    /* LENGTH                        */
*            2 AHLRDG02 CHAR(1),    /* HIARCHY                       */
*            2 AHLRDG03 PTR(24),    /* ADDR OF ADDR LIST             */
*            2 AHLRDG04 CHAR(1),    /* TYPE OF REQUEST               */
*            2 AHLRDG05 PTR(8);     /* SUBPOOL VALUE                 */
*         IF MCHEADRD=0             /* IS AHLREADR AVAILABLE         */
*           THEN                                                   0523
         L     @01,CVTPTR                                          0523
         ICM   @14,7,CVTGTFA(@01)                                  0523
         C     @15,MCHEADRD(,@14)                                  0523
         BNE   @RF00523                                            0523
*           READECB=AHLRC4;         /* NO SO SET A FAILURE RETURN  0524
*                                      CODE AND QUIT                 */
         MVC   READECB(4),@CF02763                                 0524
*         ELSE                                                     0525
*           DO;                     /* PREPARE TO SCHEDULE AHLREADR  */
         B     @RC00523                                            0525
@RF00523 DS    0H                                                  0526
*             RFY                                                  0526
*              (AHLSRB,                                            0526
*               AHLRC) RSTD;                                       0526
*             RFY                                                  0527
*               AHLRDAT BASED(ADDR(OUTBUFFR));/* DEFINE THE BASE FOR
*                                      THE PLIST                     */
*             DO;                   /* GETMAIN (EC)                0528
*                                      LV(LENGTH(AHLRDSQA))        0528
*                                      A(AHLRDPTR) SP(AHLSPSQA)    0528
*                                      MF(E,AHLRDG,COMPLETE)         */
*               RESPECIFY                                          0529
*                (GPR01P) RESTRICTED;                              0529
*               AHLRDG=AHLRDG&&AHLRDG;/* INIT LIST                   */
         L     @14,READBUFF                                        0530
         XC    AHLRDG(10,@14),AHLRDG(@14)                          0530
*               AHLRDG04='20'X;     /* TYPE                          */
         MVI   AHLRDG04(@14),X'20'                                 0531
*               AHLRDG01=LENGTH(AHLRDSQA);/* LENGTH                  */
         MVC   AHLRDG01(4,@14),@CF02891                            0532
*               AHLRDG03=ADDR(AHLRDPTR);/* ADDR OF ADDR LIST         */
         LA    @00,AHLRDPTR(,@14)                                  0533
         STCM  @00,7,AHLRDG03(@14)                                 0533
*               AHLRDG05=AHLSPSQA;  /* SUBPOOL VALUE                 */
         MVI   AHLRDG05(@14),X'F5'                                 0534
*               GPR01P=ADDR(AHLRDG);/* REG1 POINTS TO LIST           */
         LR    GPR01P,@14                                          0535
*               SVC(4);             /* STANDARD-FORM OF GETMAIN      */
         SVC   4                                                   0536
*               RESPECIFY                                          0537
*                (GPR01P) UNRESTRICTED;                            0537
*             END;                  /* GETMAIN (EC)                0538
*                                      LV(LENGTH(AHLRDSQA))        0538
*                                      A(AHLRDPTR) SP(AHLSPSQA)    0538
*                                      MF(E,AHLRDG,COMPLETE)         */
*             IF AHLRC^=0 THEN      /* CHECK GETMAIN RETURN CODE     */
         LTR   AHLRC,AHLRC                                         0539
         BZ    @RF00539                                            0539
*               READECB=AHLRC4;     /* SET *** ECB *** TO RETURN CODE
*                                      OF 4 AND SET THE POST BIT     */
         MVC   READECB(4),@CF02763                                 0540
*             ELSE                                                 0541
*               DO;                 /* GETMAIN SUCCESSFUL            */
         B     @RC00539                                            0541
@RF00539 DS    0H                                                  0542
*                 AHLSRB=AHLRDPTR;  /* SETUP ADDRESSABILITY TO SRB   */
         L     @14,READBUFF                                        0542
         L     AHLSRB,AHLRDPTR(,@14)                               0542
*                 AHLRDSRB=AHLSRB;  /* PUT THE ADDR OF THE SRB INTO
*                                      THE PLIST SO THAT IT CAN BE 0543
*                                      FREEMAINED BY AHLREADR        */
         ST    AHLSRB,AHLRDSRB(,AHLSRB)                            0543
*                 AHLRDASC=PSAAOLD; /* PUT CURRENT ASCB ADDR IN PLIST*/
         L     @07,PSAAOLD                                         0544
         ST    @07,AHLRDASC(,AHLSRB)                               0544
*                 AHLRDASI=PSAAOLD->ASCBASID;/* PUT CURRENT ASID INTO
*                                      PLIST                         */
         SLR   @06,@06                                             0545
         ICM   @06,3,ASCBASID(@07)                                 0545
         STH   @06,AHLRDASI(,AHLSRB)                               0545
*                 AHLRDECB=ADDR(READECB);/* PUT *** ECB *** ADDRESS
*                                      INTO PLIST                    */
         LA    @00,READECB                                         0546
         ST    @00,AHLRDECB(,AHLSRB)                               0546
*                 AHLRDATA=ADDR(OUTBUFFR);/* PUT *** DATAAREA ***  0547
*                                      ADDR INTO PLIST               */
         ST    @14,AHLRDATA(,AHLSRB)                               0547
*                 AHLRDTCB=ADDR(ADPLTCB->TCB);/* PUT *** TCB *** ADDR
*                                      INTO PLIST                    */
         L     @14,ABDPLPTR                                        0548
         MVC   AHLRDTCB(4,AHLSRB),ADPLTCB(@14)                     0548
*                 AHLRDID='GTF     ';/* MOVE IN THE APPLICATION ID   */
         MVC   AHLRDID(8,AHLSRB),@CC02773                          0549
*                 AHLSRB->SRB=AHLSRB->SRB&&AHLSRB->SRB;/* ZERO OUT 0550
*                                      SRB                           */
         XC    SRB(44,AHLSRB),SRB(AHLSRB)                          0550
*                 AHLSRB->SRBPARM=ADDR(AHLRDPL);/* MOVE IN ADDR OF 0551
*                                      PARAMETER LIST                */
         LA    @14,AHLRDPL(,AHLSRB)                                0551
         ST    @14,SRBPARM(,AHLSRB)                                0551
*                 AHLSRB->SRBEP=MCHEADRD;/* MOVE IN AHLREADR E.P.  0552
*                                      ADDR                          */
         L     @14,CVTPTR                                          0552
         SLR   @05,@05                                             0552
         ICM   @05,7,CVTGTFA(@14)                                  0552
         MVC   SRBEP(4,AHLSRB),MCHEADRD(@05)                       0552
*                 AHLSRB->SRBRMTR=MCHEADTR;/* MOVE IN AHLREADR RMTR
*                                      E.P. ADDR                     */
         MVC   SRBRMTR(4,AHLSRB),MCHEADTR(@05)                     0553
*                 AHLSRB->SRBPTCB=PSATOLD;/* ASSOCIATE THIS SRB WITH
*                                      THE TCB OF THE PGM THAT WILL
*                                      BE WAITING ON THE ECB SO THAT
*                                      ITS ERROR RTN WILL GET CONTROL
*                                      IF AHLREADR SHOULD FAIL       */
         MVC   SRBPTCB(4,AHLSRB),PSATOLD                           0554
*                 AHLSRB->SRBASCB=PSAAOLD;/* SETUP SRB TO RUN IN THE
*                                      CURRENT ADDRESS SPACE         */
         ST    @07,SRBASCB(,AHLSRB)                                0555
*                 AHLSRB->SRBPASID=PSAAOLD->ASCBASID;/* PUT IN ASID
*                                      FOR PURGEDQ                   */
         STH   @06,SRBPASID(,AHLSRB)                               0556
*                 GEN CODE REFS(CVTPTR,CVTLSMQ,CVTMAP,SRBFLNK,SRBSECT)
*                     (SCHEDULE SRB=(1));/* SCHEDULE THE SRB         */
         SCHEDULE SRB=(1)
*               END;                                               0558
*             RFY                                                  0559
*              (AHLSRB,                                            0559
*               AHLRC) UNRSTD;                                     0559
@RC00539 DS    0H                                                  0560
*           END;                                                   0560
*       END;                        /* END OF AHLREAD MACRO GENERATED
*                                      CODE                          */
@RC00523 DS    0H                                                  0562
*       DO;                         /* WAIT (1) ECB(READECB)         */
*         RESPECIFY                                                0563
*          (GPR00P,                                                0563
*           GPR01P) RESTRICTED;                                    0563
*         GPR00P=1;                 /* LOAD WAIT COUNT               */
         LA    GPR00P,1                                            0564
*         GPR01P=ADDR(READECB);     /* ADDRESS OF ECB                */
         LA    GPR01P,READECB                                      0565
*         SVC(1);                   /* WAIT SVC                      */
         SVC   1                                                   0566
*         RESPECIFY                                                0567
*          (GPR00P,                                                0567
*           GPR01P) UNRESTRICTED;                                  0567
*       END;                        /* WAIT (1) ECB(READECB) @YL02014*/
*       IF READRC=0 THEN            /* CHECK RETURN CODE FROM AHLREAD*/
         CLI   READRC,0                                            0569
         BNE   @RF00569                                            0569
*         DO;                       /* START OF AHLREAD SUCCESS PATH */
*           IF(RDBUFBLL>26)&(RDBUFBLL<(FOURK+1)) THEN              0571
         L     @15,READBUFF                                        0571
         LH    @14,RDBUFBLL(,@15)                                  0571
         CH    @14,@CH02547                                        0571
         BNH   @RF00571                                            0571
         CH    @14,@CH02892                                        0571
         BNL   @RF00571                                            0571
*             DO;                   /* START OF VALID # BYTES IN   0572
*                                      RECORD PATH           @YL02014*/
*               LLEFT=RDBUFBLL-4;   /* CALCULATE # OF BYTES OF     0573
*                                      RECORDS LEFT IN BUFFER      0573
*                                                            @YL02014*/
         LA    @07,4                                               0573
         SLR   @14,@07                                             0573
         STH   @14,LLEFT                                           0573
*               CURREC=READBUFF+4;  /* CALCULATE CURRENT REC ADDR    */
         ALR   @15,@07                                             0574
         ST    @15,CURREC                                          0574
*               IF(RDBUFLLL>0)&(RDBUFLLL<MAXUSRLN) THEN            0575
         LH    @15,RDBUFLLL(,@15)                                  0575
         LTR   @15,@15                                             0575
         BNP   @RF00575                                            0575
         CH    @15,@CH02321                                        0575
         BNL   @RF00575                                            0575
*                 DO;               /* START OF VALID USR REC LENGTH
*                                      PATH                  @YL02014*/
*                   LLEFT=LLEFT-RDBUFLLL;/* CALCULATE # OF BYTES LEFT
*                                      IN BUFFER             @YL02014*/
         SLR   @14,@15                                             0577
         STH   @14,LLEFT                                           0577
*                 END;              /* END OF VALID USR REC LENGTH 0578
*                                      PATH                  @YL02014*/
*               ELSE                                               0579
*                 DO;               /* START OF INVALID REC LEN PATH */
         B     @RC00575                                            0579
@RF00575 DS    0H                                                  0580
*                   ERRBIT='1'B;    /* INDICATE NEW BUFFER NEEDED    */
         OI    ERRBIT,B'01000000'                                  0580
*                   LLEFT=0;        /* INDICATE NEW BUFF NEEDED TO 0581
*                                      BUFFMGR               @YL02014*/
         SLR   @15,@15                                             0581
         STH   @15,LLEFT                                           0581
*                   MSGIND=3;       /* INDICATE ERR MSG IEA809I      */
         MVC   MSGIND(2),@CH00294                                  0582
*                   CALL ERRPROC;   /* CALL ERROR SUBROUTINE @YL02014*/
         BAL   @14,ERRPROC                                         0583
*                 END;              /* END OF INVALID REC LEN PATH   */
*             END;                  /* END OF VALID # OF BYTES IN  0585
*                                      RECORD PATH                   */
*           ELSE                                                   0586
*             DO;                   /* START OF INVALID REC LEN PATH */
         B     @RC00571                                            0586
@RF00571 DS    0H                                                  0587
*               IF RDBUFBLL=26 THEN /* EMPTY BUFFER?         @YL02014*/
         L     @01,READBUFF                                        0587
         CLC   RDBUFBLL(2,@01),@CH02547                            0587
         BNE   @RF00587                                            0587
*                 DO;               /* START OF EMPTY BUFFER PATH  0588
*                                                            @YL02014*/
*                   LLEFT=0;        /* NOTIFY NEED NEW BUFFER      0589
*                                                            @YL02014*/
         SLR   @15,@15                                             0589
         STH   @15,LLEFT                                           0589
*                   ERRBIT='1'B;    /* INDICATE DONOT PROCESS RECORD */
         OI    ERRBIT,B'01000000'                                  0590
*                 END;              /* END OF EMPTY BUFFER PATH    0591
*                                                            @YL02014*/
*               ELSE                                               0592
*                 DO;               /* START ERROR PATH      @YL02014*/
         B     @RC00587                                            0592
@RF00587 DS    0H                                                  0593
*                   ERRBIT='1'B;    /* INDICATE NEW BUFFER NEEDED    */
         OI    ERRBIT,B'01000000'                                  0593
*                   LLEFT=0;        /* INDICATE NEW BUFF NEEDED TO 0594
*                                      BUFFMGR               @YL02014*/
         SLR   @15,@15                                             0594
         STH   @15,LLEFT                                           0594
*                   MSGIND=3;       /* INDICATE ERR MSG IEA809I      */
         MVC   MSGIND(2),@CH00294                                  0595
*                   CALL ERRPROC;   /* CALL ERROR SUBROUTINE @YL02014*/
         BAL   @14,ERRPROC                                         0596
*                 END;              /* END OF ERROR PATH     @YL02014*/
*             END;                  /* END OF INVALID REC LEN PATH   */
*         END;                      /* END OF AHLREAD SUCCESS PATH   */
*       ELSE                                                       0600
*         DO;                       /* START OF END OF FILE PATH     */
         B     @RC00569                                            0600
@RF00569 DS    0H                                                  0601
*           EOFIND='1'B;            /* INDICATE END OF FILE  @YL02014*/
         OI    EOFIND,B'00100000'                                  0601
*         END;                      /* END OF END OF FILE PATH     0602
*                                                            @YL02014*/
*     END;                          /* END OF GET FRESH BUFFER PATH  */
*   ELSE                                                           0604
*     DO;                           /* START OF WORK WITH OLD BUFFER
*                                      PATH                  @YL02014*/
         B     @RC00514                                            0604
@RF00514 DS    0H                                                  0605
*       CURREC=CURREC+RDBUFLLL;     /* UPDATE CURREC         @YL02014*/
         L     @15,CURREC                                          0605
         LH    @14,RDBUFLLL(,@15)                                  0605
         ALR   @14,@15                                             0605
         ST    @14,CURREC                                          0605
*       IF(RDBUFLLL>0)&(RDBUFLLL<MAXUSRLN) THEN                    0606
         LH    @15,RDBUFLLL(,@14)                                  0606
         LTR   @15,@15                                             0606
         BNP   @RF00606                                            0606
         CH    @15,@CH02321                                        0606
         BNL   @RF00606                                            0606
*         DO;                       /* START OF VALID USR REC LEN  0607
*                                      PATH                          */
*           LLEFT=LLEFT-RDBUFLLL;   /* CALCULATE # OF BYTES LEFT IN
*                                      BUFFER                @YL02014*/
         LCR   @15,@15                                             0608
         AH    @15,LLEFT                                           0608
         STH   @15,LLEFT                                           0608
*         END;                      /* END OF VALID USR REC LEN PATH */
*       ELSE                                                       0610
*         DO;                       /* START OF INVALID REC LEN PATH */
         B     @RC00606                                            0610
@RF00606 DS    0H                                                  0611
*           ERRBIT='1'B;            /* INDICATE NEW BUFFER NEEDED    */
         OI    ERRBIT,B'01000000'                                  0611
*           LLEFT=0;                /* INDICATE SAME TO BUFFMGR      */
         SLR   @15,@15                                             0612
         STH   @15,LLEFT                                           0612
*           MSGIND=3;               /* INDICATE ERR MSG IEA809I      */
         MVC   MSGIND(2),@CH00294                                  0613
*           CALL ERRPROC;           /* CALL ERROR SUBROUTINE @YL02014*/
         BAL   @14,ERRPROC                                         0614
*         END;                      /* END OF INVALID REC LEN PATH   */
*     END;                          /* END OF VALID USR REC LEN PATH */
@RC00606 DS    0H                                                  0617
*   ADTEDBUF='0'B;                  /* RESET AUDIT FLAGS     @YL02014*/
@RC00514 NI    ADTEDBUF,B'11011111'                                0617
*   END BUFFMGR;                                                   0618
@EL00004 DS    0H                                                  0618
@EF00004 DS    0H                                                  0618
@ER00004 LM    @14,@12,@SA00004                                    0618
         BR    @14                                                 0618
*CONREC:                                                           0619
*   PROC;                                                          0619
CONREC   STM   @14,@12,@SA00005                                    0619
*   RFY                                                            0620
*    (PARMRG0,                                                     0620
*     PARMRG1,                                                     0620
*     PARMRG2) RSTD;                                               0620
*   ADTEDREC='1'B;                  /* SET AUDIT FOR CALLED RTN      */
         OI    ADTEDREC,B'00010000'                                0621
*   ZEROCNVT=''B;                   /* ZERO OUT OUTPUT AREA FOR    0622
*                                      CONVERTED TIME OF DAY @YL02014*/
         XC    ZEROCNVT(24),ZEROCNVT                               0622
*   ADRCVTTZ=ADDR(TSTZONE);         /* SET UP PTR TO FACTOR FOR    0623
*                                      CONVERT FROM GREENWICH MEAN TO
*                                      LOCAL                         */
         L     @03,CURREC                                          0623
         LA    @15,TSTZONE(,@03)                                   0623
         ST    @15,ADRCVTTZ                                        0623
*   ADRTOD=ADDR(TSTSTMP);           /* SET UP PTR TO CLOCK RECORD    */
         LA    @03,TSTSTMP(,@03)                                   0624
         ST    @03,ADRTOD                                          0624
*   ADRTMOUT=ADDR(CNVRTDTM);        /* SET UP PTR TO OUTPUT AREA FOR
*                                      TOD CONVERT RTN       @YL02014*/
         LA    @03,CNVRTDTM                                        0625
         ST    @03,ADRTMOUT                                        0625
*   PARMRG1=ADDR(TODPARM);          /* REG 1 CONTAINS PTR TO PARM  0626
*                                      LIST                          */
         LA    PARMRG1,TODPARM                                     0626
*   PARMRG2=1;                      /* CONVERT FULL TIME     @YL02014*/
         LA    PARMRG2,1                                           0627
*   CALL IGCTOD;                    /* CALL TIME OF DAY CONVERT    0628
*                                      ROUTINE                       */
         BAL   @14,IGCTOD                                          0628
*   PARMRG1=ABDPLPTR;               /* SET UP REG 1          @YL02014*/
         L     @03,ABDPLPTR                                        0629
         LR    PARMRG1,@03                                         0629
*   CALL PRNTLINE;                  /* CALL PRINT ROUTINE    @YL02014*/
         L     @15,ADPLPRNT(,@03)                                  0630
         BALR  @14,@15                                             0630
*   IF RCDFID=TSFID THEN            /* CHECK FOR TIMESTAMP RECORD    */
         L     @03,CURREC                                          0631
         SLR   @15,@15                                             0631
         IC    @15,RCDFID(,@03)                                    0631
         C     @15,TSFID                                           0631
         BNE   @RF00631                                            0631
*     DO;                           /* START OF TIMESTAMP RECORD PATH*/
*       CALL PRNTLINE;              /* PRINT ONE BLANK LINE  @YL02014*/
         L     @03,ABDPLPTR                                        0633
         L     @15,ADPLPRNT(,@03)                                  0633
         BALR  @14,@15                                             0633
*       PARMRG0=ADDR(TMSTMPFP);     /* PLACE ADDR OF FORMAT PATTERN
*                                      IN REGISTER 0         @YL02014*/
         LA    PARMRG0,TMSTMPFP                                    0634
*       ADPLFMT2=ADDR(CNVRTDTM);    /* SET UP ADDR OF CONVERTED TIME
*                                                            @YL02014*/
         L     @03,ABDPLPTR                                        0635
         LA    @15,CNVRTDTM                                        0635
         ST    @15,ADPLFMT2(,@03)                                  0635
*       CALL FRMTLINE;              /* CALL TO FORMAT ROUTINE      0636
*                                                            @YL02014*/
         L     @15,ADPLFRMT(,@03)                                  0636
         BALR  @14,@15                                             0636
*     END;                          /*                       @YL02014*/
*   ELSE                                                           0638
*     IF RCDFID=LEFID THEN          /* CHECK FOR LOST EVENT REORD    */
         B     @RC00631                                            0638
@RF00631 L     @03,CURREC                                          0638
         SLR   @15,@15                                             0638
         IC    @15,RCDFID(,@03)                                    0638
         C     @15,LEFID                                           0638
         BNE   @RF00638                                            0638
*       DO;                         /* START OF LOST EVENT RECORD  0639
*                                      PATH                          */
*         WRKLEVNT=LECOUNT&'7FFFFFFF'X;/* LOW ORDER 31 BITS OF LOST
*                                      EVENT CNT FOR CONVERSION      */
         L     @03,LECOUNT(,@03)                                   0640
         N     @03,@CF02778                                        0640
         ST    @03,WRKLEVNT                                        0640
*         CVD(WRKLEVNT,UNPKAREA);   /* LOST EVENT CNT CONVERT TO DEC */
         CVD   @03,UNPKAREA                                        0641
*         UNPK(LSTEVNT,UNPKARA2);   /*                       @YL02014*/
         UNPK  LSTEVNT(10),UNPKARA2(6)                             0642
*         LSTEVNT(10)=LSTEVNT(10)×'F0'X;/* FIX THE SIGN      @YL02014*/
*                                                                  0643
         OI    LSTEVNT+9,X'F0'                                     0643
*         /***********************************************************/
*         /*                                                         */
*         /* LEFT JUSTIFY NUMBER OF LOST EVENTS IN THE OUTPUT BUFFER */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0644
*         DO I=1 TO 9               /* START OF LEFT JUSTIFY SEARCH  */
*               WHILE LSTEVNT(I)='0';/* CHECK FOR LEADING ZEROS      */
         LA    @03,1                                               0644
         ST    @03,I                                               0644
@DL00644 LA    @15,LSTEVNT-1(@03)                                  0644
         CLI   0(@15),C'0'                                         0644
         BNE   @DC00644                                            0644
*         END;                      /* END OF LEFT JUSTIFY SEARCH    */
         AL    @03,@CF00063                                        0645
         ST    @03,I                                               0645
         CH    @03,@CH02011                                        0645
         BNH   @DL00644                                            0645
@DC00644 DS    0H                                                  0646
*         OUTMSG(18:18+10-I)=LSTEVNT(I:10);/* LEFT JUSTIFY   @YL02014*/
         L     @03,ABDPLPTR                                        0646
         L     @15,ADPLBUF(,@03)                                   0646
         L     @14,I                                               0646
         LA    @07,28                                              0646
         SLR   @07,@14                                             0646
         SH    @07,@CH02522                                        0646
         LA    @06,LSTEVNT-1(@14)                                  0646
         EX    @07,@SM02910                                        0646
*         PARMRG0=ADDR(LEVNTFP);    /* SET UP ADDR OF LOST EVENT   0647
*                                      FORMAT PATTERN        @YL02014*/
         LA    PARMRG0,LEVNTFP                                     0647
*         ADPLFMT2=ADDR(TOD);       /* SET UP ADDR OF CONVERTED TIME
*                                                            @YL02014*/
         LA    @15,TOD                                             0648
         ST    @15,ADPLFMT2(,@03)                                  0648
*         CALL FRMTLINE;            /* CALL FORMAT RTN       @YL02014*/
         L     @15,ADPLFRMT(,@03)                                  0649
         BALR  @14,@15                                             0649
*       END;                        /* END OF LOST EVENT RECORD PATH
*                                                            @YL02014*/
*     ELSE                                                         0651
*       DO;                         /* START OF LOST BUFFER RECORD 0651
*                                      PATH                  @YL02014*/
         B     @RC00638                                            0651
@RF00638 DS    0H                                                  0652
*         PARMRG0=ADDR(TRBUFFP);    /* SET ADDR OF FORMAT PATTERN FOR
*                                      LOST TRACE RECORDS INTO REG 0652
*                                      ZERO                  @YL02014*/
         LA    PARMRG0,TRBUFFP                                     0652
*         ADPLFMT2=ADDR(TOD);       /* SET UP ADDR OF CONVERTED TIME
*                                                            @YL02014*/
         L     @03,ABDPLPTR                                        0653
         LA    @15,TOD                                             0653
         ST    @15,ADPLFMT2(,@03)                                  0653
*         CALL FRMTLINE;            /* CALL FORMAT ROUTINE   @YL02014*/
         L     @15,ADPLFRMT(,@03)                                  0654
         BALR  @14,@15                                             0654
*       END;                        /* END OF LOST BUFFER RECORD PATH*/
*   CALL PRNTLINE;                  /* PRINT THE CONTROL RECORD      */
@RC00638 DS    0H                                                  0656
@RC00631 L     @03,ABDPLPTR                                        0656
         L     @15,ADPLPRNT(,@03)                                  0656
         BALR  @14,@15                                             0656
*   CALL PRNTLINE;                  /* PRINT ONE BLANK LINE  @YL02014*/
         L     @03,ABDPLPTR                                        0657
         L     @15,ADPLPRNT(,@03)                                  0657
         BALR  @14,@15                                             0657
*   ADTEDREC='0'B;                  /* RESET AUDIT FLAGS     @YL02014*/
         NI    ADTEDREC,B'11101111'                                0658
*   RFY                                                            0659
*    (PARMRG0,                                                     0659
*     PARMRG1,                                                     0659
*     PARMRG2) UNRSTD;                                             0659
*   END CONREC;                                                    0660
@EL00005 DS    0H                                                  0660
@EF00005 DS    0H                                                  0660
@ER00005 LM    @14,@12,@SA00005                                    0660
         BR    @14                                                 0660
*USRFORMT:                                                         0661
*   PROC;                                                          0661
USRFORMT STM   @14,@12,@SA00006                                    0661
*   RFY                                                            0662
*    (PARMRG0,                                                     0662
*     PARMRG1,                                                     0662
*     RETCODE,                                                     0662
*     PARMRG9,                                                     0662
*     PARMRG2) RSTD;                                               0662
*   GPR14P=USRSAVE;                 /* SAVE AREA FOR USER RTNS     0663
*                                                            @YM07534*/
         L     GPR14P,USRSAVE                                      0663
*   GEN;                                                           0664
*     /* @YM07534*/
 ST @13,4(14)  YM07534
 ST @14,8(@13)    YM07534
 LR @13,@14   YM07534
*   ADTEDUSR='1'B;                  /* SET AUDIT FLAGS       @YL02014*/
         OI    ADTEDUSR,B'00001000'                                0665
*   USRHXBIT(1)='1'B;               /* TURN ON HEX BIT IN USRTAB   0666
*                                                            @YL02014*/
         OI    USRHXBIT,B'10000000'                                0666
*   USRINDEX=RCDFID+1;              /* CALCULATE INDEX TO USRTAB     */
         LA    @14,1                                               0667
         L     @03,CURREC                                          0667
         SLR   @07,@07                                             0667
         IC    @07,RCDFID(,@03)                                    0667
         ALR   @14,@07                                             0667
         ST    @14,USRINDEX                                        0667
*   IF USRHXBIT(USRINDEX)='1'B THEN /* SHOULD THIS FID BE DUMPED IN
*                                      HEX                   @YL02014*/
         LA    @03,USRHXBIT-1(@14)                                 0668
         TM    0(@03),B'10000000'                                  0668
         BNO   @RF00668                                            0668
*     DO;                           /* START OF DUMP FID IN HEX PATH */
*       EXITNM='HEXFORMT';          /* USR FORMT APPENDAGE IS      0670
*                                      HEXFORMT                      */
         MVC   EXITNM(8),@CC02786                                  0670
*       CALL HDRPATH;               /*                       @YL02014
*                                                            @YL02014*/
         BAL   @14,HDRPATH                                         0671
*     END;                          /* END OF DUMP FID IN HEX PATH   */
*   ELSE                                                           0673
*     DO;                           /* START OF NOT HEX PATH @YL02014*/
         B     @RC00668                                            0673
@RF00668 DS    0H                                                  0674
*       IF USRLOAD(USRINDEX)='1'B THEN/* CHECK IF MODULE LOADED      */
         L     @14,USRINDEX                                        0674
         LA    @03,USRLOAD-1(@14)                                  0674
         TM    0(@03),B'00100000'                                  0674
         BNO   @RF00674                                            0674
*         DO;                       /* START OF MODULE LOADED PATH   */
*                                                                  0675
*           /*********************************************************/
*           /*                                                       */
*           /*                                               @YL02014*/
*           /* SETUP IS USED TO PREPARE THE USR RECORD FOR USER      */
*           /*                                               @YL02014*/
*           /* FORMAT APPENDAGE (NOT HEXFORMT).              @YL02014*/
*           /*                                                       */
*           /*********************************************************/
*                                                                  0676
*           IF RCDLL>256 THEN       /* RECORD LONGER THAN 256 BYTES
*                                                            @YL02014*/
         L     @14,CURREC                                          0676
         LH    @03,RCDLL(,@14)                                     0676
         CH    @03,@CH00686                                        0676
         BNH   @RF00676                                            0676
*             DO;                   /* START OF RECORD LONG PATH   0677
*                                                            @YL02014*/
*               TEMPIBUF(1:256)=RECORD(1:256);/* MOVE FIRST 256 BYTES*/
         MVC   TEMPIBUF(256),RECORD(@14)                           0678
*               TEMPIBUF(257:RCDLL)=RECORD(257:RCDLL);/* MOVE REST OF
*                                      RECORD                @YL02014*/
         SH    @03,@CH02787                                        0679
         EX    @03,@SM02913                                        0679
*             END;                  /* END OF RECORD LONG PATH     0680
*                                                            @YL02014*/
*           ELSE                                                   0681
*             DO;                   /* START OF RECORD SHORT PATH    */
         B     @RC00676                                            0681
@RF00676 DS    0H                                                  0682
*               TEMPIBUF(1:RCDLL)=RECORD(1:RCDLL);/* MOVE RECORD TO
*                                      TEMPORARY BUFFER      @YL02014*/
         L     @14,CURREC                                          0682
         LH    @03,RCDLL(,@14)                                     0682
         BCTR  @03,0                                               0682
         EX    @03,@SM02915                                        0682
*             END;                  /* END OF RECORD SHORT PATH    0683
*                                                            @YL02014*/
*           FMTINPUT=ADDR(TEMPIBUF);/* PUT ADDR OF TEMP BUFFER IN  0684
*                                      FORMAT APPENDAGES PARM LIST 0684
*                                                            @YL02014*/
@RC00676 LA    @14,TEMPIBUF                                        0684
         ST    @14,FMTINPUT                                        0684
*           FMTDATA=ADDR(TEMPIBUF)+OFSTDATA;/* UPD DATA PTR  @ZA02153*/
         LH    @03,OFSTDATA                                        0685
         ALR   @03,@14                                             0685
         ST    @03,FMTDATA                                         0685
*           FMTEID=ADDR(TEMPIBUF)+OFSTEID;/* UPD EID PTR     @ZA02153*/
         AH    @14,OFSTEID                                         0686
         ST    @14,FMTEID                                          0686
*           FMTOUTPT=USROUT;        /* PUT @ OF NON KEY 0 OUTPUT AREA
*                                      IN FORMAT APPENDAGES PARM LIST
*                                                            @ZA00919*/
         MVC   FMTOUTPT(4),USROUT                                  0687
*           DO I=1 TO 3;            /* START OF FIND USER MOD NAME   */
         LA    @14,1                                               0688
         ST    @14,I                                               0688
@DL00688 DS    0H                                                  0689
*             IF USRI(I)=(USRTABL(USRINDEX)&USRI(I)) THEN          0689
         MH    @14,@CH00912                                        0689
         L     @03,USRINDEX                                        0689
         LA    @07,USRTABL-1(@03)                                  0689
         MVC   @TS00001(1),0(@07)                                  0689
         LA    @07,USRI-7(@14)                                     0689
         NC    @TS00001(1),0(@07)                                  0689
         LA    @07,USRI-7(@14)                                     0689
         CLC   0(1,@07),@TS00001                                   0689
         BNE   @RF00689                                            0689
*               DO;                                                0690
*                 FIDEPN=USREPN(I);                                0691
         MVI   FIDEPN+6,C' '                                       0691
         MVI   FIDEPN+7,C' '                                       0691
         LA    @07,USREPN-7(@14)                                   0691
         MVC   FIDEPN(6),0(@07)                                    0691
*                 FIDHEX=FOXFID(USRINDEX);                         0692
         LR    @14,@03                                             0692
         ALR   @14,@14                                             0692
         LA    @07,FOXFID-2(@14)                                   0692
         MVC   FIDHEX(2),0(@07)                                    0692
*                 EXITNM=FIDEPN;                                   0693
         MVC   EXITNM(8),FIDEPN                                    0693
*                 EXITADDR=USRADDR(USRINDEX);                      0694
         SLA   @03,2                                               0694
         L     @14,USRADDR-4(@03)                                  0694
         ST    @14,EXITADDR                                        0694
*               END;                                               0695
*           END;                                                   0696
@RF00689 LA    @14,1                                               0696
         AL    @14,I                                               0696
         ST    @14,I                                               0696
         CH    @14,@CH00294                                        0696
         BNH   @DL00688                                            0696
*         END;                      /* END OF MODULE LOADED PATH     */
*       ELSE                                                       0698
*         DO;                       /* START OF LOAD MODULE PATH     */
         B     @RC00674                                            0698
@RF00674 DS    0H                                                  0699
*           ZEROBLDL=''B;           /* ZERO OUT BLDLLIST     @YL02014*/
         XC    ZEROBLDL(178),ZEROBLDL                              0699
*           EPN(1)='AMDUSR';        /* INITIALIZE BLDL ENTRY @YL02014*/
         MVI   EPN+6,C' '                                          0700
         MVI   EPN+7,C' '                                          0700
         MVC   EPN(6),@CC02587                                     0700
*           EPN(2)='HMDUSR';        /* POINT NAMES           @YL02014*/
         MVI   EPN+64,C' '                                         0701
         MVI   EPN+65,C' '                                         0701
         MVC   EPN+58(6),@CC02588                                  0701
*           EPN(3)='IMDUSR';        /* WITH PORTION OF MODULE NAME   */
         MVI   EPN+122,C' '                                        0702
         MVI   EPN+123,C' '                                        0702
         MVC   EPN+116(6),@CC02589                                 0702
*           TEMPFID1=RCDFID;        /* SET FID INTO 3-BYTE AREA      */
         L     @14,CURREC                                          0703
         SLR   @03,@03                                             0703
         IC    @03,RCDFID(,@14)                                    0703
         STH   @03,TEMPFID1                                        0703
*           UNPK(TEMPFID,TEMPFID2); /* UNPACK FID            @YL02014*/
         UNPK  TEMPFID(3),TEMPFID2(3)                              0704
*           FOXFID(USRINDEX)=TEMPFID;/* MOVE TO TWO-BYTE AREA YL02014*/
         L     @14,USRINDEX                                        0705
         ALR   @14,@14                                             0705
         LA    @03,FOXFID-2(@14)                                   0705
         MVC   0(2,@03),TEMPFID                                    0705
*           TR(FOXFID(USRINDEX),DEFTABLE);/* TRANSLATE UNPACKED BYTES
*                                                            @YL02014*/
         LA    @03,FOXFID-2(@14)                                   0706
         TR    0(2,@03),DEFTABLE                                   0706
*           EPNFID(1)=FOXFID(USRINDEX);/* SET FID INTO       @YL02014*/
         LA    @03,FOXFID-2(@14)                                   0707
         MVC   EPNFID(2),0(@03)                                    0707
*           EPNFID(2)=FOXFID(USRINDEX);/* BLDL ENTRY POINT   @YL02014*/
         LA    @03,FOXFID-2(@14)                                   0708
         MVC   EPNFID+58(2),0(@03)                                 0708
*           EPNFID(3)=FOXFID(USRINDEX);/* NAMES AS ROUTINE IDENTIFIER*/
         LA    @03,FOXFID-2(@14)                                   0709
         MVC   EPNFID+116(2),0(@03)                                0709
*           EXITNM=EPN(1);          /* SETUP EXITNM FOR MSG          */
         MVC   EXITNM(8),EPN                                       0710
*           DO I=1 TO 3;            /* LOAD AND TEST EACH VERSION  0711
*                                                             @Y04518*/
         LA    @14,1                                               0711
         ST    @14,I                                               0711
@DL00711 DS    0H                                                  0712
*             EXITNM=EPN(I);        /* SET 8-CHAR ENTRY POINT NAME IN
*                                      AMDPRTAB              @YL02014*/
         MH    @14,@CH02469                                        0712
         LA    @03,EPN-58(@14)                                     0712
         MVC   EXITNM(8),0(@03)                                    0712
*             DO;                   /* LOAD EP(EPN(I)) ERRET(USRERR) */
*               RESPECIFY                                          0714
*                (GPR00P,                                          0714
*                 GPR01P,                                          0714
*                 GPR15F) RESTRICTED;                              0714
*               GPR00P=ADDR(EPN(I));/* LOAD ENTRY POINT NAME ADDRESS */
         LA    GPR00P,EPN-58(@14)                                  0715
*               GPR01P=0;           /* JOBLIB OR LINKLIB DCB         */
         SLR   GPR01P,GPR01P                                       0716
*               GPR01P=GPR01P×'80000000'X;/* ERROR RETURN LABEL    0717
*                                      SPECIFIED                     */
         O     GPR01P,@CF02789                                     0717
*               SVC(8);             /* ISSUE LOAD SVC                */
         SVC   8                                                   0718
*               IF GPR15F^=0 THEN   /* LOAD WAS UNSUCCESSFUL         */
         LTR   GPR15F,GPR15F                                       0719
         BNZ   @RT00719                                            0719
*                 GOTO USRERR;      /* BRANCH TO ERROR LOCATION      */
*               RESPECIFY                                          0721
*                (GPR00P,                                          0721
*                 GPR01P,                                          0721
*                 GPR15F) UNRESTRICTED;                            0721
*             END;                  /* LOAD EP(EPN(I)) ERRET(USRERR)
*                                      LOAD ONE VERSION       @Y04518*/
*             IF I<4 THEN           /* DUMMY STMT FOR GOOD-ELSE ERROR
*                                                             @Y04518*/
         L     @14,I                                               0723
         CH    @14,@CH00056                                        0723
         BNL   @RF00723                                            0723
*               DO;                 /* START GOOD LOAD PATH   @Y04518*/
*                 USRADDR(USRINDEX)=PARMRG0;/* GET ADDR OF MODULE    */
         L     @03,USRINDEX                                        0725
         LR    @07,@03                                             0725
         SLA   @07,2                                               0725
         ST    PARMRG0,USRADDR-4(@07)                              0725
*                 EXITADDR=PARMRG0; /* SAVE ADDR OF MODULE           */
         ST    PARMRG0,EXITADDR                                    0726
*                 USRTABL(USRINDEX)=USRI(I)×USRTABL(USRINDEX);/*   0727
*                                      INDICATE WHICH VERSION LOADED
*                                                            @YL02014*/
         LA    @07,USRTABL-1(@03)                                  0727
         MH    @14,@CH00912                                        0727
         LA    @06,USRI-7(@14)                                     0727
         OC    0(1,@07),0(@06)                                     0727
*                 USRLOAD(USRINDEX)='1'B;/* INDICATE SOMETHING LOADED*/
*                                                                  0728
         LA    @14,USRLOAD-1(@03)                                  0728
         OI    0(@14),B'00100000'                                  0728
*                 /***************************************************/
*                 /*                                                 */
*                 /*                                         @YL02014*/
*                 /* SETUP IS USED TO PREPARE THE USR RECORD FOR USER*/
*                 /*                                         @YL02014*/
*                 /* FORMAT APPENDAGE (NOT HEXFORMT).        @YL02014*/
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0729
*                 IF RCDLL>256 THEN /* RECORD LONGER THAN 256 BYTES
*                                                            @YL02014*/
         L     @14,CURREC                                          0729
         LH    @03,RCDLL(,@14)                                     0729
         CH    @03,@CH00686                                        0729
         BNH   @RF00729                                            0729
*                   DO;             /* START OF RECORD LONG PATH   0730
*                                                            @YL02014*/
*                     TEMPIBUF(1:256)=RECORD(1:256);/* MOVE FIRST 256
*                                      BYTES                         */
         MVC   TEMPIBUF(256),RECORD(@14)                           0731
*                     TEMPIBUF(257:RCDLL)=RECORD(257:RCDLL);/* MOVE
*                                      REST OF RECORD        @YL02014*/
         SH    @03,@CH02787                                        0732
         EX    @03,@SM02913                                        0732
*                   END;            /* END OF RECORD LONG PATH     0733
*                                                            @YL02014*/
*                 ELSE                                             0734
*                   DO;             /* START OF RECORD SHORT PATH    */
         B     @RC00729                                            0734
@RF00729 DS    0H                                                  0735
*                     TEMPIBUF(1:RCDLL)=RECORD(1:RCDLL);/* MOVE    0735
*                                      RECORD TO TEMPORARY BUFFER  0735
*                                                            @YL02014*/
         L     @14,CURREC                                          0735
         LH    @03,RCDLL(,@14)                                     0735
         BCTR  @03,0                                               0735
         EX    @03,@SM02915                                        0735
*                   END;            /* END OF RECORD SHORT PATH    0736
*                                                            @YL02014*/
*                 FMTINPUT=ADDR(TEMPIBUF);/* PUT ADDR OF TEMP BUFFER
*                                      IN FORMAT APPENDAGES PARM LIST
*                                                            @YL02014*/
@RC00729 LA    @14,TEMPIBUF                                        0737
         ST    @14,FMTINPUT                                        0737
*                 FMTDATA=ADDR(TEMPIBUF)+OFSTDATA;/* UPD DATA PTR  0738
*                                                            @ZA02153*/
         LH    @03,OFSTDATA                                        0738
         ALR   @03,@14                                             0738
         ST    @03,FMTDATA                                         0738
*                 FMTEID=ADDR(TEMPIBUF)+OFSTEID;/* UPD EID PTR     0739
*                                                            @ZA02153*/
         AH    @14,OFSTEID                                         0739
         ST    @14,FMTEID                                          0739
*                 FMTOUTPT=USROUT;  /* PUT @ OF NON KEY 0 OUTPUT AREA
*                                      IN FORMAT APPENDAGES PARM LIST
*                                                            @ZA00919*/
         MVC   FMTOUTPT(4),USROUT                                  0740
*                 I=4;              /* FORCE WAY OUT OF LOOP @YL02014*/
         MVC   I(4),@CF00056                                       0741
*               END;                /* END OF END OF SEARCH PATH     */
*             ELSE                                                 0743
*               DO;                 /* DUMMY TO GET AROUND ERROR   0743
*                                                             @Y04518*/
         B     @RC00723                                            0743
@RF00723 DS    0H                                                  0744
*USRERR:                                                           0744
*                 IF I=3 THEN                                      0744
USRERR   CLC   I(4),@CF00294                                       0744
         BNE   @RF00744                                            0744
*                   DO;             /* ONLY DO IF 3 FAILURES  @Y04518*/
*                     LOADNAME=EXITNM;/* GET MODULE NAME FOR MSG   0746
*                                                            @YL02014*/
         MVC   LOADNAME(8),EXITNM                                  0746
*                     MSGIND=4;     /* INDICATE ERR MSG IEA932I      */
         MVC   MSGIND(2),@CH00056                                  0747
*                     CALL ERRPROC; /* CALL TO ERROR SUBROUTINE      */
         BAL   @14,ERRPROC                                         0748
*                     CALL HDRPATH; /*                       @YL02014*/
         BAL   @14,HDRPATH                                         0749
*                     EXITNM='HEXFORMT';/* USR FORMT APPENDAGE IS  0750
*                                      HEXFORMT                      */
         MVC   EXITNM(8),@CC02786                                  0750
*                     USRHXBIT(USRINDEX)='1'B;/*             @YL02014*/
         L     @14,USRINDEX                                        0751
         LA    @03,USRHXBIT-1(@14)                                 0751
         OI    0(@03),B'10000000'                                  0751
*                   END;            /* END OF BLDL AND LOAD ERR PATH */
*               END;                /* END OF BLDL SUCCESS PATH      */
@RF00744 DS    0H                                                  0754
*           END;                    /* END OF DO I=1 TO 3 PATH     0754
*                                                             @Y04518*/
@RC00723 LA    @14,1                                               0754
         AL    @14,I                                               0754
         ST    @14,I                                               0754
         CH    @14,@CH00294                                        0754
         BNH   @DL00711                                            0754
*         END;                      /* END OF LOAD MODULE PATH     0755
*                                                            @YL02014*/
*     END;                          /* END OF NOT HEX PATH   @YL02014*/
@RC00674 DS    0H                                                  0757
*   ZEROOUT=''B;                    /* ZERO OUT THE 200-BYTE WORKAREA*/
@RC00668 L     @14,FMTWORK                                         0757
         XC    ZEROOUT(200,@14),ZEROOUT(@14)                       0757
*   RCODE=0;                        /* SET LOOP CONTROL Y02014       */
         SLR   @14,@14                                             0758
         ST    @14,RCODE                                           0758
*   FMTDATA=FMTDATA+12;             /* PTR TO USER DATA      @YM07534*/
         LA    @14,12                                              0759
         AL    @14,FMTDATA                                         0759
         ST    @14,FMTDATA                                         0759
*   DO WHILE(RCODE=0);              /* LOOP IS DRIVEN BY RETURN CODES
*                                      FROM FORMAT APPENDAGES Y02014 */
         B     @DE00760                                            0760
@DL00760 DS    0H                                                  0761
*     PARMRG1=ADDR(FMTPARM);        /* SET REG 1 WITH ADDR OF FMTPARM*/
         LA    PARMRG1,FMTPARM                                     0761
*     PARMRG9=ADDR(AMDPRTAB);       /* GET ADDR AMDPRTAB FOR FORMAT
*                                      APPENDAGE             @YL02014*/
         LA    PARMRG9,AMDPRTAB                                    0762
*     GENERATE;                                                    0763
*                                                          /*@YL02014*/
         STM   @00,@14,SAVEREGS                           @YL02014
*     ADTEDFMT='1'B;                /* INDICATE GONE TO FORMAT     0764
*                                      APPENDAGE             @YL02014*/
         OI    ADTEDFMT,B'00010000'                                0764
*     IF EXITNM='HEXFORMT' THEN     /* CHECK FOR HEX FORMAT  @YL02014*/
         CLC   EXITNM(8),@CC02786                                  0765
         BNE   @RF00765                                            0765
*       DO;                         /* START OF HEX FORMAT PATH      */
*         CALL HEXFORMT;            /*                       @YL02014*/
         BAL   @14,HEXFORMT                                        0767
*       END;                        /* END OF HEX FORMAT PATH      0768
*                                                            @YL02014*/
*     ELSE                                                         0769
*       DO;                         /* START OF USR FORMAT APPENDAGE
*                                      PATH                  @YL02014*/
         B     @RC00765                                            0769
@RF00765 DS    0H                                                  0770
*         R15=USRADDR(USRINDEX);    /* SET UP REGISTER 15 WITH EPN 0770
*                                      ADDR                  @YL02014*/
         L     @03,USRINDEX                                        0770
         SLA   @03,2                                               0770
         L     R15,USRADDR-4(@03)                                  0770
*         GENERATE;                                                0771
*                                                          /*@YL02014*/
         SYNCH (15)
*       END;                        /* END OF USR FORMAT APPENDAGE 0772
*                                      PATH                          */
*                                                                  0772
*     /***************************************************************/
*     /*                                                             */
*     /*                                                     @YL02014*/
*     /* RETURN FROM FORMAT APPENDAGE                        @YL02014*/
*     /*                                                     @YL02014*/
*     /*                                                             */
*     /***************************************************************/
*                                                                  0773
*USRRETRY:                                                         0773
*     ADTEDFMT='0'B;                /* INDICATE BACK FROM FORMAT APP */
@RC00765 DS    0H                                                  0773
USRRETRY NI    ADTEDFMT,B'11101111'                                0773
*     RCODE=RETCODE;                /* SAVE RETCODE          @YL02014*/
         ST    RETCODE,RCODE                                       0774
*     IF(RCODE=8)×(RCODE=4)×(RCODE=0)×(RCODE=12)/* CHECK FOR VALID 0775
*                                      RETURN CODE                   */
*       THEN                                                       0775
         L     @14,RCODE                                           0775
         CH    @14,@CH00034                                        0775
         BE    @RT00775                                            0775
         CH    @14,@CH00056                                        0775
         BE    @RT00775                                            0775
         LTR   @14,@14                                             0775
         BZ    @RT00775                                            0775
         CH    @14,@CH00033                                        0775
         BNE   @RF00775                                            0775
@RT00775 DS    0H                                                  0776
*       DO;                         /* START OF PRINT THE RECORD PATH*/
*         OUTBUFF=USROUTER;         /* MOVE USER FORM APP RTN OUTPUT
*                                      INTO ABDUMPS BUFFER FOR     0777
*                                      PRINTING              @ZA00919*/
         L     @14,ABDPLPTR                                        0777
         L     @14,ADPLBUF(,@14)                                   0777
         L     @03,USROUT                                          0777
         MVC   OUTBUFF(121,@14),USROUTER(@03)                      0777
*         IF(RCODE=4)×(RCODE=0) THEN/* CHECK FOR VALID CODE          */
         L     @14,RCODE                                           0778
         CH    @14,@CH00056                                        0778
         BE    @RT00778                                            0778
         LTR   @14,@14                                             0778
         BNZ   @RF00778                                            0778
@RT00778 DS    0H                                                  0779
*           DO;                     /* START OF VALID CODE PATH      */
*             IF HEADWRIT='0'B THEN /* CHECK FOR HEADER WRITTEN      */
         TM    HEADWRIT,B'00010000'                                0780
         BNZ   @RF00780                                            0780
*               DO;                 /* START OF WRITE HEADER PATH    */
*                                                                  0781
*                 /***************************************************/
*                 /*                                                 */
*                 /* SAVE FIRST LINE USER RECORD AS FOMATED BY FORMAT*/
*                 /* APPENDAGES                                      */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0782
*                 TEMPOBUF=OUTBUFF; /* SAVE FIRST LINE USER OUTPUT   */
         L     @14,ABDPLPTR                                        0782
         L     @14,ADPLBUF(,@14)                                   0782
         MVC   TEMPOBUF(121),OUTBUFF(@14)                          0782
*                 CALL HDRPATH;     /* PRINT HEADER USING ADPLBUF  0783
*                                                            @YL02014*/
         BAL   @14,HDRPATH                                         0783
*                 OUTBUFF=TEMPOBUF; /* GET READY TO PRINT FIRST LINE
*                                      USER OUTPUT           @YL02014*/
         L     @14,ABDPLPTR                                        0784
         L     @14,ADPLBUF(,@14)                                   0784
         MVC   OUTBUFF(121,@14),TEMPOBUF                           0784
*               END;                /* END OF WRITE HEADER PATH      */
*             PARMRG1=ABDPLPTR;     /* SET UP SNAP PARM PTR Y02014   */
@RF00780 L     @14,ABDPLPTR                                        0786
         LR    PARMRG1,@14                                         0786
*             CALL PRNTLINE;        /* PRINT THAT LINE Y02014        */
         L     @15,ADPLPRNT(,@14)                                  0787
         BALR  @14,@15                                             0787
*             IF FOXTIME='1'B&(RCODE=4) THEN/* TIMESTAMP DESIRED   0788
*                                      Y02014                        */
         TM    FOXTIME,B'00000001'                                 0788
         BNO   @RF00788                                            0788
         CLC   RCODE(4),@CF00056                                   0788
         BNE   @RF00788                                            0788
*               DO;                 /* START OF TIMESTAMP NEEDED PATH
*                                                            @YL02014*/
*                 ZEROCNVT=''B;     /* ZERO OUT OUTPUT AREA FOR    0790
*                                      CONVERTED TIME OF DAY @YL02014*/
         XC    ZEROCNVT(24),ZEROCNVT                               0790
*                 ADRCVTTZ=ADDR(TSTZONE);/* SET UP PTR TO FACTOR FOR
*                                      CONVERT FROM GREENWICH MEAN TO
*                                      LOCAL                 @YL02014*/
         L     @14,CURREC                                          0791
         LA    @03,TSTZONE(,@14)                                   0791
         ST    @03,ADRCVTTZ                                        0791
*                 ADRTOD=ADDR(RCDTIME);/* SET UP PTR TO TIME STAMP IN
*                                      RECORD                @YL02014*/
         LA    @14,RCDTIME(,@14)                                   0792
         ST    @14,ADRTOD                                          0792
*                 ADRTMOUT=ADDR(CNVRTDTM);/* SET UP PTR TO OUTPUT  0793
*                                      AREA FOR TOD CONVERT RTN    0793
*                                                            @YL02014*/
         LA    @14,CNVRTDTM                                        0793
         ST    @14,ADRTMOUT                                        0793
*                 PARMRG1=ADDR(TODPARM);/* REG 1 CONTAINS PTR TO PARM
*                                      LIST                  @YL02014*/
         LA    PARMRG1,TODPARM                                     0794
*                 PARMRG2=2;        /* CONVERT FULL TIME     @YL02014*/
         LA    PARMRG2,2                                           0795
*                 CALL IGCTOD;      /* CALL TIME OF DAT CONVERT    0796
*                                      ROUTINE               @YL02014*/
         BAL   @14,IGCTOD                                          0796
*                 PARMRG0=ADDR(TIMEFP);/* PLACE ADDR OF FORMAT     0797
*                                      PATTERN IN REG 0      @YL02014*/
         LA    PARMRG0,TIMEFP                                      0797
*                 ADPLFMT2=ADDR(CNVRTDTM);/* SET UP ADDR OF CONVERTED
*                                      TIME                  @YL02014*/
         L     @14,ABDPLPTR                                        0798
         LA    @03,CNVRTDTM                                        0798
         ST    @03,ADPLFMT2(,@14)                                  0798
*                 PARMRG1=ABDPLPTR; /* SET PTR TO IHAABDPL IN REG 1
*                                                            @YL02014*/
         LR    PARMRG1,@14                                         0799
*                 CALL FRMTLINE;    /* CALL FORMAT ROUTINE   @YL02014*/
         L     @15,ADPLFRMT(,@14)                                  0800
         BALR  @14,@15                                             0800
*                 CALL PRNTLINE;                                   0801
         L     @03,ABDPLPTR                                        0801
         L     @15,ADPLPRNT(,@03)                                  0801
         BALR  @14,@15                                             0801
*               END;                /* END OF TIMESTAMP NEEDED PATH
*                                                            @YL02014*/
*           END;                    /* END OF VALID CODE PATH      0803
*                                                            @YL02014*/
@RF00788 DS    0H                                                  0804
*         IF RCODE=12 THEN          /* CHECK FOR PRINT RECORD IN HEX */
@RF00778 CLC   RCODE(4),@CF00033                                   0804
         BNE   @RF00804                                            0804
*           DO;                     /* START OF PRINT RECORD IN HEX  */
*             EXITNM='HEXFORMT';    /* USR FORMAT APPENDAGE IS     0806
*                                      HEXFORMT                      */
         MVC   EXITNM(8),@CC02786                                  0806
*             CALL HDRPATH;         /*                       @YL02014*/
         BAL   @14,HDRPATH                                         0807
*             ZEROOUT=''B;          /* ZERO OUT THE 200K WORKAREA  0808
*                                                            @YL02014*/
         L     @14,FMTWORK                                         0808
         XC    ZEROOUT(200,@14),ZEROOUT(@14)                       0808
*             RCODE=0;              /* RESET RETURN CODE     @YL02014*/
         SLR   @14,@14                                             0809
         ST    @14,RCODE                                           0809
*           END;                    /* END OF PRINT RECORD IN HEX    */
*       END;                        /* END OF PRINT THE RECORD PATH  */
*     ELSE                                                         0812
*       DO;                         /* START OF INVALID CODE PATH    */
         B     @RC00775                                            0812
@RF00775 DS    0H                                                  0813
*         RCNAME=EXITNM;            /* GET MODULE NAME FOR MSG     0813
*                                                            @YL02014*/
         MVC   RCNAME(8),EXITNM                                    0813
*         MSGIND=5;                 /* INDICATE ERR MSG IEA933     0814
*                                                            @YL02014*/
         MVC   MSGIND(2),@CH00745                                  0814
*         CALL ERRPROC;             /* CALL TO ERROR SUBROUTINE      */
         BAL   @14,ERRPROC                                         0815
*         EXITNM='HEXFORMT';        /* USR FORMAT APPENDAGE-HEXFORMT */
         MVC   EXITNM(8),@CC02786                                  0816
*         USRHXBIT(USRINDEX)='1'B;  /* TURN ON HEX BIT       @YL02014*/
         L     @14,USRINDEX                                        0817
         LA    @03,USRHXBIT-1(@14)                                 0817
         OI    0(@03),B'10000000'                                  0817
*         CALL HDRPATH;             /*                       @YL02014*/
         BAL   @14,HDRPATH                                         0818
*         ZEROOUT=''B;              /* ZERO OUT THE 200K WORKAREA  0819
*                                                            @YL02014*/
         L     @14,FMTWORK                                         0819
         XC    ZEROOUT(200,@14),ZEROOUT(@14)                       0819
*         RCODE=0;                  /* RESET RETURN CODE     @YL02014*/
         SLR   @14,@14                                             0820
         ST    @14,RCODE                                           0820
*       END;                        /* END OF INVALID CODE PATH      */
*   END;                            /* END OF DO WHILE LOOP  @YL02014*/
@RC00775 DS    0H                                                  0822
@DE00760 ICM   @14,15,RCODE                                        0822
         BZ    @DL00760                                            0822
*   HEADWRIT='0'B;                  /* TURN OFF HEADER SWITCH      0823
*                                                            @YL02014*/
         NI    HEADWRIT,B'11101111'                                0823
*   ADTEDUSR='0'B;                  /* TURN OFF AUDIT BIT    @YL02014*/
         NI    ADTEDUSR,B'11110111'                                0824
*   GENERATE;                                                      0825
*           /* RESTORE IGC SAVE AREA @YM08446*/
 L  @13,4(@13)          YM08446
*   RFY                                                            0826
*    (PARMRG0,                                                     0826
*     PARMRG1,                                                     0826
*     RETCODE,                                                     0826
*     PARMRG9,                                                     0826
*     PARMRG2) UNRSTD;                                             0826
*   END USRFORMT;                                                  0827
@EL00006 DS    0H                                                  0827
@EF00006 DS    0H                                                  0827
@ER00006 LM    @14,@12,@SA00006                                    0827
         BR    @14                                                 0827
*HEXFORMT:                                                         0828
*   PROC;                                                          0828
HEXFORMT STM   @14,@12,@SA00007                                    0828
*   RFY                                                            0829
*    (PARMRG0,                                                     0829
*     PARMRG1,                                                     0829
*     PARMRG2,                                                     0829
*     RETCODE) RSTD;                                               0829
*   ADTEDHEX='1'B;                  /* INDICATE CALLED ROUTINE IS  0830
*                                      HEXFORMT              @YL02014*/
         OI    ADTEDHEX,B'00000100'                                0830
*   TIMEADJ=CURREC+OFSTDATA;        /* CALCULATE ADJUSTMENT FOR    0831
*                                                            @YL02014
*                                      TIMESTAMP             @YL02014*/
         LH    @14,OFSTDATA                                        0831
         AL    @14,CURREC                                          0831
         ST    @14,TIMEADJ                                         0831
*   IF TRCCLS(1:4)^='1110'B         /* CHECK FOR USR RECORD  @YL02014*/
*     THEN                                                         0832
         L     @14,FMTEID                                          0832
         TM    TRCCLS(@14),B'11100000'                             0832
         BNO   @RT00832                                            0832
         TM    TRCCLS(@14),B'00010000'                             0832
         BZ    @RF00832                                            0832
@RT00832 DS    0H                                                  0833
*     DO;                           /* START OF NOT USR RECORD PATH  */
*       HXSYSAID=RCDAID;            /* MOVE AID,FID,AND EID INTO     */
         L     @14,CURREC                                          0834
         MVC   HXSYSAID(1),RCDAID(@14)                             0834
*       HXSYSFID=RCDFID;            /* MIDDLE OF 5-BYTE AREA @YL02014*/
         MVC   HXSYSFID(1),RCDFID(@14)                             0835
*       HXSYSEID=FMTEID->TRCEID;    /* FOR CONVERSION        @YL02014*/
         L     @14,FMTEID                                          0836
         MVC   HXSYSEID(2),TRCEID(@14)                             0836
*       PARMRG0=ADDR(HXSYSFP);      /* REG 0 IS ADDR OF FORMAT     0837
*                                      PATTERN               @YL02014*/
         LA    PARMRG0,HXSYSFP                                     0837
*       PARMRG1=ABDPLPTR;           /* REG 1 IS ADDR SNAPS PARM LIST
*                                                            @YL02014*/
         L     @14,ABDPLPTR                                        0838
         LR    PARMRG1,@14                                         0838
*       ADPLFMT2=ADDR(HXSYSDTA);    /* SET UP ADDR OF HEX SYSTEM INFO
*                                                            @YL02014*/
         LA    @03,HXSYSDTA                                        0839
         ST    @03,ADPLFMT2(,@14)                                  0839
*       CALL FRMTLINE;              /* CALL FORMAT ROUTINE   @YL02014*/
         L     @15,ADPLFRMT(,@14)                                  0840
         BALR  @14,@15                                             0840
*     END;                          /* END OF NOT USR RECORD PATH  0841
*                                                            @YL02014*/
*   OFFSET=0;                       /* SET OFFSET TO ZERO    @YL02014*/
@RF00832 SLR   @14,@14                                             0842
         STH   @14,OFFSET                                          0842
*   NUMPRINT=(RCDLL-OFSTDATA)/24;   /* CALCULATE # OF LINES TO PRINT
*                                                            @YL02014*/
         LA    @03,24                                              0843
         L     @07,CURREC                                          0843
         LH    @07,RCDLL(,@07)                                     0843
         SH    @07,OFSTDATA                                        0843
         LR    @04,@07                                             0843
         SRDA  @04,32                                              0843
         DR    @04,@03                                             0843
         ST    @05,NUMPRINT                                        0843
*   NUMPART=(RCDLL-OFSTDATA)//24;   /* CALCULATE # OF BYTES TO PRINT
*                                      IN PARTIAL(LEFTOVER) LINE   0844
*                                                            @YL02014*/
         LR    @04,@07                                             0844
         SRDA  @04,32                                              0844
         DR    @04,@03                                             0844
         ST    @04,NUMPART                                         0844
*   IF NUMPRINT^=O THEN                                            0845
         L     @03,NUMPRINT                                        0845
         SLR   @07,@07                                             0845
         ICM   @07,7,O                                             0845
         CR    @03,@07                                             0845
         BE    @RF00845                                            0845
*     DO OFFSET=0 TO(NUMPRINT*24-1) BY 24;/* START OF CONVERT LINES
*                                      LOOP                  @YL02014*/
         STH   @14,OFFSET                                          0846
         B     @DE00846                                            0846
@DL00846 DS    0H                                                  0847
*       NUMCON=24;                  /* NUMBER OF BYTES PER LINE TO 0847
*                                      CONVERT               @YL02014*/
         MVC   NUMCON(4),@CF00072                                  0847
*       CALL CONVRT;                /*                       @YL02014*/
         BAL   @14,CONVRT                                          0848
*       IF(OFFSET=0)&(FOXTIME='1'B) THEN/* CHECK FOR TIMESTAMP EACH
*                                      RECORD                @YL02014*/
         ICM   @14,3,OFFSET                                        0849
         BNZ   @RF00849                                            0849
         TM    FOXTIME,B'00000001'                                 0849
         BNO   @RF00849                                            0849
*         DO;                       /* START OF TIMESTAMP NEEDED PATH
*                                                            @YL02014*/
*           ZEROCNVT=''B;           /* ZERO OUT OUTPUT AREA FOR    0851
*                                      CONVERTED TIME OF DAY @YL02014*/
         XC    ZEROCNVT(24),ZEROCNVT                               0851
*           ADRCVTTZ=ADDR(TSTZONE); /* SET UP PTR TO FACTOR FOR    0852
*                                      CONVERT FROM GREENWICH MEAN TO
*                                      LOCAL                 @YL02014*/
         L     @14,CURREC                                          0852
         LA    @03,TSTZONE(,@14)                                   0852
         ST    @03,ADRCVTTZ                                        0852
*           ADRTOD=ADDR(RCDTIME);   /* SET UP PTR TO TIME STAMP IN 0853
*                                      RECORD                @YL02014*/
         LA    @14,RCDTIME(,@14)                                   0853
         ST    @14,ADRTOD                                          0853
*           ADRTMOUT=ADDR(CNVRTDTM);/* SET UP PTR TO OUTPUT AREA FOR
*                                      TOD CONVERT RTN       @YL02014*/
         LA    @14,CNVRTDTM                                        0854
         ST    @14,ADRTMOUT                                        0854
*           PARMRG1=ADDR(TODPARM);  /* REG 1 CONTAINS PTR TO PARM  0855
*                                      LIST                  @YL02014*/
         LA    PARMRG1,TODPARM                                     0855
*           PARMRG2=2;              /* CONVRT RELATIVE TIME  @YL02014*/
         LA    PARMRG2,2                                           0856
*           CALL IGCTOD;            /* CALL TIME OF DAT CONVERT    0857
*                                      ROUTINE               @YL02014*/
         BAL   @14,IGCTOD                                          0857
*           PARMRG0=ADDR(TIMEFP);   /* PLACE ADDR OF FORMAT PATTERN
*                                      IN REG 0              @YL02014*/
         LA    PARMRG0,TIMEFP                                      0858
*           ADPLFMT2=ADDR(CNVRTDTM);/* SET UP ADDR OF CONVERTED TIME
*                                                            @YL02014*/
         L     @14,ABDPLPTR                                        0859
         LA    @03,CNVRTDTM                                        0859
         ST    @03,ADPLFMT2(,@14)                                  0859
*           PARMRG1=ABDPLPTR;       /* SET PTR TO IHAABDPL IN REG 1
*                                                            @YL02014*/
         LR    PARMRG1,@14                                         0860
*           CALL FRMTLINE;          /* CALL FORMAT ROUTINE   @YL02014*/
         L     @15,ADPLFRMT(,@14)                                  0861
         BALR  @14,@15                                             0861
*           IF(NUMPRINT=1)&(NUMPART=0) THEN/* EXACTLY ONE LINE?      */
         CLC   NUMPRINT(4),@CF00063                                0862
         BNE   @RF00862                                            0862
         ICM   @14,15,NUMPART                                      0862
         BNZ   @RF00862                                            0862
*             CALL PRNTLINE;        /* IF TIMESTAMP REQ AND DATA WAS
*                                      EXACTLY 24 BYTES, PRNT      0863
*                                      TIMESTAMP NOW                 */
         L     @03,ABDPLPTR                                        0863
         L     @15,ADPLPRNT(,@03)                                  0863
         BALR  @14,@15                                             0863
*         END;                      /* END OF TIMESTAMP NEEDED PATH
*                                                            @YL02014*/
@RF00862 DS    0H                                                  0865
*     END;                          /* END OF CONVERT LINES LOOP     */
*                                                                  0865
@RF00849 LA    @14,24                                              0865
         SLR   @03,@03                                             0865
         ICM   @03,3,OFFSET                                        0865
         ALR   @14,@03                                             0865
         STH   @14,OFFSET                                          0865
@DE00846 L     @03,NUMPRINT                                        0865
         MH    @03,@CH00072                                        0865
         BCTR  @03,0                                               0865
         CR    @14,@03                                             0865
         BNH   @DL00846                                            0865
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @YL02014*/
*   /* CHECK FOR PARTIAL LINE LEFT TO BE PRINTED             @YL02014*/
*   /*                                                       @YL02014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0866
*   IF NUMPART^=0 THEN              /* CHECK FOR PARTIAL LINE      0866
*                                                            @YL02014
*                                      LEFT                  @YL02014*/
@RF00845 ICM   @14,15,NUMPART                                      0866
         BZ    @RF00866                                            0866
*     DO;                           /* START OF PRINT PARTIAL LINE 0867
*                                      PATH                  @YL02014*/
*       IF(OFFSET=18)&(FOXTIME='1'B) THEN/* ONLY PARTIAL LINE OUT?   */
         CLC   OFFSET(2),@CH02522                                  0868
         BNE   @RF00868                                            0868
         TM    FOXTIME,B'00000001'                                 0868
         BNO   @RF00868                                            0868
*         DO;                       /* START OF TIMESTAMP NEEDED PATH
*                                                            @YL02014*/
*           ZEROCNVT=''B;           /* ZERO OUT OUTPUT AREA FOR    0870
*                                      CONVERTED TIME OF DAY @YL02014*/
         XC    ZEROCNVT(24),ZEROCNVT                               0870
*           ADRCVTTZ=ADDR(TSTZONE); /* SET UP PTR TO FACTOR FOR    0871
*                                      CONVERT FROM GREENWICH MEAN TO
*                                      LOCAL                 @YL02014*/
         L     @14,CURREC                                          0871
         LA    @03,TSTZONE(,@14)                                   0871
         ST    @03,ADRCVTTZ                                        0871
*           ADRTOD=ADDR(RCDTIME);   /* SET UP PTR TO TIME STAMP IN 0872
*                                      RECORD                @YL02014*/
         LA    @14,RCDTIME(,@14)                                   0872
         ST    @14,ADRTOD                                          0872
*           ADRTMOUT=ADDR(CNVRTDTM);/* SET UP PTR TO OUTPUT AREA FOR
*                                      TOD CONVERT RTN       @YL02014*/
         LA    @14,CNVRTDTM                                        0873
         ST    @14,ADRTMOUT                                        0873
*           PARMRG1=ADDR(TODPARM);  /* REG 1 CONTAINS PTR TO PARM  0874
*                                      LIST                  @YL02014*/
         LA    PARMRG1,TODPARM                                     0874
*           PARMRG2=2;              /* CONVRT RELATIVE TIME  @YL02014*/
         LA    PARMRG2,2                                           0875
*           CALL IGCTOD;            /* CALL TIME OF DAT CONVERT    0876
*                                      ROUTINE               @YL02014*/
         BAL   @14,IGCTOD                                          0876
*           PARMRG0=ADDR(TIMEFP);   /* PLACE ADDR OF FORMAT PATTERN
*                                      IN REG 0              @YL02014*/
         LA    PARMRG0,TIMEFP                                      0877
*           ADPLFMT2=ADDR(CNVRTDTM);/* SET UP ADDR OF CONVERTED TIME
*                                                            @YL02014*/
         L     @14,ABDPLPTR                                        0878
         LA    @03,CNVRTDTM                                        0878
         ST    @03,ADPLFMT2(,@14)                                  0878
*           PARMRG1=ABDPLPTR;       /* SET PTR TO IHAABDPL IN REG 1
*                                                            @YL02014*/
         LR    PARMRG1,@14                                         0879
*           CALL FRMTLINE;          /* CALL FORMAT ROUTINE   @YL02014*/
         L     @15,ADPLFRMT(,@14)                                  0880
         BALR  @14,@15                                             0880
*         END;                      /* END OF PRINT PARTIAL LINE     */
*       NUMCON=NUMPART;             /* NUMBER OF BYTES TO PRINT      */
@RF00868 MVC   NUMCON(4),NUMPART                                   0882
*       CALL CONVRT;                /*                       @YL02014*/
         BAL   @14,CONVRT                                          0883
*       IF(NUMPRINT=0)&(FOXTIME='1'B) THEN/* ONLY PARTIAL LINE OUT?  */
         ICM   @14,15,NUMPRINT                                     0884
         BNZ   @RF00884                                            0884
         TM    FOXTIME,B'00000001'                                 0884
         BNO   @RF00884                                            0884
*         DO;                       /* START OF TIMESTAMP NEEDED PATH
*                                                            @YL02014*/
*           ZEROCNVT=''B;           /* ZERO OUT OUTPUT AREA FOR    0886
*                                      CONVERTED TIME OF DAY @YL02014*/
         XC    ZEROCNVT(24),ZEROCNVT                               0886
*           ADRCVTTZ=ADDR(TSTZONE); /* SET UP PTR TO FACTOR FOR    0887
*                                      CONVERT FROM GREENWICH MEAN TO
*                                      LOCAL                 @YL02014*/
         L     @14,CURREC                                          0887
         LA    @03,TSTZONE(,@14)                                   0887
         ST    @03,ADRCVTTZ                                        0887
*           ADRTOD=ADDR(RCDTIME);   /* SET UP PTR TO TIME STAMP IN 0888
*                                      RECORD                @YL02014*/
         LA    @14,RCDTIME(,@14)                                   0888
         ST    @14,ADRTOD                                          0888
*           ADRTMOUT=ADDR(CNVRTDTM);/* SET UP PTR TO OUTPUT AREA FOR
*                                      TOD CONVERT RTN       @YL02014*/
         LA    @14,CNVRTDTM                                        0889
         ST    @14,ADRTMOUT                                        0889
*           PARMRG1=ADDR(TODPARM);  /* REG 1 CONTAINS PTR TO PARM  0890
*                                      LIST                  @YL02014*/
         LA    PARMRG1,TODPARM                                     0890
*           PARMRG2=2;              /* CONVRT RELATIVE TIME  @YL02014*/
         LA    PARMRG2,2                                           0891
*           CALL IGCTOD;            /* CALL TIME OF DAT CONVERT    0892
*                                      ROUTINE               @YL02014*/
         BAL   @14,IGCTOD                                          0892
*           PARMRG0=ADDR(TIMEFP);   /* PLACE ADDR OF FORMAT PATTERN
*                                      IN REG 0              @YL02014*/
         LA    PARMRG0,TIMEFP                                      0893
*           ADPLFMT2=ADDR(CNVRTDTM);/* SET UP ADDR OF CONVERTED TIME
*                                                            @YL02014*/
         L     @14,ABDPLPTR                                        0894
         LA    @03,CNVRTDTM                                        0894
         ST    @03,ADPLFMT2(,@14)                                  0894
*           PARMRG1=ABDPLPTR;       /* SET PTR TO IHAABDPL IN REG 1
*                                                            @YL02014*/
         LR    PARMRG1,@14                                         0895
*           CALL FRMTLINE;          /* CALL FORMAT ROUTINE   @YL02014*/
         L     @15,ADPLFRMT(,@14)                                  0896
         BALR  @14,@15                                             0896
*           CALL PRNTLINE;                                         0897
         L     @03,ABDPLPTR                                        0897
         L     @15,ADPLPRNT(,@03)                                  0897
         BALR  @14,@15                                             0897
*         END;                      /* END OF TIMESTAMP NEEDED PATH
*                                                            @YL02014*/
*     END;                          /* END OF PRINT PARTIAL LINE PATH
*                                                            @YL02014*/
@RF00884 DS    0H                                                  0900
*   GENERATE;                                                      0900
@RF00866 DS    0H                                                  0900
       LA @15,8
       ST @15,@SA00007+4
*   ADTEDHEX='0'B;                  /* RESET AUDIT HEX BIT   @YL02014*/
         NI    ADTEDHEX,B'11111011'                                0901
*   RFY                                                            0902
*    (PARMRG0,                                                     0902
*     PARMRG1,                                                     0902
*     PARMRG2,                                                     0902
*     RETCODE) UNRSTD;                                             0902
*   END HEXFORMT;                   /*                       @YL02014*/
@EL00007 DS    0H                                                  0903
@EF00007 DS    0H                                                  0903
@ER00007 LM    @14,@12,@SA00007                                    0903
         BR    @14                                                 0903
*SYSFORMT:                                                         0904
*   PROC;                                                          0904
SYSFORMT STM   @14,@12,@SA00008                                    0904
*   RFY                                                            0905
*    (PARMRG0,                                                     0905
*     PARMRG1,                                                     0905
*     RETCODE,                                                     0905
*     PARMRG9,                                                     0905
*     PARMRG2) RSTD;                                               0905
*   ADTEDSYS='1'B;                  /* TURN ON AUDIT FLAGS   @YL02014*/
         OI    ADTEDSYS,B'00000010'                                0906
*   SYSINDEX=RCDFID+1;              /* CALCULATE INDEX TO SYSTAB     */
         LA    @14,1                                               0907
         L     @03,CURREC                                          0907
         SLR   @07,@07                                             0907
         IC    @07,RCDFID(,@03)                                    0907
         ALR   @14,@07                                             0907
         ST    @14,SYSINDEX                                        0907
*   IF SYSHXBIT(SYSINDEX)='1'B THEN /* SHOULD THIS FID BE DUMPED IN
*                                      HEX                   @YL02014*/
         LA    @03,SYSHXBIT-1(@14)                                 0908
         TM    0(@03),B'10000000'                                  0908
         BNO   @RF00908                                            0908
*     DO;                           /* START OF DUMP THIS RECORD IN
*                                      HEX                   @YL02014*/
*       EXITNM='HEXFORMT';          /* USR FORMT APPENDAGE IS      0910
*                                      HEXFORMT                      */
         MVC   EXITNM(8),@CC02786                                  0910
*     END;                          /* END OF DUMP THIS RECORD IN HEX
*                                      PATH                  @YL02014*/
*   ELSE                                                           0912
*     DO;                           /* START OF REGULAR RECORD PATH  */
         B     @RC00908                                            0912
@RF00908 DS    0H                                                  0913
*       IF SYSLOAD(SYSINDEX)='0'B THEN/* CHECK IF MODULE LOADED      */
         L     @14,SYSINDEX                                        0913
         LA    @03,SYSLOAD-1(@14)                                  0913
         TM    0(@03),B'00100000'                                  0913
         BNZ   @RF00913                                            0913
*         DO;                       /* START OF LOAD MODULE PATH     */
*           ZEROBLDL=''B;           /* ZERO OUT BLDLLIST     @YL02014*/
         XC    ZEROBLDL(178),ZEROBLDL                              0915
*           EPN(1)='AMDSYS';        /* INITIALIZE BLDL ENTRY POINT 0916
*                                      NAMES WITH A PORTION OF MODULE
*                                      NAME                          */
         MVI   EPN+6,C' '                                          0916
         MVI   EPN+7,C' '                                          0916
         MVC   EPN(6),@CC02801                                     0916
*           TEMPFID1=RCDFID;        /* SET FID INTO 3-BYTE AREA      */
         L     @03,CURREC                                          0917
         SLR   @07,@07                                             0917
         IC    @07,RCDFID(,@03)                                    0917
         STH   @07,TEMPFID1                                        0917
*           UNPK(TEMPFID,TEMPFID2); /* UNPACK FID            @YL02014*/
         UNPK  TEMPFID(3),TEMPFID2(3)                              0918
*           FOXFID(SYSINDEX)=TEMPFID;/* MOVE TO TWO-BYTE AREA      0919
*                                                            @YL02014*/
         ALR   @14,@14                                             0919
         LA    @03,FOXFID-2(@14)                                   0919
         MVC   0(2,@03),TEMPFID                                    0919
*           TR(FOXFID(SYSINDEX),DEFTABLE);/*                 @YL02014*/
         LA    @03,FOXFID-2(@14)                                   0920
         TR    0(2,@03),DEFTABLE                                   0920
*           EPNFID(1)=FOXFID(SYSINDEX);/* FID INTO BLDL ENTRY POINT
*                                      NAMES AS ROUTINE IDENTIFIER   */
         LA    @03,FOXFID-2(@14)                                   0921
         MVC   EPNFID(2),0(@03)                                    0921
*           EXITNM=EPN(1);          /* SAVE SYS FORMAT APPENDAGE NAME*/
         MVC   EXITNM(8),EPN                                       0922
*           DO;                     /* LOAD EP(EXITNM) ERRET(USER1)  */
*             RESPECIFY                                            0924
*              (GPR00P,                                            0924
*               GPR01P,                                            0924
*               GPR15F) RESTRICTED;                                0924
*             GPR00P=ADDR(EXITNM);  /* LOAD ENTRY POINT NAME ADDRESS */
         LA    GPR00P,EXITNM                                       0925
*             GPR01P=0;             /* JOBLIB OR LINKLIB DCB         */
         SLR   GPR01P,GPR01P                                       0926
*             GPR01P=GPR01P×'80000000'X;/* ERROR RETURN LABEL      0927
*                                      SPECIFIED                     */
         O     GPR01P,@CF02789                                     0927
*             SVC(8);               /* ISSUE LOAD SVC                */
         SVC   8                                                   0928
*             IF GPR15F^=0 THEN     /* LOAD WAS UNSUCCESSFUL         */
         LTR   GPR15F,GPR15F                                       0929
         BNZ   @RT00929                                            0929
*               GOTO USER1;         /* BRANCH TO ERROR LOCATION      */
*             RESPECIFY                                            0931
*              (GPR00P,                                            0931
*               GPR01P,                                            0931
*               GPR15F) UNRESTRICTED;                              0931
*           END;                    /* LOAD EP(EXITNM) ERRET(USER1)
*                                      LOAD CORRECT SYSTEM MODULE  0932
*                                                             @Y04518*/
*           EXITADDR=PARMRG0;       /*                       @YL02014*/
         ST    PARMRG0,EXITADDR                                    0933
*           SYSADDR(SYSINDEX)=PARMRG0;/* GET ADDR OF FORMAT APPENDAGE
*                                                            @YL02014*/
         L     @14,SYSINDEX                                        0934
         LR    @03,@14                                             0934
         SLA   @03,2                                               0934
         ST    PARMRG0,SYSADDR-4(@03)                              0934
*           SYSLOAD(SYSINDEX)='1'B; /* INDICATE MODULE LOADED      0935
*                                      SUCCESSFULLY          @YL02014*/
         LA    @03,SYSLOAD-1(@14)                                  0935
         OI    0(@03),B'00100000'                                  0935
*           IF SYSLOAD(SYSINDEX)='0'B THEN/*                  @Y04518*/
         LA    @03,SYSLOAD-1(@14)                                  0936
         TM    0(@03),B'00100000'                                  0936
         BNZ   @RF00936                                            0936
*             DO;                   /* ERROR ROUTINE BRANCH AROUND 0937
*                                                             @Y04518*/
*USER1:                             /*                        @Y04518*/
*               MSGIND=4;           /* INDICATE ERR MSG IEA932     0938
*                                                             @Y04518*/
USER1    MVC   MSGIND(2),@CH00056                                  0938
*               LOADNAME=EPN(1);    /* GET MODULE NAME        @Y04518*/
         MVC   LOADNAME(8),EPN                                     0939
*               CALL ERRPROC;       /* CALL ERROR SUBROUTINE  @Y04518*/
         BAL   @14,ERRPROC                                         0940
*               EXITNM='HEXFORMAT'; /* SYS FORMAT APPENDAGE-HEXFORMAT
*                                                             @Y04518*/
         MVC   EXITNM(8),@CC02804                                  0941
*               SYSHXBIT(SYSINDEX)='1'B;/* TURN ON HEXBIT     @Y04518*/
         L     @14,SYSINDEX                                        0942
         LA    @03,SYSHXBIT-1(@14)                                 0942
         OI    0(@03),B'10000000'                                  0942
*             END;                  /* END LOAD ERROR PATH    @Y04518*/
*         END;                      /* END OF LOAD MODULE PATH       */
*       ELSE                                                       0945
*         DO;                                                      0945
         B     @RC00913                                            0945
@RF00913 DS    0H                                                  0946
*           EPN(1)='AMDSYS';                                       0946
         MVI   EPN+6,C' '                                          0946
         MVI   EPN+7,C' '                                          0946
         MVC   EPN(6),@CC02801                                     0946
*           EPNFID(1)=FOXFID(SYSINDEX);                            0947
         L     @14,SYSINDEX                                        0947
         LR    @03,@14                                             0947
         ALR   @03,@03                                             0947
         LA    @07,FOXFID-2(@03)                                   0947
         MVC   EPNFID(2),0(@07)                                    0947
*           EXITNM=EPN(1);                                         0948
         MVC   EXITNM(8),EPN                                       0948
*           EXITADDR=SYSADDR(SYSINDEX);                            0949
         SLA   @14,2                                               0949
         L     @14,SYSADDR-4(@14)                                  0949
         ST    @14,EXITADDR                                        0949
*         END;                                                     0950
*     END;                          /* END OF REGULAR RECORD PATH    */
@RC00913 DS    0H                                                  0952
*   ZEROOUT=''B;                    /* ZERO OUT 200-BYTE WORKAREA    */
@RC00908 L     @14,FMTWORK                                         0952
         XC    ZEROOUT(200,@14),ZEROOUT(@14)                       0952
*   RCODE=0;                        /* SET LOOP CONTROL      @YL02014*/
         SLR   @14,@14                                             0953
         ST    @14,RCODE                                           0953
*   DO WHILE RCODE=0;               /* LOOP IS DRIVEN BY RETURN CODES
*                                      FROM FORMAT APPENDAGES      0954
*                                                            @YL02014*/
         B     @DE00954                                            0954
@DL00954 DS    0H                                                  0955
*     GENERATE;                                                    0955
*                                                          /*@YL02014*/
         STM   @00,@14,SAVEREGS                           @YL02014
*     PARMRG1=ADDR(FMTPARM);        /* SET UP REG 1 WITH ADDR FORMAT
*                                      APPENDAGE PARM LIST   @YL02014*/
         LA    PARMRG1,FMTPARM                                     0956
*     PARMRG9=ADDR(AMDPRTAB);       /* GET ADDR AMDPRTAB FOR FORMAT
*                                      APPENDAGE             @YL02014*/
         LA    PARMRG9,AMDPRTAB                                    0957
*     ADTEDFMT='1'B;                /* INDICATE CALL FORMAT APPENDAGE*/
         OI    ADTEDFMT,B'00010000'                                0958
*     ADTNGSYS='1'B;                /* INDICATE CALLED BY SYSFORMT   */
         OI    ADTNGSYS,B'00000010'                                0959
*     IF EXITNM='HEXFORMT' THEN     /* FORMAT APPENDAGE HEXFORMT     */
         CLC   EXITNM(8),@CC02786                                  0960
         BNE   @RF00960                                            0960
*       DO;                         /* START OF CALL HEXFORMT PATH   */
*         CALL HEXFORMT;            /* CALL FORMAT APPDAGE           */
         BAL   @14,HEXFORMT                                        0962
*       END;                        /* END OF CALL HEXFORMT PATH     */
*     ELSE                                                         0964
*       DO;                         /* START OF SYSTEM FORMAT APP  0964
*                                      PATH                          */
         B     @RC00960                                            0964
@RF00960 DS    0H                                                  0965
*         CALL FRMTAPP;             /* CALL FORMAT APPENDAGE @YL02014*/
         L     @15,EXITADDR                                        0965
         BALR  @14,@15                                             0965
*       END;                        /* END OF CALL SYSTEM FORMAT APP
*                                      PATH                          */
*SYSRETRY:                                                         0967
*     ADTEDFMT='0'B;                /* TURN OFF AUDIT FLAGS  @YL02014*/
@RC00960 DS    0H                                                  0967
SYSRETRY NI    ADTEDFMT,B'11101111'                                0967
*     RCODE=RETCODE;                /*                       @YL02014*/
         ST    RETCODE,RCODE                                       0968
*     ADTNGSYS='0'B;                /* TURN OFF SYSFORMT INDICATOR AS
*                                      CALLER                @YL02014*/
         NI    ADTNGSYS,B'11111101'                                0969
*     PARMRG1=ABDPLPTR;             /*                       @YL02014*/
         L     PARMRG1,ABDPLPTR                                    0970
*     IF(RCODE=0)×(RCODE=4) THEN    /* CHECK FOR PRNT/RETURN       0971
*                                      PRNT/ONLY                     */
         L     @14,RCODE                                           0971
         LTR   @14,@14                                             0971
         BZ    @RT00971                                            0971
         CH    @14,@CH00056                                        0971
         BNE   @RF00971                                            0971
@RT00971 DS    0H                                                  0972
*       DO;                         /* START OF P/O P/R PATH @YL02014*/
*         CALL PRNTLINE;            /*                       @YL02014*/
         L     @03,ABDPLPTR                                        0973
         L     @15,ADPLPRNT(,@03)                                  0973
         BALR  @14,@15                                             0973
*         IF(FOXTIME='1'B)&(RCODE=4) THEN/* TIMESTAMP DESIRED      0974
*                                                            @YL02014*/
         TM    FOXTIME,B'00000001'                                 0974
         BNO   @RF00974                                            0974
         CLC   RCODE(4),@CF00056                                   0974
         BNE   @RF00974                                            0974
*           DO;                     /* START OF TIMESTAMP NEEDED PATH
*                                                            @YL02014*/
*             ZEROCNVT=''B;         /* ZERO OUT OUTPUT AREA FOR    0976
*                                      CONVERTED TIME OF DAY @YL02014*/
         XC    ZEROCNVT(24),ZEROCNVT                               0976
*             ADRCVTTZ=ADDR(TSTZONE);/* SET UP PTR TO FACTOR FOR   0977
*                                      CONVERT FROM GREENWICH MEAN TO
*                                      LOCAL                 @YL02014*/
         L     @14,CURREC                                          0977
         LA    @03,TSTZONE(,@14)                                   0977
         ST    @03,ADRCVTTZ                                        0977
*             ADRTOD=ADDR(RCDTIME); /* SET UP PTR TO TIME STAMP IN 0978
*                                      RECORD                @YL02014*/
         LA    @14,RCDTIME(,@14)                                   0978
         ST    @14,ADRTOD                                          0978
*             ADRTMOUT=ADDR(CNVRTDTM);/* SET UP PTR TO OUTPUT AREA 0979
*                                      FOR TOD CONVERT RTN   @YL02014*/
         LA    @14,CNVRTDTM                                        0979
         ST    @14,ADRTMOUT                                        0979
*             PARMRG1=ADDR(TODPARM);/* REG 1 CONTAINS PTR TO PARM  0980
*                                      LIST                  @YL02014*/
         LA    PARMRG1,TODPARM                                     0980
*             PARMRG2=2;            /* CONVERT FULL TIME     @YL02014*/
         LA    PARMRG2,2                                           0981
*             CALL IGCTOD;          /* CALL TIME OF DAT CONVERT    0982
*                                      ROUTINE               @YL02014*/
         BAL   @14,IGCTOD                                          0982
*             PARMRG0=ADDR(TIMEFP); /* PLACE ADDR OF FORMAT PATTERN
*                                      IN REG 0              @YL02014*/
         LA    PARMRG0,TIMEFP                                      0983
*             ADPLFMT2=ADDR(CNVRTDTM);/* SET UP ADDR OF CONVERTED  0984
*                                      TIME                  @YL02014*/
         L     @14,ABDPLPTR                                        0984
         LA    @03,CNVRTDTM                                        0984
         ST    @03,ADPLFMT2(,@14)                                  0984
*             PARMRG1=ABDPLPTR;     /* SET PTR TO IHAABDPL IN REG 1
*                                                            @YL02014*/
         LR    PARMRG1,@14                                         0985
*             CALL FRMTLINE;        /* CALL FORMAT ROUTINE   @YL02014*/
         L     @15,ADPLFRMT(,@14)                                  0986
         BALR  @14,@15                                             0986
*             CALL PRNTLINE;                                       0987
         L     @03,ABDPLPTR                                        0987
         L     @15,ADPLPRNT(,@03)                                  0987
         BALR  @14,@15                                             0987
*           END;                    /* END OF TIMESTAMP NEEDED PATH
*                                                            @YL02014*/
*       END;                        /* END OF P/O P/R PATH   @YL02014*/
@RF00974 DS    0H                                                  0990
*     IF RCODE=12 THEN              /* CHECK FOR RC 12       @YL02014*/
@RF00971 CLC   RCODE(4),@CF00033                                   0990
         BNE   @RF00990                                            0990
*       DO;                         /* START OF RC 12 PATH   @YL02014*/
*         EXITNM='HEXFORMT';        /* SET FORMAT APP TO HEXFORMT    */
         MVC   EXITNM(8),@CC02786                                  0992
*         ZEROOUT=''B;              /* ZERO OUT WORKAREA     @YL02014*/
         L     @14,FMTWORK                                         0993
         XC    ZEROOUT(200,@14),ZEROOUT(@14)                       0993
*         RCODE=0;                  /* RESET RETURN CODE     @YL02014*/
         SLR   @14,@14                                             0994
         ST    @14,RCODE                                           0994
*       END;                        /* END OF RC 12 PATH     @YL02014*/
*     IF RCODE>8 THEN                                              0996
@RF00990 L     @14,RCODE                                           0996
         CH    @14,@CH00034                                        0996
         BNH   @RF00996                                            0996
*       DO;                         /* START OF INVLID RC PATH     0997
*                                                            @YL02014*/
*         RCNAME=EXITNM;            /* INDICATE MOD IN ERR   @YL02014*/
         MVC   RCNAME(8),EXITNM                                    0998
*         MSGIND=5;                 /* INDICATE MSG IEA934I  @YL02014*/
         MVC   MSGIND(2),@CH00745                                  0999
*         CALL ERRPROC;             /*                       @YL02014*/
         BAL   @14,ERRPROC                                         1000
*         EXITNM='HEXFORMT';        /*                       @YL02014*/
         MVC   EXITNM(8),@CC02786                                  1001
*         SYSHXBIT(SYSINDEX)='1'B;  /*                       @YL02014*/
         L     @14,SYSINDEX                                        1002
         LA    @03,SYSHXBIT-1(@14)                                 1002
         OI    0(@03),B'10000000'                                  1002
*         ZEROOUT=''B;              /* ZERO OUT WORKAREA     @YL02014*/
         L     @14,FMTWORK                                         1003
         XC    ZEROOUT(200,@14),ZEROOUT(@14)                       1003
*         RCODE=0;                  /* RESET RETURN CODE     @YL02014*/
         SLR   @14,@14                                             1004
         ST    @14,RCODE                                           1004
*       END;                        /* END OF INVALID RC PATH      1005
*                                                            @YL02014*/
*   END;                            /* END OF DO WHILE LOOP          */
@RF00996 DS    0H                                                  1006
@DE00954 ICM   @14,15,RCODE                                        1006
         BZ    @DL00954                                            1006
*   RFY                                                            1007
*    (PARMRG1,                                                     1007
*     PARMRG0,                                                     1007
*     RETCODE,                                                     1007
*     PARMRG9,                                                     1007
*     PARMRG2) UNRSTD;                                             1007
*   ADTEDSYS='0'B;                  /*                       @YL02014*/
         NI    ADTEDSYS,B'11111101'                                1008
*   END SYSFORMT;                                                  1009
@EL00008 DS    0H                                                  1009
@EF00008 DS    0H                                                  1009
@ER00008 LM    @14,@12,@SA00008                                    1009
         BR    @14                                                 1009
*EXITPROC:                                                         1010
*   PROC;                                                          1010
EXITPROC STM   @14,@12,@SA00009                                    1010
*   ADTEDXIT='1'B;                  /*                       @YL02014*/
         OI    ADTEDXIT,B'01000000'                                1011
*   DO;                             /* FREEMAIN(R)                 1012
*                                      LV(400)SP(250)A(USRSAVER)     */
*     RESPECIFY                                                    1013
*      (GPR01F,                                                    1013
*       GPR00F) RESTRICTED;                                        1013
*     GPR00F=400;                   /* LENGTH REQUESTED              */
         LA    GPR00F,400                                          1014
*     GPR01F=250;                   /* SP IN REG 1                   */
         LA    GPR01F,250                                          1015
*     GEN(SLL   GPR01F,24)                                         1016
*     NODEFS NOREFS NOSETS NOEXIT NOFLOWS SEQFLOW;                 1016
         SLL   GPR01F,24
*     GPR00F=GPR00F×GPR01F;         /* SP IN HI BYTE                 */
         OR    GPR00F,GPR01F                                       1017
*     GPR01F=ADDR(USRSAVER);        /* SET REGISTER ONE              */
         L     GPR01F,USRSAVE                                      1018
*     SVC(10);                      /* R-FORM OF GETMAIN             */
         SVC   10                                                  1019
*     RESPECIFY                                                    1020
*      (GPR01F,                                                    1020
*       GPR00F) UNRESTRICTED;                                      1020
*   END;                            /* FREEMAIN(R)                 1021
*                                      LV(400)SP(250)A(USRSAVER) U 1021
*                                      FOM AP ST             @ZA00919*/
*   FIDPTR=ADDR(SYSTAB);            /* SET UP CELLOPHANE TO SYSTAB   */
         LA    @15,SYSTAB                                          1022
         ST    @15,FIDPTR                                          1022
*   DO FIDI=1 TO 256;               /* START OF SEARCH FOR MODULE  1023
*                                      NAMES TO DELETE       @YL02014*/
         LA    @15,1                                               1023
         ST    @15,FIDI                                            1023
@DL01023 DS    0H                                                  1024
*     IF FIDLOAD(FIDI)='1'B THEN    /* CHECK FOR MODULE LOADED     1024
*                                                            @YL02014*/
         L     @01,FIDPTR                                          1024
         ALR   @01,@15                                             1024
         BCTR  @01,0                                               1024
         TM    FIDLOAD(@01),B'00100000'                            1024
         BNO   @RF01024                                            1024
*       DO;                         /* START OF AMDSYSXX MODULE    1025
*                                      LOADED                        */
*         FIDEPN='AMDSYS';          /*                       @YL02014*/
         MVI   FIDEPN+6,C' '                                       1026
         MVI   FIDEPN+7,C' '                                       1026
         MVC   FIDEPN(6),@CC02801                                  1026
*         FIDHEX=FOXFID(FIDI);      /* RETRIEVE PRINTABLE FID      1027
*                                                            @YL02014*/
         ALR   @15,@15                                             1027
         LA    @14,FOXFID-2(@15)                                   1027
         MVC   FIDHEX(2),0(@14)                                    1027
*         DO;                       /* DELETE EP(FIDEPN)             */
*           RESPECIFY                                              1029
*            (GPR00P) RESTRICTED;                                  1029
*           GPR00P=ADDR(FIDEPN);    /* ->ENTRY NAME                  */
         LA    GPR00P,FIDEPN                                       1030
*           SVC(9);                 /* DELETE SVC                    */
         SVC   9                                                   1031
*           RESPECIFY                                              1032
*            (GPR00P) UNRESTRICTED;                                1032
*         END;                      /* DELETE EP(FIDEPN) DELETE THE
*                                      MODULE                @YL02014*/
*       END;                        /*                       @YL02014*/
*   END;                            /*                       @YL02014*/
@RF01024 LA    @15,1                                               1035
         AL    @15,FIDI                                            1035
         ST    @15,FIDI                                            1035
         CH    @15,@CH00686                                        1035
         BNH   @DL01023                                            1035
*   FIDPTR=ADDR(USRTABL);           /* SET UP CELLOPHANE TO USRTAB   */
         LA    @15,USRTABL                                         1036
         ST    @15,FIDPTR                                          1036
*   DO FIDI=1 TO 256;               /* START OF SEARCH INTO USRTAB   */
         LA    @15,1                                               1037
         ST    @15,FIDI                                            1037
@DL01037 DS    0H                                                  1038
*     DO J=1 TO 3;                  /* START OF SEARCH LOAD PATH     */
         LA    @15,1                                               1038
         ST    @15,J                                               1038
@DL01038 DS    0H                                                  1039
*       IF(USRI(J)=(FIDTAB(FIDI)&USRI(J))) THEN                    1039
         MH    @15,@CH00912                                        1039
         L     @14,FIDI                                            1039
         L     @01,FIDPTR                                          1039
         ALR   @01,@14                                             1039
         BCTR  @01,0                                               1039
         MVC   @TS00001(1),FIDTAB(@01)                             1039
         LA    @01,USRI-7(@15)                                     1039
         NC    @TS00001(1),0(@01)                                  1039
         LA    @01,USRI-7(@15)                                     1039
         CLC   0(1,@01),@TS00001                                   1039
         BNE   @RF01039                                            1039
*         DO;                       /* START OF VERSION LOADED PATH  */
*           FIDEPN=USREPN(J);       /* MOVE IN VERSION PREFIX      1041
*                                                            @YL02014*/
         MVI   FIDEPN+6,C' '                                       1041
         MVI   FIDEPN+7,C' '                                       1041
         LA    @01,USREPN-7(@15)                                   1041
         MVC   FIDEPN(6),0(@01)                                    1041
*           FIDHEX=FOXFID(FIDI);    /* RETRIEVE PRINTABLE FID        */
         ALR   @14,@14                                             1042
         LA    @15,FOXFID-2(@14)                                   1042
         MVC   FIDHEX(2),0(@15)                                    1042
*           DO;                     /* DELETE EP(FIDEPN)             */
*             RESPECIFY                                            1044
*              (GPR00P) RESTRICTED;                                1044
*             GPR00P=ADDR(FIDEPN);  /* ->ENTRY NAME                  */
         LA    GPR00P,FIDEPN                                       1045
*             SVC(9);               /* DELETE SVC                    */
         SVC   9                                                   1046
*             RESPECIFY                                            1047
*              (GPR00P) UNRESTRICTED;                              1047
*           END;                    /* DELETE EP(FIDEPN) DELETE THE
*                                      MODULE                @YL02014*/
*         END;                      /* END OF VERSION LOADED PATH    */
*     END;                          /* END OF SEARCH LOAD PATH     1050
*                                                            @YL02014*/
@RF01039 LA    @15,1                                               1050
         AL    @15,J                                               1050
         ST    @15,J                                               1050
         CH    @15,@CH00294                                        1050
         BNH   @DL01038                                            1050
*   END;                            /* END OF SEARCH INTO USRTAB     */
         LA    @15,1                                               1051
         AL    @15,FIDI                                            1051
         ST    @15,FIDI                                            1051
         CH    @15,@CH00686                                        1051
         BNH   @DL01037                                            1051
*   DO;                             /* FREEMAIN(R)                 1052
*                                      LV(RDRBUFLN)SP(SQA)A(OUTBUFFR)*/
*     RESPECIFY                                                    1053
*      (GPR01F,                                                    1053
*       GPR00F) RESTRICTED;                                        1053
*     GPR00F=RDRBUFLN;              /* LENGTH REQUESTED              */
         L     GPR00F,RDRBUFLN                                     1054
*     GPR01F=SQA;                   /* SP IN REG 1                   */
         LA    GPR01F,245                                          1055
*     GEN(SLL   GPR01F,24)                                         1056
*     NODEFS NOREFS NOSETS NOEXIT NOFLOWS SEQFLOW;                 1056
         SLL   GPR01F,24
*     GPR00F=GPR00F×GPR01F;         /* SP IN HI BYTE                 */
         OR    GPR00F,GPR01F                                       1057
*     GPR01F=ADDR(OUTBUFFR);        /* SET REGISTER ONE              */
         L     GPR01F,READBUFF                                     1058
*     SVC(10);                      /* R-FORM OF GETMAIN             */
         SVC   10                                                  1059
*     RESPECIFY                                                    1060
*      (GPR01F,                                                    1060
*       GPR00F) UNRESTRICTED;                                      1060
*   END;                            /* FREEMAIN(R)                 1061
*                                      LV(RDRBUFLN)SP(SQA)A(OUTBUFFR)
*                                                            @YL02014*/
*   RFY                                                            1062
*     TCB BASED(ADPLTCB);           /*                       @YL02014*/
*   TCBGTOFM='0'B;                  /*                       @YL02014*/
         L     @01,ABDPLPTR                                        1063
         L     @01,ADPLTCB(,@01)                                   1063
         NI    TCBGTOFM(@01),B'11111110'                           1063
*   ADTEDXIT='0'B;                  /*                       @YL02014*/
         NI    ADTEDXIT,B'10111111'                                1064
*   END EXITPROC;                                                  1065
@EL00009 DS    0H                                                  1065
@EF00009 DS    0H                                                  1065
@ER00009 LM    @14,@12,@SA00009                                    1065
         BR    @14                                                 1065
*CONVRT:                                                           1066
*   PROC;                                                          1066
*                                                                  1066
CONVRT   STM   @14,@12,@SA00010                                    1066
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @YL02014*/
*   /* CONVRT IS A ROUTINE WHICH CONVERTS THE DATA IN RECORDS TO     */
*   /* PRINTABLE HEX AND EBCDIC, THEN PRINTS THE LINE WITH AN OFFSET */
*   /*                                                       @YL02014*/
*   /*                                                       @YL02014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1067
*   RFY                                                            1067
*     RCDDATA BASED(TIMEADJ);       /*                       @YL02014*/
*   ADTEDCVT='1'B;                  /*                       @YL02014*/
         OI    ADTEDCVT,B'10000000'                                1068
*   OUTEBCDC='';                    /* ZERO OUT EBCDIC PLACE @YL02014*/
         MVI   OUTEBCDC,C' '                                       1069
         MVC   OUTEBCDC+1(23),OUTEBCDC                             1069
*   UNPK(TEMPOFF1,TEMPOFF);         /* UNPACK OFFSET         @YL02014*/
         UNPK  TEMPOFF1(5),TEMPOFF(3)                              1070
*   OUTOFFST=TEMPOFF2;              /* SET OFFSET INTO DATA AREA     */
         L     @01,ABDPLPTR                                        1071
         L     @15,ADPLBUF(,@01)                                   1071
         MVC   OUTOFFST(4,@15),TEMPOFF2                            1071
*   TR(OUTOFFST,DEFTABLE);          /* TRANSLATE OFFSET AND PLACE  1072
*                                      INTO OUTPUT BUFFER    @YL02014*/
         TR    OUTOFFST(4,@15),DEFTABLE                            1072
*   OUTEBCDC=RCDDATA(OFFSET+1:OFFSET+NUMCON);                      1073
         MVI   OUTEBCDC+1,C' '                                     1073
         MVC   OUTEBCDC+2(22),OUTEBCDC+1                           1073
         L     @15,NUMCON                                          1073
         LR    @14,@15                                             1073
         BCTR  @14,0                                               1073
         SLR   @01,@01                                             1073
         ICM   @01,3,OFFSET                                        1073
         L     @07,TIMEADJ                                         1073
         ALR   @07,@01                                             1073
         EX    @14,@SM02922                                        1073
*   IF NUMCON=24 THEN               /* CHECK FOR WHOLE LINE  @YL02014*/
         CH    @15,@CH00072                                        1074
         BNE   @RF01074                                            1074
*     DO I=1 TO 6;                  /* START OF PRINT WHOLE LINE PATH
*                                                            @YL02014*/
         LA    @15,1                                               1075
         ST    @15,I                                               1075
@DL01075 DS    0H                                                  1076
*       UNPKDATA=RCDDATA((OFFSET+((I-1)*4)+1):(OFFSET+((I-1)*4)+5));
         LR    @14,@15                                             1076
         BCTR  @14,0                                               1076
         SLA   @14,2                                               1076
         SLR   @07,@07                                             1076
         ICM   @07,3,OFFSET                                        1076
         ALR   @14,@07                                             1076
         L     @01,TIMEADJ                                         1076
         ALR   @01,@14                                             1076
         MVC   UNPKDATA(4),RCDDATA(@01)                            1076
*       UNPK(UNPKDTA1,UNPKDTA);     /*                       @YL02014*/
         UNPK  UNPKDTA1(9),UNPKDTA(5)                              1077
*       OUTWORD(I)=UNPKDTA2;        /*                       @YL02014*/
         LR    @14,@15                                             1078
         MH    @14,@CH02011                                        1078
         L     @01,ABDPLPTR                                        1078
         L     @07,ADPLBUF(,@01)                                   1078
         ST    @14,@TF00001                                        1078
         ALR   @14,@07                                             1078
         MVC   OUTWORD-9(8,@14),UNPKDTA2                           1078
*       TR(OUTWORD(I),DEFTABLE);    /*                       @YL02014*/
         AL    @07,@TF00001                                        1079
         TR    OUTWORD-9(8,@07),DEFTABLE                           1079
*     END;                          /* END OF PRINT WHOLE LINE PATH
*                                                            @YL02014*/
         AL    @15,@CF00063                                        1080
         ST    @15,I                                               1080
         CH    @15,@CH01274                                        1080
         BNH   @DL01075                                            1080
*   ELSE                                                           1081
*     DO;                           /* START OF PRNT PARTIAL LINE  1081
*                                      PATH                  @YL02014*/
         B     @RC01074                                            1081
@RF01074 DS    0H                                                  1082
*       J=1;                        /* J PTR FOR HEX WORDS   @YL02014*/
         LA    @15,1                                               1082
         ST    @15,J                                               1082
*       DO I=1 TO NUMCON;           /* START OF LOOP PATH    @YL02014*/
         B     @DE01083                                            1083
@DL01083 DS    0H                                                  1084
*         BYTEDTA=RCDDATA(OFFSET+I);/*                       @YL02014*/
         SLR   @14,@14                                             1084
         ICM   @14,3,OFFSET                                        1084
         ALR   @14,@15                                             1084
         L     @01,TIMEADJ                                         1084
         BCTR  @01,0                                               1084
         SLR   @00,@00                                             1084
         IC    @00,RCDDATA(@14,@01)                                1084
         STH   @00,BYTEDTA                                         1084
*         UNPK(BYTEDTA1,BYTEDTA0);  /*                       @YL02014*/
         UNPK  BYTEDTA1(3),BYTEDTA0(3)                             1085
*         OUTBYTE(J:J+1)=BYTEDTA2;  /*                       @YL02014*/
         L     @14,J                                               1086
         L     @01,ABDPLPTR                                        1086
         L     @07,ADPLBUF(,@01)                                   1086
         ALR   @14,@07                                             1086
         MVC   OUTBYTE-1(2,@14),BYTEDTA2                           1086
*         TR(OUTBYTE(J:J+1),DEFTABLE);/*                     @YL02014*/
         L     @14,J                                               1087
         ALR   @07,@14                                             1087
         TR    OUTBYTE-1(2,@07),DEFTABLE                           1087
*         IF ZERO=I//4 THEN         /* ONE WORD OUT?         @YL02014*/
         LR    @00,@15                                             1088
         SRDA  @00,32                                              1088
         D     @00,@CF00056                                        1088
         LTR   @00,@00                                             1088
         BNZ   @RF01088                                            1088
*           J=J+3;                  /* YES, UPDATE J FOR BLANK     1089
*                                                            @YL02014*/
         AL    @14,@CF00294                                        1089
         ST    @14,J                                               1089
*         ELSE                                                     1090
*           J=J+2;                  /* NO, UPDATE J          @YL02014*/
         B     @RC01088                                            1090
@RF01088 LA    @15,2                                               1090
         AL    @15,J                                               1090
         ST    @15,J                                               1090
*       END;                        /* END OF LOOP PATH      @YL02014*/
@RC01088 LA    @15,1                                               1091
         AL    @15,I                                               1091
@DE01083 ST    @15,I                                               1091
         C     @15,NUMCON                                          1091
         BNH   @DL01083                                            1091
*     END;                          /* END OF PRINT PARTIAL LINE PATH
*                                                            @YL02014*/
*   RFY                                                            1093
*    (PARMRG1,                                                     1093
*     PARMRG0) RSTD;                /*                       @YL02014*/
@RC01074 DS    0H                                                  1094
*   PARMRG0=ADDR(EBCDICFP);         /* GET ADDR OF DATA      @YL02014*/
         LA    PARMRG0,EBCDICFP                                    1094
*   ADPLFMT2=ADDR(OUTEBCDC);        /* SET UP ADDR OF EBCDIC DATA  1095
*                                                            @YL02014*/
         L     @15,ABDPLPTR                                        1095
         LA    @14,OUTEBCDC                                        1095
         ST    @14,ADPLFMT2(,@15)                                  1095
*   PARMRG1=ABDPLPTR;               /*                       @YL02014*/
         LR    PARMRG1,@15                                         1096
*   CALL FRMTLINE;                  /*                       @YL02014*/
         L     @15,ADPLFRMT(,@15)                                  1097
         BALR  @14,@15                                             1097
*   AST1='*';                       /* SET IN ASTERICS AROUND      1098
*                                                            @YL02014*/
         L     @15,ABDPLPTR                                        1098
         L     @14,ADPLBUF(,@15)                                   1098
         MVI   AST1(@14),C'*'                                      1098
*   AST2='*';                       /* EBCDIC                @YL02014*/
         MVI   AST2(@14),C'*'                                      1099
*   CALL PRNTLINE;                  /* CALL TO PRINT LINE    @YL02014*/
         L     @15,ADPLPRNT(,@15)                                  1100
         BALR  @14,@15                                             1100
*   RFY                                                            1101
*    (PARMRG1,                                                     1101
*     PARMRG0) UNRSTD;              /*                       @YL02014*/
*   ADTEDCVT='0'B;                  /*                       @YL02014*/
         NI    ADTEDCVT,B'01111111'                                1102
*   END CONVRT;                                                    1103
@EL00010 DS    0H                                                  1103
@EF00010 DS    0H                                                  1103
@ER00010 LM    @14,@12,@SA00010                                    1103
         BR    @14                                                 1103
*ERRPROC:                                                          1104
*   PROC;                                                          1104
ERRPROC  STM   @14,@12,@SA00011                                    1104
*   ADTEDERR='1'B;                  /* SET AUDIT FLAGS       @YL02014*/
         OI    ADTEDERR,B'00100000'                                1105
*   RFY                                                            1106
*     PARMRG1 RSTD;                 /*                       @YL02014*/
*   OUTMSG(1:121)=MSGTAB(MSGIND,1:121);/* MOVE MSG INTO OUTPUT BUFFER
*                                                            @YL02014*/
         L     @15,ABDPLPTR                                        1107
         L     @14,ADPLBUF(,@15)                                   1107
         LH    @07,MSGIND                                          1107
         MH    @07,@CH02486                                        1107
         LA    @06,MSGTAB-121(@07)                                 1107
         MVC   OUTMSG(121,@14),0(@06)                              1107
*   PARMRG1=ABDPLPTR;               /* SET UP REG 1          @YL02014*/
         LR    PARMRG1,@15                                         1108
*   CALL PRNTLINE;                  /* CALL PRINT TO PRINT THE MSG   */
         L     @15,ADPLPRNT(,@15)                                  1109
         BALR  @14,@15                                             1109
*   RFY                                                            1110
*     PARMRG1 UNRSTD;               /*                       @YL02014*/
*   ADTEDERR='0'B;                  /* RESET AUDIT FLAGS     @YL02014*/
         NI    ADTEDERR,B'11011111'                                1111
*   RETURN;                         /* RETURN TO CALLER      @YL02014*/
@EL00011 DS    0H                                                  1112
@EF00011 DS    0H                                                  1112
@ER00011 LM    @14,@12,@SA00011                                    1112
         BR    @14                                                 1112
*   END;                            /* END OF ERRPROC        @YL02014*/
*IGCTOD:                                                           1114
*   PROC;                                                          1114
*                                                                  1114
IGCTOD   STM   @14,@12,@SA00012                                    1114
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @YL02014*/
*   /* POINTERS AND WORK REGISTERS USED BY TODCNVRT          @YL02014*/
*   /*                                                       @YL02014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1115
*   DCL                                                            1115
*     PARMREG1 PTR(31) REG(1);      /* INPUT PARM REG POINTS TO    1115
*                                      PARMLIST. Y01980              */
*   DCL                                                            1116
*     PARMREG2 PTR(31) REG(2);      /* INPUT PARM REG CONTAINING   1116
*                                      REQUEST CODE. ALSO USED AS A
*                                      WORK REG WHEN UNPACKING.Y01980*/
*   DCL                                                            1117
*     R4 PTR(31) REG(4);            /* REGISTER USED FOR DIVIDES.  1117
*                                      WILL NORMALLY CONTAIN THE   1117
*                                      REMAINDER Y01980              */
*   DCL                                                            1118
*     W PTR(31) REG(5);             /* REGISTER USED FOR DIVIDES.  1118
*                                      WILL NORMALLY CONTAIN THE   1118
*                                      QUOTIENT.               Y01980*/
*   DCL                                                            1119
*     DAYREG PTR(31) REG(3);        /* USED TO CALCULATE CURRENT DAY
*                                                              Y01980*/
*   DCL                                                            1120
*     YEARREG PTR(31) REG(6);       /* USED TO CALCULATE CURRENT YR
*                                                              Y01980*/
*                                                                  1120
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @YL02014*/
*   /* THE FOLLOWING STRUCTURE DESCRIBES THE PARAMETER LIST FORMAT   */
*   /* AND IS USED TO REFERENCE THE PARAMETER LIST           @YL02014*/
*   /*                                                       @YL02014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1121
*   DCL                                                            1121
*     1 INPUTLST BASED(PARMREG1),   /* INPUT PARMLIST          Y01980*/
*       3 CVTTZPTR PTR(31),         /* ADDR OF CVTTZ VALUE     Y01980*/
*       3 TODPTR PTR(31),           /* ADDR OF TOD CLOCK VALUE Y01980*/
*       3 OUTAREA PTR(31);          /* ADDR OF OUTPUT AREA     Y01980*/
*                                                                  1121
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @YL02014*/
*   /* CVRTAREA IS A DOUBLE WORD AREA INTO WHICH THE TOD VALUE IS    */
*   /* INITIALLY MOVED SO IT IS ALIGNED ON A WORD BOUNDARY FOR       */
*   /* CONVERSION TO LOCAL TIME. CVRTAREA IS ALSO USED AS A WORKAREA */
*   /* WHEN CONVERTING TO DECIMAL                            @YL02014*/
*   /*                                                       @YL02014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1122
*   DCL                                                            1122
*     1 CVRTAREA CHAR(8) BDY(DWORD),/* WORK AREA               Y01980*/
*       3 TODWORD1 FIXED(31),       /* BITS 0-31 OF TOD VALUE  Y01980*/
*       3 TODWORD2 FIXED(31);       /* BITS 32-63 OF TOD VALUE Y01980*/
*                                                                  1122
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @YL02014*/
*   /* CVTTZVAL AND TODVALUE ARE BASED VARIABLES USED WHEN   @YL02014*/
*   /* RERERENCING THE CVTTZ AND TOD CLOCK VALUES POINTED TO BY THE  */
*   /* INPUT PARM LIST. TIMEAREA IS USED TO REFERENCE THE OUTPUT AREA*/
*   /* IN WHICH THE CONVERTED TIME IS PLACED.                @YL02014*/
*   /*                                                       @YL02014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1123
*   DCL                                                            1123
*     CVTTZVAL FIXED(31) BDY(WORD,2) BASED(CVTTZPTR);/* CVTTZ VALUE
*                                      PARAMETER               Y01980*/
*   DCL                                                            1124
*     TODVALUE CHAR(8) BASED(TODPTR);/* TOD CLOCK VALUE      @YL02014
*                                      PARAMETER               Y01980*/
*   DCL                                                            1125
*     TIMEAREA(24) CHAR(1) BASED(OUTAREA);/* TIME OUTPUT AREA  Y01980*/
*   DCL                                                            1126
*     TIMEERIA CHAR(24) BASED(OUTAREA);/* USED TO REFERENCE OUTPUT 1126
*                                      AREA WHEN MOVING IN A ZERO  1126
*                                      TIME DUE TO A ZERO INPUT TOD
*                                      VALUE                   Y01980*/
*                                                                  1126
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @YL02014*/
*   /* TODBRTAB IS USED TO PASS CONTROL TO THE PROPER TOD CONVERSION */
*   /* ROUTINE. THE REQUEST CODE PASSED IN PARMREG2 IS USED TO INDEX */
*   /* THE TABLE. THE POSSIBLE CODES AND ASSOCIATED ROUTINE ENTRY    */
*   /* POINTS ARE AS FOLLOWS:                                @YL02014*/
*   /*                                                       @YL02014*/
*   /* CODE ENTRY TYPE OF CONVERSION                         @YL02014*/
*   /*                                                       @YL02014*/
*   /* 1 FULLDATE CONVERT TO A FULL DATE AND TIME 2 RELTVTME CONVERT */
*   /* TO RELATIVE TIME                                      @YL02014*/
*   /*                                                       @YL02014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1127
*   DCL                                                            1127
*    (FULLDATE,                                                    1127
*     RELTVTME) LABEL;              /* ENTRY LABELS FOR BRNCH TABLE
*                                                              Y01980*/
*   DCL                                                            1128
*     TODBRTAB(2) PTR(31)           /* TOD BRANCH TABLE        Y01980*/
*         INIT(ADDR(FULLDATE),      /* FULLDATE CONVERSION ROUTINE 1128
*                                                              Y01980*/
*         ADDR(RELTVTME));          /* RELATIVE TIME CONVERSION RTN
*                                                              Y01980*/
*                                                                  1128
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @YL02014*/
*   /* CONSTANTS AND WORK VARIABLES                          @YL02014*/
*   /*                                                       @YL02014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1129
*   DCL                                                            1129
*     SIXTYMIL FIXED(31) INIT(60000000);/* NUMBER OF MICRO SECONDS IN
*                                      A MINUTE                Y01980*/
*   DCL                                                            1130
*     ZEROTOD CHAR(8) INIT('0000000000000000'X);/* USED TO CHK FOR 1130
*                                      ZERO TOD VALUE IN INPUT Y01980*/
*   DCL                                                            1131
*     ZEROTIME CHAR(12) INIT('00000.000000');/* RELATIVE TIME      1131
*                                      RETURNED WHEN WHEN TOD VALUE
*                                      IS ZERO FOR A RELATIVE TIME 1131
*                                      CONVERSION REQUEST      Y01980*/
*   DCL                                                            1132
*     NULLTIME CHAR(22) INIT('000000000.00.00.000000');/* FULL DATE
*                                      AND TIME RETURNED WHEN TOD  1132
*                                      VALUE IS ZERO FOR A FULL DATE
*                                      CON- VERSION REQUEST.   Y01980*/
*   DCL                                                            1133
*     TIMELEFT FIXED(31);           /* USED TO SAVE TIME REMAINING TO
*                                      BE CONVERTED            Y01980*/
*   DCL                                                            1134
*     SECONDS FIXED(31) BASED(ADDR(TIMELEFT));/* USED BY RELATIVE  1134
*                                      TIME CONVERSION ROUTINE TO  1134
*                                      SAVE SECONDS            Y01980*/
*                                                                  1134
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @YL02014*/
*   /* RESTRICTED REGISTERS                                  @YL02014*/
*   /*                                                       @YL02014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1135
*   RESPECIFY                                                      1135
*    (PARMREG1,                                                    1135
*     PARMREG2) RESTRICTED;         /*                         Y02006
*                                      RESTRICT PARM REGISTERS Y01980*/
*   RESPECIFY                                                      1136
*    (W,                                                           1136
*     R4,                                                          1136
*     DAYREG,                                                      1136
*     YEARREG) RESTRICTED;          /*                         Y02006
*                                      RESTRICT WORK REGISTERS Y01980*/
*                                                                  1136
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @YL02014*/
*   /* BEGIN TIME OF DAY CONVERSION. MOVE THE TOD VALUE TO A DOUBLE  */
*   /* WORD AREA AND ADD THE CVTTZ VALUE TO TOD BIT POSITIONS 0-31.  */
*   /* THIS WILL CONVERT THE TOD VALUE TO LOCAL TIME.        @YL02014*/
*   /*                                                       @YL02014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1137
*   CVRTAREA=TODVALUE;              /* MOVE TOD VALUE TO A DOUBLEWORD
*                                      WORKAREA                Y01980*/
         L     @07,TODPTR(,PARMREG1)                               1137
         MVC   CVRTAREA(8),TODVALUE(@07)                           1137
*   TODWORD1=TODWORD1+CVTTZVAL;     /* CHANGE TOD TO LOCAL TIMEY01980*/
*                                                                  1138
         L     @07,CVTTZPTR(,PARMREG1)                             1138
         L     @00,TODWORD1                                        1138
         AL    @00,CVTTZVAL(,@07)                                  1138
         ST    @00,TODWORD1                                        1138
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @YL02014*/
*   /* CALCULATE TOTAL NUMBER OF MINUTES SINCE THE EPOCH TIME THE    */
*   /* NUMBER OF MICROSECONDS THAT HAVE PASSED IN THE CURRENT MINUTE.*/
*   /*                                                       @YL02014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1139
*   GEN(LM R4,W,CVRTAREA);          /* PUT TOD VALUE IN EVEN-ODD   1139
*                                      REGISTER PAIR           Y01980*/
         LM R4,W,CVRTAREA
*   GEN(SRDL R4,12);                /* SHIFT TOD VALUE TO REMOVE THE
*                                      INSIGNIFICANT BITS      Y01980*/
         SRDL R4,12
*   GEN(D R4,SIXTYMIL);             /* DIVID TOD VALUE BY NUMBER OF
*                                      MICROSECONDS IN A MINUTE. W -
*                                      CONTAINS TOTAL MINUTES SINCE
*                                      THE EPOCH TIME          Y01980
*                                      L - CONTAINS TOTAL NUMBER OF
*                                      MICROSECONDS INTO CURRENT   1141
*                                      MINUTE                  Y01980*/
*                                                                  1141
         D R4,SIXTYMIL
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @YL02014*/
*   /* GO TO PROPER CONVERSION ROUTINE FOR PROCESSING THIS TOD       */
*   /* CONVERT REQUEST. USE THE REQUEST CODE IN PARMREG2 TO INDEX THE*/
*   /* TODBRTAB. THE CODES AND ASSOCIATED ROUTINE ENTRY LABELS ARE AS*/
*   /* FOLLOWS:                                              @YL02014*/
*   /*                                                       @YL02014*/
*   /* CODE ENTRY TYPE OF CONVERSION                         @YL02014*/
*   /*                                                       @YL02014*/
*   /* 1 FULLDATE CONVERT TO A FULL DATE AND TIME 2 RELTVTME CONVERT */
*   /* TO RELATIVE TIME                                      @YL02014*/
*   /*                                                       @YL02014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1142
*   GOTO TODBRTAB(PARMREG2);        /* BRANCH ON REQUEST CODE  Y01980*/
         LR    @07,PARMREG2                                        1142
         SLA   @07,2                                               1142
         L     @07,TODBRTAB-4(@07)                                 1142
         BR    @07                                                 1142
*                                                                  1143
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @YL02014*/
*   /* RELATIVE TIME CONVERSION --                           @YL02014*/
*   /*                                                       @YL02014*/
*   /* THIS ROUTINE RECEIVES CONTROL AT ENTRY 'RELTVTME'. IT CONVERTS*/
*   /* THE TOD VALUE TO RELATIVE SECONDS.MICROSECONDS FROM 0 A.M. OF */
*   /* THE CURRENT DAY REFLECTED BY THE TOD VALUE. THE CONVERTED TIME*/
*   /* IS PLACED LEFT JUSTIFIED IN THE OUTPUT AREA PASSED BY THE     */
*   /* TODCVRT CALLER AND IS IN THE FORM SSSSS.MMMMMM (EBCDIC). UPON */
*   /* ENTRY TO THIS ROUTINE THE TOD VALUE HAS ALREADY BEEN CHANGED  */
*   /* TO TOTAL MINUTES (IN W) AND NUMBER OF MICROSECONDS INTO       */
*   /* CURRENT MINUTE (IN L). WHEN PROCESSING IS COMPLETED CONTROL IS*/
*   /* RETURNED TO THE TODCNVRT CALLER                       @YL02014*/
*   /*                                                       @YL02014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1143
*RELTVTME:                                                         1143
*   IF TODVALUE=ZEROTOD THEN        /* IS TOD VALUE ZERO ?     Y01980*/
RELTVTME L     @07,TODPTR(,PARMREG1)                               1143
         CLC   TODVALUE(8,@07),ZEROTOD                             1143
         BNE   @RF01143                                            1143
*     DO;                           /* YES, PASS BACK A TIME OF ZERO */
*       TIMEERIA=ZEROTIME;          /* MOVE ZERO TIME INTO OUT AREA
*                                                              Y01980*/
         L     @07,OUTAREA(,PARMREG1)                              1145
         MVI   TIMEERIA+12(@07),C' '                               1145
         MVC   TIMEERIA+13(11,@07),TIMEERIA+12(@07)                1145
         MVC   TIMEERIA(12,@07),ZEROTIME                           1145
*       RETURN CODE(4);             /* INDICATE ZERO TOD TO CALLER 1146
*                                                              Y01980*/
         LA    @15,4                                               1146
         L     @14,@SA00012                                        1146
         LM    @00,@12,@SA00012+8                                  1146
         BR    @14                                                 1146
*     END;                          /*                       @YL02014*/
*   SECONDS=R4/1000000;             /* CALCULATE NUMBER OF SECONDS 1148
*                                      INTO CURRENT MINUTE.    Y01980*/
@RF01143 LA    @07,TIMELEFT                                        1148
         L     @15,@CF02857                                        1148
         ST    @15,@TF00001                                        1148
         LR    @15,R4                                              1148
         SLR   @14,@14                                             1148
         D     @14,@TF00001                                        1148
         ST    @15,SECONDS(,@07)                                   1148
*   R4=R4//1000000;                 /* CALCULATE NUMBER OF MICROSECS
*                                      INTO CURRENT SECOND     Y01980*/
         LR    @14,R4                                              1149
         SRDA  @14,32                                              1149
         D     @14,@TF00001                                        1149
         LR    R4,@14                                              1149
*   PARMREG2=ADDR(TIMEAREA(7));     /* GET ADDROF OUTPUT LOCATION IN
*                                      WHICH CONVERTED MICROSECS ARE
*                                      TO BE PLACED            Y01980*/
*                                                                  1150
         L     PARMREG2,OUTAREA(,PARMREG1)                         1150
         LA    PARMREG2,TIMEAREA+6(,PARMREG2)                      1150
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @YL02014*/
*   /* CONVERT MICROSECONDS TO EBCDIC                        @YL02014*/
*   /*                                                       @YL02014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1151
*   GEN(CVD R4,CVRTAREA);           /* CNVRT MICROSECONDS TO DECIMAL
*                                                              Y01980*/
         CVD R4,CVRTAREA
*   GEN(UNPK 0(6,PARMREG2),CVRTAREA+4(4));/* UNPACK MICROSECONDS   1152
*                                                              Y01980*/
         UNPK 0(6,PARMREG2),CVRTAREA+4(4)
*   GEN(OI 5(PARMREG2),X'F0');      /* CHANGE SIGN TO A NUMERIC ZONE
*                                                              Y01980*/
         OI 5(PARMREG2),X'F0'
*   TIMEAREA(6)='.';                /* INSERT SEPARATER        Y01980*/
*                                                                  1154
         L     @07,OUTAREA(,PARMREG1)                              1154
         MVI   TIMEAREA+5(@07),C'.'                                1154
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @YL02014*/
*   /* CALCULATE NUMBER OF SECONDS INTO CURRENT DAY AND CONVERT TO   */
*   /* EBCDIC                                                @YL02014*/
*   /*                                                       @YL02014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1155
*   R4=((W//1440)*60)+SECONDS;      /* CALC SECONDS INTO CUR DAY   1155
*                                                              Y01980*/
         LR    @14,W                                               1155
         SRDA  @14,32                                              1155
         D     @14,@CF02859                                        1155
         MH    @14,@CH02860                                        1155
         LA    @15,TIMELEFT                                        1155
         AL    @14,SECONDS(,@15)                                   1155
         LR    R4,@14                                              1155
*   PARMREG2=ADDR(TIMEAREA(1));     /* GET ADDR OF OUTPUT LOCATION IN
*                                      WHICH CONVERTED SECONDS ARE TO
*                                      BE PLACED               Y01980*/
         LR    PARMREG2,@07                                        1156
*   GEN(CVD R4,CVRTAREA);           /* CONVRT SECONDS TO DECIMAL   1157
*                                                              Y01980*/
         CVD R4,CVRTAREA
*   GEN(UNPK 0(5,PARMREG2),CVRTAREA+5(3));/* UNPACK SECONDS    Y01980*/
         UNPK 0(5,PARMREG2),CVRTAREA+5(3)
*   GEN(OI 4(PARMREG2),X'F0');      /* CHANGE SIGN TO A NUMERIC ZONE
*                                                              Y01980*/
         OI 4(PARMREG2),X'F0'
*   RETURN CODE(0);                 /* INDICATE TOD VALUE WAS CNVRTED
*                                                              Y01980
*                                      EXIT TO THE TODCNVRT CALLER 1160
*                                                              Y01980*/
         SLR   @15,@15                                             1160
         L     @14,@SA00012                                        1160
         LM    @00,@12,@SA00012+8                                  1160
         BR    @14                                                 1160
*                                                                  1161
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @YL02014*/
*   /* FULL DATA AND TIME CONVERSION --                      @YL02014*/
*   /*                                                       @YL02014*/
*   /* THIS ROUTINE RECEIVES CONTROL AT ENTRY LABEL 'FULLDATE'. IT   */
*   /* CONVERTS THE TOD VALUE TO YEAR, JULIAN DAY, HOURS, MINUTES,   */
*   /* SECONDS, AND MICROSECONDS. THE CONVERTED TIME IS PLACED LEFT  */
*   /* JUSTIFIED IN THE OUTPUT AREA PASSED BY THE TODCNVRT CALLER AND*/
*   /* IS IN THE FORM                                        @YL02014*/
*   /* YYYYDDDHH.MM.SS.MMMMMM (EBCDIC). UPON ENTRY TO THIS ROUTINE   */
*   /* THE TOD VALUE HAS ALREADY BEEN CHANGED TO TOTAL MINUTES SINCE */
*   /* EPOCH (IN W) AND NUMBER OF MICROSECONDS INTO CURRENT MINUTE   */
*   /* (IN L). WHEN PROCESSING IS COMPLETED CONTROL IS RETURNED TO   */
*   /* THE TODCNVRT CALLER.                                  @YL02014*/
*   /*                                                       @YL02014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1161
*FULLDATE:                                                         1161
*   IF TODVALUE=ZEROTOD THEN        /* IS TOD VALUE ZERO ?     Y01980*/
FULLDATE L     @07,TODPTR(,PARMREG1)                               1161
         CLC   TODVALUE(8,@07),ZEROTOD                             1161
         BNE   @RF01161                                            1161
*     DO;                           /* YES, PASS BACK A TIME OF ZERO
*                                                              Y01980*/
*       TIMEERIA=NULLTIME;          /* MOVE ZERO TIME INTO OUT AREA
*                                                              Y01980*/
         L     @07,OUTAREA(,PARMREG1)                              1163
         MVI   TIMEERIA+22(@07),C' '                               1163
         MVI   TIMEERIA+23(@07),C' '                               1163
         MVC   TIMEERIA(22,@07),NULLTIME                           1163
*       RETURN CODE(4);             /* INDICATE ZERO TOD TO CALLER 1164
*                                                              Y01980*/
         LA    @15,4                                               1164
         L     @14,@SA00012                                        1164
         LM    @00,@12,@SA00012+8                                  1164
         BR    @14                                                 1164
*     END;                          /*                       @YL02014*/
*   SECONDS=R4/1000000;             /* CALCULATE NUMBER OF SECONDS 1166
*                                                              Y01980*/
@RF01161 LA    @07,TIMELEFT                                        1166
         L     @15,@CF02857                                        1166
         ST    @15,@TF00001                                        1166
         LR    @15,R4                                              1166
         SLR   @14,@14                                             1166
         D     @14,@TF00001                                        1166
         ST    @15,SECONDS(,@07)                                   1166
*   R4=R4//1000000;                 /* CALCULATE NO. OF MICROSECONDS
*                                                              Y01980*/
*                                                                  1167
         LR    @14,R4                                              1167
         SRDA  @14,32                                              1167
         D     @14,@TF00001                                        1167
         LR    R4,@14                                              1167
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @YL02014*/
*   /* CONVERT MICROSECONDS TO EBCDIC IN THE OUTPUT AREA     @YL02014*/
*   /*                                                       @YL02014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1168
*   PARMREG2=ADDR(TIMEAREA(17));    /* GET ADDR OF OUTPUT LOCATION IN
*                                      WHICH CONVERTED MICROSECS ARE
*                                      TO BE PLACED            Y01980*/
         L     PARMREG2,OUTAREA(,PARMREG1)                         1168
         LA    PARMREG2,TIMEAREA+16(,PARMREG2)                     1168
*   GEN(CVD R4,CVRTAREA);           /* CNVRT MICROSECONDS TO DECIMAL
*                                                              Y01980*/
         CVD R4,CVRTAREA
*   GEN(UNPK 0(6,PARMREG2),CVRTAREA+4(4));/* UNPACK MICROSECONDS   1170
*                                                              Y01980*/
         UNPK 0(6,PARMREG2),CVRTAREA+4(4)
*   GEN(OI 5(PARMREG2),X'F0');      /* CHANGE SIGN TO A NUMERIC ZONE
*                                                              Y01980*/
         OI 5(PARMREG2),X'F0'
*   TIMEAREA(16)='.';               /* INSERT SEPARATER        Y01980*/
*                                                                  1172
         L     @07,OUTAREA(,PARMREG1)                              1172
         MVI   TIMEAREA+15(@07),C'.'                               1172
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @YL02014*/
*   /* CONVERT SECONDS TO EBCDIC IN THE OUTPUT AREA          @YL02014*/
*   /*                                                       @YL02014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1173
*   R4=SECONDS;                     /* GET NUMBER OF SECONDS   Y01980*/
         LA    @15,TIMELEFT                                        1173
         L     R4,SECONDS(,@15)                                    1173
*   PARMREG2=ADDR(TIMEAREA(14));    /* GET ADDR OF OUTPUT LOCATION IN
*                                      WHICH CONVERTED SECONDS ARE TO
*                                      BE PLACED               Y01980*/
         LA    PARMREG2,TIMEAREA+13(,@07)                          1174
*   GEN(CVD R4,CVRTAREA);           /* CNVRT SECONDS TO DECIMALY01980*/
         CVD R4,CVRTAREA
*   GEN(UNPK 0(2,PARMREG2),CVRTAREA+6(2));/* UNPACK SECONDS    Y01980*/
         UNPK 0(2,PARMREG2),CVRTAREA+6(2)
*   GEN(OI 1(PARMREG2),X'F0');      /* CHANGE SIGN TO A NUMERIC ZONE
*                                                              Y01980*/
         OI 1(PARMREG2),X'F0'
*   TIMEAREA(13)='.';               /* INSERT SEPARATER        Y01980*/
*                                                                  1178
         L     @07,OUTAREA(,PARMREG1)                              1178
         MVI   TIMEAREA+12(@07),C'.'                               1178
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @YL02014*/
*   /* CALCULATE NUMBER OF MINUTES INTO CURRENT HOUR AND CONVERT THE */
*   /* RESULT TO EBCDIC IN THE OUTPUT AREA. W CONTAINS TOTAL NUMBER  */
*   /* OF MINUTES FROM THE EPOCH                             @YL02014*/
*   /*                                                       @YL02014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1179
*   TIMELEFT=W/60;                  /* CALC TOTAL HOURS SINCE EPOCH
*                                                              Y01980*/
         LA    @15,60                                              1179
         ST    @15,@TF00001                                        1179
         LR    @15,W                                               1179
         SLR   @14,@14                                             1179
         D     @14,@TF00001                                        1179
         ST    @15,TIMELEFT                                        1179
*   R4=W//60;                       /* CALC MINUTES INTO CURRENT HR
*                                                              Y01980*/
         LR    @14,W                                               1180
         SRDA  @14,32                                              1180
         D     @14,@TF00001                                        1180
         LR    R4,@14                                              1180
*   PARMREG2=ADDR(TIMEAREA(11));    /* GET ADDR OF OUTPUT LOCATION IN
*                                      WHICH CONVERTED MINUTES ARE TO
*                                      BE PLACED               Y01980*/
         LA    PARMREG2,TIMEAREA+10(,@07)                          1181
*   GEN(CVD R4,CVRTAREA);           /* CONVERT MINUTES TO DECIMAL  1182
*                                                              Y01980*/
         CVD R4,CVRTAREA
*   GEN(UNPK 0(2,PARMREG2),CVRTAREA+6(2));/* UNPACK MINUTES    Y01980*/
         UNPK 0(2,PARMREG2),CVRTAREA+6(2)
*   GEN(OI 1(PARMREG2),X'F0');      /* CHANGE SIGN TO A NUMERIC ZONE
*                                                              Y01980*/
         OI 1(PARMREG2),X'F0'
*   TIMEAREA(10)='.';               /* INSERT SEPARATER        Y01980*/
*                                                                  1185
         L     @07,OUTAREA(,PARMREG1)                              1185
         MVI   TIMEAREA+9(@07),C'.'                                1185
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @YL02014*/
*   /* CALCULATE NUMBER OF HOURS INTO CURRENT DAY AND CONVERT THE    */
*   /* RESULT TO EBCDIC IN THE OUTPUT AREA. TIMELEFT CONTAINS TOTAL  */
*   /* NUMBER OF HOURS SINCE THE EPOCH.                      @YL02014*/
*   /*                                                       @YL02014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1186
*   W=TIMELEFT;                     /* GET TOTAL HOURS SINCE EPOCH 1186
*                                                              Y01980*/
         L     W,TIMELEFT                                          1186
*   TIMELEFT=W/24;                  /* CALC TOTAL DAYS SINCE EPOCH 1187
*                                                              Y01980*/
         LA    @15,24                                              1187
         ST    @15,@TF00001                                        1187
         LR    @15,W                                               1187
         SLR   @14,@14                                             1187
         D     @14,@TF00001                                        1187
         ST    @15,TIMELEFT                                        1187
*   R4=W//24;                       /* CALC HOURS INTO CURRENT DAY 1188
*                                                              Y01980*/
         LR    @14,W                                               1188
         SRDA  @14,32                                              1188
         D     @14,@TF00001                                        1188
         LR    R4,@14                                              1188
*   PARMREG2=ADDR(TIMEAREA(8));     /* GET ADDR OF OUTPUT LOCATION IN
*                                      WHICH CONVERTED HOURS ARE TO
*                                      BE PLACED               Y01980*/
         LA    PARMREG2,TIMEAREA+7(,@07)                           1189
*   GEN(CVD R4,CVRTAREA);           /* CONVERT HOURS TO DECIMALY01980*/
         CVD R4,CVRTAREA
*   GEN(UNPK 0(2,PARMREG2),CVRTAREA+6(2));/* UNPACK HOURS      Y01980*/
         UNPK 0(2,PARMREG2),CVRTAREA+6(2)
*   GEN(OI 1(PARMREG2),X'F0');      /* CHANGE SIGN TO A NUMERIC ZONE
*                                                              Y01980*/
*                                                                  1192
         OI 1(PARMREG2),X'F0'
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @YL02014*/
*   /* CALCULATE THE CURRENT YEAR AND JULIAN DAY USING 'TIMELEFT'    */
*   /* WHICH CONTAINS THE TOTAL NUMBER OF ELAPSED DAYS SINCE 1900.   */
*   /* FIRST CHECK WHETHER THE TIME IS IN THE 1900 THROUGH 1903 ERA  */
*   /* (I.E., LESS THAN 1460 ELAPSED DAYS). IF SO, THE TIME MUST BE  */
*   /* HANDLED IN A SPECIAL WAY SINCE 1900 IS NOT A LEAP YEAR AND    */
*   /* EACH YEAR IN THAT FOUR YEAR SPAN THUS CONTAINS EXACTLY 365    */
*   /* DAYS. IF THE ELAPSED TIME HOWEVER IS GREATER THAN 1459 DAYS   */
*   /* THEN EVERY FOUR YEARS CONTAINS 1461 DAYS RATHER THAN 1460 AND */
*   /* THE FIRST YEAR OF EACH GROUP IS A LEAP YEAR. THESE FOUR YEAR  */
*   /* GROUPS ARE REFERRED TO AS LEAP YEAR GROUPS (E.G., 1904-1907,  */
*   /* 1908-1911, ETC.). THE YEAR AND THE DAY WHEN THE ELAPSED TIME  */
*   /* FALLS INTO ONE OF THESE GROUPS MUST BE CALCULATED USING       */
*   /* STANDARD FORMULAS DIFFERENT FROM THE FORMULAS USED WHEN THE   */
*   /* TIME IS BETWEEN 1900 AND JANUARY 1, 1904.             @YL02014*/
*   /*                                                       @YL02014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1193
*   IF TIMELEFT<1460 THEN           /* IS TIME ELAPSED WITHIN THE  1193
*                                      1900 THRU 1903 ERA?     Y01980*/
         L     @07,TIMELEFT                                        1193
         CH    @07,@CH02863                                        1193
         BNL   @RF01193                                            1193
*NOLEAPYR:                                                         1194
*     DO;                           /* YES CALCULATE YEAR AND DAY  1194
*                                      WITHIN THE 1900 THRU 1903 ERA
*                                                              Y01980*/
NOLEAPYR DS    0H                                                  1195
*       DAYREG=(TIMELEFT//365)+1;   /* CALCULATE CURRENT DAY   Y01980*/
         L     @07,TIMELEFT                                        1195
         LA    @15,365                                             1195
         LR    @14,@07                                             1195
         ST    @15,@TF00001                                        1195
         SRDA  @14,32                                              1195
         D     @14,@TF00001                                        1195
         AL    @14,@CF00063                                        1195
         LR    DAYREG,@14                                          1195
*       YEARREG=1900+(TIMELEFT/365);/* CALCULATE CURRENT YR.   Y01980*/
         LR    @14,@07                                             1196
         SRDA  @14,32                                              1196
         D     @14,@TF00001                                        1196
         AH    @15,@CH02867                                        1196
         LR    YEARREG,@15                                         1196
*     END NOLEAPYR;                 /*                       @YL02014*/
*                                                                  1197
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @YL02014*/
*   /* THE TIME ELAPSED IS 1460 OR MORE DAYS (I.E., THE CURRENT YEAR */
*   /* AND DAY MUST BE WITHIN A LEAP YEAR GROUP). THUS ADJUST THE    */
*   /* ELAPSED TIME CONTAINED IN 'TIMELEFT' SO THAT 1904 CAN BE USED */
*   /* AS THE STARTING POINT FOR CALCULATING THE CURRENT YEAR AND    */
*   /* DAY. NEXT CALCULATE W, THE RELATIVE LEAP YEAR GROUP SINCE     */
*   /* 1904, AND L, THE NUMBER OF DAYS THAT HAVE ELAPSED IN THE      */
*   /* CURRENT LEAP YEAR GROUP. FINALLY, USE THESE VALUES IN THE     */
*   /* FORMULAS FOR CALCULATING THE CURRENT DAY AND YEAR WHEN ELAPSED*/
*   /* TIME IS GREATER THAN 1459.                            @YL02014*/
*   /*                                                       @YL02014*/
*   /* IN THE FORMULA USED TO CALCULATE THE CURRENT JULIAN DAY, THE  */
*   /* EXPRESSION IN PARENTHESES IS THE NUMBER OF WHOLE DAYS THAT    */
*   /* HAVE PAST IN THE CURRENT YEAR. BECAUSE THE CURRENT DAY HAS NOT*/
*   /* YET ELAPSED, IT IS NOT INCLUDED IN THE RESULT PRODUCED BY THE */
*   /* EXPRESSION AND THEREFORE 1 MUST BE ADDED TO GET THE ACTUAL    */
*   /* JULIAN DAY. WITHIN THE EXPRESSION THE FIRST TERM, R, MUST BE  */
*   /* ADJUSTED BY 1 (I.E., L/731) IF THE TOTAL DAYS INTO THE LEAP   */
*   /* YEAR GROUP IS GREATER OR EQUAL TO 2 YEARS AND AGAIN BY 1 (I.E.*/
*   /* L/1096) IF THE TOTAL DAYS IS EQUAL TO OR GREATER THAN 3 YEARS.*/
*   /* THE AFFECT OF THIS IS THAT THE SECOND YEAR AND THIRD YEAR ARE */
*   /* FORCED TO 366 DAYS ONCE THE TOTAL DAYS INTO THE LEAP YEAR     */
*   /* GROUP EXCEEDS EACH OF THESE YEARS. THIS IS NECESSARY BECAUSE A*/
*   /* DIVISOR OF 366 IS USED.                               @YL02014*/
*   /*                                                       @YL02014*/
*   /* IN THE FORMULA FOR CALCULATING THE YEAR, 1904 IS THE BASE     */
*   /* YEAR. THE SECOND TERM (W * 4) YIELDS THE RELATIVE NUMBER OF   */
*   /* YEARS SINCE 1904 UP TO AND INCLUDING THE LEAP YEAR IN THE     */
*   /* CURRENT LEAP YEAR GROUP. THE THIRD TERM ( (L-1)/365 ) YIELDS  */
*   /* THE RELATIVE YEAR WITHIN THE CURRENT LEAP YEAR GROUP. THUS IF */
*   /* THE CURRENT YEAR IS A LEAP YEAR THE RELATIVE YEAR WITHIN THE  */
*   /* CURRENT LEAP YEAR GROUP IS 0 AND THE THIRD TERM WILL YIELD A  */
*   /* RESULT OF ZERO.                                       @YL02014*/
*   /*                                                       @YL02014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1198
*   ELSE                                                           1198
*LEAPYR:                                                           1198
*     DO;                           /* DATE IS GREATER THAN 1903   1198
*                                                              Y01980*/
         B     @RC01193                                            1198
@RF01193 DS    0H                                                  1198
LEAPYR   DS    0H                                                  1199
*       TIMELEFT=TIMELEFT-1460;     /* ADJUST ELAPSED TIME SO 1904 1199
*                                      BASE CAN BE USED IN FORMULA 1199
*                                                              Y01980*/
         L     @07,TIMELEFT                                        1199
         SH    @07,@CH02863                                        1199
         ST    @07,TIMELEFT                                        1199
*       W=TIMELEFT/1461;            /* DIVIDE TOTAL DAYS SINCE EPOCH
*                                      BY NUMBER OF DAYS IN A LEAP 1200
*                                      YEAR GROUP. THE RESULT, W,  1200
*                                      WILL BE THE RELATIVE LEAP YEAR
*                                      GROUP SINCE THE EPOCH.  Y01980*/
         LA    @15,1461                                            1200
         LR    @14,@07                                             1200
         ST    @15,@TF00001                                        1200
         SRDA  @14,32                                              1200
         D     @14,@TF00001                                        1200
         LR    W,@15                                               1200
*       R4=TIMELEFT//1461;          /* CALCULATE TOTAL DAYS ELAPSED
*                                      IN CURRENT LEAP YEAR GROUP  1201
*                                                              Y01980*/
         LR    @14,@07                                             1201
         SRDA  @14,32                                              1201
         D     @14,@TF00001                                        1201
         LR    R4,@14                                              1201
*       DAYREG=((R4+R4/731+R4/1096)//366)+1;/* CALC JULIAN DAY Y01980*/
         LR    @15,R4                                              1202
         SLR   @14,@14                                             1202
         D     @14,@CF02871                                        1202
         LR    @14,@15                                             1202
         ALR   @14,R4                                              1202
         LR    @15,R4                                              1202
         ST    @14,@TF00001                                        1202
         SLR   @14,@14                                             1202
         D     @14,@CF02872                                        1202
         LR    @14,@15                                             1202
         AL    @14,@TF00001                                        1202
         SRDA  @14,32                                              1202
         D     @14,@CF02873                                        1202
         AL    @14,@CF00063                                        1202
         LR    DAYREG,@14                                          1202
*       YEARREG=1904+(W*4)+(R4-1)/365;/* CALCULATE CURRENT YEAR    1203
*                                                              Y01980*/
         LR    YEARREG,W                                           1203
         SLA   YEARREG,2                                           1203
         AH    YEARREG,@CH02874                                    1203
         LR    @14,R4                                              1203
         BCTR  @14,0                                               1203
         SRDA  @14,32                                              1203
         D     @14,@CF02866                                        1203
         ALR   YEARREG,@15                                         1203
*     END LEAPYR;                   /*                       @YL02014*/
*                                                                  1204
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @YL02014*/
*   /* CONVERT THE DAY TO EBCDIC IN THE OUTPUT AREA          @YL02014*/
*   /*                                                       @YL02014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1205
*   PARMREG2=ADDR(TIMEAREA(5));     /* GET ADDR OF OUTPUT LOCATION IN
*                                      WHICH CONVERTED DAY IS TO BE
*                                      PLACED                  Y01980*/
@RC01193 L     PARMREG2,OUTAREA(,PARMREG1)                         1205
         LA    PARMREG2,TIMEAREA+4(,PARMREG2)                      1205
*   GEN(CVD DAYREG,CVRTAREA);       /* CONVERT DAY TO DECIMAL  Y01980*/
         CVD DAYREG,CVRTAREA
*   GEN(UNPK 0(3,PARMREG2),CVRTAREA+6(2));/* UNPACK DAY        Y01980*/
         UNPK 0(3,PARMREG2),CVRTAREA+6(2)
*   GEN(OI 2(PARMREG2),X'F0');      /* CHANG SIGN TO A NUMERIC ZONE
*                                                              Y01980*/
*                                                                  1208
         OI 2(PARMREG2),X'F0'
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @YL02014*/
*   /* CONVERT THE YEAR TO EBCDIC IN THE OUTPUT AREA         @YL02014*/
*   /*                                                       @YL02014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1209
*   PARMREG2=ADDR(TIMEAREA(1));     /* GET ADDR OF OUTPUT LOCATION IN
*                                      WHICH CONVERTED YEAR IS TO BE
*                                      PLACED                  Y01980*/
         L     PARMREG2,OUTAREA(,PARMREG1)                         1209
*   GEN(CVD YEARREG,CVRTAREA);      /* CONVERT YEAR TO DECIMAL Y01980*/
         CVD YEARREG,CVRTAREA
*   GEN(UNPK 0(4,PARMREG2),CVRTAREA+5(3));/* UNPACK YEAR       Y01980*/
         UNPK 0(4,PARMREG2),CVRTAREA+5(3)
*   GEN(OI 3(PARMREG2),X'F0');      /* CHANGE SIGN TO A NUMERIC ZONE */
*                                                                  1212
         OI 3(PARMREG2),X'F0'
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @YL02014*/
*   /* RETURN TO TODCNVRT CALLER                             @YL02014*/
*   /*                                                       @YL02014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1213
*   RETURN CODE(0);                 /* INDICATE TOD VALUE WAS CNVRTED
*                                                              Y01980*/
         SLR   @15,@15                                             1213
         L     @14,@SA00012                                        1213
         LM    @00,@12,@SA00012+8                                  1213
         BR    @14                                                 1213
*   RFY                                                            1214
*    (PARMREG1,                                                    1214
*     PARMREG2,                                                    1214
*     W,                                                           1214
*     R4,                                                          1214
*     DAYREG,                                                      1214
*     YEARREG) UNRSTD;                                             1214
*   END IGCTOD;                     /*                       @YL02014*/
*HDRPATH:                                                          1216
*   PROC;                           /*                       @YL02014*/
*                                                                  1216
HDRPATH  STM   @14,@12,@SA00013                                    1216
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @YL02014*/
*   /* HDRPATH IS A PRELUDE TO PRINTING THIS USR RECORD      @YL02014*/
*   /* USR HEX RECORDS HAVE A HEADER                         @YL02014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1217
*   RFY                                                            1217
*    (PARMRG0,                                                     1217
*     PARMRG1) RSTD;                                               1217
*   HEADWRIT='1'B;                  /* INDICATE HEADER ALREADY     1218
*                                      WRITTEN                       */
         OI    HEADWRIT,B'00010000'                                1218
*   OUTBUFF=' ';                    /* BLANK BUFFER          @YM07560*/
         L     @15,ABDPLPTR                                        1219
         L     @14,ADPLBUF(,@15)                                   1219
         MVI   OUTBUFF+1(@14),C' '                                 1219
         MVC   OUTBUFF+2(119,@14),OUTBUFF+1(@14)                   1219
         MVI   OUTBUFF(@14),C' '                                   1219
*   HDRFID=RCDFID;                  /* SET PRINTABLE HEX FID IN DATA
*                                      FOR HEADER            @YL02014*/
         L     @14,CURREC                                          1220
         MVC   HDRFID(1),RCDFID(@14)                               1220
*   TEMPID1=USREID;                 /* SET EID INTO 5-BYTE AREA      */
         L     @14,FMTEID                                          1221
         MVC   TEMPID1(2),USREID(@14)                              1221
*   UNPK(TEMPID,TEMPID2);           /* UNPACK EID            @YL02014*/
         UNPK  TEMPID(5),TEMPID2(3)                                1222
*   HDRID=TEMPID3;                  /* MOVE TO 3-BYTE AREA TO CLEAR
*                                      OFF HIGH BYTE OF CLASS E AND
*                                      LOW BYTE OF GARBAGE   @YL02014*/
         MVC   HDRID(3),TEMPID3                                    1223
*   TR(HDRID,DEFTABLE);             /* TRANSLATE APPROPRIATE UNPACKED
*                                      BYTES                 @YL02014*/
         TR    HDRID(3),DEFTABLE                                   1224
*   HDRASCB=USRASCB;                /* MOVE TO HEADER INFO   @YL02014*/
         MVC   HDRASCB(4),USRASCB(@14)                             1225
*   HDRJOBN=USRJOBN;                /* GET JOBNAME FROM RECORD     1226
*                                                            @YL02014*/
         MVC   HDRJOBN(8),USRJOBN(@14)                             1226
*   ADPLFMT2=ADDR(USRHDRI);         /* SET UP ADDR OF REENT HDR INFO
*                                      FOR FORMAT RTN        @YL02014*/
         LA    @14,USRHDRI                                         1227
         ST    @14,ADPLFMT2(,@15)                                  1227
*   PARMRG0=ADDR(USRHDRFP);         /* ADDR FORMAT PATTERN   @YL02014*/
         LA    PARMRG0,USRHDRFP                                    1228
*   PARMRG1=ABDPLPTR;               /* ADDR SNAPS PARM LIST  @YL02014*/
         LR    PARMRG1,@15                                         1229
*   CALL FRMTLINE;                  /* CALL TO FORMAT ROUTINE TO   1230
*                                      FORMAT USR HEADER     @YL02014*/
         L     @15,ADPLFRMT(,@15)                                  1230
         BALR  @14,@15                                             1230
*   PARMRG1=ABDPLPTR;               /*                       @YL02014*/
         L     @15,ABDPLPTR                                        1231
         LR    PARMRG1,@15                                         1231
*   CALL PRNTLINE;                  /* CALL TO PRINT HEADER  @YL02014*/
         L     @15,ADPLPRNT(,@15)                                  1232
         BALR  @14,@15                                             1232
*   RFY                                                            1233
*    (PARMRG0,                                                     1233
*     PARMRG1) UNRSTD;                                             1233
*   END HDRPATH;                    /*                       @YL02014*/
@EL00013 DS    0H                                                  1234
@EF00013 DS    0H                                                  1234
@ER00013 LM    @14,@12,@SA00013                                    1234
         BR    @14                                                 1234
*   DECLARE                         /* GENERAL PURPOSE REGISTERS     */
*     GPR00F FIXED(31) REG(0),                                     1235
*     GPR01F FIXED(31) REG(1),                                     1235
*     GPR15F FIXED(31) REG(15),                                    1235
*     GPR00P PTR(31) REG(0),                                       1235
*     GPR01P PTR(31) REG(1),                                       1235
*     GPR14P PTR(31) REG(14),                                      1235
*     GPR15P PTR(31) REG(15);                                      1235
*   DCL                                                            1236
*     1 I004 DEF(ILIST) BDY(WORD),  /* LIST FOR GETMAIN              */
*      2 I00401 PTR(31),            /* LENGTH                        */
*      2 I00402 CHAR(1),            /* HIARCHY                       */
*      2 I00403 PTR(24),            /* ADDR OF ADDR LIST             */
*      2 I00404 CHAR(1),            /* TYPE OF REQUEST               */
*      2 I00405 PTR(8);             /* SUBPOOL VALUE                 */
*   DECLARE                                                        1237
*     ILIST CHAR(10) BDY(DWORD);    /* STANDARD LIST                 */
*   DECLARE                         /* COMMON VARIABLES              */
*     I256C CHAR(256) BASED,                                       1238
*     I031F FIXED(31) BASED,                                       1238
*     I031P PTR(31) BASED,                                         1238
*     I015F FIXED(15) BASED,                                       1238
*     I015P PTR(15) BASED,                                         1238
*     I008P PTR(8) BASED,                                          1238
*     I001C CHAR(1) BASED;                                         1238
*                                                                  1238
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                       @YL02014*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1239
*   END IGC0F05A                    /*                       @YL02014*/
*                                                                  1239
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (CVT     )                                       */
*/*%INCLUDE SYSLIB  (IKJTCB  )                                       */
*/*%INCLUDE SYSLIB  (IHAASVT )                                       */
*/*%INCLUDE SYSLIB  (IHAASCB )                                       */
*/*%INCLUDE SYSLIB  (IHAWSAVT)                                       */
*/*%INCLUDE SYSLIB  (IHAPSA  )                                       */
*/*%INCLUDE SYSLIB  (IHASDWA )                                       */
*/*%INCLUDE SYSLIB  (IHAABDPL)                                       */
*/*%INCLUDE SYSLIB  (AMDPRTAB)                                       */
*/*%INCLUDE SYSLIB  (GTFPCT  )                                       */
*/*%INCLUDE SYSLIB  (IHASRB  )                                       */
*/*%INCLUDE SYSLIB  (MCCE    )                                       */
*/*%INCLUDE SYSLIB  (MCQE    )                                       */
*/*%INCLUDE SYSLIB  (MCHEAD  )                                       */
*/*%INCLUDE SYSUT5  (SETUP   )                                       */
*/*%INCLUDE SYSUT5  (SETUP   )                                       */
*                                                                  1239
*       ;                                                          1239
@DATA    DS    0H
@CH00039 DC    H'0'
@CH00075 DC    H'2'
@CH00745 DC    H'5'
@CH01274 DC    H'6'
@CH00912 DC    H'7'
@CH00034 DC    H'8'
@CH02011 DC    H'9'
@CH02522 DC    H'18'
@CH02547 DC    H'26'
@CH02469 DC    H'58'
@CH02860 DC    H'60'
@CH02486 DC    H'121'
@CH00686 DC    H'256'
@CH02787 DC    H'257'
@CH02321 DC    H'285'
@CH02863 DC    H'1460'
@CH02867 DC    H'1900'
@CH02874 DC    H'1904'
@CH02312 DC    H'4096'
@CH02892 DC    H'4097'
@SM02910 MVC   OUTMSG+17(0,@15),0(@06)
@SM02913 MVC   TEMPIBUF+256(0),RECORD+256(@14)
@SM02915 MVC   TEMPIBUF(0),RECORD(@14)
@SM02922 MVC   OUTEBCDC(0),RCDDATA(@07)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@SA00011 DS    15F
@SA00002 DS    15F
@SA00003 DS    15F
@SA00009 DS    15F
@SA00013 DS    15F
@SA00007 DS    15F
@SA00004 DS    15F
@SA00005 DS    15F
@SA00006 DS    15F
@SA00008 DS    15F
@SA00012 DS    15F
@SA00010 DS    15F
@TF00001 DS    F
IGC0F05A CSECT
         DS    0F
@CF00063 DC    F'1'
@CH00063 EQU   @CF00063+2
@CF00294 DC    F'3'
@CH00294 EQU   @CF00294+2
@CF00056 DC    F'4'
@CH00056 EQU   @CF00056+2
@CF00033 DC    F'12'
@CH00033 EQU   @CF00033+2
@CF00072 DC    F'24'
@CH00072 EQU   @CF00072+2
@CF02891 DC    F'84'
@CF02866 DC    F'365'
@CF02873 DC    F'366'
@CF02888 DC    F'530'
@CF02871 DC    F'731'
@CF02872 DC    F'1096'
@CF02859 DC    F'1440'
@CF02887 DC    F'64000'
@CF02857 DC    F'1000000'
@CF02763 DC    XL4'40000004'
@CF02778 DC    XL4'7FFFFFFF'
@CF02789 DC    XL4'80000000'
@DATD    DSECT
         DS    0D
TCBPTR   DS    A
ASCBPTR  DS    A
SDWAPTR  DS    A
ABDPLPTR DS    A
PCTPTR   DS    A
SRBPTR   DS    A
RDRBUFLN DS    F
READBUFF DS    A
TIMEADJ  DS    A
DPLASCB  DS    A
RCODE    DS    F
WRKLEVNT DS    F
READECB  DS    AL4
         ORG   READECB
@NM00111 DS    FL3
READRC   DS    FL1
         ORG   READECB+4
I        DS    F
J        DS    F
SYSINDEX DS    F
USRINDEX DS    F
NUMCON   DS    F
NUMPART  DS    F
NUMPRINT DS    F
FIDPTR   DS    A
FIDI     DS    A
SAVECODE DS    F
ESTAEPTR DS    A
USRSAVE  DS    A
USROUT   DS    A
TCBGTFOM DS    F
TIMELEFT DS    F
ADDRSRB  DS    A
PARMPTR  DS    A
MSGIND   DS    H
@TS00001 DS    CL1
         DS    CL5
AMDPRTAB DS    CL530
         ORG   AMDPRTAB
AFMG     DS    AL4
CURREC   DS    AL4
DEBGFLGS DS    BL12
         ORG   DEBGFLGS
PTHFLGS1 DS    BL1
         ORG   PTHFLGS1
ROOT     DS    BL1
SCN      EQU   PTHFLGS1+0
GET      EQU   PTHFLGS1+0
CON      EQU   PTHFLGS1+0
HEX      EQU   PTHFLGS1+0
FLT      EQU   PTHFLGS1+0
FRM      EQU   PTHFLGS1+0
REXT     EQU   PTHFLGS1+0
         ORG   DEBGFLGS+1
PTHFLGS2 DS    BL1
         ORG   PTHFLGS2
APP      DS    BL1
REMAIN   EQU   PTHFLGS2+0
         ORG   DEBGFLGS+2
INRFCFGS DS    BL1
         ORG   INRFCFGS
FLMODE   DS    BL1
TERM     EQU   INRFCFGS+0
SPIE     EQU   INRFCFGS+0
FMT      EQU   INRFCFGS+0
RET      EQU   INRFCFGS+0
EXTTRC   EQU   INRFCFGS+0
EDITSTOP EQU   INRFCFGS+0
DMDFMT   EQU   INRFCFGS+0
         ORG   DEBGFLGS+3
IOFLGS   DS    BL1
         ORG   IOFLGS
GETEOF   DS    BL1
B        EQU   IOFLGS+0
         ORG   DEBGFLGS+4
C        DS    BL8
         ORG   AMDPRTAB+20
GTFWDPTR DS    AL4
USEREXIT DS    CL8
DDNAME   DS    CL8
STARTIME DS    CL12
         ORG   STARTIME
TIME     DS    CL8
D        DS    CL2
DAY      DS    CL2
         ORG   AMDPRTAB+52
STOPTIME DS    CL12
         ORG   STOPTIME
TIME2    DS    CL8
F        DS    CL2
DAY2     DS    CL2
         ORG   AMDPRTAB+64
NAMES    DS    CL40
         ORG   NAMES
JOBNAMES DS    5CL8
         ORG   AMDPRTAB+104
ADS      DS    BL20
         ORG   ADS
AADS     DS    CL4
         ORG   AADS+0
ASCBADDR DS    AL4
         ORG   AMDPRTAB+124
SIF      DS    BL4
         ORG   SIF
SIOFLGS  DS    BL1
         ORG   SIOFLGS
ALLS     DS    BL1
SELS     EQU   SIOFLGS+0
EQUIV    EQU   SIOFLGS+0
NOEQU    EQU   SIOFLGS+0
H        EQU   SIOFLGS+0
         ORG   SIF+1
II       DS    BL3
         ORG   AMDPRTAB+128
DVADS1   DS    CL100
         ORG   DVADS1
SIODVADS DS    50CL2
         ORG   AMDPRTAB+228
IO       DS    BL4
         ORG   IO
IOFLGS2  DS    BL1
         ORG   IOFLGS2
ALLI     DS    BL1
SELI     EQU   IOFLGS2+0
JJ       EQU   IOFLGS2+0
         ORG   IO+1
K01RES   DS    BL3
         ORG   AMDPRTAB+232
DVADS2   DS    CL100
         ORG   DVADS2
IODVADS  DS    50CL2
         ORG   AMDPRTAB+332
VCF      DS    BL4
         ORG   VCF
SVCFLGS  DS    BL1
         ORG   SVCFLGS
ALLV     DS    BL1
SELV     EQU   SVCFLGS+0
L        EQU   SVCFLGS+0
         ORG   VCF+1
M        DS    BL3
         ORG   AMDPRTAB+336
SVCNUMS  DS    BL32
USR      DS    BL4
         ORG   USR
USRFLGS  DS    BL1
         ORG   USRFLGS
ALLU     DS    BL1
SELU     EQU   USRFLGS+0
N01R     EQU   USRFLGS+0
         ORG   USR+1
O        DS    BL3
         ORG   AMDPRTAB+372
USRTAB   DS    CL80
         ORG   USRTAB
USRNGTAB DS    20CL4
         ORG   AMDPRTAB+452
PI       DS    BL4
         ORG   PI
PIFLGS   DS    BL1
         ORG   PIFLGS
ALLP     DS    BL1
SELP     EQU   PIFLGS+0
P01R     EQU   PIFLGS+0
         ORG   PI+1
Q        DS    BL3
         ORG   AMDPRTAB+456
PGMNGEN  DS    BL4
         ORG   PGMNGEN
PICODES  DS    BL2
PICODEA  DS    BL1
GENFLAGS DS    BL1
         ORG   GENFLAGS
EXT      DS    BL1
DSP      EQU   GENFLAGS+0
SYS      EQU   GENFLAGS+0
SYSM     EQU   GENFLAGS+0
RNIO     EQU   GENFLAGS+0
SRM      EQU   GENFLAGS+0
RR       EQU   GENFLAGS+0
EOF      EQU   GENFLAGS+0
         ORG   AMDPRTAB+460
GENFLGS1 DS    BL1
         ORG   GENFLGS1
TS       DS    BL1
EOFINPRO EQU   GENFLGS1+0
TSFOUND  EQU   GENFLGS1+0
FIRSTHSW EQU   GENFLGS1+0
@NM00081 EQU   GENFLGS1+0
         ORG   AMDPRTAB+461
RECDLL   DS    FL3
EXITNM   DS    CL8
EXITADDR DS    AL4
AEIOCT   DS    AL4
PRFMTADD DS    AL4
REENTWKA DS    AL4
AFRMAD   DS    AL4
OFSTEID  DS    FL2
OFSTDATA DS    FL2
ADTSBUF  DS    AL4
ESTARTME DS    CL9
         ORG   ESTARTME
ESDAY    DS    CL3
ESHR     DS    CL2
ESMIN    DS    CL2
ESSEC    DS    CL2
         ORG   AMDPRTAB+509
ESTOPTME DS    CL9
         ORG   ESTOPTME
ESPDAY   DS    CL3
ESPHR    DS    CL2
ESPMIN   DS    CL2
ESPSEC   DS    CL2
         ORG   AMDPRTAB+518
CVTTZONE DS    CL4
RESERVED DS    CL8
         ORG   AMDPRTAB+530
         DS    CL2
AUDIT    DS    CL4
         ORG   AUDIT
AUDITING DS    FL2
         ORG   AUDITING
ADTNGENT DS    BL1
ADTNGCTL EQU   AUDITING+0
ADTNGBUF EQU   AUDITING+0
ADTNGREC EQU   AUDITING+0
ADTNGUSR EQU   AUDITING+0
ADTNGHEX EQU   AUDITING+0
ADTNGSYS EQU   AUDITING+0
ADTNGRES EQU   AUDITING+0
         ORG   AUDIT+2
AUDITED  DS    FL2
         ORG   AUDITED
ADTEDINT DS    BL1
ADTEDCTL EQU   AUDITED+0
ADTEDBUF EQU   AUDITED+0
ADTEDREC EQU   AUDITED+0
ADTEDUSR EQU   AUDITED+0
ADTEDHEX EQU   AUDITED+0
ADTEDSYS EQU   AUDITED+0
ADTEDTOD EQU   AUDITED+0
ADTEDCVT DS    BL1
ADTEDXIT EQU   AUDITED+1
ADTEDERR EQU   AUDITED+1
ADTEDFMT EQU   AUDITED+1
         ORG   AUDIT+4
FMTPARM  DS    CL32
         ORG   FMTPARM
FMTINPUT DS    AL4
FMTOUTPT DS    AL4
FMTGTF   DS    AL4
FMTEID   DS    AL4
FMTDATA  DS    AL4
FMTRTNAD DS    AL4
FMTWORK  DS    AL4
FMTSNAP  DS    AL4
         ORG   FMTPARM+32
INFO     DS    CL4
         ORG   INFO
@NM00096 DS    FL1
         ORG   @NM00096
FIRSTSW  DS    BL1
ERRBIT   EQU   @NM00096+0
EOFIND   EQU   @NM00096+0
HEADWRIT EQU   @NM00096+0
@NM00097 EQU   @NM00096+0
         ORG   INFO+1
@NM00098 DS    FL1
LLEFT    DS    FL2
         ORG   INFO+4
PRTABMVC DS    CL16
         ORG   PRTABMVC
PRTABAD  DS    AL4
PRTABLN  DS    FL4
PRTABZIP DS    FL4
@NM00099 DS    CL4
         ORG   @NM00099
PRTABPAD DS    FL1
PRTABZLN DS    FL3
         ORG   PRTABMVC+16
TODPARM  DS    CL12
         ORG   TODPARM
ADRCVTTZ DS    AL4
ADRTOD   DS    AL4
ADRTMOUT DS    AL4
         ORG   TODPARM+12
CNVRTDTM DS    CL24
         ORG   CNVRTDTM
YEAR     DS    CL4
DAYYR    DS    CL3
TOD      DS    CL15
         ORG   CNVRTDTM+24
UNPKAREA DS    CL8
         ORG   UNPKAREA
@NM00106 DS    CL2
UNPKARA2 DS    CL6
         ORG   UNPKAREA+8
LSTEVNT  DS    CL10
FOXGTF   DS    CL4
         ORG   FOXGTF
@NM00107 DS    CL3
@NM00108 DS    FL1
         ORG   @NM00108
@NM00109 DS    BL1
FOXTIME  EQU   @NM00108+0
         ORG   FOXGTF+4
         DS    CL2
BLDLLIST DS    CL178
         ORG   BLDLLIST
FF       DS    FL2
LL       DS    FL2
EPNENTRY DS    CL58
         ORG   EPNENTRY+0
EPN      DS    CL8
         ORG   EPN+0
@NM00112 DS    CL6
EPNFID   DS    CL2
         ORG   EPNENTRY+8
TT       DS    CL2
R        DS    CL1
K        DS    CL1
         ORG   BLDLLIST+178
TEMPIBUF DS    CL284
TEMPOBUF DS    CL121
USRHDRI  DS    CL16
         ORG   USRHDRI
HDRFID   DS    CL1
HDRID    DS    CL3
HDRASCB  DS    CL4
HDRJOBN  DS    CL8
         ORG   USRHDRI+16
         DS    CL1
TEMPFID2 DS    CL3
         ORG   TEMPFID2
TEMPFID1 DS    FL2
         ORG   TEMPFID2+3
TEMPFID  DS    CL3
TEMPID2  DS    CL3
         ORG   TEMPID2
TEMPID1  DS    CL2
         ORG   TEMPID2+3
TEMPID   DS    CL5
         ORG   TEMPID
@NM00114 DS    CL1
TEMPID3  DS    CL3
         ORG   TEMPID+5
HXSYSDTA DS    CL4
         ORG   HXSYSDTA
HXSYSAID DS    CL1
HXSYSFID DS    CL1
HXSYSEID DS    CL2
         ORG   HXSYSDTA+4
OUTEBCDC DS    CL24
         DS    CL2
BYTEDTA0 DS    CL3
         ORG   BYTEDTA0
BYTEDTA  DS    FL2
         ORG   BYTEDTA0+3
BYTEDTA1 DS    CL3
         ORG   BYTEDTA1
BYTEDTA2 DS    CL2
         ORG   BYTEDTA1+3
         DS    CL2
TEMPOFF  DS    CL3
         ORG   TEMPOFF
OFFSET   DS    FL2
         ORG   TEMPOFF+3
TEMPOFF1 DS    CL5
         ORG   TEMPOFF1
TEMPOFF2 DS    CL4
         ORG   TEMPOFF1+5
UNPKDTA  DS    CL5
         ORG   UNPKDTA
UNPKDATA DS    CL4
         ORG   UNPKDTA+5
UNPKDTA1 DS    CL9
         ORG   UNPKDTA1
UNPKDTA2 DS    CL8
         ORG   UNPKDTA1+9
FIDEPN   DS    CL8
         ORG   FIDEPN
@NM00123 DS    CL6
FIDHEX   DS    CL2
         ORG   FIDEPN+8
PGMCKDTA DS    CL19
         ORG   PGMCKDTA
PGMCKPSW DS    CL8
PGMCKMOD DS    CL8
PGMCKADR DS    CL3
         ORG   PGMCKDTA+19
         DS    CL3
LOCREGS  DS    CL64
EPLD     DS    CL8
ESLIST   DS    CL16
         ORG   ESLIST
ESFLAG1  DS    AL1
ESEXIT   DS    AL3
ESPLIST  DS    AL4
ESTCB    DS    AL4
ESFLAG2  DS    AL1
ESREV    DS    AL3
         ORG   ESLIST+16
CVRTAREA DS    CL8
         ORG   CVRTAREA
TODWORD1 DS    FL4
TODWORD2 DS    FL4
         ORG   CVRTAREA+8
ILIST    DS    CL10
         DS    CL2
ESTAESAV DS    CL72
SAVEREGS DS    CL64
WORKAREA DS    CL200
FOXFID   DS    256CL2
SYSTAB   DS    BL1
         ORG   SYSTAB+0
SYSHXBIT DS    BL1
SYSNOUSE EQU   SYSTAB+0
SYSLOAD  EQU   SYSTAB+0
SYSLOADA EQU   SYSTAB+0
SYSLOADH EQU   SYSTAB+0
SYSLOADI EQU   SYSTAB+0
         ORG   SYSTAB+256
USRTABL  DS    BL1
         ORG   USRTABL+0
USRHXBIT DS    BL1
USRNOUSE EQU   USRTABL+0
USRLOAD  EQU   USRTABL+0
USRAHI   EQU   USRTABL+0
         ORG   USRAHI+0
USRLOADA EQU   USRAHI+0
USRLOADH EQU   USRAHI+0
USRLOADI EQU   USRAHI+0
         ORG   USRTABL+256
USRADDR  DS    256A
SYSADDR  DS    256A
OUTEBYTE DS    24CL1
IGC0F05A CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
TSDATAOF DC    F'16'
TSEIDOF  DC    F'14'
DATAOF   DC    F'8'
EIDOF    DC    F'6'
LEFID    DC    XL4'02'
TSFID    DC    XL4'01'
SIXTYMIL DC    F'60000000'
TRCMASK  DC    XL2'0FFF'
SYSCLS   DC    XL1'FF'
@CC02804 DC    C'HEXFORMAT'
@CC02660 DC    C'IGC0F05A'
@CC02773 DC    C'GTF     '
@CC02786 DC    C'HEXFORMT'
@CC02587 DC    C'AMDUSR'
@CC02588 DC    C'HMDUSR'
@CC02589 DC    C'IMDUSR'
@CC02801 DC    C'AMDSYS'
TMSTPLBL DC    CL27'YEAR*** DATE     DAYTIME***'
LEVNTLBL DC    CL22'*** LOST EVENTSTIME***'
TRBUFLBL DC    CL48'*** ONE 4096 BYTE TRACE BUFFER LOST      TIME***'
USRHDRLB DC    CL11'USRASCBJOBN'
DEFTABLE DS    CL256
         ORG   DEFTABLE
@NM00113 DS    CL240
TRTABLE  DC    X'F0F1F2F3F4F5F6F7F8F9C1C2C3C4C5C6'
         ORG   DEFTABLE+256
HXSYSLBL DC    CL18'SYSTEM   AIDFIDEID'
TIMELBL  DC    CL4'TIME'
MESSAGE  DS    CL726
         ORG   MESSAGE
IGC931   DC    CL121'IEA931I  ESTAE REQUEST FOR GTF TRACE FORMATTING FUC
               NCTION UNSUCCESSFUL'
IGC932   DC    CL121'IEA932I  INSUFFICIENT STORAGE FOR GTF BUFFER FORMAC
               TTING'
IGC809   DC    CL121'IEA809I  ERROR IN BUFFER. REMAINDER OF BUFFER IGNOC
               RED'
IGC933   DC    CL121'IEA933I  UNABLE TO LOAD FORMAT APPENDAGE xxxxxxxx.C
                FURTHER RCDS REQUIRING THIS MOD WILL BE DUMPED IN HEX'
IGC934   DC    CL121'IEA934I  INVALID RETURN CODE RECEIVED FROM xxxxxxxC
               x. FURTHER RCDS REQUIRING THIS MOD WILL BE DUMPED IN HEXC
               '
IGC025   DC    CL121'IEA025I  INVALID GTF RECORD FOLLOWS'
         ORG   MESSAGE+726
PGMCKLBL DC    CL43'PGM CHECK OLD PSW.  ENTRY POINT OF MODULEIS'
REGLBL   DC    CL15'RG0/RG7RG8/RG15'
SETRPARM DS    CL24
         ORG   SETRPARM
SETMOD   DC    CL8'IGC0F05A'
SETCSECT DC    CL8'IGC0F05A'
SETFRRID DC    CL8'IGCESTAE'
         ORG   SETRPARM+24
ZEROTOD  DC    X'0000000000000000'
ZEROTIME DC    CL12'00000.000000'
NULLTIME DC    CL22'000000000.00.00.000000'
USRMASK  DC    XL4'F3'
         DC    XL4'EB'
         DC    XL4'E7'
USRT     DS    CL7
         ORG   USRT+0
USRI     DC    X'10'
USREPN   DC    CL6'AMDUSR'
         ORG   USRT+7
         ORG   USRT+7
         DC    X'08'
         DC    CL6'HMDUSR'
         ORG   USRT+14
         ORG   USRT+14
         DC    X'04'
         DC    CL6'IMDUSR'
         ORG   USRT+21
         DS    CL3
TODBRTAB DC    AL4(FULLDATE)
         DC    AL4(RELTVTME)
IGC0F05A CSECT
*                                                          /*@YL02014*/
TMSTMPFP DS 0F
    FMTPTRN (LBL,LBLP,DTA,DTAE,DTAC),4,4,25,30,TMSTPLBL
    FMTPTRN (LBL,DTA,DTAE,DTAC),16,3,0,17
    FMTPTRN (LBL,DTA,DTAE,DTAC),4,15,39,44
    FMTPTRN (LBL),3,,117,,,,LAST
IGC0F05A CSECT
*                                                         /*@YL02014*/
LEVNTFP DS 0F
    FMTPTRN (LBL,LBLP),15,,0,,LEVNTLBL
    FMTPTRN (LBL,DTA,DTAE,DTAC),4,15,29,34
    FMTPTRN (LBL),3,,117,,,,LAST
DTAE     EQU   32
DTAC     EQU   16
DTAP     EQU   8
DTA      EQU   4
LBLP     EQU   2
LBL      EQU   1
IGC0F05A CSECT
*                                                          /*@YL02014*/
TRBUFFP DS 0F
    FMTPTRN (LBL,LBLP),16,,0,,TRBUFLBL
    FMTPTRN (LBL),16,,16
    FMTPTRN (LBL,DTA,DTAE,DTAC),13,15,32,46
    FMTPTRN (LBL),3,,117,,,,LAST
IGC0F05A CSECT
*                                                          /*@YL02014*/
USRHDRFP DS 0F
       FMTPTRN (LBL,LBLP,DTA,DTAC),3,1,0,3,USRHDRLB
       FMTPTRN (DTA,DTAE,DTAC),,3,,8
       FMTPTRN (LBL,DTA,DTAC),4,4,13,18
       FMTPTRN (LBL,DTA,DTAE,DTAC),4,8,28,33,,,LAST
IGC0F05A CSECT
*                                                          /*@YL02014*/
HXSYSFP DS 0F
    FMTPTRN (LBL,LBLP,DTA,DTAC),12,1,0,13,HXSYSLBL
    FMTPTRN (LBL,DTA,DTAC),3,1,17,21
    FMTPTRN (LBL,DTA,DTAC),3,2,25,29,,,LAST
IGC0F05A CSECT
*                                                          /*@YL02014*/
TIMEFP DS 0F
    FMTPTRN (LBL,LBLP,DTA,DTAE,DTAC),4,12,7,12,TIMELBL,,LAST
IGC0F05A CSECT
*                                                          /*@YL02014*/
PGMCKFP DS 0F
    FMTPTRN (LBL,LBLP),16,,0,,PGMCKLBL
    FMTPTRN (LBL,DTA,DTAC),1,4,16,18
    FMTPTRN (DTA,DTAC),,4,,27
    FMTPTRN (LBL),16,,35
    FMTPTRN (LBL,DTA,DTAE,DTAC),8,8,51,60
    FMTPTRN (LBL,DTA,DTAC),2,3,69,72,,,LAST
IGC0F05A CSECT
*                                                  /*@YL02014*/
REGFP1 DS 0F
    FMTPTRN (LBL,LBLP,DTA,DTAC),7,4,0,9,REGLBL
    FMTPTRN (DTA,DTAC),,4,,18
    FMTPTRN (DTA,DTAC),,4,,27
    FMTPTRN (DTA,DTAC),,4,,36
    FMTPTRN (DTA,DTAC),,4,,45
    FMTPTRN (DTA,DTAC),,4,,54
    FMTPTRN (DTA,DTAC),,4,,63
    FMTPTRN (DTA,DTAC),,4,,72,,,LAST
REGFP2 DS 0F
    FMTPTRN (LBL,DTA,DTAC),8,4,0,9
    FMTPTRN (DTA,DTAC),,4,,18
    FMTPTRN (DTA,DTAC),,4,,27
    FMTPTRN (DTA,DTAC),,4,,36
    FMTPTRN (DTA,DTAC),,4,,45
    FMTPTRN (DTA,DTAC),,4,,54
    FMTPTRN (DTA,DTAC),,4,,63
    FMTPTRN (DTA,DTAC),,4,,72,,,LAST
IGC0F05A CSECT
*                                                         /*@YL02014*/
EBCDICFP DS 0F
    FMTPTRN (DTA,DTAC,DTAE),,16,,95
    FMTPTRN (DTA,DTAC,DTAE),,8,,111,,,LAST
IGC0F05A CSECT
         DS   0H
IGCPATCH DC ((@DATA-@PSTART)/20)X'00'
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
IGC0F05A CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
AEDITCBR EQU   @09
GENREG   EQU   @03
ESTAEREG EQU   @04
ADDRDTA1 EQU   @08
ADDRDTA2 EQU   @10
RETCODE  EQU   @15
PARMRG0  EQU   @00
PARMRG1  EQU   @01
PARMRG2  EQU   @02
PARMRG9  EQU   @09
R15      EQU   @15
ESTACODE EQU   @00
RETRTM   EQU   @14
SAVE14   EQU   @07
GPR01P   EQU   @01
GPR00P   EQU   @00
GPR14P   EQU   @14
GPR15P   EQU   @15
GPR01F   EQU   @01
GPR15F   EQU   @15
GPR00F   EQU   @00
AHLSRB   EQU   @01
AHLRC    EQU   @15
PARMREG1 EQU   @01
PARMREG2 EQU   @02
R4       EQU   @04
W        EQU   @05
DAYREG   EQU   @03
YEARREG  EQU   @06
R2       EQU   @02
R4MOVE   EQU   @04
R5       EQU   @05
CVTPTR   EQU   16
PSA      EQU   0
FLCRNPSW EQU   PSA
FLCROPSW EQU   PSA+8
FLCICCW2 EQU   PSA+16
PSAEEPSW EQU   PSA+132
PSAESPSW EQU   PSA+136
FLCSVILC EQU   PSAESPSW+1
PSAEPPSW EQU   PSA+140
FLCPIILC EQU   PSAEPPSW+1
FLCPICOD EQU   PSAEPPSW+2
PSAPICOD EQU   FLCPICOD+1
FLCTEA   EQU   PSAEPPSW+4
FLCPER   EQU   PSA+152
FLCMCLA  EQU   PSA+168
FLCIOEL  EQU   FLCMCLA+4
FLCIOA   EQU   FLCMCLA+16
FLCFSA   EQU   FLCMCLA+80
PSATOLD  EQU   PSA+540
PSAAOLD  EQU   PSA+548
PSASUPER EQU   PSA+552
PSASUP1  EQU   PSASUPER
PSASUP2  EQU   PSASUPER+1
PSASUP3  EQU   PSASUPER+2
PSASUP4  EQU   PSASUPER+3
PSACLHT  EQU   PSA+640
PSALKSA  EQU   PSA+696
PSAHLHI  EQU   PSA+760
PSADSSFL EQU   PSA+836
PSADSSF1 EQU   PSADSSFL
PSADSSF3 EQU   PSADSSFL+2
PSADSSF4 EQU   PSADSSFL+3
PSARSVT  EQU   PSA+896
CVTMAP   EQU   0
CVTDAR   EQU   CVTMAP+72
CVTFLGS1 EQU   CVTDAR
CVTDCB   EQU   CVTMAP+116
CVTIOQET EQU   CVTMAP+120
CVTIERLC EQU   CVTMAP+144
CVTHEAD  EQU   CVTMAP+160
CVTSV76C EQU   CVTHEAD
CVTOPTA  EQU   CVTMAP+182
CVTOPTB  EQU   CVTMAP+183
CVTGTF   EQU   CVTMAP+236
CVTGTFST EQU   CVTGTF
CVTGTFS  EQU   CVTGTFST
CVTSTATE EQU   CVTGTFST
CVTTMODE EQU   CVTGTFST
CVTFORM  EQU   CVTGTFST
CVTGTFA  EQU   CVTGTF+1
CVTAQAVT EQU   CVTMAP+240
CVTTCMFG EQU   CVTAQAVT
CVTVOLM2 EQU   CVTMAP+244
CVTTATA  EQU   CVTVOLM2
CVTTSKS  EQU   CVTTATA
CVTVOLF2 EQU   CVTTSKS
CVTTAT   EQU   CVTTATA+1
CVTATER  EQU   CVTMAP+248
CVTEXT1  EQU   CVTMAP+252
CVTPURG  EQU   CVTMAP+260
CVTQMSG  EQU   CVTMAP+268
CVTDMSR  EQU   CVTMAP+272
CVTRSV37 EQU   CVTDMSR
CVTDMSRF EQU   CVTRSV37
CVTERPV  EQU   CVTMAP+316
CVTINTLA EQU   CVTMAP+320
CVTAPF   EQU   CVTMAP+324
CVTEXT2  EQU   CVTMAP+328
CVTHJES  EQU   CVTMAP+332
CVTPGSIA EQU   CVTMAP+348
CVTA1F1  EQU   CVTMAP+356
CVTSYSK  EQU   CVTMAP+357
CVTVOLM1 EQU   CVTMAP+380
CVTVOLF1 EQU   CVTVOLM1
CVTATMCT EQU   CVTMAP+388
CVTXTNT1 EQU   0
CVTXTNT2 EQU   0
CVTDSSV  EQU   CVTXTNT2
CVTFLGBT EQU   CVTXTNT2+5
CVTQID   EQU   CVTXTNT2+24
CVTRV400 EQU   CVTXTNT2+52
CVTRV409 EQU   CVTXTNT2+53
CVTATCVT EQU   CVTXTNT2+64
CVTRV429 EQU   CVTXTNT2+84
CVTRV438 EQU   CVTXTNT2+85
CVTRV457 EQU   CVTXTNT2+112
CVTRV466 EQU   CVTXTNT2+113
CVTFIX   EQU   0
CVTRELNO EQU   CVTFIX+252
TCBFIX   EQU   0
TCBFRS   EQU   TCBFIX
TCB      EQU   0
TCBPIE   EQU   TCB+4
TCBPMASK EQU   TCBPIE
TCBCMP   EQU   TCB+16
TCBCMPF  EQU   TCBCMP
TCBCPP   EQU   TCBCMPF
TCBSTCC  EQU   TCBCMPF
TCBCDBL  EQU   TCBCMPF
TCBCWTO  EQU   TCBCMPF
TCBCIND  EQU   TCBCMPF
TCBCMSG  EQU   TCBCMPF
TCBTRN   EQU   TCB+20
TCBABF   EQU   TCBTRN
TCBMSS   EQU   TCB+24
TCBPKF   EQU   TCB+28
TCBFLGS  EQU   TCB+29
TCBFLGS1 EQU   TCBFLGS
TCBFLGS2 EQU   TCBFLGS+1
TCBFLGS3 EQU   TCBFLGS+2
TCBFLGS4 EQU   TCBFLGS+3
TCBFLGS5 EQU   TCBFLGS+4
TCBABWF  EQU   TCBFLGS5
TCBJPQ   EQU   TCB+44
TCBPURGE EQU   TCBJPQ
TCBGRS   EQU   TCB+48
TCBFSA   EQU   TCB+112
TCBTME   EQU   TCB+120
TCBJSTCB EQU   TCB+124
TCBTSFLG EQU   TCB+148
TCBTSTSK EQU   TCBTSFLG
TCBSTAB  EQU   TCB+160
TCBNSTAE EQU   TCBSTAB
TCBTCT   EQU   TCB+164
TCBTCTGF EQU   TCBTCT
TCBSCNDY EQU   TCB+172
TCBNDSP  EQU   TCBSCNDY
TCBNDSP1 EQU   TCBNDSP+1
TCBNDSP2 EQU   TCBNDSP+2
TCBNDSP3 EQU   TCBNDSP+3
TCBJSCB  EQU   TCB+180
TCBRECDE EQU   TCBJSCB
TCBEXT1  EQU   TCB+196
TCBBITS  EQU   TCB+200
TCBNDSP4 EQU   TCBBITS
TCBNDSP5 EQU   TCBBITS+1
TCBFLGS6 EQU   TCBBITS+2
TCBFLGS7 EQU   TCBBITS+3
TCBGTOFM EQU   TCBFLGS7
TCBDAR   EQU   TCB+204
TCBDARC  EQU   TCBDAR
TCBEXT2  EQU   TCB+208
TCBFOE   EQU   TCB+244
TCBESTAE EQU   TCB+264
TCBESTRM EQU   TCBESTAE+1
TCBFBYT1 EQU   TCB+276
TCBFBYT2 EQU   TCB+277
TCBRV124 EQU   TCB+278
TCBRV133 EQU   TCB+279
TCBXTNT2 EQU   0
TCBGTF   EQU   TCBXTNT2
TCBTFLG  EQU   TCBGTF
TCBRV146 EQU   TCBXTNT2+28
TCBRV155 EQU   TCBXTNT2+29
TCBRV164 EQU   TCBXTNT2+30
TCBRV173 EQU   TCBXTNT2+31
ASVT     EQU   0
ASVTFRST EQU   ASVT+524
ASVTENTY EQU   ASVT+528
ASCB     EQU   0
ASCBASID EQU   ASCB+36
ASCBFW1  EQU   ASCB+100
ASCBRCTF EQU   ASCBFW1+2
ASCBFLG1 EQU   ASCBFW1+3
ASCBDSP1 EQU   ASCB+114
ASCBFLG2 EQU   ASCB+115
WSAG     EQU   0
SDWA     EQU   0
SDWAFIOB EQU   SDWA+4
SDWAABCC EQU   SDWAFIOB
SDWACMPF EQU   SDWAABCC
SDWAREQ  EQU   SDWACMPF
SDWACTL1 EQU   SDWA+8
SDWACMKA EQU   SDWACTL1
SDWAMWPA EQU   SDWACTL1+1
SDWAPMKA EQU   SDWACTL1+4
SDWACTL2 EQU   SDWA+16
SDWACMKP EQU   SDWACTL2
SDWAMWPP EQU   SDWACTL2+1
SDWAPMKP EQU   SDWACTL2+4
SDWAGRSV EQU   SDWA+24
SDWANAME EQU   SDWA+88
SDWAEC1  EQU   SDWA+104
SDWAEMK1 EQU   SDWAEC1
SDWAMWP1 EQU   SDWAEC1+1
SDWAINT1 EQU   SDWAEC1+2
SDWANXT1 EQU   SDWAEC1+4
SDWAAEC1 EQU   SDWA+112
SDWAILC1 EQU   SDWAAEC1+1
SDWAINC1 EQU   SDWAAEC1+2
SDWAICD1 EQU   SDWAINC1+1
SDWAEC2  EQU   SDWA+120
SDWAEMK2 EQU   SDWAEC2
SDWAMWP2 EQU   SDWAEC2+1
SDWAINT2 EQU   SDWAEC2+2
SDWANXT2 EQU   SDWAEC2+4
SDWAAEC2 EQU   SDWA+128
SDWAILC2 EQU   SDWAAEC2+1
SDWAINC2 EQU   SDWAAEC2+2
SDWAICD2 EQU   SDWAINC2+1
SDWASRSV EQU   SDWA+136
SDWAIDNT EQU   SDWA+200
SDWAMCH  EQU   SDWA+204
SDWASTCK EQU   SDWAMCH
SDWAMCHI EQU   SDWAMCH+8
SDWAMCHS EQU   SDWAMCHI
SDWAMCHD EQU   SDWAMCHI+1
SDWAREGU EQU   SDWAMCHD
SDWAPSWU EQU   SDWAMCHD
SDWAINSF EQU   SDWAMCHD
SDWARSR1 EQU   SDWAMCH+12
SDWARSR2 EQU   SDWAMCH+13
SDWAFLGS EQU   SDWA+232
SDWAERRA EQU   SDWAFLGS
SDWAMCHK EQU   SDWAERRA
SDWAERRB EQU   SDWAFLGS+1
SDWAERRC EQU   SDWAFLGS+2
SDWAERRD EQU   SDWAFLGS+3
SDWAIOFS EQU   SDWA+238
SDWARTYA EQU   SDWA+240
SDWACPUA EQU   SDWA+248
SDWAPARQ EQU   SDWA+252
SDWARCDE EQU   SDWAPARQ
SDWAACF2 EQU   SDWAPARQ+1
SDWARCRD EQU   SDWAACF2
SDWAUPRG EQU   SDWAACF2
SDWAFREE EQU   SDWAACF2
SDWAACF3 EQU   SDWAPARQ+2
SDWAACF4 EQU   SDWAPARQ+3
SDWALKWA EQU   SDWA+256
SDWALKWS EQU   SDWALKWA
SDWARECP EQU   SDWA+292
SDWASNPA EQU   SDWA+320
SDWADUMP EQU   SDWASNPA
SDWADPFS EQU   SDWADUMP+1
SDWADDAT EQU   SDWASNPA+4
SDWASDAT EQU   SDWADDAT
SDWAPDAT EQU   SDWADDAT+2
SDWADPSA EQU   SDWA+328
SDWADPSL EQU   SDWADPSA
SDWARA   EQU   SDWA+400
SDWADPVA EQU   SDWARA+2
ABDPL    EQU   0
ADPLTCB  EQU   ABDPL
ADPLASID EQU   ABDPL+4
ADPLFLAG EQU   ABDPL+7
ADPLBUF  EQU   ABDPL+8
ADPLPRNT EQU   ABDPL+12
ADPLFRMT EQU   ABDPL+24
ADPLFMT2 EQU   ABDPL+48
GTFPCT   EQU   0
GTFSTAT  EQU   GTFPCT+8
GTFOPTS  EQU   GTFPCT+12
GTFOPTS1 EQU   GTFOPTS
GTFOPTS2 EQU   GTFOPTS+1
GTFOPTS3 EQU   GTFOPTS+2
GTFOPTS4 EQU   GTFOPTS+3
PCTCATF  EQU   GTFPCT+16
NEXTBLOK EQU   GTFPCT+180
WRTRCOM  EQU   GTFPCT+204
TRMWRIT  EQU   GTFPCT+212
WRTRERR  EQU   GTFPCT+216
GTFSSRB  EQU   GTFPCT+220
QLOCKWRD EQU   GTFPCT+236
QLOCKECB EQU   GTFPCT+240
AUDITFLG EQU   GTFPCT+296
SRBSECT  EQU   0
SRB      EQU   SRBSECT
SRBFLNK  EQU   SRB+4
SRBASCB  EQU   SRB+8
SRBFLC   EQU   SRB+12
SRBPASID EQU   SRBFLC+2
SRBPTCB  EQU   SRBFLC+4
SRBEP    EQU   SRB+20
SRBRMTR  EQU   SRB+24
SRBPARM  EQU   SRB+28
MCCE     EQU   0
MCQE     EQU   0
MCQEFLGS EQU   MCQE+41
MCHEAD   EQU   0
MCHFLGS  EQU   MCHEAD+24
MCHFLG1  EQU   MCHFLGS
MCHEADRD EQU   MCHEAD+44
MCHEADTR EQU   MCHEAD+48
PRNTLINE EQU   0
FRMTLINE EQU   0
FRMTAPP  EQU   0
TIMESTMP EQU   0
TSTZONE  EQU   TIMESTMP+6
TSTSTMP  EQU   TIMESTMP+10
TSGTFOPT EQU   TIMESTMP+18
@NM00101 EQU   TSGTFOPT+3
TSGTFYES EQU   @NM00101
RECORD   EQU   0
RCDLL    EQU   RECORD
RCDAID   EQU   RECORD+4
RCDFID   EQU   RECORD+5
RCDTIME  EQU   RECORD+6
TRCREC   EQU   0
TRCEID   EQU   TRCREC
TRCCLS   EQU   TRCEID
TRCASCB  EQU   TRCREC+2
OUTBUFFR EQU   0
RDBUFBLL EQU   OUTBUFFR
OUTREC   EQU   0
RDBUFLLL EQU   OUTREC
LERCD    EQU   0
LECOUNT  EQU   LERCD+18
ZEROOUT  EQU   0
USRRCD   EQU   0
USREID   EQU   USRRCD
USRASCB  EQU   USRRCD+2
USRJOBN  EQU   USRRCD+6
RCDDATA  EQU   0
OUTBUFF  EQU   0
OUTOFFST EQU   OUTBUFF+35
OUTDATA  EQU   OUTBUFF+40
OUTWORD  EQU   OUTDATA
AST1     EQU   OUTBUFF+94
AST2     EQU   OUTBUFF+119
@NM00119 EQU   0
OUTBYTE  EQU   @NM00119+40
FIDTAB   EQU   0
FIDLOAD  EQU   FIDTAB
FIDAHI   EQU   FIDTAB
OUTMSG   EQU   0
ESTAPARM EQU   0
ESTADTA1 EQU   ESTAPARM
ESTADTA2 EQU   ESTAPARM+4
MCHKRTRY EQU   0
EPARM    EQU   0
USRSAVER EQU   0
USROUTER EQU   0
I256C    EQU   0
AHLRDAT  EQU   0
@NM00126 EQU   AHLRDAT
AHLRDGM  EQU   @NM00126
AHLRDPTR EQU   AHLRDAT+12
AHLRDSQA EQU   0
AHLRDPL  EQU   AHLRDSQA+44
AHLRDID  EQU   AHLRDPL+4
AHLRDDID EQU   AHLRDPL+14
AHLRDASI EQU   AHLRDDID
AHLRDTCB EQU   AHLRDDID+2
AHLRDECB EQU   AHLRDPL+20
AHLRDATA EQU   AHLRDPL+24
AHLRDASC EQU   AHLRDPL+28
AHLRDSRB EQU   AHLRDPL+36
INPUTLST EQU   0
CVTTZPTR EQU   INPUTLST
TODPTR   EQU   INPUTLST+4
OUTAREA  EQU   INPUTLST+8
CVTTZVAL EQU   0
TODVALUE EQU   0
TIMEAREA EQU   0
TIMEERIA EQU   0
SECONDS  EQU   0
FOXEID   EQU   0
I001C    EQU   0
I008P    EQU   0
I015F    EQU   0
I015P    EQU   0
I031F    EQU   0
I031P    EQU   0
RTN      EQU   0
CVTS01   EQU   CVTPGSIA
CVTLPDIA EQU   CVTS01+12
CVTDIRST EQU   CVTLPDIA
CVTSLIDA EQU   CVTS01+24
CVTCTLFG EQU   CVTS01+50
CVTASVT  EQU   CVTS01+208
CVTLSMQ  EQU   CVTS01+268
CVTSPSA  EQU   CVTS01+336
CVTRV210 EQU   CVTS01+424
CVTRV219 EQU   CVTS01+425
CVTRV228 EQU   CVTS01+426
CVTRV237 EQU   CVTS01+427
CVTMFRTR EQU   CVTS01+452
CVTRV262 EQU   CVTS01+468
CVTRV271 EQU   CVTS01+469
CVTRV280 EQU   CVTS01+470
CVTRV289 EQU   CVTS01+471
CVTGSDA  EQU   CVTS01+600
ASVTPTR  EQU   CVTASVT
PSARSVTE EQU   PSARSVT
ZEROCNVT EQU   CNVRTDTM
ZEROSYS  EQU   SYSTAB
ZEROUSR  EQU   USRTABL
ZEROBLDL EQU   BLDLLIST
LOADNAME EQU   IGC933+41
RCNAME   EQU   IGC934+43
ZEROIBUF EQU   TEMPIBUF
MSGTAB   EQU   MESSAGE
@NM00124 EQU   EXITADDR
EPA      EQU   @NM00124+1
I004     EQU   ILIST
I00401   EQU   I004
I00403   EQU   I004+5
I00404   EQU   I004+8
I00405   EQU   I004+9
AHLRDG   EQU   AHLRDGM
AHLRDG01 EQU   AHLRDG
AHLRDG03 EQU   AHLRDG+5
AHLRDG04 EQU   AHLRDG+8
AHLRDG05 EQU   AHLRDG+9
FLC      EQU   PSA
*                                      START UNREFERENCED COMPONENTS
AHLRDG02 EQU   AHLRDG+4
I00402   EQU   I004+4
@NM00125 EQU   @NM00124
PSARSAV  EQU   PSARSVTE+60
PSARSTK  EQU   PSARSVTE+56
PSAESAV3 EQU   PSARSVTE+52
PSAESTK3 EQU   PSARSVTE+48
PSAESAV2 EQU   PSARSVTE+44
PSAESTK2 EQU   PSARSVTE+40
PSAESAV1 EQU   PSARSVTE+36
PSAESTK1 EQU   PSARSVTE+32
PSAPSAV  EQU   PSARSVTE+28
PSAPSTK  EQU   PSARSVTE+24
PSAMSAV  EQU   PSARSVTE+20
PSAMSTK  EQU   PSARSVTE+16
PSASSAV  EQU   PSARSVTE+12
PSASSTK  EQU   PSARSVTE+8
PSANSTK  EQU   PSARSVTE+4
PSACSTK  EQU   PSARSVTE
CVTRV628 EQU   CVTS01+728
CVTRV627 EQU   CVTS01+724
CVTRV626 EQU   CVTS01+720
CVTRV625 EQU   CVTS01+716
CVTRV624 EQU   CVTS01+712
CVTRV623 EQU   CVTS01+708
CVTRV622 EQU   CVTS01+704
CVTRV621 EQU   CVTS01+700
CVTIHASU EQU   CVTS01+696
CVTRV619 EQU   CVTS01+692
CVTRV618 EQU   CVTS01+688
CVTRV617 EQU   CVTS01+684
CVTRV616 EQU   CVTS01+680
CVTRV615 EQU   CVTS01+676
CVTRV614 EQU   CVTS01+672
CVTRV613 EQU   CVTS01+668
CVTTCASP EQU   CVTS01+664
CVT0PT03 EQU   CVTS01+660
CVT0PT0E EQU   CVTS01+656
CVTRV609 EQU   CVTS01+652
CVTCGK   EQU   CVTS01+648
CVTRAC   EQU   CVTS01+644
CVTHSM   EQU   CVTS01+640
CVTRV605 EQU   CVTS01+636
CVTRV604 EQU   CVTS01+632
CVTEFF02 EQU   CVTS01+628
CVTCBBR  EQU   CVTS01+624
CVTSSCR  EQU   CVTS01+620
CVTEVENT EQU   CVTS01+616
CVTCRCA  EQU   CVTS01+612
CVTTPIO  EQU   CVTS01+608
CVTADV   EQU   CVTS01+604
CVTGSDAB EQU   CVTGSDA
CVTQV3   EQU   CVTS01+596
CVTQV2   EQU   CVTS01+592
CVTQV1   EQU   CVTS01+588
CVTRPT   EQU   CVTS01+584
CVTSSRB  EQU   CVTS01+580
CVTCSDRL EQU   CVTS01+576
CVTEXP1  EQU   CVTS01+572
CVTRMPMT EQU   CVTS01+568
CVTRMPTT EQU   CVTS01+564
CVTVPSA  EQU   CVTS01+560
CVTVSTOP EQU   CVTS01+556
CVTGTFR8 EQU   CVTS01+552
CVTQUIT  EQU   CVTS01+548
CVTVACR  EQU   CVTS01+544
CVTWTCB  EQU   CVTS01+540
CVTSTPRS EQU   CVTS01+536
CVT0PT02 EQU   CVTS01+532
CVTDARCM EQU   CVTS01+528
CVTIRECM EQU   CVTS01+524
CVTJRECM EQU   CVTS01+520
CVTVEMS0 EQU   CVTS01+516
CVTSPFRR EQU   CVTS01+512
CVTRLSTG EQU   CVTS01+508
CVT0TC0A EQU   CVTS01+504
CVTGMBR  EQU   CVTS01+500
CVTLFRM  EQU   CVTS01+496
CVTRMBR  EQU   CVTS01+492
CVTVIOP  EQU   CVTS01+488
CVTRV307 EQU   CVTS01+486
CVTRV306 EQU   CVTS01+484
CVTRV305 EQU   CVTS01+482
CVTRV304 EQU   CVTS01+480
CVTRV303 EQU   CVTS01+478
CVTRV302 EQU   CVTS01+476
CVTTRCA  EQU   CVTS01+472
CVTRV297 EQU   CVTRV289
CVTRV296 EQU   CVTRV289
CVTRV295 EQU   CVTRV289
CVTRV294 EQU   CVTRV289
CVTRV293 EQU   CVTRV289
CVTRV292 EQU   CVTRV289
CVTRV291 EQU   CVTRV289
CVTRV290 EQU   CVTRV289
CVTRV288 EQU   CVTRV280
CVTRV287 EQU   CVTRV280
CVTRV286 EQU   CVTRV280
CVTRV285 EQU   CVTRV280
CVTRV284 EQU   CVTRV280
CVTRV283 EQU   CVTRV280
CVTRV282 EQU   CVTRV280
CVTRV281 EQU   CVTRV280
CVTRV279 EQU   CVTRV271
CVTRV278 EQU   CVTRV271
CVTRV277 EQU   CVTRV271
CVTRV276 EQU   CVTRV271
CVTRV275 EQU   CVTRV271
CVTRV274 EQU   CVTRV271
CVTRV273 EQU   CVTRV271
CVTRV272 EQU   CVTRV271
CVTRV270 EQU   CVTRV262
CVTRV269 EQU   CVTRV262
CVTRV268 EQU   CVTRV262
CVTRV267 EQU   CVTRV262
CVTRV266 EQU   CVTRV262
CVTRV265 EQU   CVTRV262
CVTRV264 EQU   CVTRV262
CVTRV263 EQU   CVTRV262
CVTVFP   EQU   CVTS01+464
CVTVSI   EQU   CVTS01+460
CVTVPSIB EQU   CVTS01+456
CVTMFACT EQU   CVTMFRTR
CVTMFCTL EQU   CVTS01+448
CVTPVBP  EQU   CVTS01+444
CVTPWI   EQU   CVTS01+440
CVTRV254 EQU   CVTS01+438
CVTRV253 EQU   CVTS01+436
CVTRV252 EQU   CVTS01+434
CVTRV251 EQU   CVTS01+433
CVTRV250 EQU   CVTS01+432
CVTRV249 EQU   CVTS01+431
CVTRV248 EQU   CVTS01+430
CVTRV247 EQU   CVTS01+429
CVTRV246 EQU   CVTS01+428
CVTRV245 EQU   CVTRV237
CVTRV244 EQU   CVTRV237
CVTRV243 EQU   CVTRV237
CVTRV242 EQU   CVTRV237
CVTRV241 EQU   CVTRV237
CVTRV240 EQU   CVTRV237
CVTRV239 EQU   CVTRV237
CVTRV238 EQU   CVTRV237
CVTRV236 EQU   CVTRV228
CVTRV235 EQU   CVTRV228
CVTRV234 EQU   CVTRV228
CVTRV233 EQU   CVTRV228
CVTRV232 EQU   CVTRV228
CVTRV231 EQU   CVTRV228
CVTRV230 EQU   CVTRV228
CVTRV229 EQU   CVTRV228
CVTRV227 EQU   CVTRV219
CVTRV226 EQU   CVTRV219
CVTRV225 EQU   CVTRV219
CVTRV224 EQU   CVTRV219
CVTRV223 EQU   CVTRV219
CVTRV222 EQU   CVTRV219
CVTRV221 EQU   CVTRV219
CVTRV220 EQU   CVTRV219
CVTRV218 EQU   CVTRV210
CVTRV217 EQU   CVTRV210
CVTRV216 EQU   CVTRV210
CVTRV215 EQU   CVTRV210
CVTRV214 EQU   CVTRV210
CVTRV213 EQU   CVTRV210
CVTRV212 EQU   CVTRV210
CVTRV211 EQU   CVTRV210
CVTLCCAT EQU   CVTS01+420
CVTPCCAT EQU   CVTS01+416
CVTIPCRP EQU   CVTS01+412
CVTIPCRI EQU   CVTS01+408
CVTIPCDS EQU   CVTS01+404
CVTAIDVT EQU   CVTS01+400
CVTSSAP  EQU   CVTS01+396
CVTEHCIR EQU   CVTS01+392
CVTEHDEF EQU   CVTS01+388
CVTDAIR  EQU   CVTS01+384
CVTPERFM EQU   CVTS01+380
CVT044R2 EQU   CVTS01+376
CVTFETCH EQU   CVTS01+372
CVTRSTWD EQU   CVTS01+368
CVTSPOST EQU   CVTS01+364
CVTIOBP  EQU   CVTS01+360
CVTASMVT EQU   CVTS01+356
CVTRECRQ EQU   CVTS01+352
CVTWSAC  EQU   CVTS01+348
CVTRV149 EQU   CVTS01+344
CVTWSAL  EQU   CVTS01+340
CVTGLMN  EQU   CVTS01+332
CVTVEAC0 EQU   CVTS01+328
CVT062R1 EQU   CVTS01+324
CVTRPOST EQU   CVTS01+320
CVTDQIQE EQU   CVTS01+316
CVTCSD   EQU   CVTS01+312
CVTLKRMA EQU   CVTS01+308
CVTRSPIE EQU   CVTS01+304
CVTRENQ  EQU   CVTS01+300
CVTLQCB  EQU   CVTS01+296
CVTFQCB  EQU   CVTS01+292
CVTQCS01 EQU   CVTS01+288
CVTAPFT  EQU   CVTS01+284
CVTPARRL EQU   CVTS01+280
CVTVWAIT EQU   CVTS01+276
CVTGSPL  EQU   CVTS01+272
CVTGSMQ  EQU   CVTS01+264
CVTEXPRO EQU   CVTS01+260
CVTOPCTP EQU   CVTS01+256
CVTSIC   EQU   CVTS01+252
CVTTPIOS EQU   CVTS01+248
CVTRTMS  EQU   CVTS01+244
CVTSDBF  EQU   CVTS01+240
CVTSCBP  EQU   CVTS01+236
CVTSDMP  EQU   CVTS01+232
CVTSV60  EQU   CVTS01+228
CVTRTMCT EQU   CVTS01+224
CVTASCBL EQU   CVTS01+220
CVTASCBH EQU   CVTS01+216
CVTGDA   EQU   CVTS01+212
CVTVVMDI EQU   CVTS01+204
CVTAQTOP EQU   CVTS01+200
CVTIOSCS EQU   CVTS01+196
CVTSDRM  EQU   CVTS01+192
CVTOPTE  EQU   CVTS01+188
CVTSTXU  EQU   CVTS01+184
CVTQUIS  EQU   CVTS01+180
CVTPARS  EQU   CVTS01+176
CVTS1EE  EQU   CVTS01+172
CVTFRAS  EQU   CVTS01+168
CVTQSAS  EQU   CVTS01+164
CVTCRAS  EQU   CVTS01+160
CVTCRMN  EQU   CVTS01+156
CVTDELCP EQU   CVTS01+152
CVTFRECL EQU   CVTS01+148
CVTGETCL EQU   CVTS01+144
CVTBLDCP EQU   CVTS01+140
CVTAUTHL EQU   CVTS01+136
CVTSCAN  EQU   CVTS01+132
CVTRV144 EQU   CVTS01+130
CVTMAXMP EQU   CVTS01+128
CVTSTCK  EQU   CVTS01+124
CVTRV139 EQU   CVTS01+123
CVTDSSAC EQU   CVTS01+122
CVTRV513 EQU   CVTS01+121
CVTIOSPL EQU   CVTS01+120
CVTPTGT  EQU   CVTS01+116
CVTCSPIE EQU   CVTS01+112
CVTSMFEX EQU   CVTS01+108
CVTOLT0A EQU   CVTS01+104
CVTSRBRT EQU   CVTS01+100
CVTPUTL  EQU   CVTS01+96
CVTASCRL EQU   CVTS01+92
CVTASCRF EQU   CVTS01+88
CVTRV326 EQU   CVTS01+84
CVTRV325 EQU   CVTS01+80
CVTRV324 EQU   CVTS01+76
CVT0VL01 EQU   CVTS01+72
CVTSHRVM EQU   CVTS01+68
CVTRV332 EQU   CVTS01+64
CVTTAS   EQU   CVTS01+60
CVTRSCN  EQU   CVTS01+56
CVTTRAC2 EQU   CVTS01+54
CVTTRACE EQU   CVTS01+52
CVTAPG   EQU   CVTS01+51
CVTSDTRC EQU   CVTCTLFG
CVTGTRCE EQU   CVTCTLFG
CVTNOMP  EQU   CVTCTLFG
CVTRSV79 EQU   CVTCTLFG
CVTDSTAT EQU   CVTCTLFG
CVTRSV78 EQU   CVTCTLFG
CVTRV333 EQU   CVTCTLFG
CVTRV323 EQU   CVTCTLFG
CVTSPVLK EQU   CVTS01+49
CVTRSV77 EQU   CVTS01+48
CVTRV331 EQU   CVTS01+44
CVTRV330 EQU   CVTS01+40
CVTRV329 EQU   CVTS01+36
CVTRV328 EQU   CVTS01+32
CVTRV322 EQU   CVTS01+28
CVTSLID  EQU   CVTSLIDA+1
CVTSYLK  EQU   CVTSLIDA
CVTRV321 EQU   CVTS01+20
CVTRV320 EQU   CVTS01+16
CVTLPDIR EQU   CVTLPDIA+1
CVTRSV69 EQU   CVTDIRST
CVTRSV68 EQU   CVTDIRST
CVTRSV67 EQU   CVTDIRST
CVTRSV66 EQU   CVTDIRST
CVTRSV65 EQU   CVTDIRST
CVTRSV64 EQU   CVTDIRST
CVTRSV63 EQU   CVTDIRST
CVTDICOM EQU   CVTDIRST
CVTPVTP  EQU   CVTS01+8
CVTLPDSR EQU   CVTS01+4
CVTGETL  EQU   CVTS01
AHLRDPX2 EQU   AHLRDPL+32
@NM00127 EQU   AHLRDPL+12
AHLRDPQC EQU   AHLRDPL
AHLSRBAS EQU   AHLRDSQA
FIDLOADI EQU   FIDAHI
FIDLOADH EQU   FIDAHI
FIDLOADA EQU   FIDAHI
@NM00122 EQU   FIDTAB
FIDHXBIT EQU   FIDTAB
@NM00121 EQU   @NM00119+94
@NM00120 EQU   @NM00119
@NM00118 EQU   OUTBUFF+95
@NM00117 EQU   OUTDATA+8
@NM00116 EQU   OUTBUFF+39
@NM00115 EQU   OUTBUFF
LETS     EQU   LERCD+10
@NM00110 EQU   LERCD+6
LEFID1   EQU   LERCD+5
LEAID    EQU   LERCD+4
LEBB     EQU   LERCD+2
LELL     EQU   LERCD
RDBUFFID EQU   OUTREC+5
RDBUFAID EQU   OUTREC+4
RDBUFBB  EQU   OUTREC+2
@NM00105 EQU   OUTBUFFR+2
TRCCPUID EQU   TRCREC+6
@NM00104 EQU   TRCEID+1
@NM00103 EQU   TRCEID
RCDBB    EQU   RECORD+2
@NM00102 EQU   @NM00101
@NM00100 EQU   TSGTFOPT
TSFFID   EQU   TIMESTMP+5
TSAID    EQU   TIMESTMP+4
TSRES    EQU   TIMESTMP+2
TSLEN    EQU   TIMESTMP
MCHFRRAD EQU   MCHEAD+40
MCHMCER  EQU   MCHEAD+36
MCHSETD  EQU   MCHEAD+32
MCHSETE  EQU   MCHEAD+28
@NM00095 EQU   MCHFLGS+1
@NM00094 EQU   MCHFLG1
MCHTERM  EQU   MCHFLG1
MCHACT   EQU   MCHFLG1
MCHDIS   EQU   MCHEAD+20
MCHCTL   EQU   MCHEAD+16
MCHCNT   EQU   MCHEAD+12
MCHCUR   EQU   MCHEAD+8
MCHIDEN  EQU   MCHEAD
MCQESRB  EQU   MCQE+44
@NM00093 EQU   MCQE+42
@NM00092 EQU   MCQEFLGS
MCQEACT  EQU   MCQEFLGS
MCQESCHE EQU   MCQE+40
MCQETECB EQU   MCQE+36
MCQEAT   EQU   MCQE+32
MCQEMCCL EQU   MCQE+28
MCQEMCEE EQU   MCQE+24
MCQEMCQE EQU   MCQE+20
MCQEASCB EQU   MCQE+16
MCQENAME EQU   MCQE+8
MCQEIDEN EQU   MCQE
MCCESRB  EQU   MCCE+44
MCCEECB  EQU   MCCE+40
MCCEMCCE EQU   MCCE+36
MCCECNT  EQU   MCCE+32
MCCEOMCQ EQU   MCCE+28
MCCEOCDA EQU   MCCE+24
MCCEOEDA EQU   MCCE+20
MCCEQEA  EQU   MCCE+16
MCCECDA  EQU   MCCE+12
MCCEEDA  EQU   MCCE+8
MCCEIDEN EQU   MCCE
@NM00091 EQU   SRB+40
@NM00090 EQU   SRB+38
SRBPRIOR EQU   SRB+37
SRBPKF   EQU   SRB+36
SRBSAVE  EQU   SRB+32
SRBCPAFF EQU   SRBFLC
SRBID    EQU   SRB
PCTWTOMD EQU   GTFPCT+312
PCTDMPMD EQU   GTFPCT+308
TRANSMAX EQU   GTFPCT+304
GTFASCB  EQU   GTFPCT+300
@NM00089 EQU   AUDITFLG+3
AFSLEBLD EQU   AUDITFLG+3
WSERFG06 EQU   AUDITFLG+3
WSERFG05 EQU   AUDITFLG+3
WSERFG04 EQU   AUDITFLG+3
WSERFG03 EQU   AUDITFLG+3
WSERFG02 EQU   AUDITFLG+2
WSERFLAG EQU   AUDITFLG+2
TERMFLAG EQU   AUDITFLG+2
AFXWRIT  EQU   AUDITFLG+2
AFQLWAIT EQU   AUDITFLG+2
AFSLEGET EQU   AUDITFLG+2
AFBUFGET EQU   AUDITFLG+2
AFFEOB   EQU   AUDITFLG+2
AFBLKFIX EQU   AUDITFLG+1
AFEQFIX  EQU   AUDITFLG+1
AFPGRLSE EQU   AUDITFLG+1
AFWRAP   EQU   AUDITFLG+1
AFBUFOFF EQU   AUDITFLG+1
AFLDFX   EQU   AUDITFLG+1
AFCLOSE  EQU   AUDITFLG+1
AFOPEN   EQU   AUDITFLG+1
AFGMBLOK EQU   AUDITFLG
AFGMSRB  EQU   AUDITFLG
AFWAIT   EQU   AUDITFLG
AFTERM   EQU   AUDITFLG
AFINIT   EQU   AUDITFLG
AFWWRIT  EQU   AUDITFLG
AFCWRIT  EQU   AUDITFLG
AFIWRIT  EQU   AUDITFLG
EQSHORT  EQU   GTFPCT+292
SLEMAX   EQU   GTFPCT+288
SLECNT   EQU   GTFPCT+284
RQPURGE  EQU   GTFPCT+280
RQTOTAL  EQU   GTFPCT+276
WRTDLST  EQU   GTFPCT+272
NUMOFBUF EQU   GTFPCT+268
SBUFDISA EQU   GTFPCT+264
SLESUSED EQU   GTFPCT+260
EQMIN    EQU   GTFPCT+256
EQLENGTH EQU   GTFPCT+252
WQMAX    EQU   GTFPCT+248
WQLENGTH EQU   GTFPCT+244
QLECBP   EQU   QLOCKECB
@NM00088 EQU   QLOCKECB
@NM00087 EQU   QLOCKWRD+3
SCHEDBUF EQU   QLOCKWRD+2
POSTWRIT EQU   QLOCKWRD+1
QLOCK    EQU   QLOCKWRD
WRITERDD EQU   GTFPCT+228
GTFLOSTR EQU   GTFPCT+224
SRBAVAIL EQU   GTFSSRB
WRTRERRP EQU   WRTRERR
@NM00086 EQU   WRTRERR
TRMWRITP EQU   TRMWRIT
@NM00085 EQU   TRMWRIT
GTFCMECB EQU   GTFPCT+208
WRTRCOMP EQU   WRTRCOM
@NM00084 EQU   WRTRCOM
TRANSCNT EQU   GTFPCT+200
AHLRDPLQ EQU   GTFPCT+196
SFEOBRTN EQU   GTFPCT+192
SBLOKRTN EQU   GTFPCT+188
CURRBLOK EQU   GTFPCT+184
GBCDS    EQU   NEXTBLOK
WSMODEND EQU   GTFPCT+176
WSMODBEG EQU   GTFPCT+172
BCBPAGE  EQU   GTFPCT+156
SLEPAGE  EQU   GTFPCT+152
SAVECNT  EQU   GTFPCT+148
SLQHEAD  EQU   GTFPCT+144
HQLENGTH EQU   GTFPCT+140
QTAIL    EQU   GTFPCT+136
HQHEAD   EQU   GTFPCT+132
WQHEAD   EQU   GTFPCT+128
RQHEAD   EQU   GTFPCT+124
EQHEAD   EQU   GTFPCT+120
WPOSTSRB EQU   GTFPCT+116
WTSKTCBA EQU   GTFPCT+112
WRTRTCBA EQU   GTFPCT+108
TRMWTASK EQU   GTFPCT+104
WTSKATTH EQU   GTFPCT+100
WTSKINIT EQU   GTFPCT+96
WTASKECB EQU   GTFPCT+92
WMTABPTR EQU   GTFPCT+88
ATTCHECB EQU   GTFPCT+84
AHLECB   EQU   GTFPCT+80
STOPECBA EQU   GTFPCT+76
ECBADRLT EQU   GTFPCT+72
FIXLEN   EQU   GTFPCT+68
FIXPTR   EQU   GTFPCT+64
INITPTR  EQU   GTFPCT+60
MCQEPTR  EQU   GTFPCT+56
GTFEIDL  EQU   GTFPCT+52
GTFPIBL  EQU   GTFPCT+48
GTFPIFT  EQU   GTFPCT+44
GTFSVCBL EQU   GTFPCT+40
GTFSVCFT EQU   GTFPCT+36
GTFIOBL  EQU   GTFPCT+32
GTFIOFT  EQU   GTFPCT+28
GTFSIOBL EQU   GTFPCT+24
GTFSIOFT EQU   GTFPCT+20
@NM00083 EQU   PCTCATF+1
PCTPIF   EQU   PCTCATF+1
PCTSIOF  EQU   PCTCATF+1
PCTIOF   EQU   PCTCATF+1
PCTSVCF  EQU   PCTCATF+1
PCTRR    EQU   PCTCATF+1
PCTSRM   EQU   PCTCATF+1
PCTRNIO  EQU   PCTCATF+1
PCTUSR   EQU   PCTCATF
PCTPI    EQU   PCTCATF
@NM00082 EQU   PCTCATF
PCTDSP   EQU   PCTCATF
PCTSIO   EQU   PCTCATF
PCTIO    EQU   PCTCATF
PCTEXT   EQU   PCTCATF
PCTSVC   EQU   PCTCATF
OPTTIME  EQU   GTFOPTS4
OPTRES3  EQU   GTFOPTS4
OPTIOSIO EQU   GTFOPTS3
OPTRES2  EQU   GTFOPTS3
OPTRR    EQU   GTFOPTS3
OPTSRM   EQU   GTFOPTS3
OPTRNIO  EQU   GTFOPTS3
OPTEXT   EQU   GTFOPTS3
OPTIOP   EQU   GTFOPTS2
OPTIO    EQU   GTFOPTS2
OPTPIP   EQU   GTFOPTS2
OPTPI    EQU   GTFOPTS2
OPTSIOP  EQU   GTFOPTS2
OPTSIO   EQU   GTFOPTS2
OPTSVCP  EQU   GTFOPTS2
OPTSVC   EQU   GTFOPTS2
OPTPCI   EQU   GTFOPTS1
OPTRES1  EQU   GTFOPTS1
OPTDSP   EQU   GTFOPTS1
OPTTRC   EQU   GTFOPTS1
OPTUSR   EQU   GTFOPTS1
OPTSYS   EQU   GTFOPTS1
OPTSYSP  EQU   GTFOPTS1
OPTSYSM  EQU   GTFOPTS1
GTFRESV  EQU   GTFSTAT
GTFDEBUG EQU   GTFSTAT
GTFMODE  EQU   GTFSTAT
GTFPCTID EQU   GTFPCT
ADPLEXT  EQU   ABDPL+52
ADPLFMT1 EQU   ABDPL+44
ADPLCOM4 EQU   ABDPL+40
ADPLCOM3 EQU   ABDPL+36
ADPLCOM2 EQU   ABDPL+32
ADPLCOM1 EQU   ABDPL+28
ADPLMEMA EQU   ABDPL+20
ADPLCVT  EQU   ABDPL+16
@NM00080 EQU   ADPLFLAG
ADPLSYTM EQU   ADPLFLAG
ADPLSNPR EQU   ADPLFLAG
ADPLSBPL EQU   ABDPL+6
@NM00079 EQU   SDWA+512
SDWAVRA  EQU   SDWARA+4
SDWAURAL EQU   SDWARA+3
@NM00078 EQU   SDWADPVA
SDWAEBC  EQU   SDWADPVA
SDWAHEX  EQU   SDWADPVA
SDWAVRAL EQU   SDWARA
@NM00077 EQU   SDWA+396
SDWACOMP EQU   SDWA+392
SDWARCPL EQU   SDWA+364
@NM00076 EQU   SDWADPSA+32
SDWATO4  EQU   SDWADPSL+28
SDWAFRM4 EQU   SDWADPSL+24
SDWATO3  EQU   SDWADPSL+20
SDWAFRM3 EQU   SDWADPSL+16
SDWATO2  EQU   SDWADPSL+12
SDWAFRM2 EQU   SDWADPSL+8
SDWATO1  EQU   SDWADPSL+4
SDWAFRM1 EQU   SDWADPSL
@NM00075 EQU   SDWADDAT+3
@NM00074 EQU   SDWAPDAT
SDWAUSPL EQU   SDWAPDAT
SDWADPSW EQU   SDWAPDAT
SDWATJPA EQU   SDWAPDAT
SDWATLPA EQU   SDWAPDAT
SDWADREG EQU   SDWAPDAT
SDWADSAH EQU   SDWAPDAT
SDWADSAS EQU   SDWAPDAT
@NM00073 EQU   SDWADDAT+1
@NM00072 EQU   SDWASDAT
SDWAQQS  EQU   SDWASDAT
SDWACBS  EQU   SDWASDAT
SDWAGTF  EQU   SDWASDAT
SDWASWA  EQU   SDWASDAT
SDWALSQA EQU   SDWASDAT
SDWASQA  EQU   SDWASDAT
SDWANUC  EQU   SDWASDAT
@NM00071 EQU   SDWADUMP+2
@NM00070 EQU   SDWADPFS
SDWASLST EQU   SDWADPFS
@NM00069 EQU   SDWADPFS
SDWADLST EQU   SDWADPFS
SDWADPT  EQU   SDWADPFS
SDWADPID EQU   SDWADUMP
SDWADPLA EQU   SDWA+316
SDWAREXN EQU   SDWARECP+16
SDWACSCT EQU   SDWARECP+8
SDWAMODN EQU   SDWARECP
@NM00068 EQU   SDWALKWA+32
SDWATALW EQU   SDWALKWS+28
SDWATDLW EQU   SDWALKWS+24
SDWATNLW EQU   SDWALKWS+20
SDWAAPLW EQU   SDWALKWS+16
SDWAIPLW EQU   SDWALKWS+12
SDWAILLW EQU   SDWALKWS+8
SDWAIULW EQU   SDWALKWS+4
SDWAICLW EQU   SDWALKWS
SDWAFLLK EQU   SDWAACF4
SDWACMS  EQU   SDWAACF4
SDWAOPTM EQU   SDWAACF4
SDWATADB EQU   SDWAACF4
SDWATDNB EQU   SDWAACF4
SDWATNCB EQU   SDWAACF4
SDWAILCH EQU   SDWAACF4
SDWAIUCB EQU   SDWAACF4
SDWAICAT EQU   SDWAACF3
SDWAIPRG EQU   SDWAACF3
SDWASALL EQU   SDWAACF3
SDWAASMP EQU   SDWAACF3
SDWADISP EQU   SDWAACF3
@NM00067 EQU   SDWAACF3
@NM00066 EQU   SDWAACF2
@NM00065 EQU   SDWAACF2
SDWASPIN EQU   SDWAACF2
@NM00064 EQU   SDWAACF2
SDWALCPU EQU   SDWACPUA+2
@NM00063 EQU   SDWACPUA
SDWARECA EQU   SDWA+244
@NM00062 EQU   SDWA+239
@NM00061 EQU   SDWAIOFS
SDWANIOP EQU   SDWAIOFS
SDWANOIO EQU   SDWAIOFS
SDWAIOHT EQU   SDWAIOFS
SDWAIOQR EQU   SDWAIOFS
SDWAFMID EQU   SDWA+236
@NM00060 EQU   SDWAERRD
SDWAMCIV EQU   SDWAERRD
SDWARPIV EQU   SDWAERRD
SDWAMABD EQU   SDWAERRD
SDWACTS  EQU   SDWAERRD
SDWASTAE EQU   SDWAERRD
SDWANRBE EQU   SDWAERRD
SDWACLUP EQU   SDWAERRD
@NM00059 EQU   SDWAERRC
SDWAEAS  EQU   SDWAERRC
SDWAPERC EQU   SDWAERRC
SDWAIRB  EQU   SDWAERRC
SDWASTAI EQU   SDWAERRC
SDWASTAF EQU   SDWAERRC
SDWASRBM EQU   SDWAERRB
SDWALDIS EQU   SDWAERRB
SDWAENRB EQU   SDWAERRB
SDWATYP1 EQU   SDWAERRB
@NM00058 EQU   SDWAERRB
SDWAPGIO EQU   SDWAERRA
SDWATEXC EQU   SDWAERRA
SDWASVCE EQU   SDWAERRA
SDWAABTM EQU   SDWAERRA
SDWASVCD EQU   SDWAERRA
SDWARKEY EQU   SDWAERRA
SDWAPCHK EQU   SDWAERRA
SDWATIME EQU   SDWAMCH+20
SDWARFSA EQU   SDWAMCH+16
@NM00057 EQU   SDWAMCH+14
SDWAVEQR EQU   SDWARSR2
SDWAPGFX EQU   SDWARSR2
SDWAFLSQ EQU   SDWARSR2
SDWAFSQA EQU   SDWARSR2
SDWANUCL EQU   SDWARSR2
SDWASPER EQU   SDWARSR2
SDWAINTC EQU   SDWARSR2
SDWAOFLN EQU   SDWARSR2
SDWACHNG EQU   SDWARSR1
SDWAMSER EQU   SDWARSR1
@NM00056 EQU   SDWARSR1
SDWACPID EQU   SDWAMCH+10
SDWATERR EQU   SDWAMCHD
SDWAFPRX EQU   SDWAMCHD
SDWAACR  EQU   SDWAMCHD
SDWASCK  EQU   SDWAMCHD
SDWASKYF EQU   SDWAMCHD
@NM00055 EQU   SDWAMCHS
SDWARSRF EQU   SDWAMCHS
SDWARSRC EQU   SDWAMCHS
SDWAINVP EQU   SDWAMCHS
SDWATSVL EQU   SDWAMCHS
SDWARCDF EQU   SDWAMCHS
SDWASRVL EQU   SDWAMCHS
SDWASCKE EQU   SDWASTCK+4
SDWASCKB EQU   SDWASTCK
SDWALNTH EQU   SDWAIDNT+1
SDWASPID EQU   SDWAIDNT
SDWASR15 EQU   SDWASRSV+60
SDWASR14 EQU   SDWASRSV+56
SDWASR13 EQU   SDWASRSV+52
SDWASR12 EQU   SDWASRSV+48
SDWASR11 EQU   SDWASRSV+44
SDWASR10 EQU   SDWASRSV+40
SDWASR09 EQU   SDWASRSV+36
SDWASR08 EQU   SDWASRSV+32
SDWASR07 EQU   SDWASRSV+28
SDWASR06 EQU   SDWASRSV+24
SDWASR05 EQU   SDWASRSV+20
SDWASR04 EQU   SDWASRSV+16
SDWASR03 EQU   SDWASRSV+12
SDWASR02 EQU   SDWASRSV+8
SDWASR01 EQU   SDWASRSV+4
SDWASR00 EQU   SDWASRSV
SDWATRN2 EQU   SDWAAEC2+4
SDWAIPC2 EQU   SDWAICD2
SDWAIMC2 EQU   SDWAICD2
SDWAIPR2 EQU   SDWAICD2
@NM00054 EQU   SDWAINC2
@NM00053 EQU   SDWAILC2
SDWAIL2  EQU   SDWAILC2
@NM00052 EQU   SDWAILC2
@NM00051 EQU   SDWAAEC2
SDWAADD2 EQU   SDWANXT2+1
@NM00050 EQU   SDWANXT2
@NM00049 EQU   SDWAEC2+3
SDWASGN2 EQU   SDWAINT2
SDWAEXP2 EQU   SDWAINT2
SDWADEC2 EQU   SDWAINT2
SDWAFPO2 EQU   SDWAINT2
SDWACC2  EQU   SDWAINT2
@NM00048 EQU   SDWAINT2
SDWAPGM2 EQU   SDWAMWP2
SDWAWAT2 EQU   SDWAMWP2
SDWAMCK2 EQU   SDWAMWP2
SDWAECT2 EQU   SDWAMWP2
SDWAKEY2 EQU   SDWAMWP2
SDWAEXT2 EQU   SDWAEMK2
SDWAIO2  EQU   SDWAEMK2
SDWATRM2 EQU   SDWAEMK2
@NM00047 EQU   SDWAEMK2
SDWAPER2 EQU   SDWAEMK2
@NM00046 EQU   SDWAEMK2
SDWATRAN EQU   SDWAAEC1+4
SDWAIPC1 EQU   SDWAICD1
SDWAIMC1 EQU   SDWAICD1
SDWAIPR1 EQU   SDWAICD1
@NM00045 EQU   SDWAINC1
@NM00044 EQU   SDWAILC1
SDWAIL1  EQU   SDWAILC1
@NM00043 EQU   SDWAILC1
@NM00042 EQU   SDWAAEC1
SDWAADD1 EQU   SDWANXT1+1
@NM00041 EQU   SDWANXT1
@NM00040 EQU   SDWAEC1+3
SDWASGN1 EQU   SDWAINT1
SDWAEXP1 EQU   SDWAINT1
SDWADEC1 EQU   SDWAINT1
SDWAFPO1 EQU   SDWAINT1
SDWACC1  EQU   SDWAINT1
@NM00039 EQU   SDWAINT1
SDWAPGM1 EQU   SDWAMWP1
SDWAWAT1 EQU   SDWAMWP1
SDWAMCK1 EQU   SDWAMWP1
SDWAECT1 EQU   SDWAMWP1
SDWAKEY1 EQU   SDWAMWP1
SDWAEXT1 EQU   SDWAEMK1
SDWAIO1  EQU   SDWAEMK1
SDWATRM1 EQU   SDWAEMK1
@NM00038 EQU   SDWAEMK1
SDWAPER1 EQU   SDWAEMK1
@NM00037 EQU   SDWAEMK1
SDWAIOBR EQU   SDWA+100
SDWAEPA  EQU   SDWA+96
@NM00036 EQU   SDWANAME+4
SDWARBAD EQU   SDWANAME
SDWAGR15 EQU   SDWAGRSV+60
SDWAGR14 EQU   SDWAGRSV+56
SDWAGR13 EQU   SDWAGRSV+52
SDWAGR12 EQU   SDWAGRSV+48
SDWAGR11 EQU   SDWAGRSV+44
SDWAGR10 EQU   SDWAGRSV+40
SDWAGR09 EQU   SDWAGRSV+36
SDWAGR08 EQU   SDWAGRSV+32
SDWAGR07 EQU   SDWAGRSV+28
SDWAGR06 EQU   SDWAGRSV+24
SDWAGR05 EQU   SDWAGRSV+20
SDWAGR04 EQU   SDWAGRSV+16
SDWAGR03 EQU   SDWAGRSV+12
SDWAGR02 EQU   SDWAGRSV+8
SDWAGR01 EQU   SDWAGRSV+4
SDWAGR00 EQU   SDWAGRSV
SDWANXTP EQU   SDWACTL2+5
SDWASGP  EQU   SDWAPMKP
SDWAEUP  EQU   SDWAPMKP
SDWADOP  EQU   SDWAPMKP
SDWAFPP  EQU   SDWAPMKP
SDWACCP  EQU   SDWAPMKP
SDWAILP  EQU   SDWAPMKP
SDWAINTP EQU   SDWACTL2+2
SDWASPVP EQU   SDWAMWPP
SDWAWATP EQU   SDWAMWPP
SDWAMCKP EQU   SDWAMWPP
@NM00035 EQU   SDWAMWPP
SDWAKEYP EQU   SDWAMWPP
SDWAEXTP EQU   SDWACMKP
SDWAIOP  EQU   SDWACMKP
SDWANXTA EQU   SDWACTL1+5
SDWASGA  EQU   SDWAPMKA
SDWAEUA  EQU   SDWAPMKA
SDWADOA  EQU   SDWAPMKA
SDWAFPA  EQU   SDWAPMKA
SDWACCA  EQU   SDWAPMKA
SDWAILA  EQU   SDWAPMKA
SDWAINTA EQU   SDWACTL1+2
SDWASPVA EQU   SDWAMWPA
SDWAWATA EQU   SDWAMWPA
SDWAMCKA EQU   SDWAMWPA
@NM00034 EQU   SDWAMWPA
SDWAKEYA EQU   SDWAMWPA
SDWAEXTA EQU   SDWACMKA
SDWAIOA  EQU   SDWACMKA
SDWACMPC EQU   SDWAABCC+1
@NM00033 EQU   SDWACMPF
SDWASTCC EQU   SDWACMPF
@NM00032 EQU   SDWACMPF
SDWASTEP EQU   SDWACMPF
SDWAPARM EQU   SDWA
WSAGSCHE EQU   WSAG+40
WSAGREST EQU   WSAG+36
WSAGNQDQ EQU   WSAG+32
WSAGMEMT EQU   WSAG+28
WSAGOPTM EQU   WSAG+24
WSAGSTAT EQU   WSAG+20
WSAGEMS0 EQU   WSAG+16
WSAGSSRS EQU   WSAG+12
WSAGRSM  EQU   WSAG+8
WSAGGMFM EQU   WSAG+4
WSAGPGIO EQU   WSAG
ASCBEND  EQU   ASCB+208
ASCBSRBT EQU   ASCB+200
ASCBSWTL EQU   ASCB+196
ASCBRS14 EQU   ASCB+195
ASCBSMCT EQU   ASCB+194
ASCBRS12 EQU   ASCB+192
ASCBPCTT EQU   ASCB+188
ASCBVGTT EQU   ASCB+184
ASCBLGCB EQU   ASCB+180
ASCBJBNS EQU   ASCB+176
ASCBJBNI EQU   ASCB+172
ASCBMCC  EQU   ASCB+168
ASCBRTWA EQU   ASCB+164
ASCBIQEA EQU   ASCB+160
ASCBXMPQ EQU   ASCB+156
ASCBRS01 EQU   ASCB+154
ASCBFMCT EQU   ASCB+152
ASCBOUXB EQU   ASCB+148
ASCBOUCB EQU   ASCB+144
ASCBMECB EQU   ASCB+140
ASCBQECB EQU   ASCB+136
ASCBCMSB EQU   ASCB+132
ASCBCMSF EQU   ASCB+128
ASCBTCBS EQU   ASCB+124
ASCBNVSC EQU   ASCB+122
ASCBVSC  EQU   ASCB+120
ASCBSRBS EQU   ASCB+118
ASCBSSRB EQU   ASCB+116
ASCBRV06 EQU   ASCBFLG2
ASCBRV05 EQU   ASCBFLG2
ASCBRV04 EQU   ASCBFLG2
ASCBSNQS EQU   ASCBFLG2
ASCBS2S  EQU   ASCBFLG2
ASCBCEXT EQU   ASCBFLG2
ASCBPXMT EQU   ASCBFLG2
ASCBXMPT EQU   ASCBFLG2
ASCBRF07 EQU   ASCBDSP1
ASCBRF06 EQU   ASCBDSP1
ASCBRF05 EQU   ASCBDSP1
ASCBRF04 EQU   ASCBDSP1
ASCBRF03 EQU   ASCBDSP1
ASCBRF02 EQU   ASCBDSP1
ASCBFAIL EQU   ASCBDSP1
ASCBNOQ  EQU   ASCBDSP1
ASCBSWCT EQU   ASCB+112
ASCBASXB EQU   ASCB+108
ASCBTMCH EQU   ASCB+104
ASCBNSWP EQU   ASCBFLG1
ASCBTYP1 EQU   ASCBFLG1
ASCBSTND EQU   ASCBFLG1
ASCBABNT EQU   ASCBFLG1
ASCBTERM EQU   ASCBFLG1
ASCBS3S  EQU   ASCBFLG1
ASCBCMSH EQU   ASCBFLG1
ASCBTOFF EQU   ASCBFLG1
ASCBRF01 EQU   ASCBRCTF
ASCBTMLW EQU   ASCBRCTF
ASCBOUT  EQU   ASCBRCTF
ASCBWAIT EQU   ASCBRCTF
ASCBRV08 EQU   ASCBRCTF
ASCBFQU  EQU   ASCBRCTF
ASCBFRS  EQU   ASCBRCTF
ASCBTMNO EQU   ASCBRCTF
ASCBAFFN EQU   ASCBFW1
ASCBDUMP EQU   ASCB+96
ASCBQSVC EQU   ASCB+92
ASCBUBET EQU   ASCB+88
ASCBECB  EQU   ASCB+84
ASCBJSTL EQU   ASCB+80
ASCBEWST EQU   ASCB+72
ASCBEJST EQU   ASCB+64
ASCBTSB  EQU   ASCB+60
ASCBCSCB EQU   ASCB+56
ASCBRSM  EQU   ASCB+52
ASCBLDA  EQU   ASCB+48
ASCBSTOR EQU   ASCB+44
ASCBDP   EQU   ASCB+43
ASCBRV07 EQU   ASCB+42
ASCBIOSM EQU   ASCB+40
ASCBSEQN EQU   ASCB+38
ASCBCPUS EQU   ASCB+32
ASCBSPL  EQU   ASCB+28
ASCBLSLQ EQU   ASCB+24
ASCBFSLQ EQU   ASCB+20
ASCBIOSP EQU   ASCB+16
ASCBLOCK EQU   ASCB+12
ASCBBWDP EQU   ASCB+8
ASCBFWDP EQU   ASCB+4
ASCBASCB EQU   ASCB
ASCBEGIN EQU   ASCB
ASVTEND  EQU   ASVT+528
ASVTAVAL EQU   ASVTENTY
ASVTAVAI EQU   ASVTFRST
ASVTRS00 EQU   ASVT+520
ASVTMAXU EQU   ASVT+516
ASVTASVT EQU   ASVT+512
ASVTBEGN EQU   ASVT+512
@NM00007 EQU   ASVT
@NM00006 EQU   TCBXTNT2+32
TCBRV181 EQU   TCBRV173
TCBRV180 EQU   TCBRV173
TCBRV179 EQU   TCBRV173
TCBRV178 EQU   TCBRV173
TCBRV177 EQU   TCBRV173
TCBRV176 EQU   TCBRV173
TCBRV175 EQU   TCBRV173
TCBRV174 EQU   TCBRV173
TCBRV172 EQU   TCBRV164
TCBRV171 EQU   TCBRV164
TCBRV170 EQU   TCBRV164
TCBRV169 EQU   TCBRV164
TCBRV168 EQU   TCBRV164
TCBRV167 EQU   TCBRV164
TCBRV166 EQU   TCBRV164
TCBRV165 EQU   TCBRV164
TCBRV163 EQU   TCBRV155
TCBRV162 EQU   TCBRV155
TCBRV161 EQU   TCBRV155
TCBRV160 EQU   TCBRV155
TCBRV159 EQU   TCBRV155
TCBRV158 EQU   TCBRV155
TCBRV157 EQU   TCBRV155
TCBRV156 EQU   TCBRV155
TCBRV154 EQU   TCBRV146
TCBRV153 EQU   TCBRV146
TCBRV152 EQU   TCBRV146
TCBRV151 EQU   TCBRV146
TCBRV150 EQU   TCBRV146
TCBRV149 EQU   TCBRV146
TCBRV148 EQU   TCBRV146
TCBRV147 EQU   TCBRV146
TCBRV145 EQU   TCBXTNT2+26
TCBRV144 EQU   TCBXTNT2+24
TCBRV143 EQU   TCBXTNT2+20
TCBRV142 EQU   TCBXTNT2+16
TCBRSV49 EQU   TCBXTNT2+12
TCBEVENT EQU   TCBXTNT2+8
TCBRCMP  EQU   TCBXTNT2+5
TCBRSVAB EQU   TCBXTNT2+4
TCBGTFA  EQU   TCBGTF+1
TCBRSV47 EQU   TCBTFLG
TCBRSV46 EQU   TCBTFLG
TCBRSV45 EQU   TCBTFLG
TCBRSV44 EQU   TCBTFLG
TCBRSV43 EQU   TCBTFLG
TCBDSPIT EQU   TCBTFLG
TCBERRTN EQU   TCBTFLG
TCBASYNC EQU   TCBTFLG
@NM00005 EQU   TCB+296
TCBSVCA2 EQU   TCB+292
TCBSWASA EQU   TCB+288
TCBDBTB  EQU   TCB+284
TCBRPT   EQU   TCB+280
TCBRV141 EQU   TCBRV133
TCBRV140 EQU   TCBRV133
TCBRV139 EQU   TCBRV133
TCBRV138 EQU   TCBRV133
TCBRV137 EQU   TCBRV133
TCBRV136 EQU   TCBRV133
TCBRV135 EQU   TCBRV133
TCBRV134 EQU   TCBRV133
TCBRV132 EQU   TCBRV124
TCBRV131 EQU   TCBRV124
TCBRV130 EQU   TCBRV124
TCBRV129 EQU   TCBRV124
TCBRV128 EQU   TCBRV124
TCBRV127 EQU   TCBRV124
TCBRV126 EQU   TCBRV124
TCBRV125 EQU   TCBRV124
TCBRV123 EQU   TCBFBYT2
TCBRV122 EQU   TCBFBYT2
TCBECBNV EQU   TCBFBYT2
TCBSSSYN EQU   TCBFBYT2
TCBFPRAP EQU   TCBFBYT2
TCBFDW   EQU   TCBFBYT2
TCBFMW   EQU   TCBFBYT2
TCBCNCB  EQU   TCBFBYT2
TCBLLH   EQU   TCBFBYT1
TCBRV113 EQU   TCBFBYT1
TCBEOT   EQU   TCBFBYT1
TCBRTM2  EQU   TCBFBYT1
TCBPGNLY EQU   TCBFBYT1
TCBNDIOS EQU   TCBFBYT1
TCBACTIV EQU   TCBFBYT1
TCBEOTFM EQU   TCBFBYT1
TCBAFFN  EQU   TCB+274
TCBCCPVI EQU   TCB+272
TCBUKYSP EQU   TCB+268
TCBMODE  EQU   TCBESTAE+3
TCBERTYP EQU   TCBESTAE+2
TCBRV314 EQU   TCBESTRM
TCBRV313 EQU   TCBESTRM
TCBRV312 EQU   TCBESTRM
TCBRV311 EQU   TCBESTRM
TCBRV310 EQU   TCBESTRM
TCBRV309 EQU   TCBESTRM
TCBRV308 EQU   TCBESTRM
TCBETERM EQU   TCBESTRM
TCBSCBKY EQU   TCBESTAE
TCBRTM12 EQU   TCB+260
TCBTCBID EQU   TCB+256
TCBRSV96 EQU   TCB+252
TCBSWA   EQU   TCB+248
TCBFOEA  EQU   TCBFOE+1
TCBRSV42 EQU   TCBFOE
TCBRV306 EQU   TCB+240
TCBRSV41 EQU   TCB+239
TCBTID   EQU   TCB+238
TCBRSVAA EQU   TCB+237
TCBABCUR EQU   TCB+236
TCBTMSAV EQU   TCB+232
TCBIOTIM EQU   TCB+228
TCBRTWA  EQU   TCB+224
TCBBACK  EQU   TCB+220
TCBTIRB  EQU   TCB+216
TCBAECB  EQU   TCB+212
TCBEXT2A EQU   TCBEXT2+1
TCBRSV39 EQU   TCBEXT2
TCBSTMCT EQU   TCB+207
TCBSYSCT EQU   TCB+206
TCBRSV37 EQU   TCB+205
TCBEXSVC EQU   TCBDAR
TCBDARMS EQU   TCBDAR
TCBDARWT EQU   TCBDAR
TCBDARO  EQU   TCBDAR
TCBDARMC EQU   TCBDARC
TCBDARD  EQU   TCBDAR
TCBDARS  EQU   TCBDAR
TCBDARP  EQU   TCBDAR
TCBADMP  EQU   TCBFLGS7
TCBRSTSK EQU   TCBFLGS7
TCBSVCS  EQU   TCBFLGS7
TCBSTACK EQU   TCBFLGS7
TCBRSV34 EQU   TCBFLGS7
TCBRSV33 EQU   TCBFLGS7
TCBGPECB EQU   TCBFLGS7
TCBNTJS  EQU   TCBFLGS6
TCBAPG   EQU   TCBFLGS6
TCBMIGR  EQU   TCBFLGS6
TCBRV303 EQU   TCBFLGS6
TCBSPVLK EQU   TCBFLGS6
TCBCPU   EQU   TCBFLGS6
TCBPIE17 EQU   TCBFLGS6
TCBRV    EQU   TCBFLGS6
TCBRSV79 EQU   TCBNDSP5
TCBRSV78 EQU   TCBNDSP5
TCBRSV77 EQU   TCBNDSP5
TCBRSV76 EQU   TCBNDSP5
TCBRSV75 EQU   TCBNDSP5
TCBRSV74 EQU   TCBNDSP5
TCBRSV95 EQU   TCBNDSP5
TCBRSV94 EQU   TCBNDSP5
TCBRSV93 EQU   TCBNDSP4
TCBRSV92 EQU   TCBNDSP4
TCBRSV91 EQU   TCBNDSP4
TCBRSV90 EQU   TCBNDSP4
TCBRSV89 EQU   TCBNDSP4
TCBRSV88 EQU   TCBNDSP4
TCBRSV87 EQU   TCBNDSP4
TCBRSV86 EQU   TCBNDSP4
TCBEXT1A EQU   TCBEXT1+1
TCBRSV32 EQU   TCBEXT1
TCBEXCPD EQU   TCB+192
TCBIOBRC EQU   TCB+188
TCBDDWTC EQU   TCB+186
TCBDDEXC EQU   TCB+184
TCBJSCBB EQU   TCBJSCB+1
@NM00004 EQU   TCBRECDE
TCBREC   EQU   TCBRECDE
TCBMDIDS EQU   TCB+176
TCBNDINT EQU   TCBNDSP3
TCBRSV27 EQU   TCBNDSP3
TCBRSV26 EQU   TCBNDSP3
TCBRSV25 EQU   TCBNDSP3
TCBRSV24 EQU   TCBNDSP3
TCBSRBND EQU   TCBNDSP3
TCBRV302 EQU   TCBNDSP3
TCBLJSND EQU   TCBNDSP3
TCBABE   EQU   TCBNDSP2
TCBDSS   EQU   TCBNDSP2
TCBOWAIT EQU   TCBNDSP2
TCBIWAIT EQU   TCBNDSP2
TCBNDTS  EQU   TCBNDSP2
TCBNDSVC EQU   TCBNDSP2
TCBSTPP  EQU   TCBNDSP2
TCBABD   EQU   TCBNDSP2
TCBRSV22 EQU   TCBNDSP1
TCBPIEND EQU   TCBNDSP1
TCBTPSP  EQU   TCBNDSP1
TCBDDRND EQU   TCBNDSP1
TCBRSPND EQU   TCBNDSP1
TCBRSTND EQU   TCBNDSP1
TCBDARPN EQU   TCBNDSP1
TCBDARTN EQU   TCBNDSP1
TCBNDSP0 EQU   TCBNDSP
TCBUSER  EQU   TCB+168
TCBTCTB  EQU   TCBTCT+1
TCBRSV9C EQU   TCBTCTGF
TCBRSV9B EQU   TCBTCTGF
TCBRSV9A EQU   TCBTCTGF
TCBRSV99 EQU   TCBTCTGF
TCBRSV98 EQU   TCBTCTGF
TCBRSV97 EQU   TCBTCTGF
TCBRSV20 EQU   TCBTCTGF
TCBSMFGF EQU   TCBTCTGF
TCBSTABB EQU   TCBSTAB+1
TCBSTCUR EQU   TCBNSTAE
TCBRV301 EQU   TCBNSTAE
TCBSYNCH EQU   TCBNSTAE
TCBHALT  EQU   TCBNSTAE
TCBPPSUP EQU   TCBNSTAE
TCB33E   EQU   TCBNSTAE
TCBQUIES EQU   TCBNSTAE
TCBSTABE EQU   TCBNSTAE
TCBAQE   EQU   TCB+156
TCBPQE   EQU   TCB+152
TCBTSDP  EQU   TCB+151
TCBTSLP  EQU   TCB+150
TCBSTPCT EQU   TCB+149
TCBCPUBN EQU   TCBTSFLG
TCBDYDSP EQU   TCBTSFLG
TCBRSV18 EQU   TCBTSFLG
TCBRSV17 EQU   TCBTSFLG
TCBTIOTG EQU   TCBTSFLG
TCBATT   EQU   TCBTSFLG
TCBSTPPR EQU   TCBTSFLG
TCBRV300 EQU   TCBTSTSK
TCBECB   EQU   TCB+144
TCBIQE   EQU   TCB+140
TCBLTC   EQU   TCB+136
TCBOTC   EQU   TCB+132
TCBNTC   EQU   TCB+128
TCBJSTCA EQU   TCBJSTCB+1
TCBRSV16 EQU   TCBJSTCB
TCBTQET  EQU   TCBTME
TCBTCB   EQU   TCB+116
TCBFSAB  EQU   TCBFSA+1
TCBQEL   EQU   TCBFSA
TCBGRS15 EQU   TCBGRS+60
TCBGRS14 EQU   TCBGRS+56
TCBGRS13 EQU   TCBGRS+52
TCBGRS12 EQU   TCBGRS+48
TCBGRS11 EQU   TCBGRS+44
TCBGRS10 EQU   TCBGRS+40
TCBGRS9  EQU   TCBGRS+36
TCBGRS8  EQU   TCBGRS+32
TCBGRS7  EQU   TCBGRS+28
TCBGRS6  EQU   TCBGRS+24
TCBGRS5  EQU   TCBGRS+20
TCBGRS4  EQU   TCBGRS+16
TCBGRS3  EQU   TCBGRS+12
TCBGRS2  EQU   TCBGRS+8
TCBGRS1  EQU   TCBGRS+4
TCBGRS0  EQU   TCBGRS
TCBJPQB  EQU   TCBJPQ+1
TCBRSV15 EQU   TCBPURGE
TCBRSV14 EQU   TCBPURGE
TCBRSV13 EQU   TCBPURGE
TCBRSV12 EQU   TCBPURGE
TCBRSV11 EQU   TCBPURGE
TCBRSV10 EQU   TCBPURGE
TCBRSV09 EQU   TCBPURGE
TCBJPQF  EQU   TCBPURGE
TCBJLB   EQU   TCB+40
TCBLLS   EQU   TCB+36
TCBDSP   EQU   TCB+35
TCBLMP   EQU   TCB+34
TCBPNDSP EQU   TCBFLGS5
TCBFCD1  EQU   TCBFLGS5
TCBSTP   EQU   TCBFLGS5
TCBSYS   EQU   TCBFLGS5
TCBANDSP EQU   TCBFLGS5
TCBPAGE  EQU   TCBFLGS5
TCBUXNDF EQU   TCBABWF
TCBFC    EQU   TCBFLGS5
TCBONDSP EQU   TCBFLGS4
TCBMPCND EQU   TCBFLGS4
TCBMPCVQ EQU   TCBFLGS4
TCBUXNDV EQU   TCBFLGS4
TCBHNDSP EQU   TCBFLGS4
TCBRQENA EQU   TCBFLGS4
TCBSER   EQU   TCBFLGS4
TCBNDUMP EQU   TCBFLGS4
TCBDWSTA EQU   TCBFLGS3
TCBRSV08 EQU   TCBFLGS3
TCBRSV07 EQU   TCBFLGS3
TCBRSV06 EQU   TCBFLGS3
TCBABGM  EQU   TCBFLGS3
TCBABTRM EQU   TCBFLGS3
TCBADINP EQU   TCBFLGS3
TCBFSM   EQU   TCBFLGS3
TCBFTS   EQU   TCBFLGS2
TCBFETXR EQU   TCBFLGS2
TCBFDSOP EQU   TCBFLGS2
TCBFJMC  EQU   TCBFLGS2
TCBFSMC  EQU   TCBFLGS2
TCBFABOP EQU   TCBFLGS2
TCBFSTI  EQU   TCBFLGS2
TCBFOINP EQU   TCBFLGS2
TCBFX    EQU   TCBFLGS1
TCBFS    EQU   TCBFLGS1
TCBFT    EQU   TCBFLGS1
TCBPDUMP EQU   TCBFLGS1
TCBNONPR EQU   TCBFLGS1
TCBFERA  EQU   TCBFLGS1
TCBFE    EQU   TCBFLGS1
TCBFA    EQU   TCBFLGS1
TCBZERO  EQU   TCBPKF
TCBFLAG  EQU   TCBPKF
TCBMSSB  EQU   TCBMSS+1
TCBRSV03 EQU   TCBMSS
TCBTRNB  EQU   TCBTRN+1
TCBRSV02 EQU   TCBABF
TCBOLTEP EQU   TCBABF
TCBTCP   EQU   TCBABF
TCBTCPP  EQU   TCBABF
TCBRSV01 EQU   TCBABF
TCBGRPH  EQU   TCBABF
TCBNOCHK EQU   TCBABF
TCBMOD91 EQU   TCBABF
TCBCMPC  EQU   TCBCMP+1
TCBRV318 EQU   TCBCMSG
TCBRV317 EQU   TCBCIND
TCBRV316 EQU   TCBCWTO
TCBCASID EQU   TCBCDBL
TCBNOCC  EQU   TCBSTCC
TCBDMPO  EQU   TCBCPP
TCBCSTEP EQU   TCBCMPF
TCBCREQ  EQU   TCBCMPF
TCBTIO   EQU   TCB+12
TCBDEB   EQU   TCB+8
TCBPIEA  EQU   TCBPIE+1
TCBPM    EQU   TCBPMASK
@NM00003 EQU   TCBPMASK
TCBRBP   EQU   TCB
TCBFRS6  EQU   TCBFRS+24
TCBFRS4  EQU   TCBFRS+16
TCBFRS2  EQU   TCBFRS+8
TCBFRS0  EQU   TCBFRS
CVTLEVL  EQU   CVTRELNO+2
CVTNUMB  EQU   CVTRELNO
CVTMDL   EQU   CVTFIX+250
@NM00002 EQU   CVTFIX+248
@NM00001 EQU   CVTFIX
CVTRV482 EQU   CVTXTNT2+128
CVTRV481 EQU   CVTXTNT2+124
CVTRV480 EQU   CVTXTNT2+120
CVTRV479 EQU   CVTXTNT2+118
CVTRV478 EQU   CVTXTNT2+117
CVTRV477 EQU   CVTXTNT2+116
CVTRV476 EQU   CVTXTNT2+115
CVTRV475 EQU   CVTXTNT2+114
CVTRV474 EQU   CVTRV466
CVTRV473 EQU   CVTRV466
CVTRV472 EQU   CVTRV466
CVTRV471 EQU   CVTRV466
CVTRV470 EQU   CVTRV466
CVTRV469 EQU   CVTRV466
CVTRV468 EQU   CVTRV466
CVTRV467 EQU   CVTRV466
CVTRV465 EQU   CVTRV457
CVTRV464 EQU   CVTRV457
CVTRV463 EQU   CVTRV457
CVTRV462 EQU   CVTRV457
CVTRV461 EQU   CVTRV457
CVTRV460 EQU   CVTRV457
CVTRV459 EQU   CVTRV457
CVTRV458 EQU   CVTRV457
CVTRV456 EQU   CVTXTNT2+108
CVTRV455 EQU   CVTXTNT2+104
CVTRV454 EQU   CVTXTNT2+100
CVTRV453 EQU   CVTXTNT2+96
CVTRV452 EQU   CVTXTNT2+94
CVTRV451 EQU   CVTXTNT2+92
CVTRV450 EQU   CVTXTNT2+90
CVTRV449 EQU   CVTXTNT2+88
CVTRV448 EQU   CVTXTNT2+87
CVTRV447 EQU   CVTXTNT2+86
CVTRV446 EQU   CVTRV438
CVTRV445 EQU   CVTRV438
CVTRV444 EQU   CVTRV438
CVTRV443 EQU   CVTRV438
CVTRV442 EQU   CVTRV438
CVTRV441 EQU   CVTRV438
CVTRV440 EQU   CVTRV438
CVTRV439 EQU   CVTRV438
CVTRV437 EQU   CVTRV429
CVTRV436 EQU   CVTRV429
CVTRV435 EQU   CVTRV429
CVTRV434 EQU   CVTRV429
CVTRV433 EQU   CVTRV429
CVTRV432 EQU   CVTRV429
CVTRV431 EQU   CVTRV429
CVTRV430 EQU   CVTRV429
CVTRV428 EQU   CVTXTNT2+80
CVTRV427 EQU   CVTXTNT2+76
CVTRV426 EQU   CVTXTNT2+72
CVTRV425 EQU   CVTXTNT2+68
CVTATACT EQU   CVTATCVT
CVTRV423 EQU   CVTXTNT2+62
CVTRV422 EQU   CVTXTNT2+60
CVTRV421 EQU   CVTXTNT2+58
CVTRV420 EQU   CVTXTNT2+56
CVTRV419 EQU   CVTXTNT2+55
CVTRV418 EQU   CVTXTNT2+54
CVTRV417 EQU   CVTRV409
CVTRV416 EQU   CVTRV409
CVTRV415 EQU   CVTRV409
CVTRV414 EQU   CVTRV409
CVTRV413 EQU   CVTRV409
CVTRV412 EQU   CVTRV409
CVTRV411 EQU   CVTRV409
CVTRV410 EQU   CVTRV409
CVTRV408 EQU   CVTRV400
CVTRV407 EQU   CVTRV400
CVTRV406 EQU   CVTRV400
CVTRV405 EQU   CVTRV400
CVTRV404 EQU   CVTRV400
CVTRV403 EQU   CVTRV400
CVTRV402 EQU   CVTRV400
CVTRV401 EQU   CVTRV400
CVTICB   EQU   CVTXTNT2+48
CVTSKTA  EQU   CVTXTNT2+44
CVTCCVT  EQU   CVTXTNT2+40
CVTRSV98 EQU   CVTXTNT2+36
CVTRSV97 EQU   CVTXTNT2+34
CVTRSV96 EQU   CVTXTNT2+32
CVTOLTEP EQU   CVTXTNT2+28
CVTQIDA  EQU   CVTQID+1
CVTRSV95 EQU   CVTQID
CVTRSV94 EQU   CVTXTNT2+20
CVTRSV93 EQU   CVTXTNT2+16
CVTRSV92 EQU   CVTXTNT2+12
CVTDEBVR EQU   CVTXTNT2+8
CVTRSV91 EQU   CVTXTNT2+6
CVTRSV9H EQU   CVTFLGBT
CVTRSV9G EQU   CVTFLGBT
CVTRSV9F EQU   CVTFLGBT
CVTRSV9E EQU   CVTFLGBT
CVTRSV9D EQU   CVTFLGBT
CVTRSV9C EQU   CVTFLGBT
CVTVME   EQU   CVTFLGBT
CVTNPE   EQU   CVTFLGBT
CVTNUCLS EQU   CVTXTNT2+4
CVTDSSVA EQU   CVTDSSV+1
CVTRSV89 EQU   CVTDSSV
CVTRSV88 EQU   CVTXTNT1+8
CVTRSV87 EQU   CVTXTNT1+4
CVTFACHN EQU   CVTXTNT1
CVTRV488 EQU   CVTMAP+412
CVTRV487 EQU   CVTMAP+408
CVTRV486 EQU   CVTMAP+404
CVTRV485 EQU   CVTMAP+400
CVTACTAP EQU   CVTMAP+396
CVTAUTH  EQU   CVTMAP+392
CVTATMCA EQU   CVTATMCT+1
CVTATMST EQU   CVTATMCT
CVTRSV61 EQU   CVTMAP+384
CVTVOLT1 EQU   CVTVOLM1+1
CVTVOLI1 EQU   CVTVOLF1
CVTSTOA  EQU   CVTMAP+376
CVTRSV58 EQU   CVTMAP+374
CVTRSV57 EQU   CVTMAP+372
CVTDDCE  EQU   CVTMAP+368
CVTPNWFR EQU   CVTMAP+364
CVTSMF   EQU   CVTMAP+360
CVTSULK  EQU   CVTMAP+358
CVTSLKO  EQU   CVTSYSK
CVTSLKP  EQU   CVTSYSK
CVTSLKQ  EQU   CVTSYSK
CVTSLKR  EQU   CVTSYSK
CVTRSV56 EQU   CVTSYSK
CVTRSV55 EQU   CVTSYSK
CVTRSV54 EQU   CVTSYSK
CVTRSV53 EQU   CVTSYSK
CVTRSV52 EQU   CVTA1F1
CVTRSV51 EQU   CVTA1F1
CVTRSV50 EQU   CVTA1F1
CVTRSV49 EQU   CVTA1F1
CVTRSV48 EQU   CVTA1F1
CVTRSV47 EQU   CVTA1F1
CVTSRSW  EQU   CVTA1F1
CVTPFSW  EQU   CVTA1F1
CVTPCVT  EQU   CVTMAP+352
CVTRSV46 EQU   CVTMAP+344
CVTRSV45 EQU   CVTMAP+340
CVTRSV44 EQU   CVTMAP+338
CVTRSV43 EQU   CVTMAP+336
CVTHJESA EQU   CVTHJES+1
CVTRSV42 EQU   CVTHJES
CVTEXT2A EQU   CVTEXT2+1
CVTRSV41 EQU   CVTEXT2
CVTAPFA  EQU   CVTAPF+1
CVTRSV40 EQU   CVTAPF
CVTRV518 EQU   CVTINTLA
CVTRV517 EQU   CVTERPV
CVTEORM  EQU   CVTMAP+312
CVTMCHPR EQU   CVTMAP+308
CVTTZ    EQU   CVTMAP+304
CVTJEPS  EQU   CVTMAP+300
CVTJESCT EQU   CVTMAP+296
CVTMODE  EQU   CVTMAP+292
CVTPTRV  EQU   CVTMAP+288
CVTREAL  EQU   CVTMAP+284
CVTRSV39 EQU   CVTMAP+280
CVTRSV38 EQU   CVTMAP+276
CVTDMSRA EQU   CVTDMSR+1
CVTRV634 EQU   CVTDMSRF
CVTRV633 EQU   CVTDMSRF
CVTRV632 EQU   CVTDMSRF
CVTRV631 EQU   CVTDMSRF
CVTRV630 EQU   CVTDMSRF
CVTRV629 EQU   CVTDMSRF
CVTUDUMP EQU   CVTDMSRF
CVTSDUMP EQU   CVTDMSRF
CVTQMSGA EQU   CVTQMSG+1
CVTRSV36 EQU   CVTQMSG
CVTAMFF  EQU   CVTMAP+264
CVTPURGA EQU   CVTPURG+1
CVTRSV35 EQU   CVTPURG
CVTCBSP  EQU   CVTMAP+256
CVTATERA EQU   CVTATER+1
CVTSYST  EQU   CVTATER
CVTVOLT2 EQU   CVTTAT
CVTVOLI2 EQU   CVTVOLF2
CVTAQAVB EQU   CVTAQAVT+1
CVTRSV34 EQU   CVTTCMFG
CVTRSV33 EQU   CVTTCMFG
CVTRSV32 EQU   CVTTCMFG
CVTRSV31 EQU   CVTTCMFG
CVTRSV30 EQU   CVTTCMFG
CVTRSV29 EQU   CVTTCMFG
CVTRSV28 EQU   CVTTCMFG
CVTTCRDY EQU   CVTTCMFG
CVTRSV27 EQU   CVTGTFST
CVTRNIO  EQU   CVTGTFST
CVTUSR   EQU   CVTGTFST
CVTRV318 EQU   CVTFORM
CVTRV317 EQU   CVTTMODE
CVTRV316 EQU   CVTSTATE
CVTRV315 EQU   CVTGTFS
CVTGTFAV EQU   CVTGTFS
CVT0SCR1 EQU   CVTMAP+232
CVTRV515 EQU   CVTMAP+228
CVTRMS   EQU   CVTMAP+224
CVTPATCH EQU   CVTMAP+220
CVTTSCE  EQU   CVTMAP+216
CVTLNKSC EQU   CVTMAP+214
CVTQABST EQU   CVTMAP+212
CVTMDLDS EQU   CVTMAP+208
CVTUSER  EQU   CVTMAP+204
CVTABEND EQU   CVTMAP+200
CVTSMCA  EQU   CVTMAP+196
CVTRSV18 EQU   CVTMAP+192
CVTQLPAQ EQU   CVTMAP+188
CVTQCDSR EQU   CVTMAP+184
CVTRSV17 EQU   CVTOPTB
CVTRSV16 EQU   CVTOPTB
CVTFP    EQU   CVTOPTB
CVTAPTHR EQU   CVTOPTB
CVTNLOG  EQU   CVTOPTB
CVTTOD   EQU   CVTOPTB
CVTCTIMS EQU   CVTOPTB
CVTPROT  EQU   CVTOPTB
CVTXPFP  EQU   CVTOPTA
CVTASCII EQU   CVTOPTA
CVTRSV13 EQU   CVTOPTA
CVTRSV12 EQU   CVTOPTA
CVTNIP   EQU   CVTOPTA
CVTDDR   EQU   CVTOPTA
CVTAPR   EQU   CVTOPTA
CVTCCH   EQU   CVTOPTA
CVTSNCTR EQU   CVTMAP+180
CVTQMWR  EQU   CVTMAP+176
CVTQOCR  EQU   CVTMAP+172
CVT1EF00 EQU   CVTMAP+168
CVTMZ00  EQU   CVTMAP+164
CVTSV76Q EQU   CVTSV76C
CVTRSV11 EQU   CVTMAP+156
CVT0PT01 EQU   CVTMAP+152
CVTMSER  EQU   CVTMAP+148
CVTRV516 EQU   CVTIERLC
CVTILCH  EQU   CVTMAP+140
CVT0DS   EQU   CVTMAP+136
CVTFBOSV EQU   CVTMAP+132
CVTNUCB  EQU   CVTMAP+128
CVTIXAVL EQU   CVTMAP+124
CVTSV76M EQU   CVTIOQET
CVTDCBA  EQU   CVTMAP+117
CVTMVS2  EQU   CVTDCB
CVT6DAT  EQU   CVTDCB
CVT4MPS  EQU   CVTDCB
CVTRSV09 EQU   CVTDCB
CVT4MS1  EQU   CVTDCB
CVT2SPS  EQU   CVTDCB
CVT1SSS  EQU   CVTDCB
CVTRSV08 EQU   CVTDCB
CVTSTB   EQU   CVTMAP+112
CVTQTD00 EQU   CVTMAP+108
CVTQTE00 EQU   CVTMAP+104
CVTCUCB  EQU   CVTMAP+100
CVTSJQ   EQU   CVTMAP+96
CVTPBLDL EQU   CVTMAP+92
CVTTPC   EQU   CVTMAP+88
CVTSVDCB EQU   CVTMAP+84
CVTBRET  EQU   CVTMAP+82
CVTEXIT  EQU   CVTMAP+80
CVT0FN00 EQU   CVTMAP+76
CVTDARA  EQU   CVTDAR+1
CVTRSV07 EQU   CVTFLGS1
CVTRSV06 EQU   CVTFLGS1
CVTRSV05 EQU   CVTFLGS1
CVTRSV04 EQU   CVTFLGS1
CVTRSV03 EQU   CVTFLGS1
CVTRSV02 EQU   CVTFLGS1
CVTRSV01 EQU   CVTFLGS1
CVTDMPLK EQU   CVTFLGS1
CVTXITP  EQU   CVTMAP+68
CVTZDTAB EQU   CVTMAP+64
CVTMSLT  EQU   CVTMAP+60
CVTDATE  EQU   CVTMAP+56
CVTBTERM EQU   CVTMAP+52
CVTSYSAD EQU   CVTMAP+48
CVTXTLER EQU   CVTMAP+44
CVTILK2  EQU   CVTMAP+40
CVTILK1  EQU   CVTMAP+36
CVTPRLTV EQU   CVTMAP+32
CVTPCNVT EQU   CVTMAP+28
CVT0VL00 EQU   CVTMAP+24
CVTXAPG  EQU   CVTMAP+20
CVTBUF   EQU   CVTMAP+16
CVTJOB   EQU   CVTMAP+12
CVTLINK  EQU   CVTMAP+8
CVT0EF00 EQU   CVTMAP+4
CVTTCBP  EQU   CVTMAP
CVT      EQU   CVTMAP
@NM00031 EQU   PSA+3668
PSASTAK  EQU   PSA+3072
@NM00030 EQU   PSA+1048
PSAUSEND EQU   PSA+1048
PSARV062 EQU   PSA+1044
PSACDAL  EQU   PSA+1040
PSAWTCOD EQU   PSA+1036
PSAATCVT EQU   PSA+1032
PSAPCPSW EQU   PSA+1024
PSAPIR2  EQU   PSA+1020
PSARV059 EQU   PSA+1018
PSASVC13 EQU   PSA+1016
PSALSFCC EQU   PSA+1012
PSASFACC EQU   PSA+1008
PSASTOP  EQU   PSA+992
PSASTART EQU   PSA+976
PSARSPSW EQU   PSA+968
PSASRPSW EQU   PSA+960
PSARV045 EQU   PSA+892
PSARV044 EQU   PSA+888
PSARV043 EQU   PSA+884
PSARV042 EQU   PSA+880
PSARV041 EQU   PSA+876
PSARV040 EQU   PSA+872
PSARV025 EQU   PSA+868
PSADSSED EQU   PSA+868
PSADSSPR EQU   PSA+864
PSADSSFW EQU   PSA+860
PSADSS14 EQU   PSA+856
PSADSSPP EQU   PSA+848
PSADSSRP EQU   PSA+840
PSADSS05 EQU   PSADSSF4
PSADSS10 EQU   PSADSSF4
PSADSSVE EQU   PSADSSF4
PSADSSDE EQU   PSADSSF4
PSADSSC0 EQU   PSADSSF4
PSADSSIE EQU   PSADSSF4
PSADSS12 EQU   PSADSSF4
PSADSSRC EQU   PSADSSF4
PSARV057 EQU   PSADSSF3
PSARV056 EQU   PSADSSF3
PSARV055 EQU   PSADSSF3
PSADSSMC EQU   PSADSSF3
PSADSSRW EQU   PSADSSF3
PSADSSNM EQU   PSADSSF3
PSADSSES EQU   PSADSSF3
PSADSSGP EQU   PSADSSF3
PSADSSF2 EQU   PSADSSFL+1
PSADSSPI EQU   PSADSSF1
PSADSSOI EQU   PSADSSF1
PSADSSSP EQU   PSADSSF1
PSADSSTP EQU   PSADSSF1
PSADSSDW EQU   PSADSSF1
PSADSSDD EQU   PSADSSF1
PSADSSDM EQU   PSADSSF1
PSADSSMV EQU   PSADSSF1
PSADSSTS EQU   PSA+816
PSADSSWK EQU   PSA+812
PSADSSR3 EQU   PSA+808
PSADSSR2 EQU   PSA+804
PSADSSRS EQU   PSA+800
PSASTOR  EQU   PSA+796
PSACPUSA EQU   PSA+794
PSAVSTAP EQU   PSA+792
PSAWKVAP EQU   PSA+788
PSAWKRAP EQU   PSA+784
PSAMCHIC EQU   PSA+783
PSARV061 EQU   PSA+782
PSASYMSK EQU   PSA+781
PSAMCHFL EQU   PSA+780
PSACR0   EQU   PSA+776
PSAPSWSV EQU   PSA+768
PSALITA  EQU   PSA+764
PSACLHS  EQU   PSAHLHI
PSALKR15 EQU   PSALKSA+60
PSALKR14 EQU   PSALKSA+56
PSALKR13 EQU   PSALKSA+52
PSALKR12 EQU   PSALKSA+48
PSALKR11 EQU   PSALKSA+44
PSALKR10 EQU   PSALKSA+40
PSALKR9  EQU   PSALKSA+36
PSALKR8  EQU   PSALKSA+32
PSALKR7  EQU   PSALKSA+28
PSALKR6  EQU   PSALKSA+24
PSALKR5  EQU   PSALKSA+20
PSALKR4  EQU   PSALKSA+16
PSALKR3  EQU   PSALKSA+12
PSALKR2  EQU   PSALKSA+8
PSALKR1  EQU   PSALKSA+4
PSALKR0  EQU   PSALKSA
PSARV023 EQU   PSACLHT+52
PSALOCAL EQU   PSACLHT+48
PSACMSL  EQU   PSACLHT+44
PSAOPTL  EQU   PSACLHT+40
PSATPACL EQU   PSACLHT+36
PSATPDNL EQU   PSACLHT+32
PSATPNCL EQU   PSACLHT+28
PSAIOSLL EQU   PSACLHT+24
PSAIOSUL EQU   PSACLHT+20
PSAIOSCL EQU   PSACLHT+16
PSAIOSSL EQU   PSACLHT+12
PSASALCL EQU   PSACLHT+8
PSAASML  EQU   PSACLHT+4
PSADISPL EQU   PSACLHT
PSASRSA  EQU   PSA+636
PSARV050 EQU   PSA+634
PSADSSGO EQU   PSA+633
PSARECUR EQU   PSA+632
PSAHLHIS EQU   PSA+628
PSAIPCSA EQU   PSA+624
@NM00029 EQU   PSA+621
PSAIPCDM EQU   PSA+620
PSAIPCD  EQU   PSA+616
@NM00028 EQU   PSA+613
PSAIPCRM EQU   PSA+612
PSAIPCR  EQU   PSA+608
PSAMCHEX EQU   PSA+600
PSAMPSW  EQU   PSA+592
PSAEXPS2 EQU   PSA+584
PSAEXPS1 EQU   PSA+576
PSAPIREG EQU   PSA+572
PSARSREG EQU   PSA+568
PSAGPREG EQU   PSA+556
PSARV022 EQU   PSASUP4
PSARV021 EQU   PSASUP4
PSARV020 EQU   PSASUP4
PSARV019 EQU   PSASUP4
PSARV018 EQU   PSASUP4
PSARV017 EQU   PSASUP4
PSARV016 EQU   PSASUP4
PSARV015 EQU   PSASUP4
PSARV014 EQU   PSASUP3
PSARV013 EQU   PSASUP3
PSARV012 EQU   PSASUP3
PSAESTA  EQU   PSASUP3
PSASPR   EQU   PSASUP3
PSAPSREG EQU   PSASUP3
PSAPI2   EQU   PSASUP3
PSAIOSUP EQU   PSASUP3
PSALCR   EQU   PSASUP2
PSARTM   EQU   PSASUP2
PSAACR   EQU   PSASUP2
PSAIPCE2 EQU   PSASUP2
PSAIPCES EQU   PSASUP2
PSAIPCEC EQU   PSASUP2
PSAGTF   EQU   PSASUP2
PSAIPCRI EQU   PSASUP2
PSATYPE6 EQU   PSASUP1
PSATCTL  EQU   PSASUP1
PSADISP  EQU   PSASUP1
PSALOCK  EQU   PSASUP1
PSAPI    EQU   PSASUP1
PSAEXT   EQU   PSASUP1
PSASVC   EQU   PSASUP1
PSAIO    EQU   PSASUP1
PSAANEW  EQU   PSA+544
PSATNEW  EQU   PSA+536
PSALCCAR EQU   PSA+532
PSALCCAV EQU   PSA+528
PSAPCCAR EQU   PSA+524
PSAPCCAV EQU   PSA+520
PSACPULA EQU   PSA+518
PSACPUPA EQU   PSA+516
PSAPSA   EQU   PSA+512
FLCHDEND EQU   PSA+512
FLCCRSAV EQU   FLCMCLA+280
FLCGRSAV EQU   FLCMCLA+216
FLCFPSAV EQU   FLCMCLA+184
FLCFLA   EQU   FLCMCLA+88
FLCRGNCD EQU   FLCMCLA+84
FLCFSAA  EQU   FLCFSA+1
@NM00027 EQU   FLCFSA
@NM00026 EQU   FLCMCLA+72
FLCMCIC  EQU   FLCMCLA+64
@NM00025 EQU   FLCMCLA+20
FLCIOAA  EQU   FLCIOA+1
@NM00024 EQU   FLCIOA
@NM00023 EQU   FLCMCLA+15
@NM00022 EQU   FLCMCLA+14
@NM00021 EQU   FLCMCLA+12
FLCLCL   EQU   FLCMCLA+8
FLCIOELA EQU   FLCIOEL+1
@NM00020 EQU   FLCIOEL
FLCCHNID EQU   FLCMCLA
@NM00019 EQU   PSA+160
FLCMTRCD EQU   PSA+157
@NM00018 EQU   PSA+156
FLCPERA  EQU   FLCPER+1
@NM00017 EQU   FLCPER
@NM00016 EQU   PSA+151
FLCPERCD EQU   PSA+150
FLCMCNUM EQU   PSA+149
@NM00015 EQU   PSA+148
FLCTEAA  EQU   FLCTEA+1
@NM00014 EQU   FLCTEA
PSAPIPC  EQU   PSAPICOD
PSAPIMC  EQU   PSAPICOD
PSAPIPER EQU   PSAPICOD
PSARV049 EQU   FLCPICOD
FLCPILCB EQU   FLCPIILC
@NM00013 EQU   FLCPIILC
@NM00012 EQU   PSAEPPSW
FLCSVCN  EQU   PSAESPSW+2
FLCSILCB EQU   FLCSVILC
@NM00011 EQU   FLCSVILC
@NM00010 EQU   PSAESPSW
FLCEICOD EQU   PSAEEPSW+2
PSASPAD  EQU   PSAEEPSW
@NM00009 EQU   PSA+128
FLCINPSW EQU   PSA+120
FLCMNPSW EQU   PSA+112
FLCPNPSW EQU   PSA+104
FLCSNPSW EQU   PSA+96
FLCENPSW EQU   PSA+88
FLCTRACE EQU   PSA+84
FLCTIMER EQU   PSA+80
FLCCVT2  EQU   PSA+76
FLCCAW   EQU   PSA+72
FLCCSW   EQU   PSA+64
FLCIOPSW EQU   PSA+56
FLCMOPSW EQU   PSA+48
FLCPOPSW EQU   PSA+40
FLCSOPSW EQU   PSA+32
FLCEOPSW EQU   PSA+24
@NM00008 EQU   FLCICCW2+4
FLCCVT   EQU   FLCICCW2
FLCICCW1 EQU   FLCROPSW
FLCIPPSW EQU   FLCRNPSW
*                                      END UNREFERENCED COMPONENTS
@RC00437 EQU   @RC00434
@RC00474 EQU   @RC00434
@RC00491 EQU   @RC00434
@RC00569 EQU   @RC00514
@RT00719 EQU   USRERR
@RF00804 EQU   @RC00775
@RT00929 EQU   USER1
@RF00936 EQU   @RC00913
@PB00013 EQU   @EL00001
@RF00439 EQU   @RC00437
@RC00441 EQU   @RC00437
@RC00458 EQU   @RC00437
@RF00465 EQU   @RC00437
@RF00479 EQU   @RC00474
@RC00481 EQU   @RC00474
@RC00571 EQU   @RC00569
@RC00587 EQU   @RC00569
@PB00012 EQU   @PB00013
@RC00575 EQU   @RC00571
@PB00011 EQU   @PB00012
@PB00010 EQU   @PB00011
@PB00009 EQU   @PB00010
@PB00008 EQU   @PB00009
@PB00007 EQU   @PB00008
@PB00006 EQU   @PB00007
@PB00005 EQU   @PB00006
@PB00004 EQU   @PB00005
@PB00003 EQU   @PB00004
@PB00002 EQU   @PB00003
@ENDDATA EQU   *
         END   IGC0F05A,(C'PLS2225',0701,78072)

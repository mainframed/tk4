         TITLE 'AHLTSCN - MODULE TO SCAN TRACE OPTIONS                 *
                       '
AHLTSCN  CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'AHLTSCN   73.240'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@12                                         0001
         ST    @13,@SA00001+4                                      0001
         LA    @14,@SA00001                                        0001
         ST    @14,8(,@13)                                         0001
         LR    @13,@14                                             0001
*                                                                  0027
*/********************************************************************/
*/*                                                                  */
*/*                ENTRY POINT---AHLTSCN, SCAN ROUTINE               */
*/*                                                                  */
*/********************************************************************/
*/********************************************************************/
*/*                                                                  */
*/*                 TEST FOR TRACE OPTIONS IN BUFFER                 */
*/*                                                                  */
*/********************************************************************/
*                                                                  0027
*   IF ICTTRCIN='1'B                /* TEST FOR OPS IN BUFF          */
*     THEN                          /* OPTIONS IN BUFFER             */
         L     @03,INITPTR(,PCTPTR)                                0027
         TM    ICTTRCIN(@03),B'00001000'                           0027
         BO    @RT00027                                            0027
*     GO TO SCN06;                  /* SKIP INPUT - PROCESS          */
*                                                                  0028
*/********************************************************************/
*/*                                                                  */
*/*                      TEST FOR PARMLIB INPUT                      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0029
*   IF ICTPLIB='0'B                 /* TEST FOR PARMLIB INPUT        */
*     THEN                          /* NO PARMLIB                    */
         TM    ICTPLIB(@03),B'10000000'                            0029
         BZ    @RT00029                                            0029
*     GO TO SCN04;                  /* ISSUE MSG FOR CONSOLE INPUT 0030
*                                      AND PROCESS                   */
*                                                                  0031
*/********************************************************************/
*/*                                                                  */
*/*                 PARMLIB INPUT-READ FIRST RECORD                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0031
*   ICTMSGX='FF'X;                  /* SET IND FOR MSG IN BUF        */
         MVI   ICTMSGX(@03),X'FF'                                  0031
*   ICTIOTYP=3;                     /* SET IO TYPE-READ PLIB         */
         MVI   ICTIOTYP(@03),X'03'                                 0032
*   CALL AHLTIO;                    /* READ PARMLIB            Y02014*/
*                                                                  0033
         L     @15,@CV00314                                        0033
         BALR  @14,@15                                             0033
*/********************************************************************/
*/*                                                                  */
*/*             TEST FOR I/O ERROR WHEN READING PARMLIB              */
*/*                                                                  */
*/********************************************************************/
*                                                                  0034
*   IF ICTIOERR='0'B                /* TEST FOR READ ERROR           */
*     THEN                          /* NO READ ERROR                 */
         L     @03,INITPTR(,PCTPTR)                                0034
         TM    ICTIOERR(@03),B'01000000'                           0034
         BZ    @RT00034                                            0034
*     GO TO SCN06;                  /* PROCESS INPUT                 */
*   ICTRETRY='1'B;                  /* SET RETRY IND-READ ERROR      */
         OI    ICTRETRY(@03),B'00010000'                           0036
*   GO TO SCN11;                    /* RETURN TO AHLTCTL1            */
         B     SCN11                                               0037
*                                                                  0038
*/********************************************************************/
*/*                                                                  */
*/*                       ISSUE ERROR MESSAGE                        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0038
*SCN02:                                                            0038
*   ICTMSGX=5;                      /* SET NDX FOR AHL104A           */
SCN02    L     @03,INITPTR(,PCTPTR)                                0038
         MVI   ICTMSGX(@03),X'05'                                  0038
*SCN03:                                                            0039
*   IF ICTPLIB='0'B                 /* TEST FOR PARMLIB INPUT        */
*     THEN                          /* NO PARMLIB                    */
SCN03    L     @03,INITPTR(,PCTPTR)                                0039
         TM    ICTPLIB(@03),B'10000000'                            0039
         BZ    @RT00039                                            0039
*     GO TO SCN05;                  /* ISSUE MSG                     */
*   ICTIOTYP=4;                     /* SET IO TYPE FOR WRITING TO  0041
*                                      PROGRAMMER              Y02014*/
         MVI   ICTIOTYP(@03),X'04'                                 0041
*   CALL AHLTIO;                    /* ISSUE MSG               Y02014*/
         L     @15,@CV00314                                        0042
         BALR  @14,@15                                             0042
*   ICTMSGX=22;                     /* SET NDX FOR AHL124I           */
         L     @03,INITPTR(,PCTPTR)                                0043
         MVI   ICTMSGX(@03),X'16'                                  0043
*   ICTIOTYP=2;                     /* SET IO TYPE FOR WTO           */
         MVI   ICTIOTYP(@03),X'02'                                 0044
*   CALL AHLTIO;                    /* ISSUE MSG                     */
         L     @15,@CV00314                                        0045
         BALR  @14,@15                                             0045
*   ICTRETRY='1'B;                  /* SET BIT FOR RETRY             */
         L     @03,INITPTR(,PCTPTR)                                0046
         OI    ICTRETRY(@03),B'00010000'                           0046
*   GO TO SCN11;                    /* RETURN TO AHLTCTL             */
         B     SCN11                                               0047
*                                                                  0048
*/********************************************************************/
*/*                                                                  */
*/*             ISSUE MESSAGE FOR TRACE OPTIONS OR ERROR             */
*/*                                                                  */
*/********************************************************************/
*                                                                  0048
*SCN04:                                                            0048
*   ICTMSGX=1;                      /* SET NDX FOR AHL100A           */
SCN04    L     @03,INITPTR(,PCTPTR)                                0048
         MVI   ICTMSGX(@03),X'01'                                  0048
*SCN05:                                                            0049
*   ICTIOTYP=1;                     /* SET IO TYPE FOR WTOR          */
SCN05    L     @03,INITPTR(,PCTPTR)                                0049
         MVI   ICTIOTYP(@03),X'01'                                 0049
*   CALL AHLTIO;                    /* ISSUE MSG                     */
*                                                                  0050
         L     @15,@CV00314                                        0050
         BALR  @14,@15                                             0050
*/********************************************************************/
*/*                                                                  */
*/*                     TEST FOR STOP ECB POSTED                     */
*/*                                                                  */
*/********************************************************************/
*                                                                  0051
*   IF ICTSTOP='1'B                 /* TEST FOR STOP ECB POST        */
*     THEN                          /* STOP ECB POSTED               */
         L     @03,INITPTR(,PCTPTR)                                0051
         TM    ICTSTOP(@03),B'00000100'                            0051
         BNO   @RF00051                                            0051
*     DO;                                                          0052
*       RTRNCODE=12;                /* SET RTRN CODE TO STOP         */
         LA    RTRNCODE,12                                         0053
*       GO TO SCN11A;               /* RETURN TO AHLTCTL             */
         B     SCN11A                                              0054
*     END;                                                         0055
*                                                                  0056
*/********************************************************************/
*/*                                                                  */
*/*                          PROCESS INPUT                           */
*/*                                                                  */
*/********************************************************************/
*                                                                  0056
*SCN06:                                                            0056
*   EODIND=0;                       /* SET IND-NOT END OF DATA       */
@RF00051 DS    0H                                                  0056
SCN06    SR    EODIND,EODIND                                       0056
*   GTFOPIND(1:3)=                  /* CLEAR OP INDS           Y02014*/
*       ZEROWD(1:3);                                               0057
*                                                                  0057
         L     @04,INITPTR(,PCTPTR)                                0057
         MVC   GTFOPIND(3,@04),ZEROWD                              0057
*/********************************************************************/
*/*                                                                  */
*/*     SEARCH FOR 1ST NON-BLANK CHARACTER IN REPLY FROM OPERATOR    */
*/*                                                                  */
*/********************************************************************/
*                                                                  0058
*   DO I=1 TO 123 BY 1;             /* SEARCH TO END OF BUFF         */
*                                                                  0058
         LA    I,1                                                 0058
@DL00058 DS    0H                                                  0059
*/********************************************************************/
*/*                                                                  */
*/*               TEST FOR NON-BLANK CHARACTER IN REPLY              */
*/*                                                                  */
*/********************************************************************/
*                                                                  0059
*     IF MSGREPLY(I)^=BLANK(1)      /* TEST FOR NON-BLANK      Y02014*/
*       THEN                        /* CONTINUE TO PROCESS           */
         L     @04,INITPTR(,PCTPTR)                                0059
         ALR   @04,I                                               0059
         CLC   MSGREPLY-1(1,@04),BLANK                             0059
         BNE   @RT00059                                            0059
*       GO TO SCN07;                /* SEARCH FOR DELIMITER          */
*   END;                                                           0061
         AH    I,@CH00056                                          0061
         CH    I,@CH00352                                          0061
         BNH   @DL00058                                            0061
*   GO TO SCN02;                    /* ISSUE MSG AHL104A       Y02014*/
         B     SCN02                                               0062
*SCN07:                                                            0063
*   N=I;                            /* SAVE PSN OF KEYWD BEGIN       */
*                                                                  0063
SCN07    LR    N,I                                                 0063
*/********************************************************************/
*/*                                                                  */
*/*               SEARCH FOR DELIMITER -=- AFTER KEYWORD             */
*/*                                                                  */
*/********************************************************************/
*                                                                  0064
*   DO I=N                          /* SEARCH FROM BEGINNING         */
*         TO 123 BY 1;              /* OF KEYWD TO END OF BUFF       */
*                                                                  0064
         LR    I,N                                                 0064
         B     @DE00064                                            0064
@DL00064 DS    0H                                                  0065
*/********************************************************************/
*/*                                                                  */
*/*  TEST FOR BLANK AFTER KEYWORD, BEFORE = SIGN                     */
*/*                                                                  */
*/********************************************************************/
*                                                                  0065
*     IF MSGREPLY(I)=BLANK(1)       /* TEST FOR BLANK          Y02014*/
*       THEN                        /* ERROR IF BLANK                */
         L     @15,INITPTR(,PCTPTR)                                0065
         LR    @14,@15                                             0065
         ALR   @14,I                                               0065
         CLC   MSGREPLY-1(1,@14),BLANK                             0065
         BE    @RT00065                                            0065
*       GO TO SCN02;                /* ISSUE MSG AHL104A       Y02014*/
*                                                                  0066
*/********************************************************************/
*/*                                                                  */
*/*  TEST FOR DELIMITER IMMEDIATELY AFTER KEYWORD                    */
*/*                                                                  */
*/********************************************************************/
*                                                                  0067
*     IF MSGREPLY(I)='='            /* TEST FOR = SIGN         Y02014*/
*       THEN                        /* CONTINUE TO PROCESS           */
         ALR   @15,I                                               0067
         CLI   MSGREPLY-1(@15),C'='                                0067
         BE    @RT00067                                            0067
*       GO TO SCN08;                /* CHECK KEYWD LENGTH            */
*   END;                                                           0069
         AH    I,@CH00056                                          0069
@DE00064 CH    I,@CH00352                                          0069
         BNH   @DL00064                                            0069
*   GO TO SCN02;                    /* ISSUE MSG AHL104A       Y02014*/
*                                                                  0070
         B     SCN02                                               0070
*/********************************************************************/
*/*                                                                  */
*/*  TEST FOR VALID LENGTH OF KEYWORD                                */
*/*                                                                  */
*/********************************************************************/
*                                                                  0071
*SCN08:                                                            0071
*   IF I-N^=5                       /* TEST KEYWD LEN NOT=5          */
*     THEN                          /* ERROR IF NOT 5                */
SCN08    LR    @15,I                                               0071
         SR    @15,N                                               0071
         CH    @15,@CH00339                                        0071
         BNE   @RT00071                                            0071
*     GO TO SCN02;                  /* ISSUE MSG- RESTART            */
*                                                                  0072
*/********************************************************************/
*/*                                                                  */
*/*  TEST FOR VALID KEYWORD                                          */
*/*                                                                  */
*/********************************************************************/
*                                                                  0073
*   IF MSGREPLY(N:I)^=TRACE         /* TEST FOR KEYWD=TRACE=   Y02014*/
*     THEN                          /* ERROR IF NOT =                */
         L     @01,INITPTR(,PCTPTR)                                0073
         ALR   @01,N                                               0073
         EX    @15,@SC00416                                        0073
         BNE   @RT00073                                            0073
*     GO TO SCN02;                  /* ISSUE MSG - RESTART           */
*SCN09:                                                            0075
*   N=I+1;                          /* SAVE PSN OF BEGINNING OF    0075
*                                      OPTION KEYWORD                */
*                                                                  0075
SCN09    LA    N,1                                                 0075
         AR    N,I                                                 0075
*/********************************************************************/
*/*                                                                  */
*/*  SEARCH FOR END OF OPTION KEYWORD                                */
*/*                                                                  */
*/********************************************************************/
*                                                                  0076
*   DO I=N                          /* SEARCH FROM BEGINNING         */
*         TO 123 BY 1;              /* OF KEYWD TO END OF BUFF       */
*                                                                  0076
         LR    I,N                                                 0076
         B     @DE00076                                            0076
@DL00076 DS    0H                                                  0077
*/********************************************************************/
*/*                                                                  */
*/*  TEST FOR END OF REPLY                                           */
*/*                                                                  */
*/********************************************************************/
*                                                                  0077
*     IF MSGREPLY(I)=BLANK(1)       /* BLANK MEANS END DATA    Y02014*/
*       THEN                        /* SET INDICATOR                 */
         L     @01,INITPTR(,PCTPTR)                                0077
         ALR   @01,I                                               0077
         CLC   MSGREPLY-1(1,@01),BLANK                             0077
         BNE   @RF00077                                            0077
*       DO;                                                        0078
*         EODIND=1;                 /* SET IND FOR END DATA          */
         LA    EODIND,1                                            0079
*         GO TO SCN10;              /* TEST FOR ERROR                */
         B     SCN10                                               0080
*       END;                                                       0081
*                                                                  0081
*/********************************************************************/
*/*                                                                  */
*/*  TEST FOR OPTION SEPARATOR DELIMITER                             */
*/*                                                                  */
*/********************************************************************/
*                                                                  0082
*     IF MSGREPLY(I)=','            /* TEST FOR COMMA          Y02014*/
*       THEN                        /* CONTINUE PROCESSING           */
@RF00077 L     @01,INITPTR(,PCTPTR)                                0082
         ALR   @01,I                                               0082
         CLI   MSGREPLY-1(@01),C','                                0082
         BE    @RT00082                                            0082
*       GO TO SCN10;                /* TEST FOR ERROR                */
*   END;                                                           0084
*                                                                  0084
         AH    I,@CH00056                                          0084
@DE00076 CH    I,@CH00352                                          0084
         BNH   @DL00076                                            0084
*/********************************************************************/
*/*                                                                  */
*/*  TEST FOR IMPROPER DELIMITER OR NO OPTIONS                       */
*/*                                                                  */
*/********************************************************************/
*                                                                  0085
*SCN10:                                                            0085
*   IF I-N=0                        /* TEST FOR INVALID LEN          */
*     THEN                          /* CONTINUE CHECK                */
SCN10    SR    @15,@15                                             0085
         LR    @14,I                                               0085
         SR    @14,N                                               0085
         CR    @14,@15                                             0085
         BNE   @RF00085                                            0085
*     DO;                                                          0086
*                                                                  0086
*/********************************************************************/
*/*                                                                  */
*/*  TEST FOR SYNTAX ERROR - IMPROPER DELIMITER                      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0087
*       IF EODIND=0                 /* TEST FOR NO DATA END          */
*         THEN                                                     0087
         CR    EODIND,@15                                          0087
         BNE   @RF00087                                            0087
*         DO;                                                      0088
*           ICTMSGX=6;              /* SET INDEX FOR AHL105A         */
         L     @03,INITPTR(,PCTPTR)                                0089
         MVI   ICTMSGX(@03),X'06'                                  0089
*           GO TO SCN03;            /* ISSUE MSG - RESTART           */
         B     SCN03                                               0090
*         END;                                                     0091
*                                                                  0091
*/********************************************************************/
*/*                                                                  */
*/*  TEST FOR NO OPTIONS OR IMPROPER DELIMITER                       */
*/*                                                                  */
*/********************************************************************/
*                                                                  0092
*       IF MSGREPLY(I-1)=','        /* TEST FOR IMPRPR DELIM   Y02014*/
*         THEN                      /* IMPROPER DELIMITER            */
@RF00087 L     @15,INITPTR(,PCTPTR)                                0092
         LR    @14,@15                                             0092
         ALR   @14,I                                               0092
         CLI   MSGREPLY-2(@14),C','                                0092
         BNE   @RF00092                                            0092
*         ICTMSGX=6;                /* SET INDEX FOR AHL105A         */
         MVI   ICTMSGX(@15),X'06'                                  0093
*       ELSE                        /* NO OPTIONS SPECIFIED          */
*         ICTMSGX=7;                /* SET INDEX FOR AHL106A         */
         B     @RC00092                                            0094
@RF00092 L     @03,INITPTR(,PCTPTR)                                0094
         MVI   ICTMSGX(@03),X'07'                                  0094
*       GO TO SCN03;                /* ISSUE MSG - RESTART           */
         B     SCN03                                               0095
*     END;                                                         0096
*   OPTION=BLANK;                   /* CLEAR OPTION HOLD AREA        */
*                                                                  0097
@RF00085 MVC   OPTION(4),BLANK                                     0097
*/********************************************************************/
*/*                                                                  */
*/*  TEST FOR VALID OPTION LENGTH--NOT GREATER THAN MAXIMUM          */
*/*                                                                  */
*/********************************************************************/
*                                                                  0098
*   IF I-N>4                        /* TEST FOR OP LEN > MAX         */
*     THEN                          /* OP LEN > MAX                  */
         LR    @15,I                                               0098
         SR    @15,N                                               0098
         CH    @15,@CH00069                                        0098
         BNH   @RF00098                                            0098
*     DO;                                                          0099
*       OPTION=                     /* PLACE OP IN HOLD AREA         */
*           MSGREPLY(N:N+3);        /*                         Y02014*/
         L     @05,INITPTR(,PCTPTR)                                0100
         ALR   @05,N                                               0100
         MVC   OPTION(4),MSGREPLY-1(@05)                           0100
*       GO TO SCN12;                /* ISSUE MSG - RESTART           */
         B     SCN12                                               0101
*     END;                                                         0102
*                                                                  0102
*/********************************************************************/
*/*                                                                  */
*/*  TEST FOR VALID OPTION LENGTH--NOT LESS THAN MINIMUM             */
*/*                                                                  */
*/********************************************************************/
*                                                                  0103
*   IF I-N<2                        /* TEST FOR OP LEN < MIN         */
*     THEN                          /* OP LEN < MIN                  */
@RF00098 LR    @15,I                                               0103
         SR    @15,N                                               0103
         CH    @15,@CH00345                                        0103
         BNL   @RF00103                                            0103
*     DO;                                                          0104
*       OPTION(1)=                  /* PLACE OP IN HOLD AREA         */
*           MSGREPLY(N);            /*                         Y02014*/
         L     @05,INITPTR(,PCTPTR)                                0105
         ALR   @05,N                                               0105
         MVC   OPTION(1),MSGREPLY-1(@05)                           0105
*       GO TO SCN12;                /* ISSUE MSG - RESTART           */
         B     SCN12                                               0106
*     END;                                                         0107
*   OPTION=MSGREPLY(N:I-1);         /* PLACE OPTION IN HOLD AREA FROM
*                                      BUFFER                  Y02014*/
@RF00103 MVI   OPTION+1,C' '                                       0108
         MVC   OPTION+2(2),OPTION+1                                0108
         LR    @15,I                                               0108
         SR    @15,N                                               0108
         BCTR  @15,0                                               0108
         L     @01,INITPTR(,PCTPTR)                                0108
         ALR   @01,N                                               0108
         EX    @15,@SM00418                                        0108
*                                                                  0109
*/********************************************************************/
*/*                                                                  */
*/*  SEARCH FOR OPTION SPECIFIED IN OPTION TABLE                     */
*/*                                                                  */
*/********************************************************************/
*                                                                  0109
*   DO N=1 TO 20 BY 1;              /* SEARCH FOR VALID OP           */
*                                                                  0109
         LA    N,1                                                 0109
@DL00109 DS    0H                                                  0110
*/********************************************************************/
*/*                                                                  */
*/*  TEST FOR VALID OPTION                                           */
*/*                                                                  */
*/********************************************************************/
*                                                                  0110
*     IF SCNOPTAB(N)=OPTION         /* TEST FOR VALID OPTION         */
*       THEN                        /* OPTION FOUND                  */
         LR    @15,N                                               0110
         SLA   @15,2                                               0110
         LA    @14,SCNOPTAB-4(@15)                                 0110
         CLC   0(4,@14),OPTION                                     0110
         BNE   @RF00110                                            0110
*       DO;                                                        0111
*                                                                  0111
*/********************************************************************/
*/*                                                                  */
*/*               SET GTFOPIND BIT FOR THIS OPTION                   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0112
*         RFY                                                      0112
*          (GTFOPADR,                                              0112
*           BYTEREG)RSTD;           /* RESTRICT REGS           Y02014*/
*         GTFOPADR=ADDR(GTFOPIND);  /* SET PTR TO ADDR OF INDS IN  0113
*                                      GTFPCT                  Y02014*/
         L     GTFOPADR,INITPTR(,PCTPTR)                           0113
         LA    GTFOPADR,GTFOPIND(,GTFOPADR)                        0113
*         BYTEREG=N-1;              /* SET PTR TO PSN OF OP IN     0114
*                                      SCNOPTAB - 1                  */
*                                                                  0114
         LR    BYTEREG,N                                           0114
         BCTR  BYTEREG,0                                           0114
*/********************************************************************/
*/*                                                                  */
*/*  COMPUTE BYTE PSN IN GTFOPIND FOR THIS OPTION, COMPUTE MASK TO   */
*/*  TURN ON BIT FOR THIS OPTION                               Y02014*/
*/*                                                                  */
*/********************************************************************/
*                                                                  0115
*         GENERATE;                                                0115
                  SRDL  BYTEREG,3     COMPUTE BYTE PSN OF OP
                  SRL   MOVNUM,29      COMPUTE BIT PSN OF OP
                  AR    BYTEREG,GTFOPADR    COMP BYTE PSN IN GTFOPIND
*                                                                Y02014
                  LA    MASKREG,X'80'      SETUP MASK
                  SRL   MASKREG,0(MOVNUM)    SET MASK
*                                                                Y02014
                  EX    MASKREG,BITON       TURN '1'B BIT FOR THIS OP
*                                           IN GTFOPIND          Y02014
*         RFY                                                      0116
*          (GTFOPADR,                                              0116
*           BYTEREG)UNRSTD;         /* UNRESTRICT REGS         Y02014*/
*                                                                  0116
*/********************************************************************/
*/*                                                                  */
*/*  TEST FOR END OF PARAMETERS                                      */
*/*                                                                  */
*/********************************************************************/
*                                                                  0117
*         IF EODIND^=1              /* TEST FOR END OF DATA          */
*           THEN                    /* CONTINUE IF NOT END           */
         CH    EODIND,@CH00056                                     0117
         BNE   @RT00117                                            0117
*           GO TO SCN09;            /* TO NEXT PARAMETER             */
*                                                                  0118
*/********************************************************************/
*/*                                                                  */
*/*           TEST FOR OPTIONS OTHER THAN TRC OR PCI                 */
*/*                                                                  */
*/********************************************************************/
*                                                                  0119
*         IF(GTFOPT1&'F6'X)=0       /* TEST FOR OPTIONS OTHER  Y02014*/
*             &GTFOPT2=0            /* THAN TRC OR PCI         Y02014*/
*             &(GTFOPT3&'F0'X)=0    /* BEING ON                Y02014*/
*           THEN                    /* NO OTHER OPTIONS              */
         SR    @03,@03                                             0119
         L     @15,INITPTR(,PCTPTR)                                0119
         LA    @14,246                                             0119
         SR    @11,@11                                             0119
         IC    @11,GTFOPT1(,@15)                                   0119
         NR    @14,@11                                             0119
         CR    @14,@03                                             0119
         BNE   @RF00119                                            0119
         CLI   GTFOPT2(@15),0                                      0119
         BNE   @RF00119                                            0119
         LA    @14,240                                             0119
         SR    @11,@11                                             0119
         IC    @11,GTFOPT3(,@15)                                   0119
         NR    @14,@11                                             0119
         CR    @14,@03                                             0119
         BNE   @RF00119                                            0119
*           DO;                                                    0120
*             ICTMSGX=24;           /* SET NDX FOR AHL126A           */
         MVI   ICTMSGX(@15),X'18'                                  0121
*             GO TO SCN03;          /* ISSUE MSG                     */
         B     SCN03                                               0122
*           END;                                                   0123
*                                                                  0124
*/********************************************************************/
*/*                                                                  */
*/*               CALL ANALYSIS SUBROUTINE TO PROCESS                */
*/*         MUTUALLY EXCLUSIVE OPTIONS AND RETURN TO AHLTCTL1  Y02014*/
*/*                                                                  */
*/********************************************************************/
*                                                                  0124
*         CALL AHLTANL;             /* TO ANALYSIS ROUTINE           */
@RF00119 BAL   @14,AHLTANL                                         0124
*SCN11:                                                            0125
*         RTRNCODE=0;               /* SET RETURN CODE FOR CONTINUE  */
SCN11    SR    RTRNCODE,RTRNCODE                                   0125
*SCN11A:                                                           0126
*         GPRS15=RTRNCODE;          /* RTRNCODE TO SAVE AREA M1402   */
SCN11A   L     @01,CALLRSA1(,SAVR)                                 0126
         ST    RTRNCODE,GPRS15(,@01)                               0126
*         RETURN;                   /* RETURN TO AHLTCTL             */
@EL00001 L     @13,4(,@13)                                         0127
@EF00001 DS    0H                                                  0127
@ER00001 LM    @14,@12,12(@13)                                     0127
         BR    @14                                                 0127
*       END;                                                       0128
*   END;                                                           0129
@RF00110 AH    N,@CH00056                                          0129
         CH    N,@CH00279                                          0129
         BNH   @DL00109                                            0129
*                                                                  0130
*/********************************************************************/
*/*                                                                  */
*/*        SETUP MESSAGE AHL108A, INVALID OPT SPECIFIED        Y02014*/
*/*                                                                  */
*/********************************************************************/
*                                                                  0130
*SCN12:                                                            0130
*   ICTMSGX=9;                      /* SET INDEX FOR AHL108A         */
SCN12    L     @03,INITPTR(,PCTPTR)                                0130
         MVI   ICTMSGX(@03),X'09'                                  0130
*   TWTBUF(1:152)='';               /* CLEAR TWTBUF W/BLANKS   Y02014*/
         MVI   TWTBUF(@03),C' '                                    0131
         MVC   TWTBUF+1(151,@03),TWTBUF(@03)                       0131
*   CALL AHLCTL2;                   /* GET MSG                 Y02014*/
         L     @15,@CV00313                                        0132
         BALR  @14,@15                                             0132
*   OP108=OPTION;                   /* INVALID OP TO BUFFER          */
         L     @03,INITPTR(,PCTPTR)                                0133
         MVC   OP108(4,@03),OPTION                                 0133
*   ICTMSGX='FF'X;                  /* SET INDEX FOR MSG IN BUFFER   */
         MVI   ICTMSGX(@03),X'FF'                                  0134
*   GO TO SCN03;                    /* ISSUE MSG - RESTART           */
         B     SCN03                                               0135
*                                                                  0136
*/********************************************************************/
*/*                                                                  */
*/*  TURN BIT IN GTFOPIND -- THIS INSTR IS OBJ OF AN EXECUTE   Y02014*/
*/*                                                                  */
*/********************************************************************/
*                                                                  0136
*BITON:                                                            0136
*   GENERATE;                                                      0136
BITON    DS    0H                                                  0136
*                                   /* TURN ON BIT                   */
    OI 0(BYTEREG),0
*                                                                  0137
*/********************************************************************/
*/*                                                                  */
*/*              BEGIN AHLTANL ROUTINE  -  AHLTSCN MODULE            */
*/*                                                                  */
*/********************************************************************/
*                                                                  0137
*AHLTANL:                                                          0137
*   PROC OPTIONS(NOSAVEAREA);       /* DEFINE PROC OPTIONS           */
*                                                                  0137
         B     @PB00002                                            0137
AHLTANL  STM   @14,@12,12(@13)                                     0137
*/********************************************************************/
*/*                                                                  */
*/*                        AHLTANL ENTRY POINT                       */
*/*                                                                  */
*/********************************************************************/
*                                                                  0138
*   PCTCATF=0;                      /* CLEAR FUNCTION DISABLED BITS
*                                                              Y02014*/
*                                                                  0138
         SR    @03,@03                                             0138
         ST    @03,PCTCATF(,PCTPTR)                                0138
*/********************************************************************/
*/*                                                                  */
*/*  TEST FOR SYSM OPTION                                            */
*/*                                                                  */
*/********************************************************************/
*                                                                  0139
*   IF GTFSYSM='0'B                 /* TEST FOR SYSM OFF       Y02014*/
*     THEN                          /* SYSM OFF                      */
         L     @03,INITPTR(,PCTPTR)                                0139
         TM    GTFSYSM(@03),B'10000000'                            0139
         BZ    @RT00139                                            0139
*     GO TO ANL02;                  /* TEST FOR SYSP                 */
*                                                                  0140
*/********************************************************************/
*/*                                                                  */
*/*                  SET INDICATORS FOR SYSM OPTION                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0141
*   GTFOPT1=GTFOPT1&'9F'X;          /* TURN OFF SYSP,SYS IN GTFOPIND */
         LA    @15,159                                             0141
         SR    @14,@14                                             0141
         IC    @14,GTFOPT1(,@03)                                   0141
         NR    @15,@14                                             0141
         STC   @15,GTFOPT1(,@03)                                   0141
*                                   /*                         Y02014*/
*   GTFOPT2='00'X;                  /* CLEAR 2ND BYTE OF OPND  Y02014*/
         MVI   GTFOPT2(@03),X'00'                                  0142
*   GTFEXT='0'B;                    /* CLEAR EXT&RR BITS-SYSM  Y02014*/
*                                   /* OPTION AUTOMATICALLY    Y02014*/
*   GTFRR='0'B;                     /* GIVES EXT AND RR        Y02014*/
*                                                                  0144
         NI    GTFEXT(@03),B'01101111'                             0144
*/*************************************************************Y02014*/
*/*                                                            Y02014*/
*/* THE FOLLOWING DEFINES A LOCAL INCLUDE.  THIS CODE WHEN     Y02014*/
*/* INCLUDED, SETS THE DEFAULT OPTIONS IMPLIED BY THE          Y02014*/
*/* SYS, SYSM, OR SYSP OPTIONS IN THE PCTCATF FIELD.           Y02014*/
*/*                                                            Y02014*/
*/*************************************************************Y02014*/
*                                                                  0145
*   PCTSVC='1'B;                    /* SET SVC ACTIVE          Y02014*/
*   PCTEXT='1'B;                    /* SET EXT ACTIVE          Y02014*/
*   PCTIO='1'B;                     /* SET IO ACTIVE           Y02014*/
*   PCTSIO='1'B;                    /* SET SIO ACTIVE          Y02014*/
*   PCTPI='1'B;                     /* SET PI ACTIVE           Y02014*/
         OI    PCTSVC(PCTPTR),B'11110010'                          0149
*   PCTRR='1'B;                     /* SET RR ACTIVE           Y02014*/
         OI    PCTRR(PCTPTR),B'00100000'                           0150
*   GO TO ANL10;                    /* GO CHECK OTHER OPTIONS  Y02014*/
         B     ANL10                                               0151
*                                                                  0152
*/********************************************************************/
*/*                                                                  */
*/*  TEST FOR SYSP OPTION                                            */
*/*                                                                  */
*/********************************************************************/
*                                                                  0152
*ANL02:                                                            0152
*   IF GTFSYSP='1'B                 /* TEST FOR SYSP ON        Y02014*/
*     THEN                          /* SYSP ON                       */
ANL02    L     @03,INITPTR(,PCTPTR)                                0152
         TM    GTFSYSP(@03),B'01000000'                            0152
         BNO   @RF00152                                            0152
*     DO;                                                          0153
*                                                                  0153
*/********************************************************************/
*/*                                                                  */
*/*  SET INDICATORS FOR SYSP                                         */
*/*                                                                  */
*/********************************************************************/
*                                                                  0154
*       GTFOPT1=GTFOPT1             /* TURN OFF SYSM AND SYS   Y02014*/
*           &'5F'X;                 /* IN GTFOPIND             Y02014*/
         LA    @15,95                                              0154
         SR    @14,@14                                             0154
         IC    @14,GTFOPT1(,@03)                                   0154
         NR    @15,@14                                             0154
         STC   @15,GTFOPT1(,@03)                                   0154
*       GTFOPT2='00'X;              /* CLEAR 2ND BYTE OF OPND  Y02014*/
         SR    @15,@15                                             0155
         STC   @15,GTFOPT2(,@03)                                   0155
*       GTFEXT='0'B;                /* TURN OFF EXT & RR BITS  Y02014*/
*       GTFRR='0'B;                 /* SYSP OPTION AUTO-       Y02014*/
         NI    GTFEXT(@03),B'01101111'                             0157
*                                   /* MATICALLY GIVES EXT RR  Y02014*/
*       GTFOPT2=GTFOPT2             /* TURN ON SVCP,SIOP,PIP,  Y02014*/
*           '55'X;                 /* IOP IN GTFOPIND         Y02014*/
*                                                                  0158
         O     @15,@CF00383                                        0158
         STC   @15,GTFOPT2(,@03)                                   0158
*/*************************************************************Y02014*/
*/*                                                            Y02014*/
*/* THE FOLLOWING DEFINES A LOCAL INCLUDE.  THIS CODE WHEN     Y02014*/
*/* INCLUDED, SETS THE DEFAULT OPTIONS IMPLIED BY THE          Y02014*/
*/* SYS, SYSM, OR SYSP OPTIONS IN THE PCTCATF FIELD.           Y02014*/
*/*                                                            Y02014*/
*/*************************************************************Y02014*/
*                                                                  0159
*       PCTSVC='1'B;                /* SET SVC ACTIVE          Y02014*/
*       PCTEXT='1'B;                /* SET EXT ACTIVE          Y02014*/
*       PCTIO='1'B;                 /* SET IO ACTIVE           Y02014*/
*       PCTSIO='1'B;                /* SET SIO ACTIVE          Y02014*/
*       PCTPI='1'B;                 /* SET PI ACTIVE           Y02014*/
         OI    PCTSVC(PCTPTR),B'11110010'                          0163
*       PCTRR='1'B;                 /* SET RR ACTIVE           Y02014*/
*       PCTIOF='1'B;                /* SET IO FILTER BIT       Y02014*/
*       PCTSIOF='1'B;               /* SET SIO FILTER BIT      Y02014*/
*       PCTSVCF='1'B;               /* SET SVC FILTER BIT      Y02014*/
*       PCTPIF='1'B;                /* SET PI FILTER BIT       Y02014*/
         OI    PCTRR(PCTPTR),B'00111110'                           0168
*       GO TO ANL10;                /* CHECK OTHER OPTIONS     Y02014*/
         B     ANL10                                               0169
*     END;                                                         0170
*                                                                  0171
*/********************************************************************/
*/*                                                                  */
*/*  TEST FOR SYS OPTION                                             */
*/*                                                                  */
*/********************************************************************/
*                                                                  0171
*   IF GTFSYS='1'B                  /* TEST FOR SYS ON         Y02014*/
*     THEN                          /* SYS ON                        */
*                                                                  0171
@RF00152 L     @03,INITPTR(,PCTPTR)                                0171
         TM    GTFSYS(@03),B'00100000'                             0171
         BNO   @RF00171                                            0171
*/********************************************************************/
*/*                                                                  */
*/*                  SET INDICATORS FOR SYS OPTION                   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0172
*     DO;                                                          0172
*       GTFOPT1=GTFOPT1             /* TURN OFF SYSM,SYSP      Y02014*/
*           &'3F'X;                 /* IN GTFOPIND             Y02014*/
         LA    @15,63                                              0173
         SR    @14,@14                                             0173
         IC    @14,GTFOPT1(,@03)                                   0173
         NR    @15,@14                                             0173
         STC   @15,GTFOPT1(,@03)                                   0173
*       GTFOPT2='00'X;              /* CLEAR 2ND BYTE OF OPND  Y02014*/
         MVI   GTFOPT2(@03),X'00'                                  0174
*       GTFEXT='0'B;                /* TURN OFF EXT & RR BITS  Y02014*/
*       GTFRR='0'B;                 /* SYS OPTION AUTO-        Y02014*/
         NI    GTFEXT(@03),B'01101111'                             0176
*                                   /* MATICALLY GIVES EXT     Y02014*/
*                                                                  0177
*/*************************************************************Y02014*/
*/*                                                            Y02014*/
*/* THE FOLLOWING DEFINES A LOCAL INCLUDE.  THIS CODE WHEN     Y02014*/
*/* INCLUDED, SETS THE DEFAULT OPTIONS IMPLIED BY THE          Y02014*/
*/* SYS, SYSM, OR SYSP OPTIONS IN THE PCTCATF FIELD.           Y02014*/
*/*                                                            Y02014*/
*/*************************************************************Y02014*/
*                                                                  0177
*       PCTSVC='1'B;                /* SET SVC ACTIVE          Y02014*/
*       PCTEXT='1'B;                /* SET EXT ACTIVE          Y02014*/
*       PCTIO='1'B;                 /* SET IO ACTIVE           Y02014*/
*       PCTSIO='1'B;                /* SET SIO ACTIVE          Y02014*/
*       PCTPI='1'B;                 /* SET PI ACTIVE           Y02014*/
         OI    PCTSVC(PCTPTR),B'11110010'                          0181
*       PCTRR='1'B;                 /* SET RR ACTIVE           Y02014*/
         OI    PCTRR(PCTPTR),B'00100000'                           0182
*       GOTO ANL10;                 /* CHECK OTHER OPTIONS     Y02014*/
         B     ANL10                                               0183
*     END;                                                         0184
*                                                                  0185
*/********************************************************************/
*/*                                                                  */
*/*  TEST FOR IO PROMPTING                                           */
*/*                                                                  */
*/********************************************************************/
*                                                                  0185
*IOPMP:                                                            0185
*   IF GTFIOP='1'B                  /* TEST FOR IO PROMPTING   Y02014*/
*     THEN                                                         0185
@RF00171 DS    0H                                                  0185
IOPMP    L     @03,INITPTR(,PCTPTR)                                0185
         TM    GTFIOP(@03),B'00000001'                             0185
         BO    @RT00185                                            0185
*     GO TO IOFRTN;                 /* SET ON APPROPRIATE BITS Y02014*/
*                                                                  0186
*/********************************************************************/
*/*                                                                  */
*/*  TEST FOR IO ALL OPTION                                          */
*/*                                                                  */
*/********************************************************************/
*                                                                  0187
*   IF GTFIO='1'B                   /* IS IO ALL BIT ON        Y02014*/
*     THEN                          /* YES                     Y02014*/
         TM    GTFIO(@03),B'00000010'                              0187
         BO    @RT00187                                            0187
*     GO TO IORTN;                  /* SET APPROPRIATE BITS    Y02014*/
*   IF GTFSYS^='1'B                 /* HAS IO BEEN REQUESTED ANOTHER
*                                      WAY                     Y02014*/
*       GTFSYSM^='1'BGTFSYSP^='1'B THEN                          0189
         TM    GTFSYS(@03),B'11100000'                             0189
         BO    @RF00189                                            0189
*     GTFPCI='0'B;                  /* NO, TURN OFF PCI        Y02014*/
         L     @03,INITPTR(,PCTPTR)                                0190
         NI    GTFPCI(@03),B'11111110'                             0190
*   GO TO ANL05;                    /* TEST FOR SVC PROMPT     Y02014*/
         B     ANL05                                               0191
*IOFRTN:                            /*                         Y02014*/
*   GTFIO='0'B;                     /* TURN OFF IO ALL BIT           */
IOFRTN   L     @03,INITPTR(,PCTPTR)                                0192
         NI    GTFIO(@03),B'11111101'                              0192
*   PCTIOF='1'B;                    /* TURN ON CATF IO FILTER  Y02014*/
         OI    PCTIOF(PCTPTR),B'00001000'                          0193
*IORTN:                             /*                         Y02014*/
*   PCTIO='1'B;                     /* TURN ON CATF IO ALL BIT Y02014*/
IORTN    OI    PCTIO(PCTPTR),B'00100000'                           0194
*                                                                  0195
*/********************************************************************/
*/*                                                                  */
*/*  TEST FOR SVC PROMPTING                                          */
*/*                                                                  */
*/********************************************************************/
*                                                                  0195
*ANL05:                                                            0195
*   IF GTFSVCP='1'B                 /* TEST FOR SVC PROMPT ON  Y02014*/
*     THEN                          /* SVC PROMPT ON                 */
*                                                                  0195
ANL05    L     @03,INITPTR(,PCTPTR)                                0195
         TM    GTFSVCP(@03),B'01000000'                            0195
         BNO   @RF00195                                            0195
*/********************************************************************/
*/*                                                                  */
*/*                  SET INDICATORS FOR SVC OPTION                   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0196
*     DO;                                                          0196
*       GTFSVC='0'B;                /* TURN OFF SVC ALL        Y02014*/
         NI    GTFSVC(@03),B'01111111'                             0197
*       PCTSVCF='1'B;               /* SET CATF BIT SVC FILTER Y02014*/
         OI    PCTSVCF(PCTPTR),B'00010000'                         0198
*ANL06:                                                            0199
*       PCTSVC='1'B;                /* SET IND FOR AHLTSVC     Y02014*/
ANL06    OI    PCTSVC(PCTPTR),B'10000000'                          0199
*       GO TO ANL07;                /* TEST FOR SIO PROMPT           */
         B     ANL07                                               0200
*     END;                                                         0201
*                                                                  0201
*/********************************************************************/
*/*                                                                  */
*/*  TEST FOR SVC ALL OPTION                                         */
*/*                                                                  */
*/********************************************************************/
*                                                                  0202
*   IF GTFSVC='1'B                  /* TEST FOR SVC ALL ON     Y02014*/
*     THEN                          /* SVC ALL ON                    */
@RF00195 L     @03,INITPTR(,PCTPTR)                                0202
         TM    GTFSVC(@03),B'10000000'                             0202
         BO    @RT00202                                            0202
*     GO TO ANL06;                  /* SET IND FOR SVC ALL     Y02014*/
*                                                                  0204
*/********************************************************************/
*/*                                                                  */
*/*  TEST FOR SIO PROMPTING                                          */
*/*                                                                  */
*/********************************************************************/
*                                                                  0204
*ANL07:                                                            0204
*   IF GTFSIOP='1'B                 /* TEST FOR SIO PROMPT ON  Y02014*/
*     THEN                          /* SIO PROMPT ON                 */
*                                                                  0204
ANL07    L     @03,INITPTR(,PCTPTR)                                0204
         TM    GTFSIOP(@03),B'00010000'                            0204
         BNO   @RF00204                                            0204
*/********************************************************************/
*/*                                                                  */
*/*                   SET INDICATORS FOR SIO OPTION                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0205
*     DO;                                                          0205
*       GTFSIO='0'B;                /* TURN OFF SIO ALL IN GTFOPIND
*                                                              Y02014*/
         NI    GTFSIO(@03),B'11011111'                             0206
*       PCTSIOF='1'B;               /* SET CARF BIT FOR SIO    Y02014*/
         OI    PCTSIOF(PCTPTR),B'00000100'                         0207
*ANL08:                                                            0208
*       PCTSIO='1'B;                /* FILTER AND SIO ALL      Y02014*/
ANL08    OI    PCTSIO(PCTPTR),B'00010000'                          0208
*       GO TO ANL09;                /* TEST FOR PI PROMPTING         */
         B     ANL09                                               0209
*     END;                                                         0210
*                                                                  0210
*/********************************************************************/
*/*                                                                  */
*/*  TEST FOR SIO ALL OPTION                                         */
*/*                                                                  */
*/********************************************************************/
*                                                                  0211
*   IF GTFSIO='1'B                  /* TEST FOR SIO ALL ON     Y02014*/
*     THEN                          /* SIO ALL ON                    */
@RF00204 L     @03,INITPTR(,PCTPTR)                                0211
         TM    GTFSIO(@03),B'00100000'                             0211
         BO    @RT00211                                            0211
*     GO TO ANL08;                  /* GO SET SIO ALL CATF BIT Y02014*/
*                                                                  0213
*/********************************************************************/
*/*                                                                  */
*/*  TEST FOR PI PROMPTING                                           */
*/*                                                                  */
*/********************************************************************/
*                                                                  0213
*ANL09:                                                            0213
*   IF GTFPIP='1'B                  /* TEST FOR PI PROMPT ON   Y02014*/
*     THEN                          /* PI PROMPT ON                  */
ANL09    L     @03,INITPTR(,PCTPTR)                                0213
         TM    GTFPIP(@03),B'00000100'                             0213
         BNO   @RF00213                                            0213
*     DO;                                                          0214
*                                                                  0214
*/********************************************************************/
*/*                                                                  */
*/*                   SET INDICATORS FOR PI OPTION                   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0215
*       GTFPI='0'B;                 /* TURN OFF PI ALL OPTION  Y02014*/
         NI    GTFPI(@03),B'11110111'                              0215
*       PCTPIF='1'B;                /* TURN ON PI FILTER BIT   Y02014*/
         OI    PCTPIF(PCTPTR),B'00000010'                          0216
*ANL095:                                                           0217
*       PCTPI='1'B;                 /* TURN ON PI CATF BIT     Y02014*/
ANL095   OI    PCTPI(PCTPTR),B'00000010'                           0217
*       GO TO ANL10;                /* SET IND FOR AHLTPED           */
         B     ANL10                                               0218
*     END;                                                         0219
*                                                                  0219
*/********************************************************************/
*/*                                                                  */
*/*  TEST FOR PI ALL OPTION                                          */
*/*                                                                  */
*/********************************************************************/
*                                                                  0220
*   IF GTFPI='1'B                   /* TEST FOR PI ALL ON      Y02014*/
*     THEN                          /* PI ALL ON                     */
@RF00213 L     @03,INITPTR(,PCTPTR)                                0220
         TM    GTFPI(@03),B'00001000'                              0220
         BO    @RT00220                                            0220
*     GO TO ANL095;                 /* SET IND. FOR PI ALL     Y02014*/
*                                                                  0221
*/********************************************************************/
*/*                                                                  */
*/*      TEST FOR OTHER OPTIONS DSP, EXT, RR, RNIO, SRM, USR         */
*/*                                                                  */
*/********************************************************************/
*                                                                  0222
*ANL10:                                                            0222
*   IF GTFDSP='1'B                  /* TURN ON CATF BIT FOR DSP IF 0222
*                                      NECESSARY               Y02014*/
*     THEN                                                         0222
ANL10    L     @03,INITPTR(,PCTPTR)                                0222
         TM    GTFDSP(@03),B'00000100'                             0222
         BNO   @RF00222                                            0222
*     PCTDSP='1'B;                  /*                         Y02014*/
         OI    PCTDSP(PCTPTR),B'00001000'                          0223
*   IF GTFEXT='1'B                  /* TURN ON CATF BIT FOR EXT IF 0224
*                                      NECESSARY               Y02014*/
*     THEN                                                         0224
@RF00222 L     @03,INITPTR(,PCTPTR)                                0224
         TM    GTFEXT(@03),B'10000000'                             0224
         BNO   @RF00224                                            0224
*     PCTEXT='1'B;                  /*                         Y02014*/
         OI    PCTEXT(PCTPTR),B'01000000'                          0225
*   IF GTFRR='1'B                   /* TURN ON CATF BIT FOR RR IF  0226
*                                      NECESSARY               Y02014*/
*     THEN                                                         0226
@RF00224 L     @03,INITPTR(,PCTPTR)                                0226
         TM    GTFRR(@03),B'00010000'                              0226
         BNO   @RF00226                                            0226
*     PCTRR='1'B;                   /*                         Y02014*/
         OI    PCTRR(PCTPTR),B'00100000'                           0227
*   IF GTFRNIO='1'B                 /* TURN ON CATF BIT FOR RNIO IF
*                                      NECESSARY               Y02014*/
*     THEN                                                         0228
@RF00226 L     @03,INITPTR(,PCTPTR)                                0228
         TM    GTFRNIO(@03),B'01000000'                            0228
         BNO   @RF00228                                            0228
*     PCTRNIO='1'B;                 /*                         Y02014*/
         OI    PCTRNIO(PCTPTR),B'10000000'                         0229
*   IF GTFSRM='1'B                  /* TURN ON CATF BIT FOR SRM IF 0230
*                                      NECESSARY               Y02014*/
*     THEN                                                         0230
@RF00228 L     @03,INITPTR(,PCTPTR)                                0230
         TM    GTFSRM(@03),B'00100000'                             0230
         BNO   @RF00230                                            0230
*     PCTSRM='1'B;                  /*                         Y02014*/
         OI    PCTSRM(PCTPTR),B'01000000'                          0231
*   IF GTFUSR='1'B                  /* TURN ON CATF BIT FOR USR IF 0232
*                                      NECESSARY               Y02014*/
*     THEN                                                         0232
@RF00230 L     @03,INITPTR(,PCTPTR)                                0232
         TM    GTFUSR(@03),B'00010000'                             0232
         BNO   @RF00232                                            0232
*     PCTUSR='1'B;                  /*                         Y02014*/
         OI    PCTUSR(PCTPTR),B'00000001'                          0233
*   RETURN;                                                        0234
@EL00002 DS    0H                                                  0234
@EF00002 DS    0H                                                  0234
@ER00002 LM    @14,@12,12(@13)                                     0234
         BR    @14                                                 0234
*   END AHLTANL;                    /* RETURN TO AHLTSCN       Y02014*/
         B     @EL00002                                            0235
*   END AHLTSCN                                                    0236
*                                                                  0236
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (INITDATA)                                       */
*/*%INCLUDE SYSLIB  (GTFPCT  )                                       */
*/*%INCLUDE SYSUT5  (SETDEFLT)                                       */
*/*%INCLUDE SYSUT5  (SETDEFLT)                                       */
*/*%INCLUDE SYSUT5  (SETDEFLT)                                       */
*                                                                  0236
*       ;                                                          0236
         B     @EL00001                                            0236
@DATA    DS    0H
@CH00056 DC    H'1'
@CH00345 DC    H'2'
@CH00069 DC    H'4'
@CH00339 DC    H'5'
@CH00279 DC    H'20'
@CH00352 DC    H'123'
@SC00416 CLC   MSGREPLY-1(0,@01),TRACE
@SM00418 MVC   OPTION(0),MSGREPLY-1(@01)
         DS    0F
@SA00001 DS    18F
         DS    0F
@CF00383 DC    XL4'55'
@CV00313 DC    V(AHLCTL2)
@CV00314 DC    V(AHLTIO)
         DS    0D
BLANK    DC    CL4'    '
OPTION   DS    CL4
TRACE    DC    CL6'TRACE='
ZEROWD   DC    X'00000000'
SCNOPTAB DC    CL4'SYSM'
         DC    CL4'SYSP'
         DC    CL4'SYS '
         DC    CL4'USR '
         DC    CL4'TRC '
         DC    CL4'DSP '
         DC    CL4'    '
         DC    CL4'PCI '
         DC    CL4'SVC '
         DC    CL4'SVCP'
         DC    CL4'SIO '
         DC    CL4'SIOP'
         DC    CL4'PI  '
         DC    CL4'PIP '
         DC    CL4'IO  '
         DC    CL4'IOP '
         DC    CL4'EXT '
         DC    CL4'RNIO'
         DC    CL4'SRM'
         DC    CL4'RR'
SCNPTCH  DC    130X'00'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
EODIND   EQU   @05
I        EQU   @03
N        EQU   @04
RTRNCODE EQU   @03
PCTPTR   EQU   @02
GTFOPADR EQU   @06
SAVR     EQU   @13
BYTEREG  EQU   @14
MASKREG  EQU   @07
MOVNUM   EQU   @15
RTRNREG  EQU   @14
INITDATA EQU   0
ICT      EQU   INITDATA+16
ICTMSGX  EQU   ICT
ICTIOTYP EQU   ICT+1
ICTFLAGS EQU   ICT+2
ICTPLIB  EQU   ICTFLAGS
ICTIOERR EQU   ICTFLAGS
ICTRETRY EQU   ICTFLAGS
ICTTRCIN EQU   ICTFLAGS
ICTSTOP  EQU   ICTFLAGS
MSGREPLY EQU   INITDATA+28
GTFOPIND EQU   INITDATA+152
GTFOPT1  EQU   GTFOPIND
GTFSYSM  EQU   GTFOPT1
GTFSYSP  EQU   GTFOPT1
GTFSYS   EQU   GTFOPT1
GTFUSR   EQU   GTFOPT1
GTFDSP   EQU   GTFOPT1
GTFPCI   EQU   GTFOPT1
GTFOPT2  EQU   GTFOPIND+1
GTFSVC   EQU   GTFOPT2
GTFSVCP  EQU   GTFOPT2
GTFSIO   EQU   GTFOPT2
GTFSIOP  EQU   GTFOPT2
GTFPI    EQU   GTFOPT2
GTFPIP   EQU   GTFOPT2
GTFIO    EQU   GTFOPT2
GTFIOP   EQU   GTFOPT2
GTFOPT3  EQU   GTFOPIND+2
GTFEXT   EQU   GTFOPT3
GTFRNIO  EQU   GTFOPT3
GTFSRM   EQU   GTFOPT3
GTFRR    EQU   GTFOPT3
GTFOPT4  EQU   GTFOPIND+3
TWT      EQU   INITDATA+176
TWTBUF   EQU   TWT+40
GTFPCT   EQU   0
GTFSTAT  EQU   GTFPCT+8
GTFOPTS  EQU   GTFPCT+12
GTFOPTS1 EQU   GTFOPTS
GTFOPTS2 EQU   GTFOPTS+1
GTFOPTS3 EQU   GTFOPTS+2
GTFOPTS4 EQU   GTFOPTS+3
PCTCATF  EQU   GTFPCT+16
PCTSVC   EQU   PCTCATF
PCTEXT   EQU   PCTCATF
PCTIO    EQU   PCTCATF
PCTSIO   EQU   PCTCATF
PCTDSP   EQU   PCTCATF
PCTPI    EQU   PCTCATF
PCTUSR   EQU   PCTCATF
PCTRNIO  EQU   PCTCATF+1
PCTSRM   EQU   PCTCATF+1
PCTRR    EQU   PCTCATF+1
PCTSVCF  EQU   PCTCATF+1
PCTIOF   EQU   PCTCATF+1
PCTSIOF  EQU   PCTCATF+1
PCTPIF   EQU   PCTCATF+1
INITPTR  EQU   GTFPCT+60
NEXTBLOK EQU   GTFPCT+180
WRTRCOM  EQU   GTFPCT+204
TRMWRIT  EQU   GTFPCT+212
WRTRERR  EQU   GTFPCT+216
GTFSSRB  EQU   GTFPCT+220
QLOCKWRD EQU   GTFPCT+236
QLOCKECB EQU   GTFPCT+240
AUDITFLG EQU   GTFPCT+296
SCNSAVE  EQU   0
CALLRSA1 EQU   SCNSAVE+4
CLRSAVE  EQU   0
GPRS15   EQU   CLRSAVE+16
OP108    EQU   TWTBUF+49
WTORLEN  EQU   TWTBUF+8
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00013 EQU   CLRSAVE+20
GPRS14   EQU   CLRSAVE+12
CALLDSA2 EQU   CLRSAVE+8
CALLRSA2 EQU   CLRSAVE+4
@NM00012 EQU   CLRSAVE
REGS     EQU   SCNSAVE+12
CALLDSA1 EQU   SCNSAVE+8
@NM00011 EQU   SCNSAVE
PCTWTOMD EQU   GTFPCT+312
PCTDMPMD EQU   GTFPCT+308
TRANSMAX EQU   GTFPCT+304
GTFASCB  EQU   GTFPCT+300
@NM00010 EQU   AUDITFLG+3
AFSLEBLD EQU   AUDITFLG+3
WSERFG06 EQU   AUDITFLG+3
WSERFG05 EQU   AUDITFLG+3
WSERFG04 EQU   AUDITFLG+3
WSERFG03 EQU   AUDITFLG+3
WSERFG02 EQU   AUDITFLG+2
WSERFLAG EQU   AUDITFLG+2
TERMFLAG EQU   AUDITFLG+2
AFXWRIT  EQU   AUDITFLG+2
AFQLWAIT EQU   AUDITFLG+2
AFSLEGET EQU   AUDITFLG+2
AFBUFGET EQU   AUDITFLG+2
AFFEOB   EQU   AUDITFLG+2
AFBLKFIX EQU   AUDITFLG+1
AFEQFIX  EQU   AUDITFLG+1
AFPGRLSE EQU   AUDITFLG+1
AFWRAP   EQU   AUDITFLG+1
AFBUFOFF EQU   AUDITFLG+1
AFLDFX   EQU   AUDITFLG+1
AFCLOSE  EQU   AUDITFLG+1
AFOPEN   EQU   AUDITFLG+1
AFGMBLOK EQU   AUDITFLG
AFGMSRB  EQU   AUDITFLG
AFWAIT   EQU   AUDITFLG
AFTERM   EQU   AUDITFLG
AFINIT   EQU   AUDITFLG
AFWWRIT  EQU   AUDITFLG
AFCWRIT  EQU   AUDITFLG
AFIWRIT  EQU   AUDITFLG
EQSHORT  EQU   GTFPCT+292
SLEMAX   EQU   GTFPCT+288
SLECNT   EQU   GTFPCT+284
RQPURGE  EQU   GTFPCT+280
RQTOTAL  EQU   GTFPCT+276
WRTDLST  EQU   GTFPCT+272
NUMOFBUF EQU   GTFPCT+268
SBUFDISA EQU   GTFPCT+264
SLESUSED EQU   GTFPCT+260
EQMIN    EQU   GTFPCT+256
EQLENGTH EQU   GTFPCT+252
WQMAX    EQU   GTFPCT+248
WQLENGTH EQU   GTFPCT+244
QLECBP   EQU   QLOCKECB
@NM00009 EQU   QLOCKECB
@NM00008 EQU   QLOCKWRD+3
SCHEDBUF EQU   QLOCKWRD+2
POSTWRIT EQU   QLOCKWRD+1
QLOCK    EQU   QLOCKWRD
WRITERDD EQU   GTFPCT+228
GTFLOSTR EQU   GTFPCT+224
SRBAVAIL EQU   GTFSSRB
WRTRERRP EQU   WRTRERR
@NM00007 EQU   WRTRERR
TRMWRITP EQU   TRMWRIT
@NM00006 EQU   TRMWRIT
GTFCMECB EQU   GTFPCT+208
WRTRCOMP EQU   WRTRCOM
@NM00005 EQU   WRTRCOM
TRANSCNT EQU   GTFPCT+200
AHLRDPLQ EQU   GTFPCT+196
SFEOBRTN EQU   GTFPCT+192
SBLOKRTN EQU   GTFPCT+188
CURRBLOK EQU   GTFPCT+184
GBCDS    EQU   NEXTBLOK
WSMODEND EQU   GTFPCT+176
WSMODBEG EQU   GTFPCT+172
BCBPAGE  EQU   GTFPCT+156
SLEPAGE  EQU   GTFPCT+152
SAVECNT  EQU   GTFPCT+148
SLQHEAD  EQU   GTFPCT+144
HQLENGTH EQU   GTFPCT+140
QTAIL    EQU   GTFPCT+136
HQHEAD   EQU   GTFPCT+132
WQHEAD   EQU   GTFPCT+128
RQHEAD   EQU   GTFPCT+124
EQHEAD   EQU   GTFPCT+120
WPOSTSRB EQU   GTFPCT+116
WTSKTCBA EQU   GTFPCT+112
WRTRTCBA EQU   GTFPCT+108
TRMWTASK EQU   GTFPCT+104
WTSKATTH EQU   GTFPCT+100
WTSKINIT EQU   GTFPCT+96
WTASKECB EQU   GTFPCT+92
WMTABPTR EQU   GTFPCT+88
ATTCHECB EQU   GTFPCT+84
AHLECB   EQU   GTFPCT+80
STOPECBA EQU   GTFPCT+76
ECBADRLT EQU   GTFPCT+72
FIXLEN   EQU   GTFPCT+68
FIXPTR   EQU   GTFPCT+64
MCQEPTR  EQU   GTFPCT+56
GTFEIDL  EQU   GTFPCT+52
GTFPIBL  EQU   GTFPCT+48
GTFPIFT  EQU   GTFPCT+44
GTFSVCBL EQU   GTFPCT+40
GTFSVCFT EQU   GTFPCT+36
GTFIOBL  EQU   GTFPCT+32
GTFIOFT  EQU   GTFPCT+28
GTFSIOBL EQU   GTFPCT+24
GTFSIOFT EQU   GTFPCT+20
@NM00004 EQU   PCTCATF+1
@NM00003 EQU   PCTCATF
OPTTIME  EQU   GTFOPTS4
OPTRES3  EQU   GTFOPTS4
OPTIOSIO EQU   GTFOPTS3
OPTRES2  EQU   GTFOPTS3
OPTRR    EQU   GTFOPTS3
OPTSRM   EQU   GTFOPTS3
OPTRNIO  EQU   GTFOPTS3
OPTEXT   EQU   GTFOPTS3
OPTIOP   EQU   GTFOPTS2
OPTIO    EQU   GTFOPTS2
OPTPIP   EQU   GTFOPTS2
OPTPI    EQU   GTFOPTS2
OPTSIOP  EQU   GTFOPTS2
OPTSIO   EQU   GTFOPTS2
OPTSVCP  EQU   GTFOPTS2
OPTSVC   EQU   GTFOPTS2
OPTPCI   EQU   GTFOPTS1
OPTRES1  EQU   GTFOPTS1
OPTDSP   EQU   GTFOPTS1
OPTTRC   EQU   GTFOPTS1
OPTUSR   EQU   GTFOPTS1
OPTSYS   EQU   GTFOPTS1
OPTSYSP  EQU   GTFOPTS1
OPTSYSM  EQU   GTFOPTS1
GTFRESV  EQU   GTFSTAT
GTFDEBUG EQU   GTFSTAT
GTFMODE  EQU   GTFSTAT
GTFPCTID EQU   GTFPCT
TWTWORK  EQU   TWT+8
@NM00002 EQU   TWT+4
@NM00001 EQU   TWT
RANGPTR  EQU   INITDATA+172
PITAB    EQU   INITDATA+168
SVCTAB   EQU   INITDATA+164
SIOTAB   EQU   INITDATA+160
IOTAB    EQU   INITDATA+156
GTFTIME  EQU   GTFOPT4
GTFRES3  EQU   GTFOPT4
GTFIOSIO EQU   GTFOPT3
GTFRES2  EQU   GTFOPT3
GTFRES1  EQU   GTFOPT1
GTFTRC   EQU   GTFOPT1
WTORECB  EQU   INITDATA+24
PARMDCB  EQU   INITDATA+20
ICTRESV  EQU   ICTFLAGS
ICTEOD   EQU   ICTFLAGS
EXECPTR  EQU   INITDATA+12
CIBPTR   EQU   INITDATA+8
INITID   EQU   INITDATA
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RT00027 EQU   SCN06
@RT00029 EQU   SCN04
@RT00034 EQU   SCN06
@RT00039 EQU   SCN05
@RT00059 EQU   SCN07
@RT00065 EQU   SCN02
@RT00067 EQU   SCN08
@RT00071 EQU   SCN02
@RT00073 EQU   SCN02
@RT00082 EQU   SCN10
@RC00092 EQU   SCN03
@RT00117 EQU   SCN09
@RT00139 EQU   ANL02
@RT00185 EQU   IOFRTN
@RT00187 EQU   IORTN
@RF00189 EQU   ANL05
@RT00202 EQU   ANL06
@RT00211 EQU   ANL08
@RT00220 EQU   ANL095
@RF00232 EQU   @EL00002
@PB00002 EQU   @EL00001
@ENDDATA EQU   *
         END   AHLTSCN,(C'PL/S-II',0502,73240)

         TITLE 'AMDUSRFD - VTAM TRACE FORMATTER                        *
                        '
AMDUSRFD CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'AMDUSRFD  77.035'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@12                                         0001
         L     @00,@SIZDATD                                        0001
         GETMAIN  R,LV=(0)
         LR    @11,@01                                             0001
         USING @DATD,@11                                           0001
         ST    @13,@SA00001+4                                      0001
         LM    @00,@01,20(@13)                                     0001
         ST    @11,8(,@13)                                         0001
         LR    @13,@11                                             0001
*                                                                  0364
*   /*****************************************************************/
*   /*                                                               */
*   /* AMDUSRFD IS ENTERED FROM EDIT/ABDUMP THROUGH THIS ONE AND ONLY*/
*   /* ENTRY POINT. IT MAY BE ENTERED DUE TO A NEW INPUT GTF RECORD  */
*   /* (CONTAINING A VTAM GTRACE RECORD) OR TO CONTINUE PROCESSING A */
*   /* PRIOR VTAM GTRACE RECORD. FIRST, SOME COMMON INITIALIZATION IS*/
*   /* PERFORMED, REGARDLESS OF WHETHER THIS IS A NEW OR CONTINUATION*/
*   /* RECORD.                                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0364
*   PARMSAVE=EDITPARM;              /* SAVE ADDRESS OF MAIN PARAMETER
*                                      LIST IN A NON-VOLATILE      0364
*                                      REGISTER                      */
         LR    PARMSAVE,EDITPARM                                   0364
*   BUFFPTR=OUTBUF;                 /* SET POINTER TO OUTPUT BUFFER
*                                      TO BE USED ON THIS ENTRY. THIS
*                                      POINTER MUST BE REINITIALIZED
*                                      ON EACH ENTRY SINCE EDIT MAY
*                                      HAVE CHANGED IT.              */
*                                                                  0365
         L     BUFFPTR,OUTBUF(,PARMSAVE)                           0365
*   /*****************************************************************/
*   /*                                                               */
*   /* VARIABLE NEXTLINE IS NOW USED TO DETERMINE HOW TO PROCESS THIS*/
*   /* ENTRY TO AMDUSRFD. IF IT CONTAINS A ZERO, THIS IS A NEW INPUT */
*   /* RECORD.                                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0366
*   IF NEXTLINE=0 THEN                                             0366
         SLR   @10,@10                                             0366
         L     @15,WORKAREA(,PARMSAVE)                             0366
         C     @10,NEXTLINE(,@15)                                  0366
         BNE   @RF00366                                            0366
*     DO;                                                          0367
*                                                                  0367
*       /*************************************************************/
*       /*                                                           */
*       /* A NEW INPUT RECORD HAS BEEN RECEIVED. BEFORE PROCESSING   */
*       /* THE CONTENTS, MORE INITIALIZATION IS PERFORMED. CALCULATE */
*       /* LENGTH OF VTAM PORTION OF INPUT RECORD BY SUBTRACTING GTF */
*       /* PREFIX FROM TOTAL LENGTH OF INPUT RECORD                  */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0368
*       DATALNG=RECLEN-(DATAADDR-RECORDAD);                        0368
*                                                                  0368
         L     @14,RECORDAD(,PARMSAVE)                             0368
         L     @09,DATAADDR(,PARMSAVE)                             0368
         SLR   @09,@14                                             0368
         LCR   @09,@09                                             0368
         ICM   @08,12,RECLEN(@14)                                  0368
         SRA   @08,16                                              0368
         ALR   @09,@08                                             0368
         ST    @09,DATALNG(,@15)                                   0368
*       /*************************************************************/
*       /*                                                           */
*       /* INVESTIGATE THE EVENT IDENTIFIER (EID) VALUE IN THE INPUT */
*       /* RECORD TO DETERMINE HOW TO PROCESS THIS FIRST LINE        */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0369
*       IF INPUTEID=ISTRPEID THEN                                  0369
         L     @14,EIDADDR(,PARMSAVE)                              0369
         CLC   INPUTEID(2,@14),@CH00594                            0369
         BNE   @RF00369                                            0369
*         DO;                       /* SMS BUFFER                    */
*                                                                  0370
*           /*********************************************************/
*           /*                                                       */
*           /* MOVE IN LABELS INTO HEADER LINE                       */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0371
*           NM1=SMSVTAM;            /* VTAM CHARACTER STRING         */
         MVC   NM1(4,BUFFPTR),SMSVTAM                              0371
*           NM2=SMSBUF;             /* BUFFER CHARACTER STRING       */
         MVC   NM2(7,BUFFPTR),SMSBUF                               0372
*           NM3=SMSHD;              /* HEADER COLUMN ONE             */
         MVC   NM3(14,BUFFPTR),SMSHD                               0373
*           NM4=SMSHD;              /* HEADER COLUMN TWO             */
         MVC   NM4(14,BUFFPTR),SMSHD                               0374
*           NM5=SMSHD;              /* HEADER COLUMN THREE           */
         MVC   NM5(14,BUFFPTR),SMSHD                               0375
*           NM6=SMSHD;              /* HEADER COLUMN FOUR            */
         MVC   NM6(14,BUFFPTR),SMSHD                               0376
*           RETCODE=CONTINUE;       /* INDICATE MORE LINES TO FORMAT */
         ST    @10,RETCODE(,@15)                                   0377
*           NEXTLINE=ADDR(AMDSMS01);/* CONTINUE ADDRESS FOR LINE TWO */
         LA    @10,AMDSMS01                                        0378
         ST    @10,NEXTLINE(,@15)                                  0378
*         END;                                                     0379
*       ELSE                                                       0380
*         IF INPUTEID=ISTCLEID THEN                                0380
         B     @RC00369                                            0380
@RF00369 L     @10,EIDADDR(,PARMSAVE)                              0380
         CLC   INPUTEID(2,@10),@CH00592                            0380
         BNE   @RF00380                                            0380
*           DO;                                                    0381
*                                                                  0381
*             /*******************************************************/
*             /*                                                     */
*             /* PROCESS FIRST CONTROL LAYER LINE BY FIRST MOVING IN */
*             /* ALL REQUIRED LABELS TO OUTPUT BUFFER.               */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0382
*             CLLABL=CTLAYER;       /* MOVE CONTROL LAYER INDICATOR
*                                      TO BUFFER                     */
         MVC   CLLABL(3,BUFFPTR),CTLAYER                           0382
*             CLANODLB=ANODELAB;    /* MOVE ANODE LABEL TO BUFFER    */
         MVC   CLANODLB(5,BUFFPTR),ANODELAB                        0383
*             CLTEXTLB=TEXTLAB;     /* MOVE TEXT LABEL TO BUFFER     */
*                                                                  0384
         MVC   CLTEXTLB(4,BUFFPTR),TEXTLAB                         0384
*             /*******************************************************/
*             /*                                                     */
*             /* MOVE IN APPLICATION NODE NAME FROM INPUT RECORD,    */
*             /* THEN INDICATE THE DIRECTION OF THE CONTROL LAYER    */
*             /* BUFFER                                              */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0385
*             RFY                                                  0385
*               ISTTRAC BASED(DATAADDR);                           0385
*             CLANODAT=TRAANODE;    /* MOVE APPLICATION NODE NAME TO
*                                      BUFFER                        */
         L     @10,DATAADDR(,PARMSAVE)                             0386
         MVC   CLANODAT(8,BUFFPTR),TRAANODE(@10)                   0386
*             IF TRADIO='1'B THEN                                  0387
         TM    TRADIO(@10),B'00001000'                             0387
         BNO   @RF00387                                            0387
*               CLINOUT=INBOUND;    /* IF RECORD INDICATES INBOUND,
*                                      MARK IT AS SUCH IN OUTPUT   0388
*                                      BUFFER                        */
         MVI   CLINOUT+2(BUFFPTR),C' '                             0388
         MVC   CLINOUT(2,BUFFPTR),INBOUND                          0388
*             ELSE                                                 0389
*               CLINOUT=OUTBOUND;   /* OTHERWISE, SHOW AS OUTBOUND   */
*                                                                  0389
         B     @RC00387                                            0389
@RF00387 MVC   CLINOUT(3,BUFFPTR),OUTBOUND                         0389
*             /*******************************************************/
*             /*                                                     */
*             /* HAVE THE TEXT PORTION OF THE LINE FORMATTED BY      */
*             /* SUBROUTINE FRMTEXT.                                 */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0390
*             TEXTADDR=ADDR(TRABFFER);/* TEXT BEGINS AFTER ISTTRAC 0390
*                                      HEADER                        */
@RC00387 L     @10,WORKAREA(,PARMSAVE)                             0390
         L     @15,DATAADDR(,PARMSAVE)                             0390
         LA    @14,TRABFFER(,@15)                                  0390
         ST    @14,TEXTADDR(,@10)                                  0390
*             TEXTLN=TRADATCT-LENGTH(TRAANODE);/* LENGTH IS IN TRACE
*                                      HEADER AND INCLUDES ANODE INFO*/
         LH    @15,TRADATCT(,@15)                                  0391
         SL    @15,@CF00060                                        0391
         ST    @15,TEXTLN(,@10)                                    0391
*             CALL FRMTEXT;         /* CALL SUBROUTINE TO DO TEXT  0392
*                                      FORMATTING                    */
*                                                                  0392
         BAL   @14,FRMTEXT                                         0392
*             /*******************************************************/
*             /*                                                     */
*             /* FIRST LINE IS NOW COMPLETE. SET UP TO PROCESS SECOND*/
*             /* LINE.                                               */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0393
*             NEXTLINE=ADDR(AMDCLTR2);/* THIS IS THE ROUTINE WHICH 0393
*                                      WILL PROCESS SECOND LINE UPON
*                                      REENTRY FROM EDIT             */
         L     @10,WORKAREA(,PARMSAVE)                             0393
         LA    @15,AMDCLTR2                                        0393
         ST    @15,NEXTLINE(,@10)                                  0393
*             RETCODE=CONTINUE;     /* RETURN CODE IS SET TO PRINT 0394
*                                      THIS BUFFER, AND RETURN TO  0394
*                                      AMDUSRFD TO PROCESS NEXT LINE */
         SLR   @15,@15                                             0394
         ST    @15,RETCODE(,@10)                                   0394
*           END;                                                   0395
*         ELSE                                                     0396
*           IF INPUTEID=ISTTPEID THEN                              0396
         B     @RC00380                                            0396
@RF00380 L     @10,EIDADDR(,PARMSAVE)                              0396
         CLC   INPUTEID(2,@10),@CH00596                            0396
         BNE   @RF00396                                            0396
*             DO;                                                  0397
*                                                                  0397
*               /*****************************************************/
*               /*                                                   */
*               /* AMDTPTR1 -- THIS ROUTINE PROCESSES THE FIRST LINE */
*               /* OF TPIOS OUTPUT FOR ALL TPIOS RECORDS. FIRST,     */
*               /* APPLICABLE LABELS ARE MOVED TO THE OUTPUT BUFFER. */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0398
*               TPLABL=TPLAB;       /* MOVE TPIOS INDICATOR TO     0398
*                                      BUFFER.                       */
         MVC   TPLABL(5,BUFFPTR),TPLAB                             0398
*               TPANODLB=ANODELAB;  /* MOVE ANODE LABEL              */
         MVC   TPANODLB(5,BUFFPTR),ANODELAB                        0399
*               TPFDBLB=FDBLAB;     /* MOVE FDB LABEL                */
         MVC   TPFDBLB(3,BUFFPTR),FDBLAB                           0400
*               TPRSVDLB=RSVDLAB;   /* RSVD LABEL                    */
         MVC   TPRSVDLB(4,BUFFPTR),RSVDLAB                         0401
*               TPLNG2LB=LNG2LAB;   /* LNG2 LABEL                    */
*                                                                  0402
         MVC   TPLNG2LB(4,BUFFPTR),LNG2LAB                         0402
*               /*****************************************************/
*               /*                                                   */
*               /* MOVE THE APPLICATION NODE NAME FROM ISTTRF,       */
*               /* LOCATED AT THE END OF THE TEXT                    */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0403
*               TRFPTR=DATAADDR+(DATALNG-LENGTH(ISTTRF));/* FIND   0403
*                                      BEGINNING OF ISTTRF DATA      */
         L     @10,WORKAREA(,PARMSAVE)                             0403
         L     @15,DATAADDR(,PARMSAVE)                             0403
         L     @14,DATALNG(,@10)                                   0403
         SL    @14,@CF02414                                        0403
         ALR   @14,@15                                             0403
         ST    @14,TRFPTR(,@10)                                    0403
*               RFY                                                0404
*                 ISTTRF BASED(TRFPTR);                            0404
*               TPANODAT=TRFANODE;  /* MOVE IN ANODE INFO            */
*                                                                  0405
         MVC   TPANODAT(8,BUFFPTR),TRFANODE(@14)                   0405
*               /*****************************************************/
*               /*                                                   */
*               /* SET UP FOR AND CALL SUBROUTINE HEXFRMT TO FORMAT  */
*               /* THE FIRST LINE OF HEX DATA                        */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0406
*               DATASTRT=DATAADDR;  /* DATA TO BE FORMATTED BEGINS AT
*                                      THE FIRST BYTE OF THE VTAM  0406
*                                      GTRACE RECORD                 */
         LR    DATASTRT,@15                                        0406
*               HEXPARM=ADDR(TPHEX1);/* POINT TO PLIST FOR FIRST   0407
*                                      TPIOS LINE                    */
         LA    HEXPARM,TPHEX1                                      0407
*               CALL HEXFRMT;                                      0408
*                                                                  0408
         BAL   @14,HEXFRMT                                         0408
*               /*****************************************************/
*               /*                                                   */
*               /* CHECK DIRECTION OF TPIOS BUFFER AND INDICATE IN   */
*               /* OUTPUT                                            */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0409
*               IF TRFINB='1'B THEN                                0409
         L     @10,WORKAREA(,PARMSAVE)                             0409
         L     @10,TRFPTR(,@10)                                    0409
         TM    TRFINB(@10),B'10000000'                             0409
         BNO   @RF00409                                            0409
*                 TPINOUT=INBOUND;                                 0410
         MVI   TPINOUT+2(BUFFPTR),C' '                             0410
         MVC   TPINOUT(2,BUFFPTR),INBOUND                          0410
*               ELSE                                               0411
*                 TPINOUT=OUTBOUND;                                0411
*                                                                  0411
         B     @RC00409                                            0411
@RF00409 MVC   TPINOUT(3,BUFFPTR),OUTBOUND                         0411
*               /*****************************************************/
*               /*                                                   */
*               /* COMMON PORTION OF TPIOS RECORD IS COMPLETE. CHECK */
*               /* THE FLAGS TO DETERMINE HOW TO PROCESS THE         */
*               /* REMAINDER OF THE RECORD                           */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0412
*               IF TRFLOCAL='1'B THEN                              0412
@RC00409 L     @10,WORKAREA(,PARMSAVE)                             0412
         L     @15,TRFPTR(,@10)                                    0412
         TM    TRFLOCAL(@15),B'01000000'                           0412
         BNO   @RF00412                                            0412
*                 DO;               /* IF THIS IS A LOCAL RECORD,  0413
*                                      PROCESSING DEPENDS ON       0413
*                                      DIRECTION                     */
*                   IF TRFINB='1'B THEN                            0414
         TM    TRFINB(@15),B'10000000'                             0414
         BNO   @RF00414                                            0414
*                     DO;                                          0415
*                       TPRSVLNG='';/* BLANK OUT RSVD AND LENGTH   0416
*                                      FIELDS                        */
         MVI   TPRSVLNG(BUFFPTR),C' '                              0416
         MVC   TPRSVLNG+1(27,BUFFPTR),TPRSVLNG(BUFFPTR)            0416
*                       NEXTLINE=ADDR(AMDTPLI1);/* NEXT LINE TO BE 0417
*                                      FORMATTED BY TPLI1            */
         LA    @15,AMDTPLI1                                        0417
         ST    @15,NEXTLINE(,@10)                                  0417
*                     END;          /* END OF INBOUND                */
*                   ELSE                                           0419
*                     NEXTLINE=ADDR(AMDTPLOC);/* IF OUTBOUND, TPLOC  */
         B     @RC00414                                            0419
@RF00414 L     @10,WORKAREA(,PARMSAVE)                             0419
         LA    @15,AMDTPLOC                                        0419
         ST    @15,NEXTLINE(,@10)                                  0419
*                 END;              /* END OF LOCAL                  */
*               ELSE                                               0421
*                 IF TRFINB='1'B THEN                              0421
         B     @RC00412                                            0421
@RF00412 L     @10,WORKAREA(,PARMSAVE)                             0421
         L     @15,TRFPTR(,@10)                                    0421
         TM    TRFINB(@15),B'10000000'                             0421
         BNO   @RF00421                                            0421
*                   NEXTLINE=ADDR(AMDTPRI1);/* THE BUFFER IS A REMOTE
*                                      TPIOS RECORD-- IF INBOUND,  0422
*                                      FIRST LINE IS COMPLETE AND  0422
*                                      NEXT LINE IS PROCESSED BY   0422
*                                      AMDTPRI1                      */
         LA    @15,AMDTPRI1                                        0422
         ST    @15,NEXTLINE(,@10)                                  0422
*                 ELSE                                             0423
*                   DO;             /* FOR REMOTE OUTBOUND, THE RSVD2
*                                      FIELD IS FORMATTED. SET UP FOR
*                                      AND CALL SUBROUTINE HEXFRMT TO
*                                      DO IT                         */
         B     @RC00421                                            0423
@RF00421 DS    0H                                                  0424
*                     TPRSV2LB=RSVD2LAB;/* MOVE IN LABEL             */
         MVC   TPRSV2LB(4,BUFFPTR),RSVD2LAB                        0424
*                     RFY                                          0425
*                       ISTZOBUF BASED(DATAADDR);                  0425
*                     DATASTRT=ADDR(ZOBRSV04);/* POINT TO THE RSVD2
*                                      FIELD IN THE INPUT RECORD     */
         L     @10,DATAADDR(,PARMSAVE)                             0426
         LA    DATASTRT,ZOBRSV04(,@10)                             0426
*                     HEXPARM=ADDR(TPHEX2);/* POINT TO APPROPRIATE 0427
*                                      PLIST                         */
         LA    HEXPARM,TPHEX2                                      0427
*                     CALL HEXFRMT;                                0428
         BAL   @14,HEXFRMT                                         0428
*                     NEXTLINE=ADDR(AMDTPRO1);/* SECOND LINE IS    0429
*                                      PROCESSED BY ROUTINE AMDTPRO1 */
         L     @10,WORKAREA(,PARMSAVE)                             0429
         LA    @15,AMDTPRO1                                        0429
         ST    @15,NEXTLINE(,@10)                                  0429
*                   END;            /* END OF TPIOS REMOTE OUTBOUND
*                                      PATH                          */
*               RETCODE=CONTINUE;   /* INDICATE MORE OUTPUT LINES ARE
*                                      REQUIRED                      */
@RC00421 DS    0H                                                  0431
@RC00412 L     @10,WORKAREA(,PARMSAVE)                             0431
         SLR   @15,@15                                             0431
         ST    @15,RETCODE(,@10)                                   0431
*               GO TO AMDEXIT;      /* QUIT VIA THE EXIT ROUTINE     */
         B     AMDEXIT                                             0432
*             END;                                                 0433
*           ELSE                                                   0434
*             IF INPUTEID=ISTLNEID THEN                            0434
@RF00396 L     @10,EIDADDR(,PARMSAVE)                              0434
         CLC   INPUTEID(2,@10),@CH00590                            0434
         BNE   @RF00434                                            0434
*               DO;                 /*                       @ZM41491*/
*                                                                  0435
*                 /***************************************************/
*                 /*                                                 */
*                 /* AMDLNTR1 - THIS ROUTINE PROCESSES THE FIRST LINE*/
*                 /* OF LINE TRACE DATA. FIRST, THE APPROPRIATE      */
*                 /* INDICATORS ARE MOVED ITO THE OUTPUT LINE        */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0436
*                 LNLABEL=LINELAB;  /* INDICATE LINE TRACE EVENT     */
         MVC   LNLABEL(4,BUFFPTR),LINELAB                          0436
*                 LNDNODL=DNODELAB; /* MOVE IN DNODE LABEL           */
         MVC   LNDNODL(5,BUFFPTR),DNODELAB                         0437
*                 LNEPLB=EPLAB;     /* MOVE IN EP LABEL              */
         MVC   LNEPLB(2,BUFFPTR),EPLAB                             0438
*                 LNTMLB=TIMELAB;   /* MOVE IN TIME LABEL            */
*                                                                  0439
         MVC   LNTMLB(4,BUFFPTR),TIMELAB                           0439
*                 /***************************************************/
*                 /*                                                 */
*                 /* FIND ISTTRF AT THE END OF THE INPUT RECORD AND  */
*                 /* MOVE DESTINATION NODE FROM IT INTO THE OUTPUT   */
*                 /* BUFFER                                          */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0440
*                 TRFPTR=DATAADDR+(DATALNG-LENGTH(ISTTRF));        0440
         L     @10,WORKAREA(,PARMSAVE)                             0440
         L     @15,DATAADDR(,PARMSAVE)                             0440
         L     @14,DATALNG(,@10)                                   0440
         SL    @14,@CF02414                                        0440
         ALR   @14,@15                                             0440
         ST    @14,TRFPTR(,@10)                                    0440
*                 RFY                                              0441
*                   ISTTRF BASED(TRFPTR);                          0441
*                 LNDNODAT=TRFDNODE;/* MOVE DNODE DATA INTO BUFFER   */
*                                                                  0442
         MVC   LNDNODAT(8,BUFFPTR),TRFDNODE(@14)                   0442
*                 /***************************************************/
*                 /*                                                 */
*                 /* SET UP FOR AND CALL HEXFRMT SUBROUTINE TO FORMAT*/
*                 /* THE EP AND TIME DATA                            */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0443
*                 TRRPTR=ADDR(LNSRU);/* FIND THE LINE DATA HEADER    */
         LA    @15,LNSRU(,@15)                                     0443
         ST    @15,TRRPTR(,@10)                                    0443
*                 RFY                                              0444
*                   ISTRUB BASED(TRRPTR);                          0444
*                 DATASTRT=ADDR(TRRTIME);/* POINT TO TIME DATA       */
         LA    DATASTRT,TRRTIME(,@15)                              0445
*                 HEXPARM=ADDR(LNHEX1);/* POINT TO HEXFRMT PLIST     */
         LA    HEXPARM,LNHEX1                                      0446
*                 CALL HEXFRMT;                                    0447
*                                                                  0447
         BAL   @14,HEXFRMT                                         0447
*                 /***************************************************/
*                 /*                                                 */
*                 /* IF LINE TRACE IS BEING TERMINATED DUE TO        */
*                 /* SLOWDOWN PROCESSING, INDICATE THIS IN THE OUTPUT*/
*                 /* BUFFER                                          */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0448
*                 IF TRRSTAT=SLOWDOWN THEN                         0448
         L     @10,WORKAREA(,PARMSAVE)                             0448
         L     @10,TRRPTR(,@10)                                    0448
         CLC   TRRSTAT(1,@10),SLOWDOWN                             0448
         BNE   @RF00448                                            0448
*                   LNSLOWDN=SLOWIND;                              0449
*                                                                  0449
         MVC   LNSLOWDN(8,BUFFPTR),SLOWIND                         0449
*                 /***************************************************/
*                 /*                                                 */
*                 /* FIRST LINE OUTPUT IS NOW COMPLETE. SETUP FOR THE*/
*                 /* NEXT LINE IS ACCOMPLISHED AS FOLLOWS: FOR FORMAT*/
*                 /* 2, JUST                                 @Z40GKTQ*/
*                 /* INDICATE NEXT LINE TO BE PROCESSED BY AMDLNE01  */
*                 /* AND SET                                 @Z40GKTQ*/
*                 /* RETURN CODE TO ZERO. OTHERWISE, FIND THE START  */
*                 /* OF THE LINE TRACE DATA, AND CALCULATING THE     */
*                 /* NUMBER OF 4-BYTE ENTRIES CONTAINED THERIN.      */
*                 /* CONTROL IS THEN PASSED TO THE EXIT ROUTINE      */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0450
*                 LINEADDR=ADDR(TRRDATA);/* POINT TO LINE TRACE    0450
*                                      DATA@Z40GKTQ                  */
@RF00448 L     @10,WORKAREA(,PARMSAVE)                             0450
         L     @15,TRRPTR(,@10)                                    0450
         LA    @14,TRRDATA(,@15)                                   0450
         ST    @14,LINEADDR(,@10)                                  0450
*                 IF TRRFMT2=ON     /* CHECK FORMAT 2 FLAG   @Z40GKTQ*/
*                   THEN                                           0451
         TM    TRRFMT2(@15),B'00000010'                            0451
         BNO   @RF00451                                            0451
*                   DO;             /* IF IT'S ON, SET UP CALL     0452
*                                                            @Z40GKTQ*/
*                     NEXTLINE=ADDR(AMDLNE01);/* TO AMDLNE01 FOR NEXT
*                                                            @Z40GKTQ*/
         LA    @15,AMDLNE01                                        0453
         ST    @15,NEXTLINE(,@10)                                  0453
*                     RETCODE=CONTINUE;/* TIME AROUND        @Z40GKTQ*/
         SLR   @15,@15                                             0454
         ST    @15,RETCODE(,@10)                                   0454
*                   END;            /*                       @Z40GKTQ*/
*                 ELSE                                             0456
*                   DO;             /* OTHERWISE PROCESS FMT1      0456
*                                                            @Z40GKTQ*/
         B     @RC00451                                            0456
@RF00451 DS    0H                                                  0457
*                     LINECNT=(TRFPTR-LINEADDR)/4;/* LINE DATA LENGTH
*                                      IS DISTANCE BETWEEN ITS START
*                                      AND THE START OF ISTTRF. THE
*                                      NUMBER OF ENTRIES IS THEN   0457
*                                      FOUND BY DIVIDING BY THE    0457
*                                      LENGTH OF ONE ENTRY(4)        */
         L     @10,WORKAREA(,PARMSAVE)                             0457
         LA    @15,4                                               0457
         L     @04,TRFPTR(,@10)                                    0457
         SL    @04,LINEADDR(,@10)                                  0457
         SRDA  @04,32                                              0457
         DR    @04,@15                                             0457
         ST    @05,LINECNT(,@10)                                   0457
*                     IF LINECNT<=0 THEN                           0458
         LTR   @05,@05                                             0458
         BP    @RF00458                                            0458
*                       RETCODE=GETNEXT;/* IF NO DATA, RECORD IS   0459
*                                      COMPLETE                      */
         ST    @15,RETCODE(,@10)                                   0459
*                     ELSE                                         0460
*                       DO;                                        0460
         B     @RC00458                                            0460
@RF00458 DS    0H                                                  0461
*                         NEXTLINE=ADDR(AMDLNTR2);/* ALL SUBSEQUENT
*                                      LINES WILL BE PROCESSED BY  0461
*                                      AMDLNTR2                      */
         L     @10,WORKAREA(,PARMSAVE)                             0461
         LA    @15,AMDLNTR2                                        0461
         ST    @15,NEXTLINE(,@10)                                  0461
*                         RETCODE=CONTINUE;/* INDICATE MORE OUTPUT 0462
*                                      LINES ARE NEEDED              */
         SLR   @15,@15                                             0462
         ST    @15,RETCODE(,@10)                                   0462
*                       END;        /*                       @Z40GKTQ*/
*                   END;                                           0464
*                 GO TO AMDEXIT;    /* RETURN VIA THE EXIT ROUTINE   */
         B     AMDEXIT                                             0465
*               END;                /*                       @ZM41491*/
*                                                                  0466
*       /*************************************************************/
*       /*                                                           */
*       /* IF THE EID DOES NOT MATCH ANY OF THE ABOVE, THE INPUT     */
*       /* RECORD IS NOT A VTAM RECORD. IT IS IGNORED BY SETTING THE */
*       /* PROPER RETURN CODE                                        */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0467
*             ELSE                                                 0467
*               RETCODE=IGNORE;                                    0467
*                                                                  0467
@RF00434 L     @10,WORKAREA(,PARMSAVE)                             0467
         MVC   RETCODE(4,@10),@CF00060                             0467
*       /*************************************************************/
*       /*                                                           */
*       /* PROCESSING FOR THE NEW INPUT RECORD IS COMPLETE. THE      */
*       /* FOLLOWING ROUTINE RETURNS TO EDIT/ABDUMP AFTER PERFORMING */
*       /* NECESSARY CLEANUP AMDEXIT - THIS IS THE EXIT ROUTINE      */
*       /* THROUGH WHICH ALL OF THE PROCESSING ROUTINES RETURN TO    */
*       /* EDIT/ABDUMP. IT LOADS THE RETURN CODE INTO REGISTER 15    */
*       /* FROM VARIABLE RETCODE AND PERFORMS STANDARD EXIT LINKAGE  */
*       /* TO RETURN TO EDIT/ABDUMP                                  */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0468
*AMDEXIT:                                                          0468
*       RTRNREG=RETCODE;            /* SET R15 TO VALUE SET BY     0468
*                                      PROCESSING ROUTINE            */
@RC00380 DS    0H                                                  0468
@RC00369 DS    0H                                                  0468
AMDEXIT  L     @10,HISPTR(,SAVEPTR)                                0468
         L     @15,WORKAREA(,PARMSAVE)                             0468
         L     @15,RETCODE(,@15)                                   0468
         ST    @15,RTRNREG(,@10)                                   0468
*       RETURN;                     /* RETURN TO EDIT/ABDUMP         */
@EL00001 L     @13,4(,@13)                                         0469
@EF00001 L     @00,@SIZDATD                                        0469
         LR    @01,@11                                             0469
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0469
         BR    @14                                                 0469
*     END;                          /* END OF NEW INPUT RECORD PATH  */
*                                                                  0471
*   /*****************************************************************/
*   /*                                                               */
*   /* OTHERWISE, IF NEXTLINE IS NOT ZERO, IT CONTAINS THE ADDRESS OF*/
*   /* THE ROUTINE WHICH IS TO PROCESS THIS LINE OF OUTPUT. A BRANCH */
*   /* IS NOW TAKEN TO THE INDICATED ADDRESS. SEE THE PROLOGUE FOR   */
*   /* THE ROUTINE NAMES WHICH ARE GIVEN CONTROL UNDER WHICH         */
*   /* CIRCUMSTANCES.                                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0471
*   ELSE                                                           0471
*     GO TO NEXTLINE;                                              0471
@RF00366 L     @10,WORKAREA(,PARMSAVE)                             0471
         L     @10,NEXTLINE(,@10)                                  0471
         BR    @10                                                 0471
*                                                                  0472
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESSING ROUTINES FOR SUBSEQUENT OUTPUT LINES               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0472
*AMDCLTR2:                                                         0472
*                                                                  0472
*   /*****************************************************************/
*   /*                                                               */
*   /* AMDCLTR2 -- THIS ROUTINE RECEIVES CONTROL TO FORMAT THE SECOND*/
*   /* LINE OF OUTPUT FOR CONTROL LAYER RECORDS. ON ENTRY, TEXTLN AND*/
*   /* TEXTADDR ARE ALREADY SET TO THE CORRECT VALUES TO CALL        */
*   /* SUBROUTINE FRMTEXT. FIRST, THE DNODE LABEL AND DATA IS MOVED  */
*   /* TO THE BUFFER.                                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0472
*   CLDNODLB=DNODELAB;              /* MOVE DNODE LABEL TO OUTPUT  0472
*                                      BUFFER                        */
AMDCLTR2 MVC   CLDNODLB(5,BUFFPTR),DNODELAB                        0472
*   RFY                                                            0473
*     ISTTRAC BASED(DATAADDR);                                     0473
*   CLDNODAT=TRADNODE;              /* MOVE DESTINATION NODE NAME TO
*                                      BUFFER.                       */
*                                                                  0474
         L     @10,DATAADDR(,PARMSAVE)                             0474
         MVC   CLDNODAT(8,BUFFPTR),TRADNODE(@10)                   0474
*   /*****************************************************************/
*   /*                                                               */
*   /* CALL SUBROUTINE FRMTEXT TO FORMAT THE TEXT PORTION            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0475
*   CALL FRMTEXT;                                                  0475
*                                                                  0475
         BAL   @14,FRMTEXT                                         0475
*   /*****************************************************************/
*   /*                                                               */
*   /* ON RETURN, ALL DATA WITH THE POSSIBLE EXCEPTION OF SOME       */
*   /* REMAINING TEXT INFORMATION HAS BEEN FORMATTED FOR THIS CONTROL*/
*   /* LAYER RECORD. TEXTLN INDICATES IF MORE TEXT IS TO BE          */
*   /* FORMATTED. IF TEXTLN IS ZERO, NO MORE TEXT REMAINS.           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0476
*   IF TEXTLN=0 THEN                                               0476
         L     @10,WORKAREA(,PARMSAVE)                             0476
         L     @15,TEXTLN(,@10)                                    0476
         LTR   @15,@15                                             0476
         BNZ   @RF00476                                            0476
*     RETCODE=GETNEXT;              /* IF NO MORE TEXT, SET RETURN 0477
*                                      CODE TO GET THE NEXT RECORD   */
         MVC   RETCODE(4,@10),@CF00036                             0477
*   ELSE                                                           0478
*     DO;                                                          0478
*                                                                  0478
         B     @RC00476                                            0478
@RF00476 DS    0H                                                  0479
*       /*************************************************************/
*       /*                                                           */
*       /* OTHERWISE, MORE TEXT REMAINS. THIS SITUATION IS PROCESSED */
*       /* BY AMDTXTLN                                               */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0479
*       NEXTLINE=ADDR(AMDTXTLN);    /* INDICATE THAT AMDTXTLN IS TO
*                                      RECEIVE CONTROL ON NEXT ENTRY
*                                      TO PROCESS NEXT LINE          */
         L     @10,WORKAREA(,PARMSAVE)                             0479
         LA    @15,AMDTXTLN                                        0479
         ST    @15,NEXTLINE(,@10)                                  0479
*       RETCODE=CONTINUE;           /* INDICATE MORE OUTPUT LINES  0480
*                                      NEEDED FOR SAME INPUT RECORD  */
         SLR   @15,@15                                             0480
         ST    @15,RETCODE(,@10)                                   0480
*     END;                          /* END OF NON-ZERO TEXTLN PATH   */
*   GO TO AMDEXIT;                  /* FINISH VIA THE EXIT ROUTINE   */
         B     AMDEXIT                                             0482
*AMDTPLOC:                                                         0483
*                                                                  0483
*   /*****************************************************************/
*   /*                                                               */
*   /* AMDTPLOC - THIS ROUTINE PROCESSES THE SECOND LINE OF OUTPUT   */
*   /* FOR TPIOS LOCAL OUTBOUND. FIRST, THE LOCAL INDICATOR, DNODE   */
*   /* LABEL, AND TEXT LABEL ARE MOVED INTO OUTPUT BUFFER            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0483
*   TPLOCLB=LOCALIND;                                              0483
AMDTPLOC MVC   TPLOCLB(5,BUFFPTR),LOCALIND                         0483
*   TPLOCDNL=DNODELAB;                                             0484
         MVC   TPLOCDNL(5,BUFFPTR),DNODELAB                        0484
*   TPLOCTXL=TEXTLAB;                                              0485
*                                                                  0485
         MVC   TPLOCTXL(4,BUFFPTR),TEXTLAB                         0485
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCATE THE ISTTRF INFO AT THE END OF THE INPUT DATA AND MOVE  */
*   /* THE DESTINATION NODE FROM IT INTO THE OUTPUT BUFFER           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0486
*   TRFPTR=DATAADDR+(DATALNG-LENGTH(ISTTRF));/* SET BASE FOR ISTTRF
*                                      MAPPING                       */
         L     @10,WORKAREA(,PARMSAVE)                             0486
         L     @15,DATAADDR(,PARMSAVE)                             0486
         L     @14,DATALNG(,@10)                                   0486
         SL    @14,@CF02414                                        0486
         ALR   @14,@15                                             0486
         ST    @14,TRFPTR(,@10)                                    0486
*   TPLOCDND=TRFDNODE;              /* MOVE 8-CHARACTER DNODE INTO 0487
*                                      BUFFER                        */
*                                                                  0487
         MVC   TPLOCDND(8,BUFFPTR),TRFDNODE(@14)                   0487
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP TO FORMAT THE TEXT INFO BY LOCATING THE TEXT AND       */
*   /* CALCULATING ITS LENGTH                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0488
*   RFY                                                            0488
*     ISTZLBUF BASED(DATAADDR);                                    0488
*   TEXTADDR=ADDR(ZLBTEXT1);        /* POINT TO THE START OF THE TEXT*/
         LA    @15,ZLBTEXT1(,@15)                                  0489
         ST    @15,TEXTADDR(,@10)                                  0489
*   TEXTLN=TRFPTR-TEXTADDR;         /* CALCULATE LENGTH OF THE TEXT..
*                                      ITS ENDED BY THE ISTTRF BLOCK */
         SLR   @14,@15                                             0490
         ST    @14,TEXTLN(,@10)                                    0490
*   CALL FRMTEXT;                   /* CALL SUBROUTINE TO FORMAT THE
*                                      TEXT                          */
*                                                                  0491
         BAL   @14,FRMTEXT                                         0491
*   /*****************************************************************/
*   /*                                                               */
*   /* ON RETURN, THIS LINE IS COMPLETE. IF MORE TEXT REMAINS, IT    */
*   /* WILL APPEAR AS SUBSEQUENT LINES HANDLED BY ROUTINE AMDTXTLN.  */
*   /* IF NO MORE TEXT REMAINS, RECORD IS COMPLETE                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0492
*   IF TEXTLN=0 THEN                                               0492
         L     @10,WORKAREA(,PARMSAVE)                             0492
         L     @15,TEXTLN(,@10)                                    0492
         LTR   @15,@15                                             0492
         BNZ   @RF00492                                            0492
*     RETCODE=GETNEXT;              /* SET PROPER RETURN CODE IF   0493
*                                      RECORD IS COMPLETE            */
         MVC   RETCODE(4,@10),@CF00036                             0493
*   ELSE                                                           0494
*     DO;                                                          0494
         B     @RC00492                                            0494
@RF00492 DS    0H                                                  0495
*       NEXTLINE=ADDR(AMDTXTLN);    /* OTHERWISE, REMAINDER WILL BE
*                                      PROCESSED BY AMDTXTLN         */
         L     @10,WORKAREA(,PARMSAVE)                             0495
         LA    @15,AMDTXTLN                                        0495
         ST    @15,NEXTLINE(,@10)                                  0495
*       RETCODE=CONTINUE;           /* SET PROPER RC TO INDICATE MORE
*                                      TO DO                         */
         SLR   @15,@15                                             0496
         ST    @15,RETCODE(,@10)                                   0496
*     END;                          /* END OF MORE-TEXT PATH         */
*   GO TO AMDEXIT;                  /* RETURN VIA THE EXIT ROUTINE   */
         B     AMDEXIT                                             0498
*AMDTPLI1:                                                         0499
*                                                                  0499
*   /*****************************************************************/
*   /*                                                               */
*   /* AMDTPLI1 - THIS ROUTINE RECEIVES CONTROL TO FORMAT THE SECOND */
*   /* LINE OF OUTPUT FOR TPIOS LOCAL INBOUND RECORDS. FIRST, THE    */
*   /* LOCAL INDICATOR, DNODE LABEL, AND FSB LABELS ARE MOVED INTO   */
*   /* THE OUTPUT BUFFER                                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0499
*   TPLOCLB=LOCALIND;                                              0499
AMDTPLI1 MVC   TPLOCLB(5,BUFFPTR),LOCALIND                         0499
*   TPLOCDNL=DNODELAB;                                             0500
         MVC   TPLOCDNL(5,BUFFPTR),DNODELAB                        0500
*   TPLOCFSL=FSBLAB;                                               0501
*                                                                  0501
         MVC   TPLOCFSL(3,BUFFPTR),FSBLAB                          0501
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCATE THE ISTTRF INFO AT THE END OF THE INPUT DATA AND MOVE  */
*   /* THE DESTINATION NODE FROM IT INTO THE OUTPUT BUFFER           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0502
*   TRFPTR=DATAADDR+(DATALNG-LENGTH(ISTTRF));                      0502
         L     @10,WORKAREA(,PARMSAVE)                             0502
         L     @15,DATAADDR(,PARMSAVE)                             0502
         L     @14,DATALNG(,@10)                                   0502
         SL    @14,@CF02414                                        0502
         ALR   @14,@15                                             0502
         ST    @14,TRFPTR(,@10)                                    0502
*   TPLOCDND=TRFDNODE;              /* MOVE IN DESTINATION NODE      */
*                                                                  0503
         MVC   TPLOCDND(8,BUFFPTR),TRFDNODE(@14)                   0503
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP FOR AND CALL HEXFRMT ROUTINE TO FORMAT FSB             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0504
*   RFY                                                            0504
*     ISTZLBUF BASED(DATAADDR);                                    0504
*   DATASTRT=ADDR(ZLBFSB);          /* POINT TO FSB IN RECORD        */
         LA    DATASTRT,ZLBFSB(,@15)                               0505
*   HEXPARM=ADDR(TPHEX3);           /* POINT TO CORRECT PLIST        */
         LA    HEXPARM,TPHEX3                                      0506
*   CALL HEXFRMT;                                                  0507
*                                                                  0507
         BAL   @14,HEXFRMT                                         0507
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS LINE IS COMPLETE. SET UP TO PROCESS NEXT LINE AND RETURN */
*   /* TO EDIT/ABDUMP TO PRINT THIS LINE                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0508
*   NEXTLINE=ADDR(AMDTPLI2);        /* NEXT LINE FORMATTED BY TPLI2  */
         L     @10,WORKAREA(,PARMSAVE)                             0508
         LA    @15,AMDTPLI2                                        0508
         ST    @15,NEXTLINE(,@10)                                  0508
*   RETCODE=CONTINUE;               /* INCICATE MORE LINES TO BE   0509
*                                      FORMATTED                     */
         SLR   @15,@15                                             0509
         ST    @15,RETCODE(,@10)                                   0509
*   GO TO AMDEXIT;                  /* QUIT VIA THE EXIT ROUTINE     */
         B     AMDEXIT                                             0510
*AMDTPLI2:                                                         0511
*                                                                  0511
*   /*****************************************************************/
*   /*                                                               */
*   /* AMDTPLI2 - THIS ROUTINE RECEIVES CONTROL TO FORMAT THE THIRD  */
*   /* LINE FOR TPIOS LOCAL INBOUND RECORDS. FIRST, THE FDB LABEL IS */
*   /* MOVED INTO THE OUTPUT BUFFER                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0511
*   TPLOCFDL=FDBLAB;                                               0511
*                                                                  0511
AMDTPLI2 MVC   TPLOCFDL(3,BUFFPTR),FDBLAB                          0511
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP FOR AND CALL HEXFRMT TO FORMAT THE FDB                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0512
*   RFY                                                            0512
*     ISTZLBUF BASED(DATAADDR);                                    0512
*   DATASTRT=ADDR(ZLBFDBS);         /* POINT AT START OF DATA        */
         L     @10,DATAADDR(,PARMSAVE)                             0513
         LA    DATASTRT,ZLBFDBS(,@10)                              0513
*   HEXPARM=ADDR(TPHEX5);           /* POINT TO CORRECT PLIST        */
         LA    HEXPARM,TPHEX5                                      0514
*   CALL HEXFRMT;                                                  0515
*                                                                  0515
         BAL   @14,HEXFRMT                                         0515
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS LINE IS COMPLETE. SET UP FOR THE NEXT LINE BY FINDING AND*/
*   /* CALCULATING THE LENGTH OF THE TEXT INFO                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0516
*   TEXTADDR=ADDR(ZLBTEXT1);                                       0516
         L     @10,WORKAREA(,PARMSAVE)                             0516
         L     @15,DATAADDR(,PARMSAVE)                             0516
         LA    @14,ZLBTEXT1(,@15)                                  0516
         ST    @14,TEXTADDR(,@10)                                  0516
*   TRFPTR=DATAADDR+(DATALNG-LENGTH(ISTTRF));                      0517
         L     @09,DATALNG(,@10)                                   0517
         SL    @09,@CF02414                                        0517
         ALR   @15,@09                                             0517
         ST    @15,TRFPTR(,@10)                                    0517
*   TEXTLN=TRFPTR-TEXTADDR;                                        0518
*                                                                  0518
         SLR   @15,@14                                             0518
         ST    @15,TEXTLN(,@10)                                    0518
*   /*****************************************************************/
*   /*                                                               */
*   /* INDICATE NEXT ROUTINE TO PROCESS AND EXIT VIA THE EXIT ROUTINE*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0519
*   NEXTLINE=ADDR(AMDTPRTX);        /* ONLY TEXT REMAINS TO BE     0519
*                                      FORMATTED                     */
         LA    @15,AMDTPRTX                                        0519
         ST    @15,NEXTLINE(,@10)                                  0519
*   RETCODE=CONTINUE;                                              0520
         SLR   @15,@15                                             0520
         ST    @15,RETCODE(,@10)                                   0520
*   GO TO AMDEXIT;                                                 0521
         B     AMDEXIT                                             0521
*AMDTPRI1:                                                         0522
*                                                                  0522
*   /*****************************************************************/
*   /*                                                               */
*   /* AMDTPRI1 - THIS ROUTINE PROCESSES THE SECOND LINE OF OUPTUT   */
*   /* FOR TPIOS REMOTE INBOUND TRACE RECORDS. FIRST, THE REMOTE     */
*   /* INDICATOR, DNODE LABEL, AND FSB LABEL ARE MOVED TO THE BUFFER */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0522
*   RFY                                                            0522
*     ISTTRF BASED(TRFPTR);                                        0522
AMDTPRI1 DS    0H                                                  0523
*   TRFPTR=DATAADDR+(DATALNG-LENGTH(ISTTRF));/* ISTTRF IS AT END OF
*                                      INPUT RECORD                  */
         L     @10,WORKAREA(,PARMSAVE)                             0523
         L     @15,DATALNG(,@10)                                   0523
         SL    @15,@CF02414                                        0523
         AL    @15,DATAADDR(,PARMSAVE)                             0523
         ST    @15,TRFPTR(,@10)                                    0523
*   IF TRFLSNA='1'B THEN            /* IF LOCAL SNA DEVICE   @XM08361*/
         TM    TRFLSNA(@15),B'00010000'                            0524
         BNO   @RF00524                                            0524
*     TPRILBL=LOCALIND;             /* MOVE LOCAL INDICATOR  @XM08361*/
         MVI   TPRILBL+5(BUFFPTR),C' '                             0525
         MVC   TPRILBL(5,BUFFPTR),LOCALIND                         0525
*   ELSE                            /* NO MUST BE REMOTE     @XM08361*/
*     TPRILBL=REMOTIND;                                            0526
         B     @RC00524                                            0526
@RF00524 MVC   TPRILBL(6,BUFFPTR),REMOTIND                         0526
*   TPRIDNL=DNODELAB;                                              0527
@RC00524 MVC   TPRIDNL(5,BUFFPTR),DNODELAB                         0527
*   TPRIFSBL=FSBLAB;                                               0528
*                                                                  0528
         MVC   TPRIFSBL(3,BUFFPTR),FSBLAB                          0528
*   /*****************************************************************/
*   /*                                                               */
*   /* MOVE THE DESTINATION NODE FROM TRF INTO THE OUTPUT BUFFER     */
*   /*                                                       @XM08361*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0529
*   TPRIDND=TRFDNODE;               /* MOVE IN DNODE                 */
*                                                                  0529
         L     @10,WORKAREA(,PARMSAVE)                             0529
         L     @10,TRFPTR(,@10)                                    0529
         MVC   TPRIDND(8,BUFFPTR),TRFDNODE(@10)                    0529
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP FOR AND CALL HEXFRMT ROUTINE TO FORMAT FSB DATA        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0530
*   RFY                                                            0530
*     ISTZIBUF BASED(DATAADDR);                                    0530
*   DATASTRT=ADDR(ZIBFSB);          /* POINT TO FSB IN RECORD        */
         L     @10,DATAADDR(,PARMSAVE)                             0531
         LA    DATASTRT,ZIBFSB(,@10)                               0531
*   HEXPARM=ADDR(TPHEX3);           /* POINT TO CORRECT PLIST        */
         LA    HEXPARM,TPHEX3                                      0532
*   CALL HEXFRMT;                                                  0533
*                                                                  0533
         BAL   @14,HEXFRMT                                         0533
*   /*****************************************************************/
*   /*                                                               */
*   /* ALL DATA FOR THIS LINE HAS BEEN FORMATTED. SET UP TO PROCESS  */
*   /* NEXT LINE AND RETURN TO EDIT TO PRINT THIS LINE               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0534
*   NEXTLINE=ADDR(AMDTPRI2);        /* NEXT LINE IS FORMATTED BY   0534
*                                      AMDTPRI2                      */
         L     @10,WORKAREA(,PARMSAVE)                             0534
         LA    @15,AMDTPRI2                                        0534
         ST    @15,NEXTLINE(,@10)                                  0534
*   RETCODE=CONTINUE;               /* INDICATE THAT MORE LINES NEED
*                                      TO BE FORMATTED               */
         SLR   @15,@15                                             0535
         ST    @15,RETCODE(,@10)                                   0535
*   GO TO AMDEXIT;                  /* RETURN VIA THE EXIT ROUTINE   */
         B     AMDEXIT                                             0536
*AMDTPRI2:                                                         0537
*                                                                  0537
*   /*****************************************************************/
*   /*                                                               */
*   /* AMDTPRI2 - THIS ROUTINE FORMATS THE THIRD OUTPUT LINE FOR     */
*   /* TPIOS REMOTE INBOUND RECORDS. FIRST, THE THRH LABEL IS MOVED  */
*   /* TO THE BUFFER                                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0537
*   TPRITHL=THRHLAB;                                               0537
*                                                                  0537
AMDTPRI2 MVC   TPRITHL(4,BUFFPTR),THRHLAB                          0537
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP FOR AND CALL SUBROUTINE HEXFRMT TO FORMAT THE TH-RH    */
*   /* DATA                                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0538
*   RFY                                                            0538
*     ISTZIBUF BASED(DATAADDR);                                    0538
*   DATASTRT=ADDR(ZIBBTU);          /* POINT TO THRH FIELD IN INPUT
*                                      RECORD                        */
         L     @10,DATAADDR(,PARMSAVE)                             0539
         LA    DATASTRT,ZIBBTU(,@10)                               0539
*   HEXPARM=ADDR(TPHEX4);           /* POINT TO CORRECT PARAMETER  0540
*                                      LIST                          */
         LA    HEXPARM,TPHEX4                                      0540
*   CALL HEXFRMT;                                                  0541
*                                                                  0541
         BAL   @14,HEXFRMT                                         0541
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR FID1 THRH - IF IT IS, IT IS ONLY 13 BYTES LONG AND  */
*   /* THE LAST 7 FORMATTED BYTES MUST BE BLANKED IN OUTPUT BUFFER   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0542
*   RFY                                                            0542
*     ISTBTU BASED(DATASTRT);                                      0542
*   IF BTUFIDNO='0001'B THEN                                       0543
         LR    @10,DATASTRT                                        0543
         TM    BTUFIDNO(@10),B'00010000'                           0543
         BNO   @RF00543                                            0543
         TM    BTUFIDNO(@10),B'11100000'                           0543
         BNZ   @RF00543                                            0543
*     DO;                                                          0544
*       TPRIFID0='';                /* BLANK OUT THE LAST 9 BYTES    */
*                                                                  0545
         MVI   TPRIFID0(BUFFPTR),C' '                              0545
         MVC   TPRIFID0+1(14,BUFFPTR),TPRIFID0(BUFFPTR)            0545
*       /*************************************************************/
*       /*                                                           */
*       /* THIS LINE IS COMPLETE. SET UP FOR NEXT LINE BY FINDING AND*/
*       /* CALCULATING THE LENGTH OF THE TEXT IN THE INPUT BUFFER    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0546
*       TEXTADDR=ADDR(BTUPAD);      /* FOR FID1, IT BEGINS AT BTUPAD */
         L     @10,WORKAREA(,PARMSAVE)                             0546
         LR    @15,DATASTRT                                        0546
         LA    @15,BTUPAD(,@15)                                    0546
         ST    @15,TEXTADDR(,@10)                                  0546
*     END;                          /* END OF FID1 PATH              */
*   ELSE                                                           0548
*     TEXTADDR=ADDR(BTUTEXT);       /* FOR FID0, IT BEGINS AT BTUTEXT*/
         B     @RC00543                                            0548
@RF00543 L     @10,WORKAREA(,PARMSAVE)                             0548
         LR    @15,DATASTRT                                        0548
         LA    @15,BTUTEXT(,@15)                                   0548
         ST    @15,TEXTADDR(,@10)                                  0548
*   TEXTLN=DATALNG-((TEXTADDR-DATAADDR)+LENGTH(ISTTRF));/* THE TEXT
*                                      IS WHATS LEFT AFTER PREFIX AND
*                                      TRAILER IS REMOVED            */
*                                                                  0549
@RC00543 L     @10,WORKAREA(,PARMSAVE)                             0549
         L     @15,TEXTADDR(,@10)                                  0549
         SL    @15,DATAADDR(,PARMSAVE)                             0549
         AL    @15,@CF02414                                        0549
         LCR   @15,@15                                             0549
         AL    @15,DATALNG(,@10)                                   0549
         ST    @15,TEXTLN(,@10)                                    0549
*   /*****************************************************************/
*   /*                                                               */
*   /* INDICATE NEXT ROUTINE TO PROCESS AND RETURN VIA EXIT ROUTINE  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0550
*   NEXTLINE=ADDR(AMDTPRTX);        /* NEXT LINE IS PROCESSED BY   0550
*                                      AMDTPRTX                      */
         LA    @15,AMDTPRTX                                        0550
         ST    @15,NEXTLINE(,@10)                                  0550
*   RETCODE=CONTINUE;               /* INDICATE MORE DATA HAS TO BE
*                                      FORMATTED                     */
         SLR   @15,@15                                             0551
         ST    @15,RETCODE(,@10)                                   0551
*   GO TO AMDEXIT;                  /* RETURN TO CALLER VIA THE EXIT
*                                      ROUTINE                       */
         B     AMDEXIT                                             0552
*AMDTPRO1:                                                         0553
*                                                                  0553
*   /*****************************************************************/
*   /*                                                               */
*   /* AMDTPRO1 - THIS ROUTINE FORMATS THE SECOND OUTPUT LINE FOR    */
*   /* TPIOS REMOTE OUTBOUND DATA. FIRST, THE REMOTE INDICATOR, DNODE*/
*   /* LABEL, AND THRH LABEL ARE MOVED TO THE OUTPUT BUFFER          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0553
*   TRFPTR=DATAADDR+(DATALNG-LENGTH(ISTTRF));                      0553
AMDTPRO1 L     @10,WORKAREA(,PARMSAVE)                             0553
         L     @15,DATALNG(,@10)                                   0553
         SL    @15,@CF02414                                        0553
         AL    @15,DATAADDR(,PARMSAVE)                             0553
         ST    @15,TRFPTR(,@10)                                    0553
*   RFY                                                            0554
*     ISTTRF BASED(TRFPTR);                                        0554
*   IF TRFLSNA='1'B                 /* IS THIS A LOCAL SNA DEVICE  0555
*                                                            @XM08361*/
*     THEN                          /* YES MOVE LOCAL INDICATOR    0555
*                                                            @XM08361*/
         TM    TRFLSNA(@15),B'00010000'                            0555
         BNO   @RF00555                                            0555
*     TPROLBL=LOCALIND;             /*                       @XM08361*/
         MVI   TPROLBL+5(BUFFPTR),C' '                             0556
         MVC   TPROLBL(5,BUFFPTR),LOCALIND                         0556
*   ELSE                            /* NO - MUST BE REMOTE   @XM08361*/
*     TPROLBL=REMOTIND;             /*                       @XM08361*/
         B     @RC00555                                            0557
@RF00555 MVC   TPROLBL(6,BUFFPTR),REMOTIND                         0557
*   TPRODNL=DNODELAB;                                              0558
@RC00555 MVC   TPRODNL(5,BUFFPTR),DNODELAB                         0558
*   TPROTHL=THRHLAB;                                               0559
*                                                                  0559
         MVC   TPROTHL(4,BUFFPTR),THRHLAB                          0559
*   /*****************************************************************/
*   /*                                                               */
*   /* MOVE THE DESTINATION NODE FROM TRF TO THE OUTPUT BUFFER       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0560
*   TPRODND=TRFDNODE;               /* MOVE DNODE INTO OUTPUT BUFFER */
*                                                                  0560
         L     @10,WORKAREA(,PARMSAVE)                             0560
         L     @10,TRFPTR(,@10)                                    0560
         MVC   TPRODND(8,BUFFPTR),TRFDNODE(@10)                    0560
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP FOR AND CALL SUBROUTINE HEXFRMT TO FORMAT THE TH-RH    */
*   /* DATA                                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0561
*   RFY                                                            0561
*     ISTZOBUF BASED(DATAADDR);                                    0561
*   DATASTRT=ADDR(ZOBBTU);          /* POINT TO THRH FIELD IN INPUT
*                                      RECORD                        */
         L     @10,DATAADDR(,PARMSAVE)                             0562
         LA    DATASTRT,ZOBBTU(,@10)                               0562
*   HEXPARM=ADDR(TPHEX4);           /* POINT TO CORRECT PARAMETER  0563
*                                      LIST                          */
         LA    HEXPARM,TPHEX4                                      0563
*   CALL HEXFRMT;                                                  0564
*                                                                  0564
         BAL   @14,HEXFRMT                                         0564
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR FID1 THRH - IF IT IS, IT IS ONLY 13 BYTES LONG AND  */
*   /* THE LAST 7 FORMATTED BYTES MUST BE BLANKED IN OUTPUT BUFFER   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0565
*   RFY                                                            0565
*     ISTBTU BASED(DATASTRT);                                      0565
*   IF BTUFIDNO='0001'B THEN                                       0566
         LR    @10,DATASTRT                                        0566
         TM    BTUFIDNO(@10),B'00010000'                           0566
         BNO   @RF00566                                            0566
         TM    BTUFIDNO(@10),B'11100000'                           0566
         BNZ   @RF00566                                            0566
*     DO;                                                          0567
*       TPRIFID0='';                /* BLANK OUT THE LAST 9 BYTES    */
*                                                                  0568
         MVI   TPRIFID0(BUFFPTR),C' '                              0568
         MVC   TPRIFID0+1(14,BUFFPTR),TPRIFID0(BUFFPTR)            0568
*       /*************************************************************/
*       /*                                                           */
*       /* THIS LINE IS COMPLETE. SET UP FOR NEXT LINE BY FINDING AND*/
*       /* CALCULATING THE LENGTH OF THE TEXT IN THE INPUT BUFFER    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0569
*       TEXTADDR=ADDR(BTUPAD);      /* FOR FID1, IT BEGINS AT BTUPAD */
         L     @10,WORKAREA(,PARMSAVE)                             0569
         LR    @15,DATASTRT                                        0569
         LA    @15,BTUPAD(,@15)                                    0569
         ST    @15,TEXTADDR(,@10)                                  0569
*     END;                          /* END OF FID1 PATH              */
*   ELSE                                                           0571
*     TEXTADDR=ADDR(BTUTEXT);       /* FOR FID0, IT BEGINS AT BTUTEXT*/
         B     @RC00566                                            0571
@RF00566 L     @10,WORKAREA(,PARMSAVE)                             0571
         LR    @15,DATASTRT                                        0571
         LA    @15,BTUTEXT(,@15)                                   0571
         ST    @15,TEXTADDR(,@10)                                  0571
*   TEXTLN=DATALNG-((TEXTADDR-DATAADDR)+LENGTH(ISTTRF));/* THE TEXT
*                                      IS WHATS LEFT AFTER PREFIX AND
*                                      TRAILER IS REMOVED            */
*                                                                  0572
@RC00566 L     @10,WORKAREA(,PARMSAVE)                             0572
         L     @15,TEXTADDR(,@10)                                  0572
         SL    @15,DATAADDR(,PARMSAVE)                             0572
         AL    @15,@CF02414                                        0572
         LCR   @15,@15                                             0572
         AL    @15,DATALNG(,@10)                                   0572
         ST    @15,TEXTLN(,@10)                                    0572
*   /*****************************************************************/
*   /*                                                               */
*   /* INDICATE NEXT ROUTINE TO PROCESS AND RETURN                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0573
*   NEXTLINE=ADDR(AMDTPRTX);        /* NEXT LINE IS PROCESSED BY   0573
*                                      AMDTPRTX                      */
         LA    @15,AMDTPRTX                                        0573
         ST    @15,NEXTLINE(,@10)                                  0573
*   RETCODE=CONTINUE;               /* INDICATE MORE DATA HAS TO BE
*                                      FORMATTED                     */
         SLR   @15,@15                                             0574
         ST    @15,RETCODE(,@10)                                   0574
*   GO TO AMDEXIT;                  /* RETURN TO CALLER VIA THE EXIT
*                                      ROUTINE                       */
         B     AMDEXIT                                             0575
*AMDTPRTX:                                                         0576
*                                                                  0576
*   /*****************************************************************/
*   /*                                                               */
*   /* AMDTPRTX - THIS ROUTINE PROCESSES THOSE OUTPUT LINES FOR TPIOS*/
*   /* AND FORMAT2 LINE TRACE RECORDS. THE LINES CONTAIN     @Z40GKTQ*/
*   /* ONLY A TEXT LABEL AND DATA(AS OPPOSED TO STATUS)      @Z40GKTQ*/
*   /* INFORMATION. FIRST, THE LABEL IS MOVED IN AND THEN SUBROUTINE */
*   /* FRMTEXT IS CALLED TO FORMAT THE TEXT.                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0576
*   TPTXTLBL=TEXTLAB;               /* MOVE LABEL TO OUTPUT BUFFER   */
AMDTPRTX MVC   TPTXTLBL(4,BUFFPTR),TEXTLAB                         0576
*   CALL FRMTEXT;                   /* SETUP FOR SUBROUTINE HAS    0577
*                                      ALREADY BEEN DONE BY ROUTINE
*                                      WHICH SCHEDULED AMDTPRTX      */
*                                                                  0577
         BAL   @14,FRMTEXT                                         0577
*   /*****************************************************************/
*   /*                                                               */
*   /* OUTPUT LINE IS COMPLETE. IF MORE TEXT REMAINS, THE NEXT LINE  */
*   /* WILL BE HANDLED BY AMDTXTLN. IF NO MORE TEXT, THIS RECORD HAS */
*   /* BEEN COMPLETELY FORMATTED, AND ITS TIME TO GET A NEW ONE,     */
*   /* UNLESS A FORMAT 2 LINE TRACE RECORD IS BEING PROCESSED, IN    */
*   /* WHICH CASE AMDLNE01 IS SELECTED TO BE INVOKED NEXT-HE WILL    */
*   /* THEN MAKE THAT DETERMINATION.                         @Z40GKTQ*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0578
*   IF TEXTLN=0                     /* IF THERE IS NO MORE TEXT    0578
*                                                            @Z40GKTQ*/
*     THEN                          /* IN THIS RECORD        @Z40GKTQ*/
         SLR   @10,@10                                             0578
         L     @15,WORKAREA(,PARMSAVE)                             0578
         C     @10,TEXTLN(,@15)                                    0578
         BNE   @RF00578                                            0578
*     IF INPUTEID=ISTLNEID          /* AND IT'S A LINE TRACE @Z40GKTQ*/
*       THEN                                                       0579
         L     @14,EIDADDR(,PARMSAVE)                              0579
         CLC   INPUTEID(2,@14),@CH00590                            0579
         BNE   @RF00579                                            0579
*       DO;                         /* RECORD, THEN LET      @Z40GKTQ*/
*         NEXTLINE=ADDR(AMDLNE01);  /* AMDLNE01 DECIDE WHAT  @Z40GKTQ*/
         LA    @14,AMDLNE01                                        0581
         ST    @14,NEXTLINE(,@15)                                  0581
*         RETCODE=CONTINUE;         /* TO DO NEXT            @Z40GKTQ*/
         ST    @10,RETCODE(,@15)                                   0582
*       END;                        /*                       @Z40GKTQ*/
*     ELSE                          /* IF IT'S TPIOS         @Z40GKTQ*/
*       RETCODE=GETNEXT;            /* INDICATE VIA RETURN CODE THAT
*                                      ANOTHER INPUT RECORD IS TO BE
*                                      GOTTEN                @Z40GKTQ*/
         B     @RC00579                                            0584
@RF00579 L     @10,WORKAREA(,PARMSAVE)                             0584
         MVC   RETCODE(4,@10),@CF00036                             0584
*   ELSE                                                           0585
*     DO;                                                          0585
         B     @RC00578                                            0585
@RF00578 DS    0H                                                  0586
*       NEXTLINE=ADDR(AMDTXTLN);    /* OTHERWISE, REMAINING LINES  0586
*                                      WILL BE PROCESSED BY AMDTXTLN */
         L     @10,WORKAREA(,PARMSAVE)                             0586
         LA    @15,AMDTXTLN                                        0586
         ST    @15,NEXTLINE(,@10)                                  0586
*       RETCODE=CONTINUE;           /* INDICATE MORE TO DO           */
         SLR   @15,@15                                             0587
         ST    @15,RETCODE(,@10)                                   0587
*     END;                                                         0588
*   GO TO AMDEXIT;                  /* RETURN VIA EXIT ROUTINE       */
         B     AMDEXIT                                             0589
*AMDTXTLN:                                                         0590
*                                                                  0590
*   /*****************************************************************/
*   /*                                                               */
*   /* AMDTXTLN - THIS ROUTINE PROCESSES THOS OUTPUT LINES(TPIOS,    */
*   /* CONTROL LAYER AND FORMAT2 LINE TRACE) WHICH CONTAIN ONLY TEXT */
*   /* INFO. ON ENTRY, VARIABLES TEXTLN AND TEXTADDR CONTAIN THE TEXT*/
*   /* LENGTH AND ADDRESS, RESPECTIVELY                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0590
*   CALL FRMTEXT;                   /* CALL SUBROUTINE TO DO THE   0590
*                                      WORK, SETUP ALREADY HAS BEEN
*                                      DONE                          */
*                                                                  0590
AMDTXTLN BAL   @14,FRMTEXT                                         0590
*   /*****************************************************************/
*   /*                                                               */
*   /* IF MORE TEXT REMAINS TO BE FORMATTED, INDICATE TO EDIT TO     */
*   /* CONTINUE PROCESSING THIS SAME INPUT RECORD. NOTE THAT NEXTLINE*/
*   /* IS STILL SET TO THE ADDRESS OF THIS ROUTINE. IF NO MORE TEXT  */
*   /* REMAINS, INDICATE TO EDIT THAT THE RECORD IS COMPLETE (EXCEPT */
*   /* FOR FORMAT 2 LINE TRACE RECORDS, IN WHICH CASE AMDLNE01 IS SET*/
*   /* UP TO MAKE THAT DETERMINATION).                       @Z40GHTQ*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0591
*   IF TEXTLN=0                     /* ANY TEXT LEFT?        @Z40GKTQ*/
*     THEN                          /* NO TXT LEFT IN THIS REC     0591
*                                                            @Z40GKTQ*/
         SLR   @10,@10                                             0591
         L     @15,WORKAREA(,PARMSAVE)                             0591
         C     @10,TEXTLN(,@15)                                    0591
         BNE   @RF00591                                            0591
*     IF INPUTEID=ISTLNEID          /* IS IT LINE TRACE?     @Z40GKTQ*/
*       THEN                                                       0592
         L     @14,EIDADDR(,PARMSAVE)                              0592
         CLC   INPUTEID(2,@14),@CH00590                            0592
         BNE   @RF00592                                            0592
*       DO;                         /* SET UP AMDLNE01 TO BE @Z40GKTQ*/
*         NEXTLINE=ADDR(AMDLNE01);  /* INVOKED NEXT TIME     @Z40GKTQ*/
         LA    @14,AMDLNE01                                        0594
         ST    @14,NEXTLINE(,@15)                                  0594
*         RETCODE=CONTINUE;         /* AROUND                @Z40GKTQ*/
         ST    @10,RETCODE(,@15)                                   0595
*       END;                        /*                       @Z40GKTQ*/
*     ELSE                          /* IF NOT LINE TRACE,JUST      0597
*                                                            @Z40GKTQ*/
*       RETCODE=GETNEXT;            /* PRINT AND GET NEXT REC      0597
*                                                            @Z40GKTQ*/
         B     @RC00592                                            0597
@RF00592 L     @10,WORKAREA(,PARMSAVE)                             0597
         MVC   RETCODE(4,@10),@CF00036                             0597
*   ELSE                                                           0598
*     RETCODE=CONTINUE;                                            0598
         B     @RC00591                                            0598
@RF00591 L     @10,WORKAREA(,PARMSAVE)                             0598
         SLR   @15,@15                                             0598
         ST    @15,RETCODE(,@10)                                   0598
*   GO TO AMDEXIT;                  /* RETURN VIA THE EXIT ROUTINE   */
         B     AMDEXIT                                             0599
*AMDLNTR2:                          /*                       @ZM41491*/
*                                                                  0600
*   /*****************************************************************/
*   /*                                                               */
*   /* AMDLNTR2 - THIS ROUTINE FORMATS LINE TRACE DA         @ZM41491*/
*   /* 2 ENTRIES PER LINE. ON ENTRY, LINECNT CONTAINS THE NUMBER     */
*   /*                                                       @ZM41491*/
*   /* OF 4-BYTE ENTRIES TO BE FORMATTED, AND LINEADDR CONTAINS      */
*   /*                                                       @ZM41491*/
*   /* ADDRESS OF THE BEGINNING OF THIS DATA. FIRST, THE     @ZM41491*/
*   /* APPROPRIATE LABELS ARE MOVED INTO THE OUTPUT BUFFER   @ZM41491*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0600
*   LN2FIRST=LINELABS;              /* MOVE LABELS INTO FIRST ENTRY
*                                                            @ZM41491*/
AMDLNTR2 MVC   LN2FIRST(37,BUFFPTR),LINELABS                       0600
*   LN2SECND=LINELABS;              /* MOVE LABELS INTO SECOND ENTRY
*                                                            @ZM41491*/
*                                                                  0601
         MVC   LN2SECND(37,BUFFPTR),LINELABS                       0601
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP FOR AND CALL SUBROUTINE HEXFRMT TO FORM        @ZM41491*/
*   /* THE LINE TRACE DATA INTO THE BUFFER                   @ZM41491*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0602
*   DATASTRT=LINEADDR;              /* POINT AT THE DATA     @ZM41491*/
         L     @10,WORKAREA(,PARMSAVE)                             0602
         L     DATASTRT,LINEADDR(,@10)                             0602
*   HEXPARM=ADDR(LNHEX2);           /* GET ADDR OF CORRECT PLIST   0603
*                                                            @ZM41491*/
         LA    HEXPARM,LNHEX2                                      0603
*   CALL HEXFRMT;                   /*                       @ZM41491*/
*                                                                  0604
         BAL   @14,HEXFRMT                                         0604
*   /*****************************************************************/
*   /*                                                               */
*   /* A FULL BYTE OF DATA HAS BEEN FORMATTED FOR THE        @ZM41491*/
*   /* LCD FIELDS, WHICH ARE ONLY HALF-BYTE IN LENGTH. THE EXTR      */
*   /*                                                       @ZM41491*/
*   /* HALF-BYTE WHICH WAS FORMATTED IS THE PCF DATA. EACH OF TH     */
*   /*                                                       @ZM41491*/
*   /* HALF-BYTES OF DATA HAVE BEEN CONVERTED IN THE OUTPUT BUFF     */
*   /*                                                       @ZM41491*/
*   /* BYTES OF PRINTABLE HEX DATA. THE SECOND BYTE OF PRINTABL      */
*   /*                                                       @ZM41491*/
*   /* (REPRESENTING THE SECOND HALF-BYTE OF HEX DATA) IS NOW MO     */
*   /*                                                       @ZM41491*/
*   /* INTO THE PCF FIELDS FOR BOTH ENTRIES IN THE OUTPUT BUFFER     */
*   /*                                                       @ZM41491*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0605
*   LN2PCFD1=LN2LCDE1;              /* MOVE PCF DATA         @ZM41491*/
         MVC   LN2PCFD1(1,BUFFPTR),LN2LCDE1(BUFFPTR)               0605
*   LN2LCDE1=' ';                   /* BLANK OUT THE BYTE JUST MOVED
*                                                            @ZM41491*/
         MVI   LN2LCDE1(BUFFPTR),C' '                              0606
*   LN2PCFD2=LN2LCDE2;              /* MOVE PCF DATA IN SECOND ENTRY
*                                                            @ZM41491*/
         MVC   LN2PCFD2(1,BUFFPTR),LN2LCDE2(BUFFPTR)               0607
*   LN2LCDE2=' ';                   /* BLANK OUT EXTRA BYTE  @ZM41491*/
*                                                                  0608
         MVI   LN2LCDE2(BUFFPTR),C' '                              0608
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS LINE IS COMPLETE. CALCULATE THE REMAININ         @ZM41491*/
*   /* OF 4-BYTE ENTRIES REMAINING, AND SET THE PROPER RETURN        */
*   /* CODE@ZM41491                                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0609
*   LINECNT=LINECNT-2;              /* DECREMENT BY THE 2 JUST     0609
*                                      FORMATED@ZM41491              */
         L     @10,WORKAREA(,PARMSAVE)                             0609
         L     @15,LINECNT(,@10)                                   0609
         BCTR  @15,0                                               0609
         BCTR  @15,0                                               0609
         ST    @15,LINECNT(,@10)                                   0609
*   IF LINECNT>0 THEN                                              0610
         SLR   @14,@14                                             0610
         CR    @15,@14                                             0610
         BNH   @RF00610                                            0610
*     DO;                           /* IF MORE ENTRIES REMAIN, SET UP
*                                                            @ZM41491
*                                      FOR THE NEXT LINE     @ZM41491*/
*       LINEADDR=LINEADDR+8;        /* INCREMENT DATA ADDRESS      0612
*                                                            @ZM41491
*                                      8 BYTES JUST FORMATTED      0612
*                                                            @ZM41491*/
         LA    @15,8                                               0612
         AL    @15,LINEADDR(,@10)                                  0612
         ST    @15,LINEADDR(,@10)                                  0612
*       RETCODE=CONTINUE;           /* SET RC TO INDICATE MORE TO DO
*                                                            @ZM41491*/
         ST    @14,RETCODE(,@10)                                   0613
*     END;                          /* END OF MORE-TO-FORMAT PATH  0614
*                                                            @ZM41491*/
*   ELSE                                                           0615
*     DO;                           /* OTHERWISE, ALL DATA HAS BEEN
*                                      FORMATTED             @ZM41491*/
         B     @RC00610                                            0615
@RF00610 DS    0H                                                  0616
*       IF LINECNT<0 THEN                                          0616
         L     @10,WORKAREA(,PARMSAVE)                             0616
         L     @10,LINECNT(,@10)                                   0616
         LTR   @10,@10                                             0616
         BNM   @RF00616                                            0616
*         LN2SECND='';              /* IF COUNT HAS GONE     @ZM41491
*                                      NEGATIVE, ONE TOO MANY ENTRIES
*                                      HAVE BEEN FORMATTED   @ZM41491
*                                      SECOND ONE IS BLANKED OUT   0617
*                                                            @ZM41491*/
         MVI   LN2SECND(BUFFPTR),C' '                              0617
         MVC   LN2SECND+1(36,BUFFPTR),LN2SECND(BUFFPTR)            0617
*       RETCODE=GETNEXT;            /* SET RC TO SHOW COMPLETION   0618
*                                                            @ZM41491*/
@RF00616 L     @10,WORKAREA(,PARMSAVE)                             0618
         MVC   RETCODE(4,@10),@CF00036                             0618
*     END;                          /* END OF NEGATIVE-OR-ZERO PATH
*                                                            @ZM41491*/
*   GO TO AMDEXIT;                  /* RETURN VIA THE EXIT ROUTINE 0620
*                                                            @ZM41491*/
*                                                                  0620
         B     AMDEXIT                                             0620
*   /*****************************************************************/
*   /*                                                               */
*   /* FORMAT FIRST LINE OF SMS BUFFER TRACE                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0621
*AMDSMS01:                                                         0621
*   ;                                                              0621
AMDSMS01 DS    0H                                                  0622
*   IOLABEL=IOCHAR;                 /* IO POOL LABEL         @ZA10433*/
         MVC   IOLABEL(2,BUFFPTR),IOCHAR                           0622
*   PPLABEL=PPCHAR;                 /* PP POOL LABEL         @ZA10433*/
         MVC   PPLABEL(2,BUFFPTR),PPCHAR                           0623
*   LPLABEL=LPCHAR;                 /* LP POOL LABEL         @ZA10433*/
         MVC   LPLABEL(2,BUFFPTR),LPCHAR                           0624
*   WPLABEL=WPCHAR;                 /* WP POOL LABEL         @ZA10433*/
         MVC   WPLABEL(2,BUFFPTR),WPCHAR                           0625
*   DATASTRT=DATAADDR;              /* ADDRESS OF DATA TO FORMAT     */
         L     DATASTRT,DATAADDR(,PARMSAVE)                        0626
*   HEXPARM=ADDR(SFHEX);            /* PATTERN OF FORMAT     @ZA13637*/
         LA    HEXPARM,SFHEX                                       0627
*   CALL HEXFRMT;                   /* FORMAT POOL DATA              */
         BAL   @14,HEXFRMT                                         0628
*   DATASTRT=DATASTRT+POOLSZ;       /* BUMP TO NEXT POOL             */
         AL    DATASTRT,@CF00060                                   0629
*   HEXPARM=ADDR(SPHEX);            /* PATTERN OF FORMAT     @ZA13637*/
         LA    HEXPARM,SPHEX                                       0630
*   CALL HEXFRMT;                   /* FORMAT POOL DATA              */
         BAL   @14,HEXFRMT                                         0631
*   DATASTRT=DATASTRT+POOLSZ;       /* BUMP TO NEXT POOL             */
         AL    DATASTRT,@CF00060                                   0632
*   HEXPARM=ADDR(LFHEX);            /* PATTERN OF FORMAT     @ZA13637*/
         LA    HEXPARM,LFHEX                                       0633
*   CALL HEXFRMT;                   /* FORMAT POOL DATA              */
         BAL   @14,HEXFRMT                                         0634
*   DATASTRT=DATASTRT+POOLSZ;       /* BUMP TO NEXT POOL             */
         AL    DATASTRT,@CF00060                                   0635
*   HEXPARM=ADDR(LPHEX);            /* PATTERN OF FORMAT     @ZA13637*/
         LA    HEXPARM,LPHEX                                       0636
*   CALL HEXFRMT;                   /* FORMAT POOL DATA              */
         BAL   @14,HEXFRMT                                         0637
*   RETCODE=CONTINUE;               /* INDICATE MORE LINES           */
         L     @10,WORKAREA(,PARMSAVE)                             0638
         SLR   @15,@15                                             0638
         ST    @15,RETCODE(,@10)                                   0638
*   NEXTLINE=ADDR(AMDSMS02);        /* SECOND LINE PROCESSOR         */
         LA    @15,AMDSMS02                                        0639
         ST    @15,NEXTLINE(,@10)                                  0639
*   GOTO AMDEXIT;                   /* RETURN TO EDIT TO PRINT       */
*                                                                  0640
         B     AMDEXIT                                             0640
*   /*****************************************************************/
*   /*                                                               */
*   /* FORMAT SECOND LINE OF SMS BUFFER TRACE                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0641
*AMDSMS02:                                                         0641
*   ;                                                              0641
AMDSMS02 DS    0H                                                  0642
*   NPLABEL=NPCHAR;                 /* NP POOL LABEL         @ZA10433*/
         MVC   NPLABEL(2,BUFFPTR),NPCHAR                           0642
*   LFLABEL=LFCHAR;                 /* LF POOL LABEL         @ZA10433*/
         MVC   LFLABEL(2,BUFFPTR),LFCHAR                           0643
*   CRLABEL=CRCHAR;                 /* CR POOL LABEL         @ZA10433*/
         MVC   CRLABEL(2,BUFFPTR),CRCHAR                           0644
*   UELABEL=UECHAR;                 /* UE POOL LABEL         @ZA10433*/
         MVC   UELABEL(2,BUFFPTR),UECHAR                           0645
*   DATASTRT=DATAADDR+LINESZ;       /* ADDRESS OF SECOND LINE DATA   */
         LA    DATASTRT,32                                         0646
         AL    DATASTRT,DATAADDR(,PARMSAVE)                        0646
*   HEXPARM=ADDR(UEHEX);            /* PATTERN OF FORMAT     @ZA13637*/
         LA    HEXPARM,UEHEX                                       0647
*   CALL HEXFRMT;                   /* FORMAT POOL DATA              */
         BAL   @14,HEXFRMT                                         0648
*   DATASTRT=DATASTRT+POOLSZ;       /* BUMP TO NEXT POOL             */
         AL    DATASTRT,@CF00060                                   0649
*   HEXPARM=ADDR(IOHEX);            /* PATTERN OF FORMAT     @ZA13637*/
         LA    HEXPARM,IOHEX                                       0650
*   CALL HEXFRMT;                   /* FORMAT POOL DATA              */
         BAL   @14,HEXFRMT                                         0651
*   DATASTRT=DATASTRT+POOLSZ;       /* BUMP TO NEXT POOL             */
         AL    DATASTRT,@CF00060                                   0652
*   HEXPARM=ADDR(WPHEX);            /* PATTERN OF FORMAT     @ZA13637*/
         LA    HEXPARM,WPHEX                                       0653
*   CALL HEXFRMT;                   /* FORMAT POOL DATA              */
         BAL   @14,HEXFRMT                                         0654
*   DATASTRT=DATASTRT+POOLSZ;       /* BUMP TO NEXT POOL             */
         AL    DATASTRT,@CF00060                                   0655
*   HEXPARM=ADDR(APHEX);            /* PATTERN OF FORMAT     @ZA13637*/
         LA    HEXPARM,APHEX                                       0656
*   CALL HEXFRMT;                   /* FORMAT POOL DATA              */
         BAL   @14,HEXFRMT                                         0657
*   RETCODE=CONTINUE;               /* INDICATE MORE LINES           */
         L     @10,WORKAREA(,PARMSAVE)                             0658
         SLR   @15,@15                                             0658
         ST    @15,RETCODE(,@10)                                   0658
*   NEXTLINE=ADDR(AMDSMS03);        /* THIRD LINE PROCESSOR          */
         LA    @15,AMDSMS03                                        0659
         ST    @15,NEXTLINE(,@10)                                  0659
*   GOTO AMDEXIT;                   /* RETURN TO EDIT TO PRINT       */
*                                                                  0660
         B     AMDEXIT                                             0660
*   /*****************************************************************/
*   /*                                                               */
*   /* FORMAT THIRD LINE OF SMS BUFFER TRACE                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0661
*AMDSMS03:                                                         0661
*   ;                                                              0661
AMDSMS03 DS    0H                                                  0662
*   SFLABEL=SFCHAR;                 /* SF POOL LABEL         @ZA10433*/
         MVC   SFLABEL(2,BUFFPTR),SFCHAR                           0662
*   SPLABEL=SPCHAR;                 /* SP POOL LABEL         @ZA10433*/
         MVC   SPLABEL(2,BUFFPTR),SPCHAR                           0663
*   APLABEL=APCHAR;                 /* AP POOL LABEL         @ZA10433*/
         MVC   APLABEL(2,BUFFPTR),APCHAR                           0664
*   DATASTRT=DATAADDR+(LINESZ*2);   /* THIRD LINE START              */
         LA    DATASTRT,64                                         0665
         AL    DATASTRT,DATAADDR(,PARMSAVE)                        0665
*   HEXPARM=ADDR(PPHEX);            /* PATTERN OF FORMAT     @ZA13637*/
         LA    HEXPARM,PPHEX                                       0666
*   CALL HEXFRMT;                   /* FORMAT POOL DATA              */
         BAL   @14,HEXFRMT                                         0667
*   DATASTRT=DATASTRT+POOLSZ;       /* BUMP TO NEXT POOL             */
         AL    DATASTRT,@CF00060                                   0668
*   HEXPARM=ADDR(NPHEX);            /* PATTERN OF FORMAT     @ZA13637*/
         LA    HEXPARM,NPHEX                                       0669
*   CALL HEXFRMT;                   /* FORMAT POOL DATA              */
         BAL   @14,HEXFRMT                                         0670
*   DATASTRT=DATASTRT+POOLSZ;       /* BUMP TO NEXT POOL             */
         AL    DATASTRT,@CF00060                                   0671
*   HEXPARM=ADDR(CRHEX);            /* PATTERN OF FORMAT     @ZA13637*/
         LA    HEXPARM,CRHEX                                       0672
*   CALL HEXFRMT;                   /* FORMAT POOL DATA              */
         BAL   @14,HEXFRMT                                         0673
*   RETCODE=GETNEXT;                /* INDICATE NO MORE LINES        */
         L     @10,WORKAREA(,PARMSAVE)                             0674
         MVC   RETCODE(4,@10),@CF00036                             0674
*   GOTO AMDEXIT;                   /* RETURN TO EDIT TO PRINT       */
         B     AMDEXIT                                             0675
*AMDLNE01:                          /*                       @Z40GKTQ*/
*                                                                  0676
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SUBROUTINE IS INVOKED DURING FORMAT 2 LINE       @Z40GKTQ*/
*   /* TRACE PROCESSING. IT HANDLES THE FIRST OUTPUT LINE FOR A      */
*   /*                                                       @Z40GKTQ*/
*   /* SERIES OF THE SAME TYPE OF LINE (THAT IS, DATA OR STATUS).    */
*   /*                                                       @Z40GKTQ*/
*   /* FOR STATUS, IT MOVES IN THE LABELS; FOR DATA IT MERELY        */
*   /*                                                       @Z40GKTQ*/
*   /* SETS UP A BRANCH TO AMDTPRTX.                         @Z40GKTQ*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0676
*   RETCODE=CONTINUE;               /* INITIALIZE RETURN CODE      0676
*                                                            @Z40GKTQ*/
*                                                                  0676
AMDLNE01 L     @10,WORKAREA(,PARMSAVE)                             0676
         SLR   @15,@15                                             0676
         ST    @15,RETCODE(,@10)                                   0676
*   /*****************************************************************/
*   /*                                                               */
*   /* LINEADDR, AS MAINTAINED IN PASSAREA, WILL BE          @Z40GKTQ*/
*   /* UPDATED TO POINT TO THE INFORMATION BLOCK CURRENTLY BEING     */
*   /*                                                       @Z40GKTQ*/
*   /* WORKED ON.                                            @Z40GKTQ*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0677
*   IF LINEADDR>=TRFPTR             /* WHEN LINEADDR CONTAINS THE  0677
*                                      TRAILER ADDRESS, ALL INFO HAS
*                                      BEEN PROCESSED.       @Z40GKTQ*/
*     THEN                                                         0677
         CLC   LINEADDR(4,@10),TRFPTR(@10)                         0677
         BL    @RF00677                                            0677
*     RETCODE=IGNORE;               /* RC=8 MEANS GET THE NEXT RECORD
*                                      WITHOUT PRINTING A LINE     0678
*                                                            @Z40GKTQ*/
         MVC   RETCODE(4,@10),@CF00060                             0678
*   ELSE                                                           0679
*     DO;                           /* WE HAVE MORE INFORMATION TO 0679
*                                      PRINT ON THIS LINE    @Z40GKTQ*/
         B     @RC00677                                            0679
@RF00677 DS    0H                                                  0680
*       IF BLKTYPE=OFF              /* FIRST BIT ON MEANS DATA     0680
*                                                            @Z40GKTQ*/
*         THEN                                                     0680
         L     @10,WORKAREA(,PARMSAVE)                             0680
         L     @15,LINEADDR(,@10)                                  0680
         TM    BLKTYPE(@15),B'10000000'                            0680
         BNZ   @RF00680                                            0680
*         DO;                       /* MOVE IN LABELS:       @Z40GKTQ*/
*           LLABEL=LINELABE;        /*                       @Z40GKTQ*/
         MVC   LLABEL(79,BUFFPTR),LINELABE                         0682
*           TEMPCNT=BLKCNT;         /* SAVE THAT COUNT IN A TEMPORARY
*                                      AREA SO THAT YOU CAN BUMP THE
*                                      POINTER PAST THE COUNT IN THE
*                                      GTF RECORD.           @Z40GKTQ*/
         IC    @14,BLKCNT(,@15)                                    0683
         STC   @14,TEMPCNT(,@10)                                   0683
*           LINEADDR=LINEADDR+2;    /* BUMP THAT PTR         @Z40GKTQ*/
         AL    @15,@CF00042                                        0684
         ST    @15,LINEADDR(,@10)                                  0684
*           NEXTLINE=ADDR(AMDLNE02);/* AMDLNE02 WILL FORMAT THE    0685
*                                      STATUS INTO A PRINTABLE LINE
*                                                            @Z40GKTQ*/
         LA    @15,AMDLNE02                                        0685
         ST    @15,NEXTLINE(,@10)                                  0685
*         END;                      /*                       @Z40GKTQ*/
*       ELSE                                                       0687
*         DO;                       /* IT'S A BLOCK OF DATA  @Z40GKTQ*/
         B     @RC00680                                            0687
@RF00680 DS    0H                                                  0688
*           TEXTADDR=LINEADDR+2;    /* POINT INPUT PARAMETER TO START
*                                      OF TEXT               @Z40GKTQ*/
         L     @10,WORKAREA(,PARMSAVE)                             0688
         L     @15,LINEADDR(,@10)                                  0688
         LA    @14,2                                               0688
         ALR   @14,@15                                             0688
         ST    @14,TEXTADDR(,@10)                                  0688
*           TEXTLN=BLKCNT;          /* SIZE PARAMETER        @Z40GKTQ*/
         SLR   @09,@09                                             0689
         IC    @09,BLKCNT(,@15)                                    0689
         ST    @09,TEXTLN(,@10)                                    0689
*           LINEADDR=LINEADDR+2+BLKCNT;/* UPDATE LINEADDR HERE,    0690
*                                      BECAUSE AMDTPRTX DOESN'T DO 0690
*                                      IT.                   @Z40GKTQ*/
         ALR   @14,@09                                             0690
         ST    @14,LINEADDR(,@10)                                  0690
*         END;                      /*                       @Z40GKTQ*/
*     END;                          /* END OF 'INFO LEFT IN RECORD'
*                                      GRP                           */
@RC00680 DS    0H                                                  0693
*   IF NEXTLINE=ADDR(AMDLNE02)      /* IF IT IS A STATUS BLOCK     0693
*                                                            @Z40GKTQ*/
*       RETCODE=IGNORE             /* OR END OF RECORD      @Z40GKTQ*/
*     THEN                                                         0693
@RC00677 L     @10,WORKAREA(,PARMSAVE)                             0693
         LA    @15,AMDLNE02                                        0693
         C     @15,NEXTLINE(,@10)                                  0693
         BE    @RT00693                                            0693
         CLC   RETCODE(4,@10),@CF00060                             0693
         BE    @RT00693                                            0693
*     GOTO AMDEXIT;                 /* THEN EXIT IT CALLER   @Z40GKTQ*/
*   ELSE                                                           0695
*     GOTO AMDTPRTX;                /* OTHERWISE FORMAT DATA @Z40GKTQ*/
         B     AMDTPRTX                                            0695
*AMDLNE02:                          /*                       @Z40GKTQ*/
*                                                                  0696
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SUBROUTINE IS INVOKED TO EDIT FORMAT 2 STATUS BLOCKS. THE*/
*   /* SUBROUTINE HEXFRMT DOES THE ACTUAL FORMATTING-AMDLNE02 SETS UP*/
*   /* THE CALL, MOVES ONE BYTE OF INFORMATION NOT MOVED BY HEXFRMT, */
*   /* AND THEN SETS UP THE NEXT CALL TO AMDUSRFD.           @Z40GKTQ*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0696
*/* SET UP AND CALL HEXFRMT SUBROUTINE TO DO THE FORMATTING  @Z40GKTQ*/
*                                                                  0696
*   DATASTRT=LINEADDR;              /* HEXFRMT USES THIS AS THE PTR
*                                      TO STATUS BYTES TO BE HANDLED.
*                                                            @Z40GKTQ*/
AMDLNE02 L     @10,WORKAREA(,PARMSAVE)                             0696
         L     DATASTRT,LINEADDR(,@10)                             0696
*   HEXPARM=ADDR(LNHEX2E);          /* POINT TO HEXFRMT PLIST      0697
*                                                            @Z40GKTQ*/
         LA    HEXPARM,LNHEX2E                                     0697
*   CALL HEXFRMT;                   /* DO IT                 @Z40GKTQ*/
         BAL   @14,HEXFRMT                                         0698
*   TEMPCNT=TEMPCNT-8;              /* WE PROCESSED 8 BYTES, SO DECR
*                                      THE COUNT             @Z40GKTQ*/
         L     @10,WORKAREA(,PARMSAVE)                             0699
         LA    @15,8                                               0699
         SLR   @14,@14                                             0699
         IC    @14,TEMPCNT(,@10)                                   0699
         SLR   @14,@15                                             0699
         STC   @14,TEMPCNT(,@10)                                   0699
*   LINEADDR=LINEADDR+8;            /* AND INCREMENT THE PTR @Z40GKTQ*/
         AL    @15,LINEADDR(,@10)                                  0700
         ST    @15,LINEADDR(,@10)                                  0700
*   LNSPCF=LNSLCD(2);               /* HEXFMT LEFT THE PCF BYTE    0701
*                                      APPENDED TO THE LCD BYTE    0701
*                                                            @Z40GKTQ*/
         MVC   LNSPCF(1,BUFFPTR),LNSLCD+1(BUFFPTR)                 0701
*   LNSLCD(2)=' ';                  /* BLANK OUT THE 2ND BYTE      0702
*                                                            @Z40GKTQ*/
         MVI   LNSLCD+1(BUFFPTR),C' '                              0702
*   IF TEMPCNT>0                    /* TEMPCNT IS THE RUNNING COUNT
*                                      OF STATUS BYTES WITHIN THE  0703
*                                      CURRENT INFORMATION BLOCK   0703
*                                                            @Z40GKTQ*/
*     THEN                                                         0703
         CLI   TEMPCNT(@10),0                                      0703
         BNH   @RF00703                                            0703
*     DO;                           /* IF THERE ARE ANY LEFT @Z40GKTQ*/
*       RETCODE=CONTINUE;           /* THEN SET UP NEXT LINE @Z40GKTQ*/
         SLR   @15,@15                                             0705
         ST    @15,RETCODE(,@10)                                   0705
*       NEXTLINE=ADDR(AMDLNE02);    /* TO BE DONE BY AMDLNE02@Z40GKTQ*/
         LA    @15,AMDLNE02                                        0706
         ST    @15,NEXTLINE(,@10)                                  0706
*     END;                          /*                       @Z40GKTQ*/
*   ELSE                                                           0708
*     DO;                           /* NO MORE STATUS BYTES IN THIS
*                                      PARTICULAR BLOCK      @Z40GKTQ*/
         B     @RC00703                                            0708
@RF00703 DS    0H                                                  0709
*       IF LINEADDR>=TRFPTR         /* IS THERE ANOTHER BLOCK WITHIN
*                                      THIS GTF RECORD?      @Z40GKTQ*/
*         THEN                      /* NO-                   @Z40GKTQ*/
         L     @10,WORKAREA(,PARMSAVE)                             0709
         CLC   LINEADDR(4,@10),TRFPTR(@10)                         0709
         BL    @RF00709                                            0709
*         RETCODE=GETNEXT;          /* PRINT LINE, GET NEXT RECORD 0710
*                                                            @Z40GKTQ*/
         MVC   RETCODE(4,@10),@CF00036                             0710
*       ELSE                        /* YES-                  @Z40GKTQ*/
*         IF BLKTYPE=ON             /* IS IT DATA?           @Z40GKTQ*/
*           THEN                                                   0711
         B     @RC00709                                            0711
@RF00709 L     @10,WORKAREA(,PARMSAVE)                             0711
         L     @15,LINEADDR(,@10)                                  0711
         TM    BLKTYPE(@15),B'10000000'                            0711
         BNO   @RF00711                                            0711
*           DO;                     /* YES-                  @Z40GKTQ*/
*             NEXTLINE=ADDR(AMDLNE01);/* SET UP INVOCATION   @Z40GKTQ*/
         LA    @15,AMDLNE01                                        0713
         ST    @15,NEXTLINE(,@10)                                  0713
*             RETCODE=CONTINUE;     /* TO PROCESS IT AFTER PRINTING
*                                      THIS LINE.            @Z40GKTQ*/
         SLR   @15,@15                                             0714
         ST    @15,RETCODE(,@10)                                   0714
*           END;                    /*                       @Z40GKTQ*/
*         ELSE                                                     0716
*           DO;                     /* NEXT BLK HAS STATUS   @Z40GKTQ*/
         B     @RC00711                                            0716
@RF00711 DS    0H                                                  0717
*             TEMPCNT=BLKCNT;       /* GET BYTE COUNT FROM THAT BLOCK
*                                                            @Z40GKTQ*/
         L     @10,WORKAREA(,PARMSAVE)                             0717
         L     @15,LINEADDR(,@10)                                  0717
         IC    @14,BLKCNT(,@15)                                    0717
         STC   @14,TEMPCNT(,@10)                                   0717
*             LINEADDR=LINEADDR+2;  /* POINT PAST 2-BYTE HDR @Z40GKTQ*/
         AL    @15,@CF00042                                        0718
         ST    @15,LINEADDR(,@10)                                  0718
*             NEXTLINE=ADDR(AMDLNE02);/* SET NEXT PROCESSOR  @Z40GKTQ*/
         LA    @15,AMDLNE02                                        0719
         ST    @15,NEXTLINE(,@10)                                  0719
*             RETCODE=CONTINUE;     /* PRINT LINE, CONTINUE        0720
*                                      PROCESSING THIS RECORD      0720
*                                                            @Z40GKTQ*/
         SLR   @15,@15                                             0720
         ST    @15,RETCODE(,@10)                                   0720
*           END;                    /* END STATUS PROCESSING @Z40GKTQ*/
*     END;                          /* END 'NO MORE STATUS BYTES IN
*                                      THIS BLOCK' LEG       @Z40GKTQ*/
*   GO TO AMDEXIT;                  /* RETURN TO CALLING EDIT ROUTINE
*                                                            @Z40GKTQ*/
*                                                                  0723
         B     AMDEXIT                                             0723
*   /*****************************************************************/
*   /*                                                               */
*   /* SUBROUTINES                                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0724
*FRMTEXT:                                                          0724
*   PROC;                                                          0724
*                                                                  0724
FRMTEXT  STM   @14,@12,@SA00002                                    0724
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SUBROUTINE IS CALLED TO FORMAT THE TEXT PORTION OF       */
*   /* CONTROL LAYER AND TPIOS RECORDS. ITS OUTPUT INCLUDES THE      */
*   /* PRINTABLE HEX PORTION(FOR WHICH SUBROUTINE HEXFRMT IS CALLED) */
*   /* AND THE EBCDIC TRANSLATION PORTION. ON ENTRY, TEXTLN CONTAINS */
*   /* THE LENGTH OF THE TEXT WHICH NEEDS TO BE FORMATTED, AND       */
*   /* TEXTADDR CONTAINS THE BEGINNING ADDRESS OF THIS TEXT. BOTH OF */
*   /* THESE VARIABLES ARE UPDATED BY THIS SUBROUTINE AND REFLECT    */
*   /* UPDATED VALUES UPON RETURN FROM THIS ROUTINE. FIRST, IT MUST  */
*   /* BE DETERMINED WHETHER TEXT IS AVAILABLE TO BE FORMATTED       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0725
*   IF CONFTEXT='1'B THEN                                          0725
         L     @10,WORKAREA(,PARMSAVE)                             0725
         TM    CONFTEXT(@10),B'10000000'                           0725
         BO    @RT00725                                            0725
*     RETURN;                       /* IF THIS FLAG IS SET, IT HAS 0726
*                                      ALREADY BEEN DETERMINED THAT
*                                      THE TEXT IS CONFIDENTIAL AND
*                                      NOTHING NEEDS TO BE DONE ON 0726
*                                      THIS CALL                     */
*                                                                  0726
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINATION OF CONFIDENTIALITY MUST BE MADE. THE INDICATING */
*   /* FLAG IS IN THE INPUT RECORD BUT IS IN DIFFERENT LOCATIONS FOR */
*   /* TPIOS AND CONTROL LAYER RECORDS                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0727
*   IF INPUTEID=ISTCLEID THEN                                      0727
         L     @15,EIDADDR(,PARMSAVE)                              0727
         CLC   INPUTEID(2,@15),@CH00592                            0727
         BNE   @RF00727                                            0727
*     DO;                           /* FOR CONTROL LAYER, IT IS IN 0728
*                                      ISTTRAC, AT THE FRONT OF THE
*                                      INPUT                         */
*       RFY                                                        0729
*         ISTTRAC BASED(DATAADDR);                                 0729
*       IF TRACXTF='1'B THEN                                       0730
         L     @15,DATAADDR(,PARMSAVE)                             0730
         TM    TRACXTF(@15),B'00100000'                            0730
         BNO   @RF00730                                            0730
*         CONFTEXT='1'B;            /* SET THE INTERNAL FLAG IF    0731
*                                      INDICATED                     */
         OI    CONFTEXT(@10),B'10000000'                           0731
*     END;                          /* END OF C/L PATH               */
*   ELSE                                                           0733
*     DO;                           /* FOR TPIOS, BIT TO CHECK IS IN
*                                      ISTTRF, AT THE END            */
         B     @RC00727                                            0733
@RF00727 DS    0H                                                  0734
*       TRFPTR=DATAADDR+(DATALNG-LENGTH(ISTTRF));/* FIND ISTTRF      */
         L     @10,WORKAREA(,PARMSAVE)                             0734
         L     @15,DATALNG(,@10)                                   0734
         SL    @15,@CF02414                                        0734
         AL    @15,DATAADDR(,PARMSAVE)                             0734
         ST    @15,TRFPTR(,@10)                                    0734
*       RFY                                                        0735
*         ISTTRF BASED(TRFPTR);                                    0735
*       IF TRFCXTF='1'B THEN                                       0736
         TM    TRFCXTF(@15),B'00100000'                            0736
         BNO   @RF00736                                            0736
*         CONFTEXT='1'B;            /* INDICATE INTERNALLY IF      0737
*                                      INDICATED EXTERNALLY          */
         OI    CONFTEXT(@10),B'10000000'                           0737
*     END;                          /* END OF TPIOS PATH             */
*                                                                  0738
@RF00736 DS    0H                                                  0739
*   /*****************************************************************/
*   /*                                                               */
*   /* NOW IF CONFTEXT IS ON, IT WAS JUST SET AND IT MUST BE         */
*   /* INDICATED IN THE OUTPUT BUFFER THAT CONFIDENTIAL TEXT WAS     */
*   /* FOUND                                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0739
*   IF CONFTEXT='1'B THEN                                          0739
@RC00727 L     @10,WORKAREA(,PARMSAVE)                             0739
         TM    CONFTEXT(@10),B'10000000'                           0739
         BNO   @RF00739                                            0739
*     DO;                                                          0740
*       TEXTHEX=CONFMSG;            /* MOVE CONFIDENTIAL MESSAGE TO
*                                      BUFFER                        */
         MVI   TEXTHEX+27(BUFFPTR),C' '                            0741
         MVC   TEXTHEX+28(16,BUFFPTR),TEXTHEX+27(BUFFPTR)          0741
         MVC   TEXTHEX(27,BUFFPTR),CONFMSG                         0741
*       TEXTLN=0;                   /* INDICATE NO MORE TEXT TO BE 0742
*                                      FORMATTED                     */
         SLR   @15,@15                                             0742
         ST    @15,TEXTLN(,@10)                                    0742
*       RETURN;                     /* RETURN - SUBROUTINES FUNCTION
*                                      IS COMPLETE                   */
@EL00002 DS    0H                                                  0743
@EF00002 DS    0H                                                  0743
@ER00002 LM    @14,@12,@SA00002                                    0743
         BR    @14                                                 0743
*     END;                          /* END OF CONFIDENTIAL TEXT PATH */
*   IF TEXTLN=0 THEN                                               0745
@RF00739 L     @10,WORKAREA(,PARMSAVE)                             0745
         L     @15,TEXTLN(,@10)                                    0745
         LTR   @15,@15                                             0745
         BZ    @RT00745                                            0745
*     RETURN;                       /* IF TEXT IS NOT CONFIDENTIAL,
*                                      FIND OUT IF ALL PROCESSING OF
*                                      IT WAS ALREADY COMPLETED. IF
*                                      IT WAS, RETURN FROM SUBROUTINE*/
*                                                                  0746
*   /*****************************************************************/
*   /*                                                               */
*   /* THERE IS TEXT TO BE FORMATTED. SET UP FOR AND CALL SUBROUTINE */
*   /* HEXFRMT TO CONVERT 20 BYTES OF TEXT TO PRINTABLE HEX          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0747
*   DATASTRT=TEXTADDR;              /* POINT TO NEXT TEXT BYTE TO BE
*                                      FORMATTED                     */
         L     DATASTRT,TEXTADDR(,@10)                             0747
*   HEXPARM=ADDR(TXTHEX1);          /* POINT TO PLIST                */
         LA    HEXPARM,TXTHEX1                                     0748
*   CALL HEXFRMT;                                                  0749
*                                                                  0749
         BAL   @14,HEXFRMT                                         0749
*   /*****************************************************************/
*   /*                                                               */
*   /* CONVERT THE SAME 20 BYTES TO TRANSLATED EBCDIC. UNPRINTABLE   */
*   /* CHARACTERS WILL APPEAR AS PERIODS(.)                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0750
*   TEXTAST1='*';                   /* MOVE IN FIRST DELIMETER       */
         MVI   TEXTAST1(BUFFPTR),C'*'                              0750
*   TEXTAST2='*';                   /* DELIMIT THE END               */
         MVI   TEXTAST2(BUFFPTR),C'*'                              0751
*   TEXTEBCD=TEXTDATA;              /* MOVE TEXT TO THE OUTPUT BUFFER*/
         L     @10,WORKAREA(,PARMSAVE)                             0752
         L     @15,TEXTADDR(,@10)                                  0752
         MVC   TEXTEBCD(20,BUFFPTR),TEXTDATA(@15)                  0752
*   TR(TEXTEBCD,EBCDCTAB);          /* TRANSLATE THE DATA            */
*                                                                  0753
         TR    TEXTEBCD(20,BUFFPTR),EBCDCTAB                       0753
*   /*****************************************************************/
*   /*                                                               */
*   /* CALCULATE THE AMOUNT OF TEXT YET TO BE FORMATTED. IF TEXTLN   */
*   /* BECOMES NEGATIVE, MORE TEXT THAN WAS NECESSARY WAS FORMATTED  */
*   /* AND MUST BE BLANKED OUT.                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0754
*   TEXTLN=TEXTLN-LENGTH(TEXTEBCD); /* SUBTRACT OFF TEXT JUST      0754
*                                      FORMATTED                     */
         LA    @15,20                                              0754
         L     @14,TEXTLN(,@10)                                    0754
         SLR   @14,@15                                             0754
         ST    @14,TEXTLN(,@10)                                    0754
*   IF TEXTLN<0 THEN                                               0755
         SLR   @09,@09                                             0755
         CR    @14,@09                                             0755
         BNL   @RF00755                                            0755
*     DO;                                                          0756
*       EXCESS=ABS(TEXTLN);         /* CALCULATE NUMBER OF EXCESS  0757
*                                      BYTES TO BLANK                */
         LPR   @14,@14                                             0757
         LR    EXCESS,@14                                          0757
*       XTRAHEXL=(EXCESS*2)+(EXCESS/4);/* AMOUNT TO BLANK IN BUFFER
*                                      IS NUMBER OF PRINTABLE HEX  0758
*                                      BYTES PLUS NUMBER OF        0758
*                                      INTERVENING BLANKS            */
         LR    XTRAHEXL,EXCESS                                     0758
         ALR   XTRAHEXL,XTRAHEXL                                   0758
         LR    @07,EXCESS                                          0758
         SRL   @07,2                                               0758
         ALR   XTRAHEXL,@07                                        0758
*       HEXADDR=ADDR(TEXTHEX)+(LENGTH(TEXTHEX)-XTRAHEXL);/* FIND   0759
*                                      FIRST BYTE THAT NEEDS BLANKING*/
         LA    HEXADDR,TEXTHEX(,BUFFPTR)                           0759
         LA    @07,44                                              0759
         SLR   @07,XTRAHEXL                                        0759
         ALR   HEXADDR,@07                                         0759
*       XTRAHEX(1:XTRAHEXL)=BLANKS; /* BLANK OUT EXCESS PRINTABLE HEX*/
         LR    @07,XTRAHEXL                                        0760
         BCTR  @07,0                                               0760
         EX    @07,@SM02416                                        0760
*       EBCDADDR=ADDR(TEXTEBCD)+(LENGTH(TEXTEBCD)-EXCESS);/* FIND  0761
*                                      BEGINNING OF EBCDIC NEEDED TO
*                                      BE BLANKED                    */
         LA    EBCDADDR,TEXTEBCD(,BUFFPTR)                         0761
         SLR   @15,EXCESS                                          0761
         ALR   EBCDADDR,@15                                        0761
*       XTRAEBCD(1:EXCESS)=BLANKS;  /* BLANK OUT THE EBCDIC PORTION  */
         LR    @08,EXCESS                                          0762
         BCTR  @08,0                                               0762
         EX    @08,@SM02418                                        0762
*       TEXTLN=0;                   /* INDICATE NO MORE TEXT         */
         ST    @09,TEXTLN(,@10)                                    0763
*       RETURN;                     /* RETURN TO CALLER              */
         B     @EL00002                                            0764
*     END;                          /* END OF EXCESS TEXT PATH       */
*   TEXTADDR=TEXTADDR+LENGTH(TEXTEBCD);/* BUMP TO NEXT TEXT BYTE TO
*                                      BE FORMATTED                  */
@RF00755 L     @10,WORKAREA(,PARMSAVE)                             0766
         LA    @15,20                                              0766
         AL    @15,TEXTADDR(,@10)                                  0766
         ST    @15,TEXTADDR(,@10)                                  0766
*   RETURN;                                                        0767
         B     @EL00002                                            0767
*   END FRMTEXT;                                                   0768
         B     @EL00002                                            0768
*HEXFRMT:                                                          0769
*   PROC;                                                          0769
*                                                                  0769
HEXFRMT  STM   @14,@12,12(@13)                                     0769
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS SUBROUTINE IS CALLED TO CONVERT HEX DATA INTO PRINTABLE  */
*   /* HEX, INTO SPECIFIED COLUMNS IN THE OUTPUT BUFFER. ON ENTRY,   */
*   /* REGISTER ZERO POINTS TO THE START OF A HEX DATA STRING TO BE  */
*   /* CONVERTED. REGISTER ONE ON ENTRY CONTAINS THE ADDRESS OF A    */
*   /* PARAMETER LIST. THE PARAMETER LIST CONSISTS OF 4-BYTE ENTRIES,*/
*   /* AS FOLLOWS: BYTE 0 CONTAINS A FLAG BYTE; THE HI BIT, IF ON,   */
*   /* INDICATES THAT THIS ENTRY IS THE LAST ONE. IF OFF, ANOTHER    */
*   /* ENTRY IS CONTIGUOUS TO THIS 4-BYTE ENTRY. BYTE 1 CONTAINS THE */
*   /* COLUMN INTO WHICH THE DATA IS TO BE CONVERTED. (THIS IS THE   */
*   /* OFFSET + 1 FROM THE BEGINNING OF THE BUFFER.) BYTES 2-3       */
*   /* CONTAIN THE LENGTH OF THE DATA STRING TO BE CONVERTED. IF     */
*   /* LONGER THAN 4 BYTES, AN INTERVENING BLANK WILL BE INSERTED    */
*   /* EVERY 4 BYTES IN THE OUTPUT                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0770
*   RFY                                                            0770
*    (HEXDPTR,                                                     0770
*     HEXBUFFR,                                                    0770
*     HEXLNG,                                                      0770
*     ENTRYPTR) RSTD;                                              0770
*   HEXDPTR=DATASTRT;               /* MOVE BEGINNING DATA ADDRESS TO
*                                      WORKING REGISTER              */
         LR    HEXDPTR,DATASTRT                                    0771
*   ENTRYPTR=HEXPARM;               /* ESTABLISH PTR TO FIRST PLIST
*                                      ENTRY                         */
         LR    ENTRYPTR,HEXPARM                                    0772
*AMDHEX01:                                                         0773
*   HEXBUFFR=BUFFPTR+(HEXCOLUM-1);  /* CALCULATE ADDRESS IN BUFFER 0773
*                                      INTO WHICH DATA IS TO BE    0773
*                                      FORMATTED                     */
AMDHEX01 SLR   HEXBUFFR,HEXBUFFR                                   0773
         IC    HEXBUFFR,HEXCOLUM(,ENTRYPTR)                        0773
         BCTR  HEXBUFFR,0                                          0773
         ALR   HEXBUFFR,BUFFPTR                                    0773
*   HEXLNG=HEXLNGTH;                /* PICK UP AMOUNT TO BE CONVERTED*/
         ICM   HEXLNG,12,HEXLNGTH(ENTRYPTR)                        0774
         SRA   HEXLNG,16                                           0774
*AMDHEX02:                                                         0775
*   UNPK(HEXWORK,HEXDATA);          /* CONVERT FOUR BYTES INTO WORK
*                                      AREA                          */
AMDHEX02 L     @10,WORKAREA(,PARMSAVE)                             0775
         UNPK  HEXWORK(9,@10),HEXDATA(5,HEXDPTR)                   0775
*   TR(HEXWORK(1:8),HEXTABL);       /* TRANSLATE THE 8 BYTE UNPKED 0776
*                                      RESULT                @Z40GKTQ*/
         LA    @15,HEXTAB                                          0776
         AL    @15,@CF02420                                        0776
         TR    HEXWORK(8,@10),HEXTABL(@15)                         0776
*   IF HEXLNG<=4 THEN                                              0777
         LA    @15,4                                               0777
         CR    HEXLNG,@15                                          0777
         BH    @RF00777                                            0777
*     DO;                           /* FOR SHORT DATA, MOVE ONLY   0778
*                                      WHATS NEEDED                  */
*       PRINTHEX(1:HEXLNG*2)=HEXWORK;/* MOVE BYTES TO BUFFER         */
         LR    @14,HEXLNG                                          0779
         ALR   @14,@14                                             0779
         BCTR  @14,0                                               0779
         EX    @14,@SM02421                                        0779
*       IF LASTENTY='1'B THEN                                      0780
         TM    LASTENTY(ENTRYPTR),B'10000000'                      0780
         BO    @RT00780                                            0780
*         RETURN;                   /* IF THIS IS THE LAST PLIST   0781
*                                      ENTRY THEN ALL IS DONE        */
*       HEXDPTR=HEXDPTR+HEXLNG;     /* OTHERWISE, SET UP FOR NEXT  0782
*                                      PLIST ENTRY BY BUMPING DATA 0782
*                                      PTR PAST DATA JUST FORMATTED  */
         ALR   HEXDPTR,HEXLNG                                      0782
*       ENTRYPTR=ENTRYPTR+LENGTH(HEXPLIST);/* POINT TO NEXT ENTRY IN
*                                      PLIST                         */
         ALR   ENTRYPTR,@15                                        0783
*       GO TO AMDHEX01;             /* LOOP BAK TO PROCESS THIS ENTRY*/
         B     AMDHEX01                                            0784
*     END;                          /* END OF SHORT DATA PATH        */
*   PRINTHEX=HEXWORK;               /* FOR DATA GREATER THAN 4 BYTES,
*                                      MOVE IN THE 8 BYTES JUST    0786
*                                      CONVERTED                     */
@RF00777 L     @10,WORKAREA(,PARMSAVE)                             0786
         MVC   PRINTHEX(8,HEXBUFFR),HEXWORK(@10)                   0786
*   HEXLNG=HEXLNG-4;                /* SUBTRACT OFF LENGTH JUST    0787
*                                      CONVERTED                     */
         LA    @10,4                                               0787
         SLR   HEXLNG,@10                                          0787
*   HEXDPTR=HEXDPTR+4;              /* BUMP DATA PTR PAST DATA     0788
*                                      FORMATTED                     */
         ALR   HEXDPTR,@10                                         0788
*   HEXBUFFR=HEXBUFFR+9;            /* BUMP BUFFER PTR PAST 8 DATA 0789
*                                      BYTES, AND ONE BLANK          */
         AL    HEXBUFFR,@CF01420                                   0789
*   GO TO AMDHEX02;                 /* LOOP TO GET REST              */
         B     AMDHEX02                                            0790
*   RFY                                                            0791
*    (HEXDPTR,                                                     0791
*     HEXBUFFR,                                                    0791
*     HEXLNG,                                                      0791
*     ENTRYPTR) UNRSTD;                                            0791
*   END HEXFRMT;                                                   0792
@EL00003 DS    0H                                                  0792
@EF00003 DS    0H                                                  0792
@ER00003 LM    @14,@12,12(@13)                                     0792
         BR    @14                                                 0792
*   END AMDUSRFD                                                   0793
*                                                                  0793
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSUT5  (PLOG    )                                       */
*/*%INCLUDE SYSUT5  (DCLS    )                                       */
*/*%INCLUDE SYSLIB  (IHASRB  )                                       */
*/*%INCLUDE SYSLIB  (ISTTRF  )                                       */
*/*%INCLUDE SYSLIB  (IMDMEDIT)                                       */
*/*%INCLUDE SYSLIB  (ISTZLBUF)                                       */
*/*%INCLUDE SYSLIB  (ISTTRAC )                                       */
*/*%INCLUDE SYSUT5  (SMSDCLS )                                       */
*/*%INCLUDE SYSUT5  (COMMINIT)                                       */
*/*%INCLUDE SYSUT5  (NEWINIT )                                       */
*/*%INCLUDE SYSUT5  (AMDSMS00)                                       */
*/*%INCLUDE SYSUT5  (AMDCLTR1)                                       */
*/*%INCLUDE SYSUT5  (AMDTPTR1)                                       */
*/*%INCLUDE SYSUT5  (AMDLNTR1)                                       */
*/*%INCLUDE SYSUT5  (AMDEXIT )                                       */
*/*%INCLUDE SYSUT5  (AMDCLTR2)                                       */
*/*%INCLUDE SYSUT5  (AMDTPLOC)                                       */
*/*%INCLUDE SYSUT5  (AMDTPLI1)                                       */
*/*%INCLUDE SYSUT5  (AMDTPLI2)                                       */
*/*%INCLUDE SYSUT5  (AMDTPRI1)                                       */
*/*%INCLUDE SYSUT5  (AMDTPRI2)                                       */
*/*%INCLUDE SYSUT5  (AMDTPRO1)                                       */
*/*%INCLUDE SYSUT5  (AMDTPRTX)                                       */
*/*%INCLUDE SYSUT5  (AMDTXTLN)                                       */
*/*%INCLUDE SYSUT5  (AMDLNTR2)                                       */
*/*%INCLUDE SYSUT5  (AMDSMS01)                                       */
*/*%INCLUDE SYSUT5  (AMDSMS02)                                       */
*/*%INCLUDE SYSUT5  (AMDSMS03)                                       */
*/*%INCLUDE SYSUT5  (AMDLNE01)                                       */
*/*%INCLUDE SYSUT5  (AMDLNE02)                                       */
*/*%INCLUDE SYSUT5  (FRMTEXT )                                       */
*/*%INCLUDE SYSUT5  (HEXFRMT )                                       */
*                                                                  0793
*       ;                                                          0793
@DATA    DS    0H
@CH00590 DC    XL2'EFF2'
@CH00592 DC    XL2'EFF1'
@CH00594 DC    XL2'EFF0'
@CH00596 DC    XL2'EFEF'
@SM02416 MVC   XTRAHEX(0,HEXADDR),BLANKS
@SM02418 MVC   XTRAEBCD(0,EBCDADDR),BLANKS
@SM02421 MVC   PRINTHEX(0,HEXBUFFR),HEXWORK(@10)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@SA00002 DS    15F
AMDUSRFD CSECT
         DS    0F
@CF00042 DC    F'2'
@CF00036 DC    F'4'
@CF00060 DC    F'8'
@CF01420 DC    F'9'
@CF02414 DC    F'17'
@CF02420 DC    F'-240'
@DATD    DSECT
         DS    0D
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
AMDUSRFD CSECT
         DS    0F
@SIZDATD DC    AL1(0)
         DC    AL3(@ENDDATD-@DATD)
         DS    0D
SLOWDOWN DC    XL1'03'
ANODELAB DC    CL5'ANODE'
TEXTLAB  DC    CL4'TEXT'
DNODELAB DC    CL5'DNODE'
INBOUND  DC    CL2'IN'
OUTBOUND DC    CL3'OUT'
CONFMSG  DC    CL27'CONFIDENTIAL AND SUPPRESSED'
BLANKS   DC    CL43' '
CTLAYER  DC    CL3'C/L'
TPLAB    DC    CL5'TPIOS'
FDBLAB   DC    CL3'FDB'
RSVDLAB  DC    CL4'RSVD'
FSBLAB   DC    CL4'FSB'
THRHLAB  DC    CL4'THRH'
LNG2LAB  DC    CL4'LNG2'
RSVD2LAB DC    CL5'RSVD2'
LOCALIND DC    CL5'LOCAL'
REMOTIND DC    CL6'REMOTE'
LINELAB  DC    CL4'LINE'
TIMELAB  DC    CL4'TIME'
EPLAB    DC    CL2'EP'
SLOWIND  DC    CL8'SLOWDOWN'
LINELABS DC    CL37'LCD    PCF    TIME     SCF     PDF   '
LINELABE DC    CL79'STATUS      SCF    LCD    PCF    EPCF    STAT1    SC
               TAT2    TIME    ADDR    CNTL'
         DS    CL1
TXTHEX1  DS    CL4
         ORG   TXTHEX1
TXT1FLG1 DC    X'80'
TXT1COL1 DC    AL1(34)
TXT1LNG1 DC    H'20'
         ORG   TXTHEX1+4
HEXTAB   DC    CL16'0123456789ABCDEF'
TPHEX1   DS    CL12
         ORG   TPHEX1
TP1FLG1  DC    X'00'
TP1COL1  DC    AL1(34)
TP1LNG1  DC    H'12'
TP1FLG2  DC    X'00'
TP1COL2  DC    AL1(68)
TP1LNG2  DC    H'2'
TP1FLG3  DC    X'80'
TP1COL3  DC    AL1(80)
TP1LNG3  DC    H'2'
         ORG   TPHEX1+12
TPHEX2   DS    CL4
         ORG   TPHEX2
TP2FLG1  DC    X'80'
TP2COL1  DC    AL1(93)
TP2LNG1  DC    H'8'
         ORG   TPHEX2+4
TPHEX3   DS    CL4
         ORG   TPHEX3
TP3FLG1  DC    X'80'
TP3COL1  DC    AL1(34)
TP3LNG1  DC    H'32'
         ORG   TPHEX3+4
TPHEX4   DS    CL4
         ORG   TPHEX4
TP4FLG1  DC    X'80'
TP4COL1  DC    AL1(34)
TP4LNG1  DC    H'20'
         ORG   TPHEX4+4
TPHEX5   DS    CL4
         ORG   TPHEX5
TP5FLG1  DC    X'80'
TP5COL1  DC    AL1(34)
TP5LNG1  DC    H'12'
         ORG   TPHEX5+4
LNHEX1   DS    CL8
         ORG   LNHEX1
LN1FLG1  DC    X'00'
LN1COL1  DC    AL1(49)
LN1LNG1  DC    H'1'
LN1FLG2  DC    X'80'
LN1COL2  DC    AL1(35)
LN1LNG2  DC    H'1'
         ORG   LNHEX1+8
LNHEX2   DS    CL32
         ORG   LNHEX2
LN2FLG1  DC    X'00'
LN2COL1  DC    AL1(25)
LN2LNG1  DC    H'1'
LN2FLG2  DC    X'00'
LN2COL2  DC    AL1(40)
LN2LNG2  DC    H'1'
LN2FLG3  DC    X'00'
LN2COL3  DC    AL1(48)
LN2LNG3  DC    H'1'
LN2FLG4  DC    X'00'
LN2COL4  DC    AL1(56)
LN2LNG4  DC    H'1'
LN2FLG5  DC    X'00'
LN2COL5  DC    AL1(68)
LN2LNG5  DC    H'1'
LN2FLG6  DC    X'00'
LN2COL6  DC    AL1(83)
LN2LNG6  DC    H'1'
LN2FLG7  DC    X'00'
LN2COL7  DC    AL1(91)
LN2LNG7  DC    H'1'
LN2FLG8  DC    X'80'
LN2COL8  DC    AL1(99)
LN2LNG8  DC    H'1'
         ORG   LNHEX2+32
LNHEX2E  DS    CL32
         ORG   LNHEX2E
LN2EFL1  DC    X'00'
LN2ECL1  DC    AL1(25)
LN2ELN1  DC    H'1'
LN2EFL2  DC    X'00'
LN2ECL2  DC    AL1(32)
LN2ELN2  DC    H'1'
LN2EFL4  DC    X'00'
LN2ECL4  DC    AL1(46)
LN2ELN4  DC    H'1'
LN2EFL5  DC    X'00'
LN2ECL5  DC    AL1(55)
LN2ELN5  DC    H'1'
LN2EFL6  DC    X'00'
LN2ECL6  DC    AL1(64)
LN2ELN6  DC    H'1'
LN2EFL7  DC    X'00'
LN2ECL7  DC    AL1(72)
LN2ELN7  DC    H'1'
LN2EFL8  DC    X'00'
LN2ECL8  DC    AL1(80)
LN2ELN8  DC    H'1'
LN2EFL9  DC    X'80'
LN2ECL9  DC    AL1(88)
LN2ELN9  DC    H'1'
         ORG   LNHEX2E+32
SFHEX    DS    CL12
         ORG   SFHEX
SFFLG1   DC    X'00'
SFCOL1   DC    AL1(23)
SFLEN1   DC    H'2'
SFFLG2   DC    X'00'
SFCOL2   DC    AL1(28)
SFLEN2   DC    H'2'
SFFLG3   DC    X'80'
SFCOL3   DC    AL1(33)
SFLEN3   DC    H'2'
         ORG   SFHEX+12
SPHEX    DS    CL12
         ORG   SPHEX
SPFLG1   DC    X'00'
SPCOL1   DC    AL1(41)
SPLEN1   DC    H'2'
SPFLG2   DC    X'00'
SPCOL2   DC    AL1(46)
SPLEN2   DC    H'2'
SPFLG3   DC    X'80'
SPCOL3   DC    AL1(51)
SPLEN3   DC    H'2'
         ORG   SPHEX+12
LFHEX    DS    CL12
         ORG   LFHEX
LFFLG1   DC    X'00'
LFCOL1   DC    AL1(59)
LFLEN1   DC    H'2'
LFFLG2   DC    X'00'
LFCOL2   DC    AL1(64)
LFLEN2   DC    H'2'
LFFLG3   DC    X'80'
LFCOL3   DC    AL1(69)
LFLEN3   DC    H'2'
         ORG   LFHEX+12
LPHEX    DS    CL12
         ORG   LPHEX
LPFLG1   DC    X'00'
LPCOL1   DC    AL1(77)
LPLEN1   DC    H'2'
LPFLG2   DC    X'00'
LPCOL2   DC    AL1(82)
LPLEN2   DC    H'2'
LPFLG3   DC    X'80'
LPCOL3   DC    AL1(87)
LPLEN3   DC    H'2'
         ORG   LPHEX+12
UEHEX    DS    CL12
         ORG   UEHEX
UEFLG1   DC    X'00'
UECOL1   DC    AL1(23)
UELEN1   DC    H'2'
UEFLG2   DC    X'00'
UECOL2   DC    AL1(28)
UELEN2   DC    H'2'
UEFLG3   DC    X'80'
UECOL3   DC    AL1(33)
UELEN3   DC    H'2'
         ORG   UEHEX+12
IOHEX    DS    CL12
         ORG   IOHEX
IOFLG1   DC    X'00'
IOCOL1   DC    AL1(23)
IOLEN1   DC    H'2'
IOFLG2   DC    X'00'
IOCOL2   DC    AL1(28)
IOLEN2   DC    H'2'
IOFLG3   DC    X'80'
IOCOL3   DC    AL1(33)
IOLEN3   DC    H'2'
         ORG   IOHEX+12
WPHEX    DS    CL12
         ORG   WPHEX
WPFLG1   DC    X'00'
WPCOL1   DC    AL1(59)
WPLEN1   DC    H'2'
WPFLG2   DC    X'00'
WPCOL2   DC    AL1(64)
WPLEN2   DC    H'2'
WPFLG3   DC    X'80'
WPCOL3   DC    AL1(69)
WPLEN3   DC    H'2'
         ORG   WPHEX+12
APHEX    DS    CL12
         ORG   APHEX
APFLG1   DC    X'00'
APCOL1   DC    AL1(77)
APLEN1   DC    H'2'
APFLG2   DC    X'00'
APCOL2   DC    AL1(82)
APLEN2   DC    H'2'
APFLG3   DC    X'80'
APCOL3   DC    AL1(87)
APLEN3   DC    H'2'
         ORG   APHEX+12
PPHEX    DS    CL12
         ORG   PPHEX
PPFLG1   DC    X'00'
PPCOL1   DC    AL1(41)
PPLEN1   DC    H'2'
PPFLG2   DC    X'00'
PPCOL2   DC    AL1(46)
PPLEN2   DC    H'2'
PPFLG3   DC    X'80'
PPCOL3   DC    AL1(51)
PPLEN3   DC    H'2'
         ORG   PPHEX+12
NPHEX    DS    CL12
         ORG   NPHEX
NPFLG1   DC    X'00'
NPCOL1   DC    AL1(41)
NPLEN1   DC    H'2'
NPFLG2   DC    X'00'
NPCOL2   DC    AL1(46)
NPLEN2   DC    H'2'
NPFLG3   DC    X'80'
NPCOL3   DC    AL1(51)
NPLEN3   DC    H'2'
         ORG   NPHEX+12
CRHEX    DS    CL12
         ORG   CRHEX
CRFLG1   DC    X'00'
CRCOL1   DC    AL1(59)
CRLEN1   DC    H'2'
CRFLG2   DC    X'00'
CRCOL2   DC    AL1(64)
CRLEN2   DC    H'2'
CRFLG3   DC    X'80'
CRCOL3   DC    AL1(69)
CRLEN3   DC    H'2'
         ORG   CRHEX+12
SMSVTAM  DC    CL4'VTAM'
SMSBUF   DC    CL7'BUFFERS'
SMSHD    DC    CL14'MAXU MAXQ AVNO'
SFCHAR   DC    CL2'SF'
SPCHAR   DC    CL2'SP'
LFCHAR   DC    CL2'LF'
LPCHAR   DC    CL2'LP'
UECHAR   DC    CL2'UE'
IOCHAR   DC    CL2'IO'
WPCHAR   DC    CL2'WP'
APCHAR   DC    CL2'AP'
PPCHAR   DC    CL2'PP'
NPCHAR   DC    CL2'NP'
CRCHAR   DC    CL2'CR'
EBCDTAB  DC    64X'4B'
         DC    X'40'
         DC    9X'4B'
         DC    X'4A'
         DC    X'4B'
         DC    X'4C'
         DC    X'4D'
         DC    X'4E'
         DC    X'4F'
         DC    X'50'
         DC    9X'4B'
         DC    X'5A'
         DC    X'5B'
         DC    X'5C'
         DC    X'5D'
         DC    X'5E'
         DC    X'5F'
         DC    X'60'
         DC    X'61'
         DC    9X'4B'
         DC    X'6B'
         DC    X'6C'
         DC    X'6D'
         DC    X'6E'
         DC    X'6F'
         DC    10X'4B'
         DC    X'7A'
         DC    X'7B'
         DC    X'7C'
         DC    X'7D'
         DC    X'7E'
         DC    X'7F'
         DC    X'4B'
         DC    X'81'
         DC    X'82'
         DC    X'83'
         DC    X'84'
         DC    X'85'
         DC    X'86'
         DC    X'87'
         DC    X'88'
         DC    X'89'
         DC    7X'4B'
         DC    X'91'
         DC    X'92'
         DC    X'93'
         DC    X'94'
         DC    X'95'
         DC    X'96'
         DC    X'97'
         DC    X'98'
         DC    X'99'
         DC    8X'4B'
         DC    X'A2'
         DC    X'A3'
         DC    X'A4'
         DC    X'A5'
         DC    X'A6'
         DC    X'A7'
         DC    X'A8'
         DC    X'A9'
         DC    23X'4B'
         DC    X'C1'
         DC    X'C2'
         DC    X'C3'
         DC    X'C4'
         DC    X'C5'
         DC    X'C6'
         DC    X'C7'
         DC    X'C8'
         DC    X'C9'
         DC    7X'4B'
         DC    X'D1'
         DC    X'D2'
         DC    X'D3'
         DC    X'D4'
         DC    X'D5'
         DC    X'D6'
         DC    X'D7'
         DC    X'D8'
         DC    X'D9'
         DC    8X'4B'
         DC    X'E2'
         DC    X'E3'
         DC    X'E4'
         DC    X'E5'
         DC    X'E6'
         DC    X'E7'
         DC    X'E8'
         DC    X'E9'
         DC    6X'4B'
         DC    X'F0'
         DC    X'F1'
         DC    X'F2'
         DC    X'F3'
         DC    X'F4'
         DC    X'F5'
         DC    X'F6'
         DC    X'F7'
         DC    X'F8'
         DC    X'F9'
         DC    6X'4B'
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
EBCDADDR EQU   @05
HEXADDR  EQU   @06
XTRAHEXL EQU   @05
EXCESS   EQU   @04
DATASTRT EQU   @00
EDITPARM EQU   @01
HEXPARM  EQU   @01
PARMSAVE EQU   @02
BUFFPTR  EQU   @03
SAVEPTR  EQU   @13
HEXDPTR  EQU   @04
ENTRYPTR EQU   @05
HEXBUFFR EQU   @06
HEXLNG   EQU   @07
SRBSECT  EQU   0
SRBFLC   EQU   SRBSECT+12
ISTRH    EQU   0
RHFLAGS  EQU   ISTRH
RH1      EQU   RHFLAGS
RH2      EQU   RHFLAGS+1
RHRETRY  EQU   RH2
RHRSVD1  EQU   RH2
RH3      EQU   RHFLAGS+2
ISTRU    EQU   0
RUDATA   EQU   ISTRU
ISTRUB   EQU   0
NSRUNA5  EQU   0
ISTTRF   EQU   0
TRFANODE EQU   ISTTRF
TRFDNODE EQU   ISTTRF+8
TRFFLG   EQU   ISTTRF+16
TRFINB   EQU   TRFFLG
TRFLOCAL EQU   TRFFLG
TRFCXTF  EQU   TRFFLG
TRFLSNA  EQU   TRFFLG
ISTBDU   EQU   0
BDUMODIF EQU   ISTBDU+1
BDUMOD1  EQU   BDUMODIF
BDUDAF   EQU   ISTBDU+2
BDUFUNC  EQU   BDUDAF
BDUCHECK EQU   BDUFUNC
BDUFLAGS EQU   BDUDAF+1
BDUPTR   EQU   0
ISTFDB   EQU   0
ISTLH    EQU   0
ISTTH    EQU   0
THFLAG1  EQU   ISTTH
THFLGA   EQU   THFLAG1
THMPF    EQU   THFLGA
THFLGB   EQU   THFLAG1+1
ISTTH2   EQU   0
TH2FLAG1 EQU   ISTTH2
TH2MPF   EQU   TH2FLAG1
ISTBTU   EQU   0
BTUBTH   EQU   ISTBTU
BTUFID   EQU   BTUBTH
BTUFIDNO EQU   BTUFID
BTUREQ   EQU   BTUBTH+6
BTURQFLG EQU   BTUREQ
BTURH    EQU   BTUBTH+10
BTUPAD   EQU   BTURH+3
BTUSYSTR EQU   ISTBTU+18
BTUTEXT  EQU   ISTBTU+20
BTUPTR   EQU   0
ISTFSB   EQU   0
FSBFSB   EQU   ISTFSB
FSBMNRCD EQU   FSBFSB+2
FSBSFLGS EQU   FSBFSB+3
FSBFSBA  EQU   FSBFSB+4
FSBBTH   EQU   FSBFSB+8
FSBCID   EQU   FSBBTH
FSBRQTAG EQU   FSBBTH+4
FSBSEQID EQU   FSBRQTAG
FSBFLAGS EQU   FSBSEQID
FSBSEQ   EQU   FSBSEQID+1
FSBCSWST EQU   FSBBTH+6
FSBTHFLD EQU   FSBCSWST
FSBTH1   EQU   FSBTHFLD
FSBSYSRS EQU   FSBTH1
FSBTH2   EQU   FSBTHFLD+1
FSBEXTRS EQU   FSBTH2
FSBXFSTS EQU   FSBEXTRS
FSBXCODE EQU   FSBEXTRS
FSBNETRS EQU   FSBFSB+16
FSBSRCAT EQU   FSBNETRS
FSBERC   EQU   FSBNETRS+1
FSBFBMI  EQU   FSBERC
FSBDMGRS EQU   FSBFSB+18
FSBSS1   EQU   FSBDMGRS
FSBSS2   EQU   FSBDMGRS+1
FSBLCPB  EQU   FSBFSB+20
FSBMSGID EQU   FSBLCPB
FSBLCCWA EQU   FSBFSB+24
FSBRLSTS EQU   FSBLCCWA
FSBPTR   EQU   0
ISTZIBUF EQU   0
ZIBFSM   EQU   ISTZIBUF+4
ISTZOBUF EQU   0
ZOBFSM   EQU   ISTZOBUF+4
ISTZLBUF EQU   0
ZLBFSM   EQU   ISTZLBUF+4
ISTTRAC  EQU   0
TRA1WORD EQU   ISTTRAC
TRATRCB  EQU   ISTTRAC+8
TRABDW   EQU   TRATRCB
TRAFLG   EQU   ISTTRAC+12
TRAFLG2  EQU   ISTTRAC+13
TRACXTF  EQU   TRAFLG2
TRADIO   EQU   TRAFLG2
TRADATCT EQU   ISTTRAC+14
TRADNODE EQU   ISTTRAC+16
TRACID   EQU   TRADNODE
TRADATA  EQU   ISTTRAC+32
PASSAREA EQU   0
NEXTLINE EQU   PASSAREA
DATALNG  EQU   PASSAREA+4
TEXTLN   EQU   PASSAREA+8
TEXTADDR EQU   PASSAREA+12
LINECNT  EQU   PASSAREA+16
LINEADDR EQU   PASSAREA+20
SRBPTR   EQU   PASSAREA+24
RETCODE  EQU   PASSAREA+28
TRFPTR   EQU   PASSAREA+32
TRRPTR   EQU   PASSAREA+36
SWITCHES EQU   PASSAREA+40
CONFTEXT EQU   SWITCHES
HEXWORK  EQU   PASSAREA+41
TEMPCNT  EQU   PASSAREA+50
BLKHDR   EQU   0
BLKTYPE  EQU   BLKHDR
BLKCNT   EQU   BLKHDR+1
INPUTEID EQU   0
RECLEN   EQU   0
MYSAVE   EQU   0
HISPTR   EQU   MYSAVE+4
HISSAVE  EQU   0
RTRNREG  EQU   HISSAVE+16
FMTAPPLS EQU   0
RECORDAD EQU   FMTAPPLS
OUTBUF   EQU   FMTAPPLS+4
EIDADDR  EQU   FMTAPPLS+12
DATAADDR EQU   FMTAPPLS+16
WORKAREA EQU   FMTAPPLS+24
CLFIRST  EQU   0
CLLABL   EQU   CLFIRST+1
CLINOUT  EQU   CLFIRST+6
CLANODLB EQU   CLFIRST+11
CLANODAT EQU   CLFIRST+17
CLTEXTLB EQU   CLFIRST+28
CLSECOND EQU   0
CLDNODLB EQU   CLSECOND+11
CLDNODAT EQU   CLSECOND+17
TPFIRST  EQU   0
TPLABL   EQU   TPFIRST+1
TPINOUT  EQU   TPFIRST+7
TPANODLB EQU   TPFIRST+11
TPANODAT EQU   TPFIRST+17
TPFDBLB  EQU   TPFIRST+28
TPRSVLNG EQU   TPFIRST+62
TPRSVDLB EQU   TPRSVLNG
TPLNG2LB EQU   TPRSVLNG+12
TPRSV2LB EQU   TPRSVLNG+24
TPLOC2   EQU   0
TPLOCLB  EQU   TPLOC2+3
TPLOCDNL EQU   TPLOC2+11
TPLOCDND EQU   TPLOC2+17
TPLOCTXL EQU   TPLOC2+28
TPLOCFSL EQU   TPLOCTXL
TPLOC3   EQU   0
TPLOCFDL EQU   TPLOC3+28
TPRI2    EQU   0
TPRILBL  EQU   TPRI2+3
TPRIDNL  EQU   TPRI2+11
TPRIDND  EQU   TPRI2+17
TPRIFSBL EQU   TPRI2+28
TPRI3    EQU   0
TPRITHL  EQU   TPRI3+28
TPRITHD  EQU   TPRI3+33
TPRIFID0 EQU   TPRITHD+29
TPRO2    EQU   0
TPROLBL  EQU   TPRO2+3
TPRODNL  EQU   TPRO2+11
TPRODND  EQU   TPRO2+17
TPROTHL  EQU   TPRO2+28
TPROTHD  EQU   TPRO2+33
TPTXT    EQU   0
TPTXTLBL EQU   TPTXT+28
LNFRST   EQU   0
LNLABEL  EQU   LNFRST+1
LNDNODL  EQU   LNFRST+11
LNDNODAT EQU   LNFRST+17
LNEPLB   EQU   LNFRST+31
LNTMLB   EQU   LNFRST+43
LNSLOWDN EQU   LNFRST+54
LNBUF2   EQU   0
LN2FIRST EQU   LNBUF2+20
LN2LCDE1 EQU   LN2FIRST+5
LN2PCFD1 EQU   LN2FIRST+11
LN2SECND EQU   LNBUF2+63
LN2LCDE2 EQU   LN2SECND+5
LN2PCFD2 EQU   LN2SECND+11
LNBUF2S  EQU   0
LNSLCD   EQU   LNBUF2S+31
LNSPCF   EQU   LNBUF2S+38
LNINPUT  EQU   0
LNSRU    EQU   LNINPUT+61
LLABEL1  EQU   0
LLABEL   EQU   LLABEL1+11
TEXTDATA EQU   0
XTRAHEX  EQU   0
XTRAEBCD EQU   0
TEXTBUF  EQU   0
TEXTHEX  EQU   TEXTBUF+33
TEXTAST1 EQU   TEXTBUF+79
TEXTEBCD EQU   TEXTBUF+80
TEXTAST2 EQU   TEXTBUF+100
HEXTABL  EQU   0
HEXPLIST EQU   0
HEXFLGS  EQU   HEXPLIST
LASTENTY EQU   HEXFLGS
HEXCOLUM EQU   HEXPLIST+1
HEXLNGTH EQU   HEXPLIST+2
HEXDATA  EQU   0
PRINTHEX EQU   0
SMSHDRER EQU   0
NM1      EQU   SMSHDRER+4
NM2      EQU   SMSHDRER+9
NM3      EQU   SMSHDRER+22
NM4      EQU   SMSHDRER+40
NM5      EQU   SMSHDRER+58
NM6      EQU   SMSHDRER+76
SMSFIRST EQU   0
IOLABEL  EQU   SMSFIRST+19
PPLABEL  EQU   SMSFIRST+37
LPLABEL  EQU   SMSFIRST+55
WPLABEL  EQU   SMSFIRST+73
SMSSECND EQU   0
NPLABEL  EQU   SMSSECND+19
LFLABEL  EQU   SMSSECND+37
CRLABEL  EQU   SMSSECND+55
UELABEL  EQU   SMSSECND+73
SMSLAST  EQU   0
SFLABEL  EQU   SMSLAST+19
SPLABEL  EQU   SMSLAST+37
APLABEL  EQU   SMSLAST+55
ZIBSRB   EQU   0
ISTSENRU EQU   RUDATA
SRUSENSE EQU   ISTSENRU
SRUSENS1 EQU   SRUSENSE
SRUSENS2 EQU   SRUSENSE+2
ISTSRU   EQU   ISTRUB
SRUDATA  EQU   ISTSRU+1
SRUTYPE  EQU   SRUDATA
SRULDID  EQU   SRUDATA+1
SRUSPSN  EQU   SRULDID
ISTNSRU  EQU   ISTRUB
NSRUNETS EQU   ISTNSRU
NSRUDATA EQU   ISTNSRU+3
NSRUHOOK EQU   NSRUDATA
NSSSVRU  EQU   NSRUDATA
NSSSVNOD EQU   NSSSVRU+3
NSSSVT3  EQU   NSSSVNOD
NSSSVT3C EQU   NSSSVT3+2
NSSSVT3G EQU   NSSSVT3+5
NSSSVT4  EQU   NSSSVNOD
NSSSVT5  EQU   NSSSVNOD
NSRUDAT1 EQU   NSRUDATA
NSRUDAT2 EQU   NSRUDAT1+2
ISTTRRU  EQU   NSRUDAT2
TRRTYPE  EQU   ISTTRRU
TRRFMT2  EQU   TRRTYPE
TRRTIME  EQU   ISTTRRU+1
TRRSTAT  EQU   ISTTRRU+3
TRRDATA  EQU   ISTTRRU+4
ISTCTDRU EQU   NSRUDAT2
ISTINORU EQU   NSRUDAT2
SRUDAT1  EQU   SRUDATA
SRUDAT1L EQU   SRUDAT1+1
SRUDAT2  EQU   SRUDATA
ISTMRU   EQU   ISTRUB
SRUDATA3 EQU   SRUDATA
SRUDATA4 EQU   SRUDATA
NSRUDAT3 EQU   NSRUDAT2
NSRUDAT4 EQU   NSRUDAT2
NSRUDAT5 EQU   NSRUDAT2
NSRUDAT6 EQU   NSRUDAT2
NSRUDAT7 EQU   NSRUDAT2
NSRUDIL  EQU   NSRUDAT2
NSRUDILB EQU   NSRUDIL+1
NSRUNA   EQU   NSRUDAT2
NSRUNA2  EQU   NSRUNA+1
NSRUCLSP EQU   NSRUDAT2
NSRUOH1  EQU   NSRUDAT2
NSRUDAT8 EQU   NSRUDATA
ISTUNBRU EQU   SRUTYPE
FSBCOMBN EQU   FSBNETRS
FSBRHFLD EQU   FSBCOMBN+1
FSBRH3   EQU   FSBRHFLD+2
FSBLDFLG EQU   FSBRH3
@NM00013 EQU   FSBRQTAG
ZIBDIO   EQU   ZIBFSM
ZIBCCW2  EQU   ZIBDIO+8
ZIBCPTCC EQU   ZIBCCW2
ZIBAIO   EQU   ISTZIBUF
ZIBAIOCM EQU   ZIBAIO
ZIBFIB   EQU   ZIBAIO+16
ZIBFSB   EQU   ZIBFIB
ZIBMDREC EQU   ZIBFSB+4
ZIBMDRIN EQU   ZIBFSB+28
ZIBBTU   EQU   ZIBFIB+32
@NM00016 EQU   ZIBBTU+12
ZIBFID1  EQU   @NM00016+1
ZIBFITXT EQU   ZIBFID1
ZIBSIB   EQU   ZIBFIB
ZIBREC   EQU   ZIBMDRIN
ZIBRECPL EQU   ZIBREC
ZIBRECHD EQU   ZIBRECPL
ZIBRECRS EQU   ZIBREC+8
ZIBRECDT EQU   ZIBREC+10
ZIBMDRRC EQU   ZIBMDREC
ZIBRCPL  EQU   ZIBMDRRC
ZIBRCDT  EQU   ZIBMDRRC+24
@NM00018 EQU   ZIBBTU
ZOBDLBT  EQU   ISTZOBUF
ZOBDLBCM EQU   ZOBDLBT
ZOBRSV04 EQU   ZOBDLBCM+16
@NM00019 EQU   ZOBDLBCM+25
ZOBBTU   EQU   ZOBDLBT+28
ZOBWCC   EQU   ZOBDLBT+48
ZOBECCC  EQU   ZOBDLBT+50
ZOBDIO   EQU   ZOBFSM
ZOBCCW2  EQU   ZOBDIO+8
ZOBCPTCC EQU   ZOBCCW2
ZOBFLAGS EQU   ZOBCCW2+5
ZOBCCW3  EQU   ZOBDIO+16
ZOBCPTRC EQU   ZOBCCW3
ZOBCPN2C EQU   ZOBCPTRC
ZOBCPTRA EQU   ZOBCCW3+1
@NM00023 EQU   ZOBBTU
ZLBBTRAN EQU   ISTZLBUF
ZLBAIO   EQU   ZLBBTRAN+16
ZLBDTIO  EQU   ZLBFSM
ZLBCCW1  EQU   ZLBDTIO
ZLBCCW2  EQU   ZLBDTIO+8
ZLBCCW3  EQU   ZLBDTIO+16
ZLBSNS   EQU   ZLBDTIO+28
ZLBERC   EQU   ZLBDTIO+29
ZLBSAF   EQU   ZLBDTIO+48
ZLBSTAT  EQU   ZLBSAF
ZLBDEVST EQU   ZLBSTAT
ZLBRQTG  EQU   ZLBDTIO+50
ZLBRQFLG EQU   ZLBRQTG
ZLBFLAGS EQU   ZLBDTIO+56
ZLBTEXTA EQU   ZLBCCW3
ZLBTEXTB EQU   ZLBFLAGS
ZLBTEXT1 EQU   ZLBTEXTB
ZLBTEXTC EQU   ZLBFLAGS
ZLBPPL   EQU   ZLBTEXTC
ZLBFAIO  EQU   ZLBAIO
ZLBFSB   EQU   ZLBFAIO
ZLBFDBS  EQU   ZLBFAIO+32
TRAIODT  EQU   TRADATA
TRATH    EQU   TRAIODT+22
TRABDUD  EQU   TRAIODT+35
TRABUFFR EQU   TRADATA
TRAANODE EQU   TRABUFFR
TRABFFER EQU   TRABUFFR+8
EBCDCTAB EQU   EBCDTAB
SRB      EQU   SRBSECT
ZOBTEXT  EQU   ZOBBTU
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00024 EQU   TRABDUD+4
TRASEND  EQU   TRABDUD
TRARH    EQU   TRAIODT+32
TRATHDCF EQU   TRATH+8
TRATHSNF EQU   TRATH+6
TRATHOAF EQU   TRATH+4
TRATHDAF EQU   TRATH+2
TRATHHD  EQU   TRATH
TRARSV06 EQU   TRAIODT+21
TRAISEN  EQU   TRAIODT+20
TRAICPA  EQU   TRAIODT+16
TRAIPSW  EQU   TRAIODT+8
TRAICSW  EQU   TRAIODT
ZLBPPCSC EQU   ZLBPPL+14
ZLBPPRS1 EQU   ZLBPPL+13
ZLBPPRSV EQU   ZLBPPL+12
ZLBPPCLG EQU   ZLBPPL+12
ZLBPPCC  EQU   ZLBPPL+12
ZLBPPINT EQU   ZLBPPL+12
ZLBPPHIO EQU   ZLBPPL+12
ZLBPP    EQU   ZLBPPL+4
ZLBPPLDB EQU   ZLBPPL+1
ZLBPPLF  EQU   ZLBPPL
ZLBTEXT  EQU   ZLBTEXTA+8
ZLBRSV0A EQU   ZLBTEXTA
ZLBTCP   EQU   ZLBFLAGS+8
ZLBTCSW  EQU   ZLBFLAGS+1
ZLBRSV09 EQU   ZLBFLAGS
ZLBWCCSP EQU   ZLBFLAGS
ZLBRSV07 EQU   ZLBFLAGS
ZLBLSTST EQU   ZLBDTIO+52
ZLBRQSEQ EQU   ZLBRQTG+1
ZLBRT0B  EQU   ZLBRQFLG+1
ZLBRT0A  EQU   ZLBRQFLG+1
ZLBRT09  EQU   ZLBRQFLG+1
ZLBRT08  EQU   ZLBRQFLG+1
ZLBRT07  EQU   ZLBRQFLG
ZLBRT06  EQU   ZLBRQFLG
ZLBRT05  EQU   ZLBRQFLG
ZLBRT04  EQU   ZLBRQFLG
ZLBRT03  EQU   ZLBRQFLG
ZLBRT02  EQU   ZLBRQFLG
ZLBRT01  EQU   ZLBRQFLG
ZLBRT00  EQU   ZLBRQFLG
ZLBCHNST EQU   ZLBSTAT+1
ZLBUCST  EQU   ZLBDEVST
ZLBDEST  EQU   ZLBDEVST
ZLBRSV10 EQU   ZLBDEVST
ZLBLSTBF EQU   ZLBDTIO+44
ZLBRSV11 EQU   ZLBDTIO+40
ZLBLCCWA EQU   ZLBDTIO+36
ZLBLCPBA EQU   ZLBDTIO+32
ZLBCOMP  EQU   ZLBDTIO+31
ZLBRSV08 EQU   ZLBDTIO+30
ZLBRSV05 EQU   ZLBERC
ZLBFBMI  EQU   ZLBERC
ZLBETI   EQU   ZLBERC
ZLBEMI   EQU   ZLBERC
ZLBEBI   EQU   ZLBERC
ZLBECI   EQU   ZLBERC
ZLBELI   EQU   ZLBERC
ZLBSOC   EQU   ZLBSNS
ZLBSCC   EQU   ZLBSNS
ZLBSUS   EQU   ZLBSNS
ZLBSDC   EQU   ZLBSNS
ZLBSEQCK EQU   ZLBSNS
ZLBSBOL  EQU   ZLBSNS
ZLBSIR   EQU   ZLBSNS
ZLBSCR   EQU   ZLBSNS
ZLBRSV12 EQU   ZLBDTIO+24
ZLBCPTC3 EQU   ZLBCCW3+6
ZLBRSV04 EQU   ZLBCCW3+5
ZLBCPFL3 EQU   ZLBCCW3+4
ZLBCPAD3 EQU   ZLBCCW3+1
ZLBCPCF3 EQU   ZLBCCW3
ZLBCPTC2 EQU   ZLBCCW2+6
ZLBRSV03 EQU   ZLBCCW2+5
ZLBCPFL2 EQU   ZLBCCW2+4
ZLBCPAD2 EQU   ZLBCCW2+1
ZLBCPCF2 EQU   ZLBCCW2
ZLBCPTC1 EQU   ZLBCCW1+6
ZLBCMOD  EQU   ZLBCCW1+5
ZLBCPFL1 EQU   ZLBCCW1+4
ZLBCPAD1 EQU   ZLBCCW1+1
ZLBCPCF1 EQU   ZLBCCW1
ZLBLNG2  EQU   ZLBBTRAN+14
ZLBRSV01 EQU   ZLBBTRAN+12
ZLBFDBZ  EQU   ZLBBTRAN
ZOBTH2   EQU   @NM00023+4
ZOBLH    EQU   @NM00023
ZOBCPN2K EQU   ZOBCCW3+6
ZOBRSV99 EQU   ZOBCCW3+5
ZOBCPN2F EQU   ZOBCCW3+4
ZOBCPTC2 EQU   ZOBCPTRA
ZOBCPTC1 EQU   ZOBCPN2C
ZOBCPNPK EQU   ZOBCCW2+6
ZOBRSV03 EQU   ZOBFLAGS
ZOBRT08  EQU   ZOBFLAGS
ZOBRT06  EQU   ZOBFLAGS
ZOBCPNPF EQU   ZOBCCW2+4
ZOBCPTCA EQU   ZOBCCW2+1
ZOBCPNPC EQU   ZOBCPTCC
ZOBCPWTK EQU   ZOBDIO+6
ZOBRSV02 EQU   ZOBDIO+5
ZOBCPWTF EQU   ZOBDIO+4
ZOBCPTXA EQU   ZOBDIO+1
ZOBCPWTC EQU   ZOBDIO
ZOBRSV09 EQU   ZOBECCC
ZOBECSP  EQU   ZOBECCC
ZOBRSV08 EQU   ZOBECCC
ZOBRSV07 EQU   ZOBDLBT+49
ZOBRSV06 EQU   ZOBWCC
ZOBWCSP  EQU   ZOBWCC
ZOBRSV05 EQU   ZOBWCC
ZOBRSV10 EQU   ZOBDLBCM+26
@NM00022 EQU   @NM00019
@NM00021 EQU   @NM00019
@NM00020 EQU   @NM00019
ZOBLNG2  EQU   ZOBDLBCM+14
ZOBRSV01 EQU   ZOBDLBCM+12
ZOBFDB   EQU   ZOBDLBCM
ZIBTH2   EQU   @NM00018+4
ZIBLH    EQU   @NM00018
ZIBRCTXT EQU   ZIBMDRRC+36
ZIBRCRID EQU   ZIBRCDT+10
ZIBRCNAM EQU   ZIBRCDT+2
ZIBRCUA  EQU   ZIBRCDT
ZIBRCPUI EQU   ZIBRCPL+20
ZIBRCPUN EQU   ZIBRCPL+16
ZIBRCTIM EQU   ZIBRCPL+12
ZIBRCDAT EQU   ZIBRCPL+8
ZIBRCRS1 EQU   ZIBRCPL+6
ZIBRCSID EQU   ZIBRCPL+5
ZIBRCID  EQU   ZIBRCPL+4
ZIBRCSW  EQU   ZIBRCPL+2
ZIBRCSYR EQU   ZIBRCPL+1
ZIBRCL   EQU   ZIBRCPL
ZIBRECTX EQU   ZIBREC+22
ZIBRECID EQU   ZIBRECDT+10
ZIBRECNA EQU   ZIBRECDT+2
ZIBRECUA EQU   ZIBRECDT
ZIBRECSV EQU   ZIBRECRS
ZIBRECDA EQU   ZIBRECPL+4
ZIBRECSI EQU   ZIBRECHD+3
ZIBRECDV EQU   ZIBRECHD+2
ZIBRECFL EQU   ZIBRECHD+1
ZIBRECTY EQU   ZIBRECHD
ZIBTEXT  EQU   ZIBSIB+4
ZIBRSV04 EQU   ZIBSIB
ZIBTEXT2 EQU   ZIBFITXT
ZIBTEXT1 EQU   ZIBFIB+52
@NM00017 EQU   @NM00016
ZIBFDBS  EQU   ZIBBTU
@NM00015 EQU   ZIBMDREC
@NM00014 EQU   ZIBFSB
ZIBLNG2  EQU   ZIBAIOCM+14
ZIBRSV03 EQU   ZIBAIOCM+13
ZIBWKBYT EQU   ZIBAIOCM+12
ZIBFDBZ  EQU   ZIBAIOCM
ZIBCPNPK EQU   ZIBCCW2+6
ZIBRSV02 EQU   ZIBCCW2+5
ZIBCPTPF EQU   ZIBCCW2+4
ZIBCPTCA EQU   ZIBCCW2+1
ZIBCPNPC EQU   ZIBCPTCC
ZIBCPRDK EQU   ZIBDIO+6
ZIBRSV01 EQU   ZIBDIO+5
ZIBCPRDF EQU   ZIBDIO+4
ZIBCPTXA EQU   ZIBDIO+1
ZIBCPRDC EQU   ZIBDIO
FSBRT0B  EQU   @NM00013+1
FSBRT0A  EQU   @NM00013+1
FSBRT09  EQU   @NM00013+1
FSBRT08  EQU   @NM00013+1
FSBRT07  EQU   @NM00013
FSBRT06  EQU   @NM00013
FSBRT05  EQU   @NM00013
FSBRT04  EQU   @NM00013
FSBRT03  EQU   @NM00013
FSBRT02  EQU   @NM00013
FSBRT01  EQU   @NM00013
FSBRT00  EQU   @NM00013
FSBLDCUF EQU   FSBLDFLG
FSBLDSIF EQU   FSBLDFLG
FSBLDSOF EQU   FSBLDFLG
FSBLDEBF EQU   FSBLDFLG
FSBLDBBF EQU   FSBLDFLG
FSBLDFME EQU   FSBLDFLG
FSBLDSCF EQU   FSBLDFLG
FSBLDRMF EQU   FSBLDFLG
FSBRH2   EQU   FSBRHFLD+1
FSBRH1   EQU   FSBRHFLD
FSBALIGN EQU   FSBCOMBN
UNBTYPE  EQU   ISTUNBRU
NSRUDA8T EQU   NSRUDAT8
NSRUOHID EQU   NSRUOH1
NSRULSV  EQU   NSRUCLSP
NSRUNA4  EQU   NSRUNA+2
NSRUNA3  EQU   NSRUNA2
NSRUNA1  EQU   NSRUNA
NSRUDILF EQU   NSRUDIL+4
NSRUDILE EQU   NSRUDIL+3
NSRUDILD EQU   NSRUDIL+2
NSRUDILC EQU   NSRUDILB
@NM00008 EQU   NSRUDILB
NSRUDILA EQU   NSRUDIL
NSRUDA7T EQU   NSRUDAT7
NSRUDA6L EQU   NSRUDAT6+4
NSRUDA6S EQU   NSRUDAT6
NSRUDA5E EQU   NSRUDAT5
NSRUDA4T EQU   NSRUDAT4
NSRUDA3S EQU   NSRUDAT3
SRUDAT4D EQU   SRUDATA4
SRUDAT3I EQU   SRUDATA3
MRUDATA  EQU   ISTMRU+9
MRURESP  EQU   ISTMRU+7
MRUMODIF EQU   ISTMRU+6
MRUCMND  EQU   ISTMRU+5
MRUDAF   EQU   ISTMRU+3
MRUREQ   EQU   ISTMRU+2
MRUPREF  EQU   ISTMRU
SRUDAT2N EQU   SRUDAT2+1
SRUDAT2T EQU   SRUDAT2
SRUDAT1I EQU   SRUDAT1+2
SRUTSPRO EQU   SRUDAT1L
SRUFMPRO EQU   SRUDAT1L
SRUDAT1T EQU   SRUDAT1
INORUET  EQU   ISTINORU
CTDRUSTA EQU   ISTCTDRU
TRRPEP   EQU   ISTTRRU+2
@NM00007 EQU   TRRTYPE
@NM00006 EQU   TRRTYPE
NSRUDAF  EQU   NSRUDAT1
NSSSVT5A EQU   NSSSVT5
NSSSVT4D EQU   NSSSVT4+3
NSSSVT4C EQU   NSSSVT4+2
NSSSVT4B EQU   NSSSVT4+1
NSSSVT4A EQU   NSSSVT4
NSSSVT3K EQU   NSSSVT3+8
NSSSVT3J EQU   NSSSVT3+7
NSSSVT3I EQU   NSSSVT3+6
@NM00005 EQU   NSSSVT3G
NSSSVT3H EQU   NSSSVT3G
NSSSVT3F EQU   NSSSVT3+4
NSSSVT3E EQU   NSSSVT3+3
@NM00004 EQU   NSSSVT3C
NSSSVT3D EQU   NSSSVT3C
NSSSVT3B EQU   NSSSVT3+1
NSSSVT3A EQU   NSSSVT3
NSSSVT   EQU   NSSSVRU+2
NSSSVDAF EQU   NSSSVRU
NSRUHKTY EQU   NSRUHOOK
NSRURCD  EQU   NSRUNETS+2
NSRUSUB  EQU   NSRUNETS+1
NSRUID   EQU   NSRUNETS
SRURSV01 EQU   SRULDID+4
SRUPSSN  EQU   SRULDID+2
SRUDFCLV EQU   SRUSPSN
@NM00003 EQU   SRUTYPE
SRUPSAC  EQU   SRUTYPE
SRUSPAC  EQU   SRUTYPE
SRUQSREQ EQU   ISTSRU
SENRU    EQU   ISTSENRU+4
SRUSNS4  EQU   SRUSENS2+1
SRUSNS3  EQU   SRUSENS2
SRUSNST  EQU   SRUSENS1+1
SRUSNS1  EQU   SRUSENS1
@NM00114 EQU   SMSLAST+57
@NM00113 EQU   SMSLAST+39
@NM00112 EQU   SMSLAST+21
@NM00111 EQU   SMSLAST
@NM00110 EQU   SMSSECND+75
@NM00109 EQU   SMSSECND+57
@NM00108 EQU   SMSSECND+39
@NM00107 EQU   SMSSECND+21
@NM00106 EQU   SMSSECND
@NM00105 EQU   SMSFIRST+75
@NM00104 EQU   SMSFIRST+57
@NM00103 EQU   SMSFIRST+39
@NM00102 EQU   SMSFIRST+21
@NM00101 EQU   SMSFIRST
@NM00100 EQU   SMSHDRER+72
@NM00099 EQU   SMSHDRER+54
@NM00098 EQU   SMSHDRER+36
@NM00097 EQU   SMSHDRER+16
@NM00096 EQU   SMSHDRER+8
@NM00095 EQU   SMSHDRER
@NM00094 EQU   HEXFLGS
@NM00093 EQU   TEXTBUF+77
@NM00092 EQU   TEXTBUF
@NM00091 EQU   LLABEL1
LNTHRH   EQU   LNINPUT+48
LNFSB    EQU   LNINPUT+16
LNLNG    EQU   LNINPUT+14
LNRSVD   EQU   LNINPUT+12
LNFDB    EQU   LNINPUT
LNSCNTL  EQU   LNBUF2S+87
@NM00090 EQU   LNBUF2S+81
LNSADDR  EQU   LNBUF2S+79
@NM00089 EQU   LNBUF2S+73
LNSTIME  EQU   LNBUF2S+71
@NM00088 EQU   LNBUF2S+65
LNSSTAT2 EQU   LNBUF2S+63
@NM00087 EQU   LNBUF2S+56
LNSSTAT1 EQU   LNBUF2S+54
@NM00086 EQU   LNBUF2S+47
LNSEPCF  EQU   LNBUF2S+45
@NM00085 EQU   LNBUF2S+39
@NM00084 EQU   LNBUF2S+33
@NM00083 EQU   LNBUF2S+26
LNSSCF   EQU   LNBUF2S+24
@NM00082 EQU   LNBUF2S
@NM00081 EQU   LN2SECND+10
LN2PCFL2 EQU   LN2SECND+7
@NM00080 EQU   LN2SECND+6
LN2LCDD2 EQU   LN2SECND+4
@NM00079 EQU   LN2SECND+3
LN2LCDL2 EQU   LN2SECND
@NM00078 EQU   LNBUF2+57
@NM00077 EQU   LN2FIRST+10
LN2PCFL1 EQU   LN2FIRST+7
@NM00076 EQU   LN2FIRST+6
LN2LCDD1 EQU   LN2FIRST+4
@NM00075 EQU   LN2FIRST+3
LN2LCDL1 EQU   LN2FIRST
@NM00074 EQU   LNBUF2
@NM00073 EQU   LNFRST+50
LNTMDAT  EQU   LNFRST+48
@NM00072 EQU   LNFRST+47
@NM00071 EQU   LNFRST+36
LNEPDAT  EQU   LNFRST+34
@NM00070 EQU   LNFRST+33
@NM00069 EQU   LNFRST+25
@NM00068 EQU   LNFRST+16
@NM00067 EQU   LNFRST+5
@NM00066 EQU   LNFRST
TPTXTDAT EQU   TPTXT+33
@NM00065 EQU   TPTXT+32
@NM00064 EQU   TPTXT
TPROFID0 EQU   TPROTHD+29
TPROFID1 EQU   TPROTHD
@NM00063 EQU   TPRO2+32
@NM00062 EQU   TPRO2+25
@NM00061 EQU   TPRO2+16
@NM00060 EQU   TPRO2+9
@NM00059 EQU   TPRO2
TPRIFID1 EQU   TPRITHD
@NM00058 EQU   TPRI3+32
@NM00057 EQU   TPRI3
TPRIFSBD EQU   TPRI2+33
@NM00056 EQU   TPRI2+31
@NM00055 EQU   TPRI2+25
@NM00054 EQU   TPRI2+16
@NM00053 EQU   TPRI2+9
@NM00052 EQU   TPRI2
@NM00051 EQU   TPLOC3
@NM00050 EQU   TPLOC2+25
@NM00049 EQU   TPLOC2+16
@NM00048 EQU   TPLOC2+8
@NM00047 EQU   TPLOC2
@NM00046 EQU   TPRSVLNG+21
TPLNG2DT EQU   TPRSVLNG+17
@NM00045 EQU   TPRSVLNG+16
@NM00044 EQU   TPRSVLNG+9
RSVDAT   EQU   TPRSVLNG+5
@NM00043 EQU   TPRSVLNG+4
@NM00042 EQU   TPFIRST+59
TPFDBDAT EQU   TPFIRST+33
@NM00041 EQU   TPFIRST+31
@NM00040 EQU   TPFIRST+25
@NM00039 EQU   TPFIRST+16
@NM00038 EQU   TPFIRST+10
@NM00037 EQU   TPFIRST+6
@NM00036 EQU   TPFIRST
@NM00035 EQU   CLSECOND+16
@NM00034 EQU   CLSECOND
@NM00033 EQU   CLFIRST+25
@NM00032 EQU   CLFIRST+16
@NM00031 EQU   CLFIRST+9
@NM00030 EQU   CLFIRST+4
@NM00029 EQU   CLFIRST
FMTPLST  EQU   FMTAPPLS+28
FMTRTNAD EQU   FMTAPPLS+20
GTFOPTS  EQU   FMTAPPLS+8
@NM00028 EQU   HISSAVE
@NM00027 EQU   MYSAVE
@NM00026 EQU   BLKHDR
@NM00025 EQU   SWITCHES
TRARSV05 EQU   ISTTRAC+30
TRALRC   EQU   ISTTRAC+28
TRATIME  EQU   ISTTRAC+24
TRARSV04 EQU   TRADNODE+4
TRADAF   EQU   TRACID+2
TRASAF   EQU   TRACID
TRASEN   EQU   TRAFLG2
TRAMPX   EQU   TRAFLG2
TRADEV   EQU   TRAFLG2
TRABDU   EQU   TRAFLG2
TRAESTAT EQU   TRAFLG2
TRAPIU   EQU   TRAFLG2
TRARSV02 EQU   TRAFLG
TRAANODF EQU   TRAFLG
TRADNODF EQU   TRAFLG
TRABF    EQU   TRAFLG
TRAIO    EQU   TRAFLG
TRAPRTU  EQU   TRAFLG
TRAFRST  EQU   TRAFLG
TRACONT  EQU   TRAFLG
TRABDWR  EQU   TRABDW+2
TRABDWL  EQU   TRABDW
TRACHAIN EQU   ISTTRAC+4
TRARSV01 EQU   TRA1WORD+2
TRALNG   EQU   TRA1WORD+1
TRATYPE  EQU   TRA1WORD
ZLBLNG1  EQU   ZLBFSM
ZLBCHAIN EQU   ISTZLBUF
ZOBLNG1  EQU   ZOBFSM
ZOBCHAIN EQU   ISTZOBUF
ZIBLNG1  EQU   ZIBFSM
ZIBCHAIN EQU   ISTZIBUF
FSBFDB   EQU   ISTFSB+32
FSBRSV01 EQU   FSBFSB+30
FSBTHCNT EQU   FSBFSB+28
FSBRLRSV EQU   FSBRLSTS
FSBCFTX  EQU   FSBRLSTS
FSBICNCB EQU   FSBMSGID
FSBSSOC  EQU   FSBSS2
FSBSSCC  EQU   FSBSS2
FSBSSDC  EQU   FSBSS2
FSBSSEC  EQU   FSBSS2
FSBSSIR  EQU   FSBSS2
FSBSSCR  EQU   FSBSS2
@NM00012 EQU   FSBSS2
@NM00011 EQU   FSBSS1
FSBSSDE  EQU   FSBSS1
FSBSSUS  EQU   FSBSS1
@NM00010 EQU   FSBSS1
FSBSOHI  EQU   FSBERC
FSBLGI   EQU   FSBERC
FSBLMRI  EQU   FSBFBMI
FSBETI   EQU   FSBERC
FSBEMI   EQU   FSBERC
FSBEBI   EQU   FSBERC
FSBECI   EQU   FSBERC
FSBELI   EQU   FSBERC
FSBMJRCD EQU   FSBSRCAT
FSBXLCI  EQU   FSBXCODE
FSBXFINS EQU   FSBXCODE
FSBXNORM EQU   FSBXFSTS
FSBSCODE EQU   FSBSYSRS
FSBSPHSE EQU   FSBSYSRS
FSBSERR  EQU   FSBSYSRS
FSBCMD   EQU   FSBSEQ
FSBDTRCE EQU   FSBFLAGS
FSBASBTU EQU   FSBFLAGS
FSBINPET EQU   FSBFLAGS
FSBNONCB EQU   FSBFLAGS
FSBLBIND EQU   FSBFLAGS
FSBFFIND EQU   FSBFLAGS
FSBACIND EQU   FSBFLAGS
FSBRFIND EQU   FSBFLAGS
FSBDAF   EQU   FSBCID+2
FSBSAF   EQU   FSBCID
FSBGATE  EQU   FSBFSBA
FSBRSV02 EQU   FSBSFLGS
FSBPGBUF EQU   FSBSFLGS
FSBMNSDA EQU   FSBMNRCD
FSBMNOA  EQU   FSBMNRCD
FSBMNDIF EQU   FSBMNRCD
FSBMNEOP EQU   FSBMNRCD
FSBMNDNU EQU   FSBMNRCD
FSBMNATN EQU   FSBMNRCD
FSBMNRVI EQU   FSBMNRCD
FSBMNELI EQU   FSBMNRCD
FSBLNGTH EQU   FSBFSB+1
FSBTYPE  EQU   FSBFSB
BTUEXTR  EQU   ISTBTU+19
BTURSV02 EQU   BTUSYSTR
BTUPHASE EQU   BTUSYSTR
BTURSV01 EQU   BTUSYSTR
BTUBDU   EQU   ISTBTU+14
BTURH3   EQU   BTURH+2
BTURH2   EQU   BTURH+1
BTURH1   EQU   BTURH
BTUDCF   EQU   BTUBTH+8
BTUZRTSC EQU   BTURQFLG+1
BTUZRT0B EQU   BTURQFLG+1
BTUZRT0A EQU   BTURQFLG+1
BTUZRT09 EQU   BTURQFLG+1
BTUZRT08 EQU   BTURQFLG+1
BTUZRT07 EQU   BTURQFLG
BTUZRT06 EQU   BTURQFLG
BTUZRT05 EQU   BTURQFLG
BTUZRT04 EQU   BTURQFLG
BTUZRT03 EQU   BTURQFLG
BTUZRT02 EQU   BTURQFLG
BTUZRT01 EQU   BTURQFLG
BTUZRT00 EQU   BTURQFLG
BTUSORCE EQU   BTUBTH+4
BTUDEST  EQU   BTUBTH+2
BTUCDF   EQU   BTUFID+1
BTUSCF   EQU   BTUFID+1
BTUPRY   EQU   BTUFID+1
BTUASFL  EQU   BTUFID
BTUPSFL  EQU   BTUFID
BTUMPF   EQU   BTUFID
TH2SNF   EQU   ISTTH2+4
TH2OAF   EQU   ISTTH2+3
TH2DAF   EQU   ISTTH2+2
TH2CDF   EQU   TH2FLAG1+1
TH2SEF   EQU   TH2FLAG1+1
TH2PYF   EQU   TH2FLAG1+1
TH2AFI   EQU   TH2FLAG1
TH2PSI   EQU   TH2FLAG1
TH2CMPLI EQU   TH2MPF
TH2RHI   EQU   TH2MPF
TH2FID   EQU   TH2FLAG1
THDCF    EQU   ISTTH+8
THSNF    EQU   ISTTH+6
THOAF    EQU   ISTTH+4
THDAF    EQU   ISTTH+2
THCDF    EQU   THFLGB
THSEF    EQU   THFLGB
THPYF    EQU   THFLGB
THAFI    EQU   THFLGA
THPSI    EQU   THFLGA
THCMPLI  EQU   THMPF
THRHI    EQU   THMPF
THFID    EQU   THFLAG1
LHVDATA  EQU   ISTLH+4
LHFUNCT  EQU   ISTLH+3
@NM00009 EQU   ISTLH+2
LHLEN    EQU   ISTLH
FDBOFSET EQU   ISTFDB+10
FDBDATCT EQU   ISTFDB+8
FDBDATAA EQU   ISTFDB+4
FDBFDBA  EQU   ISTFDB
BDURSV04 EQU   BDUFLAGS
BDURTOE  EQU   BDUFLAGS
BDUSTPR  EQU   BDUFLAGS
BDURSV03 EQU   BDUFLAGS
BDUALT   EQU   BDUFUNC
BDUNACK  EQU   BDUFUNC
BDUACK   EQU   BDUFUNC
BDUTRPM  EQU   BDUFUNC
BDUFBMI  EQU   BDUFUNC
BDULDGPH EQU   BDUFUNC
BDUHEADP EQU   BDUFUNC
BDUSOH   EQU   BDUCHECK
BDURSV01 EQU   BDUMODIF
BDUMOD0  EQU   BDUMOD1
BDUCOMND EQU   ISTBDU
TRFRSV01 EQU   TRFFLG
NSRUNA6  EQU   NSRUNA5
RUBDATA  EQU   ISTRUB
RHRSVD5  EQU   RH3
RHRSVD4  EQU   RH3
RHLOG    EQU   RH3
RHRSVD3  EQU   RH3
RHRCDIR  EQU   RH3
RHCDIR   EQU   RH3
RHEB     EQU   RH3
RHBB     EQU   RH3
RHPACE   EQU   RH2
RHRSVD2  EQU   RH2
RHINOP   EQU   RHRSVD1
RHBUSY   EQU   RHRETRY
RHEXCEPT EQU   RH2
RHRRN    EQU   RH2
RHPE     EQU   RH2
RHFME    EQU   RH2
RHCHAIN  EQU   RH1
RHSENSE  EQU   RH1
RHFORMAT EQU   RH1
RHDIRI   EQU   RH1
RHSCI    EQU   RH1
RHTYPE   EQU   RH1
RHQS     EQU   RH1
@NM00002 EQU   SRBSECT+40
@NM00001 EQU   SRBSECT+38
SRBPRIOR EQU   SRBSECT+37
SRBPKF   EQU   SRBSECT+36
SRBSAVE  EQU   SRBSECT+32
SRBPARM  EQU   SRBSECT+28
SRBRMTR  EQU   SRBSECT+24
SRBEP    EQU   SRBSECT+20
SRBPTCB  EQU   SRBFLC+4
SRBPASID EQU   SRBFLC+2
SRBCPAFF EQU   SRBFLC
SRBASCB  EQU   SRBSECT+8
SRBFLNK  EQU   SRBSECT+4
SRBID    EQU   SRBSECT
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00414 EQU   @RC00412
@RC00451 EQU   AMDEXIT
@RC00458 EQU   AMDEXIT
@RC00476 EQU   AMDEXIT
@RC00492 EQU   AMDEXIT
@RC00578 EQU   AMDEXIT
@RC00591 EQU   AMDEXIT
@RC00610 EQU   AMDEXIT
@RT00693 EQU   AMDEXIT
@RF00693 EQU   AMDTPRTX
@RC00703 EQU   AMDEXIT
@RC00711 EQU   AMDEXIT
@RC00709 EQU   AMDEXIT
@RT00725 EQU   @EL00002
@RF00730 EQU   @RC00727
@RT00745 EQU   @EL00002
@RT00780 EQU   @EL00003
@RC00579 EQU   @RC00578
@RC00592 EQU   @RC00591
@ENDDATA EQU   *
         END   AMDUSRFD,(C'PLS1717',0701,77035)

         TITLE 'IKJRBBU0 -- UADS-REFORMATTOR                           *
                        '
          LCLA  &SUBPN
&SUBPN    SETA  1
          ENTRY IKJREF
IKJRBBU0  CSECT
IKJREF    DS    0H
IKJRBBU0 CSECT ,                                                   0002
@MAINENT DS    0H                                                  0002
         USING *,@15                                               0002
         B     @PROLOG                                             0002
         DC    AL1(16)                                             0002
         DC    C'IKJRBBU0  76.163'                                 0002
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0002
         BALR  @09,0                                               0002
@PSTART  LA    @10,4095(,@09)                                      0002
         USING @PSTART,@09                                         0002
         USING @PSTART+4095,@10                                    0002
         L     @00,@SIZDATD                                        0002
         GETMAIN  R,LV=(0)
         LR    @11,@01                                             0002
         LA    @12,4095(,@11)                                      0002
         USING @DATD,@11                                           0002
         USING @DATD+4095,@12                                      0002
         ST    @13,@SA00001+4                                      0002
         LM    @00,@01,20(@13)                                     0002
         ST    @11,8(,@13)                                         0002
         LR    @13,@11                                             0002
         XC    @ZTEMPS(@ZLEN),@ZTEMPS
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -- IKJREF                                           */
*/*                                                                  */
*/* DESCRIPTIVE NAME -- N/A                                          */
*/*                                                                  */
*/* FUNCTION -- MAIN ENTRY TO UADSREFM, TOP LEVEL EXECUTOR           */
*/*   OPERATION --                                                   */
*/*   -  EXECUTE STANDARD PROLOGUE, SAVING ENTRY ENVIRONMENT         */
*/*   -  PERFORM SEGMENT RINIT TO INITIALIZE UADSREFM ENVIRONMENT    */
*/*   -  PERFORM SEGMENT STAE TO CREATE STAE EXIT LINKAGE            */
*/*   -  PERFORM SEGMENT RJFCB TO DETERMINE OPEN ACTION              */
*/*   -  PERFORM SEGMENT ROPEN TO OPEN DCBS FOR UPDAT/OUTPUT OR      */
*/*      INPUT/OUTPUT                                                */
*/*   -  PERFORM SEGMENT RENQU TO ENQ SHARED ON SYSIKJUA/OPENUADS    */
*/*   -  PERFORM SEGMENT RREAD TO READ EACH USERID IN DIRECTORY      */
*/*      SEQUENCE UNTIL END OF FILE IS DETECTED (OR TERMINATION      */
*/*      CONDITION OCCURS)                                           */
*/*   -  PERFORM SEGMENT RGMNEW TO OBTAIN OUTPUT BUFFER SPACE        */
*/*   -  PERFORM SEGMENTS RBLDHDR AND RBLDMBR TO REBUILD CURRENT     */
*/*      MEMBER BY HIERARCHICAL STRUCTURE                            */
*/*   -  PERFORM SEGMENT RENQM TO ENQUEUE EXCLUSIVELY ON SYSIKJUA/   */
*/*      'USERID' IF OUTPUT UADS IS OLD (UPDAT MODE)                 */
*/*   -  PERFORM SEGMENT RWRITE TO WRITE THE REBUILT USERID MEMBER   */
*/*      INTO OUTPUT UADS (SYSUADS)                                  */
*/*   -  PERFORM SEGMENT RDEQM TO DEQUEUE SYSIKJUA/'USERID' IF IT IS */
*/*      CURRENTLY ENQUEUED                                          */
*/*   -  PERFORM SEGMENT RMODEU TO UPDATE (AND PRINT IF MESSAGE      */
*/*      BUFFER IS FULL) THE 'USERIDS REFORMATTED' MESSAGE           */
*/*   -  PERFORM SEGMENT RDEQU TO DEQUEUE 'SYSIKJUA/OPENUADS'        */
*/*   -  PERFORM SEGMENT REND TO RELEASE ALL RESOURCES AND SET       */
*/*      RETURN CODE                                                 */
*/*   -  PERFORM STANDARD EPILOGUE TO RESTORE ENTRY ENVIRONMENT      */
*/*      AND RETURN TO CALLER                                        */
*/*                                                                  */
*/* ENTRY -- ATTACHED (BY TMP/EQUIVALENT)                            */
*/*                                                                  */
*/* INPUT --                                                         */
*/*   -  REGISTER 1 POINTS TO CPPL                                   */
*/*                                                                  */
*/* OUTPUT -- N/A                                                    */
*/*                                                                  */
*/* EXTERNAL REFERENCES -- N/A                                       */
*/*                                                                  */
*/* EXIT-NORMAL -- RETURN BY ENTRY LINK REGISTER 14                  */
*/*   CONDITIONS -- N/A                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* EXIT-ERROR -- N/A                                                */
*/*   CONDITIONS -- N/A                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/********************************************************************/
*/*  IKJREF:  EP(EFFECTIVE) TO UADS-REFORM EXTERNAL PROCEDURE        */
*                                                                  0117
*           CALL  RINIT;            /* PERFORM INITIALIZATION        */
         BAL   @14,RINIT                                           0117
*           CALL  RSTAE;            /* ESTABLISH STAE ENVIRONMENT    */
         BAL   @14,RSTAE                                           0118
*           CALL  RJFCB;            /* DEFINE DCB RELATIONSHIP       */
         BAL   @14,RJFCB                                           0119
*           CALL  ROPEN;            /* OPEN DCBS FOR UADS            */
         BAL   @14,ROPEN                                           0120
*           CALL  RENQU;            /* ENQ ON SYSIKJUA/OPENUADS      */
*                                                                  0121
         BAL   @14,RENQU                                           0121
*           DO  LIMIT = 1 TO 1;        /* CHK TO REVISE CURRENT MBR  */
         LA    @08,1                                               0122
         STH   @08,LIMIT                                           0122
@DL00122 DS    0H                                                  0123
*             CALL  RREAD;          /* READ IN CURRENT MEMBER        */
         BAL   @14,RREAD                                           0123
*             IF  RENDOF = '0'B     /* CHK FOR UADS END OF FILE      */
*               THEN                /* NO,                           */
         TM    RENDOF,B'00100000'                                  0124
         BNZ   @RF00124                                            0124
*                 DO;                                              0125
*                   CALL  RGMNEW;   /* GET SPACE FOR NEW MBR ENTRY   */
         BAL   @14,RGMNEW                                          0126
*                   CALL  RBLDHDR;  /* BUILD NEW HEADER BLOCK        */
         BAL   @14,RBLDHDR                                         0127
*                   CALL  RBLDMBR;  /* BUILD NEW MEMBER ENTRY        */
         BAL   @14,RBLDMBR                                         0128
*                   CALL  RENQM;    /* ENQ ON SYSIKJUA/'USERID'      */
         BAL   @14,RENQM                                           0129
*                   CALL  RWRITE;   /* WRITE NEW MEMBER IN UADS      */
         BAL   @14,RWRITE                                          0130
*                   CALL  RDEQM;    /* DEQ FROM SYSIKJUA/'USERID'    */
         BAL   @14,RDEQM                                           0131
*                   CALL  RMODEU;   /* ISSUE USERIDS-MODE MESSAGE    */
         BAL   @14,RMODEU                                          0132
*                   IF RFMQUIT='0'B /* CHK FOR TERMINATION           */
*                     THEN          /* NO,                           */
         TM    RFMQUIT,B'01000000'                                 0133
         BNZ   @RF00133                                            0133
*                       DO;                                        0134
*                         LIMIT = 0;  /* SET TO CONTINUE TO READ     */
         SLR   @08,@08                                             0135
         STH   @08,LIMIT                                           0135
*                         UIDQUIT = '0'B;/* CLEAR USERID TERM FLAG   */
         NI    UIDQUIT,B'01111111'                                 0136
*                         RFCTLR=RFCTLR&FLAGMSK;  /* CONTROL FLAGS   */
         NC    RFCTLR(5),FLAGMSK                                   0137
         MVI   RFCTLR+5,X'00'                                      0137
*                       END;                                       0138
*                 END;                                             0139
@RF00133 DS    0H                                                  0140
*           END;                                                   0140
*                                                                  0140
@RF00124 LA    @08,1                                               0140
         AH    @08,LIMIT                                           0140
         STH   @08,LIMIT                                           0140
         CH    @08,@CH00032                                        0140
         BNH   @DL00122                                            0140
*           CALL  REND;             /* TERMINATE REFORM FUNCTIONS    */
         BAL   @14,REND                                            0141
*/*         END;     (EFFECTIVE) OF REFORM PROCESSOR                 */
*MAINX:     RETURN  CODE(RETURNC);  /* END OF REFORM EXECUTOR        */
MAINX    L     @08,RETURNC                                         0142
         L     @13,4(,@13)                                         0142
         L     @00,@SIZDATD                                        0142
         LR    @01,@11                                             0142
         FREEMAIN R,LV=(0),A=(1)
         LR    @15,@08                                             0142
         L     @14,12(,@13)                                        0142
         LM    @00,@12,20(@13)                                     0142
         BR    @14                                                 0142
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -- RINIT                                            */
*/*                                                                  */
*/* DESCRIPTIVE NAME -- N/A                                          */
*/*                                                                  */
*/* FUNCTION -- INITIALIZE UADSREFM ENVIRONMENT                      */
*/*                                                                  */
*/*   OPERATION --                                                   */
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */
*/*   -  CLEAR GETMAIN AREA                                          */
*/*   -  SET POINTERS TO CONTROL BLOCKS -- CPPL (REGISTER 1),        */
*/*      ECT (CPPLECT), ECT (ECTPTR), UPT (CPPLUPT), REFMECB,        */
*/*      AND TO CURRENT DIRECTORY ENTRY AREA                         */
*/*   -  INITIALIZE PARAMETER LISTS, PARAMETER BLOCKS, AND DCBS      */
*/*   -  SET POINTERS TO DCBS                                        */
*/*   -  SET RDJFCB EXIT LISTS AT HEAD OF RDJFCB READ AREAS --       */
*/*      RDJINNA AND RDJEXAA                                         */
*/*   -  INITIALIZE CONTROLS FOR USERID-REFORMATTED MESSAGE BUFFER   */
*/*   -  (RESTORE ENTRY LINK REGISTER 14 AND RETURN)                 */
*/*                                                                  */
*/* ENTRY -- N/A, INLINE SEGMENT (PSEUDO, LINKED BY REGISTER 14)     */
*/*                                                                  */
*/* INPUT --                                                         */
*/*   -  REGISTER 1, POINTER TO CPPL                                 */
*/*                                                                  */
*/* OUTPUT --                                                        */
*/*   -  UADSREFM ENVIRONMENT ESTABLISHED                            */
*/*                                                                  */
*/* EXTERNAL REFERENCES -- N/A                                       */
*/*                                                                  */
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14 )           */
*/*                                                                  */
*/*   CONDITIONS -- N/A                                              */
*/*                                                                  */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* EXIT-ERROR -- N/A                                                */
*/*                                                                  */
*/*   CONDITIONS -- N/A                                              */
*/*                                                                  */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */
*/*                                                                  */
*/********************************************************************/
*                                                                  0143
*RINIT:     /* INITIALIZATION FUNCTION                               */
*           PROCEDURE                                              0143
*                 OPTIONS(DONTSAVE,NOSAVEAREA); /* NO REGS SAVED,    */
@EL00001 L     @13,4(,@13)                                         0143
@EF00001 L     @00,@SIZDATD                                        0143
         LR    @01,@11                                             0143
         FREEMAIN R,LV=(0),A=(1)
@ER00001 LM    @14,@12,12(@13)                                     0143
         BR    @14                                                 0143
RINIT    DS    0H                                                  0144
*                                   /* NO SAVE AREA CREATED          */
*                                                                  0144
*           RESPECIFY (R14) RESTRICTED;                            0144
*           SAVLNKA = R14;          /* SAVE LINK REGISTER            */
         ST    R14,SAVLNKA                                         0145
*           RESPECIFY (R14) UNRESTRICTED;                          0146
*                                                                  0146
*           /* CLEAR GOTMAIN AREA                                    */
*           RESPECIFY (RSPZOP,RLNG) RESTRICTED;                    0147
*           GEN(LH    RLNG,@SIZDATD+2);  /* SET BASIC LENGTH         */
         LH    RLNG,@SIZDATD+2
*           RESPECIFY (R11) RESTRICTED;                            0149
*           RLNG = RLNG-(ADDR(SVREND)-R11);  /* EXCLUDE SAVE LINKS   */
         LA    @08,SVREND                                          0150
         LCR   @08,@08                                             0150
         ALR   @08,R11                                             0150
         ALR   RLNG,@08                                            0150
*           RESPECIFY (R11) UNRESTRICTED;                          0151
*           RSPZOP = ADDR(XCOP);    /* SET FOR EXCLUSIVE-OR OPN      */
         LA    RSPZOP,XCOP                                         0152
*           RESPECIFY (RFROM,RTO) RESTRICTED;                      0153
*           RFROM = ADDR(HEDBPTR);  /* SET SOURCE PTR                */
         LA    RFROM,HEDBPTR                                       0154
*           RTO = RFROM;            /* SET RECEIVER PTR              */
         LR    RTO,RFROM                                           0155
*           CALL  DOPSPAZ;          /* GO TO PERFORM EXCLUSIVE-OR    */
         BAL   @14,DOPSPAZ                                         0156
*           RESPECIFY (RSPZOP,RSPW,RLNG,RFROM,RTO) UNRESTRICTED;   0157
*           RESPECIFY (R1) RESTRICTED;                             0158
*           CPPLPTR = R1;           /* PTR TO INPUT PARM LIST        */
         ST    R1,CPPLPTR                                          0159
*           RESPECIFY (R1) UNRESTRICTED;                           0160
*           ECTPTR = CPPLECT;       /* PTR TO ECT                    */
         L     @08,CPPLPTR                                         0161
         L     @15,CPPLECT(,@08)                                   0161
         ST    @15,ECTPTR                                          0161
*           BASECTP = ECTPTR;       /* PTR TO ECT FOR MODEL PL       */
         ST    @15,BASECTP                                         0162
*           BASUPTP = CPPLUPT;      /* PTR TO UPT FOR MODEL PL       */
         MVC   BASUPTP(4),CPPLUPT(@08)                             0163
*           BASECBP = ADDR(REFMECB);/* PTR TO REFORM ECB FOR MODEL   */
         LA    @08,REFMECB                                         0164
         ST    @08,BASECBP                                         0164
*           CURDIRP = ADDR(CURDIRN);/* PTR TO CURRENT DIRECTRY ENTRY */
         LA    @08,CURDIRN                                         0165
         ST    @08,CURDIRP                                         0165
*           IOPLPTR = ADDR(PLOUT);  /* PTR TO SERVICE RTN PARM LIST  */
         LA    @08,PLOUT                                           0166
         ST    @08,IOPLPTR                                         0166
*           PLOUT = BASPTRS;        /* INITIALIZE PARM LIST          */
         MVI   PLOUT+20,C' '                                       0167
         MVC   PLOUT+21(3),PLOUT+20                                0167
         MVC   PLOUT(20),BASPTRS                                   0167
*           PTPBPTR = ADDR(PTPBK);  /* PTR TO PUTLINE PB             */
         LA    @08,PTPBK                                           0168
         ST    @08,PTPBPTR                                         0168
*           GEN(MVC   STAEL1(MVCLNG1),MSTAEL1);/* INITIALIZE PLS,PBS */
         MVC   STAEL1(MVCLNG1),MSTAEL1
*           GEN(MVC   NQOPN(MVCLNG2),MNQOPN);  /* INITIALIZE PLS,PBS */
         MVC   NQOPN(MVCLNG2),MNQOPN
*           GEN(MVC   RDIDCB(DIRDLG),MRDIDCB); /* INITIALIZE BSAM    */
         MVC   RDIDCB(DIRDLG),MRDIDCB
*           DCBNPTR = ADDR(RINDCB); /* INPUT DCB PTR                 */
         LA    @08,RINDCB                                          0172
         ST    @08,DCBNPTR                                         0172
*           DCBXPTR = ADDR(REXDCB); /* OUTPUT DCB PTR                */
         LA    @08,REXDCB                                          0173
         ST    @08,DCBXPTR                                         0173
*           DCBDPTR = ADDR(RDIDCB); /* OUTPUT DCB PTR                */
         LA    @08,RDIDCB                                          0174
         ST    @08,DCBDPTR                                         0174
*           RDJNXL = ADDR(RDJINA)+MSK07W;  /* FORM INPUT EXIT LIST   */
         L     @08,MSK07W                                          0175
         LA    @15,RDJINA                                          0175
         ALR   @15,@08                                             0175
         ST    @15,RDJNXL                                          0175
*           RDJXXL = ADDR(RDJEXA)+MSK07W;  /* FORM OUTPUT EXIT LIST  */
         LA    @15,RDJEXA                                          0176
         ALR   @15,@08                                             0176
         ST    @15,RDJXXL                                          0176
*           MAXLINP=ADDR(IDSLINS(10))+LENGTH(IDSLINS);     /* END    */
         LA    @08,IDSLINS+972                                     0177
         AH    @08,@CH00551                                        0177
         ST    @08,MAXLINP                                         0177
*           LINPTR = MAXLINP;       /* SET INITIALIZATION FLAG       */
         ST    @08,LINPTR                                          0178
*           IDSCT = 0;              /* NO USERIDS REFORMATTED YET    */
*                                                                  0179
         SLR   @08,@08                                             0179
         STH   @08,IDSCT                                           0179
*           RESPECIFY (R14) RESTRICTED;                            0180
*           R14 = SAVLNKA;          /* RESTORE LINK REGISTER         */
         L     R14,SAVLNKA                                         0181
*           RETURN;                 /* RETURN                        */
@EL00002 DS    0H                                                  0182
@EF00002 DS    0H                                                  0182
@ER00002 BR    @14                                                 0182
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -- RSTAE                                            */
*/*                                                                  */
*/* DESCRIPTIVE NAME -- N/A                                          */
*/*                                                                  */
*/* FUNCTION -- ESTABLISH STAE EXIT ENVIRONMENT                      */
*/*                                                                  */
*/*   OPERATION --                                                   */
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP RSTAE FUNCTION   */
*/*   -  BUILD STAE EXIT COMUNICATIONS PARAMETER LIST (STAEPL1) WITH */
*/*      -  1ST CODE BASE POINTER (STAPRM1)                          */
*/*      -  2ND CODE BASE POINTER (STAPRM2)                          */
*/*      -  1ST REENTRANT DATA POINTER (STAPRM3)                     */
*/*      -  2ND REENTRANT DATA POINTER (STAPRM4)                     */
*/*   -  INITIALIZE STAE PARAMETER LIST (STAEL1)                     */
*/*   -  EXECUTE STAE MACRO                                          */
*/*   -  IF STAE RETURN CODE IS 0 (SUCCESSFUL STAE), SET STAE-IN-    */
*/*      FORCE FLAG (STASET), RESTORE ENTRY REGISTER 14 AND RETURN   */
*/*   -  IF STAE RETURN CODE IS 4 (INSUFFICIENT STORAGE SPACE) SET   */
*/*      ERROR MESSAGE INDEX 1, ISSUE ERROR MESSAGE, SET TERMINA-    */
*/*      TION FLAG (RFMQUIT) AND RETURN                              */
*/*   -  IF ANY OTHER RETURN CODE, ISSUE UTILITY ERROR MESSAGE 9,    */
*/*      SET TERMINATION FLAG AND RETURN                             */
*/*                                                                  */
*/* ENTRY -- N/A, INLINE SEGMENT (PSEUDO, LINKED BY REGISTER 14)     */
*/*                                                                  */
*/* INPUT --                                                         */
*/*   -  UADSREFM ENVIRONMENT                                        */
*/*                                                                  */
*/* OUTPUT --                                                        */
*/*   -  STAE ACTIVE FLAG SET (STASET)                               */
*/*                                                                  */
*/* EXTERNAL REFERENCES -- STAE MACRO                                */
*/*                                                                  */
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */
*/*   CONDITIONS --                                                  */
*/*   -  SUCCESSFUL STAE                                             */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* EXIT-ERROR -- N/A (RETURN BY ENTRY LINK REGISTER 14)             */
*/*   CONDITIONS --                                                  */
*/*   -  UNSUCCESSFUL STAE (REFMQUIT FLAG SET)                       */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */
*/*                                                                  */
*/********************************************************************/
*RSTAE:     /* ESTABLISH STAE ENVIRONMENT                            */
*           ENTRY;                                                 0183
RSTAE    DS    0H                                                  0184
*           SAVLNKA = R14;          /* SAVE LINK REGISTER            */
         ST    R14,SAVLNKA                                         0184
*           RESPECIFY (R14) UNRESTRICTED;                          0185
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */
*             THEN                  /* NO,                           */
         TM    QUITCHK,B'11100000'                                 0186
         BNZ   @RF00186                                            0186
*               DO;                                                0187
*                                                                  0187
*           RESPECIFY (R9,R10,R11,R12,R15) RESTRICTED;             0188
*           /* RESERVE CURRENT BASE POINTERS                         */
*           STAPRM1 = R9;           /* SAVE IKJREF CODE BASE PTR     */
         ST    R9,STAPRM1                                          0189
*           STAPRM2 = R10;          /*   AND 2ND CODE BASE PTR       */
         ST    R10,STAPRM2                                         0190
*           STAPRM3 = R11;          /*   AND RENT DATA PTR           */
         ST    R11,STAPRM3                                         0191
*           STAPRM4 = R12;          /*   AND 2ND RENT DATA PTR       */
         ST    R12,STAPRM4                                         0192
*           RESPECIFY (R9,R10,R11,R12) UNRESTRICTED;               0193
*                                                                  0193
*           /* SET UP AND CREATE STAE CALL                           */
*           GENERATE;                                              0194
*                                                                  0194
         MVC   STAEL1(STALNG),MSTAEL1 INITIALIZE STAE PARM LIST
         STAE  PARAM=STAEPL1,MF=(E,STAEL1)  SET ABEND EXIT
*           RESPECIFY (R14) RESTRICTED;                            0195
*           RTNCODE = R15;          /* RESERVE RETURN CODE           */
         ST    R15,RTNCODE                                         0196
*           RESPECIFY (R14) UNRESTRICTED;                          0197
*           IF RTNCODE ^= 0         /* CHK IF STAE SUCCESSFUL        */
*             THEN                  /* NO,                           */
         L     @14,RTNCODE                                         0198
         LTR   @14,@14                                             0198
         BZ    @RF00198                                            0198
*               DO;                                                0199
*                 IF RTNCODE = 4    /* CHK FOR LACK OF SPACE         */
*                   THEN            /* YES,                          */
         CH    @14,@CH00102                                        0200
         BNE   @RF00200                                            0200
*                     DO;                                          0201
*                       MSGNO = 1;  /* SET NOSPACE MESSAGE INDEX     */
         MVC   MSGNO(2),@CH00032                                   0202
*                       CALL  MSGFNDR;  /* LOCATE TEXT               */
         BAL   @14,MSGFNDR                                         0203
*                       CALL  FXPUTL; /* INITIALIZE  P B             */
         BAL   @14,FXPUTL                                          0204
*                       CALL  DOPUTL; /* TO ISSUE PUTLINE            */
         BAL   @14,DOPUTL                                          0205
*                     END;                                         0206
*                   ELSE            /* NO, NOT LACK OF SPACE         */
*                     DO;                                          0207
         B     @RC00200                                            0207
@RF00200 DS    0H                                                  0208
*                       MSGNO = 9;  /* SET MESSAGE INDEX             */
         MVC   MSGNO(2),@CH00033                                   0208
*                       SOFFS = 20;   /* SET INSERT OFFSET           */
         MVC   SOFFS(2),@CH00351                                   0209
*                       CALL  SYSERRD;  /* ISSUE MESSAGE             */
         BAL   @14,SYSERRD                                         0210
*                     END;                                         0211
*                 RFMQUIT = '1'B;   /* SET TERMINATE FLAG            */
@RC00200 OI    RFMQUIT,B'01000000'                                 0212
*               END;                                               0213
*             ELSE                                                 0214
*               STASET = '1'B;      /* SET STAE ACTIVE FLAG          */
*                                                                  0214
         B     @RC00198                                            0214
@RF00198 OI    STASET,B'00100000'                                  0214
*               END;                                               0215
@RC00198 DS    0H                                                  0216
*           RESPECIFY (R14) RESTRICTED;                            0216
@RF00186 DS    0H                                                  0217
*           R14 = SAVLNKA;          /* RESTORE LINK REGISTER         */
         L     R14,SAVLNKA                                         0217
*           RETURN;                 /* RETURN                        */
         B     @EL00002                                            0218
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -- RJFCB                                            */
*/*                                                                  */
*/* DESCRIPTIVE NAME -- N/A                                          */
*/*                                                                  */
*/* FUNCTION -- RDJFCB TO OBTAIN DATA SET DEFINITIONS                */
*/*   OPERATION --                                                   */
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP RJFCB FUNCTION   */
*/*   -  SET INPUT DCB POINTER (DCBNPTR) AND OUTPUT DCB POINTER      */
*/*      (DCBXPTR) IN RDJFCB PARAMETER LIST (RDJLSTA)                */
*/*   -  SET POINTER (RDJNPTR) TO JFCB AREA (RDJINA) FOR INPUT       */
*/*   -  SET POINTER (RDJXPTR) TO JFCB AREA (RDJEXA) FOR OUTPUT      */
*/*   -  SET POINTERS IN DCBS (DCBEXLST) TO JFCB AREAS               */
*/*   -  EXECUTE RDJFCB MACRO                                        */
*/*   -  IF THE INPUT UADS (SYSUADN) HAS NOT BEEN ALLOCATED (NAME=   */
*/*      NULLFILE) ISSUE ERROR MESSAGE 10, SET TERMINATION FLAG      */
*/*      (REFMQUIT), RESTORE ENTRY LINK REGISTER 14 AND RETURN.  IF  */
*/*      SYSUADS HAS NOT BEEN ALLOCATED, ISSUE ERROR MESSAGE 11      */
*/*   -  SET THE EQUIVALENCE FLAG (EQUIUAD) TO NON-IDENTICAL STATE   */
*/*   -  COMPARE INPUT AND OUTPUT DATA SET ATTRIBUTES -- DSNAMES,    */
*/*      NUMBER OF VOLUMES, VOLUME NAMES, RECORD FORMAT, BLOCK SIZE  */
*/*   -  IF ALL ATTRIBUTES ARE IDENTICAL, SET EQUIVALENCE FLAG TO    */
*/*      IDENTICAL STATE (1) AND SET DDNAME IN READ DIRECTORY DCB    */
*/*      (RDIDCB) TO MATCH THAT IN OUTPUT DCB (REXDCB)               */
*/*   -  (RESTORE ENTRY LINK REGISTER 14 AND RETURN)                 */
*/*                                                                  */
*/* ENTRY -- N/A, INLINE SEGMENT (PSEUDO, LINKED BY REGISTER 14)     */
*/*                                                                  */
*/* INPUT --                                                         */
*/*   -  UADSREFM ENVIRONMENT                                        */
*/*                                                                  */
*/* OUTPUT --                                                        */
*/*   -  JFCB IMAGES FOR SYSUADS AND SYSUADN                         */
*/*   -  EQUIVALENCE FLAG (EQUIUAD) SET ON/OFF                       */
*/*   -  DATA SET NAME FOR READ DIRECTORY DCB (RDIDCB) ESTABLISHED   */
*/*                                                                  */
*/* EXTERNAL REFERENCES -- RDJFCB MACRO                              */
*/*                                                                  */
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */
*/*   CONDITIONS --                                                  */
*/*   -  SUCCESSFUL READ JFCB                                        */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* EXIT-ERROR -- N/A (RETURN BY ENTRY LINK REGISTER 14)             */
*/*   CONDITIONS --                                                  */
*/*   -  READ JFCB FAILURE (RFMQUIT FLAG SET)                        */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */
*/*                                                                  */
*/********************************************************************/
*RJFCB:     /* OBTAIN DATA SET DEFINITIONS                           */
*           ENTRY;                                                 0219
RJFCB    DS    0H                                                  0220
*           SAVLNKA = R14;          /* SAVE LINK REGISTER            */
         ST    R14,SAVLNKA                                         0220
*           RESPECIFY (R14) UNRESTRICTED;                          0221
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */
*             THEN                  /* NO,                           */
         TM    QUITCHK,B'11100000'                                 0222
         BNZ   @RF00222                                            0222
*               DO;                                                0223
*                                                                  0223
*           RDJA1NM = DCBNPTR;      /* RINDCB PTR IN RDJFCB PL       */
         MVC   RDJA1NM(3),DCBNPTR+1                                0224
*           RDJA2NM = DCBXPTR;      /* REXDCB PTR IN RDJFCB PL       */
         L     @14,DCBXPTR                                         0225
         ST    @14,@TF00001                                        0225
         MVC   RDJA2NM(3),@TF00001+1                               0225
*           RDJNPTR = ADDR(RDJINA); /* INPUT JFCB PTR                */
         LA    @08,RDJINA                                          0226
         ST    @08,RDJNPTR                                         0226
*           RDJXPTR = ADDR(RDJEXA); /* OUTPUT JFCB PTR               */
         LA    @07,RDJEXA                                          0227
         ST    @07,RDJXPTR                                         0227
*           DCBEXLST = RDJNPTR-4;   /* PTR TO IN-JFCB AREA           */
         LA    @06,4                                               0228
         SLR   @08,@06                                             0228
         L     @01,DCBPTR                                          0228
         ST    @08,DCBEXLST(,@01)                                  0228
*           DCBXPTR->DCBEXLST=RDJXPTR-4;   /* OUT-JFCB AREA          */
         SLR   @07,@06                                             0229
         ST    @07,DCBEXLST(,@14)                                  0229
*           GEN(RDJFCB  MF=(E,RDJLST));    /* DO RDJFCBS             */
         RDJFCB  MF=(E,RDJLST)
*             IF JFCBDSNM(1:8) = 'NULLFILE'/* INPUT JFCB READ ?      */
*                 × RDJXPTR->JFCBDSNM(1:8)='NULLFILE'/* OUTPUT ?     */
*               THEN                /* NO,                           */
         L     @14,JFCBPTR                                         0231
         CLC   JFCBDSNM(8,@14),@CC01862                            0231
         BE    @RT00231                                            0231
         L     @14,RDJXPTR                                         0231
         CLC   JFCBDSNM(8,@14),@CC01862                            0231
         BNE   @RF00231                                            0231
@RT00231 DS    0H                                                  0232
*                 DO;                                              0232
*                   IF JFCBDSNM(1:8)='NULLFILE'/* CHK SYSUADN        */
*                     THEN          /* NO,                           */
         L     @14,JFCBPTR                                         0233
         CLC   JFCBDSNM(8,@14),@CC01862                            0233
         BNE   @RF00233                                            0233
*                       DO;                                        0234
*                         MSGNO = 10;   /* SET MESSAGE INDEX         */
         MVC   MSGNO(2),@CH00034                                   0235
*                         CALL  MSGFNDR;  /* LOCATE MESSAGE TEXT     */
         BAL   @14,MSGFNDR                                         0236
*                         CALL  FXPUTLM;  /* INITIALIZE PARM BLOCK   */
         BAL   @14,FXPUTLM                                         0237
*                         CALL  DOPUTL;   /* ISSUE MESSAGE           */
         BAL   @14,DOPUTL                                          0238
*                       END;                                       0239
*                   IF RDJXPTR->JFCBDSNM(1:8)='NULLFILE'/* SYSUADS   */
*                     THEN          /* NO,                           */
@RF00233 L     @14,RDJXPTR                                         0240
         CLC   JFCBDSNM(8,@14),@CC01862                            0240
         BNE   @RF00240                                            0240
*                       DO;                                        0241
*                         MSGNO = 11;   /* SET MESSAGE INDEX         */
         MVC   MSGNO(2),@CH00035                                   0242
*                         CALL  MSGFNDR;  /* LOCATE MESSAGE TEXT     */
         BAL   @14,MSGFNDR                                         0243
*                         CALL  FXPUTLM;  /* INITIALIZE PARM BLOCK   */
         BAL   @14,FXPUTLM                                         0244
*                         CALL  DOPUTL;   /* ISSUE MESSAGE           */
         BAL   @14,DOPUTL                                          0245
*                       END;                                       0246
*                   RFMQUIT = '1'B; /* SET TERMINATE FLAG            */
@RF00240 OI    RFMQUIT,B'01000000'                                 0247
*                 END;                                             0248
*               ELSE                /* JFCBS BOTH PRESENT            */
*                 DO;                                              0249
         B     @RC00231                                            0249
@RF00231 DS    0H                                                  0250
*                   EQUIUAD = '0'B; /* SET NOT SAME FLAG             */
         NI    EQUIUAD,B'10111111'                                 0250
*                   /* COMPARE CHARACTERISTICS OF DCBS               */
*                   IF JFCBDSNM=RDJXPTR->JFCBDSNM     /* DSNAMES     */
*                       & JFCBVOLS=RDJXPTR->JFCBVOLS  /* VNAMES      */
*                     THEN          /* PERFECT COMPARE,              */
         L     @14,JFCBPTR                                         0251
         L     @08,RDJXPTR                                         0251
         CLC   JFCBDSNM(44,@14),JFCBDSNM(@08)                      0251
         BNE   @RF00251                                            0251
         CLC   JFCBVOLS(30,@14),JFCBVOLS(@08)                      0251
         BNE   @RF00251                                            0251
*                       EQUIUAD='1'B; /* SET EQUIVALENCE FLAG        */
         OI    EQUIUAD,B'01000000'                                 0252
*                 END;                                             0253
*                                                                  0253
@RF00251 DS    0H                                                  0254
*               END;                                               0254
@RC00231 DS    0H                                                  0255
*           RESPECIFY (R14) RESTRICTED;                            0255
@RF00222 DS    0H                                                  0256
*           R14 = SAVLNKA;          /* RESTORE LINK REGISTER         */
         L     R14,SAVLNKA                                         0256
*           RETURN;                 /* RETURN                        */
         B     @EL00002                                            0257
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -- ROPEN                                            */
*/*                                                                  */
*/* DESCRIPTIVE NAME -- N/A                                          */
*/*                                                                  */
*/* FUNCTION -- OPEN DCBS FOR READ, WRITE AND READ DIRECTORY         */
*/*   OPERATION --                                                   */
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP ROPEN FUNCTION   */
*/*   -  SET ERROR MESSAGE 3 INDEX                                   */
*/*   -  SET DCB POINTER (PPPPTR) TO DCB (RINDCB)                    */
*/*   -  IF DATA SETS ARE IDENTICAL,  SET  REGISTER 1  TO POINT TO   */
*/*      UPDAT-MODE PL (RUOPNL), EXECUTE OPEN MACRO (VIA SEGMENT     */
*/*      OPENDCB),                                                   */
*/*   -  IF DATA SETS ARE NOT IDENTICAL, SET  REGISTER 1 TO POINT    */
*/*      TO OUTPUT MODE PL (RXOPNL), EXECUTE OPEN MACRO              */
*/*   -  SET DCB POINTER (PPPPTR) TO DCB (REXDCB)                    */
*/*   -  SET ERROR MESSAGE 4 INDEX                                   */
*/*   -  SET REGISTER 1 TO  POINT TO OUTPUT-MODE PL (RXOPNL),        */
*/*      EXECUTE OPEN MACRO                                          */
*/*   -  SET DCB POINTER (PPPPTR) TO DIRECTORY DCB (RDIDCB),  SET    */
*/*      ERROR MESSAGE 3 AND EXECUTE OPEN                            */
*/*   -  CHECK (VIA SEGMENT DCBCHK) FOR BLOCKSIZE                    */
*/*   -  (RESTORE ENTRY LINK REGISTER 14 AND RETURN)                 */
*/*                                                                  */
*/* ENTRY -- N/A, INLINE SEGMENT (LINKED BY REGISTER 14)             */
*/*                                                                  */
*/* INPUT --                                                         */
*/*   -  UADSREFM ENVIRONMENT                                        */
*/*                                                                  */
*/* OUTPUT -- N/A                                                    */
*/*                                                                  */
*/* EXTERNAL REFERENCES -- N/A                                       */
*/*                                                                  */
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */
*/*   CONDITIONS --                                                  */
*/*   -  SUCCESSFUL OPENS                                            */
*/*   -  BLOCK SIZE ADEQUATE                                         */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* EXIT-ERROR -- N/A (RETURN BY ENTRY LINK REGISTER 14)             */
*/*   CONDITIONS -- N/A                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */
*/*                                                                  */
*/********************************************************************/
*ROPEN:     /* OPEN DCBS FOR READ, WRITE AND READ DIRECTORY          */
*           ENTRY;                                                 0258
ROPEN    DS    0H                                                  0259
*           RESPECIFY (PPPPTR) RESTRICTED;  /* RESERVE POINTER       */
*           SAVLNKA = R14;          /* SAVE LINK REGISTER            */
         ST    R14,SAVLNKA                                         0260
*           RESPECIFY (R14) UNRESTRICTED;                          0261
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */
*             THEN                  /* NO,                           */
         TM    QUITCHK,B'11100000'                                 0262
         BNZ   @RF00262                                            0262
*               DO;                                                0263
*                                                                  0263
*           MSGNO = 3;              /* SET MESSAGE INDEX             */
         LA    @14,3                                               0264
         STH   @14,MSGNO                                           0264
*           MSGN2 = 3;              /* SET RESERVE MESSAGE INDEX     */
         STH   @14,MSGN2                                           0265
*           MSGN3 = 30;             /* SET RESERVE MESSAGE INDEX     */
         MVC   MSGN3(2),@CH01172                                   0266
*           PPPPTR = ADDR(RINDCB);  /* SET DCB PTR FOR OPEN          */
         LA    PPPPTR,RINDCB                                       0267
*           IF EQUIUAD = '1'B       /* CHK IF DCBS SAME              */
*             THEN                  /* YES,                          */
         TM    EQUIUAD,B'01000000'                                 0268
         BNO   @RF00268                                            0268
*               DO;                                                0269
*                 RESPECIFY (R1) RESTRICTED;                       0270
*                 R1 = ADDR(RUOPNL);  /* SET PTR TO OPEN PL          */
         LA    R1,RUOPNL                                           0271
*                 CALL  OPENDCB;    /* TO OPEN SYSUADS FOR UPDAT     */
         BAL   @14,OPENDCB                                         0272
*               END;                                               0273
*             ELSE                  /* DCBS NOT IDENTICAL            */
*               DO;                                                0274
         B     @RC00268                                            0274
@RF00268 DS    0H                                                  0275
*                 R1 = ADDR(RNOPNL);  /* SET PTR TO OPEN PL          */
         LA    R1,RNOPNL                                           0275
*                 RESPECIFY (R1) UNRESTRICTED;                     0276
*                 CALL  OPENDCB;    /* OPEN SYSUADN FOR INPUT/OUTPUT */
         BAL   @14,OPENDCB                                         0277
*               END;                                               0278
*           PPPPTR = ADDR(REXDCB);  /* DCB PTR FOR OPEN              */
@RC00268 LA    PPPPTR,REXDCB                                       0279
*           MSGNO = 4;              /* SET MESSAGE INDEX             */
         LA    @14,4                                               0280
         STH   @14,MSGNO                                           0280
*           MSGN2 = 4;              /* SET RESERVE MESSAGE INDEX     */
         STH   @14,MSGN2                                           0281
*           MSGN3 = 29;             /* SET RESERVE MESSAGE INDEX     */
         MVC   MSGN3(2),@CH01868                                   0282
*           RESPECIFY (R1) RESTRICTED;                             0283
*           R1 = ADDR(RXOPNL);      /* SET PTR TO OPEN PL            */
         LA    R1,RXOPNL                                           0284
*           CALL  OPENDCB;          /* TO OPEN SYSUADS FOR OUTPUT    */
         BAL   @14,OPENDCB                                         0285
*           MSGNO = 3;              /* SET MESSAGE INDEX             */
         LA    @14,3                                               0286
         STH   @14,MSGNO                                           0286
*           MSGN2 = 3;              /* SET RESERVE MESSAGE INDEX     */
         STH   @14,MSGN2                                           0287
*           MSGN3 = 30;             /* SET RESERVE MESSAGE INDEX     */
         MVC   MSGN3(2),@CH01172                                   0288
*           PPPPTR = ADDR(RDIDCB);  /* DCB PTR FOR OPEN              */
         LA    PPPPTR,RDIDCB                                       0289
*           R1 = ADDR(RDOPNL);      /* SET PTR TO OPEN PL            */
         LA    R1,RDOPNL                                           0290
*           RESPECIFY (R1) UNRESTRICTED;                           0291
*           CALL  OPENDCB;          /* TO OPEN SYSUADN FOR BSAM      */
*                                                                  0292
         BAL   @14,OPENDCB                                         0292
*           CALL DCBCHK;            /* CHECK BLOCK SIZES             */
*                                                                  0293
         BAL   @14,DCBCHK                                          0293
*               END;                                               0294
*           RESPECIFY (R14) RESTRICTED;                            0295
@RF00262 DS    0H                                                  0296
*           R14 = SAVLNKA;          /* RESTORE LINK REGISTER         */
         L     R14,SAVLNKA                                         0296
*           RESPECIFY  (PPPPTR) UNRESTRICTED;  /* FREE POINTER       */
*           RETURN;                 /* RETURN                        */
         B     @EL00002                                            0298
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -- RENQU                                            */
*/*                                                                  */
*/* DESCRIPTIVE NAME -- N/A                                          */
*/*                                                                  */
*/* FUNCTION -- ENQUEUE (SHARED) ON SYSIKJUA/OPENUADS                */
*/*   OPERATION --                                                   */
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP RENQU FUNCTION   */
*/*   -  SET SET DO CONTROL (DOWHYLN) TO LOOP UNTIL ENQ SUCCEEDS     */
*/*   -  SET REGISTER 1 TO POINT TO ENQ PL (NQOPN), EXECUTE ENQ      */
*/*      MACRO                                                       */
*/*   -  IF ENQ NOT SUCCESSFUL (REGISTER 15 NOT = 0), CHECK RC LIST  */
*/*   -  IF LIST RC IS 0 OR 8, RESTORE ENTRY REGISTER 14 AND RETURN  */
*/*   -  IF LIST RC IS 4, SET DOWHYLN TO GONTINUE ENQ DOWHILE LOOP   */
*/*   -  IF ANY OTHER CODE, ISSUE ERROR MESSAGE 13, SET UADSREFM     */
*/*      TERMINATION FLAG (RFMQUIT), RESTORE REGISTER 14 AND RETURN  */
*/*                                                                  */
*/* ENTRY -- N/A, INLINE SEGMENT (PSEUDO, LINKED BY REGISTER 14)     */
*/*                                                                  */
*/* INPUT -- UADSREFM ENVIRONMENT                                    */
*/*                                                                  */
*/* OUTPUT -- N/A                                                    */
*/*                                                                  */
*/* EXTERNAL REFERENCES -- ENQ MACRO                                 */
*/*                                                                  */
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */
*/*   CONDITIONS --                                                  */
*/*   -  SUCCESSFUL ENQ                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* EXIT-ERROR -- N/A (RETURN BY ENTRY LINK REGISTER 14)             */
*/*   CONDITIONS --                                                  */
*/*   -  ENQ FAILURE                                                 */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */
*/*                                                                  */
*/********************************************************************/
*RENQU:     /* ENQUEUE ON UADS                                       */
*           /* DEQUEUE AT RDEQU                                      */
*           ENTRY;                                                 0299
RENQU    DS    0H                                                  0300
*           SAVLNKA = R14;          /* SAVE LINK REGISTER            */
         ST    R14,SAVLNKA                                         0300
*           RESPECIFY (R14) UNRESTRICTED;                          0301
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */
*             THEN                  /* NO,                           */
         TM    QUITCHK,B'11100000'                                 0302
         BNZ   @RF00302                                            0302
*               DO;                                                0303
*                                                                  0303
*           RESPECIFY (R1,R15) RESTRICTED;                         0304
*           DO DOWHYLN = 1 TO 1;         /* UNTIL ENQUEUED SHARED    */
         LA    @14,1                                               0305
         STH   @14,DOWHYLN                                         0305
@DL00305 DS    0H                                                  0306
*             R1 = ADDR(NQOPN);     /* PTR TO ENQ PARM LIST          */
         LA    R1,NQOPN                                            0306
*             GEN(ENQ   ,MF=(E,(1)));  /* ISSUE ENQUEUE              */
         ENQ   ,MF=(E,(1))
*             RTNCODE = R15;        /* RESERVE RETURN CODE           */
         ST    R15,RTNCODE                                         0308
*             IF RTNCODE ^= 0       /* CHK FOR SATISFACTORY RET CODE */
*               THEN                /* NO,                           */
         L     @14,RTNCODE                                         0309
         SLR   @08,@08                                             0309
         CR    @14,@08                                             0309
         BE    @RF00309                                            0309
*                 DO;                                              0310
*                   RCPTR = RTNCODE;  /* LOCATE RETURN CODE          */
         ST    @14,RCPTR                                           0311
*                   IF RCLC1^=0     /* CHK FOR UNSATISFACTORY        */
*                       & RCLC1^=8  /*     RETURN CODE               */
*                     THEN          /* YES,                          */
         CLI   RCLC1(@14),0                                        0312
         BE    @RF00312                                            0312
         CLI   RCLC1(@14),8                                        0312
         BE    @RF00312                                            0312
*                       IF RCLC1 = 4   /* CHK NOT AVAILABLE          */
*                         THEN      /* YES,                          */
         CLI   RCLC1(@14),4                                        0313
         BNE   @RF00313                                            0313
*                           DOWHYLN = 0;  /* SET TO REPEAT           */
         STH   @08,DOWHYLN                                         0314
*                         ELSE      /* UNKNOWN RETURN CODE           */
*                           DO;                                    0315
         B     @RC00313                                            0315
@RF00313 DS    0H                                                  0316
*                             MSGNO = 13;     /* SET MESSAGE INDEX   */
         MVC   MSGNO(2),@CH01676                                   0316
*                             SOFFS = 20;     /* SET INSERT OFFSET   */
         MVC   SOFFS(2),@CH00351                                   0317
*                             CALL  SYSERRD;  /* ISSUE ERROR MSG     */
         BAL   @14,SYSERRD                                         0318
*                             RFMQUIT = '1'B; /* SET TERMINATION FLG */
         OI    RFMQUIT,B'01000000'                                 0319
*                           END;                                   0320
*                 END;                                             0321
@RC00313 DS    0H                                                  0321
@RF00312 DS    0H                                                  0322
*           END;                                                   0322
@RF00309 LA    @14,1                                               0322
         AH    @14,DOWHYLN                                         0322
         STH   @14,DOWHYLN                                         0322
         CH    @14,@CH00032                                        0322
         BNH   @DL00305                                            0322
*           RESPECIFY (R1,R15) UNRESTRICTED;                       0323
*                                                                  0323
*               END;                                               0324
*           RESPECIFY (R14) RESTRICTED;                            0325
@RF00302 DS    0H                                                  0326
*           R14 = SAVLNKA;          /* RESTORE LINK REGISTER         */
         L     R14,SAVLNKA                                         0326
*           RETURN;                 /* RETURN                        */
         B     @EL00002                                            0327
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -- RREAD                                            */
*/*                                                                  */
*/* DESCRIPTIVE NAME -- N/A                                          */
*/*                                                                  */
*/* FUNCTION -- LOCATE USERID IN UADS DIRECTORY AND READ MEMBER      */
*/*   OPERATION --                                                   */
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP RREAD FUNCTION   */
*/*   -  IF PRIME READ HAS NOT BEEN PROCESSED, PERFORM SEGMENT       */
*/*      RDINIT TO OBTAIN 1ST USERID MEMBER                          */
*/*   -  IF TERMINATION FLAG IN REFMECB IS ON, SET FLAG (RFMQUIT)    */
*/*      ELSE, IF 1ST USERID MEMBER HAS BEEN READ AND PROCESSED,     */
*/*      PERFORM SEGMENT DOWRT2 TO FREE THE READ BUFFER AREA         */
*/*   -  IF TERMINATION FLAG (QUITCHK) IS OFF, PERFORM SEGMENT RDNAM */
*/*      TO EXTRACT CURRENT USERID NAME AND NAME LENGTH.  IF 1ST     */
*/*      READ IS NOT NOW BEING PROCESSED AND STOW WAS PERFORMED FOR  */
*/*      THE IMMEDIATELY PRIOR MEMBER, PERFORM SEGMENTS RDDIR AND    */
*/*      RDLOCN TO OBTAIN THE DIRECTORY INFORMATION FOR THE CURRENT  */
*/*      USERID, RESET STOW-PERFORMED FLAG (STODON), AND SET POINTER */
*/*      (RWPNBP) TO CURRENT USERID NAME.  PERFORM SEGMENT DOREAD TO */
*/*      TO OBTAIN CURRENT USERID MEMBER, AND SAVE THE NEXT USERID   */
*/*      NAME (COMPNAM)                                              */
*/*   -  CLEAR THE 1ST USERID-IN-PROCESS FLAG (RD1NOW)               */
*/*   -  (RESTORE ENTRY LINK REGISTER 14 AND RETURN)                 */
*/*                                                                  */
*/* ENTRY -- N/A, INLINE SEGMENT (PSEUDO, LINKED BY REGISTER 14)     */
*/*                                                                  */
*/* INPUT --                                                         */
*/*   -  UADSREFM ENVIRONMENT                                        */
*/*                                                                  */
*/* OUTPUT --                                                        */
*/*   -  FIRST-MEMBER-PROCESSED FLAG SET (RDINTL)                    */
*/*   -  STOW-PERFORMED FLAG RESET (STODON)                          */
*/*   -  CURRENTLY-PROCESSING-1ST-USERID FLAG RESET (RD1NOW)         */
*/*   -  NEXT USERID NAME SAVED (COMPNAM)                            */
*/*                                                                  */
*/* EXTERNAL REFERENCES -- N/A                                       */
*/*                                                                  */
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */
*/*   CONDITIONS --                                                  */
*/*   -  NO READ PROCESSING FAILURE                                  */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* EXIT-ERROR -- N/A (RETURN BY ENTRY LINK REGISTER 14)             */
*/*   CONDITIONS --                                                  */
*/*   -  FORCED TERMINATION (ECBCPL) (RFMQUIT FLAG SET)              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */
*/*                                                                  */
*/********************************************************************/
*RREAD:     ENTRY;  /* READ UADS MEMBER                              */
RREAD    DS    0H                                                  0329
*           SAVLNKA = R14;          /* SAVE LINK REGISTER            */
         ST    R14,SAVLNKA                                         0329
*           RESPECIFY (R14) UNRESTRICTED;                          0330
*           IF QUITCHK = '000'B     /* CHK FOR TERMINATION FLAG ?    */
*             THEN                  /* NONE,                         */
         TM    QUITCHK,B'11100000'                                 0331
         BNZ   @RF00331                                            0331
*               DO;                                                0332
*           IF RDINTL = '0'B        /* CHK IF PRIME READ PROCESSED   */
*             THEN                  /* NO,                           */
         TM    RDINTL,B'00000010'                                  0333
         BNZ   @RF00333                                            0333
*               CALL  RDINIT;       /* TO PERFORM PRIME READ         */
         BAL   @14,RDINIT                                          0334
*           IF ECBCPL = '1'B        /* CHK ECB COMPLETE FLAG         */
*             THEN                  /* YES,                          */
@RF00333 TM    ECBCPL,B'01000000'                                  0335
         BNO   @RF00335                                            0335
*               RFMQUIT = '1'B;     /* TERMINATE REFORM ACTIVITY     */
         OI    RFMQUIT,B'01000000'                                 0336
*             ELSE                  /* NO, CONTINUE                  */
*               DO;                                                0337
         B     @RC00335                                            0337
@RF00335 DS    0H                                                  0338
*                 IF RDDONE = '1'B  /* CHK FOR BUFFER-READ FLAG      */
*                     & RDINTL = '1'B  /* AND 1ST READ PROCESSED     */
*                   THEN            /* YES,                          */
         TM    RDDONE,B'00000011'                                  0338
         BNO   @RF00338                                            0338
*                     DO;                                          0339
*                       RWPF5 = '0'B;  /* CLEAR WRITE FLAG           */
         NI    RWPF5,B'11110111'                                   0340
*                       CALL  DOWRT2;  /* GO TO FREE BUFFER          */
         BAL   @14,DOWRT2                                          0341
*                       RDDONE = '0'B; /* CLEAR READ DONE FLAG       */
         NI    RDDONE,B'11111110'                                  0342
*                     END;                                         0343
*               END;                                               0344
@RF00338 DS    0H                                                  0345
*           IF QUITCHK = '000'B     /* CHK FOR TERMINATION FLAG ?    */
*             THEN                  /* NONE,                         */
@RC00335 TM    QUITCHK,B'11100000'                                 0345
         BNZ   @RF00345                                            0345
*               DO;                                                0346
*/*               NOTE -- THE FOLLOWING CODE-COMMENTS REPRESENT THE  */
*/*               CODE INSERTION NEEDED IF SPECIFIC NAME(S) ABILITY  */
*/*               PARAMETERS ARE ADDED TO UADSREFM INVOCATION        */
*/*               IF DUCLSF1 = YES  /* CHK FOR ASTERISK FLAG         */
*/*                 THEN            /* YES,                          */
*                     CALL  RDNAM;  /* GET USERID NAME AND LENGTH    */
         BAL   @14,RDNAM                                           0347
*                 IF RD1NOW = '0'B  /* CHK FOR 1ST USERID READ       */
*                   THEN            /* NO, NOT 1ST READ NOW          */
         TM    RD1NOW,B'01000000'                                  0348
         BNZ   @RF00348                                            0348
*                     DO;           /*                               */
*                       START2=2;      /* INITIALIZE FOR SINGLE BSP  */
         MVC   START2(2),@CH00099                                  0350
*                       IF STODON = '1'B /* CHK FOR STOW-DONE        */
*                           & EQUIUAD = '1'B /*  AND IN UPDAT MODE   */
*                         THEN      /* YES, LOCATE NEXT NAME         */
         TM    STODON,B'10000000'                                  0351
         BNO   @RF00351                                            0351
         TM    EQUIUAD,B'01000000'                                 0351
         BNO   @RF00351                                            0351
*                           DO;                                    0352
*                             DO DOWHYL4=1 TO 1;         /* FIND     */
         LA    @08,1                                               0353
         STH   @08,DOWHYL4                                         0353
@DL00353 DS    0H                                                  0354
*                               CALL  RDDIR;  /* GET DIRECTORY BLOCK */
         BAL   @14,RDDIR                                           0354
*                               CALL  RDLOCN; /* CHK FOR NAME        */
         BAL   @14,RDLOCN                                          0355
*                             END;                                 0356
         LA    @08,1                                               0356
         AH    @08,DOWHYL4                                         0356
         STH   @08,DOWHYL4                                         0356
         CH    @08,@CH00032                                        0356
         BNH   @DL00353                                            0356
*                             STODON='0'B; /* RESET REFORM-STOW FLAG */
         NI    STODON,B'01111111'                                  0357
*                             RWPNBP=DIRBDAP; /* PTR TO CURRENT NAME */
         MVC   RWPNBP(4),DIRBDAP                                   0358
*                           END;                                   0359
*                       CALL  DOREAD;  /* READ USERID MEMBER         */
@RF00351 BAL   @14,DOREAD                                          0360
*                       COMPNAM = RDNAMC;  /* RESERVE NEXT NAME      */
         L     @08,RWPNBP                                          0361
         MVC   COMPNAM(8),RDNAMC(@08)                              0361
*                     END;                                         0362
*                 RD1NOW = '0'B;    /* FIRST HAS BEEN READ           */
@RF00348 NI    RD1NOW,B'10111111'                                  0363
*               END;                                               0364
*               END;                                               0365
@RF00345 DS    0H                                                  0366
*           RESPECIFY (R14) RESTRICTED;                            0366
@RF00331 DS    0H                                                  0367
*           R14 = SAVLNKA;          /* RESTORE LINK REGISTER         */
         L     R14,SAVLNKA                                         0367
*           RETURN;                 /* RETURN                        */
         B     @EL00002                                            0368
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -- RGMNEW                                           */
*/*                                                                  */
*/* DESCRIPTIVE NAME -- N/A                                          */
*/*                                                                  */
*/* FUNCTION -- OBTAIN STORAGE SPACE FOR REBUILD/WRITE BUFFER        */
*/*   OPERATION --                                                   */
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP RGMNEW FUNCTION  */
*/*   -  FIND NUMBER (NUMBLKS) OF OUTPUT MEMBER-BLOCKS (INPUT MEMBER */
*/*      LENGTH + NEW HEADER SPACE DIVIDED BY OUTPUT BLOCK LENGTH)   */
*/*   -  IF NUMBLKS IS LESS THAN 10, ADD 1 TO NUMBLKS AND SET EXTRA  */
*/*      BLOCK SPACE FLAG (XTRBLK).  OTHERWISE, SET NUMBLKS TO 10    */
*/*   -  FIND GETMAIN LENGTH (GMAINL) BY MULTIPLYING THE NUMBER OF   */
*/*      BLOCK SPACES BY OUTPUT BLOCK LENGTH                         */
*/*   -  SET POINTERS -- TO GETMAIN LENGTH (GMAINL) IN REGISTER 5,   */
*/*      TO LOCATION OF RESPONSE AREA (GMAINP) IN REGISTER 6, TO     */
*/*      POINTER TO GETMAIN PL (GMLST) IN REGISTER 1                 */
*/*   -  EXECUTE GETMAIN MACRO                                       */
*/*   -  IF GETMAIN RC WAS UNSUCCESSFUL, CHECK FLAG (XTRBLK).  IF    */
*/*      EXTRA BLOCK WAS REQUESTED, RESET XTRBLK, REDUCE BLOCK COUNT */
*/*      BY 1 (NUMBLKS) AND SET DOWHILE CONTROL FLAG (DOWHYLN) TO    */
*/*      REPEAT GETMAIN REQUEST.  IF NO EXTRA BLOCK REQUEST, PERFORM */
*/*      SEGMENT NOUSP TO ISSUE NO SPACE MESSAGE (SETS UIDQUIT FLAG) */
*/*   -  IF GETMAIN SUCCEEDED, SET OUTPUT BUFFER POINTER (REXBUFP)   */
*/*      TO GETMAIN LOCATION (GMAINP), AND SET CONTROLS FOR, AND     */
*/*      PERFORM SEGMENT DOPSPAZ TO CLEAR THE GETMAIN AREA           */
*/*   -  (RESTORE ENTRY LINK REGISTER 14 AND RETURN)                 */
*/*                                                                  */
*/* ENTRY -- N/A, INLINE SEGMENT (PSEUDO, LINKED BY REGISTER 14)     */
*/*                                                                  */
*/* INPUT --                                                         */
*/*   -  UADSREFM ENVIRONMENT                                        */
*/*   -  LENGTH OF INPUT MEMBER READ-IN (OLRDBUFL)                   */
*/*                                                                  */
*/* OUTPUT --                                                        */
*/*   -  CLEARED BUFFER AREA LOCATED BY POINTER (REXBUFP)            */
*/*   -  LENGTH OF BUFFER (GMAINL)                                   */
*/*   -  EXTRA-BLOCK-SPACE FLAG (XTRBLK) SET ON/OFF                  */
*/*   -  NUMBER OF OUTPUT BLOCKS (NUMBLKS)                           */
*/*                                                                  */
*/* EXTERNAL REFERENCES -- GETMAIN MACRO                             */
*/*                                                                  */
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */
*/*   CONDITIONS --                                                  */
*/*   -  SUCCESSFUL GETMAIN                                          */
*/*                                                                  */
*/* EXIT-ERROR -- N/A (RETURN BY ENTRY LINK REGISTER 14)             */
*/*   CONDITIONS -- N/A                                              */
*/*                                                                  */
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */
*/*                                                                  */
*/********************************************************************/
*RGMNEW:    ENTRY;                  /* GET SPACE FOR WRITE BUFFER    */
RGMNEW   DS    0H                                                  0370
*           SAVLNKA = R14;          /* SAVE LINK REGISTER            */
         ST    R14,SAVLNKA                                         0370
*           IF QUITCHK = '000'B     /* CHK FOR TERMINATION FLAG ?    */
*             THEN                  /* NONE,                         */
         TM    QUITCHK,B'11100000'                                 0371
         BNZ   @RF00371                                            0371
*               DO;                                                0372
*           XTRBLK = '0'B;          /* RESET EXTRA BLOCK FLAG        */
         NI    XTRBLK,B'11101111'                                  0373
*           NUMBLKS = (OLRDBUFL+HDRDIF)  /* FIND REQUIRED NUMBER     */
*               /DCBXPTR->DCBBLKSI; /*          OF BLOCKS            */
         SLR   @15,@15                                             0374
         IC    @15,HDRDIF                                          0374
         AL    @15,OLRDBUFL                                        0374
         LR    @00,@15                                             0374
         SRDA  @00,32                                              0374
         L     @15,DCBXPTR                                         0374
         LH    @15,DCBBLKSI(,@15)                                  0374
         DR    @00,@15                                             0374
         STH   @01,NUMBLKS                                         0374
*           IF NUMBLKS < 10         /* CHK FOR LESS THAN 10          */
*             THEN                  /* YES,                          */
         CH    @01,@CH00034                                        0375
         BNL   @RF00375                                            0375
*               DO;                                                0376
*                 NUMBLKS=NUMBLKS+1; /* PROVIDE EXPANSION SPACE      */
         LA    @01,1(,@01)                                         0377
         STH   @01,NUMBLKS                                         0377
*                 XTRBLK = '1'B;    /* SET EXTRA BLOCK FLAG          */
         OI    XTRBLK,B'00010000'                                  0378
*               END;                                               0379
*             ELSE                  /* BLOCK NUMBER NOT LESS THAN 10 */
*               NUMBLKS = 10;       /* SET MAXIMUM BLOCK COUNT       */
         B     @RC00375                                            0380
@RF00375 MVC   NUMBLKS(2),@CH00034                                 0380
*           DO DOWHYLN = 1 TO 1;         /* ESTABLISH GETMAIN        */
@RC00375 LA    @15,1                                               0381
         STH   @15,DOWHYLN                                         0381
@DL00381 DS    0H                                                  0382
*             RESPECIFY (R5,R6,R15) RESTRICTED;                    0382
*             GMAINL=NUMBLKS*DCBXPTR->DCBBLKSI; /* GETMAIN LNG       */
         LH    @08,NUMBLKS                                         0383
         L     @07,DCBXPTR                                         0383
         MH    @08,DCBBLKSI(,@07)                                  0383
         ST    @08,GMAINL                                          0383
*             R5 = GMAINL;          /* SET LENGTH PTR                */
         LR    R5,@08                                              0384
*             R6 = ADDR(GMAINP);    /* SET LOCATION PTR              */
         LA    R6,GMAINP                                           0385
*             GEN(LA    R3,&SUBPN         SET SUBPOOL NUMBER);     0386
         LA    R3,&SUBPN         SET SUBPOOL NUMBER
*             GEN(LA    R1,GMLST          SET PTR TO PL);          0387
         LA    R1,GMLST          SET PTR TO PL
*             GEN(GETMAIN  EC,LV=(R5),A=(R6),SP=(R3),MF=(E,(1)));  0388
         GETMAIN  EC,LV=(R5),A=(R6),SP=(R3),MF=(E,(1))
*             RTNCODE = R15;        /* RESERVE RETURN CODE           */
         ST    R15,RTNCODE                                         0389
*             RESPECIFY (R5,R6,R15) UNRESTRICTED;                  0390
*               IF RTNCODE ^= 0     /* CHK FOR SUCCESS               */
*                 THEN              /* NO,                           */
         L     @15,RTNCODE                                         0391
         SLR   @08,@08                                             0391
         CR    @15,@08                                             0391
         BE    @RF00391                                            0391
*                   DO;                                            0392
*                     IF XTRBLK = '1'B /* CHK IF EXTRA BLOCK CALLED  */
*                       THEN        /* YES,                          */
         TM    XTRBLK,B'00010000'                                  0393
         BNO   @RF00393                                            0393
*                         DO;                                      0394
*                           XTRBLK = '0'B;/* CLEAR BLOCK FLAG        */
         NI    XTRBLK,B'11101111'                                  0395
*                           NUMBLKS = NUMBLKS-1;   /* SET MINIMUM CT */
         LH    @15,NUMBLKS                                         0396
         BCTR  @15,0                                               0396
         STH   @15,NUMBLKS                                         0396
*                           DOWHYLN = 0;   /* TO TRY AGAIN           */
         STH   @08,DOWHYLN                                         0397
*                         END;                                     0398
*                       ELSE        /* NO SPACE FOR RETRY            */
*                         CALL  NOUSP;  /* NO USERID SPACE MESSAGE   */
         B     @RC00393                                            0399
@RF00393 BAL   @14,NOUSP                                           0399
*                   END;                                           0400
*                 ELSE              /* GETMAIN WAS SUCCESSFUL,       */
*                   DO;                                            0401
         B     @RC00391                                            0401
@RF00391 DS    0H                                                  0402
*                     REXBUFP = GMAINP; /* SET UP BUFFER PTR         */
         L     @15,GMAINP                                          0402
         ST    @15,REXBUFP                                         0402
*                     RESPECIFY  (RSPZOP,RLNG,RFROM,RTO) RESTRICTED;
*                     RSPZOP=ADDR(XCOP);  /* PTR TO CLEAR SPACE OP   */
         LA    RSPZOP,XCOP                                         0404
*                     RLNG = GMAINL;  /* SET SPACE LENGTH            */
         L     RLNG,GMAINL                                         0405
*                     RFROM = GMAINP;  /* SET FROM LOCATION          */
         LR    RFROM,@15                                           0406
*                     RTO = RFROM;  /* SET TO LOCATION               */
         LR    RTO,RFROM                                           0407
*                     CALL  DOPSPAZ;  /* TO CLEAR GETMAIN AREA       */
         BAL   @14,DOPSPAZ                                         0408
*                     RESPECIFY (RSPZOP,RLNG,RFROM,RTO) UNRESTRICTED;
*                   END;                                           0410
*           END;                                                   0411
@RC00391 LA    @15,1                                               0411
         AH    @15,DOWHYLN                                         0411
         STH   @15,DOWHYLN                                         0411
         CH    @15,@CH00032                                        0411
         BNH   @DL00381                                            0411
*               END;                                               0412
*           R14 = SAVLNKA;          /* RESTORE LINK REGISTER         */
@RF00371 L     R14,SAVLNKA                                         0413
*           RETURN;                 /* RETURN                        */
         B     @EL00002                                            0414
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -- RBLDHDR                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME -- N/A                                          */
*/*                                                                  */
*/* FUNCTION -- BUILD NEW HEADER BLOCK IN OUTPUT BUFFER              */
*/*   OPERATION --                                                   */
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP RBLDHDR FUNCTION */
*/*   -  CLEAR  STORAGE SPACE  FOR BOTH INPUT (OLRPL)  AND OUTPUT    */
*/*      (NLRPL) REBUILD-STRUCTURE CONTROL BLOCKS                    */
*/*   -  CLEAR MODE-OF-OPERATION FLAGS (OPMODE)                      */
*/*   -  SET TSO MODE FLAG (TSONOW)                                  */
*/*   -  PERFORM SEGMENT FNDTREE TO IDENTIFY AND LOCATE ORIGIN OF    */
*/*      STRUCTURE TO BE PROCESSED (TSO-TYPE FIRST)                  */
*/*   -  COPY BASIC HEADER AREA FROM INPUT MEMBER.  IF INPUT MEMBER  */
*/*      IS NEW=TYPE FORMAT, COPY HEADER AREA EXTENSION FROM INPUT   */
*/*      MEMBER.  OTHERWISE, INITIALIZE HEADER EXTENSION TO DEFAULT  */
*/*   -  INITIALIZE HEADER(S) IN ANY ADDITIONAL EXTENT BLOCK(S)      */
*/*   -  (RESTORE ENTRY LINK REGISTER 14 AND RETURN)                 */
*/*                                                                  */
*/* ENTRY -- N/A, INLINE SEGMENT (PSEDO, LINKED BY REGISTER 14)      */
*/*                                                                  */
*/* INPUT --                                                         */
*/*   -  UADSREFM ENVIRONMENT                                        */
*/*   -  INPUT MEMBER HEADER BLOCK POINTER (RINBUFP)                 */
*/*   -  INPUT DIRECTORY BLOCK POINTER (CURDIRP)                     */
*/*   -  OUTPUT MEMBER HEADER BLOCK POINTER (REXBUFP)                */
*/*                                                                  */
*/* OUTPUT --                                                        */
*/*   -  REVISED HEADER BLOCK IN OUTPUT BUFFER (REXBUF)              */
*/*                                                                  */
*/* EXTERNAL REFERENCES -- N/A                                       */
*/*                                                                  */
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */
*/*   CONDITIONS -- N/A                                              */
*/*                                                                  */
*/* EXIT-ERROR --                                                    */
*/*   CONDITIONS -- N/A                                              */
*/*                                                                  */
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */
*/*                                                                  */
*/********************************************************************/
*RBLDHDR:   /* BUILD NEW HEADER BLOCK(S)                             */
*           ENTRY;                                                 0415
RBLDHDR  DS    0H                                                  0416
*           SAVLNKA = R14;          /* SAVE LINK REGISTER            */
         ST    R14,SAVLNKA                                         0416
*           RESPECIFY (R14) UNRESTRICTED;                          0417
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */
*             THEN                  /* NO,                           */
         TM    QUITCHK,B'11100000'                                 0418
         BNZ   @RF00418                                            0418
*               DO;                                                0419
*                                                                  0419
*           OLRPL = OLRPL&&OLRPL;   /* CLEAR OLD RPL                 */
         XC    OLRPL(121),OLRPL                                    0420
*           NLRPL = NLRPL&&NLRPL;   /* CLEAR NEW RPL                 */
         XC    NLRPL(121),NLRPL                                    0421
*           OPMODE = '000'B;        /* RESET MODE FLAGS              */
         NI    OPMODE,B'11000000'                                  0422
*           TSONOW = '1'B;          /* SET TSO FLAG                  */
         OI    TSONOW,B'00100000'                                  0423
*           CALL  FNDTREE;          /* TO LOCATE CURRENT STRUCTURE   */
*                                                                  0424
         BAL   @14,FNDTREE                                         0424
*           NUBASHD=OLBASHD;        /* SET BASIC HDR AREA            */
         L     @08,REXBUFP                                         0425
         L     @15,RINBUFP                                         0425
         MVC   NUBASHD(28,@08),OLBASHD(@15)                        0425
*           IF RINBUFP->UADSEXPF='1'B /* CHK FOR NEW TYPE INPUT      */
*             THEN                  /* YES,                          */
         TM    UADSEXPF(@15),B'01000000'                           0426
         BNO   @RF00426                                            0426
*               NUEXTHD=OLEXTHD;    /* COPY INPUT HDR EXTENSION      */
         MVC   NUEXTHD(36,@08),OLEXTHD(@15)                        0427
*             ELSE                  /* NOT NEW TYPE INPUT            */
*               NUEXTHD=MEXTHD;     /* SET EXTENSION FROM MODEL      */
*                                                                  0428
         B     @RC00426                                            0428
@RF00426 L     @08,REXBUFP                                         0428
         MVC   NUEXTHD(36,@08),MEXTHD                              0428
*           IDINCB = NUMBLKS;       /* SET TO MASTER HEADER BLOCK    */
@RC00426 MVC   IDINCB(2),NUMBLKS                                   0429
*           HEDBPTR = REXBUFP;      /* SET MASK TO OUTPUT BUFFER     */
         MVC   HEDBPTR(4),REXBUFP                                  0430
*           DO WHILE IDINCB>0;      /* LOOP THROUGH EXTENTS, IF ANY  */
         B     @DE00431                                            0431
@DL00431 DS    0H                                                  0432
*             UADSBLNG=DCBXPTR->DCBBLKSI;  /* OUTPUT BLK LNG         */
         L     @08,HEDBPTR                                         0432
         L     @01,DCBXPTR                                         0432
         MVC   UADSBLNG(2,@08),DCBBLKSI(@01)                       0432
*             IF IDINCB = NUMBLKS   /* MASTER HEADER BLOCK ?         */
*               THEN                /* YES,                          */
         CLC   IDINCB(2),NUMBLKS                                   0433
         BNE   @RF00433                                            0433
*                 DO;               /* INITIALIZE MASTER HEADER BLK  */
*                   UADSEXPF = '1'B;/* SET NEW FORMAT FLAG           */
         OI    UADSEXPF(@08),B'01000000'                           0435
*                   UADSFSQP=(LENGTH(DHED)+3)&RNDDWN;  /* OFFSET     */
         MVC   @ZT00002+2(2),RNDDWN                                0436
         L     @15,@ZT00002                                        0436
         N     @15,@CF02068                                        0436
         STH   @15,UADSFSQP(,@08)                                  0436
*                 END;                                             0437
*               ELSE                /* NO, IS EXTENT BLOCK           */
*                 DO;               /* INITIALIZE EXTENT HEADER BLK  */
         B     @RC00433                                            0438
@RF00433 DS    0H                                                  0439
*                   UADSFSQP=(LENGTH(UADSMHDR)+3)&RNDDWN;  /* OFFSET */
         L     @08,HEDBPTR                                         0439
         MVC   @ZT00002+2(2),RNDDWN                                0439
         L     @15,@ZT00002                                        0439
         N     @15,@CF02026                                        0439
         STH   @15,UADSFSQP(,@08)                                  0439
*                   UADSUSER = REXBUFP->UADSUSER;  /* USERID         */
         L     @01,REXBUFP                                         0440
         MVC   UADSUSER(8,@08),UADSUSER(@01)                       0440
*                   UADSUSER(NODIDL+1)=(NUMBLKS-IDINCB)×'0';   /* N  */
         LH    @01,NODIDL                                          0441
         LH    @00,NUMBLKS                                         0441
         SH    @00,IDINCB                                          0441
         O     @00,@CF01890                                        0441
         STC   @00,UADSUSER(@01,@08)                               0441
*                 END;                                             0442
*             UADSNUSP = '0'B;      /* SET USABLE SPACE LEFT FLAG    */
@RC00433 L     @08,HEDBPTR                                         0443
         NI    UADSNUSP(@08),B'01111111'                           0443
*             FSQEPTR=HEDBPTR+UADSFSQP;  /* PTR TO 1ST FSQE          */
         LH    @15,UADSFSQP(,@08)                                  0444
         LR    @14,@08                                             0444
         ALR   @14,@15                                             0444
         ST    @14,FSQEPTR                                         0444
*             FSQELNTH=UADSBLNG-UADSFSQP;  /* LENGTH OF SPACE        */
         LH    @07,UADSBLNG(,@08)                                  0445
         LCR   @15,@15                                             0445
         ALR   @15,@07                                             0445
         STH   @15,FSQELNTH(,@14)                                  0445
*             FSQENEXT = 0;         /* INDICATE 1ST FSQE             */
         SLR   @15,@15                                             0446
         STH   @15,FSQENEXT(,@14)                                  0446
*             SVFSQEP = FSQEPTR;    /* SET RESERVE PTR               */
         ST    @14,SVFSQEP                                         0447
*             SVFSQEL = FSQEPTR->CURFSQL;   /* RESERVE TEXT LENGTH   */
         MVC   SVFSQEL(2),CURFSQL(@14)                             0448
*             HEDBPTR=HEDBPTR+UADSBLNG;  /* STEP TO NEXT BLOCK       */
         ALR   @08,@07                                             0449
         ST    @08,HEDBPTR                                         0449
*             IDINCB = IDINCB-1;    /* DECREMENT EXTENT COUNTER      */
         LH    @08,IDINCB                                          0450
         BCTR  @08,0                                               0450
         STH   @08,IDINCB                                          0450
*           END;                                                   0451
@DE00431 LH    @08,IDINCB                                          0451
         LTR   @08,@08                                             0451
         BP    @DL00431                                            0451
*           HEDBPTR = RINBUFP;      /* RESTORE MASK TO INPUT BUFFER  */
*                                                                  0452
         MVC   HEDBPTR(4),RINBUFP                                  0452
*               END;                                               0453
*           RESPECIFY (R14) RESTRICTED;                            0454
@RF00418 DS    0H                                                  0455
*           R14 = SAVLNKA;          /* RESTORE LINK REGISTER         */
         L     R14,SAVLNKA                                         0455
*           RETURN;                 /* RETURN                        */
         B     @EL00002                                            0456
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -- RBLDMBR                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME -- N/A                                          */
*/*                                                                  */
*/* FUNCTION -- BUILD NEW USERID MEMBER IN OUTPUT BUFFER             */
*/*   OPERATION --                                                   */
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP RBLDMBR FUNCTION */
*/*   -  PERFORM SEGMENT RBLDIN TO INITIALIZE REBUILDING CONTROL     */
*/*      TABLES AND POINTERS, TO LOCATE SPACE FOR THE USER  PROFILE  */
*/*      TABLE (UPT) AND TO SET THE INITIAL FREE SPACE QUEUE ELEMENT */
*/*   -  INITIALIZE THE DYNAMIC 3-LEVEL MASKS AT THE USERID LEVEL    */
*/*      FOR INPUT (OUOFFS) AND FOR OUTPUT (NUOFFS)) OF THE REBUILD- */
*/*      DATA CONTROL TABLES (INPUT (OLRPL) AND OUTPUT (NLRPL))      */
*/*   -  PERFORM SEGMENTS RITEM (TO REBUILD ONE COMPLETE AUTHORIZA-  */
*/*      TION PATH) AND ADJLVL (TO FIND THE NEXT LEVEL TO REBUILD)   */
*/*   -  WHEN RITEM AND ADJLVL HAVE COMPLETED 1 HIERARCHICAL STRUC-  */
*/*      TURE, THE MODE FLAG (TSONOW) IS RESET                       */
*/*   -  PERFORM SEGMENT FNDTREE TO LOCATE ANY FURTHER STRUCTURE TO  */
*/*      REBUILD.  IF ANY FURTHER STRUCTURE EXISTS, DOWHYLT LOOP     */
*/*      REPEATS THE RBLDMBR FUNCTION                                */
*/*   -  (RESTORE ENTRY LINK REGISTER 14 AND RETURN)                 */
*/*                                                                  */
*/* ENTRY -- N/A, INLINE SEGMENT (LINKED BY REGISTER 14)             */
*/*                                                                  */
*/* INPUT --                                                         */
*/*   -  UADSREFM ENVIRONMENT                                        */
*/*                                                                  */
*/* OUTPUT --                                                        */
*/*   -  REVISED MEMBER IN OUTPUT BUFFER (REXBUF)                    */
*/*                                                                  */
*/* EXTERNAL REFERENCES -- N/A                                       */
*/*                                                                  */
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */
*/*   CONDITIONS -- N/A                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* EXIT-ERROR --                                                    */
*/*   CONDITIONS -- N/A                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */
*/*                                                                  */
*/********************************************************************/
*RBLDMBR:   /* BUILD NEW USERID MEMBER                               */
*           ENTRY;                                                 0457
RBLDMBR  DS    0H                                                  0458
*           SAVLNKA = R14;          /* SAVE LINK REGISTER            */
         ST    R14,SAVLNKA                                         0458
*           RESPECIFY (R14) UNRESTRICTED;                          0459
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG  ?       */
*             THEN                  /* NO,                           */
         TM    QUITCHK,B'11100000'                                 0460
         BNZ   @RF00460                                            0460
*               DO;                                                0461
*                                                                  0461
*           CALL  RBLDIN;           /* GO TO SET UP MEMBER SCAN      */
         BAL   @14,RBLDIN                                          0462
*           DO DOWHYLT=1 TO 1;         /* REFORM ALL TREES           */
         LA    @08,1                                               0463
         STH   @08,DOWHYLT                                         0463
@DL00463 DS    0H                                                  0464
*             ONMIDP = ADDR(OUOFFS);   /* OLD DYNAMIC MASK           */
         LA    @08,OUOFFS                                          0464
         ST    @08,ONMIDP                                          0464
*             NNMIDP = ADDR(NUOFFS);   /* NEW DYNAMIC MASK           */
*                                                                  0465
         LA    @08,NUOFFS                                          0465
         ST    @08,NNMIDP                                          0465
*             DO DOWHYL=1 TO 1;          /* REFORM ONE TREE          */
         LA    @08,1                                               0466
         STH   @08,DOWHYL                                          0466
@DL00466 DS    0H                                                  0467
*               CALL  RITEM;        /* REFORM ONE PATH               */
         BAL   @14,RITEM                                           0467
*               CALL  ADJLVL;       /* SET REFORM POINT LEVEL        */
         BAL   @14,ADJLVL                                          0468
*             END;                                                 0469
*                                                                  0469
         LA    @08,1                                               0469
         AH    @08,DOWHYL                                          0469
         STH   @08,DOWHYL                                          0469
         CH    @08,@CH00032                                        0469
         BNH   @DL00466                                            0469
*             IF TSONOW = '1'B      /* CHK IF TSO TREE JUST DONE     */
*               THEN                /* YES,                          */
         TM    TSONOW,B'00100000'                                  0470
         BNO   @RF00470                                            0470
*                 TSONOW = '0'B;    /* CLEAR TSO TREE FLAG           */
         NI    TSONOW,B'11011111'                                  0471
*             CALL  FNDTREE;        /* CHK FOR MORE TREES TO REFORM  */
@RF00470 BAL   @14,FNDTREE                                         0472
*           END;                                                   0473
*                                                                  0473
         LA    @08,1                                               0473
         AH    @08,DOWHYLT                                         0473
         STH   @08,DOWHYLT                                         0473
         CH    @08,@CH00032                                        0473
         BNH   @DL00463                                            0473
*               END;                                               0474
*           RESPECIFY (R14) RESTRICTED;                            0475
@RF00460 DS    0H                                                  0476
*           R14 = SAVLNKA;          /* RESTORE LINK REGISTER         */
         L     R14,SAVLNKA                                         0476
*           RETURN;                 /* RETURN                        */
         B     @EL00002                                            0477
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -- RENQM                                            */
*/*                                                                  */
*/* DESCRIPTIVE NAME -- N/A                                          */
*/*                                                                  */
*/* FUNCTION -- ENQUEUE ON SYSIKJUA/'USERID NAME'                    */
*/*   OPERATION --                                                   */
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */
*/*   -  PERFORM SEGMENT RDEQM TO REMOVE ANY OUTSTANDING MEMBERNAME  */
*/*      ENQUEUED CONDITION                                          */
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP RENQM FUNCTION   */
*/*   -  IF INPUT UADS (SYSUADS) IS NEW DATA SET,                    */
*/*      -  SET POINTER TO MINOR NAME (QNAMR) AND MINOR NAME LENGTH  */
*/*         (QLNGR)                                                  */
*/*      -  SET POINTER TO ENQ PARAMETER BLOCK (NQMBR) IN REGISTER 1 */
*/*      -  EXECUTE ENQ MACRO                                        */
*/*      -  IF ENQ RETURN CODE IS UNSUCCESSFUL, (NOT 0 OR 8),        */
*/*         PERFORM SEGMENT RENQM2 TO CHECK CODE FURTHER.            */
*/*         OTHERWISE, SET MEMBERNAME-ENQUEUE-IN-FORCE FLAG (NQMNOW) */
*/*         AND SAVE MINOR NAME (NQMIDC) AND MINOR NAME LENGTH       */
*/*         (NQMIDL) FOR DEQUEUEING                                  */
*/*   -  (RESTORE ENTRY LINK REGISTER 14 AND RETURN)                 */
*/*                                                                  */
*/* ENTRY -- N/A, INLINE SEGMENT (PSEUDO, LINKED BY REGISTER 14)     */
*/*                                                                  */
*/* INPUT --                                                         */
*/*   -  UADSREFM ENVIRONMENT                                        */
*/*                                                                  */
*/* OUTPUT --                                                        */
*/*   -  ENQUEUED STATE                                              */
*/*   -  ENQUEUE-IN-FORCE FLAG SET (NQMNOW)                          */
*/*   -  MINOR NAME (NQMIDC) AND LENGTH (NQMIDL) SAVED               */
*/*                                                                  */
*/* EXTERNAL REFERENCES -- ENQ MACRO                                 */
*/*                                                                  */
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */
*/*   CONDITIONS --                                                  */
*/*   -  SUCCESSFUL ENQ                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* EXIT-ERROR --                                                    */
*/*   CONDITIONS --                                                  */
*/*   -  UNSUCCESSFUL ENQ (USERID TERMINATION FLAG (UIDQUIT) SET)    */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */
*/*                                                                  */
*/********************************************************************/
*RENQM:     /* ENQUEUE ON USERID MEMBER NAME                         */
*           /* DEQUEUE AT RDEQM                                      */
*           ENTRY;                                                 0478
RENQM    DS    0H                                                  0479
*           SAVLNKA = R14;          /* SAVE LINK REGISTER            */
         ST    R14,SAVLNKA                                         0479
*           RESPECIFY (R14) UNRESTRICTED;                          0480
*           CALL  RDEQM;            /* CLEAR ENQUEUE STATE           */
         BAL   @14,RDEQM                                           0481
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */
*             THEN                  /* NO,                           */
         TM    QUITCHK,B'11100000'                                 0482
         BNZ   @RF00482                                            0482
*               DO;                                                0483
*                                                                  0483
*           IF RDJXPTR->JFCDISP ^= '11'B  /* CHK FOR SYSUADS = NEW   */
*             THEN                  /* NO,                           */
         L     @08,RDJXPTR                                         0484
         TM    JFCDISP(@08),B'11000000'                            0484
         BO    @RF00484                                            0484
*               DO;                                                0485
*                 RESPECIFY  (QNAMR,QLNGR,R1,R15) RESTRICTED;      0486
*                 QNAMR = ADDR(NODIDC);  /* SET PTR TO MINOR NAME    */
         LA    QNAMR,NODIDC                                        0487
*                 QLNGR = NODIDL;        /* SET MINOR NAME LENGTH    */
         LH    QLNGR,NODIDL                                        0488
*                 R1 = ADDR(NQMBR);      /* SET PTR TO ENQ PARM BLK  */
         LA    R1,NQMBR                                            0489
*                 /* ENQUEUE SYSUADS-MEMBERNAME                      */
*                 GEN(ENQ    (,(QNAMR),,(QLNGR),,),MF=(E,(1)));    0490
*                                                                  0490
         ENQ    (,(QNAMR),,(QLNGR),,),MF=(E,(1))
*                 /* CHK IF ENQUEUE SUCCESSFUL                       */
*                 RCPTR = R15;         /* RESERVE RETURN CODE        */
         ST    R15,RCPTR                                           0491
*                 RESPECIFY  (QNAMR,QLNGR,R1,R15) UNRESTRICTED;    0492
*                 IF RCPTR ^= 0        /* CHK IF SATISFACTORY        */
*                   THEN               /* NO,                        */
         L     @08,RCPTR                                           0493
         LTR   @08,@08                                             0493
         BZ    @RF00493                                            0493
*                     CALL  RENQM2;    /* CHECK UNSATISFACTORY CODE  */
         BAL   @14,RENQM2                                          0494
*                   ELSE                                           0495
*                     DO;                                          0495
         B     @RC00493                                            0495
@RF00493 DS    0H                                                  0496
*                       NQMNOW = '1'B; /* SET ENQUEUE ACTIVE FLAG    */
         OI    NQMNOW,B'00000010'                                  0496
*                       NQMIDC=NODIDC; /* RESERVE MINOR NAME         */
         MVC   NQMIDC(8),NODIDC                                    0497
*                       NQMIDL=NODIDL; /* RESERVE MINOR NAME LENGTH  */
         MVC   NQMIDL(2),NODIDL                                    0498
*                     END;                                         0499
*               END;                                               0500
*                                                                  0500
@RC00493 DS    0H                                                  0501
*               END;                                               0501
@RF00484 DS    0H                                                  0502
*           RESPECIFY (R14) RESTRICTED;                            0502
@RF00482 DS    0H                                                  0503
*           R14 = SAVLNKA;          /* RESTORE LINK REGISTER         */
         L     R14,SAVLNKA                                         0503
*           RETURN;                 /* RETURN                        */
         B     @EL00002                                            0504
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -- RWRITE                                           */
*/*                                                                  */
*/* DESCRIPTIVE NAME -- N/A                                          */
*/*                                                                  */
*/* FUNCTION -- WRITE REFORMATTED MEMBER TO SYSUADS UADS             */
*/*   OPERATION --                                                   */
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP RWRITE FUNCTION  */
*/*   -  ESTABLISH NUMBER OF BLOCK TO WRITE AND DETERMINE USAGE OF   */
*/*      EXTRA BLOCK                                                 */
*/*   -  SET ACCOUNT-WRITE PARAMETER BLOCK (RWPB) FOR WRITE WITHOUT  */
*/*      ENQUEUE OPERATION                                           */
*/*   -  IF EQUIVALENCE FLAG (EQUIUAD) IS SET, PERFORM SEGMENT       */
*/*      DOUPDAT TO WRITE-IN-PLACE THE UPDATED USERID MEMBER.  ELSE  */
*/*      SET THE ACCOUNT-WRITE PARAMETER BLOCK TO WRITE IN CREATE-   */
*/*      MODE 1 MEMBER BLOCK TO THE DATASET CONTROLLED BY THE OUTPUT */
*/*      DCB (REXDCB). INSERT THE MEMBER SEQUENCE CHARACTER IN THE   */
*/*      USERID NAME (NODIDC(NODIDL+1)) STARTING WITH EBCDIC ZERO    */
*/*      FOR THE FIRST WRITE FUNCTION.  PERFORM SEGMENT DOWRT2 TO    */
*/*      CALL ACCOUNT-WRITE (IKJEFA52).  PERFORM SEGMENT RSTOW TO    */
*/*      EXECUTE STOW FOR MEMBER JUST WRITTEN.                       */
*/*   -  IF TERMINATION FLAG (QUITCHK) IS ON, SET DOWHILE CONTROL    */
*/*      (SPZBLKN) TO TERMINATE.  ELSE, STEP WRITE-BUFFER POINTER    */
*/*      (RWPBUF) IN ACCOUNT-WRITE PARAMETER BLOCK BY 1 OUTPUT BLOCK */
*/*      LENGTH AND REDUCE BLOCK COUNT (SPZBLKN) BY 1.  IF SPZBLKN   */
*/*      HAS NOT REACHED ZERO, WRITE-STOW FUNCTION IS REPEATED.      */
*/*      WHEN WRITING IS COMPLETE SEGMENT FREBUF IS PERFORMED TO     */
*/*      FREE THE WRITE-BUFFER AREA                                  */
*/*   -  (RESTORE ENTRY LINK REGISTER 14 AND RETURN)                 */
*/*                                                                  */
*/* ENTRY -- N/A, INLINE SEGMENT (PSEUDO, LINKED BY REGISTER 14)     */
*/*                                                                  */
*/* INPUT --                                                         */
*/*  -  UADSREFM ENVIRONMENT                                         */
*/*  -  NUMBER OF MEMBER BLOCKS TO WRITE (SPZBLKN)                   */
*/*                                                                  */
*/* OUTPUT --                                                        */
*/*  -  REFORMATTED USERID MEMBER WRITTEN TO OUTPUT UADS (SYSUADS)   */
*/*                                                                  */
*/* EXTERNAL REFERENCES -- N/A                                       */
*/*                                                                  */
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */
*/*   CONDITIONS -- N/A                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* EXIT-ERROR -- N/A                                                */
*/*   CONDITIONS -- N/A                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */
*/*                                                                  */
*/********************************************************************/
*RWRITE:    /* WRITE REFORMATTED MEMBER TO SYSUADS UADS              */
*           ENTRY;                                                 0505
RWRITE   DS    0H                                                  0506
*           SAVLNKA = R14;          /* SAVE LINK REGISTER            */
         ST    R14,SAVLNKA                                         0506
*           RESPECIFY (R14) UNRESTRICTED;                          0507
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */
*             THEN                  /* NO,                           */
         TM    QUITCHK,B'11100000'                                 0508
         BNZ   @RF00508                                            0508
*               DO;                                                0509
*                                                                  0509
*           CURFSQP = SVFSQEP;      /* SET TEST PTR                  */
         MVC   CURFSQP(4),SVFSQEP                                  0510
*           IDINCB = NUMBLKS;       /* SET TO MAXIMUM BLOCK COUNT    */
         MVC   IDINCB(2),NUMBLKS                                   0511
*           DO WHILE CURFSQL = SVFSQEL   /* BLOCK NOT USED           */
*               & IDINCB ^= 1;      /* AND NOT FIRST BLOCK           */
         B     @DE00512                                            0512
@DL00512 DS    0H                                                  0513
*             CURFSQP = CURFSQP-REXBUFP->UADSBLNG;  /* TO PRIOR BLK  */
         L     @08,CURFSQP                                         0513
         L     @01,REXBUFP                                         0513
         SH    @08,UADSBLNG(,@01)                                  0513
         ST    @08,CURFSQP                                         0513
*             IDINCB = IDINCB - 1;   /* REDUCE CURRENT COUNT         */
         LH    @08,IDINCB                                          0514
         BCTR  @08,0                                               0514
         STH   @08,IDINCB                                          0514
*           END;                                                   0515
@DE00512 L     @08,CURFSQP                                         0515
         CLC   CURFSQL(2,@08),SVFSQEL                              0515
         BNE   @DC00512                                            0515
         CLC   IDINCB(2),@CH00032                                  0515
         BNE   @DL00512                                            0515
@DC00512 DS    0H                                                  0516
*           IF IDINCB^<NUMBLKS      /* IS LAST BLOCK IN USE ?        */
*               & XTRBLK = '1'B     /* AND IS IT EXTRA BLOCK ?       */
*             THEN                  /* YES,                          */
         LH    @08,IDINCB                                          0516
         CH    @08,NUMBLKS                                         0516
         BL    @RF00516                                            0516
         TM    XTRBLK,B'00010000'                                  0516
         BNO   @RF00516                                            0516
*               XTRBNOW='1'B;       /* SET EXTRA BLOCK IN USE FLAG   */
         OI    XTRBNOW,B'00001000'                                 0517
*           RWPF2 = '0'B;           /* SET PTR-TO-USERID FLAG        */
@RF00516 DS    0H                                                  0519
*           RWPF5 = '1'B;           /* SET DO-WRITE-NOW FLAG         */
*           RWPF7 = '0'B;           /* SET DO-NOT-ENQUEUE FLAG       */
         OI    RWPF5,B'00001000'                                   0520
         NI    RWPF2,B'10111101'                                   0520
*           IF EQUIUAD = '1'B       /* CHK IF UPDAT MODE IS CURRENT  */
*             THEN                  /* YES,                          */
         TM    EQUIUAD,B'01000000'                                 0521
         BNO   @RF00521                                            0521
*               CALL  DOUPDAT;      /* GO TO WRITE IN UPDAT MODE     */
         BAL   @14,DOUPDAT                                         0522
*             ELSE                  /* IN CREATE MODE NOW            */
*               DO;                                                0523
         B     @RC00521                                            0523
@RF00521 DS    0H                                                  0524
*                 RWPBSAV = RWPB;   /* RESERVE READ PARM BLOCK       */
         MVC   RWPBSAV(24),RWPB                                    0524
*                 SPZBLKN = IDINCB; /* RESERVE NUMBER OF BLOCKS      */
         LH    @08,IDINCB                                          0525
         STH   @08,SPZBLKN                                         0525
*                 RWPBUF = REXBUFP; /* PTR TO OUTPUT BUFFER          */
         MVC   RWPBUF(3),REXBUFP+1                                 0526
*                 RWPUDP = ADDR(REXDCB);  /* PTR TO DCB              */
         LA    @15,REXDCB                                          0527
         ST    @15,@TF00001                                        0527
         MVC   RWPUDP(3),@TF00001+1                                0527
*                 RWPF3 = '0'B;     /* SET NOT-DIRECTORY-PTR FLAG    */
         NI    RWPF3,B'11011111'                                   0528
*                 RWPNOM = 1;                                      0529
         MVI   RWPNOM,X'01'                                        0529
*                 DO SPZBLKN TO 0 BY -1 WHILE SPZBLKN ^= 0;        0530
         B     @DE00530                                            0530
@DL00530 SLR   @15,@15                                             0530
         CR    @08,@15                                             0530
         BE    @DC00530                                            0530
*                   RWPRBP=0;       /* SET CREATE MODE INDICATOR     */
         ST    @15,RWPRBP                                          0531
*                   NODIDC(NODIDL+1)=  /* INSERT INCREMENTAL         */
*                        (IDINCB-SPZBLKN)×'0';    /* CHAR            */
         LH    @01,NODIDL                                          0532
         LCR   @08,@08                                             0532
         AH    @08,IDINCB                                          0532
         O     @08,@CF01890                                        0532
         STC   @08,NODIDC(@01)                                     0532
*                   CALL DOWRT2;    /* TO CALL WRITE ROUTINE         */
         BAL   @14,DOWRT2                                          0533
*                   RWPRBP = RWPSDR;  /* RESTORE DIRECTORY PTR       */
         MVC   RWPRBP(4),RWPSDR                                    0534
*                   CALL  RSTOW;    /* TO CALL STOW ROUTINE          */
         BAL   @14,RSTOW                                           0535
*                   IF QUITCHK ^= '000'B/* CHK FOR TERMINATION       */
*                     THEN          /* YES,                          */
         TM    QUITCHK,B'11100000'                                 0536
         BZ    @RF00536                                            0536
*                       SPZBLKN = 0;    /* STOP WRITE LOOP           */
         SLR   @08,@08                                             0537
         STH   @08,SPZBLKN                                         0537
*                     ELSE          /* NOT TERMINATION NOW           */
*                         RWPBUF=RWPBUF+DCBXPTR->DCBBLKSI;  /* SET   */
         B     @RC00536                                            0538
@RF00536 L     @08,RWPBUF-1                                        0538
         LA    @08,0(,@08)                                         0538
         L     @01,DCBXPTR                                         0538
         AH    @08,DCBBLKSI(,@01)                                  0538
         ST    @08,@TF00001                                        0538
         MVC   RWPBUF(3),@TF00001+1                                0538
*                 END;                                             0539
@RC00536 SLR   @08,@08                                             0539
         BCTR  @08,0                                               0539
         AH    @08,SPZBLKN                                         0539
         STH   @08,SPZBLKN                                         0539
@DE00530 LTR   @08,@08                                             0539
         BNM   @DL00530                                            0539
@DC00530 DS    0H                                                  0540
*                 CALL  FREBUF;     /* FREE OUTBUFFER AREA           */
         BAL   @14,FREBUF                                          0540
*                 RWPB = RWPBSAV;   /* RESTORE READ PARM BLOCK       */
         MVC   RWPB(24),RWPBSAV                                    0541
*               END;                                               0542
*                                                                  0542
*               END;                                               0543
@RC00521 DS    0H                                                  0544
*           RESPECIFY (R14) RESTRICTED;                            0544
@RF00508 DS    0H                                                  0545
*           R14 = SAVLNKA;          /* RESTORE LINK REGISTER         */
         L     R14,SAVLNKA                                         0545
*           END  RINIT;             /* RETURN                        */
         B     @EL00002                                            0546
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -- DCBCHK                                           */
*/*                                                                  */
*/* DESCRIPTIVE NAME -- N/A                                          */
*/*                                                                  */
*/* FUNCTION -- CHECK DCB FOR MINIMUM AND IDENTICAL BLOCK SIZE       */
*/*                                                                  */
*/*   OPERATION --                                                   */
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */
*/*   -  IF OUTPUT BLOCK SIZE IS LESS THAN MINIMUM, ISSUE ERROR      */
*/*      MESSAGE 15 AND SET UADSREFM TERMINATION FLAG (RFMQUIT)      */
*/*   -  IF INPUT (SYSUADN) AND OUTPUT (SYSUADS) DATA SETS ARE IDEN- */
*/*      TICAL ( EQUIUAD FLAG SET ), AND BLOCK SIZES ARE NOT EQUAL,  */
*/*      ISSUE ERROR MESSAGE 26 AND SET UADSREFM TERMINATION FLAG    */
*/*   -  (RESTORE ENTRY LINK REGISTER 14 AND RETURN)                 */
*/*                                                                  */
*/* ENTRY -- N/A, INLINE SEGMENT (PSEUDO, LINKED BY REGISTER 14)     */
*/*                                                                  */
*/* INPUT --                                                         */
*/*   -  UADSREFM ENVIRONMENT                                        */
*/*                                                                  */
*/* OUTPUT -- N/A                                                    */
*/*                                                                  */
*/* EXTERNAL REFERENCES -- N/A                                       */
*/*                                                                  */
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */
*/*   CONDITIONS --                                                  */
*/*   -  SYSUADS BLOCKSIZE ADEQUATE                                  */
*/*   -  SYSUADS AND SYSUADN BLOCKSIZES IDENTICAL FOR UPDATE MODE    */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* EXIT-ERROR -- N/A (RETURN BY ENTRY LINK REGISTER 14)             */
*/*   CONDITIONS --                                                  */
*/*   -  INADEQUATE BLOCK SIZE FOR SYSUADS OR UPDATE MODE BLOCK      */
*/*      SIZES NOT EQUAL (TERMINATION FLAG (RFMQUIT) IS SET)         */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */
*/*                                                                  */
*/********************************************************************/
*DCBCHK:    /* CHECK DCB FOR ADEQUATE AND IDENTICAL BLOCK SIZES      */
*           PROCEDURE                                              0547
*                 OPTIONS(DONTSAVE,NOSAVEAREA); /* NO REGS SAVED,    */
DCBCHK   DS    0H                                                  0548
*                                   /* NO SAVE AREA CREATED          */
*           RESPECIFY (R14) RESTRICTED;                            0548
*           SAVLNKB = R14;          /* SAVE LINK REGISTER            */
         ST    R14,SAVLNKB                                         0549
*           RESPECIFY (R14) UNRESTRICTED;                          0550
*                                                                  0550
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */
*             THEN                  /* NO,                           */
         TM    QUITCHK,B'11100000'                                 0551
         BNZ   @RF00551                                            0551
*               DO;                                                0552
*                                                                  0552
*           IF DCBXPTR->DCBBLKSI<MINBLK   /* BLOCK SIZE INADEQUATE ? */
*             THEN                  /* YES,                          */
         L     @08,DCBXPTR                                         0553
         LH    @08,DCBBLKSI(,@08)                                  0553
         C     @08,MINBLK                                          0553
         BNL   @RF00553                                            0553
*               DO;                                                0554
*                 MSGNO = 15;       /* SET MESSAGE INDEX             */
         MVC   MSGNO(2),@CH00174                                   0555
*                 CALL  MSGFNDR;    /* LOCATE MESSAGE TEXT           */
         BAL   @14,MSGFNDR                                         0556
*                 CALL  FXPUTLM;    /* INITIALIZE PARM BLOCK         */
         BAL   @14,FXPUTLM                                         0557
*                 CALL  DOPUTL;     /* TO ISSUE PUTLINE              */
         BAL   @14,DOPUTL                                          0558
*                 RFMQUIT = '1'B;   /* SET TERMINATION FLAG          */
         OI    RFMQUIT,B'01000000'                                 0559
*               END;                                               0560
*                                                                  0560
*           IF EQUIUAD = '1'B       /* CHK FOR UPDATE MODE           */
*             THEN                  /* YES,                          */
@RF00553 TM    EQUIUAD,B'01000000'                                 0561
         BNO   @RF00561                                            0561
*               IF DCBBLKSI^=DCBXPTR->DCBBLKSI  /* CHK IF UNEQUAL    */
*                 THEN              /* YES,                          */
         L     @08,DCBPTR                                          0562
         L     @01,DCBXPTR                                         0562
         CLC   DCBBLKSI(2,@08),DCBBLKSI(@01)                       0562
         BE    @RF00562                                            0562
*                   DO;                                            0563
*                     MSGNO = 26;   /* SET MESSAGE INDEX             */
         MVC   MSGNO(2),@CH01912                                   0564
*                     CALL  MSGFNDR;  /* LOCATE MESSAGE TEXT         */
         BAL   @14,MSGFNDR                                         0565
*                     CALL  FXPUTLM;  /* INITIALIZE PARM BLOCK       */
         BAL   @14,FXPUTLM                                         0566
*                     CALL  DOPUTL;   /* TO ISSUE PUTLINE            */
         BAL   @14,DOPUTL                                          0567
*                     RFMQUIT = '1'B; /* SET TERMINATION FLAG        */
         OI    RFMQUIT,B'01000000'                                 0568
*                   END;                                           0569
*                                                                  0569
*           END;                                                   0570
@RF00562 DS    0H                                                  0570
@RF00561 DS    0H                                                  0571
*           RESPECIFY (R14) RESTRICTED;                            0571
@RF00551 DS    0H                                                  0572
*           R14 = SAVLNKB;          /* RESTORE LINK REGISTER         */
         L     R14,SAVLNKB                                         0572
*           RETURN;                 /* RETURN                        */
@EL00003 DS    0H                                                  0573
@EF00003 DS    0H                                                  0573
@ER00003 BR    @14                                                 0573
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -- RDINIT                                           */
*/*                                                                  */
*/* DESCRIPTIVE NAME -- N/A                                          */
*/*                                                                  */
*/* FUNCTION -- INITIALIZE ACCOUNT-READ PARAMETER BLOCK (RWPB) AND   */
*/*             OBTAIN FIRST USERID                                  */
*/*   OPERATION --                                                   */
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP RDINIT FUNCTION  */
*/*   -  INITIALIZE ACCOUNT-READ PARAMETER BLOCK (RWPB) FOR POINTERS */
*/*      TO INPUT DCB (RINDCB), TO COMMUNICATION PL (PLOUT), AND TO  */
*/*      UADSREFM IDENTIFYING CHARACTER 'R'                          */
*/*   -  DEFINE LENGTH (DPLNDP) OF REBUILD-STRUCTURE CONTROL BLOCK   */
*/*   -  SET RWPB TO PERFORM DIRECTORY+MEMBER TYPE READ              */
*/*   -  PERFORM SEGMENT DOREAD TO OBTAIN FIRST USERID MEMBER AND    */
*/*      AND DIRECTORY ENTRY HOLDING NAME OF NEXT SEQUENTIAL USERID  */
*/*      NAME.  SAVE THAT NAME (COMPNAM).  SET POINTER (DIRBDAP) TO  */
*/*      FIRST DIRECTORY ENTRY.  SAVE THAT CURRENT DIRECTORY ENTRY   */
*/*   -  (RESTORE ENTRY LINK REGISTER 14 AND RETURN)                 */
*/*                                                                  */
*/* ENTRY -- N/A, INLINE SEGMENT (PSEUDO, LINKED BY REGISTER 14)     */
*/*                                                                  */
*/* INPUT --                                                         */
*/*   -  UADSREFM ENVIRONMENT                                        */
*/*                                                                  */
*/* OUTPUT --                                                        */
*/*   -  FIRST USERID MEMBER IN INPUT BUFFER                         */
*/*   -  NEXT USERID NAME (COMPNAM)                                  */
*/*   -  COPY OF CURRENT DIRECTORY ENTRY (CURDIRN)                   */
*/*                                                                  */
*/* EXTERNAL REFERENCES -- N/A                                       */
*/*                                                                  */
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */
*/*   CONDITIONS -- N/A                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* EXIT-ERROR -- N/A                                                */
*/*   CONDITIONS -- N/A                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */
*/*                                                                  */
*/********************************************************************/
*RDINIT:    /* INITIALIZE RD/WR  P B  AND OBTAIN FIRST USERID        */
*           ENTRY;                                                 0574
RDINIT   DS    0H                                                  0575
*           SAVLNKB = R14;          /* SAVE LINK REGISTER            */
         ST    R14,SAVLNKB                                         0575
*           RESPECIFY (R14) UNRESTRICTED;                          0576
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */
*             THEN                  /* NO,                           */
         TM    QUITCHK,B'11100000'                                 0577
         BNZ   @RF00577                                            0577
*               DO;                                                0578
*                                                                  0578
*           /* INITIALIZE READ/WRITE PARAMETER BLOCK                 */
*           RWPUDP = ADDR(RINDCB);  /* SET PTR TO UADS DCB           */
         LA    @08,RINDCB                                          0579
         ST    @08,@TF00001                                        0579
         MVC   RWPUDP(3),@TF00001+1                                0579
*           RWPAPL = ADDR(PLOUT);   /* SET PTR TO REFORM  P L        */
         LA    @08,PLOUT                                           0580
         ST    @08,RWPAPL                                          0580
*           RWPCHR = 'R';           /* SET REFORM IDENTIFIER         */
         MVI   RWPCHR,C'R'                                         0581
*           RWPF4 = '1'B;           /* SET EXTRA BLOCK REQUEST FLAG  */
*                                                                  0582
         OI    RWPF4,B'00010000'                                   0582
*           DPLNDP = ADDR(OEND);    /* SET PTR TO END OF OLRPL       */
*                                                                  0583
         LA    @08,OEND                                            0583
         ST    @08,DPLNDP                                          0583
*           /* INITIALIZE FOR READ SPECIFIC OR DIRECTORY MEMBER      */
*/*         NOTE -- THE FOLLOWING CODE-COMMENTS REPRESENT THE CODE   */
*/*         INSERTION NEEDED IF SPECIFIC NAME(S) ABILITY PARAMETERS  */
*/*         ARE ADDED TO UADSREFM INVOCATION                         */
*/*         IF DUCLSF1 = YES        /* CHK FOR ASTERISK FLAG         */
*/*           THEN                  /* YES,                          */
*               DO;                                                0584
*                 /* DO PRIME-READ TO IDENTIFY FIRST MEMBER NAME     */
*                 RWPF3  =  '1'B;   /* SET WORK AREA INDICATOR       */
         OI    RWPF3,B'00100000'                                   0585
*                 RWPWAP=ADDR(DIRWA); /* PTR TO DIRECTORY WORK AREA  */
         LA    @08,DIRWA                                           0586
         ST    @08,RWPWAP                                          0586
*                 CALL  DOREAD;     /* GO TO EXECUTE PRIMING READ    */
         BAL   @14,DOREAD                                          0587
*                 COMPNAM = RDNAMC; /* RESERVE NEXT NAME             */
         L     @08,RWPNBP                                          0588
         MVC   COMPNAM(8),RDNAMC(@08)                              0588
*                 DIRBDAP=ADDR(DIRBLK)+2;  /* PTR TO DIRECTORY ENTRY */
         LA    @08,DIRBLK                                          0589
         AH    @08,@CH00099                                        0589
         ST    @08,DIRBDAP                                         0589
*                 CURDIRN = UADIRENT;  /* RESERVE CURRENT USER ENTRY */
         L     @08,DIRPTR                                          0590
         MVC   CURDIRN(14),UADIRENT(@08)                           0590
*               END;                                               0591
*/*           ELSE                  /* NO, IS NOT ASTERISK USERID    */
*/*             DO;                                                  */
*/*               RWPNBP=ADDR(NODIDC);  /* PTR TO SPECIFIC USERID    */
*/*               NODIDC(NODIDL+1)=CZERO; /* ZERO FOR FIRST MEMBER   */
*/*             END;                                                 */
*                                                                  0592
*               END;                                               0592
*           RESPECIFY (R14) RESTRICTED;                            0593
@RF00577 DS    0H                                                  0594
*           R14 = SAVLNKB;          /* RESTORE LINK REGISTER         */
         L     R14,SAVLNKB                                         0594
*           RETURN;                 /* RETURN                        */
         B     @EL00003                                            0595
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -- RDNAM                                            */
*/*                                                                  */
*/* DESCRIPTIVE NAME -- N/A                                          */
*/*                                                                  */
*/* FUNCTION -- EXTRACT NAME OF MEMBER READ AND FIND NAME LENGTH     */
*/*   OPERATION --                                                   */
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP RDNAM FUNCTION   */
*/*   -  IF NEXT NAME IS  END-OF-FILE  MASK,  SET END-OF-DIRECTORY   */
*/*      FLAG (RENDOF) AND RETURN                                    */
*/*   -  SET CURRENT USERID NAME (NODIDC) FROM SAVE NEXT NAME        */
*/*      (COMPNAM) OR IF FIRST USERID IS BEING PROCESSED, FROM       */
*/*      DIRECTORY ENTRY (RDNAMD)                                    */
*/*   -  SCAN NAME TO FIND NUMBER OF SIGNIFICANT CHARACTERS (NODIDL) */
*/*   -  IF FIRST USERID IS BEING PROCESSED, SET 1ST-USERID-READ     */
*/*      FLAG (RDINTL) AND FIRST-USERID-CURRENTLY-IN-PROCESS FLAG    */
*/*      (RD1NOW)                                                    */
*/*   -  (RESTORE ENTRY LINK REGISTER 14 AND RETURN)                 */
*/*                                                                  */
*/* ENTRY -- N/A, INLINE SEGMENT (PSEUDO, LINKED BY REGISTER 14)     */
*/*                                                                  */
*/* INPUT --                                                         */
*/*   -  UADSREFM ENVIRONMENT                                        */
*/*   -  NEXT USERID NAME IN SAVE AREA (COMPNAM) OR IN 1ST DIRECTORY */
*/*      ENTRY (RDNAMD)                                              */
*/*                                                                  */
*/* OUTPUT --                                                        */
*/*   -  CURRENT USERID NAME IN CURRENT USE AREA (NODIDC) AND THE    */
*/*      CURRENT NUMBER OF CHARACTERS IN (NODIDL),                   */
*/*      OR END-OF-DIRECTORY FLAG                                    */
*/*                                                                  */
*/* EXTERNAL REFERENCES -- N/A                                       */
*/*                                                                  */
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */
*/*   CONDITIONS -- N/A                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* EXIT-ERROR -- N/A                                                */
*/*   CONDITIONS -- N/A                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */
*/*                                                                  */
*/********************************************************************/
*RDNAM:     /* EXTRACT NAME OF MEMBER READ AND FIND NAME LENGTH      */
*           ENTRY;                                                 0596
RDNAM    DS    0H                                                  0597
*           SAVLNKB = R14;          /* SAVE LINK REGISTER            */
         ST    R14,SAVLNKB                                         0597
*           RESPECIFY (R14) UNRESTRICTED;                          0598
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */
*             THEN                  /* NO,                           */
         TM    QUITCHK,B'11100000'                                 0599
         BNZ   @RF00599                                            0599
*               DO;                                                0600
*                                                                  0600
*           NODIDC = COMPNAM;       /* SET CURRENT USERID NAME       */
         MVC   NODIDC(8),COMPNAM                                   0601
*           IF RDINTL = '0'B        /* CH FOR 1ST READ DONE          */
*             THEN                  /* NO,                           */
         TM    RDINTL,B'00000010'                                  0602
         BNZ   @RF00602                                            0602
*               NODIDC = RDNAMD;    /* GET 1ST NAME IN DIRECTORY     */
         MVC   NODIDC(8),RDNAMD                                    0603
*           IF NODIDC ^= ENDMSK     /* CHK FOR END OF DIRECTORY      */
*             THEN                  /* NOT END,                      */
@RF00602 CLC   NODIDC(8),ENDMSK                                    0604
         BE    @RF00604                                            0604
*               DO;                                                0605
*                 NODIDL = 7;       /* INITIALIZE LENGTH COUNT       */
         MVC   NODIDL(2),@CH00644                                  0606
*                 /* FIND LENGTH OF NEW NAME                         */
*                 DO DOWHYLR=1 TO 1;         /* START DOWHILE LOOP   */
         LA    @08,1                                               0607
         STH   @08,DOWHYLR                                         0607
@DL00607 DS    0H                                                  0608
*                   /* CHK FOR TERMINATING CHARACTER                 */
*                   IF NODIDC(NODIDL+1)^='0'   /* CHK FOR MEMBER ID  */
*                     THEN          /* IS NOT 0                      */
         LH    @08,NODIDL                                          0608
         LA    @01,NODIDC(@08)                                     0608
         CLI   0(@01),C'0'                                         0608
         BE    @RF00608                                            0608
*                       DO;                                        0609
*                         NODIDL = NODIDL-1;  /* REDUCE LENGTH COUNT */
         BCTR  @08,0                                               0610
         STH   @08,NODIDL                                          0610
*                         DOWHYLR = 0;    /* SET DOWHILE LOCK        */
         SLR   @08,@08                                             0611
         STH   @08,DOWHYLR                                         0611
*                       END;                                       0612
*                 END;              /* IS NOW 0                      */
*                                                                  0613
@RF00608 LA    @08,1                                               0613
         AH    @08,DOWHYLR                                         0613
         STH   @08,DOWHYLR                                         0613
         CH    @08,@CH00032                                        0613
         BNH   @DL00607                                            0613
*                 /* CHK IF INITIAL READ PROCESSED                   */
*                 IF RDINTL = '0'B  /* CHK FOR 1ST READ FLAG         */
*                   THEN            /* NO,                           */
         TM    RDINTL,B'00000010'                                  0614
         BNZ   @RF00614                                            0614
*                     DO;                                          0615
*                       RDINTL='1'B; /* SET FIRST READ DONE FLAG     */
         OI    RDINTL,B'00000010'                                  0616
*                       RD1NOW='1'B; /* SET TO PROCESS FIRST READ    */
         OI    RD1NOW,B'01000000'                                  0617
*                     END;                                         0618
*               END;                                               0619
*             ELSE                                                 0620
*               RENDOF = '1'B;      /* SET END OF DIRECTORY FLAG     */
*                                                                  0620
         B     @RC00604                                            0620
@RF00604 OI    RENDOF,B'00100000'                                  0620
*               END;                                               0621
@RC00604 DS    0H                                                  0622
*           RESPECIFY (R14) RESTRICTED;                            0622
@RF00599 DS    0H                                                  0623
*           R14 = SAVLNKB;          /* RESTORE LINK REGISTER         */
         L     R14,SAVLNKB                                         0623
*           RETURN;                 /* RETURN                        */
         B     @EL00003                                            0624
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -- RDDIR                                            */
*/*                                                                  */
*/* DESCRIPTIVE NAME -- N/A                                          */
*/*                                                                  */
*/* FUNCTION -- GET DIRECTORY BLOCK AT/BELOW CURRENT NEXT NAME       */
*/*   OPERATION --                                                   */
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP RDDIR FUNCTION   */
*/*   -  EXECUTE BSP (BACKSPACE) MACRO                               */
*/*   -  IF BSP FAILED (RETURN CODE NOT 0) ISSUE ERROR MESSAGE 21,   */
*/*      SET UADSREFM TERMINATION FLAG (RFMQUIT) AND EXIT            */
*/*   -  IF BSP SUCCEEDED, INITIALIZE ACCOUNT-READ PARAMETER BLOCK   */
*/*      (RWPB) FOR READ-DIRECTORY-ONLY, AND PERFORM SEGMENT DOREAD  */
*/*      TO OBTAIN NEXT DIRECTORY BLOCK.  RESET DATA-READ-DONE FLAG  */
*/*      (RDDONE) AND SET DIRECTORY ENTRY POINTER (DIRBDAP) TO FIRST */
*/*      ENTRY IN NEW DIRECTORY BLOCK                                */
*/*   -  (RESTORE ENTRY LINK REGISTER 14 AND RETURN)                 */
*/*                                                                  */
*/* ENTRY -- N/A, INLINE SEGMENT (LINKED BY REGISTER 14)             */
*/*                                                                  */
*/* INPUT --                                                         */
*/*   -  UADSREFM ENVIRONMENT                                        */
*/*   -  NEXT USERID NAME IN RESERVED AREA (COMPNAM)                 */
*/*                                                                  */
*/* OUTPUT --                                                        */
*/*   -  DIRECTORY ENTRY CONTAINING NEXT USERID NAME IS IN DIRECTORY */
*/*      WORK AREA (DIRWA)                                           */
*/*   -  FIRST DIRECTORY ENTRY IS LOCATED BY POINTER (DIRBDAP)       */
*/*                                                                  */
*/* EXTERNAL REFERENCES -- BSP MACRO                                 */
*/*                                                                  */
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */
*/*   CONDITIONS --                                                  */
*/*   -  SUCESSFUL BSP AND READ                                      */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* EXIT-ERROR -- N/A (RETURN BY ENTRY LINK REGISTER 14)             */
*/*   CONDITIONS --                                                  */
*/*   -  BSP FAILURE (RFMQUIT FLAG SET)                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */
*/*                                                                  */
*/********************************************************************/
*RDDIR:     /* GET DIRECTORY BLOCK AT/BELOW CURRENT NEXT NAME        */
*           ENTRY;                                                 0625
*                                                                  0625
RDDIR    DS    0H                                                  0626
*           SAVLNKB = R14;          /* SAVE LINK REGISTER            */
         ST    R14,SAVLNKB                                         0626
*           RESPECIFY (R14) UNRESTRICTED;                          0627
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */
*             THEN                  /* NO,                           */
         TM    QUITCHK,B'11100000'                                 0628
         BNZ   @RF00628                                            0628
*               DO;                                                0629
*                                                                  0629
*/*         DO DOWHYL2=START TO STOP;  /* DO WHILE WRONG DIR BLOCK   */
*             RWPBSAV = RWPB;       /* RESERVE UPDAT READ/WRITE PB   */
         MVC   RWPBSAV(24),RWPB                                    0630
*             DO BSPCTR=START2 TO 2;      /* LOOP FOR NEXT BLOCK     */
         LH    @08,START2                                          0631
         B     @DE00631                                            0631
@DL00631 DS    0H                                                  0632
*               GENERATE(BSP  RDIDCB); /* BACKSPACE DIRECTORY        */
         BSP  RDIDCB
*               /* CHK FOR SUCCESSFUL BACKSPACE                      */
*               RESPECIFY (R15) RESTRICTED;                        0633
*               RTNCODE = R15;      /* RESERVE RETURN CODE           */
         ST    R15,RTNCODE                                         0634
*               RESPECIFY (R15) UNRESTRICTED;                      0635
*               IF RTNCODE ^= 0     /* CHK FOR SUCCESS CODE          */
*                 THEN              /* NO,                           */
         L     @08,RTNCODE                                         0636
         LTR   @08,@08                                             0636
         BZ    @RF00636                                            0636
*                   DO;                                            0637
*                     MSGNO = 21;   /* SET MESSAGE INDEX             */
         MVC   MSGNO(2),@CH01923                                   0638
*                     SOFFS = 20;   /* SET TEXT OFFSET               */
         MVC   SOFFS(2),@CH00351                                   0639
*                     CALL  SYSERRD;  /* GO TO ISSUE MESSAGE         */
         BAL   @14,SYSERRD                                         0640
*                     RFMQUIT = '1'B; /* UADSREFM TERM FLAG          */
         OI    RFMQUIT,B'01000000'                                 0641
*                     BSPCTR = 2;      /* NO MORE BACKSPACE          */
         MVC   BSPCTR(2),@CH00099                                  0642
*                   END;                                           0643
*                 ELSE              /* SUCCESSFUL BACKSPACE,         */
*                   DIREND = '0'B;  /* CLEAR DIRECTORY EOF FLAG      */
         B     @RC00636                                            0644
@RF00636 NI    DIREND,B'10111111'                                  0644
*             END;                                                 0645
@RC00636 LA    @08,1                                               0645
         AH    @08,BSPCTR                                          0645
@DE00631 STH   @08,BSPCTR                                          0645
         CH    @08,@CH00099                                        0645
         BNH   @DL00631                                            0645
*             IF QUITCHK = '000'B   /* CHK FOR TERMINATION           */
*               THEN                /* NO,                           */
         TM    QUITCHK,B'11100000'                                 0646
         BNZ   @RF00646                                            0646
*                 DO;                                              0647
*                   RWPF6 = '1'B;   /* SET DIRECTORY ONLY FLAG       */
         OI    RWPF6,B'00000100'                                   0648
*                   RWPWAP = ADDR(DIRWA);  /* SET WORK AREA PTR      */
         LA    @08,DIRWA                                           0649
         ST    @08,RWPWAP                                          0649
*                   CALL  DOREAD;   /* GET DIRECTORY BLOCK           */
         BAL   @14,DOREAD                                          0650
*                   RWPF6 = '0'B;   /* CLEAR DIRECTORY ONLY FLAG     */
         NI    RWPF6,B'11111011'                                   0651
*                   DIRBDAP=ADDR(DIRBNAM1); /* PTR TO 1ST NAME       */
         LA    @08,DIRBNAM1                                        0652
         ST    @08,DIRBDAP                                         0652
*/*                 IF DIRBNAM1 > COMPNAM  /* CHK FOR TOO HIGH A BLK */
*/*                   THEN          /* YES,                          */
*/*                     DO;                                          */
*/*                       DOWHYL2 = GO; /* GET PREVIOUS BLOCK        */
*/*                       START2 = D1;  /* SET FOR DOUBLE BSP        */
*/*                     END;                                         */
*                 END;                                             0653
*             RWPB = RWPBSAV;       /* RESTORE UPDAT READ/WRITE PB   */
@RF00646 MVC   RWPB(24),RWPBSAV                                    0654
*/*         END;                                                     */
*                                                                  0655
*               END;                                               0655
*           RESPECIFY (R14) RESTRICTED;                            0656
@RF00628 DS    0H                                                  0657
*           R14 = SAVLNKB;          /* RESTORE LINK REGISTER         */
         L     R14,SAVLNKB                                         0657
*           RETURN;                 /* RETURN                        */
         B     @EL00003                                            0658
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -- RDLOCN                                           */
*/*                                                                  */
*/* DESCRIPTIVE NAME -- N/A                                          */
*/*                                                                  */
*/* FUNCTION -- SCAN DIRECTORY BLOCK FOR NEXT NAME                   */
*/*   OPERATION --                                                   */
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */
*/*   -  IF TERMINATION FLAG (RFMQUIT) IS SET, SKIP RDLOCN FUNCTION  */
*/*   -  FIND LOCATION OF LAST USERID NAME (DRBLASP) IN CURRENT      */
*/*      DIRECTORY ENTRY BLOCK                                       */
*/*   -  SET CURRENT DIRECTORY NAME POINTER (DIRBDAP) TO 1ST USERID  */
*/*      NAME IN CURRENT DIRECTORY BLOCK                             */
*/*   -  IF CURRENT DIRECTORY ENTRY NAME (DIRBNAM) IS END-OF-DIREC-  */
*/*      TORY FLAG (ENDMSK), SET END OF DIRECTORY FLAG (DIREND),     */
*/*      PERFORM SEGMENT NOUFND (TO ISSUE ERROR MESSAGE 5 AND SET    */
*/*      UIDQUIT FLAG), THEN EXIT                                    */
*/*   -  IF NOT END OF DIRECTORY, SCAN THROUGH TO FIND THE ENTRY     */
*/*      CONTAINING CURRENT NEXT NAME (COMPNAM).  IF NAME IS LOCATED */
*/*      SAVE IN DIRECTORY ENTRY (CURDIRN).  IF NOT LOCATED, SET     */
*/*      FLAG (DOWYL4) TO CAUSE NEXT DIRECTORY BLOCK TO BE READ      */
*/*                                                                  */
*/* ENTRY -- N/A, INLINE SEGMENT (LINKED BY REGISTER 14)             */
*/*                                                                  */
*/* INPUT --                                                         */
*/*    -  UADSREFM ENVIRONMENT                                       */
*/*   -  NEXT USERID NAME IN RESERVED AREA (COMPNAM)                 */
*/*                                                                  */
*/* OUTPUT --                                                        */
*/*   -  DIRECTORY BLOCK HOLDING NEXT USERID IN AREA (CURDIRN)       */
*/*                                                                  */
*/* EXTERNAL REFERENCES -- N/A                                       */
*/*                                                                  */
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */
*/*   CONDITIONS -- N/A                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* EXIT-ERROR -- N/A                                                */
*/*   CONDITIONS -- N/A                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */
*/*                                                                  */
*/********************************************************************/
*RDLOCN:    /* SCAN DIRECTORY BLOCK FOR NEXT NAME                    */
*           ENTRY;                                                 0659
RDLOCN   DS    0H                                                  0660
*           SAVLNKB = R14;          /* SAVE LINK REGISTER            */
         ST    R14,SAVLNKB                                         0660
*           RESPECIFY (R14) UNRESTRICTED;                          0661
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */
*             THEN                  /* NO,                           */
         TM    QUITCHK,B'11100000'                                 0662
         BNZ   @RF00662                                            0662
*               DO;                                                0663
*                                                                  0663
*           DO DOWHYL3 = 1 TO 1;         /* FIND LAST NAME POINTER   */
         LA    @08,1                                               0664
         STH   @08,DOWHYL3                                         0664
@DL00664 DS    0H                                                  0665
*             DRBLASP = DIRBDAP;      /* SET LAST ITEM PTR           */
         L     @08,DIRBDAP                                         0665
         ST    @08,DRBLASP                                         0665
*             DIRBCAX = DIRBCA & MSK1F;  /* CLEAR HIGH ORDER         */
         MVC   DIRBCAX(1),DIRBCA(@08)                              0666
         NC    DIRBCAX(1),MSK1F                                    0666
*             DIRBDAP = DIRBDAP+DIRBC*2+12;    /* SET TO NEXT ITEM   */
         SLR   @15,@15                                             0667
         IC    @15,DIRBC                                           0667
         ALR   @15,@15                                             0667
         ALR   @08,@15                                             0667
         AH    @08,@CH00036                                        0667
         ST    @08,DIRBDAP                                         0667
*             /* CHK IF STILL WITHIN DIRECTORY BLOCK                 */
*             IF DIRBDAP-ADDR(DIRBLKA)<DIRBLNG  /* IS SPAN EXCESSIVE */
*               THEN                  /* NO,                         */
         LA    @15,DIRBLKA                                         0668
         SLR   @08,@15                                             0668
         MVC   @ZT00002+2(2),DIRBLNG                               0668
         C     @08,@ZT00002                                        0668
         BNL   @RF00668                                            0668
*                 DOWHYL3 = 0;        /* GO FOR NEXT ITEM            */
         SLR   @08,@08                                             0669
         STH   @08,DOWHYL3                                         0669
*           END;                                                   0670
*                                                                  0670
@RF00668 LA    @08,1                                               0670
         AH    @08,DOWHYL3                                         0670
         STH   @08,DOWHYL3                                         0670
         CH    @08,@CH00032                                        0670
         BNH   @DL00664                                            0670
*           DIRBDAP=ADDR(DIRBNAM1); /* SET DYNAMIC PTR TO 1ST NAME   */
*                                                                  0671
         LA    @08,DIRBNAM1                                        0671
         ST    @08,DIRBDAP                                         0671
*           DO DOWHYL5 = 1 TO 1;         /* SCAN THROUGN NAMES       */
         LA    @08,1                                               0672
         STH   @08,DOWHYL5                                         0672
@DL00672 DS    0H                                                  0673
*             IF DIRBNAM = ENDMSK  /* CHK FOR END OF DIRECTORY       */
*               THEN               /* YES,                           */
         L     @08,DIRBDAP                                         0673
         CLC   DIRBNAM(8,@08),ENDMSK                               0673
         BNE   @RF00673                                            0673
*                 DO;                                              0674
*                   DIREND = '1'B;  /* SET DIRECTORY EOF FLAG        */
         OI    DIREND,B'01000000'                                  0675
*                   CALL  NOUFND;   /* ISSUE USERID NOT FOUND MSG    */
         BAL   @14,NOUFND                                          0676
*                 END;                                             0677
*               ELSE                /* NOT DIRECTORY EOF             */
*                 DO;                                              0678
         B     @RC00673                                            0678
@RF00673 DS    0H                                                  0679
*                   IF DIRBNAM ^= COMPNAM /* CHK FOR FIRST LEVEL     */
*                     THEN          /* NO,                           */
         L     @08,DIRBDAP                                         0679
         CLC   DIRBNAM(8,@08),COMPNAM                              0679
         BE    @RF00679                                            0679
*                       DO;                                        0680
*                         /* SCAN THROUGH DIRECTORY ITEMS            */
*                         IF DIRBDAP<DRBLASP  /* CHK IF IN BLOCK     */
*                           THEN    /* YES,                          */
         C     @08,DRBLASP                                         0681
         BNL   @RF00681                                            0681
*                             DO;                                  0682
*                               DIRBCAX=DIRBCA&MSK1F; /* CLR HI-ORDR */
         MVC   DIRBCAX(1),DIRBCA(@08)                              0683
         NC    DIRBCAX(1),MSK1F                                    0683
*                               DIRBDAP=  /* LOCATE NEXT ITEM        */
*                                    DIRBDAP+DIRBC*2+12;           0684
         SLR   @15,@15                                             0684
         IC    @15,DIRBC                                           0684
         ALR   @15,@15                                             0684
         ALR   @08,@15                                             0684
         AH    @08,@CH00036                                        0684
         ST    @08,DIRBDAP                                         0684
*                               DOWHYL5 = 0;   /* TO CHK NEW ITEM    */
         SLR   @08,@08                                             0685
         STH   @08,DOWHYL5                                         0685
*                             END;                                 0686
*                           ELSE    /* BLOCK EXHAUSTED               */
*                             DO;                                  0687
         B     @RC00681                                            0687
@RF00681 DS    0H                                                  0688
*                               DOWHYL4=0;   /* TO READ NEXT DIR BLK */
         SLR   @08,@08                                             0688
         STH   @08,DOWHYL4                                         0688
*                               START2=3;   /* SKIP BACKSPACE        */
         MVC   START2(2),@CH00090                                  0689
*                             END;                                 0690
*                       END;                                       0691
*                     ELSE            /* NAME HAS BEEN LOCATED       */
*                       CURDIRN=UADIRENT;  /* RESERVE CURRENT ENTRY  */
         B     @RC00679                                            0692
@RF00679 L     @08,DIRPTR                                          0692
         MVC   CURDIRN(14),UADIRENT(@08)                           0692
*                 END;                                             0693
@RC00679 DS    0H                                                  0694
*           END;                                                   0694
*                                                                  0694
@RC00673 LA    @08,1                                               0694
         AH    @08,DOWHYL5                                         0694
         STH   @08,DOWHYL5                                         0694
         CH    @08,@CH00032                                        0694
         BNH   @DL00672                                            0694
*               END;                                               0695
*           RESPECIFY (R14) RESTRICTED;                            0696
@RF00662 DS    0H                                                  0697
*           R14 = SAVLNKB;          /* RESTORE LINK REGISTER         */
         L     R14,SAVLNKB                                         0697
*           RETURN;                 /* RETURN                        */
         B     @EL00003                                            0698
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -- RBLDIN                                           */
*/*                                                                  */
*/* DESCRIPTIVE NAME -- N/A                                          */
*/*                                                                  */
*/* FUNCTION -- SETUP TO SCAN AND REFORM THE MEMBER IN RINBUF        */
*/*   OPERATION --                                                   */
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP RBLDIN FUNCTION  */
*/*   -  SET POINTER (OLDLOC) AND OFFSET (OUOFDAT) IN INPUT REBUILD- */
*/*      CONTROL TABLE (OLRPL)                                       */
*/*   -  SET INITIAL END-OF-CHAIN FLAGS AT ALL LEVELS                */
*/*   -  SET POINTER (NUDLOC) AND OFFSET (NUOFDAT) INTO THE OUTPUT   */
*/*      REBUILD-CONTROL TABLE (NLRPL)                               */
*/*   -  SET INITIAL (TEMPORARY) DATA POINTERS AT ALL LEVELS         */
*/*   -  SET INITIAL LEVEL OF MODIFICATION (TSTLVL) AT PASSWORD      */
*/*      LEVEL (OPOFFS)                                              */
*/*   -  SET MAXIMUM LEVEL OF MODIFICATION (TOPLVL) AT PROCEDURE     */
*/*      NAME LEVEL (OROFFS)                                         */
*/*   -  RESET LEVEL-CHAINING FLAG  (CHAINOW)                         *
*/*   -  SET HEADER BLOCK MAPPING MACRO BASE POINTER (HEDBPTR) TO    */
*/*      OUTPUT BUFFER LOCATION (REXBUFP)                            */
*/*   -  SET UADS BLOCK LENGTH (UADSBLNG) EQUAL TO ALLOCATED BLOCK   */
*/*      LENGTH (DCBLRECL) FOR OUTPUT (SYSUADS)                      */
*/*   -  SET OFFSET TO 1ST FREE SPACE QUEUE ELEMENT (UADSFSQP) TO    */
*/*      LOCATION IMMEDIATELY FOLLOWING HEADER BLOCK AND SET POINTER */
*/*      TO 1ST FSQE IN OUTPUT BUFFER (FSQEPTR)                      */
*/*   -  SET INITIAL FSQE LENGTH EQUAL TO BLOCK LENGTH LESS HEADER   */
*/*      BLOCK LENGTH AND ROUND DOWN TO NEAREST HALFWORD VALUE       */
*/*   -  INDICATE THE FSQE JUST LOCATED IS LAST FREE SPACE ELEMENT   */
*/*      WITH ZERO IN LINKING OFFSET                                 */
*/*   -  CALL SEGMENT DOGETSP TO ACQUIRE SPACE IN OUTPUT MEMBERBLOCK */
*/*      (VIA ACCOUNT-GETSPACE) FOR USER PROFILE TABLE AREA WITH A   */
*/*      LENGTH FROM IKJUPT (SPZBLNG).  SET OFFSET TO SPACE ACQUIRED */
*/*      IN UPT OFFSET AREA (UADSUPTP) IN OUTPUT HEADER BLOCK        */
*/*   -  REALIGN HEADER BLOCK MAP WITH INPUT BUFFER BY SETTING THE   */
*/*      HEADER BLOCK BASE POINTER (HEDBPTR) TO LOCATION OF INPUT    */
*/*      BUFFER (RINBUFP)                                            */
*/*   -  (RESTORE THE ENTRY LINK REGISTER 14 AND RETURN              */
*/*                                                                  */
*/* ENTRY -- N/A, INLINE SEGMENT (PSEUDO, LINKED BY REGISTER 14)     */
*/*                                                                  */
*/* INPUT --                                                         */
*/*   -  UADSREFM ENVIRONMENT                                        */
*/*   -  POINTER TO OUTPUT BUFFER (REXBUFP)                          */
*/*   -  POINTER TO INPUT BUFFER (RINBUFP)                           */
*/* SEGMENT NAME -- RBLDIN  (CONTINUED)                              */
*/*                                                                  */
*/* OUTPUT --                                                        */
*/*   -  USERID LEVEL OF INPUT (OLRPL) AND OUTPUT (NLRPL) REBUILD-   */
*/*      CONTROL TABLES INITIALIZED                                  */
*/*   -  BLOCK LENGTH, OFFSET TO 1ST FSQE, 1ST FSQE AND OFFSET TO    */
*/*      UPT AREA SET IN OUTPUT HEADER BLOCK                         */
*/*                                                                  */
*/* EXTERNAL REFERENCES -- N/A                                       */
*/*                                                                  */
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */
*/*   CONDITIONS -- N/A                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* EXIT-ERROR -- N/A                                                */
*/*   CONDITIONS -- N/A                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */
*/*                                                                  */
*/********************************************************************/
*RBLDIN:    /* SET UP TO SCAN AND REFORM THE MEMBER IN RINBUF        */
*                                                                  0699
*           ENTRY;                                                 0699
RBLDIN   DS    0H                                                  0700
*           SAVLNKB = R14;          /* SAVE LINK REGISTER            */
         ST    R14,SAVLNKB                                         0700
*           RESPECIFY (R14) UNRESTRICTED;                          0701
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */
*             THEN                  /* NO,                           */
         TM    QUITCHK,B'11100000'                                 0702
         BNZ   @RF00702                                            0702
*               DO;                                                0703
*                                                                  0703
*           OUDLOC = ADDR(RINBUF)+4;   /* PTR TO INPUT USERID NAME   */
         LA    @08,4                                               0704
         L     @15,RINBUFP                                         0704
         ALR   @15,@08                                             0704
         ST    @15,OUDLOC                                          0704
*           OUOFDAT = 4;            /* OFFSET TO INPUT USERID NAME   */
         ST    @08,OUOFDAT                                         0705
*           NPOFLG1 = '1'B;         /* SET PASSWORD NO-CHAIN FLAG    */
         OI    NPOFLG1,B'10000000'                                 0706
*           NAOFLG1 = '1'B;         /* SET ACCTNMBR NO-CHAIN FLAG    */
         OI    NAOFLG1,B'10000000'                                 0707
*           NROFLG1 = '1'B;         /* SET PROCNAME NO-CHAIN FLAG    */
         OI    NROFLG1,B'10000000'                                 0708
*           NUDLOC = ADDR(REXBUF)+4;  /* PTR TO OUTPUT USERID NAME   */
         L     @15,REXBUFP                                         0709
         LR    @14,@15                                             0709
         ALR   @14,@08                                             0709
         ST    @14,NUDLOC                                          0709
*           NUOFDAT = 4;            /* OFFSET TO OUTPUT USERID NAME  */
         ST    @08,NUOFDAT                                         0710
*           NPFLOC = ADDR(NROFDAT); /* INITIAL NCURUNEX - PASSWORD   */
         LA    @08,NROFDAT                                         0711
         ST    @08,NPFLOC                                          0711
*           NAFLOC = ADDR(NROFDAT); /* INITIAL NCURUNEX - ACCTNAME   */
         ST    @08,NAFLOC                                          0712
*           NRFLOC = ADDR(NROFDAT); /* INITIAL NCURUNEX - PROCNAME   */
         ST    @08,NRFLOC                                          0713
*           TSTLVL = ADDR(OPOFFS);  /* INITIAL LEVEL OF MODIFICATION */
         LA    @08,OPOFFS                                          0714
         ST    @08,TSTLVL                                          0714
*           TOPLVL = ADDR(OROFFS);  /* MAXIMUM MODIFICATION LEVEL    */
         LA    @08,OROFFS                                          0715
         ST    @08,TOPLVL                                          0715
*           CHAINOW = '0'B;         /* INITIALIZE FOR NO CHAINING    */
         NI    CHAINOW,B'01111111'                                 0716
*           HEDBPTR = REXBUFP;      /* SET MAP TO OUTPUT UADS        */
*                                                                  0717
         ST    @15,HEDBPTR                                         0717
*           IDINCB = 1;             /* INITIALIZE FOR CURRENT BLOCK  */
         MVC   IDINCB(2),@CH00032                                  0718
*           SPAZPB=SPAZPB&&SPAZPB;  /* INITIALIZE GETSPACE PB        */
         XC    SPAZPB(12),SPAZPB                                   0719
*           SPZBLNG = LENGTH(UPT);  /* LENGTH OF UPT AREA            */
         MVC   SPZBLNG(2),@CH00049                                 0720
*           CALL  DOGETSP;          /* GET ASSIGNED SPACE            */
         BAL   @14,DOGETSP                                         0721
*           UADSUPTP = SPZBLOC;     /* SET OFFSET TO UPT AREA        */
         L     @08,HEDBPTR                                         0722
         L     @15,SPZBLOC                                         0722
         ST    @15,UADSUPTP(,@08)                                  0722
*           RESPECIFY  (UPT) BASED(HEDBPTR+UADSUPTP);              0723
*           UPT=(RINBUFP+(RINBUFP->UADSUPTP))->UPT; /* COPY OLD UPT  */
         ALR   @08,@15                                             0724
         L     @15,RINBUFP                                         0724
         LR    @14,@15                                             0724
         AL    @14,UADSUPTP(,@15)                                  0724
         MVC   UPT(24,@08),UPT(@14)                                0724
*           IF RINBUFP->UADSEXPF = '0'B/* NEW FORMAT INPUT   OA00910 */
*             THEN                  /* NO,                   OA00910 */
         TM    UADSEXPF(@15),B'01000000'                           0725
         BNZ   @RF00725                                            0725
*               DO;                 /*                       OA00910 */
*                 UPTPREFL=NODIDL;  /* INSERT LNG OF PREFIS  OA00910 */
         LH    @15,NODIDL                                          0727
         STC   @15,UPTPREFL(,@08)                                  0727
*                 UPTPREFX='       ';/*                            0728
*                                      BLANK OUT CHAR AREA   OA00910 */
         MVC   UPTPREFX(7,@08),@CC01934                            0728
*                 UPTPREFX(1:NODIDL)=NODIDC;  /* SET PREFIX  OA00910 */
         BCTR  @15,0                                               0729
         EX    @15,@SM02090                                        0729
*                END;               /*                       OA00910 */
*           IF RINBUFP->UADSEXPF = '1'B&/*                         0731
*                                         IF INPUT UADS      @ZA10449*/
*              RINBUFP->UADSPERP ^= 0  /* HAD PREFORM GROUPS @ZA10449*/
*             THEN DO;                 /* COPY TO NEW UADS   @ZA10449*/
@RF00725 L     @08,RINBUFP                                         0731
         TM    UADSEXPF(@08),B'01000000'                           0731
         BNO   @RF00731                                            0731
         L     @08,UADSPERP(,@08)                                  0731
         LTR   @08,@08                                             0731
         BZ    @RF00731                                            0731
*               SPAZPB=SPAZPB&&SPAZPB; /* CLEAR PARM LIST    @ZA10449*/
         XC    SPAZPB(12),SPAZPB                                   0733
*               SPZBLNG = LENGTH(PERFGRP);  /* SET LENGTH    @ZA10449*/
         MVC   SPZBLNG(2),@CH00113                                 0734
*               CALL DOGETSP;          /* OBTAIN SPACE       @ZA10449*/
         BAL   @14,DOGETSP                                         0735
*               UADSPERP = SPZBLOC;         /* POINT TO SPACE@ZA10449*/
         L     @08,HEDBPTR                                         0736
         L     @15,SPZBLOC                                         0736
         ST    @15,UADSPERP(,@08)                                  0736
*               RESPECIFY (PERFGRP) BASED(HEDBPTR+UADSPERP);       0737
*                                   /* SET BASE FOR PERF GRP @ZA10449*/
*               PERFGRP=(RINBUFP+(RINBUFP->UADSPERP))->PERFGRP;    0738
         ALR   @08,@15                                             0738
         L     @15,RINBUFP                                         0738
         LR    @14,@15                                             0738
         AL    @14,UADSPERP(,@15)                                  0738
         MVC   PERFGRP(32,@08),PERFGRP(@14)                        0738
*             END;                  /* COPY PERF GOUPS       @ZA10449*/
*           HEDBPTR = RINBUFP;      /* RESTORE MAP TO INPUT UADS     */
@RF00731 L     @08,RINBUFP                                         0740
         ST    @08,HEDBPTR                                         0740
*           IF UADSEXPF = '1'B      /* CHK IF INPUT IS NEW FORMAT    */
*             THEN                  /* YES,                          */
         TM    UADSEXPF(@08),B'01000000'                           0741
         BNO   @RF00741                                            0741
*               CURNEW = '1'B;      /* SET NEW FORMAT FLAG           */
         OI    CURNEW,B'10000000'                                  0742
*             ELSE                  /* INPUT UADS IS OLD FORMAT      */
*               CURNEW = '0'B;      /* RESET NEW FORMAT FLAG         */
*                                                                  0743
         B     @RC00741                                            0743
@RF00741 NI    CURNEW,B'01111111'                                  0743
*               END;                                               0744
@RC00741 DS    0H                                                  0745
*           RESPECIFY (R14) RESTRICTED;                            0745
@RF00702 DS    0H                                                  0746
*           R14 = SAVLNKB;          /* RESTORE LINK REGISTER         */
         L     R14,SAVLNKB                                         0746
*           RETURN;                 /* RETURN                        */
         B     @EL00003                                            0747
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -- RITEM                                            */
*/*                                                                  */
*/* DESCRIPTIVE NAME -- N/A                                          */
*/*                                                                  */
*/* FUNCTION -- BUILD NEW USERID MEMBER -- BUILD OFFSET BLOCK        */
*/*   OPERATION --                                                   */
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */
*/*   -  IF TERMINATION FLAG (QUITCHK( IS SET, SKIP RITEM FUNCTION   */
*/*   -  FIND NEXT OFFSET BLOCK IN INPUT UADS (RINBUF),  IF OFFSET   */
*/*      BLOCK IS CHAINED TO NEXT OFFSET ON SAME LEVEL, BY ADDING    */
*/*      LATERAL OFFSET (ONMFNX2) AND LOCATION OF THE MEMBER BLOCK   */
*/*      (RINBUFP).  IF OFFSET BLOCK IS NOT CHAINED, ADD THE OFFSET  */
*/*      (ONFSUB1) OF SUBLEVEL OFFSET BLOCK TO LOCATION OF MEMBER    */
*/*      BLOCK (RINBUFP)                                             */
*/*   -  COPY THE LOCATED OFFSET BLOCK (OCRUNODE) INTO THE INPUT     */
*/*      REBUILD-CONTROL TABLE (ONMOFS2)                             */
*/*   -  IF CURRENT INPUT LEVEL CONTAINS A DATA BLOCK (OFFSET VALUE  */
*/*      IN ONFDAT2), SET DATA BLOCK POINTER (ONDLOC2) TO LOCATION   */
*/*      SPECIFIED BY THAT OFFSET LEVEL PLUS LOCATION OF INPUT       */
*/*      BUFFER (RINBUFP).  OTHERWISE, SET THE DATA BLOCK POINTER    */
*/*      (ONDLOC2) TO ZERO                                           */
*/*   -  CALL SEGMENT DOGETSP TO OBTAIN OFFSET BLOCK SPACE (VIA THE  */
*/*      ACCOUNT-GETSPACE ROUTINE)                                   */
*/*   -  IF LATERAL CHAINING IS NOT CURRENTLY ACTIVE (CHAINOW), SET  */
*/*      ACQUIRED SPACE OFFSET IN PRIOR LEVELS SUBLEVEL OFFSET POSI- */
*/*      TION IN THE OUTPUT REBUILD-CONTROL TABLE (NNFSUB1) AND IN   */
*/*      THE OUTPUT IMAGE (NLASUSUB).                                */
*/*   -  SET  ACQUIRED OFFSET  IN CURRENT NEXT-INCIDENCE-OF-LEVEL    */
*/*      POSITION IN OUTPUT IMAGE (NCURUNEX)                         */
*/*   -  IF INPUT  CONTROL-LATERAL-CHAINING  FLAG (ONFLG21)  IS SET  */
*/*      THEN SET OUTPUT CONTROL FLAG ON (NNFLG21).  ELSE SET FLAG   */
*/*      OFF (NNFLG21)                                               */
*/*   -  FORM POINTER TO OUTPUT IMAGE OF NEW OFFSET BLOCK BY ADDING  */
*/*      NEW OFFSET PLUS OUTPUT BUFFER LOCATION AND PLACE SUM IN THE */
*/*      OUTPUT CONTROL TABLE CURRENT OFFSET BLOCK POINTER (NNFLOC2) */
*/*   -  IF LATERAL CHAINING FLAG IS ON IN OUTPUT CONTROL TABLE      */
*/*      (NNFLG21) SET CHAINING FLAG ON IN OUTPUT IMAGE (NCURUFLG).  */
*/*      OTHERWISE, SET FLAG OFF (NCURUFLG).                         */
*/*   -  PERFORM SEGMENT RITEM2 TO BUILD ASSOCIATED DATA BLOCK       */
*/*   -  RESET CURRENT NEXT-INCIDENCE-OF-LEVEL POSITION IN OUTPUT    */
*/*      CONTROL TABLE (NNMFNX2).  RESET CURRENT NEXT-INCIDENCE AND  */
*/*      CURRENT SUBLEVEL POSITIONS IN NEW OFFSET BLOCK IN OUTPUT    */
*/*      IMAGE (NCURUNEX AND NCURUSUB, BOTH BASED ON UPDATED POINTER */
*/*      NNFLOC2)                                                    */
*/*   -  (RESTORE ENTRY LINK REGISTER 14 AND RETURN)                 */
*/* SEGMENT NAME -- RITEM  (CONTINUED)                               */
*/*                                                                  */
*/* ENTRY -- N/A, INLINE SEGMENT (PSEUDO, LINKED BY REGISTER 14)     */
*/*                                                                  */
*/* INPUT --                                                         */
*/*   -  UADSREFM ENVIRONMENT                                        */
*/*                                                                  */
*/* OUTPUT --                                                        */
*/*   -  OUTPUT OFFSET BLOCK BUILT (DATA BLOCK BUILT VIA RITEM2)     */
*/*                                                                  */
*/* EXTERNAL REFERENCES -- N/A                                       */
*/*                                                                  */
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */
*/*   CONDITIONS -- N/A                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* EXIT-ERROR -- N/A                                                */
*/*   CONDITIONS -- N/A                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */
*/*                                                                  */
*/********************************************************************/
*RITEM:     /* BUILD NEW USERID MEMBER -- BUILD OFFSET BLOCK DATA    */
*           ENTRY;                                                 0748
RITEM    DS    0H                                                  0749
*           SAVLNKB = R14;          /* SAVE LINK REGISTER            */
         ST    R14,SAVLNKB                                         0749
*           RESPECIFY (R14) UNRESTRICTED;                          0750
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG  ?       */
*             THEN                  /* NO,                           */
         TM    QUITCHK,B'11100000'                                 0751
         BNZ   @RF00751                                            0751
*               DO;                 /* ESTABLISH OFFSET BLOCK        */
*                                                                  0752
*           IF CHAINOW = '0'B       /* CURRENTLY CHAINING NOW ?      */
*             THEN                  /* NO,                           */
         TM    CHAINOW,B'10000000'                                 0753
         BNZ   @RF00753                                            0753
*               ONFLOC2 = ONFSUB1 + ADDR(RINBUF); /* IS SUBLVL       */
         L     @08,ONMIDP                                          0754
         L     @15,ONFSUB1(,@08)                                   0754
         AL    @15,RINBUFP                                         0754
         ST    @15,ONFLOC2(,@08)                                   0754
*             ELSE                  /* YES,                          */
*               ONFLOC2 = ONMFNX2+ADDR(RINBUF); /* IS NEXT LVL       */
         B     @RC00753                                            0755
@RF00753 L     @08,ONMIDP                                          0755
         L     @15,ONMFNX2-1(,@08)                                 0755
         LA    @15,0(,@15)                                         0755
         AL    @15,RINBUFP                                         0755
         ST    @15,ONFLOC2(,@08)                                   0755
*           ONMOFS2 = OCRUNODE;     /* RESERVE CURRENT OFFSET BLK    */
@RC00753 L     @08,ONMIDP                                          0756
         L     @01,ONFLOC2(,@08)                                   0756
         MVC   ONMOFS2(12,@08),OCRUNODE(@01)                       0756
*           IF ONFDAT2 ^= 0         /* CHK FOR ANY DATA FIELD        */
*             THEN                  /** YES,                         */
         L     @15,ONFDAT2(,@08)                                   0757
         LTR   @15,@15                                             0757
         BZ    @RF00757                                            0757
*               ONDLOC2 = ONFDAT2+ADDR(RINBUF);  /* SET OFFSET       */
         AL    @15,RINBUFP                                         0758
         ST    @15,ONDLOC2(,@08)                                   0758
*             ELSE                  /* NO DATA FIELD                 */
*               ONDLOC2 = 0;        /* CLEAR OFFSET                  */
*                                                                  0759
         B     @RC00757                                            0759
@RF00757 L     @08,ONMIDP                                          0759
         SLR   @15,@15                                             0759
         ST    @15,ONDLOC2(,@08)                                   0759
*           SPZBLNG = 12;           /* SET LENGTH OF OFFSET BLOCK    */
@RC00757 MVC   SPZBLNG(2),@CH00036                                 0760
*           CALL  DOGETSP;          /* GET SPACE FOR OFFSET BLOCK    */
*                                                                  0761
         BAL   @14,DOGETSP                                         0761
*           IF CHAINOW = '0'B       /* CURRENTLY CHAINING NOW ?      */
*             THEN                  /* NO,                           */
         TM    CHAINOW,B'10000000'                                 0762
         BNZ   @RF00762                                            0762
*               DO;                                                0763
*                 NNFSUB1 = SPZBLOC;  /* SET SUBLEVEL OFFSET         */
         L     @08,SPZBLOC                                         0764
         L     @15,NNMIDP                                          0764
         ST    @08,NNFSUB1(,@15)                                   0764
*                 NLASUSUB = SPZBLOC; /*    AND IN BUFFER            */
         L     @01,NNFLOC1(,@15)                                   0765
         ST    @08,@TF00001                                        0765
         MVC   NLASUSUB(3,@01),@TF00001+1                          0765
*               END;                                               0766
*           NCURUNEX = SPZBLOC;     /* SET NEXT OFFSET IN BUFFER     */
@RF00762 L     @08,NNMIDP                                          0767
         L     @01,NNFLOC2(,@08)                                   0767
         MVC   NCURUNEX(3,@01),SPZBLOC+1                           0767
*           NNFLG21='0'B;           /* CLEAR NEW CHAINING FLAG       */
         NI    NNFLG21(@08),B'01111111'                            0768
*           IF ONFLG21='1'B         /* CHK IF OLD FLAG ON            */
*             THEN                  /* YES,                          */
         L     @01,ONMIDP                                          0769
         TM    ONFLG21(@01),B'10000000'                            0769
         BNO   @RF00769                                            0769
*               NNFLG21='1'B;       /* SET NEW FLAG ON               */
         OI    NNFLG21(@08),B'10000000'                            0770
*           NNFLOC2 = SPZBLOC + ADDR(REXBUF); /* SET OB PTR          */
@RF00769 L     @08,NNMIDP                                          0771
         L     @15,SPZBLOC                                         0771
         AL    @15,REXBUFP                                         0771
         ST    @15,NNFLOC2(,@08)                                   0771
*           NCURUFLG='0'B;          /* SET NEW FLAG OFF              */
         NI    NCURUFLG(@15),B'01111111'                           0772
*           IF NNFLG21='1'B         /* CHK IF LEVEL FLAG ON          */
*             THEN                  /* YES,                          */
         TM    NNFLG21(@08),B'10000000'                            0773
         BNO   @RF00773                                            0773
*               NCURUFLG='1'B;      /* SET NEW FLAG ON               */
*                                                                  0774
         OI    NCURUFLG(@15),B'10000000'                           0774
*           CALL  RITEM2;           /* ESTABLISH DATA BLOCK          */
*                                                                  0775
@RF00773 BAL   @14,RITEM2                                          0775
*           NNMFNX2 = 0;            /*       CLEAR                   */
         L     @08,NNMIDP                                          0776
         SLR   @15,@15                                             0776
         ST    @15,@TF00001                                        0776
         MVC   NNMFNX2(3,@08),@TF00001+1                           0776
*           NCURUNEX = 0;           /*   CURRENT LEVEL               */
         L     @08,NNFLOC2(,@08)                                   0777
         SLR   @15,@15                                             0777
         ST    @15,@TF00001                                        0777
         MVC   NCURUNEX(3,@08),@TF00001+1                          0777
*           NCURUSUB = 0;           /*      OFFSETS                  */
*                                                                  0778
         SLR   @15,@15                                             0778
         ST    @15,@TF00001                                        0778
         MVC   NCURUSUB(3,@08),@TF00001+1                          0778
*               END;                                               0779
*           RESPECIFY (R14) RESTRICTED;                            0780
@RF00751 DS    0H                                                  0781
*           R14 = SAVLNKB;          /* RESTORE LINK REGISTER         */
         L     R14,SAVLNKB                                         0781
*           RETURN;                 /* RETURN                        */
         B     @EL00003                                            0782
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -- ADJLVL                                           */
*/*                                                                  */
*/* DESCRIPTIVE NAME -- N/A                                          */
*/*                                                                  */
*/* FUNCTION -- ADJUST LEVEL POINTERS TO SCAN AND REBUILD NEXT       */
*/*             AUTHORIZATION PATH SEGMENT                           */
*/*   OPERATION --                                                   */
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP ADJLVL FUNCTION  */
*/*   -  SET NOT-CURRENTLY-CHAINING FLAG (CHAINOW)                   */
*/*   -  IF CURRENTLY PROCESSED LEVEL (TSTLVL) WAS HIGHEST AUTHORI-  */
*/*      ZATION LEVEL (TOPLVL), THEN IF INPUT CURRENT NEXT-INCIDENCE-*/
*/*      OF-LEVEL OFFSET EXISTS (ONMIFNX2) SET CONTROL FLAG (DOWHYL) */
*/*      TO CONTINUE PROCESSING MEMBER.  IF INPUT CURRENT LEVEL      */
*/*      AUTHORIZATION PATH ENDS (ONFLG21)(NOT CHAINED) THEN REDUCE  */
*/*      POINTERS TO PROCESS PREVIOUS LEVEL (TSTLVL, ONMIDP, NNMIDP) */
*/*      AND SET CONTROL FLAG TO REPEAT CHECK UNTIL LOWEST LEVEL, OR */
*/*      A LEVEL WHICH IS CHAINED, IS REACHED.  WHEN A CHAINED INPUT */
*/*      LEVEL IS ENCOUNTERED, THE CURRENTLY-CHAINING FLAG (CHAINOW) */
*/*      IS SET                                                      */
*/*   -  IF CURRENTLY PROCESSED LEVEL WAS NOT HIGHEST LEVEL, STEP    */
*/*      CONTROL POINTERS TO NEXT LEVEL (TSTLVL, ONMIDP, NNMIDP) AND */
*/*      SET CONTROL FLAG (DOWHYL) TO CONTINUE PROCESSING            */
*/*   -  (RESTORE ENTRY LINK REGISTER 14 AND RETURN)                 */
*/*                                                                  */
*/* ENTRY -- N/A, INLINE SEGMENT (PSEUDO, LINKED BY REGISTER 14)     */
*/*                                                                  */
*/* INPUT --                                                         */
*/*   -  UADSREFM ENVIRONMENT                                        */
*/*                                                                  */
*/* OUTPUT --                                                        */
*/*   -  CONTROL POINTERS SET TO NEXT REBUILD LEVEL                  */
*/*                                                                  */
*/* EXTERNAL REFERENCES -- N/A                                       */
*/*                                                                  */
*/* EXIT-NORMAL -- N/A                                               */
*/*   CONDITIONS -- N/A                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* EXIT-ERROR -- N/A                                                */
*/*   CONDITIONS -- N/A                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */
*/*                                                                  */
*/********************************************************************/
*ADJLVL:    /* ADJUST LEVEL PTRS TO SCAN AND REFORM NEXT ITEM/PATH   */
*           ENTRY;                                                 0783
ADJLVL   DS    0H                                                  0784
*           SAVLNKB = R14;          /* SAVE LINK REGISTER            */
         ST    R14,SAVLNKB                                         0784
*           RESPECIFY (R14) UNRESTRICTED;                          0785
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */
*             THEN                  /* NO,                           */
         TM    QUITCHK,B'11100000'                                 0786
         BNZ   @RF00786                                            0786
*               DO;                                                0787
*                                                                  0787
*           CHAINOW = '0'B;         /* SET NOT-CHAINING FLAG         */
         NI    CHAINOW,B'01111111'                                 0788
*           IF TSTLVL = TOPLVL      /* CHK FOR END OF PATH           */
*             THEN                  /* YES,                          */
         CLC   TSTLVL(4),TOPLVL                                    0789
         BNE   @RF00789                                            0789
*               DO;                                                0790
*                 IF ONMFNX2 ^= 0     /* CHK FOR LATERAL CHAIN       */
*                   THEN            /* YES,                          */
         L     @08,ONMIDP                                          0791
         L     @08,ONMFNX2-1(,@08)                                 0791
         LA    @08,0(,@08)                                         0791
         LTR   @08,@08                                             0791
         BZ    @RF00791                                            0791
*                     DO DOWHYL2 = 1 TO 1;         /* TO BACK-SCAN   */
         LA    @08,1                                               0792
         STH   @08,DOWHYL2                                         0792
@DL00792 DS    0H                                                  0793
*                       DOWHYL = 0;   /* TO CONTINUE PROCESSING MBR  */
         SLR   @08,@08                                             0793
         STH   @08,DOWHYL                                          0793
*                       IF ONFLG21 = '1'B /* CHK FOR LOCAL PATH END  */
*                         THEN      /* YES,                          */
         L     @15,ONMIDP                                          0794
         TM    ONFLG21(@15),B'10000000'                            0794
         BNO   @RF00794                                            0794
*                           DO;                                    0795
*                             TSTLVL=TSTLVL-LSPAN; /* BKSP TOP TEST  */
         L     @14,LSPAN                                           0796
         L     @07,TSTLVL                                          0796
         SLR   @07,@14                                             0796
         ST    @07,TSTLVL                                          0796
*                             ONMIDP=ONMIDP-LSPAN; /* BKSP INPUT PTR */
         SLR   @15,@14                                             0797
         ST    @15,ONMIDP                                          0797
*                             NNMIDP=NNMIDP-LSPAN; /* BKSP OUTPUT PT */
         LCR   @14,@14                                             0798
         AL    @14,NNMIDP                                          0798
         ST    @14,NNMIDP                                          0798
*                             DOWHYL2 = 0;  /* TO CHK PREVIOUS LEVEL */
         STH   @08,DOWHYL2                                         0799
*                           END;                                   0800
*                         ELSE      /* NOT END OF LOCAL PATH,        */
*                           CHAINOW = '1'B; /* SET CHAINING-NOW FLAG */
         B     @RC00794                                            0801
@RF00794 OI    CHAINOW,B'10000000'                                 0801
*                     END;                                         0802
@RC00794 LA    @08,1                                               0802
         AH    @08,DOWHYL2                                         0802
         STH   @08,DOWHYL2                                         0802
         CH    @08,@CH00032                                        0802
         BNH   @DL00792                                            0802
*               END;                                               0803
*             ELSE                  /* NOT END OF PATH,              */
*               DO;                 /* SET POINTERS TO NEXT LEVEL    */
         B     @RC00789                                            0804
@RF00789 DS    0H                                                  0805
*                 TSTLVL = TSTLVL+LSPAN;  /* STEP TOP TEST           */
         L     @08,LSPAN                                           0805
         L     @15,TSTLVL                                          0805
         ALR   @15,@08                                             0805
         ST    @15,TSTLVL                                          0805
*                 ONMIDP=ONMIDP+LSPAN;  /* STEP INPUT POINTER        */
         L     @15,ONMIDP                                          0806
         ALR   @15,@08                                             0806
         ST    @15,ONMIDP                                          0806
*                 NNMIDP=NNMIDP+LSPAN;  /* STEP OUTPUT POINTER       */
         AL    @08,NNMIDP                                          0807
         ST    @08,NNMIDP                                          0807
*                 DOWHYL = 0;       /* TO CONTINUE PROCESSING MEMBER */
         SLR   @08,@08                                             0808
         STH   @08,DOWHYL                                          0808
*               END;                                               0809
*                                                                  0809
*               END;                                               0810
@RC00789 DS    0H                                                  0811
*           RESPECIFY (R14) RESTRICTED;                            0811
@RF00786 DS    0H                                                  0812
*           R14 = SAVLNKB;          /* RESTORE LINK REGISTER         */
         L     R14,SAVLNKB                                         0812
*           RETURN;                 /* RETURN                        */
         B     @EL00003                                            0813
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -- RENQM2                                           */
*/*                                                                  */
*/* DESCRIPTIVE NAME -- N/A                                          */
*/*                                                                  */
*/* FUNCTION -- CHECK RETURN CODE FOR ENQ ON SYSIKJUA/'USERID NAME'  */
*/*   OPERATION --                                                   */
*/*    - SAVE ENTRY LINK REGISTER 14                                 */
*/*    - IF RETURN CODE IS SUCCESSFUL (CODE 0 OR CODE 8), RETURN     */
*/*      IMMEDIATELY                                                 */
*/*    - IF RETURN CODE IS NOT SUCCESSFUL, SET USERID PROCESSING     */
*/*      TERMINATION FLAG (UIDQUIT)                                  */
*/*    - IF RETURN CODE IS 4, ISSUE ERROR MESSAGE 6                  */
*/*    - IF ANY OTHER FAILURE RETURN CODE, ISSUE ERROR MESSAGE 13    */
*/*    - RESTORE ENTRY LINK REGISTER 14 AND RETURN                   */
*/*                                                                  */
*/* ENTRY -- N/A, INLINE SEGMENT (PSEUDO, LINKED BY REGISTER 14)     */
*/*                                                                  */
*/* INPUT --                                                         */
*/*   -  UADSREFM ENVIRONMENT                                        */
*/*   -  POINTER TO RETURN CODE IN RCLC1                             */
*/*                                                                  */
*/* OUTPUT --                                                        */
*/*                                                                  */
*/* EXTERNAL REFERENCES -- N/A                                       */
*/*                                                                  */
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */
*/*   CONDITIONS -- N/A                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* EXIT-ERROR --                                                    */
*/*   CONDITIONS -- N/A                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */
*/*                                                                  */
*/********************************************************************/
*RENQM2:    /* CHECK RETURN CODE FOR ENQ ON USERID MEMBER NAME       */
*           ENTRY;                                                 0814
RENQM2   DS    0H                                                  0815
*           SAVLNKB = R14;          /* SAVE LINK REGISTER            */
         ST    R14,SAVLNKB                                         0815
*           RESPECIFY (R14) UNRESTRICTED;                          0816
*                                                                  0816
*           IF RCLC1^=0             /* CHK FOR UNSATISFACTORY        */
*               & RCLC1^=8          /*     RETURN CODE               */
*             THEN                  /* YES,                          */
         L     @08,RCPTR                                           0817
         CLI   RCLC1(@08),0                                        0817
         BE    @RF00817                                            0817
         CLI   RCLC1(@08),8                                        0817
         BE    @RF00817                                            0817
*               DO;                                                0818
*                 UIDQUIT = '1'B;   /* SET USERID TERMINATION FLAG   */
         OI    UIDQUIT,B'10000000'                                 0819
*                 IF RCLC1 = 4      /* CHK IF USERID IN USE          */
*                   THEN            /* YES,                          */
         CLI   RCLC1(@08),4                                        0820
         BNE   @RF00820                                            0820
*                     DO;                                          0821
*                       MSGNO = 6;  /* SET MESSAGE INDEX             */
         MVC   MSGNO(2),@CH00118                                   0822
*                       CALL  MSGFNDR;  /* LOCATE MESSAGE TEXT       */
         BAL   @14,MSGFNDR                                         0823
*                       TMSGNS1(1:20)=TMXMDL;  /* SEGMENT LIST       */
         L     @08,MSGPTR                                          0824
         MVC   TMSGNS1(20),TMXMDL(@08)                             0824
*                       TMSGNP13=ADDR(TMSGTIX1);  /* 3RD SEGMENT     */
         LA    @08,TMSGTIX1                                        0825
         ST    @08,TMSGNP13                                        0825
*                       TMSGTIL1 = NODIDL+4;   /* LENGTH OF SEGMENT  */
         LH    @08,NODIDL                                          0826
         LA    @01,4(,@08)                                         0826
         STH   @01,TMSGTIL1                                        0826
*                       TMSGTIO1 = 9;   /* SET INSERT OFFSET         */
         MVC   TMSGTIO1(2),@CH00033                                0827
*                       TMSGTIN1(1:NODIDL)  /* INSERT USERID         */
*                           =NODIDC(1:NODIDL);  /*  TEXT             */
         BCTR  @08,0                                               0828
         EX    @08,@SM02092                                        0828
*                       MSGPTR = ADDR(TMSGNS1);  /* TEXT PTR         */
         LA    @08,TMSGNS1                                         0829
         ST    @08,MSGPTR                                          0829
*                       CALL FXPUTL;  /* INITIALIZE PARM BLOCK       */
         BAL   @14,FXPUTL                                          0830
*                       CALL  DOPUTL; /* GO TO ISSUE MESSAGE         */
         BAL   @14,DOPUTL                                          0831
*                     END;                                         0832
*                   ELSE            /* NOT RETURN CODE 4             */
*                     DO;                                          0833
         B     @RC00820                                            0833
@RF00820 DS    0H                                                  0834
*                       RTNCODE = RCLC1;  /* SET FOR TEXT            */
         L     @08,RCPTR                                           0834
         SLR   @15,@15                                             0834
         IC    @15,RCLC1(,@08)                                     0834
         ST    @15,RTNCODE                                         0834
*                       MSGNO = 13;   /* SET MESSAGE INDEX           */
         MVC   MSGNO(2),@CH01676                                   0835
*                       SOFFS = 20;   /* SET INSERT OFFSET           */
         MVC   SOFFS(2),@CH00351                                   0836
*                       CALL  SYSERRD;  /* GO TO ISSUE MESSAGE       */
         BAL   @14,SYSERRD                                         0837
*                     END;                                         0838
*               END;                                               0839
*                                                                  0839
@RC00820 DS    0H                                                  0840
*           RESPECIFY (R14) RESTRICTED;                            0840
@RF00817 DS    0H                                                  0841
*           R14 = SAVLNKB;          /* RESTORE LINK REGISTER         */
         L     R14,SAVLNKB                                         0841
*           RETURN;                 /* RETURN                        */
         B     @EL00003                                            0842
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -- DOUPDAT                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME -- N/A                                          */
*/*                                                                  */
*/* FUNCTION -- WRITE REVISED MEMBER BLOCK BACK IN UPDAT MODE        */
*/*   OPERATION --                                                   */
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP DOUPDAT FUNCTION */
*/*   -  MOVE OUTPUT BUFFER INTO UPDAT BUFFER                        */
*/*   -  IF THE EXTRA BLOCK SPACE WAS USED, SET POINTER (PPPPTR) TO  */
*/*      THE EXTRA DCB (RINDCB), SET REGISTER 1 TO POINT TO OUTPUT   */
*/*      MODE PARAMETER BLOCK (RXOPNL) AND PERFORM SEGMENT OPENDCB   */
*/*      TO EXECUTE OPEN.  SAVE UPDAT-MODE ACCOUNT-WRITE PARAMETER   */
*/*      BLOCK (RWPB).  SET RWPB TO WRITE THE EXTRA BLOCK THROUGH    */
*/*      DCB (RINDCB) IN CREATE (OUTPUT)MODE.  PERFORM SEGMENT       */
*/*      DOWRT2 TO EXCUTE WRITE.  PERFORM SEGMENT RSTOW TO EXECUTE   */
*/*      STOW FOR THE NEW BLOCK.  RESTORE ACCOUNT-WRITE PARAMETER    */
*/*      BLOCK (RWPB) FROM THE SAVE AREA (RWPBSAV)                   */
*/*   -  SET ACCOUNT-WRITE PARAMETER BLOCK POINTER (RWPUDP) WITH     */
*/*      LOCATION OF UPDAT DCB (REXDCB) AND NUMBER OF BLOCK TO WRITE */
*/*      (RWPNOM) FROM SAVE AREA FOR NUMBER OF UPDAT MODE BLOCKS     */
*/*      (ONNOBLK)                                                   */
*/*   -  PERFORM SEGMENT DOWRT2 TO EXECUTE WRITE                     */
*/*   -  IF INPUT MEMBER IS NOT IN REVISED FORMAT (CURNEW), SET      */
*/*      BLOCK IDENTITY IN USERID NAME TO ZERO AND PERFORM SEGMENT   */
*/*      RSTOW TO CREATE REVISED FORMAT ENTRY                        */
*/*   -  (RESTORE ENTRY LINK REGISTER 14 AND RETURN)                 */
*/*                                                                  */
*/* ENTRY -- N/A, INLINE SEGMENT (PSEUDO, LINKED BY REGISTER 14)     */
*/*                                                                  */
*/* INPUT --                                                         */
*/*   -  UADSREFM ENVIRONMENT                                        */
*/*   -  FLAG (XTRBNOW) SET ON                                       */
*/*                                                                  */
*/* OUTPUT --                                                        */
*/*   -  REFORMATTED USERID MEMBER WRITTEN BACK TO UADS (SYSUADS)    */
*/*                                                                  */
*/* EXTERNAL REFERENCES -- N/A                                       */
*/*                                                                  */
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */
*/*   CONDITIONS -- N/A                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* EXIT-ERROR --                                                    */
*/*   CONDITIONS -- N/A                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */
*/*                                                                  */
*/********************************************************************/
*DOUPDAT:   /* WRITE=OUT REVISED MEMBER IN UPDAT MODE                */
*           ENTRY;                                                 0843
*                                                                  0843
DOUPDAT  DS    0H                                                  0844
*           SAVLNKB = R14;          /* SAVE LINK REGISTER            */
         ST    R14,SAVLNKB                                         0844
*           RESPECIFY (R14) UNRESTRICTED;                          0845
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */
*             THEN                  /* NO,                           */
         TM    QUITCHK,B'11100000'                                 0846
         BNZ   @RF00846                                            0846
*               DO;                                                0847
*                                                                  0847
*           /* MOVE OUTPUT BUFFER TO UPDAT BUFFER                    */
*           RESPECIFY  (RSPZOP,RLNG,RFROM,RTO)  RESTRICTED;        0848
*           RSPZOP = ADDR(MVCOP);   /* PTR TO MOVE CHAR OP           */
         LA    RSPZOP,MVCOP                                        0849
*           RLNG = SPZBLKN*DCBXPTR->DCBBLKSI;  /* SET MOVE LENGTH    */
         LH    RLNG,SPZBLKN                                        0850
         L     @08,DCBXPTR                                         0850
         MH    RLNG,DCBBLKSI(,@08)                                 0850
*           RFROM = GMAINP;         /* SET FROM LOCATION             */
         L     RFROM,GMAINP                                        0851
*           RTO = RINBUFP;          /* SET TO LOCATION               */
         L     RTO,RINBUFP                                         0852
*           CALL  DOPSPAZ;          /* MOVE OUTPUT TO UPDAT BUFFER   */
         BAL   @14,DOPSPAZ                                         0853
*           RESPECIFY  (RSPZOP,RLNG,RFROM,RTO)  UNRESTRICTED;      0854
*                                                                  0854
*           IF XTRBNOW = '1'B       /* CHK IF EXTRA BLOCK USED       */
*             THEN                  /* YES,                          */
         TM    XTRBNOW,B'00001000'                                 0855
         BNO   @RF00855                                            0855
*               DO;                                                0856
*                 RESPECIFY (PPPPTR,R1) RESTRICTED;                0857
*                 PPPPTR = ADDR(REXDCB);  /* PTR TO OUTPUT DCB       */
         LA    PPPPTR,REXDCB                                       0858
*                 R1 = ADDR(RXOPNL);  /* PL FOR EXTRA BLOCK OUTPUT   */
         LA    R1,RXOPNL                                           0859
*                 MSGNO = 4;        /* SET MESSAGE INDEX             */
         LA    @08,4                                               0860
         STH   @08,MSGNO                                           0860
*                 MSGN2 = 4;        /* SET MESSAGE INDEX FOR OPEN    */
         STH   @08,MSGN2                                           0861
*                 MSGN3 = 29;       /* SET MESSAGE INDEX FOR CLOSE   */
         MVC   MSGN3(2),@CH01868                                   0862
*                 CALL  OPENDCB;    /* GO TO OPEN FOR OUTPUT         */
         BAL   @14,OPENDCB                                         0863
*                 RESPECIFY (PPPPTR,R1) UNRESTRICTED;              0864
*                 RWPBSAV = RWPB;   /* RESERVE UPDAT PARM BLOCK      */
         MVC   RWPBSAV(24),RWPB                                    0865
*                 RWPBUF=REXBUFP+DCBXPTR->DCBBLKSI*OLNOBLK;        0866
         L     @08,DCBXPTR                                         0866
         LH    @08,DCBBLKSI(,@08)                                  0866
         MH    @08,OLNOBLK                                         0866
         AL    @08,REXBUFP                                         0866
         ST    @08,@TF00001                                        0866
         MVC   RWPBUF(3),@TF00001+1                                0866
*                                   /* LOCATE BUFFER                 */
*                 RWPUDP = ADDR(REXDCB);  /* FOR SYSUADS OUTPUT DCB  */
         LA    @08,REXDCB                                          0867
         ST    @08,@TF00001                                        0867
         MVC   RWPUDP(3),@TF00001+1                                0867
*                 RWPRBP = 0;       /* SET CREATE MODE INDICATION    */
         SLR   @08,@08                                             0868
         ST    @08,RWPRBP                                          0868
*                 RWPF3 = '0'B;     /* SET NOT-DIRWA-PTR FLAG        */
         NI    RWPF3,B'11011111'                                   0869
*                 RWPNOM = 1;       /* FOR EXTRA BLOCK OUTPUT WRITE  */
         MVI   RWPNOM,X'01'                                        0870
*                 CALL  DOWRT2;     /* GO TO WRITE EXTRA BLOCK       */
         BAL   @14,DOWRT2                                          0871
*                 NODIDC(NODIDL+1)=OLNOBLK+1×'0';     /* EXTENT ID   */
         LH    @08,NODIDL                                          0872
         LA    @15,1                                               0872
         AH    @15,OLNOBLK                                         0872
         O     @15,@CF01890                                        0872
         STC   @15,NODIDC(@08)                                     0872
*                 CALL  RSTOW;      /* GO TO STOW ADDED BLOCK        */
         BAL   @14,RSTOW                                           0873
*                 RWPB = RWPBSAV;   /* RESTORE UPDAT PARM BLOCK      */
         MVC   RWPB(24),RWPBSAV                                    0874
*               END;                                               0875
*                                                                  0875
*           RWPUDP = ADDR(RINDCB);  /* PTR TO SYSUADS UPDAT DCB      */
@RF00855 LA    @08,RINDCB                                          0876
         ST    @08,@TF00001                                        0876
         MVC   RWPUDP(3),@TF00001+1                                0876
*           CALL  DOWRT2;           /* TO WRITE UPDAT BLOCKS         */
         BAL   @14,DOWRT2                                          0877
*           STODON = '1'B;          /* SET FOR RMODEU                */
         OI    STODON,B'10000000'                                  0878
*           IF CURNEW = '0'B        /* CHK FOR NEW-FORMAT INPUT      */
*             THEN                  /* NO,                           */
         TM    CURNEW,B'10000000'                                  0879
         BNZ   @RF00879                                            0879
*               DO;                                                0880
*                 NODIDC(NODIDL+1)='0';    /* SET TO 1ST BLOCK       */
         LH    @08,NODIDL                                          0881
         LA    @01,NODIDC(@08)                                     0881
         MVI   0(@01),C'0'                                         0881
*                 CALL  RSTOW;      /* TO STOW FOR 1ST BLOCK         */
         BAL   @14,RSTOW                                           0882
*               END;                                               0883
*                                                                  0883
*               END;                                               0884
@RF00879 DS    0H                                                  0885
*           RESPECIFY (R14) RESTRICTED;                            0885
@RF00846 DS    0H                                                  0886
*           R14 = SAVLNKB;          /* RESTORE LINK REGISTER         */
         L     R14,SAVLNKB                                         0886
*           RETURN;                 /* RETURN                        */
         B     @EL00003                                            0887
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -- RMODEU                                           */
*/*                                                                  */
*/* DESCRIPTIVE NAME -- N/A                                          */
*/*                                                                  */
*/* FUNCTION -- PRINT LIST OF REFORMATTED USERID NAMES               */
*/*   OPERATION --                                                   */
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */
*/*   -  IF MESSAGE BUFFER IS FULL AFTER REFORMATTING SOME USERIDS,  */
*/*      OR IF TERMINATION IS CURRENT --                             */
*/*     -  IF HEADER MESSAGE IS NOT YET PRINTED, PERFORM SEGMENT     */
*/*        MSGFNDR, FXPUTL, DOPUTL TO PRINT MESSAGE 28 AND SET THE   */
*/*        HEADER PRINTED FLAG (HDRPRT).  PRINT LIST OF REFORMATTED  */
*/*        USERIDS                                                   */
*/*     -  RESET COUNT OF REFORMATTED USERIDS (IDSCT), PERFORM SEG-  */
*/*        MENT BLNKBUF TO CLEAR USERID-LIST BUFFER (IDSBUF),  AND   */
*/*        INITIALIZE  LINE POSITION CONTROLS  FOR NEXT FIRST LINE   */
*/*        USERID NAME                                               */
*/*   -  IF STOW WAS PERFORMED FOR USERID CURRENTLY IN PROCESS,      */
*/*      INSERT NAME IN PRINT BUFFER AND UPDATE THE LINE POSITION    */
*/*      CONTROLS                                                    */
*/*   -  (RESTORE ENTRY LINK REGISTER 14 AND RETURN)                 */
*/*                                                                  */
*/* ENTRY -- N/A, INLINE SEGMENT (PSEUDO, LINKED BY REGISTER 14)     */
*/*                                                                  */
*/* INPUT --                                                         */
*/*   -  UADSREFM ENVIRONMENT                                        */
*/*                                                                  */
*/* OUTPUT --                                                        */
*/*   -  USERID NAME INSERTED IN PRINT BUFFER, OR NAME LIST PRINTED  */
*/*                                                                  */
*/* EXTERNAL REFERENCES -- N/A                                       */
*/*                                                                  */
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */
*/*   CONDITIONS -- N/A                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* EXIT-ERROR -- N/A                                                */
*/*   CONDITIONS --                                                  */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */
*/*                                                                  */
*/********************************************************************/
*RMODEU:    /* PRINT LIST OF REFORMATTED USERID NAMES                */
*           ENTRY;                                                 0888
RMODEU   DS    0H                                                  0889
*           SAVLNKB = R14;          /* SAVE LINK REGISTER            */
         ST    R14,SAVLNKB                                         0889
*           RESPECIFY (R14) UNRESTRICTED;                          0890
*           IF LINPTR ^< MAXLINP    /* CHK IF BUFFER FULL            */
*               × TERMCHK ^= '00'B  /*     OR TERMINATION CURRENT    */
*             THEN                  /* YES,                          */
         CLC   LINPTR(4),MAXLINP                                   0891
         BNL   @RT00891                                            0891
         TM    TERMCHK,B'01100000'                                 0891
         BZ    @RF00891                                            0891
@RT00891 DS    0H                                                  0892
*               DO;                                                0892
*                 IF IDSCT ^= 0     /* CHK IF ANY REFORM DONE        */
*                   THEN            /* YES, PRINT IDS NOTICE         */
         LH    @08,IDSCT                                           0893
         LTR   @08,@08                                             0893
         BZ    @RF00893                                            0893
*                     DO;                                          0894
*                       IF HDRPRT = '0'B/* HAS HEADER BEEN PRINTED ? */
*                         THEN          /* NO,                       */
         TM    HDRPRT,B'00000001'                                  0895
         BNZ   @RF00895                                            0895
*                           DO;                                    0896
*                             MSGNO = 28;   /* SET MESSAGE INDEX     */
         MVC   MSGNO(2),@CH00565                                   0897
*                             CALL  MSGFNDR;  /* LOCATE MESSAGE TEXT */
         BAL   @14,MSGFNDR                                         0898
*                             CALL  FXPUTL;   /* INITIALIZE PB       */
         BAL   @14,FXPUTL                                          0899
*                             CALL  DOPUTL;   /* TO ISSUE HEADER MSG */
         BAL   @14,DOPUTL                                          0900
*                             HDRPRT = '1'B;  /* SET HDR DONE FLAG   */
         OI    HDRPRT,B'00000001'                                  0901
*                           END;                                   0902
*                       PTPBK = PTPBDM;  /* INITIALIZE PARM BLOCK    */
@RF00895 MVC   PTPBK(12),PTPBDM                                    0903
*                       PTPBOPUT = ADDR(IDSBUF);  /* PTR TO TEXT     */
         LA    @08,IDSBUF                                          0904
         L     @01,PTPBPTR                                         0904
         ST    @08,PTPBOPUT(,@01)                                  0904
*                       CALL  DOPUTL;  /* ISSUE MESSAGE              */
         BAL   @14,DOPUTL                                          0905
*                     END;                                         0906
*                 IDSCT = 0;        /* RESET USERID NOTICE CT        */
@RF00893 SLR   @08,@08                                             0907
         STH   @08,IDSCT                                           0907
*                 CALL  BLNKBUF;    /* TO CLEAR TEXT BUFFER          */
         BAL   @14,BLNKBUF                                         0908
*                 LINPTR = ADDR(IDSBUF);  /* INITIALIZE LINE PTR     */
         LA    @08,IDSBUF                                          0909
         ST    @08,LINPTR                                          0909
*                 IDLPOSR = 1;      /* SET TO FIRST POSITION IN LINE */
         MVC   IDLPOSR(2),@CH00032                                 0910
*                 MIDSHDR = MIDSHDR&&MIDSHDR; /* CLEAR LINE CONTROLS */
         XC    MIDSHDR(8,@08),MIDSHDR(@08)                         0911
*                 MIDSLLG = 4;      /* INITIALIZE LINE LENGTH        */
         MVC   MIDSLLG(2,@08),@CH00102                             0912
*               END;                                               0913
*           IF STODON = '1'B        /* WAS CURRENT ID REFORMATTED    */
*             THEN                  /* THEN,                         */
@RF00891 TM    STODON,B'10000000'                                  0914
         BNO   @RF00914                                            0914
*               DO;                                                0915
*                 MIDSNAM(IDLPOSR)=NODIDC(1:NODIDL); /* INSERT NAME  */
         L     @08,LINPTR                                          0916
         LH    @15,IDLPOSR                                         0916
         LR    @14,@15                                             0916
         MH    @14,@CH00034                                        0916
         ALR   @14,@08                                             0916
         BCTR  @14,0                                               0916
         BCTR  @14,0                                               0916
         MVI   MIDSNAM-7(@14),C' '                                 0916
         MVC   MIDSNAM-6(8,@14),MIDSNAM-7(@14)                     0916
         LH    @07,NODIDL                                          0916
         BCTR  @07,0                                               0916
         EX    @07,@SM02095                                        0916
*                 IF IDLPOSR = 1    /* CHK IF 1ST ENTRY OF LINE      */
*                     & IDSCT ^= 0      /* BUT NOT 1ST LINE          */
*                   THEN            /* YES,                          */
         CH    @15,@CH00032                                        0917
         BNE   @RF00917                                            0917
         LH    @15,IDSCT                                           0917
         LTR   @15,@15                                             0917
         BZ    @RF00917                                            0917
*                     IDSLLAS=LINPTR;  /* SET CHAIN PTR IN LAST LINE */
         L     @01,IDSLASP                                         0918
         ST    @08,IDSLLAS(,@01)                                   0918
*                 IDSCT = IDSCT+1;  /* STEP NAME COUNT               */
@RF00917 LA    @08,1                                               0919
         LH    @15,IDSCT                                           0919
         ALR   @15,@08                                             0919
         STH   @15,IDSCT                                           0919
*                 MIDSLLG=MIDSLLG+LENGTH(MIDSNAM); /* STEP LINE LNG  */
         L     @15,LINPTR                                          0920
         LA    @14,10                                              0920
         LH    @07,MIDSLLG(,@15)                                   0920
         ALR   @07,@14                                             0920
         STH   @07,MIDSLLG(,@15)                                   0920
*                 IDLPOSR=IDLPOSR+1;  /* STEP LINE NAME POSITION     */
         LH    @07,IDLPOSR                                         0921
         ALR   @07,@08                                             0921
         STH   @07,IDLPOSR                                         0921
*                 IF IDLPOSR > 10   /* CHK IF LINE COMPLETE          */
*                   THEN            /* YES,                          */
         CR    @07,@14                                             0922
         BNH   @RF00922                                            0922
*                     DO;                                          0923
*                       IDSLASP = LINPTR;  /* PREVIOUS LINE PTR      */
         ST    @15,IDSLASP                                         0924
*                       IDLPOSR = 1;  /* INITIALIZE LINE POSITION CT */
         STH   @08,IDLPOSR                                         0925
*                       LINPTR=LINPTR+LENGTH(MIDSLIN);  /* NEXT LINE */
         AH    @15,@CH00551                                        0926
         ST    @15,LINPTR                                          0926
*                       MIDSHDR=MIDSHDR&&MIDSHDR;  /* CLEAR CONTROLS */
         XC    MIDSHDR(8,@15),MIDSHDR(@15)                         0927
*                       MIDSLLG = 4;   /* INITIALIZE LINE LENGTH     */
         MVC   MIDSLLG(2,@15),@CH00102                             0928
*                     END;                                         0929
*               END;                                               0930
@RF00922 DS    0H                                                  0931
*           RESPECIFY (R14) RESTRICTED;                            0931
@RF00914 DS    0H                                                  0932
*           R14 = SAVLNKB;          /* RESTORE LINK REGISTER         */
         L     R14,SAVLNKB                                         0932
*           RETURN;                 /* RETURN                        */
         B     @EL00003                                            0933
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -- RCLOS                                            */
*/*                                                                  */
*/* DESCRIPTIVE NAME -- N/A                                          */
*/*                                                                  */
*/* FUNCTION -- COMMON CLOSE DCB ROUTINE                             */
*/*   OPERATION --                                                   */
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */
*/*   -  SET MESSAGE INDEX 29 AND POINTER (PPPPTR) FOR REXDCB, CALL  */
*/*      SEGMENT CLOSDCB                                             */
*/*   -  SET MESSAGE INDEX 30 AND POINTER (PPPPTR) FOR RDIDCB, CALL  */
*/*      SEGMENT CLOSDCB                                             */
*/*   -  SET MESSAGE INDEX 30 AND POINTER (PPPPTR) FOR RINDCB, CALL  */
*/*      SEGMENT CLOSDCB                                             */
*/*  -  (RESTORE ENTRY LINK REGISTER 14 AND RETURN)                  */
*/*                                                                  */
*/* ENTRY -- N/A, INLINE SEGMENT (PSEUDO, LINKED BY REGISTER 14)     */
*/*                                                                  */
*/* INPUT --                                                         */
*/*   -  UADSREFM ENVIRONMENT                                        */
*/*                                                                  */
*/* OUTPUT --                                                        */
*/*   -  ALL DCBS IN CLOSED STATE   (VIA CLOSDCB)                    */
*/*                                                                  */
*/* EXTERNAL REFERENCES -- N/A                                       */
*/*                                                                  */
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */
*/*   CONDITIONS -- N/A                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* EXIT-ERROR -- N/A                                                */
*/*   CONDITIONS -- N/A                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */
*/*                                                                  */
*/********************************************************************/
*RCLOS:     /* CLOSE DATA CONTROL BLOCK ROUTINE EP                   */
*                                                                  0934
*           ENTRY;                                                 0934
RCLOS    DS    0H                                                  0935
*           RESPECIFY (PPPPTR) RESTRICTED;  /* RESERVE POINTER       */
*           SAVLNKB  =  R14;        /* RESERVE LINK REGISTER         */
         ST    R14,SAVLNKB                                         0936
*           RESPECIFY (R14) UNRESTRICTED;                          0937
*                                                                  0937
*           MSGNO = 29;             /* SET MESSAGE INDEX FOR SYSUADS */
         MVC   MSGNO(2),@CH01868                                   0938
*           PPPPTR = ADDR(REXDCB);  /* PTR TO DCB TO BE CLOSED       */
         LA    PPPPTR,REXDCB                                       0939
*           CALL  CLOSDCB;          /* GO TO ISSUE CLOSE             */
*                                                                  0940
         BAL   @14,CLOSDCB                                         0940
*           MSGNO = 30;             /* SET MESSAGE INDEX FOR SYSUADN */
         MVC   MSGNO(2),@CH01172                                   0941
*           PPPPTR = ADDR(RDIDCB);  /* PTR TO DCB TO BE CLOSED       */
         LA    PPPPTR,RDIDCB                                       0942
*           CALL  CLOSDCB;          /* GO TO ISSUE CLOSE             */
*                                                                  0943
         BAL   @14,CLOSDCB                                         0943
*           MSGNO = 30;             /* SET MESSAGE INDEX FOR SYSUADN */
         MVC   MSGNO(2),@CH01172                                   0944
*           PPPPTR = ADDR(RINDCB);  /* PTR TO DCB TO BE CLOSED       */
         LA    PPPPTR,RINDCB                                       0945
*           CALL  CLOSDCB;          /* GO TO ISSUE CLOSE             */
*                                                                  0946
         BAL   @14,CLOSDCB                                         0946
*           RESPECIFY (R14) RESTRICTED;                            0947
*           R14 = SAVLNKB;          /* RESTORE LINK REGISTER         */
         L     R14,SAVLNKB                                         0948
*           RESPECIFY  (PPPPTR) UNRESTRICTED;  /* FREE POINTER       */
*           RETURN;                 /* RETURN                        */
         B     @EL00003                                            0950
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -- FREBUF                                           */
*/*                                                                  */
*/* DESCRIPTIVE NAME -- N/A                                          */
*/*                                                                  */
*/* FUNCTION -- FREE STORAGE SPACE FOR OUTPUT BUFFER                 */
*/*   OPERATION --                                                   */
*/*   -  SAVE ENTRY LINK REGISTER 14                                 */
*/*   -  IF BUFFER EXISTS (GMAINL IS NOT ZERO),                      */
*/*      -  SET REGISTER 1 TO POINT TO FREEMAIN PARAMETER LIST       */
*/*      -  SET FREEMAIN LENGTH (GMAINL) IN REGISTER 5               */
*/*      -  SET POINTER TO BUFFER AREA (GMAINP) IN REGISTER 6        */
*/*      -  SET SUBPOOL NUMBER IN REGISTER 3                         */
*/*      -  EXECUTE FREEMAIN MACRO                                   */
*/*      -  CLEAR FREEMAIN LENGTH FIELD (GMAINL)                     */
*/*   -  RESTORE ENTRY LINK REGISTER 14 AND RETURN                   */
*/*                                                                  */
*/* ENTRY -- LINKED BY REGISTER 14                                   */
*/*                                                                  */
*/* INPUT --                                                         */
*/*   -  UADSREFM ENVIRONMENT                                        */
*/*   -  BUFFER LENGTH (IF ANY) IN POINTER (GMAINL)                  */
*/*   -  STARTING POINT OF BUFFER AREA IN POINTER (GMAINP)           */
*/*                                                                  */
*/* OUTPUT -- N/A                                                    */
*/*                                                                  */
*/* EXTERNAL REFERENCES -- FREEMAIN MACRO                            */
*/*                                                                  */
*/* EXIT-NORMAL -- RETURN BY ENTRY LINK REGISTER 14                  */
*/*   CONDITIONS -- N/A                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* EXIT-ERROR -- N/A                                                */
*/*   CONDITIONS -- N/A                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/********************************************************************/
*FREBUF:    /* ISSUE FREEMAIN FOR OUTPUT BUFFER                      */
*           ENTRY;                                                 0951
*                                                                  0951
FREBUF   DS    0H                                                  0952
*           SAVLNKB = R14;          /* SAVE LINK REGISTER            */
         ST    R14,SAVLNKB                                         0952
*           RESPECIFY (R14) UNRESTRICTED;                          0953
*                                                                  0953
*           RESPECIFY (R1,R5,R6) RESTRICTED;                       0954
*           IF GMAINL ^= 0          /* CHK FOR CURRENT GOTMAIN       */
*             THEN                  /* YES, EXECUTE FREEMAIN         */
         L     @08,GMAINL                                          0955
         LTR   @08,@08                                             0955
         BZ    @RF00955                                            0955
*               DO;                                                0956
*                 R1 = ADDR(FMLST); /* PTR TO FREE MAIN  P L         */
         LA    R1,FMLST                                            0957
*                 GMAINL = GMAINL×HIORDR1;  /* SET HIGH ORDER FLAG   */
         MVC   @TF00001(4),HIORDR1                                 0958
         O     @08,@TF00001                                        0958
         ST    @08,GMAINL                                          0958
*                 R5 = ADDR(GMAINL);  /* PTR TO FREEMAIN LENGTH      */
         LA    R5,GMAINL                                           0959
*                 R6 = ADDR(GMAINP);  /* PTR TO FREE MAIN AREA       */
         LA    R6,GMAINP                                           0960
*                 GEN(LA    R3,&SUBPN); /* SUBPOOL NUMBER            */
         LA    R3,&SUBPN
*                 GEN(FREEMAIN  L,LA=(R5),A=(R6),SP=(R3),MF=(E,(1)));
         FREEMAIN  L,LA=(R5),A=(R6),SP=(R3),MF=(E,(1))
*                 GMAINL = 0;       /* SET NO GOTMAIN INDICATOR      */
         SLR   @08,@08                                             0963
         ST    @08,GMAINL                                          0963
*               END;                                               0964
*           RESPECIFY (R1,R5,R6) UNRESTRICTED;                     0965
*                                                                  0965
@RF00955 DS    0H                                                  0966
*           RESPECIFY (R14) RESTRICTED;                            0966
*           R14 = SAVLNKB;          /* RESTORE LINK REGISTER         */
         L     R14,SAVLNKB                                         0967
*           RETURN;                 /* RETURN                        */
         B     @EL00003                                            0968
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -- RDEQU                                            */
*/*                                                                  */
*/* DESCRIPTIVE NAME -- N/A                                          */
*/*                                                                  */
*/* FUNCTION -- DEQUEUE FROM SYSIKJUA/OPENUADS                       */
*/*   OPERATION --                                                   */
*/*   -  SAVE ENTRY LINK REGISTER 14                                 */
*/*   -  SET POINTER TO DEQ PARAMETER LIST (DQOPN) IN REGISTER 1     */
*/*   -  EXECUTE DEQ MACRO                                           */
*/*   -  IF DEQ RETURN CODE (REGISTER 15) IS UNSUCCESSFUL (NOT ZERO) */
*/*      CHECK RETURN CODE LIST LOCATED BY REGISTER 15 AS POINTER    */
*/*      -  IF RETURN CODE IS NOT 8, ISSUE ERROR MESSAGE 27 AND SET  */
*/*         UADSREFM TERMINATION FLAG (RFMQUIT)                      */
*/*   -  RESTORE ENTRY LINK REGISTER 14 AND RETURN                   */
*/*                                                                  */
*/* ENTRY -- LINKED BY REGISTER 14                                   */
*/*                                                                  */
*/* INPUT --                                                         */
*/*   -  UADSREFM ENVIRONMENT                                        */
*/*                                                                  */
*/* OUTPUT -- N/A                                                    */
*/*                                                                  */
*/* EXTERNAL REFERENCES -- DEQ MACRO                                 */
*/*                                                                  */
*/* EXIT-NORMAL -- RETURN BY ENTRY LINK REGISTER 14                  */
*/*   CONDITIONS --                                                  */
*/*  -  SUCCESSFUL DEQ                                               */
*/*                                                                  */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* EXIT-ERROR -- RETURN BY ENTRY LINK REGISTER 14                   */
*/*   CONDITIONS --                                                  */
*/*   -  FAILURE IN DEQ  (REFMQUIT FLAG SET)                         */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/********************************************************************/
*RDEQU:     /* DEQUEUE FROM UADS                                     */
*           /* ENQUEUE AT RENQU                                      */
*           ENTRY;                                                 0969
RDEQU    DS    0H                                                  0970
*           SAVLNKB = R14;          /* SAVE LINK REGISTER            */
         ST    R14,SAVLNKB                                         0970
*           RESPECIFY (R14) UNRESTRICTED;                          0971
*                                                                  0971
*           RESPECIFY (R1,R15) RESTRICTED;                         0972
*           R1 = ADDR(DQOPN);       /* PTR TO DEQ PARM LIST          */
         LA    R1,DQOPN                                            0973
*           GEN(DEQ   ,MF=(E,(1))); /* ISSUE DEQUEUE                 */
         DEQ   ,MF=(E,(1))
*           RTNCODE = R15;          /* RESERVE RETURN CODE           */
         ST    R15,RTNCODE                                         0975
*           RESPECIFY (R1,R15) UNRESTRICTED;                       0976
*           IF RTNCODE ^= 0         /* CHK FOR SATISFACTORY RET CODE */
*             THEN                  /* NO,                           */
         L     @08,RTNCODE                                         0977
         LTR   @08,@08                                             0977
         BZ    @RF00977                                            0977
*               DO;                                                0978
*                 RCPTR = RTNCODE;  /* LOCATE RETURN CODE            */
         ST    @08,RCPTR                                           0979
*                 IF RCLC1^=0       /* CHK FOR UNSATISFACTORY        */
*                     & RCLC1^=8    /*     RETURN CODE               */
*                   THEN            /* YES,                          */
         CLI   RCLC1(@08),0                                        0980
         BE    @RF00980                                            0980
         CLI   RCLC1(@08),8                                        0980
         BE    @RF00980                                            0980
*                     DO;                                          0981
*                       MSGNO = 27;     /* SET MESSAGE INDEX         */
         MVC   MSGNO(2),@CH01967                                   0982
*                       SOFFS = 20;     /* SET INSERT OFFSET         */
         MVC   SOFFS(2),@CH00351                                   0983
*                       CALL  SYSERRD;  /* ISSUE ERROR MSG           */
         BAL   @14,SYSERRD                                         0984
*                       RFMQUIT = '1'B; /* SET TERMINATION FLG       */
         OI    RFMQUIT,B'01000000'                                 0985
*                     END;                                         0986
*               END;                                               0987
*                                                                  0987
@RF00980 DS    0H                                                  0988
*           RESPECIFY (R14) RESTRICTED;                            0988
@RF00977 DS    0H                                                  0989
*           R14 = SAVLNKB;          /* RESTORE LINK REGISTER         */
         L     R14,SAVLNKB                                         0989
*           RETURN;                 /* RETURN                        */
         B     @EL00003                                            0990
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -- RDSTAE                                           */
*/*                                                                  */
*/* DESCRIPTIVE NAME -- N/A                                          */
*/*                                                                  */
*/* FUNCTION -- CANCEL EXISTING STAE ENVIRONMENT                     */
*/*   OPERATION --                                                   */
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */
*/*   -  IF STAE ENVIRONMENT IS CURRENTLY ESTABLISHED (STASET SET)   */
*/*      -  SET STAE PARAMETER LIST (STAEL1)                         */
*/*      -  EXECUTE STAE MACRO (OPERAND OF 0)                        */
*/*      -  IF RETURN CODE (REGISTER 15) IS NOT ZERO, ISSUE MESSAGE  */
*/*         9 AND SET TERMINATION FLAG (RFMQUIT)                     */
*/*      -  IF RETURN CODE IS ZERO, SET STAE ENVIRONMENT ESTABLISHED */
*/*         FLAG OFF (STASET = 0)                                    */
*/*   -  (RESTORE ENTRY LINK REGISTER 14 AND RETURN)                 */
*/*                                                                  */
*/* ENTRY -- N/A, INLINE SEGMENT (PSEUDO, LINKED BY REGISTER 14)     */
*/*                                                                  */
*/* INPUT --                                                         */
*/*   -  UADSREFM ENVIRONMENT                                        */
*/*                                                                  */
*/* OUTPUT --                                                        */
*/*   -  STAE ENVIRONMENT CANCELLED (STASET FLAG SET OFF)            */
*/*                                                                  */
*/* EXTERNAL REFERENCES -- STAE MACRO                                */
*/*                                                                  */
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */
*/*   CONDITIONS --                                                  */
*/*   -  SUCCESSFUL STAE (STASET FLAG SET OFF)                       */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* EXIT-ERROR -- N/A (RETURN BY ENTRY LINK REGISTER 14)             */
*/*   CONDITIONS --                                                  */
*/*   -  UNSUCCESSFUL STAE (ERROR MESSAGE 9 AND RFMQUIT FLAG SET)    */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */
*/*                                                                  */
*/********************************************************************/
*RDSTAE:    /* CANCEL EXISTING STAE ENVIRONMENT                      */
*           ENTRY;                                                 0991
RDSTAE   DS    0H                                                  0992
*           SAVLNKB = R14;          /* SAVE LINK REGISTER            */
         ST    R14,SAVLNKB                                         0992
*           RESPECIFY (R14) UNRESTRICTED;                          0993
*                                                                  0993
*           IF STASET = '1'B        /* CHK FOR CURRENT STAE          */
*             THEN                  /* YES,                          */
         TM    STASET,B'00100000'                                  0994
         BNO   @RF00994                                            0994
*               DO;                                                0995
*                 /* SET UP AND ISSUE CANCEL STAE                    */
*                 GEN(MVC    STAEL1(STALNG),MSTAEL1);  /* SET P L    */
         MVC    STAEL1(STALNG),MSTAEL1
*                 GEN(STAE   0);    /* ISSUE CANCEL STAE             */
*                                                                  0997
         STAE   0
*                 RESPECIFY (R15) RESTRICTED;                      0998
*                 RTNCODE = R15;    /* RESERVE RETURN CODE           */
         ST    R15,RTNCODE                                         0999
*                 RESPECIFY (R15) UNRESTRICTED;                    1000
*                 IF RTNCODE ^= 0     /* CHK FOR SUCCESS CODE        */
*                   THEN            /* NO,                           */
         L     @08,RTNCODE                                         1001
         LTR   @08,@08                                             1001
         BZ    @RF01001                                            1001
*                     DO;                                          1002
*                       MSGNO = 9;  /* SET MESSAGE INDEX             */
         MVC   MSGNO(2),@CH00033                                   1003
*                       SOFFS=20;   /* SET TEXT OFFSET               */
         MVC   SOFFS(2),@CH00351                                   1004
*                       CALL  SYSERRD;  /* TO ISSUE MESSAGE          */
         BAL   @14,SYSERRD                                         1005
*                       RFMQUIT = '1'B; /* SET TERMINATION FLAG      */
         OI    RFMQUIT,B'01000000'                                 1006
*                     END;                                         1007
*                   ELSE            /* CANCEL STAE SUCESSFUL         */
*                     STASET = '0'B;/* SET STAE INACTIVE FLAG        */
         B     @RC01001                                            1008
@RF01001 NI    STASET,B'11011111'                                  1008
*               END;                                               1009
*                                                                  1009
@RC01001 DS    0H                                                  1010
*           RESPECIFY (R14) RESTRICTED;                            1010
@RF00994 DS    0H                                                  1011
*           R14 = SAVLNKB;          /* RESTORE LINK REGISTER         */
         L     R14,SAVLNKB                                         1011
*           END  DCBCHK;            /* RETURN                        */
         B     @EL00003                                            1012
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -- OPENDCB                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME -- N/A                                          */
*/*                                                                  */
*/* FUNCTION -- COMMON OPEN DCB ROUTINE                              */
*/*   OPERATION --                                                   */
*/*   -  SAVE ENTRY LINK REGISTER 14                                 */
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP OPENDCB FUNCTION */
*/*   -  IF DCB INDICATED BY POINTER (PPPPTR) IS CURRENTLY OPEN,     */
*/*      PERFORM SEGMENT CLOSDCB TO CLOSE THAT DCB                   */
*/*   -  IF THAT DCB IS STILL OPEN, ISSUE FAILURE MESSAGE AND SET    */
*/*      UADSREFM TERMINATION FLAG (REMQUIT).  OTHERWISE, EXECUTE    */
*/*      OPEN MACRO.  IF DCB IS NOT OPENED, ISSUE ERROR MESSAGE AND  */
*/*      SET RFMQUIT                                                 */
*/*   -  RESTORE ENTRY LINK REGISTER 14 AND RETURN                   */
*/*                                                                  */
*/* ENTRY -- LINKED BY REGISTER 14                                   */
*/*                                                                  */
*/* INPUT --                                                         */
*/*   -  UADSREFM ENVIRONMENT                                        */
*/*   -  POINTER TO DCB IN (PPPPTR)                                  */
*/*   -  MESAGE INDEXES SET --                                       */
*/*      -  MSGN2 -- 3 FOR OPEN SYSUADN ERROR                        */
*/*      -  MSGN2 -- 4 FOR OPEN SYSUADS ERROR                        */
*/*      -  MSGN3 -- 30 FOR CLOSE SYSUADN ERROR                      */
*/*      -  MSGN3 -- 29 FOR CLOSE SYSUADS ERROR                      */
*/*                                                                  */
*/* OUTPUT --                                                        */
*/*   -  DCBS OPEN                                                   */
*/*                                                                  */
*/* EXTERNAL REFERENCES -- OPEN MACRO                                */
*/*                                                                  */
*/* EXIT-NORMAL -- RETURN BY ENTRY LINK REGISTER 14                  */
*/*   CONDITIONS --                                                  */
*/*   -  SUCCESSFUL OPEN                                             */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* EXIT-ERROR --                                                    */
*/*   CONDITIONS --                                                  */
*/*   -  UNSUCCESSFUL OPEN (RFMQUIT FLAG SET)                        */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/********************************************************************/
*OPENDCB:   /* OPEN DATA CONTROL BLOCK ROUTINE EP                    */
*                                                                  1013
*           PROCEDURE                                              1013
*                 OPTIONS(DONTSAVE,NOSAVEAREA); /* NO REGS SAVED,    */
OPENDCB  DS    0H                                                  1014
*                                   /* NO SAVE AREA CREATED          */
*           RESPECIFY (PPPPTR) RESTRICTED;  /* RESERVE POINTER       */
*                                                                  1014
*           RESPECIFY (R14) RESTRICTED;                            1015
*           SAVLNKC  =  R14;        /* RESERVE LINK REGISTER         */
         ST    R14,SAVLNKC                                         1016
*           RESPECIFY (R14) UNRESTRICTED;                          1017
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */
*             THEN                  /* NO,                           */
         TM    QUITCHK,B'11100000'                                 1018
         BNZ   @RF01018                                            1018
*               DO;                                                1019
*                                                                  1019
*           MSGNOW = '0'B;          /* INITIALIZE FOR NO MESSAGE     */
         NI    MSGNOW,B'11111011'                                  1020
*           /* CHK IF OPEN AND IF SO, CLOSE                          */
*           IF PPPPTR->DCBOFOPN = '1'B /* CHK FOR OPEN FLAG          */
*             THEN                  /* YES,                          */
         TM    DCBOFOPN(PPPPTR),B'00010000'                        1021
         BNO   @RF01021                                            1021
*               DO;                                                1022
*                 MSGNO = MSGN3;    /* RESTORE MESSAGE INDEX         */
         MVC   MSGNO(2),MSGN3                                      1023
*                 CALL  CLOSDCB;    /* CLOSE OPEN DCB                */
         BAL   @14,CLOSDCB                                         1024
*                 MSGNO = MSGN2;    /* RESTORE MESSAGE INDEX         */
         MVC   MSGNO(2),MSGN2                                      1025
*               END;                                               1026
*           /* CHK IF OPEN AND IF SO, ISSUE ERROR MESSAGE            */
*           IF PPPPTR->DCBOFOPN = '1'B /* CHK FOR OPEN FLAG          */
*             THEN                  /* YES,                          */
@RF01021 TM    DCBOFOPN(PPPPTR),B'00010000'                        1027
         BNO   @RF01027                                            1027
*               MSGNOW = '1'B;      /* SET DO MESSAGE FLAG           */
         OI    MSGNOW,B'00000100'                                  1028
*             ELSE                                                 1029
*               DO;                                                1029
         B     @RC01027                                            1029
@RF01027 DS    0H                                                  1030
*                 /* ISSUE OPEN                                      */
*                 GENERATE (OPEN  ((PPPPTR),),MF=(E,(1)));         1030
         OPEN  ((PPPPTR),),MF=(E,(1))
*                 /* CHK IF OPEN NOW                                 */
*                 IF PPPPTR->DCBOFOPN='0'B/* CHK FOR OPEN FLAG       */
*                   THEN            /* NO,                           */
         TM    DCBOFOPN(PPPPTR),B'00010000'                        1031
         BNZ   @RF01031                                            1031
*                     MSGNOW = '1'B;  /* SET DO MESSAGE FLAG         */
         OI    MSGNOW,B'00000100'                                  1032
*               END;                                               1033
@RF01031 DS    0H                                                  1034
*           IF MSGNOW = '1'B        /* CHK FOR PENDING MESSAGE       */
*             THEN                  /* YES,                          */
@RC01027 TM    MSGNOW,B'00000100'                                  1034
         BNO   @RF01034                                            1034
*               DO;                                                1035
*                 CALL  MSGFNDR;    /* LOCATE MESSAGE TEXT           */
         BAL   @14,MSGFNDR                                         1036
*                 CALL  FXPUTLM;    /* INITIALIZE P B                */
         BAL   @14,FXPUTLM                                         1037
*                 CALL  DOPUTL;     /* ISSUE PUTLINE                 */
         BAL   @14,DOPUTL                                          1038
*                 RFMQUIT = '1'B;   /* SET TERMINATION FLAG          */
         OI    RFMQUIT,B'01000000'                                 1039
*               END;                                               1040
*                                                                  1040
*               END;                                               1041
@RF01034 DS    0H                                                  1042
*           RESPECIFY (R14) RESTRICTED;                            1042
@RF01018 DS    0H                                                  1043
*           R14 = SAVLNKC;          /* RESTORE LINK REGISTER         */
         L     R14,SAVLNKC                                         1043
*           RESPECIFY  (PPPPTR) UNRESTRICTED;  /* FREE POINTER       */
*           RETURN;                 /* RETURN                        */
@EL00004 DS    0H                                                  1045
@EF00004 DS    0H                                                  1045
@ER00004 BR    @14                                                 1045
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -- DOREAD                                           */
*/*                                                                  */
*/* DESCRIPTIVE NAME -- N/A                                          */
*/*                                                                  */
*/* FUNCTION -- SET UP AND CALL ACCOUNT-READ ROUTINE (IKJEFA51)      */
*/*   OPERATION --                                                   */
*/*   -  SAVE ENTRY LINK REGISTER 14                                 */
*/*   -  IF TERMINATION FLAG (RFMQUIT) IS SET, SKIP DOREAD FUNCTION  */
*/*   -  SET READ FLAG (RWPF5) IN RWPB                               */
*/*   -  SET ADDRESS OF ACCOUNT-READ PARM BLOCK (RWPB) IN REGISTER 1 */
*/*   -  CALL IKJEFA51 TO READ UADS MEMBER                           */
*/*   -  IF RETURN CODE IS UNSUCCESSFUL (CODE NOT 0) --              */
*/*      -  IF RETURN CODE IS 12, PERFORM SEGMENT NOUSP              */
*/*      -  IF RETURN CODE IS 4, PERFORM SEGMENT NOUFND              */
*/*      -  IF RETURN CODE IS 24, SET END-OF-FILE FLAG (RENDOF)      */
*/*      -  IF RETURN CODE IS 20, SET USERID PROCESSING TERMINATION  */
*/*         FLAG (UIDQUIT)                                           */
*/*      -  IF ANY OTHER RETURN CODE, ISSUE ERROR MESSAGE 17 AND SET */
*/*         TERMINATION FLAG (UIDQUIT)                               */
*/*      -  RESTORE ENTRY LINK REGISTER 14 AND RETURN                */
*/*   -  IF READ RETURN CODE IS SUCCESSFUL (CODE 0), SET READ-ACCOM- */
*/*      PLISHED FLAG (RDDONE)                                       */
*/*      -  IF IT WAS A USERID-MEMBER TYPE READ, SET POINTER TO      */
*/*         INPUT BUFFER (RINBUFP) WITH ADDRESS RETURNED IN ACCOUNT- */
*/*         READ PARAMETER BLOCK (RWPBUF), SET HEADER BLOCK MAPPING  */
*/*         MACRO BASE POINTER WITH INPUT BUFFER LOCATION (RINBUFP), */
*/*         SAVE INPUT BLOCK LENGTH (OLRDBUFL) AND NUMBER OF BLOCKS  */
*/*         IN INPUT MEMBER READ (OLNOBLK), AND HOLD TTR IN SVTTR    */
*/*   -  RESTORE ENTRY LINK REGISTER 14 AND RETURN                   */
*/*                                                                  */
*/* ENTRY -- LINKED BY REGISTER 14                                   */
*/*                                                                  */
*/* INPUT --                                                         */
*/*   -  UADSREFM ENVIRONMENT                                        */
*/*                                                                  */
*/* OUTPUT --                                                        */
*/*   -  USERID MEMBER/DIRECTORY ENTRY BLOCK READ INTO BUFFER        */
*/*      RINBUF/DIRWA                                                */
*/*                                                                  */
*/* EXTERNAL REFERENCES -- ACCOUNT-READ ROUTINE -- IKJEFA51          */
*/*                                                                  */
*/* EXIT-NORMAL -- RETURN BY ENTRY LINK REGISTER 14                  */
*/*   CONDITIONS --                                                  */
*/*   -  SUCCESSFUL READ (RDDONE FLAG SET)                           */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* EXIT-ERROR -- RETURN BY ENTRY LINK REGISTER 14                   */
*/*   CONDITIONS --                                                  */
*/*   -  UNSUCCESSFUL READ (UIDQUIT FLAG SET)                        */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/********************************************************************/
*DOREAD:    /* SET UP AND CALL ACCOUNT-READ ROUTINE IKJEFA51         */
*           ENTRY;                                                 1046
DOREAD   DS    0H                                                  1047
*           SAVLNKC = R14;          /* SAVE LINK REGISTER            */
         ST    R14,SAVLNKC                                         1047
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */
*             THEN                  /* NO,                           */
         TM    QUITCHK,B'11100000'                                 1048
         BNZ   @RF01048                                            1048
*               DO;                                                1049
*           RWPF5 = '0'B;           /* CLEAR WRITE FLAG              */
*           RWPF3 = '1'B;           /* RWPWAP IS PTR TO DIRWA        */
         OI    RWPF3,B'00100000'                                   1051
         NI    RWPF5,B'11110111'                                   1051
*           RESPECIFY (R1,R15) RESTRICTED;                         1052
*           R1 = ADDR(RWPB);        /* PTR TO READ  P B              */
         LA    R1,RWPB                                             1053
*           CALL  IKJEFA51;         /* GO TO READ ROUTINE            */
         L     @15,@CV00037                                        1054
         BALR  @14,@15                                             1054
*           RTNCODE = R15;          /* RESERVE RETURN CODE           */
         ST    R15,RTNCODE                                         1055
*           RESPECIFY (R1,R15) UNRESTRICTED;                       1056
*           IF RTNCODE^=0           /* CHK FOR CODE FOR SUCCESS      */
*             THEN                  /* NO,                           */
         L     @15,RTNCODE                                         1057
         LTR   @15,@15                                             1057
         BZ    @RF01057                                            1057
*               DO;                                                1058
*                 IF RTNCODE = 12   /* IS NO-SPACE CODE ?            */
*                   THEN            /* YES,                          */
         CH    @15,@CH00036                                        1059
         BNE   @RF01059                                            1059
*                     CALL  NOUSP;  /* ISSUE NO-SPACE MSG            */
         BAL   @14,NOUSP                                           1060
*                   ELSE            /* NOT NO-SPACE CODE             */
*                     IF RTNCODE = 4   /* IS NOT-FOUND CODE ?        */
*                       THEN        /* YES,                          */
         B     @RC01059                                            1061
@RF01059 CLC   RTNCODE(4),@CF00102                                 1061
         BNE   @RF01061                                            1061
*                         CALL  NOUFND; /* PUT NOT-FOUND MSG         */
         BAL   @14,NOUFND                                          1062
*                       ELSE        /* NOT NOT-FOUND MSG             */
*                         IF RTNCODE = 24   /* IS END-OF-FILE        */
*                           THEN    /* YES,                          */
         B     @RC01061                                            1063
@RF01061 CLC   RTNCODE(4),@CF00049                                 1063
         BNE   @RF01063                                            1063
*                             RENDOF = '1'B; /* SET EOF FLAG         */
         OI    RENDOF,B'00100000'                                  1064
*                           ELSE    /* NOT EOF, IS ERROR             */
*                             DO;                                  1065
         B     @RC01063                                            1065
@RF01063 DS    0H                                                  1066
*                               IF RTNCODE^=20   /* CHK FOR MESSAGE  */
*                                 THEN        /* YES,                */
         LA    @15,20                                              1066
         C     @15,RTNCODE                                         1066
         BE    @RF01066                                            1066
*                                   DO;                            1067
*                                     MSGNO = 17;   /* MSG INDEX     */
         MVC   MSGNO(2),@CH00562                                   1068
*                                     SOFFS = 20;   /* TEXT OFFSET   */
         STH   @15,SOFFS                                           1069
*                                     CALL  SYSERRD;  /* ISSUE MSG   */
         BAL   @14,SYSERRD                                         1070
*                                   END;                           1071
*                               UIDQUIT = '1'B; /* TERMINATION       */
@RF01066 OI    UIDQUIT,B'10000000'                                 1072
*                             END;                                 1073
*               END;                                               1074
*             ELSE                                                 1075
*               DO;                                                1075
         B     @RC01057                                            1075
@RF01057 DS    0H                                                  1076
*                 RDDONE = '1'B;    /* SET READ ACCOMPLISHED FLAG    */
         OI    RDDONE,B'00000001'                                  1076
*                 IF RWPF6='0'B     /* DIRECTORY ONLY ?              */
*                   THEN            /* NO,                           */
         TM    RWPF6,B'00000100'                                   1077
         BNZ   @RF01077                                            1077
*                     DO;                                          1078
*                       RINBUFP = RWPBUF; /* INPUT BUFFER PTR        */
         L     @15,RWPBUF-1                                        1079
         LA    @15,0(,@15)                                         1079
         ST    @15,RINBUFP                                         1079
*                       HEDBPTR= RINBUFP; /* UADS MAPPING PTR        */
         ST    @15,HEDBPTR                                         1080
*                       OLRDBUFL=RWPNOM*DCBBLKSI; /* SAVE LNG        */
         SLR   @15,@15                                             1081
         IC    @15,RWPNOM                                          1081
         LR    @08,@15                                             1081
         L     @01,DCBPTR                                          1081
         MH    @08,DCBBLKSI(,@01)                                  1081
         ST    @08,OLRDBUFL                                        1081
*                       OLNOBLK = RWPNOM; /* SAVE INPUT NO           */
         STH   @15,OLNOBLK                                         1082
*                       SVTTR = RDTTR;  /* RESERVE TTR  JUST READ    */
         L     @15,RWPRBP                                          1083
         MVC   SVTTR(3),RDTTR(@15)                                 1083
*                     END;                                         1084
*               END;                                               1085
@RF01077 DS    0H                                                  1086
*               END;                                               1086
@RC01057 DS    0H                                                  1087
*           R14 = SAVLNKC;          /* RESTORE LINK REGISTER         */
@RF01048 L     R14,SAVLNKC                                         1087
*           RETURN;                 /* RETURN                        */
         B     @EL00004                                            1088
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -- FNDTREE                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME -- N/A                                          */
*/*                                                                  */
*/* FUNCTION -- ADJUST LEVEL POINTERS TO SCAN AND REFORM NEXT        */
*/*             ITEM/AUTHORIZATION PATH                              */
*/*   OPERATION --                                                   */
*/*   -  SAVE ENTRY LINK REGISTER 14                                 */
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP FNDTREE FUNCTION */
*/*   -  IF TSO-STRUCTURE IS CURRENTLY BEING PROCESSED, SET OFFSET   */
*/*      TO 1ST TSO TYPE PASSWORD OFFSET BLOCK (UADSPWD1) IN INPUT   */
*/*      MEMBER INTO INPUT REBUILD-CONTROL TABLE 1ST OFFSET BLOCK    */
*/*      OFFSET (TREEOFF),  SET LOCATION OF FIRST OFFSET BLOCK IN    */
*/*      OUTPUT BUFFER IN OUTPUT REBUILD-CONTROL TABLE (NUFLOC),     */
*/*      AND SET CONTROL FLAG (DOWHYLT) TO CONTINUE PROCESSING TSO   */
*/*      STRUCTURE                                                   */
*/*   -  IF NOT CURRENTLY PROCESSING TSO-TYPE STRUCTURE, CLEAR FIRST */
*/*      OFFSET BLOCK OFFSET (TREEOFF)                               */
*/*   -  RESTORE ENTRY LINK REGISTER 14 AND RETURN                   */
*/*                                                                  */
*/* ENTRY -- LINKED BY REGISTER 14                                   */
*/*                                                                  */
*/* INPUT --                                                         */
*/*   -  UADSREFM ENVIRONMENT                                        */
*/*                                                                  */
*/* OUTPUT --                                                        */
*/*   -  OFFSET TO 1ST PASSWORD OFFSET BLOCK SET IN INPUT REBUILD-   */
*/*      CONTROL TABLE                                               */
*/*   -  LOCATION OF 1ST PASSWORD OFFSET BLOCK SET IN OUTPUT REBUILD-*/
*/*      CONTROL TABLE                                               */
*/*                                                                  */
*/* EXTERNAL REFERENCES -- N/A                                       */
*/*                                                                  */
*/* EXIT-NORMAL -- RETURN BY ENTRY LINK REGISTER 14                  */
*/*   CONDITIONS -- N/A                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* EXIT-ERROR --                                                    */
*/*   CONDITIONS -- N/A                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/********************************************************************/
*FNDTREE:   /* ADJUST LEVEL PTRS TO SCAN AND REFORM NEXT ITEM/PATH   */
*           ENTRY;                                                 1089
FNDTREE  DS    0H                                                  1090
*           SAVLNKC = R14;          /* SAVE LINK REGISTER            */
         ST    R14,SAVLNKC                                         1090
*           RESPECIFY (R14) UNRESTRICTED;                          1091
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */
*             THEN                  /* NO,                           */
         TM    QUITCHK,B'11100000'                                 1092
         BNZ   @RF01092                                            1092
*               DO;                                                1093
*                                                                  1093
*           IF TSONOW = '1'B        /* CHK IF TSO PROCESSING CURRENT */
*             THEN                  /* YES,                          */
         TM    TSONOW,B'00100000'                                  1094
         BNO   @RF01094                                            1094
*               DO;                                                1095
*                 TREEOFF = UADSPWD1; /* OFFSET TO 1ST TSO PASSWD    */
         L     @08,HEDBPTR                                         1096
         MVC   TREEOFF(4),UADSPWD1(@08)                            1096
*                 NUFLOC = ADDR(REXBUFP->UADSPWD1)-4;  /* TO 1ST OB  */
         L     @08,REXBUFP                                         1097
         LA    @08,UADSPWD1(,@08)                                  1097
         SL    @08,@CF00102                                        1097
         ST    @08,NUFLOC                                          1097
*                 DOWHYLT = 0;      /* SET TO LOOP THRU STRUCTURES   */
         SLR   @08,@08                                             1098
         STH   @08,DOWHYLT                                         1098
*               END;                                               1099
*             ELSE                  /* TSO PROCESSING NOT CURRENT    */
*               TREEOFF = 0;        /* CLEAR 1ST PASSWORD POINTER    */
*                                                                  1100
         B     @RC01094                                            1100
@RF01094 SLR   @08,@08                                             1100
         ST    @08,TREEOFF                                         1100
*               END;                                               1101
@RC01094 DS    0H                                                  1102
*           RESPECIFY (R14) RESTRICTED;                            1102
@RF01092 DS    0H                                                  1103
*           R14 = SAVLNKC;          /* RESTORE LINK REGISTER         */
         L     R14,SAVLNKC                                         1103
*           RETURN;                 /* RETURN                        */
         B     @EL00004                                            1104
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -- RITEM2                                           */
*/*                                                                  */
*/* DESCRIPTIVE NAME -- N/A                                          */
*/*                                                                  */
*/* FUNCTION -- BUILD NEW USERID MEMBER -- BUILD DATA BLOCK          */
*/*   OPERATION --                                                   */
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP RITEM2 FUNCTION  */
*/*   -  IF NO DATA BLOCK IS REQUIRED, EXIT                          */
*/*   -  IF INDICATED DATA BLOCK CURRENTLY EXISTS FOR MULTIPLE USAGE */
*/*      (DPLICHK), SET RESERVED OFFSET TO EXISTING BLOCK (SVFDAT2)  */
*/*      IN OUTPUT CURRENT NAME DATA BLOCK OFFSET (NNFDAT2) AND SET  */
*/*      RESERVED POINTER TO EXISTING BLOCK (SVDLOC2) IN OUTPUT      */
*/*      CURRENT DATA BLOCK POINTER (NNDLOC2)                        */
*/*   -  IF INDICATED DATA BLOCK DOES NOT CURRENTLY EXIST, PERFORM   */
*/*      SEGMENT GETDBSP TO ACQUIRE SPACE FROM FREESPACE QUEUE.  SET */
*/*      ACQUIRED OFFSET IN OUTPUT CURRENT NAME DATA BLOCK OFFSET    */
*/*      (NNFDAT2) AND SET DERIVED BLOCK POINTER (NNFDAT2+REXBUFP)   */
*/*      IN OUTPUT CURRENT DATA BLOCK POINTER (NNDLOC2).  COPY OLD   */
*/*      DATA BLOCK NAME (OLCDB) INTO NEW DATA BLOCK NAME SPACE      */
*/*      (NUCDB).  IF INPUT DATA BLOCK USAGE COUNT (OCDBCT) IS MORE  */
*/*      THAN 1, SET DUPLICATE USAGE FLAG (DUPLICHK) AND RESERVE     */
*/*      CURRENT OFFSET AND POINTER IN SVFDAT2 AND SVDLOC2           */
*/*   -  SET OFFSET TO CURRENT DATA BLOCK (NNFDAT2) IN CURRENT OUT-  */
*/*      PUT MEMBER OFFSET BLOCK (NCURUDAT)                          */
*/*   -  (RESTORE ENTRY LINK REGISTER 14 AND RETURN)                 */
*/*                                                                  */
*/* ENTRY -- N/A, INLINE SEGMENT (PSEUDO, LINKED BY REGISTER 14)     */
*/*                                                                  */
*/* INPUT --                                                         */
*/*   -  UADSREFM ENVIRONMENT                                        */
*/*                                                                  */
*/* OUTPUT -- N/A                                                    */
*/*                                                                  */
*/* EXTERNAL REFERENCES -- N/A                                       */
*/*                                                                  */
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */
*/*   CONDITIONS -- N/A                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* EXIT-ERROR -- N/A                                                */
*/*   CONDITIONS -- N/A                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */
*/*                                                                  */
*/********************************************************************/
*RITEM2:    /* BUILD NEW USERID MEMBER -- BUILD DATA BLOCK           */
*           ENTRY;                                                 1105
RITEM2   DS    0H                                                  1106
*           SAVLNKC = R14;          /* SAVE LINK REGISTER            */
         ST    R14,SAVLNKC                                         1106
*           RESPECIFY (R14) UNRESTRICTED;                          1107
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG          */
*             THEN                  /* NO,                           */
         TM    QUITCHK,B'11100000'                                 1108
         BNZ   @RF01108                                            1108
*               DO;                                                1109
*                                                                  1109
*           IF ONDLOC2 ^= 0         /* CHK IF ANY DATA BLOCK         */
*             THEN                  /* YES,                          */
         L     @08,ONMIDP                                          1110
         L     @08,ONDLOC2(,@08)                                   1110
         LTR   @08,@08                                             1110
         BZ    @RF01110                                            1110
*               DO;                                                1111
*                 IF DUPLICHK = 'FE'X    /* IS USAGE MORE THAN ONE ? */
*                   THEN            /* YES,                          */
         CLI   DUPLICHK(@08),254                                   1112
         BNE   @RF01112                                            1112
*                     DO;                                          1113
*                       NNFDAT2 = SVFDAT2;  /* USE RESERVED OFFSET   */
         L     @15,NNMIDP                                          1114
         MVC   NNFDAT2(4,@15),SVFDAT2(@08)                         1114
*                       NNDLOC2 = SVDLOC2;  /* USE RESERVED PTR      */
         MVC   NNDLOC2(4,@15),SVDLOC2(@08)                         1115
*                     END;                                         1116
*                                                                  1116
*                   ELSE            /* NOT YET MULTIPLE USAGE        */
*                     DO;                                          1117
         B     @RC01112                                            1117
@RF01112 DS    0H                                                  1118
*                       CALL  GETDBSP;  /* GET SPACE FOR DATA BLOCK  */
         BAL   @14,GETDBSP                                         1118
*                       NNFDAT2 = SPZBLOC; /* RESERVE NEW OFFSET     */
         L     @08,SPZBLOC                                         1119
         L     @15,NNMIDP                                          1119
         ST    @08,NNFDAT2(,@15)                                   1119
*                       NNDLOC2 = SPZBLOC+ADDR(REXBUF);  /* DATA PTR */
         AL    @08,REXBUFP                                         1120
         ST    @08,NNDLOC2(,@15)                                   1120
*                       NUCDB(1:SPZBLNG)=OLCDB(1:SPZBLNG);  /* DATA  */
         LH    @15,SPZBLNG                                         1121
         BCTR  @15,0                                               1121
         L     @01,ONMIDP                                          1121
         L     @01,ONDLOC2(,@01)                                   1121
         EX    @15,@SM02097                                        1121
*                       RESPECIFY (DNOBD) BASED(NNDLOC2);          1122
*                       IF ACTNOW = '1'B /* IS ACCTNMBR LEVEL NOW ?  */
*                         THEN      /* NO,                           */
         TM    ACTNOW,B'01000000'                                  1123
         BNO   @RF01123                                            1123
*                           UADSADRF = UADSADRF&&UADSADRF;  /* CLEAR */
         XC    UADSADRF(40,@08),UADSADRF(@08)                      1124
*                       RESPECIFY (DNOBD) BASED(UADSAPTR);         1125
@RF01123 DS    0H                                                  1126
*                       ACTNOW = '0'B;/* RESET ACCNT NMBR FLAG       */
         NI    ACTNOW,B'10111111'                                  1126
*                       IF OCDBCT > 1   /* IS USAGE CT OVER 1 ?      */
*                         THEN      /* YES,                          */
         L     @08,ONMIDP                                          1127
         L     @08,ONDLOC2(,@08)                                   1127
         CLI   OCDBCT(@08),1                                       1127
         BNH   @RF01127                                            1127
*                           DO;                                    1128
*                             DUPLICHK = 'FE'X;   /* MULTIPLE FLAG   */
         MVI   DUPLICHK(@08),X'FE'                                 1129
*                             SVFDAT2 = NNFDAT2;  /* RESERVE OFFSET  */
         L     @15,NNMIDP                                          1130
         MVC   SVFDAT2(4,@08),NNFDAT2(@15)                         1130
*                             SVDLOC2 = NNDLOC2;  /* RESERVE PTR     */
         MVC   SVDLOC2(4,@08),NNDLOC2(@15)                         1131
*                           END;                                   1132
*                     END;                                         1133
@RF01127 DS    0H                                                  1134
*                 NCURUDAT = NNFDAT2;  /* SET OFFSET IN NEW BUFFER   */
@RC01112 L     @08,NNMIDP                                          1134
         L     @01,NNFLOC2(,@08)                                   1134
         MVC   NCURUDAT(3,@01),NNFDAT2+1(@08)                      1134
*               END;                                               1135
*                                                                  1135
*               END;                                               1136
@RF01110 DS    0H                                                  1137
*           RESPECIFY (R14) RESTRICTED;                            1137
@RF01108 DS    0H                                                  1138
*           R14 = SAVLNKC;          /* RESTORE LINK REGISTER         */
         L     R14,SAVLNKC                                         1138
*           RETURN;                                                1139
         B     @EL00004                                            1139
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -- DOWRT2                                           */
*/*                                                                  */
*/* DESCRIPTIVE NAME -- N/A                                          */
*/*                                                                  */
*/* FUNCTION -- WRITE REFORMATTED MEMBER AND/OR FREE OUTPUT BUFFER   */
*/*   OPERATION --                                                   */
*/*   -  SAVE ENTRY LINK REGISTER 14                                 */
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP DOWRT2 FUNCTION  */
*/*   -  SET POINTER TO ACCOUNT-READ/WRITE PARAMETER BLOCK (RWPB)    */
*/*      IN REGISTER 1                                               */
*/*   -  EXECUTE ACCOUNT-WRITE -- IKJEFA52                           */
*/*   -  IF RETURN CODE (REGISTER 15) IS NOT 0 OR IS NOT 20 (ERROR   */
*/*      MESSAGE ISSUED BY ACCOUNT-WRITE), ISSUE ERROR MESSAGE 32    */
*/*      AND SET USERID TERMINATION FLAG (UIDQUIT)                   */
*/*   -  IF WRITE WAS SUCCESSFUL (RETURN CODE = 0) AND IF CURRENTLY  */
*/*      IN UPDAT MODE, RESET BUFFER-READ FLAG (IKJEFA52 FREE THE    */
*/*      UPDAT BUFFER)                                               */
*/*   -  RESTORE ENTRY LINK REGISTER 14 AND RETURN                   */
*/*                                                                  */
*/* ENTRY -- LINKED BY REGISTER 14                                   */
*/*                                                                  */
*/* INPUT --                                                         */
*/*   -  UADSREFM ENVIRONMENT                                        */
*/*   -  RWPB SET TO WRITE AND/OR FREE BUFFER                        */
*/*                                                                  */
*/* OUTPUT --                                                        */
*/*   -  REFORMATTED UADS MEMBER WRITTEN TO SYSUADS AND/OR OUTPUT    */
*/*      BUFFER FREED                                                */
*/*                                                                  */
*/* EXTERNAL REFERENCES -- ACCOUNT-WRITE -- IKJEFA52                 */
*/*                                                                  */
*/* EXIT-NORMAL -- RETURN BY ENTRY LINK REGISTER 14                  */
*/*   CONDITIONS --                                                  */
*/*   -  MEMBER WRITTEN AND/OR BUFFER FREED                          */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* EXIT-ERROR -- RETURN BY ENTRY LINK REGISTER 14                   */
*/*   CONDITIONS --                                                  */
*/*   -  UNSUCCESSFUL WRITE (UIDQUIT FLAG SET)                       */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/********************************************************************/
*DOWRT2:    /* WRITE REFORMATTED MEMBER AND/OR FREE BUFFER           */
*           ENTRY;                                                 1140
*                                                                  1140
DOWRT2   DS    0H                                                  1141
*           SAVLNKC = R14;          /* SAVE LINK REGISTER            */
         ST    R14,SAVLNKC                                         1141
*           RESPECIFY (R14) UNRESTRICTED;                          1142
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */
*             THEN                  /* NO,                           */
         TM    QUITCHK,B'11100000'                                 1143
         BNZ   @RF01143                                            1143
*               DO;                                                1144
*                                                                  1144
*           RESPECIFY (R1,R15) RESTRICTED;                         1145
*           R1 = ADDR(RWPB);        /* SET PTR TO WRITE PB           */
         LA    R1,RWPB                                             1146
*           CALL  IKJEFA52;         /* GO TO WRITE ROUTINE           */
         L     @15,@CV00038                                        1147
         BALR  @14,@15                                             1147
*           RTNCODE = R15;          /* RESERVE RETURN CODE           */
         ST    R15,RTNCODE                                         1148
*           RESPECIFY (R1,R15) UNRESTRICTED;                       1149
*           IF RTNCODE ^= 0         /* CHK FOR CODE FOR SUCCESS      */
*             THEN                  /* NO,                           */
         L     @08,RTNCODE                                         1150
         LTR   @08,@08                                             1150
         BZ    @RF01150                                            1150
*               DO;                                                1151
*                 UIDQUIT = '1'B;   /* SET USER TERMINATION          */
         OI    UIDQUIT,B'10000000'                                 1152
*                 IF RTNCODE ^= 20  /*     OR ERROR-MESSAGE-ISSUED   */
*                   THEN            /* NO,                           */
         LA    @15,20                                              1153
         CR    @08,@15                                             1153
         BE    @RF01153                                            1153
*                     DO;                                          1154
*                       MSGNO = 23;     /* SET MESSAGE INDEX         */
         MVC   MSGNO(2),@CH01991                                   1155
*                       SOFFS = 20;     /* SET TEXT INSERT OFFSET    */
         STH   @15,SOFFS                                           1156
*                       CALL  SYSERRD;  /* GO TO ISSUE MESSAGE       */
         BAL   @14,SYSERRD                                         1157
*                     END;                                         1158
*               END;                                               1159
*             ELSE                  /* SUCCESSFUL RETURN CODE,       */
*               IF RWPRBP ^= 0      /* CHK FOR UPDAT MODE            */
*                 THEN              /* YES,                          */
         B     @RC01150                                            1160
@RF01150 L     @08,RWPRBP                                          1160
         LTR   @08,@08                                             1160
         BZ    @RF01160                                            1160
*                   RDDONE = '0'B;  /* RESET BUFFER-READ FLAG        */
*                                                                  1161
         NI    RDDONE,B'11111110'                                  1161
*               END;                                               1162
@RF01160 DS    0H                                                  1162
@RC01150 DS    0H                                                  1163
*           RESPECIFY (R14) RESTRICTED;                            1163
@RF01143 DS    0H                                                  1164
*           R14 = SAVLNKC;          /* RESTORE LINK REGISTER         */
         L     R14,SAVLNKC                                         1164
*           RETURN;                 /* RETURN                        */
         B     @EL00004                                            1165
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -- RSTOW                                            */
*/*                                                                  */
*/* DESCRIPTIVE NAME -- N/A                                          */
*/*                                                                  */
*/* FUNCTION -- STOW REFORMATTED MEMBER NAME FOR SYSUADS UADS        */
*/*   OPERATION --                                                   */
*/*   -  SAVE ENTRY LINK REGISTER 14                                 */
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP RSTOW FUNCTION   */
*/*   -  INITIALIZE STOW PARAMETER BLOCK (STOLST)                    */
*/*   -  IF STOW IS FOR FIRST BLOCK OF USERID (IDENTITY CHARACTER OF */
*/*      ZERO) SET COUNT AND STRUCTURE TYPE FLAG (TSO/NEW) IN STOW   */
*/*      ENTRY USER AREA                                             */
*/*   -  IF IN UPDAT MODE, SET ALIAS FLAG (STLALYS)  AND USE THE     */
*/*      RESERVED TTR (SVTTR)                                        */
*/*   -  EXECUTE STOW MACRO                                          */
*/*   -  IF STOW RETURN CODE IS NOT ZERO, ISSUE ERROR MESSAGE 14 AND */
*/*      SET UADSREFM TERMINATION FLAG (RFMQUIT)                     */
*/*   -  RESTORE ENTRY LINK REGISTER 14 AND RETURN                   */
*/*                                                                  */
*/* ENTRY -- LINKED BY REGISTER 14                                   */
*/*                                                                  */
*/* INPUT --                                                         */
*/*   -  UADSREFM ENVIRONMENT                                        */
*/*   -  USERID NAME IN NODIDC                                       */
*/*                                                                  */
*/* OUTPUT --                                                        */
*/*   -  USERID MEMBER BLOCK NAME STOWED                             */
*/*                                                                  */
*/* EXTERNAL REFERENCES -- STOW MACRO                                */
*/*                                                                  */
*/* EXIT-NORMAL -- RETURN BY ENTRY LINK REGISTER 14                  */
*/*   CONDITIONS --                                                  */
*/*   -  SUCCESSFUL STOW                                             */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* EXIT-ERROR --  RETURN BY ENTRY LINK REGISTER 14                  */
*/*   CONDITIONS --                                                  */
*/*   -  UNSUCCESSFUL STOW (ERROR MESSAGE 14 AND RFMQUIT FLAG SET)   */
*/*   RETURN CODE --                                                 */
*/*                                                                  */
*/********************************************************************/
*RSTOW:     /* STOW REFORMATTED MEMBER FOR SYSUADS UADS              */
*           ENTRY;                                                 1166
RSTOW    DS    0H                                                  1167
*           SAVLNKC = R14;          /* SAVE LINK REGISTER            */
         ST    R14,SAVLNKC                                         1167
*           RESPECIFY (R14) UNRESTRICTED;                          1168
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */
*             THEN                  /* NO,                           */
         TM    QUITCHK,B'11100000'                                 1169
         BNZ   @RF01169                                            1169
*               DO;                                                1170
*                                                                  1170
*           STOLST=STOLST&&STOLST;  /* CLEAR STOW PARM BLOCK         */
         XC    STOLST(14),STOLST                                   1171
*           STLUSER(1:8) = NODIDC;  /* SET STOW NAME                 */
         MVC   STLUSER(8),NODIDC                                   1172
*           STLCTUA=STLCTUA&HIORDR3;  /* CLEAR LOWER ORDER           */
         SLR   @08,@08                                             1173
         IC    @08,STLCTUA                                         1173
         MVC   @ZT00003+3(1),HIORDR3                               1173
         N     @08,@ZT00003                                        1173
         STC   @08,STLCTUA                                         1173
*           STLCTUA=STLCTUA×1;      /* SET COUNT FOR USER AREA       */
         O     @08,@CF00032                                        1174
         STC   @08,STLCTUA                                         1174
*           IF NODIDC(NODIDL+1)='0'    /* CHK FOR 1ST MEMBER BLOCK   */
*             THEN                  /* YES,                          */
         LH    @08,NODIDL                                          1175
         LA    @01,NODIDC(@08)                                     1175
         CLI   0(@01),C'0'                                         1175
         BNE   @RF01175                                            1175
*               DO;                                                1176
*                 IF EQUIUAD = '1'B /* CHK FOR UPDAT MODE            */
*                   THEN            /* YES,                          */
         TM    EQUIUAD,B'01000000'                                 1177
         BNO   @RF01177                                            1177
*                     DO;                                          1178
*                       STLALYS = '1'B; /* SET ALIAS FLAG            */
         OI    STLALYS,B'10000000'                                 1179
*                       STLTTRC = SVTTR;  /* SET TTR FOR STOW        */
         MVC   STLTTRC(3),SVTTR                                    1180
*                     END;                                         1181
*               END;                                               1182
*                                                                  1182
@RF01177 DS    0H                                                  1183
*           RESPECIFY  (QNAMR,R15) RESTRICTED;  /* RESERVE REGISTER  */
@RF01175 DS    0H                                                  1184
*           QNAMR = RWPUDP;         /* SET PTR TO DCB                */
         L     QNAMR,RWPUDP-1                                      1184
         LA    QNAMR,0(,QNAMR)                                     1184
*           GEN(STOW  (QNAMR),STOLST,R);  /* TO EXECUTE STOW         */
         STOW  (QNAMR),STOLST,R
*           RTNCODE = R15;          /* RESERVE RETURN CODE           */
         ST    R15,RTNCODE                                         1186
*           RESPECIFY  (QNAMR,R15) UNRESTRICTED;  /* FREE REGISTER   */
*           IF RTNCODE ^= 0         /* CHK FOR SUCCESSFUL STOW  (OLD */
*               & RTNCODE ^= 8      /*    OR NEW MEMBER)             */
*             THEN                  /* NO,                           */
         L     @08,RTNCODE                                         1188
         LTR   @08,@08                                             1188
         BZ    @RF01188                                            1188
         CH    @08,@CH00046                                        1188
         BE    @RF01188                                            1188
*               DO;                                                1189
*                 MSGNO = 14;       /* SET MESSAGE INDEX             */
         MVC   MSGNO(2),@CH00231                                   1190
*                 SOFFS = 24;       /* SET TEXT INSERT OFFSET        */
         MVC   SOFFS(2),@CH00049                                   1191
*                 CALL  SYSERRD;    /* GO TO ISSUE MESSAGE           */
         BAL   @14,SYSERRD                                         1192
*                 RFMQUIT = '1'B;   /* SET UADSREFM TERMINATION FLAG */
         OI    RFMQUIT,B'01000000'                                 1193
*                 STODON = '0'B;    /* CLEAR STOW DONE FLAG          */
         NI    STODON,B'01111111'                                  1194
*               END;                                               1195
*             ELSE                  /* SUCCESSFUL STOW               */
*               STODON = '1'B;      /* SET STOW DONE FLAG            */
*                                                                  1196
         B     @RC01188                                            1196
@RF01188 OI    STODON,B'10000000'                                  1196
*               END;                                               1197
@RC01188 DS    0H                                                  1198
*           RESPECIFY (R14) RESTRICTED;                            1198
@RF01169 DS    0H                                                  1199
*           R14 = SAVLNKC;          /* RESTORE LINK REGISTER         */
         L     R14,SAVLNKC                                         1199
*           RETURN;                 /* RETURN                        */
         B     @EL00004                                            1200
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -- BLNKBUF                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME -- N/A                                          */
*/*                                                                  */
*/* FUNCTION -- CLEAR WRITE BUFFER TO BLANKS                         */
*/*   OPERATION --                                                   */
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */
*/*   -  INITIALIZE 1ST BYTE OF BUFFER TO BLANK                      */
*/*   -  RESTRICT REGISTER PTR TO OP CODE (RSPZOP) AND TO LENGTH OF  */
*/*      OPERATIVE AREA (RLNG)                                       */
*/*   -  SET LENGTH OF BUFFER LESS 1 IN RLNG                         */
*/*   -  SET PTR TO LARGE SCALE MVC OPERATION (RSPZOP)               */
*/*   -  RESTRICT REGISTER PTR TO SOURCE AREA (RFROM) AND TO TARGET  */
*/*      AREA (RTO)                                                  */
*/*   -  CALL SEGMENT DOPSPAZ TO PERFORM LARGE SCALE MVC             */
*/*   -  RELEASE RESTRICTED PTRS                                     */
*/*                                                                  */
*/* ENTRY -- N/A, INLINE SEGMENT (PSEUDO, LINKED BY REGISTER 14)     */
*/*                                                                  */
*/* INPUT --                                                         */
*/*   -  UADSREFM ENVIRONMENT                                        */
*/*                                                                  */
*/* OUTPUT --                                                        */
*/*   -  USERID MESSAGE BUFFER BLANKED OUT                           */
*/*                                                                  */
*/* EXTERNAL REFERENCES -- N/A                                       */
*/*                                                                  */
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */
*/*   CONDITIONS -- N/A                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* EXIT-ERROR -- N/A                                                */
*/*   CONDITIONS -- N/A                                              */
*/*   RETURN CODE -- N/A                                             */
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */
*/*        BE INCORPORATED  AS  AN INCLUDED CODE SEGMENT  WHEN THE   */
*/* INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION              */
*/*                                                                  */
*/********************************************************************/
*BLNKBUF:   /* FREE WRITE BUFFER IF CURRENTLY EXISTANT               */
*           ENTRY;                                                 1201
*                                                                  1201
BLNKBUF  DS    0H                                                  1202
*           SAVLNKC = R14;          /* SAVE LINK REGISTER            */
         ST    R14,SAVLNKC                                         1202
*           RESPECIFY (R14) UNRESTRICTED;                          1203
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */
*             THEN                  /* NO,                           */
         TM    QUITCHK,B'11100000'                                 1204
         BNZ   @RF01204                                            1204
*               DO;                                                1205
*                                                                  1205
*           IDSBUF(1) = ' ';        /* SET 1ST CHAR TO BLANK         */
         MVI   IDSBUF,C' '                                         1206
*           RESPECIFY  (RSPZOP,RLNG) RESTRICTED;                   1207
*           RLNG=LENGTH(IDSBUF)-1;  /* SET BLANKING LENGTH           */
         LA    RLNG,1079                                           1208
*           RSPZOP=ADDR(MVCOP);     /* SET PTR TO MVC OPERATION      */
         LA    RSPZOP,MVCOP                                        1209
*           RESPECIFY  (RFROM,RTO) RESTRICTED;                     1210
*           RFROM=ADDR(IDSBUF);     /* SET SOURCE PTR                */
         LA    RFROM,IDSBUF                                        1211
*           RTO = RFROM+1;          /* SET TARGET PTR                */
         LA    RTO,1                                               1212
         ALR   RTO,RFROM                                           1212
*           CALL  DOPSPAZ;          /* GO TO BLANK OUT BUFFER        */
         BAL   @14,DOPSPAZ                                         1213
*           RESPECIFY  (RSPZOP,RSPW,RLNG,RFROM,RTO) UNRESTRICTED;  1214
*                                                                  1214
*               END;                                               1215
*           RESPECIFY (R14) RESTRICTED;                            1216
@RF01204 DS    0H                                                  1217
*           R14 = SAVLNKC;          /* RESTORE LINK REGISTER         */
         L     R14,SAVLNKC                                         1217
*           END  OPENDCB;           /* RETURN                        */
         B     @EL00004                                            1218
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -- GETDBSP                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME -- N/A                                          */
*/*                                                                  */
*/* FUNCTION -- GET SPACE FOR DATA BLOCK FROM FREESPACE QUEUE        */
*/*   OPERATION --                                                   */
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP GETDBSP FUNCTION */
*/*   -  SET PARAMETER BLOCK(SPZBLNG) FOR LENGTH OF INPUT DATA BLOCK */
*/*   -  PERFORM SEGMENT DOGETSP TO LOCATE AVAILABLE FREE SPACE      */
*/*   -  (RESTORE ENTRY LINK REGISTER 14 AND RETURN)                 */
*/*                                                                  */
*/* ENTRY -- N/A, INLINE SEGMENT (PSEUDO, LINKED BY REGISTER 14)     */
*/*                                                                  */
*/* INPUT --                                                         */
*/*   -  UADSREFM ENVIRONMENT                                        */
*/*                                                                  */
*/* OUTPUT --                                                        */
*/*   -  BLOCK LENGTH SET IN GETSPACE PARAMETER BLOCK (SPZBLNG)      */
*/*      (SPACE ACQUIRED VIA DOGETSP)                                */
*/*                                                                  */
*/* EXTERNAL REFERENCES -- N/A                                       */
*/*                                                                  */
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */
*/*   CONDITIONS -- N/A                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* EXIT-ERROR -- N/A                                                */
*/*   CONDITIONS -- N/A                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */
*/*                                                                  */
*/********************************************************************/
*GETDBSP:   /* GET SPACE FOR DATA BLOCK FROM FREESPACE QUEUE         */
*                                                                  1219
*           PROCEDURE                                              1219
*                 OPTIONS(DONTSAVE,NOSAVEAREA); /* NO REGS SAVED,    */
GETDBSP  DS    0H                                                  1220
*                                   /* NO SAVE AREA CREATED          */
*           RESPECIFY (R14) RESTRICTED;                            1220
*           SAVLNKD = R14;          /* SAVE LINK REGISTER            */
         ST    R14,SAVLNKD                                         1221
*           RESPECIFY (R14) UNRESTRICTED;                          1222
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */
*             THEN                  /* NO,                           */
         TM    QUITCHK,B'11100000'                                 1223
         BNZ   @RF01223                                            1223
*               DO;                                                1224
*                                                                  1224
*           SPZBLNG = 12;           /* LENGTH FOR PASSWARD DATA BLK  */
         MVC   SPZBLNG(2),@CH00036                                 1225
*           IF TSTLVL > ADDR(OPOFFS)  /* CHK FOR PASSWORD LEVEL      */
*             THEN                  /* NO,                           */
         L     @08,TSTLVL                                          1226
         LA    @15,OPOFFS                                          1226
         CR    @08,@15                                             1226
         BNH   @RF01226                                            1226
*               DO;                                                1227
*                 IF TSTLVL > ADDR(OAOFFS) /* IS ACCTNMBR LEVEL ?    */
*                   THEN            /* NO,                           */
         LA    @15,OAOFFS                                          1228
         CR    @08,@15                                             1228
         BNH   @RF01228                                            1228
*                     SPZBLNG=24;   /* SET TO PROCNAME DB LENGTH     */
         MVC   SPZBLNG(2),@CH00049                                 1229
*                   ELSE            /* YES, ACCOUNT NUMBER LEVEL     */
*                     DO;                                          1230
         B     @RC01228                                            1230
@RF01228 DS    0H                                                  1231
*                       SPZBLNG=OCANLEN  /* SET TO ACCTNMBR          */
*                           +LENGTH(UADSADRF)+5;   /* DB LENGTH      */
         L     @08,ONMIDP                                          1231
         L     @08,ONDLOC2(,@08)                                   1231
         SLR   @01,@01                                             1231
         IC    @01,OCANLEN(,@08)                                   1231
         LA    @01,45(,@01)                                        1231
         STH   @01,SPZBLNG                                         1231
*                       ACTNOW = '1'B; /* SET ACCNT NMBR NOW FLAG    */
         OI    ACTNOW,B'01000000'                                  1232
*                     END;                                         1233
*               END;                                               1234
*                                                                  1234
@RC01228 DS    0H                                                  1235
*           CALL  DOGETSP;          /* GO TO ACQUIRE SPACE           */
*                                                                  1235
@RF01226 BAL   @14,DOGETSP                                         1235
*               END;                                               1236
*           RESPECIFY (R14) RESTRICTED;                            1237
@RF01223 DS    0H                                                  1238
*           R14 = SAVLNKD;          /* RESTORE LINK REGISTER         */
         L     R14,SAVLNKD                                         1238
*           RETURN;                 /* RETURN                        */
@EL00005 DS    0H                                                  1239
@EF00005 DS    0H                                                  1239
@ER00005 BR    @14                                                 1239
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -- RDEQM                                            */
*/*                                                                  */
*/* DESCRIPTIVE NAME -- N/A                                          */
*/*                                                                  */
*/* FUNCTION -- DEQUEUE FROM SYSIKJUA/'USERID-MEMBERNAME'            */
*/*   OPERATION --                                                   */
*/*   -  SAVE ENTRY LINK REGISTER 14                                 */
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP RDEQM FUNCTION   */
*/*   -  IF MEMBER NAME ENQUEUE IS CURRENTLY IN FORCE (NQMNOW), SET  */
*/*      POINTER TO RNAME (USERID) IN REGISTER 5 AND LENGTH OF NAME  */
*/*      IN REGISTER 6, SET POINTER TO DEQUEUE PARAMETER BLOCK       */
*/*      (DQMBR) IN REGISTER 1 AND EXECUTE DEQ MACRO                 */
*/*      -  IF RETURN CODE (REGISTER 15) IS NOT 0, CHECK RETURN CODE */
*/*         LIST (POINTED TO BY REGISTER 15)                         */
*/*         -  IF RETURN CODE LIST VALUE IS 4, CLEAR ENQUEUE IN      */
*/*            FORCE FLAG (NQMNOW)                                   */
*/*         _  FOR ANY OTHER RETURN CODE VALUE  ISSUE ERROR MESSAGE  */
*/*            27 AND SET UADSREFM TERMINATION FLAG (RFMQUIT)        */
*/*      -  IF PRIME RETURN CODE (REGISTER 15) IS 0, CLEAR ENQUEUE   */
*/*         IN FORCE FLAG (NQMNOW)                                   */
*/*   -  RESTORE ENTRY LINK REGISTER 14 AND RETURN                   */
*/*                                                                  */
*/* ENTRY -- LINKED BY REGISTER 14                                   */
*/*                                                                  */
*/* INPUT --                                                         */
*/*   -  UADSREFM ENVIRONMENT                                        */
*/*   -  ENQUEUED MEMBER NAME IN NQMIDC, LENGTH IN NQMIDL            */
*/*                                                                  */
*/* OUTPUT -- N/A                                                    */
*/*                                                                  */
*/* EXTERNAL REFERENCES -- DEQ MACRO                                 */
*/*                                                                  */
*/* EXIT-NORMAL -- RETURN BY ENTRY LINK REGISTER 14                  */
*/*   CONDITIONS --                                                  */
*/*   -  SUCCESSFUL DEQ                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* EXIT-ERROR -- RETURN BY ENTRY LINK REGISTER 14                   */
*/*   CONDITIONS --                                                  */
*/*   -  UNSUCCESSFUL DEQ (ISSUE MESSAGE 27 AND SET RFMQUIT          */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/********************************************************************/
*RDEQM:     /* DEQUEUE FROM USERID MEMBER NAME                       */
*           /* ENQUEUE AT RENQM                                      */
*           ENTRY;                                                 1240
*                                                                  1240
RDEQM    DS    0H                                                  1241
*           SAVLNKD = R14;          /* SAVE LINK REGISTER            */
         ST    R14,SAVLNKD                                         1241
*           RESPECIFY (R14) UNRESTRICTED;                          1242
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */
*             THEN                  /* NO,                           */
         TM    QUITCHK,B'11100000'                                 1243
         BNZ   @RF01243                                            1243
*               DO;                                                1244
*                                                                  1244
*           IF NQMNOW = '1'B        /* CHK IF ENQ IN FORCE           */
*             THEN                  /* YES,                          */
         TM    NQMNOW,B'00000010'                                  1245
         BNO   @RF01245                                            1245
*               DO;                                                1246
*                 RESPECIFY (QNAMR,QLNGR,R1,R15) RESTRICTED;       1247
*                 QNAMR = ADDR(NQMIDC);  /* SET PTR TO MINOR NAME    */
         LA    QNAMR,NQMIDC                                        1248
*                 QLNGR = NQMIDL;   /* SET MINOR NAME LENGTH         */
         LH    QLNGR,NQMIDL                                        1249
*                 R1 = ADDR(DQMBR); /* SET PTR TO DEQ PARM BLOCK     */
         LA    R1,DQMBR                                            1250
*                 /* DEQUEUE FROM SYSIKJUA/'USERID'                  */
*                 GEN(DEQ   (,(QNAMR),(QLNGR),,),MF=(E,(1)));      1251
         DEQ   (,(QNAMR),(QLNGR),,),MF=(E,(1))
*                 RTNCODE = R15;    /* RESERVE RETURN CODE           */
         ST    R15,RTNCODE                                         1252
*                 RESPECIFY (QNAMR,QLNGR,R1,R15) UNRESTRICTED;     1253
*                 IF RTNCODE^=0     /* CHK FOR SUCCESSFUL DEQUEUE    */
*                   THEN            /* NO,                           */
         L     @08,RTNCODE                                         1254
         LTR   @08,@08                                             1254
         BZ    @RF01254                                            1254
*                     DO;                                          1255
*                       RCPTR=RTNCODE;  /* SET PTR TO RETURN CODE    */
         ST    @08,RCPTR                                           1256
*                       IF RCLC1=4   /* IS ENQUEUE CURRENT           */
*                         THEN      /* NO,                           */
         CLI   RCLC1(@08),4                                        1257
         BNE   @RF01257                                            1257
*                           NQMNOW = '0'B;/*SET NO ENQ IN FORCE FLAG */
         NI    NQMNOW,B'11111101'                                  1258
*                         ELSE                                     1259
*                           DO;                                    1259
         B     @RC01257                                            1259
@RF01257 DS    0H                                                  1260
*                             MSGNO = 27;   /* SET MESSAGE INDEX     */
         MVC   MSGNO(2),@CH01967                                   1260
*                             SOFFS = 20;   /* SET TEXT OFFSET       */
         MVC   SOFFS(2),@CH00351                                   1261
*                             CALL SYSERRD; /* TO ISSUE PUTLINE      */
         BAL   @14,SYSERRD                                         1262
*                             RFMQUIT='1'B; /* TERMINATION FLAG      */
         OI    RFMQUIT,B'01000000'                                 1263
*                           END;                                   1264
*                     END;                                         1265
*                   ELSE            /* SUCCESSFUL DEQUEUE            */
*                     NQMNOW = '0'B;/* SET NO ENQ IN FORCE FLAG      */
         B     @RC01254                                            1266
@RF01254 NI    NQMNOW,B'11111101'                                  1266
*               END;                                               1267
*                                                                  1267
@RC01254 DS    0H                                                  1268
*               END;                                               1268
@RF01245 DS    0H                                                  1269
*           RESPECIFY (R14) RESTRICTED;                            1269
@RF01243 DS    0H                                                  1270
*           R14 = SAVLNKD;          /* RESTORE LINK REGISTER         */
         L     R14,SAVLNKD                                         1270
*           RETURN;                 /* RETURN                        */
         B     @EL00005                                            1271
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -- NOUSP                                            */
*/*                                                                  */
*/* DESCRIPTIVE NAME -- N/A                                          */
*/*                                                                  */
*/* FUNCTION -- ISSUE INSUFFICIENT SPACE FOR USERID MESSAGE          */
*/*   OPERATION --                                                   */
*/*   -  SAVE ENTRY LINK REGISTER 14                                 */
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP NOUSP FUNCTION   */
*/*   -  SET MESSAGE INDEX TO 16                                     */
*/*   -  PERFORM SEGMENT MSGFNDR TO LOCATE MESSAGE TEXT              */
*/*   -  BUILD DYNAMIC MESSAGE SEGMENT CONTAINING USERID NAME AND    */
*/*      BUILD DYNAMIC SEGMENT LIST (TMSGNS1)                        */
*/*   -  SET POINTER (MSGPTR) TO DYNAMIC SEGMENT LIST                */
*/*   -  PERFORM SEGMENT FXPUTL TO INITIALIZE PUTLINE PARM BLOCK     */
*/*   -  PERFORM SEGMENT DOPUTL TO ISSUE MESSAGE (VIA PUTLINE)       */
*/*   -  SET USERID TERMINATION FLAG (UIDQUIT)                       */
*/*   -  RESTORE ENTRY LINK REGISTER 14 AND RETURN                   */
*/*                                                                  */
*/* ENTRY -- LINKED BY REGISTER 14                                   */
*/*                                                                  */
*/* INPUT --                                                         */
*/*   -  UADSREFM ENVIRONMENT                                        */
*/*                                                                  */
*/* OUTPUT --                                                        */
*/*   -  ERROR MESSAGE 16                                            */
*/*   -  USERID TERMINATION FLAG SET (UIDQUIT)                       */
*/*                                                                  */
*/* EXTERNAL REFERENCES -- N/A                                       */
*/*                                                                  */
*/* EXIT-NORMAL -- RETURN BY ENTRY LINK REGISTER 14                  */
*/*   CONDITIONS -- N/A                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* EXIT-ERROR -- N/A                                                */
*/*   CONDITIONS -- N/A                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/********************************************************************/
*NOUSP:     /* ISSUE INSUFFICIENT SPACE FOR USERID MESSAGE           */
*                                                                  1272
*           ENTRY;                                                 1272
*                                                                  1272
NOUSP    DS    0H                                                  1273
*           SAVLNKD = R14;          /* RESERVE LINK REGISTER         */
         ST    R14,SAVLNKD                                         1273
*           RESPECIFY (R14) UNRESTRICTED;                          1274
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */
*             THEN                  /* NO,                           */
         TM    QUITCHK,B'11100000'                                 1275
         BNZ   @RF01275                                            1275
*               DO;                                                1276
*                                                                  1276
*           MSGNO = 16;             /* SET MESSAGE INDEX             */
         MVC   MSGNO(2),@CH00076                                   1277
*           CALL  MSGFNDR;          /* GO TO LOCATE MESSAGE          */
         BAL   @14,MSGFNDR                                         1278
*           TMSGNS1(1:12) = TMLMDL1(1:12);  /* SET SEGMENT LIST      */
         L     @08,MSGPTR                                          1279
         MVC   TMSGNS1(12),TMLMDL1(@08)                            1279
*           TMSGNP12 = ADDR(TMSGTIX1); /* SET 2ND SEGMENT PTR        */
         LA    @08,TMSGTIX1                                        1280
         ST    @08,TMSGNP12                                        1280
*           TMSGTIL1 = NODIDL+4;    /* SET SEGMENT LENGTH            */
         LH    @08,NODIDL                                          1281
         LA    @01,4(,@08)                                         1281
         STH   @01,TMSGTIL1                                        1281
*           TMSGTIO1 = 51;          /* SET TEXT OFFSET               */
         MVC   TMSGTIO1(2),@CH02008                                1282
*           TMSGTIN1(1:NODIDL) = NODIDC;  /* SET INSERT TEXT         */
         BCTR  @08,0                                               1283
         EX    @08,@SM02092                                        1283
*           MSGPTR = ADDR(TMSGNS1); /* SET PTR TO TEXT               */
*                                                                  1284
         LA    @08,TMSGNS1                                         1284
         ST    @08,MSGPTR                                          1284
*           CALL  FXPUTL;           /* INITIALIZE PARM LIST          */
         BAL   @14,FXPUTL                                          1285
*           CALL  DOPUTL;           /* TO ISSUE PUTLINE              */
         BAL   @14,DOPUTL                                          1286
*           UIDQUIT = '1'B;         /* SET USERID TERMINATION FLAG   */
*                                                                  1287
         OI    UIDQUIT,B'10000000'                                 1287
*               END;                                               1288
*           RESPECIFY (R14) RESTRICTED;                            1289
@RF01275 DS    0H                                                  1290
*           R14 = SAVLNKD;          /* RESTORE LINK REGISTER         */
         L     R14,SAVLNKD                                         1290
*           RETURN;                 /* RETURN                        */
         B     @EL00005                                            1291
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -- NOUFND                                           */
*/*                                                                  */
*/* DESCRIPTIVE NAME -- N/A                                          */
*/*                                                                  */
*/* FUNCTION -- ISSUE USERID NOT FOUND MESSAGE                       */
*/*   OPERATION --                                                   */
*/*   -  SAVE ENTRY LINK REGISTER 14                                 */
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP NOUFND FUNCTION  */
*/*   -  SET MESSAGE INDEX TO 5                                      */
*/*   -  PERFORM SEGMENT MSGFNDR TO LOCATE MESSAGE TEXT              */
*/*   -  BUILD DYNAMIC MESSAGE SEGMENT CONTAINING USERID NAME AND    */
*/*      BUILD DYNAMIC PUTLINE SEGMENT LIST (TMSGNS1)                */
*/*   -  SET POINTER (MSGPTR) TO DYNAMIC SEGMENT LIST                */
*/*   -  PERFORM SEGMENT FXPUTL TO INITIALIZE PUTLINE PARM BLOCK     */
*/*   -  PERFORM SEGMENT DOPUTL TO ISSUE MESSAGE (VIA PUTLINE)       */
*/*   -  SET USERID TERMINATION FLAG (UIDQUIT)                       */
*/*   -  RESTORE ENTRY LINK REGISTER 14 AND RETURN                   */
*/*                                                                  */
*/* ENTRY -- LINKED BY REGISTER 14                                   */
*/*                                                                  */
*/* INPUT --                                                         */
*/*   -  UADSREFM ENVIRONMENT                                        */
*/*                                                                  */
*/* OUTPUT --                                                        */
*/*   -  ERROR MESSAGE 5                                             */
*/*   -  USERID TERMINATION FLAG SET (UIDQUIT)                       */
*/*                                                                  */
*/* EXTERNAL REFERENCES -- N/A                                       */
*/*                                                                  */
*/* EXIT-NORMAL -- RETURN BY ENTRY LINK REGISTER 14                  */
*/*   CONDITIONS -- N/A                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* EXIT-ERROR -- N/A                                                */
*/*   CONDITIONS -- N/A                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/********************************************************************/
*NOUFND:    /* ISSUE USERID NOT FOUND MESSAGE                        */
*           ENTRY;                                                 1292
*                                                                  1292
NOUFND   DS    0H                                                  1293
*           SAVLNKD = R14;          /* RESERVE LINK REGISTER         */
         ST    R14,SAVLNKD                                         1293
*           RESPECIFY (R14) UNRESTRICTED;                          1294
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */
*             THEN                  /* NO,                           */
         TM    QUITCHK,B'11100000'                                 1295
         BNZ   @RF01295                                            1295
*               DO;                                                1296
*                                                                  1296
*           MSGNO = 5;              /* SET MESSAGE INDEX             */
         MVC   MSGNO(2),@CH00080                                   1297
*           CALL  MSGFNDR;          /* GO TO LOCATE MESSAGE          */
         BAL   @14,MSGFNDR                                         1298
*           TMSGNS1(1:12) = TMLMDL1(1:12);  /* SET SEGMENT LIST      */
         L     @08,MSGPTR                                          1299
         MVC   TMSGNS1(12),TMLMDL1(@08)                            1299
*           TMSGNP12 = ADDR(TMSGTIX1); /* SET 2ND SEGMENT PTR        */
         LA    @08,TMSGTIX1                                        1300
         ST    @08,TMSGNP12                                        1300
*           TMSGTIL1 = NODIDL+4;    /* SET SEGMENT LENGTH            */
         LH    @08,NODIDL                                          1301
         LA    @01,4(,@08)                                         1301
         STH   @01,TMSGTIL1                                        1301
*           TMSGTIO1 = 15;          /* SET TEXT OFFSET               */
         MVC   TMSGTIO1(2),@CH00174                                1302
*           TMSGTIN1(1:NODIDL) = NODIDC;  /* SET INSERT TEXT         */
         BCTR  @08,0                                               1303
         EX    @08,@SM02092                                        1303
*           MSGPTR = ADDR(TMSGNS1); /* SET PTR TO TEXT               */
*                                                                  1304
         LA    @08,TMSGNS1                                         1304
         ST    @08,MSGPTR                                          1304
*           CALL  FXPUTL;           /* INITIALIZE PARM LIST          */
         BAL   @14,FXPUTL                                          1305
*           CALL  DOPUTL;           /* TO ISSUE PUTLINE              */
         BAL   @14,DOPUTL                                          1306
*           UIDQUIT = '1'B;         /* SET USERID TERMINATION FLAG   */
*                                                                  1307
         OI    UIDQUIT,B'10000000'                                 1307
*               END;                                               1308
*           RESPECIFY (R14) RESTRICTED;                            1309
@RF01295 DS    0H                                                  1310
*           R14 = SAVLNKD;          /* RESTORE LINK REGISTER         */
         L     R14,SAVLNKD                                         1310
*           RETURN;                 /* RETURN                        */
         B     @EL00005                                            1311
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -- CLOSDCB                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME -- N/A                                          */
*/*                                                                  */
*/* FUNCTION -- CLOSE UADS AND DIRECTORY DCBS                        */
*/*   OPERATION --                                                   */
*/*   -  SAVE ENTRY LINK REGISTER 14                                 */
*/*   -  SET POINTER TO CLOSE PARAMETER BLOCK IN REGISTER 1          */
*/*   -  IF DCB IS OPEN (DCBOFOPN), EXECUTE CLOSE MACRO              */
*/*   -  IF DCB IS STILL OPEN AT END OF CLOSE MACRO EXECUTION, ISSUE */
*/*      ERROR MESSAGE (INDEX SET IN CALLER) AND SET RFMQUIT         */
*/*   -  RESTORE ENTRY LINK REGISTER 14 AND RETURN                   */
*/*                                                                  */
*/* ENTRY -- LINKED BY REGISTER 14                                   */
*/*                                                                  */
*/* INPUT --                                                         */
*/*   -  UADSREFM ENVIRONMENT                                        */
*/*                                                                  */
*/* OUTPUT --                                                        */
*/*   -  DCB CLOSED                                                  */
*/*                                                                  */
*/* EXTERNAL REFERENCES -- CLOSE MACRO                               */
*/*                                                                  */
*/* EXIT-NORMAL -- RETURN BY ENTRY LINK REGISTER 14                  */
*/*   CONDITIONS --                                                  */
*/*   -  SUCCESSFUL CLOSE                                            */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* EXIT-ERROR -- RETURN BY ENTRY LINK REGISTER 14                   */
*/*   CONDITIONS --                                                  */
*/*   -  UNSUCCESSFUL CLOSE (RFMQUIT FLAG SET)                       */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/********************************************************************/
*CLOSDCB:   /* CLOSE UADS AND DIRECTORY DCBS ROUTINE EP              */
*                                                                  1312
*           ENTRY;                                                 1312
*                                                                  1312
CLOSDCB  DS    0H                                                  1313
*           SAVLNKD  =  R14;        /* RESERVE LINK REGISTER         */
         ST    R14,SAVLNKD                                         1313
*           RESPECIFY (R14) UNRESTRICTED;                          1314
*                                                                  1314
*           /* ESTABLISH ADDRESSABILITY FOR DCB                      */
*           GENERATE (USING IHADCB,PPPPTR);                        1315
         USING IHADCB,PPPPTR
*           RESPECIFY (PPPPTR,R1) RESTRICTED;  /* RESERVE POINTERS   */
*                                                                  1316
*           R1  =  ADDR(RLCLSL);    /* SET PTR TO CLOSE  C P  PL     */
*                                                                  1317
         LA    R1,RLCLSL                                           1317
*           /* CHK IF OPEN NOW AND IF SO, CLOSE                      */
*           IF PPPPTR->DCBOFOPN = '1'B /* CHK FOR OPEN FLAG IN DCB   */
*             THEN                  /* YES, CLOSE                    */
         TM    DCBOFOPN(PPPPTR),B'00010000'                        1318
         BNO   @RF01318                                            1318
*               DO;                                                1319
*                 /* ISSUE CLOSE                                     */
*                 GENERATE (CLOSE ((PPPPTR),),MF=(E,(1)));         1320
         CLOSE ((PPPPTR),),MF=(E,(1))
*                 IF PPPPTR->DCBOFOPN = '1'B /* CHK IF STILL OPEN    */
*                   THEN            /* YES, ERROR                    */
         TM    DCBOFOPN(PPPPTR),B'00010000'                        1321
         BNO   @RF01321                                            1321
*                    DO;                                           1322
*                      CALL MSGFNDR;  /* LOCATE MESSAGE TEXT         */
         BAL   @14,MSGFNDR                                         1323
*                      CALL  FXPUTL;  /* INITIALIZE  P B             */
         BAL   @14,FXPUTL                                          1324
*                      CALL  DOPUTL;  /* TO ISSUE PUTLINE            */
         BAL   @14,DOPUTL                                          1325
*                      RFMQUIT = '1'B; /* SET TERMINATION FLAG       */
         OI    RFMQUIT,B'01000000'                                 1326
*                    END;                                          1327
*               END;                                               1328
*             ELSE     ;            /* NO, NOT OPEN                  */
*                                                                  1329
@RF01318 DS    0H                                                  1330
*           RESPECIFY (R14) RESTRICTED;                            1330
@RC01318 DS    0H                                                  1331
*           R14  =  SAVLNKD;        /* RESTORE LINK REGISTER         */
*                                                                  1331
         L     R14,SAVLNKD                                         1331
*           /* RELEASE DCB ADDRESSABILITY                            */
*           GENERATE(DROP  PPPPTR);                                1332
         DROP  PPPPTR
*           RESPECIFY  (PPPPTR,R1) UNRESTRICTED;  /* FREE POINTERS   */
*           END  GETDBSP;           /* RETURN                        */
         B     @EL00005                                            1334
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -- DOGETSP                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME -- N/A                                          */
*/*                                                                  */
*/* FUNCTION -- GET SPACE FOR REQUESTED BLOCK FROM FREESPACE QUEUE   */
*/*   OPERATION --                                                   */
*/*   -  SAVE ENTRY LINK REGISTER 14                                 */
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP DOGETSP FUNCTION */
*/*   -  SET NUMBER OF BLOCKS IN GETSPACE PARAMETER BLOCK (SPZBLKN)  */
*/*      EQUAL TO TOTAL AVAILABLE BLOCKS (NUMBLKS).                  */
*/*   -  SET POINTER TO OUTPUT BUFFER (REXBUF) IN GETSPACE PARAMETER */
*/*      BLOCK (SPZBUFP)                                             */
*/*   -  PERFORM IKJEFA53 (ACCOUNT-GETSPACE)                         */
*/*   -  IF GETSPACE RETURN CODE IS 8 (MEANING NO AVAILABLE SPACE    */
*/*      FOUND) PERFORM SEGMENT GSPZERR TO ISSUE NO SPACE MESSAGE    */
*/*   -  FOR ANY OTHER RETURN CODE, PERFORM SEGMENT GSPZER2 TO ISSUE */
*/*      ERROR MESSAGE                                               */
*/*   -  RESTORE ENTRY LINK REGISTER 14 AND RETURN                   */
*/*                                                                  */
*/* ENTRY -- LINKED BY REGISTER 14                                   */
*/*                                                                  */
*/* INPUT --                                                         */
*/*   -  UADSREFM ENVIRONMENT                                        */
*/*   -  NUMBER OF BLOCKS IN CURRENT USERID IN (RWPNOM)              */
*/*                                                                  */
*/* OUTPUT --                                                        */
*/*   -  OFFSET TO ACQUIRED AREA IN PARAMETER BLOCK (SPZBLOC)        */
*/*                                                                  */
*/* EXTERNAL REFERENCES -- ACCOUNT-GETSPACE ROUTINE -- IKJEFA53      */
*/*                                                                  */
*/* EXIT-NORMAL -- RETURN BY ENTRY LINK REGISTER 14                  */
*/*   CONDITIONS --                                                  */
*/*   -  SUCCESSFUL GETSPACE                                         */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* EXIT-ERROR -- RETURN BY ENTRY LINK REGISTER 14                   */
*/*   CONDITIONS --                                                  */
*/*   -  UNSUCCESSFUL GETSPACE                                       */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/********************************************************************/
*DOGETSP:   /* GET SPACE FOR REQUESTED BLOCK FROM FREESPACE QUEUE    */
*                                                                  1335
*           PROCEDURE                                              1335
*                 OPTIONS(DONTSAVE,NOSAVEAREA); /* NO REGS SAVED,    */
DOGETSP  DS    0H                                                  1336
*                                   /* NO SAVE AREA CREATED          */
*           RESPECIFY (R14) RESTRICTED;                            1336
*           SAVLNKE = R14;          /* SAVE LINK REGISTER            */
         ST    R14,SAVLNKE                                         1337
*           RESPECIFY (R14) UNRESTRICTED;                          1338
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */
*             THEN                  /* NO,                           */
         TM    QUITCHK,B'11100000'                                 1339
         BNZ   @RF01339                                            1339
*               DO;                                                1340
*                                                                  1340
*           SPZBLKN = NUMBLKS;      /* RESTORE TOTAL BLOCK NUMBER    */
         MVC   SPZBLKN(2),NUMBLKS                                  1341
*           SPZBUFP = ADDR(REXBUF); /* PTR TO MEMBER BUFFER          */
         MVC   SPZBUFP(4),REXBUFP                                  1342
*           RESPECIFY (R1,R15) RESTRICTED;                         1343
*           R1 = ADDR(SPAZPB);      /* PTR TO GETSPACE  P B          */
         LA    R1,SPAZPB                                           1344
*           CALL  IKJEFA53;         /* GO TO GETSPACE                */
         L     @15,@CV00039                                        1345
         BALR  @14,@15                                             1345
*           RTNCODE = R15;          /* RESERVE RETURN CODE           */
         ST    R15,RTNCODE                                         1346
*           RESPECIFY (R1,R15) UNRESTRICTED;                       1347
*           IF RTNCODE ^< 8         /* CHK FOR SUCCESS CODE          */
*             THEN                  /* NO,                           */
         L     @08,RTNCODE                                         1348
         LA    @15,8                                               1348
         CR    @08,@15                                             1348
         BL    @RF01348                                            1348
*               DO;                                                1349
*                 IF RTNCODE = 8    /* NO-SPACE CODE ?               */
*                   THEN            /* YES,                          */
         CR    @08,@15                                             1350
         BNE   @RF01350                                            1350
*                     CALL  GSPZERR;  /* NO SPACE MSG                */
         BAL   @14,GSPZERR                                         1351
*                   ELSE            /* NO LEGITIMATE RETURN CODE     */
*                     CALL  GSPZER2;  /* CODE ERROR MSG              */
         B     @RC01350                                            1352
@RF01350 BAL   @14,GSPZER2                                         1352
*               END;                                               1353
*                                                                  1353
@RC01350 DS    0H                                                  1354
*               END;                                               1354
@RF01348 DS    0H                                                  1355
*           RESPECIFY (R14) RESTRICTED;                            1355
@RF01339 DS    0H                                                  1356
*           R14 = SAVLNKE;          /* RESTORE LINK REGISTER         */
         L     R14,SAVLNKE                                         1356
*           END  DOGETSP;           /* RETURN                        */
@EL00006 DS    0H                                                  1357
@EF00006 DS    0H                                                  1357
@ER00006 BR    @14                                                 1357
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -- GSPZERR                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME -- N/A                                          */
*/*                                                                  */
*/* FUNCTION -- ISSUE NO BLOCK SPACE AVAILABLE MESSAGE               */
*/*   OPERATION --                                                   */
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP GSPZERR FUNCTION */
*/*   -  SET MESSAGE INDEX 18                                        */
*/*   -  PERFORM SEGMENT MSGFNDR TO LOCATE MESSAGE TEXT              */
*/*   -  BUILD DYNAMIC MESSAGE SEGMENT CONTAINING USERID NAME AND    */
*/*      BUILD DYNAMIC SEGMENT LIST (TMSGNS1)                        */
*/*   -  SET POINTER (MSGPTR) TO DYNAMIC SEGMENT LIST                */
*/*   -  PERFORM SEGMENT FXPUTL TO INITIALIZE PUTLINE PARM BLOCK     */
*/*   -  PERFORM SEGMENT DOPUTL TO ISSUE MESSAGE                     */
*/*   -  SET USERID TERMINATION FLAG (UIDQUIT)                       */
*/*   -  (RESTORE ENTRY LINK REGISTER 14 AND RETURN)                 */
*/*                                                                  */
*/* ENTRY -- N/A, INLINE SEGMENT (PSEUDO, LINKED BY REGISTER 14)     */
*/*                                                                  */
*/* INPUT --                                                         */
*/*   -  UADSREFM ENVIRONMENT                                        */
*/*                                                                  */
*/* OUTPUT --                                                        */
*/*   -  ERROR MESSAGE 18 (THROUGH DOPUTL)                           */
*/*   -  USERID TERMINATION FLAG SET (UIDQUIT)                       */
*/*                                                                  */
*/* EXTERNAL REFERENCES -- N/A                                       */
*/*                                                                  */
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */
*/*   CONDITIONS --                                                  */
*/*   -  MESSAGE 18 ISSUED                                           */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* EXIT-ERROR -- N/A                                                */
*/*   CONDITIONS -- N/A                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */
*/*                                                                  */
*/********************************************************************/
*GSPZERR:   /* ISSUE NO BLOCK SPACE ERROR MESSAGE                    */
*           PROCEDURE                                              1358
*                 OPTIONS(DONTSAVE,NOSAVEAREA); /* NO REGS SAVED,    */
GSPZERR  DS    0H                                                  1359
*                                   /* NO SAVE AREA CREATED          */
*           RESPECIFY (R14) RESTRICTED;                            1359
*           SAVLNKF = R14;          /* SAVE LINK REGISTER            */
         ST    R14,SAVLNKF                                         1360
*           RESPECIFY (R14) UNRESTRICTED;                          1361
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */
*             THEN                  /* NO,                           */
         TM    QUITCHK,B'11100000'                                 1362
         BNZ   @RF01362                                            1362
*               DO;                                                1363
*                                                                  1363
*           MSGNO = 18;             /* SET MESSAGE INDEX             */
         MVC   MSGNO(2),@CH00181                                   1364
*           CALL MSGFNDR;           /* LOCATE TEXT                   */
         BAL   @14,MSGFNDR                                         1365
*           TMSGNS1(1:20)=TMLMDL1;  /* SET SEGMENT LIST              */
         L     @08,MSGPTR                                          1366
         MVC   TMSGNS1(20),TMLMDL1(@08)                            1366
*           TMSGNP13 = ADDR(TMSGTIX1);  /* SET TO SECOND SEGMENT     */
         LA    @08,TMSGTIX1                                        1367
         ST    @08,TMSGNP13                                        1367
*           TMSGTIL1 = NODIDL+4;    /*SET LENGTH OF SEGMENT          */
         LH    @08,NODIDL                                          1368
         LA    @01,4(,@08)                                         1368
         STH   @01,TMSGTIL1                                        1368
*           TMSGTIO1 = 9;           /* SET INSERT OFFSET             */
         MVC   TMSGTIO1(2),@CH00033                                1369
*           TMSGTIN1(1:NODIDL)=NODIDC(1:NODIDL);  /* INSERT USERID   */
         BCTR  @08,0                                               1370
         EX    @08,@SM02092                                        1370
*           MSGPTR = ADDR(TMSGNS1); /* SET TO INITIAL SEGMENT        */
         LA    @08,TMSGNS1                                         1371
         ST    @08,MSGPTR                                          1371
*           CALL FXPUTL;            /* TO INITIALIZE PARM BLOCK      */
         BAL   @14,FXPUTL                                          1372
*           CALL DOPUTL;            /* TO ISSUE PUTLINE              */
         BAL   @14,DOPUTL                                          1373
*           UIDQUIT = '1'B;         /* SET USERID TERMINATION FLAG   */
*                                                                  1374
         OI    UIDQUIT,B'10000000'                                 1374
*               END;                                               1375
*           RESPECIFY (R14) RESTRICTED;                            1376
@RF01362 DS    0H                                                  1377
*           R14 = SAVLNKF;          /* RESTORE LINK REGISTER         */
         L     R14,SAVLNKF                                         1377
*           RETURN;                 /* RETURN                        */
@EL00007 DS    0H                                                  1378
@EF00007 DS    0H                                                  1378
@ER00007 BR    @14                                                 1378
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -- GSPZER2                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME -- N/A                                          */
*/*                                                                  */
*/* FUNCTION -- ISSUE GETSPACE RETURN CODE ERROR MESSAGE             */
*/*   OPERATION --                                                   */
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */
*/*   -  IF TERMINATION FLAG (QUITCHK) IS SET, SKIP GSPZER2 FUNCTION */
*/*   -  SET MESSAGE INDEX 19                                        */
*/*   -  SET INSERTION OFFSET (SOFFS) TO 20                          */
*/*   -  PERFORM SEGMENT SYSERRD TO ISSUE MESSAGE                    */
*/*   -  SET UADSREFM TERMINATION FLAG (RFMQUIT)                     */
*/*   -  (RESTORE ENTRY LINK REGISTER 14 AND RETURN                  */
*/*                                                                  */
*/* ENTRY -- N/A, INLINE SEGMENT (PSEUDO, LINKED BY REGISTER 14)     */
*/*                                                                  */
*/* INPUT --                                                         */
*/*   -  UADSREFM ENVIRONMENT                                        */
*/*                                                                  */
*/* OUTPUT --                                                        */
*/*   -  ERROR MESSAGE 19 (VIA SYSERRD)                              */
*/*   -  UADSREFM TERMINATION FLAG SET (RFMQUIT)                     */
*/*                                                                  */
*/* EXTERNAL REFERENCES -- N/A                                       */
*/*                                                                  */
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */
*/*   CONDITIONS -- N/A                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* EXIT-ERROR -- N/A                                                */
*/*   CONDITIONS -- N/A                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */
*/*                                                                  */
*/********************************************************************/
*GSPZER2:   /* ISSUE GETSPACE RETURN CODE ERROR MESSAGE              */
*                                                                  1379
*           ENTRY;                                                 1379
GSPZER2  DS    0H                                                  1380
*           SAVLNKF = R14;          /* SAVE LINK REGISTER            */
         ST    R14,SAVLNKF                                         1380
*           RESPECIFY (R14) UNRESTRICTED;                          1381
*           IF QUITCHK = '000'B     /* ANY TERMINATION FLAG ?        */
*             THEN                  /* NO,                           */
         TM    QUITCHK,B'11100000'                                 1382
         BNZ   @RF01382                                            1382
*               DO;                                                1383
*                                                                  1383
*           MSGNO = 19;             /* MESSAGE INDEX                 */
         MVC   MSGNO(2),@CH02026                                   1384
*           SOFFS = 20;             /* TEXT OFFSET                   */
         MVC   SOFFS(2),@CH00351                                   1385
*           CALL  SYSERRD;          /* TO ISSUE MESSAGE              */
         BAL   @14,SYSERRD                                         1386
*           RFMQUIT = '1'B;         /* TERMINATION FLAG              */
*                                                                  1387
         OI    RFMQUIT,B'01000000'                                 1387
*               END;                                               1388
*           RESPECIFY (R14) RESTRICTED;                            1389
@RF01382 DS    0H                                                  1390
*           R14 = SAVLNKF;          /* RESTORE LINK REGISTER         */
         L     R14,SAVLNKF                                         1390
*           END  GSPZERR;           /* RETURN                        */
         B     @EL00007                                            1391
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -- DOPSPAZ                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME -- N/A                                          */
*/*                                                                  */
*/* FUNCTION -- PERFORM LARGE SCALE CHARACTER OPERATION              */
*/*   OPERATION --                                                   */
*/*   -  SAVE ENTRY LINK REGISTER 14                                 */
*/*   -  REDUCE LENGTH COUNT BY 1 (COMPENSATE FOR CHARACTER OPERA-   */
*/*      TION COUNT CONTROL)                                         */
*/*   -  FORM CURRENT CHARACTER COUNT IN (RSPW)                      */
*/*   -  EXECUTE CHARACTER OPERATION FOR COUNT OF (RSPW)             */
*/*   -  STEP SOURCE LOCATION (RFROM)                                */
*/*   -  STEP TARGET LOCATION (RTO)                                  */
*/*   -  DECREMENT TOTAL COUNT (RLNG) BY CURRENTLY USED COUNT (RSPW) */
*/*   -  IF ANY COUNT REMAINS IN (RLNG) REPEAT WHOLE FUNCTION        */
*/*   -  RESTORE ENTRY LINK REGISTER 14 AND RETURN                   */
*/*                                                                  */
*/* ENTRY -- LINKED BY REGISTER 14                                   */
*/*                                                                  */
*/* INPUT --                                                         */
*/*   -  NUMBER OF CHARACTERS FOR OPERATION IN (RSPW)                */
*/*   -  POINTER TO CHARACTER OPERATION TO EXECUTED IN (RSPZOP)      */
*/*   -  POINTER TO START OF SOURCE AREA IN (RFROM)                  */
*/*   -  POINTER TO START OF TARGET AREA IN (RTO)                    */
*/*                                                                  */
*/* OUTPUT --                                                        */
*/*   -  TARGET CHARACTER AREA MODIFIED                              */
*/*                                                                  */
*/* EXTERNAL REFERENCES -- N/A                                       */
*/*                                                                  */
*/* EXIT-NORMAL -- RETURN BY ENTRY LINK REGISTER 14                  */
*/*   CONDITIONS -- N/A                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* EXIT-ERROR -- N/A                                                */
*/*   CONDITIONS -- N/A                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/********************************************************************/
*DOPSPAZ:   /* PERFORM LARGE SCALE CHARACTER OPERATION               */
*           PROCEDURE                                              1392
*                 OPTIONS(DONTSAVE,NOSAVEAREA); /* NO REGS SAVED,    */
DOPSPAZ  DS    0H                                                  1393
*                                   /* NO SAVE AREA CREATED          */
*           RESPECIFY (R14) RESTRICTED;                            1393
*           SAVLNKG = R14;          /* SAVE LINK REGISTER            */
         ST    R14,SAVLNKG                                         1394
*           RESPECIFY (R14) UNRESTRICTED;                          1395
*                                                                  1395
*           RESPECIFY  (RSPW,RSPZOP,RLNG,RFROM,RTO) RESTRICTED;    1396
*           GENERATE;                                              1397
OPSPAZ    EQU    *
          BCTR   RLNG,0             COMPENSATE COUNT FOR CHAR OPN
          LA     RSPW,255           SET MAXIMUM CHAR COUNT
          NR     RSPW,RLNG          EXTRACT CURRENT CHAR COUNT
          EX     RSPW,0(RSPZOP)     EXEC CHAR OPERATION
          LA     RFROM,1(RSPW,RFROM)  INCREMENT FROM LOCATION
          LA     RTO,1(RSPW,RTO)    INCREMENT TO LOCATION
          SR     RLNG,RSPW          DECREMENT TOTAL COUNT BY CURRENT
          BNZ    OPSPAZ             CONTINUE '1'B REMAINING COUNT
*           RESPECIFY  (RSPW,RSPZOP,RLNG,RFROM,RTO) UNRESTRICTED;  1398
*                                                                  1398
*           RESPECIFY (R14) RESTRICTED;                            1399
*           R14 = SAVLNKG;          /* RESTORE LINK REGISTER         */
         L     R14,SAVLNKG                                         1400
*           RETURN;                 /* RETURN                        */
@EL00008 DS    0H                                                  1401
@EF00008 DS    0H                                                  1401
@ER00008 BR    @14                                                 1401
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -- SYSERRD                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME -- N/A                                          */
*/*                                                                  */
*/* FUNCTION -- BUILD AND ISSUE SYSTEM-ERROR-TYPE MESSAGE            */
*/*   OPERATION --                                                   */
*/*   -  SAVE ENTRY LINK REGISTER 14                                 */
*/*   -  IF ENTRY MADE AT SYSERRD, CONVERT BINARY VALUE (RTNCODE) TO */
*/*      DECIMAL BASE VALUE BACK INTO (RTNCODE)                      */
*/*   -  (ENTRY SYSERRX, OR CONTINUATION)                            */
*/*      SAVE ENTRY LINK REGISTER 14                                 */
*/*   -  PERFORM SEGMENT MSGFNDR TO LOCATE TEXT                      */
*/*   -  UNPACK DECIMAL BASE VALUE (RTNCODE) AND TRANSLATE RESULT TO */
*/*      EBCDIC INTO DYNAMIC MESSAGE SEGMENT (TMSGTIN1)              */
*/*   -  BUILD DYNAMIC MESSAGE SEGMENT LIST (TMSGNS1)                */
*/*   -  SET POINTER (MSGPTR) TO DYNAMIC SEGMENT LIST                */
*/*   -  PERFORM SEGMENT FXPUTLM TO INITIALIZE PUTLINE PARM BLOCK    */
*/*   -  PERFORM SEGMENT DOPUTL TO ISSUE MESSAGE                     */
*/*   -  RESTORE ENTRY LINK REGISTER 14 AND RETURN                   */
*/*                                                                  */
*/* ENTRY -- SYSERRD, TO ACCEPT BINARY VALUE                         */
*/*   -  LINKED BY REGISTER 14                                       */
*/* ENTRY -- SYSERRX, TO ACCEPT DECIMAL VALUE                        */
*/*   -  LINKED BY REGISTER 14                                       */
*/*                                                                  */
*/* INPUT --                                                         */
*/*   -  UADSREFM ENVIRONMENT                                        */
*/*   -  TRANSLATABLE VALUE IN RTNCODE                               */
*/*   -  MESSAGE INDEX IN MSGNO                                      */
*/*   -  TEXT INSERTION OFFSET IN SOFFS                              */
*/*                                                                  */
*/* OUTPUT --                                                        */
*/*   -  MESSAGE ISSUED                                              */
*/*                                                                  */
*/* EXTERNAL REFERENCES -- N/A                                       */
*/*                                                                  */
*/* EXIT-NORMAL -- RETURN BY ENTRY LINK REGISTER 14                  */
*/*   CONDITIONS -- N/A                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* EXIT-ERROR -- N/A                                                */
*/*   CONDITIONS -- N/A                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/********************************************************************/
*SYSERRD:   /* SYSTEM ERROR MESSAGE ROUTINE EP                       */
*           ENTRY;                                                 1402
*                                                                  1402
SYSERRD  DS    0H                                                  1403
*           SAVLNKG = R14;          /* RESERVE LINK REGISTER         */
         ST    R14,SAVLNKG                                         1403
*           /* FORM DECIMAL BASE IN RTNCODE                          */
*           GENERATE;                                              1404
*                                                                  1404
         L     R3,RTNCODE             CODE INTO CONVERSION REGISTER
         CVD   R3,DBLWORD             CONVERT TO DECIMAL BASE FIGURES
         L     R3,DBLWD2              CONVERSION INTO REGISTER
         ST    R3,RTNCODE             CONVERSION INTO UNPACK AREA
*SYSERRX:   /* EP TO FORM HEXIDECIMAL PRINT IMAGE FOR MESSAGE        */
*           ENTRY;                                                 1405
         B     @EC01405                                            1405
SYSERRX  DS    0H                                                  1405
@EC01405 DS    0H                                                  1406
*           SAVLNKG = R14;          /* RESERVE LINK REGISTER         */
         ST    R14,SAVLNKG                                         1406
*           RESPECIFY (R14) UNRESTRICTED;                          1407
*           CALL  MSGFNDR;          /* GO TO LOCATE MESSAGE          */
*                                                                  1408
         BAL   @14,MSGFNDR                                         1408
*           /* UNPACK AND TRANSLATE TO EBCDIC CHARACTERS             */
*           GENERATE;                                              1409
*                                                                  1409
         UNPK  MSGCDE-1(6),RTNCCHS(3) UNPACK BINARY CHARACTER AREA
         TR    TMSGTIN1(3),HEXTBL-240 TRANSLATE TO EBCDIC
*           TMSGNS1(1:28) = TMLMDL1(1:28);  /* SET SEGMENT LIST      */
         L     @08,MSGPTR                                          1410
         MVC   TMSGNS1(28),TMLMDL1(@08)                            1410
*           TMSGNNO1 = ADDR(TMSGNS2);  /* SET PTR TO SECOND LEVEL    */
         LA    @15,TMSGNS2                                         1411
         ST    @15,TMSGNNO1                                        1411
*           TMSGNS2(1:20)=TMLMDL2(1:20);  /* SET SECOND SEGMENT LIST */
         L     @08,TMLNX1(,@08)                                    1412
         MVC   TMSGNS2(20),TMLMDL2(@08)                            1412
*           TMSGNP24 = ADDR(TMSGTIX1); /* SET MESSAGE POINTER        */
         LA    @08,TMSGTIX1                                        1413
         ST    @08,TMSGNP24                                        1413
*           TMSGTIL1 = 6;           /* SET LENGTH OF SEGMENT         */
         MVC   TMSGTIL1(2),@CH00118                                1414
*           TMSGTIO1 = SOFFS;       /* SET INSERT OFFSET             */
         MVC   TMSGTIO1(2),SOFFS                                   1415
*           MSGPTR = ADDR(TMSGNS1); /* SET PTR TO TEXT               */
*                                                                  1416
         LA    @08,TMSGNS1                                         1416
         ST    @08,MSGPTR                                          1416
*           CALL  FXPUTLM;          /* GO TO INITIALIZE PARM BLOCK   */
         BAL   @14,FXPUTLM                                         1417
*           CALL  DOPUTL;           /* GO TO ISSUE MESSAGE           */
*                                                                  1418
         BAL   @14,DOPUTL                                          1418
*           RESPECIFY (R14) RESTRICTED;                            1419
*           R14 = SAVLNKG;          /* RESTORE LINK REGISTER         */
         L     R14,SAVLNKG                                         1420
*           END  DOPSPAZ;           /* RETURN                        */
         B     @EL00008                                            1421
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -- MSGFNDR                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME -- N/A                                          */
*/*                                                                  */
*/* FUNCTION -- LOCATE MESSAGE TEXT IN MESSAGE CSECT (ANDXL)         */
*/*   OPERATION --                                                   */
*/*   -  SAVE ENTRY LINK REGISTER 14                                 */
*/*   -  FIND MESSAGE TEXT OFFSET (MOFFND) IN INDEX TABLE BY MULTI-  */
*/*      PLYING THE INDEX NUMBER (MSGNO) BY 2 AND ADDING THE LOCA-   */
*/*      TION OF THE START OF INDEX TABLE -2  (ANDXL-2)              */
*/*   -  FORM POINTER TO MESSAGE TEXT (MSGPTR) BY ADDING EXTRACTED   */
*/*      INDEX OFFSET (MOFFNO) AND LOCATION OF TEXT CSECT (ANDXL)    */
*/*   -  RESTORE ENTRY LINK REGISTER 14 AND RETURN                   */
*/*                                                                  */
*/* ENTRY -- LINKED BY REGISTER 14                                   */
*/*                                                                  */
*/* INPUT --                                                         */
*/*   -  UADSREFM ENVIRONMENT                                        */
*/*   -  MESSAGE INDEX NUMBER IN MSGNO                               */
*/*                                                                  */
*/* OUTPUT --                                                        */
*/*   -  POINTER TO MESSAGE TEXT IN MSGPTR                           */
*/*                                                                  */
*/* EXTERNAL REFERENCES -- N/A                                       */
*/*                                                                  */
*/* EXIT-NORMAL -- RETURN BY ENTRY LINK REGISTER 14                  */
*/*   CONDITIONS -- N/A                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* EXIT-ERROR -- N/A                                                */
*/*   CONDITIONS -- N/A                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/********************************************************************/
*MSGFNDR:   /* LOCATE MESSAGE TEXT ROUTINE EP                        */
*           PROCEDURE                                              1422
*                 OPTIONS(DONTSAVE,NOSAVEAREA); /* NO REGS SAVED,    */
MSGFNDR  DS    0H                                                  1423
*                                   /* NO SAVE AREA CREATED          */
*                                                                  1423
*           RESPECIFY (R14) RESTRICTED;                            1423
*           SAVLNKM = R14;          /* RESERVE LINK REGISTER         */
         ST    R14,SAVLNKM                                         1424
*           RESPECIFY (R14) UNRESTRICTED;                          1425
*                                                                  1425
*           MOFFNO = (MSGNO*2)+ADDR(ANDXL)-2;  /* FORM PTR TO OFFSET */
         LH    @08,MSGNO                                           1426
         ALR   @08,@08                                             1426
         L     @15,@CV00040                                        1426
         ALR   @08,@15                                             1426
         BCTR  @08,0                                               1426
         BCTR  @08,0                                               1426
         ST    @08,MOFFNO                                          1426
*           MSGPTR = MOFFNC + ADDR(ANDXL);  /* FORM PTR TO TEXT      */
*                                                                  1427
         L     @15,@CV00040                                        1427
         AH    @15,MOFFNC(,@08)                                    1427
         ST    @15,MSGPTR                                          1427
*           RESPECIFY (R14) RESTRICTED;                            1428
*           R14 = SAVLNKM;          /* RESTORE LINK REGISTER         */
         L     @08,SAVLNKM                                         1429
         LR    R14,@08                                             1429
*           RETURN;                 /* RETURN TO CALLER              */
@EL00009 DS    0H                                                  1430
@EF00009 DS    0H                                                  1430
@ER00009 BR    @14                                                 1430
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -- FXPUTL                                           */
*/*                                                                  */
*/* DESCRIPTIVE NAME -- N/A                                          */
*/*                                                                  */
*/* FUNCTION -- INITIALIZE PUTLINE PARAMETER BLOCK (PTPBK)           */
*/*   OPERATION --                                                   */
*/*   -  SAVE ENTRY LINK REGISTER 14                                 */
*/*   -  SET SINGLE LEVEL MESSAGE FLAG (SNGLVL)                      */
*/*   -  MOVE MODEL SINGLE LEVEL MESSAGE PARAMETER BLOCK (MPTPBK)    */
*/*      INTO DYNAMIC BLOCK (PTPBK)                                  */
*/*   -  (ENTRY FXPUTLM OR CONTINUE)  IF SNGLVL FLAG IS ON, SET      */
*/*      MESSAGE TEXT POINTER (MSGPTR) IN PARAMETER BLOCK (PTPBOPUT) */
*/*      AND RESET SNGLVL LEVEL MESSAGE FLAG (SNGLVL)                */
*/*      IF SNGLVL FLAG IS OFF (MULTI-LEVEL MESSAGE) SAVE ENTRY LINK */
*/*      REGISTER 14, MOVE MODEL MULTI-LEVEL PARAMETER BLOCK INTO    */
*/*      DYNAMIC BLOCK (PTPBK), SET MESSAGE TEXT POINTER (MSGPTR) IN */
*/*      PARAMETER LBOCK (PTPBOPUT) AND RESET SINGLE LEVEL MESSAGE   */
*/*      FLAG (SNGLVL)                                               */
*/*   -  RESTORE ENTRY LINK REGISTER 14 AND RETURN                   */
*/*                                                                  */
*/* ENTRY -- LINKED BY REGISTER 14                                   */
*/*                                                                  */
*/* INPUT --                                                         */
*/*   -  UADSREFM ENVIRONMENT                                        */
*/*   -  POINTER TO MESSAGE TEXT IN MSGPTR                           */
*/*                                                                  */
*/* OUTPUT --                                                        */
*/*   -  PUTLINE PARAMETER BLOCK SET (PTPBK)                         */
*/*                                                                  */
*/* EXTERNAL REFERENCES -- N/A                                       */
*/*                                                                  */
*/* EXIT-NORMAL -- RETURN BY ENTRY LINK REGISTER 14                  */
*/*   CONDITIONS -- N/A                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* EXIT-ERROR -- N/A                                                */
*/*   CONDITIONS -- N/A                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/********************************************************************/
*FXPUTL:    /* INITIALIZE PUTLINE  P P  PARAMETER BLOCK              */
*           ENTRY;                                                 1431
*                                                                  1431
FXPUTL   DS    0H                                                  1432
*           SAVLNKM = R14;          /* RESERVE LINK REGISTER         */
         ST    R14,SAVLNKM                                         1432
*           SNGLVL = '1'B;          /* SET SINGLE LEVEL MSG FLAG     */
         OI    SNGLVL,B'00000100'                                  1433
*           PTPBK = MPTPBK;         /* INITIALIZE PUTLINE PB         */
*                                                                  1434
         MVC   PTPBK(12),MPTPBK                                    1434
*FXPUTLM:   /* INITIALIZE PARAMETER BLOCK FOR PUTLINE  (MULTILEVEL)  */
*           ENTRY;                                                 1435
*                                                                  1435
         B     @EC01435                                            1435
FXPUTLM  DS    0H                                                  1435
@EC01435 DS    0H                                                  1436
*           IF SNGLVL ^= '1'B       /* CHK FOR SINGLE LEVEL ENTRY    */
*             THEN                  /* NO,                           */
         TM    SNGLVL,B'00000100'                                  1436
         BO    @RF01436                                            1436
*               DO;                                                1437
*                 SAVLNKM = R14;    /* RESERVE LINK REGISTER         */
         ST    R14,SAVLNKM                                         1438
*                 RESPECIFY (R14) UNRESTRICTED;                    1439
*                 PTPBK = MPTPBKM;  /* INITIALIZE PUTLINE PB         */
         MVC   PTPBK(12),MPTPBKM                                   1440
*               END;                                               1441
*                                                                  1441
*           PTPBOPUT = MSGPTR;      /* SET PTR TO OUTPUT LINE        */
@RF01436 L     @08,PTPBPTR                                         1442
         MVC   PTPBOPUT(4,@08),MSGPTR                              1442
*           SNGLVL = '0'B;          /* RESET MESSAGE MODE FLAG       */
*                                                                  1443
         NI    SNGLVL,B'11111011'                                  1443
*           RESPECIFY (R14) RESTRICTED;                            1444
*           R14 = SAVLNKM;          /* RESTORE LINK REGISTER         */
         L     R14,SAVLNKM                                         1445
*           RETURN;                 /* RETURN TO CALLER              */
         B     @EL00009                                            1446
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -- DOPUTL                                           */
*/*                                                                  */
*/* DESCRIPTIVE NAME -- N/A                                          */
*/*                                                                  */
*/* FUNCTION -- CALL PUTLINE SERVICE ROUTINE TO ISSUE MESSAGE        */
*/*   OPERATION --                                                   */
*/*   -  SAVE ENTRY LINK REGISTER 14                                 */
*/*   -  INITIALIZE PUTLINE PARAMETER LIST (IOPL) AND SET POINTER TO */
*/*      PARAMETER BLOCK (PTPB) IN LIST (IOPLIOPB)                   */
*/*   -  INITIALIZE CONTROL PROGRAM PARAMETER LIST (PTLCPL) FROM     */
*/*      MODEL (MPTLCPL)                                             */
*/*   -  SET PUTLINE ACTIVE FLAG (PLNOW)                             */
*/*   -  SET POINTER TO PUTLINE PL (IOPL) IN REGISTER 1              */
*/*   -  SET POINTER TO CP PL (PTLCPL) IN REGISTER 15                */
*/*   -  LINK TO PUTLINE VIA (PTLCPL)                                */
*/*   -  ON RETURN, CLEAR PUTLINE ACTIVE FLAG (PLNOW)                */
*/*   -  IF RETURN CODE (REGISTER 15) IS NONSUCCESSFUL (NOT 0) AND   */
*/*      IT NOT A RECURSIVE ERROR (PLFAIL IS 0), SET PUTLINE FAILURE */
*/*      FLAG (PLFAIL) ON.  IF RETURN CODE IS 16, ISSUE ERROR MES-   */
*/*      SAGE 1 (LACK OF SPACE) AND SET UADSREFM TERMINATION FLAG    */
*/*      (RFMQUIT)                                                   */
*/*   -  IF RETURN CODE IS SUCCESSFUL (0), CLEAR PUTLINE FAILURE     */
*/*      FLAG (PLFAIL)                                               */
*/*   -  RESTORE ENTRY LINK REGISTER 14 AND RETURN                   */
*/*                                                                  */
*/* ENTRY -- LINKED BY REGISTER 14                                   */
*/*                                                                  */
*/* INPUT --                                                         */
*/*   -  UADSREFM ENVIRONMENT                                        */
*/*   -  PUTLINE PARAMETER BLOCK SET (PTPBK)                         */
*/*                                                                  */
*/* OUTPUT --                                                        */
*/*   -  MESSAGE ISSUED                                              */
*/*                                                                  */
*/* EXTERNAL REFERENCES --                                           */
*/*   -  PUTLINE MACRO -- LIST FORMAT                                */
*/*   -  LINK MACRO -- LIST FORMAT                                   */
*/*                                                                  */
*/* EXIT-NORMAL -- RETURN BY ENTRY LINK REGISTER 14                  */
*/*   CONDITIONS --                                                  */
*/*   -  MESSAGE ISSUED SUCCESSFULLY                                 */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* EXIT-ERROR -- RETURN BY ENTRY LINK REGISTER 14                   */
*/*   CONDITIONS --                                                  */
*/*   -  MESSAGE FAILURE                                             */
*/*   RETURN CODE -- N-A                                             */
*/*                                                                  */
*/********************************************************************/
*DOPUTL:    /* CALL PUTLINE SERVICE ROUTINE                          */
*           ENTRY;                                                 1447
DOPUTL   DS    0H                                                  1448
*           SAVLNKM = R14;          /* RESERVE LINK REGISTER         */
         ST    R14,SAVLNKM                                         1448
*           RESPECIFY (R14) UNRESTRICTED;                          1449
*           IOPL(1:12) = BASPTRS(1:12);  /* SET PL BASE PTRS         */
         L     @08,IOPLPTR                                         1450
         MVC   IOPL(12,@08),BASPTRS                                1450
*           IOPLIOPB = ADDR(PTPBK);  /* SET PTR TO PARAMETER BLOCK   */
         LA    @15,PTPBK                                           1451
         ST    @15,IOPLIOPB(,@08)                                  1451
*           PLOUTZ = '0'B;          /* CLEAR VARIABLE AREA           */
         XC    PLOUTZ+1(7),PLOUTZ+1                                1452
         MVI   PLOUTZ,B'00000000'                                  1452
*           /* INITIALIZE PARM LIST FOR CONTROL PROGRAM              */
*           GEN(MVC   PTLCPL(LNKLNG),MPTLCPL); /* C P  PARM LIST     */
         MVC   PTLCPL(LNKLNG),MPTLCPL
*           PLNOW = '1'B;           /* SET ACTIVE FLAG FOR PUTLINE   */
         OI    PLNOW,B'00100000'                                   1454
*           RESPECIFY (R1,R15) RESTRICTED;                         1455
*           R1 = ADDR(IOPL);        /* SET PTR TO PUTLINE P P PL     */
         L     R1,IOPLPTR                                          1456
*           R15 = ADDR(PTLCPL);     /* SET PTR TO PUTLINE C P PL     */
         LA    R15,PTLCPL                                          1457
*           /* LINK TO PUTLINE                                       */
*           GEN(LINK  MF=(E,(1)),SF=(E,(15)));  /* GO TO PUTLINE     */
         LINK  MF=(E,(1)),SF=(E,(15))
*           RTNCODE = R15;          /* RESERVE RETURN CODE           */
         ST    R15,RTNCODE                                         1459
*           RESPECIFY (R1,R15) UNRESTRICTED;                       1460
*           PLNOW = '0'B;           /* CLEAR ACTIVE FLAG OF PUTLN    */
         NI    PLNOW,B'11011111'                                   1461
*           IF RTNCODE ^= 0         /* CHK FOR SUCESSFUL PUTLINE     */
*             THEN                  /* NO,                           */
         L     @08,RTNCODE                                         1462
         LTR   @08,@08                                             1462
         BZ    @RF01462                                            1462
*               DO;                                                1463
*                 IF PLFAIL = '0'B  /* CHK FOR PREVIOUS FAILURE      */
*                   THEN            /* NO,                           */
         TM    PLFAIL,B'10000000'                                  1464
         BNZ   @RF01464                                            1464
*                     DO;                                          1465
*                       SAVLNKMS=SAVLNKM;  /* SAVE ENTRY LINK        */
         MVC   SAVLNKMS(4),SAVLNKM                                 1466
*                       PLFAIL = '1'B;/* SET PUTLINE FAILURE FLAG    */
         OI    PLFAIL,B'10000000'                                  1467
*                       IF RTNCODE=16   /* CHK IF INSUFFICIENT SPACE */
*                         THEN        /* YES,                        */
         CH    @08,@CH00076                                        1468
         BNE   @RF01468                                            1468
*                           DO;                                    1469
*                             MSGNO = 1;     /* SET MESSAGE INDEX    */
         MVC   MSGNO(2),@CH00032                                   1470
*                             CALL  MSGFNDR; /* LOCATE MESSAGE       */
         BAL   @14,MSGFNDR                                         1471
*                             CALL  FXPUTL;  /* INITIALIZE PARM BLK  */
         BAL   @14,FXPUTL                                          1472
*                             CALL  DOPUTL;  /* TO ISSUE PUTLINE     */
         BAL   @14,DOPUTL                                          1473
*                             RFMQUIT = '1'B;/* SET TERM FLAG        */
         OI    RFMQUIT,B'01000000'                                 1474
*                           END;                                   1475
*                         ELSE                                     1476
*                           DO;                                    1476
         B     @RC01468                                            1476
@RF01468 DS    0H                                                  1477
*                             MSGNO = 2;       /* SET MESSAGE INDEX  */
         MVC   MSGNO(2),@CH00099                                   1477
*                             SOFFS = 20;      /* SET INSERT OFFSET  */
         MVC   SOFFS(2),@CH00351                                   1478
*                             CALL  SYSERRD;   /* TO PRINT ERROR MSG */
         BAL   @14,SYSERRD                                         1479
*                           END;                                   1480
*                       SAVLNKM=SAVLNKMS;  /* RESTORE ENTRY LINK     */
@RC01468 MVC   SAVLNKM(4),SAVLNKMS                                 1481
*                     END;                                         1482
*                   ELSE            /* IS RECURSIVE FAILURE          */
*                     RFMQUIT = '1'B;/*                            1483
*                                      UADSREFM TERMINATION FLAG     */
         B     @RC01464                                            1483
@RF01464 OI    RFMQUIT,B'01000000'                                 1483
*               END;                                               1484
*             ELSE                  /* PUTLINE NOT SUCCESSFUL        */
*               PLFAIL = '0'B;      /* CLEAR PUTLINE FAILURE FLAG    */
         B     @RC01462                                            1485
@RF01462 NI    PLFAIL,B'01111111'                                  1485
*           RESPECIFY (R14) RESTRICTED;                            1486
@RC01462 DS    0H                                                  1487
*           R14 = SAVLNKM;          /* RESTORE LINK REGISTER         */
         L     R14,SAVLNKM                                         1487
*           END  MSGFNDR;           /* RETURN TO CALLER              */
         B     @EL00009                                            1488
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -- DORENDR                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME -- N/A                                          */
*/*                                                                  */
*/* FUNCTION -- ENTRY POINT FOR STAE RETRY EXIT                      */
*/*   OPERATION --                                                   */
*/*   -  IF NO STAE WORK AREA INDICATED (INPUT REGISTER 0 NOT 0),    */
*/*      RETURN IMMEDIATELY                                          */
*/*   -  OTHERWISE, REGISTER 0 CONTAINS POINTER TO STAE WORK AREA.   */
*/*      SET POINTER TO PASSED PARAMETER BLOCK (STAEPL1) IN REGISTER */
*/*      2 FROM LOCATION INDICATED BY REGISTER 1                     */
*/*   -  LOAD BASE REGISTERS 9 THROUGH 12 FROM (STAEPL1)             */
*/*   -  FREE THE STAE WORK AREA                                     */
*/*   -  RE-ESTABLISH THE UADSREFM STAE ENVIRONMENT                  */
*/*   -  SET MAIN STREAM EXIT POINTER (MAINX) IN REGISTER 14 TO      */
*/*      SIMULATE LINK TO REND                                       */
*/*   -  DROP THROUGH TO REND                                        */
*/*                                                                  */
*/* ENTRY -- STANDARD STAE RETRY EXIT LINKAGE                        */
*/*                                                                  */
*/* INPUT --                                                         */
*/*   -  REGISTER 1 POINTS TO STAE WORK AREA                         */
*/*                                                                  */
*/* OUTPUT -- N/A                                                    */
*/*                                                                  */
*/* EXTERNAL REFERENCES -- N/A                                       */
*/*                                                                  */
*/* EXIT-NORMAL -- N/A                                               */
*/*   CONDITIONS -- N/A                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* EXIT-ERROR -- N/A                                                */
*/*   CONDITIONS -- N/A                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */
*/*                                                                  */
*/********************************************************************/
*DORENDR:   /* REND  E P  FOR STAE RETRY EXIT                        */
*           PROCEDURE                                              1489
*                 OPTIONS(DONTSAVE,NOSAVEAREA); /* NO REGS SAVED,    */
DORENDR  DS    0H                                                  1490
*                                   /* NO SAVE AREA CREATED          */
*                                                                  1490
*           RESPECIFY (R14) UNRESTRICTED;                          1490
*           GEN(USING  DORENDR,@15);                               1491
         USING  DORENDR,@15
*           RESPECIFY (R0) RESTRICTED;                             1492
*           IF R0 ^= 0              /* CHK IF WORK AREA SUPPLIED     */
*             THEN                  /* NO,                           */
         LTR   R0,R0                                               1493
         BZ    @RF01493                                            1493
*               GEN(RETURN);        /* RETURN TO CALLER              */
         RETURN
*           GENERATE;                                              1495
*                                                                  1495
@RF01493 DS    0H                                                  1495
          DROP  @15                 DROP ENTRY ADDRESSABILITY
          USING @PSTART,R9          REESTABLISH MODULE ADDRESSABILITY
          L     R2,0(R1)            GET PTR TO PARAMETER BLOCK
          LM    R9,R12,0(R2)        LOAD IKJRBBU0 BASE PTRS
*           R0 = 104;               /* SET LENGTH OF STAE WORK AREA  */
         LA    R0,104                                              1496
*           GEN(FREEMAIN  R,LV=(0),A=(1));  /* FREE WORK AREA        */
         FREEMAIN  R,LV=(0),A=(1)
*           RESPECIFY (R0) UNRESTRICTED;                           1498
*                                                                  1498
*           CALL RSTAE;             /* RE-ESTABLISH STAE ENVIRONMENT */
*                                                                  1499
         BAL   @14,RSTAE                                           1499
*           RESPECIFY (R14) RESTRICTED;                            1500
*           R14 = ADDR(MAINX);      /* SET MAIN EXIT PTR             */
         LA    R14,MAINX                                           1501
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -- REND                                             */
*/*                                                                  */
*/* DESCRIPTIVE NAME -- N/A                                          */
*/*                                                                  */
*/* FUNCTION -- RELEASE ALL RESOURCES AND SET EXIT RETURN CODE       */
*/*   OPERATION --                                                   */
*/*   -  SAVE ENTRY LINK REGISTER 14                                 */
*/*   -  PERFORM SEGMENT RMODEU TO PRINT ANY EXISTING USERID MESSAGE */
*/*   -  SET NO-WRITE FLAG (RWPF5) IN ACCOUNT-READ/WRITE PARAMETER   */
*/*      BLOCK (RWPB)                                                */
*/*   -  PERFORM SEGMENT DOWRT2 TO FREE READ BUFFER                  */
*/*   -  PERFORM SEGMENT FREBUF TO FREE WRITE BUFFER                 */
*/*   -  PERFORM SEGMENT RDEQM TO DEQUEUE USERID IF ENQUEUED         */
*/*   -  PERFORM SEGMENT RCLOS TO CLOSE ANY OPEN DCBS                */
*/*   -  PERFORM SEGMENT RDEQU TO DEQUEUE FROM UADS IF ENQUEUED      */
*/*   -  PERFORM SEGMENT RDSTAE TO REMOVE ANY EXISTING STAE          */
*/*   -  IF ANY FAILURE FLAG SET (QUITCHK NOT 0) SET RETURN CODE TO  */
*/*      TO 12 AND EXIT                                              */
*/*   -  IF NO FAILURE FLAG SET, ISSUE MESSAGE 8 (REFORMATTED) AND   */
*/*      IF STILL NO FAILURE FLAG, SET RETURN CODE TO 0.  IF FAILURE */
*/*      FLAG SET AFTER MESSAGE 8 ATTEMPT, LEAVE RETURN CODE AT 12   */
*/*   -  RESTORE ENTRY LINK REGISTER 14 AND RETURN                   */
*/*                                                                  */
*/* ENTRY -- LINKED BY REGISTER 14                                   */
*/*                                                                  */
*/* INPUT --                                                         */
*/*   -  UADSREFM ENVIRONMENT                                        */
*/*                                                                  */
*/* OUTPUT --                                                        */
*/*   -  ALL RESOURCES RELEASED                                      */
*/*   -  MODE MESSAGE                                                */
*/*   -  RETURN CODE SET                                             */
*/*                                                                  */
*/* EXTERNAL REFERENCES -- N/A                                       */
*/*                                                                  */
*/* EXIT-NORMAL -- RETURN BY ENTRY LINK REGISTER 14                  */
*/*   CONDITIONS --                                                  */
*/*   -  NO FAILURE OCCURRED DURING UADSREFM PROCESSING              */
*/*      (REFORMATTED MESSAGE ISSUED)                                */
*/*   RETURN CODE --  0                                              */
*/*                                                                  */
*/* EXIT-ERROR -- RETURN BY ENTRY LINK REGISTER 14                   */
*/*   CONDITIONS --                                                  */
*/*   -  SOME FAILURE OCCURRED DURING UADSREFM PROCESSING            */
*/*   RETURN CODE -- 12                                              */
*/*                                                                  */
*/********************************************************************/
*REND:      /* RELEASE ALL RESOURCES, SET EXIT CODE AND EXIT         */
*           ENTRY;                                                 1502
*                                                                  1502
         B     @EC01502                                            1502
REND     DS    0H                                                  1502
@EC01502 DS    0H                                                  1503
*           SAVLNKA = R14;          /* SAVE LINK REGISTER            */
         ST    R14,SAVLNKA                                         1503
*           RESPECIFY (R14) UNRESTRICTED;                          1504
*                                                                  1504
*           CALL  RMODEU;           /* GO TO ISSUE USERIDS MESSAGE   */
         BAL   @14,RMODEU                                          1505
*           RWPF5 = '0'B;           /* SET NO-WRITE FLAG             */
         NI    RWPF5,B'11110111'                                   1506
*           CALL  DOWRT2;           /* GO TO FREE READ BUFFER        */
         BAL   @14,DOWRT2                                          1507
*           CALL  FREBUF;           /* GO TO FREE WRITE BUFFER       */
         BAL   @14,FREBUF                                          1508
*           CALL  RDEQM;            /* GO TO DEQUEUE USERID          */
         BAL   @14,RDEQM                                           1509
*           CALL  RCLOS;            /* GO TO CLOSE OPEN DCBS         */
         BAL   @14,RCLOS                                           1510
*           CALL  RDEQU;            /* GO TO DEQUEUE UADS            */
         BAL   @14,RDEQU                                           1511
*           CALL  RDSTAE;           /* GO TO REMOVE STAE             */
*                                                                  1512
         BAL   @14,RDSTAE                                          1512
*           /* SET RETURN FOR CALLER                                 */
*           RETURNC = 12;           /* SET ERROR RETURN CODE         */
         MVC   RETURNC(4),@CF00036                                 1513
*           IF RFMQUIT = '0'B       /* CHK FOR ANY FAILURE           */
*             THEN                  /* NONE,                         */
         TM    RFMQUIT,B'01000000'                                 1514
         BNZ   @RF01514                                            1514
*               DO;                                                1515
*                 MSGNO = 8;        /* SET MESSAGE INDEX             */
         MVC   MSGNO(2),@CH00046                                   1516
*                 CALL  MSGFNDR;    /* LOCATE MESSAGE TEXT           */
         BAL   @14,MSGFNDR                                         1517
*                 CALL FXPUTL;      /* INITIALIZE PB                 */
         BAL   @14,FXPUTL                                          1518
*                 CALL  DOPUTL;     /* ISSUE PUTLINE                 */
         BAL   @14,DOPUTL                                          1519
*                 IF RFMQUIT = '0'B /* CHK FOR ANY FAILURE           */
*                   THEN            /* NONE,                         */
         TM    RFMQUIT,B'01000000'                                 1520
         BNZ   @RF01520                                            1520
*                     RETURNC=0;    /* SET SUCCESS RETURN CODE       */
         SLR   @08,@08                                             1521
         ST    @08,RETURNC                                         1521
*               END;                                               1522
*                                                                  1522
@RF01520 DS    0H                                                  1523
*           RESPECIFY (R14) RESTRICTED;                            1523
@RF01514 DS    0H                                                  1524
*           R14 = SAVLNKA;          /* RESTORE LINK REGISTER         */
         L     R14,SAVLNKA                                         1524
*           END  DORENDR;           /* RETURN                        */
@EL00010 DS    0H                                                  1525
@EF00010 DS    0H                                                  1525
@ER00010 BR    @14                                                 1525
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -- STAEXIN                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME -- N/A                                          */
*/*                                                                  */
*/* FUNCTION -- STAE (ABEND) EXIT ROUTINE                            */
*/*   OPERATION --                                                   */
*/*   -  IF NO STAE WORK AREA WAS SUPPLIED (ENTRY REGISTER 0 = 12),  */
*/*      CHECK IF PARAMETER LIST WAS PASSED (REGISTER 2 NOT 0).  IF  */
*/*      NO  PARAMETER LIST  WAS PASSED,  SET  REGISTER 15  TO  0    */
*/*      (NO RETRY) AND RETURN DIRECTLY TO ABEND.  IF PARAMETER LIST */
*/*      WAS PASSED,  ESTABLISH A LOCAL AREA TO SUBSTITUTE FOR THE   */
*/*      SYSTEM LINKAGE SAVE AREA (VIA REGISTER 13) AND RELOAD THE   */
*/*      ADDRESABILITY REGISTERS (REGISTERS 9 THROUGH 12) FROM PARA- */
*/*      METER LIST.  RESERVE THE ABEND CODE FROM REGISTER 1         */
*/*   -  IF STAE WORK AREA WAS SUPPLIED, GET LOCATION OF THE PASSED  */
*/*      PARAMETER LIST FROM WORK AREA AND RELOAD THE ADDRESSABILITY */
*/*      REGISTERS.  RESERVE ABEND CODE FROM PARAMETER LIST (SABEND) */
*/*   -  SAVE ENTRY REGISTER 13 IN STAEXIN SAVE AREA (STASAV+4) AND  */
*/*      LOAD REGISTER 13 WITH LOCATION OF SAVE AREA (STASAV)        */
*/*   -  RELOAD ECTPTR                                               */
*/*   -  INITIALIZE EXIT RETURN CODE (STARC) AND EXIT RETRY ADDRESS  */
*/*      (STARAD) FOR NO-RETRY (0).                                  */
*/*   -  SET ENTRY ABEND CODE (RTNCODE) IN ECT (ECTRTCD) AND SET     */
*/*      ABEND CODE FLAG (ECTRCDF)                                   */
*/*   -  POSITION ABEND CODE (RTNCODE) FOR MESSAGE 12                */
*/*   -  IF REPETITIVE ABEND ENTRY (STANOW NOT 0), POST UADSREFM ECB */
*/*      (REFMECB) WITH CODE 12, RESTORE ENTRY REGISTERS AND EXIT    */
*/*   -  IF INITIAL ABEND ENTRY (STANOW = 0),                        */
*/*      -  IF FORCED TERMINATION FLAG (ECTATRM) IS SET, THEN POST   */
*/*         UADSREFM ECB (REFMECB) WITH CODE 12, RESTORE ENTRY REG-  */
*/*         ISTERS AND EXIT                                          */
*/*      -  IF NOT FORCED TERMINATION AND ABEND CODE IS 'B01' (I/0   */
*/*         ERROR IN SERVICE ROUTINE), THEN SET STARC TO 4 (RETRY)   */
*/*         AND SET LOCATION OF DORENDR IN STARAD (RETRY EXIT).      */
*/*      -  IF NOT FORCED TERMINATION AND NOT ABEND CODE 'B01',      */
*/*         PERFORM SEGMENT STAEXN2 TO ISSUE ERROR MESSAGE 12        */
*/*      -  POST UADSREFM ECB (REFMECB) WITH CODE 12, RESTORE ENTRY  */
*/*         REGISTERS AND EXIT                                       */
*/* SEGMENT NAME -- STAEXIN  (CONTINUED)                             */
*/*                                                                  */
*/* ENTRY -- STAEXIN -- STANDARD STAE EXIT LINKAGE                   */
*/*                                                                  */
*/* INPUT --                                                         */
*/*   -  REGISTER 1 (POINTER TO STAE WORK AREA)                      */
*/*                                                                  */
*/* OUTPUT --                                                        */
*/*   -  ERROR MESSAGE 12                                            */
*/*                                                                  */
*/* EXTERNAL REFERENCES --                                           */
*/*   -  STAE WORK AREA (VIA REGISTER 1)                             */
*/*                                                                  */
*/* EXIT-NORMAL -- RETURN BY ENTRY LINK REGISTER 14                  */
*/*   CONDITIONS --                                                  */
*/*   -  ABEND CODE NOT 'B01' (MESSAGE 12 ISSUED)                    */
*/*   RETURN CODE -- 0  (NO RETRY)                                   */
*/*                                                                  */
*/* EXIT-ERROR --                                                    */
*/*   CONDITIONS --                                                  */
*/*   -  ABEND CODE 'B01'                                            */
*/*   RETURN CODE -- 4  (RETRY)                                      */
*/*                                                                  */
*/********************************************************************/
*STAEXIN:   /* STAE (ABEND) EXIT ROUTINE                             */
*           PROCEDURE                                              1526
*                 OPTIONS(NOSAVE,NOSAVEAREA); /* NO REGISTERS SAVED  */
STAEXIN  DS    0H                                                  1527
*                                   /* NO SAVE AREA CREATED          */
*           RESPECIFY  (R14) UNRESTRICTED;                         1527
*           RESPECIFY  (R0,R14) RESTRICTED;                        1528
*           GEN(DROP   R9                 DROP MODULE ADDRESSABILITY);
         DROP   R9                 DROP MODULE ADDRESSABILITY
*           GEN(USING  STAEXIN,@15        SET ENTRY ADDRESSABILITY);
*                                                                  1530
         USING  STAEXIN,@15        SET ENTRY ADDRESSABILITY
*           IF R0 = 12              /* CHK IF ANY WORK AREA PASSED   */
*             THEN                  /* NO,                           */
         CH    R0,@CH00036                                         1531
         BNE   @RF01531                                            1531
*               /* INITIALIZE WITH OUT PASSED WORK AREA              */
*               DO;                                                1532
*                 RESPECIFY (R1,R2,R13) RESTRICTED;                1533
*                 IF R2 ^= 0        /* CHK FOR PARM LIST PTR         */
*                   THEN            /* YES,                          */
         LTR   R2,R2                                               1534
         BZ    @RF01534                                            1534
*                     DO;                                          1535
*                       GEN(USING  @DATD,R13);                     1536
         USING  @DATD,R13
*                       GEN(L      R13,STAENL1+8(R2)    RENT AREA);
         L      R13,STAENL1+8(R2)    RENT AREA
*                       GEN(LA     R13,STASAVN       LOC OF SAVE AREA);
         LA     R13,STASAVN       LOC OF SAVE AREA
*                       GEN(STM    R14,R12,12(R13)   SAVE ENTRY REGS);
         STM    R14,R12,12(R13)   SAVE ENTRY REGS
*                       GEN(DROP   R13);                           1540
         DROP   R13
*                       GEN(LM     R9,R12,STAENL1(R2)   GET BASE REGS);
         LM     R9,R12,STAENL1(R2)   GET BASE REGS
*                       GEN(DROP   @15);                           1542
         DROP   @15
*                       GEN(USING  @PSTART,R9);                    1543
         USING  @PSTART,R9
*                       RTNCODE = R1;                              1544
         ST    R1,RTNCODE                                          1544
*                       RESPECIFY (R1,R2,R13) UNRESTRICTED;        1545
*                     END;                                         1546
*                   ELSE            /* NO PARAMETER LIST PTR         */
*                     DO;           /* EXIT FROM UNKNOWN ENTRY       */
         B     @RC01534                                            1547
@RF01534 DS    0H                                                  1548
*                       GEN(SR    @15,@15);  /* NO-RETRY             */
         SR    @15,@15
*                       GEN(RETURN);   /* EXIT                       */
         RETURN
*                     END;                                         1550
*               END;                                               1551
*             ELSE                  /* YES, WORK AREA                */
*               /* INITIALIZE WITH PASSED WORK AREA                  */
*               DO;                                                1552
         B     @RC01531                                            1552
@RF01531 DS    0H                                                  1553
*                 GENERATE;                                        1553
*                                                                  1553
         STM   R14,R12,12(R13)        SAVE ENTRY REGS
         L     R2,0(R1)               L PARM LIST PTR
         LM    R9,R12,0(R2)           L POSSIBLE SAVED BASE PTRS
*                 RESPECIFY (R1) RESTRICTED;                       1554
*                 RTNCODE = SABND;  /* RESERVE ABEND CODE            */
         MVC   RTNCODE(4),SABND(SWRKAP)                            1555
*                 RESPECIFY (R1) UNRESTRICTED;                     1556
*               END;                                               1557
*                                                                  1557
*           GENERATE;                                              1558
@RC01531 DS    0H                                                  1558
         ST    @13,STASAV+4           SAVE PASSED SAVE AREA PTR
         LA    @15,STASAV             L CURRENT SAVE AREA PTR
         ST    @15,8(0,@13)           SAVE IN CALLERS SAVE AREA
         LR    @13,@15                SET CURRENT SAVE AREA PTR
*           ECTPTR = BASECTP;       /* SET PTR TO ECT                */
         L     @15,BASECTP                                         1559
         ST    @15,ECTPTR                                          1559
*           ECTRTCD = RTNCODE;      /* PRESERVE ABEND RETURN CODE    */
         MVC   ECTRTCD(3,@15),RTNCODE+1                            1560
*           ECTRCDF = '80'X;        /* SET ABEND CODE FLAG           */
         MVI   ECTRCDF(@15),X'80'                                  1561
*           STARAD = 0;             /* INITIALIZE FOR NO RETRY       */
         SLR   @08,@08                                             1562
         ST    @08,STARAD                                          1562
*           STARC = 0;              /* INITIALIZE FOR NO RETRY       */
         ST    @08,STARC                                           1563
*           /* CHK FOR REPETITIVE ENTRY TO STAEXIN                   */
*           IF STANOW = '0'B        /* CHK IF ABEND RE-ENTRY         */
*             THEN                  /* NO,                           */
         TM    STANOW,B'00010000'                                  1564
         BNZ   @RF01564                                            1564
*               /* ISSUE ABEND MESSAGE                               */
*               DO;                                                1565
*                 STANOW = '1'B;    /* SET ABEND ACTIVE FLAG         */
         OI    STANOW,B'00010000'                                  1566
*                 /* CHK IF DETACH ENTRY                             */
*                 IF ECTATRM = '0'B /* CHK FOR ECT QUIT FLAG         */
*                   THEN            /* NO,                           */
         TM    ECTATRM(@15),B'00100000'                            1567
         BNZ   @RF01567                                            1567
*                     DO;                                          1568
*                       IF USERCDE^='0B01'X /* CHK FOR I/O ERROR     */
*                         THEN              /* NO,                   */
         CLC   USERCDE(2),@CB02062                                 1569
         BE    @RF01569                                            1569
*                           CALL  STAEXN2;  /* ISSUE ABEND MESSAGE   */
         BAL   @14,STAEXN2                                         1570
*                         ELSE              /* YES, IS I/O ERROR     */
*                           DO;                                    1571
         B     @RC01569                                            1571
@RF01569 DS    0H                                                  1572
*                             STARC = 4;  /* SET RETRY RETURN CODE   */
         MVC   STARC(4),@CF00102                                   1572
*                             STARAD=ADDR(DORENDR); /* SET RETRY EP  */
         LA    @15,DORENDR                                         1573
         ST    @15,STARAD                                          1573
*                             RFMQUIT = '1'B; /* TERMINATION FLAG ON */
         OI    RFMQUIT,B'01000000'                                 1574
*                           END;                                   1575
*                     END;                                         1576
*                   ELSE     ;      /* YES, QUIT NOW                 */
@RF01567 DS    0H                                                  1578
*               END;                                               1578
*                                                                  1578
@RC01567 DS    0H                                                  1579
*           REFMECB = SPOST + 12;   /* POST ECB                      */
@RF01564 LA    @15,12                                              1579
         AL    @15,SPOST                                           1579
         ST    @15,REFMECB                                         1579
*           /* RESTORE ENTRY REGISTERS THEN EXIT                     */
*           GEN(LM    @15,@00,STARC          SET RETURN CODE );    1580
         LM    @15,@00,STARC          SET RETURN CODE
*           GEN(L     @13,4(0,@13)           RESTORE SAVE AREA PTR );
         L     @13,4(0,@13)           RESTORE SAVE AREA PTR
*           GEN(STM   @15,@00,16(@13)        SET UP EXIT VALUES ); 1582
         STM   @15,@00,16(@13)        SET UP EXIT VALUES
*           GEN(LM    @14,@12,12(@13) RESTORE CALLERS REGS );      1583
         LM    @14,@12,12(@13) RESTORE CALLERS REGS
*           GEN(BCR   15,@14          RETURN );                    1584
*                                                                  1584
         BCR   15,@14          RETURN
*           RESPECIFY  (R0) UNRESTRICTED;                          1585
*/********************************************************************/
*/*                                                                  */
*/* SEGMENT NAME -- STAEXN2                                          */
*/*                                                                  */
*/* DESCRIPTIVE NAME -- N/A                                          */
*/*                                                                  */
*/* FUNCTION -- ISSUE ABEND MESSAGE AND SET NO-RETRY RETURN CODE     */
*/*   OPERATION --                                                   */
*/*   -  (SAVE ENTRY LINK REGISTER 14)                               */
*/*   -  SET MESSAGE INDEX 12                                        */
*/*   -  PERFORM SEGMENT MSGFNDR TO LOCATE MESSAGE TEXT              */
*/*   -  BUILD DYNAMIC MESSAGE SEGMENT LIST (TMSGNS1)                */
*/*   -  TRANSLATE ABEND CODE (ABNCCHS) TO EBCDIC (MSGCDE)           */
*/*   -  SET DYNAMIC SEGMENT LIST WITH NAME LENGTH (TMSGTIL1) AND    */
*/*      OFFSET INTO TEXT (TMSGTIO1)                                 */
*/*   -  PERFORM SEGMENTS FXPUTLM (INITIALIZE PARAMETER BLOCK) AND   */
*/*      AND DOPUTL TO ISSUE MESSAGE                                 */
*/*   -  SET NO-RETRY RETURN CODE (0 IN STARC) FOR STAEXIN           */
*/*   -  (RESTORE ENTRY LINK REGISTER 14 AND RETURN)                 */
*/*                                                                  */
*/* ENTRY -- N/A, INLINE SEGMENT (PSEUDO, LINKED BY REGISTER 14)     */
*/*                                                                  */
*/* INPUT -- N/A                                                     */
*/*                                                                  */
*/* OUTPUT --                                                        */
*/*   -  ERROR MESSAGE 12 (ABEND)                                    */
*/*                                                                  */
*/* EXTERNAL REFERENCES -- N/A                                       */
*/*                                                                  */
*/* EXIT-NORMAL -- N/A (RETURN BY ENTRY LINK REGISTER 14)            */
*/*   CONDITIONS --                                                  */
*/*   -  MESSAGE 12 ISSUED                                           */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* EXIT-ERROR -- N/A                                                */
*/*   CONDITIONS -- N/A                                              */
*/*   RETURN CODE -- N/A                                             */
*/*                                                                  */
*/* NOTE:  THIS ROUTINE REPRESENTS A DIRECT LINE FUNCTION  AND CAN   */
*/*        BE INCORPORATED  AS AN INCLUDED  CODE SEGMENT  WHEN THE   */
*/*        INCLUDE FUNCTION HAS RECEIVED A STANDARD DEFINITION       */
*/*                                                                  */
*/********************************************************************/
*STAEXN2:   /* ISSUE ABEND MESSAGE AND SET NO-RETRY RETURN CODE      */
*                                                                  1586
*           ENTRY;                                                 1586
         B     @EC01586                                            1586
STAEXN2  DS    0H                                                  1586
@EC01586 DS    0H                                                  1587
*           SAVLNKS  =  R14;        /* RESERVE LINK REGISTER         */
         ST    R14,SAVLNKS                                         1587
*           RESPECIFY (R14) UNRESTRICTED;                          1588
*                                                                  1588
*           MSGNO = 12;             /* SET MESSAGE INDEX             */
         MVC   MSGNO(2),@CH00036                                   1589
*           CALL  MSGFNDR;          /* GO TO LOCATE MESSAGE TEXT     */
         BAL   @14,MSGFNDR                                         1590
*           TMSGNS1(1:16)=TMLMDL1(1:16);  /* SEGMENT LIST            */
         L     @08,MSGPTR                                          1591
         MVC   TMSGNS1(16),TMLMDL1(@08)                            1591
*           TMSGNNO1 = ADDR(TMSGNS2);  /* 2ND LEVEL PTR              */
         LA    @15,TMSGNS2                                         1592
         ST    @15,TMSGNNO1                                        1592
*           TMSGNP13 = ADDR(TMSGTIX2); /* TEXT SEGMT PTR             */
         LA    @15,TMSGTIX2                                        1593
         ST    @15,TMSGNP13                                        1593
*           TMSGNS2(1:16)=TMLMDL2(1:16);  /* 2ND SEGMT LIST          */
         L     @08,TMLNX1(,@08)                                    1594
         MVC   TMSGNS2(16),TMLMDL2(@08)                            1594
*           TMSGNP23=ADDR(TMSGTIX1);  /* 2ND TEXT SGMT PTR           */
*                                                                  1595
         LA    @08,TMSGTIX1                                        1595
         ST    @08,TMSGNP23                                        1595
*           /* EXTRACT AND CONVERT CODE CHARACTERS                   */
*           GENERATE;                                              1596
*                                                                  1596
          UNPK  MSGCDE(6),ABNCCHS(3)   UNPACK BINARY CHARACTER AREA
          TR    TMSGTIN1(3),HEXTBL-240 TRANSLATE TO EBCDIC
*           TMSGTIL1 = 7;           /* SET TEXT SEGMENT LENGTH       */
         MVC   TMSGTIL1(2),@CH00644                                1597
*           TMSGTIO1 = 32;          /* SET TEXT OFFSET               */
*                                                                  1598
         MVC   TMSGTIO1(2),@CH00113                                1598
*           CALL  FXPUTLM;          /* INITIALIZE PARAMETER BLOCK    */
*                                                                  1599
         BAL   @14,FXPUTLM                                         1599
*           PTPBOPUT = ADDR(TMSGNS1);  /* PTR TO OUTPUT              */
*                                                                  1600
         LA    @08,TMSGNS1                                         1600
         L     @01,PTPBPTR                                         1600
         ST    @08,PTPBOPUT(,@01)                                  1600
*           CALL  DOPUTL;           /* GO TO ISSUE PUTLINE           */
*                                                                  1601
         BAL   @14,DOPUTL                                          1601
*           STARC = 0;              /* SET NO-RETRY RETURN CODE      */
*                                                                  1602
         SLR   @08,@08                                             1602
         ST    @08,STARC                                           1602
*           RESPECIFY (R14) RESTRICTED;                            1603
*           R14 = SAVLNKS;          /* RESTORE LINK REGISTER         */
         L     R14,SAVLNKS                                         1604
*           END  STAEXIN;                                          1605
@EL00011 DS    0H                                                  1605
@EF00011 DS    0H                                                  1605
@ER00011 BR    @14                                                 1605
*                                                                  1606
*           END  IKJRBBU0           /* END OF REFORM PROCESSOR       */
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      *
*/*%INCLUDE SYSLIB  (IHADCBDF)                                        *
*/*%INCLUDE SYSLIB  (IKJECT  )                                        *
*/*%INCLUDE SYSLIB  (IKJIOPL )                                        *
*/*%INCLUDE SYSLIB  (IKJCPPL )                                        *
*/*%INCLUDE SYSLIB  (IHADCB  )                                        *
*/*%INCLUDE SYSLIB  (IEFJFCBN)                                        *
*/*%INCLUDE SYSLIB  (IKJEFUAD)                                        *
*/*%INCLUDE SYSLIB  (IKJUPT  )                                        *
*/*%INCLUDE SYSLIB  (IKJPTPB )                                        *
*/*%INCLUDE SYSUT5  (NOWRKA  )                                        *
*/*%INCLUDE SYSUT5  (XTRWRKA )                                        *
*/*%INCLUDE SYSUT5  (ABNDMSG )                                        *
*;                                                                 1606
@DATA    DS    0H
@CH00099 DC    H'2'
@CH00090 DC    H'3'
@CH00080 DC    H'5'
@CH00118 DC    H'6'
@CH00644 DC    H'7'
@CH00046 DC    H'8'
@CH00033 DC    H'9'
@CH00034 DC    H'10'
@CH00035 DC    H'11'
@CH01676 DC    H'13'
@CH00231 DC    H'14'
@CH00174 DC    H'15'
@CH00076 DC    H'16'
@CH00562 DC    H'17'
@CH00181 DC    H'18'
@CH00351 DC    H'20'
@CH01923 DC    H'21'
@CH01991 DC    H'23'
@CH01912 DC    H'26'
@CH01967 DC    H'27'
@CH00565 DC    H'28'
@CH01868 DC    H'29'
@CH01172 DC    H'30'
@CH00113 DC    H'32'
@CH02008 DC    H'51'
@CH00551 DC    H'108'
@SM02090 MVC   UPTPREFX(0,@08),NODIDC
@SM02092 MVC   TMSGTIN1(0),NODIDC
@SM02095 MVC   MIDSNAM-8(0,@14),NODIDC
@SM02097 MVC   NUCDB(0,@08),OLCDB(@01)
@DATD    DSECT
         DS    0F
@SA00001 DS    18F
@SAV001  EQU   @SA00001
@TF00001 DS    F
@ZTEMPS  DS    0F
@ZT00002 DC    F'0'
@ZT00003 DC    F'0'
@ZTEMPND EQU   *
@ZLEN    EQU   @ZTEMPND-@ZTEMPS
@TEMPS   EQU   @ZTEMPS
@L       EQU   @ZLEN
IKJRBBU0 CSECT
         DS    0F
@CF00032 DC    F'1'
@CH00032 EQU   @CF00032+2
@CF00102 DC    F'4'
@CH00102 EQU   @CF00102+2
@CF00036 DC    F'12'
@CH00036 EQU   @CF00036+2
@CF02026 DC    F'19'
@CH02026 EQU   @CF02026+2
@CF00049 DC    F'24'
@CH00049 EQU   @CF00049+2
@CF02068 DC    F'67'
@CF01890 DC    XL3'0'
         DC    C'0'
@DATD    DSECT
         DS    0D
RENTSR   DS    CL3040
         ORG   RENTSR
RENTS    DS    CL3040
         ORG   RENTS
SAVLNKA  DS    AL4
SAVLNKB  DS    AL4
SAVLNKC  DS    AL4
SAVLNKD  DS    AL4
SAVLNKE  DS    AL4
SAVLNKF  DS    AL4
SAVLNKG  DS    AL4
SAVLNKM  DS    AL4
SAVLNKMS DS    AL4
SAVLNKN  DS    AL4
SAVLNKS  DS    AL4
SVREND   DS    AL4
HEDBPTR  DS    AL4
RHEDBPTR DS    AL4
UADSNPTR DS    AL4
DPOBPTR  DS    AL4
DNOBPTR  DS    AL4
DROBPTR  DS    AL4
UADSPPTR DS    AL4
UADSAPTR DS    AL4
UADSRPTR DS    AL4
FSQEPTR  DS    AL4
SVFSQEP  DS    AL4
CURFSQP  DS    AL4
ECTPTR   DS    AL4
IOPLPTR  DS    AL4
CPPLPTR  DS    AL4
DCBNPTR  DS    AL4
DCBXPTR  DS    AL4
DCBDPTR  DS    AL4
RDJNPTR  DS    AL4
         ORG   RDJNPTR
JFCBPTR  DS    AL4
         ORG   RENTS+124
RDJXPTR  DS    AL4
DPLNDP   DS    AL4
ONMIDP   DS    AL4
NNMIDP   DS    AL4
PTPBPTR  DS    AL4
RCPTR    DS    AL4
LEVLP    DS    AL4
RINBUFP  DS    AL4
REXBUFP  DS    AL4
TSTLVL   DS    AL4
TOPLVL   DS    AL4
TSOTROF  DS    AL4
SOFFS    DS    AL2
MSGNO    DS    AL2
MOFFNO   DS    AL4
MSGN2    DS    AL2
MSGN3    DS    AL2
MSGPTR   DS    AL4
STASAVN  DS    18A
STASAV   DS    18A
STARC    DS    AL4
STARAD   DS    AL4
LIMIT    DS    FL2
DOWHYL   DS    FL2
DOWHYLN  DS    FL2
DOWHYLR  DS    FL2
DOWHYLT  DS    FL2
DOWHYL2  DS    FL2
DOWHYL3  DS    FL2
DOWHYL4  DS    FL2
DOWHYL5  DS    FL2
DOWHYL6  DS    FL2
BSPCTR   DS    FL2
START2   DS    FL2
SVFSQEL  DS    AL2
         DS    CL2
RFCTLR   DS    BL6
         ORG   RFCTLR
QUITFLG  DS    BL1
         ORG   QUITFLG
QUITCHK  DS    BL1
         ORG   QUITCHK
UIDQUIT  DS    BL1
TERMCHK  EQU   QUITCHK+0
         ORG   TERMCHK
RFMQUIT  EQU   TERMCHK+0
RENDOF   EQU   TERMCHK+0
         ORG   RFCTLR+0
QUITRES  EQU   RFCTLR+0
         DS    CL1
PLFAIL   DS    BL1
DIREND   EQU   RFCTLR+1
STASET   EQU   RFCTLR+1
STANOW   EQU   RFCTLR+1
STACLOS  EQU   RFCTLR+1
SNGLVL   EQU   RFCTLR+1
RDINTL   EQU   RFCTLR+1
RDDONE   EQU   RFCTLR+1
STODON   DS    BL1
RD1NOW   EQU   RFCTLR+2
OPMODE   EQU   RFCTLR+2
         ORG   OPMODE
TSONOW   EQU   OPMODE+0
OPRES    EQU   OPMODE+0
         ORG   RFCTLR+3
CHAINOW  DS    BL1
EQUIUAD  EQU   RFCTLR+3
PLNOW    EQU   RFCTLR+3
XTRBLK   EQU   RFCTLR+3
XTRBNOW  EQU   RFCTLR+3
MSGNOW   EQU   RFCTLR+3
NQMNOW   EQU   RFCTLR+3
HDRPRT   EQU   RFCTLR+3
CURNEW   DS    BL1
ACTNOW   EQU   RFCTLR+4
RESFLGS  EQU   RFCTLR+4
         ORG   RENTS+376
RTNCDAR  DS    CL8
         ORG   RTNCDAR
RTNCODE  DS    FL4
         ORG   RTNCODE
RTNCRS2  DS    CL2
         ORG   RTNCRS2
RTNCRS1  DS    CL1
ABNCCHS  DS    CL3
         ORG   RTNCODE+2
RTNCCHS  DS    CL3
         ORG   RTNCCHS
USERCDE  DS    CL2
         ORG   RTNCODE+5
RTNCRS   DS    CL3
         ORG   RENTS+384
DIRWA    DS    CL344
         ORG   DIRWA
RDIDCB   DS    CL88
DIRBLK   DS    CL256
         ORG   RENTS+728
CURDIRP  DS    AL4
DIRBLKP  DS    AL4
DRBLASP  DS    AL4
DIRBDAP  DS    AL4
OLRDBUFL DS    AL4
COMPNAM  DS    CL8
         DS    CL4
DBLWORD  DS    CL8
         ORG   DBLWORD
DBLWD1   DS    CL4
DBLWD2   DS    CL4
         ORG   RENTS+768
RDJINAA  DS    CL180
         ORG   RDJINAA
RDJNXL   DS    AL4
RDJINA   DS    CL176
         ORG   RENTS+948
RDJEXAA  DS    CL180
         ORG   RDJEXAA
RDJXXL   DS    AL4
RDJEXA   DS    CL176
         ORG   RENTS+1128
DIRBCAX  DS    CL1
         ORG   DIRBCAX
DIRBTX   DS    BL1
DIRBCX   EQU   DIRBCAX+0
         ORG   RENTS+1129
SVTTR    DS    CL3
TMSGNS1  DS    CL28
         ORG   TMSGNS1
TMSGNNO1 DS    AL4
TMSGNP10 DS    AL4
TMSGNP12 DS    AL4
TMSGNP13 DS    AL4
TMSGNP14 DS    AL4
TMSGNP15 DS    AL4
TMSGNP16 DS    AL4
         ORG   RENTS+1160
TMSGNS2  DS    CL28
         ORG   TMSGNS2
TMSGNNO2 DS    AL4
TMSGNP21 DS    AL4
TMSGNP22 DS    AL4
TMSGNP23 DS    AL4
TMSGNP24 DS    AL4
TMSGNP25 DS    AL4
TMSGNP26 DS    AL4
         ORG   RENTS+1188
TMSGTIX1 DS    CL150
         ORG   TMSGTIX1
TMSGTIL1 DS    AL2
TMSGTIO1 DS    AL2
TMSGTIN1 DS    CL146
         ORG   RENTS+1338
TMSGTIX2 DS    CL150
         ORG   TMSGTIX2
TMSGTIL2 DS    AL2
TMSGTIO2 DS    AL2
TMSGTIN2 DS    CL146
         ORG   RENTS+1488
RWPB     DS    CL24
         ORG   RWPB
RWPBA    DS    BL24
         ORG   RWPBA
RWPFGS   DS    BL1
         ORG   RWPFGS
RWPF1    DS    BL1
RWPF2    EQU   RWPFGS+0
RWPF3    EQU   RWPFGS+0
RWPF4    EQU   RWPFGS+0
RWPF5    EQU   RWPFGS+0
RWPF6    EQU   RWPFGS+0
RWPF7    EQU   RWPFGS+0
RWPF8    EQU   RWPFGS+0
         ORG   RWPBA+1
RWPUDP   DS    AL3
RWPNBP   DS    AL4
RWPWAP   DS    AL4
RWPRBP   DS    AL4
RWPNOM   DS    AL1
RWPBUF   DS    AL3
RWPAPL   DS    AL4
         ORG   RWPAPL
RWPCHR   DS    CL1
RWPARP   DS    AL3
         ORG   RENTS+1512
STAEPL1  DS    CL16
         ORG   STAEPL1
STAPRM1  DS    AL4
STAPRM2  DS    AL4
STAPRM3  DS    AL4
STAPRM4  DS    AL4
         ORG   RENTS+1528
SPAZPB   DS    CL12
         ORG   SPAZPB
SPZBUFP  DS    AL4
SPZBLKN  DS    FL2
SPZBLNG  DS    FL2
SPZBLOC  DS    AL4
         ORG   RENTS+1540
PLOUT    DS    CL24
         ORG   PLOUT
PLOUTA   DS    CL12
         ORG   PLOUTA
AUPTP    DS    AL4
AECTP    DS    AL4
AECBP    DS    AL4
         ORG   PLOUT+12
ACBFP    DS    AL4
         ORG   ACBFP
PLOUTB   DS    CL4
         ORG   PLOUT+16
PLOUTC   DS    CL8
         ORG   PLOUTC
PLOUTZ   DS    BL8
         ORG   RENTS+1564
STOLST   DS    CL14
         ORG   STOLST
STLUSER  DS    CL8
STLTTRC  DS    AL3
STLCTUA  DS    AL1
         ORG   STLCTUA
STLALYS  DS    BL1
STLTTCT  EQU   STLCTUA+0
STLUSCT  EQU   STLCTUA+0
         ORG   STOLST+12
STLBYT1  DS    BL1
         ORG   STLBYT1
STLIRES  DS    BL1
         ORG   STOLST+13
STLBYT2  DS    BL1
         ORG   STLBYT2
@NM00001 DS    BL1
         ORG   RENTS+1580
BASPTRS  DS    CL20
         ORG   BASPTRS
BASUPTP  DS    AL4
BASECTP  DS    AL4
BASECBP  DS    AL4
BASEBFP  DS    AL4
BASERSP  DS    AL4
         ORG   RENTS+1600
GMAINL   DS    AL4
GMAINP   DS    AL4
PBOUT    DS    CL20
NODIDL   DS    AL2
CURDIRN  DS    CL14
         ORG   CURDIRN
CURUSER  DS    CL8
         ORG   CURUSER
NODIDC   DS    CL8
         ORG   RENTS+1644
NQMIDC   DS    CL8
NQMIDL   DS    AL2
         DS    CL2
REFMECB  DS    BL4
         ORG   REFMECB
ECBCODE  DS    AL4
         ORG   ECBCODE
ECBWT    DS    BL1
ECBCPL   EQU   ECBCODE+0
         ORG   RENTS+1660
RETURNC  DS    AL4
RWPBSAV  DS    CL24
         ORG   RWPBSAV
@NM00002 DS    CL12
RWPSDR   DS    CL4
@NM00003 DS    CL8
         ORG   RENTS+1688
OLNOBLK  DS    FL2
IDINCB   DS    FL2
NUMBLKS  DS    FL2
         DS    CL2
IDSLASP  DS    AL4
LINPTR   DS    AL4
MAXLINP  DS    AL4
IDLPOSR  DS    AL2
IDSCT    DS    AL2
OLRPL    DS    CL121
         ORG   OLRPL
OLARP    DS    AL4
OCRP     DS    AL4
OUOFFS   DS    CL12
         ORG   OUOFFS
OUOFFLG  DS    CL1
         ORG   OUOFFLG
OUOFLG1  DS    BL1
@NM00004 EQU   OUOFFLG+0
@NM00005 EQU   OUOFFLG+0
@NM00006 EQU   OUOFFLG+0
@NM00007 EQU   OUOFFLG+0
@NM00008 EQU   OUOFFLG+0
@NM00009 EQU   OUOFFLG+0
@NM00010 EQU   OUOFFLG+0
         ORG   OUOFFS+1
OUOFNEX  DS    AL3
OUOFSUB  DS    AL4
OUOFDAT  DS    AL4
         ORG   OLRPL+20
OUFLOC   DS    AL4
OUDLOC   DS    AL4
OUCLS    DS    CL1
         ORG   OUCLS
OUCLSF1  DS    BL1
@NM00011 EQU   OUCLS+0
@NM00012 EQU   OUCLS+0
@NM00013 EQU   OUCLS+0
@NM00014 EQU   OUCLS+0
@NM00015 EQU   OUCLS+0
@NM00016 EQU   OUCLS+0
@NM00017 EQU   OUCLS+0
         ORG   OLRPL+29
@NM00018 DS    CL3
OUSRDTN  DS    AL2
OUSRDCN  DS    AL2
OPOFFS   DS    CL12
         ORG   OPOFFS
OPOFFLG  DS    CL1
         ORG   OPOFFLG
OPOFLG1  DS    BL1
@NM00019 EQU   OPOFFLG+0
@NM00020 EQU   OPOFFLG+0
@NM00021 EQU   OPOFFLG+0
@NM00022 EQU   OPOFFLG+0
@NM00023 EQU   OPOFFLG+0
@NM00024 EQU   OPOFFLG+0
@NM00025 EQU   OPOFFLG+0
         ORG   OPOFFS+1
OPOFNEX  DS    AL3
OPOFSUB  DS    AL4
OPOFDAT  DS    AL4
         ORG   OLRPL+48
OPFLOC   DS    AL4
OPDLOC   DS    AL4
OPCLS    DS    CL1
@NM00026 DS    CL3
OPSWDTN  DS    AL2
OPSWDCN  DS    AL2
OAOFFS   DS    CL12
         ORG   OAOFFS
OAOFFLG  DS    CL1
         ORG   OAOFFLG
OAOFLG1  DS    BL1
@NM00027 EQU   OAOFFLG+0
@NM00028 EQU   OAOFFLG+0
@NM00029 EQU   OAOFFLG+0
@NM00030 EQU   OAOFFLG+0
@NM00031 EQU   OAOFFLG+0
@NM00032 EQU   OAOFFLG+0
@NM00033 EQU   OAOFFLG+0
         ORG   OAOFFS+1
OAOFNEX  DS    AL3
OAOFSUB  DS    AL4
OAOFDAT  DS    AL4
         ORG   OLRPL+76
OAFLOC   DS    AL4
OADLOC   DS    AL4
OACLS    DS    CL1
@NM00034 DS    CL3
OACCTTN  DS    AL2
OACCTCN  DS    AL2
OROFFS   DS    CL12
         ORG   OROFFS
OROFFLG  DS    CL1
         ORG   OROFFLG
OROFLG1  DS    BL1
@NM00035 EQU   OROFFLG+0
@NM00036 EQU   OROFFLG+0
@NM00037 EQU   OROFFLG+0
@NM00038 EQU   OROFFLG+0
@NM00039 EQU   OROFFLG+0
@NM00040 EQU   OROFFLG+0
@NM00041 EQU   OROFFLG+0
         ORG   OROFFS+1
OROFNEX  DS    AL3
OROFSUB  DS    AL4
OROFDAT  DS    AL4
         ORG   OLRPL+104
ORFLOC   DS    AL4
ORDLOC   DS    AL4
ORCLS    DS    CL1
@NM00042 DS    CL3
ORCNMTN  DS    AL2
ORCNMCN  DS    AL2
OEND     DS    BL1
         ORG   RENTS+1836
NLRPL    DS    CL121
         ORG   NLRPL
NLARP    DS    AL4
NCRP     DS    AL4
NUOFFS   DS    CL12
         ORG   NUOFFS
NUOFFLG  DS    CL1
         ORG   NUOFFLG
NUOFLG1  DS    BL1
@NM00043 EQU   NUOFFLG+0
@NM00044 EQU   NUOFFLG+0
@NM00045 EQU   NUOFFLG+0
@NM00046 EQU   NUOFFLG+0
@NM00047 EQU   NUOFFLG+0
@NM00048 EQU   NUOFFLG+0
@NM00049 EQU   NUOFFLG+0
         ORG   NUOFFS+1
NUOFNEX  DS    AL3
NUOFSUB  DS    AL4
NUOFDAT  DS    AL4
         ORG   NLRPL+20
NUFLOC   DS    AL4
NUDLOC   DS    AL4
NUCLS    DS    CL1
         ORG   NUCLS
NUCLSF1  DS    BL1
@NM00050 EQU   NUCLS+0
@NM00051 EQU   NUCLS+0
@NM00052 EQU   NUCLS+0
@NM00053 EQU   NUCLS+0
@NM00054 EQU   NUCLS+0
@NM00055 EQU   NUCLS+0
@NM00056 EQU   NUCLS+0
         ORG   NLRPL+29
@NM00057 DS    CL3
NUSRDTN  DS    AL2
NUSRDCN  DS    AL2
NPOFFS   DS    CL12
         ORG   NPOFFS
NPOFFLG  DS    CL1
         ORG   NPOFFLG
NPOFLG1  DS    BL1
@NM00058 EQU   NPOFFLG+0
@NM00059 EQU   NPOFFLG+0
@NM00060 EQU   NPOFFLG+0
@NM00061 EQU   NPOFFLG+0
@NM00062 EQU   NPOFFLG+0
@NM00063 EQU   NPOFFLG+0
@NM00064 EQU   NPOFFLG+0
         ORG   NPOFFS+1
NPOFNEX  DS    AL3
NPOFSUB  DS    AL4
NPOFDAT  DS    AL4
         ORG   NLRPL+48
NPFLOC   DS    AL4
NPDLOC   DS    AL4
NPCLS    DS    CL1
@NM00065 DS    CL3
NPSWDTN  DS    AL2
NPSWDCN  DS    AL2
NAOFFS   DS    CL12
         ORG   NAOFFS
NAOFFLG  DS    CL1
         ORG   NAOFFLG
NAOFLG1  DS    BL1
@NM00066 EQU   NAOFFLG+0
@NM00067 EQU   NAOFFLG+0
@NM00068 EQU   NAOFFLG+0
@NM00069 EQU   NAOFFLG+0
@NM00070 EQU   NAOFFLG+0
@NM00071 EQU   NAOFFLG+0
@NM00072 EQU   NAOFFLG+0
         ORG   NAOFFS+1
NAOFNEX  DS    AL3
NAOFSUB  DS    AL4
NAOFDAT  DS    AL4
         ORG   NLRPL+76
NAFLOC   DS    AL4
NADLOC   DS    AL4
NACLS    DS    CL1
@NM00073 DS    CL3
NACCTTN  DS    AL2
NACCTCN  DS    AL2
NROFFS   DS    CL12
         ORG   NROFFS
NROFFLG  DS    CL1
         ORG   NROFFLG
NROFLG1  DS    BL1
@NM00074 EQU   NROFFLG+0
@NM00075 EQU   NROFFLG+0
@NM00076 EQU   NROFFLG+0
@NM00077 EQU   NROFFLG+0
@NM00078 EQU   NROFFLG+0
@NM00079 EQU   NROFFLG+0
@NM00080 EQU   NROFFLG+0
         ORG   NROFFS+1
NROFNEX  DS    AL3
NROFSUB  DS    AL4
NROFDAT  DS    AL4
         ORG   NLRPL+104
NRFLOC   DS    AL4
NRDLOC   DS    AL4
NRCLS    DS    CL1
@NM00081 DS    CL3
NRCNMTN  DS    AL2
NRCNMCN  DS    AL2
NEND     DS    BL1
         ORG   RENTS+1960
IDSBUF   DS    CL1080
         ORG   IDSBUF
IDSLINS  DS    CL108
         ORG   IDSLINS+0
IDSLNEX  DS    AL4
IDSLLNG  DS    AL2
IDSLOFF  DS    AL2
IDSLTXT  DS    CL100
         ORG   RENTSR+3040
IKJRBBU0 CSECT
         DS    0F
@SIZDATD DC    AL1(1)
         DC    AL3(@ENDDATD-@DATD)
@SIZ001  EQU   @SIZDATD
@CV00037 DC    V(IKJEFA51)
@CV00038 DC    V(IKJEFA52)
@CV00039 DC    V(IKJEFA53)
@CV00040 DC    V(ANDXL)
         DS    0D
MSK1FW   DS    AL4
         ORG   MSK1FW
MSK1F    DC    X'1F'
MSK1FA   DC    X'000000'
         ORG   MSK1FW+4
MSK07W   DS    AL4
         ORG   MSK07W
MSK07    DC    X'07'
MSK07A   DC    X'000000'
         ORG   MSK07W+4
MINBLK   DC    A(256)
LSPAN    DC    AL4(OPOFFS-OUOFFS)
HDRDIF   DC    AL1(36)
@CC01862 DC    C'NULLFILE'
@CC01934 DC    C'       '
@CB02062 DC    X'0B01'
         DS    CL2
MEXTHD   DS    CL36
         ORG   MEXTHD
HXSPERP  DC    A(0)
HXDESTN  DC    8X'00'
HXRESSP  DC    24X'00'
         ORG   MEXTHD+36
HEXTBL   DC    CL16'0123456789ABCDEF'
FLAGMSK  DC    X'607B204100'
ENDMSK   DC    X'FFFFFFFFFFFFFFFF'
RNDDWN   DC    X'FFFC'
HIORDR1  DC    X'80000000'
HIORDR3  DC    B'11100000'
SPOSTB   DS    BL4
         ORG   SPOSTB
SPOSTA   DC    B'01000000'
         ORG   SPOSTA
SPOST1   DS    BL1
SPOST3   EQU   SPOSTA+0
         ORG   SPOSTB+1
SPOSTCD  DC    X'000000'
         ORG   SPOSTB+4
EQNAM1   DC    CL8'SYSIKJUA'
ERNAM1   DC    CL8'OPENUADS'
@DATD    DSECT
IKJRBBU0 CSECT
XCOP     XC    0(1,RTO),0(RFROM)      LARGE SCALE CHAR OP (XC)
MVCOP    MVC   0(1,RTO),0(RFROM)      LARGE SCALE CHAR OP (MVC)
MSTAEL1  STAE  STAEXIN,MF=L,PURGE=NONE  FOR ABEND EXIT
MRDJLST  RDJFCB  (MRINDCB,,MREXDCB),MF=L  FOR RDJFCB -- INPUT,OUTPUT
MRINDCB  DCB   DDNAME=SYSUADN,DSORG=PO,MACRF=(R,W),RECFM=FB,KEYLEN=0
MREXDCB  DCB   DDNAME=SYSUADS,DSORG=PO,MACRF=(R,W),RECFM=FB,KEYLEN=0
DCBLG    EQU   *-MREXDCB              LENGTH OF DCB
MVCLNG1  EQU   *-MSTAEL1              LENGTH OF INITIALIZATION BLOCK
MNQOPN   ENQ   (EQNAM1,ERNAM1,S,8,SYSTEM),RET=USE,MF=L  FOR OPEN ENQ
MRUOPNL  OPEN  (,(UPDAT)),MF=L        FOR OPEN -- UPDATE
MRNOPNL  OPEN  (,(INPUT)),MF=L        FOR OPEN -- INPUT
MRXOPNL  OPEN  (,(OUTPUT)),MF=L       FOR OPEN -- OUTPUT
MRDOPNL  OPEN  (,(INPUT)),MF=L        FOR OPEN -- DIRECTORY INPUT
MNQMBR   ENQ   (EQNAM1,,E,8,SYSTEM),RET=USE,MF=L   FOR MEMBER ENQUEUE
MDQMBR   DEQ   (EQNAM1,,8,SYSTEM),RET=HAVE,MF=L    FOR MEMBER DEQUEUE
MRLCLSL  CLOSE (,),MF=L               FOR CLOSE
MDQOPN   DEQ    (EQNAM1,ERNAM1,8,SYSTEM),RET=HAVE,MF=L   FOR OPEN DEQ
MPTPBK   PUTLINE  OUTPUT=(0,TERM,SINGLE,INFOR),MF=L    FOR PUTLINE
MPTPBKM  PUTLINE  OUTPUT=(0,TERM,MULTLVL,INFOR),MF=L   FOR PUTLINE
MPTPBDM  PUTLINE  OUTPUT=(0,TERM,MULTLIN,DATA),MF=L   FOR PUTLINE(DATA)
PTPBLG   EQU   *-MPTPBDM              LENGTH OF PUTLINE PARM BLOCK
MPTLCPL  LINK  EP=IKJPUTL,SF=L        FOR PUTLINE(LINK)
MGMLST   GETMAIN  ,MF=L               FOR GETMAIN
MFMLST   FREEMAIN  ,MF=L              FOR FREEMAIN
MVCLNG2  EQU   *-MNQOPN               LENGTH OF INITIALIZATION BLOCK
*  NOTE -- THE ABOVE LIST OF MACROS (MSTAEL1 THRU MFMLST) MUST BE KEPT
*     PARALLEL BY ITEM AND SEQUENCE WITH LIST STARTING WITH STAEL1
MRDIDCB  DCB   DDNAME=SYSUADN,DEVD=DA,DSORG=PS,MACRF=(RP),             S
               RECFM=F,KEYLEN=0,BLKSIZE=256
DIRDLG   EQU   *-MRDIDCB              LENGTH OF DCB
         DS    0F
RPATCHN  DC    C'RPATCH  '
RPATCH   DS    400C
@DATD    DSECT                        RE-ESTABLISH AUTOMATIC DSECT
@DATD    DSECT
@DATD   DSECT
*
*        CREATE AREAS FOR PARAMETER LISTS, CONTROL BLOCKS
STAEL1   STAE  STAEXIN,MF=L           FOR ABEND EXIT
STALNG   EQU   *-STAEL1               LENGTH OF STAE  C P  PARM LIST
RDJLST   RDJFCB  (RINDCB,,REXDCB),MF=L FOR RDJFCB -- INPUT,OUTPUT
RDJLNG   EQU   *-RDJLST               LENGTH OF RDJFCB PARM LIST
RINDCB   DCB   DDNAME=SYSUADN,DSORG=PO,MACRF=(R,W),RECFM=FT
REXDCB   DCB   DDNAME=SYSUADS,DSORG=PO,MACRF=(R,W),RECFM=FT
NQOPN    ENQ   (,,,,),MF=L            FOR OPEN ENQUEUE
NQLNG    EQU   *-NQOPN                LENGTH OF ENQUEUE PARM BLOCK
RUOPNL   OPEN  (,),MF=L               FOR OPEN -- UPDAT
RNOPNL   OPEN  (,),MF=L               FOR OPEN -- INPUT
RXOPNL   OPEN  (,),MF=L               FOR OPEN -- OUTPUT
RXOPNLG  EQU   *-RXOPNL               LENGTH OF OPEN  C P  PARM LIST
RDOPNL   OPEN  (,),MF=L               FOR OPEN -- DIRECTORY INPUT
NQMBR    ENQ   (,,,,),MF=L            FOR MEMBER ENQUEUE
DQMBR    DEQ   (,,,),MF=L             FOR DEQUEUE
RLCLSL   CLOSE (,),MF=L               FOR CLOSE
RLCLSLG  EQU   *-RLCLSL               LENGTH OF CLOSE  C P  PARM LIST
DQOPN    DEQ   (,,,),MF=L             FOR OPEN DEQUEUE
DQLNG    EQU   *-DQOPN                LENGTH OF DEQUEUE PARM BLOCK
PTPBK    PUTLINE  ,MF=L               FOR PUTLINE
PTPBKM   PUTLINE  ,MF=L               FOR PUTLINE
PTPBDM   PUTLINE  ,MF=L               FOR PUTLINE(DATA)
PTLCPL   LINK   EP=IKJPUTL,SF=L       FOR PUTLINE(LINK)
LNKLNG   EQU   *-PTLCPL               LENGTH OF LINK CP PARM LIST
GMLST    GETMAIN  ,MF=L               FOR GETMAIN
FMLST    FREEMAIN  ,MF=L              FOR FREEMAIN
*  NOTE -- THE ABOVE LIST OF MACROS (STAEL1 THRU FMLST) MUST BE KEPT
*     PARALLEL BY ITEM AND SEQUENCE WITH LIST STARTING WITH MSTAEL1
*RDIDCB  IS    PART OF THE DIRECTORY WORK AREA, DIRWA
@DATD    DSECT
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA
@ENDDATD EQU   *
@DATEND  EQU   *
IKJRBBU0 CSECT
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
@0       EQU   00
@1       EQU   01
@2       EQU   02
@3       EQU   03
@4       EQU   04
@5       EQU   05
@6       EQU   06
@7       EQU   07
@8       EQU   08
@9       EQU   09
@A       EQU   10
@B       EQU   11
@C       EQU   12
@D       EQU   13
@E       EQU   14
@F       EQU   15
R0       EQU   @00
R1       EQU   @01
R2       EQU   @02
R5       EQU   @05
R6       EQU   @06
R9       EQU   @09
R10      EQU   @10
R11      EQU   @11
R12      EQU   @12
R13      EQU   @13
R14      EQU   @14
R15      EQU   @15
PPPPTR   EQU   @04
QNAMR    EQU   @05
QLNGR    EQU   @06
SWRKAP   EQU   @01
RSPW     EQU   @02
RSPZOP   EQU   @03
RLNG     EQU   @04
RFROM    EQU   @05
RTO      EQU   @06
R3       EQU   @03
R4       EQU   @04
R7       EQU   @07
R8       EQU   @08
RTCLIST  EQU   0
RCLC1    EQU   RTCLIST+3
SAVAR    EQU   4
OLHEDB   EQU   0
OLBASHD  EQU   OLHEDB
OLEXTHD  EQU   OLHEDB+28
NUHEDB   EQU   0
NUBASHD  EQU   NUHEDB
NUEXTHD  EQU   NUHEDB+28
STAENPL  EQU   0
RINBUF   EQU   0
REXBUF   EQU   0
MOFFNC   EQU   0
MIDSLIN  EQU   0
MIDSHDR  EQU   MIDSLIN
MIDSLLG  EQU   MIDSHDR+4
MIDSLTX  EQU   MIDSLIN+8
MIDSNAM  EQU   MIDSLTX
IDSLLAS  EQU   0
ECT      EQU   0
ECTRCDF  EQU   ECT
ECTRTCD  EQU   ECT+1
ECTSWS   EQU   ECT+28
ECTATRM  EQU   ECTSWS
ECTSWS2  EQU   ECT+40
ECTSWS21 EQU   ECTSWS2
IOPL     EQU   0
IOPLIOPB EQU   IOPL+12
CPPL     EQU   0
CPPLUPT  EQU   CPPL+4
CPPLECT  EQU   CPPL+12
IHADCB   EQU   0
INFMJFCB EQU   0
JFCBDSNM EQU   INFMJFCB
JFCBELNM EQU   INFMJFCB+44
JFCBTSDM EQU   INFMJFCB+52
JFCFCBID EQU   INFMJFCB+56
JFCBFRID EQU   JFCFCBID
JFCBLTYP EQU   INFMJFCB+66
JFCBOTTR EQU   INFMJFCB+67
JFCBUFOF EQU   JFCBOTTR
JFCBFLSQ EQU   JFCBOTTR+1
JFCFUNC  EQU   JFCBFLSQ
JFCBMASK EQU   INFMJFCB+72
JFCBFLG1 EQU   JFCBMASK+5
JFCOPEN  EQU   JFCBFLG1
JFCBFLG2 EQU   JFCBMASK+6
JFCDEFER EQU   JFCBFLG2
JFCBIND1 EQU   INFMJFCB+86
JFCBIND2 EQU   INFMJFCB+87
JFCDISP  EQU   JFCBIND2
JFCAMPTR EQU   INFMJFCB+88
JFCBUFRQ EQU   JFCAMPTR
JFCBUFNO EQU   JFCBUFRQ
JFCBGNCP EQU   JFCAMPTR+1
JFCBHIAR EQU   JFCBGNCP
JFCBFALN EQU   JFCBHIAR
JFCBFTEK EQU   JFCBFALN
JFCBBFTA EQU   JFCBFTEK
JFCEROPT EQU   INFMJFCB+92
JFCTRTCH EQU   INFMJFCB+93
DHED     EQU   0
UADSMHDR EQU   DHED
UADSBLNG EQU   UADSMHDR
UADSFSQP EQU   UADSMHDR+2
UADSUSER EQU   UADSMHDR+4
UADSBN01 EQU   UADSMHDR+12
UADSNUSP EQU   UADSBN01+1
UADSEXPF EQU   UADSBN01+1
UADSATTR EQU   DHED+16
UADSUPTP EQU   DHED+20
UADSPWD1 EQU   DHED+24
UADSPERP EQU   DHED+28
UADSNODE EQU   0
UADSNWD1 EQU   UADSNODE
DPOB     EQU   0
DNOB     EQU   0
DROB     EQU   0
DPOBD    EQU   0
DNOBD    EQU   0
UADSADRF EQU   DNOBD+4
DROBD    EQU   0
UADSFSQE EQU   0
FSQELNTH EQU   UADSFSQE
FSQENEXT EQU   UADSFSQE+2
UPT      EQU   0
UPTSWS   EQU   UPT+12
UPTPREFX EQU   UPT+16
UPTPREFL EQU   UPT+23
PERFGRP  EQU   0
UADIRENT EQU   0
UADIBYT1 EQU   UADIRENT+12
UADIBYT2 EQU   UADIRENT+13
CUDIRENT EQU   0
CURBYT1  EQU   CUDIRENT+12
CURBYT2  EQU   CUDIRENT+13
ONAMID   EQU   0
ONMOFS1  EQU   ONAMID
ONFLG1S  EQU   ONMOFS1
ONFSUB1  EQU   ONMOFS1+4
ONFLOC1  EQU   ONAMID+12
ONDLOC1  EQU   ONAMID+16
ONCLS1   EQU   ONAMID+20
ONDXN1   EQU   ONAMID+24
ONMOFS2  EQU   ONAMID+28
ONTST1   EQU   ONMOFS2
ONFLG2S  EQU   ONTST1
ONFLG21  EQU   ONFLG2S
ONMFNX2  EQU   ONMOFS2+1
ONFDAT2  EQU   ONMOFS2+8
ONFLOC2  EQU   ONAMID+40
ONDLOC2  EQU   ONAMID+44
ONCLS2   EQU   ONAMID+48
ONDXN2   EQU   ONAMID+52
ONMOFS3  EQU   ONAMID+56
ONTST2   EQU   ONMOFS3
ONFLG3S  EQU   ONTST2
ONFLOC3  EQU   ONAMID+68
ONDLOC3  EQU   ONAMID+72
ONCLS3   EQU   ONAMID+76
ONDXN3   EQU   ONAMID+80
NNAMID   EQU   0
NNMOFS1  EQU   NNAMID
NNFLG1S  EQU   NNMOFS1
NNFSUB1  EQU   NNMOFS1+4
NNFLOC1  EQU   NNAMID+12
NNDLOC1  EQU   NNAMID+16
NNCLS1   EQU   NNAMID+20
NNDXN1   EQU   NNAMID+24
NNMOFS2  EQU   NNAMID+28
NNTST1   EQU   NNMOFS2
NNFLG2S  EQU   NNTST1
NNFLG21  EQU   NNFLG2S
NNMFNX2  EQU   NNMOFS2+1
NNFDAT2  EQU   NNMOFS2+8
NNFLOC2  EQU   NNAMID+40
NNDLOC2  EQU   NNAMID+44
NNCLS2   EQU   NNAMID+48
NNDXN2   EQU   NNAMID+52
NNMOFS3  EQU   NNAMID+56
NNTST2   EQU   NNMOFS3
NNFLG3S  EQU   NNTST2
NNFLOC3  EQU   NNAMID+68
NNDLOC3  EQU   NNAMID+72
NNCLS3   EQU   NNAMID+76
NNDXN3   EQU   NNAMID+80
OLSUNODE EQU   0
OLASUWD1 EQU   OLSUNODE
OLASUNFL EQU   OLASUWD1
OLASUWD2 EQU   OLSUNODE+4
OLASUWD3 EQU   OLSUNODE+8
OLPDB    EQU   0
OCRUNODE EQU   0
OCURUWD1 EQU   OCRUNODE
OCURUNFL EQU   OCURUWD1
OCURUWD2 EQU   OCRUNODE+4
OCURUWD3 EQU   OCRUNODE+8
OLCDB    EQU   0
OCDBCT   EQU   OLCDB
OCDBSP   EQU   OLCDB+4
DUPLIDAT EQU   0
SVFDAT2  EQU   DUPLIDAT
DUPLICHK EQU   DUPLIDAT+4
SVDLOC2  EQU   DUPLIDAT+8
ONXUNODE EQU   0
ONEXUWD1 EQU   ONXUNODE
ONEXUNFL EQU   ONEXUWD1
ONEXUWD2 EQU   ONXUNODE+4
ONEXUWD3 EQU   ONXUNODE+8
OLNDB    EQU   0
NLSUNODE EQU   0
NLASUWD1 EQU   NLSUNODE
NLASUNFL EQU   NLASUWD1
NLASUWD2 EQU   NLSUNODE+4
NLASUSUB EQU   NLASUWD2+1
NLASUWD3 EQU   NLSUNODE+8
NUPDB    EQU   0
NCRUNODE EQU   0
NCURUWD1 EQU   NCRUNODE
NCURUNFL EQU   NCURUWD1
NCURUFLG EQU   NCURUNFL
NCURUNEX EQU   NCURUWD1+1
NCURUWD2 EQU   NCRUNODE+4
NCURUSUB EQU   NCURUWD2+1
NCURUWD3 EQU   NCRUNODE+8
NCURUDAT EQU   NCURUWD3+1
NUCDB    EQU   0
NNXUNODE EQU   0
NNEXUWD1 EQU   NNXUNODE
NNEXUNFL EQU   NNEXUWD1
NNEXUWD2 EQU   NNXUNODE+4
NNEXUWD3 EQU   NNXUNODE+8
NUNDB    EQU   0
SWRKA    EQU   0
SABND    EQU   SWRKA+4
STRGS    EQU   SWRKA+24
PTPB     EQU   0
PTPBOPUT EQU   PTPB+4
RDNAMC   EQU   0
DIRBDA   EQU   0
DIRBNAM  EQU   DIRBDA
DIRBCA   EQU   DIRBDA+11
RDTTR    EQU   12
DRBLAS   EQU   0
DRBLC    EQU   DRBLAS+11
CURFSQL  EQU   0
TMXMDL   EQU   0
TMXMP1   EQU   TMXMDL+4
TMXMP2   EQU   TMXMDL+8
TMXMP3   EQU   TMXMDL+12
TMXMP4   EQU   TMXMDL+16
TMXMP5   EQU   TMXMDL+20
TMS1MDL  EQU   0
TMS2MDL  EQU   0
TMS3MDL  EQU   0
TMS4MDL  EQU   0
TMS5MDL  EQU   0
TMLMDL1  EQU   0
TMLNX1   EQU   TMLMDL1
TMLMP11  EQU   TMLMDL1+8
TMLMP12  EQU   TMLMDL1+12
TMLMP13  EQU   TMLMDL1+16
TMLMP14  EQU   TMLMDL1+20
TMLMP15  EQU   TMLMDL1+24
TMLMDL2  EQU   0
TMLNX2   EQU   TMLMDL2
TMLMP21  EQU   TMLMDL2+8
TMLMP22  EQU   TMLMDL2+12
TMLMP23  EQU   TMLMDL2+16
TMLMP24  EQU   TMLMDL2+20
TMLMP25  EQU   TMLMDL2+24
TMLMDL3  EQU   0
TMLMP31  EQU   TMLMDL3+8
TMLMP32  EQU   TMLMDL3+12
TMLMP33  EQU   TMLMDL3+16
TMLMP34  EQU   TMLMDL3+20
TMLMP35  EQU   TMLMDL3+24
TM11MDL  EQU   0
TM12MDL  EQU   0
TM13MDL  EQU   0
TM14MDL  EQU   0
TM15MDL  EQU   0
TM21MDL  EQU   0
TM22MDL  EQU   0
TM23MDL  EQU   0
TM24MDL  EQU   0
TM25MDL  EQU   0
TM31MDL  EQU   0
TM32MDL  EQU   0
TM33MDL  EQU   0
TM34MDL  EQU   0
TM35MDL  EQU   0
RETRNCD  EQU   16
TMSMT1   EQU   0
TMSMT2   EQU   0
TMSMT3   EQU   0
TMSMT4   EQU   0
TMSMT5   EQU   0
SPOST    EQU   SPOSTB
DCBPTR   EQU   DCBNPTR
DIRPTR   EQU   DIRBDAP
TREEOFF  EQU   OUOFSUB
RDJLSTA  EQU   RDJLST
RDJA1NM  EQU   RDJLSTA+1
RDJA2NM  EQU   RDJLSTA+5
IHADCS00 EQU   IHADCB
DCBFDAD  EQU   IHADCS00+5
IHADCS01 EQU   DCBFDAD+7
DCBDVTBL EQU   IHADCS01
IHADCS11 EQU   IHADCB+16
DCBRELB  EQU   IHADCS11
DCBREL   EQU   DCBRELB+1
DCBBUFCB EQU   IHADCS11+4
DCBDSORG EQU   IHADCS11+10
DCBDSRG1 EQU   DCBDSORG
DCBDSRG2 EQU   DCBDSORG+1
DCBIOBAD EQU   IHADCS11+12
DCBODEB  EQU   DCBIOBAD
DCBLNP   EQU   DCBODEB
DCBQSLM  EQU   DCBLNP
DCBIOBAA EQU   DCBODEB+1
IHADCS50 EQU   DCBIOBAD
DCBSVCXL EQU   IHADCS50
DCBEODAD EQU   IHADCS50+4
DCBBFALN EQU   DCBEODAD
DCBHIARC EQU   DCBBFALN
DCBBFTEK EQU   DCBHIARC
DCBBFT   EQU   DCBBFTEK
DCBEXLST EQU   IHADCS50+8
DCBRECFM EQU   DCBEXLST
DCBRECLA EQU   DCBRECFM
IHADCS24 EQU   IHADCB+40
DCBOFLGS EQU   IHADCS24+8
DCBOFLWR EQU   DCBOFLGS
DCBOFOPN EQU   DCBOFLGS
DCBIFLG  EQU   IHADCS24+9
DCBIBPCT EQU   DCBIFLG
DCBMACR  EQU   IHADCS24+10
DCBMACR1 EQU   DCBMACR
DCBMRFE  EQU   DCBMACR1
DCBMRGET EQU   DCBMRFE
DCBMRAPG EQU   DCBMACR1
DCBMRRD  EQU   DCBMRAPG
DCBMRCI  EQU   DCBMACR1
DCBMRMVG EQU   DCBMRCI
DCBMRLCG EQU   DCBMACR1
DCBMRABC EQU   DCBMACR1
DCBMRPT1 EQU   DCBMRABC
DCBMRSBG EQU   DCBMRPT1
DCBMRCRL EQU   DCBMACR1
DCBMRCHK EQU   DCBMRCRL
DCBMRRDX EQU   DCBMRCHK
DCBMRDMG EQU   DCBMACR1
DCBMACR2 EQU   DCBMACR+1
DCBMRPUT EQU   DCBMACR2
DCBMRWRT EQU   DCBMACR2
DCBMRMVP EQU   DCBMACR2
DCBMR5WD EQU   DCBMACR2
DCBMRLDM EQU   DCBMR5WD
DCBMRLCP EQU   DCBMRLDM
DCBMR4WD EQU   DCBMACR2
DCBMRPT2 EQU   DCBMR4WD
DCBMRTMD EQU   DCBMRPT2
DCBMR3WD EQU   DCBMACR2
DCBMRCTL EQU   DCBMR3WD
DCBMRSTK EQU   DCBMRCTL
DCBMR1WD EQU   DCBMACR2
DCBMRSWA EQU   DCBMR1WD
DCBMRDMD EQU   DCBMRSWA
IHADCS25 EQU   IHADCB+40
DCBMACRF EQU   IHADCS25+2
DCBMACF1 EQU   DCBMACRF
DCBMFFE  EQU   DCBMACF1
DCBMFGET EQU   DCBMFFE
DCBMFAPG EQU   DCBMACF1
DCBMFRD  EQU   DCBMFAPG
DCBMFCI  EQU   DCBMACF1
DCBMFMVG EQU   DCBMFCI
DCBMFLCG EQU   DCBMACF1
DCBMFABC EQU   DCBMACF1
DCBMFPT1 EQU   DCBMFABC
DCBMFSBG EQU   DCBMFPT1
DCBMFCRL EQU   DCBMACF1
DCBMFCHK EQU   DCBMFCRL
DCBMFDMG EQU   DCBMACF1
DCBMACF2 EQU   DCBMACRF+1
DCBMFPUT EQU   DCBMACF2
DCBMFWRT EQU   DCBMACF2
DCBMFMVP EQU   DCBMACF2
DCBMF5WD EQU   DCBMACF2
DCBMFLDM EQU   DCBMF5WD
DCBMFLCP EQU   DCBMFLDM
DCBMF4WD EQU   DCBMACF2
DCBMFPT2 EQU   DCBMF4WD
DCBMFTMD EQU   DCBMFPT2
DCBMF3WD EQU   DCBMACF2
DCBMFCTL EQU   DCBMF3WD
DCBMFSTK EQU   DCBMFCTL
DCBMF1WD EQU   DCBMACF2
DCBMFSWA EQU   DCBMF1WD
DCBMFDMD EQU   DCBMFSWA
DCBDEBAD EQU   IHADCS25+4
DCBIFLGS EQU   DCBDEBAD
DCBIFPCT EQU   DCBIFLGS
IHADCS26 EQU   IHADCB+48
DCBWRITE EQU   IHADCS26
DCBREAD  EQU   DCBWRITE
DCBWRITA EQU   DCBREAD+1
IHADCS36 EQU   IHADCB+52
DCBGERR  EQU   IHADCS36
DCBPERR  EQU   DCBGERR
DCBCHECK EQU   DCBPERR
DCBOPTCD EQU   DCBCHECK
DCBOPTH  EQU   DCBOPTCD
DCBOPTO  EQU   DCBOPTH
DCBOPTZ  EQU   DCBOPTCD
DCBGERRA EQU   DCBCHECK+1
DCBPERRA EQU   DCBGERRA
DCBSYNAD EQU   IHADCS36+4
DCBCIND1 EQU   IHADCS36+8
DCBCIND2 EQU   IHADCS36+9
DCBBLKSI EQU   IHADCS36+10
DCBIOBA  EQU   IHADCS36+16
DCBCICB  EQU   DCBIOBA
IHADCS52 EQU   IHADCB+80
DCBDIRCT EQU   IHADCS52
DCBQSWS  EQU   DCBDIRCT
DCBUSASI EQU   DCBQSWS
DCBQADFS EQU   DCBUSASI
DCBBUFOF EQU   DCBDIRCT+1
IHADCS37 EQU   IHADCB+60
DCBFLAG1 EQU   IHADCS37
IHADCS38 EQU   IHADCB+72
DCBEOBR  EQU   IHADCS38
DCBPOINT EQU   IHADCS38+12
DCBCNTRL EQU   DCBPOINT
JFCKEYLE EQU   JFCTRTCH
JFCCODE  EQU   JFCKEYLE
JFCSTACK EQU   JFCTRTCH
JFCMODE  EQU   JFCSTACK
JFCSPPRT EQU   JFCTRTCH
JFCBABFS EQU   JFCSPPRT+2
JFCLIMCT EQU   JFCBABFS
JFCDSORG EQU   JFCSPPRT+5
JFCDSRG1 EQU   JFCDSORG
JFCDSRG2 EQU   JFCDSORG+1
JFCRECFM EQU   JFCSPPRT+7
JFCRCFM  EQU   JFCRECFM
JFCOPTCD EQU   JFCSPPRT+8
JFCWVCSP EQU   JFCOPTCD
JFCWVCIS EQU   JFCWVCSP
JFCWVCBD EQU   JFCWVCIS
JFCALLOW EQU   JFCOPTCD
JFCRSV17 EQU   JFCALLOW
JFCOVER  EQU   JFCRSV17
JFCPCIBT EQU   JFCOPTCD
JFCMAST  EQU   JFCPCIBT
JFCEXT   EQU   JFCMAST
JFCBCKPT EQU   JFCOPTCD
JFCIND   EQU   JFCBCKPT
JFCRSV18 EQU   JFCOPTCD
JFCCYL   EQU   JFCRSV18
JFCACT   EQU   JFCCYL
JFCREDUC EQU   JFCOPTCD
JFCRSV19 EQU   JFCREDUC
JFCRSV20 EQU   JFCRSV19
JFCRSV21 EQU   JFCOPTCD
JFCDEL   EQU   JFCRSV21
JFCOPTJ  EQU   JFCOPTCD
JFCREORG EQU   JFCOPTJ
JFCBLKSI EQU   JFCSPPRT+9
JFCBUFSI EQU   JFCBLKSI
JFCAMSYN EQU   JFCSPPRT+11
JFCNCP   EQU   JFCAMSYN+2
JFCNTM   EQU   JFCAMSYN+3
JFCBFSEQ EQU   JFCNTM
JFCPCI   EQU   JFCBFSEQ
JFCRESRV EQU   JFCAMSYN+4
JFCUCSEG EQU   JFCRESRV
JFCUCSOP EQU   JFCUCSEG+4
JFCOUTLI EQU   JFCUCSEG+5
JFCTHRSH EQU   JFCOUTLI
JFCCPRI  EQU   JFCTHRSH
JFCBVOLS EQU   JFCUCSEG+10
JFCBS001 EQU   JFCBVOLS
JFCBPQTY EQU   JFCBS001+34
JFCBCTRI EQU   JFCBS001+37
JFCBSQTY EQU   JFCBS001+38
JFCFLGS1 EQU   JFCBS001+41
OCANDBA  EQU   OCDBSP
OCANLEN  EQU   OCANDBA+40
DIRBLKA  EQU   DIRBLK
DIRBLNG  EQU   DIRBLKA
DIRBNAM1 EQU   DIRBLKA+2
DIRBCA1  EQU   DIRBLKA+16
RDNAMD   EQU   DIRBLK+2
DIRBC    EQU   DIRBCAX
FSQELNGA EQU   FSQELNTH
MSGCDE   EQU   TMSGTIX1+3
*                                      START UNREFERENCED COMPONENTS
DIRBCB1  EQU   DIRBCA1
DIRBTT1  EQU   DIRBCA1
DIRBAL1  EQU   DIRBCA1
DIRBTTR1 EQU   DIRBLKA+13
OCANNUM  EQU   OCANDBA+41
OCANDRF  EQU   OCANDBA
JFCBEND  EQU   JFCBS001+58
JFCBSPTN EQU   JFCBS001+57
JFCBVLCT EQU   JFCBS001+56
JFCBDRLH EQU   JFCBS001+53
JFCBSBNM EQU   JFCBS001+50
JFCBABST EQU   JFCBS001+48
JFCBSPNM EQU   JFCBS001+45
JFCBDQTY EQU   JFCBS001+42
JFCBUAFF EQU   JFCFLGS1
JFCRSV45 EQU   JFCFLGS1
JFCVRDS  EQU   JFCFLGS1
JFCBCEOV EQU   JFCFLGS1
JFCRSV42 EQU   JFCFLGS1
JFCBADSP EQU   JFCFLGS1
JFCTOPEN EQU   JFCFLGS1
JFCBDLET EQU   JFCFLGS1
JFCRQID  EQU   JFCBSQTY
JFCROUND EQU   JFCBCTRI
JFCALX   EQU   JFCBCTRI
JFCMIXG  EQU   JFCBCTRI
JFCONTIG EQU   JFCBCTRI
JFCRSV29 EQU   JFCBCTRI
JFCBMSGP EQU   JFCBCTRI
JFCBSPAC EQU   JFCBCTRI
JFCRUNIT EQU   JFCBPQTY
JFCBEXAD EQU   JFCBS001+31
JFCBEXTL EQU   JFCBS001+30
JFCMSVGP EQU   JFCBS001+22
@NM00111 EQU   JFCBS001
JFCAVOLS EQU   JFCBVOLS
JFCBNVOL EQU   JFCUCSEG+9
JFCBNTCS EQU   JFCUCSEG+8
JFCSOWA  EQU   JFCOUTLI+1
JFCSEND  EQU   JFCCPRI
JFCEQUAL EQU   JFCCPRI
JFCRECV  EQU   JFCCPRI
JFCRSV34 EQU   JFCCPRI
JFCRSV33 EQU   JFCCPRI
JFCRSV55 EQU   JFCCPRI
JFCRSV54 EQU   JFCCPRI
JFCRSV53 EQU   JFCCPRI
JFCRSV27 EQU   JFCUCSOP
JFCRSV26 EQU   JFCUCSOP
JFCFCBVR EQU   JFCUCSOP
JFCFCBAL EQU   JFCUCSOP
JFCVER   EQU   JFCUCSOP
JFCRSV25 EQU   JFCUCSOP
JFCFOLD  EQU   JFCUCSOP
JFCBEXTP EQU   JFCUCSOP
JFCUCSID EQU   JFCUCSEG
JFCINTVL EQU   JFCSPPRT+19
JFCDBUFN EQU   JFCRESRV+3
JFCCYLOF EQU   JFCRESRV+2
JFCRKP   EQU   JFCRESRV
JFCPCIR2 EQU   JFCPCI
JFCPCIR1 EQU   JFCPCI
JFCPCIN2 EQU   JFCPCI
JFCPCIN1 EQU   JFCPCI
JFCPCIA2 EQU   JFCPCI
JFCPCIA1 EQU   JFCPCI
JFCPCIX2 EQU   JFCPCI
JFCPCIX1 EQU   JFCPCI
JFCBUFMX EQU   JFCNCP
JFCLRECL EQU   JFCAMSYN
JFCBAXBF EQU   JFCBUFSI
JFCREL   EQU   JFCREORG
JFCRSV22 EQU   JFCDEL
JFCSRCHD EQU   JFCRSV20
JFCOPTQ  EQU   JFCACT
JFCFEED  EQU   JFCIND
JFCCBWU  EQU   JFCEXT
JFCWUMSG EQU   JFCOVER
JFCSDNAM EQU   JFCWVCBD
@NM00110 EQU   JFCRECFM
JFCCHAR  EQU   JFCRECFM
JFCRFS   EQU   JFCRECFM
JFCRFB   EQU   JFCRECFM
JFCRFO   EQU   JFCRCFM
JFCFMREC EQU   JFCRCFM
JFCRSV16 EQU   JFCDSRG2
JFCRSV15 EQU   JFCDSRG2
JFCORGTR EQU   JFCDSRG2
JFCORGAM EQU   JFCDSRG2
JFCRSV13 EQU   JFCDSRG2
JFCORGTQ EQU   JFCDSRG2
JFCORGTX EQU   JFCDSRG2
JFCORGGS EQU   JFCDSRG2
JFCORGU  EQU   JFCDSRG1
JFCORGPO EQU   JFCDSRG1
JFCORGMQ EQU   JFCDSRG1
JFCORGCQ EQU   JFCDSRG1
JFCORGCX EQU   JFCDSRG1
JFCORGDA EQU   JFCDSRG1
JFCORGPS EQU   JFCDSRG1
JFCORGIS EQU   JFCDSRG1
JFCTRKBL EQU   JFCLIMCT+1
@NM00109 EQU   JFCLIMCT
JFCDEN   EQU   JFCSPPRT+1
JFCPRTSP EQU   JFCSPPRT
JFCONE   EQU   JFCMODE
JFCTWO   EQU   JFCMODE
JFCRSV07 EQU   JFCMODE
JFCRSV06 EQU   JFCMODE
JFCMODER EQU   JFCMODE
JFCMODEO EQU   JFCMODE
JFCEBCD  EQU   JFCMODE
JFCBIN   EQU   JFCMODE
JFCRSV32 EQU   JFCCODE
JFCTTY   EQU   JFCCODE
JFCASCII EQU   JFCCODE
JFCNCR   EQU   JFCCODE
JFCBUR   EQU   JFCCODE
JFCFRI   EQU   JFCCODE
JFCBCD   EQU   JFCCODE
JFCNOCON EQU   JFCCODE
DCBNOTE  EQU   DCBCNTRL
DCBLRECL EQU   IHADCS38+10
@NM00107 EQU   IHADCS38+8
DCBEOBW  EQU   IHADCS38+4
DCBEOBRA EQU   DCBEOBR+1
DCBNCP   EQU   DCBEOBR
@NM00106 EQU   DCBFLAG1
DCBSTFLS EQU   DCBFLAG1
DCBSTQCK EQU   DCBFLAG1
DCBDIRCQ EQU   DCBBUFOF
DCBQSTRU EQU   DCBUSASI
@NM00105 EQU   DCBUSASI
DCBQADF3 EQU   DCBQADFS
DCBQADF2 EQU   DCBQADFS
DCBQADF1 EQU   DCBQADFS
DCBBLBP  EQU   DCBUSASI
@NM00104 EQU   DCBUSASI
DCBCICBA EQU   DCBCICB+1
@NM00103 EQU   DCBCICB
DCBOFFSW EQU   IHADCS36+15
DCBOFFSR EQU   IHADCS36+14
DCBWCPL  EQU   IHADCS36+13
DCBWCPO  EQU   IHADCS36+12
DCBCNQSM EQU   DCBCIND2
DCBCNFEO EQU   DCBCIND2
DCBCNCHS EQU   DCBCIND2
DCBCNBFP EQU   DCBCIND2
DCBCNIOE EQU   DCBCIND2
DCBCNCLO EQU   DCBCIND2
DCBCNWRO EQU   DCBCIND2
DCBCNSTO EQU   DCBCIND2
DCBCNEXB EQU   DCBCIND1
@NM00102 EQU   DCBCIND1
DCBCNBRM EQU   DCBCIND1
@NM00101 EQU   DCBCIND1
DCBCNEVA EQU   DCBCIND1
DCBCNEVB EQU   DCBCIND1
DCBCNSRD EQU   DCBCIND1
DCBCNTOV EQU   DCBCIND1
DCBSYNA  EQU   DCBSYNAD+1
DCBIOBL  EQU   DCBSYNAD
DCBCHCKA EQU   DCBPERRA
DCBOPTJ  EQU   DCBOPTCD
DCBOPTT  EQU   DCBOPTCD
DCBSRCHD EQU   DCBOPTZ
DCBOPTQ  EQU   DCBOPTCD
DCBBCKPT EQU   DCBOPTO
DCBOPTC  EQU   DCBOPTCD
DCBOPTU  EQU   DCBOPTCD
DCBOPTW  EQU   DCBOPTCD
DCBREADA EQU   DCBWRITA
@NM00100 EQU   DCBREAD
DCBDEBA  EQU   DCBDEBAD+1
@NM00099 EQU   DCBIFLGS
DCBIFIOE EQU   DCBIFLGS
DCBCH12  EQU   DCBIFPCT
DCBCH9   EQU   DCBIFPCT
DCBIFEC  EQU   DCBIFLGS
DCBMFSTI EQU   DCBMFDMD
DCBMFAWR EQU   DCBMFSTK
DCBMFUIP EQU   DCBMFTMD
DCBMFIDW EQU   DCBMFLCP
DCBMFWRK EQU   DCBMFMVP
DCBMFRDQ EQU   DCBMFWRT
DCBMFGTQ EQU   DCBMFPUT
DCBMFSTL EQU   DCBMACF2
DCBMFCK  EQU   DCBMFDMG
DCBMFRDX EQU   DCBMFCHK
DCBMFDBF EQU   DCBMFSBG
DCBMFRDI EQU   DCBMFLCG
DCBMFRDK EQU   DCBMFMVG
DCBMFWRQ EQU   DCBMFRD
DCBMFPTQ EQU   DCBMFGET
DCBMFECP EQU   DCBMACF1
DCBTIOT  EQU   IHADCS25
DCBMRSTI EQU   DCBMRDMD
DCBMRAWR EQU   DCBMRSTK
DCBMRUIP EQU   DCBMRTMD
DCBMRIDW EQU   DCBMRLCP
DCBMRWRK EQU   DCBMRMVP
DCBMRRDQ EQU   DCBMRWRT
DCBMRGTQ EQU   DCBMRPUT
DCBMRSTL EQU   DCBMACR2
DCBMRCK  EQU   DCBMRDMG
DCBPGFXA EQU   DCBMRRDX
DCBMRDBF EQU   DCBMRSBG
DCBMRRDI EQU   DCBMRLCG
DCBMRRDK EQU   DCBMRMVG
DCBMRWRQ EQU   DCBMRRD
DCBMRPTQ EQU   DCBMRGET
DCBMRECP EQU   DCBMACR1
@NM00098 EQU   DCBIFLG
DCBIBIOE EQU   DCBIFLG
DCBICH12 EQU   DCBIBPCT
DCBICH9  EQU   DCBIBPCT
DCBIBEC  EQU   DCBIFLG
DCBOFIOF EQU   DCBOFLGS
DCBOFUEX EQU   DCBOFLGS
DCBOFTM  EQU   DCBOFLGS
DCBOFPPC EQU   DCBOFLGS
DCBOFEOV EQU   DCBOFLGS
DCBOFLRB EQU   DCBOFLGS
DCBOFIOD EQU   DCBOFLWR
DCBDDNAM EQU   IHADCS24
DCBEXLSA EQU   DCBEXLST+1
DCBRECKL EQU   DCBRECFM
DCBRECCC EQU   DCBRECFM
DCBRECSB EQU   DCBRECFM
DCBRECBR EQU   DCBRECFM
DCBRECTO EQU   DCBRECLA
DCBRECL  EQU   DCBRECLA
DCBEODA  EQU   DCBEODAD+1
DCBBFA   EQU   DCBBFTEK
DCBH0    EQU   DCBBFTEK
DCBBFTKD EQU   DCBBFTEK
DCBBFTE  EQU   DCBBFT
DCBBFTKR EQU   DCBBFT
DCBBFTS  EQU   DCBBFT
DCBH1    EQU   DCBBFTEK
DCBSVCXA EQU   DCBSVCXL+1
@NM00097 EQU   DCBSVCXL
DCBODEBA EQU   DCBIOBAA
@NM00096 EQU   DCBQSLM
DCBUPDBT EQU   DCBQSLM
DCBUPDCM EQU   DCBQSLM
DCB1DVDS EQU   DCBQSLM
@NM00095 EQU   DCBDSRG2
DCBDSGTR EQU   DCBDSRG2
DCBACBM  EQU   DCBDSRG2
@NM00094 EQU   DCBDSRG2
DCBDSGTQ EQU   DCBDSRG2
DCBDSGTX EQU   DCBDSRG2
DCBDSGGS EQU   DCBDSRG2
DCBDSGU  EQU   DCBDSRG1
DCBDSGPO EQU   DCBDSRG1
@NM00093 EQU   DCBDSRG1
@NM00092 EQU   DCBDSRG1
DCBDSGCX EQU   DCBDSRG1
DCBDSGDA EQU   DCBDSRG1
DCBDSGPS EQU   DCBDSRG1
DCBDSGIS EQU   DCBDSRG1
DCBBUFL  EQU   IHADCS11+8
DCBBUFCA EQU   DCBBUFCB+1
DCBBUFNO EQU   DCBBUFCB
DCBDEVT  EQU   DCBREL
DCBKEYLE EQU   DCBRELB
DCBTRBAL EQU   IHADCS01+6
@NM00091 EQU   IHADCS01+5
@NM00090 EQU   IHADCS01+4
DCBDVTBA EQU   DCBDVTBL+1
@NM00089 EQU   DCBDVTBL
DCBKEYCN EQU   IHADCS00+4
DCBRELAD EQU   IHADCS00
RDJA2CT  EQU   RDJLSTA+4
RDJA1CT  EQU   RDJLSTA
TM35MT   EQU   TM35MDL+8
TM35MO   EQU   TM35MDL+4
TM35ML   EQU   TM35MDL
TM34MT   EQU   TM34MDL+8
TM34MO   EQU   TM34MDL+4
TM34ML   EQU   TM34MDL
TM33MT   EQU   TM33MDL+8
TM33MO   EQU   TM33MDL+4
TM33ML   EQU   TM33MDL
TM32MT   EQU   TM32MDL+8
TM32MO   EQU   TM32MDL+4
TM32ML   EQU   TM32MDL
TM31MT   EQU   TM31MDL+8
TM31MO   EQU   TM31MDL+4
TM31ML   EQU   TM31MDL
TM25MT   EQU   TM25MDL+8
TM25MO   EQU   TM25MDL+4
TM25ML   EQU   TM25MDL
TM24MT   EQU   TM24MDL+8
TM24MO   EQU   TM24MDL+4
TM24ML   EQU   TM24MDL
TM23MT   EQU   TM23MDL+8
TM23MO   EQU   TM23MDL+4
TM23ML   EQU   TM23MDL
TM22MT   EQU   TM22MDL+8
TM22MO   EQU   TM22MDL+4
TM22ML   EQU   TM22MDL
TM21MT   EQU   TM21MDL+8
TM21MO   EQU   TM21MDL+4
TM21ML   EQU   TM21MDL
TM15MT   EQU   TM15MDL+8
TM15MO   EQU   TM15MDL+4
TM15ML   EQU   TM15MDL
TM14MT   EQU   TM14MDL+8
TM14MO   EQU   TM14MDL+4
TM14ML   EQU   TM14MDL
TM13MT   EQU   TM13MDL+8
TM13MO   EQU   TM13MDL+4
TM13ML   EQU   TM13MDL
TM12MT   EQU   TM12MDL+8
TM12MO   EQU   TM12MDL+4
TM12ML   EQU   TM12MDL
TM11MT   EQU   TM11MDL+8
TM11MO   EQU   TM11MDL+4
TM11ML   EQU   TM11MDL
TMLMN3   EQU   TMLMDL3+4
TMLNX3   EQU   TMLMDL3
TMLMN2   EQU   TMLMDL2+4
TMLMN1   EQU   TMLMDL1+4
TMS5MT   EQU   TMS5MDL+4
TMS5MO   EQU   TMS5MDL+2
TMS5ML   EQU   TMS5MDL
TMS4MT   EQU   TMS4MDL+4
TMS4MO   EQU   TMS4MDL+2
TMS4ML   EQU   TMS4MDL
TMS3MT   EQU   TMS3MDL+4
TMS3MO   EQU   TMS3MDL+2
TMS3ML   EQU   TMS3MDL
TMS2MT   EQU   TMS2MDL+4
TMS2MO   EQU   TMS2MDL+2
TMS2ML   EQU   TMS2MDL
TMS1MT   EQU   TMS1MDL+4
TMS1MO   EQU   TMS1MDL+2
TMS1ML   EQU   TMS1MDL
TMXMN    EQU   TMXMDL
DRBLCB   EQU   DRBLC
DRBLTT   EQU   DRBLC
DRBLAL   EQU   DRBLC
DRBLTTR  EQU   DRBLAS+8
DRBLNAM  EQU   DRBLAS
DIRBCB   EQU   DIRBCA
DIRBTT   EQU   DIRBCA
DIRBAL   EQU   DIRBCA
DIRBTTR  EQU   DIRBDA+8
PTPBFLN  EQU   PTPB+8
@NM00265 EQU   PTPB
SWRKRS   EQU   SWRKA+100
PPEP     EQU   SWRKA+96
PPNAM    EQU   SWRKA+88
STRG15   EQU   STRGS+60
STRG14   EQU   STRGS+56
STRG13   EQU   STRGS+52
STRG12   EQU   STRGS+48
STRG11   EQU   STRGS+44
STRG10   EQU   STRGS+40
STRG9    EQU   STRGS+36
STRG8    EQU   STRGS+32
STRG7    EQU   STRGS+28
STRG6    EQU   STRGS+24
STRG5    EQU   STRGS+20
STRG4    EQU   STRGS+16
STRG3    EQU   STRGS+12
STRG2    EQU   STRGS+8
STRG1    EQU   STRGS+4
STRG0    EQU   STRGS
LASPSW   EQU   SWRKA+16
BNDPSW   EQU   SWRKA+8
SEXPL    EQU   SWRKA
NNDBSP   EQU   NUNDB+4
NNDBRS   EQU   NUNDB+1
NNDBCT   EQU   NUNDB
NNEXUDAT EQU   NNEXUWD3+1
NNEXUDFL EQU   NNEXUWD3
NNEXUSUB EQU   NNEXUWD2+1
NNEXUSFL EQU   NNEXUWD2
NNEXUNEX EQU   NNEXUWD1+1
@NM00264 EQU   NNEXUNFL
@NM00263 EQU   NNEXUNFL
@NM00262 EQU   NNEXUNFL
@NM00261 EQU   NNEXUNFL
@NM00260 EQU   NNEXUNFL
@NM00259 EQU   NNEXUNFL
@NM00258 EQU   NNEXUNFL
NNEXUFLG EQU   NNEXUNFL
NCDBSP   EQU   NUCDB+4
NCDBRS   EQU   NUCDB+1
NCDBCT   EQU   NUCDB
NCURUDFL EQU   NCURUWD3
NCURUSFL EQU   NCURUWD2
@NM00257 EQU   NCURUNFL
@NM00256 EQU   NCURUNFL
@NM00255 EQU   NCURUNFL
@NM00254 EQU   NCURUNFL
@NM00253 EQU   NCURUNFL
@NM00252 EQU   NCURUNFL
@NM00251 EQU   NCURUNFL
NPDBSP   EQU   NUPDB+4
NPDBRS   EQU   NUPDB+1
NPDBCT   EQU   NUPDB
NLASUDAT EQU   NLASUWD3+1
NLASUDFL EQU   NLASUWD3
NLASUSFL EQU   NLASUWD2
NLASUNEX EQU   NLASUWD1+1
@NM00250 EQU   NLASUNFL
@NM00249 EQU   NLASUNFL
@NM00248 EQU   NLASUNFL
@NM00247 EQU   NLASUNFL
@NM00246 EQU   NLASUNFL
@NM00245 EQU   NLASUNFL
@NM00244 EQU   NLASUNFL
NLASUFLG EQU   NLASUNFL
ONDBSP   EQU   OLNDB+4
ONDBRS   EQU   OLNDB+1
ONDBCT   EQU   OLNDB
ONEXUDAT EQU   ONEXUWD3+1
ONEXUDFL EQU   ONEXUWD3
ONEXUSUB EQU   ONEXUWD2+1
ONEXUSFL EQU   ONEXUWD2
ONEXUNEX EQU   ONEXUWD1+1
@NM00243 EQU   ONEXUNFL
@NM00242 EQU   ONEXUNFL
@NM00241 EQU   ONEXUNFL
@NM00240 EQU   ONEXUNFL
@NM00239 EQU   ONEXUNFL
@NM00238 EQU   ONEXUNFL
@NM00237 EQU   ONEXUNFL
ONEXUFLG EQU   ONEXUNFL
@NM00236 EQU   DUPLIDAT+5
OCDBRS   EQU   OLCDB+1
OCURUDAT EQU   OCURUWD3+1
OCURUDFL EQU   OCURUWD3
OCURUSUB EQU   OCURUWD2+1
OCURUSFL EQU   OCURUWD2
OCURUNEX EQU   OCURUWD1+1
@NM00235 EQU   OCURUNFL
@NM00234 EQU   OCURUNFL
@NM00233 EQU   OCURUNFL
@NM00232 EQU   OCURUNFL
@NM00231 EQU   OCURUNFL
@NM00230 EQU   OCURUNFL
@NM00229 EQU   OCURUNFL
OCURUFLG EQU   OCURUNFL
OPDBSP   EQU   OLPDB+4
OPDBRS   EQU   OLPDB+1
OPDBCT   EQU   OLPDB
OLASUDAT EQU   OLASUWD3+1
OLASUDFL EQU   OLASUWD3
OLASUSUB EQU   OLASUWD2+1
OLASUSFL EQU   OLASUWD2
OLASUNEX EQU   OLASUWD1+1
@NM00228 EQU   OLASUNFL
@NM00227 EQU   OLASUNFL
@NM00226 EQU   OLASUNFL
@NM00225 EQU   OLASUNFL
@NM00224 EQU   OLASUNFL
@NM00223 EQU   OLASUNFL
@NM00222 EQU   OLASUNFL
OLASUFLG EQU   OLASUNFL
NNTST3   EQU   NNAMID+84
NNDCN3   EQU   NNDXN3+2
NNDTN3   EQU   NNDXN3
@NM00221 EQU   NNAMID+77
@NM00220 EQU   NNCLS3
@NM00219 EQU   NNCLS3
@NM00218 EQU   NNCLS3
@NM00217 EQU   NNCLS3
@NM00216 EQU   NNCLS3
@NM00215 EQU   NNCLS3
@NM00214 EQU   NNCLS3
NNBLDG3  EQU   NNCLS3
NNFDAT3  EQU   NNMOFS3+8
NNFSUB3  EQU   NNMOFS3+4
NNMFNX3  EQU   NNMOFS3+1
@NM00213 EQU   NNFLG3S
@NM00212 EQU   NNFLG3S
@NM00211 EQU   NNFLG3S
@NM00210 EQU   NNFLG3S
@NM00209 EQU   NNFLG3S
@NM00208 EQU   NNFLG3S
@NM00207 EQU   NNFLG3S
NNFLG31  EQU   NNFLG3S
NNDCN2   EQU   NNDXN2+2
NNDTN2   EQU   NNDXN2
@NM00206 EQU   NNAMID+49
@NM00205 EQU   NNCLS2
@NM00204 EQU   NNCLS2
@NM00203 EQU   NNCLS2
@NM00202 EQU   NNCLS2
@NM00201 EQU   NNCLS2
@NM00200 EQU   NNCLS2
@NM00199 EQU   NNCLS2
NNBLDG2  EQU   NNCLS2
NNFSUB2  EQU   NNMOFS2+4
@NM00198 EQU   NNFLG2S
@NM00197 EQU   NNFLG2S
@NM00196 EQU   NNFLG2S
@NM00195 EQU   NNFLG2S
@NM00194 EQU   NNFLG2S
@NM00193 EQU   NNFLG2S
@NM00192 EQU   NNFLG2S
NNDCN1   EQU   NNDXN1+2
NNDTN1   EQU   NNDXN1
@NM00191 EQU   NNAMID+21
@NM00190 EQU   NNCLS1
@NM00189 EQU   NNCLS1
@NM00188 EQU   NNCLS1
@NM00187 EQU   NNCLS1
@NM00186 EQU   NNCLS1
@NM00185 EQU   NNCLS1
@NM00184 EQU   NNCLS1
NNBLDG1  EQU   NNCLS1
NNFDAT1  EQU   NNMOFS1+8
NNMFNX1  EQU   NNMOFS1+1
@NM00183 EQU   NNFLG1S
@NM00182 EQU   NNFLG1S
@NM00181 EQU   NNFLG1S
@NM00180 EQU   NNFLG1S
@NM00179 EQU   NNFLG1S
@NM00178 EQU   NNFLG1S
@NM00177 EQU   NNFLG1S
NNFLG11  EQU   NNFLG1S
ONTST3   EQU   ONAMID+84
ONDCN3   EQU   ONDXN3+2
ONDTN3   EQU   ONDXN3
@NM00176 EQU   ONAMID+77
@NM00175 EQU   ONCLS3
@NM00174 EQU   ONCLS3
@NM00173 EQU   ONCLS3
@NM00172 EQU   ONCLS3
@NM00171 EQU   ONCLS3
@NM00170 EQU   ONCLS3
@NM00169 EQU   ONCLS3
ONBLDG3  EQU   ONCLS3
ONFDAT3  EQU   ONMOFS3+8
ONFSUB3  EQU   ONMOFS3+4
ONMFNX3  EQU   ONMOFS3+1
@NM00168 EQU   ONFLG3S
@NM00167 EQU   ONFLG3S
@NM00166 EQU   ONFLG3S
@NM00165 EQU   ONFLG3S
@NM00164 EQU   ONFLG3S
@NM00163 EQU   ONFLG3S
@NM00162 EQU   ONFLG3S
ONFLG31  EQU   ONFLG3S
ONDCN2   EQU   ONDXN2+2
ONDTN2   EQU   ONDXN2
@NM00161 EQU   ONAMID+49
@NM00160 EQU   ONCLS2
@NM00159 EQU   ONCLS2
@NM00158 EQU   ONCLS2
@NM00157 EQU   ONCLS2
@NM00156 EQU   ONCLS2
@NM00155 EQU   ONCLS2
@NM00154 EQU   ONCLS2
ONBLDG2  EQU   ONCLS2
ONFSUB2  EQU   ONMOFS2+4
@NM00153 EQU   ONFLG2S
@NM00152 EQU   ONFLG2S
@NM00151 EQU   ONFLG2S
@NM00150 EQU   ONFLG2S
@NM00149 EQU   ONFLG2S
@NM00148 EQU   ONFLG2S
@NM00147 EQU   ONFLG2S
ONDCN1   EQU   ONDXN1+2
ONDTN1   EQU   ONDXN1
@NM00146 EQU   ONAMID+21
@NM00145 EQU   ONCLS1
@NM00144 EQU   ONCLS1
@NM00143 EQU   ONCLS1
@NM00142 EQU   ONCLS1
@NM00141 EQU   ONCLS1
@NM00140 EQU   ONCLS1
@NM00139 EQU   ONCLS1
ONBLDG1  EQU   ONCLS1
ONFDAT1  EQU   ONMOFS1+8
ONMFNX1  EQU   ONMOFS1+1
@NM00138 EQU   ONFLG1S
@NM00137 EQU   ONFLG1S
@NM00136 EQU   ONFLG1S
@NM00135 EQU   ONFLG1S
@NM00134 EQU   ONFLG1S
@NM00133 EQU   ONFLG1S
@NM00132 EQU   ONFLG1S
ONFLG11  EQU   ONFLG1S
@NM00131 EQU   CURBYT2
@NM00130 EQU   CURBYT1
CUDITTRC EQU   CUDIRENT+8
CUDIUSER EQU   CUDIRENT
@NM00129 EQU   UADIBYT2
@NM00128 EQU   UADIBYT1
UADINEW  EQU   UADIBYT1
UADITTRC EQU   UADIRENT+8
UADIUSER EQU   UADIRENT
@NM00127 EQU   UPT+15
UPTLDEL  EQU   UPT+14
UPTCDEL  EQU   UPT+13
UPTWTP   EQU   UPTSWS
UPTMODE  EQU   UPTSWS
UPTALD   EQU   UPTSWS
UPTPAUS  EQU   UPTSWS
UPTNCOM  EQU   UPTSWS
UPTMID   EQU   UPTSWS
UPTNPRM  EQU   UPTSWS
@NM00126 EQU   UPTSWS
UPTUSER  EQU   UPT+2
@NM00125 EQU   UPT
UADSUNAM EQU   DROBD+16
UADSRSIZ EQU   DROBD+14
@NM00124 EQU   DROBD+12
UADSRNAM EQU   DROBD+4
@NM00123 EQU   DROBD+1
UADSRCTR EQU   DROBD
UADSANUM EQU   DNOBD+45
UADSALEN EQU   DNOBD+44
@NM00122 EQU   DNOBD+1
UADSACTR EQU   DNOBD
UADSPPWD EQU   DPOBD+4
@NM00121 EQU   DPOBD+1
UADSPCTR EQU   DPOBD
UADSRDAT EQU   DROB+8
@NM00120 EQU   DROB+4
UADSRNEX EQU   DROB+1
@NM00119 EQU   DROB
FLGR01   EQU   DROB
UADSADAT EQU   DNOB+8
UADSASUB EQU   DNOB+4
UADSANEX EQU   DNOB+1
@NM00118 EQU   DNOB
AFLG01   EQU   DNOB
UADSPDAT EQU   DPOB+8
UADSPSUB EQU   DPOB+4
UADSPNEX EQU   DPOB+1
@NM00117 EQU   DPOB
PFLG01   EQU   DPOB
UADSNDAT EQU   UADSNODE+8
UADSNSUB EQU   UADSNODE+4
UADSNNEX EQU   UADSNWD1+1
@NM00116 EQU   UADSNWD1
UADSNFLG EQU   UADSNWD1
@NM00115 EQU   DHED+40
UADSDEST EQU   DHED+32
UADSINST EQU   DHED+18
@NM00114 EQU   UADSATTR
USATR03  EQU   UADSATTR
USATR02  EQU   UADSATTR
USATR01  EQU   UADSATTR
USATR00  EQU   UADSATTR
UADSMAXC EQU   UADSMHDR+14
@NM00113 EQU   UADSBN01+1
@NM00112 EQU   UADSBN01
JFCRSV05 EQU   JFCEROPT
JFCRSV04 EQU   JFCEROPT
JFCRSV03 EQU   JFCEROPT
JFCRSV02 EQU   JFCEROPT
JFCTOPT  EQU   JFCEROPT
JFCABN   EQU   JFCEROPT
JFCSKP   EQU   JFCEROPT
JFCACC   EQU   JFCEROPT
JFCBUFL  EQU   JFCAMPTR+2
JFCFWORD EQU   JFCBFTEK
JFCDWORD EQU   JFCBFTEK
JFCHIER1 EQU   JFCBFTEK
JFCDYN   EQU   JFCBFTEK
JFCEXC   EQU   JFCBFTEK
JFCBBFTR EQU   JFCBBFTA
JFCSIM   EQU   JFCBBFTA
JFCHIER  EQU   JFCBFTEK
JFCBFOUT EQU   JFCBUFNO
JFCBUFIN EQU   JFCBUFNO
JFCTEMP  EQU   JFCBIND2
JFCREQ   EQU   JFCBIND2
JFCENT   EQU   JFCBIND2
JFCSHARE EQU   JFCBIND2
JFCSECUR EQU   JFCBIND2
JFCPDS   EQU   JFCBIND1
JFCGDG   EQU   JFCBIND1
JFCADDED EQU   JFCBIND1
JFCLOC   EQU   JFCBIND1
JFCRLSE  EQU   JFCBIND1
JFCBXPDT EQU   INFMJFCB+83
JFCBCRDT EQU   INFMJFCB+80
JFCBOPS2 EQU   JFCBMASK+7
JFCRCTLG EQU   JFCBFLG2
JFCBBUFF EQU   JFCBFLG2
JFCTRACE EQU   JFCBFLG2
JFCSDRPS EQU   JFCBFLG2
JFCMODNW EQU   JFCBFLG2
JFCNRPS  EQU   JFCDEFER
JFCOUTOP EQU   JFCBFLG2
JFCINOP  EQU   JFCBFLG2
JFCBPWBP EQU   JFCOPEN
@NM00108 EQU   JFCOPEN
JFCDUAL  EQU   JFCBFLG1
JFCSLDES EQU   JFCBFLG1
JFCSLCRE EQU   JFCBFLG1
JFCSTAND EQU   JFCBFLG1
JFCBOPS1 EQU   JFCBMASK
JFCBVLSQ EQU   INFMJFCB+70
JFCRSV31 EQU   JFCFUNC
JFCFNCBT EQU   JFCFUNC
JFCFNCBX EQU   JFCFUNC
JFCFNCBD EQU   JFCFUNC
JFCFNCBW EQU   JFCFUNC
JFCFNCBP EQU   JFCFUNC
JFCFNCBR EQU   JFCFUNC
JFCFNCBI EQU   JFCFUNC
JFCBFOFL EQU   JFCBUFOF
JFCNL    EQU   JFCBLTYP
JFCSL    EQU   JFCBLTYP
JFCNSL   EQU   JFCBLTYP
JFCSUL   EQU   JFCBLTYP
JFCBLP   EQU   JFCBLTYP
JFCBLTM  EQU   JFCBLTYP
JFCBAL   EQU   JFCBLTYP
JFCRSV38 EQU   JFCBLTYP
JFCVINDX EQU   INFMJFCB+64
JFCNLREC EQU   INFMJFCB+62
JFCBADBF EQU   INFMJFCB+60
JFCAMSTR EQU   JFCBFRID+2
JFCAMCRO EQU   JFCBFRID
JFCBDSCB EQU   INFMJFCB+53
JFCPAT   EQU   JFCBTSDM
JFCNDCB  EQU   JFCBTSDM
JFCNDSCB EQU   JFCBTSDM
JFCNWRIT EQU   JFCBTSDM
JFCTTR   EQU   JFCBTSDM
JFCSDS   EQU   JFCBTSDM
JFCVSL   EQU   JFCBTSDM
JFCCAT   EQU   JFCBTSDM
JFCIPLTX EQU   JFCBELNM
JFCBQNAM EQU   JFCBDSNM
@NM00088 EQU   IHADCB
CPPLPSCB EQU   CPPL+8
CPPLCBUF EQU   CPPL
IOPLECB  EQU   IOPL+8
IOPLECT  EQU   IOPL+4
IOPLUPT  EQU   IOPL
@NM00087 EQU   ECT+52
@NM00086 EQU   ECT+48
@NM00085 EQU   ECT+44
@NM00084 EQU   ECTSWS2+1
@NM00083 EQU   ECTSWS21
ECTTABND EQU   ECTSWS21
ECTDEFCS EQU   ECTSWS21
ECTBKPB  EQU   ECT+36
ECTUSER  EQU   ECT+32
ECTDDNUM EQU   ECT+29
ECTATTN  EQU   ECTSWS
ECTBKGRD EQU   ECTSWS
ECTNNOT  EQU   ECTSWS
ECTNMAL  EQU   ECTSWS
ECTLOGF  EQU   ECTSWS
@NM00082 EQU   ECTSWS
ECTNOPD  EQU   ECTSWS
ECTSCMD  EQU   ECT+20
ECTPCMD  EQU   ECT+12
ECTSMSG  EQU   ECT+9
ECTMSGF  EQU   ECT+8
ECTIOWA  EQU   ECT+4
MIDSLOF  EQU   MIDSHDR+6
MIDSLNX  EQU   MIDSHDR
STAENL4  EQU   STAENPL+12
STAENL3  EQU   STAENPL+8
STAENL2  EQU   STAENPL+4
STAENL1  EQU   STAENPL
RCLRES   EQU   RTCLIST
*                                      END UNREFERENCED COMPONENTS
@RC00393 EQU   @RC00391
@RF00614 EQU   @RC00604
@RC00681 EQU   @RC00679
@RF00791 EQU   @RC00789
@RC01063 EQU   @RC01057
@RC01061 EQU   @RC01057
@RC01059 EQU   @RC01057
@RF01153 EQU   @RC01150
@RC01257 EQU   @RC01254
@RF01321 EQU   @RC01318
@RC01464 EQU   @RC01462
@RC01534 EQU   @RC01531
@RC01569 EQU   @RC01567
@EL01    EQU   @EL00001
@ENDDATA EQU   *
         END   IKJRBBU0,(C'PLS1929',0701,76163)

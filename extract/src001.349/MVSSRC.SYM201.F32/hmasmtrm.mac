         TITLE 'HMASMTRM - RESTORE ELEMENT SELECTION'
HMASMTRM CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'HMASMTRM  78.334'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  LA    @08,4095(,@12)                                      0001
         LA    @09,4095(,@08)                                      0001
         LA    @10,4095(,@09)                                      0001
         USING @PSTART,@12                                         0001
         USING @PSTART+4095,@08                                    0001
         USING @PSTART+8190,@09                                    0001
         USING @PSTART+12285,@10                                   0001
         ST    @13,@SA00001+4                                      0001
         LA    @14,@SA00001                                        0001
         ST    @14,8(,@13)                                         0001
         LR    @13,@14                                             0001
         MVC   @PC00001(4),0(@01)                                  0001
         EJECT
*                                                                  0231
*   /*****************************************************************/
*   /*                                                               */
*   /* HMASMTRM << MAINLINE                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0231
*   TRMRC=ZERO;                     /* CLEAR THE RETURN CODE         */
*                                                                  0231
         SLR   TRMRC,TRMRC                                         0231
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE PROCESSING                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0232
*   CALL TRMINIT;                                                  0232
*                                                                  0232
         BAL   @14,TRMINIT                                         0232
*   /*****************************************************************/
*   /*                                                               */
*   /* BUILD ICT ENTRY FOR EACH ELEMENT IN EACH SYSMOD               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0233
*   IF TRMRC<STOPFUNC THEN          /* NO SERIOUS ERROR?             */
         CH    TRMRC,@CH00033                                      0233
         BNL   @RF00233                                            0233
*     DO;                           /* YES                           */
*       CALL GETMOD;                                               0235
         BAL   @14,GETMOD                                          0235
*       RFY                                                        0236
*         RTNCODE RSTD;                                            0236
*       TRMRC=MAX(RTNCODE,TRMRC);   /* SET THE RETURN CODE           */
         CR    TRMRC,RTNCODE                                       0237
         BNL   *+6
         LR    TRMRC,RTNCODE                                       0237
*       RFY                                                        0238
*         RTNCODE UNRSTD;                                          0238
*     END;                                                         0239
*                                                                  0239
*   /*****************************************************************/
*   /*                                                               */
*   /* SELECT THE ELEMENT VERSION                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0240
*   IF TRMRC<STOPFUNC THEN          /* NO SERIOUS ERROR?             */
@RF00233 CH    TRMRC,@CH00033                                      0240
         BNL   @RF00240                                            0240
*     DO;                           /* YES                           */
*       CALL SELMOD;                                               0242
         BAL   @14,SELMOD                                          0242
*       RFY                                                        0243
*         RTNCODE RSTD;                                            0243
*       TRMRC=MAX(RTNCODE,TRMRC);   /* SET THE RETURN CODE           */
         CR    TRMRC,RTNCODE                                       0244
         BNL   *+6
         LR    TRMRC,RTNCODE                                       0244
*       RFY                                                        0245
*         RTNCODE UNRSTD;                                          0245
*     END;                                                         0246
*                                                                  0246
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE ALL SYSMODS THAT REFERENCE EACH ELEMENT             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0247
*   IF TRMRC<STOPFUNC THEN          /* NO SERIOUS ERROR?             */
@RF00240 CH    TRMRC,@CH00033                                      0247
         BNL   @RF00247                                            0247
*     DO;                           /* YES                           */
*       CALL XRFSETUP;                                             0249
         BAL   @14,XRFSETUP                                        0249
*       RFY                                                        0250
*         RTNCODE RSTD;                                            0250
*       TRMRC=MAX(RTNCODE,TRMRC);   /* SET THE RETURN CODE           */
         CR    TRMRC,RTNCODE                                       0251
         BNL   *+6
         LR    TRMRC,RTNCODE                                       0251
*       RFY                                                        0252
*         RTNCODE UNRSTD;                                          0252
*       IF TRMRC<STOPFUNC THEN      /* ERROR OCCURRED?               */
         CH    TRMRC,@CH00033                                      0253
         BNL   @RF00253                                            0253
*         DO;                       /* YES,                          */
*           CALL HMASMXRF(LISTPARM, /* LIST PARM LIST                */
*               MXOUTGTP,           /* (OUTPUT) ELEMENT TO SYSMOD  0255
*                                      XREF GTP                      */
*               MSELGTP);           /* (INPUT) ELEMENT SELECTED GTP  */
         L     @15,@CV02019                                        0255
         LA    @01,@AL00255                                        0255
         BALR  @14,@15                                             0255
*           RFY                                                    0256
*             RTNCODE RSTD;                                        0256
*           TRMRC=MAX(RTNCODE,TRMRC);/* SET THE RETURN CODE          */
         CR    TRMRC,RTNCODE                                       0257
         BNL   *+6
         LR    TRMRC,RTNCODE                                       0257
*           RFY                                                    0258
*             RTNCODE UNRSTD;                                      0258
*         END;                                                     0259
*     END;                                                         0260
*                                                                  0260
@RF00253 DS    0H                                                  0261
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK EACH SYSMOD THAT REFERENCES AN ELEMENT                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0261
*   IF TRMRC<STOPFUNC THEN          /* NO SERIOUS ERROR?             */
@RF00247 CH    TRMRC,@CH00033                                      0261
         BNL   @RF00261                                            0261
*     DO;                           /* YES                           */
*       CALL CHKXRF;                                               0263
         BAL   @14,CHKXRF                                          0263
*       RFY                                                        0264
*         RTNCODE RSTD;                                            0264
*       TRMRC=MAX(RTNCODE,TRMRC);   /* SET THE RETURN CODE           */
         CR    TRMRC,RTNCODE                                       0265
         BNL   *+6
         LR    TRMRC,RTNCODE                                       0265
*       RFY                                                        0266
*         RTNCODE UNRSTD;                                          0266
*     END;                                                         0267
*                                                                  0267
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK STATUS OF EACH ELEMENT AND ITS MOD ID'S                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0268
*   IF TRMRC<STOPFUNC THEN          /* NO SERIOUS ERROR?             */
@RF00261 CH    TRMRC,@CH00033                                      0268
         BNL   @RF00268                                            0268
*     DO;                           /* YES                           */
*       CALL MODIDCHK;                                             0270
         BAL   @14,MODIDCHK                                        0270
*       RFY                                                        0271
*         RTNCODE RSTD;                                            0271
*       TRMRC=MAX(RTNCODE,TRMRC);   /* SET THE RETURN CODE           */
         CR    TRMRC,RTNCODE                                       0272
         BNL   *+6
         LR    TRMRC,RTNCODE                                       0272
*       RFY                                                        0273
*         RTNCODE UNRSTD;                                          0273
*     END;                                                         0274
*                                                                  0274
*   /*****************************************************************/
*   /*                                                               */
*   /* CLEANUP                                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0275
*   CALL TRMCLEAN;                                                 0275
@RF00268 BAL   @14,TRMCLEAN                                        0275
*   RFY                                                            0276
*     RTNCODE RSTD;                                                0276
*   TRMRC=MAX(RTNCODE,TRMRC);       /* SET THE RETURN CODE           */
         CR    TRMRC,RTNCODE                                       0277
         BNL   *+6
         LR    TRMRC,RTNCODE                                       0277
*   RFY                                                            0278
*     RTNCODE UNRSTD;                                              0278
*   RETURN CODE(TRMRC);             /*                               */
         LR    @15,TRMRC                                           0279
         L     @13,4(,@13)                                         0279
         L     @14,12(,@13)                                        0279
         LM    @00,@12,20(@13)                                     0279
         BR    @14                                                 0279
         EJECT
*                                                                  0280
*   /*****************************************************************/
*   /*                                                               */
*   /* TRMINIT -                                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0280
*TRMINIT:                                                          0280
*   PROC;                                                          0280
TRMINIT  STM   @14,@12,12(@13)                                     0280
*   DCL                                                            0281
*     INITRC FIXED(15);             /* LOCAL RETURN CODE             */
*   INITRC=ZERO;                    /* CLEAR LOCAL RETURN CODE       */
         SLR   INITRC,INITRC                                       0282
*   TRMFLAGS=''B;                   /* CLEAR CONTROL FLAGS           */
         MVI   TRMFLAGS,X'00'                                      0283
*                                                                  0284
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE LIST PARAMETER LIST. THIS WILL BE USED TO CREATE A */
*   /* SYSMOD TO ELEMENT GTA FILE BY CALLING HMASMXRF                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0284
*   LISTPARM=''B;                   /*                               */
         XC    LISTPARM(19),LISTPARM                               0284
*   LISTCDS=ON;                     /* LIST CDS                      */
         OI    LISTCDS,B'01000000'                                 0285
*   LISTASM=ON;                     /* RETURN ALL ELEMENT TYPE     0286
*                                      RECORDS                       */
*   LISTMAC=ON;                     /* ...                           */
*   LISTMOD=ON;                     /* ...                           */
*   LISTSRC=ON;                     /* ...                           */
         OI    LISTASM,B'01011100'                                 0289
*   LISTSEL=ON;                     /* PROCESS SELECTED ENTRIES, NOT
*                                      ALL                           */
*   LISTXREF=ON;                    /* PRODUCE CROSS REFERENCE       */
*                                                                  0291
         OI    LISTSEL,B'11000000'                                 0291
*   /*****************************************************************/
*   /*                                                               */
*   /* CLEAR INTERNAL GTP'S                                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0292
*   MXOUTGTP=''B;                   /* CLEAR THE ELEMENT TO SYSMOD 0292
*                                      GTP                           */
         XC    MXOUTGTP(28),MXOUTGTP                               0292
*   MSELGTP=''B;                    /* CLEAR XREF MODULE SELECT GTP  */
*                                                                  0293
         XC    MSELGTP(28),MSELGTP                                 0293
*   /*****************************************************************/
*   /*                                                               */
*   /* INIT GTP IN TRMINIT                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0294
*   RFY                                                            0294
*     HMASMGTP BASED(ADDR(ASMGTP));                                0294
*   HMASMGTP=''B;                   /* CLEAR THE GTP                 */
         LA    @03,ASMGTP                                          0295
         XC    HMASMGTP(28,@03),HMASMGTP(@03)                      0295
*   GTPRCDLN=LENGTH(TM4RCD);        /* INITIALIZE RECORD LENGTH      */
         MVC   GTPRCDLN(2,@03),@CH00033                            0296
*   GTPKEYLN=LENGTH(TM4NAME);       /* KEY LENGTH                    */
         MVC   GTPKEYLN(2,@03),@CH00034                            0297
*   GTPBUFAD=ADDR(TM4RCD);          /* INPUT/OUTPUT BUFFER           */
         LA    @15,TM4RCD                                          0298
         ST    @15,GTPBUFAD(,@03)                                  0298
*   GTPPSIZE=GTP512B;               /* PAGE SIZE                     */
         NI    GTPPSIZE(@03),B'11111001'                           0299
         OI    GTPPSIZE(@03),B'00000001'                           0299
*   RFY                                                            0300
*     HMASMGTP BASED;                                              0300
*   RETURN CODE(INITRC);            /* RETURN W/RC SET               */
         LR    @15,INITRC                                          0301
         L     @14,12(,@13)                                        0301
         LM    @00,@12,20(@13)                                     0301
         BR    @14                                                 0301
*   END TRMINIT;                                                   0302
         EJECT
*                                                                  0303
*/****************************************************************   */
*/*                                                                  */
*/* GETMOD -                                                         */
*/*                                                                  */
*/* INPUT  - ICT PTF SECTION                                         */
*/*                                                                  */
*/* OUTPUT - ICT MOD SECTION                                         */
*/*        - RETURN CODES                                            */
*/*          0 -                                                     */
*/*          12- IO ERROR OR NOT ENOUGH SPACE                        */
*/*          16- IO ERROR                                            */
*/****************************************************************   */
*                                                                  0303
*GETMOD:                                                           0303
*   PROC;                                                          0303
GETMOD   STM   @14,@12,@SA00003                                    0303
*   DCL                                                            0304
*     GETMRC FIXED(15);             /* LOCAL RETURN CODE             */
*   DCL                                                            0305
*     GETM1PRC FIXED(15);           /* RETURN CODE FOR 1 SYSMOD      */
*   DCL                                                            0306
*     GETMPTFX FIXED(31);           /* ICT PTF ENTRY INDEX           */
*   DCL                                                            0307
*     GETMSUBX FIXED(31);           /* IOP SUB-ENTRY INDEX           */
*   DCL                                                            0308
*     GETICTYP CHAR(1);             /* ICT MOD ENTRY TYPE            */
*   RFY                                                            0309
*     ICTPTF BASED(CCAICPTF);                                      0309
*   RFY                                                            0310
*     HMASMIOP BASED(TBLXIOP3);     /* EXTENDED IOP                  */
*   GETMRC=ZERO;                    /* CLEAR LOCAL RETURN CODE       */
         SLR   GETMRC,GETMRC                                       0311
*                                                                  0312
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE IOP FOR GETTING SYSMOD EXTENDED CDS ENTRY          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0312
*   IOPDSID=IOPCDS;                 /* GET CDS ...                   */
         L     @02,@PC00001                                        0312
         L     @02,TBLXIOP3(,@02)                                  0312
         MVI   IOPDSID(@02),X'02'                                  0312
*   IOPTYPE=IOPSMD;                 /* ... SYSMOD ...                */
         MVI   IOPTYPE(@02),X'0B'                                  0313
*   IOPFUNCT=IOPLOC;                /* ... EXTENDED ENTRY            */
*                                                                  0314
         MVI   IOPFUNCT(@02),X'03'                                 0314
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESS ALL SYSMODS                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0315
*   DO GETMPTFX=1 BY 1              /* PROCESS ALL ICT SYSMODS       */
*         WHILE(ICTPEND(GETMPTFX)^=ICTENDNT/* ...                    */
*         &GETMRC<STOPFUNC);        /* ...                           */
         LA    GETMPTFX,1                                          0315
         B     @DE00315                                            0315
@DL00315 DS    0H                                                  0316
*     GETM1PRC=ZERO;                /* ALL IS WELL FOR CURRENT SYSMOD*/
         SLR   GETM1PRC,GETM1PRC                                   0316
*     IF ICTPNOGO(GETMPTFX)=OFF     /* SYSMOD NOT FAILED ...         */
*         &ICTPSUPN(GETMPTFX)=ZERO THEN/* ... AND NOT SUPED?         */
         LR    @02,GETMPTFX                                        0317
         MH    @02,@CH02662                                        0317
         L     @15,CCAICPTF(,CCAPTR)                               0317
         ST    @02,@TF00001                                        0317
         ALR   @02,@15                                             0317
         AL    @02,@CF02692                                        0317
         TM    ICTPNOGO-8(@02),B'01000000'                         0317
         BNZ   @RF00317                                            0317
         LR    @02,@15                                             0317
         AL    @02,@TF00001                                        0317
         AL    @02,@CF02693                                        0317
         SLR   @14,@14                                             0317
         ICM   @14,3,ICTPSUPN-20(@02)                              0317
         LTR   @14,@14                                             0317
         BNZ   @RF00317                                            0317
*       DO;                         /* YES,                          */
*         IOPNAM17=ICTPTFS(GETMPTFX);/* GET CURRENT SYSMOD           */
         L     @02,@PC00001                                        0319
         L     @02,TBLXIOP3(,@02)                                  0319
         AL    @15,@TF00001                                        0319
         AL    @15,@CF02694                                        0319
         MVC   IOPNAM17(7,@02),ICTPTFS(@15)                        0319
*         CALL HMASMIO(HMASMIOP);   /* ...                           */
         ST    @02,@AL00001                                        0320
         L     @15,@CV02017                                        0320
         LA    @01,@AL00001                                        0320
         BALR  @14,@15                                             0320
*         IF IOPRETRN^=IOPGOOD THEN /* ERROR FROM IO?                */
         L     @02,@PC00001                                        0321
         L     @02,TBLXIOP3(,@02)                                  0321
         CLI   IOPRETRN(@02),0                                     0321
         BE    @RF00321                                            0321
*           DO;                     /* YES,                          */
*             GETMRC=MAX(GETMRC,IOPRETRN);/* SAVE RC                 */
         SLR   @05,@05                                             0323
         IC    @05,IOPRETRN(,@02)                                  0323
         CR    GETMRC,@05                                          0323
         BNL   *+6
         LR    GETMRC,@05                                          0323
*             IF IOPRETRN=IOPNTFND THEN/* RC WAS NOT FOUND?          */
         CLI   IOPRETRN(@02),4                                     0324
         BNE   @RF00324                                            0324
*               DO;                 /* YES,                          */
*                 GETMRC=MAX(GETMRC,STOPSMD);/* SET TO STOP SYSMOD 0326
*                                      ATLEAST                       */
*                                                                  0326
         LA    @05,8                                               0326
         CR    GETMRC,@05                                          0326
         BNL   *+6
         LR    GETMRC,@05                                          0326
*                 /***************************************************/
*                 /*                                                 */
*                 /* ISSUE MESSAGE HMA246I XXXXXXXX XXXXXXXX NOT     */
*                 /* FOUND ON XXXXXXXX                               */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0327
*                 DO;               /* HMASMPMG M1(HMA246I)VAR(CCATYP
*                                      EA(IOPTYPE),IOPNAM17,CCADSIDA(
*                                      IOPDSID))TYPE(ERR)TARGET(SYSOU
*                                      T,LOG)                        */
*                   HMASMMGP=HMASMMGP&&HMASMMGP;/* SET PARMS TO ZEROS*/
         XC    HMASMMGP(32),HMASMMGP                               0328
*                   MGPMGNO1=HMA246I;/* SET UP MSG 1 CODE            */
         MVC   MGPMGNO1(2),@CH01892                                0329
*                   MGPTYPE=MGPERR; /* SET MESSAGE TYPE              */
         MVI   MGPTYPE,X'03'                                       0330
*                   MGPPRINT='1'B;  /* SET TARGET FLAG               */
*                   MGPHLDS='1'B;   /* SET TARGET FLAG               */
         OI    MGPPRINT,B'10010000'                                0332
*                   MGPVARPT(1)=ADDR(CCATYPEA(IOPTYPE));/* SET     0333
*                                      VARIABLE PTR                  */
         SLR   @05,@05                                             0333
         IC    @05,IOPTYPE(,@02)                                   0333
         SLA   @05,3                                               0333
         L     @01,CCATPAD(,CCAPTR)                                0333
         AL    @01,@CF02695                                        0333
         LA    @05,CCATYPEA(@05,@01)                               0333
         ST    @05,MGPVARPT                                        0333
*                   MGPVARPT(2)=ADDR(IOPNAM17);/* SET VARIABLE PTR   */
         LA    @05,IOPNAM17(,@02)                                  0334
         ST    @05,MGPVARPT+4                                      0334
*                   MGPVARPT(3)=ADDR(CCADSIDA(IOPDSID));/* SET     0335
*                                      VARIABLE PTR                  */
         SLR   @05,@05                                             0335
         IC    @05,IOPDSID(,@02)                                   0335
         SLA   @05,3                                               0335
         L     @02,CCADSAD(,CCAPTR)                                0335
         AL    @02,@CF02695                                        0335
         LA    @05,CCADSIDA(@05,@02)                               0335
         ST    @05,MGPVARPT+8                                      0335
*                   CALL HMASMMSG(HMASMMGP);/* HAVE MESSAGE ISSUED   */
         L     @15,@CV02018                                        0336
         LA    @01,@AL00336                                        0336
         BALR  @14,@15                                             0336
*                 END;                                             0337
*                 GETMRC=STOPSMD;   /* FAIL THE SYSMOD RC            */
         LA    GETMRC,8                                            0338
*                 CALL FAILSMD(ICTPTF(GETMPTFX));/*                  */
         LR    @05,GETMPTFX                                        0339
         MH    @05,@CH02662                                        0339
         L     @02,CCAICPTF(,CCAPTR)                               0339
         AL    @02,@CF02694                                        0339
         LA    @05,ICTPTF(@05,@02)                                 0339
         ST    @05,@AL00001                                        0339
         LA    @01,@AL00001                                        0339
         BAL   @14,FAILSMD                                         0339
*                 RFY                                              0340
*                   RTNCODE RSTD;                                  0340
*                 GETMRC=MAX(GETMRC,RTNCODE);/* SAVE RC              */
         CR    GETMRC,RTNCODE                                      0341
         BNL   *+6
         LR    GETMRC,RTNCODE                                      0341
*                 RFY                                              0342
*                   RTNCODE UNRSTD;                                0342
*               END;                                               0343
*           END;                                                   0344
*         ELSE                      /* IO SUCCESSFUL                 */
*           DO;                                                    0345
*                                                                  0345
         B     @RC00321                                            0345
@RF00321 DS    0H                                                  0346
*             /*******************************************************/
*             /*                                                     */
*             /* BUILD ASSEM GTA FILE WITH ONE RECORD FOR EACH ASSEM */
*             /* SUB-ENTRY IN THE SYSMOD IOP                         */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0346
*             CALL ASMGTA(HMASMIOP);/* BUILD GTA FILE                */
         L     @02,@PC00001                                        0346
         L     @02,TBLXIOP3(,@02)                                  0346
         ST    @02,@AL00001                                        0346
         LA    @01,@AL00001                                        0346
         BAL   @14,ASMGTA                                          0346
*             RFY                                                  0347
*               RTNCODE RSTD;                                      0347
*             GETMRC=MAX(GETMRC,RTNCODE);/* SAVE RC                  */
         CR    GETMRC,RTNCODE                                      0348
         BNL   *+6
         LR    GETMRC,RTNCODE                                      0348
*             RFY                                                  0349
*               RTNCODE UNRSTD;                                    0349
*                                                                  0349
*             /*******************************************************/
*             /*                                                     */
*             /* PROCESS ALL IOP SUB-ENTRIES FOR A SYSMOD            */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0350
*             ASMBLDF=OFF;          /* ASSUME NO ASSEMBLIES NEEDED   */
         NI    ASMBLDF,B'01111111'                                 0350
*             DO GETMSUBX=1 BY 1    /* PROCESS ALL IOP SUBENTRIES    */
*                   WHILE(IOPPTFND(GETMSUBX)^=IOPEOLST/* ...         */
*                   &GETMRC<STOPFUNC);/*                             */
         LA    GETMSUBX,1                                          0351
         B     @DE00351                                            0351
@DL00351 DS    0H                                                  0352
*               CALL CNVTYP3(IOPPIND(GETMSUBX),/* CONVERT IOPPIND  0352
*                                      TYPE TO ICT MOD TYPE          */
*                   GETICTYP);      /*                               */
         LR    @07,GETMSUBX                                        0352
         MH    @07,@CH00035                                        0352
         L     @02,@PC00001                                        0352
         L     @02,TBLXIOP3(,@02)                                  0352
         LA    @07,IOPPIND-9(@07,@02)                              0352
         ST    @07,@AL00001                                        0352
         LA    @07,GETICTYP                                        0352
         ST    @07,@AL00001+4                                      0352
         LA    @01,@AL00001                                        0352
         BAL   @14,CNVTYP3                                         0352
*               IF GETICTYP^=ZERO THEN/* ELEMENT SUB-ENTRY TYPE?     */
         CLI   GETICTYP,0                                          0353
         BE    @RF00353                                            0353
*                 DO;               /* YES,                          */
*                                                                  0354
*                   /*************************************************/
*                   /*                                               */
*                   /* BUILD AN ICT MOD ENTRY(S) FOR ONE ELEMENT     */
*                   /* SUB-ENTRY                                     */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0355
*                   CALL BLDENTRY(ICTPTF(GETMPTFX),/* ICT PTF ENTRY  */
*                       IOPPNTRY(GETMSUBX),/* IOP SUBENTRY           */
*                       GETICTYP);  /* ICT MOD TYPE                  */
         LR    @07,GETMPTFX                                        0355
         MH    @07,@CH02662                                        0355
         L     @02,CCAICPTF(,CCAPTR)                               0355
         AL    @02,@CF02694                                        0355
         LA    @07,ICTPTF(@07,@02)                                 0355
         ST    @07,@AL00001                                        0355
         LR    @07,GETMSUBX                                        0355
         MH    @07,@CH00035                                        0355
         L     @02,@PC00001                                        0355
         L     @02,TBLXIOP3(,@02)                                  0355
         LA    @07,IOPPNTRY-9(@07,@02)                             0355
         ST    @07,@AL00001+4                                      0355
         LA    @07,GETICTYP                                        0355
         ST    @07,@AL00001+8                                      0355
         LA    @01,@AL00001                                        0355
         BAL   @14,BLDENTRY                                        0355
*                   RFY                                            0356
*                     RTNCODE RSTD;                                0356
*                   GETM1PRC=MAX(GETM1PRC,RTNCODE);/* SAVE RETURN  0357
*                                      CODE                          */
         CR    GETM1PRC,RTNCODE                                    0357
         BNL   *+6
         LR    GETM1PRC,RTNCODE                                    0357
*                   RFY                                            0358
*                     RTNCODE UNRSTD;                              0358
*                   GETMRC=MAX(GETMRC,GETM1PRC);/* SAVE RETURN CODE  */
         CR    GETMRC,GETM1PRC                                     0359
         BNL   *+6
         LR    GETMRC,GETM1PRC                                     0359
*                 END;                                             0360
*               ELSE                                               0361
*                 ;                 /* NOT AN ELEMENT TYPE SUBENTRY  */
@RF00353 DS    0H                                                  0362
*             END;                  /* END OF PROCESS ONE SYSMOD LOOP*/
         AH    GETMSUBX,@CH00064                                   0362
@DE00351 LR    @07,GETMSUBX                                        0362
         MH    @07,@CH00035                                        0362
         L     @02,@PC00001                                        0362
         L     @02,TBLXIOP3(,@02)                                  0362
         SLR   @15,@15                                             0362
         IC    @15,IOPPTFND-9(@07,@02)                             0362
         CH    @15,@CH00707                                        0362
         BE    @DC00351                                            0362
         CH    GETMRC,@CH00033                                     0362
         BL    @DL00351                                            0362
@DC00351 DS    0H                                                  0363
*             IF GETMRC<STOPFUNC    /* NO SERIOUS ERROR?             */
*                 &ASMBLDF=ON THEN  /* AND ASSEMBLY ENTRIES EXIST?   */
         CH    GETMRC,@CH00033                                     0363
         BNL   @RF00363                                            0363
         TM    ASMBLDF,B'10000000'                                 0363
         BNO   @RF00363                                            0363
*               DO;                 /* YES,                          */
*                 CALL HMASMTM4(TBLXPARM,/* PARM LIST                */
*                     ZERO,         /* NO ICT MOD ENTRY CAUSING ASSEM*/
*                     ADDR(ICTPTF(GETMPTFX)),/* PTR TO PTF SECT ENTRY*/
*                     ZERO,         /* NULL MCB PTR                  */
*                     ADDR(ASMGTP));/* ASSEM GTP FOR TM4             */
         MVC   @AL00001+4(16),@AL00365                             0365
         L     @02,@PC00001                                        0365
         ST    @02,@AL00001                                        0365
         LR    @02,GETMPTFX                                        0365
         MH    @02,@CH02662                                        0365
         L     @01,CCAICPTF(,CCAPTR)                               0365
         AL    @01,@CF02694                                        0365
         LA    @02,ICTPTF(@02,@01)                                 0365
         ST    @02,@TF00001                                        0365
         LA    @02,ASMGTP                                          0365
         ST    @02,@TF00002                                        0365
         L     @15,@CV02028                                        0365
         LA    @01,@AL00001                                        0365
         BALR  @14,@15                                             0365
*                 RFY                                              0366
*                   RTNCODE RSTD;                                  0366
*                 GETMRC=MAX(GETMRC,RTNCODE);/* SAVE RETURN CODE     */
         CR    GETMRC,RTNCODE                                      0367
         BNL   *+6
         LR    GETMRC,RTNCODE                                      0367
*                 RFY                                              0368
*                   RTNCODE UNRSTD;                                0368
*               END;                                               0369
*             IF GETMRC<STOPFUNC THEN/* NO SERIOUS ERROR?            */
@RF00363 CH    GETMRC,@CH00033                                     0370
         BNL   @RF00370                                            0370
*               DO;                 /* YES,                          */
*                 CALL MODCHAIN(ICTPTF(GETMPTFX));/* BUILD PTF TO MOD
*                                      CHAIN                         */
         LR    @02,GETMPTFX                                        0372
         MH    @02,@CH02662                                        0372
         L     @01,CCAICPTF(,CCAPTR)                               0372
         AL    @01,@CF02694                                        0372
         LA    @02,ICTPTF(@02,@01)                                 0372
         ST    @02,@AL00001                                        0372
         LA    @01,@AL00001                                        0372
         BAL   @14,MODCHAIN                                        0372
*                 RFY                                              0373
*                   RTNCODE RSTD;                                  0373
*                 GETMRC=MAX(GETMRC,RTNCODE);/* SAVE RETURN CODE     */
         CR    GETMRC,RTNCODE                                      0374
         BNL   *+6
         LR    GETMRC,RTNCODE                                      0374
*                 RFY                                              0375
*                   RTNCODE UNRSTD;                                0375
*                 IF GETM1PRC=STOPSMD THEN/* FAIL THE SYSMOD?        */
         CH    GETM1PRC,@CH00034                                   0376
         BNE   @RF00376                                            0376
*                   DO;             /* YES,                          */
*                     CALL FAILSMD(ICTPTF(GETMPTFX));/* FAIL SYSMOD  */
         LR    @05,GETMPTFX                                        0378
         MH    @05,@CH02662                                        0378
         L     @02,CCAICPTF(,CCAPTR)                               0378
         AL    @02,@CF02694                                        0378
         LA    @05,ICTPTF(@05,@02)                                 0378
         ST    @05,@AL00001                                        0378
         LA    @01,@AL00001                                        0378
         BAL   @14,FAILSMD                                         0378
*                     RFY                                          0379
*                       RTNCODE RSTD;                              0379
*                     GETMRC=MAX(GETMRC,RTNCODE);/* SAVE RETURN CODE */
         CR    GETMRC,RTNCODE                                      0380
         BNL   *+6
         LR    GETMRC,RTNCODE                                      0380
*                     RFY                                          0381
*                       RTNCODE UNRSTD;                            0381
*                   END;                                           0382
*                 ELSE                                             0383
*                   ;               /* DO NOT FAIL SYSMOD            */
@RF00376 DS    0H                                                  0384
*               END;                                               0384
*             ELSE                                                 0385
*               ;                   /* SERIOUS ERROR                 */
@RF00370 DS    0H                                                  0386
*           END;                                                   0386
*       END;                                                       0387
*     ELSE                                                         0388
*       ;                           /* THE SYSMOD IS NOGO            */
@RF00317 DS    0H                                                  0389
*   END;                            /* END OF ICT SYSMOD LOOP        */
@RC00317 AH    GETMPTFX,@CH00064                                   0389
@DE00315 LR    @05,GETMPTFX                                        0389
         MH    @05,@CH02662                                        0389
         L     @02,CCAICPTF(,CCAPTR)                               0389
         AL    @02,@CF02694                                        0389
         L     @05,ICTPEND(@05,@02)                                0389
         CL    @05,ICTENDNT                                        0389
         BE    @DC00315                                            0389
         CH    GETMRC,@CH00033                                     0389
         BL    @DL00315                                            0389
@DC00315 DS    0H                                                  0390
*   RETURN CODE(GETMRC);            /* RETURN W/RC SET               */
         LR    @15,GETMRC                                          0390
         L     @14,@SA00003                                        0390
         LM    @00,@12,@SA00003+8                                  0390
         BR    @14                                                 0390
*   RFY                                                            0391
*     ICTPTF BASED;                                                0391
*   RFY                                                            0392
*     HMASMIOP BASED;                                              0392
         EJECT
*                                                                  0393
*/********************************************************************/
*/*                                                                  */
*/* BLDENTRY - BUILD AN ICT MOD ENTRY                                */
*/*                                                                  */
*/* INPUT  - ICT PTF ENTRY FOR THE "CURRENT" SYSMOD                  */
*/*        - IOP SUB-ENTRY FOR THE MOD FOR WHICH AN ICT MOD ENTRY    */
*/*          IS TO BE CREATED                                        */
*/*                                                                  */
*/* OUTPUT - ICT MOD ENTRY AS DESCRIBED IN THE FOLLOWING TABLE:      */
*/*                                                                  */
*/*                                                                  */
*/*  CDS      × ICT    × ACTION                                      */
*/*  SYSMOD   × ENTRY  ×                                             */
*/*  SUBENTRY × TYPE   ×                                             */
*/*  TYPE     ×        ×                                             */
*/* ----------×--------×---------------------------------------------*/
*/*  MOD      × MOD    × LINK/COPY DLIB VERION TO TARGET LIBRARIES   */
*/*  ZAP      × MOD    × LINK/COPY DLIB VERION TO TARGET LIBRARIES   */
*/*  XPD      × MOD    × LINK/COPY DLIB VERION TO TARGET LIBRARIES   */
*/*  MACR     × MACR   × COPY DLIB VERSION TO TARGET LIBRARIES       */
*/*  MACU     × MACR   × COPY DLIB VERSION TO TARGET LIBRARIES       */
*/*  SRCR     × SRCR   × COPY DLIB VERSION TO TARGET LIBRARIES       */
*/*           × MASM   × ASSEMBLE AND LINKEDIT ELEMENT               */
*/*  SRCU     × SRCR   × COPY DLIB VERSION TO TARGET LIBRARIES       */
*/*           × MASM   × ASSEMBLE AND LINKEDIT ELEMENT               */
*/*  ASM      × ----   × POSTPONE PROCESSING                         */
*/* ----------×--------×---------------------------------------------*/
*/*                                                                  */
*/*  FOR SOURCE AND MACRO TYPES, ASSEMBLIES AND LINKEDITS MAY ALSO   */
*/*  BE REQUIRED FOR ASSOCIATED ELEMENTS.                            */
*/*                                                                  */
*/*  FOR ALL SUBENTRY TYPES, IF THE ELEMENT EXISTS ON THE CDS BUT NOT*/
*/*  THE ACDS, THEN IT WAS ADDED BY THIS SYSMOD AN SHOULD THEREFORE  */
*/*  BE DELETED                                                      */
*/*                                                                  */
*/*         - RC                                                     */
*/*            -  0 ALL IS WELL                                      */
*/*            -  4 TMX DID NOT FIND ENTRY                           */
*/*            -  8 SYSMOD IS FAILED BY TMX                          */
*/*            - 12 I/O ERROR                                        */
*/*            - 16 I/O ERROR                                        */
*/*                                                                  */
*/********************************************************************/
*                                                                  0393
*BLDENTRY:                                                         0393
*   PROC(BLDESMD,                   /* ICT PTF ENTRY FOR WHICH THE 0393
*                                      ELEMENT IS TO BE BUILT        */
*       BLDESUBE,                   /* SYSMOD IOP SUBENTRY FOR THE 0393
*                                      ELEMENT TO BE BUILT           */
*       BLDICTYP);                  /* ICT MOD ENTRY TYPE TO BE BUILT*/
BLDENTRY STM   @14,@12,@SA00004                                    0393
         MVC   @PC00004(12),0(@01)                                 0393
*   DCL                                                            0394
*     BLDESMD CHAR(LENGTH(ICTPTF)); /* PTF SECT ENTRY                */
*   DCL                                                            0395
*     BLDESUBE CHAR(LENGTH(IOPPNTRY));/* SYSMOD IOP SUBENTRY         */
*   DCL                                                            0396
*     BLDENTRC FIXED(31);           /* LOCAL RETURN CODE             */
*   DCL                                                            0397
*     TMXRETRN FIXED(31);           /* RETURN CODE FROM HMASMTM1, 2 3
*                                      OR 4                          */
*   DCL                                                            0398
*     BLDENT@ PTR(31);              /* POINTS TO MOD SECT ENTRY BEING
*                                      BUILT                         */
*   DCL                                                            0399
*     ENTTYPE FIXED(8);             /* ELEMENT TYPE (IOPPIND VALUES) */
*   DCL                                                            0400
*     ENTNAME CHAR(8);              /* ELEMENT NAME                  */
*   DCL                                                            0401
*     BLDICTYP CHAR(1);             /* ICT TYPE ENTRY                */
*   RESPECIFY                                                      0402
*     ICTPTF BASED(ADDR(BLDESMD));  /* PTF SECT ENTRY PASSED         */
*   BLDENTRC=ZERO;                  /* CLEAR RETURN CODE             */
         SLR   BLDENTRC,BLDENTRC                                   0403
*   TMXRETRN=ZERO;                  /* ASSUME ALL IS WELL            */
         SLR   TMXRETRN,TMXRETRN                                   0404
*   RFY                                                            0405
*     HMASMIOP BASED(ADDR(BLDESUBE)-IOPPTFLN/*                       */
*         -LENGTH(HMASMIOP)+1);     /* ADDRESSABILITY TO THE ELEMENT
*                                      SUB-ENTRY                     */
*   ENTTYPE=IOPPIND(1);             /* SAVE IOP ELEMENT TYPE VALUE   */
         L     @05,@PC00004+4                                      0406
         AH    @05,@CH02664                                        0406
         SLR   ENTTYPE,ENTTYPE                                     0406
         IC    ENTTYPE,IOPPIND(,@05)                               0406
*   ENTNAME=IOPPMODS(1);            /* SAVE IOP ELEMENT NAME         */
         MVC   ENTNAME(8),IOPPMODS(@05)                            0407
*   RFY                                                            0408
*     HMASMIOP BASED;                                              0408
*                                                                  0408
*   /*****************************************************************/
*   /*                                                               */
*   /* GET AND INITIALIZE ICT MOD ENTRY                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0409
*   BLDENT@=TBLXTOP;                /* ADDR OF ENTRY TO BE OBTAINED  */
         L     @05,@PC00001                                        0409
         MVC   BLDENT@(4),TBLXTOP(@05)                             0409
*   CALL HMASMTAD(TBLXPARM,         /* PARM LIST                     */
*       'M',                        /* BUILD MOD SECTION ENTRY       */
*       ENTNAME);                   /* ENTRY NAME                    */
         MVC   @AL00001+4(8),@AL00410                              0410
         ST    @05,@AL00001                                        0410
         L     @15,@CV02021                                        0410
         LA    @01,@AL00001                                        0410
         BALR  @14,@15                                             0410
*   RESPECIFY                                                      0411
*     RTNCODE RSTD;                                                0411
*   BLDENTRC=RTNCODE;               /* SAVE RETURN CODE FROM HMASMTAD*/
         LR    BLDENTRC,RTNCODE                                    0412
*   RESPECIFY                                                      0413
*     RTNCODE UNRSTD;                                              0413
*   IF BLDENTRC<STOPPTF THEN                                       0414
         CH    BLDENTRC,@CH00034                                   0414
         BNL   @RF00414                                            0414
*     DO;                                                          0415
*       RESPECIFY                                                  0416
*         ICTMOD BASED(BLDENT@);    /* ADDRESSIBILITY TO MOD SECT  0416
*                                      ENTRY JUST OBTAINED           */
*                                                                  0416
*       /*************************************************************/
*       /*                                                           */
*       /* CALL THE APPROPRATE PROCESSOR (TM1, TM2, OR TM3 ) TO      */
*       /* COMPLETE THE ICT FROM DATA IN THE (A)CDS ELEMENT ENTRY.   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0417
*       ICTMFLG1(1)=BLDICTYP;       /* SET ICT MOD ENTRY TYPE AS   0417
*                                      PASSED                        */
         L     @05,BLDENT@                                         0417
         L     @02,@PC00004+8                                      0417
         MVC   ICTMFLG1(1,@05),BLDICTYP(@02)                       0417
*       RESPECIFY                                                  0418
*         RTNCODE RSTD;                                            0418
*       IF ICTMMOD(1)=ON&ICTMASM(1)^=ON THEN                       0419
         TM    ICTMMOD(@05),B'10000000'                            0419
         BNO   @RF00419                                            0419
         TM    ICTMASM(@05),B'01000000'                            0419
         BNZ   @RF00419                                            0419
*         DO;                                                      0420
*                                                                  0420
*           /*********************************************************/
*           /*                                                       */
*           /* MOD TYPE ENTRY                                        */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0421
*           CALL HMASMTM1(TBLXPARM, /* PARM LIST                     */
*               BLDENT@,            /* PTR TO MOD SECT ENTRY         */
*               ADDR(ICTPTF(1)),    /* PTR TO PTF SECT ENTRY         */
*               ZERO);              /* NULL MCB PTR                  */
         MVC   @AL00001+4(12),@AL00421                             0421
         L     @14,@PC00001                                        0421
         ST    @14,@AL00001                                        0421
         L     @14,@PC00004                                        0421
         ST    @14,@TF00001                                        0421
         L     @15,@CV02025                                        0421
         LA    @01,@AL00001                                        0421
         BALR  @14,@15                                             0421
*           TMXRETRN=RTNCODE;       /* SAVE RETURN CODE              */
         LR    TMXRETRN,RTNCODE                                    0422
*           CALL MODSRCA(ICTMOD(1));/* CHAIN MOD TO ASSOC. SRC       */
         L     @14,BLDENT@                                         0423
         ST    @14,@AL00001                                        0423
         LA    @01,@AL00001                                        0423
         BAL   @14,MODSRCA                                         0423
*         END;                                                     0424
*       IF ICTMMACR(1)=ON THEN                                     0425
@RF00419 L     @14,BLDENT@                                         0425
         TM    ICTMMACR(@14),B'00001000'                           0425
         BNO   @RF00425                                            0425
*         DO;                                                      0426
*                                                                  0426
*           /*********************************************************/
*           /*                                                       */
*           /* MAC TYPE ENTRY                                        */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0427
*           CALL HMASMTM2(TBLXPARM, /* PARM LIST                     */
*               BLDENT@,            /* PTR TO MOD SECT ENTRY         */
*               ADDR(ICTPTF(1)),    /* PTR TO PTF SECT ENTRY         */
*               ZERO);              /* NULL MCB PTR                  */
         MVC   @AL00001+4(12),@AL00427                             0427
         L     @14,@PC00001                                        0427
         ST    @14,@AL00001                                        0427
         L     @14,@PC00004                                        0427
         ST    @14,@TF00001                                        0427
         L     @15,@CV02026                                        0427
         LA    @01,@AL00001                                        0427
         BALR  @14,@15                                             0427
*           TMXRETRN=RTNCODE;       /* SAVE RETURN CODE              */
         LR    TMXRETRN,RTNCODE                                    0428
*         END;                                                     0429
*       IF ICTMSRCR(1)=ON THEN                                     0430
@RF00425 L     @14,BLDENT@                                         0430
         TM    ICTMSRCR(@14),B'00000010'                           0430
         BNO   @RF00430                                            0430
*         DO;                                                      0431
*                                                                  0431
*           /*********************************************************/
*           /*                                                       */
*           /* SRC TYPE ENTRY                                        */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0432
*           CALL HMASMTM3(TBLXPARM, /* PARM LIST                     */
*               BLDENT@,            /* PTR TO MOD SECT ENTRY         */
*               ADDR(ICTPTF(1)),    /* PTR TO PTF SECT ENTRY         */
*               ZERO);              /* NULL MCB PTR                  */
         MVC   @AL00001+4(12),@AL00432                             0432
         L     @14,@PC00001                                        0432
         ST    @14,@AL00001                                        0432
         L     @14,@PC00004                                        0432
         ST    @14,@TF00001                                        0432
         L     @15,@CV02027                                        0432
         LA    @01,@AL00001                                        0432
         BALR  @14,@15                                             0432
*           TMXRETRN=RTNCODE;       /* SAVE RETURN CODE              */
         LR    TMXRETRN,RTNCODE                                    0433
*           CALL SRCMODA(ICTMOD(1));/* CHAIN SRC TO ASSOC. MOD       */
         L     @14,BLDENT@                                         0434
         ST    @14,@AL00001                                        0434
         LA    @01,@AL00001                                        0434
         BAL   @14,SRCMODA                                         0434
*         END;                                                     0435
*       IF ICTMASM(1)=ON THEN       /* IS TYPE ASSEMBLY?             */
@RF00430 L     @14,BLDENT@                                         0436
         TM    ICTMASM(@14),B'01000000'                            0436
         BNO   @RF00436                                            0436
*         DO;                       /* YES,                          */
*                                                                  0437
*           /*********************************************************/
*           /*                                                       */
*           /* ASSEMBLY TYPE ENTRY                                   */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0438
*           ASMBLDF=ON;             /* INDICATE ASSEMBLY SUB ENTRY 0438
*                                      EXISTS                        */
         OI    ASMBLDF,B'10000000'                                 0438
*           TBLXTOP=TBLXTOP-LENGTH(ICTMOD(1));/* BACK UP ICT ...     */
         L     @14,@PC00001                                        0439
         L     @05,TBLXTOP(,@14)                                   0439
         SH    @05,@CH02665                                        0439
         ST    @05,TBLXTOP(,@14)                                   0439
*           TBLXTOP->ICTMEND(1)=ICTENDNT;/* ... MOD SECTION BY ONE   */
         MVC   ICTMEND(4,@05),ICTENDNT                             0440
*         END;                                                     0441
*       BLDENTRC=MAX(BLDENTRC,TMXRETRN);/* SET RC                    */
@RF00436 CR    BLDENTRC,TMXRETRN                                   0442
         BNL   *+6
         LR    BLDENTRC,TMXRETRN                                   0442
*       RESPECIFY                                                  0443
*         RTNCODE UNRSTD;                                          0443
*     END;                                                         0444
*   ELSE                                                           0445
*     ;                             /* ERROR CREATING ICT MOD SECTION
*                                      ENTRY                         */
@RF00414 DS    0H                                                  0446
*   IF BLDENTRC<STOPSMD             /* ALL IS WELL?                  */
*       &ICTMASM(1)=OFF THEN        /* AND NOT AN ASSEMBLY?          */
         CH    BLDENTRC,@CH00034                                   0446
         BNL   @RF00446                                            0446
         L     @02,BLDENT@                                         0446
         TM    ICTMASM(@02),B'01000000'                            0446
         BNZ   @RF00446                                            0446
*     DO;                           /* YES,                          */
*                                                                  0447
*       /*************************************************************/
*       /*                                                           */
*       /* BUILD ACDS MOD ID LIST AND PROCESS DELETE ELEMENTS        */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0448
*       CALL BLDAMID(ICTMOD(1),     /* BUILD ACDS MOD ID LIST        */
*           CCAIOPTR->HMASMIOP);                                   0448
         ST    @02,@AL00001                                        0448
         L     @02,CCAIOPTR(,CCAPTR)                               0448
         ST    @02,@AL00001+4                                      0448
         LA    @01,@AL00001                                        0448
         BAL   @14,BLDAMID                                         0448
*       RESPECIFY                                                  0449
*         RTNCODE RSTD;                                            0449
*       BLDENTRC=MAX(BLDENTRC,RTNCODE);/* SET RC                     */
         CR    BLDENTRC,RTNCODE                                    0450
         BNL   *+6
         LR    BLDENTRC,RTNCODE                                    0450
*       RESPECIFY                                                  0451
*         RTNCODE UNRSTD;                                          0451
*     END;                                                         0452
*   RETURN CODE(BLDENTRC);          /* RETURN W/ RC                  */
@RF00446 LR    @15,BLDENTRC                                        0453
         L     @14,@SA00004                                        0453
         LM    @00,@12,@SA00004+8                                  0453
         BR    @14                                                 0453
*   RFY                                                            0454
*     ICTPTF BASED;                                                0454
*   RFY                                                            0455
*     ICTMOD BASED;                                                0455
*   RFY                                                            0456
*     HMASMIOP BASED;                                              0456
*   END BLDENTRY;                                                  0457
         EJECT
*                                                                  0458
*   /*****************************************************************/
*   /*                                                               */
*   /* ASMGTA - BUILD GTA FILE RECORD FOR EACH ASSEM ENTRY IN THE    */
*   /* SYSMOD                                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0458
*ASMGTA:                                                           0458
*   PROC(ASMGIOP);                  /*                               */
ASMGTA   STM   @14,@12,@SA00005                                    0458
         MVC   @PC00005(4),0(@01)                                  0458
*   DCL                                                            0459
*     ASMGIOP CHAR(*);              /* SYSMOD IOP FOR WHICH TO BUILD
*                                      GTA FILE                      */
*   DCL                                                            0460
*     ASMGRC FIXED(15);             /* LOCAL RETURN CODE             */
*   DCL                                                            0461
*     ASMGX1 FIXED(31);             /* IOP SUB-ENTRY LOOP COUNTER    */
*   RFY                                                            0462
*     HMASMIOP BASED(ADDR(ASMGIOP));                               0462
*   RFY                                                            0463
*     HMASMGTP BASED(ADDR(ASMGTP));                                0463
*   ASMGRC=''B;                     /* CLEAR LOCAL RETURN CODE       */
         SLR   ASMGRC,ASMGRC                                       0464
*   TM4RCD=''B;                     /* CLEAR THE RECORD              */
*                                                                  0465
         XC    TM4RCD(12),TM4RCD                                   0465
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE THE GTA FILE                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0466
*   GTPFUNCT=GTPFREE;               /* FREE THE FILE                 */
         LA    @03,ASMGTP                                          0466
         MVI   GTPFUNCT(@03),X'0A'                                 0466
*   CALL HMASMGTA(HMASMGTP);        /* ...                           */
         ST    @03,@AL00001                                        0467
         L     @15,@CV02020                                        0467
         LA    @01,@AL00001                                        0467
         BALR  @14,@15                                             0467
*   GTPFUNCT=GTPADD;                /* FUNCTION WILL BE ADD          */
         LA    @03,ASMGTP                                          0468
         MVI   GTPFUNCT(@03),X'04'                                 0468
*   DO ASMGX1=1 BY 1                /* PROCESS ALL IOP SUBENTRIES    */
*         WHILE(IOPPTFND(ASMGX1)^=IOPEOLST/* ...                     */
*         &ASMGRC<STOPFUNC);        /*                               */
         LA    ASMGX1,1                                            0469
         B     @DE00469                                            0469
@DL00469 DS    0H                                                  0470
*     IF IOPPIND(ASMGX1)=IOPPASM THEN/* SUB-ENTRY IS ASSEM TYPE?     */
         LR    @15,ASMGX1                                          0470
         MH    @15,@CH00035                                        0470
         L     @14,@PC00005                                        0470
         SLR   @07,@07                                             0470
         IC    @07,IOPPIND-9(@15,@14)                              0470
         CH    @07,@CH00034                                        0470
         BNE   @RF00470                                            0470
*       DO;                         /* YES,                          */
*         TM4NAME=IOPPMODS(ASMGX1); /* SET ELEMENT NAME IN GTA RECORD*/
         ALR   @14,@15                                             0472
         MVC   TM4NAME(8),IOPPMODS-9(@14)                          0472
*         CALL HMASMGTA(HMASMGTP);  /* ADD TO FILE                   */
         LA    @15,ASMGTP                                          0473
         ST    @15,@AL00001                                        0473
         L     @15,@CV02020                                        0473
         LA    @01,@AL00001                                        0473
         BALR  @14,@15                                             0473
*         ASMGRC=MAX(ASMGRC,GTPRETRN);/* SAVE RETURN CODE            */
         LA    @15,ASMGTP                                          0474
         SLR   @14,@14                                             0474
         IC    @14,GTPRETRN(,@15)                                  0474
         CR    ASMGRC,@14                                          0474
         BNL   *+6
         LR    ASMGRC,@14                                          0474
*       END;                        /*                               */
*     ELSE                                                         0476
*       ;                           /* NOT AN ASSEM ENTRY            */
@RF00470 DS    0H                                                  0477
*   END;                            /* END OF LOOP THRU IOP          */
         AH    ASMGX1,@CH00064                                     0477
@DE00469 LR    @15,ASMGX1                                          0477
         MH    @15,@CH00035                                        0477
         L     @14,@PC00005                                        0477
         SLR   @07,@07                                             0477
         IC    @07,IOPPTFND-9(@15,@14)                             0477
         CH    @07,@CH00707                                        0477
         BE    @DC00469                                            0477
         CH    ASMGRC,@CH00033                                     0477
         BL    @DL00469                                            0477
@DC00469 DS    0H                                                  0478
*   RETURN CODE(ASMGRC);            /*                               */
         LR    @15,ASMGRC                                          0478
         L     @14,@SA00005                                        0478
         LM    @00,@12,@SA00005+8                                  0478
         BR    @14                                                 0478
*   END ASMGTA;                     /*                               */
         EJECT
*                                                                  0480
*/********************************************************************/
*/*                                                                  */
*/*    SRCMODA  - FOR THE ++SRC MOD SECTION ENTRY PASSED, LOOK IN    */
*/*               THE ICT FOR AN ASSOCIATED ++MOD MOD SECTION        */
*/*               ENTRY                                              */
*/*                                                                  */
*/*    CONDITIONS UPON ENTRY:                                        */
*/*                                                                  */
*/*                                                                  */
*/*    CONDITIONS UPON EXIT:                                         */
*/*                                                                  */
*/*     * SET IN ++SRC MOD SECTION ENTRY PASSED:                     */
*/*                                                                  */
*/*     - ICTMASOC - SET IF ASSOCIATED ++MOD MOD SECTION ENTRY FOUND */
*/*                                                                  */
*/*     * SET IN ASSOCIATED ++MOD MOD SECT. ENTRY:                   */
*/*                                                                  */
*/*     - ICTMASOC - ASSOICATED ++SRC ENTRY EXISTS                   */
*/*                                                                  */
*/********************************************************************/
*                                                                  0480
*SRCMODA:                                                          0480
*   PROC(SRCENTRY);                                                0480
SRCMODA  STM   @14,@12,12(@13)                                     0480
         MVC   @PC00006(4),0(@01)                                  0480
*   DCL                                                            0481
*     SRCENTRY CHAR(*);             /* ICT MOD SECT ENTRY FOR ++SRC
*                                      OR ++SRCUPD ELEMENT           */
*   DCL                                                            0482
*     UU FIXED(15);                 /* LOCAL INDEX - MOD SECT ENTRIES*/
*   DCL                                                            0483
*     SRCNAME CHAR(8);              /* SOURCE ELEMENT NAME           */
*   DCL                                                            0484
*     SRCSMD@ PTR(31);              /* PTR TO SYSMOD ASSOC WITH ++SRC*/
*   DCL                                                            0485
*     SRCSPTR PTR(31);              /* PTR TO ++SRC MOD ENTRY PASSED */
*   DCL                                                            0486
*     SRCMPTR PTR(31);              /* PTR TO ASSOC ++MOD ENTRY      */
*   RESPECIFY                                                      0487
*     ICTMOD BASED(ADDR(SRCENTRY)); /* ADDRESS ENTRY PASSED          */
*   ICTMASOC(1)=OFF;                /* CLEAR ASSOC. MOD FLAG         */
         L     @02,@PC00006                                        0488
         NI    ICTMASOC(@02),B'11101111'                           0488
*   SRCNAME=ICTMNAME(1);            /* SRC ELEMENT NAME              */
         MVC   SRCNAME(8),ICTMNAME(@02)                            0489
*   SRCSMD@=ICTPPTR(1);             /* "CURRENT" SYSMOD              */
         L     SRCSMD@,ICTPPTR(,@02)                               0490
*   SRCSPTR=ADDR(SRCENTRY);         /* SAVE ADDR OF ++SRC ENTRY      */
         LR    SRCSPTR,@02                                         0491
*   SRCMPTR=0;                      /* CLEAR PTR TO ASSOC ++MOD      */
*                                                                  0492
         SLR   SRCMPTR,SRCMPTR                                     0492
*   /*****************************************************************/
*   /*                                                               */
*   /* GO THRU ICT MOD SECTION LOOKING FOR ASSOC MOD SECT ENTRY      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0493
*   RESPECIFY                                                      0493
*     ICTMOD BASED(CCAICMOD);       /* ADDRESS ENTIRE MOD SECTION    */
*   DO UU=1 BY 1 WHILE ICTMEND(UU)^=ICTENDNT&SRCMPTR=0;            0494
         LA    UU,1                                                0494
         B     @DE00494                                            0494
@DL00494 DS    0H                                                  0495
*     IF ICTMNAME(UU)=SRCNAME       /* ELEMENT NAMES EQUAL           */
*         &ICTMMOD(UU)=ON           /* MOD ENTRY                     */
*         &ICTMASM(UU)=OFF          /* ... NOT ASSEMBLY ENTRY        */
*         &ICTPPTR(UU)=SRCSMD@      /* "CURRENT" SYSMOD              */
*       THEN                                                       0495
         LR    @15,UU                                              0495
         MH    @15,@CH02665                                        0495
         L     @14,CCAICMOD(,CCAPTR)                               0495
         ST    @15,@TF00001                                        0495
         ALR   @15,@14                                             0495
         AL    @15,@CF02699                                        0495
         CLC   ICTMNAME(8,@15),SRCNAME                             0495
         BNE   @RF00495                                            0495
         LR    @15,@14                                             0495
         AL    @15,@TF00001                                        0495
         AL    @15,@CF02700                                        0495
         TM    ICTMMOD-9(@15),B'10000000'                          0495
         BNO   @RF00495                                            0495
         TM    ICTMASM-9(@15),B'01000000'                          0495
         BNZ   @RF00495                                            0495
         L     @15,@TF00001                                        0495
         AL    @15,@CF02701                                        0495
         C     SRCSMD@,ICTPPTR-96(@15,@14)                         0495
         BNE   @RF00495                                            0495
*       DO;                                                        0496
*                                                                  0496
*         /***********************************************************/
*         /*                                                         */
*         /* ASSOCIATED ++MOD MOD ENTRY FOUND                        */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0497
*         ICTMASOC(UU)=ON;          /* SET ASSOC ++SRC IN ++MOD ENTRY*/
         LR    @15,@14                                             0497
         AL    @15,@TF00001                                        0497
         AL    @15,@CF02702                                        0497
         OI    ICTMASOC-11(@15),B'00010000'                        0497
*         SRCMPTR=ADDR(ICTMOD(UU)); /* POINT TO ++MOD ENTRY FOUND    */
         L     SRCMPTR,@TF00001                                    0498
         AL    @14,@CF02699                                        0498
         LA    SRCMPTR,ICTMOD(SRCMPTR,@14)                         0498
*         SRCSPTR->ICTMASOC(1)=ON;  /* SET ASSOC ++MOD IN ++SRC ENTRY*/
         OI    ICTMASOC(SRCSPTR),B'00010000'                       0499
*       END;                                                       0500
*   END;                                                           0501
@RF00495 AH    UU,@CH00064                                         0501
@DE00494 LR    @15,UU                                              0501
         MH    @15,@CH02665                                        0501
         L     @01,CCAICMOD(,CCAPTR)                               0501
         AL    @01,@CF02699                                        0501
         L     @15,ICTMEND(@15,@01)                                0501
         CL    @15,ICTENDNT                                        0501
         BE    @DC00494                                            0501
         LTR   SRCMPTR,SRCMPTR                                     0501
         BZ    @DL00494                                            0501
@DC00494 DS    0H                                                  0502
*   RETURN;                                                        0502
@EL00006 DS    0H                                                  0502
@EF00006 DS    0H                                                  0502
@ER00006 LM    @14,@12,12(@13)                                     0502
         BR    @14                                                 0502
*   RFY                                                            0503
*     ICTMOD BASED;                                                0503
*   END SRCMODA;                                                   0504
         EJECT
*                                                                  0505
*/********************************************************************/
*/*                                                                  */
*/*    MODSRCA  - FOR THE ++MOD MOD SECTION ENTRY PASSED, LOOK IN    */
*/*               THE ICT FOR AN ASSOCIATED ++SRC MOD SECTION        */
*/*               ENTRY                                              */
*/*                                                                  */
*/*    CONDITIONS UPON ENTRY:                                        */
*/*                                                                  */
*/*                                                                  */
*/*    CONDITIONS UPON EXIT:                                         */
*/*                                                                  */
*/*     * SET IN ++MOD MOD SECTION ENTRY PASSED:                     */
*/*                                                                  */
*/*     - ICTMASOC - SET IF ASSOICATED ++SRC MOD SECT ENTRY FOUND    */
*/*                                                                  */
*/*     * SET IN ++SRC MOD SECTION ENTRY ASSOCIATED WITH ++MOD:      */
*/*                                                                  */
*/*     - ICTMASOC - ASSOCIATED ++MOD MOD SECTION ENTRY EXISTS       */
*/*                                                                  */
*/********************************************************************/
*                                                                  0505
*MODSRCA:                                                          0505
*   PROC(MODENTRY);                                                0505
MODSRCA  STM   @14,@12,12(@13)                                     0505
         MVC   @PC00007(4),0(@01)                                  0505
*   DCL                                                            0506
*     MODENTRY CHAR(*);             /* ICT MOD SECT. ENTRY FOR ++MOD
*                                      ELEMENT                       */
*   DCL                                                            0507
*     TT FIXED(15);                 /* LOCAL INDEX - MOD SECT ENTRIES*/
*   DCL                                                            0508
*     MODNAME CHAR(8);              /* ELEMENT NAME                  */
*   DCL                                                            0509
*     MODSMD@ PTR(31);              /* PTR TO SYSMOD ASSOC WITH ++MOD*/
*   DCL                                                            0510
*     MODMPTR PTR(31);              /* PTR TO ++MOD MOD ENTRY PASSED */
*   DCL                                                            0511
*     MODSPTR PTR(31);              /* PTR TO ++SRC ENTRY FOUND      */
*   RESPECIFY                                                      0512
*     ICTMOD BASED(ADDR(MODENTRY)); /* ADDRESS ENTRY PASSED          */
*   ICTMASOC(1)=OFF;                /* CLEAR ASSOC ++SRC FLAG        */
         L     @02,@PC00007                                        0513
         NI    ICTMASOC(@02),B'11101111'                           0513
*   MODNAME=ICTMNAME(1);            /* MOD ELEMENT NAME              */
         MVC   MODNAME(8),ICTMNAME(@02)                            0514
*   MODSMD@=ICTPPTR(1);             /* "CURRENT" SYSMOD              */
         L     MODSMD@,ICTPPTR(,@02)                               0515
*   MODMPTR=ADDR(MODENTRY);         /* PTR TO ++MOD ENTRY PASSED     */
         LR    MODMPTR,@02                                         0516
*   MODSPTR=0;                      /* PTR TO ++SRC ENTRY FOUND      */
*                                                                  0517
         SLR   MODSPTR,MODSPTR                                     0517
*   /*****************************************************************/
*   /*                                                               */
*   /* GO THRU ICT MOD SECTION LOOKING FOR ASSOC ++SRC MOD SECT ENTRY*/
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0518
*   RESPECIFY                                                      0518
*     ICTMOD BASED(CCAICMOD);       /* ADDRESS ENTIRE MOD SECTION    */
*   DO TT=1 BY 1 WHILE ICTMEND(TT)^=ICTENDNT&MODSPTR=0;            0519
         LA    TT,1                                                0519
         B     @DE00519                                            0519
@DL00519 DS    0H                                                  0520
*     IF ICTMNAME(TT)=MODNAME       /* ELEMENT NAMES EQUAL           */
*         &(ICTMSRCR(TT)=ON         /* ++SRC ENTRY                   */
*         ×ICTMSRCU(TT)=ON)         /* ++SRCUPD ENTRY                */
*         &ICTPPTR(TT)=MODSMD@      /* "CURRENT" SYSMOD              */
*       THEN                                                       0520
         LR    @15,TT                                              0520
         MH    @15,@CH02665                                        0520
         L     @14,CCAICMOD(,CCAPTR)                               0520
         ST    @15,@TF00001                                        0520
         ALR   @15,@14                                             0520
         AL    @15,@CF02699                                        0520
         CLC   ICTMNAME(8,@15),MODNAME                             0520
         BNE   @RF00520                                            0520
         LR    @15,@14                                             0520
         AL    @15,@TF00001                                        0520
         AL    @15,@CF02700                                        0520
         TM    ICTMSRCR-9(@15),B'00000011'                         0520
         BZ    @RF00520                                            0520
         L     @15,@TF00001                                        0520
         AL    @15,@CF02701                                        0520
         C     MODSMD@,ICTPPTR-96(@15,@14)                         0520
         BNE   @RF00520                                            0520
*       DO;                                                        0521
*                                                                  0521
*         /***********************************************************/
*         /*                                                         */
*         /* ASSOCIATED ++SRC OR ++SRCUPD MOD ENTRY FOUND            */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0522
*         ICTMASOC(TT)=ON;          /* SET ASSOC ++MOD IN ++SRC ENTRY*/
         LR    @15,@14                                             0522
         AL    @15,@TF00001                                        0522
         AL    @15,@CF02702                                        0522
         OI    ICTMASOC-11(@15),B'00010000'                        0522
*         MODSPTR=ADDR(ICTMOD(TT)); /* POINT ++SRC ENTRY FOUND       */
         L     MODSPTR,@TF00001                                    0523
         AL    @14,@CF02699                                        0523
         LA    MODSPTR,ICTMOD(MODSPTR,@14)                         0523
*         MODMPTR->ICTMASOC(1)=ON;  /* SET ASSOC ++SRC IN ++MOD ENTRY*/
         OI    ICTMASOC(MODMPTR),B'00010000'                       0524
*       END;                                                       0525
*   END;                                                           0526
@RF00520 AH    TT,@CH00064                                         0526
@DE00519 LR    @15,TT                                              0526
         MH    @15,@CH02665                                        0526
         L     @01,CCAICMOD(,CCAPTR)                               0526
         AL    @01,@CF02699                                        0526
         L     @15,ICTMEND(@15,@01)                                0526
         CL    @15,ICTENDNT                                        0526
         BE    @DC00519                                            0526
         LTR   MODSPTR,MODSPTR                                     0526
         BZ    @DL00519                                            0526
@DC00519 DS    0H                                                  0527
*   RETURN;                                                        0527
@EL00007 DS    0H                                                  0527
@EF00007 DS    0H                                                  0527
@ER00007 LM    @14,@12,12(@13)                                     0527
         BR    @14                                                 0527
*   RFY                                                            0528
*     ICTMOD BASED;                                                0528
*   END MODSRCA;                                                   0529
         EJECT
*                                                                  0530
*/********************************************************************/
*/*                                                                  */
*/* BLDAMID - BUILD ACDS MOD ID LIST FOR AN ELEMENT                  */
*/*                                                                  */
*/* INPUT  - ICT MOD ENTRY PASSED AS A PARAMETER                     */
*/*        - IOP TO BE USED FOR EXTENDED LOCATE OF ACDS MOD ENTRY    */
*/*                                                                  */
*/* OUTPUT - ACDS MOD ID LIST IN THE ICT INDEX AREA                  */
*/*                                                                  */
*/*        - RC                                                      */
*/*           0  - SUCCESSFUL                                        */
*/*           12 - I/O ERROR OR NOT ENOUGH STORAGE FOR INDEX LIST    */
*/*           16 - I/O ERROR                                         */
*/*                                                                  */
*/********************************************************************/
*                                                                  0530
*BLDAMID:                                                          0530
*   PROC(BLDAENT,                   /* ICT MOD ENTRY                 */
*       BLDAIOP);                   /* EXTENDED IOP TO BE USED       */
BLDAMID  STM   @14,@12,@SA00008                                    0530
         MVC   @PC00008(8),0(@01)                                  0530
*   DCL                                                            0531
*     BLDAENT CHAR(*);              /* ICT MOD ENTRY FOR WHICH ID  0531
*                                      LIST TO BE BUILT              */
*   DCL                                                            0532
*     BLDAIOP CHAR(*);              /* IOP FOR THE EXTENDED ELEMENT
*                                      ENTRY                         */
*   DCL                                                            0533
*     BLDARC FIXED(15);             /* LOCAL RETURN CODE             */
*   DCL                                                            0534
*     BLDAIOPT FIXED(8);            /* IOPTYPE CORRESPONDING TO ICT
*                                      ENTRY TYPE                    */
*   DCL                                                            0535
*     BLDADUMM FIXED(8);            /* DUMMY PARM FOR CALL TO CNVTYP1*/
*   DCL                                                            0536
*     BLDAX1 FIXED(31);             /* IOP SUB-ENTRY INDEX COUNTER   */
*   DCL                                                            0537
*     BLDAX2 FIXED(31);             /* ICT MOD ENTRY INDEX COUNTER   */
*   RFY                                                            0538
*     HMASMIOP BASED(ADDR(BLDAIOP));                               0538
*   RFY                                                            0539
*     ICTMOD BASED(ADDR(BLDAENT));                                 0539
*   RFY                                                            0540
*     HMASMGTP BASED(ADDR(ASMGTP));                                0540
*   BLDARC=ZERO;                    /* CLEAR THE LOCAL RETURN CODE   */
         SLR   BLDARC,BLDARC                                       0541
*   CALL CNVTYP1(ICTMOD(1),         /* CONVERT CURRENT MOD ENTRY TYPE
*                                      TO ...                        */
*       BLDAIOPT,                   /* ... THE CORRESPONDING IOPTYPE */
*       BLDADUMM);                  /* ...                           */
         MVC   @AL00001+4(8),@AL00542                              0542
         L     @02,@PC00008                                        0542
         ST    @02,@AL00001                                        0542
         LA    @01,@AL00001                                        0542
         BAL   @14,CNVTYP1                                         0542
*                                                                  0543
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCATE THE ELEMENT ON THE ACDS                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0543
*   IOPDSID=IOPACDS;                /* GET EXTENDED ACDS ...         */
         L     @02,@PC00008+4                                      0543
         MVI   IOPDSID(@02),X'0C'                                  0543
*   IOPFUNCT=IOPLOC;                /* ...                           */
         MVI   IOPFUNCT(@02),X'03'                                 0544
*   IOPTYPE=BLDAIOPT;               /* ... ELEMENT ENTRY ...         */
         MVC   IOPTYPE(1,@02),BLDAIOPT                             0545
*   IOPNAME=ICTMNAME(1);            /* ... FOR THE ICT ENTRY ...     */
         L     @15,@PC00008                                        0546
         MVC   IOPNAME(8,@02),ICTMNAME(@15)                        0546
*   CALL HMASMIO(HMASMIOP);         /* ...                           */
         ST    @02,@AL00001                                        0547
         L     @15,@CV02017                                        0547
         LA    @01,@AL00001                                        0547
         BALR  @14,@15                                             0547
*   IF IOPRETRN>IOPNTFND THEN       /* IO ERROR?                     */
         L     @02,@PC00008+4                                      0548
         CLI   IOPRETRN(@02),4                                     0548
         BNH   @RF00548                                            0548
*     DO;                           /* YES,                          */
*       BLDARC=MAX(BLDARC,IOPRETRN);/* SET THE RETURN CODE           */
         SLR   @15,@15                                             0550
         IC    @15,IOPRETRN(,@02)                                  0550
         CR    BLDARC,@15                                          0550
         BNL   *+6
         LR    BLDARC,@15                                          0550
*     END;                                                         0551
*   IF IOPRETRN=IOPNTFND THEN       /* ELEMENT NOT FOUND ON ACDS?    */
@RF00548 L     @02,@PC00008+4                                      0552
         CLI   IOPRETRN(@02),4                                     0552
         BNE   @RF00552                                            0552
*     DO;                           /* YES,                          */
*                                                                  0553
*       /*************************************************************/
*       /*                                                           */
*       /* THE ELEMENT EXISTS ON THE CDS BUT NOT THE ACDS: IT MUST   */
*       /* HAVE BEEN ADDED TO THE TARGET SYSTEM BY ONE OF THE SYSMODS*/
*       /* BEING RESTORED.                                           */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0554
*       IF ICTMASM(1)^=ON THEN      /* NOT AN ASSEM ELEMENT?         */
         L     @02,@PC00008                                        0554
         TM    ICTMASM(@02),B'01000000'                            0554
         BO    @RF00554                                            0554
*         DO;                       /* YES,                          */
*           ICTMIDEL(1)=ON;         /* DELETE THE ELEMENT            */
         OI    ICTMIDEL(@02),B'01000000'                           0556
*           ICTFMLIB(1)=BLANKS;     /* CLEAR FROM LIB DD NAME        */
         MVC   ICTFMLIB(8,@02),@CC02075                            0557
*         END;                      /*                               */
*       ELSE                                                       0559
*         ;                         /* ELEMENT IS AN ASSEMBLY        */
@RF00554 DS    0H                                                  0560
*     END;                                                         0560
*   IF BLDARC=ZERO                  /* ALL IS WELL?                  */
*       &IOPRETRN^=IOPNTFND THEN                                   0561
@RF00552 LTR   BLDARC,BLDARC                                       0561
         BNZ   @RF00561                                            0561
         L     @02,@PC00008+4                                      0561
         CLI   IOPRETRN(@02),4                                     0561
         BE    @RF00561                                            0561
*     DO;                           /* YES,                          */
*                                                                  0562
*       /*************************************************************/
*       /*                                                           */
*       /* CALL HMASMTID TO BUILD THE MOD ID LIST                    */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0563
*       CALL HMASMTID(TBLXPARM,     /* TBLX PARM                     */
*           ADDR(ICTMOD(1)),        /* PTR TO ICT MOD ENTRY          */
*           ICTMICHA(1),            /* PTR TO ACDS MOD ID LIST       */
*           HMASMIOP);              /* IOP W/ EXTENDED ACDS IOP ENTRY*/
         L     @15,@PC00001                                        0563
         ST    @15,@AL00001                                        0563
         L     @15,@PC00008                                        0563
         ST    @15,@TF00001                                        0563
         LA    @14,@TF00001                                        0563
         ST    @14,@AL00001+4                                      0563
         LA    @15,ICTMICHA(,@15)                                  0563
         ST    @15,@AL00001+8                                      0563
         ST    @02,@AL00001+12                                     0563
         L     @15,@CV02023                                        0563
         LA    @01,@AL00001                                        0563
         BALR  @14,@15                                             0563
*       RFY                                                        0564
*         RTNCODE RSTD;                                            0564
*       BLDARC=MAX(BLDARC,RTNCODE); /* SAVE RETURN CODE              */
         CR    BLDARC,RTNCODE                                      0565
         BNL   *+6
         LR    BLDARC,RTNCODE                                      0565
*       RFY                                                        0566
*         RTNCODE UNRSTD;                                          0566
*       ICTMFMID(1)=IOPFMID;        /* FMID IS ACDS FMID             */
         L     @02,@PC00008                                        0567
         L     @15,@PC00008+4                                      0567
         MVC   ICTMFMID(7,@02),IOPFMID(@15)                        0567
*       ICTMRMID(1)=IOPRMID;        /* RMID IS ACDS RMID             */
         MVC   ICTMRMID(7,@02),IOPRMID(@15)                        0568
*       ICTMDSTL(1)=IOPMCDLB;       /* DISTLIB FROM THE ACDS         */
         MVC   ICTMDSTL(8,@02),IOPMCDLB(@15)                       0569
*       ICTFMLIB(1)=IOPMCDLB;       /* FROM LIB IS DISTLIB           */
         MVC   ICTFMLIB(8,@02),IOPMCDLB(@15)                       0570
*       ICTMTCHN(1)=TBLXNULL;       /* DISREGARD CDS ALIAS LIST      */
         L     @15,@PC00001                                        0571
         MVC   ICTMTCHN(4,@02),TBLXNULL(@15)                       0571
*       DO BLDAX1=1 BY 1            /* SEARCH ALL SUB-ENTRIES FOR  0572
*                                      ALIASES                       */
*             WHILE(IOPMACND(BLDAX1)^=IOPEOLST);                   0572
         LA    BLDAX1,1                                            0572
         B     @DE00572                                            0572
@DL00572 DS    0H                                                  0573
*         IF IOPMCTYP(BLDAX1)=IOPMCMAL THEN/* ALIAS ENTRY?           */
         LR    @05,BLDAX1                                          0573
         MH    @05,@CH00035                                        0573
         L     @02,@PC00008+4                                      0573
         SLR   @15,@15                                             0573
         IC    @15,IOPMCTYP-9(@05,@02)                             0573
         CH    @15,@CH00273                                        0573
         BNE   @RF00573                                            0573
*           DO;                     /* YES,                          */
*             CALL HMASMTAI(TBLXPARM,/* ADD ALIAS TO INDEX LIST      */
*                 ICTMTCHN(1),      /* ...                           */
*                 ADDR(IOPMCDTA(BLDAX1)),/* ...                      */
*                 LENGTH(ICTTALLS));/* ...                           */
         L     @15,@PC00001                                        0575
         ST    @15,@AL00001                                        0575
         L     @15,@PC00008                                        0575
         LA    @15,ICTMTCHN(,@15)                                  0575
         ST    @15,@AL00001+4                                      0575
         LA    @05,IOPMCDTA-9(@05,@02)                             0575
         ST    @05,@TF00001                                        0575
         LA    @05,@TF00001                                        0575
         ST    @05,@AL00001+8                                      0575
         LA    @05,@CF00034                                        0575
         ST    @05,@AL00001+12                                     0575
         L     @15,@CV02022                                        0575
         LA    @01,@AL00001                                        0575
         BALR  @14,@15                                             0575
*             RESPECIFY                                            0576
*               RTNCODE RSTD;                                      0576
*             BLDARC=MAX(BLDARC,RTNCODE);/* SAVE RETURN CODE FROM TAI*/
         CR    BLDARC,RTNCODE                                      0577
         BNL   *+6
         LR    BLDARC,RTNCODE                                      0577
*             RESPECIFY                                            0578
*               RTNCODE UNRSTD;                                    0578
*           END;                                                   0579
*         ELSE                                                     0580
*           ;                       /* NOT AN ALIAS, SO SKIP IT      */
@RF00573 DS    0H                                                  0581
*       END;                        /*                               */
         AH    BLDAX1,@CH00064                                     0581
@DE00572 LR    @05,BLDAX1                                          0581
         MH    @05,@CH00035                                        0581
         L     @02,@PC00008+4                                      0581
         SLR   @15,@15                                             0581
         IC    @15,IOPMACND-9(@05,@02)                             0581
         CH    @15,@CH00707                                        0581
         BNE   @DL00572                                            0581
*     END;                                                         0582
*                                                                  0582
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESS ANY ASSEM ENTRIES ADDED AS A RESULT OF A MACRO OR SRC */
*   /* THIS CONSISTS OF DELETING ASSEM NAMES FROM GTA FILE THAT WILL */
*   /* BE PASSED TO TM4 TO COMPLETE PROCESSING OF EACH SYSMOD        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0583
*   DO BLDAX2=2 BY 1                /* PROCESS ALL MOD ENTRIES ...   */
*         WHILE(ICTMEND(BLDAX2)^=ICTENDNT/* CREATED FOR THIS         */
*         &BLDARC<STOPSMD);         /* ELEMENT                       */
@RF00561 LA    BLDAX2,2                                            0583
         B     @DE00583                                            0583
@DL00583 DS    0H                                                  0584
*     IF ICTMASM(BLDAX2)=ON THEN    /* ASSEM ENTRY?                  */
         LR    @05,BLDAX2                                          0584
         MH    @05,@CH02665                                        0584
         L     @02,@PC00008                                        0584
         ST    @05,@TF00001                                        0584
         ALR   @05,@02                                             0584
         AL    @05,@CF02700                                        0584
         TM    ICTMASM-9(@05),B'01000000'                          0584
         BNO   @RF00584                                            0584
*       DO;                         /*                               */
*         IF ICTMIDEL(1)=ON         /* IS SOURCE BEING DELETED?      */
*             &ICTMSRCR(1)=ON THEN  /* ...                           */
         TM    ICTMIDEL(@02),B'01000000'                           0586
         BNO   @RF00586                                            0586
         TM    ICTMSRCR(@02),B'00000010'                           0586
         BNO   @RF00586                                            0586
*           DO;                     /* YES,                          */
*             ICTMIDEL(BLDAX2)=ON;  /* THE DELETE MODULE             */
         AL    @02,@TF00001                                        0588
         AL    @02,@CF02702                                        0588
         OI    ICTMIDEL-11(@02),B'01000000'                        0588
*           END;                                                   0589
*         TM4NAME=ICTMNAME(BLDAX2); /* DELETE CORRESPONDING ...      */
@RF00586 LR    @05,BLDAX2                                          0590
         MH    @05,@CH02665                                        0590
         L     @02,@PC00008                                        0590
         ALR   @02,@05                                             0590
         AL    @02,@CF02699                                        0590
         MVC   TM4NAME(8),ICTMNAME(@02)                            0590
*         GTPFUNCT=GTPDEL;          /* ... ASSEM GTA RECORD SO THAT
*                                      IT ...                        */
         LA    @05,ASMGTP                                          0591
         MVI   GTPFUNCT(@05),X'05'                                 0591
*         CALL HMASMGTA(HMASMGTP);  /* ... IS NOT PROCESSED          */
         ST    @05,@AL00001                                        0592
         L     @15,@CV02020                                        0592
         LA    @01,@AL00001                                        0592
         BALR  @14,@15                                             0592
*         RESPECIFY                                                0593
*           RTNCODE RSTD;                                          0593
*         BLDARC=MAX(BLDARC,RTNCODE);/* SAVE RETURN CODE FROM GTA    */
         CR    BLDARC,RTNCODE                                      0594
         BNL   *+6
         LR    BLDARC,RTNCODE                                      0594
*         RESPECIFY                                                0595
*           RTNCODE UNRSTD;                                        0595
*       END;                                                       0596
*     ELSE                                                         0597
*       ;                           /* NOT AN ASSEM ENTRY            */
@RF00584 DS    0H                                                  0598
*   END;                            /*                               */
         AH    BLDAX2,@CH00064                                     0598
@DE00583 LR    @05,BLDAX2                                          0598
         MH    @05,@CH02665                                        0598
         L     @02,@PC00008                                        0598
         AL    @02,@CF02699                                        0598
         L     @05,ICTMEND(@05,@02)                                0598
         CL    @05,ICTENDNT                                        0598
         BE    @DC00583                                            0598
         CH    BLDARC,@CH00034                                     0598
         BL    @DL00583                                            0598
@DC00583 DS    0H                                                  0599
*   RETURN CODE(BLDARC);            /* RETURN W/ RC                  */
         LR    @15,BLDARC                                          0599
         L     @14,@SA00008                                        0599
         LM    @00,@12,@SA00008+8                                  0599
         BR    @14                                                 0599
*   RFY                                                            0600
*     HMASMIOP BASED;                                              0600
*   RFY                                                            0601
*     ICTMOD BASED;                                                0601
*   RFY                                                            0602
*     HMASMGTP BASED;                                              0602
*   END BLDAMID;                                                   0603
         EJECT
*                                                                  0604
*/********************************************************************/
*/*                                                                  */
*/* MODCHAIN - BUILD PTF TO MOD CHAIN                                */
*/*                                                                  */
*/* INPUT  - ICT PTF ENTRY PASSED AS A PARAMETER                     */
*/*        - ICT MOD SECTION AS POINTED TO BY THE CCA                */
*/*                                                                  */
*/* OUTPUT - PTF TO MOD CHAIN BUILT FOR THE SPECIFIED ICT PTF ENTRY  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0604
*MODCHAIN:                                                         0604
*   PROC(MODCSMD);                                                 0604
MODCHAIN STM   @14,@12,@SA00009                                    0604
         MVC   @PC00009(4),0(@01)                                  0604
*   DCL                                                            0605
*     MODCSMD CHAR(*);              /* ICT PTF ENTRY REPRESENTING  0605
*                                      SYSMOD TO BE PROCESSED        */
*   DCL                                                            0606
*     MODCRC FIXED(31);             /* MAX RETURN CODE PARAMETER     */
*   DCL                                                            0607
*     JM FIXED(15);                 /* INDEX - MOD SECT ENTRIES      */
*   DCL                                                            0608
*     MODADDR PTR(31);              /* ADDR OF ICT MOD SECT ENTRY    */
*   MODCRC=ZERO;                    /* INITIALIZE RETURN CODE        */
         SLR   MODCRC,MODCRC                                       0609
*   RESPECIFY                                                      0610
*     ICTPTF BASED(ADDR(MODCSMD));  /* PTF ENTRY PASSED              */
*   RESPECIFY                                                      0611
*     ICTMOD BASED(CCAICMOD);                                      0611
*                                                                  0611
*   /*****************************************************************/
*   /*                                                               */
*   /* GO THRU ICT MOD SECTION                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0612
*   DO JM=1 BY 1 WHILE ICTMEND(JM)^=ICTENDNT/* NOT AT MOD SECT END   */
*         &MODCRC<STOPFUNC;         /* NOT TERMINATING               */
         LA    JM,1                                                0612
         B     @DE00612                                            0612
@DL00612 DS    0H                                                  0613
*     IF ICTPPTR(JM)=ADDR(ICTPTF(1))/* ELEMENT FROM "CURRENT" SYSMOD */
*       THEN                                                       0613
         LR    @05,JM                                              0613
         MH    @05,@CH02665                                        0613
         L     @02,CCAICMOD(,CCAPTR)                               0613
         L     @15,@PC00009                                        0613
         LA    @01,0(@05,@02)                                      0613
         AL    @01,@CF02701                                        0613
         C     @15,ICTPPTR-96(,@01)                                0613
         BNE   @RF00613                                            0613
*       DO;                                                        0614
*                                                                  0614
*         /***********************************************************/
*         /*                                                         */
*         /* PUT ADDRESS OF MOD SECT ENTRY INTO PTF SECTION ENTRY    */
*         /* LIST (ICTIXP)                                           */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0615
*         MODADDR=ADDR(ICTMOD(JM)); /* ICT MOD SECT ENTRY ADDRESS    */
         AL    @02,@CF02699                                        0615
         LA    @05,ICTMOD(@05,@02)                                 0615
         ST    @05,MODADDR                                         0615
*         CALL HMASMTAI(TBLXPARM,   /*                               */
*             ICTPCHN(1),           /* MOD SECT POINTER LIST         */
*             ADDR(MODADDR),        /* ADDR OF MOD SECT ENTRY ADDR   */
*             LENGTH(ICTIXP));      /* LENGTH OF ENTRY IN LIST       */
         L     @05,@PC00001                                        0616
         ST    @05,@AL00001                                        0616
         LA    @05,ICTPCHN(,@15)                                   0616
         ST    @05,@AL00001+4                                      0616
         LA    @05,MODADDR                                         0616
         ST    @05,@TF00001                                        0616
         LA    @05,@TF00001                                        0616
         ST    @05,@AL00001+8                                      0616
         LA    @05,@CF00039                                        0616
         ST    @05,@AL00001+12                                     0616
         L     @15,@CV02022                                        0616
         LA    @01,@AL00001                                        0616
         BALR  @14,@15                                             0616
*         RESPECIFY                                                0617
*           RTNCODE RSTD;                                          0617
*         MODCRC=MAX(MODCRC,RTNCODE);/* SAVE RETURN CODE FROM TAI    */
         CR    MODCRC,RTNCODE                                      0618
         BNL   *+6
         LR    MODCRC,RTNCODE                                      0618
*         RESPECIFY                                                0619
*           RTNCODE UNRSTD;                                        0619
*       END;                                                       0620
*   END;                                                           0621
@RF00613 AH    JM,@CH00064                                         0621
@DE00612 LR    @05,JM                                              0621
         MH    @05,@CH02665                                        0621
         L     @02,CCAICMOD(,CCAPTR)                               0621
         AL    @02,@CF02699                                        0621
         L     @05,ICTMEND(@05,@02)                                0621
         CL    @05,ICTENDNT                                        0621
         BE    @DC00612                                            0621
         CH    MODCRC,@CH00033                                     0621
         BL    @DL00612                                            0621
@DC00612 DS    0H                                                  0622
*   RETURN CODE(MODCRC);            /* RETURN W/ RC                  */
         LR    @15,MODCRC                                          0622
         L     @14,@SA00009                                        0622
         LM    @00,@12,@SA00009+8                                  0622
         BR    @14                                                 0622
*   RESPECIFY                                                      0623
*     ICTPTF BASED;                                                0623
*   RESPECIFY                                                      0624
*     ICTMOD BASED;                                                0624
*   END MODCHAIN;                                                  0625
*   END GETMOD;                                                    0626
         EJECT
*                                                                  0627
*/********************************************************************/
*/*                                                                  */
*/* XRFSETUP - CREATE SELECT GTA FILE TO BE USED AS INPUT TO HMASMXRF*/
*/*                                                                  */
*/* INPUT  - MOD SECTION OF THE ICT                                  */
*/*                                                                  */
*/* OUTPUT - SELECT GTA FILE TO BE USED AS INPUT TO HMASMXRF         */
*/*        - RETURN CODES                                            */
*/*          0 - OK                                                  */
*/*          12- GTA RETURN FOR NO STORAGE                           */
*/*          16- GTA RETURN CODE                                     */
*/*                                                                  */
*/****************************************************************   */
*                                                                  0627
*XRFSETUP:                                                         0627
*   PROC;                                                          0627
XRFSETUP STM   @14,@12,@SA00010                                    0627
*   DCL                                                            0628
*     XRFSRC FIXED(15);             /* LOCAL RETURN CODE             */
*   DCL                                                            0629
*     XRFSMODX FIXED(31);           /* ICT PTF ENTRY INDEX           */
*   RFY                                                            0630
*     ICTMOD BASED(CCAICMOD);                                      0630
*   RFY                                                            0631
*     ICTPTF BASED(ICTPPTR(XRFSMODX));                             0631
*   RFY                                                            0632
*     HMASMGTP BASED(ADDR(MSELGTP));                               0632
*   RFY                                                            0633
*     HMASMSET BASED(ADDR(MSELBUF));                               0633
         EJECT
*   XRFSRC=ZERO;                    /* CLEAR LOCAL RETURN CODE       */
         SLR   XRFSRC,XRFSRC                                       0634
*   GTPBUFAD=ADDR(MSELBUF);         /* ELEMENT SELECT LIST BUFFER    */
         LA    @02,MSELGTP                                         0635
         LA    @15,MSELBUF                                         0635
         ST    @15,GTPBUFAD(,@02)                                  0635
*   GTPFUNCT=GTPADD;                /* INITIALIZE SELECT GTP         */
         MVI   GTPFUNCT(@02),X'04'                                 0636
*   GTPRCDLN=LENGTH(HMASMSET);      /* ...                           */
         MVC   GTPRCDLN(2,@02),@CH00033                            0637
*   GTPKEYLN=LENGTH(SELSTENT);      /* ...                           */
         MVC   GTPKEYLN(2,@02),@CH00036                            0638
*   GTPBUFAD=ADDR(HMASMSET);        /* ...                           */
         ST    @15,GTPBUFAD(,@02)                                  0639
*   DO XRFSMODX=1 BY 1              /* ADD ALL MOD ENTRIES TO THE GTA
*                                      FILE                          */
*         WHILE(ICTMEND(XRFSMODX)^=ICTENDNT/*                        */
*         &XRFSRC<STOPFUNC);                                       0640
         LA    XRFSMODX,1                                          0640
         B     @DE00640                                            0640
@DL00640 DS    0H                                                  0641
*     IF ICTMNOGO(XRFSMODX)=OFF     /* NOT NOGO?                     */
*         &ICTPNOGO(1)=OFF THEN     /* NOT NOGO?                     */
         LR    @15,XRFSMODX                                        0641
         MH    @15,@CH02665                                        0641
         L     @14,CCAICMOD(,CCAPTR)                               0641
         ST    @15,@TF00001                                        0641
         ALR   @15,@14                                             0641
         AL    @15,@CF02704                                        0641
         TM    ICTMNOGO-8(@15),B'01000000'                         0641
         BNZ   @RF00641                                            0641
         L     @15,@TF00001                                        0641
         AL    @15,@CF02701                                        0641
         L     @01,ICTPPTR-96(@15,@14)                             0641
         TM    ICTPNOGO(@01),B'01000000'                           0641
         BNZ   @RF00641                                            0641
*       DO;                         /* YES,                          */
*         HMASMSET=''B;             /* CLEAR SELECT LIST RECORD      */
         LA    @15,MSELBUF                                         0643
         XC    HMASMSET(12,@15),HMASMSET(@15)                      0643
*         SESELECT=ON;              /* SET SELECT FLAG               */
         OI    SESELECT(@15),B'01000000'                           0644
*         SENAME=ICTMNAME(XRFSMODX);/* SET ELEMENT NAME              */
         LR    @01,@14                                             0645
         AL    @01,@TF00001                                        0645
         AL    @01,@CF02699                                        0645
         MVC   SENAME(8,@15),ICTMNAME(@01)                         0645
*         CALL CNVTYP2(ICTMOD(XRFSMODX),/* CONVERT ICT MOD TYPE ...  */
*             SELSTFLG);            /* ... SELECT LIST TYPE          */
         L     @01,@TF00001                                        0646
         AL    @14,@CF02699                                        0646
         LA    @14,ICTMOD(@01,@14)                                 0646
         ST    @14,@AL00001                                        0646
         ST    @15,@AL00001+4                                      0646
         LA    @01,@AL00001                                        0646
         BAL   @14,CNVTYP2                                         0646
*         CALL HMASMGTA(HMASMGTP);  /* ADD ELEMENT TO SELECT LIST    */
         LA    @15,MSELGTP                                         0647
         ST    @15,@AL00001                                        0647
         L     @15,@CV02020                                        0647
         LA    @01,@AL00001                                        0647
         BALR  @14,@15                                             0647
*         XRFSRC=MAX(XRFSRC,GTPRETRN);/* SET RC                      */
         LA    @15,MSELGTP                                         0648
         SLR   @14,@14                                             0648
         IC    @14,GTPRETRN(,@15)                                  0648
         CR    XRFSRC,@14                                          0648
         BNL   *+6
         LR    XRFSRC,@14                                          0648
*       END;                                                       0649
*     ELSE                                                         0650
*       ;                           /* MOD ENTRY IS NOGO             */
@RF00641 DS    0H                                                  0651
*   END;                            /* END OF PROCESSING ALL MOD   0651
*                                      ENTRIES                       */
         AH    XRFSMODX,@CH00064                                   0651
@DE00640 LR    @15,XRFSMODX                                        0651
         MH    @15,@CH02665                                        0651
         L     @01,CCAICMOD(,CCAPTR)                               0651
         AL    @01,@CF02699                                        0651
         L     @15,ICTMEND(@15,@01)                                0651
         CL    @15,ICTENDNT                                        0651
         BE    @DC00640                                            0651
         CH    XRFSRC,@CH00033                                     0651
         BL    @DL00640                                            0651
@DC00640 DS    0H                                                  0652
*   RETURN CODE(XRFSRC);            /* RETURN W/RC SET               */
         LR    @15,XRFSRC                                          0652
         L     @14,@SA00010                                        0652
         LM    @00,@12,@SA00010+8                                  0652
         BR    @14                                                 0652
*   RFY                                                            0653
*     ICTMOD BASED;                                                0653
*   RFY                                                            0654
*     ICTPTF BASED;                                                0654
*   RFY                                                            0655
*     HMASMGTP BASED;                                              0655
*   RFY                                                            0656
*     HMASMSET BASED;                                              0656
*   END XRFSETUP;                                                  0657
         EJECT
*                                                                  0658
*/****************************************************************   */
*/*                                                                  */
*/* CHKXRF -                                                         */
*/*                                                                  */
*/* INPUT  - XRF OUTPUT GTA FILE                                     */
*/*        - ICT MOD SECTION                                         */
*/*                                                                  */
*/* OUTPUT - MESSAGE IF AN ERROR IS DETECTED.                        */
*/*                                                                  */
*/*                                                                  */
*/*                                                                  */
*/****************************************************************   */
*                                                                  0658
*CHKXRF:                                                           0658
*   PROC;                                                          0658
CHKXRF   STM   @14,@12,@SA00011                                    0658
*   DCL                                                            0659
*     CHKXRC FIXED(15);             /* LOCAL RETURN CODE             */
*   DCL                                                            0660
*     CHKXMODX FIXED(31);           /* MOD SECTION INDEX COUNTER     */
*   DCL                                                            0661
*     TYPEIOP CHAR(1);              /* ENTRY TYPE IN IOPTYPE FORMAT  */
*   DCL                                                            0662
*     TYPEXRF CHAR(1);              /* ENTRY TYPE IN XRF FORMAT      */
*   DCL                                                            0663
*     1 CHKXFLGS,                   /* LOCAL CONTROL FLAGS           */
*      2 ENDMOD BIT(1),             /* END OF MOD RECORDS IN THE GTA
*                                      FILE                          */
*      2 * BIT(7);                  /* UNUSED                        */
*   RFY                                                            0664
*     ICTMOD BASED(CCAICMOD);                                      0664
*   RFY                                                            0665
*     HMASMGTP BASED(ADDR(MXOUTGTP));                              0665
*   CHKXRC=ZERO;                    /* CLEAR LOCAL RETURN CODE       */
         SLR   CHKXRC,CHKXRC                                       0666
*   CHKXFLGS=''B;                   /* CLEAR LOCAL FLAGS             */
         MVI   CHKXFLGS,X'00'                                      0667
*   GTPBUFAD=ADDR(XRFRCD);          /* INITIALIZE XRF GTP            */
         LA    @05,MXOUTGTP                                        0668
         LA    @15,XRFRCD                                          0668
         ST    @15,GTPBUFAD(,@05)                                  0668
*   GTPKEYLN=LENGTH(XRFETYPE)       /* ...                           */
*       +LENGTH(XRFENAME)+LENGTH(XRFRTYPE);/*                        */
*                                                                  0669
         MVC   GTPKEYLN(2,@05),@CH00036                            0669
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESS EACH ICT MOD ENTRY BY PROCESSING ALL XRF RECORDS FOR  */
*   /* THE ENTRY IN THE GTA FILE                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0670
*   DO CHKXMODX=1 BY 1              /* PROCESS ALL MOD ENTRIES       */
*         WHILE(ICTMEND(CHKXMODX)^=ICTENDNT/*                        */
*         &CHKXRC<STOPFUNC);                                       0670
*                                                                  0670
         LA    CHKXMODX,1                                          0670
         B     @DE00670                                            0670
@DL00670 DS    0H                                                  0671
*     /***************************************************************/
*     /*                                                             */
*     /* INITIALIZE AND POSITION TO 1ST XRF RECORD FOR CURRENT MOD   */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0671
*     CALL CNVTYP1(ICTMOD(CHKXMODX),/* CONVERT ICT TYPE TO IOPTYPE   */
*         TYPEIOP,TYPEXRF);                                        0671
         MVC   @AL00001+4(8),@AL00671                              0671
         LR    @05,CHKXMODX                                        0671
         MH    @05,@CH02665                                        0671
         L     @02,CCAICMOD(,CCAPTR)                               0671
         AL    @02,@CF02699                                        0671
         LA    @05,ICTMOD(@05,@02)                                 0671
         ST    @05,@AL00001                                        0671
         LA    @01,@AL00001                                        0671
         BAL   @14,CNVTYP1                                         0671
*     XRFRCD=''B;                   /* CLEAR RECORD                  */
         XC    XRFRCD(30),XRFRCD                                   0672
*     XRFETYPE=TYPEIOP;             /* SET TYPE ...                  */
         MVC   XRFETYPE(1),TYPEIOP                                 0673
*     XRFENAME=ICTMNAME(CHKXMODX);  /* ... AND NAME                  */
         LR    @05,CHKXMODX                                        0674
         MH    @05,@CH02665                                        0674
         L     @02,CCAICMOD(,CCAPTR)                               0674
         ALR   @02,@05                                             0674
         AL    @02,@CF02699                                        0674
         MVC   XRFENAME(8),ICTMNAME(@02)                           0674
*     XRFRTYPE=TYPEXRF;             /* XRF PTF BY TYPE               */
         MVC   XRFRTYPE(1),TYPEXRF                                 0675
*     GTPFUNCT=GTPLOC;              /* LOCATE ...                    */
         LA    @05,MXOUTGTP                                        0676
         MVI   GTPFUNCT(@05),X'03'                                 0676
*     CALL HMASMGTA(HMASMGTP);      /* ... FIRST RECORD FOR MOD      */
         ST    @05,@AL00001                                        0677
         L     @15,@CV02020                                        0677
         LA    @01,@AL00001                                        0677
         BALR  @14,@15                                             0677
*     GTPFUNCT=GTPSTRTN;            /* POSITION ...                  */
         LA    @05,MXOUTGTP                                        0678
         MVI   GTPFUNCT(@05),X'06'                                 0678
*     CALL HMASMGTA(HMASMGTP);      /* ... FOR GET NEXT              */
         ST    @05,@AL00001                                        0679
         L     @15,@CV02020                                        0679
         LA    @01,@AL00001                                        0679
         BALR  @14,@15                                             0679
*     GTPFUNCT=GTPGETN;             /* SET FUNCTION FOR GET NEXT     */
         LA    @05,MXOUTGTP                                        0680
         MVI   GTPFUNCT(@05),X'08'                                 0680
*     ENDMOD=OFF;                   /* CLEAR END OF MOD FLAG         */
*                                                                  0681
         NI    ENDMOD,B'01111111'                                  0681
*     /***************************************************************/
*     /*                                                             */
*     /* PROCESS ALL XRF RECORDS FOR THE CURRENT MOD                 */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0682
*     DO WHILE(ENDMOD=OFF);         /* PROCESS ALL RECORDS FOR A MOD
*                                      ENTRY                         */
         B     @DE00682                                            0682
@DL00682 DS    0H                                                  0683
*       CALL HMASMGTA(HMASMGTP);    /* GET THE NEXT RECORD           */
         LA    @05,MXOUTGTP                                        0683
         ST    @05,@AL00001                                        0683
         L     @15,@CV02020                                        0683
         LA    @01,@AL00001                                        0683
         BALR  @14,@15                                             0683
*       IF GTPRETRN=GTPEOF THEN     /* END OF FILE ON GTA?           */
         LA    @05,MXOUTGTP                                        0684
         CLI   GTPRETRN(@05),4                                     0684
         BNE   @RF00684                                            0684
*         DO;                       /* YES,                          */
*           ENDMOD=ON;              /* END OF CURRENT MOD RECORDS IN
*                                      GTA                           */
         OI    ENDMOD,B'10000000'                                  0686
*         END;                                                     0687
*       ELSE                        /* NOT EOF                       */
*         DO;                                                      0688
         B     @RC00684                                            0688
@RF00684 DS    0H                                                  0689
*           IF XRFETYPE^=TYPEIOP    /* RECORD NOT FOR CURRENT MOD  0689
*                                      ENTRY?                        */
*               ×XRFENAME^=ICTMNAME(CHKXMODX)/* ...                  */
*               ×XRFRTYPE^=TYPEXRF THEN/* ...                        */
         CLC   XRFETYPE(1),TYPEIOP                                 0689
         BNE   @RT00689                                            0689
         LR    @05,CHKXMODX                                        0689
         MH    @05,@CH02665                                        0689
         L     @02,CCAICMOD(,CCAPTR)                               0689
         ALR   @02,@05                                             0689
         AL    @02,@CF02699                                        0689
         CLC   XRFENAME(8),ICTMNAME(@02)                           0689
         BNE   @RT00689                                            0689
         CLC   XRFRTYPE(1),TYPEXRF                                 0689
         BE    @RF00689                                            0689
@RT00689 DS    0H                                                  0690
*             DO;                   /* YES,                          */
*               ENDMOD=ON;          /* END OF CURRENT MOD RECORDS IN
*                                      GTA                           */
         OI    ENDMOD,B'10000000'                                  0691
*             END;                                                 0692
*           ELSE                    /* NOT END OF RECORDS FOR      0693
*                                      CURRRENT MOD                  */
*             DO;                                                  0693
*                                                                  0693
         B     @RC00689                                            0693
@RF00689 DS    0H                                                  0694
*               /*****************************************************/
*               /*                                                   */
*               /* CHECK TO INSURE THAT THE REFERENCED SYSMOD IS IN  */
*               /* ICT AND OK OR ON THE ACDS                         */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0694
*               CALL CHK1XRCD(TBLXIOPF->HMASMIOP);/*                 */
         L     @05,@PC00001                                        0694
         L     @05,TBLXIOPF(,@05)                                  0694
         ST    @05,@AL00001                                        0694
         LA    @01,@AL00001                                        0694
         BAL   @14,CHK1XRCD                                        0694
*               RFY                                                0695
*                 RTNCODE RSTD;                                    0695
*               CHKXRC=MAX(CHKXRC,RTNCODE);                        0696
         CR    CHKXRC,RTNCODE                                      0696
         BNL   *+6
         LR    CHKXRC,RTNCODE                                      0696
*               RFY                                                0697
*                 RTNCODE UNRSTD;                                  0697
*             END;                                                 0698
*         END;                                                     0699
@RC00689 DS    0H                                                  0700
*     END;                          /* END OF PROCESSING GTA RECORDS
*                                      FOR A MOD ENTRY               */
@RC00684 DS    0H                                                  0700
@DE00682 TM    ENDMOD,B'10000000'                                  0700
         BZ    @DL00682                                            0700
*   END;                            /* END PROCESS ALL MOD ENTRIES 0701
*                                      LOOP                          */
         AH    CHKXMODX,@CH00064                                   0701
@DE00670 LR    @05,CHKXMODX                                        0701
         MH    @05,@CH02665                                        0701
         L     @02,CCAICMOD(,CCAPTR)                               0701
         AL    @02,@CF02699                                        0701
         L     @05,ICTMEND(@05,@02)                                0701
         CL    @05,ICTENDNT                                        0701
         BE    @DC00670                                            0701
         CH    CHKXRC,@CH00033                                     0701
         BL    @DL00670                                            0701
@DC00670 DS    0H                                                  0702
*   RETURN CODE(CHKXRC);            /* RETURN W/RC SET               */
         LR    @15,CHKXRC                                          0702
         L     @14,@SA00011                                        0702
         LM    @00,@12,@SA00011+8                                  0702
         BR    @14                                                 0702
*   RFY                                                            0703
*     ICTMOD BASED;                                                0703
*   RFY                                                            0704
*     HMASMGTP BASED;                                              0704
         EJECT
*                                                                  0705
*/********************************************************************/
*/*                                                                  */
*/* CHK1XRCD - CHECK SYSMOD THAT REFERENCES AN ELEMENT IN THE ICT    */
*/*       IF THE SYSMOD IS IN THE ICT OR IN THE ELEMENT MODID LIST   */
*/*       WE ASSUME ALL IS WELL.  ANY ERROR WILL BE DIAGNOSED BY     */
*/*       SUBSEQUENT PROCESSING.                                     */
*/*                                                                  */
*/* INPUT   - FIXED LENGTH IOP                                       */
*/*         - XRF RECORD FOR AN ELEMENT, SYSMOD RELATIONSHIP         */
*/*                                                                  */
*/* OUTPUT                                                           */
*/*                                                                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0705
*CHK1XRCD:                                                         0705
*   PROC(CK1IOP);                   /* FIXED LENGTH IOP TO BE USED   */
CHK1XRCD STM   @14,@12,@SA00012                                    0705
         MVC   @PC00012(4),0(@01)                                  0705
*   DCL                                                            0706
*     CK1IOP CHAR(*);               /* FIXED IOP                     */
*   DCL                                                            0707
*     CK1XRC FIXED(15);             /* LOCAL RETURN CODE             */
*   DCL                                                            0708
*     1 CK1XFLGS,                   /* LOCAL CONTROL FLAGS           */
*      2 CK1XOK BIT(1),             /* SET WHEN IT IS DETERMINED THAT
*                                      THE REFERENCING SYSMOD IS IN A
*                                      STATE THAT WILL NOT CAUSE   0708
*                                      TERMINATION OF THE ELEMENT    */
*      2 CK1XERR BIT(1),            /* SYSMOD IS IN ERROR ON THE CDS */
*      2 CK1XIFND BIT(1),           /* SYSMOD FOUND IN MOD ID LIST   */
*      2 CK1XRERR BIT(1),           /* SYSMOD IN ERROR AND RESTORE   */
*      2 CK1XAERR BIT(1),           /* SYSMOD IN ERROR AND APPLY     */
*      2 * BIT(3);                  /* UNUSED                        */
*   DCL                                                            0709
*     CK1XITYP FIXED(8);            /* MOD ENTRY SEARCH INDEX COUNTER*/
*   DCL                                                            0710
*     CK1XX1 FIXED(31);             /* MOD ENTRY SEARCH INDEX COUNTER*/
*   DCL                                                            0711
*     CK1XX2 FIXED(31);             /* MOD ID LIST SEARCH INDEX    0711
*                                      COUNTER                       */
*   DCL                                                            0712
*     CK1XIOPT FIXED(8);            /* IOPTYPE RETURNED BY CONVERSION
*                                      ROUTINE                       */
*   DCL                                                            0713
*     CK1XDUMM FIXED(8);            /* DUMMY PARM FOR COVERSION    0713
*                                      ROUTINE                       */
*   RFY                                                            0714
*     HMASMIOP BASED(ADDR(CK1IOP));                                0714
*   RFY                                                            0715
*     ICTMOD BASED(CCAICMOD);                                      0715
*   RFY                                                            0716
*     ICTMIDLS BASED(ICTMICHN(CK1XX1));                            0716
*   RFY                                                            0717
*     TSLPARMS BASED(TBLXTSLP);                                    0717
         EJECT
*   CK1XRC=ZERO;                    /* CLEAR LOCAL RETURN CODE       */
         SLR   CK1XRC,CK1XRC                                       0718
*   CK1XFLGS=''B;                   /* CLEAR LOCAL CONTROL FLAGS     */
         MVI   CK1XFLGS,X'00'                                      0719
*   IOPPTFF1=XRF3STAT;              /* PUT XRF RECORD STATUS DATA IN
*                                      THE IOP SO THAT THE FLAGS CAN
*                                      BE REFERENCED AS MAPPED IN THE
*                                      IOP                           */
*                                                                  0720
         L     @02,@PC00012                                        0720
         MVC   IOPPTFF1(1,@02),XRF3STAT                            0720
*   /*****************************************************************/
*   /*                                                               */
*   /* SET FLAGS BASED ON ERROR STATUS                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0721
*   IF IOPERROR=ON THEN             /* IS REFERENCING SYSMOD 'IN   0721
*                                      ERROR' ON CDS?                */
         TM    IOPERROR(@02),B'00010000'                           0721
         BNO   @RF00721                                            0721
*     DO;                           /* YES,                          */
*       IF IOPRES=ON THEN           /* RESTORE ERROR SYSMOD?         */
         TM    IOPRES(@02),B'01000000'                             0723
         BNO   @RF00723                                            0723
*         DO;                       /* YES,                          */
*           CK1XRERR=ON;            /* RESTORE ERROR, SYSMOD MUST BE
*                                      IN ICT OR THIS IS AN ERROR    */
         OI    CK1XRERR,B'00010000'                                0725
*         END;                                                     0726
*       ELSE                        /* NOT A RESTORE ERROR, THEN   0727
*                                      APPLY ERROR                   */
*         DO;                                                      0727
         B     @RC00723                                            0727
@RF00723 DS    0H                                                  0728
*           CK1XAERR=ON;            /* INDICATE SYSMOD IS IN ERROR 0728
*                                      THE SYSMOD CAN BE IGNORED IF
*                                      IT IS NOT ON THE ACDS EVEN IF
*                                      IT APPEARS IN THE MODID LIST  */
         OI    CK1XAERR,B'00001000'                                0728
*         END;                                                     0729
*     END;                                                         0730
*   ELSE                                                           0731
*     ;                             /* NOT IN ERROR                  */
@RF00721 DS    0H                                                  0732
*                                                                  0732
*   /*****************************************************************/
*   /*                                                               */
*   /* SEARCH FOR SYSMOD IN THE ICT (I.E. BEING RESTORED). IF SO, ALL*/
*   /* IS WELL                                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0732
*   TSLICTSR=''B;                   /* CLEAR TSB PARM LIST           */
@RC00721 L     @02,@PC00001                                        0732
         L     @02,TBLXTSLP(,@02)                                  0732
         L     @15,TSLPMLAD(,@02)                                  0732
         XC    TSLICTSR(14,@15),TSLICTSR(@15)                      0732
*   TSLFUNCT=TSLFISRH;              /* SEARCH THE ICT PTF SECTION ...*/
         MVI   TSLFUNCT(@02),X'01'                                 0733
*   TSLISMD=XRF3PTF;                /* ... FOR SYSMOD THAT REFERENCES
*                                      THE MOD                       */
         MVC   TSLISMD(7,@15),XRF3PTF                              0734
*   CALL HMASMTSB(TSLPARMS);        /* ...                           */
         ST    @02,@AL00001                                        0735
         L     @15,@CV02024                                        0735
         LA    @01,@AL00001                                        0735
         BALR  @14,@15                                             0735
*   IF TSLRETRN=TSLGOOD THEN        /* IN THE ICT PTF SECTION?       */
         L     @02,@PC00001                                        0736
         L     @02,TBLXTSLP(,@02)                                  0736
         CLI   TSLRETRN(@02),0                                     0736
         BNE   @RF00736                                            0736
*     DO;                           /* YES,                          */
*       CK1XOK=ON;                  /* THE SYSMOD IS OK BECAUSE ANY
*                                      CHECKING/ERROR PROCESSING WILL
*                                      BE DONE BECAUSE THE SYSMOD  0738
*                                      ENTRY HAS A MOD ENTRY       0738
*                                      CORRESPONDING TO THE XRFED ONE*/
         OI    CK1XOK,B'10000000'                                  0738
*     END;                                                         0739
*   ELSE                            /* REFERENCED SYSMOD IS NOT IN 0740
*                                      THE ICT                       */
*     DO;                                                          0740
*                                                                  0740
         B     @RC00736                                            0740
@RF00736 DS    0H                                                  0741
*       /*************************************************************/
*       /*                                                           */
*       /* IF SYSMOD IS IN THE MODID LIST THEN IT CAN SAFELY BE      */
*       /* IGNORED SINCE MODID CHECKING WILL CATCH ANY ERRORS        */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0741
*       CALL CNVTYP3(XRF3PIND,      /* IOPPIND ELEMENT TYPE FROM   0741
*                                      SYSMOD                        */
*           CK1XITYP);              /* ICTMFLG1 ICT MOD TYPE         */
*                                                                  0741
         LA    @01,@AL00741                                        0741
         BAL   @14,CNVTYP3                                         0741
*       /*************************************************************/
*       /*                                                           */
*       /* SEARCH ICT MOD SECTION FOR MATCHING ENTRY                 */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0742
*       DO CK1XX1=1 BY 1            /* SEARCH ALL MOD ENTRIES IN THE
*                                      ICT                           */
*             WHILE(ICTMEND(CK1XX1)^=ICTENDNT/* ...                  */
*             &CK1XRC<STOPFUNC      /* ... AND NO SERIOUS ERROR ...  */
*             &CK1XIFND=OFF);       /* ... UNTIL A MATCH IS FOUND    */
         LA    CK1XX1,1                                            0742
         B     @DE00742                                            0742
@DL00742 DS    0H                                                  0743
*         IF ICTMFLG1(CK1XX1)=CK1XITYP/* MATCH ELEMENT?              */
*             &ICTMNAME(CK1XX1)=XRF3MOD/* ...                        */
*             &ICTMISEL(CK1XX1)=ON THEN/* AND IS SELECTED ?          */
         LR    @15,CK1XX1                                          0743
         MH    @15,@CH02665                                        0743
         L     @14,CCAICMOD(,CCAPTR)                               0743
         LA    @01,0(@15,@14)                                      0743
         AL    @01,@CF02700                                        0743
         SLR   @00,@00                                             0743
         IC    @00,ICTMFLG1-9(,@01)                                0743
         SLR   @01,@01                                             0743
         IC    @01,CK1XITYP                                        0743
         CR    @00,@01                                             0743
         BNE   @RF00743                                            0743
         ST    @15,@TF00001                                        0743
         ALR   @15,@14                                             0743
         AL    @15,@CF02699                                        0743
         CLC   ICTMNAME(8,@15),XRF3MOD                             0743
         BNE   @RF00743                                            0743
         LR    @15,@14                                             0743
         AL    @15,@TF00001                                        0743
         AL    @15,@CF02702                                        0743
         TM    ICTMISEL-11(@15),B'10000000'                        0743
         BNO   @RF00743                                            0743
*           DO;                     /* YES,                          */
*                                                                  0744
*             /*******************************************************/
*             /*                                                     */
*             /* CONVERT ICT ELEMENT TYPE TO IOP TYPE INCASE A       */
*             /* MESSAGE IS NEEDED                                   */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0745
*             CALL CNVTYP1(ICTMOD(CK1XX1),/* ICT TYPE FLAGS          */
*                 CK1XIOPT,         /* IOP CDS ENTRY TYPE            */
*                 CK1XDUMM);        /* NOT USED                      */
         MVC   @AL00001+4(8),@AL00745                              0745
         L     @15,@TF00001                                        0745
         AL    @14,@CF02699                                        0745
         LA    @15,ICTMOD(@15,@14)                                 0745
         ST    @15,@AL00001                                        0745
         LA    @01,@AL00001                                        0745
         BAL   @14,CNVTYP1                                         0745
*             CK1XIFND=ON;          /* SIGNAL END OF SEARCH          */
*                                                                  0746
         OI    CK1XIFND,B'00100000'                                0746
*             /*******************************************************/
*             /*                                                     */
*             /* SEARCH FOR SYSMOD IN MODID LIST                     */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0747
*             DO CK1XX2=1 BY 1      /* SEARCH THE CDS MODID LIST FOR
*                                      A MATCH                       */
*                   WHILE(ICTMIDND(CK1XX2)^=ICTENDIX/* ...           */
*                   &CK1XOK=OFF);   /* ...                           */
         LA    CK1XX2,1                                            0747
         B     @DE00747                                            0747
@DL00747 DS    0H                                                  0748
*               IF ICTMODID(CK1XX2)=XRF3PTF THEN/* SYSMOD IN ID LIST?*/
         LR    @05,CK1XX2                                          0748
         SLA   @05,3                                               0748
         LR    @15,CK1XX1                                          0748
         MH    @15,@CH02665                                        0748
         L     @01,CCAICMOD(,CCAPTR)                               0748
         AL    @01,@CF02707                                        0748
         L     @01,ICTMICHN-104(@15,@01)                           0748
         ALR   @01,@05                                             0748
         AL    @01,@CF02695                                        0748
         CLC   ICTMODID(7,@01),XRF3PTF                             0748
         BNE   @RF00748                                            0748
*                 DO;               /* YES,                          */
*                   CK1XOK=ON;      /* THE SYSMOD REFERENCE IS OK AT
*                                      THIS POINT IN PROCESSING SINCE
*                                      ANY ERRORS WILL BE FOUND BY 0750
*                                      MOD ID CHECKING LATTER ON     */
         OI    CK1XOK,B'10000000'                                  0750
*                 END;                                             0751
*             END;                  /* END MODID LIST SEARCH         */
@RF00748 AH    CK1XX2,@CH00064                                     0752
@DE00747 LR    @05,CK1XX2                                          0752
         SLA   @05,3                                               0752
         LR    @15,CK1XX1                                          0752
         MH    @15,@CH02665                                        0752
         L     @01,CCAICMOD(,CCAPTR)                               0752
         AL    @01,@CF02707                                        0752
         L     @01,ICTMICHN-104(@15,@01)                           0752
         AL    @01,@CF02695                                        0752
         L     @05,ICTMIDND(@05,@01)                               0752
         CL    @05,ICTENDIX                                        0752
         BE    @DC00747                                            0752
         TM    CK1XOK,B'10000000'                                  0752
         BZ    @DL00747                                            0752
@DC00747 DS    0H                                                  0753
*             IF CK1XOK=OFF THEN    /* SYSMOD REFERENCE TO ELEMENT 0753
*                                      NOT YET VALIDATED?            */
         TM    CK1XOK,B'10000000'                                  0753
         BNZ   @RF00753                                            0753
*               DO;                 /* YES,                          */
*                 IOPDSID=IOPCDS;   /* BLDL FOR SYSMOD ON CDS        */
         L     @15,@PC00012                                        0755
         MVI   IOPDSID(@15),X'02'                                  0755
*                 IOPNAM17=XRF3PTF; /* ...                           */
         MVC   IOPNAM17(7,@15),XRF3PTF                             0756
*                 IOPTYPE=IOPSMD;   /* ...                           */
         MVI   IOPTYPE(@15),X'0B'                                  0757
*                 IOPFUNCT=IOPBLDL; /* ...                           */
         MVI   IOPFUNCT(@15),X'04'                                 0758
*                 CALL HMASMIO(HMASMIOP);/* ...                      */
         ST    @15,@AL00001                                        0759
         L     @15,@CV02017                                        0759
         LA    @01,@AL00001                                        0759
         BALR  @14,@15                                             0759
*                 IF IOPRETRN=IOPGOOD THEN/* SYSMOD FOUND?           */
         L     @15,@PC00012                                        0760
         CLI   IOPRETRN(@15),0                                     0760
         BNE   @RF00760                                            0760
*                   DO;             /* YES,                          */
*                     IF IOPSBYP=ON THEN/* IS SYSMOD SUP'ED?         */
         TM    IOPSBYP(@15),B'10000000'                            0762
         BNO   @RF00762                                            0762
*                       DO;         /* YES,                          */
*                         CK1XOK=ON;/* MARK AS CHECKING COMPLETED SO
*                                      THAT CHECKING IS BYPASSED FOR
*                                      SUP'ED SYSMODS                */
         OI    CK1XOK,B'10000000'                                  0764
*                       END;        /*                               */
*                     ELSE                                         0766
*                       ;           /* NOT SUP'ED, SO CONTINUE CHECKS*/
@RF00762 DS    0H                                                  0767
*                   END;            /*                               */
*                 ELSE              /* NOT FOUND OR ERROR            */
*                   DO;                                            0768
         B     @RC00760                                            0768
@RF00760 DS    0H                                                  0769
*                     IF IOPRETRN>IOPNTFND THEN/* ERROR?             */
         L     @15,@PC00012                                        0769
         CLI   IOPRETRN(@15),4                                     0769
         BNH   @RF00769                                            0769
*                       DO;         /*                               */
*                         CK1XRC=MAX(CK1XRC,IOPRETRN);/* SET RC      */
         SLR   @14,@14                                             0771
         IC    @14,IOPRETRN(,@15)                                  0771
         CR    CK1XRC,@14                                          0771
         BNL   *+6
         LR    CK1XRC,@14                                          0771
*                       END;                                       0772
*                     ELSE                                         0773
*                       ;           /* NOT AN ERROR I.E. NOT FOUND   */
@RF00769 DS    0H                                                  0774
*                   END;                                           0774
*               END;                /*                               */
*                                                                  0775
@RC00760 DS    0H                                                  0776
*             /*******************************************************/
*             /*                                                     */
*             /* ACDS MODID LIST IF NOT FOUND, CHECK ACDS - MUST BE  */
*             /* NOT PRESSENT IF CK1XERR OR ACCEPTED IF OK           */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0776
*             IF CK1XOK=OFF THEN    /* SYSMOD REFERENCE TO ELEMENT 0776
*                                      NOT YET VALIDATED?            */
@RF00753 TM    CK1XOK,B'10000000'                                  0776
         BNZ   @RF00776                                            0776
*               DO;                 /* YES,                          */
*                 IOPDSID=IOPACDS;  /* BLDL FOR SYSMOD ON ACDS       */
         L     @15,@PC00012                                        0778
         MVI   IOPDSID(@15),X'0C'                                  0778
*                 IOPNAM17=XRF3PTF; /* ...                           */
         MVC   IOPNAM17(7,@15),XRF3PTF                             0779
*                 IOPTYPE=IOPSMD;   /* ...                           */
         MVI   IOPTYPE(@15),X'0B'                                  0780
*                 IOPFUNCT=IOPBLDL; /* ...                           */
         MVI   IOPFUNCT(@15),X'04'                                 0781
*                 CALL HMASMIO(HMASMIOP);/* ...                      */
         ST    @15,@AL00001                                        0782
         L     @15,@CV02017                                        0782
         LA    @01,@AL00001                                        0782
         BALR  @14,@15                                             0782
*                 IF IOPRETRN=IOPGOOD THEN/* SYSMOD FOUND?           */
         L     @15,@PC00012                                        0783
         CLI   IOPRETRN(@15),0                                     0783
         BNE   @RF00783                                            0783
*                   DO;             /* YES,                          */
*                     IF IOPERROR=OFF/* SYSMOD NOT IN ERROR ...      */
*                         &IOPDBYP=OFF/* ... AND NOT DELETED         */
*                       THEN                                       0785
         TM    IOPERROR(@15),B'00010000'                           0785
         BNZ   @RF00785                                            0785
         TM    IOPDBYP(@15),B'01000000'                            0785
         BNZ   @RF00785                                            0785
*                       DO;         /* YES,                          */
*                         CK1XOK=ON;/*                               */
         OI    CK1XOK,B'10000000'                                  0787
*                       END;                                       0788
*                     ELSE          /* IN ERROR OR DELETED           */
*                       DO;                                        0789
         B     @RC00785                                            0789
@RF00785 DS    0H                                                  0790
*                         IF IOPERROR=ON THEN/*                      */
         L     @15,@PC00012                                        0790
         TM    IOPERROR(@15),B'00010000'                           0790
         BNO   @RF00790                                            0790
*                           DO;     /* YES,                          */
*                                                                  0791
*                             /***************************************/
*                             /*                                     */
*                             /* HMA429I XXXXXXXX XXXXXXXX FOR SYSMOD*/
*                             /* XXXXXXX IS ALSO IN SYSMOD XXXXXXX   */
*                             /* WHICH IS ... IN ERROR AND NOT BEING */
*                             /* RESTORED                            */
*                             /*                                     */
*                             /***************************************/
*                                                                  0792
*                             DO;   /* HMASMPMG M1(HMA429I)M2(PART123
*                                      )VAR(CCATYPEA(CK1XIOPT),ICTMNA
*                                      ME(CK1XX1),ICTPPTR(CK1XX1)->IC
*                                      TPTFS(1),XRF3PTF)TYPE(ERR)TARG
*                                      ET(SYSOUT,LOG)                */
*                               HMASMMGP=HMASMMGP&&HMASMMGP;/* SET 0793
*                                      PARMS TO ZEROS                */
         XC    HMASMMGP(32),HMASMMGP                               0793
*                               MGPMGNO1=HMA429I;/* SET UP MSG 1 CODE*/
         MVC   MGPMGNO1(2),@CH02037                                0794
*                               MGPMGNO2=PART123;/* SET UP MSG 2 CODE*/
         MVC   MGPMGNO2(2),@CH02047                                0795
*                               MGPTYPE=MGPERR;/* SET MESSAGE TYPE   */
         MVI   MGPTYPE,X'03'                                       0796
*                               MGPPRINT='1'B;/* SET TARGET FLAG     */
*                               MGPHLDS='1'B;/* SET TARGET FLAG      */
         OI    MGPPRINT,B'10010000'                                0798
*                               MGPVARPT(1)=ADDR(CCATYPEA(CK1XIOPT));
         SLR   @15,@15                                             0799
         IC    @15,CK1XIOPT                                        0799
         SLA   @15,3                                               0799
         L     @01,CCATPAD(,CCAPTR)                                0799
         AL    @01,@CF02695                                        0799
         LA    @15,CCATYPEA(@15,@01)                               0799
         ST    @15,MGPVARPT                                        0799
*                                   /* SET VARIABLE PTR              */
*                               MGPVARPT(2)=ADDR(ICTMNAME(CK1XX1));/*
*                                      SET VARIABLE PTR              */
         LR    @15,CK1XX1                                          0800
         MH    @15,@CH02665                                        0800
         L     @14,CCAICMOD(,CCAPTR)                               0800
         LA    @01,0(@15,@14)                                      0800
         AL    @01,@CF02699                                        0800
         ST    @01,MGPVARPT+4                                      0800
*                               MGPVARPT(3)=ADDR(ICTPPTR(CK1XX1)-> 0801
*                                   ICTPTFS(1));/* SET VARIABLE PTR  */
         AL    @14,@CF02701                                        0801
         L     @01,ICTPPTR-96(@15,@14)                             0801
         ST    @01,MGPVARPT+8                                      0801
*                               MGPVARPT(4)=ADDR(XRF3PTF);/* SET   0802
*                                      VARIABLE PTR                  */
         LA    @15,XRF3PTF                                         0802
         ST    @15,MGPVARPT+12                                     0802
*                               CALL HMASMMSG(HMASMMGP);/* HAVE    0803
*                                      MESSAGE ISSUED                */
         L     @15,@CV02018                                        0803
         LA    @01,@AL00803                                        0803
         BALR  @14,@15                                             0803
*                             END;                                 0804
*                             ICTPPTR(CK1XX1)->ICTPNOGO(1)=ON;/* MARK
*                                      THE SYSMOD NOGO               */
         LR    @15,CK1XX1                                          0805
         MH    @15,@CH02665                                        0805
         L     @01,CCAICMOD(,CCAPTR)                               0805
         AL    @01,@CF02701                                        0805
         L     @01,ICTPPTR-96(@15,@01)                             0805
         OI    ICTPNOGO(@01),B'01000000'                           0805
*                           END;                                   0806
*                         ELSE      /* NOT ERROR                     */
*                           DO;                                    0807
         B     @RC00790                                            0807
@RF00790 DS    0H                                                  0808
*                           END;                                   0808
*                       END;                                       0809
*                   END;                                           0810
*                 ELSE              /* NOT FOUND OR ERROR            */
*                   DO;                                            0811
         B     @RC00783                                            0811
@RF00783 DS    0H                                                  0812
*                     IF IOPRETRN>IOPNTFND THEN/* OTHER THAN NOT   0812
*                                      FOUND                         */
         L     @15,@PC00012                                        0812
         CLI   IOPRETRN(@15),4                                     0812
         BNH   @RF00812                                            0812
*                       DO;         /* YES,                          */
*                         CK1XRC=MAX(CK1XRC,IOPRETRN);/* SAVE RC     */
         SLR   @14,@14                                             0814
         IC    @14,IOPRETRN(,@15)                                  0814
         CR    CK1XRC,@14                                          0814
         BNL   *+6
         LR    CK1XRC,@14                                          0814
*                       END;                                       0815
*                     ELSE          /* NOT FOUND                     */
*                       DO;                                        0816
*                                                                  0816
         B     @RC00812                                            0816
@RF00812 DS    0H                                                  0817
*                         /*******************************************/
*                         /*                                         */
*                         /* HMA429I XXXXXXXX XXXXXXXX FOR SYSMOD    */
*                         /* XXXXXXX IS ALSO IN SYSMOD XXXXXXX WHICH */
*                         /* IS ... APPLIED BUT NOT ACCEPTED         */
*                         /*                                         */
*                         /*******************************************/
*                                                                  0817
*                         DO;       /* HMASMPMG M1(HMA429I)M2(PART124
*                                      )VAR(CCATYPEA(CK1XIOPT),ICTMNA
*                                      ME(CK1XX1),ICTPPTR(CK1XX1)->IC
*                                      TPTFS(1),XRF3PTF)TYPE(ERR)TARG
*                                      ET(SYSOUT,LOG)                */
*                           HMASMMGP=HMASMMGP&&HMASMMGP;/* SET PARMS
*                                      TO ZEROS                      */
         XC    HMASMMGP(32),HMASMMGP                               0818
*                           MGPMGNO1=HMA429I;/* SET UP MSG 1 CODE    */
         MVC   MGPMGNO1(2),@CH02037                                0819
*                           MGPMGNO2=PART124;/* SET UP MSG 2 CODE    */
         MVC   MGPMGNO2(2),@CH02049                                0820
*                           MGPTYPE=MGPERR;/* SET MESSAGE TYPE       */
         MVI   MGPTYPE,X'03'                                       0821
*                           MGPPRINT='1'B;/* SET TARGET FLAG         */
*                           MGPHLDS='1'B;/* SET TARGET FLAG          */
         OI    MGPPRINT,B'10010000'                                0823
*                           MGPVARPT(1)=ADDR(CCATYPEA(CK1XIOPT));/*
*                                      SET VARIABLE PTR              */
         SLR   @15,@15                                             0824
         IC    @15,CK1XIOPT                                        0824
         SLA   @15,3                                               0824
         L     @01,CCATPAD(,CCAPTR)                                0824
         AL    @01,@CF02695                                        0824
         LA    @15,CCATYPEA(@15,@01)                               0824
         ST    @15,MGPVARPT                                        0824
*                           MGPVARPT(2)=ADDR(ICTMNAME(CK1XX1));/* SET
*                                      VARIABLE PTR                  */
         LR    @15,CK1XX1                                          0825
         MH    @15,@CH02665                                        0825
         L     @14,CCAICMOD(,CCAPTR)                               0825
         LA    @01,0(@15,@14)                                      0825
         AL    @01,@CF02699                                        0825
         ST    @01,MGPVARPT+4                                      0825
*                           MGPVARPT(3)=ADDR(ICTPPTR(CK1XX1)->ICTPTFS(1
*                               )); /* SET VARIABLE PTR              */
         AL    @14,@CF02701                                        0826
         L     @01,ICTPPTR-96(@15,@14)                             0826
         ST    @01,MGPVARPT+8                                      0826
*                           MGPVARPT(4)=ADDR(XRF3PTF);/* SET VARIABLE
*                                      PTR                           */
         LA    @15,XRF3PTF                                         0827
         ST    @15,MGPVARPT+12                                     0827
*                           CALL HMASMMSG(HMASMMGP);/* HAVE MESSAGE
*                                      ISSUED                        */
         L     @15,@CV02018                                        0828
         LA    @01,@AL00828                                        0828
         BALR  @14,@15                                             0828
*                         END;                                     0829
*                         ICTPPTR(CK1XX1)->ICTPNOGO(1)=ON;/* MARK THE
*                                      SYSMOD NOGO                   */
         LR    @15,CK1XX1                                          0830
         MH    @15,@CH02665                                        0830
         L     @01,CCAICMOD(,CCAPTR)                               0830
         AL    @01,@CF02701                                        0830
         L     @01,ICTPPTR-96(@15,@01)                             0830
         OI    ICTPNOGO(@01),B'01000000'                           0830
*                       END;                                       0831
*                   END;                                           0832
*               END;                                               0833
*                                                                  0833
*             /*******************************************************/
*             /*                                                     */
*             /* COULD ALSO CHECK DELTA 2 LIST BUT ...               */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0834
*           END;                                                   0834
*         ELSE                                                     0835
*           ;                       /* NOT A MATCH, SO SKIP TO NEXT  */
@RF00743 DS    0H                                                  0836
*       END;                        /* END OF MOD ENTRY SEARCH       */
@RC00743 AH    CK1XX1,@CH00064                                     0836
@DE00742 LR    @15,CK1XX1                                          0836
         MH    @15,@CH02665                                        0836
         L     @01,CCAICMOD(,CCAPTR)                               0836
         AL    @01,@CF02699                                        0836
         L     @15,ICTMEND(@15,@01)                                0836
         CL    @15,ICTENDNT                                        0836
         BE    @DC00742                                            0836
         CH    CK1XRC,@CH00033                                     0836
         BNL   @DC00742                                            0836
         TM    CK1XIFND,B'00100000'                                0836
         BZ    @DL00742                                            0836
@DC00742 DS    0H                                                  0837
*     END;                          /* END SYSMOD ^ IN ICT PROCESSING*/
*   RETURN CODE(CK1XRC);            /* RETURN W/RC SET               */
@RC00736 LR    @15,CK1XRC                                          0838
         L     @14,@SA00012                                        0838
         LM    @00,@12,@SA00012+8                                  0838
         BR    @14                                                 0838
*   END CHK1XRCD;                                                  0839
*   RFY                                                            0840
*     HMASMIOP BASED;                                              0840
*   RFY                                                            0841
*     ICTMOD BASED;                                                0841
*   RFY                                                            0842
*     ICTMIDLS BASED;                                              0842
*   RFY                                                            0843
*     TSLPARMS BASED;                                              0843
*   END CHKXRF;                                                    0844
         EJECT
*                                                                  0845
*/****************************************************************   */
*/*                                                                  */
*/* SELMOD -                                                         */
*/*                                                                  */
*/* INPUT  - ICT MOD SECTION                                         */
*/*                                                                  */
*/* OUTPUT - ICTMSELM SET FOR SELECTED ELEMENTS                      */
*/*                                                                  */
*/*                                                                  */
*/*                                                                  */
*/*                                                                  */
*/****************************************************************   */
*                                                                  0845
*SELMOD:                                                           0845
*   PROC;                                                          0845
*                                                                  0845
SELMOD   STM   @14,@12,@SA00013                                    0845
*   /*****************************************************************/
*   /*                                                               */
*   /* THE SLECTED ELEMENT WILL BE THE ELEMENT FROM THE SYSMOD IN THE*/
*   /* CDS MODID LIST THAT HAS THE HIGHEXT ORDER NUMBER (ICTPONUM).  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0846
*   DCL                                                            0846
*     SELMRC FIXED(15);             /* LOCAL RETURN CODE             */
*   DCL                                                            0847
*     SELMNAME CHAR(LENGTH(ICTMNAME))/* NAME OF CURRENT ELEMENT FOR
*                                      WHICH SELECTION IS BEING    0847
*                                      PERFORMED                     */
*         BASED(ADDR(ICTMNAME(SELMX1)));                           0847
*   DCL                                                            0848
*     SELMTYPE BIT(8)               /* TYPE OF CURRENT ELEMENT FOR 0848
*                                      WHICH SELECTION IS BEING    0848
*                                      PERFORMED                     */
*         BASED(ADDR(ICTMFLG1(SELMX1)));                           0848
*   DCL                                                            0849
*     SELMONUM FIXED(16);           /* ORDER NUMBER FOR SELECTED   0849
*                                      ELEMENT                       */
*   DCL                                                            0850
*     SELMO#2 FIXED(16);            /* HIGHEST ORDER NUMBER FOR AN 0850
*                                      ELEMENT                       */
*   DCL                                                            0851
*     SELMPTR1 PTR(31);             /* ADDR OF SELECTED ELEMENT      */
*   DCL                                                            0852
*     SELMPTR2 PTR(31);             /* ADDR OF ELEMENT W/ HIGHEST  0852
*                                      ORDER NUMBER                  */
*   DCL                                                            0853
*     SELMX1 FIXED(31);             /* CURRENT ELEMENT TO BE SELECTED
*                                      INDEX                         */
*   DCL                                                            0854
*     SELMX2 FIXED(31);             /* MOD ENTRY SEARCH INDEX FOR  0854
*                                      SELECTION                     */
*   DCL                                                            0855
*     SELMX3 FIXED(31);             /* MODID LIST SEARCH INDEX       */
*   DCL                                                            0856
*     1 SELMFLGS,                   /* LOCAL CONTROL FLAGS           */
*      2 SELMMFND BIT(1),           /* MOD FOUND FOR SOURCE FLAG     */
*      2 SELMDEL BIT(1),            /* DELETE ASSEM ENTRY FOUND      */
*      2 * BIT(6);                  /* UNUSED                        */
*   RFY                                                            0857
*     ICTMOD BASED(CCAICMOD);                                      0857
*   RFY                                                            0858
*     ICTPTF BASED(ICTPPTR(SELMX2));                               0858
*   RFY                                                            0859
*     ICTMIDLS BASED(ICTMICHN(SELMX2));                            0859
*   RFY                                                            0860
*     TSLPARMS BASED(TBLXTSLP);                                    0860
*   SELMRC=ZERO;                    /* CLEAR RETURN CODE             */
         SLR   SELMRC,SELMRC                                       0861
*   SELMFLGS=''B;                   /* CLEAR LOCAL CONTROL FLAGS     */
         MVI   SELMFLGS,X'00'                                      0862
*   TSLFUNCT=TSLFCLRP;              /* CLEAR THE TEMORARY USER FLAGS
*                                      IN THE ICT                    */
         L     @02,@PC00001                                        0863
         L     @02,TBLXTSLP(,@02)                                  0863
         MVI   TSLFUNCT(@02),X'05'                                 0863
*   CALL HMASMTSB(TSLPARMS);        /* ...                           */
         ST    @02,@AL00001                                        0864
         L     @15,@CV02024                                        0864
         LA    @01,@AL00001                                        0864
         BALR  @14,@15                                             0864
*                                                                  0865
*   /*****************************************************************/
*   /*                                                               */
*   /* LOOP THRU ICT MOD SECTION ONCE AND FOR EACH AS YET NOT        */
*   /* PROCESSED ELEMENT, DETERMINE WHICH ENTRY IS SELECTED          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0865
*   DO SELMX1=1 BY 1                /* PROCESS ALL ELEMENT ENTRIES IN
*                                      THE ICT                       */
*         WHILE(ICTMEND(SELMX1)^=ICTENDNT/* ...                      */
*         &SELMRC<STOPFUNC);                                       0865
         LA    SELMX1,1                                            0865
         B     @DE00865                                            0865
@DL00865 DS    0H                                                  0866
*     IF ICTMPASS(SELMX1)^=ON THEN  /* SELECTION NOT DONE FOR THIS 0866
*                                      MOD?                          */
         LR    @05,SELMX1                                          0866
         MH    @05,@CH02665                                        0866
         L     @02,CCAICMOD(,CCAPTR)                               0866
         ALR   @02,@05                                             0866
         AL    @02,@CF02708                                        0866
         TM    ICTMPASS-12(@02),B'10000000'                        0866
         BO    @RF00866                                            0866
*       DO;                         /* YES,                          */
*         SELMONUM=ZERO;            /* CLEAR SELECTED ELEMENT ORDER
*                                      NUMBER                        */
         SLR   @02,@02                                             0868
         STH   @02,SELMONUM                                        0868
*         SELMO#2=ZERO;             /* CLEAR SELECTED ELEMENT ORDER
*                                      NUMBER 2                      */
         SLR   SELMO#2,SELMO#2                                     0869
*         SELMPTR1=ZERO;            /* CLEAR SELECTED ENTRY PTR      */
         SLR   SELMPTR1,SELMPTR1                                   0870
*         SELMPTR2=ZERO;            /* CLEAR 2ND SELECTED ENTRY PTR  */
         SLR   SELMPTR2,SELMPTR2                                   0871
*         SELMDEL=OFF;              /* DELETE NOT FOUND              */
         NI    SELMDEL,B'10111111'                                 0872
*         DO SELMX2=1 BY 1          /* SEARCH ALL MOD ENTRIES IN THE
*                                      ICT                           */
*               WHILE(ICTMEND(SELMX2)^=ICTENDNT/*                    */
*               &SELMRC<STOPFUNC);                                 0873
         LA    SELMX2,1                                            0873
         B     @DE00873                                            0873
@DL00873 DS    0H                                                  0874
*           IF SELMNAME=ICTMNAME(SELMX2)/* SAME ELEMENT NAME         */
*               &ICTMFLG1(SELMX2)=SELMTYPE/* ... AND TYPE            */
*               &ICTMNOGO(SELMX2)=OFF/* ... AND MOD NOT NOGO         */
*               &ICTPNOGO(1)=OFF THEN/* ... AND SYSMOD NOT NOGO      */
         LA    @15,144                                             0874
         LR    @01,SELMX1                                          0874
         MR    @00,@15                                             0874
         L     @14,CCAICMOD(,CCAPTR)                               0874
         LA    @15,0(@01,@14)                                      0874
         AL    @15,@CF02699                                        0874
         LA    @00,144                                             0874
         ST    @15,@TF00001                                        0874
         LR    @15,@00                                             0874
         MR    @14,SELMX2                                          0874
         L     @14,CCAICMOD(,CCAPTR)                               0874
         ST    @01,@TF00002                                        0874
         L     @01,@TF00001                                        0874
         ST    @15,@TF00001                                        0874
         ALR   @15,@14                                             0874
         AL    @15,@CF02699                                        0874
         CLC   SELMNAME(8,@01),ICTMNAME(@15)                       0874
         BNE   @RF00874                                            0874
         L     @15,@TF00002                                        0874
         AL    @15,@CF02700                                        0874
         LA    @15,ICTMFLG1-9(@15,@14)                             0874
         LR    @01,@14                                             0874
         AL    @01,@TF00001                                        0874
         AL    @01,@CF02700                                        0874
         CLC   ICTMFLG1-9(1,@01),SELMTYPE(@15)                     0874
         BNE   @RF00874                                            0874
         LR    @15,@14                                             0874
         AL    @15,@TF00001                                        0874
         AL    @15,@CF02704                                        0874
         TM    ICTMNOGO-8(@15),B'01000000'                         0874
         BNZ   @RF00874                                            0874
         L     @15,@TF00001                                        0874
         AL    @15,@CF02701                                        0874
         L     @01,ICTPPTR-96(@15,@14)                             0874
         TM    ICTPNOGO(@01),B'01000000'                           0874
         BNZ   @RF00874                                            0874
*             DO;                   /* YES,                          */
*               ICTMPASS(SELMX2)=ON;/* MARK AS PROCESSED BY SELECTION*/
         LR    @15,@14                                             0876
         AL    @15,@TF00001                                        0876
         AL    @15,@CF02708                                        0876
         OI    ICTMPASS-12(@15),B'10000000'                        0876
*               IF ICTMASM(SELMX2)=OFF THEN/* NOT AN ASSEMBLY?       */
         LR    @15,@14                                             0877
         AL    @15,@TF00001                                        0877
         AL    @15,@CF02700                                        0877
         TM    ICTMASM-9(@15),B'01000000'                          0877
         BNZ   @RF00877                                            0877
*                 DO;               /* YES,                          */
*                   IF SELMO#2<ICTPONUM(1) THEN/* IS ORDER NUMBER FOR
*                                      THIS ELEMENT'S SYSMOD HIGHEST */
         L     @15,@TF00001                                        0879
         AL    @15,@CF02701                                        0879
         L     @01,ICTPPTR-96(@15,@14)                             0879
         SLR   @15,@15                                             0879
         ICM   @15,3,ICTPONUM(@01)                                 0879
         CLR   SELMO#2,@15                                         0879
         BNL   @RF00879                                            0879
*                     DO;           /* YES,                          */
*                       SELMO#2=ICTPONUM(1);/* RESET HIGHEST ORDER # */
         LR    SELMO#2,@15                                         0881
*                       SELMPTR2=ADDR(ICTMOD(SELMX2));/* AND SLECTED
*                                      PTR                           */
         L     SELMPTR2,@TF00001                                   0882
         AL    @14,@CF02699                                        0882
         LA    SELMPTR2,ICTMOD(SELMPTR2,@14)                       0882
*                     END;                                         0883
*                 END;                                             0884
*               ELSE                /* ELEMENT IS AN ASSEMBLY        */
*                 DO;                                              0885
         B     @RC00877                                            0885
@RF00877 DS    0H                                                  0886
*                   IF SELMDEL=OFF THEN/* DELETE NOT ALREADY FOUND?  */
         TM    SELMDEL,B'01000000'                                 0886
         BNZ   @RF00886                                            0886
*                     DO;           /*                               */
*                       IF ICTMIDEL(SELMX2)=ON THEN/* DELETE ENTRY?  */
         LR    @15,SELMX2                                          0888
         MH    @15,@CH02665                                        0888
         L     @14,CCAICMOD(,CCAPTR)                               0888
         ST    @15,@TF00001                                        0888
         ALR   @15,@14                                             0888
         AL    @15,@CF02702                                        0888
         TM    ICTMIDEL-11(@15),B'01000000'                        0888
         BNO   @RF00888                                            0888
*                         DO;       /* YES,                          */
*                           SELMO#2=ICTPONUM(1);/* DELETE IS HIGNEST */
         L     @15,@TF00001                                        0890
         AL    @15,@CF02701                                        0890
         L     @01,ICTPPTR-96(@15,@14)                             0890
         SLR   SELMO#2,SELMO#2                                     0890
         ICM   SELMO#2,3,ICTPONUM(@01)                             0890
*                           SELMPTR2=ADDR(ICTMOD(SELMX2));/* AND   0891
*                                      SLECTED PTR                   */
         L     SELMPTR2,@TF00001                                   0891
         AL    @14,@CF02699                                        0891
         LA    SELMPTR2,ICTMOD(SELMPTR2,@14)                       0891
*                           SELMDEL=ON;/* DELETE FOUND               */
         OI    SELMDEL,B'01000000'                                 0892
*                         END;                                     0893
*                       ELSE        /* PREVIOUS DELETE ENTRY         */
*                         DO;                                      0894
         B     @RC00888                                            0894
@RF00888 DS    0H                                                  0895
*                           IF SELMO#2<ICTPONUM(1) THEN/* IS ORDER 0895
*                                      NUMBER FOR THIS ELEMENT'S   0895
*                                      SYSMOD HIGHEST                */
         LR    @15,SELMX2                                          0895
         MH    @15,@CH02665                                        0895
         L     @14,CCAICMOD(,CCAPTR)                               0895
         LA    @01,0(@15,@14)                                      0895
         AL    @01,@CF02701                                        0895
         L     @01,ICTPPTR-96(,@01)                                0895
         SLR   @00,@00                                             0895
         ICM   @00,3,ICTPONUM(@01)                                 0895
         CLR   SELMO#2,@00                                         0895
         BNL   @RF00895                                            0895
*                             DO;   /* YES,                          */
*                               SELMO#2=ICTPONUM(1);/* RESET HIGHEST
*                                      ORDER #                       */
         LR    SELMO#2,@00                                         0897
*                               SELMPTR2=ADDR(ICTMOD(SELMX2));/* AND
*                                      SLECTED PTR                   */
         AL    @14,@CF02699                                        0898
         LA    SELMPTR2,ICTMOD(@15,@14)                            0898
*                             END;                                 0899
*                         END;                                     0900
*                     END;                                         0901
*                   ELSE            /* ONE DELETE ENTRY ALREADY FOUND*/
*                     DO;           /*                               */
         B     @RC00886                                            0902
@RF00886 DS    0H                                                  0903
*                       IF ICTMIDEL(SELMX2)=ON/* DELETE ENTRY?       */
*                           &SELMO#2<ICTPONUM(1) THEN/* IS ORDER   0903
*                                      NUMBER FOR THIS ELEMENT'S   0903
*                                      SYSMOD HIGHEST                */
         LR    @15,SELMX2                                          0903
         MH    @15,@CH02665                                        0903
         L     @14,CCAICMOD(,CCAPTR)                               0903
         ST    @15,@TF00001                                        0903
         ALR   @15,@14                                             0903
         AL    @15,@CF02702                                        0903
         TM    ICTMIDEL-11(@15),B'01000000'                        0903
         BNO   @RF00903                                            0903
         L     @15,@TF00001                                        0903
         AL    @15,@CF02701                                        0903
         L     @01,ICTPPTR-96(@15,@14)                             0903
         SLR   @15,@15                                             0903
         ICM   @15,3,ICTPONUM(@01)                                 0903
         CLR   SELMO#2,@15                                         0903
         BNL   @RF00903                                            0903
*                         DO;       /* YES,                          */
*                           SELMO#2=ICTPONUM(1);/* RESET HIGHEST   0905
*                                      ORDER #                       */
         LR    SELMO#2,@15                                         0905
*                           SELMPTR2=ADDR(ICTMOD(SELMX2));/* AND   0906
*                                      SLECTED PTR                   */
         L     SELMPTR2,@TF00001                                   0906
         AL    @14,@CF02699                                        0906
         LA    SELMPTR2,ICTMOD(SELMPTR2,@14)                       0906
*                         END;                                     0907
*                     END;          /*                               */
@RF00903 DS    0H                                                  0909
*                 END;                                             0909
@RC00886 DS    0H                                                  0910
*               IF SELMONUM<ICTPONUM(1) THEN/* IS ORDER NUMBER FOR 0910
*                                      THIS ELEMENT'S SYSMOD HIGHER
*                                      THAN PREVIOUSLY SELECTED    0910
*                                      ELEMENT?                      */
@RC00877 LR    @15,SELMX2                                          0910
         MH    @15,@CH02665                                        0910
         L     @01,CCAICMOD(,CCAPTR)                               0910
         AL    @01,@CF02701                                        0910
         L     @01,ICTPPTR-96(@15,@01)                             0910
         CLC   SELMONUM(2),ICTPONUM(@01)                           0910
         BNL   @RF00910                                            0910
*                 DO;               /* YES,                          */
*                                                                  0911
*                   /*************************************************/
*                   /*                                               */
*                   /* SEARCH THE MOD ID LIST TO SEE SYSMOD IS IN    */
*                   /* MODID IF SO, THEN RESET SO THAT THIS IS THE   */
*                   /* SELECTED ELEMENT VERSION.                     */
*                   /*                                               */
*                   /*************************************************/
*                                                                  0912
*                   DO SELMX3=1 BY 1/* PROCESS THE CDS MOD ID LIST   */
*                         WHILE(ICTMIDND(SELMX3)^=ICTENDNT/*         */
*                         &SELMRC<STOPFUNC);                       0912
         LA    @15,1                                               0912
         ST    @15,SELMX3                                          0912
         B     @DE00912                                            0912
@DL00912 DS    0H                                                  0913
*                     IF ICTMODID(SELMX3)=ICTPTFS(1) THEN/* THIS MOD
*                                      ID?                           */
         L     @15,SELMX3                                          0913
         SLA   @15,3                                               0913
         LR    @14,SELMX2                                          0913
         MH    @14,@CH02665                                        0913
         L     @01,CCAICMOD(,CCAPTR)                               0913
         LA    @01,0(@14,@01)                                      0913
         AL    @01,@CF02707                                        0913
         L     @01,ICTMICHN-104(,@01)                              0913
         L     @00,CCAICMOD(,CCAPTR)                               0913
         ST    @01,@TF00001                                        0913
         LR    @01,@00                                             0913
         AL    @01,@CF02701                                        0913
         L     @01,ICTPPTR-96(@14,@01)                             0913
         ST    @14,@TF00002                                        0913
         L     @14,@TF00001                                        0913
         ALR   @14,@15                                             0913
         AL    @14,@CF02695                                        0913
         CLC   ICTMODID(7,@14),ICTPTFS(@01)                        0913
         BNE   @RF00913                                            0913
*                       DO;         /* YES,                          */
*                         SELMONUM=ICTPONUM(1);/* RESET SELECTED   0915
*                                      ORDER #                       */
         MVC   SELMONUM(2),ICTPONUM(@01)                           0915
*                         SELMPTR1=ADDR(ICTMOD(SELMX2));/* AND     0916
*                                      SLECTED PTR                   */
         LR    SELMPTR1,@00                                        0916
         L     @01,@TF00002                                        0916
         AL    SELMPTR1,@CF02699                                   0916
         LA    SELMPTR1,ICTMOD(@01,SELMPTR1)                       0916
*                       END;                                       0917
*                     ELSE                                         0918
*                       ;           /* NOT THIS MOD ID ENTRY         */
@RF00913 DS    0H                                                  0919
*                   END;            /* END OF MODID LIST SEARCH      */
         LA    @15,1                                               0919
         AL    @15,SELMX3                                          0919
         ST    @15,SELMX3                                          0919
@DE00912 L     @15,SELMX3                                          0919
         SLA   @15,3                                               0919
         LR    @14,SELMX2                                          0919
         MH    @14,@CH02665                                        0919
         L     @01,CCAICMOD(,CCAPTR)                               0919
         AL    @01,@CF02707                                        0919
         L     @01,ICTMICHN-104(@14,@01)                           0919
         AL    @01,@CF02695                                        0919
         L     @15,ICTMIDND(@15,@01)                               0919
         CL    @15,ICTENDNT                                        0919
         BE    @DC00912                                            0919
         CH    SELMRC,@CH00033                                     0919
         BL    @DL00912                                            0919
@DC00912 DS    0H                                                  0920
*                 END;                                             0920
*               ELSE                                               0921
*                 ;                 /* ORDER NUMBER NOT GREATER      */
@RF00910 DS    0H                                                  0922
*             END;                                                 0922
*           ELSE                                                   0923
*             ;                     /* NOT SAME ELEMENT              */
@RF00874 DS    0H                                                  0924
*         END;                                                     0924
         AH    SELMX2,@CH00064                                     0924
@DE00873 LR    @15,SELMX2                                          0924
         MH    @15,@CH02665                                        0924
         L     @01,CCAICMOD(,CCAPTR)                               0924
         AL    @01,@CF02699                                        0924
         L     @15,ICTMEND(@15,@01)                                0924
         CL    @15,ICTENDNT                                        0924
         BE    @DC00873                                            0924
         CH    SELMRC,@CH00033                                     0924
         BL    @DL00873                                            0924
@DC00873 DS    0H                                                  0925
*         IF SELMPTR1^=ZERO         /* HIGHEST ELEMENT FOUND?        */
*             &SELMDEL=OFF THEN     /* ... AND NOT DELETE CASE?      */
         LTR   SELMPTR1,SELMPTR1                                   0925
         BZ    @RF00925                                            0925
         TM    SELMDEL,B'01000000'                                 0925
         BNZ   @RF00925                                            0925
*           DO;                     /* YES,                          */
*             SELMPTR1->ICTMISEL(1)=ON;/* ELEMENT SELECTED           */
         OI    ICTMISEL(SELMPTR1),B'10000000'                      0927
*           END;                                                   0928
*         ELSE                      /* ELEMENT FOR SYSMOD THAT IS IN
*                                      THE MOD ID LIST NOT FOUND     */
*           DO;                                                    0929
         B     @RC00925                                            0929
@RF00925 DS    0H                                                  0930
*             IF SELMPTR2^=ZERO THEN/* HIGHEST ELEMENT FOUND?        */
         LTR   SELMPTR2,SELMPTR2                                   0930
         BZ    @RF00930                                            0930
*               DO;                 /* YES,                          */
*                 SELMPTR2->ICTMISEL(1)=ON;/* NONE IS IN THE MOD ID
*                                      LIST SO ASSUME THAT IT WAS A
*                                      MOD DELETE AND SET HIGHEST  0932
*                                      ORDER NUMBER ENTRY AS SELECTED*/
         OI    ICTMISEL(SELMPTR2),B'10000000'                      0932
*               END;                                               0933
*           END;                                                   0934
*       END;                                                       0935
*     ELSE                                                         0936
*       ;                           /* ELEMENT ALREADY PROCESSED,  0936
*                                      SKIP IT                       */
@RF00866 DS    0H                                                  0937
*   END;                            /* END OF PROCESS ALL ELEMENTS 0937
*                                      LOOP                          */
*                                                                  0937
@RC00866 AH    SELMX1,@CH00064                                     0937
@DE00865 LR    @05,SELMX1                                          0937
         MH    @05,@CH02665                                        0937
         L     @02,CCAICMOD(,CCAPTR)                               0937
         AL    @02,@CF02699                                        0937
         L     @05,ICTMEND(@05,@02)                                0937
         CL    @05,ICTENDNT                                        0937
         BE    @DC00865                                            0937
         CH    SELMRC,@CH00033                                     0937
         BL    @DL00865                                            0937
@DC00865 DS    0H                                                  0938
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE THE ASSEMBLIES THAT HAVE TO BE DONE                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0938
*   DO SELMX1=1 BY 1                /* PROCESS ALL ELEMENT ENTRIES IN
*                                      THE ICT                       */
*         WHILE(ICTMEND(SELMX1)^=ICTENDNT/* ...                      */
*         &SELMRC<STOPFUNC);                                       0938
*                                                                  0938
         LA    SELMX1,1                                            0938
         B     @DE00938                                            0938
@DL00938 DS    0H                                                  0939
*     /***************************************************************/
*     /*                                                             */
*     /* SEE IF MATCHING MOD FOR THE SOURCE ASSEMBLY                 */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0939
*     IF ICTMISEL(SELMX1)=ON        /* SELECTED                      */
*         &ICTMSRCR(SELMX1)=ON THEN /* ... AND A SOURCE ENTRY?       */
         LR    @05,SELMX1                                          0939
         MH    @05,@CH02665                                        0939
         L     @02,CCAICMOD(,CCAPTR)                               0939
         ST    @05,@TF00001                                        0939
         ALR   @05,@02                                             0939
         AL    @05,@CF02702                                        0939
         TM    ICTMISEL-11(@05),B'10000000'                        0939
         BNO   @RF00939                                            0939
         AL    @02,@TF00001                                        0939
         AL    @02,@CF02700                                        0939
         TM    ICTMSRCR-9(@02),B'00000010'                         0939
         BNO   @RF00939                                            0939
*       DO;                         /* YES,                          */
*         SELMMFND=OFF;             /* MATCHING MOD NOT YET FOUND    */
         NI    SELMMFND,B'01111111'                                0941
*         DO SELMX2=1 BY 1          /* SEARCH ALL ELEMENTS FOR MOD 0942
*                                      ENTRY FOR SOURCE ENTRY        */
*               WHILE(ICTMEND(SELMX2)^=ICTENDNT/* ...                */
*               &SELMMFND=OFF       /*                               */
*               &SELMRC<STOPFUNC);                                 0942
         LA    SELMX2,1                                            0942
         B     @DE00942                                            0942
@DL00942 DS    0H                                                  0943
*           IF(ICTMMOD(SELMX2)=ON   /* MOD ENTRY                     */
*               &ICTMASM(SELMX2)=OFF)/* ...                          */
*               &ICTMISEL(SELMX2)=ON/* ... AND SELECTED              */
*               &ICTMNAME(SELMX2)=ICTMNAME(SELMX1) THEN/* AND MATCHES
*                                      SOURCE?                       */
         LA    @05,144                                             0943
         LR    @01,SELMX2                                          0943
         MR    @00,@05                                             0943
         L     @15,CCAICMOD(,CCAPTR)                               0943
         ST    @01,@TF00001                                        0943
         ALR   @01,@15                                             0943
         AL    @01,@CF02700                                        0943
         TM    ICTMMOD-9(@01),B'10000000'                          0943
         BNO   @RF00943                                            0943
         TM    ICTMASM-9(@01),B'01000000'                          0943
         BNZ   @RF00943                                            0943
         LR    @14,@15                                             0943
         AL    @14,@TF00001                                        0943
         AL    @14,@CF02702                                        0943
         TM    ICTMISEL-11(@14),B'10000000'                        0943
         BNO   @RF00943                                            0943
         LR    @01,@05                                             0943
         MR    @00,SELMX1                                          0943
         LR    @05,@15                                             0943
         AL    @05,@TF00001                                        0943
         AL    @05,@CF02699                                        0943
         ALR   @15,@01                                             0943
         AL    @15,@CF02699                                        0943
         CLC   ICTMNAME(8,@05),ICTMNAME(@15)                       0943
         BNE   @RF00943                                            0943
*             DO;                   /* YES,                          */
*               SELMMFND=ON;        /* MOD FOR SOURCE FOUND          */
         OI    SELMMFND,B'10000000'                                0945
*             END;                                                 0946
*           ELSE                                                   0947
*             ;                     /* SKIP IT SINCE NOT SELECTED MOD
*                                      FOR SOURCE                    */
@RF00943 DS    0H                                                  0948
*         END;                      /* END MATCHING MOD ENTRY SEARCH */
         AH    SELMX2,@CH00064                                     0948
@DE00942 LR    @05,SELMX2                                          0948
         MH    @05,@CH02665                                        0948
         L     @01,CCAICMOD(,CCAPTR)                               0948
         AL    @01,@CF02699                                        0948
         L     @05,ICTMEND(@05,@01)                                0948
         CL    @05,ICTENDNT                                        0948
         BE    @DC00942                                            0948
         TM    SELMMFND,B'10000000'                                0948
         BNZ   @DC00942                                            0948
         CH    SELMRC,@CH00033                                     0948
         BL    @DL00942                                            0948
@DC00942 DS    0H                                                  0949
*         IF SELMMFND=ON THEN       /* MATCH FOUND?                  */
         TM    SELMMFND,B'10000000'                                0949
         BNO   @RF00949                                            0949
*           DO;                     /* YES,                          */
*                                                                  0950
*             /*******************************************************/
*             /*                                                     */
*             /* AT THIS POINT, A SELECTED SOURCE ELEMENT HAS A      */
*             /* MATCHING SELECTED MOD SO THAT NO ASSEMBLY SHOULD BE */
*             /* DONE                                                */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0951
*             DO SELMX2=1 BY 1      /* SEARCH ALL ELEMENTS FOR ASSEM
*                                      ENTRY FOR SOURCE ENTRY        */
*                   WHILE(ICTMEND(SELMX2)^=ICTENDNT/* ...            */
*                   &SELMRC<STOPFUNC);                             0951
         LA    SELMX2,1                                            0951
         B     @DE00951                                            0951
@DL00951 DS    0H                                                  0952
*               IF(ICTMASM(SELMX2)=ON/* ASSEM ENTRY                  */
*                   &ICTMASM(SELMX2)=ON)/* ...                       */
*                   &ICTMISEL(SELMX2)=ON/* ... AND SELECTED          */
*                   &ICTMNAME(SELMX2)=ICTMNAME(SELMX1) THEN/* AND  0952
*                                      MATCHES SOURCE?               */
         LA    @05,144                                             0952
         LR    @01,SELMX2                                          0952
         MR    @00,@05                                             0952
         L     @15,CCAICMOD(,CCAPTR)                               0952
         ST    @01,@TF00001                                        0952
         ALR   @01,@15                                             0952
         AL    @01,@CF02700                                        0952
         TM    ICTMASM-9(@01),B'01000000'                          0952
         BNO   @RF00952                                            0952
         LR    @14,@15                                             0952
         AL    @14,@TF00001                                        0952
         AL    @14,@CF02702                                        0952
         TM    ICTMISEL-11(@14),B'10000000'                        0952
         BNO   @RF00952                                            0952
         LR    @01,@05                                             0952
         MR    @00,SELMX1                                          0952
         LR    @05,@15                                             0952
         AL    @05,@TF00001                                        0952
         AL    @05,@CF02699                                        0952
         ALR   @01,@15                                             0952
         AL    @01,@CF02699                                        0952
         CLC   ICTMNAME(8,@05),ICTMNAME(@01)                       0952
         BNE   @RF00952                                            0952
*                 DO;               /* YES,                          */
*                   ICTMISEL(SELMX2)=OFF;/* UN-SELECT THE ASSEMBLY SO
*                                      THAT MOD WILL BE USED AND NO
*                                      ASSEMBLY                      */
         AL    @15,@TF00001                                        0954
         AL    @15,@CF02702                                        0954
         NI    ICTMISEL-11(@15),B'01111111'                        0954
*                 END;                                             0955
*               ELSE                                               0956
*                 ;                 /* SKIP IT SINCE NOT SELECTED MOD
*                                      FOR SOURCE                    */
@RF00952 DS    0H                                                  0957
*             END;                  /* END MATCHING MOD ENTRY SEARCH */
         AH    SELMX2,@CH00064                                     0957
@DE00951 LR    @05,SELMX2                                          0957
         MH    @05,@CH02665                                        0957
         L     @01,CCAICMOD(,CCAPTR)                               0957
         AL    @01,@CF02699                                        0957
         L     @05,ICTMEND(@05,@01)                                0957
         CL    @05,ICTENDNT                                        0957
         BE    @DC00951                                            0957
         CH    SELMRC,@CH00033                                     0957
         BL    @DL00951                                            0957
@DC00951 DS    0H                                                  0958
*           END;                                                   0958
*       END;                                                       0959
*     ELSE                                                         0960
*       ;                           /* NOT A SELECTED SOURCE ENTRY SO
*                                      SKIP IT                       */
@RF00939 DS    0H                                                  0961
*   END;                            /* END OF PROCESS ALL ELEMENTS 0961
*                                      LOOP                          */
@RC00939 AH    SELMX1,@CH00064                                     0961
@DE00938 LR    @05,SELMX1                                          0961
         MH    @05,@CH02665                                        0961
         L     @02,CCAICMOD(,CCAPTR)                               0961
         AL    @02,@CF02699                                        0961
         L     @05,ICTMEND(@05,@02)                                0961
         CL    @05,ICTENDNT                                        0961
         BE    @DC00938                                            0961
         CH    SELMRC,@CH00033                                     0961
         BL    @DL00938                                            0961
@DC00938 DS    0H                                                  0962
*   RETURN CODE(SELMRC);            /* RETURN W/ RETURN CODE         */
         LR    @15,SELMRC                                          0962
         L     @14,@SA00013                                        0962
         LM    @00,@12,@SA00013+8                                  0962
         BR    @14                                                 0962
*   RFY                                                            0963
*     ICTMOD BASED;                                                0963
*   RFY                                                            0964
*     ICTPTF BASED;                                                0964
*   RFY                                                            0965
*     ICTMIDLS BASED;                                              0965
*   RFY                                                            0966
*     TSLPARMS BASED;                                              0966
*   END SELMOD;                                                    0967
         EJECT
*                                                                  0968
*/********************************************************************/
*/*                                                                  */
*/* MODIDCHK -                                                       */
*/*                                                                  */
*/********************************************************************/
*/*                                                                  */
*/*  SYSMOD NAME PRESENT IN CDS AND ACDS MOD ID LISTS:               */
*/*                                                                  */
*/*               × ACDS                                             */
*/*               × ^P × P  ×                                        */
*/* ______________×____×____×                                        */
*/*    C  ^PRESENT× 1  × 2  ×                                        */
*/*    D  ________×____×____×                                        */
*/*    S  PRESENT × 3  × 4  ×                                        */
*/*       ________×____×____×                                        */
*/*                                                                  */
*/*  CASE 1 - WILL NOT OCCUR                                         */
*/*                                                                  */
*/*  CASE 2 - ELEMENT IS NOGO SINCE MOD ID IS ON THE ACDS BUT NOT    */
*/*           THE CDS                                                */
*/*                                                                  */
*/*  CASE 3 - THE SYSMOD IN THE ID LIST MUST BE A CADIDATE FOR       */
*/*           RESTORE OR THE ELEMENT IS NOGO                         */
*/*                                                                  */
*/*  CASE 4                                                          */
*/*                                                                  */
*/*               × ACDS STATUS                                      */
*/*               ×    ×    ×    ×    ×    ×    ×    ×               */
*/*               ×    ×    ×    × S  ×    ×    ×    ×               */
*/*               ×    ×    ×    × U  ×    ×    ×    ×               */
*/*               ×    ×    ×    × P  × D  ×    ×    ×               */
*/*               ×    × E  ×    ×    × E  ×    ×    ×               */
*/*               ×    × R  ×    × O  × L  ×    ×    ×               */
*/*               ×    × R  × S  × N  × E  ×    ×    ×               */
*/*               × O  × O  × U  × L  × T  ×    ×    ×               */
*/*               × K  × R  × P  × Y  × E  ×    ×    ×               */
*/*_______________×____×____×____×____×____×____×____×               */
*/*   C        OK × OK × E  × ?  × ?  × E  ×    ×    ×               */
*/*   D  _________×____×____×____×____×____×____×____×               */
*/*   S     ERROR × E  × E  × E  × E  × E  ×    ×    ×               */
*/*      _________×____×____×____×____×____×____×____×               */
*/*   S       SUP × OK × E  × OK × ?  × E  ×    ×    ×               */
*/*   T  _________×____×____×____×____×____×____×____×               */
*/*   A  SUP ONLY × E  × E  × E  × E  × E  ×    ×    ×               */
*/*   T  _________×____×____×____×____×____×____×____×               */
*/*   U    DELETE × E  × E  × E  × E  × E  ×    ×    ×               */
*/*   S  _________×____×____×____×____×____×____×____×               */
*/*               ×    ×    ×    ×    ×    ×    ×    ×               */
*/*       ________×____×____×____×____×____×____×____×               */
*/*               ×    ×    ×    ×    ×    ×    ×    ×               */
*/*       ________×____×____×____×____×____×____×____×               */
*/*                                                                  */
*/*                                                                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0968
*MODIDCHK:                                                         0968
*   PROC;                                                          0968
MODIDCHK STM   @14,@12,@SA00014                                    0968
*   DCL                                                            0969
*     MODIRC FIXED(15);             /* LOCAL RETURN CODE             */
*   DCL                                                            0970
*     MODI1PRC FIXED(15);           /* RETURN CODE FOR PASS THRU ONE
*                                      SYSMOD                        */
*   DCL                                                            0971
*     MODIX1 FIXED(31);             /* ICT MOD ENTRY INDEX COUNTER   */
*   DCL                                                            0972
*     MODIX2 FIXED(31);             /* CDS MOD ID INDEX LIST INDEX 0972
*                                      COUNTER                       */
*   RFY                                                            0973
*     ICTPTF BASED(CCAICPTF);                                      0973
*   RFY                                                            0974
*     ICTIXPF BASED(ICTPCHN(MODIX1));                              0974
*   RFY                                                            0975
*     ICTMOD BASED(ICTIXP(MODIX2));                                0975
*   RFY                                                            0976
*     TSLPARMS BASED(TBLXTSLP);                                    0976
*   RFY                                                            0977
*     ICTMIDLS BASED(ICTMICHN(MODIX1));/* CDS MODID CHAIN            */
*   MODIRC=ZERO;                    /* CLEAR LOCAL RETURN CODE       */
         SLR   MODIRC,MODIRC                                       0978
*   DO MODIX1=1 BY 1                /* PROCESS ALL SYSMOD ENTRIES IN
*                                      THE ICT                       */
*         WHILE(ICTPEND(MODIX1)^=ICTENDNT/*                          */
*         &MODIRC<STOPFUNC);                                       0979
         LA    MODIX1,1                                            0979
         B     @DE00979                                            0979
@DL00979 DS    0H                                                  0980
*     MODI1PRC=ZERO;                /* CLEAR ONE PASS RC             */
         SLR   MODI1PRC,MODI1PRC                                   0980
*     IF ICTPNOGO(MODIX1)=OFF THEN  /* NOT NOGO?                     */
         LR    @07,MODIX1                                          0981
         MH    @07,@CH02662                                        0981
         L     @04,CCAICPTF(,CCAPTR)                               0981
         ALR   @04,@07                                             0981
         AL    @04,@CF02692                                        0981
         TM    ICTPNOGO-8(@04),B'01000000'                         0981
         BNZ   @RF00981                                            0981
*       DO;                         /* YES,                          */
*                                                                  0982
*         /***********************************************************/
*         /*                                                         */
*         /* PROCESS ALL CDS MODID'S FOR AN ELEMENT                  */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0983
*         DO MODIX2=1 BY 1          /* PROCESS ALL MODS FOR A SYSMOD */
*               WHILE(ICTIXP(MODIX2)^=ICTENDNT/*                     */
*               &MODIRC<STOPFUNC);                                 0983
         LA    MODIX2,1                                            0983
         B     @DE00983                                            0983
@DL00983 DS    0H                                                  0984
*           IF ICTMISEL(1)=ON       /* SELECTED ELEMENT ...          */
*               &ICTMNOGO(1)=OFF    /* ... STILL GO?                 */
*             THEN                                                 0984
         LR    @07,MODIX2                                          0984
         SLA   @07,2                                               0984
         LR    @02,MODIX1                                          0984
         MH    @02,@CH02662                                        0984
         L     @01,CCAICPTF(,CCAPTR)                               0984
         AL    @01,@CF02710                                        0984
         L     @02,ICTPCHN-64(@02,@01)                             0984
         AL    @02,@CF02711                                        0984
         L     @07,ICTIXP(@07,@02)                                 0984
         TM    ICTMISEL(@07),B'10000000'                           0984
         BNO   @RF00984                                            0984
         TM    ICTMNOGO(@07),B'01000000'                           0984
         BNZ   @RF00984                                            0984
*             DO;                   /* YES,                          */
*                                                                  0985
*               /*****************************************************/
*               /*                                                   */
*               /* PERFORM MODID CHECKING FOR ONE ELEMENT            */
*               /*                                                   */
*               /*****************************************************/
*                                                                  0986
*               CALL MODID1CK(ICTMOD(1));                          0986
         ST    @07,@AL00001                                        0986
         LA    @01,@AL00001                                        0986
         BAL   @14,MODID1CK                                        0986
*               RFY                                                0987
*                 RTNCODE RSTD;                                    0987
*               MODI1PRC=MAX(MODI1PRC,RTNCODE);/* SAVE RC            */
         CR    MODI1PRC,RTNCODE                                    0988
         BNL   *+6
         LR    MODI1PRC,RTNCODE                                    0988
*               IF RTNCODE>=STOPSMD THEN/* MOD FAILED?               */
         CH    RTNCODE,@CH00034                                    0989
         BL    @RF00989                                            0989
*                 DO;               /* YES,                          */
*                   ICTMNOGO(1)=ON; /* MOD IS NOGO, ...              */
*                   ICTMMSG(1)=ON;  /* ... MESSAGE ISSUED ...        */
*                   ICTMCPL(1)=ON;  /* ... AND COMPLETE              */
         LR    @14,MODIX2                                          0993
         SLA   @14,2                                               0993
         LR    @07,MODIX1                                          0993
         MH    @07,@CH02662                                        0993
         L     @02,CCAICPTF(,CCAPTR)                               0993
         AL    @02,@CF02710                                        0993
         L     @07,ICTPCHN-64(@07,@02)                             0993
         AL    @07,@CF02711                                        0993
         L     @14,ICTIXP(@14,@07)                                 0993
         OI    ICTMNOGO(@14),B'01110000'                           0993
*                 END;              /*                               */
*               RFY                                                0995
*                 RTNCODE UNRSTD;                                  0995
@RF00989 DS    0H                                                  0996
*             END;                                                 0996
*           ELSE                                                   0997
*             ;                     /* SKIP THIS MOD ENTRY           */
@RF00984 DS    0H                                                  0998
*         END;                      /* END OF PROCESSING ALL MODS FOR
*                                      A SYSMOD                      */
         AH    MODIX2,@CH00064                                     0998
@DE00983 LR    @07,MODIX2                                          0998
         SLA   @07,2                                               0998
         LR    @02,MODIX1                                          0998
         MH    @02,@CH02662                                        0998
         L     @01,CCAICPTF(,CCAPTR)                               0998
         AL    @01,@CF02710                                        0998
         L     @02,ICTPCHN-64(@02,@01)                             0998
         AL    @02,@CF02711                                        0998
         L     @07,ICTIXP(@07,@02)                                 0998
         CL    @07,ICTENDNT                                        0998
         BE    @DC00983                                            0998
         CH    MODIRC,@CH00033                                     0998
         BL    @DL00983                                            0998
@DC00983 DS    0H                                                  0999
*         IF MODI1PRC=STOPSMD THEN  /* SYSMOD FAILED?                */
         CH    MODI1PRC,@CH00034                                   0999
         BNE   @RF00999                                            0999
*           DO;                     /* YES,                          */
*                                                                  1000
*             /*******************************************************/
*             /*                                                     */
*             /* ISSUE MESSAGE(S) FOR FAILING SYSMOD                 */
*             /*                                                     */
*             /*******************************************************/
*                                                                  1001
*             CALL FAILSMD(ICTPTF(MODIX1));                        1001
         LR    @07,MODIX1                                          1001
         MH    @07,@CH02662                                        1001
         L     @04,CCAICPTF(,CCAPTR)                               1001
         AL    @04,@CF02694                                        1001
         LA    @07,ICTPTF(@07,@04)                                 1001
         ST    @07,@AL00001                                        1001
         LA    @01,@AL00001                                        1001
         BAL   @14,FAILSMD                                         1001
*             RFY                                                  1002
*               RTNCODE RSTD;                                      1002
*             MODI1PRC=MAX(MODI1PRC,RTNCODE);/* SAVE RC              */
         CR    MODI1PRC,RTNCODE                                    1003
         BNL   *+6
         LR    MODI1PRC,RTNCODE                                    1003
*             RFY                                                  1004
*               RTNCODE UNRSTD;                                    1004
*           END;                                                   1005
*         ELSE                                                     1006
*           ;                       /* SYSMOD DID NOT FAIL           */
@RF00999 DS    0H                                                  1007
*         MODIRC=MAX(MODIRC,MODI1PRC);/* SAVE RC                     */
         CR    MODIRC,MODI1PRC                                     1007
         BNL   *+6
         LR    MODIRC,MODI1PRC                                     1007
*       END;                                                       1008
*     ELSE                                                         1009
*       ;                           /* SYSMOD IS NOGO                */
@RF00981 DS    0H                                                  1010
*   END;                            /* END OF PROCESSING ALL SYSMOD
*                                      ENTRIES                       */
         AH    MODIX1,@CH00064                                     1010
@DE00979 LR    @04,MODIX1                                          1010
         MH    @04,@CH02662                                        1010
         L     @02,CCAICPTF(,CCAPTR)                               1010
         AL    @02,@CF02694                                        1010
         L     @04,ICTPEND(@04,@02)                                1010
         CL    @04,ICTENDNT                                        1010
         BE    @DC00979                                            1010
         CH    MODIRC,@CH00033                                     1010
         BL    @DL00979                                            1010
@DC00979 DS    0H                                                  1011
*   RETURN CODE(MODIRC);            /* RETURN W/RC SET               */
         LR    @15,MODIRC                                          1011
         L     @14,@SA00014                                        1011
         LM    @00,@12,@SA00014+8                                  1011
         BR    @14                                                 1011
*   RFY                                                            1012
*     ICTIXPF BASED;                                               1012
*   RFY                                                            1013
*     ICTPTF BASED;                                                1013
*   RFY                                                            1014
*     ICTMOD BASED;                                                1014
*   RFY                                                            1015
*     TSLPARMS BASED;                                              1015
*   RFY                                                            1016
*     ICTMIDLS BASED;                                              1016
         EJECT
*                                                                  1017
*/********************************************************************/
*/*                                                                  */
*/* MODID1CK - CHECK MODID'S FOR ON ELEMENT ENTRY                    */
*/* ASSUMPTIONS:                                                     */
*/*                                                                  */
*/*    1. IF AN FMID IS PRESENT, AN RMID IS ALSO PRESENT.            */
*/*                                                                  */
*/*    2. IF AN RMID IS PRESENT THEN AN FMID IS PRESENT UNLESS THE   */
*/*       RMID IS THE RESULT OF AN ASSEMBLY.                         */
*/*                                                                  */
*/*    3. IF A UMID IS PRESENT THEN BOTH AN FMID AND AN RMID IS      */
*/*       PRESENT.                                                   */
*/*                                                                  */
*/*    4. THAT A SYSMOD THAT APPEARS IN THE UMID LIST IS NOT ALSO    */
*/*       THE FMID OR RMID.                                          */
*/*                                                                  */
*/********************************************************************/
*                                                                  1017
*MODID1CK:                                                         1017
*   PROC(MOD1ENT);                  /* ICT MOD ENTRY TO BE CHECKED   */
MODID1CK STM   @14,@12,@SA00015                                    1017
         MVC   @PC00015(4),0(@01)                                  1017
*   DCL                                                            1018
*     MOD1ENT CHAR(*);              /* (INPUT/OUTPUT) ICT MOD ENTRY  */
*   DCL                                                            1019
*     MOD1RC FIXED(15);             /* LOCAL RETURN CODE             */
*   DCL                                                            1020
*     1 MOD1FLGS,                   /* LOCAL CONTROL FLAGS           */
*      2 * BIT(8),                                                 1020
*       3 MOD1DONE BIT(1),          /* ALL MODID CHECKING COMPLETED  */
*       3 MOD1ERR BIT(1),           /* ONE OR MORE MODID ERRORS FOUND
*                                      FOR THIS ELEMENT              */
*       3 M1HEADER BIT(1),          /* ELEMENT HEADER MESSAGE ISSUED */
*       3 * BIT(1),                 /* UNUSED                        */
*       3 MOD1FNDA BIT(1),          /* CDS MODID ALSO IN ACDS MODID
*                                      LIST                          */
*       3 MOD1BOTH BIT(1),          /* SYSMOD IN BOTH CDS AND ACDS 1020
*                                      MODID LISTS                   */
*       3 MOD1DEL BIT(1),           /* ELEMENT IS BEING DELETED      */
*       3 * BIT(1),                 /* UNUSED                        */
*      2 * BIT(8),                                                 1020
*       3 M1FMIDCK BIT(1),          /* FMID CHECKING TO BE DONE      */
*       3 M1RMIDCK BIT(1),          /* RMID CHECKING TO BE DONE      */
*       3 M1UMIDCK BIT(1),          /* UMID CHECKING TO BE DONE      */
*       3 * BIT(1),                 /* UNUSED                        */
*       3 M1CRMRST BIT(1),          /* CDS RMID BE BE RESTORED       */
*       3 M1CUMRST BIT(1),          /* CDS UMID BE BE RESTORED       */
*       3 * BIT(1),                 /* UNUSED                        */
*       3 * BIT(1),                 /* UNUSED                        */
*      2 * BIT(8),                                                 1020
*       3 M1CFMFND BIT(1),          /* CDS FMID FOUND IN LIST        */
*       3 M1AFMFND BIT(1),          /* ACDS FMID FOUND IN LIST       */
*       3 M1FMIDEQ BIT(1),          /* CDS AND ACDS HAVE SAME FMID   */
*       3 * BIT(1),                 /* UNUSED                        */
*       3 M1CFMERM BIT(1),          /* CDS FMID AND RMID EQUAL       */
*       3 M1AFMERM BIT(1),          /* ACDS FMID AND RMID EQUAL      */
*       3 * BIT(1),                 /* UNUSED                        */
*       3 * BIT(1),                 /* UNUSED                        */
*      2 * BIT(8),                                                 1020
*       3 M1CRMFND BIT(1),          /* RMID FOUND IN CDS MODID LIST  */
*       3 M1ARMFND BIT(1),          /* RMID FOUND IN ACDS MODID LIST */
*       3 M1RMIDEQ BIT(1),          /* CDS AND ACDS HAVE SAME RMID   */
*       3 * BIT(1),                 /* UNUSED                        */
*       3 M1CRMRGR BIT(1),          /* CDS RMID IS REGRESSED         */
*       3 M1ARMRGR BIT(1),          /* ACDS RMID IS REGRESSED        */
*       3 M1CRMASM BIT(1),          /* CDS RMID IS RESULT OF ASSEMBLY*/
*       3 M1ARMASM BIT(1),          /* ACDS RMID IS RESULT OF      1020
*                                      ASSEMBLY                      */
*      2 * BIT(8),                                                 1020
*       3 M1CUMFND BIT(1),          /* ONE OR MORE UMID'S IN THE CDS
*                                      MODID LIST                    */
*       3 M1AUMFND BIT(1),          /* ONE OR MORE UMID'S IN THE ACDS
*                                      MODID LIST                    */
*       3 M1CUMID BIT(1),           /* ATLEAST ONE CDS UMID EXITS    */
*       3 M1AUMID BIT(1),           /* ATLEAST ONE ACDS UMID EXITS   */
*       3 * BIT(1),                 /* UNUSED                        */
*       3 * BIT(1),                 /* UNUSED                        */
*       3 * BIT(1),                 /* UNUSED                        */
*       3 * BIT(1),                 /* UNUSED                        */
*      2 * BIT(8),                                                 1020
*       3 * BIT(8);                 /* UNUSED                        */
*   DCL                                                            1021
*     M1CFMID CHAR(LENGTH(ICTMODID))/* CDS ELEMENT FUNCTION OWNER    */
*         BASED(MOD1CDF@);                                         1021
*   DCL                                                            1022
*     M1AFMID CHAR(LENGTH(ICTMODID))/* ACDS ELEMENT FUNCTION OWNER   */
*         BASED(MOD1ACF@);                                         1022
*   DCL                                                            1023
*     M1CRMID CHAR(LENGTH(ICTMODID))/* CDS ELEMENT RPLACEMENT OWNER  */
*         BASED(MOD1CDR@);                                         1023
*   DCL                                                            1024
*     M1ARMID CHAR(LENGTH(ICTMODID))/* ACDS ELEMENT RPLACEMENT OWNER */
*         BASED(MOD1ACR@);                                         1024
*   DCL                                                            1025
*     MOD1CDF@ PTR(31);                                            1025
*   ;                               /* FMID FROM CDS MODID LIST      */
*   DCL                                                            1027
*     MOD1ACF@ PTR(31);             /* FMID FROM ACDS MODID LIST     */
*   DCL                                                            1028
*     MOD1CDR@ PTR(31);             /* RMID FROM CDS MODID LIST      */
*   DCL                                                            1029
*     MOD1ACR@ PTR(31);             /* RMID FROM ACDS MODID LIST     */
*   DCL                                                            1030
*     M1TPSANS CHAR(1);             /* ANSWER FROM HMASMTPS AS TO  1030
*                                      PRE/SUP RELATIONSHIP          */
*   RFY                                                            1031
*     ICTMOD BASED(ADDR(MOD1ENT));                                 1031
*   RFY                                                            1032
*     TSLPARMS BASED(TBLXTSLP);                                    1032
*   RFY                                                            1033
*     ICTMIDLS BASED(ICTMICHN(1));  /* CDS MODID CHAIN               */
         EJECT
*   MOD1RC=ZERO;                    /* CLEAR LOCAL RETURN CODE       */
         SLR   MOD1RC,MOD1RC                                       1034
*   MOD1FLGS=''B;                   /* CLEAR LOCAL FLAGS             */
         XC    MOD1FLGS(6),MOD1FLGS                                1035
*   MOD1DONE=OFF;                   /* MODID CHECKING NOT YET      1036
*                                      COMPLETE                      */
         NI    MOD1DONE,B'01111111'                                1036
*                                                                  1037
*   /*****************************************************************/
*   /*                                                               */
*   /* SAVE CDS AND ACDS FMID AND RMID                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1037
*   CALL M1INIT;                    /* INITIALIZATION PROCESSING FOR
*                                      MODID CHECKING                */
*                                                                  1037
         BAL   @14,M1INIT                                          1037
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESS FMID'S                                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1038
*   CALL M1FMID;                                                   1038
         BAL   @14,M1FMID                                          1038
*   RFY                                                            1039
*     RTNCODE RSTD;                                                1039
*   MOD1RC=MAX(MOD1RC,RTNCODE);     /* SAVE RC                       */
         CR    MOD1RC,RTNCODE                                      1040
         BNL   *+6
         LR    MOD1RC,RTNCODE                                      1040
*   RFY                                                            1041
*     RTNCODE UNRSTD;                                              1041
*                                                                  1041
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESS RMID'S IF REQUIRED                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1042
*   IF MOD1DONE=OFF                 /* NOT DONE ...                  */
*       &MOD1ERR=OFF THEN           /* AND NO PREVIOUS MODID ERROR?  */
         TM    MOD1DONE,B'11000000'                                1042
         BNZ   @RF01042                                            1042
*     DO;                           /* YES,                          */
*       CALL M1RMID;                /*                               */
         BAL   @14,M1RMID                                          1044
*       RFY                                                        1045
*         RTNCODE RSTD;                                            1045
*       MOD1RC=MAX(MOD1RC,RTNCODE); /* SAVE RC                       */
         CR    MOD1RC,RTNCODE                                      1046
         BNL   *+6
         LR    MOD1RC,RTNCODE                                      1046
*       RFY                                                        1047
*         RTNCODE UNRSTD;                                          1047
*     END;                                                         1048
*                                                                  1048
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESS UMID'S IF REQUIRED                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1049
*   IF MOD1DONE=OFF                 /* NOT DONE ...                  */
*       &MOD1ERR=OFF THEN           /* AND NO PREVIOUS MODID ERROR?  */
@RF01042 TM    MOD1DONE,B'11000000'                                1049
         BNZ   @RF01049                                            1049
*     DO;                           /* YES,                          */
*       CALL M1UMID;                /*                               */
         BAL   @14,M1UMID                                          1051
*       RFY                                                        1052
*         RTNCODE RSTD;                                            1052
*       MOD1RC=MAX(MOD1RC,RTNCODE); /* SAVE RC                       */
         CR    MOD1RC,RTNCODE                                      1053
         BNL   *+6
         LR    MOD1RC,RTNCODE                                      1053
*       RFY                                                        1054
*         RTNCODE UNRSTD;                                          1054
*     END;                                                         1055
*   RETURN CODE(MOD1RC);            /* RETURN W/RC SET               */
@RF01049 LR    @15,MOD1RC                                          1056
         L     @14,@SA00015                                        1056
         LM    @00,@12,@SA00015+8                                  1056
         BR    @14                                                 1056
*   RFY                                                            1057
*     ICTMOD BASED;                                                1057
*   RFY                                                            1058
*     TSLPARMS BASED;                                              1058
*   RFY                                                            1059
*     ICTMIDLS BASED;                                              1059
         EJECT
*                                                                  1060
*   /*****************************************************************/
*   /*                                                               */
*   /* M1INIT -                                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1060
*M1INIT:                                                           1060
*   PROC;                                                          1060
M1INIT   STM   @14,@12,12(@13)                                     1060
*   DCL                                                            1061
*     M1IRC FIXED(15);              /* LOCAL RETURN CODE             */
*   DCL                                                            1062
*     M1IX1 FIXED(31);              /* CDS MOD ID INDEX LIST INDEX 1062
*                                      COUNTER                       */
*   DCL                                                            1063
*     M1IX2 FIXED(31);              /* ACDS MOD ID INDEX LIST INDEX
*                                      COUNTER                       */
*   DCL                                                            1064
*     M1ICMID CHAR(LENGTH(ICTMODID))/* CDS MOD ID SYSMOD NAME        */
*         BASED(ADDR(ICTMODID(M1IX1)));                            1064
*   DCL                                                            1065
*     M1IAMID CHAR(LENGTH(ICTMODID))/* ACDS MOD ID SYSMOD NAME       */
*         BASED(ADDR(ICTMODID(M1IX2)));                            1065
*   RFY                                                            1066
*     ICTMOD BASED(ADDR(MOD1ENT));  /* CDS MODID CHAIN               */
*   RFY                                                            1067
*     ICTMIDLS BASED(ICTMICHN(1));  /* CDS MODID CHAIN               */
*   M1IRC=ZERO;                     /* CLEAR RETURN CODE             */
         SLR   M1IRC,M1IRC                                         1068
*   MOD1FLGS=''B;                   /* CLEAR FLAGS                   */
         XC    MOD1FLGS(6),MOD1FLGS                                1069
*   M1FMIDCK=ON;                    /* ASSUME FMID CHECK REQUIRED    */
*   M1RMIDCK=ON;                    /* ASSUME RMID CHECK REQUIRED    */
*   M1UMIDCK=ON;                    /* ASSUME UMID CHECK REQUIRED    */
         OI    M1FMIDCK,B'11100000'                                1072
*   IF ICTMIDEL(1)=ON THEN          /* IS THE ELEMENT BEING DELETED? */
         L     @05,@PC00015                                        1073
         TM    ICTMIDEL(@05),B'01000000'                           1073
         BNO   @RF01073                                            1073
*     DO;                           /* YES,                          */
*       MOD1DEL=ON;                 /* ELEMENT IS BEING DELETED FLAG */
         OI    MOD1DEL,B'00000010'                                 1075
*     END;                          /*                               */
*   ELSE                                                           1077
*     ;                             /* NOT BEING DELETED             */
*                                                                  1077
@RF01073 DS    0H                                                  1078
*   /*****************************************************************/
*   /*                                                               */
*   /* FIND THE CDS FMID AND RMID, IF ANY                            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1078
*   DO M1IX1=1 BY 1                 /* SEARCH CDS MODID FOR        1078
*                                      DIFFERNENT MODID TYPES        */
*         WHILE(ICTMIDND(M1IX1)^=ICTENDIX/*                          */
*         &MOD1RC<STOPFUNC);                                       1078
         LA    M1IX1,1                                             1078
         B     @DE01078                                            1078
@DL01078 DS    0H                                                  1079
*     IF ICTMIDTY(M1IX1)=ICTMIDFM THEN/* IS THE TYPE FMID?           */
         LR    @05,M1IX1                                           1079
         SLA   @05,3                                               1079
         L     @15,@PC00015                                        1079
         L     @15,ICTMICHN(,@15)                                  1079
         ST    @05,@TF00001                                        1079
         ALR   @05,@15                                             1079
         BCTR  @05,0                                               1079
         TM    ICTMIDTY-7(@05),B'00000010'                         1079
         BNO   @RF01079                                            1079
         TM    ICTMIDTY-7(@05),B'00000001'                         1079
         BNZ   @RF01079                                            1079
*       DO;                         /* YES,                          */
*         MOD1CDF@=ADDR(M1ICMID);   /* SAVE CDS FMID VALUE           */
         L     @05,@TF00001                                        1081
         AL    @15,@CF02695                                        1081
         LA    @05,ICTMODID(@05,@15)                               1081
         ST    @05,MOD1CDF@                                        1081
*         M1CFMFND=ON;              /* CDS FMID FOUND                */
         OI    M1CFMFND,B'10000000'                                1082
*       END;                                                       1083
*     ELSE                          /*                               */
*       DO;                                                        1084
         B     @RC01079                                            1084
@RF01079 DS    0H                                                  1085
*         IF ICTMIDTY(M1IX1)=ICTMIDRM THEN/* IS THE TYPE RMID?       */
         LR    @05,M1IX1                                           1085
         SLA   @05,3                                               1085
         L     @15,@PC00015                                        1085
         L     @15,ICTMICHN(,@15)                                  1085
         ST    @05,@TF00001                                        1085
         ALR   @05,@15                                             1085
         BCTR  @05,0                                               1085
         TM    ICTMIDTY-7(@05),B'00000001'                         1085
         BNO   @RF01085                                            1085
         TM    ICTMIDTY-7(@05),B'00000010'                         1085
         BNZ   @RF01085                                            1085
*           DO;                     /* YES,                          */
*             MOD1CDR@=ADDR(M1ICMID);/* SAVE CDS RMID VALUE          */
         L     @05,@TF00001                                        1087
         AL    @05,@CF02695                                        1087
         LA    @05,ICTMODID(@05,@15)                               1087
         ST    @05,MOD1CDR@                                        1087
*             M1CRMFND=ON;          /* CDS RMID FOUND                */
         OI    M1CRMFND,B'10000000'                                1088
*             IF ICTMIDAM(M1IX1)=ON THEN/* RMID RESULT OF ASSEMBLY?  */
         AL    @15,@TF00001                                        1089
         BCTR  @15,0                                               1089
         TM    ICTMIDAM-7(@15),B'00000100'                         1089
         BNO   @RF01089                                            1089
*               DO;                 /* YES                           */
*                 M1CRMASM=ON;      /* SET INTERNAL CDS RMID ASSEM 1091
*                                      FLAG                          */
         OI    M1CRMASM,B'00000010'                                1091
*               END;                /*                               */
*             IF ICTMIDRG(M1IX1)=ON THEN/* RMID REGRESSED?           */
@RF01089 LR    @05,M1IX1                                           1093
         SLA   @05,3                                               1093
         L     @15,@PC00015                                        1093
         L     @01,ICTMICHN(,@15)                                  1093
         ALR   @01,@05                                             1093
         BCTR  @01,0                                               1093
         TM    ICTMIDRG-7(@01),B'00001000'                         1093
         BNO   @RF01093                                            1093
*               DO;                 /* YES                           */
*                 M1CRMASM=ON;      /* SET INTERNAL CDS RMID       1095
*                                      REGRESSION FLG                */
         OI    M1CRMASM,B'00000010'                                1095
*               END;                /*                               */
*           END;                                                   1097
*         ELSE                      /* UMID                          */
*           DO;                                                    1098
         B     @RC01085                                            1098
@RF01085 DS    0H                                                  1099
*             M1CUMID=ON;           /* ATLEAST ONE CDS UMID EXISTS   */
         OI    M1CUMID,B'00100000'                                 1099
*           END;                                                   1100
*       END;                                                       1101
@RC01085 DS    0H                                                  1102
*   END;                                                           1102
*                                                                  1102
@RC01079 AH    M1IX1,@CH00064                                      1102
@DE01078 LR    @05,M1IX1                                           1102
         SLA   @05,3                                               1102
         L     @15,@PC00015                                        1102
         L     @01,ICTMICHN(,@15)                                  1102
         AL    @01,@CF02695                                        1102
         L     @05,ICTMIDND(@05,@01)                               1102
         CL    @05,ICTENDIX                                        1102
         BE    @DC01078                                            1102
         CH    MOD1RC,@CH00033                                     1102
         BL    @DL01078                                            1102
@DC01078 DS    0H                                                  1103
*   /*****************************************************************/
*   /*                                                               */
*   /* FIND THE ACDS FMID AND RMID, IF ANY                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1103
*   RFY                                                            1103
*     ICTMIDLS BASED(ICTMICHA(1));  /* ACDS MODID CHAIN              */
*   DO M1IX2=1 BY 1                 /* SEARCH ACDS MODID LIST FOR CDS
*                                      MODID                         */
*         WHILE(ICTMIDND(M1IX2)^=ICTENDIX/*                          */
*         &MOD1RC<STOPFUNC);                                       1104
         LA    M1IX2,1                                             1104
         B     @DE01104                                            1104
@DL01104 DS    0H                                                  1105
*     IF ICTMIDTY(M1IX2)=ICTMIDFM THEN/* IS THE TYPE FMID?           */
         LR    @05,M1IX2                                           1105
         SLA   @05,3                                               1105
         L     @15,@PC00015                                        1105
         L     @15,ICTMICHA(,@15)                                  1105
         ST    @05,@TF00001                                        1105
         ALR   @05,@15                                             1105
         BCTR  @05,0                                               1105
         TM    ICTMIDTY-7(@05),B'00000010'                         1105
         BNO   @RF01105                                            1105
         TM    ICTMIDTY-7(@05),B'00000001'                         1105
         BNZ   @RF01105                                            1105
*       DO;                         /* YES,                          */
*         MOD1ACF@=ADDR(M1IAMID);   /* SAVE ACDS FMID VALUE          */
         L     @05,@TF00001                                        1107
         AL    @15,@CF02695                                        1107
         LA    @05,ICTMODID(@05,@15)                               1107
         ST    @05,MOD1ACF@                                        1107
*         M1AFMFND=ON;              /* ACDS FMID FOUND               */
         OI    M1AFMFND,B'01000000'                                1108
*       END;                                                       1109
*     ELSE                          /*                               */
*       DO;                                                        1110
         B     @RC01105                                            1110
@RF01105 DS    0H                                                  1111
*         IF ICTMIDTY(M1IX2)=ICTMIDRM THEN/* IS THE TYPE RMID?       */
         LR    @05,M1IX2                                           1111
         SLA   @05,3                                               1111
         L     @15,@PC00015                                        1111
         L     @15,ICTMICHA(,@15)                                  1111
         ST    @05,@TF00001                                        1111
         ALR   @05,@15                                             1111
         BCTR  @05,0                                               1111
         TM    ICTMIDTY-7(@05),B'00000001'                         1111
         BNO   @RF01111                                            1111
         TM    ICTMIDTY-7(@05),B'00000010'                         1111
         BNZ   @RF01111                                            1111
*           DO;                     /* YES,                          */
*             MOD1ACR@=ADDR(M1IAMID);/* SAVE ACDS RMID VALUE         */
         L     @05,@TF00001                                        1113
         AL    @05,@CF02695                                        1113
         LA    @05,ICTMODID(@05,@15)                               1113
         ST    @05,MOD1ACR@                                        1113
*             M1ARMFND=ON;          /* ACDS RMID FOUND               */
         OI    M1ARMFND,B'01000000'                                1114
*             IF ICTMIDAM(M1IX2)=ON THEN/* RMID RESULT OF ASSEMBLY?  */
         AL    @15,@TF00001                                        1115
         BCTR  @15,0                                               1115
         TM    ICTMIDAM-7(@15),B'00000100'                         1115
         BNO   @RF01115                                            1115
*               DO;                 /* YES                           */
*                 M1ARMASM=ON;      /* SET INTERNAL ACDS RMID ASSEM
*                                      FLAG                          */
         OI    M1ARMASM,B'00000001'                                1117
*               END;                /*                               */
*             IF ICTMIDRG(M1IX2)=ON THEN/* RMID REGRESSED?           */
@RF01115 LR    @05,M1IX2                                           1119
         SLA   @05,3                                               1119
         L     @15,@PC00015                                        1119
         L     @01,ICTMICHA(,@15)                                  1119
         ALR   @01,@05                                             1119
         BCTR  @01,0                                               1119
         TM    ICTMIDRG-7(@01),B'00001000'                         1119
         BNO   @RF01119                                            1119
*               DO;                 /* YES                           */
*                 M1ARMASM=ON;      /* SET INTERNAL ACDS RMID      1121
*                                      REGRESSION FLG                */
         OI    M1ARMASM,B'00000001'                                1121
*               END;                /*                               */
*           END;                                                   1123
*         ELSE                      /* UMID                          */
*           DO;                                                    1124
         B     @RC01111                                            1124
@RF01111 DS    0H                                                  1125
*             M1AUMID=ON;           /* ATLEAST ONE ACDS UMID EXISTS  */
         OI    M1AUMID,B'00010000'                                 1125
*           END;                                                   1126
*       END;                                                       1127
@RC01111 DS    0H                                                  1128
*   END;                                                           1128
@RC01105 AH    M1IX2,@CH00064                                      1128
@DE01104 LR    @05,M1IX2                                           1128
         SLA   @05,3                                               1128
         L     @15,@PC00015                                        1128
         L     @01,ICTMICHA(,@15)                                  1128
         AL    @01,@CF02695                                        1128
         L     @05,ICTMIDND(@05,@01)                               1128
         CL    @05,ICTENDIX                                        1128
         BE    @DC01104                                            1128
         CH    MOD1RC,@CH00033                                     1128
         BL    @DL01104                                            1128
@DC01104 DS    0H                                                  1129
*   IF M1CFMFND=ON                  /* BOTH CDS AND ACDS FMID FOUND? */
*       &M1AFMFND=ON THEN           /*                               */
         TM    M1CFMFND,B'11000000'                                1129
         BNO   @RF01129                                            1129
*     DO;                           /* YES,                          */
*       IF M1CFMID=M1AFMID THEN     /* SAME FMID ON CDS AND ACDS?    */
         L     @05,MOD1CDF@                                        1131
         L     @02,MOD1ACF@                                        1131
         CLC   M1CFMID(7,@05),M1AFMID(@02)                         1131
         BNE   @RF01131                                            1131
*         DO;                       /* YES,                          */
*           M1FMIDEQ=ON;            /* CDS AND ACDS HAVE SAME FMID   */
         OI    M1FMIDEQ,B'00100000'                                1133
*         END;                      /*                               */
*       ELSE                                                       1135
*         ;                         /*                               */
@RF01131 DS    0H                                                  1136
*     END;                          /*                               */
*   ELSE                            /* EITHER CDS OR ACDS OR BOTH ARE
*                                      NOT PRESENT                   */
*     DO;                                                          1137
         B     @RC01129                                            1137
@RF01129 DS    0H                                                  1138
*       IF M1CFMFND=OFF             /* NIETHER FMID?                 */
*           &M1AFMFND=OFF THEN      /*                               */
         TM    M1CFMFND,B'11000000'                                1138
         BNZ   @RF01138                                            1138
*         DO;                       /* YES,                          */
*           M1FMIDCK=OFF;           /* NO FMID CHECKING IS NEEDED    */
         NI    M1FMIDCK,B'01111111'                                1140
*           M1FMIDEQ=ON;            /* TREAT NULLS AS EQUAL          */
         OI    M1FMIDEQ,B'00100000'                                1141
*         END;                                                     1142
*     END;                                                         1143
@RF01138 DS    0H                                                  1144
*   IF M1CRMFND=ON                  /* BOTH CDS AND ACDS RMID FOUND? */
*       &M1ARMFND=ON THEN           /*                               */
@RC01129 TM    M1CRMFND,B'11000000'                                1144
         BNO   @RF01144                                            1144
*     DO;                           /* YES,                          */
*       IF M1CRMID=M1ARMID THEN     /* SAME RMID ON CDS AND ACDS?    */
         L     @05,MOD1CDR@                                        1146
         L     @02,MOD1ACR@                                        1146
         CLC   M1CRMID(7,@05),M1ARMID(@02)                         1146
         BNE   @RF01146                                            1146
*         DO;                       /* YES,                          */
*           M1RMIDEQ=ON;            /* CDS AND ACDS HAVE SAME RMID   */
         OI    M1RMIDEQ,B'00100000'                                1148
*         END;                      /*                               */
*       ELSE                                                       1150
*         ;                         /*                               */
@RF01146 DS    0H                                                  1151
*     END;                          /*                               */
*   ELSE                            /* EITHER CDS OR ACDS OR BOTH ARE
*                                      NOT PRESENT                   */
*     DO;                                                          1152
         B     @RC01144                                            1152
@RF01144 DS    0H                                                  1153
*       IF M1CRMFND=OFF             /* NIETHER RMID?                 */
*           &M1ARMFND=OFF THEN      /*                               */
         TM    M1CRMFND,B'11000000'                                1153
         BNZ   @RF01153                                            1153
*         DO;                       /* YES,                          */
*           M1RMIDEQ=ON;            /* TREAT NULLS AS EQUAL          */
         OI    M1RMIDEQ,B'00100000'                                1155
*         END;                                                     1156
*     END;                                                         1157
@RF01153 DS    0H                                                  1158
*   IF M1CFMFND=ON                  /* BOTH CDS FMID AND RMID FOUND? */
*       &M1CRMFND=ON THEN           /*                               */
@RC01144 TM    M1CFMFND,B'10000000'                                1158
         BNO   @RF01158                                            1158
         TM    M1CRMFND,B'10000000'                                1158
         BNO   @RF01158                                            1158
*     DO;                           /* YES,                          */
*       IF M1CFMID=M1CRMID THEN     /* CDS FMID EQUAL RMID?          */
         L     @05,MOD1CDF@                                        1160
         L     @02,MOD1CDR@                                        1160
         CLC   M1CFMID(7,@05),M1CRMID(@02)                         1160
         BNE   @RF01160                                            1160
*         DO;                       /* YES,                          */
*           M1CFMERM=ON;            /* CDS FMID EQUAL RMID           */
         OI    M1CFMERM,B'00001000'                                1162
*         END;                                                     1163
*     END;                          /*                               */
*   ELSE                                                           1165
*     ;                             /*                               */
@RF01158 DS    0H                                                  1166
*   IF M1AFMFND=ON                  /* BOTH ACDS FMID AND RMID FOUND?*/
*       &M1ARMFND=ON THEN           /*                               */
@RC01158 TM    M1AFMFND,B'01000000'                                1166
         BNO   @RF01166                                            1166
         TM    M1ARMFND,B'01000000'                                1166
         BNO   @RF01166                                            1166
*     DO;                           /* YES,                          */
*       IF M1AFMID=M1ARMID THEN     /* ACDS FMID EQUAL RMID?         */
         L     @05,MOD1ACF@                                        1168
         L     @02,MOD1ACR@                                        1168
         CLC   M1AFMID(7,@05),M1ARMID(@02)                         1168
         BNE   @RF01168                                            1168
*         DO;                       /* YES,                          */
*           M1AFMERM=ON;            /* ACDS FMID EQUAL RMID          */
         OI    M1AFMERM,B'00000100'                                1170
*         END;                                                     1171
*     END;                          /*                               */
*   ELSE                                                           1173
*     ;                             /*                               */
@RF01166 DS    0H                                                  1174
*   RFY                                                            1174
*     ICTMIDLS BASED;                                              1174
@RC01166 DS    0H                                                  1175
*   RETURN CODE(M1IRC);                                            1175
         LR    @15,M1IRC                                           1175
         L     @14,12(,@13)                                        1175
         LM    @00,@12,20(@13)                                     1175
         BR    @14                                                 1175
*   END M1INIT;                     /*                               */
         EJECT
*                                                                  1177
*   /*****************************************************************/
*   /*                                                               */
*   /* M1FMID -                                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1177
*M1FMID:                                                           1177
*   PROC;                                                          1177
M1FMID   STM   @14,@12,@SA00017                                    1177
*   DCL                                                            1178
*     M1FRC FIXED(15);              /* LOCAL RETURN CODE             */
*   DCL                                                            1179
*     M1FAANS CHAR(1);              /* ANSWER FOR ACDS MODID LIST  1179
*                                      ENTRY                         */
*   DCL                                                            1180
*     M1FAPART FIXED(31);           /* MESSAGE PART FOR ACDS MODID 1180
*                                      LIST ENTRY                    */
*   DCL                                                            1181
*     M1FCANS CHAR(1);              /* ANSWER FOR CDS MODID LIST   1181
*                                      ENTRY                         */
*   DCL                                                            1182
*     M1FCPART FIXED(31);           /* MESSAGE PART FOR CDS MODID  1182
*                                      LIST ENTRY                    */
*   DCL                                                            1183
*     M1FCICT@ PTR(31);             /* CDS FMID ICT SYSMOD ENTRY PTR
*                                      IF BEING RESTORED             */
*   M1FRC=ZERO;                     /* CLEAR RETURN CODE             */
         SLR   M1FRC,M1FRC                                         1184
*                                                                  1185
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE STATUS OF CDS FMID                                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1185
*   IF M1CFMFND=ON THEN             /* CDS FMID                      */
         TM    M1CFMFND,B'10000000'                                1185
         BNO   @RF01185                                            1185
*     DO;                           /* YES,                          */
*       CALL M1CDS(M1CFMID,         /* FMID NAME                     */
*           M1FCANS,M1FCPART,       /* ANSWER                        */
*           M1FCICT@);              /* ICT SYSMOD PTR IF BEING     1187
*                                      RESOTRED                      */
         MVC   @AL00001+4(12),@AL01187                             1187
         L     @02,MOD1CDF@                                        1187
         ST    @02,@AL00001                                        1187
         LA    @01,@AL00001                                        1187
         BAL   @14,M1CDS                                           1187
*       RFY                                                        1188
*         RTNCODE RSTD;                                            1188
*       M1FRC=MAX(M1FRC,RTNCODE);   /* SAVE THE RETURN CODE          */
         CR    M1FRC,RTNCODE                                       1189
         BNL   *+6
         LR    M1FRC,RTNCODE                                       1189
*       IF RTNCODE=ZERO             /* ALL IS WELL?                  */
*           &M1FCANS=NO THEN        /* AND FMID IS BAD?              */
         LTR   RTNCODE,RTNCODE                                     1190
         BNZ   @RF01190                                            1190
         CLI   M1FCANS,C'N'                                        1190
         BNE   @RF01190                                            1190
*         DO;                                                      1191
*           RFY                                                    1192
*             RTNCODE UNRSTD;                                      1192
*           MOD1DONE=ON;            /* ALL MODID PROCESSING DONE FOR
*                                      ELEMENT                       */
*           MOD1ERR=ON;             /* MODID ERROR FOUND             */
         OI    MOD1DONE,B'11000000'                                1194
*           CALL M1MSG(TXTFMID,     /* 'FMID'                        */
*               M1FCPART,           /* PART NUMBER                   */
*               M1CFMID,            /* FMID NAME                     */
*               CCADSIDA(IOPCDS));  /* 'SMPCDS'                      */
         LA    @02,@CC02060                                        1195
         ST    @02,@AL00001                                        1195
         LA    @02,M1FCPART                                        1195
         ST    @02,@AL00001+4                                      1195
         L     @02,MOD1CDF@                                        1195
         ST    @02,@AL00001+8                                      1195
         L     @02,CCADSAD(,CCAPTR)                                1195
         LA    @02,CCADSIDA+8(,@02)                                1195
         ST    @02,@AL00001+12                                     1195
         LA    @01,@AL00001                                        1195
         BAL   @14,M1MSG                                           1195
*           RFY                                                    1196
*             RTNCODE RSTD;                                        1196
*           M1FRC=MAX(M1FRC,RTNCODE);/* SAVE MAX RC                  */
         CR    M1FRC,RTNCODE                                       1197
         BNL   *+6
         LR    M1FRC,RTNCODE                                       1197
*           RFY                                                    1198
*             RTNCODE UNRSTD;                                      1198
*         END;                                                     1199
*     END;                                                         1200
*                                                                  1200
@RF01190 DS    0H                                                  1201
*   /*****************************************************************/
*   /*                                                               */
*   /* DETERMINE STATUS OF ACDS FMID                                 */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1201
*   IF M1AFMFND=ON THEN             /* AND ACDS FMID?                */
@RF01185 TM    M1AFMFND,B'01000000'                                1201
         BNO   @RF01201                                            1201
*     DO;                           /* YES,                          */
*       CALL M1ACDS(M1AFMID,        /* FMID NAME                     */
*           M1FAANS,M1FAPART);      /* ANSWER                        */
         MVC   @AL00001+4(8),@AL01203                              1203
         L     @02,MOD1ACF@                                        1203
         ST    @02,@AL00001                                        1203
         LA    @01,@AL00001                                        1203
         BAL   @14,M1ACDS                                          1203
*       RFY                                                        1204
*         RTNCODE RSTD;                                            1204
*       M1FRC=MAX(M1FRC,RTNCODE);   /* SAVE THE RETURN CODE          */
         CR    M1FRC,RTNCODE                                       1205
         BNL   *+6
         LR    M1FRC,RTNCODE                                       1205
*       IF RTNCODE=ZERO             /* ALL IS WELL?                  */
*           &M1FAANS=NO THEN        /* AND FMID IS BAD?              */
         LTR   RTNCODE,RTNCODE                                     1206
         BNZ   @RF01206                                            1206
         CLI   M1FAANS,C'N'                                        1206
         BNE   @RF01206                                            1206
*         DO;                                                      1207
*           RFY                                                    1208
*             RTNCODE UNRSTD;                                      1208
*           MOD1DONE=ON;            /* ALL MODID PROCESSING DONE FOR
*                                      ELEMENT                       */
*           MOD1ERR=ON;             /* MODID ERROR FOUND             */
         OI    MOD1DONE,B'11000000'                                1210
*           CALL M1MSG(TXTFMID,     /* 'FMID'                        */
*               M1FAPART,           /* PART NUMBER                   */
*               M1AFMID,            /* FMID NAME                     */
*               CCADSIDA(IOPACDS)); /* 'SMPACDS'                     */
         LA    @02,@CC02060                                        1211
         ST    @02,@AL00001                                        1211
         LA    @02,M1FAPART                                        1211
         ST    @02,@AL00001+4                                      1211
         L     @02,MOD1ACF@                                        1211
         ST    @02,@AL00001+8                                      1211
         L     @02,CCADSAD(,CCAPTR)                                1211
         LA    @02,CCADSIDA+88(,@02)                               1211
         ST    @02,@AL00001+12                                     1211
         LA    @01,@AL00001                                        1211
         BAL   @14,M1MSG                                           1211
*           RFY                                                    1212
*             RTNCODE RSTD;                                        1212
*           M1FRC=MAX(M1FRC,RTNCODE);/* SAVE MAX RC                  */
         CR    M1FRC,RTNCODE                                       1213
         BNL   *+6
         LR    M1FRC,RTNCODE                                       1213
*           RFY                                                    1214
*             RTNCODE UNRSTD;                                      1214
*         END;                                                     1215
*     END;                                                         1216
@RF01206 DS    0H                                                  1217
*   IF M1FRC<STOPSMD                /* RC OK ...                     */
*       &MOD1DONE=OFF THEN          /* AND NOT DONE?                 */
@RF01201 CH    M1FRC,@CH00034                                      1217
         BNL   @RF01217                                            1217
         TM    MOD1DONE,B'10000000'                                1217
         BNZ   @RF01217                                            1217
*     DO;                           /* YES,                          */
*                                                                  1218
*       /*************************************************************/
*       /*                                                           */
*       /* NEITHER CDS NOR ACDS FMID IS PRESENT                      */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1219
*       IF(M1CFMFND=OFF             /* NEITHER ACDS NOR CDS FMID?    */
*           &M1AFMFND=OFF) THEN     /* ...                           */
         TM    M1CFMFND,B'11000000'                                1219
         BNZ   @RF01219                                            1219
*         DO;                       /* YES, ASSUME THAT FMID'S ARE 1220
*                                      EQUAL AND OK BUT THAT RMID AND
*                                      UMID CHECKING IS STILL      1220
*                                      REQUIRED                      */
*           MOD1DONE=OFF;           /* CONTINUE CHECKING             */
         NI    MOD1DONE,B'01111111'                                1221
*         END;                                                     1222
*                                                                  1222
*       /*************************************************************/
*       /*                                                           */
*       /* CDS AND ACDS FMID ARE PRESENT                             */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1223
*       IF(M1CFMFND=ON              /* CDS FMID                      */
*           &M1AFMFND=ON) THEN      /* AND ACDS FMID?                */
@RF01219 TM    M1CFMFND,B'11000000'                                1223
         BNO   @RF01223                                            1223
*         DO;                       /* YES,                          */
*           IF M1CFMID^=            /* ARE THE FMID'S DIFFERENT?     */
*               M1AFMID THEN                                       1225
         L     @02,MOD1CDF@                                        1225
         L     @01,MOD1ACF@                                        1225
         CLC   M1CFMID(7,@02),M1AFMID(@01)                         1225
         BE    @RF01225                                            1225
*             DO;                   /* YES,                          */
*               IF M1FCANS=RESTORE THEN/* CDS FMID BEING RESTORED?   */
         CLI   M1FCANS,C'R'                                        1227
         BNE   @RF01227                                            1227
*                 DO;               /* YES,                          */
*                   M1CRMRST=ON;    /* MUST ALSO BE RESTORING RMID   */
*                   M1CUMRST=ON;    /* ... AND UMID'S                */
         OI    M1CRMRST,B'00001100'                                1230
*                 END;                                             1231
*               ELSE                /* CDS FMID NOT BEING RESTORE AND
*                                      NOT EQUAL ACDS FMID           */
*                 DO;                                              1232
         B     @RC01227                                            1232
@RF01227 DS    0H                                                  1233
*                   CALL VRSCHECK(M1CFMID,ICTMOD(1),M1FCANS);      1233
         L     @02,MOD1CDF@                                        1233
         ST    @02,@AL00001                                        1233
         L     @02,@PC00015                                        1233
         ST    @02,@AL00001+4                                      1233
         LA    @02,M1FCANS                                         1233
         ST    @02,@AL00001+8                                      1233
         LA    @01,@AL00001                                        1233
         BAL   @14,VRSCHECK                                        1233
*                   IF M1FCANS=NO THEN/* NOT THE RESULT OF         1234
*                                      VERSIONING?                   */
         CLI   M1FCANS,C'N'                                        1234
         BNE   @RF01234                                            1234
*                     DO;           /* YES, ISSUE ERROR MESSAGE      */
*                       CALL M1MSG(TXTFMID,/* 'FMID'                 */
*                           PART127,/* PART NUMBER                   */
*                           M1CFMID,/* FMID NAME                     */
*                           CCADSIDA(IOPCDS));/* 'SMPCDS'            */
         LA    @02,@CC02060                                        1236
         ST    @02,@AL00001                                        1236
         LA    @02,@CF02054                                        1236
         ST    @02,@AL00001+4                                      1236
         L     @02,MOD1CDF@                                        1236
         ST    @02,@AL00001+8                                      1236
         L     @02,CCADSAD(,CCAPTR)                                1236
         LA    @02,CCADSIDA+8(,@02)                                1236
         ST    @02,@AL00001+12                                     1236
         LA    @01,@AL00001                                        1236
         BAL   @14,M1MSG                                           1236
*                       RFY                                        1237
*                         RTNCODE RSTD;                            1237
*                       M1FRC=MAX(M1FRC,RTNCODE);/* SAVE MAX RC      */
         CR    M1FRC,RTNCODE                                       1238
         BNL   *+6
         LR    M1FRC,RTNCODE                                       1238
*                       RFY                                        1239
*                         RTNCODE UNRSTD;                          1239
*                     END;          /*                               */
*                   ELSE                                           1241
*                     ;             /* MODID NOT FOUND BECAUSE OF  1241
*                                      VERSIONING                    */
@RF01234 DS    0H                                                  1242
*                 END;              /*                               */
*             END;                                                 1243
*           ELSE                    /* FMID FOR CDS EQUALS THAT FOR
*                                      ACDS                          */
*             DO;                                                  1244
         B     @RC01225                                            1244
@RF01225 DS    0H                                                  1245
*               MOD1DONE=OFF;       /* MODID CHECKING IS NOT DONE  1245
*                                      SINCE BOTH CDS AND ACDS     1245
*                                      REPRESENT THE SAME SERVICE  1245
*                                      CHAIN                         */
         NI    MOD1DONE,B'01111111'                                1245
*             END;                                                 1246
*         END;                                                     1247
*                                                                  1247
@RC01225 DS    0H                                                  1248
*       /*************************************************************/
*       /*                                                           */
*       /* ACDS FMID, BUT NOT CDS FMID, IS PRESENT. THIS IS AN ERROR */
*       /* AND A MESSAGE IS ISSUED                                   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1248
*       IF(M1CFMFND=OFF             /* CDS FMID NOT PRESENT          */
*           &M1AFMFND=ON) THEN      /* AND ACDS FMID PRESENT?        */
@RF01223 TM    M1AFMFND,B'01000000'                                1248
         BNO   @RF01248                                            1248
         TM    M1CFMFND,B'10000000'                                1248
         BNZ   @RF01248                                            1248
*         DO;                       /* YES,                          */
*           MOD1ERR=ON;             /* MODID ERROR SINCE FMID IS   1250
*                                      ACCEPTED BUT NOT APPLIED      */
*           MOD1DONE=ON;            /* NO FURTHER CHECKING SINCE   1251
*                                      FMID'S CAUSING ERROR REPRESENT
*                                      DIFFERENT SERVICE CHAINS      */
         OI    MOD1ERR,B'11000000'                                 1251
*           CALL M1MSG(TXTFMID,     /* 'FMID'                        */
*               PART129,            /* PART NUMBER                   */
*               M1AFMID,            /* FMID NAME                     */
*               CCADSIDA(IOPACDS)); /* 'SMPACDS'                     */
         LA    @02,@CC02060                                        1252
         ST    @02,@AL00001                                        1252
         LA    @02,@CF02058                                        1252
         ST    @02,@AL00001+4                                      1252
         L     @02,MOD1ACF@                                        1252
         ST    @02,@AL00001+8                                      1252
         L     @02,CCADSAD(,CCAPTR)                                1252
         LA    @02,CCADSIDA+88(,@02)                               1252
         ST    @02,@AL00001+12                                     1252
         LA    @01,@AL00001                                        1252
         BAL   @14,M1MSG                                           1252
*           RFY                                                    1253
*             RTNCODE RSTD;                                        1253
*           M1FRC=MAX(M1FRC,RTNCODE);/* SAVE MAX RC                  */
         CR    M1FRC,RTNCODE                                       1254
         BNL   *+6
         LR    M1FRC,RTNCODE                                       1254
*           RFY                                                    1255
*             RTNCODE UNRSTD;                                      1255
*         END;                                                     1256
*                                                                  1256
*       /*************************************************************/
*       /*                                                           */
*       /* CDS FMID, BUT NOT ACDS FMID, IS PRESENT                   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1257
*       IF(M1CFMFND=ON              /* CDS FMID PRESENT              */
*           &M1AFMFND=OFF) THEN     /* AND ACDS FMID NOT PRESENT?    */
@RF01248 TM    M1CFMFND,B'10000000'                                1257
         BNO   @RF01257                                            1257
         TM    M1AFMFND,B'01000000'                                1257
         BNZ   @RF01257                                            1257
*         DO;                       /* YES,                          */
*           M1CRMRST=ON;            /* MUST BE RESTORING RMID AND ...*/
*           M1CUMRST=ON;            /* ... AND UMID'S                */
         OI    M1CRMRST,B'00001100'                                1260
*           IF M1FCANS^=RESTORE     /* CDS FMID NOT BEING RESTORED...*/
*               &M1CRMASM=OFF THEN  /* ... AND NOT THE RESULT OF AN
*                                      ASSEM?                        */
         CLI   M1FCANS,C'R'                                        1261
         BE    @RF01261                                            1261
         TM    M1CRMASM,B'00000010'                                1261
         BNZ   @RF01261                                            1261
*             DO;                   /* YES,                          */
*               MOD1ERR=ON;         /* ERROR SINCE CDS FMID IS NOT 1263
*                                      BEING RESTORED                */
         OI    MOD1ERR,B'01000000'                                 1263
*               IF MOD1DEL=ON THEN  /* IS MOD BEING DELETED?         */
         TM    MOD1DEL,B'00000010'                                 1264
         BNO   @RF01264                                            1264
*                 DO;               /*                               */
*                   CALL VRSCHECK(M1CFMID,ICTMOD(1),M1FCANS);      1266
         L     @02,MOD1CDF@                                        1266
         ST    @02,@AL00001                                        1266
         L     @02,@PC00015                                        1266
         ST    @02,@AL00001+4                                      1266
         LA    @02,M1FCANS                                         1266
         ST    @02,@AL00001+8                                      1266
         LA    @01,@AL00001                                        1266
         BAL   @14,VRSCHECK                                        1266
*                   IF M1FCANS=YES THEN/* THE RESULT OF VERSIONING?  */
         CLI   M1FCANS,C'Y'                                        1267
         BNE   @RF01267                                            1267
*                     DO;           /* YES,                          */
*                       MOD1ERR=OFF;/* NOT AN ERROR                  */
         NI    MOD1ERR,B'10111111'                                 1269
*                     END;                                         1270
*                 END;                                             1271
@RF01267 DS    0H                                                  1272
*               IF MOD1ERR=ON THEN  /* ERROR?                        */
@RF01264 TM    MOD1ERR,B'01000000'                                 1272
         BNO   @RF01272                                            1272
*                 DO;               /*                               */
*                   MOD1DONE=ON;    /* NO FURTHER CHECKING           */
         OI    MOD1DONE,B'10000000'                                1274
*                   CALL M1MSG(TXTFMID,/* 'FMID'                     */
*                       PART127,    /* PART NUMBER                   */
*                       M1CFMID,    /* FMID NAME                     */
*                       CCADSIDA(IOPCDS));/* 'SMPCDS'                */
         LA    @02,@CC02060                                        1275
         ST    @02,@AL00001                                        1275
         LA    @02,@CF02054                                        1275
         ST    @02,@AL00001+4                                      1275
         L     @02,MOD1CDF@                                        1275
         ST    @02,@AL00001+8                                      1275
         L     @02,CCADSAD(,CCAPTR)                                1275
         LA    @02,CCADSIDA+8(,@02)                                1275
         ST    @02,@AL00001+12                                     1275
         LA    @01,@AL00001                                        1275
         BAL   @14,M1MSG                                           1275
*                   RFY                                            1276
*                     RTNCODE RSTD;                                1276
*                   M1FRC=MAX(M1FRC,RTNCODE);/* SAVE MAX RC          */
         CR    M1FRC,RTNCODE                                       1277
         BNL   *+6
         LR    M1FRC,RTNCODE                                       1277
*                   RFY                                            1278
*                     RTNCODE UNRSTD;                              1278
*                 END;                                             1279
*             END;                                                 1280
*           ELSE                                                   1281
*             ;                     /* SYSMOD IS BEING RESTORED      */
@RF01261 DS    0H                                                  1282
*         END;                                                     1282
@RC01261 DS    0H                                                  1283
*     END;                                                         1283
@RF01257 DS    0H                                                  1284
*   IF M1FRC<STOPSMD                /* NO FAILING ERROR ...          */
*       &M1CFMFND=ON THEN           /* ... AND THERE IS A CDS FMID?  */
@RF01217 CH    M1FRC,@CH00034                                      1284
         BNL   @RF01284                                            1284
         TM    M1CFMFND,B'10000000'                                1284
         BNO   @RF01284                                            1284
*     DO;                           /* YES,                          */
*       RFY                                                        1286
*         ICTMOD BASED(ADDR(MOD1ENT));                             1286
*       CALL M1PRECK(M1FCICT@,      /* CALL PRE CHECK TO SET ACDS ID
*                                      IS RELATED FLAG               */
*           ICTMICHA(1),            /*                               */
*           M1FCANS,                /*                               */
*           M1FCPART);              /*                               */
         MVC   @AL00001(16),@AL01287                               1287
         L     @02,@PC00015                                        1287
         LA    @02,ICTMICHA(,@02)                                  1287
         ST    @02,@AL00001+4                                      1287
         LA    @01,@AL00001                                        1287
         BAL   @14,M1PRECK                                         1287
*       RFY                                                        1288
*         RTNCODE RSTD;                                            1288
*       M1FRC=MAX(M1FRC,RTNCODE);   /* SAVE MAX RC                   */
         CR    M1FRC,RTNCODE                                       1289
         BNL   *+6
         LR    M1FRC,RTNCODE                                       1289
*       RFY                                                        1290
*         RTNCODE UNRSTD;                                          1290
*       RFY                                                        1291
*         ICTMOD BASED;                                            1291
*     END;                          /*                               */
*   RETURN CODE(M1FRC);             /* RETURN W/ RETURN CODE         */
@RF01284 LR    @15,M1FRC                                           1293
         L     @14,@SA00017                                        1293
         LM    @00,@12,@SA00017+8                                  1293
         BR    @14                                                 1293
*   END M1FMID;                                                    1294
         EJECT
*                                                                  1295
*   /*****************************************************************/
*   /*                                                               */
*   /* M1RMID -                                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1295
*M1RMID:                                                           1295
*   PROC;                                                          1295
M1RMID   STM   @14,@12,@SA00018                                    1295
*   DCL                                                            1296
*     M1RRC FIXED(15);              /* LOCAL RETURN CODE             */
*   DCL                                                            1297
*     M1RAANS CHAR(1);              /* ANSWER FOR ACDS MODID LIST  1297
*                                      ENTRY                         */
*   DCL                                                            1298
*     M1RAPART FIXED(31);           /* MESSAGE PART FOR ACDS MODID 1298
*                                      LIST ENTRY                    */
*   DCL                                                            1299
*     M1RCANS CHAR(1);              /* ANSWER FOR CDS MODID LIST   1299
*                                      ENTRY                         */
*   DCL                                                            1300
*     M1RCPART FIXED(31);           /* MESSAGE PART FOR CDS MODID  1300
*                                      LIST ENTRY                    */
*   DCL                                                            1301
*     M1RCICT@ PTR(31);             /* ADDRESS OF ICT SYSMOD ENTRY IF
*                                      CDS RMID IS BEING RESTORED    */
*   RFY                                                            1302
*     TSLPARMS BASED(TBLXTSLP);                                    1302
*   RFY                                                            1303
*     ICTMOD BASED(ADDR(MOD1ENT));                                 1303
*   M1RRC=ZERO;                     /* CLEAR RETURN CODE             */
         SLR   M1RRC,M1RRC                                         1304
*                                                                  1305
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK THE STATUS OF THE CDS RMID                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1305
*   IF M1CRMFND=ON THEN             /* CDS RMID?                     */
         TM    M1CRMFND,B'10000000'                                1305
         BNO   @RF01305                                            1305
*     DO;                           /* YES,                          */
*       CALL M1CDS(M1CRMID,         /* RMID NAME                     */
*           M1RCANS,M1RCPART,       /* ANSWER                        */
*           M1RCICT@);              /* ADDRESS OF SYSMOD IF RETORING */
         MVC   @AL00001+4(12),@AL01307                             1307
         L     @02,MOD1CDR@                                        1307
         ST    @02,@AL00001                                        1307
         LA    @01,@AL00001                                        1307
         BAL   @14,M1CDS                                           1307
*       RFY                                                        1308
*         RTNCODE RSTD;                                            1308
*       M1RRC=MAX(M1RRC,RTNCODE);   /* SAVE THE RETURN CODE          */
         CR    M1RRC,RTNCODE                                       1309
         BNL   *+6
         LR    M1RRC,RTNCODE                                       1309
*       IF RTNCODE=ZERO             /* ALL IS WELL?                  */
*           &M1RCANS=NO THEN        /* AND RMID IS BAD?              */
         LTR   RTNCODE,RTNCODE                                     1310
         BNZ   @RF01310                                            1310
         CLI   M1RCANS,C'N'                                        1310
         BNE   @RF01310                                            1310
*         DO;                                                      1311
*           RFY                                                    1312
*             RTNCODE UNRSTD;                                      1312
*           MOD1DONE=ON;            /* ALL MODID PROCESSING DONE FOR
*                                      ELEMENT                       */
*           MOD1ERR=ON;             /* MODID ERROR FOUND             */
         OI    MOD1DONE,B'11000000'                                1314
*           CALL M1MSG(TXTRMID,     /* 'RMID'                        */
*               M1RCPART,           /* PART NUMBER                   */
*               M1CRMID,            /* RMID NAME                     */
*               CCADSIDA(IOPCDS));  /* 'SMPCDS'                      */
         LA    @02,@CC02062                                        1315
         ST    @02,@AL00001                                        1315
         LA    @02,M1RCPART                                        1315
         ST    @02,@AL00001+4                                      1315
         L     @02,MOD1CDR@                                        1315
         ST    @02,@AL00001+8                                      1315
         L     @02,CCADSAD(,CCAPTR)                                1315
         LA    @02,CCADSIDA+8(,@02)                                1315
         ST    @02,@AL00001+12                                     1315
         LA    @01,@AL00001                                        1315
         BAL   @14,M1MSG                                           1315
*           RFY                                                    1316
*             RTNCODE RSTD;                                        1316
*           M1RRC=MAX(M1RRC,RTNCODE);/* SAVE MAX RC                  */
         CR    M1RRC,RTNCODE                                       1317
         BNL   *+6
         LR    M1RRC,RTNCODE                                       1317
*           RFY                                                    1318
*             RTNCODE UNRSTD;                                      1318
*         END;                                                     1319
*       IF M1RRC=ZERO               /* ALL IS WELL?                  */
*           &M1RCANS=YES            /* AND RMID IS OK AND ^RESTORE   */
*           &M1CRMRST=ON            /* ... AND RMID SHOULD BE      1320
*                                      RESTORED                      */
*           &M1CRMASM=OFF THEN      /* ... AND NOT RESULT OF ASSEMBLY*/
@RF01310 LTR   M1RRC,M1RRC                                         1320
         BNZ   @RF01320                                            1320
         CLI   M1RCANS,C'Y'                                        1320
         BNE   @RF01320                                            1320
         TM    M1CRMRST,B'00001000'                                1320
         BNO   @RF01320                                            1320
         TM    M1CRMASM,B'00000010'                                1320
         BNZ   @RF01320                                            1320
*         DO;                       /* YES,                          */
*           MOD1DONE=ON;            /* ALL MODID PROCESSING DONE FOR
*                                      ELEMENT                       */
*           MOD1ERR=ON;             /* MODID ERROR FOUND             */
         OI    MOD1DONE,B'11000000'                                1323
*           CALL M1MSG(TXTRMID,     /* 'RMID'                        */
*               PART127,            /* PART NUMBER                   */
*               M1CRMID,            /* RMID NAME                     */
*               CCADSIDA(IOPCDS));  /* 'SMPCDS'                      */
         LA    @02,@CC02062                                        1324
         ST    @02,@AL00001                                        1324
         LA    @02,@CF02054                                        1324
         ST    @02,@AL00001+4                                      1324
         L     @02,MOD1CDR@                                        1324
         ST    @02,@AL00001+8                                      1324
         L     @02,CCADSAD(,CCAPTR)                                1324
         LA    @02,CCADSIDA+8(,@02)                                1324
         ST    @02,@AL00001+12                                     1324
         LA    @01,@AL00001                                        1324
         BAL   @14,M1MSG                                           1324
*           RFY                                                    1325
*             RTNCODE RSTD;                                        1325
*           M1RRC=MAX(M1RRC,RTNCODE);/* SAVE MAX RC                  */
         CR    M1RRC,RTNCODE                                       1326
         BNL   *+6
         LR    M1RRC,RTNCODE                                       1326
*           RFY                                                    1327
*             RTNCODE UNRSTD;                                      1327
*         END;                                                     1328
*     END;                                                         1329
*                                                                  1329
@RF01320 DS    0H                                                  1330
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK THE STATUS OF THE ACDS RMID                             */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1330
*   IF M1ARMFND=ON THEN             /* AND ACDS RMID?                */
@RF01305 TM    M1ARMFND,B'01000000'                                1330
         BNO   @RF01330                                            1330
*     DO;                           /* YES,                          */
*       CALL M1ACDS(M1ARMID,        /* RMID NAME                     */
*           M1RAANS,M1RAPART);      /* ANSWER                        */
         MVC   @AL00001+4(8),@AL01332                              1332
         L     @02,MOD1ACR@                                        1332
         ST    @02,@AL00001                                        1332
         LA    @01,@AL00001                                        1332
         BAL   @14,M1ACDS                                          1332
*       RFY                                                        1333
*         RTNCODE RSTD;                                            1333
*       M1RRC=MAX(M1RRC,RTNCODE);   /* SAVE THE RETURN CODE          */
         CR    M1RRC,RTNCODE                                       1334
         BNL   *+6
         LR    M1RRC,RTNCODE                                       1334
*       IF RTNCODE=ZERO             /* ALL IS WELL?                  */
*           &M1RAANS=NO THEN        /* AND RMID IS BAD?              */
         LTR   RTNCODE,RTNCODE                                     1335
         BNZ   @RF01335                                            1335
         CLI   M1RAANS,C'N'                                        1335
         BNE   @RF01335                                            1335
*         DO;                                                      1336
*           RFY                                                    1337
*             RTNCODE UNRSTD;                                      1337
*           MOD1DONE=ON;            /* ALL MODID PROCESSING DONE FOR
*                                      ELEMENT                       */
*           MOD1ERR=ON;             /* MODID ERROR FOUND             */
         OI    MOD1DONE,B'11000000'                                1339
*           CALL M1MSG(TXTRMID,     /* 'RMID'                        */
*               M1RAPART,           /* PART NUMBER                   */
*               M1ARMID,            /* RMID NAME                     */
*               CCADSIDA(IOPACDS)); /* 'SMPACDS'                     */
         LA    @02,@CC02062                                        1340
         ST    @02,@AL00001                                        1340
         LA    @02,M1RAPART                                        1340
         ST    @02,@AL00001+4                                      1340
         L     @02,MOD1ACR@                                        1340
         ST    @02,@AL00001+8                                      1340
         L     @02,CCADSAD(,CCAPTR)                                1340
         LA    @02,CCADSIDA+88(,@02)                               1340
         ST    @02,@AL00001+12                                     1340
         LA    @01,@AL00001                                        1340
         BAL   @14,M1MSG                                           1340
*           RFY                                                    1341
*             RTNCODE RSTD;                                        1341
*           M1RRC=MAX(M1RRC,RTNCODE);/* SAVE MAX RC                  */
         CR    M1RRC,RTNCODE                                       1342
         BNL   *+6
         LR    M1RRC,RTNCODE                                       1342
*           RFY                                                    1343
*             RTNCODE UNRSTD;                                      1343
*         END;                                                     1344
*     END;                                                         1345
@RF01335 DS    0H                                                  1346
*   IF(M1CRMFND=OFF                 /* NEITHER ACDS NOR CDS RMID?    */
*       &M1ARMFND=OFF) THEN         /* ...                           */
@RF01330 TM    M1CRMFND,B'11000000'                                1346
         BNZ   @RF01346                                            1346
*     DO;                           /* YES,                          */
*       MOD1DONE=ON;                /* HALT FURTHER PROCESSING SINCE
*                                      THERE SHOULD BE NO UMID'S     */
         OI    MOD1DONE,B'10000000'                                1348
*     END;                                                         1349
*   IF M1RRC<STOPSMD                /* RC OK ...                     */
*       &MOD1DONE=OFF THEN          /* AND NOT DONE?                 */
@RF01346 CH    M1RRC,@CH00034                                      1350
         BNL   @RF01350                                            1350
         TM    MOD1DONE,B'10000000'                                1350
         BNZ   @RF01350                                            1350
*     DO;                           /* YES,                          */
*       IF(M1CRMFND=ON              /* BOTH ACDS AND CDS RMID FOUND? */
*           &M1ARMFND=ON) THEN      /* ...                           */
         TM    M1CRMFND,B'11000000'                                1352
         BNO   @RF01352                                            1352
*         DO;                       /* YES,                          */
*           IF M1RMIDEQ^=ON THEN    /* CDS AND ACDS RMID UNEQUAL?    */
         TM    M1RMIDEQ,B'00100000'                                1354
         BO    @RF01354                                            1354
*             DO;                   /* YES,                          */
*               MOD1DONE=OFF;       /* CONTINUE CHEKING              */
*                                                                  1356
         NI    MOD1DONE,B'01111111'                                1356
*               /*****************************************************/
*               /*                                                   */
*               /* CHECK FOR PRE/SUP RELATIONSHIP                    */
*               /*                                                   */
*               /*****************************************************/
*                                                                  1357
*               IF M1CRMASM=OFF     /* CDS ...                       */
*                   &M1ARMASM=OFF THEN/* ... AND ACDS RMID NOT ASSEM?*/
         TM    M1CRMASM,B'00000011'                                1357
         BNZ   @RF01357                                            1357
*                 DO;               /* YES,                          */
*                   IF M1RCANS=RESTORE THEN/* CDS RMID BEING       1359
*                                      RESTORED?                     */
         CLI   M1RCANS,C'R'                                        1359
         BNE   @RF01359                                            1359
*                     DO;           /* YES,                          */
*                       IF M1FMIDEQ=ON THEN/* SHOULD PRE/SUP       1361
*                                      RELATIONSHIPS BE CHECKED?     */
         TM    M1FMIDEQ,B'00100000'                                1361
         BNO   @RF01361                                            1361
*                         DO;       /* YES,                          */
*                           CALL HMASMTPS(M1RCICT@,/* CDS RMID ICT 1363
*                                      SMD ENTRY PTR                 */
*                               M1ARMID,/* ACDS RMID                 */
*                               M1TPSANS);/* ANSWER                  */
         MVC   @AL00001(12),@AL01363                               1363
         L     @02,MOD1ACR@                                        1363
         ST    @02,@AL00001+4                                      1363
         L     @15,@CV02029                                        1363
         LA    @01,@AL00001                                        1363
         BALR  @14,@15                                             1363
*                           IF M1TPSANS=YES THEN/* FOUND?            */
         CLI   M1TPSANS,C'Y'                                       1364
         BNE   @RF01364                                            1364
*                             DO;   /* YES,                          */
*                               MOD1DONE=OFF;/* MODID CHECKING     1366
*                                      CONTINUES                     */
         NI    MOD1DONE,B'01111111'                                1366
*                             END;                                 1367
*                           ELSE    /* PRE/SUP RELATIONSHIP NOT FOUND*/
*                             DO;                                  1368
         B     @RC01364                                            1368
@RF01364 DS    0H                                                  1369
*                               CALL REGRCHK(CCAIOPTR->HMASMIOP,/*   */
*                                   M1ARMID,ICTMOD(1));            1369
         L     @02,CCAIOPTR(,CCAPTR)                               1369
         ST    @02,@AL00001                                        1369
         L     @02,MOD1ACR@                                        1369
         ST    @02,@AL00001+4                                      1369
         L     @02,@PC00015                                        1369
         ST    @02,@AL00001+8                                      1369
         LA    @01,@AL00001                                        1369
         BAL   @14,REGRCHK                                         1369
*                               RFY                                1370
*                                 RTNCODE RSTD;                    1370
*                               IF RTNCODE^=ZERO THEN/* NOT A      1371
*                                      REGRESSED ELEMENT             */
         LTR   RTNCODE,RTNCODE                                     1371
         BZ    @RF01371                                            1371
*                                 DO;/* YES, ISSUE ERROR MESSAGE     */
*                                   RFY                            1373
*                                     RTNCODE UNRSTD;              1373
*                                   CALL M1MSG(TXTRMID,/* 'RMID'     */
*                                       PART128,/* 'DOES NOT PRE/SUP
*                                      SMPACDS MODID'                */
*                                       M1CRMID,/* RMID NAME         */
*                                       CCADSIDA(IOPCDS));/* 'SMPCDS'*/
         LA    @02,@CC02062                                        1374
         ST    @02,@AL00001                                        1374
         LA    @02,@CF02056                                        1374
         ST    @02,@AL00001+4                                      1374
         L     @02,MOD1CDR@                                        1374
         ST    @02,@AL00001+8                                      1374
         L     @02,CCADSAD(,CCAPTR)                                1374
         LA    @02,CCADSIDA+8(,@02)                                1374
         ST    @02,@AL00001+12                                     1374
         LA    @01,@AL00001                                        1374
         BAL   @14,M1MSG                                           1374
*                                   RFY                            1375
*                                     RTNCODE RSTD;                1375
*                                   M1RRC=MAX(M1RRC,RTNCODE);/* SAVE
*                                      MAX RC                        */
         CR    M1RRC,RTNCODE                                       1376
         BNL   *+6
         LR    M1RRC,RTNCODE                                       1376
*                                   RFY                            1377
*                                     RTNCODE UNRSTD;              1377
*                                   MOD1DONE=ON;/* MODID CHECKING  1378
*                                      FINISHED ...                  */
*                                   MOD1ERR=ON;/* ... WITH AN ERROR  */
         OI    MOD1DONE,B'11000000'                                1379
*                                 END;                             1380
*                             END;                                 1381
*                         END;      /*                               */
*                       ELSE                                       1383
*                         ;         /* FMIDS NOT EQUAL               */
@RF01361 DS    0H                                                  1384
*                     END;          /*                               */
*                   ELSE            /* NOT BEING RESTORED            */
*                     DO;           /*                               */
         B     @RC01359                                            1385
@RF01359 DS    0H                                                  1386
*                       CALL M1MSG(TXTRMID,/* 'RMID'                 */
*                           PART127,/* 'IS NOT BEING RESTORED'       */
*                           M1CRMID,/* RMID NAME                     */
*                           CCADSIDA(IOPCDS));/* 'SMPCDS'            */
         LA    @02,@CC02062                                        1386
         ST    @02,@AL00001                                        1386
         LA    @02,@CF02054                                        1386
         ST    @02,@AL00001+4                                      1386
         L     @02,MOD1CDR@                                        1386
         ST    @02,@AL00001+8                                      1386
         L     @02,CCADSAD(,CCAPTR)                                1386
         LA    @02,CCADSIDA+8(,@02)                                1386
         ST    @02,@AL00001+12                                     1386
         LA    @01,@AL00001                                        1386
         BAL   @14,M1MSG                                           1386
*                       RFY                                        1387
*                         RTNCODE RSTD;                            1387
*                       M1RRC=MAX(M1RRC,RTNCODE);/* SAVE MAX RC      */
         CR    M1RRC,RTNCODE                                       1388
         BNL   *+6
         LR    M1RRC,RTNCODE                                       1388
*                       RFY                                        1389
*                         RTNCODE UNRSTD;                          1389
*                       MOD1DONE=ON;/* MODID CHECKING FINISHED ...   */
*                       MOD1ERR=ON; /* ... WITH AN ERROR             */
         OI    MOD1DONE,B'11000000'                                1391
*                     END;          /*                               */
*                 END;                                             1393
*               ELSE                                               1394
*                 ;                 /* CDS OR ACDS RMID RESULT OF  1394
*                                      ASSEMBLY                      */
@RF01357 DS    0H                                                  1395
*             END;                                                 1395
*           ELSE                    /* RMID FOR CDS EQUAL THAT FOR 1396
*                                      ACDS                          */
*             DO;                                                  1396
         B     @RC01354                                            1396
@RF01354 DS    0H                                                  1397
*               MOD1DONE=OFF;       /* MODID CHECKING IS TOBE DONE 1397
*                                      SINCE BOTH CDS AND ACDS     1397
*                                      REPRESENT THE SAME SERVICE  1397
*                                      CHAIN                         */
         NI    MOD1DONE,B'01111111'                                1397
*             END;                                                 1398
*         END;                                                     1399
*                                                                  1399
@RC01354 DS    0H                                                  1400
*       /*************************************************************/
*       /*                                                           */
*       /* ACDS RMID, BUT NOT CDS RMID PRESENT, IS AN ERROR. ISSUE AN*/
*       /* ERROR MESSAGE                                             */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1400
*       IF(M1CRMFND=OFF             /* CDS RMID NOT PRESENT          */
*           &M1ARMFND=ON            /* AND ACDS RMID PRESENT ...     */
*           &M1ARMASM^=ON) THEN     /* ... ANS ACDS RMID ^ ASSEM TYPE*/
@RF01352 TM    M1ARMFND,B'01000000'                                1400
         BNO   @RF01400                                            1400
         TM    M1CRMFND,B'10000001'                                1400
         BNZ   @RF01400                                            1400
*         DO;                       /* YES,                          */
*           MOD1DONE=ON;            /* NO FURTHER CHECKING SINCE   1402
*                                      MODID'S REPRESENT DIFFERENT 1402
*                                      SERVICE CHAINS                */
*           MOD1ERR=ON;             /* MODID ERROR SINCE RMID IS   1403
*                                      ACCEPTED BUT NOT APPLIED      */
*                                                                  1403
         OI    MOD1DONE,B'11000000'                                1403
*           /*********************************************************/
*           /*                                                       */
*           /* ISSUE ERROR MESSAGE, ACDS RMID IS NOT APPLIED         */
*           /*                                                       */
*           /*********************************************************/
*                                                                  1404
*           CALL M1MSG(TXTRMID,     /* 'RMID'                        */
*               PART126,            /* 'APPLIED BUT NOT ACCEPTED'    */
*               M1ARMID,            /* RMID NAME                     */
*               CCADSIDA(IOPCDS));  /* 'SMPCDS'                      */
         LA    @02,@CC02062                                        1404
         ST    @02,@AL00001                                        1404
         LA    @02,@CF02052                                        1404
         ST    @02,@AL00001+4                                      1404
         L     @02,MOD1ACR@                                        1404
         ST    @02,@AL00001+8                                      1404
         L     @02,CCADSAD(,CCAPTR)                                1404
         LA    @02,CCADSIDA+8(,@02)                                1404
         ST    @02,@AL00001+12                                     1404
         LA    @01,@AL00001                                        1404
         BAL   @14,M1MSG                                           1404
*           RFY                                                    1405
*             RTNCODE RSTD;                                        1405
*           M1RRC=MAX(M1RRC,RTNCODE);/* SAVE MAX RC                  */
         CR    M1RRC,RTNCODE                                       1406
         BNL   *+6
         LR    M1RRC,RTNCODE                                       1406
*           RFY                                                    1407
*             RTNCODE UNRSTD;                                      1407
*         END;                                                     1408
*                                                                  1408
*       /*************************************************************/
*       /*                                                           */
*       /* CDS RMID PRESENT BUT ACDS RMID IS NOT                     */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1409
*       IF(M1CRMFND=ON              /* CDS RMID PRESENT              */
*           &M1ARMFND=OFF           /* AND ACDS RMID NOT PRESENT?    */
*           &M1CRMASM=OFF) THEN     /* AND CDS RMID NOT ASSEM TYPE   */
@RF01400 TM    M1CRMFND,B'10000000'                                1409
         BNO   @RF01409                                            1409
         TM    M1ARMFND,B'01000010'                                1409
         BNZ   @RF01409                                            1409
*         DO;                       /* YES,                          */
*           MOD1DONE=OFF;           /* MODID CHECKING IS DONE SINCE
*                                      THE RMID AND UMID'S REPRESENT
*                                      DIFFERENT SERVICE CHAINS      */
         NI    MOD1DONE,B'01111111'                                1411
*           IF M1RCANS^=RESTORE THEN/* CDS RMID NOT BEING RESTORED?  */
         CLI   M1RCANS,C'R'                                        1412
         BE    @RF01412                                            1412
*             DO;                   /* YES,                          */
*               MOD1ERR=ON;         /* ERROR SINCE CDS FMID IS NOT 1414
*                                      BEING RESTORED                */
*               MOD1DONE=ON;        /* NO FURTHER CHECKING           */
         OI    MOD1ERR,B'11000000'                                 1415
*               CALL M1MSG(TXTRMID, /* 'RMID'                        */
*                   PART127,        /* PART NUMBER                   */
*                   M1CRMID,        /* RMID NAME                     */
*                   CCADSIDA(IOPCDS));/* 'SMPCDS'                    */
         LA    @02,@CC02062                                        1416
         ST    @02,@AL00001                                        1416
         LA    @02,@CF02054                                        1416
         ST    @02,@AL00001+4                                      1416
         L     @02,MOD1CDR@                                        1416
         ST    @02,@AL00001+8                                      1416
         L     @02,CCADSAD(,CCAPTR)                                1416
         LA    @02,CCADSIDA+8(,@02)                                1416
         ST    @02,@AL00001+12                                     1416
         LA    @01,@AL00001                                        1416
         BAL   @14,M1MSG                                           1416
*               RFY                                                1417
*                 RTNCODE RSTD;                                    1417
*               M1RRC=MAX(M1RRC,RTNCODE);/* SAVE MAX RC              */
         CR    M1RRC,RTNCODE                                       1418
         BNL   *+6
         LR    M1RRC,RTNCODE                                       1418
*               RFY                                                1419
*                 RTNCODE UNRSTD;                                  1419
*             END;                                                 1420
*           ELSE                                                   1421
*             ;                     /* SYSMOD IS BEING RESTORED      */
@RF01412 DS    0H                                                  1422
*         END;                                                     1422
*     END;                                                         1423
@RF01409 DS    0H                                                  1424
*   IF M1RRC<STOPSMD                /* NO FAILING ERROR ...          */
*       &M1CRMFND=ON THEN           /* ... AND THERE IS A CDS RMID?  */
@RF01350 CH    M1RRC,@CH00034                                      1424
         BNL   @RF01424                                            1424
         TM    M1CRMFND,B'10000000'                                1424
         BNO   @RF01424                                            1424
*     DO;                           /* YES,                          */
*       CALL M1PRECK(M1RCICT@,      /* CALL PRE CHECK TO SET ACDS ID
*                                      IS RELATED FLAG               */
*           ICTMICHA(1),            /*                               */
*           M1RCANS,                /*                               */
*           M1RCPART);              /*                               */
         MVC   @AL00001(16),@AL01426                               1426
         L     @02,@PC00015                                        1426
         LA    @02,ICTMICHA(,@02)                                  1426
         ST    @02,@AL00001+4                                      1426
         LA    @01,@AL00001                                        1426
         BAL   @14,M1PRECK                                         1426
*       RFY                                                        1427
*         RTNCODE RSTD;                                            1427
*       M1RRC=MAX(M1RRC,RTNCODE);   /* SAVE MAX RC                   */
         CR    M1RRC,RTNCODE                                       1428
         BNL   *+6
         LR    M1RRC,RTNCODE                                       1428
*       RFY                                                        1429
*         RTNCODE UNRSTD;                                          1429
*     END;                          /*                               */
*   RETURN CODE(M1RRC);             /* RETURN W/ RETURN CODE         */
@RF01424 LR    @15,M1RRC                                           1431
         L     @14,@SA00018                                        1431
         LM    @00,@12,@SA00018+8                                  1431
         BR    @14                                                 1431
*   RFY                                                            1432
*     TSLPARMS BASED;                                              1432
*   RFY                                                            1433
*     ICTMOD BASED;                                                1433
*   END M1RMID;                                                    1434
         EJECT
*                                                                  1435
*   /*****************************************************************/
*   /*                                                               */
*   /* M1UMID -                                                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1435
*M1UMID:                                                           1435
*   PROC;                                                          1435
M1UMID   STM   @14,@12,@SA00019                                    1435
*   DCL                                                            1436
*     M1URC FIXED(15);              /* LOCAL RETURN CODE             */
*   DCL                                                            1437
*     1 M1UFLAGS,                   /* LOCAL CONTROL FLAGS           */
*       3 M1UBOTH BIT(1),           /* UMID IN BOTH CDS AND ACDS   1437
*                                      LISTS                         */
*       3 * BIT(7);                 /* UNUSED                        */
*   DCL                                                            1438
*     M1UAANS CHAR(1);              /* ANSWER FOR ACDS MODID LIST  1438
*                                      ENTRY                         */
*   DCL                                                            1439
*     M1UAPART FIXED(31);           /* MESSAGE PART FOR ACDS MODID 1439
*                                      LIST ENTRY                    */
*   DCL                                                            1440
*     M1UCANS CHAR(1);              /* ANSWER FOR CDS MODID LIST   1440
*                                      ENTRY                         */
*   DCL                                                            1441
*     M1UCPART FIXED(31);           /* MESSAGE PART FOR CDS MODID  1441
*                                      LIST ENTRY                    */
*   DCL                                                            1442
*     M1UCICT@ PTR(31);             /* ICT SYSMOD ENTRY PTR IF BEING
*                                      RESTORED                      */
*   DCL                                                            1443
*     M1UX1 FIXED(31);              /* INDEX COUNTER FOR THE CDS   1443
*                                      MODID LIST                    */
*   DCL                                                            1444
*     M1UX2 FIXED(31);              /* INDEX COUNTER FOR THE ACDS  1444
*                                      MODID LIST                    */
*   RFY                                                            1445
*     ICTMOD BASED(ADDR(MOD1ENT));                                 1445
*   RFY                                                            1446
*     ICTMIDLS BASED(ICTMICHN(1));  /* CDS MODID CHAIN               */
*   RFY                                                            1447
*     TSLPARMS BASED(TBLXTSLP);                                    1447
*   M1URC=ZERO;                     /* CLEAR RETURN CODE             */
         SLR   M1URC,M1URC                                         1448
*   M1UFLAGS=''B;                   /* CLEAR LOCAL CONTROL FLAGS     */
         MVI   M1UFLAGS,X'00'                                      1449
*                                                                  1450
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESS ALL CDS UMID'S                                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1450
*   DO M1UX1=1 BY 1                 /*                               */
*         WHILE(ICTMIDND(M1UX1)^=ICTENDIX/*                          */
*         &M1URC<STOPFUNC);                                        1450
         LA    M1UX1,1                                             1450
         B     @DE01450                                            1450
@DL01450 DS    0H                                                  1451
*     IF ICTMIDTY(M1UX1)=ICTMIDUP THEN/* UMID TYPE ENTRY?            */
         LR    @04,M1UX1                                           1451
         SLA   @04,3                                               1451
         L     @02,@PC00015                                        1451
         L     @02,ICTMICHN(,@02)                                  1451
         ST    @04,@TF00001                                        1451
         ALR   @04,@02                                             1451
         BCTR  @04,0                                               1451
         TM    ICTMIDTY-7(@04),B'00000011'                         1451
         BNZ   @RF01451                                            1451
*       DO;                         /* YES,                          */
*         CALL M1CDS(ICTMODID(M1UX1),/* UMID NAME                    */
*             M1UCANS,              /* ANSWER                        */
*             M1UCPART,             /* PART NUMBER                   */
*             M1UCICT@);            /* SYSMOD ENTRY IF BEING RESTORED*/
         MVC   @AL00001+4(12),@AL01453                             1453
         L     @04,@TF00001                                        1453
         AL    @02,@CF02695                                        1453
         LA    @04,ICTMODID(@04,@02)                               1453
         ST    @04,@AL00001                                        1453
         LA    @01,@AL00001                                        1453
         BAL   @14,M1CDS                                           1453
*         RFY                                                      1454
*           RTNCODE RSTD;                                          1454
*         M1URC=MAX(M1URC,RTNCODE); /* SAVE THE RETURN CODE          */
         CR    M1URC,RTNCODE                                       1455
         BNL   *+6
         LR    M1URC,RTNCODE                                       1455
*         IF RTNCODE<STOPFUNC THEN  /* NO SERIOUS ERROR?             */
         CH    RTNCODE,@CH00033                                    1456
         BNL   @RF01456                                            1456
*           DO;                     /* YES,                          */
*             RFY                                                  1458
*               RTNCODE UNRSTD;                                    1458
*             IF M1UCANS=NO THEN    /* UMID IS IN WRONG STATUS?      */
         CLI   M1UCANS,C'N'                                        1459
         BNE   @RF01459                                            1459
*               DO;                 /* YES,                          */
*                                                                  1460
*                 /***************************************************/
*                 /*                                                 */
*                 /* MESSAGE                                         */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1461
*                 CALL M1MSG(TXTUMID,/* 'UMID'                       */
*                     M1UCPART,     /* PART NUMBER                   */
*                     ICTMODID(M1UX1),/* URMID NAME                  */
*                     CCADSIDA(IOPCDS));/* 'SMPCDS'                  */
         LA    @04,@CC02064                                        1461
         ST    @04,@AL00001                                        1461
         LA    @04,M1UCPART                                        1461
         ST    @04,@AL00001+4                                      1461
         LR    @04,M1UX1                                           1461
         SLA   @04,3                                               1461
         L     @02,@PC00015                                        1461
         L     @02,ICTMICHN(,@02)                                  1461
         AL    @02,@CF02695                                        1461
         LA    @04,ICTMODID(@04,@02)                               1461
         ST    @04,@AL00001+8                                      1461
         L     @04,CCADSAD(,CCAPTR)                                1461
         LA    @04,CCADSIDA+8(,@04)                                1461
         ST    @04,@AL00001+12                                     1461
         LA    @01,@AL00001                                        1461
         BAL   @14,M1MSG                                           1461
*                 RFY                                              1462
*                   RTNCODE RSTD;                                  1462
*                 M1URC=MAX(M1URC,RTNCODE);/* SAVE MAX RC            */
         CR    M1URC,RTNCODE                                       1463
         BNL   *+6
         LR    M1URC,RTNCODE                                       1463
*                 RFY                                              1464
*                   RTNCODE UNRSTD;                                1464
*               END;                                               1465
*             ELSE                  /* UMID IS APPLIED OR BEING    1466
*                                      RESTORED                      */
*               DO;                                                1466
*                                                                  1466
         B     @RC01459                                            1466
@RF01459 DS    0H                                                  1467
*                 /***************************************************/
*                 /*                                                 */
*                 /* DETERMINE IF THE CDS UMID IS ALSO IN THE ACDS   */
*                 /* UMID LIST                                       */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1467
*                 M1UBOTH=OFF;      /* NOT IN BOTH CDS AND ACDS MODID
*                                      LISTS                         */
         NI    M1UBOTH,B'01111111'                                 1467
*                 DO M1UX2=1 BY 1   /* SEARCH ACDS MODID LIST FOR THE
*                                      UMID                          */
*                       WHILE(ICTMICHA(1)->ICTMIDND(M1UX2)^=ICTENDIX
*                                   /*                               */
*                       &M1URC<STOPFUNC);                          1468
         LA    M1UX2,1                                             1468
         B     @DE01468                                            1468
@DL01468 DS    0H                                                  1469
*                   IF ICTMODID(M1UX1)=/* MATCH?                     */
*                       ICTMICHA(1)->ICTMODID(M1UX2) THEN/*          */
         LR    @02,M1UX1                                           1469
         SLA   @02,3                                               1469
         L     @15,@PC00015                                        1469
         L     @01,ICTMICHN(,@15)                                  1469
         LR    @14,M1UX2                                           1469
         SLA   @14,3                                               1469
         L     @15,ICTMICHA(,@15)                                  1469
         ALR   @01,@02                                             1469
         AL    @01,@CF02695                                        1469
         ALR   @15,@14                                             1469
         AL    @15,@CF02695                                        1469
         CLC   ICTMODID(7,@01),ICTMODID(@15)                       1469
         BNE   @RF01469                                            1469
*                     DO;           /* YES,                          */
*                       M1UBOTH=ON; /* MATCHING ACDS ENTRY FOUND     */
         OI    M1UBOTH,B'10000000'                                 1471
*                     END;                                         1472
*                   ELSE                                           1473
*                     ;             /* NOT A MATCHING ENTRY          */
@RF01469 DS    0H                                                  1474
*                 END;              /* END OF ACDS MODID SEARCH LOOP */
         AH    M1UX2,@CH00064                                      1474
@DE01468 LR    @02,M1UX2                                           1474
         SLA   @02,3                                               1474
         L     @15,@PC00015                                        1474
         L     @01,ICTMICHA(,@15)                                  1474
         AL    @01,@CF02695                                        1474
         L     @02,ICTMIDND(@02,@01)                               1474
         CL    @02,ICTENDIX                                        1474
         BE    @DC01468                                            1474
         CH    M1URC,@CH00033                                      1474
         BL    @DL01468                                            1474
@DC01468 DS    0H                                                  1475
*                 IF M1UBOTH=ON THEN/* UMID IN BOTH LISTS?           */
         TM    M1UBOTH,B'10000000'                                 1475
         BNO   @RF01475                                            1475
*                   DO;             /* YES,                          */
*                     CALL M1ACDS(ICTMODID(M1UX1),/* UMID NAME       */
*                         M1UAANS,  /* ANSWER                        */
*                         M1UAPART);/* PART NUMBER                   */
         MVC   @AL00001+4(8),@AL01477                              1477
         LR    @02,M1UX1                                           1477
         SLA   @02,3                                               1477
         L     @15,@PC00015                                        1477
         L     @01,ICTMICHN(,@15)                                  1477
         AL    @01,@CF02695                                        1477
         LA    @02,ICTMODID(@02,@01)                               1477
         ST    @02,@AL00001                                        1477
         LA    @01,@AL00001                                        1477
         BAL   @14,M1ACDS                                          1477
*                     RFY                                          1478
*                       RTNCODE RSTD;                              1478
*                     M1URC=MAX(M1URC,RTNCODE);/* SAVE THE RETURN  1479
*                                      CODE                          */
         CR    M1URC,RTNCODE                                       1479
         BNL   *+6
         LR    M1URC,RTNCODE                                       1479
*                     IF RTNCODE<STOPFUNC THEN/* NO SERIOUS ERROR?   */
         CH    RTNCODE,@CH00033                                    1480
         BNL   @RF01480                                            1480
*                       DO;         /* YES,                          */
*                         ICTMIDPS(M1UX2)=ON;/* NO FURTHER PROCESSING
*                                      OF ACDS UMID REQUIRED         */
         LR    @14,M1UX2                                           1482
         SLA   @14,3                                               1482
         L     @02,@PC00015                                        1482
         L     @02,ICTMICHN(,@02)                                  1482
         ALR   @14,@02                                             1482
         BCTR  @14,0                                               1482
         OI    ICTMIDPS-7(@14),B'01000000'                         1482
*                         RFY                                      1483
*                           RTNCODE UNRSTD;                        1483
*                         IF M1UAANS=NO THEN/* BAD STATUS ON THE   1484
*                                      ACDS?                         */
         CLI   M1UAANS,C'N'                                        1484
         BNE   @RF01484                                            1484
*                           DO;     /* YES,                          */
*                                                                  1485
*                             /***************************************/
*                             /*                                     */
*                             /* ISSUE MESSAGE                       */
*                             /*                                     */
*                             /***************************************/
*                                                                  1486
*                             CALL M1MSG(TXTUMID,/* 'UMID'           */
*                                 M1UCPART,/* PART NUMBER            */
*                                 ICTMODID(M1UX1),/* URMID NAME      */
*                                 CCADSIDA(IOPCDS));/* 'SMPCDS'      */
         LA    @04,@CC02064                                        1486
         ST    @04,@AL00001                                        1486
         LA    @04,M1UCPART                                        1486
         ST    @04,@AL00001+4                                      1486
         LR    @04,M1UX1                                           1486
         SLA   @04,3                                               1486
         AL    @02,@CF02695                                        1486
         LA    @04,ICTMODID(@04,@02)                               1486
         ST    @04,@AL00001+8                                      1486
         L     @04,CCADSAD(,CCAPTR)                                1486
         LA    @04,CCADSIDA+8(,@04)                                1486
         ST    @04,@AL00001+12                                     1486
         LA    @01,@AL00001                                        1486
         BAL   @14,M1MSG                                           1486
*                             RFY                                  1487
*                               RTNCODE RSTD;                      1487
*                             M1URC=MAX(M1URC,RTNCODE);/* SAVE MAX RC*/
         CR    M1URC,RTNCODE                                       1488
         BNL   *+6
         LR    M1URC,RTNCODE                                       1488
*                             RFY                                  1489
*                               RTNCODE UNRSTD;                    1489
*                           END;                                   1490
*                         ELSE                                     1491
*                           ;       /* UMID IS OK                    */
@RF01484 DS    0H                                                  1492
*                       END;                                       1492
*                     ELSE                                         1493
*                       ;           /* SERIOUS ERROR                 */
@RF01480 DS    0H                                                  1494
*                   END;                                           1494
*                 ELSE              /* NOT IN THE ACDS LIST          */
*                   DO;                                            1495
         B     @RC01475                                            1495
@RF01475 DS    0H                                                  1496
*                     IF M1UCANS=RESTORE THEN/* IS UMID BEING      1496
*                                      RESTORED?                     */
         CLI   M1UCANS,C'R'                                        1496
         BNE   @RF01496                                            1496
*                       DO;         /* YES                           */
*                                                                  1497
*                         /*******************************************/
*                         /*                                         */
*                         /* CHECK FOR PRE/SUP RELATIONSHIP W/ ACDS  */
*                         /* LIST                                    */
*                         /*                                         */
*                         /*******************************************/
*                                                                  1498
*                         CALL M1PRECK(M1UCICT@,/* CALL PRE CHECK TO
*                                      SET ACDS ID IS RELATED FLAG   */
*                             ICTMICHA(1),/*                         */
*                             M1UCANS,/*                             */
*                             M1UCPART);/*                           */
         MVC   @AL00001(16),@AL01498                               1498
         L     @04,@PC00015                                        1498
         LA    @04,ICTMICHA(,@04)                                  1498
         ST    @04,@AL00001+4                                      1498
         LA    @01,@AL00001                                        1498
         BAL   @14,M1PRECK                                         1498
*                         RFY                                      1499
*                           RTNCODE RSTD;                          1499
*                         M1URC=MAX(M1URC,RTNCODE);/* SAVE MAX RC    */
         CR    M1URC,RTNCODE                                       1500
         BNL   *+6
         LR    M1URC,RTNCODE                                       1500
*                         RFY                                      1501
*                           RTNCODE UNRSTD;                        1501
*                       END;                                       1502
*                     ELSE          /* IS ON THE CDS, ^RESTORE AND 1503
*                                      NOT IN THE ACDS MODID LIST    */
*                       DO;                                        1503
*                                                                  1503
         B     @RC01496                                            1503
@RF01496 DS    0H                                                  1504
*                         /*******************************************/
*                         /*                                         */
*                         /* ISSUE ERROR MESSAGE                     */
*                         /*                                         */
*                         /*******************************************/
*                                                                  1504
*                         CALL M1MSG(TXTUMID,/* 'UMID'               */
*                             PART124,/* 'IS APPLIED BUT NOT       1504
*                                      ACCEPTED'                     */
*                             MOD1CDR@->ICTMODID(M1UX1),/* UMID NAME */
*                             CCADSIDA(IOPCDS));/* 'SMPCDS'          */
         LA    @04,@CC02064                                        1504
         ST    @04,@AL00001                                        1504
         LA    @04,@CF02049                                        1504
         ST    @04,@AL00001+4                                      1504
         LR    @04,M1UX1                                           1504
         SLA   @04,3                                               1504
         L     @02,MOD1CDR@                                        1504
         AL    @02,@CF02695                                        1504
         LA    @04,ICTMODID(@04,@02)                               1504
         ST    @04,@AL00001+8                                      1504
         L     @04,CCADSAD(,CCAPTR)                                1504
         LA    @04,CCADSIDA+8(,@04)                                1504
         ST    @04,@AL00001+12                                     1504
         LA    @01,@AL00001                                        1504
         BAL   @14,M1MSG                                           1504
*                         RFY                                      1505
*                           RTNCODE RSTD;                          1505
*                         M1URC=MAX(M1URC,RTNCODE);/* SAVE MAX RC    */
         CR    M1URC,RTNCODE                                       1506
         BNL   *+6
         LR    M1URC,RTNCODE                                       1506
*                         RFY                                      1507
*                           RTNCODE UNRSTD;                        1507
*                       END;                                       1508
*                   END;                                           1509
*               END;                                               1510
*           END;                                                   1511
*         ELSE                                                     1512
*           ;                       /* ERROR OCCURRED                */
@RF01456 DS    0H                                                  1513
*       END;                                                       1513
*     ELSE                                                         1514
*       ;                           /* NOT A UMID, SKIP IT           */
@RF01451 DS    0H                                                  1515
*   END;                            /* END OF PROCESSING ALL CDS   1515
*                                      MODID'S                       */
@RC01451 AH    M1UX1,@CH00064                                      1515
@DE01450 LR    @04,M1UX1                                           1515
         SLA   @04,3                                               1515
         L     @02,@PC00015                                        1515
         L     @02,ICTMICHN(,@02)                                  1515
         AL    @02,@CF02695                                        1515
         L     @04,ICTMIDND(@04,@02)                               1515
         CL    @04,ICTENDIX                                        1515
         BE    @DC01450                                            1515
         CH    M1URC,@CH00033                                      1515
         BL    @DL01450                                            1515
@DC01450 DS    0H                                                  1516
*   RFY                                                            1516
*     ICTMIDLS BASED;                                              1516
*                                                                  1516
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESS ALL ACDS UMID'S NOT ALREADY PROCESSING WHILE CHECKING */
*   /* THE CDS UMID'S                                                */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1517
*   RFY                                                            1517
*     ICTMIDLS BASED(ICTMICHA(1));  /* USE THE ACDS MODID LIST       */
*   DO M1UX2=1 BY 1                 /*                               */
*         WHILE(ICTMIDND(M1UX2)^=ICTENDIX/*                          */
*         &M1URC<STOPFUNC);         /*                               */
         LA    M1UX2,1                                             1518
         B     @DE01518                                            1518
@DL01518 DS    0H                                                  1519
*     IF ICTMIDPS(M1UX2)=OFF        /* NOT ALREADY PROCESSED ...     */
*         &ICTMIDTY(M1UX2)=ICTMIDUP THEN/* AND A UMID?               */
         LR    @05,M1UX2                                           1519
         SLA   @05,3                                               1519
         L     @02,@PC00015                                        1519
         L     @15,ICTMICHA(,@02)                                  1519
         ST    @05,@TF00001                                        1519
         ALR   @05,@15                                             1519
         BCTR  @05,0                                               1519
         TM    ICTMIDPS-7(@05),B'01000000'                         1519
         BNZ   @RF01519                                            1519
         LR    @05,@15                                             1519
         AL    @05,@TF00001                                        1519
         BCTR  @05,0                                               1519
         TM    ICTMIDTY-7(@05),B'00000011'                         1519
         BNZ   @RF01519                                            1519
*       DO;                         /* YES,                          */
*         CALL REGRCHK(CCAIOPTR->HMASMIOP,/*                         */
*             ICTMODID(M1UX2),ICTMOD(1));                          1521
         L     @05,CCAIOPTR(,CCAPTR)                               1521
         ST    @05,@AL00001                                        1521
         L     @05,@TF00001                                        1521
         AL    @15,@CF02695                                        1521
         LA    @05,ICTMODID(@05,@15)                               1521
         ST    @05,@AL00001+4                                      1521
         ST    @02,@AL00001+8                                      1521
         LA    @01,@AL00001                                        1521
         BAL   @14,REGRCHK                                         1521
*         RFY                                                      1522
*           RTNCODE RSTD;                                          1522
*         IF RTNCODE^=ZERO THEN     /* NOT A REGRESSED ELEMENT       */
         LTR   RTNCODE,RTNCODE                                     1523
         BZ    @RF01523                                            1523
*           DO;                     /* YES, ISSUE ERROR MESSAGE      */
*             RFY                                                  1525
*               RTNCODE UNRSTD;                                    1525
*                                                                  1525
*             /*******************************************************/
*             /*                                                     */
*             /* ERROR OCCURRED ISSUE MESSAGE, SMPACDS UMID XXXXXXX  */
*             /* IS NOT RELATED TO SMPCDS MODID LIST                 */
*             /*                                                     */
*             /*******************************************************/
*                                                                  1526
*             CALL M1MSG(TXTUMID,   /* 'UMID'                        */
*                 PART126,          /* 'IS ACCEPTED BUT NOT APPLIED' */
*                 ICTMODID(M1UX2),  /* UMID NAME                     */
*                 CCADSIDA(IOPACDS));/* 'SMPACDS'                    */
         LA    @05,@CC02064                                        1526
         ST    @05,@AL00001                                        1526
         LA    @05,@CF02052                                        1526
         ST    @05,@AL00001+4                                      1526
         LR    @05,M1UX2                                           1526
         SLA   @05,3                                               1526
         L     @02,@PC00015                                        1526
         L     @02,ICTMICHA(,@02)                                  1526
         AL    @02,@CF02695                                        1526
         LA    @05,ICTMODID(@05,@02)                               1526
         ST    @05,@AL00001+8                                      1526
         L     @05,CCADSAD(,CCAPTR)                                1526
         LA    @05,CCADSIDA+88(,@05)                               1526
         ST    @05,@AL00001+12                                     1526
         LA    @01,@AL00001                                        1526
         BAL   @14,M1MSG                                           1526
*             RFY                                                  1527
*               RTNCODE RSTD;                                      1527
*             M1URC=MAX(M1URC,RTNCODE);/* SAVE MAX RC                */
         CR    M1URC,RTNCODE                                       1528
         BNL   *+6
         LR    M1URC,RTNCODE                                       1528
*             RFY                                                  1529
*               RTNCODE UNRSTD;                                    1529
*           END;                                                   1530
*       END;                                                       1531
*     ELSE                                                         1532
*       ;                           /* CONTINUE WITH NEXT ENTRY      */
@RF01519 DS    0H                                                  1533
*   END;                            /* END OF ACDS MODID PROCESS LOOP*/
@RC01519 AH    M1UX2,@CH00064                                      1533
@DE01518 LR    @05,M1UX2                                           1533
         SLA   @05,3                                               1533
         L     @02,@PC00015                                        1533
         L     @02,ICTMICHA(,@02)                                  1533
         AL    @02,@CF02695                                        1533
         L     @05,ICTMIDND(@05,@02)                               1533
         CL    @05,ICTENDIX                                        1533
         BE    @DC01518                                            1533
         CH    M1URC,@CH00033                                      1533
         BL    @DL01518                                            1533
@DC01518 DS    0H                                                  1534
*   RETURN CODE(M1URC);             /* RETURN W/ RETURN CODE         */
         LR    @15,M1URC                                           1534
         L     @14,@SA00019                                        1534
         LM    @00,@12,@SA00019+8                                  1534
         BR    @14                                                 1534
*   END M1UMID;                                                    1535
*   RFY                                                            1536
*     ICTMOD BASED;                                                1536
*   RFY                                                            1537
*     ICTMIDLS BASED;                                              1537
*   RFY                                                            1538
*     TSLPARMS BASED;                                              1538
         EJECT
*                                                                  1539
*   /*****************************************************************/
*   /*                                                               */
*   /* M1PRECK -                                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1539
*M1PRECK:                                                          1539
*   PROC(M1PCICT@,                  /* ADDRESS OF ICT ENTRY FOR CDS
*                                      MODID                         */
*       M1PLST@,                    /* PTR TO ACDS MODID LIST        */
*       M1PAANS,                    /* ANSWER FOR ACDS CHECK         */
*       M1PAPART);                  /* ACDS PART                     */
M1PRECK  STM   @14,@12,@SA00020                                    1539
         MVC   @PC00020(16),0(@01)                                 1539
*   DCL                                                            1540
*     M1PCICT@ FIXED(31);           /* ADDRESS OF ICT ENTRY FOR CDS
*                                      MODID                         */
*   DCL                                                            1541
*     M1PLST@ PTR(31);              /* PTR TO LIST OF MODID'S TO   1541
*                                      CHECK AGAINST                 */
*   DCL                                                            1542
*     M1PAANS CHAR(1);              /* ANSWER FOR ACDS CHECK         */
*   DCL                                                            1543
*     M1PAPART FIXED(31);           /* ACDS PART                     */
*   DCL                                                            1544
*     M1PRC FIXED(15);              /* LOCAL RETURN CODE             */
*   DCL                                                            1545
*     M1PANS CHAR(1);               /* ANSWER FROM TPS               */
*   DCL                                                            1546
*     M1PX1 FIXED(31);              /* MODID SEARCH LOOP INDEX       */
*   RFY                                                            1547
*     ICTMIDLS BASED(M1PLST@);                                     1547
*   M1PRC=ZERO;                     /* CLEAR RETURN CODE             */
         SLR   M1PRC,M1PRC                                         1548
*   M1PANS=NO;                      /*                               */
         MVI   M1PANS,C'N'                                         1549
*   DO M1PX1=1 BY 1                 /* PROCESS ALL MODIDS            */
*         WHILE(M1PCICT@^=ZERO      /* IF ICT PTR ^ZERO              */
*         &ICTMIDND(M1PX1)^=ICTENDIX);                             1550
         LA    M1PX1,1                                             1550
         B     @DE01550                                            1550
@DL01550 DS    0H                                                  1551
*     IF ICTMIDTY(M1PX1)=ICTMIDRM   /* IS MODID RMID OR UMID?        */
*         ×ICTMIDTY(M1PX1)=ICTMIDUP THEN/*                           */
         LR    @05,M1PX1                                           1551
         SLA   @05,3                                               1551
         L     @02,@PC00020+4                                      1551
         L     @02,M1PLST@(,@02)                                   1551
         ALR   @02,@05                                             1551
         BCTR  @02,0                                               1551
         TM    ICTMIDTY-7(@02),B'00000001'                         1551
         BNO   @GL00068                                            1551
         TM    ICTMIDTY-7(@02),B'00000010'                         1551
         BZ    @RT01551                                            1551
@GL00068 LR    @05,M1PX1                                           1551
         SLA   @05,3                                               1551
         L     @02,@PC00020+4                                      1551
         L     @02,M1PLST@(,@02)                                   1551
         ALR   @02,@05                                             1551
         BCTR  @02,0                                               1551
         TM    ICTMIDTY-7(@02),B'00000011'                         1551
         BNZ   @RF01551                                            1551
@RT01551 DS    0H                                                  1552
*       DO;                         /* YES                           */
*         CALL HMASMTPS(M1PCICT@,   /* CDS MID ENTRY PTR             */
*             ICTMODID(M1PX1),      /* ACDS MID                      */
*             M1PANS);              /* ANSWER                        */
         L     @05,@PC00020                                        1553
         ST    @05,@AL00001                                        1553
         LR    @05,M1PX1                                           1553
         SLA   @05,3                                               1553
         L     @02,@PC00020+4                                      1553
         L     @02,M1PLST@(,@02)                                   1553
         AL    @02,@CF02695                                        1553
         LA    @05,ICTMODID(@05,@02)                               1553
         ST    @05,@AL00001+4                                      1553
         LA    @05,M1PANS                                          1553
         ST    @05,@AL00001+8                                      1553
         L     @15,@CV02029                                        1553
         LA    @01,@AL00001                                        1553
         BALR  @14,@15                                             1553
*         IF M1PANS=YES THEN        /* FOUND?                        */
         CLI   M1PANS,C'Y'                                         1554
         BNE   @RF01554                                            1554
*           DO;                     /* YES,                          */
*             CALL M1ACDS(ICTMODID(M1PX1),/*                         */
*                 M1PAANS,          /* ANSWER                        */
*                 M1PAPART);        /* PART                          */
         LR    @05,M1PX1                                           1556
         SLA   @05,3                                               1556
         L     @02,@PC00020+4                                      1556
         L     @02,M1PLST@(,@02)                                   1556
         AL    @02,@CF02695                                        1556
         LA    @05,ICTMODID(@05,@02)                               1556
         ST    @05,@AL00001                                        1556
         L     @05,@PC00020+8                                      1556
         ST    @05,@AL00001+4                                      1556
         L     @05,@PC00020+12                                     1556
         ST    @05,@AL00001+8                                      1556
         LA    @01,@AL00001                                        1556
         BAL   @14,M1ACDS                                          1556
*             IF M1PAANS^=YES THEN  /* NOT OK?                       */
         L     @05,@PC00020+8                                      1557
         CLI   M1PAANS(@05),C'Y'                                   1557
         BE    @RF01557                                            1557
*               DO;                 /* YES,                          */
*                                                                  1558
*                 /***************************************************/
*                 /*                                                 */
*                 /* ISSUE MESSAGE                                   */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  1559
*                 CALL M1MSG(TXTUMID,/* 'MID'                        */
*                     M1PAPART,     /* PART NUMBER                   */
*                     ICTMODID(M1PX1),/* ACDS MOD ID NAME            */
*                     CCADSIDA(IOPACDS));/* 'SMPCDS'                 */
         LA    @05,@CC02064                                        1559
         ST    @05,@AL00001                                        1559
         L     @05,@PC00020+12                                     1559
         ST    @05,@AL00001+4                                      1559
         LR    @05,M1PX1                                           1559
         SLA   @05,3                                               1559
         L     @02,@PC00020+4                                      1559
         L     @02,M1PLST@(,@02)                                   1559
         AL    @02,@CF02695                                        1559
         LA    @05,ICTMODID(@05,@02)                               1559
         ST    @05,@AL00001+8                                      1559
         L     @05,CCADSAD(,CCAPTR)                                1559
         LA    @05,CCADSIDA+88(,@05)                               1559
         ST    @05,@AL00001+12                                     1559
         LA    @01,@AL00001                                        1559
         BAL   @14,M1MSG                                           1559
*                 RFY                                              1560
*                   RTNCODE RSTD;                                  1560
*                 M1PRC=MAX(M1PRC,RTNCODE);/* SAVE MAX RC            */
         CR    M1PRC,RTNCODE                                       1561
         BNL   *+6
         LR    M1PRC,RTNCODE                                       1561
*                 RFY                                              1562
*                   RTNCODE UNRSTD;                                1562
*                 MOD1ERR=ON;       /* ... WITH AN ERROR             */
         OI    MOD1ERR,B'01000000'                                 1563
*               END;                                               1564
*             ELSE                  /* ALL IS WELL                   */
*               DO;                                                1565
         B     @RC01557                                            1565
@RF01557 DS    0H                                                  1566
*                 ICTMIDPS(M1PX1)=ON;/* MID SATISFIED                */
         LR    @05,M1PX1                                           1566
         SLA   @05,3                                               1566
         L     @02,@PC00020+4                                      1566
         L     @02,M1PLST@(,@02)                                   1566
         ALR   @02,@05                                             1566
         BCTR  @02,0                                               1566
         OI    ICTMIDPS-7(@02),B'01000000'                         1566
*               END;                                               1567
*           END;                                                   1568
*         ELSE                                                     1569
*           ;                       /* PRE/SUP RELATIONSHIP NOT FOUND*/
@RF01554 DS    0H                                                  1570
*       END;                        /*                               */
*     ELSE                                                         1571
*       ;                           /* SKIP THE FMID                 */
@RF01551 DS    0H                                                  1572
*   END;                            /* END OF SEARCH LOOP            */
@RC01551 AH    M1PX1,@CH00064                                      1572
@DE01550 L     @05,@PC00020                                        1572
         ICM   @02,15,M1PCICT@(@05)                                1572
         BZ    @DC01550                                            1572
         LR    @05,M1PX1                                           1572
         SLA   @05,3                                               1572
         L     @02,@PC00020+4                                      1572
         L     @02,M1PLST@(,@02)                                   1572
         AL    @02,@CF02695                                        1572
         L     @05,ICTMIDND(@05,@02)                               1572
         CL    @05,ICTENDIX                                        1572
         BNE   @DL01550                                            1572
@DC01550 DS    0H                                                  1573
*   RETURN CODE(M1PRC);             /* RETURN W/ RETURN CODE         */
         LR    @15,M1PRC                                           1573
         L     @14,@SA00020                                        1573
         LM    @00,@12,@SA00020+8                                  1573
         BR    @14                                                 1573
*   END M1PRECK;                                                   1574
         EJECT
*                                                                  1575
*   /*****************************************************************/
*   /*                                                               */
*   /* M1MSG -                                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1575
*M1MSG:                                                            1575
*   PROC(M1MTXT1,                   /* MODID TYPE TEXT               */
*       M1MPART,                    /* PART NUMBER                   */
*       M1MSMD,                     /* MODID SYSMOD NAME             */
*       M1MDDN);                    /* 'SMPACDS' OR 'SMPCDS'         */
M1MSG    STM   @14,@12,@SA00021                                    1575
         MVC   @PC00021(16),0(@01)                                 1575
*   DCL                                                            1576
*     M1MRC FIXED(15);              /* LOCAL RETURN CODE             */
*   DCL                                                            1577
*     M1MTXT1 CHAR(8);              /* MODID TYPE TEXT:            1577
*                                      'FMID'×'RMID'×'UMID'          */
*   DCL                                                            1578
*     M1MPART FIXED(31);            /* MESSAGE PART NUMBER           */
*   DCL                                                            1579
*     M1MSMD CHAR(7);               /* MODID SYSMOD NAME THAT CAUSED
*                                      FAILURE                       */
*   DCL                                                            1580
*     M1MDDN CHAR(8);               /* DDNAME OF LIST DS:          1580
*                                      'SMPCDS'×'SMPACDS'            */
*   DCL                                                            1581
*     M1MIOPT FIXED(8);             /* IOPTYPE FOR ELEMENT           */
*   DCL                                                            1582
*     M1MDUMMY FIXED(8);            /* DUMMY PARM FOR CNVTYP1 CALL   */
*   RFY                                                            1583
*     ICTMOD BASED(ADDR(MOD1ENT));                                 1583
*   RFY                                                            1584
*     ICTPTF BASED(ICTPPTR(1));                                    1584
*   M1MRC=ZERO;                     /* CLEAR RETURN CODE             */
         SLR   M1MRC,M1MRC                                         1585
*   IF M1HEADER=OFF THEN            /* HEADER MESSAGE ISSUED?        */
         TM    M1HEADER,B'00100000'                                1586
         BNZ   @RF01586                                            1586
*     DO;                           /* NO,                           */
*                                                                  1587
*       /*************************************************************/
*       /*                                                           */
*       /* HMA382I ID CHECK ERROR PROCESSING SYSMOD SYSMOD XXXXXXX   */
*       /* XXXXXXXX XXXXXXXX                                         */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1588
*       M1HEADER=ON;                /* HEADER ISSUED                 */
         OI    M1HEADER,B'00100000'                                1588
*       HMASMMGP=HMASMMGP&&HMASMMGP;/* CLEAR PARM LIST               */
         XC    HMASMMGP(32),HMASMMGP                               1589
*       MGPPRINT=ON;                /* ROUTE TO SMPOUT               */
*       MGPHLDS=ON;                 /* ROUTE TO SMPLOG               */
         OI    MGPPRINT,B'10010000'                                1591
*       MGPMGNO1=HMA382I;           /*                               */
         MVC   MGPMGNO1(2),@CH02033                                1592
*       IF TBLBPID=ON THEN          /* BYPASS?                       */
         L     @15,@PC00001                                        1593
         L     @01,TBLXTBL(,@15)                                   1593
         TM    TBLBPID(@01),B'10000000'                            1593
         BNO   @RF01593                                            1593
*         DO;                       /* YES,                          */
*           MGPTYPE=MGPWARN;        /* SEVERITY IS WARNING           */
         MVI   MGPTYPE,X'02'                                       1595
*           M1MRC=PTFWARN;          /* RC=4                          */
         LA    M1MRC,4                                             1596
*           ICTBYP(1)=ON;           /* SYSMOD REQUIRED BYPASS TO BE
*                                      RESTORED                      */
         L     @03,@PC00015                                        1597
         L     @03,ICTPPTR(,@03)                                   1597
         OI    ICTBYP(@03),B'00000010'                             1597
*         END;                                                     1598
*       ELSE                        /* NOT BYPASSED                  */
*         DO;                       /* YES,                          */
         B     @RC01593                                            1599
@RF01593 DS    0H                                                  1600
*           MGPTYPE=MGPERR;         /* SEVERITY IS ERROR             */
         MVI   MGPTYPE,X'03'                                       1600
*           M1MRC=STOPSMD;          /* RC=8                          */
         LA    M1MRC,8                                             1601
*         END;                                                     1602
*       MGPVARPT(1)=ADDR(ICTPTFS(1));/* SYSMOD NAME                  */
@RC01593 L     @03,@PC00015                                        1603
         L     @01,ICTPPTR(,@03)                                   1603
         ST    @01,MGPVARPT                                        1603
*       CALL CNVTYP1(ICTMOD(1),     /* CONVERT MOD TYPE TO IOP       */
*           M1MIOPT,                /* CDS ENTRY TYPE                */
*           M1MDUMMY);              /*                               */
*                                                                  1604
         MVC   @AL00001+4(8),@AL01604                              1604
         ST    @03,@AL00001                                        1604
         LA    @01,@AL00001                                        1604
         BAL   @14,CNVTYP1                                         1604
*       /*************************************************************/
*       /*                                                           */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1605
*       MGPVARPT(2)=ADDR(CCATYPEA(M1MIOPT));/* ELEMENT TYPE TEXT     */
         SLR   @03,@03                                             1605
         IC    @03,M1MIOPT                                         1605
         SLA   @03,3                                               1605
         L     @01,CCATPAD(,CCAPTR)                                1605
         AL    @01,@CF02695                                        1605
         LA    @03,CCATYPEA(@03,@01)                               1605
         ST    @03,MGPVARPT+4                                      1605
*       MGPVARPT(3)=ADDR(ICTMNAME(1));/* ELEMENT NAME                */
         L     @03,@PC00015                                        1606
         ST    @03,MGPVARPT+8                                      1606
*       CALL HMASMMSG(HMASMMGP);                                   1607
         L     @15,@CV02018                                        1607
         LA    @01,@AL01607                                        1607
         BALR  @14,@15                                             1607
*     END;                                                         1608
*   ELSE                                                           1609
*     ;                             /* HEADER ALREADY ISSUED         */
*                                                                  1609
@RF01586 DS    0H                                                  1610
*   /*****************************************************************/
*   /*                                                               */
*   /* HMA430I XXXXXXXX XXXXXXXX XXXXXXX ...                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1610
*   HMASMMGP=HMASMMGP&&HMASMMGP;    /* CLEAR PARM LIST               */
         XC    HMASMMGP(32),HMASMMGP                               1610
*   MGPPRINT=ON;                    /* ROUTE TO SMPOUT               */
*   MGPHLDS=ON;                     /* ROUTE TO SMPLOG               */
         OI    MGPPRINT,B'10010000'                                1612
*   MGPMGNO1=HMA430I;               /*                               */
         MVC   MGPMGNO1(2),@CH02035                                1613
*   MGPMGNO2=M1MPART;               /* PART DESCRIBING THE THE ERROR */
         L     @03,@PC00021+4                                      1614
         MVC   MGPMGNO2(2),M1MPART+2(@03)                          1614
*   MGPTYPE=MGPINFO;                /* SEVERITY IS INFO              */
         MVI   MGPTYPE,X'01'                                       1615
*   MGPVARPT(1)=ADDR(M1MDDN);       /* DS SMPCDS×SMPACDS             */
         L     @03,@PC00021+12                                     1616
         ST    @03,MGPVARPT                                        1616
*   MGPVARPT(2)=ADDR(M1MTXT1);      /* MODID TYPE FMID×RMID×UMID     */
         L     @03,@PC00021                                        1617
         ST    @03,MGPVARPT+4                                      1617
*   MGPVARPT(3)=ADDR(M1MSMD);       /* SYSMOD NAME                   */
         L     @03,@PC00021+8                                      1618
         ST    @03,MGPVARPT+8                                      1618
*   CALL HMASMMSG(HMASMMGP);                                       1619
         L     @15,@CV02018                                        1619
         LA    @01,@AL01619                                        1619
         BALR  @14,@15                                             1619
*   RETURN CODE(M1MRC);             /* RETURN W/ RETURN CODE         */
         LR    @15,M1MRC                                           1620
         L     @14,@SA00021                                        1620
         LM    @00,@12,@SA00021+8                                  1620
         BR    @14                                                 1620
*   END M1MSG;                                                     1621
         EJECT
*                                                                  1622
*/****************************************************************   */
*/*                                                                  */
*/* M1CDS -                                                          */
*/* OUTPUT - ANSWER                                                  */
*/*           - Y FOUND ON CDS AND OK - N NOT FOUND                  */
*/*           - N NOT FOUND OR FOUND AND NOT OK                      */
*/*           - R FOUND IN THE ICT I.E. TO BE RESTORED               */
*/*        - PART                                                    */
*/*          IF N                                                    */
*/*           - PART099 - 'IS DELETED'                               */
*/*           - PART100 - 'IS SUPERCEEDED'                           */
*/*           - PART129 - 'IS NOT APPLIED'                           */
*/*                                                                  */
*/*          IF Y                                                    */
*/*           - PART121 - 'IS APPLIED'                               */
*/*          IF R                                                    */
*/*           - PART122 - 'IS BEING RESTORED'                        */
*/*                                                                  */
*/****************************************************************   */
*                                                                  1622
*M1CDS:                                                            1622
*   PROC(M1CSMD,                    /* CDS SYSMOD NAME               */
*       M1CANS,                     /* (OUTPUT) ANSWER: Y, N, OR R   */
*       M1CPART,                    /* MESSAGE PART CORRESPONDING TO
*                                      ANSWER                        */
*       M1CICT@);                   /* (OUTPUT) ICT SYSMOD PTR       */
M1CDS    STM   @14,@12,@SA00022                                    1622
         MVC   @PC00022(16),0(@01)                                 1622
*   DCL                                                            1623
*     M1CSMD CHAR(7);               /* SYSMOD NAME TO BE CHECKED     */
*   DCL                                                            1624
*     M1CANS CHAR(1);               /* (OUTPUT) RESULT OF THE CHECK  */
*   DCL                                                            1625
*     M1CPART FIXED(31);            /* (OUTPUT) MSG PART NUMBER      */
*   DCL                                                            1626
*     M1CICT@ PTR(31);              /* (OUTPUT) ICT SMD ENTRY ADDR   */
*   DCL                                                            1627
*     M1CRC FIXED(15);              /* LOCAL RETURN CODE             */
*   RFY                                                            1628
*     TSLPARMS BASED(TBLXTSLP);                                    1628
*   RFY                                                            1629
*     HMASMIOP BASED(TBLXIOPF);     /* FIXED IOP                     */
*   M1CRC=ZERO;                     /* CLEAR RETURN CODE             */
         SLR   M1CRC,M1CRC                                         1630
*   M1CANS=YES;                     /* ASSUME ALL IS WELL            */
         L     @03,@PC00022+4                                      1631
         MVI   M1CANS(@03),C'Y'                                    1631
*   M1CICT@=ZERO;                   /* CLEAR PTR TO ZERO             */
         L     @03,@PC00022+12                                     1632
         SLR   @15,@15                                             1632
         ST    @15,M1CICT@(,@03)                                   1632
*   TSLSICDS=''B;                   /* CLEAR TSL                     */
         L     @03,@PC00001                                        1633
         L     @03,TBLXTSLP(,@03)                                  1633
         L     @15,TSLPMLAD(,@03)                                  1633
         XC    TSLSICDS(20,@15),TSLSICDS(@15)                      1633
*   TSLFUNCT=TSLFICSR;              /* SEARCH ICT AND CDS ...        */
         MVI   TSLFUNCT(@03),X'04'                                 1634
*   TSLSSMD=M1CSMD;                 /* ... THE CDS MODID SYSMOD      */
         L     @14,@PC00022                                        1635
         MVC   TSLSSMD(7,@15),M1CSMD(@14)                          1635
*   TSLSOICT=ON;                    /* ...                           */
*   TSLSOCDS=ON;                    /* ...                           */
         OI    TSLSOICT(@15),B'11000000'                           1637
*   CALL HMASMTSB(TSLPARMS);        /* ...                           */
         ST    @03,@AL00001                                        1638
         L     @15,@CV02024                                        1638
         LA    @01,@AL00001                                        1638
         BALR  @14,@15                                             1638
*   IF TSLRETRN>ZERO THEN           /* OTHER THAN FOUND?             */
         L     @03,@PC00001                                        1639
         L     @03,TBLXTSLP(,@03)                                  1639
         CLI   TSLRETRN(@03),0                                     1639
         BNH   @RF01639                                            1639
*     DO;                           /* YES,                          */
*       IF TSLRETRN=TSLNTFND THEN   /* NOT FOUND?                    */
         CLI   TSLRETRN(@03),4                                     1641
         BNE   @RF01641                                            1641
*         DO;                       /* YES,                          */
*           M1CANS=NO;              /* MOD ID SYSMOD IS NOT FOUND IN
*                                      THE ICT OR CDS                */
         L     @03,@PC00022+4                                      1643
         MVI   M1CANS(@03),C'N'                                    1643
*           M1CPART=PART129;        /* 'IS NOT APPLIED'              */
         L     @03,@PC00022+8                                      1644
         MVC   M1CPART(4,@03),@CF02058                             1644
*         END;                                                     1645
*       ELSE                        /* ERROR                         */
*         DO;                                                      1646
         B     @RC01641                                            1646
@RF01641 DS    0H                                                  1647
*           M1CRC=MAX(M1CRC,TSLRETRN);/* SET RETURN CODE             */
         L     @03,@PC00001                                        1647
         L     @03,TBLXTSLP(,@03)                                  1647
         SLR   @15,@15                                             1647
         IC    @15,TSLRETRN(,@03)                                  1647
         CR    M1CRC,@15                                           1647
         BNL   *+6
         LR    M1CRC,@15                                           1647
*         END;                                                     1648
*     END;                                                         1649
*   ELSE                            /* MODID SYSMOD FOUND IN THE ICT
*                                      OR CDS                        */
*     DO;                                                          1650
         B     @RC01639                                            1650
@RF01639 DS    0H                                                  1651
*       IF TSLSIFND=ON THEN         /* FOUND IN THE ICT?             */
         L     @03,@PC00001                                        1651
         L     @03,TBLXTSLP(,@03)                                  1651
         L     @03,TSLPMLAD(,@03)                                  1651
         TM    TSLSIFND(@03),B'10000000'                           1651
         BNO   @RF01651                                            1651
*         DO;                       /* YES                           */
*           M1CPART=PART122;        /* 'IS BEING RESTORED'           */
         L     @15,@PC00022+8                                      1653
         MVC   M1CPART(4,@15),@CF02045                             1653
*           M1CANS=RESTORE;         /* THE MODID SYSMOD IS BEING   1654
*                                      RESTORED                      */
         L     @15,@PC00022+4                                      1654
         MVI   M1CANS(@15),C'R'                                    1654
*           M1CICT@=TSLSICTP;       /* RETURN ICT SMD ENTRY PTR      */
         L     @15,@PC00022+12                                     1655
         MVC   M1CICT@(4,@15),TSLSICTP(@03)                        1655
*         END;                                                     1656
*       ELSE                        /* FOUND ON THE CDS              */
*         DO;                                                      1657
         B     @RC01651                                            1657
@RF01651 DS    0H                                                  1658
*           IF TSLSCOK=ON           /* OK ON THE CDS                 */
*               ×TSLSCERR=ON THEN   /* OR IN ERROR                   */
         L     @03,@PC00001                                        1658
         L     @03,TBLXTSLP(,@03)                                  1658
         L     @03,TSLPMLAD(,@03)                                  1658
         TM    TSLSCOK(@03),B'01000010'                            1658
         BZ    @RF01658                                            1658
*             DO;                   /* YES,                          */
*               M1CANS=YES;         /*                               */
         L     @03,@PC00022+4                                      1660
         MVI   M1CANS(@03),C'Y'                                    1660
*               M1CPART=PART121;    /* 'IS APPLIED'                  */
         L     @03,@PC00022+8                                      1661
         MVC   M1CPART(4,@03),@CF02043                             1661
*             END;                                                 1662
*           ELSE                    /* ON CDS BUT NOT OK             */
*             DO;                                                  1663
         B     @RC01658                                            1663
@RF01658 DS    0H                                                  1664
*               IF TSLSISUP=ON THEN /* IS IT SUP'ED                  */
         L     @03,@PC00001                                        1664
         L     @03,TBLXTSLP(,@03)                                  1664
         L     @03,TSLPMLAD(,@03)                                  1664
         TM    TSLSISUP(@03),B'00100000'                           1664
         BNO   @RF01664                                            1664
*                 DO;               /* YES,                          */
*                   M1CANS=NO;      /*                               */
         L     @03,@PC00022+4                                      1666
         MVI   M1CANS(@03),C'N'                                    1666
*                   M1CPART=PART100;/* 'IS SUPERCEDED'               */
         L     @03,@PC00022+8                                      1667
         MVC   M1CPART(4,@03),@CF00349                             1667
*                 END;                                             1668
*               ELSE                /*                               */
*                 DO;                                              1669
         B     @RC01664                                            1669
@RF01664 DS    0H                                                  1670
*                   M1CANS=NO;      /*                               */
         L     @03,@PC00022+4                                      1670
         MVI   M1CANS(@03),C'N'                                    1670
*                   M1CPART=PART099;/* 'IS DELETED'                  */
         L     @03,@PC00022+8                                      1671
         MVC   M1CPART(4,@03),@CF02040                             1671
*                 END;                                             1672
*             END;                                                 1673
@RC01664 DS    0H                                                  1674
*         END;                                                     1674
@RC01658 DS    0H                                                  1675
*     END;                                                         1675
@RC01651 DS    0H                                                  1676
*   RETURN CODE(M1CRC);             /* RETURN W/ RETURN CODE         */
@RC01639 LR    @15,M1CRC                                           1676
         L     @14,@SA00022                                        1676
         LM    @00,@12,@SA00022+8                                  1676
         BR    @14                                                 1676
*   RFY                                                            1677
*     TSLPARMS BASED;                                              1677
*   RFY                                                            1678
*     HMASMIOP BASED;                                              1678
*   END M1CDS;                                                     1679
         EJECT
*                                                                  1680
*/****************************************************************   */
*/*                                                                  */
*/* M1ACDS -                                                         */
*/* OUTPUT - ANSWER                                                  */
*/*           - Y FOUND ON CDS AND OK - N NOT FOUND                  */
*/*           - N NOT FOUND OR FOUND AND NOT OK                      */
*/*           - R FOUND IN THE ICT I.E. TO BE RESTORED               */
*/*        - PART                                                    */
*/*          IF N                                                    */
*/*           - PART099 - 'IS DELETED'                               */
*/*           - PART100 - 'IS SUPERCEEDED'                           */
*/*           - PART129 - 'IS NOT APPLIED'                           */
*/*           - PART125 - 'IS ACCEPTED IN ERROR'                     */
*/*           - PART126 - 'IS ACCEPTED BUT NOT APPLIED'              */
*/*                                                                  */
*/*          IF Y                                                    */
*/*           - PART121 - 'IS APPLIED'                               */
*/*                                                                  */
*/****************************************************************   */
*                                                                  1680
*M1ACDS:                                                           1680
*   PROC(M1ASMD,                    /*                               */
*       M1AANS,                     /*                               */
*       M1APART);                                                  1680
M1ACDS   STM   @14,@12,@SA00023                                    1680
         MVC   @PC00023(12),0(@01)                                 1680
*   DCL                                                            1681
*     M1ASMD CHAR(7);               /* SYSMOD TO CHECK               */
*   DCL                                                            1682
*     M1AANS CHAR(1);               /* (OUTPUT) ANSWER               */
*   DCL                                                            1683
*     M1APART FIXED(31);            /* (OUTPUT) PART NUMBER          */
*   DCL                                                            1684
*     M1ARC FIXED(15);              /* LOCAL RETURN CODE             */
*   DCL                                                            1685
*     1 D2RCRD BASED,               /* DELTA 2 RECORD                */
*      2 D2RKEY,                    /* RECORD KEY                    */
*       3 D2RSMD CHAR(7),           /* SYSMOD NAME                   */
*      2 D2RDATA,                   /* DATA                          */
*       3 D2RFLAGS,                 /* STATUS FLAGS                  */
*         5 D2RFOK BIT(1),          /* NOT IN THE CDS BUT OK         */
*         5 D2RFERR BIT(1),         /* IN ERROR                      */
*         5 D2RFDEL BIT(1),         /* DELETED                       */
*         5 * BIT(5);               /* UNUSED                        */
*   RFY                                                            1686
*     HMASMGTP BASED(TBLXD2GT);                                    1686
*   RFY                                                            1687
*     D2RCRD BASED(GTPBUFAD);                                      1687
*   M1ARC=ZERO;                     /* CLEAR RETURN CODE             */
         SLR   M1ARC,M1ARC                                         1688
*                                                                  1689
*   /*****************************************************************/
*   /*                                                               */
*   /* SEARCH THE DELTA 2 LIST                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1689
*   GTPFUNCT=GTPLOC;                /* LOCATE THE SYSMOD IN THE D2 1689
*                                      GTA FILE                      */
         L     @03,@PC00001                                        1689
         L     @03,TBLXD2GT(,@03)                                  1689
         MVI   GTPFUNCT(@03),X'03'                                 1689
*   D2RSMD=M1ASMD;                  /* ...                           */
         L     @01,GTPBUFAD(,@03)                                  1690
         L     @15,@PC00023                                        1690
         MVC   D2RSMD(7,@01),M1ASMD(@15)                           1690
*   CALL HMASMGTA(HMASMGTP);        /* ...                           */
         ST    @03,@AL00001                                        1691
         L     @15,@CV02020                                        1691
         LA    @01,@AL00001                                        1691
         BALR  @14,@15                                             1691
*   IF GTPRETRN=GTPGOOD THEN        /* FOUND IN DELTA 2              */
         L     @03,@PC00001                                        1692
         L     @03,TBLXD2GT(,@03)                                  1692
         CLI   GTPRETRN(@03),0                                     1692
         BNE   @RF01692                                            1692
*     DO;                           /* YES,                          */
*       M1AANS=NO;                  /* ERROR                         */
         L     @15,@PC00023+4                                      1694
         MVI   M1AANS(@15),C'N'                                    1694
*       IF D2RFOK=ON THEN           /* OK IN THE DELTA 2 LIST        */
         L     @03,GTPBUFAD(,@03)                                  1695
         TM    D2RFOK(@03),B'10000000'                             1695
         BNO   @RF01695                                            1695
*         DO;                       /* YES,                          */
*           M1APART=PART126;        /* 'IS ACCEPTED BUT NOT APPLIED' */
         L     @03,@PC00023+8                                      1697
         MVC   M1APART(4,@03),@CF02052                             1697
*         END;                                                     1698
*       ELSE                        /* NOT OK ON THE ACDS            */
*         DO;                       /* YES,                          */
         B     @RC01695                                            1699
@RF01695 DS    0H                                                  1700
*           IF D2RFERR=ON THEN      /* IN ERROR ON THE ACDS          */
         L     @03,@PC00001                                        1700
         L     @03,TBLXD2GT(,@03)                                  1700
         L     @03,GTPBUFAD(,@03)                                  1700
         TM    D2RFERR(@03),B'01000000'                            1700
         BNO   @RF01700                                            1700
*             DO;                   /* YES,                          */
*               M1APART=PART125;    /* 'IS ACCEPTED IN ERROR'        */
         L     @03,@PC00023+8                                      1702
         MVC   M1APART(4,@03),@CF01904                             1702
*             END;                                                 1703
*           ELSE                    /* NOT IN ERROR                  */
*             DO;                   /* YES,                          */
         B     @RC01700                                            1704
@RF01700 DS    0H                                                  1705
*               M1APART=PART099;    /* 'IS DELETED'                  */
         L     @03,@PC00023+8                                      1705
         MVC   M1APART(4,@03),@CF02040                             1705
*             END;                                                 1706
*         END;                                                     1707
*     END;                                                         1708
*   ELSE                                                           1709
*     DO;                                                          1709
         B     @RC01692                                            1709
@RF01692 DS    0H                                                  1710
*       M1AANS=YES;                 /* OK ON THE ACDS                */
         L     @03,@PC00023+4                                      1710
         MVI   M1AANS(@03),C'Y'                                    1710
*       M1APART=PART121;            /* 'IS APPLIED'                  */
         L     @03,@PC00023+8                                      1711
         MVC   M1APART(4,@03),@CF02043                             1711
*     END;                                                         1712
*                                                                  1712
*   /*****************************************************************/
*   /*                                                               */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1713
*   RETURN CODE(M1ARC);             /* RETURN W/ RETURN CODE         */
@RC01692 LR    @15,M1ARC                                           1713
         L     @14,@SA00023                                        1713
         LM    @00,@12,@SA00023+8                                  1713
         BR    @14                                                 1713
*   RFY                                                            1714
*     HMASMGTP BASED;                                              1714
*   RFY                                                            1715
*     D2RCRD BASED;                                                1715
*   END M1ACDS;                                                    1716
         EJECT
*                                                                  1717
*/****************************************************************   */
*/*                                                                  */
*/* VRSCHECK - CHECK CDS FMID FOR VERSIONING                         */
*/*                                                                  */
*/* OUTPUT - ANSWER                                                  */
*/*           - Y VERSIONING OCCURRED AND THEREFORE NO FMID ERROR    */
*/*           - N VERSIONING DID NOT OCCURER                         */
*/*                                                                  */
*/****************************************************************   */
*                                                                  1717
*VRSCHECK:                                                         1717
*   PROC(VRSCSMD,                   /*                               */
*       VRSCELM,                    /*                               */
*       VRSCANS);                                                  1717
VRSCHECK STM   @14,@12,@SA00024                                    1717
         MVC   @PC00024(12),0(@01)                                 1717
*   DCL                                                            1718
*     VRSCSMD CHAR(7);              /* SYSMOD TO CHECK               */
*   DCL                                                            1719
*     VRSCELM CHAR(*);              /* ICT MOD ENTRY FOR ELEMENT     */
*   DCL                                                            1720
*     VRSCANS CHAR(1);              /* (OUTPUT) ANSWER               */
*   DCL                                                            1721
*     VRSCRC FIXED(15);             /* LOCAL RETURN CODE             */
*   DCL                                                            1722
*     VRSDUMMY CHAR(1);             /* DUMMY PARM FOR CALL TO      1722
*                                      SUBROUTINE                    */
*   RFY                                                            1723
*     ICTMOD BASED(ADDR(VRSCELM));                                 1723
*   VRSCRC=ZERO;                    /* CLEAR RETURN CODE             */
         SLR   VRSCRC,VRSCRC                                       1724
*   VRSCANS=NO;                     /* ASSUME NOT VERSIONED ANSWER   */
         L     @02,@PC00024+8                                      1725
         MVI   VRSCANS(@02),C'N'                                   1725
*   CALL SRHXRF(VRSCSMD,            /*                               */
*       VRSCELM,                    /*                               */
*       VRSDUMMY);                  /*                               */
         L     @02,@PC00024                                        1726
         ST    @02,@AL00001                                        1726
         L     @02,@PC00024+4                                      1726
         ST    @02,@AL00001+4                                      1726
         LA    @02,VRSDUMMY                                        1726
         ST    @02,@AL00001+8                                      1726
         LA    @01,@AL00001                                        1726
         BAL   @14,SRHXRF                                          1726
*   RFY                                                            1727
*     RTNCODE RSTD;                                                1727
*   IF RTNCODE=IOPNTFND THEN        /* NOT FOUND?                    */
         CH    RTNCODE,@CH00039                                    1728
         BNE   @RF01728                                            1728
*     DO;                           /* YES,                          */
*       RFY                                                        1730
*         RTNCODE UNRSTD;                                          1730
*       VRSCANS=YES;                /* ELEMENT WAS VERSIONED         */
         L     @02,@PC00024+8                                      1731
         MVI   VRSCANS(@02),C'Y'                                   1731
*     END;                          /*                               */
*   ELSE                                                           1733
*     ;                             /*                               */
@RF01728 DS    0H                                                  1734
*   RETURN CODE(VRSCRC);            /* RETURN W/ RETURN CODE         */
         LR    @15,VRSCRC                                          1734
         L     @14,@SA00024                                        1734
         LM    @00,@12,@SA00024+8                                  1734
         BR    @14                                                 1734
*   RFY                                                            1735
*     ICTMOD BASED;                                                1735
*   END VRSCHECK;                                                  1736
         EJECT
*                                                                  1737
*/****************************************************************   */
*/*                                                                  */
*/* REGRCHK - SEARCH XRF GTA FILE FOR ELEMENT FOR THAT SYSMOD        */
*/*                                                                  */
*/* OUTPUT - RETURN CODE                                             */
*/*              0  - IS A REGRESSED ELEMENT IN THE SYSMOD           */
*/*              4  - NOT A REGRESSED ELEMENT IN THE SYSMOD          */
*/*                                                                  */
*/****************************************************************   */
*                                                                  1737
*REGRCHK:                                                          1737
*   PROC(REGRIOP,                   /*                               */
*       REGRSMD,                    /*                               */
*       REGRELM);                   /*                               */
REGRCHK  STM   @14,@12,@SA00025                                    1737
         MVC   @PC00025(12),0(@01)                                 1737
*   DCL                                                            1738
*     REGRIOP CHAR(*);              /* EXTENDED IOP                  */
*   DCL                                                            1739
*     REGRSMD CHAR(7);              /* SYSMOD TO CHECK               */
*   DCL                                                            1740
*     REGRELM CHAR(*);              /* ICT MOD ENTRY FOR ELEMENT     */
*   DCL                                                            1741
*     REGRRC FIXED(15);             /* LOCAL RETURN CODE             */
*   DCL                                                            1742
*     REGRPIND FIXED(8);            /* IOPPIND VALUE FOR ELEMENT     */
*   DCL                                                            1743
*     REGRX1 FIXED(31);             /* INDEX FOR IOP SUB-ENTRY SEARCH*/
*   RFY                                                            1744
*     HMASMIOP BASED(ADDR(REGRIOP));                               1744
*   RFY                                                            1745
*     ICTMOD BASED(ADDR(REGRELM));                                 1745
*   REGRRC=IOPNTFND;                /* RC SET TO ASSUME NO REGRESS   */
         LA    REGRRC,4                                            1746
*   CALL SRHXRF(REGRSMD,            /*                               */
*       REGRELM,                    /*                               */
*       REGRPIND);                  /*                               */
         L     @03,@PC00025+4                                      1747
         ST    @03,@AL00001                                        1747
         L     @03,@PC00025+8                                      1747
         ST    @03,@AL00001+4                                      1747
         LA    @03,REGRPIND                                        1747
         ST    @03,@AL00001+8                                      1747
         LA    @01,@AL00001                                        1747
         BAL   @14,SRHXRF                                          1747
*   IF REGRPIND>IOPPREG THEN        /* A REGRESSED ENTRY?            */
         CLI   REGRPIND,80                                         1748
         BNH   @RF01748                                            1748
*     DO;                           /* YES,                          */
*       REGRRC=ZERO;                /* ELEMENT IS REGRESSED RC       */
         SLR   REGRRC,REGRRC                                       1750
*     END;                                                         1751
*   ELSE                            /* NOT A REGRESSED ENTRY         */
*     DO;                                                          1752
         B     @RC01748                                            1752
@RF01748 DS    0H                                                  1753
*       IF REGRPIND=IOPPASM         /* IS THE ENTRY TYPE ASSEMBLY ...*/
*           &ICTMMOD(1)=ON          /* ... AND A MOD REPLACEMENT     */
*           &ICTMASM(1)=OFF THEN    /* ...                           */
         CLI   REGRPIND,8                                          1753
         BNE   @RF01753                                            1753
         L     @03,@PC00025+8                                      1753
         TM    ICTMMOD(@03),B'10000000'                            1753
         BNO   @RF01753                                            1753
         TM    ICTMASM(@03),B'01000000'                            1753
         BNZ   @RF01753                                            1753
*         DO;                       /* YES, THEN THERE MAY OR MAY NOT
*                                      BE A MOD ELEMENT IN THE SYSMOD
*                                      ENTRY                         */
*           IOPDSID=IOPCDS;         /* LOCATE ...                    */
         L     @03,@PC00025                                        1755
         MVI   IOPDSID(@03),X'02'                                  1755
*           IOPTYPE=IOPSMD;         /* ... SYSMOD ...                */
         MVI   IOPTYPE(@03),X'0B'                                  1756
*           IOPNAME=REGRSMD;        /* ... SPECIFIED BY CALLER       */
         MVI   IOPNAME+7(@03),C' '                                 1757
         L     @15,@PC00025+4                                      1757
         MVC   IOPNAME(7,@03),REGRSMD(@15)                         1757
*           CALL HMASMIO(HMASMIOP); /* ...                           */
         ST    @03,@AL00001                                        1758
         L     @15,@CV02017                                        1758
         LA    @01,@AL00001                                        1758
         BALR  @14,@15                                             1758
*           IF IOPRETRN^=ZERO THEN  /* ERROR OCCURRED?               */
         L     @03,@PC00025                                        1759
         CLI   IOPRETRN(@03),0                                     1759
         BE    @RF01759                                            1759
*             DO;                   /* YES,                          */
*               REGRRC=MAX(REGRRC,IOPRETRN);/* SAVE RETURN CODE      */
         SLR   @15,@15                                             1761
         IC    @15,IOPRETRN(,@03)                                  1761
         CR    REGRRC,@15                                          1761
         BNL   *+6
         LR    REGRRC,@15                                          1761
*             END;                  /*                               */
*           ELSE                    /*                               */
*             DO;                                                  1763
         B     @RC01759                                            1763
@RF01759 DS    0H                                                  1764
*               DO REGRX1=1 BY 1    /* LOOP THRU ALL SYSMOD        1764
*                                      SUB-ENTRIES                   */
*                     WHILE(IOPPTFND(REGRX1)^=IOPEOLST);           1764
         LA    REGRX1,1                                            1764
         B     @DE01764                                            1764
@DL01764 DS    0H                                                  1765
*                 IF IOPPIND(REGRX1)=IOPPRMOD/* REGRESSED MOD ...    */
*                     &IOPPMODS(REGRX1)=ICTMNAME(1) THEN/* ... AND 1765
*                                      MATCH?                        */
         LR    @15,REGRX1                                          1765
         MH    @15,@CH00035                                        1765
         L     @14,@PC00025                                        1765
         SLR   @07,@07                                             1765
         IC    @07,IOPPIND-9(@15,@14)                              1765
         CH    @07,@CH00599                                        1765
         BNE   @RF01765                                            1765
         L     @07,@PC00025+8                                      1765
         ALR   @14,@15                                             1765
         CLC   IOPPMODS-9(8,@14),ICTMNAME(@07)                     1765
         BNE   @RF01765                                            1765
*                   DO;             /* YES,                          */
*                     REGRRC=ZERO;  /* INDICATE REGRESSION FOUND     */
         SLR   REGRRC,REGRRC                                       1767
*                   END;            /*                               */
*                 ELSE                                             1769
*                   ;               /* CONTINUE SEARCH               */
@RF01765 DS    0H                                                  1770
*               END;                                               1770
         AH    REGRX1,@CH00064                                     1770
@DE01764 LR    @15,REGRX1                                          1770
         MH    @15,@CH00035                                        1770
         L     @14,@PC00025                                        1770
         SLR   @07,@07                                             1770
         IC    @07,IOPPTFND-9(@15,@14)                             1770
         CH    @07,@CH00707                                        1770
         BNE   @DL01764                                            1770
*             END;                                                 1771
*         END;                      /*                               */
@RC01759 DS    0H                                                  1773
*     END;                                                         1773
@RF01753 DS    0H                                                  1774
*   RETURN CODE(REGRRC);            /* RETURN W/ RETURN CODE         */
@RC01748 LR    @15,REGRRC                                          1774
         L     @14,@SA00025                                        1774
         LM    @00,@12,@SA00025+8                                  1774
         BR    @14                                                 1774
*   RFY                                                            1775
*     HMASMIOP BASED;                                              1775
*   RFY                                                            1776
*     ICTMOD BASED;                                                1776
*   END REGRCHK;                                                   1777
         EJECT
*                                                                  1778
*/****************************************************************   */
*/*                                                                  */
*/* SRHXRF - SEARCH XRF GTA FILE FOR ELEMENT FOR THAT SYSMOD         */
*/*                                                                  */
*/* OUTPUT                                                           */
*/*     RETURN CODES                                                 */
*/*         0  - ELEMENT FOUND                                       */
*/*         4  - ELEMENT NOT FOUND                                   */
*/*     REGRESSION INDICATOR                                         */
*/*         'R' - ELEMENT IS FOUND AND REGRESSED                     */
*/*         ' ' - IS NOT REGRESSED                                   */
*/*                                                                  */
*/****************************************************************   */
*                                                                  1778
*SRHXRF:                                                           1778
*   PROC(SRHXSMD,                   /*                               */
*       SRHXELM,                    /*                               */
*       SRHXPIND);                  /* OUTPUT IOPPIND VALUE FROM XRF
*                                      RECORD                        */
SRHXRF   STM   @14,@12,@SA00026                                    1778
         MVC   @PC00026(12),0(@01)                                 1778
*   DCL                                                            1779
*     SRHXSMD CHAR(7);              /* SYSMOD TO CHECK               */
*   DCL                                                            1780
*     SRHXELM CHAR(*);              /* ICT MOD ENTRY FOR ELEMENT     */
*   DCL                                                            1781
*     SRHXPIND FIXED(8);            /* IOPPIND VALUE (OUTPUT)        */
*   DCL                                                            1782
*     SRHXRC FIXED(15);             /* LOCAL RETURN CODE             */
*   DCL                                                            1783
*     SRHXRFT FIXED(8);             /* XRF TYPE VALUE                */
*   DCL                                                            1784
*     SRHXIOP CHAR(1);              /* IOPTYPE VALUE RETURNED BY   1784
*                                      CONVERT RTN                   */
*   DCL                                                            1785
*     1 SRHXFLGS,                   /*                               */
*       3 SRHXENDM BIT(1),          /* END OF ELEMENT IN THE GTA FLAG*/
*       3 * BIT(7);                 /*                               */
*   RFY                                                            1786
*     ICTMOD BASED(ADDR(SRHXELM));                                 1786
*   RFY                                                            1787
*     HMASMGTP BASED(ADDR(MXOUTGTP));                              1787
*   SRHXRC=IOPNTFND;                /* ASSUME ELEMENT NOT FOUND      */
         LA    SRHXRC,4                                            1788
*   SRHXPIND=''B;                   /* ASSUME NO REGRESSION ELEMENT  */
         L     @03,@PC00026+8                                      1789
         SLR   @15,@15                                             1789
         STC   @15,SRHXPIND(,@03)                                  1789
*   SRHXFLGS=''B;                   /* CLEAR LOCAL FLAGS             */
         MVI   SRHXFLGS,X'00'                                      1790
*   GTPBUFAD=ADDR(XRFRCD);          /* INITIALIZE XRF GTP            */
         LA    @03,MXOUTGTP                                        1791
         LA    @15,XRFRCD                                          1791
         ST    @15,GTPBUFAD(,@03)                                  1791
*   GTPKEYLN=LENGTH(XRFETYPE)       /* ...                           */
*       +LENGTH(XRFENAME)+LENGTH(XRFRTYPE);/*                        */
*                                                                  1792
         MVC   GTPKEYLN(2,@03),@CH00036                            1792
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE AND POSITION TO 1ST XRF RECORD FOR CURRENT MOD     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1793
*   CALL CNVTYP1(ICTMOD(1),         /* CONVERT ICT TYPE TO IOPTYPE   */
*       SRHXIOP,SRHXRFT);                                          1793
         MVC   @AL00001+4(8),@AL01793                              1793
         L     @03,@PC00026+4                                      1793
         ST    @03,@AL00001                                        1793
         LA    @01,@AL00001                                        1793
         BAL   @14,CNVTYP1                                         1793
*   XRFRCD=''B;                     /* CLEAR RECORD                  */
         XC    XRFRCD(30),XRFRCD                                   1794
*   XRFETYPE=SRHXIOP;               /* SET TYPE ...                  */
         MVC   XRFETYPE(1),SRHXIOP                                 1795
*   XRFENAME=ICTMNAME(1);           /* ... AND NAME                  */
         L     @03,@PC00026+4                                      1796
         MVC   XRFENAME(8),ICTMNAME(@03)                           1796
*   XRFRTYPE=SRHXRFT;               /* XRF PTF BY TYPE               */
         MVC   XRFRTYPE(1),SRHXRFT                                 1797
*   GTPFUNCT=GTPLOC;                /* LOCATE ...                    */
         LA    @03,MXOUTGTP                                        1798
         MVI   GTPFUNCT(@03),X'03'                                 1798
*   CALL HMASMGTA(HMASMGTP);        /* ... FIRST RECORD FOR MOD      */
         ST    @03,@AL00001                                        1799
         L     @15,@CV02020                                        1799
         LA    @01,@AL00001                                        1799
         BALR  @14,@15                                             1799
*   GTPFUNCT=GTPSTRTN;              /* POSITION ...                  */
         LA    @03,MXOUTGTP                                        1800
         MVI   GTPFUNCT(@03),X'06'                                 1800
*   CALL HMASMGTA(HMASMGTP);        /* ... FOR GET NEXT              */
         ST    @03,@AL00001                                        1801
         L     @15,@CV02020                                        1801
         LA    @01,@AL00001                                        1801
         BALR  @14,@15                                             1801
*   SRHXENDM=OFF;                   /* CLEAR END OF MOD FLAG         */
         NI    SRHXENDM,B'01111111'                                1802
*   GTPFUNCT=GTPGETN;               /* SET FUNCTION FOR GET NEXT     */
*                                                                  1803
         LA    @03,MXOUTGTP                                        1803
         MVI   GTPFUNCT(@03),X'08'                                 1803
*   /*****************************************************************/
*   /*                                                               */
*   /* LOOP THRU ALL RECORDS IN THE GTA WITH SAME NAME AND TYPE AS   */
*   /* SPECIFIED IN THE INPUT. THE LOOP SEARCHES FOR A RECORD FOR THE*/
*   /* SYSMOD NAME SPECIFIED BY THE CALLER.                          */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1804
*   DO WHILE(SRHXENDM=OFF           /*                               */
*         &SRHXRC<STOPSMD);         /*                               */
         B     @DE01804                                            1804
@DL01804 DS    0H                                                  1805
*     CALL HMASMGTA(HMASMGTP);      /* ... FOR GET NEXT              */
         LA    @03,MXOUTGTP                                        1805
         ST    @03,@AL00001                                        1805
         L     @15,@CV02020                                        1805
         LA    @01,@AL00001                                        1805
         BALR  @14,@15                                             1805
*     IF GTPRETRN^=ZERO THEN        /* NON-ZERO RETURN CODE?         */
         LA    @03,MXOUTGTP                                        1806
         CLI   GTPRETRN(@03),0                                     1806
         BE    @RF01806                                            1806
*       DO;                         /* YES,                          */
*         SRHXENDM=ON;              /* END OF MOD                    */
         OI    SRHXENDM,B'10000000'                                1808
*         IF GTPRETRN^=GTPEOF THEN  /* RC IS OTHER THAN EOF?         */
         CLI   GTPRETRN(@03),4                                     1809
         BE    @RF01809                                            1809
*           DO;                     /*                               */
*             SRHXRC=MAX(SRHXRC,GTPRETRN);/* SET RETURN CODE         */
         SLR   @15,@15                                             1811
         IC    @15,GTPRETRN(,@03)                                  1811
         CR    SRHXRC,@15                                          1811
         BNL   *+6
         LR    SRHXRC,@15                                          1811
*           END;                                                   1812
*       END;                                                       1813
*     ELSE                          /* RECORD FOUND IN THE GTA       */
*       DO;                                                        1814
         B     @RC01806                                            1814
@RF01806 DS    0H                                                  1815
*         IF XRFETYPE^=SRHXIOP      /* DIFFERENT TYPE ...            */
*             ×XRFENAME^=ICTMNAME(1) THEN/* ... OR ELEMENT?          */
         CLC   XRFETYPE(1),SRHXIOP                                 1815
         BNE   @RT01815                                            1815
         L     @03,@PC00026+4                                      1815
         CLC   XRFENAME(8),ICTMNAME(@03)                           1815
         BE    @RF01815                                            1815
@RT01815 DS    0H                                                  1816
*           DO;                     /*                               */
*             SRHXENDM=ON;          /* SIGNAL END OF ELEMENTS IN THE
*                                      GTP                           */
         OI    SRHXENDM,B'10000000'                                1817
*           END;                    /*                               */
*         ELSE                      /* RECORD FOR CURRENT ELEMENT    */
*           DO;                                                    1819
         B     @RC01815                                            1819
@RF01815 DS    0H                                                  1820
*             IF XRF3PTF=SRHXSMD THEN/* IS RECORD FOR CORRECT SYSMOD */
         L     @03,@PC00026                                        1820
         CLC   XRF3PTF(7),SRHXSMD(@03)                             1820
         BNE   @RF01820                                            1820
*               DO;                 /* YES,                          */
*                 SRHXRC=ZERO;      /* INDICATE MATCHING ENTRY FOUND */
         SLR   SRHXRC,SRHXRC                                       1822
*                 SRHXPIND=XRF3PIND;/* RETURN THE IOPPIND TO CALLER  */
         L     @03,@PC00026+8                                      1823
         MVC   SRHXPIND(1,@03),XRF3PIND                            1823
*               END;                /*                               */
*             ELSE                                                 1825
*               ;                   /* MATCHING ELEMENT BUT DIFFERNT
*                                      SYSMOD                        */
@RF01820 DS    0H                                                  1826
*           END;                                                   1826
*       END;                                                       1827
@RC01815 DS    0H                                                  1828
*   END;                            /*                               */
@RC01806 DS    0H                                                  1828
@DE01804 TM    SRHXENDM,B'10000000'                                1828
         BNZ   @DC01804                                            1828
         CH    SRHXRC,@CH00034                                     1828
         BL    @DL01804                                            1828
@DC01804 DS    0H                                                  1829
*   RETURN CODE(SRHXRC);            /* RETURN W/ RETURN CODE         */
         LR    @15,SRHXRC                                          1829
         L     @14,@SA00026                                        1829
         LM    @00,@12,@SA00026+8                                  1829
         BR    @14                                                 1829
*   RFY                                                            1830
*     ICTMOD BASED;                                                1830
*   END SRHXRF;                                                    1831
*   END MODID1CK;                                                  1832
*   END MODIDCHK;                                                  1833
         EJECT
*                                                                  1834
*   /*****************************************************************/
*   /*                                                               */
*   /* TRMCLEAN -                                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1834
*TRMCLEAN:                                                         1834
*   PROC;                                                          1834
TRMCLEAN STM   @14,@12,@SA00027                                    1834
*   DCL                                                            1835
*     TRMCRC FIXED(15);             /* LOCAL RETURN CODE             */
*   TRMCRC=ZERO;                    /* CLEAR LOCAL RETURN CODE       */
         SLR   TRMCRC,TRMCRC                                       1836
*                                                                  1837
*   /*****************************************************************/
*   /*                                                               */
*   /* FREE LOCAL GTA FILES - XRF SELECT FILE AND XRF OUTPUT FILE    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1837
*   RFY                                                            1837
*     HMASMGTP BASED(ADDR(MXOUTGTP));                              1837
*   GTPFUNCT=GTPFREE;               /* FREE THE GTA FILE             */
         LA    @03,MXOUTGTP                                        1838
         MVI   GTPFUNCT(@03),X'0A'                                 1838
*   CALL HMASMGTA(HMASMGTP);        /* ...                           */
         ST    @03,@AL00001                                        1839
         L     @15,@CV02020                                        1839
         LA    @01,@AL00001                                        1839
         BALR  @14,@15                                             1839
*   RFY                                                            1840
*     HMASMGTP BASED(ADDR(MSELGTP));                               1840
*   GTPFUNCT=GTPFREE;               /* FREE THE GTA FILE             */
         LA    @03,MSELGTP                                         1841
         MVI   GTPFUNCT(@03),X'0A'                                 1841
*   CALL HMASMGTA(HMASMGTP);        /* ...                           */
         ST    @03,@AL00001                                        1842
         L     @15,@CV02020                                        1842
         LA    @01,@AL00001                                        1842
         BALR  @14,@15                                             1842
*   RFY                                                            1843
*     HMASMGTP BASED;                                              1843
*   RFY                                                            1844
*     HMASMGTP BASED(ADDR(ASMGTP));                                1844
*   GTPFUNCT=GTPFREE;               /* FREE THE GTA FILE             */
         LA    @03,ASMGTP                                          1845
         MVI   GTPFUNCT(@03),X'0A'                                 1845
*   CALL HMASMGTA(HMASMGTP);        /* ...                           */
         ST    @03,@AL00001                                        1846
         L     @15,@CV02020                                        1846
         LA    @01,@AL00001                                        1846
         BALR  @14,@15                                             1846
*   RFY                                                            1847
*     HMASMGTP BASED;                                              1847
*   RETURN CODE(TRMCRC);            /* RETURN W/RC SET               */
         LR    @15,TRMCRC                                          1848
         L     @14,@SA00027                                        1848
         LM    @00,@12,@SA00027+8                                  1848
         BR    @14                                                 1848
*   END TRMCLEAN;                                                  1849
         EJECT
*                                                                  1850
*/********************************************************************/
*/*                                                                  */
*/* CNVTYP1 -                                                        */
*/*                                                                  */
*/* INPUT:                                                           */
*/*   ICT MOD ENTRY TYPE FLAGS                                       */
*/*                                                                  */
*/* OUTPUT                                                           */
*/*   - IOP CDS ENTRY TYPE INDICATOR                                 */
*/*   - XRF ENTRY TYPE                                               */
*/*                                                                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  1850
*CNVTYP1:                                                          1850
*   PROC(CNV1ENT,                   /* ICT MOD ENTRY FOR WHICH     1850
*                                      CONVERTED TYPES WILL BE     1850
*                                      RETURNED                      */
*       CNV1IOPT,                   /* (OUTPUT) FIXED(8) IOP TYPE FOR
*                                      ICT ENTRY                     */
*       CNV1XRFT);                  /* (OUTPUT) FIXED(8) XRF TYPE FOR
*                                      ICT ENTRY                     */
CNVTYP1  STM   @14,@12,12(@13)                                     1850
         MVC   @PC00028(12),0(@01)                                 1850
*   DCL                                                            1851
*     CNV1ENT CHAR(*);              /* ICT MOD ENTRY TO PROCESS      */
*   DCL                                                            1852
*     CNV1IOPT FIXED(8);            /* IOPTYPE ENTRY TYPE            */
*   DCL                                                            1853
*     CNV1XRFT FIXED(8);            /* XRFRTYPE ENTRY TYPE           */
*   DCL                                                            1854
*     CNV1RC FIXED(15);             /* LOCAL RETURN CODE             */
*   CNV1IOPT=ZERO;                  /*                               */
         L     @03,@PC00028+4                                      1855
         MVI   CNV1IOPT(@03),X'00'                                 1855
*   CNV1XRFT=ZERO;                  /*                               */
         L     @15,@PC00028+8                                      1856
         MVI   CNV1XRFT(@15),X'00'                                 1856
*   RFY                                                            1857
*     ICTMOD BASED(ADDR(CNV1ENT));                                 1857
*   CNV1RC=ZERO;                    /* CLEAR LOCAL RETURN CODE       */
         SLR   CNV1RC,CNV1RC                                       1858
*   IF ICTMMOD(1)=ON THEN           /* ICT MOD TYPE?                 */
         L     @14,@PC00028                                        1859
         TM    ICTMMOD(@14),B'10000000'                            1859
         BNO   @RF01859                                            1859
*     DO;                           /* YES,                          */
*       CNV1XRFT=XRFPBYMD;          /* XRF TYPE IS PTF HISTORY FOR 1861
*                                      MOD                           */
         MVI   CNV1XRFT(@15),X'2F'                                 1861
*       IF ICTMASM(1)=ON THEN       /* ICT MOD TO BE ASSEMBLED       */
         TM    ICTMASM(@14),B'01000000'                            1862
         BNO   @RF01862                                            1862
*         DO;                       /* YES,                          */
*           CNV1IOPT=IOPMOD;        /* IOP TYPE IS MOD               */
         MVI   CNV1IOPT(@03),X'05'                                 1864
*         END;                                                     1865
*       ELSE                        /* IS A MOD                      */
*         DO;                                                      1866
         B     @RC01862                                            1866
@RF01862 DS    0H                                                  1867
*           CNV1IOPT=IOPMOD;        /* IOP TYPE IS MOD               */
         L     @03,@PC00028+4                                      1867
         MVI   CNV1IOPT(@03),X'05'                                 1867
*         END;                                                     1868
*     END;                                                         1869
*   ELSE                                                           1870
*     IF ICTMMACR(1)=ON THEN        /* ICT MAC TYPE?                 */
         B     @RC01859                                            1870
@RF01859 L     @03,@PC00028                                        1870
         TM    ICTMMACR(@03),B'00001000'                           1870
         BNO   @RF01870                                            1870
*       DO;                         /* YES,                          */
*         CNV1IOPT=IOPMAC;          /* IOP TYPE IS MACRO             */
         L     @03,@PC00028+4                                      1872
         MVI   CNV1IOPT(@03),X'03'                                 1872
*         CNV1XRFT=XRFPBYMC;        /* XRF TYPE IS PTF HISTORY FOR 1873
*                                      MACRO                         */
         L     @03,@PC00028+8                                      1873
         MVI   CNV1XRFT(@03),X'25'                                 1873
*       END;                                                       1874
*     ELSE                                                         1875
*       IF ICTMSRCR(1)=ON THEN      /* ICT SRC TYPE?                 */
         B     @RC01870                                            1875
@RF01870 L     @03,@PC00028                                        1875
         TM    ICTMSRCR(@03),B'00000010'                           1875
         BNO   @RF01875                                            1875
*         DO;                       /* YES,                          */
*           CNV1IOPT=IOPSRC;        /* IOP TYPE IS SOURCE            */
         L     @03,@PC00028+4                                      1877
         MVI   CNV1IOPT(@03),X'08'                                 1877
*           CNV1XRFT=XRFPBYSC;      /* XRF TYPE IS PTF HISTORY FOR 1878
*                                      SOURCE                        */
         L     @03,@PC00028+8                                      1878
         MVI   CNV1XRFT(@03),X'39'                                 1878
*         END;                                                     1879
*       ELSE                                                       1880
*         ;                                                        1880
@RF01875 DS    0H                                                  1881
*   RETURN CODE(CNV1RC);            /* RETURN W/RC SET               */
@RC01870 DS    0H                                                  1881
@RC01859 LR    @15,CNV1RC                                          1881
         L     @14,12(,@13)                                        1881
         LM    @00,@12,20(@13)                                     1881
         BR    @14                                                 1881
*   END CNVTYP1;                                                   1882
         EJECT
*                                                                  1883
*/********************************************************************/
*/*                                                                  */
*/* CNVTYP2 -                                                        */
*/*                                                                  */
*/* INPUT:                                                           */
*/*   ICT MOD ENTRY TYPE FLAGS                                       */
*/*                                                                  */
*/* OUTPUT                                                           */
*/*   - SELECT LIST ENTRY TYPE FOR XRF CALL                          */
*/*                                                                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  1883
*CNVTYP2:                                                          1883
*   PROC(CNV2ENT,                   /* ICT MOD ENTRY FOR WHICH     1883
*                                      CONVERTED TYPES WILL BE     1883
*                                      RETURNED                      */
*       CNV2SELT);                  /* (OUTPUT) FIXED(8) XRF SELECT
*                                      LIST TYPE FOR ICT ENTRY       */
CNVTYP2  STM   @14,@12,12(@13)                                     1883
         MVC   @PC00029(8),0(@01)                                  1883
*   DCL                                                            1884
*     CNV2ENT CHAR(*);              /* ICT MOD ENTRY TO PROCESS      */
*   DCL                                                            1885
*     CNV2SELT FIXED(16);           /* XRF SELECT LIST TYPE          */
*   DCL                                                            1886
*     CNV2RC FIXED(15);             /* LOCAL RETURN CODE             */
*   CNV2SELT=ZERO;                  /*                               */
         L     @03,@PC00029+4                                      1887
         SLR   @15,@15                                             1887
         STH   @15,CNV2SELT(,@03)                                  1887
*   RFY                                                            1888
*     ICTMOD BASED(ADDR(CNV2ENT));                                 1888
*   RFY                                                            1889
*     HMASMSET BASED(ADDR(CNV2SELT));                              1889
*   CNV2RC=ZERO;                    /* CLEAR LOCAL RETURN CODE       */
         SLR   CNV2RC,CNV2RC                                       1890
*   IF ICTMMOD(1)=ON THEN           /* ICT MOD TYPE?                 */
         L     @15,@PC00029                                        1891
         TM    ICTMMOD(@15),B'10000000'                            1891
         BNO   @RF01891                                            1891
*     DO;                           /* YES,                          */
*       IF ICTMASM(1)=ON THEN       /* ICT ASM TYPE?                 */
         TM    ICTMASM(@15),B'01000000'                            1893
         BNO   @RF01893                                            1893
*         DO;                       /* YES,                          */
*           SEASM=ON;               /* SELECT LIST TYPE FOR XRF IS 1895
*                                      ASSEMBLY                      */
         OI    SEASM(@03),B'00000100'                              1895
*         END;                                                     1896
*       ELSE                        /* NOT ASSEM, IS MOD             */
*         DO;                       /* YES,                          */
         B     @RC01893                                            1897
@RF01893 DS    0H                                                  1898
*           SEMOD=ON;               /* SELECT LIST TYPE FOR XRF IS 1898
*                                      MOD                           */
         L     @03,@PC00029+4                                      1898
         OI    SEMOD(@03),B'00100000'                              1898
*         END;                      /*                               */
*     END;                                                         1900
*   ELSE                                                           1901
*     IF ICTMMACR(1)=ON THEN        /* ICT MAC TYPE?                 */
         B     @RC01891                                            1901
@RF01891 L     @03,@PC00029                                        1901
         TM    ICTMMACR(@03),B'00001000'                           1901
         BNO   @RF01901                                            1901
*       DO;                         /* YES,                          */
*         SEMAC=ON;                 /* SELECT LIST TYPE FOR XRF IS 1903
*                                      MACRO                         */
         L     @03,@PC00029+4                                      1903
         OI    SEMAC(@03),B'00010000'                              1903
*       END;                                                       1904
*     ELSE                                                         1905
*       IF ICTMSRCR(1)=ON THEN      /* ICT SRC TYPE?                 */
         B     @RC01901                                            1905
@RF01901 L     @03,@PC00029                                        1905
         TM    ICTMSRCR(@03),B'00000010'                           1905
         BNO   @RF01905                                            1905
*         DO;                       /* YES,                          */
*           SESRC=ON;               /* SLECT LIST TYPE FOR XRF IS  1907
*                                      SOURCE                        */
         L     @03,@PC00029+4                                      1907
         OI    SESRC(@03),B'10000000'                              1907
*         END;                                                     1908
*       ELSE                                                       1909
*         ;                                                        1909
@RF01905 DS    0H                                                  1910
*   RETURN CODE(CNV2RC);            /* RETURN W/RC SET               */
@RC01901 DS    0H                                                  1910
@RC01891 LR    @15,CNV2RC                                          1910
         L     @14,12(,@13)                                        1910
         LM    @00,@12,20(@13)                                     1910
         BR    @14                                                 1910
*   END CNVTYP2;                                                   1911
         EJECT
*                                                                  1912
*/********************************************************************/
*/*                                                                  */
*/* CNVTYP3 -                                                        */
*/*                                                                  */
*/* INPUT:                                                           */
*/*   - IOPPIND TYPE FLAG                                            */
*/*                                                                  */
*/* OUTPUT                                                           */
*/*   - ICT MOD ENTRY TYPE IN ICTMFLG1 FORMAT OR ZERO IF NOT AN      */
*/*     ELEMENT TYPE                                                 */
*/*                                                                  */
*/********************************************************************/
*                                                                  1912
*CNVTYP3:                                                          1912
*   PROC(CNV3IND,                   /* SYSMOD IOPPIND ENTRY TYPE   1912
*                                      RETURNED (FIXED(8))           */
*       CNV3ITYP);                  /* (OUTPUT) FIXED(8) ICT MOD TYPE
*                                      IN ICTMFLG1 FORMAT            */
CNVTYP3  STM   @14,@12,12(@13)                                     1912
         MVC   @PC00030(8),0(@01)                                  1912
*   DCL                                                            1913
*     CNV3IND FIXED(8);             /* IOPPIND ENTRY TYPE            */
*   DCL                                                            1914
*     CNV3ITYP FIXED(8);            /* ICT TYPE                      */
*   DCL                                                            1915
*     CNV3RC FIXED(15);             /* LOCAL RETURN CODE             */
*   DCL                                                            1916
*     FLG1OFFS FIXED(15);           /* OFFSET OF ICTMFLG1 IN ICTMOD
*                                      ENTRY                         */
*   DCL                                                            1917
*     CNV3TYP FIXED(8);             /* IOPPIND ENTRY AFTER CORRECTION
*                                      FOR REGRESSION TYPES          */
*   RFY                                                            1918
*     ICTMOD BASED(CCAICMOD);                                      1918
*   FLG1OFFS=ADDR(ICTMFLG1(1))-ADDR(ICTMOD(1));                    1919
         L     @05,CCAICMOD(,CCAPTR)                               1919
         LA    FLG1OFFS,ICTMFLG1(,@05)                             1919
         SLR   FLG1OFFS,@05                                        1919
*   RFY                                                            1920
*     ICTMOD BASED(ADDR(CNV3ITYP)-FLG1OFFS);                       1920
*   CNV3RC=ZERO;                    /* CLEAR LOCAL RETURN CODE       */
         SLR   CNV3RC,CNV3RC                                       1921
*   CNV3ITYP=ZERO;                  /* CLEAR ICT MOD TYPE OUTPUT   1922
*                                      FIELD                         */
         L     @05,@PC00030+4                                      1922
         MVI   CNV3ITYP(@05),X'00'                                 1922
*   CNV3TYP=CNV3IND;                /* ASUME IOPPIND IS NOT REGRSSION*/
         L     @05,@PC00030                                        1923
         SLR   CNV3TYP,CNV3TYP                                     1923
         IC    CNV3TYP,CNV3IND(,@05)                               1923
*   IF CNV3TYP>IOPPREG THEN         /* IS TYPE POSSIBLY A REGRESSION
*                                      TYPE ELEMENT ENTRY?           */
         LA    @05,80                                              1924
         CR    CNV3TYP,@05                                         1924
         BNH   @RF01924                                            1924
*     DO;                           /* YES,                          */
*       CNV3TYP=CNV3TYP-IOPPREG;    /* CLEAR REGRESSION INDICATOR    */
         SLR   CNV3TYP,@05                                         1926
*     END;                          /*                               */
*   ELSE                                                           1928
*     ;                             /* ELEMENT TYPE IS UNCHANGED     */
@RF01924 DS    0H                                                  1929
*   IF CNV3TYP=IOPPMOD THEN                                        1929
         CH    CNV3TYP,@CH00064                                    1929
         BNE   @RF01929                                            1929
*     DO;                                                          1930
*                                                                  1930
*       /*************************************************************/
*       /*                                                           */
*       /* MOD TYPE ENTRY                                            */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1931
*       ICTMMOD(1)=ON;              /* SET ICT MOD SECT INDICATOR    */
         L     @05,@PC00030+4                                      1931
         SLR   @05,FLG1OFFS                                        1931
         OI    ICTMMOD(@05),B'10000000'                            1931
*     END;                                                         1932
*   IF CNV3TYP=IOPPMACR THEN                                       1933
@RF01929 CH    CNV3TYP,@CH00039                                    1933
         BNE   @RF01933                                            1933
*     DO;                                                          1934
*                                                                  1934
*       /*************************************************************/
*       /*                                                           */
*       /* MAC TYPE ENTRY                                            */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1935
*       ICTMMACR(1)=ON;             /* SET ICT MOD SECT INDICATOR    */
         L     @05,@PC00030+4                                      1935
         SLR   @05,FLG1OFFS                                        1935
         OI    ICTMMACR(@05),B'00001000'                           1935
*     END;                                                         1936
*   IF CNV3TYP=IOPPMACU THEN                                       1937
@RF01933 CH    CNV3TYP,@CH00102                                    1937
         BNE   @RF01937                                            1937
*     DO;                                                          1938
*                                                                  1938
*       /*************************************************************/
*       /*                                                           */
*       /* MACUPD TYPE ENTRY                                         */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1939
*       ICTMMACR(1)=ON;             /* SET ICT MOD SECT INDICATOR    */
         L     @05,@PC00030+4                                      1939
         SLR   @05,FLG1OFFS                                        1939
         OI    ICTMMACR(@05),B'00001000'                           1939
*     END;                                                         1940
*   IF CNV3TYP=IOPPSRCR THEN                                       1941
@RF01937 CH    CNV3TYP,@CH00289                                    1941
         BNE   @RF01941                                            1941
*     DO;                                                          1942
*                                                                  1942
*       /*************************************************************/
*       /*                                                           */
*       /* SRC TYPE ENTRY                                            */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1943
*       ICTMSRCR(1)=ON;             /* SET ICT MOD SECT INDICATOR    */
         L     @05,@PC00030+4                                      1943
         SLR   @05,FLG1OFFS                                        1943
         OI    ICTMSRCR(@05),B'00000010'                           1943
*     END;                                                         1944
*   IF CNV3TYP=IOPPSRCU THEN                                       1945
@RF01941 CH    CNV3TYP,@CH00066                                    1945
         BNE   @RF01945                                            1945
*     DO;                                                          1946
*                                                                  1946
*       /*************************************************************/
*       /*                                                           */
*       /* SRCUPD TYPE ENTRY                                         */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1947
*       ICTMSRCR(1)=ON;             /* SET ICT MOD SECT INDICATOR    */
         L     @05,@PC00030+4                                      1947
         SLR   @05,FLG1OFFS                                        1947
         OI    ICTMSRCR(@05),B'00000010'                           1947
*     END;                                                         1948
*   IF CNV3TYP=IOPPZAP              /* IS TYPE A ZAP ...             */
*       ×CNV3TYP=IOPPXPD THEN       /* ... OR AN EXPAND ZAP?         */
@RF01945 CH    CNV3TYP,@CH00273                                    1949
         BE    @RT01949                                            1949
         CH    CNV3TYP,@CH00087                                    1949
         BNE   @RF01949                                            1949
@RT01949 DS    0H                                                  1950
*     DO;                           /* YES,                          */
*                                                                  1950
*       /*************************************************************/
*       /*                                                           */
*       /* ZAP TYPE ENTRY                                            */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1951
*       ICTMMOD(1)=ON;              /* SET ICT MOD ENTRY INDICATOR   */
         L     @05,@PC00030+4                                      1951
         SLR   @05,FLG1OFFS                                        1951
         OI    ICTMMOD(@05),B'10000000'                            1951
*     END;                                                         1952
*   IF CNV3TYP=IOPPASM THEN         /* ASSEMBLY CAUSED BY MACRO      */
@RF01949 CH    CNV3TYP,@CH00034                                    1953
         BNE   @RF01953                                            1953
*     DO;                           /* YES,                          */
*                                                                  1954
*       /*************************************************************/
*       /*                                                           */
*       /* ASM TYPE ENTRY                                            */
*       /*                                                           */
*       /*************************************************************/
*                                                                  1955
*       ICTMMOD(1)=ON;              /* SET ICT MOD ENTRY INDICATOR   */
*       ICTMASM(1)=ON;              /* SET ICT ASM ENTRY INDICATOR   */
         L     @05,@PC00030+4                                      1956
         SLR   @05,FLG1OFFS                                        1956
         OI    ICTMMOD(@05),B'11000000'                            1956
*     END;                                                         1957
*   RETURN CODE(CNV3RC);            /* RETURN W/RC SET               */
@RF01953 LR    @15,CNV3RC                                          1958
         L     @14,12(,@13)                                        1958
         LM    @00,@12,20(@13)                                     1958
         BR    @14                                                 1958
*   END CNVTYP3;                                                   1959
         EJECT
*                                                                  1960
*   /*****************************************************************/
*   /*                                                               */
*   /* FAILSMD -                                                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1960
*FAILSMD:                                                          1960
*   PROC(FSMDENT);                  /* ICT PTF ENTRY FOR SYSMOD TO BE
*                                      FAILED                        */
FAILSMD  STM   @14,@12,@SA00031                                    1960
         MVC   @PC00031(4),0(@01)                                  1960
*   DCL                                                            1961
*     FSMDENT CHAR(*);              /* ICT PTF ENTRY                 */
*   DCL                                                            1962
*     FSMDRC FIXED(15);             /* LOCAL RETURN CODE             */
*   RFY                                                            1963
*     ICTPTF BASED(ADDR(FSMDENT));                                 1963
*   RFY                                                            1964
*     TSLPARMS BASED(TBLXTSLP);                                    1964
*   FSMDRC=ZERO;                    /* CLEAR RETURN CODE             */
         SLR   FSMDRC,FSMDRC                                       1965
*                                                                  1966
*   /*****************************************************************/
*   /*                                                               */
*   /* HMA226I XXXXXXXX PROCESSING TERMINATED ... FOR SYSMOD XXXXXXX */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  1966
*   DO;                             /* HMASMPMG M1(HMA226I)M2(PART011
*                                      )VAR(TBLXFUNC,ICTPTFS(1))TYPE(
*                                      INFO)TARGET(SYSOUT,LOG)       */
*     HMASMMGP=HMASMMGP&&HMASMMGP;  /* SET PARMS TO ZEROS            */
         XC    HMASMMGP(32),HMASMMGP                               1967
*     MGPMGNO1=HMA226I;             /* SET UP MSG 1 CODE             */
         MVC   MGPMGNO1(2),@CH00550                                1968
*     MGPMGNO2=PART011;             /* SET UP MSG 2 CODE             */
         MVC   MGPMGNO2(2),@CH00521                                1969
*     MGPTYPE=MGPINFO;              /* SET MESSAGE TYPE              */
         MVI   MGPTYPE,X'01'                                       1970
*     MGPPRINT='1'B;                /* SET TARGET FLAG               */
*     MGPHLDS='1'B;                 /* SET TARGET FLAG               */
         OI    MGPPRINT,B'10010000'                                1972
*     MGPVARPT(1)=ADDR(TBLXFUNC);   /* SET VARIABLE PTR              */
         L     @03,@PC00001                                        1973
         LA    @03,TBLXFUNC(,@03)                                  1973
         ST    @03,MGPVARPT                                        1973
*     MGPVARPT(2)=ADDR(ICTPTFS(1)); /* SET VARIABLE PTR              */
         L     @03,@PC00031                                        1974
         ST    @03,MGPVARPT+4                                      1974
*     CALL HMASMMSG(HMASMMGP);      /* HAVE MESSAGE ISSUED           */
         L     @15,@CV02018                                        1975
         LA    @01,@AL01975                                        1975
         BALR  @14,@15                                             1975
*   END;                                                           1976
*   ICTPNOGO(1)=ON;                 /* SYSMOD IS NOGO                */
*   ICTPMSG(1)=ON;                  /* MESSAGE ISSUED FOR SYSMOD     */
*   ICTPCPL(1)=ON;                  /* SYSMOD IS COMPLETE            */
         L     @03,@PC00031                                        1979
         OI    ICTPNOGO(@03),B'01110000'                           1979
*   TSLFUNCT=TSLFFUNC;              /* CHECK FOR FAILING FUNCTION ...*/
         L     @15,@PC00001                                        1980
         L     @15,TBLXTSLP(,@15)                                  1980
         MVI   TSLFUNCT(@15),X'07'                                 1980
*   TSLMFUNC=''B;                   /* CLEAR TSB PARM LIST           */
         L     @14,TSLPMLAD(,@15)                                  1981
         XC    TSLMFUNC(8,@14),TSLMFUNC(@14)                       1981
*   TSLMSMD=ICTPTFS(1);             /* ... AND ISSUE MSG IF NEEDED   */
         MVC   TSLMSMD(7,@14),ICTPTFS(@03)                         1982
*   TSLMTYPE=ICTPTYPE(1);           /* ...                           */
         MVC   TSLMTYPE(1,@14),ICTPTYPE(@03)                       1983
*   CALL HMASMTSB(TSLPARMS);        /* ...                           */
         ST    @15,@AL00001                                        1984
         L     @15,@CV02024                                        1984
         LA    @01,@AL00001                                        1984
         BALR  @14,@15                                             1984
*   FSMDRC=MAX(FSMDRC,TSLRETRN);    /* SAVE RC                       */
         L     @03,@PC00001                                        1985
         L     @03,TBLXTSLP(,@03)                                  1985
         SLR   @15,@15                                             1985
         IC    @15,TSLRETRN(,@03)                                  1985
         CR    FSMDRC,@15                                          1985
         BNL   *+6
         LR    FSMDRC,@15                                          1985
*   IF FSMDRC<STOPFUNC THEN         /* NOT A SERIOUS ERROR?          */
         CH    FSMDRC,@CH00033                                     1986
         BNL   @RF01986                                            1986
*     DO;                           /* YES,                          */
*       TSLFUNCT=TSLFRCKR;          /* RESTORE REQ CHECKING          */
         MVI   TSLFUNCT(@03),X'08'                                 1988
*       CALL HMASMTSB(TSLPARMS);    /* ...                           */
         ST    @03,@AL00001                                        1989
         L     @15,@CV02024                                        1989
         LA    @01,@AL00001                                        1989
         BALR  @14,@15                                             1989
*       FSMDRC=MAX(FSMDRC,TSLRETRN);/* SAVE RC                       */
         L     @03,@PC00001                                        1990
         L     @03,TBLXTSLP(,@03)                                  1990
         SLR   @15,@15                                             1990
         IC    @15,TSLRETRN(,@03)                                  1990
         CR    FSMDRC,@15                                          1990
         BNL   *+6
         LR    FSMDRC,@15                                          1990
*     END;                          /*                               */
*   RETURN CODE(FSMDRC);            /* RETURN W/ RETURN CODE         */
@RF01986 LR    @15,FSMDRC                                          1992
         L     @14,@SA00031                                        1992
         LM    @00,@12,@SA00031+8                                  1992
         BR    @14                                                 1992
*   END FAILSMD;                                                   1993
*   END HMASMTRM                    /*                               */
*                                                                  1994
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (HMASMCCA)                                       */
*/*%INCLUDE SYSLIB  (HMASMIOP)                                       */
*/*%INCLUDE SYSLIB  (HMASMICT)                                       */
*/*%INCLUDE SYSLIB  (HMASMMGP)                                       */
*/*%INCLUDE SYSLIB  (HMASMSET)                                       */
*/*%INCLUDE SYSLIB  (HMASMGTP)                                       */
*                                                                  1994
*       ;                                                          1994
@DATA    DS    0H
@CH00064 DC    H'1'
@CH00273 DC    H'2'
@CH00087 DC    H'3'
@CH00102 DC    H'5'
@CH00289 DC    H'6'
@CH00066 DC    H'7'
@CH00035 DC    H'9'
@CH00036 DC    H'10'
@CH00521 DC    H'11'
@CH00033 DC    H'12'
@CH00550 DC    H'27'
@CH01892 DC    H'47'
@CH00599 DC    H'81'
@CH02662 DC    H'116'
@CH02047 DC    H'123'
@CH02665 DC    H'144'
@CH02033 DC    H'183'
@CH02037 DC    H'230'
@CH02035 DC    H'231'
@CH00707 DC    H'255'
@CH02664 DC    H'-172'
         DS    0F
@AL00255 DC    A(LISTPARM)             LIST WITH   3 ARGUMENT(S)
         DC    A(MXOUTGTP)
         DC    A(MSELGTP)
@AL00365 DC    A(@CF00082)             LIST WITH   4 ARGUMENT(S)
         DC    A(@TF00001)
         DC    A(@CF00082)
         DC    A(@TF00002)
@AL00410 DC    A(@CC00659)             LIST WITH   2 ARGUMENT(S)
         DC    A(ENTNAME)
@AL00421 EQU   *                       LIST WITH   3 ARGUMENT(S)
@AL00427 EQU   *                       LIST WITH   3 ARGUMENT(S)
@AL00432 DC    A(BLDENT@)              LIST WITH   3 ARGUMENT(S)
         DC    A(@TF00001)
         DC    A(@CF00082)
@AL00542 DC    A(BLDAIOPT)             LIST WITH   2 ARGUMENT(S)
         DC    A(BLDADUMM)
@AL00671 DC    A(TYPEIOP)              LIST WITH   2 ARGUMENT(S)
         DC    A(TYPEXRF)
@AL00741 DC    A(XRF3PIND)             LIST WITH   2 ARGUMENT(S)
         DC    A(CK1XITYP)
@AL00745 DC    A(CK1XIOPT)             LIST WITH   2 ARGUMENT(S)
         DC    A(CK1XDUMM)
@AL01187 DC    A(M1FCANS)              LIST WITH   3 ARGUMENT(S)
         DC    A(M1FCPART)
         DC    A(M1FCICT@)
@AL01203 DC    A(M1FAANS)              LIST WITH   2 ARGUMENT(S)
         DC    A(M1FAPART)
@AL01287 DC    A(M1FCICT@)             LIST WITH   4 ARGUMENT(S)
         DC    A(HMASMMGP)
         DC    A(M1FCANS)
         DC    A(M1FCPART)
@AL01307 DC    A(M1RCANS)              LIST WITH   3 ARGUMENT(S)
         DC    A(M1RCPART)
         DC    A(M1RCICT@)
@AL01332 DC    A(M1RAANS)              LIST WITH   2 ARGUMENT(S)
         DC    A(M1RAPART)
@AL01363 DC    A(M1RCICT@)             LIST WITH   3 ARGUMENT(S)
         DC    A(HMASMMGP)
         DC    A(M1TPSANS)
@AL01426 DC    A(M1RCICT@)             LIST WITH   4 ARGUMENT(S)
         DC    A(HMASMMGP)
         DC    A(M1RCANS)
         DC    A(M1RCPART)
@AL01453 DC    A(M1UCANS)              LIST WITH   3 ARGUMENT(S)
         DC    A(M1UCPART)
         DC    A(M1UCICT@)
@AL01477 DC    A(M1UAANS)              LIST WITH   2 ARGUMENT(S)
         DC    A(M1UAPART)
@AL01498 DC    A(M1UCICT@)             LIST WITH   4 ARGUMENT(S)
@AL00336 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00803 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00828 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL01607 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL01619 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL01975 DC    A(HMASMMGP)             LIST WITH   1 ARGUMENT(S)
         DC    A(M1UCANS)
         DC    A(M1UCPART)
@AL01604 DC    A(M1MIOPT)              LIST WITH   2 ARGUMENT(S)
         DC    A(M1MDUMMY)
@AL01793 DC    A(SRHXIOP)              LIST WITH   2 ARGUMENT(S)
         DC    A(SRHXRFT)
         DS    0F
@SA00001 DS    18F
@PC00001 DS    1F
@SA00003 DS    15F
@SA00010 DS    15F
@SA00011 DS    15F
@SA00014 DS    15F
@PC00030 DS    2F
@SA00004 DS    15F
@PC00004 DS    3F
@PC00007 DS    1F
@PC00006 DS    1F
@SA00008 DS    15F
@PC00008 DS    2F
@PC00028 DS    3F
@PC00029 DS    2F
@SA00012 DS    15F
@PC00012 DS    1F
@SA00015 DS    15F
@PC00015 DS    1F
@SA00017 DS    15F
@SA00018 DS    15F
@SA00019 DS    15F
@SA00021 DS    15F
@PC00021 DS    4F
@SA00024 DS    15F
@PC00024 DS    3F
@SA00020 DS    15F
@PC00020 DS    4F
@SA00025 DS    15F
@PC00025 DS    3F
@SA00026 DS    15F
@PC00026 DS    3F
@SA00023 DS    0F
@PC00023 EQU   @SA00023+60
@SA00022 DS    0F
@PC00022 EQU   @SA00022+60
@SA00009 DS    0F
@PC00009 EQU   @SA00009+60
@SA00005 DS    0F
@PC00005 EQU   @SA00005+60
@SA00031 DS    0F
@PC00031 EQU   @SA00031+60
@SA00027 DS    0F
@SA00013 DS    0F
         DS    19F
@AL00001 DS    5A
@TF00001 DS    F
@TF00002 DS    F
         DS    0F
@CF00082 DC    F'0'
@CF00039 DC    F'4'
@CH00039 EQU   @CF00039+2
@CF00034 DC    F'8'
@CH00034 EQU   @CF00034+2
@CF02040 DC    F'99'
@CF00349 DC    F'100'
@CF02043 DC    F'121'
@CF02045 DC    F'122'
@CF02049 DC    F'124'
@CH02049 EQU   @CF02049+2
@CF01904 DC    F'125'
@CF02052 DC    F'126'
@CF02054 DC    F'127'
@CF02056 DC    F'128'
@CF02058 DC    F'129'
@CF02699 DC    F'-144'
@CF02704 DC    F'-136'
@CF02700 DC    F'-135'
@CF02702 DC    F'-133'
@CF02708 DC    F'-132'
@CF02694 DC    F'-116'
@CF02692 DC    F'-108'
@CF02693 DC    F'-96'
@CF02710 DC    F'-52'
@CF02701 DC    F'-48'
@CF02707 DC    F'-40'
@CF02695 DC    F'-8'
@CF02711 DC    F'-4'
@CV02017 DC    V(HMASMIO)
@CV02018 DC    V(HMASMMSG)
@CV02019 DC    V(HMASMXRF)
@CV02020 DC    V(HMASMGTA)
@CV02021 DC    V(HMASMTAD)
@CV02022 DC    V(HMASMTAI)
@CV02023 DC    V(HMASMTID)
@CV02024 DC    V(HMASMTSB)
@CV02025 DC    V(HMASMTM1)
@CV02026 DC    V(HMASMTM2)
@CV02027 DC    V(HMASMTM3)
@CV02028 DC    V(HMASMTM4)
@CV02029 DC    V(HMASMTPS)
         DS    0D
BLDENT@  DS    A
MODADDR  DS    A
SELMX3   DS    F
MOD1CDF@ DS    A
MOD1ACF@ DS    A
MOD1CDR@ DS    A
MOD1ACR@ DS    A
M1FAPART DS    F
M1FCPART DS    F
M1FCICT@ DS    A
M1RAPART DS    F
M1RCPART DS    F
M1RCICT@ DS    A
M1UAPART DS    F
M1UCPART DS    F
M1UCICT@ DS    A
SELMONUM DS    H
BLDAIOPT DS    FL1
BLDADUMM DS    FL1
CK1XITYP DS    FL1
CK1XIOPT DS    FL1
CK1XDUMM DS    FL1
M1MIOPT  DS    FL1
M1MDUMMY DS    FL1
REGRPIND DS    FL1
SRHXRFT  DS    FL1
@CC02060 DC    C'FMID    '
@CC02062 DC    C'RMID    '
@CC02064 DC    C'UMID    '
@CC02075 DC    C'        '
@CC00659 DC    C'M'
ICTENDCH DC    X'FFFFFFFF'
HMASMMGP DS    CL32
         ORG   HMASMMGP
MGPFIXED DS    CL12
         ORG   MGPFIXED
MGPCLEAR DS    CL6
         ORG   MGPCLEAR
MGPMGNO1 DS    FL2
MGPMGNO2 DS    FL2
MGPMGNO3 DS    FL2
         ORG   MGPFIXED+6
MGPFLAGS DS    BL2
         ORG   MGPFLAGS
MGPPRINT DS    BL1
MGPLIST  EQU   MGPFLAGS+0
MGPRPT   EQU   MGPFLAGS+0
MGPHLDS  EQU   MGPFLAGS+0
MGPWTOR  EQU   MGPFLAGS+0
MGPWTO   EQU   MGPFLAGS+0
MGPWTP   EQU   MGPFLAGS+0
@NM00239 EQU   MGPFLAGS+0
         ORG   MGPFIXED+8
MGPTYPE  DS    FL1
@NM00240 DS    CL3
         ORG   HMASMMGP+12
MGPVAR   DS    CL20
         ORG   MGPVAR
MGPVARPT DS    5A
         ORG   HMASMMGP+32
XRFRCD   DS    CL30
         ORG   XRFRCD
XRFKEY1  DS    CL29
         ORG   XRFKEY1
XRFETYPE DS    FL1
XRFENAME DS    CL8
XRFRTYPE DS    FL1
XRFUKEY1 DS    FL1
@NM00263 DS    CL18
         ORG   XRFRCD+29
XRFNKEY1 DS    CL1
         ORG   XRFNKEY1
XRFFLAG1 DS    BL1
         ORG   XRFFLAG1
XRFFLGA  DS    BL1
XRFFLGB  EQU   XRFFLAG1+0
XRFFLGC  EQU   XRFFLAG1+0
XRFFLGD  EQU   XRFFLAG1+0
XRFFLGE  EQU   XRFFLAG1+0
XRFFLGF  EQU   XRFFLAG1+0
XRFFLGG  EQU   XRFFLAG1+0
XRFFLGH  EQU   XRFFLAG1+0
         ORG   XRFRCD+30
LISTPARM DS    CL19
         ORG   LISTPARM
LISTPRM1 DS    BL2
         ORG   LISTPRM1
LISTALL1 DS    BL1
LISTCDS  EQU   LISTPRM1+0
LISTACDS EQU   LISTPRM1+0
LISTSCDS EQU   LISTPRM1+0
LISTCRQ  EQU   LISTPRM1+0
LISTACRQ EQU   LISTPRM1+0
LISTPTS  EQU   LISTPRM1+0
@NM00284 EQU   LISTPRM1+0
LISTLOG  EQU   LISTPRM1+1
@NM00285 EQU   LISTPRM1+1
         ORG   LISTPARM+2
LISTPRM2 DS    BL2
         ORG   LISTPRM2
LISTALL2 DS    BL1
LISTASM  EQU   LISTPRM2+0
LISTLMD  EQU   LISTPRM2+0
LISTMAC  EQU   LISTPRM2+0
LISTMOD  EQU   LISTPRM2+0
LISTSRC  EQU   LISTPRM2+0
LISTDLB  EQU   LISTPRM2+0
LISTSYS  EQU   LISTPRM2+0
LISTSMD  DS    BL1
LISTFMD  EQU   LISTPRM2+1
LISTMCS  EQU   LISTPRM2+1
@NM00286 EQU   LISTPRM2+1
         ORG   LISTPARM+4
LISTPRM3 DS    BL2
         ORG   LISTPRM3
LISTALL3 DS    BL1
LISTNOAP EQU   LISTPRM3+0
LISTNOAC EQU   LISTPRM3+0
LISTRES  EQU   LISTPRM3+0
LISTFUNC EQU   LISTPRM3+0
LISTPTF  EQU   LISTPRM3+0
LISTAPAR EQU   LISTPRM3+0
LISTUSER EQU   LISTPRM3+0
LISTSUP  DS    BL1
LISTNSUP EQU   LISTPRM3+1
LISTDEL  EQU   LISTPRM3+1
LISTBYP  EQU   LISTPRM3+1
LISTERR  EQU   LISTPRM3+1
@NM00287 EQU   LISTPRM3+1
         ORG   LISTPARM+6
LISTPRM4 DS    BL1
         ORG   LISTPRM4
LISTSEL  DS    BL1
LISTXREF EQU   LISTPRM4+0
@NM00288 EQU   LISTPRM4+0
         ORG   LISTPARM+7
LISTDATE DS    CL12
         ORG   LISTDATE
LISTBDAT DS    CL6
         ORG   LISTBDAT
LISTBMM  DS    CL2
LISTBDD  DS    CL2
LISTBYY  DS    CL2
         ORG   LISTDATE+6
LISTEDAT DS    CL6
         ORG   LISTEDAT
LISTEMM  DS    CL2
LISTEDD  DS    CL2
LISTEYY  DS    CL2
         ORG   LISTPARM+19
         DS    CL1
PATCHTRM DS    CL80
         ORG   PATCHTRM
@NM00289 DC    80X'FF'
         ORG   PATCHTRM+80
TRMFLAGS DS    CL1
         ORG   TRMFLAGS
ASMBLDF  DS    BL1
@NM00290 EQU   TRMFLAGS+0
         ORG   TRMFLAGS+1
         DS    CL1
MXOUTGTP DS    CL28
MSELGTP  DS    CL28
MSELBUF  DS    CL12
ASMGTP   DS    CL28
TM4RCD   DS    CL12
         ORG   TM4RCD
TM4NAME  DS    CL8
TM4PTR   DS    AL4
         ORG   TM4RCD+12
GETICTYP DS    CL1
ENTNAME  DS    CL8
SRCNAME  DS    CL8
MODNAME  DS    CL8
TYPEIOP  DS    CL1
TYPEXRF  DS    CL1
CHKXFLGS DS    CL1
         ORG   CHKXFLGS
ENDMOD   DS    BL1
@NM00291 EQU   CHKXFLGS+0
         ORG   CHKXFLGS+1
CK1XFLGS DS    CL1
         ORG   CK1XFLGS
CK1XOK   DS    BL1
CK1XERR  EQU   CK1XFLGS+0
CK1XIFND EQU   CK1XFLGS+0
CK1XRERR EQU   CK1XFLGS+0
CK1XAERR EQU   CK1XFLGS+0
@NM00292 EQU   CK1XFLGS+0
         ORG   CK1XFLGS+1
SELMFLGS DS    CL1
         ORG   SELMFLGS
SELMMFND DS    BL1
SELMDEL  EQU   SELMFLGS+0
@NM00293 EQU   SELMFLGS+0
         ORG   SELMFLGS+1
MOD1FLGS DS    CL6
         ORG   MOD1FLGS
@NM00294 DS    BL1
         ORG   @NM00294
MOD1DONE DS    BL1
MOD1ERR  EQU   @NM00294+0
M1HEADER EQU   @NM00294+0
@NM00295 EQU   @NM00294+0
MOD1FNDA EQU   @NM00294+0
MOD1BOTH EQU   @NM00294+0
MOD1DEL  EQU   @NM00294+0
@NM00296 EQU   @NM00294+0
         ORG   MOD1FLGS+1
@NM00297 DS    BL1
         ORG   @NM00297
M1FMIDCK DS    BL1
M1RMIDCK EQU   @NM00297+0
M1UMIDCK EQU   @NM00297+0
@NM00298 EQU   @NM00297+0
M1CRMRST EQU   @NM00297+0
M1CUMRST EQU   @NM00297+0
@NM00299 EQU   @NM00297+0
@NM00300 EQU   @NM00297+0
         ORG   MOD1FLGS+2
@NM00301 DS    BL1
         ORG   @NM00301
M1CFMFND DS    BL1
M1AFMFND EQU   @NM00301+0
M1FMIDEQ EQU   @NM00301+0
@NM00302 EQU   @NM00301+0
M1CFMERM EQU   @NM00301+0
M1AFMERM EQU   @NM00301+0
@NM00303 EQU   @NM00301+0
@NM00304 EQU   @NM00301+0
         ORG   MOD1FLGS+3
@NM00305 DS    BL1
         ORG   @NM00305
M1CRMFND DS    BL1
M1ARMFND EQU   @NM00305+0
M1RMIDEQ EQU   @NM00305+0
@NM00306 EQU   @NM00305+0
M1CRMRGR EQU   @NM00305+0
M1ARMRGR EQU   @NM00305+0
M1CRMASM EQU   @NM00305+0
M1ARMASM EQU   @NM00305+0
         ORG   MOD1FLGS+4
@NM00307 DS    BL1
         ORG   @NM00307
M1CUMFND DS    BL1
M1AUMFND EQU   @NM00307+0
M1CUMID  EQU   @NM00307+0
M1AUMID  EQU   @NM00307+0
@NM00308 EQU   @NM00307+0
@NM00309 EQU   @NM00307+0
@NM00310 EQU   @NM00307+0
@NM00311 EQU   @NM00307+0
         ORG   MOD1FLGS+5
@NM00312 DS    BL1
         ORG   @NM00312
@NM00313 DS    BL1
         ORG   MOD1FLGS+6
M1TPSANS DS    CL1
M1FAANS  DS    CL1
M1FCANS  DS    CL1
M1RAANS  DS    CL1
M1RCANS  DS    CL1
M1UFLAGS DS    CL1
         ORG   M1UFLAGS
M1UBOTH  DS    BL1
@NM00314 EQU   M1UFLAGS+0
         ORG   M1UFLAGS+1
M1UAANS  DS    CL1
M1UCANS  DS    CL1
M1PANS   DS    CL1
VRSDUMMY DS    CL1
SRHXIOP  DS    CL1
SRHXFLGS DS    CL1
         ORG   SRHXFLGS
SRHXENDM DS    BL1
@NM00316 EQU   SRHXFLGS+0
         ORG   SRHXFLGS+1
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
FSMDRC   EQU   @02
CNV3TYP  EQU   @02
FLG1OFFS EQU   @03
CNV3RC   EQU   @04
CNV2RC   EQU   @02
CNV1RC   EQU   @02
TRMCRC   EQU   @02
SRHXRC   EQU   @02
REGRX1   EQU   @03
REGRRC   EQU   @02
VRSCRC   EQU   @03
M1ARC    EQU   @02
M1CRC    EQU   @02
M1MRC    EQU   @02
M1PX1    EQU   @03
M1PRC    EQU   @04
M1UX2    EQU   @04
M1UX1    EQU   @05
M1URC    EQU   @03
M1RRC    EQU   @03
M1FRC    EQU   @03
M1IX2    EQU   @02
M1IX1    EQU   @02
M1IRC    EQU   @04
MOD1RC   EQU   @03
MODIX2   EQU   @04
MODIX1   EQU   @03
MODI1PRC EQU   @06
MODIRC   EQU   @05
SELMX2   EQU   @02
SELMPTR2 EQU   @06
SELMPTR1 EQU   @07
SELMO#2  EQU   @05
SELMX1   EQU   @04
SELMRC   EQU   @03
CK1XX2   EQU   @04
CK1XX1   EQU   @02
CK1XRC   EQU   @03
CHKXMODX EQU   @03
CHKXRC   EQU   @04
XRFSMODX EQU   @02
XRFSRC   EQU   @03
JM       EQU   @04
MODCRC   EQU   @03
BLDAX2   EQU   @04
BLDAX1   EQU   @04
BLDARC   EQU   @03
MODSPTR  EQU   @03
MODMPTR  EQU   @05
MODSMD@  EQU   @04
TT       EQU   @02
SRCMPTR  EQU   @03
SRCSPTR  EQU   @05
SRCSMD@  EQU   @04
UU       EQU   @02
ASMGX1   EQU   @03
ASMGRC   EQU   @02
ENTTYPE  EQU   @02
TMXRETRN EQU   @04
BLDENTRC EQU   @03
GETMSUBX EQU   @06
GETMPTFX EQU   @04
GETM1PRC EQU   @05
GETMRC   EQU   @03
INITRC   EQU   @02
TRMRC    EQU   @03
CCAPTR   EQU   @11
RTNCODE  EQU   @15
RTNREG   EQU   @14
TBLXOPTS EQU   0
TBLFLAGS EQU   TBLXOPTS+8
TBLFLG1  EQU   TBLFLAGS
TBLFLG2  EQU   TBLFLAGS+2
TBLFLG3  EQU   TBLFLAGS+3
TBLFLG4  EQU   TBLFLAGS+5
TBLBPID  EQU   TBLFLG4
TBLFLG5  EQU   TBLFLAGS+7
HMASMCCA EQU   0
CCAFBUFR EQU   HMASMCCA+4
CCADSAD  EQU   CCAFBUFR+124
CCATPAD  EQU   CCAFBUFR+128
CCAFLAG7 EQU   CCAFBUFR+132
CCAFIOP  EQU   HMASMCCA+140
CCAIOPTR EQU   CCAFIOP
CCAFSYS  EQU   HMASMCCA+148
CCASREL  EQU   CCAFSYS+12
CCAFLAGA EQU   CCAFSYS+21
CCAFSTA  EQU   HMASMCCA+188
CCAFICT  EQU   HMASMCCA+192
CCAICT   EQU   CCAFICT
CCAICPTF EQU   CCAFICT+4
CCAICMOD EQU   CCAFICT+8
CCAICLMD EQU   CCAFICT+12
CCAFPGM  EQU   HMASMCCA+208
CCABLDLP EQU   CCAFPGM
CCADBLDL EQU   CCAFPGM+4
CCAFGTP  EQU   HMASMCCA+224
CCASEGTP EQU   CCAFGTP
@NM00023 EQU   HMASMCCA+244
CCAFFUNC EQU   HMASMCCA+264
CCAFLAG1 EQU   CCAFFUNC+8
CCAFLAG2 EQU   CCAFFUNC+11
CCAFPROC EQU   HMASMCCA+276
CCAFLAG3 EQU   CCAFPROC
CCAFDIS  EQU   HMASMCCA+278
CCAFLAG4 EQU   CCAFDIS
CCAFLAG5 EQU   CCAFDIS+1
CCAFLAG6 EQU   CCAFDIS+2
CCAFCNV  EQU   HMASMCCA+281
CCAFLAG8 EQU   CCAFCNV
CCAFCTL  EQU   HMASMCCA+282
CCAFLAG9 EQU   CCAFCTL
CCAFDSNG EQU   HMASMCCA+298
CCAFLAGB EQU   CCAFDSNG
CCADSIDA EQU   0
CCATYPEA EQU   0
CCABLDLA EQU   0
@NM00039 EQU   CCABLDLA
CCABLDLL EQU   0
@NM00041 EQU   CCABLDLL
CCALKDRC EQU   @NM00041+20
@NM00043 EQU   CCABLDLL+124
CCAASMRC EQU   @NM00043+20
@NM00045 EQU   CCABLDLL+248
CCACPYRC EQU   @NM00045+20
@NM00047 EQU   CCABLDLL+372
CCACOMRC EQU   @NM00047+20
@NM00049 EQU   CCABLDLL+496
CCAZAPRC EQU   @NM00049+20
@NM00051 EQU   CCABLDLL+620
CCASUPRC EQU   @NM00051+20
@NM00053 EQU   CCABLDLL+744
CCAUPDRC EQU   @NM00053+20
CCABLDLM EQU   0
CCABELMT EQU   CCABLDLM+4
CCABMPOS EQU   CCABELMT
HMASMIOP EQU   0
IOPDSID  EQU   HMASMIOP
IOPFUNCT EQU   HMASMIOP+1
IOPRETRN EQU   HMASMIOP+2
IOPTYPE  EQU   HMASMIOP+3
IOPNAME  EQU   HMASMIOP+4
IOPNAM17 EQU   IOPNAME
@NM00057 EQU   HMASMIOP+12
@NM00058 EQU   @NM00057
IOPDDNAM EQU   HMASMIOP+24
IOPBUFAD EQU   HMASMIOP+52
IOPDRMAP EQU   HMASMIOP+56
IOPINAME EQU   IOPDRMAP
IOPINAM  EQU   IOPINAME
IOPITYP  EQU   IOPINAM
IOPUSERL EQU   IOPDRMAP+11
IOPEND   EQU   IOPDRMAP+12
IOPLMCTL EQU   0
IOPQSMIF EQU   0
@NM00168 EQU   IOPQSMIF
IOPQSMLS EQU   IOPQSMIF+8
IOPQSMNM EQU   IOPQSMLS
IOPBS02  EQU   0
IOPBS04  EQU   0
IOPBAPF  EQU   IOPBS04
HMASMICT EQU   0
ICTCORE  EQU   HMASMICT
ICTPSPLN EQU   ICTCORE
ICTMSPLN EQU   ICTCORE+4
ICTLSPLN EQU   ICTCORE+8
ICTGMSPL EQU   0
ICTPTF   EQU   0
ICTPTFS  EQU   ICTPTF
ICTPEND  EQU   ICTPTFS
ICTPFLG1 EQU   ICTPTF+7
ICTBYP   EQU   ICTPFLG1
ICTPFLG3 EQU   ICTPTF+8
ICTPPROC EQU   ICTPFLG3
ICTPNOGO EQU   ICTPFLG3
ICTPCPL  EQU   ICTPFLG3
ICTPMSG  EQU   ICTPFLG3
ICTPFLG5 EQU   ICTPTF+9
ICTPFLG6 EQU   ICTPTF+11
ICTPFLF  EQU   ICTPFLG6
ICTPFLG2 EQU   ICTPTF+12
ICTPFLG4 EQU   ICTPTF+13
ICTPFLG8 EQU   ICTPTF+14
ICTPFLG9 EQU   ICTPTF+15
@NM00195 EQU   ICTPFLG9
ICTPFLGA EQU   ICTPTF+16
ICTPUSR1 EQU   ICTPFLGA
ICTPTYPE EQU   ICTPTF+17
ICTPONUM EQU   ICTPTF+18
ICTPSUPN EQU   ICTPTF+20
ICTPCHN  EQU   ICTPTF+64
ICTPRCHN EQU   ICTPTF+68
ICTPSCHN EQU   ICTPTF+72
ICTPPCHN EQU   ICTPTF+76
ICTPICHN EQU   ICTPTF+80
ICTPNCHN EQU   ICTPTF+84
ICTPVCHN EQU   ICTPTF+88
ICTPDCHN EQU   ICTPTF+92
ICTPBCHN EQU   ICTPTF+96
ICTIXPF  EQU   0
ICTIXP   EQU   ICTIXPF
ICTENTLS EQU   0
ICTENTNT EQU   ICTENTLS
ICTENTNM EQU   ICTENTNT
ICTENTST EQU   ICTENTNT+7
ICTREQLS EQU   0
ICTREQNT EQU   ICTREQLS
ICTREQNM EQU   ICTREQNT
ICTREQST EQU   ICTREQNT+7
ICTSUPLS EQU   0
ICTSUPNT EQU   ICTSUPLS
ICTSUPNM EQU   ICTSUPNT
ICTPRELS EQU   0
ICTPRENT EQU   ICTPRELS
ICTPRENM EQU   ICTPRENT
ICTPREST EQU   ICTPRENT+7
ICTIRQLS EQU   0
ICTIRQNT EQU   ICTIRQLS
ICTIRQNM EQU   ICTIRQNT
ICTIRQST EQU   ICTIRQNT+7
ICTCSRST EQU   ICTIRQNT+15
ICTNPRLS EQU   0
ICTNPRNT EQU   ICTNPRLS
ICTNPRNM EQU   ICTNPRNT
ICTVRSLS EQU   0
ICTVRSNT EQU   ICTVRSLS
ICTVRSNM EQU   ICTVRSNT
ICTDELLS EQU   0
ICTDELNT EQU   ICTDELLS
ICTDELNM EQU   ICTDELNT
ICTDELST EQU   ICTDELNT+7
ICTSBYLS EQU   0
ICTSBYNT EQU   ICTSBYLS
ICTSBYNM EQU   ICTSBYNT
ICTMOD   EQU   0
ICTMNAME EQU   ICTMOD
ICTMEND  EQU   ICTMNAME
ICTMFLG2 EQU   ICTMOD+8
ICTMNOGO EQU   ICTMFLG2
ICTMCPL  EQU   ICTMFLG2
ICTMMSG  EQU   ICTMFLG2
ICTMFLG1 EQU   ICTMOD+9
ICTMMODR EQU   ICTMFLG1
ICTMMOD  EQU   ICTMMODR
ICTMASM  EQU   ICTMMODR
ICTMMACR EQU   ICTMFLG1
ICTMSRCR EQU   ICTMFLG1
ICTMSRCU EQU   ICTMFLG1
ICTMFLG3 EQU   ICTMOD+10
ICTMFLG4 EQU   ICTMOD+11
ICTMISEL EQU   ICTMFLG4
ICTMIDEL EQU   ICTMFLG4
ICTMASOC EQU   ICTMFLG4
ICTMFLG5 EQU   ICTMOD+12
ICTMPASS EQU   ICTMFLG5
ICTMODF4 EQU   ICTMOD+13
ICTMLEP1 EQU   ICTMODF4
ICTMODF5 EQU   ICTMOD+14
ICTMLEP2 EQU   ICTMODF5
ICTMODF6 EQU   ICTMOD+15
ICTMLEP3 EQU   ICTMODF6
ICTMODF7 EQU   ICTMOD+16
ICTMLEP4 EQU   ICTMODF7
ICTMACF4 EQU   ICTMOD+17
ICTFMLIB EQU   ICTMOD+24
ICTMDSTL EQU   ICTMOD+48
ICTMRMID EQU   ICTMOD+80
ICTMFMID EQU   ICTMOD+88
ICTPPTR  EQU   ICTMOD+96
ICTMCHN  EQU   ICTMOD+100
ICTMICHN EQU   ICTMOD+104
ICTMICHA EQU   ICTMOD+108
ICTMACHN EQU   ICTMOD+112
ICTMTCHN EQU   ICTMOD+116
ICTMVCHN EQU   ICTMOD+120
ICTMUCHN EQU   ICTMOD+124
ICTIXMF  EQU   0
ICTMIDLS EQU   0
ICTMID   EQU   ICTMIDLS
ICTMODID EQU   ICTMID
ICTMIDND EQU   ICTMODID
ICTMODST EQU   ICTMID+7
ICTMIDPS EQU   ICTMODST
ICTMIDRG EQU   ICTMODST
ICTMIDAM EQU   ICTMODST
ICTMIDTY EQU   ICTMODST
ICTASMLS EQU   0
ICTASMAD EQU   ICTASMLS
ICTTALLS EQU   0
ICTTALNM EQU   ICTTALLS
ICTMVRLS EQU   0
ICTMVRNT EQU   ICTMVRLS
ICTMVRNM EQU   ICTMVRNT
ICTMUMLS EQU   0
ICTMUMNT EQU   ICTMUMLS
ICTMUMNM EQU   ICTMUMNT
ICTLMOD  EQU   0
ICTLMNAM EQU   ICTLMOD
ICTLNAME EQU   ICTLMNAM
ICTLFLG4 EQU   ICTLMOD+8
ICTLFLG1 EQU   ICTLMOD+9
ICTLFLG5 EQU   ICTLMOD+10
ICTLFLG6 EQU   ICTLMOD+11
ICTLFLG7 EQU   ICTLMOD+12
ICTLFLG2 EQU   ICTLMOD+13
ICTLFLG3 EQU   ICTLMOD+14
ICTLCHN  EQU   ICTLMOD+34
ICTIXLF  EQU   0
HMASMSET EQU   0
SELSTENT EQU   HMASMSET
SELSTFLG EQU   SELSTENT
SESRC    EQU   SELSTFLG+1
SEMOD    EQU   SELSTFLG+1
SEMAC    EQU   SELSTFLG+1
SEASM    EQU   SELSTFLG+1
SENAME   EQU   SELSTENT+2
SESMDNO  EQU   SENAME
SEFLAGS  EQU   HMASMSET+10
SESELECT EQU   SEFLAGS
SEFLAG2  EQU   HMASMSET+11
HMASMGTP EQU   0
GTPFUNCT EQU   HMASMGTP
GTPRETRN EQU   HMASMGTP+1
GTPRCDLN EQU   HMASMGTP+4
GTPKEYLN EQU   HMASMGTP+6
GTPBUFAD EQU   HMASMGTP+12
GTPRESTR EQU   HMASMGTP+16
GTPFLGS1 EQU   HMASMGTP+26
GTPPSIZE EQU   GTPFLGS1
TSLPARMS EQU   0
TSLPMLAD EQU   TSLPARMS+4
TSLFUNCT EQU   TSLPARMS+8
TSLRETRN EQU   TSLPARMS+9
TSLICTSR EQU   0
TSLISMD  EQU   TSLICTSR
TSLIOPTF EQU   TSLICTSR+7
TSLICTF  EQU   TSLICTSR+12
TSLLSTSR EQU   0
TSLLOPTF EQU   TSLLSTSR+7
TSLGET   EQU   0
TSLGOPTF EQU   TSLGET+7
TSLSICDS EQU   0
TSLSSMD  EQU   TSLSICDS
TSLSOPTF EQU   TSLSICDS+7
TSLSOICT EQU   TSLSOPTF
TSLSOCDS EQU   TSLSOPTF
TSLSICTP EQU   TSLSICDS+8
TSLSICTF EQU   TSLSICDS+16
TSLSIFND EQU   TSLSICTF
TSLSISUP EQU   TSLSICTF
TSLSCDSF EQU   TSLSICDS+18
TSLSCOK  EQU   TSLSCDSF
TSLSCERR EQU   TSLSCDSF
TSLENTSR EQU   0
TSLEOPTF EQU   TSLENTSR+2
TSLMFUNC EQU   0
TSLMTYPE EQU   TSLMFUNC
TSLMSMD  EQU   TSLMFUNC+1
TSLRELM  EQU   0
SELMNAME EQU   0
SELMTYPE EQU   0
M1CFMID  EQU   0
M1AFMID  EQU   0
M1CRMID  EQU   0
M1ARMID  EQU   0
M1ICMID  EQU   0
M1IAMID  EQU   0
D2RCRD   EQU   0
D2RKEY   EQU   D2RCRD
D2RSMD   EQU   D2RKEY
D2RDATA  EQU   D2RCRD+7
D2RFLAGS EQU   D2RDATA
D2RFOK   EQU   D2RFLAGS
D2RFERR  EQU   D2RFLAGS
IOPBS01  EQU   0
IOPBS03  EQU   0
TBLXPARM EQU   0
TBLXINDX EQU   TBLXPARM+4
TBLXIOPF EQU   TBLXPARM+20
TBLXTBL  EQU   TBLXPARM+28
TBLXTOP  EQU   TBLXPARM+32
TBLXNULL EQU   TBLXPARM+36
TBLXFUNC EQU   TBLXPARM+64
TBLXFLG1 EQU   TBLXPARM+80
TBLXTSLP EQU   TBLXPARM+84
TBLXRC   EQU   TBLXPARM+92
TBLXD2GT EQU   TBLXPARM+100
TBLXIOP3 EQU   TBLXPARM+104
BLDESMD  EQU   0
BLDESUBE EQU   0
BLDICTYP EQU   0
ASMGIOP  EQU   0
SRCENTRY EQU   0
MODENTRY EQU   0
BLDAENT  EQU   0
BLDAIOP  EQU   0
MODCSMD  EQU   0
CK1IOP   EQU   0
MOD1ENT  EQU   0
M1PCICT@ EQU   0
M1PLST@  EQU   0
M1PAANS  EQU   0
M1PAPART EQU   0
M1MTXT1  EQU   0
M1MPART  EQU   0
M1MSMD   EQU   0
M1MDDN   EQU   0
M1CSMD   EQU   0
M1CANS   EQU   0
M1CPART  EQU   0
M1CICT@  EQU   0
M1ASMD   EQU   0
M1AANS   EQU   0
M1APART  EQU   0
VRSCSMD  EQU   0
VRSCELM  EQU   0
VRSCANS  EQU   0
REGRIOP  EQU   0
REGRSMD  EQU   0
REGRELM  EQU   0
SRHXSMD  EQU   0
SRHXELM  EQU   0
SRHXPIND EQU   0
CNV1ENT  EQU   0
CNV1IOPT EQU   0
CNV1XRFT EQU   0
CNV2ENT  EQU   0
CNV2SELT EQU   0
CNV3IND  EQU   0
CNV3ITYP EQU   0
FSMDENT  EQU   0
IOPUDATA EQU   IOPEND
IOPINAM3 EQU   IOPINAME
@NM00064 EQU   IOPINAM3
IOPSTCMP EQU   IOPUDATA
IOPDYNDT EQU   IOPUDATA
IOPSPACE EQU   IOPDYNDT+44
IOPDTYPE EQU   IOPDYNDT+50
IOPNTMAX EQU   IOPDRMAP
IOPNTMAP EQU   IOPDRMAP
IOPCDMAP EQU   IOPNTMAP
IOPPTMAP EQU   IOPCDMAP
IOPSCMAP EQU   IOPPTMAP
IOPDIRCT EQU   IOPSCMAP+12
IOPCDMAX EQU   IOPDIRCT
IOPCQMAP EQU   IOPDRMAP
@NM00075 EQU   IOPUDATA
@NM00076 EQU   IOPUDATA
IOPASMNT EQU   IOPUDATA
IOPASMDR EQU   IOPASMNT
IOPABUNT EQU   IOPASMDR+1
IOPLMDNT EQU   IOPUDATA
IOPLMDDR EQU   IOPLMDNT
IOPLMLEP EQU   IOPLMDDR+1
IOPLMDF1 EQU   IOPLMLEP
IOPFLGS2 EQU   IOPLMDF1
IOPLMDF2 EQU   IOPLMLEP+1
IOPLMDF3 EQU   IOPLMLEP+2
IOPLMDF4 EQU   IOPLMLEP+3
IOPLMDF5 EQU   IOPLMDDR+5
IOPFLGS3 EQU   IOPLMDF5
IOPLMDFX EQU   IOPLMDNT+24
@NM00085 EQU   IOPLMDFX
IOPLNTRY EQU   IOPLMDFX+8
IOPLSYS  EQU   IOPLNTRY
IOPSYSLB EQU   IOPLSYS
IOPMACNT EQU   IOPUDATA
IOPMACDR EQU   IOPMACNT
IOPRMIDE EQU   IOPMACDR+1
IOPRMID  EQU   IOPRMIDE
IOPRMST  EQU   IOPRMIDE+7
IOPFMIDE EQU   IOPMACDR+9
IOPFMID  EQU   IOPFMIDE
IOPMACFX EQU   IOPMACNT+24
IOPBUNT  EQU   IOPMACFX
IOPMCDLB EQU   IOPMACFX+72
IOPMCEND EQU   IOPMACNT+104
IOPMACVR EQU   IOPMCEND
IOPMCENT EQU   IOPMACVR
IOPMCDTA EQU   IOPMCENT
IOPMCASM EQU   IOPMCDTA
IOPMACID EQU   IOPMCASM
IOPMACND EQU   IOPMACID
IOPMACST EQU   IOPMCASM+7
IOPMCIND EQU   IOPMCENT+8
IOPMCTYP EQU   IOPMCIND
IOPEOFNT EQU   IOPUDATA
IOPSRCNT EQU   IOPUDATA
IOPSRCDR EQU   IOPSRCNT
@NM00096 EQU   IOPSRCDR+1
@NM00098 EQU   @NM00096+7
@NM00102 EQU   IOPSRCDR+9
IOPSRCFX EQU   IOPSRCNT+24
@NM00106 EQU   IOPSRCFX
IOPSREND EQU   IOPSRCNT+104
IOPSRCVR EQU   IOPSREND
IOPSNTRY EQU   IOPSRCVR
IOPSRDTA EQU   IOPSNTRY
IOPSRCID EQU   IOPSRDTA
IOPSRCST EQU   IOPSRDTA+7
IOPMODNT EQU   IOPUDATA
IOPMODDR EQU   IOPMODNT
@NM00112 EQU   IOPMODDR+1
@NM00114 EQU   @NM00112+7
@NM00118 EQU   IOPMODDR+9
IOPMODFX EQU   IOPMODNT+24
@NM00122 EQU   IOPMODFX
IOPMDLEP EQU   IOPMODFX+8
IOPMODF1 EQU   IOPMDLEP
IOPMODF2 EQU   IOPMDLEP+1
IOPMODF3 EQU   IOPMDLEP+2
IOPMODF4 EQU   IOPMDLEP+3
IOPMDEND EQU   IOPMODNT+104
IOPMODVR EQU   IOPMDEND
IOPMNTRY EQU   IOPMODVR
IOPMDDTA EQU   IOPMNTRY
IOPLMODS EQU   IOPMDDTA
IOPMODID EQU   IOPLMODS
IOPMODST EQU   IOPLMODS+7
IOPDLBNT EQU   IOPUDATA
IOPDLBDR EQU   IOPDLBNT
IOPDLBFX EQU   IOPDLBNT+24
@NM00133 EQU   IOPDLBFX
IOPDLEND EQU   IOPDLBNT+104
IOPDLBVR EQU   IOPDLEND
IOPDNTRY EQU   IOPDLBVR
IOPDSYS  EQU   IOPDNTRY
IOPSYSNT EQU   IOPUDATA
IOPSYSDR EQU   IOPSYSNT
IOPSYSF1 EQU   IOPSYSDR+4
IOPFLGS7 EQU   IOPSYSF1
IOPSYSFX EQU   IOPSYSNT+24
@NM00140 EQU   IOPSYSFX
IOPSYEND EQU   IOPSYSNT+184
IOPSYSVR EQU   IOPSYEND
IOPSYSTR EQU   IOPSYSVR
IOPSYNTR EQU   IOPSYSTR
IOPPTFNT EQU   IOPUDATA
IOPPTFDR EQU   IOPPTFNT
IOPPSTAT EQU   IOPPTFDR+2
IOPPTFF1 EQU   IOPPSTAT
IOPFLGS5 EQU   IOPPTFF1
IOPRES   EQU   IOPFLGS5
IOPERROR EQU   IOPFLGS5
IOPPTFF2 EQU   IOPPSTAT+1
IOPPTFF3 EQU   IOPPSTAT+3
IOPSBYP  EQU   IOPPTFF3
IOPDBYP  EQU   IOPPTFF3
IOPPTFFX EQU   IOPPTFNT+24
@NM00149 EQU   IOPPTFFX
@NM00150 EQU   @NM00149
IOPPDTES EQU   IOPPTFFX+41
@NM00153 EQU   IOPPDTES
IOPPTPFX EQU   IOPPDTES+6
IOPDATES EQU   IOPPTPFX
IOPPTEND EQU   IOPPTFNT+104
IOPPTFVR EQU   IOPPTEND
IOPPNTRY EQU   IOPPTFVR
IOPPMODS EQU   IOPPNTRY
IOPPTFND EQU   IOPPMODS
IOPPIND  EQU   IOPPNTRY+8
IOPENTNT EQU   IOPUDATA+104
IOPSRLNT EQU   IOPUDATA+104
IOPPRENT EQU   IOPUDATA+104
IOPNPRNT EQU   IOPUDATA+104
IOPSUPNT EQU   IOPUDATA+104
IOPREQNT EQU   IOPUDATA+104
IOPIRQNT EQU   IOPUDATA+104
IOPFIDNT EQU   IOPUDATA+104
IOPDELNT EQU   IOPUDATA+104
IOPVERNT EQU   IOPUDATA+104
IOPSBYNT EQU   IOPUDATA+104
IOPQSMNT EQU   IOPUDATA
IOPQSMDR EQU   IOPQSMNT
IOPQFMNT EQU   IOPUDATA
IOPQFMDR EQU   IOPQFMNT
IOPQFEND EQU   IOPQFMNT+2
IOPQFMVR EQU   IOPQFEND
IOPQFMLS EQU   IOPQFMVR
IOPQFMNM EQU   IOPQFMLS
IOPPTSYS EQU   IOPUDATA
IOPPTSDR EQU   IOPPTSYS
IOPPTSFX EQU   IOPPTSYS+24
IOPDSSPC EQU   IOPPTSFX
IOPPTFG1 EQU   IOPPTSFX+34
IOPPSEND EQU   IOPPTSYS+1064
IOPPTSVR EQU   IOPPSEND
IOPPTNTR EQU   IOPPTSVR
@NM00178 EQU   IOPPTNTR
IOPPTFMD EQU   @NM00178
IOPPTREL EQU   IOPPTFMD
IOPBPDS  EQU   IOPUDATA
IOPBLEP1 EQU   IOPBPDS+8
IOPBLEP2 EQU   IOPBPDS+9
@NM00182 EQU   IOPBPDS+18
IOPBFTB0 EQU   @NM00182
IOPBFTB1 EQU   IOPBFTB0
ICTENDNT EQU   ICTENDCH
ICTENDIX EQU   ICTENDCH
XRFRCD1  EQU   XRFRCD
XRFRCD2  EQU   XRFRCD
XRFRCD3  EQU   XRFRCD
XRF3MAC  EQU   XRFRCD3+1
XRF3MOD  EQU   XRF3MAC
XRF3PTF  EQU   XRFRCD3+17
XRF3PF1  EQU   XRFRCD3+24
XRF3STAT EQU   XRF3PF1
XRF3PIND EQU   XRFRCD3+26
XRFRCD4  EQU   XRFRCD
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
@NM00283 EQU   XRFRCD4+28
@NM00282 EQU   XRFRCD4+18
XRFX4PTF EQU   XRFRCD4+11
@NM00281 EQU   XRFRCD4+10
@NM00280 EQU   XRFRCD4+9
XRF4PTF  EQU   XRFRCD4+1
@NM00279 EQU   XRFRCD4
@NM00278 EQU   XRFRCD3+29
@NM00277 EQU   XRFRCD3+28
XRF3PF3  EQU   XRFRCD3+27
XRF3PTYP EQU   XRFRCD3+25
XRF3TIM  EQU   XRFRCD3+14
XRF3DAT  EQU   XRFRCD3+11
@NM00276 EQU   XRFRCD3+10
@NM00275 EQU   XRFRCD3+9
XRF3SRC  EQU   XRF3MOD
@NM00274 EQU   XRFRCD3
@NM00273 EQU   XRFRCD2+29
@NM00272 EQU   XRFRCD2+19
XRF2MOD  EQU   XRFRCD2+11
@NM00271 EQU   XRFRCD2+10
@NM00270 EQU   XRFRCD2+9
XRF2LMD  EQU   XRFRCD2+1
@NM00269 EQU   XRFRCD2
@NM00268 EQU   XRFRCD1+29
@NM00267 EQU   XRFRCD1+19
XRF1MAC  EQU   XRFRCD1+11
@NM00266 EQU   XRFRCD1+10
@NM00265 EQU   XRFRCD1+9
XRF1ASM  EQU   XRFRCD1+1
@NM00264 EQU   XRFRCD1
IOPBCEND EQU   IOPBPDS+21
IOPBFTB3 EQU   IOPBFTB0+2
IOPBFTB2 EQU   IOPBFTB0+1
@NM00184 EQU   IOPBFTB1
IOPBAPFP EQU   IOPBFTB1
IOPBSSI  EQU   IOPBFTB1
IOPBPAGA EQU   IOPBFTB1
@NM00183 EQU   IOPBFTB1
IOPBAOSL EQU   IOPBFTB1
IOPBSEPA EQU   IOPBPDS+15
IOPBFTBL EQU   IOPBPDS+13
IOPBSTOR EQU   IOPBPDS+10
IOPBREFR EQU   IOPBLEP2
IOPBLEF  EQU   IOPBLEP2
IOPBTEST EQU   IOPBLEP2
IOPBNE   EQU   IOPBLEP2
@NM00181 EQU   IOPBLEP2
IOPBDC   EQU   IOPBLEP2
@NM00180 EQU   IOPBLEP1
IOPBSCTR EQU   IOPBLEP1
IOPBOL   EQU   IOPBLEP1
@NM00179 EQU   IOPBLEP1
IOPBOVLY EQU   IOPBLEP1
IOPBREUS EQU   IOPBLEP1
IOPBRENT EQU   IOPBLEP1
IOPBNL   EQU   IOPBPDS+7
IOPBTTRN EQU   IOPBPDS+4
IOPBZERO EQU   IOPBPDS+3
IOPBTTRT EQU   IOPBPDS
IOPPTIND EQU   IOPPTNTR+8
IOPPTSND EQU   IOPPTREL
@NM00177 EQU   IOPPTSFX+872
IOPSYZPP EQU   IOPPTSFX+772
IOPSYZPR EQU   IOPPTSFX+771
IOPSYZPS EQU   IOPPTSFX+763
IOPSYZAP EQU   IOPPTSFX+755
IOPSYUPP EQU   IOPPTSFX+655
IOPSYUPR EQU   IOPPTSFX+654
IOPSYUPS EQU   IOPPTSFX+646
IOPSYUPD EQU   IOPPTSFX+638
IOPSYSPP EQU   IOPPTSFX+538
IOPSYSPR EQU   IOPPTSFX+537
IOPSYSPS EQU   IOPPTSFX+529
IOPSYSUP EQU   IOPPTSFX+521
IOPSYLKP EQU   IOPPTSFX+421
IOPSYLKR EQU   IOPPTSFX+420
IOPSYLKS EQU   IOPPTSFX+412
IOPSYLKD EQU   IOPPTSFX+404
IOPSYCPP EQU   IOPPTSFX+304
IOPSYCPR EQU   IOPPTSFX+303
IOPSYCPS EQU   IOPPTSFX+295
IOPSYCPY EQU   IOPPTSFX+287
IOPSYCOP EQU   IOPPTSFX+187
IOPSYCOR EQU   IOPPTSFX+186
IOPSYCOS EQU   IOPPTSFX+178
IOPSYCOM EQU   IOPPTSFX+170
IOPSYASP EQU   IOPPTSFX+70
IOPSYASR EQU   IOPPTSFX+69
IOPSYASS EQU   IOPPTSFX+61
IOPSYASM EQU   IOPPTSFX+53
@NM00176 EQU   IOPPTSFX+35
@NM00175 EQU   IOPPTFG1
IOPPTSNJ EQU   IOPPTFG1
IOPPTSNP EQU   IOPPTFG1
IOPSYPLN EQU   IOPPTSFX+32
IOPDSPFX EQU   IOPPTSFX+6
IOPDSDIR EQU   IOPDSSPC+4
IOPDSSEC EQU   IOPDSSPC+2
IOPDSPRM EQU   IOPDSSPC
@NM00174 EQU   IOPPTSDR+4
IOPPTPEM EQU   IOPPTSDR+2
IOPPCNVL EQU   IOPPTSDR+1
@NM00173 EQU   IOPPTSDR
IOPQFMTP EQU   IOPQFMLS+8
@NM00172 EQU   IOPQFMLS+7
IOPQFMND EQU   IOPQFMNM
@NM00171 EQU   IOPQFMDR
@NM00167 EQU   IOPQSMDR
@NM00166 EQU   IOPSBYNT+8
IOPSBYST EQU   IOPSBYNT+7
IOPSBYNM EQU   IOPSBYNT
@NM00165 EQU   IOPVERNT+8
IOPVERST EQU   IOPVERNT+7
IOPVERNM EQU   IOPVERNT
@NM00164 EQU   IOPDELNT+8
IOPDELST EQU   IOPDELNT+7
IOPDELNM EQU   IOPDELNT
@NM00163 EQU   IOPFIDNT+8
IOPFIDST EQU   IOPFIDNT+7
IOPFIDNM EQU   IOPFIDNT
@NM00162 EQU   IOPIRQNT+8
IOPIRQST EQU   IOPIRQNT+7
IOPIRQNM EQU   IOPIRQNT
@NM00161 EQU   IOPREQNT+8
IOPREQST EQU   IOPREQNT+7
IOPREQNM EQU   IOPREQNT
@NM00160 EQU   IOPSUPNT+8
IOPSUPST EQU   IOPSUPNT+7
IOPSUPNM EQU   IOPSUPNT
@NM00159 EQU   IOPNPRNT+8
IOPNPRST EQU   IOPNPRNT+7
IOPNPRNM EQU   IOPNPRNT
@NM00158 EQU   IOPPRENT+8
IOPPREST EQU   IOPPRENT+7
IOPPRENM EQU   IOPPRENT
@NM00157 EQU   IOPSRLNT+8
IOPSRLST EQU   IOPSRLNT+7
@NM00156 EQU   IOPSRLNT+4
IOPSRLNM EQU   IOPSRLNT
@NM00155 EQU   IOPENTNT+8
IOPENTST EQU   IOPENTNT+7
IOPENTNM EQU   IOPENTNT
IOPPFMID EQU   IOPPTFFX+73
@NM00154 EQU   IOPPTPFX+24
IOPUCLT  EQU   IOPDATES+21
IOPUCLD  EQU   IOPDATES+18
IOPACCT  EQU   IOPDATES+15
IOPACCD  EQU   IOPDATES+12
IOPRSTT  EQU   IOPDATES+9
IOPRSTD  EQU   IOPDATES+6
IOPAPPT  EQU   IOPDATES+3
IOPAPPD  EQU   IOPDATES
IOPRECT  EQU   @NM00153+3
IOPRECD  EQU   @NM00153
@NM00152 EQU   IOPPTFFX+8
@NM00151 EQU   @NM00149+7
IOPPRELN EQU   @NM00150
@NM00148 EQU   IOPPTFDR+20
IOPSBYNO EQU   IOPPTFDR+13
IOPDBYNO EQU   IOPPTFDR+6
@NM00147 EQU   IOPPTFF3
IOPFLF   EQU   IOPPTFF3
IOPPMDLP EQU   IOPPTFF2+1
IOPPADDP EQU   IOPPTFF2+1
@NM00146 EQU   IOPPTFF2+1
IOPLRFP  EQU   IOPPTFF2
IOPJCLP  EQU   IOPPTFF2
IOPSUPP  EQU   IOPPTFF2
IOPREQP  EQU   IOPPTFF2
IOPPREP  EQU   IOPPTFF2
IOPNPRP  EQU   IOPPTFF2
IOPIRQP  EQU   IOPPTFF2
IOPDELP  EQU   IOPPTFF2
IOPREGEN EQU   IOPFLGS5
IOPBYP   EQU   IOPFLGS5
IOPDUMMP EQU   IOPFLGS5
@NM00145 EQU   IOPFLGS5
IOPACC   EQU   IOPFLGS5
IOPAPP   EQU   IOPFLGS5
IOPPTYPE EQU   IOPPTFDR+1
@NM00144 EQU   IOPPTFDR
IOPSYSTP EQU   IOPSYSTR+8
IOPSYSND EQU   IOPSYNTR
@NM00143 EQU   IOPSYSFX+21
IOPSYSID EQU   IOPSYSFX+13
IOPNUCID EQU   IOPSYSFX+12
IOPSREL  EQU   IOPSYSFX+8
@NM00142 EQU   @NM00140+7
@NM00141 EQU   @NM00140
@NM00139 EQU   IOPSYSDR+5
@NM00138 EQU   IOPFLGS7
IOPSYNG  EQU   IOPFLGS7
IOPSYDL  EQU   IOPFLGS7
IOPSTSNP EQU   IOPFLGS7
IOPMTSNP EQU   IOPFLGS7
IOPPEMAX EQU   IOPSYSDR+2
IOPSCNVL EQU   IOPSYSDR+1
@NM00137 EQU   IOPSYSDR
IOPDLIND EQU   IOPDNTRY+8
IOPDLBND EQU   IOPDSYS
@NM00136 EQU   IOPDLBFX+8
@NM00135 EQU   @NM00133+7
@NM00134 EQU   @NM00133
@NM00132 EQU   IOPDLBDR+1
@NM00131 EQU   IOPDLBDR
IOPMDIND EQU   IOPMNTRY+8
@NM00130 EQU   IOPMODST
IOPMODND EQU   IOPMODID
IOPDLIB  EQU   IOPMODFX+72
@NM00129 EQU   IOPMODFX+12
@NM00128 EQU   IOPMODF4
@NM00127 EQU   IOPMODF3
@NM00126 EQU   IOPMODF2
IOPMPAGA EQU   IOPMODF2
IOPMNE   EQU   IOPMODF2
@NM00125 EQU   IOPMODF1
IOPMDC   EQU   IOPMODF1
IOPMREFR EQU   IOPMODF1
IOPMOVLY EQU   IOPMODF1
IOPMSCTR EQU   IOPMODF1
IOPMREUS EQU   IOPMODF1
IOPMRENT EQU   IOPMODF1
IOPMAPF  EQU   IOPMODF1
@NM00124 EQU   @NM00122+7
@NM00123 EQU   @NM00122
@NM00121 EQU   IOPMODDR+17
@NM00120 EQU   @NM00118+7
@NM00119 EQU   @NM00118
@NM00117 EQU   @NM00114
@NM00116 EQU   @NM00114
@NM00115 EQU   @NM00114
@NM00113 EQU   @NM00112
@NM00111 EQU   IOPMODDR
IOPSRIND EQU   IOPSNTRY+8
@NM00110 EQU   IOPSRCST
IOPSRCND EQU   IOPSRCID
IOPSRDLB EQU   IOPSRCFX+72
IOPSRSYS EQU   IOPSRCFX+64
@NM00109 EQU   IOPSRCFX+8
@NM00108 EQU   @NM00106+7
@NM00107 EQU   @NM00106
@NM00105 EQU   IOPSRCDR+18
IOPSRLNG EQU   IOPSRCDR+17
@NM00104 EQU   @NM00102+7
@NM00103 EQU   @NM00102
@NM00101 EQU   @NM00098
@NM00100 EQU   @NM00098
@NM00099 EQU   @NM00098
@NM00097 EQU   @NM00096
@NM00095 EQU   IOPSRCDR
IOPEOFND EQU   IOPEOFNT
@NM00094 EQU   IOPMACST
IOPMCSYS EQU   IOPMACFX+64
@NM00093 EQU   IOPMACFX+8
IOPBUTYP EQU   IOPBUNT+7
IOPBUSMD EQU   IOPBUNT
@NM00092 EQU   IOPMACDR+18
IOPMCLNG EQU   IOPMACDR+17
IOPFMST  EQU   IOPFMIDE+7
@NM00091 EQU   IOPRMST
IOPRMASM EQU   IOPRMST
@NM00090 EQU   IOPRMST
@NM00089 EQU   IOPMACDR
IOPLMIND EQU   IOPLNTRY+8
IOPLMDND EQU   IOPSYSLB
@NM00087 EQU   @NM00085+7
@NM00086 EQU   @NM00085
@NM00084 EQU   IOPLMDDR+6
@NM00083 EQU   IOPFLGS3
IOPCHREP EQU   IOPFLGS3
IOPLINK  EQU   IOPFLGS3
IOPCOPY  EQU   IOPFLGS3
@NM00082 EQU   IOPLMDF4
@NM00081 EQU   IOPLMDF3
@NM00080 EQU   IOPLMDF2
IOPPAGA  EQU   IOPLMDF2
IOPNE    EQU   IOPLMDF2
@NM00079 EQU   IOPFLGS2
IOPDC    EQU   IOPFLGS2
IOPREFR  EQU   IOPFLGS2
IOPOVLY  EQU   IOPFLGS2
IOPSCTR  EQU   IOPFLGS2
IOPREUS  EQU   IOPFLGS2
IOPRENT  EQU   IOPFLGS2
IOPAPF   EQU   IOPFLGS2
@NM00078 EQU   IOPLMDDR
@NM00077 EQU   IOPASMDR+9
IOPABUTP EQU   IOPABUNT+7
IOPABUPT EQU   IOPABUNT
IOPNTLVL EQU   IOPASMDR
IOPALLOC EQU   @NM00076+4
IOPUSED  EQU   @NM00076
IOPTPSEQ EQU   @NM00075+8
IOPVLSER EQU   @NM00075+2
IOPBLKSI EQU   @NM00075
IOPCQMAX EQU   IOPCQMAP+12
@NM00074 EQU   IOPCQMAP+11
@NM00073 EQU   IOPCQMAP+8
@NM00072 EQU   IOPCQMAP
IOPPTMAX EQU   IOPCDMAX
@NM00071 EQU   IOPSCMAP+11
@NM00070 EQU   IOPSCMAP+8
@NM00069 EQU   IOPSCMAP
IOPDIRMX EQU   IOPNTMAX+12
@NM00068 EQU   IOPNTMAX+11
@NM00067 EQU   IOPNTMAX+8
@NM00066 EQU   IOPNTMAX
@NM00065 EQU   IOPDTYPE
IOPDMOD  EQU   IOPDTYPE
IOPDJCL  EQU   IOPDTYPE
IOPDSRC  EQU   IOPDTYPE
IOPDMAC  EQU   IOPDTYPE
IOPSDIR  EQU   IOPSPACE+4
IOPSSCND EQU   IOPSPACE+2
IOPSPRIM EQU   IOPSPACE
IOPDSN   EQU   IOPDYNDT
IOPNTYPE EQU   IOPSTCMP+17
IOPNNAME EQU   IOPSTCMP+9
IOPOTYPE EQU   IOPSTCMP+8
IOPONAME EQU   IOPSTCMP
IOPISEQ3 EQU   IOPINAM3+6
IOPITYP3 EQU   @NM00064+5
IOPIPTF3 EQU   @NM00064
TBLXEND0 EQU   TBLXPARM+124
@NM00007 EQU   TBLXPARM+108
TBLXDLGT EQU   TBLXPARM+96
@NM00006 EQU   TBLXRC+3
TBLXIRC  EQU   TBLXRC+2
TBLXLRC  EQU   TBLXRC+1
TBLXTRC  EQU   TBLXRC
TBLXIBGN EQU   TBLXPARM+88
@NM00005 EQU   TBLXPARM+83
@NM00004 EQU   TBLXPARM+82
@NM00003 EQU   TBLXPARM+81
@NM00002 EQU   TBLXFLG1
TBLXTCRC EQU   TBLXFLG1
TBLXFUND EQU   TBLXPARM+72
@NM00001 EQU   TBLXPARM+62
TBLXCRQI EQU   TBLXPARM+61
TBLXCDSI EQU   TBLXPARM+60
TBLXLMGT EQU   TBLXPARM+56
TBLXSCGT EQU   TBLXPARM+52
TBLXSREL EQU   TBLXPARM+48
TBLXASGT EQU   TBLXPARM+44
TBLXIFGT EQU   TBLXPARM+40
TBLXSEGT EQU   TBLXPARM+24
TBLXIOP2 EQU   TBLXPARM+16
TBLXEND  EQU   TBLXINDX+8
TBLXSTRT EQU   TBLXINDX+4
TBLXCUR  EQU   TBLXINDX
TBLXHDR  EQU   TBLXPARM
@NM00315 EQU   D2RFLAGS
D2RFDEL  EQU   D2RFLAGS
TSLRRTNP EQU   TSLRELM+12
TSLRAPTR EQU   TSLRELM+8
@NM00262 EQU   TSLRELM+7
TSLRSMD  EQU   TSLRELM
TSLEFNDP EQU   TSLENTSR+12
TSLEBGNP EQU   TSLENTSR+8
TSLENMEP EQU   TSLENTSR+4
@NM00261 EQU   TSLENTSR+3
@NM00260 EQU   TSLEOPTF
TSLEONXT EQU   TSLEOPTF
TSLEVER# EQU   TSLENTSR+1
TSLETYPE EQU   TSLENTSR
@NM00259 EQU   TSLSICDS+19
TSLSDUM  EQU   TSLSCDSF
@NM00258 EQU   TSLSCDSF
@NM00257 EQU   TSLSCDSF
TSLSCDEL EQU   TSLSCDSF
TSLSCSUP EQU   TSLSCDSF
TSLSCFND EQU   TSLSCDSF
@NM00256 EQU   TSLSICDS+17
TSLSISLS EQU   TSLSICTF
TSLSINOG EQU   TSLSICTF
TSLSIDLI EQU   TSLSICTF
TSLSIDLE EQU   TSLSICTF
TSLSIDEL EQU   TSLSICTF
TSLSIOK  EQU   TSLSICTF
TSLSIOPP EQU   TSLSICDS+12
@NM00255 EQU   TSLSOPTF
TSLSOXTD EQU   TSLSOPTF
TSLSOMSG EQU   TSLSOPTF
TSLSOALL EQU   TSLSOPTF
TSLGDSID EQU   TSLGET+12
TSLGIOPP EQU   TSLGET+8
@NM00254 EQU   TSLGOPTF
TSLGOXTD EQU   TSLGOPTF
TSLGOMSG EQU   TSLGOPTF
@NM00253 EQU   TSLGOPTF
@NM00252 EQU   TSLGOPTF
@NM00251 EQU   TSLGOPTF
TSLGSMD  EQU   TSLGET
TSLLRTNP EQU   TSLLSTSR+12
TSLLOFST EQU   TSLLSTSR+8
@NM00250 EQU   TSLLOPTF
TSLLONXT EQU   TSLLOPTF
TSLLSMD  EQU   TSLLSTSR
@NM00249 EQU   TSLICTSR+13
@NM00248 EQU   TSLICTF
TSLINOG  EQU   TSLICTF
TSLIDLI  EQU   TSLICTF
TSLIDLE  EQU   TSLICTF
TSLIDEL  EQU   TSLICTF
TSLISUP  EQU   TSLICTF
TSLIOK   EQU   TSLICTF
TSLIFND  EQU   TSLICTF
TSLICTP  EQU   TSLICTSR+8
@NM00247 EQU   TSLIOPTF
TSLIONXT EQU   TSLIOPTF
TSLTBLXP EQU   TSLPARMS
@NM00246 EQU   HMASMGTP+27
@NM00245 EQU   GTPFLGS1
GTPRCDNF EQU   GTPFLGS1
GTPNOSPM EQU   GTPFLGS1
GTPPOS   EQU   GTPRESTR+8
GTPRCD   EQU   GTPRESTR+4
GTPPAG   EQU   GTPRESTR
GTPWKAD  EQU   HMASMGTP+8
@NM00244 EQU   HMASMGTP+2
SEFLAG2H EQU   SEFLAG2
SEFLAG2G EQU   SEFLAG2
SEFLAG2F EQU   SEFLAG2
SEFLAG2E EQU   SEFLAG2
SEFLAG2D EQU   SEFLAG2
SEFLAG2C EQU   SEFLAG2
SEFLAG2B EQU   SEFLAG2
SEFLAG2A EQU   SEFLAG2
SEFOUND  EQU   SEFLAGS
@NM00243 EQU   SEFLAGS
SEFMID   EQU   SEFLAGS
SENOJCL  EQU   SEFLAGS
SEEXCLUD EQU   SEFLAGS
SEGROUP  EQU   SEFLAGS
@NM00242 EQU   SENAME+7
SEPTFNO  EQU   SESMDNO
SESYS    EQU   SELSTFLG+1
SEFMD    EQU   SELSTFLG+1
SELMD    EQU   SELSTFLG+1
SEDLB    EQU   SELSTFLG+1
SESMD    EQU   SELSTFLG
SEMCS    EQU   SELSTFLG
@NM00241 EQU   SELSTFLG
ICTIXL   EQU   ICTIXLF
@NM00238 EQU   ICTLMOD+38
ICTLTTR  EQU   ICTLMOD+31
ICTTG2   EQU   ICTLMOD+23
ICTTG1   EQU   ICTLMOD+15
@NM00237 EQU   ICTLFLG3
ICTLZAP  EQU   ICTLFLG3
ICTLLKD  EQU   ICTLFLG3
ICTLCPY  EQU   ICTLFLG3
ICTLXPND EQU   ICTLFLG3
ICTTIND2 EQU   ICTLFLG3
ICTTIND1 EQU   ICTLFLG3
@NM00236 EQU   ICTLFLG2
ICTLDEL  EQU   ICTLFLG2
@NM00235 EQU   ICTLFLG2
ICTLTDEL EQU   ICTLFLG2
ICTLINK  EQU   ICTLFLG2
ICTCOPY  EQU   ICTLFLG2
@NM00234 EQU   ICTLFLG7
@NM00233 EQU   ICTLFLG6
@NM00232 EQU   ICTLFLG5
ICTLPAGA EQU   ICTLFLG5
ICTLNE   EQU   ICTLFLG5
@NM00231 EQU   ICTLFLG1
ICTLDC   EQU   ICTLFLG1
ICTLREFR EQU   ICTLFLG1
ICTLOVLY EQU   ICTLFLG1
ICTLSCTR EQU   ICTLFLG1
ICTLREUS EQU   ICTLFLG1
ICTLRENT EQU   ICTLFLG1
ICTLAPF  EQU   ICTLFLG1
@NM00230 EQU   ICTLFLG4
ICTLPASS EQU   ICTLFLG4
ICTLDDCK EQU   ICTLFLG4
ICTLMSG  EQU   ICTLFLG4
ICTLCPL  EQU   ICTLFLG4
ICTLNOGO EQU   ICTLFLG4
ICTLPROC EQU   ICTLFLG4
ICTLEND  EQU   ICTLNAME
@NM00229 EQU   ICTMUMNT+7
ICTMUMND EQU   ICTMUMNM
@NM00228 EQU   ICTMVRNT+7
ICTMVRND EQU   ICTMVRNM
ICTTALND EQU   ICTTALNM
ICTASMND EQU   ICTASMAD
ICTMIDF1 EQU   ICTMODST
ICTMIDPL EQU   ICTMODST
@NM00227 EQU   ICTMODST
ICTIXM   EQU   ICTIXMF
@NM00226 EQU   ICTMOD+128
@NM00225 EQU   ICTMOD+95
@NM00224 EQU   ICTMOD+87
ICTMSSI  EQU   ICTMOD+72
ICTMDOBJ EQU   ICTMOD+64
ICTMSYSL EQU   ICTMOD+56
ICTMASLB EQU   ICTMOD+40
ICTTOLIB EQU   ICTMOD+32
ICTMRELN EQU   ICTMOD+22
@NM00223 EQU   ICTMOD+21
ICTMLANG EQU   ICTMOD+20
@NM00222 EQU   ICTMOD+19
ICTMACF5 EQU   ICTMOD+18
ICTMZMPR EQU   ICTMACF4
ICTMZOMZ EQU   ICTMACF4
ICTMDOAS EQU   ICTMACF4
ICTMXUPD EQU   ICTMACF4
ICTMFXC  EQU   ICTMACF4
ICTMFXBS EQU   ICTMACF4
ICTMHASM EQU   ICTMACF4
ICTMACDL EQU   ICTMACF4
@NM00221 EQU   ICTMLEP4
@NM00220 EQU   ICTMLEP3
@NM00219 EQU   ICTMLEP2
ICTMPAGA EQU   ICTMLEP2
ICTMNE   EQU   ICTMLEP2
@NM00218 EQU   ICTMLEP1
ICTMDC   EQU   ICTMLEP1
ICTMREFR EQU   ICTMLEP1
ICTMOVLY EQU   ICTMLEP1
ICTMSCTR EQU   ICTMLEP1
ICTMREUS EQU   ICTMLEP1
ICTMRENT EQU   ICTMLEP1
ICTMAPF  EQU   ICTMLEP1
@NM00217 EQU   ICTMFLG5
ICTMNORL EQU   ICTMFLG5
ICTMELCK EQU   ICTMFLG5
ICTMCOPY EQU   ICTMFLG5
@NM00216 EQU   ICTMFLG4
ICTMTSEL EQU   ICTMFLG4
ICTMDSTE EQU   ICTMFLG4
ICTMMIDE EQU   ICTMFLG4
ICTMSELM EQU   ICTMFLG4
@NM00215 EQU   ICTMFLG3
ICTMPRMS EQU   ICTMFLG3
ICTMALIS EQU   ICTMFLG3
ICTMWRK  EQU   ICTMFLG3
ICTMTRX  EQU   ICTMFLG3
ICTMRELF EQU   ICTMFLG3
ICTLIBTX EQU   ICTMFLG3
ICTLIBLK EQU   ICTMFLG3
ICTMMACU EQU   ICTMFLG1
ICTMXPND EQU   ICTMFLG1
ICTMZAP  EQU   ICTMFLG1
@NM00214 EQU   ICTMFLG2
@NM00213 EQU   ICTMFLG2
ICTMMIDU EQU   ICTMFLG2
ICTMDEL  EQU   ICTMFLG2
ICTMPROC EQU   ICTMFLG2
@NM00212 EQU   ICTSBYNT+7
ICTSBYND EQU   ICTSBYNM
ICTDELEX EQU   ICTDELST
ICTDELND EQU   ICTDELNM
@NM00211 EQU   ICTVRSNT+7
ICTVRSND EQU   ICTVRSNM
@NM00210 EQU   ICTNPRNT+7
ICTNPRND EQU   ICTNPRNM
@NM00209 EQU   ICTCSRST
@NM00208 EQU   ICTCSRST
ICTCSRF  EQU   ICTCSRST
@NM00207 EQU   ICTCSRST
ICTCSRNM EQU   ICTIRQNT+8
@NM00206 EQU   ICTIRQST
ICTIREQT EQU   ICTIRQST
ICTIREQI EQU   ICTIRQST
ICTIREQB EQU   ICTIRQST
ICTIREQS EQU   ICTIRQST
@NM00205 EQU   ICTIRQST
ICTIRQND EQU   ICTIRQNM
@NM00204 EQU   ICTPREST
ICTPREQT EQU   ICTPREST
ICTPREQI EQU   ICTPREST
ICTPREQB EQU   ICTPREST
ICTPREQS EQU   ICTPREST
@NM00203 EQU   ICTPREST
ICTPREND EQU   ICTPRENM
@NM00202 EQU   ICTSUPNT+7
ICTSUPND EQU   ICTSUPNM
@NM00201 EQU   ICTREQST
ICTRREQT EQU   ICTREQST
ICTRREQI EQU   ICTREQST
ICTRREQB EQU   ICTREQST
ICTRREQS EQU   ICTREQST
@NM00200 EQU   ICTREQST
ICTREQND EQU   ICTREQNM
@NM00199 EQU   ICTENTST
ICTEREQT EQU   ICTENTST
ICTEREQI EQU   ICTENTST
ICTEREQB EQU   ICTENTST
ICTEREQS EQU   ICTENTST
@NM00198 EQU   ICTENTST
ICTENTND EQU   ICTENTNM
@NM00197 EQU   ICTPTF+100
ICTPTPFX EQU   ICTPTF+38
ICTPRELN EQU   ICTPTF+36
ICTPRECT EQU   ICTPTF+33
ICTPRECD EQU   ICTPTF+30
ICTPVERN EQU   ICTPTF+29
ICTPFMID EQU   ICTPTF+22
ICTPUSR8 EQU   ICTPFLGA
ICTPUSR7 EQU   ICTPFLGA
ICTPUSR6 EQU   ICTPFLGA
ICTPUSR5 EQU   ICTPFLGA
ICTPUSR4 EQU   ICTPFLGA
ICTPUSR3 EQU   ICTPFLGA
ICTPUSR2 EQU   ICTPFLGA
ICTPPASS EQU   ICTPUSR1
@NM00196 EQU   @NM00195
ICTPRQBY EQU   @NM00195
ICTPRQOK EQU   @NM00195
ICTPRQCK EQU   @NM00195
@NM00194 EQU   ICTPFLG9
ICTPPDEL EQU   ICTPFLG9
ICTPWRKO EQU   ICTPFLG9
ICTPMSL  EQU   ICTPFLG9
@NM00193 EQU   ICTPFLG8
ICTPDCPL EQU   ICTPFLG8
ICTPECPL EQU   ICTPFLG8
ICTPGCPL EQU   ICTPFLG8
@NM00192 EQU   ICTPFLG4
@NM00191 EQU   ICTPFLG4
@NM00190 EQU   ICTPFLG4
ICTPGELM EQU   ICTPFLG4
ICTPDIMP EQU   ICTPFLG4
ICTPDEXP EQU   ICTPFLG4
ICTPREDO EQU   ICTPFLG4
ICTPCDSE EQU   ICTPFLG4
@NM00189 EQU   ICTPFLG2
ICTPRCND EQU   ICTPFLG2
ICTPTPS  EQU   ICTPFLG2
ICTPTR1  EQU   ICTPFLG2
ICTPVRSP EQU   ICTPFLG2
@NM00188 EQU   ICTPFLG6
ICTFLF   EQU   ICTPFLF
ICTPDBYP EQU   ICTPFLG6
ICTPSBYP EQU   ICTPFLG6
ICTPMDLP EQU   ICTPFLG5+1
ICTPADDP EQU   ICTPFLG5+1
@NM00187 EQU   ICTPFLG5+1
ICTPLRFP EQU   ICTPFLG5
ICTPJCLP EQU   ICTPFLG5
ICTPSUPP EQU   ICTPFLG5
ICTPREQP EQU   ICTPFLG5
ICTPPREP EQU   ICTPFLG5
ICTPNPRP EQU   ICTPFLG5
ICTPIRQP EQU   ICTPFLG5
ICTPDELP EQU   ICTPFLG5
@NM00186 EQU   ICTPFLG3
ICTPSLST EQU   ICTPFLG3
ICTPNOLB EQU   ICTPFLG3
ICTPVERJ EQU   ICTPFLG3
ICTPROCS EQU   ICTPPROC
ICTREGEN EQU   ICTPFLG1
ICTDUMMP EQU   ICTPFLG1
@NM00185 EQU   ICTPFLG1
ICTERROR EQU   ICTPFLG1
ICTACC   EQU   ICTPFLG1
ICTRES   EQU   ICTPFLG1
ICTAPP   EQU   ICTPFLG1
ICTLEN   EQU   ICTGMSPL+1
ICTSP    EQU   ICTGMSPL
ICTLLEN  EQU   ICTLSPLN+1
ICTLSP   EQU   ICTLSPLN
ICTMLEN  EQU   ICTMSPLN+1
ICTMSP   EQU   ICTMSPLN
ICTPLEN  EQU   ICTPSPLN+1
ICTPSP   EQU   ICTPSPLN
IOPBS04E EQU   IOPBS04+2
IOPBAPFC EQU   IOPBAPF+1
IOPBAPFL EQU   IOPBAPF
IOPBS2NM EQU   IOPBS02+3
IOPBS2EP EQU   IOPBS02
IOPQSMTP EQU   IOPQSMLS+8
@NM00170 EQU   IOPQSMLS+7
IOPQSMND EQU   IOPQSMNM
@NM00169 EQU   @NM00168+7
IOPQSMFM EQU   @NM00168
@NM00088 EQU   IOPLMCTL+17
IOPLMCRD EQU   IOPLMCTL+9
IOPLMCRN EQU   IOPLMCTL+1
IOPLMCC  EQU   IOPLMCTL
@NM00063 EQU   IOPUSERL
@NM00062 EQU   IOPUSERL
IOPALIS  EQU   IOPUSERL
IOPTTR   EQU   IOPDRMAP+8
IOPINAM2 EQU   IOPINAM+1
IOPITYP2 EQU   IOPITYP
@NM00061 EQU   HMASMIOP+32
IOPDELDD EQU   IOPDDNAM
@NM00060 EQU   @NM00057+10
IOPSEQNO EQU   @NM00057+8
@NM00059 EQU   @NM00058+7
IOPPTFNM EQU   @NM00058
CCABMREC EQU   CCABELMT+10
CCABPOS  EQU   CCABMPOS+8
CCABNAME EQU   CCABMPOS
@NM00056 EQU   CCABLDLM+2
@NM00055 EQU   CCABLDLM
CCAUPDPM EQU   @NM00053+24
@NM00054 EQU   @NM00053+21
CCARUPDT EQU   CCAUPDRC
CCAUPDSP EQU   @NM00053+12
CCAUPDTE EQU   @NM00053+8
CCAUPDNM EQU   @NM00053
CCASUPPM EQU   @NM00051+24
@NM00052 EQU   @NM00051+21
CCARSUP  EQU   CCASUPRC
CCASUPSP EQU   @NM00051+12
CCAIOSUP EQU   @NM00051+8
CCASUPNM EQU   @NM00051
CCAZAPPM EQU   @NM00049+24
@NM00050 EQU   @NM00049+21
CCARZAP  EQU   CCAZAPRC
CCAZAPSP EQU   @NM00049+12
CCASPZAP EQU   @NM00049+8
CCAZAPNM EQU   @NM00049
CCACOMPM EQU   @NM00047+24
@NM00048 EQU   @NM00047+21
CCARCOMP EQU   CCACOMRC
CCACOMSP EQU   @NM00047+12
CCACOMRS EQU   @NM00047+8
CCACOMNM EQU   @NM00047
CCACPYPM EQU   @NM00045+24
@NM00046 EQU   @NM00045+21
CCARCOPY EQU   CCACPYRC
CCACPYSP EQU   @NM00045+12
CCACOPY  EQU   @NM00045+8
CCACPYNM EQU   @NM00045
CCAASMPM EQU   @NM00043+24
@NM00044 EQU   @NM00043+21
CCARASM  EQU   CCAASMRC
CCAASMSP EQU   @NM00043+12
CCAASM   EQU   @NM00043+8
CCAASMNM EQU   @NM00043
CCALKDPM EQU   @NM00041+24
@NM00042 EQU   @NM00041+21
CCARLINK EQU   CCALKDRC
CCALKDSP EQU   @NM00041+12
CCALKED  EQU   @NM00041+8
CCALKDNM EQU   @NM00041
CCAPGMPM EQU   @NM00039+24
@NM00040 EQU   @NM00039+21
CCABPGRC EQU   @NM00039+20
CCABPGSP EQU   @NM00039+12
CCABPGAD EQU   @NM00039+8
CCABPGNM EQU   @NM00039
CCAEND   EQU   HMASMCCA+371
@NM00038 EQU   HMASMCCA+309
CCACURDD EQU   CCAFDSNG+3
CCACURDS EQU   CCAFDSNG+2
@NM00037 EQU   CCAFLAGB
CCAOUTNG EQU   CCAFLAGB
CCALOGNG EQU   CCAFLAGB
CCAFMID  EQU   HMASMCCA+291
CCALSTDS EQU   CCAFCTL+8
CCARPTDS EQU   CCAFCTL+7
CCATIME  EQU   CCAFCTL+4
CCADATE  EQU   CCAFCTL+1
@NM00036 EQU   CCAFLAG9
CCARVCAN EQU   CCAFLAG9
CCARVEST EQU   CCAFLAG9
CCAPTSNJ EQU   CCAFLAG9
CCASTSNP EQU   CCAFLAG9
CCAMTSNP EQU   CCAFLAG9
CCAPTSNP EQU   CCAFLAG9
@NM00035 EQU   CCAFLAG8
CCAACDSC EQU   CCAFLAG8
CCACDSC  EQU   CCAFLAG8
@NM00034 EQU   CCAFLAG6
CCAACRUP EQU   CCAFLAG6
CCACRQUP EQU   CCAFLAG6
CCAACDUP EQU   CCAFLAG6
CCACDSUP EQU   CCAFLAG6
@NM00033 EQU   CCAFLAG5
CCAACROS EQU   CCAFLAG5
CCACRQOS EQU   CCAFLAG5
CCAACDOS EQU   CCAFLAG5
CCACDSOS EQU   CCAFLAG5
@NM00032 EQU   CCAFLAG4
CCAACRIS EQU   CCAFLAG4
CCACRQIS EQU   CCAFLAG4
CCAACDIS EQU   CCAFLAG4
CCACDSIS EQU   CCAFLAG4
@NM00031 EQU   CCAFLAG3+1
CCARGNP  EQU   CCAFLAG3+1
CCADISRQ EQU   CCAFLAG3+1
CCAICTOK EQU   CCAFLAG3
CCADELP  EQU   CCAFLAG3
CCACMPRS EQU   CCAFLAG3
CCAZAPP  EQU   CCAFLAG3
CCALINKP EQU   CCAFLAG3
CCACOPYP EQU   CCAFLAG3
CCAASIP  EQU   CCAFLAG3
CCAUPDP  EQU   CCAFLAG3
CCAEOSMP EQU   CCAFLAG2
CCAEOFNC EQU   CCAFLAG2
@NM00030 EQU   CCAFLAG2
CCACHECK EQU   CCAFLAG2
CCATERM  EQU   CCAFLAG2
CCASVCLB EQU   CCAFLAG2
CCANCPTF EQU   CCAFLAG2
@NM00029 EQU   CCAFLAG1+1
CCAUNL   EQU   CCAFLAG1+1
CCARESET EQU   CCAFLAG1+1
CCALOG   EQU   CCAFLAG1+1
CCACNV   EQU   CCAFLAG1+1
CCALIST  EQU   CCAFLAG1
CCAUPDU  EQU   CCAFLAG1
CCAUPDJ  EQU   CCAFLAG1
CCARES   EQU   CCAFLAG1
CCAREJ   EQU   CCAFLAG1
CCAACCPT EQU   CCAFLAG1
CCAAPPLY EQU   CCAFLAG1
CCAREC   EQU   CCAFLAG1
CCAFUNCT EQU   CCAFFUNC
@NM00028 EQU   @NM00023+18
@NM00027 EQU   @NM00023+16
CCATBLPA EQU   @NM00023+12
@NM00026 EQU   @NM00023+8
@NM00025 EQU   @NM00023+4
@NM00024 EQU   @NM00023
CCAIFGTP EQU   CCAFGTP+16
CCAGTP3  EQU   CCAFGTP+12
CCAGTP2  EQU   CCAFGTP+8
CCAGTP1  EQU   CCAFGTP+4
CCASETAD EQU   CCASEGTP
CCACLST  EQU   CCAFPGM+12
CCASPDCB EQU   CCAFPGM+8
CCARVAD  EQU   CCAFSTA
CCAACDID EQU   CCAFSYS+32
CCACDSID EQU   CCAFSYS+24
CCALNLEN EQU   CCAFSYS+22
@NM00022 EQU   CCAFLAGA
CCAPSYSF EQU   CCAFLAGA
CCAASYSF EQU   CCAFLAGA
CCACSYSF EQU   CCAFLAGA
CCANUCID EQU   CCAFSYS+20
CCAASREL EQU   CCAFSYS+16
CCACSREL EQU   CCASREL
CCAPEMAX EQU   CCAFSYS+10
CCAPGLEN EQU   CCAFSYS+8
CCAIOPAS EQU   CCAFSYS+4
CCAIOPCS EQU   CCAFSYS
CCAPESIZ EQU   CCAFIOP+4
@NM00021 EQU   CCAFLAG7+3
CCALOGP  EQU   CCAFLAG7+2
CCAOUTP  EQU   CCAFLAG7+2
CCASLBP  EQU   CCAFLAG7+2
CCARPTP  EQU   CCAFLAG7+2
CCALISTP EQU   CCAFLAG7+2
CCAJCLP  EQU   CCAFLAG7+2
CCAPTFP  EQU   CCAFLAG7+2
CCATLBP  EQU   CCAFLAG7+2
CCAUT3P  EQU   CCAFLAG7+1
CCAUT2P  EQU   CCAFLAG7+1
CCAUT1P  EQU   CCAFLAG7+1
CCAWK5P  EQU   CCAFLAG7+1
CCAWK4P  EQU   CCAFLAG7+1
CCAWK3P  EQU   CCAFLAG7+1
CCAWK2P  EQU   CCAFLAG7+1
CCAWK1P  EQU   CCAFLAG7+1
CCAACRQP EQU   CCAFLAG7
CCACRQP  EQU   CCAFLAG7
CCASTSP  EQU   CCAFLAG7
CCAMTSP  EQU   CCAFLAG7
CCAPTSP  EQU   CCAFLAG7
CCASCDSP EQU   CCAFLAG7
CCAACDSP EQU   CCAFLAG7
CCACDSP  EQU   CCAFLAG7
@NM00020 EQU   CCAFBUFR+122
@NM00019 EQU   CCAFBUFR+120
@NM00018 EQU   CCAFBUFR+118
CCATBFMX EQU   CCAFBUFR+116
CCA4BFMX EQU   CCAFBUFR+114
CCA3BFMX EQU   CCAFBUFR+112
CCA2BFMX EQU   CCAFBUFR+110
CCA1BFMX EQU   CCAFBUFR+108
CCAXBFMX EQU   CCAFBUFR+106
CCAQBFMX EQU   CCAFBUFR+104
CCASBFMX EQU   CCAFBUFR+102
CCAMBFMX EQU   CCAFBUFR+100
CCAPBFMX EQU   CCAFBUFR+98
CCAVBFMX EQU   CCAFBUFR+96
CCAABFMX EQU   CCAFBUFR+94
CCACBFMX EQU   CCAFBUFR+92
@NM00017 EQU   CCAFBUFR+88
@NM00016 EQU   CCAFBUFR+84
CCA4BFSZ EQU   CCAFBUFR+80
CCATBFSZ EQU   CCAFBUFR+76
CCAWBFSZ EQU   CCAFBUFR+72
CCAQBFSZ EQU   CCAFBUFR+68
CCAPBFSZ EQU   CCAFBUFR+64
CCAVBFSZ EQU   CCAFBUFR+60
CCACBFSZ EQU   CCAFBUFR+56
@NM00015 EQU   CCAFBUFR+52
CCA4BFOA EQU   CCAFBUFR+48
CCA4BFIA EQU   CCAFBUFR+44
CCATBFIA EQU   CCAFBUFR+40
CCAWBFOA EQU   CCAFBUFR+36
CCAWBFIA EQU   CCAFBUFR+32
CCAQBFOA EQU   CCAFBUFR+28
CCAQBFIA EQU   CCAFBUFR+24
CCAPBFOA EQU   CCAFBUFR+20
CCAPBFIA EQU   CCAFBUFR+16
CCAVBFOA EQU   CCAFBUFR+12
CCAVBFIA EQU   CCAFBUFR+8
CCACBFOA EQU   CCAFBUFR+4
CCACBFIA EQU   CCAFBUFR
CCAID    EQU   HMASMCCA
@NM00014 EQU   TBLFLG5
TBLICTOK EQU   TBLFLG5
@NM00013 EQU   TBLFLG4
TBLBPFM  EQU   TBLFLG4
@NM00012 EQU   TBLFLG4
TBLBPIRQ EQU   TBLFLG4
TBLBPREQ EQU   TBLFLG4
TBLBPPRE EQU   TBLFLG4
@NM00011 EQU   TBLFLG3+1
TBLSTS   EQU   TBLFLG3
TBLMTS   EQU   TBLFLG3
TBLPTS   EQU   TBLFLG3
TBLACRQ  EQU   TBLFLG3
TBLCRQ   EQU   TBLFLG3
TBLSCDS  EQU   TBLFLG3
TBLACDS  EQU   TBLFLG3
TBLCDS   EQU   TBLFLG3
TBLMASS  EQU   TBLFLG2
@NM00010 EQU   TBLFLG2
TBLFMID  EQU   TBLFLG2
TBLGROUP EQU   TBLFLG2
TBLEXC   EQU   TBLFLG2
TBLSEL   EQU   TBLFLG2
@NM00009 EQU   TBLFLG1+1
TBLDISW  EQU   TBLFLG1+1
TBLDISR  EQU   TBLFLG1+1
TBLDISN  EQU   TBLFLG1+1
TBLNOJCL EQU   TBLFLG1
TBLFLUSH EQU   TBLFLG1
TBLUSER  EQU   TBLFLG1
TBLAPAR  EQU   TBLFLG1
TBLCOMP  EQU   TBLFLG1
TBLASSEM EQU   TBLFLG1
TBLCHECK EQU   TBLFLG1
TBLNOAPP EQU   TBLFLG1
@NM00008 EQU   TBLXOPTS+5
TBLNUCID EQU   TBLXOPTS+4
TBLJCLGT EQU   TBLXOPTS
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00321 EQU   @RC00317
@RC00723 EQU   @RC00721
@RF00776 EQU   @RC00743
@RC00783 EQU   @RC00743
@RC00812 EQU   @RC00743
@RF00879 EQU   @RC00877
@RC00888 EQU   @RC00886
@RF00895 EQU   @RC00886
@RC00925 EQU   @RC00866
@RF00930 EQU   @RC00866
@RF00949 EQU   @RC00939
@RF01093 EQU   @RC01085
@RF01119 EQU   @RC01111
@RF01160 EQU   @RC01158
@RF01168 EQU   @RC01166
@RC01227 EQU   @RC01225
@RF01272 EQU   @RC01261
@RC01357 EQU   @RC01354
@RC01456 EQU   @RC01451
@RF01523 EQU   @RC01519
@RC01554 EQU   @RC01551
@RC01641 EQU   @RC01639
@RC01695 EQU   @RC01692
@RC01700 EQU   @RC01692
@RF01809 EQU   @RC01806
@RC01862 EQU   @RC01859
@RC01893 EQU   @RC01891
@RF00324 EQU   @RC00321
@RC00785 EQU   @RC00783
@RC00790 EQU   @RC00783
@RC01359 EQU   @RC01357
@RC01459 EQU   @RC01456
@RC01475 EQU   @RC01456
@RC01496 EQU   @RC01456
@RC01557 EQU   @RC01554
@RC01361 EQU   @RC01359
@RC01364 EQU   @RC01361
@RF01371 EQU   @RC01361
@ENDDATA EQU   *
         END   HMASMTRM,(C'PLS2215',0802,78334)

         TITLE 'HMASMTP2 - BUILD IFREQ INDEX LIST'
HMASMTP2 CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'HMASMTP2  78.334'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@12                                         0001
         ST    @13,@SA00001+4                                      0001
         LA    @14,@SA00001                                        0001
         ST    @14,8(,@13)                                         0001
         LR    @13,@14                                             0001
         MVC   @PC00001(12),0(@01)                                 0001
*   TP2RC=ZERO;                     /* CLEAR THE RETURN CODE         */
         SLR   TP2RC,TP2RC                                         0202
*   TP2FLAGS=''B;                   /* CLEAR LOCAL FLAGS             */
         MVI   TP2FLAGS,X'00'                                      0203
*   TAIFRST=ON;                     /* FIRST CALL TO ROUTINES        */
         OI    TAIFRST,B'10000000'                                 0204
*   SYSMOD=ICTPTFS(1);              /* SAVE NAME OF CURRENT SYSMOD   */
         L     @14,@PC00001+4                                      0205
         L     @14,ENTRYPTR(,@14)                                  0205
         MVC   SYSMOD(7),ICTPTFS(@14)                              0205
*   DSID=TBLXCRQI;                  /* PROCESS CRQ OR ACRQ AS      0206
*                                      SPECIFIED IN TBLX             */
         L     @10,@PC00001                                        0206
         SLR   DSID,DSID                                           0206
         IC    DSID,TBLXCRQI(,@10)                                 0206
*   SAVBUFAD=IOPBUFAD;              /* SAVE IOPBUFAD                 */
         L     @02,@PC00001+8                                      0207
         L     SAVBUFAD,IOPBUFAD(,@02)                             0207
*   IOPBUFAD=ADDR(CSRBUFFR);        /* POINT TO LOCAL BUFFER         */
         LA    @09,CSRBUFFR                                        0208
         ST    @09,IOPBUFAD(,@02)                                  0208
*   TSLTBLXP=ADDR(TBLXPARM);        /* INITIALIZE HMASMTSB PARM LIST */
         L     @02,TBLXTSLP(,@10)                                  0209
         ST    @10,TSLTBLXP(,@02)                                  0209
*   TSLICTSR=''B;                   /* CLEAR ICT SYSMOD SERACH PARMS */
         LA    @02,ICTSR                                           0210
         XC    TSLICTSR(14,@02),TSLICTSR(@02)                      0210
*   TSLSICDS=''B;                   /* CLEAR CDS & ICT SEARCH PARMS  */
         LA    @02,SICDS                                           0211
         XC    TSLSICDS(20,@02),TSLSICDS(@02)                      0211
*   ICTPICHN(1)=TBLXNULL;           /* INIT IREQ CHAIN POINTER       */
         MVC   ICTPICHN(4,@14),TBLXNULL(@10)                       0212
*                                                                  0213
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THE SYSMOD IS A FUNCTION THEN FIND CAUSERS WHICH REFERENCED*/
*   /* IT AS AN FMID ON THEIR ++IF STATEMENTS.                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0213
*   IF ICTPTYPE(1)=IOPPFUNC THEN    /* IS THIS A FUNCTION PTF ENTRY? */
         CLI   ICTPTYPE(@14),4                                     0213
         BNE   @RF00213                                            0213
*     DO;                           /* YES,                          */
*                                                                  0214
*       /*************************************************************/
*       /*                                                           */
*       /* SEARCH THE ++IF RECORDS FROM SYSMODS BEING PROCESSED.     */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0215
*       CALL ENVGTA;                /* PROCESS GTA FILE ++IF DATA  0215
*                                      FIRST                         */
         BAL   @14,ENVGTA                                          0215
*       TP2RC=MAX(TP2RC,RTNCODE);                                  0216
         CR    TP2RC,RTNCODE                                       0216
         BNL   *+6
         LR    TP2RC,RTNCODE                                       0216
*       IF TP2RC<STOPPTF THEN       /* ALL IS WELL?                  */
         CH    TP2RC,@CH00057                                      0217
         BNL   @RF00217                                            0217
*         DO;                       /* YES,                          */
*                                                                  0218
*           /*********************************************************/
*           /*                                                       */
*           /* SEARCH THE (A)CRQ FOR FMID RECORDS TO GET CAUSERS     */
*           /* WHICH WILL LIST REQS.                                 */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0219
*           CALL ENVCRQ;            /* PROCESS CRQ EVIRONMENT RECORDS
*                                      NEXT                          */
         BAL   @14,ENVCRQ                                          0219
*           TP2RC=MAX(TP2RC,RTNCODE);                              0220
         CR    TP2RC,RTNCODE                                       0220
         BNL   *+6
         LR    TP2RC,RTNCODE                                       0220
*         END;                                                     0221
*     END;                                                         0222
*                                                                  0222
@RF00217 DS    0H                                                  0223
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK THE ++IF FROM THE SYSMODS BEING PROCESSED. LOCATE THIS  */
*   /* SYSMOD AS A CAUSER AND GET REQS,                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0223
*   IF TP2RC<STOPPTF THEN           /* NO ERROR YET?                 */
@RF00213 CH    TP2RC,@CH00057                                      0223
         BNL   @RF00223                                            0223
*     DO;                           /* YES,                          */
*       CALL CSRGTA;                /* PROCESS GTA FILE ++IF DATA  0225
*                                      FIRST                         */
         BAL   @14,CSRGTA                                          0225
*       TP2RC=MAX(TP2RC,RTNCODE);                                  0226
         CR    TP2RC,RTNCODE                                       0226
         BNL   *+6
         LR    TP2RC,RTNCODE                                       0226
*     END;                                                         0227
*   IOPBUFAD=SAVBUFAD;              /* RESTORE IOPBUFAD              */
@RF00223 L     @14,@PC00001+8                                      0228
         ST    SAVBUFAD,IOPBUFAD(,@14)                             0228
*   RFY                                                            0229
*     RTNCODE UNRSTD;                                              0229
*   RETURN CODE(TP2RC);             /*                               */
         LR    @15,TP2RC                                           0230
         L     @13,4(,@13)                                         0230
         L     @14,12(,@13)                                        0230
         LM    @00,@12,20(@13)                                     0230
         BR    @14                                                 0230
*   RFY                                                            0231
*     ICTPTF BASED;                                                0231
*                                                                  0232
*/********************************************************************/
*/*                                                                  */
*/*  ENVGTA - FIND CONDITIONAL REQUISITES SUPPLIED BY THE SYSMODS    */
*/*           CURRENTLY BEING PROCESSED (IN ++IF GTA) WHOSE          */
*/*           ENVIRONMENT NAMES THE SYSMOD PASSED.                   */
*/*                                                                  */
*/*           THESE REQUISITES ARE ATTACHED TO THE SYSMOD PASSED.    */
*/*                                                                  */
*/********************************************************************/
*                                                                  0232
*ENVGTA:                                                           0232
*   PROC;                                                          0232
ENVGTA   STM   @14,@12,@SA00002                                    0232
*   RFY                                                            0233
*     ICTPTF BASED(ENTRYPTR);       /* ADDRESS ICT FOR SYSMOD PASSED */
*   DCL                                                            0234
*     ENVGTARC FIXED(15);           /* ENVGTA RETURN CODE            */
*   DCL                                                            0235
*     1 ENGFLAGS BIT(8),            /* ENVGTA CONTROL FLAGS          */
*      2 ENGEOF BIT(1),             /* END OF FILE ON GTA FILE       */
*      2 ENGCSROK BIT(1),           /* CAUSER IS IN CORRECT STATE TO
*                                      PROCESS ++IF DATA             */
*      2 * BIT(6);                  /* UNUSED                        */
*   RFY                                                            0236
*     RTNCODE RSTD;                                                0236
*   RFY                                                            0237
*     HMASMGTP BASED(TBLXIFGT);     /* ADDRESS ++IF GTA FILE         */
*   RFY                                                            0238
*     TPIFRECD BASED(GTPBUFAD);     /* ADDRESS ++IF GTA RECORD       */
*   ENGFLAGS=''B;                                                  0239
         MVI   ENGFLAGS,X'00'                                      0239
*   ENVGTARC=0;                     /* CLEAR RETURN CODE             */
*                                                                  0240
         SLR   ENVGTARC,ENVGTARC                                   0240
*   /*****************************************************************/
*   /*                                                               */
*   /* POSITION TO THE BEGINNING OF THE GTA FILE                     */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0241
*   GTPFUNCT=GTPOPENN;              /* REPOSITION TO THE BEGINNING OF
*                                      FILE                          */
         L     @14,@PC00001                                        0241
         L     @14,TBLXIFGT(,@14)                                  0241
         MVI   GTPFUNCT(@14),X'01'                                 0241
*   CALL HMASMGTA(HMASMGTP);        /* GET A RECORD                  */
         ST    @14,@AL00001                                        0242
         L     @15,@CV01666                                        0242
         LA    @01,@AL00001                                        0242
         BALR  @14,@15                                             0242
*   ENVGTARC=MAX(ENVGTARC,GTPRETRN);/* SAVE RC                       */
*                                                                  0243
         L     @14,@PC00001                                        0243
         L     @14,TBLXIFGT(,@14)                                  0243
         SLR   @10,@10                                             0243
         IC    @10,GTPRETRN(,@14)                                  0243
         CR    ENVGTARC,@10                                        0243
         BNL   *+6
         LR    ENVGTARC,@10                                        0243
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESS ALL ++IF GTA RECORDS WHOSE ENVIRONMENT NAMES THE      */
*   /* FUNCTION-TYPE SYSMOD PASSED                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0244
*   DO WHILE(ENVGTARC=ZERO          /* PROCESS ALL RECORDS UNTILE  0244
*                                      ERROR                         */
*         &ENGEOF=OFF);             /* OR END OF FILE                */
         B     @DE00244                                            0244
@DL00244 DS    0H                                                  0245
*     GTPFUNCT=GTPGETN;             /* GET A RECORD FOR GTA FILE     */
         L     @14,@PC00001                                        0245
         L     @14,TBLXIFGT(,@14)                                  0245
         MVI   GTPFUNCT(@14),X'08'                                 0245
*     CALL HMASMGTA(HMASMGTP);      /* ...                           */
         ST    @14,@AL00001                                        0246
         L     @15,@CV01666                                        0246
         LA    @01,@AL00001                                        0246
         BALR  @14,@15                                             0246
*     IF GTPRETRN=GTPEOF THEN       /* END OF FILE?                  */
         L     @14,@PC00001                                        0247
         L     @14,TBLXIFGT(,@14)                                  0247
         CLI   GTPRETRN(@14),4                                     0247
         BNE   @RF00247                                            0247
*       DO;                                                        0248
*         ENGEOF=ON;                /* END OF FILE                   */
         OI    ENGEOF,B'10000000'                                  0249
*       END;                                                       0250
*     ELSE                          /* GTA FAILURE                   */
*       DO;                                                        0251
         B     @RC00247                                            0251
@RF00247 DS    0H                                                  0252
*         ENVGTARC=MAX(ENVGTARC,GTPRETRN);/* SAVE RETURN CODE        */
         L     @14,@PC00001                                        0252
         L     @14,TBLXIFGT(,@14)                                  0252
         SLR   @10,@10                                             0252
         IC    @10,GTPRETRN(,@14)                                  0252
         CR    ENVGTARC,@10                                        0252
         BNL   *+6
         LR    ENVGTARC,@10                                        0252
*       END;                                                       0253
*                                                                  0253
*     /***************************************************************/
*     /*                                                             */
*     /* IF THE FMID OF THIS RECORD NAMES THE SYSMOD BEING PROCESSED,*/
*     /* THEN CHECK THE STATUS OF THE CAUSER OF THIS RECORD BEFORE   */
*     /* ADDING REQS TO ICT LIST                                     */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0254
*     IF ENVGTARC=ZERO              /* NO ERROR ...                  */
*         &TPISTAT=TPIVALID         /* ... AND VALID GTA RECORD      */
*         &ENGEOF=OFF               /* ... AND NOT EOF ...           */
*         &TPIFMID=ICTPTFS(1)       /* FMID MATCHES THIS SYSMOD      */
*       THEN                                                       0254
@RC00247 LTR   ENVGTARC,ENVGTARC                                   0254
         BNZ   @RF00254                                            0254
         L     @14,@PC00001                                        0254
         L     @10,TBLXIFGT(,@14)                                  0254
         L     @10,GTPBUFAD(,@10)                                  0254
         CLI   TPISTAT(@10),0                                      0254
         BNE   @RF00254                                            0254
         TM    ENGEOF,B'10000000'                                  0254
         BNZ   @RF00254                                            0254
         L     @02,@PC00001+4                                      0254
         L     @02,ENTRYPTR(,@02)                                  0254
         CLC   TPIFMID(7,@10),ICTPTFS(@02)                         0254
         BNE   @RF00254                                            0254
*       DO;                         /* YES,                          */
*                                                                  0255
*         /***********************************************************/
*         /*                                                         */
*         /* CHECK CAUSER IN THE ICT FOR APPROPRIATE STATE, I.E.     */
*         /* SYSMOD IS NOT NOGO AND IS NOT SUP'ED BY ANOTHER SYSMOD  */
*         /* IN THE ICT                                              */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0256
*         TSLFUNCT=TSLFISRH;        /* SEARCH ICT                    */
         L     @14,TBLXTSLP(,@14)                                  0256
         MVI   TSLFUNCT(@14),X'01'                                 0256
*         TSLPMLAD=ADDR(TSLICTSR);  /* POINT TO SEARCH PARM LIST     */
         LA    @02,ICTSR                                           0257
         ST    @02,TSLPMLAD(,@14)                                  0257
*         TSLICTSR=''B;             /* CLEAR SEARCH PARM LIST        */
         XC    TSLICTSR(14,@02),TSLICTSR(@02)                      0258
*         TSLISMD=TPICSR;           /* PUT CAUSER FROM GTA RECORD  0259
*                                      INTO SERACH PARM LIST         */
         MVC   TSLISMD(7,@02),TPICSR(@10)                          0259
*         CALL HMASMTSB(TSLPARMS);                                 0260
         ST    @14,@AL00001                                        0260
         L     @15,@CV01665                                        0260
         LA    @01,@AL00001                                        0260
         BALR  @14,@15                                             0260
*         IF TSLRETRN>=STOPPTF      /* TERMINATING ERROR             */
*           THEN                                                   0261
         L     @14,@PC00001                                        0261
         L     @14,TBLXTSLP(,@14)                                  0261
         CLI   TSLRETRN(@14),8                                     0261
         BL    @RF00261                                            0261
*           ENVGTARC=MAX(ENVGTARC,TSLRETRN);/* MAINTAIN RETRUN CODE  */
         SLR   @10,@10                                             0262
         IC    @10,TSLRETRN(,@14)                                  0262
         CR    ENVGTARC,@10                                        0262
         BNL   *+6
         LR    ENVGTARC,@10                                        0262
*         IF TSLIOK=ON THEN         /* ICT ENTRY IS OK               */
*                                                                  0263
@RF00261 LA    @14,ICTSR                                           0263
         TM    TSLIOK(@14),B'01000000'                             0263
         BNO   @RF00263                                            0263
*           /*********************************************************/
*           /*                                                       */
*           /* ADD THE REQ FROM THE GTA RECORD TO THE ICT IREQ LIST. */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0264
*           DO;                                                    0264
*             CALL REQADD(TPICSR,   /* CAUSER                        */
*                 TPIREQ,           /* REQUISITE SYSMOD              */
*                 ICTPTF(1));       /* ICT PTF SECT ENTRY TO ADD TO  */
         L     @14,@PC00001                                        0265
         L     @14,TBLXIFGT(,@14)                                  0265
         L     @14,GTPBUFAD(,@14)                                  0265
         ST    @14,@AL00001                                        0265
         LA    @14,TPIREQ(,@14)                                    0265
         ST    @14,@AL00001+4                                      0265
         L     @14,@PC00001+4                                      0265
         L     @14,ENTRYPTR(,@14)                                  0265
         ST    @14,@AL00001+8                                      0265
         LA    @01,@AL00001                                        0265
         BAL   @14,REQADD                                          0265
*             ENVGTARC=MAX(ENVGTARC,RTNCODE);                      0266
         CR    ENVGTARC,RTNCODE                                    0266
         BNL   *+6
         LR    ENVGTARC,RTNCODE                                    0266
*           END;                                                   0267
*       END;                                                       0268
@RF00263 DS    0H                                                  0269
*   END;                            /* END OF GTA SEARCH LOOP        */
@RF00254 DS    0H                                                  0269
@DE00244 LTR   ENVGTARC,ENVGTARC                                   0269
         BNZ   @DC00244                                            0269
         TM    ENGEOF,B'10000000'                                  0269
         BZ    @DL00244                                            0269
@DC00244 DS    0H                                                  0270
*   RFY                                                            0270
*     RTNCODE UNRSTD;                                              0270
*   RETURN CODE(ENVGTARC);          /* RETURN WITH RETURN CODE SET   */
         LR    @15,ENVGTARC                                        0271
         L     @14,@SA00002                                        0271
         LM    @00,@12,@SA00002+8                                  0271
         BR    @14                                                 0271
*   RFY                                                            0272
*     HMASMGTP BASED;                                              0272
*   RFY                                                            0273
*     TPIFRECD BASED;                                              0273
*   END ENVGTA;                                                    0274
*                                                                  0275
*/********************************************************************/
*/*                                                                  */
*/*  CSRGTA - FIND CONDITIONAL REQUISITES SUPPLIED BY THE SYSMOD     */
*/*           PASSED.                                                */
*/*                                                                  */
*/*           THOSE REQUISITES WHOSE FMID MATCHES AN FMID IN EITHER  */
*/*           THE ICT OR ON THE (A)CDS ARE ATTACHED TO THE SYSMOD    */
*/*           PASSED                                                 */
*/*                                                                  */
*/********************************************************************/
*                                                                  0275
*CSRGTA:                                                           0275
*   PROC;                                                          0275
CSRGTA   STM   @14,@12,@SA00003                                    0275
*   RESPECIFY                                                      0276
*     ICTPTF BASED(ENTRYPTR);       /* ADDRESS SYSMOD PASSED         */
*   DCL                                                            0277
*     CSRGTARC FIXED(15);           /* RETURN CODE                   */
*   DCL                                                            0278
*     1 CSGFLAG BIT(8),             /* CONTROL FLAGS                 */
*      2 CSGEOF BIT(1),             /* LOGICAL END OF FILE ON GTA CSR
*                                      SEARCH                        */
*      2 * BIT(7);                  /* UNUSED                        */
*   RFY                                                            0279
*     RTNCODE RSTD;                                                0279
*   RFY                                                            0280
*     HMASMGTP BASED(TBLXIFGT);                                    0280
*   RFY                                                            0281
*     TPIFRECD BASED(GTPBUFAD);                                    0281
*   CSRGTARC=ZERO;                  /* CLEAR RC                      */
         SLR   CSRGTARC,CSRGTARC                                   0282
*                                                                  0283
*   /*****************************************************************/
*   /*                                                               */
*   /* SET UP ++IF DATA GTP TO ACCESS GTA FILE.                      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0283
*   GTPFUNCT=GTPOPENN;              /* FUNCTION IS OPEN              */
         L     @14,@PC00001                                        0283
         L     @14,TBLXIFGT(,@14)                                  0283
         MVI   GTPFUNCT(@14),X'01'                                 0283
*   CALL HMASMGTA(HMASMGTP);        /* ...                           */
         ST    @14,@AL00001                                        0284
         L     @15,@CV01666                                        0284
         LA    @01,@AL00001                                        0284
         BALR  @14,@15                                             0284
*   CSRGTARC=MAX(CSRGTARC,GTPRETRN);/* ERROR CODE                    */
*                                                                  0285
         L     @14,@PC00001                                        0285
         L     @14,TBLXIFGT(,@14)                                  0285
         SLR   @10,@10                                             0285
         IC    @10,GTPRETRN(,@14)                                  0285
         CR    CSRGTARC,@10                                        0285
         BNL   *+6
         LR    CSRGTARC,@10                                        0285
*   /*****************************************************************/
*   /*                                                               */
*   /* PROCESS ALL ++IF GTA RECORDS SUPPLIED BY THE CURRENT SYSMOD   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0286
*   DO WHILE CSRGTARC=ZERO&GTPRETRN=ZERO;                          0286
         B     @DE00286                                            0286
@DL00286 DS    0H                                                  0287
*     GTPFUNCT=GTPGETN;                                            0287
         L     @14,@PC00001                                        0287
         L     @14,TBLXIFGT(,@14)                                  0287
         MVI   GTPFUNCT(@14),X'08'                                 0287
*     CALL HMASMGTA(HMASMGTP);      /* GET NEXT RECORD IN GTA        */
         ST    @14,@AL00001                                        0288
         L     @15,@CV01666                                        0288
         LA    @01,@AL00001                                        0288
         BALR  @14,@15                                             0288
*     IF GTPRETRN>GTPEOF THEN       /* IF ERROR SET ERROR CODE       */
         L     @14,@PC00001                                        0289
         L     @14,TBLXIFGT(,@14)                                  0289
         CLI   GTPRETRN(@14),4                                     0289
         BNH   @RF00289                                            0289
*       CSRGTARC=MAX(CSRGTARC,GTPRETRN);/*                           */
*                                                                  0290
         SLR   @10,@10                                             0290
         IC    @10,GTPRETRN(,@14)                                  0290
         CR    CSRGTARC,@10                                        0290
         BNL   *+6
         LR    CSRGTARC,@10                                        0290
*     /***************************************************************/
*     /*                                                             */
*     /* IF SYSMOD FOUND IN GTA FILE AS A CAUSER CHECK FMID VALUE    */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0291
*     IF GTPRETRN=GTPGOOD&TPICSR=ICTPTFS(1)/* ++IF STMT SUPPLIED BY
*                                      THE SYSMOD PASSED             */
*       THEN                                                       0291
@RF00289 L     @14,@PC00001                                        0291
         L     @10,TBLXIFGT(,@14)                                  0291
         CLI   GTPRETRN(@10),0                                     0291
         BNE   @RF00291                                            0291
         L     @10,GTPBUFAD(,@10)                                  0291
         L     @02,@PC00001+4                                      0291
         L     @02,ENTRYPTR(,@02)                                  0291
         CLC   TPICSR(7,@10),ICTPTFS(@02)                          0291
         BNE   @RF00291                                            0291
*       DO;                                                        0292
*                                                                  0292
*         /***********************************************************/
*         /*                                                         */
*         /* CHECK ENVIRONMENT (FMID) STATUS IN ICT AND ON (A)CDS IF */
*         /* STATUS OK ADD TO IFREQ LIST. THE STATUS IS OK IF NOT    */
*         /* DELETED, NOT NOGO, NOT IN ERROR, AND NOT SUP'ED         */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0293
*         TSLFUNCT=TSLFICSR;        /* ICT/(A)CDS SEARCH             */
         L     @14,TBLXTSLP(,@14)                                  0293
         MVI   TSLFUNCT(@14),X'04'                                 0293
*         TSLPMLAD=ADDR(TSLSICDS);  /* POINT TO ICT/CDS SEARCH PARM
*                                      LIST                          */
         LA    @02,SICDS                                           0294
         ST    @02,TSLPMLAD(,@14)                                  0294
*         TSLSICDS=''B;             /* CLEAR SEARCH PARM LIST        */
         XC    TSLSICDS(20,@02),TSLSICDS(@02)                      0295
*         TSLSSMD=TPIFMID;          /* SYSMOD FMID NAME              */
         MVC   TSLSSMD(7,@02),TPIFMID(@10)                         0296
*         TSLSOICT=ON;              /* SEARCH ICT                    */
*         TSLSOCDS=ON;              /* (A)CDS ONLY IF NOT IN ICT     */
         OI    TSLSOICT(@02),B'11000000'                           0298
*         CALL HMASMTSB(TSLPARMS);  /*                               */
         ST    @14,@AL00001                                        0299
         L     @15,@CV01665                                        0299
         LA    @01,@AL00001                                        0299
         BALR  @14,@15                                             0299
*         IF TSLRETRN>=STOPPTF      /* TERMINATING ERROR             */
*           THEN                                                   0300
         L     @14,@PC00001                                        0300
         L     @14,TBLXTSLP(,@14)                                  0300
         CLI   TSLRETRN(@14),8                                     0300
         BL    @RF00300                                            0300
*           CSRGTARC=MAX(CSRGTARC,TSLRETRN);/* MAINTAIN RETURN CODE  */
*                                                                  0301
         SLR   @10,@10                                             0301
         IC    @10,TSLRETRN(,@14)                                  0301
         CR    CSRGTARC,@10                                        0301
         BNL   *+6
         LR    CSRGTARC,@10                                        0301
*         /***********************************************************/
*         /*                                                         */
*         /* IF THE FMID IS VALID THEN PROCESS THE REQS.             */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0302
*         IF TSLSIOK=ON             /* ICT ENTRY FOUND AND GOOD      */
*             ×TSLSCOK=ON           /* OR (A)CDS ENTRY GOOD          */
*           THEN                                                   0302
@RF00300 LA    @14,SICDS                                           0302
         TM    TSLSIOK(@14),B'01000000'                            0302
         BO    @RT00302                                            0302
         TM    TSLSCOK(@14),B'01000000'                            0302
         BNO   @RF00302                                            0302
@RT00302 DS    0H                                                  0303
*           DO;                                                    0303
*                                                                  0303
*             /*******************************************************/
*             /*                                                     */
*             /* ADD THE REQ TO THE ICT IREQ LIST FOR THE SYSMOD     */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0304
*             CALL REQADD(TPICSR,   /* CAUSER                        */
*                 TPIREQ,           /* REQUISITE                     */
*                 ICTPTF(1));       /* ENTRY TO ATTACH REQS TO       */
         L     @14,@PC00001                                        0304
         L     @14,TBLXIFGT(,@14)                                  0304
         L     @14,GTPBUFAD(,@14)                                  0304
         ST    @14,@AL00001                                        0304
         LA    @14,TPIREQ(,@14)                                    0304
         ST    @14,@AL00001+4                                      0304
         L     @14,@PC00001+4                                      0304
         L     @14,ENTRYPTR(,@14)                                  0304
         ST    @14,@AL00001+8                                      0304
         LA    @01,@AL00001                                        0304
         BAL   @14,REQADD                                          0304
*             CSRGTARC=MAX(CSRGTARC,RTNCODE);/*                      */
         CR    CSRGTARC,RTNCODE                                    0305
         BNL   *+6
         LR    CSRGTARC,RTNCODE                                    0305
*           END;                                                   0306
*       END;                                                       0307
@RF00302 DS    0H                                                  0308
*   END;                            /* END OF CASUER ++IF RECORD   0308
*                                      PROCESS LOOP                  */
@RF00291 DS    0H                                                  0308
@DE00286 LTR   CSRGTARC,CSRGTARC                                   0308
         BNZ   @DC00286                                            0308
         L     @14,@PC00001                                        0308
         L     @14,TBLXIFGT(,@14)                                  0308
         CLI   GTPRETRN(@14),0                                     0308
         BE    @DL00286                                            0308
@DC00286 DS    0H                                                  0309
*   RFY                                                            0309
*     RTNCODE UNRSTD;               /*                               */
*   RETURN CODE(CSRGTARC);          /* RETURN WITH RETURN CODE SET   */
         LR    @15,CSRGTARC                                        0310
         L     @14,@SA00003                                        0310
         LM    @00,@12,@SA00003+8                                  0310
         BR    @14                                                 0310
*   RFY                                                            0311
*     HMASMGTP BASED(TBLXIFGT);                                    0311
*   RFY                                                            0312
*     TPIFRECD BASED(GTPBUFAD);                                    0312
*   END CSRGTA;                                                    0313
*                                                                  0314
*/********************************************************************/
*/*                                                                  */
*/*  ENVCRQ - FIND CONDITIONAL REQUISITES SUPPLIED BY PREVIOUSLY     */
*/*           INSTALLED SYSMODS WHICH REFERENCE THE SYSMOD CURRENTLY */
*/*           BEING INSTALLED.                                       */
*/*                                                                  */
*/*           THESE REQUISITES ARE ATTACHED TO THE SYSMOD BEING      */
*/*           PROCESSED.                                             */
*/*                                                                  */
*/********************************************************************/
*                                                                  0314
*ENVCRQ:                                                           0314
*   PROC;                                                          0314
ENVCRQ   STM   @14,@12,@SA00004                                    0314
*   RESPECIFY                                                      0315
*     ICTPTF BASED(ENTRYPTR);       /* ADDRESS SYSMOD CURRENTLY BEING
*                                      INSTALLED                     */
*   DCL                                                            0316
*     ENVCRQRC FIXED(15);           /* RETURN CODE                   */
*   DCL                                                            0317
*     CRQREQ CHAR(7);               /* REQ NAME SAVE                 */
*   DCL                                                            0318
*     1 ENCFLAGS BIT(8),            /* LOCAL CONTROL FLAGS           */
*      2 CSRVALID BIT(1),           /* CAUSER''S REQUISITES ARE VALID*/
*      2 * BIT(1),                  /* UNUSED                        */
*      2 * BIT(1),                  /* UNUSED                        */
*      2 * BIT(1),                  /* UNUSED                        */
*      2 * BIT(4);                  /* UNUSED                        */
*   DCL                                                            0319
*     CSRNDX FIXED(15);             /* INDEX OF CAUSER NAME SUB ENTRY
*                                      IN THE FMID (A)CRQ ENTRY      */
*   RFY                                                            0320
*     RTNCODE RSTD;                 /*                               */
*   ENCFLAGS=''B;                   /* CLEAR LOCAL FLAGS             */
         MVI   ENCFLAGS,X'00'                                      0321
*   ENVCRQRC=ZERO;                  /* CLEAR THE RETURN CODE         */
*                                                                  0322
         SLR   ENVCRQRC,ENVCRQRC                                   0322
*   /*****************************************************************/
*   /*                                                               */
*   /* LOCATE THE CRQ FMID ENTRY FOR THE SYSMOD BEING INSTALLED      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0323
*   IOPNAM17=ICTPTFS(1);            /* GET FMID (A)CRQ ENTRY FOR ... */
         L     @14,@PC00001+8                                      0323
         L     @10,@PC00001+4                                      0323
         L     @10,ENTRYPTR(,@10)                                  0323
         MVC   IOPNAM17(7,@14),ICTPTFS(@10)                        0323
*   IOPFUNCT=IOPLOC;                /* ... THE CURRENT FUNCTION      */
         MVI   IOPFUNCT(@14),X'03'                                 0324
*   IOPDSID=DSID;                   /* ...                           */
         STC   DSID,IOPDSID(,@14)                                  0325
*   IOPTYPE=IOPFMD;                 /* ...                           */
         MVI   IOPTYPE(@14),X'0E'                                  0326
*   CALL HMASMIO(HMASMIOP);         /* ...                           */
         ST    @14,@AL00001                                        0327
         L     @15,@CV01662                                        0327
         LA    @01,@AL00001                                        0327
         BALR  @14,@15                                             0327
*   IF IOPRETRN>IOPNTFND THEN       /* ERROR RETURN CODE?            */
         L     @14,@PC00001+8                                      0328
         CLI   IOPRETRN(@14),4                                     0328
         BNH   @RF00328                                            0328
*     DO;                           /* YES,                          */
*       ENVCRQRC=MAX(ENVCRQRC,IOPRETRN);/* SAVE RC                   */
         SLR   @10,@10                                             0330
         IC    @10,IOPRETRN(,@14)                                  0330
         CR    ENVCRQRC,@10                                        0330
         BNL   *+6
         LR    ENVCRQRC,@10                                        0330
*     END;                          /*                               */
*   IF IOPRETRN=IOPGOOD THEN        /* FMID (A)CRQ ENTRY FOUND       */
@RF00328 L     @14,@PC00001+8                                      0332
         CLI   IOPRETRN(@14),0                                     0332
         BNE   @RF00332                                            0332
*     DO;                           /*                               */
*                                                                  0333
*       /*************************************************************/
*       /*                                                           */
*       /* LOOP THRU THE CAUSER LIST IN THE (A)CRQ FMID ENTRY        */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0334
*       DO CSRNDX=1 BY 1            /*                               */
*             WHILE(ENVCRQRC=ZERO   /* PROCESS ALL CAUSER ENTRIES IN
*                                      FMID ENTRY                    */
*             &IOPQFMND(CSRNDX)^=IOPEOLST);/* ...                    */
         LA    CSRNDX,1                                            0334
         B     @DE00334                                            0334
@DL00334 DS    0H                                                  0335
*         IF IOPQFMTP(CSRNDX)=IOPQFMSM THEN/* IS THIS A CAUSER     0335
*                                      SUB-ENTRY                     */
         LR    @14,CSRNDX                                          0335
         MH    @14,@CH00523                                        0335
         L     @10,@PC00001+8                                      0335
         SLR   @05,@05                                             0335
         IC    @05,IOPQFMTP-9(@14,@10)                             0335
         CH    @05,@CH00065                                        0335
         BNE   @RF00335                                            0335
*           DO;                     /* YES,                          */
*                                                                  0336
*             /*******************************************************/
*             /*                                                     */
*             /* CHECK ICT/(A)CDS STATUS OF THE CAUSER               */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0337
*             CSRVALID=OFF;         /* ASSUME STATUS IS NOT VALID    */
         NI    CSRVALID,B'01111111'                                0337
*             TSLFUNCT=TSLFICSR;    /* ICT/(A)CDS SEARCH             */
         L     @05,@PC00001                                        0338
         L     @05,TBLXTSLP(,@05)                                  0338
         MVI   TSLFUNCT(@05),X'04'                                 0338
*             TSLPMLAD=ADDR(TSLSICDS);/* POINT TO ICT/CDS SEARCH PARM
*                                      LIST                          */
         LA    @02,SICDS                                           0339
         ST    @02,TSLPMLAD(,@05)                                  0339
*             TSLSICDS=''B;         /* CLEAR SEARCH PARM LIST        */
         XC    TSLSICDS(20,@02),TSLSICDS(@02)                      0340
*             TSLSSMD=IOPQFMNM(CSRNDX);/* CSR NAME                   */
         ALR   @10,@14                                             0341
         MVC   TSLSSMD(7,@02),IOPQFMNM-9(@10)                      0341
*             TSLSOICT=ON;          /* SEARCH ICT                    */
*             TSLSOCDS=ON;          /* (A)CDS ONLY IF NOT IN ICT     */
         OI    TSLSOICT(@02),B'11000000'                           0343
*             CALL HMASMTSB(TSLPARMS);                             0344
         ST    @05,@AL00001                                        0344
         L     @15,@CV01665                                        0344
         LA    @01,@AL00001                                        0344
         BALR  @14,@15                                             0344
*             IF TSLRETRN>=STOPPTF  /* TERMINATING RETURN CODE       */
*               THEN                                               0345
         L     @14,@PC00001                                        0345
         L     @14,TBLXTSLP(,@14)                                  0345
         CLI   TSLRETRN(@14),8                                     0345
         BL    @RF00345                                            0345
*               ENVCRQRC=MAX(ENVCRQRC,TSLRETRN);/* MAINTAIN CODE     */
         SLR   @10,@10                                             0346
         IC    @10,TSLRETRN(,@14)                                  0346
         CR    ENVCRQRC,@10                                        0346
         BNL   *+6
         LR    ENVCRQRC,@10                                        0346
*             IF TSLSIOK=ON         /* CAUSER "GO" IN ICT            */
*                 ×TSLSISUP=ON      /* CAUSER SUP'D IN ICT           */
*               THEN                                               0347
@RF00345 LA    @14,SICDS                                           0347
         TM    TSLSIOK(@14),B'01100000'                            0347
         BZ    @RF00347                                            0347
*               CSRVALID=OFF;       /* CRQ CAUSER DATA NOT VALID     */
         NI    CSRVALID,B'01111111'                                0348
*             ELSE                                                 0349
*               DO;                                                0349
         B     @RC00347                                            0349
@RF00347 DS    0H                                                  0350
*                 IF TSLSCFND=ON    /* CAUSER FOUND ON (A)CDS        */
*                   THEN                                           0350
         LA    @14,SICDS                                           0350
         TM    TSLSCFND(@14),B'10000000'                           0350
         BNO   @RF00350                                            0350
*                   IF TSLSCSUP=ON  /* ... SUP'D ON (A)CDS           */
*                       ×TSLSCERR=ON/* ... "IN ERROR" ON (A)CDS      */
*                     THEN                                         0351
         TM    TSLSCSUP(@14),B'00100010'                           0351
         BZ    @RF00351                                            0351
*                     CSRVALID=OFF; /* CAUSER'S REQS NOT VALID       */
         NI    CSRVALID,B'01111111'                                0352
*                   ELSE                                           0353
*                     CSRVALID=ON;  /* CAUSER'S REQS ARE VALID       */
         B     @RC00351                                            0353
@RF00351 OI    CSRVALID,B'10000000'                                0353
*                 ELSE                                             0354
*                   CSRVALID=ON;    /* CAUSER NOT FOUND ON (A)CDS ...
*                                      ... CONSIDER REQS VALID       */
         B     @RC00350                                            0354
@RF00350 OI    CSRVALID,B'10000000'                                0354
*               END;                                               0355
@RC00350 DS    0H                                                  0356
*             IF CSRVALID=ON        /* CAUSER''S REQS VALID          */
*               THEN                                               0356
@RC00347 TM    CSRVALID,B'10000000'                                0356
         BNO   @RF00356                                            0356
*               DO;                                                0357
*                                                                  0357
*                 /***************************************************/
*                 /*                                                 */
*                 /* A VALID CAUSER ... GET REQUISITES SUPPLIED      */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0358
*                 GETFIRST=ON;      /* FIRST CALL SWITCH             */
         OI    GETFIRST,B'10000000'                                0358
*                 GETIOP@=ADDR(HMASMIOP);/* IOP FOR (A)CRQ           */
         L     @14,@PC00001+8                                      0359
         ST    @14,GETIOP@                                         0359
*                 GETCSRNM=IOPQFMNM(CSRNDX);/* CAUSER TO ACCESS      */
         LR    @10,CSRNDX                                          0360
         MH    @10,@CH00523                                        0360
         ALR   @14,@10                                             0360
         MVC   GETCSRNM(7),IOPQFMNM-9(@14)                         0360
*                 GETFMID=ICTPTFS(1);/* FUNCTIONAL ENVIRONMENT IS THE
*                                      SYSMOD BEING PROCESSED        */
         L     @14,@PC00001+4                                      0361
         L     @14,ENTRYPTR(,@14)                                  0361
         MVC   GETFMID(7),ICTPTFS(@14)                             0361
*                 GETRETRN=0;       /* CLEAR GETREQ RETURN CODE      */
*                                                                  0362
         SLR   @14,@14                                             0362
         ST    @14,GETRETRN                                        0362
*                 /***************************************************/
*                 /*                                                 */
*                 /* GET ALL REQS FROM (A)CRQ CAUSER MEMBER          */
*                 /*                                                 */
*                 /***************************************************/
*                                                                  0363
*                 DO WHILE GETRETRN=0;                             0363
         B     @DE00363                                            0363
@DL00363 DS    0H                                                  0364
*                   CALL GETREQ(CRQREQ);/* GET REQUISITE FROM CAUSER */
         LA    @01,@AL00364                                        0364
         BAL   @14,GETREQ                                          0364
*                   IF GETRETRN>IOPEOF THEN/* I/O ERROR ON (A)CRQ    */
         L     @14,GETRETRN                                        0365
         CH    @14,@CH00039                                        0365
         BNH   @RF00365                                            0365
*                     ENVCRQRC=MAX(ENVCRQRC,IOPRETRN);/* ERROR CODE  */
         L     @14,@PC00001+8                                      0366
         SLR   @10,@10                                             0366
         IC    @10,IOPRETRN(,@14)                                  0366
         CR    ENVCRQRC,@10                                        0366
         BNL   *+6
         LR    ENVCRQRC,@10                                        0366
*                   IF GETRETRN=IOPGOOD/* NO I/O ERRORS              */
*                       &CRQREQ^=NULLPTF#/* REQ FOR CURRENT SYSMOD   */
*                     THEN                                         0367
@RF00365 ICM   @14,15,GETRETRN                                     0367
         BNZ   @RF00367                                            0367
         CLC   CRQREQ(7),@CC01671                                  0367
         BE    @RF00367                                            0367
*                     DO;                                          0368
*                                                                  0368
*                       /*********************************************/
*                       /*                                           */
*                       /* ADD THE REQ TO THE ICT IREQ LIST FOR THE  */
*                       /* SYSMOD                                    */
*                       /*                                           */
*                       /*********************************************/
*                                                                  0369
*                       CALL REQADD(IOPQFMNM(CSRNDX),/* CAUSER       */
*                           CRQREQ, /* REQUISITE                     */
*                           ICTPTF(1));/* ICT ENTRY FOR SMD          */
         LR    @14,CSRNDX                                          0369
         MH    @14,@CH00523                                        0369
         L     @10,@PC00001+8                                      0369
         LA    @14,IOPQFMNM-9(@14,@10)                             0369
         ST    @14,@AL00001                                        0369
         LA    @14,CRQREQ                                          0369
         ST    @14,@AL00001+4                                      0369
         L     @14,@PC00001+4                                      0369
         L     @14,ENTRYPTR(,@14)                                  0369
         ST    @14,@AL00001+8                                      0369
         LA    @01,@AL00001                                        0369
         BAL   @14,REQADD                                          0369
*                       ENVCRQRC=MAX(ENVCRQRC,RTNCODE);/*            */
         CR    ENVCRQRC,RTNCODE                                    0370
         BNL   *+6
         LR    ENVCRQRC,RTNCODE                                    0370
*                     END;                                         0371
*                 END;              /* GETREQ LOOP                   */
@RF00367 DS    0H                                                  0372
@DE00363 ICM   @14,15,GETRETRN                                     0372
         BZ    @DL00363                                            0372
*               END;                                               0373
*           END;                                                   0374
@RF00356 DS    0H                                                  0375
*       END;                        /* END OF FMID ENTRY PROCESS LOOP*/
@RF00335 AH    CSRNDX,@CH00065                                     0375
@DE00334 LTR   ENVCRQRC,ENVCRQRC                                   0375
         BNZ   @DC00334                                            0375
         LR    @14,CSRNDX                                          0375
         MH    @14,@CH00523                                        0375
         L     @10,@PC00001+8                                      0375
         SLR   @05,@05                                             0375
         IC    @05,IOPQFMND-9(@14,@10)                             0375
         CH    @05,@CH00712                                        0375
         BNE   @DL00334                                            0375
@DC00334 DS    0H                                                  0376
*     END;                                                         0376
*   RFY                                                            0377
*     RTNCODE UNRSTD;                                              0377
@RF00332 DS    0H                                                  0378
*   RETURN CODE(ENVCRQRC);                                         0378
         LR    @15,ENVCRQRC                                        0378
         L     @14,@SA00004                                        0378
         LM    @00,@12,@SA00004+8                                  0378
         BR    @14                                                 0378
*   RFY                                                            0379
*     HMASMIOP BASED(ADDR(CRQIOP));                                0379
*   RFY                                                            0380
*     ICTPTF BASED(ENTRYPTR);                                      0380
*   END ENVCRQ;                                                    0381
*                                                                  0382
*/********************************************************************/
*/*                                                                  */
*/*  GETREQ - READ AND DE-BLOCK (A)CRQ CAUSER ENTRY RECORDS AND      */
*/*           PASS REQUISITE SYSMOD BACK TO CALLER                   */
*/*                                                                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0382
*GETREQ:                                                           0382
*   PROC(GETREQNM);                 /* REQ NAME - RETURNED TO CALLER */
GETREQ   STM   @14,@12,@SA00005                                    0382
         MVC   @PC00005(4),0(@01)                                  0382
*   DCL                                                            0383
*     GETREQNM CHAR(7);             /* PASS BACK REQ NAME            */
*   DCL                                                            0384
*     COUNT FIXED(31);              /* CAUSER RECORD DE-BLOCKING CNT */
*   RFY                                                            0385
*     HMASMIOP BASED(GETIOP@);      /* IOP FOR READ OR CRQ RECORDS   */
*   IOPRETRN=IOPGOOD;               /* INITIALIZE RETURN CODE FIELD  */
         L     @10,GETIOP@                                         0386
         MVI   IOPRETRN(@10),X'00'                                 0386
*   GETRETRN=0;                     /* CLEAR RETURN CODE PASSED      */
         SLR   @15,@15                                             0387
         ST    @15,GETRETRN                                        0387
*   IF GETFIRST=ON THEN             /* FIRST CALL FOR THIS CSR       */
         TM    GETFIRST,B'10000000'                                0388
         BNO   @RF00388                                            0388
*     DO;                                                          0389
*                                                                  0389
*       /*************************************************************/
*       /*                                                           */
*       /* LOCATE THE CAUSER ENTRY ON THE (A)CRQ                     */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0390
*       GETFIRST=OFF;               /* CLEAR FIRST-CALL FLAG         */
         NI    GETFIRST,B'01111111'                                0390
*       IOPDSID=TBLXCRQI;           /* CRQ OR ACRQ DATASET           */
         L     @15,@PC00001                                        0391
         MVC   IOPDSID(1,@10),TBLXCRQI(@15)                        0391
*       IOPTYPE=IOPCSR;             /* CAUSER ENTRY TYPE             */
         MVI   IOPTYPE(@10),X'0F'                                  0392
*       IOPNAM17=GETCSRNM;          /* CAUSER ENTRY TO BE LOCATED    */
         MVC   IOPNAM17(7,@10),GETCSRNM                            0393
*       IOPFUNCT=IOPBLDL;           /* SET LOCATE FUNCTION           */
         MVI   IOPFUNCT(@10),X'04'                                 0394
*       CALL HMASMIO(HMASMIOP);                                    0395
         ST    @10,@AL00001                                        0395
         L     @15,@CV01662                                        0395
         LA    @01,@AL00001                                        0395
         BALR  @14,@15                                             0395
*       GETRETRN=MAX(GETRETRN,IOPRETRN);                           0396
         L     @10,GETIOP@                                         0396
         L     @15,GETRETRN                                        0396
         SLR   @14,@14                                             0396
         IC    @14,IOPRETRN(,@10)                                  0396
         CR    @15,@14                                             0396
         BNL   *+6
         LR    @15,@14                                             0396
         ST    @15,GETRETRN                                        0396
*       IF IOPRETRN=IOPGOOD THEN                                   0397
*                                                                  0397
         CLI   IOPRETRN(@10),0                                     0397
         BNE   @RF00397                                            0397
*         /***********************************************************/
*         /*                                                         */
*         /* POSITION TO FIRST CAUSER ENTRY RECORD                   */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0398
*         DO;                                                      0398
*           IOPFUNCT=IOPPOSI;                                      0399
         MVI   IOPFUNCT(@10),X'02'                                 0399
*           CALL HMASMIO(HMASMIOP);                                0400
         ST    @10,@AL00001                                        0400
         L     @15,@CV01662                                        0400
         LA    @01,@AL00001                                        0400
         BALR  @14,@15                                             0400
*           GETRETRN=MAX(GETRETRN,IOPRETRN);                       0401
         L     @10,GETRETRN                                        0401
         L     @01,GETIOP@                                         0401
         SLR   @00,@00                                             0401
         IC    @00,IOPRETRN(,@01)                                  0401
         CR    @10,@00                                             0401
         BNL   *+6
         LR    @10,@00                                             0401
         ST    @10,GETRETRN                                        0401
*           COUNT=DIM(IOPQSMLS);    /* SET DE-BLOCK COUNT SO RECORD
*                                      WILL BE READ                  */
         MVC   COUNT(4),@CF00057                                   0402
*         END;                                                     0403
*     END;                                                         0404
@RF00397 DS    0H                                                  0405
*   IF COUNT>=DIM(IOPQSMLS)         /* ALL REQS FROM CURRENT RECORD
*                                      HAVE BEEN PROCESSED           */
*       &IOPRETRN=IOPGOOD           /* NO I/O ERRORS                 */
*     THEN                                                         0405
@RF00388 L     @10,COUNT                                           0405
         CH    @10,@CH00057                                        0405
         BL    @RF00405                                            0405
         L     @10,GETIOP@                                         0405
         CLI   IOPRETRN(@10),0                                     0405
         BNE   @RF00405                                            0405
*     DO;                           /* YES,                          */
*                                                                  0406
*       /*************************************************************/
*       /*                                                           */
*       /* READ NEXT CAUSER ENTRY RECORD                             */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0407
*       IOPFUNCT=IOPREAD;           /* READ FUNCTION                 */
         MVI   IOPFUNCT(@10),X'01'                                 0407
*       CALL HMASMIO(HMASMIOP);     /*                               */
         ST    @10,@AL00001                                        0408
         L     @15,@CV01662                                        0408
         LA    @01,@AL00001                                        0408
         BALR  @14,@15                                             0408
*       GETRETRN=MAX(GETRETRN,IOPRETRN);                           0409
         L     @10,GETRETRN                                        0409
         L     @01,GETIOP@                                         0409
         SLR   @00,@00                                             0409
         IC    @00,IOPRETRN(,@01)                                  0409
         CR    @10,@00                                             0409
         BNL   *+6
         LR    @10,@00                                             0409
         ST    @10,GETRETRN                                        0409
*       COUNT=ZERO;                 /* CLEAR COUNT OF REQS PROCESSED
*                                      IN CURRENT RECORD             */
         SLR   @10,@10                                             0410
         ST    @10,COUNT                                           0410
*     END;                                                         0411
*                                                                  0411
*   /*****************************************************************/
*   /*                                                               */
*   /* NOW GET NEXT REQ NAME FROM THE RECORD                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0412
*   IF GETRETRN=0                   /* NO ERRORS NOR END-OF-FILE     */
*     THEN                                                         0412
@RF00405 ICM   @10,15,GETRETRN                                     0412
         BNZ   @RF00412                                            0412
*     DO;                                                          0413
*       COUNT=COUNT+1;              /* PICK UP NEXT REQ IN CSR RECORD*/
         LA    @10,1                                               0414
         AL    @10,COUNT                                           0414
         ST    @10,COUNT                                           0414
*       IF IOPQSMFM=GETFMID         /* CAUSER FMID MATCHES THE     0415
*                                      ENVIRONMENT PASSED            */
*         THEN                                                     0415
         L     @01,GETIOP@                                         0415
         L     @15,IOPBUFAD(,@01)                                  0415
         CLC   IOPQSMFM(7,@15),GETFMID                             0415
         BNE   @RF00415                                            0415
*         DO;                                                      0416
*           IF IOPQSMND(COUNT)^=IOPEOLST/* NOT END-OF-REQS IN RECORD */
*             THEN                                                 0417
         MH    @10,@CH00523                                        0417
         LA    @01,0(@10,@15)                                      0417
         BCTR  @01,0                                               0417
         SLR   @00,@00                                             0417
         IC    @00,IOPQSMND-8(,@01)                                0417
         CH    @00,@CH00712                                        0417
         BE    @RF00417                                            0417
*             GETREQNM=IOPQSMNM(COUNT);/* RETURN REQUISITE TO CALLER */
         L     @14,@PC00005                                        0418
         ALR   @15,@10                                             0418
         BCTR  @15,0                                               0418
         MVC   GETREQNM(7,@14),IOPQSMNM-8(@15)                     0418
*           ELSE                                                   0419
*             DO;                                                  0419
         B     @RC00417                                            0419
@RF00417 DS    0H                                                  0420
*               GETREQNM=NULLPTF#;  /* RETURN BLANKS TO CALLER       */
         L     @10,@PC00005                                        0420
         MVC   GETREQNM(7,@10),@CC01671                            0420
*               COUNT=DIM(IOPQSMLS);/* FORCE READ OF ANOTHER RECORD  */
         MVC   COUNT(4),@CF00057                                   0421
*             END;                                                 0422
*         END;                                                     0423
*       ELSE                                                       0424
*         DO;                                                      0424
         B     @RC00415                                            0424
@RF00415 DS    0H                                                  0425
*           GETREQNM=NULLPTF#;      /* RETURN BLANKS TO CALLER       */
         L     @10,@PC00005                                        0425
         MVC   GETREQNM(7,@10),@CC01671                            0425
*           COUNT=DIM(IOPQSMLS);    /* FORCE READ OF ANOTHER RECORD  */
         MVC   COUNT(4),@CF00057                                   0426
*         END;                                                     0427
*     END;                                                         0428
@RC00415 DS    0H                                                  0429
*   RETURN CODE(GETRETRN);          /* RETURN TO CALLER              */
@RF00412 L     @15,GETRETRN                                        0429
         L     @14,@SA00005                                        0429
         LM    @00,@12,@SA00005+8                                  0429
         BR    @14                                                 0429
*   END GETREQ;                                                    0430
*                                                                  0431
*/********************************************************************/
*/*                                                                  */
*/*  REQADD - ADD REQ NAMES TO AN ICT PTF SECTION ENTRY VIA CALL     */
*/*           TO HMASMTAI                                            */
*/*                                                                  */
*/*                                                                  */
*/********************************************************************/
*                                                                  0431
*REQADD:                                                           0431
*   PROC(NMCSR,NMREQ,REQAICT);                                     0431
REQADD   STM   @14,@12,@SA00006                                    0431
         MVC   @PC00006(12),0(@01)                                 0431
*   DCL                                                            0432
*     NMCSR CHAR(7);                /* CAUSER NAME FROM CALLER       */
*   DCL                                                            0433
*     NMREQ CHAR(7);                /* REQ NAME FROM CALLER          */
*   DCL                                                            0434
*     REQAICT CHAR(*);              /* ICT PTF ENTRY TO ADD REQS TO  */
*   DCL                                                            0435
*     1 IRQNT,                      /* MAPPING FOR ICT IREQ ENTRY    */
*       3 IRQNM CHAR(7),            /* IREQ NAME                     */
*       3 IRQST BIT(8),             /* ITS STATUS                    */
*        4 * BIT(5),                                               0435
*        4 IRQIREQI BIT(1),         /* SELF REQ''ING - MUST BE IN ICT*/
*        4 * BIT(2),                                               0435
*       3 CSRNM CHAR(7),            /* CAUSER NAME                   */
*       3 CSRST BIT(8);             /* ITS STATUS                    */
*   DCL                                                            0436
*     ADDRC FIXED(8);               /* ERROR CODE FOR RETURN         */
*   RESPECIFY                                                      0437
*     ICTPTF BASED(ADDR(REQAICT));  /* ADDRESS ICT PTF SECT ENTRY    */
*   ADDRC=ZERO;                     /* CLEAR RETURN CODE COLLECTOR   */
*                                                                  0438
         SLR   ADDRC,ADDRC                                         0438
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE IREQ ENTRY                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0439
*   IRQNM=NMREQ;                    /* SET REQUISITE SYSMOD-ID       */
         L     @10,@PC00006+4                                      0439
         MVC   IRQNM(7),NMREQ(@10)                                 0439
*   IRQST=''B;                      /* CLEAR REQUISITE STATUS        */
         MVI   IRQST,X'00'                                         0440
*   CSRNM=NMCSR;                    /* SET CAUSER OF REQUISITE       */
         L     @10,@PC00006                                        0441
         MVC   CSRNM(7),NMCSR(@10)                                 0441
*   CSRST=''B;                      /* CLEAR CAUSER STATUS           */
         MVI   CSRST,X'00'                                         0442
*   IF IRQNM=CSRNM                  /* ++IF STMT REQS ITSELF         */
*     THEN                                                         0443
         CLC   IRQNM(7),CSRNM                                      0443
         BNE   @RF00443                                            0443
*     IRQIREQI=ON;                  /* SELF REQ''ING SYSMOD          */
*                                                                  0444
         OI    IRQIREQI,B'00000100'                                0444
*   /*****************************************************************/
*   /*                                                               */
*   /* ADD IREQ ENTRY TO IREQ LIST FOR SYSMOD                        */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0445
*   IF ICTPICHN(1)=TBLXNULL         /* POINTS TO EMPTY LIST          */
*     THEN                                                         0445
@RF00443 L     @10,@PC00006+8                                      0445
         L     @02,@PC00001                                        0445
         CLC   ICTPICHN(4,@10),TBLXNULL(@02)                       0445
         BNE   @RF00445                                            0445
*     ICTPICHN(1)=ZERO;             /* FOR TAI, INDICATES FIRST CALL */
         SLR   @02,@02                                             0446
         ST    @02,ICTPICHN(,@10)                                  0446
*   CALL HMASMTAI(TBLXPARM,         /* STARNDARD PARM LIST           */
*       ICTPICHN(1),                /* LIST ADDRESS                  */
*       ADDR(IRQNT),                /* ENTRY TO BE ADDED             */
*       LENGTH(ICTIRQNT)            /* IREQ ENTRY LENGTH             */
*       );                                                         0447
@RF00445 L     @10,@PC00001                                        0447
         ST    @10,@AL00001                                        0447
         L     @10,@PC00006+8                                      0447
         LA    @10,ICTPICHN(,@10)                                  0447
         ST    @10,@AL00001+4                                      0447
         LA    @10,IRQNT                                           0447
         ST    @10,@TF00001                                        0447
         LA    @10,@TF00001                                        0447
         ST    @10,@AL00001+8                                      0447
         LA    @10,@CF00060                                        0447
         ST    @10,@AL00001+12                                     0447
         L     @15,@CV01664                                        0447
         LA    @01,@AL00001                                        0447
         BALR  @14,@15                                             0447
*   RFY                                                            0448
*     RTNCODE RSTD;                                                0448
*   ADDRC=MAX(ADDRC,RTNCODE);                                      0449
         CR    ADDRC,RTNCODE                                       0449
         BNL   *+6
         LR    ADDRC,RTNCODE                                       0449
*   RFY                                                            0450
*     RTNCODE UNRSTD;                                              0450
*   RETURN CODE(ADDRC);             /* RETURN TO CALLER              */
         LR    @15,ADDRC                                           0451
         L     @14,@SA00006                                        0451
         LM    @00,@12,@SA00006+8                                  0451
         BR    @14                                                 0451
*   END REQADD;                                                    0452
*   END HMASMTP2                                                   0453
*                                                                  0453
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (HMASMCCA)                                       */
*/*%INCLUDE SYSLIB  (HMASMIOP)                                       */
*/*%INCLUDE SYSLIB  (HMASMICT)                                       */
*/*%INCLUDE SYSLIB  (HMASMMGP)                                       */
*/*%INCLUDE SYSLIB  (HMASMGTP)                                       */
*                                                                  0453
*       ;                                                          0453
@DATA    DS    0H
@CH00065 DC    H'1'
@CH00039 DC    H'4'
@CH00523 DC    H'9'
@CH00712 DC    H'255'
         DS    0F
@AL00364 DC    A(CRQREQ)               LIST WITH   1 ARGUMENT(S)
         DS    0F
@SA00001 DS    18F
@PC00001 DS    3F
@SA00002 DS    15F
@SA00004 DS    15F
@SA00003 DS    15F
@SA00005 DS    0F
@PC00005 EQU   @SA00005+60
@SA00006 DS    0F
@PC00006 EQU   @SA00006+60
         DS    18F
@AL00001 DS    4A
@TF00001 DS    F
         DS    0F
@CF00057 DC    F'8'
@CH00057 EQU   @CF00057+2
@CF00060 DC    F'16'
@CV01662 DC    V(HMASMIO)
@CV01664 DC    V(HMASMTAI)
@CV01665 DC    V(HMASMTSB)
@CV01666 DC    V(HMASMGTA)
@CV01663 DC    V(HMASMMSG)
         DS    0D
IOPPTR   DS    A
COUNT    DS    F
@CC01671 DC    C'       '
         DS    CL1
ICTENDCH DC    X'FFFFFFFF'
HMASMMGP DS    CL24
         ORG   HMASMMGP
MGPFIXED DS    CL12
         ORG   MGPFIXED
MGPCLEAR DS    CL6
         ORG   MGPCLEAR
MGPMGNO1 DS    FL2
MGPMGNO2 DS    FL2
MGPMGNO3 DS    FL2
         ORG   MGPFIXED+6
MGPFLAGS DS    BL2
         ORG   MGPFLAGS
MGPPRINT DS    BL1
MGPLIST  EQU   MGPFLAGS+0
MGPRPT   EQU   MGPFLAGS+0
MGPHLDS  EQU   MGPFLAGS+0
MGPWTOR  EQU   MGPFLAGS+0
MGPWTO   EQU   MGPFLAGS+0
MGPWTP   EQU   MGPFLAGS+0
@NM00213 EQU   MGPFLAGS+0
         ORG   MGPFIXED+8
MGPTYPE  DS    FL1
@NM00214 DS    CL3
         ORG   HMASMMGP+12
MGPVAR   DS    CL12
         ORG   MGPVAR
MGPVARPT DS    3A
         ORG   HMASMMGP+24
PATCHTP2 DS    CL80
         ORG   PATCHTP2
@NM00234 DC    80X'FF'
         ORG   PATCHTP2+80
SYSMOD   DS    CL7
TP2FLAGS DS    CL1
         ORG   TP2FLAGS
TAIFRST  DS    BL1
@NM00235 EQU   TP2FLAGS+0
         ORG   TP2FLAGS+1
GETPARMS DS    CL23
         ORG   GETPARMS
GETRETRN DS    FL4
GETIOP@  DS    AL4
GETCSRNM DS    CL7
GETFMID  DS    CL7
GETFLGS  DS    BL1
         ORG   GETFLGS
GETFIRST DS    BL1
@NM00236 EQU   GETFLGS+0
         ORG   GETPARMS+23
CSRBUFFR DS    CL80
ICTSR    DS    CL14
SICDS    DS    CL20
ENGFLAGS DS    BL1
         ORG   ENGFLAGS
ENGEOF   DS    BL1
ENGCSROK EQU   ENGFLAGS+0
@NM00237 EQU   ENGFLAGS+0
         ORG   ENGFLAGS+1
CSGFLAG  DS    BL1
         ORG   CSGFLAG
CSGEOF   DS    BL1
@NM00238 EQU   CSGFLAG+0
         ORG   CSGFLAG+1
CRQREQ   DS    CL7
ENCFLAGS DS    BL1
         ORG   ENCFLAGS
CSRVALID DS    BL1
@NM00239 EQU   ENCFLAGS+0
@NM00240 EQU   ENCFLAGS+0
@NM00241 EQU   ENCFLAGS+0
@NM00242 EQU   ENCFLAGS+0
         ORG   ENCFLAGS+1
IRQNT    DS    CL16
         ORG   IRQNT
IRQNM    DS    CL7
IRQST    DS    BL1
         ORG   IRQST
@NM00243 DS    BL1
IRQIREQI EQU   IRQST+0
@NM00244 EQU   IRQST+0
         ORG   IRQNT+8
CSRNM    DS    CL7
CSRST    DS    BL1
         ORG   IRQNT+16
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
ADDRC    EQU   @03
CSRNDX   EQU   @04
ENVCRQRC EQU   @03
CSRGTARC EQU   @03
ENVGTARC EQU   @03
SAVBUFAD EQU   @05
DSID     EQU   @04
TP2RC    EQU   @03
CCAPTR   EQU   @11
RTNCODE  EQU   @15
RTNREG   EQU   @14
TBLXOPTS EQU   0
TBLFLAGS EQU   TBLXOPTS+8
TBLFLG1  EQU   TBLFLAGS
TBLFLG2  EQU   TBLFLAGS+2
TBLFLG3  EQU   TBLFLAGS+3
TBLFLG4  EQU   TBLFLAGS+5
TBLFLG5  EQU   TBLFLAGS+7
HMASMCCA EQU   0
CCAFBUFR EQU   HMASMCCA+4
CCADSAD  EQU   CCAFBUFR+124
CCATPAD  EQU   CCAFBUFR+128
CCAFLAG7 EQU   CCAFBUFR+132
CCAFIOP  EQU   HMASMCCA+140
CCAFSYS  EQU   HMASMCCA+148
CCASREL  EQU   CCAFSYS+12
CCAFLAGA EQU   CCAFSYS+21
CCAFSTA  EQU   HMASMCCA+188
CCAFICT  EQU   HMASMCCA+192
CCAFPGM  EQU   HMASMCCA+208
CCABLDLP EQU   CCAFPGM
CCADBLDL EQU   CCAFPGM+4
CCAFGTP  EQU   HMASMCCA+224
CCASEGTP EQU   CCAFGTP
@NM00023 EQU   HMASMCCA+244
CCAFFUNC EQU   HMASMCCA+264
CCAFLAG1 EQU   CCAFFUNC+8
CCAFLAG2 EQU   CCAFFUNC+11
CCAFPROC EQU   HMASMCCA+276
CCAFLAG3 EQU   CCAFPROC
CCAFDIS  EQU   HMASMCCA+278
CCAFLAG4 EQU   CCAFDIS
CCAFLAG5 EQU   CCAFDIS+1
CCAFLAG6 EQU   CCAFDIS+2
CCAFCNV  EQU   HMASMCCA+281
CCAFLAG8 EQU   CCAFCNV
CCAFCTL  EQU   HMASMCCA+282
CCAFLAG9 EQU   CCAFCTL
CCAFDSNG EQU   HMASMCCA+298
CCAFLAGB EQU   CCAFDSNG
CCABLDLA EQU   0
@NM00039 EQU   CCABLDLA
CCABLDLL EQU   0
@NM00041 EQU   CCABLDLL
CCALKDRC EQU   @NM00041+20
@NM00043 EQU   CCABLDLL+124
CCAASMRC EQU   @NM00043+20
@NM00045 EQU   CCABLDLL+248
CCACPYRC EQU   @NM00045+20
@NM00047 EQU   CCABLDLL+372
CCACOMRC EQU   @NM00047+20
@NM00049 EQU   CCABLDLL+496
CCAZAPRC EQU   @NM00049+20
@NM00051 EQU   CCABLDLL+620
CCASUPRC EQU   @NM00051+20
@NM00053 EQU   CCABLDLL+744
CCAUPDRC EQU   @NM00053+20
CCABLDLM EQU   0
CCABELMT EQU   CCABLDLM+4
CCABMPOS EQU   CCABELMT
HMASMIOP EQU   0
IOPDSID  EQU   HMASMIOP
IOPFUNCT EQU   HMASMIOP+1
IOPRETRN EQU   HMASMIOP+2
IOPTYPE  EQU   HMASMIOP+3
IOPNAME  EQU   HMASMIOP+4
IOPNAM17 EQU   IOPNAME
@NM00057 EQU   HMASMIOP+12
@NM00058 EQU   @NM00057
IOPDDNAM EQU   HMASMIOP+24
IOPBUFAD EQU   HMASMIOP+52
IOPDRMAP EQU   HMASMIOP+56
IOPINAME EQU   IOPDRMAP
IOPINAM  EQU   IOPINAME
IOPITYP  EQU   IOPINAM
IOPUSERL EQU   IOPDRMAP+11
IOPEND   EQU   IOPDRMAP+12
IOPLMCTL EQU   0
IOPQSMIF EQU   0
@NM00168 EQU   IOPQSMIF
IOPQSMFM EQU   @NM00168
IOPQSMLS EQU   IOPQSMIF+8
IOPQSMNM EQU   IOPQSMLS
IOPQSMND EQU   IOPQSMNM
IOPBS02  EQU   0
IOPBS04  EQU   0
IOPBAPF  EQU   IOPBS04
ICTPTF   EQU   0
ICTPTFS  EQU   ICTPTF
ICTPFLG1 EQU   ICTPTF+7
ICTPFLG3 EQU   ICTPTF+8
ICTPPROC EQU   ICTPFLG3
ICTPFLG5 EQU   ICTPTF+9
ICTPFLG6 EQU   ICTPTF+11
ICTPFLF  EQU   ICTPFLG6
ICTPFLG2 EQU   ICTPTF+12
ICTPFLG4 EQU   ICTPTF+13
ICTPFLG8 EQU   ICTPTF+14
ICTPFLG9 EQU   ICTPTF+15
@NM00195 EQU   ICTPFLG9
ICTPFLGA EQU   ICTPTF+16
ICTPUSR1 EQU   ICTPFLGA
ICTPTYPE EQU   ICTPTF+17
ICTPCHN  EQU   ICTPTF+64
ICTPRCHN EQU   ICTPTF+68
ICTPSCHN EQU   ICTPTF+72
ICTPPCHN EQU   ICTPTF+76
ICTPICHN EQU   ICTPTF+80
ICTPNCHN EQU   ICTPTF+84
ICTPVCHN EQU   ICTPTF+88
ICTPDCHN EQU   ICTPTF+92
ICTPBCHN EQU   ICTPTF+96
ICTIXPF  EQU   0
ICTENTLS EQU   0
ICTENTNT EQU   ICTENTLS
ICTENTNM EQU   ICTENTNT
ICTENTST EQU   ICTENTNT+7
ICTREQLS EQU   0
ICTREQNT EQU   ICTREQLS
ICTREQNM EQU   ICTREQNT
ICTREQST EQU   ICTREQNT+7
ICTSUPLS EQU   0
ICTSUPNT EQU   ICTSUPLS
ICTSUPNM EQU   ICTSUPNT
ICTPRELS EQU   0
ICTPRENT EQU   ICTPRELS
ICTPRENM EQU   ICTPRENT
ICTPREST EQU   ICTPRENT+7
ICTIRQLS EQU   0
ICTIRQNT EQU   ICTIRQLS
ICTIRQNM EQU   ICTIRQNT
ICTIRQST EQU   ICTIRQNT+7
ICTCSRST EQU   ICTIRQNT+15
ICTNPRLS EQU   0
ICTNPRNT EQU   ICTNPRLS
ICTNPRNM EQU   ICTNPRNT
ICTVRSLS EQU   0
ICTVRSNT EQU   ICTVRSLS
ICTVRSNM EQU   ICTVRSNT
ICTDELLS EQU   0
ICTDELNT EQU   ICTDELLS
ICTDELNM EQU   ICTDELNT
ICTDELST EQU   ICTDELNT+7
ICTSBYLS EQU   0
ICTSBYNT EQU   ICTSBYLS
ICTSBYNM EQU   ICTSBYNT
HMASMGTP EQU   0
GTPFUNCT EQU   HMASMGTP
GTPRETRN EQU   HMASMGTP+1
GTPBUFAD EQU   HMASMGTP+12
GTPRESTR EQU   HMASMGTP+16
GTPFLGS1 EQU   HMASMGTP+26
TPIFRECD EQU   0
TPIKEY   EQU   TPIFRECD
TPICSR   EQU   TPIKEY
TPIFMID  EQU   TPIKEY+7
TPIREQ   EQU   TPIKEY+14
TPIDATA  EQU   TPIFRECD+21
TPISTAT  EQU   TPIDATA
TSLPARMS EQU   0
TSLTBLXP EQU   TSLPARMS
TSLPMLAD EQU   TSLPARMS+4
TSLFUNCT EQU   TSLPARMS+8
TSLRETRN EQU   TSLPARMS+9
TSLICTSR EQU   0
TSLISMD  EQU   TSLICTSR
TSLIOPTF EQU   TSLICTSR+7
TSLICTF  EQU   TSLICTSR+12
TSLIOK   EQU   TSLICTF
TSLLSTSR EQU   0
TSLLOPTF EQU   TSLLSTSR+7
TSLGET   EQU   0
TSLGOPTF EQU   TSLGET+7
TSLSICDS EQU   0
TSLSSMD  EQU   TSLSICDS
TSLSOPTF EQU   TSLSICDS+7
TSLSOICT EQU   TSLSOPTF
TSLSOCDS EQU   TSLSOPTF
TSLSICTF EQU   TSLSICDS+16
TSLSIOK  EQU   TSLSICTF
TSLSISUP EQU   TSLSICTF
TSLSCDSF EQU   TSLSICDS+18
TSLSCFND EQU   TSLSCDSF
TSLSCOK  EQU   TSLSCDSF
TSLSCSUP EQU   TSLSCDSF
TSLSCERR EQU   TSLSCDSF
TSLENTSR EQU   0
TSLEOPTF EQU   TSLENTSR+2
TSLMFUNC EQU   0
TSLRELM  EQU   0
SYSMFMID EQU   0
SYSMFMKY EQU   SYSMFMID
CCADSIDA EQU   0
CCATYPEA EQU   0
IOPBS01  EQU   0
IOPBS03  EQU   0
TBLXPARM EQU   0
TBLXINDX EQU   TBLXPARM+4
TBLXTBL  EQU   TBLXPARM+28
TBLXNULL EQU   TBLXPARM+36
TBLXIFGT EQU   TBLXPARM+40
TBLXCRQI EQU   TBLXPARM+61
TBLXFLG1 EQU   TBLXPARM+80
TBLXTSLP EQU   TBLXPARM+84
TBLXRC   EQU   TBLXPARM+92
ENTRYPTR EQU   0
CRQIOP   EQU   0
GETREQNM EQU   0
NMCSR    EQU   0
NMREQ    EQU   0
REQAICT  EQU   0
IOPUDATA EQU   IOPEND
IOPINAM3 EQU   IOPINAME
@NM00064 EQU   IOPINAM3
IOPSTCMP EQU   IOPUDATA
IOPDYNDT EQU   IOPUDATA
IOPSPACE EQU   IOPDYNDT+44
IOPDTYPE EQU   IOPDYNDT+50
IOPNTMAX EQU   IOPDRMAP
IOPNTMAP EQU   IOPDRMAP
IOPCDMAP EQU   IOPNTMAP
IOPPTMAP EQU   IOPCDMAP
IOPSCMAP EQU   IOPPTMAP
IOPDIRCT EQU   IOPSCMAP+12
IOPCDMAX EQU   IOPDIRCT
IOPCQMAP EQU   IOPDRMAP
@NM00075 EQU   IOPUDATA
@NM00076 EQU   IOPUDATA
IOPASMNT EQU   IOPUDATA
IOPASMDR EQU   IOPASMNT
IOPABUNT EQU   IOPASMDR+1
IOPLMDNT EQU   IOPUDATA
IOPLMDDR EQU   IOPLMDNT
IOPLMLEP EQU   IOPLMDDR+1
IOPLMDF1 EQU   IOPLMLEP
IOPFLGS2 EQU   IOPLMDF1
IOPLMDF2 EQU   IOPLMLEP+1
IOPLMDF3 EQU   IOPLMLEP+2
IOPLMDF4 EQU   IOPLMLEP+3
IOPLMDF5 EQU   IOPLMDDR+5
IOPFLGS3 EQU   IOPLMDF5
IOPLMDFX EQU   IOPLMDNT+24
@NM00085 EQU   IOPLMDFX
IOPLNTRY EQU   IOPLMDFX+8
IOPLSYS  EQU   IOPLNTRY
IOPSYSLB EQU   IOPLSYS
IOPMACNT EQU   IOPUDATA
IOPMACDR EQU   IOPMACNT
IOPRMIDE EQU   IOPMACDR+1
IOPRMST  EQU   IOPRMIDE+7
IOPFMIDE EQU   IOPMACDR+9
IOPMACFX EQU   IOPMACNT+24
IOPBUNT  EQU   IOPMACFX
IOPMCEND EQU   IOPMACNT+104
IOPMACVR EQU   IOPMCEND
IOPMCENT EQU   IOPMACVR
IOPMCDTA EQU   IOPMCENT
IOPMCASM EQU   IOPMCDTA
IOPMACID EQU   IOPMCASM
IOPMACST EQU   IOPMCASM+7
IOPMCIND EQU   IOPMCENT+8
IOPEOFNT EQU   IOPUDATA
IOPSRCNT EQU   IOPUDATA
IOPSRCDR EQU   IOPSRCNT
@NM00096 EQU   IOPSRCDR+1
@NM00098 EQU   @NM00096+7
@NM00102 EQU   IOPSRCDR+9
IOPSRCFX EQU   IOPSRCNT+24
@NM00106 EQU   IOPSRCFX
IOPSREND EQU   IOPSRCNT+104
IOPSRCVR EQU   IOPSREND
IOPSNTRY EQU   IOPSRCVR
IOPSRDTA EQU   IOPSNTRY
IOPSRCID EQU   IOPSRDTA
IOPSRCST EQU   IOPSRDTA+7
IOPMODNT EQU   IOPUDATA
IOPMODDR EQU   IOPMODNT
@NM00112 EQU   IOPMODDR+1
@NM00114 EQU   @NM00112+7
@NM00118 EQU   IOPMODDR+9
IOPMODFX EQU   IOPMODNT+24
@NM00122 EQU   IOPMODFX
IOPMDLEP EQU   IOPMODFX+8
IOPMODF1 EQU   IOPMDLEP
IOPMODF2 EQU   IOPMDLEP+1
IOPMODF3 EQU   IOPMDLEP+2
IOPMODF4 EQU   IOPMDLEP+3
IOPMDEND EQU   IOPMODNT+104
IOPMODVR EQU   IOPMDEND
IOPMNTRY EQU   IOPMODVR
IOPMDDTA EQU   IOPMNTRY
IOPLMODS EQU   IOPMDDTA
IOPMODID EQU   IOPLMODS
IOPMODST EQU   IOPLMODS+7
IOPDLBNT EQU   IOPUDATA
IOPDLBDR EQU   IOPDLBNT
IOPDLBFX EQU   IOPDLBNT+24
@NM00133 EQU   IOPDLBFX
IOPDLEND EQU   IOPDLBNT+104
IOPDLBVR EQU   IOPDLEND
IOPDNTRY EQU   IOPDLBVR
IOPDSYS  EQU   IOPDNTRY
IOPSYSNT EQU   IOPUDATA
IOPSYSDR EQU   IOPSYSNT
IOPSYSF1 EQU   IOPSYSDR+4
IOPFLGS7 EQU   IOPSYSF1
IOPSYSFX EQU   IOPSYSNT+24
@NM00140 EQU   IOPSYSFX
IOPSYEND EQU   IOPSYSNT+184
IOPSYSVR EQU   IOPSYEND
IOPSYSTR EQU   IOPSYSVR
IOPSYNTR EQU   IOPSYSTR
IOPPTFNT EQU   IOPUDATA
IOPPTFDR EQU   IOPPTFNT
IOPPSTAT EQU   IOPPTFDR+2
IOPPTFF1 EQU   IOPPSTAT
IOPFLGS5 EQU   IOPPTFF1
IOPPTFF2 EQU   IOPPSTAT+1
IOPPTFF3 EQU   IOPPSTAT+3
IOPPTFFX EQU   IOPPTFNT+24
@NM00149 EQU   IOPPTFFX
@NM00150 EQU   @NM00149
IOPPDTES EQU   IOPPTFFX+41
@NM00153 EQU   IOPPDTES
IOPPTPFX EQU   IOPPDTES+6
IOPDATES EQU   IOPPTPFX
IOPPTEND EQU   IOPPTFNT+104
IOPPTFVR EQU   IOPPTEND
IOPPNTRY EQU   IOPPTFVR
IOPPMODS EQU   IOPPNTRY
IOPENTNT EQU   IOPUDATA+104
IOPSRLNT EQU   IOPUDATA+104
IOPPRENT EQU   IOPUDATA+104
IOPNPRNT EQU   IOPUDATA+104
IOPSUPNT EQU   IOPUDATA+104
IOPREQNT EQU   IOPUDATA+104
IOPIRQNT EQU   IOPUDATA+104
IOPFIDNT EQU   IOPUDATA+104
IOPDELNT EQU   IOPUDATA+104
IOPVERNT EQU   IOPUDATA+104
IOPSBYNT EQU   IOPUDATA+104
IOPQSMNT EQU   IOPUDATA
IOPQSMDR EQU   IOPQSMNT
IOPQFMNT EQU   IOPUDATA
IOPQFMDR EQU   IOPQFMNT
IOPQFEND EQU   IOPQFMNT+2
IOPQFMVR EQU   IOPQFEND
IOPQFMLS EQU   IOPQFMVR
IOPQFMNM EQU   IOPQFMLS
IOPQFMND EQU   IOPQFMNM
IOPQFMTP EQU   IOPQFMLS+8
IOPPTSYS EQU   IOPUDATA
IOPPTSDR EQU   IOPPTSYS
IOPPTSFX EQU   IOPPTSYS+24
IOPDSSPC EQU   IOPPTSFX
IOPPTFG1 EQU   IOPPTSFX+34
IOPPSEND EQU   IOPPTSYS+1064
IOPPTSVR EQU   IOPPSEND
IOPPTNTR EQU   IOPPTSVR
@NM00178 EQU   IOPPTNTR
IOPPTFMD EQU   @NM00178
IOPPTREL EQU   IOPPTFMD
IOPBPDS  EQU   IOPUDATA
IOPBLEP1 EQU   IOPBPDS+8
IOPBLEP2 EQU   IOPBPDS+9
@NM00182 EQU   IOPBPDS+18
IOPBFTB0 EQU   @NM00182
IOPBFTB1 EQU   IOPBFTB0
ICTENDIX EQU   ICTENDCH
ICTENDNT EQU   ICTENDCH
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
IOPBCEND EQU   IOPBPDS+21
IOPBFTB3 EQU   IOPBFTB0+2
IOPBFTB2 EQU   IOPBFTB0+1
@NM00184 EQU   IOPBFTB1
IOPBAPFP EQU   IOPBFTB1
IOPBSSI  EQU   IOPBFTB1
IOPBPAGA EQU   IOPBFTB1
@NM00183 EQU   IOPBFTB1
IOPBAOSL EQU   IOPBFTB1
IOPBSEPA EQU   IOPBPDS+15
IOPBFTBL EQU   IOPBPDS+13
IOPBSTOR EQU   IOPBPDS+10
IOPBREFR EQU   IOPBLEP2
IOPBLEF  EQU   IOPBLEP2
IOPBTEST EQU   IOPBLEP2
IOPBNE   EQU   IOPBLEP2
@NM00181 EQU   IOPBLEP2
IOPBDC   EQU   IOPBLEP2
@NM00180 EQU   IOPBLEP1
IOPBSCTR EQU   IOPBLEP1
IOPBOL   EQU   IOPBLEP1
@NM00179 EQU   IOPBLEP1
IOPBOVLY EQU   IOPBLEP1
IOPBREUS EQU   IOPBLEP1
IOPBRENT EQU   IOPBLEP1
IOPBNL   EQU   IOPBPDS+7
IOPBTTRN EQU   IOPBPDS+4
IOPBZERO EQU   IOPBPDS+3
IOPBTTRT EQU   IOPBPDS
IOPPTIND EQU   IOPPTNTR+8
IOPPTSND EQU   IOPPTREL
@NM00177 EQU   IOPPTSFX+872
IOPSYZPP EQU   IOPPTSFX+772
IOPSYZPR EQU   IOPPTSFX+771
IOPSYZPS EQU   IOPPTSFX+763
IOPSYZAP EQU   IOPPTSFX+755
IOPSYUPP EQU   IOPPTSFX+655
IOPSYUPR EQU   IOPPTSFX+654
IOPSYUPS EQU   IOPPTSFX+646
IOPSYUPD EQU   IOPPTSFX+638
IOPSYSPP EQU   IOPPTSFX+538
IOPSYSPR EQU   IOPPTSFX+537
IOPSYSPS EQU   IOPPTSFX+529
IOPSYSUP EQU   IOPPTSFX+521
IOPSYLKP EQU   IOPPTSFX+421
IOPSYLKR EQU   IOPPTSFX+420
IOPSYLKS EQU   IOPPTSFX+412
IOPSYLKD EQU   IOPPTSFX+404
IOPSYCPP EQU   IOPPTSFX+304
IOPSYCPR EQU   IOPPTSFX+303
IOPSYCPS EQU   IOPPTSFX+295
IOPSYCPY EQU   IOPPTSFX+287
IOPSYCOP EQU   IOPPTSFX+187
IOPSYCOR EQU   IOPPTSFX+186
IOPSYCOS EQU   IOPPTSFX+178
IOPSYCOM EQU   IOPPTSFX+170
IOPSYASP EQU   IOPPTSFX+70
IOPSYASR EQU   IOPPTSFX+69
IOPSYASS EQU   IOPPTSFX+61
IOPSYASM EQU   IOPPTSFX+53
@NM00176 EQU   IOPPTSFX+35
@NM00175 EQU   IOPPTFG1
IOPPTSNJ EQU   IOPPTFG1
IOPPTSNP EQU   IOPPTFG1
IOPSYPLN EQU   IOPPTSFX+32
IOPDSPFX EQU   IOPPTSFX+6
IOPDSDIR EQU   IOPDSSPC+4
IOPDSSEC EQU   IOPDSSPC+2
IOPDSPRM EQU   IOPDSSPC
@NM00174 EQU   IOPPTSDR+4
IOPPTPEM EQU   IOPPTSDR+2
IOPPCNVL EQU   IOPPTSDR+1
@NM00173 EQU   IOPPTSDR
@NM00172 EQU   IOPQFMLS+7
@NM00171 EQU   IOPQFMDR
@NM00167 EQU   IOPQSMDR
@NM00166 EQU   IOPSBYNT+8
IOPSBYST EQU   IOPSBYNT+7
IOPSBYNM EQU   IOPSBYNT
@NM00165 EQU   IOPVERNT+8
IOPVERST EQU   IOPVERNT+7
IOPVERNM EQU   IOPVERNT
@NM00164 EQU   IOPDELNT+8
IOPDELST EQU   IOPDELNT+7
IOPDELNM EQU   IOPDELNT
@NM00163 EQU   IOPFIDNT+8
IOPFIDST EQU   IOPFIDNT+7
IOPFIDNM EQU   IOPFIDNT
@NM00162 EQU   IOPIRQNT+8
IOPIRQST EQU   IOPIRQNT+7
IOPIRQNM EQU   IOPIRQNT
@NM00161 EQU   IOPREQNT+8
IOPREQST EQU   IOPREQNT+7
IOPREQNM EQU   IOPREQNT
@NM00160 EQU   IOPSUPNT+8
IOPSUPST EQU   IOPSUPNT+7
IOPSUPNM EQU   IOPSUPNT
@NM00159 EQU   IOPNPRNT+8
IOPNPRST EQU   IOPNPRNT+7
IOPNPRNM EQU   IOPNPRNT
@NM00158 EQU   IOPPRENT+8
IOPPREST EQU   IOPPRENT+7
IOPPRENM EQU   IOPPRENT
@NM00157 EQU   IOPSRLNT+8
IOPSRLST EQU   IOPSRLNT+7
@NM00156 EQU   IOPSRLNT+4
IOPSRLNM EQU   IOPSRLNT
@NM00155 EQU   IOPENTNT+8
IOPENTST EQU   IOPENTNT+7
IOPENTNM EQU   IOPENTNT
IOPPIND  EQU   IOPPNTRY+8
IOPPTFND EQU   IOPPMODS
IOPPFMID EQU   IOPPTFFX+73
@NM00154 EQU   IOPPTPFX+24
IOPUCLT  EQU   IOPDATES+21
IOPUCLD  EQU   IOPDATES+18
IOPACCT  EQU   IOPDATES+15
IOPACCD  EQU   IOPDATES+12
IOPRSTT  EQU   IOPDATES+9
IOPRSTD  EQU   IOPDATES+6
IOPAPPT  EQU   IOPDATES+3
IOPAPPD  EQU   IOPDATES
IOPRECT  EQU   @NM00153+3
IOPRECD  EQU   @NM00153
@NM00152 EQU   IOPPTFFX+8
@NM00151 EQU   @NM00149+7
IOPPRELN EQU   @NM00150
@NM00148 EQU   IOPPTFDR+20
IOPSBYNO EQU   IOPPTFDR+13
IOPDBYNO EQU   IOPPTFDR+6
@NM00147 EQU   IOPPTFF3
IOPFLF   EQU   IOPPTFF3
IOPDBYP  EQU   IOPPTFF3
IOPSBYP  EQU   IOPPTFF3
IOPPMDLP EQU   IOPPTFF2+1
IOPPADDP EQU   IOPPTFF2+1
@NM00146 EQU   IOPPTFF2+1
IOPLRFP  EQU   IOPPTFF2
IOPJCLP  EQU   IOPPTFF2
IOPSUPP  EQU   IOPPTFF2
IOPREQP  EQU   IOPPTFF2
IOPPREP  EQU   IOPPTFF2
IOPNPRP  EQU   IOPPTFF2
IOPIRQP  EQU   IOPPTFF2
IOPDELP  EQU   IOPPTFF2
IOPREGEN EQU   IOPFLGS5
IOPBYP   EQU   IOPFLGS5
IOPDUMMP EQU   IOPFLGS5
@NM00145 EQU   IOPFLGS5
IOPERROR EQU   IOPFLGS5
IOPACC   EQU   IOPFLGS5
IOPRES   EQU   IOPFLGS5
IOPAPP   EQU   IOPFLGS5
IOPPTYPE EQU   IOPPTFDR+1
@NM00144 EQU   IOPPTFDR
IOPSYSTP EQU   IOPSYSTR+8
IOPSYSND EQU   IOPSYNTR
@NM00143 EQU   IOPSYSFX+21
IOPSYSID EQU   IOPSYSFX+13
IOPNUCID EQU   IOPSYSFX+12
IOPSREL  EQU   IOPSYSFX+8
@NM00142 EQU   @NM00140+7
@NM00141 EQU   @NM00140
@NM00139 EQU   IOPSYSDR+5
@NM00138 EQU   IOPFLGS7
IOPSYNG  EQU   IOPFLGS7
IOPSYDL  EQU   IOPFLGS7
IOPSTSNP EQU   IOPFLGS7
IOPMTSNP EQU   IOPFLGS7
IOPPEMAX EQU   IOPSYSDR+2
IOPSCNVL EQU   IOPSYSDR+1
@NM00137 EQU   IOPSYSDR
IOPDLIND EQU   IOPDNTRY+8
IOPDLBND EQU   IOPDSYS
@NM00136 EQU   IOPDLBFX+8
@NM00135 EQU   @NM00133+7
@NM00134 EQU   @NM00133
@NM00132 EQU   IOPDLBDR+1
@NM00131 EQU   IOPDLBDR
IOPMDIND EQU   IOPMNTRY+8
@NM00130 EQU   IOPMODST
IOPMODND EQU   IOPMODID
IOPDLIB  EQU   IOPMODFX+72
@NM00129 EQU   IOPMODFX+12
@NM00128 EQU   IOPMODF4
@NM00127 EQU   IOPMODF3
@NM00126 EQU   IOPMODF2
IOPMPAGA EQU   IOPMODF2
IOPMNE   EQU   IOPMODF2
@NM00125 EQU   IOPMODF1
IOPMDC   EQU   IOPMODF1
IOPMREFR EQU   IOPMODF1
IOPMOVLY EQU   IOPMODF1
IOPMSCTR EQU   IOPMODF1
IOPMREUS EQU   IOPMODF1
IOPMRENT EQU   IOPMODF1
IOPMAPF  EQU   IOPMODF1
@NM00124 EQU   @NM00122+7
@NM00123 EQU   @NM00122
@NM00121 EQU   IOPMODDR+17
@NM00120 EQU   @NM00118+7
@NM00119 EQU   @NM00118
@NM00117 EQU   @NM00114
@NM00116 EQU   @NM00114
@NM00115 EQU   @NM00114
@NM00113 EQU   @NM00112
@NM00111 EQU   IOPMODDR
IOPSRIND EQU   IOPSNTRY+8
@NM00110 EQU   IOPSRCST
IOPSRCND EQU   IOPSRCID
IOPSRDLB EQU   IOPSRCFX+72
IOPSRSYS EQU   IOPSRCFX+64
@NM00109 EQU   IOPSRCFX+8
@NM00108 EQU   @NM00106+7
@NM00107 EQU   @NM00106
@NM00105 EQU   IOPSRCDR+18
IOPSRLNG EQU   IOPSRCDR+17
@NM00104 EQU   @NM00102+7
@NM00103 EQU   @NM00102
@NM00101 EQU   @NM00098
@NM00100 EQU   @NM00098
@NM00099 EQU   @NM00098
@NM00097 EQU   @NM00096
@NM00095 EQU   IOPSRCDR
IOPEOFND EQU   IOPEOFNT
IOPMCTYP EQU   IOPMCIND
@NM00094 EQU   IOPMACST
IOPMACND EQU   IOPMACID
IOPMCDLB EQU   IOPMACFX+72
IOPMCSYS EQU   IOPMACFX+64
@NM00093 EQU   IOPMACFX+8
IOPBUTYP EQU   IOPBUNT+7
IOPBUSMD EQU   IOPBUNT
@NM00092 EQU   IOPMACDR+18
IOPMCLNG EQU   IOPMACDR+17
IOPFMST  EQU   IOPFMIDE+7
IOPFMID  EQU   IOPFMIDE
@NM00091 EQU   IOPRMST
IOPRMASM EQU   IOPRMST
@NM00090 EQU   IOPRMST
IOPRMID  EQU   IOPRMIDE
@NM00089 EQU   IOPMACDR
IOPLMIND EQU   IOPLNTRY+8
IOPLMDND EQU   IOPSYSLB
@NM00087 EQU   @NM00085+7
@NM00086 EQU   @NM00085
@NM00084 EQU   IOPLMDDR+6
@NM00083 EQU   IOPFLGS3
IOPCHREP EQU   IOPFLGS3
IOPLINK  EQU   IOPFLGS3
IOPCOPY  EQU   IOPFLGS3
@NM00082 EQU   IOPLMDF4
@NM00081 EQU   IOPLMDF3
@NM00080 EQU   IOPLMDF2
IOPPAGA  EQU   IOPLMDF2
IOPNE    EQU   IOPLMDF2
@NM00079 EQU   IOPFLGS2
IOPDC    EQU   IOPFLGS2
IOPREFR  EQU   IOPFLGS2
IOPOVLY  EQU   IOPFLGS2
IOPSCTR  EQU   IOPFLGS2
IOPREUS  EQU   IOPFLGS2
IOPRENT  EQU   IOPFLGS2
IOPAPF   EQU   IOPFLGS2
@NM00078 EQU   IOPLMDDR
@NM00077 EQU   IOPASMDR+9
IOPABUTP EQU   IOPABUNT+7
IOPABUPT EQU   IOPABUNT
IOPNTLVL EQU   IOPASMDR
IOPALLOC EQU   @NM00076+4
IOPUSED  EQU   @NM00076
IOPTPSEQ EQU   @NM00075+8
IOPVLSER EQU   @NM00075+2
IOPBLKSI EQU   @NM00075
IOPCQMAX EQU   IOPCQMAP+12
@NM00074 EQU   IOPCQMAP+11
@NM00073 EQU   IOPCQMAP+8
@NM00072 EQU   IOPCQMAP
IOPPTMAX EQU   IOPCDMAX
@NM00071 EQU   IOPSCMAP+11
@NM00070 EQU   IOPSCMAP+8
@NM00069 EQU   IOPSCMAP
IOPDIRMX EQU   IOPNTMAX+12
@NM00068 EQU   IOPNTMAX+11
@NM00067 EQU   IOPNTMAX+8
@NM00066 EQU   IOPNTMAX
@NM00065 EQU   IOPDTYPE
IOPDMOD  EQU   IOPDTYPE
IOPDJCL  EQU   IOPDTYPE
IOPDSRC  EQU   IOPDTYPE
IOPDMAC  EQU   IOPDTYPE
IOPSDIR  EQU   IOPSPACE+4
IOPSSCND EQU   IOPSPACE+2
IOPSPRIM EQU   IOPSPACE
IOPDSN   EQU   IOPDYNDT
IOPNTYPE EQU   IOPSTCMP+17
IOPNNAME EQU   IOPSTCMP+9
IOPOTYPE EQU   IOPSTCMP+8
IOPONAME EQU   IOPSTCMP
IOPISEQ3 EQU   IOPINAM3+6
IOPITYP3 EQU   @NM00064+5
IOPIPTF3 EQU   @NM00064
TBLXEND0 EQU   TBLXPARM+124
@NM00007 EQU   TBLXPARM+108
TBLXIOP3 EQU   TBLXPARM+104
TBLXD2GT EQU   TBLXPARM+100
TBLXDLGT EQU   TBLXPARM+96
@NM00006 EQU   TBLXRC+3
TBLXIRC  EQU   TBLXRC+2
TBLXLRC  EQU   TBLXRC+1
TBLXTRC  EQU   TBLXRC
TBLXIBGN EQU   TBLXPARM+88
@NM00005 EQU   TBLXPARM+83
@NM00004 EQU   TBLXPARM+82
@NM00003 EQU   TBLXPARM+81
@NM00002 EQU   TBLXFLG1
TBLXTCRC EQU   TBLXFLG1
TBLXFUND EQU   TBLXPARM+72
TBLXFUNC EQU   TBLXPARM+64
@NM00001 EQU   TBLXPARM+62
TBLXCDSI EQU   TBLXPARM+60
TBLXLMGT EQU   TBLXPARM+56
TBLXSCGT EQU   TBLXPARM+52
TBLXSREL EQU   TBLXPARM+48
TBLXASGT EQU   TBLXPARM+44
TBLXTOP  EQU   TBLXPARM+32
TBLXSEGT EQU   TBLXPARM+24
TBLXIOPF EQU   TBLXPARM+20
TBLXIOP2 EQU   TBLXPARM+16
TBLXEND  EQU   TBLXINDX+8
TBLXSTRT EQU   TBLXINDX+4
TBLXCUR  EQU   TBLXINDX
TBLXHDR  EQU   TBLXPARM
FMID#    EQU   SYSMFMID+8
SYSMODT  EQU   SYSMFMID+7
SYSMOD#  EQU   SYSMFMKY
TSLRRTNP EQU   TSLRELM+12
TSLRAPTR EQU   TSLRELM+8
@NM00233 EQU   TSLRELM+7
TSLRSMD  EQU   TSLRELM
TSLMSMD  EQU   TSLMFUNC+1
TSLMTYPE EQU   TSLMFUNC
TSLEFNDP EQU   TSLENTSR+12
TSLEBGNP EQU   TSLENTSR+8
TSLENMEP EQU   TSLENTSR+4
@NM00232 EQU   TSLENTSR+3
@NM00231 EQU   TSLEOPTF
TSLEONXT EQU   TSLEOPTF
TSLEVER# EQU   TSLENTSR+1
TSLETYPE EQU   TSLENTSR
@NM00230 EQU   TSLSICDS+19
TSLSDUM  EQU   TSLSCDSF
@NM00229 EQU   TSLSCDSF
@NM00228 EQU   TSLSCDSF
TSLSCDEL EQU   TSLSCDSF
@NM00227 EQU   TSLSICDS+17
TSLSISLS EQU   TSLSICTF
TSLSINOG EQU   TSLSICTF
TSLSIDLI EQU   TSLSICTF
TSLSIDLE EQU   TSLSICTF
TSLSIDEL EQU   TSLSICTF
TSLSIFND EQU   TSLSICTF
TSLSIOPP EQU   TSLSICDS+12
TSLSICTP EQU   TSLSICDS+8
@NM00226 EQU   TSLSOPTF
TSLSOXTD EQU   TSLSOPTF
TSLSOMSG EQU   TSLSOPTF
TSLSOALL EQU   TSLSOPTF
TSLGDSID EQU   TSLGET+12
TSLGIOPP EQU   TSLGET+8
@NM00225 EQU   TSLGOPTF
TSLGOXTD EQU   TSLGOPTF
TSLGOMSG EQU   TSLGOPTF
@NM00224 EQU   TSLGOPTF
@NM00223 EQU   TSLGOPTF
@NM00222 EQU   TSLGOPTF
TSLGSMD  EQU   TSLGET
TSLLRTNP EQU   TSLLSTSR+12
TSLLOFST EQU   TSLLSTSR+8
@NM00221 EQU   TSLLOPTF
TSLLONXT EQU   TSLLOPTF
TSLLSMD  EQU   TSLLSTSR
@NM00220 EQU   TSLICTSR+13
@NM00219 EQU   TSLICTF
TSLINOG  EQU   TSLICTF
TSLIDLI  EQU   TSLICTF
TSLIDLE  EQU   TSLICTF
TSLIDEL  EQU   TSLICTF
TSLISUP  EQU   TSLICTF
TSLIFND  EQU   TSLICTF
TSLICTP  EQU   TSLICTSR+8
@NM00218 EQU   TSLIOPTF
TSLIONXT EQU   TSLIOPTF
@NM00217 EQU   HMASMGTP+27
GTPPSIZE EQU   GTPFLGS1
@NM00216 EQU   GTPFLGS1
GTPRCDNF EQU   GTPFLGS1
GTPNOSPM EQU   GTPFLGS1
GTPPOS   EQU   GTPRESTR+8
GTPRCD   EQU   GTPRESTR+4
GTPPAG   EQU   GTPRESTR
GTPWKAD  EQU   HMASMGTP+8
GTPKEYLN EQU   HMASMGTP+6
GTPRCDLN EQU   HMASMGTP+4
@NM00215 EQU   HMASMGTP+2
@NM00212 EQU   ICTSBYNT+7
ICTSBYND EQU   ICTSBYNM
ICTDELEX EQU   ICTDELST
ICTDELND EQU   ICTDELNM
@NM00211 EQU   ICTVRSNT+7
ICTVRSND EQU   ICTVRSNM
@NM00210 EQU   ICTNPRNT+7
ICTNPRND EQU   ICTNPRNM
@NM00209 EQU   ICTCSRST
@NM00208 EQU   ICTCSRST
ICTCSRF  EQU   ICTCSRST
@NM00207 EQU   ICTCSRST
ICTCSRNM EQU   ICTIRQNT+8
@NM00206 EQU   ICTIRQST
ICTIREQT EQU   ICTIRQST
ICTIREQI EQU   ICTIRQST
ICTIREQB EQU   ICTIRQST
ICTIREQS EQU   ICTIRQST
@NM00205 EQU   ICTIRQST
ICTIRQND EQU   ICTIRQNM
@NM00204 EQU   ICTPREST
ICTPREQT EQU   ICTPREST
ICTPREQI EQU   ICTPREST
ICTPREQB EQU   ICTPREST
ICTPREQS EQU   ICTPREST
@NM00203 EQU   ICTPREST
ICTPREND EQU   ICTPRENM
@NM00202 EQU   ICTSUPNT+7
ICTSUPND EQU   ICTSUPNM
@NM00201 EQU   ICTREQST
ICTRREQT EQU   ICTREQST
ICTRREQI EQU   ICTREQST
ICTRREQB EQU   ICTREQST
ICTRREQS EQU   ICTREQST
@NM00200 EQU   ICTREQST
ICTREQND EQU   ICTREQNM
@NM00199 EQU   ICTENTST
ICTEREQT EQU   ICTENTST
ICTEREQI EQU   ICTENTST
ICTEREQB EQU   ICTENTST
ICTEREQS EQU   ICTENTST
@NM00198 EQU   ICTENTST
ICTENTND EQU   ICTENTNM
ICTIXP   EQU   ICTIXPF
@NM00197 EQU   ICTPTF+100
ICTPTPFX EQU   ICTPTF+38
ICTPRELN EQU   ICTPTF+36
ICTPRECT EQU   ICTPTF+33
ICTPRECD EQU   ICTPTF+30
ICTPVERN EQU   ICTPTF+29
ICTPFMID EQU   ICTPTF+22
ICTPSUPN EQU   ICTPTF+20
ICTPONUM EQU   ICTPTF+18
ICTPUSR8 EQU   ICTPFLGA
ICTPUSR7 EQU   ICTPFLGA
ICTPUSR6 EQU   ICTPFLGA
ICTPUSR5 EQU   ICTPFLGA
ICTPUSR4 EQU   ICTPFLGA
ICTPUSR3 EQU   ICTPFLGA
ICTPUSR2 EQU   ICTPFLGA
ICTPPASS EQU   ICTPUSR1
@NM00196 EQU   @NM00195
ICTPRQBY EQU   @NM00195
ICTPRQOK EQU   @NM00195
ICTPRQCK EQU   @NM00195
@NM00194 EQU   ICTPFLG9
ICTPPDEL EQU   ICTPFLG9
ICTPWRKO EQU   ICTPFLG9
ICTPMSL  EQU   ICTPFLG9
@NM00193 EQU   ICTPFLG8
ICTPDCPL EQU   ICTPFLG8
ICTPECPL EQU   ICTPFLG8
ICTPGCPL EQU   ICTPFLG8
@NM00192 EQU   ICTPFLG4
@NM00191 EQU   ICTPFLG4
@NM00190 EQU   ICTPFLG4
ICTPGELM EQU   ICTPFLG4
ICTPDIMP EQU   ICTPFLG4
ICTPDEXP EQU   ICTPFLG4
ICTPREDO EQU   ICTPFLG4
ICTPCDSE EQU   ICTPFLG4
@NM00189 EQU   ICTPFLG2
ICTPRCND EQU   ICTPFLG2
ICTPTPS  EQU   ICTPFLG2
ICTPTR1  EQU   ICTPFLG2
ICTPVRSP EQU   ICTPFLG2
@NM00188 EQU   ICTPFLG6
ICTFLF   EQU   ICTPFLF
ICTPDBYP EQU   ICTPFLG6
ICTPSBYP EQU   ICTPFLG6
ICTPMDLP EQU   ICTPFLG5+1
ICTPADDP EQU   ICTPFLG5+1
@NM00187 EQU   ICTPFLG5+1
ICTPLRFP EQU   ICTPFLG5
ICTPJCLP EQU   ICTPFLG5
ICTPSUPP EQU   ICTPFLG5
ICTPREQP EQU   ICTPFLG5
ICTPPREP EQU   ICTPFLG5
ICTPNPRP EQU   ICTPFLG5
ICTPIRQP EQU   ICTPFLG5
ICTPDELP EQU   ICTPFLG5
@NM00186 EQU   ICTPFLG3
ICTPSLST EQU   ICTPFLG3
ICTPNOLB EQU   ICTPFLG3
ICTPVERJ EQU   ICTPFLG3
ICTPMSG  EQU   ICTPFLG3
ICTPCPL  EQU   ICTPFLG3
ICTPNOGO EQU   ICTPFLG3
ICTPROCS EQU   ICTPPROC
ICTREGEN EQU   ICTPFLG1
ICTBYP   EQU   ICTPFLG1
ICTDUMMP EQU   ICTPFLG1
@NM00185 EQU   ICTPFLG1
ICTERROR EQU   ICTPFLG1
ICTACC   EQU   ICTPFLG1
ICTRES   EQU   ICTPFLG1
ICTAPP   EQU   ICTPFLG1
ICTPEND  EQU   ICTPTFS
IOPBS04E EQU   IOPBS04+2
IOPBAPFC EQU   IOPBAPF+1
IOPBAPFL EQU   IOPBAPF
IOPBS2NM EQU   IOPBS02+3
IOPBS2EP EQU   IOPBS02
IOPQSMTP EQU   IOPQSMLS+8
@NM00170 EQU   IOPQSMLS+7
@NM00169 EQU   @NM00168+7
@NM00088 EQU   IOPLMCTL+17
IOPLMCRD EQU   IOPLMCTL+9
IOPLMCRN EQU   IOPLMCTL+1
IOPLMCC  EQU   IOPLMCTL
@NM00063 EQU   IOPUSERL
@NM00062 EQU   IOPUSERL
IOPALIS  EQU   IOPUSERL
IOPTTR   EQU   IOPDRMAP+8
IOPINAM2 EQU   IOPINAM+1
IOPITYP2 EQU   IOPITYP
@NM00061 EQU   HMASMIOP+32
IOPDELDD EQU   IOPDDNAM
@NM00060 EQU   @NM00057+10
IOPSEQNO EQU   @NM00057+8
@NM00059 EQU   @NM00058+7
IOPPTFNM EQU   @NM00058
CCABMREC EQU   CCABELMT+10
CCABPOS  EQU   CCABMPOS+8
CCABNAME EQU   CCABMPOS
@NM00056 EQU   CCABLDLM+2
@NM00055 EQU   CCABLDLM
CCAUPDPM EQU   @NM00053+24
@NM00054 EQU   @NM00053+21
CCARUPDT EQU   CCAUPDRC
CCAUPDSP EQU   @NM00053+12
CCAUPDTE EQU   @NM00053+8
CCAUPDNM EQU   @NM00053
CCASUPPM EQU   @NM00051+24
@NM00052 EQU   @NM00051+21
CCARSUP  EQU   CCASUPRC
CCASUPSP EQU   @NM00051+12
CCAIOSUP EQU   @NM00051+8
CCASUPNM EQU   @NM00051
CCAZAPPM EQU   @NM00049+24
@NM00050 EQU   @NM00049+21
CCARZAP  EQU   CCAZAPRC
CCAZAPSP EQU   @NM00049+12
CCASPZAP EQU   @NM00049+8
CCAZAPNM EQU   @NM00049
CCACOMPM EQU   @NM00047+24
@NM00048 EQU   @NM00047+21
CCARCOMP EQU   CCACOMRC
CCACOMSP EQU   @NM00047+12
CCACOMRS EQU   @NM00047+8
CCACOMNM EQU   @NM00047
CCACPYPM EQU   @NM00045+24
@NM00046 EQU   @NM00045+21
CCARCOPY EQU   CCACPYRC
CCACPYSP EQU   @NM00045+12
CCACOPY  EQU   @NM00045+8
CCACPYNM EQU   @NM00045
CCAASMPM EQU   @NM00043+24
@NM00044 EQU   @NM00043+21
CCARASM  EQU   CCAASMRC
CCAASMSP EQU   @NM00043+12
CCAASM   EQU   @NM00043+8
CCAASMNM EQU   @NM00043
CCALKDPM EQU   @NM00041+24
@NM00042 EQU   @NM00041+21
CCARLINK EQU   CCALKDRC
CCALKDSP EQU   @NM00041+12
CCALKED  EQU   @NM00041+8
CCALKDNM EQU   @NM00041
CCAPGMPM EQU   @NM00039+24
@NM00040 EQU   @NM00039+21
CCABPGRC EQU   @NM00039+20
CCABPGSP EQU   @NM00039+12
CCABPGAD EQU   @NM00039+8
CCABPGNM EQU   @NM00039
CCAEND   EQU   HMASMCCA+371
@NM00038 EQU   HMASMCCA+309
CCACURDD EQU   CCAFDSNG+3
CCACURDS EQU   CCAFDSNG+2
@NM00037 EQU   CCAFLAGB
CCAOUTNG EQU   CCAFLAGB
CCALOGNG EQU   CCAFLAGB
CCAFMID  EQU   HMASMCCA+291
CCALSTDS EQU   CCAFCTL+8
CCARPTDS EQU   CCAFCTL+7
CCATIME  EQU   CCAFCTL+4
CCADATE  EQU   CCAFCTL+1
@NM00036 EQU   CCAFLAG9
CCARVCAN EQU   CCAFLAG9
CCARVEST EQU   CCAFLAG9
CCAPTSNJ EQU   CCAFLAG9
CCASTSNP EQU   CCAFLAG9
CCAMTSNP EQU   CCAFLAG9
CCAPTSNP EQU   CCAFLAG9
@NM00035 EQU   CCAFLAG8
CCAACDSC EQU   CCAFLAG8
CCACDSC  EQU   CCAFLAG8
@NM00034 EQU   CCAFLAG6
CCAACRUP EQU   CCAFLAG6
CCACRQUP EQU   CCAFLAG6
CCAACDUP EQU   CCAFLAG6
CCACDSUP EQU   CCAFLAG6
@NM00033 EQU   CCAFLAG5
CCAACROS EQU   CCAFLAG5
CCACRQOS EQU   CCAFLAG5
CCAACDOS EQU   CCAFLAG5
CCACDSOS EQU   CCAFLAG5
@NM00032 EQU   CCAFLAG4
CCAACRIS EQU   CCAFLAG4
CCACRQIS EQU   CCAFLAG4
CCAACDIS EQU   CCAFLAG4
CCACDSIS EQU   CCAFLAG4
@NM00031 EQU   CCAFLAG3+1
CCARGNP  EQU   CCAFLAG3+1
CCADISRQ EQU   CCAFLAG3+1
CCAICTOK EQU   CCAFLAG3
CCADELP  EQU   CCAFLAG3
CCACMPRS EQU   CCAFLAG3
CCAZAPP  EQU   CCAFLAG3
CCALINKP EQU   CCAFLAG3
CCACOPYP EQU   CCAFLAG3
CCAASIP  EQU   CCAFLAG3
CCAUPDP  EQU   CCAFLAG3
CCAEOSMP EQU   CCAFLAG2
CCAEOFNC EQU   CCAFLAG2
@NM00030 EQU   CCAFLAG2
CCACHECK EQU   CCAFLAG2
CCATERM  EQU   CCAFLAG2
CCASVCLB EQU   CCAFLAG2
CCANCPTF EQU   CCAFLAG2
@NM00029 EQU   CCAFLAG1+1
CCAUNL   EQU   CCAFLAG1+1
CCARESET EQU   CCAFLAG1+1
CCALOG   EQU   CCAFLAG1+1
CCACNV   EQU   CCAFLAG1+1
CCALIST  EQU   CCAFLAG1
CCAUPDU  EQU   CCAFLAG1
CCAUPDJ  EQU   CCAFLAG1
CCARES   EQU   CCAFLAG1
CCAREJ   EQU   CCAFLAG1
CCAACCPT EQU   CCAFLAG1
CCAAPPLY EQU   CCAFLAG1
CCAREC   EQU   CCAFLAG1
CCAFUNCT EQU   CCAFFUNC
@NM00028 EQU   @NM00023+18
@NM00027 EQU   @NM00023+16
CCATBLPA EQU   @NM00023+12
@NM00026 EQU   @NM00023+8
@NM00025 EQU   @NM00023+4
@NM00024 EQU   @NM00023
CCAIFGTP EQU   CCAFGTP+16
CCAGTP3  EQU   CCAFGTP+12
CCAGTP2  EQU   CCAFGTP+8
CCAGTP1  EQU   CCAFGTP+4
CCASETAD EQU   CCASEGTP
CCACLST  EQU   CCAFPGM+12
CCASPDCB EQU   CCAFPGM+8
CCAICLMD EQU   CCAFICT+12
CCAICMOD EQU   CCAFICT+8
CCAICPTF EQU   CCAFICT+4
CCAICT   EQU   CCAFICT
CCARVAD  EQU   CCAFSTA
CCAACDID EQU   CCAFSYS+32
CCACDSID EQU   CCAFSYS+24
CCALNLEN EQU   CCAFSYS+22
@NM00022 EQU   CCAFLAGA
CCAPSYSF EQU   CCAFLAGA
CCAASYSF EQU   CCAFLAGA
CCACSYSF EQU   CCAFLAGA
CCANUCID EQU   CCAFSYS+20
CCAASREL EQU   CCAFSYS+16
CCACSREL EQU   CCASREL
CCAPEMAX EQU   CCAFSYS+10
CCAPGLEN EQU   CCAFSYS+8
CCAIOPAS EQU   CCAFSYS+4
CCAIOPCS EQU   CCAFSYS
CCAPESIZ EQU   CCAFIOP+4
CCAIOPTR EQU   CCAFIOP
@NM00021 EQU   CCAFLAG7+3
CCALOGP  EQU   CCAFLAG7+2
CCAOUTP  EQU   CCAFLAG7+2
CCASLBP  EQU   CCAFLAG7+2
CCARPTP  EQU   CCAFLAG7+2
CCALISTP EQU   CCAFLAG7+2
CCAJCLP  EQU   CCAFLAG7+2
CCAPTFP  EQU   CCAFLAG7+2
CCATLBP  EQU   CCAFLAG7+2
CCAUT3P  EQU   CCAFLAG7+1
CCAUT2P  EQU   CCAFLAG7+1
CCAUT1P  EQU   CCAFLAG7+1
CCAWK5P  EQU   CCAFLAG7+1
CCAWK4P  EQU   CCAFLAG7+1
CCAWK3P  EQU   CCAFLAG7+1
CCAWK2P  EQU   CCAFLAG7+1
CCAWK1P  EQU   CCAFLAG7+1
CCAACRQP EQU   CCAFLAG7
CCACRQP  EQU   CCAFLAG7
CCASTSP  EQU   CCAFLAG7
CCAMTSP  EQU   CCAFLAG7
CCAPTSP  EQU   CCAFLAG7
CCASCDSP EQU   CCAFLAG7
CCAACDSP EQU   CCAFLAG7
CCACDSP  EQU   CCAFLAG7
@NM00020 EQU   CCAFBUFR+122
@NM00019 EQU   CCAFBUFR+120
@NM00018 EQU   CCAFBUFR+118
CCATBFMX EQU   CCAFBUFR+116
CCA4BFMX EQU   CCAFBUFR+114
CCA3BFMX EQU   CCAFBUFR+112
CCA2BFMX EQU   CCAFBUFR+110
CCA1BFMX EQU   CCAFBUFR+108
CCAXBFMX EQU   CCAFBUFR+106
CCAQBFMX EQU   CCAFBUFR+104
CCASBFMX EQU   CCAFBUFR+102
CCAMBFMX EQU   CCAFBUFR+100
CCAPBFMX EQU   CCAFBUFR+98
CCAVBFMX EQU   CCAFBUFR+96
CCAABFMX EQU   CCAFBUFR+94
CCACBFMX EQU   CCAFBUFR+92
@NM00017 EQU   CCAFBUFR+88
@NM00016 EQU   CCAFBUFR+84
CCA4BFSZ EQU   CCAFBUFR+80
CCATBFSZ EQU   CCAFBUFR+76
CCAWBFSZ EQU   CCAFBUFR+72
CCAQBFSZ EQU   CCAFBUFR+68
CCAPBFSZ EQU   CCAFBUFR+64
CCAVBFSZ EQU   CCAFBUFR+60
CCACBFSZ EQU   CCAFBUFR+56
@NM00015 EQU   CCAFBUFR+52
CCA4BFOA EQU   CCAFBUFR+48
CCA4BFIA EQU   CCAFBUFR+44
CCATBFIA EQU   CCAFBUFR+40
CCAWBFOA EQU   CCAFBUFR+36
CCAWBFIA EQU   CCAFBUFR+32
CCAQBFOA EQU   CCAFBUFR+28
CCAQBFIA EQU   CCAFBUFR+24
CCAPBFOA EQU   CCAFBUFR+20
CCAPBFIA EQU   CCAFBUFR+16
CCAVBFOA EQU   CCAFBUFR+12
CCAVBFIA EQU   CCAFBUFR+8
CCACBFOA EQU   CCAFBUFR+4
CCACBFIA EQU   CCAFBUFR
CCAID    EQU   HMASMCCA
@NM00014 EQU   TBLFLG5
TBLICTOK EQU   TBLFLG5
@NM00013 EQU   TBLFLG4
TBLBPFM  EQU   TBLFLG4
@NM00012 EQU   TBLFLG4
TBLBPIRQ EQU   TBLFLG4
TBLBPREQ EQU   TBLFLG4
TBLBPPRE EQU   TBLFLG4
TBLBPID  EQU   TBLFLG4
@NM00011 EQU   TBLFLG3+1
TBLSTS   EQU   TBLFLG3
TBLMTS   EQU   TBLFLG3
TBLPTS   EQU   TBLFLG3
TBLACRQ  EQU   TBLFLG3
TBLCRQ   EQU   TBLFLG3
TBLSCDS  EQU   TBLFLG3
TBLACDS  EQU   TBLFLG3
TBLCDS   EQU   TBLFLG3
TBLMASS  EQU   TBLFLG2
@NM00010 EQU   TBLFLG2
TBLFMID  EQU   TBLFLG2
TBLGROUP EQU   TBLFLG2
TBLEXC   EQU   TBLFLG2
TBLSEL   EQU   TBLFLG2
@NM00009 EQU   TBLFLG1+1
TBLDISW  EQU   TBLFLG1+1
TBLDISR  EQU   TBLFLG1+1
TBLDISN  EQU   TBLFLG1+1
TBLNOJCL EQU   TBLFLG1
TBLFLUSH EQU   TBLFLG1
TBLUSER  EQU   TBLFLG1
TBLAPAR  EQU   TBLFLG1
TBLCOMP  EQU   TBLFLG1
TBLASSEM EQU   TBLFLG1
TBLCHECK EQU   TBLFLG1
TBLNOAPP EQU   TBLFLG1
@NM00008 EQU   TBLXOPTS+5
TBLNUCID EQU   TBLXOPTS+4
TBLJCLGT EQU   TBLXOPTS
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@RC00351 EQU   @RC00350
@RC00417 EQU   @RC00415
@ENDDATA EQU   *
         END   HMASMTP2,(C'PLS2214',0802,78334)

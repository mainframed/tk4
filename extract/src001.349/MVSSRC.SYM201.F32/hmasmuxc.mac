         TITLE 'HMASMUXC - SMP INTERFACE TO ALL USER EXITS'
HMASMUXC CSECT ,                                                   0001
@MAINENT DS    0H                                                  0001
         USING *,@15                                               0001
         B     @PROLOG                                             0001
         DC    AL1(16)                                             0001
         DC    C'HMASMUXC  78.334'                                 0001
         DROP  @15
@PROLOG  STM   @14,@12,12(@13)                                     0001
         BALR  @12,0                                               0001
@PSTART  DS    0H                                                  0001
         USING @PSTART,@12                                         0001
         ST    @13,@SA00001+4                                      0001
         LA    @14,@SA00001                                        0001
         ST    @14,8(,@13)                                         0001
         LR    @13,@14                                             0001
         MVC   @PC00001(8),0(@01)                                  0001
*                                                                  0043
*   /*****************************************************************/
*   /*                                                               */
*   /* MAIN MODULE SEGMENT                                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0043
*   UXCRTNCD=ZERO;                  /*                               */
         MVI   UXCRTNCD,X'00'                                      0043
*   CCAPTR=ADDR(HMASMCCA);          /*                               */
         L     CCAPTR,@CA00037                                     0044
*   RFY                                                            0045
*     RTNCODE RSTD;                 /*                               */
*                                                                  0045
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THIS IS CALL FROM HMASMDRV AT END OF A FUNCTION OR AT END  */
*   /* OR SMP THEN CALL ROUTINE TO DELETE ALL LOADED USER EXITS      */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0046
*   IF UXCRTNCD=ZERO                /*                               */
*       &(CCAEOFNC=ON×CCAEOSMP=ON)  /* IF AT END OF FUNCTION OR SMP  */
*     THEN                          /*                               */
         CLI   UXCRTNCD,0                                          0046
         BNE   @RF00046                                            0046
         L     @14,@CA00037                                        0046
         TM    CCAEOFNC-HMASMCCA(@14),B'00000011'                  0046
         BZ    @RF00046                                            0046
*     DO;                           /*                               */
*       CALL UXCDELET;              /*                               */
         BAL   @14,UXCDELET                                        0048
*       UXCRTNCD=RTNCODE;           /*                               */
         STC   RTNCODE,UXCRTNCD                                    0049
*     END;                          /*                               */
*                                                                  0050
*   /*****************************************************************/
*   /*                                                               */
*   /* IF NOT CALL AT END OF SMP OR END OF FUNCTION THEN MUST BE     */
*   /* REQUEST TO INTERFACE WITH USER EXIT                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0051
*   ELSE                            /*                               */
*     DO;                           /*                               */
*                                                                  0051
         B     @RC00046                                            0051
@RF00046 DS    0H                                                  0052
*       /*************************************************************/
*       /*                                                           */
*       /* IF THIS IS FIRST TIME THRU THEN THE MASTER USER EXIT TO   */
*       /* DETERMINE THE CORRECT EXIT FOR EACH CALL HAS NOT BEEN     */
*       /* LOADED SO DO IT NOW                                       */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0052
*       IF ADDRUXD=ZERO             /* IF USER EXIT DETERMINER NOT   */
*         THEN                      /* LOADED THEN LOAD NOW          */
         ICM   @14,15,ADDRUXD                                      0052
         BNZ   @RF00052                                            0052
*         DO;                       /*                               */
*           LOADNAME=TXTUXD;        /*                               */
         MVC   LOADNAME(8),@CC00429                                0054
*           GEN(LOAD EPLOC=LOADNAME)                               0055
*           REFS(LOADNAME);         /*                               */
         LOAD EPLOC=LOADNAME
*           RFY                                                    0056
*             R0 RSTD;              /*                               */
*           ADDRUXD=R0;             /*                               */
         ST    R0,ADDRUXD                                          0057
*           RFY                                                    0058
*             R0 UNRSTD;            /*                               */
*         END;                      /*                               */
*                                                                  0059
*       /*************************************************************/
*       /*                                                           */
*       /* DETERMINE WHETHER ADDRESS OF USER EXIT ROUTINE REQUESTED  */
*       /* HAS BEEN OBTAINED YET. IF NOT CALL ROUTINE TO DETERMINE   */
*       /* USER EXIT                                                 */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0060
*       IF EXITFND(UXCCODE)=NTFND   /* IF NO ATTEMPT TO GET EXIT YET */
*         THEN                      /*                               */
@RF00052 L     @14,@PC00001                                        0060
         LH    @14,UXCCODE(,@14)                                   0060
         MH    @14,@CH00162                                        0060
         LA    @10,EXITFND-24(@14)                                 0060
         CLI   0(@10),C'N'                                         0060
         BNE   @RF00060                                            0060
*         DO;                       /*                               */
*           CALL UXCDETER;          /*                               */
         BAL   @14,UXCDETER                                        0062
*           UXCRTNCD=MAX(UXCRTNCD,RTNCODE);/*                        */
         SLR   @14,@14                                             0063
         IC    @14,UXCRTNCD                                        0063
         CR    @14,RTNCODE                                         0063
         BNL   *+6
         LR    @14,RTNCODE                                         0063
         STC   @14,UXCRTNCD                                        0063
*         END;                      /*                               */
*                                                                  0064
*       /*************************************************************/
*       /*                                                           */
*       /* IF EXIT NAME WAS RETURNED AND EXIT HAS NOT BEEN LOADED AND*/
*       /* ITS ADDRESS STORED THEN DO IT NOW                         */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0065
*       IF UXCRTNCD=ZERO            /*                               */
*           &EXITADDR(UXCCODE)=ZERO /*                               */
*           &EXITNAME(UXCCODE)^=BLANK8/*                             */
*         THEN                      /*                               */
@RF00060 CLI   UXCRTNCD,0                                          0065
         BNE   @RF00065                                            0065
         L     @14,@PC00001                                        0065
         LH    @14,UXCCODE(,@14)                                   0065
         MH    @14,@CH00162                                        0065
         L     @10,EXITADDR-24(@14)                                0065
         LTR   @10,@10                                             0065
         BNZ   @RF00065                                            0065
         LA    @10,EXITNAME-24(@14)                                0065
         CLC   0(8,@10),@CC00415                                   0065
         BE    @RF00065                                            0065
*         DO;                       /*                               */
*           LOADNAME=EXITNAME(UXCCODE);/* EXIT NAME                  */
         LA    @10,EXITNAME-24(@14)                                0067
         MVC   LOADNAME(8),0(@10)                                  0067
*           GEN(LOAD EPLOC=LOADNAME)                               0068
*           REFS(LOADNAME);         /*                               */
         LOAD EPLOC=LOADNAME
*           RFY                                                    0069
*             R0 RSTD;              /*                               */
*           EXITADDR(UXCCODE)=R0;   /* SAVE EXIT ROUTINE ADDRESS     */
         L     @14,@PC00001                                        0070
         LH    @14,UXCCODE(,@14)                                   0070
         MH    @14,@CH00162                                        0070
         ST    R0,EXITADDR-24(@14)                                 0070
*           RFY                                                    0071
*             R0 UNRSTD;            /*                               */
*           EXITFND(UXCCODE)=FND;   /* SET EXIT FOUND                */
         LA    @10,EXITFND-24(@14)                                 0072
         MVI   0(@10),C'Y'                                         0072
*         END;                      /*                               */
*                                                                  0073
*       /*************************************************************/
*       /*                                                           */
*       /* IF EXIT IS AVAILABLE THEN CALL EXIT NOW                   */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0074
*       IF UXCRTNCD=ZERO            /*                               */
*           &EXITADDR(UXCCODE)^=ZERO/*                               */
*         THEN                      /*                               */
@RF00065 CLI   UXCRTNCD,0                                          0074
         BNE   @RF00074                                            0074
         L     @14,@PC00001                                        0074
         LH    @14,UXCCODE(,@14)                                   0074
         MH    @14,@CH00162                                        0074
         L     @14,EXITADDR-24(@14)                                0074
         LTR   @14,@14                                             0074
         BZ    @RF00074                                            0074
*         DO;                       /*                               */
*           CALL UXCINTF;           /*                               */
         BAL   @14,UXCINTF                                         0076
*           UXCRTNCD=MAX(UXCRTNCD,RTNCODE);/*                        */
         SLR   @14,@14                                             0077
         IC    @14,UXCRTNCD                                        0077
         CR    @14,RTNCODE                                         0077
         BNL   *+6
         LR    @14,RTNCODE                                         0077
         STC   @14,UXCRTNCD                                        0077
*         END;                      /*                               */
*     END;                          /*                               */
*                                                                  0079
@RF00074 DS    0H                                                  0080
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN TO CALLER                                              */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0080
*   RETURN CODE(UXCRTNCD);          /*                               */
@RC00046 SLR   @15,@15                                             0080
         IC    @15,UXCRTNCD                                        0080
         L     @13,4(,@13)                                         0080
         L     @14,12(,@13)                                        0080
         LM    @00,@12,20(@13)                                     0080
         BR    @14                                                 0080
*   RFY                                                            0081
*     RTNCODE UNRSTD;               /*                               */
         EJECT
*                                                                  0082
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE IS CALLED TO DELETE ALL LOADED USER EXITS AND IF */
*   /* AT END OF SMP, THE HMASMUXD LOAD MODULE                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0082
*UXCDELET:                          /*                               */
*   PROCEDURE;                      /*                               */
UXCDELET STM   @14,@12,@SA00002                                    0082
*   DECLARE                         /*                               */
*     DELX FIXED(31);               /* INDEX THRU EXIT LIST          */
*                                                                  0083
*   /*****************************************************************/
*   /*                                                               */
*   /* LOOP THRU EXIT ARRAY AND FOR EACH EXIT DETERMINE WHETHER IT   */
*   /* SHOULD BE DELETED AND IF SO DELETE IT                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0084
*   DO DELX=1 TO DIM(EXITARRY);     /* LOOP THRU ALL EXITS           */
         LA    @10,1                                               0084
         ST    @10,DELX                                            0084
@DL00084 DS    0H                                                  0085
*     IF EXITNAME(DELX)^=BLANK8     /* IF HMASMUXD SPECIFIED NAME TO
*                                      LOAD                          */
*         &(CCAEOSMP=ON             /* AND AT END OF SMP             */
*         ×(CCAEOFNC=ON&EXITTYPE(DELX)=LCL))/* OR END OF FUNCTION AND
*                                      THIS IS EXIT LOCAL TO ONE   0085
*                                      FUNCTION                      */
*       THEN                        /* THEN MUST DELETE IT NOW       */
         MH    @10,@CH00162                                        0085
         LA    @01,EXITNAME-24(@10)                                0085
         CLC   0(8,@01),@CC00415                                   0085
         BE    @RF00085                                            0085
         L     @15,@CA00037                                        0085
         TM    CCAEOSMP-HMASMCCA(@15),B'00000001'                  0085
         BO    @RT00085                                            0085
         TM    CCAEOFNC-HMASMCCA(@15),B'00000010'                  0085
         BNO   @RF00085                                            0085
         LA    @01,EXITTYPE-24(@10)                                0085
         CLI   0(@01),C'L'                                         0085
         BNE   @RF00085                                            0085
@RT00085 DS    0H                                                  0086
*       DO;                         /*                               */
*         LOADNAME=EXITNAME(DELX);  /* SET LMOD NAME                 */
         L     @10,DELX                                            0087
         MH    @10,@CH00162                                        0087
         LA    @01,EXITNAME-24(@10)                                0087
         MVC   LOADNAME(8),0(@01)                                  0087
*         GEN(DELETE EPLOC=LOADNAME)                               0088
*         REFS(LOADNAME);           /*                               */
         DELETE EPLOC=LOADNAME
*         EXITNAME(UXCCODE)=BLANK8; /*                               */
         L     @10,@PC00001                                        0089
         LH    @10,UXCCODE(,@10)                                   0089
         MH    @10,@CH00162                                        0089
         LA    @01,EXITNAME-24(@10)                                0089
         MVC   0(8,@01),@CC00415                                   0089
*       END;                        /*                               */
*     EXITADDR(UXCCODE)=ZERO;       /*                               */
@RF00085 SLR   @10,@10                                             0091
         L     @15,@PC00001                                        0091
         LH    @15,UXCCODE(,@15)                                   0091
         MH    @15,@CH00162                                        0091
         ST    @10,EXITADDR-24(@15)                                0091
*     EXITFND(UXCCODE)=NTFND;       /*                               */
         LA    @14,EXITFND-24(@15)                                 0092
         MVI   0(@14),C'N'                                         0092
*     EXITLOE(UXCCODE)=ZERO;        /*                               */
         ST    @10,EXITLOE-24(@15)                                 0093
*   END;                            /*                               */
*                                                                  0094
         LA    @10,1                                               0094
         AL    @10,DELX                                            0094
         ST    @10,DELX                                            0094
         CH    @10,@CH00383                                        0094
         BNH   @DL00084                                            0094
*   /*****************************************************************/
*   /*                                                               */
*   /* IF THIS IS CALL AT END OF SMP THEN ALSO DELETE THE HMASMUXD   */
*   /* ROUTINE                                                       */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0095
*   IF CCAEOSMP=ON                  /*                               */
*     THEN                          /*                               */
         L     @10,@CA00037                                        0095
         TM    CCAEOSMP-HMASMCCA(@10),B'00000001'                  0095
         BNO   @RF00095                                            0095
*     DO;                           /*                               */
*       LOADNAME=TXTUXD;            /*                               */
         MVC   LOADNAME(8),@CC00429                                0097
*       GEN(DELETE EPLOC=LOADNAME)                                 0098
*       REFS(LOADNAME);             /*                               */
         DELETE EPLOC=LOADNAME
*       ADDRUXD=ZERO;               /* RESET UXD ADDR FOUND          */
         SLR   @10,@10                                             0099
         ST    @10,ADDRUXD                                         0099
*       HMASMUXP=''B;               /* RE INIT UXP PARM              */
         XC    HMASMUXP(44),HMASMUXP                               0100
*     END;                          /*                               */
*   RETURN CODE(ZERO);              /*                               */
@RF00095 SLR   @15,@15                                             0102
         L     @14,@SA00002                                        0102
         LM    @00,@12,@SA00002+8                                  0102
         BR    @14                                                 0102
*   END UXCDELET;                   /*                               */
         EJECT
*                                                                  0104
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE IS CALLED WHEN A REQUEST IS RECEIVED TO INTERFACE*/
*   /* WITH A USER EXIT THAT HAS NOT YET BEEN DEFINED TO HMASMP FROM */
*   /* THE MASTER USER EXIT DETERMINATION ROUTINE SUPPLIED BY THE    */
*   /* USER. THIS ROUTINE (HMASMUXD) IS CALLED NOW TO DETERMINE THE  */
*   /* CORRECT ROUTINE, IF ANY, TO BE USED FOR THIS EXIT.            */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0104
*UXCDETER:                          /*                               */
*   PROCEDURE;                      /*                               */
UXCDETER STM   @14,@12,@SA00003                                    0104
*   DECLARE                         /*                               */
*     DETERRC FIXED(8);             /*                               */
*   EXITFND(UXCCODE)=FND;           /*                               */
         L     @10,@PC00001                                        0106
         LH    @10,UXCCODE(,@10)                                   0106
         LR    @15,@10                                             0106
         MH    @15,@CH00162                                        0106
         LA    @14,EXITFND-24(@15)                                 0106
         MVI   0(@14),C'Y'                                         0106
*   UXPUXNUM=UXCCODE;               /* SET UP PARM WITH EXIT NUMBER  */
         STH   @10,UXPUXNUM                                        0107
*   UXPUXNAM='';                    /* NO NAME                       */
         MVI   UXPUXNAM,C' '                                       0108
         MVC   UXPUXNAM+1(7),UXPUXNAM                              0108
*   UXPUXAD=ZERO;                   /* NO ADDR                       */
         SLR   @10,@10                                             0109
         ST    @10,UXPUXAD                                         0109
*   UXPFUNCT=CCAFUNCT;              /* CURRENT FUNCTION              */
         L     @10,@CA00037                                        0110
         MVC   UXPFUNCT(8),CCAFUNCT-HMASMCCA(@10)                  0110
*   CALLUXD=ON;                     /* SET CALL FOR UXD RTN CK       */
         OI    CALLUXD,B'10000000'                                 0111
*   CALL HMASMUXD(HMASMUXP);        /* CALL EXIT DETERMINATION ROUT  */
         L     @15,ADDRUXD                                         0112
         LA    @01,@AL00112                                        0112
         BALR  @14,@15                                             0112
*   RFY                                                            0113
*     RTNCODE RSTD;                 /*                               */
*   DETERRC=RTNCODE;                /*                               */
         STC   RTNCODE,DETERRC                                     0114
*   CALLUXD=ON;                     /* SET CALL FOR UXD RTN CK       */
         OI    CALLUXD,B'10000000'                                 0115
*   CALL UXCRTNCK(DETERRC);         /* CHECK ITS RETURN CODE         */
         LA    @01,@AL00116                                        0116
         BAL   @14,UXCRTNCK                                        0116
*   DETERRC=RTNCODE;                /*                               */
         STC   RTNCODE,DETERRC                                     0117
*   CALLUXD=OFF;                    /* NOT CALL FOR UXD CK           */
         NI    CALLUXD,B'01111111'                                 0118
*   RFY                                                            0119
*     RTNCODE UNRSTD;               /*                               */
*   IF DETERRC=ZERO                 /* IF RTNCD OK THEN              */
*     THEN                          /*                               */
         CLI   DETERRC,0                                           0120
         BNE   @RF00120                                            0120
*     DO;                           /*                               */
*       EXITNAME(UXCCODE)=UXPUXNAM; /* SAVE RETURNED NAME OR ADDR    */
         L     @10,@PC00001                                        0122
         LH    @10,UXCCODE(,@10)                                   0122
         MH    @10,@CH00162                                        0122
         LA    @01,EXITNAME-24(@10)                                0122
         MVC   0(8,@01),UXPUXNAM                                   0122
*       EXITADDR(UXCCODE)=UXPUXAD;  /*                               */
         L     @15,UXPUXAD                                         0123
         ST    @15,EXITADDR-24(@10)                                0123
*     END;                          /*                               */
*   RETURN CODE(DETERRC);           /*                               */
@RF00120 SLR   @15,@15                                             0125
         IC    @15,DETERRC                                         0125
         L     @14,@SA00003                                        0125
         LM    @00,@12,@SA00003+8                                  0125
         BR    @14                                                 0125
*   END UXCDETER;                   /*                               */
         EJECT
*                                                                  0127
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE IS CALLED TO CALL THE USER EXIT                  */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0127
*UXCINTF:                           /*                               */
*   PROCEDURE;                      /*                               */
UXCINTF  STM   @14,@12,@SA00004                                    0127
*   DECLARE                         /*                               */
*     INTFRC FIXED(8);              /* RETURN CODE                   */
*   DECLARE                         /*                               */
*     SAVEREGS CHAR(60) BDY(WORD);  /*                               */
*   DECLARE                         /*                               */
*     SMPEXIT ENTRY BASED(EXITADDR(UXCCODE));/* USER EXIT            */
*   UXPUXNUM=UXCCODE;               /* EXIT CODE                     */
         L     @10,@PC00001                                        0131
         LH    @10,UXCCODE(,@10)                                   0131
         STH   @10,UXPUXNUM                                        0131
*   UXPUXNAM=EXITNAME(UXPUXNUM);    /* EXIT NAME                     */
         MH    @10,@CH00162                                        0132
         LA    @01,EXITNAME-24(@10)                                0132
         MVC   UXPUXNAM(8),0(@01)                                  0132
*   UXPUXAD=EXITADDR(UXPUXNUM);     /* EXIT ADDRESS                  */
         L     @15,EXITADDR-24(@10)                                0133
         ST    @15,UXPUXAD                                         0133
*   UXPFUNCT=CCAFUNCT;              /* SMP FUNCTION                  */
         L     @15,@CA00037                                        0134
         MVC   UXPFUNCT(8),CCAFUNCT-HMASMCCA(@15)                  0134
*   UXPLOEAD=EXITLOE(UXPUXNUM);     /* EXIT USER PARM ADDR           */
         L     @15,EXITLOE-24(@10)                                 0135
         ST    @15,UXPLOEAD                                        0135
*   IF EXITPLEN(UXPUXNUM)^=ZERO     /* IF EXIT HAS PARM              */
*     THEN                          /*                               */
         LH    @10,EXITPLEN-24(@10)                                0136
         LTR   @10,@10                                             0136
         BZ    @RF00136                                            0136
*     DO;                           /*                               */
*       EXITPPRM(1:EXITPLEN(UXPUXNUM))=UXCPARM(1:EXITPLEN(UXPUXNUM));
         BCTR  @10,0                                               0138
         L     @15,@PC00001+4                                      0138
         EX    @10,@SM00494                                        0138
*                                   /* MOVE PARM PASSED BY USER INTO
*                                      LOCAL AREA                    */
*       UXPPRMAD=ADDR(EXITPPRM);    /* PARAMETER AREA                */
         LA    @10,EXITPPRM                                        0139
         ST    @10,UXPPRMAD                                        0139
*     END;                          /*                               */
*   ELSE                            /*                               */
*     UXPPRMAD=ZERO;                /*                               */
         B     @RC00136                                            0141
@RF00136 SLR   @10,@10                                             0141
         ST    @10,UXPPRMAD                                        0141
*   STM(R0,RTNREG,SAVEREGS);        /* SAVE REGS ACROSS CALL         */
@RC00136 STM   R0,RTNREG,SAVEREGS                                  0142
*   CALL SMPEXIT(HMASMUXP);         /*                               */
         L     @10,@PC00001                                        0143
         LH    @10,UXCCODE(,@10)                                   0143
         MH    @10,@CH00162                                        0143
         L     @15,EXITADDR-24(@10)                                0143
         LA    @01,@AL00143                                        0143
         BALR  @14,@15                                             0143
*   LM(R0,RTNREG,SAVEREGS);         /* RELOAD REGS                   */
         LM    R0,RTNREG,SAVEREGS                                  0144
*   RFY                                                            0145
*     RTNCODE RSTD;                 /*                               */
*   INTFRC=RTNCODE;                 /*                               */
         STC   RTNCODE,INTFRC                                      0146
*   EXITLOE(UXPUXNUM)=UXPLOEAD;     /* SAVE EXIT USER PARM ADDR      */
         LH    @14,UXPUXNUM                                        0147
         MH    @14,@CH00162                                        0147
         L     @10,UXPLOEAD                                        0147
         ST    @10,EXITLOE-24(@14)                                 0147
*   CALL UXCRTNCK(INTFRC);          /* CHECK USER EXIT RETURN CODE   */
         LA    @01,@AL00148                                        0148
         BAL   @14,UXCRTNCK                                        0148
*   INTFRC=RTNCODE;                 /*                               */
         STC   RTNCODE,INTFRC                                      0149
*   IF EXITPCPY(UXPUXNUM)=COPY      /* IF PARM CAN BE UPDATED        */
*     THEN                          /*                               */
         LH    @14,UXPUXNUM                                        0150
         MH    @14,@CH00162                                        0150
         LA    @10,EXITPCPY-24(@14)                                0150
         CLI   0(@10),C'Y'                                         0150
         BNE   @RF00150                                            0150
*     UXCPARM(1:EXITPLEN(UXPUXNUM))=EXITPPRM(1:EXITPLEN(UXPUXNUM));/*
*                                      COPY RETURN PARM BACK         */
         L     @10,@PC00001+4                                      0151
         LH    @14,EXITPLEN-24(@14)                                0151
         BCTR  @14,0                                               0151
         EX    @14,@SM00496                                        0151
*   RFY                                                            0152
*     RTNCODE UNRSTD;               /*                               */
@RF00150 DS    0H                                                  0153
*   RETURN CODE(INTFRC);            /*                               */
         SLR   @15,@15                                             0153
         IC    @15,INTFRC                                          0153
         L     @14,@SA00004                                        0153
         LM    @00,@12,@SA00004+8                                  0153
         BR    @14                                                 0153
*   END UXCINTF;                    /*                               */
         EJECT
*                                                                  0155
*   /*****************************************************************/
*   /*                                                               */
*   /* THIS ROUTINE IS CALLED TO VARIFY THE RETURN CODE FROM THE USER*/
*   /* EXIT CALLED                                                   */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0155
*UXCRTNCK:                          /*                               */
*   PROCEDURE(PASSRC);              /*                               */
UXCRTNCK STM   @14,@12,@SA00005                                    0155
         MVC   @PC00005(4),0(@01)                                  0155
*   DECLARE                         /*                               */
*     PASSRC FIXED(8);              /* RETURN CODE FROM USER EXIT    */
*   DECLARE                         /*                               */
*     RTNCKRC FIXED(8);             /*                               */
*                                                                  0157
*   /*****************************************************************/
*   /*                                                               */
*   /* INITIALIZE RETURN CODE AND MSG PARM                           */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0158
*   RTNCKRC=PASSRC;                 /*                               */
         L     @10,@PC00005                                        0158
         MVC   RTNCKRC(1),PASSRC(@10)                              0158
*   HMASMMGP=''B;                   /*                               */
         XC    HMASMMGP(24),HMASMMGP                               0159
*   MGPPRINT=ON;                    /*                               */
*   MGPHLDS=ON;                     /*                               */
*                                                                  0161
         OI    MGPPRINT,B'10010000'                                0161
*   /*****************************************************************/
*   /*                                                               */
*   /* CHECK FOR GOOD RETURN CODE                                    */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0162
*   IF PASSRC=UXPGOOD               /*                               */
*     THEN                          /*                               */
         CLI   PASSRC(@10),0                                       0162
         BE    @RT00162                                            0162
*     ;                             /*                               */
*   ELSE                            /*                               */
*                                                                  0164
*     /***************************************************************/
*     /*                                                             */
*     /* CHECK FOR TERMINATE SYSMOD RETURN CODE                      */
*     /*                                                             */
*     /***************************************************************/
*                                                                  0164
*     IF PASSRC=UXPTPTF             /*                               */
*       THEN                        /*                               */
         L     @10,@PC00005                                        0164
         CLI   PASSRC(@10),8                                       0164
         BNE   @RF00164                                            0164
*       DO;                         /*                               */
*         MGPCLEAR=''B;             /*                               */
         XC    MGPCLEAR(6),MGPCLEAR                                0166
*         MGPMGNO1=HMA206I;         /* USER EXIT RETURN CODE       0167
*                                      INDICATES TERMINATION OF    0167
*                                      XXXXXXXX                      */
         MVC   MGPMGNO1(2),@CH00240                                0167
*         MGPVARPT(1)=ADDR(TXTSYSMD);/* SYSMOD                       */
         LA    @10,@CC00411                                        0168
         ST    @10,MGPVARPT                                        0168
*         MGPTYPE=MGPERR;           /*                               */
         MVI   MGPTYPE,X'03'                                       0169
*         CALL HMASMMSG(HMASMMGP);  /*                               */
         L     @15,@CV00406                                        0170
         LA    @01,@AL00170                                        0170
         BALR  @14,@15                                             0170
*       END;                        /*                               */
*     ELSE                          /*                               */
*                                                                  0172
*       /*************************************************************/
*       /*                                                           */
*       /* CHECK FOR TERMINATION OF FUNCTION                         */
*       /*                                                           */
*       /*************************************************************/
*                                                                  0172
*       IF PASSRC=UXPTFUNC          /*                               */
*         THEN                      /*                               */
         B     @RC00164                                            0172
@RF00164 L     @10,@PC00005                                        0172
         CLI   PASSRC(@10),12                                      0172
         BNE   @RF00172                                            0172
*         DO;                       /*                               */
*           MGPCLEAR=''B;           /*                               */
         XC    MGPCLEAR(6),MGPCLEAR                                0174
*           MGPMGNO1=HMA206I;       /* USER EXIT RETURN CODE       0175
*                                      INDICATES TERMINATION OF    0175
*                                      XXXXXXXX                      */
         MVC   MGPMGNO1(2),@CH00240                                0175
*           MGPVARPT(1)=ADDR(CCAFUNCT);/* FUNCTION                   */
         L     @10,@CA00037                                        0176
         LA    @10,CCAFUNCT-HMASMCCA(,@10)                         0176
         ST    @10,MGPVARPT                                        0176
*           MGPTYPE=MGPSEV;         /*                               */
         MVI   MGPTYPE,X'04'                                       0177
*           CALL HMASMMSG(HMASMMGP);/*                               */
         L     @15,@CV00406                                        0178
         LA    @01,@AL00178                                        0178
         BALR  @14,@15                                             0178
*         END;                      /*                               */
*       ELSE                        /*                               */
*                                                                  0180
*         /***********************************************************/
*         /*                                                         */
*         /* CHECK FOR TERMINATION OF SMP                            */
*         /*                                                         */
*         /***********************************************************/
*                                                                  0180
*         IF PASSRC=UXPTSMP         /*                               */
*           THEN                    /*                               */
         B     @RC00172                                            0180
@RF00172 L     @10,@PC00005                                        0180
         CLI   PASSRC(@10),16                                      0180
         BNE   @RF00180                                            0180
*           DO;                     /*                               */
*             MGPCLEAR=''B;         /*                               */
         XC    MGPCLEAR(6),MGPCLEAR                                0182
*             MGPMGNO1=HMA206I;     /* USER EXIT RETURN CODE       0183
*                                      INDICATES TERMINATION OF    0183
*                                      XXXXXXXX                      */
         MVC   MGPMGNO1(2),@CH00240                                0183
*             MGPVARPT(1)=ADDR(TXTSMP);/* SMP                        */
         LA    @10,@CC00413                                        0184
         ST    @10,MGPVARPT                                        0184
*             MGPTYPE=MGPTERM;      /*                               */
         MVI   MGPTYPE,X'05'                                       0185
*             CALL HMASMMSG(HMASMMGP);/*                             */
         L     @15,@CV00406                                        0186
         LA    @01,@AL00186                                        0186
         BALR  @14,@15                                             0186
*           END;                    /*                               */
*         ELSE                      /*                               */
*                                                                  0188
*           /*********************************************************/
*           /*                                                       */
*           /* NOW THAT STANDARD RETURN CODES HAVE BEEN CHECK CHECK  */
*           /* TO SEE IF THE RETURN CODE WAS AN INVALID ONE FOR THE  */
*           /* EXIT CALLED. IF SO THEN SET RETURN CODE TO 12 TO      */
*           /* TERMINATE CURRENT FUNCTION                            */
*           /*                                                       */
*           /*********************************************************/
*                                                                  0188
*           DO;                     /*                               */
*                                                                  0188
         B     @RC00180                                            0188
@RF00180 DS    0H                                                  0189
*             /*******************************************************/
*             /*                                                     */
*             /* CHECK FOR VALID RETURN CODES FOR EXIT 001           */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0189
*             IF CALLUXD=ON         /* IF CHECK FOR UXD RTNCD        */
*                 ×                 /* OR                            */
*                 (UXPUXNUM=UXPUX001/* IF EXIT 001                   */
*                 &(PASSRC^=UXPADD  /* AND NOT ADD                   */
*                 &PASSRC^=UXPDEL)) /* OR DELETE                     */
*               THEN                /*                               */
         TM    CALLUXD,B'10000000'                                 0189
         BO    @RT00189                                            0189
         CLC   UXPUXNUM(2),@CH00086                                0189
         BNE   @RF00189                                            0189
         L     @10,@PC00005                                        0189
         CLI   PASSRC(@10),20                                      0189
         BE    @RF00189                                            0189
         CLI   PASSRC(@10),24                                      0189
         BE    @RF00189                                            0189
@RT00189 DS    0H                                                  0190
*               RTNCKRC=UXPTFUNC;   /*                               */
*                                                                  0190
         MVI   RTNCKRC,X'0C'                                       0190
*             /*******************************************************/
*             /*                                                     */
*             /* IF RETURN CODE WAS SET TO STOP FUNCTION THEN ISSUE  */
*             /* MESSAGE INDICATING UNKNOWN RETURN CODE              */
*             /*                                                     */
*             /*******************************************************/
*                                                                  0191
*             IF RTNCKRC=UXPTFUNC   /*                               */
*               THEN                /*                               */
@RF00189 CLI   RTNCKRC,12                                          0191
         BNE   @RF00191                                            0191
*               DO;                 /*                               */
*                 CVD(PASSRC,PACK8);/* CONVERT RC TO DECIMAL         */
         L     @10,@PC00005                                        0193
         SLR   @15,@15                                             0193
         IC    @15,PASSRC(,@10)                                    0193
         CVD   @15,PACK8                                           0193
*                 UNPK(CHAR12,PACK8);/* UNPACK IT                    */
         UNPK  CHAR12(12),PACK8(8)                                 0194
*                 CHAR12(12)=CHAR12(12)×HEX0;/*                      */
         OI    CHAR12+11,X'F0'                                     0195
*                 MGPCLEAR=''B;     /*                               */
         XC    MGPCLEAR(6),MGPCLEAR                                0196
*                 MGPMGNO1=HMA207I; /* UNKNOWN USER EXIT RETURN CODE
*                                      ( XX ) - XXXXXXXX TERMINATED  */
         MVC   MGPMGNO1(2),@CH00111                                0197
*                 MGPVARPT(1)=ADDR(CHAR12(11));/*                    */
         LA    @10,CHAR12+10                                       0198
         ST    @10,MGPVARPT                                        0198
*                 IF EXITTYPE(UXPUXNUM)=LCL/* IF EXIT FOR FUNCTION   */
*                   THEN            /*                               */
         LH    @10,UXPUXNUM                                        0199
         MH    @10,@CH00162                                        0199
         LA    @01,EXITTYPE-24(@10)                                0199
         CLI   0(@01),C'L'                                         0199
         BNE   @RF00199                                            0199
*                   DO;             /*                               */
*                     MGPVARPT(2)=ADDR(CCAFUNCT);/*                  */
         L     @10,@CA00037                                        0201
         LA    @10,CCAFUNCT-HMASMCCA(,@10)                         0201
         ST    @10,MGPVARPT+4                                      0201
*                     MGPTYPE=MGPSEV;/*                              */
         MVI   MGPTYPE,X'04'                                       0202
*                   END;            /*                               */
*                 ELSE              /*                               */
*                   DO;             /*                               */
         B     @RC00199                                            0204
@RF00199 DS    0H                                                  0205
*                     MGPVARPT(2)=ADDR(TXTSMP);/* EXIT FOR ALL SMP   */
         LA    @10,@CC00413                                        0205
         ST    @10,MGPVARPT+4                                      0205
*                     MGPTYPE=MGPTERM;/*                             */
         MVI   MGPTYPE,X'05'                                       0206
*                     RTNCKRC=UXPTSMP;/* SET RC                      */
         MVI   RTNCKRC,X'10'                                       0207
*                   END;            /*                               */
*                 CALL HMASMMSG(HMASMMGP);/*                         */
@RC00199 L     @15,@CV00406                                        0209
         LA    @01,@AL00209                                        0209
         BALR  @14,@15                                             0209
*               END;                /*                               */
*           END;                    /*                               */
*                                                                  0211
@RF00191 DS    0H                                                  0212
*   /*****************************************************************/
*   /*                                                               */
*   /* RETURN CODE FROM THIS PROCEDURE IS EQUAL TO THE RETURN FROM   */
*   /* THE USER EXIT OR THE HIGHER RETURN CODE THAT MAY HAVE BEEN SET*/
*   /* WITHIN THIS PROCEDURE                                         */
*   /*                                                               */
*   /*****************************************************************/
*                                                                  0212
*   RETURN CODE(RTNCKRC);           /*                               */
@RC00180 DS    0H                                                  0212
@RC00172 DS    0H                                                  0212
@RC00164 DS    0H                                                  0212
@RT00162 SLR   @15,@15                                             0212
         IC    @15,RTNCKRC                                         0212
         L     @14,@SA00005                                        0212
         LM    @00,@12,@SA00005+8                                  0212
         BR    @14                                                 0212
*   END UXCRTNCK;                   /*                               */
*   END HMASMUXC                    /*                               */
*                                                                  0214
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */
*/*%INCLUDE SYSLIB  (HMASMCCA)                                       */
*/*%INCLUDE SYSLIB  (HMASMMGP)                                       */
*/*%INCLUDE SYSLIB  (HMASMUXP)                                       */
*                                                                  0214
*       ;                                                          0214
@DATA    DS    0H
@CH00086 DC    H'1'
@CH00240 DC    H'7'
@CH00111 DC    H'8'
@CH00383 DC    H'20'
@CH00162 DC    H'24'
@SM00494 MVC   EXITPPRM(0),UXCPARM(@15)
@SM00496 MVC   UXCPARM(0,@10),EXITPPRM
         DS    0F
@AL00112 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00143 DC    A(HMASMUXP)             LIST WITH   1 ARGUMENT(S)
@AL00116 DC    A(DETERRC)              LIST WITH   1 ARGUMENT(S)
@AL00148 DC    A(INTFRC)               LIST WITH   1 ARGUMENT(S)
@AL00170 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00178 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00186 EQU   *                       LIST WITH   1 ARGUMENT(S)
@AL00209 DC    A(HMASMMGP)             LIST WITH   1 ARGUMENT(S)
         DS    0F
@SA00001 DS    18F
@PC00001 DS    2F
@SA00002 DS    15F
@SA00003 DS    15F
@SA00004 DS    15F
@SA00005 DS    0F
@PC00005 EQU   @SA00005+60
         DS    16F
         DS    0F
@CA00037 DC    A(HMASMCCA)
@CV00406 DC    V(HMASMMSG)
         DS    0D
ADDRUXD  DC    A(0)
DELX     DS    F
UXCRTNCD DS    FL1
DETERRC  DS    FL1
INTFRC   DS    FL1
RTNCKRC  DS    FL1
@CC00411 DC    C'SYSMOD  '
@CC00413 DC    C'SMP     '
@CC00415 DC    C'        '
@CC00429 DC    C'HMASMUXD'
HMASMMGP DS    CL24
         ORG   HMASMMGP
MGPFIXED DS    CL12
         ORG   MGPFIXED
MGPCLEAR DS    CL6
         ORG   MGPCLEAR
MGPMGNO1 DS    FL2
MGPMGNO2 DS    FL2
MGPMGNO3 DS    FL2
         ORG   MGPFIXED+6
MGPFLAGS DS    BL2
         ORG   MGPFLAGS
MGPPRINT DS    BL1
MGPLIST  EQU   MGPFLAGS+0
MGPRPT   EQU   MGPFLAGS+0
MGPHLDS  EQU   MGPFLAGS+0
MGPWTOR  EQU   MGPFLAGS+0
MGPWTO   EQU   MGPFLAGS+0
MGPWTP   EQU   MGPFLAGS+0
@NM00043 EQU   MGPFLAGS+0
         ORG   MGPFIXED+8
MGPTYPE  DS    FL1
@NM00044 DS    CL3
         ORG   HMASMMGP+12
MGPVAR   DS    CL12
         ORG   MGPVAR
MGPVARPT DS    3A
         ORG   HMASMMGP+24
HMASMUXP DC    XL44'0'
         ORG   HMASMUXP
UXPUXNUM DS    FL2
@NM00045 DS    CL2
UXPUXNAM DS    CL8
UXPUXAD  DS    AL4
UXPFUNCT DS    CL8
UXPPRMAD DS    AL4
UXPLOJAD DS    AL4
UXPLOEAD DS    AL4
UXPCTBAD DS    AL4
UXPMODAD DS    AL4
         ORG   HMASMUXP+44
UXCSW    DC    AL1(0)
         ORG   UXCSW
CALLUXD  DS    BL1
@NM00046 EQU   UXCSW+0
         ORG   UXCSW+1
         DS    CL7
PACK8    DS    CL8
CHAR12   DS    CL12
LOADNAME DS    CL8
EXITPPRM DS    CL255
         DS    CL1
PATCHUXC DS    CL80
         ORG   PATCHUXC
@NM00049 DC    80X'FF'
         ORG   PATCHUXC+80
SAVEREGS DS    CL60
EXITARRY DS    CL24
         ORG   EXITARRY+0
EXITNAME DC    CL8' '
EXITADDR DC    A(0)
EXITFND  DC    CL1'N'
EXITTYPE DC    CL1'L'
EXITPCPY DC    CL1'Y'
@NM00047 DC    CL1' '
EXITLOE  DC    A(0)
EXITPLEN DC    AL2(81)
@NM00048 DC    CL2' '
         ORG   EXITARRY+24
         ORG   EXITARRY+24
         DC    CL8' '
         DC    A(0)
         DC    CL1'N'
         DC    CL1'L'
         DC    CL1'Y'
         DC    CL1' '
         DC    A(0)
         DC    H'0'
         DC    CL2' '
         ORG   EXITARRY+48
         ORG   EXITARRY+48
         DC    CL8' '
         DC    A(0)
         DC    CL1'N'
         DC    CL1'L'
         DC    CL1'Y'
         DC    CL1' '
         DC    A(0)
         DC    H'0'
         DC    CL2' '
         ORG   EXITARRY+72
         ORG   EXITARRY+72
         DC    CL8' '
         DC    A(0)
         DC    CL1'N'
         DC    CL1'L'
         DC    CL1'Y'
         DC    CL1' '
         DC    A(0)
         DC    H'0'
         DC    CL2' '
         ORG   EXITARRY+96
         ORG   EXITARRY+96
         DC    CL8' '
         DC    A(0)
         DC    CL1'N'
         DC    CL1'L'
         DC    CL1'Y'
         DC    CL1' '
         DC    A(0)
         DC    H'0'
         DC    CL2' '
         ORG   EXITARRY+120
         ORG   EXITARRY+120
         DC    CL8' '
         DC    A(0)
         DC    CL1'N'
         DC    CL1'L'
         DC    CL1'Y'
         DC    CL1' '
         DC    A(0)
         DC    H'0'
         DC    CL2' '
         ORG   EXITARRY+144
         ORG   EXITARRY+144
         DC    CL8' '
         DC    A(0)
         DC    CL1'N'
         DC    CL1'L'
         DC    CL1'Y'
         DC    CL1' '
         DC    A(0)
         DC    H'0'
         DC    CL2' '
         ORG   EXITARRY+168
         ORG   EXITARRY+168
         DC    CL8' '
         DC    A(0)
         DC    CL1'N'
         DC    CL1'L'
         DC    CL1'Y'
         DC    CL1' '
         DC    A(0)
         DC    H'0'
         DC    CL2' '
         ORG   EXITARRY+192
         ORG   EXITARRY+192
         DC    CL8' '
         DC    A(0)
         DC    CL1'N'
         DC    CL1'L'
         DC    CL1'Y'
         DC    CL1' '
         DC    A(0)
         DC    H'0'
         DC    CL2' '
         ORG   EXITARRY+216
         ORG   EXITARRY+216
         DC    CL8' '
         DC    A(0)
         DC    CL1'N'
         DC    CL1'L'
         DC    CL1'Y'
         DC    CL1' '
         DC    A(0)
         DC    H'0'
         DC    CL2' '
         ORG   EXITARRY+240
         ORG   EXITARRY+240
         DC    CL8' '
         DC    A(0)
         DC    CL1'N'
         DC    CL1'L'
         DC    CL1'Y'
         DC    CL1' '
         DC    A(0)
         DC    H'0'
         DC    CL2' '
         ORG   EXITARRY+264
         ORG   EXITARRY+264
         DC    CL8' '
         DC    A(0)
         DC    CL1'N'
         DC    CL1'L'
         DC    CL1'Y'
         DC    CL1' '
         DC    A(0)
         DC    H'0'
         DC    CL2' '
         ORG   EXITARRY+288
         ORG   EXITARRY+288
         DC    CL8' '
         DC    A(0)
         DC    CL1'N'
         DC    CL1'L'
         DC    CL1'Y'
         DC    CL1' '
         DC    A(0)
         DC    H'0'
         DC    CL2' '
         ORG   EXITARRY+312
         ORG   EXITARRY+312
         DC    CL8' '
         DC    A(0)
         DC    CL1'N'
         DC    CL1'L'
         DC    CL1'Y'
         DC    CL1' '
         DC    A(0)
         DC    H'0'
         DC    CL2' '
         ORG   EXITARRY+336
         ORG   EXITARRY+336
         DC    CL8' '
         DC    A(0)
         DC    CL1'N'
         DC    CL1'L'
         DC    CL1'Y'
         DC    CL1' '
         DC    A(0)
         DC    H'0'
         DC    CL2' '
         ORG   EXITARRY+360
         ORG   EXITARRY+360
         DC    CL8' '
         DC    A(0)
         DC    CL1'N'
         DC    CL1'L'
         DC    CL1'Y'
         DC    CL1' '
         DC    A(0)
         DC    H'0'
         DC    CL2' '
         ORG   EXITARRY+384
         ORG   EXITARRY+384
         DC    CL8' '
         DC    A(0)
         DC    CL1'N'
         DC    CL1'L'
         DC    CL1'Y'
         DC    CL1' '
         DC    A(0)
         DC    H'0'
         DC    CL2' '
         ORG   EXITARRY+408
         ORG   EXITARRY+408
         DC    CL8' '
         DC    A(0)
         DC    CL1'N'
         DC    CL1'L'
         DC    CL1'Y'
         DC    CL1' '
         DC    A(0)
         DC    H'0'
         DC    CL2' '
         ORG   EXITARRY+432
         ORG   EXITARRY+432
         DC    CL8' '
         DC    A(0)
         DC    CL1'N'
         DC    CL1'L'
         DC    CL1'Y'
         DC    CL1' '
         DC    A(0)
         DC    H'0'
         DC    CL2' '
         ORG   EXITARRY+456
         ORG   EXITARRY+456
         DC    CL8' '
         DC    A(0)
         DC    CL1'N'
         DC    CL1'L'
         DC    CL1'Y'
         DC    CL1' '
         DC    A(0)
         DC    H'0'
         DC    CL2' '
         ORG   EXITARRY+480
@00      EQU   00                      EQUATES FOR REGISTERS 0-15
@01      EQU   01
@02      EQU   02
@03      EQU   03
@04      EQU   04
@05      EQU   05
@06      EQU   06
@07      EQU   07
@08      EQU   08
@09      EQU   09
@10      EQU   10
@11      EQU   11
@12      EQU   12
@13      EQU   13
@14      EQU   14
@15      EQU   15
CCAPTR   EQU   @11
RTNREG   EQU   @14
RTNCODE  EQU   @15
R0       EQU   @00
         EXTRN HMASMCCA
CCABLDLA EQU   0
@NM00025 EQU   CCABLDLA
CCABLDLL EQU   0
@NM00027 EQU   CCABLDLL
CCALKDRC EQU   @NM00027+20
@NM00029 EQU   CCABLDLL+124
CCAASMRC EQU   @NM00029+20
@NM00031 EQU   CCABLDLL+248
CCACPYRC EQU   @NM00031+20
@NM00033 EQU   CCABLDLL+372
CCACOMRC EQU   @NM00033+20
@NM00035 EQU   CCABLDLL+496
CCAZAPRC EQU   @NM00035+20
@NM00037 EQU   CCABLDLL+620
CCASUPRC EQU   @NM00037+20
@NM00039 EQU   CCABLDLL+744
CCAUPDRC EQU   @NM00039+20
CCABLDLM EQU   0
CCABELMT EQU   CCABLDLM+4
CCABMPOS EQU   CCABELMT
UX001PRM EQU   0
HMASMUXD EQU   0
SMPEXIT  EQU   0
CCADSIDA EQU   0
CCATYPEA EQU   0
CCAFBUFR EQU   HMASMCCA+4
CCADSAD  EQU   CCAFBUFR+124
CCATPAD  EQU   CCAFBUFR+128
CCAFLAG7 EQU   CCAFBUFR+132
CCAFIOP  EQU   HMASMCCA+140
CCAFSYS  EQU   HMASMCCA+148
CCASREL  EQU   CCAFSYS+12
CCAFLAGA EQU   CCAFSYS+21
CCAFSTA  EQU   HMASMCCA+188
CCAFICT  EQU   HMASMCCA+192
CCAFPGM  EQU   HMASMCCA+208
CCABLDLP EQU   CCAFPGM
CCADBLDL EQU   CCAFPGM+4
CCAFGTP  EQU   HMASMCCA+224
CCASEGTP EQU   CCAFGTP
@NM00009 EQU   HMASMCCA+244
CCAFFUNC EQU   HMASMCCA+264
CCAFUNCT EQU   CCAFFUNC
CCAFLAG1 EQU   CCAFFUNC+8
CCAFLAG2 EQU   CCAFFUNC+11
CCAEOFNC EQU   CCAFLAG2
CCAEOSMP EQU   CCAFLAG2
CCAFPROC EQU   HMASMCCA+276
CCAFLAG3 EQU   CCAFPROC
CCAFDIS  EQU   HMASMCCA+278
CCAFLAG4 EQU   CCAFDIS
CCAFLAG5 EQU   CCAFDIS+1
CCAFLAG6 EQU   CCAFDIS+2
CCAFCNV  EQU   HMASMCCA+281
CCAFLAG8 EQU   CCAFCNV
CCAFCTL  EQU   HMASMCCA+282
CCAFLAG9 EQU   CCAFCTL
CCAFDSNG EQU   HMASMCCA+298
CCAFLAGB EQU   CCAFDSNG
UXCCODE  EQU   0
UXCPARM  EQU   0
PASSRC   EQU   0
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS
CCAEND   EQU   HMASMCCA+371
@NM00024 EQU   HMASMCCA+309
CCACURDD EQU   CCAFDSNG+3
CCACURDS EQU   CCAFDSNG+2
@NM00023 EQU   CCAFLAGB
CCAOUTNG EQU   CCAFLAGB
CCALOGNG EQU   CCAFLAGB
CCAFMID  EQU   HMASMCCA+291
CCALSTDS EQU   CCAFCTL+8
CCARPTDS EQU   CCAFCTL+7
CCATIME  EQU   CCAFCTL+4
CCADATE  EQU   CCAFCTL+1
@NM00022 EQU   CCAFLAG9
CCARVCAN EQU   CCAFLAG9
CCARVEST EQU   CCAFLAG9
CCAPTSNJ EQU   CCAFLAG9
CCASTSNP EQU   CCAFLAG9
CCAMTSNP EQU   CCAFLAG9
CCAPTSNP EQU   CCAFLAG9
@NM00021 EQU   CCAFLAG8
CCAACDSC EQU   CCAFLAG8
CCACDSC  EQU   CCAFLAG8
@NM00020 EQU   CCAFLAG6
CCAACRUP EQU   CCAFLAG6
CCACRQUP EQU   CCAFLAG6
CCAACDUP EQU   CCAFLAG6
CCACDSUP EQU   CCAFLAG6
@NM00019 EQU   CCAFLAG5
CCAACROS EQU   CCAFLAG5
CCACRQOS EQU   CCAFLAG5
CCAACDOS EQU   CCAFLAG5
CCACDSOS EQU   CCAFLAG5
@NM00018 EQU   CCAFLAG4
CCAACRIS EQU   CCAFLAG4
CCACRQIS EQU   CCAFLAG4
CCAACDIS EQU   CCAFLAG4
CCACDSIS EQU   CCAFLAG4
@NM00017 EQU   CCAFLAG3+1
CCARGNP  EQU   CCAFLAG3+1
CCADISRQ EQU   CCAFLAG3+1
CCAICTOK EQU   CCAFLAG3
CCADELP  EQU   CCAFLAG3
CCACMPRS EQU   CCAFLAG3
CCAZAPP  EQU   CCAFLAG3
CCALINKP EQU   CCAFLAG3
CCACOPYP EQU   CCAFLAG3
CCAASIP  EQU   CCAFLAG3
CCAUPDP  EQU   CCAFLAG3
@NM00016 EQU   CCAFLAG2
CCACHECK EQU   CCAFLAG2
CCATERM  EQU   CCAFLAG2
CCASVCLB EQU   CCAFLAG2
CCANCPTF EQU   CCAFLAG2
@NM00015 EQU   CCAFLAG1+1
CCAUNL   EQU   CCAFLAG1+1
CCARESET EQU   CCAFLAG1+1
CCALOG   EQU   CCAFLAG1+1
CCACNV   EQU   CCAFLAG1+1
CCALIST  EQU   CCAFLAG1
CCAUPDU  EQU   CCAFLAG1
CCAUPDJ  EQU   CCAFLAG1
CCARES   EQU   CCAFLAG1
CCAREJ   EQU   CCAFLAG1
CCAACCPT EQU   CCAFLAG1
CCAAPPLY EQU   CCAFLAG1
CCAREC   EQU   CCAFLAG1
@NM00014 EQU   @NM00009+18
@NM00013 EQU   @NM00009+16
CCATBLPA EQU   @NM00009+12
@NM00012 EQU   @NM00009+8
@NM00011 EQU   @NM00009+4
@NM00010 EQU   @NM00009
CCAIFGTP EQU   CCAFGTP+16
CCAGTP3  EQU   CCAFGTP+12
CCAGTP2  EQU   CCAFGTP+8
CCAGTP1  EQU   CCAFGTP+4
CCASETAD EQU   CCASEGTP
CCACLST  EQU   CCAFPGM+12
CCASPDCB EQU   CCAFPGM+8
CCAICLMD EQU   CCAFICT+12
CCAICMOD EQU   CCAFICT+8
CCAICPTF EQU   CCAFICT+4
CCAICT   EQU   CCAFICT
CCARVAD  EQU   CCAFSTA
CCAACDID EQU   CCAFSYS+32
CCACDSID EQU   CCAFSYS+24
CCALNLEN EQU   CCAFSYS+22
@NM00008 EQU   CCAFLAGA
CCAPSYSF EQU   CCAFLAGA
CCAASYSF EQU   CCAFLAGA
CCACSYSF EQU   CCAFLAGA
CCANUCID EQU   CCAFSYS+20
CCAASREL EQU   CCAFSYS+16
CCACSREL EQU   CCASREL
CCAPEMAX EQU   CCAFSYS+10
CCAPGLEN EQU   CCAFSYS+8
CCAIOPAS EQU   CCAFSYS+4
CCAIOPCS EQU   CCAFSYS
CCAPESIZ EQU   CCAFIOP+4
CCAIOPTR EQU   CCAFIOP
@NM00007 EQU   CCAFLAG7+3
CCALOGP  EQU   CCAFLAG7+2
CCAOUTP  EQU   CCAFLAG7+2
CCASLBP  EQU   CCAFLAG7+2
CCARPTP  EQU   CCAFLAG7+2
CCALISTP EQU   CCAFLAG7+2
CCAJCLP  EQU   CCAFLAG7+2
CCAPTFP  EQU   CCAFLAG7+2
CCATLBP  EQU   CCAFLAG7+2
CCAUT3P  EQU   CCAFLAG7+1
CCAUT2P  EQU   CCAFLAG7+1
CCAUT1P  EQU   CCAFLAG7+1
CCAWK5P  EQU   CCAFLAG7+1
CCAWK4P  EQU   CCAFLAG7+1
CCAWK3P  EQU   CCAFLAG7+1
CCAWK2P  EQU   CCAFLAG7+1
CCAWK1P  EQU   CCAFLAG7+1
CCAACRQP EQU   CCAFLAG7
CCACRQP  EQU   CCAFLAG7
CCASTSP  EQU   CCAFLAG7
CCAMTSP  EQU   CCAFLAG7
CCAPTSP  EQU   CCAFLAG7
CCASCDSP EQU   CCAFLAG7
CCAACDSP EQU   CCAFLAG7
CCACDSP  EQU   CCAFLAG7
@NM00006 EQU   CCAFBUFR+122
@NM00005 EQU   CCAFBUFR+120
@NM00004 EQU   CCAFBUFR+118
CCATBFMX EQU   CCAFBUFR+116
CCA4BFMX EQU   CCAFBUFR+114
CCA3BFMX EQU   CCAFBUFR+112
CCA2BFMX EQU   CCAFBUFR+110
CCA1BFMX EQU   CCAFBUFR+108
CCAXBFMX EQU   CCAFBUFR+106
CCAQBFMX EQU   CCAFBUFR+104
CCASBFMX EQU   CCAFBUFR+102
CCAMBFMX EQU   CCAFBUFR+100
CCAPBFMX EQU   CCAFBUFR+98
CCAVBFMX EQU   CCAFBUFR+96
CCAABFMX EQU   CCAFBUFR+94
CCACBFMX EQU   CCAFBUFR+92
@NM00003 EQU   CCAFBUFR+88
@NM00002 EQU   CCAFBUFR+84
CCA4BFSZ EQU   CCAFBUFR+80
CCATBFSZ EQU   CCAFBUFR+76
CCAWBFSZ EQU   CCAFBUFR+72
CCAQBFSZ EQU   CCAFBUFR+68
CCAPBFSZ EQU   CCAFBUFR+64
CCAVBFSZ EQU   CCAFBUFR+60
CCACBFSZ EQU   CCAFBUFR+56
@NM00001 EQU   CCAFBUFR+52
CCA4BFOA EQU   CCAFBUFR+48
CCA4BFIA EQU   CCAFBUFR+44
CCATBFIA EQU   CCAFBUFR+40
CCAWBFOA EQU   CCAFBUFR+36
CCAWBFIA EQU   CCAFBUFR+32
CCAQBFOA EQU   CCAFBUFR+28
CCAQBFIA EQU   CCAFBUFR+24
CCAPBFOA EQU   CCAFBUFR+20
CCAPBFIA EQU   CCAFBUFR+16
CCAVBFOA EQU   CCAFBUFR+12
CCAVBFIA EQU   CCAFBUFR+8
CCACBFOA EQU   CCAFBUFR+4
CCACBFIA EQU   CCAFBUFR
CCAID    EQU   HMASMCCA
UX001RCD EQU   UX001PRM+1
UX001RC  EQU   UX001PRM
CCABMREC EQU   CCABELMT+10
CCABPOS  EQU   CCABMPOS+8
CCABNAME EQU   CCABMPOS
@NM00042 EQU   CCABLDLM+2
@NM00041 EQU   CCABLDLM
CCAUPDPM EQU   @NM00039+24
@NM00040 EQU   @NM00039+21
CCARUPDT EQU   CCAUPDRC
CCAUPDSP EQU   @NM00039+12
CCAUPDTE EQU   @NM00039+8
CCAUPDNM EQU   @NM00039
CCASUPPM EQU   @NM00037+24
@NM00038 EQU   @NM00037+21
CCARSUP  EQU   CCASUPRC
CCASUPSP EQU   @NM00037+12
CCAIOSUP EQU   @NM00037+8
CCASUPNM EQU   @NM00037
CCAZAPPM EQU   @NM00035+24
@NM00036 EQU   @NM00035+21
CCARZAP  EQU   CCAZAPRC
CCAZAPSP EQU   @NM00035+12
CCASPZAP EQU   @NM00035+8
CCAZAPNM EQU   @NM00035
CCACOMPM EQU   @NM00033+24
@NM00034 EQU   @NM00033+21
CCARCOMP EQU   CCACOMRC
CCACOMSP EQU   @NM00033+12
CCACOMRS EQU   @NM00033+8
CCACOMNM EQU   @NM00033
CCACPYPM EQU   @NM00031+24
@NM00032 EQU   @NM00031+21
CCARCOPY EQU   CCACPYRC
CCACPYSP EQU   @NM00031+12
CCACOPY  EQU   @NM00031+8
CCACPYNM EQU   @NM00031
CCAASMPM EQU   @NM00029+24
@NM00030 EQU   @NM00029+21
CCARASM  EQU   CCAASMRC
CCAASMSP EQU   @NM00029+12
CCAASM   EQU   @NM00029+8
CCAASMNM EQU   @NM00029
CCALKDPM EQU   @NM00027+24
@NM00028 EQU   @NM00027+21
CCARLINK EQU   CCALKDRC
CCALKDSP EQU   @NM00027+12
CCALKED  EQU   @NM00027+8
CCALKDNM EQU   @NM00027
CCAPGMPM EQU   @NM00025+24
@NM00026 EQU   @NM00025+21
CCABPGRC EQU   @NM00025+20
CCABPGSP EQU   @NM00025+12
CCABPGAD EQU   @NM00025+8
CCABPGNM EQU   @NM00025
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS
@ENDDATA EQU   *
         END   HMASMUXC,(C'PLS2236',0802,78334)
